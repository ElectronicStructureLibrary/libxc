/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/mgga_x_lta.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t9, t10, t12, t13;
  double t15, t17, t18, t20, t21, t22, t28, t32;

#ifndef XC_DONT_COMPILE_VXC
  double t33, t38, t39, t44, t47, t48, t49, t53;

#ifndef XC_DONT_COMPILE_FXC
  double t60, t64, t69, t75, t80, t83, t84, t85;
  double t89, t94;

#ifndef XC_DONT_COMPILE_KXC
  double t97, t99, t104, t111, t116, t126, t131, t137;
  double t145, t149, t150, t154, t158, t163;

#ifndef XC_DONT_COMPILE_LXC
  double t168, t173, t183, t188, t206, t224, t241, t244;
  double t245, t263;
#endif

#endif

#endif

#endif

#endif


  mgga_x_lta_params *params;

  assert(p->params != NULL);
  params = (mgga_x_lta_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t9 = my_piecewise3(0.1e1 <= p->zeta_threshold, 0, 1);
  t10 = POW_1_3(rho[0]);
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t15 = t10 * t10;
  t17 = 0.1e1 / t15 / rho[0];
  t18 = M_CBRT6;
  t20 = M_PI * M_PI;
  t21 = POW_1_3(t20);
  t22 = t21 * t21;
  t28 = pow(0.5e1 / 0.9e1 * tau[0] * t13 * t17 * t18 / t22, 0.4e1 / 0.5e1 * params->ltafrac);
  t32 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t9 * t10 * t28);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t32;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t33 = 0.1e1 / t15;
  t38 = t7 * t9;
  t39 = t33 * t28;
  t44 = my_piecewise3(t3, 0, -t7 * t9 * t33 * t28 / 0.8e1 + t38 * t39 * params->ltafrac / 0.2e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t44 + 0.2e1 * t32;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = 0.0e0;

  t47 = t10 * t28;
  t48 = 0.1e1 / tau[0];
  t49 = params->ltafrac * t48;
  t53 = my_piecewise3(t3, 0, -0.3e1 / 0.10e2 * t38 * t47 * t49);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = 0.2e1 * rho[0] * t53;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t60 = t17 * t28;
  t64 = params->ltafrac * params->ltafrac;
  t69 = my_piecewise3(t3, 0, t7 * t9 * t17 * t28 / 0.12e2 - t38 * t60 * params->ltafrac / 0.6e1 - 0.2e1 / 0.3e1 * t38 * t60 * t64);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t69 + 0.4e1 * t44;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = 0.0e0;

  t75 = t64 * t48;
  t80 = my_piecewise3(t3, 0, -t38 * t39 * t49 / 0.10e2 + 0.2e1 / 0.5e1 * t38 * t39 * t75);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = 0.2e1 * rho[0] * t80 + 0.2e1 * t53;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  t83 = tau[0] * tau[0];
  t84 = 0.1e1 / t83;
  t85 = t64 * t84;
  t89 = params->ltafrac * t84;
  t94 = my_piecewise3(t3, 0, -0.6e1 / 0.25e2 * t38 * t47 * t85 + 0.3e1 / 0.10e2 * t38 * t47 * t89);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = 0.2e1 * rho[0] * t94;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t15 / t97;
  t104 = t99 * t28;
  t111 = t64 * params->ltafrac;
  t116 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t9 * t99 * t28 + t38 * t104 * params->ltafrac / 0.6e1 + 0.4e1 / 0.3e1 * t38 * t104 * t64 + 0.8e1 / 0.9e1 * t38 * t104 * t111);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t116 + 0.6e1 * t69;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = 0.0e0;

  t126 = t111 * t48;
  t131 = my_piecewise3(t3, 0, t38 * t60 * t49 / 0.15e2 - 0.2e1 / 0.15e2 * t38 * t60 * t75 - 0.8e1 / 0.15e2 * t38 * t60 * t126);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = 0.2e1 * rho[0] * t131 + 0.4e1 * t80;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = 0.0e0;

  t137 = t111 * t84;
  t145 = my_piecewise3(t3, 0, -0.12e2 / 0.25e2 * t38 * t39 * t85 + 0.8e1 / 0.25e2 * t38 * t39 * t137 + t38 * t39 * t89 / 0.10e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = 0.2e1 * rho[0] * t145 + 0.2e1 * t94;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl3[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[0] = 0.0e0;

  t149 = 0.1e1 / t83 / tau[0];
  t150 = t111 * t149;
  t154 = t64 * t149;
  t158 = params->ltafrac * t149;
  t163 = my_piecewise3(t3, 0, -0.24e2 / 0.125e3 * t38 * t47 * t150 + 0.18e2 / 0.25e2 * t38 * t47 * t154 - 0.3e1 / 0.5e1 * t38 * t47 * t158);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3tau3[0] = 0.2e1 * rho[0] * t163;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t168 = 0.1e1 / t15 / t97 / rho[0];
  t173 = t168 * t28;
  t183 = t64 * t64;
  t188 = my_piecewise3(t3, 0, 0.10e2 / 0.27e2 * t7 * t9 * t168 * t28 - 0.7e1 / 0.27e2 * t38 * t173 * params->ltafrac - 0.34e2 / 0.9e1 * t38 * t173 * t64 - 0.112e3 / 0.27e2 * t38 * t173 * t111 - 0.32e2 / 0.27e2 * t38 * t173 * t183);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t188 + 0.8e1 * t116;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[0] = 0.0e0;

  t206 = my_piecewise3(t3, 0, -t38 * t104 * t49 / 0.9e1 + 0.2e1 / 0.15e2 * t38 * t104 * t75 + 0.16e2 / 0.15e2 * t38 * t104 * t126 + 0.32e2 / 0.45e2 * t38 * t104 * t183 * t48);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[0] = 0.2e1 * rho[0] * t206 + 0.6e1 * t131;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[0] = 0.0e0;

  t224 = my_piecewise3(t3, 0, 0.14e2 / 0.75e2 * t38 * t60 * t85 + 0.32e2 / 0.75e2 * t38 * t60 * t137 - 0.32e2 / 0.75e2 * t38 * t60 * t183 * t84 - t38 * t60 * t89 / 0.15e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[0] = 0.2e1 * rho[0] * t224 + 0.4e1 * t145;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[0] = 0.0e0;

  t241 = my_piecewise3(t3, 0, -0.128e3 / 0.125e3 * t38 * t39 * t150 + 0.32e2 / 0.125e3 * t38 * t39 * t183 * t149 + 0.26e2 / 0.25e2 * t38 * t39 * t154 - t38 * t39 * t158 / 0.5e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[0] = 0.2e1 * rho[0] * t241 + 0.2e1 * t163;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[0] = 0.0e0;

  t244 = t83 * t83;
  t245 = 0.1e1 / t244;
  t263 = my_piecewise3(t3, 0, -0.96e2 / 0.625e3 * t38 * t47 * t183 * t245 + 0.144e3 / 0.125e3 * t38 * t47 * t111 * t245 - 0.66e2 / 0.25e2 * t38 * t47 * t64 * t245 + 0.9e1 / 0.5e1 * t38 * t47 * params->ltafrac * t245);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[0] = 0.2e1 * rho[0] * t263;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t2, t3, t4, t6, t7, t8, t9, t11;
  double t12, t13, t14, t18, t19, t20, t21, t22;
  double t26, t27, t28, t29, t31, t34, t35, t39;
  double t40, t41, t43, t44, t45, t49, t50, t51;
  double t52, t58, t62;

#ifndef XC_DONT_COMPILE_VXC
  double t63, t66, t67, t70, t71, t72, t73, t75;
  double t80, t81, t85, t86, t87, t90, t91, t92;
  double t93, t94, t95, t99, t102, t103, t104, t105;
  double t106, t107, t108, t109, t113, t114, t118, t121;
  double t123, t126, t127, t128, t132, t133, t138, t141;
  double t143, t148, t149, t153, t154, t155, t156, t157;
  double t161, t164, t165, t166, t169, t170, t171, t172;
  double t175;

#ifndef XC_DONT_COMPILE_FXC
  double t178, t179, t181, t186, t187, t189, t192, t193;
  double t194, t200, t205, t206, t210, t212, t214, t217;
  double t218, t221, t222, t223, t224, t226, t227, t228;
  double t229, t232, t233, t237, t240, t241, t242, t243;
  double t244, t246, t247, t249, t251, t252, t256, t257;
  double t261, t263, t265, t268, t270, t277, t278, t280;
  double t281, t285, t286, t290, t292, t294, t300, t301;
  double t303, t304, t308, t310, t312, t316, t318, t323;
  double t324, t328, t330, t333, t336, t337, t338, t341;
  double t347, t348, t349, t353, t354, t360, t362, t366;
  double t367, t372, t377, t378, t383, t386, t387, t388;
  double t391, t392, t396, t401, t403, t404, t405, t407;
  double t411, t415, t417, t419, t424, t428, t429, t431;
  double t435, t437, t438, t439, t440, t443, t444, t448;
  double t449, t450, t451, t452, t455, t456, t460;

#ifndef XC_DONT_COMPILE_KXC
  double t463, t465, t467, t470, t475, t477, t481, t484;
  double t488, t490, t494, t495, t496, t501, t505, t506;
  double t513, t517, t520, t524, t525, t528, t529, t530;
  double t532, t533, t535, t536, t537, t538, t541, t544;
  double t545, t547, t548, t551, t552, t556, t557, t560;
  double t562, t565, t567, t569, t570, t572, t575, t580;
  double t587, t591, t596, t598, t601, t602, t610, t614;
  double t615, t617, t618, t619, t622, t625, t628, t629;
  double t637, t638, t642, t645, t656, t657, t658, t660;
  double t661, t663, t664, t670, t672, t674, t678, t679;
  double t687, t688, t689, t693, t694, t702, t705, t709;
  double t713, t714, t715, t716, t719, t729, t730, t732;
  double t733, t737, t744, t746, t753, t756, t758, t759;
  double t762, t770, t776, t777, t781, t787, t791, t792;
  double t799, t802, t804, t810, t811, t815, t816, t818;
  double t819, t826, t827, t828, t832, t840, t843, t846;
  double t853, t857, t861, t865, t866, t873, t874, t875;
  double t878, t888, t889, t892, t893, t895, t896, t902;
  double t904, t907, t909, t910, t911, t913, t914, t915;
  double t918, t922, t927, t929, t931, t933, t937, t939;
  double t945, t949, t952, t955, t956, t959, t966, t972;
  double t976, t977, t978, t981, t985, t989, t991, t992;
  double t993, t998, t1000, t1001, t1005, t1009, t1011, t1014;
  double t1016, t1018, t1025, t1029, t1030, t1035, t1039, t1042;
  double t1043, t1044, t1047, t1048, t1051, t1052, t1056, t1058;
  double t1059, t1060, t1063, t1064, t1067, t1068, t1072;

#ifndef XC_DONT_COMPILE_LXC
  double t1075, t1084, t1086, t1089, t1092, t1101, t1105, t1108;
  double t1112, t1114, t1122, t1129, t1131, t1133, t1138, t1139;
  double t1146, t1150, t1154, t1157, t1161, t1167, t1170, t1172;
  double t1173, t1183, t1185, t1193, t1199, t1204, t1208, t1211;
  double t1213, t1215, t1217, t1219, t1221, t1223, t1226, t1228;
  double t1231, t1233, t1234, t1236, t1241, t1244, t1249, t1256;
  double t1260, t1264, t1269, t1271, t1276, t1278, t1283, t1286;
  double t1289, t1298, t1312, t1317, t1324, t1326, t1333, t1337;
  double t1338, t1341, t1348, t1355, t1356, t1359, t1362, t1363;
  double t1364, t1376, t1378, t1380, t1381, t1383, t1386, t1390;
  double t1393, t1406, t1407, t1413, t1415, t1417, t1420, t1429;
  double t1430, t1437, t1441, t1442, t1445, t1450, t1453, t1455;
  double t1456, t1457, t1459, t1461, t1462, t1471, t1476, t1480;
  double t1501, t1502, t1509, t1513, t1525, t1527, t1537, t1539;
  double t1541, t1543, t1545, t1547, t1550, t1552, t1554, t1555;
  double t1557, t1558, t1566, t1569, t1582, t1584, t1593, t1600;
  double t1602, t1606, t1608, t1616, t1618, t1628, t1630, t1637;
  double t1641, t1652, t1658, t1660, t1676, t1682, t1683, t1690;
  double t1692, t1701, t1702, t1703, t1716, t1720, t1745, t1749;
  double t1756, t1758, t1768, t1770, t1777, t1783, t1794, t1795;
  double t1803, t1806, t1809, t1812, t1814, t1817, t1819, t1833;
  double t1842, t1843, t1847, t1854, t1884, t1885, t1896, t1909;
  double t1931, t1933, t1939, t1945, t1951, t1957, t1959, t1961;
  double t1963, t1967, t1972, t1974, t1975, t1980, t1982, t1986;
  double t1988, t1990, t1994, t1998, t2002, t2013, t2014, t2016;
  double t2020, t2021, t2030, t2032, t2035, t2039, t2048, t2052;
  double t2059, t2065, t2069, t2071, t2072, t2080, t2085, t2098;
  double t2109, t2110, t2115, t2121, t2122, t2124, t2133, t2139;
  double t2140, t2145, t2146, t2151, t2155, t2158, t2162, t2164;
  double t2168, t2176, t2182, t2183, t2187, t2192, t2196, t2201;
  double t2203, t2204, t2214, t2223, t2239, t2240, t2246, t2247;
  double t2255, t2263, t2268, t2274, t2279, t2284, t2286, t2295;
  double t2299, t2314, t2316, t2317, t2335, t2336, t2337, t2355;
#endif

#endif

#endif

#endif

#endif


  mgga_x_lta_params *params;

  assert(p->params != NULL);
  params = (mgga_x_lta_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t9 = rho[0] * t8;
  t11 = 0.2e1 * t9 <= p->zeta_threshold;
  t12 = M_CBRT2;
  t13 = t12 * rho[0];
  t14 = POW_1_3(t9);
  t18 = my_piecewise3(t11, 0, 0.2e1 * t13 * t8 * t14);
  t19 = POW_1_3(t7);
  t20 = t18 * t19;
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t26 = M_CBRT6;
  t27 = M_PI * M_PI;
  t28 = POW_1_3(t27);
  t29 = t28 * t28;
  t31 = t26 / t29;
  t34 = 0.4e1 / 0.5e1 * params->ltafrac;
  t35 = pow(0.5e1 / 0.9e1 * tau[0] / t22 / rho[0] * t31, t34);
  t39 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t20 * t35);
  t40 = rho[1] <= p->dens_threshold;
  t41 = rho[1] * t8;
  t43 = 0.2e1 * t41 <= p->zeta_threshold;
  t44 = t12 * rho[1];
  t45 = POW_1_3(t41);
  t49 = my_piecewise3(t43, 0, 0.2e1 * t44 * t8 * t45);
  t50 = t49 * t19;
  t51 = POW_1_3(rho[1]);
  t52 = t51 * t51;
  t58 = pow(0.5e1 / 0.9e1 * tau[1] / t52 / rho[1] * t31, t34);
  t62 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t50 * t58);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t39 + t62;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t63 = t12 * t8;
  t66 = t7 * t7;
  t67 = 0.1e1 / t66;
  t70 = 0.2e1 * t13 * t67 * t14;
  t71 = t14 * t14;
  t72 = 0.1e1 / t71;
  t73 = t8 * t72;
  t75 = -rho[0] * t67 + t8;
  t80 = my_piecewise3(t11, 0, 0.2e1 * t63 * t14 - t70 + 0.2e1 / 0.3e1 * t13 * t73 * t75);
  t81 = t80 * t19;
  t85 = t19 * t19;
  t86 = 0.1e1 / t85;
  t87 = t18 * t86;
  t90 = t6 * t87 * t35 / 0.8e1;
  t91 = t6 * t18;
  t92 = t19 * t35;
  t93 = 0.1e1 / rho[0];
  t94 = params->ltafrac * t93;
  t95 = t92 * t94;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t81 * t35 - t90 + t91 * t95 / 0.2e1);
  t102 = 0.2e1 * t44 * t67 * t45;
  t103 = rho[1] * rho[1];
  t104 = t12 * t103;
  t105 = t66 * t7;
  t106 = 0.1e1 / t105;
  t107 = t45 * t45;
  t108 = 0.1e1 / t107;
  t109 = t106 * t108;
  t113 = my_piecewise3(t43, 0, -t102 - 0.2e1 / 0.3e1 * t104 * t109);
  t114 = t113 * t19;
  t118 = t49 * t86;
  t121 = t6 * t118 * t58 / 0.8e1;
  t123 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t114 * t58 - t121);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t39 + t62 + t7 * (t99 + t123);

  t126 = rho[0] * rho[0];
  t127 = t12 * t126;
  t128 = t106 * t72;
  t132 = my_piecewise3(t11, 0, -t70 - 0.2e1 / 0.3e1 * t127 * t128);
  t133 = t132 * t19;
  t138 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t133 * t35 - t90);
  t141 = t8 * t108;
  t143 = -rho[1] * t67 + t8;
  t148 = my_piecewise3(t43, 0, 0.2e1 * t63 * t45 - t102 + 0.2e1 / 0.3e1 * t44 * t141 * t143);
  t149 = t148 * t19;
  t153 = t6 * t49;
  t154 = t19 * t58;
  t155 = 0.1e1 / rho[1];
  t156 = params->ltafrac * t155;
  t157 = t154 * t156;
  t161 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t149 * t58 - t121 + t153 * t157 / 0.2e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t39 + t62 + t7 * (t138 + t161);

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[1] = 0.0e0;

  t164 = 0.1e1 / tau[0];
  t165 = params->ltafrac * t164;
  t166 = t92 * t165;
  t169 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t91 * t166);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = t7 * t169;

  t170 = 0.1e1 / tau[1];
  t171 = params->ltafrac * t170;
  t172 = t154 * t171;
  t175 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t153 * t172);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[1] = t7 * t175;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t178 = t12 * t67;
  t179 = t178 * t14;
  t181 = t72 * t75;
  t186 = 0.4e1 * t13 * t106 * t14;
  t187 = t67 * t72;
  t189 = t13 * t187 * t75;
  t192 = 0.1e1 / t71 / t9;
  t193 = t8 * t192;
  t194 = t75 * t75;
  t200 = 0.2e1 * rho[0] * t106 - 0.2e1 * t67;
  t205 = my_piecewise3(t11, 0, -0.4e1 * t179 + 0.4e1 / 0.3e1 * t63 * t181 + t186 - 0.4e1 / 0.3e1 * t189 - 0.4e1 / 0.9e1 * t13 * t193 * t194 + 0.2e1 / 0.3e1 * t13 * t73 * t200);
  t206 = t205 * t19;
  t210 = t80 * t86;
  t212 = t6 * t210 * t35;
  t214 = t6 * t80;
  t217 = 0.1e1 / t85 / t7;
  t218 = t18 * t217;
  t221 = t6 * t218 * t35 / 0.12e2;
  t222 = t86 * t35;
  t223 = t222 * t94;
  t224 = t91 * t223;
  t226 = params->ltafrac * params->ltafrac;
  t227 = 0.1e1 / t126;
  t228 = t226 * t227;
  t229 = t92 * t228;
  t232 = params->ltafrac * t227;
  t233 = t92 * t232;
  t237 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t206 * t35 - t212 / 0.4e1 + t214 * t95 + t221 + t224 / 0.3e1 - 0.2e1 / 0.3e1 * t91 * t229 - t91 * t233 / 0.2e1);
  t240 = 0.4e1 * t44 * t106 * t45;
  t241 = t66 * t66;
  t242 = 0.1e1 / t241;
  t243 = t242 * t108;
  t244 = t104 * t243;
  t246 = t103 * rho[1];
  t247 = t12 * t246;
  t249 = 0.1e1 / t241 / t7;
  t251 = 0.1e1 / t107 / t41;
  t252 = t249 * t251;
  t256 = my_piecewise3(t43, 0, t240 + 0.8e1 / 0.3e1 * t244 - 0.4e1 / 0.9e1 * t247 * t252);
  t257 = t256 * t19;
  t261 = t113 * t86;
  t263 = t6 * t261 * t58;
  t265 = t49 * t217;
  t268 = t6 * t265 * t58 / 0.12e2;
  t270 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t257 * t58 - t263 / 0.4e1 + t268);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t99 + 0.2e1 * t123 + t7 * (t237 + t270);

  t277 = t242 * t72;
  t278 = t127 * t277;
  t280 = t106 * t192;
  t281 = t280 * t75;
  t285 = my_piecewise3(t11, 0, -0.2e1 * t179 + t186 - 0.2e1 / 0.3e1 * t189 - 0.4e1 / 0.3e1 * t13 * t128 + 0.2e1 * t278 + 0.4e1 / 0.9e1 * t127 * t281);
  t286 = t285 * t19;
  t290 = t132 * t86;
  t292 = t6 * t290 * t35;
  t294 = t6 * t132;
  t300 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t286 * t35 - t292 / 0.8e1 + t294 * t95 / 0.2e1 - t212 / 0.8e1 + t221 + t224 / 0.6e1);
  t301 = t178 * t45;
  t303 = t12 * t106;
  t304 = t108 * rho[1];
  t308 = t67 * t108;
  t310 = t44 * t308 * t143;
  t312 = t106 * t251;
  t316 = rho[1] * t106;
  t318 = -t67 + 0.2e1 * t316;
  t323 = my_piecewise3(t43, 0, -0.2e1 * t301 - 0.2e1 / 0.3e1 * t303 * t304 + t240 + 0.2e1 / 0.3e1 * t244 - 0.2e1 / 0.3e1 * t310 + 0.4e1 / 0.9e1 * t104 * t312 * t143 + 0.2e1 / 0.3e1 * t44 * t141 * t318);
  t324 = t323 * t19;
  t328 = t148 * t86;
  t330 = t6 * t328 * t58;
  t333 = t6 * t113;
  t336 = t86 * t58;
  t337 = t336 * t156;
  t338 = t153 * t337;
  t341 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t324 * t58 - t330 / 0.8e1 - t263 / 0.8e1 + t268 + t333 * t157 / 0.2e1 + t338 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t99 + t123 + t138 + t161 + t7 * (t300 + t341);

  t347 = t126 * rho[0];
  t348 = t12 * t347;
  t349 = t249 * t192;
  t353 = my_piecewise3(t11, 0, t186 + 0.8e1 / 0.3e1 * t278 - 0.4e1 / 0.9e1 * t348 * t349);
  t354 = t353 * t19;
  t360 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t354 * t35 - t292 / 0.4e1 + t221);
  t362 = t108 * t143;
  t366 = t8 * t251;
  t367 = t143 * t143;
  t372 = -0.2e1 * t67 + 0.2e1 * t316;
  t377 = my_piecewise3(t43, 0, -0.4e1 * t301 + 0.4e1 / 0.3e1 * t63 * t362 + t240 - 0.4e1 / 0.3e1 * t310 - 0.4e1 / 0.9e1 * t44 * t366 * t367 + 0.2e1 / 0.3e1 * t44 * t141 * t372);
  t378 = t377 * t19;
  t383 = t6 * t148;
  t386 = 0.1e1 / t103;
  t387 = t226 * t386;
  t388 = t154 * t387;
  t391 = params->ltafrac * t386;
  t392 = t154 * t391;
  t396 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t378 * t58 - t330 / 0.4e1 + t383 * t157 + t268 + t338 / 0.3e1 - 0.2e1 / 0.3e1 * t153 * t388 - t153 * t392 / 0.2e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t138 + 0.2e1 * t161 + t7 * (t360 + t396);

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = 0.0e0;

  t401 = t222 * t165;
  t403 = t91 * t401 / 0.10e2;
  t404 = t6 * t20;
  t405 = t35 * t226;
  t407 = t405 * t93 * t164;
  t411 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t214 * t166 - t403 + 0.2e1 / 0.5e1 * t404 * t407);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t7 * t411 + t169;

  t415 = t336 * t171;
  t417 = t153 * t415 / 0.10e2;
  t419 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t333 * t172 - t417);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = t7 * t419 + t175;

  t424 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t294 * t166 - t403);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = t7 * t424 + t169;

  t428 = t6 * t50;
  t429 = t58 * t226;
  t431 = t429 * t155 * t170;
  t435 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t383 * t172 - t417 + 0.2e1 / 0.5e1 * t428 * t431);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = t7 * t435 + t175;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[3] = 0.0e0;

  t437 = tau[0] * tau[0];
  t438 = 0.1e1 / t437;
  t439 = t226 * t438;
  t440 = t92 * t439;
  t443 = params->ltafrac * t438;
  t444 = t92 * t443;
  t448 = my_piecewise3(t2, 0, -0.6e1 / 0.25e2 * t91 * t440 + 0.3e1 / 0.10e2 * t91 * t444);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = t7 * t448;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[1] = 0.0e0;

  t449 = tau[1] * tau[1];
  t450 = 0.1e1 / t449;
  t451 = t226 * t450;
  t452 = t154 * t451;
  t455 = params->ltafrac * t450;
  t456 = t154 * t455;
  t460 = my_piecewise3(t40, 0, -0.6e1 / 0.25e2 * t153 * t452 + 0.3e1 / 0.10e2 * t153 * t456);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[2] = t7 * t460;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t463 = t303 * t14;
  t465 = t178 * t181;
  t467 = t192 * t194;
  t470 = t72 * t200;
  t475 = 0.12e2 * t13 * t242 * t14;
  t477 = t13 * t128 * t75;
  t481 = t13 * t67 * t192 * t194;
  t484 = t13 * t187 * t200;
  t488 = 0.1e1 / t71 / t126 / t67;
  t490 = t194 * t75;
  t494 = t13 * t8;
  t495 = t192 * t75;
  t496 = t495 * t200;
  t501 = -0.6e1 * rho[0] * t242 + 0.6e1 * t106;
  t505 = 0.12e2 * t463 - 0.4e1 * t465 - 0.4e1 / 0.3e1 * t63 * t467 + 0.2e1 * t63 * t470 - t475 + 0.4e1 * t477 + 0.4e1 / 0.3e1 * t481 - 0.2e1 * t484 + 0.20e2 / 0.27e2 * t13 * t8 * t488 * t490 - 0.4e1 / 0.3e1 * t494 * t496 + 0.2e1 / 0.3e1 * t13 * t73 * t501;
  t506 = my_piecewise3(t11, 0, t505);
  t513 = t6 * t205 * t86 * t35;
  t517 = t6 * t80 * t217 * t35;
  t520 = 0.1e1 / t85 / t66;
  t524 = 0.5e1 / 0.36e2 * t6 * t18 * t520 * t35;
  t525 = t214 * t223;
  t528 = t217 * t35;
  t529 = t528 * t94;
  t530 = t91 * t529;
  t532 = t222 * t228;
  t533 = t91 * t532;
  t535 = t226 * params->ltafrac;
  t536 = 0.1e1 / t347;
  t537 = t535 * t536;
  t538 = t92 * t537;
  t541 = t6 * t205;
  t544 = t222 * t232;
  t545 = t91 * t544;
  t547 = t226 * t536;
  t548 = t92 * t547;
  t551 = params->ltafrac * t536;
  t552 = t92 * t551;
  t556 = -0.3e1 / 0.8e1 * t6 * t506 * t19 * t35 - 0.3e1 / 0.8e1 * t513 + t517 / 0.4e1 - t524 + t525 - 0.2e1 * t214 * t229 - t530 / 0.3e1 - 0.2e1 / 0.3e1 * t533 + 0.8e1 / 0.9e1 * t91 * t538 + 0.3e1 / 0.2e1 * t541 * t95 - t545 / 0.2e1 + 0.2e1 * t91 * t548 + t91 * t552 - 0.3e1 / 0.2e1 * t214 * t233;
  t557 = my_piecewise3(t2, 0, t556);
  t560 = 0.12e2 * t44 * t242 * t45;
  t562 = t104 * t249 * t108;
  t565 = 0.1e1 / t241 / t66;
  t567 = t247 * t565 * t251;
  t569 = t103 * t103;
  t570 = t12 * t569;
  t572 = 0.1e1 / t241 / t105;
  t575 = 0.1e1 / t107 / t103 / t67;
  t580 = my_piecewise3(t43, 0, -t560 - 0.12e2 * t562 + 0.4e1 * t567 - 0.20e2 / 0.27e2 * t570 * t572 * t575);
  t587 = t6 * t256 * t86 * t58;
  t591 = t6 * t113 * t217 * t58;
  t596 = 0.5e1 / 0.36e2 * t6 * t49 * t520 * t58;
  t598 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t580 * t19 * t58 - 0.3e1 / 0.8e1 * t587 + t591 / 0.4e1 - t596);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t237 + 0.3e1 * t270 + t7 * (t557 + t598);

  t601 = 0.2e1 * t300;
  t602 = 0.2e1 * t341;
  t610 = t13 * t277;
  t614 = t249 * t72;
  t615 = t127 * t614;
  t617 = t242 * t192;
  t618 = t617 * t75;
  t619 = t127 * t618;
  t622 = t106 * t488 * t194;
  t625 = t280 * t200;
  t628 = 0.8e1 * t463 - 0.4e1 / 0.3e1 * t465 - t475 + 0.8e1 / 0.3e1 * t477 + 0.4e1 / 0.9e1 * t481 - 0.2e1 / 0.3e1 * t484 - 0.4e1 / 0.3e1 * t303 * t72 + 0.8e1 * t610 + 0.16e2 / 0.9e1 * t13 * t281 - 0.8e1 * t615 - 0.8e1 / 0.3e1 * t619 - 0.20e2 / 0.27e2 * t127 * t622 + 0.4e1 / 0.9e1 * t127 * t625;
  t629 = my_piecewise3(t11, 0, t628);
  t637 = t6 * t285 * t86 * t35 / 0.4e1;
  t638 = t6 * t285;
  t642 = t6 * t132 * t217 * t35;
  t645 = t294 * t223 / 0.3e1;
  t656 = -0.3e1 / 0.8e1 * t6 * t629 * t19 * t35 - t637 + t638 * t95 + t642 / 0.12e2 + t645 - 0.2e1 / 0.3e1 * t294 * t229 - t294 * t233 / 0.2e1 - t513 / 0.8e1 + t517 / 0.6e1 + t525 / 0.3e1 - t524 - 0.2e1 / 0.9e1 * t530 - 0.2e1 / 0.9e1 * t533 - t545 / 0.6e1;
  t657 = my_piecewise3(t2, 0, t656);
  t658 = t303 * t45;
  t660 = t12 * t242;
  t661 = t660 * t304;
  t663 = t12 * t249;
  t664 = t251 * t103;
  t670 = t44 * t109 * t143;
  t672 = t242 * t251;
  t674 = t104 * t672 * t143;
  t678 = 0.4e1 / 0.3e1 * t44 * t308 * t318;
  t679 = t249 * t575;
  t687 = rho[1] * t242;
  t688 = 0.6e1 * t687;
  t689 = 0.2e1 * t106 - t688;
  t693 = 0.4e1 * t658 + 0.8e1 / 0.3e1 * t661 - 0.4e1 / 0.9e1 * t663 * t664 - t560 - 0.4e1 * t562 + 0.4e1 / 0.9e1 * t567 + 0.4e1 / 0.3e1 * t670 - 0.16e2 / 0.9e1 * t674 - t678 + 0.20e2 / 0.27e2 * t247 * t679 * t143 + 0.8e1 / 0.9e1 * t104 * t312 * t318 + 0.2e1 / 0.3e1 * t44 * t141 * t689;
  t694 = my_piecewise3(t43, 0, t693);
  t702 = t6 * t323 * t86 * t58 / 0.4e1;
  t705 = t6 * t148 * t217 * t58;
  t709 = t6 * t256;
  t713 = t333 * t337 / 0.3e1;
  t714 = t217 * t58;
  t715 = t714 * t156;
  t716 = t153 * t715;
  t719 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t694 * t19 * t58 - t702 + t705 / 0.12e2 - t587 / 0.8e1 + t591 / 0.6e1 - t596 + t709 * t157 / 0.2e1 + t713 - t716 / 0.9e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t237 + t270 + t601 + t602 + t7 * (t657 + t719);

  t729 = t565 * t192;
  t730 = t348 * t729;
  t732 = t249 * t488;
  t733 = t732 * t75;
  t737 = my_piecewise3(t11, 0, 0.4e1 * t463 - t475 + 0.4e1 / 0.3e1 * t477 + 0.16e2 / 0.3e1 * t610 - 0.32e2 / 0.3e1 * t615 - 0.16e2 / 0.9e1 * t619 - 0.4e1 / 0.3e1 * t127 * t349 + 0.20e2 / 0.9e1 * t730 + 0.20e2 / 0.27e2 * t348 * t733);
  t744 = t6 * t353 * t86 * t35;
  t746 = t6 * t353;
  t753 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t737 * t19 * t35 - t744 / 0.8e1 + t746 * t95 / 0.2e1 - t637 + t642 / 0.6e1 + t645 + t517 / 0.12e2 - t524 - t530 / 0.9e1);
  t756 = t178 * t362;
  t758 = t251 * t143;
  t759 = t758 * rho[1];
  t762 = t108 * t318;
  t770 = t44 * t67 * t251 * t367;
  t776 = t44 * t8;
  t777 = t758 * t318;
  t781 = t44 * t308 * t372;
  t787 = 0.4e1 * t106 - t688;
  t791 = 0.8e1 * t658 + 0.4e1 / 0.3e1 * t661 - 0.4e1 / 0.3e1 * t756 + 0.8e1 / 0.9e1 * t303 * t759 + 0.4e1 / 0.3e1 * t63 * t762 - t560 - 0.4e1 / 0.3e1 * t562 + 0.8e1 / 0.3e1 * t670 - 0.8e1 / 0.9e1 * t674 - t678 + 0.4e1 / 0.9e1 * t770 - 0.20e2 / 0.27e2 * t104 * t106 * t575 * t367 - 0.8e1 / 0.9e1 * t776 * t777 - 0.2e1 / 0.3e1 * t781 + 0.4e1 / 0.9e1 * t104 * t312 * t372 + 0.2e1 / 0.3e1 * t44 * t141 * t787;
  t792 = my_piecewise3(t43, 0, t791);
  t799 = t6 * t377 * t86 * t58;
  t802 = t6 * t323;
  t804 = t383 * t337;
  t810 = t336 * t387;
  t811 = t153 * t810;
  t815 = t336 * t391;
  t816 = t153 * t815;
  t818 = -0.3e1 / 0.8e1 * t6 * t792 * t19 * t58 - t799 / 0.8e1 - t702 + t705 / 0.6e1 + t802 * t157 + t804 / 0.3e1 + t591 / 0.12e2 - t596 + t713 - 0.2e1 / 0.9e1 * t716 - 0.2e1 / 0.3e1 * t333 * t388 - 0.2e1 / 0.9e1 * t811 - t333 * t392 / 0.2e1 - t816 / 0.6e1;
  t819 = my_piecewise3(t40, 0, t818);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t601 + t602 + t360 + t396 + t7 * (t753 + t819);

  t826 = t126 * t126;
  t827 = t12 * t826;
  t828 = t572 * t488;
  t832 = my_piecewise3(t11, 0, -t475 - 0.12e2 * t615 + 0.4e1 * t730 - 0.20e2 / 0.27e2 * t827 * t828);
  t840 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t832 * t19 * t35 - 0.3e1 / 0.8e1 * t744 + t642 / 0.4e1 - t524);
  t843 = t251 * t367;
  t846 = t108 * t372;
  t853 = t367 * t143;
  t857 = t758 * t372;
  t861 = 0.6e1 * t106 - 0.6e1 * t687;
  t865 = 0.12e2 * t658 - 0.4e1 * t756 - 0.4e1 / 0.3e1 * t63 * t843 + 0.2e1 * t63 * t846 - t560 + 0.4e1 * t670 + 0.4e1 / 0.3e1 * t770 - 0.2e1 * t781 + 0.20e2 / 0.27e2 * t44 * t8 * t575 * t853 - 0.4e1 / 0.3e1 * t776 * t857 + 0.2e1 / 0.3e1 * t44 * t141 * t861;
  t866 = my_piecewise3(t43, 0, t865);
  t873 = 0.1e1 / t246;
  t874 = t535 * t873;
  t875 = t154 * t874;
  t878 = t6 * t377;
  t888 = t226 * t873;
  t889 = t154 * t888;
  t892 = params->ltafrac * t873;
  t893 = t154 * t892;
  t895 = -0.3e1 / 0.8e1 * t6 * t866 * t19 * t58 - 0.3e1 / 0.8e1 * t799 + t705 / 0.4e1 - t596 + 0.8e1 / 0.9e1 * t153 * t875 + 0.3e1 / 0.2e1 * t878 * t157 - 0.2e1 * t383 * t388 - t716 / 0.3e1 + t804 - 0.2e1 / 0.3e1 * t811 - t816 / 0.2e1 - 0.3e1 / 0.2e1 * t383 * t392 + 0.2e1 * t153 * t889 + t153 * t893;
  t896 = my_piecewise3(t40, 0, t895);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t360 + 0.3e1 * t396 + t7 * (t840 + t896);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[5] = 0.0e0;

  t902 = t214 * t401;
  t904 = t6 * t81;
  t907 = t528 * t165;
  t909 = t91 * t907 / 0.15e2;
  t910 = t6 * t87;
  t911 = t910 * t407;
  t913 = t35 * t535;
  t914 = t227 * t164;
  t915 = t913 * t914;
  t918 = t405 * t914;
  t922 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t541 * t166 - t902 / 0.5e1 + 0.4e1 / 0.5e1 * t904 * t407 + t909 + 0.4e1 / 0.15e2 * t911 - 0.8e1 / 0.15e2 * t404 * t915 - 0.2e1 / 0.5e1 * t404 * t918);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t7 * t922 + 0.2e1 * t411;

  t927 = t333 * t415;
  t929 = t714 * t171;
  t931 = t153 * t929 / 0.15e2;
  t933 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t709 * t172 - t927 / 0.5e1 + t931);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[1] = t7 * t933 + 0.2e1 * t419;

  t937 = t294 * t401;
  t939 = t6 * t133;
  t945 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t638 * t166 - t937 / 0.10e2 + 0.2e1 / 0.5e1 * t939 * t407 - t902 / 0.10e2 + t909 + 0.2e1 / 0.15e2 * t911);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[2] = t7 * t945 + t411 + t424;

  t949 = t383 * t415;
  t952 = t6 * t114;
  t955 = t6 * t118;
  t956 = t955 * t431;
  t959 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t802 * t172 - t949 / 0.10e2 - t927 / 0.10e2 + t931 + 0.2e1 / 0.5e1 * t952 * t431 + 0.2e1 / 0.15e2 * t956);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[3] = t7 * t959 + t419 + t435;

  t966 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t746 * t166 - t937 / 0.5e1 + t909);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[4] = t7 * t966 + 0.2e1 * t424;

  t972 = t6 * t149;
  t976 = t58 * t535;
  t977 = t386 * t170;
  t978 = t976 * t977;
  t981 = t429 * t977;
  t985 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t878 * t172 - t949 / 0.5e1 + 0.4e1 / 0.5e1 * t972 * t431 + t931 + 0.4e1 / 0.15e2 * t956 - 0.8e1 / 0.15e2 * t428 * t978 - 0.2e1 / 0.5e1 * t428 * t981);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[5] = t7 * t985 + 0.2e1 * t435;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[7] = 0.0e0;

  t989 = t222 * t439;
  t991 = 0.2e1 / 0.25e2 * t91 * t989;
  t992 = t93 * t438;
  t993 = t913 * t992;
  t998 = t222 * t443;
  t1000 = t91 * t998 / 0.10e2;
  t1001 = t405 * t992;
  t1005 = my_piecewise3(t2, 0, -0.6e1 / 0.25e2 * t214 * t440 - t991 + 0.8e1 / 0.25e2 * t404 * t993 + 0.3e1 / 0.10e2 * t214 * t444 + t1000 - 0.2e1 / 0.5e1 * t404 * t1001);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t7 * t1005 + t448;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[1] = 0.0e0;

  t1009 = t336 * t451;
  t1011 = 0.2e1 / 0.25e2 * t153 * t1009;
  t1014 = t336 * t455;
  t1016 = t153 * t1014 / 0.10e2;
  t1018 = my_piecewise3(t40, 0, -0.6e1 / 0.25e2 * t333 * t452 - t1011 + 0.3e1 / 0.10e2 * t333 * t456 + t1016);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[2] = t7 * t1018 + t460;

  t1025 = my_piecewise3(t2, 0, -0.6e1 / 0.25e2 * t294 * t440 - t991 + 0.3e1 / 0.10e2 * t294 * t444 + t1000);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[3] = t7 * t1025 + t448;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[4] = 0.0e0;

  t1029 = t155 * t450;
  t1030 = t976 * t1029;
  t1035 = t429 * t1029;
  t1039 = my_piecewise3(t40, 0, -0.6e1 / 0.25e2 * t383 * t452 - t1011 + 0.8e1 / 0.25e2 * t428 * t1030 + 0.3e1 / 0.10e2 * t383 * t456 + t1016 - 0.2e1 / 0.5e1 * t428 * t1035);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[5] = t7 * t1039 + t460;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2lapl[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma2tau[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapl2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmalapltau[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigmatau2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl3[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapl2tau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[0] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3lapltau2[5] = 0.0e0;

  t1042 = 0.1e1 / t437 / tau[0];
  t1043 = t535 * t1042;
  t1044 = t92 * t1043;
  t1047 = t226 * t1042;
  t1048 = t92 * t1047;
  t1051 = params->ltafrac * t1042;
  t1052 = t92 * t1051;
  t1056 = my_piecewise3(t2, 0, -0.24e2 / 0.125e3 * t91 * t1044 + 0.18e2 / 0.25e2 * t91 * t1048 - 0.3e1 / 0.5e1 * t91 * t1052);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3tau3[0] = t7 * t1056;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3tau3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3tau3[2] = 0.0e0;

  t1058 = 0.1e1 / t449 / tau[1];
  t1059 = t535 * t1058;
  t1060 = t154 * t1059;
  t1063 = t226 * t1058;
  t1064 = t154 * t1063;
  t1067 = params->ltafrac * t1058;
  t1068 = t154 * t1067;
  t1072 = my_piecewise3(t40, 0, -0.24e2 / 0.125e3 * t153 * t1060 + 0.18e2 / 0.25e2 * t153 * t1064 - 0.3e1 / 0.5e1 * t153 * t1068);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3tau3[3] = t7 * t1072;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1075 = t178 * t467;
  t1084 = 0.48e2 * t13 * t249 * t14;
  t1086 = t13 * t277 * t75;
  t1089 = t13 * t128 * t200;
  t1092 = t13 * t187 * t501;
  t1101 = t13 * t280 * t194;
  t1105 = t13 * t67 * t488 * t490;
  t1108 = t13 * t67 * t496;
  t1112 = 0.1e1 / t71 / t347 / t106;
  t1114 = t194 * t194;
  t1122 = t200 * t200;
  t1129 = t660 * t14;
  t1131 = t303 * t181;
  t1133 = t178 * t470;
  t1138 = 0.16e2 / 0.3e1 * t1075 + 0.80e2 / 0.27e2 * t63 * t488 * t490 - 0.16e2 / 0.3e1 * t63 * t496 + t1084 - 0.16e2 * t1086 + 0.8e1 * t1089 - 0.8e1 / 0.3e1 * t1092 + 0.2e1 / 0.3e1 * t13 * t73 * (0.24e2 * rho[0] * t249 - 0.24e2 * t242) - 0.16e2 / 0.3e1 * t1101 - 0.80e2 / 0.27e2 * t1105 + 0.16e2 / 0.3e1 * t1108 - 0.160e3 / 0.81e2 * t13 * t8 * t1112 * t1114 + 0.40e2 / 0.9e1 * t494 * t488 * t194 * t200 - 0.4e1 / 0.3e1 * t13 * t193 * t1122 - 0.16e2 / 0.9e1 * t494 * t495 * t501 - 0.48e2 * t1129 + 0.16e2 * t1131 - 0.8e1 * t1133 + 0.8e1 / 0.3e1 * t63 * t72 * t501;
  t1139 = my_piecewise3(t11, 0, t1138);
  t1146 = t6 * t506 * t86 * t35;
  t1150 = t6 * t205 * t217 * t35;
  t1154 = t6 * t80 * t520 * t35;
  t1157 = 0.1e1 / t85 / t105;
  t1161 = 0.10e2 / 0.27e2 * t6 * t18 * t1157 * t35;
  t1167 = t91 * t528 * t228;
  t1170 = t91 * t222 * t537;
  t1172 = t226 * t226;
  t1173 = 0.1e1 / t826;
  t1183 = t91 * t222 * t547;
  t1185 = -0.3e1 / 0.8e1 * t6 * t1139 * t19 * t35 - t1146 / 0.2e1 + t1150 / 0.2e1 - 0.5e1 / 0.9e1 * t1154 + t1161 - 0.4e1 * t541 * t229 + 0.32e2 / 0.9e1 * t214 * t538 + 0.8e1 / 0.9e1 * t1167 + 0.32e2 / 0.27e2 * t1170 - 0.32e2 / 0.27e2 * t91 * t92 * t1172 * t1173 - 0.3e1 * t91 * t92 * params->ltafrac * t1173 + 0.8e1 / 0.3e1 * t1183;
  t1193 = t91 * t222 * t551;
  t1199 = t214 * t544;
  t1204 = t91 * t528 * t232;
  t1208 = t6 * t506;
  t1211 = t541 * t223;
  t1213 = t214 * t529;
  t1215 = t520 * t35;
  t1217 = t91 * t1215 * t94;
  t1219 = t214 * t532;
  t1221 = -0.16e2 / 0.3e1 * t91 * t92 * t535 * t1173 - 0.3e1 * t541 * t233 + 0.4e1 / 0.3e1 * t1193 - 0.22e2 / 0.3e1 * t91 * t92 * t226 * t1173 - 0.2e1 * t1199 + 0.8e1 * t214 * t548 + 0.2e1 / 0.3e1 * t1204 + 0.4e1 * t214 * t552 + 0.2e1 * t1208 * t95 + 0.2e1 * t1211 - 0.4e1 / 0.3e1 * t1213 + 0.20e2 / 0.27e2 * t1217 - 0.8e1 / 0.3e1 * t1219;
  t1223 = my_piecewise3(t2, 0, t1185 + t1221);
  t1226 = 0.48e2 * t44 * t249 * t45;
  t1228 = t104 * t565 * t108;
  t1231 = t247 * t572 * t251;
  t1233 = t241 * t241;
  t1234 = 0.1e1 / t1233;
  t1236 = t570 * t1234 * t575;
  t1241 = 0.1e1 / t1233 / t7;
  t1244 = 0.1e1 / t107 / t246 / t106;
  t1249 = my_piecewise3(t43, 0, t1226 + 0.64e2 * t1228 - 0.32e2 * t1231 + 0.320e3 / 0.27e2 * t1236 - 0.160e3 / 0.81e2 * t12 * t569 * rho[1] * t1241 * t1244);
  t1256 = t6 * t580 * t86 * t58;
  t1260 = t6 * t256 * t217 * t58;
  t1264 = t6 * t113 * t520 * t58;
  t1269 = 0.10e2 / 0.27e2 * t6 * t49 * t1157 * t58;
  t1271 = my_piecewise3(t40, 0, -0.3e1 / 0.8e1 * t6 * t1249 * t19 * t58 - t1256 / 0.2e1 + t1260 / 0.2e1 - 0.5e1 / 0.9e1 * t1264 + t1269);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t557 + 0.4e1 * t598 + t7 * (t1223 + t1271);

  t1276 = t13 * t614;
  t1278 = t13 * t618;
  t1283 = t127 * t565 * t72;
  t1286 = t127 * t349 * t75;
  t1289 = t127 * t617 * t200;
  t1298 = -0.48e2 * t1276 - 0.16e2 * t1278 + 0.8e1 / 0.3e1 * t13 * t625 + 0.40e2 * t1283 + 0.16e2 * t1286 - 0.4e1 * t1289 + 0.4e1 / 0.9e1 * t127 * t280 * t501 + 0.4e1 / 0.3e1 * t1075 + t1084 - 0.12e2 * t1086 + 0.4e1 * t1089 - 0.2e1 / 0.3e1 * t1092;
  t1312 = t127 * t242 * t488 * t194;
  t1317 = t660 * t72;
  t1324 = 0.160e3 / 0.81e2 * t127 * t106 * t1112 * t490 - 0.20e2 / 0.9e1 * t127 * t106 * t488 * t75 * t200 - 0.40e2 / 0.9e1 * t13 * t622 + 0.20e2 / 0.3e1 * t1312 - 0.8e1 / 0.3e1 * t1101 - 0.20e2 / 0.27e2 * t1105 + 0.4e1 / 0.3e1 * t1108 + 0.12e2 * t1317 + 0.8e1 / 0.3e1 * t303 * t495 - 0.36e2 * t1129 + 0.8e1 * t1131 - 0.2e1 * t1133;
  t1326 = my_piecewise3(t11, 0, t1298 + t1324);
  t1333 = t6 * t629 * t86 * t35;
  t1337 = t6 * t285 * t217 * t35;
  t1338 = t1337 / 0.4e1;
  t1341 = t6 * t132 * t520 * t35;
  t1348 = t294 * t544;
  t1355 = -0.3e1 / 0.8e1 * t6 * t1326 * t19 * t35 - 0.3e1 / 0.8e1 * t1333 + t1338 - 0.5e1 / 0.36e2 * t1341 - t1146 / 0.8e1 + t1150 / 0.4e1 - 0.5e1 / 0.12e2 * t1154 + t1161 + 0.4e1 / 0.9e1 * t1167 + 0.8e1 / 0.27e2 * t1170 - t1348 / 0.2e1 + 0.2e1 * t294 * t548 + t294 * t552 - 0.3e1 / 0.2e1 * t638 * t233;
  t1356 = t6 * t629;
  t1359 = t638 * t223;
  t1362 = t294 * t529;
  t1363 = t1362 / 0.3e1;
  t1364 = t294 * t532;
  t1376 = 0.3e1 / 0.2e1 * t1356 * t95 + t1359 - 0.2e1 * t638 * t229 - t1363 - 0.2e1 / 0.3e1 * t1364 + 0.8e1 / 0.9e1 * t294 * t538 + 0.2e1 / 0.3e1 * t1183 + t1193 / 0.3e1 - t1199 / 0.2e1 + t1204 / 0.3e1 + t1211 / 0.2e1 - 0.2e1 / 0.3e1 * t1213 + 0.5e1 / 0.9e1 * t1217 - 0.2e1 / 0.3e1 * t1219;
  t1378 = my_piecewise3(t2, 0, t1355 + t1376);
  t1380 = t44 * t109 * t318;
  t1381 = 0.4e1 * t1380;
  t1383 = t104 * t252 * t143;
  t1386 = t104 * t672 * t318;
  t1390 = t247 * t565 * t575 * t143;
  t1393 = t44 * t308 * t689;
  t1406 = rho[1] * t249;
  t1407 = 0.24e2 * t1406;
  t1413 = t44 * t243 * t143;
  t1415 = t660 * t45;
  t1417 = t663 * t304;
  t1420 = t12 * t565 * t664;
  t1429 = t1381 + 0.8e1 * t1383 - 0.16e2 / 0.3e1 * t1386 - 0.20e2 / 0.3e1 * t1390 - 0.2e1 * t1393 + 0.20e2 / 0.9e1 * t247 * t679 * t318 + 0.160e3 / 0.81e2 * t570 * t572 * t1244 * t143 + 0.4e1 / 0.3e1 * t104 * t312 * t689 + 0.2e1 / 0.3e1 * t44 * t141 * (-0.6e1 * t242 + t1407) + t1226 - 0.4e1 * t1413 - 0.12e2 * t1415 - 0.12e2 * t1417 + 0.4e1 * t1420 - 0.20e2 / 0.27e2 * t12 * t572 * t575 * t246 + 0.24e2 * t1228 - 0.16e2 / 0.3e1 * t1231 + 0.20e2 / 0.27e2 * t1236;
  t1430 = my_piecewise3(t43, 0, t1429);
  t1437 = t6 * t694 * t86 * t58;
  t1441 = t6 * t323 * t217 * t58;
  t1442 = t1441 / 0.4e1;
  t1445 = t6 * t148 * t520 * t58;
  t1450 = t6 * t580;
  t1453 = t709 * t337;
  t1455 = t333 * t715;
  t1456 = t1455 / 0.3e1;
  t1457 = t520 * t58;
  t1459 = t153 * t1457 * t156;
  t1461 = -0.3e1 / 0.8e1 * t6 * t1430 * t19 * t58 - 0.3e1 / 0.8e1 * t1437 + t1442 - 0.5e1 / 0.36e2 * t1445 - t1256 / 0.8e1 + t1260 / 0.4e1 - 0.5e1 / 0.12e2 * t1264 + t1269 + t1450 * t157 / 0.2e1 + t1453 / 0.2e1 - t1456 + 0.5e1 / 0.27e2 * t1459;
  t1462 = my_piecewise3(t40, 0, t1461);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t557 + t598 + 0.3e1 * t657 + 0.3e1 * t719 + t7 * (t1378 + t1462);

  t1471 = t127 * t729;
  t1476 = t348 * t572 * t192;
  t1480 = t348 * t565 * t488 * t75;
  t1501 = -0.8e1 / 0.3e1 * t13 * t349 + 0.40e2 / 0.3e1 * t1471 + 0.40e2 / 0.9e1 * t127 * t733 - 0.40e2 / 0.3e1 * t1476 - 0.200e3 / 0.27e2 * t1480 + 0.20e2 / 0.27e2 * t348 * t732 * t200 - 0.128e3 / 0.3e1 * t1276 - 0.64e2 / 0.9e1 * t1278 + 0.160e3 / 0.3e1 * t1283 + 0.128e3 / 0.9e1 * t1286 - 0.16e2 / 0.9e1 * t1289 + t1084 - 0.8e1 * t1086 + 0.4e1 / 0.3e1 * t1089 - 0.160e3 / 0.81e2 * t348 * t249 * t1112 * t194 + 0.80e2 / 0.27e2 * t1312 - 0.8e1 / 0.9e1 * t1101 + 0.16e2 / 0.3e1 * t1317 - 0.24e2 * t1129 + 0.8e1 / 0.3e1 * t1131;
  t1502 = my_piecewise3(t11, 0, t1501);
  t1509 = t6 * t737 * t86 * t35;
  t1513 = t6 * t353 * t217 * t35;
  t1525 = t6 * t737;
  t1527 = t746 * t223;
  t1537 = -t1348 / 0.3e1 + t1204 / 0.9e1 + t1525 * t95 + t1527 / 0.3e1 - 0.2e1 / 0.3e1 * t746 * t229 + 0.2e1 / 0.3e1 * t1359 - 0.4e1 / 0.9e1 * t1362 - 0.4e1 / 0.9e1 * t1364 - 0.2e1 / 0.9e1 * t1213 + 0.10e2 / 0.27e2 * t1217 + 0.4e1 / 0.27e2 * t1167;
  t1539 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1502 * t19 * t35 - t1509 / 0.4e1 + t1513 / 0.12e2 - t1333 / 0.4e1 + t1337 / 0.3e1 - 0.5e1 / 0.18e2 * t1341 + t1150 / 0.12e2 - 0.5e1 / 0.18e2 * t1154 + t1161 - t746 * t233 / 0.2e1 + t1537);
  t1541 = t153 * t714 * t391;
  t1543 = t802 * t337;
  t1545 = t383 * t715;
  t1547 = t333 * t810;
  t1550 = t153 * t714 * t387;
  t1552 = t333 * t815;
  t1554 = t44 * t67;
  t1555 = t1554 * t777;
  t1557 = t104 * t106;
  t1558 = t575 * t143;
  t1566 = t44 * t308 * t787;
  t1569 = t104 * t672 * t372;
  t1582 = t660 * t759;
  t1584 = t251 * t318;
  t1593 = t104 * t242 * t575 * t367;
  t1600 = t44 * t312 * t367;
  t1602 = t318 * t318;
  t1606 = 0.16e2 / 0.9e1 * t1555 - 0.80e2 / 0.27e2 * t1557 * t1558 * t318 - 0.8e1 / 0.9e1 * t776 * t758 * t689 - 0.4e1 / 0.3e1 * t1566 - 0.16e2 / 0.9e1 * t1569 + 0.8e1 / 0.9e1 * t104 * t312 * t787 + 0.20e2 / 0.27e2 * t247 * t679 * t372 + 0.2e1 / 0.3e1 * t44 * t141 * (-0.12e2 * t242 + t1407) - 0.32e2 / 0.9e1 * t1582 + 0.16e2 / 0.9e1 * t303 * t1584 * rho[1] + 0.40e2 / 0.27e2 * t663 * t1558 * t103 + 0.80e2 / 0.27e2 * t1593 - 0.160e3 / 0.81e2 * t247 * t249 * t1244 * t367 - 0.8e1 / 0.9e1 * t1600 - 0.8e1 / 0.9e1 * t44 * t366 * t1602;
  t1608 = t44 * t109 * t372;
  t1616 = t303 * t362;
  t1618 = t178 * t762;
  t1628 = 0.4e1 / 0.3e1 * t1608 + 0.16e2 / 0.3e1 * t1380 + 0.16e2 / 0.3e1 * t1383 - 0.16e2 / 0.9e1 * t1386 - 0.40e2 / 0.27e2 * t1390 - 0.4e1 / 0.3e1 * t1393 - 0.8e1 * t1413 + 0.8e1 / 0.3e1 * t1616 - 0.8e1 / 0.3e1 * t1618 + 0.4e1 / 0.3e1 * t63 * t108 * t689 - 0.8e1 * t1417 + 0.8e1 / 0.9e1 * t1420 + t1226 + 0.32e2 / 0.3e1 * t1228 - 0.8e1 / 0.9e1 * t1231 - 0.24e2 * t1415;
  t1630 = my_piecewise3(t43, 0, t1606 + t1628);
  t1637 = t6 * t792 * t86 * t58;
  t1641 = t6 * t377 * t217 * t58;
  t1652 = t6 * t694;
  t1658 = t1441 / 0.3e1 - 0.5e1 / 0.18e2 * t1445 + t1260 / 0.12e2 - 0.5e1 / 0.18e2 * t1264 + t1269 + t1453 / 0.3e1 - 0.4e1 / 0.9e1 * t1455 + 0.10e2 / 0.27e2 * t1459 + t1652 * t157 - 0.2e1 / 0.3e1 * t709 * t388 - t709 * t392 / 0.2e1;
  t1660 = my_piecewise3(t40, 0, t1541 / 0.9e1 + 0.2e1 / 0.3e1 * t1543 - 0.2e1 / 0.9e1 * t1545 - 0.4e1 / 0.9e1 * t1547 + 0.4e1 / 0.27e2 * t1550 - t1552 / 0.3e1 - 0.3e1 / 0.8e1 * t6 * t1630 * t19 * t58 - t1637 / 0.4e1 + t1641 / 0.12e2 - t1437 / 0.4e1 + t1658);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t657 + 0.2e1 * t719 + 0.2e1 * t753 + 0.2e1 * t819 + t7 * (t1539 + t1660);

  t1676 = t827 * t1234 * t488;
  t1682 = -0.12e2 * t1129 + t1084 - 0.4e1 * t1086 - 0.24e2 * t1276 + 0.60e2 * t1283 + 0.8e1 * t1286 + 0.12e2 * t1471 - 0.24e2 * t1476 - 0.20e2 / 0.3e1 * t1480 - 0.80e2 / 0.27e2 * t348 * t828 + 0.140e3 / 0.27e2 * t1676 + 0.160e3 / 0.81e2 * t827 * t572 * t1112 * t75;
  t1683 = my_piecewise3(t11, 0, t1682);
  t1690 = t6 * t832 * t86 * t35;
  t1692 = t6 * t832;
  t1701 = -0.3e1 / 0.8e1 * t6 * t1683 * t19 * t35 - t1690 / 0.8e1 + t1692 * t95 / 0.2e1 - 0.3e1 / 0.8e1 * t1509 + t1513 / 0.4e1 + t1527 / 0.2e1 + t1338 - 0.5e1 / 0.12e2 * t1341 - t1363 - 0.5e1 / 0.36e2 * t1154 + t1161 + 0.5e1 / 0.27e2 * t1217;
  t1702 = my_piecewise3(t2, 0, t1701);
  t1703 = t575 * t367;
  t1716 = t1554 * t857;
  t1720 = t44 * t308 * t861;
  t1745 = t44 * t67 * t575 * t853;
  t1749 = 0.20e2 / 0.9e1 * t776 * t1703 * t318 - 0.4e1 / 0.3e1 * t776 * t1584 * t372 - 0.4e1 / 0.3e1 * t776 * t758 * t787 - 0.20e2 / 0.9e1 * t1557 * t1558 * t372 + 0.4e1 / 0.3e1 * t1716 + 0.8e1 / 0.3e1 * t1555 - 0.2e1 / 0.3e1 * t1720 + 0.2e1 / 0.3e1 * t44 * t141 * (-0.18e2 * t242 + t1407) + 0.4e1 / 0.9e1 * t104 * t312 * t861 - 0.8e1 / 0.3e1 * t63 * t777 - 0.20e2 / 0.9e1 * t303 * t1703 * rho[1] + 0.4e1 / 0.3e1 * t303 * t251 * t372 * rho[1] + 0.160e3 / 0.81e2 * t104 * t106 * t1244 * t853 - 0.20e2 / 0.27e2 * t1745 - 0.2e1 * t1566 - 0.4e1 / 0.3e1 * t1569;
  t1756 = t178 * t843;
  t1758 = t178 * t846;
  t1768 = -0.8e1 / 0.3e1 * t1582 + 0.20e2 / 0.9e1 * t1593 - 0.8e1 / 0.3e1 * t1600 + 0.4e1 * t1608 + t1381 + 0.8e1 / 0.3e1 * t1383 - 0.12e2 * t1413 + 0.4e1 / 0.3e1 * t1756 - 0.2e1 * t1758 + 0.2e1 * t63 * t108 * t787 + 0.8e1 * t1616 - 0.4e1 * t1618 - 0.4e1 * t1417 + t1226 + 0.4e1 * t1228 - 0.36e2 * t1415;
  t1770 = my_piecewise3(t43, 0, t1749 + t1768);
  t1777 = t6 * t866 * t86 * t58;
  t1783 = t383 * t810;
  t1794 = -0.3e1 / 0.8e1 * t6 * t1770 * t19 * t58 - t1777 / 0.8e1 - 0.3e1 / 0.8e1 * t1637 + t1641 / 0.4e1 + t1442 - 0.5e1 / 0.12e2 * t1445 - 0.5e1 / 0.36e2 * t1264 + t1269 - 0.2e1 / 0.3e1 * t1783 - 0.2e1 * t802 * t388 - 0.3e1 / 0.2e1 * t802 * t392 + 0.2e1 * t333 * t889 + t333 * t893 + 0.8e1 / 0.9e1 * t333 * t875;
  t1795 = t6 * t792;
  t1803 = t383 * t815;
  t1806 = t153 * t336 * t888;
  t1809 = t153 * t336 * t892;
  t1812 = t153 * t336 * t874;
  t1814 = t878 * t337;
  t1817 = 0.3e1 / 0.2e1 * t1795 * t157 + t1541 / 0.3e1 + t1543 - 0.2e1 / 0.3e1 * t1545 - 0.2e1 / 0.3e1 * t1547 + 0.4e1 / 0.9e1 * t1550 - t1552 / 0.2e1 - t1803 / 0.2e1 + 0.2e1 / 0.3e1 * t1806 + t1809 / 0.3e1 + 0.8e1 / 0.27e2 * t1812 + t1814 / 0.2e1 - t1456 + 0.5e1 / 0.9e1 * t1459;
  t1819 = my_piecewise3(t40, 0, t1794 + t1817);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t753 + 0.3e1 * t819 + t840 + t896 + t7 * (t1702 + t1819);

  t1833 = my_piecewise3(t11, 0, t1084 + 0.64e2 * t1283 - 0.32e2 * t1476 + 0.320e3 / 0.27e2 * t1676 - 0.160e3 / 0.81e2 * t12 * t826 * rho[0] * t1241 * t1112);
  t1842 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1833 * t19 * t35 - t1690 / 0.2e1 + t1513 / 0.2e1 - 0.5e1 / 0.9e1 * t1341 + t1161);
  t1843 = t6 * t866;
  t1847 = t367 * t367;
  t1854 = t372 * t372;
  t1884 = -0.160e3 / 0.81e2 * t44 * t8 * t1244 * t1847 + 0.40e2 / 0.9e1 * t776 * t1703 * t372 - 0.4e1 / 0.3e1 * t44 * t366 * t1854 - 0.16e2 / 0.9e1 * t776 * t758 * t861 + 0.80e2 / 0.27e2 * t63 * t575 * t853 - 0.16e2 / 0.3e1 * t63 * t857 + 0.2e1 / 0.3e1 * t44 * t141 * (-0.24e2 * t242 + 0.24e2 * t1406) + 0.16e2 / 0.3e1 * t1756 - 0.8e1 * t1758 + 0.16e2 * t1616 + t1226 - 0.80e2 / 0.27e2 * t1745 - 0.8e1 / 0.3e1 * t1720 - 0.16e2 / 0.3e1 * t1600 + 0.8e1 * t1608 - 0.16e2 * t1413 + 0.8e1 / 0.3e1 * t63 * t108 * t861 - 0.48e2 * t1415 + 0.16e2 / 0.3e1 * t1716;
  t1885 = my_piecewise3(t43, 0, t1884);
  t1896 = 0.1e1 / t569;
  t1909 = 0.2e1 * t1843 * t157 - 0.3e1 / 0.8e1 * t6 * t1885 * t19 * t58 - t1777 / 0.2e1 + t1641 / 0.2e1 - 0.5e1 / 0.9e1 * t1445 + t1269 - 0.8e1 / 0.3e1 * t1783 + 0.32e2 / 0.9e1 * t383 * t875 - 0.32e2 / 0.27e2 * t153 * t154 * t1172 * t1896 - 0.4e1 * t878 * t388 + 0.4e1 * t383 * t893 - 0.22e2 / 0.3e1 * t153 * t154 * t226 * t1896;
  t1931 = -0.3e1 * t153 * t154 * params->ltafrac * t1896 - 0.16e2 / 0.3e1 * t153 * t154 * t535 * t1896 - 0.3e1 * t878 * t392 + 0.8e1 * t383 * t889 + 0.2e1 / 0.3e1 * t1541 - 0.4e1 / 0.3e1 * t1545 + 0.8e1 / 0.9e1 * t1550 - 0.2e1 * t1803 + 0.8e1 / 0.3e1 * t1806 + 0.4e1 / 0.3e1 * t1809 + 0.32e2 / 0.27e2 * t1812 + 0.2e1 * t1814 + 0.20e2 / 0.27e2 * t1459;
  t1933 = my_piecewise3(t40, 0, t1909 + t1931);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t840 + 0.4e1 * t896 + t7 * (t1842 + t1933);

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3lapl[7] = 0.0e0;

  t1939 = t536 * t164;
  t1945 = t910 * t918;
  t1951 = t6 * t210 * t407;
  t1957 = t91 * t1215 * t165 / 0.9e1;
  t1959 = t6 * t218 * t407;
  t1961 = t910 * t915;
  t1963 = t35 * t1172;
  t1967 = t541 * t401;
  t1972 = t214 * t907;
  t1974 = -0.3e1 / 0.10e2 * t1208 * t166 + 0.4e1 / 0.5e1 * t404 * t405 * t1939 - 0.6e1 / 0.5e1 * t904 * t918 - 0.2e1 / 0.5e1 * t1945 + 0.8e1 / 0.5e1 * t404 * t913 * t1939 + 0.4e1 / 0.5e1 * t1951 - 0.8e1 / 0.5e1 * t904 * t915 - t1957 - 0.4e1 / 0.15e2 * t1959 - 0.8e1 / 0.15e2 * t1961 + 0.32e2 / 0.45e2 * t404 * t1963 * t1939 - 0.3e1 / 0.10e2 * t1967 + 0.6e1 / 0.5e1 * t6 * t206 * t407 + t1972 / 0.5e1;
  t1975 = my_piecewise3(t2, 0, t1974);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[0] = t7 * t1975 + 0.3e1 * t922;

  t1980 = t709 * t415;
  t1982 = t333 * t929;
  t1986 = t153 * t1457 * t171 / 0.9e1;
  t1988 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t1450 * t172 - 0.3e1 / 0.10e2 * t1980 + t1982 / 0.5e1 - t1986);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[1] = t7 * t1988 + 0.3e1 * t933;

  t1990 = 0.2e1 * t945;
  t1994 = t638 * t401 / 0.5e1;
  t1998 = t294 * t907;
  t2002 = 0.4e1 / 0.15e2 * t6 * t290 * t407;
  t2013 = -0.3e1 / 0.10e2 * t1356 * t166 - t1994 + 0.4e1 / 0.5e1 * t6 * t286 * t407 + t1998 / 0.15e2 + t2002 - 0.8e1 / 0.15e2 * t939 * t915 - 0.2e1 / 0.5e1 * t939 * t918 - t1967 / 0.10e2 + 0.2e1 / 0.15e2 * t1972 + 0.4e1 / 0.15e2 * t1951 - t1957 - 0.8e1 / 0.45e2 * t1959 - 0.8e1 / 0.45e2 * t1961 - 0.2e1 / 0.15e2 * t1945;
  t2014 = my_piecewise3(t2, 0, t2013);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[2] = t7 * t2014 + t1990 + t922;

  t2016 = 0.2e1 * t959;
  t2020 = t802 * t415 / 0.5e1;
  t2021 = t383 * t929;
  t2030 = 0.4e1 / 0.15e2 * t6 * t261 * t431;
  t2032 = t6 * t265 * t431;
  t2035 = my_piecewise3(t40, 0, -0.3e1 / 0.10e2 * t1652 * t172 - t2020 + t2021 / 0.15e2 - t1980 / 0.10e2 + 0.2e1 / 0.15e2 * t1982 - t1986 + 0.2e1 / 0.5e1 * t6 * t257 * t431 + t2030 - 0.4e1 / 0.45e2 * t2032);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[3] = t7 * t2035 + t2016 + t933;

  t2039 = t746 * t401;
  t2048 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t1525 * t166 - t2039 / 0.10e2 + 0.2e1 / 0.5e1 * t6 * t354 * t407 - t1994 + 0.2e1 / 0.15e2 * t1998 + t2002 + t1972 / 0.15e2 - t1957 - 0.4e1 / 0.45e2 * t1959);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[4] = t7 * t2048 + t1990 + t966;

  t2052 = t878 * t415;
  t2059 = t6 * t328 * t431;
  t2065 = t955 * t978;
  t2069 = t955 * t981;
  t2071 = -0.3e1 / 0.10e2 * t1795 * t172 - t2052 / 0.10e2 - t2020 + 0.2e1 / 0.15e2 * t2021 + 0.4e1 / 0.5e1 * t6 * t324 * t431 + 0.4e1 / 0.15e2 * t2059 + t1982 / 0.15e2 - t1986 + t2030 - 0.8e1 / 0.45e2 * t2032 - 0.8e1 / 0.15e2 * t952 * t978 - 0.8e1 / 0.45e2 * t2065 - 0.2e1 / 0.5e1 * t952 * t981 - 0.2e1 / 0.15e2 * t2069;
  t2072 = my_piecewise3(t40, 0, t2071);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[5] = t7 * t2072 + t2016 + t985;

  t2080 = my_piecewise3(t2, 0, -0.3e1 / 0.10e2 * t1692 * t166 - 0.3e1 / 0.10e2 * t2039 + t1998 / 0.5e1 - t1957);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[6] = t7 * t2080 + 0.3e1 * t966;

  t2085 = t873 * t170;
  t2098 = t58 * t1172;
  t2109 = -0.3e1 / 0.10e2 * t1843 * t172 + 0.4e1 / 0.5e1 * t428 * t429 * t2085 - 0.6e1 / 0.5e1 * t972 * t981 + 0.8e1 / 0.5e1 * t428 * t976 * t2085 + 0.4e1 / 0.5e1 * t2059 - 0.8e1 / 0.15e2 * t2065 - 0.2e1 / 0.5e1 * t2069 - 0.4e1 / 0.15e2 * t2032 + 0.32e2 / 0.45e2 * t428 * t2098 * t2085 + 0.6e1 / 0.5e1 * t6 * t378 * t431 - 0.8e1 / 0.5e1 * t972 * t978 - 0.3e1 / 0.10e2 * t2052 + t2021 / 0.5e1 - t1986;
  t2110 = my_piecewise3(t40, 0, t2109);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3tau[7] = t7 * t2110 + 0.3e1 * t985;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmalapl[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigmatau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapl2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2lapltau[11] = 0.0e0;

  t2115 = t214 * t989;
  t2121 = 0.4e1 / 0.75e2 * t91 * t528 * t439;
  t2122 = t910 * t993;
  t2124 = t227 * t438;
  t2133 = t214 * t998;
  t2139 = t91 * t528 * t443 / 0.15e2;
  t2140 = t910 * t1001;
  t2145 = -0.6e1 / 0.25e2 * t541 * t440 - 0.4e1 / 0.25e2 * t2115 + 0.16e2 / 0.25e2 * t904 * t993 + t2121 + 0.16e2 / 0.75e2 * t2122 - 0.32e2 / 0.75e2 * t404 * t1963 * t2124 + 0.16e2 / 0.75e2 * t404 * t913 * t2124 + 0.3e1 / 0.10e2 * t541 * t444 + t2133 / 0.5e1 - 0.4e1 / 0.5e1 * t904 * t1001 - t2139 - 0.4e1 / 0.15e2 * t2140 + 0.2e1 / 0.5e1 * t404 * t405 * t2124;
  t2146 = my_piecewise3(t2, 0, t2145);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[0] = t7 * t2146 + 0.2e1 * t1005;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[1] = 0.0e0;

  t2151 = t333 * t1009;
  t2155 = 0.4e1 / 0.75e2 * t153 * t714 * t451;
  t2158 = t333 * t1014;
  t2162 = t153 * t714 * t455 / 0.15e2;
  t2164 = my_piecewise3(t40, 0, -0.6e1 / 0.25e2 * t709 * t452 - 0.4e1 / 0.25e2 * t2151 + t2155 + 0.3e1 / 0.10e2 * t709 * t456 + t2158 / 0.5e1 - t2162);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[2] = t7 * t2164 + 0.2e1 * t1018;

  t2168 = t294 * t989;
  t2176 = t294 * t998;
  t2182 = -0.6e1 / 0.25e2 * t638 * t440 - 0.2e1 / 0.25e2 * t2168 + 0.8e1 / 0.25e2 * t939 * t993 - 0.2e1 / 0.25e2 * t2115 + t2121 + 0.8e1 / 0.75e2 * t2122 + 0.3e1 / 0.10e2 * t638 * t444 + t2176 / 0.10e2 - 0.2e1 / 0.5e1 * t939 * t1001 + t2133 / 0.10e2 - t2139 - 0.2e1 / 0.15e2 * t2140;
  t2183 = my_piecewise3(t2, 0, t2182);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[3] = t7 * t2183 + t1005 + t1025;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[4] = 0.0e0;

  t2187 = t383 * t1009;
  t2192 = t955 * t1030;
  t2196 = t383 * t1014;
  t2201 = t955 * t1035;
  t2203 = -0.6e1 / 0.25e2 * t802 * t452 - 0.2e1 / 0.25e2 * t2187 - 0.2e1 / 0.25e2 * t2151 + t2155 + 0.8e1 / 0.25e2 * t952 * t1030 + 0.8e1 / 0.75e2 * t2192 + 0.3e1 / 0.10e2 * t802 * t456 + t2196 / 0.10e2 + t2158 / 0.10e2 - t2162 - 0.2e1 / 0.5e1 * t952 * t1035 - 0.2e1 / 0.15e2 * t2201;
  t2204 = my_piecewise3(t40, 0, t2203);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[5] = t7 * t2204 + t1018 + t1039;

  t2214 = my_piecewise3(t2, 0, -0.6e1 / 0.25e2 * t746 * t440 - 0.4e1 / 0.25e2 * t2168 + t2121 + 0.3e1 / 0.10e2 * t746 * t444 + t2176 / 0.5e1 - t2139);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[6] = t7 * t2214 + 0.2e1 * t1025;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[7] = 0.0e0;

  t2223 = t386 * t450;
  t2239 = -0.6e1 / 0.25e2 * t878 * t452 - 0.4e1 / 0.25e2 * t2187 + 0.16e2 / 0.25e2 * t972 * t1030 + t2155 + 0.16e2 / 0.75e2 * t2192 - 0.32e2 / 0.75e2 * t428 * t2098 * t2223 + 0.16e2 / 0.75e2 * t428 * t976 * t2223 + 0.3e1 / 0.10e2 * t878 * t456 + t2196 / 0.5e1 - 0.4e1 / 0.5e1 * t972 * t1035 - t2162 - 0.4e1 / 0.15e2 * t2201 + 0.2e1 / 0.5e1 * t428 * t429 * t2223;
  t2240 = my_piecewise3(t40, 0, t2239);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2tau2[8] = t7 * t2240 + 0.2e1 * t1039;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[20] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[21] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[22] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2lapl[23] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[20] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[21] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[22] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma2tau[23] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapl2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[20] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[21] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[22] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmalapltau[23] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigmatau2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapl2tau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rholapltau2[11] = 0.0e0;

  t2246 = 0.8e1 / 0.125e3 * t91 * t222 * t1043;
  t2247 = t93 * t1042;
  t2255 = 0.6e1 / 0.25e2 * t91 * t222 * t1047;
  t2263 = t91 * t222 * t1051 / 0.5e1;
  t2268 = my_piecewise3(t2, 0, -0.24e2 / 0.125e3 * t214 * t1044 - t2246 + 0.32e2 / 0.125e3 * t404 * t1963 * t2247 + 0.18e2 / 0.25e2 * t214 * t1048 + t2255 - 0.24e2 / 0.25e2 * t404 * t913 * t2247 - 0.3e1 / 0.5e1 * t214 * t1052 - t2263 + 0.4e1 / 0.5e1 * t404 * t405 * t2247);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[0] = t7 * t2268 + t1056;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[2] = 0.0e0;

  t2274 = 0.8e1 / 0.125e3 * t153 * t336 * t1059;
  t2279 = 0.6e1 / 0.25e2 * t153 * t336 * t1063;
  t2284 = t153 * t336 * t1067 / 0.5e1;
  t2286 = my_piecewise3(t40, 0, -0.24e2 / 0.125e3 * t333 * t1060 - t2274 + 0.18e2 / 0.25e2 * t333 * t1064 + t2279 - 0.3e1 / 0.5e1 * t333 * t1068 - t2284);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[3] = t7 * t2286 + t1072;

  t2295 = my_piecewise3(t2, 0, -0.24e2 / 0.125e3 * t294 * t1044 - t2246 + 0.18e2 / 0.25e2 * t294 * t1048 + t2255 - 0.3e1 / 0.5e1 * t294 * t1052 - t2263);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[4] = t7 * t2295 + t1056;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[6] = 0.0e0;

  t2299 = t155 * t1058;
  t2314 = my_piecewise3(t40, 0, -0.24e2 / 0.125e3 * t383 * t1060 - t2274 + 0.32e2 / 0.125e3 * t428 * t2098 * t2299 + 0.18e2 / 0.25e2 * t383 * t1064 + t2279 - 0.24e2 / 0.25e2 * t428 * t976 * t2299 - 0.3e1 / 0.5e1 * t383 * t1068 - t2284 + 0.4e1 / 0.5e1 * t428 * t429 * t2299);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhotau3[7] = t7 * t2314 + t1072;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3lapl[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma3tau[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapl2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[18] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[19] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[20] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[21] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[22] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2lapltau[23] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma2tau2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapl2tau[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmalapltau2[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigmatau3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl3tau[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapl2tau2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[0] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4lapltau3[7] = 0.0e0;

  t2316 = t437 * t437;
  t2317 = 0.1e1 / t2316;
  t2335 = my_piecewise3(t2, 0, -0.96e2 / 0.625e3 * t91 * t92 * t1172 * t2317 + 0.144e3 / 0.125e3 * t91 * t92 * t535 * t2317 - 0.66e2 / 0.25e2 * t91 * t92 * t226 * t2317 + 0.9e1 / 0.5e1 * t91 * t92 * params->ltafrac * t2317);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[0] = t7 * t2335;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[3] = 0.0e0;

  t2336 = t449 * t449;
  t2337 = 0.1e1 / t2336;
  t2355 = my_piecewise3(t40, 0, -0.96e2 / 0.625e3 * t153 * t154 * t1172 * t2337 + 0.144e3 / 0.125e3 * t153 * t154 * t535 * t2337 - 0.66e2 / 0.25e2 * t153 * t154 * t226 * t2337 + 0.9e1 / 0.5e1 * t153 * t154 * params->ltafrac * t2337);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4tau4[4] = t7 * t2355;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

