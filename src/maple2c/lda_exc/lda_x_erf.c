/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/lda_exc/lda_x_erf.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->hyb_omega[0];
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->hyb_omega[0];
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->hyb_omega[0];
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t273, t276, t281, t286, t291, t296, t301;
  double t304, t307, t311, t314, t323, t324, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->hyb_omega[0];
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t273 = t163 * t93;
  t276 = t35 * t93;
  t281 = t38 * t93;
  t286 = t41 * t93;
  t291 = t44 * t93;
  t296 = t47 * t93;
  t301 = t50 * t93;
  t304 = -0.2e1 / 0.3e1 * t97 * t273 + t276 * t173 / 0.2e1 + t101 * t273 / 0.8e1 - t281 * t173 / 0.16e2 - t105 * t273 / 0.8e2 + 0.3e1 / 0.64e3 * t286 * t173 + t109 * t273 / 0.1152e4 - t291 * t173 / 0.384e4 - t113 * t273 / 0.21504e5 + t296 * t173 / 0.86016e5 + t117 * t273 / 0.49152e6 - t301 * t173 / 0.229376e7;
  t307 = t53 * t93;
  t311 = 0.1e1 / t52 / t86;
  t314 = t201 * t93;
  t323 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t324 = my_piecewise3(t29, -t323, 0);
  t341 = -t121 * t273 / 0.1327104e8 + t307 * t173 / 0.7077888e8 + t311 * t273 / 0.4128768e9 - t314 * t173 / 0.24772608e10 - t87 * t324 / 0.18e2 + t97 * t324 / 0.24e3 - t101 * t324 / 0.448e4 + t105 * t324 / 0.10368e6 - t109 * t324 / 0.2838528e7 + t113 * t324 / 0.8945664e8 - t117 * t324 / 0.31850496e10 + t121 * t324 / 0.1263403008e12;
  t343 = my_piecewise3(t29, 0, -t323);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t304 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t273, t276, t281, t286, t291, t296, t301;
  double t304, t307, t311, t314, t323, t324, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;

  double t438, t444, t445, t462, t465, t490, t539, t541;
  double t550, t576, t585, t613, t648, t652, tv4rho40;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->hyb_omega[0];
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t273 = t163 * t93;
  t276 = t35 * t93;
  t281 = t38 * t93;
  t286 = t41 * t93;
  t291 = t44 * t93;
  t296 = t47 * t93;
  t301 = t50 * t93;
  t304 = -0.2e1 / 0.3e1 * t97 * t273 + t276 * t173 / 0.2e1 + t101 * t273 / 0.8e1 - t281 * t173 / 0.16e2 - t105 * t273 / 0.8e2 + 0.3e1 / 0.64e3 * t286 * t173 + t109 * t273 / 0.1152e4 - t291 * t173 / 0.384e4 - t113 * t273 / 0.21504e5 + t296 * t173 / 0.86016e5 + t117 * t273 / 0.49152e6 - t301 * t173 / 0.229376e7;
  t307 = t53 * t93;
  t311 = 0.1e1 / t52 / t86;
  t314 = t201 * t93;
  t323 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t324 = my_piecewise3(t29, -t323, 0);
  t341 = -t121 * t273 / 0.1327104e8 + t307 * t173 / 0.7077888e8 + t311 * t273 / 0.4128768e9 - t314 * t173 / 0.24772608e10 - t87 * t324 / 0.18e2 + t97 * t324 / 0.24e3 - t101 * t324 / 0.448e4 + t105 * t324 / 0.10368e6 - t109 * t324 / 0.2838528e7 + t113 * t324 / 0.8945664e8 - t117 * t324 / 0.31850496e10 + t121 * t324 / 0.1263403008e12;
  t343 = my_piecewise3(t29, 0, -t323);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t304 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t438 = t166 * t166;
  t444 = 0.14e3 / 0.729e3 * t20 * t1 / t15 / t438 * t24;
  t445 = my_piecewise3(t29, t444, 0);
  t462 = t173 * t173;
  t465 = t163 * t163;
  t490 = -t87 * t445 / 0.18e2 + t97 * t445 / 0.24e3 - t101 * t445 / 0.448e4 + t105 * t445 / 0.10368e6 - t109 * t445 / 0.2838528e7 + t113 * t445 / 0.8945664e8 - t117 * t445 / 0.31850496e10 + t121 * t445 / 0.1263403008e12 + t47 * t462 / 0.86016e5 - t53 * t465 / 0.32768e5 - t50 * t462 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t201 * t465 + t53 * t462 / 0.7077888e8 - 0.19e2 / 0.4128768e9 / t52 / t34 * t465 - t201 * t462 / 0.24772608e10 + 0.1e2 / 0.3e1 * t38 * t465 + t35 * t462 / 0.2e1 - 0.7e1 / 0.8e1 * t41 * t465 - t38 * t462 / 0.16e2 + 0.9e1 / 0.8e2 * t44 * t465;
  t539 = 0.3e1 / 0.64e3 * t41 * t462 - 0.11e2 / 0.1152e4 * t47 * t465 - t44 * t462 / 0.384e4 + 0.13e2 / 0.21504e5 * t50 * t465 + t296 * t324 / 0.64512e5 + t117 * t163 * t173 / 0.8192e5 - t301 * t324 / 0.172032e7 - t121 * t163 * t173 / 0.221184e7 + t307 * t324 / 0.5308416e8 + t311 * t163 * t173 / 0.688128e8 - t314 * t324 / 0.18579456e10 - 0.4e1 * t97 * t163 * t173 + 0.2e1 / 0.3e1 * t276 * t324 + 0.3e1 / 0.4e1 * t101 * t163 * t173 - t281 * t324 / 0.12e2 - 0.3e1 / 0.4e2 * t105 * t163 * t173 + t286 * t324 / 0.16e3 + t109 * t163 * t173 / 0.192e3 - t291 * t324 / 0.288e4 - t113 * t163 * t173 / 0.3584e4;
  t541 = my_piecewise3(t29, 0, t444);
  t550 = t215 * t215;
  t576 = t207 * t207;
  t585 = t65 * t343;
  t613 = 0.85e2 / 0.4e1 * t359 * t550 * t65 - 0.19e2 / 0.8e1 / t358 / t62 * t550 * t65 + t132 * t541 * t65 / 0.2e1 + 0.1e1 / t358 / t212 * t550 * t65 / 0.16e2 - 0.12e2 * t576 * t66 - 0.16e2 * t399 * t343 - 0.4e1 * t136 * t541 - t58 * t541 * t65 - 0.8e1 * t379 * t585 - 0.15e2 * t383 * t215 * t355 + t235 * t343 * t391 + 0.3e1 / 0.4e1 * t235 * t576 * t65 + 0.3e1 / 0.4e1 * t395 * t207 * t215 * t65 - 0.3e1 * t63 * t576 * t65 - 0.4e1 * t402 * t585 - 0.75e2 / 0.2e1 * t235 * t550 * t65 + 0.45e2 * t216 * t355 - 0.6e1 * t227 * t576 * t65;
  t648 = 0.15e2 / 0.4e1 * t395 * t550 * t65 - 0.1e1 / t358 / t131 * t550 * t65 / 0.8e1 - t127 * t541 + 0.2e1 * t56 * t613 + 0.2e1 * t541 * t69 + 0.8e1 * t343 * t141 + 0.12e2 * t207 * t247 + 0.8e1 * t125 * t409 + 0.24e2 * t65 * t214 * t550 - 0.36e2 * t363 * t215 * t207 + 0.6e1 * t219 * t576 + 0.8e1 * t219 * t125 * t343 - 0.24e2 * t383 * t550 * t65 + 0.21e2 * t236 * t355 - 0.3e1 / 0.2e1 * t214 * t576 * t65 - 0.2e1 * t354 * t585 - 0.3e1 / 0.2e1 * t359 * t215 * t355;
  t652 = my_piecewise3(t28, t490 + t539, -0.8e1 / 0.3e1 * t541 * t72 - 0.32e2 / 0.3e1 * t343 * t144 - 0.16e2 * t207 * t250 - 0.32e2 / 0.3e1 * t125 * t412 - 0.8e1 / 0.3e1 * t56 * t648);
  tv4rho40 = -0.5e1 / 0.54e2 * t7 * t14 / t153 / t166 * t76 + 0.2e1 / 0.9e1 * t7 * t14 * t260 * t148 - t7 * t14 * t154 * t254 / 0.2e1 - t7 * t14 * t15 * t416 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t652;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->hyb_omega[0];
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->hyb_omega[0];
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->hyb_omega[0];
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->hyb_omega[0] * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1276, t1278, t1279, t1281, t1284, t1285, t1287;
  double t1288, t1289, t1291, t1292, t1294, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1331, t1334, t1339, t1344, t1349, t1354, t1359, t1362;
  double t1365, t1369, t1372, t1377, t1380, t1382, t1385, t1388;
  double t1390, t1391, t1392, t1393, t1397, t1401, t1403, t1406;
  double t1412, t1413, t1417, t1418, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1542, t1545;
  double t1550, t1555, t1560, t1565, t1570, t1573, t1576, t1580;
  double t1583, t1588, t1590, t1593, t1596, t1598, t1599, t1600;
  double t1601, t1605, t1609, t1611, t1614, t1620, t1621, t1625;
  double t1626, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1680, t1684, t1685, t1695, t1696, t1707, t1710, t1714;
  double t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30, t1737;
  double t1749, t1750, t1751, t1753, t1756, t1757, t1759, t1762;
  double t1763, t1764, t1766, t1768, t1770, t1771, t1773, t1777;
  double t1787, t1788, t1790, t1793, t1796, t1797, t1799, t1802;
  double t1805, t1807, t1809, t1810, t1811, t1816, t1821, t1826;
  double t1831, t1836, t1841, t1846, t1851, t1866, t1873, t1875;
  double t1878, t1881, t1882, t1883, t1887, t1891, t1895, t1898;
  double t1903, t1908, t1909, t1913, t1914, t1931, t1933, t1946;
  double t1949, t1952, t1974, t1975, t1978, t1981, t1989, t1994;
  double t1997, t2002, t2010, t2013, t2017, t2018, t2020, t2024;
  double t2034, t2035, t2037, t2040, t2043, t2044, t2046, t2049;
  double t2052, t2054, t2056, t2057, t2058, t2063, t2068, t2073;
  double t2078, t2083, t2088, t2093, t2098, t2113, t2120, t2122;
  double t2125, t2128, t2129, t2130, t2134, t2138, t2142, t2145;
  double t2150, t2155, t2156, t2160, t2161, t2178, t2180, t2193;
  double t2196, t2199, t2221, t2222, t2225, t2228, t2236, t2241;
  double t2244, t2249, t2257, t2260, t2264, t2265, t2267, t2269;
  double t2272, t2273, t2274, t2275, t2276, t2277, t2278, t2279;
  double t2280, tv3rho31, t2289, t2290, t2292, t2295, t2298, t2301;
  double t2303, t2305, t2308, t2311, t2313, t2318, t2321, t2326;
  double t2329, t2334, t2337, t2342, t2345, t2350, t2353, t2356;
  double t2359, t2362, t2367, t2370, t2375, t2381, t2383, t2387;
  double t2392, t2394, t2398, t2403, t2408, t2409, t2412, t2413;
  double t2417, t2418, t2435, t2437, t2451, t2460, t2481, t2484;
  double t2490, t2495, t2498, t2501, t2511, t2514, t2518, t2519;
  double t2521, t2529, t2533, t2534, t2536, t2539, t2542, t2545;
  double t2548, t2550, t2555, t2558, t2563, t2566, t2571, t2574;
  double t2579, t2582, t2587, t2590, t2593, t2596, t2599, t2604;
  double t2607, t2612, t2618, t2620, t2624, t2629, t2631, t2635;
  double t2640, t2643, t2646, t2647, t2651, t2652, t2669, t2671;
  double t2685, t2694, t2715, t2718, t2724, t2729, t2732, t2735;
  double t2745, t2748, t2752, t2753, t2755, t2766, t2767, t2769;
  double t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32, t2795;
  double t2801, t2805, t2806, t2808, t2809, t2811, t2812, t2814;
  double t2815, t2819, t2820, t2824, t2828, t2832, t2835, t2836;
  double t2840, t2841, t2858, t2867, t2892, t2894, t2901, t2902;
  double t2907, t2912, t2927, t2935, t2946, t2949, t2953, t2954;
  double t2956, t2957, t2958, t2963, t2967, t2968, t2970, t2971;
  double t2973, t2974, t2976, t2977, t2980, t3000, t3001, t3005;
  double t3009, t3013, t3016, t3017, t3021, t3022, t3029, t3054;
  double t3056, t3063, t3064, t3069, t3074, t3089, t3097, t3108;
  double t3111, t3115, t3116, t3118, t3119, t3120, t3121, t3122;
  double t3123, t3124, tv3rho33;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->hyb_omega[0];
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->hyb_omega[0] * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = 0.1e1 / t163 / t152;
  t1276 = t1275 * t145;
  t1278 = t7 * t92 * t1276;
  t1279 = 0.5e1 / 0.144e3 * t1278;
  t1281 = t7 * t622 * t257;
  t1284 = t7 * t253 * t632;
  t1285 = t1284 / 0.16e2;
  t1287 = t7 * t159 * t488;
  t1288 = t1287 / 0.16e2;
  t1289 = t1275 * t83;
  t1291 = t7 * t21 * t1289;
  t1292 = 0.5e1 / 0.144e3 * t1291;
  t1294 = t7 * t476 * t165;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1331 = t496 * t189;
  t1334 = t42 * t189;
  t1339 = t45 * t189;
  t1344 = t48 * t189;
  t1349 = t51 * t189;
  t1354 = t54 * t189;
  t1359 = t57 * t189;
  t1362 = -0.2e1 / 0.3e1 * t193 * t1331 + t1334 * t528 / 0.2e1 + t197 * t1331 / 0.8e1 - t1339 * t528 / 0.16e2 - t201 * t1331 / 0.8e2 + 0.3e1 / 0.64e3 * t1344 * t528 + t205 * t1331 / 0.1152e4 - t1349 * t528 / 0.384e4 - t209 * t1331 / 0.21504e5 + t1354 * t528 / 0.86016e5 + t213 * t1331 / 0.49152e6 - t1359 * t528 / 0.229376e7;
  t1365 = t60 * t189;
  t1369 = 0.1e1 / t59 / t169;
  t1372 = t556 * t189;
  t1377 = t1 / t22 / t467;
  t1380 = 0.14e2 / 0.243e3 * t27 * t1377 * t31;
  t1382 = t27 * t501 * t184;
  t1385 = t27 * t173 * t511;
  t1388 = t27 * t173 * t523;
  t1390 = t177 * t177;
  t1391 = 0.1e1 / t1390;
  t1392 = t510 * t183;
  t1393 = t1391 * t1392;
  t1397 = t183 * t522;
  t1401 = t14 * t14;
  t1403 = 0.1e1 / t179 / t1401;
  t1406 = t516 * t155;
  t1412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1403 * t1296 - 0.2e1 / 0.3e1 * t1406 * t471 + t180 * t1305 / 0.3e1);
  t1413 = t178 * t1412;
  t1417 = -t1380 - 0.2e1 / 0.27e2 * t1382 - t1385 / 0.9e1 + t1388 / 0.18e2 - t27 * t29 * t1393 / 0.3e1 + t791 * t792 * t1397 / 0.3e1 - t27 * t29 * t1413 / 0.18e2;
  t1418 = my_piecewise3(t36, t1417, 0);
  t1435 = -t217 * t1331 / 0.1327104e8 + t1365 * t528 / 0.7077888e8 + t1369 * t1331 / 0.4128768e9 - t1372 * t528 / 0.24772608e10 - t170 * t1418 / 0.18e2 + t193 * t1418 / 0.24e3 - t197 * t1418 / 0.448e4 + t201 * t1418 / 0.10368e6 - t205 * t1418 / 0.2838528e7 + t209 * t1418 / 0.8945664e8 - t213 * t1418 / 0.31850496e10 + t217 * t1418 / 0.1263403008e12;
  t1437 = my_piecewise3(t36, 0, t1417);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1362 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1542 = t640 * t278;
  t1545 = t105 * t278;
  t1550 = t108 * t278;
  t1555 = t111 * t278;
  t1560 = t114 * t278;
  t1565 = t117 * t278;
  t1570 = t120 * t278;
  t1573 = -0.2e1 / 0.3e1 * t282 * t1542 + t1545 * t669 / 0.2e1 + t286 * t1542 / 0.8e1 - t1550 * t669 / 0.16e2 - t290 * t1542 / 0.8e2 + 0.3e1 / 0.64e3 * t1555 * t669 + t294 * t1542 / 0.1152e4 - t1560 * t669 / 0.384e4 - t298 * t1542 / 0.21504e5 + t1565 * t669 / 0.86016e5 + t302 * t1542 / 0.49152e6 - t1570 * t669 / 0.229376e7;
  t1576 = t123 * t278;
  t1580 = 0.1e1 / t122 / t261;
  t1583 = t697 * t278;
  t1588 = 0.14e2 / 0.243e3 * t27 * t1377 * t94;
  t1590 = t27 * t501 * t273;
  t1593 = t27 * t173 * t652;
  t1596 = t27 * t173 * t664;
  t1598 = t266 * t266;
  t1599 = 0.1e1 / t1598;
  t1600 = t651 * t272;
  t1601 = t1599 * t1600;
  t1605 = t272 * t663;
  t1609 = t87 * t87;
  t1611 = 0.1e1 / t268 / t1609;
  t1614 = t657 * t249;
  t1620 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1611 * t1511 - 0.2e1 / 0.3e1 * t1614 * t617 + t269 * t1516 / 0.3e1);
  t1621 = t267 * t1620;
  t1625 = -t1588 - 0.2e1 / 0.27e2 * t1590 - t1593 / 0.9e1 + t1596 / 0.18e2 - t27 * t29 * t1601 / 0.3e1 + t791 * t931 * t1605 / 0.3e1 - t27 * t29 * t1621 / 0.18e2;
  t1626 = my_piecewise3(t99, t1625, 0);
  t1643 = -t306 * t1542 / 0.1327104e8 + t1576 * t669 / 0.7077888e8 + t1580 * t1542 / 0.4128768e9 - t1583 * t669 / 0.24772608e10 - t262 * t1626 / 0.18e2 + t282 * t1626 / 0.24e3 - t286 * t1626 / 0.448e4 + t290 * t1626 / 0.10368e6 - t294 * t1626 / 0.2838528e7 + t298 * t1626 / 0.8945664e8 - t302 * t1626 / 0.31850496e10 + t306 * t1626 / 0.1263403008e12;
  t1645 = my_piecewise3(t99, 0, t1625);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t310 * t703 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1573 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = -t1279 - 0.3e1 / 0.32e2 * t1281 + t1285 + t1288 - t1292 - 0.3e1 / 0.32e2 * t1294 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t905 * t257;
  t1757 = t1756 / 0.16e2;
  t1759 = t7 * t402 * t632;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = -t1279 - t1281 / 0.32e2 + t1284 / 0.24e2 + t1287 / 0.24e2 - t1292 - t1294 / 0.32e2 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 - t1757 + t1759 / 0.48e2 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t42 * t810;
  t1816 = t45 * t810;
  t1821 = t48 * t810;
  t1826 = t51 * t810;
  t1831 = t54 * t810;
  t1836 = t57 * t810;
  t1841 = t60 * t810;
  t1846 = t556 * t810;
  t1851 = t1811 * t189 / 0.3e1 + t783 * t528 / 0.6e1 - t1816 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1821 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1826 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1831 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1836 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1841 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9 - t1846 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10;
  t1866 = t1369 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1391;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1403 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1380 - 0.4e1 / 0.81e2 * t1382 - t1385 / 0.27e2 + t1388 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t108 * t949;
  t2063 = t111 * t949;
  t2068 = t114 * t949;
  t2073 = t117 * t949;
  t2078 = t120 * t949;
  t2083 = t123 * t949;
  t2088 = t697 * t949;
  t2093 = t105 * t949;
  t2098 = -t2058 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2063 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2068 * t278 / 0.576e4 - t962 * t669 / 0.1152e5 + t2073 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2078 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2083 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2088 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10 + t2093 * t278 / 0.3e1 + t924 * t669 / 0.6e1;
  t2113 = t1580 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1599;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1611 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1588 - 0.4e1 / 0.81e2 * t1590 - t1593 / 0.27e2 + t1596 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = -t1279 + t1284 / 0.48e2 + t1287 / 0.48e2 - t1292 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 - t1757 + t1759 / 0.24e2 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2290 = t164 * t1267;
  t2292 = t7 * t92 * t2290;
  t2295 = t7 * t1166 * t257;
  t2298 = t7 * t402 * t920;
  t2301 = t7 * t344 * t779;
  t2303 = t164 * t1153;
  t2305 = t7 * t21 * t2303;
  t2308 = t7 * t1052 * t165;
  t2311 = t7 * t159 * t1154;
  t2313 = t193 * t1061;
  t2318 = t42 * t1081;
  t2321 = t197 * t1061;
  t2326 = t45 * t1081;
  t2329 = t201 * t1061;
  t2334 = t48 * t1081;
  t2337 = t205 * t1061;
  t2342 = t51 * t1081;
  t2345 = t209 * t1061;
  t2350 = t54 * t1081;
  t2353 = t213 * t1061;
  t2356 = -0.2e1 / 0.3e1 * t2313 * t189 + t783 * t810 / 0.3e1 + t2318 * t189 / 0.6e1 + t2321 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2326 * t189 / 0.48e2 - t2329 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2334 * t189 / 0.64e3 + t2337 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2342 * t189 / 0.1152e5 - t2345 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2350 * t189 / 0.258048e6 + t2353 * t189 / 0.49152e6;
  t2359 = t57 * t1081;
  t2362 = t217 * t1061;
  t2367 = t60 * t1081;
  t2370 = t1369 * t1061;
  t2375 = t556 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1403 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1380 - 0.2e1 / 0.81e2 * t1382 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t833 * t810 / 0.344064e7 - t2359 * t189 / 0.688128e7 - t2362 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2367 * t189 / 0.21233664e9 + t2370 * t189 / 0.4128768e9 - t843 * t810 / 0.37158912e10 - t2375 * t189 / 0.74317824e10 + t217 * t2418 / 0.1263403008e12 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2550 = t306 * t1175;
  t2555 = t123 * t1195;
  t2558 = t1580 * t1175;
  t2563 = t697 * t1195;
  t2566 = t282 * t1175;
  t2571 = t105 * t1195;
  t2574 = t286 * t1175;
  t2579 = t108 * t1195;
  t2582 = t290 * t1175;
  t2587 = t111 * t1195;
  t2590 = t294 * t1175;
  t2593 = -t2550 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2555 * t278 / 0.21233664e9 + t2558 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2563 * t278 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2566 * t278 + t924 * t949 / 0.3e1 + t2571 * t278 / 0.6e1 + t2574 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2579 * t278 / 0.48e2 - t2582 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2587 * t278 / 0.64e3 + t2590 * t278 / 0.1152e4;
  t2596 = t114 * t1195;
  t2599 = t298 * t1175;
  t2604 = t117 * t1195;
  t2607 = t302 * t1175;
  t2612 = t120 * t1195;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1611 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1588 - 0.2e1 / 0.81e2 * t1590 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t962 * t949 / 0.576e4 - t2596 * t278 / 0.1152e5 - t2599 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2604 * t278 / 0.258048e6 + t2607 * t278 / 0.49152e6 - t972 * t949 / 0.344064e7 - t2612 * t278 / 0.688128e7 - t262 * t2652 / 0.18e2 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2593 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2292 / 0.32e2 - t2295 / 0.32e2 - t2298 / 0.16e2 - t2301 / 0.16e2 - t2305 / 0.32e2 - t2308 / 0.32e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1599 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1611 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1588 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = -t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 + t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1580 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2980 = t1061 * t356;
  t3000 = t1065 * t350;
  t3001 = t1391 * t3000;
  t3005 = t350 * t1075;
  t3009 = t1403 * t2958;
  t3013 = t180 * t2963;
  t3016 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t3009 - 0.2e1 / 0.3e1 * t797 * t1047 + t3013 / 0.3e1);
  t3017 = t178 * t3016;
  t3021 = -t1380 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t3001 / 0.3e1 + t791 * t792 * t3005 / 0.3e1 - t27 * t29 * t3017 / 0.18e2;
  t3022 = my_piecewise3(t36, t3021, 0);
  t3029 = -t823 * t1081 / 0.384e4 - t209 * t2980 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t2980 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t2980 / 0.1327104e8 + t838 * t1081 / 0.7077888e8 + t1369 * t2980 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - t170 * t3022 / 0.18e2 + t193 * t3022 / 0.24e3 - t197 * t3022 / 0.448e4;
  t3054 = t201 * t3022 / 0.10368e6 - t205 * t3022 / 0.2838528e7 + t209 * t3022 / 0.8945664e8 - t213 * t3022 / 0.31850496e10 + t217 * t3022 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t193 * t2980 + t783 * t1081 / 0.2e1 + t197 * t2980 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t2980 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t2980 / 0.1152e4;
  t3056 = my_piecewise3(t36, 0, t3021);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3029 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1759 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.32e2 * t2292 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.16e2 * t2298 - 0.3e1 / 0.16e2 * t2301 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.32e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1279 - t1292;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1276, t1278, t1279, t1281, t1284, t1285, t1287;
  double t1288, t1289, t1291, t1292, t1294, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1331, t1334, t1339, t1344, t1349, t1354, t1359, t1362;
  double t1365, t1369, t1372, t1377, t1380, t1382, t1385, t1388;
  double t1390, t1391, t1392, t1393, t1397, t1401, t1403, t1406;
  double t1412, t1413, t1417, t1418, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1542, t1545;
  double t1550, t1555, t1560, t1565, t1570, t1573, t1576, t1580;
  double t1583, t1588, t1590, t1593, t1596, t1598, t1599, t1600;
  double t1601, t1605, t1609, t1611, t1614, t1620, t1621, t1625;
  double t1626, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1680, t1684, t1685, t1695, t1696, t1707, t1710, t1714;
  double t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30, t1737;
  double t1749, t1750, t1751, t1753, t1756, t1757, t1759, t1762;
  double t1763, t1764, t1766, t1768, t1770, t1771, t1773, t1777;
  double t1787, t1788, t1790, t1793, t1796, t1797, t1799, t1802;
  double t1805, t1807, t1809, t1810, t1811, t1816, t1821, t1826;
  double t1831, t1836, t1841, t1846, t1851, t1866, t1873, t1875;
  double t1878, t1881, t1882, t1883, t1887, t1891, t1895, t1898;
  double t1903, t1908, t1909, t1913, t1914, t1931, t1933, t1946;
  double t1949, t1952, t1974, t1975, t1978, t1981, t1989, t1994;
  double t1997, t2002, t2010, t2013, t2017, t2018, t2020, t2024;
  double t2034, t2035, t2037, t2040, t2043, t2044, t2046, t2049;
  double t2052, t2054, t2056, t2057, t2058, t2063, t2068, t2073;
  double t2078, t2083, t2088, t2093, t2098, t2113, t2120, t2122;
  double t2125, t2128, t2129, t2130, t2134, t2138, t2142, t2145;
  double t2150, t2155, t2156, t2160, t2161, t2178, t2180, t2193;
  double t2196, t2199, t2221, t2222, t2225, t2228, t2236, t2241;
  double t2244, t2249, t2257, t2260, t2264, t2265, t2267, t2269;
  double t2272, t2273, t2274, t2275, t2276, t2277, t2278, t2279;
  double t2280, tv3rho31, t2289, t2290, t2292, t2295, t2298, t2301;
  double t2303, t2305, t2308, t2311, t2313, t2318, t2321, t2326;
  double t2329, t2334, t2337, t2342, t2345, t2350, t2353, t2356;
  double t2359, t2362, t2367, t2370, t2375, t2381, t2383, t2387;
  double t2392, t2394, t2398, t2403, t2408, t2409, t2412, t2413;
  double t2417, t2418, t2435, t2437, t2451, t2460, t2481, t2484;
  double t2490, t2495, t2498, t2501, t2511, t2514, t2518, t2519;
  double t2521, t2529, t2533, t2534, t2536, t2539, t2542, t2545;
  double t2548, t2550, t2555, t2558, t2563, t2566, t2571, t2574;
  double t2579, t2582, t2587, t2590, t2593, t2596, t2599, t2604;
  double t2607, t2612, t2618, t2620, t2624, t2629, t2631, t2635;
  double t2640, t2643, t2646, t2647, t2651, t2652, t2669, t2671;
  double t2685, t2694, t2715, t2718, t2724, t2729, t2732, t2735;
  double t2745, t2748, t2752, t2753, t2755, t2766, t2767, t2769;
  double t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32, t2795;
  double t2801, t2805, t2806, t2808, t2809, t2811, t2812, t2814;
  double t2815, t2819, t2820, t2824, t2828, t2832, t2835, t2836;
  double t2840, t2841, t2858, t2867, t2892, t2894, t2901, t2902;
  double t2907, t2912, t2927, t2935, t2946, t2949, t2953, t2954;
  double t2956, t2957, t2958, t2963, t2967, t2968, t2970, t2971;
  double t2973, t2974, t2976, t2977, t2980, t3000, t3001, t3005;
  double t3009, t3013, t3016, t3017, t3021, t3022, t3029, t3054;
  double t3056, t3063, t3064, t3069, t3074, t3089, t3097, t3108;
  double t3111, t3115, t3116, t3118, t3119, t3120, t3121, t3122;
  double t3123, t3124, tv3rho33;

  double t3176, t3179, t3186, t3202, t3215, t3218, t3220, t3223;
  double t3226, t3229, t3232, t3235, t3238, t3239, t3248, t3259;
  double t3260, t3266, t3272, t3273, t3275, t3279, t3284, t3285;
  double t3302, t3304, t3313, t3318, t3326, t3330, t3343, t3353;
  double t3377, t3398, t3409, t3413, t3419, t3423, t3426, t3429;
  double t3432, t3435, t3438, t3442, t3445, t3448, t3492, t3494;
  double t3497, t3500, t3503, t3506, t3509, t3512, t3513, t3522;
  double t3533, t3534, t3540, t3545, t3549, t3554, t3555, t3564;
  double t3573, t3576, t3604, t3609, t3611, t3620, t3625, t3626;
  double t3632, t3650, t3658, t3696, t3712, t3716, t3720, t3736;
  double t3747, t3749, t3762, t3774, t3781, t3785, t3788, t3791;
  double t3795, t3799, t3801, t3808, t3812, t3814, t3817, t3821;
  double t3838, tv4rho40, t3843, t3846, t3847, t3849, t3852, t3856;
  double t3857, t3859, t3862, t3865, t3866, t3868, t3871, t3875;
  double t3876, t3878, t3880, t3909, t3946, t3977, t3991, t3993;
  double t3995, t4004, t4008, t4009, t4011, t4014, t4036, t4039;
  double t4045, t4048, t4056, t4058, t4064, t4065, t4067, t4075;
  double t4076, t4077, t4094, t4097, t4117, t4143, t4150, t4153;
  double t4154, t4183, t4206, t4213, t4234, t4240, t4245, t4267;
  double t4269, t4274, t4282, t4290, t4319, t4356, t4388, t4401;
  double t4409, t4411, t4429, t4433, t4434, t4436, t4440, t4443;
  double t4444, t4446, t4452, t4455, t4461, t4464, t4472, t4474;
  double t4485, t4486, t4487, t4504, t4507, t4536, t4554, t4564;
  double t4575, t4578, t4589, t4614, t4621, t4647, t4650, t4655;
  double t4677, t4679, t4691, t4707, t4709, t4716, t4719, t4722;
  double t4723, t4726, t4729, t4730, t4732, t4735, t4736, t4739;
  double t4742, t4743, t4749, t4763, t4772, t4778, t4779, t4781;
  double t4782, t4783, t4786, t4788, t4791, t4795, t4799, t4801;
  double tv4rho41, t4803, t4820, t4832, t4838, t4843, t4846, t4862;
  double t4868, t4870, t4876, t4884, t4886, t4889, t4900, t4922;
  double t4923, t4924, t4939, t4977, t5022, t5061, t5064, t5081;
  double t5104, t5116, t5160, t5163, t5166, t5178, t5203, t5228;
  double t5233, t5239, t5243, t5246, t5249, t5253, t5256, t5260;
  double t5263, t5265, t5303, t5344, t5387, t5400, t5421, t5427;
  double t5430, t5432, t5438, t5446, t5460, t5463, t5474, t5484;
  double t5485, t5486, t5503, t5520, t5523, t5558, t5575, t5579;
  double t5621, t5626, t5627, t5635, t5666, t5687, t5692, t5717;
  double t5726, t5729, t5732, t5735, t5738, t5741, t5743, t5745;
  double t5749, t5752, t5755, t5786, t5821, t5841, t5858, t5872;
  double t5887, t5903, t5918, tv4rho42, t5920, t5947, t5957, t5971;
  double t5982, t5985, t5995, t5999, t6004, t6005, t6006, t6019;
  double t6024, t6027, t6030, t6033, t6036, t6039, t6042, t6045;
  double t6057, t6091, t6123, t6126, t6171, t6172, t6175, t6205;
  double t6214, t6244, t6259, t6264, t6273, t6276, t6283, t6287;
  double t6294, t6297, t6300, t6303, t6306, t6309, t6312, t6316;
  double t6318, t6345, t6355, t6369, t6392, t6397, t6398, t6399;
  double t6412, t6444, t6459, t6462, t6465, t6483, t6516, t6519;
  double t6534, t6551, t6564, t6598, t6610, t6639, t6652, t6657;
  double t6677, t6691, t6725, t6739, t6748, t6752, t6756, t6765;
  double t6778, tv4rho43, t6786, t6795, t6804, t6809, t6815, t6819;
  double t6824, t6825, t6832, t6835, t6868, t6909, t6911, t6920;
  double t6933, t6966, t7006, t7010, t7015, t7020, t7025, t7029;
  double t7045, t7074, t7083, t7103, t7108, t7109, t7126, t7129;
  double t7152, t7193, t7195, t7206, t7216, t7252, t7290, t7294;
  double t7304, t7318, t7340, tv4rho44;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->hyb_omega[0];
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->hyb_omega[0] * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = 0.1e1 / t163 / t152;
  t1276 = t1275 * t145;
  t1278 = t7 * t92 * t1276;
  t1279 = 0.5e1 / 0.144e3 * t1278;
  t1281 = t7 * t622 * t257;
  t1284 = t7 * t253 * t632;
  t1285 = t1284 / 0.16e2;
  t1287 = t7 * t159 * t488;
  t1288 = t1287 / 0.16e2;
  t1289 = t1275 * t83;
  t1291 = t7 * t21 * t1289;
  t1292 = 0.5e1 / 0.144e3 * t1291;
  t1294 = t7 * t476 * t165;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1331 = t496 * t189;
  t1334 = t42 * t189;
  t1339 = t45 * t189;
  t1344 = t48 * t189;
  t1349 = t51 * t189;
  t1354 = t54 * t189;
  t1359 = t57 * t189;
  t1362 = -0.2e1 / 0.3e1 * t193 * t1331 + t1334 * t528 / 0.2e1 + t197 * t1331 / 0.8e1 - t1339 * t528 / 0.16e2 - t201 * t1331 / 0.8e2 + 0.3e1 / 0.64e3 * t1344 * t528 + t205 * t1331 / 0.1152e4 - t1349 * t528 / 0.384e4 - t209 * t1331 / 0.21504e5 + t1354 * t528 / 0.86016e5 + t213 * t1331 / 0.49152e6 - t1359 * t528 / 0.229376e7;
  t1365 = t60 * t189;
  t1369 = 0.1e1 / t59 / t169;
  t1372 = t556 * t189;
  t1377 = t1 / t22 / t467;
  t1380 = 0.14e2 / 0.243e3 * t27 * t1377 * t31;
  t1382 = t27 * t501 * t184;
  t1385 = t27 * t173 * t511;
  t1388 = t27 * t173 * t523;
  t1390 = t177 * t177;
  t1391 = 0.1e1 / t1390;
  t1392 = t510 * t183;
  t1393 = t1391 * t1392;
  t1397 = t183 * t522;
  t1401 = t14 * t14;
  t1403 = 0.1e1 / t179 / t1401;
  t1406 = t516 * t155;
  t1412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1403 * t1296 - 0.2e1 / 0.3e1 * t1406 * t471 + t180 * t1305 / 0.3e1);
  t1413 = t178 * t1412;
  t1417 = -t1380 - 0.2e1 / 0.27e2 * t1382 - t1385 / 0.9e1 + t1388 / 0.18e2 - t27 * t29 * t1393 / 0.3e1 + t791 * t792 * t1397 / 0.3e1 - t27 * t29 * t1413 / 0.18e2;
  t1418 = my_piecewise3(t36, t1417, 0);
  t1435 = -t217 * t1331 / 0.1327104e8 + t1365 * t528 / 0.7077888e8 + t1369 * t1331 / 0.4128768e9 - t1372 * t528 / 0.24772608e10 - t170 * t1418 / 0.18e2 + t193 * t1418 / 0.24e3 - t197 * t1418 / 0.448e4 + t201 * t1418 / 0.10368e6 - t205 * t1418 / 0.2838528e7 + t209 * t1418 / 0.8945664e8 - t213 * t1418 / 0.31850496e10 + t217 * t1418 / 0.1263403008e12;
  t1437 = my_piecewise3(t36, 0, t1417);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1362 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1542 = t640 * t278;
  t1545 = t105 * t278;
  t1550 = t108 * t278;
  t1555 = t111 * t278;
  t1560 = t114 * t278;
  t1565 = t117 * t278;
  t1570 = t120 * t278;
  t1573 = -0.2e1 / 0.3e1 * t282 * t1542 + t1545 * t669 / 0.2e1 + t286 * t1542 / 0.8e1 - t1550 * t669 / 0.16e2 - t290 * t1542 / 0.8e2 + 0.3e1 / 0.64e3 * t1555 * t669 + t294 * t1542 / 0.1152e4 - t1560 * t669 / 0.384e4 - t298 * t1542 / 0.21504e5 + t1565 * t669 / 0.86016e5 + t302 * t1542 / 0.49152e6 - t1570 * t669 / 0.229376e7;
  t1576 = t123 * t278;
  t1580 = 0.1e1 / t122 / t261;
  t1583 = t697 * t278;
  t1588 = 0.14e2 / 0.243e3 * t27 * t1377 * t94;
  t1590 = t27 * t501 * t273;
  t1593 = t27 * t173 * t652;
  t1596 = t27 * t173 * t664;
  t1598 = t266 * t266;
  t1599 = 0.1e1 / t1598;
  t1600 = t651 * t272;
  t1601 = t1599 * t1600;
  t1605 = t272 * t663;
  t1609 = t87 * t87;
  t1611 = 0.1e1 / t268 / t1609;
  t1614 = t657 * t249;
  t1620 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1611 * t1511 - 0.2e1 / 0.3e1 * t1614 * t617 + t269 * t1516 / 0.3e1);
  t1621 = t267 * t1620;
  t1625 = -t1588 - 0.2e1 / 0.27e2 * t1590 - t1593 / 0.9e1 + t1596 / 0.18e2 - t27 * t29 * t1601 / 0.3e1 + t791 * t931 * t1605 / 0.3e1 - t27 * t29 * t1621 / 0.18e2;
  t1626 = my_piecewise3(t99, t1625, 0);
  t1643 = -t306 * t1542 / 0.1327104e8 + t1576 * t669 / 0.7077888e8 + t1580 * t1542 / 0.4128768e9 - t1583 * t669 / 0.24772608e10 - t262 * t1626 / 0.18e2 + t282 * t1626 / 0.24e3 - t286 * t1626 / 0.448e4 + t290 * t1626 / 0.10368e6 - t294 * t1626 / 0.2838528e7 + t298 * t1626 / 0.8945664e8 - t302 * t1626 / 0.31850496e10 + t306 * t1626 / 0.1263403008e12;
  t1645 = my_piecewise3(t99, 0, t1625);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t310 * t703 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1573 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = -t1279 - 0.3e1 / 0.32e2 * t1281 + t1285 + t1288 - t1292 - 0.3e1 / 0.32e2 * t1294 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t905 * t257;
  t1757 = t1756 / 0.16e2;
  t1759 = t7 * t402 * t632;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = -t1279 - t1281 / 0.32e2 + t1284 / 0.24e2 + t1287 / 0.24e2 - t1292 - t1294 / 0.32e2 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 - t1757 + t1759 / 0.48e2 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t42 * t810;
  t1816 = t45 * t810;
  t1821 = t48 * t810;
  t1826 = t51 * t810;
  t1831 = t54 * t810;
  t1836 = t57 * t810;
  t1841 = t60 * t810;
  t1846 = t556 * t810;
  t1851 = t1811 * t189 / 0.3e1 + t783 * t528 / 0.6e1 - t1816 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1821 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1826 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1831 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1836 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1841 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9 - t1846 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10;
  t1866 = t1369 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1391;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1403 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1380 - 0.4e1 / 0.81e2 * t1382 - t1385 / 0.27e2 + t1388 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t108 * t949;
  t2063 = t111 * t949;
  t2068 = t114 * t949;
  t2073 = t117 * t949;
  t2078 = t120 * t949;
  t2083 = t123 * t949;
  t2088 = t697 * t949;
  t2093 = t105 * t949;
  t2098 = -t2058 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2063 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2068 * t278 / 0.576e4 - t962 * t669 / 0.1152e5 + t2073 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2078 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2083 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2088 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10 + t2093 * t278 / 0.3e1 + t924 * t669 / 0.6e1;
  t2113 = t1580 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1599;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1611 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1588 - 0.4e1 / 0.81e2 * t1590 - t1593 / 0.27e2 + t1596 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = -t1279 + t1284 / 0.48e2 + t1287 / 0.48e2 - t1292 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 - t1757 + t1759 / 0.24e2 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2290 = t164 * t1267;
  t2292 = t7 * t92 * t2290;
  t2295 = t7 * t1166 * t257;
  t2298 = t7 * t402 * t920;
  t2301 = t7 * t344 * t779;
  t2303 = t164 * t1153;
  t2305 = t7 * t21 * t2303;
  t2308 = t7 * t1052 * t165;
  t2311 = t7 * t159 * t1154;
  t2313 = t193 * t1061;
  t2318 = t42 * t1081;
  t2321 = t197 * t1061;
  t2326 = t45 * t1081;
  t2329 = t201 * t1061;
  t2334 = t48 * t1081;
  t2337 = t205 * t1061;
  t2342 = t51 * t1081;
  t2345 = t209 * t1061;
  t2350 = t54 * t1081;
  t2353 = t213 * t1061;
  t2356 = -0.2e1 / 0.3e1 * t2313 * t189 + t783 * t810 / 0.3e1 + t2318 * t189 / 0.6e1 + t2321 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2326 * t189 / 0.48e2 - t2329 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2334 * t189 / 0.64e3 + t2337 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2342 * t189 / 0.1152e5 - t2345 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2350 * t189 / 0.258048e6 + t2353 * t189 / 0.49152e6;
  t2359 = t57 * t1081;
  t2362 = t217 * t1061;
  t2367 = t60 * t1081;
  t2370 = t1369 * t1061;
  t2375 = t556 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1403 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1380 - 0.2e1 / 0.81e2 * t1382 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t833 * t810 / 0.344064e7 - t2359 * t189 / 0.688128e7 - t2362 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2367 * t189 / 0.21233664e9 + t2370 * t189 / 0.4128768e9 - t843 * t810 / 0.37158912e10 - t2375 * t189 / 0.74317824e10 + t217 * t2418 / 0.1263403008e12 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2550 = t306 * t1175;
  t2555 = t123 * t1195;
  t2558 = t1580 * t1175;
  t2563 = t697 * t1195;
  t2566 = t282 * t1175;
  t2571 = t105 * t1195;
  t2574 = t286 * t1175;
  t2579 = t108 * t1195;
  t2582 = t290 * t1175;
  t2587 = t111 * t1195;
  t2590 = t294 * t1175;
  t2593 = -t2550 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2555 * t278 / 0.21233664e9 + t2558 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2563 * t278 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2566 * t278 + t924 * t949 / 0.3e1 + t2571 * t278 / 0.6e1 + t2574 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2579 * t278 / 0.48e2 - t2582 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2587 * t278 / 0.64e3 + t2590 * t278 / 0.1152e4;
  t2596 = t114 * t1195;
  t2599 = t298 * t1175;
  t2604 = t117 * t1195;
  t2607 = t302 * t1175;
  t2612 = t120 * t1195;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1611 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1588 - 0.2e1 / 0.81e2 * t1590 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t962 * t949 / 0.576e4 - t2596 * t278 / 0.1152e5 - t2599 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2604 * t278 / 0.258048e6 + t2607 * t278 / 0.49152e6 - t972 * t949 / 0.344064e7 - t2612 * t278 / 0.688128e7 - t262 * t2652 / 0.18e2 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2593 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2292 / 0.32e2 - t2295 / 0.32e2 - t2298 / 0.16e2 - t2301 / 0.16e2 - t2305 / 0.32e2 - t2308 / 0.32e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1599 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1611 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1588 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = -t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 + t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1580 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2980 = t1061 * t356;
  t3000 = t1065 * t350;
  t3001 = t1391 * t3000;
  t3005 = t350 * t1075;
  t3009 = t1403 * t2958;
  t3013 = t180 * t2963;
  t3016 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t3009 - 0.2e1 / 0.3e1 * t797 * t1047 + t3013 / 0.3e1);
  t3017 = t178 * t3016;
  t3021 = -t1380 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t3001 / 0.3e1 + t791 * t792 * t3005 / 0.3e1 - t27 * t29 * t3017 / 0.18e2;
  t3022 = my_piecewise3(t36, t3021, 0);
  t3029 = -t823 * t1081 / 0.384e4 - t209 * t2980 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t2980 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t2980 / 0.1327104e8 + t838 * t1081 / 0.7077888e8 + t1369 * t2980 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - t170 * t3022 / 0.18e2 + t193 * t3022 / 0.24e3 - t197 * t3022 / 0.448e4;
  t3054 = t201 * t3022 / 0.10368e6 - t205 * t3022 / 0.2838528e7 + t209 * t3022 / 0.8945664e8 - t213 * t3022 / 0.31850496e10 + t217 * t3022 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t193 * t2980 + t783 * t1081 / 0.2e1 + t197 * t2980 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t2980 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t2980 / 0.1152e4;
  t3056 = my_piecewise3(t36, 0, t3021);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3029 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1759 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.32e2 * t2292 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.16e2 * t2298 - 0.3e1 / 0.16e2 * t2301 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.32e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1279 - t1292;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t3176 = t528 * t528;
  t3179 = t496 * t496;
  t3186 = 0.3e1 / 0.4e1 * t197 * t496 * t528 - t1339 * t1418 / 0.12e2 - 0.3e1 / 0.4e2 * t201 * t496 * t528 + t1344 * t1418 / 0.16e3 + t205 * t496 * t528 / 0.192e3 - t1349 * t1418 / 0.288e4 - t209 * t496 * t528 / 0.3584e4 + t1354 * t1418 / 0.64512e5 + t213 * t496 * t528 / 0.8192e5 - t1359 * t1418 / 0.172032e7 - t217 * t496 * t528 / 0.221184e7 + t1365 * t1418 / 0.5308416e8 + t1369 * t496 * t528 / 0.688128e8 - t1372 * t1418 / 0.18579456e10 - 0.4e1 * t193 * t496 * t528 + 0.2e1 / 0.3e1 * t1334 * t1418 - t45 * t3176 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t3179 + 0.3e1 / 0.64e3 * t48 * t3176 - 0.11e2 / 0.1152e4 * t54 * t3179;
  t3202 = 0.1e1 / t59 / t41;
  t3215 = t1 / t22 / t1301;
  t3218 = 0.14e3 / 0.729e3 * t27 * t3215 * t31;
  t3220 = t27 * t1377 * t184;
  t3223 = t27 * t501 * t511;
  t3226 = t27 * t501 * t523;
  t3229 = t27 * t173 * t1393;
  t3232 = t791 * t1875 * t1397;
  t3235 = t27 * t173 * t1413;
  t3238 = 0.1e1 / t1390 / t30;
  t3239 = t510 * t510;
  t3248 = t522 * t522;
  t3259 = 0.1e1 / t179 / t1401 / t14;
  t3260 = t464 * t464;
  t3266 = t471 * t471;
  t3272 = 0.1e1 / t1301 / t11;
  t3273 = t10 * t3272;
  t3275 = -0.24e2 * t1302 + 0.24e2 * t3273;
  t3279 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3259 * t3260 + 0.2e2 / 0.9e1 * t1403 * t464 * t471 - 0.2e1 / 0.3e1 * t516 * t3266 - 0.8e1 / 0.9e1 * t1406 * t1305 + t180 * t3275 / 0.3e1);
  t3284 = t3218 + 0.56e2 / 0.243e3 * t3220 + 0.8e1 / 0.27e2 * t3223 - 0.4e1 / 0.27e2 * t3226 + 0.4e1 / 0.9e1 * t3229 - 0.4e1 / 0.9e1 * t3232 + 0.2e1 / 0.27e2 * t3235 + 0.4e1 / 0.3e1 * t27 * t29 * t3238 * t3239 - 0.2e1 * t791 * t1882 * t510 * t522 + t27 * t29 * t509 * t3248 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t183 * t1412 - t27 * t29 * t178 * t3279 / 0.18e2;
  t3285 = my_piecewise3(t36, t3284, 0);
  t3302 = -t51 * t3176 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t3179 + t54 * t3176 / 0.86016e5 - t60 * t3179 / 0.32768e5 - t57 * t3176 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t3179 + t60 * t3176 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3202 * t3179 - t556 * t3176 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t3179 + t42 * t3176 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t3179 - t170 * t3285 / 0.18e2 + t193 * t3285 / 0.24e3 - t197 * t3285 / 0.448e4 + t201 * t3285 / 0.10368e6 - t205 * t3285 / 0.2838528e7 + t209 * t3285 / 0.8945664e8 - t213 * t3285 / 0.31850496e10 + t217 * t3285 / 0.1263403008e12;
  t3304 = my_piecewise3(t36, 0, t3284);
  t3313 = t570 * t570;
  t3318 = 0.1e1 / t1451 / t227;
  t3326 = 0.1e1 / t1451 / t567;
  t3330 = t562 * t562;
  t3343 = 0.1e1 / t1451 / t69;
  t3353 = t72 * t1437;
  t3377 = t3326 * t3313 * t72 / 0.16e2 - 0.12e2 * t3330 * t73 - 0.16e2 * t877 * t1437 - 0.4e1 * t232 * t3304 - t65 * t3304 * t72 + 0.85e2 / 0.4e1 * t1452 * t3313 * t72 - 0.19e2 / 0.8e1 * t3343 * t3313 * t72 + t228 * t3304 * t72 / 0.2e1 - 0.3e1 * t70 * t3330 * t72 - 0.4e1 * t880 * t3353 - 0.75e2 / 0.2e1 * t590 * t3313 * t72 + 0.45e2 * t571 * t1448 - 0.6e1 * t582 * t3330 * t72 - 0.8e1 * t1472 * t3353 - 0.15e2 * t1476 * t570 * t1448 + t590 * t1437 * t868 + 0.3e1 / 0.4e1 * t590 * t3330 * t72 + 0.3e1 / 0.4e1 * t1487 * t562 * t1975;
  t3398 = t72 * t569;
  t3409 = 0.15e2 / 0.4e1 * t1487 * t3313 * t72 - t3318 * t3313 * t72 / 0.8e1 - t223 * t3304 + 0.8e1 * t221 * t1499 + 0.2e1 * t63 * t3377 + 0.2e1 * t3304 * t76 + 0.8e1 * t1437 * t237 + 0.12e2 * t562 * t602 - 0.24e2 * t1476 * t3313 * t72 + 0.21e2 * t591 * t1448 - 0.3e1 / 0.2e1 * t569 * t3330 * t72 - 0.2e1 * t853 * t3353 - 0.3e1 / 0.2e1 * t1949 * t1448 + 0.24e2 * t3398 * t3313 - 0.36e2 * t1456 * t570 * t562 + 0.6e1 * t574 * t3330 + 0.8e1 * t574 * t221 * t1437;
  t3413 = my_piecewise3(t35, t3186 + t3302, -0.8e1 / 0.3e1 * t3304 * t79 - 0.32e2 / 0.3e1 * t1437 * t240 - 0.16e2 * t562 * t605 - 0.32e2 / 0.3e1 * t221 * t1502 - 0.8e1 / 0.3e1 * t63 * t3409);
  t3419 = t7 * t253 * t1276;
  t3423 = t7 * t92 * t1275 * t333;
  t3426 = t7 * t1521 * t257;
  t3429 = t7 * t622 * t636;
  t3432 = t7 * t253 * t1534;
  t3435 = t7 * t476 * t488;
  t3438 = t7 * t159 * t1323;
  t3442 = t7 * t21 * t1275 * t244;
  t3445 = t7 * t1310 * t165;
  t3448 = t7 * t476 * t492;
  t3492 = 0.14e3 / 0.729e3 * t27 * t3215 * t94;
  t3494 = t27 * t1377 * t273;
  t3497 = t27 * t501 * t652;
  t3500 = t27 * t501 * t664;
  t3503 = t27 * t173 * t1601;
  t3506 = t791 * t2122 * t1605;
  t3509 = t27 * t173 * t1621;
  t3512 = 0.1e1 / t1598 / t93;
  t3513 = t651 * t651;
  t3522 = t663 * t663;
  t3533 = 0.1e1 / t268 / t1609 / t87;
  t3534 = t614 * t614;
  t3540 = t617 * t617;
  t3545 = -t3275;
  t3549 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3533 * t3534 + 0.2e2 / 0.9e1 * t1611 * t614 * t617 - 0.2e1 / 0.3e1 * t657 * t3540 - 0.8e1 / 0.9e1 * t1614 * t1516 + t269 * t3545 / 0.3e1);
  t3554 = t3492 + 0.56e2 / 0.243e3 * t3494 + 0.8e1 / 0.27e2 * t3497 - 0.4e1 / 0.27e2 * t3500 + 0.4e1 / 0.9e1 * t3503 - 0.4e1 / 0.9e1 * t3506 + 0.2e1 / 0.27e2 * t3509 + 0.4e1 / 0.3e1 * t27 * t29 * t3512 * t3513 - 0.2e1 * t791 * t2129 * t651 * t663 + t27 * t29 * t650 * t3522 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t272 * t1620 - t27 * t29 * t267 * t3549 / 0.18e2;
  t3555 = my_piecewise3(t99, t3554, 0);
  t3564 = -0.4e1 * t282 * t640 * t669 + 0.2e1 / 0.3e1 * t1545 * t1626 + 0.3e1 / 0.4e1 * t286 * t640 * t669 - t1550 * t1626 / 0.12e2 - 0.3e1 / 0.4e2 * t290 * t640 * t669 + t1555 * t1626 / 0.16e3 + t294 * t640 * t669 / 0.192e3 - t1560 * t1626 / 0.288e4 - t298 * t640 * t669 / 0.3584e4 + t1565 * t1626 / 0.64512e5 + t302 * t640 * t669 / 0.8192e5 - t1570 * t1626 / 0.172032e7 - t306 * t640 * t669 / 0.221184e7 + t1576 * t1626 / 0.5308416e8 + t1580 * t640 * t669 / 0.688128e8 - t1583 * t1626 / 0.18579456e10 - t262 * t3555 / 0.18e2 + t282 * t3555 / 0.24e3 - t286 * t3555 / 0.448e4 + t290 * t3555 / 0.10368e6;
  t3573 = t640 * t640;
  t3576 = t669 * t669;
  t3604 = 0.1e1 / t122 / t104;
  t3609 = -t294 * t3555 / 0.2838528e7 + t298 * t3555 / 0.8945664e8 - t302 * t3555 / 0.31850496e10 + t306 * t3555 / 0.1263403008e12 + 0.1e2 / 0.3e1 * t108 * t3573 + t105 * t3576 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t3573 - t108 * t3576 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t3573 + 0.3e1 / 0.64e3 * t111 * t3576 - 0.11e2 / 0.1152e4 * t117 * t3573 - t114 * t3576 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t3573 + t117 * t3576 / 0.86016e5 - t123 * t3573 / 0.32768e5 - t120 * t3576 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t3573 + t123 * t3576 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3604 * t3573 - t697 * t3576 / 0.24772608e10;
  t3611 = my_piecewise3(t99, 0, t3554);
  t3620 = t134 * t1645;
  t3625 = t134 * t710;
  t3626 = t711 * t711;
  t3632 = t703 * t703;
  t3650 = 0.1e1 / t1659 / t131;
  t3658 = 0.1e1 / t1659 / t708;
  t3696 = 0.85e2 / 0.4e1 * t1660 * t3626 * t134 - 0.19e2 / 0.8e1 * t3650 * t3626 * t134 + t317 * t3611 * t134 / 0.2e1 + t3658 * t3626 * t134 / 0.16e2 - 0.12e2 * t3632 * t135 - 0.16e2 * t1016 * t1645 - 0.4e1 * t321 * t3611 - t127 * t3611 * t134 + 0.45e2 * t712 * t1656 - 0.6e1 * t723 * t3632 * t134 - 0.8e1 * t1680 * t3620 - 0.15e2 * t1684 * t711 * t1656 + t731 * t1645 * t1007 + 0.3e1 / 0.4e1 * t731 * t3632 * t134 + 0.3e1 / 0.4e1 * t1695 * t703 * t2222 - 0.3e1 * t132 * t3632 * t134 - 0.4e1 * t1019 * t3620 - 0.75e2 / 0.2e1 * t731 * t3626 * t134;
  t3712 = 0.1e1 / t1659 / t316;
  t3716 = -0.2e1 * t992 * t3620 - 0.3e1 / 0.2e1 * t2196 * t1656 + 0.24e2 * t3625 * t3626 - 0.36e2 * t1664 * t711 * t703 + 0.6e1 * t715 * t3632 + 0.8e1 * t715 * t310 * t1645 - 0.24e2 * t1684 * t3626 * t134 + 0.21e2 * t732 * t1656 - 0.3e1 / 0.2e1 * t710 * t3632 * t134 + 0.2e1 * t126 * t3696 + 0.2e1 * t3611 * t138 + 0.8e1 * t1645 * t326 + 0.12e2 * t703 * t743 + 0.8e1 * t310 * t1707 - t312 * t3611 + 0.15e2 / 0.4e1 * t1695 * t3626 * t134 - t3712 * t3626 * t134 / 0.8e1;
  t3720 = my_piecewise3(t98, t3564 + t3609, -0.8e1 / 0.3e1 * t3611 * t141 - 0.32e2 / 0.3e1 * t1645 * t329 - 0.16e2 * t703 * t746 - 0.32e2 / 0.3e1 * t310 * t1710 - 0.8e1 / 0.3e1 * t126 * t3716);
  t3736 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1611 * t3534 - 0.16e2 / 0.9e1 * t658 * t617 + 0.4e1 / 0.3e1 * t269 * t3540 + 0.16e2 / 0.9e1 * t270 * t1516 + 0.4e1 / 0.3e1 * t89 * t3545);
  t3747 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t3413 - 0.5e1 / 0.36e2 * t3419 - 0.5e1 / 0.36e2 * t3423 - t3426 / 0.8e1 - 0.3e1 / 0.8e1 * t3429 + t3432 / 0.4e1 + t3435 / 0.8e1 + t3438 / 0.4e1 - 0.5e1 / 0.36e2 * t3442 - t3445 / 0.8e1 - 0.3e1 / 0.8e1 * t3448 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t3720 - 0.3e1 / 0.32e2 * t7 * t9 * t3736 * t146 - 0.3e1 / 0.8e1 * t7 * t1521 * t334 - 0.9e1 / 0.16e2 * t7 * t622 * t751;
  t3749 = t7 * t253 * t1538;
  t3762 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1403 * t3260 - 0.16e2 / 0.9e1 * t517 * t471 + 0.4e1 / 0.3e1 * t180 * t3266 + 0.16e2 / 0.9e1 * t181 * t1305 + 0.4e1 / 0.3e1 * t18 * t3275);
  t3774 = t7 * t159 * t1327;
  t3781 = t7 * t21 * t487 * t609;
  t3785 = t7 * t21 * t164 * t1506;
  t3788 = t7 * t159 * t1289;
  t3791 = 0.1e1 / t163 / t467;
  t3795 = 0.5e1 / 0.54e2 * t7 * t21 * t3791 * t83;
  t3799 = 0.5e1 / 0.54e2 * t7 * t92 * t3791 * t145;
  t3801 = t7 * t622 * t632;
  t3808 = t7 * t92 * t487 * t750;
  t3812 = t7 * t92 * t164 * t1714;
  t3814 = -0.3e1 / 0.8e1 * t3749 - 0.3e1 / 0.32e2 * t7 * t9 * t3762 * t84 - 0.3e1 / 0.8e1 * t7 * t1310 * t245 - 0.9e1 / 0.16e2 * t7 * t476 * t610 - 0.3e1 / 0.8e1 * t3774 - 0.3e1 / 0.8e1 * t7 * t159 * t1507 + t3781 / 0.8e1 - t3785 / 0.8e1 - 0.5e1 / 0.36e2 * t3788 + t3795 + t3799 + t3801 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t253 * t1715 + t3808 / 0.8e1 - t3812 / 0.8e1;
  t3817 = 0.5e1 / 0.36e2 * t1278;
  t3821 = 0.5e1 / 0.36e2 * t1291;
  t3838 = -0.9e1 / 0.8e1 * t1321 + t1325 / 0.4e1 - 0.3e1 / 0.8e1 * t1329 - 0.3e1 / 0.8e1 * t1509 - 0.3e1 / 0.8e1 * t1523 - 0.9e1 / 0.8e1 * t1526 - 0.3e1 / 0.4e1 * t1529 - 0.9e1 / 0.8e1 * t1532 + t1536 / 0.4e1 - 0.3e1 / 0.8e1 * t1540 - 0.3e1 / 0.8e1 * t1717;
  tv4rho40 = t11 * (t3747 + t3814) - t3817 - 0.3e1 / 0.8e1 * t1281 + t1284 / 0.4e1 + t1287 / 0.4e1 - t3821 - 0.3e1 / 0.8e1 * t1294 - 0.3e1 / 0.8e1 * t1312 - 0.9e1 / 0.8e1 * t1315 - 0.3e1 / 0.4e1 * t1318 + t3838;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3843 = t7 * t764 * t492;
  t3846 = t7 * t344 * t1323;
  t3847 = t3846 / 0.16e2;
  t3849 = t7 * t622 * t920;
  t3852 = t7 * t253 * t2054;
  t3856 = t7 * t92 * t487 * t1032;
  t3857 = t3856 / 0.16e2;
  t3859 = t7 * t2035 * t257;
  t3862 = t7 * t905 * t636;
  t3865 = t7 * t402 * t1534;
  t3866 = t3865 / 0.16e2;
  t3868 = t7 * t476 * t779;
  t3871 = t7 * t159 * t1807;
  t3875 = t7 * t21 * t487 * t893;
  t3876 = t3875 / 0.16e2;
  t3878 = t7 * t1788 * t165;
  t3880 = t528 * t189;
  t3909 = -0.2e1 * t359 * t3880 + 0.3e1 / 0.8e1 * t361 * t3880 - 0.3e1 / 0.8e2 * t363 * t3880 + t365 * t3880 / 0.384e3 - t367 * t3880 / 0.7168e4 + t369 * t3880 / 0.16384e6 - t371 * t3880 / 0.442368e7 + t1866 * t3880 / 0.1376256e9 - t823 * t1418 / 0.1152e5 + t1831 * t528 / 0.86016e5 + t828 * t1418 / 0.258048e6 - t1836 * t528 / 0.229376e7 - t833 * t1418 / 0.688128e7 + t1841 * t528 / 0.7077888e8;
  t3946 = t838 * t1418 / 0.21233664e9 - t1846 * t528 / 0.24772608e10 - t843 * t1418 / 0.74317824e10 + t42 * t1914 * t189 / 0.2e1 - t45 * t1914 * t189 / 0.16e2 + 0.3e1 / 0.64e3 * t48 * t1914 * t189 - t51 * t1914 * t189 / 0.384e4 + t54 * t1914 * t189 / 0.86016e5 - t57 * t1914 * t189 / 0.229376e7 + t60 * t1914 * t189 / 0.7077888e8 - t556 * t1914 * t189 / 0.24772608e10 + t1811 * t528 / 0.2e1 + t783 * t1418 / 0.6e1 - t1816 * t528 / 0.16e2;
  t3977 = -t813 * t1418 / 0.48e2 + 0.3e1 / 0.64e3 * t1821 * t528 + t818 * t1418 / 0.64e3 - t1826 * t528 / 0.384e4 + 0.9e1 / 0.8e2 * t823 * t1331 - 0.11e2 / 0.1152e4 * t828 * t1331 + 0.13e2 / 0.21504e5 * t833 * t1331 - t838 * t1331 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t843 * t1331 - 0.19e2 / 0.4128768e9 * t3202 * t356 * t1331 - 0.2e1 * t816 * t496 + 0.3e1 / 0.8e1 * t821 * t496 - 0.3e1 / 0.8e2 * t826 * t496 + t831 * t496 / 0.384e3;
  t3991 = t172 * t1391;
  t3993 = t791 * t3991 * t1883;
  t3995 = t28 * t3238;
  t4004 = t27 * t1377 * t351;
  t4008 = t791 * t500 * t509 * t793;
  t4009 = 0.4e1 / 0.27e2 * t4008;
  t4011 = t791 * t1875 * t1887;
  t4014 = t791 * t1875 * t1891;
  t4036 = t468 * t464;
  t4039 = t155 * t471;
  t4045 = t1302 * t155;
  t4048 = t468 * t471;
  t4056 = 0.8e1 * t800 * t3272;
  t4058 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3259 * t340 * t1296 + 0.2e2 / 0.9e1 * t1403 * t10 * t4036 + 0.1e2 / 0.9e1 * t1895 * t4039 - 0.4e1 / 0.3e1 * t516 * t468 * t155 + 0.4e1 * t1898 * t4045 - 0.4e1 / 0.3e1 * t1898 * t4048 - 0.2e1 / 0.9e1 * t797 * t1305 - 0.4e1 * t180 * t1302 + t4056);
  t4064 = t27 * t501 * t805;
  t4065 = 0.2e1 / 0.27e2 * t4064;
  t4067 = t27 * t173 * t1909;
  t4075 = t791 * t792 * t350 * t1412 / 0.9e1 - t27 * t29 * t178 * t4058 / 0.18e2 - t4065 + t4067 / 0.18e2 + 0.4e1 / 0.27e2 * t3223 + t3229 / 0.9e1 - t3232 / 0.9e1 - 0.2e1 / 0.27e2 * t3226 + t3235 / 0.54e2 + t3218 + 0.14e2 / 0.81e2 * t3220;
  t4076 = t3993 / 0.3e1 + 0.4e1 / 0.3e1 * t791 * t3995 * t350 * t1392 - t791 * t1882 * t793 * t522 + 0.14e2 / 0.243e3 * t4004 + t4009 - 0.2e1 / 0.9e1 * t4011 - t4014 / 0.9e1 - t791 * t1882 * t804 * t510 + t791 * t792 * t1908 * t183 / 0.3e1 + t791 * t792 * t804 * t522 / 0.3e1 + t4075;
  t4077 = my_piecewise3(t36, t4076, 0);
  t4094 = -t836 * t496 / 0.7168e4 + t841 * t496 / 0.16384e6 - t846 * t496 / 0.442368e7 + t1369 * t810 * t496 / 0.1376256e9 + 0.1e2 / 0.3e1 * t813 * t1331 - 0.7e1 / 0.8e1 * t818 * t1331 - t170 * t4077 / 0.18e2 + t193 * t4077 / 0.24e3 - t197 * t4077 / 0.448e4 + t201 * t4077 / 0.10368e6 - t205 * t4077 / 0.2838528e7 + t209 * t4077 / 0.8945664e8 - t213 * t4077 / 0.31850496e10 + t217 * t4077 / 0.1263403008e12;
  t4097 = my_piecewise3(t36, 0, t4076);
  t4117 = t72 * t1933;
  t4143 = -0.24e2 * t1477 * t854 + 0.24e2 * t3398 * t374 * t1444 - 0.3e1 / 0.2e1 * t853 * t4117 - 0.18e2 * t1456 * t849 * t570 + 0.6e1 * t574 * t1933 * t221 + 0.6e1 * t574 * t849 * t562 + 0.2e1 * t574 * t374 * t1437 + 0.21e2 / 0.2e1 * t591 * t1952 + 0.15e2 / 0.4e1 * t1488 * t854 - t569 * t1437 * t854 / 0.2e1 - 0.3e1 / 0.2e1 * t1946 * t1952 - 0.3e1 / 0.4e1 * t1949 * t1952;
  t4150 = t569 * t849;
  t4153 = t1452 * t374;
  t4154 = t1444 * t72;
  t4183 = 0.45e2 / 0.2e1 * t4150 * t1975 + 0.85e2 / 0.4e1 * t4153 * t4154 - 0.6e1 * t582 * t1933 * t868 - 0.6e1 * t1978 * t1448 - 0.15e2 / 0.2e1 * t1476 * t849 * t1975 - 0.19e2 / 0.8e1 * t3343 * t374 * t4154 - 0.2e1 * t867 * t3353 + 0.3e1 / 0.4e1 * t590 * t1933 * t868 + 0.3e1 / 0.4e1 * t1989 * t1448 + 0.3e1 / 0.8e1 * t1487 * t849 * t1975 + t874 * t3353 / 0.4e1 + t3326 * t374 * t4154 / 0.16e2;
  t4206 = t868 * t562;
  t4213 = -t70 * t1437 * t854 - 0.3e1 * t2002 * t1952 - 0.3e1 * t880 * t4117 - 0.75e2 / 0.2e1 * t874 * t4154 - 0.12e2 * t1997 * t849 - 0.12e2 * t877 * t1933 - 0.4e1 * t232 * t4097 - t65 * t4097 * t72 + t228 * t4097 * t72 / 0.2e1 - 0.4e1 * t1437 * t73 * t374 - 0.15e2 / 0.2e1 * t1981 * t4206 + 0.3e1 / 0.8e1 * t1994 * t4206 + 0.45e2 / 0.2e1 * t1974 * t4206;
  t4234 = t868 * t374;
  t4240 = -t3318 * t1444 * t854 / 0.8e1 - t223 * t4097 + 0.6e1 * t221 * t2010 + 0.2e1 * t63 * (t4183 + t4213) + 0.6e1 * t849 * t602 + 0.2e1 * t374 * t1499 + 0.2e1 * t1437 * t386 + 0.6e1 * t562 * t886 + 0.2e1 * t4097 * t76 + 0.6e1 * t1933 * t237 + 0.21e2 / 0.2e1 * t590 * t221 * t854 * t562 - 0.3e1 / 0.4e1 * t1452 * t562 * t4234 - 0.18e2 * t1456 * t857 * t562;
  t4245 = my_piecewise3(t35, t3909 + t3946 + t3977 + t4094, -0.8e1 / 0.3e1 * t4097 * t79 - 0.8e1 * t1933 * t240 - 0.8e1 * t849 * t605 - 0.8e1 / 0.3e1 * t374 * t1502 - 0.8e1 / 0.3e1 * t1437 * t389 - 0.8e1 * t562 * t889 - 0.8e1 * t221 * t2013 - 0.8e1 / 0.3e1 * t63 * (t4143 + t4240));
  t4267 = 0.32e2 * t759 * t3272;
  t4269 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1895 * t1296 - 0.16e2 / 0.9e1 * t1898 * t4036 - 0.8e1 / 0.9e1 * t797 * t4039 + 0.8e1 / 0.3e1 * t1903 * t155 - 0.8e1 * t800 * t4045 + 0.8e1 / 0.3e1 * t800 * t4048 + 0.4e1 / 0.9e1 * t348 * t1305 - 0.16e2 * t18 * t1302 + t4267);
  t4274 = -0.9e1 / 0.32e2 * t7 * t476 * t894 - 0.3e1 / 0.16e2 * t3843 + t3847 - 0.3e1 / 0.32e2 * t3849 - 0.3e1 / 0.16e2 * t3852 + t3857 - 0.3e1 / 0.32e2 * t3859 - 0.3e1 / 0.16e2 * t3862 + t3866 - 0.3e1 / 0.32e2 * t3868 - 0.3e1 / 0.16e2 * t3871 + t3876 - 0.3e1 / 0.32e2 * t3878 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t4245 - 0.3e1 / 0.32e2 * t7 * t9 * t4269 * t84;
  t4282 = t7 * t344 * t1327;
  t4290 = t669 * t278;
  t4319 = -t429 * t4290 / 0.442368e7 + t2113 * t4290 / 0.1376256e9 - 0.2e1 * t417 * t4290 + 0.3e1 / 0.8e1 * t419 * t4290 - 0.3e1 / 0.8e2 * t421 * t4290 + t423 * t4290 / 0.384e3 - t425 * t4290 / 0.7168e4 + t427 * t4290 / 0.16384e6 + t2073 * t669 / 0.86016e5 + t967 * t1626 / 0.258048e6 - t2078 * t669 / 0.229376e7 - t972 * t1626 / 0.688128e7 + t2083 * t669 / 0.7077888e8 + t977 * t1626 / 0.21233664e9;
  t4356 = -t2088 * t669 / 0.24772608e10 - t982 * t1626 / 0.74317824e10 + t2093 * t669 / 0.2e1 + t924 * t1626 / 0.6e1 + 0.3e1 / 0.64e3 * t111 * t2161 * t278 - t114 * t2161 * t278 / 0.384e4 + t117 * t2161 * t278 / 0.86016e5 - t120 * t2161 * t278 / 0.229376e7 + t123 * t2161 * t278 / 0.7077888e8 - t697 * t2161 * t278 / 0.24772608e10 + t105 * t2161 * t278 / 0.2e1 - t108 * t2161 * t278 / 0.16e2 - t2058 * t669 / 0.16e2 - t952 * t1626 / 0.48e2;
  t4388 = 0.3e1 / 0.64e3 * t2063 * t669 + t957 * t1626 / 0.64e3 - t2068 * t669 / 0.384e4 - t962 * t1626 / 0.1152e5 + t1580 * t949 * t640 / 0.1376256e9 - 0.2e1 * t955 * t640 + 0.1e2 / 0.3e1 * t952 * t1542 - 0.7e1 / 0.8e1 * t957 * t1542 + 0.9e1 / 0.8e2 * t962 * t1542 - 0.11e2 / 0.1152e4 * t967 * t1542 + 0.13e2 / 0.21504e5 * t972 * t1542 - t977 * t1542 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t982 * t1542 - 0.19e2 / 0.4128768e9 * t3604 * t414 * t1542;
  t4401 = t28 * t3512;
  t4409 = t172 * t1599;
  t4411 = t791 * t4409 * t2130;
  t4429 = t27 * t1377 * t409;
  t4433 = t791 * t500 * t650 * t932;
  t4434 = 0.4e1 / 0.27e2 * t4433;
  t4436 = t791 * t2122 * t2134;
  t4440 = t791 * t2122 * t2138;
  t4443 = t27 * t501 * t944;
  t4444 = 0.2e1 / 0.27e2 * t4443;
  t4446 = t27 * t173 * t2156;
  t4452 = t468 * t614;
  t4455 = t249 * t617;
  t4461 = t1302 * t249;
  t4464 = t468 * t617;
  t4472 = 0.8e1 * t939 * t3272;
  t4474 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3533 * t398 * t1511 - 0.2e2 / 0.9e1 * t1611 * t10 * t4452 + 0.1e2 / 0.9e1 * t2142 * t4455 + 0.4e1 / 0.3e1 * t657 * t468 * t249 - 0.4e1 * t2145 * t4461 + 0.4e1 / 0.3e1 * t2145 * t4464 - 0.2e1 / 0.9e1 * t936 * t1516 + 0.4e1 * t269 * t1302 - t4472);
  t4485 = -t4440 / 0.9e1 - t4444 + t4446 / 0.18e2 - t27 * t29 * t267 * t4474 / 0.18e2 + 0.4e1 / 0.27e2 * t3497 + t3503 / 0.9e1 - t3506 / 0.9e1 + t3492 + 0.14e2 / 0.81e2 * t3494 - 0.2e1 / 0.27e2 * t3500 + t3509 / 0.54e2;
  t4486 = 0.4e1 / 0.3e1 * t791 * t4401 * t408 * t1600 - t791 * t2129 * t932 * t663 + t4411 / 0.3e1 - t791 * t2129 * t943 * t651 + t791 * t931 * t2155 * t272 / 0.3e1 + t791 * t931 * t943 * t663 / 0.3e1 + t791 * t931 * t408 * t1620 / 0.9e1 + 0.14e2 / 0.243e3 * t4429 + t4434 - 0.2e1 / 0.9e1 * t4436 + t4485;
  t4487 = my_piecewise3(t99, t4486, 0);
  t4504 = 0.3e1 / 0.8e1 * t960 * t640 - 0.3e1 / 0.8e2 * t965 * t640 + t970 * t640 / 0.384e3 - t975 * t640 / 0.7168e4 + t980 * t640 / 0.16384e6 - t985 * t640 / 0.442368e7 - t286 * t4487 / 0.448e4 + t290 * t4487 / 0.10368e6 - t294 * t4487 / 0.2838528e7 + t298 * t4487 / 0.8945664e8 - t302 * t4487 / 0.31850496e10 + t306 * t4487 / 0.1263403008e12 - t262 * t4487 / 0.18e2 + t282 * t4487 / 0.24e3;
  t4507 = my_piecewise3(t99, 0, t4486);
  t4536 = t134 * t2180;
  t4554 = 0.21e2 / 0.2e1 * t732 * t2199 + 0.15e2 / 0.4e1 * t1696 * t993 - t710 * t1645 * t993 / 0.2e1 - 0.3e1 / 0.2e1 * t2193 * t2199 - 0.3e1 / 0.4e1 * t2196 * t2199 - t3712 * t1652 * t993 / 0.8e1 - 0.3e1 / 0.2e1 * t992 * t4536 - 0.18e2 * t1664 * t988 * t711 + 0.6e1 * t715 * t2180 * t310 + 0.6e1 * t715 * t988 * t703 + 0.2e1 * t715 * t432 * t1645 + 0.24e2 * t3625 * t432 * t1652;
  t4564 = t1652 * t134;
  t4575 = t710 * t988;
  t4578 = t1660 * t432;
  t4589 = 0.3e1 / 0.8e1 * t1695 * t988 * t2222 + t1013 * t3620 / 0.4e1 + t3658 * t432 * t4564 / 0.16e2 - t132 * t1645 * t993 - 0.75e2 / 0.2e1 * t1013 * t4564 - 0.3e1 * t2249 * t2199 - 0.3e1 * t1019 * t4536 + 0.45e2 / 0.2e1 * t4575 * t2222 + 0.85e2 / 0.4e1 * t4578 * t4564 - 0.6e1 * t723 * t2180 * t1007 - 0.6e1 * t2225 * t1656 - 0.15e2 / 0.2e1 * t1684 * t988 * t2222;
  t4614 = t1007 * t703;
  t4621 = -0.19e2 / 0.8e1 * t3650 * t432 * t4564 - 0.2e1 * t1006 * t3620 + 0.3e1 / 0.4e1 * t731 * t2180 * t1007 + 0.3e1 / 0.4e1 * t2236 * t1656 - 0.4e1 * t1645 * t135 * t432 - 0.12e2 * t2244 * t988 - 0.12e2 * t1016 * t2180 - 0.4e1 * t321 * t4507 - t127 * t4507 * t134 + t317 * t4507 * t134 / 0.2e1 + 0.45e2 / 0.2e1 * t2221 * t4614 - 0.15e2 / 0.2e1 * t2228 * t4614 + 0.3e1 / 0.8e1 * t2241 * t4614;
  t4647 = t1007 * t432;
  t4650 = -0.24e2 * t1685 * t993 - t312 * t4507 + 0.2e1 * t126 * (t4589 + t4621) + 0.2e1 * t1645 * t444 + 0.6e1 * t703 * t1025 + 0.6e1 * t310 * t2257 + 0.2e1 * t4507 * t138 + 0.6e1 * t2180 * t326 + 0.6e1 * t988 * t743 + 0.2e1 * t432 * t1707 - 0.18e2 * t1664 * t996 * t703 + 0.21e2 / 0.2e1 * t731 * t310 * t993 * t703 - 0.3e1 / 0.4e1 * t1660 * t703 * t4647;
  t4655 = my_piecewise3(t98, t4319 + t4356 + t4388 + t4504, -0.8e1 / 0.3e1 * t4507 * t141 - 0.8e1 * t2180 * t329 - 0.8e1 * t988 * t746 - 0.8e1 / 0.3e1 * t432 * t1710 - 0.8e1 / 0.3e1 * t1645 * t447 - 0.8e1 * t703 * t1028 - 0.8e1 * t310 * t2260 - 0.8e1 / 0.3e1 * t126 * (t4554 + t4650));
  t4677 = 0.32e2 * t900 * t3272;
  t4679 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2142 * t1511 + 0.16e2 / 0.9e1 * t2145 * t4452 - 0.8e1 / 0.9e1 * t936 * t4455 - 0.8e1 / 0.3e1 * t2150 * t249 + 0.8e1 * t939 * t4461 - 0.8e1 / 0.3e1 * t939 * t4464 + 0.4e1 / 0.9e1 * t406 * t1516 + 0.16e2 * t89 * t1302 - t4677);
  t4691 = t7 * t402 * t1538;
  t4707 = t7 * t92 * t164 * t2264;
  t4709 = -0.9e1 / 0.32e2 * t7 * t1788 * t245 - 0.9e1 / 0.32e2 * t7 * t764 * t610 - 0.3e1 / 0.32e2 * t4282 - 0.3e1 / 0.32e2 * t7 * t344 * t1507 - 0.3e1 / 0.32e2 * t7 * t1310 * t394 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t4655 - 0.3e1 / 0.32e2 * t7 * t9 * t4679 * t146 - 0.9e1 / 0.32e2 * t7 * t2035 * t334 - 0.9e1 / 0.32e2 * t7 * t905 * t751 - 0.3e1 / 0.32e2 * t4691 - 0.3e1 / 0.32e2 * t7 * t402 * t1715 - 0.3e1 / 0.32e2 * t7 * t1521 * t452 - 0.9e1 / 0.32e2 * t7 * t622 * t1033 - 0.9e1 / 0.32e2 * t7 * t253 * t2265 - 0.3e1 / 0.32e2 * t4707;
  t4716 = t7 * t21 * t164 * t2017;
  t4719 = t7 * t402 * t1276;
  t4722 = t7 * t159 * t1764;
  t4723 = t4722 / 0.16e2;
  t4726 = t7 * t21 * t1275 * t393;
  t4729 = t7 * t764 * t488;
  t4730 = t4729 / 0.16e2;
  t4732 = t7 * t344 * t1289;
  t4735 = t7 * t253 * t1751;
  t4736 = t4735 / 0.16e2;
  t4739 = t7 * t92 * t1275 * t451;
  t4742 = t7 * t905 * t632;
  t4743 = t4742 / 0.16e2;
  t4749 = -0.9e1 / 0.32e2 * t7 * t159 * t2018 - 0.3e1 / 0.32e2 * t4716 - 0.5e1 / 0.144e3 * t4719 + t4723 - 0.5e1 / 0.144e3 * t4726 + t4730 - 0.5e1 / 0.144e3 * t4732 + t4736 - 0.5e1 / 0.144e3 * t4739 + t4743 - 0.5e1 / 0.48e2 * t3419 - 0.5e1 / 0.48e2 * t3423 - t3426 / 0.32e2 - 0.3e1 / 0.32e2 * t3429 + t3432 / 0.8e1;
  t4763 = t3435 / 0.16e2 + t3438 / 0.8e1 - 0.5e1 / 0.48e2 * t3442 - t3445 / 0.32e2 - 0.3e1 / 0.32e2 * t3448 - 0.3e1 / 0.32e2 * t3749 - 0.3e1 / 0.32e2 * t3774 + t3781 / 0.16e2 - t3785 / 0.32e2 - 0.5e1 / 0.48e2 * t3788 + t3795 + t3799 + t3801 / 0.16e2 + t3808 / 0.16e2 - t3812 / 0.32e2;
  t4772 = t11 * (t4274 + t4709 + t4749 + t4763) - t3817 - 0.3e1 / 0.16e2 * t1281 + 0.3e1 / 0.16e2 * t1284 + 0.3e1 / 0.16e2 * t1287 - t3821 - 0.3e1 / 0.16e2 * t1294 - t1313 - t1316 - 0.3e1 / 0.8e1 * t1318 - t1322;
  t4778 = 0.3e1 / 0.16e2 * t1749;
  t4779 = 0.3e1 / 0.16e2 * t1325 - 0.3e1 / 0.16e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.8e1 * t1529 - t1533 + 0.3e1 / 0.16e2 * t1536 - 0.3e1 / 0.16e2 * t1540 - t1718 - t4778;
  t4781 = 0.3e1 / 0.16e2 * t1756;
  t4782 = 0.3e1 / 0.16e2 * t1762;
  t4783 = 0.3e1 / 0.16e2 * t1770;
  t4786 = 0.3e1 / 0.16e2 * t1796;
  t4788 = t3120 - t4781 + t3121 - t4782 + t3122 - t4783 + t3123 - 0.9e1 / 0.32e2 * t1790 - 0.9e1 / 0.16e2 * t1793 - t4786 - 0.9e1 / 0.32e2 * t1799;
  t4791 = 0.3e1 / 0.16e2 * t1809;
  t4795 = 0.3e1 / 0.16e2 * t2043;
  t4799 = 0.3e1 / 0.16e2 * t2056;
  t4801 = -0.9e1 / 0.32e2 * t1802 - 0.9e1 / 0.16e2 * t1805 - t4791 - 0.9e1 / 0.32e2 * t2020 - 0.9e1 / 0.32e2 * t2037 - 0.9e1 / 0.16e2 * t2040 - t4795 - 0.9e1 / 0.32e2 * t2046 - 0.9e1 / 0.32e2 * t2049 - 0.9e1 / 0.16e2 * t2052 - t4799 - 0.9e1 / 0.32e2 * t2267;
  tv4rho41 = t4772 + t4779 + t4788 + t4801;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4803 = t189 * t810;
  t4820 = t810 * t810;
  t4832 = t27 * t173 * t2413;
  t4838 = t155 * t10 * t468;
  t4843 = t10 * t10;
  t4846 = 0.1e1 / t1301 / t152;
  t4862 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3259 * t1043 * t464 + 0.8e2 / 0.27e2 * t1895 * t4838 + 0.1e2 / 0.27e2 * t2398 * t471 - 0.16e2 / 0.9e1 * t516 * t4843 * t4846 - 0.8e1 / 0.9e1 * t797 * t468 + 0.8e1 / 0.3e1 * t797 * t1303 + 0.1e2 / 0.27e2 * t1403 * t1047 * t464 - 0.4e1 / 0.9e1 * t516 * t2408 * t155 - 0.2e1 / 0.9e1 * t2403 * t471 + t4056);
  t4868 = t27 * t501 * t1066;
  t4870 = t804 * t804;
  t4876 = t27 * t501 * t1076;
  t4884 = -0.4e1 / 0.3e1 * t791 * t1882 * t793 * t804 + t3218 + t4832 / 0.27e2 - t27 * t29 * t178 * t4862 / 0.18e2 + 0.4e1 / 0.81e2 * t4868 + 0.2e1 / 0.9e1 * t27 * t29 * t509 * t4870 - 0.2e1 / 0.81e2 * t4876 + 0.28e2 / 0.243e3 * t4004 - 0.8e1 / 0.81e2 * t4064 + t4067 / 0.27e2 + 0.28e2 / 0.243e3 * t3220 + 0.4e1 / 0.81e2 * t3223 - 0.2e1 / 0.81e2 * t3226;
  t4886 = t791 * t3991 * t2383;
  t4889 = t791 * t1875 * t2387;
  t4900 = t791 * t1875 * t2394;
  t4922 = 0.2e1 / 0.9e1 * t4886 - 0.4e1 / 0.27e2 * t4889 - t791 * t1882 * t1065 * t522 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t350 * t1908 - 0.2e1 / 0.27e2 * t4900 + 0.2e1 / 0.9e1 * t791 * t792 * t2412 * t183 + t791 * t792 * t1075 * t522 / 0.9e1 - t791 * t1882 * t1075 * t510 / 0.3e1 + 0.4e1 / 0.3e1 * t791 * t3995 * t1065 * t510 + 0.2e1 / 0.9e1 * t3993 + 0.16e2 / 0.81e2 * t4008 - 0.4e1 / 0.27e2 * t4011 - 0.2e1 / 0.27e2 * t4014;
  t4923 = t4884 + t4922;
  t4924 = my_piecewise3(t36, t4923, 0);
  t4939 = -0.8e1 / 0.3e1 * t359 * t4803 + t361 * t4803 / 0.2e1 - t363 * t4803 / 0.2e2 + t365 * t4803 / 0.288e3 - t367 * t4803 / 0.5376e4 + t369 * t4803 / 0.12288e6 - t371 * t4803 / 0.331776e7 + t1866 * t4803 / 0.1032192e9 - t45 * t4820 / 0.24e2 + t48 * t4820 / 0.32e3 - t51 * t4820 / 0.576e4 + t217 * t4924 / 0.1263403008e12 - t170 * t4924 / 0.18e2 + t193 * t4924 / 0.24e3 - t197 * t4924 / 0.448e4 + t201 * t4924 / 0.10368e6 - t205 * t4924 / 0.2838528e7 + t209 * t4924 / 0.8945664e8;
  t4977 = -t213 * t4924 / 0.31850496e10 + t54 * t4820 / 0.129024e6 - t57 * t4820 / 0.344064e7 + t60 * t4820 / 0.10616832e9 - t556 * t4820 / 0.37158912e10 + t42 * t4820 / 0.3e1 + t828 * t1914 / 0.129024e6 + t2350 * t528 / 0.258048e6 + t2353 * t528 / 0.49152e6 - t833 * t1914 / 0.344064e7 - t2359 * t528 / 0.688128e7 - t2362 * t528 / 0.1327104e8 + t838 * t1914 / 0.10616832e9 + t2367 * t528 / 0.21233664e9 + t2370 * t528 / 0.4128768e9 - t843 * t1914 / 0.37158912e10 - t2375 * t528 / 0.74317824e10 - t556 * t2418 * t189 / 0.37158912e10;
  t5022 = t42 * t2418 * t189 / 0.3e1 - t45 * t2418 * t189 / 0.24e2 + t48 * t2418 * t189 / 0.32e3 - t51 * t2418 * t189 / 0.576e4 + t54 * t2418 * t189 / 0.129024e6 - t57 * t2418 * t189 / 0.344064e7 + t60 * t2418 * t189 / 0.10616832e9 - 0.2e1 / 0.3e1 * t2313 * t528 + t783 * t1914 / 0.3e1 + t2318 * t528 / 0.6e1 + t2321 * t528 / 0.8e1 - t813 * t1914 / 0.24e2 - t2326 * t528 / 0.48e2 - t2329 * t528 / 0.8e2 + t818 * t1914 / 0.32e3 + t2334 * t528 / 0.64e3 + t2337 * t528 / 0.1152e4 - t823 * t1914 / 0.576e4;
  t5061 = -t2342 * t528 / 0.1152e5 - t2345 * t528 / 0.21504e5 - t1102 * t496 / 0.21504e5 - t1104 * t496 / 0.32768e5 + t1106 * t496 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1108 * t496 - t1110 * t496 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3202 * t1061 * t496 + t1369 * t1081 * t496 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1084 * t496 - 0.2e1 / 0.3e1 * t1086 * t496 - 0.7e1 / 0.8e1 * t1088 * t496 + t1090 * t496 / 0.8e1 + 0.9e1 / 0.8e2 * t1092 * t496 - t1094 * t496 / 0.8e2 - 0.11e2 / 0.1152e4 * t1096 * t496 + t1098 * t496 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1100 * t496;
  t5064 = my_piecewise3(t36, 0, t4923);
  t5081 = t868 * t849;
  t5104 = t72 * t2437;
  t5116 = -t4153 * t5081 - 0.24e2 * t1456 * t857 * t849 + 0.7e1 / 0.2e1 * t1135 * t1448 + 0.15e2 / 0.4e1 * t2495 * t1975 - t1974 * t4117 - t2451 * t1448 / 0.4e1 - t3318 * t1118 * t1975 / 0.8e1 - 0.6e1 * t1456 * t1118 * t562 + 0.4e1 * t574 * t374 * t1933 - t1946 * t2460 / 0.2e1 - t853 * t5104 - t1949 * t2460 / 0.4e1 + 0.4e1 * t574 * t2437 * t221 + 0.2e1 * t574 * t1113 * t562 - 0.24e2 * t2481 * t1975;
  t5160 = t590 * t2437;
  t5163 = 0.3e2 * t1974 * t5081 - 0.1e2 * t1981 * t5081 + t1994 * t5081 / 0.2e1 - t2002 * t2460 - 0.2e1 * t880 * t5104 - 0.75e2 / 0.2e1 * t1135 * t1975 + 0.15e2 / 0.2e1 * t569 * t1113 * t1975 + 0.15e2 / 0.2e1 * t1119 * t1448 + 0.85e2 / 0.4e1 * t2451 * t1975 - 0.4e1 * t867 * t4117 - 0.5e1 / 0.2e1 * t2481 * t1448 - 0.19e2 / 0.8e1 * t3343 * t1118 * t1975 - 0.4e1 * t582 * t2437 * t868 - 0.2e1 * t2484 * t1448 - 0.5e1 / 0.2e1 * t1476 * t1113 * t1975 + t5160 * t868 / 0.2e1;
  t5166 = t1487 * t1113;
  t5178 = t849 * t849;
  t5203 = t2490 * t1448 / 0.4e1 + t5166 * t1975 / 0.8e1 + t874 * t4117 / 0.2e1 + t2495 * t1448 / 0.8e1 + t3326 * t1118 * t1975 / 0.16e2 - 0.2e1 * t2501 * t4117 - 0.8e1 * t5178 * t73 - 0.2e1 * t70 * t5178 * t72 + t228 * t5064 * t72 / 0.2e1 - 0.8e1 * t2498 * t1933 - 0.4e1 * t1997 * t1113 - 0.8e1 * t877 * t2437 - 0.4e1 * t232 * t5064 - t65 * t5064 * t72 - 0.4e1 * t582 * t5178 * t72 + t590 * t5178 * t72 / 0.2e1;
  t5228 = 0.24e2 * t3398 * t1118 * t570 + 0.7e1 / 0.2e1 * t591 * t2460 - 0.6e1 * t1456 * t1113 * t570 + 0.14e2 * t874 * t5081 + 0.2e1 * t63 * (t5163 + t5203) + 0.4e1 * t1933 * t386 + 0.8e1 * t849 * t886 + 0.4e1 * t374 * t2010 + 0.2e1 * t562 * t1146 + 0.4e1 * t221 * t2511 + 0.2e1 * t5064 * t76 + 0.4e1 * t2437 * t237 + 0.2e1 * t1113 * t602 - t223 * t5064 - t569 * t5178 * t72 + 0.4e1 * t574 * t5178;
  t5233 = my_piecewise3(t35, t4939 + t4977 + t5022 + t5061, -0.8e1 / 0.3e1 * t5064 * t79 - 0.16e2 / 0.3e1 * t2437 * t240 - 0.8e1 / 0.3e1 * t1113 * t605 - 0.16e2 / 0.3e1 * t1933 * t389 - 0.32e2 / 0.3e1 * t849 * t889 - 0.16e2 / 0.3e1 * t374 * t2013 - 0.8e1 / 0.3e1 * t562 * t1149 - 0.16e2 / 0.3e1 * t221 * t2514 - 0.8e1 / 0.3e1 * t63 * (t5116 + t5228));
  t5239 = t7 * t253 * t2290;
  t5243 = t7 * t92 * t164 * t2752;
  t5246 = t7 * t402 * t1751;
  t5249 = t7 * t344 * t1764;
  t5253 = t7 * t21 * t487 * t1153;
  t5256 = t7 * t1052 * t488;
  t5260 = t7 * t92 * t487 * t1267;
  t5263 = t7 * t1166 * t632;
  t5265 = t278 * t949;
  t5303 = -t425 * t5265 / 0.5376e4 + t427 * t5265 / 0.12288e6 - t429 * t5265 / 0.331776e7 + t2113 * t5265 / 0.1032192e9 - 0.8e1 / 0.3e1 * t417 * t5265 + t419 * t5265 / 0.2e1 - t421 * t5265 / 0.2e2 + t423 * t5265 / 0.288e3 - t1208 * t640 / 0.8e2 - 0.11e2 / 0.1152e4 * t1210 * t640 + t1212 * t640 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1214 * t640 - t1216 * t640 / 0.21504e5 - t1218 * t640 / 0.32768e5 + t1220 * t640 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1222 * t640 - t1224 * t640 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3604 * t1175 * t640;
  t5344 = t1580 * t1195 * t640 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1198 * t640 - 0.2e1 / 0.3e1 * t1200 * t640 - 0.7e1 / 0.8e1 * t1202 * t640 + t1204 * t640 / 0.8e1 + 0.9e1 / 0.8e2 * t1206 * t640 + t957 * t2161 / 0.32e3 + t111 * t2652 * t278 / 0.32e3 + t2587 * t669 / 0.64e3 + t2590 * t669 / 0.1152e4 - t962 * t2161 / 0.576e4 - t114 * t2652 * t278 / 0.576e4 - t2596 * t669 / 0.1152e5 - t2599 * t669 / 0.21504e5 + t967 * t2161 / 0.129024e6 + t117 * t2652 * t278 / 0.129024e6 + t2604 * t669 / 0.258048e6 + t2607 * t669 / 0.49152e6;
  t5387 = -t972 * t2161 / 0.344064e7 - t120 * t2652 * t278 / 0.344064e7 - t2612 * t669 / 0.688128e7 - t2550 * t669 / 0.1327104e8 + t977 * t2161 / 0.10616832e9 + t123 * t2652 * t278 / 0.10616832e9 + t2555 * t669 / 0.21233664e9 + t2558 * t669 / 0.4128768e9 - t982 * t2161 / 0.37158912e10 - t697 * t2652 * t278 / 0.37158912e10 - t2563 * t669 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2566 * t669 + t924 * t2161 / 0.3e1 + t105 * t2652 * t278 / 0.3e1 + t2571 * t669 / 0.6e1 + t2574 * t669 / 0.8e1 - t952 * t2161 / 0.24e2 - t108 * t2652 * t278 / 0.24e2;
  t5400 = t249 * t10 * t468;
  t5421 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3533 * t1158 * t614 - 0.8e2 / 0.27e2 * t2142 * t5400 + 0.1e2 / 0.27e2 * t2635 * t617 - 0.16e2 / 0.9e1 * t657 * t4843 * t4846 + 0.8e1 / 0.9e1 * t936 * t468 - 0.8e1 / 0.3e1 * t936 * t1303 + 0.1e2 / 0.27e2 * t1611 * t1161 * t614 - 0.4e1 / 0.9e1 * t657 * t2529 * t249 - 0.2e1 / 0.9e1 * t2640 * t617 - t4472);
  t5427 = t27 * t173 * t2647;
  t5430 = t27 * t501 * t1180;
  t5432 = t943 * t943;
  t5438 = t27 * t501 * t1190;
  t5446 = -0.4e1 / 0.3e1 * t791 * t2129 * t932 * t943 + t3492 - t27 * t29 * t267 * t5421 / 0.18e2 + t5427 / 0.27e2 + 0.4e1 / 0.81e2 * t5430 + 0.2e1 / 0.9e1 * t27 * t29 * t650 * t5432 - 0.2e1 / 0.81e2 * t5438 + 0.28e2 / 0.243e3 * t4429 - 0.8e1 / 0.81e2 * t4443 + t4446 / 0.27e2 + 0.28e2 / 0.243e3 * t3494 + 0.4e1 / 0.81e2 * t3497 - 0.2e1 / 0.81e2 * t3500;
  t5460 = t791 * t4409 * t2620;
  t5463 = t791 * t2122 * t2624;
  t5474 = t791 * t2122 * t2631;
  t5484 = -t791 * t2129 * t1189 * t651 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2646 * t272 + t791 * t931 * t1189 * t663 / 0.9e1 + 0.2e1 / 0.9e1 * t5460 - 0.4e1 / 0.27e2 * t5463 - t791 * t2129 * t1179 * t663 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t408 * t2155 - 0.2e1 / 0.27e2 * t5474 + 0.4e1 / 0.3e1 * t791 * t4401 * t1179 * t651 + 0.2e1 / 0.9e1 * t4411 + 0.16e2 / 0.81e2 * t4433 - 0.4e1 / 0.27e2 * t4436 - 0.2e1 / 0.27e2 * t4440;
  t5485 = t5446 + t5484;
  t5486 = my_piecewise3(t99, t5485, 0);
  t5503 = t949 * t949;
  t5520 = -t2579 * t669 / 0.48e2 - t2582 * t669 / 0.8e2 - t262 * t5486 / 0.18e2 + t282 * t5486 / 0.24e3 - t286 * t5486 / 0.448e4 + t290 * t5486 / 0.10368e6 - t294 * t5486 / 0.2838528e7 + t298 * t5486 / 0.8945664e8 - t302 * t5486 / 0.31850496e10 + t306 * t5486 / 0.1263403008e12 - t114 * t5503 / 0.576e4 + t117 * t5503 / 0.129024e6 - t120 * t5503 / 0.344064e7 + t123 * t5503 / 0.10616832e9 - t697 * t5503 / 0.37158912e10 + t105 * t5503 / 0.3e1 - t108 * t5503 / 0.24e2 + t111 * t5503 / 0.32e3;
  t5523 = my_piecewise3(t99, 0, t5485);
  t5558 = t134 * t2671;
  t5575 = 0.7e1 / 0.2e1 * t1249 * t1656 + 0.15e2 / 0.4e1 * t2729 * t2222 - t2221 * t4536 - t2685 * t1656 / 0.4e1 - t3712 * t1232 * t2222 / 0.8e1 - 0.6e1 * t1664 * t1232 * t703 + 0.4e1 * t715 * t432 * t2180 - t2193 * t2694 / 0.2e1 - t992 * t5558 - t2196 * t2694 / 0.4e1 + 0.4e1 * t715 * t2671 * t310 + 0.2e1 * t715 * t1227 * t703 - 0.24e2 * t2715 * t2222 + 0.24e2 * t3625 * t1232 * t711 + 0.7e1 / 0.2e1 * t732 * t2694;
  t5579 = t1007 * t988;
  t5621 = t731 * t2671;
  t5626 = t1013 * t4536 / 0.2e1 + t2729 * t1656 / 0.8e1 + t3658 * t1232 * t2222 / 0.16e2 - 0.2e1 * t2735 * t4536 - t2249 * t2694 - 0.2e1 * t1019 * t5558 + 0.15e2 / 0.2e1 * t1233 * t1656 + 0.85e2 / 0.4e1 * t2685 * t2222 - 0.4e1 * t1006 * t4536 - 0.5e1 / 0.2e1 * t2715 * t1656 - 0.19e2 / 0.8e1 * t3650 * t1232 * t2222 - 0.4e1 * t723 * t2671 * t1007 - 0.2e1 * t2718 * t1656 - 0.5e1 / 0.2e1 * t1684 * t1227 * t2222 + t5621 * t1007 / 0.2e1 + t2724 * t1656 / 0.4e1;
  t5627 = t1695 * t1227;
  t5635 = t988 * t988;
  t5666 = t5627 * t2222 / 0.8e1 - 0.75e2 / 0.2e1 * t1249 * t2222 + 0.15e2 / 0.2e1 * t710 * t1227 * t2222 - 0.8e1 * t5635 * t135 + 0.3e2 * t2221 * t5579 - 0.1e2 * t2228 * t5579 + t2241 * t5579 / 0.2e1 - 0.8e1 * t1016 * t2671 - 0.4e1 * t321 * t5523 - t127 * t5523 * t134 + t317 * t5523 * t134 / 0.2e1 - 0.8e1 * t2732 * t2180 - 0.4e1 * t2244 * t1227 - 0.2e1 * t132 * t5635 * t134 - 0.4e1 * t723 * t5635 * t134 + t731 * t5635 * t134 / 0.2e1;
  t5687 = -0.6e1 * t1664 * t1227 * t711 + 0.14e2 * t1013 * t5579 - t4578 * t5579 - 0.24e2 * t1664 * t996 * t988 + 0.2e1 * t703 * t1260 + 0.4e1 * t310 * t2745 + 0.2e1 * t126 * (t5626 + t5666) + 0.4e1 * t2180 * t444 + 0.8e1 * t988 * t1025 + 0.4e1 * t432 * t2257 + 0.2e1 * t5523 * t138 + 0.4e1 * t2671 * t326 + 0.2e1 * t1227 * t743 - t710 * t5635 * t134 + 0.4e1 * t715 * t5635 - t312 * t5523;
  t5692 = my_piecewise3(t98, t5303 + t5344 + t5387 + t5520, -0.8e1 / 0.3e1 * t5523 * t141 - 0.16e2 / 0.3e1 * t2671 * t329 - 0.8e1 / 0.3e1 * t1227 * t746 - 0.16e2 / 0.3e1 * t2180 * t447 - 0.32e2 / 0.3e1 * t988 * t1028 - 0.16e2 / 0.3e1 * t432 * t2260 - 0.8e1 / 0.3e1 * t703 * t1263 - 0.16e2 / 0.3e1 * t310 * t2748 - 0.8e1 / 0.3e1 * t126 * (t5575 + t5687));
  t5717 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2635 * t614 + 0.64e2 / 0.27e2 * t936 * t5400 - 0.8e1 / 0.27e2 * t1184 * t617 + 0.32e2 / 0.9e1 * t269 * t4843 * t4846 - 0.16e2 / 0.9e1 * t406 * t468 + 0.16e2 / 0.3e1 * t406 * t1303 - 0.8e1 / 0.27e2 * t2640 * t614 + 0.8e1 / 0.9e1 * t2643 * t249 + 0.4e1 / 0.9e1 * t1186 * t617 - t4677);
  t5726 = t7 * t2534 * t257;
  t5729 = t7 * t1166 * t636;
  t5732 = t7 * t905 * t920;
  t5735 = t7 * t402 * t2054;
  t5738 = t7 * t764 * t779;
  t5741 = t7 * t344 * t1807;
  t5743 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t5233 - t5239 / 0.16e2 - t5243 / 0.16e2 + t5246 / 0.24e2 + t5249 / 0.24e2 + t5253 / 0.48e2 + t5256 / 0.48e2 + t5260 / 0.48e2 + t5263 / 0.48e2 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t5692 - 0.3e1 / 0.32e2 * t7 * t9 * t5717 * t146 - 0.3e1 / 0.16e2 * t7 * t2534 * t334 - t5726 / 0.16e2 - t5729 / 0.16e2 - t5732 / 0.8e1 - t5735 / 0.8e1 - t5738 / 0.8e1 - t5741 / 0.8e1;
  t5745 = t7 * t159 * t2303;
  t5749 = t7 * t21 * t164 * t2518;
  t5752 = t7 * t2767 * t165;
  t5755 = t7 * t1052 * t492;
  t5786 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t2398 * t464 - 0.64e2 / 0.27e2 * t797 * t4838 - 0.8e1 / 0.27e2 * t1070 * t471 + 0.32e2 / 0.9e1 * t180 * t4843 * t4846 + 0.16e2 / 0.9e1 * t348 * t468 - 0.16e2 / 0.3e1 * t348 * t1303 - 0.8e1 / 0.27e2 * t2403 * t464 + 0.8e1 / 0.9e1 * t2409 * t155 + 0.4e1 / 0.9e1 * t1072 * t471 + t4267);
  t5821 = -t5745 / 0.16e2 - t5749 / 0.16e2 - t5752 / 0.16e2 - t5755 / 0.16e2 - 0.3e1 / 0.32e2 * t7 * t476 * t1154 - 0.3e1 / 0.16e2 * t7 * t159 * t2519 - 0.3e1 / 0.16e2 * t7 * t253 * t2753 - 0.3e1 / 0.32e2 * t7 * t9 * t5786 * t84 - 0.3e1 / 0.16e2 * t7 * t2767 * t245 - 0.3e1 / 0.32e2 * t7 * t1052 * t610 - 0.3e1 / 0.16e2 * t7 * t1788 * t394 - 0.3e1 / 0.8e1 * t7 * t764 * t894 - 0.3e1 / 0.16e2 * t7 * t344 * t2018 - 0.3e1 / 0.32e2 * t7 * t1166 * t751 - 0.3e1 / 0.16e2 * t7 * t2035 * t452 - 0.3e1 / 0.8e1 * t7 * t905 * t1033 - 0.3e1 / 0.16e2 * t7 * t402 * t2265 - 0.3e1 / 0.32e2 * t7 * t622 * t1268;
  t5841 = -t3843 / 0.8e1 + t3846 / 0.12e2 - t3849 / 0.16e2 - t3852 / 0.8e1 + t3856 / 0.12e2 - t3859 / 0.16e2 - t3862 / 0.8e1 + t3865 / 0.12e2 - t3868 / 0.16e2 - t3871 / 0.8e1 + t3875 / 0.12e2 - t3878 / 0.16e2 - t4282 / 0.16e2 - t4691 / 0.16e2 - t4707 / 0.16e2 - t4716 / 0.16e2 - 0.5e1 / 0.72e2 * t4719 + t4722 / 0.12e2;
  t5858 = -0.5e1 / 0.72e2 * t4726 + t4729 / 0.12e2 - 0.5e1 / 0.72e2 * t4732 + t4735 / 0.12e2 - 0.5e1 / 0.72e2 * t4739 + t4742 / 0.12e2 - 0.5e1 / 0.72e2 * t3419 - 0.5e1 / 0.72e2 * t3423 + t3432 / 0.24e2 + t3435 / 0.48e2 + t3438 / 0.24e2 - 0.5e1 / 0.72e2 * t3442 + t3781 / 0.48e2 - 0.5e1 / 0.72e2 * t3788 + t3795 + t3799 + t3801 / 0.48e2 + t3808 / 0.48e2;
  t5872 = t11 * (t5743 + t5821 + t5841 + t5858) - t3817 - t1281 / 0.16e2 + t1284 / 0.8e1 + t1287 / 0.8e1 - t3821 - t1294 / 0.16e2 - t1318 / 0.8e1 + t1325 / 0.8e1 - t1329 / 0.16e2 - t1529 / 0.8e1 + t1536 / 0.8e1 - t1540 / 0.16e2;
  t5887 = -t1749 / 0.4e1 + t1753 / 0.8e1 - t1756 / 0.4e1 + t1759 / 0.8e1 - t1762 / 0.4e1 + t1766 / 0.8e1 - t1770 / 0.4e1 + t1773 / 0.8e1 - 0.3e1 / 0.16e2 * t1790 - 0.3e1 / 0.8e1 * t1793 - t1796 / 0.4e1 - 0.3e1 / 0.16e2 * t1799 - 0.3e1 / 0.16e2 * t1802 - 0.3e1 / 0.8e1 * t1805;
  t5903 = -t1809 / 0.4e1 - 0.3e1 / 0.16e2 * t2020 - 0.3e1 / 0.16e2 * t2037 - 0.3e1 / 0.8e1 * t2040 - t2043 / 0.4e1 - 0.3e1 / 0.16e2 * t2046 - 0.3e1 / 0.16e2 * t2049 - 0.3e1 / 0.8e1 * t2052 - t2056 / 0.4e1 - 0.3e1 / 0.16e2 * t2267 - t2292 / 0.16e2 - t2295 / 0.16e2 - t2298 / 0.8e1 - t2301 / 0.8e1;
  t5918 = -t2305 / 0.16e2 - t2308 / 0.16e2 - 0.3e1 / 0.16e2 * t2311 - 0.3e1 / 0.16e2 * t2521 - 0.3e1 / 0.16e2 * t2536 - 0.3e1 / 0.16e2 * t2539 - 0.3e1 / 0.8e1 * t2542 - 0.3e1 / 0.8e1 * t2545 - 0.3e1 / 0.16e2 * t2548 - 0.3e1 / 0.16e2 * t2755 - 0.3e1 / 0.16e2 * t2769 - 0.3e1 / 0.16e2 * t2772 - 0.3e1 / 0.8e1 * t2775 - 0.3e1 / 0.8e1 * t2778;
  tv4rho42 = t5872 + t5887 + t5903 + t5918;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t5920 = t1195 * t278;
  t5947 = t27 * t173 * t2820;
  t5957 = t791 * t2122 * t2824;
  t5971 = t27 * t173 * t2836;
  t5982 = t1161 * t249;
  t5985 = t468 * t1161;
  t5995 = -0.12e2 * t1302 - 0.24e2 * t3273;
  t5999 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3533 * t2795 * t249 - 0.2e2 / 0.9e1 * t2635 * t469 + 0.1e2 / 0.9e1 * t2142 * t5982 + 0.4e1 / 0.3e1 * t2145 * t5985 - 0.2e1 / 0.3e1 * t936 * t2529 - 0.2e1 / 0.9e1 * t657 * t2801 * t249 + t269 * t5995 / 0.3e1);
  t6004 = t5427 / 0.18e2 + t5947 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t4401 * t2819 * t272 - t791 * t2129 * t1179 * t943 - t5957 / 0.9e1 - t791 * t2129 * t2824 * t272 + t791 * t931 * t943 * t1189 / 0.3e1 + t791 * t931 * t408 * t2646 / 0.3e1 + t5971 / 0.54e2 + t791 * t931 * t2835 * t272 / 0.9e1 - t27 * t29 * t267 * t5999 / 0.18e2;
  t6005 = t3492 + 0.14e2 / 0.243e3 * t3494 + 0.14e2 / 0.81e2 * t4429 + t4434 - t4444 + 0.4e1 / 0.27e2 * t5430 + t5460 / 0.3e1 - 0.2e1 / 0.9e1 * t5463 - 0.2e1 / 0.27e2 * t5438 - t5474 / 0.9e1 + t6004;
  t6006 = my_piecewise3(t99, t6005, 0);
  t6019 = t423 * t5920 / 0.384e3 - t425 * t5920 / 0.7168e4 + t427 * t5920 / 0.16384e6 - t429 * t5920 / 0.442368e7 + t2113 * t5920 / 0.1376256e9 - 0.2e1 * t417 * t5920 + 0.3e1 / 0.8e1 * t419 * t5920 - 0.3e1 / 0.8e2 * t421 * t5920 - t302 * t6006 / 0.31850496e10 + t306 * t6006 / 0.1263403008e12 - t262 * t6006 / 0.18e2 + t282 * t6006 / 0.24e3 - t286 * t6006 / 0.448e4 + t290 * t6006 / 0.10368e6;
  t6024 = t105 * t2841;
  t6027 = t108 * t2841;
  t6030 = t111 * t2841;
  t6033 = t114 * t2841;
  t6036 = t117 * t2841;
  t6039 = t120 * t2841;
  t6042 = t123 * t2841;
  t6045 = t697 * t2841;
  t6057 = -t294 * t6006 / 0.2838528e7 + t298 * t6006 / 0.8945664e8 + t6024 * t278 / 0.6e1 - t6027 * t278 / 0.48e2 + t6030 * t278 / 0.64e3 - t6033 * t278 / 0.1152e5 + t6036 * t278 / 0.258048e6 - t6039 * t278 / 0.688128e7 + t6042 * t278 / 0.21233664e9 - t6045 * t278 / 0.74317824e10 + 0.1e2 / 0.3e1 * t108 * t2858 * t278 - 0.2e1 * t2566 * t949 + t2093 * t1195 / 0.2e1 + t924 * t2652 / 0.2e1;
  t6091 = -0.7e1 / 0.8e1 * t111 * t2858 * t278 + 0.3e1 / 0.8e1 * t2574 * t949 - t2058 * t1195 / 0.16e2 - t952 * t2652 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t2858 * t278 - 0.3e1 / 0.8e2 * t2582 * t949 + 0.3e1 / 0.64e3 * t2063 * t1195 + 0.3e1 / 0.64e3 * t957 * t2652 - 0.11e2 / 0.1152e4 * t117 * t2858 * t278 + t2590 * t949 / 0.384e3 - t2068 * t1195 / 0.384e4 - t962 * t2652 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t2858 * t278 - t2599 * t949 / 0.7168e4;
  t6123 = t2073 * t1195 / 0.86016e5 + t967 * t2652 / 0.86016e5 - t123 * t2858 * t278 / 0.32768e5 + t2607 * t949 / 0.16384e6 - t2078 * t1195 / 0.229376e7 - t972 * t2652 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t2858 * t278 - t2550 * t949 / 0.442368e7 + t2083 * t1195 / 0.7077888e8 + t977 * t2652 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3604 * t2858 * t278 + t2558 * t949 / 0.1376256e9 - t2088 * t1195 / 0.24772608e10 - t982 * t2652 / 0.24772608e10;
  t6126 = my_piecewise3(t99, 0, t6005);
  t6171 = -0.24e2 * t2927 * t1007 + 0.21e2 / 0.2e1 * t1249 * t2199 + 0.15e2 / 0.4e1 * t2935 * t1007 - 0.3e1 / 0.2e1 * t4575 * t2694 - 0.3e1 / 0.2e1 * t2221 * t5558 - 0.3e1 / 0.4e1 * t2685 * t2199 - t3712 * t2901 * t1007 / 0.8e1 + 0.24e2 * t3625 * t2901 * t310 - 0.18e2 * t1664 * t1232 * t988 + 0.6e1 * t715 * t988 * t1227 + 0.6e1 * t715 * t432 * t2671 + 0.2e1 * t715 * t2894 * t310;
  t6172 = t134 * t2894;
  t6175 = t2694 * t310;
  t6205 = t731 * t2894;
  t6214 = -0.75e2 / 0.2e1 * t2902 * t1007 + 0.45e2 / 0.2e1 * t1233 * t2199 + 0.85e2 / 0.4e1 * t2907 * t1007 - 0.6e1 * t2225 * t2694 - 0.6e1 * t1006 * t5558 - 0.15e2 / 0.2e1 * t2715 * t2199 - 0.19e2 / 0.8e1 * t3650 * t2901 * t1007 - 0.2e1 * t723 * t2894 * t1007 + t6205 * t1007 / 0.4e1 + 0.3e1 / 0.4e1 * t5621 * t993 + 0.3e1 / 0.4e1 * t2724 * t2199 + 0.3e1 / 0.8e1 * t2729 * t2199;
  t6244 = t3658 * t2901 * t1007 / 0.16e2 - 0.3e1 * t132 * t988 * t2694 - 0.3e1 * t2735 * t5558 - t1019 * t6172 - 0.15e2 / 0.2e1 * t2228 * t6175 + 0.3e1 / 0.8e1 * t5627 * t4647 + 0.45e2 / 0.2e1 * t2221 * t6175 - 0.4e1 * t1016 * t2894 - 0.4e1 * t321 * t6126 - t127 * t6126 * t134 + t317 * t6126 * t134 / 0.2e1 - 0.12e2 * t988 * t135 * t1227 - 0.12e2 * t2732 * t2671;
  t6259 = -t992 * t6172 / 0.2e1 + 0.21e2 / 0.2e1 * t1013 * t6175 - 0.3e1 / 0.4e1 * t4578 * t6175 - 0.18e2 * t1664 * t2912 * t310 + 0.6e1 * t432 * t2745 + 0.2e1 * t310 * t2946 + 0.2e1 * t126 * (t6214 + t6244) + 0.2e1 * t6126 * t138 + 0.2e1 * t2894 * t326 + 0.6e1 * t2671 * t444 + 0.6e1 * t1227 * t1025 + 0.6e1 * t988 * t1260 - t312 * t6126;
  t6264 = my_piecewise3(t98, t6019 + t6057 + t6091 + t6123, -0.8e1 / 0.3e1 * t6126 * t141 - 0.8e1 / 0.3e1 * t2894 * t329 - 0.8e1 * t2671 * t447 - 0.8e1 * t1227 * t1028 - 0.8e1 * t988 * t1263 - 0.8e1 * t432 * t2748 - 0.8e1 / 0.3e1 * t310 * t2949 - 0.8e1 / 0.3e1 * t126 * (t6171 + t6259));
  t6273 = t1047 * t155;
  t6276 = t468 * t1047;
  t6283 = -t5995;
  t6287 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t3009 * t155 - 0.16e2 / 0.9e1 * t1070 * t469 - 0.8e1 / 0.9e1 * t797 * t6273 + 0.8e1 / 0.3e1 * t800 * t6276 + 0.4e1 / 0.3e1 * t348 * t2408 + 0.4e1 / 0.9e1 * t3013 * t155 + 0.4e1 / 0.3e1 * t18 * t6283);
  t6294 = t7 * t21 * t164 * t3115;
  t6297 = t7 * t2968 * t165;
  t6300 = t7 * t1052 * t779;
  t6303 = t7 * t344 * t2303;
  t6306 = t7 * t2806 * t257;
  t6309 = t7 * t1166 * t920;
  t6312 = t7 * t402 * t2290;
  t6316 = t7 * t92 * t164 * t2953;
  t6318 = t1081 * t189;
  t6345 = t27 * t173 * t3001;
  t6355 = t791 * t1875 * t3005;
  t6369 = t27 * t173 * t3017;
  t6392 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3259 * t2958 * t155 + 0.2e2 / 0.9e1 * t2398 * t469 + 0.1e2 / 0.9e1 * t1895 * t6273 - 0.4e1 / 0.3e1 * t1898 * t6276 - 0.2e1 / 0.3e1 * t797 * t2408 - 0.2e1 / 0.9e1 * t516 * t2963 * t155 + t180 * t6283 / 0.3e1);
  t6397 = t4832 / 0.18e2 + t6345 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t3995 * t3000 * t183 - t791 * t1882 * t1065 * t804 - t6355 / 0.9e1 - t791 * t1882 * t3005 * t183 + t791 * t792 * t804 * t1075 / 0.3e1 + t791 * t792 * t350 * t2412 / 0.3e1 + t6369 / 0.54e2 + t791 * t792 * t3016 * t183 / 0.9e1 - t27 * t29 * t178 * t6392 / 0.18e2;
  t6398 = t3218 + 0.14e2 / 0.243e3 * t3220 + 0.14e2 / 0.81e2 * t4004 + t4009 - t4065 + 0.4e1 / 0.27e2 * t4868 + t4886 / 0.3e1 - 0.2e1 / 0.9e1 * t4889 - 0.2e1 / 0.27e2 * t4876 - t4900 / 0.9e1 + t6397;
  t6399 = my_piecewise3(t36, t6398, 0);
  t6412 = -t367 * t6318 / 0.7168e4 + t369 * t6318 / 0.16384e6 - t371 * t6318 / 0.442368e7 + t1866 * t6318 / 0.1376256e9 - 0.2e1 * t359 * t6318 + 0.3e1 / 0.8e1 * t361 * t6318 - 0.3e1 / 0.8e2 * t363 * t6318 + t365 * t6318 / 0.384e3 - t170 * t6399 / 0.18e2 + t193 * t6399 / 0.24e3 - t197 * t6399 / 0.448e4 + t201 * t6399 / 0.10368e6 - t205 * t6399 / 0.2838528e7 + t209 * t6399 / 0.8945664e8;
  t6444 = -t213 * t6399 / 0.31850496e10 + t217 * t6399 / 0.1263403008e12 - t1826 * t1081 / 0.384e4 - t823 * t2418 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t2980 * t189 - t2345 * t810 / 0.7168e4 + t1831 * t1081 / 0.86016e5 + t828 * t2418 / 0.86016e5 - t60 * t2980 * t189 / 0.32768e5 + t2353 * t810 / 0.16384e6 - t1836 * t1081 / 0.229376e7 - t833 * t2418 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t2980 * t189 - t2362 * t810 / 0.442368e7;
  t6459 = t42 * t3022;
  t6462 = t45 * t3022;
  t6465 = t48 * t3022;
  t6483 = t1841 * t1081 / 0.7077888e8 + t838 * t2418 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3202 * t2980 * t189 + t2370 * t810 / 0.1376256e9 - t1846 * t1081 / 0.24772608e10 - t843 * t2418 / 0.24772608e10 + t6459 * t189 / 0.6e1 - t6462 * t189 / 0.48e2 + t6465 * t189 / 0.64e3 - t51 * t3022 * t189 / 0.1152e5 + t54 * t3022 * t189 / 0.258048e6 - t57 * t3022 * t189 / 0.688128e7 + t60 * t3022 * t189 / 0.21233664e9 - t556 * t3022 * t189 / 0.74317824e10;
  t6516 = 0.1e2 / 0.3e1 * t45 * t2980 * t189 - 0.2e1 * t2313 * t810 + t1811 * t1081 / 0.2e1 + t783 * t2418 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t2980 * t189 + 0.3e1 / 0.8e1 * t2321 * t810 - t1816 * t1081 / 0.16e2 - t813 * t2418 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t2980 * t189 - 0.3e1 / 0.8e2 * t2329 * t810 + 0.3e1 / 0.64e3 * t1821 * t1081 + 0.3e1 / 0.64e3 * t818 * t2418 - 0.11e2 / 0.1152e4 * t54 * t2980 * t189 + t2337 * t810 / 0.384e3;
  t6519 = my_piecewise3(t36, 0, t6398);
  t6534 = t2460 * t221;
  t6551 = t72 * t3056;
  t6564 = 0.21e2 / 0.2e1 * t874 * t6534 - 0.3e1 / 0.4e1 * t4153 * t6534 - 0.18e2 * t1456 * t3074 * t221 + 0.6e1 * t574 * t849 * t1113 + 0.6e1 * t574 * t374 * t2437 + 0.2e1 * t574 * t3056 * t221 - t853 * t6551 / 0.2e1 - 0.24e2 * t3089 * t868 + 0.21e2 / 0.2e1 * t1135 * t1952 + 0.15e2 / 0.4e1 * t3097 * t868 - 0.3e1 / 0.2e1 * t4150 * t2460 - 0.3e1 / 0.2e1 * t1974 * t5104;
  t6598 = t590 * t3056;
  t6610 = 0.45e2 / 0.2e1 * t1974 * t6534 - 0.15e2 / 0.2e1 * t1981 * t6534 + 0.3e1 / 0.8e1 * t5166 * t4234 - 0.6e1 * t867 * t5104 - 0.15e2 / 0.2e1 * t2481 * t1952 - 0.19e2 / 0.8e1 * t3343 * t3063 * t868 - 0.2e1 * t582 * t3056 * t868 + t6598 * t868 / 0.4e1 + 0.3e1 / 0.4e1 * t5160 * t854 + 0.3e1 / 0.4e1 * t2490 * t1952 + 0.3e1 / 0.8e1 * t2495 * t1952 + t3326 * t3063 * t868 / 0.16e2;
  t6639 = -0.3e1 * t70 * t849 * t2460 - 0.3e1 * t2501 * t5104 - t880 * t6551 - 0.75e2 / 0.2e1 * t3064 * t868 + 0.45e2 / 0.2e1 * t1119 * t1952 + 0.85e2 / 0.4e1 * t3069 * t868 - 0.6e1 * t1978 * t2460 - 0.4e1 * t232 * t6519 - t65 * t6519 * t72 + t228 * t6519 * t72 / 0.2e1 - 0.12e2 * t849 * t73 * t1113 - 0.12e2 * t2498 * t2437 - 0.4e1 * t877 * t3056;
  t6652 = -0.3e1 / 0.4e1 * t2451 * t1952 - t3318 * t3063 * t868 / 0.8e1 + 0.24e2 * t3398 * t3063 * t221 - 0.18e2 * t1456 * t1118 * t849 + 0.6e1 * t849 * t1146 + 0.6e1 * t374 * t2511 + 0.2e1 * t221 * t3108 + 0.2e1 * t63 * (t6610 + t6639) + 0.2e1 * t6519 * t76 + 0.2e1 * t3056 * t237 + 0.6e1 * t2437 * t386 + 0.6e1 * t1113 * t886 - t223 * t6519;
  t6657 = my_piecewise3(t35, t6412 + t6444 + t6483 + t6516, -0.8e1 / 0.3e1 * t6519 * t79 - 0.8e1 / 0.3e1 * t3056 * t240 - 0.8e1 * t2437 * t389 - 0.8e1 * t1113 * t889 - 0.8e1 * t849 * t1149 - 0.8e1 * t374 * t2514 - 0.8e1 / 0.3e1 * t221 * t3111 - 0.8e1 / 0.3e1 * t63 * (t6564 + t6652));
  t6677 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2828 * t249 + 0.16e2 / 0.9e1 * t1184 * t469 - 0.8e1 / 0.9e1 * t936 * t5982 - 0.8e1 / 0.3e1 * t939 * t5985 + 0.4e1 / 0.3e1 * t406 * t2529 + 0.4e1 / 0.9e1 * t2832 * t249 + 0.4e1 / 0.3e1 * t89 * t5995);
  t6691 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t6264 - 0.3e1 / 0.32e2 * t7 * t9 * t6287 * t84 - t6294 / 0.32e2 - t6297 / 0.32e2 - 0.3e1 / 0.32e2 * t6300 - 0.3e1 / 0.32e2 * t6303 - t6306 / 0.32e2 - 0.3e1 / 0.32e2 * t6309 - 0.3e1 / 0.32e2 * t6312 - t6316 / 0.32e2 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t6657 - 0.3e1 / 0.32e2 * t7 * t9 * t6677 * t146 - 0.3e1 / 0.32e2 * t7 * t2806 * t334 - 0.9e1 / 0.32e2 * t7 * t2534 * t452 - 0.9e1 / 0.32e2 * t7 * t1166 * t1033;
  t6725 = -0.9e1 / 0.32e2 * t7 * t905 * t1268 - 0.9e1 / 0.32e2 * t7 * t402 * t2753 - 0.3e1 / 0.32e2 * t7 * t253 * t2954 - 0.9e1 / 0.32e2 * t7 * t344 * t2519 - 0.3e1 / 0.32e2 * t7 * t159 * t3116 - 0.3e1 / 0.32e2 * t7 * t2968 * t245 - 0.9e1 / 0.32e2 * t7 * t2767 * t394 - 0.9e1 / 0.32e2 * t7 * t1052 * t894 - 0.9e1 / 0.32e2 * t7 * t764 * t1154 - 0.3e1 / 0.32e2 * t5239 - 0.3e1 / 0.32e2 * t5243 + t5246 / 0.8e1 + t5249 / 0.8e1 + t5253 / 0.16e2 + t5256 / 0.16e2;
  t6739 = t5260 / 0.16e2 + t5263 / 0.16e2 - 0.3e1 / 0.32e2 * t5726 - 0.3e1 / 0.32e2 * t5729 - 0.3e1 / 0.16e2 * t5732 - 0.3e1 / 0.16e2 * t5735 - 0.3e1 / 0.16e2 * t5738 - 0.3e1 / 0.16e2 * t5741 - 0.3e1 / 0.32e2 * t5745 - 0.3e1 / 0.32e2 * t5749 - 0.3e1 / 0.32e2 * t5752 - 0.3e1 / 0.32e2 * t5755 + t3847 + t3857 + t3866;
  t6748 = t3876 - 0.5e1 / 0.48e2 * t4719 + t4723 - 0.5e1 / 0.48e2 * t4726 + t4730 - 0.5e1 / 0.48e2 * t4732 + t4736 - 0.5e1 / 0.48e2 * t4739 + t4743 - 0.5e1 / 0.144e3 * t3419 - 0.5e1 / 0.144e3 * t3423 - 0.5e1 / 0.144e3 * t3442 - 0.5e1 / 0.144e3 * t3788 + t3795 + t3799;
  t6752 = -t3119 - t2957 - t2971 - t2974 - t2977 - t2809 - t2812 - t2815 + t11 * (t6691 + t6725 + t6739 + t6748) - t3817 + t1285;
  t6756 = t1288 - t3821 + t1326 + t1537 - t4778 + 0.3e1 / 0.16e2 * t1753 - t4781 + 0.3e1 / 0.16e2 * t1759 - t4782 + 0.3e1 / 0.16e2 * t1766 - t4783;
  t6765 = 0.3e1 / 0.16e2 * t1773 - t4786 - t4791 - t4795 - t4799 - 0.3e1 / 0.16e2 * t2292 - 0.3e1 / 0.16e2 * t2295 - 0.3e1 / 0.8e1 * t2298 - 0.3e1 / 0.8e1 * t2301 - 0.3e1 / 0.16e2 * t2305 - 0.3e1 / 0.16e2 * t2308;
  t6778 = -0.9e1 / 0.32e2 * t2311 - 0.9e1 / 0.32e2 * t2521 - 0.9e1 / 0.32e2 * t2536 - 0.9e1 / 0.32e2 * t2539 - 0.9e1 / 0.16e2 * t2542 - 0.9e1 / 0.16e2 * t2545 - 0.9e1 / 0.32e2 * t2548 - 0.9e1 / 0.32e2 * t2755 - 0.9e1 / 0.32e2 * t2769 - 0.9e1 / 0.32e2 * t2772 - 0.9e1 / 0.16e2 * t2775 - 0.9e1 / 0.16e2 * t2778;
  tv4rho43 = t6752 + t6756 + t6765 + t6778;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t6786 = t1179 * t1179;
  t6795 = t1189 * t1189;
  t6804 = t1158 * t1158;
  t6809 = t1161 * t1161;
  t6815 = -0.24e2 * t1302 - 0.24e2 * t3273;
  t6819 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3533 * t6804 + 0.2e2 / 0.9e1 * t2635 * t1161 - 0.2e1 / 0.3e1 * t657 * t6809 - 0.8e1 / 0.9e1 * t936 * t2801 + t269 * t6815 / 0.3e1);
  t6824 = t3492 + 0.56e2 / 0.243e3 * t4429 + 0.8e1 / 0.27e2 * t5430 - 0.4e1 / 0.27e2 * t5438 + 0.4e1 / 0.9e1 * t5947 - 0.4e1 / 0.9e1 * t5957 + 0.2e1 / 0.27e2 * t5971 + 0.4e1 / 0.3e1 * t27 * t29 * t3512 * t6786 - 0.2e1 * t791 * t2129 * t1179 * t1189 + t27 * t29 * t650 * t6795 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t408 * t2835 - t27 * t29 * t267 * t6819 / 0.18e2;
  t6825 = my_piecewise3(t99, t6824, 0);
  t6832 = t1195 * t1195;
  t6835 = t1175 * t1175;
  t6868 = t298 * t6825 / 0.8945664e8 - t302 * t6825 / 0.31850496e10 + t306 * t6825 / 0.1263403008e12 + 0.3e1 / 0.64e3 * t111 * t6832 - 0.11e2 / 0.1152e4 * t117 * t6835 - t114 * t6832 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t6835 + t117 * t6832 / 0.86016e5 - t123 * t6835 / 0.32768e5 - t120 * t6832 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t6835 + t123 * t6832 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3604 * t6835 - t697 * t6832 / 0.24772608e10 + 0.1e2 / 0.3e1 * t108 * t6835 + t105 * t6832 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t6835 - t108 * t6832 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t6835 - t262 * t6825 / 0.18e2;
  t6909 = t282 * t6825 / 0.24e3 - t286 * t6825 / 0.448e4 + t290 * t6825 / 0.10368e6 - t294 * t6825 / 0.2838528e7 - t6027 * t414 / 0.12e2 + t6030 * t414 / 0.16e3 - t6033 * t414 / 0.288e4 + t6036 * t414 / 0.64512e5 - t6039 * t414 / 0.172032e7 + t6042 * t414 / 0.5308416e8 - t6045 * t414 / 0.18579456e10 - 0.4e1 * t2566 * t1195 + 0.3e1 / 0.4e1 * t2574 * t1195 - 0.3e1 / 0.4e2 * t2582 * t1195 + t2590 * t1195 / 0.192e3 - t2599 * t1195 / 0.3584e4 + t2607 * t1195 / 0.8192e5 - t2550 * t1195 / 0.221184e7 + t2558 * t1195 / 0.688128e8 + 0.2e1 / 0.3e1 * t6024 * t414;
  t6911 = my_piecewise3(t99, 0, t6824);
  t6920 = t1232 * t1232;
  t6933 = t1227 * t1227;
  t6966 = 0.85e2 / 0.4e1 * t1660 * t6920 * t134 - 0.19e2 / 0.8e1 * t3650 * t6920 * t134 + t317 * t6911 * t134 / 0.2e1 + t3658 * t6920 * t134 / 0.16e2 - 0.12e2 * t6933 * t135 - 0.16e2 * t2732 * t2894 - 0.4e1 * t321 * t6911 - t127 * t6911 * t134 - 0.75e2 / 0.2e1 * t731 * t6920 * t134 + 0.45e2 * t1233 * t2694 - 0.6e1 * t723 * t6933 * t134 - 0.8e1 * t1006 * t6172 - 0.15e2 * t2715 * t2694 + t6205 * t993 + 0.3e1 / 0.4e1 * t731 * t6933 * t134 + 0.3e1 / 0.4e1 * t5627 * t1232 * t134 - 0.3e1 * t132 * t6933 * t134 - 0.4e1 * t2735 * t6172;
  t7006 = 0.2e1 * t126 * t6966 + 0.2e1 * t6911 * t138 + 0.8e1 * t2894 * t444 + 0.12e2 * t1227 * t1260 + 0.8e1 * t432 * t2946 + 0.15e2 / 0.4e1 * t1695 * t6920 * t134 - t3712 * t6920 * t134 / 0.8e1 - t312 * t6911 - 0.24e2 * t1684 * t6920 * t134 + 0.21e2 * t1249 * t2694 - 0.3e1 / 0.2e1 * t710 * t6933 * t134 - 0.2e1 * t2221 * t6172 - 0.3e1 / 0.2e1 * t2685 * t2694 + 0.24e2 * t3625 * t6920 - 0.36e2 * t1664 * t1232 * t1227 + 0.6e1 * t715 * t6933 + 0.8e1 * t715 * t432 * t2894;
  t7010 = my_piecewise3(t98, t6868 + t6909, -0.8e1 / 0.3e1 * t6911 * t141 - 0.32e2 / 0.3e1 * t2894 * t447 - 0.16e2 * t1227 * t1263 - 0.32e2 / 0.3e1 * t432 * t2949 - 0.8e1 / 0.3e1 * t126 * t7006);
  t7015 = t1043 * t1043;
  t7020 = t1047 * t1047;
  t7025 = -t6815;
  t7029 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1403 * t7015 - 0.16e2 / 0.9e1 * t1070 * t1047 + 0.4e1 / 0.3e1 * t180 * t7020 + 0.16e2 / 0.9e1 * t348 * t2963 + 0.4e1 / 0.3e1 * t18 * t7025);
  t7045 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1611 * t6804 - 0.16e2 / 0.9e1 * t1184 * t1161 + 0.4e1 / 0.3e1 * t269 * t6809 + 0.16e2 / 0.9e1 * t406 * t2801 + 0.4e1 / 0.3e1 * t89 * t6815);
  t7074 = t1065 * t1065;
  t7083 = t1075 * t1075;
  t7103 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3259 * t7015 + 0.2e2 / 0.9e1 * t2398 * t1047 - 0.2e1 / 0.3e1 * t516 * t7020 - 0.8e1 / 0.9e1 * t797 * t2963 + t180 * t7025 / 0.3e1);
  t7108 = t3218 + 0.56e2 / 0.243e3 * t4004 + 0.8e1 / 0.27e2 * t4868 - 0.4e1 / 0.27e2 * t4876 + 0.4e1 / 0.9e1 * t6345 - 0.4e1 / 0.9e1 * t6355 + 0.2e1 / 0.27e2 * t6369 + 0.4e1 / 0.3e1 * t27 * t29 * t3238 * t7074 - 0.2e1 * t791 * t1882 * t1065 * t1075 + t27 * t29 * t509 * t7083 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t350 * t3016 - t27 * t29 * t178 * t7103 / 0.18e2;
  t7109 = my_piecewise3(t36, t7108, 0);
  t7126 = t1081 * t1081;
  t7129 = t1061 * t1061;
  t7152 = -t170 * t7109 / 0.18e2 + t193 * t7109 / 0.24e3 - t197 * t7109 / 0.448e4 + t201 * t7109 / 0.10368e6 - t205 * t7109 / 0.2838528e7 + t209 * t7109 / 0.8945664e8 - t213 * t7109 / 0.31850496e10 + t217 * t7109 / 0.1263403008e12 - t51 * t7126 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t7129 + t54 * t7126 / 0.86016e5 - t60 * t7129 / 0.32768e5 - t57 * t7126 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t7129 + t60 * t7126 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3202 * t7129 - t556 * t7126 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t7129 + t42 * t7126 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t7129;
  t7193 = -t45 * t7126 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t7129 + 0.3e1 / 0.64e3 * t48 * t7126 - 0.11e2 / 0.1152e4 * t54 * t7129 - t823 * t3022 / 0.288e4 - t2345 * t1081 / 0.3584e4 + t828 * t3022 / 0.64512e5 + t2353 * t1081 / 0.8192e5 - t833 * t3022 / 0.172032e7 - t2362 * t1081 / 0.221184e7 + t838 * t3022 / 0.5308416e8 + t2370 * t1081 / 0.688128e8 - t843 * t3022 / 0.18579456e10 + 0.2e1 / 0.3e1 * t6459 * t356 - t6462 * t356 / 0.12e2 + t6465 * t356 / 0.16e3 - 0.4e1 * t2313 * t1081 + 0.3e1 / 0.4e1 * t2321 * t1081 - 0.3e1 / 0.4e2 * t2329 * t1081 + t2337 * t1081 / 0.192e3;
  t7195 = my_piecewise3(t36, 0, t7108);
  t7206 = t1118 * t1118;
  t7216 = t1113 * t1113;
  t7252 = -0.19e2 / 0.8e1 * t3343 * t7206 * t72 + t228 * t7195 * t72 / 0.2e1 + t3326 * t7206 * t72 / 0.16e2 - 0.12e2 * t7216 * t73 - 0.16e2 * t2498 * t3056 - 0.4e1 * t232 * t7195 - t65 * t7195 * t72 + 0.85e2 / 0.4e1 * t1452 * t7206 * t72 - 0.75e2 / 0.2e1 * t590 * t7206 * t72 + 0.45e2 * t1119 * t2460 - 0.6e1 * t582 * t7216 * t72 - 0.8e1 * t867 * t6551 - 0.15e2 * t2481 * t2460 + t6598 * t854 + 0.3e1 / 0.4e1 * t590 * t7216 * t72 + 0.3e1 / 0.4e1 * t5166 * t1118 * t72 - 0.3e1 * t70 * t7216 * t72 - 0.4e1 * t2501 * t6551;
  t7290 = 0.8e1 * t374 * t3108 + 0.2e1 * t63 * t7252 + 0.2e1 * t7195 * t76 + 0.8e1 * t3056 * t386 + 0.12e2 * t1113 * t1146 - t223 * t7195 + 0.15e2 / 0.4e1 * t1487 * t7206 * t72 - t3318 * t7206 * t72 / 0.8e1 - 0.3e1 / 0.2e1 * t569 * t7216 * t72 - 0.2e1 * t1974 * t6551 - 0.3e1 / 0.2e1 * t2451 * t2460 + 0.24e2 * t3398 * t7206 - 0.36e2 * t1456 * t1118 * t1113 + 0.6e1 * t574 * t7216 + 0.8e1 * t574 * t374 * t3056 - 0.24e2 * t1476 * t7206 * t72 + 0.21e2 * t1135 * t2460;
  t7294 = my_piecewise3(t35, t7152 + t7193, -0.8e1 / 0.3e1 * t7195 * t79 - 0.32e2 / 0.3e1 * t3056 * t389 - 0.16e2 * t1113 * t1149 - 0.32e2 / 0.3e1 * t374 * t3111 - 0.8e1 / 0.3e1 * t63 * t7290);
  t7304 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t7010 - 0.3e1 / 0.32e2 * t7 * t9 * t7029 * t84 - 0.3e1 / 0.32e2 * t7 * t9 * t7045 * t146 - 0.3e1 / 0.8e1 * t7 * t2806 * t452 - 0.9e1 / 0.16e2 * t7 * t1166 * t1268 - 0.3e1 / 0.8e1 * t7 * t402 * t2954 - 0.3e1 / 0.8e1 * t7 * t2968 * t394 - 0.9e1 / 0.16e2 * t7 * t1052 * t1154 - 0.3e1 / 0.8e1 * t7 * t344 * t3116 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t7294 - t6294 / 0.8e1 - t6297 / 0.8e1 - 0.3e1 / 0.8e1 * t6300 - 0.3e1 / 0.8e1 * t6303 - t6306 / 0.8e1;
  t7318 = -0.3e1 / 0.8e1 * t6309 - 0.3e1 / 0.8e1 * t6312 - t6316 / 0.8e1 + t5246 / 0.4e1 + t5249 / 0.4e1 + t5253 / 0.8e1 + t5256 / 0.8e1 + t5260 / 0.8e1 + t5263 / 0.8e1 - 0.5e1 / 0.36e2 * t4719 - 0.5e1 / 0.36e2 * t4726 - 0.5e1 / 0.36e2 * t4732 - 0.5e1 / 0.36e2 * t4739 + t3795 + t3799;
  t7340 = -0.3e1 / 0.8e1 * t2956 - 0.3e1 / 0.8e1 * t2970 - 0.9e1 / 0.8e1 * t2973 - 0.9e1 / 0.8e1 * t2976 - 0.3e1 / 0.8e1 * t3118 + t1753 / 0.4e1 + t1759 / 0.4e1 + t1766 / 0.4e1 + t1773 / 0.4e1 - t3817 - t3821;
  tv4rho44 = t11 * (t7304 + t7318) - 0.3e1 / 0.8e1 * t2292 - 0.3e1 / 0.8e1 * t2295 - 0.3e1 / 0.4e1 * t2298 - 0.3e1 / 0.4e1 * t2301 - 0.3e1 / 0.8e1 * t2305 - 0.3e1 / 0.8e1 * t2308 - 0.3e1 / 0.8e1 * t2808 - 0.9e1 / 0.8e1 * t2811 - 0.9e1 / 0.8e1 * t2814 + t7340;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif

