/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_q1d.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t40, t42, t43;
  double t44, t45, t46, t47, t49, t52, t53, t54;
  double t55, t56, t57, t58, t59, t62, t63, t64;
  double t66, t67, t70, t72, t76, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = t25 * t33;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t38 = 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t18 / t47;
  t52 = t43 * t45 * t49 / 0.288e3;
  t53 = t34 / 0.24e2 + t52;
  t54 = t21 * t21;
  t55 = 0.1e1 / t54;
  t56 = t44 * sigma[0];
  t57 = t55 * t56;
  t58 = t46 * t46;
  t59 = 0.1e1 / t58;
  t62 = 0.1e1 + t52 + t57 * t59 / 0.576e3;
  t63 = 0.1e1 / t62;
  t64 = t53 * t63;
  t66 = (0.1804e1 - t38) * t20;
  t67 = t66 * t24;
  t70 = -t67 * t33 / 0.24e2 + 0.6525e-1;
  t72 = 0.1804e1 - t38 + t64 * t70;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t40, t42, t43;
  double t44, t45, t46, t47, t49, t52, t53, t54;
  double t55, t56, t57, t58, t59, t62, t63, t64;
  double t66, t67, t70, t72, t76, tzk0;

  double t78, t82, t83, t84, t85, t86, t88, t89;
  double t94, t96, t97, t99, t100, t101, t103, t104;
  double t105, t106, t107, t110, t111, t113, t114, t119;
  double t121, t126, tvrho0, t129, t130, t137, t139, t140;
  double t141, t143, t146, t147, t153, t155, t159, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = t25 * t33;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t38 = 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t18 / t47;
  t52 = t43 * t45 * t49 / 0.288e3;
  t53 = t34 / 0.24e2 + t52;
  t54 = t21 * t21;
  t55 = 0.1e1 / t54;
  t56 = t44 * sigma[0];
  t57 = t55 * t56;
  t58 = t46 * t46;
  t59 = 0.1e1 / t58;
  t62 = 0.1e1 + t52 + t57 * t59 / 0.576e3;
  t63 = 0.1e1 / t62;
  t64 = t53 * t63;
  t66 = (0.1804e1 - t38) * t20;
  t67 = t66 * t24;
  t70 = -t67 * t33 / 0.24e2 + 0.6525e-1;
  t72 = 0.1804e1 - t38 + t64 * t70;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t30;
  t82 = t36 * t36;
  t83 = 0.1e1 / t82;
  t84 = t83 * t20;
  t85 = t84 * t24;
  t86 = t29 * rho[0];
  t88 = 0.1e1 / t30 / t86;
  t89 = t28 * t88;
  t94 = t46 * t29;
  t96 = 0.1e1 / t18 / t94;
  t97 = t45 * t96;
  t99 = t43 * t97 / 0.54e2;
  t100 = -t25 * t89 / 0.9e1 - t99;
  t101 = t100 * t63;
  t103 = t62 * t62;
  t104 = 0.1e1 / t103;
  t105 = t53 * t104;
  t106 = t58 * rho[0];
  t107 = 0.1e1 / t106;
  t110 = -t99 - t57 * t107 / 0.72e2;
  t111 = t70 * t110;
  t113 = t83 * t40;
  t114 = t113 * t42;
  t119 = 0.7389300411522633745e-3 * t114 * t97 + t67 * t89 / 0.9e1;
  t121 = -0.88671604938271604938e-2 * t85 * t89 + t101 * t70 - t105 * t111 + t64 * t119;
  t126 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t121);
  tvrho0 = 0.2e1 * rho[0] * t126 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t129 = t24 * t27;
  t130 = t129 * t32;
  t137 = sigma[0] * t26 * t49;
  t139 = t43 * t137 / 0.144e3;
  t140 = t25 * t27 * t32 / 0.24e2 + t139;
  t141 = t140 * t63;
  t143 = t55 * t44;
  t146 = t139 + t143 * t59 / 0.192e3;
  t147 = t70 * t146;
  t153 = -0.27709876543209876543e-3 * t114 * t137 - t66 * t130 / 0.24e2;
  t155 = 0.33251851851851851852e-2 * t84 * t130 + t141 * t70 - t105 * t147 + t64 * t153;
  t159 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t155);
  tvsigma0 = 0.2e1 * rho[0] * t159;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t40, t42, t43;
  double t44, t45, t46, t47, t49, t52, t53, t54;
  double t55, t56, t57, t58, t59, t62, t63, t64;
  double t66, t67, t70, t72, t76, tzk0;

  double t78, t82, t83, t84, t85, t86, t88, t89;
  double t94, t96, t97, t99, t100, t101, t103, t104;
  double t105, t106, t107, t110, t111, t113, t114, t119;
  double t121, t126, tvrho0, t129, t130, t137, t139, t140;
  double t141, t143, t146, t147, t153, t155, t159, tvsigma0;

  double t164, t172, t173, t174, t175, t177, t178, t182;
  double t183, t189, t190, t191, t193, t199, t200, t201;
  double t202, t205, t208, t209, t212, t213, t215, t223;
  double t225, t230, tv2rho20, t236, t237, t240, t247, t248;
  double t249, t251, t255, t258, t262, t263, t266, t275;
  double t277, t282, tv2rhosigma0, t285, t286, t289, t290, t298;
  double t299, t302, t306, t308, t311, t312, t319, t321;
  double t325, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = t25 * t33;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t38 = 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t18 / t47;
  t52 = t43 * t45 * t49 / 0.288e3;
  t53 = t34 / 0.24e2 + t52;
  t54 = t21 * t21;
  t55 = 0.1e1 / t54;
  t56 = t44 * sigma[0];
  t57 = t55 * t56;
  t58 = t46 * t46;
  t59 = 0.1e1 / t58;
  t62 = 0.1e1 + t52 + t57 * t59 / 0.576e3;
  t63 = 0.1e1 / t62;
  t64 = t53 * t63;
  t66 = (0.1804e1 - t38) * t20;
  t67 = t66 * t24;
  t70 = -t67 * t33 / 0.24e2 + 0.6525e-1;
  t72 = 0.1804e1 - t38 + t64 * t70;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t30;
  t82 = t36 * t36;
  t83 = 0.1e1 / t82;
  t84 = t83 * t20;
  t85 = t84 * t24;
  t86 = t29 * rho[0];
  t88 = 0.1e1 / t30 / t86;
  t89 = t28 * t88;
  t94 = t46 * t29;
  t96 = 0.1e1 / t18 / t94;
  t97 = t45 * t96;
  t99 = t43 * t97 / 0.54e2;
  t100 = -t25 * t89 / 0.9e1 - t99;
  t101 = t100 * t63;
  t103 = t62 * t62;
  t104 = 0.1e1 / t103;
  t105 = t53 * t104;
  t106 = t58 * rho[0];
  t107 = 0.1e1 / t106;
  t110 = -t99 - t57 * t107 / 0.72e2;
  t111 = t70 * t110;
  t113 = t83 * t40;
  t114 = t113 * t42;
  t119 = 0.7389300411522633745e-3 * t114 * t97 + t67 * t89 / 0.9e1;
  t121 = -0.88671604938271604938e-2 * t85 * t89 + t101 * t70 - t105 * t111 + t64 * t119;
  t126 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t121);
  tvrho0 = 0.2e1 * rho[0] * t126 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t129 = t24 * t27;
  t130 = t129 * t32;
  t137 = sigma[0] * t26 * t49;
  t139 = t43 * t137 / 0.144e3;
  t140 = t25 * t27 * t32 / 0.24e2 + t139;
  t141 = t140 * t63;
  t143 = t55 * t44;
  t146 = t139 + t143 * t59 / 0.192e3;
  t147 = t70 * t146;
  t153 = -0.27709876543209876543e-3 * t114 * t137 - t66 * t130 / 0.24e2;
  t155 = 0.33251851851851851852e-2 * t84 * t130 + t141 * t70 - t105 * t147 + t64 * t153;
  t159 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t155);
  tvsigma0 = 0.2e1 * rho[0] * t159;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t164 = t17 / t30 / rho[0];
  t172 = 0.1e1 / t82 / t36;
  t173 = t172 * t40;
  t174 = t173 * t42;
  t175 = t46 * t86;
  t177 = 0.1e1 / t18 / t175;
  t178 = t45 * t177;
  t182 = 0.1e1 / t30 / t46;
  t183 = t28 * t182;
  t189 = 0.19e2 / 0.162e3 * t43 * t178;
  t190 = 0.11e2 / 0.27e2 * t25 * t183 + t189;
  t191 = t190 * t63;
  t193 = t100 * t104;
  t199 = 0.1e1 / t103 / t62;
  t200 = t53 * t199;
  t201 = t110 * t110;
  t202 = t70 * t201;
  t205 = t119 * t110;
  t208 = t58 * t29;
  t209 = 0.1e1 / t208;
  t212 = t189 + t57 * t209 / 0.8e1;
  t213 = t70 * t212;
  t215 = t172 * t55;
  t223 = 0.24326914935053938255e-3 * t215 * t56 * t209 - 0.66503703703703703705e-2 * t114 * t178 - 0.11e2 / 0.27e2 * t67 * t183;
  t225 = -0.48653829870107876509e-3 * t174 * t178 + 0.32512921810699588477e-1 * t85 * t183 + t191 * t70 - 0.2e1 * t193 * t111 + 0.2e1 * t101 * t119 + 0.2e1 * t200 * t202 - 0.2e1 * t105 * t205 - t105 * t213 + t64 * t223;
  t230 = my_piecewise3(t2, 0, t6 * t164 * t72 / 0.12e2 - t6 * t78 * t121 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t225);
  tv2rho20 = 0.2e1 * rho[0] * t230 + 0.4e1 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t236 = t26 * t96;
  t237 = t236 * sigma[0];
  t240 = t129 * t88;
  t247 = t43 * t237 / 0.27e2;
  t248 = -t25 * t27 * t88 / 0.9e1 - t247;
  t249 = t248 * t63;
  t251 = t140 * t104;
  t255 = t147 * t110;
  t258 = t119 * t146;
  t262 = -t247 - t143 * t107 / 0.24e2;
  t263 = t70 * t262;
  t266 = t153 * t110;
  t275 = -0.91225931006452268454e-4 * t215 * t107 * t44 + 0.22167901234567901235e-2 * t114 * t237 + t66 * t240 / 0.9e1;
  t277 = 0.18245186201290453691e-3 * t174 * t237 - 0.88671604938271604939e-2 * t84 * t240 + t249 * t70 - t251 * t111 + t141 * t119 - t193 * t147 + 0.2e1 * t200 * t255 - t105 * t258 - t105 * t263 + t101 * t153 - t105 * t266 + t64 * t275;
  t282 = my_piecewise3(t2, 0, -t6 * t78 * t155 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv2rhosigma0 = 0.2e1 * rho[0] * t282 + 0.2e1 * t159;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t285 = t42 * t26;
  t286 = t285 * t49;
  t289 = t43 * t26;
  t290 = t49 * t63;
  t298 = t146 * t146;
  t299 = t70 * t298;
  t302 = t153 * t146;
  t306 = t43 * t26 * t49;
  t308 = t55 * sigma[0];
  t311 = t306 / 0.144e3 + t308 * t59 / 0.96e2;
  t312 = t70 * t311;
  t319 = 0.3420972412741960067e-4 * t215 * t59 * sigma[0] - 0.55419753086419753086e-3 * t113 * t286;
  t321 = -0.68419448254839201342e-4 * t173 * t286 + t289 * t290 * t70 / 0.144e3 - 0.2e1 * t251 * t147 + 0.2e1 * t141 * t153 + 0.2e1 * t200 * t299 - 0.2e1 * t105 * t302 - t105 * t312 + t64 * t319;
  t325 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t321);
  tv2sigma20 = 0.2e1 * rho[0] * t325;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t40, t42, t43;
  double t44, t45, t46, t47, t49, t52, t53, t54;
  double t55, t56, t57, t58, t59, t62, t63, t64;
  double t66, t67, t70, t72, t76, tzk0;

  double t78, t82, t83, t84, t85, t86, t88, t89;
  double t94, t96, t97, t99, t100, t101, t103, t104;
  double t105, t106, t107, t110, t111, t113, t114, t119;
  double t121, t126, tvrho0, t129, t130, t137, t139, t140;
  double t141, t143, t146, t147, t153, t155, t159, tvsigma0;

  double t164, t172, t173, t174, t175, t177, t178, t182;
  double t183, t189, t190, t191, t193, t199, t200, t201;
  double t202, t205, t208, t209, t212, t213, t215, t223;
  double t225, t230, tv2rho20, t236, t237, t240, t247, t248;
  double t249, t251, t255, t258, t262, t263, t266, t275;
  double t277, t282, tv2rhosigma0, t285, t286, t289, t290, t298;
  double t299, t302, t306, t308, t311, t312, t319, t321;
  double t325, tv2sigma20;

  double t328, t338, t341, t342, t343, t344, t345, t348;
  double t352, t353, t357, t358, t361, t363, t364, t365;
  double t366, t369, t376, t379, t382, t386, t389, t390;
  double t394, t395, t401, t402, t403, t405, t416, t418;
  double t423, tv3rho30, t435, t438, t441, t444, t447, t450;
  double t451, t458, t459, t460, t468, t470, t471, t473;
  double t476, t483, t485, t487, t488, t493, t494, t498;
  double t501, t503, t506, t511, t522, t523, t528, tv3rho2sigma0;
  double t537, t543, t546, t549, t552, t555, t559, t560;
  double t562, t565, t570, t577, t579, t584, t585, t587;
  double t601, t606, t609, t613, t617, t618, t623, tv3rhosigma20;
  double t629, t630, t635, t636, t639, t649, t652, t655;
  double t663, t664, t666, t671, t673, t677, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = t25 * t33;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t38 = 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t18 / t47;
  t52 = t43 * t45 * t49 / 0.288e3;
  t53 = t34 / 0.24e2 + t52;
  t54 = t21 * t21;
  t55 = 0.1e1 / t54;
  t56 = t44 * sigma[0];
  t57 = t55 * t56;
  t58 = t46 * t46;
  t59 = 0.1e1 / t58;
  t62 = 0.1e1 + t52 + t57 * t59 / 0.576e3;
  t63 = 0.1e1 / t62;
  t64 = t53 * t63;
  t66 = (0.1804e1 - t38) * t20;
  t67 = t66 * t24;
  t70 = -t67 * t33 / 0.24e2 + 0.6525e-1;
  t72 = 0.1804e1 - t38 + t64 * t70;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t30;
  t82 = t36 * t36;
  t83 = 0.1e1 / t82;
  t84 = t83 * t20;
  t85 = t84 * t24;
  t86 = t29 * rho[0];
  t88 = 0.1e1 / t30 / t86;
  t89 = t28 * t88;
  t94 = t46 * t29;
  t96 = 0.1e1 / t18 / t94;
  t97 = t45 * t96;
  t99 = t43 * t97 / 0.54e2;
  t100 = -t25 * t89 / 0.9e1 - t99;
  t101 = t100 * t63;
  t103 = t62 * t62;
  t104 = 0.1e1 / t103;
  t105 = t53 * t104;
  t106 = t58 * rho[0];
  t107 = 0.1e1 / t106;
  t110 = -t99 - t57 * t107 / 0.72e2;
  t111 = t70 * t110;
  t113 = t83 * t40;
  t114 = t113 * t42;
  t119 = 0.7389300411522633745e-3 * t114 * t97 + t67 * t89 / 0.9e1;
  t121 = -0.88671604938271604938e-2 * t85 * t89 + t101 * t70 - t105 * t111 + t64 * t119;
  t126 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t121);
  tvrho0 = 0.2e1 * rho[0] * t126 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t129 = t24 * t27;
  t130 = t129 * t32;
  t137 = sigma[0] * t26 * t49;
  t139 = t43 * t137 / 0.144e3;
  t140 = t25 * t27 * t32 / 0.24e2 + t139;
  t141 = t140 * t63;
  t143 = t55 * t44;
  t146 = t139 + t143 * t59 / 0.192e3;
  t147 = t70 * t146;
  t153 = -0.27709876543209876543e-3 * t114 * t137 - t66 * t130 / 0.24e2;
  t155 = 0.33251851851851851852e-2 * t84 * t130 + t141 * t70 - t105 * t147 + t64 * t153;
  t159 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t155);
  tvsigma0 = 0.2e1 * rho[0] * t159;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t164 = t17 / t30 / rho[0];
  t172 = 0.1e1 / t82 / t36;
  t173 = t172 * t40;
  t174 = t173 * t42;
  t175 = t46 * t86;
  t177 = 0.1e1 / t18 / t175;
  t178 = t45 * t177;
  t182 = 0.1e1 / t30 / t46;
  t183 = t28 * t182;
  t189 = 0.19e2 / 0.162e3 * t43 * t178;
  t190 = 0.11e2 / 0.27e2 * t25 * t183 + t189;
  t191 = t190 * t63;
  t193 = t100 * t104;
  t199 = 0.1e1 / t103 / t62;
  t200 = t53 * t199;
  t201 = t110 * t110;
  t202 = t70 * t201;
  t205 = t119 * t110;
  t208 = t58 * t29;
  t209 = 0.1e1 / t208;
  t212 = t189 + t57 * t209 / 0.8e1;
  t213 = t70 * t212;
  t215 = t172 * t55;
  t223 = 0.24326914935053938255e-3 * t215 * t56 * t209 - 0.66503703703703703705e-2 * t114 * t178 - 0.11e2 / 0.27e2 * t67 * t183;
  t225 = -0.48653829870107876509e-3 * t174 * t178 + 0.32512921810699588477e-1 * t85 * t183 + t191 * t70 - 0.2e1 * t193 * t111 + 0.2e1 * t101 * t119 + 0.2e1 * t200 * t202 - 0.2e1 * t105 * t205 - t105 * t213 + t64 * t223;
  t230 = my_piecewise3(t2, 0, t6 * t164 * t72 / 0.12e2 - t6 * t78 * t121 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t225);
  tv2rho20 = 0.2e1 * rho[0] * t230 + 0.4e1 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t236 = t26 * t96;
  t237 = t236 * sigma[0];
  t240 = t129 * t88;
  t247 = t43 * t237 / 0.27e2;
  t248 = -t25 * t27 * t88 / 0.9e1 - t247;
  t249 = t248 * t63;
  t251 = t140 * t104;
  t255 = t147 * t110;
  t258 = t119 * t146;
  t262 = -t247 - t143 * t107 / 0.24e2;
  t263 = t70 * t262;
  t266 = t153 * t110;
  t275 = -0.91225931006452268454e-4 * t215 * t107 * t44 + 0.22167901234567901235e-2 * t114 * t237 + t66 * t240 / 0.9e1;
  t277 = 0.18245186201290453691e-3 * t174 * t237 - 0.88671604938271604939e-2 * t84 * t240 + t249 * t70 - t251 * t111 + t141 * t119 - t193 * t147 + 0.2e1 * t200 * t255 - t105 * t258 - t105 * t263 + t101 * t153 - t105 * t266 + t64 * t275;
  t282 = my_piecewise3(t2, 0, -t6 * t78 * t155 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv2rhosigma0 = 0.2e1 * rho[0] * t282 + 0.2e1 * t159;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t285 = t42 * t26;
  t286 = t285 * t49;
  t289 = t43 * t26;
  t290 = t49 * t63;
  t298 = t146 * t146;
  t299 = t70 * t298;
  t302 = t153 * t146;
  t306 = t43 * t26 * t49;
  t308 = t55 * sigma[0];
  t311 = t306 / 0.144e3 + t308 * t59 / 0.96e2;
  t312 = t70 * t311;
  t319 = 0.3420972412741960067e-4 * t215 * t59 * sigma[0] - 0.55419753086419753086e-3 * t113 * t286;
  t321 = -0.68419448254839201342e-4 * t173 * t286 + t289 * t290 * t70 / 0.144e3 - 0.2e1 * t251 * t147 + 0.2e1 * t141 * t153 + 0.2e1 * t200 * t299 - 0.2e1 * t105 * t302 - t105 * t312 + t64 * t319;
  t325 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t321);
  tv2sigma20 = 0.2e1 * rho[0] * t325;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t328 = t17 * t32;
  t338 = t100 * t199;
  t341 = t103 * t103;
  t342 = 0.1e1 / t341;
  t343 = t53 * t342;
  t344 = t201 * t110;
  t345 = t70 * t344;
  t348 = t111 * t212;
  t352 = 0.1e1 / t18 / t58;
  t353 = t45 * t352;
  t357 = 0.1e1 / t30 / t47;
  t358 = t28 * t357;
  t361 = t82 * t82;
  t363 = 0.1e1 / t361 * t55;
  t364 = t58 * t86;
  t365 = 0.1e1 / t364;
  t366 = t56 * t365;
  t369 = t190 * t104;
  t376 = t119 * t201;
  t379 = t223 * t110;
  t382 = t119 * t212;
  t386 = 0.209e3 / 0.243e3 * t43 * t353;
  t389 = -t386 - 0.5e1 / 0.4e1 * t57 * t365;
  t390 = t70 * t389;
  t394 = -0.154e3 / 0.81e2 * t25 * t358 - t386;
  t395 = t394 * t63;
  t401 = t44 * t44;
  t402 = t363 * t401;
  t403 = t58 * t47;
  t405 = 0.1e1 / t30 / t403;
  t416 = 0.10011076104960468418e-4 * t402 * t405 * t20 * t129 - 0.46221138376602482685e-2 * t215 * t366 + 0.55994476451760402379e-1 * t114 * t353 + 0.154e3 / 0.81e2 * t67 * t358;
  t418 = 0.6e1 * t338 * t202 - 0.6e1 * t343 * t345 + 0.6e1 * t200 * t348 + 0.5351921285711866416e-2 * t174 * t353 - 0.15172696844993141289e0 * t85 * t358 - 0.24026582651905124202e-3 * t363 * t366 - 0.3e1 * t369 * t111 - 0.6e1 * t193 * t205 - 0.3e1 * t193 * t213 + 0.6e1 * t200 * t376 - 0.3e1 * t105 * t379 - 0.3e1 * t105 * t382 - t105 * t390 + t395 * t70 + 0.3e1 * t191 * t119 + 0.3e1 * t101 * t223 + t64 * t416;
  t423 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t328 * t72 + t6 * t164 * t121 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t225 - 0.3e1 / 0.8e1 * t6 * t19 * t418);
  tv3rho30 = 0.2e1 * rho[0] * t423 + 0.6e1 * t230;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t435 = t258 * t110;
  t438 = t263 * t110;
  t441 = t147 * t212;
  t444 = t129 * t182;
  t447 = t147 * t201;
  t450 = t26 * t177;
  t451 = t450 * sigma[0];
  t458 = 0.19e2 / 0.81e2 * t43 * t451;
  t459 = 0.11e2 / 0.27e2 * t25 * t27 * t182 + t458;
  t460 = t459 * t63;
  t468 = t58 * t46;
  t470 = 0.1e1 / t30 / t468;
  t471 = t363 * t470;
  t473 = t56 * t20 * t129;
  t476 = t209 * t44;
  t483 = -0.37541535393601756565e-5 * t471 * t473 + 0.15508408271096885638e-2 * t215 * t476 - 0.16010150891632373114e-1 * t114 * t451 - 0.11e2 / 0.27e2 * t66 * t444;
  t485 = t223 * t146;
  t487 = 0.4e1 * t338 * t255 + 0.4e1 * t200 * t435 + 0.4e1 * t200 * t438 + 0.2e1 * t200 * t441 + 0.32512921810699588478e-1 * t84 * t444 - 0.6e1 * t343 * t447 - 0.16420667581161408322e-2 * t174 * t451 + t460 * t70 + 0.2e1 * t249 * t119 + t141 * t223 + t191 * t153 + 0.2e1 * t101 * t275 + t64 * t483 - t105 * t485;
  t488 = t119 * t262;
  t493 = t458 + 0.3e1 / 0.8e1 * t143 * t209;
  t494 = t70 * t493;
  t498 = t275 * t110;
  t501 = t153 * t212;
  t503 = t153 * t201;
  t506 = t140 * t199;
  t511 = t248 * t104;
  t522 = -0.2e1 * t105 * t488 - t105 * t494 - 0.2e1 * t193 * t266 - 0.2e1 * t105 * t498 - t105 * t501 + 0.2e1 * t200 * t503 + 0.2e1 * t506 * t202 + 0.90099684944644215758e-4 * t363 * t476 - 0.2e1 * t511 * t111 - 0.2e1 * t251 * t205 - t251 * t213 - t369 * t147 - 0.2e1 * t193 * t258 - 0.2e1 * t193 * t263;
  t523 = t487 + t522;
  t528 = my_piecewise3(t2, 0, t6 * t164 * t155 / 0.12e2 - t6 * t78 * t277 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t523);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t528 + 0.4e1 * t282;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t537 = t96 * t63;
  t543 = t299 * t110;
  t546 = t147 * t262;
  t549 = t302 * t110;
  t552 = t312 * t110;
  t555 = t285 * t96;
  t559 = 0.1e1 / t30 / t364;
  t560 = t363 * t559;
  t562 = t44 * t20 * t129;
  t565 = t107 * sigma[0];
  t570 = 0.14078075772600658712e-5 * t560 * t562 - 0.45612965503226134227e-3 * t215 * t565 + 0.29557201646090534979e-2 * t113 * t555;
  t577 = t119 * t311;
  t579 = t289 * t290 * t119 / 0.144e3 - t289 * t537 * t70 / 0.27e2 + 0.4e1 * t506 * t255 - 0.6e1 * t343 * t543 + 0.4e1 * t200 * t546 + 0.4e1 * t200 * t549 + 0.2e1 * t200 * t552 + 0.36490372402580907382e-3 * t173 * t555 + t64 * t570 + 0.2e1 * t249 * t153 + 0.2e1 * t141 * t275 + t101 * t319 - t105 * t577;
  t584 = -t43 * t236 / 0.27e2 - t308 * t107 / 0.12e2;
  t585 = t70 * t584;
  t587 = t319 * t110;
  t601 = t119 * t298;
  t606 = t275 * t146;
  t609 = t153 * t262;
  t613 = t49 * t104;
  t617 = -t105 * t585 - t105 * t587 - 0.3378738185424158091e-4 * t363 * t565 - 0.2e1 * t511 * t147 - 0.2e1 * t251 * t258 - 0.2e1 * t251 * t263 - 0.2e1 * t251 * t266 + 0.2e1 * t338 * t299 + 0.2e1 * t200 * t601 - 0.2e1 * t193 * t302 - 0.2e1 * t105 * t606 - 0.2e1 * t105 * t609 - t193 * t312 - t289 * t613 * t111 / 0.144e3;
  t618 = t579 + t617;
  t623 = my_piecewise3(t2, 0, -t6 * t78 * t321 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t618);
  tv3rhosigma20 = 0.2e1 * rho[0] * t623 + 0.2e1 * t325;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t629 = t70 * t55;
  t630 = t629 * t59;
  t635 = t298 * t146;
  t636 = t70 * t635;
  t639 = t147 * t311;
  t649 = t153 * t298;
  t652 = t319 * t146;
  t655 = t153 * t311;
  t663 = 0.1e1 / t30 / t208;
  t664 = t363 * t663;
  t666 = sigma[0] * t20 * t129;
  t671 = -0.5279278414725247017e-6 * t664 * t666 + 0.10262917238225880201e-3 * t215 * t59;
  t673 = t289 * t290 * t153 / 0.48e2 - t105 * t630 / 0.96e2 + 0.6e1 * t506 * t299 - 0.6e1 * t343 * t636 + 0.6e1 * t200 * t639 - t289 * t613 * t147 / 0.48e2 - 0.6e1 * t251 * t302 - 0.3e1 * t251 * t312 + 0.6e1 * t200 * t649 - 0.3e1 * t105 * t652 - 0.3e1 * t105 * t655 + 0.12670268195340592841e-4 * t363 * t59 + 0.3e1 * t141 * t319 + t64 * t671;
  t677 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t673);
  tv3sigma30 = 0.2e1 * rho[0] * t677;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t40, t42, t43;
  double t44, t45, t46, t47, t49, t52, t53, t54;
  double t55, t56, t57, t58, t59, t62, t63, t64;
  double t66, t67, t70, t72, t76, tzk0;

  double t78, t82, t83, t84, t85, t86, t88, t89;
  double t94, t96, t97, t99, t100, t101, t103, t104;
  double t105, t106, t107, t110, t111, t113, t114, t119;
  double t121, t126, tvrho0, t129, t130, t137, t139, t140;
  double t141, t143, t146, t147, t153, t155, t159, tvsigma0;

  double t164, t172, t173, t174, t175, t177, t178, t182;
  double t183, t189, t190, t191, t193, t199, t200, t201;
  double t202, t205, t208, t209, t212, t213, t215, t223;
  double t225, t230, tv2rho20, t236, t237, t240, t247, t248;
  double t249, t251, t255, t258, t262, t263, t266, t275;
  double t277, t282, tv2rhosigma0, t285, t286, t289, t290, t298;
  double t299, t302, t306, t308, t311, t312, t319, t321;
  double t325, tv2sigma20;

  double t328, t338, t341, t342, t343, t344, t345, t348;
  double t352, t353, t357, t358, t361, t363, t364, t365;
  double t366, t369, t376, t379, t382, t386, t389, t390;
  double t394, t395, t401, t402, t403, t405, t416, t418;
  double t423, tv3rho30, t435, t438, t441, t444, t447, t450;
  double t451, t458, t459, t460, t468, t470, t471, t473;
  double t476, t483, t485, t487, t488, t493, t494, t498;
  double t501, t503, t506, t511, t522, t523, t528, tv3rho2sigma0;
  double t537, t543, t546, t549, t552, t555, t559, t560;
  double t562, t565, t570, t577, t579, t584, t585, t587;
  double t601, t606, t609, t613, t617, t618, t623, tv3rhosigma20;
  double t629, t630, t635, t636, t639, t649, t652, t655;
  double t663, t664, t666, t671, t673, t677, tv3sigma30;

  double t695, t700, t709, t714, t715, t719, t738, t739;
  double t745, t748, t754, t757, t764, t766, t770, t797;
  double t815, t821, tv4rho40, t861, t867, t868, t872, t874;
  double t906, t913, t918, t921, t933, t940, t946, t1000;
  double t1007, tv4rho3sigma0, t1061, t1081, t1084, t1119, t1164, t1186;
  double t1195, t1208, t1212, t1219, tv4rho2sigma20, t1235, t1236, t1266;
  double t1307, t1340, t1375, t1382, tv4rhosigma30, t1386, t1423, t1440;
  double t1450, t1460, t1465, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = t25 * t33;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t38 = 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t18 / t47;
  t52 = t43 * t45 * t49 / 0.288e3;
  t53 = t34 / 0.24e2 + t52;
  t54 = t21 * t21;
  t55 = 0.1e1 / t54;
  t56 = t44 * sigma[0];
  t57 = t55 * t56;
  t58 = t46 * t46;
  t59 = 0.1e1 / t58;
  t62 = 0.1e1 + t52 + t57 * t59 / 0.576e3;
  t63 = 0.1e1 / t62;
  t64 = t53 * t63;
  t66 = (0.1804e1 - t38) * t20;
  t67 = t66 * t24;
  t70 = -t67 * t33 / 0.24e2 + 0.6525e-1;
  t72 = 0.1804e1 - t38 + t64 * t70;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t30;
  t82 = t36 * t36;
  t83 = 0.1e1 / t82;
  t84 = t83 * t20;
  t85 = t84 * t24;
  t86 = t29 * rho[0];
  t88 = 0.1e1 / t30 / t86;
  t89 = t28 * t88;
  t94 = t46 * t29;
  t96 = 0.1e1 / t18 / t94;
  t97 = t45 * t96;
  t99 = t43 * t97 / 0.54e2;
  t100 = -t25 * t89 / 0.9e1 - t99;
  t101 = t100 * t63;
  t103 = t62 * t62;
  t104 = 0.1e1 / t103;
  t105 = t53 * t104;
  t106 = t58 * rho[0];
  t107 = 0.1e1 / t106;
  t110 = -t99 - t57 * t107 / 0.72e2;
  t111 = t70 * t110;
  t113 = t83 * t40;
  t114 = t113 * t42;
  t119 = 0.7389300411522633745e-3 * t114 * t97 + t67 * t89 / 0.9e1;
  t121 = -0.88671604938271604938e-2 * t85 * t89 + t101 * t70 - t105 * t111 + t64 * t119;
  t126 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t121);
  tvrho0 = 0.2e1 * rho[0] * t126 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t129 = t24 * t27;
  t130 = t129 * t32;
  t137 = sigma[0] * t26 * t49;
  t139 = t43 * t137 / 0.144e3;
  t140 = t25 * t27 * t32 / 0.24e2 + t139;
  t141 = t140 * t63;
  t143 = t55 * t44;
  t146 = t139 + t143 * t59 / 0.192e3;
  t147 = t70 * t146;
  t153 = -0.27709876543209876543e-3 * t114 * t137 - t66 * t130 / 0.24e2;
  t155 = 0.33251851851851851852e-2 * t84 * t130 + t141 * t70 - t105 * t147 + t64 * t153;
  t159 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t155);
  tvsigma0 = 0.2e1 * rho[0] * t159;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t164 = t17 / t30 / rho[0];
  t172 = 0.1e1 / t82 / t36;
  t173 = t172 * t40;
  t174 = t173 * t42;
  t175 = t46 * t86;
  t177 = 0.1e1 / t18 / t175;
  t178 = t45 * t177;
  t182 = 0.1e1 / t30 / t46;
  t183 = t28 * t182;
  t189 = 0.19e2 / 0.162e3 * t43 * t178;
  t190 = 0.11e2 / 0.27e2 * t25 * t183 + t189;
  t191 = t190 * t63;
  t193 = t100 * t104;
  t199 = 0.1e1 / t103 / t62;
  t200 = t53 * t199;
  t201 = t110 * t110;
  t202 = t70 * t201;
  t205 = t119 * t110;
  t208 = t58 * t29;
  t209 = 0.1e1 / t208;
  t212 = t189 + t57 * t209 / 0.8e1;
  t213 = t70 * t212;
  t215 = t172 * t55;
  t223 = 0.24326914935053938255e-3 * t215 * t56 * t209 - 0.66503703703703703705e-2 * t114 * t178 - 0.11e2 / 0.27e2 * t67 * t183;
  t225 = -0.48653829870107876509e-3 * t174 * t178 + 0.32512921810699588477e-1 * t85 * t183 + t191 * t70 - 0.2e1 * t193 * t111 + 0.2e1 * t101 * t119 + 0.2e1 * t200 * t202 - 0.2e1 * t105 * t205 - t105 * t213 + t64 * t223;
  t230 = my_piecewise3(t2, 0, t6 * t164 * t72 / 0.12e2 - t6 * t78 * t121 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t225);
  tv2rho20 = 0.2e1 * rho[0] * t230 + 0.4e1 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t236 = t26 * t96;
  t237 = t236 * sigma[0];
  t240 = t129 * t88;
  t247 = t43 * t237 / 0.27e2;
  t248 = -t25 * t27 * t88 / 0.9e1 - t247;
  t249 = t248 * t63;
  t251 = t140 * t104;
  t255 = t147 * t110;
  t258 = t119 * t146;
  t262 = -t247 - t143 * t107 / 0.24e2;
  t263 = t70 * t262;
  t266 = t153 * t110;
  t275 = -0.91225931006452268454e-4 * t215 * t107 * t44 + 0.22167901234567901235e-2 * t114 * t237 + t66 * t240 / 0.9e1;
  t277 = 0.18245186201290453691e-3 * t174 * t237 - 0.88671604938271604939e-2 * t84 * t240 + t249 * t70 - t251 * t111 + t141 * t119 - t193 * t147 + 0.2e1 * t200 * t255 - t105 * t258 - t105 * t263 + t101 * t153 - t105 * t266 + t64 * t275;
  t282 = my_piecewise3(t2, 0, -t6 * t78 * t155 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv2rhosigma0 = 0.2e1 * rho[0] * t282 + 0.2e1 * t159;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t285 = t42 * t26;
  t286 = t285 * t49;
  t289 = t43 * t26;
  t290 = t49 * t63;
  t298 = t146 * t146;
  t299 = t70 * t298;
  t302 = t153 * t146;
  t306 = t43 * t26 * t49;
  t308 = t55 * sigma[0];
  t311 = t306 / 0.144e3 + t308 * t59 / 0.96e2;
  t312 = t70 * t311;
  t319 = 0.3420972412741960067e-4 * t215 * t59 * sigma[0] - 0.55419753086419753086e-3 * t113 * t286;
  t321 = -0.68419448254839201342e-4 * t173 * t286 + t289 * t290 * t70 / 0.144e3 - 0.2e1 * t251 * t147 + 0.2e1 * t141 * t153 + 0.2e1 * t200 * t299 - 0.2e1 * t105 * t302 - t105 * t312 + t64 * t319;
  t325 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t321);
  tv2sigma20 = 0.2e1 * rho[0] * t325;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t328 = t17 * t32;
  t338 = t100 * t199;
  t341 = t103 * t103;
  t342 = 0.1e1 / t341;
  t343 = t53 * t342;
  t344 = t201 * t110;
  t345 = t70 * t344;
  t348 = t111 * t212;
  t352 = 0.1e1 / t18 / t58;
  t353 = t45 * t352;
  t357 = 0.1e1 / t30 / t47;
  t358 = t28 * t357;
  t361 = t82 * t82;
  t363 = 0.1e1 / t361 * t55;
  t364 = t58 * t86;
  t365 = 0.1e1 / t364;
  t366 = t56 * t365;
  t369 = t190 * t104;
  t376 = t119 * t201;
  t379 = t223 * t110;
  t382 = t119 * t212;
  t386 = 0.209e3 / 0.243e3 * t43 * t353;
  t389 = -t386 - 0.5e1 / 0.4e1 * t57 * t365;
  t390 = t70 * t389;
  t394 = -0.154e3 / 0.81e2 * t25 * t358 - t386;
  t395 = t394 * t63;
  t401 = t44 * t44;
  t402 = t363 * t401;
  t403 = t58 * t47;
  t405 = 0.1e1 / t30 / t403;
  t416 = 0.10011076104960468418e-4 * t402 * t405 * t20 * t129 - 0.46221138376602482685e-2 * t215 * t366 + 0.55994476451760402379e-1 * t114 * t353 + 0.154e3 / 0.81e2 * t67 * t358;
  t418 = 0.6e1 * t338 * t202 - 0.6e1 * t343 * t345 + 0.6e1 * t200 * t348 + 0.5351921285711866416e-2 * t174 * t353 - 0.15172696844993141289e0 * t85 * t358 - 0.24026582651905124202e-3 * t363 * t366 - 0.3e1 * t369 * t111 - 0.6e1 * t193 * t205 - 0.3e1 * t193 * t213 + 0.6e1 * t200 * t376 - 0.3e1 * t105 * t379 - 0.3e1 * t105 * t382 - t105 * t390 + t395 * t70 + 0.3e1 * t191 * t119 + 0.3e1 * t101 * t223 + t64 * t416;
  t423 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t328 * t72 + t6 * t164 * t121 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t225 - 0.3e1 / 0.8e1 * t6 * t19 * t418);
  tv3rho30 = 0.2e1 * rho[0] * t423 + 0.6e1 * t230;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t435 = t258 * t110;
  t438 = t263 * t110;
  t441 = t147 * t212;
  t444 = t129 * t182;
  t447 = t147 * t201;
  t450 = t26 * t177;
  t451 = t450 * sigma[0];
  t458 = 0.19e2 / 0.81e2 * t43 * t451;
  t459 = 0.11e2 / 0.27e2 * t25 * t27 * t182 + t458;
  t460 = t459 * t63;
  t468 = t58 * t46;
  t470 = 0.1e1 / t30 / t468;
  t471 = t363 * t470;
  t473 = t56 * t20 * t129;
  t476 = t209 * t44;
  t483 = -0.37541535393601756565e-5 * t471 * t473 + 0.15508408271096885638e-2 * t215 * t476 - 0.16010150891632373114e-1 * t114 * t451 - 0.11e2 / 0.27e2 * t66 * t444;
  t485 = t223 * t146;
  t487 = 0.4e1 * t338 * t255 + 0.4e1 * t200 * t435 + 0.4e1 * t200 * t438 + 0.2e1 * t200 * t441 + 0.32512921810699588478e-1 * t84 * t444 - 0.6e1 * t343 * t447 - 0.16420667581161408322e-2 * t174 * t451 + t460 * t70 + 0.2e1 * t249 * t119 + t141 * t223 + t191 * t153 + 0.2e1 * t101 * t275 + t64 * t483 - t105 * t485;
  t488 = t119 * t262;
  t493 = t458 + 0.3e1 / 0.8e1 * t143 * t209;
  t494 = t70 * t493;
  t498 = t275 * t110;
  t501 = t153 * t212;
  t503 = t153 * t201;
  t506 = t140 * t199;
  t511 = t248 * t104;
  t522 = -0.2e1 * t105 * t488 - t105 * t494 - 0.2e1 * t193 * t266 - 0.2e1 * t105 * t498 - t105 * t501 + 0.2e1 * t200 * t503 + 0.2e1 * t506 * t202 + 0.90099684944644215758e-4 * t363 * t476 - 0.2e1 * t511 * t111 - 0.2e1 * t251 * t205 - t251 * t213 - t369 * t147 - 0.2e1 * t193 * t258 - 0.2e1 * t193 * t263;
  t523 = t487 + t522;
  t528 = my_piecewise3(t2, 0, t6 * t164 * t155 / 0.12e2 - t6 * t78 * t277 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t523);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t528 + 0.4e1 * t282;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t537 = t96 * t63;
  t543 = t299 * t110;
  t546 = t147 * t262;
  t549 = t302 * t110;
  t552 = t312 * t110;
  t555 = t285 * t96;
  t559 = 0.1e1 / t30 / t364;
  t560 = t363 * t559;
  t562 = t44 * t20 * t129;
  t565 = t107 * sigma[0];
  t570 = 0.14078075772600658712e-5 * t560 * t562 - 0.45612965503226134227e-3 * t215 * t565 + 0.29557201646090534979e-2 * t113 * t555;
  t577 = t119 * t311;
  t579 = t289 * t290 * t119 / 0.144e3 - t289 * t537 * t70 / 0.27e2 + 0.4e1 * t506 * t255 - 0.6e1 * t343 * t543 + 0.4e1 * t200 * t546 + 0.4e1 * t200 * t549 + 0.2e1 * t200 * t552 + 0.36490372402580907382e-3 * t173 * t555 + t64 * t570 + 0.2e1 * t249 * t153 + 0.2e1 * t141 * t275 + t101 * t319 - t105 * t577;
  t584 = -t43 * t236 / 0.27e2 - t308 * t107 / 0.12e2;
  t585 = t70 * t584;
  t587 = t319 * t110;
  t601 = t119 * t298;
  t606 = t275 * t146;
  t609 = t153 * t262;
  t613 = t49 * t104;
  t617 = -t105 * t585 - t105 * t587 - 0.3378738185424158091e-4 * t363 * t565 - 0.2e1 * t511 * t147 - 0.2e1 * t251 * t258 - 0.2e1 * t251 * t263 - 0.2e1 * t251 * t266 + 0.2e1 * t338 * t299 + 0.2e1 * t200 * t601 - 0.2e1 * t193 * t302 - 0.2e1 * t105 * t606 - 0.2e1 * t105 * t609 - t193 * t312 - t289 * t613 * t111 / 0.144e3;
  t618 = t579 + t617;
  t623 = my_piecewise3(t2, 0, -t6 * t78 * t321 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t618);
  tv3rhosigma20 = 0.2e1 * rho[0] * t623 + 0.2e1 * t325;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t629 = t70 * t55;
  t630 = t629 * t59;
  t635 = t298 * t146;
  t636 = t70 * t635;
  t639 = t147 * t311;
  t649 = t153 * t298;
  t652 = t319 * t146;
  t655 = t153 * t311;
  t663 = 0.1e1 / t30 / t208;
  t664 = t363 * t663;
  t666 = sigma[0] * t20 * t129;
  t671 = -0.5279278414725247017e-6 * t664 * t666 + 0.10262917238225880201e-3 * t215 * t59;
  t673 = t289 * t290 * t153 / 0.48e2 - t105 * t630 / 0.96e2 + 0.6e1 * t506 * t299 - 0.6e1 * t343 * t636 + 0.6e1 * t200 * t639 - t289 * t613 * t147 / 0.48e2 - 0.6e1 * t251 * t302 - 0.3e1 * t251 * t312 + 0.6e1 * t200 * t649 - 0.3e1 * t105 * t652 - 0.3e1 * t105 * t655 + 0.12670268195340592841e-4 * t363 * t59 + 0.3e1 * t141 * t319 + t64 * t671;
  t677 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t673);
  tv3sigma30 = 0.2e1 * rho[0] * t677;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t695 = t45 / t18 / t106;
  t700 = t28 / t30 / t94;
  t709 = t100 * t342;
  t714 = t53 / t341 / t62;
  t715 = t201 * t201;
  t719 = t212 * t212;
  t738 = 0.5225e4 / 0.729e3 * t43 * t695;
  t739 = 0.1e1 / t468;
  t745 = t190 * t199;
  t748 = -0.52924554936484012336e-1 * t174 * t695 + 0.85978615454961133971e0 * t85 * t700 - 0.6e1 * t369 * t213 - 0.12e2 * t193 * t379 - 0.12e2 * t193 * t382 - 0.24e2 * t709 * t345 + 0.24e2 * t714 * t70 * t715 + 0.6e1 * t200 * t70 * t719 - 0.4e1 * t193 * t390 + 0.12e2 * t200 * t223 * t201 - 0.4e1 * t105 * t416 * t110 - 0.6e1 * t105 * t223 * t212 - 0.4e1 * t105 * t119 * t389 - t105 * t70 * (t738 + 0.55e2 / 0.4e1 * t57 * t739) + 0.12e2 * t745 * t202;
  t754 = t56 * t739;
  t757 = t394 * t104;
  t764 = 0.1e1 / t361 / t36 * t55;
  t766 = t58 * t94;
  t770 = 0.1e1 / t30 / t766 * t20 * t129;
  t797 = t58 * t58;
  t815 = 0.24e2 * t338 * t376 - 0.24e2 * t343 * t119 * t344 + 0.52858481834191273244e-2 * t363 * t754 - 0.4e1 * t757 * t111 - 0.12e2 * t369 * t205 - 0.13183310097067283513e-4 * t764 * t401 * t770 - 0.36e2 * t343 * t202 * t212 + 0.24e2 * t200 * t205 * t212 + 0.8e1 * t200 * t111 * t389 + 0.24e2 * t338 * t348 + (0.2618e4 / 0.243e3 * t25 * t700 + t738) * t63 * t70 + 0.4e1 * t395 * t119 + 0.6e1 * t191 * t223 + 0.4e1 * t101 * t416 + t64 * (0.10986091747556069595e-5 * t764 * t401 * sigma[0] / t18 / t797 / rho[0] * t40 * t285 - 0.32702848609537530165e-3 * t402 * t770 + 0.69277647753936937499e-1 * t215 * t754 - 0.50033774119798811158e0 * t114 * t695 - 0.2618e4 / 0.243e3 * t67 * t700);
  t821 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t88 * t72 - 0.5e1 / 0.9e1 * t6 * t328 * t121 + t6 * t164 * t225 / 0.2e1 - t6 * t78 * t418 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t748 + t815));
  tv4rho40 = 0.2e1 * rho[0] * t821 + 0.8e1 * t423;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t861 = t129 * t357;
  t867 = t343 * t70;
  t868 = t146 * t110;
  t872 = 0.6e1 * t200 * t485 * t110 + 0.6e1 * t200 * t266 * t212 + 0.6e1 * t745 * t255 + 0.12e2 * t338 * t435 + 0.12e2 * t338 * t438 + 0.6e1 * t338 * t441 - 0.18e2 * t709 * t447 - 0.18e2 * t343 * t258 * t201 - 0.18e2 * t343 * t263 * t201 + 0.2e1 * t200 * t147 * t389 + 0.6e1 * t506 * t348 - 0.1517269684499314129e0 * t84 * t861 + 0.24e2 * t714 * t147 * t344 - 0.18e2 * t867 * t868 * t212;
  t874 = t26 * t352 * sigma[0];
  t906 = 0.13825796654755654908e-1 * t174 * t874 - t757 * t147 - 0.3e1 * t369 * t258 - 0.3e1 * t369 * t263 - 0.3e1 * t193 * t485 - 0.6e1 * t193 * t488 - 0.3e1 * t193 * t494 - t105 * t416 * t146 - 0.3e1 * t105 * t223 * t262 - 0.6e1 * t343 * t153 * t344 - 0.3e1 * t193 * t501 - 0.3e1 * t105 * t483 * t110 - 0.3e1 * t105 * t275 * t212 - t105 * t153 * t389;
  t913 = t248 * t199;
  t918 = t365 * t44;
  t921 = t459 * t104;
  t933 = t140 * t342;
  t940 = 0.418e3 / 0.243e3 * t43 * t874;
  t946 = 0.6e1 * t338 * t503 + 0.6e1 * t200 * t275 * t201 + 0.6e1 * t913 * t202 + 0.6e1 * t506 * t376 - 0.17118940139482400994e-2 * t363 * t918 - 0.3e1 * t921 * t111 - 0.6e1 * t511 * t205 - 0.3e1 * t511 * t213 - 0.3e1 * t251 * t379 - 0.3e1 * t251 * t382 - t251 * t390 - 0.6e1 * t933 * t345 - 0.3e1 * t105 * t119 * t493 - t105 * t70 * (-t940 - 0.15e2 / 0.4e1 * t143 * t365);
  t1000 = -0.3e1 * t369 * t266 - 0.6e1 * t193 * t498 + 0.49437412864002313173e-5 * t764 * t405 * t473 + 0.12e2 * t200 * t488 * t110 + 0.6e1 * t200 * t258 * t212 + 0.6e1 * t200 * t494 * t110 + 0.6e1 * t200 * t263 * t212 + t395 * t153 + 0.3e1 * t191 * t275 + 0.3e1 * t101 * t483 + t64 * (-0.41197844053335260977e-6 * t764 / t18 / t797 * t401 * t40 * t285 + 0.11137322166768521115e-3 * t363 * t405 * t473 - 0.2077923984035857226e-1 * t215 * t918 + 0.12463286694101508916e0 * t114 * t874 + 0.154e3 / 0.81e2 * t66 * t861) + (-0.154e3 / 0.81e2 * t25 * t27 * t357 - t940) * t63 * t70 + 0.3e1 * t460 * t119 + 0.3e1 * t249 * t223 + t141 * t416;
  t1007 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t328 * t155 + t6 * t164 * t277 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t523 - 0.3e1 / 0.8e1 * t6 * t19 * (t872 + t906 + t946 + t1000));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1007 + 0.6e1 * t528;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1061 = 0.4e1 * t200 * t577 * t110 + 0.4e1 * t200 * t585 * t110 + 0.8e1 * t200 * t606 * t110 + 0.8e1 * t200 * t609 * t110 - 0.12e2 * t343 * t601 * t110 + 0.4e1 * t200 * t147 * t493 + 0.4e1 * t200 * t302 * t212 + 0.2e1 * t200 * t312 * t212 + 0.8e1 * t200 * t258 * t262 - 0.6e1 * t343 * t299 * t212 + 0.8e1 * t338 * t546 + 0.8e1 * t338 * t549 + 0.4e1 * t338 * t552 + 0.8e1 * t506 * t435 + 0.8e1 * t506 * t438 + 0.4e1 * t506 * t441 - 0.12e2 * t709 * t543;
  t1081 = t209 * sigma[0];
  t1084 = t285 * t177;
  t1119 = 0.2e1 * t460 * t153 + 0.4e1 * t249 * t275 + 0.2e1 * t141 * t483 + t191 * t319 + 0.2e1 * t101 * t570 + t64 * (0.15449191520000722866e-6 * t764 / t18 / t58 / t175 * t56 * t40 * t285 - 0.3519518943150164678e-4 * t471 * t562 + 0.50782434926925096106e-2 * t215 * t1081 - 0.18719561042524005487e-1 * t113 * t1084) - 0.24e2 * t867 * t868 * t262 + t289 * t290 * t223 / 0.144e3 - 0.2e1 / 0.27e2 * t289 * t537 * t119 + 0.19e2 / 0.81e2 * t289 * t177 * t63 * t70 - 0.12e2 * t343 * t302 * t201 - 0.6e1 * t343 * t312 * t201 - 0.23110569188301241342e-2 * t173 * t1084 + 0.8e1 * t913 * t255 - 0.12e2 * t933 * t447 + 0.24e2 * t714 * t299 * t201 + 0.2e1 * t745 * t299;
  t1164 = 0.4e1 * t338 * t601 + 0.2e1 * t200 * t223 * t298 - 0.2e1 * t369 * t302 - 0.4e1 * t193 * t606 - 0.4e1 * t193 * t609 - 0.2e1 * t105 * t483 * t146 - 0.4e1 * t105 * t275 * t262 - 0.2e1 * t105 * t153 * t493 - t369 * t312 - 0.2e1 * t193 * t577 - 0.2e1 * t193 * t585 - t105 * t223 * t311 + 0.48428580657746265971e-3 * t363 * t1081 - 0.2e1 * t921 * t147 - 0.2e1 * t105 * t119 * t584 - t105 * t70 * (0.19e2 / 0.81e2 * t43 * t450 + 0.3e1 / 0.4e1 * t308 * t209) - 0.2e1 * t193 * t587;
  t1186 = t262 * t262;
  t1195 = t49 * t199;
  t1208 = t96 * t104;
  t1212 = -0.2e1 * t105 * t570 * t110 - t105 * t319 * t212 - 0.4e1 * t511 * t258 - 0.4e1 * t511 * t263 - 0.2e1 * t251 * t485 - 0.4e1 * t251 * t488 - 0.2e1 * t251 * t494 - 0.4e1 * t511 * t266 - 0.4e1 * t251 * t498 - 0.2e1 * t251 * t501 + 0.4e1 * t200 * t70 * t1186 + 0.2e1 * t200 * t319 * t201 + 0.4e1 * t506 * t503 + t289 * t1195 * t202 / 0.72e2 - 0.1853902982400086744e-5 * t764 * t470 * t562 - t289 * t613 * t213 / 0.144e3 - t289 * t613 * t205 / 0.72e2 + 0.2e1 / 0.27e2 * t289 * t1208 * t111;
  t1219 = my_piecewise3(t2, 0, t6 * t164 * t321 / 0.12e2 - t6 * t78 * t618 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1061 + t1119 + t1164 + t1212));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1219 + 0.4e1 * t623;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1235 = t200 * t70;
  t1236 = t55 * t59;
  t1266 = -t289 * t537 * t153 / 0.9e1 - 0.18e2 * t867 * t146 * t311 * t110 + t289 * t290 * t275 / 0.48e2 + t1235 * t1236 * t110 / 0.48e2 - 0.18e2 * t343 * t299 * t262 + 0.6e1 * t338 * t639 + 0.6e1 * t200 * t258 * t311 + 0.6e1 * t200 * t263 * t311 + 0.6e1 * t200 * t147 * t584 + 0.6e1 * t200 * t652 * t110 + 0.6e1 * t200 * t655 * t110 - t193 * t630 / 0.96e2 - t105 * t119 * t55 * t59 / 0.96e2;
  t1307 = -0.18e2 * t933 * t543 + 0.12e2 * t506 * t546 + 0.24e2 * t714 * t636 * t110 + 0.12e2 * t506 * t549 + 0.6e1 * t506 * t552 - 0.18e2 * t343 * t649 * t110 + 0.12e2 * t200 * t302 * t262 + t105 * t629 * t107 / 0.12e2 - 0.10136214556272474273e-3 * t363 * t107 + t64 * (-0.57934468200002710749e-7 * t764 / t18 / t766 * t44 * t40 * t285 + 0.98546530408204610984e-5 * t560 * t666 - 0.82103337905807041608e-3 * t215 * t107) + 0.3e1 * t249 * t319 + 0.3e1 * t141 * t570 + t101 * t671;
  t1340 = -0.3e1 * t251 * t587 - t105 * t671 * t110 + 0.6e1 * t913 * t299 + 0.6e1 * t506 * t601 - 0.6e1 * t709 * t636 - 0.6e1 * t343 * t119 * t635 - 0.6e1 * t511 * t302 - 0.6e1 * t251 * t606 - 0.6e1 * t251 * t609 + 0.695213618400032529e-6 * t764 * t559 * t666 - t289 * t613 * t258 / 0.48e2 - t289 * t613 * t263 / 0.48e2 - t289 * t613 * t266 / 0.48e2;
  t1375 = t289 * t1208 * t147 / 0.9e1 + t306 * t199 * t70 * t868 / 0.24e2 - 0.3e1 * t511 * t312 - 0.3e1 * t251 * t577 - 0.3e1 * t251 * t585 + 0.6e1 * t338 * t649 + 0.6e1 * t200 * t275 * t298 - 0.3e1 * t193 * t652 - 0.3e1 * t105 * t570 * t146 - 0.3e1 * t105 * t319 * t262 - 0.3e1 * t193 * t655 - 0.3e1 * t105 * t275 * t311 - 0.3e1 * t105 * t153 * t584;
  t1382 = my_piecewise3(t2, 0, -t6 * t78 * t673 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1266 + t1307 + t1340 + t1375));
  tv4rhosigma30 = 0.2e1 * rho[0] * t1382 + 0.2e1 * t677;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1386 = t25 * t27;
  t1423 = -0.26070510690001219837e-6 * t764 * t663 * t1386 + t289 * t290 * t319 / 0.24e2 + t1235 * t1236 * t146 / 0.12e2 + 0.4e1 * t141 * t671 + t64 * (0.21725425575001016531e-7 * t764 / t18 / t403 * sigma[0] * t40 * t285 - 0.21117113658900988068e-5 * t664 * t1386) + 0.24e2 * t506 * t649 - 0.24e2 * t343 * t153 * t635 - 0.12e2 * t251 * t652 - 0.12e2 * t251 * t655 + 0.12e2 * t200 * t319 * t298 - 0.4e1 * t105 * t671 * t146;
  t1440 = t298 * t298;
  t1450 = t311 * t311;
  t1460 = -0.6e1 * t105 * t319 * t311 + t289 * t1195 * t299 / 0.12e2 - t289 * t613 * t312 / 0.24e2 - t289 * t613 * t302 / 0.12e2 - 0.24e2 * t933 * t636 + 0.24e2 * t506 * t639 + 0.24e2 * t714 * t70 * t1440 - 0.36e2 * t343 * t299 * t311 + 0.24e2 * t200 * t302 * t311 + 0.6e1 * t200 * t70 * t1450 - t251 * t630 / 0.24e2 - t105 * t153 * t55 * t59 / 0.24e2;
  t1465 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (t1423 + t1460));
  tv4sigma40 = 0.2e1 * rho[0] * t1465;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t44, t46, t48, t49, t50, t51, t52, t54;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t67, t68, t69, t71, t72, t76, t78, t82;
  double t83, t84, t86, t87, t88, t89, t91, t92;
  double t93, t94, t95, t97, t99, t101, t103, t105;
  double t106, t107, t109, t112, t113, t114, t115, t116;
  double t117, t120, t121, t122, t124, t125, t129, t131;
  double t135, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t44 = 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t57 = t49 * t50 * t54 / 0.576e3;
  t58 = t40 / 0.24e2 + t57;
  t59 = t29 * t29;
  t60 = 0.1e1 / t59;
  t61 = t50 * sigma[0];
  t62 = t60 * t61;
  t63 = t51 * t51;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + t57 + t62 * t64 / 0.2304e4;
  t68 = 0.1e1 / t67;
  t69 = t58 * t68;
  t71 = (0.1804e1 - t44) * t28;
  t72 = t32 * sigma[0];
  t76 = -t71 * t72 * t38 / 0.24e2 + 0.6525e-1;
  t78 = 0.1804e1 - t44 + t69 * t76;
  t82 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t78);
  t83 = rho[1] <= p->dens_threshold;
  t84 = -t16;
  t86 = my_piecewise5(t14, t11, t10, t15, t84 * t7);
  t87 = 0.1e1 + t86;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t22, t89 * t87);
  t92 = t91 * t26;
  t93 = rho[1] * rho[1];
  t94 = POW_1_3(rho[1]);
  t95 = t94 * t94;
  t97 = 0.1e1 / t95 / t93;
  t99 = t33 * sigma[2] * t97;
  t101 = 0.804e0 + 0.5e1 / 0.972e3 * t99;
  t103 = 0.646416e0 / t101;
  t105 = sigma[2] * sigma[2];
  t106 = t93 * t93;
  t107 = t106 * rho[1];
  t109 = 0.1e1 / t94 / t107;
  t112 = t49 * t105 * t109 / 0.576e3;
  t113 = t99 / 0.24e2 + t112;
  t114 = t105 * sigma[2];
  t115 = t60 * t114;
  t116 = t106 * t106;
  t117 = 0.1e1 / t116;
  t120 = 0.1e1 + t112 + t115 * t117 / 0.2304e4;
  t121 = 0.1e1 / t120;
  t122 = t113 * t121;
  t124 = (0.1804e1 - t103) * t28;
  t125 = t32 * sigma[2];
  t129 = -t124 * t125 * t97 / 0.24e2 + 0.6525e-1;
  t131 = 0.1804e1 - t103 + t122 * t129;
  t135 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t131);
  tzk0 = t82 + t135;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t44, t46, t48, t49, t50, t51, t52, t54;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t67, t68, t69, t71, t72, t76, t78, t82;
  double t83, t84, t86, t87, t88, t89, t91, t92;
  double t93, t94, t95, t97, t99, t101, t103, t105;
  double t106, t107, t109, t112, t113, t114, t115, t116;
  double t117, t120, t121, t122, t124, t125, t129, t131;
  double t135, tzk0;

  double t136, t137, t138, t140, t143, t144, t148, t149;
  double t150, t153, t154, t155, t156, t157, t159, t160;
  double t166, t168, t171, t172, t173, t175, t176, t177;
  double t178, t179, t182, t183, t185, t186, t192, t194;
  double t199, t200, t202, t205, t206, t210, t213, t215;
  double tvrho0, t219, t222, t223, t228, t230, t233, t234;
  double t238, t239, t240, t241, t243, t244, t250, t252;
  double t255, t256, t257, t259, t260, t261, t262, t263;
  double t266, t267, t269, t270, t276, t278, t283, tvrho1;
  double t286, t293, t294, t295, t297, t300, t301, t303;
  double t309, t311, t315, tvsigma0, tvsigma1, t316, t323, t324;
  double t325, t327, t330, t331, t333, t339, t341, t345;
  double tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t44 = 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t57 = t49 * t50 * t54 / 0.576e3;
  t58 = t40 / 0.24e2 + t57;
  t59 = t29 * t29;
  t60 = 0.1e1 / t59;
  t61 = t50 * sigma[0];
  t62 = t60 * t61;
  t63 = t51 * t51;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + t57 + t62 * t64 / 0.2304e4;
  t68 = 0.1e1 / t67;
  t69 = t58 * t68;
  t71 = (0.1804e1 - t44) * t28;
  t72 = t32 * sigma[0];
  t76 = -t71 * t72 * t38 / 0.24e2 + 0.6525e-1;
  t78 = 0.1804e1 - t44 + t69 * t76;
  t82 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t78);
  t83 = rho[1] <= p->dens_threshold;
  t84 = -t16;
  t86 = my_piecewise5(t14, t11, t10, t15, t84 * t7);
  t87 = 0.1e1 + t86;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t22, t89 * t87);
  t92 = t91 * t26;
  t93 = rho[1] * rho[1];
  t94 = POW_1_3(rho[1]);
  t95 = t94 * t94;
  t97 = 0.1e1 / t95 / t93;
  t99 = t33 * sigma[2] * t97;
  t101 = 0.804e0 + 0.5e1 / 0.972e3 * t99;
  t103 = 0.646416e0 / t101;
  t105 = sigma[2] * sigma[2];
  t106 = t93 * t93;
  t107 = t106 * rho[1];
  t109 = 0.1e1 / t94 / t107;
  t112 = t49 * t105 * t109 / 0.576e3;
  t113 = t99 / 0.24e2 + t112;
  t114 = t105 * sigma[2];
  t115 = t60 * t114;
  t116 = t106 * t106;
  t117 = 0.1e1 / t116;
  t120 = 0.1e1 + t112 + t115 * t117 / 0.2304e4;
  t121 = 0.1e1 / t120;
  t122 = t113 * t121;
  t124 = (0.1804e1 - t103) * t28;
  t125 = t32 * sigma[2];
  t129 = -t124 * t125 * t97 / 0.24e2 + 0.6525e-1;
  t131 = 0.1804e1 - t103 + t122 * t129;
  t135 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t131);
  tzk0 = t82 + t135;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = t6 * t6;
  t137 = 0.1e1 / t136;
  t138 = t16 * t137;
  t140 = my_piecewise5(t10, 0, t14, 0, t7 - t138);
  t143 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t140);
  t144 = t143 * t26;
  t148 = t26 * t26;
  t149 = 0.1e1 / t148;
  t150 = t25 * t149;
  t153 = t5 * t150 * t78 / 0.8e1;
  t154 = t42 * t42;
  t155 = 0.1e1 / t154;
  t156 = t155 * t28;
  t157 = t34 * rho[0];
  t159 = 0.1e1 / t36 / t157;
  t160 = t72 * t159;
  t166 = t51 * t34;
  t168 = 0.1e1 / t35 / t166;
  t171 = t49 * t50 * t168 / 0.108e3;
  t172 = -t33 * sigma[0] * t159 / 0.9e1 - t171;
  t173 = t172 * t68;
  t175 = t67 * t67;
  t176 = 0.1e1 / t175;
  t177 = t58 * t176;
  t178 = t63 * rho[0];
  t179 = 0.1e1 / t178;
  t182 = -t171 - t62 * t179 / 0.288e3;
  t183 = t76 * t182;
  t185 = t155 * t46;
  t186 = t48 * t50;
  t192 = 0.36946502057613168724e-3 * t185 * t186 * t168 + t71 * t160 / 0.9e1;
  t194 = -0.88671604938271604938e-2 * t156 * t160 + t173 * t76 - t177 * t183 + t69 * t192;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t78 - t153 - 0.3e1 / 0.8e1 * t5 * t27 * t194);
  t200 = t84 * t137;
  t202 = my_piecewise5(t14, 0, t10, 0, -t7 - t200);
  t205 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t202);
  t206 = t205 * t26;
  t210 = t91 * t149;
  t213 = t5 * t210 * t131 / 0.8e1;
  t215 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t131 - t213);
  tvrho0 = t82 + t135 + t6 * (t199 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t219 = my_piecewise5(t10, 0, t14, 0, -t7 - t138);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t78 - t153);
  t230 = my_piecewise5(t14, 0, t10, 0, t7 - t200);
  t233 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t230);
  t234 = t233 * t26;
  t238 = t101 * t101;
  t239 = 0.1e1 / t238;
  t240 = t239 * t28;
  t241 = t93 * rho[1];
  t243 = 0.1e1 / t95 / t241;
  t244 = t125 * t243;
  t250 = t106 * t93;
  t252 = 0.1e1 / t94 / t250;
  t255 = t49 * t105 * t252 / 0.108e3;
  t256 = -t33 * sigma[2] * t243 / 0.9e1 - t255;
  t257 = t256 * t121;
  t259 = t120 * t120;
  t260 = 0.1e1 / t259;
  t261 = t113 * t260;
  t262 = t116 * rho[1];
  t263 = 0.1e1 / t262;
  t266 = -t255 - t115 * t263 / 0.288e3;
  t267 = t129 * t266;
  t269 = t239 * t46;
  t270 = t48 * t105;
  t276 = 0.36946502057613168724e-3 * t269 * t270 * t252 + t124 * t244 / 0.9e1;
  t278 = -0.88671604938271604938e-2 * t240 * t244 + t257 * t129 - t261 * t267 + t122 * t276;
  t283 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t131 - t213 - 0.3e1 / 0.8e1 * t5 * t92 * t278);
  tvrho1 = t82 + t135 + t6 * (t228 + t283);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t286 = t32 * t38;
  t293 = t49 * sigma[0] * t54 / 0.288e3;
  t294 = t33 * t38 / 0.24e2 + t293;
  t295 = t294 * t68;
  t297 = t60 * t50;
  t300 = t293 + t297 * t64 / 0.768e3;
  t301 = t76 * t300;
  t303 = t48 * t54;
  t309 = -0.13854938271604938272e-3 * t185 * t303 * sigma[0] - t71 * t286 / 0.24e2;
  t311 = 0.33251851851851851852e-2 * t156 * t286 + t295 * t76 - t177 * t301 + t69 * t309;
  t315 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t311);
  tvsigma0 = t6 * t315;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t316 = t32 * t97;
  t323 = t49 * sigma[2] * t109 / 0.288e3;
  t324 = t33 * t97 / 0.24e2 + t323;
  t325 = t324 * t121;
  t327 = t60 * t105;
  t330 = t323 + t327 * t117 / 0.768e3;
  t331 = t129 * t330;
  t333 = t48 * t109;
  t339 = -0.13854938271604938272e-3 * t269 * t333 * sigma[2] - t124 * t316 / 0.24e2;
  t341 = 0.33251851851851851852e-2 * t240 * t316 + t325 * t129 - t261 * t331 + t122 * t339;
  t345 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t341);
  tvsigma2 = t6 * t345;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t44, t46, t48, t49, t50, t51, t52, t54;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t67, t68, t69, t71, t72, t76, t78, t82;
  double t83, t84, t86, t87, t88, t89, t91, t92;
  double t93, t94, t95, t97, t99, t101, t103, t105;
  double t106, t107, t109, t112, t113, t114, t115, t116;
  double t117, t120, t121, t122, t124, t125, t129, t131;
  double t135, tzk0;

  double t136, t137, t138, t140, t143, t144, t148, t149;
  double t150, t153, t154, t155, t156, t157, t159, t160;
  double t166, t168, t171, t172, t173, t175, t176, t177;
  double t178, t179, t182, t183, t185, t186, t192, t194;
  double t199, t200, t202, t205, t206, t210, t213, t215;
  double tvrho0, t219, t222, t223, t228, t230, t233, t234;
  double t238, t239, t240, t241, t243, t244, t250, t252;
  double t255, t256, t257, t259, t260, t261, t262, t263;
  double t266, t267, t269, t270, t276, t278, t283, tvrho1;
  double t286, t293, t294, t295, t297, t300, t301, t303;
  double t309, t311, t315, tvsigma0, tvsigma1, t316, t323, t324;
  double t325, t327, t330, t331, t333, t339, t341, t345;
  double tvsigma2;

  double t348, t349, t350, t353, t354, t355, t358, t362;
  double t363, t367, t369, t375, t376, t379, t381, t384;
  double t385, t386, t388, t389, t393, t394, t402, t403;
  double t404, t406, t412, t413, t414, t415, t418, t421;
  double t422, t425, t426, t428, t436, t438, t443, t444;
  double t445, t446, t449, t452, t456, t457, t461, t463;
  double t465, t468, t470, tv2rho20, t473, t477, t481, t482;
  double t486, t488, t496, t497, t501, t505, t506, t510;
  double t512, t519, t522, tv2rho21, t527, t532, t536, t537;
  double t543, t544, t549, t553, t554, t564, t565, t566;
  double t568, t569, t573, t574, t582, t583, t584, t586;
  double t592, t593, t594, t595, t598, t601, t602, t605;
  double t606, t608, t616, t618, t623, tv2rho22, t631, t632;
  double t633, t636, t643, t644, t645, t647, t651, t654;
  double t658, t659, t662, t671, t673, t678, tv2rhosigma0, tv2rhosigma1;
  double t685, t687, tv2rhosigma2, t693, tv2rhosigma3, tv2rhosigma4, t698, t699;
  double t702, t709, t710, t711, t713, t717, t720, t724;
  double t725, t728, t737, t739, t744, tv2rhosigma5, t748, t756;
  double t757, t760, t763, t765, t768, t769, t776, t778;
  double t782, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t785, t793;
  double t794, t797, t800, t802, t805, t806, t813, t815;
  double t819, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t44 = 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t57 = t49 * t50 * t54 / 0.576e3;
  t58 = t40 / 0.24e2 + t57;
  t59 = t29 * t29;
  t60 = 0.1e1 / t59;
  t61 = t50 * sigma[0];
  t62 = t60 * t61;
  t63 = t51 * t51;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + t57 + t62 * t64 / 0.2304e4;
  t68 = 0.1e1 / t67;
  t69 = t58 * t68;
  t71 = (0.1804e1 - t44) * t28;
  t72 = t32 * sigma[0];
  t76 = -t71 * t72 * t38 / 0.24e2 + 0.6525e-1;
  t78 = 0.1804e1 - t44 + t69 * t76;
  t82 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t78);
  t83 = rho[1] <= p->dens_threshold;
  t84 = -t16;
  t86 = my_piecewise5(t14, t11, t10, t15, t84 * t7);
  t87 = 0.1e1 + t86;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t22, t89 * t87);
  t92 = t91 * t26;
  t93 = rho[1] * rho[1];
  t94 = POW_1_3(rho[1]);
  t95 = t94 * t94;
  t97 = 0.1e1 / t95 / t93;
  t99 = t33 * sigma[2] * t97;
  t101 = 0.804e0 + 0.5e1 / 0.972e3 * t99;
  t103 = 0.646416e0 / t101;
  t105 = sigma[2] * sigma[2];
  t106 = t93 * t93;
  t107 = t106 * rho[1];
  t109 = 0.1e1 / t94 / t107;
  t112 = t49 * t105 * t109 / 0.576e3;
  t113 = t99 / 0.24e2 + t112;
  t114 = t105 * sigma[2];
  t115 = t60 * t114;
  t116 = t106 * t106;
  t117 = 0.1e1 / t116;
  t120 = 0.1e1 + t112 + t115 * t117 / 0.2304e4;
  t121 = 0.1e1 / t120;
  t122 = t113 * t121;
  t124 = (0.1804e1 - t103) * t28;
  t125 = t32 * sigma[2];
  t129 = -t124 * t125 * t97 / 0.24e2 + 0.6525e-1;
  t131 = 0.1804e1 - t103 + t122 * t129;
  t135 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t131);
  tzk0 = t82 + t135;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = t6 * t6;
  t137 = 0.1e1 / t136;
  t138 = t16 * t137;
  t140 = my_piecewise5(t10, 0, t14, 0, t7 - t138);
  t143 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t140);
  t144 = t143 * t26;
  t148 = t26 * t26;
  t149 = 0.1e1 / t148;
  t150 = t25 * t149;
  t153 = t5 * t150 * t78 / 0.8e1;
  t154 = t42 * t42;
  t155 = 0.1e1 / t154;
  t156 = t155 * t28;
  t157 = t34 * rho[0];
  t159 = 0.1e1 / t36 / t157;
  t160 = t72 * t159;
  t166 = t51 * t34;
  t168 = 0.1e1 / t35 / t166;
  t171 = t49 * t50 * t168 / 0.108e3;
  t172 = -t33 * sigma[0] * t159 / 0.9e1 - t171;
  t173 = t172 * t68;
  t175 = t67 * t67;
  t176 = 0.1e1 / t175;
  t177 = t58 * t176;
  t178 = t63 * rho[0];
  t179 = 0.1e1 / t178;
  t182 = -t171 - t62 * t179 / 0.288e3;
  t183 = t76 * t182;
  t185 = t155 * t46;
  t186 = t48 * t50;
  t192 = 0.36946502057613168724e-3 * t185 * t186 * t168 + t71 * t160 / 0.9e1;
  t194 = -0.88671604938271604938e-2 * t156 * t160 + t173 * t76 - t177 * t183 + t69 * t192;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t78 - t153 - 0.3e1 / 0.8e1 * t5 * t27 * t194);
  t200 = t84 * t137;
  t202 = my_piecewise5(t14, 0, t10, 0, -t7 - t200);
  t205 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t202);
  t206 = t205 * t26;
  t210 = t91 * t149;
  t213 = t5 * t210 * t131 / 0.8e1;
  t215 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t131 - t213);
  tvrho0 = t82 + t135 + t6 * (t199 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t219 = my_piecewise5(t10, 0, t14, 0, -t7 - t138);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t78 - t153);
  t230 = my_piecewise5(t14, 0, t10, 0, t7 - t200);
  t233 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t230);
  t234 = t233 * t26;
  t238 = t101 * t101;
  t239 = 0.1e1 / t238;
  t240 = t239 * t28;
  t241 = t93 * rho[1];
  t243 = 0.1e1 / t95 / t241;
  t244 = t125 * t243;
  t250 = t106 * t93;
  t252 = 0.1e1 / t94 / t250;
  t255 = t49 * t105 * t252 / 0.108e3;
  t256 = -t33 * sigma[2] * t243 / 0.9e1 - t255;
  t257 = t256 * t121;
  t259 = t120 * t120;
  t260 = 0.1e1 / t259;
  t261 = t113 * t260;
  t262 = t116 * rho[1];
  t263 = 0.1e1 / t262;
  t266 = -t255 - t115 * t263 / 0.288e3;
  t267 = t129 * t266;
  t269 = t239 * t46;
  t270 = t48 * t105;
  t276 = 0.36946502057613168724e-3 * t269 * t270 * t252 + t124 * t244 / 0.9e1;
  t278 = -0.88671604938271604938e-2 * t240 * t244 + t257 * t129 - t261 * t267 + t122 * t276;
  t283 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t131 - t213 - 0.3e1 / 0.8e1 * t5 * t92 * t278);
  tvrho1 = t82 + t135 + t6 * (t228 + t283);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t286 = t32 * t38;
  t293 = t49 * sigma[0] * t54 / 0.288e3;
  t294 = t33 * t38 / 0.24e2 + t293;
  t295 = t294 * t68;
  t297 = t60 * t50;
  t300 = t293 + t297 * t64 / 0.768e3;
  t301 = t76 * t300;
  t303 = t48 * t54;
  t309 = -0.13854938271604938272e-3 * t185 * t303 * sigma[0] - t71 * t286 / 0.24e2;
  t311 = 0.33251851851851851852e-2 * t156 * t286 + t295 * t76 - t177 * t301 + t69 * t309;
  t315 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t311);
  tvsigma0 = t6 * t315;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t316 = t32 * t97;
  t323 = t49 * sigma[2] * t109 / 0.288e3;
  t324 = t33 * t97 / 0.24e2 + t323;
  t325 = t324 * t121;
  t327 = t60 * t105;
  t330 = t323 + t327 * t117 / 0.768e3;
  t331 = t129 * t330;
  t333 = t48 * t109;
  t339 = -0.13854938271604938272e-3 * t269 * t333 * sigma[2] - t124 * t316 / 0.24e2;
  t341 = 0.33251851851851851852e-2 * t240 * t316 + t325 * t129 - t261 * t331 + t122 * t339;
  t345 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t341);
  tvsigma2 = t6 * t345;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t348 = t23 * t23;
  t349 = 0.1e1 / t348;
  t350 = t140 * t140;
  t353 = t136 * t6;
  t354 = 0.1e1 / t353;
  t355 = t16 * t354;
  t358 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t137 + 0.2e1 * t355);
  t362 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t23 * t358);
  t363 = t362 * t26;
  t367 = t143 * t149;
  t369 = t5 * t367 * t78;
  t375 = 0.1e1 / t148 / t6;
  t376 = t25 * t375;
  t379 = t5 * t376 * t78 / 0.12e2;
  t381 = t5 * t150 * t194;
  t384 = 0.1e1 / t154 / t42;
  t385 = t384 * t46;
  t386 = t51 * t157;
  t388 = 0.1e1 / t35 / t386;
  t389 = t186 * t388;
  t393 = 0.1e1 / t36 / t51;
  t394 = t72 * t393;
  t402 = 0.19e2 / 0.324e3 * t49 * t50 * t388;
  t403 = 0.11e2 / 0.27e2 * t33 * sigma[0] * t393 + t402;
  t404 = t403 * t68;
  t406 = t172 * t176;
  t412 = 0.1e1 / t175 / t67;
  t413 = t58 * t412;
  t414 = t182 * t182;
  t415 = t76 * t414;
  t418 = t192 * t182;
  t421 = t63 * t34;
  t422 = 0.1e1 / t421;
  t425 = t402 + t62 * t422 / 0.32e2;
  t426 = t76 * t425;
  t428 = t384 * t60;
  t436 = 0.60817287337634845636e-4 * t428 * t61 * t422 - 0.33251851851851851852e-2 * t185 * t389 - 0.11e2 / 0.27e2 * t71 * t394;
  t438 = -0.24326914935053938255e-3 * t385 * t389 + 0.32512921810699588477e-1 * t156 * t394 + t404 * t76 - 0.2e1 * t406 * t183 + 0.2e1 * t173 * t192 + 0.2e1 * t413 * t415 - 0.2e1 * t177 * t418 - t177 * t426 + t69 * t436;
  t443 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t78 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t194 + t379 - t381 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t438);
  t444 = t89 * t89;
  t445 = 0.1e1 / t444;
  t446 = t202 * t202;
  t449 = t84 * t354;
  t452 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t137 + 0.2e1 * t449);
  t456 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t446 + 0.4e1 / 0.3e1 * t89 * t452);
  t457 = t456 * t26;
  t461 = t205 * t149;
  t463 = t5 * t461 * t131;
  t465 = t91 * t375;
  t468 = t5 * t465 * t131 / 0.12e2;
  t470 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t131 - t463 / 0.4e1 + t468);
  tv2rho20 = 0.2e1 * t199 + 0.2e1 * t215 + t6 * (t443 + t470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t473 = t349 * t219;
  t477 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t355);
  t481 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t473 * t140 + 0.4e1 / 0.3e1 * t23 * t477);
  t482 = t481 * t26;
  t486 = t222 * t149;
  t488 = t5 * t486 * t78;
  t496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t78 - t488 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t194 - t369 / 0.8e1 + t379 - t381 / 0.8e1);
  t497 = t445 * t230;
  t501 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t449);
  t505 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t497 * t202 + 0.4e1 / 0.3e1 * t89 * t501);
  t506 = t505 * t26;
  t510 = t233 * t149;
  t512 = t5 * t510 * t131;
  t519 = t5 * t210 * t278;
  t522 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t131 - t512 / 0.8e1 - t463 / 0.8e1 + t468 - 0.3e1 / 0.8e1 * t5 * t206 * t278 - t519 / 0.8e1);
  tv2rho21 = t199 + t215 + t228 + t283 + t6 * (t496 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t527 = t219 * t219;
  t532 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t137 + 0.2e1 * t355);
  t536 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t527 + 0.4e1 / 0.3e1 * t23 * t532);
  t537 = t536 * t26;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t78 - t488 / 0.4e1 + t379);
  t544 = t230 * t230;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t137 + 0.2e1 * t449);
  t553 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t544 + 0.4e1 / 0.3e1 * t89 * t549);
  t554 = t553 * t26;
  t564 = 0.1e1 / t238 / t101;
  t565 = t564 * t46;
  t566 = t106 * t241;
  t568 = 0.1e1 / t94 / t566;
  t569 = t270 * t568;
  t573 = 0.1e1 / t95 / t106;
  t574 = t125 * t573;
  t582 = 0.19e2 / 0.324e3 * t49 * t105 * t568;
  t583 = 0.11e2 / 0.27e2 * t33 * sigma[2] * t573 + t582;
  t584 = t583 * t121;
  t586 = t256 * t260;
  t592 = 0.1e1 / t259 / t120;
  t593 = t113 * t592;
  t594 = t266 * t266;
  t595 = t129 * t594;
  t598 = t276 * t266;
  t601 = t116 * t93;
  t602 = 0.1e1 / t601;
  t605 = t582 + t115 * t602 / 0.32e2;
  t606 = t129 * t605;
  t608 = t564 * t60;
  t616 = 0.60817287337634845636e-4 * t608 * t114 * t602 - 0.33251851851851851852e-2 * t269 * t569 - 0.11e2 / 0.27e2 * t124 * t574;
  t618 = -0.24326914935053938255e-3 * t565 * t569 + 0.32512921810699588477e-1 * t240 * t574 + t584 * t129 - 0.2e1 * t586 * t267 + 0.2e1 * t257 * t276 + 0.2e1 * t593 * t595 - 0.2e1 * t261 * t598 - t261 * t606 + t122 * t616;
  t623 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t131 - t512 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t278 + t468 - t519 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t283 + t6 * (t543 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t150 * t311 / 0.8e1;
  t632 = t48 * t168;
  t633 = t632 * sigma[0];
  t636 = t32 * t159;
  t643 = t49 * sigma[0] * t168 / 0.54e2;
  t644 = -t33 * t159 / 0.9e1 - t643;
  t645 = t644 * t68;
  t647 = t294 * t176;
  t651 = t301 * t182;
  t654 = t192 * t300;
  t658 = -t643 - t297 * t179 / 0.96e2;
  t659 = t76 * t658;
  t662 = t309 * t182;
  t671 = -0.22806482751613067114e-4 * t428 * t179 * t50 + 0.11083950617283950618e-2 * t185 * t633 + t71 * t636 / 0.9e1;
  t673 = 0.91225931006452268455e-4 * t385 * t633 - 0.88671604938271604939e-2 * t156 * t636 + t645 * t76 - t647 * t183 + t295 * t192 - t406 * t301 + 0.2e1 * t413 * t651 - t177 * t654 - t177 * t659 + t173 * t309 - t177 * t662 + t69 * t671;
  t678 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t311 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t673);
  tv2rhosigma0 = t6 * t678 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t685 = t5 * t210 * t341 / 0.8e1;
  t687 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t341 - t685);
  tv2rhosigma2 = t6 * t687 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t693 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t311 - t631);
  tv2rhosigma3 = t6 * t693 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t48 * t252;
  t699 = t698 * sigma[2];
  t702 = t32 * t243;
  t709 = t49 * sigma[2] * t252 / 0.54e2;
  t710 = -t33 * t243 / 0.9e1 - t709;
  t711 = t710 * t121;
  t713 = t324 * t260;
  t717 = t331 * t266;
  t720 = t276 * t330;
  t724 = -t709 - t327 * t263 / 0.96e2;
  t725 = t129 * t724;
  t728 = t339 * t266;
  t737 = -0.22806482751613067114e-4 * t608 * t263 * t105 + 0.11083950617283950618e-2 * t269 * t699 + t124 * t702 / 0.9e1;
  t739 = 0.91225931006452268455e-4 * t565 * t699 - 0.88671604938271604939e-2 * t240 * t702 + t711 * t129 - t713 * t267 + t325 * t276 - t586 * t331 + 0.2e1 * t593 * t717 - t261 * t720 - t261 * t725 + t257 * t339 - t261 * t728 + t122 * t737;
  t744 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t341 - t685 - 0.3e1 / 0.8e1 * t5 * t92 * t739);
  tv2rhosigma5 = t6 * t744 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t748 = t54 * t68;
  t756 = t300 * t300;
  t757 = t76 * t756;
  t760 = t309 * t300;
  t763 = t49 * t54;
  t765 = t60 * sigma[0];
  t768 = t763 / 0.288e3 + t765 * t64 / 0.384e3;
  t769 = t76 * t768;
  t776 = 0.85524310318549001679e-5 * t428 * t64 * sigma[0] - 0.27709876543209876544e-3 * t185 * t303;
  t778 = -0.34209724127419600671e-4 * t385 * t303 + t49 * t748 * t76 / 0.288e3 - 0.2e1 * t647 * t301 + 0.2e1 * t295 * t309 + 0.2e1 * t413 * t757 - 0.2e1 * t177 * t760 - t177 * t769 + t69 * t776;
  t782 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t778);
  tv2sigma20 = t6 * t782;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t785 = t109 * t121;
  t793 = t330 * t330;
  t794 = t129 * t793;
  t797 = t339 * t330;
  t800 = t49 * t109;
  t802 = t60 * sigma[2];
  t805 = t800 / 0.288e3 + t802 * t117 / 0.384e3;
  t806 = t129 * t805;
  t813 = 0.85524310318549001679e-5 * t608 * t117 * sigma[2] - 0.27709876543209876544e-3 * t269 * t333;
  t815 = -0.34209724127419600671e-4 * t565 * t333 + t49 * t785 * t129 / 0.288e3 - 0.2e1 * t713 * t331 + 0.2e1 * t325 * t339 + 0.2e1 * t593 * t794 - 0.2e1 * t261 * t797 - t261 * t806 + t122 * t813;
  t819 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t815);
  tv2sigma25 = t6 * t819;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t44, t46, t48, t49, t50, t51, t52, t54;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t67, t68, t69, t71, t72, t76, t78, t82;
  double t83, t84, t86, t87, t88, t89, t91, t92;
  double t93, t94, t95, t97, t99, t101, t103, t105;
  double t106, t107, t109, t112, t113, t114, t115, t116;
  double t117, t120, t121, t122, t124, t125, t129, t131;
  double t135, tzk0;

  double t136, t137, t138, t140, t143, t144, t148, t149;
  double t150, t153, t154, t155, t156, t157, t159, t160;
  double t166, t168, t171, t172, t173, t175, t176, t177;
  double t178, t179, t182, t183, t185, t186, t192, t194;
  double t199, t200, t202, t205, t206, t210, t213, t215;
  double tvrho0, t219, t222, t223, t228, t230, t233, t234;
  double t238, t239, t240, t241, t243, t244, t250, t252;
  double t255, t256, t257, t259, t260, t261, t262, t263;
  double t266, t267, t269, t270, t276, t278, t283, tvrho1;
  double t286, t293, t294, t295, t297, t300, t301, t303;
  double t309, t311, t315, tvsigma0, tvsigma1, t316, t323, t324;
  double t325, t327, t330, t331, t333, t339, t341, t345;
  double tvsigma2;

  double t348, t349, t350, t353, t354, t355, t358, t362;
  double t363, t367, t369, t375, t376, t379, t381, t384;
  double t385, t386, t388, t389, t393, t394, t402, t403;
  double t404, t406, t412, t413, t414, t415, t418, t421;
  double t422, t425, t426, t428, t436, t438, t443, t444;
  double t445, t446, t449, t452, t456, t457, t461, t463;
  double t465, t468, t470, tv2rho20, t473, t477, t481, t482;
  double t486, t488, t496, t497, t501, t505, t506, t510;
  double t512, t519, t522, tv2rho21, t527, t532, t536, t537;
  double t543, t544, t549, t553, t554, t564, t565, t566;
  double t568, t569, t573, t574, t582, t583, t584, t586;
  double t592, t593, t594, t595, t598, t601, t602, t605;
  double t606, t608, t616, t618, t623, tv2rho22, t631, t632;
  double t633, t636, t643, t644, t645, t647, t651, t654;
  double t658, t659, t662, t671, t673, t678, tv2rhosigma0, tv2rhosigma1;
  double t685, t687, tv2rhosigma2, t693, tv2rhosigma3, tv2rhosigma4, t698, t699;
  double t702, t709, t710, t711, t713, t717, t720, t724;
  double t725, t728, t737, t739, t744, tv2rhosigma5, t748, t756;
  double t757, t760, t763, t765, t768, t769, t776, t778;
  double t782, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t785, t793;
  double t794, t797, t800, t802, t805, t806, t813, t815;
  double t819, tv2sigma25;

  double t823, t824, t827, t830, t831, t832, t835, t839;
  double t840, t844, t846, t851, t853, t856, t862, t863;
  double t866, t868, t871, t873, t874, t875, t876, t877;
  double t880, t883, t887, t888, t892, t893, t896, t899;
  double t904, t905, t906, t909, t910, t912, t914, t915;
  double t918, t925, t931, t932, t938, t939, t940, t942;
  double t953, t955, t960, t962, t963, t966, t969, t972;
  double t976, t977, t981, t983, t985, t987, t989, t992;
  double t994, tv3rho30, t997, t998, t999, t1002, t1007, t1008;
  double t1010, t1014, t1015, t1019, t1022, t1026, t1028, t1032;
  double t1041, t1042, t1043, t1046, t1051, t1053, t1057, t1058;
  double t1062, t1065, t1066, t1068, t1077, t1079, t1082, tv3rho31;
  double t1085, t1090, t1094, t1098, t1099, t1103, t1105, t1114;
  double t1115, t1120, t1124, t1128, t1129, t1133, t1135, t1142;
  double t1150, t1152, t1153, tv3rho32, t1158, t1165, t1169, t1170;
  double t1177, t1178, t1185, t1189, t1190, t1205, t1207, t1208;
  double t1209, t1210, t1212, t1217, t1218, t1219, t1223, t1224;
  double t1228, t1229, t1232, t1239, t1240, t1241, t1247, t1250;
  double t1251, t1252, t1253, t1254, t1257, t1264, t1267, t1270;
  double t1275, t1276, t1280, t1287, t1292, tv3rho33, t1300, t1307;
  double t1309, t1317, t1319, t1320, t1322, t1325, t1328, t1329;
  double t1332, t1335, t1341, t1342, t1343, t1347, t1352, t1357;
  double t1360, t1363, t1366, t1367, t1372, t1373, t1377, t1380;
  double t1384, t1395, t1397, t1400, t1401, t1406, tv3rho2sigma0, tv3rho2sigma1;
  double t1413, t1417, t1419, tv3rho2sigma2, t1425, t1433, tv3rho2sigma3, tv3rho2sigma4;
  double t1439, t1446, t1449, tv3rho2sigma5, t1457, tv3rho2sigma6, tv3rho2sigma7, t1472;
  double t1474, t1477, t1479, t1482, t1489, t1492, t1495, t1498;
  double t1501, t1502, t1503, t1508, t1513, t1516, t1517, t1521;
  double t1524, t1527, t1532, t1533, t1541, t1543, t1544, t1546;
  double t1555, t1557, t1558, t1563, tv3rho2sigma8, t1570, t1576, t1578;
  double t1582, t1583, t1585, t1587, t1594, t1599, t1602, t1605;
  double t1610, t1613, t1616, t1619, t1622, t1631, t1632, t1637;
  double t1638, t1640, t1647, t1653, t1654, t1659, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1666, t1668, tv3rhosigma25, t1674, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1681, t1684, t1694, t1699;
  double t1701, t1705, t1706, t1708, t1710, t1713, t1718, t1721;
  double t1724, t1733, t1736, t1739, t1740, t1749, t1750, t1752;
  double t1759, t1761, t1762, t1767, tv3rhosigma211, t1769, t1772, t1773;
  double t1781, t1782, t1786, t1789, t1794, t1800, t1807, t1810;
  double t1813, t1816, t1820, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1821, t1822, t1830, t1831;
  double t1834, t1842, t1845, t1850, t1852, t1859, t1862, t1865;
  double t1868, t1872, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t44 = 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t57 = t49 * t50 * t54 / 0.576e3;
  t58 = t40 / 0.24e2 + t57;
  t59 = t29 * t29;
  t60 = 0.1e1 / t59;
  t61 = t50 * sigma[0];
  t62 = t60 * t61;
  t63 = t51 * t51;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + t57 + t62 * t64 / 0.2304e4;
  t68 = 0.1e1 / t67;
  t69 = t58 * t68;
  t71 = (0.1804e1 - t44) * t28;
  t72 = t32 * sigma[0];
  t76 = -t71 * t72 * t38 / 0.24e2 + 0.6525e-1;
  t78 = 0.1804e1 - t44 + t69 * t76;
  t82 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t78);
  t83 = rho[1] <= p->dens_threshold;
  t84 = -t16;
  t86 = my_piecewise5(t14, t11, t10, t15, t84 * t7);
  t87 = 0.1e1 + t86;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t22, t89 * t87);
  t92 = t91 * t26;
  t93 = rho[1] * rho[1];
  t94 = POW_1_3(rho[1]);
  t95 = t94 * t94;
  t97 = 0.1e1 / t95 / t93;
  t99 = t33 * sigma[2] * t97;
  t101 = 0.804e0 + 0.5e1 / 0.972e3 * t99;
  t103 = 0.646416e0 / t101;
  t105 = sigma[2] * sigma[2];
  t106 = t93 * t93;
  t107 = t106 * rho[1];
  t109 = 0.1e1 / t94 / t107;
  t112 = t49 * t105 * t109 / 0.576e3;
  t113 = t99 / 0.24e2 + t112;
  t114 = t105 * sigma[2];
  t115 = t60 * t114;
  t116 = t106 * t106;
  t117 = 0.1e1 / t116;
  t120 = 0.1e1 + t112 + t115 * t117 / 0.2304e4;
  t121 = 0.1e1 / t120;
  t122 = t113 * t121;
  t124 = (0.1804e1 - t103) * t28;
  t125 = t32 * sigma[2];
  t129 = -t124 * t125 * t97 / 0.24e2 + 0.6525e-1;
  t131 = 0.1804e1 - t103 + t122 * t129;
  t135 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t131);
  tzk0 = t82 + t135;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = t6 * t6;
  t137 = 0.1e1 / t136;
  t138 = t16 * t137;
  t140 = my_piecewise5(t10, 0, t14, 0, t7 - t138);
  t143 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t140);
  t144 = t143 * t26;
  t148 = t26 * t26;
  t149 = 0.1e1 / t148;
  t150 = t25 * t149;
  t153 = t5 * t150 * t78 / 0.8e1;
  t154 = t42 * t42;
  t155 = 0.1e1 / t154;
  t156 = t155 * t28;
  t157 = t34 * rho[0];
  t159 = 0.1e1 / t36 / t157;
  t160 = t72 * t159;
  t166 = t51 * t34;
  t168 = 0.1e1 / t35 / t166;
  t171 = t49 * t50 * t168 / 0.108e3;
  t172 = -t33 * sigma[0] * t159 / 0.9e1 - t171;
  t173 = t172 * t68;
  t175 = t67 * t67;
  t176 = 0.1e1 / t175;
  t177 = t58 * t176;
  t178 = t63 * rho[0];
  t179 = 0.1e1 / t178;
  t182 = -t171 - t62 * t179 / 0.288e3;
  t183 = t76 * t182;
  t185 = t155 * t46;
  t186 = t48 * t50;
  t192 = 0.36946502057613168724e-3 * t185 * t186 * t168 + t71 * t160 / 0.9e1;
  t194 = -0.88671604938271604938e-2 * t156 * t160 + t173 * t76 - t177 * t183 + t69 * t192;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t78 - t153 - 0.3e1 / 0.8e1 * t5 * t27 * t194);
  t200 = t84 * t137;
  t202 = my_piecewise5(t14, 0, t10, 0, -t7 - t200);
  t205 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t202);
  t206 = t205 * t26;
  t210 = t91 * t149;
  t213 = t5 * t210 * t131 / 0.8e1;
  t215 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t131 - t213);
  tvrho0 = t82 + t135 + t6 * (t199 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t219 = my_piecewise5(t10, 0, t14, 0, -t7 - t138);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t78 - t153);
  t230 = my_piecewise5(t14, 0, t10, 0, t7 - t200);
  t233 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t230);
  t234 = t233 * t26;
  t238 = t101 * t101;
  t239 = 0.1e1 / t238;
  t240 = t239 * t28;
  t241 = t93 * rho[1];
  t243 = 0.1e1 / t95 / t241;
  t244 = t125 * t243;
  t250 = t106 * t93;
  t252 = 0.1e1 / t94 / t250;
  t255 = t49 * t105 * t252 / 0.108e3;
  t256 = -t33 * sigma[2] * t243 / 0.9e1 - t255;
  t257 = t256 * t121;
  t259 = t120 * t120;
  t260 = 0.1e1 / t259;
  t261 = t113 * t260;
  t262 = t116 * rho[1];
  t263 = 0.1e1 / t262;
  t266 = -t255 - t115 * t263 / 0.288e3;
  t267 = t129 * t266;
  t269 = t239 * t46;
  t270 = t48 * t105;
  t276 = 0.36946502057613168724e-3 * t269 * t270 * t252 + t124 * t244 / 0.9e1;
  t278 = -0.88671604938271604938e-2 * t240 * t244 + t257 * t129 - t261 * t267 + t122 * t276;
  t283 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t131 - t213 - 0.3e1 / 0.8e1 * t5 * t92 * t278);
  tvrho1 = t82 + t135 + t6 * (t228 + t283);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t286 = t32 * t38;
  t293 = t49 * sigma[0] * t54 / 0.288e3;
  t294 = t33 * t38 / 0.24e2 + t293;
  t295 = t294 * t68;
  t297 = t60 * t50;
  t300 = t293 + t297 * t64 / 0.768e3;
  t301 = t76 * t300;
  t303 = t48 * t54;
  t309 = -0.13854938271604938272e-3 * t185 * t303 * sigma[0] - t71 * t286 / 0.24e2;
  t311 = 0.33251851851851851852e-2 * t156 * t286 + t295 * t76 - t177 * t301 + t69 * t309;
  t315 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t311);
  tvsigma0 = t6 * t315;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t316 = t32 * t97;
  t323 = t49 * sigma[2] * t109 / 0.288e3;
  t324 = t33 * t97 / 0.24e2 + t323;
  t325 = t324 * t121;
  t327 = t60 * t105;
  t330 = t323 + t327 * t117 / 0.768e3;
  t331 = t129 * t330;
  t333 = t48 * t109;
  t339 = -0.13854938271604938272e-3 * t269 * t333 * sigma[2] - t124 * t316 / 0.24e2;
  t341 = 0.33251851851851851852e-2 * t240 * t316 + t325 * t129 - t261 * t331 + t122 * t339;
  t345 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t341);
  tvsigma2 = t6 * t345;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t348 = t23 * t23;
  t349 = 0.1e1 / t348;
  t350 = t140 * t140;
  t353 = t136 * t6;
  t354 = 0.1e1 / t353;
  t355 = t16 * t354;
  t358 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t137 + 0.2e1 * t355);
  t362 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t23 * t358);
  t363 = t362 * t26;
  t367 = t143 * t149;
  t369 = t5 * t367 * t78;
  t375 = 0.1e1 / t148 / t6;
  t376 = t25 * t375;
  t379 = t5 * t376 * t78 / 0.12e2;
  t381 = t5 * t150 * t194;
  t384 = 0.1e1 / t154 / t42;
  t385 = t384 * t46;
  t386 = t51 * t157;
  t388 = 0.1e1 / t35 / t386;
  t389 = t186 * t388;
  t393 = 0.1e1 / t36 / t51;
  t394 = t72 * t393;
  t402 = 0.19e2 / 0.324e3 * t49 * t50 * t388;
  t403 = 0.11e2 / 0.27e2 * t33 * sigma[0] * t393 + t402;
  t404 = t403 * t68;
  t406 = t172 * t176;
  t412 = 0.1e1 / t175 / t67;
  t413 = t58 * t412;
  t414 = t182 * t182;
  t415 = t76 * t414;
  t418 = t192 * t182;
  t421 = t63 * t34;
  t422 = 0.1e1 / t421;
  t425 = t402 + t62 * t422 / 0.32e2;
  t426 = t76 * t425;
  t428 = t384 * t60;
  t436 = 0.60817287337634845636e-4 * t428 * t61 * t422 - 0.33251851851851851852e-2 * t185 * t389 - 0.11e2 / 0.27e2 * t71 * t394;
  t438 = -0.24326914935053938255e-3 * t385 * t389 + 0.32512921810699588477e-1 * t156 * t394 + t404 * t76 - 0.2e1 * t406 * t183 + 0.2e1 * t173 * t192 + 0.2e1 * t413 * t415 - 0.2e1 * t177 * t418 - t177 * t426 + t69 * t436;
  t443 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t78 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t194 + t379 - t381 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t438);
  t444 = t89 * t89;
  t445 = 0.1e1 / t444;
  t446 = t202 * t202;
  t449 = t84 * t354;
  t452 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t137 + 0.2e1 * t449);
  t456 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t446 + 0.4e1 / 0.3e1 * t89 * t452);
  t457 = t456 * t26;
  t461 = t205 * t149;
  t463 = t5 * t461 * t131;
  t465 = t91 * t375;
  t468 = t5 * t465 * t131 / 0.12e2;
  t470 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t131 - t463 / 0.4e1 + t468);
  tv2rho20 = 0.2e1 * t199 + 0.2e1 * t215 + t6 * (t443 + t470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t473 = t349 * t219;
  t477 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t355);
  t481 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t473 * t140 + 0.4e1 / 0.3e1 * t23 * t477);
  t482 = t481 * t26;
  t486 = t222 * t149;
  t488 = t5 * t486 * t78;
  t496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t78 - t488 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t194 - t369 / 0.8e1 + t379 - t381 / 0.8e1);
  t497 = t445 * t230;
  t501 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t449);
  t505 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t497 * t202 + 0.4e1 / 0.3e1 * t89 * t501);
  t506 = t505 * t26;
  t510 = t233 * t149;
  t512 = t5 * t510 * t131;
  t519 = t5 * t210 * t278;
  t522 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t131 - t512 / 0.8e1 - t463 / 0.8e1 + t468 - 0.3e1 / 0.8e1 * t5 * t206 * t278 - t519 / 0.8e1);
  tv2rho21 = t199 + t215 + t228 + t283 + t6 * (t496 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t527 = t219 * t219;
  t532 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t137 + 0.2e1 * t355);
  t536 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t527 + 0.4e1 / 0.3e1 * t23 * t532);
  t537 = t536 * t26;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t78 - t488 / 0.4e1 + t379);
  t544 = t230 * t230;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t137 + 0.2e1 * t449);
  t553 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t544 + 0.4e1 / 0.3e1 * t89 * t549);
  t554 = t553 * t26;
  t564 = 0.1e1 / t238 / t101;
  t565 = t564 * t46;
  t566 = t106 * t241;
  t568 = 0.1e1 / t94 / t566;
  t569 = t270 * t568;
  t573 = 0.1e1 / t95 / t106;
  t574 = t125 * t573;
  t582 = 0.19e2 / 0.324e3 * t49 * t105 * t568;
  t583 = 0.11e2 / 0.27e2 * t33 * sigma[2] * t573 + t582;
  t584 = t583 * t121;
  t586 = t256 * t260;
  t592 = 0.1e1 / t259 / t120;
  t593 = t113 * t592;
  t594 = t266 * t266;
  t595 = t129 * t594;
  t598 = t276 * t266;
  t601 = t116 * t93;
  t602 = 0.1e1 / t601;
  t605 = t582 + t115 * t602 / 0.32e2;
  t606 = t129 * t605;
  t608 = t564 * t60;
  t616 = 0.60817287337634845636e-4 * t608 * t114 * t602 - 0.33251851851851851852e-2 * t269 * t569 - 0.11e2 / 0.27e2 * t124 * t574;
  t618 = -0.24326914935053938255e-3 * t565 * t569 + 0.32512921810699588477e-1 * t240 * t574 + t584 * t129 - 0.2e1 * t586 * t267 + 0.2e1 * t257 * t276 + 0.2e1 * t593 * t595 - 0.2e1 * t261 * t598 - t261 * t606 + t122 * t616;
  t623 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t131 - t512 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t278 + t468 - t519 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t283 + t6 * (t543 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t150 * t311 / 0.8e1;
  t632 = t48 * t168;
  t633 = t632 * sigma[0];
  t636 = t32 * t159;
  t643 = t49 * sigma[0] * t168 / 0.54e2;
  t644 = -t33 * t159 / 0.9e1 - t643;
  t645 = t644 * t68;
  t647 = t294 * t176;
  t651 = t301 * t182;
  t654 = t192 * t300;
  t658 = -t643 - t297 * t179 / 0.96e2;
  t659 = t76 * t658;
  t662 = t309 * t182;
  t671 = -0.22806482751613067114e-4 * t428 * t179 * t50 + 0.11083950617283950618e-2 * t185 * t633 + t71 * t636 / 0.9e1;
  t673 = 0.91225931006452268455e-4 * t385 * t633 - 0.88671604938271604939e-2 * t156 * t636 + t645 * t76 - t647 * t183 + t295 * t192 - t406 * t301 + 0.2e1 * t413 * t651 - t177 * t654 - t177 * t659 + t173 * t309 - t177 * t662 + t69 * t671;
  t678 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t311 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t673);
  tv2rhosigma0 = t6 * t678 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t685 = t5 * t210 * t341 / 0.8e1;
  t687 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t341 - t685);
  tv2rhosigma2 = t6 * t687 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t693 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t311 - t631);
  tv2rhosigma3 = t6 * t693 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t48 * t252;
  t699 = t698 * sigma[2];
  t702 = t32 * t243;
  t709 = t49 * sigma[2] * t252 / 0.54e2;
  t710 = -t33 * t243 / 0.9e1 - t709;
  t711 = t710 * t121;
  t713 = t324 * t260;
  t717 = t331 * t266;
  t720 = t276 * t330;
  t724 = -t709 - t327 * t263 / 0.96e2;
  t725 = t129 * t724;
  t728 = t339 * t266;
  t737 = -0.22806482751613067114e-4 * t608 * t263 * t105 + 0.11083950617283950618e-2 * t269 * t699 + t124 * t702 / 0.9e1;
  t739 = 0.91225931006452268455e-4 * t565 * t699 - 0.88671604938271604939e-2 * t240 * t702 + t711 * t129 - t713 * t267 + t325 * t276 - t586 * t331 + 0.2e1 * t593 * t717 - t261 * t720 - t261 * t725 + t257 * t339 - t261 * t728 + t122 * t737;
  t744 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t341 - t685 - 0.3e1 / 0.8e1 * t5 * t92 * t739);
  tv2rhosigma5 = t6 * t744 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t748 = t54 * t68;
  t756 = t300 * t300;
  t757 = t76 * t756;
  t760 = t309 * t300;
  t763 = t49 * t54;
  t765 = t60 * sigma[0];
  t768 = t763 / 0.288e3 + t765 * t64 / 0.384e3;
  t769 = t76 * t768;
  t776 = 0.85524310318549001679e-5 * t428 * t64 * sigma[0] - 0.27709876543209876544e-3 * t185 * t303;
  t778 = -0.34209724127419600671e-4 * t385 * t303 + t49 * t748 * t76 / 0.288e3 - 0.2e1 * t647 * t301 + 0.2e1 * t295 * t309 + 0.2e1 * t413 * t757 - 0.2e1 * t177 * t760 - t177 * t769 + t69 * t776;
  t782 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t778);
  tv2sigma20 = t6 * t782;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t785 = t109 * t121;
  t793 = t330 * t330;
  t794 = t129 * t793;
  t797 = t339 * t330;
  t800 = t49 * t109;
  t802 = t60 * sigma[2];
  t805 = t800 / 0.288e3 + t802 * t117 / 0.384e3;
  t806 = t129 * t805;
  t813 = 0.85524310318549001679e-5 * t608 * t117 * sigma[2] - 0.27709876543209876544e-3 * t269 * t333;
  t815 = -0.34209724127419600671e-4 * t565 * t333 + t49 * t785 * t129 / 0.288e3 - 0.2e1 * t713 * t331 + 0.2e1 * t325 * t339 + 0.2e1 * t593 * t794 - 0.2e1 * t261 * t797 - t261 * t806 + t122 * t813;
  t819 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t815);
  tv2sigma25 = t6 * t819;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t823 = 0.1e1 / t348 / t19;
  t824 = t350 * t140;
  t827 = t349 * t140;
  t830 = t136 * t136;
  t831 = 0.1e1 / t830;
  t832 = t16 * t831;
  t835 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t354 - 0.6e1 * t832);
  t839 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t823 * t824 + 0.4e1 / 0.3e1 * t827 * t358 + 0.4e1 / 0.3e1 * t23 * t835);
  t840 = t839 * t26;
  t844 = t362 * t149;
  t846 = t5 * t844 * t78;
  t851 = t143 * t375;
  t853 = t5 * t851 * t78;
  t856 = t5 * t367 * t194;
  t862 = 0.1e1 / t148 / t136;
  t863 = t25 * t862;
  t866 = 0.5e1 / 0.36e2 * t5 * t863 * t78;
  t868 = t5 * t376 * t194;
  t871 = t5 * t150 * t438;
  t873 = t175 * t175;
  t874 = 0.1e1 / t873;
  t875 = t58 * t874;
  t876 = t414 * t182;
  t877 = t76 * t876;
  t880 = t183 * t425;
  t883 = t172 * t412;
  t887 = 0.1e1 / t35 / t63;
  t888 = t186 * t887;
  t892 = 0.1e1 / t36 / t52;
  t893 = t72 * t892;
  t896 = t436 * t182;
  t899 = t192 * t425;
  t904 = 0.209e3 / 0.486e3 * t49 * t50 * t887;
  t905 = t63 * t157;
  t906 = 0.1e1 / t905;
  t909 = -t904 - 0.5e1 / 0.16e2 * t62 * t906;
  t910 = t76 * t909;
  t912 = t154 * t154;
  t914 = 0.1e1 / t912 * t60;
  t915 = t61 * t906;
  t918 = t403 * t176;
  t925 = t192 * t414;
  t931 = -0.154e3 / 0.81e2 * t33 * sigma[0] * t892 - t904;
  t932 = t931 * t68;
  t938 = t50 * t50;
  t939 = t914 * t938;
  t940 = t63 * t52;
  t942 = 0.1e1 / t36 / t940;
  t953 = 0.25027690262401171044e-5 * t939 * t942 * t28 * t32 - 0.11555284594150620671e-2 * t428 * t915 + 0.27997238225880201189e-1 * t185 * t888 + 0.154e3 / 0.81e2 * t71 * t893;
  t955 = -0.6e1 * t875 * t877 + 0.6e1 * t413 * t880 + 0.6e1 * t883 * t415 + 0.2675960642855933208e-2 * t385 * t888 - 0.15172696844993141289e0 * t156 * t893 - 0.3e1 * t177 * t896 - 0.3e1 * t177 * t899 - t177 * t910 - 0.60066456629762810506e-4 * t914 * t915 - 0.3e1 * t918 * t183 - 0.6e1 * t406 * t418 - 0.3e1 * t406 * t426 + 0.6e1 * t413 * t925 + t932 * t76 + 0.3e1 * t404 * t192 + 0.3e1 * t173 * t436 + t69 * t953;
  t960 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t840 * t78 - 0.3e1 / 0.8e1 * t846 - 0.9e1 / 0.8e1 * t5 * t363 * t194 + t853 / 0.4e1 - 0.3e1 / 0.4e1 * t856 - 0.9e1 / 0.8e1 * t5 * t144 * t438 - t866 + t868 / 0.4e1 - 0.3e1 / 0.8e1 * t871 - 0.3e1 / 0.8e1 * t5 * t27 * t955);
  t962 = 0.1e1 / t444 / t87;
  t963 = t446 * t202;
  t966 = t445 * t202;
  t969 = t84 * t831;
  t972 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t354 - 0.6e1 * t969);
  t976 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t962 * t963 + 0.4e1 / 0.3e1 * t966 * t452 + 0.4e1 / 0.3e1 * t89 * t972);
  t977 = t976 * t26;
  t981 = t456 * t149;
  t983 = t5 * t981 * t131;
  t985 = t205 * t375;
  t987 = t5 * t985 * t131;
  t989 = t91 * t862;
  t992 = 0.5e1 / 0.36e2 * t5 * t989 * t131;
  t994 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t977 * t131 - 0.3e1 / 0.8e1 * t983 + t987 / 0.4e1 - t992);
  tv3rho30 = 0.3e1 * t443 + 0.3e1 * t470 + t6 * (t960 + t994);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t997 = 0.2e1 * t496;
  t998 = 0.2e1 * t522;
  t999 = t823 * t219;
  t1002 = t349 * t477;
  t1007 = 0.2e1 * t354;
  t1008 = 0.6e1 * t832;
  t1010 = my_piecewise5(t10, 0, t14, 0, t1007 - t1008);
  t1014 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t999 * t350 + 0.8e1 / 0.9e1 * t1002 * t140 + 0.4e1 / 0.9e1 * t473 * t358 + 0.4e1 / 0.3e1 * t23 * t1010);
  t1015 = t1014 * t26;
  t1019 = t481 * t149;
  t1022 = t5 * t1019 * t78 / 0.4e1;
  t1026 = t222 * t375;
  t1028 = t5 * t1026 * t78;
  t1032 = t5 * t486 * t194 / 0.4e1;
  t1041 = -0.3e1 / 0.8e1 * t5 * t1015 * t78 - t1022 - 0.3e1 / 0.4e1 * t5 * t482 * t194 + t1028 / 0.12e2 - t1032 - 0.3e1 / 0.8e1 * t5 * t223 * t438 - t846 / 0.8e1 + t853 / 0.6e1 - t856 / 0.4e1 - t866 + t868 / 0.6e1 - t871 / 0.8e1;
  t1042 = my_piecewise3(t1, 0, t1041);
  t1043 = t962 * t230;
  t1046 = t445 * t501;
  t1051 = 0.6e1 * t969;
  t1053 = my_piecewise5(t14, 0, t10, 0, -t1007 - t1051);
  t1057 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1043 * t446 + 0.8e1 / 0.9e1 * t1046 * t202 + 0.4e1 / 0.9e1 * t497 * t452 + 0.4e1 / 0.3e1 * t89 * t1053);
  t1058 = t1057 * t26;
  t1062 = t505 * t149;
  t1065 = t5 * t1062 * t131 / 0.4e1;
  t1066 = t233 * t375;
  t1068 = t5 * t1066 * t131;
  t1077 = t5 * t461 * t278 / 0.4e1;
  t1079 = t5 * t465 * t278;
  t1082 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1058 * t131 - t1065 + t1068 / 0.12e2 - t983 / 0.8e1 + t987 / 0.6e1 - t992 - 0.3e1 / 0.8e1 * t5 * t457 * t278 - t1077 + t1079 / 0.12e2);
  tv3rho31 = t443 + t470 + t997 + t998 + t6 * (t1042 + t1082);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1085 = t823 * t527;
  t1090 = t349 * t532;
  t1094 = my_piecewise5(t10, 0, t14, 0, -t1007 - t1008);
  t1098 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1085 * t140 + 0.8e1 / 0.9e1 * t473 * t477 + 0.4e1 / 0.9e1 * t1090 * t140 + 0.4e1 / 0.3e1 * t23 * t1094);
  t1099 = t1098 * t26;
  t1103 = t536 * t149;
  t1105 = t5 * t1103 * t78;
  t1114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1099 * t78 - t1105 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t537 * t194 - t1022 + t1028 / 0.6e1 - t1032 + t853 / 0.12e2 - t866 + t868 / 0.12e2);
  t1115 = t962 * t544;
  t1120 = t445 * t549;
  t1124 = my_piecewise5(t14, 0, t10, 0, t1007 - t1051);
  t1128 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1115 * t202 + 0.8e1 / 0.9e1 * t497 * t501 + 0.4e1 / 0.9e1 * t1120 * t202 + 0.4e1 / 0.3e1 * t89 * t1124);
  t1129 = t1128 * t26;
  t1133 = t553 * t149;
  t1135 = t5 * t1133 * t131;
  t1142 = t5 * t510 * t278;
  t1150 = t5 * t210 * t618;
  t1152 = -0.3e1 / 0.8e1 * t5 * t1129 * t131 - t1135 / 0.8e1 - t1065 + t1068 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t506 * t278 - t1142 / 0.4e1 + t987 / 0.12e2 - t992 - t1077 + t1079 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t618 - t1150 / 0.8e1;
  t1153 = my_piecewise3(t83, 0, t1152);
  tv3rho32 = t997 + t998 + t543 + t623 + t6 * (t1114 + t1153);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1158 = t527 * t219;
  t1165 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t354 - 0.6e1 * t832);
  t1169 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t823 * t1158 + 0.4e1 / 0.3e1 * t473 * t532 + 0.4e1 / 0.3e1 * t23 * t1165);
  t1170 = t1169 * t26;
  t1177 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1170 * t78 - 0.3e1 / 0.8e1 * t1105 + t1028 / 0.4e1 - t866);
  t1178 = t544 * t230;
  t1185 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t354 - 0.6e1 * t969);
  t1189 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t962 * t1178 + 0.4e1 / 0.3e1 * t497 * t549 + 0.4e1 / 0.3e1 * t89 * t1185);
  t1190 = t1189 * t26;
  t1205 = t238 * t238;
  t1207 = 0.1e1 / t1205 * t60;
  t1208 = t105 * t105;
  t1209 = t1207 * t1208;
  t1210 = t116 * t107;
  t1212 = 0.1e1 / t95 / t1210;
  t1217 = t116 * t241;
  t1218 = 0.1e1 / t1217;
  t1219 = t114 * t1218;
  t1223 = 0.1e1 / t94 / t116;
  t1224 = t270 * t1223;
  t1228 = 0.1e1 / t95 / t107;
  t1229 = t125 * t1228;
  t1232 = 0.25027690262401171044e-5 * t1209 * t1212 * t28 * t32 - 0.11555284594150620671e-2 * t608 * t1219 + 0.27997238225880201189e-1 * t269 * t1224 + 0.154e3 / 0.81e2 * t124 * t1229;
  t1239 = 0.209e3 / 0.486e3 * t49 * t105 * t1223;
  t1240 = -0.154e3 / 0.81e2 * t33 * sigma[2] * t1228 - t1239;
  t1241 = t1240 * t121;
  t1247 = t256 * t592;
  t1250 = t259 * t259;
  t1251 = 0.1e1 / t1250;
  t1252 = t113 * t1251;
  t1253 = t594 * t266;
  t1254 = t129 * t1253;
  t1257 = t267 * t605;
  t1264 = t276 * t594;
  t1267 = t616 * t266;
  t1270 = t276 * t605;
  t1275 = -t1239 - 0.5e1 / 0.16e2 * t115 * t1218;
  t1276 = t129 * t1275;
  t1280 = t583 * t260;
  t1287 = t122 * t1232 + t1241 * t129 + 0.3e1 * t584 * t276 + 0.3e1 * t257 * t616 + 0.6e1 * t1247 * t595 - 0.6e1 * t1252 * t1254 + 0.6e1 * t593 * t1257 + 0.2675960642855933208e-2 * t565 * t1224 - 0.15172696844993141289e0 * t240 * t1229 + 0.6e1 * t593 * t1264 - 0.3e1 * t261 * t1267 - 0.3e1 * t261 * t1270 - t261 * t1276 - 0.60066456629762810506e-4 * t1207 * t1219 - 0.3e1 * t1280 * t267 - 0.6e1 * t586 * t598 - 0.3e1 * t586 * t606;
  t1292 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1190 * t131 - 0.3e1 / 0.8e1 * t1135 - 0.9e1 / 0.8e1 * t5 * t554 * t278 + t1068 / 0.4e1 - 0.3e1 / 0.4e1 * t1142 - 0.9e1 / 0.8e1 * t5 * t234 * t618 - t992 + t1079 / 0.4e1 - 0.3e1 / 0.8e1 * t1150 - 0.3e1 / 0.8e1 * t5 * t92 * t1287);
  tv3rho33 = 0.3e1 * t543 + 0.3e1 * t623 + t6 * (t1177 + t1292);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1300 = t5 * t367 * t311;
  t1307 = t5 * t376 * t311 / 0.12e2;
  t1309 = t5 * t150 * t673;
  t1317 = t63 * t51;
  t1319 = 0.1e1 / t36 / t1317;
  t1320 = t914 * t1319;
  t1322 = t61 * t28 * t32;
  t1325 = t422 * t50;
  t1328 = t48 * t388;
  t1329 = t1328 * sigma[0];
  t1332 = t32 * t393;
  t1335 = -0.93853838484004391416e-6 * t1320 * t1322 + 0.38771020677742214095e-3 * t428 * t1325 - 0.80050754458161865574e-2 * t185 * t1329 - 0.11e2 / 0.27e2 * t71 * t1332;
  t1341 = 0.19e2 / 0.162e3 * t49 * sigma[0] * t388;
  t1342 = 0.11e2 / 0.27e2 * t33 * t393 + t1341;
  t1343 = t1342 * t68;
  t1347 = t301 * t414;
  t1352 = t309 * t414;
  t1357 = t294 * t412;
  t1360 = t654 * t182;
  t1363 = t659 * t182;
  t1366 = 0.2e1 * t645 * t192 + t295 * t436 + t404 * t309 + 0.2e1 * t173 * t671 + t69 * t1335 + t1343 * t76 + 0.4e1 * t883 * t651 - 0.6e1 * t875 * t1347 - 0.8210333790580704161e-3 * t385 * t1329 + 0.2e1 * t413 * t1352 + 0.32512921810699588478e-1 * t156 * t1332 + 0.2e1 * t1357 * t415 + 0.4e1 * t413 * t1360 + 0.4e1 * t413 * t1363;
  t1367 = t301 * t425;
  t1372 = t1341 + 0.3e1 / 0.32e2 * t297 * t422;
  t1373 = t76 * t1372;
  t1377 = t671 * t182;
  t1380 = t309 * t425;
  t1384 = t644 * t176;
  t1395 = t436 * t300;
  t1397 = t192 * t658;
  t1400 = 0.2e1 * t413 * t1367 - t177 * t1373 - 0.2e1 * t406 * t662 - 0.2e1 * t177 * t1377 - t177 * t1380 + 0.2252492123616105394e-4 * t914 * t1325 - 0.2e1 * t1384 * t183 - 0.2e1 * t647 * t418 - t647 * t426 - t918 * t301 - 0.2e1 * t406 * t654 - 0.2e1 * t406 * t659 - t177 * t1395 - 0.2e1 * t177 * t1397;
  t1401 = t1366 + t1400;
  t1406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t311 - t1300 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t673 + t1307 - t1309 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1401);
  tv3rho2sigma0 = t1406 * t6 + 0.2e1 * t678;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1413 = t5 * t461 * t341;
  t1417 = t5 * t465 * t341 / 0.12e2;
  t1419 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t341 - t1413 / 0.4e1 + t1417);
  tv3rho2sigma2 = t1419 * t6 + 0.2e1 * t687;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1425 = t5 * t486 * t311;
  t1433 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t311 - t1425 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t673 - t1300 / 0.8e1 + t1307 - t1309 / 0.8e1);
  tv3rho2sigma3 = t1433 * t6 + t678 + t693;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1439 = t5 * t510 * t341;
  t1446 = t5 * t210 * t739;
  t1449 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t341 - t1439 / 0.8e1 - t1413 / 0.8e1 + t1417 - 0.3e1 / 0.8e1 * t5 * t206 * t739 - t1446 / 0.8e1);
  tv3rho2sigma5 = t1449 * t6 + t687 + t744;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1457 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t311 - t1425 / 0.4e1 + t1307);
  tv3rho2sigma6 = t1457 * t6 + 0.2e1 * t693;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1472 = t616 * t330;
  t1474 = t276 * t724;
  t1477 = t339 * t605;
  t1479 = t602 * t105;
  t1482 = t710 * t260;
  t1489 = t720 * t266;
  t1492 = t725 * t266;
  t1495 = t331 * t605;
  t1498 = t331 * t594;
  t1501 = -0.2e1 * t586 * t720 - 0.2e1 * t586 * t725 - t261 * t1472 - 0.2e1 * t261 * t1474 - t261 * t1477 + 0.2252492123616105394e-4 * t1207 * t1479 - 0.2e1 * t1482 * t267 - 0.2e1 * t713 * t598 - t713 * t606 - t1280 * t331 + 0.4e1 * t593 * t1489 + 0.4e1 * t593 * t1492 + 0.2e1 * t593 * t1495 - 0.6e1 * t1252 * t1498;
  t1502 = t48 * t568;
  t1503 = t1502 * sigma[2];
  t1508 = t32 * t573;
  t1513 = 0.19e2 / 0.162e3 * t49 * sigma[2] * t568;
  t1516 = t1513 + 0.3e1 / 0.32e2 * t327 * t602;
  t1517 = t129 * t1516;
  t1521 = t737 * t266;
  t1524 = t339 * t594;
  t1527 = t324 * t592;
  t1532 = 0.11e2 / 0.27e2 * t33 * t573 + t1513;
  t1533 = t1532 * t121;
  t1541 = t116 * t106;
  t1543 = 0.1e1 / t95 / t1541;
  t1544 = t1207 * t1543;
  t1546 = t114 * t28 * t32;
  t1555 = -0.93853838484004391416e-6 * t1544 * t1546 + 0.38771020677742214095e-3 * t608 * t1479 - 0.80050754458161865574e-2 * t269 * t1503 - 0.11e2 / 0.27e2 * t124 * t1508;
  t1557 = -0.8210333790580704161e-3 * t565 * t1503 + 0.4e1 * t1247 * t717 + 0.32512921810699588478e-1 * t240 * t1508 - t261 * t1517 - 0.2e1 * t586 * t728 - 0.2e1 * t261 * t1521 + 0.2e1 * t593 * t1524 + 0.2e1 * t1527 * t595 + t1533 * t129 + 0.2e1 * t711 * t276 + t325 * t616 + t584 * t339 + 0.2e1 * t257 * t737 + t122 * t1555;
  t1558 = t1501 + t1557;
  t1563 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t341 - t1439 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t739 + t1417 - t1446 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * t1558);
  tv3rho2sigma8 = t1563 * t6 + 0.2e1 * t744;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1570 = t5 * t150 * t778 / 0.8e1;
  t1576 = t192 * t768;
  t1578 = t49 * t168;
  t1582 = -t1578 / 0.54e2 - t765 * t179 / 0.48e2;
  t1583 = t76 * t1582;
  t1585 = t776 * t182;
  t1587 = t179 * sigma[0];
  t1594 = t192 * t756;
  t1599 = t671 * t300;
  t1602 = t309 * t658;
  t1605 = -0.2e1 * t647 * t659 - 0.2e1 * t647 * t662 - t406 * t769 - t177 * t1576 - t177 * t1583 - t177 * t1585 - 0.84468454635603952274e-5 * t914 * t1587 - 0.2e1 * t1384 * t301 - 0.2e1 * t647 * t654 + 0.2e1 * t413 * t1594 - 0.2e1 * t406 * t760 - 0.2e1 * t177 * t1599 - 0.2e1 * t177 * t1602;
  t1610 = t757 * t182;
  t1613 = t301 * t658;
  t1616 = t760 * t182;
  t1619 = t769 * t182;
  t1622 = t168 * t68;
  t1631 = t176 * t76;
  t1632 = t1631 * t182;
  t1637 = 0.1e1 / t36 / t905;
  t1638 = t914 * t1637;
  t1640 = t50 * t28 * t32;
  t1647 = 0.35195189431501646781e-6 * t1638 * t1640 - 0.11403241375806533557e-3 * t428 * t1587 + 0.1477860082304526749e-2 * t185 * t632;
  t1653 = 0.2e1 * t883 * t757 + 0.18245186201290453691e-3 * t385 * t632 - 0.6e1 * t875 * t1610 + 0.4e1 * t413 * t1613 + 0.4e1 * t413 * t1616 + 0.2e1 * t413 * t1619 - t49 * t1622 * t76 / 0.54e2 + t49 * t748 * t192 / 0.288e3 + 0.4e1 * t1357 * t651 - t763 * t1632 / 0.288e3 + t173 * t776 + t69 * t1647 + 0.2e1 * t645 * t309 + 0.2e1 * t295 * t671;
  t1654 = t1605 + t1653;
  t1659 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t778 - t1570 - 0.3e1 / 0.8e1 * t5 * t27 * t1654);
  tv3rhosigma20 = t1659 * t6 + t782;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1666 = t5 * t210 * t815 / 0.8e1;
  t1668 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t815 - t1666);
  tv3rhosigma25 = t1668 * t6 + t819;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1674 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t778 - t1570);
  tv3rhosigma26 = t1674 * t6 + t782;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1681 = t737 * t330;
  t1684 = t339 * t724;
  t1694 = t276 * t793;
  t1699 = t276 * t805;
  t1701 = t49 * t252;
  t1705 = -t1701 / 0.54e2 - t802 * t263 / 0.48e2;
  t1706 = t129 * t1705;
  t1708 = t813 * t266;
  t1710 = t263 * sigma[2];
  t1713 = 0.18245186201290453691e-3 * t565 * t698 - 0.2e1 * t261 * t1681 - 0.2e1 * t261 * t1684 - t586 * t806 - 0.2e1 * t713 * t725 - 0.2e1 * t713 * t728 + 0.2e1 * t1247 * t794 + 0.2e1 * t593 * t1694 - 0.2e1 * t586 * t797 - t261 * t1699 - t261 * t1706 - t261 * t1708 - 0.84468454635603952274e-5 * t1207 * t1710;
  t1718 = t797 * t266;
  t1721 = t806 * t266;
  t1724 = t252 * t121;
  t1733 = t794 * t266;
  t1736 = t331 * t724;
  t1739 = t260 * t129;
  t1740 = t1739 * t266;
  t1749 = 0.1e1 / t95 / t1217;
  t1750 = t1207 * t1749;
  t1752 = t105 * t28 * t32;
  t1759 = 0.35195189431501646781e-6 * t1750 * t1752 - 0.11403241375806533557e-3 * t608 * t1710 + 0.1477860082304526749e-2 * t269 * t698;
  t1761 = -0.2e1 * t1482 * t331 - 0.2e1 * t713 * t720 + 0.4e1 * t593 * t1718 + 0.2e1 * t593 * t1721 - t49 * t1724 * t129 / 0.54e2 + t49 * t785 * t276 / 0.288e3 + 0.4e1 * t1527 * t717 - 0.6e1 * t1252 * t1733 + 0.4e1 * t593 * t1736 - t800 * t1740 / 0.288e3 + 0.2e1 * t711 * t339 + 0.2e1 * t325 * t737 + t257 * t813 + t122 * t1759;
  t1762 = t1713 + t1761;
  t1767 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t815 - t1666 - 0.3e1 / 0.8e1 * t5 * t92 * t1762);
  tv3rhosigma211 = t1767 * t6 + t819;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1769 = t301 * t768;
  t1772 = t76 * t60;
  t1773 = t1772 * t64;
  t1781 = t756 * t300;
  t1782 = t76 * t1781;
  t1786 = 0.1e1 / t36 / t421;
  t1789 = sigma[0] * t28 * t32;
  t1794 = -0.13198196036813117543e-6 * t914 * t1786 * t1789 + 0.25657293095564700504e-4 * t428 * t64;
  t1800 = t309 * t768;
  t1807 = t309 * t756;
  t1810 = t776 * t300;
  t1813 = t1631 * t300;
  t1816 = 0.6e1 * t413 * t1769 - t177 * t1773 / 0.384e3 + t49 * t748 * t309 / 0.96e2 + 0.6e1 * t1357 * t757 - 0.6e1 * t875 * t1782 + t69 * t1794 + 0.31675670488351482103e-5 * t914 * t64 + 0.3e1 * t295 * t776 - 0.3e1 * t177 * t1800 - 0.6e1 * t647 * t760 - 0.3e1 * t647 * t769 + 0.6e1 * t413 * t1807 - 0.3e1 * t177 * t1810 - t763 * t1813 / 0.96e2;
  t1820 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1816);
  tv3sigma30 = t6 * t1820;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1821 = t129 * t60;
  t1822 = t1821 * t117;
  t1830 = t793 * t330;
  t1831 = t129 * t1830;
  t1834 = t331 * t805;
  t1842 = 0.1e1 / t95 / t601;
  t1845 = sigma[2] * t28 * t32;
  t1850 = -0.13198196036813117543e-6 * t1207 * t1842 * t1845 + 0.25657293095564700504e-4 * t608 * t117;
  t1852 = t339 * t805;
  t1859 = t339 * t793;
  t1862 = t813 * t330;
  t1865 = t1739 * t330;
  t1868 = -t261 * t1822 / 0.384e3 + t49 * t785 * t339 / 0.96e2 + 0.6e1 * t1527 * t794 - 0.6e1 * t1252 * t1831 + 0.6e1 * t593 * t1834 + 0.31675670488351482103e-5 * t1207 * t117 + 0.3e1 * t325 * t813 + t122 * t1850 - 0.3e1 * t261 * t1852 - 0.6e1 * t713 * t797 - 0.3e1 * t713 * t806 + 0.6e1 * t593 * t1859 - 0.3e1 * t261 * t1862 - t800 * t1865 / 0.96e2;
  t1872 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t1868);
  tv3sigma39 = t6 * t1872;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t44, t46, t48, t49, t50, t51, t52, t54;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t67, t68, t69, t71, t72, t76, t78, t82;
  double t83, t84, t86, t87, t88, t89, t91, t92;
  double t93, t94, t95, t97, t99, t101, t103, t105;
  double t106, t107, t109, t112, t113, t114, t115, t116;
  double t117, t120, t121, t122, t124, t125, t129, t131;
  double t135, tzk0;

  double t136, t137, t138, t140, t143, t144, t148, t149;
  double t150, t153, t154, t155, t156, t157, t159, t160;
  double t166, t168, t171, t172, t173, t175, t176, t177;
  double t178, t179, t182, t183, t185, t186, t192, t194;
  double t199, t200, t202, t205, t206, t210, t213, t215;
  double tvrho0, t219, t222, t223, t228, t230, t233, t234;
  double t238, t239, t240, t241, t243, t244, t250, t252;
  double t255, t256, t257, t259, t260, t261, t262, t263;
  double t266, t267, t269, t270, t276, t278, t283, tvrho1;
  double t286, t293, t294, t295, t297, t300, t301, t303;
  double t309, t311, t315, tvsigma0, tvsigma1, t316, t323, t324;
  double t325, t327, t330, t331, t333, t339, t341, t345;
  double tvsigma2;

  double t348, t349, t350, t353, t354, t355, t358, t362;
  double t363, t367, t369, t375, t376, t379, t381, t384;
  double t385, t386, t388, t389, t393, t394, t402, t403;
  double t404, t406, t412, t413, t414, t415, t418, t421;
  double t422, t425, t426, t428, t436, t438, t443, t444;
  double t445, t446, t449, t452, t456, t457, t461, t463;
  double t465, t468, t470, tv2rho20, t473, t477, t481, t482;
  double t486, t488, t496, t497, t501, t505, t506, t510;
  double t512, t519, t522, tv2rho21, t527, t532, t536, t537;
  double t543, t544, t549, t553, t554, t564, t565, t566;
  double t568, t569, t573, t574, t582, t583, t584, t586;
  double t592, t593, t594, t595, t598, t601, t602, t605;
  double t606, t608, t616, t618, t623, tv2rho22, t631, t632;
  double t633, t636, t643, t644, t645, t647, t651, t654;
  double t658, t659, t662, t671, t673, t678, tv2rhosigma0, tv2rhosigma1;
  double t685, t687, tv2rhosigma2, t693, tv2rhosigma3, tv2rhosigma4, t698, t699;
  double t702, t709, t710, t711, t713, t717, t720, t724;
  double t725, t728, t737, t739, t744, tv2rhosigma5, t748, t756;
  double t757, t760, t763, t765, t768, t769, t776, t778;
  double t782, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t785, t793;
  double t794, t797, t800, t802, t805, t806, t813, t815;
  double t819, tv2sigma25;

  double t823, t824, t827, t830, t831, t832, t835, t839;
  double t840, t844, t846, t851, t853, t856, t862, t863;
  double t866, t868, t871, t873, t874, t875, t876, t877;
  double t880, t883, t887, t888, t892, t893, t896, t899;
  double t904, t905, t906, t909, t910, t912, t914, t915;
  double t918, t925, t931, t932, t938, t939, t940, t942;
  double t953, t955, t960, t962, t963, t966, t969, t972;
  double t976, t977, t981, t983, t985, t987, t989, t992;
  double t994, tv3rho30, t997, t998, t999, t1002, t1007, t1008;
  double t1010, t1014, t1015, t1019, t1022, t1026, t1028, t1032;
  double t1041, t1042, t1043, t1046, t1051, t1053, t1057, t1058;
  double t1062, t1065, t1066, t1068, t1077, t1079, t1082, tv3rho31;
  double t1085, t1090, t1094, t1098, t1099, t1103, t1105, t1114;
  double t1115, t1120, t1124, t1128, t1129, t1133, t1135, t1142;
  double t1150, t1152, t1153, tv3rho32, t1158, t1165, t1169, t1170;
  double t1177, t1178, t1185, t1189, t1190, t1205, t1207, t1208;
  double t1209, t1210, t1212, t1217, t1218, t1219, t1223, t1224;
  double t1228, t1229, t1232, t1239, t1240, t1241, t1247, t1250;
  double t1251, t1252, t1253, t1254, t1257, t1264, t1267, t1270;
  double t1275, t1276, t1280, t1287, t1292, tv3rho33, t1300, t1307;
  double t1309, t1317, t1319, t1320, t1322, t1325, t1328, t1329;
  double t1332, t1335, t1341, t1342, t1343, t1347, t1352, t1357;
  double t1360, t1363, t1366, t1367, t1372, t1373, t1377, t1380;
  double t1384, t1395, t1397, t1400, t1401, t1406, tv3rho2sigma0, tv3rho2sigma1;
  double t1413, t1417, t1419, tv3rho2sigma2, t1425, t1433, tv3rho2sigma3, tv3rho2sigma4;
  double t1439, t1446, t1449, tv3rho2sigma5, t1457, tv3rho2sigma6, tv3rho2sigma7, t1472;
  double t1474, t1477, t1479, t1482, t1489, t1492, t1495, t1498;
  double t1501, t1502, t1503, t1508, t1513, t1516, t1517, t1521;
  double t1524, t1527, t1532, t1533, t1541, t1543, t1544, t1546;
  double t1555, t1557, t1558, t1563, tv3rho2sigma8, t1570, t1576, t1578;
  double t1582, t1583, t1585, t1587, t1594, t1599, t1602, t1605;
  double t1610, t1613, t1616, t1619, t1622, t1631, t1632, t1637;
  double t1638, t1640, t1647, t1653, t1654, t1659, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1666, t1668, tv3rhosigma25, t1674, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1681, t1684, t1694, t1699;
  double t1701, t1705, t1706, t1708, t1710, t1713, t1718, t1721;
  double t1724, t1733, t1736, t1739, t1740, t1749, t1750, t1752;
  double t1759, t1761, t1762, t1767, tv3rhosigma211, t1769, t1772, t1773;
  double t1781, t1782, t1786, t1789, t1794, t1800, t1807, t1810;
  double t1813, t1816, t1820, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1821, t1822, t1830, t1831;
  double t1834, t1842, t1845, t1850, t1852, t1859, t1862, t1865;
  double t1868, t1872, tv3sigma39;

  double t1875, t1889, t1890, t1896, t1897, t1910, t1917, t1920;
  double t1924, t1928, t1931, t1948, t1952, t1953, t1958, t1960;
  double t1964, t1969, t1999, t2005, t2008, t2011, t2014, t2016;
  double t2021, t2023, t2024, t2030, t2036, t2037, t2040, t2044;
  double t2053, t2059, t2063, t2066, t2070, t2074, t2076, t2077;
  double t2078, t2080, t2081, t2087, t2092, t2095, t2099, t2106;
  double t2110, t2114, t2119, t2121, tv4rho40, t2128, t2132, t2133;
  double t2136, t2142, t2143, t2145, t2163, t2164, t2166, t2170;
  double t2179, t2193, t2194, t2211, t2213, t2217, t2224, t2228;
  double t2229, t2232, t2241, t2244, t2245, t2247, t2249, t2250;
  double tv4rho41, t2259, t2263, t2273, t2286, t2290, t2299, t2315;
  double t2316, t2325, t2338, t2342, t2349, t2353, t2362, t2365;
  double t2376, t2379, t2381, t2382, tv4rho42, t2403, t2407, t2414;
  double t2425, t2426, t2443, t2447, t2454, t2462, t2471, t2481;
  double t2483, t2484, tv4rho43, t2489, t2494, t2501, t2505, t2514;
  double t2525, t2526, t2530, t2531, t2538, t2540, t2544, t2550;
  double t2555, t2563, t2564, t2570, t2578, t2588, t2592, t2602;
  double t2603, t2611, t2639, t2647, t2652, t2659, t2663, t2682;
  double t2683, tv4rho44, t2691, t2697, t2700, t2707, t2709, t2712;
  double t2719, t2731, t2745, t2753, t2767, t2784, t2786, t2789;
  double t2792, t2818, t2841, t2880, t2887, tv4rho3sigma0, tv4rho3sigma1, t2894;
  double t2897, t2901, t2903, tv4rho3sigma2, t2905, t2911, t2916, t2920;
  double t2929, t2930, tv4rho3sigma3, tv4rho3sigma4, t2932, t2938, t2940, t2949;
  double t2951, t2954, tv4rho3sigma5, t2960, t2969, tv4rho3sigma6, tv4rho3sigma7, t2975;
  double t2982, t2990, t2992, t2993, tv4rho3sigma8, t3002, tv4rho3sigma9, tv4rho3sigma10;
  double t3022, t3042, t3046, t3049, t3058, t3075, t3081, t3087;
  double t3113, t3128, t3146, t3185, t3192, tv4rho3sigma11, t3199, t3206;
  double t3208, t3210, t3214, t3223, t3227, t3244, t3269, t3308;
  double t3356, t3404, t3411, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24;
  double t3418, t3422, t3424, tv4rho2sigma25, t3430, t3438, tv4rho2sigma26, tv4rho2sigma27;
  double tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t3444, t3451, t3454, tv4rho2sigma211, t3462;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t3475, t3482, t3513;
  double t3555, t3614, t3647, t3651, t3657, t3667, t3674, tv4rho2sigma217;
  double t3681, t3716, t3762, t3794, t3799, t3804, t3831, t3838;
  double tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37;
  double tv4rhosigma38, t3845, t3847, tv4rhosigma39, t3853, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312;
  double tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t3863, t3864;
  double t3868, t3896, t3927, t3969, t4007, t4014, tv4rhosigma319, t4047;
  double t4053, t4058, t4066, t4092, t4097, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t4128, t4139, t4157, t4167, t4173;
  double t4178, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t44 = 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t57 = t49 * t50 * t54 / 0.576e3;
  t58 = t40 / 0.24e2 + t57;
  t59 = t29 * t29;
  t60 = 0.1e1 / t59;
  t61 = t50 * sigma[0];
  t62 = t60 * t61;
  t63 = t51 * t51;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + t57 + t62 * t64 / 0.2304e4;
  t68 = 0.1e1 / t67;
  t69 = t58 * t68;
  t71 = (0.1804e1 - t44) * t28;
  t72 = t32 * sigma[0];
  t76 = -t71 * t72 * t38 / 0.24e2 + 0.6525e-1;
  t78 = 0.1804e1 - t44 + t69 * t76;
  t82 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t78);
  t83 = rho[1] <= p->dens_threshold;
  t84 = -t16;
  t86 = my_piecewise5(t14, t11, t10, t15, t84 * t7);
  t87 = 0.1e1 + t86;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t22, t89 * t87);
  t92 = t91 * t26;
  t93 = rho[1] * rho[1];
  t94 = POW_1_3(rho[1]);
  t95 = t94 * t94;
  t97 = 0.1e1 / t95 / t93;
  t99 = t33 * sigma[2] * t97;
  t101 = 0.804e0 + 0.5e1 / 0.972e3 * t99;
  t103 = 0.646416e0 / t101;
  t105 = sigma[2] * sigma[2];
  t106 = t93 * t93;
  t107 = t106 * rho[1];
  t109 = 0.1e1 / t94 / t107;
  t112 = t49 * t105 * t109 / 0.576e3;
  t113 = t99 / 0.24e2 + t112;
  t114 = t105 * sigma[2];
  t115 = t60 * t114;
  t116 = t106 * t106;
  t117 = 0.1e1 / t116;
  t120 = 0.1e1 + t112 + t115 * t117 / 0.2304e4;
  t121 = 0.1e1 / t120;
  t122 = t113 * t121;
  t124 = (0.1804e1 - t103) * t28;
  t125 = t32 * sigma[2];
  t129 = -t124 * t125 * t97 / 0.24e2 + 0.6525e-1;
  t131 = 0.1804e1 - t103 + t122 * t129;
  t135 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t131);
  tzk0 = t82 + t135;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = t6 * t6;
  t137 = 0.1e1 / t136;
  t138 = t16 * t137;
  t140 = my_piecewise5(t10, 0, t14, 0, t7 - t138);
  t143 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t140);
  t144 = t143 * t26;
  t148 = t26 * t26;
  t149 = 0.1e1 / t148;
  t150 = t25 * t149;
  t153 = t5 * t150 * t78 / 0.8e1;
  t154 = t42 * t42;
  t155 = 0.1e1 / t154;
  t156 = t155 * t28;
  t157 = t34 * rho[0];
  t159 = 0.1e1 / t36 / t157;
  t160 = t72 * t159;
  t166 = t51 * t34;
  t168 = 0.1e1 / t35 / t166;
  t171 = t49 * t50 * t168 / 0.108e3;
  t172 = -t33 * sigma[0] * t159 / 0.9e1 - t171;
  t173 = t172 * t68;
  t175 = t67 * t67;
  t176 = 0.1e1 / t175;
  t177 = t58 * t176;
  t178 = t63 * rho[0];
  t179 = 0.1e1 / t178;
  t182 = -t171 - t62 * t179 / 0.288e3;
  t183 = t76 * t182;
  t185 = t155 * t46;
  t186 = t48 * t50;
  t192 = 0.36946502057613168724e-3 * t185 * t186 * t168 + t71 * t160 / 0.9e1;
  t194 = -0.88671604938271604938e-2 * t156 * t160 + t173 * t76 - t177 * t183 + t69 * t192;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t78 - t153 - 0.3e1 / 0.8e1 * t5 * t27 * t194);
  t200 = t84 * t137;
  t202 = my_piecewise5(t14, 0, t10, 0, -t7 - t200);
  t205 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t202);
  t206 = t205 * t26;
  t210 = t91 * t149;
  t213 = t5 * t210 * t131 / 0.8e1;
  t215 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t131 - t213);
  tvrho0 = t82 + t135 + t6 * (t199 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t219 = my_piecewise5(t10, 0, t14, 0, -t7 - t138);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t78 - t153);
  t230 = my_piecewise5(t14, 0, t10, 0, t7 - t200);
  t233 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t230);
  t234 = t233 * t26;
  t238 = t101 * t101;
  t239 = 0.1e1 / t238;
  t240 = t239 * t28;
  t241 = t93 * rho[1];
  t243 = 0.1e1 / t95 / t241;
  t244 = t125 * t243;
  t250 = t106 * t93;
  t252 = 0.1e1 / t94 / t250;
  t255 = t49 * t105 * t252 / 0.108e3;
  t256 = -t33 * sigma[2] * t243 / 0.9e1 - t255;
  t257 = t256 * t121;
  t259 = t120 * t120;
  t260 = 0.1e1 / t259;
  t261 = t113 * t260;
  t262 = t116 * rho[1];
  t263 = 0.1e1 / t262;
  t266 = -t255 - t115 * t263 / 0.288e3;
  t267 = t129 * t266;
  t269 = t239 * t46;
  t270 = t48 * t105;
  t276 = 0.36946502057613168724e-3 * t269 * t270 * t252 + t124 * t244 / 0.9e1;
  t278 = -0.88671604938271604938e-2 * t240 * t244 + t257 * t129 - t261 * t267 + t122 * t276;
  t283 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t131 - t213 - 0.3e1 / 0.8e1 * t5 * t92 * t278);
  tvrho1 = t82 + t135 + t6 * (t228 + t283);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t286 = t32 * t38;
  t293 = t49 * sigma[0] * t54 / 0.288e3;
  t294 = t33 * t38 / 0.24e2 + t293;
  t295 = t294 * t68;
  t297 = t60 * t50;
  t300 = t293 + t297 * t64 / 0.768e3;
  t301 = t76 * t300;
  t303 = t48 * t54;
  t309 = -0.13854938271604938272e-3 * t185 * t303 * sigma[0] - t71 * t286 / 0.24e2;
  t311 = 0.33251851851851851852e-2 * t156 * t286 + t295 * t76 - t177 * t301 + t69 * t309;
  t315 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t311);
  tvsigma0 = t6 * t315;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t316 = t32 * t97;
  t323 = t49 * sigma[2] * t109 / 0.288e3;
  t324 = t33 * t97 / 0.24e2 + t323;
  t325 = t324 * t121;
  t327 = t60 * t105;
  t330 = t323 + t327 * t117 / 0.768e3;
  t331 = t129 * t330;
  t333 = t48 * t109;
  t339 = -0.13854938271604938272e-3 * t269 * t333 * sigma[2] - t124 * t316 / 0.24e2;
  t341 = 0.33251851851851851852e-2 * t240 * t316 + t325 * t129 - t261 * t331 + t122 * t339;
  t345 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t341);
  tvsigma2 = t6 * t345;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t348 = t23 * t23;
  t349 = 0.1e1 / t348;
  t350 = t140 * t140;
  t353 = t136 * t6;
  t354 = 0.1e1 / t353;
  t355 = t16 * t354;
  t358 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t137 + 0.2e1 * t355);
  t362 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t23 * t358);
  t363 = t362 * t26;
  t367 = t143 * t149;
  t369 = t5 * t367 * t78;
  t375 = 0.1e1 / t148 / t6;
  t376 = t25 * t375;
  t379 = t5 * t376 * t78 / 0.12e2;
  t381 = t5 * t150 * t194;
  t384 = 0.1e1 / t154 / t42;
  t385 = t384 * t46;
  t386 = t51 * t157;
  t388 = 0.1e1 / t35 / t386;
  t389 = t186 * t388;
  t393 = 0.1e1 / t36 / t51;
  t394 = t72 * t393;
  t402 = 0.19e2 / 0.324e3 * t49 * t50 * t388;
  t403 = 0.11e2 / 0.27e2 * t33 * sigma[0] * t393 + t402;
  t404 = t403 * t68;
  t406 = t172 * t176;
  t412 = 0.1e1 / t175 / t67;
  t413 = t58 * t412;
  t414 = t182 * t182;
  t415 = t76 * t414;
  t418 = t192 * t182;
  t421 = t63 * t34;
  t422 = 0.1e1 / t421;
  t425 = t402 + t62 * t422 / 0.32e2;
  t426 = t76 * t425;
  t428 = t384 * t60;
  t436 = 0.60817287337634845636e-4 * t428 * t61 * t422 - 0.33251851851851851852e-2 * t185 * t389 - 0.11e2 / 0.27e2 * t71 * t394;
  t438 = -0.24326914935053938255e-3 * t385 * t389 + 0.32512921810699588477e-1 * t156 * t394 + t404 * t76 - 0.2e1 * t406 * t183 + 0.2e1 * t173 * t192 + 0.2e1 * t413 * t415 - 0.2e1 * t177 * t418 - t177 * t426 + t69 * t436;
  t443 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t78 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t194 + t379 - t381 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t438);
  t444 = t89 * t89;
  t445 = 0.1e1 / t444;
  t446 = t202 * t202;
  t449 = t84 * t354;
  t452 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t137 + 0.2e1 * t449);
  t456 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t446 + 0.4e1 / 0.3e1 * t89 * t452);
  t457 = t456 * t26;
  t461 = t205 * t149;
  t463 = t5 * t461 * t131;
  t465 = t91 * t375;
  t468 = t5 * t465 * t131 / 0.12e2;
  t470 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t131 - t463 / 0.4e1 + t468);
  tv2rho20 = 0.2e1 * t199 + 0.2e1 * t215 + t6 * (t443 + t470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t473 = t349 * t219;
  t477 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t355);
  t481 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t473 * t140 + 0.4e1 / 0.3e1 * t23 * t477);
  t482 = t481 * t26;
  t486 = t222 * t149;
  t488 = t5 * t486 * t78;
  t496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t78 - t488 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t194 - t369 / 0.8e1 + t379 - t381 / 0.8e1);
  t497 = t445 * t230;
  t501 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t449);
  t505 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t497 * t202 + 0.4e1 / 0.3e1 * t89 * t501);
  t506 = t505 * t26;
  t510 = t233 * t149;
  t512 = t5 * t510 * t131;
  t519 = t5 * t210 * t278;
  t522 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t131 - t512 / 0.8e1 - t463 / 0.8e1 + t468 - 0.3e1 / 0.8e1 * t5 * t206 * t278 - t519 / 0.8e1);
  tv2rho21 = t199 + t215 + t228 + t283 + t6 * (t496 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t527 = t219 * t219;
  t532 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t137 + 0.2e1 * t355);
  t536 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t349 * t527 + 0.4e1 / 0.3e1 * t23 * t532);
  t537 = t536 * t26;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t78 - t488 / 0.4e1 + t379);
  t544 = t230 * t230;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t137 + 0.2e1 * t449);
  t553 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t445 * t544 + 0.4e1 / 0.3e1 * t89 * t549);
  t554 = t553 * t26;
  t564 = 0.1e1 / t238 / t101;
  t565 = t564 * t46;
  t566 = t106 * t241;
  t568 = 0.1e1 / t94 / t566;
  t569 = t270 * t568;
  t573 = 0.1e1 / t95 / t106;
  t574 = t125 * t573;
  t582 = 0.19e2 / 0.324e3 * t49 * t105 * t568;
  t583 = 0.11e2 / 0.27e2 * t33 * sigma[2] * t573 + t582;
  t584 = t583 * t121;
  t586 = t256 * t260;
  t592 = 0.1e1 / t259 / t120;
  t593 = t113 * t592;
  t594 = t266 * t266;
  t595 = t129 * t594;
  t598 = t276 * t266;
  t601 = t116 * t93;
  t602 = 0.1e1 / t601;
  t605 = t582 + t115 * t602 / 0.32e2;
  t606 = t129 * t605;
  t608 = t564 * t60;
  t616 = 0.60817287337634845636e-4 * t608 * t114 * t602 - 0.33251851851851851852e-2 * t269 * t569 - 0.11e2 / 0.27e2 * t124 * t574;
  t618 = -0.24326914935053938255e-3 * t565 * t569 + 0.32512921810699588477e-1 * t240 * t574 + t584 * t129 - 0.2e1 * t586 * t267 + 0.2e1 * t257 * t276 + 0.2e1 * t593 * t595 - 0.2e1 * t261 * t598 - t261 * t606 + t122 * t616;
  t623 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t131 - t512 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t278 + t468 - t519 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t283 + t6 * (t543 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t150 * t311 / 0.8e1;
  t632 = t48 * t168;
  t633 = t632 * sigma[0];
  t636 = t32 * t159;
  t643 = t49 * sigma[0] * t168 / 0.54e2;
  t644 = -t33 * t159 / 0.9e1 - t643;
  t645 = t644 * t68;
  t647 = t294 * t176;
  t651 = t301 * t182;
  t654 = t192 * t300;
  t658 = -t643 - t297 * t179 / 0.96e2;
  t659 = t76 * t658;
  t662 = t309 * t182;
  t671 = -0.22806482751613067114e-4 * t428 * t179 * t50 + 0.11083950617283950618e-2 * t185 * t633 + t71 * t636 / 0.9e1;
  t673 = 0.91225931006452268455e-4 * t385 * t633 - 0.88671604938271604939e-2 * t156 * t636 + t645 * t76 - t647 * t183 + t295 * t192 - t406 * t301 + 0.2e1 * t413 * t651 - t177 * t654 - t177 * t659 + t173 * t309 - t177 * t662 + t69 * t671;
  t678 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t311 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t673);
  tv2rhosigma0 = t6 * t678 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t685 = t5 * t210 * t341 / 0.8e1;
  t687 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t341 - t685);
  tv2rhosigma2 = t6 * t687 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t693 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t311 - t631);
  tv2rhosigma3 = t6 * t693 + t315;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t48 * t252;
  t699 = t698 * sigma[2];
  t702 = t32 * t243;
  t709 = t49 * sigma[2] * t252 / 0.54e2;
  t710 = -t33 * t243 / 0.9e1 - t709;
  t711 = t710 * t121;
  t713 = t324 * t260;
  t717 = t331 * t266;
  t720 = t276 * t330;
  t724 = -t709 - t327 * t263 / 0.96e2;
  t725 = t129 * t724;
  t728 = t339 * t266;
  t737 = -0.22806482751613067114e-4 * t608 * t263 * t105 + 0.11083950617283950618e-2 * t269 * t699 + t124 * t702 / 0.9e1;
  t739 = 0.91225931006452268455e-4 * t565 * t699 - 0.88671604938271604939e-2 * t240 * t702 + t711 * t129 - t713 * t267 + t325 * t276 - t586 * t331 + 0.2e1 * t593 * t717 - t261 * t720 - t261 * t725 + t257 * t339 - t261 * t728 + t122 * t737;
  t744 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t341 - t685 - 0.3e1 / 0.8e1 * t5 * t92 * t739);
  tv2rhosigma5 = t6 * t744 + t345;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t748 = t54 * t68;
  t756 = t300 * t300;
  t757 = t76 * t756;
  t760 = t309 * t300;
  t763 = t49 * t54;
  t765 = t60 * sigma[0];
  t768 = t763 / 0.288e3 + t765 * t64 / 0.384e3;
  t769 = t76 * t768;
  t776 = 0.85524310318549001679e-5 * t428 * t64 * sigma[0] - 0.27709876543209876544e-3 * t185 * t303;
  t778 = -0.34209724127419600671e-4 * t385 * t303 + t49 * t748 * t76 / 0.288e3 - 0.2e1 * t647 * t301 + 0.2e1 * t295 * t309 + 0.2e1 * t413 * t757 - 0.2e1 * t177 * t760 - t177 * t769 + t69 * t776;
  t782 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t778);
  tv2sigma20 = t6 * t782;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t785 = t109 * t121;
  t793 = t330 * t330;
  t794 = t129 * t793;
  t797 = t339 * t330;
  t800 = t49 * t109;
  t802 = t60 * sigma[2];
  t805 = t800 / 0.288e3 + t802 * t117 / 0.384e3;
  t806 = t129 * t805;
  t813 = 0.85524310318549001679e-5 * t608 * t117 * sigma[2] - 0.27709876543209876544e-3 * t269 * t333;
  t815 = -0.34209724127419600671e-4 * t565 * t333 + t49 * t785 * t129 / 0.288e3 - 0.2e1 * t713 * t331 + 0.2e1 * t325 * t339 + 0.2e1 * t593 * t794 - 0.2e1 * t261 * t797 - t261 * t806 + t122 * t813;
  t819 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t815);
  tv2sigma25 = t6 * t819;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t823 = 0.1e1 / t348 / t19;
  t824 = t350 * t140;
  t827 = t349 * t140;
  t830 = t136 * t136;
  t831 = 0.1e1 / t830;
  t832 = t16 * t831;
  t835 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t354 - 0.6e1 * t832);
  t839 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t823 * t824 + 0.4e1 / 0.3e1 * t827 * t358 + 0.4e1 / 0.3e1 * t23 * t835);
  t840 = t839 * t26;
  t844 = t362 * t149;
  t846 = t5 * t844 * t78;
  t851 = t143 * t375;
  t853 = t5 * t851 * t78;
  t856 = t5 * t367 * t194;
  t862 = 0.1e1 / t148 / t136;
  t863 = t25 * t862;
  t866 = 0.5e1 / 0.36e2 * t5 * t863 * t78;
  t868 = t5 * t376 * t194;
  t871 = t5 * t150 * t438;
  t873 = t175 * t175;
  t874 = 0.1e1 / t873;
  t875 = t58 * t874;
  t876 = t414 * t182;
  t877 = t76 * t876;
  t880 = t183 * t425;
  t883 = t172 * t412;
  t887 = 0.1e1 / t35 / t63;
  t888 = t186 * t887;
  t892 = 0.1e1 / t36 / t52;
  t893 = t72 * t892;
  t896 = t436 * t182;
  t899 = t192 * t425;
  t904 = 0.209e3 / 0.486e3 * t49 * t50 * t887;
  t905 = t63 * t157;
  t906 = 0.1e1 / t905;
  t909 = -t904 - 0.5e1 / 0.16e2 * t62 * t906;
  t910 = t76 * t909;
  t912 = t154 * t154;
  t914 = 0.1e1 / t912 * t60;
  t915 = t61 * t906;
  t918 = t403 * t176;
  t925 = t192 * t414;
  t931 = -0.154e3 / 0.81e2 * t33 * sigma[0] * t892 - t904;
  t932 = t931 * t68;
  t938 = t50 * t50;
  t939 = t914 * t938;
  t940 = t63 * t52;
  t942 = 0.1e1 / t36 / t940;
  t953 = 0.25027690262401171044e-5 * t939 * t942 * t28 * t32 - 0.11555284594150620671e-2 * t428 * t915 + 0.27997238225880201189e-1 * t185 * t888 + 0.154e3 / 0.81e2 * t71 * t893;
  t955 = -0.6e1 * t875 * t877 + 0.6e1 * t413 * t880 + 0.6e1 * t883 * t415 + 0.2675960642855933208e-2 * t385 * t888 - 0.15172696844993141289e0 * t156 * t893 - 0.3e1 * t177 * t896 - 0.3e1 * t177 * t899 - t177 * t910 - 0.60066456629762810506e-4 * t914 * t915 - 0.3e1 * t918 * t183 - 0.6e1 * t406 * t418 - 0.3e1 * t406 * t426 + 0.6e1 * t413 * t925 + t932 * t76 + 0.3e1 * t404 * t192 + 0.3e1 * t173 * t436 + t69 * t953;
  t960 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t840 * t78 - 0.3e1 / 0.8e1 * t846 - 0.9e1 / 0.8e1 * t5 * t363 * t194 + t853 / 0.4e1 - 0.3e1 / 0.4e1 * t856 - 0.9e1 / 0.8e1 * t5 * t144 * t438 - t866 + t868 / 0.4e1 - 0.3e1 / 0.8e1 * t871 - 0.3e1 / 0.8e1 * t5 * t27 * t955);
  t962 = 0.1e1 / t444 / t87;
  t963 = t446 * t202;
  t966 = t445 * t202;
  t969 = t84 * t831;
  t972 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t354 - 0.6e1 * t969);
  t976 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t962 * t963 + 0.4e1 / 0.3e1 * t966 * t452 + 0.4e1 / 0.3e1 * t89 * t972);
  t977 = t976 * t26;
  t981 = t456 * t149;
  t983 = t5 * t981 * t131;
  t985 = t205 * t375;
  t987 = t5 * t985 * t131;
  t989 = t91 * t862;
  t992 = 0.5e1 / 0.36e2 * t5 * t989 * t131;
  t994 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t977 * t131 - 0.3e1 / 0.8e1 * t983 + t987 / 0.4e1 - t992);
  tv3rho30 = 0.3e1 * t443 + 0.3e1 * t470 + t6 * (t960 + t994);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t997 = 0.2e1 * t496;
  t998 = 0.2e1 * t522;
  t999 = t823 * t219;
  t1002 = t349 * t477;
  t1007 = 0.2e1 * t354;
  t1008 = 0.6e1 * t832;
  t1010 = my_piecewise5(t10, 0, t14, 0, t1007 - t1008);
  t1014 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t999 * t350 + 0.8e1 / 0.9e1 * t1002 * t140 + 0.4e1 / 0.9e1 * t473 * t358 + 0.4e1 / 0.3e1 * t23 * t1010);
  t1015 = t1014 * t26;
  t1019 = t481 * t149;
  t1022 = t5 * t1019 * t78 / 0.4e1;
  t1026 = t222 * t375;
  t1028 = t5 * t1026 * t78;
  t1032 = t5 * t486 * t194 / 0.4e1;
  t1041 = -0.3e1 / 0.8e1 * t5 * t1015 * t78 - t1022 - 0.3e1 / 0.4e1 * t5 * t482 * t194 + t1028 / 0.12e2 - t1032 - 0.3e1 / 0.8e1 * t5 * t223 * t438 - t846 / 0.8e1 + t853 / 0.6e1 - t856 / 0.4e1 - t866 + t868 / 0.6e1 - t871 / 0.8e1;
  t1042 = my_piecewise3(t1, 0, t1041);
  t1043 = t962 * t230;
  t1046 = t445 * t501;
  t1051 = 0.6e1 * t969;
  t1053 = my_piecewise5(t14, 0, t10, 0, -t1007 - t1051);
  t1057 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1043 * t446 + 0.8e1 / 0.9e1 * t1046 * t202 + 0.4e1 / 0.9e1 * t497 * t452 + 0.4e1 / 0.3e1 * t89 * t1053);
  t1058 = t1057 * t26;
  t1062 = t505 * t149;
  t1065 = t5 * t1062 * t131 / 0.4e1;
  t1066 = t233 * t375;
  t1068 = t5 * t1066 * t131;
  t1077 = t5 * t461 * t278 / 0.4e1;
  t1079 = t5 * t465 * t278;
  t1082 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1058 * t131 - t1065 + t1068 / 0.12e2 - t983 / 0.8e1 + t987 / 0.6e1 - t992 - 0.3e1 / 0.8e1 * t5 * t457 * t278 - t1077 + t1079 / 0.12e2);
  tv3rho31 = t443 + t470 + t997 + t998 + t6 * (t1042 + t1082);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1085 = t823 * t527;
  t1090 = t349 * t532;
  t1094 = my_piecewise5(t10, 0, t14, 0, -t1007 - t1008);
  t1098 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1085 * t140 + 0.8e1 / 0.9e1 * t473 * t477 + 0.4e1 / 0.9e1 * t1090 * t140 + 0.4e1 / 0.3e1 * t23 * t1094);
  t1099 = t1098 * t26;
  t1103 = t536 * t149;
  t1105 = t5 * t1103 * t78;
  t1114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1099 * t78 - t1105 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t537 * t194 - t1022 + t1028 / 0.6e1 - t1032 + t853 / 0.12e2 - t866 + t868 / 0.12e2);
  t1115 = t962 * t544;
  t1120 = t445 * t549;
  t1124 = my_piecewise5(t14, 0, t10, 0, t1007 - t1051);
  t1128 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1115 * t202 + 0.8e1 / 0.9e1 * t497 * t501 + 0.4e1 / 0.9e1 * t1120 * t202 + 0.4e1 / 0.3e1 * t89 * t1124);
  t1129 = t1128 * t26;
  t1133 = t553 * t149;
  t1135 = t5 * t1133 * t131;
  t1142 = t5 * t510 * t278;
  t1150 = t5 * t210 * t618;
  t1152 = -0.3e1 / 0.8e1 * t5 * t1129 * t131 - t1135 / 0.8e1 - t1065 + t1068 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t506 * t278 - t1142 / 0.4e1 + t987 / 0.12e2 - t992 - t1077 + t1079 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t618 - t1150 / 0.8e1;
  t1153 = my_piecewise3(t83, 0, t1152);
  tv3rho32 = t997 + t998 + t543 + t623 + t6 * (t1114 + t1153);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1158 = t527 * t219;
  t1165 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t354 - 0.6e1 * t832);
  t1169 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t823 * t1158 + 0.4e1 / 0.3e1 * t473 * t532 + 0.4e1 / 0.3e1 * t23 * t1165);
  t1170 = t1169 * t26;
  t1177 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1170 * t78 - 0.3e1 / 0.8e1 * t1105 + t1028 / 0.4e1 - t866);
  t1178 = t544 * t230;
  t1185 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t354 - 0.6e1 * t969);
  t1189 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t962 * t1178 + 0.4e1 / 0.3e1 * t497 * t549 + 0.4e1 / 0.3e1 * t89 * t1185);
  t1190 = t1189 * t26;
  t1205 = t238 * t238;
  t1207 = 0.1e1 / t1205 * t60;
  t1208 = t105 * t105;
  t1209 = t1207 * t1208;
  t1210 = t116 * t107;
  t1212 = 0.1e1 / t95 / t1210;
  t1217 = t116 * t241;
  t1218 = 0.1e1 / t1217;
  t1219 = t114 * t1218;
  t1223 = 0.1e1 / t94 / t116;
  t1224 = t270 * t1223;
  t1228 = 0.1e1 / t95 / t107;
  t1229 = t125 * t1228;
  t1232 = 0.25027690262401171044e-5 * t1209 * t1212 * t28 * t32 - 0.11555284594150620671e-2 * t608 * t1219 + 0.27997238225880201189e-1 * t269 * t1224 + 0.154e3 / 0.81e2 * t124 * t1229;
  t1239 = 0.209e3 / 0.486e3 * t49 * t105 * t1223;
  t1240 = -0.154e3 / 0.81e2 * t33 * sigma[2] * t1228 - t1239;
  t1241 = t1240 * t121;
  t1247 = t256 * t592;
  t1250 = t259 * t259;
  t1251 = 0.1e1 / t1250;
  t1252 = t113 * t1251;
  t1253 = t594 * t266;
  t1254 = t129 * t1253;
  t1257 = t267 * t605;
  t1264 = t276 * t594;
  t1267 = t616 * t266;
  t1270 = t276 * t605;
  t1275 = -t1239 - 0.5e1 / 0.16e2 * t115 * t1218;
  t1276 = t129 * t1275;
  t1280 = t583 * t260;
  t1287 = t122 * t1232 + t1241 * t129 + 0.3e1 * t584 * t276 + 0.3e1 * t257 * t616 + 0.6e1 * t1247 * t595 - 0.6e1 * t1252 * t1254 + 0.6e1 * t593 * t1257 + 0.2675960642855933208e-2 * t565 * t1224 - 0.15172696844993141289e0 * t240 * t1229 + 0.6e1 * t593 * t1264 - 0.3e1 * t261 * t1267 - 0.3e1 * t261 * t1270 - t261 * t1276 - 0.60066456629762810506e-4 * t1207 * t1219 - 0.3e1 * t1280 * t267 - 0.6e1 * t586 * t598 - 0.3e1 * t586 * t606;
  t1292 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1190 * t131 - 0.3e1 / 0.8e1 * t1135 - 0.9e1 / 0.8e1 * t5 * t554 * t278 + t1068 / 0.4e1 - 0.3e1 / 0.4e1 * t1142 - 0.9e1 / 0.8e1 * t5 * t234 * t618 - t992 + t1079 / 0.4e1 - 0.3e1 / 0.8e1 * t1150 - 0.3e1 / 0.8e1 * t5 * t92 * t1287);
  tv3rho33 = 0.3e1 * t543 + 0.3e1 * t623 + t6 * (t1177 + t1292);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1300 = t5 * t367 * t311;
  t1307 = t5 * t376 * t311 / 0.12e2;
  t1309 = t5 * t150 * t673;
  t1317 = t63 * t51;
  t1319 = 0.1e1 / t36 / t1317;
  t1320 = t914 * t1319;
  t1322 = t61 * t28 * t32;
  t1325 = t422 * t50;
  t1328 = t48 * t388;
  t1329 = t1328 * sigma[0];
  t1332 = t32 * t393;
  t1335 = -0.93853838484004391416e-6 * t1320 * t1322 + 0.38771020677742214095e-3 * t428 * t1325 - 0.80050754458161865574e-2 * t185 * t1329 - 0.11e2 / 0.27e2 * t71 * t1332;
  t1341 = 0.19e2 / 0.162e3 * t49 * sigma[0] * t388;
  t1342 = 0.11e2 / 0.27e2 * t33 * t393 + t1341;
  t1343 = t1342 * t68;
  t1347 = t301 * t414;
  t1352 = t309 * t414;
  t1357 = t294 * t412;
  t1360 = t654 * t182;
  t1363 = t659 * t182;
  t1366 = 0.2e1 * t645 * t192 + t295 * t436 + t404 * t309 + 0.2e1 * t173 * t671 + t69 * t1335 + t1343 * t76 + 0.4e1 * t883 * t651 - 0.6e1 * t875 * t1347 - 0.8210333790580704161e-3 * t385 * t1329 + 0.2e1 * t413 * t1352 + 0.32512921810699588478e-1 * t156 * t1332 + 0.2e1 * t1357 * t415 + 0.4e1 * t413 * t1360 + 0.4e1 * t413 * t1363;
  t1367 = t301 * t425;
  t1372 = t1341 + 0.3e1 / 0.32e2 * t297 * t422;
  t1373 = t76 * t1372;
  t1377 = t671 * t182;
  t1380 = t309 * t425;
  t1384 = t644 * t176;
  t1395 = t436 * t300;
  t1397 = t192 * t658;
  t1400 = 0.2e1 * t413 * t1367 - t177 * t1373 - 0.2e1 * t406 * t662 - 0.2e1 * t177 * t1377 - t177 * t1380 + 0.2252492123616105394e-4 * t914 * t1325 - 0.2e1 * t1384 * t183 - 0.2e1 * t647 * t418 - t647 * t426 - t918 * t301 - 0.2e1 * t406 * t654 - 0.2e1 * t406 * t659 - t177 * t1395 - 0.2e1 * t177 * t1397;
  t1401 = t1366 + t1400;
  t1406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t311 - t1300 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t673 + t1307 - t1309 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1401);
  tv3rho2sigma0 = t1406 * t6 + 0.2e1 * t678;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1413 = t5 * t461 * t341;
  t1417 = t5 * t465 * t341 / 0.12e2;
  t1419 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t341 - t1413 / 0.4e1 + t1417);
  tv3rho2sigma2 = t1419 * t6 + 0.2e1 * t687;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1425 = t5 * t486 * t311;
  t1433 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t311 - t1425 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t673 - t1300 / 0.8e1 + t1307 - t1309 / 0.8e1);
  tv3rho2sigma3 = t1433 * t6 + t678 + t693;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1439 = t5 * t510 * t341;
  t1446 = t5 * t210 * t739;
  t1449 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t341 - t1439 / 0.8e1 - t1413 / 0.8e1 + t1417 - 0.3e1 / 0.8e1 * t5 * t206 * t739 - t1446 / 0.8e1);
  tv3rho2sigma5 = t1449 * t6 + t687 + t744;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1457 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t311 - t1425 / 0.4e1 + t1307);
  tv3rho2sigma6 = t1457 * t6 + 0.2e1 * t693;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1472 = t616 * t330;
  t1474 = t276 * t724;
  t1477 = t339 * t605;
  t1479 = t602 * t105;
  t1482 = t710 * t260;
  t1489 = t720 * t266;
  t1492 = t725 * t266;
  t1495 = t331 * t605;
  t1498 = t331 * t594;
  t1501 = -0.2e1 * t586 * t720 - 0.2e1 * t586 * t725 - t261 * t1472 - 0.2e1 * t261 * t1474 - t261 * t1477 + 0.2252492123616105394e-4 * t1207 * t1479 - 0.2e1 * t1482 * t267 - 0.2e1 * t713 * t598 - t713 * t606 - t1280 * t331 + 0.4e1 * t593 * t1489 + 0.4e1 * t593 * t1492 + 0.2e1 * t593 * t1495 - 0.6e1 * t1252 * t1498;
  t1502 = t48 * t568;
  t1503 = t1502 * sigma[2];
  t1508 = t32 * t573;
  t1513 = 0.19e2 / 0.162e3 * t49 * sigma[2] * t568;
  t1516 = t1513 + 0.3e1 / 0.32e2 * t327 * t602;
  t1517 = t129 * t1516;
  t1521 = t737 * t266;
  t1524 = t339 * t594;
  t1527 = t324 * t592;
  t1532 = 0.11e2 / 0.27e2 * t33 * t573 + t1513;
  t1533 = t1532 * t121;
  t1541 = t116 * t106;
  t1543 = 0.1e1 / t95 / t1541;
  t1544 = t1207 * t1543;
  t1546 = t114 * t28 * t32;
  t1555 = -0.93853838484004391416e-6 * t1544 * t1546 + 0.38771020677742214095e-3 * t608 * t1479 - 0.80050754458161865574e-2 * t269 * t1503 - 0.11e2 / 0.27e2 * t124 * t1508;
  t1557 = -0.8210333790580704161e-3 * t565 * t1503 + 0.4e1 * t1247 * t717 + 0.32512921810699588478e-1 * t240 * t1508 - t261 * t1517 - 0.2e1 * t586 * t728 - 0.2e1 * t261 * t1521 + 0.2e1 * t593 * t1524 + 0.2e1 * t1527 * t595 + t1533 * t129 + 0.2e1 * t711 * t276 + t325 * t616 + t584 * t339 + 0.2e1 * t257 * t737 + t122 * t1555;
  t1558 = t1501 + t1557;
  t1563 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t341 - t1439 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t739 + t1417 - t1446 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * t1558);
  tv3rho2sigma8 = t1563 * t6 + 0.2e1 * t744;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1570 = t5 * t150 * t778 / 0.8e1;
  t1576 = t192 * t768;
  t1578 = t49 * t168;
  t1582 = -t1578 / 0.54e2 - t765 * t179 / 0.48e2;
  t1583 = t76 * t1582;
  t1585 = t776 * t182;
  t1587 = t179 * sigma[0];
  t1594 = t192 * t756;
  t1599 = t671 * t300;
  t1602 = t309 * t658;
  t1605 = -0.2e1 * t647 * t659 - 0.2e1 * t647 * t662 - t406 * t769 - t177 * t1576 - t177 * t1583 - t177 * t1585 - 0.84468454635603952274e-5 * t914 * t1587 - 0.2e1 * t1384 * t301 - 0.2e1 * t647 * t654 + 0.2e1 * t413 * t1594 - 0.2e1 * t406 * t760 - 0.2e1 * t177 * t1599 - 0.2e1 * t177 * t1602;
  t1610 = t757 * t182;
  t1613 = t301 * t658;
  t1616 = t760 * t182;
  t1619 = t769 * t182;
  t1622 = t168 * t68;
  t1631 = t176 * t76;
  t1632 = t1631 * t182;
  t1637 = 0.1e1 / t36 / t905;
  t1638 = t914 * t1637;
  t1640 = t50 * t28 * t32;
  t1647 = 0.35195189431501646781e-6 * t1638 * t1640 - 0.11403241375806533557e-3 * t428 * t1587 + 0.1477860082304526749e-2 * t185 * t632;
  t1653 = 0.2e1 * t883 * t757 + 0.18245186201290453691e-3 * t385 * t632 - 0.6e1 * t875 * t1610 + 0.4e1 * t413 * t1613 + 0.4e1 * t413 * t1616 + 0.2e1 * t413 * t1619 - t49 * t1622 * t76 / 0.54e2 + t49 * t748 * t192 / 0.288e3 + 0.4e1 * t1357 * t651 - t763 * t1632 / 0.288e3 + t173 * t776 + t69 * t1647 + 0.2e1 * t645 * t309 + 0.2e1 * t295 * t671;
  t1654 = t1605 + t1653;
  t1659 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t778 - t1570 - 0.3e1 / 0.8e1 * t5 * t27 * t1654);
  tv3rhosigma20 = t1659 * t6 + t782;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1666 = t5 * t210 * t815 / 0.8e1;
  t1668 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t815 - t1666);
  tv3rhosigma25 = t1668 * t6 + t819;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1674 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t778 - t1570);
  tv3rhosigma26 = t1674 * t6 + t782;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1681 = t737 * t330;
  t1684 = t339 * t724;
  t1694 = t276 * t793;
  t1699 = t276 * t805;
  t1701 = t49 * t252;
  t1705 = -t1701 / 0.54e2 - t802 * t263 / 0.48e2;
  t1706 = t129 * t1705;
  t1708 = t813 * t266;
  t1710 = t263 * sigma[2];
  t1713 = 0.18245186201290453691e-3 * t565 * t698 - 0.2e1 * t261 * t1681 - 0.2e1 * t261 * t1684 - t586 * t806 - 0.2e1 * t713 * t725 - 0.2e1 * t713 * t728 + 0.2e1 * t1247 * t794 + 0.2e1 * t593 * t1694 - 0.2e1 * t586 * t797 - t261 * t1699 - t261 * t1706 - t261 * t1708 - 0.84468454635603952274e-5 * t1207 * t1710;
  t1718 = t797 * t266;
  t1721 = t806 * t266;
  t1724 = t252 * t121;
  t1733 = t794 * t266;
  t1736 = t331 * t724;
  t1739 = t260 * t129;
  t1740 = t1739 * t266;
  t1749 = 0.1e1 / t95 / t1217;
  t1750 = t1207 * t1749;
  t1752 = t105 * t28 * t32;
  t1759 = 0.35195189431501646781e-6 * t1750 * t1752 - 0.11403241375806533557e-3 * t608 * t1710 + 0.1477860082304526749e-2 * t269 * t698;
  t1761 = -0.2e1 * t1482 * t331 - 0.2e1 * t713 * t720 + 0.4e1 * t593 * t1718 + 0.2e1 * t593 * t1721 - t49 * t1724 * t129 / 0.54e2 + t49 * t785 * t276 / 0.288e3 + 0.4e1 * t1527 * t717 - 0.6e1 * t1252 * t1733 + 0.4e1 * t593 * t1736 - t800 * t1740 / 0.288e3 + 0.2e1 * t711 * t339 + 0.2e1 * t325 * t737 + t257 * t813 + t122 * t1759;
  t1762 = t1713 + t1761;
  t1767 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t815 - t1666 - 0.3e1 / 0.8e1 * t5 * t92 * t1762);
  tv3rhosigma211 = t1767 * t6 + t819;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1769 = t301 * t768;
  t1772 = t76 * t60;
  t1773 = t1772 * t64;
  t1781 = t756 * t300;
  t1782 = t76 * t1781;
  t1786 = 0.1e1 / t36 / t421;
  t1789 = sigma[0] * t28 * t32;
  t1794 = -0.13198196036813117543e-6 * t914 * t1786 * t1789 + 0.25657293095564700504e-4 * t428 * t64;
  t1800 = t309 * t768;
  t1807 = t309 * t756;
  t1810 = t776 * t300;
  t1813 = t1631 * t300;
  t1816 = 0.6e1 * t413 * t1769 - t177 * t1773 / 0.384e3 + t49 * t748 * t309 / 0.96e2 + 0.6e1 * t1357 * t757 - 0.6e1 * t875 * t1782 + t69 * t1794 + 0.31675670488351482103e-5 * t914 * t64 + 0.3e1 * t295 * t776 - 0.3e1 * t177 * t1800 - 0.6e1 * t647 * t760 - 0.3e1 * t647 * t769 + 0.6e1 * t413 * t1807 - 0.3e1 * t177 * t1810 - t763 * t1813 / 0.96e2;
  t1820 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1816);
  tv3sigma30 = t6 * t1820;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1821 = t129 * t60;
  t1822 = t1821 * t117;
  t1830 = t793 * t330;
  t1831 = t129 * t1830;
  t1834 = t331 * t805;
  t1842 = 0.1e1 / t95 / t601;
  t1845 = sigma[2] * t28 * t32;
  t1850 = -0.13198196036813117543e-6 * t1207 * t1842 * t1845 + 0.25657293095564700504e-4 * t608 * t117;
  t1852 = t339 * t805;
  t1859 = t339 * t793;
  t1862 = t813 * t330;
  t1865 = t1739 * t330;
  t1868 = -t261 * t1822 / 0.384e3 + t49 * t785 * t339 / 0.96e2 + 0.6e1 * t1527 * t794 - 0.6e1 * t1252 * t1831 + 0.6e1 * t593 * t1834 + 0.31675670488351482103e-5 * t1207 * t117 + 0.3e1 * t325 * t813 + t122 * t1850 - 0.3e1 * t261 * t1852 - 0.6e1 * t713 * t797 - 0.3e1 * t713 * t806 + 0.6e1 * t593 * t1859 - 0.3e1 * t261 * t1862 - t800 * t1865 / 0.96e2;
  t1872 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * t1868);
  tv3sigma39 = t6 * t1872;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1875 = t425 * t425;
  t1889 = t58 / t873 / t67;
  t1890 = t414 * t414;
  t1896 = 0.1e1 / t1317;
  t1897 = t61 * t1896;
  t1910 = t931 * t176;
  t1917 = t172 * t874;
  t1920 = 0.6e1 * t413 * t76 * t1875 + 0.12e2 * t413 * t436 * t414 - 0.4e1 * t177 * t192 * t909 - 0.4e1 * t406 * t910 + 0.24e2 * t1889 * t76 * t1890 + 0.24e2 * t883 * t925 + 0.13214620458547818311e-2 * t914 * t1897 - 0.12e2 * t406 * t896 - 0.4e1 * t177 * t953 * t182 - 0.6e1 * t177 * t436 * t425 - 0.12e2 * t406 * t899 - 0.4e1 * t1910 * t183 - 0.12e2 * t918 * t418 - 0.6e1 * t918 * t426 - 0.24e2 * t1917 * t877;
  t1924 = t403 * t412;
  t1928 = 0.1e1 / t35 / t178;
  t1931 = 0.5225e4 / 0.1458e4 * t49 * t50 * t1928;
  t1948 = t186 * t1928;
  t1952 = 0.1e1 / t36 / t166;
  t1953 = t72 * t1952;
  t1958 = 0.1e1 / t912 / t42 * t60;
  t1960 = t63 * t166;
  t1964 = 0.1e1 / t36 / t1960 * t28 * t32;
  t1969 = t63 * t63;
  t1999 = -0.24e2 * t875 * t192 * t876 + 0.12e2 * t1924 * t415 - t177 * t76 * (t1931 + 0.55e2 / 0.16e2 * t62 * t1896) + 0.24e2 * t883 * t880 + 0.24e2 * t413 * t418 * t425 + 0.8e1 * t413 * t183 * t909 - 0.36e2 * t875 * t415 * t425 - 0.26462277468242006168e-1 * t385 * t1948 + 0.85978615454961133971e0 * t156 * t1953 - 0.32958275242668208782e-5 * t1958 * t938 * t1964 + t69 * (0.13732614684445086993e-6 * t1958 * t938 * sigma[0] / t35 / t1969 / rho[0] * t46 * t48 - 0.81757121523843825411e-4 * t939 * t1964 + 0.17319411938484234374e-1 * t428 * t1897 - 0.25016887059899405578e0 * t185 * t1948 - 0.2618e4 / 0.243e3 * t71 * t1953) + (0.2618e4 / 0.243e3 * t33 * sigma[0] * t1952 + t1931) * t68 * t76 + 0.4e1 * t932 * t192 + 0.6e1 * t404 * t436 + 0.4e1 * t173 * t953;
  t2005 = t5 * t863 * t194;
  t2008 = t5 * t376 * t438;
  t2011 = t5 * t150 * t955;
  t2014 = t5 * t851 * t194;
  t2016 = t5 * t367 * t438;
  t2021 = t19 * t19;
  t2023 = 0.1e1 / t348 / t2021;
  t2024 = t350 * t350;
  t2030 = t358 * t358;
  t2036 = 0.1e1 / t830 / t6;
  t2037 = t16 * t2036;
  t2040 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t831 + 0.24e2 * t2037);
  t2044 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t2024 - 0.16e2 / 0.9e1 * t823 * t350 * t358 + 0.4e1 / 0.3e1 * t349 * t2030 + 0.16e2 / 0.9e1 * t827 * t835 + 0.4e1 / 0.3e1 * t23 * t2040);
  t2053 = t5 * t844 * t194;
  t2059 = 0.1e1 / t148 / t353;
  t2063 = 0.1e2 / 0.27e2 * t5 * t25 * t2059 * t78;
  t2066 = t5 * t143 * t862 * t78;
  t2070 = t5 * t839 * t149 * t78;
  t2074 = t5 * t362 * t375 * t78;
  t2076 = -0.3e1 / 0.8e1 * t5 * t27 * (t1920 + t1999) - 0.5e1 / 0.9e1 * t2005 + t2008 / 0.2e1 - t2011 / 0.2e1 + t2014 - 0.3e1 / 0.2e1 * t2016 - 0.3e1 / 0.2e1 * t5 * t144 * t955 - 0.3e1 / 0.8e1 * t5 * t2044 * t26 * t78 - 0.3e1 / 0.2e1 * t5 * t840 * t194 - 0.3e1 / 0.2e1 * t2053 - 0.9e1 / 0.4e1 * t5 * t363 * t438 + t2063 - 0.5e1 / 0.9e1 * t2066 - t2070 / 0.2e1 + t2074 / 0.2e1;
  t2077 = my_piecewise3(t1, 0, t2076);
  t2078 = t87 * t87;
  t2080 = 0.1e1 / t444 / t2078;
  t2081 = t446 * t446;
  t2087 = t452 * t452;
  t2092 = t84 * t2036;
  t2095 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t831 + 0.24e2 * t2092);
  t2099 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2080 * t2081 - 0.16e2 / 0.9e1 * t962 * t446 * t452 + 0.4e1 / 0.3e1 * t445 * t2087 + 0.16e2 / 0.9e1 * t966 * t972 + 0.4e1 / 0.3e1 * t89 * t2095);
  t2106 = t5 * t976 * t149 * t131;
  t2110 = t5 * t456 * t375 * t131;
  t2114 = t5 * t205 * t862 * t131;
  t2119 = 0.1e2 / 0.27e2 * t5 * t91 * t2059 * t131;
  t2121 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t2099 * t26 * t131 - t2106 / 0.2e1 + t2110 / 0.2e1 - 0.5e1 / 0.9e1 * t2114 + t2119);
  tv4rho40 = 0.4e1 * t960 + 0.4e1 * t994 + t6 * (t2077 + t2121);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2128 = t5 * t222 * t862 * t78;
  t2132 = t5 * t481 * t375 * t78;
  t2133 = t2132 / 0.4e1;
  t2136 = t5 * t1014 * t149 * t78;
  t2142 = t5 * t1026 * t194;
  t2143 = t2142 / 0.4e1;
  t2145 = t5 * t486 * t438;
  t2163 = 0.12e2 * t831;
  t2164 = 0.24e2 * t2037;
  t2166 = my_piecewise5(t10, 0, t14, 0, -t2163 + t2164);
  t2170 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t219 * t824 - 0.8e1 / 0.9e1 * t823 * t477 * t350 - 0.8e1 / 0.9e1 * t999 * t140 * t358 + 0.4e1 / 0.3e1 * t349 * t1010 * t140 + 0.4e1 / 0.3e1 * t1002 * t358 + 0.4e1 / 0.9e1 * t473 * t835 + 0.4e1 / 0.3e1 * t23 * t2166);
  t2179 = t5 * t1019 * t194;
  t2193 = -0.5e1 / 0.36e2 * t2128 + t2133 - 0.3e1 / 0.8e1 * t2136 - 0.3e1 / 0.8e1 * t5 * t223 * t955 + t2143 - 0.3e1 / 0.8e1 * t2145 - 0.3e1 / 0.8e1 * t5 * t2170 * t26 * t78 - 0.9e1 / 0.8e1 * t5 * t1015 * t194 - 0.3e1 / 0.4e1 * t2179 - 0.9e1 / 0.8e1 * t5 * t482 * t438 - 0.5e1 / 0.12e2 * t2005 + t2008 / 0.4e1 - t2011 / 0.8e1 + t2014 / 0.2e1 - 0.3e1 / 0.8e1 * t2016 - 0.3e1 / 0.8e1 * t2053 + t2063 - 0.5e1 / 0.12e2 * t2066 - t2070 / 0.8e1 + t2074 / 0.4e1;
  t2194 = my_piecewise3(t1, 0, t2193);
  t2211 = 0.24e2 * t2092;
  t2213 = my_piecewise5(t14, 0, t10, 0, t2163 + t2211);
  t2217 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2080 * t230 * t963 - 0.8e1 / 0.9e1 * t962 * t501 * t446 - 0.8e1 / 0.9e1 * t1043 * t202 * t452 + 0.4e1 / 0.3e1 * t445 * t1053 * t202 + 0.4e1 / 0.3e1 * t1046 * t452 + 0.4e1 / 0.9e1 * t497 * t972 + 0.4e1 / 0.3e1 * t89 * t2213);
  t2224 = t5 * t1057 * t149 * t131;
  t2228 = t5 * t505 * t375 * t131;
  t2229 = t2228 / 0.4e1;
  t2232 = t5 * t233 * t862 * t131;
  t2241 = t5 * t981 * t278;
  t2244 = t5 * t985 * t278;
  t2245 = t2244 / 0.4e1;
  t2247 = t5 * t989 * t278;
  t2249 = -0.3e1 / 0.8e1 * t5 * t2217 * t26 * t131 - 0.3e1 / 0.8e1 * t2224 + t2229 - 0.5e1 / 0.36e2 * t2232 - t2106 / 0.8e1 + t2110 / 0.4e1 - 0.5e1 / 0.12e2 * t2114 + t2119 - 0.3e1 / 0.8e1 * t5 * t977 * t278 - 0.3e1 / 0.8e1 * t2241 + t2245 - 0.5e1 / 0.36e2 * t2247;
  t2250 = my_piecewise3(t83, 0, t2249);
  tv4rho41 = t960 + t994 + 0.3e1 * t1042 + 0.3e1 * t1082 + t6 * (t2194 + t2250);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2259 = t5 * t1098 * t149 * t78;
  t2263 = t5 * t536 * t375 * t78;
  t2273 = t477 * t477;
  t2286 = my_piecewise5(t10, 0, t14, 0, t2164);
  t2290 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t527 * t350 - 0.32e2 / 0.27e2 * t999 * t140 * t477 - 0.8e1 / 0.27e2 * t1085 * t358 + 0.8e1 / 0.9e1 * t349 * t2273 + 0.8e1 / 0.9e1 * t473 * t1010 - 0.8e1 / 0.27e2 * t823 * t532 * t350 + 0.8e1 / 0.9e1 * t349 * t1094 * t140 + 0.4e1 / 0.9e1 * t1090 * t358 + 0.4e1 / 0.3e1 * t23 * t2286);
  t2299 = t5 * t1103 * t194;
  t2315 = -t2259 / 0.4e1 + t2263 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t2290 * t26 * t78 - 0.3e1 / 0.4e1 * t5 * t1099 * t194 - t2299 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t537 * t438 - 0.5e1 / 0.18e2 * t2128 + t2132 / 0.3e1 - t2136 / 0.4e1 + t2142 / 0.3e1 - t2145 / 0.4e1 - t2179 / 0.2e1 - 0.5e1 / 0.18e2 * t2005 + t2008 / 0.12e2 + t2014 / 0.6e1 + t2063 - 0.5e1 / 0.18e2 * t2066 + t2074 / 0.12e2;
  t2316 = my_piecewise3(t1, 0, t2315);
  t2325 = t501 * t501;
  t2338 = my_piecewise5(t14, 0, t10, 0, t2211);
  t2342 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2080 * t544 * t446 - 0.32e2 / 0.27e2 * t1043 * t202 * t501 - 0.8e1 / 0.27e2 * t1115 * t452 + 0.8e1 / 0.9e1 * t445 * t2325 + 0.8e1 / 0.9e1 * t497 * t1053 - 0.8e1 / 0.27e2 * t962 * t549 * t446 + 0.8e1 / 0.9e1 * t445 * t1124 * t202 + 0.4e1 / 0.9e1 * t1120 * t452 + 0.4e1 / 0.3e1 * t89 * t2338);
  t2349 = t5 * t1128 * t149 * t131;
  t2353 = t5 * t553 * t375 * t131;
  t2362 = t5 * t1062 * t278;
  t2365 = t5 * t1066 * t278;
  t2376 = t5 * t461 * t618;
  t2379 = t5 * t465 * t618;
  t2381 = -0.3e1 / 0.8e1 * t5 * t2342 * t26 * t131 - t2349 / 0.4e1 + t2353 / 0.12e2 - t2224 / 0.4e1 + t2228 / 0.3e1 - 0.5e1 / 0.18e2 * t2232 - 0.3e1 / 0.4e1 * t5 * t1058 * t278 - t2362 / 0.2e1 + t2365 / 0.6e1 + t2110 / 0.12e2 - 0.5e1 / 0.18e2 * t2114 + t2119 - t2241 / 0.4e1 + t2244 / 0.3e1 - 0.5e1 / 0.18e2 * t2247 - 0.3e1 / 0.8e1 * t5 * t457 * t618 - t2376 / 0.4e1 + t2379 / 0.12e2;
  t2382 = my_piecewise3(t83, 0, t2381);
  tv4rho42 = 0.2e1 * t1042 + 0.2e1 * t1082 + 0.2e1 * t1114 + 0.2e1 * t1153 + t6 * (t2316 + t2382);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2403 = my_piecewise5(t10, 0, t14, 0, t2163 + t2164);
  t2407 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t1158 * t140 - 0.8e1 / 0.9e1 * t1085 * t477 - 0.8e1 / 0.9e1 * t999 * t532 * t140 + 0.4e1 / 0.3e1 * t1002 * t532 + 0.4e1 / 0.3e1 * t473 * t1094 + 0.4e1 / 0.9e1 * t349 * t1165 * t140 + 0.4e1 / 0.3e1 * t23 * t2403);
  t2414 = t5 * t1169 * t149 * t78;
  t2425 = -0.3e1 / 0.8e1 * t5 * t2407 * t26 * t78 - t2414 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1170 * t194 - 0.3e1 / 0.8e1 * t2259 + t2263 / 0.4e1 - 0.3e1 / 0.8e1 * t2299 + t2133 - 0.5e1 / 0.12e2 * t2128 + t2143 - 0.5e1 / 0.36e2 * t2066 + t2063 - 0.5e1 / 0.36e2 * t2005;
  t2426 = my_piecewise3(t1, 0, t2425);
  t2443 = my_piecewise5(t14, 0, t10, 0, -t2163 + t2211);
  t2447 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2080 * t1178 * t202 - 0.8e1 / 0.9e1 * t1115 * t501 - 0.8e1 / 0.9e1 * t1043 * t549 * t202 + 0.4e1 / 0.3e1 * t1046 * t549 + 0.4e1 / 0.3e1 * t497 * t1124 + 0.4e1 / 0.9e1 * t445 * t1185 * t202 + 0.4e1 / 0.3e1 * t89 * t2443);
  t2454 = t5 * t1189 * t149 * t131;
  t2462 = t5 * t1133 * t278;
  t2471 = t5 * t510 * t618;
  t2481 = t5 * t210 * t1287;
  t2483 = -0.3e1 / 0.8e1 * t5 * t2447 * t26 * t131 - t2454 / 0.8e1 - 0.3e1 / 0.8e1 * t2349 + t2353 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1129 * t278 - 0.3e1 / 0.8e1 * t2462 + t2229 - 0.5e1 / 0.12e2 * t2232 - 0.3e1 / 0.4e1 * t2362 + t2365 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t506 * t618 - 0.3e1 / 0.8e1 * t2471 - 0.5e1 / 0.36e2 * t2114 + t2119 + t2245 - 0.5e1 / 0.12e2 * t2247 - 0.3e1 / 0.8e1 * t2376 + t2379 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t206 * t1287 - t2481 / 0.8e1;
  t2484 = my_piecewise3(t83, 0, t2483);
  tv4rho43 = 0.3e1 * t1114 + 0.3e1 * t1153 + t1177 + t1292 + t6 * (t2426 + t2484);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2489 = t527 * t527;
  t2494 = t532 * t532;
  t2501 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t831 + 0.24e2 * t2037);
  t2505 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t2489 - 0.16e2 / 0.9e1 * t1085 * t532 + 0.4e1 / 0.3e1 * t349 * t2494 + 0.16e2 / 0.9e1 * t473 * t1165 + 0.4e1 / 0.3e1 * t23 * t2501);
  t2514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2505 * t26 * t78 - t2414 / 0.2e1 + t2263 / 0.2e1 - 0.5e1 / 0.9e1 * t2128 + t2063);
  t2525 = 0.1e1 / t94 / t262;
  t2526 = t270 * t2525;
  t2530 = 0.1e1 / t95 / t250;
  t2531 = t125 * t2530;
  t2538 = 0.1e1 / t1205 / t101 * t60;
  t2540 = t116 * t250;
  t2544 = 0.1e1 / t95 / t2540 * t28 * t32;
  t2550 = t1240 * t260;
  t2555 = t583 * t592;
  t2563 = 0.1e1 / t1541;
  t2564 = t114 * t2563;
  t2570 = -0.36e2 * t1252 * t595 * t605 + 0.24e2 * t593 * t598 * t605 + 0.8e1 * t593 * t267 * t1275 - 0.26462277468242006168e-1 * t565 * t2526 + 0.85978615454961133971e0 * t240 * t2531 + 0.24e2 * t1247 * t1257 - 0.32958275242668208782e-5 * t2538 * t1208 * t2544 - 0.4e1 * t261 * t1232 * t266 - 0.4e1 * t2550 * t267 - 0.12e2 * t586 * t1267 + 0.12e2 * t2555 * t595 + 0.24e2 * t1247 * t1264 - 0.24e2 * t1252 * t276 * t1253 + 0.13214620458547818311e-2 * t1207 * t2564 + 0.12e2 * t593 * t616 * t594;
  t2578 = 0.5225e4 / 0.1458e4 * t49 * t105 * t2525;
  t2588 = t605 * t605;
  t2592 = t256 * t1251;
  t2602 = t113 / t1250 / t120;
  t2603 = t594 * t594;
  t2611 = t116 * t116;
  t2639 = -0.4e1 * t261 * t276 * t1275 - 0.4e1 * t586 * t1276 - t261 * t129 * (t2578 + 0.55e2 / 0.16e2 * t115 * t2563) - 0.6e1 * t1280 * t606 - 0.12e2 * t1280 * t598 + 0.6e1 * t593 * t129 * t2588 - 0.24e2 * t2592 * t1254 - 0.6e1 * t261 * t616 * t605 - 0.12e2 * t586 * t1270 + 0.24e2 * t2602 * t129 * t2603 + 0.4e1 * t257 * t1232 + t122 * (0.13732614684445086993e-6 * t2538 * t1208 * sigma[2] / t94 / t2611 / rho[1] * t46 * t48 - 0.81757121523843825411e-4 * t1209 * t2544 + 0.17319411938484234374e-1 * t608 * t2564 - 0.25016887059899405578e0 * t269 * t2526 - 0.2618e4 / 0.243e3 * t124 * t2531) + (0.2618e4 / 0.243e3 * t33 * sigma[2] * t2530 + t2578) * t121 * t129 + 0.4e1 * t1241 * t276 + 0.6e1 * t584 * t616;
  t2647 = t544 * t544;
  t2652 = t549 * t549;
  t2659 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t831 + 0.24e2 * t2092);
  t2663 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2080 * t2647 - 0.16e2 / 0.9e1 * t1115 * t549 + 0.4e1 / 0.3e1 * t445 * t2652 + 0.16e2 / 0.9e1 * t497 * t1185 + 0.4e1 / 0.3e1 * t89 * t2659);
  t2682 = -0.3e1 / 0.8e1 * t5 * t92 * (t2570 + t2639) - 0.3e1 / 0.2e1 * t5 * t234 * t1287 - 0.3e1 / 0.8e1 * t5 * t2663 * t26 * t131 - 0.3e1 / 0.2e1 * t5 * t1190 * t278 - 0.9e1 / 0.4e1 * t5 * t554 * t618 - t2481 / 0.2e1 - t2454 / 0.2e1 - 0.3e1 / 0.2e1 * t2462 - 0.3e1 / 0.2e1 * t2471 + t2365 + t2379 / 0.2e1 + t2353 / 0.2e1 - 0.5e1 / 0.9e1 * t2247 - 0.5e1 / 0.9e1 * t2232 + t2119;
  t2683 = my_piecewise3(t83, 0, t2682);
  tv4rho44 = 0.4e1 * t1177 + 0.4e1 * t1292 + t6 * (t2514 + t2683);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2691 = t5 * t844 * t311;
  t2697 = t5 * t851 * t311;
  t2700 = t5 * t367 * t673;
  t2707 = 0.5e1 / 0.36e2 * t5 * t863 * t311;
  t2709 = t5 * t376 * t673;
  t2712 = t5 * t150 * t1401;
  t2719 = t644 * t412;
  t2731 = t906 * t50;
  t2745 = 0.209e3 / 0.243e3 * t49 * sigma[0] * t887;
  t2753 = 0.6e1 * t413 * t671 * t414 + 0.6e1 * t883 * t1352 + 0.6e1 * t2719 * t415 + 0.6e1 * t1357 * t925 - 0.6e1 * t406 * t1377 - 0.3e1 * t406 * t1380 - 0.3e1 * t177 * t1335 * t182 - 0.42797350348706002486e-3 * t914 * t2731 - 0.3e1 * t918 * t654 - 0.3e1 * t918 * t659 - 0.3e1 * t406 * t1373 - 0.3e1 * t177 * t192 * t1372 - t177 * t76 * (-t2745 - 0.15e2 / 0.16e2 * t297 * t906) - 0.3e1 * t918 * t662;
  t2767 = t1342 * t176;
  t2784 = -t177 * t300 * t953 - t177 * t309 * t909 - 0.3e1 * t177 * t425 * t671 - 0.3e1 * t177 * t436 * t658 - 0.6e1 * t309 * t875 * t876 - 0.6e1 * t1384 * t418 - 0.3e1 * t1384 * t426 - 0.3e1 * t1395 * t406 - 0.6e1 * t1397 * t406 - 0.3e1 * t183 * t2767 - t1910 * t301 - 0.3e1 * t647 * t896 - 0.3e1 * t647 * t899 - t647 * t910;
  t2786 = t32 * t892;
  t2789 = t294 * t874;
  t2792 = t875 * t76;
  t2818 = t48 * t887 * sigma[0];
  t2841 = -0.1517269684499314129e0 * t156 * t2786 - 0.6e1 * t2789 * t877 - 0.18e2 * t2792 * t300 * t425 * t182 + 0.12359353216000578294e-5 * t1958 * t942 * t1322 + t932 * t309 + 0.3e1 * t404 * t671 + 0.3e1 * t173 * t1335 + t69 * (-0.51497305066669076223e-7 * t1958 / t35 / t1969 * t938 * t46 * t48 + 0.27843305416921302787e-4 * t914 * t942 * t1322 - 0.5194809960089643065e-2 * t428 * t2731 + 0.62316433470507544585e-1 * t185 * t2818 + 0.154e3 / 0.81e2 * t71 * t2786) + (-0.154e3 / 0.81e2 * t33 * t892 - t2745) * t68 * t76 + 0.3e1 * t1343 * t192 + 0.3e1 * t645 * t436 + t295 * t953 + 0.6e1 * t413 * t1380 * t182 + 0.6e1 * t413 * t1395 * t182;
  t2880 = 0.6e1 * t413 * t1373 * t182 + 0.6e1 * t1357 * t880 + 0.6e1 * t1924 * t651 + 0.12e2 * t883 * t1360 + 0.12e2 * t883 * t1363 + 0.12e2 * t413 * t1397 * t182 - 0.18e2 * t875 * t659 * t414 - 0.18e2 * t1917 * t1347 + 0.24e2 * t1889 * t301 * t876 - 0.18e2 * t875 * t654 * t414 + 0.69128983273778274541e-2 * t385 * t2818 + 0.6e1 * t413 * t654 * t425 + 0.6e1 * t413 * t659 * t425 + 0.6e1 * t883 * t1367 + 0.2e1 * t413 * t301 * t909;
  t2887 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t840 * t311 - 0.3e1 / 0.8e1 * t2691 - 0.9e1 / 0.8e1 * t5 * t363 * t673 + t2697 / 0.4e1 - 0.3e1 / 0.4e1 * t2700 - 0.9e1 / 0.8e1 * t5 * t144 * t1401 - t2707 + t2709 / 0.4e1 - 0.3e1 / 0.8e1 * t2712 - 0.3e1 / 0.8e1 * t5 * t27 * (t2753 + t2784 + t2841 + t2880));
  tv4rho3sigma0 = t2887 * t6 + 0.3e1 * t1406;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2894 = t5 * t981 * t341;
  t2897 = t5 * t985 * t341;
  t2901 = 0.5e1 / 0.36e2 * t5 * t989 * t341;
  t2903 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t977 * t341 - 0.3e1 / 0.8e1 * t2894 + t2897 / 0.4e1 - t2901);
  tv4rho3sigma2 = t2903 * t6 + 0.3e1 * t1419;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2905 = 0.2e1 * t1433;
  t2911 = t5 * t1019 * t311 / 0.4e1;
  t2916 = t5 * t1026 * t311;
  t2920 = t5 * t486 * t673 / 0.4e1;
  t2929 = -0.3e1 / 0.8e1 * t5 * t1015 * t311 - t2911 - 0.3e1 / 0.4e1 * t5 * t482 * t673 + t2916 / 0.12e2 - t2920 - 0.3e1 / 0.8e1 * t5 * t223 * t1401 - t2691 / 0.8e1 + t2697 / 0.6e1 - t2700 / 0.4e1 - t2707 + t2709 / 0.6e1 - t2712 / 0.8e1;
  t2930 = my_piecewise3(t1, 0, t2929);
  tv4rho3sigma3 = t2930 * t6 + t1406 + t2905;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2932 = 0.2e1 * t1449;
  t2938 = t5 * t1062 * t341 / 0.4e1;
  t2940 = t5 * t1066 * t341;
  t2949 = t5 * t461 * t739 / 0.4e1;
  t2951 = t5 * t465 * t739;
  t2954 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1058 * t341 - t2938 + t2940 / 0.12e2 - t2894 / 0.8e1 + t2897 / 0.6e1 - t2901 - 0.3e1 / 0.8e1 * t5 * t457 * t739 - t2949 + t2951 / 0.12e2);
  tv4rho3sigma5 = t2954 * t6 + t1419 + t2932;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2960 = t5 * t1103 * t311;
  t2969 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1099 * t311 - t2960 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t537 * t673 - t2911 + t2916 / 0.6e1 - t2920 + t2697 / 0.12e2 - t2707 + t2709 / 0.12e2);
  tv4rho3sigma6 = t2969 * t6 + t1457 + t2905;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2975 = t5 * t1133 * t341;
  t2982 = t5 * t510 * t739;
  t2990 = t5 * t210 * t1558;
  t2992 = -0.3e1 / 0.8e1 * t5 * t1129 * t341 - t2975 / 0.8e1 - t2938 + t2940 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t506 * t739 - t2982 / 0.4e1 + t2897 / 0.12e2 - t2901 - t2949 + t2951 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t1558 - t2990 / 0.8e1;
  t2993 = my_piecewise3(t83, 0, t2992);
  tv4rho3sigma8 = t2993 * t6 + t1563 + t2932;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3002 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1170 * t311 - 0.3e1 / 0.8e1 * t2960 + t2916 / 0.4e1 - t2707);
  tv4rho3sigma9 = t3002 * t6 + 0.3e1 * t1457;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3022 = t1252 * t129;
  t3042 = t1218 * t105;
  t3046 = t48 * t1223 * sigma[2];
  t3049 = t32 * t1228;
  t3058 = 0.209e3 / 0.243e3 * t49 * sigma[2] * t1223;
  t3075 = 0.12359353216000578294e-5 * t2538 * t1212 * t1546 - 0.18e2 * t3022 * t330 * t605 * t266 + t1241 * t339 + 0.3e1 * t584 * t737 + 0.3e1 * t257 * t1555 + t122 * (-0.51497305066669076223e-7 * t2538 / t94 / t2611 * t1208 * t46 * t48 + 0.27843305416921302787e-4 * t1207 * t1212 * t1546 - 0.5194809960089643065e-2 * t608 * t3042 + 0.62316433470507544585e-1 * t269 * t3046 + 0.154e3 / 0.81e2 * t124 * t3049) + (-0.154e3 / 0.81e2 * t33 * t1228 - t3058) * t121 * t129 + 0.3e1 * t1533 * t276 + 0.3e1 * t711 * t616 + t325 * t1232 + 0.6e1 * t1527 * t1264 - 0.42797350348706002486e-3 * t1207 * t3042 - 0.3e1 * t586 * t1517 + 0.6e1 * t1247 * t1524;
  t3081 = t1532 * t260;
  t3087 = t710 * t592;
  t3113 = -0.3e1 * t261 * t737 * t605 - t261 * t339 * t1275 - 0.3e1 * t3081 * t267 + 0.6e1 * t593 * t737 * t594 + 0.6e1 * t3087 * t595 - 0.3e1 * t1280 * t728 - 0.6e1 * t586 * t1521 - 0.3e1 * t586 * t1477 - 0.3e1 * t261 * t1555 * t266 - 0.3e1 * t1280 * t725 - 0.3e1 * t586 * t1472 - 0.6e1 * t586 * t1474 - 0.3e1 * t261 * t276 * t1516 - t261 * t129 * (-t3058 - 0.15e2 / 0.16e2 * t327 * t1218);
  t3128 = t324 * t1251;
  t3146 = -0.3e1 * t1482 * t606 - 0.3e1 * t713 * t1267 - 0.3e1 * t713 * t1270 - t713 * t1276 - t2550 * t331 - 0.3e1 * t1280 * t720 - 0.6e1 * t1252 * t339 * t1253 - 0.6e1 * t3128 * t1254 - t261 * t1232 * t330 - 0.3e1 * t261 * t616 * t724 - 0.6e1 * t1482 * t598 - 0.1517269684499314129e0 * t240 * t3049 + 0.12e2 * t593 * t1474 * t266 + 0.6e1 * t593 * t720 * t605;
  t3185 = 0.6e1 * t593 * t1517 * t266 + 0.6e1 * t593 * t725 * t605 + 0.2e1 * t593 * t331 * t1275 + 0.6e1 * t593 * t728 * t605 + 0.24e2 * t2602 * t331 * t1253 - 0.18e2 * t2592 * t1498 - 0.18e2 * t1252 * t720 * t594 - 0.18e2 * t1252 * t725 * t594 + 0.69128983273778274541e-2 * t565 * t3046 + 0.6e1 * t1527 * t1257 + 0.6e1 * t2555 * t717 + 0.12e2 * t1247 * t1489 + 0.12e2 * t1247 * t1492 + 0.6e1 * t1247 * t1495 + 0.6e1 * t593 * t1472 * t266;
  t3192 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t1190 * t341 - 0.3e1 / 0.8e1 * t2975 - 0.9e1 / 0.8e1 * t5 * t554 * t739 + t2940 / 0.4e1 - 0.3e1 / 0.4e1 * t2982 - 0.9e1 / 0.8e1 * t5 * t234 * t1558 - t2901 + t2951 / 0.4e1 - 0.3e1 / 0.8e1 * t2990 - 0.3e1 / 0.8e1 * t5 * t92 * (t3075 + t3113 + t3146 + t3185));
  tv4rho3sigma11 = t3192 * t6 + 0.3e1 * t1563;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t3199 = t5 * t367 * t778;
  t3206 = t5 * t376 * t778 / 0.12e2;
  t3208 = t5 * t150 * t1654;
  t3210 = t658 * t658;
  t3214 = t412 * t76;
  t3223 = t176 * t192;
  t3227 = t300 * t182;
  t3244 = t422 * sigma[0];
  t3269 = 0.4e1 * t413 * t76 * t3210 + t763 * t3214 * t414 / 0.144e3 + t1578 * t1632 / 0.27e2 - t763 * t1631 * t425 / 0.288e3 - t763 * t3223 * t182 / 0.144e3 - 0.24e2 * t2792 * t3227 * t658 + t404 * t776 + 0.2e1 * t173 * t1647 + t69 * (0.19311489400000903584e-7 * t1958 / t35 / t63 / t386 * t61 * t46 * t48 - 0.87987973578754116953e-5 * t1320 * t1640 + 0.12695608731731274026e-2 * t428 * t3244 - 0.93597805212620027437e-2 * t185 * t1328) + 0.2e1 * t1343 * t309 + 0.4e1 * t645 * t671 + 0.2e1 * t295 * t1335 - 0.463475745600021686e-6 * t1958 * t1319 * t1640 - 0.11555284594150620671e-2 * t385 * t1328 + 0.2e1 * t413 * t436 * t756 - 0.2e1 * t918 * t760 + 0.12107145164436566493e-3 * t914 * t3244;
  t3308 = -0.2e1 * t1335 * t177 * t300 - 0.2e1 * t1372 * t177 * t309 - 0.2e1 * t1647 * t177 * t182 - t177 * t436 * t768 - 0.4e1 * t177 * t658 * t671 + 0.2e1 * t413 * t414 * t776 + 0.4e1 * t1352 * t1357 - 0.2e1 * t1373 * t647 - 0.2e1 * t1395 * t647 - 0.4e1 * t1397 * t647 - 0.2e1 * t1576 * t406 - 0.2e1 * t1583 * t406 + 0.4e1 * t1594 * t883 - 0.4e1 * t1599 * t406 - 0.4e1 * t1602 * t406 + 0.2e1 * t1924 * t757 - t769 * t918;
  t3356 = -t177 * t776 * t425 - 0.2e1 * t2767 * t301 - 0.4e1 * t1384 * t654 - 0.4e1 * t1384 * t659 - 0.4e1 * t1384 * t662 - 0.4e1 * t647 * t1377 - 0.2e1 * t647 * t1380 - 0.2e1 * t177 * t192 * t1582 - t177 * t76 * (0.19e2 / 0.162e3 * t49 * t388 + 0.3e1 / 0.16e2 * t765 * t422) - 0.2e1 * t406 * t1585 - 0.12e2 * t875 * t760 * t414 - t49 * t1622 * t192 / 0.27e2 - 0.12e2 * t2789 * t1347 + 0.24e2 * t1889 * t757 * t414 - 0.6e1 * t875 * t769 * t414 + 0.19e2 / 0.162e3 * t49 * t388 * t68 * t76 + 0.8e1 * t883 * t1616;
  t3404 = 0.8e1 * t413 * t1599 * t182 - 0.6e1 * t875 * t757 * t425 + 0.8e1 * t883 * t1613 + 0.8e1 * t413 * t654 * t658 + 0.4e1 * t413 * t301 * t1372 + 0.8e1 * t1357 * t1360 + 0.8e1 * t1357 * t1363 + 0.4e1 * t1357 * t1367 - 0.12e2 * t1917 * t1610 - 0.12e2 * t875 * t1594 * t182 + 0.4e1 * t413 * t1576 * t182 + 0.4e1 * t413 * t1583 * t182 + 0.2e1 * t413 * t769 * t425 + t49 * t748 * t436 / 0.288e3 + 0.8e1 * t2719 * t651 + 0.8e1 * t413 * t1602 * t182 + 0.4e1 * t413 * t760 * t425 + 0.4e1 * t883 * t1619;
  t3411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t363 * t778 - t3199 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t144 * t1654 + t3206 - t3208 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t3269 + t3308 + t3356 + t3404));
  tv4rho2sigma20 = t3411 * t6 + 0.2e1 * t1659;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t3418 = t5 * t461 * t815;
  t3422 = t5 * t465 * t815 / 0.12e2;
  t3424 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t457 * t815 - t3418 / 0.4e1 + t3422);
  tv4rho2sigma25 = t3424 * t6 + 0.2e1 * t1668;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t3430 = t5 * t486 * t778;
  t3438 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t482 * t778 - t3430 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t1654 - t3199 / 0.8e1 + t3206 - t3208 / 0.8e1);
  tv4rho2sigma26 = t3438 * t6 + t1659 + t1674;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t3444 = t5 * t510 * t815;
  t3451 = t5 * t210 * t1762;
  t3454 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t506 * t815 - t3444 / 0.8e1 - t3418 / 0.8e1 + t3422 - 0.3e1 / 0.8e1 * t5 * t206 * t1762 - t3451 / 0.8e1);
  tv4rho2sigma211 = t3454 * t6 + t1668 + t1767;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t3462 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t537 * t778 - t3430 / 0.4e1 + t3206);
  tv4rho2sigma212 = t3462 * t6 + 0.2e1 * t1674;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t3475 = t724 * t724;
  t3482 = t602 * sigma[2];
  t3513 = -0.11555284594150620671e-2 * t565 * t1502 + 0.4e1 * t593 * t129 * t3475 + 0.2e1 * t593 * t813 * t594 + 0.12107145164436566493e-3 * t1207 * t3482 + 0.4e1 * t1527 * t1524 - 0.4e1 * t586 * t1681 - 0.4e1 * t586 * t1684 - 0.2e1 * t261 * t1555 * t330 - 0.4e1 * t261 * t737 * t724 - 0.2e1 * t261 * t339 * t1516 - t1280 * t806 - 0.2e1 * t713 * t1472 - 0.4e1 * t713 * t1474 - 0.2e1 * t713 * t1517 - 0.2e1 * t713 * t1477 + 0.2e1 * t2555 * t794 + 0.4e1 * t1247 * t1694;
  t3555 = 0.2e1 * t593 * t616 * t793 - 0.2e1 * t1280 * t797 - 0.2e1 * t261 * t1759 * t266 - 0.2e1 * t586 * t1699 - t261 * t616 * t805 - 0.2e1 * t261 * t276 * t1705 - 0.2e1 * t586 * t1706 - t261 * t129 * (0.19e2 / 0.162e3 * t49 * t568 + 0.3e1 / 0.16e2 * t802 * t602) - t261 * t813 * t605 - 0.2e1 * t3081 * t331 - 0.4e1 * t1482 * t720 - 0.4e1 * t1482 * t725 - 0.4e1 * t1482 * t728 - 0.4e1 * t713 * t1521 - 0.2e1 * t586 * t1708 + 0.2e1 * t325 * t1555 + t584 * t813;
  t3614 = 0.2e1 * t257 * t1759 + t122 * (0.19311489400000903584e-7 * t2538 / t94 / t116 / t566 * t114 * t46 * t48 - 0.87987973578754116953e-5 * t1544 * t1752 + 0.12695608731731274026e-2 * t608 * t3482 - 0.93597805212620027437e-2 * t269 * t1502) + 0.2e1 * t1533 * t339 + 0.4e1 * t711 * t737 + 0.19e2 / 0.162e3 * t49 * t568 * t121 * t129 - 0.12e2 * t3128 * t1498 + 0.24e2 * t2602 * t794 * t594 - 0.12e2 * t1252 * t797 * t594 - 0.6e1 * t1252 * t806 * t594 + 0.8e1 * t3087 * t717 + 0.8e1 * t1527 * t1489 + 0.8e1 * t1527 * t1492 + 0.4e1 * t593 * t1699 * t266 + 0.8e1 * t593 * t1681 * t266 + 0.8e1 * t593 * t1684 * t266 + 0.4e1 * t593 * t1706 * t266 + 0.8e1 * t1247 * t1736;
  t3647 = t592 * t129;
  t3651 = t330 * t266;
  t3657 = t260 * t276;
  t3667 = -0.12e2 * t1252 * t1694 * t266 + 0.8e1 * t593 * t720 * t724 + 0.8e1 * t1247 * t1718 + 0.4e1 * t1247 * t1721 - t49 * t1724 * t276 / 0.27e2 + t49 * t785 * t616 / 0.288e3 + 0.4e1 * t1527 * t1495 - 0.12e2 * t2592 * t1733 - 0.6e1 * t1252 * t794 * t605 + 0.4e1 * t593 * t331 * t1516 + 0.4e1 * t593 * t797 * t605 + 0.2e1 * t593 * t806 * t605 + t800 * t3647 * t594 / 0.144e3 - 0.24e2 * t3022 * t3651 * t724 + t1701 * t1740 / 0.27e2 - t800 * t3657 * t266 / 0.144e3 - t800 * t1739 * t605 / 0.288e3 - 0.463475745600021686e-6 * t2538 * t1543 * t1752;
  t3674 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t554 * t815 - t3444 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t1762 + t3422 - t3451 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t92 * (t3513 + t3555 + t3614 + t3667));
  tv4rho2sigma217 = t3674 * t6 + 0.2e1 * t1767;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t3681 = t5 * t150 * t1816 / 0.8e1;
  t3716 = -0.3e1 * t647 * t1583 + 0.6e1 * t883 * t1807 + 0.6e1 * t413 * t671 * t756 - 0.3e1 * t406 * t1810 - 0.3e1 * t177 * t1647 * t300 - t49 * t1622 * t309 / 0.18e2 + t49 * t748 * t671 / 0.96e2 + t177 * t1772 * t179 / 0.48e2 + 0.12e2 * t1357 * t1616 + 0.6e1 * t883 * t1769 + 0.6e1 * t413 * t654 * t768 + 0.6e1 * t413 * t659 * t768 + 0.6e1 * t413 * t301 * t1582;
  t3762 = -t406 * t1773 / 0.384e3 - t177 * t192 * t60 * t64 / 0.384e3 + 0.12e2 * t1357 * t1613 + 0.24e2 * t1889 * t1782 * t182 - 0.18e2 * t875 * t757 * t658 + 0.6e1 * t413 * t1800 * t182 + 0.6e1 * t1357 * t1619 - 0.18e2 * t875 * t1807 * t182 + 0.12e2 * t413 * t760 * t658 + 0.6e1 * t413 * t1810 * t182 - 0.18e2 * t2789 * t1610 + t69 * (-0.72418085250003388439e-8 * t1958 / t35 / t1960 * t50 * t46 * t48 + 0.24636632602051152748e-5 * t1638 * t1789 - 0.20525834476451760403e-3 * t428 * t179) + 0.3e1 * t645 * t776;
  t3794 = 0.3e1 * t295 * t1647 + t173 * t1794 - 0.25340536390681185682e-4 * t914 * t179 + t763 * t3214 * t3227 / 0.48e2 - 0.3e1 * t177 * t309 * t1582 - 0.6e1 * t1384 * t760 - 0.6e1 * t647 * t1599 - 0.6e1 * t647 * t1602 - 0.3e1 * t1384 * t769 - 0.3e1 * t647 * t1576 - t763 * t3223 * t300 / 0.96e2 - t763 * t1631 * t658 / 0.96e2 + 0.17380340460000813225e-6 * t1958 * t1637 * t1789;
  t3799 = t413 * t76;
  t3804 = t176 * t309;
  t3831 = -0.18e2 * t2792 * t300 * t768 * t182 + t3799 * t60 * t64 * t182 / 0.192e3 - t763 * t3804 * t182 / 0.96e2 + t1578 * t1813 / 0.18e2 - 0.3e1 * t177 * t776 * t658 + 0.6e1 * t2719 * t757 + 0.6e1 * t1357 * t1594 - 0.6e1 * t1917 * t1782 - 0.6e1 * t875 * t192 * t1781 - t177 * t1794 * t182 - 0.3e1 * t647 * t1585 - 0.3e1 * t406 * t1800 - 0.3e1 * t177 * t671 * t768;
  t3838 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t144 * t1816 - t3681 - 0.3e1 / 0.8e1 * t5 * t27 * (t3716 + t3762 + t3794 + t3831));
  tv4rhosigma30 = t3838 * t6 + t1820;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t3845 = t5 * t210 * t1868 / 0.8e1;
  t3847 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t206 * t1868 - t3845);
  tv4rhosigma39 = t3847 * t6 + t1872;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3853 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t1816 - t3681);
  tv4rhosigma310 = t3853 * t6 + t1820;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t3863 = t593 * t129;
  t3864 = t60 * t117;
  t3868 = t260 * t339;
  t3896 = -0.25340536390681185682e-4 * t1207 * t263 + t800 * t3647 * t3651 / 0.48e2 + t3863 * t3864 * t266 / 0.192e3 - t800 * t3868 * t266 / 0.96e2 + t1701 * t1865 / 0.18e2 - t800 * t3657 * t330 / 0.96e2 - t800 * t1739 * t724 / 0.96e2 - 0.18e2 * t3022 * t330 * t805 * t266 + 0.17380340460000813225e-6 * t2538 * t1749 * t1845 - 0.3e1 * t586 * t1852 - 0.3e1 * t261 * t737 * t805 + 0.6e1 * t1527 * t1694 - 0.6e1 * t2592 * t1831;
  t3927 = -0.6e1 * t1252 * t1830 * t276 - 0.3e1 * t1759 * t261 * t330 - t1850 * t261 * t266 - 0.3e1 * t261 * t724 * t813 + 0.6e1 * t593 * t737 * t793 + 0.6e1 * t1247 * t1859 - 0.3e1 * t1482 * t806 - 0.6e1 * t1684 * t713 - 0.3e1 * t1699 * t713 - 0.3e1 * t1706 * t713 - 0.3e1 * t1708 * t713 - 0.3e1 * t1862 * t586 + 0.6e1 * t3087 * t794;
  t3969 = -0.3e1 * t261 * t339 * t1705 - 0.6e1 * t1482 * t797 - 0.6e1 * t713 * t1681 + 0.3e1 * t711 * t813 + 0.3e1 * t325 * t1759 + t257 * t1850 + t122 * (-0.72418085250003388439e-8 * t2538 / t94 / t2540 * t105 * t46 * t48 + 0.24636632602051152748e-5 * t1750 * t1845 - 0.20525834476451760403e-3 * t608 * t263) - 0.18e2 * t3128 * t1733 + 0.12e2 * t1527 * t1736 + 0.24e2 * t2602 * t1831 * t266 - 0.18e2 * t1252 * t794 * t724 + 0.6e1 * t1247 * t1834 + 0.6e1 * t593 * t720 * t805;
  t4007 = 0.12e2 * t1527 * t1718 + 0.6e1 * t1527 * t1721 - 0.18e2 * t1252 * t1859 * t266 + 0.12e2 * t593 * t797 * t724 + 0.6e1 * t593 * t1862 * t266 + 0.6e1 * t593 * t725 * t805 + 0.6e1 * t593 * t331 * t1705 + 0.6e1 * t593 * t1852 * t266 - t586 * t1822 / 0.384e3 - t261 * t276 * t60 * t117 / 0.384e3 + t49 * t785 * t737 / 0.96e2 + t261 * t1821 * t263 / 0.48e2 - t49 * t1724 * t339 / 0.18e2;
  t4014 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t234 * t1868 - t3845 - 0.3e1 / 0.8e1 * t5 * t92 * (t3896 + t3927 + t3969 + t4007));
  tv4rhosigma319 = t4014 * t6 + t1872;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t4047 = t763 * t3214 * t756 / 0.24e2 - t763 * t1631 * t768 / 0.48e2 - 0.36e2 * t875 * t757 * t768 + t3799 * t300 * t60 * t64 / 0.48e2 - t763 * t3804 * t300 / 0.24e2 - 0.12e2 * t647 * t1810 - 0.12e2 * t647 * t1800 - 0.6e1 * t177 * t776 * t768 + 0.12e2 * t413 * t776 * t756 + 0.24e2 * t1357 * t1807 - 0.24e2 * t875 * t309 * t1781;
  t4053 = t756 * t756;
  t4058 = t1786 * t28 * t32;
  t4066 = t768 * t768;
  t4092 = -0.4e1 * t177 * t1794 * t300 - 0.24e2 * t2789 * t1782 + 0.24e2 * t1889 * t76 * t4053 - 0.65176276725003049595e-7 * t1958 * t4058 + 0.24e2 * t1357 * t1769 + 0.24e2 * t413 * t760 * t768 + 0.6e1 * t413 * t76 * t4066 - t647 * t1773 / 0.96e2 - t177 * t309 * t60 * t64 / 0.96e2 + t49 * t748 * t776 / 0.48e2 + 0.4e1 * t295 * t1794 + t69 * (0.27156781968751270665e-8 * t1958 / t35 / t940 * sigma[0] * t46 * t48 - 0.52792784147252470173e-6 * t914 * t4058);
  t4097 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (t4047 + t4092));
  tv4sigma40 = t6 * t4097;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t4128 = t800 * t3647 * t793 / 0.24e2 - t800 * t1739 * t805 / 0.48e2 + t3863 * t3864 * t330 / 0.48e2 - t800 * t3868 * t330 / 0.24e2 - 0.4e1 * t261 * t1850 * t330 - 0.12e2 * t713 * t1852 - 0.6e1 * t261 * t813 * t805 + 0.12e2 * t593 * t813 * t793 + 0.24e2 * t1527 * t1859 - 0.24e2 * t1252 * t339 * t1830 - 0.12e2 * t713 * t1862;
  t4139 = t1842 * t28 * t32;
  t4157 = t793 * t793;
  t4167 = t805 * t805;
  t4173 = 0.4e1 * t325 * t1850 + t122 * (0.27156781968751270665e-8 * t2538 / t94 / t1210 * sigma[2] * t46 * t48 - 0.52792784147252470173e-6 * t1207 * t4139) - t713 * t1822 / 0.96e2 - t261 * t339 * t60 * t117 / 0.96e2 + t49 * t785 * t813 / 0.48e2 - 0.24e2 * t3128 * t1831 + 0.24e2 * t1527 * t1834 + 0.24e2 * t2602 * t129 * t4157 - 0.36e2 * t1252 * t794 * t805 + 0.24e2 * t593 * t797 * t805 + 0.6e1 * t593 * t129 * t4167 - 0.65176276725003049595e-7 * t2538 * t4139;
  t4178 = my_piecewise3(t83, 0, -0.3e1 / 0.8e1 * t5 * t92 * (t4128 + t4173));
  tv4sigma414 = t6 * t4178;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

