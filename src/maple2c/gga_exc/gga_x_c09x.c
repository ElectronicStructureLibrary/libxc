/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_c09x.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49;

#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, t90, t93, t94, t100, t104;

#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, t155;
  double t156, t160, t161, t170, t175, t180, t187, t191;

#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, tv2rho20;
  double t155, t156, t160, t161, t170, t175, tv2rhosigma0, t180;
  double t187, t191, tv2sigma20;

  double t194, t206, t207, t211, t212, t216, t217, t218;
  double t221, t222, t224, t227, t228, t231, t239, t244;
  double t256, t260, t263, t265, t277, t282, t290, t294;
  double t304, t309, t315, t322, t326;

#ifndef XC_DONT_COMPILE_LXC
  double t344, t350, t355, t358, t362, t366, t373, t384;
  double t392, t407, t411, t415, t438, t450, t454, t475;
  double t484, t504, t507, t522;
#endif

#endif

#endif

#endif

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, tv2rho20;
  double t155, t156, t160, t161, t170, t175, tv2rhosigma0, t180;
  double t187, t191, tv2sigma20;

  double t194, t206, t207, t211, t212, t216, t217, t218;
  double t221, t222, t224, t227, t228, t231, t239, t244;
  double tv3rho30, t256, t260, t263, t265, t277, t282, tv3rho2sigma0;
  double t290, t294, t304, t309, tv3rhosigma20, t315, t322, t326;
  double tv3sigma30;

  double t344, t350, t355, t358, t362, t366, t373, t384;
  double t392, tv4rho40, t407, t411, t415, t438, tv4rho3sigma0, t450;
  double t454, t475, tv4rho2sigma20, t484, t504, tv4rhosigma30, t507, t522;
  double tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125000000000000000e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.10062500000000000000e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t49;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t51 = t17 / t30;
  t55 = t29 * rho[0];
  t57 = 0.1e1 / t30 / t55;
  t58 = t28 * t57;
  t59 = t58 * t38;
  t62 = t20 * t20;
  t64 = 0.1e1 / t22 / t21;
  t65 = t62 * t64;
  t66 = sigma[0] * sigma[0];
  t67 = t65 * t66;
  t68 = t29 * t29;
  t69 = t68 * t29;
  t71 = 0.1e1 / t18 / t69;
  t72 = t27 * t71;
  t73 = t72 * t38;
  t76 = t58 * t43;
  t79 = -0.68555555555555555555e-2 * t26 * t59 + 0.27593611111111111110e-4 * t67 * t73 - 0.33407500000000000000e-2 * t26 * t76;
  t84 = my_piecewise3(t2, 0, -t6 * t51 * t45 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t79);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t84 + 0.2e1 * t49;

  t90 = t68 * rho[0];
  t93 = t27 / t18 / t90;
  t94 = t93 * t38;
  t100 = 0.25708333333333333333e-2 * t25 * t39 - 0.10347604166666666667e-4 * t65 * sigma[0] * t94 + 0.12527812500000000000e-2 * t25 * t33 * t43;
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t100);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t104;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t109 = t17 / t30 / rho[0];
  t118 = t28 / t30 / t68;
  t119 = t118 * t38;
  t122 = t68 * t55;
  t124 = 0.1e1 / t18 / t122;
  t125 = t27 * t124;
  t126 = t125 * t38;
  t129 = t66 * sigma[0];
  t130 = t68 * t68;
  t131 = t130 * t29;
  t132 = 0.1e1 / t131;
  t136 = t118 * t43;
  t139 = t125 * t43;
  t142 = 0.25137037037037037037e-1 * t26 * t119 - 0.24834249999999999999e-3 * t67 * t126 + 0.18242943617400669616e-7 * t129 * t132 * t38 + 0.12249416666666666667e-1 * t26 * t136 - 0.17928691666666666666e-4 * t67 * t139;
  t147 = my_piecewise3(t2, 0, t6 * t109 * t45 / 0.12e2 - t6 * t51 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t142);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t147 + 0.4e1 * t84;

  t155 = t65 * t27;
  t156 = t71 * sigma[0];
  t160 = t130 * rho[0];
  t161 = 0.1e1 / t160;
  t170 = -0.68555555555555555555e-2 * t25 * t59 + 0.82780833333333333334e-4 * t155 * t156 * t38 - 0.68411038565252511063e-8 * t66 * t161 * t38 - 0.33407500000000000000e-2 * t25 * t76 + 0.67232593749999999999e-5 * t155 * t156 * t43;
  t175 = my_piecewise3(t2, 0, -t6 * t51 * t100 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t170);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t175 + 0.2e1 * t104;

  t180 = 0.1e1 / t130;
  t187 = -0.20695208333333333334e-4 * t65 * t94 + 0.25654139461969691649e-8 * sigma[0] * t180 * t38 - 0.25212222656250000000e-5 * t65 * t93 * t43;
  t191 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t187);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t191;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t194 = t17 * t32;
  t206 = t28 / t30 / t90;
  t207 = t206 * t38;
  t211 = 0.1e1 / t18 / t130;
  t212 = t27 * t211;
  t216 = t130 * t55;
  t217 = 0.1e1 / t216;
  t218 = t129 * t217;
  t221 = t66 * t66;
  t222 = t130 * t90;
  t224 = 0.1e1 / t30 / t222;
  t227 = t24 * t28;
  t228 = t227 * t38;
  t231 = t206 * t43;
  t239 = -0.11730617283950617284e0 * t26 * t207 + 0.20909825308641975308e-2 * t67 * t212 * t38 - 0.34661592873061272270e-6 * t218 * t38 + 0.97903797413383593606e-10 * t221 * t224 * t20 * t228 - 0.57163944444444444446e-1 * t26 * t231 + 0.19721560833333333333e-3 * t67 * t212 * t43 - 0.59265913020905627571e-8 * t218 * t43;
  t244 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t194 * t45 + t6 * t109 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t142 - 0.3e1 / 0.8e1 * t6 * t19 * t239);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t244 + 0.6e1 * t147;

  t256 = t124 * sigma[0];
  t260 = t132 * t66;
  t263 = t130 * t68;
  t265 = 0.1e1 / t30 / t263;
  t277 = 0.25137037037037037037e-1 * t25 * t119 - 0.59786157407407407408e-3 * t155 * t256 * t38 + 0.11629876556092926881e-6 * t260 * t38 - 0.36713924030018847604e-10 * t129 * t265 * t20 * t228 + 0.12249416666666666667e-1 * t25 * t136 - 0.60509334374999999999e-4 * t155 * t256 * t43 + 0.22224717382839610340e-8 * t260 * t43;
  t282 = my_piecewise3(t2, 0, t6 * t109 * t100 / 0.12e2 - t6 * t51 * t170 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t282 + 0.4e1 * t175;

  t290 = t161 * sigma[0];
  t294 = 0.1e1 / t30 / t216;
  t304 = 0.11037444444444444445e-3 * t65 * t73 - 0.34205519282626255532e-7 * t290 * t38 + 0.13767721511257067852e-10 * t66 * t294 * t20 * t228 + 0.13446518750000000000e-4 * t65 * t72 * t43 - 0.83342690185648538775e-9 * t290 * t43;
  t309 = my_piecewise3(t2, 0, -t6 * t51 * t187 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t304);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t309 + 0.2e1 * t191;

  t315 = 0.1e1 / t30 / t131;
  t322 = 0.76962418385909074947e-8 * t180 * t38 - 0.51628955667214004444e-11 * sigma[0] * t315 * t20 * t228 + 0.31253508819618202039e-9 * t180 * t43;
  t326 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t322);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t326;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t344 = t28 / t30 / t69;
  t350 = t27 / t18 / t160;
  t355 = t129 / t263;
  t358 = t130 * t69;
  t362 = t221 / t30 / t358 * t20;
  t366 = t130 * t130;
  t373 = t64 * t27 * t38;
  t384 = t227 * t43;
  t392 = my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t17 * t57 * t45 - 0.5e1 / 0.9e1 * t6 * t194 * t79 + t6 * t109 * t142 / 0.2e1 - t6 * t51 * t239 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.66473497942386831276e0 * t26 * t344 * t38 - 0.18683940679012345679e-1 * t67 * t350 * t38 + 0.51951849434886573584e-5 * t355 * t38 - 0.31981907155038640578e-8 * t362 * t228 + 0.10508340922369839047e-11 * t221 * sigma[0] / t18 / t366 / rho[0] * t62 * t373 + 0.32392901851851851853e0 * t26 * t344 * t43 - 0.19502432379629629629e-2 * t67 * t350 * t43 + 0.13038500864599238066e-6 * t355 * t43 - 0.15903019993943010065e-10 * t362 * t384));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t392 + 0.8e1 * t244;

  t407 = t211 * sigma[0];
  t411 = t217 * t66;
  t415 = t224 * t129 * t20;
  t438 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t194 * t100 + t6 * t109 * t170 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t277 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.11730617283950617284e0 * t25 * t207 + 0.46541224074074074074e-2 * t155 * t407 * t38 - 0.15582514339863071965e-5 * t411 * t38 + 0.10891797462238924789e-8 * t415 * t228 - 0.39406278458886896427e-12 * t221 / t18 / t366 * t62 * t373 - 0.57163944444444444446e-1 * t25 * t231 + 0.50947365486111111110e-3 * t155 * t407 * t43 - 0.42226963027395259646e-7 * t411 * t43 + 0.59636324977286287745e-11 * t415 * t384));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t438 + 0.6e1 * t282;

  t450 = t132 * sigma[0];
  t454 = t265 * t66 * t20;
  t475 = my_piecewise3(t2, 0, t6 * t109 * t187 / 0.12e2 - t6 * t51 * t304 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.69903814814814814818e-3 * t65 * t126 + 0.38082144801323897826e-6 * t450 * t38 - 0.34419303778142669629e-9 * t454 * t228 + 0.14777354422082586161e-12 * t129 / t18 / t130 / t122 * t62 * t373 - 0.85161285416666666667e-4 * t65 * t139 + 0.11945785593276290558e-7 * t450 * t43 - 0.22363621866482357904e-11 * t454 * t384));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t475 + 0.4e1 * t309;

  t484 = t294 * t20 * t24;
  t504 = my_piecewise3(t2, 0, -t6 * t51 * t322 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.61569934708727259958e-7 * t161 * t38 + 0.96374050578799474962e-10 * t484 * t34 * t38 - 0.55415079082809698102e-13 * t66 / t18 / t358 * t62 * t373 - 0.25002807055694561631e-8 * t161 * t43 + 0.83863581999308842137e-12 * t484 * t34 * t43));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t504 + 0.2e1 * t326;

  t507 = t315 * t20;
  t522 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-0.20651582266885601777e-10 * t507 * t228 + 0.20780654656053636789e-13 * sigma[0] / t18 / t222 * t62 * t373 - 0.31448843249740815802e-12 * t507 * t384));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t522;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83;

#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t47, t49, t53, t54, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t66;
  double t67, t68, t70, t75, t77, t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t107, t110;
  double t111, t112, t113, t115, t123, t128, t130, t133;
  double t134, t138, t141, t143, tvrho0, t146, t147, t150;
  double t151, t156, t158, t161, t162, t166, t168, t169;
  double t173, t174, t175, t177, t185, t190, tvrho1, t196;
  double t198, t206, t210, tvsigma0, tvsigma1, t214, t216, t224;
  double t228, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = rho[1] * rho[1];
  t63 = POW_1_3(rho[1]);
  t64 = t63 * t63;
  t66 = 0.1e1 / t64 / t62;
  t67 = sigma[2] * t66;
  t68 = t33 * t67;
  t70 = exp(-0.20125e-2 * t68);
  t75 = exp(-0.100625e-2 * t68);
  t77 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t67 * t70 - 0.1245e1 * t75;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = t34 * rho[0];
  t102 = 0.1e1 / t36 / t100;
  t103 = sigma[0] * t102;
  t107 = t28 * t28;
  t110 = t107 / t30 / t29;
  t111 = sigma[0] * sigma[0];
  t112 = t34 * t34;
  t113 = t112 * t34;
  t115 = 0.1e1 / t35 / t113;
  t123 = -0.68555555555555555555e-2 * t33 * t103 * t42 + 0.13796805555555555555e-4 * t110 * t111 * t115 * t42 - 0.334075e-2 * t33 * t103 * t47;
  t128 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t123);
  t130 = my_piecewise5(t14, 0, t10, 0, -t85);
  t133 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t130);
  t134 = t133 * t26;
  t138 = t60 * t95;
  t141 = t5 * t138 * t77 / 0.8e1;
  t143 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t77 - t141);
  tvrho0 = t53 + t81 + t6 * (t128 + t143);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t7 - t84;
  t147 = my_piecewise5(t10, 0, t14, 0, t146);
  t150 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t147);
  t151 = t150 * t26;
  t156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t49 - t99);
  t158 = my_piecewise5(t14, 0, t10, 0, -t146);
  t161 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t158);
  t162 = t161 * t26;
  t166 = t62 * rho[1];
  t168 = 0.1e1 / t64 / t166;
  t169 = sigma[2] * t168;
  t173 = sigma[2] * sigma[2];
  t174 = t62 * t62;
  t175 = t174 * t62;
  t177 = 0.1e1 / t63 / t175;
  t185 = -0.68555555555555555555e-2 * t33 * t169 * t70 + 0.13796805555555555555e-4 * t110 * t173 * t177 * t70 - 0.334075e-2 * t33 * t169 * t75;
  t190 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t77 - t141 - 0.3e1 / 0.8e1 * t5 * t61 * t185);
  tvrho1 = t53 + t81 + t6 * (t156 + t190);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t196 = t112 * rho[0];
  t198 = 0.1e1 / t35 / t196;
  t206 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t110 * sigma[0] * t198 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t206);
  tvsigma0 = t6 * t210;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t214 = t174 * rho[1];
  t216 = 0.1e1 / t63 / t214;
  t224 = 0.25708333333333333333e-2 * t33 * t66 * t70 - 0.51738020833333333333e-5 * t110 * sigma[2] * t216 * t70 + 0.125278125e-2 * t33 * t66 * t75;
  t228 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t224);
  tvsigma2 = t6 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t47, t49, t53, t54, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t66;
  double t67, t68, t70, t75, t77, t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t107, t110;
  double t111, t112, t113, t115, t123, t128, t130, t133;
  double t134, t138, t141, t143, tvrho0, t146, t147, t150;
  double t151, t156, t158, t161, t162, t166, t168, t169;
  double t173, t174, t175, t177, t185, t190, tvrho1, t196;
  double t198, t206, t210, tvsigma0, tvsigma1, t214, t216, t224;
  double t228, tvsigma2;

  double t231, t232, t233, t236, t237, t238, t240, t241;
  double t245, t246, t250, t252, t258, t259, t262, t264;
  double t267, t268, t272, t274, t275, t279, t280, t281;
  double t282, t292, t297, t298, t299, t300, t304, t308;
  double t309, t313, t315, t317, t320, t322, tv2rho20, t325;
  double t328, t329, t333, t334, t338, t340, t348, t349;
  double t352, t356, t357, t361, t363, t370, t373, tv2rho21;
  double t378, t382, t383, t387, t388, t394, t395, t399;
  double t403, t404, t414, t415, t419, t421, t422, t426;
  double t427, t428, t429, t439, t444, tv2rho22, t452, t456;
  double t460, t461, t471, t476, tv2rhosigma0, tv2rhosigma1, t483, t485;
  double tv2rhosigma2, t491, tv2rhosigma3, tv2rhosigma4, t499, t503, t504, t514;
  double t519, tv2rhosigma5, t524, t531, t535, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t539, t546, t550, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = rho[1] * rho[1];
  t63 = POW_1_3(rho[1]);
  t64 = t63 * t63;
  t66 = 0.1e1 / t64 / t62;
  t67 = sigma[2] * t66;
  t68 = t33 * t67;
  t70 = exp(-0.20125e-2 * t68);
  t75 = exp(-0.100625e-2 * t68);
  t77 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t67 * t70 - 0.1245e1 * t75;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = t34 * rho[0];
  t102 = 0.1e1 / t36 / t100;
  t103 = sigma[0] * t102;
  t107 = t28 * t28;
  t110 = t107 / t30 / t29;
  t111 = sigma[0] * sigma[0];
  t112 = t34 * t34;
  t113 = t112 * t34;
  t115 = 0.1e1 / t35 / t113;
  t123 = -0.68555555555555555555e-2 * t33 * t103 * t42 + 0.13796805555555555555e-4 * t110 * t111 * t115 * t42 - 0.334075e-2 * t33 * t103 * t47;
  t128 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t123);
  t130 = my_piecewise5(t14, 0, t10, 0, -t85);
  t133 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t130);
  t134 = t133 * t26;
  t138 = t60 * t95;
  t141 = t5 * t138 * t77 / 0.8e1;
  t143 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t77 - t141);
  tvrho0 = t53 + t81 + t6 * (t128 + t143);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t7 - t84;
  t147 = my_piecewise5(t10, 0, t14, 0, t146);
  t150 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t147);
  t151 = t150 * t26;
  t156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t49 - t99);
  t158 = my_piecewise5(t14, 0, t10, 0, -t146);
  t161 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t158);
  t162 = t161 * t26;
  t166 = t62 * rho[1];
  t168 = 0.1e1 / t64 / t166;
  t169 = sigma[2] * t168;
  t173 = sigma[2] * sigma[2];
  t174 = t62 * t62;
  t175 = t174 * t62;
  t177 = 0.1e1 / t63 / t175;
  t185 = -0.68555555555555555555e-2 * t33 * t169 * t70 + 0.13796805555555555555e-4 * t110 * t173 * t177 * t70 - 0.334075e-2 * t33 * t169 * t75;
  t190 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t77 - t141 - 0.3e1 / 0.8e1 * t5 * t61 * t185);
  tvrho1 = t53 + t81 + t6 * (t156 + t190);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t196 = t112 * rho[0];
  t198 = 0.1e1 / t35 / t196;
  t206 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t110 * sigma[0] * t198 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t206);
  tvsigma0 = t6 * t210;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t214 = t174 * rho[1];
  t216 = 0.1e1 / t63 / t214;
  t224 = 0.25708333333333333333e-2 * t33 * t66 * t70 - 0.51738020833333333333e-5 * t110 * sigma[2] * t216 * t70 + 0.125278125e-2 * t33 * t66 * t75;
  t228 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t224);
  tvsigma2 = t6 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t231 = t23 * t23;
  t232 = 0.1e1 / t231;
  t233 = t86 * t86;
  t236 = t82 * t6;
  t237 = 0.1e1 / t236;
  t238 = t16 * t237;
  t240 = -0.2e1 * t83 + 0.2e1 * t238;
  t241 = my_piecewise5(t10, 0, t14, 0, t240);
  t245 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t232 * t233 + 0.4e1 / 0.3e1 * t23 * t241);
  t246 = t245 * t26;
  t250 = t89 * t95;
  t252 = t5 * t250 * t49;
  t258 = 0.1e1 / t94 / t6;
  t259 = t25 * t258;
  t262 = t5 * t259 * t49 / 0.12e2;
  t264 = t5 * t96 * t123;
  t267 = 0.1e1 / t36 / t112;
  t268 = sigma[0] * t267;
  t272 = t112 * t100;
  t274 = 0.1e1 / t35 / t272;
  t275 = t111 * t274;
  t279 = t111 * sigma[0];
  t280 = t112 * t112;
  t281 = t280 * t34;
  t282 = 0.1e1 / t281;
  t292 = 0.25137037037037037037e-1 * t33 * t268 * t42 - 0.12417125e-3 * t110 * t275 * t42 + 0.4560735904350167404e-8 * t279 * t282 * t42 + 0.12249416666666666667e-1 * t33 * t268 * t47 - 0.89643458333333333332e-5 * t110 * t275 * t47;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t246 * t49 - t252 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t123 + t262 - t264 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t292);
  t298 = t58 * t58;
  t299 = 0.1e1 / t298;
  t300 = t130 * t130;
  t304 = my_piecewise5(t14, 0, t10, 0, -t240);
  t308 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t299 * t300 + 0.4e1 / 0.3e1 * t58 * t304);
  t309 = t308 * t26;
  t313 = t133 * t95;
  t315 = t5 * t313 * t77;
  t317 = t60 * t258;
  t320 = t5 * t317 * t77 / 0.12e2;
  t322 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t309 * t77 - t315 / 0.4e1 + t320);
  tv2rho20 = 0.2e1 * t128 + 0.2e1 * t143 + t6 * (t297 + t322);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t325 = t232 * t147;
  t328 = 0.2e1 * t238;
  t329 = my_piecewise5(t10, 0, t14, 0, t328);
  t333 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t325 * t86 + 0.4e1 / 0.3e1 * t23 * t329);
  t334 = t333 * t26;
  t338 = t150 * t95;
  t340 = t5 * t338 * t49;
  t348 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t334 * t49 - t340 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t123 - t252 / 0.8e1 + t262 - t264 / 0.8e1);
  t349 = t299 * t158;
  t352 = my_piecewise5(t14, 0, t10, 0, -t328);
  t356 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t349 * t130 + 0.4e1 / 0.3e1 * t58 * t352);
  t357 = t356 * t26;
  t361 = t161 * t95;
  t363 = t5 * t361 * t77;
  t370 = t5 * t138 * t185;
  t373 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t357 * t77 - t363 / 0.8e1 - t315 / 0.8e1 + t320 - 0.3e1 / 0.8e1 * t5 * t134 * t185 - t370 / 0.8e1);
  tv2rho21 = t128 + t143 + t156 + t190 + t6 * (t348 + t373);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t378 = t147 * t147;
  t382 = 0.2e1 * t83 + 0.2e1 * t238;
  t383 = my_piecewise5(t10, 0, t14, 0, t382);
  t387 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t232 * t378 + 0.4e1 / 0.3e1 * t23 * t383);
  t388 = t387 * t26;
  t394 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t49 - t340 / 0.4e1 + t262);
  t395 = t158 * t158;
  t399 = my_piecewise5(t14, 0, t10, 0, -t382);
  t403 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t299 * t395 + 0.4e1 / 0.3e1 * t58 * t399);
  t404 = t403 * t26;
  t414 = 0.1e1 / t64 / t174;
  t415 = sigma[2] * t414;
  t419 = t174 * t166;
  t421 = 0.1e1 / t63 / t419;
  t422 = t173 * t421;
  t426 = t173 * sigma[2];
  t427 = t174 * t174;
  t428 = t427 * t62;
  t429 = 0.1e1 / t428;
  t439 = 0.25137037037037037037e-1 * t33 * t415 * t70 - 0.12417125e-3 * t110 * t422 * t70 + 0.4560735904350167404e-8 * t426 * t429 * t70 + 0.12249416666666666667e-1 * t33 * t415 * t75 - 0.89643458333333333332e-5 * t110 * t422 * t75;
  t444 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t404 * t77 - t363 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t185 + t320 - t370 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t439);
  tv2rho22 = 0.2e1 * t156 + 0.2e1 * t190 + t6 * (t394 + t444);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t452 = t5 * t96 * t206 / 0.8e1;
  t456 = t115 * sigma[0];
  t460 = t280 * rho[0];
  t461 = 0.1e1 / t460;
  t471 = -0.68555555555555555555e-2 * t33 * t102 * t42 + 0.41390416666666666666e-4 * t110 * t456 * t42 - 0.17102759641313127765e-8 * t111 * t461 * t42 - 0.334075e-2 * t33 * t102 * t47 + 0.33616296875e-5 * t110 * t456 * t47;
  t476 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t206 - t452 - 0.3e1 / 0.8e1 * t5 * t27 * t471);
  tv2rhosigma0 = t6 * t476 + t210;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t483 = t5 * t138 * t224 / 0.8e1;
  t485 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t224 - t483);
  tv2rhosigma2 = t6 * t485 + t228;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t491 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t206 - t452);
  tv2rhosigma3 = t6 * t491 + t210;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t499 = t177 * sigma[2];
  t503 = t427 * rho[1];
  t504 = 0.1e1 / t503;
  t514 = -0.68555555555555555555e-2 * t33 * t168 * t70 + 0.41390416666666666666e-4 * t110 * t499 * t70 - 0.17102759641313127765e-8 * t173 * t504 * t70 - 0.334075e-2 * t33 * t168 * t75 + 0.33616296875e-5 * t110 * t499 * t75;
  t519 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t224 - t483 - 0.3e1 / 0.8e1 * t5 * t61 * t514);
  tv2rhosigma5 = t6 * t519 + t228;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t524 = 0.1e1 / t280;
  t531 = -0.10347604166666666667e-4 * t110 * t198 * t42 + 0.64135348654924229118e-9 * sigma[0] * t524 * t42 - 0.12606111328125e-5 * t110 * t198 * t47;
  t535 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t531);
  tv2sigma20 = t6 * t535;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t539 = 0.1e1 / t427;
  t546 = -0.10347604166666666667e-4 * t110 * t216 * t70 + 0.64135348654924229118e-9 * sigma[2] * t539 * t70 - 0.12606111328125e-5 * t110 * t216 * t75;
  t550 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t546);
  tv2sigma25 = t6 * t550;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t47, t49, t53, t54, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t66;
  double t67, t68, t70, t75, t77, t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t107, t110;
  double t111, t112, t113, t115, t123, t128, t130, t133;
  double t134, t138, t141, t143, tvrho0, t146, t147, t150;
  double t151, t156, t158, t161, t162, t166, t168, t169;
  double t173, t174, t175, t177, t185, t190, tvrho1, t196;
  double t198, t206, t210, tvsigma0, tvsigma1, t214, t216, t224;
  double t228, tvsigma2;

  double t231, t232, t233, t236, t237, t238, t240, t241;
  double t245, t246, t250, t252, t258, t259, t262, t264;
  double t267, t268, t272, t274, t275, t279, t280, t281;
  double t282, t292, t297, t298, t299, t300, t304, t308;
  double t309, t313, t315, t317, t320, t322, tv2rho20, t325;
  double t328, t329, t333, t334, t338, t340, t348, t349;
  double t352, t356, t357, t361, t363, t370, t373, tv2rho21;
  double t378, t382, t383, t387, t388, t394, t395, t399;
  double t403, t404, t414, t415, t419, t421, t422, t426;
  double t427, t428, t429, t439, t444, tv2rho22, t452, t456;
  double t460, t461, t471, t476, tv2rhosigma0, tv2rhosigma1, t483, t485;
  double tv2rhosigma2, t491, tv2rhosigma3, tv2rhosigma4, t499, t503, t504, t514;
  double t519, tv2rhosigma5, t524, t531, t535, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t539, t546, t550, tv2sigma25;

  double t554, t555, t558, t561, t562, t563, t565, t566;
  double t570, t571, t575, t577, t582, t584, t587, t593;
  double t594, t597, t599, t602, t605, t606, t611, t612;
  double t616, t617, t618, t621, t622, t624, t626, t637;
  double t642, t644, t645, t648, t652, t656, t657, t661;
  double t663, t665, t667, t669, t672, t674, tv3rho30, t677;
  double t678, t679, t682, t687, t688, t689, t690, t694;
  double t695, t699, t702, t706, t708, t712, t721, t722;
  double t723, t726, t732, t736, t737, t741, t744, t745;
  double t747, t756, t758, t761, tv3rho31, t764, t769, t772;
  double t773, t777, t778, t782, t784, t793, t794, t799;
  double t803, t807, t808, t812, t814, t821, t829, t831;
  double t832, tv3rho32, t837, t843, t844, t848, t849, t856;
  double t857, t863, t867, t868, t884, t885, t890, t891;
  double t895, t896, t897, t900, t901, t903, t905, t916;
  double t921, tv3rho33, t929, t936, t938, t943, t947, t950;
  double t952, t964, t969, tv3rho2sigma0, tv3rho2sigma1, t976, t980, t982;
  double tv3rho2sigma2, t988, t996, tv3rho2sigma3, tv3rho2sigma4, t1002, t1009, t1012;
  double tv3rho2sigma5, t1020, tv3rho2sigma6, tv3rho2sigma7, t1034, t1038, t1041, t1043;
  double t1055, t1060, tv3rho2sigma8, t1067, t1071, t1075, t1084, t1089;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1096, t1098, tv3rhosigma25;
  double t1104, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1112, t1116;
  double t1125, t1130, tv3rhosigma211, t1135, t1141, t1145, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1149;
  double t1155, t1159, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = rho[1] * rho[1];
  t63 = POW_1_3(rho[1]);
  t64 = t63 * t63;
  t66 = 0.1e1 / t64 / t62;
  t67 = sigma[2] * t66;
  t68 = t33 * t67;
  t70 = exp(-0.20125e-2 * t68);
  t75 = exp(-0.100625e-2 * t68);
  t77 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t67 * t70 - 0.1245e1 * t75;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = t34 * rho[0];
  t102 = 0.1e1 / t36 / t100;
  t103 = sigma[0] * t102;
  t107 = t28 * t28;
  t110 = t107 / t30 / t29;
  t111 = sigma[0] * sigma[0];
  t112 = t34 * t34;
  t113 = t112 * t34;
  t115 = 0.1e1 / t35 / t113;
  t123 = -0.68555555555555555555e-2 * t33 * t103 * t42 + 0.13796805555555555555e-4 * t110 * t111 * t115 * t42 - 0.334075e-2 * t33 * t103 * t47;
  t128 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t123);
  t130 = my_piecewise5(t14, 0, t10, 0, -t85);
  t133 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t130);
  t134 = t133 * t26;
  t138 = t60 * t95;
  t141 = t5 * t138 * t77 / 0.8e1;
  t143 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t77 - t141);
  tvrho0 = t53 + t81 + t6 * (t128 + t143);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t7 - t84;
  t147 = my_piecewise5(t10, 0, t14, 0, t146);
  t150 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t147);
  t151 = t150 * t26;
  t156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t49 - t99);
  t158 = my_piecewise5(t14, 0, t10, 0, -t146);
  t161 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t158);
  t162 = t161 * t26;
  t166 = t62 * rho[1];
  t168 = 0.1e1 / t64 / t166;
  t169 = sigma[2] * t168;
  t173 = sigma[2] * sigma[2];
  t174 = t62 * t62;
  t175 = t174 * t62;
  t177 = 0.1e1 / t63 / t175;
  t185 = -0.68555555555555555555e-2 * t33 * t169 * t70 + 0.13796805555555555555e-4 * t110 * t173 * t177 * t70 - 0.334075e-2 * t33 * t169 * t75;
  t190 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t77 - t141 - 0.3e1 / 0.8e1 * t5 * t61 * t185);
  tvrho1 = t53 + t81 + t6 * (t156 + t190);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t196 = t112 * rho[0];
  t198 = 0.1e1 / t35 / t196;
  t206 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t110 * sigma[0] * t198 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t206);
  tvsigma0 = t6 * t210;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t214 = t174 * rho[1];
  t216 = 0.1e1 / t63 / t214;
  t224 = 0.25708333333333333333e-2 * t33 * t66 * t70 - 0.51738020833333333333e-5 * t110 * sigma[2] * t216 * t70 + 0.125278125e-2 * t33 * t66 * t75;
  t228 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t224);
  tvsigma2 = t6 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t231 = t23 * t23;
  t232 = 0.1e1 / t231;
  t233 = t86 * t86;
  t236 = t82 * t6;
  t237 = 0.1e1 / t236;
  t238 = t16 * t237;
  t240 = -0.2e1 * t83 + 0.2e1 * t238;
  t241 = my_piecewise5(t10, 0, t14, 0, t240);
  t245 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t232 * t233 + 0.4e1 / 0.3e1 * t23 * t241);
  t246 = t245 * t26;
  t250 = t89 * t95;
  t252 = t5 * t250 * t49;
  t258 = 0.1e1 / t94 / t6;
  t259 = t25 * t258;
  t262 = t5 * t259 * t49 / 0.12e2;
  t264 = t5 * t96 * t123;
  t267 = 0.1e1 / t36 / t112;
  t268 = sigma[0] * t267;
  t272 = t112 * t100;
  t274 = 0.1e1 / t35 / t272;
  t275 = t111 * t274;
  t279 = t111 * sigma[0];
  t280 = t112 * t112;
  t281 = t280 * t34;
  t282 = 0.1e1 / t281;
  t292 = 0.25137037037037037037e-1 * t33 * t268 * t42 - 0.12417125e-3 * t110 * t275 * t42 + 0.4560735904350167404e-8 * t279 * t282 * t42 + 0.12249416666666666667e-1 * t33 * t268 * t47 - 0.89643458333333333332e-5 * t110 * t275 * t47;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t246 * t49 - t252 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t123 + t262 - t264 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t292);
  t298 = t58 * t58;
  t299 = 0.1e1 / t298;
  t300 = t130 * t130;
  t304 = my_piecewise5(t14, 0, t10, 0, -t240);
  t308 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t299 * t300 + 0.4e1 / 0.3e1 * t58 * t304);
  t309 = t308 * t26;
  t313 = t133 * t95;
  t315 = t5 * t313 * t77;
  t317 = t60 * t258;
  t320 = t5 * t317 * t77 / 0.12e2;
  t322 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t309 * t77 - t315 / 0.4e1 + t320);
  tv2rho20 = 0.2e1 * t128 + 0.2e1 * t143 + t6 * (t297 + t322);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t325 = t232 * t147;
  t328 = 0.2e1 * t238;
  t329 = my_piecewise5(t10, 0, t14, 0, t328);
  t333 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t325 * t86 + 0.4e1 / 0.3e1 * t23 * t329);
  t334 = t333 * t26;
  t338 = t150 * t95;
  t340 = t5 * t338 * t49;
  t348 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t334 * t49 - t340 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t123 - t252 / 0.8e1 + t262 - t264 / 0.8e1);
  t349 = t299 * t158;
  t352 = my_piecewise5(t14, 0, t10, 0, -t328);
  t356 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t349 * t130 + 0.4e1 / 0.3e1 * t58 * t352);
  t357 = t356 * t26;
  t361 = t161 * t95;
  t363 = t5 * t361 * t77;
  t370 = t5 * t138 * t185;
  t373 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t357 * t77 - t363 / 0.8e1 - t315 / 0.8e1 + t320 - 0.3e1 / 0.8e1 * t5 * t134 * t185 - t370 / 0.8e1);
  tv2rho21 = t128 + t143 + t156 + t190 + t6 * (t348 + t373);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t378 = t147 * t147;
  t382 = 0.2e1 * t83 + 0.2e1 * t238;
  t383 = my_piecewise5(t10, 0, t14, 0, t382);
  t387 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t232 * t378 + 0.4e1 / 0.3e1 * t23 * t383);
  t388 = t387 * t26;
  t394 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t49 - t340 / 0.4e1 + t262);
  t395 = t158 * t158;
  t399 = my_piecewise5(t14, 0, t10, 0, -t382);
  t403 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t299 * t395 + 0.4e1 / 0.3e1 * t58 * t399);
  t404 = t403 * t26;
  t414 = 0.1e1 / t64 / t174;
  t415 = sigma[2] * t414;
  t419 = t174 * t166;
  t421 = 0.1e1 / t63 / t419;
  t422 = t173 * t421;
  t426 = t173 * sigma[2];
  t427 = t174 * t174;
  t428 = t427 * t62;
  t429 = 0.1e1 / t428;
  t439 = 0.25137037037037037037e-1 * t33 * t415 * t70 - 0.12417125e-3 * t110 * t422 * t70 + 0.4560735904350167404e-8 * t426 * t429 * t70 + 0.12249416666666666667e-1 * t33 * t415 * t75 - 0.89643458333333333332e-5 * t110 * t422 * t75;
  t444 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t404 * t77 - t363 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t185 + t320 - t370 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t439);
  tv2rho22 = 0.2e1 * t156 + 0.2e1 * t190 + t6 * (t394 + t444);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t452 = t5 * t96 * t206 / 0.8e1;
  t456 = t115 * sigma[0];
  t460 = t280 * rho[0];
  t461 = 0.1e1 / t460;
  t471 = -0.68555555555555555555e-2 * t33 * t102 * t42 + 0.41390416666666666666e-4 * t110 * t456 * t42 - 0.17102759641313127765e-8 * t111 * t461 * t42 - 0.334075e-2 * t33 * t102 * t47 + 0.33616296875e-5 * t110 * t456 * t47;
  t476 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t206 - t452 - 0.3e1 / 0.8e1 * t5 * t27 * t471);
  tv2rhosigma0 = t6 * t476 + t210;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t483 = t5 * t138 * t224 / 0.8e1;
  t485 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t224 - t483);
  tv2rhosigma2 = t6 * t485 + t228;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t491 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t206 - t452);
  tv2rhosigma3 = t6 * t491 + t210;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t499 = t177 * sigma[2];
  t503 = t427 * rho[1];
  t504 = 0.1e1 / t503;
  t514 = -0.68555555555555555555e-2 * t33 * t168 * t70 + 0.41390416666666666666e-4 * t110 * t499 * t70 - 0.17102759641313127765e-8 * t173 * t504 * t70 - 0.334075e-2 * t33 * t168 * t75 + 0.33616296875e-5 * t110 * t499 * t75;
  t519 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t224 - t483 - 0.3e1 / 0.8e1 * t5 * t61 * t514);
  tv2rhosigma5 = t6 * t519 + t228;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t524 = 0.1e1 / t280;
  t531 = -0.10347604166666666667e-4 * t110 * t198 * t42 + 0.64135348654924229118e-9 * sigma[0] * t524 * t42 - 0.12606111328125e-5 * t110 * t198 * t47;
  t535 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t531);
  tv2sigma20 = t6 * t535;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t539 = 0.1e1 / t427;
  t546 = -0.10347604166666666667e-4 * t110 * t216 * t70 + 0.64135348654924229118e-9 * sigma[2] * t539 * t70 - 0.12606111328125e-5 * t110 * t216 * t75;
  t550 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t546);
  tv2sigma25 = t6 * t550;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t554 = 0.1e1 / t231 / t19;
  t555 = t233 * t86;
  t558 = t232 * t86;
  t561 = t82 * t82;
  t562 = 0.1e1 / t561;
  t563 = t16 * t562;
  t565 = 0.6e1 * t237 - 0.6e1 * t563;
  t566 = my_piecewise5(t10, 0, t14, 0, t565);
  t570 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t554 * t555 + 0.4e1 / 0.3e1 * t558 * t241 + 0.4e1 / 0.3e1 * t23 * t566);
  t571 = t570 * t26;
  t575 = t245 * t95;
  t577 = t5 * t575 * t49;
  t582 = t89 * t258;
  t584 = t5 * t582 * t49;
  t587 = t5 * t250 * t123;
  t593 = 0.1e1 / t94 / t82;
  t594 = t25 * t593;
  t597 = 0.5e1 / 0.36e2 * t5 * t594 * t49;
  t599 = t5 * t259 * t123;
  t602 = t5 * t96 * t292;
  t605 = 0.1e1 / t36 / t196;
  t606 = sigma[0] * t605;
  t611 = 0.1e1 / t35 / t280;
  t612 = t111 * t611;
  t616 = t280 * t100;
  t617 = 0.1e1 / t616;
  t618 = t279 * t617;
  t621 = t111 * t111;
  t622 = t280 * t196;
  t624 = 0.1e1 / t36 / t622;
  t626 = t33 * t42;
  t637 = -0.11730617283950617284e0 * t33 * t606 * t42 + 0.10454912654320987654e-2 * t110 * t612 * t42 - 0.86653982182653180677e-7 * t618 * t42 + 0.24475949353345898402e-10 * t621 * t624 * t626 - 0.57163944444444444446e-1 * t33 * t606 * t47 + 0.98607804166666666666e-4 * t110 * t612 * t47 - 0.14816478255226406893e-8 * t618 * t47;
  t642 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t571 * t49 - 0.3e1 / 0.8e1 * t577 - 0.9e1 / 0.8e1 * t5 * t246 * t123 + t584 / 0.4e1 - 0.3e1 / 0.4e1 * t587 - 0.9e1 / 0.8e1 * t5 * t90 * t292 - t597 + t599 / 0.4e1 - 0.3e1 / 0.8e1 * t602 - 0.3e1 / 0.8e1 * t5 * t27 * t637);
  t644 = 0.1e1 / t298 / t56;
  t645 = t300 * t130;
  t648 = t299 * t130;
  t652 = my_piecewise5(t14, 0, t10, 0, -t565);
  t656 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t644 * t645 + 0.4e1 / 0.3e1 * t648 * t304 + 0.4e1 / 0.3e1 * t58 * t652);
  t657 = t656 * t26;
  t661 = t308 * t95;
  t663 = t5 * t661 * t77;
  t665 = t133 * t258;
  t667 = t5 * t665 * t77;
  t669 = t60 * t593;
  t672 = 0.5e1 / 0.36e2 * t5 * t669 * t77;
  t674 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t657 * t77 - 0.3e1 / 0.8e1 * t663 + t667 / 0.4e1 - t672);
  tv3rho30 = 0.3e1 * t297 + 0.3e1 * t322 + t6 * (t642 + t674);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t677 = 0.2e1 * t348;
  t678 = 0.2e1 * t373;
  t679 = t554 * t147;
  t682 = t232 * t329;
  t687 = 0.2e1 * t237;
  t688 = 0.6e1 * t563;
  t689 = t687 - t688;
  t690 = my_piecewise5(t10, 0, t14, 0, t689);
  t694 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t679 * t233 + 0.8e1 / 0.9e1 * t682 * t86 + 0.4e1 / 0.9e1 * t325 * t241 + 0.4e1 / 0.3e1 * t23 * t690);
  t695 = t694 * t26;
  t699 = t333 * t95;
  t702 = t5 * t699 * t49 / 0.4e1;
  t706 = t150 * t258;
  t708 = t5 * t706 * t49;
  t712 = t5 * t338 * t123 / 0.4e1;
  t721 = -0.3e1 / 0.8e1 * t5 * t695 * t49 - t702 - 0.3e1 / 0.4e1 * t5 * t334 * t123 + t708 / 0.12e2 - t712 - 0.3e1 / 0.8e1 * t5 * t151 * t292 - t577 / 0.8e1 + t584 / 0.6e1 - t587 / 0.4e1 - t597 + t599 / 0.6e1 - t602 / 0.8e1;
  t722 = my_piecewise3(t1, 0, t721);
  t723 = t644 * t158;
  t726 = t299 * t352;
  t732 = my_piecewise5(t14, 0, t10, 0, -t689);
  t736 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t723 * t300 + 0.8e1 / 0.9e1 * t726 * t130 + 0.4e1 / 0.9e1 * t349 * t304 + 0.4e1 / 0.3e1 * t58 * t732);
  t737 = t736 * t26;
  t741 = t356 * t95;
  t744 = t5 * t741 * t77 / 0.4e1;
  t745 = t161 * t258;
  t747 = t5 * t745 * t77;
  t756 = t5 * t313 * t185 / 0.4e1;
  t758 = t5 * t317 * t185;
  t761 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t737 * t77 - t744 + t747 / 0.12e2 - t663 / 0.8e1 + t667 / 0.6e1 - t672 - 0.3e1 / 0.8e1 * t5 * t309 * t185 - t756 + t758 / 0.12e2);
  tv3rho31 = t297 + t322 + t677 + t678 + t6 * (t722 + t761);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t764 = t554 * t378;
  t769 = t232 * t383;
  t772 = -t687 - t688;
  t773 = my_piecewise5(t10, 0, t14, 0, t772);
  t777 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t764 * t86 + 0.8e1 / 0.9e1 * t325 * t329 + 0.4e1 / 0.9e1 * t769 * t86 + 0.4e1 / 0.3e1 * t23 * t773);
  t778 = t777 * t26;
  t782 = t387 * t95;
  t784 = t5 * t782 * t49;
  t793 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t778 * t49 - t784 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t388 * t123 - t702 + t708 / 0.6e1 - t712 + t584 / 0.12e2 - t597 + t599 / 0.12e2);
  t794 = t644 * t395;
  t799 = t299 * t399;
  t803 = my_piecewise5(t14, 0, t10, 0, -t772);
  t807 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t794 * t130 + 0.8e1 / 0.9e1 * t349 * t352 + 0.4e1 / 0.9e1 * t799 * t130 + 0.4e1 / 0.3e1 * t58 * t803);
  t808 = t807 * t26;
  t812 = t403 * t95;
  t814 = t5 * t812 * t77;
  t821 = t5 * t361 * t185;
  t829 = t5 * t138 * t439;
  t831 = -0.3e1 / 0.8e1 * t5 * t808 * t77 - t814 / 0.8e1 - t744 + t747 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t357 * t185 - t821 / 0.4e1 + t667 / 0.12e2 - t672 - t756 + t758 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t134 * t439 - t829 / 0.8e1;
  t832 = my_piecewise3(t54, 0, t831);
  tv3rho32 = t677 + t678 + t394 + t444 + t6 * (t793 + t832);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t837 = t378 * t147;
  t843 = -0.6e1 * t237 - 0.6e1 * t563;
  t844 = my_piecewise5(t10, 0, t14, 0, t843);
  t848 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t554 * t837 + 0.4e1 / 0.3e1 * t325 * t383 + 0.4e1 / 0.3e1 * t23 * t844);
  t849 = t848 * t26;
  t856 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t849 * t49 - 0.3e1 / 0.8e1 * t784 + t708 / 0.4e1 - t597);
  t857 = t395 * t158;
  t863 = my_piecewise5(t14, 0, t10, 0, -t843);
  t867 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t644 * t857 + 0.4e1 / 0.3e1 * t349 * t399 + 0.4e1 / 0.3e1 * t58 * t863);
  t868 = t867 * t26;
  t884 = 0.1e1 / t64 / t214;
  t885 = sigma[2] * t884;
  t890 = 0.1e1 / t63 / t427;
  t891 = t173 * t890;
  t895 = t427 * t166;
  t896 = 0.1e1 / t895;
  t897 = t426 * t896;
  t900 = t173 * t173;
  t901 = t427 * t214;
  t903 = 0.1e1 / t64 / t901;
  t905 = t33 * t70;
  t916 = -0.11730617283950617284e0 * t33 * t885 * t70 + 0.10454912654320987654e-2 * t110 * t891 * t70 - 0.86653982182653180677e-7 * t897 * t70 + 0.24475949353345898402e-10 * t900 * t903 * t905 - 0.57163944444444444446e-1 * t33 * t885 * t75 + 0.98607804166666666666e-4 * t110 * t891 * t75 - 0.14816478255226406893e-8 * t897 * t75;
  t921 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t868 * t77 - 0.3e1 / 0.8e1 * t814 - 0.9e1 / 0.8e1 * t5 * t404 * t185 + t747 / 0.4e1 - 0.3e1 / 0.4e1 * t821 - 0.9e1 / 0.8e1 * t5 * t162 * t439 - t672 + t758 / 0.4e1 - 0.3e1 / 0.8e1 * t829 - 0.3e1 / 0.8e1 * t5 * t61 * t916);
  tv3rho33 = 0.3e1 * t394 + 0.3e1 * t444 + t6 * (t856 + t921);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t929 = t5 * t250 * t206;
  t936 = t5 * t259 * t206 / 0.12e2;
  t938 = t5 * t96 * t471;
  t943 = t274 * sigma[0];
  t947 = t282 * t111;
  t950 = t280 * t112;
  t952 = 0.1e1 / t36 / t950;
  t964 = 0.25137037037037037037e-1 * t33 * t267 * t42 - 0.29893078703703703703e-3 * t110 * t943 * t42 + 0.290746913902323172e-7 * t947 * t42 - 0.91784810075047119006e-11 * t279 * t952 * t626 + 0.12249416666666666667e-1 * t33 * t267 * t47 - 0.302546671875e-4 * t110 * t943 * t47 + 0.5556179345709902585e-9 * t947 * t47;
  t969 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t246 * t206 - t929 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t471 + t936 - t938 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t964);
  tv3rho2sigma0 = t6 * t969 + 0.2e1 * t476;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t976 = t5 * t313 * t224;
  t980 = t5 * t317 * t224 / 0.12e2;
  t982 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t309 * t224 - t976 / 0.4e1 + t980);
  tv3rho2sigma2 = t6 * t982 + 0.2e1 * t485;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t988 = t5 * t338 * t206;
  t996 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t334 * t206 - t988 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t471 - t929 / 0.8e1 + t936 - t938 / 0.8e1);
  tv3rho2sigma3 = t6 * t996 + t476 + t491;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1002 = t5 * t361 * t224;
  t1009 = t5 * t138 * t514;
  t1012 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t357 * t224 - t1002 / 0.8e1 - t976 / 0.8e1 + t980 - 0.3e1 / 0.8e1 * t5 * t134 * t514 - t1009 / 0.8e1);
  tv3rho2sigma5 = t6 * t1012 + t485 + t519;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1020 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t206 - t988 / 0.4e1 + t936);
  tv3rho2sigma6 = t6 * t1020 + 0.2e1 * t491;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1034 = t421 * sigma[2];
  t1038 = t429 * t173;
  t1041 = t427 * t174;
  t1043 = 0.1e1 / t64 / t1041;
  t1055 = 0.25137037037037037037e-1 * t33 * t414 * t70 - 0.29893078703703703703e-3 * t110 * t1034 * t70 + 0.290746913902323172e-7 * t1038 * t70 - 0.91784810075047119006e-11 * t426 * t1043 * t905 + 0.12249416666666666667e-1 * t33 * t414 * t75 - 0.302546671875e-4 * t110 * t1034 * t75 + 0.5556179345709902585e-9 * t1038 * t75;
  t1060 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t404 * t224 - t1002 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t514 + t980 - t1009 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t1055);
  tv3rho2sigma8 = t6 * t1060 + 0.2e1 * t519;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1067 = t5 * t96 * t531 / 0.8e1;
  t1071 = t461 * sigma[0];
  t1075 = 0.1e1 / t36 / t616;
  t1084 = 0.55187222222222222224e-4 * t110 * t115 * t42 - 0.85513798206565638826e-8 * t1071 * t42 + 0.34419303778142669627e-11 * t111 * t1075 * t626 + 0.6723259375e-5 * t110 * t115 * t47 - 0.20835672546412134694e-9 * t1071 * t47;
  t1089 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t531 - t1067 - 0.3e1 / 0.8e1 * t5 * t27 * t1084);
  tv3rhosigma20 = t6 * t1089 + t535;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1096 = t5 * t138 * t546 / 0.8e1;
  t1098 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t134 * t546 - t1096);
  tv3rhosigma25 = t6 * t1098 + t550;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t531 - t1067);
  tv3rhosigma26 = t6 * t1104 + t535;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1112 = t504 * sigma[2];
  t1116 = 0.1e1 / t64 / t895;
  t1125 = 0.55187222222222222224e-4 * t110 * t177 * t70 - 0.85513798206565638826e-8 * t1112 * t70 + 0.34419303778142669627e-11 * t173 * t1116 * t905 + 0.6723259375e-5 * t110 * t177 * t75 - 0.20835672546412134694e-9 * t1112 * t75;
  t1130 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t162 * t546 - t1096 - 0.3e1 / 0.8e1 * t5 * t61 * t1125);
  tv3rhosigma211 = t6 * t1130 + t550;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1135 = 0.1e1 / t36 / t281;
  t1141 = 0.19240604596477268736e-8 * t524 * t42 - 0.1290723891680350111e-11 * sigma[0] * t1135 * t626 + 0.78133772049045505101e-10 * t524 * t47;
  t1145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1141);
  tv3sigma30 = t6 * t1145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1149 = 0.1e1 / t64 / t428;
  t1155 = 0.19240604596477268736e-8 * t539 * t70 - 0.1290723891680350111e-11 * sigma[2] * t1149 * t905 + 0.78133772049045505101e-10 * t539 * t75;
  t1159 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t1155);
  tv3sigma39 = t6 * t1159;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t47, t49, t53, t54, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t66;
  double t67, t68, t70, t75, t77, t81, tzk0;

#endif

#endif

#endif

#endif



  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125000000000000000e-2 * t40);
  t47 = exp(-0.10062500000000000000e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125000000000000000e-2 * t70);
  t77 = exp(-0.10062500000000000000e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t53 + t83;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t88 = my_piecewise5(t10, 0, t14, 0, t7 - t86);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t49 / 0.8e1;
  t102 = t34 * rho[0];
  t104 = 0.1e1 / t36 / t102;
  t105 = sigma[0] * t104;
  t109 = t28 * t28;
  t112 = t109 / t30 / t29;
  t113 = sigma[0] * sigma[0];
  t114 = t34 * t34;
  t115 = t114 * t34;
  t117 = 0.1e1 / t35 / t115;
  t125 = -0.68555555555555555555e-2 * t33 * t105 * t42 + 0.13796805555555555555e-4 * t112 * t113 * t117 * t42 - 0.33407500000000000000e-2 * t33 * t105 * t47;
  t130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t49 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t125);
  t131 = t55 * t85;
  t133 = my_piecewise5(t14, 0, t10, 0, -t7 - t131);
  t136 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t133);
  t137 = t136 * t26;
  t141 = t62 * t97;
  t144 = t5 * t141 * t79 / 0.8e1;
  t146 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t79 - t144);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t53 + t83 + t6 * (t130 + t146);

  t150 = my_piecewise5(t10, 0, t14, 0, -t7 - t86);
  t153 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t150);
  t154 = t153 * t26;
  t159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t49 - t101);
  t161 = my_piecewise5(t14, 0, t10, 0, t7 - t131);
  t164 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t161);
  t165 = t164 * t26;
  t169 = t64 * rho[1];
  t171 = 0.1e1 / t66 / t169;
  t172 = sigma[2] * t171;
  t176 = sigma[2] * sigma[2];
  t177 = t64 * t64;
  t178 = t177 * t64;
  t180 = 0.1e1 / t65 / t178;
  t188 = -0.68555555555555555555e-2 * t33 * t172 * t72 + 0.13796805555555555555e-4 * t112 * t176 * t180 * t72 - 0.33407500000000000000e-2 * t33 * t172 * t77;
  t193 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t79 - t144 - 0.3e1 / 0.8e1 * t5 * t63 * t188);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t53 + t83 + t6 * (t159 + t193);

  t199 = t114 * rho[0];
  t201 = 0.1e1 / t35 / t199;
  t209 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t112 * sigma[0] * t201 * t42 + 0.12527812500000000000e-2 * t33 * t38 * t47;
  t213 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t209);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t6 * t213;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t217 = t177 * rho[1];
  t219 = 0.1e1 / t65 / t217;
  t227 = 0.25708333333333333333e-2 * t33 * t68 * t72 - 0.51738020833333333333e-5 * t112 * sigma[2] * t219 * t72 + 0.12527812500000000000e-2 * t33 * t68 * t77;
  t231 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t227);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t231;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t234 = t23 * t23;
  t235 = 0.1e1 / t234;
  t236 = t88 * t88;
  t239 = t84 * t6;
  t240 = 0.1e1 / t239;
  t241 = t16 * t240;
  t244 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t85 + 0.2e1 * t241);
  t248 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t236 + 0.4e1 / 0.3e1 * t23 * t244);
  t249 = t248 * t26;
  t253 = t91 * t97;
  t255 = t5 * t253 * t49;
  t261 = 0.1e1 / t96 / t6;
  t262 = t25 * t261;
  t265 = t5 * t262 * t49 / 0.12e2;
  t267 = t5 * t98 * t125;
  t270 = 0.1e1 / t36 / t114;
  t271 = sigma[0] * t270;
  t275 = t114 * t102;
  t277 = 0.1e1 / t35 / t275;
  t278 = t113 * t277;
  t282 = t113 * sigma[0];
  t283 = t114 * t114;
  t284 = t283 * t34;
  t285 = 0.1e1 / t284;
  t295 = 0.25137037037037037037e-1 * t33 * t271 * t42 - 0.12417125000000000000e-3 * t112 * t278 * t42 + 0.45607359043501674040e-8 * t282 * t285 * t42 + 0.12249416666666666667e-1 * t33 * t271 * t47 - 0.89643458333333333332e-5 * t112 * t278 * t47;
  t300 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t49 - t255 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t125 + t265 - t267 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t295);
  t301 = t60 * t60;
  t302 = 0.1e1 / t301;
  t303 = t133 * t133;
  t306 = t55 * t240;
  t309 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t85 + 0.2e1 * t306);
  t313 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t303 + 0.4e1 / 0.3e1 * t60 * t309);
  t314 = t313 * t26;
  t318 = t136 * t97;
  t320 = t5 * t318 * t79;
  t322 = t62 * t261;
  t325 = t5 * t322 * t79 / 0.12e2;
  t327 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t79 - t320 / 0.4e1 + t325);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t130 + 0.2e1 * t146 + t6 * (t300 + t327);

  t330 = t235 * t150;
  t334 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t241);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t88 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t338 * t26;
  t343 = t153 * t97;
  t345 = t5 * t343 * t49;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t49 - t345 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t125 - t255 / 0.8e1 + t265 - t267 / 0.8e1);
  t354 = t302 * t161;
  t358 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t306);
  t362 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t354 * t133 + 0.4e1 / 0.3e1 * t60 * t358);
  t363 = t362 * t26;
  t367 = t164 * t97;
  t369 = t5 * t367 * t79;
  t376 = t5 * t141 * t188;
  t379 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t79 - t369 / 0.8e1 - t320 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t5 * t137 * t188 - t376 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t130 + t146 + t159 + t193 + t6 * (t353 + t379);

  t384 = t150 * t150;
  t389 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t85 + 0.2e1 * t241);
  t393 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t384 + 0.4e1 / 0.3e1 * t23 * t389);
  t394 = t393 * t26;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t49 - t345 / 0.4e1 + t265);
  t401 = t161 * t161;
  t406 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t85 + 0.2e1 * t306);
  t410 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t401 + 0.4e1 / 0.3e1 * t60 * t406);
  t411 = t410 * t26;
  t421 = 0.1e1 / t66 / t177;
  t422 = sigma[2] * t421;
  t426 = t177 * t169;
  t428 = 0.1e1 / t65 / t426;
  t429 = t176 * t428;
  t433 = t176 * sigma[2];
  t434 = t177 * t177;
  t435 = t434 * t64;
  t436 = 0.1e1 / t435;
  t446 = 0.25137037037037037037e-1 * t33 * t422 * t72 - 0.12417125000000000000e-3 * t112 * t429 * t72 + 0.45607359043501674040e-8 * t433 * t436 * t72 + 0.12249416666666666667e-1 * t33 * t422 * t77 - 0.89643458333333333332e-5 * t112 * t429 * t77;
  t451 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t79 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t188 + t325 - t376 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t446);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t159 + 0.2e1 * t193 + t6 * (t400 + t451);

  t459 = t5 * t98 * t209 / 0.8e1;
  t463 = t117 * sigma[0];
  t467 = t283 * rho[0];
  t468 = 0.1e1 / t467;
  t478 = -0.68555555555555555555e-2 * t33 * t104 * t42 + 0.41390416666666666666e-4 * t112 * t463 * t42 - 0.17102759641313127765e-8 * t113 * t468 * t42 - 0.33407500000000000000e-2 * t33 * t104 * t47 + 0.33616296875000000000e-5 * t112 * t463 * t47;
  t483 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t209 - t459 - 0.3e1 / 0.8e1 * t5 * t27 * t478);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t483 * t6 + t213;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t490 = t5 * t141 * t227 / 0.8e1;
  t492 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t227 - t490);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t492 * t6 + t231;

  t498 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t209 - t459);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t498 * t6 + t213;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t506 = t180 * sigma[2];
  t510 = t434 * rho[1];
  t511 = 0.1e1 / t510;
  t521 = -0.68555555555555555555e-2 * t33 * t171 * t72 + 0.41390416666666666666e-4 * t112 * t506 * t72 - 0.17102759641313127765e-8 * t176 * t511 * t72 - 0.33407500000000000000e-2 * t33 * t171 * t77 + 0.33616296875000000000e-5 * t112 * t506 * t77;
  t526 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t227 - t490 - 0.3e1 / 0.8e1 * t5 * t63 * t521);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t526 * t6 + t231;

  t531 = 0.1e1 / t283;
  t538 = -0.10347604166666666667e-4 * t112 * t201 * t42 + 0.64135348654924229118e-9 * sigma[0] * t531 * t42 - 0.12606111328125000000e-5 * t112 * t201 * t47;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t538);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t542;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t546 = 0.1e1 / t434;
  t553 = -0.10347604166666666667e-4 * t112 * t219 * t72 + 0.64135348654924229118e-9 * sigma[2] * t546 * t72 - 0.12606111328125000000e-5 * t112 * t219 * t77;
  t557 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t553);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t557;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t561 = 0.1e1 / t234 / t19;
  t562 = t236 * t88;
  t565 = t235 * t88;
  t568 = t84 * t84;
  t569 = 0.1e1 / t568;
  t570 = t16 * t569;
  t573 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t240 - 0.6e1 * t570);
  t577 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t562 + 0.4e1 / 0.3e1 * t565 * t244 + 0.4e1 / 0.3e1 * t23 * t573);
  t578 = t577 * t26;
  t582 = t248 * t97;
  t584 = t5 * t582 * t49;
  t589 = t91 * t261;
  t591 = t5 * t589 * t49;
  t594 = t5 * t253 * t125;
  t600 = 0.1e1 / t96 / t84;
  t601 = t25 * t600;
  t604 = 0.5e1 / 0.36e2 * t5 * t601 * t49;
  t606 = t5 * t262 * t125;
  t609 = t5 * t98 * t295;
  t612 = 0.1e1 / t36 / t199;
  t613 = sigma[0] * t612;
  t618 = 0.1e1 / t35 / t283;
  t619 = t113 * t618;
  t623 = t283 * t102;
  t624 = 0.1e1 / t623;
  t625 = t282 * t624;
  t628 = t113 * t113;
  t629 = t283 * t199;
  t631 = 0.1e1 / t36 / t629;
  t633 = t33 * t42;
  t644 = -0.11730617283950617284e0 * t33 * t613 * t42 + 0.10454912654320987654e-2 * t112 * t619 * t42 - 0.86653982182653180677e-7 * t625 * t42 + 0.24475949353345898402e-10 * t628 * t631 * t633 - 0.57163944444444444446e-1 * t33 * t613 * t47 + 0.98607804166666666666e-4 * t112 * t619 * t47 - 0.14816478255226406893e-8 * t625 * t47;
  t649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t578 * t49 - 0.3e1 / 0.8e1 * t584 - 0.9e1 / 0.8e1 * t5 * t249 * t125 + t591 / 0.4e1 - 0.3e1 / 0.4e1 * t594 - 0.9e1 / 0.8e1 * t5 * t92 * t295 - t604 + t606 / 0.4e1 - 0.3e1 / 0.8e1 * t609 - 0.3e1 / 0.8e1 * t5 * t27 * t644);
  t651 = 0.1e1 / t301 / t58;
  t652 = t303 * t133;
  t655 = t302 * t133;
  t658 = t55 * t569;
  t661 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t240 - 0.6e1 * t658);
  t665 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t652 + 0.4e1 / 0.3e1 * t655 * t309 + 0.4e1 / 0.3e1 * t60 * t661);
  t666 = t665 * t26;
  t670 = t313 * t97;
  t672 = t5 * t670 * t79;
  t674 = t136 * t261;
  t676 = t5 * t674 * t79;
  t678 = t62 * t600;
  t681 = 0.5e1 / 0.36e2 * t5 * t678 * t79;
  t683 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t666 * t79 - 0.3e1 / 0.8e1 * t672 + t676 / 0.4e1 - t681);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t300 + 0.3e1 * t327 + t6 * (t649 + t683);

  t686 = 0.2e1 * t353;
  t687 = 0.2e1 * t379;
  t688 = t561 * t150;
  t691 = t235 * t334;
  t696 = 0.2e1 * t240;
  t697 = 0.6e1 * t570;
  t699 = my_piecewise5(t10, 0, t14, 0, t696 - t697);
  t703 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t688 * t236 + 0.8e1 / 0.9e1 * t691 * t88 + 0.4e1 / 0.9e1 * t330 * t244 + 0.4e1 / 0.3e1 * t23 * t699);
  t704 = t703 * t26;
  t708 = t338 * t97;
  t711 = t5 * t708 * t49 / 0.4e1;
  t715 = t153 * t261;
  t717 = t5 * t715 * t49;
  t721 = t5 * t343 * t125 / 0.4e1;
  t730 = -0.3e1 / 0.8e1 * t5 * t704 * t49 - t711 - 0.3e1 / 0.4e1 * t5 * t339 * t125 + t717 / 0.12e2 - t721 - 0.3e1 / 0.8e1 * t5 * t154 * t295 - t584 / 0.8e1 + t591 / 0.6e1 - t594 / 0.4e1 - t604 + t606 / 0.6e1 - t609 / 0.8e1;
  t731 = my_piecewise3(t1, 0, t730);
  t732 = t651 * t161;
  t735 = t302 * t358;
  t740 = 0.6e1 * t658;
  t742 = my_piecewise5(t14, 0, t10, 0, -t696 - t740);
  t746 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t732 * t303 + 0.8e1 / 0.9e1 * t735 * t133 + 0.4e1 / 0.9e1 * t354 * t309 + 0.4e1 / 0.3e1 * t60 * t742);
  t747 = t746 * t26;
  t751 = t362 * t97;
  t754 = t5 * t751 * t79 / 0.4e1;
  t755 = t164 * t261;
  t757 = t5 * t755 * t79;
  t766 = t5 * t318 * t188 / 0.4e1;
  t768 = t5 * t322 * t188;
  t771 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t747 * t79 - t754 + t757 / 0.12e2 - t672 / 0.8e1 + t676 / 0.6e1 - t681 - 0.3e1 / 0.8e1 * t5 * t314 * t188 - t766 + t768 / 0.12e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t300 + t327 + t686 + t687 + t6 * (t731 + t771);

  t774 = t561 * t384;
  t779 = t235 * t389;
  t783 = my_piecewise5(t10, 0, t14, 0, -t696 - t697);
  t787 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t774 * t88 + 0.8e1 / 0.9e1 * t330 * t334 + 0.4e1 / 0.9e1 * t779 * t88 + 0.4e1 / 0.3e1 * t23 * t783);
  t788 = t787 * t26;
  t792 = t393 * t97;
  t794 = t5 * t792 * t49;
  t803 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t788 * t49 - t794 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t394 * t125 - t711 + t717 / 0.6e1 - t721 + t591 / 0.12e2 - t604 + t606 / 0.12e2);
  t804 = t651 * t401;
  t809 = t302 * t406;
  t813 = my_piecewise5(t14, 0, t10, 0, t696 - t740);
  t817 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t804 * t133 + 0.8e1 / 0.9e1 * t354 * t358 + 0.4e1 / 0.9e1 * t809 * t133 + 0.4e1 / 0.3e1 * t60 * t813);
  t818 = t817 * t26;
  t822 = t410 * t97;
  t824 = t5 * t822 * t79;
  t831 = t5 * t367 * t188;
  t839 = t5 * t141 * t446;
  t841 = -0.3e1 / 0.8e1 * t5 * t818 * t79 - t824 / 0.8e1 - t754 + t757 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t363 * t188 - t831 / 0.4e1 + t676 / 0.12e2 - t681 - t766 + t768 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t137 * t446 - t839 / 0.8e1;
  t842 = my_piecewise3(t54, 0, t841);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t686 + t687 + t400 + t451 + t6 * (t803 + t842);

  t847 = t384 * t150;
  t854 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t240 - 0.6e1 * t570);
  t858 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t847 + 0.4e1 / 0.3e1 * t330 * t389 + 0.4e1 / 0.3e1 * t23 * t854);
  t859 = t858 * t26;
  t866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t859 * t49 - 0.3e1 / 0.8e1 * t794 + t717 / 0.4e1 - t604);
  t867 = t401 * t161;
  t874 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t240 - 0.6e1 * t658);
  t878 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t867 + 0.4e1 / 0.3e1 * t354 * t406 + 0.4e1 / 0.3e1 * t60 * t874);
  t879 = t878 * t26;
  t895 = 0.1e1 / t66 / t217;
  t896 = sigma[2] * t895;
  t901 = 0.1e1 / t65 / t434;
  t902 = t176 * t901;
  t906 = t434 * t169;
  t907 = 0.1e1 / t906;
  t908 = t433 * t907;
  t911 = t176 * t176;
  t912 = t434 * t217;
  t914 = 0.1e1 / t66 / t912;
  t916 = t33 * t72;
  t927 = -0.11730617283950617284e0 * t33 * t896 * t72 + 0.10454912654320987654e-2 * t112 * t902 * t72 - 0.86653982182653180677e-7 * t908 * t72 + 0.24475949353345898402e-10 * t911 * t914 * t916 - 0.57163944444444444446e-1 * t33 * t896 * t77 + 0.98607804166666666666e-4 * t112 * t902 * t77 - 0.14816478255226406893e-8 * t908 * t77;
  t932 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t879 * t79 - 0.3e1 / 0.8e1 * t824 - 0.9e1 / 0.8e1 * t5 * t411 * t188 + t757 / 0.4e1 - 0.3e1 / 0.4e1 * t831 - 0.9e1 / 0.8e1 * t5 * t165 * t446 - t681 + t768 / 0.4e1 - 0.3e1 / 0.8e1 * t839 - 0.3e1 / 0.8e1 * t5 * t63 * t927);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t400 + 0.3e1 * t451 + t6 * (t866 + t932);

  t940 = t5 * t253 * t209;
  t947 = t5 * t262 * t209 / 0.12e2;
  t949 = t5 * t98 * t478;
  t954 = t277 * sigma[0];
  t958 = t285 * t113;
  t961 = t283 * t114;
  t963 = 0.1e1 / t36 / t961;
  t975 = 0.25137037037037037037e-1 * t33 * t270 * t42 - 0.29893078703703703703e-3 * t112 * t954 * t42 + 0.29074691390232317200e-7 * t958 * t42 - 0.91784810075047119006e-11 * t282 * t963 * t633 + 0.12249416666666666667e-1 * t33 * t270 * t47 - 0.30254667187500000000e-4 * t112 * t954 * t47 + 0.55561793457099025850e-9 * t958 * t47;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t209 - t940 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t478 + t947 - t949 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t6 * t980 + 0.2e1 * t483;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t987 = t5 * t318 * t227;
  t991 = t5 * t322 * t227 / 0.12e2;
  t993 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t227 - t987 / 0.4e1 + t991);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t6 * t993 + 0.2e1 * t492;

  t999 = t5 * t343 * t209;
  t1007 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t209 - t999 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t478 - t940 / 0.8e1 + t947 - t949 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t1007 * t6 + t483 + t498;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1013 = t5 * t367 * t227;
  t1020 = t5 * t141 * t521;
  t1023 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t227 - t1013 / 0.8e1 - t987 / 0.8e1 + t991 - 0.3e1 / 0.8e1 * t5 * t137 * t521 - t1020 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t1023 * t6 + t492 + t526;

  t1031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t209 - t999 / 0.4e1 + t947);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t1031 * t6 + 0.2e1 * t498;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1045 = t428 * sigma[2];
  t1049 = t436 * t176;
  t1052 = t434 * t177;
  t1054 = 0.1e1 / t66 / t1052;
  t1066 = 0.25137037037037037037e-1 * t33 * t421 * t72 - 0.29893078703703703703e-3 * t112 * t1045 * t72 + 0.29074691390232317200e-7 * t1049 * t72 - 0.91784810075047119006e-11 * t433 * t1054 * t916 + 0.12249416666666666667e-1 * t33 * t421 * t77 - 0.30254667187500000000e-4 * t112 * t1045 * t77 + 0.55561793457099025850e-9 * t1049 * t77;
  t1071 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t227 - t1013 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t521 + t991 - t1020 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t1066);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t1071 * t6 + 0.2e1 * t526;

  t1078 = t5 * t98 * t538 / 0.8e1;
  t1082 = t468 * sigma[0];
  t1086 = 0.1e1 / t36 / t623;
  t1095 = 0.55187222222222222224e-4 * t112 * t117 * t42 - 0.85513798206565638826e-8 * t1082 * t42 + 0.34419303778142669627e-11 * t113 * t1086 * t633 + 0.67232593750000000000e-5 * t112 * t117 * t47 - 0.20835672546412134694e-9 * t1082 * t47;
  t1100 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t538 - t1078 - 0.3e1 / 0.8e1 * t5 * t27 * t1095);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t1100 * t6 + t542;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1107 = t5 * t141 * t553 / 0.8e1;
  t1109 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t553 - t1107);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = t1109 * t6 + t557;

  t1115 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t538 - t1078);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t1115 * t6 + t542;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1123 = t511 * sigma[2];
  t1127 = 0.1e1 / t66 / t906;
  t1136 = 0.55187222222222222224e-4 * t112 * t180 * t72 - 0.85513798206565638826e-8 * t1123 * t72 + 0.34419303778142669627e-11 * t176 * t1127 * t916 + 0.67232593750000000000e-5 * t112 * t180 * t77 - 0.20835672546412134694e-9 * t1123 * t77;
  t1141 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t553 - t1107 - 0.3e1 / 0.8e1 * t5 * t63 * t1136);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t1141 * t6 + t557;

  t1146 = 0.1e1 / t36 / t284;
  t1152 = 0.19240604596477268736e-8 * t531 * t42 - 0.12907238916803501110e-11 * sigma[0] * t1146 * t633 + 0.78133772049045505101e-10 * t531 * t47;
  t1156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1152);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = t6 * t1156;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1160 = 0.1e1 / t66 / t435;
  t1166 = 0.19240604596477268736e-8 * t546 * t72 - 0.12907238916803501110e-11 * sigma[2] * t1160 * t916 + 0.78133772049045505101e-10 * t546 * t77;
  t1170 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t1166);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = t6 * t1170;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1175 = sigma[0] / t36 / t115;
  t1181 = t113 / t35 / t467;
  t1186 = t282 / t961;
  t1189 = t283 * t115;
  t1192 = t628 / t36 / t1189;
  t1196 = t283 * t283;
  t1201 = t112 * t42;
  t1212 = t33 * t47;
  t1220 = t5 * t262 * t295;
  t1223 = t5 * t98 * t644;
  t1229 = t5 * t601 * t125;
  t1232 = t5 * t582 * t125;
  t1238 = t5 * t589 * t125;
  t1240 = t5 * t253 * t295;
  t1242 = t19 * t19;
  t1244 = 0.1e1 / t234 / t1242;
  t1245 = t236 * t236;
  t1251 = t244 * t244;
  t1257 = 0.1e1 / t568 / t6;
  t1258 = t16 * t1257;
  t1261 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t569 + 0.24e2 * t1258);
  t1265 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1244 * t1245 - 0.16e2 / 0.9e1 * t561 * t236 * t244 + 0.4e1 / 0.3e1 * t235 * t1251 + 0.16e2 / 0.9e1 * t565 * t573 + 0.4e1 / 0.3e1 * t23 * t1261);
  t1274 = 0.1e1 / t96 / t239;
  t1278 = 0.10e2 / 0.27e2 * t5 * t25 * t1274 * t49;
  t1281 = t5 * t577 * t97 * t49;
  t1285 = t5 * t248 * t261 * t49;
  t1289 = t5 * t91 * t600 * t49;
  t1291 = -0.3e1 / 0.8e1 * t5 * t27 * (0.66473497942386831276e0 * t33 * t1175 * t42 - 0.93419703395061728392e-2 * t112 * t1181 * t42 + 0.12987962358721643396e-5 * t1186 * t42 - 0.79954767887596601447e-9 * t1192 * t633 + 0.13135426152962298809e-12 * t628 * sigma[0] / t35 / t1196 / rho[0] * t1201 + 0.32392901851851851853e0 * t33 * t1175 * t47 - 0.97512161898148148147e-3 * t112 * t1181 * t47 + 0.32596252161498095165e-7 * t1186 * t47 - 0.39757549984857525162e-11 * t1192 * t1212) + t1220 / 0.2e1 - t1223 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t92 * t644 - 0.5e1 / 0.9e1 * t1229 - 0.3e1 / 0.2e1 * t1232 - 0.9e1 / 0.4e1 * t5 * t249 * t295 + t1238 - 0.3e1 / 0.2e1 * t1240 - 0.3e1 / 0.8e1 * t5 * t1265 * t26 * t49 - 0.3e1 / 0.2e1 * t5 * t578 * t125 + t1278 - t1281 / 0.2e1 + t1285 / 0.2e1 - 0.5e1 / 0.9e1 * t1289;
  t1292 = my_piecewise3(t1, 0, t1291);
  t1293 = t58 * t58;
  t1295 = 0.1e1 / t301 / t1293;
  t1296 = t303 * t303;
  t1302 = t309 * t309;
  t1307 = t55 * t1257;
  t1310 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t569 + 0.24e2 * t1307);
  t1314 = my_piecewise3(t59, 0, 0.40e2 / 0.81e2 * t1295 * t1296 - 0.16e2 / 0.9e1 * t651 * t303 * t309 + 0.4e1 / 0.3e1 * t302 * t1302 + 0.16e2 / 0.9e1 * t655 * t661 + 0.4e1 / 0.3e1 * t60 * t1310);
  t1321 = t5 * t665 * t97 * t79;
  t1325 = t5 * t313 * t261 * t79;
  t1329 = t5 * t136 * t600 * t79;
  t1334 = 0.10e2 / 0.27e2 * t5 * t62 * t1274 * t79;
  t1336 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t1314 * t26 * t79 - t1321 / 0.2e1 + t1325 / 0.2e1 - 0.5e1 / 0.9e1 * t1329 + t1334);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t649 + 0.4e1 * t683 + t6 * (t1292 + t1336);

  t1342 = t5 * t715 * t125;
  t1343 = t1342 / 0.4e1;
  t1345 = t5 * t343 * t295;
  t1366 = 0.12e2 * t569;
  t1367 = 0.24e2 * t1258;
  t1369 = my_piecewise5(t10, 0, t14, 0, -t1366 + t1367);
  t1373 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1244 * t150 * t562 - 0.8e1 / 0.9e1 * t561 * t334 * t236 - 0.8e1 / 0.9e1 * t688 * t88 * t244 + 0.4e1 / 0.3e1 * t235 * t699 * t88 + 0.4e1 / 0.3e1 * t691 * t244 + 0.4e1 / 0.9e1 * t330 * t573 + 0.4e1 / 0.3e1 * t23 * t1369);
  t1382 = t5 * t708 * t125;
  t1389 = t5 * t153 * t600 * t49;
  t1393 = t5 * t703 * t97 * t49;
  t1397 = t5 * t338 * t261 * t49;
  t1398 = t1397 / 0.4e1;
  t1408 = t1343 - 0.3e1 / 0.8e1 * t1345 - 0.3e1 / 0.8e1 * t5 * t154 * t644 - 0.3e1 / 0.8e1 * t5 * t1373 * t26 * t49 - 0.9e1 / 0.8e1 * t5 * t704 * t125 - 0.3e1 / 0.4e1 * t1382 - 0.9e1 / 0.8e1 * t5 * t339 * t295 - 0.5e1 / 0.36e2 * t1389 - 0.3e1 / 0.8e1 * t1393 + t1398 + t1220 / 0.4e1 - t1223 / 0.8e1 - 0.5e1 / 0.12e2 * t1229 - 0.3e1 / 0.8e1 * t1232 + t1238 / 0.2e1 - 0.3e1 / 0.8e1 * t1240 + t1278 - t1281 / 0.8e1 + t1285 / 0.4e1 - 0.5e1 / 0.12e2 * t1289;
  t1409 = my_piecewise3(t1, 0, t1408);
  t1426 = 0.24e2 * t1307;
  t1428 = my_piecewise5(t14, 0, t10, 0, t1366 + t1426);
  t1432 = my_piecewise3(t59, 0, 0.40e2 / 0.81e2 * t1295 * t161 * t652 - 0.8e1 / 0.9e1 * t651 * t358 * t303 - 0.8e1 / 0.9e1 * t732 * t133 * t309 + 0.4e1 / 0.3e1 * t302 * t742 * t133 + 0.4e1 / 0.3e1 * t735 * t309 + 0.4e1 / 0.9e1 * t354 * t661 + 0.4e1 / 0.3e1 * t60 * t1428);
  t1439 = t5 * t746 * t97 * t79;
  t1443 = t5 * t362 * t261 * t79;
  t1444 = t1443 / 0.4e1;
  t1447 = t5 * t164 * t600 * t79;
  t1456 = t5 * t670 * t188;
  t1459 = t5 * t674 * t188;
  t1460 = t1459 / 0.4e1;
  t1462 = t5 * t678 * t188;
  t1464 = -0.3e1 / 0.8e1 * t5 * t1432 * t26 * t79 - 0.3e1 / 0.8e1 * t1439 + t1444 - 0.5e1 / 0.36e2 * t1447 - t1321 / 0.8e1 + t1325 / 0.4e1 - 0.5e1 / 0.12e2 * t1329 + t1334 - 0.3e1 / 0.8e1 * t5 * t666 * t188 - 0.3e1 / 0.8e1 * t1456 + t1460 - 0.5e1 / 0.36e2 * t1462;
  t1465 = my_piecewise3(t54, 0, t1464);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t649 + t683 + 0.3e1 * t731 + 0.3e1 * t771 + t6 * (t1409 + t1465);

  t1474 = t5 * t787 * t97 * t49;
  t1478 = t5 * t393 * t261 * t49;
  t1488 = t334 * t334;
  t1501 = my_piecewise5(t10, 0, t14, 0, t1367);
  t1505 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1244 * t384 * t236 - 0.32e2 / 0.27e2 * t688 * t88 * t334 - 0.8e1 / 0.27e2 * t774 * t244 + 0.8e1 / 0.9e1 * t235 * t1488 + 0.8e1 / 0.9e1 * t330 * t699 - 0.8e1 / 0.27e2 * t561 * t389 * t236 + 0.8e1 / 0.9e1 * t235 * t783 * t88 + 0.4e1 / 0.9e1 * t779 * t244 + 0.4e1 / 0.3e1 * t23 * t1501);
  t1514 = t5 * t792 * t125;
  t1530 = -t1474 / 0.4e1 + t1478 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1505 * t26 * t49 - 0.3e1 / 0.4e1 * t5 * t788 * t125 - t1514 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t394 * t295 + t1342 / 0.3e1 - t1345 / 0.4e1 - t1382 / 0.2e1 - 0.5e1 / 0.18e2 * t1389 - t1393 / 0.4e1 + t1397 / 0.3e1 + t1220 / 0.12e2 - 0.5e1 / 0.18e2 * t1229 + t1238 / 0.6e1 + t1278 + t1285 / 0.12e2 - 0.5e1 / 0.18e2 * t1289;
  t1531 = my_piecewise3(t1, 0, t1530);
  t1540 = t358 * t358;
  t1553 = my_piecewise5(t14, 0, t10, 0, t1426);
  t1557 = my_piecewise3(t59, 0, 0.40e2 / 0.81e2 * t1295 * t401 * t303 - 0.32e2 / 0.27e2 * t732 * t133 * t358 - 0.8e1 / 0.27e2 * t804 * t309 + 0.8e1 / 0.9e1 * t302 * t1540 + 0.8e1 / 0.9e1 * t354 * t742 - 0.8e1 / 0.27e2 * t651 * t406 * t303 + 0.8e1 / 0.9e1 * t302 * t813 * t133 + 0.4e1 / 0.9e1 * t809 * t309 + 0.4e1 / 0.3e1 * t60 * t1553);
  t1564 = t5 * t817 * t97 * t79;
  t1568 = t5 * t410 * t261 * t79;
  t1577 = t5 * t751 * t188;
  t1580 = t5 * t755 * t188;
  t1591 = t5 * t318 * t446;
  t1594 = t5 * t322 * t446;
  t1596 = -0.3e1 / 0.8e1 * t5 * t1557 * t26 * t79 - t1564 / 0.4e1 + t1568 / 0.12e2 - t1439 / 0.4e1 + t1443 / 0.3e1 - 0.5e1 / 0.18e2 * t1447 - 0.3e1 / 0.4e1 * t5 * t747 * t188 - t1577 / 0.2e1 + t1580 / 0.6e1 + t1325 / 0.12e2 - 0.5e1 / 0.18e2 * t1329 + t1334 - t1456 / 0.4e1 + t1459 / 0.3e1 - 0.5e1 / 0.18e2 * t1462 - 0.3e1 / 0.8e1 * t5 * t314 * t446 - t1591 / 0.4e1 + t1594 / 0.12e2;
  t1597 = my_piecewise3(t54, 0, t1596);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t731 + 0.2e1 * t771 + 0.2e1 * t803 + 0.2e1 * t842 + t6 * (t1531 + t1597);

  t1618 = my_piecewise5(t10, 0, t14, 0, t1366 + t1367);
  t1622 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1244 * t847 * t88 - 0.8e1 / 0.9e1 * t774 * t334 - 0.8e1 / 0.9e1 * t688 * t389 * t88 + 0.4e1 / 0.3e1 * t691 * t389 + 0.4e1 / 0.3e1 * t330 * t783 + 0.4e1 / 0.9e1 * t235 * t854 * t88 + 0.4e1 / 0.3e1 * t23 * t1618);
  t1629 = t5 * t858 * t97 * t49;
  t1640 = -0.3e1 / 0.8e1 * t5 * t1622 * t26 * t49 - t1629 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t859 * t125 - 0.3e1 / 0.8e1 * t1474 + t1478 / 0.4e1 - 0.3e1 / 0.8e1 * t1514 + t1398 - 0.5e1 / 0.12e2 * t1389 + t1343 - 0.5e1 / 0.36e2 * t1289 + t1278 - 0.5e1 / 0.36e2 * t1229;
  t1641 = my_piecewise3(t1, 0, t1640);
  t1658 = my_piecewise5(t14, 0, t10, 0, -t1366 + t1426);
  t1662 = my_piecewise3(t59, 0, 0.40e2 / 0.81e2 * t1295 * t867 * t133 - 0.8e1 / 0.9e1 * t804 * t358 - 0.8e1 / 0.9e1 * t732 * t406 * t133 + 0.4e1 / 0.3e1 * t735 * t406 + 0.4e1 / 0.3e1 * t354 * t813 + 0.4e1 / 0.9e1 * t302 * t874 * t133 + 0.4e1 / 0.3e1 * t60 * t1658);
  t1669 = t5 * t878 * t97 * t79;
  t1677 = t5 * t822 * t188;
  t1686 = t5 * t367 * t446;
  t1696 = t5 * t141 * t927;
  t1698 = -0.3e1 / 0.8e1 * t5 * t1662 * t26 * t79 - t1669 / 0.8e1 - 0.3e1 / 0.8e1 * t1564 + t1568 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t818 * t188 - 0.3e1 / 0.8e1 * t1677 + t1444 - 0.5e1 / 0.12e2 * t1447 - 0.3e1 / 0.4e1 * t1577 + t1580 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t363 * t446 - 0.3e1 / 0.8e1 * t1686 - 0.5e1 / 0.36e2 * t1329 + t1334 + t1460 - 0.5e1 / 0.12e2 * t1462 - 0.3e1 / 0.8e1 * t1591 + t1594 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t137 * t927 - t1696 / 0.8e1;
  t1699 = my_piecewise3(t54, 0, t1698);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t803 + 0.3e1 * t842 + t866 + t932 + t6 * (t1641 + t1699);

  t1704 = t384 * t384;
  t1709 = t389 * t389;
  t1716 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t569 + 0.24e2 * t1258);
  t1720 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1244 * t1704 - 0.16e2 / 0.9e1 * t774 * t389 + 0.4e1 / 0.3e1 * t235 * t1709 + 0.16e2 / 0.9e1 * t330 * t854 + 0.4e1 / 0.3e1 * t23 * t1716);
  t1729 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1720 * t26 * t49 - t1629 / 0.2e1 + t1478 / 0.2e1 - 0.5e1 / 0.9e1 * t1389 + t1278);
  t1732 = sigma[2] / t66 / t178;
  t1738 = t176 / t65 / t510;
  t1743 = t433 / t1052;
  t1746 = t434 * t178;
  t1749 = t911 / t66 / t1746;
  t1753 = t434 * t434;
  t1758 = t112 * t72;
  t1769 = t33 * t77;
  t1782 = t401 * t401;
  t1787 = t406 * t406;
  t1794 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t569 + 0.24e2 * t1307);
  t1798 = my_piecewise3(t59, 0, 0.40e2 / 0.81e2 * t1295 * t1782 - 0.16e2 / 0.9e1 * t804 * t406 + 0.4e1 / 0.3e1 * t302 * t1787 + 0.16e2 / 0.9e1 * t354 * t874 + 0.4e1 / 0.3e1 * t60 * t1794);
  t1814 = -0.3e1 / 0.8e1 * t5 * t63 * (0.66473497942386831276e0 * t33 * t1732 * t72 - 0.93419703395061728392e-2 * t112 * t1738 * t72 + 0.12987962358721643396e-5 * t1743 * t72 - 0.79954767887596601447e-9 * t1749 * t916 + 0.13135426152962298809e-12 * t911 * sigma[2] / t65 / t1753 / rho[1] * t1758 + 0.32392901851851851853e0 * t33 * t1732 * t77 - 0.97512161898148148147e-3 * t112 * t1738 * t77 + 0.32596252161498095165e-7 * t1743 * t77 - 0.39757549984857525162e-11 * t1749 * t1769) - 0.3e1 / 0.2e1 * t5 * t165 * t927 - 0.9e1 / 0.4e1 * t5 * t411 * t446 - 0.3e1 / 0.8e1 * t5 * t1798 * t26 * t79 - 0.3e1 / 0.2e1 * t5 * t879 * t188 - t1669 / 0.2e1 - 0.3e1 / 0.2e1 * t1677 - 0.3e1 / 0.2e1 * t1686 - t1696 / 0.2e1 + t1594 / 0.2e1 + t1568 / 0.2e1 + t1580 - 0.5e1 / 0.9e1 * t1447 - 0.5e1 / 0.9e1 * t1462 + t1334;
  t1815 = my_piecewise3(t54, 0, t1814);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t866 + 0.4e1 * t932 + t6 * (t1729 + t1815);

  t1823 = t5 * t582 * t209;
  t1829 = t5 * t589 * t209;
  t1832 = t5 * t253 * t478;
  t1839 = 0.5e1 / 0.36e2 * t5 * t601 * t209;
  t1841 = t5 * t262 * t478;
  t1844 = t5 * t98 * t975;
  t1849 = t618 * sigma[0];
  t1853 = t624 * t113;
  t1856 = t631 * t282;
  t1879 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t578 * t209 - 0.3e1 / 0.8e1 * t1823 - 0.9e1 / 0.8e1 * t5 * t249 * t478 + t1829 / 0.4e1 - 0.3e1 / 0.4e1 * t1832 - 0.9e1 / 0.8e1 * t5 * t92 * t975 - t1839 + t1841 / 0.4e1 - 0.3e1 / 0.8e1 * t1844 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.11730617283950617284e0 * t33 * t612 * t42 + 0.23270612037037037037e-2 * t112 * t1849 * t42 - 0.38956285849657679909e-6 * t1853 * t42 + 0.27229493655597311972e-9 * t1856 * t633 - 0.49257848073608620534e-13 * t628 / t35 / t1196 * t1201 - 0.57163944444444444446e-1 * t33 * t612 * t47 + 0.25473682743055555556e-3 * t112 * t1849 * t47 - 0.10556740756848814912e-7 * t1853 * t47 + 0.14909081244321571936e-11 * t1856 * t1212));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t1879 * t6 + 0.3e1 * t980;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  t1886 = t5 * t670 * t227;
  t1889 = t5 * t674 * t227;
  t1893 = 0.5e1 / 0.36e2 * t5 * t678 * t227;
  t1895 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t666 * t227 - 0.3e1 / 0.8e1 * t1886 + t1889 / 0.4e1 - t1893);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t1895 * t6 + 0.3e1 * t993;

  t1897 = 0.2e1 * t1007;
  t1903 = t5 * t708 * t209 / 0.4e1;
  t1908 = t5 * t715 * t209;
  t1912 = t5 * t343 * t478 / 0.4e1;
  t1921 = -0.3e1 / 0.8e1 * t5 * t704 * t209 - t1903 - 0.3e1 / 0.4e1 * t5 * t339 * t478 + t1908 / 0.12e2 - t1912 - 0.3e1 / 0.8e1 * t5 * t154 * t975 - t1823 / 0.8e1 + t1829 / 0.6e1 - t1832 / 0.4e1 - t1839 + t1841 / 0.6e1 - t1844 / 0.8e1;
  t1922 = my_piecewise3(t1, 0, t1921);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t1922 * t6 + t1897 + t980;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  t1924 = 0.2e1 * t1023;
  t1930 = t5 * t751 * t227 / 0.4e1;
  t1932 = t5 * t755 * t227;
  t1941 = t5 * t318 * t521 / 0.4e1;
  t1943 = t5 * t322 * t521;
  t1946 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t747 * t227 - t1930 + t1932 / 0.12e2 - t1886 / 0.8e1 + t1889 / 0.6e1 - t1893 - 0.3e1 / 0.8e1 * t5 * t314 * t521 - t1941 + t1943 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t1946 * t6 + t1924 + t993;

  t1952 = t5 * t792 * t209;
  t1961 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t788 * t209 - t1952 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t394 * t478 - t1903 + t1908 / 0.6e1 - t1912 + t1829 / 0.12e2 - t1839 + t1841 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t1961 * t6 + t1031 + t1897;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  t1967 = t5 * t822 * t227;
  t1974 = t5 * t367 * t521;
  t1982 = t5 * t141 * t1066;
  t1984 = -0.3e1 / 0.8e1 * t5 * t818 * t227 - t1967 / 0.8e1 - t1930 + t1932 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t363 * t521 - t1974 / 0.4e1 + t1889 / 0.12e2 - t1893 - t1941 + t1943 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t137 * t1066 - t1982 / 0.8e1;
  t1985 = my_piecewise3(t54, 0, t1984);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t1985 * t6 + t1071 + t1924;

  t1994 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t859 * t209 - 0.3e1 / 0.8e1 * t1952 + t1908 / 0.4e1 - t1839);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t1994 * t6 + 0.3e1 * t1031;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  t2014 = t901 * sigma[2];
  t2018 = t907 * t176;
  t2021 = t914 * t433;
  t2044 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t879 * t227 - 0.3e1 / 0.8e1 * t1967 - 0.9e1 / 0.8e1 * t5 * t411 * t521 + t1932 / 0.4e1 - 0.3e1 / 0.4e1 * t1974 - 0.9e1 / 0.8e1 * t5 * t165 * t1066 - t1893 + t1943 / 0.4e1 - 0.3e1 / 0.8e1 * t1982 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.11730617283950617284e0 * t33 * t895 * t72 + 0.23270612037037037037e-2 * t112 * t2014 * t72 - 0.38956285849657679909e-6 * t2018 * t72 + 0.27229493655597311972e-9 * t2021 * t916 - 0.49257848073608620534e-13 * t911 / t65 / t1753 * t1758 - 0.57163944444444444446e-1 * t33 * t895 * t77 + 0.25473682743055555556e-3 * t112 * t2014 * t77 - 0.10556740756848814912e-7 * t2018 * t77 + 0.14909081244321571936e-11 * t2021 * t1769));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = t2044 * t6 + 0.3e1 * t1071;

  t2051 = t5 * t253 * t538;
  t2058 = t5 * t262 * t538 / 0.12e2;
  t2060 = t5 * t98 * t1095;
  t2065 = t285 * sigma[0];
  t2068 = t963 * t113;
  t2089 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t538 - t2051 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t1095 + t2058 - t2060 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.34951907407407407409e-3 * t112 * t277 * t42 + 0.95205362003309744560e-7 * t2065 * t42 - 0.86048259445356674069e-10 * t2068 * t633 + 0.18471693027603232700e-13 * t282 / t35 / t283 / t275 * t1201 - 0.42580642708333333333e-4 * t112 * t277 * t47 + 0.29864463983190726395e-8 * t2065 * t47 - 0.55909054666205894762e-12 * t2068 * t1212));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = t2089 * t6 + 0.2e1 * t1100;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  t2096 = t5 * t318 * t553;
  t2100 = t5 * t322 * t553 / 0.12e2;
  t2102 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t553 - t2096 / 0.4e1 + t2100);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = t2102 * t6 + 0.2e1 * t1109;

  t2108 = t5 * t343 * t538;
  t2116 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t538 - t2108 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t1095 - t2051 / 0.8e1 + t2058 - t2060 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t2116 * t6 + t1100 + t1115;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t2122 = t5 * t367 * t553;
  t2129 = t5 * t141 * t1136;
  t2132 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t553 - t2122 / 0.8e1 - t2096 / 0.8e1 + t2100 - 0.3e1 / 0.8e1 * t5 * t137 * t1136 - t2129 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = t2132 * t6 + t1109 + t1141;

  t2140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t538 - t2108 / 0.4e1 + t2058);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = t2140 * t6 + 0.2e1 * t1115;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t2154 = t436 * sigma[2];
  t2157 = t1054 * t176;
  t2178 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t553 - t2122 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t1136 + t2100 - t2129 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.34951907407407407409e-3 * t112 * t428 * t72 + 0.95205362003309744560e-7 * t2154 * t72 - 0.86048259445356674069e-10 * t2157 * t916 + 0.18471693027603232700e-13 * t433 / t65 / t434 / t426 * t1758 - 0.42580642708333333333e-4 * t112 * t428 * t77 + 0.29864463983190726395e-8 * t2154 * t77 - 0.55909054666205894762e-12 * t2157 * t1769));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = t2178 * t6 + 0.2e1 * t1141;

  t2185 = t5 * t98 * t1152 / 0.8e1;
  t2188 = t1086 * t28;
  t2189 = t32 * sigma[0];
  t2208 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t1152 - t2185 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.15392483677181814989e-7 * t468 * t42 + 0.24093512644699868739e-10 * t2188 * t2189 * t42 - 0.69268848853512122624e-14 * t113 / t35 / t1189 * t1201 - 0.62507017639236404081e-9 * t468 * t47 + 0.20965895499827210535e-12 * t2188 * t2189 * t47));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t2208 * t6 + t1156;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  t2215 = t5 * t141 * t1166 / 0.8e1;
  t2217 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t1166 - t2215);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t2217 * t6 + t1170;

  t2223 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t1152 - t2185);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t2223 * t6 + t1156;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t2230 = t1127 * t28;
  t2231 = t32 * sigma[2];
  t2250 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t1166 - t2215 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.15392483677181814989e-7 * t511 * t72 + 0.24093512644699868739e-10 * t2230 * t2231 * t72 - 0.69268848853512122624e-14 * t176 / t65 / t1746 * t1758 - 0.62507017639236404081e-9 * t511 * t77 + 0.20965895499827210535e-12 * t2230 * t2231 * t77));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t2250 * t6 + t1170;

  t2252 = t1146 * t28;
  t2268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-0.51628955667214004441e-11 * t2252 * t32 * t42 + 0.25975818320067045984e-14 * sigma[0] / t35 / t629 * t1201 - 0.78622108124352039508e-13 * t2252 * t32 * t47));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = t6 * t2268;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t2269 = t1160 * t28;
  t2285 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * (-0.51628955667214004441e-11 * t2269 * t32 * t72 + 0.25975818320067045984e-14 * sigma[2] / t65 / t912 * t1758 - 0.78622108124352039508e-13 * t2269 * t32 * t77));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = t6 * t2285;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

