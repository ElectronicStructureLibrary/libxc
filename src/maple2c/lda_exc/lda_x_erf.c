/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/lda_exc/lda_x_erf.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t273, t276, t281, t286, t291, t296, t301;
  double t304, t307, t311, t314, t323, t324, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t273 = t163 * t93;
  t276 = t35 * t93;
  t281 = t38 * t93;
  t286 = t41 * t93;
  t291 = t44 * t93;
  t296 = t47 * t93;
  t301 = t50 * t93;
  t304 = -0.2e1 / 0.3e1 * t97 * t273 + t276 * t173 / 0.2e1 + t101 * t273 / 0.8e1 - t281 * t173 / 0.16e2 - t105 * t273 / 0.8e2 + 0.3e1 / 0.64e3 * t286 * t173 + t109 * t273 / 0.1152e4 - t291 * t173 / 0.384e4 - t113 * t273 / 0.21504e5 + t296 * t173 / 0.86016e5 + t117 * t273 / 0.49152e6 - t301 * t173 / 0.229376e7;
  t307 = t53 * t93;
  t311 = 0.1e1 / t52 / t86;
  t314 = t201 * t93;
  t323 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t324 = my_piecewise3(t29, -t323, 0);
  t341 = -t121 * t273 / 0.1327104e8 + t307 * t173 / 0.7077888e8 + t311 * t273 / 0.4128768e9 - t314 * t173 / 0.24772608e10 - t87 * t324 / 0.18e2 + t97 * t324 / 0.24e3 - t101 * t324 / 0.448e4 + t105 * t324 / 0.10368e6 - t109 * t324 / 0.2838528e7 + t113 * t324 / 0.8945664e8 - t117 * t324 / 0.31850496e10 + t121 * t324 / 0.1263403008e12;
  t343 = my_piecewise3(t29, 0, -t323);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t304 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t273, t276, t281, t286, t291, t296, t301;
  double t304, t307, t311, t314, t323, t324, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;

  double t438, t444, t445, t462, t465, t488, t539, t541;
  double t550, t567, t576, t604, t648, t652, tv4rho40;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t273 = t163 * t93;
  t276 = t35 * t93;
  t281 = t38 * t93;
  t286 = t41 * t93;
  t291 = t44 * t93;
  t296 = t47 * t93;
  t301 = t50 * t93;
  t304 = -0.2e1 / 0.3e1 * t97 * t273 + t276 * t173 / 0.2e1 + t101 * t273 / 0.8e1 - t281 * t173 / 0.16e2 - t105 * t273 / 0.8e2 + 0.3e1 / 0.64e3 * t286 * t173 + t109 * t273 / 0.1152e4 - t291 * t173 / 0.384e4 - t113 * t273 / 0.21504e5 + t296 * t173 / 0.86016e5 + t117 * t273 / 0.49152e6 - t301 * t173 / 0.229376e7;
  t307 = t53 * t93;
  t311 = 0.1e1 / t52 / t86;
  t314 = t201 * t93;
  t323 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t324 = my_piecewise3(t29, -t323, 0);
  t341 = -t121 * t273 / 0.1327104e8 + t307 * t173 / 0.7077888e8 + t311 * t273 / 0.4128768e9 - t314 * t173 / 0.24772608e10 - t87 * t324 / 0.18e2 + t97 * t324 / 0.24e3 - t101 * t324 / 0.448e4 + t105 * t324 / 0.10368e6 - t109 * t324 / 0.2838528e7 + t113 * t324 / 0.8945664e8 - t117 * t324 / 0.31850496e10 + t121 * t324 / 0.1263403008e12;
  t343 = my_piecewise3(t29, 0, -t323);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t304 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t438 = t166 * t166;
  t444 = 0.14e3 / 0.729e3 * t20 * t1 / t15 / t438 * t24;
  t445 = my_piecewise3(t29, t444, 0);
  t462 = t163 * t163;
  t465 = t173 * t173;
  t488 = -t87 * t445 / 0.18e2 + t97 * t445 / 0.24e3 - t101 * t445 / 0.448e4 + t105 * t445 / 0.10368e6 - t109 * t445 / 0.2838528e7 + t113 * t445 / 0.8945664e8 - t117 * t445 / 0.31850496e10 + t121 * t445 / 0.1263403008e12 + 0.1e2 / 0.3e1 * t38 * t462 + t35 * t465 / 0.2e1 - 0.7e1 / 0.8e1 * t41 * t462 - t38 * t465 / 0.16e2 + 0.9e1 / 0.8e2 * t44 * t462 + 0.3e1 / 0.64e3 * t41 * t465 - 0.11e2 / 0.1152e4 * t47 * t462 - t44 * t465 / 0.384e4 + 0.13e2 / 0.21504e5 * t50 * t462 + t47 * t465 / 0.86016e5 - t53 * t462 / 0.32768e5 - t50 * t465 / 0.229376e7;
  t539 = 0.17e2 / 0.1327104e8 * t201 * t462 + t53 * t465 / 0.7077888e8 - 0.19e2 / 0.4128768e9 / t52 / t34 * t462 - t201 * t465 / 0.24772608e10 - 0.4e1 * t97 * t163 * t173 + 0.2e1 / 0.3e1 * t276 * t324 + 0.3e1 / 0.4e1 * t101 * t163 * t173 - t281 * t324 / 0.12e2 - 0.3e1 / 0.4e2 * t105 * t163 * t173 + t286 * t324 / 0.16e3 + t109 * t163 * t173 / 0.192e3 - t291 * t324 / 0.288e4 - t113 * t163 * t173 / 0.3584e4 + t296 * t324 / 0.64512e5 + t117 * t163 * t173 / 0.8192e5 - t301 * t324 / 0.172032e7 - t121 * t163 * t173 / 0.221184e7 + t307 * t324 / 0.5308416e8 + t311 * t163 * t173 / 0.688128e8 - t314 * t324 / 0.18579456e10;
  t541 = my_piecewise3(t29, 0, t444);
  t550 = t215 * t215;
  t567 = t207 * t207;
  t576 = t65 * t343;
  t604 = 0.85e2 / 0.4e1 * t359 * t550 * t65 - 0.19e2 / 0.8e1 / t358 / t62 * t550 * t65 + t132 * t541 * t65 / 0.2e1 + 0.1e1 / t358 / t212 * t550 * t65 / 0.16e2 - 0.12e2 * t567 * t66 - 0.16e2 * t399 * t343 - 0.4e1 * t136 * t541 - t58 * t541 * t65 - 0.8e1 * t379 * t576 - 0.15e2 * t383 * t215 * t355 + t235 * t343 * t391 + 0.3e1 / 0.4e1 * t235 * t567 * t65 + 0.3e1 / 0.4e1 * t395 * t207 * t215 * t65 - 0.3e1 * t63 * t567 * t65 - 0.4e1 * t402 * t576 - 0.75e2 / 0.2e1 * t235 * t550 * t65 + 0.45e2 * t216 * t355 - 0.6e1 * t227 * t567 * t65;
  t648 = 0.2e1 * t56 * t604 + 0.2e1 * t541 * t69 + 0.8e1 * t343 * t141 + 0.12e2 * t207 * t247 + 0.8e1 * t125 * t409 - 0.1e1 / t358 / t131 * t550 * t65 / 0.8e1 - t127 * t541 + 0.15e2 / 0.4e1 * t395 * t550 * t65 + 0.24e2 * t65 * t214 * t550 - 0.36e2 * t363 * t215 * t207 + 0.6e1 * t219 * t567 + 0.8e1 * t219 * t125 * t343 - 0.24e2 * t383 * t550 * t65 + 0.21e2 * t236 * t355 - 0.3e1 / 0.2e1 * t214 * t567 * t65 - 0.2e1 * t354 * t576 - 0.3e1 / 0.2e1 * t359 * t215 * t355;
  t652 = my_piecewise3(t28, t488 + t539, -0.8e1 / 0.3e1 * t541 * t72 - 0.32e2 / 0.3e1 * t343 * t144 - 0.16e2 * t207 * t250 - 0.32e2 / 0.3e1 * t125 * t412 - 0.8e1 / 0.3e1 * t56 * t648);
  tv4rho40 = -0.5e1 / 0.54e2 * t7 * t14 / t153 / t166 * t76 + 0.2e1 / 0.9e1 * t7 * t14 * t260 * t148 - t7 * t14 * t154 * t254 / 0.2e1 - t7 * t14 * t15 * t416 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t652;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1278, t1279, t1281, t1282, t1284, t1285, t1287;
  double t1290, t1291, t1292, t1294, t1295, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1331, t1334, t1339, t1343, t1346, t1351, t1356, t1361;
  double t1364, t1367, t1372, t1377, t1380, t1382, t1385, t1388;
  double t1390, t1391, t1392, t1393, t1397, t1401, t1403, t1406;
  double t1412, t1413, t1417, t1418, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1542, t1545;
  double t1550, t1555, t1560, t1565, t1570, t1573, t1576, t1580;
  double t1583, t1588, t1590, t1593, t1596, t1598, t1599, t1600;
  double t1601, t1605, t1609, t1611, t1614, t1620, t1621, t1625;
  double t1626, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1680, t1684, t1685, t1695, t1696, t1707, t1710, t1714;
  double t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30, t1737;
  double t1749, t1750, t1751, t1753, t1756, t1759, t1760, t1762;
  double t1763, t1764, t1766, t1768, t1770, t1771, t1773, t1777;
  double t1787, t1788, t1790, t1793, t1796, t1797, t1799, t1802;
  double t1805, t1807, t1809, t1810, t1811, t1816, t1821, t1826;
  double t1831, t1836, t1841, t1846, t1851, t1866, t1873, t1875;
  double t1878, t1881, t1882, t1883, t1887, t1891, t1895, t1898;
  double t1903, t1908, t1909, t1913, t1914, t1931, t1933, t1946;
  double t1949, t1952, t1974, t1975, t1978, t1981, t1989, t1994;
  double t1997, t2002, t2010, t2013, t2017, t2018, t2020, t2024;
  double t2034, t2035, t2037, t2040, t2043, t2044, t2046, t2049;
  double t2052, t2054, t2056, t2057, t2058, t2063, t2068, t2073;
  double t2078, t2083, t2088, t2093, t2098, t2113, t2120, t2122;
  double t2125, t2128, t2129, t2130, t2134, t2138, t2142, t2145;
  double t2150, t2155, t2156, t2160, t2161, t2178, t2180, t2193;
  double t2196, t2199, t2221, t2222, t2225, t2228, t2236, t2241;
  double t2244, t2249, t2257, t2260, t2264, t2265, t2267, t2269;
  double t2272, t2273, t2274, t2275, t2276, t2277, t2278, t2279;
  double t2280, tv3rho31, t2289, t2291, t2293, t2295, t2297, t2299;
  double t2302, t2305, t2308, t2311, t2313, t2318, t2321, t2326;
  double t2329, t2334, t2337, t2342, t2345, t2350, t2353, t2356;
  double t2359, t2362, t2367, t2370, t2375, t2381, t2383, t2387;
  double t2392, t2394, t2398, t2403, t2408, t2409, t2412, t2413;
  double t2417, t2418, t2435, t2437, t2451, t2460, t2481, t2484;
  double t2490, t2495, t2498, t2501, t2511, t2514, t2518, t2519;
  double t2521, t2529, t2533, t2534, t2536, t2539, t2542, t2545;
  double t2548, t2550, t2555, t2558, t2563, t2566, t2571, t2574;
  double t2579, t2582, t2587, t2590, t2593, t2596, t2599, t2604;
  double t2607, t2612, t2618, t2620, t2624, t2629, t2631, t2635;
  double t2640, t2643, t2646, t2647, t2651, t2652, t2669, t2671;
  double t2685, t2694, t2715, t2718, t2724, t2729, t2732, t2735;
  double t2745, t2748, t2752, t2753, t2755, t2766, t2767, t2769;
  double t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32, t2795;
  double t2801, t2805, t2806, t2808, t2809, t2811, t2812, t2814;
  double t2815, t2819, t2820, t2824, t2828, t2832, t2835, t2836;
  double t2840, t2841, t2858, t2867, t2892, t2894, t2901, t2902;
  double t2907, t2912, t2927, t2935, t2946, t2949, t2953, t2954;
  double t2956, t2957, t2958, t2963, t2967, t2968, t2970, t2971;
  double t2973, t2974, t2976, t2977, t2978, t3003, t3015, t3016;
  double t3020, t3024, t3028, t3031, t3032, t3036, t3037, t3054;
  double t3056, t3063, t3064, t3069, t3074, t3089, t3097, t3108;
  double t3111, t3115, t3116, t3118, t3119, t3120, t3121, t3122;
  double t3123, t3124, tv3rho33;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = t7 * t622 * t257;
  t1278 = t7 * t253 * t632;
  t1279 = t1278 / 0.16e2;
  t1281 = 0.1e1 / t163 / t152;
  t1282 = t1281 * t145;
  t1284 = t7 * t92 * t1282;
  t1285 = 0.5e1 / 0.144e3 * t1284;
  t1287 = t7 * t476 * t165;
  t1290 = t7 * t159 * t488;
  t1291 = t1290 / 0.16e2;
  t1292 = t1281 * t83;
  t1294 = t7 * t21 * t1292;
  t1295 = 0.5e1 / 0.144e3 * t1294;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1331 = t496 * t189;
  t1334 = t57 * t189;
  t1339 = t60 * t189;
  t1343 = 0.1e1 / t59 / t169;
  t1346 = t556 * t189;
  t1351 = t42 * t189;
  t1356 = t45 * t189;
  t1361 = t48 * t189;
  t1364 = t213 * t1331 / 0.49152e6 - t1334 * t528 / 0.229376e7 - t217 * t1331 / 0.1327104e8 + t1339 * t528 / 0.7077888e8 + t1343 * t1331 / 0.4128768e9 - t1346 * t528 / 0.24772608e10 - 0.2e1 / 0.3e1 * t193 * t1331 + t1351 * t528 / 0.2e1 + t197 * t1331 / 0.8e1 - t1356 * t528 / 0.16e2 - t201 * t1331 / 0.8e2 + 0.3e1 / 0.64e3 * t1361 * t528;
  t1367 = t51 * t189;
  t1372 = t54 * t189;
  t1377 = t1 / t22 / t467;
  t1380 = 0.14e2 / 0.243e3 * t27 * t1377 * t31;
  t1382 = t27 * t501 * t184;
  t1385 = t27 * t173 * t511;
  t1388 = t27 * t173 * t523;
  t1390 = t177 * t177;
  t1391 = 0.1e1 / t1390;
  t1392 = t510 * t183;
  t1393 = t1391 * t1392;
  t1397 = t183 * t522;
  t1401 = t14 * t14;
  t1403 = 0.1e1 / t179 / t1401;
  t1406 = t516 * t155;
  t1412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1403 * t1296 - 0.2e1 / 0.3e1 * t1406 * t471 + t180 * t1305 / 0.3e1);
  t1413 = t178 * t1412;
  t1417 = -t1380 - 0.2e1 / 0.27e2 * t1382 - t1385 / 0.9e1 + t1388 / 0.18e2 - t27 * t29 * t1393 / 0.3e1 + t791 * t792 * t1397 / 0.3e1 - t27 * t29 * t1413 / 0.18e2;
  t1418 = my_piecewise3(t36, t1417, 0);
  t1435 = t205 * t1331 / 0.1152e4 - t1367 * t528 / 0.384e4 - t209 * t1331 / 0.21504e5 + t1372 * t528 / 0.86016e5 - t170 * t1418 / 0.18e2 + t193 * t1418 / 0.24e3 - t197 * t1418 / 0.448e4 + t201 * t1418 / 0.10368e6 - t205 * t1418 / 0.2838528e7 + t209 * t1418 / 0.8945664e8 - t213 * t1418 / 0.31850496e10 + t217 * t1418 / 0.1263403008e12;
  t1437 = my_piecewise3(t36, 0, t1417);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1364 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1542 = t640 * t278;
  t1545 = t105 * t278;
  t1550 = t108 * t278;
  t1555 = t111 * t278;
  t1560 = t114 * t278;
  t1565 = t117 * t278;
  t1570 = t120 * t278;
  t1573 = -0.2e1 / 0.3e1 * t282 * t1542 + t1545 * t669 / 0.2e1 + t286 * t1542 / 0.8e1 - t1550 * t669 / 0.16e2 - t290 * t1542 / 0.8e2 + 0.3e1 / 0.64e3 * t1555 * t669 + t294 * t1542 / 0.1152e4 - t1560 * t669 / 0.384e4 - t298 * t1542 / 0.21504e5 + t1565 * t669 / 0.86016e5 + t302 * t1542 / 0.49152e6 - t1570 * t669 / 0.229376e7;
  t1576 = t123 * t278;
  t1580 = 0.1e1 / t122 / t261;
  t1583 = t697 * t278;
  t1588 = 0.14e2 / 0.243e3 * t27 * t1377 * t94;
  t1590 = t27 * t501 * t273;
  t1593 = t27 * t173 * t652;
  t1596 = t27 * t173 * t664;
  t1598 = t266 * t266;
  t1599 = 0.1e1 / t1598;
  t1600 = t651 * t272;
  t1601 = t1599 * t1600;
  t1605 = t272 * t663;
  t1609 = t87 * t87;
  t1611 = 0.1e1 / t268 / t1609;
  t1614 = t657 * t249;
  t1620 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1611 * t1511 - 0.2e1 / 0.3e1 * t1614 * t617 + t269 * t1516 / 0.3e1);
  t1621 = t267 * t1620;
  t1625 = -t1588 - 0.2e1 / 0.27e2 * t1590 - t1593 / 0.9e1 + t1596 / 0.18e2 - t27 * t29 * t1601 / 0.3e1 + t791 * t931 * t1605 / 0.3e1 - t27 * t29 * t1621 / 0.18e2;
  t1626 = my_piecewise3(t99, t1625, 0);
  t1643 = -t306 * t1542 / 0.1327104e8 + t1576 * t669 / 0.7077888e8 + t1580 * t1542 / 0.4128768e9 - t1583 * t669 / 0.24772608e10 - t262 * t1626 / 0.18e2 + t282 * t1626 / 0.24e3 - t286 * t1626 / 0.448e4 + t290 * t1626 / 0.10368e6 - t294 * t1626 / 0.2838528e7 + t298 * t1626 / 0.8945664e8 - t302 * t1626 / 0.31850496e10 + t306 * t1626 / 0.1263403008e12;
  t1645 = my_piecewise3(t99, 0, t1625);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t310 * t703 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1573 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = -0.3e1 / 0.32e2 * t1275 + t1279 - t1285 - 0.3e1 / 0.32e2 * t1287 + t1291 - t1295 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t402 * t632;
  t1759 = t7 * t905 * t257;
  t1760 = t1759 / 0.16e2;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = -t1275 / 0.32e2 + t1278 / 0.24e2 - t1285 - t1287 / 0.32e2 + t1290 / 0.24e2 - t1295 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 + t1756 / 0.48e2 - t1760 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t45 * t810;
  t1816 = t48 * t810;
  t1821 = t51 * t810;
  t1826 = t54 * t810;
  t1831 = t57 * t810;
  t1836 = t60 * t810;
  t1841 = t556 * t810;
  t1846 = t42 * t810;
  t1851 = -t1811 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1816 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1821 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1826 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1831 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1836 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9 - t1841 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10 + t1846 * t189 / 0.3e1 + t783 * t528 / 0.6e1;
  t1866 = t1343 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1391;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1403 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1380 - 0.4e1 / 0.81e2 * t1382 - t1385 / 0.27e2 + t1388 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t117 * t949;
  t2063 = t120 * t949;
  t2068 = t123 * t949;
  t2073 = t697 * t949;
  t2078 = t105 * t949;
  t2083 = t108 * t949;
  t2088 = t111 * t949;
  t2093 = t114 * t949;
  t2098 = t2058 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2063 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2068 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2073 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10 + t2078 * t278 / 0.3e1 + t924 * t669 / 0.6e1 - t2083 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2088 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2093 * t278 / 0.576e4 - t962 * t669 / 0.1152e5;
  t2113 = t1580 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1599;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1611 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1588 - 0.4e1 / 0.81e2 * t1590 - t1593 / 0.27e2 + t1596 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = t1278 / 0.48e2 - t1285 + t1290 / 0.48e2 - t1295 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 + t1756 / 0.24e2 - t1760 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2291 = t7 * t402 * t920;
  t2293 = t164 * t1267;
  t2295 = t7 * t92 * t2293;
  t2297 = t164 * t1153;
  t2299 = t7 * t21 * t2297;
  t2302 = t7 * t1166 * t257;
  t2305 = t7 * t1052 * t165;
  t2308 = t7 * t344 * t779;
  t2311 = t7 * t159 * t1154;
  t2313 = t193 * t1061;
  t2318 = t42 * t1081;
  t2321 = t197 * t1061;
  t2326 = t45 * t1081;
  t2329 = t201 * t1061;
  t2334 = t48 * t1081;
  t2337 = t205 * t1061;
  t2342 = t51 * t1081;
  t2345 = t209 * t1061;
  t2350 = t54 * t1081;
  t2353 = t213 * t1061;
  t2356 = -0.2e1 / 0.3e1 * t2313 * t189 + t783 * t810 / 0.3e1 + t2318 * t189 / 0.6e1 + t2321 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2326 * t189 / 0.48e2 - t2329 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2334 * t189 / 0.64e3 + t2337 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2342 * t189 / 0.1152e5 - t2345 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2350 * t189 / 0.258048e6 + t2353 * t189 / 0.49152e6;
  t2359 = t57 * t1081;
  t2362 = t217 * t1061;
  t2367 = t60 * t1081;
  t2370 = t1343 * t1061;
  t2375 = t556 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1403 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1380 - 0.2e1 / 0.81e2 * t1382 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t833 * t810 / 0.344064e7 - t2359 * t189 / 0.688128e7 - t2362 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2367 * t189 / 0.21233664e9 + t2370 * t189 / 0.4128768e9 - t843 * t810 / 0.37158912e10 - t2375 * t189 / 0.74317824e10 + t217 * t2418 / 0.1263403008e12 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2550 = t282 * t1175;
  t2555 = t105 * t1195;
  t2558 = t286 * t1175;
  t2563 = t108 * t1195;
  t2566 = t290 * t1175;
  t2571 = t111 * t1195;
  t2574 = t294 * t1175;
  t2579 = t114 * t1195;
  t2582 = t298 * t1175;
  t2587 = t117 * t1195;
  t2590 = t302 * t1175;
  t2593 = -0.2e1 / 0.3e1 * t2550 * t278 + t924 * t949 / 0.3e1 + t2555 * t278 / 0.6e1 + t2558 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2563 * t278 / 0.48e2 - t2566 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2571 * t278 / 0.64e3 + t2574 * t278 / 0.1152e4 - t962 * t949 / 0.576e4 - t2579 * t278 / 0.1152e5 - t2582 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2587 * t278 / 0.258048e6 + t2590 * t278 / 0.49152e6;
  t2596 = t120 * t1195;
  t2599 = t306 * t1175;
  t2604 = t123 * t1195;
  t2607 = t1580 * t1175;
  t2612 = t697 * t1195;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1611 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1588 - 0.2e1 / 0.81e2 * t1590 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t972 * t949 / 0.344064e7 - t2596 * t278 / 0.688128e7 - t2599 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2604 * t278 / 0.21233664e9 + t2607 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2612 * t278 / 0.74317824e10 - t262 * t2652 / 0.18e2 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2593 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2291 / 0.16e2 - t2295 / 0.32e2 - t2299 / 0.32e2 - t2302 / 0.32e2 - t2305 / 0.32e2 - t2308 / 0.16e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1599 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1611 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1588 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = -t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 + t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1580 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2978 = t1061 * t356;
  t3003 = t197 * t2978 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t2978 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t2978 / 0.1152e4 - t823 * t1081 / 0.384e4 - t209 * t2978 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t2978 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t2978 / 0.1327104e8 + t838 * t1081 / 0.7077888e8;
  t3015 = t1065 * t350;
  t3016 = t1391 * t3015;
  t3020 = t350 * t1075;
  t3024 = t1403 * t2958;
  t3028 = t180 * t2963;
  t3031 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t3024 - 0.2e1 / 0.3e1 * t797 * t1047 + t3028 / 0.3e1);
  t3032 = t178 * t3031;
  t3036 = -t1380 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t3016 / 0.3e1 + t791 * t792 * t3020 / 0.3e1 - t27 * t29 * t3032 / 0.18e2;
  t3037 = my_piecewise3(t36, t3036, 0);
  t3054 = t1343 * t2978 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - 0.2e1 / 0.3e1 * t193 * t2978 + t783 * t1081 / 0.2e1 - t170 * t3037 / 0.18e2 + t193 * t3037 / 0.24e3 - t197 * t3037 / 0.448e4 + t201 * t3037 / 0.10368e6 - t205 * t3037 / 0.2838528e7 + t209 * t3037 / 0.8945664e8 - t213 * t3037 / 0.31850496e10 + t217 * t3037 / 0.1263403008e12;
  t3056 = my_piecewise3(t36, 0, t3036);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3003 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1756 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.16e2 * t2291 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.32e2 * t2299 - 0.3e1 / 0.32e2 * t2302 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.16e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1285 - t1295;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1278, t1279, t1281, t1282, t1284, t1285, t1287;
  double t1290, t1291, t1292, t1294, t1295, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1331, t1334, t1339, t1343, t1346, t1351, t1356, t1361;
  double t1364, t1367, t1372, t1377, t1380, t1382, t1385, t1388;
  double t1390, t1391, t1392, t1393, t1397, t1401, t1403, t1406;
  double t1412, t1413, t1417, t1418, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1542, t1545;
  double t1550, t1555, t1560, t1565, t1570, t1573, t1576, t1580;
  double t1583, t1588, t1590, t1593, t1596, t1598, t1599, t1600;
  double t1601, t1605, t1609, t1611, t1614, t1620, t1621, t1625;
  double t1626, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1680, t1684, t1685, t1695, t1696, t1707, t1710, t1714;
  double t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30, t1737;
  double t1749, t1750, t1751, t1753, t1756, t1759, t1760, t1762;
  double t1763, t1764, t1766, t1768, t1770, t1771, t1773, t1777;
  double t1787, t1788, t1790, t1793, t1796, t1797, t1799, t1802;
  double t1805, t1807, t1809, t1810, t1811, t1816, t1821, t1826;
  double t1831, t1836, t1841, t1846, t1851, t1866, t1873, t1875;
  double t1878, t1881, t1882, t1883, t1887, t1891, t1895, t1898;
  double t1903, t1908, t1909, t1913, t1914, t1931, t1933, t1946;
  double t1949, t1952, t1974, t1975, t1978, t1981, t1989, t1994;
  double t1997, t2002, t2010, t2013, t2017, t2018, t2020, t2024;
  double t2034, t2035, t2037, t2040, t2043, t2044, t2046, t2049;
  double t2052, t2054, t2056, t2057, t2058, t2063, t2068, t2073;
  double t2078, t2083, t2088, t2093, t2098, t2113, t2120, t2122;
  double t2125, t2128, t2129, t2130, t2134, t2138, t2142, t2145;
  double t2150, t2155, t2156, t2160, t2161, t2178, t2180, t2193;
  double t2196, t2199, t2221, t2222, t2225, t2228, t2236, t2241;
  double t2244, t2249, t2257, t2260, t2264, t2265, t2267, t2269;
  double t2272, t2273, t2274, t2275, t2276, t2277, t2278, t2279;
  double t2280, tv3rho31, t2289, t2291, t2293, t2295, t2297, t2299;
  double t2302, t2305, t2308, t2311, t2313, t2318, t2321, t2326;
  double t2329, t2334, t2337, t2342, t2345, t2350, t2353, t2356;
  double t2359, t2362, t2367, t2370, t2375, t2381, t2383, t2387;
  double t2392, t2394, t2398, t2403, t2408, t2409, t2412, t2413;
  double t2417, t2418, t2435, t2437, t2451, t2460, t2481, t2484;
  double t2490, t2495, t2498, t2501, t2511, t2514, t2518, t2519;
  double t2521, t2529, t2533, t2534, t2536, t2539, t2542, t2545;
  double t2548, t2550, t2555, t2558, t2563, t2566, t2571, t2574;
  double t2579, t2582, t2587, t2590, t2593, t2596, t2599, t2604;
  double t2607, t2612, t2618, t2620, t2624, t2629, t2631, t2635;
  double t2640, t2643, t2646, t2647, t2651, t2652, t2669, t2671;
  double t2685, t2694, t2715, t2718, t2724, t2729, t2732, t2735;
  double t2745, t2748, t2752, t2753, t2755, t2766, t2767, t2769;
  double t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32, t2795;
  double t2801, t2805, t2806, t2808, t2809, t2811, t2812, t2814;
  double t2815, t2819, t2820, t2824, t2828, t2832, t2835, t2836;
  double t2840, t2841, t2858, t2867, t2892, t2894, t2901, t2902;
  double t2907, t2912, t2927, t2935, t2946, t2949, t2953, t2954;
  double t2956, t2957, t2958, t2963, t2967, t2968, t2970, t2971;
  double t2973, t2974, t2976, t2977, t2978, t3003, t3015, t3016;
  double t3020, t3024, t3028, t3031, t3032, t3036, t3037, t3054;
  double t3056, t3063, t3064, t3069, t3074, t3089, t3097, t3108;
  double t3111, t3115, t3116, t3118, t3119, t3120, t3121, t3122;
  double t3123, t3124, tv3rho33;

  double t3178, t3181, t3183, t3186, t3189, t3192, t3195, t3198;
  double t3201, t3202, t3211, t3222, t3223, t3229, t3235, t3236;
  double t3238, t3242, t3247, t3248, t3257, t3266, t3269, t3277;
  double t3302, t3304, t3317, t3322, t3330, t3334, t3346, t3370;
  double t3378, t3398, t3409, t3413, t3419, t3422, t3425, t3429;
  double t3432, t3435, t3438, t3442, t3446, t3448, t3451, t3454;
  double t3457, t3460, t3463, t3466, t3467, t3476, t3487, t3488;
  double t3494, t3499, t3503, t3508, t3509, t3526, t3529, t3533;
  double t3554, t3603, t3605, t3614, t3619, t3624, t3629, t3635;
  double t3653, t3661, t3699, t3710, t3714, t3730, t3742, t3755;
  double t3760, t3768, t3775, t3779, t3782, t3785, t3789, t3791;
  double t3794, t3799, t3801, t3808, t3812, t3814, t3819, t3822;
  double t3838, tv4rho40, t3840, t3843, t3847, t3848, t3850, t3851;
  double t3853, t3854, t3856, t3859, t3862, t3865, t3869, t3870;
  double t3872, t3874, t3891, t3893, t3895, t3908, t3912, t3913;
  double t3915, t3918, t3936, t3939, t3945, t3948, t3956, t3958;
  double t3964, t3965, t3967, t3975, t3976, t3977, t3990, t4027;
  double t4057, t4088, t4091, t4111, t4137, t4143, t4146, t4147;
  double t4176, t4185, t4206, t4227, t4234, t4239, t4261, t4263;
  double t4274, t4276, t4288, t4291, t4292, t4300, t4316, t4321;
  double t4325, t4327, t4358, t4392, t4424, t4438, t4446, t4448;
  double t4451, t4455, t4456, t4458, t4461, t4480, t4481, t4483;
  double t4489, t4492, t4498, t4501, t4509, t4511, t4522, t4523;
  double t4524, t4541, t4544, t4573, t4591, t4595, t4602, t4605;
  double t4626, t4651, t4658, t4684, t4687, t4692, t4714, t4716;
  double t4722, t4723, t4725, t4729, t4732, t4735, t4736, t4739;
  double t4742, t4743, t4749, t4763, t4772, t4778, t4779, t4781;
  double t4782, t4783, t4786, t4788, t4791, t4795, t4799, t4801;
  double tv4rho41, t4803, t4825, t4828, t4830, t4836, t4842, t4847;
  double t4850, t4866, t4877, t4887, t4890, t4909, t4915, t4916;
  double t4917, t4934, t4939, t4980, t5022, t5061, t5064, t5081;
  double t5104, t5116, t5128, t5165, t5170, t5171, t5208, t5228;
  double t5233, t5239, t5242, t5245, t5248, t5251, t5255, t5259;
  double t5262, t5265, t5267, t5292, t5313, t5319, t5321, t5327;
  double t5330, t5338, t5360, t5371, t5374, t5376, t5377, t5378;
  double t5395, t5400, t5439, t5481, t5522, t5525, t5560, t5577;
  double t5581, t5623, t5628, t5629, t5637, t5668, t5689, t5694;
  double t5719, t5729, t5732, t5736, t5739, t5742, t5744, t5746;
  double t5749, t5752, t5755, t5783, t5821, t5841, t5858, t5872;
  double t5887, t5903, t5918, tv4rho42, t5920, t5947, t5957, t5971;
  double t5982, t5985, t5995, t5999, t6004, t6005, t6006, t6019;
  double t6051, t6084, t6094, t6097, t6100, t6103, t6106, t6109;
  double t6112, t6115, t6123, t6126, t6171, t6172, t6175, t6208;
  double t6217, t6247, t6259, t6264, t6273, t6276, t6283, t6287;
  double t6293, t6296, t6300, t6303, t6306, t6309, t6312, t6316;
  double t6318, t6348, t6387, t6420, t6445, t6455, t6469, t6492;
  double t6497, t6498, t6499, t6516, t6519, t6534, t6551, t6564;
  double t6599, t6611, t6640, t6652, t6657, t6677, t6691, t6725;
  double t6739, t6748, t6752, t6756, t6765, t6778, tv4rho43, t6818;
  double t6827, t6836, t6841, t6847, t6851, t6856, t6857, t6864;
  double t6867, t6868, t6909, t6911, t6920, t6924, t6966, t7006;
  double t7010, t7015, t7020, t7025, t7029, t7045, t7106, t7115;
  double t7135, t7140, t7141, t7150, t7159, t7162, t7193, t7195;
  double t7204, t7226, t7259, t7290, t7294, t7304, t7318, t7340;
  double tv4rho44;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = t7 * t622 * t257;
  t1278 = t7 * t253 * t632;
  t1279 = t1278 / 0.16e2;
  t1281 = 0.1e1 / t163 / t152;
  t1282 = t1281 * t145;
  t1284 = t7 * t92 * t1282;
  t1285 = 0.5e1 / 0.144e3 * t1284;
  t1287 = t7 * t476 * t165;
  t1290 = t7 * t159 * t488;
  t1291 = t1290 / 0.16e2;
  t1292 = t1281 * t83;
  t1294 = t7 * t21 * t1292;
  t1295 = 0.5e1 / 0.144e3 * t1294;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1331 = t496 * t189;
  t1334 = t57 * t189;
  t1339 = t60 * t189;
  t1343 = 0.1e1 / t59 / t169;
  t1346 = t556 * t189;
  t1351 = t42 * t189;
  t1356 = t45 * t189;
  t1361 = t48 * t189;
  t1364 = t213 * t1331 / 0.49152e6 - t1334 * t528 / 0.229376e7 - t217 * t1331 / 0.1327104e8 + t1339 * t528 / 0.7077888e8 + t1343 * t1331 / 0.4128768e9 - t1346 * t528 / 0.24772608e10 - 0.2e1 / 0.3e1 * t193 * t1331 + t1351 * t528 / 0.2e1 + t197 * t1331 / 0.8e1 - t1356 * t528 / 0.16e2 - t201 * t1331 / 0.8e2 + 0.3e1 / 0.64e3 * t1361 * t528;
  t1367 = t51 * t189;
  t1372 = t54 * t189;
  t1377 = t1 / t22 / t467;
  t1380 = 0.14e2 / 0.243e3 * t27 * t1377 * t31;
  t1382 = t27 * t501 * t184;
  t1385 = t27 * t173 * t511;
  t1388 = t27 * t173 * t523;
  t1390 = t177 * t177;
  t1391 = 0.1e1 / t1390;
  t1392 = t510 * t183;
  t1393 = t1391 * t1392;
  t1397 = t183 * t522;
  t1401 = t14 * t14;
  t1403 = 0.1e1 / t179 / t1401;
  t1406 = t516 * t155;
  t1412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1403 * t1296 - 0.2e1 / 0.3e1 * t1406 * t471 + t180 * t1305 / 0.3e1);
  t1413 = t178 * t1412;
  t1417 = -t1380 - 0.2e1 / 0.27e2 * t1382 - t1385 / 0.9e1 + t1388 / 0.18e2 - t27 * t29 * t1393 / 0.3e1 + t791 * t792 * t1397 / 0.3e1 - t27 * t29 * t1413 / 0.18e2;
  t1418 = my_piecewise3(t36, t1417, 0);
  t1435 = t205 * t1331 / 0.1152e4 - t1367 * t528 / 0.384e4 - t209 * t1331 / 0.21504e5 + t1372 * t528 / 0.86016e5 - t170 * t1418 / 0.18e2 + t193 * t1418 / 0.24e3 - t197 * t1418 / 0.448e4 + t201 * t1418 / 0.10368e6 - t205 * t1418 / 0.2838528e7 + t209 * t1418 / 0.8945664e8 - t213 * t1418 / 0.31850496e10 + t217 * t1418 / 0.1263403008e12;
  t1437 = my_piecewise3(t36, 0, t1417);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1364 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1542 = t640 * t278;
  t1545 = t105 * t278;
  t1550 = t108 * t278;
  t1555 = t111 * t278;
  t1560 = t114 * t278;
  t1565 = t117 * t278;
  t1570 = t120 * t278;
  t1573 = -0.2e1 / 0.3e1 * t282 * t1542 + t1545 * t669 / 0.2e1 + t286 * t1542 / 0.8e1 - t1550 * t669 / 0.16e2 - t290 * t1542 / 0.8e2 + 0.3e1 / 0.64e3 * t1555 * t669 + t294 * t1542 / 0.1152e4 - t1560 * t669 / 0.384e4 - t298 * t1542 / 0.21504e5 + t1565 * t669 / 0.86016e5 + t302 * t1542 / 0.49152e6 - t1570 * t669 / 0.229376e7;
  t1576 = t123 * t278;
  t1580 = 0.1e1 / t122 / t261;
  t1583 = t697 * t278;
  t1588 = 0.14e2 / 0.243e3 * t27 * t1377 * t94;
  t1590 = t27 * t501 * t273;
  t1593 = t27 * t173 * t652;
  t1596 = t27 * t173 * t664;
  t1598 = t266 * t266;
  t1599 = 0.1e1 / t1598;
  t1600 = t651 * t272;
  t1601 = t1599 * t1600;
  t1605 = t272 * t663;
  t1609 = t87 * t87;
  t1611 = 0.1e1 / t268 / t1609;
  t1614 = t657 * t249;
  t1620 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1611 * t1511 - 0.2e1 / 0.3e1 * t1614 * t617 + t269 * t1516 / 0.3e1);
  t1621 = t267 * t1620;
  t1625 = -t1588 - 0.2e1 / 0.27e2 * t1590 - t1593 / 0.9e1 + t1596 / 0.18e2 - t27 * t29 * t1601 / 0.3e1 + t791 * t931 * t1605 / 0.3e1 - t27 * t29 * t1621 / 0.18e2;
  t1626 = my_piecewise3(t99, t1625, 0);
  t1643 = -t306 * t1542 / 0.1327104e8 + t1576 * t669 / 0.7077888e8 + t1580 * t1542 / 0.4128768e9 - t1583 * t669 / 0.24772608e10 - t262 * t1626 / 0.18e2 + t282 * t1626 / 0.24e3 - t286 * t1626 / 0.448e4 + t290 * t1626 / 0.10368e6 - t294 * t1626 / 0.2838528e7 + t298 * t1626 / 0.8945664e8 - t302 * t1626 / 0.31850496e10 + t306 * t1626 / 0.1263403008e12;
  t1645 = my_piecewise3(t99, 0, t1625);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t310 * t703 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1573 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = -0.3e1 / 0.32e2 * t1275 + t1279 - t1285 - 0.3e1 / 0.32e2 * t1287 + t1291 - t1295 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t402 * t632;
  t1759 = t7 * t905 * t257;
  t1760 = t1759 / 0.16e2;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = -t1275 / 0.32e2 + t1278 / 0.24e2 - t1285 - t1287 / 0.32e2 + t1290 / 0.24e2 - t1295 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 + t1756 / 0.48e2 - t1760 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t45 * t810;
  t1816 = t48 * t810;
  t1821 = t51 * t810;
  t1826 = t54 * t810;
  t1831 = t57 * t810;
  t1836 = t60 * t810;
  t1841 = t556 * t810;
  t1846 = t42 * t810;
  t1851 = -t1811 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1816 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1821 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1826 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1831 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1836 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9 - t1841 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10 + t1846 * t189 / 0.3e1 + t783 * t528 / 0.6e1;
  t1866 = t1343 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1391;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1403 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1380 - 0.4e1 / 0.81e2 * t1382 - t1385 / 0.27e2 + t1388 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t117 * t949;
  t2063 = t120 * t949;
  t2068 = t123 * t949;
  t2073 = t697 * t949;
  t2078 = t105 * t949;
  t2083 = t108 * t949;
  t2088 = t111 * t949;
  t2093 = t114 * t949;
  t2098 = t2058 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2063 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2068 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2073 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10 + t2078 * t278 / 0.3e1 + t924 * t669 / 0.6e1 - t2083 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2088 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2093 * t278 / 0.576e4 - t962 * t669 / 0.1152e5;
  t2113 = t1580 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1599;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1611 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1588 - 0.4e1 / 0.81e2 * t1590 - t1593 / 0.27e2 + t1596 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = t1278 / 0.48e2 - t1285 + t1290 / 0.48e2 - t1295 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 + t1756 / 0.24e2 - t1760 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2291 = t7 * t402 * t920;
  t2293 = t164 * t1267;
  t2295 = t7 * t92 * t2293;
  t2297 = t164 * t1153;
  t2299 = t7 * t21 * t2297;
  t2302 = t7 * t1166 * t257;
  t2305 = t7 * t1052 * t165;
  t2308 = t7 * t344 * t779;
  t2311 = t7 * t159 * t1154;
  t2313 = t193 * t1061;
  t2318 = t42 * t1081;
  t2321 = t197 * t1061;
  t2326 = t45 * t1081;
  t2329 = t201 * t1061;
  t2334 = t48 * t1081;
  t2337 = t205 * t1061;
  t2342 = t51 * t1081;
  t2345 = t209 * t1061;
  t2350 = t54 * t1081;
  t2353 = t213 * t1061;
  t2356 = -0.2e1 / 0.3e1 * t2313 * t189 + t783 * t810 / 0.3e1 + t2318 * t189 / 0.6e1 + t2321 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2326 * t189 / 0.48e2 - t2329 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2334 * t189 / 0.64e3 + t2337 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2342 * t189 / 0.1152e5 - t2345 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2350 * t189 / 0.258048e6 + t2353 * t189 / 0.49152e6;
  t2359 = t57 * t1081;
  t2362 = t217 * t1061;
  t2367 = t60 * t1081;
  t2370 = t1343 * t1061;
  t2375 = t556 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1403 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1380 - 0.2e1 / 0.81e2 * t1382 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t833 * t810 / 0.344064e7 - t2359 * t189 / 0.688128e7 - t2362 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2367 * t189 / 0.21233664e9 + t2370 * t189 / 0.4128768e9 - t843 * t810 / 0.37158912e10 - t2375 * t189 / 0.74317824e10 + t217 * t2418 / 0.1263403008e12 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2550 = t282 * t1175;
  t2555 = t105 * t1195;
  t2558 = t286 * t1175;
  t2563 = t108 * t1195;
  t2566 = t290 * t1175;
  t2571 = t111 * t1195;
  t2574 = t294 * t1175;
  t2579 = t114 * t1195;
  t2582 = t298 * t1175;
  t2587 = t117 * t1195;
  t2590 = t302 * t1175;
  t2593 = -0.2e1 / 0.3e1 * t2550 * t278 + t924 * t949 / 0.3e1 + t2555 * t278 / 0.6e1 + t2558 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2563 * t278 / 0.48e2 - t2566 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2571 * t278 / 0.64e3 + t2574 * t278 / 0.1152e4 - t962 * t949 / 0.576e4 - t2579 * t278 / 0.1152e5 - t2582 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2587 * t278 / 0.258048e6 + t2590 * t278 / 0.49152e6;
  t2596 = t120 * t1195;
  t2599 = t306 * t1175;
  t2604 = t123 * t1195;
  t2607 = t1580 * t1175;
  t2612 = t697 * t1195;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1611 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1588 - 0.2e1 / 0.81e2 * t1590 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t972 * t949 / 0.344064e7 - t2596 * t278 / 0.688128e7 - t2599 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2604 * t278 / 0.21233664e9 + t2607 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2612 * t278 / 0.74317824e10 - t262 * t2652 / 0.18e2 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2593 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2291 / 0.16e2 - t2295 / 0.32e2 - t2299 / 0.32e2 - t2302 / 0.32e2 - t2305 / 0.32e2 - t2308 / 0.16e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1599 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1611 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1588 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = -t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 + t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1580 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2978 = t1061 * t356;
  t3003 = t197 * t2978 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t2978 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t2978 / 0.1152e4 - t823 * t1081 / 0.384e4 - t209 * t2978 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t2978 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t2978 / 0.1327104e8 + t838 * t1081 / 0.7077888e8;
  t3015 = t1065 * t350;
  t3016 = t1391 * t3015;
  t3020 = t350 * t1075;
  t3024 = t1403 * t2958;
  t3028 = t180 * t2963;
  t3031 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t3024 - 0.2e1 / 0.3e1 * t797 * t1047 + t3028 / 0.3e1);
  t3032 = t178 * t3031;
  t3036 = -t1380 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t3016 / 0.3e1 + t791 * t792 * t3020 / 0.3e1 - t27 * t29 * t3032 / 0.18e2;
  t3037 = my_piecewise3(t36, t3036, 0);
  t3054 = t1343 * t2978 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - 0.2e1 / 0.3e1 * t193 * t2978 + t783 * t1081 / 0.2e1 - t170 * t3037 / 0.18e2 + t193 * t3037 / 0.24e3 - t197 * t3037 / 0.448e4 + t201 * t3037 / 0.10368e6 - t205 * t3037 / 0.2838528e7 + t209 * t3037 / 0.8945664e8 - t213 * t3037 / 0.31850496e10 + t217 * t3037 / 0.1263403008e12;
  t3056 = my_piecewise3(t36, 0, t3036);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3003 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1756 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.16e2 * t2291 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.32e2 * t2299 - 0.3e1 / 0.32e2 * t2302 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.16e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1285 - t1295;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t3178 = t1 / t22 / t1301;
  t3181 = 0.14e3 / 0.729e3 * t27 * t3178 * t31;
  t3183 = t27 * t1377 * t184;
  t3186 = t27 * t501 * t511;
  t3189 = t27 * t501 * t523;
  t3192 = t27 * t173 * t1393;
  t3195 = t791 * t1875 * t1397;
  t3198 = t27 * t173 * t1413;
  t3201 = 0.1e1 / t1390 / t30;
  t3202 = t510 * t510;
  t3211 = t522 * t522;
  t3222 = 0.1e1 / t179 / t1401 / t14;
  t3223 = t464 * t464;
  t3229 = t471 * t471;
  t3235 = 0.1e1 / t1301 / t11;
  t3236 = t10 * t3235;
  t3238 = -0.24e2 * t1302 + 0.24e2 * t3236;
  t3242 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3222 * t3223 + 0.2e2 / 0.9e1 * t1403 * t464 * t471 - 0.2e1 / 0.3e1 * t516 * t3229 - 0.8e1 / 0.9e1 * t1406 * t1305 + t180 * t3238 / 0.3e1);
  t3247 = t3181 + 0.56e2 / 0.243e3 * t3183 + 0.8e1 / 0.27e2 * t3186 - 0.4e1 / 0.27e2 * t3189 + 0.4e1 / 0.9e1 * t3192 - 0.4e1 / 0.9e1 * t3195 + 0.2e1 / 0.27e2 * t3198 + 0.4e1 / 0.3e1 * t27 * t29 * t3201 * t3202 - 0.2e1 * t791 * t1882 * t510 * t522 + t27 * t29 * t509 * t3211 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t183 * t1412 - t27 * t29 * t178 * t3242 / 0.18e2;
  t3248 = my_piecewise3(t36, t3247, 0);
  t3257 = t213 * t496 * t528 / 0.8192e5 - t1334 * t1418 / 0.172032e7 - t217 * t496 * t528 / 0.221184e7 + t1339 * t1418 / 0.5308416e8 + t1343 * t496 * t528 / 0.688128e8 - t1346 * t1418 / 0.18579456e10 - 0.4e1 * t193 * t496 * t528 + 0.2e1 / 0.3e1 * t1351 * t1418 + 0.3e1 / 0.4e1 * t197 * t496 * t528 - t1356 * t1418 / 0.12e2 - 0.3e1 / 0.4e2 * t201 * t496 * t528 + t1361 * t1418 / 0.16e3 + t205 * t496 * t528 / 0.192e3 - t1367 * t1418 / 0.288e4 - t209 * t496 * t528 / 0.3584e4 + t1372 * t1418 / 0.64512e5 - t170 * t3248 / 0.18e2 + t193 * t3248 / 0.24e3 - t197 * t3248 / 0.448e4 + t201 * t3248 / 0.10368e6;
  t3266 = t496 * t496;
  t3269 = t528 * t528;
  t3277 = 0.1e1 / t59 / t41;
  t3302 = -t205 * t3248 / 0.2838528e7 + t209 * t3248 / 0.8945664e8 - t213 * t3248 / 0.31850496e10 + t217 * t3248 / 0.1263403008e12 - t60 * t3266 / 0.32768e5 - t57 * t3269 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t3266 + t60 * t3269 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3277 * t3266 - t556 * t3269 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t3266 + t42 * t3269 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t3266 - t45 * t3269 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t3266 + 0.3e1 / 0.64e3 * t48 * t3269 - 0.11e2 / 0.1152e4 * t54 * t3266 - t51 * t3269 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t3266 + t54 * t3269 / 0.86016e5;
  t3304 = my_piecewise3(t36, 0, t3247);
  t3317 = t570 * t570;
  t3322 = 0.1e1 / t1451 / t69;
  t3330 = 0.1e1 / t1451 / t567;
  t3334 = t562 * t562;
  t3346 = t72 * t1437;
  t3370 = 0.85e2 / 0.4e1 * t1452 * t3317 * t72 - 0.19e2 / 0.8e1 * t3322 * t3317 * t72 + t228 * t3304 * t72 / 0.2e1 + t3330 * t3317 * t72 / 0.16e2 - 0.12e2 * t3334 * t73 - 0.16e2 * t877 * t1437 - 0.4e1 * t232 * t3304 - t65 * t3304 * t72 - 0.3e1 * t70 * t3334 * t72 - 0.4e1 * t880 * t3346 - 0.75e2 / 0.2e1 * t590 * t3317 * t72 + 0.45e2 * t571 * t1448 - 0.6e1 * t582 * t3334 * t72 - 0.8e1 * t1472 * t3346 - 0.15e2 * t1476 * t570 * t1448 + t590 * t1437 * t868 + 0.3e1 / 0.4e1 * t590 * t3334 * t72 + 0.3e1 / 0.4e1 * t1487 * t562 * t1975;
  t3378 = 0.1e1 / t1451 / t227;
  t3398 = t72 * t569;
  t3409 = 0.12e2 * t562 * t602 + 0.8e1 * t221 * t1499 + 0.2e1 * t63 * t3370 + 0.2e1 * t3304 * t76 + 0.8e1 * t1437 * t237 - t3378 * t3317 * t72 / 0.8e1 - t223 * t3304 + 0.15e2 / 0.4e1 * t1487 * t3317 * t72 - 0.24e2 * t1476 * t3317 * t72 + 0.21e2 * t591 * t1448 - 0.3e1 / 0.2e1 * t569 * t3334 * t72 - 0.2e1 * t853 * t3346 - 0.3e1 / 0.2e1 * t1949 * t1448 + 0.24e2 * t3398 * t3317 - 0.36e2 * t1456 * t570 * t562 + 0.6e1 * t574 * t3334 + 0.8e1 * t574 * t221 * t1437;
  t3413 = my_piecewise3(t35, t3257 + t3302, -0.8e1 / 0.3e1 * t3304 * t79 - 0.32e2 / 0.3e1 * t1437 * t240 - 0.16e2 * t562 * t605 - 0.32e2 / 0.3e1 * t221 * t1502 - 0.8e1 / 0.3e1 * t63 * t3409);
  t3419 = t7 * t1521 * t257;
  t3422 = t7 * t622 * t636;
  t3425 = t7 * t253 * t1534;
  t3429 = t7 * t92 * t1281 * t333;
  t3432 = t7 * t1310 * t165;
  t3435 = t7 * t476 * t492;
  t3438 = t7 * t159 * t1323;
  t3442 = t7 * t21 * t1281 * t244;
  t3446 = 0.14e3 / 0.729e3 * t27 * t3178 * t94;
  t3448 = t27 * t1377 * t273;
  t3451 = t27 * t501 * t652;
  t3454 = t27 * t501 * t664;
  t3457 = t27 * t173 * t1601;
  t3460 = t791 * t2122 * t1605;
  t3463 = t27 * t173 * t1621;
  t3466 = 0.1e1 / t1598 / t93;
  t3467 = t651 * t651;
  t3476 = t663 * t663;
  t3487 = 0.1e1 / t268 / t1609 / t87;
  t3488 = t614 * t614;
  t3494 = t617 * t617;
  t3499 = -t3238;
  t3503 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3487 * t3488 + 0.2e2 / 0.9e1 * t1611 * t614 * t617 - 0.2e1 / 0.3e1 * t657 * t3494 - 0.8e1 / 0.9e1 * t1614 * t1516 + t269 * t3499 / 0.3e1);
  t3508 = t3446 + 0.56e2 / 0.243e3 * t3448 + 0.8e1 / 0.27e2 * t3451 - 0.4e1 / 0.27e2 * t3454 + 0.4e1 / 0.9e1 * t3457 - 0.4e1 / 0.9e1 * t3460 + 0.2e1 / 0.27e2 * t3463 + 0.4e1 / 0.3e1 * t27 * t29 * t3466 * t3467 - 0.2e1 * t791 * t2129 * t651 * t663 + t27 * t29 * t650 * t3476 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t272 * t1620 - t27 * t29 * t267 * t3503 / 0.18e2;
  t3509 = my_piecewise3(t99, t3508, 0);
  t3526 = t640 * t640;
  t3529 = t669 * t669;
  t3533 = 0.1e1 / t122 / t104;
  t3554 = -t262 * t3509 / 0.18e2 + t282 * t3509 / 0.24e3 - t286 * t3509 / 0.448e4 + t290 * t3509 / 0.10368e6 - t294 * t3509 / 0.2838528e7 + t298 * t3509 / 0.8945664e8 - t302 * t3509 / 0.31850496e10 + t306 * t3509 / 0.1263403008e12 + 0.17e2 / 0.1327104e8 * t697 * t3526 + t123 * t3529 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3533 * t3526 - t697 * t3529 / 0.24772608e10 + 0.1e2 / 0.3e1 * t108 * t3526 + t105 * t3529 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t3526 - t108 * t3529 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t3526 + 0.3e1 / 0.64e3 * t111 * t3529 - 0.11e2 / 0.1152e4 * t117 * t3526 - t114 * t3529 / 0.384e4;
  t3603 = 0.13e2 / 0.21504e5 * t120 * t3526 + t117 * t3529 / 0.86016e5 - t123 * t3526 / 0.32768e5 - t120 * t3529 / 0.229376e7 - t1570 * t1626 / 0.172032e7 - t306 * t640 * t669 / 0.221184e7 + t1576 * t1626 / 0.5308416e8 + t1580 * t640 * t669 / 0.688128e8 - t1583 * t1626 / 0.18579456e10 - 0.4e1 * t282 * t640 * t669 + 0.2e1 / 0.3e1 * t1545 * t1626 + 0.3e1 / 0.4e1 * t286 * t640 * t669 - t1550 * t1626 / 0.12e2 - 0.3e1 / 0.4e2 * t290 * t640 * t669 + t1555 * t1626 / 0.16e3 + t294 * t640 * t669 / 0.192e3 - t1560 * t1626 / 0.288e4 - t298 * t640 * t669 / 0.3584e4 + t1565 * t1626 / 0.64512e5 + t302 * t640 * t669 / 0.8192e5;
  t3605 = my_piecewise3(t99, 0, t3508);
  t3614 = t711 * t711;
  t3619 = 0.1e1 / t1659 / t316;
  t3624 = t134 * t1645;
  t3629 = t134 * t710;
  t3635 = t703 * t703;
  t3653 = 0.1e1 / t1659 / t131;
  t3661 = 0.1e1 / t1659 / t708;
  t3699 = 0.85e2 / 0.4e1 * t1660 * t3614 * t134 - 0.19e2 / 0.8e1 * t3653 * t3614 * t134 + t317 * t3605 * t134 / 0.2e1 + t3661 * t3614 * t134 / 0.16e2 - 0.12e2 * t3635 * t135 - 0.16e2 * t1016 * t1645 - 0.4e1 * t321 * t3605 - t127 * t3605 * t134 + 0.45e2 * t712 * t1656 - 0.6e1 * t723 * t3635 * t134 - 0.8e1 * t1680 * t3624 - 0.15e2 * t1684 * t711 * t1656 + t731 * t1645 * t1007 + 0.3e1 / 0.4e1 * t731 * t3635 * t134 + 0.3e1 / 0.4e1 * t1695 * t703 * t2222 - 0.3e1 * t132 * t3635 * t134 - 0.4e1 * t1019 * t3624 - 0.75e2 / 0.2e1 * t731 * t3614 * t134;
  t3710 = 0.15e2 / 0.4e1 * t1695 * t3614 * t134 - t3619 * t3614 * t134 / 0.8e1 - t312 * t3605 - 0.2e1 * t992 * t3624 - 0.3e1 / 0.2e1 * t2196 * t1656 + 0.24e2 * t3629 * t3614 - 0.36e2 * t1664 * t711 * t703 + 0.6e1 * t715 * t3635 + 0.8e1 * t715 * t310 * t1645 - 0.24e2 * t1684 * t3614 * t134 + 0.21e2 * t732 * t1656 - 0.3e1 / 0.2e1 * t710 * t3635 * t134 + 0.2e1 * t126 * t3699 + 0.2e1 * t3605 * t138 + 0.8e1 * t1645 * t326 + 0.12e2 * t703 * t743 + 0.8e1 * t310 * t1707;
  t3714 = my_piecewise3(t98, t3554 + t3603, -0.8e1 / 0.3e1 * t3605 * t141 - 0.32e2 / 0.3e1 * t1645 * t329 - 0.16e2 * t703 * t746 - 0.32e2 / 0.3e1 * t310 * t1710 - 0.8e1 / 0.3e1 * t126 * t3710);
  t3730 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1611 * t3488 - 0.16e2 / 0.9e1 * t658 * t617 + 0.4e1 / 0.3e1 * t269 * t3494 + 0.16e2 / 0.9e1 * t270 * t1516 + 0.4e1 / 0.3e1 * t89 * t3499);
  t3742 = t7 * t253 * t1538;
  t3755 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1403 * t3223 - 0.16e2 / 0.9e1 * t517 * t471 + 0.4e1 / 0.3e1 * t180 * t3229 + 0.16e2 / 0.9e1 * t181 * t1305 + 0.4e1 / 0.3e1 * t18 * t3238);
  t3760 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t3413 - t3419 / 0.8e1 - 0.3e1 / 0.8e1 * t3422 + t3425 / 0.4e1 - 0.5e1 / 0.36e2 * t3429 - t3432 / 0.8e1 - 0.3e1 / 0.8e1 * t3435 + t3438 / 0.4e1 - 0.5e1 / 0.36e2 * t3442 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t3714 - 0.3e1 / 0.32e2 * t7 * t9 * t3730 * t146 - 0.3e1 / 0.8e1 * t7 * t1521 * t334 - 0.9e1 / 0.16e2 * t7 * t622 * t751 - 0.3e1 / 0.8e1 * t3742 - 0.3e1 / 0.32e2 * t7 * t9 * t3755 * t84;
  t3768 = t7 * t159 * t1327;
  t3775 = t7 * t21 * t487 * t609;
  t3779 = t7 * t21 * t164 * t1506;
  t3782 = t7 * t253 * t1282;
  t3785 = 0.1e1 / t163 / t467;
  t3789 = 0.5e1 / 0.54e2 * t7 * t92 * t3785 * t145;
  t3791 = t7 * t476 * t488;
  t3794 = t7 * t159 * t1292;
  t3799 = 0.5e1 / 0.54e2 * t7 * t21 * t3785 * t83;
  t3801 = t7 * t622 * t632;
  t3808 = t7 * t92 * t487 * t750;
  t3812 = t7 * t92 * t164 * t1714;
  t3814 = -0.3e1 / 0.8e1 * t7 * t1310 * t245 - 0.9e1 / 0.16e2 * t7 * t476 * t610 - 0.3e1 / 0.8e1 * t3768 - 0.3e1 / 0.8e1 * t7 * t159 * t1507 + t3775 / 0.8e1 - t3779 / 0.8e1 - 0.5e1 / 0.36e2 * t3782 + t3789 + t3791 / 0.8e1 - 0.5e1 / 0.36e2 * t3794 + t3799 + t3801 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t253 * t1715 + t3808 / 0.8e1 - t3812 / 0.8e1;
  t3819 = 0.5e1 / 0.36e2 * t1284;
  t3822 = 0.5e1 / 0.36e2 * t1294;
  t3838 = -0.9e1 / 0.8e1 * t1321 + t1325 / 0.4e1 - 0.3e1 / 0.8e1 * t1329 - 0.3e1 / 0.8e1 * t1509 - 0.3e1 / 0.8e1 * t1523 - 0.9e1 / 0.8e1 * t1526 - 0.3e1 / 0.4e1 * t1529 - 0.9e1 / 0.8e1 * t1532 + t1536 / 0.4e1 - 0.3e1 / 0.8e1 * t1540 - 0.3e1 / 0.8e1 * t1717;
  tv4rho40 = t11 * (t3760 + t3814) - 0.3e1 / 0.8e1 * t1275 + t1278 / 0.4e1 - t3819 - 0.3e1 / 0.8e1 * t1287 + t1290 / 0.4e1 - t3822 - 0.3e1 / 0.8e1 * t1312 - 0.9e1 / 0.8e1 * t1315 - 0.3e1 / 0.4e1 * t1318 + t3838;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3840 = t7 * t622 * t920;
  t3843 = t7 * t253 * t2054;
  t3847 = t7 * t92 * t487 * t1032;
  t3848 = t3847 / 0.16e2;
  t3850 = t7 * t905 * t632;
  t3851 = t3850 / 0.16e2;
  t3853 = t7 * t402 * t1534;
  t3854 = t3853 / 0.16e2;
  t3856 = t7 * t2035 * t257;
  t3859 = t7 * t905 * t636;
  t3862 = t7 * t476 * t779;
  t3865 = t7 * t159 * t1807;
  t3869 = t7 * t21 * t487 * t893;
  t3870 = t3869 / 0.16e2;
  t3872 = t7 * t1788 * t165;
  t3874 = t528 * t189;
  t3891 = t172 * t1391;
  t3893 = t791 * t3891 * t1883;
  t3895 = t28 * t3201;
  t3908 = t27 * t1377 * t351;
  t3912 = t791 * t500 * t509 * t793;
  t3913 = 0.4e1 / 0.27e2 * t3912;
  t3915 = t791 * t1875 * t1887;
  t3918 = t791 * t1875 * t1891;
  t3936 = t468 * t464;
  t3939 = t155 * t471;
  t3945 = t1302 * t155;
  t3948 = t468 * t471;
  t3956 = 0.8e1 * t800 * t3235;
  t3958 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3222 * t340 * t1296 + 0.2e2 / 0.9e1 * t1403 * t10 * t3936 + 0.1e2 / 0.9e1 * t1895 * t3939 - 0.4e1 / 0.3e1 * t516 * t468 * t155 + 0.4e1 * t1898 * t3945 - 0.4e1 / 0.3e1 * t1898 * t3948 - 0.2e1 / 0.9e1 * t797 * t1305 - 0.4e1 * t180 * t1302 + t3956);
  t3964 = t27 * t501 * t805;
  t3965 = 0.2e1 / 0.27e2 * t3964;
  t3967 = t27 * t173 * t1909;
  t3975 = t791 * t792 * t804 * t522 / 0.3e1 - t27 * t29 * t178 * t3958 / 0.18e2 - t3965 + t3967 / 0.18e2 + 0.4e1 / 0.27e2 * t3186 + t3192 / 0.9e1 - t3195 / 0.9e1 - 0.2e1 / 0.27e2 * t3189 + t3198 / 0.54e2 + t3181 + 0.14e2 / 0.81e2 * t3183;
  t3976 = t3893 / 0.3e1 + 0.4e1 / 0.3e1 * t791 * t3895 * t350 * t1392 - t791 * t1882 * t793 * t522 + t791 * t792 * t350 * t1412 / 0.9e1 + 0.14e2 / 0.243e3 * t3908 + t3913 - 0.2e1 / 0.9e1 * t3915 - t3918 / 0.9e1 - t791 * t1882 * t804 * t510 + t791 * t792 * t1908 * t183 / 0.3e1 + t3975;
  t3977 = my_piecewise3(t36, t3976, 0);
  t3990 = 0.3e1 / 0.8e1 * t361 * t3874 - 0.3e1 / 0.8e2 * t363 * t3874 + t365 * t3874 / 0.384e3 - t367 * t3874 / 0.7168e4 + t369 * t3874 / 0.16384e6 - t371 * t3874 / 0.442368e7 + t1866 * t3874 / 0.1376256e9 - 0.2e1 * t359 * t3874 - t170 * t3977 / 0.18e2 + t193 * t3977 / 0.24e3 - t197 * t3977 / 0.448e4 + t201 * t3977 / 0.10368e6 - t205 * t3977 / 0.2838528e7 + t209 * t3977 / 0.8945664e8;
  t4027 = -t213 * t3977 / 0.31850496e10 + t217 * t3977 / 0.1263403008e12 + t42 * t1914 * t189 / 0.2e1 - t45 * t1914 * t189 / 0.16e2 + 0.3e1 / 0.64e3 * t48 * t1914 * t189 - t51 * t1914 * t189 / 0.384e4 + t54 * t1914 * t189 / 0.86016e5 - t57 * t1914 * t189 / 0.229376e7 + t60 * t1914 * t189 / 0.7077888e8 - t556 * t1914 * t189 / 0.24772608e10 - t1811 * t528 / 0.16e2 - t813 * t1418 / 0.48e2 + 0.3e1 / 0.64e3 * t1816 * t528 + t818 * t1418 / 0.64e3;
  t4057 = -t1821 * t528 / 0.384e4 - t823 * t1418 / 0.1152e5 + t1826 * t528 / 0.86016e5 + t828 * t1418 / 0.258048e6 - t1831 * t528 / 0.229376e7 - t833 * t1418 / 0.688128e7 + t1836 * t528 / 0.7077888e8 + t838 * t1418 / 0.21233664e9 - t1841 * t528 / 0.24772608e10 - t843 * t1418 / 0.74317824e10 + t1846 * t528 / 0.2e1 + t783 * t1418 / 0.6e1 + 0.9e1 / 0.8e2 * t823 * t1331 - 0.11e2 / 0.1152e4 * t828 * t1331;
  t4088 = 0.13e2 / 0.21504e5 * t833 * t1331 - t838 * t1331 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t843 * t1331 - 0.19e2 / 0.4128768e9 * t3277 * t356 * t1331 + 0.3e1 / 0.8e1 * t821 * t496 - 0.3e1 / 0.8e2 * t826 * t496 + t831 * t496 / 0.384e3 - t836 * t496 / 0.7168e4 + t841 * t496 / 0.16384e6 - t846 * t496 / 0.442368e7 + t1343 * t810 * t496 / 0.1376256e9 - 0.2e1 * t816 * t496 + 0.1e2 / 0.3e1 * t813 * t1331 - 0.7e1 / 0.8e1 * t818 * t1331;
  t4091 = my_piecewise3(t36, 0, t3976);
  t4111 = t72 * t1933;
  t4137 = -0.24e2 * t1477 * t854 + 0.24e2 * t3398 * t374 * t1444 - 0.3e1 / 0.2e1 * t853 * t4111 - 0.18e2 * t1456 * t849 * t570 + 0.6e1 * t574 * t1933 * t221 + 0.6e1 * t574 * t849 * t562 + 0.2e1 * t574 * t374 * t1437 + 0.21e2 / 0.2e1 * t591 * t1952 + 0.15e2 / 0.4e1 * t1488 * t854 - t569 * t1437 * t854 / 0.2e1 - 0.3e1 / 0.2e1 * t1946 * t1952 - 0.3e1 / 0.4e1 * t1949 * t1952;
  t4143 = t569 * t849;
  t4146 = t1452 * t374;
  t4147 = t1444 * t72;
  t4176 = 0.45e2 / 0.2e1 * t4143 * t1975 + 0.85e2 / 0.4e1 * t4146 * t4147 - 0.6e1 * t582 * t1933 * t868 - 0.6e1 * t1978 * t1448 - 0.15e2 / 0.2e1 * t1476 * t849 * t1975 - 0.19e2 / 0.8e1 * t3322 * t374 * t4147 - 0.2e1 * t867 * t3346 + 0.3e1 / 0.4e1 * t590 * t1933 * t868 + 0.3e1 / 0.4e1 * t1989 * t1448 + 0.3e1 / 0.8e1 * t1487 * t849 * t1975 + t874 * t3346 / 0.4e1 + t3330 * t374 * t4147 / 0.16e2;
  t4185 = t868 * t562;
  t4206 = -t70 * t1437 * t854 - 0.3e1 * t2002 * t1952 - 0.3e1 * t880 * t4111 - 0.75e2 / 0.2e1 * t874 * t4147 - 0.15e2 / 0.2e1 * t1981 * t4185 + 0.3e1 / 0.8e1 * t1994 * t4185 + 0.45e2 / 0.2e1 * t1974 * t4185 + t228 * t4091 * t72 / 0.2e1 - 0.4e1 * t1437 * t73 * t374 - 0.12e2 * t1997 * t849 - 0.12e2 * t877 * t1933 - 0.4e1 * t232 * t4091 - t65 * t4091 * t72;
  t4227 = t868 * t374;
  t4234 = -t3378 * t1444 * t854 / 0.8e1 + 0.6e1 * t221 * t2010 + 0.2e1 * t63 * (t4176 + t4206) + 0.6e1 * t849 * t602 + 0.2e1 * t374 * t1499 + 0.2e1 * t1437 * t386 + 0.6e1 * t562 * t886 + 0.2e1 * t4091 * t76 + 0.6e1 * t1933 * t237 + 0.21e2 / 0.2e1 * t590 * t221 * t854 * t562 - 0.3e1 / 0.4e1 * t1452 * t562 * t4227 - 0.18e2 * t1456 * t857 * t562 - t223 * t4091;
  t4239 = my_piecewise3(t35, t3990 + t4027 + t4057 + t4088, -0.8e1 / 0.3e1 * t4091 * t79 - 0.8e1 * t1933 * t240 - 0.8e1 * t849 * t605 - 0.8e1 / 0.3e1 * t374 * t1502 - 0.8e1 / 0.3e1 * t1437 * t389 - 0.8e1 * t562 * t889 - 0.8e1 * t221 * t2013 - 0.8e1 / 0.3e1 * t63 * (t4137 + t4234));
  t4261 = 0.32e2 * t759 * t3235;
  t4263 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1895 * t1296 - 0.16e2 / 0.9e1 * t1898 * t3936 - 0.8e1 / 0.9e1 * t797 * t3939 + 0.8e1 / 0.3e1 * t1903 * t155 - 0.8e1 * t800 * t3945 + 0.8e1 / 0.3e1 * t800 * t3948 + 0.4e1 / 0.9e1 * t348 * t1305 - 0.16e2 * t18 * t1302 + t4261);
  t4274 = -0.3e1 / 0.32e2 * t3840 - 0.3e1 / 0.16e2 * t3843 + t3848 + t3851 + t3854 - 0.3e1 / 0.32e2 * t3856 - 0.3e1 / 0.16e2 * t3859 - 0.3e1 / 0.32e2 * t3862 - 0.3e1 / 0.16e2 * t3865 + t3870 - 0.3e1 / 0.32e2 * t3872 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t4239 - 0.3e1 / 0.32e2 * t7 * t9 * t4263 * t84 - 0.9e1 / 0.32e2 * t7 * t1788 * t245 - 0.9e1 / 0.32e2 * t7 * t764 * t610;
  t4276 = t7 * t344 * t1327;
  t4288 = t7 * t764 * t492;
  t4291 = t7 * t344 * t1323;
  t4292 = t4291 / 0.16e2;
  t4300 = t7 * t402 * t1538;
  t4316 = t7 * t92 * t164 * t2264;
  t4321 = -0.3e1 / 0.32e2 * t4276 - 0.3e1 / 0.32e2 * t7 * t344 * t1507 - 0.3e1 / 0.32e2 * t7 * t1310 * t394 - 0.9e1 / 0.32e2 * t7 * t476 * t894 - 0.3e1 / 0.16e2 * t4288 + t4292 - 0.9e1 / 0.32e2 * t7 * t2035 * t334 - 0.9e1 / 0.32e2 * t7 * t905 * t751 - 0.3e1 / 0.32e2 * t4300 - 0.3e1 / 0.32e2 * t7 * t402 * t1715 - 0.3e1 / 0.32e2 * t7 * t1521 * t452 - 0.9e1 / 0.32e2 * t7 * t622 * t1033 - 0.9e1 / 0.32e2 * t7 * t253 * t2265 - 0.3e1 / 0.32e2 * t4316 - 0.9e1 / 0.32e2 * t7 * t159 * t2018;
  t4325 = t7 * t21 * t164 * t2017;
  t4327 = t669 * t278;
  t4358 = -t425 * t4327 / 0.7168e4 + t427 * t4327 / 0.16384e6 - t429 * t4327 / 0.442368e7 + t2113 * t4327 / 0.1376256e9 - 0.2e1 * t417 * t4327 + 0.3e1 / 0.8e1 * t419 * t4327 - 0.3e1 / 0.8e2 * t421 * t4327 + t423 * t4327 / 0.384e3 + t117 * t2161 * t278 / 0.86016e5 + t2058 * t669 / 0.86016e5 + t967 * t1626 / 0.258048e6 - t120 * t2161 * t278 / 0.229376e7 - t2063 * t669 / 0.229376e7 - t972 * t1626 / 0.688128e7;
  t4392 = t123 * t2161 * t278 / 0.7077888e8 + t2068 * t669 / 0.7077888e8 + t977 * t1626 / 0.21233664e9 - t697 * t2161 * t278 / 0.24772608e10 - t2073 * t669 / 0.24772608e10 - t982 * t1626 / 0.74317824e10 + t105 * t2161 * t278 / 0.2e1 + t2078 * t669 / 0.2e1 + t924 * t1626 / 0.6e1 - t108 * t2161 * t278 / 0.16e2 - t2083 * t669 / 0.16e2 - t952 * t1626 / 0.48e2 + 0.3e1 / 0.64e3 * t111 * t2161 * t278 + 0.3e1 / 0.64e3 * t2088 * t669;
  t4424 = t957 * t1626 / 0.64e3 - t114 * t2161 * t278 / 0.384e4 - t2093 * t669 / 0.384e4 - t962 * t1626 / 0.1152e5 + 0.1e2 / 0.3e1 * t952 * t1542 - 0.7e1 / 0.8e1 * t957 * t1542 + 0.9e1 / 0.8e2 * t962 * t1542 - 0.11e2 / 0.1152e4 * t967 * t1542 + 0.13e2 / 0.21504e5 * t972 * t1542 - t977 * t1542 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t982 * t1542 - 0.19e2 / 0.4128768e9 * t3533 * t414 * t1542 - t975 * t640 / 0.7168e4 + t980 * t640 / 0.16384e6;
  t4438 = t28 * t3466;
  t4446 = t172 * t1599;
  t4448 = t791 * t4446 * t2130;
  t4451 = t27 * t1377 * t409;
  t4455 = t791 * t500 * t650 * t932;
  t4456 = 0.4e1 / 0.27e2 * t4455;
  t4458 = t791 * t2122 * t2134;
  t4461 = t791 * t2122 * t2138;
  t4480 = t27 * t501 * t944;
  t4481 = 0.2e1 / 0.27e2 * t4480;
  t4483 = t27 * t173 * t2156;
  t4489 = t468 * t614;
  t4492 = t249 * t617;
  t4498 = t1302 * t249;
  t4501 = t468 * t617;
  t4509 = 0.8e1 * t939 * t3235;
  t4511 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3487 * t398 * t1511 - 0.2e2 / 0.9e1 * t1611 * t10 * t4489 + 0.1e2 / 0.9e1 * t2142 * t4492 + 0.4e1 / 0.3e1 * t657 * t468 * t249 - 0.4e1 * t2145 * t4498 + 0.4e1 / 0.3e1 * t2145 * t4501 - 0.2e1 / 0.9e1 * t936 * t1516 + 0.4e1 * t269 * t1302 - t4509);
  t4522 = t791 * t931 * t408 * t1620 / 0.9e1 - t4481 + t4483 / 0.18e2 - t27 * t29 * t267 * t4511 / 0.18e2 + 0.4e1 / 0.27e2 * t3451 + t3457 / 0.9e1 - t3460 / 0.9e1 + t3446 + 0.14e2 / 0.81e2 * t3448 - 0.2e1 / 0.27e2 * t3454 + t3463 / 0.54e2;
  t4523 = 0.4e1 / 0.3e1 * t791 * t4438 * t408 * t1600 - t791 * t2129 * t932 * t663 + t4448 / 0.3e1 + 0.14e2 / 0.243e3 * t4451 + t4456 - 0.2e1 / 0.9e1 * t4458 - t4461 / 0.9e1 - t791 * t2129 * t943 * t651 + t791 * t931 * t2155 * t272 / 0.3e1 + t791 * t931 * t943 * t663 / 0.3e1 + t4522;
  t4524 = my_piecewise3(t99, t4523, 0);
  t4541 = -t985 * t640 / 0.442368e7 + t1580 * t949 * t640 / 0.1376256e9 - 0.2e1 * t955 * t640 + 0.3e1 / 0.8e1 * t960 * t640 - 0.3e1 / 0.8e2 * t965 * t640 + t970 * t640 / 0.384e3 - t286 * t4524 / 0.448e4 + t290 * t4524 / 0.10368e6 - t294 * t4524 / 0.2838528e7 + t298 * t4524 / 0.8945664e8 - t302 * t4524 / 0.31850496e10 + t306 * t4524 / 0.1263403008e12 - t262 * t4524 / 0.18e2 + t282 * t4524 / 0.24e3;
  t4544 = my_piecewise3(t99, 0, t4523);
  t4573 = t134 * t2180;
  t4591 = 0.21e2 / 0.2e1 * t732 * t2199 + 0.15e2 / 0.4e1 * t1696 * t993 - t710 * t1645 * t993 / 0.2e1 - 0.3e1 / 0.2e1 * t2193 * t2199 - 0.3e1 / 0.4e1 * t2196 * t2199 - t3619 * t1652 * t993 / 0.8e1 - 0.3e1 / 0.2e1 * t992 * t4573 - 0.18e2 * t1664 * t988 * t711 + 0.6e1 * t715 * t2180 * t310 + 0.6e1 * t715 * t988 * t703 + 0.2e1 * t715 * t432 * t1645 + 0.24e2 * t3629 * t432 * t1652;
  t4595 = t134 * t1652;
  t4602 = t710 * t988;
  t4605 = t1660 * t432;
  t4626 = -0.75e2 / 0.2e1 * t1013 * t4595 - 0.3e1 * t2249 * t2199 - 0.3e1 * t1019 * t4573 + 0.45e2 / 0.2e1 * t4602 * t2222 + 0.85e2 / 0.4e1 * t4605 * t4595 - 0.6e1 * t723 * t2180 * t1007 - 0.6e1 * t2225 * t1656 - 0.15e2 / 0.2e1 * t1684 * t988 * t2222 - 0.19e2 / 0.8e1 * t3653 * t432 * t4595 - 0.2e1 * t1006 * t3624 + 0.3e1 / 0.4e1 * t731 * t2180 * t1007 + 0.3e1 / 0.4e1 * t2236 * t1656;
  t4651 = t1007 * t703;
  t4658 = 0.3e1 / 0.8e1 * t1695 * t988 * t2222 + t1013 * t3624 / 0.4e1 + t3661 * t432 * t4595 / 0.16e2 - t132 * t1645 * t993 + t317 * t4544 * t134 / 0.2e1 - 0.4e1 * t1645 * t135 * t432 - 0.12e2 * t2244 * t988 - 0.12e2 * t1016 * t2180 - 0.4e1 * t321 * t4544 - t127 * t4544 * t134 + 0.45e2 / 0.2e1 * t2221 * t4651 - 0.15e2 / 0.2e1 * t2228 * t4651 + 0.3e1 / 0.8e1 * t2241 * t4651;
  t4684 = t1007 * t432;
  t4687 = -0.24e2 * t1685 * t993 - t312 * t4544 + 0.2e1 * t126 * (t4626 + t4658) + 0.2e1 * t1645 * t444 + 0.6e1 * t703 * t1025 + 0.6e1 * t310 * t2257 + 0.2e1 * t4544 * t138 + 0.6e1 * t2180 * t326 + 0.6e1 * t988 * t743 + 0.2e1 * t432 * t1707 - 0.18e2 * t1664 * t996 * t703 + 0.21e2 / 0.2e1 * t731 * t310 * t993 * t703 - 0.3e1 / 0.4e1 * t1660 * t703 * t4684;
  t4692 = my_piecewise3(t98, t4358 + t4392 + t4424 + t4541, -0.8e1 / 0.3e1 * t4544 * t141 - 0.8e1 * t2180 * t329 - 0.8e1 * t988 * t746 - 0.8e1 / 0.3e1 * t432 * t1710 - 0.8e1 / 0.3e1 * t1645 * t447 - 0.8e1 * t703 * t1028 - 0.8e1 * t310 * t2260 - 0.8e1 / 0.3e1 * t126 * (t4591 + t4687));
  t4714 = 0.32e2 * t900 * t3235;
  t4716 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2142 * t1511 + 0.16e2 / 0.9e1 * t2145 * t4489 - 0.8e1 / 0.9e1 * t936 * t4492 - 0.8e1 / 0.3e1 * t2150 * t249 + 0.8e1 * t939 * t4498 - 0.8e1 / 0.3e1 * t939 * t4501 + 0.4e1 / 0.9e1 * t406 * t1516 + 0.16e2 * t89 * t1302 - t4714);
  t4722 = t7 * t764 * t488;
  t4723 = t4722 / 0.16e2;
  t4725 = t7 * t344 * t1292;
  t4729 = t7 * t92 * t1281 * t451;
  t4732 = t7 * t402 * t1282;
  t4735 = t7 * t159 * t1764;
  t4736 = t4735 / 0.16e2;
  t4739 = t7 * t21 * t1281 * t393;
  t4742 = t7 * t253 * t1751;
  t4743 = t4742 / 0.16e2;
  t4749 = -0.3e1 / 0.32e2 * t4325 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t4692 - 0.3e1 / 0.32e2 * t7 * t9 * t4716 * t146 + t4723 - 0.5e1 / 0.144e3 * t4725 - 0.5e1 / 0.144e3 * t4729 - 0.5e1 / 0.144e3 * t4732 + t4736 - 0.5e1 / 0.144e3 * t4739 + t4743 - t3419 / 0.32e2 - 0.3e1 / 0.32e2 * t3422 + t3425 / 0.8e1 - 0.5e1 / 0.48e2 * t3429 - t3432 / 0.32e2;
  t4763 = -0.3e1 / 0.32e2 * t3435 + t3438 / 0.8e1 - 0.5e1 / 0.48e2 * t3442 - 0.3e1 / 0.32e2 * t3742 - 0.3e1 / 0.32e2 * t3768 + t3775 / 0.16e2 - t3779 / 0.32e2 - 0.5e1 / 0.48e2 * t3782 + t3789 + t3791 / 0.16e2 - 0.5e1 / 0.48e2 * t3794 + t3799 + t3801 / 0.16e2 + t3808 / 0.16e2 - t3812 / 0.32e2;
  t4772 = t11 * (t4274 + t4321 + t4749 + t4763) - 0.3e1 / 0.16e2 * t1275 + 0.3e1 / 0.16e2 * t1278 - t3819 - 0.3e1 / 0.16e2 * t1287 + 0.3e1 / 0.16e2 * t1290 - t3822 - t1313 - t1316 - 0.3e1 / 0.8e1 * t1318 - t1322;
  t4778 = 0.3e1 / 0.16e2 * t1749;
  t4779 = 0.3e1 / 0.16e2 * t1325 - 0.3e1 / 0.16e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.8e1 * t1529 - t1533 + 0.3e1 / 0.16e2 * t1536 - 0.3e1 / 0.16e2 * t1540 - t1718 - t4778;
  t4781 = 0.3e1 / 0.16e2 * t1759;
  t4782 = 0.3e1 / 0.16e2 * t1762;
  t4783 = 0.3e1 / 0.16e2 * t1770;
  t4786 = 0.3e1 / 0.16e2 * t1796;
  t4788 = t3120 + t3121 - t4781 - t4782 + t3122 - t4783 + t3123 - 0.9e1 / 0.32e2 * t1790 - 0.9e1 / 0.16e2 * t1793 - t4786 - 0.9e1 / 0.32e2 * t1799;
  t4791 = 0.3e1 / 0.16e2 * t1809;
  t4795 = 0.3e1 / 0.16e2 * t2043;
  t4799 = 0.3e1 / 0.16e2 * t2056;
  t4801 = -0.9e1 / 0.32e2 * t1802 - 0.9e1 / 0.16e2 * t1805 - t4791 - 0.9e1 / 0.32e2 * t2020 - 0.9e1 / 0.32e2 * t2037 - 0.9e1 / 0.16e2 * t2040 - t4795 - 0.9e1 / 0.32e2 * t2046 - 0.9e1 / 0.32e2 * t2049 - 0.9e1 / 0.16e2 * t2052 - t4799 - 0.9e1 / 0.32e2 * t2267;
  tv4rho41 = t4772 + t4779 + t4788 + t4801;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4803 = t189 * t810;
  t4825 = t27 * t501 * t1076;
  t4828 = t27 * t501 * t1066;
  t4830 = t804 * t804;
  t4836 = t27 * t173 * t2413;
  t4842 = t155 * t10 * t468;
  t4847 = t10 * t10;
  t4850 = 0.1e1 / t1301 / t152;
  t4866 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3222 * t1043 * t464 + 0.8e2 / 0.27e2 * t1895 * t4842 + 0.1e2 / 0.27e2 * t2398 * t471 - 0.16e2 / 0.9e1 * t516 * t4847 * t4850 - 0.8e1 / 0.9e1 * t797 * t468 + 0.8e1 / 0.3e1 * t797 * t1303 + 0.1e2 / 0.27e2 * t1403 * t1047 * t464 - 0.4e1 / 0.9e1 * t516 * t2408 * t155 - 0.2e1 / 0.9e1 * t2403 * t471 + t3956);
  t4877 = -0.4e1 / 0.3e1 * t791 * t1882 * t793 * t804 + t3181 - 0.2e1 / 0.81e2 * t4825 + 0.4e1 / 0.81e2 * t4828 + 0.2e1 / 0.9e1 * t27 * t29 * t509 * t4830 + t4836 / 0.27e2 - t27 * t29 * t178 * t4866 / 0.18e2 + 0.28e2 / 0.243e3 * t3908 - 0.8e1 / 0.81e2 * t3964 + t3967 / 0.27e2 + 0.28e2 / 0.243e3 * t3183 + 0.4e1 / 0.81e2 * t3186 - 0.2e1 / 0.81e2 * t3189;
  t4887 = t791 * t3891 * t2383;
  t4890 = t791 * t1875 * t2387;
  t4909 = t791 * t1875 * t2394;
  t4915 = 0.2e1 / 0.9e1 * t791 * t792 * t2412 * t183 + t791 * t792 * t1075 * t522 / 0.9e1 + 0.2e1 / 0.9e1 * t4887 - 0.4e1 / 0.27e2 * t4890 - t791 * t1882 * t1065 * t522 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t350 * t1908 - t791 * t1882 * t1075 * t510 / 0.3e1 + 0.4e1 / 0.3e1 * t791 * t3895 * t1065 * t510 - 0.2e1 / 0.27e2 * t4909 + 0.2e1 / 0.9e1 * t3893 + 0.16e2 / 0.81e2 * t3912 - 0.4e1 / 0.27e2 * t3915 - 0.2e1 / 0.27e2 * t3918;
  t4916 = t4877 + t4915;
  t4917 = my_piecewise3(t36, t4916, 0);
  t4934 = t810 * t810;
  t4939 = -0.8e1 / 0.3e1 * t359 * t4803 + t361 * t4803 / 0.2e1 - t363 * t4803 / 0.2e2 + t365 * t4803 / 0.288e3 - t367 * t4803 / 0.5376e4 + t369 * t4803 / 0.12288e6 - t371 * t4803 / 0.331776e7 + t1866 * t4803 / 0.1032192e9 - t197 * t4917 / 0.448e4 + t201 * t4917 / 0.10368e6 - t205 * t4917 / 0.2838528e7 + t209 * t4917 / 0.8945664e8 - t213 * t4917 / 0.31850496e10 + t217 * t4917 / 0.1263403008e12 - t170 * t4917 / 0.18e2 + t193 * t4917 / 0.24e3 - t57 * t4934 / 0.344064e7 + t60 * t4934 / 0.10616832e9;
  t4980 = -t556 * t4934 / 0.37158912e10 + t42 * t4934 / 0.3e1 - t45 * t4934 / 0.24e2 + t48 * t4934 / 0.32e3 - t51 * t4934 / 0.576e4 + t54 * t4934 / 0.129024e6 - t833 * t1914 / 0.344064e7 - t2359 * t528 / 0.688128e7 - t2362 * t528 / 0.1327104e8 + t838 * t1914 / 0.10616832e9 + t2367 * t528 / 0.21233664e9 + t2370 * t528 / 0.4128768e9 - t843 * t1914 / 0.37158912e10 - t2375 * t528 / 0.74317824e10 - t556 * t2418 * t189 / 0.37158912e10 + t42 * t2418 * t189 / 0.3e1 - t45 * t2418 * t189 / 0.24e2 + t48 * t2418 * t189 / 0.32e3;
  t5022 = -t51 * t2418 * t189 / 0.576e4 + t54 * t2418 * t189 / 0.129024e6 - t57 * t2418 * t189 / 0.344064e7 + t60 * t2418 * t189 / 0.10616832e9 - 0.2e1 / 0.3e1 * t2313 * t528 + t783 * t1914 / 0.3e1 + t2318 * t528 / 0.6e1 + t2321 * t528 / 0.8e1 - t813 * t1914 / 0.24e2 - t2326 * t528 / 0.48e2 - t2329 * t528 / 0.8e2 + t818 * t1914 / 0.32e3 + t2334 * t528 / 0.64e3 + t2337 * t528 / 0.1152e4 - t823 * t1914 / 0.576e4 - t2342 * t528 / 0.1152e5 - t2345 * t528 / 0.21504e5 + t828 * t1914 / 0.129024e6;
  t5061 = t2350 * t528 / 0.258048e6 + t2353 * t528 / 0.49152e6 - t1102 * t496 / 0.21504e5 - t1104 * t496 / 0.32768e5 + t1106 * t496 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1108 * t496 - t1110 * t496 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3277 * t1061 * t496 + t1343 * t1081 * t496 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1084 * t496 - 0.2e1 / 0.3e1 * t1086 * t496 - 0.7e1 / 0.8e1 * t1088 * t496 + t1090 * t496 / 0.8e1 + 0.9e1 / 0.8e2 * t1092 * t496 - t1094 * t496 / 0.8e2 - 0.11e2 / 0.1152e4 * t1096 * t496 + t1098 * t496 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1100 * t496;
  t5064 = my_piecewise3(t36, 0, t4916);
  t5081 = t868 * t849;
  t5104 = t72 * t2437;
  t5116 = -t4146 * t5081 - 0.24e2 * t1456 * t857 * t849 + 0.7e1 / 0.2e1 * t1135 * t1448 + 0.15e2 / 0.4e1 * t2495 * t1975 - t1974 * t4111 - t2451 * t1448 / 0.4e1 - t3378 * t1118 * t1975 / 0.8e1 - 0.6e1 * t1456 * t1118 * t562 + 0.4e1 * t574 * t374 * t1933 - t1946 * t2460 / 0.2e1 - t853 * t5104 - t1949 * t2460 / 0.4e1 + 0.4e1 * t574 * t2437 * t221 + 0.2e1 * t574 * t1113 * t562 - 0.24e2 * t2481 * t1975;
  t5128 = t849 * t849;
  t5165 = t590 * t2437;
  t5170 = 0.3e2 * t1974 * t5081 - 0.1e2 * t1981 * t5081 + t1994 * t5081 / 0.2e1 - 0.2e1 * t880 * t5104 - 0.75e2 / 0.2e1 * t1135 * t1975 + 0.15e2 / 0.2e1 * t569 * t1113 * t1975 + 0.15e2 / 0.2e1 * t1119 * t1448 + 0.85e2 / 0.4e1 * t2451 * t1975 - 0.4e1 * t867 * t4111 - 0.5e1 / 0.2e1 * t2481 * t1448 - 0.19e2 / 0.8e1 * t3322 * t1118 * t1975 - 0.4e1 * t582 * t2437 * t868 - 0.2e1 * t2484 * t1448 - 0.5e1 / 0.2e1 * t1476 * t1113 * t1975 + t5165 * t868 / 0.2e1 + t2490 * t1448 / 0.4e1;
  t5171 = t1487 * t1113;
  t5208 = t5171 * t1975 / 0.8e1 + t874 * t4111 / 0.2e1 + t2495 * t1448 / 0.8e1 + t3330 * t1118 * t1975 / 0.16e2 - 0.2e1 * t2501 * t4111 - t2002 * t2460 - 0.2e1 * t70 * t5128 * t72 + t228 * t5064 * t72 / 0.2e1 - 0.8e1 * t2498 * t1933 - 0.4e1 * t1997 * t1113 - 0.8e1 * t877 * t2437 - 0.4e1 * t232 * t5064 - t65 * t5064 * t72 - 0.4e1 * t582 * t5128 * t72 + t590 * t5128 * t72 / 0.2e1 - 0.8e1 * t5128 * t73;
  t5228 = 0.24e2 * t3398 * t1118 * t570 + 0.7e1 / 0.2e1 * t591 * t2460 - 0.6e1 * t1456 * t1113 * t570 + 0.14e2 * t874 * t5081 - t223 * t5064 - t569 * t5128 * t72 + 0.4e1 * t574 * t5128 + 0.2e1 * t63 * (t5170 + t5208) + 0.4e1 * t1933 * t386 + 0.8e1 * t849 * t886 + 0.4e1 * t374 * t2010 + 0.2e1 * t562 * t1146 + 0.4e1 * t221 * t2511 + 0.2e1 * t5064 * t76 + 0.4e1 * t2437 * t237 + 0.2e1 * t1113 * t602;
  t5233 = my_piecewise3(t35, t4939 + t4980 + t5022 + t5061, -0.8e1 / 0.3e1 * t5064 * t79 - 0.16e2 / 0.3e1 * t2437 * t240 - 0.8e1 / 0.3e1 * t1113 * t605 - 0.16e2 / 0.3e1 * t1933 * t389 - 0.32e2 / 0.3e1 * t849 * t889 - 0.16e2 / 0.3e1 * t374 * t2013 - 0.8e1 / 0.3e1 * t562 * t1149 - 0.16e2 / 0.3e1 * t221 * t2514 - 0.8e1 / 0.3e1 * t63 * (t5116 + t5228));
  t5239 = t7 * t905 * t920;
  t5242 = t7 * t402 * t2054;
  t5245 = t7 * t253 * t2293;
  t5248 = t7 * t344 * t1764;
  t5251 = t7 * t402 * t1751;
  t5255 = t7 * t92 * t487 * t1267;
  t5259 = t7 * t21 * t487 * t1153;
  t5262 = t7 * t1166 * t632;
  t5265 = t7 * t1052 * t488;
  t5267 = t278 * t949;
  t5292 = t249 * t10 * t468;
  t5313 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3487 * t1158 * t614 - 0.8e2 / 0.27e2 * t2142 * t5292 + 0.1e2 / 0.27e2 * t2635 * t617 - 0.16e2 / 0.9e1 * t657 * t4847 * t4850 + 0.8e1 / 0.9e1 * t936 * t468 - 0.8e1 / 0.3e1 * t936 * t1303 + 0.1e2 / 0.27e2 * t1611 * t1161 * t614 - 0.4e1 / 0.9e1 * t657 * t2529 * t249 - 0.2e1 / 0.9e1 * t2640 * t617 - t4509);
  t5319 = t27 * t173 * t2647;
  t5321 = t943 * t943;
  t5327 = t27 * t501 * t1190;
  t5330 = t27 * t501 * t1180;
  t5338 = -0.4e1 / 0.3e1 * t791 * t2129 * t932 * t943 + t3446 - t27 * t29 * t267 * t5313 / 0.18e2 + t5319 / 0.27e2 + 0.2e1 / 0.9e1 * t27 * t29 * t650 * t5321 - 0.2e1 / 0.81e2 * t5327 + 0.4e1 / 0.81e2 * t5330 + 0.28e2 / 0.243e3 * t4451 - 0.8e1 / 0.81e2 * t4480 + t4483 / 0.27e2 + 0.28e2 / 0.243e3 * t3448 + 0.4e1 / 0.81e2 * t3451 - 0.2e1 / 0.81e2 * t3454;
  t5360 = t791 * t2122 * t2631;
  t5371 = t791 * t4446 * t2620;
  t5374 = t791 * t2122 * t2624;
  t5376 = 0.2e1 / 0.9e1 * t4448 + 0.16e2 / 0.81e2 * t4455 - 0.4e1 / 0.27e2 * t4458 - 0.2e1 / 0.27e2 * t4461 + 0.4e1 / 0.3e1 * t791 * t4438 * t1179 * t651 - t791 * t2129 * t1189 * t651 / 0.3e1 - t791 * t2129 * t1179 * t663 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t408 * t2155 - 0.2e1 / 0.27e2 * t5360 + 0.2e1 / 0.9e1 * t791 * t931 * t2646 * t272 + t791 * t931 * t1189 * t663 / 0.9e1 + 0.2e1 / 0.9e1 * t5371 - 0.4e1 / 0.27e2 * t5374;
  t5377 = t5338 + t5376;
  t5378 = my_piecewise3(t99, t5377, 0);
  t5395 = t949 * t949;
  t5400 = -t429 * t5267 / 0.331776e7 + t2113 * t5267 / 0.1032192e9 - 0.8e1 / 0.3e1 * t417 * t5267 + t419 * t5267 / 0.2e1 - t421 * t5267 / 0.2e2 + t423 * t5267 / 0.288e3 - t425 * t5267 / 0.5376e4 + t427 * t5267 / 0.12288e6 - t262 * t5378 / 0.18e2 + t282 * t5378 / 0.24e3 - t286 * t5378 / 0.448e4 + t290 * t5378 / 0.10368e6 - t294 * t5378 / 0.2838528e7 + t298 * t5378 / 0.8945664e8 - t302 * t5378 / 0.31850496e10 + t306 * t5378 / 0.1263403008e12 + t123 * t5395 / 0.10616832e9 - t697 * t5395 / 0.37158912e10;
  t5439 = t105 * t5395 / 0.3e1 - t108 * t5395 / 0.24e2 + t111 * t5395 / 0.32e3 - t114 * t5395 / 0.576e4 + t117 * t5395 / 0.129024e6 - t120 * t5395 / 0.344064e7 - t1216 * t640 / 0.21504e5 - t1218 * t640 / 0.32768e5 + t1220 * t640 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1222 * t640 - t1224 * t640 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3533 * t1175 * t640 + t1580 * t1195 * t640 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1198 * t640 - 0.2e1 / 0.3e1 * t1200 * t640 - 0.7e1 / 0.8e1 * t1202 * t640 + t1204 * t640 / 0.8e1 + 0.9e1 / 0.8e2 * t1206 * t640;
  t5481 = -t1208 * t640 / 0.8e2 - 0.11e2 / 0.1152e4 * t1210 * t640 + t1212 * t640 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1214 * t640 - t120 * t2652 * t278 / 0.344064e7 - t2596 * t669 / 0.688128e7 - t2599 * t669 / 0.1327104e8 + t977 * t2161 / 0.10616832e9 + t123 * t2652 * t278 / 0.10616832e9 + t2604 * t669 / 0.21233664e9 + t2607 * t669 / 0.4128768e9 - t982 * t2161 / 0.37158912e10 - t697 * t2652 * t278 / 0.37158912e10 - t2612 * t669 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2550 * t669 + t924 * t2161 / 0.3e1 + t105 * t2652 * t278 / 0.3e1 + t2555 * t669 / 0.6e1;
  t5522 = t2558 * t669 / 0.8e1 - t952 * t2161 / 0.24e2 - t108 * t2652 * t278 / 0.24e2 - t2563 * t669 / 0.48e2 - t2566 * t669 / 0.8e2 + t957 * t2161 / 0.32e3 + t111 * t2652 * t278 / 0.32e3 + t2571 * t669 / 0.64e3 + t2574 * t669 / 0.1152e4 - t962 * t2161 / 0.576e4 - t114 * t2652 * t278 / 0.576e4 - t2579 * t669 / 0.1152e5 - t2582 * t669 / 0.21504e5 + t967 * t2161 / 0.129024e6 + t117 * t2652 * t278 / 0.129024e6 + t2587 * t669 / 0.258048e6 + t2590 * t669 / 0.49152e6 - t972 * t2161 / 0.344064e7;
  t5525 = my_piecewise3(t99, 0, t5377);
  t5560 = t134 * t2671;
  t5577 = 0.7e1 / 0.2e1 * t1249 * t1656 + 0.15e2 / 0.4e1 * t2729 * t2222 - t2221 * t4573 - t2685 * t1656 / 0.4e1 - t3619 * t1232 * t2222 / 0.8e1 - 0.6e1 * t1664 * t1232 * t703 + 0.4e1 * t715 * t432 * t2180 - t2193 * t2694 / 0.2e1 - t992 * t5560 - t2196 * t2694 / 0.4e1 + 0.4e1 * t715 * t2671 * t310 + 0.2e1 * t715 * t1227 * t703 - 0.24e2 * t2715 * t2222 + 0.24e2 * t3629 * t1232 * t711 + 0.7e1 / 0.2e1 * t732 * t2694;
  t5581 = t1007 * t988;
  t5623 = t731 * t2671;
  t5628 = t1013 * t4573 / 0.2e1 + t2729 * t1656 / 0.8e1 + t3661 * t1232 * t2222 / 0.16e2 - 0.2e1 * t2735 * t4573 - t2249 * t2694 - 0.2e1 * t1019 * t5560 + 0.15e2 / 0.2e1 * t1233 * t1656 + 0.85e2 / 0.4e1 * t2685 * t2222 - 0.4e1 * t1006 * t4573 - 0.5e1 / 0.2e1 * t2715 * t1656 - 0.19e2 / 0.8e1 * t3653 * t1232 * t2222 - 0.4e1 * t723 * t2671 * t1007 - 0.2e1 * t2718 * t1656 - 0.5e1 / 0.2e1 * t1684 * t1227 * t2222 + t5623 * t1007 / 0.2e1 + t2724 * t1656 / 0.4e1;
  t5629 = t1695 * t1227;
  t5637 = t988 * t988;
  t5668 = t5629 * t2222 / 0.8e1 - 0.75e2 / 0.2e1 * t1249 * t2222 + 0.15e2 / 0.2e1 * t710 * t1227 * t2222 - 0.8e1 * t5637 * t135 + 0.3e2 * t2221 * t5581 - 0.1e2 * t2228 * t5581 + t2241 * t5581 / 0.2e1 - 0.4e1 * t321 * t5525 - t127 * t5525 * t134 + t317 * t5525 * t134 / 0.2e1 - 0.8e1 * t2732 * t2180 - 0.4e1 * t2244 * t1227 - 0.8e1 * t1016 * t2671 - 0.2e1 * t132 * t5637 * t134 - 0.4e1 * t723 * t5637 * t134 + t731 * t5637 * t134 / 0.2e1;
  t5689 = -0.6e1 * t1664 * t1227 * t711 + 0.14e2 * t1013 * t5581 - t4605 * t5581 - 0.24e2 * t1664 * t996 * t988 + 0.2e1 * t703 * t1260 + 0.4e1 * t310 * t2745 + 0.2e1 * t126 * (t5628 + t5668) + 0.4e1 * t2180 * t444 + 0.8e1 * t988 * t1025 + 0.4e1 * t432 * t2257 + 0.2e1 * t5525 * t138 + 0.4e1 * t2671 * t326 + 0.2e1 * t1227 * t743 - t312 * t5525 - t710 * t5637 * t134 + 0.4e1 * t715 * t5637;
  t5694 = my_piecewise3(t98, t5400 + t5439 + t5481 + t5522, -0.8e1 / 0.3e1 * t5525 * t141 - 0.16e2 / 0.3e1 * t2671 * t329 - 0.8e1 / 0.3e1 * t1227 * t746 - 0.16e2 / 0.3e1 * t2180 * t447 - 0.32e2 / 0.3e1 * t988 * t1028 - 0.16e2 / 0.3e1 * t432 * t2260 - 0.8e1 / 0.3e1 * t703 * t1263 - 0.16e2 / 0.3e1 * t310 * t2748 - 0.8e1 / 0.3e1 * t126 * (t5577 + t5689));
  t5719 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2635 * t614 + 0.64e2 / 0.27e2 * t936 * t5292 - 0.8e1 / 0.27e2 * t1184 * t617 + 0.32e2 / 0.9e1 * t269 * t4847 * t4850 - 0.16e2 / 0.9e1 * t406 * t468 + 0.16e2 / 0.3e1 * t406 * t1303 - 0.8e1 / 0.27e2 * t2640 * t614 + 0.8e1 / 0.9e1 * t2643 * t249 + 0.4e1 / 0.9e1 * t1186 * t617 - t4714);
  t5729 = t7 * t92 * t164 * t2752;
  t5732 = t7 * t159 * t2297;
  t5736 = t7 * t21 * t164 * t2518;
  t5739 = t7 * t2534 * t257;
  t5742 = t7 * t1166 * t636;
  t5744 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t5233 - t5239 / 0.8e1 - t5242 / 0.8e1 - t5245 / 0.16e2 + t5248 / 0.24e2 + t5251 / 0.24e2 + t5255 / 0.48e2 + t5259 / 0.48e2 + t5262 / 0.48e2 + t5265 / 0.48e2 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t5694 - 0.3e1 / 0.32e2 * t7 * t9 * t5719 * t146 - 0.3e1 / 0.16e2 * t7 * t2534 * t334 - t5729 / 0.16e2 - t5732 / 0.16e2 - t5736 / 0.16e2 - t5739 / 0.16e2 - t5742 / 0.16e2;
  t5746 = t7 * t2767 * t165;
  t5749 = t7 * t1052 * t492;
  t5752 = t7 * t764 * t779;
  t5755 = t7 * t344 * t1807;
  t5783 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t2398 * t464 - 0.64e2 / 0.27e2 * t797 * t4842 - 0.8e1 / 0.27e2 * t1070 * t471 + 0.32e2 / 0.9e1 * t180 * t4847 * t4850 + 0.16e2 / 0.9e1 * t348 * t468 - 0.16e2 / 0.3e1 * t348 * t1303 - 0.8e1 / 0.27e2 * t2403 * t464 + 0.8e1 / 0.9e1 * t2409 * t155 + 0.4e1 / 0.9e1 * t1072 * t471 + t4261);
  t5821 = -t5746 / 0.16e2 - t5749 / 0.16e2 - t5752 / 0.8e1 - t5755 / 0.8e1 - 0.3e1 / 0.32e2 * t7 * t476 * t1154 - 0.3e1 / 0.16e2 * t7 * t159 * t2519 - 0.3e1 / 0.32e2 * t7 * t9 * t5783 * t84 - 0.3e1 / 0.16e2 * t7 * t2767 * t245 - 0.3e1 / 0.32e2 * t7 * t1052 * t610 - 0.3e1 / 0.16e2 * t7 * t1788 * t394 - 0.3e1 / 0.8e1 * t7 * t764 * t894 - 0.3e1 / 0.16e2 * t7 * t344 * t2018 - 0.3e1 / 0.32e2 * t7 * t1166 * t751 - 0.3e1 / 0.16e2 * t7 * t2035 * t452 - 0.3e1 / 0.8e1 * t7 * t905 * t1033 - 0.3e1 / 0.16e2 * t7 * t402 * t2265 - 0.3e1 / 0.32e2 * t7 * t622 * t1268 - 0.3e1 / 0.16e2 * t7 * t253 * t2753;
  t5841 = -t3840 / 0.16e2 - t3843 / 0.8e1 + t3847 / 0.12e2 + t3850 / 0.12e2 + t3853 / 0.12e2 - t3856 / 0.16e2 - t3859 / 0.8e1 - t3862 / 0.16e2 - t3865 / 0.8e1 + t3869 / 0.12e2 - t3872 / 0.16e2 - t4276 / 0.16e2 - t4288 / 0.8e1 + t4291 / 0.12e2 - t4300 / 0.16e2 - t4316 / 0.16e2 - t4325 / 0.16e2 + t4722 / 0.12e2;
  t5858 = -0.5e1 / 0.72e2 * t4725 - 0.5e1 / 0.72e2 * t4729 - 0.5e1 / 0.72e2 * t4732 + t4735 / 0.12e2 - 0.5e1 / 0.72e2 * t4739 + t4742 / 0.12e2 + t3425 / 0.24e2 - 0.5e1 / 0.72e2 * t3429 + t3438 / 0.24e2 - 0.5e1 / 0.72e2 * t3442 + t3775 / 0.48e2 - 0.5e1 / 0.72e2 * t3782 + t3789 + t3791 / 0.48e2 - 0.5e1 / 0.72e2 * t3794 + t3799 + t3801 / 0.48e2 + t3808 / 0.48e2;
  t5872 = t11 * (t5744 + t5821 + t5841 + t5858) - t1275 / 0.16e2 + t1278 / 0.8e1 - t3819 - t1287 / 0.16e2 + t1290 / 0.8e1 - t3822 - t1318 / 0.8e1 + t1325 / 0.8e1 - t1329 / 0.16e2 - t1529 / 0.8e1 + t1536 / 0.8e1 - t1540 / 0.16e2;
  t5887 = -t1749 / 0.4e1 + t1753 / 0.8e1 + t1756 / 0.8e1 - t1759 / 0.4e1 - t1762 / 0.4e1 + t1766 / 0.8e1 - t1770 / 0.4e1 + t1773 / 0.8e1 - 0.3e1 / 0.16e2 * t1790 - 0.3e1 / 0.8e1 * t1793 - t1796 / 0.4e1 - 0.3e1 / 0.16e2 * t1799 - 0.3e1 / 0.16e2 * t1802 - 0.3e1 / 0.8e1 * t1805;
  t5903 = -t1809 / 0.4e1 - 0.3e1 / 0.16e2 * t2020 - 0.3e1 / 0.16e2 * t2037 - 0.3e1 / 0.8e1 * t2040 - t2043 / 0.4e1 - 0.3e1 / 0.16e2 * t2046 - 0.3e1 / 0.16e2 * t2049 - 0.3e1 / 0.8e1 * t2052 - t2056 / 0.4e1 - 0.3e1 / 0.16e2 * t2267 - t2291 / 0.8e1 - t2295 / 0.16e2 - t2299 / 0.16e2 - t2302 / 0.16e2;
  t5918 = -t2305 / 0.16e2 - t2308 / 0.8e1 - 0.3e1 / 0.16e2 * t2311 - 0.3e1 / 0.16e2 * t2521 - 0.3e1 / 0.16e2 * t2536 - 0.3e1 / 0.16e2 * t2539 - 0.3e1 / 0.8e1 * t2542 - 0.3e1 / 0.8e1 * t2545 - 0.3e1 / 0.16e2 * t2548 - 0.3e1 / 0.16e2 * t2755 - 0.3e1 / 0.16e2 * t2769 - 0.3e1 / 0.16e2 * t2772 - 0.3e1 / 0.8e1 * t2775 - 0.3e1 / 0.8e1 * t2778;
  tv4rho42 = t5872 + t5887 + t5903 + t5918;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t5920 = t1195 * t278;
  t5947 = t27 * t173 * t2820;
  t5957 = t791 * t2122 * t2824;
  t5971 = t27 * t173 * t2836;
  t5982 = t1161 * t249;
  t5985 = t468 * t1161;
  t5995 = -0.12e2 * t1302 - 0.24e2 * t3236;
  t5999 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3487 * t2795 * t249 - 0.2e2 / 0.9e1 * t2635 * t469 + 0.1e2 / 0.9e1 * t2142 * t5982 + 0.4e1 / 0.3e1 * t2145 * t5985 - 0.2e1 / 0.3e1 * t936 * t2529 - 0.2e1 / 0.9e1 * t657 * t2801 * t249 + t269 * t5995 / 0.3e1);
  t6004 = t5319 / 0.18e2 + t5947 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t4438 * t2819 * t272 - t791 * t2129 * t1179 * t943 - t5957 / 0.9e1 - t791 * t2129 * t2824 * t272 + t791 * t931 * t943 * t1189 / 0.3e1 + t791 * t931 * t408 * t2646 / 0.3e1 + t5971 / 0.54e2 + t791 * t931 * t2835 * t272 / 0.9e1 - t27 * t29 * t267 * t5999 / 0.18e2;
  t6005 = t3446 + 0.14e2 / 0.243e3 * t3448 + 0.14e2 / 0.81e2 * t4451 + t4456 - t4481 + 0.4e1 / 0.27e2 * t5330 + t5371 / 0.3e1 - 0.2e1 / 0.9e1 * t5374 - 0.2e1 / 0.27e2 * t5327 - t5360 / 0.9e1 + t6004;
  t6006 = my_piecewise3(t99, t6005, 0);
  t6019 = t423 * t5920 / 0.384e3 - t425 * t5920 / 0.7168e4 + t427 * t5920 / 0.16384e6 - t429 * t5920 / 0.442368e7 + t2113 * t5920 / 0.1376256e9 - 0.2e1 * t417 * t5920 + 0.3e1 / 0.8e1 * t419 * t5920 - 0.3e1 / 0.8e2 * t421 * t5920 - t302 * t6006 / 0.31850496e10 + t306 * t6006 / 0.1263403008e12 - t262 * t6006 / 0.18e2 + t282 * t6006 / 0.24e3 - t286 * t6006 / 0.448e4 + t290 * t6006 / 0.10368e6;
  t6051 = -t294 * t6006 / 0.2838528e7 + t298 * t6006 / 0.8945664e8 + t2078 * t1195 / 0.2e1 + t924 * t2652 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t2858 * t278 + 0.3e1 / 0.8e1 * t2558 * t949 - t2083 * t1195 / 0.16e2 - t952 * t2652 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t2858 * t278 - 0.3e1 / 0.8e2 * t2566 * t949 + 0.3e1 / 0.64e3 * t2088 * t1195 + 0.3e1 / 0.64e3 * t957 * t2652 - 0.11e2 / 0.1152e4 * t117 * t2858 * t278 + t2574 * t949 / 0.384e3;
  t6084 = -t2093 * t1195 / 0.384e4 - t962 * t2652 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t2858 * t278 - t2582 * t949 / 0.7168e4 + t2058 * t1195 / 0.86016e5 + t967 * t2652 / 0.86016e5 - t123 * t2858 * t278 / 0.32768e5 + t2590 * t949 / 0.16384e6 - t2063 * t1195 / 0.229376e7 - t972 * t2652 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t2858 * t278 - t2599 * t949 / 0.442368e7 + t2068 * t1195 / 0.7077888e8 + t977 * t2652 / 0.7077888e8;
  t6094 = t105 * t2841;
  t6097 = t108 * t2841;
  t6100 = t111 * t2841;
  t6103 = t114 * t2841;
  t6106 = t117 * t2841;
  t6109 = t120 * t2841;
  t6112 = t123 * t2841;
  t6115 = t697 * t2841;
  t6123 = -0.19e2 / 0.4128768e9 * t3533 * t2858 * t278 + t2607 * t949 / 0.1376256e9 - t2073 * t1195 / 0.24772608e10 - t982 * t2652 / 0.24772608e10 + t6094 * t278 / 0.6e1 - t6097 * t278 / 0.48e2 + t6100 * t278 / 0.64e3 - t6103 * t278 / 0.1152e5 + t6106 * t278 / 0.258048e6 - t6109 * t278 / 0.688128e7 + t6112 * t278 / 0.21233664e9 - t6115 * t278 / 0.74317824e10 + 0.1e2 / 0.3e1 * t108 * t2858 * t278 - 0.2e1 * t2550 * t949;
  t6126 = my_piecewise3(t99, 0, t6005);
  t6171 = -0.24e2 * t2927 * t1007 + 0.21e2 / 0.2e1 * t1249 * t2199 + 0.15e2 / 0.4e1 * t2935 * t1007 - 0.3e1 / 0.2e1 * t4602 * t2694 - 0.3e1 / 0.2e1 * t2221 * t5560 - 0.3e1 / 0.4e1 * t2685 * t2199 - t3619 * t2901 * t1007 / 0.8e1 + 0.24e2 * t3629 * t2901 * t310 - 0.18e2 * t1664 * t1232 * t988 + 0.6e1 * t715 * t988 * t1227 + 0.6e1 * t715 * t432 * t2671 + 0.2e1 * t715 * t2894 * t310;
  t6172 = t134 * t2894;
  t6175 = t2694 * t310;
  t6208 = t731 * t2894;
  t6217 = -0.75e2 / 0.2e1 * t2902 * t1007 + 0.45e2 / 0.2e1 * t1233 * t2199 + 0.85e2 / 0.4e1 * t2907 * t1007 - 0.6e1 * t2225 * t2694 - 0.6e1 * t1006 * t5560 - 0.15e2 / 0.2e1 * t2715 * t2199 - 0.19e2 / 0.8e1 * t3653 * t2901 * t1007 - 0.2e1 * t723 * t2894 * t1007 + t6208 * t1007 / 0.4e1 + 0.3e1 / 0.4e1 * t5623 * t993 + 0.3e1 / 0.4e1 * t2724 * t2199 + 0.3e1 / 0.8e1 * t2729 * t2199;
  t6247 = t3661 * t2901 * t1007 / 0.16e2 - 0.3e1 * t132 * t988 * t2694 - 0.3e1 * t2735 * t5560 - t1019 * t6172 - 0.15e2 / 0.2e1 * t2228 * t6175 + 0.3e1 / 0.8e1 * t5629 * t4684 + 0.45e2 / 0.2e1 * t2221 * t6175 - 0.12e2 * t2732 * t2671 - 0.4e1 * t1016 * t2894 - 0.4e1 * t321 * t6126 - t127 * t6126 * t134 + t317 * t6126 * t134 / 0.2e1 - 0.12e2 * t988 * t135 * t1227;
  t6259 = -t992 * t6172 / 0.2e1 + 0.21e2 / 0.2e1 * t1013 * t6175 - 0.3e1 / 0.4e1 * t4605 * t6175 - 0.18e2 * t1664 * t2912 * t310 - t312 * t6126 + 0.6e1 * t988 * t1260 + 0.6e1 * t432 * t2745 + 0.2e1 * t310 * t2946 + 0.2e1 * t126 * (t6217 + t6247) + 0.2e1 * t6126 * t138 + 0.2e1 * t2894 * t326 + 0.6e1 * t2671 * t444 + 0.6e1 * t1227 * t1025;
  t6264 = my_piecewise3(t98, t6019 + t6051 + t6084 + t6123, -0.8e1 / 0.3e1 * t6126 * t141 - 0.8e1 / 0.3e1 * t2894 * t329 - 0.8e1 * t2671 * t447 - 0.8e1 * t1227 * t1028 - 0.8e1 * t988 * t1263 - 0.8e1 * t432 * t2748 - 0.8e1 / 0.3e1 * t310 * t2949 - 0.8e1 / 0.3e1 * t126 * (t6171 + t6259));
  t6273 = t1047 * t155;
  t6276 = t468 * t1047;
  t6283 = -t5995;
  t6287 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t3024 * t155 - 0.16e2 / 0.9e1 * t1070 * t469 - 0.8e1 / 0.9e1 * t797 * t6273 + 0.8e1 / 0.3e1 * t800 * t6276 + 0.4e1 / 0.3e1 * t348 * t2408 + 0.4e1 / 0.9e1 * t3028 * t155 + 0.4e1 / 0.3e1 * t18 * t6283);
  t6293 = t7 * t1052 * t779;
  t6296 = t7 * t344 * t2297;
  t6300 = t7 * t21 * t164 * t3115;
  t6303 = t7 * t2968 * t165;
  t6306 = t7 * t2806 * t257;
  t6309 = t7 * t1166 * t920;
  t6312 = t7 * t402 * t2293;
  t6316 = t7 * t92 * t164 * t2953;
  t6318 = t1081 * t189;
  t6348 = -0.3e1 / 0.8e2 * t363 * t6318 + t365 * t6318 / 0.384e3 - t367 * t6318 / 0.7168e4 + t369 * t6318 / 0.16384e6 - t371 * t6318 / 0.442368e7 + t1866 * t6318 / 0.1376256e9 - 0.2e1 * t359 * t6318 + 0.3e1 / 0.8e1 * t361 * t6318 - t2362 * t810 / 0.442368e7 + t1836 * t1081 / 0.7077888e8 + t838 * t2418 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3277 * t2978 * t189 + t2370 * t810 / 0.1376256e9 - t1841 * t1081 / 0.24772608e10;
  t6387 = -t843 * t2418 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t2978 * t189 - 0.2e1 * t2313 * t810 + t1846 * t1081 / 0.2e1 + t783 * t2418 / 0.2e1 + t42 * t3037 * t189 / 0.6e1 - t45 * t3037 * t189 / 0.48e2 + t48 * t3037 * t189 / 0.64e3 - t51 * t3037 * t189 / 0.1152e5 + t54 * t3037 * t189 / 0.258048e6 - t57 * t3037 * t189 / 0.688128e7 + t60 * t3037 * t189 / 0.21233664e9 - t556 * t3037 * t189 / 0.74317824e10 - 0.7e1 / 0.8e1 * t48 * t2978 * t189;
  t6420 = 0.3e1 / 0.8e1 * t2321 * t810 - t1811 * t1081 / 0.16e2 - t813 * t2418 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t2978 * t189 - 0.3e1 / 0.8e2 * t2329 * t810 + 0.3e1 / 0.64e3 * t1816 * t1081 + 0.3e1 / 0.64e3 * t818 * t2418 - 0.11e2 / 0.1152e4 * t54 * t2978 * t189 + t2337 * t810 / 0.384e3 - t1821 * t1081 / 0.384e4 - t823 * t2418 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t2978 * t189 - t2345 * t810 / 0.7168e4 + t1826 * t1081 / 0.86016e5;
  t6445 = t27 * t173 * t3016;
  t6455 = t791 * t1875 * t3020;
  t6469 = t27 * t173 * t3032;
  t6492 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3222 * t2958 * t155 + 0.2e2 / 0.9e1 * t2398 * t469 + 0.1e2 / 0.9e1 * t1895 * t6273 - 0.4e1 / 0.3e1 * t1898 * t6276 - 0.2e1 / 0.3e1 * t797 * t2408 - 0.2e1 / 0.9e1 * t516 * t2963 * t155 + t180 * t6283 / 0.3e1);
  t6497 = t4836 / 0.18e2 + t6445 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t3895 * t3015 * t183 - t791 * t1882 * t1065 * t804 - t6455 / 0.9e1 - t791 * t1882 * t3020 * t183 + t791 * t792 * t804 * t1075 / 0.3e1 + t791 * t792 * t350 * t2412 / 0.3e1 + t6469 / 0.54e2 + t791 * t792 * t3031 * t183 / 0.9e1 - t27 * t29 * t178 * t6492 / 0.18e2;
  t6498 = t3181 + 0.14e2 / 0.243e3 * t3183 + 0.14e2 / 0.81e2 * t3908 + t3913 - t3965 + 0.4e1 / 0.27e2 * t4828 + t4887 / 0.3e1 - 0.2e1 / 0.9e1 * t4890 - 0.2e1 / 0.27e2 * t4825 - t4909 / 0.9e1 + t6497;
  t6499 = my_piecewise3(t36, t6498, 0);
  t6516 = t828 * t2418 / 0.86016e5 - t60 * t2978 * t189 / 0.32768e5 + t2353 * t810 / 0.16384e6 - t1831 * t1081 / 0.229376e7 - t833 * t2418 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t2978 * t189 - t170 * t6499 / 0.18e2 + t193 * t6499 / 0.24e3 - t197 * t6499 / 0.448e4 + t201 * t6499 / 0.10368e6 - t205 * t6499 / 0.2838528e7 + t209 * t6499 / 0.8945664e8 - t213 * t6499 / 0.31850496e10 + t217 * t6499 / 0.1263403008e12;
  t6519 = my_piecewise3(t36, 0, t6498);
  t6534 = t2460 * t221;
  t6551 = t72 * t3056;
  t6564 = 0.21e2 / 0.2e1 * t874 * t6534 - 0.3e1 / 0.4e1 * t4146 * t6534 - 0.18e2 * t1456 * t3074 * t221 + 0.6e1 * t574 * t849 * t1113 + 0.6e1 * t574 * t374 * t2437 + 0.2e1 * t574 * t3056 * t221 - t853 * t6551 / 0.2e1 - 0.24e2 * t3089 * t868 + 0.21e2 / 0.2e1 * t1135 * t1952 + 0.15e2 / 0.4e1 * t3097 * t868 - 0.3e1 / 0.2e1 * t4143 * t2460 - 0.3e1 / 0.2e1 * t1974 * t5104;
  t6599 = t590 * t3056;
  t6611 = 0.45e2 / 0.2e1 * t1974 * t6534 - 0.15e2 / 0.2e1 * t1981 * t6534 + 0.3e1 / 0.8e1 * t5171 * t4227 - 0.6e1 * t867 * t5104 - 0.15e2 / 0.2e1 * t2481 * t1952 - 0.19e2 / 0.8e1 * t3322 * t3063 * t868 - 0.2e1 * t582 * t3056 * t868 + t6599 * t868 / 0.4e1 + 0.3e1 / 0.4e1 * t5165 * t854 + 0.3e1 / 0.4e1 * t2490 * t1952 + 0.3e1 / 0.8e1 * t2495 * t1952 + t3330 * t3063 * t868 / 0.16e2;
  t6640 = -0.3e1 * t70 * t849 * t2460 - 0.3e1 * t2501 * t5104 - t880 * t6551 - 0.75e2 / 0.2e1 * t3064 * t868 + 0.45e2 / 0.2e1 * t1119 * t1952 + 0.85e2 / 0.4e1 * t3069 * t868 - 0.6e1 * t1978 * t2460 - 0.12e2 * t2498 * t2437 - 0.4e1 * t877 * t3056 - 0.4e1 * t232 * t6519 - t65 * t6519 * t72 + t228 * t6519 * t72 / 0.2e1 - 0.12e2 * t849 * t73 * t1113;
  t6652 = -0.3e1 / 0.4e1 * t2451 * t1952 - t3378 * t3063 * t868 / 0.8e1 + 0.24e2 * t3398 * t3063 * t221 - 0.18e2 * t1456 * t1118 * t849 - t223 * t6519 + 0.6e1 * t849 * t1146 + 0.6e1 * t374 * t2511 + 0.2e1 * t221 * t3108 + 0.2e1 * t63 * (t6611 + t6640) + 0.2e1 * t6519 * t76 + 0.2e1 * t3056 * t237 + 0.6e1 * t2437 * t386 + 0.6e1 * t1113 * t886;
  t6657 = my_piecewise3(t35, t6348 + t6387 + t6420 + t6516, -0.8e1 / 0.3e1 * t6519 * t79 - 0.8e1 / 0.3e1 * t3056 * t240 - 0.8e1 * t2437 * t389 - 0.8e1 * t1113 * t889 - 0.8e1 * t849 * t1149 - 0.8e1 * t374 * t2514 - 0.8e1 / 0.3e1 * t221 * t3111 - 0.8e1 / 0.3e1 * t63 * (t6564 + t6652));
  t6677 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2828 * t249 + 0.16e2 / 0.9e1 * t1184 * t469 - 0.8e1 / 0.9e1 * t936 * t5982 - 0.8e1 / 0.3e1 * t939 * t5985 + 0.4e1 / 0.3e1 * t406 * t2529 + 0.4e1 / 0.9e1 * t2832 * t249 + 0.4e1 / 0.3e1 * t89 * t5995);
  t6691 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t6264 - 0.3e1 / 0.32e2 * t7 * t9 * t6287 * t84 - 0.3e1 / 0.32e2 * t6293 - 0.3e1 / 0.32e2 * t6296 - t6300 / 0.32e2 - t6303 / 0.32e2 - t6306 / 0.32e2 - 0.3e1 / 0.32e2 * t6309 - 0.3e1 / 0.32e2 * t6312 - t6316 / 0.32e2 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t6657 - 0.3e1 / 0.32e2 * t7 * t9 * t6677 * t146 - 0.3e1 / 0.32e2 * t7 * t2806 * t334 - 0.9e1 / 0.32e2 * t7 * t2534 * t452 - 0.9e1 / 0.32e2 * t7 * t1166 * t1033;
  t6725 = -0.9e1 / 0.32e2 * t7 * t905 * t1268 - 0.9e1 / 0.32e2 * t7 * t402 * t2753 - 0.3e1 / 0.32e2 * t7 * t253 * t2954 - 0.3e1 / 0.32e2 * t7 * t159 * t3116 - 0.3e1 / 0.32e2 * t7 * t2968 * t245 - 0.9e1 / 0.32e2 * t7 * t2767 * t394 - 0.9e1 / 0.32e2 * t7 * t1052 * t894 - 0.9e1 / 0.32e2 * t7 * t764 * t1154 - 0.9e1 / 0.32e2 * t7 * t344 * t2519 - 0.3e1 / 0.16e2 * t5239 - 0.3e1 / 0.16e2 * t5242 - 0.3e1 / 0.32e2 * t5245 + t5248 / 0.8e1 + t5251 / 0.8e1 + t5255 / 0.16e2;
  t6739 = t5259 / 0.16e2 + t5262 / 0.16e2 + t5265 / 0.16e2 - 0.3e1 / 0.32e2 * t5729 - 0.3e1 / 0.32e2 * t5732 - 0.3e1 / 0.32e2 * t5736 - 0.3e1 / 0.32e2 * t5739 - 0.3e1 / 0.32e2 * t5742 - 0.3e1 / 0.32e2 * t5746 - 0.3e1 / 0.32e2 * t5749 - 0.3e1 / 0.16e2 * t5752 - 0.3e1 / 0.16e2 * t5755 + t3848 + t3851 + t3854;
  t6748 = t3870 + t4292 + t4723 - 0.5e1 / 0.48e2 * t4725 - 0.5e1 / 0.48e2 * t4729 - 0.5e1 / 0.48e2 * t4732 + t4736 - 0.5e1 / 0.48e2 * t4739 + t4743 - 0.5e1 / 0.144e3 * t3429 - 0.5e1 / 0.144e3 * t3442 - 0.5e1 / 0.144e3 * t3782 + t3789 - 0.5e1 / 0.144e3 * t3794 + t3799;
  t6752 = -t3119 - t2957 - t2971 - t2974 - t2977 - t2809 - t2812 - t2815 + t11 * (t6691 + t6725 + t6739 + t6748) + t1279 - t3819;
  t6756 = t1291 - t3822 + t1326 + t1537 - t4778 + 0.3e1 / 0.16e2 * t1753 + 0.3e1 / 0.16e2 * t1756 - t4781 - t4782 + 0.3e1 / 0.16e2 * t1766 - t4783;
  t6765 = 0.3e1 / 0.16e2 * t1773 - t4786 - t4791 - t4795 - t4799 - 0.3e1 / 0.8e1 * t2291 - 0.3e1 / 0.16e2 * t2295 - 0.3e1 / 0.16e2 * t2299 - 0.3e1 / 0.16e2 * t2302 - 0.3e1 / 0.16e2 * t2305 - 0.3e1 / 0.8e1 * t2308;
  t6778 = -0.9e1 / 0.32e2 * t2311 - 0.9e1 / 0.32e2 * t2521 - 0.9e1 / 0.32e2 * t2536 - 0.9e1 / 0.32e2 * t2539 - 0.9e1 / 0.16e2 * t2542 - 0.9e1 / 0.16e2 * t2545 - 0.9e1 / 0.32e2 * t2548 - 0.9e1 / 0.32e2 * t2755 - 0.9e1 / 0.32e2 * t2769 - 0.9e1 / 0.32e2 * t2772 - 0.9e1 / 0.16e2 * t2775 - 0.9e1 / 0.16e2 * t2778;
  tv4rho43 = t6752 + t6756 + t6765 + t6778;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t6818 = t1179 * t1179;
  t6827 = t1189 * t1189;
  t6836 = t1158 * t1158;
  t6841 = t1161 * t1161;
  t6847 = -0.24e2 * t1302 - 0.24e2 * t3236;
  t6851 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3487 * t6836 + 0.2e2 / 0.9e1 * t2635 * t1161 - 0.2e1 / 0.3e1 * t657 * t6841 - 0.8e1 / 0.9e1 * t936 * t2801 + t269 * t6847 / 0.3e1);
  t6856 = t3446 + 0.56e2 / 0.243e3 * t4451 + 0.8e1 / 0.27e2 * t5330 - 0.4e1 / 0.27e2 * t5327 + 0.4e1 / 0.9e1 * t5947 - 0.4e1 / 0.9e1 * t5957 + 0.2e1 / 0.27e2 * t5971 + 0.4e1 / 0.3e1 * t27 * t29 * t3466 * t6818 - 0.2e1 * t791 * t2129 * t1179 * t1189 + t27 * t29 * t650 * t6827 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t408 * t2835 - t27 * t29 * t267 * t6851 / 0.18e2;
  t6857 = my_piecewise3(t99, t6856, 0);
  t6864 = t1175 * t1175;
  t6867 = -t6097 * t414 / 0.12e2 + t6100 * t414 / 0.16e3 - t6103 * t414 / 0.288e4 + t6106 * t414 / 0.64512e5 - t6109 * t414 / 0.172032e7 + t6112 * t414 / 0.5308416e8 - t6115 * t414 / 0.18579456e10 - 0.4e1 * t2550 * t1195 + 0.3e1 / 0.4e1 * t2558 * t1195 - 0.3e1 / 0.4e2 * t2566 * t1195 + t2574 * t1195 / 0.192e3 - t2582 * t1195 / 0.3584e4 + t2590 * t1195 / 0.8192e5 - t2599 * t1195 / 0.221184e7 + t2607 * t1195 / 0.688128e8 + 0.2e1 / 0.3e1 * t6094 * t414 + t298 * t6857 / 0.8945664e8 - t302 * t6857 / 0.31850496e10 + t306 * t6857 / 0.1263403008e12 + 0.1e2 / 0.3e1 * t108 * t6864;
  t6868 = t1195 * t1195;
  t6909 = t105 * t6868 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t6864 - t108 * t6868 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t6864 + 0.3e1 / 0.64e3 * t111 * t6868 - 0.11e2 / 0.1152e4 * t117 * t6864 - t114 * t6868 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t6864 + t117 * t6868 / 0.86016e5 - t123 * t6864 / 0.32768e5 - t120 * t6868 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t6864 + t123 * t6868 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3533 * t6864 - t697 * t6868 / 0.24772608e10 - t262 * t6857 / 0.18e2 + t282 * t6857 / 0.24e3 - t286 * t6857 / 0.448e4 + t290 * t6857 / 0.10368e6 - t294 * t6857 / 0.2838528e7;
  t6911 = my_piecewise3(t99, 0, t6856);
  t6920 = t1232 * t1232;
  t6924 = t1227 * t1227;
  t6966 = t3661 * t6920 * t134 / 0.16e2 - 0.12e2 * t6924 * t135 - 0.16e2 * t2732 * t2894 - 0.4e1 * t321 * t6911 - t127 * t6911 * t134 + 0.85e2 / 0.4e1 * t1660 * t6920 * t134 - 0.19e2 / 0.8e1 * t3653 * t6920 * t134 + t317 * t6911 * t134 / 0.2e1 - 0.75e2 / 0.2e1 * t731 * t6920 * t134 + 0.45e2 * t1233 * t2694 - 0.6e1 * t723 * t6924 * t134 - 0.8e1 * t1006 * t6172 - 0.15e2 * t2715 * t2694 + t6208 * t993 + 0.3e1 / 0.4e1 * t731 * t6924 * t134 + 0.3e1 / 0.4e1 * t5629 * t1232 * t134 - 0.3e1 * t132 * t6924 * t134 - 0.4e1 * t2735 * t6172;
  t7006 = 0.2e1 * t126 * t6966 + 0.2e1 * t6911 * t138 + 0.8e1 * t2894 * t444 + 0.12e2 * t1227 * t1260 + 0.8e1 * t432 * t2946 + 0.15e2 / 0.4e1 * t1695 * t6920 * t134 - t3619 * t6920 * t134 / 0.8e1 - t312 * t6911 - 0.24e2 * t1684 * t6920 * t134 + 0.21e2 * t1249 * t2694 - 0.3e1 / 0.2e1 * t710 * t6924 * t134 - 0.2e1 * t2221 * t6172 - 0.3e1 / 0.2e1 * t2685 * t2694 + 0.24e2 * t3629 * t6920 - 0.36e2 * t1664 * t1232 * t1227 + 0.6e1 * t715 * t6924 + 0.8e1 * t715 * t432 * t2894;
  t7010 = my_piecewise3(t98, t6867 + t6909, -0.8e1 / 0.3e1 * t6911 * t141 - 0.32e2 / 0.3e1 * t2894 * t447 - 0.16e2 * t1227 * t1263 - 0.32e2 / 0.3e1 * t432 * t2949 - 0.8e1 / 0.3e1 * t126 * t7006);
  t7015 = t1043 * t1043;
  t7020 = t1047 * t1047;
  t7025 = -t6847;
  t7029 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1403 * t7015 - 0.16e2 / 0.9e1 * t1070 * t1047 + 0.4e1 / 0.3e1 * t180 * t7020 + 0.16e2 / 0.9e1 * t348 * t2963 + 0.4e1 / 0.3e1 * t18 * t7025);
  t7045 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1611 * t6836 - 0.16e2 / 0.9e1 * t1184 * t1161 + 0.4e1 / 0.3e1 * t269 * t6841 + 0.16e2 / 0.9e1 * t406 * t2801 + 0.4e1 / 0.3e1 * t89 * t6847);
  t7106 = t1065 * t1065;
  t7115 = t1075 * t1075;
  t7135 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3222 * t7015 + 0.2e2 / 0.9e1 * t2398 * t1047 - 0.2e1 / 0.3e1 * t516 * t7020 - 0.8e1 / 0.9e1 * t797 * t2963 + t180 * t7025 / 0.3e1);
  t7140 = t3181 + 0.56e2 / 0.243e3 * t3908 + 0.8e1 / 0.27e2 * t4828 - 0.4e1 / 0.27e2 * t4825 + 0.4e1 / 0.9e1 * t6445 - 0.4e1 / 0.9e1 * t6455 + 0.2e1 / 0.27e2 * t6469 + 0.4e1 / 0.3e1 * t27 * t29 * t3201 * t7106 - 0.2e1 * t791 * t1882 * t1065 * t1075 + t27 * t29 * t509 * t7115 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t350 * t3031 - t27 * t29 * t178 * t7135 / 0.18e2;
  t7141 = my_piecewise3(t36, t7140, 0);
  t7150 = -t833 * t3037 / 0.172032e7 - t2362 * t1081 / 0.221184e7 + t838 * t3037 / 0.5308416e8 + t2370 * t1081 / 0.688128e8 - t843 * t3037 / 0.18579456e10 - 0.4e1 * t2313 * t1081 + 0.2e1 / 0.3e1 * t783 * t3037 + 0.3e1 / 0.4e1 * t2321 * t1081 - t813 * t3037 / 0.12e2 - 0.3e1 / 0.4e2 * t2329 * t1081 + t818 * t3037 / 0.16e3 + t2337 * t1081 / 0.192e3 - t823 * t3037 / 0.288e4 - t2345 * t1081 / 0.3584e4 + t828 * t3037 / 0.64512e5 + t2353 * t1081 / 0.8192e5 - t170 * t7141 / 0.18e2 + t193 * t7141 / 0.24e3 - t197 * t7141 / 0.448e4 + t201 * t7141 / 0.10368e6;
  t7159 = t1081 * t1081;
  t7162 = t1061 * t1061;
  t7193 = -t205 * t7141 / 0.2838528e7 + t209 * t7141 / 0.8945664e8 - t213 * t7141 / 0.31850496e10 + t217 * t7141 / 0.1263403008e12 + t42 * t7159 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t7162 - t45 * t7159 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t7162 + 0.3e1 / 0.64e3 * t48 * t7159 - 0.11e2 / 0.1152e4 * t54 * t7162 - t51 * t7159 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t7162 + t54 * t7159 / 0.86016e5 - t60 * t7162 / 0.32768e5 - t57 * t7159 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t7162 + t60 * t7159 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3277 * t7162 - t556 * t7159 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t7162;
  t7195 = my_piecewise3(t36, 0, t7140);
  t7204 = t1118 * t1118;
  t7226 = t1113 * t1113;
  t7259 = 0.85e2 / 0.4e1 * t1452 * t7204 * t72 - 0.19e2 / 0.8e1 * t3322 * t7204 * t72 + t228 * t7195 * t72 / 0.2e1 + t3330 * t7204 * t72 / 0.16e2 - 0.12e2 * t7226 * t73 - 0.16e2 * t2498 * t3056 - 0.4e1 * t232 * t7195 - t65 * t7195 * t72 - 0.75e2 / 0.2e1 * t590 * t7204 * t72 + 0.45e2 * t1119 * t2460 - 0.6e1 * t582 * t7226 * t72 - 0.8e1 * t867 * t6551 - 0.15e2 * t2481 * t2460 + t6599 * t854 + 0.3e1 / 0.4e1 * t590 * t7226 * t72 + 0.3e1 / 0.4e1 * t5171 * t1118 * t72 - 0.3e1 * t70 * t7226 * t72 - 0.4e1 * t2501 * t6551;
  t7290 = 0.15e2 / 0.4e1 * t1487 * t7204 * t72 - t3378 * t7204 * t72 / 0.8e1 - t223 * t7195 + 0.8e1 * t374 * t3108 + 0.2e1 * t63 * t7259 + 0.2e1 * t7195 * t76 + 0.8e1 * t3056 * t386 + 0.12e2 * t1113 * t1146 - 0.3e1 / 0.2e1 * t569 * t7226 * t72 - 0.2e1 * t1974 * t6551 - 0.3e1 / 0.2e1 * t2451 * t2460 + 0.24e2 * t3398 * t7204 - 0.36e2 * t1456 * t1118 * t1113 + 0.6e1 * t574 * t7226 + 0.8e1 * t574 * t374 * t3056 - 0.24e2 * t1476 * t7204 * t72 + 0.21e2 * t1135 * t2460;
  t7294 = my_piecewise3(t35, t7150 + t7193, -0.8e1 / 0.3e1 * t7195 * t79 - 0.32e2 / 0.3e1 * t3056 * t389 - 0.16e2 * t1113 * t1149 - 0.32e2 / 0.3e1 * t374 * t3111 - 0.8e1 / 0.3e1 * t63 * t7290);
  t7304 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t7010 - 0.3e1 / 0.32e2 * t7 * t9 * t7029 * t84 - 0.3e1 / 0.32e2 * t7 * t9 * t7045 * t146 - 0.3e1 / 0.8e1 * t7 * t2806 * t452 - 0.9e1 / 0.16e2 * t7 * t1166 * t1268 - 0.3e1 / 0.8e1 * t7 * t402 * t2954 - 0.3e1 / 0.8e1 * t7 * t2968 * t394 - 0.9e1 / 0.16e2 * t7 * t1052 * t1154 - 0.3e1 / 0.8e1 * t7 * t344 * t3116 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t7294 - 0.3e1 / 0.8e1 * t6293 - 0.3e1 / 0.8e1 * t6296 - t6300 / 0.8e1 - t6303 / 0.8e1 - t6306 / 0.8e1;
  t7318 = -0.3e1 / 0.8e1 * t6309 - 0.3e1 / 0.8e1 * t6312 - t6316 / 0.8e1 + t5248 / 0.4e1 + t5251 / 0.4e1 + t5255 / 0.8e1 + t5259 / 0.8e1 + t5262 / 0.8e1 + t5265 / 0.8e1 - 0.5e1 / 0.36e2 * t4725 - 0.5e1 / 0.36e2 * t4729 - 0.5e1 / 0.36e2 * t4732 - 0.5e1 / 0.36e2 * t4739 + t3789 + t3799;
  t7340 = -0.3e1 / 0.8e1 * t2956 - 0.3e1 / 0.8e1 * t2970 - 0.9e1 / 0.8e1 * t2973 - 0.9e1 / 0.8e1 * t2976 - 0.3e1 / 0.8e1 * t3118 + t1753 / 0.4e1 + t1756 / 0.4e1 + t1766 / 0.4e1 + t1773 / 0.4e1 - t3819 - t3822;
  tv4rho44 = t11 * (t7304 + t7318) - 0.3e1 / 0.4e1 * t2291 - 0.3e1 / 0.8e1 * t2295 - 0.3e1 / 0.8e1 * t2299 - 0.3e1 / 0.8e1 * t2302 - 0.3e1 / 0.8e1 * t2305 - 0.3e1 / 0.4e1 * t2308 - 0.3e1 / 0.8e1 * t2808 - 0.9e1 / 0.8e1 * t2811 - 0.9e1 / 0.8e1 * t2814 + t7340;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif

