/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_xc_th1.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t266, t272, t277;
  double t278, t284, t292, t296, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t266 = 0.1e1 / t23;
  t272 = 0.1e1 / t7 / t164;
  t277 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t266 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t272 * sigma[0] * t64;
  t278 = 0.1e1 / t164;
  t284 = 0.1e1 / t79 / t93;
  t292 = 0.1e1 / t15;
  t296 = 0.1e1 / t7;
  t313 = t69 * t278 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t292 * t98 + 0.55e2 / 0.72e2 * t108 * t296 * t98 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t292 + t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1;
  tv2rho20 = t277 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t266, t272, t277;
  double t278, t284, t292, t296, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  double t386, t392, t397, t403, t414, t419, t421, t422;
  double t425, t428, t447, t468, tv3rho30, t500, tv3rho2sigma0, tv3rhosigma20;
  double t539, t541, tv3sigma30;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t266 = 0.1e1 / t23;
  t272 = 0.1e1 / t7 / t164;
  t277 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t266 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t272 * sigma[0] * t64;
  t278 = 0.1e1 / t164;
  t284 = 0.1e1 / t79 / t93;
  t292 = 0.1e1 / t15;
  t296 = 0.1e1 / t7;
  t313 = t69 * t278 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t292 * t98 + 0.55e2 / 0.72e2 * t108 * t296 * t98 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t292 + t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1;
  tv2rho20 = t277 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

  t386 = 0.1e1 / t22 / t93;
  t392 = 0.1e1 / t7 / t236;
  t397 = 0.1e1 / t236;
  t403 = 0.1e1 / t79 / t164;
  t414 = 0.1e1 / t16;
  t419 = t236 * rho[0];
  t421 = 0.1e1 / t28 / t419;
  t422 = sigma[0] * t421;
  t425 = -0.1232e4 / 0.27e2 * t422 * t64 + 0.1232e4 / 0.27e2 * t422;
  t428 = 0.3e1 * t113 * t170 + 0.55e2 / 0.864e3 * t43 * t284 * t34 * t38 + 0.5e1 / 0.54e2 * t49 * t95 * t34 * t38 + 0.3e1 / 0.32e2 * t55 * t386 * t34 * t38 - 0.1729e4 / 0.1728e4 * t61 * t392 * sigma[0] * t64 - 0.3e1 / 0.4e1 * t69 * t397 * sigma[0] * t64 - 0.935e3 / 0.1728e4 * t76 * t403 * sigma[0] * t64 - 0.35e2 / 0.432e3 * t6 * t152 - 0.4e1 / 0.27e2 * t14 * t157 - 0.3e1 / 0.16e2 * t21 * t266 - 0.5e1 / 0.27e2 * t27 * t414 + 0.3e1 * t186 * t242 + t114 * t425 / 0.2e1;
  t447 = t85 * t166;
  t468 = 0.9e1 / 0.8e1 * t92 * t136 * t170 + 0.5e1 / 0.3e1 * t103 * t292 * t170 + 0.55e2 / 0.24e2 * t108 * t296 * t170 - 0.3e1 / 0.16e2 * t92 * t266 * t98 - 0.5e1 / 0.27e2 * t103 * t414 * t98 - 0.55e2 / 0.432e3 * t108 * t62 * t98 - 0.1e2 / 0.27e2 * t447 * t88 + 0.9e1 / 0.4e1 * t92 * t22 * t242 + t92 * t23 * t425 / 0.2e1 + 0.5e1 / 0.2e1 * t103 * t28 * t242 + t103 * t29 * t425 / 0.2e1 + 0.11e2 / 0.4e1 * t108 * t79 * t242 + t108 * t109 * t425 / 0.2e1;
  tv3rho30 = t428 + t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 0] += tv3rho30;

  t500 = 0.88e2 / 0.9e1 * t238 * t64 - 0.88e2 / 0.9e1 * t238;
  tv3rho2sigma0 = -0.5e1 / 0.288e3 * t43 * t152 * t190 * t38 - t49 * t157 * t190 * t38 / 0.36e2 - t55 * t266 * t190 * t38 / 0.32e2 + 0.91e2 / 0.288e3 * t61 * t272 * t64 + t69 * t278 * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * t64 + 0.5e1 / 0.36e2 * t230 * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t218 + 0.3e1 / 0.2e1 * t92 * t22 * t342 + t92 * t23 * t500 / 0.2e1 + 0.5e1 / 0.9e1 * t103 * t292 * t218 + 0.5e1 / 0.3e1 * t103 * t28 * t342 + t103 * t29 * t500 / 0.2e1 + 0.55e2 / 0.72e2 * t108 * t296 * t218 + 0.11e2 / 0.6e1 * t108 * t79 * t342 + t108 * t109 * t500 / 0.2e1 + t113 * t218 + 0.2e1 * t186 * t342 + t114 * t500 / 0.2e1;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t43 * t80 * t362 * t38 / 0.96e2 - t49 * t86 * t362 * t38 / 0.48e2 - t55 * t136 * t362 * t38 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * sigma[0];
  t541 = 0.1e1 / t34 / t539;
  tv3sigma30 = 0.3e1 / 0.32e2 * t49 * t15 * t541 * t38 + 0.3e1 / 0.32e2 * t55 * t22 * t541 * t38 + 0.3e1 / 0.32e2 * t43 * t7 * t541 * t38 + 0.3e1 / 0.32e2 * t33 * t541 * t38;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t266, t272, t277;
  double t278, t284, t292, t296, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  double t386, t392, t397, t403, t414, t419, t421, t422;
  double t425, t428, t447, t468, tv3rho30, t500, tv3rho2sigma0, tv3rhosigma20;
  double t539, t541, tv3sigma30;

  double t594, t602, t605, t611, t657, tv4rho40, t666, t693;
  double t727, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30, t754, tv4sigma40;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t266 = 0.1e1 / t23;
  t272 = 0.1e1 / t7 / t164;
  t277 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t266 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t272 * sigma[0] * t64;
  t278 = 0.1e1 / t164;
  t284 = 0.1e1 / t79 / t93;
  t292 = 0.1e1 / t15;
  t296 = 0.1e1 / t7;
  t313 = t69 * t278 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t292 * t98 + 0.55e2 / 0.72e2 * t108 * t296 * t98 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t292 + t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1;
  tv2rho20 = t277 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

  t386 = 0.1e1 / t22 / t93;
  t392 = 0.1e1 / t7 / t236;
  t397 = 0.1e1 / t236;
  t403 = 0.1e1 / t79 / t164;
  t414 = 0.1e1 / t16;
  t419 = t236 * rho[0];
  t421 = 0.1e1 / t28 / t419;
  t422 = sigma[0] * t421;
  t425 = -0.1232e4 / 0.27e2 * t422 * t64 + 0.1232e4 / 0.27e2 * t422;
  t428 = 0.3e1 * t113 * t170 + 0.55e2 / 0.864e3 * t43 * t284 * t34 * t38 + 0.5e1 / 0.54e2 * t49 * t95 * t34 * t38 + 0.3e1 / 0.32e2 * t55 * t386 * t34 * t38 - 0.1729e4 / 0.1728e4 * t61 * t392 * sigma[0] * t64 - 0.3e1 / 0.4e1 * t69 * t397 * sigma[0] * t64 - 0.935e3 / 0.1728e4 * t76 * t403 * sigma[0] * t64 - 0.35e2 / 0.432e3 * t6 * t152 - 0.4e1 / 0.27e2 * t14 * t157 - 0.3e1 / 0.16e2 * t21 * t266 - 0.5e1 / 0.27e2 * t27 * t414 + 0.3e1 * t186 * t242 + t114 * t425 / 0.2e1;
  t447 = t85 * t166;
  t468 = 0.9e1 / 0.8e1 * t92 * t136 * t170 + 0.5e1 / 0.3e1 * t103 * t292 * t170 + 0.55e2 / 0.24e2 * t108 * t296 * t170 - 0.3e1 / 0.16e2 * t92 * t266 * t98 - 0.5e1 / 0.27e2 * t103 * t414 * t98 - 0.55e2 / 0.432e3 * t108 * t62 * t98 - 0.1e2 / 0.27e2 * t447 * t88 + 0.9e1 / 0.4e1 * t92 * t22 * t242 + t92 * t23 * t425 / 0.2e1 + 0.5e1 / 0.2e1 * t103 * t28 * t242 + t103 * t29 * t425 / 0.2e1 + 0.11e2 / 0.4e1 * t108 * t79 * t242 + t108 * t109 * t425 / 0.2e1;
  tv3rho30 = t428 + t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 0] += tv3rho30;

  t500 = 0.88e2 / 0.9e1 * t238 * t64 - 0.88e2 / 0.9e1 * t238;
  tv3rho2sigma0 = -0.5e1 / 0.288e3 * t43 * t152 * t190 * t38 - t49 * t157 * t190 * t38 / 0.36e2 - t55 * t266 * t190 * t38 / 0.32e2 + 0.91e2 / 0.288e3 * t61 * t272 * t64 + t69 * t278 * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * t64 + 0.5e1 / 0.36e2 * t230 * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t218 + 0.3e1 / 0.2e1 * t92 * t22 * t342 + t92 * t23 * t500 / 0.2e1 + 0.5e1 / 0.9e1 * t103 * t292 * t218 + 0.5e1 / 0.3e1 * t103 * t28 * t342 + t103 * t29 * t500 / 0.2e1 + 0.55e2 / 0.72e2 * t108 * t296 * t218 + 0.11e2 / 0.6e1 * t108 * t79 * t342 + t108 * t109 * t500 / 0.2e1 + t113 * t218 + 0.2e1 * t186 * t342 + t114 * t500 / 0.2e1;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t43 * t80 * t362 * t38 / 0.96e2 - t49 * t86 * t362 * t38 / 0.48e2 - t55 * t136 * t362 * t38 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * sigma[0];
  t541 = 0.1e1 / t34 / t539;
  tv3sigma30 = 0.3e1 / 0.32e2 * t49 * t15 * t541 * t38 + 0.3e1 / 0.32e2 * t55 * t22 * t541 * t38 + 0.3e1 / 0.32e2 * t43 * t7 * t541 * t38 + 0.3e1 / 0.32e2 * t33 * t541 * t38;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 0] += tv3sigma30;

  t594 = 0.1e1 / t15 / t93;
  t602 = sigma[0] / t28 / t236 / t93;
  t605 = 0.20944e5 / 0.81e2 * t602 * t64 - 0.20944e5 / 0.81e2 * t602;
  t611 = 0.6e1 * t113 * t242 - 0.935e3 / 0.5184e4 * t43 * t403 * t34 * t38 - 0.2e2 / 0.81e2 * t49 * t166 * t34 * t38 - 0.15e2 / 0.64e2 * t55 / t22 / t164 * t34 * t38 + 0.43225e5 / 0.10368e5 * t61 / t7 / t419 * sigma[0] * t64 + 0.3e1 * t69 / t419 * sigma[0] * t64 + 0.21505e5 / 0.10368e5 * t76 / t79 / t236 * sigma[0] * t64 + 0.385e3 / 0.2592e4 * t6 * t284 + 0.2e2 / 0.81e2 * t14 * t95 + 0.9e1 / 0.32e2 * t21 * t386 + 0.2e2 / 0.81e2 * t27 * t594 + 0.4e1 * t186 * t425 + t114 * t605 / 0.2e1 + 0.9e1 / 0.4e1 * t92 * t136 * t242;
  t657 = 0.1e2 / 0.3e1 * t103 * t292 * t242 + 0.55e2 / 0.12e2 * t108 * t296 * t242 + 0.11e3 / 0.81e2 * t85 * t238 * t88 + 0.3e1 * t92 * t22 * t425 + t92 * t23 * t605 / 0.2e1 + 0.1e2 / 0.3e1 * t103 * t28 * t425 + t103 * t29 * t605 / 0.2e1 + 0.11e2 / 0.3e1 * t108 * t79 * t425 + t108 * t109 * t605 / 0.2e1 - 0.55e2 / 0.108e3 * t108 * t62 * t170 + 0.9e1 / 0.32e2 * t92 * t386 * t98 + 0.2e2 / 0.81e2 * t103 * t594 * t98 + 0.385e3 / 0.2592e4 * t108 * t142 * t98 - 0.3e1 / 0.4e1 * t92 * t266 * t170 - 0.2e2 / 0.27e2 * t103 * t414 * t170;
  tv4rho40 = t611 + t657;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 0] += tv4rho40;

  t666 = -0.1232e4 / 0.27e2 * t421 * t64 + 0.1232e4 / 0.27e2 * t421;
  t693 = 0.3e1 * t113 * t342 - 0.1e2 / 0.27e2 * t447 * t64 + 0.3e1 * t186 * t500 + t114 * t666 / 0.2e1 + 0.55e2 / 0.1728e4 * t43 * t284 * t190 * t38 + 0.5e1 / 0.108e3 * t49 * t95 * t190 * t38 + 0.3e1 / 0.64e2 * t55 * t386 * t190 * t38 - 0.3e1 / 0.16e2 * t92 * t266 * t218 - 0.5e1 / 0.27e2 * t103 * t414 * t218 - 0.55e2 / 0.432e3 * t108 * t62 * t218 + 0.11e2 / 0.4e1 * t108 * t79 * t500;
  t727 = t108 * t109 * t666 / 0.2e1 - 0.1729e4 / 0.1728e4 * t61 * t392 * t64 - 0.3e1 / 0.4e1 * t69 * t397 * t64 - 0.935e3 / 0.1728e4 * t76 * t403 * t64 + 0.9e1 / 0.8e1 * t92 * t136 * t342 + 0.9e1 / 0.4e1 * t92 * t22 * t500 + t92 * t23 * t666 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t292 * t342 + 0.5e1 / 0.2e1 * t103 * t28 * t500 + t103 * t29 * t666 / 0.2e1 + 0.55e2 / 0.24e2 * t108 * t296 * t342;
  tv4rho3sigma0 = t693 + t727;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.5e1 / 0.576e3 * t43 * t152 * t362 * t38 + t49 * t157 * t362 * t38 / 0.72e2 + t55 * t266 * t362 * t38 / 0.64e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = t43 * t80 * t541 * t38 / 0.64e2 + t49 * t86 * t541 * t38 / 0.32e2 + 0.3e1 / 0.64e2 * t55 * t136 * t541 * t38;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 0] += tv4rhosigma30;

  t754 = 0.1e1 / t34 / t539 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.64e2 * t49 * t15 * t754 * t38 - 0.15e2 / 0.64e2 * t55 * t22 * t754 * t38 - 0.15e2 / 0.64e2 * t43 * t7 * t754 * t38 - 0.15e2 / 0.64e2 * t33 * t754 * t38;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t171, t173, t174, t175, t177, t178, t179;
  double t182, t183, t184, t186, t187, t190, t191, t192;
  double t194, t196, t198, t199, t201, t205, t209, t213;
  double t214, t217, t220, t223, t226, t231, t236, t241;
  double t244, t248, t251, t256, t261, t266, t269, t270;
  double t272, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t332, t336, t340, t343, t347;
  double t348, t351, t354, t357, t362, t367, t372, t378;
  double t381, t382, t387, t392, t397, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t168 = t118 * t16;
  t171 = t86 * rho[0];
  t173 = 0.1e1 / t23 / t171;
  t174 = sigma[0] * t173;
  t175 = t174 * t91;
  t177 = t44 * t45;
  t178 = t34 * t144;
  t179 = t36 - t178;
  t182 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t179);
  t183 = t177 * t182;
  t184 = t89 * t183;
  t186 = t56 * t45;
  t187 = -t179;
  t190 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t187);
  t191 = t186 * t190;
  t192 = t96 * t191;
  t194 = t124 * t35;
  t196 = 0.1e1 / t126 / t194;
  t198 = 0.8e1 / 0.3e1 * t123 * t196;
  t199 = -0.2e1 / 0.3e1 * t175 + t184 / 0.2e1 + t192 / 0.2e1 + t198;
  t201 = t132 * t23;
  t205 = t135 * t74;
  t209 = t138 * rho[0];
  t213 = 0.1e1 / t9 / t86;
  t214 = t31 * t213;
  t217 = t182 * t46;
  t220 = t190 * t46;
  t223 = -t214 * t47 / 0.3e1 + t33 * t217 / 0.4e1 + t51 * t220 / 0.4e1;
  t226 = t29 * t9;
  t231 = t63 * t16;
  t236 = t67 * t23;
  t241 = t71 * t74;
  t244 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.3e1 / 0.2e1 * t168 * t130 + t133 * t199 + 0.5e1 / 0.3e1 * t201 * t130 + t136 * t199 + 0.11e2 / 0.6e1 * t205 * t130 + t139 * t199 + 0.2e1 * t209 * t130 + t30 * t223 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t60 + t64 * t223 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t60 + t68 * t223 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t60 + t81 * t223 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t60;
  t248 = -t175 / 0.3e1 + t184 / 0.4e1 + t192 / 0.4e1;
  t251 = t84 * t16;
  t256 = t104 * t23;
  t261 = t109 * t74;
  t266 = t113 * rho[0];
  t269 = 0.1e1 / t194;
  t270 = t143 * t269;
  t272 = 0.2e1 * t154 * t270;
  t275 = 0.2e1 * t142 * t178;
  t277 = 0.2e1 * t142 * t270;
  t279 = 0.2e1 * t148 * t178;
  t281 = 0.2e1 * t148 * t270;
  t283 = 0.2e1 * t151 * t178;
  t285 = 0.2e1 * t151 * t270;
  t287 = 0.2e1 * t154 * t178;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = t275 - t277 + t279 - t281 + t283 - t285 + t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t244 + t85 * t248 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t101 + t105 * t248 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t101 + t110 * t248 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t101 + t115 * t248 / 0.2e1 + t266 * t101 + t119 * t199 - t272 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t310 = -t36 - t178;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t177 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t186 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t198;
  t332 = t132 * t25;
  t336 = t135 * t78;
  t340 = t138 * rho[1];
  t343 = t313 * t46;
  t347 = 0.1e1 / t11 / t93;
  t348 = t49 * t347;
  t351 = t326 * t46;
  t354 = t33 * t343 / 0.4e1 - t348 * t57 / 0.3e1 + t51 * t351 / 0.4e1;
  t357 = t29 * t11;
  t362 = t63 * t18;
  t367 = t67 * t25;
  t372 = t71 * t78;
  t378 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t381 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t133 * t330 + 0.5e1 / 0.3e1 * t332 * t130 + t136 * t330 + 0.11e2 / 0.6e1 * t336 * t130 + t139 * t330 + 0.2e1 * t340 * t130 + t30 * t354 / 0.2e1 + 0.2e1 / 0.3e1 * t357 * t60 + t64 * t354 / 0.2e1 + 0.3e1 / 0.4e1 * t362 * t60 + t68 * t354 / 0.2e1 + 0.5e1 / 0.6e1 * t367 * t60 + t81 * t354 / 0.2e1 + 0.11e2 / 0.12e2 * t372 * t60 + t85 * t378 / 0.2e1;
  t382 = t84 * t18;
  t387 = t104 * t25;
  t392 = t109 * t78;
  t397 = t113 * rho[1];
  t400 = t118 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145 - t275 - t277 - t279 - t281 - t283 - t285 - t287;
  tvrho1 = t381 + 0.3e1 / 0.4e1 * t382 * t101 + t105 * t378 / 0.2e1 + 0.5e1 / 0.6e1 * t387 * t101 + t110 * t378 / 0.2e1 + 0.11e2 / 0.12e2 * t392 * t101 + t115 * t378 / 0.2e1 + t397 * t101 + t119 * t330 + 0.3e1 / 0.2e1 * t400 * t130 - t272 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t171, t173, t174, t175, t177, t178, t179;
  double t182, t183, t184, t186, t187, t190, t191, t192;
  double t194, t196, t198, t199, t201, t205, t209, t213;
  double t214, t217, t220, t223, t226, t231, t236, t241;
  double t244, t248, t251, t256, t261, t266, t269, t270;
  double t272, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t332, t336, t340, t343, t347;
  double t348, t351, t354, t357, t362, t367, t372, t378;
  double t381, t382, t387, t392, t397, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t485, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t569, t571, t573, t574, t576, t588, t591;
  double t594, t597, t598, t601, t604, t607, t610, t613;
  double t616, t618, t622, t624, t626, t628, t630, t631;
  double t636, t639, t642, t657, t659, t662, t664, t666;
  double t667, t670, t672, t675, t676, t677, t679, t681;
  double t683, t685, t687, t689, t691, t692, t695, t697;
  double t699, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t757;
  double t762, t765, t780, t797, t818, t829, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t868, t872, t876;
  double t877, t881, t882, t887, t890, t894, t895, t898;
  double t915, t916, t917, t919, t920, t922, t924, t925;
  double t926, t928, t930, t931, t932, t934, t935, t937;
  double t950, t962, t975, t978, t981, t984, t985, t988;
  double t991, t994, t995, t998, t1001, t1004, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1035, t1038, t1042;
  double t1052, t1054, t1057, t1060, t1063, t1066, t1069, t1076;
  double t1078, t1088, t1091, t1092, t1106, t1107, t1110, t1111;
  double t1114, t1115, t1118, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1274, t1276, t1279;
  double t1283, t1301, t1306, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t168 = t118 * t16;
  t171 = t86 * rho[0];
  t173 = 0.1e1 / t23 / t171;
  t174 = sigma[0] * t173;
  t175 = t174 * t91;
  t177 = t44 * t45;
  t178 = t34 * t144;
  t179 = t36 - t178;
  t182 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t179);
  t183 = t177 * t182;
  t184 = t89 * t183;
  t186 = t56 * t45;
  t187 = -t179;
  t190 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t187);
  t191 = t186 * t190;
  t192 = t96 * t191;
  t194 = t124 * t35;
  t196 = 0.1e1 / t126 / t194;
  t198 = 0.8e1 / 0.3e1 * t123 * t196;
  t199 = -0.2e1 / 0.3e1 * t175 + t184 / 0.2e1 + t192 / 0.2e1 + t198;
  t201 = t132 * t23;
  t205 = t135 * t74;
  t209 = t138 * rho[0];
  t213 = 0.1e1 / t9 / t86;
  t214 = t31 * t213;
  t217 = t182 * t46;
  t220 = t190 * t46;
  t223 = -t214 * t47 / 0.3e1 + t33 * t217 / 0.4e1 + t51 * t220 / 0.4e1;
  t226 = t29 * t9;
  t231 = t63 * t16;
  t236 = t67 * t23;
  t241 = t71 * t74;
  t244 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.3e1 / 0.2e1 * t168 * t130 + t133 * t199 + 0.5e1 / 0.3e1 * t201 * t130 + t136 * t199 + 0.11e2 / 0.6e1 * t205 * t130 + t139 * t199 + 0.2e1 * t209 * t130 + t30 * t223 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t60 + t64 * t223 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t60 + t68 * t223 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t60 + t81 * t223 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t60;
  t248 = -t175 / 0.3e1 + t184 / 0.4e1 + t192 / 0.4e1;
  t251 = t84 * t16;
  t256 = t104 * t23;
  t261 = t109 * t74;
  t266 = t113 * rho[0];
  t269 = 0.1e1 / t194;
  t270 = t143 * t269;
  t272 = 0.2e1 * t154 * t270;
  t275 = 0.2e1 * t142 * t178;
  t277 = 0.2e1 * t142 * t270;
  t279 = 0.2e1 * t148 * t178;
  t281 = 0.2e1 * t148 * t270;
  t283 = 0.2e1 * t151 * t178;
  t285 = 0.2e1 * t151 * t270;
  t287 = 0.2e1 * t154 * t178;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = t275 - t277 + t279 - t281 + t283 - t285 + t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t244 + t85 * t248 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t101 + t105 * t248 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t101 + t110 * t248 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t101 + t115 * t248 / 0.2e1 + t266 * t101 + t119 * t199 - t272 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t310 = -t36 - t178;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t177 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t186 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t198;
  t332 = t132 * t25;
  t336 = t135 * t78;
  t340 = t138 * rho[1];
  t343 = t313 * t46;
  t347 = 0.1e1 / t11 / t93;
  t348 = t49 * t347;
  t351 = t326 * t46;
  t354 = t33 * t343 / 0.4e1 - t348 * t57 / 0.3e1 + t51 * t351 / 0.4e1;
  t357 = t29 * t11;
  t362 = t63 * t18;
  t367 = t67 * t25;
  t372 = t71 * t78;
  t378 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t381 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t133 * t330 + 0.5e1 / 0.3e1 * t332 * t130 + t136 * t330 + 0.11e2 / 0.6e1 * t336 * t130 + t139 * t330 + 0.2e1 * t340 * t130 + t30 * t354 / 0.2e1 + 0.2e1 / 0.3e1 * t357 * t60 + t64 * t354 / 0.2e1 + 0.3e1 / 0.4e1 * t362 * t60 + t68 * t354 / 0.2e1 + 0.5e1 / 0.6e1 * t367 * t60 + t81 * t354 / 0.2e1 + 0.11e2 / 0.12e2 * t372 * t60 + t85 * t378 / 0.2e1;
  t382 = t84 * t18;
  t387 = t104 * t25;
  t392 = t109 * t78;
  t397 = t113 * rho[1];
  t400 = t118 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145 - t275 - t277 - t279 - t281 - t283 - t285 - t287;
  tvrho1 = t381 + 0.3e1 / 0.4e1 * t382 * t101 + t105 * t378 / 0.2e1 + 0.5e1 / 0.6e1 * t387 * t101 + t110 * t378 / 0.2e1 + 0.11e2 / 0.12e2 * t392 * t101 + t115 * t378 / 0.2e1 + t397 * t101 + t119 * t330 + 0.3e1 / 0.2e1 * t400 * t130 - t272 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 2] += tvsigma2;

  t485 = t113 * t101;
  t487 = 0.2e1 * t138 * t130;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t174 * t183;
  t510 = t182 * t182;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t179 * t179;
  t519 = t34 * t269;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t177 * t525;
  t527 = t89 * t526;
  t529 = t190 * t190;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t187 * t187;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t186 * t542;
  t544 = t96 * t543;
  t546 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t569 = t124 * t124;
  t571 = 0.1e1 / t126 / t569;
  t573 = 0.88e2 / 0.9e1 * t123 * t571;
  t574 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t573;
  t576 = t485 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.6e1 * t241 * t223 + t85 * t546 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t248 + t105 * t546 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t248 + t110 * t546 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t248 + t115 * t546 / 0.2e1 + 0.2e1 * t266 * t248 + t119 * t574;
  t588 = t29 * t491;
  t591 = t63 * t494;
  t594 = t67 * t497;
  t597 = 0.1e1 / t2;
  t598 = t71 * t597;
  t601 = t84 * t494;
  t604 = t104 * t497;
  t607 = t109 * t597;
  t610 = t118 * t494;
  t613 = t132 * t497;
  t616 = 0.3e1 * t168 * t199 + t133 * t574 + 0.1e2 / 0.3e1 * t201 * t199 + t136 * t574 + 0.11e2 / 0.3e1 * t205 * t199 + t139 * t574 + 0.4e1 * t209 * t199 + 0.2e1 / 0.9e1 * t588 * t60 + 0.3e1 / 0.8e1 * t591 * t60 + 0.5e1 / 0.9e1 * t594 * t60 + 0.55e2 / 0.72e2 * t598 * t60 + 0.3e1 / 0.8e1 * t601 * t101 + 0.5e1 / 0.9e1 * t604 * t101 + 0.55e2 / 0.72e2 * t607 * t101 + 0.3e1 / 0.4e1 * t610 * t130 + 0.1e2 / 0.9e1 * t613 * t130;
  t618 = t135 * t597;
  t622 = 0.2e1 * t142 * t144;
  t624 = 0.2e1 * t148 * t144;
  t626 = 0.2e1 * t151 * t144;
  t628 = 0.2e1 * t154 * t144;
  t630 = 0.1e1 / t9 / t171;
  t631 = t31 * t630;
  t636 = t525 * t46;
  t639 = t542 * t46;
  t642 = 0.7e1 / 0.9e1 * t631 * t47 - 0.2e1 / 0.3e1 * t214 * t217 + t33 * t636 / 0.4e1 + t51 * t639 / 0.4e1;
  t657 = t291 * t270;
  t659 = t150 * t494;
  t662 = t294 * t178;
  t664 = t294 * t270;
  t666 = 0.55e2 / 0.36e2 * t618 * t130 + t622 + t624 + t626 + t628 + t30 * t642 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t223 + t64 * t642 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t223 + t68 * t642 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t223 + t81 * t642 / 0.2e1 - 0.16e2 / 0.3e1 * t657 + 0.3e1 / 0.4e1 * t659 * t145 + 0.6e1 * t662 - 0.6e1 * t664;
  t667 = t153 * t497;
  t670 = t297 * t178;
  t672 = t297 * t270;
  t675 = 0.8e1 * t142 * t519;
  t676 = 0.1e1 / t569;
  t677 = t143 * t676;
  t679 = 0.6e1 * t142 * t677;
  t681 = 0.8e1 * t148 * t519;
  t683 = 0.6e1 * t148 * t677;
  t685 = 0.8e1 * t151 * t519;
  t687 = 0.6e1 * t151 * t677;
  t689 = 0.8e1 * t154 * t519;
  t691 = 0.6e1 * t154 * t677;
  t692 = t141 * t488;
  t695 = t288 * t178;
  t697 = t288 * t270;
  t699 = t147 * t491;
  t702 = t291 * t178;
  t704 = 0.1e2 / 0.9e1 * t667 * t145 + 0.2e2 / 0.3e1 * t670 - 0.2e2 / 0.3e1 * t672 - t675 + t679 - t681 + t683 - t685 + t687 - t689 + t691 + 0.7e1 / 0.36e2 * t692 * t145 + 0.14e2 / 0.3e1 * t695 - 0.14e2 / 0.3e1 * t697 + 0.4e1 / 0.9e1 * t699 * t145 + 0.16e2 / 0.3e1 * t702;
  tv2rho20 = t576 + t616 + t666 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t710 = t174 * t314;
  t712 = t182 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t179 + 0.8e1 / 0.3e1 * t719 * t269);
  t724 = t177 * t723;
  t725 = t89 * t724;
  t727 = t320 * t191;
  t729 = t190 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t187 - 0.8e1 / 0.3e1 * t736 * t269);
  t741 = t186 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t573;
  t757 = t723 * t46;
  t762 = t740 * t46;
  t765 = -t214 * t343 / 0.3e1 + t33 * t757 / 0.4e1 - t348 * t220 / 0.3e1 + t51 * t762 / 0.4e1;
  t780 = 0.5e1 / 0.3e1 * t201 * t330 + 0.5e1 / 0.3e1 * t332 * t199 + t136 * t744 + 0.11e2 / 0.6e1 * t205 * t330 + 0.11e2 / 0.6e1 * t336 * t199 + t139 * t744 + 0.2e1 * t209 * t330 + 0.2e1 * t340 * t199 + t30 * t765 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t354 + 0.2e1 / 0.3e1 * t357 * t223 + t64 * t765 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t354 + 0.3e1 / 0.4e1 * t362 * t223 + t68 * t765 / 0.2e1;
  t797 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t818 = 0.5e1 / 0.6e1 * t236 * t354 + 0.5e1 / 0.6e1 * t367 * t223 + t81 * t765 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t354 + 0.11e2 / 0.12e2 * t372 * t223 + t85 * t797 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t378 + 0.3e1 / 0.4e1 * t382 * t248 + t105 * t797 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t378 + 0.5e1 / 0.6e1 * t387 * t248 + t110 * t797 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t378 + 0.11e2 / 0.12e2 * t392 * t248 + t115 * t797 / 0.2e1;
  t829 = t266 * t378 - t622 - t624 - t626 - t628 + 0.3e1 / 0.2e1 * t400 * t199 + t133 * t744 - 0.8e1 / 0.3e1 * t657 - 0.3e1 * t662 - 0.3e1 * t664 - 0.1e2 / 0.3e1 * t670 - 0.1e2 / 0.3e1 * t672 + t679 + t683 + t687;
  t837 = t404 * t178;
  t839 = t404 * t270;
  t841 = t407 * t178;
  t843 = t407 * t270;
  t845 = t410 * t178;
  t847 = t410 * t270;
  t849 = t413 * t178;
  t851 = t413 * t270;
  t853 = t691 - 0.7e1 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t697 - 0.8e1 / 0.3e1 * t702 + t397 * t248 + t119 * t744 + 0.3e1 / 0.2e1 * t168 * t330 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t818 + t829 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t485 + t487 + t622 + t624 + t626 + t628 + t675 + t679 + t681 + t683 + t685 + t687;
  t868 = t310 * t310;
  t872 = 0.2e1 * t144 + 0.2e1 * t519;
  t876 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t868 + 0.4e1 / 0.3e1 * t42 * t872);
  t877 = t876 * t46;
  t881 = 0.1e1 / t11 / t317;
  t882 = t49 * t881;
  t887 = t323 * t323;
  t890 = -t872;
  t894 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t887 + 0.4e1 / 0.3e1 * t54 * t890);
  t895 = t894 * t46;
  t898 = t33 * t877 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t57 - 0.2e1 / 0.3e1 * t348 * t351 + t51 * t895 / 0.4e1;
  t915 = t313 * t313;
  t916 = t915 * t45;
  t917 = t89 * t916;
  t919 = t177 * t876;
  t920 = t89 * t919;
  t922 = t93 * t93;
  t924 = 0.1e1 / t25 / t922;
  t925 = sigma[2] * t924;
  t926 = t925 * t98;
  t928 = t320 * t327;
  t930 = t326 * t326;
  t931 = t930 * t45;
  t932 = t96 * t931;
  t934 = t186 * t894;
  t935 = t96 * t934;
  t937 = t917 / 0.4e1 + t920 / 0.4e1 + 0.11e2 / 0.9e1 * t926 - 0.4e1 / 0.3e1 * t928 + t932 / 0.4e1 + t935 / 0.4e1;
  t950 = t689 + t691 + t30 * t898 / 0.2e1 + 0.4e1 / 0.3e1 * t357 * t354 + t64 * t898 / 0.2e1 + 0.3e1 / 0.2e1 * t362 * t354 + t68 * t898 / 0.2e1 + 0.5e1 / 0.3e1 * t367 * t354 + t81 * t898 / 0.2e1 + 0.11e2 / 0.6e1 * t372 * t354 + t85 * t937 / 0.2e1 + 0.3e1 / 0.2e1 * t382 * t378 + t105 * t937 / 0.2e1 + 0.5e1 / 0.3e1 * t387 * t378 + t110 * t937 / 0.2e1 + 0.11e2 / 0.6e1 * t392 * t378;
  t962 = t917 / 0.2e1 + t920 / 0.2e1 + 0.22e2 / 0.9e1 * t926 - 0.8e1 / 0.3e1 * t928 + t932 / 0.2e1 + t935 / 0.2e1 - t573;
  t975 = t29 * t858;
  t978 = t63 * t861;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t115 * t937 / 0.2e1 + 0.2e1 * t397 * t378 + t119 * t962 + 0.3e1 * t400 * t330 + t133 * t962 + 0.1e2 / 0.3e1 * t332 * t330 + t136 * t962 + 0.11e2 / 0.3e1 * t336 * t330 + t139 * t962 + 0.4e1 * t340 * t330 + 0.2e1 / 0.9e1 * t975 * t60 + 0.3e1 / 0.8e1 * t978 * t60 + 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101;
  t995 = t109 * t984;
  t998 = t118 * t861;
  t1001 = t132 * t864;
  t1004 = t135 * t984;
  t1015 = t141 * t855;
  t1018 = t147 * t858;
  t1021 = t150 * t861;
  t1024 = t153 * t864;
  t1027 = 0.55e2 / 0.72e2 * t995 * t101 + 0.3e1 / 0.4e1 * t998 * t130 + 0.1e2 / 0.9e1 * t1001 * t130 + 0.55e2 / 0.36e2 * t1004 * t130 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t867 + t950 + t994 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 2] += tv2rho22;

  t1030 = t32 * t182 * t46;
  t1035 = t85 * t88;
  t1038 = t105 * t88;
  t1042 = t173 * t90 * t45;
  t1052 = t29 / rho[0];
  t1054 = t418 * t44 * t46;
  t1057 = t63 * t488;
  t1060 = t67 * t491;
  t1063 = t71 * t494;
  t1066 = t110 * t88;
  t1069 = t115 * t88;
  t1076 = t427 * t1030 / 0.16e2 + t430 * t1030 / 0.16e2 + t1035 * t183 / 0.8e1 + t1038 * t183 / 0.8e1 - t85 * t1042 / 0.6e1 - t105 * t1042 / 0.6e1 - t110 * t1042 / 0.6e1 - t115 * t1042 / 0.6e1 + t1052 * t1054 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t1054 + 0.5e1 / 0.48e2 * t1060 * t1054 + 0.11e2 / 0.96e2 * t1063 * t1054 + t1066 * t183 / 0.8e1 + t1069 * t183 / 0.8e1 + t419 * t1030 / 0.16e2 + t424 * t1030 / 0.16e2;
  t1078 = t213 * t44 * t46;
  t1088 = t88 * t44;
  t1091 = 0.8e1 / 0.3e1 * t196;
  t1092 = -0.2e1 / 0.3e1 * t1042 + t1088 * t712 / 0.2e1 + t1091;
  t1106 = 0.1e1 / t2 / t86;
  t1107 = t84 * t1106;
  t1110 = 0.1e1 / t86;
  t1111 = t104 * t1110;
  t1114 = 0.1e1 / t75;
  t1115 = t109 * t1114;
  t1118 = 0.1e1 / t24;
  t1119 = t113 * t1118;
  t1122 = -t424 * t1078 / 0.12e2 - t427 * t1078 / 0.12e2 - t430 * t1078 / 0.12e2 - t419 * t1078 / 0.12e2 + t119 * t1092 + 0.3e1 / 0.2e1 * t168 * t444 + t133 * t1092 + 0.5e1 / 0.3e1 * t201 * t444 + t136 * t1092 + 0.11e2 / 0.6e1 * t205 * t444 + t139 * t1092 + 0.2e1 * t209 * t444 + 0.3e1 / 0.32e2 * t1107 * t91 + 0.5e1 / 0.48e2 * t1111 * t91 + 0.11e2 / 0.96e2 * t1115 * t91 + t1119 * t91 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t196;
  t1130 = 0.16e2 / 0.3e1 * t133 * t196;
  t1134 = 0.16e2 / 0.3e1 * t136 * t196;
  t1138 = 0.16e2 / 0.3e1 * t139 * t196;
  tv2rhosigma1 = -0.3e1 * t168 * t128 + t1126 - 0.1e2 / 0.3e1 * t201 * t128 + t1130 - 0.11e2 / 0.3e1 * t205 * t128 + t1134 - 0.4e1 * t209 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t226 * t454;
  t1143 = t50 * t190 * t46;
  t1146 = t231 * t454;
  t1151 = t236 * t454;
  t1156 = t241 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t251 * t470 + t1163 * t191 / 0.8e1 + 0.5e1 / 0.48e2 * t256 * t470 + t1168 * t191 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1091;
  t1198 = 0.11e2 / 0.96e2 * t261 * t470 + t1174 * t191 / 0.8e1 + t266 * t470 / 0.8e1 + t1179 * t191 / 0.8e1 + 0.3e1 / 0.2e1 * t168 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t201 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t205 * t480 + t136 * t1187 + 0.2e1 * t209 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t357 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t362 * t418;
  t1211 = t367 * t418;
  t1216 = t372 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t382 * t434 + t1035 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t387 * t434 + t1038 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1088 * t1240 / 0.2e1 + t1091;
  t1254 = 0.11e2 / 0.96e2 * t392 * t434 + t1066 * t314 / 0.8e1 + t397 * t434 / 0.8e1 + t1069 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t400 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t332 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t336 * t444 + t136 * t1243 + 0.2e1 * t340 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t400 * t128 + t1126 - 0.1e2 / 0.3e1 * t332 * t128 + t1130 - 0.11e2 / 0.3e1 * t336 * t128 + t1134 - 0.4e1 * t340 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t319 * t97 * t45;
  t1274 = t29 / rho[1];
  t1276 = t454 * t56 * t46;
  t1279 = t63 * t855;
  t1283 = t50 * t326 * t46;
  t1301 = t347 * t56 * t46;
  t1306 = -t85 * t1264 / 0.6e1 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 + t1274 * t1276 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t1276 + t460 * t1283 / 0.16e2 + t463 * t1283 / 0.16e2 + t466 * t1283 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 + t455 * t1283 / 0.16e2 - t455 * t1301 / 0.12e2 - t460 * t1301 / 0.12e2;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1318 / 0.2e1 + t1091;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = -t463 * t1301 / 0.12e2 - t466 * t1301 / 0.12e2 + 0.5e1 / 0.48e2 * t1311 * t1276 + 0.11e2 / 0.96e2 * t1314 * t1276 + t119 * t1321 + 0.3e1 / 0.2e1 * t400 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t332 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t336 * t480 + t139 * t1321 + 0.2e1 * t340 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1306 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t171, t173, t174, t175, t177, t178, t179;
  double t182, t183, t184, t186, t187, t190, t191, t192;
  double t194, t196, t198, t199, t201, t205, t209, t213;
  double t214, t217, t220, t223, t226, t231, t236, t241;
  double t244, t248, t251, t256, t261, t266, t269, t270;
  double t272, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t332, t336, t340, t343, t347;
  double t348, t351, t354, t357, t362, t367, t372, t378;
  double t381, t382, t387, t392, t397, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t485, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t569, t571, t573, t574, t576, t588, t591;
  double t594, t597, t598, t601, t604, t607, t610, t613;
  double t616, t618, t622, t624, t626, t628, t630, t631;
  double t636, t639, t642, t657, t659, t662, t664, t666;
  double t667, t670, t672, t675, t676, t677, t679, t681;
  double t683, t685, t687, t689, t691, t692, t695, t697;
  double t699, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t757;
  double t762, t765, t780, t797, t818, t829, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t868, t872, t876;
  double t877, t881, t882, t887, t890, t894, t895, t898;
  double t915, t916, t917, t919, t920, t922, t924, t925;
  double t926, t928, t930, t931, t932, t934, t935, t937;
  double t950, t962, t975, t978, t981, t984, t985, t988;
  double t991, t994, t995, t998, t1001, t1004, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1035, t1038, t1042;
  double t1052, t1054, t1057, t1060, t1063, t1066, t1069, t1076;
  double t1078, t1088, t1091, t1092, t1106, t1107, t1110, t1111;
  double t1114, t1115, t1118, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1274, t1276, t1279;
  double t1283, t1301, t1306, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1378, t1383, t1385, t1393, t1397, t1400, t1403, t1404;
  double t1407, t1410, t1413, t1416, t1419, t1422, t1425, t1426;
  double t1427, t1428, t1429, t1431, t1432, t1433, t1434, t1450;
  double t1451, t1458, t1459, t1462, t1465, t1467, t1471, t1472;
  double t1476, t1477, t1480, t1483, t1487, t1488, t1491, t1496;
  double t1509, t1511, t1512, t1513, t1515, t1517, t1519, t1521;
  double t1522, t1524, t1525, t1527, t1528, t1530, t1531, t1533;
  double t1544, t1561, t1563, t1565, t1566, t1580, t1582, t1584;
  double t1586, t1588, t1589, t1591, t1592, t1593, t1595, t1596;
  double t1597, t1599, t1600, t1603, t1605, t1607, t1609, t1611;
  double t1613, t1616, t1618, t1620, t1622, t1624, t1627, t1629;
  double t1630, t1632, t1634, t1636, t1639, t1641, t1643, t1645;
  double t1647, t1648, t1650, t1651, t1652, t1653, tv3rho30, t1656;
  double t1658, t1659, t1660, t1661, t1662, t1669, t1672, t1674;
  double t1676, t1678, t1692, t1700, t1702, t1704, t1706, t1707;
  double t1708, t1710, t1711, t1712, t1715, t1726, t1727, t1728;
  double t1730, t1732, t1734, t1735, t1736, t1738, t1739, t1740;
  double t1743, t1754, t1755, t1756, t1758, t1772, t1779, t1784;
  double t1787, t1808, t1826, t1845, t1854, t1855, t1857, t1870;
  double t1871, t1872, t1873, t1875, t1877, t1879, t1881, t1883;
  double t1885, t1887, t1889, tv3rho31, t1893, t1895, t1897, t1899;
  double t1901, t1903, t1905, t1907, t1909, t1918, t1920, t1922;
  double t1923, t1924, t1926, t1927, t1929, t1934, t1939, t1943;
  double t1944, t1945, t1947, t1949, t1951, t1953, t1954, t1955;
  double t1956, t1958, t1963, t1966, t1970, t1971, t1972, t1974;
  double t1996, t2003, t2010, t2013, t2037, t2044, t2067, t2088;
  double t2098, t2107, tv3rho32, t2116, t2121, t2124, t2127, t2130;
  double t2142, t2148, t2149, t2151, t2157, t2161, t2162, t2163;
  double t2165, t2167, t2168, t2169, t2171, t2173, t2175, t2177;
  double t2178, t2180, t2185, t2189, t2190, t2191, t2193, t2197;
  double t2201, t2202, t2208, t2211, t2220, t2229, t2250, t2287;
  double t2290, t2293, t2296, t2297, t2300, t2302, t2305, t2308;
  double t2311, t2314, t2317, t2320, t2329, tv3rho33, t2333, t2341;
  double t2346, t2351, t2356, t2362, t2369, t2372, t2384, t2388;
  double t2403, t2406, t2423, t2426, t2429, t2432, t2437, t2440;
  double t2441, t2444, t2446, t2447, t2450, t2451, t2454, t2456;
  double t2462, t2463, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2511, t2514;
  double t2519, t2524, t2529, t2546, t2549, t2552, t2555, t2558;
  double t2560, t2575, t2576, t2579, t2591, t2602, tv3rho2sigma2, t2606;
  double t2624, t2627, t2634, t2637, t2642, t2649, t2668, t2687;
  double t2700, t2709, t2712, t2715, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2750, t2759, t2768, t2777, t2780;
  double t2784, t2796, t2813, t2836, t2845, t2852, t2855, t2858;
  double t2861, t2880, tv3rho2sigma5, t2893, t2904, t2907, t2910, t2913;
  double t2928, t2930, t2949, t2952, t2969, tv3rho2sigma6, tv3rho2sigma7, t2995;
  double t2999, t3003, t3014, t3028, t3032, t3035, t3038, t3041;
  double t3044, t3048, t3053, t3082, t3091, t3094, t3109, t3112;
  double t3113, t3117, t3118, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t168 = t118 * t16;
  t171 = t86 * rho[0];
  t173 = 0.1e1 / t23 / t171;
  t174 = sigma[0] * t173;
  t175 = t174 * t91;
  t177 = t44 * t45;
  t178 = t34 * t144;
  t179 = t36 - t178;
  t182 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t179);
  t183 = t177 * t182;
  t184 = t89 * t183;
  t186 = t56 * t45;
  t187 = -t179;
  t190 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t187);
  t191 = t186 * t190;
  t192 = t96 * t191;
  t194 = t124 * t35;
  t196 = 0.1e1 / t126 / t194;
  t198 = 0.8e1 / 0.3e1 * t123 * t196;
  t199 = -0.2e1 / 0.3e1 * t175 + t184 / 0.2e1 + t192 / 0.2e1 + t198;
  t201 = t132 * t23;
  t205 = t135 * t74;
  t209 = t138 * rho[0];
  t213 = 0.1e1 / t9 / t86;
  t214 = t31 * t213;
  t217 = t182 * t46;
  t220 = t190 * t46;
  t223 = -t214 * t47 / 0.3e1 + t33 * t217 / 0.4e1 + t51 * t220 / 0.4e1;
  t226 = t29 * t9;
  t231 = t63 * t16;
  t236 = t67 * t23;
  t241 = t71 * t74;
  t244 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.3e1 / 0.2e1 * t168 * t130 + t133 * t199 + 0.5e1 / 0.3e1 * t201 * t130 + t136 * t199 + 0.11e2 / 0.6e1 * t205 * t130 + t139 * t199 + 0.2e1 * t209 * t130 + t30 * t223 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t60 + t64 * t223 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t60 + t68 * t223 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t60 + t81 * t223 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t60;
  t248 = -t175 / 0.3e1 + t184 / 0.4e1 + t192 / 0.4e1;
  t251 = t84 * t16;
  t256 = t104 * t23;
  t261 = t109 * t74;
  t266 = t113 * rho[0];
  t269 = 0.1e1 / t194;
  t270 = t143 * t269;
  t272 = 0.2e1 * t154 * t270;
  t275 = 0.2e1 * t142 * t178;
  t277 = 0.2e1 * t142 * t270;
  t279 = 0.2e1 * t148 * t178;
  t281 = 0.2e1 * t148 * t270;
  t283 = 0.2e1 * t151 * t178;
  t285 = 0.2e1 * t151 * t270;
  t287 = 0.2e1 * t154 * t178;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = t275 - t277 + t279 - t281 + t283 - t285 + t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t244 + t85 * t248 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t101 + t105 * t248 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t101 + t110 * t248 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t101 + t115 * t248 / 0.2e1 + t266 * t101 + t119 * t199 - t272 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t310 = -t36 - t178;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t177 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t186 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t198;
  t332 = t132 * t25;
  t336 = t135 * t78;
  t340 = t138 * rho[1];
  t343 = t313 * t46;
  t347 = 0.1e1 / t11 / t93;
  t348 = t49 * t347;
  t351 = t326 * t46;
  t354 = t33 * t343 / 0.4e1 - t348 * t57 / 0.3e1 + t51 * t351 / 0.4e1;
  t357 = t29 * t11;
  t362 = t63 * t18;
  t367 = t67 * t25;
  t372 = t71 * t78;
  t378 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t381 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t133 * t330 + 0.5e1 / 0.3e1 * t332 * t130 + t136 * t330 + 0.11e2 / 0.6e1 * t336 * t130 + t139 * t330 + 0.2e1 * t340 * t130 + t30 * t354 / 0.2e1 + 0.2e1 / 0.3e1 * t357 * t60 + t64 * t354 / 0.2e1 + 0.3e1 / 0.4e1 * t362 * t60 + t68 * t354 / 0.2e1 + 0.5e1 / 0.6e1 * t367 * t60 + t81 * t354 / 0.2e1 + 0.11e2 / 0.12e2 * t372 * t60 + t85 * t378 / 0.2e1;
  t382 = t84 * t18;
  t387 = t104 * t25;
  t392 = t109 * t78;
  t397 = t113 * rho[1];
  t400 = t118 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145 - t275 - t277 - t279 - t281 - t283 - t285 - t287;
  tvrho1 = t381 + 0.3e1 / 0.4e1 * t382 * t101 + t105 * t378 / 0.2e1 + 0.5e1 / 0.6e1 * t387 * t101 + t110 * t378 / 0.2e1 + 0.11e2 / 0.12e2 * t392 * t101 + t115 * t378 / 0.2e1 + t397 * t101 + t119 * t330 + 0.3e1 / 0.2e1 * t400 * t130 - t272 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 2] += tvsigma2;

  t485 = t113 * t101;
  t487 = 0.2e1 * t138 * t130;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t174 * t183;
  t510 = t182 * t182;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t179 * t179;
  t519 = t34 * t269;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t177 * t525;
  t527 = t89 * t526;
  t529 = t190 * t190;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t187 * t187;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t186 * t542;
  t544 = t96 * t543;
  t546 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t569 = t124 * t124;
  t571 = 0.1e1 / t126 / t569;
  t573 = 0.88e2 / 0.9e1 * t123 * t571;
  t574 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t573;
  t576 = t485 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.6e1 * t241 * t223 + t85 * t546 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t248 + t105 * t546 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t248 + t110 * t546 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t248 + t115 * t546 / 0.2e1 + 0.2e1 * t266 * t248 + t119 * t574;
  t588 = t29 * t491;
  t591 = t63 * t494;
  t594 = t67 * t497;
  t597 = 0.1e1 / t2;
  t598 = t71 * t597;
  t601 = t84 * t494;
  t604 = t104 * t497;
  t607 = t109 * t597;
  t610 = t118 * t494;
  t613 = t132 * t497;
  t616 = 0.3e1 * t168 * t199 + t133 * t574 + 0.1e2 / 0.3e1 * t201 * t199 + t136 * t574 + 0.11e2 / 0.3e1 * t205 * t199 + t139 * t574 + 0.4e1 * t209 * t199 + 0.2e1 / 0.9e1 * t588 * t60 + 0.3e1 / 0.8e1 * t591 * t60 + 0.5e1 / 0.9e1 * t594 * t60 + 0.55e2 / 0.72e2 * t598 * t60 + 0.3e1 / 0.8e1 * t601 * t101 + 0.5e1 / 0.9e1 * t604 * t101 + 0.55e2 / 0.72e2 * t607 * t101 + 0.3e1 / 0.4e1 * t610 * t130 + 0.1e2 / 0.9e1 * t613 * t130;
  t618 = t135 * t597;
  t622 = 0.2e1 * t142 * t144;
  t624 = 0.2e1 * t148 * t144;
  t626 = 0.2e1 * t151 * t144;
  t628 = 0.2e1 * t154 * t144;
  t630 = 0.1e1 / t9 / t171;
  t631 = t31 * t630;
  t636 = t525 * t46;
  t639 = t542 * t46;
  t642 = 0.7e1 / 0.9e1 * t631 * t47 - 0.2e1 / 0.3e1 * t214 * t217 + t33 * t636 / 0.4e1 + t51 * t639 / 0.4e1;
  t657 = t291 * t270;
  t659 = t150 * t494;
  t662 = t294 * t178;
  t664 = t294 * t270;
  t666 = 0.55e2 / 0.36e2 * t618 * t130 + t622 + t624 + t626 + t628 + t30 * t642 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t223 + t64 * t642 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t223 + t68 * t642 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t223 + t81 * t642 / 0.2e1 - 0.16e2 / 0.3e1 * t657 + 0.3e1 / 0.4e1 * t659 * t145 + 0.6e1 * t662 - 0.6e1 * t664;
  t667 = t153 * t497;
  t670 = t297 * t178;
  t672 = t297 * t270;
  t675 = 0.8e1 * t142 * t519;
  t676 = 0.1e1 / t569;
  t677 = t143 * t676;
  t679 = 0.6e1 * t142 * t677;
  t681 = 0.8e1 * t148 * t519;
  t683 = 0.6e1 * t148 * t677;
  t685 = 0.8e1 * t151 * t519;
  t687 = 0.6e1 * t151 * t677;
  t689 = 0.8e1 * t154 * t519;
  t691 = 0.6e1 * t154 * t677;
  t692 = t141 * t488;
  t695 = t288 * t178;
  t697 = t288 * t270;
  t699 = t147 * t491;
  t702 = t291 * t178;
  t704 = 0.1e2 / 0.9e1 * t667 * t145 + 0.2e2 / 0.3e1 * t670 - 0.2e2 / 0.3e1 * t672 - t675 + t679 - t681 + t683 - t685 + t687 - t689 + t691 + 0.7e1 / 0.36e2 * t692 * t145 + 0.14e2 / 0.3e1 * t695 - 0.14e2 / 0.3e1 * t697 + 0.4e1 / 0.9e1 * t699 * t145 + 0.16e2 / 0.3e1 * t702;
  tv2rho20 = t576 + t616 + t666 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t710 = t174 * t314;
  t712 = t182 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t179 + 0.8e1 / 0.3e1 * t719 * t269);
  t724 = t177 * t723;
  t725 = t89 * t724;
  t727 = t320 * t191;
  t729 = t190 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t187 - 0.8e1 / 0.3e1 * t736 * t269);
  t741 = t186 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t573;
  t757 = t723 * t46;
  t762 = t740 * t46;
  t765 = -t214 * t343 / 0.3e1 + t33 * t757 / 0.4e1 - t348 * t220 / 0.3e1 + t51 * t762 / 0.4e1;
  t780 = 0.5e1 / 0.3e1 * t201 * t330 + 0.5e1 / 0.3e1 * t332 * t199 + t136 * t744 + 0.11e2 / 0.6e1 * t205 * t330 + 0.11e2 / 0.6e1 * t336 * t199 + t139 * t744 + 0.2e1 * t209 * t330 + 0.2e1 * t340 * t199 + t30 * t765 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t354 + 0.2e1 / 0.3e1 * t357 * t223 + t64 * t765 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t354 + 0.3e1 / 0.4e1 * t362 * t223 + t68 * t765 / 0.2e1;
  t797 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t818 = 0.5e1 / 0.6e1 * t236 * t354 + 0.5e1 / 0.6e1 * t367 * t223 + t81 * t765 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t354 + 0.11e2 / 0.12e2 * t372 * t223 + t85 * t797 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t378 + 0.3e1 / 0.4e1 * t382 * t248 + t105 * t797 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t378 + 0.5e1 / 0.6e1 * t387 * t248 + t110 * t797 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t378 + 0.11e2 / 0.12e2 * t392 * t248 + t115 * t797 / 0.2e1;
  t829 = t266 * t378 - t622 - t624 - t626 - t628 + 0.3e1 / 0.2e1 * t400 * t199 + t133 * t744 - 0.8e1 / 0.3e1 * t657 - 0.3e1 * t662 - 0.3e1 * t664 - 0.1e2 / 0.3e1 * t670 - 0.1e2 / 0.3e1 * t672 + t679 + t683 + t687;
  t837 = t404 * t178;
  t839 = t404 * t270;
  t841 = t407 * t178;
  t843 = t407 * t270;
  t845 = t410 * t178;
  t847 = t410 * t270;
  t849 = t413 * t178;
  t851 = t413 * t270;
  t853 = t691 - 0.7e1 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t697 - 0.8e1 / 0.3e1 * t702 + t397 * t248 + t119 * t744 + 0.3e1 / 0.2e1 * t168 * t330 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t818 + t829 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t485 + t487 + t622 + t624 + t626 + t628 + t675 + t679 + t681 + t683 + t685 + t687;
  t868 = t310 * t310;
  t872 = 0.2e1 * t144 + 0.2e1 * t519;
  t876 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t868 + 0.4e1 / 0.3e1 * t42 * t872);
  t877 = t876 * t46;
  t881 = 0.1e1 / t11 / t317;
  t882 = t49 * t881;
  t887 = t323 * t323;
  t890 = -t872;
  t894 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t887 + 0.4e1 / 0.3e1 * t54 * t890);
  t895 = t894 * t46;
  t898 = t33 * t877 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t57 - 0.2e1 / 0.3e1 * t348 * t351 + t51 * t895 / 0.4e1;
  t915 = t313 * t313;
  t916 = t915 * t45;
  t917 = t89 * t916;
  t919 = t177 * t876;
  t920 = t89 * t919;
  t922 = t93 * t93;
  t924 = 0.1e1 / t25 / t922;
  t925 = sigma[2] * t924;
  t926 = t925 * t98;
  t928 = t320 * t327;
  t930 = t326 * t326;
  t931 = t930 * t45;
  t932 = t96 * t931;
  t934 = t186 * t894;
  t935 = t96 * t934;
  t937 = t917 / 0.4e1 + t920 / 0.4e1 + 0.11e2 / 0.9e1 * t926 - 0.4e1 / 0.3e1 * t928 + t932 / 0.4e1 + t935 / 0.4e1;
  t950 = t689 + t691 + t30 * t898 / 0.2e1 + 0.4e1 / 0.3e1 * t357 * t354 + t64 * t898 / 0.2e1 + 0.3e1 / 0.2e1 * t362 * t354 + t68 * t898 / 0.2e1 + 0.5e1 / 0.3e1 * t367 * t354 + t81 * t898 / 0.2e1 + 0.11e2 / 0.6e1 * t372 * t354 + t85 * t937 / 0.2e1 + 0.3e1 / 0.2e1 * t382 * t378 + t105 * t937 / 0.2e1 + 0.5e1 / 0.3e1 * t387 * t378 + t110 * t937 / 0.2e1 + 0.11e2 / 0.6e1 * t392 * t378;
  t962 = t917 / 0.2e1 + t920 / 0.2e1 + 0.22e2 / 0.9e1 * t926 - 0.8e1 / 0.3e1 * t928 + t932 / 0.2e1 + t935 / 0.2e1 - t573;
  t975 = t29 * t858;
  t978 = t63 * t861;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t115 * t937 / 0.2e1 + 0.2e1 * t397 * t378 + t119 * t962 + 0.3e1 * t400 * t330 + t133 * t962 + 0.1e2 / 0.3e1 * t332 * t330 + t136 * t962 + 0.11e2 / 0.3e1 * t336 * t330 + t139 * t962 + 0.4e1 * t340 * t330 + 0.2e1 / 0.9e1 * t975 * t60 + 0.3e1 / 0.8e1 * t978 * t60 + 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101;
  t995 = t109 * t984;
  t998 = t118 * t861;
  t1001 = t132 * t864;
  t1004 = t135 * t984;
  t1015 = t141 * t855;
  t1018 = t147 * t858;
  t1021 = t150 * t861;
  t1024 = t153 * t864;
  t1027 = 0.55e2 / 0.72e2 * t995 * t101 + 0.3e1 / 0.4e1 * t998 * t130 + 0.1e2 / 0.9e1 * t1001 * t130 + 0.55e2 / 0.36e2 * t1004 * t130 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t867 + t950 + t994 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 2] += tv2rho22;

  t1030 = t32 * t182 * t46;
  t1035 = t85 * t88;
  t1038 = t105 * t88;
  t1042 = t173 * t90 * t45;
  t1052 = t29 / rho[0];
  t1054 = t418 * t44 * t46;
  t1057 = t63 * t488;
  t1060 = t67 * t491;
  t1063 = t71 * t494;
  t1066 = t110 * t88;
  t1069 = t115 * t88;
  t1076 = t427 * t1030 / 0.16e2 + t430 * t1030 / 0.16e2 + t1035 * t183 / 0.8e1 + t1038 * t183 / 0.8e1 - t85 * t1042 / 0.6e1 - t105 * t1042 / 0.6e1 - t110 * t1042 / 0.6e1 - t115 * t1042 / 0.6e1 + t1052 * t1054 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t1054 + 0.5e1 / 0.48e2 * t1060 * t1054 + 0.11e2 / 0.96e2 * t1063 * t1054 + t1066 * t183 / 0.8e1 + t1069 * t183 / 0.8e1 + t419 * t1030 / 0.16e2 + t424 * t1030 / 0.16e2;
  t1078 = t213 * t44 * t46;
  t1088 = t88 * t44;
  t1091 = 0.8e1 / 0.3e1 * t196;
  t1092 = -0.2e1 / 0.3e1 * t1042 + t1088 * t712 / 0.2e1 + t1091;
  t1106 = 0.1e1 / t2 / t86;
  t1107 = t84 * t1106;
  t1110 = 0.1e1 / t86;
  t1111 = t104 * t1110;
  t1114 = 0.1e1 / t75;
  t1115 = t109 * t1114;
  t1118 = 0.1e1 / t24;
  t1119 = t113 * t1118;
  t1122 = -t424 * t1078 / 0.12e2 - t427 * t1078 / 0.12e2 - t430 * t1078 / 0.12e2 - t419 * t1078 / 0.12e2 + t119 * t1092 + 0.3e1 / 0.2e1 * t168 * t444 + t133 * t1092 + 0.5e1 / 0.3e1 * t201 * t444 + t136 * t1092 + 0.11e2 / 0.6e1 * t205 * t444 + t139 * t1092 + 0.2e1 * t209 * t444 + 0.3e1 / 0.32e2 * t1107 * t91 + 0.5e1 / 0.48e2 * t1111 * t91 + 0.11e2 / 0.96e2 * t1115 * t91 + t1119 * t91 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t196;
  t1130 = 0.16e2 / 0.3e1 * t133 * t196;
  t1134 = 0.16e2 / 0.3e1 * t136 * t196;
  t1138 = 0.16e2 / 0.3e1 * t139 * t196;
  tv2rhosigma1 = -0.3e1 * t168 * t128 + t1126 - 0.1e2 / 0.3e1 * t201 * t128 + t1130 - 0.11e2 / 0.3e1 * t205 * t128 + t1134 - 0.4e1 * t209 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t226 * t454;
  t1143 = t50 * t190 * t46;
  t1146 = t231 * t454;
  t1151 = t236 * t454;
  t1156 = t241 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t251 * t470 + t1163 * t191 / 0.8e1 + 0.5e1 / 0.48e2 * t256 * t470 + t1168 * t191 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1091;
  t1198 = 0.11e2 / 0.96e2 * t261 * t470 + t1174 * t191 / 0.8e1 + t266 * t470 / 0.8e1 + t1179 * t191 / 0.8e1 + 0.3e1 / 0.2e1 * t168 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t201 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t205 * t480 + t136 * t1187 + 0.2e1 * t209 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t357 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t362 * t418;
  t1211 = t367 * t418;
  t1216 = t372 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t382 * t434 + t1035 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t387 * t434 + t1038 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1088 * t1240 / 0.2e1 + t1091;
  t1254 = 0.11e2 / 0.96e2 * t392 * t434 + t1066 * t314 / 0.8e1 + t397 * t434 / 0.8e1 + t1069 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t400 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t332 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t336 * t444 + t136 * t1243 + 0.2e1 * t340 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t400 * t128 + t1126 - 0.1e2 / 0.3e1 * t332 * t128 + t1130 - 0.11e2 / 0.3e1 * t336 * t128 + t1134 - 0.4e1 * t340 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t319 * t97 * t45;
  t1274 = t29 / rho[1];
  t1276 = t454 * t56 * t46;
  t1279 = t63 * t855;
  t1283 = t50 * t326 * t46;
  t1301 = t347 * t56 * t46;
  t1306 = -t85 * t1264 / 0.6e1 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 + t1274 * t1276 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t1276 + t460 * t1283 / 0.16e2 + t463 * t1283 / 0.16e2 + t466 * t1283 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 + t455 * t1283 / 0.16e2 - t455 * t1301 / 0.12e2 - t460 * t1301 / 0.12e2;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1318 / 0.2e1 + t1091;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = -t463 * t1301 / 0.12e2 - t466 * t1301 / 0.12e2 + 0.5e1 / 0.48e2 * t1311 * t1276 + 0.11e2 / 0.96e2 * t1314 * t1276 + t119 * t1321 + 0.3e1 / 0.2e1 * t400 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t332 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t336 * t480 + t139 * t1321 + 0.2e1 * t340 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1306 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 5] += tv2sigma25;

  t1378 = 0.1e1 / t17;
  t1383 = t113 * t248;
  t1385 = t138 * t199;
  t1393 = t29 * t1118;
  t1397 = t63 * t1378;
  t1400 = t67 * t32;
  t1403 = 0.1e1 / t3;
  t1404 = t71 * t1403;
  t1407 = t84 * t1378;
  t1410 = t104 * t32;
  t1413 = t109 * t1403;
  t1416 = t118 * t1378;
  t1419 = t132 * t32;
  t1422 = t135 * t1403;
  t1425 = t142 * t269;
  t1426 = 0.12e2 * t1425;
  t1427 = t148 * t269;
  t1428 = 0.12e2 * t1427;
  t1429 = -0.3e1 / 0.16e2 * t1397 * t60 - 0.5e1 / 0.27e2 * t1400 * t60 - 0.55e2 / 0.432e3 * t1404 * t60 - 0.3e1 / 0.16e2 * t1407 * t101 - 0.5e1 / 0.27e2 * t1410 * t101 - 0.55e2 / 0.432e3 * t1413 * t101 - 0.3e1 / 0.8e1 * t1416 * t130 - 0.1e2 / 0.27e2 * t1419 * t130 - 0.55e2 / 0.216e3 * t1422 * t130 - t1426 - t1428;
  t1431 = t151 * t269;
  t1432 = 0.12e2 * t1431;
  t1433 = t154 * t269;
  t1434 = 0.12e2 * t1433;
  t1450 = 0.1e1 / t9 / t502;
  t1451 = t31 * t1450;
  t1458 = 0.1e1 / t514 / t38;
  t1459 = t516 * t179;
  t1462 = t515 * t179;
  t1465 = t34 * t676;
  t1467 = 0.6e1 * t269 - 0.6e1 * t1465;
  t1471 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1458 * t1459 + 0.4e1 / 0.3e1 * t1462 * t521 + 0.4e1 / 0.3e1 * t42 * t1467);
  t1472 = t1471 * t46;
  t1476 = 0.1e1 / t533 / t52;
  t1477 = t535 * t187;
  t1480 = t534 * t187;
  t1483 = -t1467;
  t1487 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1476 * t1477 + 0.4e1 / 0.3e1 * t1480 * t538 + 0.4e1 / 0.3e1 * t54 * t1483);
  t1488 = t1487 * t46;
  t1491 = -0.7e2 / 0.27e2 * t1451 * t47 + 0.7e1 / 0.3e1 * t631 * t217 - t214 * t636 + t33 * t1472 / 0.4e1 + t51 * t1488 / 0.4e1;
  t1496 = -t1432 - t1434 + 0.2e1 / 0.3e1 * t588 * t223 + 0.9e1 / 0.8e1 * t591 * t223 + 0.5e1 / 0.3e1 * t594 * t223 + 0.55e2 / 0.24e2 * t598 * t223 + 0.9e1 / 0.8e1 * t601 * t248 + 0.5e1 / 0.3e1 * t604 * t248 + 0.55e2 / 0.24e2 * t607 * t248 + t30 * t1491 / 0.2e1 + 0.2e1 * t226 * t642;
  t1509 = t502 * rho[0];
  t1511 = 0.1e1 / t23 / t1509;
  t1512 = sigma[0] * t1511;
  t1513 = t1512 * t91;
  t1515 = t505 * t183;
  t1517 = t174 * t511;
  t1519 = t174 * t526;
  t1521 = t712 * t525;
  t1522 = t89 * t1521;
  t1524 = t177 * t1471;
  t1525 = t89 * t1524;
  t1527 = t729 * t542;
  t1528 = t96 * t1527;
  t1530 = t186 * t1487;
  t1531 = t96 * t1530;
  t1533 = -0.154e3 / 0.27e2 * t1513 + 0.22e2 / 0.3e1 * t1515 - 0.2e1 * t1517 - 0.2e1 * t1519 + 0.3e1 / 0.4e1 * t1522 + t1525 / 0.4e1 + 0.3e1 / 0.4e1 * t1528 + t1531 / 0.4e1;
  t1544 = t64 * t1491 / 0.2e1 + 0.9e1 / 0.4e1 * t231 * t642 + t68 * t1491 / 0.2e1 + 0.5e1 / 0.2e1 * t236 * t642 + t81 * t1491 / 0.2e1 + 0.11e2 / 0.4e1 * t241 * t642 + t85 * t1533 / 0.2e1 + 0.9e1 / 0.4e1 * t251 * t546 + t105 * t1533 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t546 + t110 * t1533 / 0.2e1;
  t1561 = t569 * t35;
  t1563 = 0.1e1 / t126 / t1561;
  t1565 = 0.1232e4 / 0.27e2 * t123 * t1563;
  t1566 = -0.308e3 / 0.27e2 * t1513 + 0.44e2 / 0.3e1 * t1515 - 0.4e1 * t1517 - 0.4e1 * t1519 + 0.3e1 / 0.2e1 * t1522 + t1525 / 0.2e1 + 0.3e1 / 0.2e1 * t1528 + t1531 / 0.2e1 + t1565;
  t1580 = t288 * t144;
  t1582 = t291 * t144;
  t1584 = t294 * t144;
  t1586 = t297 * t144;
  t1588 = 0.1e1 / t1561;
  t1589 = t143 * t1588;
  t1591 = 0.24e2 * t148 * t1589;
  t1592 = t151 * t1465;
  t1593 = 0.36e2 * t1592;
  t1595 = 0.24e2 * t151 * t1589;
  t1596 = t154 * t1465;
  t1597 = 0.36e2 * t1596;
  t1599 = 0.24e2 * t154 * t1589;
  t1600 = t141 * t1114;
  t1603 = 0.6e1 * t209 * t574 + 0.7e1 * t1580 + 0.8e1 * t1582 + 0.9e1 * t1584 + 0.1e2 * t1586 - t1591 + t1593 - t1595 + t1597 - t1599 - 0.35e2 / 0.216e3 * t1600 * t145;
  t1605 = t692 * t178;
  t1607 = t692 * t270;
  t1609 = t288 * t519;
  t1611 = t288 * t677;
  t1613 = t147 * t1118;
  t1616 = t699 * t178;
  t1618 = t699 * t270;
  t1620 = t291 * t519;
  t1622 = t291 * t677;
  t1624 = t150 * t1378;
  t1627 = t659 * t178;
  t1629 = 0.7e1 / 0.6e1 * t1605 - 0.7e1 / 0.6e1 * t1607 - 0.28e2 * t1609 + 0.21e2 * t1611 - 0.8e1 / 0.27e2 * t1613 * t145 + 0.8e1 / 0.3e1 * t1616 - 0.8e1 / 0.3e1 * t1618 - 0.32e2 * t1620 + 0.24e2 * t1622 - 0.3e1 / 0.8e1 * t1624 * t145 + 0.9e1 / 0.2e1 * t1627;
  t1630 = t659 * t270;
  t1632 = t294 * t519;
  t1634 = t294 * t677;
  t1636 = t153 * t32;
  t1639 = t667 * t178;
  t1641 = t667 * t270;
  t1643 = t297 * t519;
  t1645 = t297 * t677;
  t1647 = t142 * t1465;
  t1648 = 0.36e2 * t1647;
  t1650 = 0.24e2 * t142 * t1589;
  t1651 = t148 * t1465;
  t1652 = 0.36e2 * t1651;
  t1653 = -0.9e1 / 0.2e1 * t1630 - 0.36e2 * t1632 + 0.27e2 * t1634 - 0.1e2 / 0.27e2 * t1636 * t145 + 0.2e2 / 0.3e1 * t1639 - 0.2e2 / 0.3e1 * t1641 - 0.4e2 * t1643 + 0.3e2 * t1645 + t1648 - t1650 + t1652;
  tv3rho30 = t1653 + t1629 + t1603 + t1544 + t1496 + t1429 + 0.3e1 * t1383 + 0.6e1 * t1385 + 0.11e2 / 0.4e1 * t261 * t546 + t115 * t1533 / 0.2e1 + 0.3e1 * t266 * t546 + t119 * t1566 + 0.9e1 / 0.2e1 * t168 * t574 + t133 * t1566 + 0.5e1 * t201 * t574 + t136 * t1566 + 0.11e2 / 0.2e1 * t205 * t574 + t139 * t1566 - 0.3e1 / 0.8e1 * t15 * t1378 - 0.1e2 / 0.27e2 * t22 * t32 + 0.9e1 / 0.4e1 * t610 * t199 + 0.1e2 / 0.3e1 * t613 * t199 + 0.55e2 / 0.12e2 * t618 * t199 - 0.4e1 / 0.27e2 * t1393 * t60 - 0.35e2 / 0.216e3 * t1 * t1114 - 0.8e1 / 0.27e2 * t8 * t1118;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 0] += tv3rho30;

  t1656 = t138 * t330;
  t1658 = t113 * t378;
  t1659 = 0.4e1 * t1425;
  t1660 = 0.4e1 * t1427;
  t1661 = 0.4e1 * t1431;
  t1662 = 0.4e1 * t1433;
  t1669 = 0.2e1 * t1656 + t1658 + t1659 + t1660 + t1661 + t1662 - 0.14e2 / 0.3e1 * t1580 - 0.16e2 / 0.3e1 * t1582 - 0.6e1 * t1584 - 0.2e2 / 0.3e1 * t1586 + 0.55e2 / 0.72e2 * t607 * t378;
  t1672 = t404 * t144;
  t1674 = t407 * t144;
  t1676 = t410 * t144;
  t1678 = t413 * t144;
  t1692 = 0.3e1 / 0.4e1 * t610 * t330 + 0.7e1 / 0.3e1 * t1672 + 0.8e1 / 0.3e1 * t1674 + 0.3e1 * t1676 + 0.1e2 / 0.3e1 * t1678 + 0.1e2 / 0.9e1 * t613 * t330 + 0.55e2 / 0.36e2 * t618 * t330 + 0.2e1 / 0.9e1 * t588 * t354 + 0.3e1 / 0.8e1 * t591 * t354 + 0.5e1 / 0.9e1 * t594 * t354 + 0.55e2 / 0.72e2 * t598 * t354;
  t1700 = t505 * t314;
  t1702 = t174 * t713;
  t1704 = t174 * t724;
  t1706 = t525 * t45;
  t1707 = t1706 * t313;
  t1708 = t89 * t1707;
  t1710 = t712 * t723;
  t1711 = t89 * t1710;
  t1712 = t1458 * t310;
  t1715 = t515 * t34;
  t1726 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1712 * t516 + 0.16e2 / 0.9e1 * t1715 * t269 * t179 + 0.4e1 / 0.9e1 * t716 * t521 + 0.8e1 / 0.3e1 * t42 * t269 - 0.8e1 * t719 * t676);
  t1727 = t177 * t1726;
  t1728 = t89 * t1727;
  t1730 = t320 * t530;
  t1732 = t320 * t543;
  t1734 = t542 * t45;
  t1735 = t1734 * t326;
  t1736 = t96 * t1735;
  t1738 = t729 * t740;
  t1739 = t96 * t1738;
  t1740 = t1476 * t323;
  t1743 = t534 * t34;
  t1754 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1740 * t535 - 0.16e2 / 0.9e1 * t1743 * t269 * t187 + 0.4e1 / 0.9e1 * t733 * t538 - 0.8e1 / 0.3e1 * t54 * t269 + 0.8e1 * t736 * t676);
  t1755 = t186 * t1754;
  t1756 = t96 * t1755;
  t1758 = 0.44e2 / 0.9e1 * t1700 - 0.8e1 / 0.3e1 * t1702 - 0.8e1 / 0.3e1 * t1704 + t1708 / 0.2e1 + t1711 + t1728 / 0.2e1 - 0.4e1 / 0.3e1 * t1730 - 0.4e1 / 0.3e1 * t1732 + t1736 / 0.2e1 + t1739 + t1756 / 0.2e1 + t1565;
  t1772 = 0.3e1 / 0.8e1 * t601 * t378 + 0.5e1 / 0.9e1 * t604 * t378 + 0.3e1 / 0.2e1 * t400 * t574 + t133 * t1758 + 0.1e2 / 0.3e1 * t201 * t744 + 0.5e1 / 0.3e1 * t332 * t574 + t136 * t1758 + 0.11e2 / 0.3e1 * t205 * t744 + 0.11e2 / 0.6e1 * t336 * t574 + t139 * t1758 + 0.4e1 * t209 * t744;
  t1779 = t1726 * t46;
  t1784 = t1754 * t46;
  t1787 = 0.7e1 / 0.9e1 * t631 * t343 - 0.2e1 / 0.3e1 * t214 * t757 + t33 * t1779 / 0.4e1 - t348 * t639 / 0.3e1 + t51 * t1784 / 0.4e1;
  t1808 = 0.2e1 * t340 * t574 + t30 * t1787 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t765 + 0.2e1 / 0.3e1 * t357 * t642 + t64 * t1787 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t765 + 0.3e1 / 0.4e1 * t362 * t642 + t68 * t1787 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t765 + 0.5e1 / 0.6e1 * t367 * t642 + t81 * t1787 / 0.2e1;
  t1826 = 0.22e2 / 0.9e1 * t1700 - 0.4e1 / 0.3e1 * t1702 - 0.4e1 / 0.3e1 * t1704 + t1708 / 0.4e1 + t1711 / 0.2e1 + t1728 / 0.4e1 - 0.2e1 / 0.3e1 * t1730 - 0.2e1 / 0.3e1 * t1732 + t1736 / 0.4e1 + t1739 / 0.2e1 + t1756 / 0.4e1;
  t1845 = 0.11e2 / 0.6e1 * t241 * t765 + 0.11e2 / 0.12e2 * t372 * t642 + t85 * t1826 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t797 + 0.3e1 / 0.4e1 * t382 * t546 + t105 * t1826 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t797 + 0.5e1 / 0.6e1 * t387 * t546 + t110 * t1826 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t797 + 0.11e2 / 0.12e2 * t392 * t546;
  t1854 = 0.12e2 * t1592;
  t1855 = 0.12e2 * t1596;
  t1857 = t115 * t1826 / 0.2e1 + 0.2e1 * t266 * t797 + t397 * t546 + t119 * t1758 + 0.3e1 * t168 * t744 - t1591 + t1854 - t1595 + t1855 - t1599 - 0.7e1 / 0.18e2 * t1605;
  t1870 = -0.7e1 / 0.18e2 * t1607 + 0.14e2 * t1611 - 0.8e1 / 0.9e1 * t1616 - 0.8e1 / 0.9e1 * t1618 + 0.16e2 * t1622 - 0.3e1 / 0.2e1 * t1627 - 0.3e1 / 0.2e1 * t1630 + 0.18e2 * t1634 - 0.2e2 / 0.9e1 * t1639 - 0.2e2 / 0.9e1 * t1641 + 0.2e2 * t1645;
  t1871 = 0.12e2 * t1647;
  t1872 = 0.12e2 * t1651;
  t1873 = t410 * t519;
  t1875 = t410 * t677;
  t1877 = t413 * t519;
  t1879 = t413 * t677;
  t1881 = t404 * t519;
  t1883 = t404 * t677;
  t1885 = t407 * t519;
  t1887 = t407 * t677;
  t1889 = t1871 - t1650 + t1872 - 0.12e2 * t1873 + 0.9e1 * t1875 - 0.4e2 / 0.3e1 * t1877 + 0.1e2 * t1879 - 0.28e2 / 0.3e1 * t1881 + 0.7e1 * t1883 - 0.32e2 / 0.3e1 * t1885 + 0.8e1 * t1887;
  tv3rho31 = t1669 + t1692 + t1772 + t1808 + t1845 + t1857 + t1870 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 1] += tv3rho31;

  t1893 = t1015 * t178;
  t1895 = t1015 * t270;
  t1897 = t1018 * t178;
  t1899 = t1018 * t270;
  t1901 = t1021 * t178;
  t1903 = t1021 * t270;
  t1905 = t1024 * t178;
  t1907 = t1024 * t270;
  t1909 = t1383 + 0.2e1 * t1385 + 0.7e1 / 0.18e2 * t1893 - 0.7e1 / 0.18e2 * t1895 + 0.8e1 / 0.9e1 * t1897 - 0.8e1 / 0.9e1 * t1899 + 0.3e1 / 0.2e1 * t1901 - 0.3e1 / 0.2e1 * t1903 + 0.2e2 / 0.9e1 * t1905 - 0.2e2 / 0.9e1 * t1907 + t1659;
  t1918 = t1660 + t1661 + t1662 + 0.7e1 / 0.3e1 * t1580 + 0.8e1 / 0.3e1 * t1582 + 0.3e1 * t1584 + 0.1e2 / 0.3e1 * t1586 - 0.14e2 / 0.3e1 * t1672 - 0.16e2 / 0.3e1 * t1674 - 0.6e1 * t1676 - 0.2e2 / 0.3e1 * t1678;
  t1920 = t174 * t916;
  t1922 = t1240 * t723;
  t1923 = t89 * t1922;
  t1924 = t174 * t919;
  t1926 = t712 * t876;
  t1927 = t89 * t1926;
  t1929 = t1458 * t868;
  t1934 = t515 * t872;
  t1939 = -0.2e1 * t269 - 0.6e1 * t1465;
  t1943 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1929 * t179 + 0.16e2 / 0.9e1 * t716 * t519 + 0.4e1 / 0.9e1 * t1934 * t179 + 0.4e1 / 0.3e1 * t42 * t1939);
  t1944 = t177 * t1943;
  t1945 = t89 * t1944;
  t1947 = t925 * t191;
  t1949 = t320 * t730;
  t1951 = t320 * t741;
  t1953 = t1318 * t740;
  t1954 = t96 * t1953;
  t1955 = t729 * t894;
  t1956 = t96 * t1955;
  t1958 = t1476 * t887;
  t1963 = t534 * t890;
  t1966 = -t1939;
  t1970 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1958 * t187 - 0.16e2 / 0.9e1 * t733 * t519 + 0.4e1 / 0.9e1 * t1963 * t187 + 0.4e1 / 0.3e1 * t54 * t1966);
  t1971 = t186 * t1970;
  t1972 = t96 * t1971;
  t1974 = -0.4e1 / 0.3e1 * t1920 + t1923 - 0.4e1 / 0.3e1 * t1924 + t1927 / 0.2e1 + t1945 / 0.2e1 + 0.44e2 / 0.9e1 * t1947 - 0.8e1 / 0.3e1 * t1949 - 0.8e1 / 0.3e1 * t1951 + t1954 + t1956 / 0.2e1 + t1972 / 0.2e1 + t1565;
  t1996 = t139 * t1974 + 0.2e1 * t209 * t962 + 0.4e1 * t340 * t744 + 0.2e1 / 0.9e1 * t975 * t223 + 0.3e1 / 0.8e1 * t978 * t223 + 0.5e1 / 0.9e1 * t981 * t223 + 0.55e2 / 0.72e2 * t985 * t223 + 0.3e1 / 0.8e1 * t988 * t248 + 0.5e1 / 0.9e1 * t991 * t248 + 0.55e2 / 0.72e2 * t995 * t248 + 0.3e1 / 0.4e1 * t998 * t199;
  t2003 = t1943 * t46;
  t2010 = t1970 * t46;
  t2013 = -t214 * t877 / 0.3e1 + t33 * t2003 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t220 - 0.2e1 / 0.3e1 * t348 * t762 + t51 * t2010 / 0.4e1;
  t2037 = -0.2e1 / 0.3e1 * t1920 + t1923 / 0.2e1 - 0.2e1 / 0.3e1 * t1924 + t1927 / 0.4e1 + t1945 / 0.4e1 + 0.22e2 / 0.9e1 * t1947 - 0.4e1 / 0.3e1 * t1949 - 0.4e1 / 0.3e1 * t1951 + t1954 / 0.2e1 + t1956 / 0.4e1 + t1972 / 0.4e1;
  t2044 = 0.1e2 / 0.9e1 * t1001 * t199 + 0.55e2 / 0.36e2 * t1004 * t199 + t68 * t2013 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t898 + 0.5e1 / 0.3e1 * t367 * t765 + t81 * t2013 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t898 + 0.11e2 / 0.6e1 * t372 * t765 + t85 * t2037 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t937 + 0.3e1 / 0.2e1 * t382 * t797;
  t2067 = t105 * t2037 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t937 + 0.5e1 / 0.3e1 * t387 * t797 + t110 * t2037 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t937 + 0.11e2 / 0.6e1 * t392 * t797 + t115 * t2037 / 0.2e1 + t266 * t937 + 0.2e1 * t397 * t797 + t119 * t1974 + 0.3e1 / 0.2e1 * t168 * t962;
  t2088 = 0.3e1 * t400 * t744 + t133 * t1974 + 0.5e1 / 0.3e1 * t201 * t962 + 0.1e2 / 0.3e1 * t332 * t744 + t136 * t1974 + 0.11e2 / 0.6e1 * t205 * t962 + 0.11e2 / 0.3e1 * t336 * t744 + t30 * t2013 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t898 + 0.4e1 / 0.3e1 * t357 * t765 + t64 * t2013 / 0.2e1;
  t2098 = 0.3e1 / 0.4e1 * t231 * t898 + 0.3e1 / 0.2e1 * t362 * t765 - t1591 - t1854 - t1595 - t1855 - t1599 + 0.28e2 / 0.3e1 * t1609 + 0.7e1 * t1611 + 0.32e2 / 0.3e1 * t1620 + 0.8e1 * t1622;
  t2107 = 0.12e2 * t1632 + 0.9e1 * t1634 + 0.4e2 / 0.3e1 * t1643 + 0.1e2 * t1645 - t1871 - t1650 - t1872 + 0.18e2 * t1875 + 0.2e2 * t1879 + 0.14e2 * t1883 + 0.16e2 * t1887;
  tv3rho32 = t1909 + t1918 + t1996 + t2044 + t2067 + t2088 + t2098 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 2] += tv3rho32;

  t2116 = 0.1e1 / t19;
  t2121 = t141 * t1343;
  t2124 = t147 * t1347;
  t2127 = t150 * t2116;
  t2130 = t153 * t50;
  t2142 = -0.7e1 / 0.6e1 * t1893 - 0.7e1 / 0.6e1 * t1895 - 0.8e1 / 0.3e1 * t1897 - 0.8e1 / 0.3e1 * t1899 - 0.9e1 / 0.2e1 * t1901 - 0.9e1 / 0.2e1 * t1903 - 0.2e2 / 0.3e1 * t1905 - 0.2e2 / 0.3e1 * t1907 - t1426 - t1428 - t1432;
  t2148 = t1240 * t876;
  t2149 = t89 * t2148;
  t2151 = t868 * t310;
  t2157 = -0.6e1 * t269 - 0.6e1 * t1465;
  t2161 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1458 * t2151 + 0.4e1 / 0.3e1 * t716 * t872 + 0.4e1 / 0.3e1 * t42 * t2157);
  t2162 = t177 * t2161;
  t2163 = t89 * t2162;
  t2165 = t922 * rho[1];
  t2167 = 0.1e1 / t25 / t2165;
  t2168 = sigma[2] * t2167;
  t2169 = t2168 * t98;
  t2171 = t925 * t327;
  t2173 = t320 * t931;
  t2175 = t320 * t934;
  t2177 = t1318 * t894;
  t2178 = t96 * t2177;
  t2180 = t887 * t323;
  t2185 = -t2157;
  t2189 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1476 * t2180 + 0.4e1 / 0.3e1 * t733 * t890 + 0.4e1 / 0.3e1 * t54 * t2185);
  t2190 = t186 * t2189;
  t2191 = t96 * t2190;
  t2193 = 0.3e1 / 0.2e1 * t2149 + t2163 / 0.2e1 - 0.308e3 / 0.27e2 * t2169 + 0.44e2 / 0.3e1 * t2171 - 0.4e1 * t2173 - 0.4e1 * t2175 + 0.3e1 / 0.2e1 * t2178 + t2191 / 0.2e1 + t1565;
  t2197 = t2161 * t46;
  t2201 = 0.1e1 / t11 / t922;
  t2202 = t49 * t2201;
  t2208 = t2189 * t46;
  t2211 = t33 * t2197 / 0.4e1 - 0.7e2 / 0.27e2 * t2202 * t57 + 0.7e1 / 0.3e1 * t882 * t351 - t348 * t895 + t51 * t2208 / 0.4e1;
  t2220 = -t1434 + 0.7e1 * t1672 + 0.8e1 * t1674 + 0.9e1 * t1676 + 0.1e2 * t1678 + t139 * t2193 + 0.6e1 * t340 * t962 + t68 * t2211 / 0.2e1 + 0.5e1 / 0.2e1 * t367 * t898 + t81 * t2211 / 0.2e1 + 0.11e2 / 0.4e1 * t372 * t898;
  t2229 = 0.3e1 / 0.4e1 * t2149 + t2163 / 0.4e1 - 0.154e3 / 0.27e2 * t2169 + 0.22e2 / 0.3e1 * t2171 - 0.2e1 * t2173 - 0.2e1 * t2175 + 0.3e1 / 0.4e1 * t2178 + t2191 / 0.4e1;
  t2250 = t85 * t2229 / 0.2e1 + 0.9e1 / 0.4e1 * t382 * t937 + t105 * t2229 / 0.2e1 + 0.5e1 / 0.2e1 * t387 * t937 + t110 * t2229 / 0.2e1 + 0.11e2 / 0.4e1 * t392 * t937 + t115 * t2229 / 0.2e1 + 0.3e1 * t397 * t937 + t119 * t2193 + 0.9e1 / 0.2e1 * t400 * t962 + t133 * t2193;
  t2287 = t29 * t1347;
  t2290 = t63 * t2116;
  t2293 = t67 * t50;
  t2296 = 0.1e1 / t5;
  t2297 = t71 * t2296;
  t2300 = 0.55e2 / 0.24e2 * t985 * t354 + 0.9e1 / 0.8e1 * t988 * t378 + 0.5e1 / 0.3e1 * t991 * t378 + 0.55e2 / 0.24e2 * t995 * t378 + 0.9e1 / 0.4e1 * t998 * t330 + 0.1e2 / 0.3e1 * t1001 * t330 + 0.55e2 / 0.12e2 * t1004 * t330 - 0.4e1 / 0.27e2 * t2287 * t60 - 0.3e1 / 0.16e2 * t2290 * t60 - 0.5e1 / 0.27e2 * t2293 * t60 - 0.55e2 / 0.432e3 * t2297 * t60;
  t2302 = t84 * t2116;
  t2305 = t104 * t50;
  t2308 = t109 * t2296;
  t2311 = t118 * t2116;
  t2314 = t132 * t50;
  t2317 = t135 * t2296;
  t2320 = -0.3e1 / 0.16e2 * t2302 * t101 - 0.5e1 / 0.27e2 * t2305 * t101 - 0.55e2 / 0.432e3 * t2308 * t101 - 0.3e1 / 0.8e1 * t2311 * t130 - 0.1e2 / 0.27e2 * t2314 * t130 - 0.55e2 / 0.216e3 * t2317 * t130 - t1591 - t1593 - t1595 - t1597 - t1599;
  t2329 = -t1648 - t1650 - t1652 + 0.36e2 * t1873 + 0.27e2 * t1875 + 0.4e2 * t1877 + 0.3e2 * t1879 + 0.28e2 * t1881 + 0.21e2 * t1883 + 0.32e2 * t1885 + 0.24e2 * t1887;
  tv3rho33 = t2329 + t2320 + t2300 + t2250 + t2220 + t2142 + 0.6e1 * t1656 + 0.3e1 * t1658 + 0.5e1 * t332 * t962 + t136 * t2193 + 0.11e2 / 0.2e1 * t336 * t962 + t30 * t2211 / 0.2e1 + 0.2e1 * t357 * t898 + t64 * t2211 / 0.2e1 + 0.9e1 / 0.4e1 * t362 * t898 + 0.2e1 / 0.3e1 * t975 * t354 + 0.9e1 / 0.8e1 * t978 * t354 + 0.5e1 / 0.3e1 * t981 * t354 - 0.35e2 / 0.216e3 * t2121 * t145 - 0.8e1 / 0.27e2 * t2124 * t145 - 0.3e1 / 0.8e1 * t2127 * t145 - 0.1e2 / 0.27e2 * t2130 * t145 - 0.35e2 / 0.216e3 * t1 * t1343 - 0.8e1 / 0.27e2 * t8 * t1347 - 0.3e1 / 0.8e1 * t15 * t2116 - 0.1e2 / 0.27e2 * t22 * t50;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 3] += tv3rho33;

  t2333 = t630 * t44 * t46;
  t2341 = t213 * t182 * t46;
  t2346 = t105 * t173;
  t2351 = t110 * t173;
  t2356 = t115 * t173;
  t2362 = t32 * t525 * t46;
  t2369 = 0.7e1 / 0.36e2 * t427 * t2333 + 0.7e1 / 0.36e2 * t430 * t2333 + 0.7e1 / 0.36e2 * t419 * t2333 - t427 * t2341 / 0.6e1 - t430 * t2341 / 0.6e1 - 0.2e1 / 0.3e1 * t2346 * t183 + t1038 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2351 * t183 + t1066 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2356 * t183 + t1069 * t526 / 0.8e1 + t419 * t2362 / 0.16e2 + t424 * t2362 / 0.16e2 + t427 * t2362 / 0.16e2;
  t2372 = t85 * t173;
  t2384 = t88 * t510 * t45;
  t2388 = t504 * t90 * t45;
  t2403 = t430 * t2362 / 0.16e2 - 0.2e1 / 0.3e1 * t2372 * t183 + t1035 * t526 / 0.8e1 - t419 * t2341 / 0.6e1 - t424 * t2341 / 0.6e1 + 0.7e1 / 0.36e2 * t424 * t2333 + t105 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2388 + t110 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2388 + t115 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2388 + t85 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2388;
  t2406 = t418 * t182 * t46;
  t2423 = t63 * t1114;
  t2426 = t67 * t1118;
  t2429 = t71 * t1378;
  t2432 = t29 * t1110;
  t2437 = t84 / t2 / t171;
  t2440 = 0.1e1 / t171;
  t2441 = t104 * t2440;
  t2444 = 0.5e1 / 0.24e2 * t1060 * t2406 + 0.11e2 / 0.48e2 * t1063 * t2406 + 0.3e1 / 0.8e1 * t1107 * t183 + 0.5e1 / 0.12e2 * t1111 * t183 + 0.11e2 / 0.24e2 * t1115 * t183 + t1119 * t183 / 0.2e1 + t1052 * t2406 / 0.6e1 + 0.3e1 / 0.16e2 * t1057 * t2406 - 0.13e2 / 0.64e2 * t2423 * t1054 - 0.5e1 / 0.24e2 * t2426 * t1054 - 0.121e3 / 0.576e3 * t2429 * t1054 - 0.7e1 / 0.36e2 * t2432 * t1054 - 0.29e2 / 0.64e2 * t2437 * t91 - 0.35e2 / 0.72e2 * t2441 * t91;
  t2446 = 0.1e1 / t74 / t86;
  t2447 = t109 * t2446;
  t2450 = t113 * t88;
  t2451 = t2450 * t91;
  t2454 = 0.2e1 * t138 * t444;
  t2456 = t173 * t44;
  t2462 = 0.88e2 / 0.9e1 * t571;
  t2463 = 0.22e2 / 0.9e1 * t2388 - 0.8e1 / 0.3e1 * t2456 * t712 + t2384 / 0.2e1 + t1088 * t1706 / 0.2e1 - t2462;
  t2482 = -0.33e2 / 0.64e2 * t2447 * t91 - 0.13e2 / 0.24e2 * t2451 + t2454 + t119 * t2463 + 0.3e1 * t168 * t1092 + t133 * t2463 + 0.1e2 / 0.3e1 * t201 * t1092 + t136 * t2463 + 0.11e2 / 0.3e1 * t205 * t1092 + t139 * t2463 + 0.4e1 * t209 * t1092 + 0.3e1 / 0.4e1 * t610 * t444 + 0.1e2 / 0.9e1 * t613 * t444 + 0.55e2 / 0.36e2 * t618 * t444;
  tv3rho2sigma0 = t2369 + t2403 + t2444 + t2482;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t168 * t196;
  t2489 = 0.176e3 / 0.9e1 * t119 * t571;
  t2492 = t201 * t196;
  t2495 = 0.176e3 / 0.9e1 * t133 * t571;
  t2498 = t205 * t196;
  t2501 = 0.176e3 / 0.9e1 * t136 * t571;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t209 * t196;
  t2507 = 0.176e3 / 0.9e1 * t139 * t571;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t610 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t613 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t618 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t2511 = t50 * t542 * t46;
  t2514 = t251 * t95;
  t2519 = t256 * t95;
  t2524 = t261 * t95;
  t2529 = t266 * t95;
  t2546 = t591 * t454;
  t2549 = t594 * t454;
  t2552 = t598 * t454;
  t2555 = t588 * t454;
  t2558 = t1179 * t543 / 0.8e1 + t466 * t2511 / 0.16e2 + 0.3e1 / 0.8e1 * t2514 * t191 + t1163 * t543 / 0.8e1 + 0.5e1 / 0.12e2 * t2519 * t191 + t1168 * t543 / 0.8e1 + 0.11e2 / 0.24e2 * t2524 * t191 + t1174 * t543 / 0.8e1 + t2529 * t191 / 0.2e1 + t1139 * t1143 / 0.6e1 + t455 * t2511 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2511 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2511 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + 0.3e1 / 0.64e2 * t2546 * t457 + 0.5e1 / 0.72e2 * t2549 * t457 + 0.55e2 / 0.576e3 * t2552 * t457 + t2555 * t457 / 0.36e2;
  t2560 = t95 * t529 * t45;
  t2575 = t113 * t95;
  t2576 = t2575 * t98;
  t2579 = 0.2e1 * t138 * t480;
  t2591 = t2560 / 0.2e1 + t1184 * t1734 / 0.2e1 - t2462;
  t2602 = t115 * t2560 / 0.8e1 + 0.3e1 / 0.64e2 * t601 * t470 + t85 * t2560 / 0.8e1 + 0.5e1 / 0.72e2 * t604 * t470 + t105 * t2560 / 0.8e1 + 0.55e2 / 0.576e3 * t607 * t470 + t110 * t2560 / 0.8e1 + t2576 / 0.8e1 + t2579 + 0.3e1 / 0.4e1 * t610 * t480 + 0.1e2 / 0.9e1 * t613 * t480 + 0.55e2 / 0.36e2 * t618 * t480 + 0.3e1 * t168 * t1187 + t119 * t2591 + 0.1e2 / 0.3e1 * t201 * t1187 + t133 * t2591 + 0.11e2 / 0.3e1 * t205 * t1187 + t136 * t2591 + 0.4e1 * t209 * t1187 + t139 * t2591;
  tv3rho2sigma2 = t2558 + t2602;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t2606 = t213 * t313 * t46;
  t2624 = t32 * t723 * t46;
  t2627 = t382 * t88;
  t2634 = t387 * t88;
  t2637 = -t1199 * t1078 / 0.9e1 - t419 * t2606 / 0.12e2 - t1206 * t1078 / 0.8e1 - t424 * t2606 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1078 - t427 * t2606 / 0.12e2 + t1069 * t713 / 0.8e1 + t1069 * t724 / 0.8e1 + 0.11e2 / 0.96e2 * t1216 * t1030 + t430 * t2624 / 0.16e2 + 0.3e1 / 0.16e2 * t2627 * t183 + t1035 * t713 / 0.8e1 + t1035 * t724 / 0.8e1 + 0.5e1 / 0.24e2 * t2634 * t183;
  t2642 = t392 * t88;
  t2649 = t397 * t88;
  t2668 = t1038 * t713 / 0.8e1 + t1038 * t724 / 0.8e1 + 0.11e2 / 0.48e2 * t2642 * t183 + t1066 * t713 / 0.8e1 + t1066 * t724 / 0.8e1 + t2649 * t183 / 0.4e1 + t1199 * t1030 / 0.12e2 + t419 * t2624 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1030 + t424 * t2624 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1030 + t427 * t2624 / 0.16e2 - 0.11e2 / 0.72e2 * t1216 * t1078 - t430 * t2606 / 0.12e2;
  t2687 = t418 * t313 * t46;
  t2700 = -t2372 * t314 / 0.3e1 - t2346 * t314 / 0.3e1 - t2351 * t314 / 0.3e1 - t2356 * t314 / 0.3e1 - t382 * t1042 / 0.4e1 - 0.5e1 / 0.18e2 * t387 * t1042 - 0.11e2 / 0.36e2 * t392 * t1042 - t397 * t1042 / 0.3e1 + t1052 * t2687 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t2687 + 0.5e1 / 0.48e2 * t1060 * t2687 + 0.11e2 / 0.96e2 * t1063 * t2687 + 0.3e1 / 0.16e2 * t1107 * t314 + 0.5e1 / 0.24e2 * t1111 * t314;
  t2709 = t88 * t182;
  t2712 = t45 * t723;
  t2715 = -0.4e1 / 0.3e1 * t2456 * t1240 + t2709 * t1240 / 0.2e1 + t1088 * t2712 / 0.2e1 - t2462;
  t2734 = 0.11e2 / 0.48e2 * t1115 * t314 + t1119 * t314 / 0.4e1 + 0.11e2 / 0.6e1 * t336 * t1092 + t136 * t2715 + 0.11e2 / 0.6e1 * t205 * t1243 + 0.2e1 * t340 * t1092 + t139 * t2715 + 0.2e1 * t209 * t1243 + 0.3e1 / 0.2e1 * t400 * t1092 + t119 * t2715 + 0.3e1 / 0.2e1 * t168 * t1243 + 0.5e1 / 0.3e1 * t332 * t1092 + t133 * t2715 + 0.5e1 / 0.3e1 * t201 * t1243;
  tv3rho2sigma3 = t2637 + t2668 + t2700 + t2734;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t400 * t196;
  t2739 = t332 * t196;
  t2742 = t336 * t196;
  t2745 = t340 * t196;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t2750 = t85 * t319;
  t2759 = t105 * t319;
  t2768 = t110 * t319;
  t2777 = t115 * t319;
  t2780 = 0.11e2 / 0.96e2 * t1156 * t1283 - t2750 * t191 / 0.3e1 + t1163 * t730 / 0.8e1 + t1163 * t741 / 0.8e1 + 0.3e1 / 0.16e2 * t2514 * t327 - t2759 * t191 / 0.3e1 + t1168 * t730 / 0.8e1 + t1168 * t741 / 0.8e1 + 0.5e1 / 0.24e2 * t2519 * t327 - t2768 * t191 / 0.3e1 + t1174 * t730 / 0.8e1 + t1174 * t741 / 0.8e1 + 0.11e2 / 0.48e2 * t2524 * t327 - t2777 * t191 / 0.3e1;
  t2784 = t50 * t740 * t46;
  t2796 = t347 * t190 * t46;
  t2813 = t1179 * t730 / 0.8e1 + t460 * t2784 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1283 + t463 * t2784 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1283 + t466 * t2784 / 0.16e2 - t466 * t2796 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1301 + t1179 * t741 / 0.8e1 + t2529 * t327 / 0.4e1 + t455 * t2784 / 0.16e2 + t1139 * t1283 / 0.12e2 - t455 * t2796 / 0.12e2 - t1139 * t1301 / 0.9e1;
  t2836 = t454 * t190 * t46;
  t2845 = -t460 * t2796 / 0.12e2 - t1146 * t1301 / 0.8e1 - t463 * t2796 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1301 + 0.11e2 / 0.48e2 * t1344 * t191 + t1348 * t191 / 0.4e1 - t251 * t1264 / 0.4e1 - 0.5e1 / 0.18e2 * t256 * t1264 - 0.11e2 / 0.36e2 * t261 * t1264 - t266 * t1264 / 0.3e1 + t1274 * t2836 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t2836 + 0.5e1 / 0.48e2 * t1311 * t2836 + 0.11e2 / 0.96e2 * t1314 * t2836;
  t2852 = t319 * t56;
  t2855 = t95 * t190;
  t2858 = t45 * t740;
  t2861 = -0.4e1 / 0.3e1 * t2852 * t729 + t2855 * t1318 / 0.2e1 + t1184 * t2858 / 0.2e1 - t2462;
  t2880 = 0.3e1 / 0.16e2 * t1336 * t191 + 0.5e1 / 0.24e2 * t1340 * t191 + 0.5e1 / 0.3e1 * t332 * t1187 + t136 * t2861 + 0.11e2 / 0.6e1 * t205 * t1321 + 0.11e2 / 0.6e1 * t336 * t1187 + t139 * t2861 + 0.2e1 * t209 * t1321 + 0.2e1 * t340 * t1187 + t119 * t2861 + 0.3e1 / 0.2e1 * t168 * t1321 + 0.3e1 / 0.2e1 * t400 * t1187 + t133 * t2861 + 0.5e1 / 0.3e1 * t201 * t1321;
  tv3rho2sigma5 = t2780 + t2813 + t2845 + t2880;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t2893 = t32 * t876 * t46;
  t2904 = t975 * t418;
  t2907 = t978 * t418;
  t2910 = t981 * t418;
  t2913 = t985 * t418;
  t2928 = 0.5e1 / 0.12e2 * t2634 * t314 + t1038 * t919 / 0.8e1 + 0.11e2 / 0.24e2 * t2642 * t314 + t1066 * t919 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2893 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t424 * t2893 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2893 / 0.16e2 + t2904 * t421 / 0.36e2 + 0.3e1 / 0.64e2 * t2907 * t421 + 0.5e1 / 0.72e2 * t2910 * t421 + 0.55e2 / 0.576e3 * t2913 * t421 + t2649 * t314 / 0.2e1 + t1069 * t919 / 0.8e1 + 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2893 / 0.16e2 + 0.3e1 / 0.8e1 * t2627 * t314 + t1035 * t919 / 0.8e1;
  t2930 = t88 * t915 * t45;
  t2949 = t45 * t876;
  t2952 = t2930 / 0.2e1 + t1088 * t2949 / 0.2e1 - t2462;
  t2969 = t115 * t2930 / 0.8e1 + 0.3e1 / 0.64e2 * t988 * t434 + t85 * t2930 / 0.8e1 + 0.5e1 / 0.72e2 * t991 * t434 + t105 * t2930 / 0.8e1 + 0.55e2 / 0.576e3 * t995 * t434 + t110 * t2930 / 0.8e1 + t2451 / 0.8e1 + 0.3e1 * t400 * t1243 + t119 * t2952 + 0.1e2 / 0.3e1 * t332 * t1243 + t133 * t2952 + 0.11e2 / 0.3e1 * t336 * t1243 + t136 * t2952 + 0.4e1 * t340 * t1243 + t139 * t2952 + 0.3e1 / 0.4e1 * t998 * t444 + 0.1e2 / 0.9e1 * t1001 * t444 + 0.55e2 / 0.36e2 * t1004 * t444 + t2454;
  tv3rho2sigma6 = t2928 + t2969;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t998 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t1001 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t1004 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2995 = t50 * t894 * t46;
  t2999 = t881 * t56 * t46;
  t3003 = t347 * t326 * t46;
  t3014 = -0.2e1 / 0.3e1 * t2750 * t327 + t1163 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2759 * t327 + t1168 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2768 * t327 + t1174 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2777 * t327 + t460 * t2995 / 0.16e2 + 0.7e1 / 0.36e2 * t466 * t2999 - t455 * t3003 / 0.6e1 + 0.7e1 / 0.36e2 * t455 * t2999 + 0.7e1 / 0.36e2 * t460 * t2999 + 0.7e1 / 0.36e2 * t463 * t2999 - t460 * t3003 / 0.6e1;
  t3028 = t454 * t326 * t46;
  t3032 = t95 * t930 * t45;
  t3035 = t29 * t1339;
  t3038 = t63 * t1343;
  t3041 = t67 * t1347;
  t3044 = t71 * t2116;
  t3048 = t924 * t97 * t45;
  t3053 = -t463 * t3003 / 0.6e1 - t466 * t3003 / 0.6e1 + t1179 * t934 / 0.8e1 + t455 * t2995 / 0.16e2 + t463 * t2995 / 0.16e2 + t466 * t2995 / 0.16e2 + t1274 * t3028 / 0.6e1 + t115 * t3032 / 0.8e1 - 0.7e1 / 0.36e2 * t3035 * t1276 - 0.13e2 / 0.64e2 * t3038 * t1276 - 0.5e1 / 0.24e2 * t3041 * t1276 - 0.121e3 / 0.576e3 * t3044 * t1276 + 0.11e2 / 0.18e2 * t85 * t3048 + t85 * t3032 / 0.8e1;
  t3082 = 0.11e2 / 0.18e2 * t105 * t3048 + t105 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t3048 + t110 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t3048 + 0.3e1 / 0.16e2 * t1279 * t3028 + 0.5e1 / 0.24e2 * t1311 * t3028 + 0.11e2 / 0.48e2 * t1314 * t3028 + 0.3e1 / 0.8e1 * t1336 * t327 + 0.5e1 / 0.12e2 * t1340 * t327 + 0.11e2 / 0.24e2 * t1344 * t327 + t1348 * t327 / 0.2e1 - 0.13e2 / 0.24e2 * t2576 + 0.3e1 / 0.4e1 * t998 * t480;
  t3091 = t45 * t894;
  t3094 = 0.22e2 / 0.9e1 * t3048 - 0.8e1 / 0.3e1 * t2852 * t1318 + t3032 / 0.2e1 + t1184 * t3091 / 0.2e1 - t2462;
  t3109 = t84 / t4 / t317;
  t3112 = 0.1e1 / t317;
  t3113 = t104 * t3112;
  t3117 = 0.1e1 / t78 / t93;
  t3118 = t109 * t3117;
  t3121 = 0.1e2 / 0.9e1 * t1001 * t480 + 0.55e2 / 0.36e2 * t1004 * t480 + t119 * t3094 + 0.3e1 * t400 * t1321 + t133 * t3094 + 0.1e2 / 0.3e1 * t332 * t1321 + t136 * t3094 + 0.11e2 / 0.3e1 * t336 * t1321 + t139 * t3094 + t2579 + 0.4e1 * t340 * t1321 - 0.29e2 / 0.64e2 * t3109 * t98 - 0.35e2 / 0.72e2 * t3113 * t98 - 0.33e2 / 0.64e2 * t3118 * t98;
  tv3rho2sigma8 = t3014 + t3053 + t3082 + t3121;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1052 * t3124 / 0.24e2 + t1354 * t1078 / 0.24e2 - t1354 * t1030 / 0.32e2 - 0.3e1 / 0.64e2 * t1057 * t3124 + t1356 * t1078 / 0.24e2 - t1356 * t1030 / 0.32e2 - 0.5e1 / 0.96e2 * t1060 * t3124 + t1358 * t1078 / 0.24e2 - t1358 * t1030 / 0.32e2 - 0.11e2 / 0.192e3 * t1063 * t3124 + t1360 * t1078 / 0.24e2 - t1360 * t1030 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t226 * t1364;
  t3154 = t231 * t1364;
  t3159 = t236 * t1364;
  t3164 = t241 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t357 * t1353;
  t3174 = t362 * t1353;
  t3179 = t367 * t1353;
  t3184 = t372 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1274 * t3190 / 0.24e2 + t1365 * t1301 / 0.24e2 - t1365 * t1283 / 0.32e2 - 0.3e1 / 0.64e2 * t1279 * t3190 + t1367 * t1301 / 0.24e2 - t1367 * t1283 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t3190 + t1369 * t1301 / 0.24e2 - t1369 * t1283 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t3190 + t1371 * t1301 / 0.24e2 - t1371 * t1283 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t171, t173, t174, t175, t177, t178, t179;
  double t182, t183, t184, t186, t187, t190, t191, t192;
  double t194, t196, t198, t199, t201, t205, t209, t213;
  double t214, t217, t220, t223, t226, t231, t236, t241;
  double t244, t248, t251, t256, t261, t266, t269, t270;
  double t272, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t332, t336, t340, t343, t347;
  double t348, t351, t354, t357, t362, t367, t372, t378;
  double t381, t382, t387, t392, t397, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t485, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t569, t571, t573, t574, t576, t588, t591;
  double t594, t597, t598, t601, t604, t607, t610, t613;
  double t616, t618, t622, t624, t626, t628, t630, t631;
  double t636, t639, t642, t657, t659, t662, t664, t666;
  double t667, t670, t672, t675, t676, t677, t679, t681;
  double t683, t685, t687, t689, t691, t692, t695, t697;
  double t699, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t757;
  double t762, t765, t780, t797, t818, t829, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t868, t872, t876;
  double t877, t881, t882, t887, t890, t894, t895, t898;
  double t915, t916, t917, t919, t920, t922, t924, t925;
  double t926, t928, t930, t931, t932, t934, t935, t937;
  double t950, t962, t975, t978, t981, t984, t985, t988;
  double t991, t994, t995, t998, t1001, t1004, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1035, t1038, t1042;
  double t1052, t1054, t1057, t1060, t1063, t1066, t1069, t1076;
  double t1078, t1088, t1091, t1092, t1106, t1107, t1110, t1111;
  double t1114, t1115, t1118, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1274, t1276, t1279;
  double t1283, t1301, t1306, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1378, t1383, t1385, t1393, t1397, t1400, t1403, t1404;
  double t1407, t1410, t1413, t1416, t1419, t1422, t1425, t1426;
  double t1427, t1428, t1429, t1431, t1432, t1433, t1434, t1450;
  double t1451, t1458, t1459, t1462, t1465, t1467, t1471, t1472;
  double t1476, t1477, t1480, t1483, t1487, t1488, t1491, t1496;
  double t1509, t1511, t1512, t1513, t1515, t1517, t1519, t1521;
  double t1522, t1524, t1525, t1527, t1528, t1530, t1531, t1533;
  double t1544, t1561, t1563, t1565, t1566, t1580, t1582, t1584;
  double t1586, t1588, t1589, t1591, t1592, t1593, t1595, t1596;
  double t1597, t1599, t1600, t1603, t1605, t1607, t1609, t1611;
  double t1613, t1616, t1618, t1620, t1622, t1624, t1627, t1629;
  double t1630, t1632, t1634, t1636, t1639, t1641, t1643, t1645;
  double t1647, t1648, t1650, t1651, t1652, t1653, tv3rho30, t1656;
  double t1658, t1659, t1660, t1661, t1662, t1669, t1672, t1674;
  double t1676, t1678, t1692, t1700, t1702, t1704, t1706, t1707;
  double t1708, t1710, t1711, t1712, t1715, t1726, t1727, t1728;
  double t1730, t1732, t1734, t1735, t1736, t1738, t1739, t1740;
  double t1743, t1754, t1755, t1756, t1758, t1772, t1779, t1784;
  double t1787, t1808, t1826, t1845, t1854, t1855, t1857, t1870;
  double t1871, t1872, t1873, t1875, t1877, t1879, t1881, t1883;
  double t1885, t1887, t1889, tv3rho31, t1893, t1895, t1897, t1899;
  double t1901, t1903, t1905, t1907, t1909, t1918, t1920, t1922;
  double t1923, t1924, t1926, t1927, t1929, t1934, t1939, t1943;
  double t1944, t1945, t1947, t1949, t1951, t1953, t1954, t1955;
  double t1956, t1958, t1963, t1966, t1970, t1971, t1972, t1974;
  double t1996, t2003, t2010, t2013, t2037, t2044, t2067, t2088;
  double t2098, t2107, tv3rho32, t2116, t2121, t2124, t2127, t2130;
  double t2142, t2148, t2149, t2151, t2157, t2161, t2162, t2163;
  double t2165, t2167, t2168, t2169, t2171, t2173, t2175, t2177;
  double t2178, t2180, t2185, t2189, t2190, t2191, t2193, t2197;
  double t2201, t2202, t2208, t2211, t2220, t2229, t2250, t2287;
  double t2290, t2293, t2296, t2297, t2300, t2302, t2305, t2308;
  double t2311, t2314, t2317, t2320, t2329, tv3rho33, t2333, t2341;
  double t2346, t2351, t2356, t2362, t2369, t2372, t2384, t2388;
  double t2403, t2406, t2423, t2426, t2429, t2432, t2437, t2440;
  double t2441, t2444, t2446, t2447, t2450, t2451, t2454, t2456;
  double t2462, t2463, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2511, t2514;
  double t2519, t2524, t2529, t2546, t2549, t2552, t2555, t2558;
  double t2560, t2575, t2576, t2579, t2591, t2602, tv3rho2sigma2, t2606;
  double t2624, t2627, t2634, t2637, t2642, t2649, t2668, t2687;
  double t2700, t2709, t2712, t2715, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2750, t2759, t2768, t2777, t2780;
  double t2784, t2796, t2813, t2836, t2845, t2852, t2855, t2858;
  double t2861, t2880, tv3rho2sigma5, t2893, t2904, t2907, t2910, t2913;
  double t2928, t2930, t2949, t2952, t2969, tv3rho2sigma6, tv3rho2sigma7, t2995;
  double t2999, t3003, t3014, t3028, t3032, t3035, t3038, t3041;
  double t3044, t3048, t3053, t3082, t3091, t3094, t3109, t3112;
  double t3113, t3117, t3118, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  double t3239, t3241, t3248, t3257, t3259, t3261, t3263, t3265;
  double t3267, t3269, t3271, t3274, t3275, t3277, t3278, t3284;
  double t3289, t3291, t3295, t3297, t3299, t3301, t3304, t3305;
  double t3307, t3308, t3314, t3323, t3325, t3327, t3342, t3381;
  double t3385, t3386, t3388, t3395, t3396, t3397, t3398, t3420;
  double t3436, t3437, t3438, t3440, t3442, t3444, t3446, t3448;
  double t3450, t3452, t3454, t3457, t3458, t3476, t3501, t3510;
  double t3512, t3514, t3519, t3521, t3523, t3525, t3530, t3532;
  double t3534, t3536, t3538, t3540, t3541, t3542, t3543, t3545;
  double t3546, t3547, t3549, t3550, t3551, t3553, t3554, t3555;
  double t3557, t3561, t3562, t3564, t3566, t3568, t3570, t3572;
  double t3577, t3579, t3581, t3583, t3585, t3587, t3589, t3591;
  double tv4rho40, t3594, t3595, t3596, t3598, t3599, t3600, t3602;
  double t3603, t3604, t3606, t3607, t3608, t3613, t3615, t3617;
  double t3619, t3621, t3624, t3627, t3653, t3655, t3657, t3659;
  double t3661, t3663, t3665, t3668, t3671, t3697, t3699, t3701;
  double t3703, t3705, t3707, t3709, t3715, t3729, t3770, t3773;
  double t3801, t3823, t3824, t3825, t3826, t3827, t3830, t3831;
  double t3832, t3833, t3856, t3862, t3864, t3866, t3868, t3870;
  double t3872, t3874, t3876, t3884, t3885, t3886, t3887, t3888;
  double t3892, t3897, t3899, t3900, tv4rho41, t3903, t3905, t3907;
  double t3909, t3911, t3913, t3915, t3917, t3925, t3961, t3994;
  double t3998, t4008, t4011, t4013, t4015, t4017, t4019, t4022;
  double t4024, t4026, t4029, t4032, t4035, t4037, t4039, t4041;
  double t4043, t4045, t4047, t4049, t4052, t4055, t4057, t4059;
  double t4070, t4089, t4090, t4114, t4145, t4163, t4165, t4167;
  double t4175, t4190, t4193, t4194, t4199, t4215, t4227, tv4rho42;
  double t4234, t4236, t4238, t4240, t4242, t4244, t4246, t4248;
  double t4250, t4257, t4283, t4298, t4301, t4304, t4306, t4309;
  double t4329, t4333, t4335, t4337, t4339, t4341, t4343, t4345;
  double t4347, t4350, t4353, t4356, t4378, t4380, t4382, t4410;
  double t4412, t4442, t4453, t4479, t4492, t4496, tv4rho43, t4506;
  double t4522, t4537, t4550, t4552, t4555, t4557, t4562, t4568;
  double t4572, t4574, t4580, t4582, t4584, t4586, t4588, t4590;
  double t4592, t4594, t4597, t4599, t4604, t4613, t4615, t4617;
  double t4638, t4641, t4668, t4681, t4707, t4746, t4768, t4777;
  double tv4rho44, t4789, t4811, t4820, t4828, t4841, t4845, t4855;
  double t4859, t4867, t4876, t4879, t4889, t4897, t4909, t4929;
  double t4932, t4947, t4950, t4960, t4961, t4987, tv4rho3sigma0, t4992;
  double t4994, t4997, t5000, t5002, t5005, t5008, t5010, t5013;
  double t5014, t5015, t5016, t5019, tv4rho3sigma1, t5020, t5039, t5048;
  double t5055, t5064, t5077, t5080, t5110, t5112, t5125, t5142;
  double tv4rho3sigma2, t5145, t5170, t5179, t5197, t5210, t5216, t5227;
  double t5251, t5254, t5256, t5283, t5306, t5311, t5319, t5330;
  double t5333, t5339, t5358, t5377, tv4rho3sigma3, t5380, t5384, t5388;
  double t5392, t5394, tv4rho3sigma4, t5397, t5412, t5415, t5422, t5434;
  double t5449, t5473, t5494, t5496, t5499, t5502, t5505, t5515;
  double t5528, t5553, t5560, t5570, t5584, t5588, t5610, tv4rho3sigma5;
  double t5614, t5626, t5639, t5656, t5665, t5675, t5690, t5714;
  double t5719, t5735, t5742, t5751, t5768, t5785, t5794, t5800;
  double t5822, tv4rho3sigma6, t5825, t5829, t5833, tv4rho3sigma7, t5850, t5865;
  double t5892, t5900, t5906, t5919, t5922, t5937, t5949, t5952;
  double t5965, t5979, t6006, t6014, t6030, t6038, t6045, t6047;
  double t6071, tv4rho3sigma8, t6103, t6107, t6134, t6161, t6181, t6192;
  double tv4rho3sigma9, tv4rho3sigma10, t6211, t6235, t6247, t6252, t6270, t6279;
  double t6287, t6293, t6303, t6346, t6379, t6405, tv4rho3sigma11, t6409;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t6483, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6521, tv4rho2sigma211, tv4rho2sigma212, tv4rho2sigma213;
  double tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t6591, tv4rho2sigma217, t6633, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t6699, tv4rhosigma319, t6726, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, t6738, tv4sigma414;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->out_dim->zk + 0] += tzk0;

  t168 = t118 * t16;
  t171 = t86 * rho[0];
  t173 = 0.1e1 / t23 / t171;
  t174 = sigma[0] * t173;
  t175 = t174 * t91;
  t177 = t44 * t45;
  t178 = t34 * t144;
  t179 = t36 - t178;
  t182 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t179);
  t183 = t177 * t182;
  t184 = t89 * t183;
  t186 = t56 * t45;
  t187 = -t179;
  t190 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t187);
  t191 = t186 * t190;
  t192 = t96 * t191;
  t194 = t124 * t35;
  t196 = 0.1e1 / t126 / t194;
  t198 = 0.8e1 / 0.3e1 * t123 * t196;
  t199 = -0.2e1 / 0.3e1 * t175 + t184 / 0.2e1 + t192 / 0.2e1 + t198;
  t201 = t132 * t23;
  t205 = t135 * t74;
  t209 = t138 * rho[0];
  t213 = 0.1e1 / t9 / t86;
  t214 = t31 * t213;
  t217 = t182 * t46;
  t220 = t190 * t46;
  t223 = -t214 * t47 / 0.3e1 + t33 * t217 / 0.4e1 + t51 * t220 / 0.4e1;
  t226 = t29 * t9;
  t231 = t63 * t16;
  t236 = t67 * t23;
  t241 = t71 * t74;
  t244 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.3e1 / 0.2e1 * t168 * t130 + t133 * t199 + 0.5e1 / 0.3e1 * t201 * t130 + t136 * t199 + 0.11e2 / 0.6e1 * t205 * t130 + t139 * t199 + 0.2e1 * t209 * t130 + t30 * t223 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t60 + t64 * t223 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t60 + t68 * t223 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t60 + t81 * t223 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t60;
  t248 = -t175 / 0.3e1 + t184 / 0.4e1 + t192 / 0.4e1;
  t251 = t84 * t16;
  t256 = t104 * t23;
  t261 = t109 * t74;
  t266 = t113 * rho[0];
  t269 = 0.1e1 / t194;
  t270 = t143 * t269;
  t272 = 0.2e1 * t154 * t270;
  t275 = 0.2e1 * t142 * t178;
  t277 = 0.2e1 * t142 * t270;
  t279 = 0.2e1 * t148 * t178;
  t281 = 0.2e1 * t148 * t270;
  t283 = 0.2e1 * t151 * t178;
  t285 = 0.2e1 * t151 * t270;
  t287 = 0.2e1 * t154 * t178;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = t275 - t277 + t279 - t281 + t283 - t285 + t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t244 + t85 * t248 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t101 + t105 * t248 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t101 + t110 * t248 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t101 + t115 * t248 / 0.2e1 + t266 * t101 + t119 * t199 - t272 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 0] += tvrho0;

  t310 = -t36 - t178;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t177 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t186 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t198;
  t332 = t132 * t25;
  t336 = t135 * t78;
  t340 = t138 * rho[1];
  t343 = t313 * t46;
  t347 = 0.1e1 / t11 / t93;
  t348 = t49 * t347;
  t351 = t326 * t46;
  t354 = t33 * t343 / 0.4e1 - t348 * t57 / 0.3e1 + t51 * t351 / 0.4e1;
  t357 = t29 * t11;
  t362 = t63 * t18;
  t367 = t67 * t25;
  t372 = t71 * t78;
  t378 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t381 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t133 * t330 + 0.5e1 / 0.3e1 * t332 * t130 + t136 * t330 + 0.11e2 / 0.6e1 * t336 * t130 + t139 * t330 + 0.2e1 * t340 * t130 + t30 * t354 / 0.2e1 + 0.2e1 / 0.3e1 * t357 * t60 + t64 * t354 / 0.2e1 + 0.3e1 / 0.4e1 * t362 * t60 + t68 * t354 / 0.2e1 + 0.5e1 / 0.6e1 * t367 * t60 + t81 * t354 / 0.2e1 + 0.11e2 / 0.12e2 * t372 * t60 + t85 * t378 / 0.2e1;
  t382 = t84 * t18;
  t387 = t104 * t25;
  t392 = t109 * t78;
  t397 = t113 * rho[1];
  t400 = t118 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145 - t275 - t277 - t279 - t281 - t283 - t285 - t287;
  tvrho1 = t381 + 0.3e1 / 0.4e1 * t382 * t101 + t105 * t378 / 0.2e1 + 0.5e1 / 0.6e1 * t387 * t101 + t110 * t378 / 0.2e1 + 0.11e2 / 0.12e2 * t392 * t101 + t115 * t378 / 0.2e1 + t397 * t101 + t119 * t330 + 0.3e1 / 0.2e1 * t400 * t130 - t272 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->out_dim->vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->out_dim->vsigma + 2] += tvsigma2;

  t485 = t113 * t101;
  t487 = 0.2e1 * t138 * t130;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t174 * t183;
  t510 = t182 * t182;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t179 * t179;
  t519 = t34 * t269;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t177 * t525;
  t527 = t89 * t526;
  t529 = t190 * t190;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t187 * t187;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t186 * t542;
  t544 = t96 * t543;
  t546 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t569 = t124 * t124;
  t571 = 0.1e1 / t126 / t569;
  t573 = 0.88e2 / 0.9e1 * t123 * t571;
  t574 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t573;
  t576 = t485 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.6e1 * t241 * t223 + t85 * t546 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t248 + t105 * t546 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t248 + t110 * t546 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t248 + t115 * t546 / 0.2e1 + 0.2e1 * t266 * t248 + t119 * t574;
  t588 = t29 * t491;
  t591 = t63 * t494;
  t594 = t67 * t497;
  t597 = 0.1e1 / t2;
  t598 = t71 * t597;
  t601 = t84 * t494;
  t604 = t104 * t497;
  t607 = t109 * t597;
  t610 = t118 * t494;
  t613 = t132 * t497;
  t616 = 0.3e1 * t168 * t199 + t133 * t574 + 0.1e2 / 0.3e1 * t201 * t199 + t136 * t574 + 0.11e2 / 0.3e1 * t205 * t199 + t139 * t574 + 0.4e1 * t209 * t199 + 0.2e1 / 0.9e1 * t588 * t60 + 0.3e1 / 0.8e1 * t591 * t60 + 0.5e1 / 0.9e1 * t594 * t60 + 0.55e2 / 0.72e2 * t598 * t60 + 0.3e1 / 0.8e1 * t601 * t101 + 0.5e1 / 0.9e1 * t604 * t101 + 0.55e2 / 0.72e2 * t607 * t101 + 0.3e1 / 0.4e1 * t610 * t130 + 0.1e2 / 0.9e1 * t613 * t130;
  t618 = t135 * t597;
  t622 = 0.2e1 * t142 * t144;
  t624 = 0.2e1 * t148 * t144;
  t626 = 0.2e1 * t151 * t144;
  t628 = 0.2e1 * t154 * t144;
  t630 = 0.1e1 / t9 / t171;
  t631 = t31 * t630;
  t636 = t525 * t46;
  t639 = t542 * t46;
  t642 = 0.7e1 / 0.9e1 * t631 * t47 - 0.2e1 / 0.3e1 * t214 * t217 + t33 * t636 / 0.4e1 + t51 * t639 / 0.4e1;
  t657 = t291 * t270;
  t659 = t150 * t494;
  t662 = t294 * t178;
  t664 = t294 * t270;
  t666 = 0.55e2 / 0.36e2 * t618 * t130 + t622 + t624 + t626 + t628 + t30 * t642 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t223 + t64 * t642 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t223 + t68 * t642 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t223 + t81 * t642 / 0.2e1 - 0.16e2 / 0.3e1 * t657 + 0.3e1 / 0.4e1 * t659 * t145 + 0.6e1 * t662 - 0.6e1 * t664;
  t667 = t153 * t497;
  t670 = t297 * t178;
  t672 = t297 * t270;
  t675 = 0.8e1 * t142 * t519;
  t676 = 0.1e1 / t569;
  t677 = t143 * t676;
  t679 = 0.6e1 * t142 * t677;
  t681 = 0.8e1 * t148 * t519;
  t683 = 0.6e1 * t148 * t677;
  t685 = 0.8e1 * t151 * t519;
  t687 = 0.6e1 * t151 * t677;
  t689 = 0.8e1 * t154 * t519;
  t691 = 0.6e1 * t154 * t677;
  t692 = t141 * t488;
  t695 = t288 * t178;
  t697 = t288 * t270;
  t699 = t147 * t491;
  t702 = t291 * t178;
  t704 = 0.1e2 / 0.9e1 * t667 * t145 + 0.2e2 / 0.3e1 * t670 - 0.2e2 / 0.3e1 * t672 - t675 + t679 - t681 + t683 - t685 + t687 - t689 + t691 + 0.7e1 / 0.36e2 * t692 * t145 + 0.14e2 / 0.3e1 * t695 - 0.14e2 / 0.3e1 * t697 + 0.4e1 / 0.9e1 * t699 * t145 + 0.16e2 / 0.3e1 * t702;
  tv2rho20 = t576 + t616 + t666 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 0] += tv2rho20;

  t710 = t174 * t314;
  t712 = t182 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t179 + 0.8e1 / 0.3e1 * t719 * t269);
  t724 = t177 * t723;
  t725 = t89 * t724;
  t727 = t320 * t191;
  t729 = t190 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t187 - 0.8e1 / 0.3e1 * t736 * t269);
  t741 = t186 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t573;
  t757 = t723 * t46;
  t762 = t740 * t46;
  t765 = -t214 * t343 / 0.3e1 + t33 * t757 / 0.4e1 - t348 * t220 / 0.3e1 + t51 * t762 / 0.4e1;
  t780 = 0.5e1 / 0.3e1 * t201 * t330 + 0.5e1 / 0.3e1 * t332 * t199 + t136 * t744 + 0.11e2 / 0.6e1 * t205 * t330 + 0.11e2 / 0.6e1 * t336 * t199 + t139 * t744 + 0.2e1 * t209 * t330 + 0.2e1 * t340 * t199 + t30 * t765 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t354 + 0.2e1 / 0.3e1 * t357 * t223 + t64 * t765 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t354 + 0.3e1 / 0.4e1 * t362 * t223 + t68 * t765 / 0.2e1;
  t797 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t818 = 0.5e1 / 0.6e1 * t236 * t354 + 0.5e1 / 0.6e1 * t367 * t223 + t81 * t765 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t354 + 0.11e2 / 0.12e2 * t372 * t223 + t85 * t797 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t378 + 0.3e1 / 0.4e1 * t382 * t248 + t105 * t797 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t378 + 0.5e1 / 0.6e1 * t387 * t248 + t110 * t797 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t378 + 0.11e2 / 0.12e2 * t392 * t248 + t115 * t797 / 0.2e1;
  t829 = t266 * t378 - t622 - t624 - t626 - t628 + 0.3e1 / 0.2e1 * t400 * t199 + t133 * t744 - 0.8e1 / 0.3e1 * t657 - 0.3e1 * t662 - 0.3e1 * t664 - 0.1e2 / 0.3e1 * t670 - 0.1e2 / 0.3e1 * t672 + t679 + t683 + t687;
  t837 = t404 * t178;
  t839 = t404 * t270;
  t841 = t407 * t178;
  t843 = t407 * t270;
  t845 = t410 * t178;
  t847 = t410 * t270;
  t849 = t413 * t178;
  t851 = t413 * t270;
  t853 = t691 - 0.7e1 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t697 - 0.8e1 / 0.3e1 * t702 + t397 * t248 + t119 * t744 + 0.3e1 / 0.2e1 * t168 * t330 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t818 + t829 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t485 + t487 + t622 + t624 + t626 + t628 + t675 + t679 + t681 + t683 + t685 + t687;
  t868 = t310 * t310;
  t872 = 0.2e1 * t144 + 0.2e1 * t519;
  t876 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t868 + 0.4e1 / 0.3e1 * t42 * t872);
  t877 = t876 * t46;
  t881 = 0.1e1 / t11 / t317;
  t882 = t49 * t881;
  t887 = t323 * t323;
  t890 = -t872;
  t894 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t887 + 0.4e1 / 0.3e1 * t54 * t890);
  t895 = t894 * t46;
  t898 = t33 * t877 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t57 - 0.2e1 / 0.3e1 * t348 * t351 + t51 * t895 / 0.4e1;
  t915 = t313 * t313;
  t916 = t915 * t45;
  t917 = t89 * t916;
  t919 = t177 * t876;
  t920 = t89 * t919;
  t922 = t93 * t93;
  t924 = 0.1e1 / t25 / t922;
  t925 = sigma[2] * t924;
  t926 = t925 * t98;
  t928 = t320 * t327;
  t930 = t326 * t326;
  t931 = t930 * t45;
  t932 = t96 * t931;
  t934 = t186 * t894;
  t935 = t96 * t934;
  t937 = t917 / 0.4e1 + t920 / 0.4e1 + 0.11e2 / 0.9e1 * t926 - 0.4e1 / 0.3e1 * t928 + t932 / 0.4e1 + t935 / 0.4e1;
  t950 = t689 + t691 + t30 * t898 / 0.2e1 + 0.4e1 / 0.3e1 * t357 * t354 + t64 * t898 / 0.2e1 + 0.3e1 / 0.2e1 * t362 * t354 + t68 * t898 / 0.2e1 + 0.5e1 / 0.3e1 * t367 * t354 + t81 * t898 / 0.2e1 + 0.11e2 / 0.6e1 * t372 * t354 + t85 * t937 / 0.2e1 + 0.3e1 / 0.2e1 * t382 * t378 + t105 * t937 / 0.2e1 + 0.5e1 / 0.3e1 * t387 * t378 + t110 * t937 / 0.2e1 + 0.11e2 / 0.6e1 * t392 * t378;
  t962 = t917 / 0.2e1 + t920 / 0.2e1 + 0.22e2 / 0.9e1 * t926 - 0.8e1 / 0.3e1 * t928 + t932 / 0.2e1 + t935 / 0.2e1 - t573;
  t975 = t29 * t858;
  t978 = t63 * t861;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t115 * t937 / 0.2e1 + 0.2e1 * t397 * t378 + t119 * t962 + 0.3e1 * t400 * t330 + t133 * t962 + 0.1e2 / 0.3e1 * t332 * t330 + t136 * t962 + 0.11e2 / 0.3e1 * t336 * t330 + t139 * t962 + 0.4e1 * t340 * t330 + 0.2e1 / 0.9e1 * t975 * t60 + 0.3e1 / 0.8e1 * t978 * t60 + 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101;
  t995 = t109 * t984;
  t998 = t118 * t861;
  t1001 = t132 * t864;
  t1004 = t135 * t984;
  t1015 = t141 * t855;
  t1018 = t147 * t858;
  t1021 = t150 * t861;
  t1024 = t153 * t864;
  t1027 = 0.55e2 / 0.72e2 * t995 * t101 + 0.3e1 / 0.4e1 * t998 * t130 + 0.1e2 / 0.9e1 * t1001 * t130 + 0.55e2 / 0.36e2 * t1004 * t130 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t867 + t950 + t994 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->out_dim->v2rho2 + 2] += tv2rho22;

  t1030 = t32 * t182 * t46;
  t1035 = t85 * t88;
  t1038 = t105 * t88;
  t1042 = t173 * t90 * t45;
  t1052 = t29 / rho[0];
  t1054 = t418 * t44 * t46;
  t1057 = t63 * t488;
  t1060 = t67 * t491;
  t1063 = t71 * t494;
  t1066 = t110 * t88;
  t1069 = t115 * t88;
  t1076 = t427 * t1030 / 0.16e2 + t430 * t1030 / 0.16e2 + t1035 * t183 / 0.8e1 + t1038 * t183 / 0.8e1 - t85 * t1042 / 0.6e1 - t105 * t1042 / 0.6e1 - t110 * t1042 / 0.6e1 - t115 * t1042 / 0.6e1 + t1052 * t1054 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t1054 + 0.5e1 / 0.48e2 * t1060 * t1054 + 0.11e2 / 0.96e2 * t1063 * t1054 + t1066 * t183 / 0.8e1 + t1069 * t183 / 0.8e1 + t419 * t1030 / 0.16e2 + t424 * t1030 / 0.16e2;
  t1078 = t213 * t44 * t46;
  t1088 = t88 * t44;
  t1091 = 0.8e1 / 0.3e1 * t196;
  t1092 = -0.2e1 / 0.3e1 * t1042 + t1088 * t712 / 0.2e1 + t1091;
  t1106 = 0.1e1 / t2 / t86;
  t1107 = t84 * t1106;
  t1110 = 0.1e1 / t86;
  t1111 = t104 * t1110;
  t1114 = 0.1e1 / t75;
  t1115 = t109 * t1114;
  t1118 = 0.1e1 / t24;
  t1119 = t113 * t1118;
  t1122 = -t424 * t1078 / 0.12e2 - t427 * t1078 / 0.12e2 - t430 * t1078 / 0.12e2 - t419 * t1078 / 0.12e2 + t119 * t1092 + 0.3e1 / 0.2e1 * t168 * t444 + t133 * t1092 + 0.5e1 / 0.3e1 * t201 * t444 + t136 * t1092 + 0.11e2 / 0.6e1 * t205 * t444 + t139 * t1092 + 0.2e1 * t209 * t444 + 0.3e1 / 0.32e2 * t1107 * t91 + 0.5e1 / 0.48e2 * t1111 * t91 + 0.11e2 / 0.96e2 * t1115 * t91 + t1119 * t91 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t196;
  t1130 = 0.16e2 / 0.3e1 * t133 * t196;
  t1134 = 0.16e2 / 0.3e1 * t136 * t196;
  t1138 = 0.16e2 / 0.3e1 * t139 * t196;
  tv2rhosigma1 = -0.3e1 * t168 * t128 + t1126 - 0.1e2 / 0.3e1 * t201 * t128 + t1130 - 0.11e2 / 0.3e1 * t205 * t128 + t1134 - 0.4e1 * t209 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t226 * t454;
  t1143 = t50 * t190 * t46;
  t1146 = t231 * t454;
  t1151 = t236 * t454;
  t1156 = t241 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t251 * t470 + t1163 * t191 / 0.8e1 + 0.5e1 / 0.48e2 * t256 * t470 + t1168 * t191 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1091;
  t1198 = 0.11e2 / 0.96e2 * t261 * t470 + t1174 * t191 / 0.8e1 + t266 * t470 / 0.8e1 + t1179 * t191 / 0.8e1 + 0.3e1 / 0.2e1 * t168 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t201 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t205 * t480 + t136 * t1187 + 0.2e1 * t209 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t357 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t362 * t418;
  t1211 = t367 * t418;
  t1216 = t372 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t382 * t434 + t1035 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t387 * t434 + t1038 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1088 * t1240 / 0.2e1 + t1091;
  t1254 = 0.11e2 / 0.96e2 * t392 * t434 + t1066 * t314 / 0.8e1 + t397 * t434 / 0.8e1 + t1069 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t400 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t332 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t336 * t444 + t136 * t1243 + 0.2e1 * t340 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t400 * t128 + t1126 - 0.1e2 / 0.3e1 * t332 * t128 + t1130 - 0.11e2 / 0.3e1 * t336 * t128 + t1134 - 0.4e1 * t340 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t319 * t97 * t45;
  t1274 = t29 / rho[1];
  t1276 = t454 * t56 * t46;
  t1279 = t63 * t855;
  t1283 = t50 * t326 * t46;
  t1301 = t347 * t56 * t46;
  t1306 = -t85 * t1264 / 0.6e1 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 + t1274 * t1276 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t1276 + t460 * t1283 / 0.16e2 + t463 * t1283 / 0.16e2 + t466 * t1283 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 + t455 * t1283 / 0.16e2 - t455 * t1301 / 0.12e2 - t460 * t1301 / 0.12e2;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1318 / 0.2e1 + t1091;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = -t463 * t1301 / 0.12e2 - t466 * t1301 / 0.12e2 + 0.5e1 / 0.48e2 * t1311 * t1276 + 0.11e2 / 0.96e2 * t1314 * t1276 + t119 * t1321 + 0.3e1 / 0.2e1 * t400 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t332 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t336 * t480 + t139 * t1321 + 0.2e1 * t340 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1306 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->out_dim->v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->out_dim->v2sigma2 + 5] += tv2sigma25;

  t1378 = 0.1e1 / t17;
  t1383 = t113 * t248;
  t1385 = t138 * t199;
  t1393 = t29 * t1118;
  t1397 = t63 * t1378;
  t1400 = t67 * t32;
  t1403 = 0.1e1 / t3;
  t1404 = t71 * t1403;
  t1407 = t84 * t1378;
  t1410 = t104 * t32;
  t1413 = t109 * t1403;
  t1416 = t118 * t1378;
  t1419 = t132 * t32;
  t1422 = t135 * t1403;
  t1425 = t142 * t269;
  t1426 = 0.12e2 * t1425;
  t1427 = t148 * t269;
  t1428 = 0.12e2 * t1427;
  t1429 = -0.3e1 / 0.16e2 * t1397 * t60 - 0.5e1 / 0.27e2 * t1400 * t60 - 0.55e2 / 0.432e3 * t1404 * t60 - 0.3e1 / 0.16e2 * t1407 * t101 - 0.5e1 / 0.27e2 * t1410 * t101 - 0.55e2 / 0.432e3 * t1413 * t101 - 0.3e1 / 0.8e1 * t1416 * t130 - 0.1e2 / 0.27e2 * t1419 * t130 - 0.55e2 / 0.216e3 * t1422 * t130 - t1426 - t1428;
  t1431 = t151 * t269;
  t1432 = 0.12e2 * t1431;
  t1433 = t154 * t269;
  t1434 = 0.12e2 * t1433;
  t1450 = 0.1e1 / t9 / t502;
  t1451 = t31 * t1450;
  t1458 = 0.1e1 / t514 / t38;
  t1459 = t516 * t179;
  t1462 = t515 * t179;
  t1465 = t34 * t676;
  t1467 = 0.6e1 * t269 - 0.6e1 * t1465;
  t1471 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1458 * t1459 + 0.4e1 / 0.3e1 * t1462 * t521 + 0.4e1 / 0.3e1 * t42 * t1467);
  t1472 = t1471 * t46;
  t1476 = 0.1e1 / t533 / t52;
  t1477 = t535 * t187;
  t1480 = t534 * t187;
  t1483 = -t1467;
  t1487 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1476 * t1477 + 0.4e1 / 0.3e1 * t1480 * t538 + 0.4e1 / 0.3e1 * t54 * t1483);
  t1488 = t1487 * t46;
  t1491 = -0.7e2 / 0.27e2 * t1451 * t47 + 0.7e1 / 0.3e1 * t631 * t217 - t214 * t636 + t33 * t1472 / 0.4e1 + t51 * t1488 / 0.4e1;
  t1496 = -t1432 - t1434 + 0.2e1 / 0.3e1 * t588 * t223 + 0.9e1 / 0.8e1 * t591 * t223 + 0.5e1 / 0.3e1 * t594 * t223 + 0.55e2 / 0.24e2 * t598 * t223 + 0.9e1 / 0.8e1 * t601 * t248 + 0.5e1 / 0.3e1 * t604 * t248 + 0.55e2 / 0.24e2 * t607 * t248 + t30 * t1491 / 0.2e1 + 0.2e1 * t226 * t642;
  t1509 = t502 * rho[0];
  t1511 = 0.1e1 / t23 / t1509;
  t1512 = sigma[0] * t1511;
  t1513 = t1512 * t91;
  t1515 = t505 * t183;
  t1517 = t174 * t511;
  t1519 = t174 * t526;
  t1521 = t712 * t525;
  t1522 = t89 * t1521;
  t1524 = t177 * t1471;
  t1525 = t89 * t1524;
  t1527 = t729 * t542;
  t1528 = t96 * t1527;
  t1530 = t186 * t1487;
  t1531 = t96 * t1530;
  t1533 = -0.154e3 / 0.27e2 * t1513 + 0.22e2 / 0.3e1 * t1515 - 0.2e1 * t1517 - 0.2e1 * t1519 + 0.3e1 / 0.4e1 * t1522 + t1525 / 0.4e1 + 0.3e1 / 0.4e1 * t1528 + t1531 / 0.4e1;
  t1544 = t64 * t1491 / 0.2e1 + 0.9e1 / 0.4e1 * t231 * t642 + t68 * t1491 / 0.2e1 + 0.5e1 / 0.2e1 * t236 * t642 + t81 * t1491 / 0.2e1 + 0.11e2 / 0.4e1 * t241 * t642 + t85 * t1533 / 0.2e1 + 0.9e1 / 0.4e1 * t251 * t546 + t105 * t1533 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t546 + t110 * t1533 / 0.2e1;
  t1561 = t569 * t35;
  t1563 = 0.1e1 / t126 / t1561;
  t1565 = 0.1232e4 / 0.27e2 * t123 * t1563;
  t1566 = -0.308e3 / 0.27e2 * t1513 + 0.44e2 / 0.3e1 * t1515 - 0.4e1 * t1517 - 0.4e1 * t1519 + 0.3e1 / 0.2e1 * t1522 + t1525 / 0.2e1 + 0.3e1 / 0.2e1 * t1528 + t1531 / 0.2e1 + t1565;
  t1580 = t288 * t144;
  t1582 = t291 * t144;
  t1584 = t294 * t144;
  t1586 = t297 * t144;
  t1588 = 0.1e1 / t1561;
  t1589 = t143 * t1588;
  t1591 = 0.24e2 * t148 * t1589;
  t1592 = t151 * t1465;
  t1593 = 0.36e2 * t1592;
  t1595 = 0.24e2 * t151 * t1589;
  t1596 = t154 * t1465;
  t1597 = 0.36e2 * t1596;
  t1599 = 0.24e2 * t154 * t1589;
  t1600 = t141 * t1114;
  t1603 = 0.6e1 * t209 * t574 + 0.7e1 * t1580 + 0.8e1 * t1582 + 0.9e1 * t1584 + 0.1e2 * t1586 - t1591 + t1593 - t1595 + t1597 - t1599 - 0.35e2 / 0.216e3 * t1600 * t145;
  t1605 = t692 * t178;
  t1607 = t692 * t270;
  t1609 = t288 * t519;
  t1611 = t288 * t677;
  t1613 = t147 * t1118;
  t1616 = t699 * t178;
  t1618 = t699 * t270;
  t1620 = t291 * t519;
  t1622 = t291 * t677;
  t1624 = t150 * t1378;
  t1627 = t659 * t178;
  t1629 = 0.7e1 / 0.6e1 * t1605 - 0.7e1 / 0.6e1 * t1607 - 0.28e2 * t1609 + 0.21e2 * t1611 - 0.8e1 / 0.27e2 * t1613 * t145 + 0.8e1 / 0.3e1 * t1616 - 0.8e1 / 0.3e1 * t1618 - 0.32e2 * t1620 + 0.24e2 * t1622 - 0.3e1 / 0.8e1 * t1624 * t145 + 0.9e1 / 0.2e1 * t1627;
  t1630 = t659 * t270;
  t1632 = t294 * t519;
  t1634 = t294 * t677;
  t1636 = t153 * t32;
  t1639 = t667 * t178;
  t1641 = t667 * t270;
  t1643 = t297 * t519;
  t1645 = t297 * t677;
  t1647 = t142 * t1465;
  t1648 = 0.36e2 * t1647;
  t1650 = 0.24e2 * t142 * t1589;
  t1651 = t148 * t1465;
  t1652 = 0.36e2 * t1651;
  t1653 = -0.9e1 / 0.2e1 * t1630 - 0.36e2 * t1632 + 0.27e2 * t1634 - 0.1e2 / 0.27e2 * t1636 * t145 + 0.2e2 / 0.3e1 * t1639 - 0.2e2 / 0.3e1 * t1641 - 0.4e2 * t1643 + 0.3e2 * t1645 + t1648 - t1650 + t1652;
  tv3rho30 = t1653 + t1629 + t1603 + t1544 + t1496 + t1429 + 0.3e1 * t1383 + 0.6e1 * t1385 + 0.11e2 / 0.4e1 * t261 * t546 + t115 * t1533 / 0.2e1 + 0.3e1 * t266 * t546 + t119 * t1566 + 0.9e1 / 0.2e1 * t168 * t574 + t133 * t1566 + 0.5e1 * t201 * t574 + t136 * t1566 + 0.11e2 / 0.2e1 * t205 * t574 + t139 * t1566 - 0.3e1 / 0.8e1 * t15 * t1378 - 0.1e2 / 0.27e2 * t22 * t32 + 0.9e1 / 0.4e1 * t610 * t199 + 0.1e2 / 0.3e1 * t613 * t199 + 0.55e2 / 0.12e2 * t618 * t199 - 0.4e1 / 0.27e2 * t1393 * t60 - 0.35e2 / 0.216e3 * t1 * t1114 - 0.8e1 / 0.27e2 * t8 * t1118;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 0] += tv3rho30;

  t1656 = t138 * t330;
  t1658 = t113 * t378;
  t1659 = 0.4e1 * t1425;
  t1660 = 0.4e1 * t1427;
  t1661 = 0.4e1 * t1431;
  t1662 = 0.4e1 * t1433;
  t1669 = 0.2e1 * t1656 + t1658 + t1659 + t1660 + t1661 + t1662 - 0.14e2 / 0.3e1 * t1580 - 0.16e2 / 0.3e1 * t1582 - 0.6e1 * t1584 - 0.2e2 / 0.3e1 * t1586 + 0.55e2 / 0.72e2 * t607 * t378;
  t1672 = t404 * t144;
  t1674 = t407 * t144;
  t1676 = t410 * t144;
  t1678 = t413 * t144;
  t1692 = 0.3e1 / 0.4e1 * t610 * t330 + 0.7e1 / 0.3e1 * t1672 + 0.8e1 / 0.3e1 * t1674 + 0.3e1 * t1676 + 0.1e2 / 0.3e1 * t1678 + 0.1e2 / 0.9e1 * t613 * t330 + 0.55e2 / 0.36e2 * t618 * t330 + 0.2e1 / 0.9e1 * t588 * t354 + 0.3e1 / 0.8e1 * t591 * t354 + 0.5e1 / 0.9e1 * t594 * t354 + 0.55e2 / 0.72e2 * t598 * t354;
  t1700 = t505 * t314;
  t1702 = t174 * t713;
  t1704 = t174 * t724;
  t1706 = t525 * t45;
  t1707 = t1706 * t313;
  t1708 = t89 * t1707;
  t1710 = t712 * t723;
  t1711 = t89 * t1710;
  t1712 = t1458 * t310;
  t1715 = t515 * t34;
  t1726 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1712 * t516 + 0.16e2 / 0.9e1 * t1715 * t269 * t179 + 0.4e1 / 0.9e1 * t716 * t521 + 0.8e1 / 0.3e1 * t42 * t269 - 0.8e1 * t719 * t676);
  t1727 = t177 * t1726;
  t1728 = t89 * t1727;
  t1730 = t320 * t530;
  t1732 = t320 * t543;
  t1734 = t542 * t45;
  t1735 = t1734 * t326;
  t1736 = t96 * t1735;
  t1738 = t729 * t740;
  t1739 = t96 * t1738;
  t1740 = t1476 * t323;
  t1743 = t534 * t34;
  t1754 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1740 * t535 - 0.16e2 / 0.9e1 * t1743 * t269 * t187 + 0.4e1 / 0.9e1 * t733 * t538 - 0.8e1 / 0.3e1 * t54 * t269 + 0.8e1 * t736 * t676);
  t1755 = t186 * t1754;
  t1756 = t96 * t1755;
  t1758 = 0.44e2 / 0.9e1 * t1700 - 0.8e1 / 0.3e1 * t1702 - 0.8e1 / 0.3e1 * t1704 + t1708 / 0.2e1 + t1711 + t1728 / 0.2e1 - 0.4e1 / 0.3e1 * t1730 - 0.4e1 / 0.3e1 * t1732 + t1736 / 0.2e1 + t1739 + t1756 / 0.2e1 + t1565;
  t1772 = 0.3e1 / 0.8e1 * t601 * t378 + 0.5e1 / 0.9e1 * t604 * t378 + 0.3e1 / 0.2e1 * t400 * t574 + t133 * t1758 + 0.1e2 / 0.3e1 * t201 * t744 + 0.5e1 / 0.3e1 * t332 * t574 + t136 * t1758 + 0.11e2 / 0.3e1 * t205 * t744 + 0.11e2 / 0.6e1 * t336 * t574 + t139 * t1758 + 0.4e1 * t209 * t744;
  t1779 = t1726 * t46;
  t1784 = t1754 * t46;
  t1787 = 0.7e1 / 0.9e1 * t631 * t343 - 0.2e1 / 0.3e1 * t214 * t757 + t33 * t1779 / 0.4e1 - t348 * t639 / 0.3e1 + t51 * t1784 / 0.4e1;
  t1808 = 0.2e1 * t340 * t574 + t30 * t1787 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t765 + 0.2e1 / 0.3e1 * t357 * t642 + t64 * t1787 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t765 + 0.3e1 / 0.4e1 * t362 * t642 + t68 * t1787 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t765 + 0.5e1 / 0.6e1 * t367 * t642 + t81 * t1787 / 0.2e1;
  t1826 = 0.22e2 / 0.9e1 * t1700 - 0.4e1 / 0.3e1 * t1702 - 0.4e1 / 0.3e1 * t1704 + t1708 / 0.4e1 + t1711 / 0.2e1 + t1728 / 0.4e1 - 0.2e1 / 0.3e1 * t1730 - 0.2e1 / 0.3e1 * t1732 + t1736 / 0.4e1 + t1739 / 0.2e1 + t1756 / 0.4e1;
  t1845 = 0.11e2 / 0.6e1 * t241 * t765 + 0.11e2 / 0.12e2 * t372 * t642 + t85 * t1826 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t797 + 0.3e1 / 0.4e1 * t382 * t546 + t105 * t1826 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t797 + 0.5e1 / 0.6e1 * t387 * t546 + t110 * t1826 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t797 + 0.11e2 / 0.12e2 * t392 * t546;
  t1854 = 0.12e2 * t1592;
  t1855 = 0.12e2 * t1596;
  t1857 = t115 * t1826 / 0.2e1 + 0.2e1 * t266 * t797 + t397 * t546 + t119 * t1758 + 0.3e1 * t168 * t744 - t1591 + t1854 - t1595 + t1855 - t1599 - 0.7e1 / 0.18e2 * t1605;
  t1870 = -0.7e1 / 0.18e2 * t1607 + 0.14e2 * t1611 - 0.8e1 / 0.9e1 * t1616 - 0.8e1 / 0.9e1 * t1618 + 0.16e2 * t1622 - 0.3e1 / 0.2e1 * t1627 - 0.3e1 / 0.2e1 * t1630 + 0.18e2 * t1634 - 0.2e2 / 0.9e1 * t1639 - 0.2e2 / 0.9e1 * t1641 + 0.2e2 * t1645;
  t1871 = 0.12e2 * t1647;
  t1872 = 0.12e2 * t1651;
  t1873 = t410 * t519;
  t1875 = t410 * t677;
  t1877 = t413 * t519;
  t1879 = t413 * t677;
  t1881 = t404 * t519;
  t1883 = t404 * t677;
  t1885 = t407 * t519;
  t1887 = t407 * t677;
  t1889 = t1871 - t1650 + t1872 - 0.12e2 * t1873 + 0.9e1 * t1875 - 0.4e2 / 0.3e1 * t1877 + 0.1e2 * t1879 - 0.28e2 / 0.3e1 * t1881 + 0.7e1 * t1883 - 0.32e2 / 0.3e1 * t1885 + 0.8e1 * t1887;
  tv3rho31 = t1669 + t1692 + t1772 + t1808 + t1845 + t1857 + t1870 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 1] += tv3rho31;

  t1893 = t1015 * t178;
  t1895 = t1015 * t270;
  t1897 = t1018 * t178;
  t1899 = t1018 * t270;
  t1901 = t1021 * t178;
  t1903 = t1021 * t270;
  t1905 = t1024 * t178;
  t1907 = t1024 * t270;
  t1909 = t1383 + 0.2e1 * t1385 + 0.7e1 / 0.18e2 * t1893 - 0.7e1 / 0.18e2 * t1895 + 0.8e1 / 0.9e1 * t1897 - 0.8e1 / 0.9e1 * t1899 + 0.3e1 / 0.2e1 * t1901 - 0.3e1 / 0.2e1 * t1903 + 0.2e2 / 0.9e1 * t1905 - 0.2e2 / 0.9e1 * t1907 + t1659;
  t1918 = t1660 + t1661 + t1662 + 0.7e1 / 0.3e1 * t1580 + 0.8e1 / 0.3e1 * t1582 + 0.3e1 * t1584 + 0.1e2 / 0.3e1 * t1586 - 0.14e2 / 0.3e1 * t1672 - 0.16e2 / 0.3e1 * t1674 - 0.6e1 * t1676 - 0.2e2 / 0.3e1 * t1678;
  t1920 = t174 * t916;
  t1922 = t1240 * t723;
  t1923 = t89 * t1922;
  t1924 = t174 * t919;
  t1926 = t712 * t876;
  t1927 = t89 * t1926;
  t1929 = t1458 * t868;
  t1934 = t515 * t872;
  t1939 = -0.2e1 * t269 - 0.6e1 * t1465;
  t1943 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1929 * t179 + 0.16e2 / 0.9e1 * t716 * t519 + 0.4e1 / 0.9e1 * t1934 * t179 + 0.4e1 / 0.3e1 * t42 * t1939);
  t1944 = t177 * t1943;
  t1945 = t89 * t1944;
  t1947 = t925 * t191;
  t1949 = t320 * t730;
  t1951 = t320 * t741;
  t1953 = t1318 * t740;
  t1954 = t96 * t1953;
  t1955 = t729 * t894;
  t1956 = t96 * t1955;
  t1958 = t1476 * t887;
  t1963 = t534 * t890;
  t1966 = -t1939;
  t1970 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1958 * t187 - 0.16e2 / 0.9e1 * t733 * t519 + 0.4e1 / 0.9e1 * t1963 * t187 + 0.4e1 / 0.3e1 * t54 * t1966);
  t1971 = t186 * t1970;
  t1972 = t96 * t1971;
  t1974 = -0.4e1 / 0.3e1 * t1920 + t1923 - 0.4e1 / 0.3e1 * t1924 + t1927 / 0.2e1 + t1945 / 0.2e1 + 0.44e2 / 0.9e1 * t1947 - 0.8e1 / 0.3e1 * t1949 - 0.8e1 / 0.3e1 * t1951 + t1954 + t1956 / 0.2e1 + t1972 / 0.2e1 + t1565;
  t1996 = t139 * t1974 + 0.2e1 * t209 * t962 + 0.4e1 * t340 * t744 + 0.2e1 / 0.9e1 * t975 * t223 + 0.3e1 / 0.8e1 * t978 * t223 + 0.5e1 / 0.9e1 * t981 * t223 + 0.55e2 / 0.72e2 * t985 * t223 + 0.3e1 / 0.8e1 * t988 * t248 + 0.5e1 / 0.9e1 * t991 * t248 + 0.55e2 / 0.72e2 * t995 * t248 + 0.3e1 / 0.4e1 * t998 * t199;
  t2003 = t1943 * t46;
  t2010 = t1970 * t46;
  t2013 = -t214 * t877 / 0.3e1 + t33 * t2003 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t220 - 0.2e1 / 0.3e1 * t348 * t762 + t51 * t2010 / 0.4e1;
  t2037 = -0.2e1 / 0.3e1 * t1920 + t1923 / 0.2e1 - 0.2e1 / 0.3e1 * t1924 + t1927 / 0.4e1 + t1945 / 0.4e1 + 0.22e2 / 0.9e1 * t1947 - 0.4e1 / 0.3e1 * t1949 - 0.4e1 / 0.3e1 * t1951 + t1954 / 0.2e1 + t1956 / 0.4e1 + t1972 / 0.4e1;
  t2044 = 0.1e2 / 0.9e1 * t1001 * t199 + 0.55e2 / 0.36e2 * t1004 * t199 + t68 * t2013 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t898 + 0.5e1 / 0.3e1 * t367 * t765 + t81 * t2013 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t898 + 0.11e2 / 0.6e1 * t372 * t765 + t85 * t2037 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t937 + 0.3e1 / 0.2e1 * t382 * t797;
  t2067 = t105 * t2037 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t937 + 0.5e1 / 0.3e1 * t387 * t797 + t110 * t2037 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t937 + 0.11e2 / 0.6e1 * t392 * t797 + t115 * t2037 / 0.2e1 + t266 * t937 + 0.2e1 * t397 * t797 + t119 * t1974 + 0.3e1 / 0.2e1 * t168 * t962;
  t2088 = 0.3e1 * t400 * t744 + t133 * t1974 + 0.5e1 / 0.3e1 * t201 * t962 + 0.1e2 / 0.3e1 * t332 * t744 + t136 * t1974 + 0.11e2 / 0.6e1 * t205 * t962 + 0.11e2 / 0.3e1 * t336 * t744 + t30 * t2013 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t898 + 0.4e1 / 0.3e1 * t357 * t765 + t64 * t2013 / 0.2e1;
  t2098 = 0.3e1 / 0.4e1 * t231 * t898 + 0.3e1 / 0.2e1 * t362 * t765 - t1591 - t1854 - t1595 - t1855 - t1599 + 0.28e2 / 0.3e1 * t1609 + 0.7e1 * t1611 + 0.32e2 / 0.3e1 * t1620 + 0.8e1 * t1622;
  t2107 = 0.12e2 * t1632 + 0.9e1 * t1634 + 0.4e2 / 0.3e1 * t1643 + 0.1e2 * t1645 - t1871 - t1650 - t1872 + 0.18e2 * t1875 + 0.2e2 * t1879 + 0.14e2 * t1883 + 0.16e2 * t1887;
  tv3rho32 = t1909 + t1918 + t1996 + t2044 + t2067 + t2088 + t2098 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 2] += tv3rho32;

  t2116 = 0.1e1 / t19;
  t2121 = t141 * t1343;
  t2124 = t147 * t1347;
  t2127 = t150 * t2116;
  t2130 = t153 * t50;
  t2142 = -0.7e1 / 0.6e1 * t1893 - 0.7e1 / 0.6e1 * t1895 - 0.8e1 / 0.3e1 * t1897 - 0.8e1 / 0.3e1 * t1899 - 0.9e1 / 0.2e1 * t1901 - 0.9e1 / 0.2e1 * t1903 - 0.2e2 / 0.3e1 * t1905 - 0.2e2 / 0.3e1 * t1907 - t1426 - t1428 - t1432;
  t2148 = t1240 * t876;
  t2149 = t89 * t2148;
  t2151 = t868 * t310;
  t2157 = -0.6e1 * t269 - 0.6e1 * t1465;
  t2161 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1458 * t2151 + 0.4e1 / 0.3e1 * t716 * t872 + 0.4e1 / 0.3e1 * t42 * t2157);
  t2162 = t177 * t2161;
  t2163 = t89 * t2162;
  t2165 = t922 * rho[1];
  t2167 = 0.1e1 / t25 / t2165;
  t2168 = sigma[2] * t2167;
  t2169 = t2168 * t98;
  t2171 = t925 * t327;
  t2173 = t320 * t931;
  t2175 = t320 * t934;
  t2177 = t1318 * t894;
  t2178 = t96 * t2177;
  t2180 = t887 * t323;
  t2185 = -t2157;
  t2189 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1476 * t2180 + 0.4e1 / 0.3e1 * t733 * t890 + 0.4e1 / 0.3e1 * t54 * t2185);
  t2190 = t186 * t2189;
  t2191 = t96 * t2190;
  t2193 = 0.3e1 / 0.2e1 * t2149 + t2163 / 0.2e1 - 0.308e3 / 0.27e2 * t2169 + 0.44e2 / 0.3e1 * t2171 - 0.4e1 * t2173 - 0.4e1 * t2175 + 0.3e1 / 0.2e1 * t2178 + t2191 / 0.2e1 + t1565;
  t2197 = t2161 * t46;
  t2201 = 0.1e1 / t11 / t922;
  t2202 = t49 * t2201;
  t2208 = t2189 * t46;
  t2211 = t33 * t2197 / 0.4e1 - 0.7e2 / 0.27e2 * t2202 * t57 + 0.7e1 / 0.3e1 * t882 * t351 - t348 * t895 + t51 * t2208 / 0.4e1;
  t2220 = -t1434 + 0.7e1 * t1672 + 0.8e1 * t1674 + 0.9e1 * t1676 + 0.1e2 * t1678 + t139 * t2193 + 0.6e1 * t340 * t962 + t68 * t2211 / 0.2e1 + 0.5e1 / 0.2e1 * t367 * t898 + t81 * t2211 / 0.2e1 + 0.11e2 / 0.4e1 * t372 * t898;
  t2229 = 0.3e1 / 0.4e1 * t2149 + t2163 / 0.4e1 - 0.154e3 / 0.27e2 * t2169 + 0.22e2 / 0.3e1 * t2171 - 0.2e1 * t2173 - 0.2e1 * t2175 + 0.3e1 / 0.4e1 * t2178 + t2191 / 0.4e1;
  t2250 = t85 * t2229 / 0.2e1 + 0.9e1 / 0.4e1 * t382 * t937 + t105 * t2229 / 0.2e1 + 0.5e1 / 0.2e1 * t387 * t937 + t110 * t2229 / 0.2e1 + 0.11e2 / 0.4e1 * t392 * t937 + t115 * t2229 / 0.2e1 + 0.3e1 * t397 * t937 + t119 * t2193 + 0.9e1 / 0.2e1 * t400 * t962 + t133 * t2193;
  t2287 = t29 * t1347;
  t2290 = t63 * t2116;
  t2293 = t67 * t50;
  t2296 = 0.1e1 / t5;
  t2297 = t71 * t2296;
  t2300 = 0.55e2 / 0.24e2 * t985 * t354 + 0.9e1 / 0.8e1 * t988 * t378 + 0.5e1 / 0.3e1 * t991 * t378 + 0.55e2 / 0.24e2 * t995 * t378 + 0.9e1 / 0.4e1 * t998 * t330 + 0.1e2 / 0.3e1 * t1001 * t330 + 0.55e2 / 0.12e2 * t1004 * t330 - 0.4e1 / 0.27e2 * t2287 * t60 - 0.3e1 / 0.16e2 * t2290 * t60 - 0.5e1 / 0.27e2 * t2293 * t60 - 0.55e2 / 0.432e3 * t2297 * t60;
  t2302 = t84 * t2116;
  t2305 = t104 * t50;
  t2308 = t109 * t2296;
  t2311 = t118 * t2116;
  t2314 = t132 * t50;
  t2317 = t135 * t2296;
  t2320 = -0.3e1 / 0.16e2 * t2302 * t101 - 0.5e1 / 0.27e2 * t2305 * t101 - 0.55e2 / 0.432e3 * t2308 * t101 - 0.3e1 / 0.8e1 * t2311 * t130 - 0.1e2 / 0.27e2 * t2314 * t130 - 0.55e2 / 0.216e3 * t2317 * t130 - t1591 - t1593 - t1595 - t1597 - t1599;
  t2329 = -t1648 - t1650 - t1652 + 0.36e2 * t1873 + 0.27e2 * t1875 + 0.4e2 * t1877 + 0.3e2 * t1879 + 0.28e2 * t1881 + 0.21e2 * t1883 + 0.32e2 * t1885 + 0.24e2 * t1887;
  tv3rho33 = t2329 + t2320 + t2300 + t2250 + t2220 + t2142 + 0.6e1 * t1656 + 0.3e1 * t1658 + 0.5e1 * t332 * t962 + t136 * t2193 + 0.11e2 / 0.2e1 * t336 * t962 + t30 * t2211 / 0.2e1 + 0.2e1 * t357 * t898 + t64 * t2211 / 0.2e1 + 0.9e1 / 0.4e1 * t362 * t898 + 0.2e1 / 0.3e1 * t975 * t354 + 0.9e1 / 0.8e1 * t978 * t354 + 0.5e1 / 0.3e1 * t981 * t354 - 0.35e2 / 0.216e3 * t2121 * t145 - 0.8e1 / 0.27e2 * t2124 * t145 - 0.3e1 / 0.8e1 * t2127 * t145 - 0.1e2 / 0.27e2 * t2130 * t145 - 0.35e2 / 0.216e3 * t1 * t1343 - 0.8e1 / 0.27e2 * t8 * t1347 - 0.3e1 / 0.8e1 * t15 * t2116 - 0.1e2 / 0.27e2 * t22 * t50;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->out_dim->v3rho3 + 3] += tv3rho33;

  t2333 = t630 * t44 * t46;
  t2341 = t213 * t182 * t46;
  t2346 = t105 * t173;
  t2351 = t110 * t173;
  t2356 = t115 * t173;
  t2362 = t32 * t525 * t46;
  t2369 = 0.7e1 / 0.36e2 * t427 * t2333 + 0.7e1 / 0.36e2 * t430 * t2333 + 0.7e1 / 0.36e2 * t419 * t2333 - t427 * t2341 / 0.6e1 - t430 * t2341 / 0.6e1 - 0.2e1 / 0.3e1 * t2346 * t183 + t1038 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2351 * t183 + t1066 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2356 * t183 + t1069 * t526 / 0.8e1 + t419 * t2362 / 0.16e2 + t424 * t2362 / 0.16e2 + t427 * t2362 / 0.16e2;
  t2372 = t85 * t173;
  t2384 = t88 * t510 * t45;
  t2388 = t504 * t90 * t45;
  t2403 = t430 * t2362 / 0.16e2 - 0.2e1 / 0.3e1 * t2372 * t183 + t1035 * t526 / 0.8e1 - t419 * t2341 / 0.6e1 - t424 * t2341 / 0.6e1 + 0.7e1 / 0.36e2 * t424 * t2333 + t105 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2388 + t110 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2388 + t115 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2388 + t85 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2388;
  t2406 = t418 * t182 * t46;
  t2423 = t63 * t1114;
  t2426 = t67 * t1118;
  t2429 = t71 * t1378;
  t2432 = t29 * t1110;
  t2437 = t84 / t2 / t171;
  t2440 = 0.1e1 / t171;
  t2441 = t104 * t2440;
  t2444 = 0.5e1 / 0.24e2 * t1060 * t2406 + 0.11e2 / 0.48e2 * t1063 * t2406 + 0.3e1 / 0.8e1 * t1107 * t183 + 0.5e1 / 0.12e2 * t1111 * t183 + 0.11e2 / 0.24e2 * t1115 * t183 + t1119 * t183 / 0.2e1 + t1052 * t2406 / 0.6e1 + 0.3e1 / 0.16e2 * t1057 * t2406 - 0.13e2 / 0.64e2 * t2423 * t1054 - 0.5e1 / 0.24e2 * t2426 * t1054 - 0.121e3 / 0.576e3 * t2429 * t1054 - 0.7e1 / 0.36e2 * t2432 * t1054 - 0.29e2 / 0.64e2 * t2437 * t91 - 0.35e2 / 0.72e2 * t2441 * t91;
  t2446 = 0.1e1 / t74 / t86;
  t2447 = t109 * t2446;
  t2450 = t113 * t88;
  t2451 = t2450 * t91;
  t2454 = 0.2e1 * t138 * t444;
  t2456 = t173 * t44;
  t2462 = 0.88e2 / 0.9e1 * t571;
  t2463 = 0.22e2 / 0.9e1 * t2388 - 0.8e1 / 0.3e1 * t2456 * t712 + t2384 / 0.2e1 + t1088 * t1706 / 0.2e1 - t2462;
  t2482 = -0.33e2 / 0.64e2 * t2447 * t91 - 0.13e2 / 0.24e2 * t2451 + t2454 + t119 * t2463 + 0.3e1 * t168 * t1092 + t133 * t2463 + 0.1e2 / 0.3e1 * t201 * t1092 + t136 * t2463 + 0.11e2 / 0.3e1 * t205 * t1092 + t139 * t2463 + 0.4e1 * t209 * t1092 + 0.3e1 / 0.4e1 * t610 * t444 + 0.1e2 / 0.9e1 * t613 * t444 + 0.55e2 / 0.36e2 * t618 * t444;
  tv3rho2sigma0 = t2369 + t2403 + t2444 + t2482;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t168 * t196;
  t2489 = 0.176e3 / 0.9e1 * t119 * t571;
  t2492 = t201 * t196;
  t2495 = 0.176e3 / 0.9e1 * t133 * t571;
  t2498 = t205 * t196;
  t2501 = 0.176e3 / 0.9e1 * t136 * t571;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t209 * t196;
  t2507 = 0.176e3 / 0.9e1 * t139 * t571;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t610 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t613 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t618 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t2511 = t50 * t542 * t46;
  t2514 = t251 * t95;
  t2519 = t256 * t95;
  t2524 = t261 * t95;
  t2529 = t266 * t95;
  t2546 = t591 * t454;
  t2549 = t594 * t454;
  t2552 = t598 * t454;
  t2555 = t588 * t454;
  t2558 = t1179 * t543 / 0.8e1 + t466 * t2511 / 0.16e2 + 0.3e1 / 0.8e1 * t2514 * t191 + t1163 * t543 / 0.8e1 + 0.5e1 / 0.12e2 * t2519 * t191 + t1168 * t543 / 0.8e1 + 0.11e2 / 0.24e2 * t2524 * t191 + t1174 * t543 / 0.8e1 + t2529 * t191 / 0.2e1 + t1139 * t1143 / 0.6e1 + t455 * t2511 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2511 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2511 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + 0.3e1 / 0.64e2 * t2546 * t457 + 0.5e1 / 0.72e2 * t2549 * t457 + 0.55e2 / 0.576e3 * t2552 * t457 + t2555 * t457 / 0.36e2;
  t2560 = t95 * t529 * t45;
  t2575 = t113 * t95;
  t2576 = t2575 * t98;
  t2579 = 0.2e1 * t138 * t480;
  t2591 = t2560 / 0.2e1 + t1184 * t1734 / 0.2e1 - t2462;
  t2602 = t115 * t2560 / 0.8e1 + 0.3e1 / 0.64e2 * t601 * t470 + t85 * t2560 / 0.8e1 + 0.5e1 / 0.72e2 * t604 * t470 + t105 * t2560 / 0.8e1 + 0.55e2 / 0.576e3 * t607 * t470 + t110 * t2560 / 0.8e1 + t2576 / 0.8e1 + t2579 + 0.3e1 / 0.4e1 * t610 * t480 + 0.1e2 / 0.9e1 * t613 * t480 + 0.55e2 / 0.36e2 * t618 * t480 + 0.3e1 * t168 * t1187 + t119 * t2591 + 0.1e2 / 0.3e1 * t201 * t1187 + t133 * t2591 + 0.11e2 / 0.3e1 * t205 * t1187 + t136 * t2591 + 0.4e1 * t209 * t1187 + t139 * t2591;
  tv3rho2sigma2 = t2558 + t2602;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t2606 = t213 * t313 * t46;
  t2624 = t32 * t723 * t46;
  t2627 = t382 * t88;
  t2634 = t387 * t88;
  t2637 = -t1199 * t1078 / 0.9e1 - t419 * t2606 / 0.12e2 - t1206 * t1078 / 0.8e1 - t424 * t2606 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1078 - t427 * t2606 / 0.12e2 + t1069 * t713 / 0.8e1 + t1069 * t724 / 0.8e1 + 0.11e2 / 0.96e2 * t1216 * t1030 + t430 * t2624 / 0.16e2 + 0.3e1 / 0.16e2 * t2627 * t183 + t1035 * t713 / 0.8e1 + t1035 * t724 / 0.8e1 + 0.5e1 / 0.24e2 * t2634 * t183;
  t2642 = t392 * t88;
  t2649 = t397 * t88;
  t2668 = t1038 * t713 / 0.8e1 + t1038 * t724 / 0.8e1 + 0.11e2 / 0.48e2 * t2642 * t183 + t1066 * t713 / 0.8e1 + t1066 * t724 / 0.8e1 + t2649 * t183 / 0.4e1 + t1199 * t1030 / 0.12e2 + t419 * t2624 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1030 + t424 * t2624 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1030 + t427 * t2624 / 0.16e2 - 0.11e2 / 0.72e2 * t1216 * t1078 - t430 * t2606 / 0.12e2;
  t2687 = t418 * t313 * t46;
  t2700 = -t2372 * t314 / 0.3e1 - t2346 * t314 / 0.3e1 - t2351 * t314 / 0.3e1 - t2356 * t314 / 0.3e1 - t382 * t1042 / 0.4e1 - 0.5e1 / 0.18e2 * t387 * t1042 - 0.11e2 / 0.36e2 * t392 * t1042 - t397 * t1042 / 0.3e1 + t1052 * t2687 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t2687 + 0.5e1 / 0.48e2 * t1060 * t2687 + 0.11e2 / 0.96e2 * t1063 * t2687 + 0.3e1 / 0.16e2 * t1107 * t314 + 0.5e1 / 0.24e2 * t1111 * t314;
  t2709 = t88 * t182;
  t2712 = t45 * t723;
  t2715 = -0.4e1 / 0.3e1 * t2456 * t1240 + t2709 * t1240 / 0.2e1 + t1088 * t2712 / 0.2e1 - t2462;
  t2734 = 0.11e2 / 0.48e2 * t1115 * t314 + t1119 * t314 / 0.4e1 + 0.11e2 / 0.6e1 * t336 * t1092 + t136 * t2715 + 0.11e2 / 0.6e1 * t205 * t1243 + 0.2e1 * t340 * t1092 + t139 * t2715 + 0.2e1 * t209 * t1243 + 0.3e1 / 0.2e1 * t400 * t1092 + t119 * t2715 + 0.3e1 / 0.2e1 * t168 * t1243 + 0.5e1 / 0.3e1 * t332 * t1092 + t133 * t2715 + 0.5e1 / 0.3e1 * t201 * t1243;
  tv3rho2sigma3 = t2637 + t2668 + t2700 + t2734;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t400 * t196;
  t2739 = t332 * t196;
  t2742 = t336 * t196;
  t2745 = t340 * t196;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t2750 = t85 * t319;
  t2759 = t105 * t319;
  t2768 = t110 * t319;
  t2777 = t115 * t319;
  t2780 = 0.11e2 / 0.96e2 * t1156 * t1283 - t2750 * t191 / 0.3e1 + t1163 * t730 / 0.8e1 + t1163 * t741 / 0.8e1 + 0.3e1 / 0.16e2 * t2514 * t327 - t2759 * t191 / 0.3e1 + t1168 * t730 / 0.8e1 + t1168 * t741 / 0.8e1 + 0.5e1 / 0.24e2 * t2519 * t327 - t2768 * t191 / 0.3e1 + t1174 * t730 / 0.8e1 + t1174 * t741 / 0.8e1 + 0.11e2 / 0.48e2 * t2524 * t327 - t2777 * t191 / 0.3e1;
  t2784 = t50 * t740 * t46;
  t2796 = t347 * t190 * t46;
  t2813 = t1179 * t730 / 0.8e1 + t460 * t2784 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1283 + t463 * t2784 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1283 + t466 * t2784 / 0.16e2 - t466 * t2796 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1301 + t1179 * t741 / 0.8e1 + t2529 * t327 / 0.4e1 + t455 * t2784 / 0.16e2 + t1139 * t1283 / 0.12e2 - t455 * t2796 / 0.12e2 - t1139 * t1301 / 0.9e1;
  t2836 = t454 * t190 * t46;
  t2845 = -t460 * t2796 / 0.12e2 - t1146 * t1301 / 0.8e1 - t463 * t2796 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1301 + 0.11e2 / 0.48e2 * t1344 * t191 + t1348 * t191 / 0.4e1 - t251 * t1264 / 0.4e1 - 0.5e1 / 0.18e2 * t256 * t1264 - 0.11e2 / 0.36e2 * t261 * t1264 - t266 * t1264 / 0.3e1 + t1274 * t2836 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t2836 + 0.5e1 / 0.48e2 * t1311 * t2836 + 0.11e2 / 0.96e2 * t1314 * t2836;
  t2852 = t319 * t56;
  t2855 = t95 * t190;
  t2858 = t45 * t740;
  t2861 = -0.4e1 / 0.3e1 * t2852 * t729 + t2855 * t1318 / 0.2e1 + t1184 * t2858 / 0.2e1 - t2462;
  t2880 = 0.3e1 / 0.16e2 * t1336 * t191 + 0.5e1 / 0.24e2 * t1340 * t191 + 0.5e1 / 0.3e1 * t332 * t1187 + t136 * t2861 + 0.11e2 / 0.6e1 * t205 * t1321 + 0.11e2 / 0.6e1 * t336 * t1187 + t139 * t2861 + 0.2e1 * t209 * t1321 + 0.2e1 * t340 * t1187 + t119 * t2861 + 0.3e1 / 0.2e1 * t168 * t1321 + 0.3e1 / 0.2e1 * t400 * t1187 + t133 * t2861 + 0.5e1 / 0.3e1 * t201 * t1321;
  tv3rho2sigma5 = t2780 + t2813 + t2845 + t2880;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t2893 = t32 * t876 * t46;
  t2904 = t975 * t418;
  t2907 = t978 * t418;
  t2910 = t981 * t418;
  t2913 = t985 * t418;
  t2928 = 0.5e1 / 0.12e2 * t2634 * t314 + t1038 * t919 / 0.8e1 + 0.11e2 / 0.24e2 * t2642 * t314 + t1066 * t919 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2893 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t424 * t2893 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2893 / 0.16e2 + t2904 * t421 / 0.36e2 + 0.3e1 / 0.64e2 * t2907 * t421 + 0.5e1 / 0.72e2 * t2910 * t421 + 0.55e2 / 0.576e3 * t2913 * t421 + t2649 * t314 / 0.2e1 + t1069 * t919 / 0.8e1 + 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2893 / 0.16e2 + 0.3e1 / 0.8e1 * t2627 * t314 + t1035 * t919 / 0.8e1;
  t2930 = t88 * t915 * t45;
  t2949 = t45 * t876;
  t2952 = t2930 / 0.2e1 + t1088 * t2949 / 0.2e1 - t2462;
  t2969 = t115 * t2930 / 0.8e1 + 0.3e1 / 0.64e2 * t988 * t434 + t85 * t2930 / 0.8e1 + 0.5e1 / 0.72e2 * t991 * t434 + t105 * t2930 / 0.8e1 + 0.55e2 / 0.576e3 * t995 * t434 + t110 * t2930 / 0.8e1 + t2451 / 0.8e1 + 0.3e1 * t400 * t1243 + t119 * t2952 + 0.1e2 / 0.3e1 * t332 * t1243 + t133 * t2952 + 0.11e2 / 0.3e1 * t336 * t1243 + t136 * t2952 + 0.4e1 * t340 * t1243 + t139 * t2952 + 0.3e1 / 0.4e1 * t998 * t444 + 0.1e2 / 0.9e1 * t1001 * t444 + 0.55e2 / 0.36e2 * t1004 * t444 + t2454;
  tv3rho2sigma6 = t2928 + t2969;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t998 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t1001 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t1004 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2995 = t50 * t894 * t46;
  t2999 = t881 * t56 * t46;
  t3003 = t347 * t326 * t46;
  t3014 = -0.2e1 / 0.3e1 * t2750 * t327 + t1163 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2759 * t327 + t1168 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2768 * t327 + t1174 * t934 / 0.8e1 - 0.2e1 / 0.3e1 * t2777 * t327 + t460 * t2995 / 0.16e2 + 0.7e1 / 0.36e2 * t466 * t2999 - t455 * t3003 / 0.6e1 + 0.7e1 / 0.36e2 * t455 * t2999 + 0.7e1 / 0.36e2 * t460 * t2999 + 0.7e1 / 0.36e2 * t463 * t2999 - t460 * t3003 / 0.6e1;
  t3028 = t454 * t326 * t46;
  t3032 = t95 * t930 * t45;
  t3035 = t29 * t1339;
  t3038 = t63 * t1343;
  t3041 = t67 * t1347;
  t3044 = t71 * t2116;
  t3048 = t924 * t97 * t45;
  t3053 = -t463 * t3003 / 0.6e1 - t466 * t3003 / 0.6e1 + t1179 * t934 / 0.8e1 + t455 * t2995 / 0.16e2 + t463 * t2995 / 0.16e2 + t466 * t2995 / 0.16e2 + t1274 * t3028 / 0.6e1 + t115 * t3032 / 0.8e1 - 0.7e1 / 0.36e2 * t3035 * t1276 - 0.13e2 / 0.64e2 * t3038 * t1276 - 0.5e1 / 0.24e2 * t3041 * t1276 - 0.121e3 / 0.576e3 * t3044 * t1276 + 0.11e2 / 0.18e2 * t85 * t3048 + t85 * t3032 / 0.8e1;
  t3082 = 0.11e2 / 0.18e2 * t105 * t3048 + t105 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t3048 + t110 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t3048 + 0.3e1 / 0.16e2 * t1279 * t3028 + 0.5e1 / 0.24e2 * t1311 * t3028 + 0.11e2 / 0.48e2 * t1314 * t3028 + 0.3e1 / 0.8e1 * t1336 * t327 + 0.5e1 / 0.12e2 * t1340 * t327 + 0.11e2 / 0.24e2 * t1344 * t327 + t1348 * t327 / 0.2e1 - 0.13e2 / 0.24e2 * t2576 + 0.3e1 / 0.4e1 * t998 * t480;
  t3091 = t45 * t894;
  t3094 = 0.22e2 / 0.9e1 * t3048 - 0.8e1 / 0.3e1 * t2852 * t1318 + t3032 / 0.2e1 + t1184 * t3091 / 0.2e1 - t2462;
  t3109 = t84 / t4 / t317;
  t3112 = 0.1e1 / t317;
  t3113 = t104 * t3112;
  t3117 = 0.1e1 / t78 / t93;
  t3118 = t109 * t3117;
  t3121 = 0.1e2 / 0.9e1 * t1001 * t480 + 0.55e2 / 0.36e2 * t1004 * t480 + t119 * t3094 + 0.3e1 * t400 * t1321 + t133 * t3094 + 0.1e2 / 0.3e1 * t332 * t1321 + t136 * t3094 + 0.11e2 / 0.3e1 * t336 * t1321 + t139 * t3094 + t2579 + 0.4e1 * t340 * t1321 - 0.29e2 / 0.64e2 * t3109 * t98 - 0.35e2 / 0.72e2 * t3113 * t98 - 0.33e2 / 0.64e2 * t3118 * t98;
  tv3rho2sigma8 = t3014 + t3053 + t3082 + t3121;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->out_dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1052 * t3124 / 0.24e2 + t1354 * t1078 / 0.24e2 - t1354 * t1030 / 0.32e2 - 0.3e1 / 0.64e2 * t1057 * t3124 + t1356 * t1078 / 0.24e2 - t1356 * t1030 / 0.32e2 - 0.5e1 / 0.96e2 * t1060 * t3124 + t1358 * t1078 / 0.24e2 - t1358 * t1030 / 0.32e2 - 0.11e2 / 0.192e3 * t1063 * t3124 + t1360 * t1078 / 0.24e2 - t1360 * t1030 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t226 * t1364;
  t3154 = t231 * t1364;
  t3159 = t236 * t1364;
  t3164 = t241 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t357 * t1353;
  t3174 = t362 * t1353;
  t3179 = t367 * t1353;
  t3184 = t372 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1274 * t3190 / 0.24e2 + t1365 * t1301 / 0.24e2 - t1365 * t1283 / 0.32e2 - 0.3e1 / 0.64e2 * t1279 * t3190 + t1367 * t1301 / 0.24e2 - t1367 * t1283 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t3190 + t1369 * t1301 / 0.24e2 - t1369 * t1283 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t3190 + t1371 * t1301 / 0.24e2 - t1371 * t1283 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->out_dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->out_dim->v3sigma3 + 9] += tv3sigma39;

  t3239 = t113 * t546;
  t3241 = t138 * t574;
  t3248 = 0.1e1 / t16 / t86;
  t3257 = sigma[0] / t23 / t502 / t86 * t91;
  t3259 = t1512 * t183;
  t3261 = t505 * t511;
  t3263 = t505 * t526;
  t3265 = t174 * t1521;
  t3267 = t174 * t1524;
  t3269 = t525 * t525;
  t3271 = t89 * t3269 * t45;
  t3274 = t89 * t712 * t1471;
  t3275 = t38 * t38;
  t3277 = 0.1e1 / t514 / t3275;
  t3278 = t516 * t516;
  t3284 = t521 * t521;
  t3289 = t34 * t1588;
  t3291 = -0.24e2 * t676 + 0.24e2 * t3289;
  t3295 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3277 * t3278 - 0.16e2 / 0.9e1 * t1458 * t516 * t521 + 0.4e1 / 0.3e1 * t515 * t3284 + 0.16e2 / 0.9e1 * t1462 * t1467 + 0.4e1 / 0.3e1 * t42 * t3291);
  t3297 = t89 * t177 * t3295;
  t3299 = t542 * t542;
  t3301 = t96 * t3299 * t45;
  t3304 = t96 * t729 * t1487;
  t3305 = t52 * t52;
  t3307 = 0.1e1 / t533 / t3305;
  t3308 = t535 * t535;
  t3314 = t538 * t538;
  t3323 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3307 * t3308 - 0.16e2 / 0.9e1 * t1476 * t535 * t538 + 0.4e1 / 0.3e1 * t534 * t3314 + 0.16e2 / 0.9e1 * t1480 * t1483 - 0.4e1 / 0.3e1 * t54 * t3291);
  t3325 = t96 * t186 * t3323;
  t3327 = 0.2618e4 / 0.81e2 * t3257 - 0.1232e4 / 0.27e2 * t3259 + 0.44e2 / 0.3e1 * t3261 + 0.44e2 / 0.3e1 * t3263 - 0.8e1 * t3265 - 0.8e1 / 0.3e1 * t3267 + 0.3e1 / 0.4e1 * t3271 + t3274 + t3297 / 0.4e1 + 0.3e1 / 0.4e1 * t3301 + t3304 + t3325 / 0.4e1;
  t3342 = 0.6e1 * t3239 + 0.12e2 * t3241 + 0.385e3 / 0.1296e4 * t1 * t2446 + 0.4e2 / 0.81e2 * t8 * t88 + 0.9e1 / 0.16e2 * t15 * t3248 + 0.4e2 / 0.81e2 * t22 * t213 + t110 * t3327 / 0.2e1 + 0.11e2 / 0.3e1 * t261 * t1533 + 0.2e2 / 0.3e1 * t613 * t574 + 0.55e2 / 0.6e1 * t618 * t574 - 0.16e2 / 0.27e2 * t1393 * t223 - 0.3e1 / 0.4e1 * t1397 * t223 - 0.2e2 / 0.27e2 * t1400 * t223;
  t3381 = t569 * t124;
  t3385 = 0.20944e5 / 0.81e2 * t123 / t126 / t3381;
  t3386 = 0.5236e4 / 0.81e2 * t3257 - 0.2464e4 / 0.27e2 * t3259 + 0.88e2 / 0.3e1 * t3261 + 0.88e2 / 0.3e1 * t3263 - 0.16e2 * t3265 - 0.16e2 / 0.3e1 * t3267 + 0.3e1 / 0.2e1 * t3271 + 0.2e1 * t3274 + t3297 / 0.2e1 + 0.3e1 / 0.2e1 * t3301 + 0.2e1 * t3304 + t3325 / 0.2e1 - t3385;
  t3388 = -0.55e2 / 0.108e3 * t1404 * t223 - 0.3e1 / 0.4e1 * t1407 * t248 - 0.2e2 / 0.27e2 * t1410 * t248 - 0.55e2 / 0.108e3 * t1413 * t248 + 0.4e1 / 0.3e1 * t588 * t642 + 0.9e1 / 0.4e1 * t591 * t642 + 0.1e2 / 0.3e1 * t594 * t642 + 0.55e2 / 0.12e2 * t598 * t642 + 0.9e1 / 0.4e1 * t601 * t546 + 0.1e2 / 0.3e1 * t604 * t546 + 0.55e2 / 0.12e2 * t607 * t546 + 0.9e1 / 0.2e1 * t610 * t574 + 0.2e2 / 0.3e1 * t201 * t1566 + t136 * t3386;
  t3395 = t142 * t676;
  t3396 = 0.72e2 * t3395;
  t3397 = t148 * t676;
  t3398 = 0.72e2 * t3397;
  t3420 = 0.22e2 / 0.3e1 * t205 * t1566 + t139 * t3386 + 0.8e1 * t209 * t1566 + t3396 + t3398 - 0.3e1 / 0.2e1 * t1416 * t199 - 0.4e2 / 0.27e2 * t1419 * t199 - 0.55e2 / 0.54e2 * t1422 * t199 + 0.2e2 / 0.81e2 * t29 * t88 * t60 + 0.9e1 / 0.32e2 * t63 * t3248 * t60 + 0.2e2 / 0.81e2 * t67 * t213 * t60 + 0.385e3 / 0.2592e4 * t71 * t1106 * t60 + 0.9e1 / 0.32e2 * t84 * t3248 * t101;
  t3436 = t154 * t676;
  t3437 = 0.72e2 * t3436;
  t3438 = t692 * t144;
  t3440 = t288 * t269;
  t3442 = t699 * t144;
  t3444 = t291 * t269;
  t3446 = t659 * t144;
  t3448 = t294 * t269;
  t3450 = t667 * t144;
  t3452 = t297 * t269;
  t3454 = 0.2e2 / 0.81e2 * t104 * t213 * t101 + 0.385e3 / 0.2592e4 * t109 * t1106 * t101 + 0.9e1 / 0.16e2 * t118 * t3248 * t130 + 0.4e2 / 0.81e2 * t132 * t213 * t130 + 0.385e3 / 0.1296e4 * t135 * t1106 * t130 + t3437 + 0.7e1 / 0.3e1 * t3438 - 0.56e2 * t3440 + 0.16e2 / 0.3e1 * t3442 - 0.64e2 * t3444 + 0.9e1 * t3446 - 0.72e2 * t3448 + 0.4e2 / 0.3e1 * t3450 - 0.8e2 * t3452;
  t3457 = t151 * t676;
  t3458 = 0.72e2 * t3457;
  t3476 = 0.91e3 / 0.81e2 * t31 / t9 / t1509 * t47 - 0.28e3 / 0.27e2 * t1451 * t217 + 0.14e2 / 0.3e1 * t631 * t636 - 0.4e1 / 0.3e1 * t214 * t1472 + t33 * t3295 * t46 / 0.4e1 + t51 * t3323 * t46 / 0.4e1;
  t3501 = t3458 + t30 * t3476 / 0.2e1 + 0.8e1 / 0.3e1 * t226 * t1491 + t64 * t3476 / 0.2e1 + 0.3e1 * t231 * t1491 + t68 * t3476 / 0.2e1 + 0.1e2 / 0.3e1 * t236 * t1491 + t81 * t3476 / 0.2e1 + 0.11e2 / 0.3e1 * t241 * t1491 + t85 * t3327 / 0.2e1 + 0.3e1 * t251 * t1533 + t105 * t3327 / 0.2e1 + 0.1e2 / 0.3e1 * t256 * t1533;
  t3510 = t294 * t1589;
  t3512 = t297 * t1465;
  t3514 = t297 * t1589;
  t3519 = t1624 * t178;
  t3521 = t1624 * t270;
  t3523 = t659 * t519;
  t3525 = t659 * t677;
  t3530 = t115 * t3327 / 0.2e1 + 0.4e1 * t266 * t1533 + t119 * t3386 + 0.6e1 * t168 * t1566 + t133 * t3386 - 0.144e3 * t3510 + 0.24e3 * t3512 - 0.16e3 * t3514 + 0.9e1 / 0.16e2 * t150 * t3248 * t145 - 0.3e1 * t3519 + 0.3e1 * t3521 - 0.36e2 * t3523 + 0.27e2 * t3525 + 0.4e2 / 0.81e2 * t153 * t213 * t145;
  t3532 = t1636 * t178;
  t3534 = t1636 * t270;
  t3536 = t667 * t519;
  t3538 = t667 * t677;
  t3540 = t142 * t3289;
  t3541 = 0.192e3 * t3540;
  t3542 = 0.1e1 / t3381;
  t3543 = t143 * t3542;
  t3545 = 0.12e3 * t142 * t3543;
  t3546 = t148 * t3289;
  t3547 = 0.192e3 * t3546;
  t3549 = 0.12e3 * t148 * t3543;
  t3550 = t151 * t3289;
  t3551 = 0.192e3 * t3550;
  t3553 = 0.12e3 * t151 * t3543;
  t3554 = t154 * t3289;
  t3555 = 0.192e3 * t3554;
  t3557 = 0.12e3 * t154 * t3543;
  t3561 = -0.8e2 / 0.27e2 * t3532 + 0.8e2 / 0.27e2 * t3534 - 0.16e3 / 0.3e1 * t3536 + 0.4e2 * t3538 - t3541 + t3545 - t3547 + t3549 - t3551 + t3553 - t3555 + t3557 + 0.385e3 / 0.1296e4 * t141 * t2446 * t145;
  t3562 = t1600 * t178;
  t3564 = t1600 * t270;
  t3566 = t692 * t519;
  t3568 = t692 * t677;
  t3570 = t288 * t1465;
  t3572 = t288 * t1589;
  t3577 = t1613 * t178;
  t3579 = t1613 * t270;
  t3581 = t699 * t519;
  t3583 = t699 * t677;
  t3585 = t291 * t1465;
  t3587 = t291 * t1589;
  t3589 = t294 * t1465;
  t3591 = -0.35e2 / 0.27e2 * t3562 + 0.35e2 / 0.27e2 * t3564 - 0.28e2 / 0.3e1 * t3566 + 0.7e1 * t3568 + 0.168e3 * t3570 - 0.112e3 * t3572 + 0.4e2 / 0.81e2 * t147 * t88 * t145 - 0.64e2 / 0.27e2 * t3577 + 0.64e2 / 0.27e2 * t3579 - 0.64e2 / 0.3e1 * t3581 + 0.16e2 * t3583 + 0.192e3 * t3585 - 0.128e3 * t3587 + 0.216e3 * t3589;
  tv4rho40 = t3342 + t3388 + t3420 + t3454 + t3501 + t3530 + t3561 + t3591;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 0] += tv4rho40;

  t3594 = t410 * t1465;
  t3595 = 0.54e2 * t3594;
  t3596 = t410 * t1589;
  t3598 = t413 * t1465;
  t3599 = 0.6e2 * t3598;
  t3600 = t413 * t1589;
  t3602 = t404 * t1465;
  t3603 = 0.42e2 * t3602;
  t3604 = t404 * t1589;
  t3606 = t407 * t1465;
  t3607 = 0.48e2 * t3606;
  t3608 = t407 * t1589;
  t3613 = t174 * t1707;
  t3615 = t174 * t1710;
  t3617 = t174 * t1727;
  t3619 = t1471 * t45;
  t3621 = t89 * t3619 * t313;
  t3624 = t89 * t1706 * t723;
  t3627 = t89 * t712 * t1726;
  t3653 = 0.32e2 * t719 * t1588;
  t3655 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3277 * t310 * t1459 - 0.16e2 / 0.9e1 * t1458 * t34 * t269 * t516 - 0.8e1 / 0.9e1 * t1712 * t179 * t521 + 0.8e1 / 0.3e1 * t515 * t269 * t179 - 0.8e1 * t1715 * t676 * t179 + 0.8e1 / 0.3e1 * t1715 * t269 * t521 + 0.4e1 / 0.9e1 * t716 * t1467 - 0.16e2 * t42 * t676 + t3653);
  t3657 = t89 * t177 * t3655;
  t3659 = t320 * t1527;
  t3661 = t320 * t1530;
  t3663 = t1487 * t45;
  t3665 = t96 * t3663 * t326;
  t3668 = t96 * t1734 * t740;
  t3671 = t96 * t729 * t1754;
  t3697 = 0.32e2 * t736 * t1588;
  t3699 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3307 * t323 * t1477 + 0.16e2 / 0.9e1 * t1476 * t34 * t269 * t535 - 0.8e1 / 0.9e1 * t1740 * t187 * t538 - 0.8e1 / 0.3e1 * t534 * t269 * t187 + 0.8e1 * t1743 * t676 * t187 - 0.8e1 / 0.3e1 * t1743 * t269 * t538 + 0.4e1 / 0.9e1 * t733 * t1483 + 0.16e2 * t54 * t676 - t3697);
  t3701 = t96 * t186 * t3699;
  t3703 = t505 * t713;
  t3705 = t505 * t724;
  t3707 = t1512 * t314;
  t3709 = -t3385 - 0.4e1 * t3613 - 0.8e1 * t3615 - 0.4e1 * t3617 + t3621 / 0.2e1 + 0.3e1 / 0.2e1 * t3624 + 0.3e1 / 0.2e1 * t3627 + t3657 / 0.2e1 - 0.4e1 * t3659 - 0.4e1 / 0.3e1 * t3661 + t3665 / 0.2e1 + 0.3e1 / 0.2e1 * t3668 + 0.3e1 / 0.2e1 * t3671 + t3701 / 0.2e1 + 0.44e2 / 0.3e1 * t3703 + 0.44e2 / 0.3e1 * t3705 - 0.616e3 / 0.27e2 * t3707;
  t3715 = t3595 - 0.36e2 * t3596 + t3599 - 0.4e2 * t3600 + t3603 - 0.28e2 * t3604 + t3607 - 0.32e2 * t3608 + 0.3e1 * t266 * t1826 + t397 * t1533 + t119 * t3709 + 0.9e1 / 0.2e1 * t168 * t1758 + 0.2e1 * t340 * t1566;
  t3729 = -0.7e2 / 0.27e2 * t1451 * t343 + 0.7e1 / 0.3e1 * t631 * t757 - t214 * t1779 + t33 * t3655 * t46 / 0.4e1 - t348 * t1488 / 0.3e1 + t51 * t3699 * t46 / 0.4e1;
  t3770 = -0.2e1 * t3613 - 0.4e1 * t3615 - 0.2e1 * t3617 + t3621 / 0.4e1 + 0.3e1 / 0.4e1 * t3624 + 0.3e1 / 0.4e1 * t3627 + t3657 / 0.4e1 - 0.2e1 * t3659 - 0.2e1 / 0.3e1 * t3661 + t3665 / 0.4e1 + 0.3e1 / 0.4e1 * t3668 + 0.3e1 / 0.4e1 * t3671 + t3701 / 0.4e1 + 0.22e2 / 0.3e1 * t3703 + 0.22e2 / 0.3e1 * t3705 - 0.308e3 / 0.27e2 * t3707;
  t3773 = t30 * t3729 / 0.2e1 + 0.2e1 * t226 * t1787 + 0.2e1 / 0.3e1 * t357 * t1491 + t64 * t3729 / 0.2e1 + 0.9e1 / 0.4e1 * t231 * t1787 + 0.3e1 / 0.4e1 * t362 * t1491 + t68 * t3729 / 0.2e1 + 0.5e1 / 0.2e1 * t236 * t1787 + 0.5e1 / 0.6e1 * t367 * t1491 + t81 * t3729 / 0.2e1 + 0.11e2 / 0.4e1 * t241 * t1787 + 0.11e2 / 0.12e2 * t372 * t1491 + t85 * t3770 / 0.2e1;
  t3801 = 0.9e1 / 0.4e1 * t251 * t1826 + 0.3e1 / 0.4e1 * t382 * t1533 + t105 * t3770 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t1826 + 0.1e2 / 0.3e1 * t613 * t744 + 0.55e2 / 0.12e2 * t618 * t744 + 0.2e1 / 0.3e1 * t588 * t765 + 0.9e1 / 0.8e1 * t591 * t765 + 0.5e1 / 0.3e1 * t594 * t765 + 0.55e2 / 0.24e2 * t598 * t765 + 0.9e1 / 0.8e1 * t601 * t797 + 0.5e1 / 0.3e1 * t604 * t797 + 0.3e1 / 0.2e1 * t400 * t1566;
  t3823 = t404 * t269;
  t3824 = 0.14e2 * t3823;
  t3825 = t407 * t269;
  t3826 = 0.16e2 * t3825;
  t3827 = t133 * t3709 + 0.5e1 * t201 * t1758 + 0.5e1 / 0.3e1 * t332 * t1566 + t136 * t3709 + 0.11e2 / 0.2e1 * t205 * t1758 + 0.11e2 / 0.6e1 * t336 * t1566 + t139 * t3709 + 0.6e1 * t209 * t1758 + 0.55e2 / 0.24e2 * t607 * t797 + 0.9e1 / 0.4e1 * t610 * t744 - 0.55e2 / 0.432e3 * t1413 * t378 - 0.3e1 / 0.8e1 * t1416 * t330 - t3824 - t3826;
  t3830 = t410 * t269;
  t3831 = 0.18e2 * t3830;
  t3832 = t413 * t269;
  t3833 = 0.2e2 * t3832;
  t3856 = -t3831 - t3833 - 0.1e2 / 0.27e2 * t1419 * t330 - 0.55e2 / 0.216e3 * t1422 * t330 - 0.4e1 / 0.27e2 * t1393 * t354 - 0.3e1 / 0.16e2 * t1397 * t354 - 0.5e1 / 0.27e2 * t1400 * t354 - 0.55e2 / 0.432e3 * t1404 * t354 - 0.3e1 / 0.16e2 * t1407 * t378 - 0.5e1 / 0.27e2 * t1410 * t378 + 0.5e1 / 0.6e1 * t387 * t1533 + t110 * t3770 / 0.2e1 + 0.11e2 / 0.4e1 * t261 * t1826;
  t3862 = 0.3e1 * t113 * t797;
  t3864 = 0.6e1 * t138 * t744;
  t3866 = 0.14e2 * t3440;
  t3868 = 0.16e2 * t3444;
  t3870 = 0.18e2 * t3448;
  t3872 = 0.2e2 * t3452;
  t3874 = 0.11e2 / 0.12e2 * t392 * t1533 + t115 * t3770 / 0.2e1 + t3862 + t3864 - 0.7e1 / 0.6e1 * t3438 + t3866 - 0.8e1 / 0.3e1 * t3442 + t3868 - 0.9e1 / 0.2e1 * t3446 + t3870 - 0.2e2 / 0.3e1 * t3450 + t3872 - 0.108e3 * t3510;
  t3876 = 0.6e2 * t3512;
  t3884 = 0.96e2 * t3540;
  t3885 = 0.96e2 * t3546;
  t3886 = 0.96e2 * t3550;
  t3887 = t3876 - 0.12e3 * t3514 + 0.3e1 / 0.4e1 * t3519 + 0.3e1 / 0.4e1 * t3521 + 0.27e2 / 0.2e1 * t3525 + 0.2e2 / 0.27e2 * t3532 + 0.2e2 / 0.27e2 * t3534 + 0.2e2 * t3538 - t3884 + t3545 - t3885 + t3549 - t3886;
  t3888 = 0.96e2 * t3554;
  t3892 = 0.42e2 * t3570;
  t3897 = 0.48e2 * t3585;
  t3899 = 0.54e2 * t3589;
  t3900 = t3553 - t3888 + t3557 + 0.35e2 / 0.108e3 * t3562 + 0.35e2 / 0.108e3 * t3564 + 0.7e1 / 0.2e1 * t3568 + t3892 - 0.84e2 * t3572 + 0.16e2 / 0.27e2 * t3577 + 0.16e2 / 0.27e2 * t3579 + 0.8e1 * t3583 + t3897 - 0.96e2 * t3587 + t3899;
  tv4rho41 = t3715 + t3773 + t3801 + t3827 + t3856 + t3874 + t3887 + t3900;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 1] += tv4rho41;

  t3903 = t1015 * t519;
  t3905 = t1015 * t677;
  t3907 = t1018 * t519;
  t3909 = t1018 * t677;
  t3911 = t1021 * t519;
  t3913 = t1021 * t677;
  t3915 = t1024 * t519;
  t3917 = t1024 * t677;
  t3925 = -0.14e2 / 0.9e1 * t3903 + 0.7e1 / 0.6e1 * t3905 - 0.32e2 / 0.9e1 * t3907 + 0.8e1 / 0.3e1 * t3909 - 0.6e1 * t3911 + 0.9e1 / 0.2e1 * t3913 - 0.8e2 / 0.9e1 * t3915 + 0.2e2 / 0.3e1 * t3917 + 0.36e2 * t3594 - 0.72e2 * t3596 + 0.4e2 * t3598 - 0.8e2 * t3600 + 0.28e2 * t3602 - 0.56e2 * t3604;
  t3961 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3277 * t868 * t516 - 0.64e2 / 0.27e2 * t1712 * t179 * t34 * t269 - 0.8e1 / 0.27e2 * t1929 * t521 + 0.32e2 / 0.9e1 * t515 * t143 * t3542 + 0.16e2 / 0.9e1 * t716 * t269 - 0.16e2 / 0.3e1 * t716 * t1465 - 0.8e1 / 0.27e2 * t1458 * t872 * t516 + 0.8e1 / 0.9e1 * t515 * t1939 * t179 + 0.4e1 / 0.9e1 * t1934 * t521 + t3653);
  t3994 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3307 * t887 * t535 + 0.64e2 / 0.27e2 * t1740 * t187 * t34 * t269 - 0.8e1 / 0.27e2 * t1958 * t538 + 0.32e2 / 0.9e1 * t534 * t143 * t3542 - 0.16e2 / 0.9e1 * t733 * t269 + 0.16e2 / 0.3e1 * t733 * t1465 - 0.8e1 / 0.27e2 * t1476 * t890 * t535 + 0.8e1 / 0.9e1 * t534 * t1966 * t187 + 0.4e1 / 0.9e1 * t1963 * t538 - t3697);
  t3998 = 0.7e1 / 0.9e1 * t631 * t877 - 0.2e1 / 0.3e1 * t214 * t2003 + t33 * t3961 * t46 / 0.4e1 + 0.7e1 / 0.9e1 * t882 * t639 - 0.2e1 / 0.3e1 * t348 * t1784 + t51 * t3994 * t46 / 0.4e1;
  t4008 = t96 * t729 * t1970;
  t4011 = t96 * t186 * t3994;
  t4013 = t505 * t916;
  t4015 = t174 * t1922;
  t4017 = t723 * t723;
  t4019 = t89 * t4017 * t45;
  t4022 = t89 * t1240 * t1726;
  t4024 = t174 * t1926;
  t4026 = t174 * t1944;
  t4029 = t89 * t1706 * t876;
  t4032 = t89 * t712 * t1943;
  t4035 = t89 * t177 * t3961;
  t4037 = t925 * t530;
  t4039 = t925 * t543;
  t4041 = t320 * t1735;
  t4043 = t320 * t1738;
  t4045 = t320 * t1755;
  t4047 = t740 * t740;
  t4049 = t96 * t4047 * t45;
  t4052 = t96 * t1318 * t1754;
  t4055 = t96 * t1734 * t894;
  t4057 = t505 * t919;
  t4059 = t4008 / 0.2e1 + t4011 / 0.4e1 + 0.22e2 / 0.9e1 * t4013 - 0.8e1 / 0.3e1 * t4015 + t4019 / 0.2e1 + t4022 / 0.2e1 - 0.4e1 / 0.3e1 * t4024 - 0.4e1 / 0.3e1 * t4026 + t4029 / 0.4e1 + t4032 / 0.2e1 + t4035 / 0.4e1 + 0.22e2 / 0.9e1 * t4037 + 0.22e2 / 0.9e1 * t4039 - 0.4e1 / 0.3e1 * t4041 - 0.8e1 / 0.3e1 * t4043 - 0.4e1 / 0.3e1 * t4045 + t4049 / 0.2e1 + t4052 / 0.2e1 + t4055 / 0.4e1 + 0.22e2 / 0.9e1 * t4057;
  t4070 = 0.32e2 * t3606 - 0.64e2 * t3608 + 0.28e2 / 0.3e1 * t3823 + 0.32e2 / 0.3e1 * t3825 + 0.12e2 * t3830 + 0.4e2 / 0.3e1 * t3832 + t64 * t3998 / 0.2e1 + 0.3e1 / 0.2e1 * t231 * t2013 + 0.3e1 / 0.2e1 * t362 * t1787 + 0.5e1 / 0.3e1 * t387 * t1826 + t110 * t4059 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t2037 + 0.11e2 / 0.6e1 * t392 * t1826 + t115 * t4059 / 0.2e1 + 0.2e1 * t266 * t2037;
  t4089 = t4032 + t4035 / 0.2e1 + 0.44e2 / 0.9e1 * t4037 + 0.44e2 / 0.9e1 * t4039 - 0.8e1 / 0.3e1 * t4041 - 0.16e2 / 0.3e1 * t4043 - 0.8e1 / 0.3e1 * t4045 + t4049 + t4052 + t4055 / 0.2e1 + 0.44e2 / 0.9e1 * t4057;
  t4090 = -t3385 + t4008 + t4011 / 0.2e1 + 0.44e2 / 0.9e1 * t4013 - 0.16e2 / 0.3e1 * t4015 + t4019 + t4022 - 0.8e1 / 0.3e1 * t4024 - 0.8e1 / 0.3e1 * t4026 + t4029 / 0.2e1 + t4089;
  t4114 = 0.2e1 * t397 * t1826 + t119 * t4090 + 0.3e1 * t168 * t1974 + 0.3e1 * t400 * t1758 + t133 * t4090 + 0.1e2 / 0.3e1 * t201 * t1974 + 0.1e2 / 0.3e1 * t332 * t1758 + t136 * t4090 + 0.11e2 / 0.3e1 * t205 * t1974 + 0.11e2 / 0.3e1 * t336 * t1758 + t30 * t3998 / 0.2e1 + 0.4e1 / 0.3e1 * t226 * t2013 + 0.4e1 / 0.3e1 * t357 * t1787 + 0.4e1 * t340 * t1758;
  t4145 = 0.2e1 / 0.9e1 * t975 * t642 + 0.3e1 / 0.8e1 * t978 * t642 + 0.5e1 / 0.9e1 * t981 * t642 + 0.55e2 / 0.72e2 * t985 * t642 + 0.3e1 / 0.8e1 * t988 * t546 + 0.5e1 / 0.9e1 * t991 * t546 + 0.55e2 / 0.72e2 * t995 * t546 + 0.3e1 / 0.4e1 * t998 * t574 + 0.1e2 / 0.9e1 * t1001 * t574 + 0.55e2 / 0.36e2 * t1004 * t574 + t68 * t3998 / 0.2e1 + 0.5e1 / 0.3e1 * t236 * t2013 + 0.5e1 / 0.3e1 * t367 * t1787 + t81 * t3998 / 0.2e1 + 0.11e2 / 0.6e1 * t241 * t2013;
  t4163 = t1018 * t144;
  t4165 = t1021 * t144;
  t4167 = t1024 * t144;
  t4175 = 0.11e2 / 0.6e1 * t372 * t1787 + t85 * t4059 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t2037 + 0.3e1 / 0.2e1 * t382 * t1826 + t105 * t4059 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t2037 + t139 * t4090 + 0.4e1 * t209 * t1974 + 0.8e1 / 0.9e1 * t4163 + 0.3e1 / 0.2e1 * t4165 + 0.2e2 / 0.9e1 * t4167 + 0.2e1 / 0.9e1 * t588 * t898 + 0.3e1 / 0.8e1 * t591 * t898 + 0.5e1 / 0.9e1 * t594 * t898;
  t4190 = t1015 * t144;
  t4193 = t113 * t937;
  t4194 = t138 * t962;
  t4199 = 0.55e2 / 0.72e2 * t598 * t898 + 0.3e1 / 0.8e1 * t601 * t937 + 0.5e1 / 0.9e1 * t604 * t937 + 0.55e2 / 0.72e2 * t607 * t937 + 0.3e1 / 0.4e1 * t610 * t962 + 0.1e2 / 0.9e1 * t613 * t962 + 0.55e2 / 0.36e2 * t618 * t962 + 0.7e1 / 0.18e2 * t4190 + t3239 + 0.2e1 * t3241 + t4193 + 0.2e1 * t4194 - 0.24e2 * t3395 - 0.24e2 * t3397 - 0.24e2 * t3436;
  t4215 = 0.7e1 / 0.18e2 * t3438 + 0.28e2 / 0.3e1 * t3440 + 0.8e1 / 0.9e1 * t3442 + 0.32e2 / 0.3e1 * t3444 + 0.3e1 / 0.2e1 * t3446 + 0.12e2 * t3448 + 0.2e2 / 0.9e1 * t3450 + 0.4e2 / 0.3e1 * t3452 - 0.24e2 * t3457 - 0.72e2 * t3510 - 0.4e2 * t3512 - 0.8e2 * t3514 + 0.6e1 * t3523 + 0.9e1 / 0.2e1 * t3525;
  t4227 = 0.8e2 / 0.9e1 * t3536 + 0.2e2 / 0.3e1 * t3538 + t3545 + t3549 + t3553 + t3557 + 0.14e2 / 0.9e1 * t3566 + 0.7e1 / 0.6e1 * t3568 - 0.28e2 * t3570 - 0.56e2 * t3572 + 0.32e2 / 0.9e1 * t3581 + 0.8e1 / 0.3e1 * t3583 - 0.32e2 * t3585 - 0.64e2 * t3587 - 0.36e2 * t3589;
  tv4rho42 = t3925 + t4070 + t4114 + t4145 + t4175 + t4199 + t4215 + t4227;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 2] += tv4rho42;

  t4234 = t2130 * t270;
  t4236 = t2121 * t178;
  t4238 = t2121 * t270;
  t4240 = t2124 * t178;
  t4242 = t2124 * t270;
  t4244 = t2127 * t178;
  t4246 = t2127 * t270;
  t4248 = t2130 * t178;
  t4250 = 0.7e1 / 0.2e1 * t3905 + 0.8e1 * t3909 + 0.27e2 / 0.2e1 * t3913 + 0.2e2 * t3917 + 0.2e2 / 0.27e2 * t4234 - 0.35e2 / 0.108e3 * t4236 + 0.35e2 / 0.108e3 * t4238 - 0.16e2 / 0.27e2 * t4240 + 0.16e2 / 0.27e2 * t4242 - 0.3e1 / 0.4e1 * t4244 + 0.3e1 / 0.4e1 * t4246 - 0.2e2 / 0.27e2 * t4248 - t3595;
  t4257 = -0.108e3 * t3596 - t3599 - 0.12e3 * t3600 - t3603 - 0.84e2 * t3604 - t3607 - 0.96e2 * t3608 + t3824 + t3826 + t3831 + t3833 - 0.8e1 / 0.3e1 * t4163 - 0.9e1 / 0.2e1 * t4165;
  t4283 = -0.2e2 / 0.3e1 * t4167 - 0.7e1 / 0.6e1 * t4190 + 0.9e1 / 0.8e1 * t988 * t797 + 0.5e1 / 0.3e1 * t991 * t797 + 0.55e2 / 0.24e2 * t995 * t797 + 0.9e1 / 0.4e1 * t998 * t744 + 0.1e2 / 0.3e1 * t1001 * t744 + 0.55e2 / 0.12e2 * t1004 * t744 - 0.4e1 / 0.27e2 * t2287 * t223 - 0.3e1 / 0.16e2 * t2290 * t223 - 0.5e1 / 0.27e2 * t2293 * t223 - 0.55e2 / 0.432e3 * t2297 * t223 - 0.3e1 / 0.16e2 * t2302 * t248;
  t4298 = t174 * t2148;
  t4301 = t89 * t2712 * t876;
  t4304 = t89 * t1240 * t1943;
  t4306 = t174 * t2162;
  t4309 = t89 * t712 * t2161;
  t4329 = 0.12e2 * t676 + 0.24e2 * t3289;
  t4333 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3277 * t2151 * t179 - 0.16e2 / 0.9e1 * t1929 * t519 - 0.8e1 / 0.9e1 * t1712 * t872 * t179 + 0.8e1 / 0.3e1 * t1715 * t269 * t872 + 0.4e1 / 0.3e1 * t716 * t1939 + 0.4e1 / 0.9e1 * t515 * t2157 * t179 + 0.4e1 / 0.3e1 * t42 * t4329);
  t4335 = t89 * t177 * t4333;
  t4337 = t2168 * t191;
  t4339 = t925 * t730;
  t4341 = t925 * t741;
  t4343 = t320 * t1953;
  t4345 = t320 * t1955;
  t4347 = t320 * t1971;
  t4350 = t96 * t2858 * t894;
  t4353 = t96 * t1318 * t1970;
  t4356 = t96 * t729 * t2189;
  t4378 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3307 * t2180 * t187 + 0.16e2 / 0.9e1 * t1958 * t519 - 0.8e1 / 0.9e1 * t1740 * t890 * t187 - 0.8e1 / 0.3e1 * t1743 * t269 * t890 + 0.4e1 / 0.3e1 * t733 * t1966 + 0.4e1 / 0.9e1 * t534 * t2185 * t187 - 0.4e1 / 0.3e1 * t54 * t4329);
  t4380 = t96 * t186 * t4378;
  t4382 = -0.2e1 * t4298 + 0.3e1 / 0.4e1 * t4301 + 0.3e1 / 0.4e1 * t4304 - 0.2e1 / 0.3e1 * t4306 + t4309 / 0.4e1 + t4335 / 0.4e1 - 0.308e3 / 0.27e2 * t4337 + 0.22e2 / 0.3e1 * t4339 + 0.22e2 / 0.3e1 * t4341 - 0.4e1 * t4343 - 0.2e1 * t4345 - 0.2e1 * t4347 + 0.3e1 / 0.4e1 * t4350 + 0.3e1 / 0.4e1 * t4353 + t4356 / 0.4e1 + t4380 / 0.4e1;
  t4410 = -0.4e1 * t4298 + 0.3e1 / 0.2e1 * t4301 + 0.3e1 / 0.2e1 * t4304 - 0.4e1 / 0.3e1 * t4306 + t4309 / 0.2e1 + t4335 / 0.2e1 - 0.616e3 / 0.27e2 * t4337 + 0.44e2 / 0.3e1 * t4339 + 0.44e2 / 0.3e1 * t4341 - 0.8e1 * t4343 - 0.4e1 * t4345 - 0.4e1 * t4347 + 0.3e1 / 0.2e1 * t4350 + 0.3e1 / 0.2e1 * t4353 + t4356 / 0.2e1 + t4380 / 0.2e1 - t3385;
  t4412 = -0.5e1 / 0.27e2 * t2305 * t248 - 0.55e2 / 0.432e3 * t2308 * t248 - 0.3e1 / 0.8e1 * t2311 * t199 - 0.1e2 / 0.27e2 * t2314 * t199 - 0.55e2 / 0.216e3 * t2317 * t199 + 0.5e1 / 0.6e1 * t256 * t2229 + 0.5e1 / 0.2e1 * t387 * t2037 + t110 * t4382 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t2229 + 0.11e2 / 0.4e1 * t392 * t2037 + t115 * t4382 / 0.2e1 + t266 * t2229 + 0.3e1 * t397 * t2037 + t119 * t4410;
  t4442 = -t214 * t2197 / 0.3e1 + t33 * t4333 * t46 / 0.4e1 - 0.7e2 / 0.27e2 * t2202 * t220 + 0.7e1 / 0.3e1 * t882 * t762 - t348 * t2010 + t51 * t4378 * t46 / 0.4e1;
  t4453 = 0.3e1 / 0.2e1 * t168 * t2193 + 0.9e1 / 0.2e1 * t400 * t1974 + t133 * t4410 + 0.5e1 / 0.3e1 * t201 * t2193 + 0.5e1 * t332 * t1974 + t136 * t4410 + 0.11e2 / 0.6e1 * t205 * t2193 + 0.11e2 / 0.2e1 * t336 * t1974 + t30 * t4442 / 0.2e1 + 0.2e1 / 0.3e1 * t226 * t2211 + 0.2e1 * t357 * t2013 + t64 * t4442 / 0.2e1 + 0.3e1 / 0.4e1 * t231 * t2211;
  t4479 = 0.9e1 / 0.4e1 * t362 * t2013 + 0.2e1 / 0.3e1 * t975 * t765 + 0.9e1 / 0.8e1 * t978 * t765 + 0.5e1 / 0.3e1 * t981 * t765 + 0.55e2 / 0.24e2 * t985 * t765 + t139 * t4410 + 0.2e1 * t209 * t2193 + 0.6e1 * t340 * t1974 + t68 * t4442 / 0.2e1 + 0.5e1 / 0.6e1 * t236 * t2211 + 0.5e1 / 0.2e1 * t367 * t2013 + t81 * t4442 / 0.2e1 + 0.11e2 / 0.12e2 * t241 * t2211;
  t4492 = 0.11e2 / 0.4e1 * t372 * t2013 + t85 * t4382 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t2229 + 0.9e1 / 0.4e1 * t382 * t2037 + t105 * t4382 / 0.2e1 + t3862 + t3864 - t3866 - t3868 - t3870 - t3872 - 0.36e2 * t3510 - t3876;
  t4496 = -0.4e2 * t3514 + t3884 + t3545 + t3885 + t3549 + t3886 + t3553 + t3888 + t3557 - t3892 - 0.28e2 * t3572 - t3897 - 0.32e2 * t3587 - t3899;
  tv4rho43 = t4250 + t4257 + t4283 + t4412 + t4453 + t4479 + t4492 + t4496;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 3] += tv4rho43;

  t4506 = 0.1e1 / t18 / t93;
  t4522 = 0.385e3 / 0.1296e4 * t141 * t3117 * t145 + 0.4e2 / 0.81e2 * t147 * t95 * t145 + 0.9e1 / 0.16e2 * t150 * t4506 * t145 + 0.4e2 / 0.81e2 * t153 * t347 * t145 + 0.28e2 / 0.3e1 * t3903 + 0.7e1 * t3905 + 0.64e2 / 0.3e1 * t3907 + 0.16e2 * t3909 + 0.36e2 * t3911 + 0.27e2 * t3913 + 0.16e3 / 0.3e1 * t3915 + 0.4e2 * t3917 + 0.8e2 / 0.27e2 * t4234;
  t4537 = 0.35e2 / 0.27e2 * t4236 + 0.35e2 / 0.27e2 * t4238 + 0.64e2 / 0.27e2 * t4240 + 0.64e2 / 0.27e2 * t4242 + 0.3e1 * t4244 + 0.3e1 * t4246 + 0.8e2 / 0.27e2 * t4248 - 0.216e3 * t3594 - 0.144e3 * t3596 - 0.24e3 * t3598 - 0.16e3 * t3600 - 0.168e3 * t3602 - 0.112e3 * t3604 - 0.192e3 * t3606;
  t4550 = t876 * t876;
  t4552 = t89 * t4550 * t45;
  t4555 = t89 * t1240 * t2161;
  t4557 = t868 * t868;
  t4562 = t872 * t872;
  t4568 = 0.24e2 * t676 + 0.24e2 * t3289;
  t4572 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3277 * t4557 - 0.16e2 / 0.9e1 * t1929 * t872 + 0.4e1 / 0.3e1 * t515 * t4562 + 0.16e2 / 0.9e1 * t716 * t2157 + 0.4e1 / 0.3e1 * t42 * t4568);
  t4574 = t89 * t177 * t4572;
  t4580 = sigma[2] / t25 / t922 / t93 * t98;
  t4582 = t2168 * t327;
  t4584 = t925 * t931;
  t4586 = t925 * t934;
  t4588 = t320 * t2177;
  t4590 = t320 * t2190;
  t4592 = t894 * t894;
  t4594 = t96 * t4592 * t45;
  t4597 = t96 * t1318 * t2189;
  t4599 = t887 * t887;
  t4604 = t890 * t890;
  t4613 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3307 * t4599 - 0.16e2 / 0.9e1 * t1958 * t890 + 0.4e1 / 0.3e1 * t534 * t4604 + 0.16e2 / 0.9e1 * t733 * t2185 - 0.4e1 / 0.3e1 * t54 * t4568);
  t4615 = t96 * t186 * t4613;
  t4617 = 0.3e1 / 0.2e1 * t4552 + 0.2e1 * t4555 + t4574 / 0.2e1 + 0.5236e4 / 0.81e2 * t4580 - 0.2464e4 / 0.27e2 * t4582 + 0.88e2 / 0.3e1 * t4584 + 0.88e2 / 0.3e1 * t4586 - 0.16e2 * t4588 - 0.16e2 / 0.3e1 * t4590 + 0.3e1 / 0.2e1 * t4594 + 0.2e1 * t4597 + t4615 / 0.2e1 - t3385;
  t4638 = t33 * t4572 * t46 / 0.4e1 + 0.91e3 / 0.81e2 * t49 / t11 / t2165 * t57 - 0.28e3 / 0.27e2 * t2202 * t351 + 0.14e2 / 0.3e1 * t882 * t895 - 0.4e1 / 0.3e1 * t348 * t2208 + t51 * t4613 * t46 / 0.4e1;
  t4641 = -0.128e3 * t3608 - 0.56e2 * t3823 - 0.64e2 * t3825 - 0.72e2 * t3830 - 0.8e2 * t3832 + 0.16e2 / 0.3e1 * t4163 + 0.9e1 * t4165 + 0.4e2 / 0.3e1 * t4167 + 0.7e1 / 0.3e1 * t4190 + 0.2e2 / 0.3e1 * t332 * t2193 + t136 * t4617 + 0.22e2 / 0.3e1 * t336 * t2193 + t30 * t4638 / 0.2e1;
  t4668 = 0.3e1 / 0.4e1 * t4552 + t4555 + t4574 / 0.4e1 + 0.2618e4 / 0.81e2 * t4580 - 0.1232e4 / 0.27e2 * t4582 + 0.44e2 / 0.3e1 * t4584 + 0.44e2 / 0.3e1 * t4586 - 0.8e1 * t4588 - 0.8e1 / 0.3e1 * t4590 + 0.3e1 / 0.4e1 * t4594 + t4597 + t4615 / 0.4e1;
  t4681 = 0.8e1 / 0.3e1 * t357 * t2211 + t64 * t4638 / 0.2e1 + 0.3e1 * t362 * t2211 + 0.8e1 * t340 * t2193 + t68 * t4638 / 0.2e1 + 0.1e2 / 0.3e1 * t367 * t2211 + t81 * t4638 / 0.2e1 + 0.11e2 / 0.3e1 * t372 * t2211 + t85 * t4668 / 0.2e1 + 0.3e1 * t382 * t2229 + t105 * t4668 / 0.2e1 + 0.1e2 / 0.3e1 * t387 * t2229 + t110 * t4668 / 0.2e1 + 0.11e2 / 0.3e1 * t392 * t2229;
  t4707 = t115 * t4668 / 0.2e1 + 0.4e1 * t397 * t2229 + t119 * t4617 + 0.6e1 * t400 * t2193 + t133 * t4617 + t139 * t4617 - 0.16e2 / 0.27e2 * t2287 * t354 - 0.3e1 / 0.4e1 * t2290 * t354 - 0.2e2 / 0.27e2 * t2293 * t354 - 0.55e2 / 0.108e3 * t2297 * t354 - 0.3e1 / 0.4e1 * t2302 * t378 - 0.2e2 / 0.27e2 * t2305 * t378 - 0.55e2 / 0.108e3 * t2308 * t378;
  t4746 = -0.3e1 / 0.2e1 * t2311 * t330 - 0.4e2 / 0.27e2 * t2314 * t330 - 0.55e2 / 0.54e2 * t2317 * t330 + 0.2e2 / 0.81e2 * t29 * t95 * t60 + 0.9e1 / 0.32e2 * t63 * t4506 * t60 + 0.2e2 / 0.81e2 * t67 * t347 * t60 + 0.385e3 / 0.2592e4 * t71 * t1335 * t60 + 0.9e1 / 0.32e2 * t84 * t4506 * t101 + 0.2e2 / 0.81e2 * t104 * t347 * t101 + 0.385e3 / 0.2592e4 * t109 * t1335 * t101 + 0.9e1 / 0.16e2 * t118 * t4506 * t130 + 0.4e2 / 0.81e2 * t132 * t347 * t130 + 0.385e3 / 0.1296e4 * t135 * t1335 * t130 + 0.1e2 / 0.3e1 * t981 * t898;
  t4768 = 0.55e2 / 0.12e2 * t985 * t898 + 0.9e1 / 0.4e1 * t988 * t937 + 0.1e2 / 0.3e1 * t991 * t937 + 0.55e2 / 0.12e2 * t995 * t937 + 0.9e1 / 0.2e1 * t998 * t962 + 0.2e2 / 0.3e1 * t1001 * t962 + 0.55e2 / 0.6e1 * t1004 * t962 + 0.4e1 / 0.3e1 * t975 * t898 + 0.9e1 / 0.4e1 * t978 * t898 + 0.6e1 * t4193 + 0.12e2 * t4194 + t3396 + t3398;
  t4777 = t3437 + t3458 + 0.385e3 / 0.1296e4 * t1 * t3117 + 0.4e2 / 0.81e2 * t8 * t95 + 0.9e1 / 0.16e2 * t15 * t4506 + 0.4e2 / 0.81e2 * t22 * t347 + t3541 + t3545 + t3547 + t3549 + t3551 + t3553 + t3555 + t3557;
  tv4rho44 = t4522 + t4537 + t4641 + t4681 + t4707 + t4746 + t4768 + t4777;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->out_dim->v4rho4 + 4] += tv4rho44;

  t4789 = t418 * t525 * t46;
  t4811 = t173 * t510 * t45;
  t4820 = t1511 * t90 * t45;
  t4828 = 0.9e1 / 0.16e2 * t1107 * t526 + 0.5e1 / 0.8e1 * t1111 * t526 + 0.11e2 / 0.16e2 * t1115 * t526 + 0.3e1 / 0.4e1 * t1119 * t526 + t1052 * t4789 / 0.4e1 + 0.9e1 / 0.32e2 * t1057 * t4789 - 0.7e1 / 0.12e2 * t2432 * t2406 - 0.39e2 / 0.64e2 * t2423 * t2406 + 0.85e2 / 0.128e3 * t63 * t2446 * t1054 + 0.145e3 / 0.216e3 * t67 * t88 * t1054 + 0.2321e4 / 0.3456e4 * t71 * t3248 * t1054 + 0.35e2 / 0.54e2 * t29 * t2440 * t1054 - t105 * t4811 - 0.5e1 / 0.8e1 * t2426 * t2406 + 0.5e1 / 0.16e2 * t1060 * t4789 + 0.11e2 / 0.32e2 * t1063 * t4789 - 0.77e2 / 0.27e2 * t105 * t4820 - 0.77e2 / 0.27e2 * t85 * t4820 - t85 * t4811 - 0.77e2 / 0.27e2 * t110 * t4820;
  t4841 = t2450 * t183;
  t4845 = t213 * t525 * t46;
  t4855 = t105 * t504;
  t4859 = t630 * t182 * t46;
  t4867 = t32 * t1471 * t46;
  t4876 = -t424 * t4845 / 0.4e1 - t427 * t4845 / 0.4e1 - t430 * t4845 / 0.4e1 + 0.11e2 / 0.3e1 * t4855 * t183 + 0.7e1 / 0.12e2 * t427 * t4859 + 0.7e1 / 0.12e2 * t430 * t4859 + t1069 * t1524 / 0.8e1 + t419 * t4867 / 0.16e2 + t424 * t4867 / 0.16e2 + t427 * t4867 / 0.16e2 + t430 * t4867 / 0.16e2;
  t4879 = t85 * t504;
  t4889 = t110 * t504;
  t4897 = t115 * t504;
  t4909 = t1450 * t44 * t46;
  t4929 = -t2356 * t526 + 0.3e1 / 0.8e1 * t1069 * t1521 + 0.7e1 / 0.12e2 * t419 * t4859 + 0.7e1 / 0.12e2 * t424 * t4859 - 0.35e2 / 0.54e2 * t424 * t4909 - 0.35e2 / 0.54e2 * t427 * t4909 - 0.35e2 / 0.54e2 * t430 * t4909 - 0.35e2 / 0.54e2 * t419 * t4909 + t1035 * t1524 / 0.8e1 + 0.535e3 / 0.216e3 * t104 / t502 * t91 + 0.8921e4 / 0.3456e4 * t109 / t74 / t171 * t91;
  t4932 = t113 * t173 * t91;
  t4947 = t138 * t1092;
  t4950 = t504 * t44;
  t4960 = 0.1232e4 / 0.27e2 * t1563;
  t4961 = -0.308e3 / 0.27e2 * t4820 + 0.44e2 / 0.3e1 * t4950 * t712 - 0.4e1 * t4811 - 0.4e1 * t2456 * t1706 + 0.3e1 / 0.2e1 * t2709 * t1706 + t1088 * t3619 / 0.2e1 + t4960;
  t4987 = 0.11e2 / 0.2e1 * t205 * t2463 + t139 * t4961 + 0.6e1 * t209 * t2463 + t119 * t4961 + 0.9e1 / 0.2e1 * t168 * t2463 - 0.3e1 / 0.8e1 * t1416 * t444 - 0.1e2 / 0.27e2 * t1419 * t444 - 0.55e2 / 0.216e3 * t1422 * t444 + 0.9e1 / 0.4e1 * t610 * t1092 + 0.1e2 / 0.3e1 * t613 * t1092 + 0.55e2 / 0.12e2 * t618 * t1092;
  tv4rho3sigma0 = -t2346 * t526 - t419 * t4845 / 0.4e1 + 0.11e2 / 0.3e1 * t4879 * t183 - t2372 * t526 + 0.3e1 / 0.8e1 * t1035 * t1521 + 0.3e1 / 0.8e1 * t1038 * t1521 + t1038 * t1524 / 0.8e1 + 0.11e2 / 0.3e1 * t4889 * t183 - t2351 * t526 + 0.3e1 / 0.8e1 * t1066 * t1521 + t1066 * t1524 / 0.8e1 + 0.11e2 / 0.3e1 * t4897 * t183 + 0.9e1 / 0.16e2 * t1107 * t511 + 0.5e1 / 0.8e1 * t1111 * t511 + 0.11e2 / 0.16e2 * t1115 * t511 + 0.3e1 / 0.4e1 * t1119 * t511 + t133 * t4961 + 0.5e1 * t201 * t2463 + t136 * t4961 - t110 * t4811 - 0.77e2 / 0.27e2 * t115 * t4820 - t115 * t4811 - 0.121e3 / 0.192e3 * t2429 * t2406 - 0.87e2 / 0.32e2 * t2437 * t183 - 0.35e2 / 0.12e2 * t2441 * t183 - 0.99e2 / 0.32e2 * t2447 * t183 + t4987 + 0.6e1 * t4947 + 0.8e1 / 0.3e1 * t4932 + t4929 + t4876 - 0.13e2 / 0.4e1 * t4841 + t4828 + 0.301e3 / 0.128e3 * t84 / t2 / t502 * t91;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 0] += tv4rho3sigma0;

  t4992 = t610 * t196;
  t4994 = t168 * t571;
  t4997 = 0.2464e4 / 0.27e2 * t119 * t1563;
  t5000 = t613 * t196;
  t5002 = t201 * t571;
  t5005 = 0.2464e4 / 0.27e2 * t133 * t1563;
  t5008 = t618 * t196;
  t5010 = t205 * t571;
  t5013 = 0.2464e4 / 0.27e2 * t136 * t1563;
  t5014 = t138 * t196;
  t5015 = 0.32e2 * t5014;
  t5016 = t209 * t571;
  t5019 = 0.2464e4 / 0.27e2 * t139 * t1563;
  tv4rho3sigma1 = 0.3e1 / 0.4e1 * t1416 * t128 + 0.12e2 * t4992 - 0.88e2 * t4994 + t4997 + 0.2e2 / 0.27e2 * t1419 * t128 + 0.16e3 / 0.9e1 * t5000 - 0.88e3 / 0.9e1 * t5002 + t5005 + 0.55e2 / 0.108e3 * t1422 * t128 + 0.22e3 / 0.9e1 * t5008 - 0.968e3 / 0.9e1 * t5010 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 1] += tv4rho3sigma1;

  t5020 = t2575 * t191;
  t5039 = t50 * t1487 * t46;
  t5048 = 0.3e1 / 0.4e1 * t5020 + 0.3e1 / 0.4e1 * t266 * t2560 + 0.11e2 / 0.16e2 * t261 * t2560 + 0.9e1 / 0.16e2 * t251 * t2560 - 0.5e1 / 0.216e3 * t1410 * t470 + 0.5e1 / 0.8e1 * t256 * t2560 - 0.55e2 / 0.3456e4 * t1413 * t470 - 0.3e1 / 0.128e3 * t1407 * t470 + t1139 * t2511 / 0.4e1 + t455 * t5039 / 0.16e2 + 0.9e1 / 0.32e2 * t1146 * t2511 + t460 * t5039 / 0.16e2 + 0.5e1 / 0.16e2 * t1151 * t2511;
  t5055 = t604 * t95;
  t5064 = t607 * t95;
  t5077 = t601 * t95;
  t5080 = 0.9e1 / 0.16e2 * t2514 * t543 + 0.3e1 / 0.8e1 * t1163 * t1527 + t1163 * t1530 / 0.8e1 + 0.5e1 / 0.12e2 * t5055 * t191 + 0.5e1 / 0.8e1 * t2519 * t543 + 0.3e1 / 0.8e1 * t1168 * t1527 + t1168 * t1530 / 0.8e1 + 0.55e2 / 0.96e2 * t5064 * t191 + 0.3e1 / 0.8e1 * t1179 * t1527 + t1179 * t1530 / 0.8e1 + 0.3e1 / 0.4e1 * t2529 * t543 + t466 * t5039 / 0.16e2 + 0.11e2 / 0.32e2 * t1156 * t2511 + 0.9e1 / 0.32e2 * t5077 * t191;
  t5110 = t138 * t1187;
  t5112 = -0.5e1 / 0.216e3 * t1400 * t454 * t457 - 0.55e2 / 0.3456e4 * t1404 * t454 * t457 - t1393 * t454 * t457 / 0.54e2 + t2555 * t1143 / 0.12e2 + 0.9e1 / 0.64e2 * t2546 * t1143 + 0.5e1 / 0.24e2 * t2549 * t1143 + 0.55e2 / 0.192e3 * t2552 * t1143 - 0.3e1 / 0.128e3 * t1397 * t454 * t457 + t463 * t5039 / 0.16e2 + 0.11e2 / 0.16e2 * t2524 * t543 + 0.3e1 / 0.8e1 * t1174 * t1527 + t1174 * t1530 / 0.8e1 + 0.6e1 * t5110;
  t5125 = 0.3e1 / 0.2e1 * t2855 * t1734 + t1184 * t3663 / 0.2e1 + t4960;
  t5142 = 0.9e1 / 0.4e1 * t610 * t1187 + 0.1e2 / 0.3e1 * t613 * t1187 + 0.55e2 / 0.12e2 * t618 * t1187 + 0.9e1 / 0.2e1 * t168 * t2591 + t119 * t5125 + 0.5e1 * t201 * t2591 + t133 * t5125 + 0.11e2 / 0.2e1 * t205 * t2591 + t136 * t5125 + 0.6e1 * t209 * t2591 + t139 * t5125 - 0.3e1 / 0.8e1 * t1416 * t480 - 0.1e2 / 0.27e2 * t1419 * t480 - 0.55e2 / 0.216e3 * t1422 * t480;
  tv4rho3sigma2 = t5048 + t5080 + t5112 + t5142;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 2] += tv4rho3sigma2;

  t5145 = t418 * t723 * t46;
  t5170 = 0.3e1 / 0.16e2 * t1057 * t5145 + 0.5e1 / 0.24e2 * t1060 * t5145 + 0.11e2 / 0.48e2 * t1063 * t5145 + 0.3e1 / 0.8e1 * t1107 * t713 + 0.3e1 / 0.8e1 * t1107 * t724 + 0.5e1 / 0.12e2 * t1111 * t713 + 0.5e1 / 0.12e2 * t1111 * t724 + 0.11e2 / 0.24e2 * t1115 * t713 + 0.11e2 / 0.24e2 * t1115 * t724 + t1119 * t713 / 0.2e1 + t1119 * t724 / 0.2e1 + t1052 * t5145 / 0.6e1;
  t5179 = t2450 * t314;
  t5197 = -0.121e3 / 0.576e3 * t2429 * t2687 - 0.29e2 / 0.32e2 * t2437 * t314 - 0.35e2 / 0.36e2 * t2441 * t314 - 0.33e2 / 0.32e2 * t2447 * t314 - 0.13e2 / 0.12e2 * t5179 + 0.11e2 / 0.12e2 * t382 * t2388 + 0.3e1 / 0.16e2 * t382 * t2384 - 0.7e1 / 0.36e2 * t2432 * t2687 - 0.13e2 / 0.64e2 * t2423 * t2687 - 0.5e1 / 0.24e2 * t2426 * t2687 + 0.11e2 / 0.9e1 * t397 * t2388 + t397 * t2384 / 0.4e1 + 0.55e2 / 0.54e2 * t387 * t2388;
  t5210 = t213 * t723 * t46;
  t5216 = t630 * t313 * t46;
  t5227 = 0.5e1 / 0.24e2 * t387 * t2384 + 0.121e3 / 0.108e3 * t392 * t2388 + 0.11e2 / 0.48e2 * t392 * t2384 + 0.3e1 / 0.16e2 * t2627 * t526 - 0.5e1 / 0.18e2 * t1211 * t2341 - t427 * t5210 / 0.6e1 + 0.77e2 / 0.216e3 * t1216 * t2333 + 0.7e1 / 0.36e2 * t430 * t5216 + 0.11e2 / 0.9e1 * t4879 * t314 - 0.2e1 / 0.3e1 * t2372 * t713 - 0.2e1 / 0.3e1 * t2372 * t724 - 0.2e1 / 0.3e1 * t2346 * t713;
  t5251 = t32 * t1726 * t46;
  t5254 = t382 * t173;
  t5256 = -0.2e1 / 0.3e1 * t2346 * t724 - 0.2e1 / 0.3e1 * t2351 * t713 - 0.2e1 / 0.3e1 * t2351 * t724 - 0.2e1 / 0.3e1 * t2356 * t713 - 0.2e1 / 0.3e1 * t2356 * t724 - 0.11e2 / 0.36e2 * t1216 * t2341 - t430 * t5210 / 0.6e1 + t1069 * t1707 / 0.8e1 + t1069 * t1710 / 0.4e1 + t1069 * t1727 / 0.8e1 + 0.11e2 / 0.96e2 * t1216 * t2362 + t430 * t5251 / 0.16e2 - t5254 * t183;
  t5283 = 0.11e2 / 0.9e1 * t4855 * t314 + 0.11e2 / 0.9e1 * t4889 * t314 + 0.11e2 / 0.9e1 * t4897 * t314 + 0.7e1 / 0.27e2 * t1199 * t2333 + 0.7e1 / 0.36e2 * t419 * t5216 + 0.7e1 / 0.24e2 * t1206 * t2333 + 0.7e1 / 0.36e2 * t424 * t5216 + 0.35e2 / 0.108e3 * t1211 * t2333 + 0.7e1 / 0.36e2 * t427 * t5216 - 0.2e1 / 0.9e1 * t1199 * t2341 - t419 * t5210 / 0.6e1 - t1206 * t2341 / 0.4e1;
  t5306 = t387 * t173;
  t5311 = -t424 * t5210 / 0.6e1 + t2649 * t526 / 0.4e1 + t1199 * t2362 / 0.12e2 + t419 * t5251 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t2362 + t424 * t5251 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t2362 + t427 * t5251 / 0.16e2 + t1035 * t1707 / 0.8e1 + t1035 * t1710 / 0.4e1 + t1035 * t1727 / 0.8e1 - 0.1e2 / 0.9e1 * t5306 * t183 + 0.5e1 / 0.24e2 * t2634 * t526;
  t5319 = t392 * t173;
  t5330 = t397 * t173;
  t5333 = t138 * t1243;
  t5339 = t1038 * t1707 / 0.8e1 + t1038 * t1710 / 0.4e1 + t1038 * t1727 / 0.8e1 - 0.11e2 / 0.9e1 * t5319 * t183 + 0.11e2 / 0.48e2 * t2642 * t526 + t1066 * t1707 / 0.8e1 + t1066 * t1710 / 0.4e1 + t1066 * t1727 / 0.8e1 - 0.4e1 / 0.3e1 * t5330 * t183 + 0.2e1 * t5333 + 0.55e2 / 0.36e2 * t618 * t1243 + 0.3e1 / 0.4e1 * t610 * t1243;
  t5358 = 0.44e2 / 0.9e1 * t4950 * t1240 - 0.8e1 / 0.3e1 * t173 * t182 * t1240 - 0.8e1 / 0.3e1 * t2456 * t2712 + t88 * t525 * t1240 / 0.2e1 + t2709 * t2712 + t1088 * t45 * t1726 / 0.2e1 + t4960;
  t5377 = 0.1e2 / 0.9e1 * t613 * t1243 + 0.2e1 * t340 * t2463 + t139 * t5358 + 0.4e1 * t209 * t2715 + 0.3e1 / 0.2e1 * t400 * t2463 + t119 * t5358 + 0.3e1 * t168 * t2715 + 0.5e1 / 0.3e1 * t332 * t2463 + t133 * t5358 + 0.1e2 / 0.3e1 * t201 * t2715 + 0.11e2 / 0.6e1 * t336 * t2463 + t136 * t5358 + 0.11e2 / 0.3e1 * t205 * t2715;
  tv4rho3sigma3 = t5170 + t5197 + t5227 + t5256 + t5283 + t5311 + t5339 + t5377;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 3] += tv4rho3sigma3;

  t5380 = t400 * t571;
  t5384 = t332 * t571;
  t5388 = t336 * t571;
  t5392 = t340 * t571;
  t5394 = 0.32e2 / 0.3e1 * t5014;
  tv4rho3sigma4 = -0.88e2 / 0.3e1 * t5380 + 0.4e1 * t4992 - 0.176e3 / 0.3e1 * t4994 + t4997 - 0.88e3 / 0.27e2 * t5384 + 0.16e3 / 0.27e2 * t5000 - 0.176e4 / 0.27e2 * t5002 + t5005 - 0.968e3 / 0.27e2 * t5388 + 0.22e3 / 0.27e2 * t5008 - 0.1936e4 / 0.27e2 * t5010 + t5013 - 0.352e3 / 0.9e1 * t5392 + t5394 - 0.704e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 4] += tv4rho3sigma4;

  t5397 = t319 * t529 * t45;
  t5412 = t2575 * t327;
  t5415 = t454 * t542 * t46;
  t5422 = -t110 * t5397 / 0.3e1 - t115 * t5397 / 0.3e1 - t85 * t5397 / 0.3e1 - t105 * t5397 / 0.3e1 - t601 * t1264 / 0.8e1 - 0.5e1 / 0.27e2 * t604 * t1264 - 0.55e2 / 0.216e3 * t607 * t1264 + t5412 / 0.4e1 + t1274 * t5415 / 0.12e2 + 0.3e1 / 0.32e2 * t1279 * t5415 + 0.5e1 / 0.48e2 * t1311 * t5415;
  t5434 = t347 * t542 * t46;
  t5449 = 0.11e2 / 0.96e2 * t1314 * t5415 + 0.3e1 / 0.16e2 * t1336 * t543 + 0.5e1 / 0.24e2 * t1340 * t543 + 0.11e2 / 0.48e2 * t1344 * t543 + t1348 * t543 / 0.4e1 - t460 * t5434 / 0.12e2 - t1146 * t2796 / 0.4e1 - t463 * t5434 / 0.12e2 - 0.5e1 / 0.18e2 * t1151 * t2796 - t466 * t5434 / 0.12e2 - 0.11e2 / 0.36e2 * t1156 * t2796 + t1179 * t1738 / 0.4e1;
  t5473 = 0.3e1 / 0.64e2 * t2546 * t1283 + 0.5e1 / 0.72e2 * t2549 * t1283 + 0.3e1 / 0.32e2 * t5077 * t327 + 0.5e1 / 0.36e2 * t5055 * t327 + 0.55e2 / 0.288e3 * t5064 * t327 - 0.5e1 / 0.54e2 * t2549 * t1301 + 0.55e2 / 0.576e3 * t2552 * t1283 - 0.55e2 / 0.432e3 * t2552 * t1301 + t2555 * t1283 / 0.36e2 - t2555 * t1301 / 0.27e2 - t2546 * t1301 / 0.16e2;
  t5494 = t251 * t319;
  t5496 = t256 * t319;
  t5499 = -t2750 * t543 / 0.3e1 + t1163 * t1735 / 0.8e1 + t1163 * t1738 / 0.4e1 + 0.3e1 / 0.8e1 * t2514 * t730 + t1163 * t1755 / 0.8e1 + 0.3e1 / 0.8e1 * t2514 * t741 - t2759 * t543 / 0.3e1 + t1168 * t1735 / 0.8e1 + t1168 * t1738 / 0.4e1 + 0.5e1 / 0.12e2 * t2519 * t730 - t5494 * t191 - 0.1e2 / 0.9e1 * t5496 * t191;
  t5502 = t261 * t319;
  t5505 = t266 * t319;
  t5515 = t50 * t1754 * t46;
  t5528 = -0.11e2 / 0.9e1 * t5502 * t191 - 0.4e1 / 0.3e1 * t5505 * t191 + t1179 * t1755 / 0.8e1 + t2529 * t741 / 0.2e1 + t2529 * t730 / 0.2e1 + t455 * t5515 / 0.16e2 + t1139 * t2784 / 0.6e1 - t455 * t5434 / 0.12e2 - 0.2e1 / 0.9e1 * t1139 * t2796 + t460 * t5515 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t2784;
  t5553 = t463 * t5515 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t2784 + t466 * t5515 / 0.16e2 + t1168 * t1755 / 0.8e1 + 0.5e1 / 0.12e2 * t2519 * t741 - t2768 * t543 / 0.3e1 + t1174 * t1735 / 0.8e1 + t1174 * t1738 / 0.4e1 + 0.11e2 / 0.24e2 * t2524 * t730 + t1174 * t1755 / 0.8e1 + 0.11e2 / 0.24e2 * t2524 * t741 - t2777 * t543 / 0.3e1;
  t5560 = t113 * t319 * t98;
  t5570 = t138 * t1321;
  t5584 = -0.4e1 / 0.3e1 * t5397 - 0.4e1 / 0.3e1 * t2852 * t1734 + t95 * t542 * t1318 / 0.2e1 + t2855 * t2858 + t1184 * t45 * t1754 / 0.2e1 + t4960;
  t5588 = t1179 * t1735 / 0.8e1 + 0.11e2 / 0.48e2 * t1156 * t2784 - t5560 / 0.3e1 + 0.3e1 / 0.16e2 * t1336 * t530 + 0.5e1 / 0.24e2 * t1340 * t530 + 0.11e2 / 0.48e2 * t1344 * t530 + t1348 * t530 / 0.4e1 + 0.2e1 * t5570 + 0.2e1 * t340 * t2591 + t119 * t5584 + 0.3e1 * t168 * t2861;
  t5610 = 0.3e1 / 0.2e1 * t400 * t2591 + t133 * t5584 + 0.1e2 / 0.3e1 * t201 * t2861 + 0.5e1 / 0.3e1 * t332 * t2591 + t136 * t5584 + 0.11e2 / 0.3e1 * t205 * t2861 + 0.11e2 / 0.6e1 * t336 * t2591 + t139 * t5584 + 0.4e1 * t209 * t2861 + 0.3e1 / 0.4e1 * t610 * t1321 + 0.1e2 / 0.9e1 * t613 * t1321 + 0.55e2 / 0.36e2 * t618 * t1321;
  tv4rho3sigma5 = t5422 + t5449 + t5473 + t5499 + t5528 + t5553 + t5588 + t5610;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 5] += tv4rho3sigma5;

  t5614 = t173 * t915 * t45;
  t5626 = t418 * t876 * t46;
  t5639 = -t115 * t5614 / 0.3e1 - t988 * t1042 / 0.8e1 - t85 * t5614 / 0.3e1 - 0.5e1 / 0.27e2 * t991 * t1042 + t1119 * t919 / 0.4e1 + 0.11e2 / 0.96e2 * t1063 * t5626 + 0.3e1 / 0.16e2 * t1107 * t919 + 0.5e1 / 0.24e2 * t1111 * t919 + 0.11e2 / 0.48e2 * t1115 * t919 + t1052 * t5626 / 0.12e2 + 0.3e1 / 0.32e2 * t1057 * t5626;
  t5656 = t213 * t876 * t46;
  t5665 = 0.5e1 / 0.48e2 * t1060 * t5626 - t105 * t5614 / 0.3e1 - 0.55e2 / 0.216e3 * t995 * t1042 - t110 * t5614 / 0.3e1 + t4841 / 0.4e1 - 0.11e2 / 0.9e1 * t5319 * t314 - t2351 * t919 / 0.3e1 - 0.2e1 / 0.9e1 * t1199 * t2606 - t419 * t5656 / 0.12e2 - 0.4e1 / 0.3e1 * t5330 * t314 - t2356 * t919 / 0.3e1 - 0.11e2 / 0.36e2 * t1216 * t2606;
  t5675 = t991 * t88;
  t5690 = -t430 * t5656 / 0.12e2 + t1035 * t1922 / 0.4e1 + t1035 * t1926 / 0.8e1 + t1035 * t1944 / 0.8e1 + 0.5e1 / 0.36e2 * t5675 * t183 + t2649 * t713 / 0.2e1 + t2649 * t724 / 0.2e1 - t1206 * t2606 / 0.4e1 - t424 * t5656 / 0.12e2 - 0.5e1 / 0.18e2 * t1211 * t2606 - t427 * t5656 / 0.12e2;
  t5714 = -t2904 * t1078 / 0.27e2 - t2907 * t1078 / 0.16e2 - 0.5e1 / 0.54e2 * t2910 * t1078 - 0.55e2 / 0.432e3 * t2913 * t1078 - t5254 * t314 - t2372 * t919 / 0.3e1 - 0.1e2 / 0.9e1 * t5306 * t314 - t2346 * t919 / 0.3e1 + 0.5e1 / 0.12e2 * t2634 * t713 + 0.5e1 / 0.12e2 * t2634 * t724 + t1038 * t1922 / 0.4e1 + t1038 * t1926 / 0.8e1;
  t5719 = t995 * t88;
  t5735 = t32 * t1943 * t46;
  t5742 = t1038 * t1944 / 0.8e1 + 0.55e2 / 0.288e3 * t5719 * t183 + 0.11e2 / 0.24e2 * t2642 * t713 + 0.11e2 / 0.24e2 * t2642 * t724 + t1066 * t1922 / 0.4e1 + t1066 * t1926 / 0.8e1 + t1066 * t1944 / 0.8e1 + t1199 * t2624 / 0.6e1 + t419 * t5735 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t2624 + t1069 * t1922 / 0.4e1;
  t5751 = t988 * t88;
  t5768 = t1069 * t1926 / 0.8e1 + t1069 * t1944 / 0.8e1 + 0.11e2 / 0.48e2 * t1216 * t2624 + t430 * t5735 / 0.16e2 + 0.3e1 / 0.32e2 * t5751 * t183 + 0.3e1 / 0.8e1 * t2627 * t713 + 0.3e1 / 0.8e1 * t2627 * t724 + t424 * t5735 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t2624 + t427 * t5735 / 0.16e2 + t2904 * t1030 / 0.36e2 + 0.3e1 / 0.64e2 * t2907 * t1030;
  t5785 = t88 * t313;
  t5794 = -0.4e1 / 0.3e1 * t5614 + t5785 * t2712 - 0.4e1 / 0.3e1 * t2456 * t2949 + t2709 * t2949 / 0.2e1 + t1088 * t45 * t1943 / 0.2e1 + t4960;
  t5800 = 0.5e1 / 0.72e2 * t2910 * t1030 + 0.55e2 / 0.576e3 * t2913 * t1030 + t1119 * t916 / 0.4e1 + 0.3e1 / 0.16e2 * t1107 * t916 + 0.5e1 / 0.24e2 * t1111 * t916 + 0.11e2 / 0.48e2 * t1115 * t916 - t4932 / 0.3e1 + 0.2e1 * t4947 + t136 * t5794 + 0.11e2 / 0.6e1 * t205 * t2952 + 0.4e1 * t340 * t2715;
  t5822 = t139 * t5794 + 0.2e1 * t209 * t2952 + 0.3e1 / 0.4e1 * t998 * t1092 + 0.1e2 / 0.9e1 * t1001 * t1092 + 0.55e2 / 0.36e2 * t1004 * t1092 + 0.3e1 * t400 * t2715 + t119 * t5794 + 0.3e1 / 0.2e1 * t168 * t2952 + 0.1e2 / 0.3e1 * t332 * t2715 + t133 * t5794 + 0.5e1 / 0.3e1 * t201 * t2952 + 0.11e2 / 0.3e1 * t336 * t2715;
  tv4rho3sigma6 = t5639 + t5665 + t5690 + t5714 + t5742 + t5768 + t5800 + t5822;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 6] += tv4rho3sigma6;

  t5825 = t998 * t196;
  t5829 = t1001 * t196;
  t5833 = t1004 * t196;
  tv4rho3sigma7 = 0.4e1 * t5825 - 0.176e3 / 0.3e1 * t5380 - 0.88e2 / 0.3e1 * t4994 + t4997 + 0.16e3 / 0.27e2 * t5829 - 0.176e4 / 0.27e2 * t5384 - 0.88e3 / 0.27e2 * t5002 + t5005 + 0.22e3 / 0.27e2 * t5833 - 0.1936e4 / 0.27e2 * t5388 - 0.968e3 / 0.27e2 * t5010 + t5013 + t5394 - 0.704e3 / 0.9e1 * t5392 - 0.352e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 7] += tv4rho3sigma7;

  t5850 = t454 * t740 * t46;
  t5865 = 0.55e2 / 0.54e2 * t256 * t3048 + 0.5e1 / 0.24e2 * t256 * t3032 + 0.121e3 / 0.108e3 * t261 * t3048 + 0.11e2 / 0.48e2 * t261 * t3032 + 0.11e2 / 0.9e1 * t266 * t3048 + 0.3e1 / 0.16e2 * t1279 * t5850 + 0.5e1 / 0.24e2 * t1311 * t5850 + 0.11e2 / 0.48e2 * t1314 * t5850 + 0.3e1 / 0.8e1 * t1336 * t730 + 0.3e1 / 0.8e1 * t1336 * t741 + 0.5e1 / 0.12e2 * t1340 * t730 + 0.5e1 / 0.12e2 * t1340 * t741;
  t5892 = 0.11e2 / 0.24e2 * t1344 * t730 + 0.11e2 / 0.24e2 * t1344 * t741 + t1348 * t730 / 0.2e1 + t1348 * t741 / 0.2e1 + t1274 * t5850 / 0.6e1 - 0.29e2 / 0.32e2 * t3109 * t191 - 0.35e2 / 0.36e2 * t3113 * t191 - 0.33e2 / 0.32e2 * t3118 * t191 + t266 * t3032 / 0.4e1 - 0.7e1 / 0.36e2 * t3035 * t2836 - 0.13e2 / 0.64e2 * t3038 * t2836 - 0.5e1 / 0.24e2 * t3041 * t2836 - 0.121e3 / 0.576e3 * t3044 * t2836;
  t5900 = t881 * t190 * t46;
  t5906 = t347 * t740 * t46;
  t5919 = t105 * t924;
  t5922 = 0.11e2 / 0.12e2 * t251 * t3048 + 0.3e1 / 0.16e2 * t251 * t3032 - 0.13e2 / 0.12e2 * t5020 + 0.7e1 / 0.36e2 * t466 * t5900 + 0.77e2 / 0.216e3 * t1156 * t2999 - t455 * t5906 / 0.6e1 - 0.2e1 / 0.9e1 * t1139 * t3003 + t1163 * t1953 / 0.4e1 + t1163 * t1955 / 0.8e1 + t1163 * t1971 / 0.8e1 + 0.3e1 / 0.16e2 * t2514 * t934 + 0.11e2 / 0.9e1 * t5919 * t191;
  t5937 = t110 * t924;
  t5949 = t50 * t1970 * t46;
  t5952 = -0.2e1 / 0.3e1 * t2759 * t730 - 0.2e1 / 0.3e1 * t2759 * t741 - 0.1e2 / 0.9e1 * t5496 * t327 + t1168 * t1953 / 0.4e1 + t1168 * t1955 / 0.8e1 + t1168 * t1971 / 0.8e1 + 0.5e1 / 0.24e2 * t2519 * t934 + 0.11e2 / 0.9e1 * t5937 * t191 - 0.2e1 / 0.3e1 * t2768 * t730 - 0.2e1 / 0.3e1 * t2768 * t741 - 0.11e2 / 0.9e1 * t5502 * t327 + t2529 * t934 / 0.4e1 + t455 * t5949 / 0.16e2;
  t5965 = t85 * t924;
  t5979 = t1139 * t2995 / 0.12e2 + t463 * t5949 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t2995 + t466 * t5949 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t2995 + 0.11e2 / 0.9e1 * t5965 * t191 - 0.2e1 / 0.3e1 * t2750 * t730 - 0.2e1 / 0.3e1 * t2750 * t741 - t5494 * t327 + t1179 * t1953 / 0.4e1 + t1179 * t1955 / 0.8e1 + t1179 * t1971 / 0.8e1;
  t6006 = 0.7e1 / 0.36e2 * t455 * t5900 + 0.7e1 / 0.27e2 * t1139 * t2999 + 0.7e1 / 0.36e2 * t460 * t5900 + 0.7e1 / 0.24e2 * t1146 * t2999 + 0.7e1 / 0.36e2 * t463 * t5900 + 0.35e2 / 0.108e3 * t1151 * t2999 - t460 * t5906 / 0.6e1 - t1146 * t3003 / 0.4e1 - t463 * t5906 / 0.6e1 - 0.5e1 / 0.18e2 * t1151 * t3003 - t466 * t5906 / 0.6e1 - 0.11e2 / 0.36e2 * t1156 * t3003 + t1174 * t1953 / 0.4e1;
  t6014 = t115 * t924;
  t6030 = t924 * t56;
  t6038 = t95 * t326;
  t6045 = 0.44e2 / 0.9e1 * t6030 * t729 - 0.8e1 / 0.3e1 * t319 * t190 * t1318 - 0.8e1 / 0.3e1 * t2852 * t2858 + t6038 * t2858 + t2855 * t3091 / 0.2e1 + t1184 * t45 * t1970 / 0.2e1 + t4960;
  t6047 = t1174 * t1955 / 0.8e1 + t1174 * t1971 / 0.8e1 + 0.11e2 / 0.48e2 * t2524 * t934 + 0.11e2 / 0.9e1 * t6014 * t191 - 0.2e1 / 0.3e1 * t2777 * t730 - 0.2e1 / 0.3e1 * t2777 * t741 - 0.4e1 / 0.3e1 * t5505 * t327 + t460 * t5949 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t2995 + 0.2e1 * t5110 + 0.1e2 / 0.3e1 * t332 * t2861 + t136 * t6045;
  t6071 = 0.11e2 / 0.6e1 * t205 * t3094 + 0.11e2 / 0.3e1 * t336 * t2861 + t139 * t6045 + 0.2e1 * t209 * t3094 + 0.4e1 * t340 * t2861 + 0.3e1 / 0.4e1 * t998 * t1187 + 0.1e2 / 0.9e1 * t1001 * t1187 + 0.55e2 / 0.36e2 * t1004 * t1187 + t119 * t6045 + 0.3e1 / 0.2e1 * t168 * t3094 + 0.3e1 * t400 * t2861 + t133 * t6045 + 0.5e1 / 0.3e1 * t201 * t3094;
  tv4rho3sigma8 = t5865 + t5892 + t5922 + t5952 + t5979 + t6006 + t6047 + t6071;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 8] += tv4rho3sigma8;

  t6103 = -0.5e1 / 0.216e3 * t2305 * t434 + 0.5e1 / 0.8e1 * t387 * t2930 - 0.55e2 / 0.3456e4 * t2308 * t434 + 0.11e2 / 0.16e2 * t392 * t2930 + 0.3e1 / 0.4e1 * t397 * t2930 - 0.3e1 / 0.128e3 * t2302 * t434 + 0.9e1 / 0.16e2 * t382 * t2930 + 0.3e1 / 0.4e1 * t5179 - t2287 * t418 * t421 / 0.54e2 - 0.3e1 / 0.128e3 * t2290 * t418 * t421 - 0.5e1 / 0.216e3 * t2293 * t418 * t421 - 0.55e2 / 0.3456e4 * t2297 * t418 * t421 + t2904 * t1203 / 0.12e2;
  t6107 = t32 * t2161 * t46;
  t6134 = t1199 * t2893 / 0.4e1 + t419 * t6107 / 0.16e2 + 0.9e1 / 0.32e2 * t1206 * t2893 + t424 * t6107 / 0.16e2 + 0.5e1 / 0.16e2 * t1211 * t2893 + t427 * t6107 / 0.16e2 + t1035 * t2162 / 0.8e1 + 0.5e1 / 0.12e2 * t5675 * t314 + 0.5e1 / 0.8e1 * t2634 * t919 + 0.3e1 / 0.8e1 * t1038 * t2148 + t1038 * t2162 / 0.8e1 + 0.55e2 / 0.96e2 * t5719 * t314 + 0.11e2 / 0.16e2 * t2642 * t919 + 0.3e1 / 0.8e1 * t1066 * t2148;
  t6161 = t1066 * t2162 / 0.8e1 + 0.3e1 / 0.4e1 * t2649 * t919 + 0.3e1 / 0.8e1 * t1069 * t2148 + t1069 * t2162 / 0.8e1 + 0.11e2 / 0.32e2 * t1216 * t2893 + t430 * t6107 / 0.16e2 + 0.9e1 / 0.32e2 * t5751 * t314 + 0.9e1 / 0.16e2 * t2627 * t919 + 0.3e1 / 0.8e1 * t1035 * t2148 + 0.55e2 / 0.192e3 * t2913 * t1203 + 0.9e1 / 0.64e2 * t2907 * t1203 + 0.5e1 / 0.24e2 * t2910 * t1203 + 0.6e1 * t5333;
  t6181 = 0.3e1 / 0.2e1 * t5785 * t2949 + t1088 * t45 * t2161 / 0.2e1 + t4960;
  t6192 = 0.9e1 / 0.4e1 * t998 * t1243 + 0.1e2 / 0.3e1 * t1001 * t1243 + 0.55e2 / 0.12e2 * t1004 * t1243 - 0.3e1 / 0.8e1 * t2311 * t444 - 0.1e2 / 0.27e2 * t2314 * t444 - 0.55e2 / 0.216e3 * t2317 * t444 + 0.9e1 / 0.2e1 * t400 * t2952 + t119 * t6181 + 0.5e1 * t332 * t2952 + t133 * t6181 + 0.11e2 / 0.2e1 * t336 * t2952 + t136 * t6181 + 0.6e1 * t340 * t2952 + t139 * t6181;
  tv4rho3sigma9 = t6103 + t6134 + t6161 + t6192;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.3e1 / 0.4e1 * t2311 * t128 + 0.12e2 * t5825 - 0.88e2 * t5380 + t4997 + 0.2e2 / 0.27e2 * t2314 * t128 + 0.16e3 / 0.9e1 * t5829 - 0.88e3 / 0.9e1 * t5384 + t5005 + 0.55e2 / 0.108e3 * t2317 * t128 + 0.22e3 / 0.9e1 * t5833 - 0.968e3 / 0.9e1 * t5388 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5392 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 10] += tv4rho3sigma10;

  t6211 = t2167 * t97 * t45;
  t6235 = t454 * t894 * t46;
  t6247 = t319 * t930 * t45;
  t6252 = 0.2321e4 / 0.3456e4 * t71 * t4506 * t1276 - 0.77e2 / 0.27e2 * t85 * t6211 - 0.39e2 / 0.64e2 * t3038 * t3028 - 0.5e1 / 0.8e1 * t3041 * t3028 - 0.121e3 / 0.192e3 * t3044 * t3028 - 0.87e2 / 0.32e2 * t3109 * t327 - 0.35e2 / 0.12e2 * t3113 * t327 - 0.99e2 / 0.32e2 * t3118 * t327 - 0.7e1 / 0.12e2 * t3035 * t3028 + 0.5e1 / 0.8e1 * t1340 * t934 + 0.11e2 / 0.16e2 * t1344 * t934 + 0.3e1 / 0.4e1 * t1348 * t934 + t1274 * t6235 / 0.4e1 + 0.9e1 / 0.32e2 * t1279 * t6235 + 0.5e1 / 0.16e2 * t1311 * t6235 + 0.11e2 / 0.32e2 * t1314 * t6235 + 0.9e1 / 0.16e2 * t1336 * t934 - t110 * t6247 - 0.77e2 / 0.27e2 * t115 * t6211 - t85 * t6247;
  t6270 = t50 * t2189 * t46;
  t6279 = t2201 * t56 * t46;
  t6287 = t347 * t894 * t46;
  t6293 = t881 * t326 * t46;
  t6303 = 0.11e2 / 0.3e1 * t5965 * t327 - 0.35e2 / 0.54e2 * t455 * t6279 - 0.35e2 / 0.54e2 * t460 * t6279 - 0.35e2 / 0.54e2 * t463 * t6279 - t460 * t6287 / 0.4e1 - 0.35e2 / 0.54e2 * t466 * t6279 + 0.7e1 / 0.12e2 * t455 * t6293 - t2777 * t934 - t455 * t6287 / 0.4e1 - t463 * t6287 / 0.4e1 - t466 * t6287 / 0.4e1;
  t6346 = 0.11e2 / 0.3e1 * t5919 * t327 - t2759 * t934 + 0.3e1 / 0.8e1 * t1168 * t2177 + t1168 * t2190 / 0.8e1 + 0.11e2 / 0.3e1 * t5937 * t327 + 0.3e1 / 0.8e1 * t1179 * t2177 + t1179 * t2190 / 0.8e1 + t455 * t6270 / 0.16e2 + 0.7e1 / 0.12e2 * t460 * t6293 + 0.11e2 / 0.16e2 * t1344 * t931 + 0.3e1 / 0.4e1 * t1348 * t931;
  t6379 = -0.308e3 / 0.27e2 * t6211 + 0.44e2 / 0.3e1 * t6030 * t1318 - 0.4e1 * t6247 - 0.4e1 * t2852 * t3091 + 0.3e1 / 0.2e1 * t6038 * t3091 + t1184 * t45 * t2189 / 0.2e1 + t4960;
  t6405 = 0.11e2 / 0.2e1 * t336 * t3094 + t139 * t6379 + 0.6e1 * t340 * t3094 + 0.9e1 / 0.4e1 * t998 * t1321 + 0.1e2 / 0.3e1 * t1001 * t1321 + 0.55e2 / 0.12e2 * t1004 * t1321 + t119 * t6379 + 0.9e1 / 0.2e1 * t400 * t3094 - 0.3e1 / 0.8e1 * t2311 * t480 - 0.1e2 / 0.27e2 * t2314 * t480 - 0.55e2 / 0.216e3 * t2317 * t480;
  tv4rho3sigma11 = -t115 * t6247 + t463 * t6270 / 0.16e2 + t133 * t6379 + 0.5e1 * t332 * t3094 + t136 * t6379 + 0.9e1 / 0.16e2 * t1336 * t931 + 0.5e1 / 0.8e1 * t1340 * t931 + 0.7e1 / 0.12e2 * t466 * t6293 - t2750 * t934 + 0.3e1 / 0.8e1 * t1163 * t2177 + t1163 * t2190 / 0.8e1 + 0.7e1 / 0.12e2 * t463 * t6293 - t2768 * t934 + 0.3e1 / 0.8e1 * t1174 * t2177 + t1174 * t2190 / 0.8e1 + 0.11e2 / 0.3e1 * t6014 * t327 + t460 * t6270 / 0.16e2 + t466 * t6270 / 0.16e2 - 0.77e2 / 0.27e2 * t105 * t6211 - t105 * t6247 - 0.77e2 / 0.27e2 * t110 * t6211 + t6405 + t6346 + t6303 + t6252 + 0.6e1 * t5570 + 0.8e1 / 0.3e1 * t5560 - 0.13e2 / 0.4e1 * t5412 + 0.301e3 / 0.128e3 * t84 / t4 / t922 * t98 + 0.8921e4 / 0.3456e4 * t109 / t78 / t317 * t98 + 0.35e2 / 0.54e2 * t29 * t3112 * t1276 + 0.85e2 / 0.128e3 * t63 * t3117 * t1276 + 0.145e3 / 0.216e3 * t67 * t95 * t1276 + 0.535e3 / 0.216e3 * t104 / t922 * t98;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->out_dim->v4rho3sigma + 11] += tv4rho3sigma11;

  t6409 = t1353 * t182 * t46;
  tv4rho2sigma20 = -t1052 * t6409 / 0.12e2 - 0.3e1 / 0.32e2 * t1057 * t6409 - 0.5e1 / 0.48e2 * t1060 * t6409 - 0.11e2 / 0.96e2 * t1063 * t6409 + t1354 * t2341 / 0.12e2 - t1354 * t2362 / 0.32e2 + 0.13e2 / 0.128e3 * t2423 * t3124 + t1356 * t2341 / 0.12e2 - t1356 * t2362 / 0.32e2 + 0.5e1 / 0.48e2 * t2426 * t3124 + t1358 * t2341 / 0.12e2 - t1358 * t2362 / 0.32e2 + 0.121e3 / 0.1152e4 * t2429 * t3124 + t1360 * t2341 / 0.12e2 - t1360 * t2362 / 0.32e2 + 0.7e1 / 0.72e2 * t2432 * t3124 - 0.7e1 / 0.72e2 * t1356 * t2333 - 0.7e1 / 0.72e2 * t1358 * t2333 - 0.7e1 / 0.72e2 * t1360 * t2333 - 0.7e1 / 0.72e2 * t1354 * t2333;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = -t588 * t1364 * t457 / 0.72e2 - t3149 * t1143 / 0.12e2 - t1365 * t2511 / 0.32e2 - 0.3e1 / 0.128e3 * t591 * t1364 * t457 - 0.3e1 / 0.32e2 * t3154 * t1143 - t1367 * t2511 / 0.32e2 - 0.5e1 / 0.144e3 * t594 * t1364 * t457 - 0.5e1 / 0.48e2 * t3159 * t1143 - t1369 * t2511 / 0.32e2 - 0.55e2 / 0.1152e4 * t598 * t1364 * t457 - 0.11e2 / 0.96e2 * t3164 * t1143 - t1371 * t2511 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6483 = t1353 * t313 * t46;
  tv4rho2sigma26 = t3169 * t1078 / 0.18e2 - t3169 * t1030 / 0.24e2 - t1052 * t6483 / 0.24e2 + t1354 * t2606 / 0.24e2 - t1354 * t2624 / 0.32e2 + t3174 * t1078 / 0.16e2 - 0.3e1 / 0.64e2 * t3174 * t1030 - 0.3e1 / 0.64e2 * t1057 * t6483 + t1356 * t2606 / 0.24e2 - t1356 * t2624 / 0.32e2 + 0.5e1 / 0.72e2 * t3179 * t1078 - 0.5e1 / 0.96e2 * t3179 * t1030 - 0.5e1 / 0.96e2 * t1060 * t6483 + t1358 * t2606 / 0.24e2 - t1358 * t2624 / 0.32e2 + 0.11e2 / 0.144e3 * t3184 * t1078 - 0.11e2 / 0.192e3 * t3184 * t1030 - 0.11e2 / 0.192e3 * t1063 * t6483 + t1360 * t2606 / 0.24e2 - t1360 * t2624 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6521 = t1364 * t190 * t46;
  tv4rho2sigma211 = -t1274 * t6521 / 0.24e2 + t3149 * t1301 / 0.18e2 + t1365 * t2796 / 0.24e2 - t3149 * t1283 / 0.24e2 - t1365 * t2784 / 0.32e2 - 0.3e1 / 0.64e2 * t1279 * t6521 + t3154 * t1301 / 0.16e2 + t1367 * t2796 / 0.24e2 - 0.3e1 / 0.64e2 * t3154 * t1283 - t1367 * t2784 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t6521 + 0.5e1 / 0.72e2 * t3159 * t1301 + t1369 * t2796 / 0.24e2 - 0.5e1 / 0.96e2 * t3159 * t1283 - t1369 * t2784 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t6521 + 0.11e2 / 0.144e3 * t3164 * t1301 + t1371 * t2796 / 0.24e2 - 0.11e2 / 0.192e3 * t3164 * t1283 - t1371 * t2784 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = -t975 * t1353 * t421 / 0.72e2 - t3169 * t1203 / 0.12e2 - t1354 * t2893 / 0.32e2 - 0.3e1 / 0.128e3 * t978 * t1353 * t421 - 0.3e1 / 0.32e2 * t3174 * t1203 - t1356 * t2893 / 0.32e2 - 0.5e1 / 0.144e3 * t981 * t1353 * t421 - 0.5e1 / 0.48e2 * t3179 * t1203 - t1358 * t2893 / 0.32e2 - 0.55e2 / 0.1152e4 * t985 * t1353 * t421 - 0.11e2 / 0.96e2 * t3184 * t1203 - t1360 * t2893 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6591 = t1364 * t326 * t46;
  tv4rho2sigma217 = -0.5e1 / 0.48e2 * t1311 * t6591 - 0.11e2 / 0.96e2 * t1314 * t6591 - t1274 * t6591 / 0.12e2 - 0.3e1 / 0.32e2 * t1279 * t6591 - t1367 * t2995 / 0.32e2 + 0.5e1 / 0.48e2 * t3041 * t3190 + t1369 * t3003 / 0.12e2 - t1369 * t2995 / 0.32e2 + 0.121e3 / 0.1152e4 * t3044 * t3190 + t1371 * t3003 / 0.12e2 - t1371 * t2995 / 0.32e2 + 0.7e1 / 0.72e2 * t3035 * t3190 + t1365 * t3003 / 0.12e2 - t1365 * t2995 / 0.32e2 + 0.13e2 / 0.128e3 * t3038 * t3190 + t1367 * t3003 / 0.12e2 - 0.7e1 / 0.72e2 * t1369 * t2999 - 0.7e1 / 0.72e2 * t1371 * t2999 - 0.7e1 / 0.72e2 * t1365 * t2999 - 0.7e1 / 0.72e2 * t1367 * t2999;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->out_dim->v4rho2sigma2 + 17] += tv4rho2sigma217;

  t6633 = t3217 * t44 * t46;
  tv4rhosigma30 = t1052 * t6633 / 0.16e2 - t3218 * t1078 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1030 + 0.9e1 / 0.128e3 * t1057 * t6633 - t3220 * t1078 / 0.16e2 + 0.3e1 / 0.64e2 * t3220 * t1030 + 0.5e1 / 0.64e2 * t1060 * t6633 - t3222 * t1078 / 0.16e2 + 0.3e1 / 0.64e2 * t3222 * t1030 + 0.11e2 / 0.128e3 * t1063 * t6633 - t3224 * t1078 / 0.16e2 + 0.3e1 / 0.64e2 * t3224 * t1030;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = t226 * t3229 * t457 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1143 + 0.9e1 / 0.128e3 * t231 * t3229 * t457 + 0.3e1 / 0.64e2 * t3232 * t1143 + 0.5e1 / 0.64e2 * t236 * t3229 * t457 + 0.3e1 / 0.64e2 * t3234 * t1143 + 0.11e2 / 0.128e3 * t241 * t3229 * t457 + 0.3e1 / 0.64e2 * t3236 * t1143;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = t357 * t3217 * t421 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1203 + 0.9e1 / 0.128e3 * t362 * t3217 * t421 + 0.3e1 / 0.64e2 * t3220 * t1203 + 0.5e1 / 0.64e2 * t367 * t3217 * t421 + 0.3e1 / 0.64e2 * t3222 * t1203 + 0.11e2 / 0.128e3 * t372 * t3217 * t421 + 0.3e1 / 0.64e2 * t3224 * t1203;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 18] += tv4rhosigma318;

  t6699 = t3229 * t56 * t46;
  tv4rhosigma319 = t1274 * t6699 / 0.16e2 - t3230 * t1301 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1283 + 0.9e1 / 0.128e3 * t1279 * t6699 - t3232 * t1301 / 0.16e2 + 0.3e1 / 0.64e2 * t3232 * t1283 + 0.5e1 / 0.64e2 * t1311 * t6699 - t3234 * t1301 / 0.16e2 + 0.3e1 / 0.64e2 * t3234 * t1283 + 0.11e2 / 0.128e3 * t1314 * t6699 - t3236 * t1301 / 0.16e2 + 0.3e1 / 0.64e2 * t3236 * t1283;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->out_dim->v4rhosigma3 + 19] += tv4rhosigma319;

  t6726 = 0.1e1 / t31 / t3215 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.128e3 * t30 * t6726 * t421 - 0.15e2 / 0.128e3 * t64 * t6726 * t421 - 0.15e2 / 0.128e3 * t68 * t6726 * t421 - 0.15e2 / 0.128e3 * t81 * t6726 * t421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 13] += tv4sigma413;

  t6738 = 0.1e1 / t49 / t3227 / sigma[2];
  tv4sigma414 = -0.15e2 / 0.128e3 * t30 * t6738 * t457 - 0.15e2 / 0.128e3 * t64 * t6738 * t457 - 0.15e2 / 0.128e3 * t68 * t6738 * t457 - 0.15e2 / 0.128e3 * t81 * t6738 * t457;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->out_dim->v4sigma4 + 14] += tv4sigma414;

}

#endif

