/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_xc_th1.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t161, t162, t165, t166, t169, t170, t173, t176;
  double t177, t180, t183, t188, t191, t193, t194, t195;
  double t197, t198, t199, t201, t202, t203, t205, t208;
  double t213, t218, t223, t228, t230, t232, t233, t235;
  double t239, t243, t247, t250, t253, t258, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t333, t338, t343, t348, t350;
  double t354, t358, t362, t365, t369, t370, t373, t376;
  double t379, t382, t385, t390, t395, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = 0.1e1 / t9 / t86;
  t162 = t31 * t161;
  t165 = t34 * t144;
  t166 = t36 - t165;
  t169 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t166);
  t170 = t169 * t46;
  t173 = -t166;
  t176 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t173);
  t177 = t176 * t46;
  t180 = -t162 * t47 / 0.3e1 + t33 * t170 / 0.4e1 + t51 * t177 / 0.4e1;
  t183 = t67 * t23;
  t188 = t71 * t74;
  t191 = t86 * rho[0];
  t193 = 0.1e1 / t23 / t191;
  t194 = sigma[0] * t193;
  t195 = t194 * t91;
  t197 = t44 * t45;
  t198 = t197 * t169;
  t199 = t89 * t198;
  t201 = t56 * t45;
  t202 = t201 * t176;
  t203 = t96 * t202;
  t205 = -t195 / 0.3e1 + t199 / 0.4e1 + t203 / 0.4e1;
  t208 = t84 * t16;
  t213 = t104 * t23;
  t218 = t109 * t74;
  t223 = t113 * rho[0];
  t228 = t124 * t35;
  t230 = 0.1e1 / t126 / t228;
  t232 = 0.8e1 / 0.3e1 * t123 * t230;
  t233 = -0.2e1 / 0.3e1 * t195 + t199 / 0.2e1 + t203 / 0.2e1 + t232;
  t235 = t118 * t16;
  t239 = t132 * t23;
  t243 = t135 * t74;
  t247 = t138 * rho[0];
  t250 = t68 * t180 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t60 + t81 * t180 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t60 + t85 * t205 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t101 + t105 * t205 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t101 + t110 * t205 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t101 + t115 * t205 / 0.2e1 + t223 * t101 + t119 * t233 + 0.3e1 / 0.2e1 * t235 * t130 + t133 * t233 + 0.5e1 / 0.3e1 * t239 * t130 + t136 * t233 + 0.11e2 / 0.6e1 * t243 * t130 + t139 * t233 + 0.2e1 * t247 * t130;
  t253 = t29 * t9;
  t258 = t63 * t16;
  t270 = 0.2e1 * t142 * t165;
  t272 = 0.1e1 / t228;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t165;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t165;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t165;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t250 + t30 * t180 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t60 + t64 * t180 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t60 + t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = -t36 - t165;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t197 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t201 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t333 = t104 * t25;
  t338 = t109 * t78;
  t343 = t113 * rho[1];
  t348 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t232;
  t350 = t118 * t18;
  t354 = t132 * t25;
  t358 = t135 * t78;
  t362 = t138 * rho[1];
  t365 = t313 * t46;
  t369 = 0.1e1 / t11 / t93;
  t370 = t49 * t369;
  t373 = t326 * t46;
  t376 = t33 * t365 / 0.4e1 - t370 * t57 / 0.3e1 + t51 * t373 / 0.4e1;
  t379 = t29 * t11;
  t382 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t105 * t330 / 0.2e1 + 0.5e1 / 0.6e1 * t333 * t101 + t110 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t338 * t101 + t115 * t330 / 0.2e1 + t343 * t101 + t119 * t348 + 0.3e1 / 0.2e1 * t350 * t130 + t133 * t348 + 0.5e1 / 0.3e1 * t354 * t130 + t136 * t348 + 0.11e2 / 0.6e1 * t358 * t130 + t139 * t348 + 0.2e1 * t362 * t130 + t30 * t376 / 0.2e1 + 0.2e1 / 0.3e1 * t379 * t60;
  t385 = t63 * t18;
  t390 = t67 * t25;
  t395 = t71 * t78;
  t400 = t84 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t382 + t64 * t376 / 0.2e1 + 0.3e1 / 0.4e1 * t385 * t60 + t68 * t376 / 0.2e1 + 0.5e1 / 0.6e1 * t390 * t60 + t81 * t376 / 0.2e1 + 0.11e2 / 0.12e2 * t395 * t60 + t85 * t330 / 0.2e1 + 0.3e1 / 0.4e1 * t400 * t101 + t156 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t161, t162, t165, t166, t169, t170, t173, t176;
  double t177, t180, t183, t188, t191, t193, t194, t195;
  double t197, t198, t199, t201, t202, t203, t205, t208;
  double t213, t218, t223, t228, t230, t232, t233, t235;
  double t239, t243, t247, t250, t253, t258, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t333, t338, t343, t348, t350;
  double t354, t358, t362, t365, t369, t370, t373, t376;
  double t379, t382, t385, t390, t395, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t486, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t548, t550, t551, t555, t558, t561, t564;
  double t565, t568, t571, t574, t577, t578, t581, t584;
  double t588, t590, t592, t594, t596, t597, t602, t605;
  double t608, t631, t634, t657, t660, t662, t664, t667;
  double t668, t670, t672, t675, t677, t680, t681, t682;
  double t684, t686, t688, t690, t692, t694, t696, t697;
  double t700, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t762;
  double t767, t770, t779, t802, t817, t828, t830, t832;
  double t834, t836, t838, t839, t841, t843, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t871, t875, t876;
  double t880, t881, t886, t889, t893, t894, t897, t914;
  double t915, t916, t918, t919, t921, t923, t924, t925;
  double t927, t929, t930, t931, t933, t934, t936, t941;
  double t960, t973, t976, t979, t981, t984, t985, t988;
  double t991, t994, t997, t1000, t1003, t1006, t1009, t1012;
  double t1015, t1018, t1027, tv2rho22, t1029, t1032, t1035, t1038;
  double t1040, t1043, t1047, t1057, t1060, t1064, t1067, t1068;
  double t1076, t1083, t1084, t1087, t1088, t1091, t1092, t1095;
  double t1096, t1100, t1110, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1282, t1292, t1301;
  double t1303, t1305, t1308, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = 0.1e1 / t9 / t86;
  t162 = t31 * t161;
  t165 = t34 * t144;
  t166 = t36 - t165;
  t169 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t166);
  t170 = t169 * t46;
  t173 = -t166;
  t176 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t173);
  t177 = t176 * t46;
  t180 = -t162 * t47 / 0.3e1 + t33 * t170 / 0.4e1 + t51 * t177 / 0.4e1;
  t183 = t67 * t23;
  t188 = t71 * t74;
  t191 = t86 * rho[0];
  t193 = 0.1e1 / t23 / t191;
  t194 = sigma[0] * t193;
  t195 = t194 * t91;
  t197 = t44 * t45;
  t198 = t197 * t169;
  t199 = t89 * t198;
  t201 = t56 * t45;
  t202 = t201 * t176;
  t203 = t96 * t202;
  t205 = -t195 / 0.3e1 + t199 / 0.4e1 + t203 / 0.4e1;
  t208 = t84 * t16;
  t213 = t104 * t23;
  t218 = t109 * t74;
  t223 = t113 * rho[0];
  t228 = t124 * t35;
  t230 = 0.1e1 / t126 / t228;
  t232 = 0.8e1 / 0.3e1 * t123 * t230;
  t233 = -0.2e1 / 0.3e1 * t195 + t199 / 0.2e1 + t203 / 0.2e1 + t232;
  t235 = t118 * t16;
  t239 = t132 * t23;
  t243 = t135 * t74;
  t247 = t138 * rho[0];
  t250 = t68 * t180 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t60 + t81 * t180 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t60 + t85 * t205 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t101 + t105 * t205 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t101 + t110 * t205 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t101 + t115 * t205 / 0.2e1 + t223 * t101 + t119 * t233 + 0.3e1 / 0.2e1 * t235 * t130 + t133 * t233 + 0.5e1 / 0.3e1 * t239 * t130 + t136 * t233 + 0.11e2 / 0.6e1 * t243 * t130 + t139 * t233 + 0.2e1 * t247 * t130;
  t253 = t29 * t9;
  t258 = t63 * t16;
  t270 = 0.2e1 * t142 * t165;
  t272 = 0.1e1 / t228;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t165;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t165;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t165;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t250 + t30 * t180 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t60 + t64 * t180 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t60 + t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = -t36 - t165;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t197 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t201 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t333 = t104 * t25;
  t338 = t109 * t78;
  t343 = t113 * rho[1];
  t348 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t232;
  t350 = t118 * t18;
  t354 = t132 * t25;
  t358 = t135 * t78;
  t362 = t138 * rho[1];
  t365 = t313 * t46;
  t369 = 0.1e1 / t11 / t93;
  t370 = t49 * t369;
  t373 = t326 * t46;
  t376 = t33 * t365 / 0.4e1 - t370 * t57 / 0.3e1 + t51 * t373 / 0.4e1;
  t379 = t29 * t11;
  t382 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t105 * t330 / 0.2e1 + 0.5e1 / 0.6e1 * t333 * t101 + t110 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t338 * t101 + t115 * t330 / 0.2e1 + t343 * t101 + t119 * t348 + 0.3e1 / 0.2e1 * t350 * t130 + t133 * t348 + 0.5e1 / 0.3e1 * t354 * t130 + t136 * t348 + 0.11e2 / 0.6e1 * t358 * t130 + t139 * t348 + 0.2e1 * t362 * t130 + t30 * t376 / 0.2e1 + 0.2e1 / 0.3e1 * t379 * t60;
  t385 = t63 * t18;
  t390 = t67 * t25;
  t395 = t71 * t78;
  t400 = t84 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t382 + t64 * t376 / 0.2e1 + 0.3e1 / 0.4e1 * t385 * t60 + t68 * t376 / 0.2e1 + 0.5e1 / 0.6e1 * t390 * t60 + t81 * t376 / 0.2e1 + 0.11e2 / 0.12e2 * t395 * t60 + t85 * t330 / 0.2e1 + 0.3e1 / 0.4e1 * t400 * t101 + t156 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t486 = 0.2e1 * t138 * t130;
  t487 = t113 * t101;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t194 * t198;
  t510 = t169 * t169;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t166 * t166;
  t519 = t34 * t272;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t197 * t525;
  t527 = t89 * t526;
  t529 = t176 * t176;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t173 * t173;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t201 * t542;
  t544 = t96 * t543;
  t546 = t124 * t124;
  t548 = 0.1e1 / t126 / t546;
  t550 = 0.88e2 / 0.9e1 * t123 * t548;
  t551 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t550;
  t555 = t29 * t491;
  t558 = t63 * t494;
  t561 = t67 * t497;
  t564 = 0.1e1 / t2;
  t565 = t71 * t564;
  t568 = t84 * t494;
  t571 = t104 * t497;
  t574 = t109 * t564;
  t577 = t486 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.3e1 * t243 * t233 + t139 * t551 + 0.4e1 * t247 * t233 + 0.2e1 / 0.9e1 * t555 * t60 + 0.3e1 / 0.8e1 * t558 * t60 + 0.5e1 / 0.9e1 * t561 * t60 + 0.55e2 / 0.72e2 * t565 * t60 + 0.3e1 / 0.8e1 * t568 * t101 + 0.5e1 / 0.9e1 * t571 * t101 + 0.55e2 / 0.72e2 * t574 * t101;
  t578 = t118 * t494;
  t581 = t132 * t497;
  t584 = t135 * t564;
  t588 = 0.2e1 * t142 * t144;
  t590 = 0.2e1 * t148 * t144;
  t592 = 0.2e1 * t151 * t144;
  t594 = 0.2e1 * t154 * t144;
  t596 = 0.1e1 / t9 / t191;
  t597 = t31 * t596;
  t602 = t525 * t46;
  t605 = t542 * t46;
  t608 = 0.7e1 / 0.9e1 * t597 * t47 - 0.2e1 / 0.3e1 * t162 * t170 + t33 * t602 / 0.4e1 + t51 * t605 / 0.4e1;
  t631 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t634 = 0.3e1 / 0.4e1 * t578 * t130 + 0.1e2 / 0.9e1 * t581 * t130 + 0.55e2 / 0.36e2 * t584 * t130 + t588 + t590 + t592 + t594 + t30 * t608 / 0.2e1 + 0.4e1 / 0.3e1 * t253 * t180 + t64 * t608 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t180 + t68 * t608 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t180 + t81 * t608 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t180 + t85 * t631 / 0.2e1;
  t657 = t147 * t491;
  t660 = t291 * t165;
  t662 = t291 * t273;
  t664 = t150 * t494;
  t667 = 0.3e1 / 0.2e1 * t208 * t205 + t105 * t631 / 0.2e1 + 0.5e1 / 0.3e1 * t213 * t205 + t110 * t631 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t205 + t115 * t631 / 0.2e1 + 0.2e1 * t223 * t205 + t119 * t551 + 0.3e1 * t235 * t233 + t133 * t551 + 0.1e2 / 0.3e1 * t239 * t233 + t136 * t551 + 0.4e1 / 0.9e1 * t657 * t145 + 0.16e2 / 0.3e1 * t660 - 0.16e2 / 0.3e1 * t662 + 0.3e1 / 0.4e1 * t664 * t145;
  t668 = t294 * t165;
  t670 = t294 * t273;
  t672 = t153 * t497;
  t675 = t297 * t165;
  t677 = t297 * t273;
  t680 = 0.8e1 * t142 * t519;
  t681 = 0.1e1 / t546;
  t682 = t143 * t681;
  t684 = 0.6e1 * t142 * t682;
  t686 = 0.8e1 * t148 * t519;
  t688 = 0.6e1 * t148 * t682;
  t690 = 0.8e1 * t151 * t519;
  t692 = 0.6e1 * t151 * t682;
  t694 = 0.8e1 * t154 * t519;
  t696 = 0.6e1 * t154 * t682;
  t697 = t141 * t488;
  t700 = t288 * t165;
  t702 = t288 * t273;
  t704 = 0.6e1 * t668 - 0.6e1 * t670 + 0.1e2 / 0.9e1 * t672 * t145 + 0.2e2 / 0.3e1 * t675 - 0.2e2 / 0.3e1 * t677 - t680 + t684 - t686 + t688 - t690 + t692 - t694 + t696 + 0.7e1 / 0.36e2 * t697 * t145 + 0.14e2 / 0.3e1 * t700 - 0.14e2 / 0.3e1 * t702;
  tv2rho20 = t577 + t634 + t667 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t710 = t194 * t314;
  t712 = t169 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t166 + 0.8e1 / 0.3e1 * t719 * t272);
  t724 = t197 * t723;
  t725 = t89 * t724;
  t727 = t320 * t202;
  t729 = t176 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t173 - 0.8e1 / 0.3e1 * t736 * t272);
  t741 = t201 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t550;
  t762 = t723 * t46;
  t767 = t740 * t46;
  t770 = -t162 * t365 / 0.3e1 + t33 * t762 / 0.4e1 - t370 * t177 / 0.3e1 + t51 * t767 / 0.4e1;
  t779 = 0.3e1 / 0.2e1 * t235 * t348 + 0.3e1 / 0.2e1 * t350 * t233 + t133 * t744 + 0.5e1 / 0.3e1 * t239 * t348 + 0.5e1 / 0.3e1 * t354 * t233 + t136 * t744 + 0.11e2 / 0.6e1 * t243 * t348 + 0.11e2 / 0.6e1 * t358 * t233 + t139 * t744 + 0.2e1 * t247 * t348 + 0.2e1 * t362 * t233 + t30 * t770 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t376 + 0.2e1 / 0.3e1 * t379 * t180 + t64 * t770 / 0.2e1;
  t802 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t817 = 0.3e1 / 0.4e1 * t258 * t376 + 0.3e1 / 0.4e1 * t385 * t180 + t68 * t770 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t376 + 0.5e1 / 0.6e1 * t390 * t180 + t81 * t770 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t376 + 0.11e2 / 0.12e2 * t395 * t180 + t85 * t802 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t330 + 0.3e1 / 0.4e1 * t400 * t205 + t105 * t802 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t330 + 0.5e1 / 0.6e1 * t333 * t205 + t110 * t802 / 0.2e1;
  t828 = t404 * t165;
  t830 = t404 * t273;
  t832 = t407 * t165;
  t834 = t407 * t273;
  t836 = t410 * t165;
  t838 = 0.11e2 / 0.12e2 * t218 * t330 + 0.11e2 / 0.12e2 * t338 * t205 + t115 * t802 / 0.2e1 + t223 * t330 + t343 * t205 + t119 * t744 - t588 - t590 - t592 - t594 + 0.7e1 / 0.3e1 * t828 - 0.7e1 / 0.3e1 * t830 + 0.8e1 / 0.3e1 * t832 - 0.8e1 / 0.3e1 * t834 + 0.3e1 * t836;
  t839 = t410 * t273;
  t841 = t413 * t165;
  t843 = t413 * t273;
  t853 = -0.3e1 * t839 + 0.1e2 / 0.3e1 * t841 - 0.1e2 / 0.3e1 * t843 - 0.8e1 / 0.3e1 * t660 - 0.8e1 / 0.3e1 * t662 - 0.3e1 * t668 - 0.3e1 * t670 - 0.1e2 / 0.3e1 * t675 - 0.1e2 / 0.3e1 * t677 + t684 + t688 + t692 + t696 - 0.7e1 / 0.3e1 * t700 - 0.7e1 / 0.3e1 * t702;
  tv2rho21 = t779 + t817 + t838 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = t310 * t310;
  t871 = 0.2e1 * t144 + 0.2e1 * t519;
  t875 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t867 + 0.4e1 / 0.3e1 * t42 * t871);
  t876 = t875 * t46;
  t880 = 0.1e1 / t11 / t317;
  t881 = t49 * t880;
  t886 = t323 * t323;
  t889 = -t871;
  t893 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t886 + 0.4e1 / 0.3e1 * t54 * t889);
  t894 = t893 * t46;
  t897 = t33 * t876 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t57 - 0.2e1 / 0.3e1 * t370 * t373 + t51 * t894 / 0.4e1;
  t914 = t313 * t313;
  t915 = t914 * t45;
  t916 = t89 * t915;
  t918 = t197 * t875;
  t919 = t89 * t918;
  t921 = t93 * t93;
  t923 = 0.1e1 / t25 / t921;
  t924 = sigma[2] * t923;
  t925 = t924 * t98;
  t927 = t320 * t327;
  t929 = t326 * t326;
  t930 = t929 * t45;
  t931 = t96 * t930;
  t933 = t201 * t893;
  t934 = t96 * t933;
  t936 = t916 / 0.4e1 + t919 / 0.4e1 + 0.11e2 / 0.9e1 * t925 - 0.4e1 / 0.3e1 * t927 + t931 / 0.4e1 + t934 / 0.4e1;
  t941 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t486 + t487 + t30 * t897 / 0.2e1 + 0.4e1 / 0.3e1 * t379 * t376 + t64 * t897 / 0.2e1 + 0.3e1 / 0.2e1 * t385 * t376 + t68 * t897 / 0.2e1 + 0.5e1 / 0.3e1 * t390 * t376 + t81 * t897 / 0.2e1 + 0.11e2 / 0.6e1 * t395 * t376 + t85 * t936 / 0.2e1 + 0.3e1 / 0.2e1 * t400 * t330;
  t960 = t916 / 0.2e1 + t919 / 0.2e1 + 0.22e2 / 0.9e1 * t925 - 0.8e1 / 0.3e1 * t927 + t931 / 0.2e1 + t934 / 0.2e1 - t550;
  t973 = t29 * t858;
  t976 = t63 * t861;
  t979 = t105 * t936 / 0.2e1 + 0.5e1 / 0.3e1 * t333 * t330 + t110 * t936 / 0.2e1 + 0.11e2 / 0.6e1 * t338 * t330 + t115 * t936 / 0.2e1 + 0.2e1 * t343 * t330 + t119 * t960 + 0.3e1 * t350 * t348 + t133 * t960 + 0.1e2 / 0.3e1 * t354 * t348 + t136 * t960 + 0.11e2 / 0.3e1 * t358 * t348 + t139 * t960 + 0.4e1 * t362 * t348 + 0.2e1 / 0.9e1 * t973 * t60 + 0.3e1 / 0.8e1 * t976 * t60;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t109 * t984;
  t997 = t118 * t861;
  t1000 = t132 * t864;
  t1003 = t135 * t984;
  t1006 = t141 * t855;
  t1009 = t147 * t858;
  t1012 = t150 * t861;
  t1015 = t153 * t864;
  t1018 = 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101 + 0.55e2 / 0.72e2 * t994 * t101 + 0.3e1 / 0.4e1 * t997 * t130 + 0.1e2 / 0.9e1 * t1000 * t130 + 0.55e2 / 0.36e2 * t1003 * t130 + t588 + t590 + t592 + t594 + 0.7e1 / 0.36e2 * t1006 * t145 + 0.4e1 / 0.9e1 * t1009 * t145 + 0.3e1 / 0.4e1 * t1012 * t145 + 0.1e2 / 0.9e1 * t1015 * t145;
  t1027 = -0.14e2 / 0.3e1 * t828 - 0.14e2 / 0.3e1 * t830 - 0.16e2 / 0.3e1 * t832 - 0.16e2 / 0.3e1 * t834 - 0.6e1 * t836 - 0.6e1 * t839 - 0.2e2 / 0.3e1 * t841 - 0.2e2 / 0.3e1 * t843 + t680 + t684 + t686 + t688 + t690 + t692 + t694 + t696;
  tv2rho22 = t941 + t979 + t1018 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1029 = t105 * t88;
  t1032 = t110 * t88;
  t1035 = t115 * t88;
  t1038 = t67 * t491;
  t1040 = t418 * t44 * t46;
  t1043 = t71 * t494;
  t1047 = t193 * t90 * t45;
  t1057 = t29 / rho[0];
  t1060 = t63 * t488;
  t1064 = t88 * t44;
  t1067 = 0.8e1 / 0.3e1 * t230;
  t1068 = -0.2e1 / 0.3e1 * t1047 + t1064 * t712 / 0.2e1 + t1067;
  t1076 = t1029 * t198 / 0.8e1 + t1032 * t198 / 0.8e1 + t1035 * t198 / 0.8e1 + 0.5e1 / 0.48e2 * t1038 * t1040 + 0.11e2 / 0.96e2 * t1043 * t1040 - t85 * t1047 / 0.6e1 - t105 * t1047 / 0.6e1 - t110 * t1047 / 0.6e1 - t115 * t1047 / 0.6e1 + t1057 * t1040 / 0.12e2 + 0.3e1 / 0.32e2 * t1060 * t1040 + t119 * t1068 + 0.3e1 / 0.2e1 * t235 * t444 + t133 * t1068 + 0.5e1 / 0.3e1 * t239 * t444 + t136 * t1068;
  t1083 = 0.1e1 / t2 / t86;
  t1084 = t84 * t1083;
  t1087 = 0.1e1 / t86;
  t1088 = t104 * t1087;
  t1091 = 0.1e1 / t75;
  t1092 = t109 * t1091;
  t1095 = 0.1e1 / t24;
  t1096 = t113 * t1095;
  t1100 = t161 * t44 * t46;
  t1110 = t32 * t169 * t46;
  t1119 = t85 * t88;
  t1122 = 0.11e2 / 0.6e1 * t243 * t444 + t139 * t1068 + 0.2e1 * t247 * t444 + 0.3e1 / 0.32e2 * t1084 * t91 + 0.5e1 / 0.48e2 * t1088 * t91 + 0.11e2 / 0.96e2 * t1092 * t91 + t1096 * t91 / 0.8e1 - t427 * t1100 / 0.12e2 - t430 * t1100 / 0.12e2 - t419 * t1100 / 0.12e2 - t424 * t1100 / 0.12e2 + t419 * t1110 / 0.16e2 + t424 * t1110 / 0.16e2 + t427 * t1110 / 0.16e2 + t430 * t1110 / 0.16e2 + t1119 * t198 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t230;
  t1130 = 0.16e2 / 0.3e1 * t133 * t230;
  t1134 = 0.16e2 / 0.3e1 * t136 * t230;
  t1138 = 0.16e2 / 0.3e1 * t139 * t230;
  tv2rhosigma1 = -0.3e1 * t235 * t128 + t1126 - 0.1e2 / 0.3e1 * t239 * t128 + t1130 - 0.11e2 / 0.3e1 * t243 * t128 + t1134 - 0.4e1 * t247 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t253 * t454;
  t1143 = t50 * t176 * t46;
  t1146 = t258 * t454;
  t1151 = t183 * t454;
  t1156 = t188 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t208 * t470 + t1163 * t202 / 0.8e1 + 0.5e1 / 0.48e2 * t213 * t470 + t1168 * t202 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1067;
  t1198 = 0.11e2 / 0.96e2 * t218 * t470 + t1174 * t202 / 0.8e1 + t223 * t470 / 0.8e1 + t1179 * t202 / 0.8e1 + 0.3e1 / 0.2e1 * t235 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t239 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t243 * t480 + t136 * t1187 + 0.2e1 * t247 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t379 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t385 * t418;
  t1211 = t390 * t418;
  t1216 = t395 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t400 * t434 + t1119 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t333 * t434 + t1029 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1064 * t1240 / 0.2e1 + t1067;
  t1254 = 0.11e2 / 0.96e2 * t338 * t434 + t1032 * t314 / 0.8e1 + t343 * t434 / 0.8e1 + t1035 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t350 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t354 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t358 * t444 + t136 * t1243 + 0.2e1 * t362 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t350 * t128 + t1126 - 0.1e2 / 0.3e1 * t354 * t128 + t1130 - 0.11e2 / 0.3e1 * t358 * t128 + t1134 - 0.4e1 * t362 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t50 * t326 * t46;
  t1282 = t369 * t56 * t46;
  t1292 = t319 * t97 * t45;
  t1301 = t455 * t1264 / 0.16e2 + t460 * t1264 / 0.16e2 + t463 * t1264 / 0.16e2 + t466 * t1264 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 - t455 * t1282 / 0.12e2 - t460 * t1282 / 0.12e2 - t463 * t1282 / 0.12e2 - t466 * t1282 / 0.12e2 - t85 * t1292 / 0.6e1 - t105 * t1292 / 0.6e1 - t110 * t1292 / 0.6e1 - t115 * t1292 / 0.6e1;
  t1303 = t29 / rho[1];
  t1305 = t454 * t56 * t46;
  t1308 = t63 * t855;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1292 + t1184 * t1318 / 0.2e1 + t1067;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = t1303 * t1305 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t1305 + 0.5e1 / 0.48e2 * t1311 * t1305 + 0.11e2 / 0.96e2 * t1314 * t1305 + t119 * t1321 + 0.3e1 / 0.2e1 * t350 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t354 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t358 * t480 + t139 * t1321 + 0.2e1 * t362 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1301 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t161, t162, t165, t166, t169, t170, t173, t176;
  double t177, t180, t183, t188, t191, t193, t194, t195;
  double t197, t198, t199, t201, t202, t203, t205, t208;
  double t213, t218, t223, t228, t230, t232, t233, t235;
  double t239, t243, t247, t250, t253, t258, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t333, t338, t343, t348, t350;
  double t354, t358, t362, t365, t369, t370, t373, t376;
  double t379, t382, t385, t390, t395, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t486, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t548, t550, t551, t555, t558, t561, t564;
  double t565, t568, t571, t574, t577, t578, t581, t584;
  double t588, t590, t592, t594, t596, t597, t602, t605;
  double t608, t631, t634, t657, t660, t662, t664, t667;
  double t668, t670, t672, t675, t677, t680, t681, t682;
  double t684, t686, t688, t690, t692, t694, t696, t697;
  double t700, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t762;
  double t767, t770, t779, t802, t817, t828, t830, t832;
  double t834, t836, t838, t839, t841, t843, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t871, t875, t876;
  double t880, t881, t886, t889, t893, t894, t897, t914;
  double t915, t916, t918, t919, t921, t923, t924, t925;
  double t927, t929, t930, t931, t933, t934, t936, t941;
  double t960, t973, t976, t979, t981, t984, t985, t988;
  double t991, t994, t997, t1000, t1003, t1006, t1009, t1012;
  double t1015, t1018, t1027, tv2rho22, t1029, t1032, t1035, t1038;
  double t1040, t1043, t1047, t1057, t1060, t1064, t1067, t1068;
  double t1076, t1083, t1084, t1087, t1088, t1091, t1092, t1095;
  double t1096, t1100, t1110, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1282, t1292, t1301;
  double t1303, t1305, t1308, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1374, t1376, t1378, t1380, t1383, t1385, t1387, t1389;
  double t1391, t1392, t1395, t1398, t1400, t1402, t1404, t1407;
  double t1409, t1411, t1413, t1415, t1416, t1417, t1418, t1419;
  double t1420, t1422, t1423, t1424, t1425, t1428, t1429, t1430;
  double t1432, t1433, t1434, t1436, t1437, t1440, t1442, t1444;
  double t1450, t1456, t1457, t1464, t1465, t1468, t1472, t1476;
  double t1477, t1481, t1482, t1485, t1488, t1492, t1493, t1496;
  double t1513, t1515, t1516, t1517, t1519, t1521, t1523, t1525;
  double t1526, t1528, t1529, t1531, t1532, t1534, t1535, t1537;
  double t1540, t1566, t1568, t1569, t1583, t1584, t1585, t1586;
  double t1587, t1588, t1589, t1592, t1595, t1598, t1600, t1601;
  double t1604, t1607, t1610, t1613, t1616, t1619, t1622, t1624;
  double t1626, t1628, t1630, t1631, t1632, t1653, tv3rho30, t1656;
  double t1658, t1660, t1662, t1664, t1666, t1668, t1670, t1675;
  double t1684, t1685, t1686, t1688, t1689, t1691, t1692, t1696;
  double t1698, t1700, t1702, t1703, t1704, t1706, t1707, t1708;
  double t1711, t1722, t1723, t1724, t1726, t1728, t1730, t1731;
  double t1732, t1734, t1735, t1736, t1739, t1750, t1751, t1752;
  double t1754, t1758, t1774, t1779, t1782, t1793, t1821, t1830;
  double t1851, t1856, t1858, t1860, t1862, t1874, t1881, t1882;
  double t1883, t1888, t1889, tv3rho31, t1892, t1894, t1896, t1898;
  double t1900, t1902, t1904, t1906, t1911, t1921, t1926, t1931;
  double t1936, t1940, t1941, t1948, t1953, t1956, t1960, t1961;
  double t1964, t1971, t1990, t1992, t1993, t1995, t1997, t1998;
  double t2000, t2001, t2003, t2005, t2007, t2009, t2010, t2012;
  double t2013, t2015, t2016, t2018, t2023, t2054, t2056, t2076;
  double t2099, t2107, tv3rho32, t2114, t2119, t2122, t2125, t2128;
  double t2145, t2150, t2153, t2159, t2163, t2164, t2168, t2169;
  double t2175, t2180, t2184, t2185, t2188, t2205, t2206, t2208;
  double t2209, t2211, t2213, t2214, t2215, t2217, t2219, t2221;
  double t2223, t2224, t2226, t2227, t2229, t2232, t2257, t2271;
  double t2274, t2277, t2280, t2281, t2284, t2287, t2290, t2292;
  double t2295, t2298, t2301, t2318, t2329, tv3rho33, t2333, t2336;
  double t2339, t2340, t2344, t2345, t2348, t2349, t2351, t2356;
  double t2361, t2367, t2373, t2376, t2383, t2397, t2399, t2403;
  double t2407, t2408, t2416, t2426, t2436, t2439, t2442, t2445;
  double t2448, t2453, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2509, t2510;
  double t2511, t2516, t2520, t2539, t2547, t2554, t2555, t2560;
  double t2565, t2576, t2579, t2582, t2585, t2602, tv3rho2sigma2, t2607;
  double t2610, t2613, t2633, t2638, t2645, t2652, t2659, t2669;
  double t2672, t2700, t2703, t2725, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2748, t2751, t2754, t2757, t2782;
  double t2785, t2795, t2811, t2816, t2826, t2835, t2844, t2849;
  double t2863, t2880, tv3rho2sigma5, t2892, t2894, t2897, t2917, t2924;
  double t2943, t2946, t2949, t2952, t2969, tv3rho2sigma6, tv3rho2sigma7, t2986;
  double t2991, t2993, t2996, t3011, t3012, t3015, t3017, t3018;
  double t3023, t3033, t3052, t3055, t3065, t3082, t3085, t3088;
  double t3089, t3092, t3096, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = 0.1e1 / t9 / t86;
  t162 = t31 * t161;
  t165 = t34 * t144;
  t166 = t36 - t165;
  t169 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t166);
  t170 = t169 * t46;
  t173 = -t166;
  t176 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t173);
  t177 = t176 * t46;
  t180 = -t162 * t47 / 0.3e1 + t33 * t170 / 0.4e1 + t51 * t177 / 0.4e1;
  t183 = t67 * t23;
  t188 = t71 * t74;
  t191 = t86 * rho[0];
  t193 = 0.1e1 / t23 / t191;
  t194 = sigma[0] * t193;
  t195 = t194 * t91;
  t197 = t44 * t45;
  t198 = t197 * t169;
  t199 = t89 * t198;
  t201 = t56 * t45;
  t202 = t201 * t176;
  t203 = t96 * t202;
  t205 = -t195 / 0.3e1 + t199 / 0.4e1 + t203 / 0.4e1;
  t208 = t84 * t16;
  t213 = t104 * t23;
  t218 = t109 * t74;
  t223 = t113 * rho[0];
  t228 = t124 * t35;
  t230 = 0.1e1 / t126 / t228;
  t232 = 0.8e1 / 0.3e1 * t123 * t230;
  t233 = -0.2e1 / 0.3e1 * t195 + t199 / 0.2e1 + t203 / 0.2e1 + t232;
  t235 = t118 * t16;
  t239 = t132 * t23;
  t243 = t135 * t74;
  t247 = t138 * rho[0];
  t250 = t68 * t180 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t60 + t81 * t180 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t60 + t85 * t205 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t101 + t105 * t205 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t101 + t110 * t205 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t101 + t115 * t205 / 0.2e1 + t223 * t101 + t119 * t233 + 0.3e1 / 0.2e1 * t235 * t130 + t133 * t233 + 0.5e1 / 0.3e1 * t239 * t130 + t136 * t233 + 0.11e2 / 0.6e1 * t243 * t130 + t139 * t233 + 0.2e1 * t247 * t130;
  t253 = t29 * t9;
  t258 = t63 * t16;
  t270 = 0.2e1 * t142 * t165;
  t272 = 0.1e1 / t228;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t165;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t165;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t165;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t250 + t30 * t180 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t60 + t64 * t180 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t60 + t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = -t36 - t165;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t197 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t201 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t333 = t104 * t25;
  t338 = t109 * t78;
  t343 = t113 * rho[1];
  t348 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t232;
  t350 = t118 * t18;
  t354 = t132 * t25;
  t358 = t135 * t78;
  t362 = t138 * rho[1];
  t365 = t313 * t46;
  t369 = 0.1e1 / t11 / t93;
  t370 = t49 * t369;
  t373 = t326 * t46;
  t376 = t33 * t365 / 0.4e1 - t370 * t57 / 0.3e1 + t51 * t373 / 0.4e1;
  t379 = t29 * t11;
  t382 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t105 * t330 / 0.2e1 + 0.5e1 / 0.6e1 * t333 * t101 + t110 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t338 * t101 + t115 * t330 / 0.2e1 + t343 * t101 + t119 * t348 + 0.3e1 / 0.2e1 * t350 * t130 + t133 * t348 + 0.5e1 / 0.3e1 * t354 * t130 + t136 * t348 + 0.11e2 / 0.6e1 * t358 * t130 + t139 * t348 + 0.2e1 * t362 * t130 + t30 * t376 / 0.2e1 + 0.2e1 / 0.3e1 * t379 * t60;
  t385 = t63 * t18;
  t390 = t67 * t25;
  t395 = t71 * t78;
  t400 = t84 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t382 + t64 * t376 / 0.2e1 + 0.3e1 / 0.4e1 * t385 * t60 + t68 * t376 / 0.2e1 + 0.5e1 / 0.6e1 * t390 * t60 + t81 * t376 / 0.2e1 + 0.11e2 / 0.12e2 * t395 * t60 + t85 * t330 / 0.2e1 + 0.3e1 / 0.4e1 * t400 * t101 + t156 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t486 = 0.2e1 * t138 * t130;
  t487 = t113 * t101;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t194 * t198;
  t510 = t169 * t169;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t166 * t166;
  t519 = t34 * t272;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t197 * t525;
  t527 = t89 * t526;
  t529 = t176 * t176;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t173 * t173;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t201 * t542;
  t544 = t96 * t543;
  t546 = t124 * t124;
  t548 = 0.1e1 / t126 / t546;
  t550 = 0.88e2 / 0.9e1 * t123 * t548;
  t551 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t550;
  t555 = t29 * t491;
  t558 = t63 * t494;
  t561 = t67 * t497;
  t564 = 0.1e1 / t2;
  t565 = t71 * t564;
  t568 = t84 * t494;
  t571 = t104 * t497;
  t574 = t109 * t564;
  t577 = t486 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.3e1 * t243 * t233 + t139 * t551 + 0.4e1 * t247 * t233 + 0.2e1 / 0.9e1 * t555 * t60 + 0.3e1 / 0.8e1 * t558 * t60 + 0.5e1 / 0.9e1 * t561 * t60 + 0.55e2 / 0.72e2 * t565 * t60 + 0.3e1 / 0.8e1 * t568 * t101 + 0.5e1 / 0.9e1 * t571 * t101 + 0.55e2 / 0.72e2 * t574 * t101;
  t578 = t118 * t494;
  t581 = t132 * t497;
  t584 = t135 * t564;
  t588 = 0.2e1 * t142 * t144;
  t590 = 0.2e1 * t148 * t144;
  t592 = 0.2e1 * t151 * t144;
  t594 = 0.2e1 * t154 * t144;
  t596 = 0.1e1 / t9 / t191;
  t597 = t31 * t596;
  t602 = t525 * t46;
  t605 = t542 * t46;
  t608 = 0.7e1 / 0.9e1 * t597 * t47 - 0.2e1 / 0.3e1 * t162 * t170 + t33 * t602 / 0.4e1 + t51 * t605 / 0.4e1;
  t631 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t634 = 0.3e1 / 0.4e1 * t578 * t130 + 0.1e2 / 0.9e1 * t581 * t130 + 0.55e2 / 0.36e2 * t584 * t130 + t588 + t590 + t592 + t594 + t30 * t608 / 0.2e1 + 0.4e1 / 0.3e1 * t253 * t180 + t64 * t608 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t180 + t68 * t608 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t180 + t81 * t608 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t180 + t85 * t631 / 0.2e1;
  t657 = t147 * t491;
  t660 = t291 * t165;
  t662 = t291 * t273;
  t664 = t150 * t494;
  t667 = 0.3e1 / 0.2e1 * t208 * t205 + t105 * t631 / 0.2e1 + 0.5e1 / 0.3e1 * t213 * t205 + t110 * t631 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t205 + t115 * t631 / 0.2e1 + 0.2e1 * t223 * t205 + t119 * t551 + 0.3e1 * t235 * t233 + t133 * t551 + 0.1e2 / 0.3e1 * t239 * t233 + t136 * t551 + 0.4e1 / 0.9e1 * t657 * t145 + 0.16e2 / 0.3e1 * t660 - 0.16e2 / 0.3e1 * t662 + 0.3e1 / 0.4e1 * t664 * t145;
  t668 = t294 * t165;
  t670 = t294 * t273;
  t672 = t153 * t497;
  t675 = t297 * t165;
  t677 = t297 * t273;
  t680 = 0.8e1 * t142 * t519;
  t681 = 0.1e1 / t546;
  t682 = t143 * t681;
  t684 = 0.6e1 * t142 * t682;
  t686 = 0.8e1 * t148 * t519;
  t688 = 0.6e1 * t148 * t682;
  t690 = 0.8e1 * t151 * t519;
  t692 = 0.6e1 * t151 * t682;
  t694 = 0.8e1 * t154 * t519;
  t696 = 0.6e1 * t154 * t682;
  t697 = t141 * t488;
  t700 = t288 * t165;
  t702 = t288 * t273;
  t704 = 0.6e1 * t668 - 0.6e1 * t670 + 0.1e2 / 0.9e1 * t672 * t145 + 0.2e2 / 0.3e1 * t675 - 0.2e2 / 0.3e1 * t677 - t680 + t684 - t686 + t688 - t690 + t692 - t694 + t696 + 0.7e1 / 0.36e2 * t697 * t145 + 0.14e2 / 0.3e1 * t700 - 0.14e2 / 0.3e1 * t702;
  tv2rho20 = t577 + t634 + t667 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t710 = t194 * t314;
  t712 = t169 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t166 + 0.8e1 / 0.3e1 * t719 * t272);
  t724 = t197 * t723;
  t725 = t89 * t724;
  t727 = t320 * t202;
  t729 = t176 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t173 - 0.8e1 / 0.3e1 * t736 * t272);
  t741 = t201 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t550;
  t762 = t723 * t46;
  t767 = t740 * t46;
  t770 = -t162 * t365 / 0.3e1 + t33 * t762 / 0.4e1 - t370 * t177 / 0.3e1 + t51 * t767 / 0.4e1;
  t779 = 0.3e1 / 0.2e1 * t235 * t348 + 0.3e1 / 0.2e1 * t350 * t233 + t133 * t744 + 0.5e1 / 0.3e1 * t239 * t348 + 0.5e1 / 0.3e1 * t354 * t233 + t136 * t744 + 0.11e2 / 0.6e1 * t243 * t348 + 0.11e2 / 0.6e1 * t358 * t233 + t139 * t744 + 0.2e1 * t247 * t348 + 0.2e1 * t362 * t233 + t30 * t770 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t376 + 0.2e1 / 0.3e1 * t379 * t180 + t64 * t770 / 0.2e1;
  t802 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t817 = 0.3e1 / 0.4e1 * t258 * t376 + 0.3e1 / 0.4e1 * t385 * t180 + t68 * t770 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t376 + 0.5e1 / 0.6e1 * t390 * t180 + t81 * t770 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t376 + 0.11e2 / 0.12e2 * t395 * t180 + t85 * t802 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t330 + 0.3e1 / 0.4e1 * t400 * t205 + t105 * t802 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t330 + 0.5e1 / 0.6e1 * t333 * t205 + t110 * t802 / 0.2e1;
  t828 = t404 * t165;
  t830 = t404 * t273;
  t832 = t407 * t165;
  t834 = t407 * t273;
  t836 = t410 * t165;
  t838 = 0.11e2 / 0.12e2 * t218 * t330 + 0.11e2 / 0.12e2 * t338 * t205 + t115 * t802 / 0.2e1 + t223 * t330 + t343 * t205 + t119 * t744 - t588 - t590 - t592 - t594 + 0.7e1 / 0.3e1 * t828 - 0.7e1 / 0.3e1 * t830 + 0.8e1 / 0.3e1 * t832 - 0.8e1 / 0.3e1 * t834 + 0.3e1 * t836;
  t839 = t410 * t273;
  t841 = t413 * t165;
  t843 = t413 * t273;
  t853 = -0.3e1 * t839 + 0.1e2 / 0.3e1 * t841 - 0.1e2 / 0.3e1 * t843 - 0.8e1 / 0.3e1 * t660 - 0.8e1 / 0.3e1 * t662 - 0.3e1 * t668 - 0.3e1 * t670 - 0.1e2 / 0.3e1 * t675 - 0.1e2 / 0.3e1 * t677 + t684 + t688 + t692 + t696 - 0.7e1 / 0.3e1 * t700 - 0.7e1 / 0.3e1 * t702;
  tv2rho21 = t779 + t817 + t838 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = t310 * t310;
  t871 = 0.2e1 * t144 + 0.2e1 * t519;
  t875 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t867 + 0.4e1 / 0.3e1 * t42 * t871);
  t876 = t875 * t46;
  t880 = 0.1e1 / t11 / t317;
  t881 = t49 * t880;
  t886 = t323 * t323;
  t889 = -t871;
  t893 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t886 + 0.4e1 / 0.3e1 * t54 * t889);
  t894 = t893 * t46;
  t897 = t33 * t876 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t57 - 0.2e1 / 0.3e1 * t370 * t373 + t51 * t894 / 0.4e1;
  t914 = t313 * t313;
  t915 = t914 * t45;
  t916 = t89 * t915;
  t918 = t197 * t875;
  t919 = t89 * t918;
  t921 = t93 * t93;
  t923 = 0.1e1 / t25 / t921;
  t924 = sigma[2] * t923;
  t925 = t924 * t98;
  t927 = t320 * t327;
  t929 = t326 * t326;
  t930 = t929 * t45;
  t931 = t96 * t930;
  t933 = t201 * t893;
  t934 = t96 * t933;
  t936 = t916 / 0.4e1 + t919 / 0.4e1 + 0.11e2 / 0.9e1 * t925 - 0.4e1 / 0.3e1 * t927 + t931 / 0.4e1 + t934 / 0.4e1;
  t941 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t486 + t487 + t30 * t897 / 0.2e1 + 0.4e1 / 0.3e1 * t379 * t376 + t64 * t897 / 0.2e1 + 0.3e1 / 0.2e1 * t385 * t376 + t68 * t897 / 0.2e1 + 0.5e1 / 0.3e1 * t390 * t376 + t81 * t897 / 0.2e1 + 0.11e2 / 0.6e1 * t395 * t376 + t85 * t936 / 0.2e1 + 0.3e1 / 0.2e1 * t400 * t330;
  t960 = t916 / 0.2e1 + t919 / 0.2e1 + 0.22e2 / 0.9e1 * t925 - 0.8e1 / 0.3e1 * t927 + t931 / 0.2e1 + t934 / 0.2e1 - t550;
  t973 = t29 * t858;
  t976 = t63 * t861;
  t979 = t105 * t936 / 0.2e1 + 0.5e1 / 0.3e1 * t333 * t330 + t110 * t936 / 0.2e1 + 0.11e2 / 0.6e1 * t338 * t330 + t115 * t936 / 0.2e1 + 0.2e1 * t343 * t330 + t119 * t960 + 0.3e1 * t350 * t348 + t133 * t960 + 0.1e2 / 0.3e1 * t354 * t348 + t136 * t960 + 0.11e2 / 0.3e1 * t358 * t348 + t139 * t960 + 0.4e1 * t362 * t348 + 0.2e1 / 0.9e1 * t973 * t60 + 0.3e1 / 0.8e1 * t976 * t60;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t109 * t984;
  t997 = t118 * t861;
  t1000 = t132 * t864;
  t1003 = t135 * t984;
  t1006 = t141 * t855;
  t1009 = t147 * t858;
  t1012 = t150 * t861;
  t1015 = t153 * t864;
  t1018 = 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101 + 0.55e2 / 0.72e2 * t994 * t101 + 0.3e1 / 0.4e1 * t997 * t130 + 0.1e2 / 0.9e1 * t1000 * t130 + 0.55e2 / 0.36e2 * t1003 * t130 + t588 + t590 + t592 + t594 + 0.7e1 / 0.36e2 * t1006 * t145 + 0.4e1 / 0.9e1 * t1009 * t145 + 0.3e1 / 0.4e1 * t1012 * t145 + 0.1e2 / 0.9e1 * t1015 * t145;
  t1027 = -0.14e2 / 0.3e1 * t828 - 0.14e2 / 0.3e1 * t830 - 0.16e2 / 0.3e1 * t832 - 0.16e2 / 0.3e1 * t834 - 0.6e1 * t836 - 0.6e1 * t839 - 0.2e2 / 0.3e1 * t841 - 0.2e2 / 0.3e1 * t843 + t680 + t684 + t686 + t688 + t690 + t692 + t694 + t696;
  tv2rho22 = t941 + t979 + t1018 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1029 = t105 * t88;
  t1032 = t110 * t88;
  t1035 = t115 * t88;
  t1038 = t67 * t491;
  t1040 = t418 * t44 * t46;
  t1043 = t71 * t494;
  t1047 = t193 * t90 * t45;
  t1057 = t29 / rho[0];
  t1060 = t63 * t488;
  t1064 = t88 * t44;
  t1067 = 0.8e1 / 0.3e1 * t230;
  t1068 = -0.2e1 / 0.3e1 * t1047 + t1064 * t712 / 0.2e1 + t1067;
  t1076 = t1029 * t198 / 0.8e1 + t1032 * t198 / 0.8e1 + t1035 * t198 / 0.8e1 + 0.5e1 / 0.48e2 * t1038 * t1040 + 0.11e2 / 0.96e2 * t1043 * t1040 - t85 * t1047 / 0.6e1 - t105 * t1047 / 0.6e1 - t110 * t1047 / 0.6e1 - t115 * t1047 / 0.6e1 + t1057 * t1040 / 0.12e2 + 0.3e1 / 0.32e2 * t1060 * t1040 + t119 * t1068 + 0.3e1 / 0.2e1 * t235 * t444 + t133 * t1068 + 0.5e1 / 0.3e1 * t239 * t444 + t136 * t1068;
  t1083 = 0.1e1 / t2 / t86;
  t1084 = t84 * t1083;
  t1087 = 0.1e1 / t86;
  t1088 = t104 * t1087;
  t1091 = 0.1e1 / t75;
  t1092 = t109 * t1091;
  t1095 = 0.1e1 / t24;
  t1096 = t113 * t1095;
  t1100 = t161 * t44 * t46;
  t1110 = t32 * t169 * t46;
  t1119 = t85 * t88;
  t1122 = 0.11e2 / 0.6e1 * t243 * t444 + t139 * t1068 + 0.2e1 * t247 * t444 + 0.3e1 / 0.32e2 * t1084 * t91 + 0.5e1 / 0.48e2 * t1088 * t91 + 0.11e2 / 0.96e2 * t1092 * t91 + t1096 * t91 / 0.8e1 - t427 * t1100 / 0.12e2 - t430 * t1100 / 0.12e2 - t419 * t1100 / 0.12e2 - t424 * t1100 / 0.12e2 + t419 * t1110 / 0.16e2 + t424 * t1110 / 0.16e2 + t427 * t1110 / 0.16e2 + t430 * t1110 / 0.16e2 + t1119 * t198 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t230;
  t1130 = 0.16e2 / 0.3e1 * t133 * t230;
  t1134 = 0.16e2 / 0.3e1 * t136 * t230;
  t1138 = 0.16e2 / 0.3e1 * t139 * t230;
  tv2rhosigma1 = -0.3e1 * t235 * t128 + t1126 - 0.1e2 / 0.3e1 * t239 * t128 + t1130 - 0.11e2 / 0.3e1 * t243 * t128 + t1134 - 0.4e1 * t247 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t253 * t454;
  t1143 = t50 * t176 * t46;
  t1146 = t258 * t454;
  t1151 = t183 * t454;
  t1156 = t188 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t208 * t470 + t1163 * t202 / 0.8e1 + 0.5e1 / 0.48e2 * t213 * t470 + t1168 * t202 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1067;
  t1198 = 0.11e2 / 0.96e2 * t218 * t470 + t1174 * t202 / 0.8e1 + t223 * t470 / 0.8e1 + t1179 * t202 / 0.8e1 + 0.3e1 / 0.2e1 * t235 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t239 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t243 * t480 + t136 * t1187 + 0.2e1 * t247 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t379 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t385 * t418;
  t1211 = t390 * t418;
  t1216 = t395 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t400 * t434 + t1119 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t333 * t434 + t1029 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1064 * t1240 / 0.2e1 + t1067;
  t1254 = 0.11e2 / 0.96e2 * t338 * t434 + t1032 * t314 / 0.8e1 + t343 * t434 / 0.8e1 + t1035 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t350 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t354 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t358 * t444 + t136 * t1243 + 0.2e1 * t362 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t350 * t128 + t1126 - 0.1e2 / 0.3e1 * t354 * t128 + t1130 - 0.11e2 / 0.3e1 * t358 * t128 + t1134 - 0.4e1 * t362 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t50 * t326 * t46;
  t1282 = t369 * t56 * t46;
  t1292 = t319 * t97 * t45;
  t1301 = t455 * t1264 / 0.16e2 + t460 * t1264 / 0.16e2 + t463 * t1264 / 0.16e2 + t466 * t1264 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 - t455 * t1282 / 0.12e2 - t460 * t1282 / 0.12e2 - t463 * t1282 / 0.12e2 - t466 * t1282 / 0.12e2 - t85 * t1292 / 0.6e1 - t105 * t1292 / 0.6e1 - t110 * t1292 / 0.6e1 - t115 * t1292 / 0.6e1;
  t1303 = t29 / rho[1];
  t1305 = t454 * t56 * t46;
  t1308 = t63 * t855;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1292 + t1184 * t1318 / 0.2e1 + t1067;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = t1303 * t1305 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t1305 + 0.5e1 / 0.48e2 * t1311 * t1305 + 0.11e2 / 0.96e2 * t1314 * t1305 + t119 * t1321 + 0.3e1 / 0.2e1 * t350 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t354 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t358 * t480 + t139 * t1321 + 0.2e1 * t362 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1301 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1374 = t697 * t273;
  t1376 = t288 * t519;
  t1378 = t288 * t682;
  t1380 = t147 * t1095;
  t1383 = t657 * t165;
  t1385 = t657 * t273;
  t1387 = t291 * t519;
  t1389 = t291 * t682;
  t1391 = 0.1e1 / t17;
  t1392 = t150 * t1391;
  t1395 = t664 * t165;
  t1398 = t664 * t273;
  t1400 = t294 * t519;
  t1402 = t294 * t682;
  t1404 = t153 * t32;
  t1407 = t672 * t165;
  t1409 = t672 * t273;
  t1411 = t297 * t519;
  t1413 = t297 * t682;
  t1415 = t34 * t681;
  t1416 = t142 * t1415;
  t1417 = 0.36e2 * t1416;
  t1418 = t546 * t35;
  t1419 = 0.1e1 / t1418;
  t1420 = t143 * t1419;
  t1422 = 0.24e2 * t142 * t1420;
  t1423 = t148 * t1415;
  t1424 = 0.36e2 * t1423;
  t1425 = -0.9e1 / 0.2e1 * t1398 - 0.36e2 * t1400 + 0.27e2 * t1402 - 0.1e2 / 0.27e2 * t1404 * t145 + 0.2e2 / 0.3e1 * t1407 - 0.2e2 / 0.3e1 * t1409 - 0.4e2 * t1411 + 0.3e2 * t1413 + t1417 - t1422 + t1424;
  t1428 = 0.24e2 * t148 * t1420;
  t1429 = t151 * t1415;
  t1430 = 0.36e2 * t1429;
  t1432 = 0.24e2 * t151 * t1420;
  t1433 = t154 * t1415;
  t1434 = 0.36e2 * t1433;
  t1436 = 0.24e2 * t154 * t1420;
  t1437 = t141 * t1091;
  t1440 = t697 * t165;
  t1442 = t113 * t205;
  t1444 = t138 * t233;
  t1450 = -t1428 + t1430 - t1432 + t1434 - t1436 - 0.35e2 / 0.216e3 * t1437 * t145 + 0.7e1 / 0.6e1 * t1440 + 0.3e1 * t1442 + 0.6e1 * t1444 - 0.35e2 / 0.216e3 * t1 * t1091 - 0.8e1 / 0.27e2 * t8 * t1095;
  t1456 = 0.1e1 / t9 / t502;
  t1457 = t31 * t1456;
  t1464 = 0.1e1 / t514 / t38;
  t1465 = t516 * t166;
  t1468 = t515 * t166;
  t1472 = 0.6e1 * t272 - 0.6e1 * t1415;
  t1476 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1464 * t1465 + 0.4e1 / 0.3e1 * t1468 * t521 + 0.4e1 / 0.3e1 * t42 * t1472);
  t1477 = t1476 * t46;
  t1481 = 0.1e1 / t533 / t52;
  t1482 = t535 * t173;
  t1485 = t534 * t173;
  t1488 = -t1472;
  t1492 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1481 * t1482 + 0.4e1 / 0.3e1 * t1485 * t538 + 0.4e1 / 0.3e1 * t54 * t1488);
  t1493 = t1492 * t46;
  t1496 = -0.7e2 / 0.27e2 * t1457 * t47 + 0.7e1 / 0.3e1 * t597 * t170 - t162 * t602 + t33 * t1477 / 0.4e1 + t51 * t1493 / 0.4e1;
  t1513 = t502 * rho[0];
  t1515 = 0.1e1 / t23 / t1513;
  t1516 = sigma[0] * t1515;
  t1517 = t1516 * t91;
  t1519 = t505 * t198;
  t1521 = t194 * t511;
  t1523 = t194 * t526;
  t1525 = t712 * t525;
  t1526 = t89 * t1525;
  t1528 = t197 * t1476;
  t1529 = t89 * t1528;
  t1531 = t729 * t542;
  t1532 = t96 * t1531;
  t1534 = t201 * t1492;
  t1535 = t96 * t1534;
  t1537 = -0.154e3 / 0.27e2 * t1517 + 0.22e2 / 0.3e1 * t1519 - 0.2e1 * t1521 - 0.2e1 * t1523 + 0.3e1 / 0.4e1 * t1526 + t1529 / 0.4e1 + 0.3e1 / 0.4e1 * t1532 + t1535 / 0.4e1;
  t1540 = -0.3e1 / 0.8e1 * t15 * t1391 - 0.1e2 / 0.27e2 * t22 * t32 + t30 * t1496 / 0.2e1 + 0.2e1 * t253 * t608 + t64 * t1496 / 0.2e1 + 0.9e1 / 0.4e1 * t258 * t608 + t68 * t1496 / 0.2e1 + 0.5e1 / 0.2e1 * t183 * t608 + t81 * t1496 / 0.2e1 + 0.11e2 / 0.4e1 * t188 * t608 + t85 * t1537 / 0.2e1;
  t1566 = 0.1e1 / t126 / t1418;
  t1568 = 0.1232e4 / 0.27e2 * t123 * t1566;
  t1569 = -0.308e3 / 0.27e2 * t1517 + 0.44e2 / 0.3e1 * t1519 - 0.4e1 * t1521 - 0.4e1 * t1523 + 0.3e1 / 0.2e1 * t1526 + t1529 / 0.2e1 + 0.3e1 / 0.2e1 * t1532 + t1535 / 0.2e1 + t1568;
  t1583 = t148 * t272;
  t1584 = 0.12e2 * t1583;
  t1585 = t151 * t272;
  t1586 = 0.12e2 * t1585;
  t1587 = t154 * t272;
  t1588 = 0.12e2 * t1587;
  t1589 = t29 * t1095;
  t1592 = t63 * t1391;
  t1595 = t67 * t32;
  t1598 = 0.5e1 * t239 * t551 + t136 * t1569 + 0.11e2 / 0.2e1 * t243 * t551 + t139 * t1569 + 0.6e1 * t247 * t551 - t1584 - t1586 - t1588 - 0.4e1 / 0.27e2 * t1589 * t60 - 0.3e1 / 0.16e2 * t1592 * t60 - 0.5e1 / 0.27e2 * t1595 * t60;
  t1600 = 0.1e1 / t3;
  t1601 = t71 * t1600;
  t1604 = t84 * t1391;
  t1607 = t104 * t32;
  t1610 = t109 * t1600;
  t1613 = t118 * t1391;
  t1616 = t132 * t32;
  t1619 = t135 * t1600;
  t1622 = t288 * t144;
  t1624 = t291 * t144;
  t1626 = t294 * t144;
  t1628 = t297 * t144;
  t1630 = -0.55e2 / 0.432e3 * t1601 * t60 - 0.3e1 / 0.16e2 * t1604 * t101 - 0.5e1 / 0.27e2 * t1607 * t101 - 0.55e2 / 0.432e3 * t1610 * t101 - 0.3e1 / 0.8e1 * t1613 * t130 - 0.1e2 / 0.27e2 * t1616 * t130 - 0.55e2 / 0.216e3 * t1619 * t130 + 0.7e1 * t1622 + 0.8e1 * t1624 + 0.9e1 * t1626 + 0.1e2 * t1628;
  t1631 = t142 * t272;
  t1632 = 0.12e2 * t1631;
  t1653 = -t1632 + 0.2e1 / 0.3e1 * t555 * t180 + 0.9e1 / 0.8e1 * t558 * t180 + 0.5e1 / 0.3e1 * t561 * t180 + 0.55e2 / 0.24e2 * t565 * t180 + 0.9e1 / 0.8e1 * t568 * t205 + 0.5e1 / 0.3e1 * t571 * t205 + 0.55e2 / 0.24e2 * t574 * t205 + 0.9e1 / 0.4e1 * t578 * t233 + 0.1e2 / 0.3e1 * t581 * t233 + 0.55e2 / 0.12e2 * t584 * t233;
  tv3rho30 = t1653 + t1630 + t1598 + t1540 + t1450 + t1425 + 0.9e1 / 0.2e1 * t1395 - 0.32e2 * t1387 + 0.24e2 * t1389 + 0.8e1 / 0.3e1 * t1383 - 0.8e1 / 0.3e1 * t1385 + 0.21e2 * t1378 - 0.7e1 / 0.6e1 * t1374 - 0.28e2 * t1376 + 0.9e1 / 0.4e1 * t208 * t631 + t105 * t1537 / 0.2e1 + 0.5e1 / 0.2e1 * t213 * t631 + t110 * t1537 / 0.2e1 + 0.11e2 / 0.4e1 * t218 * t631 + t115 * t1537 / 0.2e1 + 0.3e1 * t223 * t631 + t119 * t1569 + 0.9e1 / 0.2e1 * t235 * t551 + t133 * t1569 - 0.8e1 / 0.27e2 * t1380 * t145 - 0.3e1 / 0.8e1 * t1392 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1656 = t404 * t519;
  t1658 = t404 * t682;
  t1660 = t407 * t519;
  t1662 = t407 * t682;
  t1664 = t410 * t519;
  t1666 = t410 * t682;
  t1668 = t413 * t519;
  t1670 = t413 * t682;
  t1675 = -0.28e2 / 0.3e1 * t1656 + 0.7e1 * t1658 - 0.32e2 / 0.3e1 * t1660 + 0.8e1 * t1662 - 0.12e2 * t1664 + 0.9e1 * t1666 - 0.4e2 / 0.3e1 * t1668 + 0.1e2 * t1670 - 0.7e1 / 0.18e2 * t1374 + 0.14e2 * t1378 - 0.8e1 / 0.9e1 * t1383;
  t1684 = 0.12e2 * t1416;
  t1685 = 0.12e2 * t1423;
  t1686 = -0.8e1 / 0.9e1 * t1385 + 0.16e2 * t1389 - 0.3e1 / 0.2e1 * t1395 - 0.3e1 / 0.2e1 * t1398 + 0.18e2 * t1402 - 0.2e2 / 0.9e1 * t1407 - 0.2e2 / 0.9e1 * t1409 + 0.2e2 * t1413 + t1684 - t1422 + t1685;
  t1688 = 0.12e2 * t1429;
  t1689 = 0.12e2 * t1433;
  t1691 = t113 * t330;
  t1692 = t138 * t348;
  t1696 = t505 * t314;
  t1698 = t194 * t713;
  t1700 = t194 * t724;
  t1702 = t525 * t45;
  t1703 = t1702 * t313;
  t1704 = t89 * t1703;
  t1706 = t712 * t723;
  t1707 = t89 * t1706;
  t1708 = t1464 * t310;
  t1711 = t515 * t34;
  t1722 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1708 * t516 + 0.16e2 / 0.9e1 * t1711 * t272 * t166 + 0.4e1 / 0.9e1 * t716 * t521 + 0.8e1 / 0.3e1 * t42 * t272 - 0.8e1 * t719 * t681);
  t1723 = t197 * t1722;
  t1724 = t89 * t1723;
  t1726 = t320 * t530;
  t1728 = t320 * t543;
  t1730 = t542 * t45;
  t1731 = t1730 * t326;
  t1732 = t96 * t1731;
  t1734 = t729 * t740;
  t1735 = t96 * t1734;
  t1736 = t1481 * t323;
  t1739 = t534 * t34;
  t1750 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1736 * t535 - 0.16e2 / 0.9e1 * t1739 * t272 * t173 + 0.4e1 / 0.9e1 * t733 * t538 - 0.8e1 / 0.3e1 * t54 * t272 + 0.8e1 * t736 * t681);
  t1751 = t201 * t1750;
  t1752 = t96 * t1751;
  t1754 = 0.44e2 / 0.9e1 * t1696 - 0.8e1 / 0.3e1 * t1698 - 0.8e1 / 0.3e1 * t1700 + t1704 / 0.2e1 + t1707 + t1724 / 0.2e1 - 0.4e1 / 0.3e1 * t1726 - 0.4e1 / 0.3e1 * t1728 + t1732 / 0.2e1 + t1735 + t1752 / 0.2e1 + t1568;
  t1758 = -t1428 + t1688 - t1432 + t1689 - t1436 - 0.7e1 / 0.18e2 * t1440 + t1691 + 0.2e1 * t1692 + 0.5e1 / 0.3e1 * t354 * t551 + t136 * t1754 + 0.11e2 / 0.3e1 * t243 * t744;
  t1774 = t1722 * t46;
  t1779 = t1750 * t46;
  t1782 = 0.7e1 / 0.9e1 * t597 * t365 - 0.2e1 / 0.3e1 * t162 * t762 + t33 * t1774 / 0.4e1 - t370 * t605 / 0.3e1 + t51 * t1779 / 0.4e1;
  t1793 = 0.11e2 / 0.6e1 * t358 * t551 + t139 * t1754 + 0.4e1 * t247 * t744 + 0.2e1 * t362 * t551 + 0.1e2 / 0.9e1 * t581 * t348 + 0.55e2 / 0.36e2 * t584 * t348 + t30 * t1782 / 0.2e1 + 0.4e1 / 0.3e1 * t253 * t770 + 0.2e1 / 0.3e1 * t379 * t608 + t64 * t1782 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t770;
  t1821 = 0.22e2 / 0.9e1 * t1696 - 0.4e1 / 0.3e1 * t1698 - 0.4e1 / 0.3e1 * t1700 + t1704 / 0.4e1 + t1707 / 0.2e1 + t1724 / 0.4e1 - 0.2e1 / 0.3e1 * t1726 - 0.2e1 / 0.3e1 * t1728 + t1732 / 0.4e1 + t1735 / 0.2e1 + t1752 / 0.4e1;
  t1830 = 0.3e1 / 0.4e1 * t385 * t608 + t68 * t1782 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t770 + 0.5e1 / 0.6e1 * t390 * t608 + t81 * t1782 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t770 + 0.11e2 / 0.12e2 * t395 * t608 + t85 * t1821 / 0.2e1 + 0.3e1 / 0.2e1 * t208 * t802 + 0.3e1 / 0.4e1 * t400 * t631 + t105 * t1821 / 0.2e1;
  t1851 = 0.5e1 / 0.3e1 * t213 * t802 + 0.5e1 / 0.6e1 * t333 * t631 + t110 * t1821 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t802 + 0.11e2 / 0.12e2 * t338 * t631 + t115 * t1821 / 0.2e1 + 0.2e1 * t223 * t802 + t343 * t631 + t119 * t1754 + 0.3e1 * t235 * t744 + 0.3e1 / 0.2e1 * t350 * t551;
  t1856 = t404 * t144;
  t1858 = t407 * t144;
  t1860 = t410 * t144;
  t1862 = t413 * t144;
  t1874 = t133 * t1754 + 0.1e2 / 0.3e1 * t239 * t744 + 0.7e1 / 0.3e1 * t1856 + 0.8e1 / 0.3e1 * t1858 + 0.3e1 * t1860 + 0.1e2 / 0.3e1 * t1862 + 0.2e1 / 0.9e1 * t555 * t376 + 0.3e1 / 0.8e1 * t558 * t376 + 0.5e1 / 0.9e1 * t561 * t376 + 0.55e2 / 0.72e2 * t565 * t376 + 0.3e1 / 0.8e1 * t568 * t330;
  t1881 = 0.4e1 * t1583;
  t1882 = 0.4e1 * t1585;
  t1883 = 0.4e1 * t1587;
  t1888 = 0.4e1 * t1631;
  t1889 = 0.5e1 / 0.9e1 * t571 * t330 + 0.55e2 / 0.72e2 * t574 * t330 + 0.3e1 / 0.4e1 * t578 * t348 + t1881 + t1882 + t1883 - 0.14e2 / 0.3e1 * t1622 - 0.16e2 / 0.3e1 * t1624 - 0.6e1 * t1626 - 0.2e2 / 0.3e1 * t1628 + t1888;
  tv3rho31 = t1675 + t1686 + t1758 + t1793 + t1830 + t1851 + t1874 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1892 = t1006 * t165;
  t1894 = t1006 * t273;
  t1896 = t1009 * t165;
  t1898 = t1009 * t273;
  t1900 = t1012 * t165;
  t1902 = t1012 * t273;
  t1904 = t1015 * t165;
  t1906 = t1015 * t273;
  t1911 = 0.7e1 / 0.18e2 * t1892 - 0.7e1 / 0.18e2 * t1894 + 0.8e1 / 0.9e1 * t1896 - 0.8e1 / 0.9e1 * t1898 + 0.3e1 / 0.2e1 * t1900 - 0.3e1 / 0.2e1 * t1902 + 0.2e2 / 0.9e1 * t1904 - 0.2e2 / 0.9e1 * t1906 + 0.14e2 * t1658 + 0.16e2 * t1662 + 0.18e2 * t1666;
  t1921 = 0.2e2 * t1670 + 0.28e2 / 0.3e1 * t1376 + 0.7e1 * t1378 + 0.32e2 / 0.3e1 * t1387 + 0.8e1 * t1389 + 0.12e2 * t1400 + 0.9e1 * t1402 + 0.4e2 / 0.3e1 * t1411 + 0.1e2 * t1413 - t1684 - t1422;
  t1926 = t1464 * t867;
  t1931 = t515 * t871;
  t1936 = -0.2e1 * t272 - 0.6e1 * t1415;
  t1940 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1926 * t166 + 0.16e2 / 0.9e1 * t716 * t519 + 0.4e1 / 0.9e1 * t1931 * t166 + 0.4e1 / 0.3e1 * t42 * t1936);
  t1941 = t1940 * t46;
  t1948 = t1481 * t886;
  t1953 = t534 * t889;
  t1956 = -t1936;
  t1960 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1948 * t173 - 0.16e2 / 0.9e1 * t733 * t519 + 0.4e1 / 0.9e1 * t1953 * t173 + 0.4e1 / 0.3e1 * t54 * t1956);
  t1961 = t1960 * t46;
  t1964 = -t162 * t876 / 0.3e1 + t33 * t1941 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t177 - 0.2e1 / 0.3e1 * t370 * t767 + t51 * t1961 / 0.4e1;
  t1971 = -t1685 - t1428 - t1688 - t1432 - t1689 - t1436 + t1442 + 0.2e1 * t1444 + t30 * t1964 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t897 + 0.4e1 / 0.3e1 * t379 * t770;
  t1990 = t194 * t915;
  t1992 = t1240 * t723;
  t1993 = t89 * t1992;
  t1995 = t194 * t918;
  t1997 = t712 * t875;
  t1998 = t89 * t1997;
  t2000 = t197 * t1940;
  t2001 = t89 * t2000;
  t2003 = t924 * t202;
  t2005 = t320 * t730;
  t2007 = t320 * t741;
  t2009 = t1318 * t740;
  t2010 = t96 * t2009;
  t2012 = t729 * t893;
  t2013 = t96 * t2012;
  t2015 = t201 * t1960;
  t2016 = t96 * t2015;
  t2018 = -0.2e1 / 0.3e1 * t1990 + t1993 / 0.2e1 - 0.2e1 / 0.3e1 * t1995 + t1998 / 0.4e1 + t2001 / 0.4e1 + 0.22e2 / 0.9e1 * t2003 - 0.4e1 / 0.3e1 * t2005 - 0.4e1 / 0.3e1 * t2007 + t2010 / 0.2e1 + t2013 / 0.4e1 + t2016 / 0.4e1;
  t2023 = t64 * t1964 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t897 + 0.3e1 / 0.2e1 * t385 * t770 + t68 * t1964 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t897 + 0.5e1 / 0.3e1 * t390 * t770 + t81 * t1964 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t897 + 0.11e2 / 0.6e1 * t395 * t770 + t85 * t2018 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t936;
  t2054 = -0.4e1 / 0.3e1 * t1990 + t1993 - 0.4e1 / 0.3e1 * t1995 + t1998 / 0.2e1 + t2001 / 0.2e1 + 0.44e2 / 0.9e1 * t2003 - 0.8e1 / 0.3e1 * t2005 - 0.8e1 / 0.3e1 * t2007 + t2010 + t2013 / 0.2e1 + t2016 / 0.2e1 + t1568;
  t2056 = 0.3e1 / 0.2e1 * t400 * t802 + t105 * t2018 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t936 + 0.5e1 / 0.3e1 * t333 * t802 + t110 * t2018 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t936 + 0.11e2 / 0.6e1 * t338 * t802 + t115 * t2018 / 0.2e1 + t223 * t936 + 0.2e1 * t343 * t802 + t119 * t2054;
  t2076 = 0.3e1 / 0.2e1 * t235 * t960 + 0.3e1 * t350 * t744 + t133 * t2054 + 0.5e1 / 0.3e1 * t239 * t960 + 0.1e2 / 0.3e1 * t354 * t744 + t136 * t2054 + 0.11e2 / 0.6e1 * t243 * t960 + 0.11e2 / 0.3e1 * t358 * t744 + t139 * t2054 + 0.2e1 * t247 * t960 + 0.4e1 * t362 * t744;
  t2099 = 0.2e1 / 0.9e1 * t973 * t180 + 0.3e1 / 0.8e1 * t976 * t180 + 0.5e1 / 0.9e1 * t981 * t180 + 0.55e2 / 0.72e2 * t985 * t180 + 0.3e1 / 0.8e1 * t988 * t205 + 0.5e1 / 0.9e1 * t991 * t205 + 0.55e2 / 0.72e2 * t994 * t205 + 0.3e1 / 0.4e1 * t997 * t233 + 0.1e2 / 0.9e1 * t1000 * t233 + 0.55e2 / 0.36e2 * t1003 * t233 - 0.14e2 / 0.3e1 * t1856;
  t2107 = -0.16e2 / 0.3e1 * t1858 - 0.6e1 * t1860 - 0.2e2 / 0.3e1 * t1862 + t1881 + t1882 + t1883 + 0.7e1 / 0.3e1 * t1622 + 0.8e1 / 0.3e1 * t1624 + 0.3e1 * t1626 + 0.1e2 / 0.3e1 * t1628 + t1888;
  tv3rho32 = t1911 + t1921 + t1971 + t2023 + t2056 + t2076 + t2099 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2114 = 0.1e1 / t19;
  t2119 = t141 * t1343;
  t2122 = t147 * t1347;
  t2125 = t150 * t2114;
  t2128 = t153 * t50;
  t2145 = -0.8e1 / 0.3e1 * t1896 - 0.8e1 / 0.3e1 * t1898 - 0.9e1 / 0.2e1 * t1900 - 0.9e1 / 0.2e1 * t1902 - 0.2e2 / 0.3e1 * t1904 - 0.2e2 / 0.3e1 * t1906 + 0.28e2 * t1656 + 0.21e2 * t1658 + 0.32e2 * t1660 + 0.24e2 * t1662 + 0.36e2 * t1664;
  t2150 = 0.27e2 * t1666 + 0.4e2 * t1668 + 0.3e2 * t1670 - t1417 - t1422 - t1424 - t1428 - t1430 - t1432 - t1434 - t1436;
  t2153 = t867 * t310;
  t2159 = -0.6e1 * t272 - 0.6e1 * t1415;
  t2163 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1464 * t2153 + 0.4e1 / 0.3e1 * t716 * t871 + 0.4e1 / 0.3e1 * t42 * t2159);
  t2164 = t2163 * t46;
  t2168 = 0.1e1 / t11 / t921;
  t2169 = t49 * t2168;
  t2175 = t886 * t323;
  t2180 = -t2159;
  t2184 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1481 * t2175 + 0.4e1 / 0.3e1 * t733 * t889 + 0.4e1 / 0.3e1 * t54 * t2180);
  t2185 = t2184 * t46;
  t2188 = t33 * t2164 / 0.4e1 - 0.7e2 / 0.27e2 * t2169 * t57 + 0.7e1 / 0.3e1 * t881 * t373 - t370 * t894 + t51 * t2185 / 0.4e1;
  t2205 = t1240 * t875;
  t2206 = t89 * t2205;
  t2208 = t197 * t2163;
  t2209 = t89 * t2208;
  t2211 = t921 * rho[1];
  t2213 = 0.1e1 / t25 / t2211;
  t2214 = sigma[2] * t2213;
  t2215 = t2214 * t98;
  t2217 = t924 * t327;
  t2219 = t320 * t930;
  t2221 = t320 * t933;
  t2223 = t1318 * t893;
  t2224 = t96 * t2223;
  t2226 = t201 * t2184;
  t2227 = t96 * t2226;
  t2229 = 0.3e1 / 0.4e1 * t2206 + t2209 / 0.4e1 - 0.154e3 / 0.27e2 * t2215 + 0.22e2 / 0.3e1 * t2217 - 0.2e1 * t2219 - 0.2e1 * t2221 + 0.3e1 / 0.4e1 * t2224 + t2227 / 0.4e1;
  t2232 = 0.3e1 * t1691 + 0.6e1 * t1692 + t30 * t2188 / 0.2e1 + 0.2e1 * t379 * t897 + t64 * t2188 / 0.2e1 + 0.9e1 / 0.4e1 * t385 * t897 + t68 * t2188 / 0.2e1 + 0.5e1 / 0.2e1 * t390 * t897 + t81 * t2188 / 0.2e1 + 0.11e2 / 0.4e1 * t395 * t897 + t85 * t2229 / 0.2e1;
  t2257 = 0.3e1 / 0.2e1 * t2206 + t2209 / 0.2e1 - 0.308e3 / 0.27e2 * t2215 + 0.44e2 / 0.3e1 * t2217 - 0.4e1 * t2219 - 0.4e1 * t2221 + 0.3e1 / 0.2e1 * t2224 + t2227 / 0.2e1 + t1568;
  t2271 = t29 * t1347;
  t2274 = t63 * t2114;
  t2277 = t67 * t50;
  t2280 = 0.1e1 / t5;
  t2281 = t71 * t2280;
  t2284 = t84 * t2114;
  t2287 = t104 * t50;
  t2290 = 0.5e1 * t354 * t960 + t136 * t2257 + 0.11e2 / 0.2e1 * t358 * t960 + t139 * t2257 + 0.6e1 * t362 * t960 - 0.4e1 / 0.27e2 * t2271 * t60 - 0.3e1 / 0.16e2 * t2274 * t60 - 0.5e1 / 0.27e2 * t2277 * t60 - 0.55e2 / 0.432e3 * t2281 * t60 - 0.3e1 / 0.16e2 * t2284 * t101 - 0.5e1 / 0.27e2 * t2287 * t101;
  t2292 = t109 * t2280;
  t2295 = t118 * t2114;
  t2298 = t132 * t50;
  t2301 = t135 * t2280;
  t2318 = -0.55e2 / 0.432e3 * t2292 * t101 - 0.3e1 / 0.8e1 * t2295 * t130 - 0.1e2 / 0.27e2 * t2298 * t130 - 0.55e2 / 0.216e3 * t2301 * t130 + 0.2e1 / 0.3e1 * t973 * t376 + 0.9e1 / 0.8e1 * t976 * t376 + 0.5e1 / 0.3e1 * t981 * t376 + 0.55e2 / 0.24e2 * t985 * t376 + 0.9e1 / 0.8e1 * t988 * t330 + 0.5e1 / 0.3e1 * t991 * t330 + 0.55e2 / 0.24e2 * t994 * t330;
  t2329 = 0.9e1 / 0.4e1 * t997 * t348 + 0.1e2 / 0.3e1 * t1000 * t348 + 0.55e2 / 0.12e2 * t1003 * t348 + 0.7e1 * t1856 + 0.8e1 * t1858 + 0.9e1 * t1860 + 0.1e2 * t1862 - t1584 - t1586 - t1588 - t1632;
  tv3rho33 = t2329 + t2318 + t2290 - 0.7e1 / 0.6e1 * t1892 - 0.7e1 / 0.6e1 * t1894 + t2232 + t2150 + t2145 + 0.9e1 / 0.4e1 * t400 * t936 + t105 * t2229 / 0.2e1 + 0.5e1 / 0.2e1 * t333 * t936 + t110 * t2229 / 0.2e1 + 0.11e2 / 0.4e1 * t338 * t936 + t115 * t2229 / 0.2e1 + 0.3e1 * t343 * t936 + t119 * t2257 + 0.9e1 / 0.2e1 * t350 * t960 + t133 * t2257 - 0.8e1 / 0.27e2 * t2122 * t145 - 0.3e1 / 0.8e1 * t2125 * t145 - 0.1e2 / 0.27e2 * t2128 * t145 - 0.35e2 / 0.216e3 * t1 * t1343 - 0.8e1 / 0.27e2 * t8 * t1347 - 0.3e1 / 0.8e1 * t15 * t2114 - 0.1e2 / 0.27e2 * t22 * t50 - 0.35e2 / 0.216e3 * t2119 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2333 = 0.2e1 * t138 * t444;
  t2336 = t84 / t2 / t191;
  t2339 = 0.1e1 / t191;
  t2340 = t104 * t2339;
  t2344 = 0.1e1 / t74 / t86;
  t2345 = t109 * t2344;
  t2348 = t113 * t88;
  t2349 = t2348 * t91;
  t2351 = t105 * t193;
  t2356 = t110 * t193;
  t2361 = t115 * t193;
  t2367 = t161 * t169 * t46;
  t2373 = t32 * t525 * t46;
  t2376 = t2333 - 0.29e2 / 0.64e2 * t2336 * t91 - 0.35e2 / 0.72e2 * t2340 * t91 - 0.33e2 / 0.64e2 * t2345 * t91 - 0.13e2 / 0.24e2 * t2349 - 0.2e1 / 0.3e1 * t2351 * t198 + t1029 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2356 * t198 + t1032 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2361 * t198 + t1035 * t526 / 0.8e1 - t419 * t2367 / 0.6e1 - t424 * t2367 / 0.6e1 + t419 * t2373 / 0.16e2;
  t2383 = t85 * t193;
  t2397 = t504 * t90 * t45;
  t2399 = t193 * t44;
  t2403 = t88 * t510 * t45;
  t2407 = 0.88e2 / 0.9e1 * t548;
  t2408 = 0.22e2 / 0.9e1 * t2397 - 0.8e1 / 0.3e1 * t2399 * t712 + t2403 / 0.2e1 + t1064 * t1702 / 0.2e1 - t2407;
  t2416 = t424 * t2373 / 0.16e2 + t427 * t2373 / 0.16e2 + t430 * t2373 / 0.16e2 - 0.2e1 / 0.3e1 * t2383 * t198 + t1119 * t526 / 0.8e1 + 0.4e1 * t247 * t1068 + 0.1e2 / 0.9e1 * t581 * t444 + 0.55e2 / 0.36e2 * t584 * t444 + 0.3e1 / 0.4e1 * t578 * t444 + t119 * t2408 + 0.3e1 * t235 * t1068 + t133 * t2408 + 0.1e2 / 0.3e1 * t239 * t1068 + t136 * t2408;
  t2426 = t596 * t44 * t46;
  t2436 = t418 * t169 * t46;
  t2439 = t67 * t1095;
  t2442 = t71 * t1391;
  t2445 = t29 * t1087;
  t2448 = t63 * t1091;
  t2453 = 0.11e2 / 0.3e1 * t243 * t1068 + t139 * t2408 - t427 * t2367 / 0.6e1 - t430 * t2367 / 0.6e1 + 0.7e1 / 0.36e2 * t427 * t2426 + 0.7e1 / 0.36e2 * t430 * t2426 + 0.7e1 / 0.36e2 * t419 * t2426 + 0.7e1 / 0.36e2 * t424 * t2426 + 0.11e2 / 0.48e2 * t1043 * t2436 - 0.5e1 / 0.24e2 * t2439 * t1040 - 0.121e3 / 0.576e3 * t2442 * t1040 - 0.7e1 / 0.36e2 * t2445 * t1040 - 0.13e2 / 0.64e2 * t2448 * t1040 + 0.3e1 / 0.8e1 * t1084 * t198;
  t2482 = 0.5e1 / 0.12e2 * t1088 * t198 + 0.11e2 / 0.24e2 * t1092 * t198 + t1096 * t198 / 0.2e1 + t1057 * t2436 / 0.6e1 + 0.3e1 / 0.16e2 * t1060 * t2436 + 0.5e1 / 0.24e2 * t1038 * t2436 + t105 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2397 + t110 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2397 + t115 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2397 + t85 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2397;
  tv3rho2sigma0 = t2376 + t2416 + t2453 + t2482;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t235 * t230;
  t2489 = 0.176e3 / 0.9e1 * t119 * t548;
  t2492 = t239 * t230;
  t2495 = 0.176e3 / 0.9e1 * t133 * t548;
  t2498 = t243 * t230;
  t2501 = 0.176e3 / 0.9e1 * t136 * t548;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t247 * t230;
  t2507 = 0.176e3 / 0.9e1 * t139 * t548;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t578 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t581 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t584 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2509 = 0.2e1 * t138 * t480;
  t2510 = t113 * t95;
  t2511 = t2510 * t98;
  t2516 = t95 * t529 * t45;
  t2520 = t2516 / 0.2e1 + t1184 * t1730 / 0.2e1 - t2407;
  t2539 = t223 * t95;
  t2547 = t50 * t542 * t46;
  t2554 = t2509 + t2511 / 0.8e1 + 0.4e1 * t247 * t1187 + t139 * t2520 + 0.3e1 / 0.4e1 * t578 * t480 + 0.1e2 / 0.9e1 * t581 * t480 + 0.55e2 / 0.36e2 * t584 * t480 + 0.3e1 * t235 * t1187 + t119 * t2520 + 0.1e2 / 0.3e1 * t239 * t1187 + t133 * t2520 + 0.11e2 / 0.3e1 * t243 * t1187 + t136 * t2520 + t1174 * t543 / 0.8e1 + t2539 * t202 / 0.2e1 + t1179 * t543 / 0.8e1 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2547 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + t466 * t2547 / 0.16e2;
  t2555 = t208 * t95;
  t2560 = t213 * t95;
  t2565 = t218 * t95;
  t2576 = t561 * t454;
  t2579 = t565 * t454;
  t2582 = t555 * t454;
  t2585 = t558 * t454;
  t2602 = 0.3e1 / 0.8e1 * t2555 * t202 + t1163 * t543 / 0.8e1 + 0.5e1 / 0.12e2 * t2560 * t202 + t1168 * t543 / 0.8e1 + 0.11e2 / 0.24e2 * t2565 * t202 + t1139 * t1143 / 0.6e1 + t455 * t2547 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2547 / 0.16e2 + 0.5e1 / 0.72e2 * t2576 * t457 + 0.55e2 / 0.576e3 * t2579 * t457 + t2582 * t457 / 0.36e2 + 0.3e1 / 0.64e2 * t2585 * t457 + t110 * t2516 / 0.8e1 + t115 * t2516 / 0.8e1 + 0.3e1 / 0.64e2 * t568 * t470 + t85 * t2516 / 0.8e1 + 0.5e1 / 0.72e2 * t571 * t470 + t105 * t2516 / 0.8e1 + 0.55e2 / 0.576e3 * t574 * t470;
  tv3rho2sigma2 = t2554 + t2602;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2607 = t88 * t169;
  t2610 = t45 * t723;
  t2613 = -0.4e1 / 0.3e1 * t2399 * t1240 + t2607 * t1240 / 0.2e1 + t1064 * t2610 / 0.2e1 - t2407;
  t2633 = t32 * t723 * t46;
  t2638 = 0.3e1 / 0.2e1 * t350 * t1068 + t119 * t2613 + 0.3e1 / 0.2e1 * t235 * t1243 + 0.5e1 / 0.3e1 * t354 * t1068 + t133 * t2613 + 0.5e1 / 0.3e1 * t239 * t1243 + 0.11e2 / 0.6e1 * t358 * t1068 + t136 * t2613 + 0.11e2 / 0.6e1 * t243 * t1243 + 0.2e1 * t362 * t1068 + t139 * t2613 + 0.2e1 * t247 * t1243 + t424 * t2633 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1110;
  t2645 = t400 * t88;
  t2652 = t333 * t88;
  t2659 = t338 * t88;
  t2669 = t161 * t313 * t46;
  t2672 = t427 * t2633 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t1110 + t430 * t2633 / 0.16e2 + 0.3e1 / 0.16e2 * t2645 * t198 + t1119 * t713 / 0.8e1 + t1119 * t724 / 0.8e1 + 0.5e1 / 0.24e2 * t2652 * t198 + t1029 * t713 / 0.8e1 + t1029 * t724 / 0.8e1 + 0.11e2 / 0.48e2 * t2659 * t198 + t1199 * t1110 / 0.12e2 + t419 * t2633 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1110 - t430 * t2669 / 0.12e2;
  t2700 = t343 * t88;
  t2703 = -t2383 * t314 / 0.3e1 - t2351 * t314 / 0.3e1 - t2356 * t314 / 0.3e1 - t2361 * t314 / 0.3e1 - t1199 * t1100 / 0.9e1 - t419 * t2669 / 0.12e2 - t1206 * t1100 / 0.8e1 - t424 * t2669 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1100 - t427 * t2669 / 0.12e2 - 0.11e2 / 0.72e2 * t1216 * t1100 + t1032 * t713 / 0.8e1 + t1032 * t724 / 0.8e1 + t2700 * t198 / 0.4e1;
  t2725 = t418 * t313 * t46;
  t2734 = t1035 * t713 / 0.8e1 + t1035 * t724 / 0.8e1 - t343 * t1047 / 0.3e1 - t400 * t1047 / 0.4e1 - 0.5e1 / 0.18e2 * t333 * t1047 - 0.11e2 / 0.36e2 * t338 * t1047 + 0.3e1 / 0.16e2 * t1084 * t314 + 0.5e1 / 0.24e2 * t1088 * t314 + 0.11e2 / 0.48e2 * t1092 * t314 + t1096 * t314 / 0.4e1 + t1057 * t2725 / 0.12e2 + 0.3e1 / 0.32e2 * t1060 * t2725 + 0.5e1 / 0.48e2 * t1038 * t2725 + 0.11e2 / 0.96e2 * t1043 * t2725;
  tv3rho2sigma3 = t2638 + t2672 + t2703 + t2734;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t350 * t230;
  t2739 = t354 * t230;
  t2742 = t358 * t230;
  t2745 = t362 * t230;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2748 = t319 * t56;
  t2751 = t95 * t176;
  t2754 = t45 * t740;
  t2757 = -0.4e1 / 0.3e1 * t2748 * t729 + t2751 * t1318 / 0.2e1 + t1184 * t2754 / 0.2e1 - t2407;
  t2782 = t119 * t2757 + 0.3e1 / 0.2e1 * t235 * t1321 + 0.3e1 / 0.2e1 * t350 * t1187 + t133 * t2757 + t136 * t2757 + 0.5e1 / 0.3e1 * t239 * t1321 + 0.5e1 / 0.3e1 * t354 * t1187 + 0.11e2 / 0.6e1 * t243 * t1321 + 0.11e2 / 0.6e1 * t358 * t1187 + t139 * t2757 + 0.2e1 * t247 * t1321 + 0.2e1 * t362 * t1187 + t1174 * t730 / 0.8e1 + t1174 * t741 / 0.8e1;
  t2785 = t115 * t319;
  t2795 = t369 * t176 * t46;
  t2811 = t50 * t740 * t46;
  t2816 = 0.11e2 / 0.48e2 * t2565 * t327 - t2785 * t202 / 0.3e1 + t1179 * t730 / 0.8e1 + t1179 * t741 / 0.8e1 + t2539 * t327 / 0.4e1 - t455 * t2795 / 0.12e2 - t1139 * t1282 / 0.9e1 - t460 * t2795 / 0.12e2 - t1146 * t1282 / 0.8e1 - t463 * t2795 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1282 - t466 * t2795 / 0.12e2 + t460 * t2811 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1264;
  t2826 = t85 * t319;
  t2835 = t105 * t319;
  t2844 = t110 * t319;
  t2849 = t463 * t2811 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1264 + t466 * t2811 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t1264 - t2826 * t202 / 0.3e1 + t1163 * t730 / 0.8e1 + t1163 * t741 / 0.8e1 + 0.3e1 / 0.16e2 * t2555 * t327 - t2835 * t202 / 0.3e1 + t1168 * t730 / 0.8e1 + t1168 * t741 / 0.8e1 + 0.5e1 / 0.24e2 * t2560 * t327 - t2844 * t202 / 0.3e1 + t455 * t2811 / 0.16e2;
  t2863 = t454 * t176 * t46;
  t2880 = t1139 * t1264 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1282 + 0.3e1 / 0.16e2 * t1336 * t202 + 0.5e1 / 0.24e2 * t1340 * t202 + 0.11e2 / 0.48e2 * t1344 * t202 + t1348 * t202 / 0.4e1 + t1303 * t2863 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t2863 + 0.5e1 / 0.48e2 * t1311 * t2863 + 0.11e2 / 0.96e2 * t1314 * t2863 - t208 * t1292 / 0.4e1 - 0.5e1 / 0.18e2 * t213 * t1292 - 0.11e2 / 0.36e2 * t218 * t1292 - t223 * t1292 / 0.3e1;
  tv3rho2sigma5 = t2782 + t2816 + t2849 + t2880;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2892 = t88 * t914 * t45;
  t2894 = t45 * t875;
  t2897 = t2892 / 0.2e1 + t1064 * t2894 / 0.2e1 - t2407;
  t2917 = t32 * t875 * t46;
  t2924 = t2333 + t2349 / 0.8e1 + 0.3e1 / 0.4e1 * t997 * t444 + 0.1e2 / 0.9e1 * t1000 * t444 + 0.55e2 / 0.36e2 * t1003 * t444 + 0.11e2 / 0.3e1 * t358 * t1243 + t136 * t2897 + 0.4e1 * t362 * t1243 + t139 * t2897 + 0.3e1 * t350 * t1243 + t119 * t2897 + 0.1e2 / 0.3e1 * t354 * t1243 + t133 * t2897 + 0.11e2 / 0.24e2 * t2659 * t314 + t1032 * t918 / 0.8e1 + t2700 * t314 / 0.2e1 + t1035 * t918 / 0.8e1 + t424 * t2917 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2917 / 0.16e2;
  t2943 = t973 * t418;
  t2946 = t976 * t418;
  t2949 = t981 * t418;
  t2952 = t985 * t418;
  t2969 = 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2917 / 0.16e2 + 0.3e1 / 0.8e1 * t2645 * t314 + t1119 * t918 / 0.8e1 + 0.5e1 / 0.12e2 * t2652 * t314 + t1029 * t918 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2917 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t2943 * t421 / 0.36e2 + 0.3e1 / 0.64e2 * t2946 * t421 + 0.5e1 / 0.72e2 * t2949 * t421 + 0.55e2 / 0.576e3 * t2952 * t421 + t110 * t2892 / 0.8e1 + t115 * t2892 / 0.8e1 + 0.3e1 / 0.64e2 * t988 * t434 + t85 * t2892 / 0.8e1 + 0.5e1 / 0.72e2 * t991 * t434 + t105 * t2892 / 0.8e1 + 0.55e2 / 0.576e3 * t994 * t434;
  tv3rho2sigma6 = t2924 + t2969;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t997 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t1000 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t1003 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2986 = t923 * t97 * t45;
  t2991 = t95 * t929 * t45;
  t2993 = t45 * t893;
  t2996 = 0.22e2 / 0.9e1 * t2986 - 0.8e1 / 0.3e1 * t2748 * t1318 + t2991 / 0.2e1 + t1184 * t2993 / 0.2e1 - t2407;
  t3011 = 0.1e1 / t317;
  t3012 = t104 * t3011;
  t3015 = t2509 - 0.13e2 / 0.24e2 * t2511 + 0.1e2 / 0.9e1 * t1000 * t480 + 0.55e2 / 0.36e2 * t1003 * t480 + t133 * t2996 + 0.1e2 / 0.3e1 * t354 * t1321 + t136 * t2996 + 0.11e2 / 0.3e1 * t358 * t1321 + t139 * t2996 + 0.4e1 * t362 * t1321 + t119 * t2996 + 0.3e1 * t350 * t1321 + 0.3e1 / 0.4e1 * t997 * t480 - 0.35e2 / 0.72e2 * t3012 * t98;
  t3017 = 0.1e1 / t78 / t93;
  t3018 = t109 * t3017;
  t3023 = t84 / t4 / t317;
  t3033 = t50 * t893 * t46;
  t3052 = -0.33e2 / 0.64e2 * t3018 * t98 - 0.29e2 / 0.64e2 * t3023 * t98 + t1174 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2785 * t327 + t1179 * t933 / 0.8e1 + t455 * t3033 / 0.16e2 + t460 * t3033 / 0.16e2 + t463 * t3033 / 0.16e2 + t466 * t3033 / 0.16e2 - 0.2e1 / 0.3e1 * t2826 * t327 + t1163 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2835 * t327 + t1168 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2844 * t327;
  t3055 = t880 * t56 * t46;
  t3065 = t369 * t326 * t46;
  t3082 = t29 * t1339;
  t3085 = t63 * t1343;
  t3088 = 0.7e1 / 0.36e2 * t455 * t3055 + 0.7e1 / 0.36e2 * t460 * t3055 + 0.7e1 / 0.36e2 * t463 * t3055 + 0.7e1 / 0.36e2 * t466 * t3055 - t455 * t3065 / 0.6e1 - t460 * t3065 / 0.6e1 - t463 * t3065 / 0.6e1 - t466 * t3065 / 0.6e1 + 0.3e1 / 0.8e1 * t1336 * t327 + 0.5e1 / 0.12e2 * t1340 * t327 + 0.11e2 / 0.24e2 * t1344 * t327 + t1348 * t327 / 0.2e1 - 0.7e1 / 0.36e2 * t3082 * t1305 - 0.13e2 / 0.64e2 * t3085 * t1305;
  t3089 = t67 * t1347;
  t3092 = t71 * t2114;
  t3096 = t454 * t326 * t46;
  t3121 = -0.5e1 / 0.24e2 * t3089 * t1305 - 0.121e3 / 0.576e3 * t3092 * t1305 + t1303 * t3096 / 0.6e1 + 0.3e1 / 0.16e2 * t1308 * t3096 + 0.5e1 / 0.24e2 * t1311 * t3096 + 0.11e2 / 0.48e2 * t1314 * t3096 + t110 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2986 + t115 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2986 + t85 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2986 + t105 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2986;
  tv3rho2sigma8 = t3015 + t3052 + t3088 + t3121;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1057 * t3124 / 0.24e2 + t1354 * t1100 / 0.24e2 - t1354 * t1110 / 0.32e2 - 0.3e1 / 0.64e2 * t1060 * t3124 + t1356 * t1100 / 0.24e2 - t1356 * t1110 / 0.32e2 - 0.5e1 / 0.96e2 * t1038 * t3124 + t1358 * t1100 / 0.24e2 - t1358 * t1110 / 0.32e2 - 0.11e2 / 0.192e3 * t1043 * t3124 + t1360 * t1100 / 0.24e2 - t1360 * t1110 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t253 * t1364;
  t3154 = t258 * t1364;
  t3159 = t183 * t1364;
  t3164 = t188 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t379 * t1353;
  t3174 = t385 * t1353;
  t3179 = t390 * t1353;
  t3184 = t395 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1303 * t3190 / 0.24e2 + t1365 * t1282 / 0.24e2 - t1365 * t1264 / 0.32e2 - 0.3e1 / 0.64e2 * t1308 * t3190 + t1367 * t1282 / 0.24e2 - t1367 * t1264 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t3190 + t1369 * t1282 / 0.24e2 - t1369 * t1264 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t3190 + t1371 * t1282 / 0.24e2 - t1371 * t1264 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t161, t162, t165, t166, t169, t170, t173, t176;
  double t177, t180, t183, t188, t191, t193, t194, t195;
  double t197, t198, t199, t201, t202, t203, t205, t208;
  double t213, t218, t223, t228, t230, t232, t233, t235;
  double t239, t243, t247, t250, t253, t258, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t314, t315, t317, t319, t320, t321, t323, t326;
  double t327, t328, t330, t333, t338, t343, t348, t350;
  double t354, t358, t362, t365, t369, t370, t373, t376;
  double t379, t382, t385, t390, t395, t400, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t486, t487, t488, t491, t494, t497, t502, t504;
  double t505, t506, t508, t510, t511, t512, t514, t515;
  double t516, t519, t521, t525, t526, t527, t529, t530;
  double t531, t533, t534, t535, t538, t542, t543, t544;
  double t546, t548, t550, t551, t555, t558, t561, t564;
  double t565, t568, t571, t574, t577, t578, t581, t584;
  double t588, t590, t592, t594, t596, t597, t602, t605;
  double t608, t631, t634, t657, t660, t662, t664, t667;
  double t668, t670, t672, t675, t677, t680, t681, t682;
  double t684, t686, t688, t690, t692, t694, t696, t697;
  double t700, t702, t704, tv2rho20, t710, t712, t713, t714;
  double t716, t719, t723, t724, t725, t727, t729, t730;
  double t731, t733, t736, t740, t741, t742, t744, t762;
  double t767, t770, t779, t802, t817, t828, t830, t832;
  double t834, t836, t838, t839, t841, t843, t853, tv2rho21;
  double t855, t858, t861, t864, t867, t871, t875, t876;
  double t880, t881, t886, t889, t893, t894, t897, t914;
  double t915, t916, t918, t919, t921, t923, t924, t925;
  double t927, t929, t930, t931, t933, t934, t936, t941;
  double t960, t973, t976, t979, t981, t984, t985, t988;
  double t991, t994, t997, t1000, t1003, t1006, t1009, t1012;
  double t1015, t1018, t1027, tv2rho22, t1029, t1032, t1035, t1038;
  double t1040, t1043, t1047, t1057, t1060, t1064, t1067, t1068;
  double t1076, t1083, t1084, t1087, t1088, t1091, t1092, t1095;
  double t1096, t1100, t1110, t1119, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1282, t1292, t1301;
  double t1303, t1305, t1308, t1311, t1314, t1318, t1321, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1374, t1376, t1378, t1380, t1383, t1385, t1387, t1389;
  double t1391, t1392, t1395, t1398, t1400, t1402, t1404, t1407;
  double t1409, t1411, t1413, t1415, t1416, t1417, t1418, t1419;
  double t1420, t1422, t1423, t1424, t1425, t1428, t1429, t1430;
  double t1432, t1433, t1434, t1436, t1437, t1440, t1442, t1444;
  double t1450, t1456, t1457, t1464, t1465, t1468, t1472, t1476;
  double t1477, t1481, t1482, t1485, t1488, t1492, t1493, t1496;
  double t1513, t1515, t1516, t1517, t1519, t1521, t1523, t1525;
  double t1526, t1528, t1529, t1531, t1532, t1534, t1535, t1537;
  double t1540, t1566, t1568, t1569, t1583, t1584, t1585, t1586;
  double t1587, t1588, t1589, t1592, t1595, t1598, t1600, t1601;
  double t1604, t1607, t1610, t1613, t1616, t1619, t1622, t1624;
  double t1626, t1628, t1630, t1631, t1632, t1653, tv3rho30, t1656;
  double t1658, t1660, t1662, t1664, t1666, t1668, t1670, t1675;
  double t1684, t1685, t1686, t1688, t1689, t1691, t1692, t1696;
  double t1698, t1700, t1702, t1703, t1704, t1706, t1707, t1708;
  double t1711, t1722, t1723, t1724, t1726, t1728, t1730, t1731;
  double t1732, t1734, t1735, t1736, t1739, t1750, t1751, t1752;
  double t1754, t1758, t1774, t1779, t1782, t1793, t1821, t1830;
  double t1851, t1856, t1858, t1860, t1862, t1874, t1881, t1882;
  double t1883, t1888, t1889, tv3rho31, t1892, t1894, t1896, t1898;
  double t1900, t1902, t1904, t1906, t1911, t1921, t1926, t1931;
  double t1936, t1940, t1941, t1948, t1953, t1956, t1960, t1961;
  double t1964, t1971, t1990, t1992, t1993, t1995, t1997, t1998;
  double t2000, t2001, t2003, t2005, t2007, t2009, t2010, t2012;
  double t2013, t2015, t2016, t2018, t2023, t2054, t2056, t2076;
  double t2099, t2107, tv3rho32, t2114, t2119, t2122, t2125, t2128;
  double t2145, t2150, t2153, t2159, t2163, t2164, t2168, t2169;
  double t2175, t2180, t2184, t2185, t2188, t2205, t2206, t2208;
  double t2209, t2211, t2213, t2214, t2215, t2217, t2219, t2221;
  double t2223, t2224, t2226, t2227, t2229, t2232, t2257, t2271;
  double t2274, t2277, t2280, t2281, t2284, t2287, t2290, t2292;
  double t2295, t2298, t2301, t2318, t2329, tv3rho33, t2333, t2336;
  double t2339, t2340, t2344, t2345, t2348, t2349, t2351, t2356;
  double t2361, t2367, t2373, t2376, t2383, t2397, t2399, t2403;
  double t2407, t2408, t2416, t2426, t2436, t2439, t2442, t2445;
  double t2448, t2453, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2509, t2510;
  double t2511, t2516, t2520, t2539, t2547, t2554, t2555, t2560;
  double t2565, t2576, t2579, t2582, t2585, t2602, tv3rho2sigma2, t2607;
  double t2610, t2613, t2633, t2638, t2645, t2652, t2659, t2669;
  double t2672, t2700, t2703, t2725, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2748, t2751, t2754, t2757, t2782;
  double t2785, t2795, t2811, t2816, t2826, t2835, t2844, t2849;
  double t2863, t2880, tv3rho2sigma5, t2892, t2894, t2897, t2917, t2924;
  double t2943, t2946, t2949, t2952, t2969, tv3rho2sigma6, tv3rho2sigma7, t2986;
  double t2991, t2993, t2996, t3011, t3012, t3015, t3017, t3018;
  double t3023, t3033, t3052, t3055, t3065, t3082, t3085, t3088;
  double t3089, t3092, t3096, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  double t3239, t3241, t3248, t3267, t3278, t3280, t3282, t3284;
  double t3286, t3288, t3290, t3291, t3292, t3293, t3294, t3295;
  double t3296, t3298, t3299, t3330, t3332, t3334, t3339, t3341;
  double t3343, t3345, t3347, t3349, t3351, t3353, t3356, t3357;
  double t3359, t3360, t3366, t3371, t3373, t3377, t3379, t3381;
  double t3383, t3386, t3387, t3389, t3390, t3396, t3405, t3407;
  double t3409, t3426, t3430, t3431, t3461, t3470, t3499, t3510;
  double t3512, t3514, t3516, t3518, t3520, t3525, t3527, t3529;
  double t3531, t3533, t3535, t3537, t3539, t3540, t3541, t3542;
  double t3544, t3545, t3546, t3548, t3549, t3550, t3552, t3553;
  double t3554, t3556, t3560, t3561, t3563, t3568, t3570, t3572;
  double t3574, t3576, t3578, t3583, t3585, t3587, t3589, t3591;
  double tv4rho40, t3595, t3597, t3602, t3604, t3606, t3608, t3610;
  double t3612, t3615, t3618, t3644, t3646, t3648, t3650, t3652;
  double t3654, t3656, t3659, t3662, t3688, t3690, t3692, t3694;
  double t3696, t3698, t3716, t3733, t3767, t3772, t3800, t3827;
  double t3830, t3831, t3832, t3837, t3838, t3839, t3840, t3841;
  double t3842, t3843, t3844, t3845, t3848, t3857, t3858, t3859;
  double t3861, t3862, t3863, t3865, t3866, t3867, t3869, t3870;
  double t3871, t3874, t3877, t3882, t3884, t3885, t3886, t3887;
  double t3888, t3894, t3898, t3900, tv4rho41, t3904, t3905, t3911;
  double t3913, t3915, t3917, t3919, t3921, t3923, t3926, t3952;
  double t3954, t3956, t3958, t3961, t3963, t3965, t3966, t3968;
  double t3971, t3974, t4000, t4002, t4004, t4006, t4008, t4010;
  double t4011, t4025, t4044, t4083, t4092, t4122, t4127, t4129;
  double t4131, t4133, t4153, t4175, t4184, t4186, t4188, t4190;
  double t4192, t4196, t4204, t4206, t4208, t4215, t4227, tv4rho42;
  double t4230, t4232, t4234, t4236, t4238, t4240, t4242, t4244;
  double t4252, t4253, t4256, t4259, t4261, t4264, t4284, t4288;
  double t4290, t4292, t4294, t4296, t4298, t4300, t4302, t4305;
  double t4308, t4311, t4333, t4335, t4337, t4358, t4377, t4401;
  double t4422, t4451, t4476, t4482, t4492, t4496, tv4rho43, t4513;
  double t4518, t4524, t4528, t4543, t4548, t4557, t4561, t4564;
  double t4579, t4581, t4584, t4586, t4592, t4594, t4596, t4598;
  double t4600, t4602, t4604, t4606, t4609, t4611, t4613, t4628;
  double t4656, t4667, t4697, t4716, t4732, t4743, t4756, t4777;
  double tv4rho44, t4792, t4797, t4813, t4816, t4823, t4844, t4851;
  double t4856, t4868, t4877, t4880, t4888, t4896, t4905, t4920;
  double t4924, t4927, t4959, t4969, t4970, t4987, tv4rho3sigma0, t4992;
  double t4994, t4997, t5000, t5002, t5005, t5008, t5010, t5013;
  double t5014, t5015, t5016, t5019, tv4rho3sigma1, t5028, t5043, t5048;
  double t5053, t5062, t5079, t5083, t5110, t5112, t5125, t5142;
  double tv4rho3sigma2, t5153, t5170, t5195, t5197, t5211, t5224, t5225;
  double t5237, t5251, t5256, t5283, t5286, t5294, t5308, t5313;
  double t5333, t5351, t5353, t5377, tv4rho3sigma3, t5380, t5384, t5388;
  double t5392, t5394, tv4rho3sigma4, t5405, t5420, t5422, t5429, t5436;
  double t5440, t5451, t5459, t5476, t5499, t5502, t5517, t5528;
  double t5535, t5553, t5559, t5570, t5578, t5593, t5610, tv4rho3sigma5;
  double t5616, t5632, t5639, t5652, t5665, t5676, t5691, t5715;
  double t5720, t5741, t5744, t5757, t5768, t5787, t5796, t5800;
  double t5822, tv4rho3sigma6, t5825, t5829, t5833, tv4rho3sigma7, t5852, t5865;
  double t5892, t5900, t5905, t5919, t5928, t5946, t5949, t5967;
  double t5978, t5987, t6004, t6007, t6028, t6036, t6043, t6047;
  double t6071, tv4rho3sigma8, t6100, t6132, t6143, t6161, t6167, t6192;
  double tv4rho3sigma9, tv4rho3sigma10, t6220, t6230, t6234, t6253, t6270, t6282;
  double t6298, t6307, t6329, t6348, t6388, t6405, tv4rho3sigma11, t6409;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t6483, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6521, tv4rho2sigma211, tv4rho2sigma212, tv4rho2sigma213;
  double tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t6615, tv4rho2sigma217, t6633, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t6699, tv4rhosigma319, t6726, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, t6738, tv4sigma414;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = 0.1e1 / t9 / t86;
  t162 = t31 * t161;
  t165 = t34 * t144;
  t166 = t36 - t165;
  t169 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t166);
  t170 = t169 * t46;
  t173 = -t166;
  t176 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t173);
  t177 = t176 * t46;
  t180 = -t162 * t47 / 0.3e1 + t33 * t170 / 0.4e1 + t51 * t177 / 0.4e1;
  t183 = t67 * t23;
  t188 = t71 * t74;
  t191 = t86 * rho[0];
  t193 = 0.1e1 / t23 / t191;
  t194 = sigma[0] * t193;
  t195 = t194 * t91;
  t197 = t44 * t45;
  t198 = t197 * t169;
  t199 = t89 * t198;
  t201 = t56 * t45;
  t202 = t201 * t176;
  t203 = t96 * t202;
  t205 = -t195 / 0.3e1 + t199 / 0.4e1 + t203 / 0.4e1;
  t208 = t84 * t16;
  t213 = t104 * t23;
  t218 = t109 * t74;
  t223 = t113 * rho[0];
  t228 = t124 * t35;
  t230 = 0.1e1 / t126 / t228;
  t232 = 0.8e1 / 0.3e1 * t123 * t230;
  t233 = -0.2e1 / 0.3e1 * t195 + t199 / 0.2e1 + t203 / 0.2e1 + t232;
  t235 = t118 * t16;
  t239 = t132 * t23;
  t243 = t135 * t74;
  t247 = t138 * rho[0];
  t250 = t68 * t180 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t60 + t81 * t180 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t60 + t85 * t205 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t101 + t105 * t205 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t101 + t110 * t205 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t101 + t115 * t205 / 0.2e1 + t223 * t101 + t119 * t233 + 0.3e1 / 0.2e1 * t235 * t130 + t133 * t233 + 0.5e1 / 0.3e1 * t239 * t130 + t136 * t233 + 0.11e2 / 0.6e1 * t243 * t130 + t139 * t233 + 0.2e1 * t247 * t130;
  t253 = t29 * t9;
  t258 = t63 * t16;
  t270 = 0.2e1 * t142 * t165;
  t272 = 0.1e1 / t228;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t165;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t165;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t165;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t250 + t30 * t180 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t60 + t64 * t180 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t60 + t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = -t36 - t165;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t197 * t313;
  t315 = t89 * t314;
  t317 = t93 * rho[1];
  t319 = 0.1e1 / t25 / t317;
  t320 = sigma[2] * t319;
  t321 = t320 * t98;
  t323 = -t310;
  t326 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t323);
  t327 = t201 * t326;
  t328 = t96 * t327;
  t330 = t315 / 0.4e1 - t321 / 0.3e1 + t328 / 0.4e1;
  t333 = t104 * t25;
  t338 = t109 * t78;
  t343 = t113 * rho[1];
  t348 = t315 / 0.2e1 - 0.2e1 / 0.3e1 * t321 + t328 / 0.2e1 + t232;
  t350 = t118 * t18;
  t354 = t132 * t25;
  t358 = t135 * t78;
  t362 = t138 * rho[1];
  t365 = t313 * t46;
  t369 = 0.1e1 / t11 / t93;
  t370 = t49 * t369;
  t373 = t326 * t46;
  t376 = t33 * t365 / 0.4e1 - t370 * t57 / 0.3e1 + t51 * t373 / 0.4e1;
  t379 = t29 * t11;
  t382 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t105 * t330 / 0.2e1 + 0.5e1 / 0.6e1 * t333 * t101 + t110 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t338 * t101 + t115 * t330 / 0.2e1 + t343 * t101 + t119 * t348 + 0.3e1 / 0.2e1 * t350 * t130 + t133 * t348 + 0.5e1 / 0.3e1 * t354 * t130 + t136 * t348 + 0.11e2 / 0.6e1 * t358 * t130 + t139 * t348 + 0.2e1 * t362 * t130 + t30 * t376 / 0.2e1 + 0.2e1 / 0.3e1 * t379 * t60;
  t385 = t63 * t18;
  t390 = t67 * t25;
  t395 = t71 * t78;
  t400 = t84 * t18;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t382 + t64 * t376 / 0.2e1 + 0.3e1 / 0.4e1 * t385 * t60 + t68 * t376 / 0.2e1 + 0.5e1 / 0.6e1 * t390 * t60 + t81 * t376 / 0.2e1 + 0.11e2 / 0.12e2 * t395 * t60 + t85 * t330 / 0.2e1 + 0.3e1 / 0.4e1 * t400 * t101 + t156 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t486 = 0.2e1 * t138 * t130;
  t487 = t113 * t101;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t502 = t86 * t86;
  t504 = 0.1e1 / t23 / t502;
  t505 = sigma[0] * t504;
  t506 = t505 * t91;
  t508 = t194 * t198;
  t510 = t169 * t169;
  t511 = t510 * t45;
  t512 = t89 * t511;
  t514 = t42 * t42;
  t515 = 0.1e1 / t514;
  t516 = t166 * t166;
  t519 = t34 * t272;
  t521 = -0.2e1 * t144 + 0.2e1 * t519;
  t525 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t516 + 0.4e1 / 0.3e1 * t42 * t521);
  t526 = t197 * t525;
  t527 = t89 * t526;
  t529 = t176 * t176;
  t530 = t529 * t45;
  t531 = t96 * t530;
  t533 = t54 * t54;
  t534 = 0.1e1 / t533;
  t535 = t173 * t173;
  t538 = -t521;
  t542 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t535 + 0.4e1 / 0.3e1 * t54 * t538);
  t543 = t201 * t542;
  t544 = t96 * t543;
  t546 = t124 * t124;
  t548 = 0.1e1 / t126 / t546;
  t550 = 0.88e2 / 0.9e1 * t123 * t548;
  t551 = 0.22e2 / 0.9e1 * t506 - 0.8e1 / 0.3e1 * t508 + t512 / 0.2e1 + t527 / 0.2e1 + t531 / 0.2e1 + t544 / 0.2e1 - t550;
  t555 = t29 * t491;
  t558 = t63 * t494;
  t561 = t67 * t497;
  t564 = 0.1e1 / t2;
  t565 = t71 * t564;
  t568 = t84 * t494;
  t571 = t104 * t497;
  t574 = t109 * t564;
  t577 = t486 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.1e2 / 0.9e1 * t22 * t497 + 0.11e2 / 0.3e1 * t243 * t233 + t139 * t551 + 0.4e1 * t247 * t233 + 0.2e1 / 0.9e1 * t555 * t60 + 0.3e1 / 0.8e1 * t558 * t60 + 0.5e1 / 0.9e1 * t561 * t60 + 0.55e2 / 0.72e2 * t565 * t60 + 0.3e1 / 0.8e1 * t568 * t101 + 0.5e1 / 0.9e1 * t571 * t101 + 0.55e2 / 0.72e2 * t574 * t101;
  t578 = t118 * t494;
  t581 = t132 * t497;
  t584 = t135 * t564;
  t588 = 0.2e1 * t142 * t144;
  t590 = 0.2e1 * t148 * t144;
  t592 = 0.2e1 * t151 * t144;
  t594 = 0.2e1 * t154 * t144;
  t596 = 0.1e1 / t9 / t191;
  t597 = t31 * t596;
  t602 = t525 * t46;
  t605 = t542 * t46;
  t608 = 0.7e1 / 0.9e1 * t597 * t47 - 0.2e1 / 0.3e1 * t162 * t170 + t33 * t602 / 0.4e1 + t51 * t605 / 0.4e1;
  t631 = 0.11e2 / 0.9e1 * t506 - 0.4e1 / 0.3e1 * t508 + t512 / 0.4e1 + t527 / 0.4e1 + t531 / 0.4e1 + t544 / 0.4e1;
  t634 = 0.3e1 / 0.4e1 * t578 * t130 + 0.1e2 / 0.9e1 * t581 * t130 + 0.55e2 / 0.36e2 * t584 * t130 + t588 + t590 + t592 + t594 + t30 * t608 / 0.2e1 + 0.4e1 / 0.3e1 * t253 * t180 + t64 * t608 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t180 + t68 * t608 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t180 + t81 * t608 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t180 + t85 * t631 / 0.2e1;
  t657 = t147 * t491;
  t660 = t291 * t165;
  t662 = t291 * t273;
  t664 = t150 * t494;
  t667 = 0.3e1 / 0.2e1 * t208 * t205 + t105 * t631 / 0.2e1 + 0.5e1 / 0.3e1 * t213 * t205 + t110 * t631 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t205 + t115 * t631 / 0.2e1 + 0.2e1 * t223 * t205 + t119 * t551 + 0.3e1 * t235 * t233 + t133 * t551 + 0.1e2 / 0.3e1 * t239 * t233 + t136 * t551 + 0.4e1 / 0.9e1 * t657 * t145 + 0.16e2 / 0.3e1 * t660 - 0.16e2 / 0.3e1 * t662 + 0.3e1 / 0.4e1 * t664 * t145;
  t668 = t294 * t165;
  t670 = t294 * t273;
  t672 = t153 * t497;
  t675 = t297 * t165;
  t677 = t297 * t273;
  t680 = 0.8e1 * t142 * t519;
  t681 = 0.1e1 / t546;
  t682 = t143 * t681;
  t684 = 0.6e1 * t142 * t682;
  t686 = 0.8e1 * t148 * t519;
  t688 = 0.6e1 * t148 * t682;
  t690 = 0.8e1 * t151 * t519;
  t692 = 0.6e1 * t151 * t682;
  t694 = 0.8e1 * t154 * t519;
  t696 = 0.6e1 * t154 * t682;
  t697 = t141 * t488;
  t700 = t288 * t165;
  t702 = t288 * t273;
  t704 = 0.6e1 * t668 - 0.6e1 * t670 + 0.1e2 / 0.9e1 * t672 * t145 + 0.2e2 / 0.3e1 * t675 - 0.2e2 / 0.3e1 * t677 - t680 + t684 - t686 + t688 - t690 + t692 - t694 + t696 + 0.7e1 / 0.36e2 * t697 * t145 + 0.14e2 / 0.3e1 * t700 - 0.14e2 / 0.3e1 * t702;
  tv2rho20 = t577 + t634 + t667 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t710 = t194 * t314;
  t712 = t169 * t45;
  t713 = t712 * t313;
  t714 = t89 * t713;
  t716 = t515 * t310;
  t719 = t42 * t34;
  t723 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t716 * t166 + 0.8e1 / 0.3e1 * t719 * t272);
  t724 = t197 * t723;
  t725 = t89 * t724;
  t727 = t320 * t202;
  t729 = t176 * t45;
  t730 = t729 * t326;
  t731 = t96 * t730;
  t733 = t534 * t323;
  t736 = t54 * t34;
  t740 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t733 * t173 - 0.8e1 / 0.3e1 * t736 * t272);
  t741 = t201 * t740;
  t742 = t96 * t741;
  t744 = -0.4e1 / 0.3e1 * t710 + t714 / 0.2e1 + t725 / 0.2e1 - 0.4e1 / 0.3e1 * t727 + t731 / 0.2e1 + t742 / 0.2e1 - t550;
  t762 = t723 * t46;
  t767 = t740 * t46;
  t770 = -t162 * t365 / 0.3e1 + t33 * t762 / 0.4e1 - t370 * t177 / 0.3e1 + t51 * t767 / 0.4e1;
  t779 = 0.3e1 / 0.2e1 * t235 * t348 + 0.3e1 / 0.2e1 * t350 * t233 + t133 * t744 + 0.5e1 / 0.3e1 * t239 * t348 + 0.5e1 / 0.3e1 * t354 * t233 + t136 * t744 + 0.11e2 / 0.6e1 * t243 * t348 + 0.11e2 / 0.6e1 * t358 * t233 + t139 * t744 + 0.2e1 * t247 * t348 + 0.2e1 * t362 * t233 + t30 * t770 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t376 + 0.2e1 / 0.3e1 * t379 * t180 + t64 * t770 / 0.2e1;
  t802 = -0.2e1 / 0.3e1 * t710 + t714 / 0.4e1 + t725 / 0.4e1 - 0.2e1 / 0.3e1 * t727 + t731 / 0.4e1 + t742 / 0.4e1;
  t817 = 0.3e1 / 0.4e1 * t258 * t376 + 0.3e1 / 0.4e1 * t385 * t180 + t68 * t770 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t376 + 0.5e1 / 0.6e1 * t390 * t180 + t81 * t770 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t376 + 0.11e2 / 0.12e2 * t395 * t180 + t85 * t802 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t330 + 0.3e1 / 0.4e1 * t400 * t205 + t105 * t802 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t330 + 0.5e1 / 0.6e1 * t333 * t205 + t110 * t802 / 0.2e1;
  t828 = t404 * t165;
  t830 = t404 * t273;
  t832 = t407 * t165;
  t834 = t407 * t273;
  t836 = t410 * t165;
  t838 = 0.11e2 / 0.12e2 * t218 * t330 + 0.11e2 / 0.12e2 * t338 * t205 + t115 * t802 / 0.2e1 + t223 * t330 + t343 * t205 + t119 * t744 - t588 - t590 - t592 - t594 + 0.7e1 / 0.3e1 * t828 - 0.7e1 / 0.3e1 * t830 + 0.8e1 / 0.3e1 * t832 - 0.8e1 / 0.3e1 * t834 + 0.3e1 * t836;
  t839 = t410 * t273;
  t841 = t413 * t165;
  t843 = t413 * t273;
  t853 = -0.3e1 * t839 + 0.1e2 / 0.3e1 * t841 - 0.1e2 / 0.3e1 * t843 - 0.8e1 / 0.3e1 * t660 - 0.8e1 / 0.3e1 * t662 - 0.3e1 * t668 - 0.3e1 * t670 - 0.1e2 / 0.3e1 * t675 - 0.1e2 / 0.3e1 * t677 + t684 + t688 + t692 + t696 - 0.7e1 / 0.3e1 * t700 - 0.7e1 / 0.3e1 * t702;
  tv2rho21 = t779 + t817 + t838 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = t310 * t310;
  t871 = 0.2e1 * t144 + 0.2e1 * t519;
  t875 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t515 * t867 + 0.4e1 / 0.3e1 * t42 * t871);
  t876 = t875 * t46;
  t880 = 0.1e1 / t11 / t317;
  t881 = t49 * t880;
  t886 = t323 * t323;
  t889 = -t871;
  t893 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t534 * t886 + 0.4e1 / 0.3e1 * t54 * t889);
  t894 = t893 * t46;
  t897 = t33 * t876 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t57 - 0.2e1 / 0.3e1 * t370 * t373 + t51 * t894 / 0.4e1;
  t914 = t313 * t313;
  t915 = t914 * t45;
  t916 = t89 * t915;
  t918 = t197 * t875;
  t919 = t89 * t918;
  t921 = t93 * t93;
  t923 = 0.1e1 / t25 / t921;
  t924 = sigma[2] * t923;
  t925 = t924 * t98;
  t927 = t320 * t327;
  t929 = t326 * t326;
  t930 = t929 * t45;
  t931 = t96 * t930;
  t933 = t201 * t893;
  t934 = t96 * t933;
  t936 = t916 / 0.4e1 + t919 / 0.4e1 + 0.11e2 / 0.9e1 * t925 - 0.4e1 / 0.3e1 * t927 + t931 / 0.4e1 + t934 / 0.4e1;
  t941 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.1e2 / 0.9e1 * t22 * t864 + t486 + t487 + t30 * t897 / 0.2e1 + 0.4e1 / 0.3e1 * t379 * t376 + t64 * t897 / 0.2e1 + 0.3e1 / 0.2e1 * t385 * t376 + t68 * t897 / 0.2e1 + 0.5e1 / 0.3e1 * t390 * t376 + t81 * t897 / 0.2e1 + 0.11e2 / 0.6e1 * t395 * t376 + t85 * t936 / 0.2e1 + 0.3e1 / 0.2e1 * t400 * t330;
  t960 = t916 / 0.2e1 + t919 / 0.2e1 + 0.22e2 / 0.9e1 * t925 - 0.8e1 / 0.3e1 * t927 + t931 / 0.2e1 + t934 / 0.2e1 - t550;
  t973 = t29 * t858;
  t976 = t63 * t861;
  t979 = t105 * t936 / 0.2e1 + 0.5e1 / 0.3e1 * t333 * t330 + t110 * t936 / 0.2e1 + 0.11e2 / 0.6e1 * t338 * t330 + t115 * t936 / 0.2e1 + 0.2e1 * t343 * t330 + t119 * t960 + 0.3e1 * t350 * t348 + t133 * t960 + 0.1e2 / 0.3e1 * t354 * t348 + t136 * t960 + 0.11e2 / 0.3e1 * t358 * t348 + t139 * t960 + 0.4e1 * t362 * t348 + 0.2e1 / 0.9e1 * t973 * t60 + 0.3e1 / 0.8e1 * t976 * t60;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t109 * t984;
  t997 = t118 * t861;
  t1000 = t132 * t864;
  t1003 = t135 * t984;
  t1006 = t141 * t855;
  t1009 = t147 * t858;
  t1012 = t150 * t861;
  t1015 = t153 * t864;
  t1018 = 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101 + 0.55e2 / 0.72e2 * t994 * t101 + 0.3e1 / 0.4e1 * t997 * t130 + 0.1e2 / 0.9e1 * t1000 * t130 + 0.55e2 / 0.36e2 * t1003 * t130 + t588 + t590 + t592 + t594 + 0.7e1 / 0.36e2 * t1006 * t145 + 0.4e1 / 0.9e1 * t1009 * t145 + 0.3e1 / 0.4e1 * t1012 * t145 + 0.1e2 / 0.9e1 * t1015 * t145;
  t1027 = -0.14e2 / 0.3e1 * t828 - 0.14e2 / 0.3e1 * t830 - 0.16e2 / 0.3e1 * t832 - 0.16e2 / 0.3e1 * t834 - 0.6e1 * t836 - 0.6e1 * t839 - 0.2e2 / 0.3e1 * t841 - 0.2e2 / 0.3e1 * t843 + t680 + t684 + t686 + t688 + t690 + t692 + t694 + t696;
  tv2rho22 = t941 + t979 + t1018 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1029 = t105 * t88;
  t1032 = t110 * t88;
  t1035 = t115 * t88;
  t1038 = t67 * t491;
  t1040 = t418 * t44 * t46;
  t1043 = t71 * t494;
  t1047 = t193 * t90 * t45;
  t1057 = t29 / rho[0];
  t1060 = t63 * t488;
  t1064 = t88 * t44;
  t1067 = 0.8e1 / 0.3e1 * t230;
  t1068 = -0.2e1 / 0.3e1 * t1047 + t1064 * t712 / 0.2e1 + t1067;
  t1076 = t1029 * t198 / 0.8e1 + t1032 * t198 / 0.8e1 + t1035 * t198 / 0.8e1 + 0.5e1 / 0.48e2 * t1038 * t1040 + 0.11e2 / 0.96e2 * t1043 * t1040 - t85 * t1047 / 0.6e1 - t105 * t1047 / 0.6e1 - t110 * t1047 / 0.6e1 - t115 * t1047 / 0.6e1 + t1057 * t1040 / 0.12e2 + 0.3e1 / 0.32e2 * t1060 * t1040 + t119 * t1068 + 0.3e1 / 0.2e1 * t235 * t444 + t133 * t1068 + 0.5e1 / 0.3e1 * t239 * t444 + t136 * t1068;
  t1083 = 0.1e1 / t2 / t86;
  t1084 = t84 * t1083;
  t1087 = 0.1e1 / t86;
  t1088 = t104 * t1087;
  t1091 = 0.1e1 / t75;
  t1092 = t109 * t1091;
  t1095 = 0.1e1 / t24;
  t1096 = t113 * t1095;
  t1100 = t161 * t44 * t46;
  t1110 = t32 * t169 * t46;
  t1119 = t85 * t88;
  t1122 = 0.11e2 / 0.6e1 * t243 * t444 + t139 * t1068 + 0.2e1 * t247 * t444 + 0.3e1 / 0.32e2 * t1084 * t91 + 0.5e1 / 0.48e2 * t1088 * t91 + 0.11e2 / 0.96e2 * t1092 * t91 + t1096 * t91 / 0.8e1 - t427 * t1100 / 0.12e2 - t430 * t1100 / 0.12e2 - t419 * t1100 / 0.12e2 - t424 * t1100 / 0.12e2 + t419 * t1110 / 0.16e2 + t424 * t1110 / 0.16e2 + t427 * t1110 / 0.16e2 + t430 * t1110 / 0.16e2 + t1119 * t198 / 0.8e1;
  tv2rhosigma0 = t1076 + t1122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t230;
  t1130 = 0.16e2 / 0.3e1 * t133 * t230;
  t1134 = 0.16e2 / 0.3e1 * t136 * t230;
  t1138 = 0.16e2 / 0.3e1 * t139 * t230;
  tv2rhosigma1 = -0.3e1 * t235 * t128 + t1126 - 0.1e2 / 0.3e1 * t239 * t128 + t1130 - 0.11e2 / 0.3e1 * t243 * t128 + t1134 - 0.4e1 * t247 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t253 * t454;
  t1143 = t50 * t176 * t46;
  t1146 = t258 * t454;
  t1151 = t183 * t454;
  t1156 = t188 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t208 * t470 + t1163 * t202 / 0.8e1 + 0.5e1 / 0.48e2 * t213 * t470 + t1168 * t202 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t729 / 0.2e1 + t1067;
  t1198 = 0.11e2 / 0.96e2 * t218 * t470 + t1174 * t202 / 0.8e1 + t223 * t470 / 0.8e1 + t1179 * t202 / 0.8e1 + 0.3e1 / 0.2e1 * t235 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t239 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t243 * t480 + t136 * t1187 + 0.2e1 * t247 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t379 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t385 * t418;
  t1211 = t390 * t418;
  t1216 = t395 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t400 * t434 + t1119 * t314 / 0.8e1 + 0.5e1 / 0.48e2 * t333 * t434 + t1029 * t314 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1064 * t1240 / 0.2e1 + t1067;
  t1254 = 0.11e2 / 0.96e2 * t338 * t434 + t1032 * t314 / 0.8e1 + t343 * t434 / 0.8e1 + t1035 * t314 / 0.8e1 + 0.3e1 / 0.2e1 * t350 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t354 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t358 * t444 + t136 * t1243 + 0.2e1 * t362 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t350 * t128 + t1126 - 0.1e2 / 0.3e1 * t354 * t128 + t1130 - 0.11e2 / 0.3e1 * t358 * t128 + t1134 - 0.4e1 * t362 * t128 + t1138;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t50 * t326 * t46;
  t1282 = t369 * t56 * t46;
  t1292 = t319 * t97 * t45;
  t1301 = t455 * t1264 / 0.16e2 + t460 * t1264 / 0.16e2 + t463 * t1264 / 0.16e2 + t466 * t1264 / 0.16e2 + t1163 * t327 / 0.8e1 + t1168 * t327 / 0.8e1 + t1174 * t327 / 0.8e1 + t1179 * t327 / 0.8e1 - t455 * t1282 / 0.12e2 - t460 * t1282 / 0.12e2 - t463 * t1282 / 0.12e2 - t466 * t1282 / 0.12e2 - t85 * t1292 / 0.6e1 - t105 * t1292 / 0.6e1 - t110 * t1292 / 0.6e1 - t115 * t1292 / 0.6e1;
  t1303 = t29 / rho[1];
  t1305 = t454 * t56 * t46;
  t1308 = t63 * t855;
  t1311 = t67 * t858;
  t1314 = t71 * t861;
  t1318 = t45 * t326;
  t1321 = -0.2e1 / 0.3e1 * t1292 + t1184 * t1318 / 0.2e1 + t1067;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = t1303 * t1305 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t1305 + 0.5e1 / 0.48e2 * t1311 * t1305 + 0.11e2 / 0.96e2 * t1314 * t1305 + t119 * t1321 + 0.3e1 / 0.2e1 * t350 * t480 + t133 * t1321 + 0.5e1 / 0.3e1 * t354 * t480 + t136 * t1321 + 0.11e2 / 0.6e1 * t358 * t480 + t139 * t1321 + 0.2e1 * t362 * t480 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  tv2rhosigma5 = t1301 + t1351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1374 = t697 * t273;
  t1376 = t288 * t519;
  t1378 = t288 * t682;
  t1380 = t147 * t1095;
  t1383 = t657 * t165;
  t1385 = t657 * t273;
  t1387 = t291 * t519;
  t1389 = t291 * t682;
  t1391 = 0.1e1 / t17;
  t1392 = t150 * t1391;
  t1395 = t664 * t165;
  t1398 = t664 * t273;
  t1400 = t294 * t519;
  t1402 = t294 * t682;
  t1404 = t153 * t32;
  t1407 = t672 * t165;
  t1409 = t672 * t273;
  t1411 = t297 * t519;
  t1413 = t297 * t682;
  t1415 = t34 * t681;
  t1416 = t142 * t1415;
  t1417 = 0.36e2 * t1416;
  t1418 = t546 * t35;
  t1419 = 0.1e1 / t1418;
  t1420 = t143 * t1419;
  t1422 = 0.24e2 * t142 * t1420;
  t1423 = t148 * t1415;
  t1424 = 0.36e2 * t1423;
  t1425 = -0.9e1 / 0.2e1 * t1398 - 0.36e2 * t1400 + 0.27e2 * t1402 - 0.1e2 / 0.27e2 * t1404 * t145 + 0.2e2 / 0.3e1 * t1407 - 0.2e2 / 0.3e1 * t1409 - 0.4e2 * t1411 + 0.3e2 * t1413 + t1417 - t1422 + t1424;
  t1428 = 0.24e2 * t148 * t1420;
  t1429 = t151 * t1415;
  t1430 = 0.36e2 * t1429;
  t1432 = 0.24e2 * t151 * t1420;
  t1433 = t154 * t1415;
  t1434 = 0.36e2 * t1433;
  t1436 = 0.24e2 * t154 * t1420;
  t1437 = t141 * t1091;
  t1440 = t697 * t165;
  t1442 = t113 * t205;
  t1444 = t138 * t233;
  t1450 = -t1428 + t1430 - t1432 + t1434 - t1436 - 0.35e2 / 0.216e3 * t1437 * t145 + 0.7e1 / 0.6e1 * t1440 + 0.3e1 * t1442 + 0.6e1 * t1444 - 0.35e2 / 0.216e3 * t1 * t1091 - 0.8e1 / 0.27e2 * t8 * t1095;
  t1456 = 0.1e1 / t9 / t502;
  t1457 = t31 * t1456;
  t1464 = 0.1e1 / t514 / t38;
  t1465 = t516 * t166;
  t1468 = t515 * t166;
  t1472 = 0.6e1 * t272 - 0.6e1 * t1415;
  t1476 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1464 * t1465 + 0.4e1 / 0.3e1 * t1468 * t521 + 0.4e1 / 0.3e1 * t42 * t1472);
  t1477 = t1476 * t46;
  t1481 = 0.1e1 / t533 / t52;
  t1482 = t535 * t173;
  t1485 = t534 * t173;
  t1488 = -t1472;
  t1492 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1481 * t1482 + 0.4e1 / 0.3e1 * t1485 * t538 + 0.4e1 / 0.3e1 * t54 * t1488);
  t1493 = t1492 * t46;
  t1496 = -0.7e2 / 0.27e2 * t1457 * t47 + 0.7e1 / 0.3e1 * t597 * t170 - t162 * t602 + t33 * t1477 / 0.4e1 + t51 * t1493 / 0.4e1;
  t1513 = t502 * rho[0];
  t1515 = 0.1e1 / t23 / t1513;
  t1516 = sigma[0] * t1515;
  t1517 = t1516 * t91;
  t1519 = t505 * t198;
  t1521 = t194 * t511;
  t1523 = t194 * t526;
  t1525 = t712 * t525;
  t1526 = t89 * t1525;
  t1528 = t197 * t1476;
  t1529 = t89 * t1528;
  t1531 = t729 * t542;
  t1532 = t96 * t1531;
  t1534 = t201 * t1492;
  t1535 = t96 * t1534;
  t1537 = -0.154e3 / 0.27e2 * t1517 + 0.22e2 / 0.3e1 * t1519 - 0.2e1 * t1521 - 0.2e1 * t1523 + 0.3e1 / 0.4e1 * t1526 + t1529 / 0.4e1 + 0.3e1 / 0.4e1 * t1532 + t1535 / 0.4e1;
  t1540 = -0.3e1 / 0.8e1 * t15 * t1391 - 0.1e2 / 0.27e2 * t22 * t32 + t30 * t1496 / 0.2e1 + 0.2e1 * t253 * t608 + t64 * t1496 / 0.2e1 + 0.9e1 / 0.4e1 * t258 * t608 + t68 * t1496 / 0.2e1 + 0.5e1 / 0.2e1 * t183 * t608 + t81 * t1496 / 0.2e1 + 0.11e2 / 0.4e1 * t188 * t608 + t85 * t1537 / 0.2e1;
  t1566 = 0.1e1 / t126 / t1418;
  t1568 = 0.1232e4 / 0.27e2 * t123 * t1566;
  t1569 = -0.308e3 / 0.27e2 * t1517 + 0.44e2 / 0.3e1 * t1519 - 0.4e1 * t1521 - 0.4e1 * t1523 + 0.3e1 / 0.2e1 * t1526 + t1529 / 0.2e1 + 0.3e1 / 0.2e1 * t1532 + t1535 / 0.2e1 + t1568;
  t1583 = t148 * t272;
  t1584 = 0.12e2 * t1583;
  t1585 = t151 * t272;
  t1586 = 0.12e2 * t1585;
  t1587 = t154 * t272;
  t1588 = 0.12e2 * t1587;
  t1589 = t29 * t1095;
  t1592 = t63 * t1391;
  t1595 = t67 * t32;
  t1598 = 0.5e1 * t239 * t551 + t136 * t1569 + 0.11e2 / 0.2e1 * t243 * t551 + t139 * t1569 + 0.6e1 * t247 * t551 - t1584 - t1586 - t1588 - 0.4e1 / 0.27e2 * t1589 * t60 - 0.3e1 / 0.16e2 * t1592 * t60 - 0.5e1 / 0.27e2 * t1595 * t60;
  t1600 = 0.1e1 / t3;
  t1601 = t71 * t1600;
  t1604 = t84 * t1391;
  t1607 = t104 * t32;
  t1610 = t109 * t1600;
  t1613 = t118 * t1391;
  t1616 = t132 * t32;
  t1619 = t135 * t1600;
  t1622 = t288 * t144;
  t1624 = t291 * t144;
  t1626 = t294 * t144;
  t1628 = t297 * t144;
  t1630 = -0.55e2 / 0.432e3 * t1601 * t60 - 0.3e1 / 0.16e2 * t1604 * t101 - 0.5e1 / 0.27e2 * t1607 * t101 - 0.55e2 / 0.432e3 * t1610 * t101 - 0.3e1 / 0.8e1 * t1613 * t130 - 0.1e2 / 0.27e2 * t1616 * t130 - 0.55e2 / 0.216e3 * t1619 * t130 + 0.7e1 * t1622 + 0.8e1 * t1624 + 0.9e1 * t1626 + 0.1e2 * t1628;
  t1631 = t142 * t272;
  t1632 = 0.12e2 * t1631;
  t1653 = -t1632 + 0.2e1 / 0.3e1 * t555 * t180 + 0.9e1 / 0.8e1 * t558 * t180 + 0.5e1 / 0.3e1 * t561 * t180 + 0.55e2 / 0.24e2 * t565 * t180 + 0.9e1 / 0.8e1 * t568 * t205 + 0.5e1 / 0.3e1 * t571 * t205 + 0.55e2 / 0.24e2 * t574 * t205 + 0.9e1 / 0.4e1 * t578 * t233 + 0.1e2 / 0.3e1 * t581 * t233 + 0.55e2 / 0.12e2 * t584 * t233;
  tv3rho30 = t1653 + t1630 + t1598 + t1540 + t1450 + t1425 + 0.9e1 / 0.2e1 * t1395 - 0.32e2 * t1387 + 0.24e2 * t1389 + 0.8e1 / 0.3e1 * t1383 - 0.8e1 / 0.3e1 * t1385 + 0.21e2 * t1378 - 0.7e1 / 0.6e1 * t1374 - 0.28e2 * t1376 + 0.9e1 / 0.4e1 * t208 * t631 + t105 * t1537 / 0.2e1 + 0.5e1 / 0.2e1 * t213 * t631 + t110 * t1537 / 0.2e1 + 0.11e2 / 0.4e1 * t218 * t631 + t115 * t1537 / 0.2e1 + 0.3e1 * t223 * t631 + t119 * t1569 + 0.9e1 / 0.2e1 * t235 * t551 + t133 * t1569 - 0.8e1 / 0.27e2 * t1380 * t145 - 0.3e1 / 0.8e1 * t1392 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1656 = t404 * t519;
  t1658 = t404 * t682;
  t1660 = t407 * t519;
  t1662 = t407 * t682;
  t1664 = t410 * t519;
  t1666 = t410 * t682;
  t1668 = t413 * t519;
  t1670 = t413 * t682;
  t1675 = -0.28e2 / 0.3e1 * t1656 + 0.7e1 * t1658 - 0.32e2 / 0.3e1 * t1660 + 0.8e1 * t1662 - 0.12e2 * t1664 + 0.9e1 * t1666 - 0.4e2 / 0.3e1 * t1668 + 0.1e2 * t1670 - 0.7e1 / 0.18e2 * t1374 + 0.14e2 * t1378 - 0.8e1 / 0.9e1 * t1383;
  t1684 = 0.12e2 * t1416;
  t1685 = 0.12e2 * t1423;
  t1686 = -0.8e1 / 0.9e1 * t1385 + 0.16e2 * t1389 - 0.3e1 / 0.2e1 * t1395 - 0.3e1 / 0.2e1 * t1398 + 0.18e2 * t1402 - 0.2e2 / 0.9e1 * t1407 - 0.2e2 / 0.9e1 * t1409 + 0.2e2 * t1413 + t1684 - t1422 + t1685;
  t1688 = 0.12e2 * t1429;
  t1689 = 0.12e2 * t1433;
  t1691 = t113 * t330;
  t1692 = t138 * t348;
  t1696 = t505 * t314;
  t1698 = t194 * t713;
  t1700 = t194 * t724;
  t1702 = t525 * t45;
  t1703 = t1702 * t313;
  t1704 = t89 * t1703;
  t1706 = t712 * t723;
  t1707 = t89 * t1706;
  t1708 = t1464 * t310;
  t1711 = t515 * t34;
  t1722 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1708 * t516 + 0.16e2 / 0.9e1 * t1711 * t272 * t166 + 0.4e1 / 0.9e1 * t716 * t521 + 0.8e1 / 0.3e1 * t42 * t272 - 0.8e1 * t719 * t681);
  t1723 = t197 * t1722;
  t1724 = t89 * t1723;
  t1726 = t320 * t530;
  t1728 = t320 * t543;
  t1730 = t542 * t45;
  t1731 = t1730 * t326;
  t1732 = t96 * t1731;
  t1734 = t729 * t740;
  t1735 = t96 * t1734;
  t1736 = t1481 * t323;
  t1739 = t534 * t34;
  t1750 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1736 * t535 - 0.16e2 / 0.9e1 * t1739 * t272 * t173 + 0.4e1 / 0.9e1 * t733 * t538 - 0.8e1 / 0.3e1 * t54 * t272 + 0.8e1 * t736 * t681);
  t1751 = t201 * t1750;
  t1752 = t96 * t1751;
  t1754 = 0.44e2 / 0.9e1 * t1696 - 0.8e1 / 0.3e1 * t1698 - 0.8e1 / 0.3e1 * t1700 + t1704 / 0.2e1 + t1707 + t1724 / 0.2e1 - 0.4e1 / 0.3e1 * t1726 - 0.4e1 / 0.3e1 * t1728 + t1732 / 0.2e1 + t1735 + t1752 / 0.2e1 + t1568;
  t1758 = -t1428 + t1688 - t1432 + t1689 - t1436 - 0.7e1 / 0.18e2 * t1440 + t1691 + 0.2e1 * t1692 + 0.5e1 / 0.3e1 * t354 * t551 + t136 * t1754 + 0.11e2 / 0.3e1 * t243 * t744;
  t1774 = t1722 * t46;
  t1779 = t1750 * t46;
  t1782 = 0.7e1 / 0.9e1 * t597 * t365 - 0.2e1 / 0.3e1 * t162 * t762 + t33 * t1774 / 0.4e1 - t370 * t605 / 0.3e1 + t51 * t1779 / 0.4e1;
  t1793 = 0.11e2 / 0.6e1 * t358 * t551 + t139 * t1754 + 0.4e1 * t247 * t744 + 0.2e1 * t362 * t551 + 0.1e2 / 0.9e1 * t581 * t348 + 0.55e2 / 0.36e2 * t584 * t348 + t30 * t1782 / 0.2e1 + 0.4e1 / 0.3e1 * t253 * t770 + 0.2e1 / 0.3e1 * t379 * t608 + t64 * t1782 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t770;
  t1821 = 0.22e2 / 0.9e1 * t1696 - 0.4e1 / 0.3e1 * t1698 - 0.4e1 / 0.3e1 * t1700 + t1704 / 0.4e1 + t1707 / 0.2e1 + t1724 / 0.4e1 - 0.2e1 / 0.3e1 * t1726 - 0.2e1 / 0.3e1 * t1728 + t1732 / 0.4e1 + t1735 / 0.2e1 + t1752 / 0.4e1;
  t1830 = 0.3e1 / 0.4e1 * t385 * t608 + t68 * t1782 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t770 + 0.5e1 / 0.6e1 * t390 * t608 + t81 * t1782 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t770 + 0.11e2 / 0.12e2 * t395 * t608 + t85 * t1821 / 0.2e1 + 0.3e1 / 0.2e1 * t208 * t802 + 0.3e1 / 0.4e1 * t400 * t631 + t105 * t1821 / 0.2e1;
  t1851 = 0.5e1 / 0.3e1 * t213 * t802 + 0.5e1 / 0.6e1 * t333 * t631 + t110 * t1821 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t802 + 0.11e2 / 0.12e2 * t338 * t631 + t115 * t1821 / 0.2e1 + 0.2e1 * t223 * t802 + t343 * t631 + t119 * t1754 + 0.3e1 * t235 * t744 + 0.3e1 / 0.2e1 * t350 * t551;
  t1856 = t404 * t144;
  t1858 = t407 * t144;
  t1860 = t410 * t144;
  t1862 = t413 * t144;
  t1874 = t133 * t1754 + 0.1e2 / 0.3e1 * t239 * t744 + 0.7e1 / 0.3e1 * t1856 + 0.8e1 / 0.3e1 * t1858 + 0.3e1 * t1860 + 0.1e2 / 0.3e1 * t1862 + 0.2e1 / 0.9e1 * t555 * t376 + 0.3e1 / 0.8e1 * t558 * t376 + 0.5e1 / 0.9e1 * t561 * t376 + 0.55e2 / 0.72e2 * t565 * t376 + 0.3e1 / 0.8e1 * t568 * t330;
  t1881 = 0.4e1 * t1583;
  t1882 = 0.4e1 * t1585;
  t1883 = 0.4e1 * t1587;
  t1888 = 0.4e1 * t1631;
  t1889 = 0.5e1 / 0.9e1 * t571 * t330 + 0.55e2 / 0.72e2 * t574 * t330 + 0.3e1 / 0.4e1 * t578 * t348 + t1881 + t1882 + t1883 - 0.14e2 / 0.3e1 * t1622 - 0.16e2 / 0.3e1 * t1624 - 0.6e1 * t1626 - 0.2e2 / 0.3e1 * t1628 + t1888;
  tv3rho31 = t1675 + t1686 + t1758 + t1793 + t1830 + t1851 + t1874 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1892 = t1006 * t165;
  t1894 = t1006 * t273;
  t1896 = t1009 * t165;
  t1898 = t1009 * t273;
  t1900 = t1012 * t165;
  t1902 = t1012 * t273;
  t1904 = t1015 * t165;
  t1906 = t1015 * t273;
  t1911 = 0.7e1 / 0.18e2 * t1892 - 0.7e1 / 0.18e2 * t1894 + 0.8e1 / 0.9e1 * t1896 - 0.8e1 / 0.9e1 * t1898 + 0.3e1 / 0.2e1 * t1900 - 0.3e1 / 0.2e1 * t1902 + 0.2e2 / 0.9e1 * t1904 - 0.2e2 / 0.9e1 * t1906 + 0.14e2 * t1658 + 0.16e2 * t1662 + 0.18e2 * t1666;
  t1921 = 0.2e2 * t1670 + 0.28e2 / 0.3e1 * t1376 + 0.7e1 * t1378 + 0.32e2 / 0.3e1 * t1387 + 0.8e1 * t1389 + 0.12e2 * t1400 + 0.9e1 * t1402 + 0.4e2 / 0.3e1 * t1411 + 0.1e2 * t1413 - t1684 - t1422;
  t1926 = t1464 * t867;
  t1931 = t515 * t871;
  t1936 = -0.2e1 * t272 - 0.6e1 * t1415;
  t1940 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1926 * t166 + 0.16e2 / 0.9e1 * t716 * t519 + 0.4e1 / 0.9e1 * t1931 * t166 + 0.4e1 / 0.3e1 * t42 * t1936);
  t1941 = t1940 * t46;
  t1948 = t1481 * t886;
  t1953 = t534 * t889;
  t1956 = -t1936;
  t1960 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1948 * t173 - 0.16e2 / 0.9e1 * t733 * t519 + 0.4e1 / 0.9e1 * t1953 * t173 + 0.4e1 / 0.3e1 * t54 * t1956);
  t1961 = t1960 * t46;
  t1964 = -t162 * t876 / 0.3e1 + t33 * t1941 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t177 - 0.2e1 / 0.3e1 * t370 * t767 + t51 * t1961 / 0.4e1;
  t1971 = -t1685 - t1428 - t1688 - t1432 - t1689 - t1436 + t1442 + 0.2e1 * t1444 + t30 * t1964 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t897 + 0.4e1 / 0.3e1 * t379 * t770;
  t1990 = t194 * t915;
  t1992 = t1240 * t723;
  t1993 = t89 * t1992;
  t1995 = t194 * t918;
  t1997 = t712 * t875;
  t1998 = t89 * t1997;
  t2000 = t197 * t1940;
  t2001 = t89 * t2000;
  t2003 = t924 * t202;
  t2005 = t320 * t730;
  t2007 = t320 * t741;
  t2009 = t1318 * t740;
  t2010 = t96 * t2009;
  t2012 = t729 * t893;
  t2013 = t96 * t2012;
  t2015 = t201 * t1960;
  t2016 = t96 * t2015;
  t2018 = -0.2e1 / 0.3e1 * t1990 + t1993 / 0.2e1 - 0.2e1 / 0.3e1 * t1995 + t1998 / 0.4e1 + t2001 / 0.4e1 + 0.22e2 / 0.9e1 * t2003 - 0.4e1 / 0.3e1 * t2005 - 0.4e1 / 0.3e1 * t2007 + t2010 / 0.2e1 + t2013 / 0.4e1 + t2016 / 0.4e1;
  t2023 = t64 * t1964 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t897 + 0.3e1 / 0.2e1 * t385 * t770 + t68 * t1964 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t897 + 0.5e1 / 0.3e1 * t390 * t770 + t81 * t1964 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t897 + 0.11e2 / 0.6e1 * t395 * t770 + t85 * t2018 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t936;
  t2054 = -0.4e1 / 0.3e1 * t1990 + t1993 - 0.4e1 / 0.3e1 * t1995 + t1998 / 0.2e1 + t2001 / 0.2e1 + 0.44e2 / 0.9e1 * t2003 - 0.8e1 / 0.3e1 * t2005 - 0.8e1 / 0.3e1 * t2007 + t2010 + t2013 / 0.2e1 + t2016 / 0.2e1 + t1568;
  t2056 = 0.3e1 / 0.2e1 * t400 * t802 + t105 * t2018 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t936 + 0.5e1 / 0.3e1 * t333 * t802 + t110 * t2018 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t936 + 0.11e2 / 0.6e1 * t338 * t802 + t115 * t2018 / 0.2e1 + t223 * t936 + 0.2e1 * t343 * t802 + t119 * t2054;
  t2076 = 0.3e1 / 0.2e1 * t235 * t960 + 0.3e1 * t350 * t744 + t133 * t2054 + 0.5e1 / 0.3e1 * t239 * t960 + 0.1e2 / 0.3e1 * t354 * t744 + t136 * t2054 + 0.11e2 / 0.6e1 * t243 * t960 + 0.11e2 / 0.3e1 * t358 * t744 + t139 * t2054 + 0.2e1 * t247 * t960 + 0.4e1 * t362 * t744;
  t2099 = 0.2e1 / 0.9e1 * t973 * t180 + 0.3e1 / 0.8e1 * t976 * t180 + 0.5e1 / 0.9e1 * t981 * t180 + 0.55e2 / 0.72e2 * t985 * t180 + 0.3e1 / 0.8e1 * t988 * t205 + 0.5e1 / 0.9e1 * t991 * t205 + 0.55e2 / 0.72e2 * t994 * t205 + 0.3e1 / 0.4e1 * t997 * t233 + 0.1e2 / 0.9e1 * t1000 * t233 + 0.55e2 / 0.36e2 * t1003 * t233 - 0.14e2 / 0.3e1 * t1856;
  t2107 = -0.16e2 / 0.3e1 * t1858 - 0.6e1 * t1860 - 0.2e2 / 0.3e1 * t1862 + t1881 + t1882 + t1883 + 0.7e1 / 0.3e1 * t1622 + 0.8e1 / 0.3e1 * t1624 + 0.3e1 * t1626 + 0.1e2 / 0.3e1 * t1628 + t1888;
  tv3rho32 = t1911 + t1921 + t1971 + t2023 + t2056 + t2076 + t2099 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2114 = 0.1e1 / t19;
  t2119 = t141 * t1343;
  t2122 = t147 * t1347;
  t2125 = t150 * t2114;
  t2128 = t153 * t50;
  t2145 = -0.8e1 / 0.3e1 * t1896 - 0.8e1 / 0.3e1 * t1898 - 0.9e1 / 0.2e1 * t1900 - 0.9e1 / 0.2e1 * t1902 - 0.2e2 / 0.3e1 * t1904 - 0.2e2 / 0.3e1 * t1906 + 0.28e2 * t1656 + 0.21e2 * t1658 + 0.32e2 * t1660 + 0.24e2 * t1662 + 0.36e2 * t1664;
  t2150 = 0.27e2 * t1666 + 0.4e2 * t1668 + 0.3e2 * t1670 - t1417 - t1422 - t1424 - t1428 - t1430 - t1432 - t1434 - t1436;
  t2153 = t867 * t310;
  t2159 = -0.6e1 * t272 - 0.6e1 * t1415;
  t2163 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1464 * t2153 + 0.4e1 / 0.3e1 * t716 * t871 + 0.4e1 / 0.3e1 * t42 * t2159);
  t2164 = t2163 * t46;
  t2168 = 0.1e1 / t11 / t921;
  t2169 = t49 * t2168;
  t2175 = t886 * t323;
  t2180 = -t2159;
  t2184 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1481 * t2175 + 0.4e1 / 0.3e1 * t733 * t889 + 0.4e1 / 0.3e1 * t54 * t2180);
  t2185 = t2184 * t46;
  t2188 = t33 * t2164 / 0.4e1 - 0.7e2 / 0.27e2 * t2169 * t57 + 0.7e1 / 0.3e1 * t881 * t373 - t370 * t894 + t51 * t2185 / 0.4e1;
  t2205 = t1240 * t875;
  t2206 = t89 * t2205;
  t2208 = t197 * t2163;
  t2209 = t89 * t2208;
  t2211 = t921 * rho[1];
  t2213 = 0.1e1 / t25 / t2211;
  t2214 = sigma[2] * t2213;
  t2215 = t2214 * t98;
  t2217 = t924 * t327;
  t2219 = t320 * t930;
  t2221 = t320 * t933;
  t2223 = t1318 * t893;
  t2224 = t96 * t2223;
  t2226 = t201 * t2184;
  t2227 = t96 * t2226;
  t2229 = 0.3e1 / 0.4e1 * t2206 + t2209 / 0.4e1 - 0.154e3 / 0.27e2 * t2215 + 0.22e2 / 0.3e1 * t2217 - 0.2e1 * t2219 - 0.2e1 * t2221 + 0.3e1 / 0.4e1 * t2224 + t2227 / 0.4e1;
  t2232 = 0.3e1 * t1691 + 0.6e1 * t1692 + t30 * t2188 / 0.2e1 + 0.2e1 * t379 * t897 + t64 * t2188 / 0.2e1 + 0.9e1 / 0.4e1 * t385 * t897 + t68 * t2188 / 0.2e1 + 0.5e1 / 0.2e1 * t390 * t897 + t81 * t2188 / 0.2e1 + 0.11e2 / 0.4e1 * t395 * t897 + t85 * t2229 / 0.2e1;
  t2257 = 0.3e1 / 0.2e1 * t2206 + t2209 / 0.2e1 - 0.308e3 / 0.27e2 * t2215 + 0.44e2 / 0.3e1 * t2217 - 0.4e1 * t2219 - 0.4e1 * t2221 + 0.3e1 / 0.2e1 * t2224 + t2227 / 0.2e1 + t1568;
  t2271 = t29 * t1347;
  t2274 = t63 * t2114;
  t2277 = t67 * t50;
  t2280 = 0.1e1 / t5;
  t2281 = t71 * t2280;
  t2284 = t84 * t2114;
  t2287 = t104 * t50;
  t2290 = 0.5e1 * t354 * t960 + t136 * t2257 + 0.11e2 / 0.2e1 * t358 * t960 + t139 * t2257 + 0.6e1 * t362 * t960 - 0.4e1 / 0.27e2 * t2271 * t60 - 0.3e1 / 0.16e2 * t2274 * t60 - 0.5e1 / 0.27e2 * t2277 * t60 - 0.55e2 / 0.432e3 * t2281 * t60 - 0.3e1 / 0.16e2 * t2284 * t101 - 0.5e1 / 0.27e2 * t2287 * t101;
  t2292 = t109 * t2280;
  t2295 = t118 * t2114;
  t2298 = t132 * t50;
  t2301 = t135 * t2280;
  t2318 = -0.55e2 / 0.432e3 * t2292 * t101 - 0.3e1 / 0.8e1 * t2295 * t130 - 0.1e2 / 0.27e2 * t2298 * t130 - 0.55e2 / 0.216e3 * t2301 * t130 + 0.2e1 / 0.3e1 * t973 * t376 + 0.9e1 / 0.8e1 * t976 * t376 + 0.5e1 / 0.3e1 * t981 * t376 + 0.55e2 / 0.24e2 * t985 * t376 + 0.9e1 / 0.8e1 * t988 * t330 + 0.5e1 / 0.3e1 * t991 * t330 + 0.55e2 / 0.24e2 * t994 * t330;
  t2329 = 0.9e1 / 0.4e1 * t997 * t348 + 0.1e2 / 0.3e1 * t1000 * t348 + 0.55e2 / 0.12e2 * t1003 * t348 + 0.7e1 * t1856 + 0.8e1 * t1858 + 0.9e1 * t1860 + 0.1e2 * t1862 - t1584 - t1586 - t1588 - t1632;
  tv3rho33 = t2329 + t2318 + t2290 - 0.7e1 / 0.6e1 * t1892 - 0.7e1 / 0.6e1 * t1894 + t2232 + t2150 + t2145 + 0.9e1 / 0.4e1 * t400 * t936 + t105 * t2229 / 0.2e1 + 0.5e1 / 0.2e1 * t333 * t936 + t110 * t2229 / 0.2e1 + 0.11e2 / 0.4e1 * t338 * t936 + t115 * t2229 / 0.2e1 + 0.3e1 * t343 * t936 + t119 * t2257 + 0.9e1 / 0.2e1 * t350 * t960 + t133 * t2257 - 0.8e1 / 0.27e2 * t2122 * t145 - 0.3e1 / 0.8e1 * t2125 * t145 - 0.1e2 / 0.27e2 * t2128 * t145 - 0.35e2 / 0.216e3 * t1 * t1343 - 0.8e1 / 0.27e2 * t8 * t1347 - 0.3e1 / 0.8e1 * t15 * t2114 - 0.1e2 / 0.27e2 * t22 * t50 - 0.35e2 / 0.216e3 * t2119 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2333 = 0.2e1 * t138 * t444;
  t2336 = t84 / t2 / t191;
  t2339 = 0.1e1 / t191;
  t2340 = t104 * t2339;
  t2344 = 0.1e1 / t74 / t86;
  t2345 = t109 * t2344;
  t2348 = t113 * t88;
  t2349 = t2348 * t91;
  t2351 = t105 * t193;
  t2356 = t110 * t193;
  t2361 = t115 * t193;
  t2367 = t161 * t169 * t46;
  t2373 = t32 * t525 * t46;
  t2376 = t2333 - 0.29e2 / 0.64e2 * t2336 * t91 - 0.35e2 / 0.72e2 * t2340 * t91 - 0.33e2 / 0.64e2 * t2345 * t91 - 0.13e2 / 0.24e2 * t2349 - 0.2e1 / 0.3e1 * t2351 * t198 + t1029 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2356 * t198 + t1032 * t526 / 0.8e1 - 0.2e1 / 0.3e1 * t2361 * t198 + t1035 * t526 / 0.8e1 - t419 * t2367 / 0.6e1 - t424 * t2367 / 0.6e1 + t419 * t2373 / 0.16e2;
  t2383 = t85 * t193;
  t2397 = t504 * t90 * t45;
  t2399 = t193 * t44;
  t2403 = t88 * t510 * t45;
  t2407 = 0.88e2 / 0.9e1 * t548;
  t2408 = 0.22e2 / 0.9e1 * t2397 - 0.8e1 / 0.3e1 * t2399 * t712 + t2403 / 0.2e1 + t1064 * t1702 / 0.2e1 - t2407;
  t2416 = t424 * t2373 / 0.16e2 + t427 * t2373 / 0.16e2 + t430 * t2373 / 0.16e2 - 0.2e1 / 0.3e1 * t2383 * t198 + t1119 * t526 / 0.8e1 + 0.4e1 * t247 * t1068 + 0.1e2 / 0.9e1 * t581 * t444 + 0.55e2 / 0.36e2 * t584 * t444 + 0.3e1 / 0.4e1 * t578 * t444 + t119 * t2408 + 0.3e1 * t235 * t1068 + t133 * t2408 + 0.1e2 / 0.3e1 * t239 * t1068 + t136 * t2408;
  t2426 = t596 * t44 * t46;
  t2436 = t418 * t169 * t46;
  t2439 = t67 * t1095;
  t2442 = t71 * t1391;
  t2445 = t29 * t1087;
  t2448 = t63 * t1091;
  t2453 = 0.11e2 / 0.3e1 * t243 * t1068 + t139 * t2408 - t427 * t2367 / 0.6e1 - t430 * t2367 / 0.6e1 + 0.7e1 / 0.36e2 * t427 * t2426 + 0.7e1 / 0.36e2 * t430 * t2426 + 0.7e1 / 0.36e2 * t419 * t2426 + 0.7e1 / 0.36e2 * t424 * t2426 + 0.11e2 / 0.48e2 * t1043 * t2436 - 0.5e1 / 0.24e2 * t2439 * t1040 - 0.121e3 / 0.576e3 * t2442 * t1040 - 0.7e1 / 0.36e2 * t2445 * t1040 - 0.13e2 / 0.64e2 * t2448 * t1040 + 0.3e1 / 0.8e1 * t1084 * t198;
  t2482 = 0.5e1 / 0.12e2 * t1088 * t198 + 0.11e2 / 0.24e2 * t1092 * t198 + t1096 * t198 / 0.2e1 + t1057 * t2436 / 0.6e1 + 0.3e1 / 0.16e2 * t1060 * t2436 + 0.5e1 / 0.24e2 * t1038 * t2436 + t105 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2397 + t110 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2397 + t115 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2397 + t85 * t2403 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2397;
  tv3rho2sigma0 = t2376 + t2416 + t2453 + t2482;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t235 * t230;
  t2489 = 0.176e3 / 0.9e1 * t119 * t548;
  t2492 = t239 * t230;
  t2495 = 0.176e3 / 0.9e1 * t133 * t548;
  t2498 = t243 * t230;
  t2501 = 0.176e3 / 0.9e1 * t136 * t548;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t247 * t230;
  t2507 = 0.176e3 / 0.9e1 * t139 * t548;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t578 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t581 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t584 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2509 = 0.2e1 * t138 * t480;
  t2510 = t113 * t95;
  t2511 = t2510 * t98;
  t2516 = t95 * t529 * t45;
  t2520 = t2516 / 0.2e1 + t1184 * t1730 / 0.2e1 - t2407;
  t2539 = t223 * t95;
  t2547 = t50 * t542 * t46;
  t2554 = t2509 + t2511 / 0.8e1 + 0.4e1 * t247 * t1187 + t139 * t2520 + 0.3e1 / 0.4e1 * t578 * t480 + 0.1e2 / 0.9e1 * t581 * t480 + 0.55e2 / 0.36e2 * t584 * t480 + 0.3e1 * t235 * t1187 + t119 * t2520 + 0.1e2 / 0.3e1 * t239 * t1187 + t133 * t2520 + 0.11e2 / 0.3e1 * t243 * t1187 + t136 * t2520 + t1174 * t543 / 0.8e1 + t2539 * t202 / 0.2e1 + t1179 * t543 / 0.8e1 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2547 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + t466 * t2547 / 0.16e2;
  t2555 = t208 * t95;
  t2560 = t213 * t95;
  t2565 = t218 * t95;
  t2576 = t561 * t454;
  t2579 = t565 * t454;
  t2582 = t555 * t454;
  t2585 = t558 * t454;
  t2602 = 0.3e1 / 0.8e1 * t2555 * t202 + t1163 * t543 / 0.8e1 + 0.5e1 / 0.12e2 * t2560 * t202 + t1168 * t543 / 0.8e1 + 0.11e2 / 0.24e2 * t2565 * t202 + t1139 * t1143 / 0.6e1 + t455 * t2547 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2547 / 0.16e2 + 0.5e1 / 0.72e2 * t2576 * t457 + 0.55e2 / 0.576e3 * t2579 * t457 + t2582 * t457 / 0.36e2 + 0.3e1 / 0.64e2 * t2585 * t457 + t110 * t2516 / 0.8e1 + t115 * t2516 / 0.8e1 + 0.3e1 / 0.64e2 * t568 * t470 + t85 * t2516 / 0.8e1 + 0.5e1 / 0.72e2 * t571 * t470 + t105 * t2516 / 0.8e1 + 0.55e2 / 0.576e3 * t574 * t470;
  tv3rho2sigma2 = t2554 + t2602;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2607 = t88 * t169;
  t2610 = t45 * t723;
  t2613 = -0.4e1 / 0.3e1 * t2399 * t1240 + t2607 * t1240 / 0.2e1 + t1064 * t2610 / 0.2e1 - t2407;
  t2633 = t32 * t723 * t46;
  t2638 = 0.3e1 / 0.2e1 * t350 * t1068 + t119 * t2613 + 0.3e1 / 0.2e1 * t235 * t1243 + 0.5e1 / 0.3e1 * t354 * t1068 + t133 * t2613 + 0.5e1 / 0.3e1 * t239 * t1243 + 0.11e2 / 0.6e1 * t358 * t1068 + t136 * t2613 + 0.11e2 / 0.6e1 * t243 * t1243 + 0.2e1 * t362 * t1068 + t139 * t2613 + 0.2e1 * t247 * t1243 + t424 * t2633 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1110;
  t2645 = t400 * t88;
  t2652 = t333 * t88;
  t2659 = t338 * t88;
  t2669 = t161 * t313 * t46;
  t2672 = t427 * t2633 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t1110 + t430 * t2633 / 0.16e2 + 0.3e1 / 0.16e2 * t2645 * t198 + t1119 * t713 / 0.8e1 + t1119 * t724 / 0.8e1 + 0.5e1 / 0.24e2 * t2652 * t198 + t1029 * t713 / 0.8e1 + t1029 * t724 / 0.8e1 + 0.11e2 / 0.48e2 * t2659 * t198 + t1199 * t1110 / 0.12e2 + t419 * t2633 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1110 - t430 * t2669 / 0.12e2;
  t2700 = t343 * t88;
  t2703 = -t2383 * t314 / 0.3e1 - t2351 * t314 / 0.3e1 - t2356 * t314 / 0.3e1 - t2361 * t314 / 0.3e1 - t1199 * t1100 / 0.9e1 - t419 * t2669 / 0.12e2 - t1206 * t1100 / 0.8e1 - t424 * t2669 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1100 - t427 * t2669 / 0.12e2 - 0.11e2 / 0.72e2 * t1216 * t1100 + t1032 * t713 / 0.8e1 + t1032 * t724 / 0.8e1 + t2700 * t198 / 0.4e1;
  t2725 = t418 * t313 * t46;
  t2734 = t1035 * t713 / 0.8e1 + t1035 * t724 / 0.8e1 - t343 * t1047 / 0.3e1 - t400 * t1047 / 0.4e1 - 0.5e1 / 0.18e2 * t333 * t1047 - 0.11e2 / 0.36e2 * t338 * t1047 + 0.3e1 / 0.16e2 * t1084 * t314 + 0.5e1 / 0.24e2 * t1088 * t314 + 0.11e2 / 0.48e2 * t1092 * t314 + t1096 * t314 / 0.4e1 + t1057 * t2725 / 0.12e2 + 0.3e1 / 0.32e2 * t1060 * t2725 + 0.5e1 / 0.48e2 * t1038 * t2725 + 0.11e2 / 0.96e2 * t1043 * t2725;
  tv3rho2sigma3 = t2638 + t2672 + t2703 + t2734;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t350 * t230;
  t2739 = t354 * t230;
  t2742 = t358 * t230;
  t2745 = t362 * t230;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2748 = t319 * t56;
  t2751 = t95 * t176;
  t2754 = t45 * t740;
  t2757 = -0.4e1 / 0.3e1 * t2748 * t729 + t2751 * t1318 / 0.2e1 + t1184 * t2754 / 0.2e1 - t2407;
  t2782 = t119 * t2757 + 0.3e1 / 0.2e1 * t235 * t1321 + 0.3e1 / 0.2e1 * t350 * t1187 + t133 * t2757 + t136 * t2757 + 0.5e1 / 0.3e1 * t239 * t1321 + 0.5e1 / 0.3e1 * t354 * t1187 + 0.11e2 / 0.6e1 * t243 * t1321 + 0.11e2 / 0.6e1 * t358 * t1187 + t139 * t2757 + 0.2e1 * t247 * t1321 + 0.2e1 * t362 * t1187 + t1174 * t730 / 0.8e1 + t1174 * t741 / 0.8e1;
  t2785 = t115 * t319;
  t2795 = t369 * t176 * t46;
  t2811 = t50 * t740 * t46;
  t2816 = 0.11e2 / 0.48e2 * t2565 * t327 - t2785 * t202 / 0.3e1 + t1179 * t730 / 0.8e1 + t1179 * t741 / 0.8e1 + t2539 * t327 / 0.4e1 - t455 * t2795 / 0.12e2 - t1139 * t1282 / 0.9e1 - t460 * t2795 / 0.12e2 - t1146 * t1282 / 0.8e1 - t463 * t2795 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1282 - t466 * t2795 / 0.12e2 + t460 * t2811 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1264;
  t2826 = t85 * t319;
  t2835 = t105 * t319;
  t2844 = t110 * t319;
  t2849 = t463 * t2811 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1264 + t466 * t2811 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t1264 - t2826 * t202 / 0.3e1 + t1163 * t730 / 0.8e1 + t1163 * t741 / 0.8e1 + 0.3e1 / 0.16e2 * t2555 * t327 - t2835 * t202 / 0.3e1 + t1168 * t730 / 0.8e1 + t1168 * t741 / 0.8e1 + 0.5e1 / 0.24e2 * t2560 * t327 - t2844 * t202 / 0.3e1 + t455 * t2811 / 0.16e2;
  t2863 = t454 * t176 * t46;
  t2880 = t1139 * t1264 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1282 + 0.3e1 / 0.16e2 * t1336 * t202 + 0.5e1 / 0.24e2 * t1340 * t202 + 0.11e2 / 0.48e2 * t1344 * t202 + t1348 * t202 / 0.4e1 + t1303 * t2863 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t2863 + 0.5e1 / 0.48e2 * t1311 * t2863 + 0.11e2 / 0.96e2 * t1314 * t2863 - t208 * t1292 / 0.4e1 - 0.5e1 / 0.18e2 * t213 * t1292 - 0.11e2 / 0.36e2 * t218 * t1292 - t223 * t1292 / 0.3e1;
  tv3rho2sigma5 = t2782 + t2816 + t2849 + t2880;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2892 = t88 * t914 * t45;
  t2894 = t45 * t875;
  t2897 = t2892 / 0.2e1 + t1064 * t2894 / 0.2e1 - t2407;
  t2917 = t32 * t875 * t46;
  t2924 = t2333 + t2349 / 0.8e1 + 0.3e1 / 0.4e1 * t997 * t444 + 0.1e2 / 0.9e1 * t1000 * t444 + 0.55e2 / 0.36e2 * t1003 * t444 + 0.11e2 / 0.3e1 * t358 * t1243 + t136 * t2897 + 0.4e1 * t362 * t1243 + t139 * t2897 + 0.3e1 * t350 * t1243 + t119 * t2897 + 0.1e2 / 0.3e1 * t354 * t1243 + t133 * t2897 + 0.11e2 / 0.24e2 * t2659 * t314 + t1032 * t918 / 0.8e1 + t2700 * t314 / 0.2e1 + t1035 * t918 / 0.8e1 + t424 * t2917 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2917 / 0.16e2;
  t2943 = t973 * t418;
  t2946 = t976 * t418;
  t2949 = t981 * t418;
  t2952 = t985 * t418;
  t2969 = 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2917 / 0.16e2 + 0.3e1 / 0.8e1 * t2645 * t314 + t1119 * t918 / 0.8e1 + 0.5e1 / 0.12e2 * t2652 * t314 + t1029 * t918 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2917 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t2943 * t421 / 0.36e2 + 0.3e1 / 0.64e2 * t2946 * t421 + 0.5e1 / 0.72e2 * t2949 * t421 + 0.55e2 / 0.576e3 * t2952 * t421 + t110 * t2892 / 0.8e1 + t115 * t2892 / 0.8e1 + 0.3e1 / 0.64e2 * t988 * t434 + t85 * t2892 / 0.8e1 + 0.5e1 / 0.72e2 * t991 * t434 + t105 * t2892 / 0.8e1 + 0.55e2 / 0.576e3 * t994 * t434;
  tv3rho2sigma6 = t2924 + t2969;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t997 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t1000 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t1003 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2986 = t923 * t97 * t45;
  t2991 = t95 * t929 * t45;
  t2993 = t45 * t893;
  t2996 = 0.22e2 / 0.9e1 * t2986 - 0.8e1 / 0.3e1 * t2748 * t1318 + t2991 / 0.2e1 + t1184 * t2993 / 0.2e1 - t2407;
  t3011 = 0.1e1 / t317;
  t3012 = t104 * t3011;
  t3015 = t2509 - 0.13e2 / 0.24e2 * t2511 + 0.1e2 / 0.9e1 * t1000 * t480 + 0.55e2 / 0.36e2 * t1003 * t480 + t133 * t2996 + 0.1e2 / 0.3e1 * t354 * t1321 + t136 * t2996 + 0.11e2 / 0.3e1 * t358 * t1321 + t139 * t2996 + 0.4e1 * t362 * t1321 + t119 * t2996 + 0.3e1 * t350 * t1321 + 0.3e1 / 0.4e1 * t997 * t480 - 0.35e2 / 0.72e2 * t3012 * t98;
  t3017 = 0.1e1 / t78 / t93;
  t3018 = t109 * t3017;
  t3023 = t84 / t4 / t317;
  t3033 = t50 * t893 * t46;
  t3052 = -0.33e2 / 0.64e2 * t3018 * t98 - 0.29e2 / 0.64e2 * t3023 * t98 + t1174 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2785 * t327 + t1179 * t933 / 0.8e1 + t455 * t3033 / 0.16e2 + t460 * t3033 / 0.16e2 + t463 * t3033 / 0.16e2 + t466 * t3033 / 0.16e2 - 0.2e1 / 0.3e1 * t2826 * t327 + t1163 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2835 * t327 + t1168 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2844 * t327;
  t3055 = t880 * t56 * t46;
  t3065 = t369 * t326 * t46;
  t3082 = t29 * t1339;
  t3085 = t63 * t1343;
  t3088 = 0.7e1 / 0.36e2 * t455 * t3055 + 0.7e1 / 0.36e2 * t460 * t3055 + 0.7e1 / 0.36e2 * t463 * t3055 + 0.7e1 / 0.36e2 * t466 * t3055 - t455 * t3065 / 0.6e1 - t460 * t3065 / 0.6e1 - t463 * t3065 / 0.6e1 - t466 * t3065 / 0.6e1 + 0.3e1 / 0.8e1 * t1336 * t327 + 0.5e1 / 0.12e2 * t1340 * t327 + 0.11e2 / 0.24e2 * t1344 * t327 + t1348 * t327 / 0.2e1 - 0.7e1 / 0.36e2 * t3082 * t1305 - 0.13e2 / 0.64e2 * t3085 * t1305;
  t3089 = t67 * t1347;
  t3092 = t71 * t2114;
  t3096 = t454 * t326 * t46;
  t3121 = -0.5e1 / 0.24e2 * t3089 * t1305 - 0.121e3 / 0.576e3 * t3092 * t1305 + t1303 * t3096 / 0.6e1 + 0.3e1 / 0.16e2 * t1308 * t3096 + 0.5e1 / 0.24e2 * t1311 * t3096 + 0.11e2 / 0.48e2 * t1314 * t3096 + t110 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2986 + t115 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2986 + t85 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2986 + t105 * t2991 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2986;
  tv3rho2sigma8 = t3015 + t3052 + t3088 + t3121;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1057 * t3124 / 0.24e2 + t1354 * t1100 / 0.24e2 - t1354 * t1110 / 0.32e2 - 0.3e1 / 0.64e2 * t1060 * t3124 + t1356 * t1100 / 0.24e2 - t1356 * t1110 / 0.32e2 - 0.5e1 / 0.96e2 * t1038 * t3124 + t1358 * t1100 / 0.24e2 - t1358 * t1110 / 0.32e2 - 0.11e2 / 0.192e3 * t1043 * t3124 + t1360 * t1100 / 0.24e2 - t1360 * t1110 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t253 * t1364;
  t3154 = t258 * t1364;
  t3159 = t183 * t1364;
  t3164 = t188 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t379 * t1353;
  t3174 = t385 * t1353;
  t3179 = t390 * t1353;
  t3184 = t395 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1303 * t3190 / 0.24e2 + t1365 * t1282 / 0.24e2 - t1365 * t1264 / 0.32e2 - 0.3e1 / 0.64e2 * t1308 * t3190 + t1367 * t1282 / 0.24e2 - t1367 * t1264 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t3190 + t1369 * t1282 / 0.24e2 - t1369 * t1264 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t3190 + t1371 * t1282 / 0.24e2 - t1371 * t1264 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3239 = t113 * t631;
  t3241 = t138 * t551;
  t3248 = 0.1e1 / t16 / t86;
  t3267 = 0.6e1 * t3239 + 0.12e2 * t3241 + 0.385e3 / 0.1296e4 * t1 * t2344 + 0.4e2 / 0.81e2 * t8 * t88 + 0.9e1 / 0.16e2 * t15 * t3248 + 0.4e2 / 0.81e2 * t22 * t161 - 0.4e2 / 0.27e2 * t1616 * t233 - 0.55e2 / 0.54e2 * t1619 * t233 + 0.4e1 / 0.3e1 * t555 * t608 + 0.9e1 / 0.4e1 * t558 * t608 + 0.1e2 / 0.3e1 * t561 * t608 + 0.55e2 / 0.12e2 * t565 * t608 + 0.9e1 / 0.4e1 * t568 * t631;
  t3278 = t291 * t272;
  t3280 = t294 * t272;
  t3282 = t297 * t272;
  t3284 = t657 * t144;
  t3286 = t664 * t144;
  t3288 = t672 * t144;
  t3290 = t142 * t681;
  t3291 = 0.72e2 * t3290;
  t3292 = t148 * t681;
  t3293 = 0.72e2 * t3292;
  t3294 = t151 * t681;
  t3295 = 0.72e2 * t3294;
  t3296 = 0.1e2 / 0.3e1 * t571 * t631 + 0.55e2 / 0.12e2 * t574 * t631 + 0.9e1 / 0.2e1 * t578 * t551 + 0.2e2 / 0.3e1 * t581 * t551 + 0.55e2 / 0.6e1 * t584 * t551 - 0.64e2 * t3278 - 0.72e2 * t3280 - 0.8e2 * t3282 + 0.16e2 / 0.3e1 * t3284 + 0.9e1 * t3286 + 0.4e2 / 0.3e1 * t3288 + t3291 + t3293 + t3295;
  t3298 = t154 * t681;
  t3299 = 0.72e2 * t3298;
  t3330 = t697 * t144;
  t3332 = t288 * t272;
  t3334 = t3299 + 0.2e2 / 0.81e2 * t29 * t88 * t60 + 0.9e1 / 0.32e2 * t63 * t3248 * t60 + 0.2e2 / 0.81e2 * t67 * t161 * t60 + 0.385e3 / 0.2592e4 * t71 * t1083 * t60 + 0.9e1 / 0.32e2 * t84 * t3248 * t101 + 0.2e2 / 0.81e2 * t104 * t161 * t101 + 0.385e3 / 0.2592e4 * t109 * t1083 * t101 + 0.9e1 / 0.16e2 * t118 * t3248 * t130 + 0.4e2 / 0.81e2 * t132 * t161 * t130 + 0.385e3 / 0.1296e4 * t135 * t1083 * t130 + 0.7e1 / 0.3e1 * t3330 - 0.56e2 * t3332;
  t3339 = sigma[0] / t23 / t502 / t86 * t91;
  t3341 = t1516 * t198;
  t3343 = t505 * t511;
  t3345 = t505 * t526;
  t3347 = t194 * t1525;
  t3349 = t194 * t1528;
  t3351 = t525 * t525;
  t3353 = t89 * t3351 * t45;
  t3356 = t89 * t712 * t1476;
  t3357 = t38 * t38;
  t3359 = 0.1e1 / t514 / t3357;
  t3360 = t516 * t516;
  t3366 = t521 * t521;
  t3371 = t34 * t1419;
  t3373 = -0.24e2 * t681 + 0.24e2 * t3371;
  t3377 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3359 * t3360 - 0.16e2 / 0.9e1 * t1464 * t516 * t521 + 0.4e1 / 0.3e1 * t515 * t3366 + 0.16e2 / 0.9e1 * t1468 * t1472 + 0.4e1 / 0.3e1 * t42 * t3373);
  t3379 = t89 * t197 * t3377;
  t3381 = t542 * t542;
  t3383 = t96 * t3381 * t45;
  t3386 = t96 * t729 * t1492;
  t3387 = t52 * t52;
  t3389 = 0.1e1 / t533 / t3387;
  t3390 = t535 * t535;
  t3396 = t538 * t538;
  t3405 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3389 * t3390 - 0.16e2 / 0.9e1 * t1481 * t535 * t538 + 0.4e1 / 0.3e1 * t534 * t3396 + 0.16e2 / 0.9e1 * t1485 * t1488 - 0.4e1 / 0.3e1 * t54 * t3373);
  t3407 = t96 * t201 * t3405;
  t3409 = 0.2618e4 / 0.81e2 * t3339 - 0.1232e4 / 0.27e2 * t3341 + 0.44e2 / 0.3e1 * t3343 + 0.44e2 / 0.3e1 * t3345 - 0.8e1 * t3347 - 0.8e1 / 0.3e1 * t3349 + 0.3e1 / 0.4e1 * t3353 + t3356 + t3379 / 0.4e1 + 0.3e1 / 0.4e1 * t3383 + t3386 + t3407 / 0.4e1;
  t3426 = t546 * t124;
  t3430 = 0.20944e5 / 0.81e2 * t123 / t126 / t3426;
  t3431 = 0.5236e4 / 0.81e2 * t3339 - 0.2464e4 / 0.27e2 * t3341 + 0.88e2 / 0.3e1 * t3343 + 0.88e2 / 0.3e1 * t3345 - 0.16e2 * t3347 - 0.16e2 / 0.3e1 * t3349 + 0.3e1 / 0.2e1 * t3353 + 0.2e1 * t3356 + t3379 / 0.2e1 + 0.3e1 / 0.2e1 * t3383 + 0.2e1 * t3386 + t3407 / 0.2e1 - t3430;
  t3461 = 0.91e3 / 0.81e2 * t31 / t9 / t1513 * t47 - 0.28e3 / 0.27e2 * t1457 * t170 + 0.14e2 / 0.3e1 * t597 * t602 - 0.4e1 / 0.3e1 * t162 * t1477 + t33 * t3377 * t46 / 0.4e1 + t51 * t3405 * t46 / 0.4e1;
  t3470 = t115 * t3409 / 0.2e1 + 0.4e1 * t223 * t1537 + t119 * t3431 + 0.6e1 * t235 * t1569 + t133 * t3431 + 0.2e2 / 0.3e1 * t239 * t1569 + t136 * t3431 + 0.22e2 / 0.3e1 * t243 * t1569 + t139 * t3431 + 0.8e1 * t247 * t1569 + t30 * t3461 / 0.2e1 + 0.8e1 / 0.3e1 * t253 * t1496 + t64 * t3461 / 0.2e1 + 0.3e1 * t258 * t1496;
  t3499 = t68 * t3461 / 0.2e1 + 0.1e2 / 0.3e1 * t183 * t1496 + t81 * t3461 / 0.2e1 + 0.11e2 / 0.3e1 * t188 * t1496 + t85 * t3409 / 0.2e1 + 0.3e1 * t208 * t1537 + t105 * t3409 / 0.2e1 + 0.1e2 / 0.3e1 * t213 * t1537 + t110 * t3409 / 0.2e1 + 0.11e2 / 0.3e1 * t218 * t1537 - 0.16e2 / 0.27e2 * t1589 * t180 - 0.3e1 / 0.4e1 * t1592 * t180 - 0.2e2 / 0.27e2 * t1595 * t180;
  t3510 = t697 * t519;
  t3512 = t697 * t682;
  t3514 = t664 * t519;
  t3516 = t664 * t682;
  t3518 = t294 * t1415;
  t3520 = t294 * t1420;
  t3525 = t1404 * t165;
  t3527 = t1404 * t273;
  t3529 = -0.55e2 / 0.108e3 * t1601 * t180 - 0.3e1 / 0.4e1 * t1604 * t205 - 0.2e2 / 0.27e2 * t1607 * t205 - 0.55e2 / 0.108e3 * t1610 * t205 - 0.3e1 / 0.2e1 * t1613 * t233 - 0.28e2 / 0.3e1 * t3510 + 0.7e1 * t3512 - 0.36e2 * t3514 + 0.27e2 * t3516 + 0.216e3 * t3518 - 0.144e3 * t3520 + 0.4e2 / 0.81e2 * t153 * t161 * t145 - 0.8e2 / 0.27e2 * t3525 + 0.8e2 / 0.27e2 * t3527;
  t3531 = t672 * t519;
  t3533 = t672 * t682;
  t3535 = t297 * t1415;
  t3537 = t297 * t1420;
  t3539 = t142 * t3371;
  t3540 = 0.192e3 * t3539;
  t3541 = 0.1e1 / t3426;
  t3542 = t143 * t3541;
  t3544 = 0.12e3 * t142 * t3542;
  t3545 = t148 * t3371;
  t3546 = 0.192e3 * t3545;
  t3548 = 0.12e3 * t148 * t3542;
  t3549 = t151 * t3371;
  t3550 = 0.192e3 * t3549;
  t3552 = 0.12e3 * t151 * t3542;
  t3553 = t154 * t3371;
  t3554 = 0.192e3 * t3553;
  t3556 = 0.12e3 * t154 * t3542;
  t3560 = -0.16e3 / 0.3e1 * t3531 + 0.4e2 * t3533 + 0.24e3 * t3535 - 0.16e3 * t3537 - t3540 + t3544 - t3546 + t3548 - t3550 + t3552 - t3554 + t3556 + 0.385e3 / 0.1296e4 * t141 * t2344 * t145;
  t3561 = t1437 * t165;
  t3563 = t1437 * t273;
  t3568 = t1380 * t165;
  t3570 = t1380 * t273;
  t3572 = t657 * t519;
  t3574 = t657 * t682;
  t3576 = t291 * t1415;
  t3578 = t291 * t1420;
  t3583 = t1392 * t165;
  t3585 = t1392 * t273;
  t3587 = t288 * t1415;
  t3589 = t288 * t1420;
  t3591 = -0.35e2 / 0.27e2 * t3561 + 0.35e2 / 0.27e2 * t3563 + 0.4e2 / 0.81e2 * t147 * t88 * t145 - 0.64e2 / 0.27e2 * t3568 + 0.64e2 / 0.27e2 * t3570 - 0.64e2 / 0.3e1 * t3572 + 0.16e2 * t3574 + 0.192e3 * t3576 - 0.128e3 * t3578 + 0.9e1 / 0.16e2 * t150 * t3248 * t145 - 0.3e1 * t3583 + 0.3e1 * t3585 + 0.168e3 * t3587 - 0.112e3 * t3589;
  tv4rho40 = t3267 + t3296 + t3334 + t3470 + t3499 + t3529 + t3560 + t3591;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3595 = 0.6e1 * t138 * t744;
  t3597 = 0.3e1 * t113 * t802;
  t3602 = t1516 * t314;
  t3604 = t194 * t1703;
  t3606 = t194 * t1706;
  t3608 = t194 * t1723;
  t3610 = t1476 * t45;
  t3612 = t89 * t3610 * t313;
  t3615 = t89 * t1702 * t723;
  t3618 = t89 * t712 * t1722;
  t3644 = 0.32e2 * t719 * t1419;
  t3646 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3359 * t310 * t1465 - 0.16e2 / 0.9e1 * t1464 * t34 * t272 * t516 - 0.8e1 / 0.9e1 * t1708 * t166 * t521 + 0.8e1 / 0.3e1 * t515 * t272 * t166 - 0.8e1 * t1711 * t681 * t166 + 0.8e1 / 0.3e1 * t1711 * t272 * t521 + 0.4e1 / 0.9e1 * t716 * t1472 - 0.16e2 * t42 * t681 + t3644);
  t3648 = t89 * t197 * t3646;
  t3650 = t320 * t1531;
  t3652 = t320 * t1534;
  t3654 = t1492 * t45;
  t3656 = t96 * t3654 * t326;
  t3659 = t96 * t1730 * t740;
  t3662 = t96 * t729 * t1750;
  t3688 = 0.32e2 * t736 * t1419;
  t3690 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3389 * t323 * t1482 + 0.16e2 / 0.9e1 * t1481 * t34 * t272 * t535 - 0.8e1 / 0.9e1 * t1736 * t173 * t538 - 0.8e1 / 0.3e1 * t534 * t272 * t173 + 0.8e1 * t1739 * t681 * t173 - 0.8e1 / 0.3e1 * t1739 * t272 * t538 + 0.4e1 / 0.9e1 * t733 * t1488 + 0.16e2 * t54 * t681 - t3688);
  t3692 = t96 * t201 * t3690;
  t3694 = t505 * t713;
  t3696 = t505 * t724;
  t3698 = -0.308e3 / 0.27e2 * t3602 - 0.2e1 * t3604 - 0.4e1 * t3606 - 0.2e1 * t3608 + t3612 / 0.4e1 + 0.3e1 / 0.4e1 * t3615 + 0.3e1 / 0.4e1 * t3618 + t3648 / 0.4e1 - 0.2e1 * t3650 - 0.2e1 / 0.3e1 * t3652 + t3656 / 0.4e1 + 0.3e1 / 0.4e1 * t3659 + 0.3e1 / 0.4e1 * t3662 + t3692 / 0.4e1 + 0.22e2 / 0.3e1 * t3694 + 0.22e2 / 0.3e1 * t3696;
  t3716 = t3595 + t3597 + 0.9e1 / 0.4e1 * t208 * t1821 + 0.3e1 / 0.4e1 * t400 * t1537 + t105 * t3698 / 0.2e1 + 0.5e1 / 0.2e1 * t213 * t1821 + 0.5e1 / 0.6e1 * t333 * t1537 + t110 * t3698 / 0.2e1 + 0.11e2 / 0.4e1 * t218 * t1821 + 0.11e2 / 0.12e2 * t338 * t1537 + t115 * t3698 / 0.2e1 + 0.3e1 * t223 * t1821 + t343 * t1537;
  t3733 = -t3430 - 0.616e3 / 0.27e2 * t3602 - 0.4e1 * t3604 - 0.8e1 * t3606 - 0.4e1 * t3608 + t3612 / 0.2e1 + 0.3e1 / 0.2e1 * t3615 + 0.3e1 / 0.2e1 * t3618 + t3648 / 0.2e1 - 0.4e1 * t3650 - 0.4e1 / 0.3e1 * t3652 + t3656 / 0.2e1 + 0.3e1 / 0.2e1 * t3659 + 0.3e1 / 0.2e1 * t3662 + t3692 / 0.2e1 + 0.44e2 / 0.3e1 * t3694 + 0.44e2 / 0.3e1 * t3696;
  t3767 = -0.7e2 / 0.27e2 * t1457 * t365 + 0.7e1 / 0.3e1 * t597 * t762 - t162 * t1774 + t33 * t3646 * t46 / 0.4e1 - t370 * t1493 / 0.3e1 + t51 * t3690 * t46 / 0.4e1;
  t3772 = t119 * t3733 + 0.9e1 / 0.2e1 * t235 * t1754 + 0.3e1 / 0.2e1 * t350 * t1569 + t133 * t3733 + 0.5e1 * t239 * t1754 + 0.9e1 / 0.8e1 * t568 * t802 + 0.5e1 / 0.3e1 * t571 * t802 + 0.55e2 / 0.24e2 * t574 * t802 + 0.9e1 / 0.4e1 * t578 * t744 + 0.1e2 / 0.3e1 * t581 * t744 + 0.55e2 / 0.12e2 * t584 * t744 + t30 * t3767 / 0.2e1 + 0.2e1 * t253 * t1782;
  t3800 = 0.2e1 / 0.3e1 * t379 * t1496 + t64 * t3767 / 0.2e1 + 0.9e1 / 0.4e1 * t258 * t1782 + 0.3e1 / 0.4e1 * t385 * t1496 + t68 * t3767 / 0.2e1 + 0.5e1 / 0.2e1 * t183 * t1782 + 0.5e1 / 0.6e1 * t390 * t1496 + t81 * t3767 / 0.2e1 + 0.2e1 / 0.3e1 * t555 * t770 + 0.9e1 / 0.8e1 * t558 * t770 + 0.5e1 / 0.3e1 * t561 * t770 + 0.55e2 / 0.24e2 * t565 * t770 - 0.5e1 / 0.27e2 * t1607 * t330;
  t3827 = -0.55e2 / 0.432e3 * t1610 * t330 - 0.3e1 / 0.8e1 * t1613 * t348 - 0.1e2 / 0.27e2 * t1616 * t348 - 0.55e2 / 0.216e3 * t1619 * t348 + 0.5e1 / 0.3e1 * t354 * t1569 + t136 * t3733 + 0.11e2 / 0.2e1 * t243 * t1754 + 0.11e2 / 0.6e1 * t358 * t1569 + t139 * t3733 + 0.6e1 * t247 * t1754 + 0.2e1 * t362 * t1569 + 0.11e2 / 0.4e1 * t188 * t1782 + 0.11e2 / 0.12e2 * t395 * t1496 + t85 * t3698 / 0.2e1;
  t3830 = 0.16e2 * t3278;
  t3831 = 0.18e2 * t3280;
  t3832 = 0.2e2 * t3282;
  t3837 = 0.14e2 * t3332;
  t3838 = t404 * t272;
  t3839 = 0.14e2 * t3838;
  t3840 = t407 * t272;
  t3841 = 0.16e2 * t3840;
  t3842 = t410 * t272;
  t3843 = 0.18e2 * t3842;
  t3844 = t413 * t272;
  t3845 = 0.2e2 * t3844;
  t3848 = t3830 + t3831 + t3832 - 0.8e1 / 0.3e1 * t3284 - 0.9e1 / 0.2e1 * t3286 - 0.2e2 / 0.3e1 * t3288 - 0.7e1 / 0.6e1 * t3330 + t3837 - t3839 - t3841 - t3843 - t3845 - 0.4e1 / 0.27e2 * t1589 * t376;
  t3857 = t407 * t1415;
  t3858 = 0.48e2 * t3857;
  t3859 = t407 * t1420;
  t3861 = t410 * t1415;
  t3862 = 0.54e2 * t3861;
  t3863 = t410 * t1420;
  t3865 = t413 * t1415;
  t3866 = 0.6e2 * t3865;
  t3867 = t413 * t1420;
  t3869 = t404 * t1415;
  t3870 = 0.42e2 * t3869;
  t3871 = t404 * t1420;
  t3874 = -0.3e1 / 0.16e2 * t1592 * t376 - 0.5e1 / 0.27e2 * t1595 * t376 - 0.55e2 / 0.432e3 * t1601 * t376 - 0.3e1 / 0.16e2 * t1604 * t330 + t3858 - 0.32e2 * t3859 + t3862 - 0.36e2 * t3863 + t3866 - 0.4e2 * t3867 + t3870 - 0.28e2 * t3871 + 0.7e1 / 0.2e1 * t3512;
  t3877 = 0.54e2 * t3518;
  t3882 = 0.6e2 * t3535;
  t3884 = 0.96e2 * t3539;
  t3885 = 0.96e2 * t3545;
  t3886 = 0.96e2 * t3549;
  t3887 = 0.27e2 / 0.2e1 * t3516 + t3877 - 0.108e3 * t3520 + 0.2e2 / 0.27e2 * t3525 + 0.2e2 / 0.27e2 * t3527 + 0.2e2 * t3533 + t3882 - 0.12e3 * t3537 - t3884 + t3544 - t3885 + t3548 - t3886;
  t3888 = 0.96e2 * t3553;
  t3894 = 0.48e2 * t3576;
  t3898 = 0.42e2 * t3587;
  t3900 = t3552 - t3888 + t3556 + 0.35e2 / 0.108e3 * t3561 + 0.35e2 / 0.108e3 * t3563 + 0.16e2 / 0.27e2 * t3568 + 0.16e2 / 0.27e2 * t3570 + 0.8e1 * t3574 + t3894 - 0.96e2 * t3578 + 0.3e1 / 0.4e1 * t3583 + 0.3e1 / 0.4e1 * t3585 + t3898 - 0.84e2 * t3589;
  tv4rho41 = t3716 + t3772 + t3800 + t3827 + t3848 + t3874 + t3887 + t3900;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3904 = t113 * t936;
  t3905 = t138 * t960;
  t3911 = t320 * t1731;
  t3913 = t320 * t1734;
  t3915 = t320 * t1751;
  t3917 = t740 * t740;
  t3919 = t96 * t3917 * t45;
  t3921 = t96 * t1318 * t1750;
  t3923 = t96 * t1730 * t893;
  t3926 = t96 * t729 * t1960;
  t3952 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3389 * t886 * t535 + 0.64e2 / 0.27e2 * t1736 * t173 * t34 * t272 - 0.8e1 / 0.27e2 * t1948 * t538 + 0.32e2 / 0.9e1 * t534 * t143 * t3541 - 0.16e2 / 0.9e1 * t733 * t272 + 0.16e2 / 0.3e1 * t733 * t1415 - 0.8e1 / 0.27e2 * t1481 * t889 * t535 + 0.8e1 / 0.9e1 * t534 * t1956 * t173 + 0.4e1 / 0.9e1 * t1953 * t538 - t3688);
  t3954 = t96 * t201 * t3952;
  t3956 = t505 * t915;
  t3958 = t194 * t1992;
  t3961 = t723 * t723;
  t3963 = t89 * t3961 * t45;
  t3965 = t89 * t1240 * t1722;
  t3966 = t194 * t1997;
  t3968 = t194 * t2000;
  t3971 = t89 * t1702 * t875;
  t3974 = t89 * t712 * t1940;
  t4000 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3359 * t867 * t516 - 0.64e2 / 0.27e2 * t1708 * t166 * t34 * t272 - 0.8e1 / 0.27e2 * t1926 * t521 + 0.32e2 / 0.9e1 * t515 * t143 * t3541 + 0.16e2 / 0.9e1 * t716 * t272 - 0.16e2 / 0.3e1 * t716 * t1415 - 0.8e1 / 0.27e2 * t1464 * t871 * t516 + 0.8e1 / 0.9e1 * t515 * t1936 * t166 + 0.4e1 / 0.9e1 * t1931 * t521 + t3644);
  t4002 = t89 * t197 * t4000;
  t4004 = t924 * t530;
  t4006 = t924 * t543;
  t4008 = t505 * t918;
  t4010 = t3963 + t3965 - 0.8e1 / 0.3e1 * t3966 - 0.8e1 / 0.3e1 * t3968 + t3971 / 0.2e1 + t3974 + t4002 / 0.2e1 + 0.44e2 / 0.9e1 * t4004 + 0.44e2 / 0.9e1 * t4006 - t3430 + 0.44e2 / 0.9e1 * t4008;
  t4011 = -0.8e1 / 0.3e1 * t3911 - 0.16e2 / 0.3e1 * t3913 - 0.8e1 / 0.3e1 * t3915 + t3919 + t3921 + t3923 / 0.2e1 + t3926 + t3954 / 0.2e1 + 0.44e2 / 0.9e1 * t3956 - 0.16e2 / 0.3e1 * t3958 + t4010;
  t4025 = t3239 + 0.2e1 * t3241 + t3904 + 0.2e1 * t3905 + 0.3e1 * t235 * t2054 + 0.3e1 * t350 * t1754 + t133 * t4011 + 0.1e2 / 0.3e1 * t239 * t2054 + 0.1e2 / 0.3e1 * t354 * t1754 + t136 * t4011 + 0.11e2 / 0.3e1 * t243 * t2054 + 0.11e2 / 0.3e1 * t358 * t1754 + t139 * t4011 + 0.4e1 * t247 * t2054;
  t4044 = 0.7e1 / 0.9e1 * t597 * t876 - 0.2e1 / 0.3e1 * t162 * t1941 + t33 * t4000 * t46 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t605 - 0.2e1 / 0.3e1 * t370 * t1779 + t51 * t3952 * t46 / 0.4e1;
  t4083 = -0.4e1 / 0.3e1 * t3911 - 0.8e1 / 0.3e1 * t3913 - 0.4e1 / 0.3e1 * t3915 + t3919 / 0.2e1 + t3921 / 0.2e1 + t3923 / 0.4e1 + t3926 / 0.2e1 + t3954 / 0.4e1 + 0.22e2 / 0.9e1 * t3956 - 0.8e1 / 0.3e1 * t3958 + t3963 / 0.2e1 + t3965 / 0.2e1 - 0.4e1 / 0.3e1 * t3966 - 0.4e1 / 0.3e1 * t3968 + t3971 / 0.4e1 + t3974 / 0.2e1 + t4002 / 0.4e1 + 0.22e2 / 0.9e1 * t4004 + 0.22e2 / 0.9e1 * t4006 + 0.22e2 / 0.9e1 * t4008;
  t4092 = 0.4e1 / 0.3e1 * t253 * t1964 + 0.4e1 / 0.3e1 * t379 * t1782 + t64 * t4044 / 0.2e1 + 0.3e1 / 0.2e1 * t258 * t1964 + 0.3e1 / 0.2e1 * t385 * t1782 + t68 * t4044 / 0.2e1 + 0.5e1 / 0.3e1 * t183 * t1964 + 0.5e1 / 0.3e1 * t390 * t1782 + t81 * t4044 / 0.2e1 + 0.11e2 / 0.6e1 * t188 * t1964 + 0.11e2 / 0.6e1 * t395 * t1782 + t85 * t4083 / 0.2e1 + 0.3e1 / 0.2e1 * t208 * t2018 + 0.3e1 / 0.2e1 * t400 * t1821 + t105 * t4083 / 0.2e1;
  t4122 = 0.2e1 / 0.9e1 * t973 * t608 + 0.3e1 / 0.8e1 * t976 * t608 + 0.5e1 / 0.9e1 * t981 * t608 + 0.55e2 / 0.72e2 * t985 * t608 + 0.3e1 / 0.8e1 * t988 * t631 + 0.5e1 / 0.9e1 * t991 * t631 + 0.55e2 / 0.72e2 * t994 * t631 + 0.3e1 / 0.4e1 * t997 * t551 + 0.1e2 / 0.9e1 * t1000 * t551 + 0.55e2 / 0.36e2 * t1003 * t551 + t30 * t4044 / 0.2e1 + 0.3e1 / 0.8e1 * t558 * t897 + 0.5e1 / 0.9e1 * t561 * t897 + 0.55e2 / 0.72e2 * t565 * t897;
  t4127 = t1006 * t144;
  t4129 = t1009 * t144;
  t4131 = t1012 * t144;
  t4133 = t1015 * t144;
  t4153 = 0.3e1 / 0.8e1 * t568 * t936 + 0.5e1 / 0.9e1 * t571 * t936 + 0.7e1 / 0.18e2 * t4127 + 0.8e1 / 0.9e1 * t4129 + 0.3e1 / 0.2e1 * t4131 + 0.2e2 / 0.9e1 * t4133 + 0.4e1 * t362 * t1754 + 0.5e1 / 0.3e1 * t213 * t2018 + 0.5e1 / 0.3e1 * t333 * t1821 + t110 * t4083 / 0.2e1 + 0.11e2 / 0.6e1 * t218 * t2018 + 0.11e2 / 0.6e1 * t338 * t1821 + t115 * t4083 / 0.2e1 + 0.2e1 * t223 * t2018 + 0.2e1 * t343 * t1821;
  t4175 = t119 * t4011 + 0.55e2 / 0.72e2 * t574 * t936 + 0.3e1 / 0.4e1 * t578 * t960 + 0.1e2 / 0.9e1 * t581 * t960 + 0.55e2 / 0.36e2 * t584 * t960 + 0.2e1 / 0.9e1 * t555 * t897 + 0.32e2 / 0.3e1 * t3278 + 0.12e2 * t3280 + 0.4e2 / 0.3e1 * t3282 + 0.8e1 / 0.9e1 * t3284 + 0.3e1 / 0.2e1 * t3286 + 0.2e2 / 0.9e1 * t3288 - 0.24e2 * t3290 - 0.24e2 * t3292;
  t4184 = t1009 * t682;
  t4186 = t1012 * t519;
  t4188 = t1012 * t682;
  t4190 = t1015 * t519;
  t4192 = t1015 * t682;
  t4196 = -0.24e2 * t3294 - 0.24e2 * t3298 + 0.7e1 / 0.18e2 * t3330 + 0.28e2 / 0.3e1 * t3332 + 0.28e2 / 0.3e1 * t3838 + 0.32e2 / 0.3e1 * t3840 + 0.12e2 * t3842 + 0.4e2 / 0.3e1 * t3844 + 0.8e1 / 0.3e1 * t4184 - 0.6e1 * t4186 + 0.9e1 / 0.2e1 * t4188 - 0.8e2 / 0.9e1 * t4190 + 0.2e2 / 0.3e1 * t4192 + 0.32e2 * t3857 - 0.64e2 * t3859;
  t4204 = t1006 * t519;
  t4206 = t1006 * t682;
  t4208 = t1009 * t519;
  t4215 = 0.36e2 * t3861 - 0.72e2 * t3863 + 0.4e2 * t3865 - 0.8e2 * t3867 + 0.28e2 * t3869 - 0.56e2 * t3871 - 0.14e2 / 0.9e1 * t4204 + 0.7e1 / 0.6e1 * t4206 - 0.32e2 / 0.9e1 * t4208 + 0.14e2 / 0.9e1 * t3510 + 0.7e1 / 0.6e1 * t3512 + 0.6e1 * t3514 + 0.9e1 / 0.2e1 * t3516 - 0.36e2 * t3518;
  t4227 = -0.72e2 * t3520 + 0.8e2 / 0.9e1 * t3531 + 0.2e2 / 0.3e1 * t3533 - 0.4e2 * t3535 - 0.8e2 * t3537 + t3544 + t3548 + t3552 + t3556 + 0.32e2 / 0.9e1 * t3572 + 0.8e1 / 0.3e1 * t3574 - 0.32e2 * t3576 - 0.64e2 * t3578 - 0.28e2 * t3587 - 0.56e2 * t3589;
  tv4rho42 = t4025 + t4092 + t4122 + t4153 + t4175 + t4196 + t4215 + t4227;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t4230 = t2119 * t165;
  t4232 = t2119 * t273;
  t4234 = t2122 * t165;
  t4236 = t2122 * t273;
  t4238 = t2125 * t165;
  t4240 = t2125 * t273;
  t4242 = t2128 * t165;
  t4244 = t2128 * t273;
  t4252 = t3595 + t3597 - 0.35e2 / 0.108e3 * t4230 + 0.35e2 / 0.108e3 * t4232 - 0.16e2 / 0.27e2 * t4234 + 0.16e2 / 0.27e2 * t4236 - 0.3e1 / 0.4e1 * t4238 + 0.3e1 / 0.4e1 * t4240 - 0.2e2 / 0.27e2 * t4242 + 0.2e2 / 0.27e2 * t4244 + 0.9e1 / 0.4e1 * t997 * t744 + 0.1e2 / 0.3e1 * t1000 * t744 + 0.11e2 / 0.2e1 * t358 * t2054;
  t4253 = t194 * t2205;
  t4256 = t89 * t2610 * t875;
  t4259 = t89 * t1240 * t1940;
  t4261 = t194 * t2208;
  t4264 = t89 * t712 * t2163;
  t4284 = 0.12e2 * t681 + 0.24e2 * t3371;
  t4288 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3359 * t2153 * t166 - 0.16e2 / 0.9e1 * t1926 * t519 - 0.8e1 / 0.9e1 * t1708 * t871 * t166 + 0.8e1 / 0.3e1 * t1711 * t272 * t871 + 0.4e1 / 0.3e1 * t716 * t1936 + 0.4e1 / 0.9e1 * t515 * t2159 * t166 + 0.4e1 / 0.3e1 * t42 * t4284);
  t4290 = t89 * t197 * t4288;
  t4292 = t2214 * t202;
  t4294 = t924 * t730;
  t4296 = t924 * t741;
  t4298 = t320 * t2009;
  t4300 = t320 * t2012;
  t4302 = t320 * t2015;
  t4305 = t96 * t2754 * t893;
  t4308 = t96 * t1318 * t1960;
  t4311 = t96 * t729 * t2184;
  t4333 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3389 * t2175 * t173 + 0.16e2 / 0.9e1 * t1948 * t519 - 0.8e1 / 0.9e1 * t1736 * t889 * t173 - 0.8e1 / 0.3e1 * t1739 * t272 * t889 + 0.4e1 / 0.3e1 * t733 * t1956 + 0.4e1 / 0.9e1 * t534 * t2180 * t173 - 0.4e1 / 0.3e1 * t54 * t4284);
  t4335 = t96 * t201 * t4333;
  t4337 = -0.4e1 * t4253 + 0.3e1 / 0.2e1 * t4256 + 0.3e1 / 0.2e1 * t4259 - 0.4e1 / 0.3e1 * t4261 + t4264 / 0.2e1 + t4290 / 0.2e1 - 0.616e3 / 0.27e2 * t4292 + 0.44e2 / 0.3e1 * t4294 + 0.44e2 / 0.3e1 * t4296 - 0.8e1 * t4298 - 0.4e1 * t4300 - 0.4e1 * t4302 + 0.3e1 / 0.2e1 * t4305 + 0.3e1 / 0.2e1 * t4308 + t4311 / 0.2e1 + t4335 / 0.2e1 - t3430;
  t4358 = -t162 * t2164 / 0.3e1 + t33 * t4288 * t46 / 0.4e1 - 0.7e2 / 0.27e2 * t2169 * t177 + 0.7e1 / 0.3e1 * t881 * t767 - t370 * t1961 + t51 * t4333 * t46 / 0.4e1;
  t4377 = t139 * t4337 + 0.2e1 * t247 * t2257 + 0.6e1 * t362 * t2054 + 0.55e2 / 0.12e2 * t1003 * t744 + t30 * t4358 / 0.2e1 + 0.2e1 / 0.3e1 * t253 * t2188 + 0.2e1 * t379 * t1964 + t64 * t4358 / 0.2e1 + 0.3e1 / 0.4e1 * t258 * t2188 + 0.9e1 / 0.4e1 * t385 * t1964 + t68 * t4358 / 0.2e1 + 0.5e1 / 0.6e1 * t183 * t2188 + 0.5e1 / 0.2e1 * t390 * t1964;
  t4401 = -0.2e1 * t4253 + 0.3e1 / 0.4e1 * t4256 + 0.3e1 / 0.4e1 * t4259 - 0.2e1 / 0.3e1 * t4261 + t4264 / 0.4e1 + t4290 / 0.4e1 - 0.308e3 / 0.27e2 * t4292 + 0.22e2 / 0.3e1 * t4294 + 0.22e2 / 0.3e1 * t4296 - 0.4e1 * t4298 - 0.2e1 * t4300 - 0.2e1 * t4302 + 0.3e1 / 0.4e1 * t4305 + 0.3e1 / 0.4e1 * t4308 + t4311 / 0.4e1 + t4335 / 0.4e1;
  t4422 = t81 * t4358 / 0.2e1 + 0.11e2 / 0.12e2 * t188 * t2188 + 0.11e2 / 0.4e1 * t395 * t1964 + t85 * t4401 / 0.2e1 + 0.3e1 / 0.4e1 * t208 * t2229 + 0.9e1 / 0.4e1 * t400 * t2018 + t105 * t4401 / 0.2e1 + 0.5e1 / 0.6e1 * t213 * t2229 + 0.5e1 / 0.2e1 * t333 * t2018 + t110 * t4401 / 0.2e1 + 0.11e2 / 0.12e2 * t218 * t2229 - 0.4e1 / 0.27e2 * t2271 * t180 - 0.3e1 / 0.16e2 * t2274 * t180;
  t4451 = -0.5e1 / 0.27e2 * t2277 * t180 - 0.55e2 / 0.432e3 * t2281 * t180 - 0.3e1 / 0.16e2 * t2284 * t205 - 0.5e1 / 0.27e2 * t2287 * t205 - 0.55e2 / 0.432e3 * t2292 * t205 - 0.3e1 / 0.8e1 * t2295 * t233 - 0.1e2 / 0.27e2 * t2298 * t233 - 0.55e2 / 0.216e3 * t2301 * t233 + 0.2e1 / 0.3e1 * t973 * t770 + 0.9e1 / 0.8e1 * t976 * t770 + 0.5e1 / 0.3e1 * t981 * t770 + 0.55e2 / 0.24e2 * t985 * t770 + 0.9e1 / 0.8e1 * t988 * t802 + 0.5e1 / 0.3e1 * t991 * t802;
  t4476 = 0.55e2 / 0.24e2 * t994 * t802 + 0.11e2 / 0.4e1 * t338 * t2018 + t115 * t4401 / 0.2e1 + t223 * t2229 + 0.3e1 * t343 * t2018 + t119 * t4337 + 0.3e1 / 0.2e1 * t235 * t2257 + 0.9e1 / 0.2e1 * t350 * t2054 + t133 * t4337 + 0.5e1 / 0.3e1 * t239 * t2257 + 0.5e1 * t354 * t2054 + t136 * t4337 + 0.11e2 / 0.6e1 * t243 * t2257;
  t4482 = -0.7e1 / 0.6e1 * t4127 - 0.8e1 / 0.3e1 * t4129 - 0.9e1 / 0.2e1 * t4131 - 0.2e2 / 0.3e1 * t4133 - t3830 - t3831 - t3832 - t3837 + t3839 + t3841 + t3843 + t3845 + 0.8e1 * t4184;
  t4492 = 0.27e2 / 0.2e1 * t4188 + 0.2e2 * t4192 - t3858 - 0.96e2 * t3859 - t3862 - 0.108e3 * t3863 - t3866 - 0.12e3 * t3867 - t3870 - 0.84e2 * t3871 + 0.7e1 / 0.2e1 * t4206 - t3877 - 0.36e2 * t3520;
  t4496 = -t3882 - 0.4e2 * t3537 + t3884 + t3544 + t3885 + t3548 + t3886 + t3552 + t3888 + t3556 - t3894 - 0.32e2 * t3578 - t3898 - 0.28e2 * t3589;
  tv4rho43 = t4252 + t4377 + t4422 + t4451 + t4476 + t4482 + t4492 + t4496;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4513 = t867 * t867;
  t4518 = t871 * t871;
  t4524 = 0.24e2 * t681 + 0.24e2 * t3371;
  t4528 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3359 * t4513 - 0.16e2 / 0.9e1 * t1926 * t871 + 0.4e1 / 0.3e1 * t515 * t4518 + 0.16e2 / 0.9e1 * t716 * t2159 + 0.4e1 / 0.3e1 * t42 * t4524);
  t4543 = t886 * t886;
  t4548 = t889 * t889;
  t4557 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3389 * t4543 - 0.16e2 / 0.9e1 * t1948 * t889 + 0.4e1 / 0.3e1 * t534 * t4548 + 0.16e2 / 0.9e1 * t733 * t2180 - 0.4e1 / 0.3e1 * t54 * t4524);
  t4561 = t33 * t4528 * t46 / 0.4e1 + 0.91e3 / 0.81e2 * t49 / t11 / t2211 * t57 - 0.28e3 / 0.27e2 * t2169 * t373 + 0.14e2 / 0.3e1 * t881 * t894 - 0.4e1 / 0.3e1 * t370 * t2185 + t51 * t4557 * t46 / 0.4e1;
  t4564 = 0.6e1 * t3904 + 0.12e2 * t3905 + 0.35e2 / 0.27e2 * t4230 + 0.35e2 / 0.27e2 * t4232 + 0.64e2 / 0.27e2 * t4234 + 0.64e2 / 0.27e2 * t4236 + 0.3e1 * t4238 + 0.3e1 * t4240 + 0.8e2 / 0.27e2 * t4242 + 0.8e2 / 0.27e2 * t4244 + 0.2e2 / 0.3e1 * t1000 * t960 + 0.55e2 / 0.6e1 * t1003 * t960 + t30 * t4561 / 0.2e1;
  t4579 = t875 * t875;
  t4581 = t89 * t4579 * t45;
  t4584 = t89 * t1240 * t2163;
  t4586 = t89 * t197 * t4528;
  t4592 = sigma[2] / t25 / t921 / t93 * t98;
  t4594 = t2214 * t327;
  t4596 = t924 * t930;
  t4598 = t924 * t933;
  t4600 = t320 * t2223;
  t4602 = t320 * t2226;
  t4604 = t893 * t893;
  t4606 = t96 * t4604 * t45;
  t4609 = t96 * t1318 * t2184;
  t4611 = t96 * t201 * t4557;
  t4613 = 0.3e1 / 0.4e1 * t4581 + t4584 + t4586 / 0.4e1 + 0.2618e4 / 0.81e2 * t4592 - 0.1232e4 / 0.27e2 * t4594 + 0.44e2 / 0.3e1 * t4596 + 0.44e2 / 0.3e1 * t4598 - 0.8e1 * t4600 - 0.8e1 / 0.3e1 * t4602 + 0.3e1 / 0.4e1 * t4606 + t4609 + t4611 / 0.4e1;
  t4628 = 0.8e1 / 0.3e1 * t379 * t2188 + t64 * t4561 / 0.2e1 + 0.3e1 * t385 * t2188 + t68 * t4561 / 0.2e1 + 0.1e2 / 0.3e1 * t390 * t2188 + t81 * t4561 / 0.2e1 + 0.11e2 / 0.3e1 * t395 * t2188 + t85 * t4613 / 0.2e1 + 0.3e1 * t400 * t2229 + t105 * t4613 / 0.2e1 + 0.1e2 / 0.3e1 * t333 * t2229 + t110 * t4613 / 0.2e1 - 0.55e2 / 0.108e3 * t2292 * t330 - 0.3e1 / 0.2e1 * t2295 * t348;
  t4656 = -0.4e2 / 0.27e2 * t2298 * t348 - 0.55e2 / 0.54e2 * t2301 * t348 + 0.4e1 / 0.3e1 * t973 * t897 + 0.9e1 / 0.4e1 * t976 * t897 + 0.1e2 / 0.3e1 * t981 * t897 + 0.55e2 / 0.12e2 * t985 * t897 + 0.9e1 / 0.4e1 * t988 * t936 + 0.1e2 / 0.3e1 * t991 * t936 + 0.55e2 / 0.12e2 * t994 * t936 + 0.9e1 / 0.2e1 * t997 * t960 - 0.16e2 / 0.27e2 * t2271 * t376 - 0.3e1 / 0.4e1 * t2274 * t376 - 0.2e2 / 0.27e2 * t2277 * t376;
  t4667 = 0.1e1 / t18 / t93;
  t4697 = -0.55e2 / 0.108e3 * t2281 * t376 - 0.3e1 / 0.4e1 * t2284 * t330 - 0.2e2 / 0.27e2 * t2287 * t330 + 0.2e2 / 0.81e2 * t29 * t95 * t60 + 0.9e1 / 0.32e2 * t63 * t4667 * t60 + 0.2e2 / 0.81e2 * t67 * t369 * t60 + 0.385e3 / 0.2592e4 * t71 * t1335 * t60 + 0.9e1 / 0.32e2 * t84 * t4667 * t101 + 0.2e2 / 0.81e2 * t104 * t369 * t101 + 0.385e3 / 0.2592e4 * t109 * t1335 * t101 + 0.9e1 / 0.16e2 * t118 * t4667 * t130 + 0.4e2 / 0.81e2 * t132 * t369 * t130 + 0.385e3 / 0.1296e4 * t135 * t1335 * t130 + 0.11e2 / 0.3e1 * t338 * t2229;
  t4716 = 0.3e1 / 0.2e1 * t4581 + 0.2e1 * t4584 + t4586 / 0.2e1 + 0.5236e4 / 0.81e2 * t4592 - 0.2464e4 / 0.27e2 * t4594 + 0.88e2 / 0.3e1 * t4596 + 0.88e2 / 0.3e1 * t4598 - 0.16e2 * t4600 - 0.16e2 / 0.3e1 * t4602 + 0.3e1 / 0.2e1 * t4606 + 0.2e1 * t4609 + t4611 / 0.2e1 - t3430;
  t4732 = t115 * t4613 / 0.2e1 + 0.4e1 * t343 * t2229 + t119 * t4716 + 0.6e1 * t350 * t2257 + t133 * t4716 + 0.2e2 / 0.3e1 * t354 * t2257 + t136 * t4716 + 0.22e2 / 0.3e1 * t358 * t2257 + t139 * t4716 + 0.8e1 * t362 * t2257 + 0.7e1 / 0.3e1 * t4127 + 0.16e2 / 0.3e1 * t4129 + 0.9e1 * t4131;
  t4743 = 0.4e2 / 0.3e1 * t4133 + t3291 + t3293 + t3295 + t3299 - 0.56e2 * t3838 - 0.64e2 * t3840 - 0.72e2 * t3842 - 0.8e2 * t3844 + 0.16e2 * t4184 + 0.36e2 * t4186 + 0.27e2 * t4188 + 0.16e3 / 0.3e1 * t4190 + 0.4e2 * t4192;
  t4756 = -0.192e3 * t3857 - 0.128e3 * t3859 - 0.216e3 * t3861 - 0.144e3 * t3863 - 0.24e3 * t3865 - 0.16e3 * t3867 - 0.168e3 * t3869 - 0.112e3 * t3871 + 0.28e2 / 0.3e1 * t4204 + 0.7e1 * t4206 + 0.64e2 / 0.3e1 * t4208 + t3540 + t3544;
  t4777 = t3546 + t3548 + t3550 + t3552 + t3554 + t3556 + 0.385e3 / 0.1296e4 * t1 * t3017 + 0.4e2 / 0.81e2 * t8 * t95 + 0.9e1 / 0.16e2 * t15 * t4667 + 0.4e2 / 0.81e2 * t22 * t369 + 0.385e3 / 0.1296e4 * t141 * t3017 * t145 + 0.4e2 / 0.81e2 * t147 * t95 * t145 + 0.9e1 / 0.16e2 * t150 * t4667 * t145 + 0.4e2 / 0.81e2 * t153 * t369 * t145;
  tv4rho44 = t4564 + t4628 + t4656 + t4697 + t4732 + t4743 + t4756 + t4777;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4792 = t2348 * t198;
  t4797 = t418 * t525 * t46;
  t4813 = t193 * t510 * t45;
  t4816 = t1515 * t90 * t45;
  t4823 = -0.87e2 / 0.32e2 * t2336 * t198 + 0.9e1 / 0.16e2 * t1084 * t526 - 0.35e2 / 0.12e2 * t2340 * t198 + 0.5e1 / 0.8e1 * t1088 * t526 - 0.99e2 / 0.32e2 * t2345 * t198 + 0.11e2 / 0.16e2 * t1092 * t526 - 0.13e2 / 0.4e1 * t4792 + 0.3e1 / 0.4e1 * t1096 * t526 + t1057 * t4797 / 0.4e1 + 0.9e1 / 0.32e2 * t1060 * t4797 + 0.5e1 / 0.16e2 * t1038 * t4797 + 0.11e2 / 0.32e2 * t1043 * t4797 - 0.5e1 / 0.8e1 * t2439 * t2436 - 0.7e1 / 0.12e2 * t2445 * t2436 - 0.39e2 / 0.64e2 * t2448 * t2436 - t85 * t4813 - 0.77e2 / 0.27e2 * t105 * t4816 - t115 * t4813 - 0.77e2 / 0.27e2 * t85 * t4816 - t105 * t4813;
  t4844 = t596 * t169 * t46;
  t4851 = t161 * t525 * t46;
  t4856 = t105 * t504;
  t4868 = t32 * t1476 * t46;
  t4877 = -t427 * t4851 / 0.4e1 - t430 * t4851 / 0.4e1 + 0.11e2 / 0.3e1 * t4856 * t198 + 0.3e1 / 0.8e1 * t1035 * t1525 + t1035 * t1528 / 0.8e1 - t419 * t4851 / 0.4e1 - t424 * t4851 / 0.4e1 + t419 * t4868 / 0.16e2 + t424 * t4868 / 0.16e2 + t427 * t4868 / 0.16e2 + t430 * t4868 / 0.16e2;
  t4880 = t85 * t504;
  t4888 = t110 * t504;
  t4896 = t115 * t504;
  t4905 = t1456 * t44 * t46;
  t4920 = t138 * t1068;
  t4924 = 0.7e1 / 0.12e2 * t430 * t4844 - 0.35e2 / 0.54e2 * t427 * t4905 - 0.35e2 / 0.54e2 * t430 * t4905 - 0.35e2 / 0.54e2 * t419 * t4905 - 0.35e2 / 0.54e2 * t424 * t4905 - t2383 * t526 + 0.3e1 / 0.8e1 * t1119 * t1525 + t1119 * t1528 / 0.8e1 - t2361 * t526 + 0.6e1 * t4920 + 0.11e2 / 0.16e2 * t1092 * t511;
  t4927 = t113 * t193 * t91;
  t4959 = t504 * t44;
  t4969 = 0.1232e4 / 0.27e2 * t1566;
  t4970 = -0.308e3 / 0.27e2 * t4816 + 0.44e2 / 0.3e1 * t4959 * t712 - 0.4e1 * t4813 - 0.4e1 * t2399 * t1702 + 0.3e1 / 0.2e1 * t2607 * t1702 + t1064 * t3610 / 0.2e1 + t4969;
  t4987 = 0.9e1 / 0.2e1 * t235 * t2408 + t133 * t4970 + 0.5e1 * t239 * t2408 + t136 * t4970 + 0.11e2 / 0.2e1 * t243 * t2408 + t139 * t4970 + 0.6e1 * t247 * t2408 + 0.1e2 / 0.3e1 * t581 * t1068 + 0.55e2 / 0.12e2 * t584 * t1068 + 0.9e1 / 0.4e1 * t578 * t1068 + t119 * t4970;
  tv4rho3sigma0 = 0.301e3 / 0.128e3 * t84 / t2 / t502 * t91 + 0.8921e4 / 0.3456e4 * t109 / t74 / t191 * t91 + 0.5e1 / 0.8e1 * t1088 * t511 - 0.1e2 / 0.27e2 * t1616 * t444 - 0.55e2 / 0.216e3 * t1619 * t444 - 0.3e1 / 0.8e1 * t1613 * t444 + 0.3e1 / 0.4e1 * t1096 * t511 + 0.9e1 / 0.16e2 * t1084 * t511 + 0.11e2 / 0.3e1 * t4880 * t198 - t2351 * t526 + 0.3e1 / 0.8e1 * t1029 * t1525 + t1029 * t1528 / 0.8e1 + 0.11e2 / 0.3e1 * t4888 * t198 - t2356 * t526 + 0.3e1 / 0.8e1 * t1032 * t1525 + t1032 * t1528 / 0.8e1 + 0.11e2 / 0.3e1 * t4896 * t198 + 0.7e1 / 0.12e2 * t427 * t4844 - 0.121e3 / 0.192e3 * t2442 * t2436 + 0.7e1 / 0.12e2 * t419 * t4844 + 0.7e1 / 0.12e2 * t424 * t4844 - 0.77e2 / 0.27e2 * t110 * t4816 - t110 * t4813 - 0.77e2 / 0.27e2 * t115 * t4816 + t4987 + 0.8e1 / 0.3e1 * t4927 + t4924 + t4877 + t4823 + 0.145e3 / 0.216e3 * t67 * t88 * t1040 + 0.2321e4 / 0.3456e4 * t71 * t3248 * t1040 + 0.35e2 / 0.54e2 * t29 * t2339 * t1040 + 0.85e2 / 0.128e3 * t63 * t2344 * t1040 + 0.535e3 / 0.216e3 * t104 / t502 * t91;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t4992 = t578 * t230;
  t4994 = t235 * t548;
  t4997 = 0.2464e4 / 0.27e2 * t119 * t1566;
  t5000 = t581 * t230;
  t5002 = t239 * t548;
  t5005 = 0.2464e4 / 0.27e2 * t133 * t1566;
  t5008 = t584 * t230;
  t5010 = t243 * t548;
  t5013 = 0.2464e4 / 0.27e2 * t136 * t1566;
  t5014 = t138 * t230;
  t5015 = 0.32e2 * t5014;
  t5016 = t247 * t548;
  t5019 = 0.2464e4 / 0.27e2 * t139 * t1566;
  tv4rho3sigma1 = 0.3e1 / 0.4e1 * t1613 * t128 + 0.12e2 * t4992 - 0.88e2 * t4994 + t4997 + 0.2e2 / 0.27e2 * t1616 * t128 + 0.16e3 / 0.9e1 * t5000 - 0.88e3 / 0.9e1 * t5002 + t5005 + 0.55e2 / 0.108e3 * t1619 * t128 + 0.22e3 / 0.9e1 * t5008 - 0.968e3 / 0.9e1 * t5010 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t5028 = t2510 * t202;
  t5043 = t50 * t1492 * t46;
  t5048 = 0.11e2 / 0.16e2 * t218 * t2516 - 0.5e1 / 0.216e3 * t1607 * t470 + 0.5e1 / 0.8e1 * t213 * t2516 - 0.55e2 / 0.3456e4 * t1610 * t470 + 0.3e1 / 0.4e1 * t5028 + 0.3e1 / 0.4e1 * t223 * t2516 - 0.3e1 / 0.128e3 * t1604 * t470 + 0.9e1 / 0.16e2 * t208 * t2516 + 0.3e1 / 0.8e1 * t1174 * t1531 + t1174 * t1534 / 0.8e1 + 0.9e1 / 0.32e2 * t1146 * t2547 + t460 * t5043 / 0.16e2 + 0.9e1 / 0.16e2 * t2555 * t543;
  t5053 = t571 * t95;
  t5062 = t574 * t95;
  t5079 = 0.3e1 / 0.8e1 * t1163 * t1531 + t1163 * t1534 / 0.8e1 + 0.5e1 / 0.12e2 * t5053 * t202 + 0.5e1 / 0.8e1 * t2560 * t543 + 0.3e1 / 0.8e1 * t1168 * t1531 + t1168 * t1534 / 0.8e1 + 0.55e2 / 0.96e2 * t5062 * t202 + 0.11e2 / 0.16e2 * t2565 * t543 + 0.3e1 / 0.4e1 * t2539 * t543 + 0.3e1 / 0.8e1 * t1179 * t1531 + t1179 * t1534 / 0.8e1 + 0.5e1 / 0.16e2 * t1151 * t2547 + t463 * t5043 / 0.16e2 + 0.11e2 / 0.32e2 * t1156 * t2547;
  t5083 = t568 * t95;
  t5110 = t138 * t1187;
  t5112 = t466 * t5043 / 0.16e2 + 0.9e1 / 0.32e2 * t5083 * t202 - t1589 * t454 * t457 / 0.54e2 - 0.3e1 / 0.128e3 * t1592 * t454 * t457 + t2582 * t1143 / 0.12e2 + 0.9e1 / 0.64e2 * t2585 * t1143 - 0.5e1 / 0.216e3 * t1595 * t454 * t457 - 0.55e2 / 0.3456e4 * t1601 * t454 * t457 + 0.5e1 / 0.24e2 * t2576 * t1143 + 0.55e2 / 0.192e3 * t2579 * t1143 + t1139 * t2547 / 0.4e1 + t455 * t5043 / 0.16e2 + 0.6e1 * t5110;
  t5125 = 0.3e1 / 0.2e1 * t2751 * t1730 + t1184 * t3654 / 0.2e1 + t4969;
  t5142 = -0.3e1 / 0.8e1 * t1613 * t480 - 0.1e2 / 0.27e2 * t1616 * t480 - 0.55e2 / 0.216e3 * t1619 * t480 + 0.6e1 * t247 * t2520 + t139 * t5125 + 0.9e1 / 0.4e1 * t578 * t1187 + 0.1e2 / 0.3e1 * t581 * t1187 + 0.55e2 / 0.12e2 * t584 * t1187 + 0.9e1 / 0.2e1 * t235 * t2520 + t119 * t5125 + 0.5e1 * t239 * t2520 + t133 * t5125 + 0.11e2 / 0.2e1 * t243 * t2520 + t136 * t5125;
  tv4rho3sigma2 = t5048 + t5079 + t5112 + t5142;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t5153 = t418 * t723 * t46;
  t5170 = 0.11e2 / 0.24e2 * t1092 * t713 + 0.11e2 / 0.24e2 * t1092 * t724 + t1096 * t713 / 0.2e1 + t1096 * t724 / 0.2e1 + 0.3e1 / 0.16e2 * t1060 * t5153 + 0.5e1 / 0.24e2 * t1038 * t5153 + 0.11e2 / 0.48e2 * t1043 * t5153 + 0.3e1 / 0.8e1 * t1084 * t713 + 0.3e1 / 0.8e1 * t1084 * t724 + 0.5e1 / 0.12e2 * t1088 * t713 + 0.5e1 / 0.12e2 * t1088 * t724 + t1057 * t5153 / 0.6e1;
  t5195 = t2348 * t314;
  t5197 = 0.11e2 / 0.12e2 * t400 * t2397 + 0.3e1 / 0.16e2 * t400 * t2403 + 0.55e2 / 0.54e2 * t333 * t2397 + 0.5e1 / 0.24e2 * t333 * t2403 + 0.11e2 / 0.9e1 * t343 * t2397 + t343 * t2403 / 0.4e1 - 0.121e3 / 0.576e3 * t2442 * t2725 + 0.121e3 / 0.108e3 * t338 * t2397 + 0.11e2 / 0.48e2 * t338 * t2403 - 0.29e2 / 0.32e2 * t2336 * t314 - 0.35e2 / 0.36e2 * t2340 * t314 - 0.33e2 / 0.32e2 * t2345 * t314 - 0.13e2 / 0.12e2 * t5195;
  t5211 = t333 * t193;
  t5224 = -0.7e1 / 0.36e2 * t2445 * t2725 - 0.13e2 / 0.64e2 * t2448 * t2725 - 0.5e1 / 0.24e2 * t2439 * t2725 + t1119 * t1703 / 0.8e1 + t1119 * t1706 / 0.4e1 + t1119 * t1723 / 0.8e1 - 0.1e2 / 0.9e1 * t5211 * t198 + 0.5e1 / 0.24e2 * t2652 * t526 + t1029 * t1703 / 0.8e1 + t1032 * t1703 / 0.8e1 + t1032 * t1706 / 0.4e1 + t1032 * t1723 / 0.8e1;
  t5225 = t343 * t193;
  t5237 = t32 * t1722 * t46;
  t5251 = t161 * t723 * t46;
  t5256 = -0.4e1 / 0.3e1 * t5225 * t198 + t2700 * t526 / 0.4e1 + t1035 * t1703 / 0.8e1 + t1035 * t1706 / 0.4e1 + t1035 * t1723 / 0.8e1 + t424 * t5237 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t2373 + 0.11e2 / 0.9e1 * t4856 * t314 + 0.11e2 / 0.9e1 * t4888 * t314 + 0.11e2 / 0.9e1 * t4896 * t314 - 0.11e2 / 0.36e2 * t1216 * t2367 - t430 * t5251 / 0.6e1 - 0.2e1 / 0.3e1 * t2383 * t713;
  t5283 = -0.2e1 / 0.3e1 * t2383 * t724 - 0.2e1 / 0.3e1 * t2351 * t713 - 0.2e1 / 0.3e1 * t2351 * t724 - 0.2e1 / 0.3e1 * t2356 * t713 - 0.2e1 / 0.3e1 * t2356 * t724 - 0.2e1 / 0.3e1 * t2361 * t713 - 0.2e1 / 0.3e1 * t2361 * t724 - t424 * t5251 / 0.6e1 - 0.5e1 / 0.18e2 * t1211 * t2367 - t427 * t5251 / 0.6e1 + t427 * t5237 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t2373;
  t5286 = t400 * t193;
  t5294 = t338 * t193;
  t5308 = t596 * t313 * t46;
  t5313 = t430 * t5237 / 0.16e2 - t5286 * t198 + 0.3e1 / 0.16e2 * t2645 * t526 + t1029 * t1706 / 0.4e1 + t1029 * t1723 / 0.8e1 - 0.11e2 / 0.9e1 * t5294 * t198 + 0.11e2 / 0.48e2 * t2659 * t526 + t1199 * t2373 / 0.12e2 + t419 * t5237 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t2373 + 0.7e1 / 0.27e2 * t1199 * t2426 + 0.7e1 / 0.36e2 * t419 * t5308 + 0.7e1 / 0.24e2 * t1206 * t2426;
  t5333 = t138 * t1243;
  t5351 = 0.44e2 / 0.9e1 * t4959 * t1240 - 0.8e1 / 0.3e1 * t193 * t169 * t1240 - 0.8e1 / 0.3e1 * t2399 * t2610 + t88 * t525 * t1240 / 0.2e1 + t2607 * t2610 + t1064 * t45 * t1722 / 0.2e1 + t4969;
  t5353 = 0.7e1 / 0.36e2 * t424 * t5308 + 0.35e2 / 0.108e3 * t1211 * t2426 + 0.7e1 / 0.36e2 * t427 * t5308 + 0.77e2 / 0.216e3 * t1216 * t2426 - 0.2e1 / 0.9e1 * t1199 * t2367 - t419 * t5251 / 0.6e1 - t1206 * t2367 / 0.4e1 + 0.7e1 / 0.36e2 * t430 * t5308 + 0.11e2 / 0.9e1 * t4880 * t314 + 0.2e1 * t5333 + 0.5e1 / 0.3e1 * t354 * t2408 + t133 * t5351;
  t5377 = 0.1e2 / 0.3e1 * t239 * t2613 + 0.11e2 / 0.6e1 * t358 * t2408 + t136 * t5351 + 0.11e2 / 0.3e1 * t243 * t2613 + 0.2e1 * t362 * t2408 + t139 * t5351 + 0.4e1 * t247 * t2613 + 0.3e1 / 0.2e1 * t350 * t2408 + t119 * t5351 + 0.3e1 * t235 * t2613 + 0.3e1 / 0.4e1 * t578 * t1243 + 0.1e2 / 0.9e1 * t581 * t1243 + 0.55e2 / 0.36e2 * t584 * t1243;
  tv4rho3sigma3 = t5170 + t5197 + t5224 + t5256 + t5283 + t5313 + t5353 + t5377;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t5380 = t350 * t548;
  t5384 = t354 * t548;
  t5388 = t358 * t548;
  t5392 = t362 * t548;
  t5394 = 0.32e2 / 0.3e1 * t5014;
  tv4rho3sigma4 = -0.88e2 / 0.3e1 * t5380 + 0.4e1 * t4992 - 0.176e3 / 0.3e1 * t4994 + t4997 - 0.88e3 / 0.27e2 * t5384 + 0.16e3 / 0.27e2 * t5000 - 0.176e4 / 0.27e2 * t5002 + t5005 - 0.968e3 / 0.27e2 * t5388 + 0.22e3 / 0.27e2 * t5008 - 0.1936e4 / 0.27e2 * t5010 + t5013 - 0.352e3 / 0.9e1 * t5392 + t5394 - 0.704e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5405 = t454 * t542 * t46;
  t5420 = 0.3e1 / 0.16e2 * t1336 * t543 + 0.5e1 / 0.24e2 * t1340 * t543 + 0.11e2 / 0.48e2 * t1344 * t543 + t1348 * t543 / 0.4e1 + t1303 * t5405 / 0.12e2 + 0.3e1 / 0.32e2 * t1308 * t5405 + 0.5e1 / 0.48e2 * t1311 * t5405 + 0.11e2 / 0.96e2 * t1314 * t5405 - t568 * t1292 / 0.8e1 - 0.5e1 / 0.27e2 * t571 * t1292 - 0.55e2 / 0.216e3 * t574 * t1292;
  t5422 = t319 * t529 * t45;
  t5429 = t2510 * t327;
  t5436 = t369 * t542 * t46;
  t5440 = t50 * t1750 * t46;
  t5451 = -t105 * t5422 / 0.3e1 - t110 * t5422 / 0.3e1 - t85 * t5422 / 0.3e1 + t5429 / 0.4e1 - t115 * t5422 / 0.3e1 - 0.5e1 / 0.18e2 * t1151 * t2795 - t466 * t5436 / 0.12e2 + t460 * t5440 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t2811 + t1174 * t1731 / 0.8e1 + t1174 * t1734 / 0.4e1 + 0.11e2 / 0.24e2 * t2565 * t730;
  t5459 = t223 * t319;
  t5476 = t1174 * t1751 / 0.8e1 + 0.11e2 / 0.24e2 * t2565 * t741 - t2785 * t543 / 0.3e1 - 0.4e1 / 0.3e1 * t5459 * t202 + t1179 * t1731 / 0.8e1 + t1179 * t1734 / 0.4e1 + t2539 * t730 / 0.2e1 + t1179 * t1751 / 0.8e1 + t2539 * t741 / 0.2e1 - 0.11e2 / 0.36e2 * t1156 * t2795 + t2582 * t1264 / 0.36e2;
  t5499 = t213 * t319;
  t5502 = 0.55e2 / 0.576e3 * t2579 * t1264 + 0.3e1 / 0.32e2 * t5083 * t327 + 0.5e1 / 0.36e2 * t5053 * t327 - 0.5e1 / 0.54e2 * t2576 * t1282 + 0.3e1 / 0.64e2 * t2585 * t1264 + 0.5e1 / 0.72e2 * t2576 * t1264 + 0.55e2 / 0.288e3 * t5062 * t327 - t2582 * t1282 / 0.27e2 - t2585 * t1282 / 0.16e2 - 0.55e2 / 0.432e3 * t2579 * t1282 - t2835 * t543 / 0.3e1 - 0.1e2 / 0.9e1 * t5499 * t202;
  t5517 = t218 * t319;
  t5528 = t1168 * t1731 / 0.8e1 + t1168 * t1734 / 0.4e1 + 0.5e1 / 0.12e2 * t2560 * t730 + t1168 * t1751 / 0.8e1 + 0.5e1 / 0.12e2 * t2560 * t741 - t2844 * t543 / 0.3e1 - 0.11e2 / 0.9e1 * t5517 * t202 + t455 * t5440 / 0.16e2 + t1139 * t2811 / 0.6e1 + t463 * t5440 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t2811;
  t5535 = t208 * t319;
  t5553 = t466 * t5440 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t2811 - t2826 * t543 / 0.3e1 - t5535 * t202 + t1163 * t1731 / 0.8e1 + t1163 * t1734 / 0.4e1 + 0.3e1 / 0.8e1 * t2555 * t730 + t1163 * t1751 / 0.8e1 + 0.3e1 / 0.8e1 * t2555 * t741 - t455 * t5436 / 0.12e2 - 0.2e1 / 0.9e1 * t1139 * t2795 - t460 * t5436 / 0.12e2;
  t5559 = t138 * t1321;
  t5570 = t113 * t319 * t98;
  t5578 = -t1146 * t2795 / 0.4e1 - t463 * t5436 / 0.12e2 + 0.2e1 * t5559 + 0.3e1 / 0.16e2 * t1336 * t530 + 0.5e1 / 0.24e2 * t1340 * t530 + 0.11e2 / 0.48e2 * t1344 * t530 + t1348 * t530 / 0.4e1 - t5570 / 0.3e1 + 0.3e1 / 0.4e1 * t578 * t1321 + 0.1e2 / 0.9e1 * t581 * t1321 + 0.55e2 / 0.36e2 * t584 * t1321;
  t5593 = -0.4e1 / 0.3e1 * t5422 - 0.4e1 / 0.3e1 * t2748 * t1730 + t95 * t542 * t1318 / 0.2e1 + t2751 * t2754 + t1184 * t45 * t1750 / 0.2e1 + t4969;
  t5610 = 0.3e1 * t235 * t2757 + 0.3e1 / 0.2e1 * t350 * t2520 + t133 * t5593 + 0.1e2 / 0.3e1 * t239 * t2757 + 0.5e1 / 0.3e1 * t354 * t2520 + t136 * t5593 + 0.11e2 / 0.3e1 * t243 * t2757 + 0.11e2 / 0.6e1 * t358 * t2520 + t139 * t5593 + 0.4e1 * t247 * t2757 + 0.2e1 * t362 * t2520 + t119 * t5593;
  tv4rho3sigma5 = t5420 + t5451 + t5476 + t5502 + t5528 + t5553 + t5578 + t5610;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5616 = t193 * t914 * t45;
  t5632 = t418 * t875 * t46;
  t5639 = -t988 * t1047 / 0.8e1 - t85 * t5616 / 0.3e1 - 0.5e1 / 0.27e2 * t991 * t1047 - t105 * t5616 / 0.3e1 - t110 * t5616 / 0.3e1 - t115 * t5616 / 0.3e1 - 0.55e2 / 0.216e3 * t994 * t1047 + 0.5e1 / 0.24e2 * t1088 * t918 + t1057 * t5632 / 0.12e2 + 0.11e2 / 0.48e2 * t1092 * t918 + t1096 * t918 / 0.4e1;
  t5652 = t161 * t875 * t46;
  t5665 = 0.3e1 / 0.32e2 * t1060 * t5632 + 0.5e1 / 0.48e2 * t1038 * t5632 + 0.11e2 / 0.96e2 * t1043 * t5632 + 0.3e1 / 0.16e2 * t1084 * t918 + t4792 / 0.4e1 - t2361 * t918 / 0.3e1 - t424 * t5652 / 0.12e2 + 0.11e2 / 0.24e2 * t2659 * t724 + t1032 * t1992 / 0.4e1 + t1032 * t1997 / 0.8e1 + t1032 * t2000 / 0.8e1 + t2700 * t713 / 0.2e1;
  t5676 = t32 * t1940 * t46;
  t5691 = t2700 * t724 / 0.2e1 + t1035 * t1992 / 0.4e1 + t1035 * t1997 / 0.8e1 + t1035 * t2000 / 0.8e1 + t424 * t5676 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t2633 - 0.2e1 / 0.9e1 * t1199 * t2669 - t419 * t5652 / 0.12e2 - t1206 * t2669 / 0.4e1 - t2943 * t1100 / 0.27e2 - t2946 * t1100 / 0.16e2;
  t5715 = -0.5e1 / 0.54e2 * t2949 * t1100 - 0.55e2 / 0.432e3 * t2952 * t1100 - 0.5e1 / 0.18e2 * t1211 * t2669 - t427 * t5652 / 0.12e2 - 0.11e2 / 0.36e2 * t1216 * t2669 - t430 * t5652 / 0.12e2 - t5286 * t314 - t2383 * t918 / 0.3e1 - 0.1e2 / 0.9e1 * t5211 * t314 - t2351 * t918 / 0.3e1 - 0.11e2 / 0.9e1 * t5294 * t314 - t2356 * t918 / 0.3e1;
  t5720 = t994 * t88;
  t5741 = -0.4e1 / 0.3e1 * t5225 * t314 + 0.55e2 / 0.288e3 * t5720 * t198 + t1199 * t2633 / 0.6e1 + t419 * t5676 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t2633 + t2943 * t1110 / 0.36e2 + 0.3e1 / 0.64e2 * t2946 * t1110 + 0.5e1 / 0.72e2 * t2949 * t1110 + 0.55e2 / 0.576e3 * t2952 * t1110 + t427 * t5676 / 0.16e2 + 0.11e2 / 0.48e2 * t1216 * t2633;
  t5744 = t988 * t88;
  t5757 = t991 * t88;
  t5768 = t430 * t5676 / 0.16e2 + 0.3e1 / 0.32e2 * t5744 * t198 + 0.3e1 / 0.8e1 * t2645 * t713 + 0.3e1 / 0.8e1 * t2645 * t724 + t1119 * t1992 / 0.4e1 + t1119 * t1997 / 0.8e1 + t1119 * t2000 / 0.8e1 + 0.5e1 / 0.36e2 * t5757 * t198 + 0.5e1 / 0.12e2 * t2652 * t713 + 0.5e1 / 0.12e2 * t2652 * t724 + t1029 * t1992 / 0.4e1 + 0.11e2 / 0.24e2 * t2659 * t713;
  t5787 = t88 * t313;
  t5796 = -0.4e1 / 0.3e1 * t5616 + t5787 * t2610 - 0.4e1 / 0.3e1 * t2399 * t2894 + t2607 * t2894 / 0.2e1 + t1064 * t45 * t1940 / 0.2e1 + t4969;
  t5800 = t1029 * t1997 / 0.8e1 + t1029 * t2000 / 0.8e1 + 0.2e1 * t4920 + 0.11e2 / 0.48e2 * t1092 * t915 + t1096 * t915 / 0.4e1 + 0.3e1 / 0.16e2 * t1084 * t915 + 0.5e1 / 0.24e2 * t1088 * t915 - t4927 / 0.3e1 + 0.4e1 * t362 * t2613 + t139 * t5796 + 0.2e1 * t247 * t2897;
  t5822 = 0.3e1 * t350 * t2613 + t119 * t5796 + 0.3e1 / 0.2e1 * t235 * t2897 + 0.1e2 / 0.3e1 * t354 * t2613 + t133 * t5796 + 0.5e1 / 0.3e1 * t239 * t2897 + 0.3e1 / 0.4e1 * t997 * t1068 + 0.1e2 / 0.9e1 * t1000 * t1068 + 0.55e2 / 0.36e2 * t1003 * t1068 + 0.11e2 / 0.3e1 * t358 * t2613 + t136 * t5796 + 0.11e2 / 0.6e1 * t243 * t2897;
  tv4rho3sigma6 = t5639 + t5665 + t5691 + t5715 + t5741 + t5768 + t5800 + t5822;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t5825 = t997 * t230;
  t5829 = t1000 * t230;
  t5833 = t1003 * t230;
  tv4rho3sigma7 = 0.4e1 * t5825 - 0.176e3 / 0.3e1 * t5380 - 0.88e2 / 0.3e1 * t4994 + t4997 + 0.16e3 / 0.27e2 * t5829 - 0.176e4 / 0.27e2 * t5384 - 0.88e3 / 0.27e2 * t5002 + t5005 + 0.22e3 / 0.27e2 * t5833 - 0.1936e4 / 0.27e2 * t5388 - 0.968e3 / 0.27e2 * t5010 + t5013 + t5394 - 0.704e3 / 0.9e1 * t5392 - 0.352e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5852 = t454 * t740 * t46;
  t5865 = 0.121e3 / 0.108e3 * t218 * t2986 - 0.29e2 / 0.32e2 * t3023 * t202 - 0.35e2 / 0.36e2 * t3012 * t202 - 0.33e2 / 0.32e2 * t3018 * t202 - 0.5e1 / 0.24e2 * t3089 * t2863 - 0.121e3 / 0.576e3 * t3092 * t2863 + t1303 * t5852 / 0.6e1 + 0.3e1 / 0.16e2 * t1308 * t5852 + 0.5e1 / 0.24e2 * t1311 * t5852 + 0.11e2 / 0.48e2 * t1314 * t5852 + 0.11e2 / 0.48e2 * t218 * t2991 + 0.11e2 / 0.9e1 * t223 * t2986;
  t5892 = t223 * t2991 / 0.4e1 + 0.11e2 / 0.12e2 * t208 * t2986 + 0.3e1 / 0.16e2 * t208 * t2991 + 0.55e2 / 0.54e2 * t213 * t2986 + 0.5e1 / 0.24e2 * t213 * t2991 + 0.3e1 / 0.8e1 * t1336 * t730 + 0.3e1 / 0.8e1 * t1336 * t741 + 0.5e1 / 0.12e2 * t1340 * t730 + 0.5e1 / 0.12e2 * t1340 * t741 + 0.11e2 / 0.24e2 * t1344 * t730 + 0.11e2 / 0.24e2 * t1344 * t741 + t1348 * t730 / 0.2e1 + t1348 * t741 / 0.2e1;
  t5900 = t50 * t1960 * t46;
  t5905 = t85 * t923;
  t5919 = -0.7e1 / 0.36e2 * t3082 * t2863 - 0.13e2 / 0.64e2 * t3085 * t2863 - 0.13e2 / 0.12e2 * t5028 + t466 * t5900 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t3033 + 0.11e2 / 0.9e1 * t5905 * t202 - 0.2e1 / 0.3e1 * t2826 * t730 - 0.2e1 / 0.3e1 * t2826 * t741 - t5535 * t327 + t1163 * t2009 / 0.4e1 + t1163 * t2012 / 0.8e1 + t1163 * t2015 / 0.8e1;
  t5928 = t115 * t923;
  t5946 = t880 * t176 * t46;
  t5949 = t1174 * t2009 / 0.4e1 + t1174 * t2012 / 0.8e1 + t1174 * t2015 / 0.8e1 + 0.11e2 / 0.48e2 * t2565 * t933 + 0.11e2 / 0.9e1 * t5928 * t202 - 0.2e1 / 0.3e1 * t2785 * t730 - 0.2e1 / 0.3e1 * t2785 * t741 - 0.4e1 / 0.3e1 * t5459 * t327 + t1179 * t2009 / 0.4e1 + t1179 * t2012 / 0.8e1 + t1179 * t2015 / 0.8e1 + t2539 * t933 / 0.4e1 + 0.7e1 / 0.36e2 * t455 * t5946;
  t5967 = t369 * t740 * t46;
  t5978 = 0.7e1 / 0.27e2 * t1139 * t3055 + 0.7e1 / 0.36e2 * t460 * t5946 + 0.7e1 / 0.24e2 * t1146 * t3055 + 0.7e1 / 0.36e2 * t463 * t5946 + 0.35e2 / 0.108e3 * t1151 * t3055 + 0.7e1 / 0.36e2 * t466 * t5946 + 0.77e2 / 0.216e3 * t1156 * t3055 - t455 * t5967 / 0.6e1 - 0.2e1 / 0.9e1 * t1139 * t3065 - t460 * t5967 / 0.6e1 - t1146 * t3065 / 0.4e1 - t463 * t5967 / 0.6e1;
  t5987 = t105 * t923;
  t6004 = t110 * t923;
  t6007 = -0.5e1 / 0.18e2 * t1151 * t3065 - t466 * t5967 / 0.6e1 - 0.11e2 / 0.36e2 * t1156 * t3065 + 0.3e1 / 0.16e2 * t2555 * t933 + 0.11e2 / 0.9e1 * t5987 * t202 - 0.2e1 / 0.3e1 * t2835 * t730 - 0.2e1 / 0.3e1 * t2835 * t741 - 0.1e2 / 0.9e1 * t5499 * t327 + t1168 * t2009 / 0.4e1 + t1168 * t2012 / 0.8e1 + t1168 * t2015 / 0.8e1 + 0.5e1 / 0.24e2 * t2560 * t933 + 0.11e2 / 0.9e1 * t6004 * t202;
  t6028 = t923 * t56;
  t6036 = t95 * t326;
  t6043 = 0.44e2 / 0.9e1 * t6028 * t729 - 0.8e1 / 0.3e1 * t319 * t176 * t1318 - 0.8e1 / 0.3e1 * t2748 * t2754 + t6036 * t2754 + t2751 * t2993 / 0.2e1 + t1184 * t45 * t1960 / 0.2e1 + t4969;
  t6047 = -0.2e1 / 0.3e1 * t2844 * t730 - 0.2e1 / 0.3e1 * t2844 * t741 - 0.11e2 / 0.9e1 * t5517 * t327 + t455 * t5900 / 0.16e2 + t1139 * t3033 / 0.12e2 + t460 * t5900 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t3033 + t463 * t5900 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t3033 + 0.2e1 * t5110 + t136 * t6043 + 0.11e2 / 0.6e1 * t243 * t2996;
  t6071 = 0.11e2 / 0.3e1 * t358 * t2757 + t139 * t6043 + 0.2e1 * t247 * t2996 + 0.4e1 * t362 * t2757 + t119 * t6043 + 0.3e1 / 0.2e1 * t235 * t2996 + 0.3e1 * t350 * t2757 + 0.3e1 / 0.4e1 * t997 * t1187 + 0.1e2 / 0.9e1 * t1000 * t1187 + 0.55e2 / 0.36e2 * t1003 * t1187 + t133 * t6043 + 0.5e1 / 0.3e1 * t239 * t2996 + 0.1e2 / 0.3e1 * t354 * t2757;
  tv4rho3sigma8 = t5865 + t5892 + t5919 + t5949 + t5978 + t6007 + t6047 + t6071;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t6100 = 0.5e1 / 0.8e1 * t333 * t2892 - 0.55e2 / 0.3456e4 * t2292 * t434 - 0.3e1 / 0.128e3 * t2284 * t434 + 0.9e1 / 0.16e2 * t400 * t2892 - 0.5e1 / 0.216e3 * t2287 * t434 + 0.11e2 / 0.16e2 * t338 * t2892 + 0.3e1 / 0.4e1 * t343 * t2892 + 0.9e1 / 0.16e2 * t2645 * t918 + 0.3e1 / 0.8e1 * t1119 * t2205 + t1119 * t2208 / 0.8e1 + 0.11e2 / 0.16e2 * t2659 * t918 + 0.3e1 / 0.8e1 * t1032 * t2205 + t1032 * t2208 / 0.8e1;
  t6132 = 0.3e1 / 0.4e1 * t2700 * t918 + 0.3e1 / 0.8e1 * t1035 * t2205 + t1035 * t2208 / 0.8e1 + 0.55e2 / 0.96e2 * t5720 * t314 + 0.3e1 / 0.4e1 * t5195 + t2943 * t1203 / 0.12e2 + 0.9e1 / 0.64e2 * t2946 * t1203 - t2271 * t418 * t421 / 0.54e2 - 0.3e1 / 0.128e3 * t2274 * t418 * t421 - 0.5e1 / 0.216e3 * t2277 * t418 * t421 - 0.55e2 / 0.3456e4 * t2281 * t418 * t421 + 0.5e1 / 0.24e2 * t2949 * t1203 + 0.55e2 / 0.192e3 * t2952 * t1203 + 0.5e1 / 0.12e2 * t5757 * t314;
  t6143 = t32 * t2163 * t46;
  t6161 = 0.5e1 / 0.8e1 * t2652 * t918 + 0.3e1 / 0.8e1 * t1029 * t2205 + t1029 * t2208 / 0.8e1 + t1199 * t2917 / 0.4e1 + t419 * t6143 / 0.16e2 + t424 * t6143 / 0.16e2 + 0.9e1 / 0.32e2 * t1206 * t2917 + 0.5e1 / 0.16e2 * t1211 * t2917 + t427 * t6143 / 0.16e2 + 0.11e2 / 0.32e2 * t1216 * t2917 + t430 * t6143 / 0.16e2 + 0.9e1 / 0.32e2 * t5744 * t314 + 0.6e1 * t5333;
  t6167 = 0.3e1 / 0.2e1 * t5787 * t2894 + t1064 * t45 * t2163 / 0.2e1 + t4969;
  t6192 = t133 * t6167 + 0.9e1 / 0.4e1 * t997 * t1243 + 0.1e2 / 0.3e1 * t1000 * t1243 + 0.55e2 / 0.12e2 * t1003 * t1243 + 0.11e2 / 0.2e1 * t358 * t2897 + t136 * t6167 + 0.6e1 * t362 * t2897 + t139 * t6167 + 0.9e1 / 0.2e1 * t350 * t2897 + t119 * t6167 + 0.5e1 * t354 * t2897 - 0.3e1 / 0.8e1 * t2295 * t444 - 0.1e2 / 0.27e2 * t2298 * t444 - 0.55e2 / 0.216e3 * t2301 * t444;
  tv4rho3sigma9 = t6100 + t6132 + t6161 + t6192;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.3e1 / 0.4e1 * t2295 * t128 + 0.12e2 * t5825 - 0.88e2 * t5380 + t4997 + 0.2e2 / 0.27e2 * t2298 * t128 + 0.16e3 / 0.9e1 * t5829 - 0.88e3 / 0.9e1 * t5384 + t5005 + 0.55e2 / 0.108e3 * t2301 * t128 + 0.22e3 / 0.9e1 * t5833 - 0.968e3 / 0.9e1 * t5388 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5392 + t5019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t6220 = t454 * t893 * t46;
  t6230 = t2213 * t97 * t45;
  t6234 = t319 * t929 * t45;
  t6253 = 0.11e2 / 0.16e2 * t1344 * t933 + 0.3e1 / 0.4e1 * t1348 * t933 - 0.7e1 / 0.12e2 * t3082 * t3096 - 0.39e2 / 0.64e2 * t3085 * t3096 - 0.5e1 / 0.8e1 * t3089 * t3096 - 0.121e3 / 0.192e3 * t3092 * t3096 + t1303 * t6220 / 0.4e1 + 0.9e1 / 0.32e2 * t1308 * t6220 + 0.5e1 / 0.16e2 * t1311 * t6220 + 0.11e2 / 0.32e2 * t1314 * t6220 - 0.77e2 / 0.27e2 * t105 * t6230 - t105 * t6234 - 0.77e2 / 0.27e2 * t110 * t6230 - 0.77e2 / 0.27e2 * t85 * t6230 - t85 * t6234 + 0.85e2 / 0.128e3 * t63 * t3017 * t1305 + 0.145e3 / 0.216e3 * t67 * t95 * t1305 + 0.2321e4 / 0.3456e4 * t71 * t4667 * t1305 - t110 * t6234 - 0.77e2 / 0.27e2 * t115 * t6230;
  t6270 = t2168 * t56 * t46;
  t6282 = t369 * t893 * t46;
  t6298 = -0.35e2 / 0.54e2 * t463 * t6270 - 0.35e2 / 0.54e2 * t466 * t6270 - t2844 * t933 - t455 * t6282 / 0.4e1 - t460 * t6282 / 0.4e1 - t463 * t6282 / 0.4e1 - t466 * t6282 / 0.4e1 - t2835 * t933 + 0.3e1 / 0.8e1 * t1168 * t2223 + t1168 * t2226 / 0.8e1 + 0.11e2 / 0.3e1 * t6004 * t327;
  t6307 = t50 * t2184 * t46;
  t6329 = t880 * t326 * t46;
  t6348 = 0.3e1 / 0.8e1 * t1174 * t2223 + t1174 * t2226 / 0.8e1 + 0.11e2 / 0.3e1 * t5928 * t327 + 0.7e1 / 0.12e2 * t455 * t6329 + 0.7e1 / 0.12e2 * t460 * t6329 + 0.7e1 / 0.12e2 * t463 * t6329 + 0.7e1 / 0.12e2 * t466 * t6329 + t1163 * t2226 / 0.8e1 + 0.11e2 / 0.3e1 * t5987 * t327 + 0.6e1 * t5559 + 0.301e3 / 0.128e3 * t84 / t4 / t921 * t98;
  t6388 = -0.308e3 / 0.27e2 * t6230 + 0.44e2 / 0.3e1 * t6028 * t1318 - 0.4e1 * t6234 - 0.4e1 * t2748 * t2993 + 0.3e1 / 0.2e1 * t6036 * t2993 + t1184 * t45 * t2184 / 0.2e1 + t4969;
  t6405 = 0.5e1 * t354 * t2996 + t136 * t6388 + 0.11e2 / 0.2e1 * t358 * t2996 + t139 * t6388 + 0.6e1 * t362 * t2996 + t119 * t6388 + 0.9e1 / 0.2e1 * t350 * t2996 + 0.9e1 / 0.4e1 * t997 * t1321 + 0.1e2 / 0.3e1 * t1000 * t1321 + 0.55e2 / 0.12e2 * t1003 * t1321 + t133 * t6388;
  tv4rho3sigma11 = t6405 - 0.35e2 / 0.12e2 * t3012 * t327 - 0.99e2 / 0.32e2 * t3018 * t327 + 0.9e1 / 0.16e2 * t1336 * t933 + 0.5e1 / 0.8e1 * t1340 * t933 - 0.35e2 / 0.54e2 * t455 * t6270 - 0.35e2 / 0.54e2 * t460 * t6270 - t115 * t6234 + 0.11e2 / 0.16e2 * t1344 * t930 + 0.3e1 / 0.4e1 * t1348 * t930 - 0.3e1 / 0.8e1 * t2295 * t480 - 0.1e2 / 0.27e2 * t2298 * t480 - 0.55e2 / 0.216e3 * t2301 * t480 + 0.9e1 / 0.16e2 * t1336 * t930 + 0.5e1 / 0.8e1 * t1340 * t930 - t2785 * t933 + 0.3e1 / 0.8e1 * t1179 * t2223 + t1179 * t2226 / 0.8e1 + t455 * t6307 / 0.16e2 + t460 * t6307 / 0.16e2 + t463 * t6307 / 0.16e2 + t466 * t6307 / 0.16e2 + 0.11e2 / 0.3e1 * t5905 * t327 - t2826 * t933 + 0.3e1 / 0.8e1 * t1163 * t2223 - 0.87e2 / 0.32e2 * t3023 * t327 + t6348 + t6298 + t6253 + 0.8921e4 / 0.3456e4 * t109 / t78 / t317 * t98 + 0.8e1 / 0.3e1 * t5570 - 0.13e2 / 0.4e1 * t5429 + 0.35e2 / 0.54e2 * t29 * t3011 * t1305 + 0.535e3 / 0.216e3 * t104 / t921 * t98;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t6409 = t1353 * t169 * t46;
  tv4rho2sigma20 = -t1057 * t6409 / 0.12e2 - 0.3e1 / 0.32e2 * t1060 * t6409 - 0.5e1 / 0.48e2 * t1038 * t6409 - 0.11e2 / 0.96e2 * t1043 * t6409 + t1360 * t2367 / 0.12e2 - t1360 * t2373 / 0.32e2 + 0.7e1 / 0.72e2 * t2445 * t3124 + t1354 * t2367 / 0.12e2 - t1354 * t2373 / 0.32e2 + 0.13e2 / 0.128e3 * t2448 * t3124 + t1356 * t2367 / 0.12e2 - t1356 * t2373 / 0.32e2 + 0.5e1 / 0.48e2 * t2439 * t3124 + t1358 * t2367 / 0.12e2 - t1358 * t2373 / 0.32e2 + 0.121e3 / 0.1152e4 * t2442 * t3124 - 0.7e1 / 0.72e2 * t1358 * t2426 - 0.7e1 / 0.72e2 * t1360 * t2426 - 0.7e1 / 0.72e2 * t1354 * t2426 - 0.7e1 / 0.72e2 * t1356 * t2426;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = -t555 * t1364 * t457 / 0.72e2 - t3149 * t1143 / 0.12e2 - t1365 * t2547 / 0.32e2 - 0.3e1 / 0.128e3 * t558 * t1364 * t457 - 0.3e1 / 0.32e2 * t3154 * t1143 - t1367 * t2547 / 0.32e2 - 0.5e1 / 0.144e3 * t561 * t1364 * t457 - 0.5e1 / 0.48e2 * t3159 * t1143 - t1369 * t2547 / 0.32e2 - 0.55e2 / 0.1152e4 * t565 * t1364 * t457 - 0.11e2 / 0.96e2 * t3164 * t1143 - t1371 * t2547 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6483 = t1353 * t313 * t46;
  tv4rho2sigma26 = t3169 * t1100 / 0.18e2 - t3169 * t1110 / 0.24e2 - t1057 * t6483 / 0.24e2 + t1354 * t2669 / 0.24e2 - t1354 * t2633 / 0.32e2 + t3174 * t1100 / 0.16e2 - 0.3e1 / 0.64e2 * t3174 * t1110 - 0.3e1 / 0.64e2 * t1060 * t6483 + t1356 * t2669 / 0.24e2 - t1356 * t2633 / 0.32e2 + 0.5e1 / 0.72e2 * t3179 * t1100 - 0.5e1 / 0.96e2 * t3179 * t1110 - 0.5e1 / 0.96e2 * t1038 * t6483 + t1358 * t2669 / 0.24e2 - t1358 * t2633 / 0.32e2 + 0.11e2 / 0.144e3 * t3184 * t1100 - 0.11e2 / 0.192e3 * t3184 * t1110 - 0.11e2 / 0.192e3 * t1043 * t6483 + t1360 * t2669 / 0.24e2 - t1360 * t2633 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6521 = t1364 * t176 * t46;
  tv4rho2sigma211 = -t1303 * t6521 / 0.24e2 + t3149 * t1282 / 0.18e2 + t1365 * t2795 / 0.24e2 - t3149 * t1264 / 0.24e2 - t1365 * t2811 / 0.32e2 - 0.3e1 / 0.64e2 * t1308 * t6521 + t3154 * t1282 / 0.16e2 + t1367 * t2795 / 0.24e2 - 0.3e1 / 0.64e2 * t3154 * t1264 - t1367 * t2811 / 0.32e2 - 0.5e1 / 0.96e2 * t1311 * t6521 + 0.5e1 / 0.72e2 * t3159 * t1282 + t1369 * t2795 / 0.24e2 - 0.5e1 / 0.96e2 * t3159 * t1264 - t1369 * t2811 / 0.32e2 - 0.11e2 / 0.192e3 * t1314 * t6521 + 0.11e2 / 0.144e3 * t3164 * t1282 + t1371 * t2795 / 0.24e2 - 0.11e2 / 0.192e3 * t3164 * t1264 - t1371 * t2811 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = -t973 * t1353 * t421 / 0.72e2 - t3169 * t1203 / 0.12e2 - t1354 * t2917 / 0.32e2 - 0.3e1 / 0.128e3 * t976 * t1353 * t421 - 0.3e1 / 0.32e2 * t3174 * t1203 - t1356 * t2917 / 0.32e2 - 0.5e1 / 0.144e3 * t981 * t1353 * t421 - 0.5e1 / 0.48e2 * t3179 * t1203 - t1358 * t2917 / 0.32e2 - 0.55e2 / 0.1152e4 * t985 * t1353 * t421 - 0.11e2 / 0.96e2 * t3184 * t1203 - t1360 * t2917 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6615 = t1364 * t326 * t46;
  tv4rho2sigma217 = t1367 * t3065 / 0.12e2 - t1367 * t3033 / 0.32e2 + 0.5e1 / 0.48e2 * t3089 * t3190 + t1369 * t3065 / 0.12e2 - t1369 * t3033 / 0.32e2 + 0.121e3 / 0.1152e4 * t3092 * t3190 + t1371 * t3065 / 0.12e2 - t1371 * t3033 / 0.32e2 + 0.7e1 / 0.72e2 * t3082 * t3190 + t1365 * t3065 / 0.12e2 - t1365 * t3033 / 0.32e2 + 0.13e2 / 0.128e3 * t3085 * t3190 - t1303 * t6615 / 0.12e2 - 0.3e1 / 0.32e2 * t1308 * t6615 - 0.5e1 / 0.48e2 * t1311 * t6615 - 0.11e2 / 0.96e2 * t1314 * t6615 - 0.7e1 / 0.72e2 * t1369 * t3055 - 0.7e1 / 0.72e2 * t1371 * t3055 - 0.7e1 / 0.72e2 * t1365 * t3055 - 0.7e1 / 0.72e2 * t1367 * t3055;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t6633 = t3217 * t44 * t46;
  tv4rhosigma30 = t1057 * t6633 / 0.16e2 - t3218 * t1100 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1110 + 0.9e1 / 0.128e3 * t1060 * t6633 - t3220 * t1100 / 0.16e2 + 0.3e1 / 0.64e2 * t3220 * t1110 + 0.5e1 / 0.64e2 * t1038 * t6633 - t3222 * t1100 / 0.16e2 + 0.3e1 / 0.64e2 * t3222 * t1110 + 0.11e2 / 0.128e3 * t1043 * t6633 - t3224 * t1100 / 0.16e2 + 0.3e1 / 0.64e2 * t3224 * t1110;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = t253 * t3229 * t457 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1143 + 0.9e1 / 0.128e3 * t258 * t3229 * t457 + 0.3e1 / 0.64e2 * t3232 * t1143 + 0.5e1 / 0.64e2 * t183 * t3229 * t457 + 0.3e1 / 0.64e2 * t3234 * t1143 + 0.11e2 / 0.128e3 * t188 * t3229 * t457 + 0.3e1 / 0.64e2 * t3236 * t1143;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = t379 * t3217 * t421 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1203 + 0.9e1 / 0.128e3 * t385 * t3217 * t421 + 0.3e1 / 0.64e2 * t3220 * t1203 + 0.5e1 / 0.64e2 * t390 * t3217 * t421 + 0.3e1 / 0.64e2 * t3222 * t1203 + 0.11e2 / 0.128e3 * t395 * t3217 * t421 + 0.3e1 / 0.64e2 * t3224 * t1203;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t6699 = t3229 * t56 * t46;
  tv4rhosigma319 = t1303 * t6699 / 0.16e2 - t3230 * t1282 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1264 + 0.9e1 / 0.128e3 * t1308 * t6699 - t3232 * t1282 / 0.16e2 + 0.3e1 / 0.64e2 * t3232 * t1264 + 0.5e1 / 0.64e2 * t1311 * t6699 - t3234 * t1282 / 0.16e2 + 0.3e1 / 0.64e2 * t3234 * t1264 + 0.11e2 / 0.128e3 * t1314 * t6699 - t3236 * t1282 / 0.16e2 + 0.3e1 / 0.64e2 * t3236 * t1264;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t6726 = 0.1e1 / t31 / t3215 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.128e3 * t30 * t6726 * t421 - 0.15e2 / 0.128e3 * t64 * t6726 * t421 - 0.15e2 / 0.128e3 * t68 * t6726 * t421 - 0.15e2 / 0.128e3 * t81 * t6726 * t421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t6738 = 0.1e1 / t49 / t3227 / sigma[2];
  tv4sigma414 = -0.15e2 / 0.128e3 * t30 * t6738 * t457 - 0.15e2 / 0.128e3 * t64 * t6738 * t457 - 0.15e2 / 0.128e3 * t68 * t6738 * t457 - 0.15e2 / 0.128e3 * t81 * t6738 * t457;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

#endif

#endif

#endif

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t119 * t70;

#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  if(order < 1) return;


  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  if(order < 2) return;


  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t266 = 0.1e1 / t23;
  t272 = 0.1e1 / t7 / t164;
  t277 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t266 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t272 * sigma[0] * t64;
  t278 = 0.1e1 / t164;
  t284 = 0.1e1 / t79 / t93;
  t292 = 0.1e1 / t15;
  t296 = 0.1e1 / t7;
  t313 = t69 * t278 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t292 * t98 + 0.55e2 / 0.72e2 * t108 * t296 * t98 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t292 + t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t277 + t313;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  t362 = 0.1e1 / t34 / sigma[0];
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  if(order < 3) return;


  t386 = 0.1e1 / t22 / t93;
  t392 = 0.1e1 / t7 / t236;
  t397 = 0.1e1 / t236;
  t403 = 0.1e1 / t79 / t164;
  t414 = 0.1e1 / t16;
  t419 = t236 * rho[0];
  t421 = 0.1e1 / t28 / t419;
  t422 = sigma[0] * t421;
  t425 = -0.1232e4 / 0.27e2 * t422 * t64 + 0.1232e4 / 0.27e2 * t422;
  t428 = 0.3e1 * t113 * t170 + 0.55e2 / 0.864e3 * t43 * t284 * t34 * t38 + 0.5e1 / 0.54e2 * t49 * t95 * t34 * t38 + 0.3e1 / 0.32e2 * t55 * t386 * t34 * t38 - 0.1729e4 / 0.1728e4 * t61 * t392 * sigma[0] * t64 - 0.3e1 / 0.4e1 * t69 * t397 * sigma[0] * t64 - 0.935e3 / 0.1728e4 * t76 * t403 * sigma[0] * t64 - 0.35e2 / 0.432e3 * t6 * t152 - 0.4e1 / 0.27e2 * t14 * t157 - 0.3e1 / 0.16e2 * t21 * t266 - 0.5e1 / 0.27e2 * t27 * t414 + 0.3e1 * t186 * t242 + t114 * t425 / 0.2e1;
  t447 = t85 * t166;
  t468 = 0.9e1 / 0.8e1 * t92 * t136 * t170 + 0.5e1 / 0.3e1 * t103 * t292 * t170 + 0.55e2 / 0.24e2 * t108 * t296 * t170 - 0.3e1 / 0.16e2 * t92 * t266 * t98 - 0.5e1 / 0.27e2 * t103 * t414 * t98 - 0.55e2 / 0.432e3 * t108 * t62 * t98 - 0.10e2 / 0.27e2 * t447 * t88 + 0.9e1 / 0.4e1 * t92 * t22 * t242 + t92 * t23 * t425 / 0.2e1 + 0.5e1 / 0.2e1 * t103 * t28 * t242 + t103 * t29 * t425 / 0.2e1 + 0.11e2 / 0.4e1 * t108 * t79 * t242 + t108 * t109 * t425 / 0.2e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t428 + t468;

  t500 = 0.88e2 / 0.9e1 * t238 * t64 - 0.88e2 / 0.9e1 * t238;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = -0.5e1 / 0.288e3 * t43 * t152 * t190 * t38 - t49 * t157 * t190 * t38 / 0.36e2 - t55 * t266 * t190 * t38 / 0.32e2 + 0.91e2 / 0.288e3 * t61 * t272 * t64 + t69 * t278 * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t284 * t64 + 0.5e1 / 0.36e2 * t230 * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t218 + 0.3e1 / 0.2e1 * t92 * t22 * t342 + t92 * t23 * t500 / 0.2e1 + 0.5e1 / 0.9e1 * t103 * t292 * t218 + 0.5e1 / 0.3e1 * t103 * t28 * t342 + t103 * t29 * t500 / 0.2e1 + 0.55e2 / 0.72e2 * t108 * t296 * t218 + 0.11e2 / 0.6e1 * t108 * t79 * t342 + t108 * t109 * t500 / 0.2e1 + t113 * t218 + 0.2e1 * t186 * t342 + t114 * t500 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t43 * t80 * t362 * t38 / 0.96e2 - t49 * t86 * t362 * t38 / 0.48e2 - t55 * t136 * t362 * t38 / 0.32e2;

  t539 = sigma[0] * sigma[0];
  t541 = 0.1e1 / t34 / t539;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.3e1 / 0.32e2 * t49 * t15 * t541 * t38 + 0.3e1 / 0.32e2 * t55 * t22 * t541 * t38 + 0.3e1 / 0.32e2 * t43 * t7 * t541 * t38 + 0.3e1 / 0.32e2 * t33 * t541 * t38;

#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  if(order < 4) return;


  t594 = 0.1e1 / t15 / t93;
  t602 = sigma[0] / t28 / t236 / t93;
  t605 = 0.20944e5 / 0.81e2 * t602 * t64 - 0.20944e5 / 0.81e2 * t602;
  t611 = 0.6e1 * t113 * t242 - 0.935e3 / 0.5184e4 * t43 * t403 * t34 * t38 - 0.20e2 / 0.81e2 * t49 * t166 * t34 * t38 - 0.15e2 / 0.64e2 * t55 / t22 / t164 * t34 * t38 + 0.43225e5 / 0.10368e5 * t61 / t7 / t419 * sigma[0] * t64 + 0.3e1 * t69 / t419 * sigma[0] * t64 + 0.21505e5 / 0.10368e5 * t76 / t79 / t236 * sigma[0] * t64 + 0.385e3 / 0.2592e4 * t6 * t284 + 0.20e2 / 0.81e2 * t14 * t95 + 0.9e1 / 0.32e2 * t21 * t386 + 0.20e2 / 0.81e2 * t27 * t594 + 0.4e1 * t186 * t425 + t114 * t605 / 0.2e1 + 0.9e1 / 0.4e1 * t92 * t136 * t242;
  t657 = 0.10e2 / 0.3e1 * t103 * t292 * t242 + 0.55e2 / 0.12e2 * t108 * t296 * t242 + 0.110e3 / 0.81e2 * t85 * t238 * t88 + 0.3e1 * t92 * t22 * t425 + t92 * t23 * t605 / 0.2e1 + 0.10e2 / 0.3e1 * t103 * t28 * t425 + t103 * t29 * t605 / 0.2e1 + 0.11e2 / 0.3e1 * t108 * t79 * t425 + t108 * t109 * t605 / 0.2e1 - 0.55e2 / 0.108e3 * t108 * t62 * t170 + 0.9e1 / 0.32e2 * t92 * t386 * t98 + 0.20e2 / 0.81e2 * t103 * t594 * t98 + 0.385e3 / 0.2592e4 * t108 * t142 * t98 - 0.3e1 / 0.4e1 * t92 * t266 * t170 - 0.20e2 / 0.27e2 * t103 * t414 * t170;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = t611 + t657;

  t666 = -0.1232e4 / 0.27e2 * t421 * t64 + 0.1232e4 / 0.27e2 * t421;
  t693 = 0.3e1 * t113 * t342 - 0.10e2 / 0.27e2 * t447 * t64 + 0.3e1 * t186 * t500 + t114 * t666 / 0.2e1 + 0.55e2 / 0.1728e4 * t43 * t284 * t190 * t38 + 0.5e1 / 0.108e3 * t49 * t95 * t190 * t38 + 0.3e1 / 0.64e2 * t55 * t386 * t190 * t38 - 0.3e1 / 0.16e2 * t92 * t266 * t218 - 0.5e1 / 0.27e2 * t103 * t414 * t218 - 0.55e2 / 0.432e3 * t108 * t62 * t218 + 0.11e2 / 0.4e1 * t108 * t79 * t500;
  t727 = t108 * t109 * t666 / 0.2e1 - 0.1729e4 / 0.1728e4 * t61 * t392 * t64 - 0.3e1 / 0.4e1 * t69 * t397 * t64 - 0.935e3 / 0.1728e4 * t76 * t403 * t64 + 0.9e1 / 0.8e1 * t92 * t136 * t342 + 0.9e1 / 0.4e1 * t92 * t22 * t500 + t92 * t23 * t666 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t292 * t342 + 0.5e1 / 0.2e1 * t103 * t28 * t500 + t103 * t29 * t666 / 0.2e1 + 0.55e2 / 0.24e2 * t108 * t296 * t342;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t693 + t727;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.5e1 / 0.576e3 * t43 * t152 * t362 * t38 + t49 * t157 * t362 * t38 / 0.72e2 + t55 * t266 * t362 * t38 / 0.64e2;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t43 * t80 * t541 * t38 / 0.64e2 + t49 * t86 * t541 * t38 / 0.32e2 + 0.3e1 / 0.64e2 * t55 * t136 * t541 * t38;

  t754 = 0.1e1 / t34 / t539 / sigma[0];
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = -0.15e2 / 0.64e2 * t49 * t15 * t754 * t38 - 0.15e2 / 0.64e2 * t55 * t22 * t754 * t38 - 0.15e2 / 0.64e2 * t43 * t7 * t754 * t38 - 0.15e2 / 0.64e2 * t33 * t754 * t38;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158;

#ifndef XC_DONT_COMPILE_VXC
  double t169, t170, t173, t174, t177, t178, t181, t184;
  double t185, t188, t191, t196, t201, t206, t209, t211;
  double t212, t213, t215, t216, t217, t219, t220, t221;
  double t223, t226, t231, t236, t241, t242, t247, t249;
  double t251, t252, t254, t258, t262, t266, t269, t270;
  double t272, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, t310, t313, t314;
  double t318, t319, t322, t325, t326, t329, t332, t337;
  double t342, t347, t350, t351, t353, t355, t356, t357;
  double t359, t360, t362, t365, t370, t375, t380, t381;
  double t386, t388, t392, t396, t400, t404, t407, t410;
  double t413, t416, t418, t419, t421, t424, t427, t430;
  double t434, t444, t454, t455, t457, t460, t463, t466;
  double t470, t480;

#ifndef XC_DONT_COMPILE_FXC
  double t485, t487, t488, t491, t494, t497, t500, t502;
  double t503, t504, t506, t508, t509, t510, t512, t513;
  double t514, t517, t519, t523, t524, t525, t527, t528;
  double t529, t531, t532, t533, t536, t540, t541, t542;
  double t544, t546, t548, t549, t556, t559, t562, t565;
  double t566, t569, t572, t575, t576, t579, t582, t585;
  double t589, t591, t593, t595, t597, t598, t603, t606;
  double t609, t626, t634, t657, t659, t662, t664, t666;
  double t667, t670, t672, t675, t676, t677, t679, t681;
  double t683, t685, t687, t689, t691, t692, t695, t697;
  double t699, t702, t704, t710, t713, t717, t718, t723;
  double t726, t730, t731, t734, t753, t755, t756, t757;
  double t759, t760, t762, t764, t765, t766, t768, t769;
  double t771, t782, t801, t812, t833, t837, t839, t841;
  double t843, t845, t847, t849, t851, t853, t855, t858;
  double t861, t864, t867, t871, t875, t876, t880, t881;
  double t886, t889, t893, t894, t897, t914, t915, t916;
  double t918, t919, t921, t923, t924, t925, t927, t929;
  double t930, t931, t933, t934, t936, t941, t960, t973;
  double t976, t979, t981, t984, t985, t988, t991, t994;
  double t997, t1000, t1001, t1004, t1015, t1018, t1021, t1024;
  double t1027, t1030, t1032, t1035, t1036, t1050, t1055, t1058;
  double t1061, t1064, t1071, t1073, t1091, t1093, t1096, t1099;
  double t1102, t1106, t1107, t1110, t1111, t1114, t1115, t1118;
  double t1119, t1122, t1126, t1130, t1134, t1138, t1139, t1143;
  double t1146, t1151, t1156, t1163, t1168, t1171, t1174, t1179;
  double t1184, t1187, t1198, t1199, t1203, t1206, t1211, t1216;
  double t1229, t1240, t1243, t1254, t1264, t1266, t1269, t1283;
  double t1300, t1302, t1320, t1322, t1325, t1328, t1331, t1335;
  double t1336, t1339, t1340, t1343, t1344, t1347, t1348, t1351;
  double t1353, t1354, t1356, t1358, t1360, t1364, t1365, t1367;
  double t1369, t1371;

#ifndef XC_DONT_COMPILE_KXC
  double t1378, t1389, t1392, t1395, t1399, t1400, t1403, t1406;
  double t1409, t1412, t1415, t1418, t1421, t1422, t1423, t1424;
  double t1425, t1426, t1427, t1428, t1429, t1446, t1447, t1454;
  double t1455, t1458, t1461, t1463, t1467, t1468, t1472, t1473;
  double t1476, t1479, t1483, t1484, t1487, t1496, t1505, t1507;
  double t1508, t1509, t1511, t1513, t1515, t1517, t1518, t1520;
  double t1521, t1523, t1524, t1526, t1527, t1529, t1544, t1557;
  double t1559, t1561, t1562, t1575, t1578, t1580, t1582, t1584;
  double t1586, t1588, t1589, t1591, t1592, t1593, t1595, t1596;
  double t1597, t1599, t1600, t1603, t1605, t1607, t1609, t1611;
  double t1613, t1616, t1618, t1620, t1622, t1624, t1627, t1629;
  double t1630, t1632, t1634, t1636, t1639, t1641, t1643, t1645;
  double t1647, t1648, t1650, t1651, t1652, t1653, t1656, t1657;
  double t1658, t1659, t1668, t1670, t1671, t1673, t1675, t1693;
  double t1695, t1697, t1699, t1701, t1702, t1703, t1705, t1706;
  double t1707, t1710, t1721, t1722, t1723, t1725, t1727, t1729;
  double t1730, t1731, t1733, t1734, t1735, t1738, t1749, t1750;
  double t1751, t1753, t1768, t1773, t1776, t1787, t1813, t1822;
  double t1845, t1851, t1853, t1854, t1856, t1858, t1860, t1862;
  double t1864, t1866, t1868, t1870, t1872, t1873, t1878, t1887;
  double t1888, t1889, t1899, t1921, t1925, t1930, t1935, t1939;
  double t1940, t1947, t1952, t1955, t1959, t1960, t1963, t1986;
  double t1989, t1991, t1992, t1994, t1996, t1997, t1999, t2000;
  double t2002, t2004, t2006, t2008, t2009, t2011, t2012, t2014;
  double t2015, t2017, t2038, t2053, t2069, t2080, t2082, t2084;
  double t2086, t2088, t2090, t2092, t2094, t2096, t2098, t2107;
  double t2114, t2120, t2124, t2125, t2129, t2130, t2136, t2141;
  double t2145, t2146, t2149, t2155, t2156, t2158, t2159, t2161;
  double t2163, t2164, t2165, t2167, t2169, t2171, t2173, t2174;
  double t2176, t2177, t2179, t2204, t2209, t2231, t2252, t2257;
  double t2262, t2265, t2268, t2271, t2278, t2282, t2285, t2288;
  double t2289, t2292, t2295, t2298, t2301, t2304, t2307, t2312;
  double t2325, t2329, t2333, t2341, t2346, t2351, t2356, t2362;
  double t2369, t2372, t2384, t2388, t2403, t2406, t2423, t2426;
  double t2429, t2432, t2437, t2440, t2441, t2444, t2446, t2447;
  double t2450, t2451, t2456, t2462, t2463, t2481, t2482, t2486;
  double t2489, t2492, t2495, t2498, t2501, t2503, t2504, t2507;
  double t2511, t2514, t2519, t2524, t2529, t2546, t2549, t2552;
  double t2555, t2558, t2560, t2575, t2576, t2589, t2601, t2602;
  double t2606, t2624, t2627, t2634, t2637, t2642, t2649, t2668;
  double t2679, t2700, t2709, t2712, t2715, t2734, t2736, t2739;
  double t2742, t2745, t2750, t2759, t2768, t2777, t2780, t2784;
  double t2796, t2813, t2836, t2845, t2850, t2853, t2856, t2859;
  double t2880, t2893, t2904, t2907, t2910, t2913, t2928, t2930;
  double t2949, t2952, t2969, t2995, t2999, t3003, t3014, t3028;
  double t3032, t3035, t3038, t3041, t3044, t3048, t3053, t3082;
  double t3091, t3094, t3109, t3112, t3113, t3117, t3118, t3121;
  double t3124, t3149, t3154, t3159, t3164, t3169, t3174, t3179;
  double t3184, t3190, t3215, t3217, t3218, t3220, t3222, t3224;
  double t3227, t3229, t3230, t3232, t3234, t3236;

#ifndef XC_DONT_COMPILE_LXC
  double t3239, t3240, t3241, t3242, t3253, t3275, t3282, t3283;
  double t3284, t3286, t3288, t3290, t3292, t3294, t3296, t3298;
  double t3304, t3306, t3308, t3310, t3312, t3314, t3316, t3318;
  double t3321, t3323, t3325, t3326, t3332, t3337, t3339, t3343;
  double t3345, t3347, t3349, t3352, t3354, t3356, t3357, t3363;
  double t3372, t3374, t3376, t3380, t3381, t3386, t3415, t3438;
  double t3441, t3470, t3495, t3496, t3499, t3506, t3508, t3510;
  double t3512, t3514, t3519, t3521, t3523, t3525, t3530, t3532;
  double t3534, t3536, t3538, t3540, t3541, t3542, t3543, t3545;
  double t3546, t3547, t3549, t3550, t3551, t3553, t3554, t3555;
  double t3557, t3561, t3562, t3564, t3566, t3568, t3570, t3572;
  double t3577, t3579, t3581, t3583, t3585, t3587, t3589, t3591;
  double t3594, t3595, t3596, t3598, t3599, t3600, t3602, t3603;
  double t3604, t3606, t3607, t3608, t3611, t3613, t3615, t3616;
  double t3618, t3620, t3622, t3624, t3626, t3628, t3631, t3634;
  double t3660, t3662, t3664, t3666, t3668, t3670, t3672, t3675;
  double t3678, t3704, t3706, t3708, t3710, t3712, t3714, t3716;
  double t3744, t3747, t3775, t3792, t3819, t3844, t3845, t3846;
  double t3847, t3848, t3849, t3850, t3851, t3852, t3870, t3872;
  double t3874, t3876, t3884, t3885, t3886, t3887, t3888, t3892;
  double t3897, t3899, t3900, t3903, t3905, t3907, t3909, t3911;
  double t3913, t3915, t3917, t3925, t3941, t3950, t3952, t3954;
  double t3956, t3959, t3961, t3963, t3966, t3969, t3996, t3998;
  double t4000, t4002, t4004, t4006, t4008, t4010, t4012, t4015;
  double t4018, t4021, t4048, t4050, t4052, t4054, t4082, t4083;
  double t4089, t4121, t4132, t4163, t4188, t4190, t4192, t4194;
  double t4204, t4207, t4208, t4215, t4227, t4231, t4233, t4235;
  double t4237, t4239, t4241, t4243, t4245, t4250, t4255, t4275;
  double t4290, t4293, t4296, t4298, t4301, t4321, t4325, t4327;
  double t4329, t4331, t4333, t4335, t4337, t4339, t4342, t4345;
  double t4348, t4370, t4372, t4374, t4386, t4406, t4429, t4462;
  double t4473, t4492, t4496, t4506, t4522, t4537, t4548, t4549;
  double t4554, t4560, t4564, t4579, t4584, t4593, t4597, t4606;
  double t4608, t4611, t4613, t4619, t4621, t4623, t4625, t4627;
  double t4629, t4631, t4633, t4636, t4638, t4640, t4669, t4673;
  double t4699, t4737, t4766, t4777, t4781, t4799, t4805, t4821;
  double t4823, t4845, t4855, t4859, t4867, t4876, t4879, t4889;
  double t4897, t4909, t4929, t4932, t4947, t4950, t4960, t4961;
  double t4987, t4992, t4994, t4997, t5000, t5002, t5005, t5008;
  double t5010, t5013, t5014, t5015, t5016, t5019, t5032, t5039;
  double t5048, t5055, t5064, t5077, t5080, t5110, t5112, t5125;
  double t5142, t5146, t5168, t5174, t5197, t5208, t5214, t5227;
  double t5249, t5252, t5256, t5283, t5306, t5311, t5319, t5330;
  double t5333, t5339, t5356, t5377, t5380, t5384, t5388, t5392;
  double t5394, t5397, t5415, t5422, t5431, t5434, t5449, t5473;
  double t5494, t5496, t5499, t5502, t5505, t5515, t5528, t5553;
  double t5560, t5570, t5586, t5588, t5610, t5614, t5626, t5639;
  double t5656, t5665, t5675, t5690, t5714, t5719, t5735, t5742;
  double t5751, t5768, t5785, t5794, t5800, t5822, t5825, t5829;
  double t5833, t5844, t5865, t5892, t5900, t5906, t5919, t5922;
  double t5937, t5949, t5952, t5965, t5979, t6006, t6014, t6028;
  double t6036, t6043, t6047, t6071, t6103, t6107, t6134, t6161;
  double t6181, t6192, t6208, t6220, t6223, t6253, t6270, t6279;
  double t6287, t6293, t6303, t6346, t6381, t6405, t6409, t6483;
  double t6521, t6591, t6633, t6699, t6726, t6738;
#endif

#endif

#endif

#endif

#endif


  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t169 = 0.1e1 / t9 / t86;
  t170 = t31 * t169;
  t173 = t34 * t144;
  t174 = t36 - t173;
  t177 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t174);
  t178 = t177 * t46;
  t181 = -t174;
  t184 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t181);
  t185 = t184 * t46;
  t188 = -t170 * t47 / 0.3e1 + t33 * t178 / 0.4e1 + t51 * t185 / 0.4e1;
  t191 = t29 * t9;
  t196 = t63 * t16;
  t201 = t67 * t23;
  t206 = t71 * t74;
  t209 = t86 * rho[0];
  t211 = 0.1e1 / t23 / t209;
  t212 = sigma[0] * t211;
  t213 = t212 * t91;
  t215 = t44 * t45;
  t216 = t215 * t177;
  t217 = t89 * t216;
  t219 = t56 * t45;
  t220 = t219 * t184;
  t221 = t96 * t220;
  t223 = -t213 / 0.3e1 + t217 / 0.4e1 + t221 / 0.4e1;
  t226 = t84 * t16;
  t231 = t104 * t23;
  t236 = t109 * t74;
  t241 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t30 * t188 / 0.2e1 + 0.2e1 / 0.3e1 * t191 * t60 + t64 * t188 / 0.2e1 + 0.3e1 / 0.4e1 * t196 * t60 + t68 * t188 / 0.2e1 + 0.5e1 / 0.6e1 * t201 * t60 + t81 * t188 / 0.2e1 + 0.11e2 / 0.12e2 * t206 * t60 + t85 * t223 / 0.2e1 + 0.3e1 / 0.4e1 * t226 * t101 + t105 * t223 / 0.2e1 + 0.5e1 / 0.6e1 * t231 * t101 + t110 * t223 / 0.2e1 + 0.11e2 / 0.12e2 * t236 * t101 + t115 * t223 / 0.2e1;
  t242 = t113 * rho[0];
  t247 = t124 * t35;
  t249 = 0.1e1 / t126 / t247;
  t251 = 0.8e1 / 0.3e1 * t123 * t249;
  t252 = -0.2e1 / 0.3e1 * t213 + t217 / 0.2e1 + t221 / 0.2e1 + t251;
  t254 = t118 * t16;
  t258 = t132 * t23;
  t262 = t135 * t74;
  t266 = t138 * rho[0];
  t269 = 0.1e1 / t247;
  t270 = t143 * t269;
  t272 = 0.2e1 * t154 * t270;
  t275 = 0.2e1 * t142 * t173;
  t277 = 0.2e1 * t142 * t270;
  t279 = 0.2e1 * t148 * t173;
  t281 = 0.2e1 * t148 * t270;
  t283 = 0.2e1 * t151 * t173;
  t285 = 0.2e1 * t151 * t270;
  t287 = 0.2e1 * t154 * t173;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = t275 - t277 + t279 - t281 + t283 - t285 + t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t241 + t242 * t101 + t119 * t252 + 0.3e1 / 0.2e1 * t254 * t130 + t133 * t252 + 0.5e1 / 0.3e1 * t258 * t130 + t136 * t252 + 0.11e2 / 0.6e1 * t262 * t130 + t139 * t252 + 0.2e1 * t266 * t130 - t272 + t300;

  t310 = -t36 - t173;
  t313 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t310);
  t314 = t313 * t46;
  t318 = 0.1e1 / t11 / t93;
  t319 = t49 * t318;
  t322 = -t310;
  t325 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t322);
  t326 = t325 * t46;
  t329 = t33 * t314 / 0.4e1 - t319 * t57 / 0.3e1 + t51 * t326 / 0.4e1;
  t332 = t29 * t11;
  t337 = t63 * t18;
  t342 = t67 * t25;
  t347 = t71 * t78;
  t350 = t215 * t313;
  t351 = t89 * t350;
  t353 = t93 * rho[1];
  t355 = 0.1e1 / t25 / t353;
  t356 = sigma[2] * t355;
  t357 = t356 * t98;
  t359 = t219 * t325;
  t360 = t96 * t359;
  t362 = t351 / 0.4e1 - t357 / 0.3e1 + t360 / 0.4e1;
  t365 = t84 * t18;
  t370 = t104 * t25;
  t375 = t109 * t78;
  t380 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + t30 * t329 / 0.2e1 + 0.2e1 / 0.3e1 * t332 * t60 + t64 * t329 / 0.2e1 + 0.3e1 / 0.4e1 * t337 * t60 + t68 * t329 / 0.2e1 + 0.5e1 / 0.6e1 * t342 * t60 + t81 * t329 / 0.2e1 + 0.11e2 / 0.12e2 * t347 * t60 + t85 * t362 / 0.2e1 + 0.3e1 / 0.4e1 * t365 * t101 + t105 * t362 / 0.2e1 + 0.5e1 / 0.6e1 * t370 * t101 + t110 * t362 / 0.2e1 + 0.11e2 / 0.12e2 * t375 * t101 + t115 * t362 / 0.2e1;
  t381 = t113 * rho[1];
  t386 = t351 / 0.2e1 - 0.2e1 / 0.3e1 * t357 + t360 / 0.2e1 + t251;
  t388 = t118 * t18;
  t392 = t132 * t25;
  t396 = t135 * t78;
  t400 = t138 * rho[1];
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145 - t275 - t277 - t279 - t281 - t283 - t285 - t287;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t380 + t381 * t101 + t119 * t386 + 0.3e1 / 0.2e1 * t388 * t130 + t133 * t386 + 0.5e1 / 0.3e1 * t392 * t130 + t136 * t386 + 0.11e2 / 0.6e1 * t396 * t130 + t139 * t386 + 0.2e1 * t400 * t130 - t272 + t416;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = -0.2e1 * t119 * t128 - 0.2e1 * t133 * t128 - 0.2e1 * t136 * t128 - 0.2e1 * t139 * t128;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t485 = t113 * t101;
  t487 = 0.2e1 * t138 * t130;
  t488 = 0.1e1 / t74;
  t491 = 0.1e1 / t23;
  t494 = 0.1e1 / t16;
  t497 = 0.1e1 / t9;
  t500 = t86 * t86;
  t502 = 0.1e1 / t23 / t500;
  t503 = sigma[0] * t502;
  t504 = t503 * t91;
  t506 = t212 * t216;
  t508 = t177 * t177;
  t509 = t508 * t45;
  t510 = t89 * t509;
  t512 = t42 * t42;
  t513 = 0.1e1 / t512;
  t514 = t174 * t174;
  t517 = t34 * t269;
  t519 = -0.2e1 * t144 + 0.2e1 * t517;
  t523 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t513 * t514 + 0.4e1 / 0.3e1 * t42 * t519);
  t524 = t215 * t523;
  t525 = t89 * t524;
  t527 = t184 * t184;
  t528 = t527 * t45;
  t529 = t96 * t528;
  t531 = t54 * t54;
  t532 = 0.1e1 / t531;
  t533 = t181 * t181;
  t536 = -t519;
  t540 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t532 * t533 + 0.4e1 / 0.3e1 * t54 * t536);
  t541 = t219 * t540;
  t542 = t96 * t541;
  t544 = t124 * t124;
  t546 = 0.1e1 / t126 / t544;
  t548 = 0.88e2 / 0.9e1 * t123 * t546;
  t549 = 0.22e2 / 0.9e1 * t504 - 0.8e1 / 0.3e1 * t506 + t510 / 0.2e1 + t525 / 0.2e1 + t529 / 0.2e1 + t542 / 0.2e1 - t548;
  t556 = t29 * t491;
  t559 = t63 * t494;
  t562 = t67 * t497;
  t565 = 0.1e1 / t2;
  t566 = t71 * t565;
  t569 = t84 * t494;
  t572 = t104 * t497;
  t575 = t485 + t487 + 0.7e1 / 0.36e2 * t1 * t488 + 0.4e1 / 0.9e1 * t8 * t491 + 0.3e1 / 0.4e1 * t15 * t494 + 0.10e2 / 0.9e1 * t22 * t497 + t136 * t549 + 0.11e2 / 0.3e1 * t262 * t252 + t139 * t549 + 0.4e1 * t266 * t252 + 0.2e1 / 0.9e1 * t556 * t60 + 0.3e1 / 0.8e1 * t559 * t60 + 0.5e1 / 0.9e1 * t562 * t60 + 0.55e2 / 0.72e2 * t566 * t60 + 0.3e1 / 0.8e1 * t569 * t101 + 0.5e1 / 0.9e1 * t572 * t101;
  t576 = t109 * t565;
  t579 = t118 * t494;
  t582 = t132 * t497;
  t585 = t135 * t565;
  t589 = 0.2e1 * t142 * t144;
  t591 = 0.2e1 * t148 * t144;
  t593 = 0.2e1 * t151 * t144;
  t595 = 0.2e1 * t154 * t144;
  t597 = 0.1e1 / t9 / t209;
  t598 = t31 * t597;
  t603 = t523 * t46;
  t606 = t540 * t46;
  t609 = 0.7e1 / 0.9e1 * t598 * t47 - 0.2e1 / 0.3e1 * t170 * t178 + t33 * t603 / 0.4e1 + t51 * t606 / 0.4e1;
  t626 = 0.55e2 / 0.72e2 * t576 * t101 + 0.3e1 / 0.4e1 * t579 * t130 + 0.10e2 / 0.9e1 * t582 * t130 + 0.55e2 / 0.36e2 * t585 * t130 + t589 + t591 + t593 + t595 + t30 * t609 / 0.2e1 + 0.4e1 / 0.3e1 * t191 * t188 + t64 * t609 / 0.2e1 + 0.3e1 / 0.2e1 * t196 * t188 + t68 * t609 / 0.2e1 + 0.5e1 / 0.3e1 * t201 * t188 + t81 * t609 / 0.2e1 + 0.11e2 / 0.6e1 * t206 * t188;
  t634 = 0.11e2 / 0.9e1 * t504 - 0.4e1 / 0.3e1 * t506 + t510 / 0.4e1 + t525 / 0.4e1 + t529 / 0.4e1 + t542 / 0.4e1;
  t657 = t291 * t270;
  t659 = t150 * t494;
  t662 = t294 * t173;
  t664 = t294 * t270;
  t666 = t85 * t634 / 0.2e1 + 0.3e1 / 0.2e1 * t226 * t223 + t105 * t634 / 0.2e1 + 0.5e1 / 0.3e1 * t231 * t223 + t110 * t634 / 0.2e1 + 0.11e2 / 0.6e1 * t236 * t223 + t115 * t634 / 0.2e1 + 0.2e1 * t242 * t223 + t119 * t549 + 0.3e1 * t254 * t252 + t133 * t549 + 0.10e2 / 0.3e1 * t258 * t252 - 0.16e2 / 0.3e1 * t657 + 0.3e1 / 0.4e1 * t659 * t145 + 0.6e1 * t662 - 0.6e1 * t664;
  t667 = t153 * t497;
  t670 = t297 * t173;
  t672 = t297 * t270;
  t675 = 0.8e1 * t142 * t517;
  t676 = 0.1e1 / t544;
  t677 = t143 * t676;
  t679 = 0.6e1 * t142 * t677;
  t681 = 0.8e1 * t148 * t517;
  t683 = 0.6e1 * t148 * t677;
  t685 = 0.8e1 * t151 * t517;
  t687 = 0.6e1 * t151 * t677;
  t689 = 0.8e1 * t154 * t517;
  t691 = 0.6e1 * t154 * t677;
  t692 = t141 * t488;
  t695 = t288 * t173;
  t697 = t288 * t270;
  t699 = t147 * t491;
  t702 = t291 * t173;
  t704 = 0.10e2 / 0.9e1 * t667 * t145 + 0.20e2 / 0.3e1 * t670 - 0.20e2 / 0.3e1 * t672 - t675 + t679 - t681 + t683 - t685 + t687 - t689 + t691 + 0.7e1 / 0.36e2 * t692 * t145 + 0.14e2 / 0.3e1 * t695 - 0.14e2 / 0.3e1 * t697 + 0.4e1 / 0.9e1 * t699 * t145 + 0.16e2 / 0.3e1 * t702;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t575 + t626 + t666 + t704;

  t710 = t513 * t310;
  t713 = t42 * t34;
  t717 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t710 * t174 + 0.8e1 / 0.3e1 * t713 * t269);
  t718 = t717 * t46;
  t723 = t532 * t322;
  t726 = t54 * t34;
  t730 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t723 * t181 - 0.8e1 / 0.3e1 * t726 * t269);
  t731 = t730 * t46;
  t734 = -t170 * t314 / 0.3e1 + t33 * t718 / 0.4e1 - t319 * t185 / 0.3e1 + t51 * t731 / 0.4e1;
  t753 = t212 * t350;
  t755 = t177 * t45;
  t756 = t755 * t313;
  t757 = t89 * t756;
  t759 = t215 * t717;
  t760 = t89 * t759;
  t762 = t356 * t220;
  t764 = t184 * t45;
  t765 = t764 * t325;
  t766 = t96 * t765;
  t768 = t219 * t730;
  t769 = t96 * t768;
  t771 = -0.2e1 / 0.3e1 * t753 + t757 / 0.4e1 + t760 / 0.4e1 - 0.2e1 / 0.3e1 * t762 + t766 / 0.4e1 + t769 / 0.4e1;
  t782 = 0.2e1 / 0.3e1 * t332 * t188 + t64 * t734 / 0.2e1 + 0.3e1 / 0.4e1 * t196 * t329 + 0.3e1 / 0.4e1 * t337 * t188 + t68 * t734 / 0.2e1 + 0.5e1 / 0.6e1 * t201 * t329 + 0.5e1 / 0.6e1 * t342 * t188 + t81 * t734 / 0.2e1 + 0.11e2 / 0.12e2 * t206 * t329 + 0.11e2 / 0.12e2 * t347 * t188 + t85 * t771 / 0.2e1 + 0.3e1 / 0.4e1 * t226 * t362 + 0.3e1 / 0.4e1 * t365 * t223 + t105 * t771 / 0.2e1 + 0.5e1 / 0.6e1 * t231 * t362;
  t801 = -0.4e1 / 0.3e1 * t753 + t757 / 0.2e1 + t760 / 0.2e1 - 0.4e1 / 0.3e1 * t762 + t766 / 0.2e1 + t769 / 0.2e1 - t548;
  t812 = 0.5e1 / 0.6e1 * t370 * t223 + t110 * t771 / 0.2e1 + 0.11e2 / 0.12e2 * t236 * t362 + 0.11e2 / 0.12e2 * t375 * t223 + t115 * t771 / 0.2e1 + t242 * t362 + t381 * t223 + t119 * t801 + 0.3e1 / 0.2e1 * t254 * t386 + 0.3e1 / 0.2e1 * t388 * t252 + t133 * t801 + 0.5e1 / 0.3e1 * t258 * t386 + 0.5e1 / 0.3e1 * t392 * t252 - t589 - t591;
  t833 = -t593 - t595 + t136 * t801 + 0.11e2 / 0.6e1 * t262 * t386 + 0.11e2 / 0.6e1 * t396 * t252 + t139 * t801 + 0.2e1 * t266 * t386 + 0.2e1 * t400 * t252 + t30 * t734 / 0.2e1 + 0.2e1 / 0.3e1 * t191 * t329 - 0.8e1 / 0.3e1 * t657 - 0.3e1 * t662 - 0.3e1 * t664 - 0.10e2 / 0.3e1 * t670 - 0.10e2 / 0.3e1 * t672;
  t837 = t404 * t173;
  t839 = t404 * t270;
  t841 = t407 * t173;
  t843 = t407 * t270;
  t845 = t410 * t173;
  t847 = t410 * t270;
  t849 = t413 * t173;
  t851 = t413 * t270;
  t853 = t679 + t683 + t687 + t691 - 0.7e1 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t697 - 0.8e1 / 0.3e1 * t702 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.10e2 / 0.3e1 * t849 - 0.10e2 / 0.3e1 * t851;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t782 + t812 + t833 + t853;

  t855 = 0.1e1 / t78;
  t858 = 0.1e1 / t25;
  t861 = 0.1e1 / t18;
  t864 = 0.1e1 / t11;
  t867 = t310 * t310;
  t871 = 0.2e1 * t144 + 0.2e1 * t517;
  t875 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t513 * t867 + 0.4e1 / 0.3e1 * t42 * t871);
  t876 = t875 * t46;
  t880 = 0.1e1 / t11 / t353;
  t881 = t49 * t880;
  t886 = t322 * t322;
  t889 = -t871;
  t893 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t532 * t886 + 0.4e1 / 0.3e1 * t54 * t889);
  t894 = t893 * t46;
  t897 = t33 * t876 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t57 - 0.2e1 / 0.3e1 * t319 * t326 + t51 * t894 / 0.4e1;
  t914 = t313 * t313;
  t915 = t914 * t45;
  t916 = t89 * t915;
  t918 = t215 * t875;
  t919 = t89 * t918;
  t921 = t93 * t93;
  t923 = 0.1e1 / t25 / t921;
  t924 = sigma[2] * t923;
  t925 = t924 * t98;
  t927 = t356 * t359;
  t929 = t325 * t325;
  t930 = t929 * t45;
  t931 = t96 * t930;
  t933 = t219 * t893;
  t934 = t96 * t933;
  t936 = t916 / 0.4e1 + t919 / 0.4e1 + 0.11e2 / 0.9e1 * t925 - 0.4e1 / 0.3e1 * t927 + t931 / 0.4e1 + t934 / 0.4e1;
  t941 = 0.7e1 / 0.36e2 * t1 * t855 + 0.4e1 / 0.9e1 * t8 * t858 + 0.3e1 / 0.4e1 * t15 * t861 + 0.10e2 / 0.9e1 * t22 * t864 + t485 + t487 + t30 * t897 / 0.2e1 + 0.4e1 / 0.3e1 * t332 * t329 + t64 * t897 / 0.2e1 + 0.3e1 / 0.2e1 * t337 * t329 + t68 * t897 / 0.2e1 + 0.5e1 / 0.3e1 * t342 * t329 + t81 * t897 / 0.2e1 + 0.11e2 / 0.6e1 * t347 * t329 + t85 * t936 / 0.2e1 + 0.3e1 / 0.2e1 * t365 * t362;
  t960 = t916 / 0.2e1 + t919 / 0.2e1 + 0.22e2 / 0.9e1 * t925 - 0.8e1 / 0.3e1 * t927 + t931 / 0.2e1 + t934 / 0.2e1 - t548;
  t973 = t29 * t858;
  t976 = t63 * t861;
  t979 = t105 * t936 / 0.2e1 + 0.5e1 / 0.3e1 * t370 * t362 + t110 * t936 / 0.2e1 + 0.11e2 / 0.6e1 * t375 * t362 + t115 * t936 / 0.2e1 + 0.2e1 * t381 * t362 + t119 * t960 + 0.3e1 * t388 * t386 + t133 * t960 + 0.10e2 / 0.3e1 * t392 * t386 + t136 * t960 + 0.11e2 / 0.3e1 * t396 * t386 + t139 * t960 + 0.4e1 * t400 * t386 + 0.2e1 / 0.9e1 * t973 * t60 + 0.3e1 / 0.8e1 * t976 * t60;
  t981 = t67 * t864;
  t984 = 0.1e1 / t4;
  t985 = t71 * t984;
  t988 = t84 * t861;
  t991 = t104 * t864;
  t994 = t109 * t984;
  t997 = t118 * t861;
  t1000 = 0.5e1 / 0.9e1 * t981 * t60 + 0.55e2 / 0.72e2 * t985 * t60 + 0.3e1 / 0.8e1 * t988 * t101 + 0.5e1 / 0.9e1 * t991 * t101 + 0.55e2 / 0.72e2 * t994 * t101 + 0.3e1 / 0.4e1 * t997 * t130 + t589 + t591 + t593 + t595 + t675 + t679 + t681 + t683 + t685 + t687;
  t1001 = t132 * t864;
  t1004 = t135 * t984;
  t1015 = t141 * t855;
  t1018 = t147 * t858;
  t1021 = t150 * t861;
  t1024 = t153 * t864;
  t1027 = t689 + t691 + 0.10e2 / 0.9e1 * t1001 * t130 + 0.55e2 / 0.36e2 * t1004 * t130 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.20e2 / 0.3e1 * t849 - 0.20e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.10e2 / 0.9e1 * t1024 * t145;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = t941 + t979 + t1000 + t1027;

  t1030 = t211 * t90 * t45;
  t1032 = t88 * t44;
  t1035 = 0.8e1 / 0.3e1 * t249;
  t1036 = -0.2e1 / 0.3e1 * t1030 + t1032 * t755 / 0.2e1 + t1035;
  t1050 = t32 * t177 * t46;
  t1055 = t85 * t88;
  t1058 = t105 * t88;
  t1061 = t110 * t88;
  t1064 = t115 * t88;
  t1071 = t119 * t1036 + 0.3e1 / 0.2e1 * t254 * t444 + t133 * t1036 + 0.5e1 / 0.3e1 * t258 * t444 + t136 * t1036 + 0.11e2 / 0.6e1 * t262 * t444 + t139 * t1036 + 0.2e1 * t266 * t444 + t427 * t1050 / 0.16e2 + t430 * t1050 / 0.16e2 + t1055 * t216 / 0.8e1 + t1058 * t216 / 0.8e1 + t1061 * t216 / 0.8e1 + t1064 * t216 / 0.8e1 + t419 * t1050 / 0.16e2 + t424 * t1050 / 0.16e2;
  t1073 = t169 * t44 * t46;
  t1091 = t29 / rho[0];
  t1093 = t418 * t44 * t46;
  t1096 = t63 * t488;
  t1099 = t67 * t491;
  t1102 = t71 * t494;
  t1106 = 0.1e1 / t2 / t86;
  t1107 = t84 * t1106;
  t1110 = 0.1e1 / t86;
  t1111 = t104 * t1110;
  t1114 = 0.1e1 / t75;
  t1115 = t109 * t1114;
  t1118 = 0.1e1 / t24;
  t1119 = t113 * t1118;
  t1122 = -t424 * t1073 / 0.12e2 - t427 * t1073 / 0.12e2 - t430 * t1073 / 0.12e2 - t419 * t1073 / 0.12e2 - t85 * t1030 / 0.6e1 - t105 * t1030 / 0.6e1 - t110 * t1030 / 0.6e1 - t115 * t1030 / 0.6e1 + t1091 * t1093 / 0.12e2 + 0.3e1 / 0.32e2 * t1096 * t1093 + 0.5e1 / 0.48e2 * t1099 * t1093 + 0.11e2 / 0.96e2 * t1102 * t1093 + 0.3e1 / 0.32e2 * t1107 * t91 + 0.5e1 / 0.48e2 * t1111 * t91 + 0.11e2 / 0.96e2 * t1115 * t91 + t1119 * t91 / 0.8e1;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t1071 + t1122;

  t1126 = 0.16e2 / 0.3e1 * t119 * t249;
  t1130 = 0.16e2 / 0.3e1 * t133 * t249;
  t1134 = 0.16e2 / 0.3e1 * t136 * t249;
  t1138 = 0.16e2 / 0.3e1 * t139 * t249;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = -0.3e1 * t254 * t128 + t1126 - 0.10e2 / 0.3e1 * t258 * t128 + t1130 - 0.11e2 / 0.3e1 * t262 * t128 + t1134 - 0.4e1 * t266 * t128 + t1138;

  t1139 = t191 * t454;
  t1143 = t50 * t184 * t46;
  t1146 = t196 * t454;
  t1151 = t201 * t454;
  t1156 = t206 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t226 * t470 + t1163 * t220 / 0.8e1 + 0.5e1 / 0.48e2 * t231 * t470 + t1168 * t220 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t764 / 0.2e1 + t1035;
  t1198 = 0.11e2 / 0.96e2 * t236 * t470 + t1174 * t220 / 0.8e1 + t242 * t470 / 0.8e1 + t1179 * t220 / 0.8e1 + 0.3e1 / 0.2e1 * t254 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t258 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t262 * t480 + t136 * t1187 + 0.2e1 * t266 * t480 + t139 * t1187;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t1171 + t1198;

  t1199 = t332 * t418;
  t1203 = t32 * t313 * t46;
  t1206 = t337 * t418;
  t1211 = t342 * t418;
  t1216 = t347 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t365 * t434 + t1055 * t350 / 0.8e1 + 0.5e1 / 0.48e2 * t370 * t434 + t1058 * t350 / 0.8e1;
  t1240 = t45 * t313;
  t1243 = t1032 * t1240 / 0.2e1 + t1035;
  t1254 = 0.11e2 / 0.96e2 * t375 * t434 + t1061 * t350 / 0.8e1 + t381 * t434 / 0.8e1 + t1064 * t350 / 0.8e1 + 0.3e1 / 0.2e1 * t388 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t392 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t396 * t444 + t136 * t1243 + 0.2e1 * t400 * t444 + t139 * t1243;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t1229 + t1254;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = -0.3e1 * t388 * t128 + t1126 - 0.10e2 / 0.3e1 * t392 * t128 + t1130 - 0.11e2 / 0.3e1 * t396 * t128 + t1134 - 0.4e1 * t400 * t128 + t1138;

  t1264 = t355 * t97 * t45;
  t1266 = t45 * t325;
  t1269 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1266 / 0.2e1 + t1035;
  t1283 = t50 * t325 * t46;
  t1300 = t119 * t1269 + 0.3e1 / 0.2e1 * t388 * t480 + t133 * t1269 + 0.5e1 / 0.3e1 * t392 * t480 + t136 * t1269 + 0.11e2 / 0.6e1 * t396 * t480 + t139 * t1269 + 0.2e1 * t400 * t480 + t460 * t1283 / 0.16e2 + t463 * t1283 / 0.16e2 + t466 * t1283 / 0.16e2 + t1163 * t359 / 0.8e1 + t1168 * t359 / 0.8e1 + t1174 * t359 / 0.8e1 + t1179 * t359 / 0.8e1 + t455 * t1283 / 0.16e2;
  t1302 = t318 * t56 * t46;
  t1320 = t29 / rho[1];
  t1322 = t454 * t56 * t46;
  t1325 = t63 * t855;
  t1328 = t67 * t858;
  t1331 = t71 * t861;
  t1335 = 0.1e1 / t4 / t93;
  t1336 = t84 * t1335;
  t1339 = 0.1e1 / t93;
  t1340 = t104 * t1339;
  t1343 = 0.1e1 / t79;
  t1344 = t109 * t1343;
  t1347 = 0.1e1 / t26;
  t1348 = t113 * t1347;
  t1351 = -t455 * t1302 / 0.12e2 - t460 * t1302 / 0.12e2 - t463 * t1302 / 0.12e2 - t466 * t1302 / 0.12e2 - t85 * t1264 / 0.6e1 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 + t1320 * t1322 / 0.12e2 + 0.3e1 / 0.32e2 * t1325 * t1322 + 0.5e1 / 0.48e2 * t1328 * t1322 + 0.11e2 / 0.96e2 * t1331 * t1322 + 0.3e1 / 0.32e2 * t1336 * t98 + 0.5e1 / 0.48e2 * t1340 * t98 + 0.11e2 / 0.96e2 * t1344 * t98 + t1348 * t98 / 0.8e1;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t1300 + t1351;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t1378 = 0.1e1 / t17;
  t1389 = t29 * t1118;
  t1392 = t63 * t1378;
  t1395 = t67 * t32;
  t1399 = 0.1e1 / t3;
  t1400 = t71 * t1399;
  t1403 = t84 * t1378;
  t1406 = t104 * t32;
  t1409 = t109 * t1399;
  t1412 = t118 * t1378;
  t1415 = t132 * t32;
  t1418 = t135 * t1399;
  t1421 = t142 * t269;
  t1422 = 0.12e2 * t1421;
  t1423 = t148 * t269;
  t1424 = 0.12e2 * t1423;
  t1425 = t151 * t269;
  t1426 = 0.12e2 * t1425;
  t1427 = t154 * t269;
  t1428 = 0.12e2 * t1427;
  t1429 = -0.55e2 / 0.432e3 * t1400 * t60 - 0.3e1 / 0.16e2 * t1403 * t101 - 0.5e1 / 0.27e2 * t1406 * t101 - 0.55e2 / 0.432e3 * t1409 * t101 - 0.3e1 / 0.8e1 * t1412 * t130 - 0.10e2 / 0.27e2 * t1415 * t130 - 0.55e2 / 0.216e3 * t1418 * t130 - t1422 - t1424 - t1426 - t1428;
  t1446 = 0.1e1 / t9 / t500;
  t1447 = t31 * t1446;
  t1454 = 0.1e1 / t512 / t38;
  t1455 = t514 * t174;
  t1458 = t513 * t174;
  t1461 = t34 * t676;
  t1463 = 0.6e1 * t269 - 0.6e1 * t1461;
  t1467 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1454 * t1455 + 0.4e1 / 0.3e1 * t1458 * t519 + 0.4e1 / 0.3e1 * t42 * t1463);
  t1468 = t1467 * t46;
  t1472 = 0.1e1 / t531 / t52;
  t1473 = t533 * t181;
  t1476 = t532 * t181;
  t1479 = -t1463;
  t1483 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1472 * t1473 + 0.4e1 / 0.3e1 * t1476 * t536 + 0.4e1 / 0.3e1 * t54 * t1479);
  t1484 = t1483 * t46;
  t1487 = -0.70e2 / 0.27e2 * t1447 * t47 + 0.7e1 / 0.3e1 * t598 * t178 - t170 * t603 + t33 * t1468 / 0.4e1 + t51 * t1484 / 0.4e1;
  t1496 = 0.2e1 / 0.3e1 * t556 * t188 + 0.9e1 / 0.8e1 * t559 * t188 + 0.5e1 / 0.3e1 * t562 * t188 + 0.55e2 / 0.24e2 * t566 * t188 + 0.9e1 / 0.8e1 * t569 * t223 + 0.5e1 / 0.3e1 * t572 * t223 + 0.55e2 / 0.24e2 * t576 * t223 + t30 * t1487 / 0.2e1 + 0.2e1 * t191 * t609 + t64 * t1487 / 0.2e1 + 0.9e1 / 0.4e1 * t196 * t609;
  t1505 = t500 * rho[0];
  t1507 = 0.1e1 / t23 / t1505;
  t1508 = sigma[0] * t1507;
  t1509 = t1508 * t91;
  t1511 = t503 * t216;
  t1513 = t212 * t509;
  t1515 = t212 * t524;
  t1517 = t755 * t523;
  t1518 = t89 * t1517;
  t1520 = t215 * t1467;
  t1521 = t89 * t1520;
  t1523 = t764 * t540;
  t1524 = t96 * t1523;
  t1526 = t219 * t1483;
  t1527 = t96 * t1526;
  t1529 = -0.154e3 / 0.27e2 * t1509 + 0.22e2 / 0.3e1 * t1511 - 0.2e1 * t1513 - 0.2e1 * t1515 + 0.3e1 / 0.4e1 * t1518 + t1521 / 0.4e1 + 0.3e1 / 0.4e1 * t1524 + t1527 / 0.4e1;
  t1544 = t68 * t1487 / 0.2e1 + 0.5e1 / 0.2e1 * t201 * t609 + t81 * t1487 / 0.2e1 + 0.11e2 / 0.4e1 * t206 * t609 + t85 * t1529 / 0.2e1 + 0.9e1 / 0.4e1 * t226 * t634 + t105 * t1529 / 0.2e1 + 0.5e1 / 0.2e1 * t231 * t634 + t110 * t1529 / 0.2e1 + 0.11e2 / 0.4e1 * t236 * t634 + t115 * t1529 / 0.2e1;
  t1557 = t544 * t35;
  t1559 = 0.1e1 / t126 / t1557;
  t1561 = 0.1232e4 / 0.27e2 * t123 * t1559;
  t1562 = -0.308e3 / 0.27e2 * t1509 + 0.44e2 / 0.3e1 * t1511 - 0.4e1 * t1513 - 0.4e1 * t1515 + 0.3e1 / 0.2e1 * t1518 + t1521 / 0.2e1 + 0.3e1 / 0.2e1 * t1524 + t1527 / 0.2e1 + t1561;
  t1575 = t288 * t144;
  t1578 = t291 * t144;
  t1580 = t294 * t144;
  t1582 = t297 * t144;
  t1584 = t113 * t223;
  t1586 = t138 * t252;
  t1588 = 0.1e1 / t1557;
  t1589 = t143 * t1588;
  t1591 = 0.24e2 * t148 * t1589;
  t1592 = t151 * t1461;
  t1593 = 0.36e2 * t1592;
  t1595 = 0.24e2 * t151 * t1589;
  t1596 = t154 * t1461;
  t1597 = 0.36e2 * t1596;
  t1599 = 0.24e2 * t154 * t1589;
  t1600 = t141 * t1114;
  t1603 = 0.8e1 * t1578 + 0.9e1 * t1580 + 0.10e2 * t1582 + 0.3e1 * t1584 + 0.6e1 * t1586 - t1591 + t1593 - t1595 + t1597 - t1599 - 0.35e2 / 0.216e3 * t1600 * t145;
  t1605 = t692 * t173;
  t1607 = t692 * t270;
  t1609 = t288 * t517;
  t1611 = t288 * t677;
  t1613 = t147 * t1118;
  t1616 = t699 * t173;
  t1618 = t699 * t270;
  t1620 = t291 * t517;
  t1622 = t291 * t677;
  t1624 = t150 * t1378;
  t1627 = t659 * t173;
  t1629 = 0.7e1 / 0.6e1 * t1605 - 0.7e1 / 0.6e1 * t1607 - 0.28e2 * t1609 + 0.21e2 * t1611 - 0.8e1 / 0.27e2 * t1613 * t145 + 0.8e1 / 0.3e1 * t1616 - 0.8e1 / 0.3e1 * t1618 - 0.32e2 * t1620 + 0.24e2 * t1622 - 0.3e1 / 0.8e1 * t1624 * t145 + 0.9e1 / 0.2e1 * t1627;
  t1630 = t659 * t270;
  t1632 = t294 * t517;
  t1634 = t294 * t677;
  t1636 = t153 * t32;
  t1639 = t667 * t173;
  t1641 = t667 * t270;
  t1643 = t297 * t517;
  t1645 = t297 * t677;
  t1647 = t142 * t1461;
  t1648 = 0.36e2 * t1647;
  t1650 = 0.24e2 * t142 * t1589;
  t1651 = t148 * t1461;
  t1652 = 0.36e2 * t1651;
  t1653 = -0.9e1 / 0.2e1 * t1630 - 0.36e2 * t1632 + 0.27e2 * t1634 - 0.10e2 / 0.27e2 * t1636 * t145 + 0.20e2 / 0.3e1 * t1639 - 0.20e2 / 0.3e1 * t1641 - 0.40e2 * t1643 + 0.30e2 * t1645 + t1648 - t1650 + t1652;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t1653 + t1629 + t1603 + 0.7e1 * t1575 + t1544 + t1496 + t1429 + 0.3e1 * t242 * t634 + t119 * t1562 + 0.9e1 / 0.2e1 * t254 * t549 + t133 * t1562 + 0.5e1 * t258 * t549 + t136 * t1562 + 0.11e2 / 0.2e1 * t262 * t549 + t139 * t1562 + 0.6e1 * t266 * t549 - 0.3e1 / 0.8e1 * t15 * t1378 - 0.10e2 / 0.27e2 * t22 * t32 + 0.9e1 / 0.4e1 * t579 * t252 + 0.10e2 / 0.3e1 * t582 * t252 + 0.55e2 / 0.12e2 * t585 * t252 - 0.4e1 / 0.27e2 * t1389 * t60 - 0.3e1 / 0.16e2 * t1392 * t60 - 0.5e1 / 0.27e2 * t1395 * t60 - 0.35e2 / 0.216e3 * t1 * t1114 - 0.8e1 / 0.27e2 * t8 * t1118;

  t1656 = 0.4e1 * t1421;
  t1657 = 0.4e1 * t1423;
  t1658 = 0.4e1 * t1425;
  t1659 = 0.4e1 * t1427;
  t1668 = t404 * t144;
  t1670 = t1656 + t1657 + t1658 + t1659 - 0.14e2 / 0.3e1 * t1575 - 0.16e2 / 0.3e1 * t1578 - 0.6e1 * t1580 - 0.20e2 / 0.3e1 * t1582 + 0.3e1 / 0.4e1 * t579 * t386 + 0.10e2 / 0.9e1 * t582 * t386 + 0.7e1 / 0.3e1 * t1668;
  t1671 = t407 * t144;
  t1673 = t410 * t144;
  t1675 = t413 * t144;
  t1693 = 0.8e1 / 0.3e1 * t1671 + 0.3e1 * t1673 + 0.10e2 / 0.3e1 * t1675 + 0.55e2 / 0.36e2 * t585 * t386 + 0.2e1 / 0.9e1 * t556 * t329 + 0.3e1 / 0.8e1 * t559 * t329 + 0.5e1 / 0.9e1 * t562 * t329 + 0.55e2 / 0.72e2 * t566 * t329 + 0.3e1 / 0.8e1 * t569 * t362 + 0.5e1 / 0.9e1 * t572 * t362 + 0.55e2 / 0.72e2 * t576 * t362;
  t1695 = t503 * t350;
  t1697 = t212 * t756;
  t1699 = t212 * t759;
  t1701 = t523 * t45;
  t1702 = t1701 * t313;
  t1703 = t89 * t1702;
  t1705 = t755 * t717;
  t1706 = t89 * t1705;
  t1707 = t1454 * t310;
  t1710 = t513 * t34;
  t1721 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1707 * t514 + 0.16e2 / 0.9e1 * t1710 * t269 * t174 + 0.4e1 / 0.9e1 * t710 * t519 + 0.8e1 / 0.3e1 * t42 * t269 - 0.8e1 * t713 * t676);
  t1722 = t215 * t1721;
  t1723 = t89 * t1722;
  t1725 = t356 * t528;
  t1727 = t356 * t541;
  t1729 = t540 * t45;
  t1730 = t1729 * t325;
  t1731 = t96 * t1730;
  t1733 = t764 * t730;
  t1734 = t96 * t1733;
  t1735 = t1472 * t322;
  t1738 = t532 * t34;
  t1749 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1735 * t533 - 0.16e2 / 0.9e1 * t1738 * t269 * t181 + 0.4e1 / 0.9e1 * t723 * t536 - 0.8e1 / 0.3e1 * t54 * t269 + 0.8e1 * t726 * t676);
  t1750 = t219 * t1749;
  t1751 = t96 * t1750;
  t1753 = 0.44e2 / 0.9e1 * t1695 - 0.8e1 / 0.3e1 * t1697 - 0.8e1 / 0.3e1 * t1699 + t1703 / 0.2e1 + t1706 + t1723 / 0.2e1 - 0.4e1 / 0.3e1 * t1725 - 0.4e1 / 0.3e1 * t1727 + t1731 / 0.2e1 + t1734 + t1751 / 0.2e1 + t1561;
  t1768 = t1721 * t46;
  t1773 = t1749 * t46;
  t1776 = 0.7e1 / 0.9e1 * t598 * t314 - 0.2e1 / 0.3e1 * t170 * t718 + t33 * t1768 / 0.4e1 - t319 * t606 / 0.3e1 + t51 * t1773 / 0.4e1;
  t1787 = t136 * t1753 + 0.11e2 / 0.3e1 * t262 * t801 + 0.11e2 / 0.6e1 * t396 * t549 + t139 * t1753 + 0.4e1 * t266 * t801 + 0.2e1 * t400 * t549 + t30 * t1776 / 0.2e1 + 0.4e1 / 0.3e1 * t191 * t734 + 0.2e1 / 0.3e1 * t332 * t609 + t64 * t1776 / 0.2e1 + 0.3e1 / 0.2e1 * t196 * t734;
  t1813 = 0.22e2 / 0.9e1 * t1695 - 0.4e1 / 0.3e1 * t1697 - 0.4e1 / 0.3e1 * t1699 + t1703 / 0.4e1 + t1706 / 0.2e1 + t1723 / 0.4e1 - 0.2e1 / 0.3e1 * t1725 - 0.2e1 / 0.3e1 * t1727 + t1731 / 0.4e1 + t1734 / 0.2e1 + t1751 / 0.4e1;
  t1822 = 0.3e1 / 0.4e1 * t337 * t609 + t68 * t1776 / 0.2e1 + 0.5e1 / 0.3e1 * t201 * t734 + 0.5e1 / 0.6e1 * t342 * t609 + t81 * t1776 / 0.2e1 + 0.11e2 / 0.6e1 * t206 * t734 + 0.11e2 / 0.12e2 * t347 * t609 + t85 * t1813 / 0.2e1 + 0.3e1 / 0.2e1 * t226 * t771 + 0.3e1 / 0.4e1 * t365 * t634 + t105 * t1813 / 0.2e1;
  t1845 = 0.5e1 / 0.3e1 * t231 * t771 + 0.5e1 / 0.6e1 * t370 * t634 + t110 * t1813 / 0.2e1 + 0.11e2 / 0.6e1 * t236 * t771 + 0.11e2 / 0.12e2 * t375 * t634 + t115 * t1813 / 0.2e1 + 0.2e1 * t242 * t771 + t381 * t634 + t119 * t1753 + 0.3e1 * t254 * t801 + 0.3e1 / 0.2e1 * t388 * t549;
  t1851 = t138 * t386;
  t1853 = t113 * t362;
  t1854 = t410 * t517;
  t1856 = t410 * t677;
  t1858 = t413 * t517;
  t1860 = t413 * t677;
  t1862 = t404 * t517;
  t1864 = t404 * t677;
  t1866 = t133 * t1753 + 0.10e2 / 0.3e1 * t258 * t801 + 0.5e1 / 0.3e1 * t392 * t549 + 0.2e1 * t1851 + t1853 - 0.12e2 * t1854 + 0.9e1 * t1856 - 0.40e2 / 0.3e1 * t1858 + 0.10e2 * t1860 - 0.28e2 / 0.3e1 * t1862 + 0.7e1 * t1864;
  t1868 = t407 * t517;
  t1870 = t407 * t677;
  t1872 = 0.12e2 * t1592;
  t1873 = 0.12e2 * t1596;
  t1878 = -0.32e2 / 0.3e1 * t1868 + 0.8e1 * t1870 - t1591 + t1872 - t1595 + t1873 - t1599 - 0.7e1 / 0.18e2 * t1605 - 0.7e1 / 0.18e2 * t1607 + 0.14e2 * t1611 - 0.8e1 / 0.9e1 * t1616;
  t1887 = 0.12e2 * t1647;
  t1888 = 0.12e2 * t1651;
  t1889 = -0.8e1 / 0.9e1 * t1618 + 0.16e2 * t1622 - 0.3e1 / 0.2e1 * t1627 - 0.3e1 / 0.2e1 * t1630 + 0.18e2 * t1634 - 0.20e2 / 0.9e1 * t1639 - 0.20e2 / 0.9e1 * t1641 + 0.20e2 * t1645 + t1887 - t1650 + t1888;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t1670 + t1693 + t1787 + t1822 + t1845 + t1866 + t1878 + t1889;

  t1899 = t1656 + t1657 + t1658 + t1659 + 0.7e1 / 0.3e1 * t1575 + 0.8e1 / 0.3e1 * t1578 + 0.3e1 * t1580 + 0.10e2 / 0.3e1 * t1582 - 0.14e2 / 0.3e1 * t1668 - 0.16e2 / 0.3e1 * t1671 - 0.6e1 * t1673;
  t1921 = -0.20e2 / 0.3e1 * t1675 + 0.2e1 / 0.9e1 * t973 * t188 + 0.3e1 / 0.8e1 * t976 * t188 + 0.5e1 / 0.9e1 * t981 * t188 + 0.55e2 / 0.72e2 * t985 * t188 + 0.3e1 / 0.8e1 * t988 * t223 + 0.5e1 / 0.9e1 * t991 * t223 + 0.55e2 / 0.72e2 * t994 * t223 + 0.3e1 / 0.4e1 * t997 * t252 + 0.10e2 / 0.9e1 * t1001 * t252 + 0.55e2 / 0.36e2 * t1004 * t252;
  t1925 = t1454 * t867;
  t1930 = t513 * t871;
  t1935 = -0.2e1 * t269 - 0.6e1 * t1461;
  t1939 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1925 * t174 + 0.16e2 / 0.9e1 * t710 * t517 + 0.4e1 / 0.9e1 * t1930 * t174 + 0.4e1 / 0.3e1 * t42 * t1935);
  t1940 = t1939 * t46;
  t1947 = t1472 * t886;
  t1952 = t532 * t889;
  t1955 = -t1935;
  t1959 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1947 * t181 - 0.16e2 / 0.9e1 * t723 * t517 + 0.4e1 / 0.9e1 * t1952 * t181 + 0.4e1 / 0.3e1 * t54 * t1955);
  t1960 = t1959 * t46;
  t1963 = -t170 * t876 / 0.3e1 + t33 * t1940 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t185 - 0.2e1 / 0.3e1 * t319 * t731 + t51 * t1960 / 0.4e1;
  t1986 = t30 * t1963 / 0.2e1 + 0.2e1 / 0.3e1 * t191 * t897 + 0.4e1 / 0.3e1 * t332 * t734 + t64 * t1963 / 0.2e1 + 0.3e1 / 0.4e1 * t196 * t897 + 0.3e1 / 0.2e1 * t337 * t734 + t68 * t1963 / 0.2e1 + 0.5e1 / 0.6e1 * t201 * t897 + 0.5e1 / 0.3e1 * t342 * t734 + t81 * t1963 / 0.2e1 + 0.11e2 / 0.12e2 * t206 * t897;
  t1989 = t212 * t915;
  t1991 = t1240 * t717;
  t1992 = t89 * t1991;
  t1994 = t212 * t918;
  t1996 = t755 * t875;
  t1997 = t89 * t1996;
  t1999 = t215 * t1939;
  t2000 = t89 * t1999;
  t2002 = t924 * t220;
  t2004 = t356 * t765;
  t2006 = t356 * t768;
  t2008 = t1266 * t730;
  t2009 = t96 * t2008;
  t2011 = t764 * t893;
  t2012 = t96 * t2011;
  t2014 = t219 * t1959;
  t2015 = t96 * t2014;
  t2017 = -0.2e1 / 0.3e1 * t1989 + t1992 / 0.2e1 - 0.2e1 / 0.3e1 * t1994 + t1997 / 0.4e1 + t2000 / 0.4e1 + 0.22e2 / 0.9e1 * t2002 - 0.4e1 / 0.3e1 * t2004 - 0.4e1 / 0.3e1 * t2006 + t2009 / 0.2e1 + t2012 / 0.4e1 + t2015 / 0.4e1;
  t2038 = 0.11e2 / 0.6e1 * t347 * t734 + t85 * t2017 / 0.2e1 + 0.3e1 / 0.4e1 * t226 * t936 + 0.3e1 / 0.2e1 * t365 * t771 + t105 * t2017 / 0.2e1 + 0.5e1 / 0.6e1 * t231 * t936 + 0.5e1 / 0.3e1 * t370 * t771 + t110 * t2017 / 0.2e1 + 0.11e2 / 0.12e2 * t236 * t936 + 0.11e2 / 0.6e1 * t375 * t771 + t115 * t2017 / 0.2e1;
  t2053 = -0.4e1 / 0.3e1 * t1989 + t1992 - 0.4e1 / 0.3e1 * t1994 + t1997 / 0.2e1 + t2000 / 0.2e1 + 0.44e2 / 0.9e1 * t2002 - 0.8e1 / 0.3e1 * t2004 - 0.8e1 / 0.3e1 * t2006 + t2009 + t2012 / 0.2e1 + t2015 / 0.2e1 + t1561;
  t2069 = t242 * t936 + 0.2e1 * t381 * t771 + t119 * t2053 + 0.3e1 / 0.2e1 * t254 * t960 + 0.3e1 * t388 * t801 + t133 * t2053 + 0.5e1 / 0.3e1 * t258 * t960 + 0.10e2 / 0.3e1 * t392 * t801 + t136 * t2053 + 0.11e2 / 0.6e1 * t262 * t960 + 0.11e2 / 0.3e1 * t396 * t801;
  t2080 = t1015 * t173;
  t2082 = t1015 * t270;
  t2084 = t139 * t2053 + 0.2e1 * t266 * t960 + 0.4e1 * t400 * t801 + t1584 + 0.2e1 * t1586 + 0.18e2 * t1856 + 0.20e2 * t1860 + 0.14e2 * t1864 + 0.16e2 * t1870 + 0.7e1 / 0.18e2 * t2080 - 0.7e1 / 0.18e2 * t2082;
  t2086 = t1018 * t173;
  t2088 = t1018 * t270;
  t2090 = t1021 * t173;
  t2092 = t1021 * t270;
  t2094 = t1024 * t173;
  t2096 = t1024 * t270;
  t2098 = 0.8e1 / 0.9e1 * t2086 - 0.8e1 / 0.9e1 * t2088 + 0.3e1 / 0.2e1 * t2090 - 0.3e1 / 0.2e1 * t2092 + 0.20e2 / 0.9e1 * t2094 - 0.20e2 / 0.9e1 * t2096 - t1591 - t1872 - t1595 - t1873 - t1599;
  t2107 = 0.28e2 / 0.3e1 * t1609 + 0.7e1 * t1611 + 0.32e2 / 0.3e1 * t1620 + 0.8e1 * t1622 + 0.12e2 * t1632 + 0.9e1 * t1634 + 0.40e2 / 0.3e1 * t1643 + 0.10e2 * t1645 - t1887 - t1650 - t1888;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t1899 + t1921 + t1986 + t2038 + t2069 + t2084 + t2098 + t2107;

  t2114 = t867 * t310;
  t2120 = -0.6e1 * t269 - 0.6e1 * t1461;
  t2124 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1454 * t2114 + 0.4e1 / 0.3e1 * t710 * t871 + 0.4e1 / 0.3e1 * t42 * t2120);
  t2125 = t2124 * t46;
  t2129 = 0.1e1 / t11 / t921;
  t2130 = t49 * t2129;
  t2136 = t886 * t322;
  t2141 = -t2120;
  t2145 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1472 * t2136 + 0.4e1 / 0.3e1 * t723 * t889 + 0.4e1 / 0.3e1 * t54 * t2141);
  t2146 = t2145 * t46;
  t2149 = t33 * t2125 / 0.4e1 - 0.70e2 / 0.27e2 * t2130 * t57 + 0.7e1 / 0.3e1 * t881 * t326 - t319 * t894 + t51 * t2146 / 0.4e1;
  t2155 = t1240 * t875;
  t2156 = t89 * t2155;
  t2158 = t215 * t2124;
  t2159 = t89 * t2158;
  t2161 = t921 * rho[1];
  t2163 = 0.1e1 / t25 / t2161;
  t2164 = sigma[2] * t2163;
  t2165 = t2164 * t98;
  t2167 = t924 * t359;
  t2169 = t356 * t930;
  t2171 = t356 * t933;
  t2173 = t1266 * t893;
  t2174 = t96 * t2173;
  t2176 = t219 * t2145;
  t2177 = t96 * t2176;
  t2179 = 0.3e1 / 0.4e1 * t2156 + t2159 / 0.4e1 - 0.154e3 / 0.27e2 * t2165 + 0.22e2 / 0.3e1 * t2167 - 0.2e1 * t2169 - 0.2e1 * t2171 + 0.3e1 / 0.4e1 * t2174 + t2177 / 0.4e1;
  t2204 = 0.3e1 / 0.2e1 * t2156 + t2159 / 0.2e1 - 0.308e3 / 0.27e2 * t2165 + 0.44e2 / 0.3e1 * t2167 - 0.4e1 * t2169 - 0.4e1 * t2171 + 0.3e1 / 0.2e1 * t2174 + t2177 / 0.2e1 + t1561;
  t2209 = t85 * t2179 / 0.2e1 + 0.9e1 / 0.4e1 * t365 * t936 + t105 * t2179 / 0.2e1 + 0.5e1 / 0.2e1 * t370 * t936 + t110 * t2179 / 0.2e1 + 0.11e2 / 0.4e1 * t375 * t936 + t115 * t2179 / 0.2e1 + 0.3e1 * t381 * t936 + t119 * t2204 + 0.9e1 / 0.2e1 * t388 * t960 + t133 * t2204;
  t2231 = 0.5e1 * t392 * t960 + t136 * t2204 + 0.11e2 / 0.2e1 * t396 * t960 + t139 * t2204 + 0.6e1 * t400 * t960 + t30 * t2149 / 0.2e1 + 0.2e1 * t332 * t897 + t64 * t2149 / 0.2e1 + 0.9e1 / 0.4e1 * t337 * t897 + t68 * t2149 / 0.2e1 + 0.5e1 / 0.2e1 * t342 * t897;
  t2252 = 0.2e1 / 0.3e1 * t973 * t329 + 0.9e1 / 0.8e1 * t976 * t329 + 0.5e1 / 0.3e1 * t981 * t329 + 0.55e2 / 0.24e2 * t985 * t329 + 0.9e1 / 0.8e1 * t988 * t362 + 0.5e1 / 0.3e1 * t991 * t362 + 0.55e2 / 0.24e2 * t994 * t362 + 0.9e1 / 0.4e1 * t997 * t386 + 0.6e1 * t1851 + 0.3e1 * t1853 - 0.35e2 / 0.216e3 * t1 * t1343;
  t2257 = 0.1e1 / t19;
  t2262 = t141 * t1343;
  t2265 = t147 * t1347;
  t2268 = t150 * t2257;
  t2271 = t153 * t50;
  t2278 = t29 * t1347;
  t2282 = t63 * t2257;
  t2285 = t67 * t50;
  t2288 = 0.1e1 / t5;
  t2289 = t71 * t2288;
  t2292 = t84 * t2257;
  t2295 = t104 * t50;
  t2298 = t109 * t2288;
  t2301 = t118 * t2257;
  t2304 = t132 * t50;
  t2307 = t135 * t2288;
  t2312 = -0.3e1 / 0.16e2 * t2282 * t60 - 0.5e1 / 0.27e2 * t2285 * t60 - 0.55e2 / 0.432e3 * t2289 * t60 - 0.3e1 / 0.16e2 * t2292 * t101 - 0.5e1 / 0.27e2 * t2295 * t101 - 0.55e2 / 0.432e3 * t2298 * t101 - 0.3e1 / 0.8e1 * t2301 * t130 - 0.10e2 / 0.27e2 * t2304 * t130 - 0.55e2 / 0.216e3 * t2307 * t130 + 0.36e2 * t1854 + 0.27e2 * t1856;
  t2325 = 0.40e2 * t1858 + 0.30e2 * t1860 + 0.28e2 * t1862 + 0.21e2 * t1864 + 0.32e2 * t1868 + 0.24e2 * t1870 - 0.7e1 / 0.6e1 * t2080 - 0.7e1 / 0.6e1 * t2082 - 0.8e1 / 0.3e1 * t2086 - 0.8e1 / 0.3e1 * t2088 - 0.9e1 / 0.2e1 * t2090;
  t2329 = -0.9e1 / 0.2e1 * t2092 - 0.20e2 / 0.3e1 * t2094 - 0.20e2 / 0.3e1 * t2096 - t1591 - t1593 - t1595 - t1597 - t1599 - t1648 - t1650 - t1652;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = t2329 + t2325 + t2312 + t2252 + t2231 + t2209 + 0.9e1 * t1673 + 0.10e2 * t1675 + 0.7e1 * t1668 + 0.8e1 * t1671 - t1426 - t1428 - t1422 - t1424 - 0.8e1 / 0.27e2 * t8 * t1347 - 0.3e1 / 0.8e1 * t15 * t2257 - 0.10e2 / 0.27e2 * t22 * t50 - 0.35e2 / 0.216e3 * t2262 * t145 - 0.8e1 / 0.27e2 * t2265 * t145 - 0.3e1 / 0.8e1 * t2268 * t145 - 0.10e2 / 0.27e2 * t2271 * t145 + 0.10e2 / 0.3e1 * t1001 * t386 + 0.55e2 / 0.12e2 * t1004 * t386 - 0.4e1 / 0.27e2 * t2278 * t60 + t81 * t2149 / 0.2e1 + 0.11e2 / 0.4e1 * t347 * t897;

  t2333 = t597 * t44 * t46;
  t2341 = t169 * t177 * t46;
  t2346 = t105 * t211;
  t2351 = t110 * t211;
  t2356 = t115 * t211;
  t2362 = t32 * t523 * t46;
  t2369 = 0.7e1 / 0.36e2 * t427 * t2333 + 0.7e1 / 0.36e2 * t430 * t2333 + 0.7e1 / 0.36e2 * t419 * t2333 - t427 * t2341 / 0.6e1 - t430 * t2341 / 0.6e1 - 0.2e1 / 0.3e1 * t2346 * t216 + t1058 * t524 / 0.8e1 - 0.2e1 / 0.3e1 * t2351 * t216 + t1061 * t524 / 0.8e1 - 0.2e1 / 0.3e1 * t2356 * t216 + t1064 * t524 / 0.8e1 + t419 * t2362 / 0.16e2 + t424 * t2362 / 0.16e2 + t427 * t2362 / 0.16e2;
  t2372 = t85 * t211;
  t2384 = t88 * t508 * t45;
  t2388 = t502 * t90 * t45;
  t2403 = t430 * t2362 / 0.16e2 - 0.2e1 / 0.3e1 * t2372 * t216 + t1055 * t524 / 0.8e1 - t419 * t2341 / 0.6e1 - t424 * t2341 / 0.6e1 + 0.7e1 / 0.36e2 * t424 * t2333 + t105 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t2388 + t110 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2388 + t115 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2388 + t85 * t2384 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2388;
  t2406 = t418 * t177 * t46;
  t2423 = t63 * t1114;
  t2426 = t67 * t1118;
  t2429 = t71 * t1378;
  t2432 = t29 * t1110;
  t2437 = t84 / t2 / t209;
  t2440 = 0.1e1 / t209;
  t2441 = t104 * t2440;
  t2444 = 0.5e1 / 0.24e2 * t1099 * t2406 + 0.11e2 / 0.48e2 * t1102 * t2406 + 0.3e1 / 0.8e1 * t1107 * t216 + 0.5e1 / 0.12e2 * t1111 * t216 + 0.11e2 / 0.24e2 * t1115 * t216 + t1119 * t216 / 0.2e1 + t1091 * t2406 / 0.6e1 + 0.3e1 / 0.16e2 * t1096 * t2406 - 0.13e2 / 0.64e2 * t2423 * t1093 - 0.5e1 / 0.24e2 * t2426 * t1093 - 0.121e3 / 0.576e3 * t2429 * t1093 - 0.7e1 / 0.36e2 * t2432 * t1093 - 0.29e2 / 0.64e2 * t2437 * t91 - 0.35e2 / 0.72e2 * t2441 * t91;
  t2446 = 0.1e1 / t74 / t86;
  t2447 = t109 * t2446;
  t2450 = t113 * t88;
  t2451 = t2450 * t91;
  t2456 = t211 * t44;
  t2462 = 0.88e2 / 0.9e1 * t546;
  t2463 = 0.22e2 / 0.9e1 * t2388 - 0.8e1 / 0.3e1 * t2456 * t755 + t2384 / 0.2e1 + t1032 * t1701 / 0.2e1 - t2462;
  t2481 = 0.2e1 * t138 * t444;
  t2482 = -0.33e2 / 0.64e2 * t2447 * t91 - 0.13e2 / 0.24e2 * t2451 + 0.3e1 * t254 * t1036 + t133 * t2463 + 0.10e2 / 0.3e1 * t258 * t1036 + t136 * t2463 + 0.11e2 / 0.3e1 * t262 * t1036 + t139 * t2463 + 0.4e1 * t266 * t1036 + t119 * t2463 + 0.3e1 / 0.4e1 * t579 * t444 + 0.10e2 / 0.9e1 * t582 * t444 + 0.55e2 / 0.36e2 * t585 * t444 + t2481;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t2369 + t2403 + t2444 + t2482;

  t2486 = t254 * t249;
  t2489 = 0.176e3 / 0.9e1 * t119 * t546;
  t2492 = t258 * t249;
  t2495 = 0.176e3 / 0.9e1 * t133 * t546;
  t2498 = t262 * t249;
  t2501 = 0.176e3 / 0.9e1 * t136 * t546;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t266 * t249;
  t2507 = 0.176e3 / 0.9e1 * t139 * t546;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = -0.3e1 / 0.2e1 * t579 * t128 + 0.16e2 * t2486 - t2489 - 0.20e2 / 0.9e1 * t582 * t128 + 0.160e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t585 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  t2511 = t50 * t540 * t46;
  t2514 = t226 * t95;
  t2519 = t231 * t95;
  t2524 = t236 * t95;
  t2529 = t242 * t95;
  t2546 = t559 * t454;
  t2549 = t562 * t454;
  t2552 = t566 * t454;
  t2555 = t556 * t454;
  t2558 = t1179 * t541 / 0.8e1 + t466 * t2511 / 0.16e2 + 0.3e1 / 0.8e1 * t2514 * t220 + t1163 * t541 / 0.8e1 + 0.5e1 / 0.12e2 * t2519 * t220 + t1168 * t541 / 0.8e1 + 0.11e2 / 0.24e2 * t2524 * t220 + t1174 * t541 / 0.8e1 + t2529 * t220 / 0.2e1 + t1139 * t1143 / 0.6e1 + t455 * t2511 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2511 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2511 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + 0.3e1 / 0.64e2 * t2546 * t457 + 0.5e1 / 0.72e2 * t2549 * t457 + 0.55e2 / 0.576e3 * t2552 * t457 + t2555 * t457 / 0.36e2;
  t2560 = t95 * t527 * t45;
  t2575 = t113 * t95;
  t2576 = t2575 * t98;
  t2589 = t2560 / 0.2e1 + t1184 * t1729 / 0.2e1 - t2462;
  t2601 = 0.2e1 * t138 * t480;
  t2602 = t115 * t2560 / 0.8e1 + 0.3e1 / 0.64e2 * t569 * t470 + t85 * t2560 / 0.8e1 + 0.5e1 / 0.72e2 * t572 * t470 + t105 * t2560 / 0.8e1 + 0.55e2 / 0.576e3 * t576 * t470 + t110 * t2560 / 0.8e1 + t2576 / 0.8e1 + 0.3e1 / 0.4e1 * t579 * t480 + 0.10e2 / 0.9e1 * t582 * t480 + 0.55e2 / 0.36e2 * t585 * t480 + 0.3e1 * t254 * t1187 + t119 * t2589 + 0.10e2 / 0.3e1 * t258 * t1187 + t133 * t2589 + 0.11e2 / 0.3e1 * t262 * t1187 + t136 * t2589 + 0.4e1 * t266 * t1187 + t139 * t2589 + t2601;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t2558 + t2602;

  t2606 = t169 * t313 * t46;
  t2624 = t32 * t717 * t46;
  t2627 = t365 * t88;
  t2634 = t370 * t88;
  t2637 = -t1199 * t1073 / 0.9e1 - t419 * t2606 / 0.12e2 - t1206 * t1073 / 0.8e1 - t424 * t2606 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1073 - t427 * t2606 / 0.12e2 + t1064 * t756 / 0.8e1 + t1064 * t759 / 0.8e1 + 0.11e2 / 0.96e2 * t1216 * t1050 + t430 * t2624 / 0.16e2 + 0.3e1 / 0.16e2 * t2627 * t216 + t1055 * t756 / 0.8e1 + t1055 * t759 / 0.8e1 + 0.5e1 / 0.24e2 * t2634 * t216;
  t2642 = t375 * t88;
  t2649 = t381 * t88;
  t2668 = t1058 * t756 / 0.8e1 + t1058 * t759 / 0.8e1 + 0.11e2 / 0.48e2 * t2642 * t216 + t1061 * t756 / 0.8e1 + t1061 * t759 / 0.8e1 + t2649 * t216 / 0.4e1 + t1199 * t1050 / 0.12e2 + t419 * t2624 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1050 + t424 * t2624 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1050 + t427 * t2624 / 0.16e2 - 0.11e2 / 0.72e2 * t1216 * t1073 - t430 * t2606 / 0.12e2;
  t2679 = t418 * t313 * t46;
  t2700 = -t2372 * t350 / 0.3e1 - t2346 * t350 / 0.3e1 - t2351 * t350 / 0.3e1 - t2356 * t350 / 0.3e1 + t1091 * t2679 / 0.12e2 + 0.3e1 / 0.32e2 * t1096 * t2679 + 0.5e1 / 0.48e2 * t1099 * t2679 + 0.11e2 / 0.96e2 * t1102 * t2679 + 0.3e1 / 0.16e2 * t1107 * t350 + 0.5e1 / 0.24e2 * t1111 * t350 + 0.11e2 / 0.48e2 * t1115 * t350 + t1119 * t350 / 0.4e1 - t365 * t1030 / 0.4e1 - 0.5e1 / 0.18e2 * t370 * t1030;
  t2709 = t88 * t177;
  t2712 = t45 * t717;
  t2715 = -0.4e1 / 0.3e1 * t2456 * t1240 + t2709 * t1240 / 0.2e1 + t1032 * t2712 / 0.2e1 - t2462;
  t2734 = -0.11e2 / 0.36e2 * t375 * t1030 - t381 * t1030 / 0.3e1 + 0.2e1 * t400 * t1036 + t139 * t2715 + 0.2e1 * t266 * t1243 + 0.3e1 / 0.2e1 * t388 * t1036 + t119 * t2715 + 0.3e1 / 0.2e1 * t254 * t1243 + 0.5e1 / 0.3e1 * t392 * t1036 + t133 * t2715 + 0.5e1 / 0.3e1 * t258 * t1243 + 0.11e2 / 0.6e1 * t396 * t1036 + t136 * t2715 + 0.11e2 / 0.6e1 * t262 * t1243;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t2637 + t2668 + t2700 + t2734;

  t2736 = t388 * t249;
  t2739 = t392 * t249;
  t2742 = t396 * t249;
  t2745 = t400 * t249;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.80e2 / 0.9e1 * t2739 + 0.80e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  t2750 = t85 * t355;
  t2759 = t105 * t355;
  t2768 = t110 * t355;
  t2777 = t115 * t355;
  t2780 = 0.11e2 / 0.96e2 * t1156 * t1283 - t2750 * t220 / 0.3e1 + t1163 * t765 / 0.8e1 + t1163 * t768 / 0.8e1 + 0.3e1 / 0.16e2 * t2514 * t359 - t2759 * t220 / 0.3e1 + t1168 * t765 / 0.8e1 + t1168 * t768 / 0.8e1 + 0.5e1 / 0.24e2 * t2519 * t359 - t2768 * t220 / 0.3e1 + t1174 * t765 / 0.8e1 + t1174 * t768 / 0.8e1 + 0.11e2 / 0.48e2 * t2524 * t359 - t2777 * t220 / 0.3e1;
  t2784 = t50 * t730 * t46;
  t2796 = t318 * t184 * t46;
  t2813 = t1179 * t765 / 0.8e1 + t460 * t2784 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1283 + t463 * t2784 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1283 + t466 * t2784 / 0.16e2 - t466 * t2796 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1302 + t1179 * t768 / 0.8e1 + t2529 * t359 / 0.4e1 + t455 * t2784 / 0.16e2 + t1139 * t1283 / 0.12e2 - t455 * t2796 / 0.12e2 - t1139 * t1302 / 0.9e1;
  t2836 = t454 * t184 * t46;
  t2845 = -t460 * t2796 / 0.12e2 - t1146 * t1302 / 0.8e1 - t463 * t2796 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1302 + 0.11e2 / 0.48e2 * t1344 * t220 + t1348 * t220 / 0.4e1 - t226 * t1264 / 0.4e1 - 0.5e1 / 0.18e2 * t231 * t1264 - 0.11e2 / 0.36e2 * t236 * t1264 - t242 * t1264 / 0.3e1 + t1320 * t2836 / 0.12e2 + 0.3e1 / 0.32e2 * t1325 * t2836 + 0.5e1 / 0.48e2 * t1328 * t2836 + 0.11e2 / 0.96e2 * t1331 * t2836;
  t2850 = t355 * t56;
  t2853 = t95 * t184;
  t2856 = t45 * t730;
  t2859 = -0.4e1 / 0.3e1 * t2850 * t764 + t2853 * t1266 / 0.2e1 + t1184 * t2856 / 0.2e1 - t2462;
  t2880 = 0.3e1 / 0.16e2 * t1336 * t220 + 0.5e1 / 0.24e2 * t1340 * t220 + t119 * t2859 + 0.3e1 / 0.2e1 * t254 * t1269 + 0.3e1 / 0.2e1 * t388 * t1187 + t133 * t2859 + 0.5e1 / 0.3e1 * t258 * t1269 + 0.5e1 / 0.3e1 * t392 * t1187 + t136 * t2859 + 0.11e2 / 0.6e1 * t262 * t1269 + 0.11e2 / 0.6e1 * t396 * t1187 + t139 * t2859 + 0.2e1 * t266 * t1269 + 0.2e1 * t400 * t1187;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t2780 + t2813 + t2845 + t2880;

  t2893 = t32 * t875 * t46;
  t2904 = t973 * t418;
  t2907 = t976 * t418;
  t2910 = t981 * t418;
  t2913 = t985 * t418;
  t2928 = 0.5e1 / 0.12e2 * t2634 * t350 + t1058 * t918 / 0.8e1 + 0.11e2 / 0.24e2 * t2642 * t350 + t1061 * t918 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2893 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t424 * t2893 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2893 / 0.16e2 + t2904 * t421 / 0.36e2 + 0.3e1 / 0.64e2 * t2907 * t421 + 0.5e1 / 0.72e2 * t2910 * t421 + 0.55e2 / 0.576e3 * t2913 * t421 + t2649 * t350 / 0.2e1 + t1064 * t918 / 0.8e1 + 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2893 / 0.16e2 + 0.3e1 / 0.8e1 * t2627 * t350 + t1055 * t918 / 0.8e1;
  t2930 = t88 * t914 * t45;
  t2949 = t45 * t875;
  t2952 = t2930 / 0.2e1 + t1032 * t2949 / 0.2e1 - t2462;
  t2969 = t115 * t2930 / 0.8e1 + 0.3e1 / 0.64e2 * t988 * t434 + t85 * t2930 / 0.8e1 + 0.5e1 / 0.72e2 * t991 * t434 + t105 * t2930 / 0.8e1 + 0.55e2 / 0.576e3 * t994 * t434 + t110 * t2930 / 0.8e1 + t2451 / 0.8e1 + 0.3e1 * t388 * t1243 + t119 * t2952 + 0.10e2 / 0.3e1 * t392 * t1243 + t133 * t2952 + 0.11e2 / 0.3e1 * t396 * t1243 + t136 * t2952 + 0.4e1 * t400 * t1243 + t139 * t2952 + 0.3e1 / 0.4e1 * t997 * t444 + 0.10e2 / 0.9e1 * t1001 * t444 + 0.55e2 / 0.36e2 * t1004 * t444 + t2481;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t2928 + t2969;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = -0.3e1 / 0.2e1 * t997 * t128 + 0.16e2 * t2736 - t2489 - 0.20e2 / 0.9e1 * t1001 * t128 + 0.160e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t1004 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  t2995 = t50 * t893 * t46;
  t2999 = t880 * t56 * t46;
  t3003 = t318 * t325 * t46;
  t3014 = -0.2e1 / 0.3e1 * t2750 * t359 + t1163 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2759 * t359 + t1168 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2768 * t359 + t1174 * t933 / 0.8e1 - 0.2e1 / 0.3e1 * t2777 * t359 + t460 * t2995 / 0.16e2 + 0.7e1 / 0.36e2 * t466 * t2999 - t455 * t3003 / 0.6e1 + 0.7e1 / 0.36e2 * t455 * t2999 + 0.7e1 / 0.36e2 * t460 * t2999 + 0.7e1 / 0.36e2 * t463 * t2999 - t460 * t3003 / 0.6e1;
  t3028 = t454 * t325 * t46;
  t3032 = t95 * t929 * t45;
  t3035 = t29 * t1339;
  t3038 = t63 * t1343;
  t3041 = t67 * t1347;
  t3044 = t71 * t2257;
  t3048 = t923 * t97 * t45;
  t3053 = -t463 * t3003 / 0.6e1 - t466 * t3003 / 0.6e1 + t1179 * t933 / 0.8e1 + t455 * t2995 / 0.16e2 + t463 * t2995 / 0.16e2 + t466 * t2995 / 0.16e2 + t1320 * t3028 / 0.6e1 + t115 * t3032 / 0.8e1 - 0.7e1 / 0.36e2 * t3035 * t1322 - 0.13e2 / 0.64e2 * t3038 * t1322 - 0.5e1 / 0.24e2 * t3041 * t1322 - 0.121e3 / 0.576e3 * t3044 * t1322 + 0.11e2 / 0.18e2 * t85 * t3048 + t85 * t3032 / 0.8e1;
  t3082 = 0.11e2 / 0.18e2 * t105 * t3048 + t105 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t110 * t3048 + t110 * t3032 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t3048 + 0.3e1 / 0.16e2 * t1325 * t3028 + 0.5e1 / 0.24e2 * t1328 * t3028 + 0.11e2 / 0.48e2 * t1331 * t3028 + 0.3e1 / 0.8e1 * t1336 * t359 + 0.5e1 / 0.12e2 * t1340 * t359 + 0.11e2 / 0.24e2 * t1344 * t359 + t1348 * t359 / 0.2e1 - 0.13e2 / 0.24e2 * t2576 + 0.3e1 / 0.4e1 * t997 * t480;
  t3091 = t45 * t893;
  t3094 = 0.22e2 / 0.9e1 * t3048 - 0.8e1 / 0.3e1 * t2850 * t1266 + t3032 / 0.2e1 + t1184 * t3091 / 0.2e1 - t2462;
  t3109 = t84 / t4 / t353;
  t3112 = 0.1e1 / t353;
  t3113 = t104 * t3112;
  t3117 = 0.1e1 / t78 / t93;
  t3118 = t109 * t3117;
  t3121 = 0.10e2 / 0.9e1 * t1001 * t480 + 0.55e2 / 0.36e2 * t1004 * t480 + t119 * t3094 + 0.3e1 * t388 * t1269 + t133 * t3094 + 0.10e2 / 0.3e1 * t392 * t1269 + t136 * t3094 + 0.11e2 / 0.3e1 * t396 * t1269 + t139 * t3094 + 0.4e1 * t400 * t1269 + t2601 - 0.29e2 / 0.64e2 * t3109 * t98 - 0.35e2 / 0.72e2 * t3113 * t98 - 0.33e2 / 0.64e2 * t3118 * t98;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t3014 + t3053 + t3082 + t3121;

  t3124 = t1353 * t44 * t46;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t1091 * t3124 / 0.24e2 + t1354 * t1073 / 0.24e2 - t1354 * t1050 / 0.32e2 - 0.3e1 / 0.64e2 * t1096 * t3124 + t1356 * t1073 / 0.24e2 - t1356 * t1050 / 0.32e2 - 0.5e1 / 0.96e2 * t1099 * t3124 + t1358 * t1073 / 0.24e2 - t1358 * t1050 / 0.32e2 - 0.11e2 / 0.192e3 * t1102 * t3124 + t1360 * t1073 / 0.24e2 - t1360 * t1050 / 0.32e2;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t3149 = t191 * t1364;
  t3154 = t196 * t1364;
  t3159 = t201 * t1364;
  t3164 = t206 * t1364;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  t3169 = t332 * t1353;
  t3174 = t337 * t1353;
  t3179 = t342 * t1353;
  t3184 = t347 * t1353;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t3190 = t1364 * t56 * t46;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = -t1320 * t3190 / 0.24e2 + t1365 * t1302 / 0.24e2 - t1365 * t1283 / 0.32e2 - 0.3e1 / 0.64e2 * t1325 * t3190 + t1367 * t1302 / 0.24e2 - t1367 * t1283 / 0.32e2 - 0.5e1 / 0.96e2 * t1328 * t3190 + t1369 * t1302 / 0.24e2 - t1369 * t1283 / 0.32e2 - 0.11e2 / 0.192e3 * t1331 * t3190 + t1371 * t1302 / 0.24e2 - t1371 * t1283 / 0.32e2;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t3239 = t142 * t676;
  t3240 = 0.72e2 * t3239;
  t3241 = t148 * t676;
  t3242 = 0.72e2 * t3241;
  t3253 = 0.1e1 / t16 / t86;
  t3275 = t3240 + t3242 - 0.3e1 / 0.2e1 * t1412 * t252 - 0.40e2 / 0.27e2 * t1415 * t252 - 0.55e2 / 0.54e2 * t1418 * t252 + 0.20e2 / 0.81e2 * t29 * t88 * t60 + 0.9e1 / 0.32e2 * t63 * t3253 * t60 + 0.20e2 / 0.81e2 * t67 * t169 * t60 + 0.385e3 / 0.2592e4 * t71 * t1106 * t60 + 0.9e1 / 0.32e2 * t84 * t3253 * t101 + 0.20e2 / 0.81e2 * t104 * t169 * t101 + 0.385e3 / 0.2592e4 * t109 * t1106 * t101 + 0.9e1 / 0.16e2 * t118 * t3253 * t130;
  t3282 = t154 * t676;
  t3283 = 0.72e2 * t3282;
  t3284 = t692 * t144;
  t3286 = t288 * t269;
  t3288 = t699 * t144;
  t3290 = t291 * t269;
  t3292 = t659 * t144;
  t3294 = t294 * t269;
  t3296 = t667 * t144;
  t3298 = t297 * t269;
  t3304 = sigma[0] / t23 / t500 / t86 * t91;
  t3306 = t1508 * t216;
  t3308 = t503 * t509;
  t3310 = t503 * t524;
  t3312 = t212 * t1517;
  t3314 = t212 * t1520;
  t3316 = t523 * t523;
  t3318 = t89 * t3316 * t45;
  t3321 = t89 * t755 * t1467;
  t3323 = t38 * t38;
  t3325 = 0.1e1 / t512 / t3323;
  t3326 = t514 * t514;
  t3332 = t519 * t519;
  t3337 = t34 * t1588;
  t3339 = -0.24e2 * t676 + 0.24e2 * t3337;
  t3343 = my_piecewise3(t39, 0, 0.40e2 / 0.81e2 * t3325 * t3326 - 0.16e2 / 0.9e1 * t1454 * t514 * t519 + 0.4e1 / 0.3e1 * t513 * t3332 + 0.16e2 / 0.9e1 * t1458 * t1463 + 0.4e1 / 0.3e1 * t42 * t3339);
  t3345 = t89 * t215 * t3343;
  t3347 = t540 * t540;
  t3349 = t96 * t3347 * t45;
  t3352 = t96 * t764 * t1483;
  t3354 = t52 * t52;
  t3356 = 0.1e1 / t531 / t3354;
  t3357 = t533 * t533;
  t3363 = t536 * t536;
  t3372 = my_piecewise3(t53, 0, 0.40e2 / 0.81e2 * t3356 * t3357 - 0.16e2 / 0.9e1 * t1472 * t533 * t536 + 0.4e1 / 0.3e1 * t532 * t3363 + 0.16e2 / 0.9e1 * t1476 * t1479 - 0.4e1 / 0.3e1 * t54 * t3339);
  t3374 = t96 * t219 * t3372;
  t3376 = t544 * t124;
  t3380 = 0.20944e5 / 0.81e2 * t123 / t126 / t3376;
  t3381 = 0.5236e4 / 0.81e2 * t3304 - 0.2464e4 / 0.27e2 * t3306 + 0.88e2 / 0.3e1 * t3308 + 0.88e2 / 0.3e1 * t3310 - 0.16e2 * t3312 - 0.16e2 / 0.3e1 * t3314 + 0.3e1 / 0.2e1 * t3318 + 0.2e1 * t3321 + t3345 / 0.2e1 + 0.3e1 / 0.2e1 * t3349 + 0.2e1 * t3352 + t3374 / 0.2e1 - t3380;
  t3386 = 0.40e2 / 0.81e2 * t132 * t169 * t130 + 0.385e3 / 0.1296e4 * t135 * t1106 * t130 + t3283 + 0.7e1 / 0.3e1 * t3284 - 0.56e2 * t3286 + 0.16e2 / 0.3e1 * t3288 - 0.64e2 * t3290 + 0.9e1 * t3292 - 0.72e2 * t3294 + 0.40e2 / 0.3e1 * t3296 - 0.80e2 * t3298 + t119 * t3381 + 0.6e1 * t254 * t1562 + t133 * t3381;
  t3415 = 0.910e3 / 0.81e2 * t31 / t9 / t1505 * t47 - 0.280e3 / 0.27e2 * t1447 * t178 + 0.14e2 / 0.3e1 * t598 * t603 - 0.4e1 / 0.3e1 * t170 * t1468 + t33 * t3343 * t46 / 0.4e1 + t51 * t3372 * t46 / 0.4e1;
  t3438 = 0.2618e4 / 0.81e2 * t3304 - 0.1232e4 / 0.27e2 * t3306 + 0.44e2 / 0.3e1 * t3308 + 0.44e2 / 0.3e1 * t3310 - 0.8e1 * t3312 - 0.8e1 / 0.3e1 * t3314 + 0.3e1 / 0.4e1 * t3318 + t3321 + t3345 / 0.4e1 + 0.3e1 / 0.4e1 * t3349 + t3352 + t3374 / 0.4e1;
  t3441 = 0.20e2 / 0.3e1 * t258 * t1562 + t136 * t3381 + 0.22e2 / 0.3e1 * t262 * t1562 + t139 * t3381 + 0.8e1 * t266 * t1562 + 0.8e1 / 0.3e1 * t191 * t1487 + t64 * t3415 / 0.2e1 + 0.3e1 * t196 * t1487 + t68 * t3415 / 0.2e1 + 0.10e2 / 0.3e1 * t201 * t1487 + t81 * t3415 / 0.2e1 + 0.11e2 / 0.3e1 * t206 * t1487 + t85 * t3438 / 0.2e1;
  t3470 = 0.3e1 * t226 * t1529 + t105 * t3438 / 0.2e1 + 0.10e2 / 0.3e1 * t231 * t1529 + t110 * t3438 / 0.2e1 + 0.11e2 / 0.3e1 * t236 * t1529 + t115 * t3438 / 0.2e1 + 0.4e1 * t242 * t1529 - 0.3e1 / 0.4e1 * t1392 * t188 - 0.20e2 / 0.27e2 * t1395 * t188 - 0.55e2 / 0.108e3 * t1400 * t188 - 0.3e1 / 0.4e1 * t1403 * t223 - 0.20e2 / 0.27e2 * t1406 * t223 - 0.55e2 / 0.108e3 * t1409 * t223 + 0.4e1 / 0.3e1 * t556 * t609;
  t3495 = t151 * t676;
  t3496 = 0.72e2 * t3495;
  t3499 = 0.9e1 / 0.4e1 * t559 * t609 + 0.10e2 / 0.3e1 * t562 * t609 + 0.55e2 / 0.12e2 * t566 * t609 + 0.9e1 / 0.4e1 * t569 * t634 + 0.10e2 / 0.3e1 * t572 * t634 + 0.55e2 / 0.12e2 * t576 * t634 + t30 * t3415 / 0.2e1 + 0.9e1 / 0.2e1 * t579 * t549 + 0.20e2 / 0.3e1 * t582 * t549 + 0.55e2 / 0.6e1 * t585 * t549 - 0.16e2 / 0.27e2 * t1389 * t188 + t3496 + 0.385e3 / 0.1296e4 * t1 * t2446;
  t3506 = t138 * t549;
  t3508 = t113 * t634;
  t3510 = t294 * t1589;
  t3512 = t297 * t1461;
  t3514 = t297 * t1589;
  t3519 = t1624 * t173;
  t3521 = t1624 * t270;
  t3523 = t659 * t517;
  t3525 = t659 * t677;
  t3530 = 0.40e2 / 0.81e2 * t8 * t88 + 0.9e1 / 0.16e2 * t15 * t3253 + 0.40e2 / 0.81e2 * t22 * t169 + 0.12e2 * t3506 + 0.6e1 * t3508 - 0.144e3 * t3510 + 0.240e3 * t3512 - 0.160e3 * t3514 + 0.9e1 / 0.16e2 * t150 * t3253 * t145 - 0.3e1 * t3519 + 0.3e1 * t3521 - 0.36e2 * t3523 + 0.27e2 * t3525 + 0.40e2 / 0.81e2 * t153 * t169 * t145;
  t3532 = t1636 * t173;
  t3534 = t1636 * t270;
  t3536 = t667 * t517;
  t3538 = t667 * t677;
  t3540 = t142 * t3337;
  t3541 = 0.192e3 * t3540;
  t3542 = 0.1e1 / t3376;
  t3543 = t143 * t3542;
  t3545 = 0.120e3 * t142 * t3543;
  t3546 = t148 * t3337;
  t3547 = 0.192e3 * t3546;
  t3549 = 0.120e3 * t148 * t3543;
  t3550 = t151 * t3337;
  t3551 = 0.192e3 * t3550;
  t3553 = 0.120e3 * t151 * t3543;
  t3554 = t154 * t3337;
  t3555 = 0.192e3 * t3554;
  t3557 = 0.120e3 * t154 * t3543;
  t3561 = -0.80e2 / 0.27e2 * t3532 + 0.80e2 / 0.27e2 * t3534 - 0.160e3 / 0.3e1 * t3536 + 0.40e2 * t3538 - t3541 + t3545 - t3547 + t3549 - t3551 + t3553 - t3555 + t3557 + 0.385e3 / 0.1296e4 * t141 * t2446 * t145;
  t3562 = t1600 * t173;
  t3564 = t1600 * t270;
  t3566 = t692 * t517;
  t3568 = t692 * t677;
  t3570 = t288 * t1461;
  t3572 = t288 * t1589;
  t3577 = t1613 * t173;
  t3579 = t1613 * t270;
  t3581 = t699 * t517;
  t3583 = t699 * t677;
  t3585 = t291 * t1461;
  t3587 = t291 * t1589;
  t3589 = t294 * t1461;
  t3591 = -0.35e2 / 0.27e2 * t3562 + 0.35e2 / 0.27e2 * t3564 - 0.28e2 / 0.3e1 * t3566 + 0.7e1 * t3568 + 0.168e3 * t3570 - 0.112e3 * t3572 + 0.40e2 / 0.81e2 * t147 * t88 * t145 - 0.64e2 / 0.27e2 * t3577 + 0.64e2 / 0.27e2 * t3579 - 0.64e2 / 0.3e1 * t3581 + 0.16e2 * t3583 + 0.192e3 * t3585 - 0.128e3 * t3587 + 0.216e3 * t3589;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = t3275 + t3386 + t3441 + t3470 + t3499 + t3530 + t3561 + t3591;

  t3594 = t410 * t1461;
  t3595 = 0.54e2 * t3594;
  t3596 = t410 * t1589;
  t3598 = t413 * t1461;
  t3599 = 0.60e2 * t3598;
  t3600 = t413 * t1589;
  t3602 = t404 * t1461;
  t3603 = 0.42e2 * t3602;
  t3604 = t404 * t1589;
  t3606 = t407 * t1461;
  t3607 = 0.48e2 * t3606;
  t3608 = t407 * t1589;
  t3611 = 0.14e2 * t3286;
  t3613 = 0.16e2 * t3290;
  t3615 = t3595 - 0.36e2 * t3596 + t3599 - 0.40e2 * t3600 + t3603 - 0.28e2 * t3604 + t3607 - 0.32e2 * t3608 - 0.7e1 / 0.6e1 * t3284 + t3611 - 0.8e1 / 0.3e1 * t3288 + t3613 - 0.9e1 / 0.2e1 * t3292;
  t3616 = 0.18e2 * t3294;
  t3618 = 0.20e2 * t3298;
  t3620 = t212 * t1702;
  t3622 = t212 * t1705;
  t3624 = t212 * t1722;
  t3626 = t1467 * t45;
  t3628 = t89 * t3626 * t313;
  t3631 = t89 * t1701 * t717;
  t3634 = t89 * t755 * t1721;
  t3660 = 0.32e2 * t713 * t1588;
  t3662 = my_piecewise3(t39, 0, 0.40e2 / 0.81e2 * t3325 * t310 * t1455 - 0.16e2 / 0.9e1 * t1454 * t34 * t269 * t514 - 0.8e1 / 0.9e1 * t1707 * t174 * t519 + 0.8e1 / 0.3e1 * t513 * t269 * t174 - 0.8e1 * t1710 * t676 * t174 + 0.8e1 / 0.3e1 * t1710 * t269 * t519 + 0.4e1 / 0.9e1 * t710 * t1463 - 0.16e2 * t42 * t676 + t3660);
  t3664 = t89 * t215 * t3662;
  t3666 = t356 * t1523;
  t3668 = t356 * t1526;
  t3670 = t1483 * t45;
  t3672 = t96 * t3670 * t325;
  t3675 = t96 * t1729 * t730;
  t3678 = t96 * t764 * t1749;
  t3704 = 0.32e2 * t726 * t1588;
  t3706 = my_piecewise3(t53, 0, 0.40e2 / 0.81e2 * t3356 * t322 * t1473 + 0.16e2 / 0.9e1 * t1472 * t34 * t269 * t533 - 0.8e1 / 0.9e1 * t1735 * t181 * t536 - 0.8e1 / 0.3e1 * t532 * t269 * t181 + 0.8e1 * t1738 * t676 * t181 - 0.8e1 / 0.3e1 * t1738 * t269 * t536 + 0.4e1 / 0.9e1 * t723 * t1479 + 0.16e2 * t54 * t676 - t3704);
  t3708 = t96 * t219 * t3706;
  t3710 = t503 * t756;
  t3712 = t503 * t759;
  t3714 = t1508 * t350;
  t3716 = -0.4e1 * t3620 - 0.8e1 * t3622 - 0.4e1 * t3624 + t3628 / 0.2e1 + 0.3e1 / 0.2e1 * t3631 + 0.3e1 / 0.2e1 * t3634 + t3664 / 0.2e1 - 0.4e1 * t3666 - 0.4e1 / 0.3e1 * t3668 + t3672 / 0.2e1 + 0.3e1 / 0.2e1 * t3675 + 0.3e1 / 0.2e1 * t3678 + t3708 / 0.2e1 + 0.44e2 / 0.3e1 * t3710 + 0.44e2 / 0.3e1 * t3712 - 0.616e3 / 0.27e2 * t3714 - t3380;
  t3744 = -0.70e2 / 0.27e2 * t1447 * t314 + 0.7e1 / 0.3e1 * t598 * t718 - t170 * t1768 + t33 * t3662 * t46 / 0.4e1 - t319 * t1484 / 0.3e1 + t51 * t3706 * t46 / 0.4e1;
  t3747 = t3616 - 0.20e2 / 0.3e1 * t3296 + t3618 + t381 * t1529 + t119 * t3716 + 0.9e1 / 0.2e1 * t254 * t1753 + 0.3e1 / 0.2e1 * t388 * t1562 + t133 * t3716 + 0.5e1 * t258 * t1753 + 0.5e1 / 0.3e1 * t392 * t1562 + 0.9e1 / 0.4e1 * t196 * t1776 + 0.3e1 / 0.4e1 * t337 * t1487 + t68 * t3744 / 0.2e1;
  t3775 = -0.2e1 * t3620 - 0.4e1 * t3622 - 0.2e1 * t3624 + t3628 / 0.4e1 + 0.3e1 / 0.4e1 * t3631 + 0.3e1 / 0.4e1 * t3634 + t3664 / 0.4e1 - 0.2e1 * t3666 - 0.2e1 / 0.3e1 * t3668 + t3672 / 0.4e1 + 0.3e1 / 0.4e1 * t3675 + 0.3e1 / 0.4e1 * t3678 + t3708 / 0.4e1 + 0.22e2 / 0.3e1 * t3710 + 0.22e2 / 0.3e1 * t3712 - 0.308e3 / 0.27e2 * t3714;
  t3792 = 0.5e1 / 0.2e1 * t201 * t1776 + 0.5e1 / 0.6e1 * t342 * t1487 + t81 * t3744 / 0.2e1 + 0.11e2 / 0.4e1 * t206 * t1776 + 0.11e2 / 0.12e2 * t347 * t1487 + t85 * t3775 / 0.2e1 + 0.9e1 / 0.4e1 * t226 * t1813 + 0.3e1 / 0.4e1 * t365 * t1529 + t105 * t3775 / 0.2e1 + 0.5e1 / 0.2e1 * t231 * t1813 + 0.5e1 / 0.6e1 * t370 * t1529 + t110 * t3775 / 0.2e1 + 0.11e2 / 0.4e1 * t236 * t1813;
  t3819 = 0.11e2 / 0.12e2 * t375 * t1529 + t115 * t3775 / 0.2e1 + 0.3e1 * t242 * t1813 + 0.9e1 / 0.8e1 * t559 * t734 + 0.5e1 / 0.3e1 * t562 * t734 + 0.55e2 / 0.24e2 * t566 * t734 + 0.9e1 / 0.8e1 * t569 * t771 + 0.5e1 / 0.3e1 * t572 * t771 + 0.55e2 / 0.24e2 * t576 * t771 + t136 * t3716 + 0.11e2 / 0.2e1 * t262 * t1753 + 0.11e2 / 0.6e1 * t396 * t1562 + t139 * t3716 + 0.6e1 * t266 * t1753;
  t3844 = t404 * t269;
  t3845 = 0.14e2 * t3844;
  t3846 = t407 * t269;
  t3847 = 0.16e2 * t3846;
  t3848 = 0.2e1 * t400 * t1562 + t30 * t3744 / 0.2e1 + 0.2e1 * t191 * t1776 + 0.2e1 / 0.3e1 * t332 * t1487 + t64 * t3744 / 0.2e1 + 0.9e1 / 0.4e1 * t579 * t801 + 0.10e2 / 0.3e1 * t582 * t801 + 0.55e2 / 0.12e2 * t585 * t801 + 0.2e1 / 0.3e1 * t556 * t734 - 0.3e1 / 0.8e1 * t1412 * t386 - 0.10e2 / 0.27e2 * t1415 * t386 - t3845 - t3847;
  t3849 = t410 * t269;
  t3850 = 0.18e2 * t3849;
  t3851 = t413 * t269;
  t3852 = 0.20e2 * t3851;
  t3870 = 0.3e1 * t113 * t771;
  t3872 = 0.6e1 * t138 * t801;
  t3874 = -t3850 - t3852 - 0.55e2 / 0.216e3 * t1418 * t386 - 0.4e1 / 0.27e2 * t1389 * t329 - 0.3e1 / 0.16e2 * t1392 * t329 - 0.5e1 / 0.27e2 * t1395 * t329 - 0.55e2 / 0.432e3 * t1400 * t329 - 0.3e1 / 0.16e2 * t1403 * t362 - 0.5e1 / 0.27e2 * t1406 * t362 - 0.55e2 / 0.432e3 * t1409 * t362 + t3870 + t3872 - 0.108e3 * t3510;
  t3876 = 0.60e2 * t3512;
  t3884 = 0.96e2 * t3540;
  t3885 = 0.96e2 * t3546;
  t3886 = 0.96e2 * t3550;
  t3887 = t3876 - 0.120e3 * t3514 + 0.3e1 / 0.4e1 * t3519 + 0.3e1 / 0.4e1 * t3521 + 0.27e2 / 0.2e1 * t3525 + 0.20e2 / 0.27e2 * t3532 + 0.20e2 / 0.27e2 * t3534 + 0.20e2 * t3538 - t3884 + t3545 - t3885 + t3549 - t3886;
  t3888 = 0.96e2 * t3554;
  t3892 = 0.42e2 * t3570;
  t3897 = 0.48e2 * t3585;
  t3899 = 0.54e2 * t3589;
  t3900 = t3553 - t3888 + t3557 + 0.35e2 / 0.108e3 * t3562 + 0.35e2 / 0.108e3 * t3564 + 0.7e1 / 0.2e1 * t3568 + t3892 - 0.84e2 * t3572 + 0.16e2 / 0.27e2 * t3577 + 0.16e2 / 0.27e2 * t3579 + 0.8e1 * t3583 + t3897 - 0.96e2 * t3587 + t3899;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t3615 + t3747 + t3792 + t3819 + t3848 + t3874 + t3887 + t3900;

  t3903 = t1024 * t517;
  t3905 = t1024 * t677;
  t3907 = t1015 * t517;
  t3909 = t1015 * t677;
  t3911 = t1018 * t517;
  t3913 = t1018 * t677;
  t3915 = t1021 * t517;
  t3917 = t1021 * t677;
  t3925 = -0.80e2 / 0.9e1 * t3903 + 0.20e2 / 0.3e1 * t3905 - 0.14e2 / 0.9e1 * t3907 + 0.7e1 / 0.6e1 * t3909 - 0.32e2 / 0.9e1 * t3911 + 0.8e1 / 0.3e1 * t3913 - 0.6e1 * t3915 + 0.9e1 / 0.2e1 * t3917 + 0.36e2 * t3594 - 0.72e2 * t3596 + 0.40e2 * t3598 - 0.80e2 * t3600 + 0.28e2 * t3602 - 0.56e2 * t3604;
  t3941 = 0.32e2 * t3606 - 0.64e2 * t3608 - 0.24e2 * t3239 - 0.24e2 * t3241 - 0.24e2 * t3282 + 0.7e1 / 0.18e2 * t3284 + 0.28e2 / 0.3e1 * t3286 + 0.8e1 / 0.9e1 * t3288 + 0.32e2 / 0.3e1 * t3290 + 0.3e1 / 0.2e1 * t3292 + 0.12e2 * t3294 + 0.20e2 / 0.9e1 * t3296 + 0.40e2 / 0.3e1 * t3298 - 0.24e2 * t3495 + 0.28e2 / 0.3e1 * t3844;
  t3950 = t503 * t915;
  t3952 = t212 * t1991;
  t3954 = t717 * t717;
  t3956 = t89 * t3954 * t45;
  t3959 = t89 * t1240 * t1721;
  t3961 = t212 * t1996;
  t3963 = t212 * t1999;
  t3966 = t89 * t1701 * t875;
  t3969 = t89 * t755 * t1939;
  t3996 = my_piecewise3(t39, 0, 0.40e2 / 0.81e2 * t3325 * t867 * t514 - 0.64e2 / 0.27e2 * t1707 * t174 * t34 * t269 - 0.8e1 / 0.27e2 * t1925 * t519 + 0.32e2 / 0.9e1 * t513 * t143 * t3542 + 0.16e2 / 0.9e1 * t710 * t269 - 0.16e2 / 0.3e1 * t710 * t1461 - 0.8e1 / 0.27e2 * t1454 * t871 * t514 + 0.8e1 / 0.9e1 * t513 * t1935 * t174 + 0.4e1 / 0.9e1 * t1930 * t519 + t3660);
  t3998 = t89 * t215 * t3996;
  t4000 = t924 * t528;
  t4002 = t924 * t541;
  t4004 = t356 * t1730;
  t4006 = t356 * t1733;
  t4008 = t356 * t1750;
  t4010 = t730 * t730;
  t4012 = t96 * t4010 * t45;
  t4015 = t96 * t1266 * t1749;
  t4018 = t96 * t1729 * t893;
  t4021 = t96 * t764 * t1959;
  t4048 = my_piecewise3(t53, 0, 0.40e2 / 0.81e2 * t3356 * t886 * t533 + 0.64e2 / 0.27e2 * t1735 * t181 * t34 * t269 - 0.8e1 / 0.27e2 * t1947 * t536 + 0.32e2 / 0.9e1 * t532 * t143 * t3542 - 0.16e2 / 0.9e1 * t723 * t269 + 0.16e2 / 0.3e1 * t723 * t1461 - 0.8e1 / 0.27e2 * t1472 * t889 * t533 + 0.8e1 / 0.9e1 * t532 * t1955 * t181 + 0.4e1 / 0.9e1 * t1952 * t536 - t3704);
  t4050 = t96 * t219 * t4048;
  t4052 = t503 * t918;
  t4054 = 0.22e2 / 0.9e1 * t3950 - 0.8e1 / 0.3e1 * t3952 + t3956 / 0.2e1 + t3959 / 0.2e1 - 0.4e1 / 0.3e1 * t3961 - 0.4e1 / 0.3e1 * t3963 + t3966 / 0.4e1 + t3969 / 0.2e1 + t3998 / 0.4e1 + 0.22e2 / 0.9e1 * t4000 + 0.22e2 / 0.9e1 * t4002 - 0.4e1 / 0.3e1 * t4004 - 0.8e1 / 0.3e1 * t4006 - 0.4e1 / 0.3e1 * t4008 + t4012 / 0.2e1 + t4015 / 0.2e1 + t4018 / 0.4e1 + t4021 / 0.2e1 + t4050 / 0.4e1 + 0.22e2 / 0.9e1 * t4052;
  t4082 = 0.44e2 / 0.9e1 * t4002 - 0.8e1 / 0.3e1 * t4004 - 0.16e2 / 0.3e1 * t4006 - 0.8e1 / 0.3e1 * t4008 + t4012 + t4015 + t4018 / 0.2e1 + t4021 + t4050 / 0.2e1 + 0.44e2 / 0.9e1 * t4052 - t3380;
  t4083 = 0.44e2 / 0.9e1 * t3950 - 0.16e2 / 0.3e1 * t3952 + t3956 + t3959 - 0.8e1 / 0.3e1 * t3961 - 0.8e1 / 0.3e1 * t3963 + t3966 / 0.2e1 + t3969 + t3998 / 0.2e1 + 0.44e2 / 0.9e1 * t4000 + t4082;
  t4089 = 0.32e2 / 0.3e1 * t3846 + 0.12e2 * t3849 + 0.40e2 / 0.3e1 * t3851 + 0.4e1 * t400 * t1753 + 0.5e1 / 0.3e1 * t370 * t1813 + t110 * t4054 / 0.2e1 + 0.11e2 / 0.6e1 * t236 * t2017 + 0.11e2 / 0.6e1 * t375 * t1813 + t115 * t4054 / 0.2e1 + 0.2e1 * t242 * t2017 + 0.2e1 * t381 * t1813 + t119 * t4083 + 0.3e1 * t254 * t2053 + 0.3e1 * t388 * t1753;
  t4121 = 0.7e1 / 0.9e1 * t598 * t876 - 0.2e1 / 0.3e1 * t170 * t1940 + t33 * t3996 * t46 / 0.4e1 + 0.7e1 / 0.9e1 * t881 * t606 - 0.2e1 / 0.3e1 * t319 * t1773 + t51 * t4048 * t46 / 0.4e1;
  t4132 = t133 * t4083 + 0.10e2 / 0.3e1 * t258 * t2053 + 0.10e2 / 0.3e1 * t392 * t1753 + t136 * t4083 + 0.11e2 / 0.3e1 * t262 * t2053 + 0.11e2 / 0.3e1 * t396 * t1753 + t139 * t4083 + 0.4e1 * t266 * t2053 + 0.4e1 / 0.3e1 * t191 * t1963 + 0.4e1 / 0.3e1 * t332 * t1776 + t64 * t4121 / 0.2e1 + 0.3e1 / 0.2e1 * t196 * t1963 + 0.3e1 / 0.2e1 * t337 * t1776 + t68 * t4121 / 0.2e1 + 0.5e1 / 0.3e1 * t201 * t1963;
  t4163 = 0.5e1 / 0.3e1 * t342 * t1776 + t81 * t4121 / 0.2e1 + 0.11e2 / 0.6e1 * t206 * t1963 + 0.11e2 / 0.6e1 * t347 * t1776 + t85 * t4054 / 0.2e1 + 0.3e1 / 0.2e1 * t226 * t2017 + 0.3e1 / 0.2e1 * t365 * t1813 + t105 * t4054 / 0.2e1 + 0.5e1 / 0.3e1 * t231 * t2017 + 0.2e1 / 0.9e1 * t973 * t609 + 0.3e1 / 0.8e1 * t976 * t609 + 0.5e1 / 0.9e1 * t981 * t609 + 0.55e2 / 0.72e2 * t985 * t609 + 0.3e1 / 0.8e1 * t988 * t634;
  t4188 = t1018 * t144;
  t4190 = t1021 * t144;
  t4192 = t1024 * t144;
  t4194 = 0.5e1 / 0.9e1 * t991 * t634 + 0.55e2 / 0.72e2 * t994 * t634 + 0.3e1 / 0.4e1 * t997 * t549 + 0.10e2 / 0.9e1 * t1001 * t549 + 0.55e2 / 0.36e2 * t1004 * t549 + t30 * t4121 / 0.2e1 + 0.3e1 / 0.8e1 * t569 * t936 + 0.5e1 / 0.9e1 * t572 * t936 + 0.55e2 / 0.72e2 * t576 * t936 + 0.3e1 / 0.4e1 * t579 * t960 + 0.10e2 / 0.9e1 * t582 * t960 + 0.55e2 / 0.36e2 * t585 * t960 + 0.8e1 / 0.9e1 * t4188 + 0.3e1 / 0.2e1 * t4190 + 0.20e2 / 0.9e1 * t4192;
  t4204 = t1015 * t144;
  t4207 = t113 * t936;
  t4208 = t138 * t960;
  t4215 = 0.2e1 / 0.9e1 * t556 * t897 + 0.3e1 / 0.8e1 * t559 * t897 + 0.5e1 / 0.9e1 * t562 * t897 + 0.55e2 / 0.72e2 * t566 * t897 + 0.7e1 / 0.18e2 * t4204 + 0.2e1 * t3506 + t3508 + t4207 + 0.2e1 * t4208 - 0.72e2 * t3510 - 0.40e2 * t3512 - 0.80e2 * t3514 + 0.6e1 * t3523 + 0.9e1 / 0.2e1 * t3525;
  t4227 = 0.80e2 / 0.9e1 * t3536 + 0.20e2 / 0.3e1 * t3538 + t3545 + t3549 + t3553 + t3557 + 0.14e2 / 0.9e1 * t3566 + 0.7e1 / 0.6e1 * t3568 - 0.28e2 * t3570 - 0.56e2 * t3572 + 0.32e2 / 0.9e1 * t3581 + 0.8e1 / 0.3e1 * t3583 - 0.32e2 * t3585 - 0.64e2 * t3587 - 0.36e2 * t3589;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = t3925 + t3941 + t4089 + t4132 + t4163 + t4194 + t4215 + t4227;

  t4231 = t2271 * t270;
  t4233 = t2262 * t173;
  t4235 = t2262 * t270;
  t4237 = t2265 * t173;
  t4239 = t2265 * t270;
  t4241 = t2268 * t173;
  t4243 = t2268 * t270;
  t4245 = t2271 * t173;
  t4250 = 0.20e2 * t3905 + 0.20e2 / 0.27e2 * t4231 - 0.35e2 / 0.108e3 * t4233 + 0.35e2 / 0.108e3 * t4235 - 0.16e2 / 0.27e2 * t4237 + 0.16e2 / 0.27e2 * t4239 - 0.3e1 / 0.4e1 * t4241 + 0.3e1 / 0.4e1 * t4243 - 0.20e2 / 0.27e2 * t4245 + 0.7e1 / 0.2e1 * t3909 + 0.8e1 * t3913 + 0.27e2 / 0.2e1 * t3917 - t3595;
  t4255 = -0.108e3 * t3596 - t3599 - 0.120e3 * t3600 - t3603 - 0.84e2 * t3604 - t3607 - 0.96e2 * t3608 - t3611 - t3613 - t3616 - t3618 + t3845 + t3847;
  t4275 = t3850 + t3852 - 0.8e1 / 0.3e1 * t4188 - 0.9e1 / 0.2e1 * t4190 - 0.20e2 / 0.3e1 * t4192 - 0.7e1 / 0.6e1 * t4204 + 0.9e1 / 0.4e1 * t997 * t801 + 0.10e2 / 0.3e1 * t1001 * t801 + 0.55e2 / 0.12e2 * t1004 * t801 - 0.4e1 / 0.27e2 * t2278 * t188 - 0.3e1 / 0.16e2 * t2282 * t188 - 0.5e1 / 0.27e2 * t2285 * t188 - 0.55e2 / 0.432e3 * t2289 * t188;
  t4290 = t212 * t2155;
  t4293 = t89 * t2712 * t875;
  t4296 = t89 * t1240 * t1939;
  t4298 = t212 * t2158;
  t4301 = t89 * t755 * t2124;
  t4321 = 0.12e2 * t676 + 0.24e2 * t3337;
  t4325 = my_piecewise3(t39, 0, 0.40e2 / 0.81e2 * t3325 * t2114 * t174 - 0.16e2 / 0.9e1 * t1925 * t517 - 0.8e1 / 0.9e1 * t1707 * t871 * t174 + 0.8e1 / 0.3e1 * t1710 * t269 * t871 + 0.4e1 / 0.3e1 * t710 * t1935 + 0.4e1 / 0.9e1 * t513 * t2120 * t174 + 0.4e1 / 0.3e1 * t42 * t4321);
  t4327 = t89 * t215 * t4325;
  t4329 = t2164 * t220;
  t4331 = t924 * t765;
  t4333 = t924 * t768;
  t4335 = t356 * t2008;
  t4337 = t356 * t2011;
  t4339 = t356 * t2014;
  t4342 = t96 * t2856 * t893;
  t4345 = t96 * t1266 * t1959;
  t4348 = t96 * t764 * t2145;
  t4370 = my_piecewise3(t53, 0, 0.40e2 / 0.81e2 * t3356 * t2136 * t181 + 0.16e2 / 0.9e1 * t1947 * t517 - 0.8e1 / 0.9e1 * t1735 * t889 * t181 - 0.8e1 / 0.3e1 * t1738 * t269 * t889 + 0.4e1 / 0.3e1 * t723 * t1955 + 0.4e1 / 0.9e1 * t532 * t2141 * t181 - 0.4e1 / 0.3e1 * t54 * t4321);
  t4372 = t96 * t219 * t4370;
  t4374 = -0.4e1 * t4290 + 0.3e1 / 0.2e1 * t4293 + 0.3e1 / 0.2e1 * t4296 - 0.4e1 / 0.3e1 * t4298 + t4301 / 0.2e1 + t4327 / 0.2e1 - 0.616e3 / 0.27e2 * t4329 + 0.44e2 / 0.3e1 * t4331 + 0.44e2 / 0.3e1 * t4333 - 0.8e1 * t4335 - 0.4e1 * t4337 - 0.4e1 * t4339 + 0.3e1 / 0.2e1 * t4342 + 0.3e1 / 0.2e1 * t4345 + t4348 / 0.2e1 + t4372 / 0.2e1 - t3380;
  t4386 = -0.3e1 / 0.16e2 * t2292 * t223 - 0.5e1 / 0.27e2 * t2295 * t223 - 0.55e2 / 0.432e3 * t2298 * t223 - 0.3e1 / 0.8e1 * t2301 * t252 - 0.10e2 / 0.27e2 * t2304 * t252 - 0.55e2 / 0.216e3 * t2307 * t252 + 0.9e1 / 0.2e1 * t388 * t2053 + t133 * t4374 + 0.5e1 / 0.3e1 * t258 * t2204 + 0.5e1 * t392 * t2053 + t136 * t4374 + 0.11e2 / 0.6e1 * t262 * t2204 + 0.11e2 / 0.2e1 * t396 * t2053 + t139 * t4374;
  t4406 = -t170 * t2125 / 0.3e1 + t33 * t4325 * t46 / 0.4e1 - 0.70e2 / 0.27e2 * t2130 * t185 + 0.7e1 / 0.3e1 * t881 * t731 - t319 * t1960 + t51 * t4370 * t46 / 0.4e1;
  t4429 = 0.2e1 * t266 * t2204 + 0.6e1 * t400 * t2053 + t30 * t4406 / 0.2e1 + 0.2e1 / 0.3e1 * t191 * t2149 + 0.2e1 * t332 * t1963 + t64 * t4406 / 0.2e1 + 0.3e1 / 0.4e1 * t196 * t2149 + 0.9e1 / 0.4e1 * t337 * t1963 + t68 * t4406 / 0.2e1 + 0.5e1 / 0.6e1 * t201 * t2149 + 0.5e1 / 0.2e1 * t342 * t1963 + 0.2e1 / 0.3e1 * t973 * t734 + 0.9e1 / 0.8e1 * t976 * t734;
  t4462 = -0.2e1 * t4290 + 0.3e1 / 0.4e1 * t4293 + 0.3e1 / 0.4e1 * t4296 - 0.2e1 / 0.3e1 * t4298 + t4301 / 0.4e1 + t4327 / 0.4e1 - 0.308e3 / 0.27e2 * t4329 + 0.22e2 / 0.3e1 * t4331 + 0.22e2 / 0.3e1 * t4333 - 0.4e1 * t4335 - 0.2e1 * t4337 - 0.2e1 * t4339 + 0.3e1 / 0.4e1 * t4342 + 0.3e1 / 0.4e1 * t4345 + t4348 / 0.4e1 + t4372 / 0.4e1;
  t4473 = 0.5e1 / 0.3e1 * t981 * t734 + 0.55e2 / 0.24e2 * t985 * t734 + 0.9e1 / 0.8e1 * t988 * t771 + 0.5e1 / 0.3e1 * t991 * t771 + 0.55e2 / 0.24e2 * t994 * t771 + t81 * t4406 / 0.2e1 + 0.11e2 / 0.12e2 * t206 * t2149 + 0.11e2 / 0.4e1 * t347 * t1963 + t85 * t4462 / 0.2e1 + 0.3e1 / 0.4e1 * t226 * t2179 + 0.9e1 / 0.4e1 * t365 * t2017 + t105 * t4462 / 0.2e1 + 0.5e1 / 0.6e1 * t231 * t2179;
  t4492 = 0.5e1 / 0.2e1 * t370 * t2017 + t110 * t4462 / 0.2e1 + 0.11e2 / 0.12e2 * t236 * t2179 + 0.11e2 / 0.4e1 * t375 * t2017 + t115 * t4462 / 0.2e1 + t242 * t2179 + 0.3e1 * t381 * t2017 + t119 * t4374 + 0.3e1 / 0.2e1 * t254 * t2204 + t3870 + t3872 - 0.36e2 * t3510 - t3876;
  t4496 = -0.40e2 * t3514 + t3884 + t3545 + t3885 + t3549 + t3886 + t3553 + t3888 + t3557 - t3892 - 0.28e2 * t3572 - t3897 - 0.32e2 * t3587 - t3899;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = t4250 + t4255 + t4275 + t4386 + t4429 + t4473 + t4492 + t4496;

  t4506 = 0.1e1 / t18 / t93;
  t4522 = 0.385e3 / 0.1296e4 * t141 * t3117 * t145 + 0.40e2 / 0.81e2 * t147 * t95 * t145 + 0.9e1 / 0.16e2 * t150 * t4506 * t145 + 0.40e2 / 0.81e2 * t153 * t318 * t145 + 0.160e3 / 0.3e1 * t3903 + 0.40e2 * t3905 + 0.80e2 / 0.27e2 * t4231 + 0.35e2 / 0.27e2 * t4233 + 0.35e2 / 0.27e2 * t4235 + 0.64e2 / 0.27e2 * t4237 + 0.64e2 / 0.27e2 * t4239 + 0.3e1 * t4241 + 0.3e1 * t4243;
  t4537 = 0.80e2 / 0.27e2 * t4245 + 0.28e2 / 0.3e1 * t3907 + 0.7e1 * t3909 + 0.64e2 / 0.3e1 * t3911 + 0.16e2 * t3913 + 0.36e2 * t3915 + 0.27e2 * t3917 - 0.216e3 * t3594 - 0.144e3 * t3596 - 0.240e3 * t3598 - 0.160e3 * t3600 - 0.168e3 * t3602 - 0.112e3 * t3604 - 0.192e3 * t3606;
  t4548 = -0.128e3 * t3608 + t3240 + t3242 + t3283 + t3496 - 0.56e2 * t3844 - 0.64e2 * t3846 - 0.72e2 * t3849 - 0.80e2 * t3851 + 0.16e2 / 0.3e1 * t4188 + 0.9e1 * t4190 + 0.40e2 / 0.3e1 * t4192 + 0.7e1 / 0.3e1 * t4204;
  t4549 = t867 * t867;
  t4554 = t871 * t871;
  t4560 = 0.24e2 * t676 + 0.24e2 * t3337;
  t4564 = my_piecewise3(t39, 0, 0.40e2 / 0.81e2 * t3325 * t4549 - 0.16e2 / 0.9e1 * t1925 * t871 + 0.4e1 / 0.3e1 * t513 * t4554 + 0.16e2 / 0.9e1 * t710 * t2120 + 0.4e1 / 0.3e1 * t42 * t4560);
  t4579 = t886 * t886;
  t4584 = t889 * t889;
  t4593 = my_piecewise3(t53, 0, 0.40e2 / 0.81e2 * t3356 * t4579 - 0.16e2 / 0.9e1 * t1947 * t889 + 0.4e1 / 0.3e1 * t532 * t4584 + 0.16e2 / 0.9e1 * t723 * t2141 - 0.4e1 / 0.3e1 * t54 * t4560);
  t4597 = t33 * t4564 * t46 / 0.4e1 + 0.910e3 / 0.81e2 * t49 / t11 / t2161 * t57 - 0.280e3 / 0.27e2 * t2130 * t326 + 0.14e2 / 0.3e1 * t881 * t894 - 0.4e1 / 0.3e1 * t319 * t2146 + t51 * t4593 * t46 / 0.4e1;
  t4606 = t875 * t875;
  t4608 = t89 * t4606 * t45;
  t4611 = t89 * t1240 * t2124;
  t4613 = t89 * t215 * t4564;
  t4619 = sigma[2] / t25 / t921 / t93 * t98;
  t4621 = t2164 * t359;
  t4623 = t924 * t930;
  t4625 = t924 * t933;
  t4627 = t356 * t2173;
  t4629 = t356 * t2176;
  t4631 = t893 * t893;
  t4633 = t96 * t4631 * t45;
  t4636 = t96 * t1266 * t2145;
  t4638 = t96 * t219 * t4593;
  t4640 = 0.3e1 / 0.4e1 * t4608 + t4611 + t4613 / 0.4e1 + 0.2618e4 / 0.81e2 * t4619 - 0.1232e4 / 0.27e2 * t4621 + 0.44e2 / 0.3e1 * t4623 + 0.44e2 / 0.3e1 * t4625 - 0.8e1 * t4627 - 0.8e1 / 0.3e1 * t4629 + 0.3e1 / 0.4e1 * t4633 + t4636 + t4638 / 0.4e1;
  t4669 = 0.3e1 / 0.2e1 * t4608 + 0.2e1 * t4611 + t4613 / 0.2e1 + 0.5236e4 / 0.81e2 * t4619 - 0.2464e4 / 0.27e2 * t4621 + 0.88e2 / 0.3e1 * t4623 + 0.88e2 / 0.3e1 * t4625 - 0.16e2 * t4627 - 0.16e2 / 0.3e1 * t4629 + 0.3e1 / 0.2e1 * t4633 + 0.2e1 * t4636 + t4638 / 0.2e1 - t3380;
  t4673 = t64 * t4597 / 0.2e1 + 0.3e1 * t337 * t2149 + t68 * t4597 / 0.2e1 + 0.10e2 / 0.3e1 * t342 * t2149 + t85 * t4640 / 0.2e1 + 0.3e1 * t365 * t2179 + t105 * t4640 / 0.2e1 + 0.10e2 / 0.3e1 * t370 * t2179 + t110 * t4640 / 0.2e1 + 0.11e2 / 0.3e1 * t375 * t2179 + t115 * t4640 / 0.2e1 + 0.4e1 * t381 * t2179 + t119 * t4669 + 0.6e1 * t388 * t2204;
  t4699 = t133 * t4669 + 0.20e2 / 0.3e1 * t392 * t2204 + t136 * t4669 + 0.22e2 / 0.3e1 * t396 * t2204 + t139 * t4669 + 0.8e1 * t400 * t2204 + t30 * t4597 / 0.2e1 + 0.8e1 / 0.3e1 * t332 * t2149 - 0.16e2 / 0.27e2 * t2278 * t329 - 0.3e1 / 0.4e1 * t2282 * t329 - 0.20e2 / 0.27e2 * t2285 * t329 - 0.55e2 / 0.108e3 * t2289 * t329 - 0.3e1 / 0.4e1 * t2292 * t362;
  t4737 = -0.20e2 / 0.27e2 * t2295 * t362 - 0.55e2 / 0.108e3 * t2298 * t362 - 0.3e1 / 0.2e1 * t2301 * t386 - 0.40e2 / 0.27e2 * t2304 * t386 - 0.55e2 / 0.54e2 * t2307 * t386 + 0.20e2 / 0.81e2 * t29 * t95 * t60 + 0.9e1 / 0.32e2 * t63 * t4506 * t60 + 0.20e2 / 0.81e2 * t67 * t318 * t60 + 0.385e3 / 0.2592e4 * t71 * t1335 * t60 + 0.9e1 / 0.32e2 * t84 * t4506 * t101 + 0.20e2 / 0.81e2 * t104 * t318 * t101 + 0.385e3 / 0.2592e4 * t109 * t1335 * t101 + 0.9e1 / 0.16e2 * t118 * t4506 * t130 + 0.40e2 / 0.81e2 * t132 * t318 * t130;
  t4766 = 0.385e3 / 0.1296e4 * t135 * t1335 * t130 + 0.55e2 / 0.12e2 * t985 * t897 + 0.9e1 / 0.4e1 * t988 * t936 + 0.10e2 / 0.3e1 * t991 * t936 + 0.55e2 / 0.12e2 * t994 * t936 + 0.9e1 / 0.2e1 * t997 * t960 + 0.20e2 / 0.3e1 * t1001 * t960 + 0.55e2 / 0.6e1 * t1004 * t960 + 0.4e1 / 0.3e1 * t973 * t897 + 0.9e1 / 0.4e1 * t976 * t897 + 0.10e2 / 0.3e1 * t981 * t897 + t81 * t4597 / 0.2e1 + 0.11e2 / 0.3e1 * t347 * t2149;
  t4777 = 0.6e1 * t4207 + 0.12e2 * t4208 + 0.385e3 / 0.1296e4 * t1 * t3117 + 0.40e2 / 0.81e2 * t8 * t95 + 0.9e1 / 0.16e2 * t15 * t4506 + 0.40e2 / 0.81e2 * t22 * t318 + t3541 + t3545 + t3547 + t3549 + t3551 + t3553 + t3555 + t3557;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = t4522 + t4537 + t4548 + t4673 + t4699 + t4737 + t4766 + t4777;

  t4781 = t418 * t523 * t46;
  t4799 = t1507 * t90 * t45;
  t4805 = t211 * t508 * t45;
  t4821 = t2450 * t216;
  t4823 = 0.5e1 / 0.16e2 * t1099 * t4781 + 0.11e2 / 0.32e2 * t1102 * t4781 + 0.9e1 / 0.16e2 * t1107 * t524 + 0.5e1 / 0.8e1 * t1111 * t524 + 0.11e2 / 0.16e2 * t1115 * t524 + 0.3e1 / 0.4e1 * t1119 * t524 + t1091 * t4781 / 0.4e1 + 0.9e1 / 0.32e2 * t1096 * t4781 - 0.77e2 / 0.27e2 * t105 * t4799 - 0.77e2 / 0.27e2 * t85 * t4799 - t85 * t4805 - 0.77e2 / 0.27e2 * t110 * t4799 - t110 * t4805 - 0.77e2 / 0.27e2 * t115 * t4799 - t115 * t4805 - 0.121e3 / 0.192e3 * t2429 * t2406 - 0.87e2 / 0.32e2 * t2437 * t216 - 0.35e2 / 0.12e2 * t2441 * t216 - 0.99e2 / 0.32e2 * t2447 * t216 - 0.13e2 / 0.4e1 * t4821;
  t4845 = t169 * t523 * t46;
  t4855 = t105 * t502;
  t4859 = t597 * t177 * t46;
  t4867 = t32 * t1467 * t46;
  t4876 = -t424 * t4845 / 0.4e1 - t427 * t4845 / 0.4e1 - t430 * t4845 / 0.4e1 + 0.11e2 / 0.3e1 * t4855 * t216 + 0.7e1 / 0.12e2 * t427 * t4859 + 0.7e1 / 0.12e2 * t430 * t4859 + t1064 * t1520 / 0.8e1 + t419 * t4867 / 0.16e2 + t424 * t4867 / 0.16e2 + t427 * t4867 / 0.16e2 + t430 * t4867 / 0.16e2;
  t4879 = t85 * t502;
  t4889 = t110 * t502;
  t4897 = t115 * t502;
  t4909 = t1446 * t44 * t46;
  t4929 = -t2356 * t524 + 0.3e1 / 0.8e1 * t1064 * t1517 + 0.7e1 / 0.12e2 * t419 * t4859 + 0.7e1 / 0.12e2 * t424 * t4859 - 0.35e2 / 0.54e2 * t424 * t4909 - 0.35e2 / 0.54e2 * t427 * t4909 - 0.35e2 / 0.54e2 * t430 * t4909 - 0.35e2 / 0.54e2 * t419 * t4909 + t1055 * t1520 / 0.8e1 + 0.535e3 / 0.216e3 * t104 / t500 * t91 + 0.8921e4 / 0.3456e4 * t109 / t74 / t209 * t91;
  t4932 = t113 * t211 * t91;
  t4947 = t138 * t1036;
  t4950 = t502 * t44;
  t4960 = 0.1232e4 / 0.27e2 * t1559;
  t4961 = -0.308e3 / 0.27e2 * t4799 + 0.44e2 / 0.3e1 * t4950 * t755 - 0.4e1 * t4805 - 0.4e1 * t2456 * t1701 + 0.3e1 / 0.2e1 * t2709 * t1701 + t1032 * t3626 / 0.2e1 + t4960;
  t4987 = 0.9e1 / 0.2e1 * t254 * t2463 + t133 * t4961 + 0.5e1 * t258 * t2463 + t136 * t4961 + 0.11e2 / 0.2e1 * t262 * t2463 - 0.3e1 / 0.8e1 * t1412 * t444 - 0.10e2 / 0.27e2 * t1415 * t444 - 0.55e2 / 0.216e3 * t1418 * t444 + 0.9e1 / 0.4e1 * t579 * t1036 + 0.10e2 / 0.3e1 * t582 * t1036 + 0.55e2 / 0.12e2 * t585 * t1036;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.11e2 / 0.3e1 * t4897 * t216 + 0.9e1 / 0.16e2 * t1107 * t509 + 0.5e1 / 0.8e1 * t1111 * t509 + 0.11e2 / 0.16e2 * t1115 * t509 + 0.3e1 / 0.4e1 * t1119 * t509 + t139 * t4961 + 0.6e1 * t266 * t2463 + t119 * t4961 - 0.7e1 / 0.12e2 * t2432 * t2406 - 0.39e2 / 0.64e2 * t2423 * t2406 - t105 * t4805 - 0.5e1 / 0.8e1 * t2426 * t2406 - t2346 * t524 - t419 * t4845 / 0.4e1 + 0.11e2 / 0.3e1 * t4879 * t216 - t2372 * t524 + 0.3e1 / 0.8e1 * t1055 * t1517 + 0.3e1 / 0.8e1 * t1058 * t1517 + t1058 * t1520 / 0.8e1 + 0.11e2 / 0.3e1 * t4889 * t216 - t2351 * t524 + 0.3e1 / 0.8e1 * t1061 * t1517 + t1061 * t1520 / 0.8e1 + t4987 + 0.6e1 * t4947 + t4929 + 0.8e1 / 0.3e1 * t4932 + t4876 + t4823 + 0.301e3 / 0.128e3 * t84 / t2 / t500 * t91 + 0.85e2 / 0.128e3 * t63 * t2446 * t1093 + 0.145e3 / 0.216e3 * t67 * t88 * t1093 + 0.2321e4 / 0.3456e4 * t71 * t3253 * t1093 + 0.35e2 / 0.54e2 * t29 * t2440 * t1093;

  t4992 = t579 * t249;
  t4994 = t254 * t546;
  t4997 = 0.2464e4 / 0.27e2 * t119 * t1559;
  t5000 = t582 * t249;
  t5002 = t258 * t546;
  t5005 = 0.2464e4 / 0.27e2 * t133 * t1559;
  t5008 = t585 * t249;
  t5010 = t262 * t546;
  t5013 = 0.2464e4 / 0.27e2 * t136 * t1559;
  t5014 = t138 * t249;
  t5015 = 0.32e2 * t5014;
  t5016 = t266 * t546;
  t5019 = 0.2464e4 / 0.27e2 * t139 * t1559;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.3e1 / 0.4e1 * t1412 * t128 + 0.12e2 * t4992 - 0.88e2 * t4994 + t4997 + 0.20e2 / 0.27e2 * t1415 * t128 + 0.160e3 / 0.9e1 * t5000 - 0.880e3 / 0.9e1 * t5002 + t5005 + 0.55e2 / 0.108e3 * t1418 * t128 + 0.220e3 / 0.9e1 * t5008 - 0.968e3 / 0.9e1 * t5010 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5016 + t5019;

  t5032 = t2575 * t220;
  t5039 = t50 * t1483 * t46;
  t5048 = 0.11e2 / 0.16e2 * t236 * t2560 + 0.9e1 / 0.16e2 * t226 * t2560 - 0.5e1 / 0.216e3 * t1406 * t470 + 0.5e1 / 0.8e1 * t231 * t2560 - 0.55e2 / 0.3456e4 * t1409 * t470 - 0.3e1 / 0.128e3 * t1403 * t470 + 0.3e1 / 0.4e1 * t5032 + 0.3e1 / 0.4e1 * t242 * t2560 + t1139 * t2511 / 0.4e1 + t455 * t5039 / 0.16e2 + 0.9e1 / 0.32e2 * t1146 * t2511 + t460 * t5039 / 0.16e2 + 0.5e1 / 0.16e2 * t1151 * t2511;
  t5055 = t572 * t95;
  t5064 = t576 * t95;
  t5077 = t569 * t95;
  t5080 = 0.9e1 / 0.16e2 * t2514 * t541 + 0.3e1 / 0.8e1 * t1163 * t1523 + t1163 * t1526 / 0.8e1 + 0.5e1 / 0.12e2 * t5055 * t220 + 0.5e1 / 0.8e1 * t2519 * t541 + 0.3e1 / 0.8e1 * t1168 * t1523 + t1168 * t1526 / 0.8e1 + 0.55e2 / 0.96e2 * t5064 * t220 + 0.3e1 / 0.8e1 * t1179 * t1523 + t1179 * t1526 / 0.8e1 + 0.3e1 / 0.4e1 * t2529 * t541 + t466 * t5039 / 0.16e2 + 0.11e2 / 0.32e2 * t1156 * t2511 + 0.9e1 / 0.32e2 * t5077 * t220;
  t5110 = t138 * t1187;
  t5112 = -0.5e1 / 0.216e3 * t1395 * t454 * t457 - 0.55e2 / 0.3456e4 * t1400 * t454 * t457 - t1389 * t454 * t457 / 0.54e2 + t2555 * t1143 / 0.12e2 + 0.9e1 / 0.64e2 * t2546 * t1143 + 0.5e1 / 0.24e2 * t2549 * t1143 + 0.55e2 / 0.192e3 * t2552 * t1143 - 0.3e1 / 0.128e3 * t1392 * t454 * t457 + t463 * t5039 / 0.16e2 + 0.11e2 / 0.16e2 * t2524 * t541 + 0.3e1 / 0.8e1 * t1174 * t1523 + t1174 * t1526 / 0.8e1 + 0.6e1 * t5110;
  t5125 = 0.3e1 / 0.2e1 * t2853 * t1729 + t1184 * t3670 / 0.2e1 + t4960;
  t5142 = 0.9e1 / 0.4e1 * t579 * t1187 + 0.10e2 / 0.3e1 * t582 * t1187 + 0.55e2 / 0.12e2 * t585 * t1187 + 0.9e1 / 0.2e1 * t254 * t2589 + t119 * t5125 + 0.5e1 * t258 * t2589 + t133 * t5125 + 0.11e2 / 0.2e1 * t262 * t2589 + t136 * t5125 + 0.6e1 * t266 * t2589 + t139 * t5125 - 0.3e1 / 0.8e1 * t1412 * t480 - 0.10e2 / 0.27e2 * t1415 * t480 - 0.55e2 / 0.216e3 * t1418 * t480;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t5048 + t5080 + t5112 + t5142;

  t5146 = t2450 * t350;
  t5168 = -0.33e2 / 0.32e2 * t2447 * t350 - 0.13e2 / 0.12e2 * t5146 + 0.11e2 / 0.12e2 * t365 * t2388 + 0.3e1 / 0.16e2 * t365 * t2384 - 0.7e1 / 0.36e2 * t2432 * t2679 - 0.13e2 / 0.64e2 * t2423 * t2679 - 0.5e1 / 0.24e2 * t2426 * t2679 - 0.121e3 / 0.576e3 * t2429 * t2679 + 0.11e2 / 0.9e1 * t381 * t2388 + t381 * t2384 / 0.4e1 + 0.55e2 / 0.54e2 * t370 * t2388 + 0.5e1 / 0.24e2 * t370 * t2384;
  t5174 = t418 * t717 * t46;
  t5197 = 0.121e3 / 0.108e3 * t375 * t2388 + 0.11e2 / 0.48e2 * t375 * t2384 + 0.11e2 / 0.48e2 * t1102 * t5174 + 0.3e1 / 0.8e1 * t1107 * t756 + 0.3e1 / 0.8e1 * t1107 * t759 + 0.5e1 / 0.12e2 * t1111 * t756 + 0.5e1 / 0.12e2 * t1111 * t759 + 0.11e2 / 0.24e2 * t1115 * t756 + 0.11e2 / 0.24e2 * t1115 * t759 + t1119 * t756 / 0.2e1 + t1119 * t759 / 0.2e1 + t1091 * t5174 / 0.6e1 + 0.3e1 / 0.16e2 * t1096 * t5174;
  t5208 = t169 * t717 * t46;
  t5214 = t597 * t313 * t46;
  t5227 = 0.5e1 / 0.24e2 * t1099 * t5174 - 0.29e2 / 0.32e2 * t2437 * t350 - 0.35e2 / 0.36e2 * t2441 * t350 + t1055 * t1702 / 0.8e1 - t427 * t5208 / 0.6e1 + 0.77e2 / 0.216e3 * t1216 * t2333 + 0.7e1 / 0.36e2 * t430 * t5214 + 0.11e2 / 0.9e1 * t4879 * t350 - 0.2e1 / 0.3e1 * t2372 * t756 - 0.2e1 / 0.3e1 * t2372 * t759 - 0.2e1 / 0.3e1 * t2346 * t756 - 0.2e1 / 0.3e1 * t2346 * t759;
  t5249 = t32 * t1721 * t46;
  t5252 = t365 * t211;
  t5256 = -0.2e1 / 0.3e1 * t2351 * t756 - 0.2e1 / 0.3e1 * t2351 * t759 - 0.2e1 / 0.3e1 * t2356 * t756 - 0.2e1 / 0.3e1 * t2356 * t759 - 0.11e2 / 0.36e2 * t1216 * t2341 - t430 * t5208 / 0.6e1 + t1064 * t1702 / 0.8e1 + t1064 * t1705 / 0.4e1 + t1064 * t1722 / 0.8e1 + 0.11e2 / 0.96e2 * t1216 * t2362 + t430 * t5249 / 0.16e2 - t5252 * t216 + 0.3e1 / 0.16e2 * t2627 * t524;
  t5283 = 0.11e2 / 0.9e1 * t4855 * t350 + 0.11e2 / 0.9e1 * t4889 * t350 + 0.11e2 / 0.9e1 * t4897 * t350 + 0.7e1 / 0.27e2 * t1199 * t2333 + 0.7e1 / 0.36e2 * t419 * t5214 + 0.7e1 / 0.24e2 * t1206 * t2333 + 0.7e1 / 0.36e2 * t424 * t5214 + 0.35e2 / 0.108e3 * t1211 * t2333 + 0.7e1 / 0.36e2 * t427 * t5214 - 0.2e1 / 0.9e1 * t1199 * t2341 - t419 * t5208 / 0.6e1 - t1206 * t2341 / 0.4e1;
  t5306 = t370 * t211;
  t5311 = -t424 * t5208 / 0.6e1 - 0.5e1 / 0.18e2 * t1211 * t2341 + t2649 * t524 / 0.4e1 + t1199 * t2362 / 0.12e2 + t419 * t5249 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t2362 + t424 * t5249 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t2362 + t427 * t5249 / 0.16e2 + t1055 * t1705 / 0.4e1 + t1055 * t1722 / 0.8e1 - 0.10e2 / 0.9e1 * t5306 * t216 + 0.5e1 / 0.24e2 * t2634 * t524;
  t5319 = t375 * t211;
  t5330 = t381 * t211;
  t5333 = t138 * t1243;
  t5339 = t1058 * t1702 / 0.8e1 + t1058 * t1705 / 0.4e1 + t1058 * t1722 / 0.8e1 - 0.11e2 / 0.9e1 * t5319 * t216 + 0.11e2 / 0.48e2 * t2642 * t524 + t1061 * t1702 / 0.8e1 + t1061 * t1705 / 0.4e1 + t1061 * t1722 / 0.8e1 - 0.4e1 / 0.3e1 * t5330 * t216 + 0.2e1 * t5333 + 0.3e1 / 0.4e1 * t579 * t1243 + 0.10e2 / 0.9e1 * t582 * t1243;
  t5356 = 0.44e2 / 0.9e1 * t4950 * t1240 - 0.8e1 / 0.3e1 * t211 * t177 * t1240 - 0.8e1 / 0.3e1 * t2456 * t2712 + t88 * t523 * t1240 / 0.2e1 + t2709 * t2712 + t1032 * t45 * t1721 / 0.2e1 + t4960;
  t5377 = 0.55e2 / 0.36e2 * t585 * t1243 + t119 * t5356 + 0.3e1 * t254 * t2715 + 0.5e1 / 0.3e1 * t392 * t2463 + t133 * t5356 + 0.10e2 / 0.3e1 * t258 * t2715 + 0.11e2 / 0.6e1 * t396 * t2463 + t136 * t5356 + 0.11e2 / 0.3e1 * t262 * t2715 + 0.2e1 * t400 * t2463 + t139 * t5356 + 0.4e1 * t266 * t2715 + 0.3e1 / 0.2e1 * t388 * t2463;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t5168 + t5197 + t5227 + t5256 + t5283 + t5311 + t5339 + t5377;

  t5380 = t388 * t546;
  t5384 = t392 * t546;
  t5388 = t396 * t546;
  t5392 = t400 * t546;
  t5394 = 0.32e2 / 0.3e1 * t5014;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = -0.88e2 / 0.3e1 * t5380 + 0.4e1 * t4992 - 0.176e3 / 0.3e1 * t4994 + t4997 - 0.880e3 / 0.27e2 * t5384 + 0.160e3 / 0.27e2 * t5000 - 0.1760e4 / 0.27e2 * t5002 + t5005 - 0.968e3 / 0.27e2 * t5388 + 0.220e3 / 0.27e2 * t5008 - 0.1936e4 / 0.27e2 * t5010 + t5013 - 0.352e3 / 0.9e1 * t5392 + t5394 - 0.704e3 / 0.9e1 * t5016 + t5019;

  t5397 = t454 * t540 * t46;
  t5415 = t355 * t527 * t45;
  t5422 = t1320 * t5397 / 0.12e2 + 0.3e1 / 0.32e2 * t1325 * t5397 + 0.5e1 / 0.48e2 * t1328 * t5397 + 0.11e2 / 0.96e2 * t1331 * t5397 + 0.3e1 / 0.16e2 * t1336 * t541 + 0.5e1 / 0.24e2 * t1340 * t541 + 0.11e2 / 0.48e2 * t1344 * t541 + t1348 * t541 / 0.4e1 - t110 * t5415 / 0.3e1 - t115 * t5415 / 0.3e1 - t85 * t5415 / 0.3e1;
  t5431 = t2575 * t359;
  t5434 = t318 * t540 * t46;
  t5449 = -t105 * t5415 / 0.3e1 - t569 * t1264 / 0.8e1 - 0.5e1 / 0.27e2 * t572 * t1264 - 0.55e2 / 0.216e3 * t576 * t1264 + t5431 / 0.4e1 - t460 * t5434 / 0.12e2 - t1146 * t2796 / 0.4e1 - t463 * t5434 / 0.12e2 - 0.5e1 / 0.18e2 * t1151 * t2796 - t466 * t5434 / 0.12e2 - 0.11e2 / 0.36e2 * t1156 * t2796 + t1179 * t1733 / 0.4e1;
  t5473 = 0.3e1 / 0.64e2 * t2546 * t1283 + 0.5e1 / 0.72e2 * t2549 * t1283 + 0.3e1 / 0.32e2 * t5077 * t359 + 0.5e1 / 0.36e2 * t5055 * t359 + 0.55e2 / 0.288e3 * t5064 * t359 - 0.5e1 / 0.54e2 * t2549 * t1302 + 0.55e2 / 0.576e3 * t2552 * t1283 - 0.55e2 / 0.432e3 * t2552 * t1302 + t2555 * t1283 / 0.36e2 - t2555 * t1302 / 0.27e2 - t2546 * t1302 / 0.16e2;
  t5494 = t226 * t355;
  t5496 = t231 * t355;
  t5499 = -t2750 * t541 / 0.3e1 + t1163 * t1730 / 0.8e1 + t1163 * t1733 / 0.4e1 + 0.3e1 / 0.8e1 * t2514 * t765 + t1163 * t1750 / 0.8e1 + 0.3e1 / 0.8e1 * t2514 * t768 - t2759 * t541 / 0.3e1 + t1168 * t1730 / 0.8e1 + t1168 * t1733 / 0.4e1 + 0.5e1 / 0.12e2 * t2519 * t765 - t5494 * t220 - 0.10e2 / 0.9e1 * t5496 * t220;
  t5502 = t236 * t355;
  t5505 = t242 * t355;
  t5515 = t50 * t1749 * t46;
  t5528 = -0.11e2 / 0.9e1 * t5502 * t220 - 0.4e1 / 0.3e1 * t5505 * t220 + t1179 * t1750 / 0.8e1 + t2529 * t768 / 0.2e1 + t2529 * t765 / 0.2e1 + t455 * t5515 / 0.16e2 + t1139 * t2784 / 0.6e1 - t455 * t5434 / 0.12e2 - 0.2e1 / 0.9e1 * t1139 * t2796 + t460 * t5515 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t2784;
  t5553 = t463 * t5515 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t2784 + t466 * t5515 / 0.16e2 + t1168 * t1750 / 0.8e1 + 0.5e1 / 0.12e2 * t2519 * t768 - t2768 * t541 / 0.3e1 + t1174 * t1730 / 0.8e1 + t1174 * t1733 / 0.4e1 + 0.11e2 / 0.24e2 * t2524 * t765 + t1174 * t1750 / 0.8e1 + 0.11e2 / 0.24e2 * t2524 * t768 - t2777 * t541 / 0.3e1;
  t5560 = t113 * t355 * t98;
  t5570 = t138 * t1269;
  t5586 = -0.4e1 / 0.3e1 * t5415 - 0.4e1 / 0.3e1 * t2850 * t1729 + t95 * t540 * t1266 / 0.2e1 + t2853 * t2856 + t1184 * t45 * t1749 / 0.2e1 + t4960;
  t5588 = t1179 * t1730 / 0.8e1 + 0.11e2 / 0.48e2 * t1156 * t2784 - t5560 / 0.3e1 + 0.3e1 / 0.16e2 * t1336 * t528 + 0.5e1 / 0.24e2 * t1340 * t528 + 0.11e2 / 0.48e2 * t1344 * t528 + t1348 * t528 / 0.4e1 + 0.2e1 * t5570 + 0.10e2 / 0.3e1 * t258 * t2859 + 0.5e1 / 0.3e1 * t392 * t2589 + t136 * t5586;
  t5610 = 0.11e2 / 0.3e1 * t262 * t2859 + 0.11e2 / 0.6e1 * t396 * t2589 + t139 * t5586 + 0.4e1 * t266 * t2859 + 0.2e1 * t400 * t2589 + t119 * t5586 + 0.3e1 * t254 * t2859 + 0.3e1 / 0.2e1 * t388 * t2589 + t133 * t5586 + 0.3e1 / 0.4e1 * t579 * t1269 + 0.10e2 / 0.9e1 * t582 * t1269 + 0.55e2 / 0.36e2 * t585 * t1269;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t5422 + t5449 + t5473 + t5499 + t5528 + t5553 + t5588 + t5610;

  t5614 = t211 * t914 * t45;
  t5626 = t418 * t875 * t46;
  t5639 = -t115 * t5614 / 0.3e1 - t988 * t1030 / 0.8e1 - t85 * t5614 / 0.3e1 - 0.5e1 / 0.27e2 * t991 * t1030 + t1119 * t918 / 0.4e1 + 0.11e2 / 0.96e2 * t1102 * t5626 + 0.3e1 / 0.16e2 * t1107 * t918 + 0.5e1 / 0.24e2 * t1111 * t918 + 0.11e2 / 0.48e2 * t1115 * t918 + t1091 * t5626 / 0.12e2 + 0.3e1 / 0.32e2 * t1096 * t5626;
  t5656 = t169 * t875 * t46;
  t5665 = 0.5e1 / 0.48e2 * t1099 * t5626 - t105 * t5614 / 0.3e1 - 0.55e2 / 0.216e3 * t994 * t1030 - t110 * t5614 / 0.3e1 + t4821 / 0.4e1 - 0.11e2 / 0.9e1 * t5319 * t350 - t2351 * t918 / 0.3e1 - 0.2e1 / 0.9e1 * t1199 * t2606 - t419 * t5656 / 0.12e2 - 0.4e1 / 0.3e1 * t5330 * t350 - t2356 * t918 / 0.3e1 - 0.11e2 / 0.36e2 * t1216 * t2606;
  t5675 = t991 * t88;
  t5690 = -t430 * t5656 / 0.12e2 + t1055 * t1991 / 0.4e1 + t1055 * t1996 / 0.8e1 + t1055 * t1999 / 0.8e1 + 0.5e1 / 0.36e2 * t5675 * t216 + t2649 * t756 / 0.2e1 + t2649 * t759 / 0.2e1 - t1206 * t2606 / 0.4e1 - t424 * t5656 / 0.12e2 - 0.5e1 / 0.18e2 * t1211 * t2606 - t427 * t5656 / 0.12e2;
  t5714 = -t2904 * t1073 / 0.27e2 - t2907 * t1073 / 0.16e2 - 0.5e1 / 0.54e2 * t2910 * t1073 - 0.55e2 / 0.432e3 * t2913 * t1073 - t5252 * t350 - t2372 * t918 / 0.3e1 - 0.10e2 / 0.9e1 * t5306 * t350 - t2346 * t918 / 0.3e1 + 0.5e1 / 0.12e2 * t2634 * t756 + 0.5e1 / 0.12e2 * t2634 * t759 + t1058 * t1991 / 0.4e1 + t1058 * t1996 / 0.8e1;
  t5719 = t994 * t88;
  t5735 = t32 * t1939 * t46;
  t5742 = t1058 * t1999 / 0.8e1 + 0.55e2 / 0.288e3 * t5719 * t216 + 0.11e2 / 0.24e2 * t2642 * t756 + 0.11e2 / 0.24e2 * t2642 * t759 + t1061 * t1991 / 0.4e1 + t1061 * t1996 / 0.8e1 + t1061 * t1999 / 0.8e1 + t1199 * t2624 / 0.6e1 + t419 * t5735 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t2624 + t1064 * t1991 / 0.4e1;
  t5751 = t988 * t88;
  t5768 = t1064 * t1996 / 0.8e1 + t1064 * t1999 / 0.8e1 + 0.11e2 / 0.48e2 * t1216 * t2624 + t430 * t5735 / 0.16e2 + 0.3e1 / 0.32e2 * t5751 * t216 + 0.3e1 / 0.8e1 * t2627 * t756 + 0.3e1 / 0.8e1 * t2627 * t759 + t424 * t5735 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t2624 + t427 * t5735 / 0.16e2 + t2904 * t1050 / 0.36e2 + 0.3e1 / 0.64e2 * t2907 * t1050;
  t5785 = t88 * t313;
  t5794 = -0.4e1 / 0.3e1 * t5614 + t5785 * t2712 - 0.4e1 / 0.3e1 * t2456 * t2949 + t2709 * t2949 / 0.2e1 + t1032 * t45 * t1939 / 0.2e1 + t4960;
  t5800 = 0.5e1 / 0.72e2 * t2910 * t1050 + 0.55e2 / 0.576e3 * t2913 * t1050 + t1119 * t915 / 0.4e1 + 0.3e1 / 0.16e2 * t1107 * t915 + 0.5e1 / 0.24e2 * t1111 * t915 + 0.11e2 / 0.48e2 * t1115 * t915 - t4932 / 0.3e1 + 0.2e1 * t4947 + t139 * t5794 + 0.2e1 * t266 * t2952 + 0.3e1 / 0.4e1 * t997 * t1036;
  t5822 = 0.10e2 / 0.9e1 * t1001 * t1036 + 0.55e2 / 0.36e2 * t1004 * t1036 + 0.3e1 * t388 * t2715 + t119 * t5794 + 0.3e1 / 0.2e1 * t254 * t2952 + 0.10e2 / 0.3e1 * t392 * t2715 + t133 * t5794 + 0.5e1 / 0.3e1 * t258 * t2952 + 0.11e2 / 0.3e1 * t396 * t2715 + t136 * t5794 + 0.11e2 / 0.6e1 * t262 * t2952 + 0.4e1 * t400 * t2715;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t5639 + t5665 + t5690 + t5714 + t5742 + t5768 + t5800 + t5822;

  t5825 = t997 * t249;
  t5829 = t1001 * t249;
  t5833 = t1004 * t249;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.4e1 * t5825 - 0.176e3 / 0.3e1 * t5380 - 0.88e2 / 0.3e1 * t4994 + t4997 + 0.160e3 / 0.27e2 * t5829 - 0.1760e4 / 0.27e2 * t5384 - 0.880e3 / 0.27e2 * t5002 + t5005 + 0.220e3 / 0.27e2 * t5833 - 0.1936e4 / 0.27e2 * t5388 - 0.968e3 / 0.27e2 * t5010 + t5013 + t5394 - 0.704e3 / 0.9e1 * t5392 - 0.352e3 / 0.9e1 * t5016 + t5019;

  t5844 = t454 * t730 * t46;
  t5865 = t1348 * t765 / 0.2e1 + t1348 * t768 / 0.2e1 + t1320 * t5844 / 0.6e1 - 0.29e2 / 0.32e2 * t3109 * t220 - 0.35e2 / 0.36e2 * t3113 * t220 - 0.33e2 / 0.32e2 * t3118 * t220 + t242 * t3032 / 0.4e1 - 0.7e1 / 0.36e2 * t3035 * t2836 - 0.13e2 / 0.64e2 * t3038 * t2836 - 0.5e1 / 0.24e2 * t3041 * t2836 - 0.121e3 / 0.576e3 * t3044 * t2836 + 0.11e2 / 0.12e2 * t226 * t3048;
  t5892 = 0.3e1 / 0.16e2 * t226 * t3032 + 0.55e2 / 0.54e2 * t231 * t3048 + 0.5e1 / 0.24e2 * t231 * t3032 + 0.121e3 / 0.108e3 * t236 * t3048 + 0.11e2 / 0.48e2 * t236 * t3032 + 0.11e2 / 0.9e1 * t242 * t3048 + 0.3e1 / 0.16e2 * t1325 * t5844 + 0.5e1 / 0.24e2 * t1328 * t5844 + 0.11e2 / 0.48e2 * t1331 * t5844 + 0.3e1 / 0.8e1 * t1336 * t765 + 0.3e1 / 0.8e1 * t1336 * t768 + 0.5e1 / 0.12e2 * t1340 * t765 + 0.5e1 / 0.12e2 * t1340 * t768;
  t5900 = t880 * t184 * t46;
  t5906 = t318 * t730 * t46;
  t5919 = t105 * t923;
  t5922 = 0.11e2 / 0.24e2 * t1344 * t765 + 0.11e2 / 0.24e2 * t1344 * t768 - 0.13e2 / 0.12e2 * t5032 + 0.7e1 / 0.36e2 * t466 * t5900 + 0.77e2 / 0.216e3 * t1156 * t2999 - t455 * t5906 / 0.6e1 - 0.2e1 / 0.9e1 * t1139 * t3003 + t1163 * t2008 / 0.4e1 + t1163 * t2011 / 0.8e1 + t1163 * t2014 / 0.8e1 + 0.3e1 / 0.16e2 * t2514 * t933 + 0.11e2 / 0.9e1 * t5919 * t220;
  t5937 = t110 * t923;
  t5949 = t50 * t1959 * t46;
  t5952 = -0.2e1 / 0.3e1 * t2759 * t765 - 0.2e1 / 0.3e1 * t2759 * t768 - 0.10e2 / 0.9e1 * t5496 * t359 + t1168 * t2008 / 0.4e1 + t1168 * t2011 / 0.8e1 + t1168 * t2014 / 0.8e1 + 0.5e1 / 0.24e2 * t2519 * t933 + 0.11e2 / 0.9e1 * t5937 * t220 - 0.2e1 / 0.3e1 * t2768 * t765 - 0.2e1 / 0.3e1 * t2768 * t768 - 0.11e2 / 0.9e1 * t5502 * t359 + t2529 * t933 / 0.4e1 + t455 * t5949 / 0.16e2;
  t5965 = t85 * t923;
  t5979 = t1139 * t2995 / 0.12e2 + t463 * t5949 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t2995 + t466 * t5949 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t2995 + 0.11e2 / 0.9e1 * t5965 * t220 - 0.2e1 / 0.3e1 * t2750 * t765 - 0.2e1 / 0.3e1 * t2750 * t768 - t5494 * t359 + t1179 * t2008 / 0.4e1 + t1179 * t2011 / 0.8e1 + t1179 * t2014 / 0.8e1;
  t6006 = 0.7e1 / 0.36e2 * t455 * t5900 + 0.7e1 / 0.27e2 * t1139 * t2999 + 0.7e1 / 0.36e2 * t460 * t5900 + 0.7e1 / 0.24e2 * t1146 * t2999 + 0.7e1 / 0.36e2 * t463 * t5900 + 0.35e2 / 0.108e3 * t1151 * t2999 - t460 * t5906 / 0.6e1 - t1146 * t3003 / 0.4e1 - t463 * t5906 / 0.6e1 - 0.5e1 / 0.18e2 * t1151 * t3003 - t466 * t5906 / 0.6e1 - 0.11e2 / 0.36e2 * t1156 * t3003 + t1174 * t2008 / 0.4e1;
  t6014 = t115 * t923;
  t6028 = t923 * t56;
  t6036 = t95 * t325;
  t6043 = 0.44e2 / 0.9e1 * t6028 * t764 - 0.8e1 / 0.3e1 * t355 * t184 * t1266 - 0.8e1 / 0.3e1 * t2850 * t2856 + t6036 * t2856 + t2853 * t3091 / 0.2e1 + t1184 * t45 * t1959 / 0.2e1 + t4960;
  t6047 = t1174 * t2011 / 0.8e1 + t1174 * t2014 / 0.8e1 + 0.11e2 / 0.48e2 * t2524 * t933 + 0.11e2 / 0.9e1 * t6014 * t220 - 0.2e1 / 0.3e1 * t2777 * t765 - 0.2e1 / 0.3e1 * t2777 * t768 - 0.4e1 / 0.3e1 * t5505 * t359 + t460 * t5949 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t2995 + 0.2e1 * t5110 + t139 * t6043 + 0.2e1 * t266 * t3094;
  t6071 = 0.4e1 * t400 * t2859 + 0.3e1 / 0.4e1 * t997 * t1187 + 0.10e2 / 0.9e1 * t1001 * t1187 + 0.55e2 / 0.36e2 * t1004 * t1187 + t119 * t6043 + 0.3e1 / 0.2e1 * t254 * t3094 + 0.3e1 * t388 * t2859 + t133 * t6043 + 0.5e1 / 0.3e1 * t258 * t3094 + 0.10e2 / 0.3e1 * t392 * t2859 + t136 * t6043 + 0.11e2 / 0.6e1 * t262 * t3094 + 0.11e2 / 0.3e1 * t396 * t2859;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t5865 + t5892 + t5922 + t5952 + t5979 + t6006 + t6047 + t6071;

  t6103 = -0.5e1 / 0.216e3 * t2295 * t434 + 0.5e1 / 0.8e1 * t370 * t2930 - 0.55e2 / 0.3456e4 * t2298 * t434 + 0.11e2 / 0.16e2 * t375 * t2930 + 0.3e1 / 0.4e1 * t381 * t2930 - 0.3e1 / 0.128e3 * t2292 * t434 + 0.9e1 / 0.16e2 * t365 * t2930 + 0.3e1 / 0.4e1 * t5146 - t2278 * t418 * t421 / 0.54e2 - 0.3e1 / 0.128e3 * t2282 * t418 * t421 - 0.5e1 / 0.216e3 * t2285 * t418 * t421 - 0.55e2 / 0.3456e4 * t2289 * t418 * t421 + t2904 * t1203 / 0.12e2;
  t6107 = t32 * t2124 * t46;
  t6134 = t1199 * t2893 / 0.4e1 + t419 * t6107 / 0.16e2 + 0.9e1 / 0.32e2 * t1206 * t2893 + t424 * t6107 / 0.16e2 + 0.5e1 / 0.16e2 * t1211 * t2893 + t427 * t6107 / 0.16e2 + t1055 * t2158 / 0.8e1 + 0.5e1 / 0.12e2 * t5675 * t350 + 0.5e1 / 0.8e1 * t2634 * t918 + 0.3e1 / 0.8e1 * t1058 * t2155 + t1058 * t2158 / 0.8e1 + 0.55e2 / 0.96e2 * t5719 * t350 + 0.11e2 / 0.16e2 * t2642 * t918 + 0.3e1 / 0.8e1 * t1061 * t2155;
  t6161 = t1061 * t2158 / 0.8e1 + 0.3e1 / 0.4e1 * t2649 * t918 + 0.3e1 / 0.8e1 * t1064 * t2155 + t1064 * t2158 / 0.8e1 + 0.11e2 / 0.32e2 * t1216 * t2893 + t430 * t6107 / 0.16e2 + 0.9e1 / 0.32e2 * t5751 * t350 + 0.9e1 / 0.16e2 * t2627 * t918 + 0.3e1 / 0.8e1 * t1055 * t2155 + 0.55e2 / 0.192e3 * t2913 * t1203 + 0.9e1 / 0.64e2 * t2907 * t1203 + 0.5e1 / 0.24e2 * t2910 * t1203 + 0.6e1 * t5333;
  t6181 = 0.3e1 / 0.2e1 * t5785 * t2949 + t1032 * t45 * t2124 / 0.2e1 + t4960;
  t6192 = 0.9e1 / 0.4e1 * t997 * t1243 + 0.10e2 / 0.3e1 * t1001 * t1243 + 0.55e2 / 0.12e2 * t1004 * t1243 - 0.3e1 / 0.8e1 * t2301 * t444 - 0.10e2 / 0.27e2 * t2304 * t444 - 0.55e2 / 0.216e3 * t2307 * t444 + 0.9e1 / 0.2e1 * t388 * t2952 + t119 * t6181 + 0.5e1 * t392 * t2952 + t133 * t6181 + 0.11e2 / 0.2e1 * t396 * t2952 + t136 * t6181 + 0.6e1 * t400 * t2952 + t139 * t6181;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t6103 + t6134 + t6161 + t6192;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.3e1 / 0.4e1 * t2301 * t128 + 0.12e2 * t5825 - 0.88e2 * t5380 + t4997 + 0.20e2 / 0.27e2 * t2304 * t128 + 0.160e3 / 0.9e1 * t5829 - 0.880e3 / 0.9e1 * t5384 + t5005 + 0.55e2 / 0.108e3 * t2307 * t128 + 0.220e3 / 0.9e1 * t5833 - 0.968e3 / 0.9e1 * t5388 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5392 + t5019;

  t6208 = t454 * t893 * t46;
  t6220 = t355 * t929 * t45;
  t6223 = t2163 * t97 * t45;
  t6253 = t1320 * t6208 / 0.4e1 + 0.9e1 / 0.32e2 * t1325 * t6208 + 0.5e1 / 0.16e2 * t1328 * t6208 + 0.11e2 / 0.32e2 * t1331 * t6208 + 0.9e1 / 0.16e2 * t1336 * t933 - t110 * t6220 - 0.77e2 / 0.27e2 * t115 * t6223 - t85 * t6220 - 0.77e2 / 0.27e2 * t105 * t6223 - t105 * t6220 - 0.77e2 / 0.27e2 * t110 * t6223 - t115 * t6220 + 0.35e2 / 0.54e2 * t29 * t3112 * t1322 + 0.85e2 / 0.128e3 * t63 * t3117 * t1322 + 0.145e3 / 0.216e3 * t67 * t95 * t1322 + 0.2321e4 / 0.3456e4 * t71 * t4506 * t1322 - 0.77e2 / 0.27e2 * t85 * t6223 - 0.39e2 / 0.64e2 * t3038 * t3028 - 0.5e1 / 0.8e1 * t3041 * t3028 - 0.121e3 / 0.192e3 * t3044 * t3028;
  t6270 = t50 * t2145 * t46;
  t6279 = t2129 * t56 * t46;
  t6287 = t318 * t893 * t46;
  t6293 = t880 * t325 * t46;
  t6303 = 0.11e2 / 0.3e1 * t5965 * t359 - 0.35e2 / 0.54e2 * t455 * t6279 - 0.35e2 / 0.54e2 * t460 * t6279 - 0.35e2 / 0.54e2 * t463 * t6279 - t460 * t6287 / 0.4e1 - 0.35e2 / 0.54e2 * t466 * t6279 + 0.7e1 / 0.12e2 * t455 * t6293 - t2777 * t933 - t455 * t6287 / 0.4e1 - t463 * t6287 / 0.4e1 - t466 * t6287 / 0.4e1;
  t6346 = 0.11e2 / 0.3e1 * t5919 * t359 - t2759 * t933 + 0.3e1 / 0.8e1 * t1168 * t2173 + t1168 * t2176 / 0.8e1 + 0.11e2 / 0.3e1 * t5937 * t359 + 0.3e1 / 0.8e1 * t1179 * t2173 + t1179 * t2176 / 0.8e1 + t455 * t6270 / 0.16e2 + 0.7e1 / 0.12e2 * t460 * t6293 + 0.11e2 / 0.16e2 * t1344 * t930 + 0.3e1 / 0.4e1 * t1348 * t930;
  t6381 = -0.308e3 / 0.27e2 * t6223 + 0.44e2 / 0.3e1 * t6028 * t1266 - 0.4e1 * t6220 - 0.4e1 * t2850 * t3091 + 0.3e1 / 0.2e1 * t6036 * t3091 + t1184 * t45 * t2145 / 0.2e1 + t4960;
  t6405 = 0.9e1 / 0.4e1 * t997 * t1269 + 0.10e2 / 0.3e1 * t1001 * t1269 + 0.55e2 / 0.12e2 * t1004 * t1269 + t119 * t6381 + 0.9e1 / 0.2e1 * t388 * t3094 + t133 * t6381 + 0.5e1 * t392 * t3094 + t136 * t6381 - 0.3e1 / 0.8e1 * t2301 * t480 - 0.10e2 / 0.27e2 * t2304 * t480 - 0.55e2 / 0.216e3 * t2307 * t480;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = -0.35e2 / 0.12e2 * t3113 * t359 - 0.99e2 / 0.32e2 * t3118 * t359 - 0.7e1 / 0.12e2 * t3035 * t3028 + 0.5e1 / 0.8e1 * t1340 * t933 + 0.11e2 / 0.16e2 * t1344 * t933 + 0.3e1 / 0.4e1 * t1348 * t933 + t463 * t6270 / 0.16e2 + t466 * t6270 / 0.16e2 + 0.5e1 / 0.8e1 * t1340 * t930 + 0.11e2 / 0.2e1 * t396 * t3094 + t139 * t6381 + 0.6e1 * t400 * t3094 + 0.9e1 / 0.16e2 * t1336 * t930 + 0.11e2 / 0.3e1 * t6014 * t359 + t460 * t6270 / 0.16e2 + 0.7e1 / 0.12e2 * t466 * t6293 - t2750 * t933 + 0.3e1 / 0.8e1 * t1163 * t2173 + t1163 * t2176 / 0.8e1 + 0.7e1 / 0.12e2 * t463 * t6293 - t2768 * t933 + 0.3e1 / 0.8e1 * t1174 * t2173 + t1174 * t2176 / 0.8e1 - 0.87e2 / 0.32e2 * t3109 * t359 + t6405 + t6346 + t6303 + t6253 + 0.6e1 * t5570 + 0.8e1 / 0.3e1 * t5560 - 0.13e2 / 0.4e1 * t5431 + 0.535e3 / 0.216e3 * t104 / t921 * t98 + 0.301e3 / 0.128e3 * t84 / t4 / t921 * t98 + 0.8921e4 / 0.3456e4 * t109 / t78 / t353 * t98;

  t6409 = t1353 * t177 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = -t1091 * t6409 / 0.12e2 - 0.3e1 / 0.32e2 * t1096 * t6409 - 0.5e1 / 0.48e2 * t1099 * t6409 - 0.11e2 / 0.96e2 * t1102 * t6409 + t1354 * t2341 / 0.12e2 - t1354 * t2362 / 0.32e2 + 0.13e2 / 0.128e3 * t2423 * t3124 + t1356 * t2341 / 0.12e2 - t1356 * t2362 / 0.32e2 + 0.5e1 / 0.48e2 * t2426 * t3124 + t1358 * t2341 / 0.12e2 - t1358 * t2362 / 0.32e2 + 0.121e3 / 0.1152e4 * t2429 * t3124 + t1360 * t2341 / 0.12e2 - t1360 * t2362 / 0.32e2 + 0.7e1 / 0.72e2 * t2432 * t3124 - 0.7e1 / 0.72e2 * t1356 * t2333 - 0.7e1 / 0.72e2 * t1358 * t2333 - 0.7e1 / 0.72e2 * t1360 * t2333 - 0.7e1 / 0.72e2 * t1354 * t2333;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = -t556 * t1364 * t457 / 0.72e2 - t3149 * t1143 / 0.12e2 - t1365 * t2511 / 0.32e2 - 0.3e1 / 0.128e3 * t559 * t1364 * t457 - 0.3e1 / 0.32e2 * t3154 * t1143 - t1367 * t2511 / 0.32e2 - 0.5e1 / 0.144e3 * t562 * t1364 * t457 - 0.5e1 / 0.48e2 * t3159 * t1143 - t1369 * t2511 / 0.32e2 - 0.55e2 / 0.1152e4 * t566 * t1364 * t457 - 0.11e2 / 0.96e2 * t3164 * t1143 - t1371 * t2511 / 0.32e2;

  t6483 = t1353 * t313 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t3169 * t1073 / 0.18e2 - t3169 * t1050 / 0.24e2 - t1091 * t6483 / 0.24e2 + t1354 * t2606 / 0.24e2 - t1354 * t2624 / 0.32e2 + t3174 * t1073 / 0.16e2 - 0.3e1 / 0.64e2 * t3174 * t1050 - 0.3e1 / 0.64e2 * t1096 * t6483 + t1356 * t2606 / 0.24e2 - t1356 * t2624 / 0.32e2 + 0.5e1 / 0.72e2 * t3179 * t1073 - 0.5e1 / 0.96e2 * t3179 * t1050 - 0.5e1 / 0.96e2 * t1099 * t6483 + t1358 * t2606 / 0.24e2 - t1358 * t2624 / 0.32e2 + 0.11e2 / 0.144e3 * t3184 * t1073 - 0.11e2 / 0.192e3 * t3184 * t1050 - 0.11e2 / 0.192e3 * t1102 * t6483 + t1360 * t2606 / 0.24e2 - t1360 * t2624 / 0.32e2;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t6521 = t1364 * t184 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = -t1320 * t6521 / 0.24e2 + t3149 * t1302 / 0.18e2 + t1365 * t2796 / 0.24e2 - t3149 * t1283 / 0.24e2 - t1365 * t2784 / 0.32e2 - 0.3e1 / 0.64e2 * t1325 * t6521 + t3154 * t1302 / 0.16e2 + t1367 * t2796 / 0.24e2 - 0.3e1 / 0.64e2 * t3154 * t1283 - t1367 * t2784 / 0.32e2 - 0.5e1 / 0.96e2 * t1328 * t6521 + 0.5e1 / 0.72e2 * t3159 * t1302 + t1369 * t2796 / 0.24e2 - 0.5e1 / 0.96e2 * t3159 * t1283 - t1369 * t2784 / 0.32e2 - 0.11e2 / 0.192e3 * t1331 * t6521 + 0.11e2 / 0.144e3 * t3164 * t1302 + t1371 * t2796 / 0.24e2 - 0.11e2 / 0.192e3 * t3164 * t1283 - t1371 * t2784 / 0.32e2;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = -t973 * t1353 * t421 / 0.72e2 - t3169 * t1203 / 0.12e2 - t1354 * t2893 / 0.32e2 - 0.3e1 / 0.128e3 * t976 * t1353 * t421 - 0.3e1 / 0.32e2 * t3174 * t1203 - t1356 * t2893 / 0.32e2 - 0.5e1 / 0.144e3 * t981 * t1353 * t421 - 0.5e1 / 0.48e2 * t3179 * t1203 - t1358 * t2893 / 0.32e2 - 0.55e2 / 0.1152e4 * t985 * t1353 * t421 - 0.11e2 / 0.96e2 * t3184 * t1203 - t1360 * t2893 / 0.32e2;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t6591 = t1364 * t325 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = -0.5e1 / 0.48e2 * t1328 * t6591 - 0.11e2 / 0.96e2 * t1331 * t6591 - t1320 * t6591 / 0.12e2 - 0.3e1 / 0.32e2 * t1325 * t6591 - t1367 * t2995 / 0.32e2 + 0.5e1 / 0.48e2 * t3041 * t3190 + t1369 * t3003 / 0.12e2 - t1369 * t2995 / 0.32e2 + 0.121e3 / 0.1152e4 * t3044 * t3190 + t1371 * t3003 / 0.12e2 - t1371 * t2995 / 0.32e2 + 0.7e1 / 0.72e2 * t3035 * t3190 + t1365 * t3003 / 0.12e2 - t1365 * t2995 / 0.32e2 + 0.13e2 / 0.128e3 * t3038 * t3190 + t1367 * t3003 / 0.12e2 - 0.7e1 / 0.72e2 * t1369 * t2999 - 0.7e1 / 0.72e2 * t1371 * t2999 - 0.7e1 / 0.72e2 * t1365 * t2999 - 0.7e1 / 0.72e2 * t1367 * t2999;

  t6633 = t3217 * t44 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t1091 * t6633 / 0.16e2 - t3218 * t1073 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1050 + 0.9e1 / 0.128e3 * t1096 * t6633 - t3220 * t1073 / 0.16e2 + 0.3e1 / 0.64e2 * t3220 * t1050 + 0.5e1 / 0.64e2 * t1099 * t6633 - t3222 * t1073 / 0.16e2 + 0.3e1 / 0.64e2 * t3222 * t1050 + 0.11e2 / 0.128e3 * t1102 * t6633 - t3224 * t1073 / 0.16e2 + 0.3e1 / 0.64e2 * t3224 * t1050;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t191 * t3229 * t457 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1143 + 0.9e1 / 0.128e3 * t196 * t3229 * t457 + 0.3e1 / 0.64e2 * t3232 * t1143 + 0.5e1 / 0.64e2 * t201 * t3229 * t457 + 0.3e1 / 0.64e2 * t3234 * t1143 + 0.11e2 / 0.128e3 * t206 * t3229 * t457 + 0.3e1 / 0.64e2 * t3236 * t1143;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t332 * t3217 * t421 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1203 + 0.9e1 / 0.128e3 * t337 * t3217 * t421 + 0.3e1 / 0.64e2 * t3220 * t1203 + 0.5e1 / 0.64e2 * t342 * t3217 * t421 + 0.3e1 / 0.64e2 * t3222 * t1203 + 0.11e2 / 0.128e3 * t347 * t3217 * t421 + 0.3e1 / 0.64e2 * t3224 * t1203;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t6699 = t3229 * t56 * t46;
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t1320 * t6699 / 0.16e2 - t3230 * t1302 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1283 + 0.9e1 / 0.128e3 * t1325 * t6699 - t3232 * t1302 / 0.16e2 + 0.3e1 / 0.64e2 * t3232 * t1283 + 0.5e1 / 0.64e2 * t1328 * t6699 - t3234 * t1302 / 0.16e2 + 0.3e1 / 0.64e2 * t3234 * t1283 + 0.11e2 / 0.128e3 * t1331 * t6699 - t3236 * t1302 / 0.16e2 + 0.3e1 / 0.64e2 * t3236 * t1283;

  t6726 = 0.1e1 / t31 / t3215 / sigma[0];
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = -0.15e2 / 0.128e3 * t30 * t6726 * t421 - 0.15e2 / 0.128e3 * t64 * t6726 * t421 - 0.15e2 / 0.128e3 * t68 * t6726 * t421 - 0.15e2 / 0.128e3 * t81 * t6726 * t421;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t6738 = 0.1e1 / t49 / t3227 / sigma[2];
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = -0.15e2 / 0.128e3 * t30 * t6738 * t457 - 0.15e2 / 0.128e3 * t64 * t6738 * t457 - 0.15e2 / 0.128e3 * t68 * t6738 * t457 - 0.15e2 / 0.128e3 * t81 * t6738 * t457;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

