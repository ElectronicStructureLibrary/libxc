/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_pearson.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t37, t38, t39, t40, t41, t42;
  double t43, t47, t48, t49, t52, t56, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = M_PI * M_PI;
  t26 = POW_1_3(t25);
  t27 = t26 * t26;
  t29 = t24 / t27;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t37 = t25 * t25;
  t38 = 0.1e1 / t37;
  t39 = sigma[0] * sigma[0];
  t40 = t39 * sigma[0];
  t41 = t38 * t40;
  t42 = t33 * t33;
  t43 = t42 * t42;
  t47 = 0.1e1 + t41 / t43 / 0.576e3;
  t48 = 0.1e1 / t47;
  t49 = t32 / t22 / t33 * t48;
  t52 = 0.1e1 + 0.5e1 / 0.648e3 * t30 * t49;
  t56 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t52);
  tzk0 = 0.2e1 * t56;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t37, t38, t39, t40, t41, t42;
  double t43, t47, t48, t49, t52, t56, tzk0;

  double t58, t62, t66, t69, t70, t71, t73, t75;
  double t76, t77, t81, t86, tvrho0, t92, t94, t99;
  double t103, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = M_PI * M_PI;
  t26 = POW_1_3(t25);
  t27 = t26 * t26;
  t29 = t24 / t27;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t37 = t25 * t25;
  t38 = 0.1e1 / t37;
  t39 = sigma[0] * sigma[0];
  t40 = t39 * sigma[0];
  t41 = t38 * t40;
  t42 = t33 * t33;
  t43 = t42 * t42;
  t47 = 0.1e1 + t41 / t43 / 0.576e3;
  t48 = 0.1e1 / t47;
  t49 = t32 / t22 / t33 * t48;
  t52 = 0.1e1 + 0.5e1 / 0.648e3 * t30 * t49;
  t56 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t52);
  tzk0 = 0.2e1 * t56;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t58 = t20 / t21;
  t62 = t33 * rho[0];
  t66 = t32 / t22 / t62 * t48;
  t69 = t39 * t39;
  t70 = t29 * t69;
  t71 = t43 * t62;
  t73 = 0.1e1 / t22 / t71;
  t75 = t47 * t47;
  t76 = 0.1e1 / t75;
  t77 = t76 * t38;
  t81 = -0.5e1 / 0.243e3 * t30 * t66 + 0.5e1 / 0.46656e5 * t70 * t32 * t73 * t77;
  t86 = my_piecewise3(t2, 0, t7 * t58 * t52 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t81);
  tvrho0 = 0.2e1 * rho[0] * t86 + 0.2e1 * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t92 = t43 * t33;
  t94 = 0.1e1 / t22 / t92;
  t99 = 0.5e1 / 0.648e3 * t29 * t49 - 0.5e1 / 0.124416e6 * t29 * t40 * t32 * t94 * t77;
  t103 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t99);
  tvsigma0 = 0.2e1 * rho[0] * t103;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t37, t38, t39, t40, t41, t42;
  double t43, t47, t48, t49, t52, t56, tzk0;

  double t58, t62, t66, t69, t70, t71, t73, t75;
  double t76, t77, t81, t86, tvrho0, t92, t94, t99;
  double t103, tvsigma0;

  double t108, t118, t121, t123, t128, t129, t130, t133;
  double t136, t137, t138, t139, t143, t148, tv2rho20, t156;
  double t157, t161, t165, t170, t175, tv2rhosigma0, t178, t179;
  double t183, t187, t192, t196, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = M_PI * M_PI;
  t26 = POW_1_3(t25);
  t27 = t26 * t26;
  t29 = t24 / t27;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t37 = t25 * t25;
  t38 = 0.1e1 / t37;
  t39 = sigma[0] * sigma[0];
  t40 = t39 * sigma[0];
  t41 = t38 * t40;
  t42 = t33 * t33;
  t43 = t42 * t42;
  t47 = 0.1e1 + t41 / t43 / 0.576e3;
  t48 = 0.1e1 / t47;
  t49 = t32 / t22 / t33 * t48;
  t52 = 0.1e1 + 0.5e1 / 0.648e3 * t30 * t49;
  t56 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t52);
  tzk0 = 0.2e1 * t56;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t58 = t20 / t21;
  t62 = t33 * rho[0];
  t66 = t32 / t22 / t62 * t48;
  t69 = t39 * t39;
  t70 = t29 * t69;
  t71 = t43 * t62;
  t73 = 0.1e1 / t22 / t71;
  t75 = t47 * t47;
  t76 = 0.1e1 / t75;
  t77 = t76 * t38;
  t81 = -0.5e1 / 0.243e3 * t30 * t66 + 0.5e1 / 0.46656e5 * t70 * t32 * t73 * t77;
  t86 = my_piecewise3(t2, 0, t7 * t58 * t52 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t81);
  tvrho0 = 0.2e1 * rho[0] * t86 + 0.2e1 * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t92 = t43 * t33;
  t94 = 0.1e1 / t22 / t92;
  t99 = 0.5e1 / 0.648e3 * t29 * t49 - 0.5e1 / 0.124416e6 * t29 * t40 * t32 * t94 * t77;
  t103 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t99);
  tvsigma0 = 0.2e1 * rho[0] * t103;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 / t21 / rho[0];
  t118 = t32 / t22 / t42 * t48;
  t121 = t43 * t42;
  t123 = 0.1e1 / t22 / t121;
  t128 = t69 * t40;
  t129 = t29 * t128;
  t130 = t43 * t43;
  t133 = 0.1e1 / t22 / t130 / t42;
  t136 = 0.1e1 / t75 / t47;
  t137 = t37 * t37;
  t138 = 0.1e1 / t137;
  t139 = t136 * t138;
  t143 = 0.55e2 / 0.729e3 * t30 * t118 - 0.215e3 / 0.139968e6 * t70 * t32 * t123 * t77 + 0.5e1 / 0.1679616e7 * t129 * t32 * t133 * t139;
  t148 = my_piecewise3(t2, 0, -t7 * t108 * t52 / 0.3e2 + t7 * t58 * t81 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t143);
  tv2rho20 = 0.2e1 * rho[0] * t148 + 0.4e1 * t86;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t156 = t29 * t32;
  t157 = t73 * t76;
  t161 = t69 * t39;
  t165 = 0.1e1 / t22 / t130 / t62;
  t170 = -0.5e1 / 0.243e3 * t29 * t66 + 0.25e2 / 0.46656e5 * t156 * t157 * t41 - 0.5e1 / 0.4478976e7 * t29 * t161 * t32 * t165 * t139;
  t175 = my_piecewise3(t2, 0, t7 * t58 * t99 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t178 = t94 * t76;
  t179 = t38 * t39;
  t183 = t69 * sigma[0];
  t187 = 0.1e1 / t22 / t130 / t33;
  t192 = -0.5e1 / 0.31104e5 * t156 * t178 * t179 + 0.5e1 / 0.11943936e8 * t29 * t183 * t32 * t187 * t139;
  t196 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t192);
  tv2sigma20 = 0.2e1 * rho[0] * t196;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t37, t38, t39, t40, t41, t42;
  double t43, t47, t48, t49, t52, t56, tzk0;

  double t58, t62, t66, t69, t70, t71, t73, t75;
  double t76, t77, t81, t86, tvrho0, t92, t94, t99;
  double t103, tvsigma0;

  double t108, t118, t121, t123, t128, t129, t130, t133;
  double t136, t137, t138, t139, t143, t148, tv2rho20, t156;
  double t157, t161, t165, t170, t175, tv2rhosigma0, t178, t179;
  double t183, t187, t192, t196, tv2sigma20;

  double t201, t211, t215, t218, t220, t227, t232, t234;
  double t237, t239, t240, t242, t243, t247, t252, tv3rho30;
  double t264, t268, t269, t273, t274, t277, t282, t287;
  double tv3rho2sigma0, t296, t297, t304, t309, t314, tv3rhosigma20, t317;
  double t318, t322, t328, t333, t337, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = M_PI * M_PI;
  t26 = POW_1_3(t25);
  t27 = t26 * t26;
  t29 = t24 / t27;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t37 = t25 * t25;
  t38 = 0.1e1 / t37;
  t39 = sigma[0] * sigma[0];
  t40 = t39 * sigma[0];
  t41 = t38 * t40;
  t42 = t33 * t33;
  t43 = t42 * t42;
  t47 = 0.1e1 + t41 / t43 / 0.576e3;
  t48 = 0.1e1 / t47;
  t49 = t32 / t22 / t33 * t48;
  t52 = 0.1e1 + 0.5e1 / 0.648e3 * t30 * t49;
  t56 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t52);
  tzk0 = 0.2e1 * t56;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t58 = t20 / t21;
  t62 = t33 * rho[0];
  t66 = t32 / t22 / t62 * t48;
  t69 = t39 * t39;
  t70 = t29 * t69;
  t71 = t43 * t62;
  t73 = 0.1e1 / t22 / t71;
  t75 = t47 * t47;
  t76 = 0.1e1 / t75;
  t77 = t76 * t38;
  t81 = -0.5e1 / 0.243e3 * t30 * t66 + 0.5e1 / 0.46656e5 * t70 * t32 * t73 * t77;
  t86 = my_piecewise3(t2, 0, t7 * t58 * t52 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t81);
  tvrho0 = 0.2e1 * rho[0] * t86 + 0.2e1 * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t92 = t43 * t33;
  t94 = 0.1e1 / t22 / t92;
  t99 = 0.5e1 / 0.648e3 * t29 * t49 - 0.5e1 / 0.124416e6 * t29 * t40 * t32 * t94 * t77;
  t103 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t99);
  tvsigma0 = 0.2e1 * rho[0] * t103;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 / t21 / rho[0];
  t118 = t32 / t22 / t42 * t48;
  t121 = t43 * t42;
  t123 = 0.1e1 / t22 / t121;
  t128 = t69 * t40;
  t129 = t29 * t128;
  t130 = t43 * t43;
  t133 = 0.1e1 / t22 / t130 / t42;
  t136 = 0.1e1 / t75 / t47;
  t137 = t37 * t37;
  t138 = 0.1e1 / t137;
  t139 = t136 * t138;
  t143 = 0.55e2 / 0.729e3 * t30 * t118 - 0.215e3 / 0.139968e6 * t70 * t32 * t123 * t77 + 0.5e1 / 0.1679616e7 * t129 * t32 * t133 * t139;
  t148 = my_piecewise3(t2, 0, -t7 * t108 * t52 / 0.3e2 + t7 * t58 * t81 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t143);
  tv2rho20 = 0.2e1 * rho[0] * t148 + 0.4e1 * t86;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t156 = t29 * t32;
  t157 = t73 * t76;
  t161 = t69 * t39;
  t165 = 0.1e1 / t22 / t130 / t62;
  t170 = -0.5e1 / 0.243e3 * t29 * t66 + 0.25e2 / 0.46656e5 * t156 * t157 * t41 - 0.5e1 / 0.4478976e7 * t29 * t161 * t32 * t165 * t139;
  t175 = my_piecewise3(t2, 0, t7 * t58 * t99 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t178 = t94 * t76;
  t179 = t38 * t39;
  t183 = t69 * sigma[0];
  t187 = 0.1e1 / t22 / t130 / t33;
  t192 = -0.5e1 / 0.31104e5 * t156 * t178 * t179 + 0.5e1 / 0.11943936e8 * t29 * t183 * t32 * t187 * t139;
  t196 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t192);
  tv2sigma20 = 0.2e1 * rho[0] * t196;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t201 = t20 / t21 / t33;
  t211 = t42 * rho[0];
  t215 = t32 / t22 / t211 * t48;
  t218 = t43 * t211;
  t220 = 0.1e1 / t22 / t218;
  t227 = 0.1e1 / t22 / t130 / t211;
  t232 = t69 * t69;
  t234 = t29 * t232 * t39;
  t237 = 0.1e1 / t22 / t130 / t218;
  t239 = t75 * t75;
  t240 = 0.1e1 / t239;
  t242 = 0.1e1 / t137 / t37;
  t243 = t240 * t242;
  t247 = -0.77e3 / 0.2187e4 * t30 * t215 + 0.1435e4 / 0.69984e5 * t70 * t32 * t220 * t77 - 0.175e3 / 0.1679616e7 * t129 * t32 * t227 * t139 + 0.5e1 / 0.40310784e8 * t234 * t32 * t237 * t243;
  t252 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t201 * t52 - t7 * t108 * t81 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t58 * t143 + 0.3e1 / 0.2e2 * t7 * t23 * t247);
  tv3rho30 = 0.2e1 * rho[0] * t252 + 0.6e1 * t148;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t264 = t123 * t76;
  t268 = t133 * t136;
  t269 = t138 * t161;
  t273 = t232 * sigma[0];
  t274 = t29 * t273;
  t277 = 0.1e1 / t22 / t130 / t121;
  t282 = 0.55e2 / 0.729e3 * t29 * t118 - 0.305e3 / 0.46656e5 * t156 * t264 * t41 + 0.55e2 / 0.1492992e7 * t156 * t268 * t269 - 0.5e1 / 0.107495424e9 * t274 * t32 * t277 * t243;
  t287 = my_piecewise3(t2, 0, -t7 * t108 * t99 / 0.3e2 + t7 * t58 * t170 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t282);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t296 = t165 * t136;
  t297 = t138 * t183;
  t304 = 0.1e1 / t22 / t130 / t71;
  t309 = 0.5e1 / 0.2916e4 * t156 * t157 * t179 - 0.55e2 / 0.4478976e7 * t156 * t296 * t297 + 0.5e1 / 0.286654464e9 * t29 * t232 * t32 * t304 * t243;
  t314 = my_piecewise3(t2, 0, t7 * t58 * t192 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t309);
  tv3rhosigma20 = 0.2e1 * rho[0] * t314 + 0.2e1 * t196;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t317 = t187 * t136;
  t318 = t138 * t69;
  t322 = t38 * sigma[0];
  t328 = 0.1e1 / t22 / t130 / t92;
  t333 = 0.5e1 / 0.1327104e7 * t156 * t317 * t318 - 0.5e1 / 0.15552e5 * t156 * t178 * t322 - 0.5e1 / 0.764411904e9 * t129 * t32 * t328 * t243;
  t337 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t333);
  tv3sigma30 = 0.2e1 * rho[0] * t337;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t37, t38, t39, t40, t41, t42;
  double t43, t47, t48, t49, t52, t56, tzk0;

  double t58, t62, t66, t69, t70, t71, t73, t75;
  double t76, t77, t81, t86, tvrho0, t92, t94, t99;
  double t103, tvsigma0;

  double t108, t118, t121, t123, t128, t129, t130, t133;
  double t136, t137, t138, t139, t143, t148, tv2rho20, t156;
  double t157, t161, t165, t170, t175, tv2rhosigma0, t178, t179;
  double t183, t187, t192, t196, tv2sigma20;

  double t201, t211, t215, t218, t220, t227, t232, t234;
  double t237, t239, t240, t242, t243, t247, t252, tv3rho30;
  double t264, t268, t269, t273, t274, t277, t282, t287;
  double tv3rho2sigma0, t296, t297, t304, t309, t314, tv3rhosigma20, t317;
  double t318, t322, t328, t333, t337, tv3sigma30;

  double t355, t362, t385, t392, t394, t403, tv4rho40, t445;
  double tv4rho3sigma0, t480, tv4rho2sigma20, t509, tv4rhosigma30, t535, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = M_PI * M_PI;
  t26 = POW_1_3(t25);
  t27 = t26 * t26;
  t29 = t24 / t27;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t37 = t25 * t25;
  t38 = 0.1e1 / t37;
  t39 = sigma[0] * sigma[0];
  t40 = t39 * sigma[0];
  t41 = t38 * t40;
  t42 = t33 * t33;
  t43 = t42 * t42;
  t47 = 0.1e1 + t41 / t43 / 0.576e3;
  t48 = 0.1e1 / t47;
  t49 = t32 / t22 / t33 * t48;
  t52 = 0.1e1 + 0.5e1 / 0.648e3 * t30 * t49;
  t56 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t52);
  tzk0 = 0.2e1 * t56;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t58 = t20 / t21;
  t62 = t33 * rho[0];
  t66 = t32 / t22 / t62 * t48;
  t69 = t39 * t39;
  t70 = t29 * t69;
  t71 = t43 * t62;
  t73 = 0.1e1 / t22 / t71;
  t75 = t47 * t47;
  t76 = 0.1e1 / t75;
  t77 = t76 * t38;
  t81 = -0.5e1 / 0.243e3 * t30 * t66 + 0.5e1 / 0.46656e5 * t70 * t32 * t73 * t77;
  t86 = my_piecewise3(t2, 0, t7 * t58 * t52 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t81);
  tvrho0 = 0.2e1 * rho[0] * t86 + 0.2e1 * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t92 = t43 * t33;
  t94 = 0.1e1 / t22 / t92;
  t99 = 0.5e1 / 0.648e3 * t29 * t49 - 0.5e1 / 0.124416e6 * t29 * t40 * t32 * t94 * t77;
  t103 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t99);
  tvsigma0 = 0.2e1 * rho[0] * t103;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 / t21 / rho[0];
  t118 = t32 / t22 / t42 * t48;
  t121 = t43 * t42;
  t123 = 0.1e1 / t22 / t121;
  t128 = t69 * t40;
  t129 = t29 * t128;
  t130 = t43 * t43;
  t133 = 0.1e1 / t22 / t130 / t42;
  t136 = 0.1e1 / t75 / t47;
  t137 = t37 * t37;
  t138 = 0.1e1 / t137;
  t139 = t136 * t138;
  t143 = 0.55e2 / 0.729e3 * t30 * t118 - 0.215e3 / 0.139968e6 * t70 * t32 * t123 * t77 + 0.5e1 / 0.1679616e7 * t129 * t32 * t133 * t139;
  t148 = my_piecewise3(t2, 0, -t7 * t108 * t52 / 0.3e2 + t7 * t58 * t81 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t143);
  tv2rho20 = 0.2e1 * rho[0] * t148 + 0.4e1 * t86;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t156 = t29 * t32;
  t157 = t73 * t76;
  t161 = t69 * t39;
  t165 = 0.1e1 / t22 / t130 / t62;
  t170 = -0.5e1 / 0.243e3 * t29 * t66 + 0.25e2 / 0.46656e5 * t156 * t157 * t41 - 0.5e1 / 0.4478976e7 * t29 * t161 * t32 * t165 * t139;
  t175 = my_piecewise3(t2, 0, t7 * t58 * t99 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t178 = t94 * t76;
  t179 = t38 * t39;
  t183 = t69 * sigma[0];
  t187 = 0.1e1 / t22 / t130 / t33;
  t192 = -0.5e1 / 0.31104e5 * t156 * t178 * t179 + 0.5e1 / 0.11943936e8 * t29 * t183 * t32 * t187 * t139;
  t196 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t192);
  tv2sigma20 = 0.2e1 * rho[0] * t196;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t201 = t20 / t21 / t33;
  t211 = t42 * rho[0];
  t215 = t32 / t22 / t211 * t48;
  t218 = t43 * t211;
  t220 = 0.1e1 / t22 / t218;
  t227 = 0.1e1 / t22 / t130 / t211;
  t232 = t69 * t69;
  t234 = t29 * t232 * t39;
  t237 = 0.1e1 / t22 / t130 / t218;
  t239 = t75 * t75;
  t240 = 0.1e1 / t239;
  t242 = 0.1e1 / t137 / t37;
  t243 = t240 * t242;
  t247 = -0.77e3 / 0.2187e4 * t30 * t215 + 0.1435e4 / 0.69984e5 * t70 * t32 * t220 * t77 - 0.175e3 / 0.1679616e7 * t129 * t32 * t227 * t139 + 0.5e1 / 0.40310784e8 * t234 * t32 * t237 * t243;
  t252 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t201 * t52 - t7 * t108 * t81 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t58 * t143 + 0.3e1 / 0.2e2 * t7 * t23 * t247);
  tv3rho30 = 0.2e1 * rho[0] * t252 + 0.6e1 * t148;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t264 = t123 * t76;
  t268 = t133 * t136;
  t269 = t138 * t161;
  t273 = t232 * sigma[0];
  t274 = t29 * t273;
  t277 = 0.1e1 / t22 / t130 / t121;
  t282 = 0.55e2 / 0.729e3 * t29 * t118 - 0.305e3 / 0.46656e5 * t156 * t264 * t41 + 0.55e2 / 0.1492992e7 * t156 * t268 * t269 - 0.5e1 / 0.107495424e9 * t274 * t32 * t277 * t243;
  t287 = my_piecewise3(t2, 0, -t7 * t108 * t99 / 0.3e2 + t7 * t58 * t170 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t282);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t296 = t165 * t136;
  t297 = t138 * t183;
  t304 = 0.1e1 / t22 / t130 / t71;
  t309 = 0.5e1 / 0.2916e4 * t156 * t157 * t179 - 0.55e2 / 0.4478976e7 * t156 * t296 * t297 + 0.5e1 / 0.286654464e9 * t29 * t232 * t32 * t304 * t243;
  t314 = my_piecewise3(t2, 0, t7 * t58 * t192 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t309);
  tv3rhosigma20 = 0.2e1 * rho[0] * t314 + 0.2e1 * t196;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t317 = t187 * t136;
  t318 = t138 * t69;
  t322 = t38 * sigma[0];
  t328 = 0.1e1 / t22 / t130 / t92;
  t333 = 0.5e1 / 0.1327104e7 * t156 * t317 * t318 - 0.5e1 / 0.15552e5 * t156 * t178 * t322 - 0.5e1 / 0.764411904e9 * t129 * t32 * t328 * t243;
  t337 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t333);
  tv3sigma30 = 0.2e1 * rho[0] * t337;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t355 = t42 * t33;
  t362 = t43 * t355;
  t385 = t130 * t130;
  t392 = t137 * t137;
  t394 = 0.1e1 / t239 / t47 / t392;
  t403 = my_piecewise3(t2, 0, -0.14e2 / 0.135e3 * t7 * t20 / t21 / t62 * t52 + 0.8e1 / 0.45e2 * t7 * t201 * t81 - t7 * t108 * t143 / 0.5e1 + 0.2e1 / 0.5e1 * t7 * t58 * t247 + 0.3e1 / 0.2e2 * t7 * t23 * (0.1309e5 / 0.6561e4 * t30 * t32 / t22 / t355 * t48 - 0.179585e6 / 0.629856e6 * t70 * t32 / t22 / t362 * t77 + 0.14245e5 / 0.5038848e7 * t129 * t32 / t22 / t130 / t355 * t139 - 0.485e3 / 0.60466176e8 * t234 * t32 / t22 / t130 / t362 * t243 + 0.5e1 / 0.725594112e9 * t29 * t232 * t183 * t32 / t22 / t385 / t355 * t394));
  tv4rho40 = 0.2e1 * rho[0] * t403 + 0.8e1 * t252;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t445 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t201 * t99 - t7 * t108 * t170 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t58 * t282 + 0.3e1 / 0.2e2 * t7 * t23 * (-0.77e3 / 0.2187e4 * t29 * t215 + 0.17605e5 / 0.209952e6 * t156 * t220 * t76 * t41 - 0.6335e4 / 0.6718464e7 * t156 * t227 * t136 * t269 + 0.925e3 / 0.322486272e9 * t156 * t237 * t240 * t242 * t273 - 0.5e1 / 0.1934917632e10 * t29 * t232 * t69 * t32 / t22 / t385 / t211 * t394));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t445 + 0.6e1 * t287;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t480 = my_piecewise3(t2, 0, -t7 * t108 * t192 / 0.3e2 + t7 * t58 * t309 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * (-0.175e3 / 0.8748e4 * t156 * t264 * t179 + 0.1295e4 / 0.4478976e7 * t156 * t268 * t297 - 0.95e2 / 0.95551488e8 * t156 * t277 * t240 * t242 * t232 + 0.5e1 / 0.5159780352e10 * t29 * t232 * t40 * t32 / t22 / t385 / t42 * t394));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t480 + 0.4e1 * t314;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t509 = my_piecewise3(t2, 0, t7 * t58 * t333 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * (-0.355e3 / 0.4478976e7 * t156 * t296 * t318 + 0.95e2 / 0.286654464e9 * t156 * t304 * t240 * t242 * t128 + 0.5e1 / 0.1458e4 * t156 * t157 * t322 - 0.5e1 / 0.13759414272e11 * t234 * t32 / t22 / t385 / t62 * t394));
  tv4rhosigma30 = 0.2e1 * rho[0] * t509 + 0.2e1 * t337;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t535 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * (-0.5e1 / 0.47775744e8 * t156 * t328 * t240 * t242 * t161 + 0.55e2 / 0.2985984e7 * t156 * t317 * t138 * t40 - 0.5e1 / 0.15552e5 * t156 * t178 * t38 + 0.5e1 / 0.36691771392e11 * t274 * t32 / t22 / t385 / t33 * t394));
  tv4sigma40 = 0.2e1 * rho[0] * t535;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t39, t40;
  double t42, t44, t45, t46, t47, t49, t50, t54;
  double t55, t59, t63, t64, t65, t67, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t79;
  double t81, t82, t84, t85, t89, t90, t94, t98;
  double tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = M_PI * M_PI;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t37 = t32 / t35;
  t38 = rho[0] * rho[0];
  t39 = POW_1_3(rho[0]);
  t40 = t39 * t39;
  t42 = 0.1e1 / t40 / t38;
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t46 = sigma[0] * sigma[0];
  t47 = t46 * sigma[0];
  t49 = t38 * t38;
  t50 = t49 * t49;
  t54 = 0.1e1 + t45 * t47 / t50 / 0.2304e4;
  t55 = 0.1e1 / t54;
  t59 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[0] * t42 * t55;
  t63 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t59);
  t64 = rho[1] <= p->dens_threshold;
  t65 = -t17;
  t67 = my_piecewise5(t15, t12, t11, t16, t65 * t8);
  t68 = 0.1e1 + t67;
  t69 = t68 <= p->zeta_threshold;
  t70 = POW_1_3(t68);
  t71 = t70 * t70;
  t73 = my_piecewise3(t69, t24, t71 * t68);
  t74 = t73 * t30;
  t75 = rho[1] * rho[1];
  t76 = POW_1_3(rho[1]);
  t77 = t76 * t76;
  t79 = 0.1e1 / t77 / t75;
  t81 = sigma[2] * sigma[2];
  t82 = t81 * sigma[2];
  t84 = t75 * t75;
  t85 = t84 * t84;
  t89 = 0.1e1 + t45 * t82 / t85 / 0.2304e4;
  t90 = 0.1e1 / t89;
  t94 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[2] * t79 * t90;
  t98 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t94);
  tzk0 = t63 + t98;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t39, t40;
  double t42, t44, t45, t46, t47, t49, t50, t54;
  double t55, t59, t63, t64, t65, t67, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t79;
  double t81, t82, t84, t85, t89, t90, t94, t98;
  double tzk0;

  double t99, t100, t101, t103, t106, t107, t111, t112;
  double t115, t116, t118, t123, t124, t125, t127, t128;
  double t129, t134, t139, t140, t142, t145, t146, t150;
  double t153, t155, tvrho0, t159, t162, t163, t168, t170;
  double t173, t174, t178, t180, t185, t186, t187, t189;
  double t190, t191, t196, t201, tvrho1, t208, t210, t212;
  double t215, t219, tvsigma0, tvsigma1, t224, t226, t228, t231;
  double t235, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = M_PI * M_PI;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t37 = t32 / t35;
  t38 = rho[0] * rho[0];
  t39 = POW_1_3(rho[0]);
  t40 = t39 * t39;
  t42 = 0.1e1 / t40 / t38;
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t46 = sigma[0] * sigma[0];
  t47 = t46 * sigma[0];
  t49 = t38 * t38;
  t50 = t49 * t49;
  t54 = 0.1e1 + t45 * t47 / t50 / 0.2304e4;
  t55 = 0.1e1 / t54;
  t59 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[0] * t42 * t55;
  t63 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t59);
  t64 = rho[1] <= p->dens_threshold;
  t65 = -t17;
  t67 = my_piecewise5(t15, t12, t11, t16, t65 * t8);
  t68 = 0.1e1 + t67;
  t69 = t68 <= p->zeta_threshold;
  t70 = POW_1_3(t68);
  t71 = t70 * t70;
  t73 = my_piecewise3(t69, t24, t71 * t68);
  t74 = t73 * t30;
  t75 = rho[1] * rho[1];
  t76 = POW_1_3(rho[1]);
  t77 = t76 * t76;
  t79 = 0.1e1 / t77 / t75;
  t81 = sigma[2] * sigma[2];
  t82 = t81 * sigma[2];
  t84 = t75 * t75;
  t85 = t84 * t84;
  t89 = 0.1e1 + t45 * t82 / t85 / 0.2304e4;
  t90 = 0.1e1 / t89;
  t94 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[2] * t79 * t90;
  t98 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t94);
  tzk0 = t63 + t98;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t99 = t7 * t7;
  t100 = 0.1e1 / t99;
  t101 = t17 * t100;
  t103 = my_piecewise5(t11, 0, t15, 0, t8 - t101);
  t106 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t103);
  t107 = t106 * t30;
  t111 = 0.1e1 / t29;
  t112 = t28 * t111;
  t115 = t6 * t112 * t59 / 0.1e2;
  t116 = t38 * rho[0];
  t118 = 0.1e1 / t40 / t116;
  t123 = t46 * t46;
  t124 = t37 * t123;
  t125 = t50 * t116;
  t127 = 0.1e1 / t40 / t125;
  t128 = t54 * t54;
  t129 = 0.1e1 / t128;
  t134 = -0.5e1 / 0.243e3 * t37 * sigma[0] * t118 * t55 + 0.5e1 / 0.186624e6 * t124 * t127 * t129 * t45;
  t139 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t59 + t115 + 0.3e1 / 0.2e2 * t6 * t31 * t134);
  t140 = t65 * t100;
  t142 = my_piecewise5(t15, 0, t11, 0, -t8 - t140);
  t145 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t142);
  t146 = t145 * t30;
  t150 = t73 * t111;
  t153 = t6 * t150 * t94 / 0.1e2;
  t155 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t94 + t153);
  tvrho0 = t63 + t98 + t7 * (t139 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t159 = my_piecewise5(t11, 0, t15, 0, -t8 - t101);
  t162 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t159);
  t163 = t162 * t30;
  t168 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t59 + t115);
  t170 = my_piecewise5(t15, 0, t11, 0, t8 - t140);
  t173 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t170);
  t174 = t173 * t30;
  t178 = t75 * rho[1];
  t180 = 0.1e1 / t77 / t178;
  t185 = t81 * t81;
  t186 = t37 * t185;
  t187 = t85 * t178;
  t189 = 0.1e1 / t77 / t187;
  t190 = t89 * t89;
  t191 = 0.1e1 / t190;
  t196 = -0.5e1 / 0.243e3 * t37 * sigma[2] * t180 * t90 + 0.5e1 / 0.186624e6 * t186 * t189 * t191 * t45;
  t201 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t94 + t153 + 0.3e1 / 0.2e2 * t6 * t74 * t196);
  tvrho1 = t63 + t98 + t7 * (t168 + t201);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t208 = t50 * t38;
  t210 = 0.1e1 / t40 / t208;
  t212 = t210 * t129 * t45;
  t215 = 0.5e1 / 0.648e3 * t37 * t42 * t55 - 0.5e1 / 0.497664e6 * t37 * t47 * t212;
  t219 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t215);
  tvsigma0 = t7 * t219;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t224 = t85 * t75;
  t226 = 0.1e1 / t77 / t224;
  t228 = t226 * t191 * t45;
  t231 = 0.5e1 / 0.648e3 * t37 * t79 * t90 - 0.5e1 / 0.497664e6 * t37 * t82 * t228;
  t235 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t231);
  tvsigma2 = t7 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t39, t40;
  double t42, t44, t45, t46, t47, t49, t50, t54;
  double t55, t59, t63, t64, t65, t67, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t79;
  double t81, t82, t84, t85, t89, t90, t94, t98;
  double tzk0;

  double t99, t100, t101, t103, t106, t107, t111, t112;
  double t115, t116, t118, t123, t124, t125, t127, t128;
  double t129, t134, t139, t140, t142, t145, t146, t150;
  double t153, t155, tvrho0, t159, t162, t163, t168, t170;
  double t173, t174, t178, t180, t185, t186, t187, t189;
  double t190, t191, t196, t201, tvrho1, t208, t210, t212;
  double t215, t219, tvsigma0, tvsigma1, t224, t226, t228, t231;
  double t235, tvsigma2;

  double t238, t239, t242, t243, t244, t247, t251, t252;
  double t256, t258, t264, t265, t268, t270, t273, t278;
  double t280, t285, t286, t287, t290, t292, t294, t295;
  double t299, t304, t305, t306, t309, t312, t316, t317;
  double t321, t323, t325, t328, t330, tv2rho20, t333, t337;
  double t341, t342, t346, t348, t356, t357, t361, t365;
  double t366, t370, t372, t379, t382, tv2rho21, t387, t392;
  double t396, t397, t403, t404, t409, t413, t414, t424;
  double t429, t431, t436, t437, t438, t441, t443, t448;
  double t453, tv2rho22, t461, t465, t466, t467, t470, t474;
  double t479, t484, tv2rhosigma0, tv2rhosigma1, t491, t493, tv2rhosigma2, t499;
  double tv2rhosigma3, tv2rhosigma4, t507, t508, t509, t512, t516, t521;
  double t526, tv2rhosigma5, t528, t529, t532, t536, t541, t545;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t546, t547, t550;
  double t554, t559, t563, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = M_PI * M_PI;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t37 = t32 / t35;
  t38 = rho[0] * rho[0];
  t39 = POW_1_3(rho[0]);
  t40 = t39 * t39;
  t42 = 0.1e1 / t40 / t38;
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t46 = sigma[0] * sigma[0];
  t47 = t46 * sigma[0];
  t49 = t38 * t38;
  t50 = t49 * t49;
  t54 = 0.1e1 + t45 * t47 / t50 / 0.2304e4;
  t55 = 0.1e1 / t54;
  t59 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[0] * t42 * t55;
  t63 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t59);
  t64 = rho[1] <= p->dens_threshold;
  t65 = -t17;
  t67 = my_piecewise5(t15, t12, t11, t16, t65 * t8);
  t68 = 0.1e1 + t67;
  t69 = t68 <= p->zeta_threshold;
  t70 = POW_1_3(t68);
  t71 = t70 * t70;
  t73 = my_piecewise3(t69, t24, t71 * t68);
  t74 = t73 * t30;
  t75 = rho[1] * rho[1];
  t76 = POW_1_3(rho[1]);
  t77 = t76 * t76;
  t79 = 0.1e1 / t77 / t75;
  t81 = sigma[2] * sigma[2];
  t82 = t81 * sigma[2];
  t84 = t75 * t75;
  t85 = t84 * t84;
  t89 = 0.1e1 + t45 * t82 / t85 / 0.2304e4;
  t90 = 0.1e1 / t89;
  t94 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[2] * t79 * t90;
  t98 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t94);
  tzk0 = t63 + t98;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t99 = t7 * t7;
  t100 = 0.1e1 / t99;
  t101 = t17 * t100;
  t103 = my_piecewise5(t11, 0, t15, 0, t8 - t101);
  t106 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t103);
  t107 = t106 * t30;
  t111 = 0.1e1 / t29;
  t112 = t28 * t111;
  t115 = t6 * t112 * t59 / 0.1e2;
  t116 = t38 * rho[0];
  t118 = 0.1e1 / t40 / t116;
  t123 = t46 * t46;
  t124 = t37 * t123;
  t125 = t50 * t116;
  t127 = 0.1e1 / t40 / t125;
  t128 = t54 * t54;
  t129 = 0.1e1 / t128;
  t134 = -0.5e1 / 0.243e3 * t37 * sigma[0] * t118 * t55 + 0.5e1 / 0.186624e6 * t124 * t127 * t129 * t45;
  t139 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t59 + t115 + 0.3e1 / 0.2e2 * t6 * t31 * t134);
  t140 = t65 * t100;
  t142 = my_piecewise5(t15, 0, t11, 0, -t8 - t140);
  t145 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t142);
  t146 = t145 * t30;
  t150 = t73 * t111;
  t153 = t6 * t150 * t94 / 0.1e2;
  t155 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t94 + t153);
  tvrho0 = t63 + t98 + t7 * (t139 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t159 = my_piecewise5(t11, 0, t15, 0, -t8 - t101);
  t162 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t159);
  t163 = t162 * t30;
  t168 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t59 + t115);
  t170 = my_piecewise5(t15, 0, t11, 0, t8 - t140);
  t173 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t170);
  t174 = t173 * t30;
  t178 = t75 * rho[1];
  t180 = 0.1e1 / t77 / t178;
  t185 = t81 * t81;
  t186 = t37 * t185;
  t187 = t85 * t178;
  t189 = 0.1e1 / t77 / t187;
  t190 = t89 * t89;
  t191 = 0.1e1 / t190;
  t196 = -0.5e1 / 0.243e3 * t37 * sigma[2] * t180 * t90 + 0.5e1 / 0.186624e6 * t186 * t189 * t191 * t45;
  t201 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t94 + t153 + 0.3e1 / 0.2e2 * t6 * t74 * t196);
  tvrho1 = t63 + t98 + t7 * (t168 + t201);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t208 = t50 * t38;
  t210 = 0.1e1 / t40 / t208;
  t212 = t210 * t129 * t45;
  t215 = 0.5e1 / 0.648e3 * t37 * t42 * t55 - 0.5e1 / 0.497664e6 * t37 * t47 * t212;
  t219 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t215);
  tvsigma0 = t7 * t219;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t224 = t85 * t75;
  t226 = 0.1e1 / t77 / t224;
  t228 = t226 * t191 * t45;
  t231 = 0.5e1 / 0.648e3 * t37 * t79 * t90 - 0.5e1 / 0.497664e6 * t37 * t82 * t228;
  t235 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t231);
  tvsigma2 = t7 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t238 = 0.1e1 / t25;
  t239 = t103 * t103;
  t242 = t99 * t7;
  t243 = 0.1e1 / t242;
  t244 = t17 * t243;
  t247 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t100 + 0.2e1 * t244);
  t251 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t239 + 0.5e1 / 0.3e1 * t26 * t247);
  t252 = t251 * t30;
  t256 = t106 * t111;
  t258 = t6 * t256 * t59;
  t264 = 0.1e1 / t29 / t7;
  t265 = t28 * t264;
  t268 = t6 * t265 * t59 / 0.3e2;
  t270 = t6 * t112 * t134;
  t273 = 0.1e1 / t40 / t49;
  t278 = t50 * t49;
  t280 = 0.1e1 / t40 / t278;
  t285 = t123 * t47;
  t286 = t37 * t285;
  t287 = t50 * t50;
  t290 = 0.1e1 / t40 / t287 / t49;
  t292 = 0.1e1 / t128 / t54;
  t294 = t44 * t44;
  t295 = 0.1e1 / t294;
  t299 = 0.55e2 / 0.729e3 * t37 * sigma[0] * t273 * t55 - 0.215e3 / 0.559872e6 * t124 * t280 * t129 * t45 + 0.5e1 / 0.26873856e8 * t286 * t290 * t292 * t295;
  t304 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t59 + t258 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t134 - t268 + t270 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t299);
  t305 = 0.1e1 / t70;
  t306 = t142 * t142;
  t309 = t65 * t243;
  t312 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t100 + 0.2e1 * t309);
  t316 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t306 + 0.5e1 / 0.3e1 * t71 * t312);
  t317 = t316 * t30;
  t321 = t145 * t111;
  t323 = t6 * t321 * t94;
  t325 = t73 * t264;
  t328 = t6 * t325 * t94 / 0.3e2;
  t330 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t94 + t323 / 0.5e1 - t328);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t155 + t7 * (t304 + t330);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t333 = t238 * t159;
  t337 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t244);
  t341 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t333 * t103 + 0.5e1 / 0.3e1 * t26 * t337);
  t342 = t341 * t30;
  t346 = t162 * t111;
  t348 = t6 * t346 * t59;
  t356 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t59 + t348 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t134 + t258 / 0.1e2 - t268 + t270 / 0.1e2);
  t357 = t305 * t170;
  t361 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t309);
  t365 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t357 * t142 + 0.5e1 / 0.3e1 * t71 * t361);
  t366 = t365 * t30;
  t370 = t173 * t111;
  t372 = t6 * t370 * t94;
  t379 = t6 * t150 * t196;
  t382 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t94 + t372 / 0.1e2 + t323 / 0.1e2 - t328 + 0.3e1 / 0.2e2 * t6 * t146 * t196 + t379 / 0.1e2);
  tv2rho21 = t139 + t155 + t168 + t201 + t7 * (t356 + t382);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t387 = t159 * t159;
  t392 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t100 + 0.2e1 * t244);
  t396 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t387 + 0.5e1 / 0.3e1 * t26 * t392);
  t397 = t396 * t30;
  t403 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t59 + t348 / 0.5e1 - t268);
  t404 = t170 * t170;
  t409 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t100 + 0.2e1 * t309);
  t413 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t404 + 0.5e1 / 0.3e1 * t71 * t409);
  t414 = t413 * t30;
  t424 = 0.1e1 / t77 / t84;
  t429 = t85 * t84;
  t431 = 0.1e1 / t77 / t429;
  t436 = t185 * t82;
  t437 = t37 * t436;
  t438 = t85 * t85;
  t441 = 0.1e1 / t77 / t438 / t84;
  t443 = 0.1e1 / t190 / t89;
  t448 = 0.55e2 / 0.729e3 * t37 * sigma[2] * t424 * t90 - 0.215e3 / 0.559872e6 * t186 * t431 * t191 * t45 + 0.5e1 / 0.26873856e8 * t437 * t441 * t443 * t295;
  t453 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t94 + t372 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t196 - t328 + t379 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * t448);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t201 + t7 * (t403 + t453);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t461 = t6 * t112 * t215 / 0.1e2;
  t465 = t37 * t127;
  t466 = t129 * t45;
  t467 = t466 * t47;
  t470 = t123 * t46;
  t474 = 0.1e1 / t40 / t287 / t116;
  t479 = -0.5e1 / 0.243e3 * t37 * t118 * t55 + 0.25e2 / 0.186624e6 * t465 * t467 - 0.5e1 / 0.71663616e8 * t37 * t470 * t474 * t292 * t295;
  t484 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t215 + t461 + 0.3e1 / 0.2e2 * t6 * t31 * t479);
  tv2rhosigma0 = t7 * t484 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t491 = t6 * t150 * t231 / 0.1e2;
  t493 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t231 + t491);
  tv2rhosigma2 = t7 * t493 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t499 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t215 + t461);
  tv2rhosigma3 = t7 * t499 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t507 = t37 * t189;
  t508 = t191 * t45;
  t509 = t508 * t82;
  t512 = t185 * t81;
  t516 = 0.1e1 / t77 / t438 / t178;
  t521 = -0.5e1 / 0.243e3 * t37 * t180 * t90 + 0.25e2 / 0.186624e6 * t507 * t509 - 0.5e1 / 0.71663616e8 * t37 * t512 * t516 * t443 * t295;
  t526 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t231 + t491 + 0.3e1 / 0.2e2 * t6 * t74 * t521);
  tv2rhosigma5 = t7 * t526 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t528 = t37 * t210;
  t529 = t466 * t46;
  t532 = t123 * sigma[0];
  t536 = 0.1e1 / t40 / t287 / t38;
  t541 = -0.5e1 / 0.124416e6 * t528 * t529 + 0.5e1 / 0.191102976e9 * t37 * t532 * t536 * t292 * t295;
  t545 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t541);
  tv2sigma20 = t7 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = t37 * t226;
  t547 = t508 * t81;
  t550 = t185 * sigma[2];
  t554 = 0.1e1 / t77 / t438 / t75;
  t559 = -0.5e1 / 0.124416e6 * t546 * t547 + 0.5e1 / 0.191102976e9 * t37 * t550 * t554 * t443 * t295;
  t563 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t559);
  tv2sigma25 = t7 * t563;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t39, t40;
  double t42, t44, t45, t46, t47, t49, t50, t54;
  double t55, t59, t63, t64, t65, t67, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t79;
  double t81, t82, t84, t85, t89, t90, t94, t98;
  double tzk0;

  double t99, t100, t101, t103, t106, t107, t111, t112;
  double t115, t116, t118, t123, t124, t125, t127, t128;
  double t129, t134, t139, t140, t142, t145, t146, t150;
  double t153, t155, tvrho0, t159, t162, t163, t168, t170;
  double t173, t174, t178, t180, t185, t186, t187, t189;
  double t190, t191, t196, t201, tvrho1, t208, t210, t212;
  double t215, t219, tvsigma0, tvsigma1, t224, t226, t228, t231;
  double t235, tvsigma2;

  double t238, t239, t242, t243, t244, t247, t251, t252;
  double t256, t258, t264, t265, t268, t270, t273, t278;
  double t280, t285, t286, t287, t290, t292, t294, t295;
  double t299, t304, t305, t306, t309, t312, t316, t317;
  double t321, t323, t325, t328, t330, tv2rho20, t333, t337;
  double t341, t342, t346, t348, t356, t357, t361, t365;
  double t366, t370, t372, t379, t382, tv2rho21, t387, t392;
  double t396, t397, t403, t404, t409, t413, t414, t424;
  double t429, t431, t436, t437, t438, t441, t443, t448;
  double t453, tv2rho22, t461, t465, t466, t467, t470, t474;
  double t479, t484, tv2rhosigma0, tv2rhosigma1, t491, t493, tv2rhosigma2, t499;
  double tv2rhosigma3, tv2rhosigma4, t507, t508, t509, t512, t516, t521;
  double t526, tv2rhosigma5, t528, t529, t532, t536, t541, t545;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t546, t547, t550;
  double t554, t559, t563, tv2sigma25;

  double t567, t568, t571, t574, t575, t576, t579, t583;
  double t584, t588, t590, t595, t597, t600, t606, t607;
  double t610, t612, t615, t617, t619, t624, t626, t633;
  double t638, t640, t643, t644, t645, t648, t652, t657;
  double t659, t660, t663, t666, t669, t673, t674, t678;
  double t680, t682, t684, t686, t689, t691, tv3rho30, t694;
  double t695, t696, t699, t704, t705, t707, t711, t712;
  double t716, t719, t723, t725, t729, t738, t739, t740;
  double t743, t748, t750, t754, t755, t759, t762, t763;
  double t765, t774, t776, t779, tv3rho31, t782, t787, t791;
  double t795, t796, t800, t802, t811, t812, t817, t821;
  double t825, t826, t830, t832, t839, t847, t849, t850;
  double tv3rho32, t855, t862, t866, t867, t874, t875, t882;
  double t886, t887, t902, t904, t909, t911, t918, t923;
  double t925, t928, t929, t930, t935, t940, tv3rho33, t948;
  double t955, t957, t962, t965, t966, t967, t970, t971;
  double t974, t979, t984, tv3rho2sigma0, tv3rho2sigma1, t991, t995, t997;
  double tv3rho2sigma2, t1003, t1011, tv3rho2sigma3, tv3rho2sigma4, t1017, t1024, t1027;
  double tv3rho2sigma5, t1035, tv3rho2sigma6, tv3rho2sigma7, t1049, t1052, t1053, t1054;
  double t1057, t1058, t1061, t1066, t1071, tv3rho2sigma8, t1078, t1081;
  double t1082, t1088, t1093, t1098, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1105, t1107, tv3rhosigma25, t1113, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1120, t1121, t1127, t1132, t1137, tv3rhosigma211;
  double t1139, t1140, t1143, t1148, t1153, t1157, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1158;
  double t1159, t1162, t1167, t1172, t1176, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = M_PI * M_PI;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t37 = t32 / t35;
  t38 = rho[0] * rho[0];
  t39 = POW_1_3(rho[0]);
  t40 = t39 * t39;
  t42 = 0.1e1 / t40 / t38;
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t46 = sigma[0] * sigma[0];
  t47 = t46 * sigma[0];
  t49 = t38 * t38;
  t50 = t49 * t49;
  t54 = 0.1e1 + t45 * t47 / t50 / 0.2304e4;
  t55 = 0.1e1 / t54;
  t59 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[0] * t42 * t55;
  t63 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t59);
  t64 = rho[1] <= p->dens_threshold;
  t65 = -t17;
  t67 = my_piecewise5(t15, t12, t11, t16, t65 * t8);
  t68 = 0.1e1 + t67;
  t69 = t68 <= p->zeta_threshold;
  t70 = POW_1_3(t68);
  t71 = t70 * t70;
  t73 = my_piecewise3(t69, t24, t71 * t68);
  t74 = t73 * t30;
  t75 = rho[1] * rho[1];
  t76 = POW_1_3(rho[1]);
  t77 = t76 * t76;
  t79 = 0.1e1 / t77 / t75;
  t81 = sigma[2] * sigma[2];
  t82 = t81 * sigma[2];
  t84 = t75 * t75;
  t85 = t84 * t84;
  t89 = 0.1e1 + t45 * t82 / t85 / 0.2304e4;
  t90 = 0.1e1 / t89;
  t94 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[2] * t79 * t90;
  t98 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t94);
  tzk0 = t63 + t98;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t99 = t7 * t7;
  t100 = 0.1e1 / t99;
  t101 = t17 * t100;
  t103 = my_piecewise5(t11, 0, t15, 0, t8 - t101);
  t106 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t103);
  t107 = t106 * t30;
  t111 = 0.1e1 / t29;
  t112 = t28 * t111;
  t115 = t6 * t112 * t59 / 0.1e2;
  t116 = t38 * rho[0];
  t118 = 0.1e1 / t40 / t116;
  t123 = t46 * t46;
  t124 = t37 * t123;
  t125 = t50 * t116;
  t127 = 0.1e1 / t40 / t125;
  t128 = t54 * t54;
  t129 = 0.1e1 / t128;
  t134 = -0.5e1 / 0.243e3 * t37 * sigma[0] * t118 * t55 + 0.5e1 / 0.186624e6 * t124 * t127 * t129 * t45;
  t139 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t59 + t115 + 0.3e1 / 0.2e2 * t6 * t31 * t134);
  t140 = t65 * t100;
  t142 = my_piecewise5(t15, 0, t11, 0, -t8 - t140);
  t145 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t142);
  t146 = t145 * t30;
  t150 = t73 * t111;
  t153 = t6 * t150 * t94 / 0.1e2;
  t155 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t94 + t153);
  tvrho0 = t63 + t98 + t7 * (t139 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t159 = my_piecewise5(t11, 0, t15, 0, -t8 - t101);
  t162 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t159);
  t163 = t162 * t30;
  t168 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t59 + t115);
  t170 = my_piecewise5(t15, 0, t11, 0, t8 - t140);
  t173 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t170);
  t174 = t173 * t30;
  t178 = t75 * rho[1];
  t180 = 0.1e1 / t77 / t178;
  t185 = t81 * t81;
  t186 = t37 * t185;
  t187 = t85 * t178;
  t189 = 0.1e1 / t77 / t187;
  t190 = t89 * t89;
  t191 = 0.1e1 / t190;
  t196 = -0.5e1 / 0.243e3 * t37 * sigma[2] * t180 * t90 + 0.5e1 / 0.186624e6 * t186 * t189 * t191 * t45;
  t201 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t94 + t153 + 0.3e1 / 0.2e2 * t6 * t74 * t196);
  tvrho1 = t63 + t98 + t7 * (t168 + t201);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t208 = t50 * t38;
  t210 = 0.1e1 / t40 / t208;
  t212 = t210 * t129 * t45;
  t215 = 0.5e1 / 0.648e3 * t37 * t42 * t55 - 0.5e1 / 0.497664e6 * t37 * t47 * t212;
  t219 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t215);
  tvsigma0 = t7 * t219;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t224 = t85 * t75;
  t226 = 0.1e1 / t77 / t224;
  t228 = t226 * t191 * t45;
  t231 = 0.5e1 / 0.648e3 * t37 * t79 * t90 - 0.5e1 / 0.497664e6 * t37 * t82 * t228;
  t235 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t231);
  tvsigma2 = t7 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t238 = 0.1e1 / t25;
  t239 = t103 * t103;
  t242 = t99 * t7;
  t243 = 0.1e1 / t242;
  t244 = t17 * t243;
  t247 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t100 + 0.2e1 * t244);
  t251 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t239 + 0.5e1 / 0.3e1 * t26 * t247);
  t252 = t251 * t30;
  t256 = t106 * t111;
  t258 = t6 * t256 * t59;
  t264 = 0.1e1 / t29 / t7;
  t265 = t28 * t264;
  t268 = t6 * t265 * t59 / 0.3e2;
  t270 = t6 * t112 * t134;
  t273 = 0.1e1 / t40 / t49;
  t278 = t50 * t49;
  t280 = 0.1e1 / t40 / t278;
  t285 = t123 * t47;
  t286 = t37 * t285;
  t287 = t50 * t50;
  t290 = 0.1e1 / t40 / t287 / t49;
  t292 = 0.1e1 / t128 / t54;
  t294 = t44 * t44;
  t295 = 0.1e1 / t294;
  t299 = 0.55e2 / 0.729e3 * t37 * sigma[0] * t273 * t55 - 0.215e3 / 0.559872e6 * t124 * t280 * t129 * t45 + 0.5e1 / 0.26873856e8 * t286 * t290 * t292 * t295;
  t304 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t59 + t258 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t134 - t268 + t270 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t299);
  t305 = 0.1e1 / t70;
  t306 = t142 * t142;
  t309 = t65 * t243;
  t312 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t100 + 0.2e1 * t309);
  t316 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t306 + 0.5e1 / 0.3e1 * t71 * t312);
  t317 = t316 * t30;
  t321 = t145 * t111;
  t323 = t6 * t321 * t94;
  t325 = t73 * t264;
  t328 = t6 * t325 * t94 / 0.3e2;
  t330 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t94 + t323 / 0.5e1 - t328);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t155 + t7 * (t304 + t330);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t333 = t238 * t159;
  t337 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t244);
  t341 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t333 * t103 + 0.5e1 / 0.3e1 * t26 * t337);
  t342 = t341 * t30;
  t346 = t162 * t111;
  t348 = t6 * t346 * t59;
  t356 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t59 + t348 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t134 + t258 / 0.1e2 - t268 + t270 / 0.1e2);
  t357 = t305 * t170;
  t361 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t309);
  t365 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t357 * t142 + 0.5e1 / 0.3e1 * t71 * t361);
  t366 = t365 * t30;
  t370 = t173 * t111;
  t372 = t6 * t370 * t94;
  t379 = t6 * t150 * t196;
  t382 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t94 + t372 / 0.1e2 + t323 / 0.1e2 - t328 + 0.3e1 / 0.2e2 * t6 * t146 * t196 + t379 / 0.1e2);
  tv2rho21 = t139 + t155 + t168 + t201 + t7 * (t356 + t382);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t387 = t159 * t159;
  t392 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t100 + 0.2e1 * t244);
  t396 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t387 + 0.5e1 / 0.3e1 * t26 * t392);
  t397 = t396 * t30;
  t403 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t59 + t348 / 0.5e1 - t268);
  t404 = t170 * t170;
  t409 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t100 + 0.2e1 * t309);
  t413 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t404 + 0.5e1 / 0.3e1 * t71 * t409);
  t414 = t413 * t30;
  t424 = 0.1e1 / t77 / t84;
  t429 = t85 * t84;
  t431 = 0.1e1 / t77 / t429;
  t436 = t185 * t82;
  t437 = t37 * t436;
  t438 = t85 * t85;
  t441 = 0.1e1 / t77 / t438 / t84;
  t443 = 0.1e1 / t190 / t89;
  t448 = 0.55e2 / 0.729e3 * t37 * sigma[2] * t424 * t90 - 0.215e3 / 0.559872e6 * t186 * t431 * t191 * t45 + 0.5e1 / 0.26873856e8 * t437 * t441 * t443 * t295;
  t453 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t94 + t372 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t196 - t328 + t379 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * t448);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t201 + t7 * (t403 + t453);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t461 = t6 * t112 * t215 / 0.1e2;
  t465 = t37 * t127;
  t466 = t129 * t45;
  t467 = t466 * t47;
  t470 = t123 * t46;
  t474 = 0.1e1 / t40 / t287 / t116;
  t479 = -0.5e1 / 0.243e3 * t37 * t118 * t55 + 0.25e2 / 0.186624e6 * t465 * t467 - 0.5e1 / 0.71663616e8 * t37 * t470 * t474 * t292 * t295;
  t484 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t215 + t461 + 0.3e1 / 0.2e2 * t6 * t31 * t479);
  tv2rhosigma0 = t7 * t484 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t491 = t6 * t150 * t231 / 0.1e2;
  t493 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t231 + t491);
  tv2rhosigma2 = t7 * t493 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t499 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t215 + t461);
  tv2rhosigma3 = t7 * t499 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t507 = t37 * t189;
  t508 = t191 * t45;
  t509 = t508 * t82;
  t512 = t185 * t81;
  t516 = 0.1e1 / t77 / t438 / t178;
  t521 = -0.5e1 / 0.243e3 * t37 * t180 * t90 + 0.25e2 / 0.186624e6 * t507 * t509 - 0.5e1 / 0.71663616e8 * t37 * t512 * t516 * t443 * t295;
  t526 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t231 + t491 + 0.3e1 / 0.2e2 * t6 * t74 * t521);
  tv2rhosigma5 = t7 * t526 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t528 = t37 * t210;
  t529 = t466 * t46;
  t532 = t123 * sigma[0];
  t536 = 0.1e1 / t40 / t287 / t38;
  t541 = -0.5e1 / 0.124416e6 * t528 * t529 + 0.5e1 / 0.191102976e9 * t37 * t532 * t536 * t292 * t295;
  t545 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t541);
  tv2sigma20 = t7 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = t37 * t226;
  t547 = t508 * t81;
  t550 = t185 * sigma[2];
  t554 = 0.1e1 / t77 / t438 / t75;
  t559 = -0.5e1 / 0.124416e6 * t546 * t547 + 0.5e1 / 0.191102976e9 * t37 * t550 * t554 * t443 * t295;
  t563 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t559);
  tv2sigma25 = t7 * t563;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t567 = 0.1e1 / t25 / t20;
  t568 = t239 * t103;
  t571 = t238 * t103;
  t574 = t99 * t99;
  t575 = 0.1e1 / t574;
  t576 = t17 * t575;
  t579 = my_piecewise5(t11, 0, t15, 0, 0.6e1 * t243 - 0.6e1 * t576);
  t583 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t567 * t568 + 0.1e2 / 0.3e1 * t571 * t247 + 0.5e1 / 0.3e1 * t26 * t579);
  t584 = t583 * t30;
  t588 = t251 * t111;
  t590 = t6 * t588 * t59;
  t595 = t106 * t264;
  t597 = t6 * t595 * t59;
  t600 = t6 * t256 * t134;
  t606 = 0.1e1 / t29 / t99;
  t607 = t28 * t606;
  t610 = 0.2e1 / 0.45e2 * t6 * t607 * t59;
  t612 = t6 * t265 * t134;
  t615 = t6 * t112 * t299;
  t617 = t49 * rho[0];
  t619 = 0.1e1 / t40 / t617;
  t624 = t50 * t617;
  t626 = 0.1e1 / t40 / t624;
  t633 = 0.1e1 / t40 / t287 / t617;
  t638 = t123 * t123;
  t640 = t37 * t638 * t46;
  t643 = 0.1e1 / t40 / t287 / t624;
  t644 = t128 * t128;
  t645 = 0.1e1 / t644;
  t648 = 0.1e1 / t294 / t44;
  t652 = -0.77e3 / 0.2187e4 * t37 * sigma[0] * t619 * t55 + 0.1435e4 / 0.279936e6 * t124 * t626 * t129 * t45 - 0.175e3 / 0.26873856e8 * t286 * t633 * t292 * t295 + 0.5e1 / 0.2579890176e10 * t640 * t643 * t645 * t648;
  t657 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t584 * t59 + 0.3e1 / 0.1e2 * t590 + 0.9e1 / 0.2e2 * t6 * t252 * t134 - t597 / 0.1e2 + 0.3e1 / 0.5e1 * t600 + 0.9e1 / 0.2e2 * t6 * t107 * t299 + t610 - t612 / 0.1e2 + 0.3e1 / 0.1e2 * t615 + 0.3e1 / 0.2e2 * t6 * t31 * t652);
  t659 = 0.1e1 / t70 / t68;
  t660 = t306 * t142;
  t663 = t305 * t142;
  t666 = t65 * t575;
  t669 = my_piecewise5(t15, 0, t11, 0, -0.6e1 * t243 - 0.6e1 * t666);
  t673 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t659 * t660 + 0.1e2 / 0.3e1 * t663 * t312 + 0.5e1 / 0.3e1 * t71 * t669);
  t674 = t673 * t30;
  t678 = t316 * t111;
  t680 = t6 * t678 * t94;
  t682 = t145 * t264;
  t684 = t6 * t682 * t94;
  t686 = t73 * t606;
  t689 = 0.2e1 / 0.45e2 * t6 * t686 * t94;
  t691 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t674 * t94 + 0.3e1 / 0.1e2 * t680 - t684 / 0.1e2 + t689);
  tv3rho30 = 0.3e1 * t304 + 0.3e1 * t330 + t7 * (t657 + t691);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t694 = 0.2e1 * t356;
  t695 = 0.2e1 * t382;
  t696 = t567 * t159;
  t699 = t238 * t337;
  t704 = 0.2e1 * t243;
  t705 = 0.6e1 * t576;
  t707 = my_piecewise5(t11, 0, t15, 0, t704 - t705);
  t711 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t696 * t239 + 0.2e2 / 0.9e1 * t699 * t103 + 0.1e2 / 0.9e1 * t333 * t247 + 0.5e1 / 0.3e1 * t26 * t707);
  t712 = t711 * t30;
  t716 = t341 * t111;
  t719 = t6 * t716 * t59 / 0.5e1;
  t723 = t162 * t264;
  t725 = t6 * t723 * t59;
  t729 = t6 * t346 * t134 / 0.5e1;
  t738 = 0.3e1 / 0.2e2 * t6 * t712 * t59 + t719 + 0.3e1 / 0.1e2 * t6 * t342 * t134 - t725 / 0.3e2 + t729 + 0.3e1 / 0.2e2 * t6 * t163 * t299 + t590 / 0.1e2 - t597 / 0.15e2 + t600 / 0.5e1 + t610 - t612 / 0.15e2 + t615 / 0.1e2;
  t739 = my_piecewise3(t1, 0, t738);
  t740 = t659 * t170;
  t743 = t305 * t361;
  t748 = 0.6e1 * t666;
  t750 = my_piecewise5(t15, 0, t11, 0, -t704 - t748);
  t754 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t740 * t306 + 0.2e2 / 0.9e1 * t743 * t142 + 0.1e2 / 0.9e1 * t357 * t312 + 0.5e1 / 0.3e1 * t71 * t750);
  t755 = t754 * t30;
  t759 = t365 * t111;
  t762 = t6 * t759 * t94 / 0.5e1;
  t763 = t173 * t264;
  t765 = t6 * t763 * t94;
  t774 = t6 * t321 * t196 / 0.5e1;
  t776 = t6 * t325 * t196;
  t779 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t755 * t94 + t762 - t765 / 0.3e2 + t680 / 0.1e2 - t684 / 0.15e2 + t689 + 0.3e1 / 0.2e2 * t6 * t317 * t196 + t774 - t776 / 0.3e2);
  tv3rho31 = t304 + t330 + t694 + t695 + t7 * (t739 + t779);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t782 = t567 * t387;
  t787 = t238 * t392;
  t791 = my_piecewise5(t11, 0, t15, 0, -t704 - t705);
  t795 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t782 * t103 + 0.2e2 / 0.9e1 * t333 * t337 + 0.1e2 / 0.9e1 * t787 * t103 + 0.5e1 / 0.3e1 * t26 * t791);
  t796 = t795 * t30;
  t800 = t396 * t111;
  t802 = t6 * t800 * t59;
  t811 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t796 * t59 + t802 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t397 * t134 + t719 - t725 / 0.15e2 + t729 - t597 / 0.3e2 + t610 - t612 / 0.3e2);
  t812 = t659 * t404;
  t817 = t305 * t409;
  t821 = my_piecewise5(t15, 0, t11, 0, t704 - t748);
  t825 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t812 * t142 + 0.2e2 / 0.9e1 * t357 * t361 + 0.1e2 / 0.9e1 * t817 * t142 + 0.5e1 / 0.3e1 * t71 * t821);
  t826 = t825 * t30;
  t830 = t413 * t111;
  t832 = t6 * t830 * t94;
  t839 = t6 * t370 * t196;
  t847 = t6 * t150 * t448;
  t849 = 0.3e1 / 0.2e2 * t6 * t826 * t94 + t832 / 0.1e2 + t762 - t765 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t366 * t196 + t839 / 0.5e1 - t684 / 0.3e2 + t689 + t774 - t776 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t146 * t448 + t847 / 0.1e2;
  t850 = my_piecewise3(t64, 0, t849);
  tv3rho32 = t694 + t695 + t403 + t453 + t7 * (t811 + t850);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t855 = t387 * t159;
  t862 = my_piecewise5(t11, 0, t15, 0, -0.6e1 * t243 - 0.6e1 * t576);
  t866 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t567 * t855 + 0.1e2 / 0.3e1 * t333 * t392 + 0.5e1 / 0.3e1 * t26 * t862);
  t867 = t866 * t30;
  t874 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t867 * t59 + 0.3e1 / 0.1e2 * t802 - t725 / 0.1e2 + t610);
  t875 = t404 * t170;
  t882 = my_piecewise5(t15, 0, t11, 0, 0.6e1 * t243 - 0.6e1 * t666);
  t886 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t659 * t875 + 0.1e2 / 0.3e1 * t357 * t409 + 0.5e1 / 0.3e1 * t71 * t882);
  t887 = t886 * t30;
  t902 = t84 * rho[1];
  t904 = 0.1e1 / t77 / t902;
  t909 = t85 * t902;
  t911 = 0.1e1 / t77 / t909;
  t918 = 0.1e1 / t77 / t438 / t902;
  t923 = t185 * t185;
  t925 = t37 * t923 * t81;
  t928 = 0.1e1 / t77 / t438 / t909;
  t929 = t190 * t190;
  t930 = 0.1e1 / t929;
  t935 = -0.77e3 / 0.2187e4 * t37 * sigma[2] * t904 * t90 + 0.1435e4 / 0.279936e6 * t186 * t911 * t191 * t45 - 0.175e3 / 0.26873856e8 * t437 * t918 * t443 * t295 + 0.5e1 / 0.2579890176e10 * t925 * t928 * t930 * t648;
  t940 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t887 * t94 + 0.3e1 / 0.1e2 * t832 + 0.9e1 / 0.2e2 * t6 * t414 * t196 - t765 / 0.1e2 + 0.3e1 / 0.5e1 * t839 + 0.9e1 / 0.2e2 * t6 * t174 * t448 + t689 - t776 / 0.1e2 + 0.3e1 / 0.1e2 * t847 + 0.3e1 / 0.2e2 * t6 * t74 * t935);
  tv3rho33 = 0.3e1 * t403 + 0.3e1 * t453 + t7 * (t874 + t940);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t948 = t6 * t256 * t215;
  t955 = t6 * t265 * t215 / 0.3e2;
  t957 = t6 * t112 * t479;
  t962 = t37 * t280;
  t965 = t37 * t290;
  t966 = t292 * t295;
  t967 = t966 * t470;
  t970 = t638 * sigma[0];
  t971 = t37 * t970;
  t974 = 0.1e1 / t40 / t287 / t278;
  t979 = 0.55e2 / 0.729e3 * t37 * t273 * t55 - 0.305e3 / 0.186624e6 * t962 * t467 + 0.55e2 / 0.23887872e8 * t965 * t967 - 0.5e1 / 0.6879707136e10 * t971 * t974 * t645 * t648;
  t984 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t215 + t948 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t479 - t955 + t957 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t979);
  tv3rho2sigma0 = t7 * t984 + 0.2e1 * t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t991 = t6 * t321 * t231;
  t995 = t6 * t325 * t231 / 0.3e2;
  t997 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t231 + t991 / 0.5e1 - t995);
  tv3rho2sigma2 = t7 * t997 + 0.2e1 * t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1003 = t6 * t346 * t215;
  t1011 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t215 + t1003 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t479 + t948 / 0.1e2 - t955 + t957 / 0.1e2);
  tv3rho2sigma3 = t7 * t1011 + t484 + t499;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1017 = t6 * t370 * t231;
  t1024 = t6 * t150 * t521;
  t1027 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t231 + t1017 / 0.1e2 + t991 / 0.1e2 - t995 + 0.3e1 / 0.2e2 * t6 * t146 * t521 + t1024 / 0.1e2);
  tv3rho2sigma5 = t7 * t1027 + t493 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1035 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t215 + t1003 / 0.5e1 - t955);
  tv3rho2sigma6 = t7 * t1035 + 0.2e1 * t499;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1049 = t37 * t431;
  t1052 = t37 * t441;
  t1053 = t443 * t295;
  t1054 = t1053 * t512;
  t1057 = t923 * sigma[2];
  t1058 = t37 * t1057;
  t1061 = 0.1e1 / t77 / t438 / t429;
  t1066 = 0.55e2 / 0.729e3 * t37 * t424 * t90 - 0.305e3 / 0.186624e6 * t1049 * t509 + 0.55e2 / 0.23887872e8 * t1052 * t1054 - 0.5e1 / 0.6879707136e10 * t1058 * t1061 * t930 * t648;
  t1071 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t231 + t1017 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t521 - t995 + t1024 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * t1066);
  tv3rho2sigma8 = t7 * t1071 + 0.2e1 * t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1078 = t6 * t112 * t541 / 0.1e2;
  t1081 = t37 * t474;
  t1082 = t966 * t532;
  t1088 = 0.1e1 / t40 / t287 / t125;
  t1093 = 0.5e1 / 0.11664e5 * t465 * t529 - 0.55e2 / 0.71663616e8 * t1081 * t1082 + 0.5e1 / 0.18345885696e11 * t37 * t638 * t1088 * t645 * t648;
  t1098 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t541 + t1078 + 0.3e1 / 0.2e2 * t6 * t31 * t1093);
  tv3rhosigma20 = t7 * t1098 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1105 = t6 * t150 * t559 / 0.1e2;
  t1107 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t559 + t1105);
  tv3rhosigma25 = t7 * t1107 + t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1113 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t541 + t1078);
  tv3rhosigma26 = t7 * t1113 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1120 = t37 * t516;
  t1121 = t1053 * t550;
  t1127 = 0.1e1 / t77 / t438 / t187;
  t1132 = 0.5e1 / 0.11664e5 * t507 * t547 - 0.55e2 / 0.71663616e8 * t1120 * t1121 + 0.5e1 / 0.18345885696e11 * t37 * t923 * t1127 * t930 * t648;
  t1137 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t559 + t1105 + 0.3e1 / 0.2e2 * t6 * t74 * t1132);
  tv3rhosigma211 = t7 * t1137 + t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1139 = t37 * t536;
  t1140 = t966 * t123;
  t1143 = t466 * sigma[0];
  t1148 = 0.1e1 / t40 / t287 / t208;
  t1153 = 0.5e1 / 0.21233664e8 * t1139 * t1140 - 0.5e1 / 0.62208e5 * t528 * t1143 - 0.5e1 / 0.48922361856e11 * t286 * t1148 * t645 * t648;
  t1157 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t1153);
  tv3sigma30 = t7 * t1157;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1158 = t37 * t554;
  t1159 = t1053 * t185;
  t1162 = t508 * sigma[2];
  t1167 = 0.1e1 / t77 / t438 / t224;
  t1172 = 0.5e1 / 0.21233664e8 * t1158 * t1159 - 0.5e1 / 0.62208e5 * t546 * t1162 - 0.5e1 / 0.48922361856e11 * t437 * t1167 * t930 * t648;
  t1176 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t1172);
  tv3sigma39 = t7 * t1176;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t39, t40;
  double t42, t44, t45, t46, t47, t49, t50, t54;
  double t55, t59, t63, t64, t65, t67, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t79;
  double t81, t82, t84, t85, t89, t90, t94, t98;
  double tzk0;

  double t99, t100, t101, t103, t106, t107, t111, t112;
  double t115, t116, t118, t123, t124, t125, t127, t128;
  double t129, t134, t139, t140, t142, t145, t146, t150;
  double t153, t155, tvrho0, t159, t162, t163, t168, t170;
  double t173, t174, t178, t180, t185, t186, t187, t189;
  double t190, t191, t196, t201, tvrho1, t208, t210, t212;
  double t215, t219, tvsigma0, tvsigma1, t224, t226, t228, t231;
  double t235, tvsigma2;

  double t238, t239, t242, t243, t244, t247, t251, t252;
  double t256, t258, t264, t265, t268, t270, t273, t278;
  double t280, t285, t286, t287, t290, t292, t294, t295;
  double t299, t304, t305, t306, t309, t312, t316, t317;
  double t321, t323, t325, t328, t330, tv2rho20, t333, t337;
  double t341, t342, t346, t348, t356, t357, t361, t365;
  double t366, t370, t372, t379, t382, tv2rho21, t387, t392;
  double t396, t397, t403, t404, t409, t413, t414, t424;
  double t429, t431, t436, t437, t438, t441, t443, t448;
  double t453, tv2rho22, t461, t465, t466, t467, t470, t474;
  double t479, t484, tv2rhosigma0, tv2rhosigma1, t491, t493, tv2rhosigma2, t499;
  double tv2rhosigma3, tv2rhosigma4, t507, t508, t509, t512, t516, t521;
  double t526, tv2rhosigma5, t528, t529, t532, t536, t541, t545;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t546, t547, t550;
  double t554, t559, t563, tv2sigma25;

  double t567, t568, t571, t574, t575, t576, t579, t583;
  double t584, t588, t590, t595, t597, t600, t606, t607;
  double t610, t612, t615, t617, t619, t624, t626, t633;
  double t638, t640, t643, t644, t645, t648, t652, t657;
  double t659, t660, t663, t666, t669, t673, t674, t678;
  double t680, t682, t684, t686, t689, t691, tv3rho30, t694;
  double t695, t696, t699, t704, t705, t707, t711, t712;
  double t716, t719, t723, t725, t729, t738, t739, t740;
  double t743, t748, t750, t754, t755, t759, t762, t763;
  double t765, t774, t776, t779, tv3rho31, t782, t787, t791;
  double t795, t796, t800, t802, t811, t812, t817, t821;
  double t825, t826, t830, t832, t839, t847, t849, t850;
  double tv3rho32, t855, t862, t866, t867, t874, t875, t882;
  double t886, t887, t902, t904, t909, t911, t918, t923;
  double t925, t928, t929, t930, t935, t940, tv3rho33, t948;
  double t955, t957, t962, t965, t966, t967, t970, t971;
  double t974, t979, t984, tv3rho2sigma0, tv3rho2sigma1, t991, t995, t997;
  double tv3rho2sigma2, t1003, t1011, tv3rho2sigma3, tv3rho2sigma4, t1017, t1024, t1027;
  double tv3rho2sigma5, t1035, tv3rho2sigma6, tv3rho2sigma7, t1049, t1052, t1053, t1054;
  double t1057, t1058, t1061, t1066, t1071, tv3rho2sigma8, t1078, t1081;
  double t1082, t1088, t1093, t1098, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1105, t1107, tv3rhosigma25, t1113, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1120, t1121, t1127, t1132, t1137, tv3rhosigma211;
  double t1139, t1140, t1143, t1148, t1153, t1157, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1158;
  double t1159, t1162, t1167, t1172, t1176, tv3sigma39;

  double t1179, t1181, t1182, t1188, t1194, t1195, t1198, t1202;
  double t1211, t1217, t1220, t1226, t1229, t1232, t1234, t1241;
  double t1264, t1269, t1271, t1272, t1282, t1286, t1290, t1293;
  double t1297, t1298, t1299, t1300, t1302, t1303, t1309, t1314;
  double t1317, t1321, t1328, t1332, t1336, t1341, t1343, tv4rho40;
  double t1364, t1365, t1367, t1371, t1380, t1386, t1387, t1389;
  double t1402, t1403, t1406, t1410, t1415, t1416, t1433, t1435;
  double t1439, t1446, t1450, t1451, t1454, t1463, t1466, t1467;
  double t1469, t1471, t1472, tv4rho41, t1487, t1500, t1504, t1513;
  double t1526, t1530, t1537, t1538, t1547, t1560, t1564, t1571;
  double t1575, t1584, t1587, t1598, t1601, t1603, t1604, tv4rho42;
  double t1625, t1629, t1636, t1647, t1648, t1665, t1669, t1676;
  double t1684, t1693, t1703, t1705, t1706, tv4rho43, t1711, t1716;
  double t1723, t1727, t1736, t1737, t1744, t1767, t1772, t1781;
  double t1786, t1793, t1797, t1820, t1821, tv4rho44, t1829, t1835;
  double t1838, t1845, t1847, t1850, t1862, t1880, tv4rho3sigma0, tv4rho3sigma1;
  double t1887, t1890, t1894, t1896, tv4rho3sigma2, t1898, t1904, t1909;
  double t1913, t1922, t1923, tv4rho3sigma3, tv4rho3sigma4, t1925, t1931, t1933;
  double t1942, t1944, t1947, tv4rho3sigma5, t1953, t1962, tv4rho3sigma6, tv4rho3sigma7;
  double t1968, t1975, t1983, t1985, t1986, tv4rho3sigma8, t1995, tv4rho3sigma9;
  double tv4rho3sigma10, t2022, t2040, tv4rho3sigma11, t2047, t2054, t2056, t2080;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2087, t2091, t2093;
  double tv4rho2sigma25, t2099, t2107, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210;
  double t2113, t2120, t2123, tv4rho2sigma211, t2131, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214;
  double tv4rho2sigma215, tv4rho2sigma216, t2164, tv4rho2sigma217, t2171, t2192, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2199;
  double t2201, tv4rhosigma39, t2207, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2232, tv4rhosigma319, t2254, tv4sigma40;
  double tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48;
  double tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t2275, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = M_PI * M_PI;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t37 = t32 / t35;
  t38 = rho[0] * rho[0];
  t39 = POW_1_3(rho[0]);
  t40 = t39 * t39;
  t42 = 0.1e1 / t40 / t38;
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t46 = sigma[0] * sigma[0];
  t47 = t46 * sigma[0];
  t49 = t38 * t38;
  t50 = t49 * t49;
  t54 = 0.1e1 + t45 * t47 / t50 / 0.2304e4;
  t55 = 0.1e1 / t54;
  t59 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[0] * t42 * t55;
  t63 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t59);
  t64 = rho[1] <= p->dens_threshold;
  t65 = -t17;
  t67 = my_piecewise5(t15, t12, t11, t16, t65 * t8);
  t68 = 0.1e1 + t67;
  t69 = t68 <= p->zeta_threshold;
  t70 = POW_1_3(t68);
  t71 = t70 * t70;
  t73 = my_piecewise3(t69, t24, t71 * t68);
  t74 = t73 * t30;
  t75 = rho[1] * rho[1];
  t76 = POW_1_3(rho[1]);
  t77 = t76 * t76;
  t79 = 0.1e1 / t77 / t75;
  t81 = sigma[2] * sigma[2];
  t82 = t81 * sigma[2];
  t84 = t75 * t75;
  t85 = t84 * t84;
  t89 = 0.1e1 + t45 * t82 / t85 / 0.2304e4;
  t90 = 0.1e1 / t89;
  t94 = 0.1e1 + 0.5e1 / 0.648e3 * t37 * sigma[2] * t79 * t90;
  t98 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t94);
  tzk0 = t63 + t98;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t99 = t7 * t7;
  t100 = 0.1e1 / t99;
  t101 = t17 * t100;
  t103 = my_piecewise5(t11, 0, t15, 0, t8 - t101);
  t106 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t103);
  t107 = t106 * t30;
  t111 = 0.1e1 / t29;
  t112 = t28 * t111;
  t115 = t6 * t112 * t59 / 0.1e2;
  t116 = t38 * rho[0];
  t118 = 0.1e1 / t40 / t116;
  t123 = t46 * t46;
  t124 = t37 * t123;
  t125 = t50 * t116;
  t127 = 0.1e1 / t40 / t125;
  t128 = t54 * t54;
  t129 = 0.1e1 / t128;
  t134 = -0.5e1 / 0.243e3 * t37 * sigma[0] * t118 * t55 + 0.5e1 / 0.186624e6 * t124 * t127 * t129 * t45;
  t139 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t59 + t115 + 0.3e1 / 0.2e2 * t6 * t31 * t134);
  t140 = t65 * t100;
  t142 = my_piecewise5(t15, 0, t11, 0, -t8 - t140);
  t145 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t142);
  t146 = t145 * t30;
  t150 = t73 * t111;
  t153 = t6 * t150 * t94 / 0.1e2;
  t155 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t94 + t153);
  tvrho0 = t63 + t98 + t7 * (t139 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t159 = my_piecewise5(t11, 0, t15, 0, -t8 - t101);
  t162 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t159);
  t163 = t162 * t30;
  t168 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t59 + t115);
  t170 = my_piecewise5(t15, 0, t11, 0, t8 - t140);
  t173 = my_piecewise3(t69, 0, 0.5e1 / 0.3e1 * t71 * t170);
  t174 = t173 * t30;
  t178 = t75 * rho[1];
  t180 = 0.1e1 / t77 / t178;
  t185 = t81 * t81;
  t186 = t37 * t185;
  t187 = t85 * t178;
  t189 = 0.1e1 / t77 / t187;
  t190 = t89 * t89;
  t191 = 0.1e1 / t190;
  t196 = -0.5e1 / 0.243e3 * t37 * sigma[2] * t180 * t90 + 0.5e1 / 0.186624e6 * t186 * t189 * t191 * t45;
  t201 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t94 + t153 + 0.3e1 / 0.2e2 * t6 * t74 * t196);
  tvrho1 = t63 + t98 + t7 * (t168 + t201);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t208 = t50 * t38;
  t210 = 0.1e1 / t40 / t208;
  t212 = t210 * t129 * t45;
  t215 = 0.5e1 / 0.648e3 * t37 * t42 * t55 - 0.5e1 / 0.497664e6 * t37 * t47 * t212;
  t219 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t215);
  tvsigma0 = t7 * t219;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t224 = t85 * t75;
  t226 = 0.1e1 / t77 / t224;
  t228 = t226 * t191 * t45;
  t231 = 0.5e1 / 0.648e3 * t37 * t79 * t90 - 0.5e1 / 0.497664e6 * t37 * t82 * t228;
  t235 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t231);
  tvsigma2 = t7 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t238 = 0.1e1 / t25;
  t239 = t103 * t103;
  t242 = t99 * t7;
  t243 = 0.1e1 / t242;
  t244 = t17 * t243;
  t247 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t100 + 0.2e1 * t244);
  t251 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t239 + 0.5e1 / 0.3e1 * t26 * t247);
  t252 = t251 * t30;
  t256 = t106 * t111;
  t258 = t6 * t256 * t59;
  t264 = 0.1e1 / t29 / t7;
  t265 = t28 * t264;
  t268 = t6 * t265 * t59 / 0.3e2;
  t270 = t6 * t112 * t134;
  t273 = 0.1e1 / t40 / t49;
  t278 = t50 * t49;
  t280 = 0.1e1 / t40 / t278;
  t285 = t123 * t47;
  t286 = t37 * t285;
  t287 = t50 * t50;
  t290 = 0.1e1 / t40 / t287 / t49;
  t292 = 0.1e1 / t128 / t54;
  t294 = t44 * t44;
  t295 = 0.1e1 / t294;
  t299 = 0.55e2 / 0.729e3 * t37 * sigma[0] * t273 * t55 - 0.215e3 / 0.559872e6 * t124 * t280 * t129 * t45 + 0.5e1 / 0.26873856e8 * t286 * t290 * t292 * t295;
  t304 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t59 + t258 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t134 - t268 + t270 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t299);
  t305 = 0.1e1 / t70;
  t306 = t142 * t142;
  t309 = t65 * t243;
  t312 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t100 + 0.2e1 * t309);
  t316 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t306 + 0.5e1 / 0.3e1 * t71 * t312);
  t317 = t316 * t30;
  t321 = t145 * t111;
  t323 = t6 * t321 * t94;
  t325 = t73 * t264;
  t328 = t6 * t325 * t94 / 0.3e2;
  t330 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t94 + t323 / 0.5e1 - t328);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t155 + t7 * (t304 + t330);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t333 = t238 * t159;
  t337 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t244);
  t341 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t333 * t103 + 0.5e1 / 0.3e1 * t26 * t337);
  t342 = t341 * t30;
  t346 = t162 * t111;
  t348 = t6 * t346 * t59;
  t356 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t59 + t348 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t134 + t258 / 0.1e2 - t268 + t270 / 0.1e2);
  t357 = t305 * t170;
  t361 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t309);
  t365 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t357 * t142 + 0.5e1 / 0.3e1 * t71 * t361);
  t366 = t365 * t30;
  t370 = t173 * t111;
  t372 = t6 * t370 * t94;
  t379 = t6 * t150 * t196;
  t382 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t94 + t372 / 0.1e2 + t323 / 0.1e2 - t328 + 0.3e1 / 0.2e2 * t6 * t146 * t196 + t379 / 0.1e2);
  tv2rho21 = t139 + t155 + t168 + t201 + t7 * (t356 + t382);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t387 = t159 * t159;
  t392 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t100 + 0.2e1 * t244);
  t396 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t238 * t387 + 0.5e1 / 0.3e1 * t26 * t392);
  t397 = t396 * t30;
  t403 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t59 + t348 / 0.5e1 - t268);
  t404 = t170 * t170;
  t409 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t100 + 0.2e1 * t309);
  t413 = my_piecewise3(t69, 0, 0.1e2 / 0.9e1 * t305 * t404 + 0.5e1 / 0.3e1 * t71 * t409);
  t414 = t413 * t30;
  t424 = 0.1e1 / t77 / t84;
  t429 = t85 * t84;
  t431 = 0.1e1 / t77 / t429;
  t436 = t185 * t82;
  t437 = t37 * t436;
  t438 = t85 * t85;
  t441 = 0.1e1 / t77 / t438 / t84;
  t443 = 0.1e1 / t190 / t89;
  t448 = 0.55e2 / 0.729e3 * t37 * sigma[2] * t424 * t90 - 0.215e3 / 0.559872e6 * t186 * t431 * t191 * t45 + 0.5e1 / 0.26873856e8 * t437 * t441 * t443 * t295;
  t453 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t94 + t372 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t196 - t328 + t379 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * t448);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t201 + t7 * (t403 + t453);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t461 = t6 * t112 * t215 / 0.1e2;
  t465 = t37 * t127;
  t466 = t129 * t45;
  t467 = t466 * t47;
  t470 = t123 * t46;
  t474 = 0.1e1 / t40 / t287 / t116;
  t479 = -0.5e1 / 0.243e3 * t37 * t118 * t55 + 0.25e2 / 0.186624e6 * t465 * t467 - 0.5e1 / 0.71663616e8 * t37 * t470 * t474 * t292 * t295;
  t484 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t215 + t461 + 0.3e1 / 0.2e2 * t6 * t31 * t479);
  tv2rhosigma0 = t7 * t484 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t491 = t6 * t150 * t231 / 0.1e2;
  t493 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t231 + t491);
  tv2rhosigma2 = t7 * t493 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t499 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t215 + t461);
  tv2rhosigma3 = t7 * t499 + t219;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t507 = t37 * t189;
  t508 = t191 * t45;
  t509 = t508 * t82;
  t512 = t185 * t81;
  t516 = 0.1e1 / t77 / t438 / t178;
  t521 = -0.5e1 / 0.243e3 * t37 * t180 * t90 + 0.25e2 / 0.186624e6 * t507 * t509 - 0.5e1 / 0.71663616e8 * t37 * t512 * t516 * t443 * t295;
  t526 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t231 + t491 + 0.3e1 / 0.2e2 * t6 * t74 * t521);
  tv2rhosigma5 = t7 * t526 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t528 = t37 * t210;
  t529 = t466 * t46;
  t532 = t123 * sigma[0];
  t536 = 0.1e1 / t40 / t287 / t38;
  t541 = -0.5e1 / 0.124416e6 * t528 * t529 + 0.5e1 / 0.191102976e9 * t37 * t532 * t536 * t292 * t295;
  t545 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t541);
  tv2sigma20 = t7 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = t37 * t226;
  t547 = t508 * t81;
  t550 = t185 * sigma[2];
  t554 = 0.1e1 / t77 / t438 / t75;
  t559 = -0.5e1 / 0.124416e6 * t546 * t547 + 0.5e1 / 0.191102976e9 * t37 * t550 * t554 * t443 * t295;
  t563 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t559);
  tv2sigma25 = t7 * t563;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t567 = 0.1e1 / t25 / t20;
  t568 = t239 * t103;
  t571 = t238 * t103;
  t574 = t99 * t99;
  t575 = 0.1e1 / t574;
  t576 = t17 * t575;
  t579 = my_piecewise5(t11, 0, t15, 0, 0.6e1 * t243 - 0.6e1 * t576);
  t583 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t567 * t568 + 0.1e2 / 0.3e1 * t571 * t247 + 0.5e1 / 0.3e1 * t26 * t579);
  t584 = t583 * t30;
  t588 = t251 * t111;
  t590 = t6 * t588 * t59;
  t595 = t106 * t264;
  t597 = t6 * t595 * t59;
  t600 = t6 * t256 * t134;
  t606 = 0.1e1 / t29 / t99;
  t607 = t28 * t606;
  t610 = 0.2e1 / 0.45e2 * t6 * t607 * t59;
  t612 = t6 * t265 * t134;
  t615 = t6 * t112 * t299;
  t617 = t49 * rho[0];
  t619 = 0.1e1 / t40 / t617;
  t624 = t50 * t617;
  t626 = 0.1e1 / t40 / t624;
  t633 = 0.1e1 / t40 / t287 / t617;
  t638 = t123 * t123;
  t640 = t37 * t638 * t46;
  t643 = 0.1e1 / t40 / t287 / t624;
  t644 = t128 * t128;
  t645 = 0.1e1 / t644;
  t648 = 0.1e1 / t294 / t44;
  t652 = -0.77e3 / 0.2187e4 * t37 * sigma[0] * t619 * t55 + 0.1435e4 / 0.279936e6 * t124 * t626 * t129 * t45 - 0.175e3 / 0.26873856e8 * t286 * t633 * t292 * t295 + 0.5e1 / 0.2579890176e10 * t640 * t643 * t645 * t648;
  t657 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t584 * t59 + 0.3e1 / 0.1e2 * t590 + 0.9e1 / 0.2e2 * t6 * t252 * t134 - t597 / 0.1e2 + 0.3e1 / 0.5e1 * t600 + 0.9e1 / 0.2e2 * t6 * t107 * t299 + t610 - t612 / 0.1e2 + 0.3e1 / 0.1e2 * t615 + 0.3e1 / 0.2e2 * t6 * t31 * t652);
  t659 = 0.1e1 / t70 / t68;
  t660 = t306 * t142;
  t663 = t305 * t142;
  t666 = t65 * t575;
  t669 = my_piecewise5(t15, 0, t11, 0, -0.6e1 * t243 - 0.6e1 * t666);
  t673 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t659 * t660 + 0.1e2 / 0.3e1 * t663 * t312 + 0.5e1 / 0.3e1 * t71 * t669);
  t674 = t673 * t30;
  t678 = t316 * t111;
  t680 = t6 * t678 * t94;
  t682 = t145 * t264;
  t684 = t6 * t682 * t94;
  t686 = t73 * t606;
  t689 = 0.2e1 / 0.45e2 * t6 * t686 * t94;
  t691 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t674 * t94 + 0.3e1 / 0.1e2 * t680 - t684 / 0.1e2 + t689);
  tv3rho30 = 0.3e1 * t304 + 0.3e1 * t330 + t7 * (t657 + t691);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t694 = 0.2e1 * t356;
  t695 = 0.2e1 * t382;
  t696 = t567 * t159;
  t699 = t238 * t337;
  t704 = 0.2e1 * t243;
  t705 = 0.6e1 * t576;
  t707 = my_piecewise5(t11, 0, t15, 0, t704 - t705);
  t711 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t696 * t239 + 0.2e2 / 0.9e1 * t699 * t103 + 0.1e2 / 0.9e1 * t333 * t247 + 0.5e1 / 0.3e1 * t26 * t707);
  t712 = t711 * t30;
  t716 = t341 * t111;
  t719 = t6 * t716 * t59 / 0.5e1;
  t723 = t162 * t264;
  t725 = t6 * t723 * t59;
  t729 = t6 * t346 * t134 / 0.5e1;
  t738 = 0.3e1 / 0.2e2 * t6 * t712 * t59 + t719 + 0.3e1 / 0.1e2 * t6 * t342 * t134 - t725 / 0.3e2 + t729 + 0.3e1 / 0.2e2 * t6 * t163 * t299 + t590 / 0.1e2 - t597 / 0.15e2 + t600 / 0.5e1 + t610 - t612 / 0.15e2 + t615 / 0.1e2;
  t739 = my_piecewise3(t1, 0, t738);
  t740 = t659 * t170;
  t743 = t305 * t361;
  t748 = 0.6e1 * t666;
  t750 = my_piecewise5(t15, 0, t11, 0, -t704 - t748);
  t754 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t740 * t306 + 0.2e2 / 0.9e1 * t743 * t142 + 0.1e2 / 0.9e1 * t357 * t312 + 0.5e1 / 0.3e1 * t71 * t750);
  t755 = t754 * t30;
  t759 = t365 * t111;
  t762 = t6 * t759 * t94 / 0.5e1;
  t763 = t173 * t264;
  t765 = t6 * t763 * t94;
  t774 = t6 * t321 * t196 / 0.5e1;
  t776 = t6 * t325 * t196;
  t779 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t755 * t94 + t762 - t765 / 0.3e2 + t680 / 0.1e2 - t684 / 0.15e2 + t689 + 0.3e1 / 0.2e2 * t6 * t317 * t196 + t774 - t776 / 0.3e2);
  tv3rho31 = t304 + t330 + t694 + t695 + t7 * (t739 + t779);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t782 = t567 * t387;
  t787 = t238 * t392;
  t791 = my_piecewise5(t11, 0, t15, 0, -t704 - t705);
  t795 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t782 * t103 + 0.2e2 / 0.9e1 * t333 * t337 + 0.1e2 / 0.9e1 * t787 * t103 + 0.5e1 / 0.3e1 * t26 * t791);
  t796 = t795 * t30;
  t800 = t396 * t111;
  t802 = t6 * t800 * t59;
  t811 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t796 * t59 + t802 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t397 * t134 + t719 - t725 / 0.15e2 + t729 - t597 / 0.3e2 + t610 - t612 / 0.3e2);
  t812 = t659 * t404;
  t817 = t305 * t409;
  t821 = my_piecewise5(t15, 0, t11, 0, t704 - t748);
  t825 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t812 * t142 + 0.2e2 / 0.9e1 * t357 * t361 + 0.1e2 / 0.9e1 * t817 * t142 + 0.5e1 / 0.3e1 * t71 * t821);
  t826 = t825 * t30;
  t830 = t413 * t111;
  t832 = t6 * t830 * t94;
  t839 = t6 * t370 * t196;
  t847 = t6 * t150 * t448;
  t849 = 0.3e1 / 0.2e2 * t6 * t826 * t94 + t832 / 0.1e2 + t762 - t765 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t366 * t196 + t839 / 0.5e1 - t684 / 0.3e2 + t689 + t774 - t776 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t146 * t448 + t847 / 0.1e2;
  t850 = my_piecewise3(t64, 0, t849);
  tv3rho32 = t694 + t695 + t403 + t453 + t7 * (t811 + t850);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t855 = t387 * t159;
  t862 = my_piecewise5(t11, 0, t15, 0, -0.6e1 * t243 - 0.6e1 * t576);
  t866 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t567 * t855 + 0.1e2 / 0.3e1 * t333 * t392 + 0.5e1 / 0.3e1 * t26 * t862);
  t867 = t866 * t30;
  t874 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t867 * t59 + 0.3e1 / 0.1e2 * t802 - t725 / 0.1e2 + t610);
  t875 = t404 * t170;
  t882 = my_piecewise5(t15, 0, t11, 0, 0.6e1 * t243 - 0.6e1 * t666);
  t886 = my_piecewise3(t69, 0, -0.1e2 / 0.27e2 * t659 * t875 + 0.1e2 / 0.3e1 * t357 * t409 + 0.5e1 / 0.3e1 * t71 * t882);
  t887 = t886 * t30;
  t902 = t84 * rho[1];
  t904 = 0.1e1 / t77 / t902;
  t909 = t85 * t902;
  t911 = 0.1e1 / t77 / t909;
  t918 = 0.1e1 / t77 / t438 / t902;
  t923 = t185 * t185;
  t925 = t37 * t923 * t81;
  t928 = 0.1e1 / t77 / t438 / t909;
  t929 = t190 * t190;
  t930 = 0.1e1 / t929;
  t935 = -0.77e3 / 0.2187e4 * t37 * sigma[2] * t904 * t90 + 0.1435e4 / 0.279936e6 * t186 * t911 * t191 * t45 - 0.175e3 / 0.26873856e8 * t437 * t918 * t443 * t295 + 0.5e1 / 0.2579890176e10 * t925 * t928 * t930 * t648;
  t940 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t887 * t94 + 0.3e1 / 0.1e2 * t832 + 0.9e1 / 0.2e2 * t6 * t414 * t196 - t765 / 0.1e2 + 0.3e1 / 0.5e1 * t839 + 0.9e1 / 0.2e2 * t6 * t174 * t448 + t689 - t776 / 0.1e2 + 0.3e1 / 0.1e2 * t847 + 0.3e1 / 0.2e2 * t6 * t74 * t935);
  tv3rho33 = 0.3e1 * t403 + 0.3e1 * t453 + t7 * (t874 + t940);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t948 = t6 * t256 * t215;
  t955 = t6 * t265 * t215 / 0.3e2;
  t957 = t6 * t112 * t479;
  t962 = t37 * t280;
  t965 = t37 * t290;
  t966 = t292 * t295;
  t967 = t966 * t470;
  t970 = t638 * sigma[0];
  t971 = t37 * t970;
  t974 = 0.1e1 / t40 / t287 / t278;
  t979 = 0.55e2 / 0.729e3 * t37 * t273 * t55 - 0.305e3 / 0.186624e6 * t962 * t467 + 0.55e2 / 0.23887872e8 * t965 * t967 - 0.5e1 / 0.6879707136e10 * t971 * t974 * t645 * t648;
  t984 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t215 + t948 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t479 - t955 + t957 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t979);
  tv3rho2sigma0 = t7 * t984 + 0.2e1 * t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t991 = t6 * t321 * t231;
  t995 = t6 * t325 * t231 / 0.3e2;
  t997 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t231 + t991 / 0.5e1 - t995);
  tv3rho2sigma2 = t7 * t997 + 0.2e1 * t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1003 = t6 * t346 * t215;
  t1011 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t215 + t1003 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t479 + t948 / 0.1e2 - t955 + t957 / 0.1e2);
  tv3rho2sigma3 = t7 * t1011 + t484 + t499;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1017 = t6 * t370 * t231;
  t1024 = t6 * t150 * t521;
  t1027 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t231 + t1017 / 0.1e2 + t991 / 0.1e2 - t995 + 0.3e1 / 0.2e2 * t6 * t146 * t521 + t1024 / 0.1e2);
  tv3rho2sigma5 = t7 * t1027 + t493 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1035 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t215 + t1003 / 0.5e1 - t955);
  tv3rho2sigma6 = t7 * t1035 + 0.2e1 * t499;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1049 = t37 * t431;
  t1052 = t37 * t441;
  t1053 = t443 * t295;
  t1054 = t1053 * t512;
  t1057 = t923 * sigma[2];
  t1058 = t37 * t1057;
  t1061 = 0.1e1 / t77 / t438 / t429;
  t1066 = 0.55e2 / 0.729e3 * t37 * t424 * t90 - 0.305e3 / 0.186624e6 * t1049 * t509 + 0.55e2 / 0.23887872e8 * t1052 * t1054 - 0.5e1 / 0.6879707136e10 * t1058 * t1061 * t930 * t648;
  t1071 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t231 + t1017 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t521 - t995 + t1024 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * t1066);
  tv3rho2sigma8 = t7 * t1071 + 0.2e1 * t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1078 = t6 * t112 * t541 / 0.1e2;
  t1081 = t37 * t474;
  t1082 = t966 * t532;
  t1088 = 0.1e1 / t40 / t287 / t125;
  t1093 = 0.5e1 / 0.11664e5 * t465 * t529 - 0.55e2 / 0.71663616e8 * t1081 * t1082 + 0.5e1 / 0.18345885696e11 * t37 * t638 * t1088 * t645 * t648;
  t1098 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t541 + t1078 + 0.3e1 / 0.2e2 * t6 * t31 * t1093);
  tv3rhosigma20 = t7 * t1098 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1105 = t6 * t150 * t559 / 0.1e2;
  t1107 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t559 + t1105);
  tv3rhosigma25 = t7 * t1107 + t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1113 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t541 + t1078);
  tv3rhosigma26 = t7 * t1113 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1120 = t37 * t516;
  t1121 = t1053 * t550;
  t1127 = 0.1e1 / t77 / t438 / t187;
  t1132 = 0.5e1 / 0.11664e5 * t507 * t547 - 0.55e2 / 0.71663616e8 * t1120 * t1121 + 0.5e1 / 0.18345885696e11 * t37 * t923 * t1127 * t930 * t648;
  t1137 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t559 + t1105 + 0.3e1 / 0.2e2 * t6 * t74 * t1132);
  tv3rhosigma211 = t7 * t1137 + t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1139 = t37 * t536;
  t1140 = t966 * t123;
  t1143 = t466 * sigma[0];
  t1148 = 0.1e1 / t40 / t287 / t208;
  t1153 = 0.5e1 / 0.21233664e8 * t1139 * t1140 - 0.5e1 / 0.62208e5 * t528 * t1143 - 0.5e1 / 0.48922361856e11 * t286 * t1148 * t645 * t648;
  t1157 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t1153);
  tv3sigma30 = t7 * t1157;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1158 = t37 * t554;
  t1159 = t1053 * t185;
  t1162 = t508 * sigma[2];
  t1167 = 0.1e1 / t77 / t438 / t224;
  t1172 = 0.5e1 / 0.21233664e8 * t1158 * t1159 - 0.5e1 / 0.62208e5 * t546 * t1162 - 0.5e1 / 0.48922361856e11 * t437 * t1167 * t930 * t648;
  t1176 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * t1172);
  tv3sigma39 = t7 * t1176;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1179 = t20 * t20;
  t1181 = 0.1e1 / t25 / t1179;
  t1182 = t239 * t239;
  t1188 = t247 * t247;
  t1194 = 0.1e1 / t574 / t7;
  t1195 = t17 * t1194;
  t1198 = my_piecewise5(t11, 0, t15, 0, -0.24e2 * t575 + 0.24e2 * t1195);
  t1202 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1181 * t1182 - 0.2e2 / 0.9e1 * t567 * t239 * t247 + 0.1e2 / 0.3e1 * t238 * t1188 + 0.4e2 / 0.9e1 * t571 * t579 + 0.5e1 / 0.3e1 * t26 * t1198);
  t1211 = t6 * t588 * t134;
  t1217 = t6 * t595 * t134;
  t1220 = t6 * t256 * t299;
  t1226 = t6 * t607 * t134;
  t1229 = t6 * t265 * t299;
  t1232 = t6 * t112 * t652;
  t1234 = t49 * t38;
  t1241 = t50 * t1234;
  t1264 = t287 * t287;
  t1269 = 0.1e1 / t644 / t54;
  t1271 = t294 * t294;
  t1272 = 0.1e1 / t1271;
  t1282 = t6 * t583 * t111 * t59;
  t1286 = t6 * t251 * t264 * t59;
  t1290 = t6 * t106 * t606 * t59;
  t1293 = 0.1e1 / t29 / t242;
  t1297 = 0.14e2 / 0.135e3 * t6 * t28 * t1293 * t59;
  t1298 = 0.3e1 / 0.2e2 * t6 * t1202 * t30 * t59 + 0.3e1 / 0.5e1 * t6 * t584 * t134 + 0.6e1 / 0.5e1 * t1211 + 0.9e1 / 0.1e2 * t6 * t252 * t299 - 0.2e1 / 0.5e1 * t1217 + 0.6e1 / 0.5e1 * t1220 + 0.3e1 / 0.5e1 * t6 * t107 * t652 + 0.8e1 / 0.45e2 * t1226 - t1229 / 0.5e1 + 0.2e1 / 0.5e1 * t1232 + 0.3e1 / 0.2e2 * t6 * t31 * (0.1309e5 / 0.6561e4 * t37 * sigma[0] / t40 / t1234 * t55 - 0.179585e6 / 0.2519424e7 * t124 / t40 / t1241 * t129 * t45 + 0.14245e5 / 0.80621568e8 * t286 / t40 / t287 / t1234 * t292 * t295 - 0.485e3 / 0.3869835264e10 * t640 / t40 / t287 / t1241 * t645 * t648 + 0.5e1 / 0.185752092672e12 * t37 * t638 * t532 / t40 / t1264 / t1234 * t1269 * t1272) + 0.2e1 / 0.5e1 * t1282 - t1286 / 0.5e1 + 0.8e1 / 0.45e2 * t1290 - t1297;
  t1299 = my_piecewise3(t1, 0, t1298);
  t1300 = t68 * t68;
  t1302 = 0.1e1 / t70 / t1300;
  t1303 = t306 * t306;
  t1309 = t312 * t312;
  t1314 = t65 * t1194;
  t1317 = my_piecewise5(t15, 0, t11, 0, 0.24e2 * t575 + 0.24e2 * t1314);
  t1321 = my_piecewise3(t69, 0, 0.4e2 / 0.81e2 * t1302 * t1303 - 0.2e2 / 0.9e1 * t659 * t306 * t312 + 0.1e2 / 0.3e1 * t305 * t1309 + 0.4e2 / 0.9e1 * t663 * t669 + 0.5e1 / 0.3e1 * t71 * t1317);
  t1328 = t6 * t673 * t111 * t94;
  t1332 = t6 * t316 * t264 * t94;
  t1336 = t6 * t145 * t606 * t94;
  t1341 = 0.14e2 / 0.135e3 * t6 * t73 * t1293 * t94;
  t1343 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t1321 * t30 * t94 + 0.2e1 / 0.5e1 * t1328 - t1332 / 0.5e1 + 0.8e1 / 0.45e2 * t1336 - t1341);
  tv4rho40 = 0.4e1 * t657 + 0.4e1 * t691 + t7 * (t1299 + t1343);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1364 = 0.12e2 * t575;
  t1365 = 0.24e2 * t1195;
  t1367 = my_piecewise5(t11, 0, t15, 0, -t1364 + t1365);
  t1371 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1181 * t159 * t568 - 0.1e2 / 0.9e1 * t567 * t337 * t239 - 0.1e2 / 0.9e1 * t696 * t103 * t247 + 0.1e2 / 0.3e1 * t238 * t707 * t103 + 0.1e2 / 0.3e1 * t699 * t247 + 0.1e2 / 0.9e1 * t333 * t579 + 0.5e1 / 0.3e1 * t26 * t1367);
  t1380 = t6 * t716 * t134;
  t1386 = t6 * t723 * t134;
  t1387 = t1386 / 0.1e2;
  t1389 = t6 * t346 * t299;
  t1402 = t6 * t341 * t264 * t59;
  t1403 = t1402 / 0.1e2;
  t1406 = t6 * t162 * t606 * t59;
  t1410 = t6 * t711 * t111 * t59;
  t1415 = 0.3e1 / 0.2e2 * t6 * t1371 * t30 * t59 + 0.9e1 / 0.2e2 * t6 * t712 * t134 + 0.3e1 / 0.5e1 * t1380 + 0.9e1 / 0.2e2 * t6 * t342 * t299 - t1387 + 0.3e1 / 0.1e2 * t1389 + 0.3e1 / 0.2e2 * t6 * t163 * t652 + 0.3e1 / 0.1e2 * t1211 - t1217 / 0.5e1 + 0.3e1 / 0.1e2 * t1220 + 0.2e1 / 0.15e2 * t1226 - t1229 / 0.1e2 + t1232 / 0.1e2 - t1403 + 0.2e1 / 0.45e2 * t1406 + 0.3e1 / 0.1e2 * t1410 + t1282 / 0.1e2 - t1286 / 0.1e2 + 0.2e1 / 0.15e2 * t1290 - t1297;
  t1416 = my_piecewise3(t1, 0, t1415);
  t1433 = 0.24e2 * t1314;
  t1435 = my_piecewise5(t15, 0, t11, 0, t1364 + t1433);
  t1439 = my_piecewise3(t69, 0, 0.4e2 / 0.81e2 * t1302 * t170 * t660 - 0.1e2 / 0.9e1 * t659 * t361 * t306 - 0.1e2 / 0.9e1 * t740 * t142 * t312 + 0.1e2 / 0.3e1 * t305 * t750 * t142 + 0.1e2 / 0.3e1 * t743 * t312 + 0.1e2 / 0.9e1 * t357 * t669 + 0.5e1 / 0.3e1 * t71 * t1435);
  t1446 = t6 * t754 * t111 * t94;
  t1450 = t6 * t365 * t264 * t94;
  t1451 = t1450 / 0.1e2;
  t1454 = t6 * t173 * t606 * t94;
  t1463 = t6 * t678 * t196;
  t1466 = t6 * t682 * t196;
  t1467 = t1466 / 0.1e2;
  t1469 = t6 * t686 * t196;
  t1471 = 0.3e1 / 0.2e2 * t6 * t1439 * t30 * t94 + 0.3e1 / 0.1e2 * t1446 - t1451 + 0.2e1 / 0.45e2 * t1454 + t1328 / 0.1e2 - t1332 / 0.1e2 + 0.2e1 / 0.15e2 * t1336 - t1341 + 0.3e1 / 0.2e2 * t6 * t674 * t196 + 0.3e1 / 0.1e2 * t1463 - t1467 + 0.2e1 / 0.45e2 * t1469;
  t1472 = my_piecewise3(t64, 0, t1471);
  tv4rho41 = t657 + t691 + 0.3e1 * t739 + 0.3e1 * t779 + t7 * (t1416 + t1472);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1487 = t337 * t337;
  t1500 = my_piecewise5(t11, 0, t15, 0, t1365);
  t1504 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1181 * t387 * t239 - 0.4e2 / 0.27e2 * t696 * t103 * t337 - 0.1e2 / 0.27e2 * t782 * t247 + 0.2e2 / 0.9e1 * t238 * t1487 + 0.2e2 / 0.9e1 * t333 * t707 - 0.1e2 / 0.27e2 * t567 * t392 * t239 + 0.2e2 / 0.9e1 * t238 * t791 * t103 + 0.1e2 / 0.9e1 * t787 * t247 + 0.5e1 / 0.3e1 * t26 * t1500);
  t1513 = t6 * t800 * t134;
  t1526 = t6 * t795 * t111 * t59;
  t1530 = t6 * t396 * t264 * t59;
  t1537 = 0.3e1 / 0.2e2 * t6 * t1504 * t30 * t59 + 0.3e1 / 0.1e2 * t6 * t796 * t134 + t1513 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t397 * t299 + 0.2e1 / 0.5e1 * t1380 - 0.2e1 / 0.15e2 * t1386 + t1389 / 0.5e1 - t1217 / 0.15e2 + 0.4e1 / 0.45e2 * t1226 - t1229 / 0.3e2 + t1526 / 0.5e1 - t1530 / 0.3e2 - 0.2e1 / 0.15e2 * t1402 + 0.4e1 / 0.45e2 * t1406 + t1410 / 0.5e1 - t1286 / 0.3e2 + 0.4e1 / 0.45e2 * t1290 - t1297;
  t1538 = my_piecewise3(t1, 0, t1537);
  t1547 = t361 * t361;
  t1560 = my_piecewise5(t15, 0, t11, 0, t1433);
  t1564 = my_piecewise3(t69, 0, 0.4e2 / 0.81e2 * t1302 * t404 * t306 - 0.4e2 / 0.27e2 * t740 * t142 * t361 - 0.1e2 / 0.27e2 * t812 * t312 + 0.2e2 / 0.9e1 * t305 * t1547 + 0.2e2 / 0.9e1 * t357 * t750 - 0.1e2 / 0.27e2 * t659 * t409 * t306 + 0.2e2 / 0.9e1 * t305 * t821 * t142 + 0.1e2 / 0.9e1 * t817 * t312 + 0.5e1 / 0.3e1 * t71 * t1560);
  t1571 = t6 * t825 * t111 * t94;
  t1575 = t6 * t413 * t264 * t94;
  t1584 = t6 * t759 * t196;
  t1587 = t6 * t763 * t196;
  t1598 = t6 * t321 * t448;
  t1601 = t6 * t325 * t448;
  t1603 = 0.3e1 / 0.2e2 * t6 * t1564 * t30 * t94 + t1571 / 0.5e1 - t1575 / 0.3e2 + t1446 / 0.5e1 - 0.2e1 / 0.15e2 * t1450 + 0.4e1 / 0.45e2 * t1454 + 0.3e1 / 0.1e2 * t6 * t755 * t196 + 0.2e1 / 0.5e1 * t1584 - t1587 / 0.15e2 - t1332 / 0.3e2 + 0.4e1 / 0.45e2 * t1336 - t1341 + t1463 / 0.5e1 - 0.2e1 / 0.15e2 * t1466 + 0.4e1 / 0.45e2 * t1469 + 0.3e1 / 0.2e2 * t6 * t317 * t448 + t1598 / 0.5e1 - t1601 / 0.3e2;
  t1604 = my_piecewise3(t64, 0, t1603);
  tv4rho42 = 0.2e1 * t739 + 0.2e1 * t779 + 0.2e1 * t811 + 0.2e1 * t850 + t7 * (t1538 + t1604);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1625 = my_piecewise5(t11, 0, t15, 0, t1364 + t1365);
  t1629 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1181 * t855 * t103 - 0.1e2 / 0.9e1 * t782 * t337 - 0.1e2 / 0.9e1 * t696 * t392 * t103 + 0.1e2 / 0.3e1 * t699 * t392 + 0.1e2 / 0.3e1 * t333 * t791 + 0.1e2 / 0.9e1 * t238 * t862 * t103 + 0.5e1 / 0.3e1 * t26 * t1625);
  t1636 = t6 * t866 * t111 * t59;
  t1647 = 0.3e1 / 0.2e2 * t6 * t1629 * t30 * t59 + t1636 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t867 * t134 + 0.3e1 / 0.1e2 * t1526 - t1530 / 0.1e2 + 0.3e1 / 0.1e2 * t1513 - t1403 + 0.2e1 / 0.15e2 * t1406 - t1387 + 0.2e1 / 0.45e2 * t1290 - t1297 + 0.2e1 / 0.45e2 * t1226;
  t1648 = my_piecewise3(t1, 0, t1647);
  t1665 = my_piecewise5(t15, 0, t11, 0, -t1364 + t1433);
  t1669 = my_piecewise3(t69, 0, 0.4e2 / 0.81e2 * t1302 * t875 * t142 - 0.1e2 / 0.9e1 * t812 * t361 - 0.1e2 / 0.9e1 * t740 * t409 * t142 + 0.1e2 / 0.3e1 * t743 * t409 + 0.1e2 / 0.3e1 * t357 * t821 + 0.1e2 / 0.9e1 * t305 * t882 * t142 + 0.5e1 / 0.3e1 * t71 * t1665);
  t1676 = t6 * t886 * t111 * t94;
  t1684 = t6 * t830 * t196;
  t1693 = t6 * t370 * t448;
  t1703 = t6 * t150 * t935;
  t1705 = 0.3e1 / 0.2e2 * t6 * t1669 * t30 * t94 + t1676 / 0.1e2 + 0.3e1 / 0.1e2 * t1571 - t1575 / 0.1e2 + 0.9e1 / 0.2e2 * t6 * t826 * t196 + 0.3e1 / 0.1e2 * t1684 - t1451 + 0.2e1 / 0.15e2 * t1454 + 0.3e1 / 0.5e1 * t1584 - t1587 / 0.5e1 + 0.9e1 / 0.2e2 * t6 * t366 * t448 + 0.3e1 / 0.1e2 * t1693 + 0.2e1 / 0.45e2 * t1336 - t1341 - t1467 + 0.2e1 / 0.15e2 * t1469 + 0.3e1 / 0.1e2 * t1598 - t1601 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t146 * t935 + t1703 / 0.1e2;
  t1706 = my_piecewise3(t64, 0, t1705);
  tv4rho43 = 0.3e1 * t811 + 0.3e1 * t850 + t874 + t940 + t7 * (t1648 + t1706);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1711 = t387 * t387;
  t1716 = t392 * t392;
  t1723 = my_piecewise5(t11, 0, t15, 0, 0.24e2 * t575 + 0.24e2 * t1195);
  t1727 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1181 * t1711 - 0.2e2 / 0.9e1 * t782 * t392 + 0.1e2 / 0.3e1 * t238 * t1716 + 0.4e2 / 0.9e1 * t333 * t862 + 0.5e1 / 0.3e1 * t26 * t1723);
  t1736 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t1727 * t30 * t59 + 0.2e1 / 0.5e1 * t1636 - t1530 / 0.5e1 + 0.8e1 / 0.45e2 * t1406 - t1297);
  t1737 = t84 * t75;
  t1744 = t85 * t1737;
  t1767 = t438 * t438;
  t1772 = 0.1e1 / t929 / t89;
  t1781 = t404 * t404;
  t1786 = t409 * t409;
  t1793 = my_piecewise5(t15, 0, t11, 0, -0.24e2 * t575 + 0.24e2 * t1314);
  t1797 = my_piecewise3(t69, 0, 0.4e2 / 0.81e2 * t1302 * t1781 - 0.2e2 / 0.9e1 * t812 * t409 + 0.1e2 / 0.3e1 * t305 * t1786 + 0.4e2 / 0.9e1 * t357 * t882 + 0.5e1 / 0.3e1 * t71 * t1793);
  t1820 = 0.3e1 / 0.2e2 * t6 * t74 * (0.1309e5 / 0.6561e4 * t37 * sigma[2] / t77 / t1737 * t90 - 0.179585e6 / 0.2519424e7 * t186 / t77 / t1744 * t191 * t45 + 0.14245e5 / 0.80621568e8 * t437 / t77 / t438 / t1737 * t443 * t295 - 0.485e3 / 0.3869835264e10 * t925 / t77 / t438 / t1744 * t930 * t648 + 0.5e1 / 0.185752092672e12 * t37 * t923 * t550 / t77 / t1767 / t1737 * t1772 * t1272) + 0.3e1 / 0.2e2 * t6 * t1797 * t30 * t94 + 0.3e1 / 0.5e1 * t6 * t887 * t196 + 0.9e1 / 0.1e2 * t6 * t414 * t448 + 0.3e1 / 0.5e1 * t6 * t174 * t935 + 0.2e1 / 0.5e1 * t1676 + 0.6e1 / 0.5e1 * t1684 + 0.6e1 / 0.5e1 * t1693 + 0.2e1 / 0.5e1 * t1703 - t1575 / 0.5e1 - 0.2e1 / 0.5e1 * t1587 - t1601 / 0.5e1 + 0.8e1 / 0.45e2 * t1454 + 0.8e1 / 0.45e2 * t1469 - t1341;
  t1821 = my_piecewise3(t64, 0, t1820);
  tv4rho44 = 0.4e1 * t874 + 0.4e1 * t940 + t7 * (t1736 + t1821);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1829 = t6 * t588 * t215;
  t1835 = t6 * t595 * t215;
  t1838 = t6 * t256 * t479;
  t1845 = 0.2e1 / 0.45e2 * t6 * t607 * t215;
  t1847 = t6 * t265 * t479;
  t1850 = t6 * t112 * t979;
  t1862 = t645 * t648;
  t1880 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t584 * t215 + 0.3e1 / 0.1e2 * t1829 + 0.9e1 / 0.2e2 * t6 * t252 * t479 - t1835 / 0.1e2 + 0.3e1 / 0.5e1 * t1838 + 0.9e1 / 0.2e2 * t6 * t107 * t979 + t1845 - t1847 / 0.1e2 + 0.3e1 / 0.1e2 * t1850 + 0.3e1 / 0.2e2 * t6 * t31 * (-0.77e3 / 0.2187e4 * t37 * t619 * t55 + 0.17605e5 / 0.839808e6 * t37 * t626 * t467 - 0.6335e4 / 0.107495424e9 * t37 * t633 * t967 + 0.925e3 / 0.20639121408e11 * t37 * t643 * t1862 * t970 - 0.5e1 / 0.495338913792e12 * t37 * t638 * t123 / t40 / t1264 / t617 * t1269 * t1272));
  tv4rho3sigma0 = t7 * t1880 + 0.3e1 * t984;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1887 = t6 * t678 * t231;
  t1890 = t6 * t682 * t231;
  t1894 = 0.2e1 / 0.45e2 * t6 * t686 * t231;
  t1896 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t674 * t231 + 0.3e1 / 0.1e2 * t1887 - t1890 / 0.1e2 + t1894);
  tv4rho3sigma2 = t7 * t1896 + 0.3e1 * t997;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1898 = 0.2e1 * t1011;
  t1904 = t6 * t716 * t215 / 0.5e1;
  t1909 = t6 * t723 * t215;
  t1913 = t6 * t346 * t479 / 0.5e1;
  t1922 = 0.3e1 / 0.2e2 * t6 * t712 * t215 + t1904 + 0.3e1 / 0.1e2 * t6 * t342 * t479 - t1909 / 0.3e2 + t1913 + 0.3e1 / 0.2e2 * t6 * t163 * t979 + t1829 / 0.1e2 - t1835 / 0.15e2 + t1838 / 0.5e1 + t1845 - t1847 / 0.15e2 + t1850 / 0.1e2;
  t1923 = my_piecewise3(t1, 0, t1922);
  tv4rho3sigma3 = t7 * t1923 + t1898 + t984;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1925 = 0.2e1 * t1027;
  t1931 = t6 * t759 * t231 / 0.5e1;
  t1933 = t6 * t763 * t231;
  t1942 = t6 * t321 * t521 / 0.5e1;
  t1944 = t6 * t325 * t521;
  t1947 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t755 * t231 + t1931 - t1933 / 0.3e2 + t1887 / 0.1e2 - t1890 / 0.15e2 + t1894 + 0.3e1 / 0.2e2 * t6 * t317 * t521 + t1942 - t1944 / 0.3e2);
  tv4rho3sigma5 = t7 * t1947 + t1925 + t997;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1953 = t6 * t800 * t215;
  t1962 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t796 * t215 + t1953 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t397 * t479 + t1904 - t1909 / 0.15e2 + t1913 - t1835 / 0.3e2 + t1845 - t1847 / 0.3e2);
  tv4rho3sigma6 = t7 * t1962 + t1035 + t1898;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1968 = t6 * t830 * t231;
  t1975 = t6 * t370 * t521;
  t1983 = t6 * t150 * t1066;
  t1985 = 0.3e1 / 0.2e2 * t6 * t826 * t231 + t1968 / 0.1e2 + t1931 - t1933 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t366 * t521 + t1975 / 0.5e1 - t1890 / 0.3e2 + t1894 + t1942 - t1944 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t146 * t1066 + t1983 / 0.1e2;
  t1986 = my_piecewise3(t64, 0, t1985);
  tv4rho3sigma8 = t7 * t1986 + t1071 + t1925;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1995 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t867 * t215 + 0.3e1 / 0.1e2 * t1953 - t1909 / 0.1e2 + t1845);
  tv4rho3sigma9 = t7 * t1995 + 0.3e1 * t1035;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2022 = t930 * t648;
  t2040 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t887 * t231 + 0.3e1 / 0.1e2 * t1968 + 0.9e1 / 0.2e2 * t6 * t414 * t521 - t1933 / 0.1e2 + 0.3e1 / 0.5e1 * t1975 + 0.9e1 / 0.2e2 * t6 * t174 * t1066 + t1894 - t1944 / 0.1e2 + 0.3e1 / 0.1e2 * t1983 + 0.3e1 / 0.2e2 * t6 * t74 * (-0.77e3 / 0.2187e4 * t37 * t904 * t90 + 0.17605e5 / 0.839808e6 * t37 * t911 * t509 - 0.6335e4 / 0.107495424e9 * t37 * t918 * t1054 + 0.925e3 / 0.20639121408e11 * t37 * t928 * t2022 * t1057 - 0.5e1 / 0.495338913792e12 * t37 * t923 * t185 / t77 / t1767 / t902 * t1772 * t1272));
  tv4rho3sigma11 = t7 * t2040 + 0.3e1 * t1071;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2047 = t6 * t256 * t541;
  t2054 = t6 * t265 * t541 / 0.3e2;
  t2056 = t6 * t112 * t1093;
  t2080 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t252 * t541 + t2047 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t107 * t1093 - t2054 + t2056 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * (-0.175e3 / 0.34992e5 * t962 * t529 + 0.1295e4 / 0.71663616e8 * t965 * t1082 - 0.95e2 / 0.6115295232e10 * t37 * t974 * t1862 * t638 + 0.5e1 / 0.1320903770112e13 * t37 * t638 * t47 / t40 / t1264 / t49 * t1269 * t1272));
  tv4rho2sigma20 = t7 * t2080 + 0.2e1 * t1098;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2087 = t6 * t321 * t559;
  t2091 = t6 * t325 * t559 / 0.3e2;
  t2093 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t317 * t559 + t2087 / 0.5e1 - t2091);
  tv4rho2sigma25 = t7 * t2093 + 0.2e1 * t1107;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2099 = t6 * t346 * t541;
  t2107 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t342 * t541 + t2099 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t163 * t1093 + t2047 / 0.1e2 - t2054 + t2056 / 0.1e2);
  tv4rho2sigma26 = t7 * t2107 + t1098 + t1113;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2113 = t6 * t370 * t559;
  t2120 = t6 * t150 * t1132;
  t2123 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t366 * t559 + t2113 / 0.1e2 + t2087 / 0.1e2 - t2091 + 0.3e1 / 0.2e2 * t6 * t146 * t1132 + t2120 / 0.1e2);
  tv4rho2sigma211 = t7 * t2123 + t1107 + t1137;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2131 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t397 * t541 + t2099 / 0.5e1 - t2054);
  tv4rho2sigma212 = t7 * t2131 + 0.2e1 * t1113;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2164 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t414 * t559 + t2113 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t174 * t1132 - t2091 + t2120 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t74 * (-0.175e3 / 0.34992e5 * t1049 * t547 + 0.1295e4 / 0.71663616e8 * t1052 * t1121 - 0.95e2 / 0.6115295232e10 * t37 * t1061 * t2022 * t923 + 0.5e1 / 0.1320903770112e13 * t37 * t923 * t82 / t77 / t1767 / t84 * t1772 * t1272));
  tv4rho2sigma217 = t7 * t2164 + 0.2e1 * t1137;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2171 = t6 * t112 * t1153 / 0.1e2;
  t2192 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t107 * t1153 + t2171 + 0.3e1 / 0.2e2 * t6 * t31 * (-0.355e3 / 0.71663616e8 * t1081 * t1140 + 0.95e2 / 0.18345885696e11 * t37 * t1088 * t1862 * t285 + 0.5e1 / 0.5832e4 * t465 * t1143 - 0.5e1 / 0.3522410053632e13 * t640 / t40 / t1264 / t116 * t1269 * t1272));
  tv4rhosigma30 = t7 * t2192 + t1157;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2199 = t6 * t150 * t1172 / 0.1e2;
  t2201 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t146 * t1172 + t2199);
  tv4rhosigma39 = t7 * t2201 + t1176;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2207 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t163 * t1153 + t2171);
  tv4rhosigma310 = t7 * t2207 + t1157;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2232 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t174 * t1172 + t2199 + 0.3e1 / 0.2e2 * t6 * t74 * (-0.355e3 / 0.71663616e8 * t1120 * t1159 + 0.95e2 / 0.18345885696e11 * t37 * t1127 * t2022 * t436 + 0.5e1 / 0.5832e4 * t507 * t1162 - 0.5e1 / 0.3522410053632e13 * t925 / t77 / t1767 / t178 * t1772 * t1272));
  tv4rhosigma319 = t7 * t2232 + t1176;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2254 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * (-0.5e1 / 0.3057647616e10 * t37 * t1148 * t1862 * t470 + 0.55e2 / 0.47775744e8 * t1139 * t966 * t47 - 0.5e1 / 0.62208e5 * t37 * t212 + 0.5e1 / 0.9393093476352e13 * t971 / t40 / t1264 / t38 * t1269 * t1272));
  tv4sigma40 = t7 * t2254;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2275 = my_piecewise3(t64, 0, 0.3e1 / 0.2e2 * t6 * t74 * (-0.5e1 / 0.3057647616e10 * t37 * t1167 * t2022 * t512 + 0.55e2 / 0.47775744e8 * t1158 * t1053 * t82 - 0.5e1 / 0.62208e5 * t37 * t228 + 0.5e1 / 0.9393093476352e13 * t1058 / t77 / t1767 / t75 * t1772 * t1272));
  tv4sigma414 = t7 * t2275;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

