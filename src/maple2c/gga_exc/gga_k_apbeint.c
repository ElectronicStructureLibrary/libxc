/* 
  This file was generated automatically with ./scripts/maple2c_new.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_apbeint.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 3

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t11, t12, t13, t14, t15, t16, t17;
  double t18, t20, t23, t26, t27, t28, t33, t34;
  double t37, t42, t44, t47, t48, t49, t50, t51;
  double t52, t53, t55, t56, t60, t61, t63, t65;
  double t66, t67, t68, t71, t72, t73, t74, t79;
  double t80, t83, t86, t87, t91, t92, t97, t100;
  double t105, t106, t108, t111, t113, t115, t120, t121;
  double t126, t127, t128, t133, t134, t140, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t161;
  double t162, t167, t170, t171, t175, t176, t179, t180;
  double t181, t183, t190, t195, t201, t202, t209, t212;
  double t214, t217, t219, t222, t223, t227, t233, t234;
  double t239, t241, t260, t261, t272, t283, t289, t290;
  double t291, t297, t298, t300, t329;

  gga_k_apbeint_params *params;
 
  assert(p->params != NULL);
  params = (gga_k_apbeint_params * )(p->params);

  t1 = M_CBRT6;
  t2 = t1 * t1;
  t3 = M_PI * M_PI;
  t4 = POW_1_3(t3);
  t5 = t4 * t4;
  t6 = t2 * t5;
  t7 = M_CBRT2;
  t8 = POW_1_3(rho[0]);
  t9 = t8 * t8;
  t11 = params->muPBE - params->muGE;
  t12 = t11 * params->alpha;
  t13 = 0.1e1 / t5;
  t14 = t1 * t13;
  t15 = t12 * t14;
  t16 = t7 * t7;
  t17 = sigma[0] * t16;
  t18 = rho[0] * rho[0];
  t20 = 0.1e1 / t9 / t18;
  t23 = t17 * t20;
  t26 = 0.1e1 + params->alpha * t1 * t13 * t23 / 0.24e2;
  t27 = 0.1e1 / t26;
  t28 = t20 * t27;
  t33 = (params->muGE + t15 * t17 * t28 / 0.24e2) * t1;
  t34 = t33 * t13;
  t37 = params->kappa + t34 * t23 / 0.24e2;
  t42 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t37);
  t44 = t6 * t7 * t9 * t42;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = 0.3e1 / 0.20e2 * t44;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t47 = t9 * rho[0] * t2;
  t48 = t47 * t5;
  t49 = params->kappa * params->kappa;
  t50 = t7 * t49;
  t51 = t37 * t37;
  t52 = 0.1e1 / t51;
  t53 = t18 * rho[0];
  t55 = 0.1e1 / t9 / t53;
  t56 = t55 * t27;
  t60 = params->alpha * params->alpha;
  t61 = t11 * t60;
  t63 = 0.1e1 / t4 / t3;
  t65 = t61 * t2 * t63;
  t66 = sigma[0] * sigma[0];
  t67 = t66 * t7;
  t68 = t18 * t18;
  t71 = 0.1e1 / t8 / t68 / t18;
  t72 = t26 * t26;
  t73 = 0.1e1 / t72;
  t74 = t71 * t73;
  t79 = (-t15 * t17 * t56 / 0.9e1 + t65 * t67 * t74 / 0.108e3) * t1;
  t80 = t79 * t13;
  t83 = t17 * t55;
  t86 = t80 * t23 / 0.24e2 - t34 * t83 / 0.9e1;
  t87 = t52 * t86;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t44 / 0.4e1 + 0.3e1 / 0.20e2 * t48 * t50 * t87;

  t91 = t12 * t1;
  t92 = t13 * t16;
  t97 = t68 * rho[0];
  t100 = 0.1e1 / t8 / t97 * t73;
  t105 = (t91 * t92 * t28 / 0.24e2 - t65 * sigma[0] * t7 * t100 / 0.288e3) * t1;
  t106 = t105 * t13;
  t108 = t92 * t20;
  t111 = t106 * t23 / 0.24e2 + t33 * t108 / 0.24e2;
  t113 = t50 * t52 * t111;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.3e1 / 0.20e2 * t48 * t113;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t115 = 0.1e1 / t8;
  t120 = t6 * t7;
  t121 = t9 * t49;
  t126 = 0.1e1 / t51 / t37;
  t127 = t86 * t86;
  t128 = t126 * t127;
  t133 = 0.1e1 / t9 / t68;
  t134 = t133 * t27;
  t140 = 0.1e1 / t8 / t68 / t53;
  t146 = t11 * t60 * params->alpha;
  t147 = t3 * t3;
  t148 = 0.1e1 / t147;
  t149 = t146 * t148;
  t150 = t66 * sigma[0];
  t151 = t68 * t68;
  t152 = t151 * t18;
  t153 = 0.1e1 / t152;
  t156 = 0.1e1 / t72 / t26;
  t161 = (0.11e2 / 0.27e2 * t15 * t17 * t134 - t65 * t67 * t140 * t73 / 0.12e2 + 0.2e1 / 0.81e2 * t149 * t150 * t153 * t156) * t1;
  t162 = t161 * t13;
  t167 = t17 * t133;
  t170 = t162 * t23 / 0.24e2 - 0.2e1 / 0.9e1 * t80 * t83 + 0.11e2 / 0.27e2 * t34 * t167;
  t171 = t52 * t170;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t6 * t7 * t115 * t42 / 0.6e1 + t120 * t121 * t87 / 0.2e1 - 0.3e1 / 0.10e2 * t48 * t50 * t128 + 0.3e1 / 0.20e2 * t48 * t50 * t171;

  t175 = t9 * t2;
  t176 = t175 * t5;
  t179 = t5 * t7;
  t180 = t47 * t179;
  t181 = t49 * t126;
  t183 = t181 * t111 * t86;
  t190 = t73 * sigma[0];
  t195 = 0.1e1 / t151 / rho[0];
  t201 = (-t91 * t92 * t56 / 0.9e1 + t65 * t7 * t71 * t190 / 0.36e2 - t149 * t66 * t195 * t156 / 0.108e3) * t1;
  t202 = t201 * t13;
  t209 = t92 * t55;
  t212 = t202 * t23 / 0.24e2 - t106 * t83 / 0.9e1 + t79 * t108 / 0.24e2 - t33 * t209 / 0.9e1;
  t214 = t50 * t52 * t212;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t176 * t113 / 0.4e1 - 0.3e1 / 0.10e2 * t180 * t183 + 0.3e1 / 0.20e2 * t48 * t214;

  t217 = t111 * t111;
  t219 = t50 * t126 * t217;
  t222 = t61 * t2;
  t223 = t63 * t7;
  t227 = 0.1e1 / t151;
  t233 = (-t222 * t223 * t100 / 0.144e3 + t149 * sigma[0] * t227 * t156 / 0.288e3) * t1;
  t234 = t233 * t13;
  t239 = t234 * t23 / 0.24e2 + t105 * t108 / 0.12e2;
  t241 = t50 * t52 * t239;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.10e2 * t48 * t219 + 0.3e1 / 0.20e2 * t48 * t241;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t260 = t51 * t51;
  t261 = 0.1e1 / t260;
  t272 = 0.1e1 / t9 / t97;
  t283 = t151 * t53;
  t289 = t60 * t60;
  t290 = t11 * t289;
  t291 = t66 * t66;
  t297 = t72 * t72;
  t298 = 0.1e1 / t297;
  t300 = t14 * t16;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = -t6 * t7 / t8 / rho[0] * t42 / 0.18e2 + t120 * t115 * t49 * t87 / 0.2e1 - 0.3e1 / 0.2e1 * t120 * t121 * t128 + 0.3e1 / 0.4e1 * t120 * t121 * t171 + 0.9e1 / 0.10e2 * t48 * t50 * t261 * t127 * t86 - 0.9e1 / 0.10e2 * t180 * t181 * t86 * t170 + 0.3e1 / 0.20e2 * t48 * t50 * t52 * ((-0.154e3 / 0.81e2 * t15 * t17 * t272 * t27 + 0.341e3 / 0.486e3 * t65 * t67 / t8 / t151 * t73 - 0.38e2 / 0.81e2 * t149 * t150 / t283 * t156 + 0.2e1 / 0.243e3 * t290 * t148 * t291 / t9 / t151 / t97 * t298 * t300) * t1 * t13 * t23 / 0.24e2 - t162 * t83 / 0.3e1 + 0.11e2 / 0.9e1 * t80 * t167 - 0.154e3 / 0.81e2 * t34 * t17 * t272);

  t329 = t49 * t261;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t115 * t2 * t5 * t113 / 0.6e1 - t175 * t179 * t183 + t176 * t214 / 0.2e1 + 0.9e1 / 0.10e2 * t180 * t329 * t111 * t127 - 0.3e1 / 0.5e1 * t180 * t181 * t212 * t86 - 0.3e1 / 0.10e2 * t180 * t181 * t111 * t170 + 0.3e1 / 0.20e2 * t48 * t50 * t52 * ((0.11e2 / 0.27e2 * t91 * t92 * t134 - 0.65e2 / 0.324e3 * t65 * t7 * t140 * t190 + 0.17e2 / 0.108e3 * t149 * t153 * t156 * t66 - t290 * t148 * t150 / t9 / t151 / t68 * t298 * t300 / 0.324e3) * t1 * t13 * t23 / 0.24e2 - 0.2e1 / 0.9e1 * t202 * t83 + 0.11e2 / 0.27e2 * t106 * t167 + t161 * t108 / 0.24e2 - 0.2e1 / 0.9e1 * t79 * t209 + 0.11e2 / 0.27e2 * t33 * t92 * t133);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t176 * t219 / 0.2e1 + 0.9e1 / 0.10e2 * t180 * t329 * t217 * t86 - 0.3e1 / 0.5e1 * t180 * t181 * t111 * t212 + t176 * t241 / 0.4e1 - 0.3e1 / 0.10e2 * t180 * t181 * t239 * t86 + 0.3e1 / 0.20e2 * t48 * t50 * t52 * ((t222 * t223 * t74 / 0.27e2 - 0.5e1 / 0.108e3 * t149 * t195 * t156 * sigma[0] + t290 * t148 * t66 / t9 / t283 * t298 * t300 / 0.864e3) * t1 * t13 * t23 / 0.24e2 - t234 * t83 / 0.9e1 + t201 * t108 / 0.12e2 - 0.2e1 / 0.9e1 * t105 * t209);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.9e1 / 0.10e2 * t48 * t50 * t261 * t217 * t111 - 0.9e1 / 0.10e2 * t180 * t181 * t111 * t239 + 0.3e1 / 0.20e2 * t48 * t50 * t52 * ((t146 * t148 * t227 * t156 / 0.96e2 - t290 * t148 * sigma[0] / t9 / t152 * t298 * t300 / 0.2304e4) * t1 * t13 * t23 / 0.24e2 + t233 * t108 / 0.8e1);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}


static inline void
func_ferr(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t11, t12, t13, t14, t16, t18, t21;
  double t22, t28, t31, t36, t38, t42, t43, t44;
  double t46, t47, t49, t54, t56, t58, t59, t60;
  double t61, t64, t65, t66, t72, t75, t78, t79;
  double t82, t87, t89, t95, t99, t100, t102, t106;
  double t110, t111, t112, t116, t123, t129, t130, t131;
  double t132, t133, t134, t135, t136, t139, t144, t149;
  double t152, t153, t159, t162, t166, t167, t172, t178;
  double t187, t188, t191, t192, t199, t205, t210, t211;
  double t219, t225, t227, t237, t248, t254, t255, t256;
  double t262, t263, t265, t301;

  gga_k_apbeint_params *params;
 
  assert(p->params != NULL);
  params = (gga_k_apbeint_params * )(p->params);

  t1 = M_CBRT6;
  t2 = t1 * t1;
  t3 = M_PI * M_PI;
  t4 = POW_1_3(t3);
  t5 = t4 * t4;
  t6 = t2 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = t7 * t7;
  t9 = params->muPBE - params->muGE;
  t11 = t9 * params->alpha * t1;
  t12 = 0.1e1 / t5;
  t13 = t12 * sigma[0];
  t14 = rho[0] * rho[0];
  t16 = 0.1e1 / t8 / t14;
  t18 = t13 * t16;
  t21 = 0.1e1 + params->alpha * t1 * t18 / 0.24e2;
  t22 = 0.1e1 / t21;
  t28 = (params->muGE + t11 * t13 * t16 * t22 / 0.24e2) * t1;
  t31 = params->kappa + t28 * t18 / 0.24e2;
  t36 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t31);
  t38 = t6 * t8 * t36;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = 0.3e1 / 0.10e2 * t38;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t42 = t8 * rho[0] * t2 * t5;
  t43 = params->kappa * params->kappa;
  t44 = t31 * t31;
  t46 = t43 / t44;
  t47 = t14 * rho[0];
  t49 = 0.1e1 / t8 / t47;
  t54 = params->alpha * params->alpha;
  t56 = t9 * t54 * t2;
  t58 = 0.1e1 / t4 / t3;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t14 * t14;
  t64 = 0.1e1 / t7 / t61 / t14;
  t65 = t21 * t21;
  t66 = 0.1e1 / t65;
  t72 = (-t11 * t13 * t49 * t22 / 0.9e1 + t56 * t60 * t64 * t66 / 0.216e3) * t1;
  t75 = t13 * t49;
  t78 = t72 * t18 / 0.24e2 - t28 * t75 / 0.9e1;
  t79 = t46 * t78;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t38 / 0.2e1 + 0.3e1 / 0.10e2 * t42 * t79;

  t82 = t12 * t16;
  t87 = t61 * rho[0];
  t89 = 0.1e1 / t7 / t87;
  t95 = (t11 * t82 * t22 / 0.24e2 - t56 * t58 * sigma[0] * t89 * t66 / 0.576e3) * t1;
  t99 = t95 * t18 / 0.24e2 + t28 * t82 / 0.24e2;
  t100 = t46 * t99;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.3e1 / 0.10e2 * t42 * t100;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t102 = 0.1e1 / t7;
  t106 = t6 * t8;
  t110 = t43 / t44 / t31;
  t111 = t78 * t78;
  t112 = t110 * t111;
  t116 = 0.1e1 / t8 / t61;
  t123 = 0.1e1 / t7 / t61 / t47;
  t129 = t9 * t54 * params->alpha;
  t130 = t3 * t3;
  t131 = 0.1e1 / t130;
  t132 = t129 * t131;
  t133 = t59 * sigma[0];
  t134 = t61 * t61;
  t135 = t134 * t14;
  t136 = 0.1e1 / t135;
  t139 = 0.1e1 / t65 / t21;
  t144 = (0.11e2 / 0.27e2 * t11 * t13 * t116 * t22 - t56 * t60 * t123 * t66 / 0.24e2 + t132 * t133 * t136 * t139 / 0.162e3) * t1;
  t149 = t13 * t116;
  t152 = t144 * t18 / 0.24e2 - 0.2e1 / 0.9e1 * t72 * t75 + 0.11e2 / 0.27e2 * t28 * t149;
  t153 = t46 * t152;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t6 * t102 * t36 / 0.3e1 + t106 * t79 - 0.3e1 / 0.5e1 * t42 * t112 + 0.3e1 / 0.10e2 * t42 * t153;

  t159 = t110 * t99 * t78;
  t162 = t12 * t49;
  t166 = t58 * t64;
  t167 = t66 * sigma[0];
  t172 = 0.1e1 / t134 / rho[0];
  t178 = (-t11 * t162 * t22 / 0.9e1 + t56 * t166 * t167 / 0.72e2 - t132 * t59 * t172 * t139 / 0.432e3) * t1;
  t187 = t178 * t18 / 0.24e2 - t95 * t75 / 0.9e1 + t72 * t82 / 0.24e2 - t28 * t162 / 0.9e1;
  t188 = t46 * t187;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t106 * t100 / 0.2e1 - 0.3e1 / 0.5e1 * t42 * t159 + 0.3e1 / 0.10e2 * t42 * t188;

  t191 = t99 * t99;
  t192 = t110 * t191;
  t199 = 0.1e1 / t134;
  t205 = (-t56 * t58 * t89 * t66 / 0.288e3 + t132 * sigma[0] * t199 * t139 / 0.1152e4) * t1;
  t210 = t205 * t18 / 0.24e2 + t95 * t82 / 0.12e2;
  t211 = t46 * t210;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.5e1 * t42 * t192 + 0.3e1 / 0.10e2 * t42 * t211;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t219 = t6 * t102;
  t225 = t44 * t44;
  t227 = t43 / t225;
  t237 = 0.1e1 / t8 / t87;
  t248 = t134 * t47;
  t254 = t54 * t54;
  t255 = t9 * t254;
  t256 = t59 * t59;
  t262 = t65 * t65;
  t263 = 0.1e1 / t262;
  t265 = t1 * t12;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = -t6 / t7 / rho[0] * t36 / 0.9e1 + t219 * t79 - 0.3e1 * t106 * t112 + 0.3e1 / 0.2e1 * t106 * t153 + 0.9e1 / 0.5e1 * t42 * t227 * t111 * t78 - 0.9e1 / 0.5e1 * t42 * t110 * t78 * t152 + 0.3e1 / 0.10e2 * t42 * t46 * ((-0.154e3 / 0.81e2 * t11 * t13 * t237 * t22 + 0.341e3 / 0.972e3 * t56 * t60 / t7 / t134 * t66 - 0.19e2 / 0.162e3 * t132 * t133 / t248 * t139 + t255 * t131 * t256 / t8 / t134 / t87 * t263 * t265 / 0.486e3) * t1 * t18 / 0.24e2 - t144 * t75 / 0.3e1 + 0.11e2 / 0.9e1 * t72 * t149 - 0.154e3 / 0.81e2 * t28 * t13 * t237);

  t301 = t12 * t116;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t219 * t100 / 0.3e1 - 0.2e1 * t106 * t159 + t106 * t188 + 0.9e1 / 0.5e1 * t42 * t227 * t99 * t111 - 0.6e1 / 0.5e1 * t42 * t110 * t187 * t78 - 0.3e1 / 0.5e1 * t42 * t110 * t99 * t152 + 0.3e1 / 0.10e2 * t42 * t46 * ((0.11e2 / 0.27e2 * t11 * t301 * t22 - 0.65e2 / 0.648e3 * t56 * t58 * t123 * t167 + 0.17e2 / 0.432e3 * t132 * t136 * t139 * t59 - t255 * t131 * t133 / t8 / t134 / t61 * t263 * t265 / 0.1296e4) * t1 * t18 / 0.24e2 - 0.2e1 / 0.9e1 * t178 * t75 + 0.11e2 / 0.27e2 * t95 * t149 + t144 * t82 / 0.24e2 - 0.2e1 / 0.9e1 * t72 * t162 + 0.11e2 / 0.27e2 * t28 * t301);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t106 * t192 + 0.9e1 / 0.5e1 * t42 * t227 * t191 * t78 - 0.6e1 / 0.5e1 * t42 * t110 * t99 * t187 + t106 * t211 / 0.2e1 - 0.3e1 / 0.5e1 * t42 * t110 * t210 * t78 + 0.3e1 / 0.10e2 * t42 * t46 * ((t56 * t166 * t66 / 0.54e2 - 0.5e1 / 0.432e3 * t132 * t172 * t139 * sigma[0] + t255 * t131 * t59 / t8 / t248 * t263 * t265 / 0.3456e4) * t1 * t18 / 0.24e2 - t205 * t75 / 0.9e1 + t178 * t82 / 0.12e2 - 0.2e1 / 0.9e1 * t95 * t162);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.9e1 / 0.5e1 * t42 * t227 * t191 * t99 - 0.9e1 / 0.5e1 * t42 * t110 * t99 * t210 + 0.3e1 / 0.10e2 * t42 * t46 * ((t129 * t131 * t199 * t139 / 0.384e3 - t255 * t131 * sigma[0] / t8 / t135 * t263 * t265 / 0.9216e4) * t1 * t18 / 0.24e2 + t205 * t82 / 0.8e1);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t12, t13, t14, t15, t16, t17;
  double t18, t19, t21, t22, t23, t24, t25, t26;
  double t28, t29, t30, t33, t34, t40, t43, t48;
  double t50, t52, t53, t54, t55, t56, t57, t58;
  double t59, t60, t62, t63, t66, t67, t73, t76;
  double t81, t83, t85, t86, t87, t88, t89, t90;
  double t91, t93, t95, t96, t97, t100, t101, t102;
  double t103, t104, t105, t106, t107, t109, t114, t116;
  double t118, t119, t120, t121, t124, t125, t126, t132;
  double t135, t138, t139, t141, t142, t143, t144, t145;
  double t147, t148, t151, t152, t156, t158, t159, t160;
  double t162, t163, t164, t165, t166, t167, t169, t174;
  double t175, t176, t179, t180, t181, t187, t190, t193;
  double t194, t196, t197, t201, t202, t203, t204, t209;
  double t211, t217, t221, t222, t225, t226, t231, t233;
  double t239, t243, t244, t247, t249, t250, t251, t252;
  double t254, t255, t256, t258, t259, t261, t262, t264;
  double t265, t266, t267, t268, t269, t271, t272, t274;
  double t277, t278, t279, t281, t282, t284, t285, t286;
  double t288, t289, t291, t298, t304, t305, t306, t307;
  double t308, t309, t310, t311, t314, t319, t324, t327;
  double t328, t330, t331, t332, t333, t334, t336, t337;
  double t338, t340, t341, t342, t344, t345, t348, t349;
  double t350, t352, t354, t357, t359, t360, t361, t364;
  double t365, t367, t371, t373, t376, t378, t380, t384;
  double t385, t387, t388, t391, t393, t396, t398, t399;
  double t400, t401, t403, t404, t405, t407, t408, t409;
  double t410, t411, t412, t413, t415, t416, t417, t419;
  double t420, t421, t423, t424, t426, t433, t438, t439;
  double t440, t441, t444, t449, t454, t457, t458, t460;
  double t461, t462, t465, t467, t468, t469, t470, t474;
  double t475, t477, t480, t484, t485, t490, t496, t505;
  double t506, t511, t512, t513, t515, t518, t519, t523;
  double t524, t528, t529, t530, t531, t534, t538, t539;
  double t544, t550, t559, t561, t564, t566, t573, t579;
  double t584, t586, t589, t591, t598, t604, t609, t611;
  double t617, t619, t625, t626, t628, t630, t635, t642;
  double t648, t650, t652, t656, t662, t664, t666, t673;
  double t677, t679, t680, t690, t698, t702, t706, t708;
  double t711, t714, t725, t731, t732, t733, t739, t740;
  double t742, t766, t768, t769, t775, t780, t782, t783;
  double t784, t788, t799, t802, t805, t809, t812, t832;
  double t833, t844, t846, t861, t867, t869, t871, t883;
  double t886, t888, t892, t895, t898, t901, t904, t927;
  double t945, t948, t954, t976, t979, t996, t1017, t1027;
  double t1040, t1051, t1057, t1063, t1064, t1085, t1086, t1093;
  double t1096, t1100, t1101, t1104, t1106, t1122, t1135, t1175;
  double t1179, t1181, t1192, t1205, t1212, t1223, t1228, t1229;
  double t1261, t1274, t1314, t1327, t1366, t1371;

  gga_k_apbeint_params *params;
 
  assert(p->params != NULL);
  params = (gga_k_apbeint_params * )(p->params);

  t1 = M_CBRT6;
  t2 = t1 * t1;
  t3 = M_PI * M_PI;
  t4 = POW_1_3(t3);
  t5 = t4 * t4;
  t6 = t2 * t5;
  t7 = rho[0] - rho[1];
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t12 = 0.1e1 / 0.2e1 + t10 / 0.2e1;
  t13 = POW_1_3(t12);
  t14 = t13 * t13;
  t15 = t14 * t12;
  t16 = POW_1_3(t8);
  t17 = t16 * t16;
  t18 = t15 * t17;
  t19 = params->muPBE - params->muGE;
  t21 = t19 * params->alpha * t1;
  t22 = 0.1e1 / t5;
  t23 = t22 * sigma[0];
  t24 = rho[0] * rho[0];
  t25 = POW_1_3(rho[0]);
  t26 = t25 * t25;
  t28 = 0.1e1 / t26 / t24;
  t29 = params->alpha * t1;
  t30 = t23 * t28;
  t33 = 0.1e1 + t29 * t30 / 0.24e2;
  t34 = 0.1e1 / t33;
  t40 = (params->muGE + t21 * t23 * t28 * t34 / 0.24e2) * t1;
  t43 = params->kappa + t40 * t30 / 0.24e2;
  t48 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t43);
  t50 = t6 * t18 * t48;
  t52 = 0.1e1 / 0.2e1 - t10 / 0.2e1;
  t53 = POW_1_3(t52);
  t54 = t53 * t53;
  t55 = t54 * t52;
  t56 = t55 * t17;
  t57 = t22 * sigma[2];
  t58 = rho[1] * rho[1];
  t59 = POW_1_3(rho[1]);
  t60 = t59 * t59;
  t62 = 0.1e1 / t60 / t58;
  t63 = t57 * t62;
  t66 = 0.1e1 + t29 * t63 / 0.24e2;
  t67 = 0.1e1 / t66;
  t73 = (params->muGE + t21 * t57 * t62 * t67 / 0.24e2) * t1;
  t76 = params->kappa + t73 * t63 / 0.24e2;
  t81 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t76);
  t83 = t6 * t56 * t81;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = 0.3e1 / 0.10e2 * t50 + 0.3e1 / 0.10e2 * t83;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t85 = 0.3e1 / 0.10e2 * t50;
  t86 = 0.3e1 / 0.10e2 * t83;
  t87 = t6 * t14;
  t88 = t17 * t48;
  t89 = t8 * t8;
  t90 = 0.1e1 / t89;
  t91 = t7 * t90;
  t93 = t9 / 0.2e1 - t91 / 0.2e1;
  t95 = t87 * t88 * t93;
  t96 = t95 / 0.2e1;
  t97 = 0.1e1 / t16;
  t100 = t6 * t15 * t97 * t48;
  t101 = t100 / 0.5e1;
  t102 = t6 * t15;
  t103 = params->kappa * params->kappa;
  t104 = t17 * t103;
  t105 = t43 * t43;
  t106 = 0.1e1 / t105;
  t107 = t24 * rho[0];
  t109 = 0.1e1 / t26 / t107;
  t114 = params->alpha * params->alpha;
  t116 = t19 * t114 * t2;
  t118 = 0.1e1 / t4 / t3;
  t119 = sigma[0] * sigma[0];
  t120 = t118 * t119;
  t121 = t24 * t24;
  t124 = 0.1e1 / t25 / t121 / t24;
  t125 = t33 * t33;
  t126 = 0.1e1 / t125;
  t132 = (-t21 * t23 * t109 * t34 / 0.9e1 + t116 * t120 * t124 * t126 / 0.216e3) * t1;
  t135 = t23 * t109;
  t138 = t132 * t30 / 0.24e2 - t40 * t135 / 0.9e1;
  t139 = t106 * t138;
  t141 = t102 * t104 * t139;
  t142 = 0.3e1 / 0.10e2 * t141;
  t143 = t6 * t54;
  t144 = t17 * t81;
  t145 = -t93;
  t147 = t143 * t144 * t145;
  t148 = t147 / 0.2e1;
  t151 = t6 * t55 * t97 * t81;
  t152 = t151 / 0.5e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t85 + t86 + t8 * (t96 + t101 + t142 + t148 + t152);

  t156 = -t9 / 0.2e1 - t91 / 0.2e1;
  t158 = t87 * t88 * t156;
  t159 = t158 / 0.2e1;
  t160 = -t156;
  t162 = t143 * t144 * t160;
  t163 = t162 / 0.2e1;
  t164 = t6 * t55;
  t165 = t76 * t76;
  t166 = 0.1e1 / t165;
  t167 = t58 * rho[1];
  t169 = 0.1e1 / t60 / t167;
  t174 = sigma[2] * sigma[2];
  t175 = t118 * t174;
  t176 = t58 * t58;
  t179 = 0.1e1 / t59 / t176 / t58;
  t180 = t66 * t66;
  t181 = 0.1e1 / t180;
  t187 = (-t21 * t57 * t169 * t67 / 0.9e1 + t116 * t175 * t179 * t181 / 0.216e3) * t1;
  t190 = t57 * t169;
  t193 = t187 * t63 / 0.24e2 - t73 * t190 / 0.9e1;
  t194 = t166 * t193;
  t196 = t164 * t104 * t194;
  t197 = 0.3e1 / 0.10e2 * t196;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t85 + t86 + t8 * (t159 + t101 + t163 + t152 + t197);

  t201 = t17 * t8 * t2;
  t202 = t201 * t5;
  t203 = t15 * t103;
  t204 = t22 * t28;
  t209 = t121 * rho[0];
  t211 = 0.1e1 / t25 / t209;
  t217 = (t21 * t204 * t34 / 0.24e2 - t116 * t118 * sigma[0] * t211 * t126 / 0.576e3) * t1;
  t221 = t40 * t204 / 0.24e2 + t217 * t30 / 0.24e2;
  t222 = t106 * t221;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.3e1 / 0.10e2 * t202 * t203 * t222;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t225 = t55 * t103;
  t226 = t22 * t62;
  t231 = t176 * rho[1];
  t233 = 0.1e1 / t59 / t231;
  t239 = (t21 * t226 * t67 / 0.24e2 - t116 * t118 * sigma[2] * t233 * t181 / 0.576e3) * t1;
  t243 = t73 * t226 / 0.24e2 + t239 * t63 / 0.24e2;
  t244 = t166 * t243;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = 0.3e1 / 0.10e2 * t202 * t225 * t244;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t247 = 0.2e1 / 0.5e1 * t100;
  t249 = 0.2e1 / 0.5e1 * t151;
  t250 = 0.1e1 / t13;
  t251 = t6 * t250;
  t252 = t93 * t93;
  t254 = t251 * t88 * t252;
  t255 = t254 / 0.3e1;
  t256 = t97 * t48;
  t258 = t87 * t256 * t93;
  t259 = 0.2e1 / 0.3e1 * t258;
  t261 = t6 * t14 * t17;
  t262 = t103 * t106;
  t264 = t262 * t138 * t93;
  t265 = t261 * t264;
  t266 = t89 * t8;
  t267 = 0.1e1 / t266;
  t268 = t7 * t267;
  t269 = -t90 + t268;
  t271 = t87 * t88 * t269;
  t272 = t271 / 0.2e1;
  t274 = 0.1e1 / t16 / t8;
  t277 = t6 * t15 * t274 * t48;
  t278 = t277 / 0.15e2;
  t279 = t97 * t103;
  t281 = t102 * t279 * t139;
  t282 = 0.2e1 / 0.5e1 * t281;
  t284 = 0.1e1 / t105 / t43;
  t285 = t138 * t138;
  t286 = t284 * t285;
  t288 = t102 * t104 * t286;
  t289 = 0.3e1 / 0.5e1 * t288;
  t291 = 0.1e1 / t26 / t121;
  t298 = 0.1e1 / t25 / t121 / t107;
  t304 = t19 * t114 * params->alpha;
  t305 = t3 * t3;
  t306 = 0.1e1 / t305;
  t307 = t304 * t306;
  t308 = t119 * sigma[0];
  t309 = t121 * t121;
  t310 = t309 * t24;
  t311 = 0.1e1 / t310;
  t314 = 0.1e1 / t125 / t33;
  t319 = (0.11e2 / 0.27e2 * t21 * t23 * t291 * t34 - t116 * t120 * t298 * t126 / 0.24e2 + t307 * t308 * t311 * t314 / 0.162e3) * t1;
  t324 = t23 * t291;
  t327 = t319 * t30 / 0.24e2 - 0.2e1 / 0.9e1 * t132 * t135 + 0.11e2 / 0.27e2 * t40 * t324;
  t328 = t106 * t327;
  t330 = t102 * t104 * t328;
  t331 = 0.3e1 / 0.10e2 * t330;
  t332 = 0.1e1 / t53;
  t333 = t6 * t332;
  t334 = t145 * t145;
  t336 = t333 * t144 * t334;
  t337 = t336 / 0.3e1;
  t338 = t97 * t81;
  t340 = t143 * t338 * t145;
  t341 = 0.2e1 / 0.3e1 * t340;
  t342 = -t269;
  t344 = t143 * t144 * t342;
  t345 = t344 / 0.2e1;
  t348 = t6 * t55 * t274 * t81;
  t349 = t348 / 0.15e2;
  t350 = t255 + t259 + t265 + t272 - t278 + t282 - t289 + t331 + t337 + t341 + t345 - t349;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t95 + t247 + 0.3e1 / 0.5e1 * t141 + t147 + t249 + t8 * t350;

  t352 = t156 * t93;
  t354 = t251 * t88 * t352;
  t357 = t87 * t256 * t156;
  t359 = t138 * t156;
  t360 = t262 * t359;
  t361 = t261 * t360;
  t364 = 0.1e1 / t16 / t89;
  t365 = t364 * t48;
  t367 = t87 * t365 * t7;
  t371 = t160 * t145;
  t373 = t333 * t144 * t371;
  t376 = t143 * t338 * t160;
  t378 = t364 * t81;
  t380 = t143 * t378 * t7;
  t384 = t6 * t54 * t17;
  t385 = t103 * t166;
  t387 = t385 * t193 * t145;
  t388 = t384 * t387;
  t391 = t164 * t279 * t194;
  t393 = t354 / 0.3e1 + t357 / 0.3e1 + t361 / 0.2e1 + t367 / 0.2e1 + t258 / 0.3e1 - t278 + t281 / 0.5e1 + t373 / 0.3e1 + t376 / 0.3e1 - t380 / 0.2e1 + t340 / 0.3e1 - t349 + t388 / 0.2e1 + t391 / 0.5e1;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t8 * t393 + t142 + t148 + t159 + t163 + t197 + t247 + t249 + t96;

  t396 = t156 * t156;
  t398 = t251 * t88 * t396;
  t399 = t398 / 0.3e1;
  t400 = 0.2e1 / 0.3e1 * t357;
  t401 = t90 + t268;
  t403 = t87 * t88 * t401;
  t404 = t403 / 0.2e1;
  t405 = t160 * t160;
  t407 = t333 * t144 * t405;
  t408 = t407 / 0.3e1;
  t409 = 0.2e1 / 0.3e1 * t376;
  t410 = t193 * t160;
  t411 = t385 * t410;
  t412 = t384 * t411;
  t413 = -t401;
  t415 = t143 * t144 * t413;
  t416 = t415 / 0.2e1;
  t417 = 0.2e1 / 0.5e1 * t391;
  t419 = 0.1e1 / t165 / t76;
  t420 = t193 * t193;
  t421 = t419 * t420;
  t423 = t164 * t104 * t421;
  t424 = 0.3e1 / 0.5e1 * t423;
  t426 = 0.1e1 / t60 / t176;
  t433 = 0.1e1 / t59 / t176 / t167;
  t438 = t174 * sigma[2];
  t439 = t176 * t176;
  t440 = t439 * t58;
  t441 = 0.1e1 / t440;
  t444 = 0.1e1 / t180 / t66;
  t449 = (0.11e2 / 0.27e2 * t21 * t57 * t426 * t67 - t116 * t175 * t433 * t181 / 0.24e2 + t307 * t438 * t441 * t444 / 0.162e3) * t1;
  t454 = t57 * t426;
  t457 = t449 * t63 / 0.24e2 - 0.2e1 / 0.9e1 * t187 * t190 + 0.11e2 / 0.27e2 * t73 * t454;
  t458 = t166 * t457;
  t460 = t164 * t104 * t458;
  t461 = 0.3e1 / 0.10e2 * t460;
  t462 = t399 + t400 + t404 - t278 + t408 + t409 + t412 + t416 - t349 + t417 - t424 + t461;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = t158 + t247 + t162 + t249 + 0.3e1 / 0.5e1 * t196 + t8 * t462;

  t465 = t102 * t104 * t222;
  t467 = t5 * t14;
  t468 = t201 * t467;
  t469 = t221 * t93;
  t470 = t262 * t469;
  t474 = t201 * t5 * t15;
  t475 = t103 * t284;
  t477 = t475 * t221 * t138;
  t480 = t22 * t109;
  t484 = t118 * t124;
  t485 = t126 * sigma[0];
  t490 = 0.1e1 / t309 / rho[0];
  t496 = (-t21 * t480 * t34 / 0.9e1 + t116 * t484 * t485 / 0.72e2 - t307 * t119 * t490 * t314 / 0.432e3) * t1;
  t505 = t496 * t30 / 0.24e2 - t217 * t135 / 0.9e1 + t132 * t204 / 0.24e2 - t40 * t480 / 0.9e1;
  t506 = t106 * t505;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t465 / 0.2e1 + t468 * t470 / 0.2e1 - 0.3e1 / 0.5e1 * t474 * t477 + 0.3e1 / 0.10e2 * t202 * t203 * t506;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t511 = t164 * t104 * t244;
  t512 = t5 * t54;
  t513 = t201 * t512;
  t515 = t385 * t243 * t145;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t513 * t515 / 0.2e1 + t511 / 0.2e1;

  t518 = t221 * t156;
  t519 = t262 * t518;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t468 * t519 / 0.2e1 + t465 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t523 = t243 * t160;
  t524 = t385 * t523;
  t528 = t201 * t5 * t55;
  t529 = t103 * t419;
  t530 = t243 * t193;
  t531 = t529 * t530;
  t534 = t22 * t169;
  t538 = t118 * t179;
  t539 = t181 * sigma[2];
  t544 = 0.1e1 / t439 / rho[1];
  t550 = (-t21 * t534 * t67 / 0.9e1 + t116 * t538 * t539 / 0.72e2 - t307 * t174 * t544 * t444 / 0.432e3) * t1;
  t559 = t550 * t63 / 0.24e2 - t239 * t190 / 0.9e1 + t187 * t226 / 0.24e2 - t73 * t534 / 0.9e1;
  t561 = t225 * t166 * t559;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t511 / 0.2e1 + t513 * t524 / 0.2e1 - 0.3e1 / 0.5e1 * t528 * t531 + 0.3e1 / 0.10e2 * t202 * t561;

  t564 = t221 * t221;
  t566 = t203 * t284 * t564;
  t573 = 0.1e1 / t309;
  t579 = (-t116 * t118 * t211 * t126 / 0.288e3 + t307 * sigma[0] * t573 * t314 / 0.1152e4) * t1;
  t584 = t579 * t30 / 0.24e2 + t217 * t204 / 0.12e2;
  t586 = t203 * t106 * t584;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.5e1 * t202 * t566 + 0.3e1 / 0.10e2 * t202 * t586;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t589 = t243 * t243;
  t591 = t225 * t419 * t589;
  t598 = 0.1e1 / t439;
  t604 = (-t116 * t118 * t233 * t181 / 0.288e3 + t307 * sigma[2] * t598 * t444 / 0.1152e4) * t1;
  t609 = t604 * t63 / 0.24e2 + t239 * t226 / 0.12e2;
  t611 = t225 * t166 * t609;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = -0.3e1 / 0.5e1 * t202 * t591 + 0.3e1 / 0.10e2 * t202 * t611;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t617 = t277 / 0.5e1;
  t619 = t348 / 0.5e1;
  t625 = t87 * t256 * t269;
  t626 = t89 * t89;
  t628 = t7 / t626;
  t630 = 0.3e1 * t267 - 0.3e1 * t628;
  t635 = t143 * t338 * t342;
  t642 = t6 / t13 / t12;
  t648 = t251 * t256 * t252;
  t650 = t274 * t48;
  t652 = t87 * t650 * t93;
  t656 = t6 / t53 / t52;
  t662 = t333 * t338 * t334;
  t664 = t274 * t81;
  t666 = t143 * t664 * t145;
  t673 = t6 * t250 * t17;
  t677 = t625 + t87 * t88 * t630 / 0.2e1 + t635 - t143 * t144 * t630 / 0.2e1 - t642 * t88 * t252 * t93 / 0.9e1 + 0.2e1 / 0.3e1 * t648 - t652 / 0.3e1 - t656 * t144 * t334 * t145 / 0.9e1 + 0.2e1 / 0.3e1 * t662 - t666 / 0.3e1 - 0.3e1 * t261 * t475 * t285 * t93 + t673 * t262 * t138 * t252;
  t679 = t6 * t14 * t97;
  t680 = t679 * t264;
  t690 = t6 * t18;
  t698 = 0.4e1 / 0.45e2 * t6 * t15 * t364 * t48;
  t702 = 0.4e1 / 0.45e2 * t6 * t55 * t364 * t81;
  t706 = t274 * t103;
  t708 = t102 * t706 * t139;
  t711 = t102 * t279 * t328;
  t714 = 0.1e1 / t26 / t209;
  t725 = t309 * t107;
  t731 = t114 * t114;
  t732 = t19 * t731;
  t733 = t119 * t119;
  t739 = t125 * t125;
  t740 = 0.1e1 / t739;
  t742 = t1 * t22;
  t766 = t102 * t279 * t286;
  t768 = t105 * t105;
  t769 = 0.1e1 / t768;
  t775 = 0.2e1 * t680 + 0.3e1 / 0.2e1 * t261 * t262 * t327 * t93 + 0.3e1 / 0.2e1 * t261 * t262 * t138 * t269 - 0.9e1 / 0.5e1 * t690 * t475 * t138 * t327 + t698 + t702 + t251 * t88 * t93 * t269 - t708 / 0.5e1 + 0.3e1 / 0.5e1 * t711 + 0.3e1 / 0.10e2 * t102 * t104 * t106 * ((-0.154e3 / 0.81e2 * t21 * t23 * t714 * t34 + 0.341e3 / 0.972e3 * t116 * t120 / t25 / t309 * t126 - 0.19e2 / 0.162e3 * t307 * t308 / t725 * t314 + t732 * t306 * t733 / t26 / t309 / t209 * t740 * t742 / 0.486e3) * t1 * t30 / 0.24e2 - t319 * t135 / 0.3e1 + 0.11e2 / 0.9e1 * t132 * t324 - 0.154e3 / 0.81e2 * t40 * t23 * t714) + t333 * t144 * t145 * t342 - 0.6e1 / 0.5e1 * t766 + 0.9e1 / 0.5e1 * t102 * t104 * t769 * t285 * t138;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t265 - 0.9e1 / 0.5e1 * t288 + 0.3e1 / 0.2e1 * t271 - t617 + 0.3e1 / 0.2e1 * t344 - t619 + t254 + 0.2e1 * t258 + 0.6e1 / 0.5e1 * t281 + 0.9e1 / 0.10e2 * t330 + t336 + 0.2e1 * t340 + t8 * (t677 + t775);

  t780 = t265 - t289 + t272 - t617 + t345 - t619 - t380 + t255 + 0.4e1 / 0.3e1 * t258 + 0.4e1 / 0.5e1 * t281 + t331;
  t782 = 0.2e1 / 0.3e1 * t354;
  t783 = 0.2e1 / 0.3e1 * t373;
  t784 = t14 * t364;
  t788 = t54 * t364;
  t799 = 0.1e1 / t16 / t266;
  t802 = t143 * t799 * t81 * t7;
  t805 = t87 * t650 * t156;
  t809 = t87 * t799 * t48 * t7;
  t812 = t143 * t664 * t160;
  t832 = 0.4e1 / 0.9e1 * t251 * t256 * t352;
  t833 = t6 * t784 * t48 / 0.2e1 - t6 * t788 * t81 / 0.2e1 + t625 / 0.3e1 + t635 / 0.3e1 + 0.2e1 / 0.9e1 * t648 - 0.2e1 / 0.9e1 * t652 + 0.2e1 / 0.9e1 * t662 - 0.2e1 / 0.9e1 * t666 + 0.5e1 / 0.6e1 * t802 - t805 / 0.9e1 - 0.5e1 / 0.6e1 * t809 - t812 / 0.9e1 + t251 * t88 * t156 * t269 / 0.3e1 + t333 * t144 * t160 * t342 / 0.3e1 - 0.2e1 / 0.3e1 * t333 * t378 * t7 * t145 - t642 * t88 * t156 * t252 / 0.9e1 + t832;
  t844 = 0.4e1 / 0.9e1 * t333 * t338 * t371;
  t846 = t164 * t706 * t194;
  t861 = t6 * t332 * t17;
  t867 = t6 * t54 * t97;
  t869 = 0.2e1 / 0.3e1 * t867 * t387;
  t871 = 0.2e1 / 0.3e1 * t679 * t360;
  t883 = 0.2e1 / 0.3e1 * t251 * t365 * t7 * t93 - t656 * t144 * t160 * t334 / 0.9e1 + t844 - t846 / 0.15e2 + 0.2e1 / 0.3e1 * t673 * t262 * t359 * t93 + 0.2e1 / 0.3e1 * t680 - t261 * t475 * t285 * t156 + t6 * t784 * t262 * t138 * t7 + t861 * t385 * t193 * t334 / 0.3e1 + t869 + t871 + t261 * t262 * t327 * t156 / 0.2e1 + t384 * t385 * t193 * t342 / 0.2e1 + t698 + t702 - 0.2e1 / 0.15e2 * t708 + t711 / 0.5e1 - 0.2e1 / 0.5e1 * t766;
  t886 = t337 + 0.4e1 / 0.3e1 * t340 + t782 + t400 + t367 + t783 + t409 + t361 + t388 + t417 + t8 * (t833 + t883);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t780 + t886;

  t888 = -t617 - t619 - t380 + t404 + t416 + t259 + t282 + t341 + t782 + 0.4e1 / 0.3e1 * t357 + t367;
  t892 = t251 * t256 * t396;
  t895 = t87 * t256 * t401;
  t898 = t333 * t338 * t405;
  t901 = t143 * t338 * t413;
  t904 = -t267 - 0.3e1 * t628;
  t927 = 0.2e1 / 0.9e1 * t892 + t895 / 0.3e1 + 0.2e1 / 0.9e1 * t898 + t901 / 0.3e1 + t87 * t88 * t904 / 0.2e1 - t143 * t144 * t904 / 0.2e1 - t652 / 0.9e1 - t666 / 0.9e1 - 0.2e1 / 0.3e1 * t802 - 0.2e1 / 0.9e1 * t805 + 0.2e1 / 0.3e1 * t809 - 0.2e1 / 0.9e1 * t812 + t832 + t844 - 0.2e1 / 0.15e2 * t846 - t642 * t88 * t396 * t93 / 0.9e1 + t251 * t88 * t401 * t93 / 0.3e1;
  t945 = t164 * t279 * t421;
  t948 = t164 * t279 * t458;
  t954 = t867 * t411;
  t976 = -t656 * t144 * t405 * t145 / 0.9e1 - 0.2e1 / 0.3e1 * t333 * t378 * t160 * t7 + t333 * t144 * t413 * t145 / 0.3e1 + 0.2e1 / 0.3e1 * t251 * t365 * t156 * t7 - 0.2e1 / 0.5e1 * t945 + t948 / 0.5e1 + 0.2e1 / 0.3e1 * t861 * t385 * t410 * t145 + t869 + t871 + t698 + t702 + 0.2e1 / 0.3e1 * t954 + t673 * t262 * t138 * t396 / 0.3e1 + t261 * t262 * t138 * t401 / 0.2e1 - t6 * t788 * t385 * t193 * t7 - t384 * t529 * t420 * t145 + t384 * t385 * t457 * t145 / 0.2e1 - t708 / 0.15e2;
  t979 = t783 + 0.4e1 / 0.3e1 * t376 + t399 + t408 + t461 + t361 + t388 + 0.4e1 / 0.5e1 * t391 + t412 - t424 + t8 * (t927 + t976);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t888 + t979;

  t996 = t6 * t56;
  t1017 = -0.3e1 * t267 - 0.3e1 * t628;
  t1027 = 0.3e1 / 0.2e1 * t384 * t385 * t457 * t160 + 0.3e1 / 0.2e1 * t384 * t385 * t193 * t413 - 0.9e1 / 0.5e1 * t996 * t529 * t193 * t457 - 0.3e1 * t384 * t529 * t420 * t160 + t861 * t385 * t193 * t405 - t642 * t88 * t396 * t156 / 0.9e1 - t656 * t144 * t405 * t160 / 0.9e1 + t87 * t88 * t1017 / 0.2e1 - t143 * t144 * t1017 / 0.2e1 + 0.2e1 / 0.3e1 * t892 + t895 + 0.2e1 / 0.3e1 * t898;
  t1040 = 0.1e1 / t60 / t231;
  t1051 = t439 * t167;
  t1057 = t174 * t174;
  t1063 = t180 * t180;
  t1064 = 0.1e1 / t1063;
  t1085 = t165 * t165;
  t1086 = 0.1e1 / t1085;
  t1093 = t901 - t805 / 0.3e1 - t812 / 0.3e1 - t846 / 0.5e1 - 0.6e1 / 0.5e1 * t945 + 0.3e1 / 0.5e1 * t948 + t251 * t88 * t156 * t401 + t333 * t144 * t160 * t413 + 0.3e1 / 0.10e2 * t164 * t104 * t166 * ((-0.154e3 / 0.81e2 * t21 * t57 * t1040 * t67 + 0.341e3 / 0.972e3 * t116 * t175 / t59 / t439 * t181 - 0.19e2 / 0.162e3 * t307 * t438 / t1051 * t444 + t732 * t306 * t1057 / t60 / t439 / t231 * t1064 * t742 / 0.486e3) * t1 * t63 / 0.24e2 - t449 * t190 / 0.3e1 + 0.11e2 / 0.9e1 * t187 * t454 - 0.154e3 / 0.81e2 * t73 * t57 * t1040) + 0.9e1 / 0.5e1 * t164 * t104 * t1086 * t420 * t193 + t698 + t702 + 0.2e1 * t954;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = -t617 - t619 + 0.3e1 / 0.2e1 * t403 + 0.3e1 / 0.2e1 * t415 + 0.2e1 * t357 + 0.2e1 * t376 + t398 + t407 + 0.9e1 / 0.10e2 * t460 + 0.6e1 / 0.5e1 * t391 + 0.3e1 * t412 - 0.9e1 / 0.5e1 * t423 + t8 * (t1027 + t1093);

  t1096 = t261 * t470;
  t1100 = t102 * t279 * t222 / 0.3e1;
  t1101 = t690 * t477;
  t1104 = t102 * t104 * t506;
  t1106 = t201 * t5 * t250;
  t1122 = t103 * t769;
  t1135 = t22 * t291;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.5e1 / 0.3e1 * t1096 + t1100 - 0.2e1 * t1101 + t1104 + t1106 * t262 * t221 * t252 / 0.3e1 - 0.2e1 * t468 * t475 * t469 * t138 + t468 * t262 * t505 * t93 + t468 * t262 * t221 * t269 / 0.2e1 + 0.9e1 / 0.5e1 * t474 * t1122 * t221 * t285 - 0.6e1 / 0.5e1 * t474 * t475 * t505 * t138 - 0.3e1 / 0.5e1 * t474 * t475 * t221 * t327 + 0.3e1 / 0.10e2 * t202 * t203 * t106 * ((0.11e2 / 0.27e2 * t21 * t1135 * t34 - 0.65e2 / 0.648e3 * t116 * t118 * t298 * t485 + 0.17e2 / 0.432e3 * t307 * t311 * t314 * t119 - t732 * t306 * t308 / t26 / t309 / t121 * t740 * t742 / 0.1296e4) * t1 * t30 / 0.24e2 - 0.2e1 / 0.9e1 * t496 * t135 + 0.11e2 / 0.27e2 * t217 * t324 + t319 * t204 / 0.24e2 - 0.2e1 / 0.9e1 * t132 * t480 + 0.11e2 / 0.27e2 * t40 * t1135);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t1175 = t384 * t515;
  t1179 = t164 * t279 * t244 / 0.3e1;
  t1181 = t201 * t5 * t332;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = 0.5e1 / 0.3e1 * t1175 + t1179 + t1181 * t385 * t243 * t334 / 0.3e1 + t513 * t385 * t243 * t342 / 0.2e1;

  t1192 = t261 * t519;
  t1205 = t274 * t2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = 0.5e1 / 0.6e1 * t1096 + t1100 - t1101 + t1104 / 0.2e1 + 0.5e1 / 0.6e1 * t1192 + t1106 * t262 * t518 * t93 / 0.3e1 - t468 * t475 * t518 * t138 + t468 * t262 * t505 * t156 / 0.2e1 + t1205 * t467 * t262 * t221 * t7 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1212 = t384 * t524;
  t1223 = t996 * t531;
  t1228 = t17 * t2 * t5;
  t1229 = t1228 * t561;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = 0.5e1 / 0.6e1 * t1175 + t1179 + 0.5e1 / 0.6e1 * t1212 + t1181 * t385 * t523 * t145 / 0.3e1 - t1205 * t512 * t385 * t243 * t7 / 0.2e1 - t1223 - t513 * t529 * t530 * t145 + t1229 / 0.2e1 + t513 * t385 * t559 * t145 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = 0.5e1 / 0.3e1 * t1192 + t1100 + t1106 * t262 * t221 * t396 / 0.3e1 + t468 * t262 * t221 * t401 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1261 = t103 * t1086;
  t1274 = t22 * t426;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = 0.5e1 / 0.3e1 * t1212 + t1179 - 0.2e1 * t1223 + t1229 + t1181 * t385 * t243 * t405 / 0.3e1 - 0.2e1 * t513 * t529 * t523 * t193 + t513 * t385 * t559 * t160 + t513 * t385 * t243 * t413 / 0.2e1 + 0.9e1 / 0.5e1 * t528 * t1261 * t243 * t420 - 0.6e1 / 0.5e1 * t528 * t529 * t559 * t193 - 0.3e1 / 0.5e1 * t528 * t529 * t243 * t457 + 0.3e1 / 0.10e2 * t202 * t225 * t166 * ((0.11e2 / 0.27e2 * t21 * t1274 * t67 - 0.65e2 / 0.648e3 * t116 * t118 * t433 * t539 + 0.17e2 / 0.432e3 * t307 * t441 * t444 * t174 - t732 * t306 * t438 / t60 / t439 / t176 * t1064 * t742 / 0.1296e4) * t1 * t63 / 0.24e2 - 0.2e1 / 0.9e1 * t550 * t190 + 0.11e2 / 0.27e2 * t239 * t454 + t449 * t226 / 0.24e2 - 0.2e1 / 0.9e1 * t187 * t534 + 0.11e2 / 0.27e2 * t73 * t1274);

  t1314 = t1228 * t566;
  t1327 = t1228 * t586 / 0.2e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t1314 - t468 * t475 * t564 * t93 + 0.9e1 / 0.5e1 * t474 * t1122 * t564 * t138 - 0.6e1 / 0.5e1 * t474 * t475 * t221 * t505 + t1327 + t468 * t262 * t584 * t93 / 0.2e1 - 0.3e1 / 0.5e1 * t474 * t475 * t584 * t138 + 0.3e1 / 0.10e2 * t202 * t203 * t106 * ((t116 * t484 * t126 / 0.54e2 - 0.5e1 / 0.432e3 * t307 * t490 * t314 * sigma[0] + t732 * t306 * t119 / t26 / t725 * t740 * t742 / 0.3456e4) * t1 * t30 / 0.24e2 - t579 * t135 / 0.9e1 + t496 * t204 / 0.12e2 - 0.2e1 / 0.9e1 * t217 * t480);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1366 = t1228 * t591;
  t1371 = t1228 * t611 / 0.2e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = -t1366 - t513 * t529 * t589 * t145 + t1371 + t513 * t385 * t609 * t145 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = -t1314 - t468 * t475 * t564 * t156 + t1327 + t468 * t262 * t584 * t156 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = -t1366 - t513 * t529 * t589 * t160 + 0.9e1 / 0.5e1 * t528 * t1261 * t589 * t193 - 0.6e1 / 0.5e1 * t528 * t529 * t243 * t559 + t1371 + t513 * t385 * t609 * t160 / 0.2e1 - 0.3e1 / 0.5e1 * t528 * t529 * t609 * t193 + 0.3e1 / 0.10e2 * t202 * t225 * t166 * ((t116 * t538 * t181 / 0.54e2 - 0.5e1 / 0.432e3 * t307 * t544 * t444 * sigma[2] + t732 * t306 * t174 / t60 / t1051 * t1064 * t742 / 0.3456e4) * t1 * t63 / 0.24e2 - t604 * t190 / 0.9e1 + t550 * t226 / 0.12e2 - 0.2e1 / 0.9e1 * t239 * t534);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.9e1 / 0.5e1 * t202 * t203 * t769 * t564 * t221 - 0.9e1 / 0.5e1 * t474 * t475 * t221 * t584 + 0.3e1 / 0.10e2 * t202 * t203 * t106 * ((t304 * t306 * t573 * t314 / 0.384e3 - t732 * t306 * sigma[0] / t26 / t310 * t740 * t742 / 0.9216e4) * t1 * t30 / 0.24e2 + t579 * t204 / 0.8e1);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = 0.9e1 / 0.5e1 * t202 * t225 * t1086 * t589 * t243 - 0.9e1 / 0.5e1 * t528 * t529 * t243 * t609 + 0.3e1 / 0.10e2 * t202 * t225 * t166 * ((t304 * t306 * t598 * t444 / 0.384e3 - t732 * t306 * sigma[2] / t60 / t440 * t1064 * t742 / 0.9216e4) * t1 * t63 / 0.24e2 + t604 * t226 / 0.8e1);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}

