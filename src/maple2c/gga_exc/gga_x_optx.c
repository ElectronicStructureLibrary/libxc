/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_optx.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t39, t43, t44;
  double t45, t48, t52, t53, t54, t55, t56, t57;
  double t59, t60, t61, t62, t63, t64, t65, t67;
  double t70, t74, t75, t76, t79, t83, tzk0;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = my_piecewise5(t14, t11, t10, t15, -t17);
  t55 = 0.1e1 + t54;
  t56 = t55 <= p->zeta_threshold;
  t57 = POW_1_3(t55);
  t59 = my_piecewise3(t56, t22, t57 * t55);
  t60 = t59 * t26;
  t61 = sigma[2] * sigma[2];
  t62 = rho[1] * rho[1];
  t63 = t62 * t62;
  t64 = t63 * rho[1];
  t65 = POW_1_3(rho[1]);
  t67 = 0.1e1 / t65 / t64;
  t70 = t65 * t65;
  t74 = 0.1e1 + params->gamma * sigma[2] / t70 / t62;
  t75 = t74 * t74;
  t76 = 0.1e1 / t75;
  t79 = t29 * t61 * t67 * t76 + params->a;
  t83 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t79);
  tzk0 = t52 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t39, t43, t44;
  double t45, t48, t52, t53, t54, t55, t56, t57;
  double t59, t60, t61, t62, t63, t64, t65, t67;
  double t70, t74, t75, t76, t79, t83, tzk0;

  double t84, t85, t86, t87, t88, t91, t92, t96;
  double t97, t98, t101, t102, t104, t109, t110, t111;
  double t112, t113, t116, t120, t125, t127, t130, t131;
  double t135, t138, t140, tvrho0, t143, t144, t147, t148;
  double t153, t155, t158, t159, t163, t165, t169, t170;
  double t171, t172, t175, t179, t184, tvrho1, t190, t195;
  double t199, tvsigma0, tvsigma1, t203, t208, t212, tvsigma2;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = my_piecewise5(t14, t11, t10, t15, -t17);
  t55 = 0.1e1 + t54;
  t56 = t55 <= p->zeta_threshold;
  t57 = POW_1_3(t55);
  t59 = my_piecewise3(t56, t22, t57 * t55);
  t60 = t59 * t26;
  t61 = sigma[2] * sigma[2];
  t62 = rho[1] * rho[1];
  t63 = t62 * t62;
  t64 = t63 * rho[1];
  t65 = POW_1_3(rho[1]);
  t67 = 0.1e1 / t65 / t64;
  t70 = t65 * t65;
  t74 = 0.1e1 + params->gamma * sigma[2] / t70 / t62;
  t75 = t74 * t74;
  t76 = 0.1e1 / t75;
  t79 = t29 * t61 * t67 * t76 + params->a;
  t83 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t79);
  tzk0 = t52 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t87 = t7 - t86;
  t88 = my_piecewise5(t10, 0, t14, 0, t87);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t48 / 0.8e1;
  t102 = t32 * t31;
  t104 = 0.1e1 / t34 / t102;
  t109 = params->b * t28 * params->gamma;
  t110 = t30 * sigma[0];
  t111 = t32 * t32;
  t112 = t111 * rho[0];
  t113 = 0.1e1 / t112;
  t116 = 0.1e1 / t44 / t43;
  t120 = -0.16e2 / 0.3e1 * t29 * t30 * t104 * t45 + 0.16e2 / 0.3e1 * t109 * t110 * t113 * t116;
  t125 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t48 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t120);
  t127 = my_piecewise5(t14, 0, t10, 0, -t87);
  t130 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t127);
  t131 = t130 * t26;
  t135 = t59 * t97;
  t138 = t5 * t135 * t79 / 0.8e1;
  t140 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t79 - t138);
  tvrho0 = t52 + t83 + t6 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t7 - t86;
  t144 = my_piecewise5(t10, 0, t14, 0, t143);
  t147 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t144);
  t148 = t147 * t26;
  t153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t48 - t101);
  t155 = my_piecewise5(t14, 0, t10, 0, -t143);
  t158 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t155);
  t159 = t158 * t26;
  t163 = t63 * t62;
  t165 = 0.1e1 / t65 / t163;
  t169 = t61 * sigma[2];
  t170 = t63 * t63;
  t171 = t170 * rho[1];
  t172 = 0.1e1 / t171;
  t175 = 0.1e1 / t75 / t74;
  t179 = 0.16e2 / 0.3e1 * t109 * t169 * t172 * t175 - 0.16e2 / 0.3e1 * t29 * t61 * t165 * t76;
  t184 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t79 - t138 - 0.3e1 / 0.8e1 * t5 * t60 * t179);
  tvrho1 = t52 + t83 + t6 * (t153 + t184);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t190 = 0.1e1 / t111;
  t195 = -0.2e1 * t109 * t30 * t190 * t116 + 0.2e1 * t29 * sigma[0] * t36 * t45;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t195);
  tvsigma0 = t6 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t203 = 0.1e1 / t170;
  t208 = -0.2e1 * t109 * t61 * t203 * t175 + 0.2e1 * t29 * sigma[2] * t67 * t76;
  t212 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t208);
  tvsigma2 = t6 * t212;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t39, t43, t44;
  double t45, t48, t52, t53, t54, t55, t56, t57;
  double t59, t60, t61, t62, t63, t64, t65, t67;
  double t70, t74, t75, t76, t79, t83, tzk0;

  double t84, t85, t86, t87, t88, t91, t92, t96;
  double t97, t98, t101, t102, t104, t109, t110, t111;
  double t112, t113, t116, t120, t125, t127, t130, t131;
  double t135, t138, t140, tvrho0, t143, t144, t147, t148;
  double t153, t155, t158, t159, t163, t165, t169, t170;
  double t171, t172, t175, t179, t184, tvrho1, t190, t195;
  double t199, tvsigma0, tvsigma1, t203, t208, t212, tvsigma2;

  double t215, t216, t217, t220, t221, t222, t224, t225;
  double t229, t230, t234, t236, t242, t243, t246, t248;
  double t250, t251, t253, t258, t259, t264, t265, t266;
  double t267, t269, t271, t272, t276, t281, t282, t283;
  double t284, t288, t292, t293, t297, t299, t301, t304;
  double t306, tv2rho20, t309, t312, t313, t317, t318, t322;
  double t324, t332, t333, t336, t340, t341, t345, t347;
  double t354, t357, tv2rho21, t362, t366, t367, t371, t372;
  double t378, t379, t383, t387, t388, t397, t398, t400;
  double t405, t406, t411, t412, t414, t416, t417, t421;
  double t426, tv2rho22, t434, t443, t445, t450, t455, tv2rhosigma0;
  double tv2rhosigma1, t462, t464, tv2rhosigma2, t470, tv2rhosigma3, tv2rhosigma4, t483;
  double t485, t490, t495, tv2rhosigma5, t505, t510, t514, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t523, t528, t532, tv2sigma25;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = my_piecewise5(t14, t11, t10, t15, -t17);
  t55 = 0.1e1 + t54;
  t56 = t55 <= p->zeta_threshold;
  t57 = POW_1_3(t55);
  t59 = my_piecewise3(t56, t22, t57 * t55);
  t60 = t59 * t26;
  t61 = sigma[2] * sigma[2];
  t62 = rho[1] * rho[1];
  t63 = t62 * t62;
  t64 = t63 * rho[1];
  t65 = POW_1_3(rho[1]);
  t67 = 0.1e1 / t65 / t64;
  t70 = t65 * t65;
  t74 = 0.1e1 + params->gamma * sigma[2] / t70 / t62;
  t75 = t74 * t74;
  t76 = 0.1e1 / t75;
  t79 = t29 * t61 * t67 * t76 + params->a;
  t83 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t79);
  tzk0 = t52 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t87 = t7 - t86;
  t88 = my_piecewise5(t10, 0, t14, 0, t87);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t48 / 0.8e1;
  t102 = t32 * t31;
  t104 = 0.1e1 / t34 / t102;
  t109 = params->b * t28 * params->gamma;
  t110 = t30 * sigma[0];
  t111 = t32 * t32;
  t112 = t111 * rho[0];
  t113 = 0.1e1 / t112;
  t116 = 0.1e1 / t44 / t43;
  t120 = -0.16e2 / 0.3e1 * t29 * t30 * t104 * t45 + 0.16e2 / 0.3e1 * t109 * t110 * t113 * t116;
  t125 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t48 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t120);
  t127 = my_piecewise5(t14, 0, t10, 0, -t87);
  t130 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t127);
  t131 = t130 * t26;
  t135 = t59 * t97;
  t138 = t5 * t135 * t79 / 0.8e1;
  t140 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t79 - t138);
  tvrho0 = t52 + t83 + t6 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t7 - t86;
  t144 = my_piecewise5(t10, 0, t14, 0, t143);
  t147 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t144);
  t148 = t147 * t26;
  t153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t48 - t101);
  t155 = my_piecewise5(t14, 0, t10, 0, -t143);
  t158 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t155);
  t159 = t158 * t26;
  t163 = t63 * t62;
  t165 = 0.1e1 / t65 / t163;
  t169 = t61 * sigma[2];
  t170 = t63 * t63;
  t171 = t170 * rho[1];
  t172 = 0.1e1 / t171;
  t175 = 0.1e1 / t75 / t74;
  t179 = 0.16e2 / 0.3e1 * t109 * t169 * t172 * t175 - 0.16e2 / 0.3e1 * t29 * t61 * t165 * t76;
  t184 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t79 - t138 - 0.3e1 / 0.8e1 * t5 * t60 * t179);
  tvrho1 = t52 + t83 + t6 * (t153 + t184);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t190 = 0.1e1 / t111;
  t195 = -0.2e1 * t109 * t30 * t190 * t116 + 0.2e1 * t29 * sigma[0] * t36 * t45;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t195);
  tvsigma0 = t6 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t203 = 0.1e1 / t170;
  t208 = -0.2e1 * t109 * t61 * t203 * t175 + 0.2e1 * t29 * sigma[2] * t67 * t76;
  t212 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t208);
  tvsigma2 = t6 * t212;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t215 = t23 * t23;
  t216 = 0.1e1 / t215;
  t217 = t88 * t88;
  t220 = t84 * t6;
  t221 = 0.1e1 / t220;
  t222 = t16 * t221;
  t224 = -0.2e1 * t85 + 0.2e1 * t222;
  t225 = my_piecewise5(t10, 0, t14, 0, t224);
  t229 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t217 + 0.4e1 / 0.3e1 * t23 * t225);
  t230 = t229 * t26;
  t234 = t91 * t97;
  t236 = t5 * t234 * t48;
  t242 = 0.1e1 / t96 / t6;
  t243 = t25 * t242;
  t246 = t5 * t243 * t48 / 0.12e2;
  t248 = t5 * t98 * t120;
  t250 = t31 * rho[0];
  t251 = t32 * t250;
  t253 = 0.1e1 / t34 / t251;
  t258 = t111 * t31;
  t259 = 0.1e1 / t258;
  t264 = t28 * t28;
  t265 = params->b * t264;
  t266 = t30 * t30;
  t267 = t111 * t32;
  t269 = 0.1e1 / t39 / t267;
  t271 = t44 * t44;
  t272 = 0.1e1 / t271;
  t276 = 0.304e3 / 0.9e1 * t29 * t30 * t253 * t45 - 0.688e3 / 0.9e1 * t109 * t110 * t259 * t116 + 0.128e3 / 0.3e1 * t265 * t266 * t269 * t272;
  t281 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t48 - t236 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t120 + t246 - t248 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t276);
  t282 = t57 * t57;
  t283 = 0.1e1 / t282;
  t284 = t127 * t127;
  t288 = my_piecewise5(t14, 0, t10, 0, -t224);
  t292 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t284 + 0.4e1 / 0.3e1 * t57 * t288);
  t293 = t292 * t26;
  t297 = t130 * t97;
  t299 = t5 * t297 * t79;
  t301 = t59 * t242;
  t304 = t5 * t301 * t79 / 0.12e2;
  t306 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t79 - t299 / 0.4e1 + t304);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t6 * (t281 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t216 * t144;
  t312 = 0.2e1 * t222;
  t313 = my_piecewise5(t10, 0, t14, 0, t312);
  t317 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t309 * t88 + 0.4e1 / 0.3e1 * t23 * t313);
  t318 = t317 * t26;
  t322 = t147 * t97;
  t324 = t5 * t322 * t48;
  t332 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t48 - t324 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t120 - t236 / 0.8e1 + t246 - t248 / 0.8e1);
  t333 = t283 * t155;
  t336 = my_piecewise5(t14, 0, t10, 0, -t312);
  t340 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t333 * t127 + 0.4e1 / 0.3e1 * t57 * t336);
  t341 = t340 * t26;
  t345 = t158 * t97;
  t347 = t5 * t345 * t79;
  t354 = t5 * t135 * t179;
  t357 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t79 - t347 / 0.8e1 - t299 / 0.8e1 + t304 - 0.3e1 / 0.8e1 * t5 * t131 * t179 - t354 / 0.8e1);
  tv2rho21 = t125 + t140 + t153 + t184 + t6 * (t332 + t357);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t362 = t144 * t144;
  t366 = 0.2e1 * t85 + 0.2e1 * t222;
  t367 = my_piecewise5(t10, 0, t14, 0, t366);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t362 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t371 * t26;
  t378 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t48 - t324 / 0.4e1 + t246);
  t379 = t155 * t155;
  t383 = my_piecewise5(t14, 0, t10, 0, -t366);
  t387 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t379 + 0.4e1 / 0.3e1 * t57 * t383);
  t388 = t387 * t26;
  t397 = t62 * rho[1];
  t398 = t63 * t397;
  t400 = 0.1e1 / t65 / t398;
  t405 = t170 * t62;
  t406 = 0.1e1 / t405;
  t411 = t61 * t61;
  t412 = t170 * t63;
  t414 = 0.1e1 / t70 / t412;
  t416 = t75 * t75;
  t417 = 0.1e1 / t416;
  t421 = 0.304e3 / 0.9e1 * t29 * t61 * t400 * t76 - 0.688e3 / 0.9e1 * t109 * t169 * t406 * t175 + 0.128e3 / 0.3e1 * t265 * t411 * t414 * t417;
  t426 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t79 - t347 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t179 + t304 - t354 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * t421);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t184 + t6 * (t378 + t426);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t434 = t5 * t98 * t195 / 0.8e1;
  t443 = t111 * t250;
  t445 = 0.1e1 / t39 / t443;
  t450 = -0.32e2 / 0.3e1 * t29 * sigma[0] * t104 * t45 + 0.8e2 / 0.3e1 * t109 * t30 * t113 * t116 - 0.16e2 * t265 * t110 * t445 * t272;
  t455 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t195 - t434 - 0.3e1 / 0.8e1 * t5 * t27 * t450);
  tv2rhosigma0 = t6 * t455 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t462 = t5 * t135 * t208 / 0.8e1;
  t464 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t208 - t462);
  tv2rhosigma2 = t6 * t464 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t470 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t195 - t434);
  tv2rhosigma3 = t6 * t470 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t483 = t170 * t397;
  t485 = 0.1e1 / t70 / t483;
  t490 = -0.32e2 / 0.3e1 * t29 * sigma[2] * t165 * t76 + 0.8e2 / 0.3e1 * t109 * t61 * t172 * t175 - 0.16e2 * t265 * t169 * t485 * t417;
  t495 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t208 - t462 - 0.3e1 / 0.8e1 * t5 * t60 * t490);
  tv2rhosigma5 = t6 * t495 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t505 = 0.1e1 / t39 / t258;
  t510 = -0.8e1 * t109 * sigma[0] * t190 * t116 + 0.6e1 * t265 * t30 * t505 * t272 + 0.2e1 * t29 * t36 * t45;
  t514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t510);
  tv2sigma20 = t6 * t514;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t523 = 0.1e1 / t70 / t405;
  t528 = -0.8e1 * t109 * sigma[2] * t203 * t175 + 0.6e1 * t265 * t61 * t523 * t417 + 0.2e1 * t29 * t67 * t76;
  t532 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t528);
  tv2sigma25 = t6 * t532;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t39, t43, t44;
  double t45, t48, t52, t53, t54, t55, t56, t57;
  double t59, t60, t61, t62, t63, t64, t65, t67;
  double t70, t74, t75, t76, t79, t83, tzk0;

  double t84, t85, t86, t87, t88, t91, t92, t96;
  double t97, t98, t101, t102, t104, t109, t110, t111;
  double t112, t113, t116, t120, t125, t127, t130, t131;
  double t135, t138, t140, tvrho0, t143, t144, t147, t148;
  double t153, t155, t158, t159, t163, t165, t169, t170;
  double t171, t172, t175, t179, t184, tvrho1, t190, t195;
  double t199, tvsigma0, tvsigma1, t203, t208, t212, tvsigma2;

  double t215, t216, t217, t220, t221, t222, t224, t225;
  double t229, t230, t234, t236, t242, t243, t246, t248;
  double t250, t251, t253, t258, t259, t264, t265, t266;
  double t267, t269, t271, t272, t276, t281, t282, t283;
  double t284, t288, t292, t293, t297, t299, t301, t304;
  double t306, tv2rho20, t309, t312, t313, t317, t318, t322;
  double t324, t332, t333, t336, t340, t341, t345, t347;
  double t354, t357, tv2rho21, t362, t366, t367, t371, t372;
  double t378, t379, t383, t387, t388, t397, t398, t400;
  double t405, t406, t411, t412, t414, t416, t417, t421;
  double t426, tv2rho22, t434, t443, t445, t450, t455, tv2rhosigma0;
  double tv2rhosigma1, t462, t464, tv2rhosigma2, t470, tv2rhosigma3, tv2rhosigma4, t483;
  double t485, t490, t495, tv2rhosigma5, t505, t510, t514, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t523, t528, t532, tv2sigma25;

  double t536, t537, t540, t543, t544, t545, t547, t548;
  double t552, t553, t557, t559, t564, t566, t569, t575;
  double t576, t579, t581, t584, t587, t592, t597, t599;
  double t605, t606, t607, t609, t612, t616, t621, t623;
  double t624, t627, t631, t635, t636, t640, t642, t644;
  double t646, t648, t651, t653, tv3rho30, t656, t657, t658;
  double t661, t666, t667, t668, t669, t673, t674, t678;
  double t681, t685, t687, t691, t700, t701, t702, t705;
  double t711, t715, t716, t720, t723, t724, t726, t735;
  double t737, t740, tv3rho31, t743, t748, t751, t752, t756;
  double t757, t761, t763, t772, t773, t778, t782, t786;
  double t787, t791, t793, t800, t808, t810, t811, tv3rho32;
  double t816, t822, t823, t827, t828, t835, t836, t842;
  double t846, t847, t863, t868, t873, t875, t880, t881;
  double t883, t886, t890, t895, tv3rho33, t903, t910, t912;
  double t928, t933, t938, tv3rho2sigma0, tv3rho2sigma1, t945, t949, t951;
  double tv3rho2sigma2, t957, t965, tv3rho2sigma3, tv3rho2sigma4, t971, t978, t981;
  double tv3rho2sigma5, t989, tv3rho2sigma6, tv3rho2sigma7, t1014, t1019, t1024, tv3rho2sigma8;
  double t1031, t1035, t1043, t1045, t1050, t1055, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1062, t1064, tv3rhosigma25, t1070, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1078, t1086, t1088, t1093;
  double t1098, tv3rhosigma211, t1108, t1113, t1117, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1126, t1131;
  double t1135, tv3sigma39;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = my_piecewise5(t14, t11, t10, t15, -t17);
  t55 = 0.1e1 + t54;
  t56 = t55 <= p->zeta_threshold;
  t57 = POW_1_3(t55);
  t59 = my_piecewise3(t56, t22, t57 * t55);
  t60 = t59 * t26;
  t61 = sigma[2] * sigma[2];
  t62 = rho[1] * rho[1];
  t63 = t62 * t62;
  t64 = t63 * rho[1];
  t65 = POW_1_3(rho[1]);
  t67 = 0.1e1 / t65 / t64;
  t70 = t65 * t65;
  t74 = 0.1e1 + params->gamma * sigma[2] / t70 / t62;
  t75 = t74 * t74;
  t76 = 0.1e1 / t75;
  t79 = t29 * t61 * t67 * t76 + params->a;
  t83 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t79);
  tzk0 = t52 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t87 = t7 - t86;
  t88 = my_piecewise5(t10, 0, t14, 0, t87);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t48 / 0.8e1;
  t102 = t32 * t31;
  t104 = 0.1e1 / t34 / t102;
  t109 = params->b * t28 * params->gamma;
  t110 = t30 * sigma[0];
  t111 = t32 * t32;
  t112 = t111 * rho[0];
  t113 = 0.1e1 / t112;
  t116 = 0.1e1 / t44 / t43;
  t120 = -0.16e2 / 0.3e1 * t29 * t30 * t104 * t45 + 0.16e2 / 0.3e1 * t109 * t110 * t113 * t116;
  t125 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t48 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t120);
  t127 = my_piecewise5(t14, 0, t10, 0, -t87);
  t130 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t127);
  t131 = t130 * t26;
  t135 = t59 * t97;
  t138 = t5 * t135 * t79 / 0.8e1;
  t140 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t79 - t138);
  tvrho0 = t52 + t83 + t6 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t7 - t86;
  t144 = my_piecewise5(t10, 0, t14, 0, t143);
  t147 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t144);
  t148 = t147 * t26;
  t153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t48 - t101);
  t155 = my_piecewise5(t14, 0, t10, 0, -t143);
  t158 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t155);
  t159 = t158 * t26;
  t163 = t63 * t62;
  t165 = 0.1e1 / t65 / t163;
  t169 = t61 * sigma[2];
  t170 = t63 * t63;
  t171 = t170 * rho[1];
  t172 = 0.1e1 / t171;
  t175 = 0.1e1 / t75 / t74;
  t179 = 0.16e2 / 0.3e1 * t109 * t169 * t172 * t175 - 0.16e2 / 0.3e1 * t29 * t61 * t165 * t76;
  t184 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t79 - t138 - 0.3e1 / 0.8e1 * t5 * t60 * t179);
  tvrho1 = t52 + t83 + t6 * (t153 + t184);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t190 = 0.1e1 / t111;
  t195 = -0.2e1 * t109 * t30 * t190 * t116 + 0.2e1 * t29 * sigma[0] * t36 * t45;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t195);
  tvsigma0 = t6 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t203 = 0.1e1 / t170;
  t208 = -0.2e1 * t109 * t61 * t203 * t175 + 0.2e1 * t29 * sigma[2] * t67 * t76;
  t212 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t208);
  tvsigma2 = t6 * t212;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t215 = t23 * t23;
  t216 = 0.1e1 / t215;
  t217 = t88 * t88;
  t220 = t84 * t6;
  t221 = 0.1e1 / t220;
  t222 = t16 * t221;
  t224 = -0.2e1 * t85 + 0.2e1 * t222;
  t225 = my_piecewise5(t10, 0, t14, 0, t224);
  t229 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t217 + 0.4e1 / 0.3e1 * t23 * t225);
  t230 = t229 * t26;
  t234 = t91 * t97;
  t236 = t5 * t234 * t48;
  t242 = 0.1e1 / t96 / t6;
  t243 = t25 * t242;
  t246 = t5 * t243 * t48 / 0.12e2;
  t248 = t5 * t98 * t120;
  t250 = t31 * rho[0];
  t251 = t32 * t250;
  t253 = 0.1e1 / t34 / t251;
  t258 = t111 * t31;
  t259 = 0.1e1 / t258;
  t264 = t28 * t28;
  t265 = params->b * t264;
  t266 = t30 * t30;
  t267 = t111 * t32;
  t269 = 0.1e1 / t39 / t267;
  t271 = t44 * t44;
  t272 = 0.1e1 / t271;
  t276 = 0.304e3 / 0.9e1 * t29 * t30 * t253 * t45 - 0.688e3 / 0.9e1 * t109 * t110 * t259 * t116 + 0.128e3 / 0.3e1 * t265 * t266 * t269 * t272;
  t281 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t48 - t236 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t120 + t246 - t248 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t276);
  t282 = t57 * t57;
  t283 = 0.1e1 / t282;
  t284 = t127 * t127;
  t288 = my_piecewise5(t14, 0, t10, 0, -t224);
  t292 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t284 + 0.4e1 / 0.3e1 * t57 * t288);
  t293 = t292 * t26;
  t297 = t130 * t97;
  t299 = t5 * t297 * t79;
  t301 = t59 * t242;
  t304 = t5 * t301 * t79 / 0.12e2;
  t306 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t79 - t299 / 0.4e1 + t304);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t6 * (t281 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t216 * t144;
  t312 = 0.2e1 * t222;
  t313 = my_piecewise5(t10, 0, t14, 0, t312);
  t317 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t309 * t88 + 0.4e1 / 0.3e1 * t23 * t313);
  t318 = t317 * t26;
  t322 = t147 * t97;
  t324 = t5 * t322 * t48;
  t332 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t48 - t324 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t120 - t236 / 0.8e1 + t246 - t248 / 0.8e1);
  t333 = t283 * t155;
  t336 = my_piecewise5(t14, 0, t10, 0, -t312);
  t340 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t333 * t127 + 0.4e1 / 0.3e1 * t57 * t336);
  t341 = t340 * t26;
  t345 = t158 * t97;
  t347 = t5 * t345 * t79;
  t354 = t5 * t135 * t179;
  t357 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t79 - t347 / 0.8e1 - t299 / 0.8e1 + t304 - 0.3e1 / 0.8e1 * t5 * t131 * t179 - t354 / 0.8e1);
  tv2rho21 = t125 + t140 + t153 + t184 + t6 * (t332 + t357);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t362 = t144 * t144;
  t366 = 0.2e1 * t85 + 0.2e1 * t222;
  t367 = my_piecewise5(t10, 0, t14, 0, t366);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t362 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t371 * t26;
  t378 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t48 - t324 / 0.4e1 + t246);
  t379 = t155 * t155;
  t383 = my_piecewise5(t14, 0, t10, 0, -t366);
  t387 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t379 + 0.4e1 / 0.3e1 * t57 * t383);
  t388 = t387 * t26;
  t397 = t62 * rho[1];
  t398 = t63 * t397;
  t400 = 0.1e1 / t65 / t398;
  t405 = t170 * t62;
  t406 = 0.1e1 / t405;
  t411 = t61 * t61;
  t412 = t170 * t63;
  t414 = 0.1e1 / t70 / t412;
  t416 = t75 * t75;
  t417 = 0.1e1 / t416;
  t421 = 0.304e3 / 0.9e1 * t29 * t61 * t400 * t76 - 0.688e3 / 0.9e1 * t109 * t169 * t406 * t175 + 0.128e3 / 0.3e1 * t265 * t411 * t414 * t417;
  t426 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t79 - t347 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t179 + t304 - t354 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * t421);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t184 + t6 * (t378 + t426);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t434 = t5 * t98 * t195 / 0.8e1;
  t443 = t111 * t250;
  t445 = 0.1e1 / t39 / t443;
  t450 = -0.32e2 / 0.3e1 * t29 * sigma[0] * t104 * t45 + 0.8e2 / 0.3e1 * t109 * t30 * t113 * t116 - 0.16e2 * t265 * t110 * t445 * t272;
  t455 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t195 - t434 - 0.3e1 / 0.8e1 * t5 * t27 * t450);
  tv2rhosigma0 = t6 * t455 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t462 = t5 * t135 * t208 / 0.8e1;
  t464 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t208 - t462);
  tv2rhosigma2 = t6 * t464 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t470 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t195 - t434);
  tv2rhosigma3 = t6 * t470 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t483 = t170 * t397;
  t485 = 0.1e1 / t70 / t483;
  t490 = -0.32e2 / 0.3e1 * t29 * sigma[2] * t165 * t76 + 0.8e2 / 0.3e1 * t109 * t61 * t172 * t175 - 0.16e2 * t265 * t169 * t485 * t417;
  t495 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t208 - t462 - 0.3e1 / 0.8e1 * t5 * t60 * t490);
  tv2rhosigma5 = t6 * t495 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t505 = 0.1e1 / t39 / t258;
  t510 = -0.8e1 * t109 * sigma[0] * t190 * t116 + 0.6e1 * t265 * t30 * t505 * t272 + 0.2e1 * t29 * t36 * t45;
  t514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t510);
  tv2sigma20 = t6 * t514;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t523 = 0.1e1 / t70 / t405;
  t528 = -0.8e1 * t109 * sigma[2] * t203 * t175 + 0.6e1 * t265 * t61 * t523 * t417 + 0.2e1 * t29 * t67 * t76;
  t532 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t528);
  tv2sigma25 = t6 * t532;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t536 = 0.1e1 / t215 / t19;
  t537 = t217 * t88;
  t540 = t216 * t88;
  t543 = t84 * t84;
  t544 = 0.1e1 / t543;
  t545 = t16 * t544;
  t547 = 0.6e1 * t221 - 0.6e1 * t545;
  t548 = my_piecewise5(t10, 0, t14, 0, t547);
  t552 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t536 * t537 + 0.4e1 / 0.3e1 * t540 * t225 + 0.4e1 / 0.3e1 * t23 * t548);
  t553 = t552 * t26;
  t557 = t229 * t97;
  t559 = t5 * t557 * t48;
  t564 = t91 * t242;
  t566 = t5 * t564 * t48;
  t569 = t5 * t234 * t120;
  t575 = 0.1e1 / t96 / t84;
  t576 = t25 * t575;
  t579 = 0.5e1 / 0.36e2 * t5 * t576 * t48;
  t581 = t5 * t243 * t120;
  t584 = t5 * t98 * t276;
  t587 = 0.1e1 / t34 / t111;
  t592 = 0.1e1 / t443;
  t597 = t111 * t33;
  t599 = 0.1e1 / t39 / t597;
  t605 = params->b * t264 * params->gamma;
  t606 = t266 * sigma[0];
  t607 = t111 * t111;
  t609 = 0.1e1 / t34 / t607;
  t612 = 0.1e1 / t271 / t43;
  t616 = -0.6688e4 / 0.27e2 * t29 * t30 * t587 * t45 + 0.25504e5 / 0.27e2 * t109 * t110 * t592 * t116 - 0.1152e4 * t265 * t266 * t599 * t272 + 0.4096e4 / 0.9e1 * t605 * t606 * t609 * t612;
  t621 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t553 * t48 - 0.3e1 / 0.8e1 * t559 - 0.9e1 / 0.8e1 * t5 * t230 * t120 + t566 / 0.4e1 - 0.3e1 / 0.4e1 * t569 - 0.9e1 / 0.8e1 * t5 * t92 * t276 - t579 + t581 / 0.4e1 - 0.3e1 / 0.8e1 * t584 - 0.3e1 / 0.8e1 * t5 * t27 * t616);
  t623 = 0.1e1 / t282 / t55;
  t624 = t284 * t127;
  t627 = t283 * t127;
  t631 = my_piecewise5(t14, 0, t10, 0, -t547);
  t635 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t623 * t624 + 0.4e1 / 0.3e1 * t627 * t288 + 0.4e1 / 0.3e1 * t57 * t631);
  t636 = t635 * t26;
  t640 = t292 * t97;
  t642 = t5 * t640 * t79;
  t644 = t130 * t242;
  t646 = t5 * t644 * t79;
  t648 = t59 * t575;
  t651 = 0.5e1 / 0.36e2 * t5 * t648 * t79;
  t653 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t636 * t79 - 0.3e1 / 0.8e1 * t642 + t646 / 0.4e1 - t651);
  tv3rho30 = 0.3e1 * t281 + 0.3e1 * t306 + t6 * (t621 + t653);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t656 = 0.2e1 * t332;
  t657 = 0.2e1 * t357;
  t658 = t536 * t144;
  t661 = t216 * t313;
  t666 = 0.2e1 * t221;
  t667 = 0.6e1 * t545;
  t668 = t666 - t667;
  t669 = my_piecewise5(t10, 0, t14, 0, t668);
  t673 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t658 * t217 + 0.8e1 / 0.9e1 * t661 * t88 + 0.4e1 / 0.9e1 * t309 * t225 + 0.4e1 / 0.3e1 * t23 * t669);
  t674 = t673 * t26;
  t678 = t317 * t97;
  t681 = t5 * t678 * t48 / 0.4e1;
  t685 = t147 * t242;
  t687 = t5 * t685 * t48;
  t691 = t5 * t322 * t120 / 0.4e1;
  t700 = -0.3e1 / 0.8e1 * t5 * t674 * t48 - t681 - 0.3e1 / 0.4e1 * t5 * t318 * t120 + t687 / 0.12e2 - t691 - 0.3e1 / 0.8e1 * t5 * t148 * t276 - t559 / 0.8e1 + t566 / 0.6e1 - t569 / 0.4e1 - t579 + t581 / 0.6e1 - t584 / 0.8e1;
  t701 = my_piecewise3(t1, 0, t700);
  t702 = t623 * t155;
  t705 = t283 * t336;
  t711 = my_piecewise5(t14, 0, t10, 0, -t668);
  t715 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t702 * t284 + 0.8e1 / 0.9e1 * t705 * t127 + 0.4e1 / 0.9e1 * t333 * t288 + 0.4e1 / 0.3e1 * t57 * t711);
  t716 = t715 * t26;
  t720 = t340 * t97;
  t723 = t5 * t720 * t79 / 0.4e1;
  t724 = t158 * t242;
  t726 = t5 * t724 * t79;
  t735 = t5 * t297 * t179 / 0.4e1;
  t737 = t5 * t301 * t179;
  t740 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t716 * t79 - t723 + t726 / 0.12e2 - t642 / 0.8e1 + t646 / 0.6e1 - t651 - 0.3e1 / 0.8e1 * t5 * t293 * t179 - t735 + t737 / 0.12e2);
  tv3rho31 = t281 + t306 + t656 + t657 + t6 * (t701 + t740);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t743 = t536 * t362;
  t748 = t216 * t367;
  t751 = -t666 - t667;
  t752 = my_piecewise5(t10, 0, t14, 0, t751);
  t756 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t743 * t88 + 0.8e1 / 0.9e1 * t309 * t313 + 0.4e1 / 0.9e1 * t748 * t88 + 0.4e1 / 0.3e1 * t23 * t752);
  t757 = t756 * t26;
  t761 = t371 * t97;
  t763 = t5 * t761 * t48;
  t772 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t757 * t48 - t763 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t372 * t120 - t681 + t687 / 0.6e1 - t691 + t566 / 0.12e2 - t579 + t581 / 0.12e2);
  t773 = t623 * t379;
  t778 = t283 * t383;
  t782 = my_piecewise5(t14, 0, t10, 0, -t751);
  t786 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t773 * t127 + 0.8e1 / 0.9e1 * t333 * t336 + 0.4e1 / 0.9e1 * t778 * t127 + 0.4e1 / 0.3e1 * t57 * t782);
  t787 = t786 * t26;
  t791 = t387 * t97;
  t793 = t5 * t791 * t79;
  t800 = t5 * t345 * t179;
  t808 = t5 * t135 * t421;
  t810 = -0.3e1 / 0.8e1 * t5 * t787 * t79 - t793 / 0.8e1 - t723 + t726 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t341 * t179 - t800 / 0.4e1 + t646 / 0.12e2 - t651 - t735 + t737 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t131 * t421 - t808 / 0.8e1;
  t811 = my_piecewise3(t53, 0, t810);
  tv3rho32 = t656 + t657 + t378 + t426 + t6 * (t772 + t811);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t816 = t362 * t144;
  t822 = -0.6e1 * t221 - 0.6e1 * t545;
  t823 = my_piecewise5(t10, 0, t14, 0, t822);
  t827 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t536 * t816 + 0.4e1 / 0.3e1 * t309 * t367 + 0.4e1 / 0.3e1 * t23 * t823);
  t828 = t827 * t26;
  t835 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t828 * t48 - 0.3e1 / 0.8e1 * t763 + t687 / 0.4e1 - t579);
  t836 = t379 * t155;
  t842 = my_piecewise5(t14, 0, t10, 0, -t822);
  t846 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t623 * t836 + 0.4e1 / 0.3e1 * t333 * t383 + 0.4e1 / 0.3e1 * t57 * t842);
  t847 = t846 * t26;
  t863 = 0.1e1 / t65 / t170;
  t868 = 0.1e1 / t483;
  t873 = t170 * t64;
  t875 = 0.1e1 / t70 / t873;
  t880 = t411 * sigma[2];
  t881 = t170 * t170;
  t883 = 0.1e1 / t65 / t881;
  t886 = 0.1e1 / t416 / t74;
  t890 = -0.6688e4 / 0.27e2 * t29 * t61 * t863 * t76 + 0.25504e5 / 0.27e2 * t109 * t169 * t868 * t175 - 0.1152e4 * t265 * t411 * t875 * t417 + 0.4096e4 / 0.9e1 * t605 * t880 * t883 * t886;
  t895 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t847 * t79 - 0.3e1 / 0.8e1 * t793 - 0.9e1 / 0.8e1 * t5 * t388 * t179 + t726 / 0.4e1 - 0.3e1 / 0.4e1 * t800 - 0.9e1 / 0.8e1 * t5 * t159 * t421 - t651 + t737 / 0.4e1 - 0.3e1 / 0.8e1 * t808 - 0.3e1 / 0.8e1 * t5 * t60 * t890);
  tv3rho33 = 0.3e1 * t378 + 0.3e1 * t426 + t6 * (t835 + t895);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t903 = t5 * t234 * t195;
  t910 = t5 * t243 * t195 / 0.12e2;
  t912 = t5 * t98 * t450;
  t928 = 0.1e1 / t34 / t111 / t251;
  t933 = 0.608e3 / 0.9e1 * t29 * sigma[0] * t253 * t45 - 0.2672e4 / 0.9e1 * t109 * t30 * t259 * t116 + 0.4e3 * t265 * t110 * t269 * t272 - 0.512e3 / 0.3e1 * t605 * t266 * t928 * t612;
  t938 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t195 - t903 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t450 + t910 - t912 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t933);
  tv3rho2sigma0 = t6 * t938 + 0.2e1 * t455;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t945 = t5 * t297 * t208;
  t949 = t5 * t301 * t208 / 0.12e2;
  t951 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t208 - t945 / 0.4e1 + t949);
  tv3rho2sigma2 = t6 * t951 + 0.2e1 * t464;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t957 = t5 * t322 * t195;
  t965 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t195 - t957 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t450 - t903 / 0.8e1 + t910 - t912 / 0.8e1);
  tv3rho2sigma3 = t6 * t965 + t455 + t470;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t971 = t5 * t345 * t208;
  t978 = t5 * t135 * t490;
  t981 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t208 - t971 / 0.8e1 - t945 / 0.8e1 + t949 - 0.3e1 / 0.8e1 * t5 * t131 * t490 - t978 / 0.8e1);
  tv3rho2sigma5 = t6 * t981 + t464 + t495;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t989 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t195 - t957 / 0.4e1 + t910);
  tv3rho2sigma6 = t6 * t989 + 0.2e1 * t470;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1014 = 0.1e1 / t65 / t170 / t398;
  t1019 = 0.608e3 / 0.9e1 * t29 * sigma[2] * t400 * t76 - 0.2672e4 / 0.9e1 * t109 * t61 * t406 * t175 + 0.4e3 * t265 * t169 * t414 * t417 - 0.512e3 / 0.3e1 * t605 * t411 * t1014 * t886;
  t1024 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t208 - t971 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t490 + t949 - t978 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * t1019);
  tv3rho2sigma8 = t6 * t1024 + 0.2e1 * t495;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1031 = t5 * t98 * t510 / 0.8e1;
  t1035 = t113 * t116;
  t1043 = t111 * t102;
  t1045 = 0.1e1 / t34 / t1043;
  t1050 = -0.32e2 / 0.3e1 * t29 * t104 * t45 + 0.224e3 / 0.3e1 * t109 * t1035 * sigma[0] - 0.128e3 * t265 * t30 * t445 * t272 + 0.64e2 * t605 * t110 * t1045 * t612;
  t1055 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t510 - t1031 - 0.3e1 / 0.8e1 * t5 * t27 * t1050);
  tv3rhosigma20 = t6 * t1055 + t514;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1062 = t5 * t135 * t528 / 0.8e1;
  t1064 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t528 - t1062);
  tv3rhosigma25 = t6 * t1064 + t532;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t510 - t1031);
  tv3rhosigma26 = t6 * t1070 + t514;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1078 = t172 * t175;
  t1086 = t170 * t163;
  t1088 = 0.1e1 / t65 / t1086;
  t1093 = -0.32e2 / 0.3e1 * t29 * t165 * t76 + 0.224e3 / 0.3e1 * t109 * t1078 * sigma[2] - 0.128e3 * t265 * t61 * t485 * t417 + 0.64e2 * t605 * t169 * t1088 * t886;
  t1098 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t528 - t1062 - 0.3e1 / 0.8e1 * t5 * t60 * t1093);
  tv3rhosigma211 = t6 * t1098 + t532;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1108 = 0.1e1 / t34 / t597;
  t1113 = -0.24e2 * t605 * t30 * t1108 * t612 + 0.36e2 * t265 * sigma[0] * t505 * t272 - 0.12e2 * t109 * t190 * t116;
  t1117 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1113);
  tv3sigma30 = t6 * t1117;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1126 = 0.1e1 / t65 / t873;
  t1131 = -0.24e2 * t605 * t61 * t1126 * t886 + 0.36e2 * t265 * sigma[2] * t523 * t417 - 0.12e2 * t109 * t203 * t175;
  t1135 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t1131);
  tv3sigma39 = t6 * t1135;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t39, t43, t44;
  double t45, t48, t52, t53, t54, t55, t56, t57;
  double t59, t60, t61, t62, t63, t64, t65, t67;
  double t70, t74, t75, t76, t79, t83, tzk0;

  double t84, t85, t86, t87, t88, t91, t92, t96;
  double t97, t98, t101, t102, t104, t109, t110, t111;
  double t112, t113, t116, t120, t125, t127, t130, t131;
  double t135, t138, t140, tvrho0, t143, t144, t147, t148;
  double t153, t155, t158, t159, t163, t165, t169, t170;
  double t171, t172, t175, t179, t184, tvrho1, t190, t195;
  double t199, tvsigma0, tvsigma1, t203, t208, t212, tvsigma2;

  double t215, t216, t217, t220, t221, t222, t224, t225;
  double t229, t230, t234, t236, t242, t243, t246, t248;
  double t250, t251, t253, t258, t259, t264, t265, t266;
  double t267, t269, t271, t272, t276, t281, t282, t283;
  double t284, t288, t292, t293, t297, t299, t301, t304;
  double t306, tv2rho20, t309, t312, t313, t317, t318, t322;
  double t324, t332, t333, t336, t340, t341, t345, t347;
  double t354, t357, tv2rho21, t362, t366, t367, t371, t372;
  double t378, t379, t383, t387, t388, t397, t398, t400;
  double t405, t406, t411, t412, t414, t416, t417, t421;
  double t426, tv2rho22, t434, t443, t445, t450, t455, tv2rhosigma0;
  double tv2rhosigma1, t462, t464, tv2rhosigma2, t470, tv2rhosigma3, tv2rhosigma4, t483;
  double t485, t490, t495, tv2rhosigma5, t505, t510, t514, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t523, t528, t532, tv2sigma25;

  double t536, t537, t540, t543, t544, t545, t547, t548;
  double t552, t553, t557, t559, t564, t566, t569, t575;
  double t576, t579, t581, t584, t587, t592, t597, t599;
  double t605, t606, t607, t609, t612, t616, t621, t623;
  double t624, t627, t631, t635, t636, t640, t642, t644;
  double t646, t648, t651, t653, tv3rho30, t656, t657, t658;
  double t661, t666, t667, t668, t669, t673, t674, t678;
  double t681, t685, t687, t691, t700, t701, t702, t705;
  double t711, t715, t716, t720, t723, t724, t726, t735;
  double t737, t740, tv3rho31, t743, t748, t751, t752, t756;
  double t757, t761, t763, t772, t773, t778, t782, t786;
  double t787, t791, t793, t800, t808, t810, t811, tv3rho32;
  double t816, t822, t823, t827, t828, t835, t836, t842;
  double t846, t847, t863, t868, t873, t875, t880, t881;
  double t883, t886, t890, t895, tv3rho33, t903, t910, t912;
  double t928, t933, t938, tv3rho2sigma0, tv3rho2sigma1, t945, t949, t951;
  double tv3rho2sigma2, t957, t965, tv3rho2sigma3, tv3rho2sigma4, t971, t978, t981;
  double tv3rho2sigma5, t989, tv3rho2sigma6, tv3rho2sigma7, t1014, t1019, t1024, tv3rho2sigma8;
  double t1031, t1035, t1043, t1045, t1050, t1055, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1062, t1064, tv3rhosigma25, t1070, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1078, t1086, t1088, t1093;
  double t1098, tv3rhosigma211, t1108, t1113, t1117, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1126, t1131;
  double t1135, tv3sigma39;

  double t1140, t1144, t1148, t1151, t1155, t1156, t1158, t1159;
  double t1165, t1172, t1174, t1175, t1179, t1188, t1194, t1196;
  double t1202, t1205, t1208, t1227, t1235, t1241, t1249, t1250;
  double t1251, t1253, t1254, t1260, t1266, t1270, t1277, t1281;
  double t1285, t1290, t1292, tv4rho40, t1299, t1303, t1307, t1308;
  double t1331, t1332, t1333, t1334, t1338, t1347, t1353, t1354;
  double t1356, t1364, t1365, t1383, t1387, t1394, t1398, t1399;
  double t1402, t1411, t1414, t1415, t1417, t1419, t1420, tv4rho41;
  double t1429, t1433, t1448, t1461, t1465, t1474, t1485, t1486;
  double t1495, t1508, t1512, t1519, t1523, t1532, t1535, t1546;
  double t1549, t1551, t1552, tv4rho42, t1572, t1573, t1577, t1584;
  double t1595, t1596, t1613, t1617, t1624, t1632, t1641, t1651;
  double t1653, t1654, tv4rho43, t1659, t1664, t1670, t1671, t1675;
  double t1684, t1693, t1698, t1704, t1708, t1739, t1751, t1759;
  double t1760, tv4rho44, t1768, t1774, t1777, t1784, t1786, t1789;
  double t1818, tv4rho3sigma0, tv4rho3sigma1, t1825, t1828, t1832, t1834, tv4rho3sigma2;
  double t1836, t1842, t1847, t1851, t1860, t1861, tv4rho3sigma3, tv4rho3sigma4;
  double t1863, t1869, t1871, t1880, t1882, t1885, tv4rho3sigma5, t1891;
  double t1900, tv4rho3sigma6, tv4rho3sigma7, t1906, t1913, t1921, t1923, t1924;
  double tv4rho3sigma8, t1933, tv4rho3sigma9, tv4rho3sigma10, t1977, tv4rho3sigma11, t1984, t1991;
  double t1993, t2021, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2028;
  double t2032, t2034, tv4rho2sigma25, t2040, t2048, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t2054, t2061, t2064, tv4rho2sigma211, t2072, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2109, tv4rho2sigma217, t2116, t2137;
  double tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37;
  double tv4rhosigma38, t2144, t2146, tv4rhosigma39, t2152, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312;
  double tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2177, tv4rhosigma319;
  double t2195, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46;
  double tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t2212;
  double tv4sigma414;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = my_piecewise5(t14, t11, t10, t15, -t17);
  t55 = 0.1e1 + t54;
  t56 = t55 <= p->zeta_threshold;
  t57 = POW_1_3(t55);
  t59 = my_piecewise3(t56, t22, t57 * t55);
  t60 = t59 * t26;
  t61 = sigma[2] * sigma[2];
  t62 = rho[1] * rho[1];
  t63 = t62 * t62;
  t64 = t63 * rho[1];
  t65 = POW_1_3(rho[1]);
  t67 = 0.1e1 / t65 / t64;
  t70 = t65 * t65;
  t74 = 0.1e1 + params->gamma * sigma[2] / t70 / t62;
  t75 = t74 * t74;
  t76 = 0.1e1 / t75;
  t79 = t29 * t61 * t67 * t76 + params->a;
  t83 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t79);
  tzk0 = t52 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t87 = t7 - t86;
  t88 = my_piecewise5(t10, 0, t14, 0, t87);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t48 / 0.8e1;
  t102 = t32 * t31;
  t104 = 0.1e1 / t34 / t102;
  t109 = params->b * t28 * params->gamma;
  t110 = t30 * sigma[0];
  t111 = t32 * t32;
  t112 = t111 * rho[0];
  t113 = 0.1e1 / t112;
  t116 = 0.1e1 / t44 / t43;
  t120 = -0.16e2 / 0.3e1 * t29 * t30 * t104 * t45 + 0.16e2 / 0.3e1 * t109 * t110 * t113 * t116;
  t125 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t48 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t120);
  t127 = my_piecewise5(t14, 0, t10, 0, -t87);
  t130 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t127);
  t131 = t130 * t26;
  t135 = t59 * t97;
  t138 = t5 * t135 * t79 / 0.8e1;
  t140 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t79 - t138);
  tvrho0 = t52 + t83 + t6 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t7 - t86;
  t144 = my_piecewise5(t10, 0, t14, 0, t143);
  t147 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t144);
  t148 = t147 * t26;
  t153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t48 - t101);
  t155 = my_piecewise5(t14, 0, t10, 0, -t143);
  t158 = my_piecewise3(t56, 0, 0.4e1 / 0.3e1 * t57 * t155);
  t159 = t158 * t26;
  t163 = t63 * t62;
  t165 = 0.1e1 / t65 / t163;
  t169 = t61 * sigma[2];
  t170 = t63 * t63;
  t171 = t170 * rho[1];
  t172 = 0.1e1 / t171;
  t175 = 0.1e1 / t75 / t74;
  t179 = 0.16e2 / 0.3e1 * t109 * t169 * t172 * t175 - 0.16e2 / 0.3e1 * t29 * t61 * t165 * t76;
  t184 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t79 - t138 - 0.3e1 / 0.8e1 * t5 * t60 * t179);
  tvrho1 = t52 + t83 + t6 * (t153 + t184);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t190 = 0.1e1 / t111;
  t195 = -0.2e1 * t109 * t30 * t190 * t116 + 0.2e1 * t29 * sigma[0] * t36 * t45;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t195);
  tvsigma0 = t6 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t203 = 0.1e1 / t170;
  t208 = -0.2e1 * t109 * t61 * t203 * t175 + 0.2e1 * t29 * sigma[2] * t67 * t76;
  t212 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t208);
  tvsigma2 = t6 * t212;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t215 = t23 * t23;
  t216 = 0.1e1 / t215;
  t217 = t88 * t88;
  t220 = t84 * t6;
  t221 = 0.1e1 / t220;
  t222 = t16 * t221;
  t224 = -0.2e1 * t85 + 0.2e1 * t222;
  t225 = my_piecewise5(t10, 0, t14, 0, t224);
  t229 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t217 + 0.4e1 / 0.3e1 * t23 * t225);
  t230 = t229 * t26;
  t234 = t91 * t97;
  t236 = t5 * t234 * t48;
  t242 = 0.1e1 / t96 / t6;
  t243 = t25 * t242;
  t246 = t5 * t243 * t48 / 0.12e2;
  t248 = t5 * t98 * t120;
  t250 = t31 * rho[0];
  t251 = t32 * t250;
  t253 = 0.1e1 / t34 / t251;
  t258 = t111 * t31;
  t259 = 0.1e1 / t258;
  t264 = t28 * t28;
  t265 = params->b * t264;
  t266 = t30 * t30;
  t267 = t111 * t32;
  t269 = 0.1e1 / t39 / t267;
  t271 = t44 * t44;
  t272 = 0.1e1 / t271;
  t276 = 0.304e3 / 0.9e1 * t29 * t30 * t253 * t45 - 0.688e3 / 0.9e1 * t109 * t110 * t259 * t116 + 0.128e3 / 0.3e1 * t265 * t266 * t269 * t272;
  t281 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t48 - t236 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t120 + t246 - t248 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t276);
  t282 = t57 * t57;
  t283 = 0.1e1 / t282;
  t284 = t127 * t127;
  t288 = my_piecewise5(t14, 0, t10, 0, -t224);
  t292 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t284 + 0.4e1 / 0.3e1 * t57 * t288);
  t293 = t292 * t26;
  t297 = t130 * t97;
  t299 = t5 * t297 * t79;
  t301 = t59 * t242;
  t304 = t5 * t301 * t79 / 0.12e2;
  t306 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t79 - t299 / 0.4e1 + t304);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t6 * (t281 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t216 * t144;
  t312 = 0.2e1 * t222;
  t313 = my_piecewise5(t10, 0, t14, 0, t312);
  t317 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t309 * t88 + 0.4e1 / 0.3e1 * t23 * t313);
  t318 = t317 * t26;
  t322 = t147 * t97;
  t324 = t5 * t322 * t48;
  t332 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t48 - t324 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t120 - t236 / 0.8e1 + t246 - t248 / 0.8e1);
  t333 = t283 * t155;
  t336 = my_piecewise5(t14, 0, t10, 0, -t312);
  t340 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t333 * t127 + 0.4e1 / 0.3e1 * t57 * t336);
  t341 = t340 * t26;
  t345 = t158 * t97;
  t347 = t5 * t345 * t79;
  t354 = t5 * t135 * t179;
  t357 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t79 - t347 / 0.8e1 - t299 / 0.8e1 + t304 - 0.3e1 / 0.8e1 * t5 * t131 * t179 - t354 / 0.8e1);
  tv2rho21 = t125 + t140 + t153 + t184 + t6 * (t332 + t357);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t362 = t144 * t144;
  t366 = 0.2e1 * t85 + 0.2e1 * t222;
  t367 = my_piecewise5(t10, 0, t14, 0, t366);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t216 * t362 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t371 * t26;
  t378 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t48 - t324 / 0.4e1 + t246);
  t379 = t155 * t155;
  t383 = my_piecewise5(t14, 0, t10, 0, -t366);
  t387 = my_piecewise3(t56, 0, 0.4e1 / 0.9e1 * t283 * t379 + 0.4e1 / 0.3e1 * t57 * t383);
  t388 = t387 * t26;
  t397 = t62 * rho[1];
  t398 = t63 * t397;
  t400 = 0.1e1 / t65 / t398;
  t405 = t170 * t62;
  t406 = 0.1e1 / t405;
  t411 = t61 * t61;
  t412 = t170 * t63;
  t414 = 0.1e1 / t70 / t412;
  t416 = t75 * t75;
  t417 = 0.1e1 / t416;
  t421 = 0.304e3 / 0.9e1 * t29 * t61 * t400 * t76 - 0.688e3 / 0.9e1 * t109 * t169 * t406 * t175 + 0.128e3 / 0.3e1 * t265 * t411 * t414 * t417;
  t426 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t79 - t347 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t179 + t304 - t354 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * t421);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t184 + t6 * (t378 + t426);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t434 = t5 * t98 * t195 / 0.8e1;
  t443 = t111 * t250;
  t445 = 0.1e1 / t39 / t443;
  t450 = -0.32e2 / 0.3e1 * t29 * sigma[0] * t104 * t45 + 0.8e2 / 0.3e1 * t109 * t30 * t113 * t116 - 0.16e2 * t265 * t110 * t445 * t272;
  t455 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t195 - t434 - 0.3e1 / 0.8e1 * t5 * t27 * t450);
  tv2rhosigma0 = t6 * t455 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t462 = t5 * t135 * t208 / 0.8e1;
  t464 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t208 - t462);
  tv2rhosigma2 = t6 * t464 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t470 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t195 - t434);
  tv2rhosigma3 = t6 * t470 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t483 = t170 * t397;
  t485 = 0.1e1 / t70 / t483;
  t490 = -0.32e2 / 0.3e1 * t29 * sigma[2] * t165 * t76 + 0.8e2 / 0.3e1 * t109 * t61 * t172 * t175 - 0.16e2 * t265 * t169 * t485 * t417;
  t495 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t208 - t462 - 0.3e1 / 0.8e1 * t5 * t60 * t490);
  tv2rhosigma5 = t6 * t495 + t212;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t505 = 0.1e1 / t39 / t258;
  t510 = -0.8e1 * t109 * sigma[0] * t190 * t116 + 0.6e1 * t265 * t30 * t505 * t272 + 0.2e1 * t29 * t36 * t45;
  t514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t510);
  tv2sigma20 = t6 * t514;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t523 = 0.1e1 / t70 / t405;
  t528 = -0.8e1 * t109 * sigma[2] * t203 * t175 + 0.6e1 * t265 * t61 * t523 * t417 + 0.2e1 * t29 * t67 * t76;
  t532 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t528);
  tv2sigma25 = t6 * t532;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t536 = 0.1e1 / t215 / t19;
  t537 = t217 * t88;
  t540 = t216 * t88;
  t543 = t84 * t84;
  t544 = 0.1e1 / t543;
  t545 = t16 * t544;
  t547 = 0.6e1 * t221 - 0.6e1 * t545;
  t548 = my_piecewise5(t10, 0, t14, 0, t547);
  t552 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t536 * t537 + 0.4e1 / 0.3e1 * t540 * t225 + 0.4e1 / 0.3e1 * t23 * t548);
  t553 = t552 * t26;
  t557 = t229 * t97;
  t559 = t5 * t557 * t48;
  t564 = t91 * t242;
  t566 = t5 * t564 * t48;
  t569 = t5 * t234 * t120;
  t575 = 0.1e1 / t96 / t84;
  t576 = t25 * t575;
  t579 = 0.5e1 / 0.36e2 * t5 * t576 * t48;
  t581 = t5 * t243 * t120;
  t584 = t5 * t98 * t276;
  t587 = 0.1e1 / t34 / t111;
  t592 = 0.1e1 / t443;
  t597 = t111 * t33;
  t599 = 0.1e1 / t39 / t597;
  t605 = params->b * t264 * params->gamma;
  t606 = t266 * sigma[0];
  t607 = t111 * t111;
  t609 = 0.1e1 / t34 / t607;
  t612 = 0.1e1 / t271 / t43;
  t616 = -0.6688e4 / 0.27e2 * t29 * t30 * t587 * t45 + 0.25504e5 / 0.27e2 * t109 * t110 * t592 * t116 - 0.1152e4 * t265 * t266 * t599 * t272 + 0.4096e4 / 0.9e1 * t605 * t606 * t609 * t612;
  t621 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t553 * t48 - 0.3e1 / 0.8e1 * t559 - 0.9e1 / 0.8e1 * t5 * t230 * t120 + t566 / 0.4e1 - 0.3e1 / 0.4e1 * t569 - 0.9e1 / 0.8e1 * t5 * t92 * t276 - t579 + t581 / 0.4e1 - 0.3e1 / 0.8e1 * t584 - 0.3e1 / 0.8e1 * t5 * t27 * t616);
  t623 = 0.1e1 / t282 / t55;
  t624 = t284 * t127;
  t627 = t283 * t127;
  t631 = my_piecewise5(t14, 0, t10, 0, -t547);
  t635 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t623 * t624 + 0.4e1 / 0.3e1 * t627 * t288 + 0.4e1 / 0.3e1 * t57 * t631);
  t636 = t635 * t26;
  t640 = t292 * t97;
  t642 = t5 * t640 * t79;
  t644 = t130 * t242;
  t646 = t5 * t644 * t79;
  t648 = t59 * t575;
  t651 = 0.5e1 / 0.36e2 * t5 * t648 * t79;
  t653 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t636 * t79 - 0.3e1 / 0.8e1 * t642 + t646 / 0.4e1 - t651);
  tv3rho30 = 0.3e1 * t281 + 0.3e1 * t306 + t6 * (t621 + t653);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t656 = 0.2e1 * t332;
  t657 = 0.2e1 * t357;
  t658 = t536 * t144;
  t661 = t216 * t313;
  t666 = 0.2e1 * t221;
  t667 = 0.6e1 * t545;
  t668 = t666 - t667;
  t669 = my_piecewise5(t10, 0, t14, 0, t668);
  t673 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t658 * t217 + 0.8e1 / 0.9e1 * t661 * t88 + 0.4e1 / 0.9e1 * t309 * t225 + 0.4e1 / 0.3e1 * t23 * t669);
  t674 = t673 * t26;
  t678 = t317 * t97;
  t681 = t5 * t678 * t48 / 0.4e1;
  t685 = t147 * t242;
  t687 = t5 * t685 * t48;
  t691 = t5 * t322 * t120 / 0.4e1;
  t700 = -0.3e1 / 0.8e1 * t5 * t674 * t48 - t681 - 0.3e1 / 0.4e1 * t5 * t318 * t120 + t687 / 0.12e2 - t691 - 0.3e1 / 0.8e1 * t5 * t148 * t276 - t559 / 0.8e1 + t566 / 0.6e1 - t569 / 0.4e1 - t579 + t581 / 0.6e1 - t584 / 0.8e1;
  t701 = my_piecewise3(t1, 0, t700);
  t702 = t623 * t155;
  t705 = t283 * t336;
  t711 = my_piecewise5(t14, 0, t10, 0, -t668);
  t715 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t702 * t284 + 0.8e1 / 0.9e1 * t705 * t127 + 0.4e1 / 0.9e1 * t333 * t288 + 0.4e1 / 0.3e1 * t57 * t711);
  t716 = t715 * t26;
  t720 = t340 * t97;
  t723 = t5 * t720 * t79 / 0.4e1;
  t724 = t158 * t242;
  t726 = t5 * t724 * t79;
  t735 = t5 * t297 * t179 / 0.4e1;
  t737 = t5 * t301 * t179;
  t740 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t716 * t79 - t723 + t726 / 0.12e2 - t642 / 0.8e1 + t646 / 0.6e1 - t651 - 0.3e1 / 0.8e1 * t5 * t293 * t179 - t735 + t737 / 0.12e2);
  tv3rho31 = t281 + t306 + t656 + t657 + t6 * (t701 + t740);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t743 = t536 * t362;
  t748 = t216 * t367;
  t751 = -t666 - t667;
  t752 = my_piecewise5(t10, 0, t14, 0, t751);
  t756 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t743 * t88 + 0.8e1 / 0.9e1 * t309 * t313 + 0.4e1 / 0.9e1 * t748 * t88 + 0.4e1 / 0.3e1 * t23 * t752);
  t757 = t756 * t26;
  t761 = t371 * t97;
  t763 = t5 * t761 * t48;
  t772 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t757 * t48 - t763 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t372 * t120 - t681 + t687 / 0.6e1 - t691 + t566 / 0.12e2 - t579 + t581 / 0.12e2);
  t773 = t623 * t379;
  t778 = t283 * t383;
  t782 = my_piecewise5(t14, 0, t10, 0, -t751);
  t786 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t773 * t127 + 0.8e1 / 0.9e1 * t333 * t336 + 0.4e1 / 0.9e1 * t778 * t127 + 0.4e1 / 0.3e1 * t57 * t782);
  t787 = t786 * t26;
  t791 = t387 * t97;
  t793 = t5 * t791 * t79;
  t800 = t5 * t345 * t179;
  t808 = t5 * t135 * t421;
  t810 = -0.3e1 / 0.8e1 * t5 * t787 * t79 - t793 / 0.8e1 - t723 + t726 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t341 * t179 - t800 / 0.4e1 + t646 / 0.12e2 - t651 - t735 + t737 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t131 * t421 - t808 / 0.8e1;
  t811 = my_piecewise3(t53, 0, t810);
  tv3rho32 = t656 + t657 + t378 + t426 + t6 * (t772 + t811);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t816 = t362 * t144;
  t822 = -0.6e1 * t221 - 0.6e1 * t545;
  t823 = my_piecewise5(t10, 0, t14, 0, t822);
  t827 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t536 * t816 + 0.4e1 / 0.3e1 * t309 * t367 + 0.4e1 / 0.3e1 * t23 * t823);
  t828 = t827 * t26;
  t835 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t828 * t48 - 0.3e1 / 0.8e1 * t763 + t687 / 0.4e1 - t579);
  t836 = t379 * t155;
  t842 = my_piecewise5(t14, 0, t10, 0, -t822);
  t846 = my_piecewise3(t56, 0, -0.8e1 / 0.27e2 * t623 * t836 + 0.4e1 / 0.3e1 * t333 * t383 + 0.4e1 / 0.3e1 * t57 * t842);
  t847 = t846 * t26;
  t863 = 0.1e1 / t65 / t170;
  t868 = 0.1e1 / t483;
  t873 = t170 * t64;
  t875 = 0.1e1 / t70 / t873;
  t880 = t411 * sigma[2];
  t881 = t170 * t170;
  t883 = 0.1e1 / t65 / t881;
  t886 = 0.1e1 / t416 / t74;
  t890 = -0.6688e4 / 0.27e2 * t29 * t61 * t863 * t76 + 0.25504e5 / 0.27e2 * t109 * t169 * t868 * t175 - 0.1152e4 * t265 * t411 * t875 * t417 + 0.4096e4 / 0.9e1 * t605 * t880 * t883 * t886;
  t895 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t847 * t79 - 0.3e1 / 0.8e1 * t793 - 0.9e1 / 0.8e1 * t5 * t388 * t179 + t726 / 0.4e1 - 0.3e1 / 0.4e1 * t800 - 0.9e1 / 0.8e1 * t5 * t159 * t421 - t651 + t737 / 0.4e1 - 0.3e1 / 0.8e1 * t808 - 0.3e1 / 0.8e1 * t5 * t60 * t890);
  tv3rho33 = 0.3e1 * t378 + 0.3e1 * t426 + t6 * (t835 + t895);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t903 = t5 * t234 * t195;
  t910 = t5 * t243 * t195 / 0.12e2;
  t912 = t5 * t98 * t450;
  t928 = 0.1e1 / t34 / t111 / t251;
  t933 = 0.608e3 / 0.9e1 * t29 * sigma[0] * t253 * t45 - 0.2672e4 / 0.9e1 * t109 * t30 * t259 * t116 + 0.4e3 * t265 * t110 * t269 * t272 - 0.512e3 / 0.3e1 * t605 * t266 * t928 * t612;
  t938 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t195 - t903 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t450 + t910 - t912 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t933);
  tv3rho2sigma0 = t6 * t938 + 0.2e1 * t455;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t945 = t5 * t297 * t208;
  t949 = t5 * t301 * t208 / 0.12e2;
  t951 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t208 - t945 / 0.4e1 + t949);
  tv3rho2sigma2 = t6 * t951 + 0.2e1 * t464;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t957 = t5 * t322 * t195;
  t965 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t195 - t957 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t450 - t903 / 0.8e1 + t910 - t912 / 0.8e1);
  tv3rho2sigma3 = t6 * t965 + t455 + t470;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t971 = t5 * t345 * t208;
  t978 = t5 * t135 * t490;
  t981 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t208 - t971 / 0.8e1 - t945 / 0.8e1 + t949 - 0.3e1 / 0.8e1 * t5 * t131 * t490 - t978 / 0.8e1);
  tv3rho2sigma5 = t6 * t981 + t464 + t495;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t989 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t195 - t957 / 0.4e1 + t910);
  tv3rho2sigma6 = t6 * t989 + 0.2e1 * t470;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1014 = 0.1e1 / t65 / t170 / t398;
  t1019 = 0.608e3 / 0.9e1 * t29 * sigma[2] * t400 * t76 - 0.2672e4 / 0.9e1 * t109 * t61 * t406 * t175 + 0.4e3 * t265 * t169 * t414 * t417 - 0.512e3 / 0.3e1 * t605 * t411 * t1014 * t886;
  t1024 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t208 - t971 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t490 + t949 - t978 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * t1019);
  tv3rho2sigma8 = t6 * t1024 + 0.2e1 * t495;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1031 = t5 * t98 * t510 / 0.8e1;
  t1035 = t113 * t116;
  t1043 = t111 * t102;
  t1045 = 0.1e1 / t34 / t1043;
  t1050 = -0.32e2 / 0.3e1 * t29 * t104 * t45 + 0.224e3 / 0.3e1 * t109 * t1035 * sigma[0] - 0.128e3 * t265 * t30 * t445 * t272 + 0.64e2 * t605 * t110 * t1045 * t612;
  t1055 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t510 - t1031 - 0.3e1 / 0.8e1 * t5 * t27 * t1050);
  tv3rhosigma20 = t6 * t1055 + t514;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1062 = t5 * t135 * t528 / 0.8e1;
  t1064 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t528 - t1062);
  tv3rhosigma25 = t6 * t1064 + t532;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t510 - t1031);
  tv3rhosigma26 = t6 * t1070 + t514;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1078 = t172 * t175;
  t1086 = t170 * t163;
  t1088 = 0.1e1 / t65 / t1086;
  t1093 = -0.32e2 / 0.3e1 * t29 * t165 * t76 + 0.224e3 / 0.3e1 * t109 * t1078 * sigma[2] - 0.128e3 * t265 * t61 * t485 * t417 + 0.64e2 * t605 * t169 * t1088 * t886;
  t1098 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t528 - t1062 - 0.3e1 / 0.8e1 * t5 * t60 * t1093);
  tv3rhosigma211 = t6 * t1098 + t532;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1108 = 0.1e1 / t34 / t597;
  t1113 = -0.24e2 * t605 * t30 * t1108 * t612 + 0.36e2 * t265 * sigma[0] * t505 * t272 - 0.12e2 * t109 * t190 * t116;
  t1117 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1113);
  tv3sigma30 = t6 * t1117;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1126 = 0.1e1 / t65 / t873;
  t1131 = -0.24e2 * t605 * t61 * t1126 * t886 + 0.36e2 * t265 * sigma[2] * t523 * t417 - 0.12e2 * t109 * t203 * t175;
  t1135 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * t1131);
  tv3sigma39 = t6 * t1135;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1140 = t5 * t552 * t97 * t48;
  t1144 = t5 * t229 * t242 * t48;
  t1148 = t5 * t91 * t575 * t48;
  t1151 = 0.1e1 / t96 / t220;
  t1155 = 0.1e2 / 0.27e2 * t5 * t25 * t1151 * t48;
  t1156 = t19 * t19;
  t1158 = 0.1e1 / t215 / t1156;
  t1159 = t217 * t217;
  t1165 = t225 * t225;
  t1172 = t16 / t543 / t6;
  t1174 = -0.24e2 * t544 + 0.24e2 * t1172;
  t1175 = my_piecewise5(t10, 0, t14, 0, t1174);
  t1179 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1158 * t1159 - 0.16e2 / 0.9e1 * t536 * t217 * t225 + 0.4e1 / 0.3e1 * t216 * t1165 + 0.16e2 / 0.9e1 * t540 * t548 + 0.4e1 / 0.3e1 * t23 * t1175);
  t1188 = t5 * t557 * t120;
  t1194 = t5 * t564 * t120;
  t1196 = t5 * t234 * t276;
  t1202 = t5 * t576 * t120;
  t1205 = t5 * t243 * t276;
  t1208 = t5 * t98 * t616;
  t1227 = t607 * rho[0];
  t1235 = params->b * t264 * t28;
  t1241 = 0.1e1 / t271 / t44;
  t1249 = -t1140 / 0.2e1 + t1144 / 0.2e1 - 0.5e1 / 0.9e1 * t1148 + t1155 - 0.3e1 / 0.8e1 * t5 * t1179 * t26 * t48 - 0.3e1 / 0.2e1 * t5 * t553 * t120 - 0.3e1 / 0.2e1 * t1188 - 0.9e1 / 0.4e1 * t5 * t230 * t276 + t1194 - 0.3e1 / 0.2e1 * t1196 - 0.3e1 / 0.2e1 * t5 * t92 * t616 - 0.5e1 / 0.9e1 * t1202 + t1205 / 0.2e1 - t1208 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.1672e6 / 0.81e2 * t29 * t30 / t34 / t112 * t45 - 0.94864e6 / 0.81e2 * t109 * t110 / t267 * t116 + 0.62912e6 / 0.27e2 * t265 * t266 / t39 / t1043 * t272 - 0.53248e6 / 0.27e2 * t605 * t606 / t34 / t1227 * t612 + 0.16384e6 / 0.27e2 * t1235 * t266 * t30 / t607 / t32 * t1241);
  t1250 = my_piecewise3(t1, 0, t1249);
  t1251 = t55 * t55;
  t1253 = 0.1e1 / t282 / t1251;
  t1254 = t284 * t284;
  t1260 = t288 * t288;
  t1266 = my_piecewise5(t14, 0, t10, 0, -t1174);
  t1270 = my_piecewise3(t56, 0, 0.4e2 / 0.81e2 * t1253 * t1254 - 0.16e2 / 0.9e1 * t623 * t284 * t288 + 0.4e1 / 0.3e1 * t283 * t1260 + 0.16e2 / 0.9e1 * t627 * t631 + 0.4e1 / 0.3e1 * t57 * t1266);
  t1277 = t5 * t635 * t97 * t79;
  t1281 = t5 * t292 * t242 * t79;
  t1285 = t5 * t130 * t575 * t79;
  t1290 = 0.1e2 / 0.27e2 * t5 * t59 * t1151 * t79;
  t1292 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t1270 * t26 * t79 - t1277 / 0.2e1 + t1281 / 0.2e1 - 0.5e1 / 0.9e1 * t1285 + t1290);
  tv4rho40 = 0.4e1 * t621 + 0.4e1 * t653 + t6 * (t1250 + t1292);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1299 = t5 * t147 * t575 * t48;
  t1303 = t5 * t673 * t97 * t48;
  t1307 = t5 * t317 * t242 * t48;
  t1308 = t1307 / 0.4e1;
  t1331 = 0.12e2 * t544;
  t1332 = 0.24e2 * t1172;
  t1333 = -t1331 + t1332;
  t1334 = my_piecewise5(t10, 0, t14, 0, t1333);
  t1338 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1158 * t144 * t537 - 0.8e1 / 0.9e1 * t536 * t313 * t217 - 0.8e1 / 0.9e1 * t658 * t88 * t225 + 0.4e1 / 0.3e1 * t216 * t669 * t88 + 0.4e1 / 0.3e1 * t661 * t225 + 0.4e1 / 0.9e1 * t309 * t548 + 0.4e1 / 0.3e1 * t23 * t1334);
  t1347 = t5 * t678 * t120;
  t1353 = t5 * t685 * t120;
  t1354 = t1353 / 0.4e1;
  t1356 = t5 * t322 * t276;
  t1364 = -0.5e1 / 0.36e2 * t1299 - 0.3e1 / 0.8e1 * t1303 + t1308 - t1140 / 0.8e1 + t1144 / 0.4e1 - 0.5e1 / 0.12e2 * t1148 + t1155 - 0.3e1 / 0.8e1 * t5 * t148 * t616 - 0.3e1 / 0.8e1 * t5 * t1338 * t26 * t48 - 0.9e1 / 0.8e1 * t5 * t674 * t120 - 0.3e1 / 0.4e1 * t1347 - 0.9e1 / 0.8e1 * t5 * t318 * t276 + t1354 - 0.3e1 / 0.8e1 * t1356 - 0.3e1 / 0.8e1 * t1188 + t1194 / 0.2e1 - 0.3e1 / 0.8e1 * t1196 - 0.5e1 / 0.12e2 * t1202 + t1205 / 0.4e1 - t1208 / 0.8e1;
  t1365 = my_piecewise3(t1, 0, t1364);
  t1383 = my_piecewise5(t14, 0, t10, 0, -t1333);
  t1387 = my_piecewise3(t56, 0, 0.4e2 / 0.81e2 * t1253 * t155 * t624 - 0.8e1 / 0.9e1 * t623 * t336 * t284 - 0.8e1 / 0.9e1 * t702 * t127 * t288 + 0.4e1 / 0.3e1 * t283 * t711 * t127 + 0.4e1 / 0.3e1 * t705 * t288 + 0.4e1 / 0.9e1 * t333 * t631 + 0.4e1 / 0.3e1 * t57 * t1383);
  t1394 = t5 * t715 * t97 * t79;
  t1398 = t5 * t340 * t242 * t79;
  t1399 = t1398 / 0.4e1;
  t1402 = t5 * t158 * t575 * t79;
  t1411 = t5 * t640 * t179;
  t1414 = t5 * t644 * t179;
  t1415 = t1414 / 0.4e1;
  t1417 = t5 * t648 * t179;
  t1419 = -0.3e1 / 0.8e1 * t5 * t1387 * t26 * t79 - 0.3e1 / 0.8e1 * t1394 + t1399 - 0.5e1 / 0.36e2 * t1402 - t1277 / 0.8e1 + t1281 / 0.4e1 - 0.5e1 / 0.12e2 * t1285 + t1290 - 0.3e1 / 0.8e1 * t5 * t636 * t179 - 0.3e1 / 0.8e1 * t1411 + t1415 - 0.5e1 / 0.36e2 * t1417;
  t1420 = my_piecewise3(t53, 0, t1419);
  tv4rho41 = t621 + t653 + 0.3e1 * t701 + 0.3e1 * t740 + t6 * (t1365 + t1420);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1429 = t5 * t756 * t97 * t48;
  t1433 = t5 * t371 * t242 * t48;
  t1448 = t313 * t313;
  t1461 = my_piecewise5(t10, 0, t14, 0, t1332);
  t1465 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1158 * t362 * t217 - 0.32e2 / 0.27e2 * t658 * t88 * t313 - 0.8e1 / 0.27e2 * t743 * t225 + 0.8e1 / 0.9e1 * t216 * t1448 + 0.8e1 / 0.9e1 * t309 * t669 - 0.8e1 / 0.27e2 * t536 * t367 * t217 + 0.8e1 / 0.9e1 * t216 * t752 * t88 + 0.4e1 / 0.9e1 * t748 * t225 + 0.4e1 / 0.3e1 * t23 * t1461);
  t1474 = t5 * t761 * t120;
  t1485 = -t1429 / 0.4e1 + t1433 / 0.12e2 - 0.5e1 / 0.18e2 * t1299 - t1303 / 0.4e1 + t1307 / 0.3e1 + t1144 / 0.12e2 - 0.5e1 / 0.18e2 * t1148 + t1155 - 0.3e1 / 0.8e1 * t5 * t1465 * t26 * t48 - 0.3e1 / 0.4e1 * t5 * t757 * t120 - t1474 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t372 * t276 - t1347 / 0.2e1 + t1353 / 0.3e1 - t1356 / 0.4e1 + t1194 / 0.6e1 - 0.5e1 / 0.18e2 * t1202 + t1205 / 0.12e2;
  t1486 = my_piecewise3(t1, 0, t1485);
  t1495 = t336 * t336;
  t1508 = my_piecewise5(t14, 0, t10, 0, -t1332);
  t1512 = my_piecewise3(t56, 0, 0.4e2 / 0.81e2 * t1253 * t379 * t284 - 0.32e2 / 0.27e2 * t702 * t127 * t336 - 0.8e1 / 0.27e2 * t773 * t288 + 0.8e1 / 0.9e1 * t283 * t1495 + 0.8e1 / 0.9e1 * t333 * t711 - 0.8e1 / 0.27e2 * t623 * t383 * t284 + 0.8e1 / 0.9e1 * t283 * t782 * t127 + 0.4e1 / 0.9e1 * t778 * t288 + 0.4e1 / 0.3e1 * t57 * t1508);
  t1519 = t5 * t786 * t97 * t79;
  t1523 = t5 * t387 * t242 * t79;
  t1532 = t5 * t720 * t179;
  t1535 = t5 * t724 * t179;
  t1546 = t5 * t297 * t421;
  t1549 = t5 * t301 * t421;
  t1551 = -0.3e1 / 0.8e1 * t5 * t1512 * t26 * t79 - t1519 / 0.4e1 + t1523 / 0.12e2 - t1394 / 0.4e1 + t1398 / 0.3e1 - 0.5e1 / 0.18e2 * t1402 - 0.3e1 / 0.4e1 * t5 * t716 * t179 - t1532 / 0.2e1 + t1535 / 0.6e1 + t1281 / 0.12e2 - 0.5e1 / 0.18e2 * t1285 + t1290 - t1411 / 0.4e1 + t1414 / 0.3e1 - 0.5e1 / 0.18e2 * t1417 - 0.3e1 / 0.8e1 * t5 * t293 * t421 - t1546 / 0.4e1 + t1549 / 0.12e2;
  t1552 = my_piecewise3(t53, 0, t1551);
  tv4rho42 = 0.2e1 * t701 + 0.2e1 * t740 + 0.2e1 * t772 + 0.2e1 * t811 + t6 * (t1486 + t1552);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1572 = t1331 + t1332;
  t1573 = my_piecewise5(t10, 0, t14, 0, t1572);
  t1577 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1158 * t816 * t88 - 0.8e1 / 0.9e1 * t743 * t313 - 0.8e1 / 0.9e1 * t658 * t367 * t88 + 0.4e1 / 0.3e1 * t661 * t367 + 0.4e1 / 0.3e1 * t309 * t752 + 0.4e1 / 0.9e1 * t216 * t823 * t88 + 0.4e1 / 0.3e1 * t23 * t1573);
  t1584 = t5 * t827 * t97 * t48;
  t1595 = -0.3e1 / 0.8e1 * t5 * t1577 * t26 * t48 - t1584 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t828 * t120 - 0.3e1 / 0.8e1 * t1429 + t1433 / 0.4e1 - 0.3e1 / 0.8e1 * t1474 + t1308 - 0.5e1 / 0.12e2 * t1299 + t1354 - 0.5e1 / 0.36e2 * t1148 + t1155 - 0.5e1 / 0.36e2 * t1202;
  t1596 = my_piecewise3(t1, 0, t1595);
  t1613 = my_piecewise5(t14, 0, t10, 0, -t1572);
  t1617 = my_piecewise3(t56, 0, 0.4e2 / 0.81e2 * t1253 * t836 * t127 - 0.8e1 / 0.9e1 * t773 * t336 - 0.8e1 / 0.9e1 * t702 * t383 * t127 + 0.4e1 / 0.3e1 * t705 * t383 + 0.4e1 / 0.3e1 * t333 * t782 + 0.4e1 / 0.9e1 * t283 * t842 * t127 + 0.4e1 / 0.3e1 * t57 * t1613);
  t1624 = t5 * t846 * t97 * t79;
  t1632 = t5 * t791 * t179;
  t1641 = t5 * t345 * t421;
  t1651 = t5 * t135 * t890;
  t1653 = -0.3e1 / 0.8e1 * t5 * t1617 * t26 * t79 - t1624 / 0.8e1 - 0.3e1 / 0.8e1 * t1519 + t1523 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t787 * t179 - 0.3e1 / 0.8e1 * t1632 + t1399 - 0.5e1 / 0.12e2 * t1402 - 0.3e1 / 0.4e1 * t1532 + t1535 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t341 * t421 - 0.3e1 / 0.8e1 * t1641 - 0.5e1 / 0.36e2 * t1285 + t1290 + t1415 - 0.5e1 / 0.12e2 * t1417 - 0.3e1 / 0.8e1 * t1546 + t1549 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t131 * t890 - t1651 / 0.8e1;
  t1654 = my_piecewise3(t53, 0, t1653);
  tv4rho43 = 0.3e1 * t772 + 0.3e1 * t811 + t835 + t895 + t6 * (t1596 + t1654);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1659 = t362 * t362;
  t1664 = t367 * t367;
  t1670 = 0.24e2 * t544 + 0.24e2 * t1172;
  t1671 = my_piecewise5(t10, 0, t14, 0, t1670);
  t1675 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1158 * t1659 - 0.16e2 / 0.9e1 * t743 * t367 + 0.4e1 / 0.3e1 * t216 * t1664 + 0.16e2 / 0.9e1 * t309 * t823 + 0.4e1 / 0.3e1 * t23 * t1671);
  t1684 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1675 * t26 * t48 - t1584 / 0.2e1 + t1433 / 0.2e1 - 0.5e1 / 0.9e1 * t1299 + t1155);
  t1693 = t379 * t379;
  t1698 = t383 * t383;
  t1704 = my_piecewise5(t14, 0, t10, 0, -t1670);
  t1708 = my_piecewise3(t56, 0, 0.4e2 / 0.81e2 * t1253 * t1693 - 0.16e2 / 0.9e1 * t773 * t383 + 0.4e1 / 0.3e1 * t283 * t1698 + 0.16e2 / 0.9e1 * t333 * t842 + 0.4e1 / 0.3e1 * t57 * t1704);
  t1739 = t881 * rho[1];
  t1751 = 0.1e1 / t416 / t75;
  t1759 = -t1624 / 0.2e1 - 0.3e1 / 0.2e1 * t1632 - 0.3e1 / 0.2e1 * t1641 - t1651 / 0.2e1 + t1523 / 0.2e1 + t1535 + t1549 / 0.2e1 - 0.5e1 / 0.9e1 * t1402 - 0.5e1 / 0.9e1 * t1417 + t1290 - 0.3e1 / 0.8e1 * t5 * t1708 * t26 * t79 - 0.3e1 / 0.2e1 * t5 * t847 * t179 - 0.9e1 / 0.4e1 * t5 * t388 * t421 - 0.3e1 / 0.2e1 * t5 * t159 * t890 - 0.3e1 / 0.8e1 * t5 * t60 * (0.1672e6 / 0.81e2 * t29 * t61 / t65 / t171 * t76 - 0.94864e6 / 0.81e2 * t109 * t169 / t412 * t175 + 0.62912e6 / 0.27e2 * t265 * t411 / t70 / t1086 * t417 - 0.53248e6 / 0.27e2 * t605 * t880 / t65 / t1739 * t886 + 0.16384e6 / 0.27e2 * t1235 * t411 * t61 / t881 / t63 * t1751);
  t1760 = my_piecewise3(t53, 0, t1759);
  tv4rho44 = 0.4e1 * t835 + 0.4e1 * t895 + t6 * (t1684 + t1760);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1768 = t5 * t557 * t195;
  t1774 = t5 * t564 * t195;
  t1777 = t5 * t234 * t450;
  t1784 = 0.5e1 / 0.36e2 * t5 * t576 * t195;
  t1786 = t5 * t243 * t450;
  t1789 = t5 * t98 * t933;
  t1818 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t553 * t195 - 0.3e1 / 0.8e1 * t1768 - 0.9e1 / 0.8e1 * t5 * t230 * t450 + t1774 / 0.4e1 - 0.3e1 / 0.4e1 * t1777 - 0.9e1 / 0.8e1 * t5 * t92 * t933 - t1784 + t1786 / 0.4e1 - 0.3e1 / 0.8e1 * t1789 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.13376e5 / 0.27e2 * t29 * sigma[0] * t587 * t45 + 0.89888e5 / 0.27e2 * t109 * t30 * t592 * t116 - 0.66976e5 / 0.9e1 * t265 * t110 * t599 * t272 + 0.61952e5 / 0.9e1 * t605 * t266 * t609 * t612 - 0.2048e5 / 0.9e1 * t1235 * t606 / t607 / t250 * t1241));
  tv4rho3sigma0 = t6 * t1818 + 0.3e1 * t938;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1825 = t5 * t640 * t208;
  t1828 = t5 * t644 * t208;
  t1832 = 0.5e1 / 0.36e2 * t5 * t648 * t208;
  t1834 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t636 * t208 - 0.3e1 / 0.8e1 * t1825 + t1828 / 0.4e1 - t1832);
  tv4rho3sigma2 = t6 * t1834 + 0.3e1 * t951;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1836 = 0.2e1 * t965;
  t1842 = t5 * t678 * t195 / 0.4e1;
  t1847 = t5 * t685 * t195;
  t1851 = t5 * t322 * t450 / 0.4e1;
  t1860 = -0.3e1 / 0.8e1 * t5 * t674 * t195 - t1842 - 0.3e1 / 0.4e1 * t5 * t318 * t450 + t1847 / 0.12e2 - t1851 - 0.3e1 / 0.8e1 * t5 * t148 * t933 - t1768 / 0.8e1 + t1774 / 0.6e1 - t1777 / 0.4e1 - t1784 + t1786 / 0.6e1 - t1789 / 0.8e1;
  t1861 = my_piecewise3(t1, 0, t1860);
  tv4rho3sigma3 = t6 * t1861 + t1836 + t938;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1863 = 0.2e1 * t981;
  t1869 = t5 * t720 * t208 / 0.4e1;
  t1871 = t5 * t724 * t208;
  t1880 = t5 * t297 * t490 / 0.4e1;
  t1882 = t5 * t301 * t490;
  t1885 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t716 * t208 - t1869 + t1871 / 0.12e2 - t1825 / 0.8e1 + t1828 / 0.6e1 - t1832 - 0.3e1 / 0.8e1 * t5 * t293 * t490 - t1880 + t1882 / 0.12e2);
  tv4rho3sigma5 = t6 * t1885 + t1863 + t951;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1891 = t5 * t761 * t195;
  t1900 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t757 * t195 - t1891 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t372 * t450 - t1842 + t1847 / 0.6e1 - t1851 + t1774 / 0.12e2 - t1784 + t1786 / 0.12e2);
  tv4rho3sigma6 = t6 * t1900 + t1836 + t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1906 = t5 * t791 * t208;
  t1913 = t5 * t345 * t490;
  t1921 = t5 * t135 * t1019;
  t1923 = -0.3e1 / 0.8e1 * t5 * t787 * t208 - t1906 / 0.8e1 - t1869 + t1871 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t341 * t490 - t1913 / 0.4e1 + t1828 / 0.12e2 - t1832 - t1880 + t1882 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t131 * t1019 - t1921 / 0.8e1;
  t1924 = my_piecewise3(t53, 0, t1923);
  tv4rho3sigma8 = t6 * t1924 + t1024 + t1863;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1933 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t828 * t195 - 0.3e1 / 0.8e1 * t1891 + t1847 / 0.4e1 - t1784);
  tv4rho3sigma9 = t6 * t1933 + 0.3e1 * t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1977 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t847 * t208 - 0.3e1 / 0.8e1 * t1906 - 0.9e1 / 0.8e1 * t5 * t388 * t490 + t1871 / 0.4e1 - 0.3e1 / 0.4e1 * t1913 - 0.9e1 / 0.8e1 * t5 * t159 * t1019 - t1832 + t1882 / 0.4e1 - 0.3e1 / 0.8e1 * t1921 - 0.3e1 / 0.8e1 * t5 * t60 * (-0.13376e5 / 0.27e2 * t29 * sigma[2] * t863 * t76 + 0.89888e5 / 0.27e2 * t109 * t61 * t868 * t175 - 0.66976e5 / 0.9e1 * t265 * t169 * t875 * t417 + 0.61952e5 / 0.9e1 * t605 * t411 * t883 * t886 - 0.2048e5 / 0.9e1 * t1235 * t880 / t881 / t397 * t1751));
  tv4rho3sigma11 = t6 * t1977 + 0.3e1 * t1024;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1984 = t5 * t234 * t510;
  t1991 = t5 * t243 * t510 / 0.12e2;
  t1993 = t5 * t98 * t1050;
  t2021 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t230 * t510 - t1984 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t1050 + t1991 - t1993 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.608e3 / 0.9e1 * t29 * t253 * t45 - 0.656e4 / 0.9e1 * t109 * t259 * t116 * sigma[0] + 0.6272e4 / 0.3e1 * t265 * t269 * t272 * t30 - 0.6848e4 / 0.3e1 * t605 * t110 * t928 * t612 + 0.256e4 / 0.3e1 * t1235 * t266 / t607 / t31 * t1241));
  tv4rho2sigma20 = t6 * t2021 + 0.2e1 * t1055;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2028 = t5 * t297 * t528;
  t2032 = t5 * t301 * t528 / 0.12e2;
  t2034 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t293 * t528 - t2028 / 0.4e1 + t2032);
  tv4rho2sigma25 = t6 * t2034 + 0.2e1 * t1064;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2040 = t5 * t322 * t510;
  t2048 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t318 * t510 - t2040 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t148 * t1050 - t1984 / 0.8e1 + t1991 - t1993 / 0.8e1);
  tv4rho2sigma26 = t6 * t2048 + t1055 + t1070;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2054 = t5 * t345 * t528;
  t2061 = t5 * t135 * t1093;
  t2064 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t341 * t528 - t2054 / 0.8e1 - t2028 / 0.8e1 + t2032 - 0.3e1 / 0.8e1 * t5 * t131 * t1093 - t2061 / 0.8e1);
  tv4rho2sigma211 = t6 * t2064 + t1064 + t1098;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2072 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t372 * t510 - t2040 / 0.4e1 + t1991);
  tv4rho2sigma212 = t6 * t2072 + 0.2e1 * t1070;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2109 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t388 * t528 - t2054 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t159 * t1093 + t2032 - t2061 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t60 * (0.608e3 / 0.9e1 * t29 * t400 * t76 - 0.656e4 / 0.9e1 * t109 * t406 * t175 * sigma[2] + 0.6272e4 / 0.3e1 * t265 * t414 * t417 * t61 - 0.6848e4 / 0.3e1 * t605 * t169 * t1014 * t886 + 0.256e4 / 0.3e1 * t1235 * t411 / t881 / t62 * t1751));
  tv4rho2sigma217 = t6 * t2109 + 0.2e1 * t1098;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2116 = t5 * t98 * t1113 / 0.8e1;
  t2137 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t1113 - t2116 - 0.3e1 / 0.8e1 * t5 * t27 * (0.96e2 * t109 * t1035 - 0.48e3 * t265 * t445 * t272 * sigma[0] + 0.704e3 * t605 * t30 * t1045 * t612 - 0.32e3 * t1235 * t110 / t1227 * t1241));
  tv4rhosigma30 = t6 * t2137 + t1117;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2144 = t5 * t135 * t1131 / 0.8e1;
  t2146 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t131 * t1131 - t2144);
  tv4rhosigma39 = t6 * t2146 + t1135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2152 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t148 * t1113 - t2116);
  tv4rhosigma310 = t6 * t2152 + t1117;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2177 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t159 * t1131 - t2144 - 0.3e1 / 0.8e1 * t5 * t60 * (0.96e2 * t109 * t1078 - 0.48e3 * t265 * t485 * t417 * sigma[2] + 0.704e3 * t605 * t61 * t1088 * t886 - 0.32e3 * t1235 * t169 / t1739 * t1751));
  tv4rhosigma319 = t6 * t2177 + t1135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2195 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (0.72e2 * t265 * t505 * t272 - 0.192e3 * t605 * sigma[0] * t1108 * t612 + 0.12e3 * t1235 * t30 / t607 * t1241));
  tv4sigma40 = t6 * t2195;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2212 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t60 * (0.72e2 * t265 * t523 * t417 - 0.192e3 * t605 * sigma[2] * t1126 * t886 + 0.12e3 * t1235 * t61 / t881 * t1751));
  tv4sigma414 = t6 * t2212;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

#endif

#endif

#endif

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t32, t33, t35;
  double t38, t39, t40, t41, t44, t48, tzk0;

  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->gamma * params->gamma;
  t21 = params->b * t20;
  t22 = sigma[0] * sigma[0];
  t23 = t21 * t22;
  t24 = M_CBRT2;
  t25 = rho[0] * rho[0];
  t26 = t25 * t25;
  t27 = t26 * rho[0];
  t32 = t24 * t24;
  t33 = t18 * t18;
  t35 = 0.1e1 / t33 / t25;
  t38 = params->gamma * sigma[0] * t32 * t35 + 0.1e1;
  t39 = t38 * t38;
  t40 = 0.1e1 / t39;
  t41 = t24 / t18 / t27 * t40;
  t44 = 0.2e1 * t23 * t41 + params->a;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t48;

#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t32, t33, t35;
  double t38, t39, t40, t41, t44, t48, tzk0;

  if(order < 1) return;


  t50 = t17 / t33;
  t54 = t26 * t25;
  t58 = t24 / t18 / t54 * t40;
  t62 = params->b * t20 * params->gamma;
  t63 = t22 * sigma[0];
  t64 = t26 * t26;
  t65 = t64 * rho[0];
  t66 = 0.1e1 / t65;
  t69 = 0.1e1 / t39 / t38;
  t73 = -0.32e2 / 0.3e1 * t23 * t58 + 0.64e2 / 0.3e1 * t62 * t63 * t66 * t69;
  t78 = my_piecewise3(t2, 0, -t6 * t50 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t73);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t78 + 0.2e1 * t48;

  t81 = t21 * sigma[0];
  t84 = 0.1e1 / t64;
  t89 = -0.8e1 * t62 * t22 * t84 * t69 + 0.4e1 * t81 * t41;
  t93 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t89);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t93;

#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t32, t33, t35;
  double t38, t39, t40, t41, t44, t48, tzk0;

  if(order < 2) return;


  t98 = t17 / t33 / rho[0];
  t105 = t25 * rho[0];
  t106 = t26 * t105;
  t110 = t24 / t18 / t106 * t40;
  t113 = t64 * t25;
  t114 = 0.1e1 / t113;
  t119 = t20 * t20;
  t120 = params->b * t119;
  t121 = t22 * t22;
  t122 = t120 * t121;
  t123 = t64 * t26;
  t125 = 0.1e1 / t33 / t123;
  t126 = t39 * t39;
  t127 = 0.1e1 / t126;
  t129 = t125 * t127 * t32;
  t132 = 0.608e3 / 0.9e1 * t23 * t110 - 0.2752e4 / 0.9e1 * t62 * t63 * t114 * t69 + 0.512e3 / 0.3e1 * t122 * t129;
  t137 = my_piecewise3(t2, 0, t6 * t98 * t44 / 0.12e2 - t6 * t50 * t73 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t132);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t137 + 0.4e1 * t78;

  t149 = t120 * t63;
  t150 = t64 * t105;
  t152 = 0.1e1 / t33 / t150;
  t154 = t152 * t127 * t32;
  t157 = -0.64e2 / 0.3e1 * t81 * t58 + 0.320e3 / 0.3e1 * t62 * t22 * t66 * t69 - 0.64e2 * t149 * t154;
  t162 = my_piecewise3(t2, 0, -t6 * t50 * t89 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t157);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t162 + 0.2e1 * t93;

  t171 = t120 * t22;
  t175 = 0.1e1 / t33 / t113 * t127 * t32;
  t178 = -0.32e2 * t62 * sigma[0] * t84 * t69 + 0.24e2 * t171 * t175 + 0.4e1 * t21 * t41;
  t182 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t178);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t182;

#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t32, t33, t35;
  double t38, t39, t40, t41, t44, t48, tzk0;

  if(order < 3) return;


  t185 = t17 * t35;
  t198 = t24 / t18 / t64 * t40;
  t201 = 0.1e1 / t150;
  t206 = t64 * t27;
  t210 = 0.1e1 / t33 / t206 * t127 * t32;
  t214 = params->b * t119 * params->gamma;
  t215 = t121 * sigma[0];
  t216 = t214 * t215;
  t217 = t64 * t64;
  t221 = 0.1e1 / t126 / t38;
  t223 = 0.1e1 / t18 / t217 * t221 * t24;
  t226 = -0.13376e5 / 0.27e2 * t23 * t198 + 0.102016e6 / 0.27e2 * t62 * t63 * t201 * t69 - 0.4608e4 * t122 * t210 + 0.32768e5 / 0.9e1 * t216 * t223;
  t231 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t185 * t44 + t6 * t98 * t73 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t50 * t132 - 0.3e1 / 0.8e1 * t6 * t19 * t226);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t231 + 0.6e1 * t137;

  t249 = t214 * t121;
  t254 = 0.1e1 / t18 / t64 / t106 * t221 * t24;
  t257 = 0.1216e4 / 0.9e1 * t81 * t110 - 0.10688e5 / 0.9e1 * t62 * t22 * t114 * t69 + 0.1600e4 * t149 * t129 - 0.4096e4 / 0.3e1 * t249 * t254;
  t262 = my_piecewise3(t2, 0, t6 * t98 * t89 / 0.12e2 - t6 * t50 * t157 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t257);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t262 + 0.4e1 * t162;

  t270 = t66 * t69;
  t276 = t214 * t63;
  t277 = t64 * t54;
  t281 = 0.1e1 / t18 / t277 * t221 * t24;
  t284 = -0.64e2 / 0.3e1 * t21 * t58 + 0.896e3 / 0.3e1 * t62 * t270 * sigma[0] - 0.512e3 * t171 * t154 + 0.512e3 * t276 * t281;
  t289 = my_piecewise3(t2, 0, -t6 * t50 * t178 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t284);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t289 + 0.2e1 * t182;

  t298 = t214 * t22;
  t302 = 0.1e1 / t18 / t206 * t221 * t24;
  t305 = 0.144e3 * t120 * sigma[0] * t175 - 0.48e2 * t62 * t84 * t69 - 0.192e3 * t298 * t302;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t305);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t309;

#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t32, t33, t35;
  double t38, t39, t40, t41, t44, t48, tzk0;

  if(order < 4) return;


  t344 = t217 * rho[0];
  t352 = params->b * t119 * t20;
  t358 = 0.1e1 / t126 / t39;
  t367 = my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t17 / t33 / t105 * t44 - 0.5e1 / 0.9e1 * t6 * t185 * t73 + t6 * t98 * t132 / 0.2e1 - t6 * t50 * t226 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.334400e6 / 0.81e2 * t23 * t24 / t18 / t65 * t40 - 0.3794560e7 / 0.81e2 * t62 * t63 / t123 * t69 + 0.2516480e7 / 0.27e2 * t122 / t33 / t277 * t127 * t32 - 0.4259840e7 / 0.27e2 * t216 / t18 / t344 * t221 * t24 + 0.2621440e7 / 0.27e2 * t352 * t121 * t22 / t217 / t26 * t358));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t367 + 0.8e1 * t231;

  t401 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t185 * t89 + t6 * t98 * t157 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t50 * t257 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.26752e5 / 0.27e2 * t81 * t198 + 0.359552e6 / 0.27e2 * t62 * t22 * t201 * t69 - 0.267904e6 / 0.9e1 * t149 * t210 + 0.495616e6 / 0.9e1 * t249 * t223 - 0.327680e6 / 0.9e1 * t352 * t215 / t217 / t105 * t358));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t401 + 0.6e1 * t262;

  t435 = my_piecewise3(t2, 0, t6 * t98 * t178 / 0.12e2 - t6 * t50 * t284 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.1216e4 / 0.9e1 * t21 * t110 - 0.26240e5 / 0.9e1 * t62 * t114 * t69 * sigma[0] + 0.25088e5 / 0.3e1 * t120 * t125 * t127 * t22 * t32 - 0.54784e5 / 0.3e1 * t276 * t254 + 0.40960e5 / 0.3e1 * t352 * t121 / t217 / t25 * t358));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t435 + 0.4e1 * t289;

  t460 = my_piecewise3(t2, 0, -t6 * t50 * t305 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.384e3 * t62 * t270 - 0.1920e4 * t120 * t152 * t127 * sigma[0] * t32 + 0.5632e4 * t298 * t281 - 0.5120e4 * t352 * t63 / t344 * t358));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t460 + 0.2e1 * t309;

  t477 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (0.288e3 * t120 * t175 - 0.1536e4 * t214 * sigma[0] * t302 + 0.1920e4 * t352 * t22 / t217 * t358));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t477;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t39, t43, t44, t45;
  double t48, t52, t53, t54, t56, t57, t58, t59;
  double t61, t62, t63, t64, t65, t66, t67, t69;
  double t72, t76, t77, t78, t81, t85;

#ifndef XC_DONT_COMPILE_VXC
  double t86, t87, t88, t90, t93, t94, t98, t99;
  double t100, t103, t104, t106, t111, t112, t113, t114;
  double t115, t118, t122, t127, t128, t130, t133, t134;
  double t138, t141, t143, t147, t150, t151, t156, t158;
  double t161, t162, t166, t168, t172, t173, t174, t175;
  double t178, t182, t187, t193, t198, t202, t206, t211;
  double t215;

#ifndef XC_DONT_COMPILE_FXC
  double t218, t219, t220, t223, t224, t225, t228, t232;
  double t233, t237, t239, t245, t246, t249, t251, t253;
  double t254, t256, t261, t262, t267, t268, t269, t270;
  double t272, t274, t275, t279, t284, t285, t286, t287;
  double t290, t293, t297, t298, t302, t304, t306, t309;
  double t311, t314, t318, t322, t323, t327, t329, t337;
  double t338, t342, t346, t347, t351, t353, t360, t363;
  double t368, t373, t377, t378, t384, t385, t390, t394;
  double t395, t404, t405, t407, t412, t413, t418, t419;
  double t421, t423, t424, t428, t433, t441, t450, t452;
  double t457, t462, t469, t471, t477, t490, t492, t497;
  double t502, t512, t517, t521, t530, t535, t539;

#ifndef XC_DONT_COMPILE_KXC
  double t543, t544, t547, t550, t551, t552, t555, t559;
  double t560, t564, t566, t571, t573, t576, t582, t583;
  double t586, t588, t591, t594, t599, t604, t606, t612;
  double t613, t614, t616, t619, t623, t628, t630, t631;
  double t634, t637, t640, t644, t645, t649, t651, t653;
  double t655, t657, t660, t662, t665, t666, t667, t670;
  double t675, t676, t678, t682, t683, t687, t690, t694;
  double t696, t700, t709, t710, t711, t714, t719, t721;
  double t725, t726, t730, t733, t734, t736, t745, t747;
  double t750, t753, t758, t762, t766, t767, t771, t773;
  double t782, t783, t788, t792, t796, t797, t801, t803;
  double t810, t818, t820, t821, t826, t833, t837, t838;
  double t845, t846, t853, t857, t858, t874, t879, t884;
  double t886, t891, t892, t894, t897, t901, t906, t914;
  double t921, t923, t939, t944, t949, t956, t960, t962;
  double t968, t976, t982, t989, t992, t1000, t1025, t1030;
  double t1035, t1042, t1046, t1054, t1056, t1061, t1066, t1073;
  double t1075, t1081, t1089, t1097, t1099, t1104, t1109, t1119;
  double t1124, t1128, t1137, t1142, t1146;

#ifndef XC_DONT_COMPILE_LXC
  double t1151, t1154, t1158, t1161, t1165, t1167, t1169, t1170;
  double t1176, t1182, t1183, t1186, t1190, t1199, t1205, t1207;
  double t1213, t1216, t1219, t1238, t1246, t1252, t1260, t1261;
  double t1262, t1264, t1265, t1271, t1276, t1279, t1283, t1290;
  double t1294, t1298, t1303, t1305, t1312, t1316, t1317, t1320;
  double t1341, t1342, t1344, t1348, t1357, t1363, t1364, t1366;
  double t1377, t1378, t1395, t1397, t1401, t1408, t1412, t1413;
  double t1416, t1425, t1428, t1429, t1431, t1433, t1434, t1443;
  double t1447, t1462, t1475, t1479, t1488, t1499, t1500, t1509;
  double t1522, t1526, t1533, t1537, t1546, t1549, t1560, t1563;
  double t1565, t1566, t1587, t1591, t1598, t1609, t1610, t1627;
  double t1631, t1638, t1646, t1655, t1665, t1667, t1668, t1673;
  double t1678, t1685, t1689, t1698, t1699, t1704, t1711, t1715;
  double t1746, t1758, t1774, t1775, t1783, t1789, t1792, t1799;
  double t1801, t1804, t1833, t1840, t1843, t1847, t1849, t1851;
  double t1857, t1862, t1866, t1875, t1876, t1878, t1884, t1886;
  double t1895, t1897, t1900, t1906, t1915, t1921, t1928, t1936;
  double t1938, t1939, t1948, t1992, t1999, t2006, t2008, t2036;
  double t2043, t2047, t2049, t2055, t2063, t2069, t2076, t2079;
  double t2087, t2124, t2131, t2152, t2159, t2161, t2167, t2192;
  double t2210, t2227;
#endif

#endif

#endif

#endif

#endif


  gga_x_optx_params *params;

  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->gamma * params->gamma;
  t29 = params->b * t28;
  t30 = sigma[0] * sigma[0];
  t31 = rho[0] * rho[0];
  t32 = t31 * t31;
  t33 = t32 * rho[0];
  t34 = POW_1_3(rho[0]);
  t36 = 0.1e1 / t34 / t33;
  t39 = t34 * t34;
  t43 = 0.1e1 + params->gamma * sigma[0] / t39 / t31;
  t44 = t43 * t43;
  t45 = 0.1e1 / t44;
  t48 = t29 * t30 * t36 * t45 + params->a;
  t52 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t48);
  t53 = rho[1] <= p->dens_threshold;
  t54 = -t16;
  t56 = my_piecewise5(t14, t11, t10, t15, t54 * t7);
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(t57);
  t61 = my_piecewise3(t58, t22, t59 * t57);
  t62 = t61 * t26;
  t63 = sigma[2] * sigma[2];
  t64 = rho[1] * rho[1];
  t65 = t64 * t64;
  t66 = t65 * rho[1];
  t67 = POW_1_3(rho[1]);
  t69 = 0.1e1 / t67 / t66;
  t72 = t67 * t67;
  t76 = 0.1e1 + params->gamma * sigma[2] / t72 / t64;
  t77 = t76 * t76;
  t78 = 0.1e1 / t77;
  t81 = t29 * t63 * t69 * t78 + params->a;
  t85 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t62 * t81);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t52 + t85;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t86 = t6 * t6;
  t87 = 0.1e1 / t86;
  t88 = t16 * t87;
  t90 = my_piecewise5(t10, 0, t14, 0, t7 - t88);
  t93 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t90);
  t94 = t93 * t26;
  t98 = t26 * t26;
  t99 = 0.1e1 / t98;
  t100 = t25 * t99;
  t103 = t5 * t100 * t48 / 0.8e1;
  t104 = t32 * t31;
  t106 = 0.1e1 / t34 / t104;
  t111 = params->b * t28 * params->gamma;
  t112 = t30 * sigma[0];
  t113 = t32 * t32;
  t114 = t113 * rho[0];
  t115 = 0.1e1 / t114;
  t118 = 0.1e1 / t44 / t43;
  t122 = -0.16e2 / 0.3e1 * t29 * t30 * t106 * t45 + 0.16e2 / 0.3e1 * t111 * t112 * t115 * t118;
  t127 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t48 - t103 - 0.3e1 / 0.8e1 * t5 * t27 * t122);
  t128 = t54 * t87;
  t130 = my_piecewise5(t14, 0, t10, 0, -t7 - t128);
  t133 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t59 * t130);
  t134 = t133 * t26;
  t138 = t61 * t99;
  t141 = t5 * t138 * t81 / 0.8e1;
  t143 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t134 * t81 - t141);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t52 + t85 + t6 * (t127 + t143);

  t147 = my_piecewise5(t10, 0, t14, 0, -t7 - t88);
  t150 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t147);
  t151 = t150 * t26;
  t156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t48 - t103);
  t158 = my_piecewise5(t14, 0, t10, 0, t7 - t128);
  t161 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t59 * t158);
  t162 = t161 * t26;
  t166 = t65 * t64;
  t168 = 0.1e1 / t67 / t166;
  t172 = t63 * sigma[2];
  t173 = t65 * t65;
  t174 = t173 * rho[1];
  t175 = 0.1e1 / t174;
  t178 = 0.1e1 / t77 / t76;
  t182 = 0.16e2 / 0.3e1 * t111 * t172 * t175 * t178 - 0.16e2 / 0.3e1 * t29 * t63 * t168 * t78;
  t187 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t162 * t81 - t141 - 0.3e1 / 0.8e1 * t5 * t62 * t182);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t52 + t85 + t6 * (t156 + t187);

  t193 = 0.1e1 / t113;
  t198 = -0.2e1 * t111 * t30 * t193 * t118 + 0.2e1 * t29 * sigma[0] * t36 * t45;
  t202 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t198);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t6 * t202;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t206 = 0.1e1 / t173;
  t211 = -0.2e1 * t111 * t63 * t206 * t178 + 0.2e1 * t29 * sigma[2] * t69 * t78;
  t215 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t62 * t211);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t215;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t218 = t23 * t23;
  t219 = 0.1e1 / t218;
  t220 = t90 * t90;
  t223 = t86 * t6;
  t224 = 0.1e1 / t223;
  t225 = t16 * t224;
  t228 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t87 + 0.2e1 * t225);
  t232 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t219 * t220 + 0.4e1 / 0.3e1 * t23 * t228);
  t233 = t232 * t26;
  t237 = t93 * t99;
  t239 = t5 * t237 * t48;
  t245 = 0.1e1 / t98 / t6;
  t246 = t25 * t245;
  t249 = t5 * t246 * t48 / 0.12e2;
  t251 = t5 * t100 * t122;
  t253 = t31 * rho[0];
  t254 = t32 * t253;
  t256 = 0.1e1 / t34 / t254;
  t261 = t113 * t31;
  t262 = 0.1e1 / t261;
  t267 = t28 * t28;
  t268 = params->b * t267;
  t269 = t30 * t30;
  t270 = t113 * t32;
  t272 = 0.1e1 / t39 / t270;
  t274 = t44 * t44;
  t275 = 0.1e1 / t274;
  t279 = 0.304e3 / 0.9e1 * t29 * t30 * t256 * t45 - 0.688e3 / 0.9e1 * t111 * t112 * t262 * t118 + 0.128e3 / 0.3e1 * t268 * t269 * t272 * t275;
  t284 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t233 * t48 - t239 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t122 + t249 - t251 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t279);
  t285 = t59 * t59;
  t286 = 0.1e1 / t285;
  t287 = t130 * t130;
  t290 = t54 * t224;
  t293 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t87 + 0.2e1 * t290);
  t297 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t286 * t287 + 0.4e1 / 0.3e1 * t59 * t293);
  t298 = t297 * t26;
  t302 = t133 * t99;
  t304 = t5 * t302 * t81;
  t306 = t61 * t245;
  t309 = t5 * t306 * t81 / 0.12e2;
  t311 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t298 * t81 - t304 / 0.4e1 + t309);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t127 + 0.2e1 * t143 + t6 * (t284 + t311);

  t314 = t219 * t147;
  t318 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t225);
  t322 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t314 * t90 + 0.4e1 / 0.3e1 * t23 * t318);
  t323 = t322 * t26;
  t327 = t150 * t99;
  t329 = t5 * t327 * t48;
  t337 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t323 * t48 - t329 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t122 - t239 / 0.8e1 + t249 - t251 / 0.8e1);
  t338 = t286 * t158;
  t342 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t290);
  t346 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t338 * t130 + 0.4e1 / 0.3e1 * t59 * t342);
  t347 = t346 * t26;
  t351 = t161 * t99;
  t353 = t5 * t351 * t81;
  t360 = t5 * t138 * t182;
  t363 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t347 * t81 - t353 / 0.8e1 - t304 / 0.8e1 + t309 - 0.3e1 / 0.8e1 * t5 * t134 * t182 - t360 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t127 + t143 + t156 + t187 + t6 * (t337 + t363);

  t368 = t147 * t147;
  t373 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t87 + 0.2e1 * t225);
  t377 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t219 * t368 + 0.4e1 / 0.3e1 * t23 * t373);
  t378 = t377 * t26;
  t384 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t378 * t48 - t329 / 0.4e1 + t249);
  t385 = t158 * t158;
  t390 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t87 + 0.2e1 * t290);
  t394 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t286 * t385 + 0.4e1 / 0.3e1 * t59 * t390);
  t395 = t394 * t26;
  t404 = t64 * rho[1];
  t405 = t65 * t404;
  t407 = 0.1e1 / t67 / t405;
  t412 = t173 * t64;
  t413 = 0.1e1 / t412;
  t418 = t63 * t63;
  t419 = t173 * t65;
  t421 = 0.1e1 / t72 / t419;
  t423 = t77 * t77;
  t424 = 0.1e1 / t423;
  t428 = 0.304e3 / 0.9e1 * t29 * t63 * t407 * t78 - 0.688e3 / 0.9e1 * t111 * t172 * t413 * t178 + 0.128e3 / 0.3e1 * t268 * t418 * t421 * t424;
  t433 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t395 * t81 - t353 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t182 + t309 - t360 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t62 * t428);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t156 + 0.2e1 * t187 + t6 * (t384 + t433);

  t441 = t5 * t100 * t198 / 0.8e1;
  t450 = t113 * t253;
  t452 = 0.1e1 / t39 / t450;
  t457 = -0.32e2 / 0.3e1 * t29 * sigma[0] * t106 * t45 + 0.80e2 / 0.3e1 * t111 * t30 * t115 * t118 - 0.16e2 * t268 * t112 * t452 * t275;
  t462 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t198 - t441 - 0.3e1 / 0.8e1 * t5 * t27 * t457);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t6 * t462 + t202;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t469 = t5 * t138 * t211 / 0.8e1;
  t471 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t134 * t211 - t469);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t6 * t471 + t215;

  t477 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t198 - t441);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t6 * t477 + t202;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t490 = t173 * t404;
  t492 = 0.1e1 / t72 / t490;
  t497 = -0.32e2 / 0.3e1 * t29 * sigma[2] * t168 * t78 + 0.80e2 / 0.3e1 * t111 * t63 * t175 * t178 - 0.16e2 * t268 * t172 * t492 * t424;
  t502 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t162 * t211 - t469 - 0.3e1 / 0.8e1 * t5 * t62 * t497);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t6 * t502 + t215;

  t512 = 0.1e1 / t39 / t261;
  t517 = -0.8e1 * t111 * sigma[0] * t193 * t118 + 0.6e1 * t268 * t30 * t512 * t275 + 0.2e1 * t29 * t36 * t45;
  t521 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t517);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t521;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t530 = 0.1e1 / t72 / t412;
  t535 = -0.8e1 * t111 * sigma[2] * t206 * t178 + 0.6e1 * t268 * t63 * t530 * t424 + 0.2e1 * t29 * t69 * t78;
  t539 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t62 * t535);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t539;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t543 = 0.1e1 / t218 / t19;
  t544 = t220 * t90;
  t547 = t219 * t90;
  t550 = t86 * t86;
  t551 = 0.1e1 / t550;
  t552 = t16 * t551;
  t555 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t224 - 0.6e1 * t552);
  t559 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t543 * t544 + 0.4e1 / 0.3e1 * t547 * t228 + 0.4e1 / 0.3e1 * t23 * t555);
  t560 = t559 * t26;
  t564 = t232 * t99;
  t566 = t5 * t564 * t48;
  t571 = t93 * t245;
  t573 = t5 * t571 * t48;
  t576 = t5 * t237 * t122;
  t582 = 0.1e1 / t98 / t86;
  t583 = t25 * t582;
  t586 = 0.5e1 / 0.36e2 * t5 * t583 * t48;
  t588 = t5 * t246 * t122;
  t591 = t5 * t100 * t279;
  t594 = 0.1e1 / t34 / t113;
  t599 = 0.1e1 / t450;
  t604 = t113 * t33;
  t606 = 0.1e1 / t39 / t604;
  t612 = params->b * t267 * params->gamma;
  t613 = t269 * sigma[0];
  t614 = t113 * t113;
  t616 = 0.1e1 / t34 / t614;
  t619 = 0.1e1 / t274 / t43;
  t623 = -0.6688e4 / 0.27e2 * t29 * t30 * t594 * t45 + 0.25504e5 / 0.27e2 * t111 * t112 * t599 * t118 - 0.1152e4 * t268 * t269 * t606 * t275 + 0.4096e4 / 0.9e1 * t612 * t613 * t616 * t619;
  t628 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t560 * t48 - 0.3e1 / 0.8e1 * t566 - 0.9e1 / 0.8e1 * t5 * t233 * t122 + t573 / 0.4e1 - 0.3e1 / 0.4e1 * t576 - 0.9e1 / 0.8e1 * t5 * t94 * t279 - t586 + t588 / 0.4e1 - 0.3e1 / 0.8e1 * t591 - 0.3e1 / 0.8e1 * t5 * t27 * t623);
  t630 = 0.1e1 / t285 / t57;
  t631 = t287 * t130;
  t634 = t286 * t130;
  t637 = t54 * t551;
  t640 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t224 - 0.6e1 * t637);
  t644 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t630 * t631 + 0.4e1 / 0.3e1 * t634 * t293 + 0.4e1 / 0.3e1 * t59 * t640);
  t645 = t644 * t26;
  t649 = t297 * t99;
  t651 = t5 * t649 * t81;
  t653 = t133 * t245;
  t655 = t5 * t653 * t81;
  t657 = t61 * t582;
  t660 = 0.5e1 / 0.36e2 * t5 * t657 * t81;
  t662 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t645 * t81 - 0.3e1 / 0.8e1 * t651 + t655 / 0.4e1 - t660);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t284 + 0.3e1 * t311 + t6 * (t628 + t662);

  t665 = 0.2e1 * t337;
  t666 = 0.2e1 * t363;
  t667 = t543 * t147;
  t670 = t219 * t318;
  t675 = 0.2e1 * t224;
  t676 = 0.6e1 * t552;
  t678 = my_piecewise5(t10, 0, t14, 0, t675 - t676);
  t682 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t667 * t220 + 0.8e1 / 0.9e1 * t670 * t90 + 0.4e1 / 0.9e1 * t314 * t228 + 0.4e1 / 0.3e1 * t23 * t678);
  t683 = t682 * t26;
  t687 = t322 * t99;
  t690 = t5 * t687 * t48 / 0.4e1;
  t694 = t150 * t245;
  t696 = t5 * t694 * t48;
  t700 = t5 * t327 * t122 / 0.4e1;
  t709 = -0.3e1 / 0.8e1 * t5 * t683 * t48 - t690 - 0.3e1 / 0.4e1 * t5 * t323 * t122 + t696 / 0.12e2 - t700 - 0.3e1 / 0.8e1 * t5 * t151 * t279 - t566 / 0.8e1 + t573 / 0.6e1 - t576 / 0.4e1 - t586 + t588 / 0.6e1 - t591 / 0.8e1;
  t710 = my_piecewise3(t1, 0, t709);
  t711 = t630 * t158;
  t714 = t286 * t342;
  t719 = 0.6e1 * t637;
  t721 = my_piecewise5(t14, 0, t10, 0, -t675 - t719);
  t725 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t711 * t287 + 0.8e1 / 0.9e1 * t714 * t130 + 0.4e1 / 0.9e1 * t338 * t293 + 0.4e1 / 0.3e1 * t59 * t721);
  t726 = t725 * t26;
  t730 = t346 * t99;
  t733 = t5 * t730 * t81 / 0.4e1;
  t734 = t161 * t245;
  t736 = t5 * t734 * t81;
  t745 = t5 * t302 * t182 / 0.4e1;
  t747 = t5 * t306 * t182;
  t750 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t726 * t81 - t733 + t736 / 0.12e2 - t651 / 0.8e1 + t655 / 0.6e1 - t660 - 0.3e1 / 0.8e1 * t5 * t298 * t182 - t745 + t747 / 0.12e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t284 + t311 + t665 + t666 + t6 * (t710 + t750);

  t753 = t543 * t368;
  t758 = t219 * t373;
  t762 = my_piecewise5(t10, 0, t14, 0, -t675 - t676);
  t766 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t753 * t90 + 0.8e1 / 0.9e1 * t314 * t318 + 0.4e1 / 0.9e1 * t758 * t90 + 0.4e1 / 0.3e1 * t23 * t762);
  t767 = t766 * t26;
  t771 = t377 * t99;
  t773 = t5 * t771 * t48;
  t782 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t767 * t48 - t773 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t378 * t122 - t690 + t696 / 0.6e1 - t700 + t573 / 0.12e2 - t586 + t588 / 0.12e2);
  t783 = t630 * t385;
  t788 = t286 * t390;
  t792 = my_piecewise5(t14, 0, t10, 0, t675 - t719);
  t796 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t783 * t130 + 0.8e1 / 0.9e1 * t338 * t342 + 0.4e1 / 0.9e1 * t788 * t130 + 0.4e1 / 0.3e1 * t59 * t792);
  t797 = t796 * t26;
  t801 = t394 * t99;
  t803 = t5 * t801 * t81;
  t810 = t5 * t351 * t182;
  t818 = t5 * t138 * t428;
  t820 = -0.3e1 / 0.8e1 * t5 * t797 * t81 - t803 / 0.8e1 - t733 + t736 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t347 * t182 - t810 / 0.4e1 + t655 / 0.12e2 - t660 - t745 + t747 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t134 * t428 - t818 / 0.8e1;
  t821 = my_piecewise3(t53, 0, t820);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t665 + t666 + t384 + t433 + t6 * (t782 + t821);

  t826 = t368 * t147;
  t833 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t224 - 0.6e1 * t552);
  t837 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t543 * t826 + 0.4e1 / 0.3e1 * t314 * t373 + 0.4e1 / 0.3e1 * t23 * t833);
  t838 = t837 * t26;
  t845 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t838 * t48 - 0.3e1 / 0.8e1 * t773 + t696 / 0.4e1 - t586);
  t846 = t385 * t158;
  t853 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t224 - 0.6e1 * t637);
  t857 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t630 * t846 + 0.4e1 / 0.3e1 * t338 * t390 + 0.4e1 / 0.3e1 * t59 * t853);
  t858 = t857 * t26;
  t874 = 0.1e1 / t67 / t173;
  t879 = 0.1e1 / t490;
  t884 = t173 * t66;
  t886 = 0.1e1 / t72 / t884;
  t891 = t418 * sigma[2];
  t892 = t173 * t173;
  t894 = 0.1e1 / t67 / t892;
  t897 = 0.1e1 / t423 / t76;
  t901 = -0.6688e4 / 0.27e2 * t29 * t63 * t874 * t78 + 0.25504e5 / 0.27e2 * t111 * t172 * t879 * t178 - 0.1152e4 * t268 * t418 * t886 * t424 + 0.4096e4 / 0.9e1 * t612 * t891 * t894 * t897;
  t906 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t858 * t81 - 0.3e1 / 0.8e1 * t803 - 0.9e1 / 0.8e1 * t5 * t395 * t182 + t736 / 0.4e1 - 0.3e1 / 0.4e1 * t810 - 0.9e1 / 0.8e1 * t5 * t162 * t428 - t660 + t747 / 0.4e1 - 0.3e1 / 0.8e1 * t818 - 0.3e1 / 0.8e1 * t5 * t62 * t901);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t384 + 0.3e1 * t433 + t6 * (t845 + t906);

  t914 = t5 * t237 * t198;
  t921 = t5 * t246 * t198 / 0.12e2;
  t923 = t5 * t100 * t457;
  t939 = 0.1e1 / t34 / t113 / t254;
  t944 = 0.608e3 / 0.9e1 * t29 * sigma[0] * t256 * t45 - 0.2672e4 / 0.9e1 * t111 * t30 * t262 * t118 + 0.400e3 * t268 * t112 * t272 * t275 - 0.512e3 / 0.3e1 * t612 * t269 * t939 * t619;
  t949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t233 * t198 - t914 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t457 + t921 - t923 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t944);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t6 * t949 + 0.2e1 * t462;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t956 = t5 * t302 * t211;
  t960 = t5 * t306 * t211 / 0.12e2;
  t962 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t298 * t211 - t956 / 0.4e1 + t960);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t6 * t962 + 0.2e1 * t471;

  t968 = t5 * t327 * t198;
  t976 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t323 * t198 - t968 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t457 - t914 / 0.8e1 + t921 - t923 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t6 * t976 + t462 + t477;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t982 = t5 * t351 * t211;
  t989 = t5 * t138 * t497;
  t992 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t347 * t211 - t982 / 0.8e1 - t956 / 0.8e1 + t960 - 0.3e1 / 0.8e1 * t5 * t134 * t497 - t989 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t6 * t992 + t471 + t502;

  t1000 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t378 * t198 - t968 / 0.4e1 + t921);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t6 * t1000 + 0.2e1 * t477;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1025 = 0.1e1 / t67 / t173 / t405;
  t1030 = 0.608e3 / 0.9e1 * t29 * sigma[2] * t407 * t78 - 0.2672e4 / 0.9e1 * t111 * t63 * t413 * t178 + 0.400e3 * t268 * t172 * t421 * t424 - 0.512e3 / 0.3e1 * t612 * t418 * t1025 * t897;
  t1035 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t395 * t211 - t982 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t497 + t960 - t989 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t62 * t1030);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t6 * t1035 + 0.2e1 * t502;

  t1042 = t5 * t100 * t517 / 0.8e1;
  t1046 = t115 * t118;
  t1054 = t113 * t104;
  t1056 = 0.1e1 / t34 / t1054;
  t1061 = -0.32e2 / 0.3e1 * t29 * t106 * t45 + 0.224e3 / 0.3e1 * t111 * t1046 * sigma[0] - 0.128e3 * t268 * t30 * t452 * t275 + 0.64e2 * t612 * t112 * t1056 * t619;
  t1066 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t517 - t1042 - 0.3e1 / 0.8e1 * t5 * t27 * t1061);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t6 * t1066 + t521;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1073 = t5 * t138 * t535 / 0.8e1;
  t1075 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t134 * t535 - t1073);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = t6 * t1075 + t539;

  t1081 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t517 - t1042);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t6 * t1081 + t521;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1089 = t175 * t178;
  t1097 = t173 * t166;
  t1099 = 0.1e1 / t67 / t1097;
  t1104 = -0.32e2 / 0.3e1 * t29 * t168 * t78 + 0.224e3 / 0.3e1 * t111 * t1089 * sigma[2] - 0.128e3 * t268 * t63 * t492 * t424 + 0.64e2 * t612 * t172 * t1099 * t897;
  t1109 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t162 * t535 - t1073 - 0.3e1 / 0.8e1 * t5 * t62 * t1104);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t6 * t1109 + t539;

  t1119 = 0.1e1 / t34 / t604;
  t1124 = -0.24e2 * t612 * t30 * t1119 * t619 + 0.36e2 * t268 * sigma[0] * t512 * t275 - 0.12e2 * t111 * t193 * t118;
  t1128 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1124);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = t6 * t1128;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1137 = 0.1e1 / t67 / t884;
  t1142 = -0.24e2 * t612 * t63 * t1137 * t897 + 0.36e2 * t268 * sigma[2] * t530 * t424 - 0.12e2 * t111 * t206 * t178;
  t1146 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t62 * t1142);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = t6 * t1146;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1151 = t5 * t93 * t582 * t48;
  t1154 = 0.1e1 / t98 / t223;
  t1158 = 0.10e2 / 0.27e2 * t5 * t25 * t1154 * t48;
  t1161 = t5 * t559 * t99 * t48;
  t1165 = t5 * t232 * t245 * t48;
  t1167 = t19 * t19;
  t1169 = 0.1e1 / t218 / t1167;
  t1170 = t220 * t220;
  t1176 = t228 * t228;
  t1182 = 0.1e1 / t550 / t6;
  t1183 = t16 * t1182;
  t1186 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t551 + 0.24e2 * t1183);
  t1190 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1169 * t1170 - 0.16e2 / 0.9e1 * t543 * t220 * t228 + 0.4e1 / 0.3e1 * t219 * t1176 + 0.16e2 / 0.9e1 * t547 * t555 + 0.4e1 / 0.3e1 * t23 * t1186);
  t1199 = t5 * t564 * t122;
  t1205 = t5 * t571 * t122;
  t1207 = t5 * t237 * t279;
  t1213 = t5 * t583 * t122;
  t1216 = t5 * t246 * t279;
  t1219 = t5 * t100 * t623;
  t1238 = t614 * rho[0];
  t1246 = params->b * t267 * t28;
  t1252 = 0.1e1 / t274 / t44;
  t1260 = -0.5e1 / 0.9e1 * t1151 + t1158 - t1161 / 0.2e1 + t1165 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t1190 * t26 * t48 - 0.3e1 / 0.2e1 * t5 * t560 * t122 - 0.3e1 / 0.2e1 * t1199 - 0.9e1 / 0.4e1 * t5 * t233 * t279 + t1205 - 0.3e1 / 0.2e1 * t1207 - 0.3e1 / 0.2e1 * t5 * t94 * t623 - 0.5e1 / 0.9e1 * t1213 + t1216 / 0.2e1 - t1219 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.167200e6 / 0.81e2 * t29 * t30 / t34 / t114 * t45 - 0.948640e6 / 0.81e2 * t111 * t112 / t270 * t118 + 0.629120e6 / 0.27e2 * t268 * t269 / t39 / t1054 * t275 - 0.532480e6 / 0.27e2 * t612 * t613 / t34 / t1238 * t619 + 0.163840e6 / 0.27e2 * t1246 * t269 * t30 / t614 / t32 * t1252);
  t1261 = my_piecewise3(t1, 0, t1260);
  t1262 = t57 * t57;
  t1264 = 0.1e1 / t285 / t1262;
  t1265 = t287 * t287;
  t1271 = t293 * t293;
  t1276 = t54 * t1182;
  t1279 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t551 + 0.24e2 * t1276);
  t1283 = my_piecewise3(t58, 0, 0.40e2 / 0.81e2 * t1264 * t1265 - 0.16e2 / 0.9e1 * t630 * t287 * t293 + 0.4e1 / 0.3e1 * t286 * t1271 + 0.16e2 / 0.9e1 * t634 * t640 + 0.4e1 / 0.3e1 * t59 * t1279);
  t1290 = t5 * t644 * t99 * t81;
  t1294 = t5 * t297 * t245 * t81;
  t1298 = t5 * t133 * t582 * t81;
  t1303 = 0.10e2 / 0.27e2 * t5 * t61 * t1154 * t81;
  t1305 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t1283 * t26 * t81 - t1290 / 0.2e1 + t1294 / 0.2e1 - 0.5e1 / 0.9e1 * t1298 + t1303);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t628 + 0.4e1 * t662 + t6 * (t1261 + t1305);

  t1312 = t5 * t682 * t99 * t48;
  t1316 = t5 * t322 * t245 * t48;
  t1317 = t1316 / 0.4e1;
  t1320 = t5 * t150 * t582 * t48;
  t1341 = 0.12e2 * t551;
  t1342 = 0.24e2 * t1183;
  t1344 = my_piecewise5(t10, 0, t14, 0, -t1341 + t1342);
  t1348 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1169 * t147 * t544 - 0.8e1 / 0.9e1 * t543 * t318 * t220 - 0.8e1 / 0.9e1 * t667 * t90 * t228 + 0.4e1 / 0.3e1 * t219 * t678 * t90 + 0.4e1 / 0.3e1 * t670 * t228 + 0.4e1 / 0.9e1 * t314 * t555 + 0.4e1 / 0.3e1 * t23 * t1344);
  t1357 = t5 * t687 * t122;
  t1363 = t5 * t694 * t122;
  t1364 = t1363 / 0.4e1;
  t1366 = t5 * t327 * t279;
  t1377 = -0.3e1 / 0.8e1 * t1312 + t1317 - 0.5e1 / 0.36e2 * t1320 - 0.5e1 / 0.12e2 * t1151 + t1158 - t1161 / 0.8e1 + t1165 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t1348 * t26 * t48 - 0.9e1 / 0.8e1 * t5 * t683 * t122 - 0.3e1 / 0.4e1 * t1357 - 0.9e1 / 0.8e1 * t5 * t323 * t279 + t1364 - 0.3e1 / 0.8e1 * t1366 - 0.3e1 / 0.8e1 * t5 * t151 * t623 - 0.3e1 / 0.8e1 * t1199 + t1205 / 0.2e1 - 0.3e1 / 0.8e1 * t1207 - 0.5e1 / 0.12e2 * t1213 + t1216 / 0.4e1 - t1219 / 0.8e1;
  t1378 = my_piecewise3(t1, 0, t1377);
  t1395 = 0.24e2 * t1276;
  t1397 = my_piecewise5(t14, 0, t10, 0, t1341 + t1395);
  t1401 = my_piecewise3(t58, 0, 0.40e2 / 0.81e2 * t1264 * t158 * t631 - 0.8e1 / 0.9e1 * t630 * t342 * t287 - 0.8e1 / 0.9e1 * t711 * t130 * t293 + 0.4e1 / 0.3e1 * t286 * t721 * t130 + 0.4e1 / 0.3e1 * t714 * t293 + 0.4e1 / 0.9e1 * t338 * t640 + 0.4e1 / 0.3e1 * t59 * t1397);
  t1408 = t5 * t725 * t99 * t81;
  t1412 = t5 * t346 * t245 * t81;
  t1413 = t1412 / 0.4e1;
  t1416 = t5 * t161 * t582 * t81;
  t1425 = t5 * t649 * t182;
  t1428 = t5 * t653 * t182;
  t1429 = t1428 / 0.4e1;
  t1431 = t5 * t657 * t182;
  t1433 = -0.3e1 / 0.8e1 * t5 * t1401 * t26 * t81 - 0.3e1 / 0.8e1 * t1408 + t1413 - 0.5e1 / 0.36e2 * t1416 - t1290 / 0.8e1 + t1294 / 0.4e1 - 0.5e1 / 0.12e2 * t1298 + t1303 - 0.3e1 / 0.8e1 * t5 * t645 * t182 - 0.3e1 / 0.8e1 * t1425 + t1429 - 0.5e1 / 0.36e2 * t1431;
  t1434 = my_piecewise3(t53, 0, t1433);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t628 + t662 + 0.3e1 * t710 + 0.3e1 * t750 + t6 * (t1378 + t1434);

  t1443 = t5 * t766 * t99 * t48;
  t1447 = t5 * t377 * t245 * t48;
  t1462 = t318 * t318;
  t1475 = my_piecewise5(t10, 0, t14, 0, t1342);
  t1479 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1169 * t368 * t220 - 0.32e2 / 0.27e2 * t667 * t90 * t318 - 0.8e1 / 0.27e2 * t753 * t228 + 0.8e1 / 0.9e1 * t219 * t1462 + 0.8e1 / 0.9e1 * t314 * t678 - 0.8e1 / 0.27e2 * t543 * t373 * t220 + 0.8e1 / 0.9e1 * t219 * t762 * t90 + 0.4e1 / 0.9e1 * t758 * t228 + 0.4e1 / 0.3e1 * t23 * t1475);
  t1488 = t5 * t771 * t122;
  t1499 = -t1443 / 0.4e1 + t1447 / 0.12e2 - t1312 / 0.4e1 + t1316 / 0.3e1 - 0.5e1 / 0.18e2 * t1320 - 0.5e1 / 0.18e2 * t1151 + t1158 + t1165 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1479 * t26 * t48 - 0.3e1 / 0.4e1 * t5 * t767 * t122 - t1488 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t378 * t279 - t1357 / 0.2e1 + t1363 / 0.3e1 - t1366 / 0.4e1 + t1205 / 0.6e1 - 0.5e1 / 0.18e2 * t1213 + t1216 / 0.12e2;
  t1500 = my_piecewise3(t1, 0, t1499);
  t1509 = t342 * t342;
  t1522 = my_piecewise5(t14, 0, t10, 0, t1395);
  t1526 = my_piecewise3(t58, 0, 0.40e2 / 0.81e2 * t1264 * t385 * t287 - 0.32e2 / 0.27e2 * t711 * t130 * t342 - 0.8e1 / 0.27e2 * t783 * t293 + 0.8e1 / 0.9e1 * t286 * t1509 + 0.8e1 / 0.9e1 * t338 * t721 - 0.8e1 / 0.27e2 * t630 * t390 * t287 + 0.8e1 / 0.9e1 * t286 * t792 * t130 + 0.4e1 / 0.9e1 * t788 * t293 + 0.4e1 / 0.3e1 * t59 * t1522);
  t1533 = t5 * t796 * t99 * t81;
  t1537 = t5 * t394 * t245 * t81;
  t1546 = t5 * t730 * t182;
  t1549 = t5 * t734 * t182;
  t1560 = t5 * t302 * t428;
  t1563 = t5 * t306 * t428;
  t1565 = -0.3e1 / 0.8e1 * t5 * t1526 * t26 * t81 - t1533 / 0.4e1 + t1537 / 0.12e2 - t1408 / 0.4e1 + t1412 / 0.3e1 - 0.5e1 / 0.18e2 * t1416 - 0.3e1 / 0.4e1 * t5 * t726 * t182 - t1546 / 0.2e1 + t1549 / 0.6e1 + t1294 / 0.12e2 - 0.5e1 / 0.18e2 * t1298 + t1303 - t1425 / 0.4e1 + t1428 / 0.3e1 - 0.5e1 / 0.18e2 * t1431 - 0.3e1 / 0.8e1 * t5 * t298 * t428 - t1560 / 0.4e1 + t1563 / 0.12e2;
  t1566 = my_piecewise3(t53, 0, t1565);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t710 + 0.2e1 * t750 + 0.2e1 * t782 + 0.2e1 * t821 + t6 * (t1500 + t1566);

  t1587 = my_piecewise5(t10, 0, t14, 0, t1341 + t1342);
  t1591 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1169 * t826 * t90 - 0.8e1 / 0.9e1 * t753 * t318 - 0.8e1 / 0.9e1 * t667 * t373 * t90 + 0.4e1 / 0.3e1 * t670 * t373 + 0.4e1 / 0.3e1 * t314 * t762 + 0.4e1 / 0.9e1 * t219 * t833 * t90 + 0.4e1 / 0.3e1 * t23 * t1587);
  t1598 = t5 * t837 * t99 * t48;
  t1609 = -0.3e1 / 0.8e1 * t5 * t1591 * t26 * t48 - t1598 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t838 * t122 - 0.3e1 / 0.8e1 * t1443 + t1447 / 0.4e1 - 0.3e1 / 0.8e1 * t1488 + t1317 - 0.5e1 / 0.12e2 * t1320 + t1364 - 0.5e1 / 0.36e2 * t1151 + t1158 - 0.5e1 / 0.36e2 * t1213;
  t1610 = my_piecewise3(t1, 0, t1609);
  t1627 = my_piecewise5(t14, 0, t10, 0, -t1341 + t1395);
  t1631 = my_piecewise3(t58, 0, 0.40e2 / 0.81e2 * t1264 * t846 * t130 - 0.8e1 / 0.9e1 * t783 * t342 - 0.8e1 / 0.9e1 * t711 * t390 * t130 + 0.4e1 / 0.3e1 * t714 * t390 + 0.4e1 / 0.3e1 * t338 * t792 + 0.4e1 / 0.9e1 * t286 * t853 * t130 + 0.4e1 / 0.3e1 * t59 * t1627);
  t1638 = t5 * t857 * t99 * t81;
  t1646 = t5 * t801 * t182;
  t1655 = t5 * t351 * t428;
  t1665 = t5 * t138 * t901;
  t1667 = -0.3e1 / 0.8e1 * t5 * t1631 * t26 * t81 - t1638 / 0.8e1 - 0.3e1 / 0.8e1 * t1533 + t1537 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t797 * t182 - 0.3e1 / 0.8e1 * t1646 + t1413 - 0.5e1 / 0.12e2 * t1416 - 0.3e1 / 0.4e1 * t1546 + t1549 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t347 * t428 - 0.3e1 / 0.8e1 * t1655 - 0.5e1 / 0.36e2 * t1298 + t1303 + t1429 - 0.5e1 / 0.12e2 * t1431 - 0.3e1 / 0.8e1 * t1560 + t1563 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t134 * t901 - t1665 / 0.8e1;
  t1668 = my_piecewise3(t53, 0, t1667);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t782 + 0.3e1 * t821 + t845 + t906 + t6 * (t1610 + t1668);

  t1673 = t368 * t368;
  t1678 = t373 * t373;
  t1685 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t551 + 0.24e2 * t1183);
  t1689 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1169 * t1673 - 0.16e2 / 0.9e1 * t753 * t373 + 0.4e1 / 0.3e1 * t219 * t1678 + 0.16e2 / 0.9e1 * t314 * t833 + 0.4e1 / 0.3e1 * t23 * t1685);
  t1698 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1689 * t26 * t48 - t1598 / 0.2e1 + t1447 / 0.2e1 - 0.5e1 / 0.9e1 * t1320 + t1158);
  t1699 = t385 * t385;
  t1704 = t390 * t390;
  t1711 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t551 + 0.24e2 * t1276);
  t1715 = my_piecewise3(t58, 0, 0.40e2 / 0.81e2 * t1264 * t1699 - 0.16e2 / 0.9e1 * t783 * t390 + 0.4e1 / 0.3e1 * t286 * t1704 + 0.16e2 / 0.9e1 * t338 * t853 + 0.4e1 / 0.3e1 * t59 * t1711);
  t1746 = t892 * rho[1];
  t1758 = 0.1e1 / t423 / t77;
  t1774 = -0.3e1 / 0.8e1 * t5 * t1715 * t26 * t81 - 0.3e1 / 0.2e1 * t5 * t858 * t182 - 0.9e1 / 0.4e1 * t5 * t395 * t428 - 0.3e1 / 0.2e1 * t5 * t162 * t901 - 0.3e1 / 0.8e1 * t5 * t62 * (0.167200e6 / 0.81e2 * t29 * t63 / t67 / t174 * t78 - 0.948640e6 / 0.81e2 * t111 * t172 / t419 * t178 + 0.629120e6 / 0.27e2 * t268 * t418 / t72 / t1097 * t424 - 0.532480e6 / 0.27e2 * t612 * t891 / t67 / t1746 * t897 + 0.163840e6 / 0.27e2 * t1246 * t418 * t63 / t892 / t65 * t1758) - 0.3e1 / 0.2e1 * t1655 - t1665 / 0.2e1 + t1537 / 0.2e1 + t1549 + t1563 / 0.2e1 - t1638 / 0.2e1 - 0.3e1 / 0.2e1 * t1646 - 0.5e1 / 0.9e1 * t1416 - 0.5e1 / 0.9e1 * t1431 + t1303;
  t1775 = my_piecewise3(t53, 0, t1774);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t845 + 0.4e1 * t906 + t6 * (t1698 + t1775);

  t1783 = t5 * t564 * t198;
  t1789 = t5 * t571 * t198;
  t1792 = t5 * t237 * t457;
  t1799 = 0.5e1 / 0.36e2 * t5 * t583 * t198;
  t1801 = t5 * t246 * t457;
  t1804 = t5 * t100 * t944;
  t1833 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t560 * t198 - 0.3e1 / 0.8e1 * t1783 - 0.9e1 / 0.8e1 * t5 * t233 * t457 + t1789 / 0.4e1 - 0.3e1 / 0.4e1 * t1792 - 0.9e1 / 0.8e1 * t5 * t94 * t944 - t1799 + t1801 / 0.4e1 - 0.3e1 / 0.8e1 * t1804 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.13376e5 / 0.27e2 * t29 * sigma[0] * t594 * t45 + 0.89888e5 / 0.27e2 * t111 * t30 * t599 * t118 - 0.66976e5 / 0.9e1 * t268 * t112 * t606 * t275 + 0.61952e5 / 0.9e1 * t612 * t269 * t616 * t619 - 0.20480e5 / 0.9e1 * t1246 * t613 / t614 / t253 * t1252));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t6 * t1833 + 0.3e1 * t949;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  t1840 = t5 * t649 * t211;
  t1843 = t5 * t653 * t211;
  t1847 = 0.5e1 / 0.36e2 * t5 * t657 * t211;
  t1849 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t645 * t211 - 0.3e1 / 0.8e1 * t1840 + t1843 / 0.4e1 - t1847);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t6 * t1849 + 0.3e1 * t962;

  t1851 = 0.2e1 * t976;
  t1857 = t5 * t687 * t198 / 0.4e1;
  t1862 = t5 * t694 * t198;
  t1866 = t5 * t327 * t457 / 0.4e1;
  t1875 = -0.3e1 / 0.8e1 * t5 * t683 * t198 - t1857 - 0.3e1 / 0.4e1 * t5 * t323 * t457 + t1862 / 0.12e2 - t1866 - 0.3e1 / 0.8e1 * t5 * t151 * t944 - t1783 / 0.8e1 + t1789 / 0.6e1 - t1792 / 0.4e1 - t1799 + t1801 / 0.6e1 - t1804 / 0.8e1;
  t1876 = my_piecewise3(t1, 0, t1875);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t6 * t1876 + t1851 + t949;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  t1878 = 0.2e1 * t992;
  t1884 = t5 * t730 * t211 / 0.4e1;
  t1886 = t5 * t734 * t211;
  t1895 = t5 * t302 * t497 / 0.4e1;
  t1897 = t5 * t306 * t497;
  t1900 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t726 * t211 - t1884 + t1886 / 0.12e2 - t1840 / 0.8e1 + t1843 / 0.6e1 - t1847 - 0.3e1 / 0.8e1 * t5 * t298 * t497 - t1895 + t1897 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t6 * t1900 + t1878 + t962;

  t1906 = t5 * t771 * t198;
  t1915 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t767 * t198 - t1906 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t378 * t457 - t1857 + t1862 / 0.6e1 - t1866 + t1789 / 0.12e2 - t1799 + t1801 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t6 * t1915 + t1000 + t1851;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  t1921 = t5 * t801 * t211;
  t1928 = t5 * t351 * t497;
  t1936 = t5 * t138 * t1030;
  t1938 = -0.3e1 / 0.8e1 * t5 * t797 * t211 - t1921 / 0.8e1 - t1884 + t1886 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t347 * t497 - t1928 / 0.4e1 + t1843 / 0.12e2 - t1847 - t1895 + t1897 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t134 * t1030 - t1936 / 0.8e1;
  t1939 = my_piecewise3(t53, 0, t1938);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t6 * t1939 + t1035 + t1878;

  t1948 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t838 * t198 - 0.3e1 / 0.8e1 * t1906 + t1862 / 0.4e1 - t1799);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t6 * t1948 + 0.3e1 * t1000;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  t1992 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t858 * t211 - 0.3e1 / 0.8e1 * t1921 - 0.9e1 / 0.8e1 * t5 * t395 * t497 + t1886 / 0.4e1 - 0.3e1 / 0.4e1 * t1928 - 0.9e1 / 0.8e1 * t5 * t162 * t1030 - t1847 + t1897 / 0.4e1 - 0.3e1 / 0.8e1 * t1936 - 0.3e1 / 0.8e1 * t5 * t62 * (-0.13376e5 / 0.27e2 * t29 * sigma[2] * t874 * t78 + 0.89888e5 / 0.27e2 * t111 * t63 * t879 * t178 - 0.66976e5 / 0.9e1 * t268 * t172 * t886 * t424 + 0.61952e5 / 0.9e1 * t612 * t418 * t894 * t897 - 0.20480e5 / 0.9e1 * t1246 * t891 / t892 / t404 * t1758));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = t6 * t1992 + 0.3e1 * t1035;

  t1999 = t5 * t237 * t517;
  t2006 = t5 * t246 * t517 / 0.12e2;
  t2008 = t5 * t100 * t1061;
  t2036 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t233 * t517 - t1999 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t1061 + t2006 - t2008 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.608e3 / 0.9e1 * t29 * t256 * t45 - 0.6560e4 / 0.9e1 * t111 * t262 * t118 * sigma[0] + 0.6272e4 / 0.3e1 * t268 * t272 * t275 * t30 - 0.6848e4 / 0.3e1 * t612 * t112 * t939 * t619 + 0.2560e4 / 0.3e1 * t1246 * t269 / t614 / t31 * t1252));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = t6 * t2036 + 0.2e1 * t1066;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  t2043 = t5 * t302 * t535;
  t2047 = t5 * t306 * t535 / 0.12e2;
  t2049 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t298 * t535 - t2043 / 0.4e1 + t2047);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = t6 * t2049 + 0.2e1 * t1075;

  t2055 = t5 * t327 * t517;
  t2063 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t323 * t517 - t2055 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t151 * t1061 - t1999 / 0.8e1 + t2006 - t2008 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t6 * t2063 + t1066 + t1081;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t2069 = t5 * t351 * t535;
  t2076 = t5 * t138 * t1104;
  t2079 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t347 * t535 - t2069 / 0.8e1 - t2043 / 0.8e1 + t2047 - 0.3e1 / 0.8e1 * t5 * t134 * t1104 - t2076 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = t6 * t2079 + t1075 + t1109;

  t2087 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t378 * t517 - t2055 / 0.4e1 + t2006);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = t6 * t2087 + 0.2e1 * t1081;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t2124 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t395 * t535 - t2069 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t162 * t1104 + t2047 - t2076 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t62 * (0.608e3 / 0.9e1 * t29 * t407 * t78 - 0.6560e4 / 0.9e1 * t111 * t413 * t178 * sigma[2] + 0.6272e4 / 0.3e1 * t268 * t421 * t424 * t63 - 0.6848e4 / 0.3e1 * t612 * t172 * t1025 * t897 + 0.2560e4 / 0.3e1 * t1246 * t418 / t892 / t64 * t1758));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = t6 * t2124 + 0.2e1 * t1109;

  t2131 = t5 * t100 * t1124 / 0.8e1;
  t2152 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t1124 - t2131 - 0.3e1 / 0.8e1 * t5 * t27 * (0.96e2 * t111 * t1046 - 0.480e3 * t268 * t452 * t275 * sigma[0] + 0.704e3 * t612 * t30 * t1056 * t619 - 0.320e3 * t1246 * t112 / t1238 * t1252));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t6 * t2152 + t1128;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  t2159 = t5 * t138 * t1142 / 0.8e1;
  t2161 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t134 * t1142 - t2159);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t6 * t2161 + t1146;

  t2167 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t151 * t1124 - t2131);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t6 * t2167 + t1128;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t2192 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t162 * t1142 - t2159 - 0.3e1 / 0.8e1 * t5 * t62 * (0.96e2 * t111 * t1089 - 0.480e3 * t268 * t492 * t424 * sigma[2] + 0.704e3 * t612 * t63 * t1099 * t897 - 0.320e3 * t1246 * t172 / t1746 * t1758));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t6 * t2192 + t1146;

  t2210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (0.72e2 * t268 * t512 * t275 - 0.192e3 * t612 * sigma[0] * t1119 * t619 + 0.120e3 * t1246 * t30 / t614 * t1252));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = t6 * t2210;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t2227 = my_piecewise3(t53, 0, -0.3e1 / 0.8e1 * t5 * t62 * (0.72e2 * t268 * t530 * t424 - 0.192e3 * t612 * sigma[2] * t1137 * t897 + 0.120e3 * t1246 * t63 / t892 * t1758));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = t6 * t2227;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

