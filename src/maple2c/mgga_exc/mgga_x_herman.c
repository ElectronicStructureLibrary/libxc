/*
  This file was generated automatically with ./scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/mgga_x_herman.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 3
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t24;
  double t25, t28, t31, t33, t36, t40, tzk0;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = rho[0] * rho[0];
  t22 = t19 * t19;
  t24 = 0.1e1 / t22 / t21;
  t25 = sigma[0] * t24;
  t28 = 0.1e1 / t22 / rho[0];
  t31 = 0.4e1 / 0.3e1 * t25 - 0.2e1 * lapl[0] * t28;
  t33 = exp(-0.314e-2 * t25);
  t36 = 0.1e1 + 0.942e-2 * t31 * t33;
  t40 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t36);
  tzk0 = 0.2e1 * t40;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t24;
  double t25, t28, t31, t33, t36, t40, tzk0;

  double t42, t46, t48, t53, t56, t57, t60, t65;
  double tvrho0, t73, t77, tvsigma0, t79, t85, tvlapl0, tvtau0;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = rho[0] * rho[0];
  t22 = t19 * t19;
  t24 = 0.1e1 / t22 / t21;
  t25 = sigma[0] * t24;
  t28 = 0.1e1 / t22 / rho[0];
  t31 = 0.4e1 / 0.3e1 * t25 - 0.2e1 * lapl[0] * t28;
  t33 = exp(-0.314e-2 * t25);
  t36 = 0.1e1 + 0.942e-2 * t31 * t33;
  t40 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t36);
  tzk0 = 0.2e1 * t40;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t42 = t18 / t22;
  t46 = t21 * rho[0];
  t48 = 0.1e1 / t22 / t46;
  t53 = -0.32e2 / 0.9e1 * sigma[0] * t48 + 0.1e2 / 0.3e1 * lapl[0] * t24;
  t56 = t31 * sigma[0];
  t57 = t48 * t33;
  t60 = 0.942e-2 * t53 * t33 + 0.788768e-4 * t56 * t57;
  t65 = my_piecewise3(t3, 0, -t7 * t42 * t36 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t60);
  tvrho0 = 0.2e1 * rho[0] * t65 + 0.2e1 * t40;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t73 = 0.1256e-1 * t24 * t33 - 0.295788e-4 * t31 * t24 * t33;
  t77 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t73);
  tvsigma0 = 0.2e1 * rho[0] * t77;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t4 * t18;
  t85 = my_piecewise3(t3, 0, 0.48238694068986639896e-2 * t79 / t19 / rho[0] * t33);
  tvlapl0 = 0.2e1 * rho[0] * t85;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t24;
  double t25, t28, t31, t33, t36, t40, tzk0;

  double t42, t46, t48, t53, t56, t57, t60, t65;
  double tvrho0, t73, t77, tvsigma0, t79, t85, tvlapl0, tvtau0;

  double t88, t95, t97, t102, t105, t108, t111, t112;
  double t113, t115, t116, t119, t124, tv2rho20, t131, t133;
  double t143, t144, t147, t152, tv2rhosigma0, t160, t161, t167;
  double tv2rholapl0, tv2rhotau0, t171, t177, t181, tv2sigma20, t187, tv2sigmalapl0;
  double tv2sigmatau0, tv2lapl20, tv2lapltau0, tv2tau20;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = rho[0] * rho[0];
  t22 = t19 * t19;
  t24 = 0.1e1 / t22 / t21;
  t25 = sigma[0] * t24;
  t28 = 0.1e1 / t22 / rho[0];
  t31 = 0.4e1 / 0.3e1 * t25 - 0.2e1 * lapl[0] * t28;
  t33 = exp(-0.314e-2 * t25);
  t36 = 0.1e1 + 0.942e-2 * t31 * t33;
  t40 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t36);
  tzk0 = 0.2e1 * t40;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t42 = t18 / t22;
  t46 = t21 * rho[0];
  t48 = 0.1e1 / t22 / t46;
  t53 = -0.32e2 / 0.9e1 * sigma[0] * t48 + 0.1e2 / 0.3e1 * lapl[0] * t24;
  t56 = t31 * sigma[0];
  t57 = t48 * t33;
  t60 = 0.942e-2 * t53 * t33 + 0.788768e-4 * t56 * t57;
  t65 = my_piecewise3(t3, 0, -t7 * t42 * t36 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t60);
  tvrho0 = 0.2e1 * rho[0] * t65 + 0.2e1 * t40;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t73 = 0.1256e-1 * t24 * t33 - 0.295788e-4 * t31 * t24 * t33;
  t77 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t73);
  tvsigma0 = 0.2e1 * rho[0] * t77;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t4 * t18;
  t85 = my_piecewise3(t3, 0, 0.48238694068986639896e-2 * t79 / t19 / rho[0] * t33);
  tvlapl0 = 0.2e1 * rho[0] * t85;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t88 = t18 * t28;
  t95 = t21 * t21;
  t97 = 0.1e1 / t22 / t95;
  t102 = 0.352e3 / 0.27e2 * sigma[0] * t97 - 0.8e2 / 0.9e1 * lapl[0] * t48;
  t105 = t53 * sigma[0];
  t108 = t97 * t33;
  t111 = sigma[0] * sigma[0];
  t112 = t31 * t111;
  t113 = t95 * t46;
  t115 = 0.1e1 / t19 / t113;
  t116 = t115 * t33;
  t119 = 0.942e-2 * t102 * t33 + 0.1577536e-3 * t105 * t57 - 0.28921493333333333333e-3 * t56 * t108 + 0.66046173866666666666e-6 * t112 * t116;
  t124 = my_piecewise3(t3, 0, t7 * t88 * t36 / 0.12e2 - t7 * t42 * t60 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t119);
  tv2rho20 = 0.2e1 * rho[0] * t124 + 0.4e1 * t65;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t131 = t95 * t21;
  t133 = 0.1e1 / t19 / t131;
  t143 = t31 * t133;
  t144 = sigma[0] * t33;
  t147 = -0.33493333333333333333e-1 * t57 + 0.10516906666666666667e-3 * t133 * sigma[0] * t33 - 0.295788e-4 * t53 * t24 * t33 + 0.788768e-4 * t31 * t48 * t33 - 0.247673152e-6 * t143 * t144;
  t152 = my_piecewise3(t3, 0, -t7 * t42 * t73 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t147);
  tv2rhosigma0 = 0.2e1 * rho[0] * t152 + 0.2e1 * t77;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t160 = t95 * rho[0];
  t161 = 0.1e1 / t160;
  t167 = my_piecewise3(t3, 0, -0.64318258758648853195e-2 * t79 / t19 / t21 * t33 + 0.40391866500431479806e-4 * t79 * t161 * sigma[0] * t33);
  tv2rholapl0 = 0.2e1 * rho[0] * t167 + 0.2e1 * t85;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t171 = 0.1e1 / t19 / t160;
  t177 = -0.788768e-4 * t171 * t33 + 0.92877432e-7 * t31 * t171 * t33;
  t181 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t177);
  tv2sigma20 = 0.2e1 * rho[0] * t181;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t187 = my_piecewise3(t3, 0, -0.15146949937661804927e-4 * t79 / t95 * t33);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t187;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t24;
  double t25, t28, t31, t33, t36, t40, tzk0;

  double t42, t46, t48, t53, t56, t57, t60, t65;
  double tvrho0, t73, t77, tvsigma0, t79, t85, tvlapl0, tvtau0;

  double t88, t95, t97, t102, t105, t108, t111, t112;
  double t113, t115, t116, t119, t124, tv2rho20, t131, t133;
  double t143, t144, t147, t152, tv2rhosigma0, t160, t161, t167;
  double tv2rholapl0, tv2rhotau0, t171, t177, t181, tv2sigma20, t187, tv2sigmalapl0;
  double tv2sigmatau0, tv2lapl20, tv2lapltau0, tv2tau20;

  double t201, t220, t238, tv3rho30, t253, t281, tv3rho2sigma0, t302;
  double tv3rho2lapl0, tv3rho2tau0, t311, t328, tv3rhosigma20, t341, tv3rhosigmalapl0, tv3rhosigmatau0;
  double tv3rholapl20, tv3rholapltau0, tv3rhotau20, t344, t354, tv3sigma30, t361, tv3sigma2lapl0;
  double tv3sigma2tau0, tv3sigmalapl20, tv3sigmalapltau0, tv3sigmatau20, tv3lapl30, tv3lapl2tau0, tv3lapltau20, tv3tau30;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = rho[0] * rho[0];
  t22 = t19 * t19;
  t24 = 0.1e1 / t22 / t21;
  t25 = sigma[0] * t24;
  t28 = 0.1e1 / t22 / rho[0];
  t31 = 0.4e1 / 0.3e1 * t25 - 0.2e1 * lapl[0] * t28;
  t33 = exp(-0.314e-2 * t25);
  t36 = 0.1e1 + 0.942e-2 * t31 * t33;
  t40 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t36);
  tzk0 = 0.2e1 * t40;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t42 = t18 / t22;
  t46 = t21 * rho[0];
  t48 = 0.1e1 / t22 / t46;
  t53 = -0.32e2 / 0.9e1 * sigma[0] * t48 + 0.1e2 / 0.3e1 * lapl[0] * t24;
  t56 = t31 * sigma[0];
  t57 = t48 * t33;
  t60 = 0.942e-2 * t53 * t33 + 0.788768e-4 * t56 * t57;
  t65 = my_piecewise3(t3, 0, -t7 * t42 * t36 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t60);
  tvrho0 = 0.2e1 * rho[0] * t65 + 0.2e1 * t40;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t73 = 0.1256e-1 * t24 * t33 - 0.295788e-4 * t31 * t24 * t33;
  t77 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t73);
  tvsigma0 = 0.2e1 * rho[0] * t77;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t4 * t18;
  t85 = my_piecewise3(t3, 0, 0.48238694068986639896e-2 * t79 / t19 / rho[0] * t33);
  tvlapl0 = 0.2e1 * rho[0] * t85;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t88 = t18 * t28;
  t95 = t21 * t21;
  t97 = 0.1e1 / t22 / t95;
  t102 = 0.352e3 / 0.27e2 * sigma[0] * t97 - 0.8e2 / 0.9e1 * lapl[0] * t48;
  t105 = t53 * sigma[0];
  t108 = t97 * t33;
  t111 = sigma[0] * sigma[0];
  t112 = t31 * t111;
  t113 = t95 * t46;
  t115 = 0.1e1 / t19 / t113;
  t116 = t115 * t33;
  t119 = 0.942e-2 * t102 * t33 + 0.1577536e-3 * t105 * t57 - 0.28921493333333333333e-3 * t56 * t108 + 0.66046173866666666666e-6 * t112 * t116;
  t124 = my_piecewise3(t3, 0, t7 * t88 * t36 / 0.12e2 - t7 * t42 * t60 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t119);
  tv2rho20 = 0.2e1 * rho[0] * t124 + 0.4e1 * t65;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t131 = t95 * t21;
  t133 = 0.1e1 / t19 / t131;
  t143 = t31 * t133;
  t144 = sigma[0] * t33;
  t147 = -0.33493333333333333333e-1 * t57 + 0.10516906666666666667e-3 * t133 * sigma[0] * t33 - 0.295788e-4 * t53 * t24 * t33 + 0.788768e-4 * t31 * t48 * t33 - 0.247673152e-6 * t143 * t144;
  t152 = my_piecewise3(t3, 0, -t7 * t42 * t73 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t147);
  tv2rhosigma0 = 0.2e1 * rho[0] * t152 + 0.2e1 * t77;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t160 = t95 * rho[0];
  t161 = 0.1e1 / t160;
  t167 = my_piecewise3(t3, 0, -0.64318258758648853195e-2 * t79 / t19 / t21 * t33 + 0.40391866500431479806e-4 * t79 * t161 * sigma[0] * t33);
  tv2rholapl0 = 0.2e1 * rho[0] * t167 + 0.2e1 * t85;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t171 = 0.1e1 / t19 / t160;
  t177 = -0.788768e-4 * t171 * t33 + 0.92877432e-7 * t31 * t171 * t33;
  t181 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t177);
  tv2sigma20 = 0.2e1 * rho[0] * t181;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t187 = my_piecewise3(t3, 0, -0.15146949937661804927e-4 * t79 / t95 * t33);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t187;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  t201 = 0.1e1 / t22 / t160;
  t220 = t95 * t95;
  t238 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t18 * t24 * t36 + t7 * t88 * t60 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t42 * t119 - 0.3e1 / 0.8e1 * t7 * t20 * (0.942e-2 * (-0.4928e4 / 0.81e2 * sigma[0] * t201 + 0.88e3 / 0.27e2 * lapl[0] * t97) * t33 + 0.2366304e-3 * t102 * sigma[0] * t57 - 0.8676448e-3 * t105 * t108 + 0.1981385216e-5 * t53 * t111 * t116 + 0.13496696888888888889e-2 * t56 * t201 * t33 - 0.72650791253333333332e-5 * t112 / t19 / t220 * t33 + 0.55302662917688888888e-8 * t31 * t111 * sigma[0] / t220 / t46 * t33));
  tv3rho30 = 0.2e1 * rho[0] * t238 + 0.6e1 * t124;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t253 = 0.1e1 / t220 / t21;
  t281 = my_piecewise3(t3, 0, t7 * t88 * t73 / 0.12e2 - t7 * t42 * t147 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (0.12280888888888888889e0 * t108 - 0.94652160000000000002e-3 * t115 * sigma[0] * t33 + 0.88061565155555555558e-6 * t253 * t111 * t33 - 0.295788e-4 * t102 * t24 * t33 + 0.1577536e-3 * t53 * t48 * t33 - 0.495346304e-6 * t53 * t133 * t144 - 0.28921493333333333333e-3 * t31 * t97 * t33 + 0.2229058368e-5 * t31 * t115 * t144 - 0.20738498594133333333e-8 * t31 * t253 * t111 * t33));
  tv3rho2sigma0 = 0.2e1 * rho[0] * t281 + 0.4e1 * t152;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t302 = my_piecewise3(t3, 0, 0.15007593710351399079e-1 * t79 / t19 / t46 * t33 - 0.25581515450273270544e-3 * t79 / t131 * sigma[0] * t33 + 0.33821456216361292424e-6 * t79 / t22 / t220 * t111 * t33);
  tv3rho2lapl0 = 0.2e1 * rho[0] * t302 + 0.4e1 * t167;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t311 = 0.1e1 / t220 / rho[0];
  t328 = my_piecewise3(t3, 0, -t7 * t42 * t177 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (0.42067626666666666667e-3 * t133 * t33 - 0.66046173866666666666e-6 * t311 * sigma[0] * t33 + 0.92877432e-7 * t53 * t171 * t33 - 0.495346304e-6 * t143 * t33 + 0.77769369728e-9 * t31 * t311 * t144));
  tv3rhosigma20 = 0.2e1 * rho[0] * t328 + 0.2e1 * t181;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t341 = my_piecewise3(t3, 0, 0.60587799750647219708e-4 * t79 * t161 * t33 - 0.12683046081135484659e-6 * t79 / t22 / t113 * sigma[0] * t33);
  tv3rhosigmalapl0 = 0.2e1 * rho[0] * t341 + 0.2e1 * t187;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rhotau20 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  t344 = 0.1e1 / t220;
  t354 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (0.371509728e-6 * t344 * t33 - 0.29163513648e-9 * t31 * t344 * t33));
  tv3sigma30 = 0.2e1 * rho[0] * t354;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t361 = my_piecewise3(t3, 0, 0.47561422804258067471e-7 * t79 / t22 / t131 * t33);
  tv3sigma2lapl0 = 0.2e1 * rho[0] * t361;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2tau0 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmatau20 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3tau30 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t28, t29, t30, t31;
  double t33, t35, t36, t39, t42, t44, t47, t51;
  double t52, t53, t54, t55, t56, t58, t59, t60;
  double t61, t62, t64, t66, t69, t72, t74, t77;
  double t81, tzk0;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t35 = M_CBRT2;
  t36 = sigma[0] * t33 * t35;
  t39 = 0.1e1 / t31 / rho[0];
  t42 = 0.2e1 / 0.3e1 * t36 - lapl[0] * t39 * t35;
  t44 = exp(-0.157e-2 * t36);
  t47 = 0.1e1 + 0.942e-2 * t42 * t44;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t15, t12, t11, t16, -t18);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t23, t56 * t54);
  t59 = t58 * t27;
  t60 = rho[1] * rho[1];
  t61 = POW_1_3(rho[1]);
  t62 = t61 * t61;
  t64 = 0.1e1 / t62 / t60;
  t66 = sigma[2] * t64 * t35;
  t69 = 0.1e1 / t62 / rho[1];
  t72 = 0.2e1 / 0.3e1 * t66 - lapl[1] * t69 * t35;
  t74 = exp(-0.157e-2 * t66);
  t77 = 0.1e1 + 0.942e-2 * t72 * t74;
  t81 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t77);
  tzk0 = t51 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t28, t29, t30, t31;
  double t33, t35, t36, t39, t42, t44, t47, t51;
  double t52, t53, t54, t55, t56, t58, t59, t60;
  double t61, t62, t64, t66, t69, t72, t74, t77;
  double t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t109, t112, t114;
  double t117, t122, t124, t127, t128, t132, t135, t137;
  double tvrho0, t140, t141, t144, t145, t150, t152, t155;
  double t156, t160, t162, t169, t172, t174, t177, t182;
  double tvrho1, t186, t189, t192, t196, tvsigma0, tvsigma1, t198;
  double t201, t204, t208, tvsigma2, t209, t210, t212, t215;
  double tvlapl0, t216, t217, t219, t222, tvlapl1, tvtau0, tvtau1;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t35 = M_CBRT2;
  t36 = sigma[0] * t33 * t35;
  t39 = 0.1e1 / t31 / rho[0];
  t42 = 0.2e1 / 0.3e1 * t36 - lapl[0] * t39 * t35;
  t44 = exp(-0.157e-2 * t36);
  t47 = 0.1e1 + 0.942e-2 * t42 * t44;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t15, t12, t11, t16, -t18);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t23, t56 * t54);
  t59 = t58 * t27;
  t60 = rho[1] * rho[1];
  t61 = POW_1_3(rho[1]);
  t62 = t61 * t61;
  t64 = 0.1e1 / t62 / t60;
  t66 = sigma[2] * t64 * t35;
  t69 = 0.1e1 / t62 / rho[1];
  t72 = 0.2e1 / 0.3e1 * t66 - lapl[1] * t69 * t35;
  t74 = exp(-0.157e-2 * t66);
  t77 = 0.1e1 + 0.942e-2 * t72 * t74;
  t81 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t77);
  tzk0 = t51 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t7 * t7;
  t83 = 0.1e1 / t82;
  t84 = t17 * t83;
  t85 = t8 - t84;
  t86 = my_piecewise5(t11, 0, t15, 0, t85);
  t89 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t86);
  t90 = t89 * t27;
  t94 = t27 * t27;
  t95 = 0.1e1 / t94;
  t96 = t26 * t95;
  t99 = t6 * t96 * t47 / 0.8e1;
  t100 = t29 * rho[0];
  t102 = 0.1e1 / t31 / t100;
  t109 = -0.16e2 / 0.9e1 * sigma[0] * t102 * t35 + 0.5e1 / 0.3e1 * lapl[0] * t33 * t35;
  t112 = t42 * sigma[0];
  t114 = t102 * t35 * t44;
  t117 = 0.942e-2 * t109 * t44 + 0.394384e-4 * t112 * t114;
  t122 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t47 - t99 - 0.3e1 / 0.8e1 * t6 * t28 * t117);
  t124 = my_piecewise5(t15, 0, t11, 0, -t85);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t27;
  t132 = t58 * t95;
  t135 = t6 * t132 * t77 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t77 - t135);
  tvrho0 = t51 + t81 + t7 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t8 - t84;
  t141 = my_piecewise5(t11, 0, t15, 0, t140);
  t144 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t141);
  t145 = t144 * t27;
  t150 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t47 - t99);
  t152 = my_piecewise5(t15, 0, t11, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t27;
  t160 = t60 * rho[1];
  t162 = 0.1e1 / t62 / t160;
  t169 = -0.16e2 / 0.9e1 * sigma[2] * t162 * t35 + 0.5e1 / 0.3e1 * lapl[1] * t64 * t35;
  t172 = t72 * sigma[2];
  t174 = t162 * t35 * t74;
  t177 = 0.942e-2 * t169 * t74 + 0.394384e-4 * t172 * t174;
  t182 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t77 - t135 - 0.3e1 / 0.8e1 * t6 * t59 * t177);
  tvrho1 = t51 + t81 + t7 * (t150 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = t33 * t35 * t44;
  t189 = t35 * t44;
  t192 = 0.628e-2 * t186 - 0.147894e-4 * t42 * t33 * t189;
  t196 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t192);
  tvsigma0 = t7 * t196;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t198 = t64 * t35 * t74;
  t201 = t35 * t74;
  t204 = 0.628e-2 * t198 - 0.147894e-4 * t72 * t64 * t201;
  t208 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t204);
  tvsigma2 = t7 * t208;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t209 = t3 * t26;
  t210 = t209 * t27;
  t212 = t39 * t35 * t44;
  t215 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t210 * t212);
  tvlapl0 = t7 * t215;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t216 = t3 * t58;
  t217 = t216 * t27;
  t219 = t69 * t35 * t74;
  t222 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t217 * t219);
  tvlapl1 = t7 * t222;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t28, t29, t30, t31;
  double t33, t35, t36, t39, t42, t44, t47, t51;
  double t52, t53, t54, t55, t56, t58, t59, t60;
  double t61, t62, t64, t66, t69, t72, t74, t77;
  double t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t109, t112, t114;
  double t117, t122, t124, t127, t128, t132, t135, t137;
  double tvrho0, t140, t141, t144, t145, t150, t152, t155;
  double t156, t160, t162, t169, t172, t174, t177, t182;
  double tvrho1, t186, t189, t192, t196, tvsigma0, tvsigma1, t198;
  double t201, t204, t208, tvsigma2, t209, t210, t212, t215;
  double tvlapl0, t216, t217, t219, t222, tvlapl1, tvtau0, tvtau1;

  double t225, t226, t227, t231, t232, t234, t235, t239;
  double t240, t244, t246, t252, t253, t256, t258, t260;
  double t262, t269, t272, t276, t279, t280, t281, t283;
  double t284, t285, t286, t289, t294, t295, t296, t297;
  double t301, t305, t306, t310, t312, t314, t317, t319;
  double tv2rho20, t322, t325, t326, t330, t331, t335, t337;
  double t345, t346, t349, t353, t354, t358, t360, t367;
  double t370, tv2rho21, t375, t379, t380, t384, t385, t391;
  double t392, t396, t400, t401, t410, t412, t419, t422;
  double t426, t429, t430, t431, t433, t434, t435, t438;
  double t443, tv2rho22, t451, t455, t456, t457, t458, t466;
  double t468, t471, t476, tv2rhosigma0, tv2rhosigma1, t483, t485, tv2rhosigma2;
  double t491, tv2rhosigma3, tv2rhosigma4, t499, t500, t501, t502, t510;
  double t512, t515, t520, tv2rhosigma5, t522, t523, t526, t528;
  double t531, t533, t534, t535, t539, tv2rholapl0, t541, t542;
  double t545, t547, t549, tv2rholapl1, t551, t552, t556, tv2rholapl2;
  double t558, t559, t564, t566, t567, t568, t572, tv2rholapl3;
  double tv2rhotau0, tv2rhotau1, tv2rhotau2, tv2rhotau3, t574, t577, t580, t584;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t585, t588, t591;
  double t595, tv2sigma25, t599, t602, tv2sigmalapl0, tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3;
  double tv2sigmalapl4, t606, t609, tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3;
  double tv2sigmatau4, tv2sigmatau5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2;
  double tv2lapltau3, tv2tau20, tv2tau21, tv2tau22;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t35 = M_CBRT2;
  t36 = sigma[0] * t33 * t35;
  t39 = 0.1e1 / t31 / rho[0];
  t42 = 0.2e1 / 0.3e1 * t36 - lapl[0] * t39 * t35;
  t44 = exp(-0.157e-2 * t36);
  t47 = 0.1e1 + 0.942e-2 * t42 * t44;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t15, t12, t11, t16, -t18);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t23, t56 * t54);
  t59 = t58 * t27;
  t60 = rho[1] * rho[1];
  t61 = POW_1_3(rho[1]);
  t62 = t61 * t61;
  t64 = 0.1e1 / t62 / t60;
  t66 = sigma[2] * t64 * t35;
  t69 = 0.1e1 / t62 / rho[1];
  t72 = 0.2e1 / 0.3e1 * t66 - lapl[1] * t69 * t35;
  t74 = exp(-0.157e-2 * t66);
  t77 = 0.1e1 + 0.942e-2 * t72 * t74;
  t81 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t77);
  tzk0 = t51 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t7 * t7;
  t83 = 0.1e1 / t82;
  t84 = t17 * t83;
  t85 = t8 - t84;
  t86 = my_piecewise5(t11, 0, t15, 0, t85);
  t89 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t86);
  t90 = t89 * t27;
  t94 = t27 * t27;
  t95 = 0.1e1 / t94;
  t96 = t26 * t95;
  t99 = t6 * t96 * t47 / 0.8e1;
  t100 = t29 * rho[0];
  t102 = 0.1e1 / t31 / t100;
  t109 = -0.16e2 / 0.9e1 * sigma[0] * t102 * t35 + 0.5e1 / 0.3e1 * lapl[0] * t33 * t35;
  t112 = t42 * sigma[0];
  t114 = t102 * t35 * t44;
  t117 = 0.942e-2 * t109 * t44 + 0.394384e-4 * t112 * t114;
  t122 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t47 - t99 - 0.3e1 / 0.8e1 * t6 * t28 * t117);
  t124 = my_piecewise5(t15, 0, t11, 0, -t85);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t27;
  t132 = t58 * t95;
  t135 = t6 * t132 * t77 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t77 - t135);
  tvrho0 = t51 + t81 + t7 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t8 - t84;
  t141 = my_piecewise5(t11, 0, t15, 0, t140);
  t144 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t141);
  t145 = t144 * t27;
  t150 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t47 - t99);
  t152 = my_piecewise5(t15, 0, t11, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t27;
  t160 = t60 * rho[1];
  t162 = 0.1e1 / t62 / t160;
  t169 = -0.16e2 / 0.9e1 * sigma[2] * t162 * t35 + 0.5e1 / 0.3e1 * lapl[1] * t64 * t35;
  t172 = t72 * sigma[2];
  t174 = t162 * t35 * t74;
  t177 = 0.942e-2 * t169 * t74 + 0.394384e-4 * t172 * t174;
  t182 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t77 - t135 - 0.3e1 / 0.8e1 * t6 * t59 * t177);
  tvrho1 = t51 + t81 + t7 * (t150 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = t33 * t35 * t44;
  t189 = t35 * t44;
  t192 = 0.628e-2 * t186 - 0.147894e-4 * t42 * t33 * t189;
  t196 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t192);
  tvsigma0 = t7 * t196;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t198 = t64 * t35 * t74;
  t201 = t35 * t74;
  t204 = 0.628e-2 * t198 - 0.147894e-4 * t72 * t64 * t201;
  t208 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t204);
  tvsigma2 = t7 * t208;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t209 = t3 * t26;
  t210 = t209 * t27;
  t212 = t39 * t35 * t44;
  t215 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t210 * t212);
  tvlapl0 = t7 * t215;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t216 = t3 * t58;
  t217 = t216 * t27;
  t219 = t69 * t35 * t74;
  t222 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t217 * t219);
  tvlapl1 = t7 * t222;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t225 = t24 * t24;
  t226 = 0.1e1 / t225;
  t227 = t86 * t86;
  t231 = 0.1e1 / t82 / t7;
  t232 = t17 * t231;
  t234 = -0.2e1 * t83 + 0.2e1 * t232;
  t235 = my_piecewise5(t11, 0, t15, 0, t234);
  t239 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t226 * t227 + 0.4e1 / 0.3e1 * t24 * t235);
  t240 = t239 * t27;
  t244 = t89 * t95;
  t246 = t6 * t244 * t47;
  t252 = 0.1e1 / t94 / t7;
  t253 = t26 * t252;
  t256 = t6 * t253 * t47 / 0.12e2;
  t258 = t6 * t96 * t117;
  t260 = t29 * t29;
  t262 = 0.1e1 / t31 / t260;
  t269 = 0.176e3 / 0.27e2 * sigma[0] * t262 * t35 - 0.4e2 / 0.9e1 * lapl[0] * t102 * t35;
  t272 = t109 * sigma[0];
  t276 = t262 * t35 * t44;
  t279 = sigma[0] * sigma[0];
  t280 = t42 * t279;
  t281 = t260 * t100;
  t283 = 0.1e1 / t30 / t281;
  t284 = t35 * t35;
  t285 = t283 * t284;
  t286 = t285 * t44;
  t289 = 0.942e-2 * t269 * t44 + 0.788768e-4 * t272 * t114 - 0.14460746666666666667e-3 * t112 * t276 + 0.16511543466666666667e-6 * t280 * t286;
  t294 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t240 * t47 - t246 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t90 * t117 + t256 - t258 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t289);
  t295 = t56 * t56;
  t296 = 0.1e1 / t295;
  t297 = t124 * t124;
  t301 = my_piecewise5(t15, 0, t11, 0, -t234);
  t305 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t296 * t297 + 0.4e1 / 0.3e1 * t56 * t301);
  t306 = t305 * t27;
  t310 = t127 * t95;
  t312 = t6 * t310 * t77;
  t314 = t58 * t252;
  t317 = t6 * t314 * t77 / 0.12e2;
  t319 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t306 * t77 - t312 / 0.4e1 + t317);
  tv2rho20 = 0.2e1 * t122 + 0.2e1 * t137 + t7 * (t294 + t319);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t322 = t226 * t141;
  t325 = 0.2e1 * t232;
  t326 = my_piecewise5(t11, 0, t15, 0, t325);
  t330 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t322 * t86 + 0.4e1 / 0.3e1 * t24 * t326);
  t331 = t330 * t27;
  t335 = t144 * t95;
  t337 = t6 * t335 * t47;
  t345 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t331 * t47 - t337 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t145 * t117 - t246 / 0.8e1 + t256 - t258 / 0.8e1);
  t346 = t296 * t152;
  t349 = my_piecewise5(t15, 0, t11, 0, -t325);
  t353 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t346 * t124 + 0.4e1 / 0.3e1 * t56 * t349);
  t354 = t353 * t27;
  t358 = t155 * t95;
  t360 = t6 * t358 * t77;
  t367 = t6 * t132 * t177;
  t370 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t354 * t77 - t360 / 0.8e1 - t312 / 0.8e1 + t317 - 0.3e1 / 0.8e1 * t6 * t128 * t177 - t367 / 0.8e1);
  tv2rho21 = t122 + t137 + t150 + t182 + t7 * (t345 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t375 = t141 * t141;
  t379 = 0.2e1 * t83 + 0.2e1 * t232;
  t380 = my_piecewise5(t11, 0, t15, 0, t379);
  t384 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t226 * t375 + 0.4e1 / 0.3e1 * t24 * t380);
  t385 = t384 * t27;
  t391 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t385 * t47 - t337 / 0.4e1 + t256);
  t392 = t152 * t152;
  t396 = my_piecewise5(t15, 0, t11, 0, -t379);
  t400 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t296 * t392 + 0.4e1 / 0.3e1 * t56 * t396);
  t401 = t400 * t27;
  t410 = t60 * t60;
  t412 = 0.1e1 / t62 / t410;
  t419 = 0.176e3 / 0.27e2 * sigma[2] * t412 * t35 - 0.4e2 / 0.9e1 * lapl[1] * t162 * t35;
  t422 = t169 * sigma[2];
  t426 = t412 * t35 * t74;
  t429 = sigma[2] * sigma[2];
  t430 = t72 * t429;
  t431 = t410 * t160;
  t433 = 0.1e1 / t61 / t431;
  t434 = t433 * t284;
  t435 = t434 * t74;
  t438 = 0.942e-2 * t419 * t74 + 0.788768e-4 * t422 * t174 - 0.14460746666666666667e-3 * t172 * t426 + 0.16511543466666666667e-6 * t430 * t435;
  t443 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t401 * t77 - t360 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t156 * t177 + t317 - t367 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t59 * t438);
  tv2rho22 = 0.2e1 * t150 + 0.2e1 * t182 + t7 * (t391 + t443);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t451 = t6 * t96 * t192 / 0.8e1;
  t455 = 0.1e1 / t30 / t260 / t29;
  t456 = t455 * t284;
  t457 = sigma[0] * t44;
  t458 = t456 * t457;
  t466 = t42 * t455;
  t468 = t284 * sigma[0] * t44;
  t471 = -0.16746666666666666667e-1 * t114 + 0.26292266666666666667e-4 * t458 - 0.147894e-4 * t109 * t33 * t189 + 0.394384e-4 * t42 * t102 * t189 - 0.61918288e-7 * t466 * t468;
  t476 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t192 - t451 - 0.3e1 / 0.8e1 * t6 * t28 * t471);
  tv2rhosigma0 = t7 * t476 + t196;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t483 = t6 * t132 * t204 / 0.8e1;
  t485 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t204 - t483);
  tv2rhosigma2 = t7 * t485 + t208;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t491 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t192 - t451);
  tv2rhosigma3 = t7 * t491 + t196;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t499 = 0.1e1 / t61 / t410 / t60;
  t500 = t499 * t284;
  t501 = sigma[2] * t74;
  t502 = t500 * t501;
  t510 = t72 * t499;
  t512 = t284 * sigma[2] * t74;
  t515 = -0.16746666666666666667e-1 * t174 + 0.26292266666666666667e-4 * t502 - 0.147894e-4 * t169 * t64 * t201 + 0.394384e-4 * t72 * t162 * t201 - 0.61918288e-7 * t510 * t512;
  t520 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t204 - t483 - 0.3e1 / 0.8e1 * t6 * t59 * t515);
  tv2rhosigma5 = t7 * t520 + t208;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t522 = t3 * t89;
  t523 = t522 * t27;
  t526 = t209 * t95;
  t528 = 0.80397823448311066493e-3 * t526 * t212;
  t531 = t260 * rho[0];
  t533 = 0.1e1 / t30 / t531;
  t534 = t533 * t284;
  t535 = t534 * t457;
  t539 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t523 * t212 + t528 - 0.40198911724155533247e-2 * t210 * t186 + 0.10097966625107869952e-4 * t210 * t535);
  tv2rholapl0 = t7 * t539 + t215;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t541 = t3 * t127;
  t542 = t541 * t27;
  t545 = t216 * t95;
  t547 = 0.80397823448311066493e-3 * t545 * t219;
  t549 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t542 * t219 + t547);
  tv2rholapl1 = t7 * t549 + t222;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  t551 = t3 * t144;
  t552 = t551 * t27;
  t556 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t552 * t212 + t528);
  tv2rholapl2 = t7 * t556 + t215;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  t558 = t3 * t155;
  t559 = t558 * t27;
  t564 = t410 * rho[1];
  t566 = 0.1e1 / t61 / t564;
  t567 = t566 * t284;
  t568 = t567 * t501;
  t572 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t559 * t219 + t547 - 0.40198911724155533247e-2 * t217 * t198 + 0.10097966625107869952e-4 * t217 * t568);
  tv2rholapl3 = t7 * t572 + t222;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t574 = t534 * t44;
  t577 = t284 * t44;
  t580 = -0.197192e-4 * t574 + 0.23219358e-7 * t42 * t533 * t577;
  t584 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t580);
  tv2sigma20 = t7 * t584;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t585 = t567 * t74;
  t588 = t284 * t74;
  t591 = -0.197192e-4 * t585 + 0.23219358e-7 * t72 * t566 * t588;
  t595 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t591);
  tv2sigma25 = t7 * t595;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t599 = 0.1e1 / t30 / t260 * t284 * t44;
  t602 = my_piecewise3(t2, 0, -0.37867374844154512318e-5 * t210 * t599);
  tv2sigmalapl0 = t7 * t602;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  t606 = 0.1e1 / t61 / t410 * t284 * t74;
  t609 = my_piecewise3(t52, 0, -0.37867374844154512318e-5 * t217 * t606);
  tv2sigmalapl5 = t7 * t609;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t28, t29, t30, t31;
  double t33, t35, t36, t39, t42, t44, t47, t51;
  double t52, t53, t54, t55, t56, t58, t59, t60;
  double t61, t62, t64, t66, t69, t72, t74, t77;
  double t81, tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t109, t112, t114;
  double t117, t122, t124, t127, t128, t132, t135, t137;
  double tvrho0, t140, t141, t144, t145, t150, t152, t155;
  double t156, t160, t162, t169, t172, t174, t177, t182;
  double tvrho1, t186, t189, t192, t196, tvsigma0, tvsigma1, t198;
  double t201, t204, t208, tvsigma2, t209, t210, t212, t215;
  double tvlapl0, t216, t217, t219, t222, tvlapl1, tvtau0, tvtau1;

  double t225, t226, t227, t231, t232, t234, t235, t239;
  double t240, t244, t246, t252, t253, t256, t258, t260;
  double t262, t269, t272, t276, t279, t280, t281, t283;
  double t284, t285, t286, t289, t294, t295, t296, t297;
  double t301, t305, t306, t310, t312, t314, t317, t319;
  double tv2rho20, t322, t325, t326, t330, t331, t335, t337;
  double t345, t346, t349, t353, t354, t358, t360, t367;
  double t370, tv2rho21, t375, t379, t380, t384, t385, t391;
  double t392, t396, t400, t401, t410, t412, t419, t422;
  double t426, t429, t430, t431, t433, t434, t435, t438;
  double t443, tv2rho22, t451, t455, t456, t457, t458, t466;
  double t468, t471, t476, tv2rhosigma0, tv2rhosigma1, t483, t485, tv2rhosigma2;
  double t491, tv2rhosigma3, tv2rhosigma4, t499, t500, t501, t502, t510;
  double t512, t515, t520, tv2rhosigma5, t522, t523, t526, t528;
  double t531, t533, t534, t535, t539, tv2rholapl0, t541, t542;
  double t545, t547, t549, tv2rholapl1, t551, t552, t556, tv2rholapl2;
  double t558, t559, t564, t566, t567, t568, t572, tv2rholapl3;
  double tv2rhotau0, tv2rhotau1, tv2rhotau2, tv2rhotau3, t574, t577, t580, t584;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t585, t588, t591;
  double t595, tv2sigma25, t599, t602, tv2sigmalapl0, tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3;
  double tv2sigmalapl4, t606, t609, tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3;
  double tv2sigmatau4, tv2sigmatau5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2;
  double tv2lapltau3, tv2tau20, tv2tau21, tv2tau22;

  double t613, t620, t622, t624, t625, t629, t636, t643;
  double t646, t652, t656, t658, t661, t664, t686, t705;
  double t707, t715, t719, t726, t730, t735, t737, tv3rho30;
  double t740, t741, t750, t751, t752, t753, t757, t765;
  double t771, t775, t784, t785, t795, t799, t807, t810;
  double t819, t821, t824, tv3rho31, t835, t836, t840, t847;
  double t856, t866, t870, t877, t884, t892, t894, t895;
  double tv3rho32, t906, t907, t911, t919, t926, t930, t947;
  double t969, t988, tv3rho33, t996, t1003, t1005, t1011, t1039;
  double tv3rho2sigma0, tv3rho2sigma1, t1046, t1050, t1052, tv3rho2sigma2, t1058, t1066;
  double tv3rho2sigma3, tv3rho2sigma4, t1072, t1079, t1082, tv3rho2sigma5, t1090, tv3rho2sigma6;
  double tv3rho2sigma7, t1105, t1133, tv3rho2sigma8, t1141, t1149, t1150, t1152;
  double t1159, t1165, tv3rho2lapl0, t1173, t1177, t1179, tv3rho2lapl1, t1186;
  double t1196, tv3rho2lapl2, t1203, t1208, t1212, t1215, tv3rho2lapl3, t1224;
  double tv3rho2lapl4, t1243, t1249, tv3rho2lapl5, tv3rho2tau0, tv3rho2tau1, tv3rho2tau2, tv3rho2tau3;
  double tv3rho2tau4, tv3rho2tau5, t1256, t1275, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1282, t1284, tv3rhosigma25, t1290, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1313, tv3rhosigma211, t1318, t1321, t1327, tv3rhosigmalapl0;
  double tv3rhosigmalapl1, tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4, t1332, t1334, tv3rhosigmalapl5, t1339;
  double tv3rhosigmalapl6, tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, t1345, t1351, tv3rhosigmalapl11;
  double tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4, tv3rhosigmatau5, tv3rhosigmatau6, tv3rhosigmatau7;
  double tv3rhosigmatau8, tv3rhosigmatau9, tv3rhosigmatau10, tv3rhosigmatau11, tv3rholapl20, tv3rholapl21, tv3rholapl22, tv3rholapl23;
  double tv3rholapl24, tv3rholapl25, tv3rholapltau0, tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4, tv3rholapltau5;
  double tv3rholapltau6, tv3rholapltau7, tv3rhotau20, tv3rhotau21, tv3rhotau22, tv3rhotau23, tv3rhotau24, tv3rhotau25;
  double t1362, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t1372, tv3sigma39, t1378, tv3sigma2lapl0, tv3sigma2lapl1, tv3sigma2lapl2;
  double tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8, tv3sigma2lapl9, tv3sigma2lapl10;
  double t1384, tv3sigma2lapl11, tv3sigma2tau0, tv3sigma2tau1, tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5;
  double tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9, tv3sigma2tau10, tv3sigma2tau11, tv3sigmalapl20, tv3sigmalapl21;
  double tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26, tv3sigmalapl27, tv3sigmalapl28, tv3sigmalapltau0;
  double tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5, tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8;
  double tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmatau20, tv3sigmatau21, tv3sigmatau22, tv3sigmatau23, tv3sigmatau24;
  double tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, tv3sigmatau28, tv3lapl30, tv3lapl31, tv3lapl32, tv3lapl33;
  double tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20, tv3lapltau21;
  double tv3lapltau22, tv3lapltau23, tv3lapltau24, tv3lapltau25, tv3tau30, tv3tau31, tv3tau32, tv3tau33;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t35 = M_CBRT2;
  t36 = sigma[0] * t33 * t35;
  t39 = 0.1e1 / t31 / rho[0];
  t42 = 0.2e1 / 0.3e1 * t36 - lapl[0] * t39 * t35;
  t44 = exp(-0.157e-2 * t36);
  t47 = 0.1e1 + 0.942e-2 * t42 * t44;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t15, t12, t11, t16, -t18);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t23, t56 * t54);
  t59 = t58 * t27;
  t60 = rho[1] * rho[1];
  t61 = POW_1_3(rho[1]);
  t62 = t61 * t61;
  t64 = 0.1e1 / t62 / t60;
  t66 = sigma[2] * t64 * t35;
  t69 = 0.1e1 / t62 / rho[1];
  t72 = 0.2e1 / 0.3e1 * t66 - lapl[1] * t69 * t35;
  t74 = exp(-0.157e-2 * t66);
  t77 = 0.1e1 + 0.942e-2 * t72 * t74;
  t81 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t77);
  tzk0 = t51 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t7 * t7;
  t83 = 0.1e1 / t82;
  t84 = t17 * t83;
  t85 = t8 - t84;
  t86 = my_piecewise5(t11, 0, t15, 0, t85);
  t89 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t86);
  t90 = t89 * t27;
  t94 = t27 * t27;
  t95 = 0.1e1 / t94;
  t96 = t26 * t95;
  t99 = t6 * t96 * t47 / 0.8e1;
  t100 = t29 * rho[0];
  t102 = 0.1e1 / t31 / t100;
  t109 = -0.16e2 / 0.9e1 * sigma[0] * t102 * t35 + 0.5e1 / 0.3e1 * lapl[0] * t33 * t35;
  t112 = t42 * sigma[0];
  t114 = t102 * t35 * t44;
  t117 = 0.942e-2 * t109 * t44 + 0.394384e-4 * t112 * t114;
  t122 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t47 - t99 - 0.3e1 / 0.8e1 * t6 * t28 * t117);
  t124 = my_piecewise5(t15, 0, t11, 0, -t85);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t27;
  t132 = t58 * t95;
  t135 = t6 * t132 * t77 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t77 - t135);
  tvrho0 = t51 + t81 + t7 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t8 - t84;
  t141 = my_piecewise5(t11, 0, t15, 0, t140);
  t144 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t141);
  t145 = t144 * t27;
  t150 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t47 - t99);
  t152 = my_piecewise5(t15, 0, t11, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t27;
  t160 = t60 * rho[1];
  t162 = 0.1e1 / t62 / t160;
  t169 = -0.16e2 / 0.9e1 * sigma[2] * t162 * t35 + 0.5e1 / 0.3e1 * lapl[1] * t64 * t35;
  t172 = t72 * sigma[2];
  t174 = t162 * t35 * t74;
  t177 = 0.942e-2 * t169 * t74 + 0.394384e-4 * t172 * t174;
  t182 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t77 - t135 - 0.3e1 / 0.8e1 * t6 * t59 * t177);
  tvrho1 = t51 + t81 + t7 * (t150 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = t33 * t35 * t44;
  t189 = t35 * t44;
  t192 = 0.628e-2 * t186 - 0.147894e-4 * t42 * t33 * t189;
  t196 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t192);
  tvsigma0 = t7 * t196;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t198 = t64 * t35 * t74;
  t201 = t35 * t74;
  t204 = 0.628e-2 * t198 - 0.147894e-4 * t72 * t64 * t201;
  t208 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t204);
  tvsigma2 = t7 * t208;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t209 = t3 * t26;
  t210 = t209 * t27;
  t212 = t39 * t35 * t44;
  t215 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t210 * t212);
  tvlapl0 = t7 * t215;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t216 = t3 * t58;
  t217 = t216 * t27;
  t219 = t69 * t35 * t74;
  t222 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t217 * t219);
  tvlapl1 = t7 * t222;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t225 = t24 * t24;
  t226 = 0.1e1 / t225;
  t227 = t86 * t86;
  t231 = 0.1e1 / t82 / t7;
  t232 = t17 * t231;
  t234 = -0.2e1 * t83 + 0.2e1 * t232;
  t235 = my_piecewise5(t11, 0, t15, 0, t234);
  t239 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t226 * t227 + 0.4e1 / 0.3e1 * t24 * t235);
  t240 = t239 * t27;
  t244 = t89 * t95;
  t246 = t6 * t244 * t47;
  t252 = 0.1e1 / t94 / t7;
  t253 = t26 * t252;
  t256 = t6 * t253 * t47 / 0.12e2;
  t258 = t6 * t96 * t117;
  t260 = t29 * t29;
  t262 = 0.1e1 / t31 / t260;
  t269 = 0.176e3 / 0.27e2 * sigma[0] * t262 * t35 - 0.4e2 / 0.9e1 * lapl[0] * t102 * t35;
  t272 = t109 * sigma[0];
  t276 = t262 * t35 * t44;
  t279 = sigma[0] * sigma[0];
  t280 = t42 * t279;
  t281 = t260 * t100;
  t283 = 0.1e1 / t30 / t281;
  t284 = t35 * t35;
  t285 = t283 * t284;
  t286 = t285 * t44;
  t289 = 0.942e-2 * t269 * t44 + 0.788768e-4 * t272 * t114 - 0.14460746666666666667e-3 * t112 * t276 + 0.16511543466666666667e-6 * t280 * t286;
  t294 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t240 * t47 - t246 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t90 * t117 + t256 - t258 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t289);
  t295 = t56 * t56;
  t296 = 0.1e1 / t295;
  t297 = t124 * t124;
  t301 = my_piecewise5(t15, 0, t11, 0, -t234);
  t305 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t296 * t297 + 0.4e1 / 0.3e1 * t56 * t301);
  t306 = t305 * t27;
  t310 = t127 * t95;
  t312 = t6 * t310 * t77;
  t314 = t58 * t252;
  t317 = t6 * t314 * t77 / 0.12e2;
  t319 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t306 * t77 - t312 / 0.4e1 + t317);
  tv2rho20 = 0.2e1 * t122 + 0.2e1 * t137 + t7 * (t294 + t319);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t322 = t226 * t141;
  t325 = 0.2e1 * t232;
  t326 = my_piecewise5(t11, 0, t15, 0, t325);
  t330 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t322 * t86 + 0.4e1 / 0.3e1 * t24 * t326);
  t331 = t330 * t27;
  t335 = t144 * t95;
  t337 = t6 * t335 * t47;
  t345 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t331 * t47 - t337 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t145 * t117 - t246 / 0.8e1 + t256 - t258 / 0.8e1);
  t346 = t296 * t152;
  t349 = my_piecewise5(t15, 0, t11, 0, -t325);
  t353 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t346 * t124 + 0.4e1 / 0.3e1 * t56 * t349);
  t354 = t353 * t27;
  t358 = t155 * t95;
  t360 = t6 * t358 * t77;
  t367 = t6 * t132 * t177;
  t370 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t354 * t77 - t360 / 0.8e1 - t312 / 0.8e1 + t317 - 0.3e1 / 0.8e1 * t6 * t128 * t177 - t367 / 0.8e1);
  tv2rho21 = t122 + t137 + t150 + t182 + t7 * (t345 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t375 = t141 * t141;
  t379 = 0.2e1 * t83 + 0.2e1 * t232;
  t380 = my_piecewise5(t11, 0, t15, 0, t379);
  t384 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t226 * t375 + 0.4e1 / 0.3e1 * t24 * t380);
  t385 = t384 * t27;
  t391 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t385 * t47 - t337 / 0.4e1 + t256);
  t392 = t152 * t152;
  t396 = my_piecewise5(t15, 0, t11, 0, -t379);
  t400 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t296 * t392 + 0.4e1 / 0.3e1 * t56 * t396);
  t401 = t400 * t27;
  t410 = t60 * t60;
  t412 = 0.1e1 / t62 / t410;
  t419 = 0.176e3 / 0.27e2 * sigma[2] * t412 * t35 - 0.4e2 / 0.9e1 * lapl[1] * t162 * t35;
  t422 = t169 * sigma[2];
  t426 = t412 * t35 * t74;
  t429 = sigma[2] * sigma[2];
  t430 = t72 * t429;
  t431 = t410 * t160;
  t433 = 0.1e1 / t61 / t431;
  t434 = t433 * t284;
  t435 = t434 * t74;
  t438 = 0.942e-2 * t419 * t74 + 0.788768e-4 * t422 * t174 - 0.14460746666666666667e-3 * t172 * t426 + 0.16511543466666666667e-6 * t430 * t435;
  t443 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t401 * t77 - t360 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t156 * t177 + t317 - t367 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t59 * t438);
  tv2rho22 = 0.2e1 * t150 + 0.2e1 * t182 + t7 * (t391 + t443);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t451 = t6 * t96 * t192 / 0.8e1;
  t455 = 0.1e1 / t30 / t260 / t29;
  t456 = t455 * t284;
  t457 = sigma[0] * t44;
  t458 = t456 * t457;
  t466 = t42 * t455;
  t468 = t284 * sigma[0] * t44;
  t471 = -0.16746666666666666667e-1 * t114 + 0.26292266666666666667e-4 * t458 - 0.147894e-4 * t109 * t33 * t189 + 0.394384e-4 * t42 * t102 * t189 - 0.61918288e-7 * t466 * t468;
  t476 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t192 - t451 - 0.3e1 / 0.8e1 * t6 * t28 * t471);
  tv2rhosigma0 = t7 * t476 + t196;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t483 = t6 * t132 * t204 / 0.8e1;
  t485 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t204 - t483);
  tv2rhosigma2 = t7 * t485 + t208;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t491 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t192 - t451);
  tv2rhosigma3 = t7 * t491 + t196;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t499 = 0.1e1 / t61 / t410 / t60;
  t500 = t499 * t284;
  t501 = sigma[2] * t74;
  t502 = t500 * t501;
  t510 = t72 * t499;
  t512 = t284 * sigma[2] * t74;
  t515 = -0.16746666666666666667e-1 * t174 + 0.26292266666666666667e-4 * t502 - 0.147894e-4 * t169 * t64 * t201 + 0.394384e-4 * t72 * t162 * t201 - 0.61918288e-7 * t510 * t512;
  t520 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t204 - t483 - 0.3e1 / 0.8e1 * t6 * t59 * t515);
  tv2rhosigma5 = t7 * t520 + t208;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t522 = t3 * t89;
  t523 = t522 * t27;
  t526 = t209 * t95;
  t528 = 0.80397823448311066493e-3 * t526 * t212;
  t531 = t260 * rho[0];
  t533 = 0.1e1 / t30 / t531;
  t534 = t533 * t284;
  t535 = t534 * t457;
  t539 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t523 * t212 + t528 - 0.40198911724155533247e-2 * t210 * t186 + 0.10097966625107869952e-4 * t210 * t535);
  tv2rholapl0 = t7 * t539 + t215;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t541 = t3 * t127;
  t542 = t541 * t27;
  t545 = t216 * t95;
  t547 = 0.80397823448311066493e-3 * t545 * t219;
  t549 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t542 * t219 + t547);
  tv2rholapl1 = t7 * t549 + t222;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  t551 = t3 * t144;
  t552 = t551 * t27;
  t556 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t552 * t212 + t528);
  tv2rholapl2 = t7 * t556 + t215;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  t558 = t3 * t155;
  t559 = t558 * t27;
  t564 = t410 * rho[1];
  t566 = 0.1e1 / t61 / t564;
  t567 = t566 * t284;
  t568 = t567 * t501;
  t572 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t559 * t219 + t547 - 0.40198911724155533247e-2 * t217 * t198 + 0.10097966625107869952e-4 * t217 * t568);
  tv2rholapl3 = t7 * t572 + t222;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t574 = t534 * t44;
  t577 = t284 * t44;
  t580 = -0.197192e-4 * t574 + 0.23219358e-7 * t42 * t533 * t577;
  t584 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t580);
  tv2sigma20 = t7 * t584;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t585 = t567 * t74;
  t588 = t284 * t74;
  t591 = -0.197192e-4 * t585 + 0.23219358e-7 * t72 * t566 * t588;
  t595 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * t591);
  tv2sigma25 = t7 * t595;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t599 = 0.1e1 / t30 / t260 * t284 * t44;
  t602 = my_piecewise3(t2, 0, -0.37867374844154512318e-5 * t210 * t599);
  tv2sigmalapl0 = t7 * t602;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  t606 = 0.1e1 / t61 / t410 * t284 * t74;
  t609 = my_piecewise3(t52, 0, -0.37867374844154512318e-5 * t217 * t606);
  tv2sigmalapl5 = t7 * t609;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

  t613 = 0.1e1 / t225 / t20;
  t620 = t82 * t82;
  t622 = t17 / t620;
  t624 = 0.6e1 * t231 - 0.6e1 * t622;
  t625 = my_piecewise5(t11, 0, t15, 0, t624);
  t629 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t613 * t227 * t86 + 0.4e1 / 0.3e1 * t226 * t86 * t235 + 0.4e1 / 0.3e1 * t24 * t625);
  t636 = t6 * t239 * t95 * t47;
  t643 = t6 * t89 * t252 * t47;
  t646 = t6 * t244 * t117;
  t652 = 0.1e1 / t94 / t82;
  t656 = 0.5e1 / 0.36e2 * t6 * t26 * t652 * t47;
  t658 = t6 * t253 * t117;
  t661 = t6 * t96 * t289;
  t664 = 0.1e1 / t31 / t531;
  t686 = t260 * t260;
  t705 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t629 * t27 * t47 - 0.3e1 / 0.8e1 * t636 - 0.9e1 / 0.8e1 * t6 * t240 * t117 + t643 / 0.4e1 - 0.3e1 / 0.4e1 * t646 - 0.9e1 / 0.8e1 * t6 * t90 * t289 - t656 + t658 / 0.4e1 - 0.3e1 / 0.8e1 * t661 - 0.3e1 / 0.8e1 * t6 * t28 * (0.942e-2 * (-0.2464e4 / 0.81e2 * sigma[0] * t664 * t35 + 0.44e3 / 0.27e2 * lapl[0] * t262 * t35) * t44 + 0.1183152e-3 * t269 * sigma[0] * t114 - 0.4338224e-3 * t272 * t276 + 0.49534630400000000001e-6 * t109 * t279 * t286 + 0.67483484444444444446e-3 * t112 * t664 * t35 * t44 - 0.18162697813333333334e-5 * t280 / t30 / t686 * t284 * t44 + 0.13825665729422222223e-8 * t42 * t279 * sigma[0] / t686 / t100 * t44));
  t707 = 0.1e1 / t295 / t54;
  t715 = my_piecewise5(t15, 0, t11, 0, -t624);
  t719 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t707 * t297 * t124 + 0.4e1 / 0.3e1 * t296 * t124 * t301 + 0.4e1 / 0.3e1 * t56 * t715);
  t726 = t6 * t305 * t95 * t77;
  t730 = t6 * t127 * t252 * t77;
  t735 = 0.5e1 / 0.36e2 * t6 * t58 * t652 * t77;
  t737 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t719 * t27 * t77 - 0.3e1 / 0.8e1 * t726 + t730 / 0.4e1 - t735);
  tv3rho30 = 0.3e1 * t294 + 0.3e1 * t319 + t7 * (t705 + t737);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t740 = 0.2e1 * t345;
  t741 = 0.2e1 * t370;
  t750 = 0.2e1 * t231;
  t751 = 0.6e1 * t622;
  t752 = t750 - t751;
  t753 = my_piecewise5(t11, 0, t15, 0, t752);
  t757 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t613 * t141 * t227 + 0.8e1 / 0.9e1 * t226 * t326 * t86 + 0.4e1 / 0.9e1 * t322 * t235 + 0.4e1 / 0.3e1 * t24 * t753);
  t765 = t6 * t330 * t95 * t47 / 0.4e1;
  t771 = t6 * t144 * t252 * t47;
  t775 = t6 * t335 * t117 / 0.4e1;
  t784 = -0.3e1 / 0.8e1 * t6 * t757 * t27 * t47 - t765 - 0.3e1 / 0.4e1 * t6 * t331 * t117 + t771 / 0.12e2 - t775 - 0.3e1 / 0.8e1 * t6 * t145 * t289 - t636 / 0.8e1 + t643 / 0.6e1 - t646 / 0.4e1 - t656 + t658 / 0.6e1 - t661 / 0.8e1;
  t785 = my_piecewise3(t2, 0, t784);
  t795 = my_piecewise5(t15, 0, t11, 0, -t752);
  t799 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t707 * t152 * t297 + 0.8e1 / 0.9e1 * t296 * t349 * t124 + 0.4e1 / 0.9e1 * t346 * t301 + 0.4e1 / 0.3e1 * t56 * t795);
  t807 = t6 * t353 * t95 * t77 / 0.4e1;
  t810 = t6 * t155 * t252 * t77;
  t819 = t6 * t310 * t177 / 0.4e1;
  t821 = t6 * t314 * t177;
  t824 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t799 * t27 * t77 - t807 + t810 / 0.12e2 - t726 / 0.8e1 + t730 / 0.6e1 - t735 - 0.3e1 / 0.8e1 * t6 * t306 * t177 - t819 + t821 / 0.12e2);
  tv3rho31 = t294 + t319 + t740 + t741 + t7 * (t785 + t824);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t835 = -t750 - t751;
  t836 = my_piecewise5(t11, 0, t15, 0, t835);
  t840 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t613 * t375 * t86 + 0.8e1 / 0.9e1 * t322 * t326 + 0.4e1 / 0.9e1 * t226 * t380 * t86 + 0.4e1 / 0.3e1 * t24 * t836);
  t847 = t6 * t384 * t95 * t47;
  t856 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t840 * t27 * t47 - t847 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t385 * t117 - t765 + t771 / 0.6e1 - t775 + t643 / 0.12e2 - t656 + t658 / 0.12e2);
  t866 = my_piecewise5(t15, 0, t11, 0, -t835);
  t870 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t707 * t392 * t124 + 0.8e1 / 0.9e1 * t346 * t349 + 0.4e1 / 0.9e1 * t296 * t396 * t124 + 0.4e1 / 0.3e1 * t56 * t866);
  t877 = t6 * t400 * t95 * t77;
  t884 = t6 * t358 * t177;
  t892 = t6 * t132 * t438;
  t894 = -0.3e1 / 0.8e1 * t6 * t870 * t27 * t77 - t877 / 0.8e1 - t807 + t810 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t354 * t177 - t884 / 0.4e1 + t730 / 0.12e2 - t735 - t819 + t821 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t128 * t438 - t892 / 0.8e1;
  t895 = my_piecewise3(t52, 0, t894);
  tv3rho32 = t740 + t741 + t391 + t443 + t7 * (t856 + t895);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t906 = -0.6e1 * t231 - 0.6e1 * t622;
  t907 = my_piecewise5(t11, 0, t15, 0, t906);
  t911 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t613 * t375 * t141 + 0.4e1 / 0.3e1 * t322 * t380 + 0.4e1 / 0.3e1 * t24 * t907);
  t919 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t911 * t27 * t47 - 0.3e1 / 0.8e1 * t847 + t771 / 0.4e1 - t656);
  t926 = my_piecewise5(t15, 0, t11, 0, -t906);
  t930 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t707 * t392 * t152 + 0.4e1 / 0.3e1 * t346 * t396 + 0.4e1 / 0.3e1 * t56 * t926);
  t947 = 0.1e1 / t62 / t564;
  t969 = t410 * t410;
  t988 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t930 * t27 * t77 - 0.3e1 / 0.8e1 * t877 - 0.9e1 / 0.8e1 * t6 * t401 * t177 + t810 / 0.4e1 - 0.3e1 / 0.4e1 * t884 - 0.9e1 / 0.8e1 * t6 * t156 * t438 - t735 + t821 / 0.4e1 - 0.3e1 / 0.8e1 * t892 - 0.3e1 / 0.8e1 * t6 * t59 * (0.942e-2 * (-0.2464e4 / 0.81e2 * sigma[2] * t947 * t35 + 0.44e3 / 0.27e2 * lapl[1] * t412 * t35) * t74 + 0.1183152e-3 * t419 * sigma[2] * t174 - 0.4338224e-3 * t422 * t426 + 0.49534630400000000001e-6 * t169 * t429 * t435 + 0.67483484444444444446e-3 * t172 * t947 * t35 * t74 - 0.18162697813333333334e-5 * t430 / t61 / t969 * t284 * t74 + 0.13825665729422222223e-8 * t72 * t429 * sigma[2] / t969 / t160 * t74));
  tv3rho33 = 0.3e1 * t391 + 0.3e1 * t443 + t7 * (t919 + t988);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t996 = t6 * t244 * t192;
  t1003 = t6 * t253 * t192 / 0.12e2;
  t1005 = t6 * t96 * t471;
  t1011 = 0.1e1 / t686 / t29;
  t1039 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t240 * t192 - t996 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t90 * t471 + t1003 - t1005 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (0.61404444444444444446e-1 * t276 - 0.2366304e-3 * t285 * t457 + 0.22015391288888888889e-6 * t1011 * t279 * t44 - 0.147894e-4 * t269 * t33 * t189 + 0.788768e-4 * t109 * t102 * t189 - 0.123836576e-6 * t109 * t455 * t468 - 0.14460746666666666667e-3 * t42 * t262 * t189 + 0.557264592e-6 * t42 * t283 * t468 - 0.51846246485333333334e-9 * t42 * t1011 * t279 * t44));
  tv3rho2sigma0 = t7 * t1039 + 0.2e1 * t476;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1046 = t6 * t310 * t204;
  t1050 = t6 * t314 * t204 / 0.12e2;
  t1052 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t306 * t204 - t1046 / 0.4e1 + t1050);
  tv3rho2sigma2 = t7 * t1052 + 0.2e1 * t485;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1058 = t6 * t335 * t192;
  t1066 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t331 * t192 - t1058 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t145 * t471 - t996 / 0.8e1 + t1003 - t1005 / 0.8e1);
  tv3rho2sigma3 = t7 * t1066 + t476 + t491;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1072 = t6 * t358 * t204;
  t1079 = t6 * t132 * t515;
  t1082 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t354 * t204 - t1072 / 0.8e1 - t1046 / 0.8e1 + t1050 - 0.3e1 / 0.8e1 * t6 * t128 * t515 - t1079 / 0.8e1);
  tv3rho2sigma5 = t7 * t1082 + t485 + t520;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1090 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t385 * t192 - t1058 / 0.4e1 + t1003);
  tv3rho2sigma6 = t7 * t1090 + 0.2e1 * t491;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1105 = 0.1e1 / t969 / t60;
  t1133 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t401 * t204 - t1072 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t156 * t515 + t1050 - t1079 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t59 * (0.61404444444444444446e-1 * t426 - 0.2366304e-3 * t434 * t501 + 0.22015391288888888889e-6 * t1105 * t429 * t74 - 0.147894e-4 * t419 * t64 * t201 + 0.788768e-4 * t169 * t162 * t201 - 0.123836576e-6 * t169 * t499 * t512 - 0.14460746666666666667e-3 * t72 * t412 * t201 + 0.557264592e-6 * t72 * t433 * t512 - 0.51846246485333333334e-9 * t72 * t1105 * t429 * t74));
  tv3rho2sigma8 = t7 * t1133 + 0.2e1 * t520;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1141 = t522 * t95 * t212;
  t1149 = 0.53598548965540710995e-3 * t209 * t252 * t212;
  t1150 = t526 * t186;
  t1152 = t526 * t535;
  t1159 = 0.1e1 / t686 / rho[0];
  t1165 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t3 * t239 * t27 * t212 + 0.16079564689662213299e-2 * t1141 - 0.80397823448311066494e-2 * t523 * t186 + 0.20195933250215739904e-4 * t523 * t535 - t1149 - 0.26799274482770355498e-2 * t1150 + 0.67319777500719133012e-5 * t1152 + 0.10719709793108142199e-1 * t210 * t114 - 0.70685766375755089664e-4 * t210 * t458 + 0.84553640540903231065e-7 * t210 * t1159 * t279 * t44);
  tv3rho2lapl0 = t7 * t1165 + 0.2e1 * t539;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  t1173 = t541 * t95 * t219;
  t1177 = 0.53598548965540710995e-3 * t216 * t252 * t219;
  t1179 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t3 * t305 * t27 * t219 + 0.16079564689662213299e-2 * t1173 - t1177);
  tv3rho2lapl1 = t7 * t1179 + 0.2e1 * t549;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 1] += tv3rho2lapl1;

  t1186 = t551 * t95 * t212;
  t1196 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t3 * t330 * t27 * t212 + 0.80397823448311066493e-3 * t1186 - 0.40198911724155533247e-2 * t552 * t186 + 0.10097966625107869952e-4 * t552 * t535 + 0.80397823448311066493e-3 * t1141 - t1149 - 0.13399637241385177749e-2 * t1150 + 0.33659888750359566505e-5 * t1152);
  tv3rho2lapl2 = t7 * t1196 + t539 + t556;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 2] += tv3rho2lapl2;

  t1203 = t558 * t95 * t219;
  t1208 = t545 * t198;
  t1212 = t545 * t568;
  t1215 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t3 * t353 * t27 * t219 + 0.80397823448311066493e-3 * t1203 + 0.80397823448311066493e-3 * t1173 - t1177 - 0.40198911724155533247e-2 * t542 * t198 - 0.13399637241385177749e-2 * t1208 + 0.10097966625107869952e-4 * t542 * t568 + 0.33659888750359566507e-5 * t1212);
  tv3rho2lapl3 = t7 * t1215 + t549 + t572;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 3] += tv3rho2lapl3;

  t1224 = my_piecewise3(t2, 0, 0.24119347034493319948e-2 * t3 * t384 * t27 * t212 + 0.16079564689662213299e-2 * t1186 - t1149);
  tv3rho2lapl4 = t7 * t1224 + 0.2e1 * t556;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 4] += tv3rho2lapl4;

  t1243 = 0.1e1 / t969 / rho[1];
  t1249 = my_piecewise3(t52, 0, 0.24119347034493319948e-2 * t3 * t400 * t27 * t219 + 0.16079564689662213299e-2 * t1203 - 0.80397823448311066494e-2 * t559 * t198 + 0.20195933250215739904e-4 * t559 * t568 - t1177 - 0.26799274482770355498e-2 * t1208 + 0.67319777500719133012e-5 * t1212 + 0.10719709793108142199e-1 * t217 * t174 - 0.70685766375755089664e-4 * t217 * t502 + 0.84553640540903231065e-7 * t217 * t1243 * t429 * t74);
  tv3rho2lapl5 = t7 * t1249 + 0.2e1 * t572;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 5] += tv3rho2lapl5;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  tv3rho2tau1 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 1] += tv3rho2tau1;

  tv3rho2tau2 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 2] += tv3rho2tau2;

  tv3rho2tau3 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 3] += tv3rho2tau3;

  tv3rho2tau4 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 4] += tv3rho2tau4;

  tv3rho2tau5 = 0.e0;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 5] += tv3rho2tau5;

  t1256 = t6 * t96 * t580 / 0.8e1;
  t1275 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t90 * t580 - t1256 - 0.3e1 / 0.8e1 * t6 * t28 * (0.10516906666666666667e-3 * t456 * t44 - 0.16511543466666666667e-6 * t1159 * sigma[0] * t44 + 0.23219358e-7 * t109 * t533 * t577 - 0.123836576e-6 * t466 * t577 + 0.19442342432e-9 * t42 * t1159 * t457));
  tv3rhosigma20 = t7 * t1275 + t584;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1282 = t6 * t132 * t591 / 0.8e1;
  t1284 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t128 * t591 - t1282);
  tv3rhosigma25 = t7 * t1284 + t595;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1290 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t145 * t580 - t1256);
  tv3rhosigma26 = t7 * t1290 + t584;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1313 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t156 * t591 - t1282 - 0.3e1 / 0.8e1 * t6 * t59 * (0.10516906666666666667e-3 * t500 * t74 - 0.16511543466666666667e-6 * t1243 * sigma[2] * t74 + 0.23219358e-7 * t169 * t566 * t588 - 0.123836576e-6 * t510 * t588 + 0.19442342432e-9 * t72 * t1243 * t501));
  tv3rhosigma211 = t7 * t1313 + t595;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1318 = 0.12622458281384837439e-5 * t526 * t599;
  t1321 = 0.1e1 / t686;
  t1327 = my_piecewise3(t2, 0, -0.37867374844154512318e-5 * t523 * t599 - t1318 + 0.16409195765800288671e-4 * t210 * t574 - 0.31707615202838711648e-7 * t210 * t1321 * sigma[0] * t44);
  tv3rhosigmalapl0 = t7 * t1327 + t602;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  t1332 = 0.12622458281384837439e-5 * t545 * t606;
  t1334 = my_piecewise3(t52, 0, -0.37867374844154512318e-5 * t542 * t606 - t1332);
  tv3rhosigmalapl5 = t7 * t1334 + t609;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  t1339 = my_piecewise3(t2, 0, -0.37867374844154512318e-5 * t552 * t599 - t1318);
  tv3rhosigmalapl6 = t7 * t1339 + t602;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  t1345 = 0.1e1 / t969;
  t1351 = my_piecewise3(t52, 0, -0.37867374844154512318e-5 * t559 * t606 - t1332 + 0.16409195765800288671e-4 * t217 * t585 - 0.31707615202838711648e-7 * t217 * t1345 * sigma[2] * t74);
  tv3rhosigmalapl11 = t7 * t1351 + t609;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 4] += tv3rhosigmatau4;

  tv3rhosigmatau5 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 5] += tv3rhosigmatau5;

  tv3rhosigmatau6 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 10] += tv3rhosigmatau10;

  tv3rhosigmatau11 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 11] += tv3rhosigmatau11;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 1] += tv3rholapl21;

  tv3rholapl22 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 2] += tv3rholapl22;

  tv3rholapl23 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 4] += tv3rholapl24;

  tv3rholapl25 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 7] += tv3rholapltau7;

  tv3rhotau20 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 1] += tv3rhotau21;

  tv3rhotau22 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 2] += tv3rhotau22;

  tv3rhotau23 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 4] += tv3rhotau24;

  tv3rhotau25 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 5] += tv3rhotau25;

  t1362 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (0.92877432e-7 * t1321 * t44 - 0.7290878412e-10 * t42 * t1321 * t44));
  tv3sigma30 = t7 * t1362;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1372 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t6 * t59 * (0.92877432e-7 * t1345 * t74 - 0.7290878412e-10 * t72 * t1345 * t74));
  tv3sigma39 = t7 * t1372;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1378 = my_piecewise3(t2, 0, 0.11890355701064516868e-7 * t209 * t27 / t281 * t44);
  tv3sigma2lapl0 = t7 * t1378;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 10] += tv3sigma2lapl10;

  t1384 = my_piecewise3(t52, 0, 0.11890355701064516868e-7 * t216 * t27 / t431 * t74);
  tv3sigma2lapl11 = t7 * t1384;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 11] += tv3sigma2lapl11;

  tv3sigma2tau0 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 10] += tv3sigma2tau10;

  tv3sigma2tau11 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 11] += tv3sigma2tau11;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 7] += tv3sigmalapl27;

  tv3sigmalapl28 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmatau20 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 7] += tv3sigmatau27;

  tv3sigmatau28 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 8] += tv3sigmatau28;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 2] += tv3lapl32;

  tv3lapl33 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 5] += tv3lapltau25;

  tv3tau30 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 2] += tv3tau32;

  tv3tau33 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 3] += tv3tau33;

}

#endif

