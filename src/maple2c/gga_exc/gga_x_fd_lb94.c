/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_fd_lb94.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t2, t3, t4, t6, t8, t9, t10, t11;
  double t12, t13, t14, t15, t16, t17, t18, t19;
  double t21, t22, t26, t27, t28, t30, t31, t32;
  double t35, t39;

#ifndef XC_DONT_COMPILE_VXC
  double t40, t42, t46, t48, t49, t50, t52, t55;
  double t60, t63, t64, t66, t69, t73;

#ifndef XC_DONT_COMPILE_FXC
  double t78, t85, t87, t88, t89, t92, t95, t96;
  double t97, t98, t99, t101, t102, t103, t104, t105;
  double t106, t107, t112, t114, t118, t119, t121, t122;
  double t123, t127, t128, t129, t132, t137, t148, t149;
  double t150, t153, t158, t162, t163, t166, t167, t168;
  double t169, t172, t176;

#ifndef XC_DONT_COMPILE_KXC
  double t179, t191, t192, t195, t198, t201, t202, t205;
  double t206, t207, t211, t212, t217, t218, t222, t223;
  double t224, t228, t229, t233, t238, t254, t255, t256;
  double t259, t264, t276, t279, t284, t287, t290, t296;
  double t299, t309, t310, t314, t315, t316, t319, t323;

#ifndef XC_DONT_COMPILE_LXC
  double t340, t341, t348, t359, t360, t361, t369, t378;
  double t379, t381, t397, t398, t399, t404, t405, t414;
  double t436, t448, t478, t504, t541, t544, t547, t558;
  double t563, t582, t596;
#endif

#endif

#endif

#endif

#endif


  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = my_piecewise3(0.1e1 <= p->zeta_threshold, 0, 1);
  t9 = POW_1_3(rho[0]);
  t10 = t8 * t9;
  t11 = M_CBRT6;
  t12 = t11 * t11;
  t13 = M_PI * M_PI;
  t14 = POW_1_3(t13);
  t15 = 0.1e1 / t14;
  t16 = t12 * t15;
  t17 = sqrt(sigma[0]);
  t18 = t16 * t17;
  t19 = M_CBRT2;
  t21 = 0.1e1 / t9 / rho[0];
  t22 = t19 * t21;
  t26 = t16 * t17 * t19 * t21 / 0.12e2;
  t27 = xc_integrate(func0, NULL, 0.0, t26);
  t28 = log(t26);
  t30 = xc_integrate(func1, NULL, 0.0, t26);
  t31 = t27 * t28 - t30;
  t32 = t22 * t31;
  t35 = 0.1e1 - t18 * t32 / 0.12e2;
  t39 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t35);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t39;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t40 = t9 * t9;
  t42 = t8 / t40;
  t46 = rho[0] * rho[0];
  t48 = 0.1e1 / t9 / t46;
  t49 = t19 * t48;
  t50 = t49 * t31;
  t52 = t49 * t27;
  t55 = t18 * t50 / 0.9e1 + t18 * t52 / 0.9e1;
  t60 = my_piecewise3(t2, 0, -t6 * t42 * t35 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t55);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t60 + 0.2e1 * t39;

  t63 = 0.1e1 / t17;
  t64 = t16 * t63;
  t66 = t22 * t27;
  t69 = -t64 * t32 / 0.24e2 - t64 * t66 / 0.24e2;
  t73 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t69);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t73;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t78 = t8 / t40 / rho[0];
  t85 = t46 * rho[0];
  t87 = 0.1e1 / t9 / t85;
  t88 = t19 * t87;
  t89 = t88 * t31;
  t92 = t88 * t27;
  t95 = t14 * t14;
  t96 = 0.1e1 / t95;
  t97 = t11 * t96;
  t98 = t97 * sigma[0];
  t99 = t46 * t46;
  t101 = 0.1e1 / t40 / t99;
  t102 = t101 * params->beta;
  t103 = t19 * t19;
  t104 = params->beta * t103;
  t105 = t104 * t12;
  t106 = t15 * t17;
  t107 = t103 * t12;
  t112 = t96 * sigma[0];
  t114 = 0.1e1 / t40 / t46;
  t118 = 0.3e1 * t19 * t11 * t112 * t114 + 0.36e2;
  t119 = sqrt(t118);
  t121 = t107 * t106 * t21 / 0.12e2 + t119 / 0.6e1;
  t122 = log(t121);
  t123 = t21 * t122;
  t127 = 0.1e1 + t105 * t106 * t123 / 0.4e1;
  t128 = 0.1e1 / t127;
  t129 = t102 * t128;
  t132 = -0.7e1 / 0.27e2 * t18 * t89 - 0.11e2 / 0.27e2 * t18 * t92 + t98 * t129 / 0.9e1;
  t137 = my_piecewise3(t2, 0, t6 * t78 * t35 / 0.12e2 - t6 * t42 * t55 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * t132);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t137 + 0.4e1 * t60;

  t148 = 0.1e1 / t40 / t85;
  t149 = t148 * params->beta;
  t150 = t149 * t128;
  t153 = t64 * t50 / 0.18e2 + t64 * t52 / 0.9e1 - t97 * t150 / 0.24e2;
  t158 = my_piecewise3(t2, 0, -t6 * t42 * t69 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t153);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t158 + 0.2e1 * t73;

  t162 = 0.1e1 / t17 / sigma[0];
  t163 = t16 * t162;
  t166 = 0.1e1 / sigma[0];
  t167 = t97 * t166;
  t168 = t114 * params->beta;
  t169 = t168 * t128;
  t172 = t163 * t32 / 0.48e2 + t167 * t169 / 0.64e2;
  t176 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t172);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t176;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t179 = t8 * t114;
  t191 = t19 / t9 / t99;
  t192 = t191 * t31;
  t195 = t191 * t27;
  t198 = t99 * rho[0];
  t201 = 0.1e1 / t40 / t198 * params->beta;
  t202 = t201 * t128;
  t205 = t127 * t127;
  t206 = 0.1e1 / t205;
  t207 = t48 * t122;
  t211 = t104 * t16;
  t212 = t17 * t21;
  t217 = 0.1e1 / t119 * t19;
  t218 = t217 * t11;
  t222 = -t107 * t106 * t48 / 0.9e1 - 0.2e1 / 0.3e1 * t218 * t112 * t148;
  t223 = 0.1e1 / t121;
  t224 = t222 * t223;
  t228 = -t105 * t106 * t207 / 0.3e1 + t211 * t212 * t224 / 0.4e1;
  t229 = t206 * t228;
  t233 = 0.70e2 / 0.81e2 * t18 * t192 + 0.46e2 / 0.27e2 * t18 * t195 - 0.25e2 / 0.27e2 * t98 * t202 - t98 * t102 * t229 / 0.9e1;
  t238 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t179 * t35 + t6 * t78 * t55 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t42 * t132 - 0.3e1 / 0.8e1 * t6 * t10 * t233);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t238 + 0.6e1 * t137;

  t254 = t97 * t148;
  t255 = params->beta * t206;
  t256 = t255 * t228;
  t259 = -0.7e1 / 0.54e2 * t64 * t89 - t64 * t92 / 0.3e1 + 0.19e2 / 0.72e2 * t97 * t129 + t254 * t256 / 0.24e2;
  t264 = my_piecewise3(t2, 0, t6 * t78 * t69 / 0.12e2 - t6 * t42 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * t259);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t264 + 0.4e1 * t158;

  t276 = t168 * t229;
  t279 = -t163 * t50 / 0.36e2 - t163 * t52 / 0.36e2 - t167 * t150 / 0.24e2 - t167 * t276 / 0.64e2;
  t284 = my_piecewise3(t2, 0, -t6 * t42 * t172 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t279);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t284 + 0.2e1 * t176;

  t287 = sigma[0] * sigma[0];
  t290 = t16 / t17 / t287;
  t296 = t97 / t287;
  t299 = t15 * t63;
  t309 = t107 * t299 * t21 / 0.24e2 + t217 * t97 * t114 / 0.4e1;
  t310 = t309 * t223;
  t314 = t105 * t299 * t123 / 0.8e1 + t211 * t212 * t310 / 0.4e1;
  t315 = t206 * t314;
  t316 = t168 * t315;
  t319 = -t290 * t32 / 0.32e2 + t290 * t66 / 0.96e2 - t296 * t169 / 0.64e2 - t167 * t316 / 0.64e2;
  t323 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t319);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t323;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t340 = 0.1e1 / t9 / t198;
  t341 = t19 * t340;
  t348 = t99 * t46;
  t359 = 0.1e1 / t205 / t127;
  t360 = t228 * t228;
  t361 = t359 * t360;
  t369 = t17 * t48;
  t378 = 0.1e1 / t119 / t118 * t103;
  t379 = t378 * t12;
  t381 = 0.1e1 / t14 / t13;
  t397 = t222 * t222;
  t398 = t121 * t121;
  t399 = 0.1e1 / t398;
  t404 = 0.7e1 / 0.9e1 * t105 * t106 * t87 * t122 - 0.2e1 / 0.3e1 * t211 * t369 * t224 + t211 * t212 * (0.7e1 / 0.27e2 * t107 * t106 * t87 - 0.8e1 / 0.3e1 * t379 * t381 * t287 / t9 / t99 / t85 + 0.22e2 / 0.9e1 * t218 * t112 * t101) * t223 / 0.4e1 - t211 * t212 * t397 * t399 / 0.4e1;
  t405 = t206 * t404;
  t414 = my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t8 * t148 * t35 - 0.5e1 / 0.9e1 * t6 * t179 * t55 + t6 * t78 * t132 / 0.2e1 - t6 * t42 * t233 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t10 * (-0.910e3 / 0.243e3 * t18 * t341 * t31 - 0.2074e4 / 0.243e3 * t18 * t341 * t27 + 0.563e3 / 0.81e2 * t98 / t40 / t348 * params->beta * t128 + 0.13e2 / 0.9e1 * t98 * t201 * t229 + 0.2e1 / 0.9e1 * t98 * t102 * t361 - t98 * t102 * t405 / 0.9e1));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t414 + 0.8e1 * t238;

  t436 = params->beta * t359;
  t448 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t179 * t69 + t6 * t78 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t42 * t259 - 0.3e1 / 0.8e1 * t6 * t10 * (0.35e2 / 0.81e2 * t64 * t192 + 0.104e3 / 0.81e2 * t64 * t195 - 0.169e3 / 0.108e3 * t97 * t202 - 0.5e1 / 0.12e2 * t97 * t101 * t256 - t254 * t436 * t360 / 0.12e2 + t254 * t255 * t404 / 0.24e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t448 + 0.6e1 * t264;

  t478 = my_piecewise3(t2, 0, t6 * t78 * t172 / 0.12e2 - t6 * t42 * t279 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * (0.7e1 / 0.108e3 * t163 * t89 + 0.11e2 / 0.108e3 * t163 * t92 + t167 * t129 / 0.8e1 + t167 * t149 * t229 / 0.12e2 + t167 * t168 * t361 / 0.32e2 - t167 * t168 * t405 / 0.64e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t478 + 0.4e1 * t284;

  t504 = t63 * t21;
  t541 = my_piecewise3(t2, 0, -t6 * t42 * t319 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * (t290 * t50 / 0.24e2 + t290 * t52 / 0.36e2 + 0.5e1 / 0.96e2 * t296 * t150 + t296 * t276 / 0.64e2 + t167 * t149 * t315 / 0.24e2 + t97 * t166 * t114 * t436 * t314 * t228 / 0.32e2 - t167 * t168 * t206 * (-t105 * t299 * t207 / 0.6e1 + t211 * t504 * t224 / 0.8e1 - t211 * t369 * t310 / 0.3e1 + t211 * t212 * (-t107 * t299 * t48 / 0.18e2 + t379 * t381 / t9 / t348 * sigma[0] - 0.2e1 / 0.3e1 * t217 * t254) * t223 / 0.4e1 - t211 * t212 * t309 * t399 * t222 / 0.4e1) / 0.64e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t541 + 0.2e1 * t323;

  t544 = t287 * sigma[0];
  t547 = t16 / t17 / t544;
  t558 = t314 * t314;
  t563 = t15 * t162;
  t582 = t309 * t309;
  t596 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * (0.5e1 / 0.64e2 * t547 * t32 - t547 * t66 / 0.24e2 + 0.7e1 / 0.256e3 * t97 / t544 * t169 + t296 * t316 / 0.32e2 + t167 * t168 * t359 * t558 / 0.32e2 - t167 * t168 * t206 * (-t105 * t563 * t123 / 0.16e2 + t211 * t504 * t310 / 0.4e1 + t211 * t212 * (-t107 * t563 * t21 / 0.48e2 - 0.3e1 / 0.8e1 * t378 * t12 * t381 * t340) * t223 / 0.4e1 - t211 * t212 * t582 * t399 / 0.4e1) / 0.64e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t596;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t29, t30;
  double t32, t33, t34, t36, t37, t41, t45, t46;
  double t47, t49, t50, t51, t55, t56, t57, t58;
  double t60, t61, t63, t64, t65, t67, t68, t72;
  double t76;

#ifndef XC_DONT_COMPILE_VXC
  double t77, t80, t81, t84, t85, t86, t87, t89;
  double t94, t95, t99, t100, t101, t104, t105, t107;
  double t108, t114, t119, t122, t123, t124, t125, t126;
  double t127, t128, t129, t133, t134, t138, t141, t143;
  double t146, t147, t151, t152, t157, t160, t162, t167;
  double t168, t173, t174, t180, t185, t188, t189, t195;
  double t199, t200, t201, t207, t211;

#ifndef XC_DONT_COMPILE_FXC
  double t214, t215, t217, t222, t223, t225, t228, t229;
  double t230, t236, t241, t242, t246, t248, t254, t255;
  double t258, t260, t262, t264, t265, t272, t273, t274;
  double t275, t276, t277, t279, t281, t282, t283, t284;
  double t287, t288, t289, t291, t295, t296, t298, t299;
  double t300, t304, t305, t306, t307, t310, t315, t318;
  double t319, t320, t321, t322, t324, t325, t327, t329;
  double t330, t334, t335, t339, t341, t343, t346, t348;
  double t355, t356, t358, t359, t363, t364, t368, t370;
  double t378, t379, t381, t382, t386, t388, t390, t394;
  double t396, t401, t402, t406, t408, t415, t418, t424;
  double t425, t429, t430, t436, t438, t442, t443, t448;
  double t453, t454, t464, t465, t472, t473, t474, t476;
  double t478, t481, t483, t487, t488, t490, t491, t492;
  double t496, t497, t498, t499, t502, t507, t515, t516;
  double t524, t525, t526, t529, t534, t541, t543, t549;
  double t554, t562, t563, t564, t567, t572, t575, t580;
  double t581, t583, t586, t590, t592, t597, t598, t600;
  double t603, t607;

#ifndef XC_DONT_COMPILE_KXC
  double t610, t612, t614, t617, t622, t624, t628, t631;
  double t635, t637, t641, t642, t643, t648, t652, t653;
  double t654, t658, t660, t665, t667, t670, t676, t677;
  double t680, t682, t685, t688, t689, t696, t698, t704;
  double t705, t706, t707, t711, t716, t717, t721, t722;
  double t723, t727, t729, t732, t737, t740, t742, t745;
  double t747, t749, t751, t754, t759, t760, t764, t766;
  double t768, t770, t772, t775, t777, t780, t781, t789;
  double t793, t794, t796, t797, t798, t801, t804, t807;
  double t808, t809, t813, t816, t820, t822, t826, t835;
  double t836, t837, t839, t840, t842, t843, t849, t851;
  double t853, t857, t858, t866, t867, t868, t872, t873;
  double t874, t878, t881, t882, t884, t893, t895, t898;
  double t908, t909, t911, t912, t916, t917, t921, t923;
  double t932, t935, t937, t938, t941, t949, t955, t956;
  double t960, t966, t970, t971, t972, t976, t978, t985;
  double t993, t995, t996, t1003, t1004, t1008, t1009, t1016;
  double t1019, t1022, t1029, t1033, t1037, t1041, t1042, t1043;
  double t1059, t1060, t1067, t1069, t1075, t1076, t1077, t1078;
  double t1086, t1087, t1091, t1092, t1093, t1097, t1099, t1102;
  double t1107, t1115, t1122, t1124, t1126, t1133, t1138, t1143;
  double t1150, t1154, t1156, t1162, t1170, t1176, t1183, t1186;
  double t1194, t1205, t1212, t1217, t1222, t1229, t1230, t1238;
  double t1242, t1245, t1250, t1257, t1259, t1265, t1270, t1278;
  double t1282, t1285, t1290, t1292, t1294, t1295, t1302, t1303;
  double t1306, t1316, t1317, t1321, t1323, t1326, t1330, t1331;
  double t1333, t1334, t1341, t1342, t1345, t1355, t1356, t1360;
  double t1362, t1365, t1369;

#ifndef XC_DONT_COMPILE_LXC
  double t1373, t1377, t1380, t1384, t1388, t1394, t1400, t1402;
  double t1408, t1411, t1414, t1417, t1418, t1425, t1437, t1438;
  double t1440, t1455, t1456, t1458, t1474, t1475, t1476, t1483;
  double t1491, t1495, t1498, t1502, t1504, t1512, t1520, t1523;
  double t1526, t1534, t1543, t1544, t1546, t1548, t1553, t1554;
  double t1559, t1560, t1563, t1565, t1568, t1570, t1571, t1573;
  double t1577, t1580, t1585, t1592, t1596, t1600, t1605, t1607;
  double t1614, t1618, t1619, t1622, t1631, t1637, t1638, t1640;
  double t1649, t1663, t1665, t1670, t1673, t1675, t1677, t1689;
  double t1693, t1695, t1706, t1707, t1709, t1712, t1716, t1719;
  double t1732, t1733, t1739, t1740, t1742, t1747, t1749, t1752;
  double t1758, t1759, t1766, t1770, t1771, t1774, t1783, t1786;
  double t1787, t1789, t1791, t1792, t1801, t1805, t1820, t1825;
  double t1829, t1844, t1845, t1854, t1865, t1866, t1867, t1868;
  double t1870, t1871, t1878, t1883, t1890, t1892, t1901, t1908;
  double t1911, t1919, t1921, t1934, t1936, t1941, t1943, t1950;
  double t1954, t1963, t1966, t1977, t1980, t1982, t1983, t1999;
  double t2005, t2006, t2013, t2024, t2025, t2028, t2031, t2051;
  double t2067, t2072, t2080, t2082, t2091, t2093, t2100, t2108;
  double t2117, t2127, t2129, t2130, t2143, t2152, t2168, t2169;
  double t2176, t2188, t2189, t2191, t2206, t2207, t2223, t2224;
  double t2225, t2232, t2240, t2247, t2277, t2278, t2286, t2287;
  double t2295, t2301, t2304, t2311, t2313, t2316, t2318, t2339;
  double t2346, t2349, t2353, t2355, t2357, t2363, t2368, t2372;
  double t2381, t2382, t2384, t2390, t2392, t2401, t2403, t2406;
  double t2412, t2421, t2427, t2434, t2442, t2444, t2445, t2454;
  double t2471, t2492, t2499, t2506, t2508, t2510, t2520, t2532;
  double t2539, t2543, t2545, t2551, t2559, t2565, t2572, t2575;
  double t2583, t2594, t2604, t2616, t2623, t2624, t2634, t2684;
  double t2691, t2693, t2699, t2704, t2714, t2764, t2766, t2769;
  double t2782, t2787, t2797, t2806, t2820, t2821, t2824, t2837;
  double t2842, t2860, t2874;
#endif

#endif

#endif

#endif

#endif


  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = M_CBRT2;
  t12 = t11 * rho[0];
  t13 = POW_1_3(t8);
  t17 = my_piecewise3(t10, 0, 0.2e1 * t12 * t7 * t13);
  t18 = POW_1_3(t6);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = POW_1_3(rho[0]);
  t29 = 0.1e1 / t27 / rho[0];
  t30 = t26 * t29;
  t32 = t25 * t30 / 0.12e2;
  t33 = xc_integrate(func0, NULL, 0.0, t32);
  t34 = log(t32);
  t36 = xc_integrate(func1, NULL, 0.0, t32);
  t37 = t33 * t34 - t36;
  t41 = 0.1e1 - t25 * t30 * t37 / 0.12e2;
  t45 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t41);
  t46 = rho[1] <= p->dens_threshold;
  t47 = rho[1] * t7;
  t49 = 0.2e1 * t47 <= p->zeta_threshold;
  t50 = t11 * rho[1];
  t51 = POW_1_3(t47);
  t55 = my_piecewise3(t49, 0, 0.2e1 * t50 * t7 * t51);
  t56 = t55 * t18;
  t57 = sqrt(sigma[2]);
  t58 = POW_1_3(rho[1]);
  t60 = 0.1e1 / t58 / rho[1];
  t61 = t57 * t60;
  t63 = t25 * t61 / 0.12e2;
  t64 = xc_integrate(func0, NULL, 0.0, t63);
  t65 = log(t63);
  t67 = xc_integrate(func1, NULL, 0.0, t63);
  t68 = t64 * t65 - t67;
  t72 = 0.1e1 - t25 * t61 * t68 / 0.12e2;
  t76 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t56 * t72);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t45 + t76;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t77 = t11 * t7;
  t80 = t6 * t6;
  t81 = 0.1e1 / t80;
  t84 = 0.2e1 * t12 * t81 * t13;
  t85 = t13 * t13;
  t86 = 0.1e1 / t85;
  t87 = t7 * t86;
  t89 = -rho[0] * t81 + t7;
  t94 = my_piecewise3(t10, 0, 0.2e1 * t77 * t13 - t84 + 0.2e1 / 0.3e1 * t12 * t87 * t89);
  t95 = t94 * t18;
  t99 = t18 * t18;
  t100 = 0.1e1 / t99;
  t101 = t17 * t100;
  t104 = t5 * t101 * t41 / 0.8e1;
  t105 = rho[0] * rho[0];
  t107 = 0.1e1 / t27 / t105;
  t108 = t26 * t107;
  t114 = t25 * t108 * t33 / 0.9e1 + t25 * t108 * t37 / 0.9e1;
  t119 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t95 * t41 - t104 - 0.3e1 / 0.8e1 * t5 * t19 * t114);
  t122 = 0.2e1 * t50 * t81 * t51;
  t123 = rho[1] * rho[1];
  t124 = t11 * t123;
  t125 = t80 * t6;
  t126 = 0.1e1 / t125;
  t127 = t51 * t51;
  t128 = 0.1e1 / t127;
  t129 = t126 * t128;
  t133 = my_piecewise3(t49, 0, -t122 - 0.2e1 / 0.3e1 * t124 * t129);
  t134 = t133 * t18;
  t138 = t55 * t100;
  t141 = t5 * t138 * t72 / 0.8e1;
  t143 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t134 * t72 - t141);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t45 + t76 + t6 * (t119 + t143);

  t146 = t11 * t105;
  t147 = t126 * t86;
  t151 = my_piecewise3(t10, 0, -t84 - 0.2e1 / 0.3e1 * t146 * t147);
  t152 = t151 * t18;
  t157 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t152 * t41 - t104);
  t160 = t7 * t128;
  t162 = -rho[1] * t81 + t7;
  t167 = my_piecewise3(t49, 0, 0.2e1 * t77 * t51 - t122 + 0.2e1 / 0.3e1 * t50 * t160 * t162);
  t168 = t167 * t18;
  t173 = 0.1e1 / t58 / t123;
  t174 = t57 * t173;
  t180 = t25 * t174 * t64 / 0.9e1 + t25 * t174 * t68 / 0.9e1;
  t185 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t168 * t72 - t141 - 0.3e1 / 0.8e1 * t5 * t56 * t180);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t45 + t76 + t6 * (t157 + t185);

  t188 = 0.1e1 / t26;
  t189 = t188 * t29;
  t195 = -t25 * t189 * t33 / 0.24e2 - t25 * t189 * t37 / 0.24e2;
  t199 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t195);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t6 * t199;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t200 = 0.1e1 / t57;
  t201 = t200 * t60;
  t207 = -t25 * t201 * t64 / 0.24e2 - t25 * t201 * t68 / 0.24e2;
  t211 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t56 * t207);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t211;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t214 = t11 * t81;
  t215 = t214 * t13;
  t217 = t86 * t89;
  t222 = 0.4e1 * t12 * t126 * t13;
  t223 = t81 * t86;
  t225 = t12 * t223 * t89;
  t228 = 0.1e1 / t85 / t8;
  t229 = t7 * t228;
  t230 = t89 * t89;
  t236 = 0.2e1 * rho[0] * t126 - 0.2e1 * t81;
  t241 = my_piecewise3(t10, 0, -0.4e1 * t215 + 0.4e1 / 0.3e1 * t77 * t217 + t222 - 0.4e1 / 0.3e1 * t225 - 0.4e1 / 0.9e1 * t12 * t229 * t230 + 0.2e1 / 0.3e1 * t12 * t87 * t236);
  t242 = t241 * t18;
  t246 = t94 * t100;
  t248 = t5 * t246 * t41;
  t254 = 0.1e1 / t99 / t6;
  t255 = t17 * t254;
  t258 = t5 * t255 * t41 / 0.12e2;
  t260 = t5 * t101 * t114;
  t262 = t105 * rho[0];
  t264 = 0.1e1 / t27 / t262;
  t265 = t26 * t264;
  t272 = t23 * t23;
  t273 = 0.1e1 / t272;
  t274 = t20 * t273;
  t275 = t274 * sigma[0];
  t276 = t105 * t105;
  t277 = t27 * t27;
  t279 = 0.1e1 / t277 / t276;
  t281 = params->beta * t11;
  t282 = t281 * t21;
  t283 = t24 * t26;
  t284 = t11 * t21;
  t287 = t11 * t11;
  t288 = t287 * t20;
  t289 = t273 * sigma[0];
  t291 = 0.1e1 / t277 / t105;
  t295 = 0.6e1 * t288 * t289 * t291 + 0.144e3;
  t296 = sqrt(t295);
  t298 = t284 * t283 * t29 / 0.12e2 + t296 / 0.12e2;
  t299 = log(t298);
  t300 = t29 * t299;
  t304 = 0.1e1 + t282 * t283 * t300 / 0.4e1;
  t305 = 0.1e1 / t304;
  t306 = t11 * t305;
  t307 = t279 * params->beta * t306;
  t310 = -0.7e1 / 0.27e2 * t25 * t265 * t37 - 0.11e2 / 0.27e2 * t25 * t265 * t33 + t275 * t307 / 0.18e2;
  t315 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t242 * t41 - t248 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t95 * t114 + t258 - t260 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * t310);
  t318 = 0.4e1 * t50 * t126 * t51;
  t319 = t80 * t80;
  t320 = 0.1e1 / t319;
  t321 = t320 * t128;
  t322 = t124 * t321;
  t324 = t123 * rho[1];
  t325 = t11 * t324;
  t327 = 0.1e1 / t319 / t6;
  t329 = 0.1e1 / t127 / t47;
  t330 = t327 * t329;
  t334 = my_piecewise3(t49, 0, t318 + 0.8e1 / 0.3e1 * t322 - 0.4e1 / 0.9e1 * t325 * t330);
  t335 = t334 * t18;
  t339 = t133 * t100;
  t341 = t5 * t339 * t72;
  t343 = t55 * t254;
  t346 = t5 * t343 * t72 / 0.12e2;
  t348 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t335 * t72 - t341 / 0.4e1 + t346);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t119 + 0.2e1 * t143 + t6 * (t315 + t348);

  t355 = t320 * t86;
  t356 = t146 * t355;
  t358 = t126 * t228;
  t359 = t358 * t89;
  t363 = my_piecewise3(t10, 0, -0.2e1 * t215 + t222 - 0.2e1 / 0.3e1 * t225 - 0.4e1 / 0.3e1 * t12 * t147 + 0.2e1 * t356 + 0.4e1 / 0.9e1 * t146 * t359);
  t364 = t363 * t18;
  t368 = t151 * t100;
  t370 = t5 * t368 * t41;
  t378 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t364 * t41 - t370 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t114 - t248 / 0.8e1 + t258 - t260 / 0.8e1);
  t379 = t214 * t51;
  t381 = t11 * t126;
  t382 = t128 * rho[1];
  t386 = t81 * t128;
  t388 = t50 * t386 * t162;
  t390 = t126 * t329;
  t394 = rho[1] * t126;
  t396 = -t81 + 0.2e1 * t394;
  t401 = my_piecewise3(t49, 0, -0.2e1 * t379 - 0.2e1 / 0.3e1 * t381 * t382 + t318 + 0.2e1 / 0.3e1 * t322 - 0.2e1 / 0.3e1 * t388 + 0.4e1 / 0.9e1 * t124 * t390 * t162 + 0.2e1 / 0.3e1 * t50 * t160 * t396);
  t402 = t401 * t18;
  t406 = t167 * t100;
  t408 = t5 * t406 * t72;
  t415 = t5 * t138 * t180;
  t418 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t402 * t72 - t408 / 0.8e1 - t341 / 0.8e1 + t346 - 0.3e1 / 0.8e1 * t5 * t134 * t180 - t415 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t119 + t143 + t157 + t185 + t6 * (t378 + t418);

  t424 = t11 * t262;
  t425 = t327 * t228;
  t429 = my_piecewise3(t10, 0, t222 + 0.8e1 / 0.3e1 * t356 - 0.4e1 / 0.9e1 * t424 * t425);
  t430 = t429 * t18;
  t436 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t430 * t41 - t370 / 0.4e1 + t258);
  t438 = t128 * t162;
  t442 = t7 * t329;
  t443 = t162 * t162;
  t448 = -0.2e1 * t81 + 0.2e1 * t394;
  t453 = my_piecewise3(t49, 0, -0.4e1 * t379 + 0.4e1 / 0.3e1 * t77 * t438 + t318 - 0.4e1 / 0.3e1 * t388 - 0.4e1 / 0.9e1 * t50 * t442 * t443 + 0.2e1 / 0.3e1 * t50 * t160 * t448);
  t454 = t453 * t18;
  t464 = 0.1e1 / t58 / t324;
  t465 = t57 * t464;
  t472 = t274 * sigma[2];
  t473 = t123 * t123;
  t474 = t58 * t58;
  t476 = 0.1e1 / t474 / t473;
  t478 = t24 * t57;
  t481 = t273 * sigma[2];
  t483 = 0.1e1 / t474 / t123;
  t487 = 0.6e1 * t288 * t481 * t483 + 0.144e3;
  t488 = sqrt(t487);
  t490 = t284 * t478 * t60 / 0.12e2 + t488 / 0.12e2;
  t491 = log(t490);
  t492 = t60 * t491;
  t496 = 0.1e1 + t282 * t478 * t492 / 0.4e1;
  t497 = 0.1e1 / t496;
  t498 = t11 * t497;
  t499 = t476 * params->beta * t498;
  t502 = -0.7e1 / 0.27e2 * t25 * t465 * t68 - 0.11e2 / 0.27e2 * t25 * t465 * t64 + t472 * t499 / 0.18e2;
  t507 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t454 * t72 - t408 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t168 * t180 + t346 - t415 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t56 * t502);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t157 + 0.2e1 * t185 + t6 * (t436 + t507);

  t515 = t5 * t101 * t195 / 0.8e1;
  t516 = t188 * t107;
  t524 = 0.1e1 / t277 / t262;
  t525 = t274 * t524;
  t526 = t281 * t305;
  t529 = t25 * t516 * t37 / 0.18e2 + t25 * t516 * t33 / 0.9e1 - t525 * t526 / 0.48e2;
  t534 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t95 * t195 - t515 - 0.3e1 / 0.8e1 * t5 * t19 * t529);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t534 * t6 + t199;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t541 = t5 * t138 * t207 / 0.8e1;
  t543 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t134 * t207 - t541);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t543 * t6 + t211;

  t549 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t152 * t195 - t515);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t549 * t6 + t199;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t554 = t200 * t173;
  t562 = 0.1e1 / t474 / t324;
  t563 = t274 * t562;
  t564 = t281 * t497;
  t567 = t25 * t554 * t68 / 0.18e2 + t25 * t554 * t64 / 0.9e1 - t563 * t564 / 0.48e2;
  t572 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t168 * t207 - t541 - 0.3e1 / 0.8e1 * t5 * t56 * t567);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t572 * t6 + t211;

  t575 = 0.1e1 / t26 / sigma[0];
  t580 = 0.1e1 / sigma[0];
  t581 = t274 * t580;
  t583 = t291 * params->beta * t306;
  t586 = t25 * t575 * t29 * t37 / 0.48e2 + t581 * t583 / 0.128e3;
  t590 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t586);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t590;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t592 = 0.1e1 / t57 / sigma[2];
  t597 = 0.1e1 / sigma[2];
  t598 = t274 * t597;
  t600 = t483 * params->beta * t498;
  t603 = t25 * t592 * t60 * t68 / 0.48e2 + t598 * t600 / 0.128e3;
  t607 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t56 * t603);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t607;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t610 = t381 * t13;
  t612 = t214 * t217;
  t614 = t228 * t230;
  t617 = t86 * t236;
  t622 = 0.12e2 * t12 * t320 * t13;
  t624 = t12 * t147 * t89;
  t628 = t12 * t81 * t228 * t230;
  t631 = t12 * t223 * t236;
  t635 = 0.1e1 / t85 / t105 / t81;
  t637 = t230 * t89;
  t641 = t12 * t7;
  t642 = t228 * t89;
  t643 = t642 * t236;
  t648 = -0.6e1 * rho[0] * t320 + 0.6e1 * t126;
  t652 = 0.12e2 * t610 - 0.4e1 * t612 - 0.4e1 / 0.3e1 * t77 * t614 + 0.2e1 * t77 * t617 - t622 + 0.4e1 * t624 + 0.4e1 / 0.3e1 * t628 - 0.2e1 * t631 + 0.20e2 / 0.27e2 * t12 * t7 * t635 * t637 - 0.4e1 / 0.3e1 * t641 * t643 + 0.2e1 / 0.3e1 * t12 * t87 * t648;
  t653 = my_piecewise3(t10, 0, t652);
  t654 = t653 * t18;
  t658 = t241 * t100;
  t660 = t5 * t658 * t41;
  t665 = t94 * t254;
  t667 = t5 * t665 * t41;
  t670 = t5 * t246 * t114;
  t676 = 0.1e1 / t99 / t80;
  t677 = t17 * t676;
  t680 = 0.5e1 / 0.36e2 * t5 * t677 * t41;
  t682 = t5 * t255 * t114;
  t685 = t5 * t101 * t310;
  t688 = 0.1e1 / t27 / t276;
  t689 = t26 * t688;
  t696 = t276 * rho[0];
  t698 = 0.1e1 / t277 / t696;
  t704 = t274 * sigma[0] * t279;
  t705 = t304 * t304;
  t706 = 0.1e1 / t705;
  t707 = t107 * t299;
  t711 = t281 * t25;
  t716 = 0.1e1 / t296 * t287;
  t717 = t716 * t20;
  t721 = -t284 * t283 * t107 / 0.9e1 - 0.2e1 / 0.3e1 * t717 * t289 * t524;
  t722 = 0.1e1 / t298;
  t723 = t721 * t722;
  t727 = -t282 * t283 * t707 / 0.3e1 + t711 * t30 * t723 / 0.4e1;
  t729 = t281 * t706 * t727;
  t732 = 0.70e2 / 0.81e2 * t25 * t689 * t37 + 0.46e2 / 0.27e2 * t25 * t689 * t33 - 0.25e2 / 0.54e2 * t275 * t698 * params->beta * t306 - t704 * t729 / 0.18e2;
  t737 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t654 * t41 - 0.3e1 / 0.8e1 * t660 - 0.9e1 / 0.8e1 * t5 * t242 * t114 + t667 / 0.4e1 - 0.3e1 / 0.4e1 * t670 - 0.9e1 / 0.8e1 * t5 * t95 * t310 - t680 + t682 / 0.4e1 - 0.3e1 / 0.8e1 * t685 - 0.3e1 / 0.8e1 * t5 * t19 * t732);
  t740 = 0.12e2 * t50 * t320 * t51;
  t742 = t124 * t327 * t128;
  t745 = 0.1e1 / t319 / t80;
  t747 = t325 * t745 * t329;
  t749 = t11 * t473;
  t751 = 0.1e1 / t319 / t125;
  t754 = 0.1e1 / t127 / t123 / t81;
  t759 = my_piecewise3(t49, 0, -t740 - 0.12e2 * t742 + 0.4e1 * t747 - 0.20e2 / 0.27e2 * t749 * t751 * t754);
  t760 = t759 * t18;
  t764 = t334 * t100;
  t766 = t5 * t764 * t72;
  t768 = t133 * t254;
  t770 = t5 * t768 * t72;
  t772 = t55 * t676;
  t775 = 0.5e1 / 0.36e2 * t5 * t772 * t72;
  t777 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t760 * t72 - 0.3e1 / 0.8e1 * t766 + t770 / 0.4e1 - t775);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t315 + 0.3e1 * t348 + t6 * (t737 + t777);

  t780 = 0.2e1 * t378;
  t781 = 0.2e1 * t418;
  t789 = t12 * t355;
  t793 = t327 * t86;
  t794 = t146 * t793;
  t796 = t320 * t228;
  t797 = t796 * t89;
  t798 = t146 * t797;
  t801 = t126 * t635 * t230;
  t804 = t358 * t236;
  t807 = 0.8e1 * t610 - 0.4e1 / 0.3e1 * t612 - t622 + 0.8e1 / 0.3e1 * t624 + 0.4e1 / 0.9e1 * t628 - 0.2e1 / 0.3e1 * t631 - 0.4e1 / 0.3e1 * t381 * t86 + 0.8e1 * t789 + 0.16e2 / 0.9e1 * t12 * t359 - 0.8e1 * t794 - 0.8e1 / 0.3e1 * t798 - 0.20e2 / 0.27e2 * t146 * t801 + 0.4e1 / 0.9e1 * t146 * t804;
  t808 = my_piecewise3(t10, 0, t807);
  t809 = t808 * t18;
  t813 = t363 * t100;
  t816 = t5 * t813 * t41 / 0.4e1;
  t820 = t151 * t254;
  t822 = t5 * t820 * t41;
  t826 = t5 * t368 * t114 / 0.4e1;
  t835 = -0.3e1 / 0.8e1 * t5 * t809 * t41 - t816 - 0.3e1 / 0.4e1 * t5 * t364 * t114 + t822 / 0.12e2 - t826 - 0.3e1 / 0.8e1 * t5 * t152 * t310 - t660 / 0.8e1 + t667 / 0.6e1 - t670 / 0.4e1 - t680 + t682 / 0.6e1 - t685 / 0.8e1;
  t836 = my_piecewise3(t1, 0, t835);
  t837 = t381 * t51;
  t839 = t11 * t320;
  t840 = t839 * t382;
  t842 = t11 * t327;
  t843 = t329 * t123;
  t849 = t50 * t129 * t162;
  t851 = t320 * t329;
  t853 = t124 * t851 * t162;
  t857 = 0.4e1 / 0.3e1 * t50 * t386 * t396;
  t858 = t327 * t754;
  t866 = rho[1] * t320;
  t867 = 0.6e1 * t866;
  t868 = 0.2e1 * t126 - t867;
  t872 = 0.4e1 * t837 + 0.8e1 / 0.3e1 * t840 - 0.4e1 / 0.9e1 * t842 * t843 - t740 - 0.4e1 * t742 + 0.4e1 / 0.9e1 * t747 + 0.4e1 / 0.3e1 * t849 - 0.16e2 / 0.9e1 * t853 - t857 + 0.20e2 / 0.27e2 * t325 * t858 * t162 + 0.8e1 / 0.9e1 * t124 * t390 * t396 + 0.2e1 / 0.3e1 * t50 * t160 * t868;
  t873 = my_piecewise3(t49, 0, t872);
  t874 = t873 * t18;
  t878 = t401 * t100;
  t881 = t5 * t878 * t72 / 0.4e1;
  t882 = t167 * t254;
  t884 = t5 * t882 * t72;
  t893 = t5 * t339 * t180 / 0.4e1;
  t895 = t5 * t343 * t180;
  t898 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t874 * t72 - t881 + t884 / 0.12e2 - t766 / 0.8e1 + t770 / 0.6e1 - t775 - 0.3e1 / 0.8e1 * t5 * t335 * t180 - t893 + t895 / 0.12e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t315 + t348 + t780 + t781 + t6 * (t836 + t898);

  t908 = t745 * t228;
  t909 = t424 * t908;
  t911 = t327 * t635;
  t912 = t911 * t89;
  t916 = my_piecewise3(t10, 0, 0.4e1 * t610 - t622 + 0.4e1 / 0.3e1 * t624 + 0.16e2 / 0.3e1 * t789 - 0.32e2 / 0.3e1 * t794 - 0.16e2 / 0.9e1 * t798 - 0.4e1 / 0.3e1 * t146 * t425 + 0.20e2 / 0.9e1 * t909 + 0.20e2 / 0.27e2 * t424 * t912);
  t917 = t916 * t18;
  t921 = t429 * t100;
  t923 = t5 * t921 * t41;
  t932 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t917 * t41 - t923 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t430 * t114 - t816 + t822 / 0.6e1 - t826 + t667 / 0.12e2 - t680 + t682 / 0.12e2);
  t935 = t214 * t438;
  t937 = t329 * t162;
  t938 = t937 * rho[1];
  t941 = t128 * t396;
  t949 = t50 * t81 * t329 * t443;
  t955 = t50 * t7;
  t956 = t937 * t396;
  t960 = t50 * t386 * t448;
  t966 = 0.4e1 * t126 - t867;
  t970 = 0.8e1 * t837 + 0.4e1 / 0.3e1 * t840 - 0.4e1 / 0.3e1 * t935 + 0.8e1 / 0.9e1 * t381 * t938 + 0.4e1 / 0.3e1 * t77 * t941 - t740 - 0.4e1 / 0.3e1 * t742 + 0.8e1 / 0.3e1 * t849 - 0.8e1 / 0.9e1 * t853 - t857 + 0.4e1 / 0.9e1 * t949 - 0.20e2 / 0.27e2 * t124 * t126 * t754 * t443 - 0.8e1 / 0.9e1 * t955 * t956 - 0.2e1 / 0.3e1 * t960 + 0.4e1 / 0.9e1 * t124 * t390 * t448 + 0.2e1 / 0.3e1 * t50 * t160 * t966;
  t971 = my_piecewise3(t49, 0, t970);
  t972 = t971 * t18;
  t976 = t453 * t100;
  t978 = t5 * t976 * t72;
  t985 = t5 * t406 * t180;
  t993 = t5 * t138 * t502;
  t995 = -0.3e1 / 0.8e1 * t5 * t972 * t72 - t978 / 0.8e1 - t881 + t884 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t402 * t180 - t985 / 0.4e1 + t770 / 0.12e2 - t775 - t893 + t895 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t134 * t502 - t993 / 0.8e1;
  t996 = my_piecewise3(t46, 0, t995);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t780 + t781 + t436 + t507 + t6 * (t932 + t996);

  t1003 = t11 * t276;
  t1004 = t751 * t635;
  t1008 = my_piecewise3(t10, 0, -t622 - 0.12e2 * t794 + 0.4e1 * t909 - 0.20e2 / 0.27e2 * t1003 * t1004);
  t1009 = t1008 * t18;
  t1016 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1009 * t41 - 0.3e1 / 0.8e1 * t923 + t822 / 0.4e1 - t680);
  t1019 = t329 * t443;
  t1022 = t128 * t448;
  t1029 = t443 * t162;
  t1033 = t937 * t448;
  t1037 = 0.6e1 * t126 - 0.6e1 * t866;
  t1041 = 0.12e2 * t837 - 0.4e1 * t935 - 0.4e1 / 0.3e1 * t77 * t1019 + 0.2e1 * t77 * t1022 - t740 + 0.4e1 * t849 + 0.4e1 / 0.3e1 * t949 - 0.2e1 * t960 + 0.20e2 / 0.27e2 * t50 * t7 * t754 * t1029 - 0.4e1 / 0.3e1 * t955 * t1033 + 0.2e1 / 0.3e1 * t50 * t160 * t1037;
  t1042 = my_piecewise3(t49, 0, t1041);
  t1043 = t1042 * t18;
  t1059 = 0.1e1 / t58 / t473;
  t1060 = t57 * t1059;
  t1067 = t473 * rho[1];
  t1069 = 0.1e1 / t474 / t1067;
  t1075 = t274 * sigma[2] * t476;
  t1076 = t496 * t496;
  t1077 = 0.1e1 / t1076;
  t1078 = t173 * t491;
  t1086 = 0.1e1 / t488 * t287;
  t1087 = t1086 * t20;
  t1091 = -t284 * t478 * t173 / 0.9e1 - 0.2e1 / 0.3e1 * t1087 * t481 * t562;
  t1092 = 0.1e1 / t490;
  t1093 = t1091 * t1092;
  t1097 = -t282 * t478 * t1078 / 0.3e1 + t711 * t61 * t1093 / 0.4e1;
  t1099 = t281 * t1077 * t1097;
  t1102 = 0.70e2 / 0.81e2 * t25 * t1060 * t68 + 0.46e2 / 0.27e2 * t25 * t1060 * t64 - 0.25e2 / 0.54e2 * t472 * t1069 * params->beta * t498 - t1075 * t1099 / 0.18e2;
  t1107 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t1043 * t72 - 0.3e1 / 0.8e1 * t978 - 0.9e1 / 0.8e1 * t5 * t454 * t180 + t884 / 0.4e1 - 0.3e1 / 0.4e1 * t985 - 0.9e1 / 0.8e1 * t5 * t168 * t502 - t775 + t895 / 0.4e1 - 0.3e1 / 0.8e1 * t993 - 0.3e1 / 0.8e1 * t5 * t56 * t1102);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t436 + 0.3e1 * t507 + t6 * (t1016 + t1107);

  t1115 = t5 * t246 * t195;
  t1122 = t5 * t255 * t195 / 0.12e2;
  t1124 = t5 * t101 * t529;
  t1126 = t188 * t264;
  t1133 = t274 * t279;
  t1138 = -0.7e1 / 0.54e2 * t25 * t1126 * t37 - t25 * t1126 * t33 / 0.3e1 + 0.19e2 / 0.144e3 * t1133 * t526 + t525 * t729 / 0.48e2;
  t1143 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t242 * t195 - t1115 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t95 * t529 + t1122 - t1124 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * t1138);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t1143 * t6 + 0.2e1 * t534;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t1150 = t5 * t339 * t207;
  t1154 = t5 * t343 * t207 / 0.12e2;
  t1156 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t335 * t207 - t1150 / 0.4e1 + t1154);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t1156 * t6 + 0.2e1 * t543;

  t1162 = t5 * t368 * t195;
  t1170 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t364 * t195 - t1162 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t529 - t1115 / 0.8e1 + t1122 - t1124 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t1170 * t6 + t534 + t549;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1176 = t5 * t406 * t207;
  t1183 = t5 * t138 * t567;
  t1186 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t402 * t207 - t1176 / 0.8e1 - t1150 / 0.8e1 + t1154 - 0.3e1 / 0.8e1 * t5 * t134 * t567 - t1183 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t1186 * t6 + t543 + t572;

  t1194 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t430 * t195 - t1162 / 0.4e1 + t1122);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t1194 * t6 + 0.2e1 * t549;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1205 = t200 * t464;
  t1212 = t274 * t476;
  t1217 = -0.7e1 / 0.54e2 * t25 * t1205 * t68 - t25 * t1205 * t64 / 0.3e1 + 0.19e2 / 0.144e3 * t1212 * t564 + t563 * t1099 / 0.48e2;
  t1222 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t454 * t207 - t1176 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t168 * t567 + t1154 - t1183 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t56 * t1217);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t1222 * t6 + 0.2e1 * t572;

  t1229 = t5 * t101 * t586 / 0.8e1;
  t1230 = t575 * t107;
  t1238 = t524 * params->beta * t306;
  t1242 = t274 * t580 * t291;
  t1245 = -t25 * t1230 * t37 / 0.36e2 - t25 * t1230 * t33 / 0.36e2 - t581 * t1238 / 0.48e2 - t1242 * t729 / 0.128e3;
  t1250 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t95 * t586 - t1229 - 0.3e1 / 0.8e1 * t5 * t19 * t1245);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t1250 * t6 + t590;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1257 = t5 * t138 * t603 / 0.8e1;
  t1259 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t134 * t603 - t1257);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = t1259 * t6 + t607;

  t1265 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t152 * t586 - t1229);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t1265 * t6 + t590;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1270 = t592 * t173;
  t1278 = t562 * params->beta * t498;
  t1282 = t274 * t597 * t483;
  t1285 = -t25 * t1270 * t68 / 0.36e2 - t25 * t1270 * t64 / 0.36e2 - t598 * t1278 / 0.48e2 - t1282 * t1099 / 0.128e3;
  t1290 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t168 * t603 - t1257 - 0.3e1 / 0.8e1 * t5 * t56 * t1285);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t1290 * t6 + t607;

  t1292 = sigma[0] * sigma[0];
  t1294 = 0.1e1 / t26 / t1292;
  t1295 = t1294 * t29;
  t1302 = 0.1e1 / t1292;
  t1303 = t274 * t1302;
  t1306 = t24 * t188;
  t1316 = t284 * t1306 * t29 / 0.24e2 + t716 * t274 * t291 / 0.4e1;
  t1317 = t1316 * t722;
  t1321 = t282 * t1306 * t300 / 0.8e1 + t711 * t30 * t1317 / 0.4e1;
  t1323 = t281 * t706 * t1321;
  t1326 = -t25 * t1295 * t37 / 0.32e2 + t25 * t1295 * t33 / 0.96e2 - t1303 * t583 / 0.128e3 - t1242 * t1323 / 0.128e3;
  t1330 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t1326);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = t6 * t1330;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1331 = sigma[2] * sigma[2];
  t1333 = 0.1e1 / t57 / t1331;
  t1334 = t1333 * t60;
  t1341 = 0.1e1 / t1331;
  t1342 = t274 * t1341;
  t1345 = t24 * t200;
  t1355 = t284 * t1345 * t60 / 0.24e2 + t1086 * t274 * t483 / 0.4e1;
  t1356 = t1355 * t1092;
  t1360 = t282 * t1345 * t492 / 0.8e1 + t711 * t61 * t1356 / 0.4e1;
  t1362 = t281 * t1077 * t1360;
  t1365 = -t25 * t1334 * t68 / 0.32e2 + t25 * t1334 * t64 / 0.96e2 - t1342 * t600 / 0.128e3 - t1282 * t1362 / 0.128e3;
  t1369 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t56 * t1365);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = t6 * t1369;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1373 = 0.1e1 / t99 / t125;
  t1377 = 0.10e2 / 0.27e2 * t5 * t17 * t1373 * t41;
  t1380 = t5 * t653 * t100 * t41;
  t1384 = t5 * t241 * t254 * t41;
  t1388 = t5 * t94 * t676 * t41;
  t1394 = t5 * t658 * t114;
  t1400 = t5 * t665 * t114;
  t1402 = t5 * t246 * t310;
  t1408 = t5 * t677 * t114;
  t1411 = t5 * t255 * t310;
  t1414 = t5 * t101 * t732;
  t1417 = 0.1e1 / t27 / t696;
  t1418 = t26 * t1417;
  t1425 = t276 * t105;
  t1437 = 0.1e1 / t705 / t304;
  t1438 = t727 * t727;
  t1440 = t281 * t1437 * t1438;
  t1455 = 0.1e1 / t296 / t295 * t11;
  t1456 = t1455 * t21;
  t1458 = 0.1e1 / t23 / t22;
  t1474 = t721 * t721;
  t1475 = t298 * t298;
  t1476 = 0.1e1 / t1475;
  t1483 = t281 * t706 * (0.7e1 / 0.9e1 * t282 * t283 * t264 * t299 - 0.2e1 / 0.3e1 * t711 * t108 * t723 + t711 * t30 * (0.7e1 / 0.27e2 * t284 * t283 * t264 - 0.32e2 / 0.3e1 * t1456 * t1458 * t1292 / t27 / t276 / t262 + 0.22e2 / 0.9e1 * t717 * t289 * t279) * t722 / 0.4e1 - t711 * t30 * t1474 * t1476 / 0.4e1);
  t1491 = t12 * t358 * t230;
  t1495 = t12 * t81 * t635 * t637;
  t1498 = t12 * t81 * t643;
  t1502 = 0.1e1 / t85 / t262 / t126;
  t1504 = t230 * t230;
  t1512 = t236 * t236;
  t1520 = t12 * t355 * t89;
  t1523 = t12 * t147 * t236;
  t1526 = t12 * t223 * t648;
  t1534 = t214 * t614;
  t1543 = 0.48e2 * t12 * t327 * t13;
  t1544 = t839 * t13;
  t1546 = t381 * t217;
  t1548 = t214 * t617;
  t1553 = -0.16e2 / 0.3e1 * t1491 - 0.80e2 / 0.27e2 * t1495 + 0.16e2 / 0.3e1 * t1498 - 0.160e3 / 0.81e2 * t12 * t7 * t1502 * t1504 + 0.40e2 / 0.9e1 * t641 * t635 * t230 * t236 - 0.4e1 / 0.3e1 * t12 * t229 * t1512 - 0.16e2 / 0.9e1 * t641 * t642 * t648 - 0.16e2 * t1520 + 0.8e1 * t1523 - 0.8e1 / 0.3e1 * t1526 + 0.2e1 / 0.3e1 * t12 * t87 * (0.24e2 * rho[0] * t327 - 0.24e2 * t320) + 0.16e2 / 0.3e1 * t1534 + 0.80e2 / 0.27e2 * t77 * t635 * t637 - 0.16e2 / 0.3e1 * t77 * t643 + t1543 - 0.48e2 * t1544 + 0.16e2 * t1546 - 0.8e1 * t1548 + 0.8e1 / 0.3e1 * t77 * t86 * t648;
  t1554 = my_piecewise3(t10, 0, t1553);
  t1559 = t1377 - t1380 / 0.2e1 + t1384 / 0.2e1 - 0.5e1 / 0.9e1 * t1388 - 0.3e1 / 0.2e1 * t5 * t654 * t114 - 0.3e1 / 0.2e1 * t1394 - 0.9e1 / 0.4e1 * t5 * t242 * t310 + t1400 - 0.3e1 / 0.2e1 * t1402 - 0.3e1 / 0.2e1 * t5 * t95 * t732 - 0.5e1 / 0.9e1 * t1408 + t1411 / 0.2e1 - t1414 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t19 * (-0.910e3 / 0.243e3 * t25 * t1418 * t37 - 0.2074e4 / 0.243e3 * t25 * t1418 * t33 + 0.563e3 / 0.162e3 * t275 / t277 / t1425 * params->beta * t306 + 0.13e2 / 0.18e2 * t274 * sigma[0] * t698 * t729 + t704 * t1440 / 0.9e1 - t704 * t1483 / 0.18e2) - 0.3e1 / 0.8e1 * t5 * t1554 * t18 * t41;
  t1560 = my_piecewise3(t1, 0, t1559);
  t1563 = 0.48e2 * t50 * t327 * t51;
  t1565 = t124 * t745 * t128;
  t1568 = t325 * t751 * t329;
  t1570 = t319 * t319;
  t1571 = 0.1e1 / t1570;
  t1573 = t749 * t1571 * t754;
  t1577 = 0.1e1 / t1570 / t6;
  t1580 = 0.1e1 / t127 / t324 / t126;
  t1585 = my_piecewise3(t49, 0, t1563 + 0.64e2 * t1565 - 0.32e2 * t1568 + 0.320e3 / 0.27e2 * t1573 - 0.160e3 / 0.81e2 * t11 * t1067 * t1577 * t1580);
  t1592 = t5 * t759 * t100 * t72;
  t1596 = t5 * t334 * t254 * t72;
  t1600 = t5 * t133 * t676 * t72;
  t1605 = 0.10e2 / 0.27e2 * t5 * t55 * t1373 * t72;
  t1607 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t1585 * t18 * t72 - t1592 / 0.2e1 + t1596 / 0.2e1 - 0.5e1 / 0.9e1 * t1600 + t1605);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t737 + 0.4e1 * t777 + t6 * (t1560 + t1607);

  t1614 = t5 * t808 * t100 * t41;
  t1618 = t5 * t363 * t254 * t41;
  t1619 = t1618 / 0.4e1;
  t1622 = t5 * t151 * t676 * t41;
  t1631 = t5 * t813 * t114;
  t1637 = t5 * t820 * t114;
  t1638 = t1637 / 0.4e1;
  t1640 = t5 * t368 * t310;
  t1649 = t146 * t320 * t635 * t230;
  t1663 = t12 * t793;
  t1665 = t12 * t797;
  t1670 = t146 * t745 * t86;
  t1673 = t146 * t425 * t89;
  t1675 = -0.40e2 / 0.9e1 * t12 * t801 + 0.20e2 / 0.3e1 * t1649 + 0.160e3 / 0.81e2 * t146 * t126 * t1502 * t637 - 0.20e2 / 0.9e1 * t146 * t126 * t635 * t89 * t236 - 0.8e1 / 0.3e1 * t1491 - 0.20e2 / 0.27e2 * t1495 + 0.4e1 / 0.3e1 * t1498 - 0.48e2 * t1663 - 0.16e2 * t1665 + 0.8e1 / 0.3e1 * t12 * t804 + 0.40e2 * t1670 + 0.16e2 * t1673;
  t1677 = t146 * t796 * t236;
  t1689 = t839 * t86;
  t1693 = -0.4e1 * t1677 + 0.4e1 / 0.9e1 * t146 * t358 * t648 - 0.12e2 * t1520 + 0.4e1 * t1523 - 0.2e1 / 0.3e1 * t1526 + 0.4e1 / 0.3e1 * t1534 + t1543 - 0.36e2 * t1544 + 0.8e1 * t1546 - 0.2e1 * t1548 + 0.12e2 * t1689 + 0.8e1 / 0.3e1 * t381 * t642;
  t1695 = my_piecewise3(t10, 0, t1675 + t1693);
  t1706 = -0.3e1 / 0.8e1 * t1614 + t1619 - 0.5e1 / 0.36e2 * t1622 + t1377 - t1380 / 0.8e1 + t1384 / 0.4e1 - 0.5e1 / 0.12e2 * t1388 - 0.9e1 / 0.8e1 * t5 * t809 * t114 - 0.3e1 / 0.4e1 * t1631 - 0.9e1 / 0.8e1 * t5 * t364 * t310 + t1638 - 0.3e1 / 0.8e1 * t1640 - 0.3e1 / 0.8e1 * t5 * t152 * t732 - 0.3e1 / 0.8e1 * t5 * t1695 * t18 * t41 - 0.3e1 / 0.8e1 * t1394 + t1400 / 0.2e1 - 0.3e1 / 0.8e1 * t1402 - 0.5e1 / 0.12e2 * t1408 + t1411 / 0.4e1 - t1414 / 0.8e1;
  t1707 = my_piecewise3(t1, 0, t1706);
  t1709 = t50 * t321 * t162;
  t1712 = t124 * t851 * t396;
  t1716 = t325 * t745 * t754 * t162;
  t1719 = t50 * t386 * t868;
  t1732 = rho[1] * t327;
  t1733 = 0.24e2 * t1732;
  t1739 = t50 * t129 * t396;
  t1740 = 0.4e1 * t1739;
  t1742 = t124 * t330 * t162;
  t1747 = t839 * t51;
  t1749 = t842 * t382;
  t1752 = t11 * t745 * t843;
  t1758 = -0.4e1 * t1709 - 0.16e2 / 0.3e1 * t1712 - 0.20e2 / 0.3e1 * t1716 - 0.2e1 * t1719 + 0.20e2 / 0.9e1 * t325 * t858 * t396 + 0.160e3 / 0.81e2 * t749 * t751 * t1580 * t162 + 0.4e1 / 0.3e1 * t124 * t390 * t868 + 0.2e1 / 0.3e1 * t50 * t160 * (-0.6e1 * t320 + t1733) + t1740 + 0.8e1 * t1742 + t1563 + 0.24e2 * t1565 - 0.16e2 / 0.3e1 * t1568 + 0.20e2 / 0.27e2 * t1573 - 0.12e2 * t1747 - 0.12e2 * t1749 + 0.4e1 * t1752 - 0.20e2 / 0.27e2 * t11 * t751 * t754 * t324;
  t1759 = my_piecewise3(t49, 0, t1758);
  t1766 = t5 * t873 * t100 * t72;
  t1770 = t5 * t401 * t254 * t72;
  t1771 = t1770 / 0.4e1;
  t1774 = t5 * t167 * t676 * t72;
  t1783 = t5 * t764 * t180;
  t1786 = t5 * t768 * t180;
  t1787 = t1786 / 0.4e1;
  t1789 = t5 * t772 * t180;
  t1791 = -0.3e1 / 0.8e1 * t5 * t1759 * t18 * t72 - 0.3e1 / 0.8e1 * t1766 + t1771 - 0.5e1 / 0.36e2 * t1774 - t1592 / 0.8e1 + t1596 / 0.4e1 - 0.5e1 / 0.12e2 * t1600 + t1605 - 0.3e1 / 0.8e1 * t5 * t760 * t180 - 0.3e1 / 0.8e1 * t1783 + t1787 - 0.5e1 / 0.36e2 * t1789;
  t1792 = my_piecewise3(t46, 0, t1791);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t737 + t777 + 0.3e1 * t836 + 0.3e1 * t898 + t6 * (t1707 + t1792);

  t1801 = t5 * t916 * t100 * t41;
  t1805 = t5 * t429 * t254 * t41;
  t1820 = t146 * t908;
  t1825 = t424 * t751 * t228;
  t1829 = t424 * t745 * t635 * t89;
  t1844 = -0.160e3 / 0.81e2 * t424 * t327 * t1502 * t230 + 0.80e2 / 0.27e2 * t1649 - 0.8e1 / 0.9e1 * t1491 - 0.8e1 / 0.3e1 * t12 * t425 + 0.40e2 / 0.3e1 * t1820 + 0.40e2 / 0.9e1 * t146 * t912 - 0.40e2 / 0.3e1 * t1825 - 0.200e3 / 0.27e2 * t1829 + 0.20e2 / 0.27e2 * t424 * t911 * t236 - 0.128e3 / 0.3e1 * t1663 - 0.64e2 / 0.9e1 * t1665 + 0.160e3 / 0.3e1 * t1670 + 0.128e3 / 0.9e1 * t1673 - 0.16e2 / 0.9e1 * t1677 - 0.8e1 * t1520 + 0.4e1 / 0.3e1 * t1523 + t1543 - 0.24e2 * t1544 + 0.8e1 / 0.3e1 * t1546 + 0.16e2 / 0.3e1 * t1689;
  t1845 = my_piecewise3(t10, 0, t1844);
  t1854 = t5 * t921 * t114;
  t1865 = -t1801 / 0.4e1 + t1805 / 0.12e2 - t1614 / 0.4e1 + t1618 / 0.3e1 - 0.5e1 / 0.18e2 * t1622 + t1377 + t1384 / 0.12e2 - 0.5e1 / 0.18e2 * t1388 - 0.3e1 / 0.8e1 * t5 * t1845 * t18 * t41 - 0.3e1 / 0.4e1 * t5 * t917 * t114 - t1854 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t430 * t310 - t1631 / 0.2e1 + t1637 / 0.3e1 - t1640 / 0.4e1 + t1400 / 0.6e1 - 0.5e1 / 0.18e2 * t1408 + t1411 / 0.12e2;
  t1866 = my_piecewise3(t1, 0, t1865);
  t1867 = t50 * t81;
  t1868 = t1867 * t956;
  t1870 = t124 * t126;
  t1871 = t754 * t162;
  t1878 = t396 * t396;
  t1883 = t50 * t129 * t448;
  t1890 = t839 * t938;
  t1892 = t329 * t396;
  t1901 = t124 * t320 * t754 * t443;
  t1908 = t50 * t386 * t966;
  t1911 = t124 * t851 * t448;
  t1919 = 0.16e2 / 0.9e1 * t1868 - 0.80e2 / 0.27e2 * t1870 * t1871 * t396 - 0.8e1 / 0.9e1 * t955 * t937 * t868 - 0.8e1 / 0.9e1 * t50 * t442 * t1878 + 0.4e1 / 0.3e1 * t1883 + 0.2e1 / 0.3e1 * t50 * t160 * (-0.12e2 * t320 + t1733) - 0.32e2 / 0.9e1 * t1890 + 0.16e2 / 0.9e1 * t381 * t1892 * rho[1] + 0.40e2 / 0.27e2 * t842 * t1871 * t123 + 0.80e2 / 0.27e2 * t1901 - 0.160e3 / 0.81e2 * t325 * t327 * t1580 * t443 - 0.4e1 / 0.3e1 * t1908 - 0.16e2 / 0.9e1 * t1911 + 0.8e1 / 0.9e1 * t124 * t390 * t966 + 0.20e2 / 0.27e2 * t325 * t858 * t448;
  t1921 = t50 * t390 * t443;
  t1934 = t381 * t438;
  t1936 = t214 * t941;
  t1941 = -0.8e1 / 0.9e1 * t1921 - 0.8e1 * t1709 - 0.16e2 / 0.9e1 * t1712 - 0.40e2 / 0.27e2 * t1716 - 0.4e1 / 0.3e1 * t1719 + 0.16e2 / 0.3e1 * t1739 + 0.16e2 / 0.3e1 * t1742 - 0.24e2 * t1747 + t1563 + 0.32e2 / 0.3e1 * t1565 - 0.8e1 / 0.9e1 * t1568 - 0.8e1 * t1749 + 0.8e1 / 0.9e1 * t1752 + 0.8e1 / 0.3e1 * t1934 - 0.8e1 / 0.3e1 * t1936 + 0.4e1 / 0.3e1 * t77 * t128 * t868;
  t1943 = my_piecewise3(t49, 0, t1919 + t1941);
  t1950 = t5 * t971 * t100 * t72;
  t1954 = t5 * t453 * t254 * t72;
  t1963 = t5 * t878 * t180;
  t1966 = t5 * t882 * t180;
  t1977 = t5 * t339 * t502;
  t1980 = t5 * t343 * t502;
  t1982 = -0.3e1 / 0.8e1 * t5 * t1943 * t18 * t72 - t1950 / 0.4e1 + t1954 / 0.12e2 - t1766 / 0.4e1 + t1770 / 0.3e1 - 0.5e1 / 0.18e2 * t1774 - 0.3e1 / 0.4e1 * t5 * t874 * t180 - t1963 / 0.2e1 + t1966 / 0.6e1 + t1596 / 0.12e2 - 0.5e1 / 0.18e2 * t1600 + t1605 - t1783 / 0.4e1 + t1786 / 0.3e1 - 0.5e1 / 0.18e2 * t1789 - 0.3e1 / 0.8e1 * t5 * t335 * t502 - t1977 / 0.4e1 + t1980 / 0.12e2;
  t1983 = my_piecewise3(t46, 0, t1982);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t836 + 0.2e1 * t898 + 0.2e1 * t932 + 0.2e1 * t996 + t6 * (t1866 + t1983);

  t1999 = t1003 * t1571 * t635;
  t2005 = -0.12e2 * t1544 + t1543 - 0.4e1 * t1520 - 0.24e2 * t1663 + 0.60e2 * t1670 + 0.8e1 * t1673 + 0.12e2 * t1820 - 0.24e2 * t1825 - 0.20e2 / 0.3e1 * t1829 - 0.80e2 / 0.27e2 * t424 * t1004 + 0.140e3 / 0.27e2 * t1999 + 0.160e3 / 0.81e2 * t1003 * t751 * t1502 * t89;
  t2006 = my_piecewise3(t10, 0, t2005);
  t2013 = t5 * t1008 * t100 * t41;
  t2024 = -0.3e1 / 0.8e1 * t5 * t2006 * t18 * t41 - t2013 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1009 * t114 - 0.3e1 / 0.8e1 * t1801 + t1805 / 0.4e1 - 0.3e1 / 0.8e1 * t1854 + t1619 - 0.5e1 / 0.12e2 * t1622 + t1638 - 0.5e1 / 0.36e2 * t1388 + t1377 - 0.5e1 / 0.36e2 * t1408;
  t2025 = my_piecewise3(t1, 0, t2024);
  t2028 = t50 * t81 * t754 * t1029;
  t2031 = t50 * t386 * t1037;
  t2051 = t754 * t443;
  t2067 = t1867 * t1033;
  t2072 = -0.20e2 / 0.27e2 * t2028 - 0.2e1 / 0.3e1 * t2031 + 0.4e1 / 0.3e1 * t381 * t329 * t448 * rho[1] + 0.160e3 / 0.81e2 * t124 * t126 * t1580 * t1029 + 0.2e1 / 0.3e1 * t50 * t160 * (-0.18e2 * t320 + t1733) + 0.4e1 / 0.9e1 * t124 * t390 * t1037 - 0.8e1 / 0.3e1 * t77 * t956 - 0.20e2 / 0.9e1 * t381 * t2051 * rho[1] + 0.20e2 / 0.9e1 * t955 * t2051 * t396 - 0.4e1 / 0.3e1 * t955 * t1892 * t448 - 0.4e1 / 0.3e1 * t955 * t937 * t966 - 0.20e2 / 0.9e1 * t1870 * t1871 * t448 + 0.4e1 / 0.3e1 * t2067 + 0.8e1 / 0.3e1 * t1868 + 0.4e1 * t1883 - 0.8e1 / 0.3e1 * t1890;
  t2080 = t214 * t1019;
  t2082 = t214 * t1022;
  t2091 = 0.20e2 / 0.9e1 * t1901 - 0.2e1 * t1908 - 0.4e1 / 0.3e1 * t1911 - 0.8e1 / 0.3e1 * t1921 - 0.12e2 * t1709 + t1740 + 0.8e1 / 0.3e1 * t1742 - 0.36e2 * t1747 + 0.4e1 / 0.3e1 * t2080 - 0.2e1 * t2082 + 0.2e1 * t77 * t128 * t966 + t1563 + 0.4e1 * t1565 - 0.4e1 * t1749 + 0.8e1 * t1934 - 0.4e1 * t1936;
  t2093 = my_piecewise3(t49, 0, t2072 + t2091);
  t2100 = t5 * t1042 * t100 * t72;
  t2108 = t5 * t976 * t180;
  t2117 = t5 * t406 * t502;
  t2127 = t5 * t138 * t1102;
  t2129 = -0.3e1 / 0.8e1 * t5 * t2093 * t18 * t72 - t2100 / 0.8e1 - 0.3e1 / 0.8e1 * t1950 + t1954 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t972 * t180 - 0.3e1 / 0.8e1 * t2108 + t1771 - 0.5e1 / 0.12e2 * t1774 - 0.3e1 / 0.4e1 * t1963 + t1966 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t402 * t502 - 0.3e1 / 0.8e1 * t2117 - 0.5e1 / 0.36e2 * t1600 + t1605 + t1787 - 0.5e1 / 0.12e2 * t1789 - 0.3e1 / 0.8e1 * t1977 + t1980 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t134 * t1102 - t2127 / 0.8e1;
  t2130 = my_piecewise3(t46, 0, t2129);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t932 + 0.3e1 * t996 + t1016 + t1107 + t6 * (t2025 + t2130);

  t2143 = my_piecewise3(t10, 0, t1543 + 0.64e2 * t1670 - 0.32e2 * t1825 + 0.320e3 / 0.27e2 * t1999 - 0.160e3 / 0.81e2 * t11 * t696 * t1577 * t1502);
  t2152 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2143 * t18 * t41 - t2013 / 0.2e1 + t1805 / 0.2e1 - 0.5e1 / 0.9e1 * t1622 + t1377);
  t2168 = 0.1e1 / t58 / t1067;
  t2169 = t57 * t2168;
  t2176 = t473 * t123;
  t2188 = 0.1e1 / t1076 / t496;
  t2189 = t1097 * t1097;
  t2191 = t281 * t2188 * t2189;
  t2206 = 0.1e1 / t488 / t487 * t11;
  t2207 = t2206 * t21;
  t2223 = t1091 * t1091;
  t2224 = t490 * t490;
  t2225 = 0.1e1 / t2224;
  t2232 = t281 * t1077 * (0.7e1 / 0.9e1 * t282 * t478 * t464 * t491 - 0.2e1 / 0.3e1 * t711 * t174 * t1093 + t711 * t61 * (0.7e1 / 0.27e2 * t284 * t478 * t464 - 0.32e2 / 0.3e1 * t2207 * t1458 * t1331 / t58 / t473 / t324 + 0.22e2 / 0.9e1 * t1087 * t481 * t476) * t1092 / 0.4e1 - t711 * t61 * t2223 * t2225 / 0.4e1);
  t2240 = t443 * t443;
  t2247 = t448 * t448;
  t2277 = -0.160e3 / 0.81e2 * t50 * t7 * t1580 * t2240 + 0.40e2 / 0.9e1 * t955 * t2051 * t448 - 0.4e1 / 0.3e1 * t50 * t442 * t2247 - 0.16e2 / 0.9e1 * t955 * t937 * t1037 - 0.80e2 / 0.27e2 * t2028 - 0.8e1 / 0.3e1 * t2031 - 0.16e2 / 0.3e1 * t1921 + 0.8e1 * t1883 - 0.16e2 * t1709 + 0.80e2 / 0.27e2 * t77 * t754 * t1029 - 0.16e2 / 0.3e1 * t77 * t1033 + 0.2e1 / 0.3e1 * t50 * t160 * (-0.24e2 * t320 + 0.24e2 * t1732) + 0.16e2 / 0.3e1 * t2080 - 0.8e1 * t2082 + 0.16e2 * t1934 + t1563 + 0.16e2 / 0.3e1 * t2067 - 0.48e2 * t1747 + 0.8e1 / 0.3e1 * t77 * t128 * t1037;
  t2278 = my_piecewise3(t49, 0, t2277);
  t2286 = -t2100 / 0.2e1 - 0.3e1 / 0.2e1 * t2108 - 0.3e1 / 0.2e1 * t2117 - t2127 / 0.2e1 + t1954 / 0.2e1 + t1966 + t1980 / 0.2e1 - 0.5e1 / 0.9e1 * t1774 - 0.5e1 / 0.9e1 * t1789 + t1605 - 0.9e1 / 0.4e1 * t5 * t454 * t502 - 0.3e1 / 0.2e1 * t5 * t168 * t1102 - 0.3e1 / 0.8e1 * t5 * t56 * (-0.910e3 / 0.243e3 * t25 * t2169 * t68 - 0.2074e4 / 0.243e3 * t25 * t2169 * t64 + 0.563e3 / 0.162e3 * t472 / t474 / t2176 * params->beta * t498 + 0.13e2 / 0.18e2 * t274 * sigma[2] * t1069 * t1099 + t1075 * t2191 / 0.9e1 - t1075 * t2232 / 0.18e2) - 0.3e1 / 0.8e1 * t5 * t2278 * t18 * t72 - 0.3e1 / 0.2e1 * t5 * t1043 * t180;
  t2287 = my_piecewise3(t46, 0, t2286);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t1016 + 0.4e1 * t1107 + t6 * (t2152 + t2287);

  t2295 = t5 * t658 * t195;
  t2301 = t5 * t665 * t195;
  t2304 = t5 * t246 * t529;
  t2311 = 0.5e1 / 0.36e2 * t5 * t677 * t195;
  t2313 = t5 * t255 * t529;
  t2316 = t5 * t101 * t1138;
  t2318 = t188 * t688;
  t2339 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t654 * t195 - 0.3e1 / 0.8e1 * t2295 - 0.9e1 / 0.8e1 * t5 * t242 * t529 + t2301 / 0.4e1 - 0.3e1 / 0.4e1 * t2304 - 0.9e1 / 0.8e1 * t5 * t95 * t1138 - t2311 + t2313 / 0.4e1 - 0.3e1 / 0.8e1 * t2316 - 0.3e1 / 0.8e1 * t5 * t19 * (0.35e2 / 0.81e2 * t25 * t2318 * t37 + 0.104e3 / 0.81e2 * t25 * t2318 * t33 - 0.169e3 / 0.216e3 * t274 * t698 * t526 - 0.5e1 / 0.24e2 * t1133 * t729 - t525 * t1440 / 0.24e2 + t525 * t1483 / 0.48e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t2339 * t6 + 0.3e1 * t1143;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  t2346 = t5 * t764 * t207;
  t2349 = t5 * t768 * t207;
  t2353 = 0.5e1 / 0.36e2 * t5 * t772 * t207;
  t2355 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t760 * t207 - 0.3e1 / 0.8e1 * t2346 + t2349 / 0.4e1 - t2353);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t2355 * t6 + 0.3e1 * t1156;

  t2357 = 0.2e1 * t1170;
  t2363 = t5 * t813 * t195 / 0.4e1;
  t2368 = t5 * t820 * t195;
  t2372 = t5 * t368 * t529 / 0.4e1;
  t2381 = -0.3e1 / 0.8e1 * t5 * t809 * t195 - t2363 - 0.3e1 / 0.4e1 * t5 * t364 * t529 + t2368 / 0.12e2 - t2372 - 0.3e1 / 0.8e1 * t5 * t152 * t1138 - t2295 / 0.8e1 + t2301 / 0.6e1 - t2304 / 0.4e1 - t2311 + t2313 / 0.6e1 - t2316 / 0.8e1;
  t2382 = my_piecewise3(t1, 0, t2381);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t2382 * t6 + t1143 + t2357;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  t2384 = 0.2e1 * t1186;
  t2390 = t5 * t878 * t207 / 0.4e1;
  t2392 = t5 * t882 * t207;
  t2401 = t5 * t339 * t567 / 0.4e1;
  t2403 = t5 * t343 * t567;
  t2406 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t874 * t207 - t2390 + t2392 / 0.12e2 - t2346 / 0.8e1 + t2349 / 0.6e1 - t2353 - 0.3e1 / 0.8e1 * t5 * t335 * t567 - t2401 + t2403 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t2406 * t6 + t1156 + t2384;

  t2412 = t5 * t921 * t195;
  t2421 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t917 * t195 - t2412 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t430 * t529 - t2363 + t2368 / 0.6e1 - t2372 + t2301 / 0.12e2 - t2311 + t2313 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t2421 * t6 + t1194 + t2357;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  t2427 = t5 * t976 * t207;
  t2434 = t5 * t406 * t567;
  t2442 = t5 * t138 * t1217;
  t2444 = -0.3e1 / 0.8e1 * t5 * t972 * t207 - t2427 / 0.8e1 - t2390 + t2392 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t402 * t567 - t2434 / 0.4e1 + t2349 / 0.12e2 - t2353 - t2401 + t2403 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t134 * t1217 - t2442 / 0.8e1;
  t2445 = my_piecewise3(t46, 0, t2444);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t2445 * t6 + t1222 + t2384;

  t2454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1009 * t195 - 0.3e1 / 0.8e1 * t2412 + t2368 / 0.4e1 - t2311);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t2454 * t6 + 0.3e1 * t1194;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  t2471 = t200 * t1059;
  t2492 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t1043 * t207 - 0.3e1 / 0.8e1 * t2427 - 0.9e1 / 0.8e1 * t5 * t454 * t567 + t2392 / 0.4e1 - 0.3e1 / 0.4e1 * t2434 - 0.9e1 / 0.8e1 * t5 * t168 * t1217 - t2353 + t2403 / 0.4e1 - 0.3e1 / 0.8e1 * t2442 - 0.3e1 / 0.8e1 * t5 * t56 * (0.35e2 / 0.81e2 * t25 * t2471 * t68 + 0.104e3 / 0.81e2 * t25 * t2471 * t64 - 0.169e3 / 0.216e3 * t274 * t1069 * t564 - 0.5e1 / 0.24e2 * t1212 * t1099 - t563 * t2191 / 0.24e2 + t563 * t2232 / 0.48e2));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = t2492 * t6 + 0.3e1 * t1222;

  t2499 = t5 * t246 * t586;
  t2506 = t5 * t255 * t586 / 0.12e2;
  t2508 = t5 * t101 * t1245;
  t2510 = t575 * t264;
  t2520 = t274 * t580 * t524;
  t2532 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t242 * t586 - t2499 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t95 * t1245 + t2506 - t2508 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * (0.7e1 / 0.108e3 * t25 * t2510 * t37 + 0.11e2 / 0.108e3 * t25 * t2510 * t33 + t581 * t307 / 0.16e2 + t2520 * t729 / 0.24e2 + t1242 * t1440 / 0.64e2 - t1242 * t1483 / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = t2532 * t6 + 0.2e1 * t1250;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  t2539 = t5 * t339 * t603;
  t2543 = t5 * t343 * t603 / 0.12e2;
  t2545 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t335 * t603 - t2539 / 0.4e1 + t2543);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = t2545 * t6 + 0.2e1 * t1259;

  t2551 = t5 * t368 * t586;
  t2559 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t364 * t586 - t2551 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t1245 - t2499 / 0.8e1 + t2506 - t2508 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t2559 * t6 + t1250 + t1265;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t2565 = t5 * t406 * t603;
  t2572 = t5 * t138 * t1285;
  t2575 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t402 * t603 - t2565 / 0.8e1 - t2539 / 0.8e1 + t2543 - 0.3e1 / 0.8e1 * t5 * t134 * t1285 - t2572 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = t2575 * t6 + t1259 + t1290;

  t2583 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t430 * t586 - t2551 / 0.4e1 + t2506);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = t2583 * t6 + 0.2e1 * t1265;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t2594 = t592 * t464;
  t2604 = t274 * t597 * t562;
  t2616 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t454 * t603 - t2565 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t168 * t1285 + t2543 - t2572 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t56 * (0.7e1 / 0.108e3 * t25 * t2594 * t68 + 0.11e2 / 0.108e3 * t25 * t2594 * t64 + t598 * t499 / 0.16e2 + t2604 * t1099 / 0.24e2 + t1282 * t2191 / 0.64e2 - t1282 * t2232 / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = t2616 * t6 + 0.2e1 * t1290;

  t2623 = t5 * t101 * t1326 / 0.8e1;
  t2624 = t1294 * t107;
  t2634 = t274 * t1302 * t291;
  t2684 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t95 * t1326 - t2623 - 0.3e1 / 0.8e1 * t5 * t19 * (t25 * t2624 * t37 / 0.24e2 + t25 * t2624 * t33 / 0.36e2 + 0.5e1 / 0.192e3 * t1303 * t1238 + t2634 * t729 / 0.128e3 + t2520 * t1323 / 0.48e2 + t1242 * t281 * t1437 * t1321 * t727 / 0.64e2 - t1242 * t281 * t706 * (-t282 * t1306 * t707 / 0.6e1 + t711 * t189 * t723 / 0.8e1 - t711 * t108 * t1317 / 0.3e1 + t711 * t30 * (-t284 * t1306 * t107 / 0.18e2 + 0.4e1 * t1456 * t1458 / t27 / t1425 * sigma[0] - 0.2e1 / 0.3e1 * t716 * t525) * t722 / 0.4e1 - t711 * t30 * t1316 * t1476 * t721 / 0.4e1) / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t2684 * t6 + t1330;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  t2691 = t5 * t138 * t1365 / 0.8e1;
  t2693 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t134 * t1365 - t2691);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t2693 * t6 + t1369;

  t2699 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t152 * t1326 - t2623);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t2699 * t6 + t1330;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t2704 = t1333 * t173;
  t2714 = t274 * t1341 * t483;
  t2764 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t168 * t1365 - t2691 - 0.3e1 / 0.8e1 * t5 * t56 * (t25 * t2704 * t68 / 0.24e2 + t25 * t2704 * t64 / 0.36e2 + 0.5e1 / 0.192e3 * t1342 * t1278 + t2714 * t1099 / 0.128e3 + t2604 * t1362 / 0.48e2 + t1282 * t281 * t2188 * t1360 * t1097 / 0.64e2 - t1282 * t281 * t1077 * (-t282 * t1345 * t1078 / 0.6e1 + t711 * t201 * t1093 / 0.8e1 - t711 * t174 * t1356 / 0.3e1 + t711 * t61 * (-t284 * t1345 * t173 / 0.18e2 + 0.4e1 * t2207 * t1458 / t58 / t2176 * sigma[2] - 0.2e1 / 0.3e1 * t1086 * t563) * t1092 / 0.4e1 - t711 * t61 * t1355 * t2225 * t1091 / 0.4e1) / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t2764 * t6 + t1369;

  t2766 = t1292 * sigma[0];
  t2769 = 0.1e1 / t26 / t2766 * t29;
  t2782 = t1321 * t1321;
  t2787 = t24 * t575;
  t2797 = t21 * t1458;
  t2806 = t1316 * t1316;
  t2820 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * (0.5e1 / 0.64e2 * t25 * t2769 * t37 - t25 * t2769 * t33 / 0.24e2 + 0.7e1 / 0.512e3 * t274 / t2766 * t583 + t2634 * t1323 / 0.64e2 + t1242 * t281 * t1437 * t2782 / 0.64e2 - t1242 * t281 * t706 * (-t282 * t2787 * t300 / 0.16e2 + t711 * t189 * t1317 / 0.4e1 + t711 * t30 * (-t284 * t2787 * t29 / 0.48e2 - 0.3e1 / 0.2e1 * t1455 * t2797 * t1417) * t722 / 0.4e1 - t711 * t30 * t2806 * t1476 / 0.4e1) / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = t6 * t2820;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t2821 = t1331 * sigma[2];
  t2824 = 0.1e1 / t57 / t2821 * t60;
  t2837 = t1360 * t1360;
  t2842 = t24 * t592;
  t2860 = t1355 * t1355;
  t2874 = my_piecewise3(t46, 0, -0.3e1 / 0.8e1 * t5 * t56 * (0.5e1 / 0.64e2 * t25 * t2824 * t68 - t25 * t2824 * t64 / 0.24e2 + 0.7e1 / 0.512e3 * t274 / t2821 * t600 + t2714 * t1362 / 0.64e2 + t1282 * t281 * t2188 * t2837 / 0.64e2 - t1282 * t281 * t1077 * (-t282 * t2842 * t492 / 0.16e2 + t711 * t201 * t1356 / 0.4e1 + t711 * t61 * (-t284 * t2842 * t60 / 0.48e2 - 0.3e1 / 0.2e1 * t2206 * t2797 * t2168) * t1092 / 0.4e1 - t711 * t61 * t2860 * t2225 / 0.4e1) / 0.128e3));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = t6 * t2874;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

