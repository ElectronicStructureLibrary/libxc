/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : lda_k_gds08_worker.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t7, t8, t10;
  double t11, t12, t13, t16, t19, t20, t21, t23;
  double t25, t27, t30, t31, t32, t33, t34, t35;
  double t37, t39, t41, t44, tzk0;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = rho[0] - rho[1];
  t3 = rho[0] + rho[1];
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t7 = 0.1e1 + t5 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = 0.1e1 - t5 <= p->zeta_threshold;
  t11 = -t8;
  t12 = my_piecewise5(t7, t8, t10, t11, t5);
  t13 = 0.1e1 + t12;
  t16 = 0.2e1 * rho[0] * t4 <= p->zeta_threshold;
  t19 = 0.2e1 * rho[1] * t4 <= p->zeta_threshold;
  t20 = my_piecewise5(t16, t8, t19, t11, t5);
  t21 = 0.1e1 + t20;
  t23 = log(t21 * t3);
  t25 = t23 * t23;
  t27 = t23 * params->B + t25 * params->C + params->A;
  t30 = my_piecewise3(t1, 0, t13 * t27 / 0.2e1);
  t31 = rho[1] <= p->dens_threshold;
  t32 = my_piecewise5(t10, t8, t7, t11, -t5);
  t33 = 0.1e1 + t32;
  t34 = my_piecewise5(t19, t8, t16, t11, -t5);
  t35 = 0.1e1 + t34;
  t37 = log(t35 * t3);
  t39 = t37 * t37;
  t41 = t37 * params->B + t39 * params->C + params->A;
  t44 = my_piecewise3(t31, 0, t33 * t41 / 0.2e1);
  tzk0 = t30 + t44;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t7, t8, t10;
  double t11, t12, t13, t16, t19, t20, t21, t23;
  double t25, t27, t30, t31, t32, t33, t34, t35;
  double t37, t39, t41, t44, tzk0;

  double t45, t46, t47, t48, t49, t51, t53, t54;
  double t55, t56, t58, t59, t63, t67, t68, t69;
  double t71, t73, t74, t75, t76, t78, t79, t83;
  double t87, tvrho0, t90, t91, t93, t95, t96, t98;
  double t102, t106, t107, t108, t110, t112, t113, t115;
  double t119, t123, tvrho1;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = rho[0] - rho[1];
  t3 = rho[0] + rho[1];
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t7 = 0.1e1 + t5 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = 0.1e1 - t5 <= p->zeta_threshold;
  t11 = -t8;
  t12 = my_piecewise5(t7, t8, t10, t11, t5);
  t13 = 0.1e1 + t12;
  t16 = 0.2e1 * rho[0] * t4 <= p->zeta_threshold;
  t19 = 0.2e1 * rho[1] * t4 <= p->zeta_threshold;
  t20 = my_piecewise5(t16, t8, t19, t11, t5);
  t21 = 0.1e1 + t20;
  t23 = log(t21 * t3);
  t25 = t23 * t23;
  t27 = t23 * params->B + t25 * params->C + params->A;
  t30 = my_piecewise3(t1, 0, t13 * t27 / 0.2e1);
  t31 = rho[1] <= p->dens_threshold;
  t32 = my_piecewise5(t10, t8, t7, t11, -t5);
  t33 = 0.1e1 + t32;
  t34 = my_piecewise5(t19, t8, t16, t11, -t5);
  t35 = 0.1e1 + t34;
  t37 = log(t35 * t3);
  t39 = t37 * t37;
  t41 = t37 * params->B + t39 * params->C + params->A;
  t44 = my_piecewise3(t31, 0, t33 * t41 / 0.2e1);
  tzk0 = t30 + t44;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t45 = t3 * t3;
  t46 = 0.1e1 / t45;
  t47 = t2 * t46;
  t48 = t4 - t47;
  t49 = my_piecewise5(t7, 0, t10, 0, t48);
  t51 = my_piecewise5(t16, 0, t19, 0, t48);
  t53 = t3 * t51 + t20 + 0.1e1;
  t54 = params->B * t53;
  t55 = 0.1e1 / t21;
  t56 = t55 * t4;
  t58 = params->C * t23;
  t59 = t53 * t55;
  t63 = 0.2e1 * t4 * t58 * t59 + t54 * t56;
  t67 = my_piecewise3(t1, 0, t13 * t63 / 0.2e1 + t49 * t27 / 0.2e1);
  t68 = -t48;
  t69 = my_piecewise5(t10, 0, t7, 0, t68);
  t71 = my_piecewise5(t19, 0, t16, 0, t68);
  t73 = t3 * t71 + t34 + 0.1e1;
  t74 = params->B * t73;
  t75 = 0.1e1 / t35;
  t76 = t75 * t4;
  t78 = params->C * t37;
  t79 = t73 * t75;
  t83 = 0.2e1 * t4 * t78 * t79 + t74 * t76;
  t87 = my_piecewise3(t31, 0, t33 * t83 / 0.2e1 + t69 * t41 / 0.2e1);
  tvrho0 = t30 + t44 + t3 * (t67 + t87);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = -t4 - t47;
  t91 = my_piecewise5(t7, 0, t10, 0, t90);
  t93 = my_piecewise5(t16, 0, t19, 0, t90);
  t95 = t3 * t93 + t20 + 0.1e1;
  t96 = params->B * t95;
  t98 = t95 * t55;
  t102 = 0.2e1 * t4 * t58 * t98 + t56 * t96;
  t106 = my_piecewise3(t1, 0, t13 * t102 / 0.2e1 + t91 * t27 / 0.2e1);
  t107 = -t90;
  t108 = my_piecewise5(t10, 0, t7, 0, t107);
  t110 = my_piecewise5(t19, 0, t16, 0, t107);
  t112 = t110 * t3 + t34 + 0.1e1;
  t113 = params->B * t112;
  t115 = t112 * t75;
  t119 = 0.2e1 * t115 * t4 * t78 + t113 * t76;
  t123 = my_piecewise3(t31, 0, t108 * t41 / 0.2e1 + t33 * t119 / 0.2e1);
  tvrho1 = t30 + t44 + t3 * (t106 + t123);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t7, t8, t10;
  double t11, t12, t13, t16, t19, t20, t21, t23;
  double t25, t27, t30, t31, t32, t33, t34, t35;
  double t37, t39, t41, t44, tzk0;

  double t45, t46, t47, t48, t49, t51, t53, t54;
  double t55, t56, t58, t59, t63, t67, t68, t69;
  double t71, t73, t74, t75, t76, t78, t79, t83;
  double t87, tvrho0, t90, t91, t93, t95, t96, t98;
  double t102, t106, t107, t108, t110, t112, t113, t115;
  double t119, t123, tvrho1;

  double t129, t130, t132, t133, t137, t140, t141, t143;
  double t144, t145, t146, t148, t150, t151, t152, t155;
  double t159, t165, t169, t170, t171, t175, t178, t179;
  double t181, t182, t183, t184, t186, t188, t189, t190;
  double t193, t197, t203, t207, tv2rho20, t210, t211, t215;
  double t217, t218, t221, t222, t223, t226, t230, t235;
  double t236, t240, t241, t245, t247, t248, t251, t252;
  double t253, t256, t260, t265, t266, t270, tv2rho21, t276;
  double t277, t281, t284, t285, t287, t289, t290, t293;
  double t299, t303, t304, t305, t309, t312, t313, t315;
  double t317, t318, t321, t327, t331, tv2rho22;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = rho[0] - rho[1];
  t3 = rho[0] + rho[1];
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t7 = 0.1e1 + t5 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = 0.1e1 - t5 <= p->zeta_threshold;
  t11 = -t8;
  t12 = my_piecewise5(t7, t8, t10, t11, t5);
  t13 = 0.1e1 + t12;
  t16 = 0.2e1 * rho[0] * t4 <= p->zeta_threshold;
  t19 = 0.2e1 * rho[1] * t4 <= p->zeta_threshold;
  t20 = my_piecewise5(t16, t8, t19, t11, t5);
  t21 = 0.1e1 + t20;
  t23 = log(t21 * t3);
  t25 = t23 * t23;
  t27 = t23 * params->B + t25 * params->C + params->A;
  t30 = my_piecewise3(t1, 0, t13 * t27 / 0.2e1);
  t31 = rho[1] <= p->dens_threshold;
  t32 = my_piecewise5(t10, t8, t7, t11, -t5);
  t33 = 0.1e1 + t32;
  t34 = my_piecewise5(t19, t8, t16, t11, -t5);
  t35 = 0.1e1 + t34;
  t37 = log(t35 * t3);
  t39 = t37 * t37;
  t41 = t37 * params->B + t39 * params->C + params->A;
  t44 = my_piecewise3(t31, 0, t33 * t41 / 0.2e1);
  tzk0 = t30 + t44;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t45 = t3 * t3;
  t46 = 0.1e1 / t45;
  t47 = t2 * t46;
  t48 = t4 - t47;
  t49 = my_piecewise5(t7, 0, t10, 0, t48);
  t51 = my_piecewise5(t16, 0, t19, 0, t48);
  t53 = t3 * t51 + t20 + 0.1e1;
  t54 = params->B * t53;
  t55 = 0.1e1 / t21;
  t56 = t55 * t4;
  t58 = params->C * t23;
  t59 = t53 * t55;
  t63 = 0.2e1 * t4 * t58 * t59 + t54 * t56;
  t67 = my_piecewise3(t1, 0, t13 * t63 / 0.2e1 + t49 * t27 / 0.2e1);
  t68 = -t48;
  t69 = my_piecewise5(t10, 0, t7, 0, t68);
  t71 = my_piecewise5(t19, 0, t16, 0, t68);
  t73 = t3 * t71 + t34 + 0.1e1;
  t74 = params->B * t73;
  t75 = 0.1e1 / t35;
  t76 = t75 * t4;
  t78 = params->C * t37;
  t79 = t73 * t75;
  t83 = 0.2e1 * t4 * t78 * t79 + t74 * t76;
  t87 = my_piecewise3(t31, 0, t33 * t83 / 0.2e1 + t69 * t41 / 0.2e1);
  tvrho0 = t30 + t44 + t3 * (t67 + t87);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = -t4 - t47;
  t91 = my_piecewise5(t7, 0, t10, 0, t90);
  t93 = my_piecewise5(t16, 0, t19, 0, t90);
  t95 = t3 * t93 + t20 + 0.1e1;
  t96 = params->B * t95;
  t98 = t95 * t55;
  t102 = 0.2e1 * t4 * t58 * t98 + t56 * t96;
  t106 = my_piecewise3(t1, 0, t13 * t102 / 0.2e1 + t91 * t27 / 0.2e1);
  t107 = -t90;
  t108 = my_piecewise5(t10, 0, t7, 0, t107);
  t110 = my_piecewise5(t19, 0, t16, 0, t107);
  t112 = t110 * t3 + t34 + 0.1e1;
  t113 = params->B * t112;
  t115 = t112 * t75;
  t119 = 0.2e1 * t115 * t4 * t78 + t113 * t76;
  t123 = my_piecewise3(t31, 0, t108 * t41 / 0.2e1 + t33 * t119 / 0.2e1);
  tvrho1 = t30 + t44 + t3 * (t106 + t123);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t129 = 0.1e1 / t45 / t3;
  t130 = t2 * t129;
  t132 = -0.2e1 * t46 + 0.2e1 * t130;
  t133 = my_piecewise5(t7, 0, t10, 0, t132);
  t137 = my_piecewise5(t16, 0, t19, 0, t132);
  t140 = t137 * t3 + 0.2e1 * t51;
  t141 = params->B * t140;
  t143 = t21 * t21;
  t144 = 0.1e1 / t143;
  t145 = t144 * t4;
  t146 = t145 * t51;
  t148 = t55 * t46;
  t150 = t53 * t53;
  t151 = params->C * t150;
  t152 = t144 * t46;
  t155 = t140 * t55;
  t159 = t58 * t53;
  t165 = 0.2e1 * t155 * t4 * t58 - 0.2e1 * t46 * t58 * t59 + t141 * t56 - 0.2e1 * t146 * t159 - t146 * t54 - t148 * t54 + 0.2e1 * t151 * t152;
  t169 = my_piecewise3(t1, 0, t133 * t27 / 0.2e1 + t49 * t63 + t13 * t165 / 0.2e1);
  t170 = -t132;
  t171 = my_piecewise5(t10, 0, t7, 0, t170);
  t175 = my_piecewise5(t19, 0, t16, 0, t170);
  t178 = t175 * t3 + 0.2e1 * t71;
  t179 = params->B * t178;
  t181 = t35 * t35;
  t182 = 0.1e1 / t181;
  t183 = t182 * t4;
  t184 = t183 * t71;
  t186 = t75 * t46;
  t188 = t73 * t73;
  t189 = params->C * t188;
  t190 = t182 * t46;
  t193 = t178 * t75;
  t197 = t78 * t73;
  t203 = 0.2e1 * t193 * t4 * t78 - 0.2e1 * t46 * t78 * t79 + t179 * t76 - 0.2e1 * t184 * t197 - t184 * t74 - t186 * t74 + 0.2e1 * t189 * t190;
  t207 = my_piecewise3(t31, 0, t171 * t41 / 0.2e1 + t69 * t83 + t33 * t203 / 0.2e1);
  tv2rho20 = 0.2e1 * t67 + 0.2e1 * t87 + t3 * (t169 + t207);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t210 = 0.2e1 * t130;
  t211 = my_piecewise5(t7, 0, t10, 0, t210);
  t215 = my_piecewise5(t16, 0, t19, 0, t210);
  t217 = t215 * t3 + t51 + t93;
  t218 = params->B * t217;
  t221 = t96 * t148;
  t222 = params->C * t53;
  t223 = t152 * t95;
  t226 = t217 * t55;
  t230 = t58 * t95;
  t235 = 0.2e1 * t58 * t98 * t46;
  t236 = 0.2e1 * t226 * t4 * t58 - 0.2e1 * t146 * t230 - t146 * t96 + t218 * t56 + 0.2e1 * t222 * t223 - t221 - t235;
  t240 = my_piecewise3(t1, 0, t49 * t102 / 0.2e1 + t13 * t236 / 0.2e1 + t211 * t27 / 0.2e1 + t91 * t63 / 0.2e1);
  t241 = my_piecewise5(t10, 0, t7, 0, -t210);
  t245 = my_piecewise5(t19, 0, t16, 0, -t210);
  t247 = t245 * t3 + t110 + t71;
  t248 = params->B * t247;
  t251 = t113 * t186;
  t252 = params->C * t73;
  t253 = t190 * t112;
  t256 = t247 * t75;
  t260 = t78 * t112;
  t265 = 0.2e1 * t78 * t115 * t46;
  t266 = 0.2e1 * t256 * t4 * t78 - t113 * t184 - 0.2e1 * t184 * t260 + t248 * t76 + 0.2e1 * t252 * t253 - t251 - t265;
  t270 = my_piecewise3(t31, 0, t108 * t83 / 0.2e1 + t69 * t119 / 0.2e1 + t241 * t41 / 0.2e1 + t33 * t266 / 0.2e1);
  tv2rho21 = t67 + t87 + t106 + t123 + t3 * (t240 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t276 = 0.2e1 * t46 + 0.2e1 * t130;
  t277 = my_piecewise5(t7, 0, t10, 0, t276);
  t281 = my_piecewise5(t16, 0, t19, 0, t276);
  t284 = t281 * t3 + 0.2e1 * t93;
  t285 = params->B * t284;
  t287 = t145 * t93;
  t289 = t95 * t95;
  t290 = params->C * t289;
  t293 = t284 * t55;
  t299 = 0.2e1 * t293 * t4 * t58 + 0.2e1 * t152 * t290 - 0.2e1 * t230 * t287 + t285 * t56 - t287 * t96 - t221 - t235;
  t303 = my_piecewise3(t1, 0, t277 * t27 / 0.2e1 + t91 * t102 + t13 * t299 / 0.2e1);
  t304 = -t276;
  t305 = my_piecewise5(t10, 0, t7, 0, t304);
  t309 = my_piecewise5(t19, 0, t16, 0, t304);
  t312 = t3 * t309 + 0.2e1 * t110;
  t313 = params->B * t312;
  t315 = t183 * t110;
  t317 = t112 * t112;
  t318 = params->C * t317;
  t321 = t312 * t75;
  t327 = 0.2e1 * t321 * t4 * t78 - t113 * t315 + 0.2e1 * t190 * t318 - 0.2e1 * t260 * t315 + t313 * t76 - t251 - t265;
  t331 = my_piecewise3(t31, 0, t305 * t41 / 0.2e1 + t108 * t119 + t33 * t327 / 0.2e1);
  tv2rho22 = 0.2e1 * t106 + 0.2e1 * t123 + t3 * (t303 + t331);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t7, t8, t10;
  double t11, t12, t13, t16, t19, t20, t21, t23;
  double t25, t27, t30, t31, t32, t33, t34, t35;
  double t37, t39, t41, t44, tzk0;

  double t45, t46, t47, t48, t49, t51, t53, t54;
  double t55, t56, t58, t59, t63, t67, t68, t69;
  double t71, t73, t74, t75, t76, t78, t79, t83;
  double t87, tvrho0, t90, t91, t93, t95, t96, t98;
  double t102, t106, t107, t108, t110, t112, t113, t115;
  double t119, t123, tvrho1;

  double t129, t130, t132, t133, t137, t140, t141, t143;
  double t144, t145, t146, t148, t150, t151, t152, t155;
  double t159, t165, t169, t170, t171, t175, t178, t179;
  double t181, t182, t183, t184, t186, t188, t189, t190;
  double t193, t197, t203, t207, tv2rho20, t210, t211, t215;
  double t217, t218, t221, t222, t223, t226, t230, t235;
  double t236, t240, t241, t245, t247, t248, t251, t252;
  double t253, t256, t260, t265, t266, t270, tv2rho21, t276;
  double t277, t281, t284, t285, t287, t289, t290, t293;
  double t299, t303, t304, t305, t309, t312, t313, t315;
  double t317, t318, t321, t327, t331, tv2rho22;

  double t336, t337, t338, t340, t341, t349, t350, t351;
  double t352, t355, t362, t364, t370, t371, t374, t377;
  double t380, t381, t385, t391, t402, t406, t407, t408;
  double t416, t417, t418, t419, t422, t429, t431, t437;
  double t438, t441, t444, t447, t448, t452, t458, t469;
  double t473, tv3rho30, t476, t477, t478, t479, t480, t481;
  double t492, t496, t500, t501, t504, t507, t509, t510;
  double t511, t515, t519, t521, t522, t523, t526, t527;
  double t529, t533, t539, t540, t544, t545, t546, t557;
  double t561, t562, t565, t568, t570, t571, t572, t576;
  double t580, t582, t583, t584, t587, t588, t590, t594;
  double t600, t603, t605, t609, tv3rho31, t612, t613, t626;
  double t628, t633, t635, t636, t640, t641, t643, t645;
  double t648, t649, t650, t652, t654, t655, t659, t662;
  double t663, t664, t667, t674, t676, t677, t681, t682;
  double t683, t696, t698, t703, t705, t706, t710, t711;
  double t713, t715, t718, t719, t720, t722, t724, t725;
  double t729, t732, t733, t734, t737, t744, t746, t747;
  double t751, tv3rho32, t757, t758, t769, t776, t779, t780;
  double t784, t788, t789, t799, t803, t804, t805, t816;
  double t823, t826, t827, t831, t835, t836, t846, t850;
  double tv3rho33;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = rho[0] - rho[1];
  t3 = rho[0] + rho[1];
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t7 = 0.1e1 + t5 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = 0.1e1 - t5 <= p->zeta_threshold;
  t11 = -t8;
  t12 = my_piecewise5(t7, t8, t10, t11, t5);
  t13 = 0.1e1 + t12;
  t16 = 0.2e1 * rho[0] * t4 <= p->zeta_threshold;
  t19 = 0.2e1 * rho[1] * t4 <= p->zeta_threshold;
  t20 = my_piecewise5(t16, t8, t19, t11, t5);
  t21 = 0.1e1 + t20;
  t23 = log(t21 * t3);
  t25 = t23 * t23;
  t27 = t23 * params->B + t25 * params->C + params->A;
  t30 = my_piecewise3(t1, 0, t13 * t27 / 0.2e1);
  t31 = rho[1] <= p->dens_threshold;
  t32 = my_piecewise5(t10, t8, t7, t11, -t5);
  t33 = 0.1e1 + t32;
  t34 = my_piecewise5(t19, t8, t16, t11, -t5);
  t35 = 0.1e1 + t34;
  t37 = log(t35 * t3);
  t39 = t37 * t37;
  t41 = t37 * params->B + t39 * params->C + params->A;
  t44 = my_piecewise3(t31, 0, t33 * t41 / 0.2e1);
  tzk0 = t30 + t44;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t45 = t3 * t3;
  t46 = 0.1e1 / t45;
  t47 = t2 * t46;
  t48 = t4 - t47;
  t49 = my_piecewise5(t7, 0, t10, 0, t48);
  t51 = my_piecewise5(t16, 0, t19, 0, t48);
  t53 = t3 * t51 + t20 + 0.1e1;
  t54 = params->B * t53;
  t55 = 0.1e1 / t21;
  t56 = t55 * t4;
  t58 = params->C * t23;
  t59 = t53 * t55;
  t63 = 0.2e1 * t4 * t58 * t59 + t54 * t56;
  t67 = my_piecewise3(t1, 0, t13 * t63 / 0.2e1 + t49 * t27 / 0.2e1);
  t68 = -t48;
  t69 = my_piecewise5(t10, 0, t7, 0, t68);
  t71 = my_piecewise5(t19, 0, t16, 0, t68);
  t73 = t3 * t71 + t34 + 0.1e1;
  t74 = params->B * t73;
  t75 = 0.1e1 / t35;
  t76 = t75 * t4;
  t78 = params->C * t37;
  t79 = t73 * t75;
  t83 = 0.2e1 * t4 * t78 * t79 + t74 * t76;
  t87 = my_piecewise3(t31, 0, t33 * t83 / 0.2e1 + t69 * t41 / 0.2e1);
  tvrho0 = t30 + t44 + t3 * (t67 + t87);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = -t4 - t47;
  t91 = my_piecewise5(t7, 0, t10, 0, t90);
  t93 = my_piecewise5(t16, 0, t19, 0, t90);
  t95 = t3 * t93 + t20 + 0.1e1;
  t96 = params->B * t95;
  t98 = t95 * t55;
  t102 = 0.2e1 * t4 * t58 * t98 + t56 * t96;
  t106 = my_piecewise3(t1, 0, t13 * t102 / 0.2e1 + t91 * t27 / 0.2e1);
  t107 = -t90;
  t108 = my_piecewise5(t10, 0, t7, 0, t107);
  t110 = my_piecewise5(t19, 0, t16, 0, t107);
  t112 = t110 * t3 + t34 + 0.1e1;
  t113 = params->B * t112;
  t115 = t112 * t75;
  t119 = 0.2e1 * t115 * t4 * t78 + t113 * t76;
  t123 = my_piecewise3(t31, 0, t108 * t41 / 0.2e1 + t33 * t119 / 0.2e1);
  tvrho1 = t30 + t44 + t3 * (t106 + t123);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t129 = 0.1e1 / t45 / t3;
  t130 = t2 * t129;
  t132 = -0.2e1 * t46 + 0.2e1 * t130;
  t133 = my_piecewise5(t7, 0, t10, 0, t132);
  t137 = my_piecewise5(t16, 0, t19, 0, t132);
  t140 = t137 * t3 + 0.2e1 * t51;
  t141 = params->B * t140;
  t143 = t21 * t21;
  t144 = 0.1e1 / t143;
  t145 = t144 * t4;
  t146 = t145 * t51;
  t148 = t55 * t46;
  t150 = t53 * t53;
  t151 = params->C * t150;
  t152 = t144 * t46;
  t155 = t140 * t55;
  t159 = t58 * t53;
  t165 = 0.2e1 * t155 * t4 * t58 - 0.2e1 * t46 * t58 * t59 + t141 * t56 - 0.2e1 * t146 * t159 - t146 * t54 - t148 * t54 + 0.2e1 * t151 * t152;
  t169 = my_piecewise3(t1, 0, t133 * t27 / 0.2e1 + t49 * t63 + t13 * t165 / 0.2e1);
  t170 = -t132;
  t171 = my_piecewise5(t10, 0, t7, 0, t170);
  t175 = my_piecewise5(t19, 0, t16, 0, t170);
  t178 = t175 * t3 + 0.2e1 * t71;
  t179 = params->B * t178;
  t181 = t35 * t35;
  t182 = 0.1e1 / t181;
  t183 = t182 * t4;
  t184 = t183 * t71;
  t186 = t75 * t46;
  t188 = t73 * t73;
  t189 = params->C * t188;
  t190 = t182 * t46;
  t193 = t178 * t75;
  t197 = t78 * t73;
  t203 = 0.2e1 * t193 * t4 * t78 - 0.2e1 * t46 * t78 * t79 + t179 * t76 - 0.2e1 * t184 * t197 - t184 * t74 - t186 * t74 + 0.2e1 * t189 * t190;
  t207 = my_piecewise3(t31, 0, t171 * t41 / 0.2e1 + t69 * t83 + t33 * t203 / 0.2e1);
  tv2rho20 = 0.2e1 * t67 + 0.2e1 * t87 + t3 * (t169 + t207);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t210 = 0.2e1 * t130;
  t211 = my_piecewise5(t7, 0, t10, 0, t210);
  t215 = my_piecewise5(t16, 0, t19, 0, t210);
  t217 = t215 * t3 + t51 + t93;
  t218 = params->B * t217;
  t221 = t96 * t148;
  t222 = params->C * t53;
  t223 = t152 * t95;
  t226 = t217 * t55;
  t230 = t58 * t95;
  t235 = 0.2e1 * t58 * t98 * t46;
  t236 = 0.2e1 * t226 * t4 * t58 - 0.2e1 * t146 * t230 - t146 * t96 + t218 * t56 + 0.2e1 * t222 * t223 - t221 - t235;
  t240 = my_piecewise3(t1, 0, t49 * t102 / 0.2e1 + t13 * t236 / 0.2e1 + t211 * t27 / 0.2e1 + t91 * t63 / 0.2e1);
  t241 = my_piecewise5(t10, 0, t7, 0, -t210);
  t245 = my_piecewise5(t19, 0, t16, 0, -t210);
  t247 = t245 * t3 + t110 + t71;
  t248 = params->B * t247;
  t251 = t113 * t186;
  t252 = params->C * t73;
  t253 = t190 * t112;
  t256 = t247 * t75;
  t260 = t78 * t112;
  t265 = 0.2e1 * t78 * t115 * t46;
  t266 = 0.2e1 * t256 * t4 * t78 - t113 * t184 - 0.2e1 * t184 * t260 + t248 * t76 + 0.2e1 * t252 * t253 - t251 - t265;
  t270 = my_piecewise3(t31, 0, t108 * t83 / 0.2e1 + t69 * t119 / 0.2e1 + t241 * t41 / 0.2e1 + t33 * t266 / 0.2e1);
  tv2rho21 = t67 + t87 + t106 + t123 + t3 * (t240 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t276 = 0.2e1 * t46 + 0.2e1 * t130;
  t277 = my_piecewise5(t7, 0, t10, 0, t276);
  t281 = my_piecewise5(t16, 0, t19, 0, t276);
  t284 = t281 * t3 + 0.2e1 * t93;
  t285 = params->B * t284;
  t287 = t145 * t93;
  t289 = t95 * t95;
  t290 = params->C * t289;
  t293 = t284 * t55;
  t299 = 0.2e1 * t293 * t4 * t58 + 0.2e1 * t152 * t290 - 0.2e1 * t230 * t287 + t285 * t56 - t287 * t96 - t221 - t235;
  t303 = my_piecewise3(t1, 0, t277 * t27 / 0.2e1 + t91 * t102 + t13 * t299 / 0.2e1);
  t304 = -t276;
  t305 = my_piecewise5(t10, 0, t7, 0, t304);
  t309 = my_piecewise5(t19, 0, t16, 0, t304);
  t312 = t3 * t309 + 0.2e1 * t110;
  t313 = params->B * t312;
  t315 = t183 * t110;
  t317 = t112 * t112;
  t318 = params->C * t317;
  t321 = t312 * t75;
  t327 = 0.2e1 * t321 * t4 * t78 - t113 * t315 + 0.2e1 * t190 * t318 - 0.2e1 * t260 * t315 + t313 * t76 - t251 - t265;
  t331 = my_piecewise3(t31, 0, t305 * t41 / 0.2e1 + t108 * t119 + t33 * t327 / 0.2e1);
  tv2rho22 = 0.2e1 * t106 + 0.2e1 * t123 + t3 * (t303 + t331);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t336 = t45 * t45;
  t337 = 0.1e1 / t336;
  t338 = t2 * t337;
  t340 = 0.6e1 * t129 - 0.6e1 * t338;
  t341 = my_piecewise5(t7, 0, t10, 0, t340);
  t349 = 0.1e1 / t143 / t21;
  t350 = t349 * t4;
  t351 = t51 * t51;
  t352 = t350 * t351;
  t355 = t152 * t51;
  t362 = t145 * t137;
  t364 = t55 * t129;
  t370 = t349 * t46;
  t371 = t370 * t51;
  t374 = t144 * t129;
  t377 = my_piecewise5(t16, 0, t19, 0, t340);
  t380 = t3 * t377 + 0.3e1 * t137;
  t381 = t380 * t55;
  t385 = params->B * t380;
  t391 = t58 * t140;
  t402 = 0.4e1 * t129 * t58 * t59 + 0.6e1 * t140 * t152 * t222 - 0.4e1 * t155 * t46 * t58 + 0.2e1 * t381 * t4 * t58 - 0.2e1 * t141 * t146 - 0.2e1 * t141 * t148 - 0.4e1 * t146 * t391 - 0.6e1 * t151 * t371 - 0.6e1 * t151 * t374 + 0.4e1 * t159 * t352 + 0.4e1 * t159 * t355 - 0.2e1 * t159 * t362 + 0.2e1 * t352 * t54 + 0.2e1 * t355 * t54 - t362 * t54 + 0.2e1 * t364 * t54 + t385 * t56;
  t406 = my_piecewise3(t1, 0, t341 * t27 / 0.2e1 + 0.3e1 / 0.2e1 * t133 * t63 + 0.3e1 / 0.2e1 * t49 * t165 + t13 * t402 / 0.2e1);
  t407 = -t340;
  t408 = my_piecewise5(t10, 0, t7, 0, t407);
  t416 = 0.1e1 / t181 / t35;
  t417 = t416 * t4;
  t418 = t71 * t71;
  t419 = t417 * t418;
  t422 = t190 * t71;
  t429 = t183 * t175;
  t431 = t75 * t129;
  t437 = t416 * t46;
  t438 = t437 * t71;
  t441 = t182 * t129;
  t444 = my_piecewise5(t19, 0, t16, 0, t407);
  t447 = t3 * t444 + 0.3e1 * t175;
  t448 = t447 * t75;
  t452 = params->B * t447;
  t458 = t78 * t178;
  t469 = 0.4e1 * t129 * t78 * t79 + 0.6e1 * t178 * t190 * t252 - 0.4e1 * t193 * t46 * t78 + 0.2e1 * t4 * t448 * t78 - 0.2e1 * t179 * t184 - 0.2e1 * t179 * t186 - 0.4e1 * t184 * t458 - 0.6e1 * t189 * t438 - 0.6e1 * t189 * t441 + 0.4e1 * t197 * t419 + 0.4e1 * t197 * t422 - 0.2e1 * t197 * t429 + 0.2e1 * t419 * t74 + 0.2e1 * t422 * t74 - t429 * t74 + 0.2e1 * t431 * t74 + t452 * t76;
  t473 = my_piecewise3(t31, 0, t408 * t41 / 0.2e1 + 0.3e1 / 0.2e1 * t171 * t83 + 0.3e1 / 0.2e1 * t69 * t203 + t33 * t469 / 0.2e1);
  tv3rho30 = 0.3e1 * t169 + 0.3e1 * t207 + t3 * (t406 + t473);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t476 = 0.2e1 * t240;
  t477 = 0.2e1 * t270;
  t478 = 0.2e1 * t129;
  t479 = 0.6e1 * t338;
  t480 = t478 - t479;
  t481 = my_piecewise5(t7, 0, t10, 0, t480);
  t492 = t230 * t355;
  t496 = t218 * t148;
  t500 = 0.2e1 * t96 * t364;
  t501 = params->C * t140;
  t504 = t152 * t217;
  t507 = my_piecewise5(t16, 0, t19, 0, t480);
  t509 = 0.2e1 * t215;
  t510 = t3 * t507 + t137 + t509;
  t511 = t510 * t55;
  t515 = params->B * t510;
  t519 = t96 * t355;
  t521 = t222 * t349;
  t522 = t46 * t95;
  t523 = t522 * t51;
  t526 = t374 * t95;
  t527 = t222 * t526;
  t529 = t58 * t217;
  t533 = t58 * t226 * t46;
  t539 = 0.4e1 * t58 * t98 * t129;
  t540 = 0.2e1 * t4 * t511 * t58 - 0.2e1 * t146 * t218 - 0.4e1 * t146 * t529 + 0.4e1 * t222 * t504 + 0.2e1 * t223 * t501 + 0.4e1 * t230 * t352 - 0.2e1 * t230 * t362 + 0.2e1 * t352 * t96 - t362 * t96 + t515 * t56 - 0.6e1 * t521 * t523 + 0.4e1 * t492 - 0.2e1 * t496 + t500 + 0.2e1 * t519 - 0.6e1 * t527 - 0.4e1 * t533 + t539;
  t544 = my_piecewise3(t1, 0, t481 * t27 / 0.2e1 + t211 * t63 + t91 * t165 / 0.2e1 + t133 * t102 / 0.2e1 + t49 * t236 + t13 * t540 / 0.2e1);
  t545 = -t480;
  t546 = my_piecewise5(t10, 0, t7, 0, t545);
  t557 = t248 * t186;
  t561 = 0.2e1 * t113 * t431;
  t562 = params->C * t178;
  t565 = t190 * t247;
  t568 = my_piecewise5(t19, 0, t16, 0, t545);
  t570 = 0.2e1 * t245;
  t571 = t3 * t568 + t175 + t570;
  t572 = t571 * t75;
  t576 = params->B * t571;
  t580 = t113 * t422;
  t582 = t252 * t416;
  t583 = t46 * t112;
  t584 = t583 * t71;
  t587 = t441 * t112;
  t588 = t252 * t587;
  t590 = t78 * t247;
  t594 = t78 * t256 * t46;
  t600 = 0.4e1 * t78 * t115 * t129;
  t603 = t260 * t422;
  t605 = 0.2e1 * t4 * t572 * t78 + 0.2e1 * t113 * t419 - t113 * t429 - 0.2e1 * t184 * t248 - 0.4e1 * t184 * t590 + 0.4e1 * t252 * t565 + 0.2e1 * t253 * t562 + 0.4e1 * t260 * t419 - 0.2e1 * t260 * t429 + t576 * t76 - 0.6e1 * t582 * t584 - 0.2e1 * t557 + t561 + 0.2e1 * t580 - 0.6e1 * t588 - 0.4e1 * t594 + t600 + 0.4e1 * t603;
  t609 = my_piecewise3(t31, 0, t546 * t41 / 0.2e1 + t241 * t83 + t108 * t203 / 0.2e1 + t171 * t119 / 0.2e1 + t69 * t266 + t33 * t605 / 0.2e1);
  tv3rho31 = t169 + t207 + t476 + t477 + t3 * (t544 + t609);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t612 = -t478 - t479;
  t613 = my_piecewise5(t7, 0, t10, 0, t612);
  t626 = t145 * t215;
  t628 = params->C * t95;
  t633 = my_piecewise5(t16, 0, t19, 0, t612);
  t635 = t3 * t633 + t281 + t509;
  t636 = t635 * t55;
  t640 = t152 * t93;
  t641 = t96 * t640;
  t643 = t58 * t293 * t46;
  t645 = t152 * t284;
  t648 = 0.2e1 * t4 * t58 * t636 - t146 * t285 - t218 * t287 + 0.2e1 * t222 * t645 - 0.4e1 * t290 * t371 + 0.4e1 * t504 * t628 - t626 * t96 + t519 - 0.2e1 * t527 - 0.2e1 * t533 + t539 + t641 - 0.2e1 * t643;
  t649 = t285 * t148;
  t650 = t290 * t374;
  t652 = params->B * t635;
  t654 = t93 * t51;
  t655 = t350 * t654;
  t659 = t522 * t93;
  t662 = t96 * t349;
  t663 = t4 * t93;
  t664 = t663 * t51;
  t667 = t58 * t284;
  t674 = t230 * t640;
  t676 = -0.2e1 * t146 * t667 - 0.2e1 * t230 * t626 + 0.4e1 * t230 * t655 - 0.2e1 * t287 * t529 - 0.2e1 * t521 * t659 + t56 * t652 + 0.2e1 * t662 * t664 + 0.2e1 * t492 - t496 + t500 - t649 - 0.4e1 * t650 + 0.2e1 * t674;
  t677 = t648 + t676;
  t681 = my_piecewise3(t1, 0, t613 * t27 / 0.2e1 + t277 * t63 / 0.2e1 + t211 * t102 + t91 * t236 + t49 * t299 / 0.2e1 + t13 * t677 / 0.2e1);
  t682 = -t612;
  t683 = my_piecewise5(t10, 0, t7, 0, t682);
  t696 = t183 * t245;
  t698 = params->C * t112;
  t703 = my_piecewise5(t19, 0, t16, 0, t682);
  t705 = t3 * t703 + t309 + t570;
  t706 = t705 * t75;
  t710 = t190 * t110;
  t711 = t113 * t710;
  t713 = t78 * t321 * t46;
  t715 = t190 * t312;
  t718 = 0.2e1 * t4 * t706 * t78 - t113 * t696 - t184 * t313 - t248 * t315 + 0.2e1 * t252 * t715 - 0.4e1 * t318 * t438 + 0.4e1 * t565 * t698 + t580 - 0.2e1 * t588 - 0.2e1 * t594 + t600 + t711 - 0.2e1 * t713;
  t719 = t313 * t186;
  t720 = t318 * t441;
  t722 = params->B * t705;
  t724 = t110 * t71;
  t725 = t417 * t724;
  t729 = t583 * t110;
  t732 = t113 * t416;
  t733 = t4 * t110;
  t734 = t733 * t71;
  t737 = t78 * t312;
  t744 = t260 * t710;
  t746 = -0.2e1 * t184 * t737 - 0.2e1 * t260 * t696 + 0.4e1 * t260 * t725 - 0.2e1 * t315 * t590 - 0.2e1 * t582 * t729 + t722 * t76 + 0.2e1 * t732 * t734 - t557 + t561 + 0.2e1 * t603 - t719 - 0.4e1 * t720 + 0.2e1 * t744;
  t747 = t718 + t746;
  t751 = my_piecewise3(t31, 0, t683 * t41 / 0.2e1 + t305 * t83 / 0.2e1 + t241 * t119 + t108 * t266 + t69 * t327 / 0.2e1 + t33 * t747 / 0.2e1);
  tv3rho32 = t476 + t477 + t303 + t331 + t3 * (t681 + t751);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t757 = -0.6e1 * t129 - 0.6e1 * t338;
  t758 = my_piecewise5(t7, 0, t10, 0, t757);
  t769 = t145 * t281;
  t776 = my_piecewise5(t16, 0, t19, 0, t757);
  t779 = t3 * t776 + 0.3e1 * t281;
  t780 = t779 * t55;
  t784 = params->B * t779;
  t788 = t93 * t93;
  t789 = t350 * t788;
  t799 = -0.6e1 * t290 * t370 * t93 + 0.2e1 * t4 * t58 * t780 - 0.2e1 * t230 * t769 + 0.4e1 * t230 * t789 - 0.2e1 * t285 * t287 - 0.4e1 * t287 * t667 + t56 * t784 + 0.6e1 * t628 * t645 - t769 * t96 + 0.2e1 * t789 * t96 + t500 + t539 + 0.2e1 * t641 - 0.4e1 * t643 - 0.2e1 * t649 - 0.6e1 * t650 + 0.4e1 * t674;
  t803 = my_piecewise3(t1, 0, t758 * t27 / 0.2e1 + 0.3e1 / 0.2e1 * t277 * t102 + 0.3e1 / 0.2e1 * t91 * t299 + t13 * t799 / 0.2e1);
  t804 = -t757;
  t805 = my_piecewise5(t10, 0, t7, 0, t804);
  t816 = t183 * t309;
  t823 = my_piecewise5(t19, 0, t16, 0, t804);
  t826 = t3 * t823 + 0.3e1 * t309;
  t827 = t826 * t75;
  t831 = params->B * t826;
  t835 = t110 * t110;
  t836 = t417 * t835;
  t846 = -0.6e1 * t110 * t318 * t437 + 0.2e1 * t4 * t78 * t827 - t113 * t816 + 0.2e1 * t113 * t836 - 0.2e1 * t260 * t816 + 0.4e1 * t260 * t836 - 0.2e1 * t313 * t315 - 0.4e1 * t315 * t737 + 0.6e1 * t698 * t715 + t76 * t831 + t561 + t600 + 0.2e1 * t711 - 0.4e1 * t713 - 0.2e1 * t719 - 0.6e1 * t720 + 0.4e1 * t744;
  t850 = my_piecewise3(t31, 0, t805 * t41 / 0.2e1 + 0.3e1 / 0.2e1 * t305 * t119 + 0.3e1 / 0.2e1 * t108 * t327 + t33 * t846 / 0.2e1);
  tv3rho33 = 0.3e1 * t303 + 0.3e1 * t331 + t3 * (t803 + t850);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t7, t8, t10;
  double t11, t12, t13, t16, t19, t20, t21, t23;
  double t25, t27, t30, t31, t32, t33, t34, t35;
  double t37, t39, t41, t44, tzk0;

  double t45, t46, t47, t48, t49, t51, t53, t54;
  double t55, t56, t58, t59, t63, t67, t68, t69;
  double t71, t73, t74, t75, t76, t78, t79, t83;
  double t87, tvrho0, t90, t91, t93, t95, t96, t98;
  double t102, t106, t107, t108, t110, t112, t113, t115;
  double t119, t123, tvrho1;

  double t129, t130, t132, t133, t137, t140, t141, t143;
  double t144, t145, t146, t148, t150, t151, t152, t155;
  double t159, t165, t169, t170, t171, t175, t178, t179;
  double t181, t182, t183, t184, t186, t188, t189, t190;
  double t193, t197, t203, t207, tv2rho20, t210, t211, t215;
  double t217, t218, t221, t222, t223, t226, t230, t235;
  double t236, t240, t241, t245, t247, t248, t251, t252;
  double t253, t256, t260, t265, t266, t270, tv2rho21, t276;
  double t277, t281, t284, t285, t287, t289, t290, t293;
  double t299, t303, t304, t305, t309, t312, t313, t315;
  double t317, t318, t321, t327, t331, tv2rho22;

  double t336, t337, t338, t340, t341, t349, t350, t351;
  double t352, t355, t362, t364, t370, t371, t374, t377;
  double t380, t381, t385, t391, t402, t406, t407, t408;
  double t416, t417, t418, t419, t422, t429, t431, t437;
  double t438, t441, t444, t447, t448, t452, t458, t469;
  double t473, tv3rho30, t476, t477, t478, t479, t480, t481;
  double t492, t496, t500, t501, t504, t507, t509, t510;
  double t511, t515, t519, t521, t522, t523, t526, t527;
  double t529, t533, t539, t540, t544, t545, t546, t557;
  double t561, t562, t565, t568, t570, t571, t572, t576;
  double t580, t582, t583, t584, t587, t588, t590, t594;
  double t600, t603, t605, t609, tv3rho31, t612, t613, t626;
  double t628, t633, t635, t636, t640, t641, t643, t645;
  double t648, t649, t650, t652, t654, t655, t659, t662;
  double t663, t664, t667, t674, t676, t677, t681, t682;
  double t683, t696, t698, t703, t705, t706, t710, t711;
  double t713, t715, t718, t719, t720, t722, t724, t725;
  double t729, t732, t733, t734, t737, t744, t746, t747;
  double t751, tv3rho32, t757, t758, t769, t776, t779, t780;
  double t784, t788, t789, t799, t803, t804, t805, t816;
  double t823, t826, t827, t831, t835, t836, t846, t850;
  double tv3rho33;

  double t857, t859, t860, t869, t870, t871, t872, t875;
  double t876, t883, t885, t891, t894, t897, t906, t915;
  double t917, t920, t929, t932, t935, t939, t947, t958;
  double t978, t983, t984, t985, t998, t1000, t1006, t1009;
  double t1012, t1021, t1030, t1031, t1032, t1034, t1037, t1046;
  double t1047, t1050, t1051, t1054, t1057, t1060, t1064, t1072;
  double t1083, t1103, t1108, tv4rho40, t1113, t1114, t1115, t1116;
  double t1138, t1140, t1142, t1144, t1145, t1148, t1152, t1155;
  double t1158, t1162, t1163, t1170, t1173, t1176, t1181, t1182;
  double t1184, t1189, t1194, t1196, t1200, t1203, t1204, t1207;
  double t1219, t1221, t1223, t1227, t1229, t1231, t1236, t1237;
  double t1238, t1253, t1255, t1258, t1261, t1264, t1269, t1271;
  double t1273, t1275, t1276, t1279, t1283, t1286, t1289, t1293;
  double t1299, t1300, t1307, t1316, t1319, t1320, t1323, t1333;
  double t1335, t1339, t1341, t1345, t1347, t1351, t1353, t1358;
  double tv4rho41, t1365, t1388, t1391, t1403, t1407, t1409, t1414;
  double t1416, t1420, t1422, t1423, t1425, t1426, t1427, t1428;
  double t1440, t1441, t1445, t1448, t1450, t1454, t1456, t1458;
  double t1459, t1481, t1485, t1487, t1489, t1490, t1494, t1498;
  double t1499, t1502, t1504, t1505, t1508, t1509, t1535, t1538;
  double t1544, t1545, t1560, t1561, t1565, t1568, t1570, t1574;
  double t1578, t1591, t1594, t1602, t1607, t1611, t1613, t1618;
  double t1620, t1624, t1626, t1627, t1629, t1630, t1631, t1633;
  double t1634, t1656, t1657, t1670, t1672, t1674, t1675, t1679;
  double t1683, t1684, t1685, t1688, t1690, t1693, t1694, t1718;
  double t1724, tv4rho42, t1729, t1730, t1745, t1747, t1748, t1749;
  double t1752, t1755, t1757, t1758, t1760, t1768, t1778, t1781;
  double t1789, t1800, t1801, t1806, t1817, t1837, t1839, t1841;
  double t1843, t1846, t1873, t1879, t1880, t1881, t1896, t1904;
  double t1914, t1917, t1925, t1927, t1928, t1929, t1932, t1935;
  double t1937, t1938, t1940, t1952, t1958, t1962, t1971, t1991;
  double t1993, t1995, t1997, t2006, t2024, t2030, tv4rho43, t2036;
  double t2037, t2052, t2059, t2066, t2069, t2081, t2087, t2115;
  double t2120, t2121, t2122, t2135, t2142, t2145, t2156, t2167;
  double t2171, t2200, t2205, tv4rho44;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = rho[0] - rho[1];
  t3 = rho[0] + rho[1];
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t7 = 0.1e1 + t5 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = 0.1e1 - t5 <= p->zeta_threshold;
  t11 = -t8;
  t12 = my_piecewise5(t7, t8, t10, t11, t5);
  t13 = 0.1e1 + t12;
  t16 = 0.2e1 * rho[0] * t4 <= p->zeta_threshold;
  t19 = 0.2e1 * rho[1] * t4 <= p->zeta_threshold;
  t20 = my_piecewise5(t16, t8, t19, t11, t5);
  t21 = 0.1e1 + t20;
  t23 = log(t21 * t3);
  t25 = t23 * t23;
  t27 = t23 * params->B + t25 * params->C + params->A;
  t30 = my_piecewise3(t1, 0, t13 * t27 / 0.2e1);
  t31 = rho[1] <= p->dens_threshold;
  t32 = my_piecewise5(t10, t8, t7, t11, -t5);
  t33 = 0.1e1 + t32;
  t34 = my_piecewise5(t19, t8, t16, t11, -t5);
  t35 = 0.1e1 + t34;
  t37 = log(t35 * t3);
  t39 = t37 * t37;
  t41 = t37 * params->B + t39 * params->C + params->A;
  t44 = my_piecewise3(t31, 0, t33 * t41 / 0.2e1);
  tzk0 = t30 + t44;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t45 = t3 * t3;
  t46 = 0.1e1 / t45;
  t47 = t2 * t46;
  t48 = t4 - t47;
  t49 = my_piecewise5(t7, 0, t10, 0, t48);
  t51 = my_piecewise5(t16, 0, t19, 0, t48);
  t53 = t3 * t51 + t20 + 0.1e1;
  t54 = params->B * t53;
  t55 = 0.1e1 / t21;
  t56 = t55 * t4;
  t58 = params->C * t23;
  t59 = t53 * t55;
  t63 = 0.2e1 * t4 * t58 * t59 + t54 * t56;
  t67 = my_piecewise3(t1, 0, t13 * t63 / 0.2e1 + t49 * t27 / 0.2e1);
  t68 = -t48;
  t69 = my_piecewise5(t10, 0, t7, 0, t68);
  t71 = my_piecewise5(t19, 0, t16, 0, t68);
  t73 = t3 * t71 + t34 + 0.1e1;
  t74 = params->B * t73;
  t75 = 0.1e1 / t35;
  t76 = t75 * t4;
  t78 = params->C * t37;
  t79 = t73 * t75;
  t83 = 0.2e1 * t4 * t78 * t79 + t74 * t76;
  t87 = my_piecewise3(t31, 0, t33 * t83 / 0.2e1 + t69 * t41 / 0.2e1);
  tvrho0 = t30 + t44 + t3 * (t67 + t87);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = -t4 - t47;
  t91 = my_piecewise5(t7, 0, t10, 0, t90);
  t93 = my_piecewise5(t16, 0, t19, 0, t90);
  t95 = t3 * t93 + t20 + 0.1e1;
  t96 = params->B * t95;
  t98 = t95 * t55;
  t102 = 0.2e1 * t4 * t58 * t98 + t56 * t96;
  t106 = my_piecewise3(t1, 0, t13 * t102 / 0.2e1 + t91 * t27 / 0.2e1);
  t107 = -t90;
  t108 = my_piecewise5(t10, 0, t7, 0, t107);
  t110 = my_piecewise5(t19, 0, t16, 0, t107);
  t112 = t110 * t3 + t34 + 0.1e1;
  t113 = params->B * t112;
  t115 = t112 * t75;
  t119 = 0.2e1 * t115 * t4 * t78 + t113 * t76;
  t123 = my_piecewise3(t31, 0, t108 * t41 / 0.2e1 + t33 * t119 / 0.2e1);
  tvrho1 = t30 + t44 + t3 * (t106 + t123);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t129 = 0.1e1 / t45 / t3;
  t130 = t2 * t129;
  t132 = -0.2e1 * t46 + 0.2e1 * t130;
  t133 = my_piecewise5(t7, 0, t10, 0, t132);
  t137 = my_piecewise5(t16, 0, t19, 0, t132);
  t140 = t137 * t3 + 0.2e1 * t51;
  t141 = params->B * t140;
  t143 = t21 * t21;
  t144 = 0.1e1 / t143;
  t145 = t144 * t4;
  t146 = t145 * t51;
  t148 = t55 * t46;
  t150 = t53 * t53;
  t151 = params->C * t150;
  t152 = t144 * t46;
  t155 = t140 * t55;
  t159 = t58 * t53;
  t165 = 0.2e1 * t155 * t4 * t58 - 0.2e1 * t46 * t58 * t59 + t141 * t56 - 0.2e1 * t146 * t159 - t146 * t54 - t148 * t54 + 0.2e1 * t151 * t152;
  t169 = my_piecewise3(t1, 0, t133 * t27 / 0.2e1 + t49 * t63 + t13 * t165 / 0.2e1);
  t170 = -t132;
  t171 = my_piecewise5(t10, 0, t7, 0, t170);
  t175 = my_piecewise5(t19, 0, t16, 0, t170);
  t178 = t175 * t3 + 0.2e1 * t71;
  t179 = params->B * t178;
  t181 = t35 * t35;
  t182 = 0.1e1 / t181;
  t183 = t182 * t4;
  t184 = t183 * t71;
  t186 = t75 * t46;
  t188 = t73 * t73;
  t189 = params->C * t188;
  t190 = t182 * t46;
  t193 = t178 * t75;
  t197 = t78 * t73;
  t203 = 0.2e1 * t193 * t4 * t78 - 0.2e1 * t46 * t78 * t79 + t179 * t76 - 0.2e1 * t184 * t197 - t184 * t74 - t186 * t74 + 0.2e1 * t189 * t190;
  t207 = my_piecewise3(t31, 0, t171 * t41 / 0.2e1 + t69 * t83 + t33 * t203 / 0.2e1);
  tv2rho20 = 0.2e1 * t67 + 0.2e1 * t87 + t3 * (t169 + t207);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t210 = 0.2e1 * t130;
  t211 = my_piecewise5(t7, 0, t10, 0, t210);
  t215 = my_piecewise5(t16, 0, t19, 0, t210);
  t217 = t215 * t3 + t51 + t93;
  t218 = params->B * t217;
  t221 = t96 * t148;
  t222 = params->C * t53;
  t223 = t152 * t95;
  t226 = t217 * t55;
  t230 = t58 * t95;
  t235 = 0.2e1 * t58 * t98 * t46;
  t236 = 0.2e1 * t226 * t4 * t58 - 0.2e1 * t146 * t230 - t146 * t96 + t218 * t56 + 0.2e1 * t222 * t223 - t221 - t235;
  t240 = my_piecewise3(t1, 0, t49 * t102 / 0.2e1 + t13 * t236 / 0.2e1 + t211 * t27 / 0.2e1 + t91 * t63 / 0.2e1);
  t241 = my_piecewise5(t10, 0, t7, 0, -t210);
  t245 = my_piecewise5(t19, 0, t16, 0, -t210);
  t247 = t245 * t3 + t110 + t71;
  t248 = params->B * t247;
  t251 = t113 * t186;
  t252 = params->C * t73;
  t253 = t190 * t112;
  t256 = t247 * t75;
  t260 = t78 * t112;
  t265 = 0.2e1 * t78 * t115 * t46;
  t266 = 0.2e1 * t256 * t4 * t78 - t113 * t184 - 0.2e1 * t184 * t260 + t248 * t76 + 0.2e1 * t252 * t253 - t251 - t265;
  t270 = my_piecewise3(t31, 0, t108 * t83 / 0.2e1 + t69 * t119 / 0.2e1 + t241 * t41 / 0.2e1 + t33 * t266 / 0.2e1);
  tv2rho21 = t67 + t87 + t106 + t123 + t3 * (t240 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t276 = 0.2e1 * t46 + 0.2e1 * t130;
  t277 = my_piecewise5(t7, 0, t10, 0, t276);
  t281 = my_piecewise5(t16, 0, t19, 0, t276);
  t284 = t281 * t3 + 0.2e1 * t93;
  t285 = params->B * t284;
  t287 = t145 * t93;
  t289 = t95 * t95;
  t290 = params->C * t289;
  t293 = t284 * t55;
  t299 = 0.2e1 * t293 * t4 * t58 + 0.2e1 * t152 * t290 - 0.2e1 * t230 * t287 + t285 * t56 - t287 * t96 - t221 - t235;
  t303 = my_piecewise3(t1, 0, t277 * t27 / 0.2e1 + t91 * t102 + t13 * t299 / 0.2e1);
  t304 = -t276;
  t305 = my_piecewise5(t10, 0, t7, 0, t304);
  t309 = my_piecewise5(t19, 0, t16, 0, t304);
  t312 = t3 * t309 + 0.2e1 * t110;
  t313 = params->B * t312;
  t315 = t183 * t110;
  t317 = t112 * t112;
  t318 = params->C * t317;
  t321 = t312 * t75;
  t327 = 0.2e1 * t321 * t4 * t78 - t113 * t315 + 0.2e1 * t190 * t318 - 0.2e1 * t260 * t315 + t313 * t76 - t251 - t265;
  t331 = my_piecewise3(t31, 0, t305 * t41 / 0.2e1 + t108 * t119 + t33 * t327 / 0.2e1);
  tv2rho22 = 0.2e1 * t106 + 0.2e1 * t123 + t3 * (t303 + t331);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t336 = t45 * t45;
  t337 = 0.1e1 / t336;
  t338 = t2 * t337;
  t340 = 0.6e1 * t129 - 0.6e1 * t338;
  t341 = my_piecewise5(t7, 0, t10, 0, t340);
  t349 = 0.1e1 / t143 / t21;
  t350 = t349 * t4;
  t351 = t51 * t51;
  t352 = t350 * t351;
  t355 = t152 * t51;
  t362 = t145 * t137;
  t364 = t55 * t129;
  t370 = t349 * t46;
  t371 = t370 * t51;
  t374 = t144 * t129;
  t377 = my_piecewise5(t16, 0, t19, 0, t340);
  t380 = t3 * t377 + 0.3e1 * t137;
  t381 = t380 * t55;
  t385 = params->B * t380;
  t391 = t58 * t140;
  t402 = 0.4e1 * t129 * t58 * t59 + 0.6e1 * t140 * t152 * t222 - 0.4e1 * t155 * t46 * t58 + 0.2e1 * t381 * t4 * t58 - 0.2e1 * t141 * t146 - 0.2e1 * t141 * t148 - 0.4e1 * t146 * t391 - 0.6e1 * t151 * t371 - 0.6e1 * t151 * t374 + 0.4e1 * t159 * t352 + 0.4e1 * t159 * t355 - 0.2e1 * t159 * t362 + 0.2e1 * t352 * t54 + 0.2e1 * t355 * t54 - t362 * t54 + 0.2e1 * t364 * t54 + t385 * t56;
  t406 = my_piecewise3(t1, 0, t341 * t27 / 0.2e1 + 0.3e1 / 0.2e1 * t133 * t63 + 0.3e1 / 0.2e1 * t49 * t165 + t13 * t402 / 0.2e1);
  t407 = -t340;
  t408 = my_piecewise5(t10, 0, t7, 0, t407);
  t416 = 0.1e1 / t181 / t35;
  t417 = t416 * t4;
  t418 = t71 * t71;
  t419 = t417 * t418;
  t422 = t190 * t71;
  t429 = t183 * t175;
  t431 = t75 * t129;
  t437 = t416 * t46;
  t438 = t437 * t71;
  t441 = t182 * t129;
  t444 = my_piecewise5(t19, 0, t16, 0, t407);
  t447 = t3 * t444 + 0.3e1 * t175;
  t448 = t447 * t75;
  t452 = params->B * t447;
  t458 = t78 * t178;
  t469 = 0.4e1 * t129 * t78 * t79 + 0.6e1 * t178 * t190 * t252 - 0.4e1 * t193 * t46 * t78 + 0.2e1 * t4 * t448 * t78 - 0.2e1 * t179 * t184 - 0.2e1 * t179 * t186 - 0.4e1 * t184 * t458 - 0.6e1 * t189 * t438 - 0.6e1 * t189 * t441 + 0.4e1 * t197 * t419 + 0.4e1 * t197 * t422 - 0.2e1 * t197 * t429 + 0.2e1 * t419 * t74 + 0.2e1 * t422 * t74 - t429 * t74 + 0.2e1 * t431 * t74 + t452 * t76;
  t473 = my_piecewise3(t31, 0, t408 * t41 / 0.2e1 + 0.3e1 / 0.2e1 * t171 * t83 + 0.3e1 / 0.2e1 * t69 * t203 + t33 * t469 / 0.2e1);
  tv3rho30 = 0.3e1 * t169 + 0.3e1 * t207 + t3 * (t406 + t473);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t476 = 0.2e1 * t240;
  t477 = 0.2e1 * t270;
  t478 = 0.2e1 * t129;
  t479 = 0.6e1 * t338;
  t480 = t478 - t479;
  t481 = my_piecewise5(t7, 0, t10, 0, t480);
  t492 = t230 * t355;
  t496 = t218 * t148;
  t500 = 0.2e1 * t96 * t364;
  t501 = params->C * t140;
  t504 = t152 * t217;
  t507 = my_piecewise5(t16, 0, t19, 0, t480);
  t509 = 0.2e1 * t215;
  t510 = t3 * t507 + t137 + t509;
  t511 = t510 * t55;
  t515 = params->B * t510;
  t519 = t96 * t355;
  t521 = t222 * t349;
  t522 = t46 * t95;
  t523 = t522 * t51;
  t526 = t374 * t95;
  t527 = t222 * t526;
  t529 = t58 * t217;
  t533 = t58 * t226 * t46;
  t539 = 0.4e1 * t58 * t98 * t129;
  t540 = 0.2e1 * t4 * t511 * t58 - 0.2e1 * t146 * t218 - 0.4e1 * t146 * t529 + 0.4e1 * t222 * t504 + 0.2e1 * t223 * t501 + 0.4e1 * t230 * t352 - 0.2e1 * t230 * t362 + 0.2e1 * t352 * t96 - t362 * t96 + t515 * t56 - 0.6e1 * t521 * t523 + 0.4e1 * t492 - 0.2e1 * t496 + t500 + 0.2e1 * t519 - 0.6e1 * t527 - 0.4e1 * t533 + t539;
  t544 = my_piecewise3(t1, 0, t481 * t27 / 0.2e1 + t211 * t63 + t91 * t165 / 0.2e1 + t133 * t102 / 0.2e1 + t49 * t236 + t13 * t540 / 0.2e1);
  t545 = -t480;
  t546 = my_piecewise5(t10, 0, t7, 0, t545);
  t557 = t248 * t186;
  t561 = 0.2e1 * t113 * t431;
  t562 = params->C * t178;
  t565 = t190 * t247;
  t568 = my_piecewise5(t19, 0, t16, 0, t545);
  t570 = 0.2e1 * t245;
  t571 = t3 * t568 + t175 + t570;
  t572 = t571 * t75;
  t576 = params->B * t571;
  t580 = t113 * t422;
  t582 = t252 * t416;
  t583 = t46 * t112;
  t584 = t583 * t71;
  t587 = t441 * t112;
  t588 = t252 * t587;
  t590 = t78 * t247;
  t594 = t78 * t256 * t46;
  t600 = 0.4e1 * t78 * t115 * t129;
  t603 = t260 * t422;
  t605 = 0.2e1 * t4 * t572 * t78 + 0.2e1 * t113 * t419 - t113 * t429 - 0.2e1 * t184 * t248 - 0.4e1 * t184 * t590 + 0.4e1 * t252 * t565 + 0.2e1 * t253 * t562 + 0.4e1 * t260 * t419 - 0.2e1 * t260 * t429 + t576 * t76 - 0.6e1 * t582 * t584 - 0.2e1 * t557 + t561 + 0.2e1 * t580 - 0.6e1 * t588 - 0.4e1 * t594 + t600 + 0.4e1 * t603;
  t609 = my_piecewise3(t31, 0, t546 * t41 / 0.2e1 + t241 * t83 + t108 * t203 / 0.2e1 + t171 * t119 / 0.2e1 + t69 * t266 + t33 * t605 / 0.2e1);
  tv3rho31 = t169 + t207 + t476 + t477 + t3 * (t544 + t609);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t612 = -t478 - t479;
  t613 = my_piecewise5(t7, 0, t10, 0, t612);
  t626 = t145 * t215;
  t628 = params->C * t95;
  t633 = my_piecewise5(t16, 0, t19, 0, t612);
  t635 = t3 * t633 + t281 + t509;
  t636 = t635 * t55;
  t640 = t152 * t93;
  t641 = t96 * t640;
  t643 = t58 * t293 * t46;
  t645 = t152 * t284;
  t648 = 0.2e1 * t4 * t58 * t636 - t146 * t285 - t218 * t287 + 0.2e1 * t222 * t645 - 0.4e1 * t290 * t371 + 0.4e1 * t504 * t628 - t626 * t96 + t519 - 0.2e1 * t527 - 0.2e1 * t533 + t539 + t641 - 0.2e1 * t643;
  t649 = t285 * t148;
  t650 = t290 * t374;
  t652 = params->B * t635;
  t654 = t93 * t51;
  t655 = t350 * t654;
  t659 = t522 * t93;
  t662 = t96 * t349;
  t663 = t4 * t93;
  t664 = t663 * t51;
  t667 = t58 * t284;
  t674 = t230 * t640;
  t676 = -0.2e1 * t146 * t667 - 0.2e1 * t230 * t626 + 0.4e1 * t230 * t655 - 0.2e1 * t287 * t529 - 0.2e1 * t521 * t659 + t56 * t652 + 0.2e1 * t662 * t664 + 0.2e1 * t492 - t496 + t500 - t649 - 0.4e1 * t650 + 0.2e1 * t674;
  t677 = t648 + t676;
  t681 = my_piecewise3(t1, 0, t613 * t27 / 0.2e1 + t277 * t63 / 0.2e1 + t211 * t102 + t91 * t236 + t49 * t299 / 0.2e1 + t13 * t677 / 0.2e1);
  t682 = -t612;
  t683 = my_piecewise5(t10, 0, t7, 0, t682);
  t696 = t183 * t245;
  t698 = params->C * t112;
  t703 = my_piecewise5(t19, 0, t16, 0, t682);
  t705 = t3 * t703 + t309 + t570;
  t706 = t705 * t75;
  t710 = t190 * t110;
  t711 = t113 * t710;
  t713 = t78 * t321 * t46;
  t715 = t190 * t312;
  t718 = 0.2e1 * t4 * t706 * t78 - t113 * t696 - t184 * t313 - t248 * t315 + 0.2e1 * t252 * t715 - 0.4e1 * t318 * t438 + 0.4e1 * t565 * t698 + t580 - 0.2e1 * t588 - 0.2e1 * t594 + t600 + t711 - 0.2e1 * t713;
  t719 = t313 * t186;
  t720 = t318 * t441;
  t722 = params->B * t705;
  t724 = t110 * t71;
  t725 = t417 * t724;
  t729 = t583 * t110;
  t732 = t113 * t416;
  t733 = t4 * t110;
  t734 = t733 * t71;
  t737 = t78 * t312;
  t744 = t260 * t710;
  t746 = -0.2e1 * t184 * t737 - 0.2e1 * t260 * t696 + 0.4e1 * t260 * t725 - 0.2e1 * t315 * t590 - 0.2e1 * t582 * t729 + t722 * t76 + 0.2e1 * t732 * t734 - t557 + t561 + 0.2e1 * t603 - t719 - 0.4e1 * t720 + 0.2e1 * t744;
  t747 = t718 + t746;
  t751 = my_piecewise3(t31, 0, t683 * t41 / 0.2e1 + t305 * t83 / 0.2e1 + t241 * t119 + t108 * t266 + t69 * t327 / 0.2e1 + t33 * t747 / 0.2e1);
  tv3rho32 = t476 + t477 + t303 + t331 + t3 * (t681 + t751);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t757 = -0.6e1 * t129 - 0.6e1 * t338;
  t758 = my_piecewise5(t7, 0, t10, 0, t757);
  t769 = t145 * t281;
  t776 = my_piecewise5(t16, 0, t19, 0, t757);
  t779 = t3 * t776 + 0.3e1 * t281;
  t780 = t779 * t55;
  t784 = params->B * t779;
  t788 = t93 * t93;
  t789 = t350 * t788;
  t799 = -0.6e1 * t290 * t370 * t93 + 0.2e1 * t4 * t58 * t780 - 0.2e1 * t230 * t769 + 0.4e1 * t230 * t789 - 0.2e1 * t285 * t287 - 0.4e1 * t287 * t667 + t56 * t784 + 0.6e1 * t628 * t645 - t769 * t96 + 0.2e1 * t789 * t96 + t500 + t539 + 0.2e1 * t641 - 0.4e1 * t643 - 0.2e1 * t649 - 0.6e1 * t650 + 0.4e1 * t674;
  t803 = my_piecewise3(t1, 0, t758 * t27 / 0.2e1 + 0.3e1 / 0.2e1 * t277 * t102 + 0.3e1 / 0.2e1 * t91 * t299 + t13 * t799 / 0.2e1);
  t804 = -t757;
  t805 = my_piecewise5(t10, 0, t7, 0, t804);
  t816 = t183 * t309;
  t823 = my_piecewise5(t19, 0, t16, 0, t804);
  t826 = t3 * t823 + 0.3e1 * t309;
  t827 = t826 * t75;
  t831 = params->B * t826;
  t835 = t110 * t110;
  t836 = t417 * t835;
  t846 = -0.6e1 * t110 * t318 * t437 + 0.2e1 * t4 * t78 * t827 - t113 * t816 + 0.2e1 * t113 * t836 - 0.2e1 * t260 * t816 + 0.4e1 * t260 * t836 - 0.2e1 * t313 * t315 - 0.4e1 * t315 * t737 + 0.6e1 * t698 * t715 + t76 * t831 + t561 + t600 + 0.2e1 * t711 - 0.4e1 * t713 - 0.2e1 * t719 - 0.6e1 * t720 + 0.4e1 * t744;
  t850 = my_piecewise3(t31, 0, t805 * t41 / 0.2e1 + 0.3e1 / 0.2e1 * t305 * t119 + 0.3e1 / 0.2e1 * t108 * t327 + t33 * t846 / 0.2e1);
  tv3rho33 = 0.3e1 * t303 + 0.3e1 * t331 + t3 * (t803 + t850);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t857 = t2 / t336 / t3;
  t859 = -0.24e2 * t337 + 0.24e2 * t857;
  t860 = my_piecewise5(t7, 0, t10, 0, t859);
  t869 = t143 * t143;
  t870 = 0.1e1 / t869;
  t871 = t870 * t46;
  t872 = t871 * t351;
  t875 = t349 * t129;
  t876 = t875 * t51;
  t883 = t145 * t377;
  t885 = t374 * t51;
  t891 = t370 * t137;
  t894 = my_piecewise5(t16, 0, t19, 0, t859);
  t897 = t3 * t894 + 0.4e1 * t377;
  t906 = t152 * t137;
  t915 = t870 * t4;
  t917 = t915 * t351 * t51;
  t920 = t370 * t351;
  t929 = 0.22e2 * t151 * t872 + 0.28e2 * t151 * t876 - 0.3e1 * t385 * t146 - 0.3e1 * t141 * t362 - t54 * t883 - 0.6e1 * t54 * t885 + 0.8e1 * t222 * t152 * t380 - 0.8e1 * t151 * t891 + 0.2e1 * t58 * t897 * t55 * t4 + 0.6e1 * t141 * t352 + 0.6e1 * t141 * t355 + 0.3e1 * t54 * t906 - 0.28e2 * t222 * t374 * t140 - 0.6e1 * t58 * t381 * t46 - 0.6e1 * t54 * t917 - 0.6e1 * t54 * t920 + 0.12e2 * t58 * t155 * t129 - 0.12e2 * t58 * t59 * t337;
  t932 = t55 * t337;
  t935 = t140 * t140;
  t939 = t144 * t337;
  t947 = t350 * t51 * t137;
  t958 = t4 * t137 * t51;
  t978 = 0.6e1 * t141 * t364 - 0.6e1 * t54 * t932 + 0.6e1 * params->C * t935 * t152 + 0.22e2 * t151 * t939 - 0.3e1 * t385 * t148 + params->B * t897 * t56 + 0.12e2 * t159 * t947 + 0.12e2 * t391 * t352 + 0.12e2 * t391 * t355 + 0.6e1 * t159 * t906 + 0.6e1 * t54 * t349 * t958 - 0.28e2 * t521 * t46 * t140 * t51 - 0.6e1 * t58 * t380 * t146 - 0.6e1 * t391 * t362 - 0.2e1 * t159 * t883 - 0.12e2 * t159 * t917 - 0.12e2 * t159 * t920 - 0.12e2 * t159 * t885;
  t983 = my_piecewise3(t1, 0, t860 * t27 / 0.2e1 + 0.2e1 * t341 * t63 + 0.3e1 * t133 * t165 + 0.2e1 * t49 * t402 + t13 * (t929 + t978) / 0.2e1);
  t984 = -t859;
  t985 = my_piecewise5(t10, 0, t7, 0, t984);
  t998 = t183 * t444;
  t1000 = t441 * t71;
  t1006 = t437 * t175;
  t1009 = my_piecewise5(t19, 0, t16, 0, t984);
  t1012 = t1009 * t3 + 0.4e1 * t444;
  t1021 = t190 * t175;
  t1030 = t181 * t181;
  t1031 = 0.1e1 / t1030;
  t1032 = t1031 * t4;
  t1034 = t1032 * t418 * t71;
  t1037 = t437 * t418;
  t1046 = t1031 * t46;
  t1047 = t1046 * t418;
  t1050 = t416 * t129;
  t1051 = t1050 * t71;
  t1054 = -0.3e1 * t452 * t184 - 0.3e1 * t179 * t429 - t74 * t998 - 0.6e1 * t74 * t1000 + 0.8e1 * t252 * t190 * t447 - 0.8e1 * t189 * t1006 + 0.2e1 * t78 * t1012 * t75 * t4 + 0.6e1 * t179 * t419 + 0.6e1 * t179 * t422 + 0.3e1 * t74 * t1021 - 0.28e2 * t252 * t441 * t178 - 0.6e1 * t78 * t448 * t46 - 0.6e1 * t74 * t1034 - 0.6e1 * t74 * t1037 + 0.12e2 * t78 * t193 * t129 - 0.12e2 * t78 * t79 * t337 + 0.22e2 * t189 * t1047 + 0.28e2 * t189 * t1051;
  t1057 = t75 * t337;
  t1060 = t178 * t178;
  t1064 = t182 * t337;
  t1072 = t417 * t71 * t175;
  t1083 = t4 * t175 * t71;
  t1103 = 0.6e1 * t179 * t431 - 0.6e1 * t74 * t1057 + 0.6e1 * params->C * t1060 * t190 + 0.22e2 * t189 * t1064 - 0.3e1 * t452 * t186 + params->B * t1012 * t76 + 0.12e2 * t197 * t1072 + 0.12e2 * t458 * t419 + 0.12e2 * t458 * t422 + 0.6e1 * t197 * t1021 + 0.6e1 * t74 * t416 * t1083 - 0.28e2 * t582 * t46 * t178 * t71 - 0.6e1 * t78 * t447 * t184 - 0.6e1 * t458 * t429 - 0.2e1 * t197 * t998 - 0.12e2 * t197 * t1034 - 0.12e2 * t197 * t1037 - 0.12e2 * t197 * t1000;
  t1108 = my_piecewise3(t31, 0, t985 * t41 / 0.2e1 + 0.2e1 * t408 * t83 + 0.3e1 * t171 * t203 + 0.2e1 * t69 * t469 + t33 * (t1054 + t1103) / 0.2e1);
  tv4rho40 = 0.4e1 * t406 + 0.4e1 * t473 + t3 * (t983 + t1108);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1113 = 0.12e2 * t337;
  t1114 = 0.24e2 * t857;
  t1115 = -t1113 + t1114;
  t1116 = my_piecewise5(t7, 0, t10, 0, t1115);
  t1138 = t218 * t355;
  t1140 = t96 * t906;
  t1142 = t501 * t526;
  t1144 = t374 * t217;
  t1145 = t222 * t1144;
  t1148 = t58 * t511 * t46;
  t1152 = t96 * t920;
  t1155 = t222 * t939 * t95;
  t1158 = t58 * t226 * t129;
  t1162 = 0.12e2 * t58 * t98 * t337;
  t1163 = t96 * t885;
  t1170 = t152 * t510;
  t1173 = my_piecewise5(t16, 0, t19, 0, t1115);
  t1176 = t1173 * t3 + t377 + 0.3e1 * t507;
  t1181 = 0.2e1 * t1176 * t4 * t55 * t58 + 0.2e1 * t223 * t380 * params->C + 0.6e1 * t1170 * t222 - 0.3e1 * t146 * t515 + 0.6e1 * t218 * t352 - 0.3e1 * t218 * t362 + 0.6e1 * t501 * t504 - t883 * t96 - 0.6e1 * t917 * t96 + 0.6e1 * t1138 + 0.3e1 * t1140 - 0.1e2 * t1142 - 0.18e2 * t1145 - 0.6e1 * t1148 - 0.6e1 * t1152 + 0.22e2 * t1155 + 0.12e2 * t1158 - t1162 - 0.6e1 * t1163;
  t1182 = t218 * t364;
  t1184 = t515 * t148;
  t1189 = 0.6e1 * t96 * t932;
  t1194 = t529 * t355;
  t1196 = t230 * t906;
  t1200 = t501 * t349;
  t1203 = t46 * t217;
  t1204 = t1203 * t51;
  t1207 = t58 * t510;
  t1219 = t230 * t920;
  t1221 = t230 * t885;
  t1223 = t222 * t870;
  t1227 = t129 * t95;
  t1229 = t521 * t1227 * t51;
  t1231 = t1176 * t56 * params->B + 0.22e2 * t1223 * t351 * t522 - 0.8e1 * t137 * t521 * t522 - 0.1e2 * t1200 * t523 - 0.18e2 * t1204 * t521 - 0.6e1 * t1207 * t146 - 0.2e1 * t230 * t883 - 0.12e2 * t230 * t917 + 0.12e2 * t230 * t947 + 0.12e2 * t352 * t529 - 0.6e1 * t362 * t529 + 0.6e1 * t662 * t958 + 0.6e1 * t1182 - 0.3e1 * t1184 - t1189 + 0.12e2 * t1194 + 0.6e1 * t1196 - 0.12e2 * t1219 - 0.12e2 * t1221 + 0.28e2 * t1229;
  t1236 = my_piecewise3(t1, 0, t1116 * t27 / 0.2e1 + 0.3e1 / 0.2e1 * t481 * t63 + 0.3e1 / 0.2e1 * t211 * t165 + t91 * t402 / 0.2e1 + t341 * t102 / 0.2e1 + 0.3e1 / 0.2e1 * t133 * t236 + 0.3e1 / 0.2e1 * t49 * t540 + t13 * (t1181 + t1231) / 0.2e1);
  t1237 = -t1115;
  t1238 = my_piecewise5(t10, 0, t7, 0, t1237);
  t1253 = t576 * t186;
  t1255 = my_piecewise5(t19, 0, t16, 0, t1237);
  t1258 = t1255 * t3 + t444 + 0.3e1 * t568;
  t1261 = t248 * t431;
  t1264 = 0.6e1 * t113 * t1057;
  t1269 = t248 * t422;
  t1271 = t113 * t1021;
  t1273 = t562 * t587;
  t1275 = t441 * t247;
  t1276 = t252 * t1275;
  t1279 = t78 * t572 * t46;
  t1283 = t113 * t1037;
  t1286 = t252 * t1064 * t112;
  t1289 = t78 * t256 * t129;
  t1293 = 0.12e2 * t78 * t115 * t337;
  t1299 = t1258 * t76 * params->B - 0.6e1 * t1034 * t113 + 0.12e2 * t1072 * t260 - t113 * t998 - 0.3e1 * t184 * t576 + 0.6e1 * t248 * t419 - 0.3e1 * t248 * t429 - 0.3e1 * t1253 + 0.6e1 * t1261 - t1264 + 0.6e1 * t1269 + 0.3e1 * t1271 - 0.1e2 * t1273 - 0.18e2 * t1276 - 0.6e1 * t1279 - 0.6e1 * t1283 + 0.22e2 * t1286 + 0.12e2 * t1289 - t1293;
  t1300 = t113 * t1000;
  t1307 = t190 * t571;
  t1316 = t562 * t416;
  t1319 = t46 * t247;
  t1320 = t1319 * t71;
  t1323 = t78 * t571;
  t1333 = t260 * t1000;
  t1335 = t252 * t1031;
  t1339 = t129 * t112;
  t1341 = t582 * t1339 * t71;
  t1345 = t590 * t422;
  t1347 = t260 * t1021;
  t1351 = t260 * t1037;
  t1353 = -0.6e1 * t1300 + 0.2e1 * params->C * t447 * t253 + 0.6e1 * t562 * t565 + 0.6e1 * t252 * t1307 + 0.2e1 * t78 * t1258 * t75 * t4 + 0.6e1 * t732 * t1083 - 0.1e2 * t1316 * t584 - 0.18e2 * t582 * t1320 - 0.6e1 * t1323 * t184 - 0.8e1 * t582 * t583 * t175 - 0.6e1 * t590 * t429 - 0.2e1 * t260 * t998 - 0.12e2 * t1333 + 0.22e2 * t1335 * t583 * t418 + 0.28e2 * t1341 + 0.12e2 * t590 * t419 + 0.12e2 * t1345 + 0.6e1 * t1347 - 0.12e2 * t260 * t1034 - 0.12e2 * t1351;
  t1358 = my_piecewise3(t31, 0, t1238 * t41 / 0.2e1 + 0.3e1 / 0.2e1 * t546 * t83 + 0.3e1 / 0.2e1 * t241 * t203 + t108 * t469 / 0.2e1 + t408 * t119 / 0.2e1 + 0.3e1 / 0.2e1 * t171 * t266 + 0.3e1 / 0.2e1 * t69 * t605 + t33 * (t1299 + t1353) / 0.2e1);
  tv4rho41 = t406 + t473 + 0.3e1 * t544 + 0.3e1 * t609 + t3 * (t1236 + t1358);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1365 = my_piecewise5(t7, 0, t10, 0, t1114);
  t1388 = t628 * t349;
  t1391 = t58 * t635;
  t1403 = t145 * t507;
  t1407 = t521 * t1227 * t93;
  t1409 = t96 * t870;
  t1414 = t46 * t93 * t51;
  t1416 = 0.4e1 * t662 * t1414;
  t1420 = 0.4e1 * t667 * t355;
  t1422 = 0.4e1 * t529 * t640;
  t1423 = t152 * t215;
  t1425 = 0.4e1 * t230 * t1423;
  t1426 = -0.4e1 * t521 * t522 * t215 + 0.4e1 * t218 * t349 * t664 + 0.4e1 * t662 * t4 * t215 * t51 - 0.16e2 * t1388 * t1204 - 0.4e1 * t1391 * t146 + 0.2e1 * t662 * t663 * t137 - 0.2e1 * t667 * t362 - 0.2e1 * t1207 * t287 - 0.4e1 * t529 * t626 - 0.2e1 * t230 * t1403 + 0.6e1 * t1407 - 0.6e1 * t1409 * t663 * t351 - t1416 + 0.4e1 * t667 * t352 + t1420 + t1422 + t1425;
  t1427 = t374 * t93;
  t1428 = t230 * t1427;
  t1440 = 0.2e1 * t652 * t148;
  t1441 = my_piecewise5(t16, 0, t19, 0, t1114);
  t1445 = t1441 * t3 + 0.2e1 * t507 + 0.2e1 * t633;
  t1448 = t285 * t364;
  t1450 = t217 * t217;
  t1454 = t1445 * t56 * params->B + 0.4e1 * t1450 * t152 * params->C + 0.2e1 * t1138 + t1140 - 0.2e1 * t1142 - 0.4e1 * t1145 - 0.2e1 * t1148 - 0.2e1 * t1152 + 0.1e2 * t1155 + 0.8e1 * t1158 - t1162 - 0.4e1 * t1163 + 0.4e1 * t1182 - t1184 - t1189 - 0.4e1 * t1428 - t1440 + 0.2e1 * t1448;
  t1456 = t290 * t939;
  t1458 = t46 * t284;
  t1459 = t1458 * t51;
  t1481 = 0.8e1 * t230 * t370 * t654;
  t1485 = 0.2e1 * t285 * t355;
  t1487 = 0.2e1 * t218 * t640;
  t1489 = 0.2e1 * t96 * t1423;
  t1490 = t628 * t1144;
  t1494 = t290 * t876;
  t1498 = 0.4e1 * t58 * t636 * t46;
  t1499 = t96 * t1427;
  t1502 = t58 * t293 * t129;
  t1504 = 0.4e1 * t137 * t230 * t350 * t93 + 0.8e1 * t215 * t230 * t350 * t51 - 0.12e2 * t230 * t351 * t915 * t93 + 0.1e2 * t1223 * t522 * t654 - 0.6e1 * t1459 * t521 + 0.2e1 * t285 * t352 + 0.12e2 * t290 * t872 + 0.8e1 * t529 * t655 + 0.12e2 * t1456 - t1481 + t1485 + t1487 + t1489 - 0.16e2 * t1490 + 0.16e2 * t1494 - t1498 - 0.2e1 * t1499 + 0.4e1 * t1502;
  t1505 = t152 * t635;
  t1508 = t374 * t284;
  t1509 = t222 * t1508;
  t1535 = t1203 * t93;
  t1538 = 0.4e1 * t222 * t1505 - 0.6e1 * t1509 - 0.2e1 * t652 * t146 - t285 * t362 - t515 * t287 - 0.2e1 * t218 * t626 - t96 * t1403 + 0.4e1 * t628 * t1170 - 0.4e1 * t290 * t891 + 0.2e1 * t58 * t1445 * t55 * t4 + 0.2e1 * t501 * t645 + 0.4e1 * t1194 + 0.2e1 * t1196 - 0.4e1 * t1219 - 0.8e1 * t1221 + 0.6e1 * t1229 - 0.2e1 * t1200 * t659 - 0.4e1 * t521 * t1535;
  t1544 = my_piecewise3(t1, 0, t1365 * t27 / 0.2e1 + t613 * t63 + t277 * t165 / 0.2e1 + t481 * t102 + 0.2e1 * t211 * t236 + t91 * t540 + t133 * t299 / 0.2e1 + t49 * t677 + t13 * (t1426 + t1454 + t1504 + t1538) / 0.2e1);
  t1545 = my_piecewise5(t10, 0, t7, 0, -t1114);
  t1560 = 0.2e1 * t722 * t186;
  t1561 = my_piecewise5(t19, 0, t16, 0, -t1114);
  t1565 = t1561 * t3 + 0.2e1 * t568 + 0.2e1 * t703;
  t1568 = t313 * t431;
  t1570 = t247 * t247;
  t1574 = t318 * t1064;
  t1578 = t1319 * t110;
  t1591 = t698 * t416;
  t1594 = t78 * t705;
  t1602 = -t1253 + 0.4e1 * t1261 - t1264 - t1560 + params->B * t1565 * t76 + 0.2e1 * t1568 + 0.4e1 * params->C * t1570 * t190 + 0.12e2 * t1574 - 0.2e1 * t1316 * t729 - 0.4e1 * t582 * t1578 - 0.4e1 * t582 * t583 * t245 + 0.4e1 * t248 * t416 * t734 + 0.4e1 * t732 * t4 * t245 * t71 - 0.16e2 * t1591 * t1320 - 0.4e1 * t1594 * t184 + 0.2e1 * t732 * t733 * t175 - 0.2e1 * t737 * t429;
  t1607 = t183 * t568;
  t1611 = t582 * t1339 * t110;
  t1613 = t113 * t1031;
  t1618 = t46 * t110 * t71;
  t1620 = 0.4e1 * t732 * t1618;
  t1624 = 0.4e1 * t737 * t422;
  t1626 = 0.4e1 * t590 * t710;
  t1627 = t190 * t245;
  t1629 = 0.4e1 * t260 * t1627;
  t1630 = t441 * t110;
  t1631 = t260 * t1630;
  t1633 = t46 * t312;
  t1634 = t1633 * t71;
  t1656 = 0.8e1 * t260 * t437 * t724;
  t1657 = -0.12e2 * t1032 * t110 * t260 * t418 + 0.4e1 * t110 * t175 * t260 * t417 + 0.8e1 * t245 * t260 * t417 * t71 + 0.1e2 * t1335 * t583 * t724 - 0.6e1 * t1613 * t418 * t733 - 0.2e1 * t1323 * t315 - 0.2e1 * t260 * t1607 - 0.6e1 * t582 * t1634 + 0.4e1 * t737 * t419 - 0.4e1 * t590 * t696 + 0.8e1 * t590 * t725 + 0.6e1 * t1611 - t1620 + t1624 + t1626 + t1629 - 0.4e1 * t1631 - t1656;
  t1670 = 0.2e1 * t313 * t422;
  t1672 = 0.2e1 * t248 * t710;
  t1674 = 0.2e1 * t113 * t1627;
  t1675 = t698 * t1275;
  t1679 = t318 * t1051;
  t1683 = 0.4e1 * t78 * t706 * t46;
  t1684 = 0.12e2 * t318 * t1047 + 0.2e1 * t313 * t419 + 0.2e1 * t1269 + t1271 - 0.2e1 * t1273 - 0.4e1 * t1276 - 0.2e1 * t1279 - 0.2e1 * t1283 + 0.1e2 * t1286 + 0.8e1 * t1289 - t1293 - 0.4e1 * t1300 + t1670 + t1672 + t1674 - 0.16e2 * t1675 + 0.16e2 * t1679 - t1683;
  t1685 = t113 * t1630;
  t1688 = t78 * t321 * t129;
  t1690 = t190 * t705;
  t1693 = t441 * t312;
  t1694 = t252 * t1693;
  t1718 = 0.2e1 * t1565 * t4 * t75 * t78 - 0.4e1 * t318 * t1006 - t113 * t1607 + 0.4e1 * t698 * t1307 + 0.4e1 * t252 * t1690 - 0.2e1 * t722 * t184 - 0.2e1 * t248 * t696 - t313 * t429 - t576 * t315 + 0.2e1 * t562 * t715 - 0.8e1 * t1333 + 0.6e1 * t1341 + 0.4e1 * t1345 + 0.2e1 * t1347 - 0.4e1 * t1351 - 0.2e1 * t1685 + 0.4e1 * t1688 - 0.6e1 * t1694;
  t1724 = my_piecewise3(t31, 0, t1545 * t41 / 0.2e1 + t683 * t83 + t305 * t203 / 0.2e1 + t546 * t119 + 0.2e1 * t241 * t266 + t108 * t605 + t171 * t327 / 0.2e1 + t69 * t747 + t33 * (t1602 + t1657 + t1684 + t1718) / 0.2e1);
  tv4rho42 = 0.2e1 * t544 + 0.2e1 * t609 + 0.2e1 * t681 + 0.2e1 * t751 + t3 * (t1544 + t1724);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1729 = t1113 + t1114;
  t1730 = my_piecewise5(t7, 0, t10, 0, t1729);
  t1745 = t285 * t640;
  t1747 = t152 * t281;
  t1748 = t96 * t1747;
  t1749 = t628 * t1508;
  t1752 = t290 * t875 * t93;
  t1755 = t58 * t780 * t46;
  t1757 = t370 * t788;
  t1758 = t96 * t1757;
  t1760 = t152 * t779;
  t1768 = t145 * t633;
  t1778 = my_piecewise5(t16, 0, t19, 0, t1729);
  t1781 = t1778 * t3 + 0.3e1 * t633 + t776;
  t1789 = 0.2e1 * t1745 + t1748 - 0.12e2 * t1749 + 0.12e2 * t1752 - 0.2e1 * t1755 - 0.2e1 * t1758 + 0.2e1 * t222 * t1760 - 0.2e1 * t652 * t287 - 0.2e1 * t285 * t626 - t218 * t769 - t96 * t1768 + 0.6e1 * params->C * t217 * t645 + 0.6e1 * t628 * t1505 - 0.6e1 * t290 * t370 * t215 + 0.2e1 * t58 * t1781 * t55 * t4 - t784 * t146 + 0.2e1 * t218 * t789;
  t1800 = t784 * t148;
  t1801 = t1781 * t56 * params->B + 0.4e1 * t1155 + 0.4e1 * t1158 - t1162 - 0.2e1 * t1163 + 0.2e1 * t1182 - t1189 + 0.4e1 * t1407 - t1416 + t1420 + t1422 + t1425 - 0.8e1 * t1428 - t1440 + 0.4e1 * t1448 + 0.18e2 * t1456 - t1800;
  t1806 = t4 * t281;
  t1817 = t58 * t779;
  t1837 = t667 * t640;
  t1839 = t230 * t1747;
  t1841 = t230 * t1757;
  t1843 = t1458 * t93;
  t1846 = 0.4e1 * t285 * t349 * t664 + 0.2e1 * t662 * t1806 * t51 - 0.12e2 * t1388 * t1459 - 0.12e2 * t1388 * t1535 + 0.18e2 * t290 * t870 * t1414 - 0.2e1 * t1817 * t146 - 0.6e1 * t1409 * t4 * t788 * t51 + 0.4e1 * t662 * t663 * t215 - 0.4e1 * t1391 * t287 - 0.4e1 * t667 * t626 - 0.2e1 * t529 * t769 - 0.2e1 * t230 * t1768 + 0.4e1 * t529 * t789 + 0.4e1 * t1837 + 0.2e1 * t1839 - 0.4e1 * t1841 - 0.4e1 * t521 * t1843;
  t1873 = 0.8e1 * t215 * t230 * t350 * t93 + 0.4e1 * t230 * t281 * t350 * t51 - 0.12e2 * t230 * t51 * t788 * t915 + 0.4e1 * t1223 * t522 * t788 - 0.2e1 * t281 * t521 * t522 + 0.8e1 * t667 * t655 - 0.4e1 * t1221 - t1481 + t1485 + t1487 + t1489 - 0.12e2 * t1490 + 0.12e2 * t1494 - t1498 - 0.4e1 * t1499 + 0.8e1 * t1502 - 0.4e1 * t1509;
  t1879 = my_piecewise3(t1, 0, t1730 * t27 / 0.2e1 + t758 * t63 / 0.2e1 + 0.3e1 / 0.2e1 * t613 * t102 + 0.3e1 / 0.2e1 * t277 * t236 + 0.3e1 / 0.2e1 * t211 * t299 + 0.3e1 / 0.2e1 * t91 * t677 + t49 * t799 / 0.2e1 + t13 * (t1789 + t1801 + t1846 + t1873) / 0.2e1);
  t1880 = -t1729;
  t1881 = my_piecewise5(t10, 0, t7, 0, t1880);
  t1896 = t190 * t826;
  t1904 = t183 * t703;
  t1914 = my_piecewise5(t19, 0, t16, 0, t1880);
  t1917 = t1914 * t3 + 0.3e1 * t703 + t823;
  t1925 = t313 * t710;
  t1927 = t190 * t309;
  t1928 = t113 * t1927;
  t1929 = t698 * t1693;
  t1932 = t318 * t1050 * t110;
  t1935 = t78 * t827 * t46;
  t1937 = t437 * t835;
  t1938 = t113 * t1937;
  t1940 = 0.2e1 * t252 * t1896 - 0.2e1 * t722 * t315 - 0.2e1 * t313 * t696 - t248 * t816 - t113 * t1904 + 0.6e1 * params->C * t247 * t715 + 0.6e1 * t698 * t1690 - 0.6e1 * t318 * t437 * t245 + 0.2e1 * t78 * t1917 * t75 * t4 - t831 * t184 + 0.2e1 * t248 * t836 + 0.2e1 * t1925 + t1928 - 0.12e2 * t1929 + 0.12e2 * t1932 - 0.2e1 * t1935 - 0.2e1 * t1938;
  t1952 = t831 * t186;
  t1958 = t4 * t309;
  t1962 = 0.4e1 * t260 * t309 * t417 * t71 + t1917 * t76 * params->B + 0.2e1 * t1958 * t71 * t732 + 0.4e1 * t313 * t416 * t734 + 0.8e1 * t737 * t725 + 0.2e1 * t1261 - t1264 - t1560 + 0.4e1 * t1568 + 0.18e2 * t1574 + 0.4e1 * t1611 - t1620 + t1624 + t1626 + t1629 - 0.8e1 * t1631 - t1952;
  t1971 = t78 * t826;
  t1991 = t737 * t710;
  t1993 = t260 * t1927;
  t1995 = t260 * t1937;
  t1997 = t1633 * t110;
  t2006 = -0.12e2 * t1591 * t1634 - 0.12e2 * t1591 * t1578 + 0.18e2 * t318 * t1031 * t1618 - 0.2e1 * t1971 * t184 - 0.6e1 * t1613 * t4 * t835 * t71 + 0.4e1 * t732 * t733 * t245 - 0.4e1 * t1594 * t315 - 0.4e1 * t737 * t696 - 0.2e1 * t590 * t816 - 0.2e1 * t260 * t1904 + 0.4e1 * t590 * t836 + 0.4e1 * t1991 + 0.2e1 * t1993 - 0.4e1 * t1995 - 0.4e1 * t582 * t1997 - 0.2e1 * t582 * t583 * t309 + 0.4e1 * t1335 * t583 * t835;
  t2024 = -0.12e2 * t1032 * t260 * t71 * t835 + 0.8e1 * t110 * t245 * t260 * t417 + 0.4e1 * t1286 + 0.4e1 * t1289 - t1293 - 0.2e1 * t1300 - 0.4e1 * t1333 - t1656 + t1670 + t1672 + t1674 - 0.12e2 * t1675 + 0.12e2 * t1679 - t1683 - 0.4e1 * t1685 + 0.8e1 * t1688 - 0.4e1 * t1694;
  t2030 = my_piecewise3(t31, 0, t1881 * t41 / 0.2e1 + t805 * t83 / 0.2e1 + 0.3e1 / 0.2e1 * t683 * t119 + 0.3e1 / 0.2e1 * t305 * t266 + 0.3e1 / 0.2e1 * t241 * t327 + 0.3e1 / 0.2e1 * t108 * t747 + t69 * t846 / 0.2e1 + t33 * (t1940 + t1962 + t2006 + t2024) / 0.2e1);
  tv4rho43 = 0.3e1 * t681 + 0.3e1 * t751 + t803 + t850 + t3 * (t1879 + t2030);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2036 = 0.24e2 * t337 + 0.24e2 * t857;
  t2037 = my_piecewise5(t7, 0, t10, 0, t2036);
  t2052 = t915 * t788 * t93;
  t2059 = t145 * t776;
  t2066 = my_piecewise5(t16, 0, t19, 0, t2036);
  t2069 = t2066 * t3 + 0.4e1 * t776;
  t2081 = 0.2e1 * t2069 * t4 * t55 * t58 - 0.8e1 * t281 * t290 * t370 + 0.22e2 * t290 * t788 * t871 + 0.8e1 * t628 * t1760 - 0.6e1 * t96 * t2052 - t96 * t2059 - 0.3e1 * t285 * t769 + 0.6e1 * t285 * t789 - 0.3e1 * t784 * t287 - t1162 - t1189 - 0.12e2 * t1428 + 0.6e1 * t1745 + 0.3e1 * t1748 - 0.28e2 * t1749 + 0.28e2 * t1752 - 0.6e1 * t1755 - 0.6e1 * t1758;
  t2087 = t284 * t284;
  t2115 = 0.12e2 * t230 * t281 * t350 * t93 + 0.6e1 * t152 * t2087 * params->C + 0.6e1 * t1806 * t662 * t93 + t2069 * t56 * params->B - 0.28e2 * t1388 * t1843 - 0.6e1 * t1817 * t287 - 0.12e2 * t230 * t2052 - 0.2e1 * t230 * t2059 - 0.6e1 * t667 * t769 + 0.12e2 * t667 * t789 + 0.6e1 * t1448 + 0.22e2 * t1456 - 0.6e1 * t1499 + 0.12e2 * t1502 - 0.3e1 * t1800 + 0.12e2 * t1837 + 0.6e1 * t1839 - 0.12e2 * t1841;
  t2120 = my_piecewise3(t1, 0, t2037 * t27 / 0.2e1 + 0.2e1 * t758 * t102 + 0.3e1 * t277 * t299 + 0.2e1 * t91 * t799 + t13 * (t2081 + t2115) / 0.2e1);
  t2121 = -t2036;
  t2122 = my_piecewise5(t10, 0, t7, 0, t2121);
  t2135 = t183 * t823;
  t2142 = my_piecewise5(t19, 0, t16, 0, t2121);
  t2145 = t2142 * t3 + 0.4e1 * t823;
  t2156 = t1032 * t835 * t110;
  t2167 = 0.2e1 * t2145 * t4 * t75 * t78 + 0.22e2 * t1046 * t318 * t835 - 0.8e1 * t309 * t318 * t437 - t113 * t2135 - 0.6e1 * t113 * t2156 + 0.8e1 * t698 * t1896 - 0.3e1 * t313 * t816 + 0.6e1 * t313 * t836 - 0.3e1 * t831 * t315 - t1264 + 0.6e1 * t1568 + 0.22e2 * t1574 + 0.6e1 * t1925 + 0.3e1 * t1928 - 0.28e2 * t1929 + 0.28e2 * t1932 - 0.6e1 * t1935 - 0.6e1 * t1938;
  t2171 = t312 * t312;
  t2200 = 0.12e2 * t110 * t260 * t309 * t417 + 0.6e1 * t110 * t1958 * t732 + 0.6e1 * t190 * t2171 * params->C + t2145 * t76 * params->B - 0.28e2 * t1591 * t1997 - 0.6e1 * t1971 * t315 - 0.2e1 * t260 * t2135 - 0.12e2 * t260 * t2156 - 0.6e1 * t737 * t816 + 0.12e2 * t737 * t836 - t1293 - 0.12e2 * t1631 - 0.6e1 * t1685 + 0.12e2 * t1688 - 0.3e1 * t1952 + 0.12e2 * t1991 + 0.6e1 * t1993 - 0.12e2 * t1995;
  t2205 = my_piecewise3(t31, 0, t2122 * t41 / 0.2e1 + 0.2e1 * t805 * t119 + 0.3e1 * t305 * t327 + 0.2e1 * t108 * t846 + t33 * (t2167 + t2200) / 0.2e1);
  tv4rho44 = 0.4e1 * t803 + 0.4e1 * t850 + t3 * (t2120 + t2205);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t7, t9, t11, t16;
  double tzk0;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = 0.1e1 <= p->zeta_threshold;
  t4 = p->zeta_threshold - 0.1e1;
  t6 = my_piecewise5(t3, t4, t3, -t4, 0);
  t7 = 0.1e1 + t6;
  t9 = log(t7 * rho[0]);
  t11 = t9 * t9;
  t16 = my_piecewise3(t2, 0, t7 * (params->C * t11 + params->B * t9 + params->A) / 0.2e1);
  tzk0 = 0.2e1 * t16;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t7, t9, t11, t16;
  double tzk0;

  double t17, t19, t25, tvrho0;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = 0.1e1 <= p->zeta_threshold;
  t4 = p->zeta_threshold - 0.1e1;
  t6 = my_piecewise5(t3, t4, t3, -t4, 0);
  t7 = 0.1e1 + t6;
  t9 = log(t7 * rho[0]);
  t11 = t9 * t9;
  t16 = my_piecewise3(t2, 0, t7 * (params->C * t11 + params->B * t9 + params->A) / 0.2e1);
  tzk0 = 0.2e1 * t16;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t17 = 0.1e1 / rho[0];
  t19 = params->C * t9;
  t25 = my_piecewise3(t2, 0, t7 * (0.2e1 * t19 * t17 + params->B * t17) / 0.2e1);
  tvrho0 = 0.2e1 * rho[0] * t25 + 0.2e1 * t16;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t7, t9, t11, t16;
  double tzk0;

  double t17, t19, t25, tvrho0;

  double t29, t30, t39, tv2rho20;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = 0.1e1 <= p->zeta_threshold;
  t4 = p->zeta_threshold - 0.1e1;
  t6 = my_piecewise5(t3, t4, t3, -t4, 0);
  t7 = 0.1e1 + t6;
  t9 = log(t7 * rho[0]);
  t11 = t9 * t9;
  t16 = my_piecewise3(t2, 0, t7 * (params->C * t11 + params->B * t9 + params->A) / 0.2e1);
  tzk0 = 0.2e1 * t16;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t17 = 0.1e1 / rho[0];
  t19 = params->C * t9;
  t25 = my_piecewise3(t2, 0, t7 * (0.2e1 * t19 * t17 + params->B * t17) / 0.2e1);
  tvrho0 = 0.2e1 * rho[0] * t25 + 0.2e1 * t16;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t29 = rho[0] * rho[0];
  t30 = 0.1e1 / t29;
  t39 = my_piecewise3(t2, 0, t7 * (-0.2e1 * t19 * t30 - params->B * t30 + 0.2e1 * params->C * t30) / 0.2e1);
  tv2rho20 = 0.2e1 * rho[0] * t39 + 0.4e1 * t25;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t7, t9, t11, t16;
  double tzk0;

  double t17, t19, t25, tvrho0;

  double t29, t30, t39, tv2rho20;

  double t44, t54, tv3rho30;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = 0.1e1 <= p->zeta_threshold;
  t4 = p->zeta_threshold - 0.1e1;
  t6 = my_piecewise5(t3, t4, t3, -t4, 0);
  t7 = 0.1e1 + t6;
  t9 = log(t7 * rho[0]);
  t11 = t9 * t9;
  t16 = my_piecewise3(t2, 0, t7 * (params->C * t11 + params->B * t9 + params->A) / 0.2e1);
  tzk0 = 0.2e1 * t16;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t17 = 0.1e1 / rho[0];
  t19 = params->C * t9;
  t25 = my_piecewise3(t2, 0, t7 * (0.2e1 * t19 * t17 + params->B * t17) / 0.2e1);
  tvrho0 = 0.2e1 * rho[0] * t25 + 0.2e1 * t16;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t29 = rho[0] * rho[0];
  t30 = 0.1e1 / t29;
  t39 = my_piecewise3(t2, 0, t7 * (-0.2e1 * t19 * t30 - params->B * t30 + 0.2e1 * params->C * t30) / 0.2e1);
  tv2rho20 = 0.2e1 * rho[0] * t39 + 0.4e1 * t25;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t44 = 0.1e1 / t29 / rho[0];
  t54 = my_piecewise3(t2, 0, t7 * (0.4e1 * t19 * t44 + 0.2e1 * params->B * t44 - 0.6e1 * params->C * t44) / 0.2e1);
  tv3rho30 = 0.2e1 * rho[0] * t54 + 0.6e1 * t39;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t7, t9, t11, t16;
  double tzk0;

  double t17, t19, t25, tvrho0;

  double t29, t30, t39, tv2rho20;

  double t44, t54, tv3rho30;

  double t58, t59, t69, tv4rho40;

  lda_k_gds08_params *params;

  assert(p->params != NULL);
  params = (lda_k_gds08_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = 0.1e1 <= p->zeta_threshold;
  t4 = p->zeta_threshold - 0.1e1;
  t6 = my_piecewise5(t3, t4, t3, -t4, 0);
  t7 = 0.1e1 + t6;
  t9 = log(t7 * rho[0]);
  t11 = t9 * t9;
  t16 = my_piecewise3(t2, 0, t7 * (params->C * t11 + params->B * t9 + params->A) / 0.2e1);
  tzk0 = 0.2e1 * t16;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t17 = 0.1e1 / rho[0];
  t19 = params->C * t9;
  t25 = my_piecewise3(t2, 0, t7 * (0.2e1 * t19 * t17 + params->B * t17) / 0.2e1);
  tvrho0 = 0.2e1 * rho[0] * t25 + 0.2e1 * t16;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t29 = rho[0] * rho[0];
  t30 = 0.1e1 / t29;
  t39 = my_piecewise3(t2, 0, t7 * (-0.2e1 * t19 * t30 - params->B * t30 + 0.2e1 * params->C * t30) / 0.2e1);
  tv2rho20 = 0.2e1 * rho[0] * t39 + 0.4e1 * t25;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t44 = 0.1e1 / t29 / rho[0];
  t54 = my_piecewise3(t2, 0, t7 * (0.4e1 * t19 * t44 + 0.2e1 * params->B * t44 - 0.6e1 * params->C * t44) / 0.2e1);
  tv3rho30 = 0.2e1 * rho[0] * t54 + 0.6e1 * t39;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t58 = t29 * t29;
  t59 = 0.1e1 / t58;
  t69 = my_piecewise3(t2, 0, t7 * (-0.12e2 * t19 * t59 - 0.6e1 * params->B * t59 + 0.22e2 * params->C * t59) / 0.2e1);
  tv4rho40 = 0.2e1 * rho[0] * t69 + 0.8e1 * t54;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif

