/* 
  This file was generated automatically with ./scripts/math2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Mathematica source: ./mathematica/functionals/gga_x_c09x.m
  Type of functional: work_gga_x
*/

void XC(math2c_gga_x_c09x_enhance)
  (const XC(func_type) *p, int order, 
   FLOAT x, FLOAT *f, FLOAT *dfdx, FLOAT *d2fdx2, FLOAT *d3fdx3)
{


  if(order < 0) return;

  *f = 1. + (1. - EXP(-0.5*alpha*POW(x,2)*POW(X2S,2)))*kappa + (mu*POW(x,2)*POW(X2S,2))/EXP(alpha*POW(x,2)*POW(X2S,2));

  if(order < 1) return;

  *dfdx = x*POW(X2S,2)*((1.*alpha*kappa)/EXP(0.5*alpha*POW(x,2)*POW(X2S,2)) + (2*mu)/EXP(alpha*POW(x,2)*POW(X2S,2)) - (2*alpha*mu*POW(x,2)*POW(X2S,2))/EXP(alpha*POW(x,2)*POW(X2S,2)));

  if(order < 2) return;

  *d2fdx2 = POW(X2S,2)*((2.*mu)/EXP(1.*alpha*POW(x,2)*POW(X2S,2)) + alpha*((1.*kappa)/EXP(0.5*alpha*POW(x,2)*POW(X2S,2)) - (10.*mu*POW(x,2)*POW(X2S,2))/EXP(1.*alpha*POW(x,2)*POW(X2S,2))) + POW(alpha,2)*((-1.*kappa*POW(x,2)*POW(X2S,2))/EXP(0.5*alpha*POW(x,2)*POW(X2S,2)) + (4.*mu*POW(x,4)*POW(X2S,4))/EXP(1.*alpha*POW(x,2)*POW(X2S,2))));

  if(order < 3) return;

  *d3fdx3 = alpha*x*POW(X2S,4)*((-24.*mu)/EXP(1.*alpha*POW(x,2)*POW(X2S,2)) + alpha*((-3.*kappa)/EXP(0.5*alpha*POW(x,2)*POW(X2S,2)) + (36.*mu*POW(x,2)*POW(X2S,2))/EXP(1.*alpha*POW(x,2)*POW(X2S,2))) + POW(alpha,2)*((1.*kappa*POW(x,2)*POW(X2S,2))/EXP(0.5*alpha*POW(x,2)*POW(X2S,2)) - (8.*mu*POW(x,4)*POW(X2S,4))/EXP(1.*alpha*POW(x,2)*POW(X2S,2))));
}


#define math2c_order 3
#define math2c_func  XC(math2c_gga_x_c09x_enhance)

