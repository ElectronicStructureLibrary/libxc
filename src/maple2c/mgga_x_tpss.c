/* 
  This file was generated automatically with ../scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Maple source      : ../maple/mgga_x_tpss.mpl
  Type of functional: work_mgga_x
*/

static void 
XC(mgga_x_tpss_enhance)(const XC(func_type) *pt, XC(mgga_work_x_t) *r)
{
  double t1, t2, t3, t4, t5, t8, t9, t10;
  double t11, t12, t13, t14, t16, t17, t18, t21;
  double t22, t24, t25, t28, t29, t30, t34, t35;
  double t36, t39, t41, t42, t45, t46, t48, t49;
  double t52, t54, t56, t57, t60, t61, t62, t65;
  double t66, t68, t69, t70, t72, t77, t78, t80;
  double t81, t82, t89, t93, t94, t95, t96, t100;
  double t104, t108, t109, t113, t117, t121, t126, t127;
  double t128, t130, t132, t143, t146, t147, t148, t151;
  double t152, t157, t160, t162, t163, t167, t172, t184;
  double t187, t192, t197, t201, t202, t205, t208, t218;
  double t221, t222, t224, t225, t239, t246, t249, t250;
  double t263, t268, t273, t274, t277, t279, t291, t296;
  double t297, t307, t311, t324, t327, t330, t340, t342;
  double t345, t357, t362, t368, t431, t444;

  mgga_x_tpss_params *params;
 
  assert(pt->params != NULL);
  params = (mgga_x_tpss_params * ) (pt->params);

  t1 = r->x * r->x;
  t2 = 0.1e1 / r->t;
  t3 = t1 * t2;
  t4 = 0.12500000000000000000e0 * t3;
  t5 = params->BLOC_b * t1;
  t8 = params->BLOC_a + 0.12500000000000000000e0 * t5 * t2;
  t9 = pow(t4, t8);
  t10 = params->c * t9;
  t11 = t1 * t1;
  t12 = r->t * r->t;
  t13 = 0.1e1 / t12;
  t14 = t11 * t13;
  t16 = 0.10e1 + 0.15625000000000000000e-1 * t14;
  t17 = t16 * t16;
  t18 = 0.1e1 / t17;
  t21 = X2S * X2S;
  t22 = (t10 * t18 + MU_GE) * t21;
  t24 = 0.10e1 - t4;
  t25 = t21 * t24;
  t28 = 0.13333333333333333334e2 * t25 * r->t - 0.10e1;
  t29 = params->b * t21;
  t30 = t24 * r->t;
  t34 = 0.10e1 + 0.13333333333333333334e2 * t29 * t30 * t28;
  t35 = sqrt(t34);
  t36 = 0.1e1 / t35;
  t39 = t21 * t1;
  t41 = 0.45000000000000000000e0 * t28 * t36 + 0.66666666666666666667e0 * t39;
  t42 = t41 * t41;
  t45 = t21 * t21;
  t46 = t45 * t11;
  t48 = 0.28125000000000000000e-2 * t14 + 0.5e0 * t46;
  t49 = sqrt(t48);
  t52 = MU_GE * MU_GE;
  t54 = t52 / params->kappa;
  t56 = sqrt(params->e);
  t57 = t56 * MU_GE;
  t60 = params->e * params->mu;
  t61 = t45 * t21;
  t62 = t11 * t1;
  t65 = t22 * t1 + 0.72098765432098765432e-1 * t42 - 0.18024691358024691358e0 * t41 * t49 + t54 * t46 + 0.11250000000000000000e-1 * t57 * t14 + t60 * t61 * t62;
  t66 = t56 * t21;
  t68 = 0.10e1 + t66 * t1;
  t69 = t68 * t68;
  t70 = 0.1e1 / t69;
  t72 = t65 * t70 + params->kappa;
  r->f = 0.10e1 + params->kappa * (0.10e1 - params->kappa / t72);

  if(r->order < 1) return;

  r->dfdrs = 0;
  t77 = params->kappa * params->kappa;
  t78 = t72 * t72;
  t80 = t77 / t78;
  t81 = params->BLOC_b * r->x;
  t82 = log(t4);
  t89 = 0.25000000000000000000e0 * t81 * t2 * t82 + 0.20000000000000000000e1 * t8 / r->x;
  t93 = 0.1e1 / t17 / t16;
  t94 = t1 * r->x;
  t95 = t93 * t94;
  t96 = t95 * t13;
  t100 = (t10 * t89 * t18 - 0.12500000000000000000e0 * t10 * t96) * t21;
  t104 = t21 * r->x;
  t108 = 0.1e1 / t35 / t34;
  t109 = t28 * t108;
  t113 = params->b * t45;
  t117 = -0.33333333333333333335e1 * t29 * r->x * t28 - 0.44444444444444444449e2 * t113 * t30 * r->x;
  t121 = -0.15000000000000000001e1 * t104 * t36 - 0.22500000000000000000e0 * t109 * t117 + 0.13333333333333333333e1 * t104;
  t126 = 0.1e1 / t49;
  t127 = t41 * t126;
  t128 = t94 * t13;
  t130 = t45 * t94;
  t132 = 0.11250000000000000000e-1 * t128 + 0.20e1 * t130;
  t143 = t100 * t1 + 0.2e1 * t22 * r->x + 0.14419753086419753086e0 * t41 * t121 - 0.18024691358024691358e0 * t121 * t49 - 0.90123456790123456790e-1 * t127 * t132 + 0.4e1 * t54 * t130 + 0.45000000000000000000e-1 * t57 * t128 + 0.6e1 * t60 * t61 * t11 * r->x;
  t146 = 0.1e1 / t69 / t68;
  t147 = t65 * t146;
  t148 = t66 * r->x;
  t151 = t143 * t70 - 0.4e1 * t147 * t148;
  r->dfdx = t80 * t151;
  t152 = t13 * t82;
  t157 = -0.12500000000000000000e0 * t5 * t152 - 0.10000000000000000000e1 * t8 * t2;
  t160 = t93 * t11;
  t162 = 0.1e1 / t12 / r->t;
  t163 = t160 * t162;
  t167 = (t10 * t157 * t18 + 0.62500000000000000000e-1 * t10 * t163) * t21;
  t172 = 0.16666666666666666668e1 * t39 * t2 + 0.13333333333333333334e2 * t25;
  t184 = 0.16666666666666666668e1 * t29 * t3 * t28 + 0.13333333333333333334e2 * t29 * t24 * t28 + 0.13333333333333333334e2 * t29 * t30 * t172;
  t187 = 0.45000000000000000000e0 * t172 * t36 - 0.22500000000000000000e0 * t109 * t184;
  t192 = t11 * t162;
  t197 = t167 * t1 + 0.14419753086419753086e0 * t41 * t187 - 0.18024691358024691358e0 * t187 * t49 + 0.50694444444444444444e-3 * t127 * t192 - 0.22500000000000000000e-1 * t57 * t192;
  r->dfdt = t80 * t197 * t70;
  r->dfdu = 0;

  if(r->order < 2) return;

  r->d2fdrs2 = 0;
  t201 = t77 / t78 / t72;
  t202 = t151 * t151;
  t205 = t89 * t89;
  t208 = params->BLOC_b * t2;
  t218 = t10 * t89;
  t221 = t17 * t17;
  t222 = 0.1e1 / t221;
  t224 = t12 * t12;
  t225 = 0.1e1 / t224;
  t239 = t121 * t121;
  t246 = t34 * t34;
  t249 = t28 / t35 / t246;
  t250 = t117 * t117;
  t263 = -0.15000000000000000001e1 * t21 * t36 + 0.15000000000000000001e1 * t104 * t108 * t117 + 0.33750000000000000000e0 * t249 * t250 - 0.22500000000000000000e0 * t109 * (-0.33333333333333333335e1 * t29 * t28 + 0.22222222222222222224e2 * t113 * t1 - 0.44444444444444444449e2 * t113 * t30) + 0.13333333333333333333e1 * t21;
  t268 = t121 * t126;
  t273 = t41 / t49 / t48;
  t274 = t132 * t132;
  t277 = t1 * t13;
  t279 = t45 * t1;
  t291 = (t10 * t205 * t18 + t10 * (0.25000000000000000000e0 * t208 * t82 + 0.10000000000000000000e1 * t208 - 0.20000000000000000000e1 * t8 / t1) * t18 - 0.25000000000000000000e0 * t218 * t96 + 0.23437500000000000000e-1 * t10 * t222 * t62 * t225 - 0.37500000000000000000e0 * t10 * t93 * t1 * t13) * t21 * t1 + 0.4e1 * t100 * r->x + 0.2e1 * t22 + 0.14419753086419753086e0 * t239 + 0.14419753086419753086e0 * t41 * t263 - 0.18024691358024691358e0 * t263 * t49 - 0.18024691358024691358e0 * t268 * t132 + 0.45061728395061728395e-1 * t273 * t274 - 0.90123456790123456790e-1 * t127 * (0.33750000000000000000e-1 * t277 + 0.60e1 * t279) + 0.12e2 * t54 * t279 + 0.13500000000000000000e0 * t57 * t277 + 0.30e2 * t60 * t61 * t11;
  t296 = t69 * t69;
  t297 = 0.1e1 / t296;
  r->d2fdx2 = -0.2e1 * t201 * t202 + t80 * (0.24e2 * t65 * t297 * params->e * t45 * t1 - 0.8e1 * t143 * t146 * t148 - 0.4e1 * t147 * t66 + t291 * t70);
  t307 = t197 * t197;
  t311 = t157 * t157;
  t324 = t10 * t157;
  t327 = t11 * t11;
  t330 = 0.1e1 / t224 / t12;
  t340 = t187 * t187;
  t342 = t172 * t108;
  t345 = t184 * t184;
  t357 = -0.45000000000000000000e0 * t342 * t184 + 0.33750000000000000000e0 * t249 * t345 - 0.22500000000000000000e0 * t109 * (0.33333333333333333336e1 * t29 * t3 * t172 + 0.26666666666666666668e2 * t29 * t24 * t172);
  t362 = t187 * t126;
  t368 = t11 * t225;
  r->d2fdt2 = -0.2e1 * t201 * t307 * t297 + t80 * ((t10 * t311 * t18 + t10 * (0.25000000000000000000e0 * t5 * t162 * t82 + 0.25000000000000000000e0 * t5 * t162 + 0.10000000000000000000e1 * t8 * t13) * t18 + 0.12500000000000000000e0 * t324 * t163 + 0.58593750000000000000e-2 * t10 * t222 * t327 * t330 - 0.18750000000000000000e0 * t10 * t160 * t225) * t21 * t1 + 0.14419753086419753086e0 * t340 + 0.14419753086419753086e0 * t41 * t357 - 0.18024691358024691358e0 * t357 * t49 + 0.10138888888888888889e-2 * t362 * t192 + 0.14257812500000000000e-5 * t273 * t327 * t330 - 0.15208333333333333333e-2 * t127 * t368 + 0.67500000000000000000e-1 * t57 * t368) * t70;
  r->d2fdu2 = 0;
  r->d2fdrsx = 0;
  r->d2fdrst = 0;
  r->d2fdrsu = 0;
  t431 = 0.75000000000000000005e0 * t104 * t108 * t184 - 0.22500000000000000000e0 * t342 * t117 + 0.33750000000000000000e0 * t249 * t117 * t184 - 0.22500000000000000000e0 * t109 * (-0.33333333333333333335e1 * t29 * r->x * t172 - 0.55555555555555555561e1 * t113 * t94 * t2 - 0.44444444444444444449e2 * t113 * t24 * r->x);
  t444 = t94 * t162;
  r->d2fdxt = -0.2e1 * t201 * t151 * t197 * t70 + t80 * (((t10 * t157 * t89 * t18 + t10 * (-0.25000000000000000000e0 * t81 * t152 - 0.50000000000000000000e0 * t81 * t13) * t18 + 0.62500000000000000000e-1 * t218 * t163 - 0.12500000000000000000e0 * t324 * t96 - 0.11718750000000000000e-1 * t10 * t222 * t11 * t94 / t224 / r->t + 0.25000000000000000000e0 * t10 * t95 * t162) * t21 * t1 + 0.2e1 * t167 * r->x + 0.14419753086419753086e0 * t187 * t121 + 0.14419753086419753086e0 * t41 * t431 - 0.18024691358024691358e0 * t431 * t49 + 0.50694444444444444444e-3 * t268 * t192 - 0.90123456790123456790e-1 * t362 * t132 - 0.25347222222222222222e-3 * t273 * t132 * t11 * t162 + 0.20277777777777777778e-2 * t127 * t444 - 0.90000000000000000000e-1 * t57 * t444) * t70 - 0.4e1 * t197 * t146 * t148);
  r->d2fdxu = 0;
  r->d2fdtu = 0;

  if(r->order < 3) return;


}

#define maple2c_order 3
#define maple2c_func  XC(mgga_x_tpss_enhance)
