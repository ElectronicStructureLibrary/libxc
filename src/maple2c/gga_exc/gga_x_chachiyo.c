/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_chachiyo.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t316, t317, t318, t319, t321;
  double t324, t326, t327, t331, t339, t340, t341, t348;
  double t352, t353, t363, t364, t365, t366, t368, t372;
  double t377, t384, t389, t390, t391, t394, t395, t400;
  double t401, t402, t403, t406, t407, t408, t409, t412;
  double t415, t416, t417, t420, t421, t424, t427, t430;
  double t438, t440, tv3rho30, t448, t453, t459, t462, t463;
  double t465, t466, t480, t487, t499, t501, t504, t509;
  double t510, t516, t518, t519, t523, t526, t527, t530;
  double t531, t536, t537, t539, t542, t545, t546, t549;
  double t553, t566, t568, tv3rho2sigma0, t575, t578, t583, t586;
  double t587, t589, t592, t595, t598, t613, t629, t630;
  double t634, t643, t644, t645, t648, t651, t652, t653;
  double t656, t659, t662, t664, t667, t674, t677, t679;
  double tv3rhosigma20, t682, t685, t690, t691, t693, t696, t698;
  double t700, t703, t704, t705, t708, t709, t721, t724;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * t22;
  t314 = 0.1e1 / t23 / t312;
  t315 = t17 * t314;
  t316 = t80 * t80;
  t317 = 0.1e1 / t316;
  t318 = t41 * t317;
  t319 = t315 * t318;
  t321 = t46 * t261 * t21;
  t324 = t140 * rho[0];
  t326 = 0.1e1 / t19 / t324;
  t327 = t17 * t326;
  t331 = t72 * t173;
  t339 = 0.1e1 / t140;
  t340 = t17 * t339;
  t341 = t340 * t41;
  t348 = t134 * t72;
  t352 = 0.1e1 / t23 / t324;
  t353 = sigma[0] * t352;
  t363 = t29 * M_PI;
  t364 = t363 * t261;
  t365 = t140 * t57;
  t366 = 0.1e1 / t365;
  t368 = 0.1e1 / t154 / t38;
  t372 = -0.4928e4 / 0.2187e4 * t21 * t353 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t353 * t155 - 0.1024e4 / 0.59049e5 * t364 * t366 * t368;
  t377 = t78 * t159;
  t384 = t327 * t187;
  t389 = -0.128e3 / 0.243e3 * t319 * t321 + 0.32e2 / 0.27e2 * t327 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t331 * t177 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t341 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t348 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t372 * t47 - t377 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + 0.32e2 / 0.243e3 * t384 * t194 + 0.16e2 / 0.243e3 * t384 * t197;
  t390 = t72 * t81;
  t391 = t171 * t390;
  t394 = t72 * t45;
  t395 = t171 * t394;
  t400 = t315 * t174;
  t401 = t87 * t261;
  t402 = t21 * t68;
  t403 = t401 * t402;
  t406 = t315 * t180;
  t407 = t190 * t261;
  t408 = t21 * t155;
  t409 = t407 * t408;
  t412 = t401 * t408;
  t415 = t315 * t187;
  t416 = t86 * t86;
  t417 = 0.1e1 / t416;
  t420 = t368 * t3 * t20;
  t421 = t417 * t261 * t420;
  t424 = t407 * t420;
  t427 = t401 * t420;
  t430 = t327 * t180;
  t438 = -0.16e2 / 0.81e2 * t391 * t184 - 0.16e2 / 0.243e3 * t395 * t194 - 0.8e1 / 0.243e3 * t395 * t197 - 0.128e3 / 0.729e3 * t400 * t403 - 0.128e3 / 0.2187e4 * t406 * t409 - 0.64e2 / 0.2187e4 * t406 * t412 - 0.128e3 / 0.6561e4 * t415 * t421 - 0.128e3 / 0.6561e4 * t415 * t424 - 0.128e3 / 0.19683e5 * t415 * t427 + 0.32e2 / 0.81e2 * t430 * t184 - 0.43e2 / 0.27e2 * t341 * t83 + 0.5e1 / 0.3e1 * t348 * t83 - t377 * t83;
  t440 = my_piecewise3(t2, 0, t389 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t448 = t232 * t394;
  t453 = t104 * t173;
  t459 = t232 * t390;
  t462 = t17 * t352;
  t463 = t462 * t318;
  t465 = t20 * t32;
  t466 = t46 * t3 * t465;
  t480 = t110 * t159;
  t487 = t134 * t104;
  t499 = 0.1e1 / t312;
  t501 = t368 * t32;
  t504 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t363 * t499 * t501;
  t509 = -0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t448 * t250 + 0.2e1 / 0.243e3 * t448 * t254 - 0.16e2 / 0.81e2 * t171 * t453 * t177 - 0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t459 * t241 + 0.16e2 / 0.81e2 * t463 * t466 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t480 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t487 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t504 * t47;
  t510 = t78 * t217;
  t516 = t462 * t187;
  t518 = t21 * t32;
  t519 = t190 * t368 * t518;
  t523 = t87 * t368 * t518;
  t526 = t104 * t81;
  t527 = t171 * t526;
  t530 = t104 * t45;
  t531 = t171 * t530;
  t536 = t462 * t174;
  t537 = t87 * t3;
  t539 = t537 * t465 * t68;
  t542 = t462 * t180;
  t545 = t20 * t155 * t32;
  t546 = t190 * t3 * t545;
  t549 = t537 * t545;
  t553 = t417 * t368 * t518;
  t566 = -0.2e1 / 0.9e1 * t510 * t90 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.16e2 / 0.2187e4 * t516 * t519 + 0.16e2 / 0.6561e4 * t516 * t523 - 0.16e2 / 0.243e3 * t527 * t184 - 0.16e2 / 0.729e3 * t531 * t194 - 0.8e1 / 0.729e3 * t531 * t197 + 0.16e2 / 0.243e3 * t536 * t539 + 0.16e2 / 0.729e3 * t542 * t546 + 0.8e1 / 0.729e3 * t542 * t549 + 0.16e2 / 0.2187e4 * t516 * t553 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t487 * t83 - 0.2e1 / 0.3e1 * t510 * t83 - t164 * t112 / 0.4e1 + t480 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t509 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t575 = t78 * t272;
  t578 = t110 * t217;
  t583 = t282 * t331;
  t586 = t17 * t142;
  t587 = t586 * t318;
  t589 = t46 * t99 * t21;
  t592 = t232 * t526;
  t595 = t232 * t174;
  t598 = t232 * t530;
  t613 = -t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2 - t575 * t83 / 0.3e1 + t578 * t112 / 0.4e1 - t229 * t293 / 0.16e2 - t583 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t587 * t589 + 0.4e1 / 0.81e2 * t592 * t241 + t595 * t285 / 0.36e2 + 0.4e1 / 0.243e3 * t598 * t250 + 0.2e1 / 0.243e3 * t598 * t254 + t79 * t302 / 0.48e2 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 - t575 * t90 / 0.9e1;
  t629 = t363 * t99;
  t630 = 0.1e1 / t324;
  t634 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t629 * t630 * t368;
  t643 = t586 * t174;
  t644 = t87 * t99;
  t645 = t644 * t402;
  t648 = t282 * t390;
  t651 = t586 * t180;
  t652 = t190 * t99;
  t653 = t652 * t408;
  t656 = t644 * t408;
  t659 = t282 * t394;
  t662 = t586 * t187;
  t664 = t417 * t99 * t420;
  t667 = t652 * t420;
  t674 = t644 * t420;
  t677 = 0.4e1 / 0.27e2 * t232 * t104 * t235 + t578 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t634 * t47 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3 - 0.2e1 / 0.81e2 * t643 * t645 - t648 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t651 * t653 - t651 * t656 / 0.243e3 - t659 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t662 * t664 - 0.2e1 / 0.729e3 * t662 * t667 + t248 * t305 / 0.648e3 - t659 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t662 * t674;
  t679 = my_piecewise3(t2, 0, t613 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t282 * t453;
  t690 = t17 * t59;
  t691 = t690 * t318;
  t693 = t46 * t262 * t21;
  t696 = sigma[0] * sigma[0];
  t698 = 0.1e1 / t32 / t696;
  t700 = t88 * t698 * t68;
  t703 = 0.1e1 / t696;
  t704 = t190 * t703;
  t705 = t704 * t193;
  t708 = t87 * t703;
  t709 = t708 * t183;
  t721 = t339 * t368;
  t724 = t64 * t698 * t34 * t68 / 0.36e2 + t153 * t703 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t363 * t262 * t721;
  t733 = t82 * t698;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 - t685 * t285 / 0.12e2 - t277 * t302 / 0.16e2 + t691 * t693 / 0.36e2 + t111 * t700 / 0.32e2 + t296 * t705 / 0.216e3 + t288 * t709 / 0.72e2 - 0.3e1 / 0.8e1 * t18 * t19 * t724 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t733;
  t737 = t282 * t526;
  t740 = t282 * t530;
  t746 = t46 * t703 * t31;
  t749 = t690 * t174;
  t750 = t87 * t262;
  t751 = t750 * t402;
  t754 = t690 * t180;
  t755 = t190 * t262;
  t756 = t755 * t408;
  t759 = t750 * t408;
  t762 = t690 * t187;
  t764 = t417 * t262 * t420;
  t767 = t755 * t420;
  t770 = t708 * t193;
  t773 = t750 * t420;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t316, t317, t318, t319, t321;
  double t324, t326, t327, t331, t339, t340, t341, t348;
  double t352, t353, t363, t364, t365, t366, t368, t372;
  double t377, t384, t389, t390, t391, t394, t395, t400;
  double t401, t402, t403, t406, t407, t408, t409, t412;
  double t415, t416, t417, t420, t421, t424, t427, t430;
  double t438, t440, tv3rho30, t448, t453, t459, t462, t463;
  double t465, t466, t480, t487, t499, t501, t504, t509;
  double t510, t516, t518, t519, t523, t526, t527, t530;
  double t531, t536, t537, t539, t542, t545, t546, t549;
  double t553, t566, t568, tv3rho2sigma0, t575, t578, t583, t586;
  double t587, t589, t592, t595, t598, t613, t629, t630;
  double t634, t643, t644, t645, t648, t651, t652, t653;
  double t656, t659, t662, t664, t667, t674, t677, t679;
  double tv3rhosigma20, t682, t685, t690, t691, t693, t696, t698;
  double t700, t703, t704, t705, t708, t709, t721, t724;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;

  double t781, t784, t787, t788, t791, t794, t798, t802;
  double t803, t805, t807, t808, t813, t814, t820, t824;
  double t825, t826, t833, t834, t835, t839, t846, t848;
  double t850, t851, t852, t878, t888, t892, t910, t915;
  double t935, t943, t951, t952, t957, t961, t962, t967;
  double t970, t977, t986, t989, tv4rho40, t995, t998, t1001;
  double t1007, t1010, t1014, t1026, t1028, t1037, t1040, t1041;
  double t1042, t1046, t1050, t1052, t1062, t1064, t1104, t1158;
  double t1161, t1168, t1173, t1174, t1184, t1189, t1193, t1194;
  double t1219, t1222, tv4rho3sigma0, t1226, t1231, t1239, t1244, t1247;
  double t1268, t1269, t1273, t1274, t1297, t1300, t1306, t1310;
  double t1317, t1320, t1346, t1371, t1451, t1454, tv4rho2sigma20, t1481;
  double t1486, t1495, t1501, t1506, t1509, t1526, t1533, t1536;
  double t1544, t1545, t1552, t1557, t1567, t1576, t1589, t1652;
  double t1655, tv4rhosigma30, t1658, t1662, t1669, t1686, t1687, t1688;
  double t1692, t1700, t1705, t1725, t1729, t1733, t1736, t1743;
  double t1744, t1754, t1768, t1824, t1827, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * t22;
  t314 = 0.1e1 / t23 / t312;
  t315 = t17 * t314;
  t316 = t80 * t80;
  t317 = 0.1e1 / t316;
  t318 = t41 * t317;
  t319 = t315 * t318;
  t321 = t46 * t261 * t21;
  t324 = t140 * rho[0];
  t326 = 0.1e1 / t19 / t324;
  t327 = t17 * t326;
  t331 = t72 * t173;
  t339 = 0.1e1 / t140;
  t340 = t17 * t339;
  t341 = t340 * t41;
  t348 = t134 * t72;
  t352 = 0.1e1 / t23 / t324;
  t353 = sigma[0] * t352;
  t363 = t29 * M_PI;
  t364 = t363 * t261;
  t365 = t140 * t57;
  t366 = 0.1e1 / t365;
  t368 = 0.1e1 / t154 / t38;
  t372 = -0.4928e4 / 0.2187e4 * t21 * t353 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t353 * t155 - 0.1024e4 / 0.59049e5 * t364 * t366 * t368;
  t377 = t78 * t159;
  t384 = t327 * t187;
  t389 = -0.128e3 / 0.243e3 * t319 * t321 + 0.32e2 / 0.27e2 * t327 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t331 * t177 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t341 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t348 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t372 * t47 - t377 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + 0.32e2 / 0.243e3 * t384 * t194 + 0.16e2 / 0.243e3 * t384 * t197;
  t390 = t72 * t81;
  t391 = t171 * t390;
  t394 = t72 * t45;
  t395 = t171 * t394;
  t400 = t315 * t174;
  t401 = t87 * t261;
  t402 = t21 * t68;
  t403 = t401 * t402;
  t406 = t315 * t180;
  t407 = t190 * t261;
  t408 = t21 * t155;
  t409 = t407 * t408;
  t412 = t401 * t408;
  t415 = t315 * t187;
  t416 = t86 * t86;
  t417 = 0.1e1 / t416;
  t420 = t368 * t3 * t20;
  t421 = t417 * t261 * t420;
  t424 = t407 * t420;
  t427 = t401 * t420;
  t430 = t327 * t180;
  t438 = -0.16e2 / 0.81e2 * t391 * t184 - 0.16e2 / 0.243e3 * t395 * t194 - 0.8e1 / 0.243e3 * t395 * t197 - 0.128e3 / 0.729e3 * t400 * t403 - 0.128e3 / 0.2187e4 * t406 * t409 - 0.64e2 / 0.2187e4 * t406 * t412 - 0.128e3 / 0.6561e4 * t415 * t421 - 0.128e3 / 0.6561e4 * t415 * t424 - 0.128e3 / 0.19683e5 * t415 * t427 + 0.32e2 / 0.81e2 * t430 * t184 - 0.43e2 / 0.27e2 * t341 * t83 + 0.5e1 / 0.3e1 * t348 * t83 - t377 * t83;
  t440 = my_piecewise3(t2, 0, t389 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t448 = t232 * t394;
  t453 = t104 * t173;
  t459 = t232 * t390;
  t462 = t17 * t352;
  t463 = t462 * t318;
  t465 = t20 * t32;
  t466 = t46 * t3 * t465;
  t480 = t110 * t159;
  t487 = t134 * t104;
  t499 = 0.1e1 / t312;
  t501 = t368 * t32;
  t504 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t363 * t499 * t501;
  t509 = -0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t448 * t250 + 0.2e1 / 0.243e3 * t448 * t254 - 0.16e2 / 0.81e2 * t171 * t453 * t177 - 0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t459 * t241 + 0.16e2 / 0.81e2 * t463 * t466 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t480 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t487 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t504 * t47;
  t510 = t78 * t217;
  t516 = t462 * t187;
  t518 = t21 * t32;
  t519 = t190 * t368 * t518;
  t523 = t87 * t368 * t518;
  t526 = t104 * t81;
  t527 = t171 * t526;
  t530 = t104 * t45;
  t531 = t171 * t530;
  t536 = t462 * t174;
  t537 = t87 * t3;
  t539 = t537 * t465 * t68;
  t542 = t462 * t180;
  t545 = t20 * t155 * t32;
  t546 = t190 * t3 * t545;
  t549 = t537 * t545;
  t553 = t417 * t368 * t518;
  t566 = -0.2e1 / 0.9e1 * t510 * t90 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.16e2 / 0.2187e4 * t516 * t519 + 0.16e2 / 0.6561e4 * t516 * t523 - 0.16e2 / 0.243e3 * t527 * t184 - 0.16e2 / 0.729e3 * t531 * t194 - 0.8e1 / 0.729e3 * t531 * t197 + 0.16e2 / 0.243e3 * t536 * t539 + 0.16e2 / 0.729e3 * t542 * t546 + 0.8e1 / 0.729e3 * t542 * t549 + 0.16e2 / 0.2187e4 * t516 * t553 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t487 * t83 - 0.2e1 / 0.3e1 * t510 * t83 - t164 * t112 / 0.4e1 + t480 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t509 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t575 = t78 * t272;
  t578 = t110 * t217;
  t583 = t282 * t331;
  t586 = t17 * t142;
  t587 = t586 * t318;
  t589 = t46 * t99 * t21;
  t592 = t232 * t526;
  t595 = t232 * t174;
  t598 = t232 * t530;
  t613 = -t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2 - t575 * t83 / 0.3e1 + t578 * t112 / 0.4e1 - t229 * t293 / 0.16e2 - t583 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t587 * t589 + 0.4e1 / 0.81e2 * t592 * t241 + t595 * t285 / 0.36e2 + 0.4e1 / 0.243e3 * t598 * t250 + 0.2e1 / 0.243e3 * t598 * t254 + t79 * t302 / 0.48e2 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 - t575 * t90 / 0.9e1;
  t629 = t363 * t99;
  t630 = 0.1e1 / t324;
  t634 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t629 * t630 * t368;
  t643 = t586 * t174;
  t644 = t87 * t99;
  t645 = t644 * t402;
  t648 = t282 * t390;
  t651 = t586 * t180;
  t652 = t190 * t99;
  t653 = t652 * t408;
  t656 = t644 * t408;
  t659 = t282 * t394;
  t662 = t586 * t187;
  t664 = t417 * t99 * t420;
  t667 = t652 * t420;
  t674 = t644 * t420;
  t677 = 0.4e1 / 0.27e2 * t232 * t104 * t235 + t578 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t634 * t47 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3 - 0.2e1 / 0.81e2 * t643 * t645 - t648 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t651 * t653 - t651 * t656 / 0.243e3 - t659 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t662 * t664 - 0.2e1 / 0.729e3 * t662 * t667 + t248 * t305 / 0.648e3 - t659 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t662 * t674;
  t679 = my_piecewise3(t2, 0, t613 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t282 * t453;
  t690 = t17 * t59;
  t691 = t690 * t318;
  t693 = t46 * t262 * t21;
  t696 = sigma[0] * sigma[0];
  t698 = 0.1e1 / t32 / t696;
  t700 = t88 * t698 * t68;
  t703 = 0.1e1 / t696;
  t704 = t190 * t703;
  t705 = t704 * t193;
  t708 = t87 * t703;
  t709 = t708 * t183;
  t721 = t339 * t368;
  t724 = t64 * t698 * t34 * t68 / 0.36e2 + t153 * t703 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t363 * t262 * t721;
  t733 = t82 * t698;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 - t685 * t285 / 0.12e2 - t277 * t302 / 0.16e2 + t691 * t693 / 0.36e2 + t111 * t700 / 0.32e2 + t296 * t705 / 0.216e3 + t288 * t709 / 0.72e2 - 0.3e1 / 0.8e1 * t18 * t19 * t724 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t733;
  t737 = t282 * t526;
  t740 = t282 * t530;
  t746 = t46 * t703 * t31;
  t749 = t690 * t174;
  t750 = t87 * t262;
  t751 = t750 * t402;
  t754 = t690 * t180;
  t755 = t190 * t262;
  t756 = t755 * t408;
  t759 = t750 * t408;
  t762 = t690 * t187;
  t764 = t417 * t262 * t420;
  t767 = t755 * t420;
  t770 = t708 * t193;
  t773 = t750 * t420;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t781 = t134 * t159;
  t784 = t78 * t372;
  t787 = t17 * t630;
  t788 = t787 * t41;
  t791 = t340 * t72;
  t794 = t159 * t173;
  t798 = t72 * t317;
  t802 = t140 * t140;
  t803 = t802 * rho[0];
  t805 = t17 / t803;
  t807 = t87 * t696;
  t808 = M_PI * t68;
  t813 = 0.1e1 / t19 / t312;
  t814 = t17 * t813;
  t820 = t17 / t23 / t365;
  t824 = t805 * t174;
  t825 = t190 * t696;
  t826 = M_PI * t155;
  t833 = t805 * t180;
  t834 = t417 * t696;
  t835 = M_PI * t368;
  t839 = 0.1e2 / 0.3e1 * t781 * t83 - 0.4e1 / 0.3e1 * t784 * t83 + 0.506e3 / 0.81e2 * t788 * t83 - 0.172e3 / 0.27e2 * t791 * t83 - 0.32e2 / 0.27e2 * t171 * t794 * t177 - 0.512e3 / 0.243e3 * t315 * t798 * t321 - 0.4096e4 / 0.6561e4 * t805 * t318 * t807 * t808 - 0.5296e4 / 0.729e3 * t814 * t174 * t177 + 0.4864e4 / 0.729e3 * t820 * t318 * t321 - 0.4096e4 / 0.19683e5 * t824 * t825 * t826 - 0.2048e4 / 0.19683e5 * t824 * t807 * t826 - 0.4096e4 / 0.59049e5 * t833 * t834 * t835;
  t846 = t805 * t187;
  t848 = 0.1e1 / t416 / t39;
  t850 = t154 * t154;
  t851 = 0.1e1 / t850;
  t852 = t851 * M_PI;
  t878 = sigma[0] * t314;
  t888 = 0.1e1 / t802;
  t892 = t4 * t363;
  t910 = 0.1e1 / t316 / t44 * t46;
  t915 = -0.4096e4 / 0.59049e5 * t833 * t825 * t835 - 0.4096e4 / 0.177147e6 * t833 * t807 * t835 - 0.4096e4 / 0.177147e6 * t846 * t848 * t696 * t852 - 0.2048e4 / 0.59049e5 * t846 * t834 * t852 - 0.11264e5 / 0.531441e6 * t846 * t825 * t852 - 0.1024e4 / 0.177147e6 * t846 * t807 * t852 + 0.128e3 / 0.27e2 * t327 * t331 * t177 + 0.1e2 / 0.27e2 * t18 * t59 * t41 * t47 - 0.5e1 / 0.9e1 * t18 * t25 * t72 * t47 + 0.506e3 / 0.243e3 * t788 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * (0.83776e5 / 0.6561e4 * t21 * t878 + 0.728e4 / 0.2187e4 * t64 * t32 * t326 * t68 - 0.27328e5 / 0.19683e5 * t153 * t878 * t155 + 0.14336e5 / 0.59049e5 * t364 * t888 * t368 - 0.8192e4 / 0.1594323e7 * t892 * t696 / t19 / t803 * t851 * t30) * t47 - 0.4e1 / 0.9e1 * t784 * t90 - 0.4096e4 / 0.2187e4 * t805 * t41 * t910 * t696 * M_PI;
  t935 = t820 * t180;
  t943 = t814 * t187;
  t951 = t18 * t124 * t159 * t47 / 0.2e1 - 0.172e3 / 0.81e2 * t791 * t90 - t18 * t52 * t372 * t47 / 0.2e1 + 0.1e2 / 0.9e1 * t781 * t90 + 0.4864e4 / 0.2187e4 * t820 * t174 * t403 - 0.512e3 / 0.729e3 * t315 * t331 * t403 + 0.4864e4 / 0.6561e4 * t935 * t409 + 0.2432e4 / 0.6561e4 * t935 * t412 - 0.5296e4 / 0.2187e4 * t814 * t180 * t184 - 0.5296e4 / 0.6561e4 * t943 * t194 - 0.2648e4 / 0.6561e4 * t943 * t197 + 0.128e3 / 0.81e2 * t327 * t390 * t184;
  t952 = t327 * t394;
  t957 = t159 * t81;
  t961 = t159 * t45;
  t962 = t171 * t961;
  t967 = t315 * t394;
  t970 = t820 * t187;
  t977 = t315 * t390;
  t986 = 0.128e3 / 0.243e3 * t952 * t194 + 0.64e2 / 0.243e3 * t952 * t197 - 0.32e2 / 0.81e2 * t171 * t957 * t184 - 0.32e2 / 0.243e3 * t962 * t194 - 0.16e2 / 0.243e3 * t962 * t197 - 0.512e3 / 0.19683e5 * t967 * t427 + 0.4864e4 / 0.19683e5 * t970 * t421 + 0.4864e4 / 0.19683e5 * t970 * t424 + 0.4864e4 / 0.59049e5 * t970 * t427 - 0.512e3 / 0.2187e4 * t977 * t409 - 0.256e3 / 0.2187e4 * t977 * t412 - 0.512e3 / 0.6561e4 * t967 * t421 - 0.512e3 / 0.6561e4 * t967 * t424;
  t989 = my_piecewise3(t2, 0, t839 + t915 + t951 + t986);
  tv4rho40 = 0.2e1 * rho[0] * t989 + 0.8e1 * t440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t995 = t340 * t104;
  t998 = t134 * t217;
  t1001 = t78 * t504;
  t1007 = t110 * t372;
  t1010 = t217 * t173;
  t1014 = t104 * t317;
  t1026 = t17 * t888;
  t1028 = t87 * M_PI;
  t1037 = t232 * t961;
  t1040 = t1026 * t174;
  t1041 = t190 * M_PI;
  t1042 = sigma[0] * t155;
  t1046 = -0.3e1 / 0.4e1 * t341 * t112 - 0.43e2 / 0.27e2 * t995 * t83 + 0.5e1 / 0.3e1 * t998 * t83 - t1001 * t83 + 0.3e1 / 0.4e1 * t348 * t112 - 0.3e1 / 0.8e1 * t377 * t112 + t1007 * t112 / 0.8e1 - 0.16e2 / 0.27e2 * t171 * t1010 * t177 - 0.128e3 / 0.243e3 * t315 * t1014 * t321 - 0.26e2 / 0.81e2 * t391 * t241 + 0.2e1 / 0.27e2 * t232 * t957 * t241 + 0.16e2 / 0.27e2 * t462 * t798 * t466 + 0.512e3 / 0.2187e4 * t1026 * t318 * t1028 * sigma[0] * t68 - 0.26e2 / 0.243e3 * t395 * t250 - 0.13e2 / 0.243e3 * t395 * t254 + 0.2e1 / 0.81e2 * t1037 * t250 + 0.512e3 / 0.6561e4 * t1040 * t1041 * t1042;
  t1050 = t1026 * t180;
  t1052 = t368 * sigma[0];
  t1062 = t1026 * t187;
  t1064 = M_PI * sigma[0];
  t1104 = 0.256e3 / 0.6561e4 * t1040 * t1028 * t1042 + 0.512e3 / 0.19683e5 * t1050 * t417 * M_PI * t1052 + 0.512e3 / 0.19683e5 * t1050 * t1041 * t1052 + 0.512e3 / 0.59049e5 * t1050 * t1028 * t1052 + 0.512e3 / 0.59049e5 * t1062 * t848 * t851 * t1064 + 0.256e3 / 0.19683e5 * t1062 * t417 * t851 * t1064 + 0.1408e4 / 0.177147e6 * t1062 * t190 * t851 * t1064 + 0.128e3 / 0.59049e5 * t1062 * t87 * t851 * t1064 - 0.16e3 / 0.81e2 * t319 * t466 + 0.32e2 / 0.27e2 * t327 * t453 * t177 + 0.374e3 / 0.729e3 * t430 * t241 + 0.187e3 / 0.2187e4 * t384 * t254 + 0.374e3 / 0.2187e4 * t384 * t250 + t1037 * t254 / 0.81e2 + 0.2e1 / 0.9e1 * t232 * t159 * t235 - t377 * t116 / 0.8e1 + t1007 * t116 / 0.24e2 - 0.3e1 / 0.8e1 * t18 * t52 * t504 * t47;
  t1158 = t462 * t394;
  t1161 = t462 * t390;
  t1168 = t315 * t526;
  t1173 = 0.5e1 / 0.9e1 * t998 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.4928e4 / 0.2187e4 * t21 * t352 - 0.28e3 / 0.729e3 * t64 * t99 * t170 * t68 + 0.1904e4 / 0.6561e4 * t153 * t352 * t155 - 0.1408e4 / 0.19683e5 * t363 * t366 * t501 + 0.1024e4 / 0.531441e6 * t892 / t19 / t802 * t851 * sigma[0] * t30) * t47 - 0.26e2 / 0.27e2 * t171 * t72 * t235 - t341 * t116 / 0.4e1 - 0.5e1 / 0.36e2 * t18 * t25 * t104 * t47 - t1001 * t90 / 0.3e1 + 0.374e3 / 0.243e3 * t327 * t41 * t235 + 0.512e3 / 0.729e3 * t1026 * t41 * t910 * t1064 + t348 * t116 / 0.4e1 + t18 * t124 * t217 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t995 * t90 + 0.16e2 / 0.729e3 * t1158 * t519 + 0.8e1 / 0.243e3 * t1161 * t549 - 0.16e3 / 0.729e3 * t406 * t546 - 0.16e3 / 0.2187e4 * t415 * t553 - 0.128e3 / 0.2187e4 * t1168 * t409 - 0.64e2 / 0.2187e4 * t1168 * t412;
  t1174 = t315 * t530;
  t1184 = t327 * t530;
  t1189 = t217 * t81;
  t1193 = t217 * t45;
  t1194 = t171 * t1193;
  t1219 = -0.128e3 / 0.6561e4 * t1174 * t421 - 0.128e3 / 0.6561e4 * t1174 * t424 - 0.128e3 / 0.19683e5 * t1174 * t427 + 0.32e2 / 0.81e2 * t327 * t526 * t184 + 0.32e2 / 0.243e3 * t1184 * t194 + 0.16e2 / 0.243e3 * t1184 * t197 - 0.16e2 / 0.81e2 * t171 * t1189 * t184 - 0.16e2 / 0.243e3 * t1194 * t194 - 0.8e1 / 0.243e3 * t1194 * t197 + 0.16e2 / 0.2187e4 * t1158 * t523 - 0.128e3 / 0.729e3 * t315 * t453 * t403 - 0.16e3 / 0.243e3 * t400 * t539 + 0.16e2 / 0.81e2 * t462 * t331 * t539 - 0.16e3 / 0.2187e4 * t415 * t519 - 0.8e2 / 0.729e3 * t406 * t549 - 0.16e3 / 0.6561e4 * t415 * t523 + 0.16e2 / 0.243e3 * t1161 * t546 + 0.16e2 / 0.729e3 * t1158 * t553;
  t1222 = my_piecewise3(t2, 0, t1046 + t1104 + t1173 + t1219);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1222 + 0.6e1 * t568;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1226 = t462 * t530;
  t1231 = t462 * t526;
  t1239 = t586 * t390;
  t1244 = t282 * t961;
  t1247 = t586 * t394;
  t1268 = 0.32e2 / 0.2187e4 * t1226 * t553 + 0.32e2 / 0.2187e4 * t1226 * t519 + 0.16e2 / 0.729e3 * t1231 * t549 + 0.32e2 / 0.6561e4 * t1226 * t523 - t282 * t957 * t290 / 0.108e3 - 0.4e1 / 0.243e3 * t1239 * t653 - 0.2e1 / 0.243e3 * t1239 * t656 - t1244 * t298 / 0.324e3 - 0.4e1 / 0.729e3 * t1247 * t664 - 0.4e1 / 0.729e3 * t1247 * t667 + t448 * t305 / 0.324e3 + t459 * t290 / 0.54e2 + 0.34e2 / 0.243e3 * t536 * t645 + 0.34e2 / 0.729e3 * t542 * t653 + 0.17e2 / 0.729e3 * t542 * t656 + t448 * t298 / 0.162e3 + 0.34e2 / 0.2187e4 * t516 * t664 + 0.34e2 / 0.2187e4 * t516 * t667;
  t1269 = t272 * t81;
  t1273 = t272 * t45;
  t1274 = t171 * t1273;
  t1297 = t78 * t634;
  t1300 = t110 * t504;
  t1306 = t17 * t366 * t41;
  t1310 = t134 * t272;
  t1317 = t232 * t1193;
  t1320 = -0.16e2 / 0.243e3 * t171 * t1269 * t184 - 0.16e2 / 0.729e3 * t1274 * t194 - 0.8e1 / 0.729e3 * t1274 * t197 - 0.4e1 / 0.81e2 * t586 * t331 * t645 - t181 * t290 / 0.54e2 - t188 * t298 / 0.162e3 - t188 * t305 / 0.324e3 + 0.32e2 / 0.243e3 * t462 * t453 * t539 + 0.32e2 / 0.729e3 * t1231 * t546 + t487 * t112 / 0.2e1 - t135 * t293 / 0.8e1 - 0.2e1 / 0.3e1 * t1297 * t83 + t1300 * t112 / 0.4e1 - t480 * t293 / 0.16e2 - 0.64e2 / 0.243e3 * t1306 * t910 * M_PI + 0.5e1 / 0.9e1 * t1310 * t83 - t510 * t112 / 0.2e1 + t164 * t293 / 0.8e1 + 0.8e1 / 0.243e3 * t1317 * t250;
  t1346 = t272 * t173;
  t1371 = 0.4e1 / 0.243e3 * t1317 * t254 - t282 * t794 * t285 / 0.36e2 - 0.4e1 / 0.27e2 * t586 * t798 * t589 + 0.34e2 / 0.81e2 * t463 * t589 - 0.52e2 / 0.243e3 * t527 * t241 - 0.52e2 / 0.729e3 * t531 * t250 - 0.26e2 / 0.729e3 * t531 * t254 + t232 * t331 * t285 / 0.18e2 + 0.32e2 / 0.81e2 * t462 * t1014 * t466 - t175 * t285 / 0.18e2 - 0.16e2 / 0.81e2 * t171 * t1346 * t177 + 0.8e1 / 0.81e2 * t232 * t1189 * t241 - t18 * t52 * t634 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t1310 * t90 - t510 * t116 / 0.6e1 - 0.2e1 / 0.9e1 * t1297 * t90 + t18 * t124 * t272 * t47 / 0.12e2 + t487 * t116 / 0.6e1 - t135 * t302 / 0.24e2;
  t1451 = -0.64e2 / 0.2187e4 * t1306 * t173 * t190 * t826 - 0.32e2 / 0.2187e4 * t1306 * t173 * t87 * t826 - 0.64e2 / 0.6561e4 * t1306 * t81 * t417 * t835 - 0.64e2 / 0.6561e4 * t1306 * t81 * t190 * t835 - 0.64e2 / 0.19683e5 * t1306 * t81 * t87 * t835 - 0.64e2 / 0.19683e5 * t1306 * t45 * t848 * t852 - 0.32e2 / 0.6561e4 * t1306 * t45 * t417 * t852 - 0.176e3 / 0.59049e5 * t1306 * t45 * t190 * t852 - 0.16e2 / 0.19683e5 * t1306 * t88 * t852 - 0.52e2 / 0.81e2 * t171 * t104 * t235 + 0.8e1 / 0.27e2 * t232 * t217 * t235 + t1300 * t116 / 0.12e2 - t480 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.14e2 / 0.243e3 * t64 * t262 * t147 * t68 - 0.28e2 / 0.2187e4 * t153 * t267 * t142 * t155 + 0.304e3 / 0.19683e5 * t629 * t499 * t368 - 0.128e3 / 0.177147e6 * t892 / t19 / t365 * t851 * t30) * t47 - 0.64e2 / 0.729e3 * t1306 * t317 * t87 * t808 + t164 * t302 / 0.24e2 + 0.34e2 / 0.6561e4 * t516 * t674 - t1244 * t305 / 0.648e3 - 0.4e1 / 0.2187e4 * t1247 * t674;
  t1454 = my_piecewise3(t2, 0, t1268 + t1320 + t1371 + t1451);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1454 + 0.4e1 * t679;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1481 = t690 * t390;
  t1486 = t690 * t394;
  t1495 = t592 * t290 / 0.36e2 + t598 * t298 / 0.108e3 + t598 * t305 / 0.216e3 + t651 * t756 / 0.972e3 + t662 * t764 / 0.2916e4 + t662 * t767 / 0.2916e4 + t648 * t709 / 0.72e2 + t643 * t751 / 0.324e3 + t651 * t759 / 0.1944e4 - 0.2e1 / 0.27e2 * t586 * t453 * t645 + t690 * t331 * t751 / 0.108e3 + t1481 * t756 / 0.324e3 + t1481 * t759 / 0.648e3 + t1486 * t764 / 0.972e3 + t1486 * t767 / 0.972e3 + t659 * t770 / 0.432e3 + t662 * t773 / 0.8748e4;
  t1501 = t586 * t526;
  t1506 = t282 * t1193;
  t1509 = t586 * t530;
  t1526 = t78 * t724;
  t1533 = t110 * t634;
  t1536 = t1486 * t773 / 0.2916e4 - t282 * t1189 * t290 / 0.36e2 - 0.2e1 / 0.81e2 * t1501 * t653 - t1501 * t656 / 0.81e2 - t1506 * t298 / 0.108e3 - 0.2e1 / 0.243e3 * t1509 * t664 - 0.2e1 / 0.243e3 * t1509 * t667 - t1506 * t305 / 0.216e3 - 0.2e1 / 0.729e3 * t1509 * t674 - t238 * t709 / 0.72e2 - t248 * t705 / 0.216e3 - t248 * t770 / 0.432e3 + t659 * t705 / 0.216e3 - t1526 * t83 / 0.3e1 - 0.3e1 / 0.16e2 * t578 * t293 + 0.3e1 / 0.32e2 * t229 * t733 + 0.3e1 / 0.8e1 * t1533 * t112;
  t1544 = t17 * t499;
  t1545 = t1544 * t180;
  t1552 = t1544 * t187;
  t1557 = t417 * t267;
  t1567 = t232 * t1273;
  t1576 = t1544 * t174;
  t1589 = -0.3e1 / 0.8e1 * t575 * t112 + 0.3e1 / 0.16e2 * t222 * t293 - 0.3e1 / 0.32e2 * t79 * t733 + 0.8e1 / 0.2187e4 * t1545 * t297 * t835 + 0.8e1 / 0.6561e4 * t1545 * t289 * t835 + 0.8e1 / 0.6561e4 * t1552 * t848 * t267 * t852 + 0.4e1 / 0.2187e4 * t1552 * t1557 * t852 + 0.22e2 / 0.19683e5 * t1552 * t297 * t852 + 0.2e1 / 0.6561e4 * t1552 * t289 * t852 + 0.2e1 / 0.81e2 * t1567 * t250 + t1567 * t254 / 0.81e2 - t595 * t746 / 0.24e2 + t583 * t746 / 0.24e2 + 0.8e1 / 0.729e3 * t1576 * t297 * t826 + 0.4e1 / 0.729e3 * t1576 * t289 * t826 + 0.8e1 / 0.2187e4 * t1545 * t1557 * t835 + 0.2e1 / 0.27e2 * t232 * t1269 * t241;
  t1652 = -t282 * t1010 * t285 / 0.12e2 - 0.2e1 / 0.9e1 * t586 * t1014 * t589 + t690 * t798 * t693 / 0.36e2 + 0.8e1 / 0.243e3 * t1544 * t318 * t289 * t808 + t232 * t453 * t285 / 0.12e2 + t587 * t693 / 0.108e3 + 0.8e1 / 0.81e2 * t1544 * t41 * t910 * t267 * M_PI + t229 * t700 / 0.32e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-t64 * t698 * t66 * t68 / 0.27e2 - 0.2e1 / 0.243e3 * t153 * t703 * t59 * t155 + 0.16e2 / 0.59049e5 * t892 * t267 * t813 * t851 * t30) * t47 - t1526 * t90 / 0.9e1 + t1533 * t116 / 0.8e1 - t18 * t52 * t724 * t47 / 0.8e1 - t575 * t116 / 0.8e1 + t222 * t302 / 0.16e2 - t79 * t700 / 0.32e2 + 0.2e1 / 0.9e1 * t232 * t272 * t235 - t578 * t302 / 0.16e2;
  t1655 = my_piecewise3(t2, 0, t1495 + t1536 + t1589 + t1652);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1655 + 0.2e1 * t778;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1658 = t190 * t698;
  t1662 = t87 * t698;
  t1669 = t282 * t1273;
  t1686 = t696 * sigma[0];
  t1687 = 0.1e1 / t1686;
  t1688 = t87 * t1687;
  t1692 = -t762 * t1658 * t420 / 0.324e3 - t749 * t1662 * t402 / 0.36e2 - t754 * t1662 * t408 / 0.216e3 - t1669 * t298 / 0.54e2 - t1669 * t305 / 0.108e3 - t282 * t1269 * t290 / 0.18e2 + t690 * t453 * t751 / 0.27e2 + t737 * t709 / 0.18e2 + t740 * t705 / 0.54e2 + t740 * t770 / 0.108e3 - 0.5e1 / 0.144e3 * t288 * t1688 * t183;
  t1700 = t690 * t526;
  t1705 = t690 * t530;
  t1725 = 0.1e1 / t32 / t1686;
  t1729 = -0.5e1 / 0.432e3 * t296 * t190 * t1687 * t193 - t762 * t1662 * t420 / 0.972e3 + t1700 * t756 / 0.81e2 + t1700 * t759 / 0.162e3 + t1705 * t764 / 0.243e3 + t1705 * t767 / 0.243e3 + t1705 * t773 / 0.729e3 - 0.5e1 / 0.864e3 * t296 * t1688 * t193 - t754 * t1658 * t408 / 0.108e3 - t762 * t417 * t698 * t420 / 0.324e3 + 0.3e1 / 0.8e1 * t277 * t733 - 0.15e2 / 0.64e2 * t111 * t82 * t1725;
  t1733 = t110 * t724;
  t1736 = t787 * t174;
  t1743 = t787 * t180;
  t1744 = t417 * t703;
  t1754 = t787 * t187;
  t1768 = -0.3e1 / 0.8e1 * t682 * t293 + t1733 * t112 / 0.2e1 - t1736 * t704 * t826 / 0.243e3 - t1736 * t708 * t826 / 0.486e3 - t1743 * t1744 * t835 / 0.729e3 - t1743 * t704 * t835 / 0.729e3 - t1743 * t708 * t835 / 0.2187e4 - t1754 * t848 * t703 * t852 / 0.2187e4 - t1754 * t1744 * t852 / 0.1458e4 - 0.11e2 / 0.26244e5 * t1754 * t704 * t852 - t1754 * t708 * t852 / 0.8748e4;
  t1824 = -t787 * t318 * t708 * t808 / 0.81e2 - 0.5e1 / 0.48e2 * t283 * t46 * t1687 * t31 - t282 * t1346 * t285 / 0.6e1 + t690 * t1014 * t693 / 0.9e1 + t685 * t746 / 0.6e1 - t691 * t46 * t698 * t21 / 0.12e2 - 0.5e1 / 0.64e2 * t111 * t88 * t1725 * t68 + t277 * t700 / 0.8e1 - t682 * t302 / 0.8e1 - t788 * t910 * t703 * M_PI / 0.27e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.5e1 / 0.72e2 * t64 * t1725 * t34 * t68 - 0.5e1 / 0.324e3 * t153 * t1687 * t25 * t155 - 0.2e1 / 0.729e3 * t363 * t698 * t721 - 0.2e1 / 0.19683e5 * t892 * t703 * t326 * t851 * t30) * t47 + t1733 * t116 / 0.6e1;
  t1827 = my_piecewise3(t2, 0, t1692 + t1729 + t1768 + t1824);
  tv4sigma40 = 0.2e1 * rho[0] * t1827;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t519, t520, t521, t522, t527;
  double t528, t529, t530, t531, t533, t535, t536, t539;
  double t544, t548, t549, t554, t560, t561, t565, t567;
  double t570, t571, t572, t573, t577, t578, t579, t581;
  double t582, t585, t586, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t519 = 0.1e1 / t77 / t197;
  t520 = t84 * t519;
  t521 = t520 * t206;
  t522 = t228 * t521;
  t527 = 0.1e1 / t216 / t97;
  t528 = t94 * t527;
  t529 = t528 * t99;
  t530 = t215 * t529;
  t531 = t76 * t76;
  t533 = 0.1e1 / t78 / t531;
  t535 = t533 * t41 * t3;
  t536 = t75 * t535;
  t539 = t190 * t190;
  t544 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t548 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t539 + 0.4e1 / 0.3e1 * t71 * t544);
  t549 = t5 * t548;
  t554 = t75 * t533;
  t560 = t91 * t91;
  t561 = 0.1e1 / t560;
  t565 = 0.176e3 / 0.729e3 * t29 * t554 + 0.28e2 / 0.243e3 * t130 * t521 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t533 * t561;
  t567 = t27 * t565 * t100;
  t570 = t218 * t227;
  t571 = t215 * t570;
  t572 = t42 * t206;
  t573 = t554 * t572;
  t577 = 0.1e1 / t226 / t92;
  t578 = t224 * t577;
  t579 = t215 * t578;
  t581 = t561 * t41 * t3;
  t582 = t554 * t581;
  t585 = t224 * t227;
  t586 = t215 * t585;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t520;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t522 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t530 * t536 - 0.3e1 / 0.8e1 * t549 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t567 - 0.8e1 / 0.243e3 * t571 * t573 - 0.8e1 / 0.729e3 * t579 * t582 - 0.4e1 / 0.729e3 * t586 * t582 + t418 - t464 / 0.4e1 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t561;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t528;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t572;
  t735 = t220 * t701;
  t742 = t698 * t581;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t571 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t579 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t586 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t561 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t572;
  t826 = t220 * t798;
  t829 = t822 * t581;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t530 * t819 / 0.72e2 - t571 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t579 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t586 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t519, t520, t521, t522, t527;
  double t528, t529, t530, t531, t533, t535, t536, t539;
  double t544, t548, t549, t554, t560, t561, t565, t567;
  double t570, t571, t572, t573, t577, t578, t579, t581;
  double t582, t585, t586, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t842, t843, t844, t847, t848, t851, t852, t853;
  double t855, t856, t857, t859, t860, t863, t865, t866;
  double t870, t877, t878, t880, t882, t883, t886, t893;
  double t894, t895, t896, t898, t899, t902, t904, t907;
  double t908, t911, t913, t915, t916, t918, t921, t922;
  double t925, t926, t929, t932, t933, t934, t937, t941;
  double t942, t947, t949, t952, t953, t954, t955, t956;
  double t957, t959, t966, t969, t971, t974, t975, t977;
  double t978, t981, t982, t984, t985, t987, t988, t989;
  double t992, t993, t994, t995, t996, t1000, t1001, t1005;
  double t1006, t1011, t1012, t1015, t1016, t1017, t1018, t1021;
  double t1024, t1025, t1026, t1029, t1030, t1033, t1036, t1037;
  double t1040, t1043, t1044, t1046, t1047, t1049, t1050, t1052;
  double t1053, t1056, t1059, t1060, t1063, t1066, t1071, t1074;
  double t1076, t1077, t1080, t1083, t1086, t1090, t1091, t1094;
  double t1096, t1099, t1101, t1103, tv3rho30, t1106, t1107, t1108;
  double t1109, t1112, t1113, t1115, t1116, t1127, t1130, t1135;
  double t1136, t1138, t1142, t1143, t1149, t1152, t1153, t1157;
  double t1162, t1165, t1167, t1168, t1175, t1179, t1182, t1185;
  double t1191, t1193, t1194, t1197, t1202, t1204, t1208, t1209;
  double t1213, t1214, t1221, t1223, t1224, t1226, t1227, t1230;
  double t1231, t1233, t1234, t1235, t1236, t1238, t1241, t1243;
  double t1244, t1245, t1247, t1248, tv3rho31, t1251, t1256, t1260;
  double t1264, t1265, t1268, t1272, t1273, t1276, t1284, t1285;
  double t1286, t1287, t1288, t1290, t1291, t1293, t1298, t1299;
  double t1302, t1305, t1308, t1309, t1311, t1313, t1318, t1322;
  double t1326, t1327, t1336, t1338, t1339, t1341, t1342, t1344;
  double t1348, t1351, t1355, t1356, t1358, t1361, t1362, t1364;
  double t1365, t1367, t1368, t1370, t1373, t1376, t1379, t1381;
  double tv3rho32, t1386, t1393, t1397, t1398, t1404, t1412, t1413;
  double t1416, t1418, t1419, t1423, t1424, t1425, t1429, t1436;
  double t1440, t1441, t1448, t1449, t1451, t1452, t1455, t1462;
  double t1463, t1464, t1466, t1467, t1470, t1472, t1484, t1485;
  double t1486, t1487, t1488, t1489, t1491, t1494, t1497, t1500;
  double t1501, t1504, t1509, t1514, t1515, t1516, t1517, t1518;
  double t1521, t1522, t1523, t1524, t1529, t1530, t1531, t1532;
  double t1534, t1535, t1542, t1545, t1546, t1547, t1548, t1552;
  double t1553, t1556, t1559, t1560, t1563, t1566, t1567, t1570;
  double t1573, t1574, t1577, t1580, t1588, t1591, tv3rho33, t1599;
  double t1601, t1605, t1609, t1610, t1611, t1613, t1614, t1618;
  double t1619, t1624, t1625, t1626, t1629, t1630, t1633, t1638;
  double t1639, t1640, t1643, t1654, t1655, t1660, t1665, t1666;
  double t1668, t1669, t1671, t1672, t1679, t1681, t1685, t1689;
  double t1691, t1692, t1699, t1700, t1704, t1711, t1714, t1716;
  double t1721, t1724, t1729, t1730, t1732, t1733, t1738, t1741;
  double t1742, t1746, t1750, t1757, t1759, t1760, t1763, t1766;
  double t1767, t1769, t1770, t1773, t1774, t1777, t1778, t1781;
  double t1784, tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800;
  double t1803, t1806, t1808, tv3rho2sigma2, t1819, t1823, t1834, t1836;
  double t1843, t1850, t1857, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1874;
  double t1876, t1878, t1883, t1885, t1886, t1888, t1890, t1892;
  double t1899, t1903, t1906, t1907, t1909, t1911, t1913, t1914;
  double t1916, t1917, t1919, t1921, t1930, t1934, t1936, tv3rho2sigma5;
  double t1949, tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1968, t1971, t1972;
  double t1975, t1976, t1979, t1980, t1983, t1984, t1987, t1988;
  double t1991, t1992, t1993, t1995, t1996, t2000, t2001, t2004;
  double t2013, t2014, t2015, t2018, t2024, t2025, t2026, t2039;
  double t2053, t2060, t2063, t2065, t2076, t2079, t2082, t2086;
  double t2089, t2092, t2093, t2101, t2106, t2111, t2114, tv3rho2sigma8;
  double t2119, t2120, t2121, t2125, t2126, t2127, t2139, t2140;
  double t2141, t2145, t2146, t2147, t2165, t2167, t2168, t2171;
  double t2172, t2173, t2176, t2188, t2191, t2201, t2203, t2206;
  double t2207, t2214, t2218, t2220, t2224, t2225, t2229, t2232;
  double t2239, t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275;
  double t2279, t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25;
  double t2317, t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2320;
  double t2321, t2332, t2333, t2338, t2339, t2342, t2347, t2366;
  double t2368, t2369, t2370, t2373, t2378, t2381, t2392, t2399;
  double t2403, t2405, t2410, t2411, t2416, t2417, t2420, t2427;
  double t2430, t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445;
  double t2446, t2455, t2458, t2459, t2460, t2463, t2466, t2475;
  double t2477, t2478, t2479, t2480, t2493, t2494, t2497, t2502;
  double t2514, t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2526;
  double t2527, t2528, t2529, t2534, t2542, t2543, t2544, t2545;
  double t2548, t2549, t2550, t2555, t2558, t2563, t2570, t2579;
  double t2580, t2587, t2597, t2600, t2602, t2605, t2607, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t519 = 0.1e1 / t77 / t197;
  t520 = t84 * t519;
  t521 = t520 * t206;
  t522 = t228 * t521;
  t527 = 0.1e1 / t216 / t97;
  t528 = t94 * t527;
  t529 = t528 * t99;
  t530 = t215 * t529;
  t531 = t76 * t76;
  t533 = 0.1e1 / t78 / t531;
  t535 = t533 * t41 * t3;
  t536 = t75 * t535;
  t539 = t190 * t190;
  t544 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t548 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t539 + 0.4e1 / 0.3e1 * t71 * t544);
  t549 = t5 * t548;
  t554 = t75 * t533;
  t560 = t91 * t91;
  t561 = 0.1e1 / t560;
  t565 = 0.176e3 / 0.729e3 * t29 * t554 + 0.28e2 / 0.243e3 * t130 * t521 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t533 * t561;
  t567 = t27 * t565 * t100;
  t570 = t218 * t227;
  t571 = t215 * t570;
  t572 = t42 * t206;
  t573 = t554 * t572;
  t577 = 0.1e1 / t226 / t92;
  t578 = t224 * t577;
  t579 = t215 * t578;
  t581 = t561 * t41 * t3;
  t582 = t554 * t581;
  t585 = t224 * t227;
  t586 = t215 * t585;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t520;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t522 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t530 * t536 - 0.3e1 / 0.8e1 * t549 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t567 - 0.8e1 / 0.243e3 * t571 * t573 - 0.8e1 / 0.729e3 * t579 * t582 - 0.4e1 / 0.729e3 * t586 * t582 + t418 - t464 / 0.4e1 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t561;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t528;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t572;
  t735 = t220 * t701;
  t742 = t698 * t581;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t571 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t579 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t586 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t561 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t572;
  t826 = t220 * t798;
  t829 = t822 * t581;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t530 * t819 / 0.72e2 - t571 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t579 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t586 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t842 = 0.1e1 / t33 / t285;
  t843 = t44 * t842;
  t844 = t148 * t843;
  t847 = t338 * t145;
  t848 = t143 * t847;
  t851 = t112 * t117;
  t852 = t851 * t146;
  t853 = t852 * t149;
  t855 = t25 * t369;
  t856 = t855 * t146;
  t857 = t856 * t149;
  t859 = t314 * t27;
  t860 = t859 * t146;
  t863 = t364 * t378;
  t865 = t374 * t378;
  t866 = t865 * t149;
  t870 = t375 * t392;
  t877 = t117 * t338 * t60;
  t878 = t26 * t877;
  t880 = t285 * rho[0];
  t882 = 0.1e1 / t34 / t880;
  t883 = t31 * t882;
  t886 = t843 * t134;
  t893 = t40 * M_PI;
  t894 = t893 * t753;
  t895 = t285 * t122;
  t896 = 0.1e1 / t895;
  t898 = 0.1e1 / t333 / t51;
  t899 = t896 * t898;
  t902 = -0.2464e4 / 0.2187e4 * t29 * t883 - 0.28e3 / 0.729e3 * t130 * t886 + 0.224e3 / 0.2187e4 * t331 * sigma[0] * t882 * t334 - 0.512e3 / 0.59049e5 * t894 * t899;
  t904 = t27 * t902 * t60;
  t907 = -0.35e2 / 0.27e2 * t147 * t844 - t848 * t149 / 0.2e1 - t853 / 0.3e1 + t857 / 0.9e1 - t860 * t149 / 0.2e1 - t863 * t149 - t866 / 0.3e1 + 0.7e1 / 0.6e1 * t365 * t392 + 0.7e1 / 0.18e2 * t870 + 0.7e1 / 0.6e1 * t379 * t392 - 0.9e1 / 0.8e1 * t113 * t340 - 0.3e1 / 0.8e1 * t878 - 0.3e1 / 0.8e1 * t26 * t904;
  t908 = t113 * t371;
  t911 = 0.1e1 / t116 / t105;
  t913 = t911 * t54 * t60;
  t915 = 0.5e1 / 0.36e2 * t26 * t913;
  t916 = t315 * t119;
  t918 = t113 * t321;
  t921 = t369 * t138 * t60;
  t922 = t26 * t921;
  t925 = 0.1e1 / t300 / t19;
  t926 = t302 * t109;
  t929 = t301 * t109;
  t932 = t105 * t105;
  t933 = 0.1e1 / t932;
  t934 = t16 * t933;
  t937 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t306 - 0.6e1 * t934);
  t941 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t926 + 0.4e1 / 0.3e1 * t929 * t310 + 0.4e1 / 0.3e1 * t23 * t937);
  t942 = t5 * t941;
  t947 = t385 * t297;
  t949 = t156 * t886;
  t952 = t144 * t144;
  t953 = 0.1e1 / t952;
  t954 = t54 * t953;
  t955 = t143 * t954;
  t956 = t59 * t753;
  t957 = t896 * t2;
  t959 = t956 * t957 * t28;
  t966 = t859 * t152;
  t969 = t908 / 0.4e1 - t915 - 0.3e1 / 0.8e1 * t916 - 0.3e1 / 0.4e1 * t918 + t922 / 0.4e1 - 0.3e1 / 0.8e1 * t942 * t61 - 0.9e1 / 0.8e1 * t315 * t140 + 0.7e1 / 0.54e2 * t947 - 0.35e2 / 0.81e2 * t153 * t949 - 0.64e2 / 0.243e3 * t955 * t959 + 0.7e1 / 0.18e2 * t382 * t297 + 0.7e1 / 0.18e2 * t389 * t297 - t966 * t157 / 0.6e1;
  t971 = t364 * t388;
  t974 = t374 * t388;
  t975 = t974 * t157;
  t977 = t338 * t58;
  t978 = t143 * t977;
  t981 = t851 * t152;
  t982 = t981 * t157;
  t984 = t855 * t152;
  t985 = t984 * t157;
  t987 = t138 * t281;
  t988 = t987 * t59;
  t989 = t143 * t988;
  t992 = t282 * t155;
  t993 = t143 * t992;
  t994 = t753 * t896;
  t995 = t29 * t134;
  t996 = t994 * t995;
  t1000 = t334 * t2 * t28;
  t1001 = t994 * t1000;
  t1005 = t898 * t2 * t28;
  t1006 = t994 * t1005;
  t1011 = t146 * t357;
  t1012 = t143 * t1011;
  t1015 = t154 * t154;
  t1016 = 0.1e1 / t1015;
  t1017 = t152 * t1016;
  t1018 = t143 * t1017;
  t1021 = t364 * t283;
  t1024 = -t971 * t157 / 0.3e1 - t975 / 0.9e1 - t978 * t157 / 0.6e1 - t982 / 0.9e1 + t985 / 0.27e2 - 0.8e1 / 0.27e2 * t989 * t290 - 0.64e2 / 0.729e3 * t993 * t996 - 0.32e2 / 0.2187e4 * t351 * t1001 - 0.64e2 / 0.6561e4 * t359 * t1006 - 0.64e2 / 0.19683e5 * t344 * t1006 - 0.64e2 / 0.2187e4 * t1012 * t1001 - 0.64e2 / 0.6561e4 * t1018 * t1006 - 0.8e1 / 0.27e2 * t1021 * t290;
  t1025 = t374 * t283;
  t1026 = t1025 * t290;
  t1029 = t882 * t41 * t3;
  t1030 = t31 * t1029;
  t1033 = t364 * t343;
  t1036 = t388 * t155;
  t1037 = t143 * t1036;
  t1040 = t364 * t350;
  t1043 = t374 * t343;
  t1044 = t1043 * t347;
  t1046 = t374 * t350;
  t1047 = t1046 * t353;
  t1049 = t374 * t358;
  t1050 = t1049 * t347;
  t1052 = t378 * t155;
  t1053 = t143 * t1052;
  t1056 = t364 * t358;
  t1059 = t388 * t357;
  t1060 = t143 * t1059;
  t1063 = t883 * t352;
  t1066 = t883 * t346;
  t1071 = -0.8e1 / 0.81e2 * t1026 + 0.56e2 / 0.81e2 * t284 * t1030 - 0.4e1 / 0.243e3 * t1033 * t347 - 0.4e1 / 0.243e3 * t1037 * t347 - 0.8e1 / 0.81e2 * t1040 * t353 - 0.4e1 / 0.729e3 * t1044 - 0.8e1 / 0.243e3 * t1047 - 0.8e1 / 0.729e3 * t1050 - 0.8e1 / 0.81e2 * t1053 * t353 - 0.8e1 / 0.243e3 * t1056 * t347 - 0.8e1 / 0.243e3 * t1060 * t347 + 0.56e2 / 0.243e3 * t351 * t1063 + 0.56e2 / 0.729e3 * t359 * t1066 + 0.28e2 / 0.729e3 * t344 * t1066;
  t1074 = my_piecewise3(t1, 0, t907 + t969 + t1024 + t1071);
  t1076 = 0.1e1 / t397 / t69;
  t1077 = t399 * t164;
  t1080 = t398 * t164;
  t1083 = t66 * t933;
  t1086 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t306 - 0.6e1 * t1083);
  t1090 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1077 + 0.4e1 / 0.3e1 * t1080 * t405 + 0.4e1 / 0.3e1 * t71 * t1086);
  t1091 = t5 * t1090;
  t1094 = t410 * t172;
  t1096 = t168 * t416;
  t1099 = t911 * t94 * t100;
  t1101 = 0.5e1 / 0.36e2 * t74 * t1099;
  t1103 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1091 * t101 - 0.3e1 / 0.8e1 * t1094 + t1096 / 0.4e1 - t1101);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1074 + t1103);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1106 = 0.2e1 * t451;
  t1107 = 0.2e1 * t488;
  t1108 = t431 * t27;
  t1109 = t1108 * t146;
  t1112 = t183 * t117;
  t1113 = t1112 * t146;
  t1115 = t1113 * t149 / 0.9e1;
  t1116 = t439 * t378;
  t1127 = t925 * t180;
  t1130 = t301 * t427;
  t1135 = 0.2e1 * t306;
  t1136 = 0.6e1 * t934;
  t1138 = my_piecewise5(t10, 0, t14, 0, t1135 - t1136);
  t1142 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1127 * t302 + 0.8e1 / 0.9e1 * t1130 * t109 + 0.4e1 / 0.9e1 * t423 * t310 + 0.4e1 / 0.3e1 * t23 * t1138);
  t1143 = t5 * t1142;
  t1149 = t184 * t321 / 0.4e1;
  t1152 = t432 * t119 / 0.4e1;
  t1153 = t184 * t371;
  t1157 = -t1109 * t149 / 0.3e1 - t1115 - t1116 * t149 / 0.3e1 + 0.7e1 / 0.18e2 * t440 * t392 - t853 / 0.9e1 + 0.2e1 / 0.27e2 * t857 - t866 / 0.9e1 + 0.7e1 / 0.54e2 * t870 - 0.3e1 / 0.8e1 * t184 * t340 - 0.3e1 / 0.8e1 * t1143 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1149 - t878 / 0.8e1 - t1152 + t1153 / 0.12e2 + t908 / 0.6e1 - t915 - t916 / 0.8e1;
  t1162 = t1108 * t152;
  t1165 = t1112 * t152;
  t1167 = t1165 * t157 / 0.27e2;
  t1168 = t439 * t388;
  t1175 = t439 * t283;
  t1179 = t439 * t350;
  t1182 = t439 * t358;
  t1185 = t439 * t343;
  t1191 = -t918 / 0.4e1 + t922 / 0.6e1 + 0.7e1 / 0.54e2 * t443 * t297 - t1162 * t157 / 0.9e1 - t1167 - t1168 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t947 - t975 / 0.27e2 - t982 / 0.27e2 + 0.2e1 / 0.81e2 * t985 - 0.8e1 / 0.81e2 * t1175 * t290 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t353 - 0.8e1 / 0.729e3 * t1182 * t347 - 0.4e1 / 0.729e3 * t1185 * t347 - 0.4e1 / 0.2187e4 * t1044 - 0.8e1 / 0.729e3 * t1047 - 0.8e1 / 0.2187e4 * t1050;
  t1193 = my_piecewise3(t1, 0, t1157 + t1191);
  t1194 = t1076 * t190;
  t1197 = t398 * t456;
  t1202 = 0.6e1 * t1083;
  t1204 = my_piecewise5(t14, 0, t10, 0, -t1135 - t1202);
  t1208 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1194 * t399 + 0.8e1 / 0.9e1 * t1197 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1204);
  t1209 = t5 * t1208;
  t1213 = t461 * t172 / 0.4e1;
  t1214 = t194 * t416;
  t1221 = t168 * t470 / 0.4e1;
  t1223 = t369 * t210 * t100;
  t1224 = t74 * t1223;
  t1226 = t409 * t27;
  t1227 = t1226 * t218;
  t1230 = t167 * t117;
  t1231 = t1230 * t218;
  t1233 = t1231 * t221 / 0.9e1;
  t1234 = t73 * t369;
  t1235 = t1234 * t218;
  t1236 = t1235 * t221;
  t1238 = t1226 * t224;
  t1241 = t1230 * t224;
  t1243 = t1241 * t229 / 0.27e2;
  t1244 = t1234 * t224;
  t1245 = t1244 * t229;
  t1247 = -0.3e1 / 0.8e1 * t1209 * t101 - t1213 + t1214 / 0.12e2 - t1094 / 0.8e1 + t1096 / 0.6e1 - t1101 - 0.3e1 / 0.8e1 * t410 * t212 - t1221 + t1224 / 0.12e2 - t1227 * t221 / 0.6e1 - t1233 + t1236 / 0.27e2 - t1238 * t229 / 0.18e2 - t1243 + t1245 / 0.81e2;
  t1248 = my_piecewise3(t65, 0, t1247);
  tv3rho31 = t396 + t420 + t1106 + t1107 + t6 * (t1193 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1251 = t925 * t493;
  t1256 = t301 * t498;
  t1260 = my_piecewise5(t10, 0, t14, 0, -t1135 - t1136);
  t1264 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1251 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1256 * t109 + 0.4e1 / 0.3e1 * t23 * t1260);
  t1265 = t5 * t1264;
  t1268 = t503 * t119;
  t1272 = t502 * t27;
  t1273 = t1272 * t146;
  t1276 = t1272 * t152;
  t1284 = -0.3e1 / 0.8e1 * t1265 * t61 - t1268 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1273 * t149 / 0.6e1 - t1276 * t157 / 0.18e2 - t1152 + t1153 / 0.6e1 - t1149 - t1115 - t1167 + t908 / 0.12e2 - t915 + t922 / 0.12e2 + t857 / 0.27e2 + t985 / 0.81e2;
  t1285 = my_piecewise3(t1, 0, t1284);
  t1286 = t193 * t117;
  t1287 = t1286 * t218;
  t1288 = t1287 * t221;
  t1290 = t477 * t513;
  t1291 = t1290 * t221;
  t1293 = t478 * t598;
  t1298 = t460 * t27;
  t1299 = t1298 * t218;
  t1302 = t473 * t513;
  t1305 = t194 * t470;
  t1308 = t117 * t565 * t100;
  t1309 = t74 * t1308;
  t1311 = t549 * t172;
  t1313 = t1076 * t539;
  t1318 = t398 * t544;
  t1322 = my_piecewise5(t14, 0, t10, 0, t1135 - t1202);
  t1326 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1313 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1318 * t164 + 0.4e1 / 0.3e1 * t71 * t1322);
  t1327 = t5 * t1326;
  t1336 = -t1288 / 0.9e1 - t1291 / 0.9e1 + 0.7e1 / 0.54e2 * t1293 - t1233 + 0.2e1 / 0.27e2 * t1236 + 0.7e1 / 0.18e2 * t474 * t598 - t1299 * t221 / 0.3e1 - t1302 * t221 / 0.3e1 - t1305 / 0.4e1 - t1309 / 0.8e1 - t1311 / 0.8e1 - 0.3e1 / 0.8e1 * t1327 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t567 - t1213 + t1214 / 0.6e1 - t1221 + t1224 / 0.6e1;
  t1338 = t1286 * t224;
  t1339 = t1338 * t229;
  t1341 = t477 * t594;
  t1342 = t1341 * t229;
  t1344 = t484 * t522;
  t1348 = t1298 * t224;
  t1351 = t473 * t594;
  t1355 = t477 * t529;
  t1356 = t1355 * t536;
  t1358 = t473 * t529;
  t1361 = t477 * t578;
  t1362 = t1361 * t582;
  t1364 = t477 * t585;
  t1365 = t1364 * t582;
  t1367 = t477 * t570;
  t1368 = t1367 * t573;
  t1370 = t473 * t570;
  t1373 = t473 * t578;
  t1376 = t473 * t585;
  t1379 = t1096 / 0.12e2 - t1101 - t1339 / 0.27e2 - t1342 / 0.27e2 + 0.7e1 / 0.162e3 * t1344 + 0.7e1 / 0.54e2 * t481 * t522 - t1348 * t229 / 0.9e1 - t1351 * t229 / 0.9e1 - t1243 + 0.2e1 / 0.81e2 * t1245 - 0.8e1 / 0.243e3 * t1356 - 0.8e1 / 0.81e2 * t1358 * t536 - 0.8e1 / 0.2187e4 * t1362 - 0.4e1 / 0.2187e4 * t1365 - 0.8e1 / 0.729e3 * t1368 - 0.8e1 / 0.243e3 * t1370 * t573 - 0.8e1 / 0.729e3 * t1373 * t582 - 0.4e1 / 0.729e3 * t1376 * t582;
  t1381 = my_piecewise3(t65, 0, t1336 + t1379);
  tv3rho32 = t1106 + t1107 + t508 + t602 + t6 * (t1285 + t1381);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1386 = t493 * t180;
  t1393 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t306 - 0.6e1 * t934);
  t1397 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t1386 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1393);
  t1398 = t5 * t1397;
  t1404 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1398 * t61 - 0.3e1 / 0.8e1 * t1268 + t1153 / 0.4e1 - t915);
  t1412 = t548 * t27;
  t1413 = t1412 * t218;
  t1416 = t509 * t513;
  t1418 = t565 * t217;
  t1419 = t215 * t1418;
  t1423 = 0.1e1 / t77 / t531;
  t1424 = t84 * t1423;
  t1425 = t220 * t1424;
  t1429 = t539 * t190;
  t1436 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t306 - 0.6e1 * t1083);
  t1440 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1429 + 0.4e1 / 0.3e1 * t452 * t544 + 0.4e1 / 0.3e1 * t71 * t1436);
  t1441 = t5 * t1440;
  t1448 = 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1288 / 0.3e1 - t1291 / 0.3e1 + 0.7e1 / 0.18e2 * t1293 - t1413 * t221 / 0.2e1 - t1416 * t221 - t1419 * t221 / 0.2e1 - 0.35e2 / 0.27e2 * t219 * t1425 + t1236 / 0.9e1 - 0.3e1 / 0.8e1 * t1441 * t101 - 0.9e1 / 0.8e1 * t549 * t212 - 0.9e1 / 0.8e1 * t194 * t567;
  t1449 = t531 * rho[1];
  t1451 = 0.1e1 / t78 / t1449;
  t1452 = t75 * t1451;
  t1455 = t1424 * t206;
  t1462 = t893 * t796;
  t1463 = t531 * t197;
  t1464 = 0.1e1 / t1463;
  t1466 = 0.1e1 / t560 / t91;
  t1467 = t1464 * t1466;
  t1470 = -0.2464e4 / 0.2187e4 * t29 * t1452 - 0.28e3 / 0.729e3 * t130 * t1455 + 0.224e3 / 0.2187e4 * t331 * sigma[2] * t1451 * t561 - 0.512e3 / 0.59049e5 * t1462 * t1467;
  t1472 = t27 * t1470 * t100;
  t1484 = t216 * t216;
  t1485 = 0.1e1 / t1484;
  t1486 = t94 * t1485;
  t1487 = t215 * t1486;
  t1488 = t99 * t796;
  t1489 = t1464 * t2;
  t1491 = t1488 * t1489 * t28;
  t1494 = t1412 * t224;
  t1497 = t509 * t594;
  t1500 = t565 * t98;
  t1501 = t215 * t1500;
  t1504 = -0.3e1 / 0.8e1 * t74 * t1472 - 0.3e1 / 0.4e1 * t1305 - 0.3e1 / 0.8e1 * t1309 - 0.3e1 / 0.8e1 * t1311 + t1214 / 0.4e1 + t1224 / 0.4e1 - t1101 + 0.7e1 / 0.18e2 * t591 * t522 + 0.7e1 / 0.18e2 * t595 * t522 - 0.64e2 / 0.243e3 * t1487 * t1491 - t1494 * t229 / 0.6e1 - t1497 * t229 / 0.3e1 - t1501 * t229 / 0.6e1;
  t1509 = t228 * t1455;
  t1514 = t528 * t227;
  t1515 = t215 * t1514;
  t1516 = t796 * t1464;
  t1517 = t29 * t206;
  t1518 = t1516 * t1517;
  t1521 = t218 * t577;
  t1522 = t215 * t1521;
  t1523 = t29 * t561;
  t1524 = t1516 * t1523;
  t1529 = t226 * t226;
  t1530 = 0.1e1 / t1529;
  t1531 = t224 * t1530;
  t1532 = t215 * t1531;
  t1534 = t1466 * t2 * t28;
  t1535 = t1516 * t1534;
  t1542 = t509 * t529;
  t1545 = -t1339 / 0.9e1 - t1342 / 0.9e1 + 0.7e1 / 0.54e2 * t1344 - 0.35e2 / 0.81e2 * t225 * t1509 + t1245 / 0.27e2 - 0.8e1 / 0.81e2 * t1356 - 0.64e2 / 0.729e3 * t1515 * t1518 - 0.64e2 / 0.2187e4 * t1522 * t1524 - 0.32e2 / 0.2187e4 * t571 * t1524 - 0.64e2 / 0.6561e4 * t1532 * t1535 - 0.64e2 / 0.6561e4 * t579 * t1535 - 0.64e2 / 0.19683e5 * t586 * t1535 - 0.8e1 / 0.27e2 * t1542 * t536;
  t1546 = t210 * t527;
  t1547 = t1546 * t99;
  t1548 = t215 * t1547;
  t1552 = t1451 * t41 * t3;
  t1553 = t75 * t1552;
  t1556 = t509 * t578;
  t1559 = t594 * t577;
  t1560 = t215 * t1559;
  t1563 = t509 * t585;
  t1566 = t594 * t227;
  t1567 = t215 * t1566;
  t1570 = t509 * t570;
  t1573 = t513 * t227;
  t1574 = t215 * t1573;
  t1577 = t1452 * t572;
  t1580 = t1452 * t581;
  t1588 = -0.8e1 / 0.27e2 * t1548 * t536 + 0.56e2 / 0.81e2 * t530 * t1553 - 0.8e1 / 0.243e3 * t1556 * t582 - 0.8e1 / 0.243e3 * t1560 * t582 - 0.4e1 / 0.243e3 * t1563 * t582 - 0.4e1 / 0.243e3 * t1567 * t582 - 0.8e1 / 0.81e2 * t1570 * t573 - 0.8e1 / 0.81e2 * t1574 * t573 + 0.56e2 / 0.243e3 * t571 * t1577 + 0.56e2 / 0.729e3 * t579 * t1580 + 0.28e2 / 0.729e3 * t586 * t1580 - 0.8e1 / 0.729e3 * t1362 - 0.4e1 / 0.729e3 * t1365 - 0.8e1 / 0.243e3 * t1368;
  t1591 = my_piecewise3(t65, 0, t1448 + t1504 + t1545 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1404 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1599 = t1049 * t659;
  t1601 = t1043 * t659;
  t1605 = t1046 * t647;
  t1609 = t285 * t32;
  t1610 = 0.1e1 / t1609;
  t1611 = t1610 * t2;
  t1613 = t28 * t44 * t134;
  t1614 = t1611 * t1613;
  t1618 = t28 * t334 * t44;
  t1619 = t1611 * t1618;
  t1624 = t244 * t281;
  t1625 = t1624 * t59;
  t1626 = t143 * t1625;
  t1629 = t30 * t287;
  t1630 = t1629 * t346;
  t1633 = t1629 * t352;
  t1638 = t1610 * t898;
  t1639 = t29 * t44;
  t1640 = t1638 * t1639;
  t1643 = 0.2e1 / 0.243e3 * t1056 * t659 + t1033 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1599 + t1601 / 0.729e3 + 0.2e1 / 0.81e2 * t1040 * t647 + 0.2e1 / 0.243e3 * t1605 + 0.2e1 / 0.81e2 * t1053 * t647 + 0.8e1 / 0.243e3 * t993 * t1614 + 0.8e1 / 0.729e3 * t1012 * t1619 + 0.4e1 / 0.729e3 * t351 * t1619 - 0.8e1 / 0.81e2 * t1626 * t290 - 0.5e1 / 0.243e3 * t359 * t1630 - 0.5e1 / 0.81e2 * t351 * t1633 - 0.5e1 / 0.486e3 * t344 * t1630 + 0.8e1 / 0.6561e4 * t344 * t1640;
  t1654 = t239 * t294;
  t1655 = t148 * t1654;
  t1660 = t852 * t249;
  t1665 = t856 * t249 / 0.72e2;
  t1666 = t375 * t650;
  t1668 = t374 * t626;
  t1669 = t1668 * t149;
  t1671 = t621 * t145;
  t1672 = t143 * t1671;
  t1679 = 0.2e1 / 0.243e3 * t1060 * t659 + t1037 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t1018 * t1640 + 0.8e1 / 0.2187e4 * t359 * t1640 - t379 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1655 + 0.7e1 / 0.18e2 * t627 * t392 + t1660 / 0.24e2 - t365 * t650 / 0.6e1 - t1665 - t1666 / 0.18e2 - t1669 / 0.9e1 - t1672 * t149 / 0.3e1 + t860 * t249 / 0.16e2 + t863 * t249 / 0.8e1;
  t1681 = t865 * t249;
  t1685 = t364 * t626;
  t1689 = t369 * t244 * t60;
  t1691 = t26 * t1689 / 0.12e2;
  t1692 = t113 * t608;
  t1699 = t117 * t621 * t60;
  t1700 = t26 * t1699;
  t1704 = t1654 * t134;
  t1711 = t898 * t44;
  t1714 = 0.176e3 / 0.729e3 * t29 * t1629 + 0.14e2 / 0.243e3 * t130 * t1704 - 0.2e2 / 0.729e3 * t330 * t1629 * t334 + 0.64e2 / 0.19683e5 * t893 * t1610 * t1711;
  t1716 = t27 * t1714 * t60;
  t1721 = t156 * t1704;
  t1724 = t981 * t252;
  t1729 = t984 * t252 / 0.216e3;
  t1730 = t385 * t662;
  t1732 = t1681 / 0.24e2 + t848 * t249 / 0.16e2 - t1685 * t149 / 0.3e1 + t1691 - t1692 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t246 - 0.3e1 / 0.4e1 * t113 * t623 - t1700 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1716 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1721 + t1724 / 0.72e2 - t382 * t662 / 0.18e2 - t1729 - t1730 / 0.54e2;
  t1733 = t641 * t289;
  t1738 = t364 * t630;
  t1741 = t374 * t630;
  t1742 = t1741 * t157;
  t1746 = t143 * t987;
  t1750 = t59 * t1610 * t1639;
  t1757 = t974 * t252;
  t1759 = t621 * t58;
  t1760 = t143 * t1759;
  t1763 = t364 * t282;
  t1766 = t374 * t282;
  t1767 = t1766 * t644;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t357;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -0.5e1 / 0.27e2 * t640 * t1733 + 0.7e1 / 0.54e2 * t631 * t297 - t1738 * t157 / 0.9e1 - t1742 / 0.27e2 + t978 * t252 / 0.48e2 + 0.2e1 / 0.27e2 * t1746 * t644 + 0.8e1 / 0.81e2 * t955 * t1750 + t966 * t252 / 0.48e2 + t971 * t252 / 0.24e2 + t1757 / 0.72e2 - t1760 * t157 / 0.9e1 + 0.2e1 / 0.27e2 * t1763 * t644 + 0.2e1 / 0.81e2 * t1767 - 0.8e1 / 0.243e3 * t1770 * t353 - 0.8e1 / 0.729e3 * t1774 * t347 - 0.4e1 / 0.729e3 * t1778 * t347;
  t1784 = my_piecewise3(t1, 0, t1643 + t1679 + t1732 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t369 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1231 * t270;
  t1800 = t1235 * t270 / 0.72e2;
  t1803 = t1241 * t273;
  t1806 = t1244 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1227 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1238 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1819 = t1113 * t249;
  t1823 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1599 / 0.729e3 + t1601 / 0.1458e4 + t1605 / 0.243e3 + t1819 / 0.48e2 - t440 * t650 / 0.12e2 - t1823 * t149 / 0.6e1 + t1109 * t249 / 0.16e2 + t1116 * t249 / 0.16e2 + t1660 / 0.48e2 - t1665 - t1666 / 0.36e2 - t1669 / 0.18e2 + t1681 / 0.48e2 - t1834 / 0.8e1;
  t1843 = t439 * t282;
  t1850 = t1165 * t252;
  t1857 = t439 * t630;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 + t1691 - t1692 / 0.8e1 - t1700 / 0.8e1 + t1843 * t644 / 0.27e2 + t1162 * t252 / 0.48e2 + t1168 * t252 / 0.48e2 + t1850 / 0.144e3 - t443 * t662 / 0.36e2 + t1724 / 0.144e3 - t1729 - t1730 / 0.108e3 - t1742 / 0.54e2 - t1857 * t157 / 0.18e2 + t1757 / 0.144e3 + t1767 / 0.81e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1874 = t1361 * t742;
  t1876 = t1364 * t742;
  t1878 = t1367 * t732;
  t1883 = t478 * t735;
  t1885 = t477 * t713;
  t1886 = t1885 * t221;
  t1888 = t1287 * t270;
  t1890 = t1290 * t270;
  t1892 = t473 * t713;
  t1899 = t1302 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1376 * t742 / 0.486e3 + t1370 * t732 / 0.81e2 + t1874 / 0.729e3 + t1876 / 0.1458e4 + t1878 / 0.243e3 + t1373 * t742 / 0.243e3 + t1797 / 0.48e2 - t1800 - t1883 / 0.36e2 - t1886 / 0.18e2 + t1888 / 0.48e2 + t1890 / 0.48e2 - t1892 * t221 / 0.6e1 + t1299 * t270 / 0.16e2 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t194 * t673;
  t1906 = t117 * t708 * t100;
  t1907 = t74 * t1906;
  t1909 = t1341 * t273;
  t1911 = t484 * t745;
  t1913 = t477 * t717;
  t1914 = t1913 * t229;
  t1916 = t477 * t528;
  t1917 = t1916 * t729;
  t1919 = t1338 * t273;
  t1921 = t473 * t528;
  t1930 = t473 * t717;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1789 / 0.8e1 + t1794 - t1903 / 0.8e1 - t1907 / 0.8e1 + t1909 / 0.144e3 - t1911 / 0.108e3 - t1914 / 0.54e2 + t1917 / 0.81e2 + t1919 / 0.144e3 + t1921 * t729 / 0.27e2 + t1348 * t273 / 0.48e2 + t1351 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1930 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1691 + t1273 * t249 / 0.16e2 + t1819 / 0.24e2 - t1665 + t1276 * t252 / 0.48e2 + t1850 / 0.72e2 - t1729);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t260 * t519;
  t1953 = t220 * t1952;
  t1968 = t509 * t713;
  t1971 = t708 * t217;
  t1972 = t215 * t1971;
  t1975 = t713 * t227;
  t1976 = t215 * t1975;
  t1979 = t717 * t577;
  t1980 = t215 * t1979;
  t1983 = t717 * t227;
  t1984 = t215 * t1983;
  t1987 = t30 * t533;
  t1988 = t1987 * t572;
  t1991 = t531 * t76;
  t1992 = 0.1e1 / t1991;
  t1993 = t1992 * t2;
  t1995 = t28 * t84 * t206;
  t1996 = t1993 * t1995;
  t2000 = t28 * t561 * t84;
  t2001 = t1993 * t2000;
  t2004 = 0.7e1 / 0.36e2 * t219 * t1953 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t714 * t598 + t1413 * t270 / 0.16e2 + t1416 * t270 / 0.8e1 + t1419 * t270 / 0.16e2 - t1968 * t221 / 0.3e1 - t1972 * t221 / 0.3e1 - 0.8e1 / 0.243e3 * t1976 * t573 - 0.8e1 / 0.729e3 * t1980 * t582 - 0.4e1 / 0.729e3 * t1984 * t582 - 0.5e1 / 0.81e2 * t571 * t1988 + 0.8e1 / 0.243e3 * t1515 * t1996 + 0.8e1 / 0.729e3 * t1522 * t2001;
  t2013 = t265 * t527;
  t2014 = t2013 * t99;
  t2015 = t215 * t2014;
  t2018 = t1987 * t581;
  t2024 = t1992 * t1466;
  t2025 = t29 * t84;
  t2026 = t2024 * t2025;
  t2039 = 0.4e1 / 0.729e3 * t571 * t2001 + 0.2e1 / 0.243e3 * t1556 * t742 + 0.2e1 / 0.81e2 * t1570 * t732 + 0.2e1 / 0.81e2 * t1574 * t732 - 0.8e1 / 0.81e2 * t2015 * t536 - 0.5e1 / 0.243e3 * t579 * t2018 + 0.2e1 / 0.729e3 * t1874 + t1876 / 0.729e3 + 0.2e1 / 0.243e3 * t1878 + 0.8e1 / 0.2187e4 * t1532 * t2026 + 0.8e1 / 0.2187e4 * t579 * t2026 - 0.5e1 / 0.486e3 * t586 * t2018 + 0.8e1 / 0.6561e4 * t586 * t2026 + t1563 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t1560 * t742;
  t2053 = t1952 * t206;
  t2060 = t1466 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1987 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t330 * t1987 * t561 + 0.64e2 / 0.19683e5 * t893 * t1992 * t2060;
  t2065 = t27 * t2063 * t100;
  t2076 = t1567 * t742 / 0.243e3 - t1800 - t1883 / 0.18e2 - t1886 / 0.9e1 + t1888 / 0.24e2 + t1890 / 0.24e2 - 0.3e1 / 0.8e1 * t549 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 + t1794 - t1903 / 0.4e1 - t1907 / 0.4e1 + 0.7e1 / 0.54e2 * t718 * t522 + t1494 * t273 / 0.48e2 + t1497 * t273 / 0.24e2;
  t2079 = t509 * t528;
  t2082 = t215 * t1546;
  t2086 = t99 * t1992 * t2025;
  t2089 = t509 * t717;
  t2092 = t708 * t98;
  t2093 = t215 * t2092;
  t2101 = t228 * t2053;
  t2106 = t726 * t535;
  t2111 = t1501 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2079 * t729 + 0.2e1 / 0.27e2 * t2082 * t729 + 0.8e1 / 0.81e2 * t1487 * t2086 - t2089 * t229 / 0.9e1 - t2093 * t229 / 0.9e1 + t1909 / 0.72e2 - t1911 / 0.54e2 - t1914 / 0.27e2 + 0.2e1 / 0.81e2 * t1917 + t1919 / 0.72e2 + 0.7e1 / 0.108e3 * t225 * t2101 - t595 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t725 * t2106 - t591 * t745 / 0.18e2 - t1806;
  t2114 = my_piecewise3(t65, 0, t2004 + t2039 + t2076 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2119 = t375 * t783 / 0.96e2;
  t2120 = t754 * t132;
  t2121 = t148 * t2120;
  t2125 = t1668 * t249 / 0.24e2;
  t2126 = t764 * t145;
  t2127 = t143 * t2126;
  t2139 = t1046 * t780 / 0.648e3;
  t2140 = t773 * t124;
  t2141 = t2140 * t352;
  t2145 = t1049 * t786 / 0.1944e4;
  t2146 = -t627 * t650 / 0.6e1 - t2119 + t147 * t2121 / 0.24e2 + t2125 - t2127 * t149 / 0.6e1 + t1685 * t249 / 0.8e1 + t1672 * t249 / 0.8e1 - t365 * t783 / 0.32e2 - t379 * t783 / 0.32e2 - t2139 + t351 * t2141 / 0.162e3 - t2145;
  t2147 = t2140 * t346;
  t2165 = t1043 * t786 / 0.3888e4;
  t2167 = t1025 * t776 / 0.216e3;
  t2168 = t773 * t643;
  t2171 = 0.1e1 / t880;
  t2172 = t239 * t2171;
  t2173 = t2172 * t1005;
  t2176 = t344 * t2147 / 0.972e3 - t1033 * t786 / 0.1296e4 - t1037 * t786 / 0.1296e4 - t1040 * t780 / 0.216e3 - t1053 * t780 / 0.216e3 - t1056 * t786 / 0.648e3 - t1060 * t786 / 0.648e3 + t359 * t2147 / 0.486e3 - t2165 - t2167 + t284 * t2168 / 0.54e2 - t359 * t2173 / 0.729e3;
  t2188 = t2172 * t995;
  t2191 = t2172 * t1000;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = -t344 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t1774 * t659 + t1778 * t659 / 0.243e3 - t1021 * t776 / 0.72e2 - t989 * t776 / 0.72e2 - t993 * t2188 / 0.81e2 - t1012 * t2191 / 0.243e3 - t351 * t2191 / 0.486e3 - t1018 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t1770 * t647 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2120 * t134;
  t2214 = t893 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t759 * t124 * t334 - 0.8e1 / 0.6561e4 * t2214 * t2171 * t898;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1741 * t252 / 0.72e2;
  t2232 = t143 * t1624;
  t2239 = t59 * t239;
  t2242 = t2239 * t2171 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1738 * t252 / 0.24e2 + t1760 * t252 / 0.24e2 - t955 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2146 + t2176 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1885 * t270 / 0.24e2;
  t2271 = t1913 * t273 / 0.72e2;
  t2275 = t1355 * t819 / 0.216e3;
  t2279 = t1367 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1361 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1364 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1892 * t270 / 0.8e1 + t2267 + t1930 * t273 / 0.24e2 + t2271 - t1358 * t819 / 0.72e2 - t2275 - t1370 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1373 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1376 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1823 * t249 / 0.8e1 + t2125 + t1857 * t252 / 0.24e2 + t2229 - t1175 * t776 / 0.72e2 - t2167 - t1179 * t780 / 0.216e3 - t2139 - t440 * t783 / 0.32e2 - t2119 - t1182 * t786 / 0.648e3 - t2145 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2165;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2320 = t797 * t204;
  t2321 = t220 * t2320;
  t2332 = t807 * t217;
  t2333 = t215 * t2332;
  t2338 = t816 * t199;
  t2339 = t2338 * t572;
  t2342 = t2338 * t581;
  t2347 = t219 * t2321 / 0.24e2 + t1968 * t270 / 0.8e1 + t1972 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 - t2333 * t221 / 0.6e1 + t2267 - t2283 - t714 * t735 / 0.6e1 + t571 * t2339 / 0.162e3 + t579 * t2342 / 0.486e3 + t586 * t2342 / 0.972e3;
  t2366 = -t1563 * t829 / 0.1296e4 - t1567 * t829 / 0.1296e4 - t1570 * t823 / 0.216e3 - t1574 * t823 / 0.216e3 - t1556 * t829 / 0.648e3 - t1560 * t829 / 0.648e3 - t2279 - t2287 - t2295 + t1984 * t742 / 0.243e3 - t1542 * t819 / 0.72e2 - t1548 * t819 / 0.72e2;
  t2368 = 0.1e1 / t1449;
  t2369 = t260 * t2368;
  t2370 = t2369 * t1517;
  t2373 = t2369 * t1523;
  t2378 = t816 * t728;
  t2381 = t2369 * t1534;
  t2392 = t2320 * t206;
  t2399 = t893 * t260;
  t2403 = t130 * t2392 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t802 * t199 * t561 - 0.8e1 / 0.6561e4 * t2399 * t2368 * t1466;
  t2405 = t27 * t2403 * t100;
  t2410 = -t1515 * t2370 / 0.81e2 - t1522 * t2373 / 0.243e3 - t571 * t2373 / 0.486e3 - t2275 + t530 * t2378 / 0.54e2 - t1532 * t2381 / 0.729e3 - t579 * t2381 / 0.729e3 - t586 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t1976 * t732 + 0.2e1 / 0.243e3 * t1980 * t742 - 0.3e1 / 0.8e1 * t74 * t2405 - 0.3e1 / 0.8e1 * t194 * t809;
  t2411 = t228 * t2392;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2013;
  t2427 = t99 * t260;
  t2430 = t2427 * t2368 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2089 * t273 / 0.24e2 + t2093 * t273 / 0.24e2 - t1487 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2347 + t2366 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t346;
  t2455 = t2444 * t775;
  t2458 = 0.1e1 / t285;
  t2459 = t754 * t2458;
  t2460 = t2459 * t1005;
  t2463 = t2459 * t995;
  t2466 = t2459 * t1000;
  t2475 = t344 * t2446 / 0.864e3 - t1770 * t780 / 0.72e2 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t284 * t2455 / 0.48e2 + t344 * t2460 / 0.5832e4 + t993 * t2463 / 0.216e3 + t1012 * t2466 / 0.648e3 + t351 * t2466 / 0.1296e4 + t1018 * t2460 / 0.1944e4 + t359 * t2460 / 0.1944e4;
  t2477 = 0.1e1 / t44 / t2442;
  t2478 = t2477 * t47;
  t2479 = t2478 * t134;
  t2480 = t156 * t2479;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2478;
  t2502 = t2445 * t352;
  t2514 = t2458 * t898;
  t2517 = t130 * t2479 / 0.72e2 + t331 * t2443 * t36 * t334 / 0.324e3 + t893 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t153 * t2480 / 0.64e2 - t1626 * t776 / 0.24e2 - t631 * t789 / 0.32e2 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t955 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2127 * t249 + t351 * t2502 / 0.144e3 + t359 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2475 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2526 = 0.1e1 / t2525;
  t2527 = t30 * t2526;
  t2528 = t2527 * t80;
  t2529 = t2528 * t581;
  t2534 = t2527 * t818;
  t2542 = 0.1e1 / t84 / t2525;
  t2543 = t2542 * t87;
  t2544 = t2543 * t206;
  t2545 = t228 * t2544;
  t2548 = 0.1e1 / t531;
  t2549 = t797 * t2548;
  t2550 = t2549 * t1534;
  t2555 = t2549 * t1517;
  t2558 = t2549 * t1523;
  t2563 = t586 * t2529 / 0.864e3 - t1984 * t829 / 0.432e3 + t530 * t2534 / 0.48e2 - t1976 * t823 / 0.72e2 - t1980 * t829 / 0.216e3 + t225 * t2545 / 0.64e2 + t586 * t2550 / 0.5832e4 - t718 * t832 / 0.32e2 + t1515 * t2555 / 0.216e3 + t1522 * t2558 / 0.648e3 + t571 * t2558 / 0.1296e4;
  t2570 = t220 * t2543;
  t2579 = t2548 * t2 * t28;
  t2580 = t99 * t797 * t2579;
  t2587 = t2528 * t572;
  t2597 = t2548 * t1466;
  t2600 = t130 * t2544 / 0.72e2 + t331 * t2526 * t80 * t561 / 0.324e3 + t893 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1532 * t2550 / 0.1944e4 + t579 * t2550 / 0.1944e4 - t2015 * t819 / 0.24e2 + 0.3e1 / 0.64e2 * t219 * t2570 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1487 * t2580 / 0.72e2 + 0.3e1 / 0.16e2 * t2333 * t270 + t579 * t2529 / 0.432e3 + t571 * t2587 / 0.144e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2563 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t519, t520, t521, t522, t527;
  double t528, t529, t530, t531, t533, t535, t536, t539;
  double t544, t548, t549, t554, t560, t561, t565, t567;
  double t570, t571, t572, t573, t577, t578, t579, t581;
  double t582, t585, t586, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t842, t843, t844, t847, t848, t851, t852, t853;
  double t855, t856, t857, t859, t860, t863, t865, t866;
  double t870, t877, t878, t880, t882, t883, t886, t893;
  double t894, t895, t896, t898, t899, t902, t904, t907;
  double t908, t911, t913, t915, t916, t918, t921, t922;
  double t925, t926, t929, t932, t933, t934, t937, t941;
  double t942, t947, t949, t952, t953, t954, t955, t956;
  double t957, t959, t966, t969, t971, t974, t975, t977;
  double t978, t981, t982, t984, t985, t987, t988, t989;
  double t992, t993, t994, t995, t996, t1000, t1001, t1005;
  double t1006, t1011, t1012, t1015, t1016, t1017, t1018, t1021;
  double t1024, t1025, t1026, t1029, t1030, t1033, t1036, t1037;
  double t1040, t1043, t1044, t1046, t1047, t1049, t1050, t1052;
  double t1053, t1056, t1059, t1060, t1063, t1066, t1071, t1074;
  double t1076, t1077, t1080, t1083, t1086, t1090, t1091, t1094;
  double t1096, t1099, t1101, t1103, tv3rho30, t1106, t1107, t1108;
  double t1109, t1112, t1113, t1115, t1116, t1127, t1130, t1135;
  double t1136, t1138, t1142, t1143, t1149, t1152, t1153, t1157;
  double t1162, t1165, t1167, t1168, t1175, t1179, t1182, t1185;
  double t1191, t1193, t1194, t1197, t1202, t1204, t1208, t1209;
  double t1213, t1214, t1221, t1223, t1224, t1226, t1227, t1230;
  double t1231, t1233, t1234, t1235, t1236, t1238, t1241, t1243;
  double t1244, t1245, t1247, t1248, tv3rho31, t1251, t1256, t1260;
  double t1264, t1265, t1268, t1272, t1273, t1276, t1284, t1285;
  double t1286, t1287, t1288, t1290, t1291, t1293, t1298, t1299;
  double t1302, t1305, t1308, t1309, t1311, t1313, t1318, t1322;
  double t1326, t1327, t1336, t1338, t1339, t1341, t1342, t1344;
  double t1348, t1351, t1355, t1356, t1358, t1361, t1362, t1364;
  double t1365, t1367, t1368, t1370, t1373, t1376, t1379, t1381;
  double tv3rho32, t1386, t1393, t1397, t1398, t1404, t1412, t1413;
  double t1416, t1418, t1419, t1423, t1424, t1425, t1429, t1436;
  double t1440, t1441, t1448, t1449, t1451, t1452, t1455, t1462;
  double t1463, t1464, t1466, t1467, t1470, t1472, t1484, t1485;
  double t1486, t1487, t1488, t1489, t1491, t1494, t1497, t1500;
  double t1501, t1504, t1509, t1514, t1515, t1516, t1517, t1518;
  double t1521, t1522, t1523, t1524, t1529, t1530, t1531, t1532;
  double t1534, t1535, t1542, t1545, t1546, t1547, t1548, t1552;
  double t1553, t1556, t1559, t1560, t1563, t1566, t1567, t1570;
  double t1573, t1574, t1577, t1580, t1588, t1591, tv3rho33, t1599;
  double t1601, t1605, t1609, t1610, t1611, t1613, t1614, t1618;
  double t1619, t1624, t1625, t1626, t1629, t1630, t1633, t1638;
  double t1639, t1640, t1643, t1654, t1655, t1660, t1665, t1666;
  double t1668, t1669, t1671, t1672, t1679, t1681, t1685, t1689;
  double t1691, t1692, t1699, t1700, t1704, t1711, t1714, t1716;
  double t1721, t1724, t1729, t1730, t1732, t1733, t1738, t1741;
  double t1742, t1746, t1750, t1757, t1759, t1760, t1763, t1766;
  double t1767, t1769, t1770, t1773, t1774, t1777, t1778, t1781;
  double t1784, tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800;
  double t1803, t1806, t1808, tv3rho2sigma2, t1819, t1823, t1834, t1836;
  double t1843, t1850, t1857, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1874;
  double t1876, t1878, t1883, t1885, t1886, t1888, t1890, t1892;
  double t1899, t1903, t1906, t1907, t1909, t1911, t1913, t1914;
  double t1916, t1917, t1919, t1921, t1930, t1934, t1936, tv3rho2sigma5;
  double t1949, tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1968, t1971, t1972;
  double t1975, t1976, t1979, t1980, t1983, t1984, t1987, t1988;
  double t1991, t1992, t1993, t1995, t1996, t2000, t2001, t2004;
  double t2013, t2014, t2015, t2018, t2024, t2025, t2026, t2039;
  double t2053, t2060, t2063, t2065, t2076, t2079, t2082, t2086;
  double t2089, t2092, t2093, t2101, t2106, t2111, t2114, tv3rho2sigma8;
  double t2119, t2120, t2121, t2125, t2126, t2127, t2139, t2140;
  double t2141, t2145, t2146, t2147, t2165, t2167, t2168, t2171;
  double t2172, t2173, t2176, t2188, t2191, t2201, t2203, t2206;
  double t2207, t2214, t2218, t2220, t2224, t2225, t2229, t2232;
  double t2239, t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275;
  double t2279, t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25;
  double t2317, t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2320;
  double t2321, t2332, t2333, t2338, t2339, t2342, t2347, t2366;
  double t2368, t2369, t2370, t2373, t2378, t2381, t2392, t2399;
  double t2403, t2405, t2410, t2411, t2416, t2417, t2420, t2427;
  double t2430, t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445;
  double t2446, t2455, t2458, t2459, t2460, t2463, t2466, t2475;
  double t2477, t2478, t2479, t2480, t2493, t2494, t2497, t2502;
  double t2514, t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2526;
  double t2527, t2528, t2529, t2534, t2542, t2543, t2544, t2545;
  double t2548, t2549, t2550, t2555, t2558, t2563, t2570, t2579;
  double t2580, t2587, t2597, t2600, t2602, t2605, t2607, tv3sigma39;

  double t2610, t2615, t2616, t2624, t2626, t2630, t2631, t2635;
  double t2637, t2638, t2639, t2641, t2642, t2643, t2645, t2646;
  double t2648, t2649, t2650, t2652, t2653, t2655, t2656, t2657;
  double t2660, t2663, t2667, t2670, t2671, t2679, t2681, t2682;
  double t2684, t2686, t2687, t2689, t2692, t2695, t2700, t2703;
  double t2705, t2709, t2710, t2714, t2719, t2722, t2723, t2725;
  double t2726, t2728, t2729, t2731, t2732, t2734, t2735, t2737;
  double t2738, t2744, t2747, t2751, t2755, t2758, t2759, t2762;
  double t2765, t2766, t2769, t2772, t2774, t2776, t2778, t2779;
  double t2781, t2782, t2784, t2785, t2787, t2789, t2792, t2793;
  double t2799, t2802, t2803, t2804, t2805, t2807, t2808, t2815;
  double t2822, t2826, t2830, t2832, t2833, t2836, t2840, t2844;
  double t2846, t2849, t2853, t2855, t2860, t2862, t2863, t2874;
  double t2875, t2877, t2878, t2885, t2886, t2887, t2894, t2908;
  double t2910, t2911, t2917, t2923, t2924, t2927, t2931, t2942;
  double t2946, t2947, t2949, t2951, t2953, t2956, t2958, t2960;
  double t2962, t2966, t2972, t2976, t2986, t2990, t2998, t3001;
  double t3004, t3005, t3008, t3011, t3012, t3022, t3029, t3034;
  double t3035, t3038, t3041, t3043, t3049, t3052, t3055, t3056;
  double t3058, t3059, t3061, t3062, t3064, t3066, t3071, t3072;
  double t3074, t3078, t3079, t3081, t3082, t3088, t3093, t3096;
  double t3100, t3104, t3106, t3108, t3113, t3115, tv4rho40, t3120;
  double t3121, t3122, t3124, t3125, t3128, t3130, t3131, t3132;
  double t3133, t3134, t3135, t3137, t3144, t3151, t3159, t3163;
  double t3164, t3166, t3167, t3169, t3172, t3175, t3183, t3186;
  double t3189, t3192, t3193, t3201, t3217, t3220, t3225, t3232;
  double t3235, t3236, t3238, t3241, t3246, t3248, t3249, t3250;
  double t3251, t3253, t3255, t3257, t3258, t3279, t3280, t3282;
  double t3286, t3296, t3311, t3317, t3319, t3326, t3329, t3332;
  double t3335, t3336, t3338, t3339, t3341, t3342, t3343, t3344;
  double t3348, t3349, t3350, t3351, t3352, t3353, t3354, t3355;
  double t3357, t3358, t3359, t3361, t3362, t3365, t3367, t3368;
  double t3369, t3371, t3373, t3374, t3377, t3400, t3402, t3406;
  double t3410, t3411, t3413, t3416, t3417, t3419, t3420, t3421;
  double t3422, t3423, tv4rho41, t3430, t3433, t3434, t3437, t3438;
  double t3439, t3451, t3454, t3455, t3458, t3467, t3472, t3474;
  double t3484, t3497, t3501, t3505, t3509, t3522, t3535, t3536;
  double t3538, t3541, t3544, t3547, t3550, t3551, t3554, t3557;
  double t3558, t3560, t3562, t3563, t3565, t3566, t3567, t3569;
  double t3571, t3572, t3573, t3578, t3579, t3581, t3582, t3583;
  double t3585, t3586, t3588, t3589, t3591, t3594, t3597, t3600;
  double t3601, t3603, t3604, t3606, t3609, t3610, t3612, t3613;
  double t3619, t3621, t3623, t3625, t3635, t3648, t3652, t3656;
  double t3658, t3662, t3670, t3676, t3678, t3679, t3681, t3682;
  double t3686, t3689, t3692, t3693, t3695, t3696, t3698, t3700;
  double t3703, tv4rho42, t3724, t3728, t3732, t3736, t3737, t3740;
  double t3753, t3754, t3755, t3757, t3759, t3761, t3762, t3763;
  double t3765, t3766, t3768, t3769, t3777, t3778, t3781, t3783;
  double t3787, t3795, t3804, t3807, t3809, t3812, t3815, t3818;
  double t3821, t3823, t3825, t3826, t3828, t3830, t3831, t3833;
  double t3834, t3836, t3837, t3839, t3840, t3842, t3843, t3845;
  double t3851, t3852, t3854, t3855, t3857, t3859, t3860, t3862;
  double t3864, t3866, t3867, t3869, t3871, t3872, t3874, t3881;
  double t3888, t3891, t3894, t3897, t3918, t3922, t3928, t3933;
  double t3935, t3939, t3941, t3950, t3961, t3962, t3963, t3965;
  double t3966, t3968, t3969, t3971, t3972, t3974, t3976, t3978;
  double t3982, t3985, t3988, t3991, t3998, t4002, tv4rho43, t4007;
  double t4012, t4019, t4023, t4031, t4038, t4039, t4042, t4045;
  double t4049, t4053, t4054, t4068, t4073, t4077, t4092, t4096;
  double t4099, t4102, t4106, t4109, t4111, t4115, t4116, t4120;
  double t4125, t4140, t4143, t4146, t4147, t4149, t4150, t4153;
  double t4157, t4160, t4163, t4166, t4167, t4168, t4174, t4180;
  double t4182, t4183, t4184, t4186, t4187, t4202, t4207, t4209;
  double t4212, t4216, t4220, t4222, t4227, t4229, t4230, t4235;
  double t4239, t4243, t4254, t4278, t4291, t4299, t4304, t4311;
  double t4315, t4324, t4341, t4354, t4364, t4367, t4370, t4374;
  double t4382, t4386, t4393, t4397, tv4rho44, t4403, t4416, t4418;
  double t4423, t4425, t4428, t4429, t4431, t4433, t4437, t4441;
  double t4443, t4447, t4449, t4450, t4452, t4453, t4455, t4456;
  double t4458, t4461, t4470, t4472, t4476, t4479, t4481, t4485;
  double t4488, t4489, t4491, t4492, t4494, t4497, t4506, t4507;
  double t4509, t4511, t4514, t4520, t4522, t4524, t4525, t4528;
  double t4530, t4540, t4543, t4544, t4548, t4560, t4566, t4571;
  double t4575, t4578, t4584, t4590, t4595, t4598, t4618, t4622;
  double t4624, t4626, t4627, t4637, t4639, t4642, t4644, t4647;
  double t4649, t4653, t4657, t4684, t4686, t4688, t4690, t4691;
  double t4693, t4695, t4700, t4708, t4714, t4716, t4718, t4732;
  double t4739, t4752, t4755, t4756, t4759, t4761, t4763, t4765;
  double t4776, t4778, t4781, t4782, t4784, t4790, t4794, t4796;
  double t4801, t4804, t4809, t4811, t4814, t4815, t4819, t4821;
  double t4822, t4825, t4833, t4840, t4843, t4847, t4870, t4875;
  double tv4rho3sigma0, tv4rho3sigma1, t4880, t4882, t4887, t4890, t4892, t4895;
  double t4898, t4900, t4903, t4904, t4905, tv4rho3sigma2, t4907, t4909;
  double t4911, t4916, t4918, t4919, t4922, t4931, t4934, t4939;
  double t4955, t4957, t4960, t4963, t4977, t4979, t4982, t4985;
  double t4993, t4995, t5008, t5011, t5015, t5038, t5053, t5069;
  double t5072, t5073, t5077, t5083, t5084, t5086, t5087, t5092;
  double t5109, t5112, t5116, tv4rho3sigma3, tv4rho3sigma4, t5118, t5120, t5122;
  double t5123, t5133, t5134, t5136, t5137, t5139, t5140, t5142;
  double t5144, t5146, t5150, t5152, t5157, t5161, t5165, t5167;
  double t5169, t5172, t5173, t5176, t5178, t5187, t5189, t5191;
  double t5192, t5193, t5196, t5198, t5200, t5201, t5204, t5206;
  double t5208, t5211, t5218, t5224, t5227, tv4rho3sigma5, t5229, t5236;
  double t5242, t5252, t5256, t5266, t5270, t5279, t5287, t5290;
  double tv4rho3sigma6, tv4rho3sigma7, t5292, t5293, t5295, t5296, t5298, t5300;
  double t5302, t5304, t5306, t5323, t5326, t5327, t5329, t5331;
  double t5342, t5346, t5348, t5352, t5365, t5370, t5385, t5386;
  double t5389, t5391, t5393, t5394, t5396, t5398, t5400, t5403;
  double t5405, t5407, t5410, t5412, t5414, t5416, t5418, t5421;
  double t5423, t5425, t5427, t5428, t5430, t5432, t5434, t5436;
  double t5438, t5440, t5442, t5443, t5445, t5447, t5449, t5451;
  double t5453, t5473, t5485, t5493, t5494, t5496, t5497, t5499;
  double t5500, t5503, t5506, t5509, t5510, t5518, t5522, tv4rho3sigma8;
  double t5537, t5538, tv4rho3sigma9, tv4rho3sigma10, t5555, t5558, t5559, t5569;
  double t5590, t5612, t5618, t5636, t5640, t5643, t5646, t5650;
  double t5683, t5687, t5690, t5698, t5702, t5713, t5727, t5738;
  double t5763, t5766, t5768, t5772, t5792, t5794, t5802, t5816;
  double t5822, t5827, t5840, t5852, t5856, t5859, t5863, t5867;
  double t5871, t5883, t5896, t5899, t5902, t5911, t5927, t5932;
  double tv4rho3sigma11, t5938, t5939, t5943, t5949, t5950, t5960, t5977;
  double t5979, t5981, t5997, t6022, t6026, t6028, t6030, t6033;
  double t6037, t6039, t6042, t6044, t6064, t6065, t6067, t6070;
  double t6074, t6080, t6084, t6088, t6091, t6098, t6100, t6109;
  double t6116, t6141, t6143, t6145, t6149, t6150, t6153, t6156;
  double t6160, t6179, t6180, t6184, t6191, t6195, t6196, t6202;
  double t6204, t6206, t6207, t6209, t6211, t6215, t6220, t6231;
  double t6240, t6242, t6251, t6255, t6258, t6260, t6262, t6264;
  double t6266, t6279, t6280, t6281, t6286, t6287, t6289, t6293;
  double t6302, t6306, t6308, t6314, t6316, t6318, t6322, t6337;
  double t6341, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t6344, t6349;
  double t6354, t6357, t6358, t6361, t6362, t6365, t6372, t6378;
  double t6380, t6381, t6383, t6386, t6387, t6390, t6391, t6394;
  double t6395, t6401, t6403, tv4rho2sigma25, t6405, t6425, t6430, t6445;
  double t6463, t6468, t6475, t6477, t6483, t6493, t6497, t6499;
  double t6503, t6519, t6531, t6537, t6541, t6547, t6554, t6558;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6564, t6568, t6583;
  double t6596, t6598, t6600, t6602, t6604, t6606, t6608, t6610;
  double t6612, t6614, t6616, t6618, t6620, t6627, t6633, t6635;
  double t6637, t6639, t6641, t6642, t6644, t6646, t6648, t6650;
  double t6652, t6660, t6669, t6671, t6673, t6675, t6677, t6679;
  double t6681, t6682, t6684, t6686, t6706, t6713, t6715, t6717;
  double t6718, t6720, t6721, t6723, t6725, t6727, t6741, t6744;
  double t6748, tv4rho2sigma211, t6765, t6779, t6781, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214;
  double tv4rho2sigma215, tv4rho2sigma216, t6787, t6788, t6812, t6819, t6823, t6830;
  double t6838, t6852, t6853, t6885, t6921, t6928, t6936, t6938;
  double t6959, t6962, t6963, t7008, t7013, t7014, t7050, t7053;
  double t7056, t7060, t7078, t7107, t7111, t7121, t7125, tv4rho2sigma217;
  double t7146, t7147, t7148, t7151, t7158, t7164, t7184, t7186;
  double t7187, t7215, t7226, t7246, t7249, t7253, t7255, t7256;
  double t7257, t7262, t7263, t7264, t7268, t7272, t7274, t7283;
  double t7293, t7295, t7299, t7310, t7320, t7322, t7324, t7326;
  double t7328, t7333, t7354, t7355, t7369, t7375, t7380, t7384;
  double t7385, t7389, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t7392, t7394, t7396, t7398, t7413;
  double t7417, t7419, t7421, t7423, t7425, t7435, t7436, t7439;
  double t7441, t7443, t7445, t7447, t7449, t7451, t7453, t7460;
  double t7472, t7480, t7482, t7484, t7485, t7488, tv4rhosigma39, t7508;
  double t7523, t7529, t7538, t7541, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t7544, t7545, t7546;
  double t7555, t7574, t7600, t7603, t7628, t7643, t7646, t7647;
  double t7665, t7674, t7681, t7682, t7703, t7731, t7733, t7755;
  double t7759, tv4rhosigma319, t7761, t7762, t7765, t7770, t7771, t7774;
  double t7789, t7796, t7797, t7798, t7804, t7820, t7847, t7848;
  double t7856, t7859, t7863, t7901, t7904, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t7907, t7908, t7913, t7916, t7917;
  double t7918, t7922, t7923, t7930, t7937, t7941, t7965, t7973;
  double t7974, t8016, t8023, t8027, t8045, t8048, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t519 = 0.1e1 / t77 / t197;
  t520 = t84 * t519;
  t521 = t520 * t206;
  t522 = t228 * t521;
  t527 = 0.1e1 / t216 / t97;
  t528 = t94 * t527;
  t529 = t528 * t99;
  t530 = t215 * t529;
  t531 = t76 * t76;
  t533 = 0.1e1 / t78 / t531;
  t535 = t533 * t41 * t3;
  t536 = t75 * t535;
  t539 = t190 * t190;
  t544 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t548 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t539 + 0.4e1 / 0.3e1 * t71 * t544);
  t549 = t5 * t548;
  t554 = t75 * t533;
  t560 = t91 * t91;
  t561 = 0.1e1 / t560;
  t565 = 0.176e3 / 0.729e3 * t29 * t554 + 0.28e2 / 0.243e3 * t130 * t521 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t533 * t561;
  t567 = t27 * t565 * t100;
  t570 = t218 * t227;
  t571 = t215 * t570;
  t572 = t42 * t206;
  t573 = t554 * t572;
  t577 = 0.1e1 / t226 / t92;
  t578 = t224 * t577;
  t579 = t215 * t578;
  t581 = t561 * t41 * t3;
  t582 = t554 * t581;
  t585 = t224 * t227;
  t586 = t215 * t585;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t520;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t522 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t530 * t536 - 0.3e1 / 0.8e1 * t549 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t567 - 0.8e1 / 0.243e3 * t571 * t573 - 0.8e1 / 0.729e3 * t579 * t582 - 0.4e1 / 0.729e3 * t586 * t582 + t418 - t464 / 0.4e1 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t561;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t528;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t572;
  t735 = t220 * t701;
  t742 = t698 * t581;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t571 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t579 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t586 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t561 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t572;
  t826 = t220 * t798;
  t829 = t822 * t581;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t530 * t819 / 0.72e2 - t571 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t579 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t586 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t842 = 0.1e1 / t33 / t285;
  t843 = t44 * t842;
  t844 = t148 * t843;
  t847 = t338 * t145;
  t848 = t143 * t847;
  t851 = t112 * t117;
  t852 = t851 * t146;
  t853 = t852 * t149;
  t855 = t25 * t369;
  t856 = t855 * t146;
  t857 = t856 * t149;
  t859 = t314 * t27;
  t860 = t859 * t146;
  t863 = t364 * t378;
  t865 = t374 * t378;
  t866 = t865 * t149;
  t870 = t375 * t392;
  t877 = t117 * t338 * t60;
  t878 = t26 * t877;
  t880 = t285 * rho[0];
  t882 = 0.1e1 / t34 / t880;
  t883 = t31 * t882;
  t886 = t843 * t134;
  t893 = t40 * M_PI;
  t894 = t893 * t753;
  t895 = t285 * t122;
  t896 = 0.1e1 / t895;
  t898 = 0.1e1 / t333 / t51;
  t899 = t896 * t898;
  t902 = -0.2464e4 / 0.2187e4 * t29 * t883 - 0.28e3 / 0.729e3 * t130 * t886 + 0.224e3 / 0.2187e4 * t331 * sigma[0] * t882 * t334 - 0.512e3 / 0.59049e5 * t894 * t899;
  t904 = t27 * t902 * t60;
  t907 = -0.35e2 / 0.27e2 * t147 * t844 - t848 * t149 / 0.2e1 - t853 / 0.3e1 + t857 / 0.9e1 - t860 * t149 / 0.2e1 - t863 * t149 - t866 / 0.3e1 + 0.7e1 / 0.6e1 * t365 * t392 + 0.7e1 / 0.18e2 * t870 + 0.7e1 / 0.6e1 * t379 * t392 - 0.9e1 / 0.8e1 * t113 * t340 - 0.3e1 / 0.8e1 * t878 - 0.3e1 / 0.8e1 * t26 * t904;
  t908 = t113 * t371;
  t911 = 0.1e1 / t116 / t105;
  t913 = t911 * t54 * t60;
  t915 = 0.5e1 / 0.36e2 * t26 * t913;
  t916 = t315 * t119;
  t918 = t113 * t321;
  t921 = t369 * t138 * t60;
  t922 = t26 * t921;
  t925 = 0.1e1 / t300 / t19;
  t926 = t302 * t109;
  t929 = t301 * t109;
  t932 = t105 * t105;
  t933 = 0.1e1 / t932;
  t934 = t16 * t933;
  t937 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t306 - 0.6e1 * t934);
  t941 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t926 + 0.4e1 / 0.3e1 * t929 * t310 + 0.4e1 / 0.3e1 * t23 * t937);
  t942 = t5 * t941;
  t947 = t385 * t297;
  t949 = t156 * t886;
  t952 = t144 * t144;
  t953 = 0.1e1 / t952;
  t954 = t54 * t953;
  t955 = t143 * t954;
  t956 = t59 * t753;
  t957 = t896 * t2;
  t959 = t956 * t957 * t28;
  t966 = t859 * t152;
  t969 = t908 / 0.4e1 - t915 - 0.3e1 / 0.8e1 * t916 - 0.3e1 / 0.4e1 * t918 + t922 / 0.4e1 - 0.3e1 / 0.8e1 * t942 * t61 - 0.9e1 / 0.8e1 * t315 * t140 + 0.7e1 / 0.54e2 * t947 - 0.35e2 / 0.81e2 * t153 * t949 - 0.64e2 / 0.243e3 * t955 * t959 + 0.7e1 / 0.18e2 * t382 * t297 + 0.7e1 / 0.18e2 * t389 * t297 - t966 * t157 / 0.6e1;
  t971 = t364 * t388;
  t974 = t374 * t388;
  t975 = t974 * t157;
  t977 = t338 * t58;
  t978 = t143 * t977;
  t981 = t851 * t152;
  t982 = t981 * t157;
  t984 = t855 * t152;
  t985 = t984 * t157;
  t987 = t138 * t281;
  t988 = t987 * t59;
  t989 = t143 * t988;
  t992 = t282 * t155;
  t993 = t143 * t992;
  t994 = t753 * t896;
  t995 = t29 * t134;
  t996 = t994 * t995;
  t1000 = t334 * t2 * t28;
  t1001 = t994 * t1000;
  t1005 = t898 * t2 * t28;
  t1006 = t994 * t1005;
  t1011 = t146 * t357;
  t1012 = t143 * t1011;
  t1015 = t154 * t154;
  t1016 = 0.1e1 / t1015;
  t1017 = t152 * t1016;
  t1018 = t143 * t1017;
  t1021 = t364 * t283;
  t1024 = -t971 * t157 / 0.3e1 - t975 / 0.9e1 - t978 * t157 / 0.6e1 - t982 / 0.9e1 + t985 / 0.27e2 - 0.8e1 / 0.27e2 * t989 * t290 - 0.64e2 / 0.729e3 * t993 * t996 - 0.32e2 / 0.2187e4 * t351 * t1001 - 0.64e2 / 0.6561e4 * t359 * t1006 - 0.64e2 / 0.19683e5 * t344 * t1006 - 0.64e2 / 0.2187e4 * t1012 * t1001 - 0.64e2 / 0.6561e4 * t1018 * t1006 - 0.8e1 / 0.27e2 * t1021 * t290;
  t1025 = t374 * t283;
  t1026 = t1025 * t290;
  t1029 = t882 * t41 * t3;
  t1030 = t31 * t1029;
  t1033 = t364 * t343;
  t1036 = t388 * t155;
  t1037 = t143 * t1036;
  t1040 = t364 * t350;
  t1043 = t374 * t343;
  t1044 = t1043 * t347;
  t1046 = t374 * t350;
  t1047 = t1046 * t353;
  t1049 = t374 * t358;
  t1050 = t1049 * t347;
  t1052 = t378 * t155;
  t1053 = t143 * t1052;
  t1056 = t364 * t358;
  t1059 = t388 * t357;
  t1060 = t143 * t1059;
  t1063 = t883 * t352;
  t1066 = t883 * t346;
  t1071 = -0.8e1 / 0.81e2 * t1026 + 0.56e2 / 0.81e2 * t284 * t1030 - 0.4e1 / 0.243e3 * t1033 * t347 - 0.4e1 / 0.243e3 * t1037 * t347 - 0.8e1 / 0.81e2 * t1040 * t353 - 0.4e1 / 0.729e3 * t1044 - 0.8e1 / 0.243e3 * t1047 - 0.8e1 / 0.729e3 * t1050 - 0.8e1 / 0.81e2 * t1053 * t353 - 0.8e1 / 0.243e3 * t1056 * t347 - 0.8e1 / 0.243e3 * t1060 * t347 + 0.56e2 / 0.243e3 * t351 * t1063 + 0.56e2 / 0.729e3 * t359 * t1066 + 0.28e2 / 0.729e3 * t344 * t1066;
  t1074 = my_piecewise3(t1, 0, t907 + t969 + t1024 + t1071);
  t1076 = 0.1e1 / t397 / t69;
  t1077 = t399 * t164;
  t1080 = t398 * t164;
  t1083 = t66 * t933;
  t1086 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t306 - 0.6e1 * t1083);
  t1090 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1077 + 0.4e1 / 0.3e1 * t1080 * t405 + 0.4e1 / 0.3e1 * t71 * t1086);
  t1091 = t5 * t1090;
  t1094 = t410 * t172;
  t1096 = t168 * t416;
  t1099 = t911 * t94 * t100;
  t1101 = 0.5e1 / 0.36e2 * t74 * t1099;
  t1103 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1091 * t101 - 0.3e1 / 0.8e1 * t1094 + t1096 / 0.4e1 - t1101);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1074 + t1103);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1106 = 0.2e1 * t451;
  t1107 = 0.2e1 * t488;
  t1108 = t431 * t27;
  t1109 = t1108 * t146;
  t1112 = t183 * t117;
  t1113 = t1112 * t146;
  t1115 = t1113 * t149 / 0.9e1;
  t1116 = t439 * t378;
  t1127 = t925 * t180;
  t1130 = t301 * t427;
  t1135 = 0.2e1 * t306;
  t1136 = 0.6e1 * t934;
  t1138 = my_piecewise5(t10, 0, t14, 0, t1135 - t1136);
  t1142 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1127 * t302 + 0.8e1 / 0.9e1 * t1130 * t109 + 0.4e1 / 0.9e1 * t423 * t310 + 0.4e1 / 0.3e1 * t23 * t1138);
  t1143 = t5 * t1142;
  t1149 = t184 * t321 / 0.4e1;
  t1152 = t432 * t119 / 0.4e1;
  t1153 = t184 * t371;
  t1157 = -t1109 * t149 / 0.3e1 - t1115 - t1116 * t149 / 0.3e1 + 0.7e1 / 0.18e2 * t440 * t392 - t853 / 0.9e1 + 0.2e1 / 0.27e2 * t857 - t866 / 0.9e1 + 0.7e1 / 0.54e2 * t870 - 0.3e1 / 0.8e1 * t184 * t340 - 0.3e1 / 0.8e1 * t1143 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1149 - t878 / 0.8e1 - t1152 + t1153 / 0.12e2 + t908 / 0.6e1 - t915 - t916 / 0.8e1;
  t1162 = t1108 * t152;
  t1165 = t1112 * t152;
  t1167 = t1165 * t157 / 0.27e2;
  t1168 = t439 * t388;
  t1175 = t439 * t283;
  t1179 = t439 * t350;
  t1182 = t439 * t358;
  t1185 = t439 * t343;
  t1191 = -t918 / 0.4e1 + t922 / 0.6e1 + 0.7e1 / 0.54e2 * t443 * t297 - t1162 * t157 / 0.9e1 - t1167 - t1168 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t947 - t975 / 0.27e2 - t982 / 0.27e2 + 0.2e1 / 0.81e2 * t985 - 0.8e1 / 0.81e2 * t1175 * t290 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t353 - 0.8e1 / 0.729e3 * t1182 * t347 - 0.4e1 / 0.729e3 * t1185 * t347 - 0.4e1 / 0.2187e4 * t1044 - 0.8e1 / 0.729e3 * t1047 - 0.8e1 / 0.2187e4 * t1050;
  t1193 = my_piecewise3(t1, 0, t1157 + t1191);
  t1194 = t1076 * t190;
  t1197 = t398 * t456;
  t1202 = 0.6e1 * t1083;
  t1204 = my_piecewise5(t14, 0, t10, 0, -t1135 - t1202);
  t1208 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1194 * t399 + 0.8e1 / 0.9e1 * t1197 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1204);
  t1209 = t5 * t1208;
  t1213 = t461 * t172 / 0.4e1;
  t1214 = t194 * t416;
  t1221 = t168 * t470 / 0.4e1;
  t1223 = t369 * t210 * t100;
  t1224 = t74 * t1223;
  t1226 = t409 * t27;
  t1227 = t1226 * t218;
  t1230 = t167 * t117;
  t1231 = t1230 * t218;
  t1233 = t1231 * t221 / 0.9e1;
  t1234 = t73 * t369;
  t1235 = t1234 * t218;
  t1236 = t1235 * t221;
  t1238 = t1226 * t224;
  t1241 = t1230 * t224;
  t1243 = t1241 * t229 / 0.27e2;
  t1244 = t1234 * t224;
  t1245 = t1244 * t229;
  t1247 = -0.3e1 / 0.8e1 * t1209 * t101 - t1213 + t1214 / 0.12e2 - t1094 / 0.8e1 + t1096 / 0.6e1 - t1101 - 0.3e1 / 0.8e1 * t410 * t212 - t1221 + t1224 / 0.12e2 - t1227 * t221 / 0.6e1 - t1233 + t1236 / 0.27e2 - t1238 * t229 / 0.18e2 - t1243 + t1245 / 0.81e2;
  t1248 = my_piecewise3(t65, 0, t1247);
  tv3rho31 = t396 + t420 + t1106 + t1107 + t6 * (t1193 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1251 = t925 * t493;
  t1256 = t301 * t498;
  t1260 = my_piecewise5(t10, 0, t14, 0, -t1135 - t1136);
  t1264 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1251 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1256 * t109 + 0.4e1 / 0.3e1 * t23 * t1260);
  t1265 = t5 * t1264;
  t1268 = t503 * t119;
  t1272 = t502 * t27;
  t1273 = t1272 * t146;
  t1276 = t1272 * t152;
  t1284 = -0.3e1 / 0.8e1 * t1265 * t61 - t1268 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1273 * t149 / 0.6e1 - t1276 * t157 / 0.18e2 - t1152 + t1153 / 0.6e1 - t1149 - t1115 - t1167 + t908 / 0.12e2 - t915 + t922 / 0.12e2 + t857 / 0.27e2 + t985 / 0.81e2;
  t1285 = my_piecewise3(t1, 0, t1284);
  t1286 = t193 * t117;
  t1287 = t1286 * t218;
  t1288 = t1287 * t221;
  t1290 = t477 * t513;
  t1291 = t1290 * t221;
  t1293 = t478 * t598;
  t1298 = t460 * t27;
  t1299 = t1298 * t218;
  t1302 = t473 * t513;
  t1305 = t194 * t470;
  t1308 = t117 * t565 * t100;
  t1309 = t74 * t1308;
  t1311 = t549 * t172;
  t1313 = t1076 * t539;
  t1318 = t398 * t544;
  t1322 = my_piecewise5(t14, 0, t10, 0, t1135 - t1202);
  t1326 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1313 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1318 * t164 + 0.4e1 / 0.3e1 * t71 * t1322);
  t1327 = t5 * t1326;
  t1336 = -t1288 / 0.9e1 - t1291 / 0.9e1 + 0.7e1 / 0.54e2 * t1293 - t1233 + 0.2e1 / 0.27e2 * t1236 + 0.7e1 / 0.18e2 * t474 * t598 - t1299 * t221 / 0.3e1 - t1302 * t221 / 0.3e1 - t1305 / 0.4e1 - t1309 / 0.8e1 - t1311 / 0.8e1 - 0.3e1 / 0.8e1 * t1327 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t567 - t1213 + t1214 / 0.6e1 - t1221 + t1224 / 0.6e1;
  t1338 = t1286 * t224;
  t1339 = t1338 * t229;
  t1341 = t477 * t594;
  t1342 = t1341 * t229;
  t1344 = t484 * t522;
  t1348 = t1298 * t224;
  t1351 = t473 * t594;
  t1355 = t477 * t529;
  t1356 = t1355 * t536;
  t1358 = t473 * t529;
  t1361 = t477 * t578;
  t1362 = t1361 * t582;
  t1364 = t477 * t585;
  t1365 = t1364 * t582;
  t1367 = t477 * t570;
  t1368 = t1367 * t573;
  t1370 = t473 * t570;
  t1373 = t473 * t578;
  t1376 = t473 * t585;
  t1379 = t1096 / 0.12e2 - t1101 - t1339 / 0.27e2 - t1342 / 0.27e2 + 0.7e1 / 0.162e3 * t1344 + 0.7e1 / 0.54e2 * t481 * t522 - t1348 * t229 / 0.9e1 - t1351 * t229 / 0.9e1 - t1243 + 0.2e1 / 0.81e2 * t1245 - 0.8e1 / 0.243e3 * t1356 - 0.8e1 / 0.81e2 * t1358 * t536 - 0.8e1 / 0.2187e4 * t1362 - 0.4e1 / 0.2187e4 * t1365 - 0.8e1 / 0.729e3 * t1368 - 0.8e1 / 0.243e3 * t1370 * t573 - 0.8e1 / 0.729e3 * t1373 * t582 - 0.4e1 / 0.729e3 * t1376 * t582;
  t1381 = my_piecewise3(t65, 0, t1336 + t1379);
  tv3rho32 = t1106 + t1107 + t508 + t602 + t6 * (t1285 + t1381);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1386 = t493 * t180;
  t1393 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t306 - 0.6e1 * t934);
  t1397 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t1386 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1393);
  t1398 = t5 * t1397;
  t1404 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1398 * t61 - 0.3e1 / 0.8e1 * t1268 + t1153 / 0.4e1 - t915);
  t1412 = t548 * t27;
  t1413 = t1412 * t218;
  t1416 = t509 * t513;
  t1418 = t565 * t217;
  t1419 = t215 * t1418;
  t1423 = 0.1e1 / t77 / t531;
  t1424 = t84 * t1423;
  t1425 = t220 * t1424;
  t1429 = t539 * t190;
  t1436 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t306 - 0.6e1 * t1083);
  t1440 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1429 + 0.4e1 / 0.3e1 * t452 * t544 + 0.4e1 / 0.3e1 * t71 * t1436);
  t1441 = t5 * t1440;
  t1448 = 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1288 / 0.3e1 - t1291 / 0.3e1 + 0.7e1 / 0.18e2 * t1293 - t1413 * t221 / 0.2e1 - t1416 * t221 - t1419 * t221 / 0.2e1 - 0.35e2 / 0.27e2 * t219 * t1425 + t1236 / 0.9e1 - 0.3e1 / 0.8e1 * t1441 * t101 - 0.9e1 / 0.8e1 * t549 * t212 - 0.9e1 / 0.8e1 * t194 * t567;
  t1449 = t531 * rho[1];
  t1451 = 0.1e1 / t78 / t1449;
  t1452 = t75 * t1451;
  t1455 = t1424 * t206;
  t1462 = t893 * t796;
  t1463 = t531 * t197;
  t1464 = 0.1e1 / t1463;
  t1466 = 0.1e1 / t560 / t91;
  t1467 = t1464 * t1466;
  t1470 = -0.2464e4 / 0.2187e4 * t29 * t1452 - 0.28e3 / 0.729e3 * t130 * t1455 + 0.224e3 / 0.2187e4 * t331 * sigma[2] * t1451 * t561 - 0.512e3 / 0.59049e5 * t1462 * t1467;
  t1472 = t27 * t1470 * t100;
  t1484 = t216 * t216;
  t1485 = 0.1e1 / t1484;
  t1486 = t94 * t1485;
  t1487 = t215 * t1486;
  t1488 = t99 * t796;
  t1489 = t1464 * t2;
  t1491 = t1488 * t1489 * t28;
  t1494 = t1412 * t224;
  t1497 = t509 * t594;
  t1500 = t565 * t98;
  t1501 = t215 * t1500;
  t1504 = -0.3e1 / 0.8e1 * t74 * t1472 - 0.3e1 / 0.4e1 * t1305 - 0.3e1 / 0.8e1 * t1309 - 0.3e1 / 0.8e1 * t1311 + t1214 / 0.4e1 + t1224 / 0.4e1 - t1101 + 0.7e1 / 0.18e2 * t591 * t522 + 0.7e1 / 0.18e2 * t595 * t522 - 0.64e2 / 0.243e3 * t1487 * t1491 - t1494 * t229 / 0.6e1 - t1497 * t229 / 0.3e1 - t1501 * t229 / 0.6e1;
  t1509 = t228 * t1455;
  t1514 = t528 * t227;
  t1515 = t215 * t1514;
  t1516 = t796 * t1464;
  t1517 = t29 * t206;
  t1518 = t1516 * t1517;
  t1521 = t218 * t577;
  t1522 = t215 * t1521;
  t1523 = t29 * t561;
  t1524 = t1516 * t1523;
  t1529 = t226 * t226;
  t1530 = 0.1e1 / t1529;
  t1531 = t224 * t1530;
  t1532 = t215 * t1531;
  t1534 = t1466 * t2 * t28;
  t1535 = t1516 * t1534;
  t1542 = t509 * t529;
  t1545 = -t1339 / 0.9e1 - t1342 / 0.9e1 + 0.7e1 / 0.54e2 * t1344 - 0.35e2 / 0.81e2 * t225 * t1509 + t1245 / 0.27e2 - 0.8e1 / 0.81e2 * t1356 - 0.64e2 / 0.729e3 * t1515 * t1518 - 0.64e2 / 0.2187e4 * t1522 * t1524 - 0.32e2 / 0.2187e4 * t571 * t1524 - 0.64e2 / 0.6561e4 * t1532 * t1535 - 0.64e2 / 0.6561e4 * t579 * t1535 - 0.64e2 / 0.19683e5 * t586 * t1535 - 0.8e1 / 0.27e2 * t1542 * t536;
  t1546 = t210 * t527;
  t1547 = t1546 * t99;
  t1548 = t215 * t1547;
  t1552 = t1451 * t41 * t3;
  t1553 = t75 * t1552;
  t1556 = t509 * t578;
  t1559 = t594 * t577;
  t1560 = t215 * t1559;
  t1563 = t509 * t585;
  t1566 = t594 * t227;
  t1567 = t215 * t1566;
  t1570 = t509 * t570;
  t1573 = t513 * t227;
  t1574 = t215 * t1573;
  t1577 = t1452 * t572;
  t1580 = t1452 * t581;
  t1588 = -0.8e1 / 0.27e2 * t1548 * t536 + 0.56e2 / 0.81e2 * t530 * t1553 - 0.8e1 / 0.243e3 * t1556 * t582 - 0.8e1 / 0.243e3 * t1560 * t582 - 0.4e1 / 0.243e3 * t1563 * t582 - 0.4e1 / 0.243e3 * t1567 * t582 - 0.8e1 / 0.81e2 * t1570 * t573 - 0.8e1 / 0.81e2 * t1574 * t573 + 0.56e2 / 0.243e3 * t571 * t1577 + 0.56e2 / 0.729e3 * t579 * t1580 + 0.28e2 / 0.729e3 * t586 * t1580 - 0.8e1 / 0.729e3 * t1362 - 0.4e1 / 0.729e3 * t1365 - 0.8e1 / 0.243e3 * t1368;
  t1591 = my_piecewise3(t65, 0, t1448 + t1504 + t1545 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1404 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1599 = t1049 * t659;
  t1601 = t1043 * t659;
  t1605 = t1046 * t647;
  t1609 = t285 * t32;
  t1610 = 0.1e1 / t1609;
  t1611 = t1610 * t2;
  t1613 = t28 * t44 * t134;
  t1614 = t1611 * t1613;
  t1618 = t28 * t334 * t44;
  t1619 = t1611 * t1618;
  t1624 = t244 * t281;
  t1625 = t1624 * t59;
  t1626 = t143 * t1625;
  t1629 = t30 * t287;
  t1630 = t1629 * t346;
  t1633 = t1629 * t352;
  t1638 = t1610 * t898;
  t1639 = t29 * t44;
  t1640 = t1638 * t1639;
  t1643 = 0.2e1 / 0.243e3 * t1056 * t659 + t1033 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1599 + t1601 / 0.729e3 + 0.2e1 / 0.81e2 * t1040 * t647 + 0.2e1 / 0.243e3 * t1605 + 0.2e1 / 0.81e2 * t1053 * t647 + 0.8e1 / 0.243e3 * t993 * t1614 + 0.8e1 / 0.729e3 * t1012 * t1619 + 0.4e1 / 0.729e3 * t351 * t1619 - 0.8e1 / 0.81e2 * t1626 * t290 - 0.5e1 / 0.243e3 * t359 * t1630 - 0.5e1 / 0.81e2 * t351 * t1633 - 0.5e1 / 0.486e3 * t344 * t1630 + 0.8e1 / 0.6561e4 * t344 * t1640;
  t1654 = t239 * t294;
  t1655 = t148 * t1654;
  t1660 = t852 * t249;
  t1665 = t856 * t249 / 0.72e2;
  t1666 = t375 * t650;
  t1668 = t374 * t626;
  t1669 = t1668 * t149;
  t1671 = t621 * t145;
  t1672 = t143 * t1671;
  t1679 = 0.2e1 / 0.243e3 * t1060 * t659 + t1037 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t1018 * t1640 + 0.8e1 / 0.2187e4 * t359 * t1640 - t379 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1655 + 0.7e1 / 0.18e2 * t627 * t392 + t1660 / 0.24e2 - t365 * t650 / 0.6e1 - t1665 - t1666 / 0.18e2 - t1669 / 0.9e1 - t1672 * t149 / 0.3e1 + t860 * t249 / 0.16e2 + t863 * t249 / 0.8e1;
  t1681 = t865 * t249;
  t1685 = t364 * t626;
  t1689 = t369 * t244 * t60;
  t1691 = t26 * t1689 / 0.12e2;
  t1692 = t113 * t608;
  t1699 = t117 * t621 * t60;
  t1700 = t26 * t1699;
  t1704 = t1654 * t134;
  t1711 = t898 * t44;
  t1714 = 0.176e3 / 0.729e3 * t29 * t1629 + 0.14e2 / 0.243e3 * t130 * t1704 - 0.2e2 / 0.729e3 * t330 * t1629 * t334 + 0.64e2 / 0.19683e5 * t893 * t1610 * t1711;
  t1716 = t27 * t1714 * t60;
  t1721 = t156 * t1704;
  t1724 = t981 * t252;
  t1729 = t984 * t252 / 0.216e3;
  t1730 = t385 * t662;
  t1732 = t1681 / 0.24e2 + t848 * t249 / 0.16e2 - t1685 * t149 / 0.3e1 + t1691 - t1692 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t246 - 0.3e1 / 0.4e1 * t113 * t623 - t1700 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1716 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1721 + t1724 / 0.72e2 - t382 * t662 / 0.18e2 - t1729 - t1730 / 0.54e2;
  t1733 = t641 * t289;
  t1738 = t364 * t630;
  t1741 = t374 * t630;
  t1742 = t1741 * t157;
  t1746 = t143 * t987;
  t1750 = t59 * t1610 * t1639;
  t1757 = t974 * t252;
  t1759 = t621 * t58;
  t1760 = t143 * t1759;
  t1763 = t364 * t282;
  t1766 = t374 * t282;
  t1767 = t1766 * t644;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t357;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -0.5e1 / 0.27e2 * t640 * t1733 + 0.7e1 / 0.54e2 * t631 * t297 - t1738 * t157 / 0.9e1 - t1742 / 0.27e2 + t978 * t252 / 0.48e2 + 0.2e1 / 0.27e2 * t1746 * t644 + 0.8e1 / 0.81e2 * t955 * t1750 + t966 * t252 / 0.48e2 + t971 * t252 / 0.24e2 + t1757 / 0.72e2 - t1760 * t157 / 0.9e1 + 0.2e1 / 0.27e2 * t1763 * t644 + 0.2e1 / 0.81e2 * t1767 - 0.8e1 / 0.243e3 * t1770 * t353 - 0.8e1 / 0.729e3 * t1774 * t347 - 0.4e1 / 0.729e3 * t1778 * t347;
  t1784 = my_piecewise3(t1, 0, t1643 + t1679 + t1732 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t369 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1231 * t270;
  t1800 = t1235 * t270 / 0.72e2;
  t1803 = t1241 * t273;
  t1806 = t1244 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1227 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1238 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1819 = t1113 * t249;
  t1823 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1599 / 0.729e3 + t1601 / 0.1458e4 + t1605 / 0.243e3 + t1819 / 0.48e2 - t440 * t650 / 0.12e2 - t1823 * t149 / 0.6e1 + t1109 * t249 / 0.16e2 + t1116 * t249 / 0.16e2 + t1660 / 0.48e2 - t1665 - t1666 / 0.36e2 - t1669 / 0.18e2 + t1681 / 0.48e2 - t1834 / 0.8e1;
  t1843 = t439 * t282;
  t1850 = t1165 * t252;
  t1857 = t439 * t630;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 + t1691 - t1692 / 0.8e1 - t1700 / 0.8e1 + t1843 * t644 / 0.27e2 + t1162 * t252 / 0.48e2 + t1168 * t252 / 0.48e2 + t1850 / 0.144e3 - t443 * t662 / 0.36e2 + t1724 / 0.144e3 - t1729 - t1730 / 0.108e3 - t1742 / 0.54e2 - t1857 * t157 / 0.18e2 + t1757 / 0.144e3 + t1767 / 0.81e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1874 = t1361 * t742;
  t1876 = t1364 * t742;
  t1878 = t1367 * t732;
  t1883 = t478 * t735;
  t1885 = t477 * t713;
  t1886 = t1885 * t221;
  t1888 = t1287 * t270;
  t1890 = t1290 * t270;
  t1892 = t473 * t713;
  t1899 = t1302 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1376 * t742 / 0.486e3 + t1370 * t732 / 0.81e2 + t1874 / 0.729e3 + t1876 / 0.1458e4 + t1878 / 0.243e3 + t1373 * t742 / 0.243e3 + t1797 / 0.48e2 - t1800 - t1883 / 0.36e2 - t1886 / 0.18e2 + t1888 / 0.48e2 + t1890 / 0.48e2 - t1892 * t221 / 0.6e1 + t1299 * t270 / 0.16e2 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t194 * t673;
  t1906 = t117 * t708 * t100;
  t1907 = t74 * t1906;
  t1909 = t1341 * t273;
  t1911 = t484 * t745;
  t1913 = t477 * t717;
  t1914 = t1913 * t229;
  t1916 = t477 * t528;
  t1917 = t1916 * t729;
  t1919 = t1338 * t273;
  t1921 = t473 * t528;
  t1930 = t473 * t717;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1789 / 0.8e1 + t1794 - t1903 / 0.8e1 - t1907 / 0.8e1 + t1909 / 0.144e3 - t1911 / 0.108e3 - t1914 / 0.54e2 + t1917 / 0.81e2 + t1919 / 0.144e3 + t1921 * t729 / 0.27e2 + t1348 * t273 / 0.48e2 + t1351 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1930 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1691 + t1273 * t249 / 0.16e2 + t1819 / 0.24e2 - t1665 + t1276 * t252 / 0.48e2 + t1850 / 0.72e2 - t1729);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t260 * t519;
  t1953 = t220 * t1952;
  t1968 = t509 * t713;
  t1971 = t708 * t217;
  t1972 = t215 * t1971;
  t1975 = t713 * t227;
  t1976 = t215 * t1975;
  t1979 = t717 * t577;
  t1980 = t215 * t1979;
  t1983 = t717 * t227;
  t1984 = t215 * t1983;
  t1987 = t30 * t533;
  t1988 = t1987 * t572;
  t1991 = t531 * t76;
  t1992 = 0.1e1 / t1991;
  t1993 = t1992 * t2;
  t1995 = t28 * t84 * t206;
  t1996 = t1993 * t1995;
  t2000 = t28 * t561 * t84;
  t2001 = t1993 * t2000;
  t2004 = 0.7e1 / 0.36e2 * t219 * t1953 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t714 * t598 + t1413 * t270 / 0.16e2 + t1416 * t270 / 0.8e1 + t1419 * t270 / 0.16e2 - t1968 * t221 / 0.3e1 - t1972 * t221 / 0.3e1 - 0.8e1 / 0.243e3 * t1976 * t573 - 0.8e1 / 0.729e3 * t1980 * t582 - 0.4e1 / 0.729e3 * t1984 * t582 - 0.5e1 / 0.81e2 * t571 * t1988 + 0.8e1 / 0.243e3 * t1515 * t1996 + 0.8e1 / 0.729e3 * t1522 * t2001;
  t2013 = t265 * t527;
  t2014 = t2013 * t99;
  t2015 = t215 * t2014;
  t2018 = t1987 * t581;
  t2024 = t1992 * t1466;
  t2025 = t29 * t84;
  t2026 = t2024 * t2025;
  t2039 = 0.4e1 / 0.729e3 * t571 * t2001 + 0.2e1 / 0.243e3 * t1556 * t742 + 0.2e1 / 0.81e2 * t1570 * t732 + 0.2e1 / 0.81e2 * t1574 * t732 - 0.8e1 / 0.81e2 * t2015 * t536 - 0.5e1 / 0.243e3 * t579 * t2018 + 0.2e1 / 0.729e3 * t1874 + t1876 / 0.729e3 + 0.2e1 / 0.243e3 * t1878 + 0.8e1 / 0.2187e4 * t1532 * t2026 + 0.8e1 / 0.2187e4 * t579 * t2026 - 0.5e1 / 0.486e3 * t586 * t2018 + 0.8e1 / 0.6561e4 * t586 * t2026 + t1563 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t1560 * t742;
  t2053 = t1952 * t206;
  t2060 = t1466 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1987 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t330 * t1987 * t561 + 0.64e2 / 0.19683e5 * t893 * t1992 * t2060;
  t2065 = t27 * t2063 * t100;
  t2076 = t1567 * t742 / 0.243e3 - t1800 - t1883 / 0.18e2 - t1886 / 0.9e1 + t1888 / 0.24e2 + t1890 / 0.24e2 - 0.3e1 / 0.8e1 * t549 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 + t1794 - t1903 / 0.4e1 - t1907 / 0.4e1 + 0.7e1 / 0.54e2 * t718 * t522 + t1494 * t273 / 0.48e2 + t1497 * t273 / 0.24e2;
  t2079 = t509 * t528;
  t2082 = t215 * t1546;
  t2086 = t99 * t1992 * t2025;
  t2089 = t509 * t717;
  t2092 = t708 * t98;
  t2093 = t215 * t2092;
  t2101 = t228 * t2053;
  t2106 = t726 * t535;
  t2111 = t1501 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2079 * t729 + 0.2e1 / 0.27e2 * t2082 * t729 + 0.8e1 / 0.81e2 * t1487 * t2086 - t2089 * t229 / 0.9e1 - t2093 * t229 / 0.9e1 + t1909 / 0.72e2 - t1911 / 0.54e2 - t1914 / 0.27e2 + 0.2e1 / 0.81e2 * t1917 + t1919 / 0.72e2 + 0.7e1 / 0.108e3 * t225 * t2101 - t595 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t725 * t2106 - t591 * t745 / 0.18e2 - t1806;
  t2114 = my_piecewise3(t65, 0, t2004 + t2039 + t2076 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2119 = t375 * t783 / 0.96e2;
  t2120 = t754 * t132;
  t2121 = t148 * t2120;
  t2125 = t1668 * t249 / 0.24e2;
  t2126 = t764 * t145;
  t2127 = t143 * t2126;
  t2139 = t1046 * t780 / 0.648e3;
  t2140 = t773 * t124;
  t2141 = t2140 * t352;
  t2145 = t1049 * t786 / 0.1944e4;
  t2146 = -t627 * t650 / 0.6e1 - t2119 + t147 * t2121 / 0.24e2 + t2125 - t2127 * t149 / 0.6e1 + t1685 * t249 / 0.8e1 + t1672 * t249 / 0.8e1 - t365 * t783 / 0.32e2 - t379 * t783 / 0.32e2 - t2139 + t351 * t2141 / 0.162e3 - t2145;
  t2147 = t2140 * t346;
  t2165 = t1043 * t786 / 0.3888e4;
  t2167 = t1025 * t776 / 0.216e3;
  t2168 = t773 * t643;
  t2171 = 0.1e1 / t880;
  t2172 = t239 * t2171;
  t2173 = t2172 * t1005;
  t2176 = t344 * t2147 / 0.972e3 - t1033 * t786 / 0.1296e4 - t1037 * t786 / 0.1296e4 - t1040 * t780 / 0.216e3 - t1053 * t780 / 0.216e3 - t1056 * t786 / 0.648e3 - t1060 * t786 / 0.648e3 + t359 * t2147 / 0.486e3 - t2165 - t2167 + t284 * t2168 / 0.54e2 - t359 * t2173 / 0.729e3;
  t2188 = t2172 * t995;
  t2191 = t2172 * t1000;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = -t344 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t1774 * t659 + t1778 * t659 / 0.243e3 - t1021 * t776 / 0.72e2 - t989 * t776 / 0.72e2 - t993 * t2188 / 0.81e2 - t1012 * t2191 / 0.243e3 - t351 * t2191 / 0.486e3 - t1018 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t1770 * t647 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2120 * t134;
  t2214 = t893 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t759 * t124 * t334 - 0.8e1 / 0.6561e4 * t2214 * t2171 * t898;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1741 * t252 / 0.72e2;
  t2232 = t143 * t1624;
  t2239 = t59 * t239;
  t2242 = t2239 * t2171 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1738 * t252 / 0.24e2 + t1760 * t252 / 0.24e2 - t955 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2146 + t2176 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1885 * t270 / 0.24e2;
  t2271 = t1913 * t273 / 0.72e2;
  t2275 = t1355 * t819 / 0.216e3;
  t2279 = t1367 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1361 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1364 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1892 * t270 / 0.8e1 + t2267 + t1930 * t273 / 0.24e2 + t2271 - t1358 * t819 / 0.72e2 - t2275 - t1370 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1373 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1376 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1823 * t249 / 0.8e1 + t2125 + t1857 * t252 / 0.24e2 + t2229 - t1175 * t776 / 0.72e2 - t2167 - t1179 * t780 / 0.216e3 - t2139 - t440 * t783 / 0.32e2 - t2119 - t1182 * t786 / 0.648e3 - t2145 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2165;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2320 = t797 * t204;
  t2321 = t220 * t2320;
  t2332 = t807 * t217;
  t2333 = t215 * t2332;
  t2338 = t816 * t199;
  t2339 = t2338 * t572;
  t2342 = t2338 * t581;
  t2347 = t219 * t2321 / 0.24e2 + t1968 * t270 / 0.8e1 + t1972 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 - t2333 * t221 / 0.6e1 + t2267 - t2283 - t714 * t735 / 0.6e1 + t571 * t2339 / 0.162e3 + t579 * t2342 / 0.486e3 + t586 * t2342 / 0.972e3;
  t2366 = -t1563 * t829 / 0.1296e4 - t1567 * t829 / 0.1296e4 - t1570 * t823 / 0.216e3 - t1574 * t823 / 0.216e3 - t1556 * t829 / 0.648e3 - t1560 * t829 / 0.648e3 - t2279 - t2287 - t2295 + t1984 * t742 / 0.243e3 - t1542 * t819 / 0.72e2 - t1548 * t819 / 0.72e2;
  t2368 = 0.1e1 / t1449;
  t2369 = t260 * t2368;
  t2370 = t2369 * t1517;
  t2373 = t2369 * t1523;
  t2378 = t816 * t728;
  t2381 = t2369 * t1534;
  t2392 = t2320 * t206;
  t2399 = t893 * t260;
  t2403 = t130 * t2392 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t802 * t199 * t561 - 0.8e1 / 0.6561e4 * t2399 * t2368 * t1466;
  t2405 = t27 * t2403 * t100;
  t2410 = -t1515 * t2370 / 0.81e2 - t1522 * t2373 / 0.243e3 - t571 * t2373 / 0.486e3 - t2275 + t530 * t2378 / 0.54e2 - t1532 * t2381 / 0.729e3 - t579 * t2381 / 0.729e3 - t586 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t1976 * t732 + 0.2e1 / 0.243e3 * t1980 * t742 - 0.3e1 / 0.8e1 * t74 * t2405 - 0.3e1 / 0.8e1 * t194 * t809;
  t2411 = t228 * t2392;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2013;
  t2427 = t99 * t260;
  t2430 = t2427 * t2368 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2089 * t273 / 0.24e2 + t2093 * t273 / 0.24e2 - t1487 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2347 + t2366 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t346;
  t2455 = t2444 * t775;
  t2458 = 0.1e1 / t285;
  t2459 = t754 * t2458;
  t2460 = t2459 * t1005;
  t2463 = t2459 * t995;
  t2466 = t2459 * t1000;
  t2475 = t344 * t2446 / 0.864e3 - t1770 * t780 / 0.72e2 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t284 * t2455 / 0.48e2 + t344 * t2460 / 0.5832e4 + t993 * t2463 / 0.216e3 + t1012 * t2466 / 0.648e3 + t351 * t2466 / 0.1296e4 + t1018 * t2460 / 0.1944e4 + t359 * t2460 / 0.1944e4;
  t2477 = 0.1e1 / t44 / t2442;
  t2478 = t2477 * t47;
  t2479 = t2478 * t134;
  t2480 = t156 * t2479;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2478;
  t2502 = t2445 * t352;
  t2514 = t2458 * t898;
  t2517 = t130 * t2479 / 0.72e2 + t331 * t2443 * t36 * t334 / 0.324e3 + t893 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t153 * t2480 / 0.64e2 - t1626 * t776 / 0.24e2 - t631 * t789 / 0.32e2 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t955 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2127 * t249 + t351 * t2502 / 0.144e3 + t359 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2475 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2526 = 0.1e1 / t2525;
  t2527 = t30 * t2526;
  t2528 = t2527 * t80;
  t2529 = t2528 * t581;
  t2534 = t2527 * t818;
  t2542 = 0.1e1 / t84 / t2525;
  t2543 = t2542 * t87;
  t2544 = t2543 * t206;
  t2545 = t228 * t2544;
  t2548 = 0.1e1 / t531;
  t2549 = t797 * t2548;
  t2550 = t2549 * t1534;
  t2555 = t2549 * t1517;
  t2558 = t2549 * t1523;
  t2563 = t586 * t2529 / 0.864e3 - t1984 * t829 / 0.432e3 + t530 * t2534 / 0.48e2 - t1976 * t823 / 0.72e2 - t1980 * t829 / 0.216e3 + t225 * t2545 / 0.64e2 + t586 * t2550 / 0.5832e4 - t718 * t832 / 0.32e2 + t1515 * t2555 / 0.216e3 + t1522 * t2558 / 0.648e3 + t571 * t2558 / 0.1296e4;
  t2570 = t220 * t2543;
  t2579 = t2548 * t2 * t28;
  t2580 = t99 * t797 * t2579;
  t2587 = t2528 * t572;
  t2597 = t2548 * t1466;
  t2600 = t130 * t2544 / 0.72e2 + t331 * t2526 * t80 * t561 / 0.324e3 + t893 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1532 * t2550 / 0.1944e4 + t579 * t2550 / 0.1944e4 - t2015 * t819 / 0.24e2 + 0.3e1 / 0.64e2 * t219 * t2570 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1487 * t2580 / 0.72e2 + 0.3e1 / 0.16e2 * t2333 * t270 + t579 * t2529 / 0.432e3 + t571 * t2587 / 0.144e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2563 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2610 = t375 * t844;
  t2615 = 0.1e1 / t33 / t880;
  t2616 = t44 * t2615;
  t2624 = t865 * t392;
  t2626 = t856 * t392;
  t2630 = t374 * t847;
  t2631 = t2630 * t149;
  t2635 = t852 * t392;
  t2637 = t112 * t369;
  t2638 = t2637 * t146;
  t2639 = t2638 * t149;
  t2641 = t314 * t117;
  t2642 = t2641 * t146;
  t2643 = t2642 * t149;
  t2645 = t851 * t378;
  t2646 = t2645 * t149;
  t2648 = t25 * t911;
  t2649 = t2648 * t146;
  t2650 = t2649 * t149;
  t2652 = t855 * t378;
  t2653 = t2652 * t149;
  t2655 = -0.14e3 / 0.81e2 * t2610 - 0.14e3 / 0.27e2 * t379 * t844 + 0.455e3 / 0.81e2 * t147 * t148 * t2616 - 0.14e3 / 0.27e2 * t365 * t844 + 0.14e2 / 0.3e1 * t863 * t392 + 0.14e2 / 0.9e1 * t2624 - 0.14e2 / 0.27e2 * t2626 + 0.7e1 / 0.3e1 * t860 * t392 - 0.2e1 / 0.3e1 * t2631 + 0.7e1 / 0.3e1 * t848 * t392 + 0.14e2 / 0.9e1 * t2635 + 0.4e1 / 0.9e1 * t2639 - 0.2e1 / 0.3e1 * t2643 - 0.4e1 / 0.3e1 * t2646 - 0.2e2 / 0.81e2 * t2650 + 0.4e1 / 0.9e1 * t2653;
  t2656 = t941 * t27;
  t2657 = t2656 * t146;
  t2660 = t859 * t378;
  t2663 = t364 * t847;
  t2667 = t143 * t902 * t145;
  t2670 = t855 * t358;
  t2671 = t2670 * t347;
  t2679 = t1049 * t1066;
  t2681 = t855 * t343;
  t2682 = t2681 * t347;
  t2684 = t1043 * t1066;
  t2686 = t855 * t350;
  t2687 = t2686 * t353;
  t2689 = t1046 * t1063;
  t2692 = t143 * t847 * t155;
  t2695 = t859 * t350;
  t2700 = t859 * t358;
  t2703 = -0.2e1 / 0.3e1 * t2657 * t149 - 0.2e1 * t2660 * t149 - 0.2e1 * t2663 * t149 - 0.2e1 / 0.3e1 * t2667 * t149 + 0.32e2 / 0.2187e4 * t2671 + 0.224e3 / 0.729e3 * t1060 * t1066 + 0.224e3 / 0.243e3 * t1053 * t1063 + 0.224e3 / 0.729e3 * t1056 * t1066 + 0.224e3 / 0.2187e4 * t2679 + 0.16e2 / 0.2187e4 * t2682 + 0.112e3 / 0.2187e4 * t2684 + 0.32e2 / 0.729e3 * t2687 + 0.224e3 / 0.729e3 * t2689 - 0.16e2 / 0.81e2 * t2692 * t353 - 0.16e2 / 0.81e2 * t2695 * t353 + 0.224e3 / 0.243e3 * t1040 * t1063 - 0.16e2 / 0.243e3 * t2700 * t347;
  t2705 = t364 * t1059;
  t2709 = 0.1e1 / t34 / t1609;
  t2710 = t31 * t2709;
  t2714 = t2710 * t346;
  t2719 = t364 * t1052;
  t2722 = t851 * t343;
  t2723 = t2722 * t347;
  t2725 = t374 * t1036;
  t2726 = t2725 * t347;
  t2728 = t851 * t350;
  t2729 = t2728 * t353;
  t2731 = t374 * t1052;
  t2732 = t2731 * t353;
  t2734 = t851 * t358;
  t2735 = t2734 * t347;
  t2737 = t374 * t1059;
  t2738 = t2737 * t347;
  t2744 = t859 * t343;
  t2747 = t364 * t1036;
  t2751 = t143 * t977 * t155;
  t2755 = t143 * t977 * t357;
  t2758 = -0.32e2 / 0.243e3 * t2705 * t347 - 0.3416e4 / 0.2187e4 * t351 * t2710 * t352 - 0.3416e4 / 0.6561e4 * t359 * t2714 - 0.1708e4 / 0.6561e4 * t344 * t2714 - 0.32e2 / 0.81e2 * t2719 * t353 - 0.16e2 / 0.729e3 * t2723 - 0.16e2 / 0.729e3 * t2726 - 0.32e2 / 0.243e3 * t2729 - 0.32e2 / 0.243e3 * t2732 - 0.32e2 / 0.729e3 * t2735 - 0.32e2 / 0.729e3 * t2738 + 0.112e3 / 0.729e3 * t1033 * t1066 + 0.112e3 / 0.729e3 * t1037 * t1066 - 0.8e1 / 0.243e3 * t2744 * t347 - 0.16e2 / 0.243e3 * t2747 * t347 - 0.8e1 / 0.243e3 * t2751 * t347 - 0.16e2 / 0.243e3 * t2755 * t347;
  t2759 = t859 * t283;
  t2762 = t364 * t988;
  t2765 = t374 * t988;
  t2766 = t2765 * t290;
  t2769 = t143 * t987 * t155;
  t2772 = t1046 * t1001;
  t2774 = t1049 * t1006;
  t2776 = t1043 * t1006;
  t2778 = t374 * t992;
  t2779 = t2778 * t996;
  t2781 = t374 * t1011;
  t2782 = t2781 * t1001;
  t2784 = t374 * t1017;
  t2785 = t2784 * t1006;
  t2787 = t338 * t281;
  t2789 = t143 * t2787 * t59;
  t2792 = t851 * t283;
  t2793 = t2792 * t290;
  t2799 = t285 * t285;
  t2802 = 0.1e1 / t33 / t2799 / rho[0];
  t2803 = t2442 * t2802;
  t2804 = t333 * t333;
  t2805 = 0.1e1 / t2804;
  t2807 = t2805 * M_PI * t43;
  t2808 = t2803 * t2807;
  t2815 = -0.16e2 / 0.27e2 * t2759 * t290 - 0.32e2 / 0.27e2 * t2762 * t290 - 0.32e2 / 0.81e2 * t2766 - 0.256e3 / 0.729e3 * t2769 * t996 - 0.128e3 / 0.6561e4 * t2772 - 0.256e3 / 0.19683e5 * t2774 - 0.256e3 / 0.59049e5 * t2776 - 0.256e3 / 0.2187e4 * t2779 - 0.256e3 / 0.6561e4 * t2782 - 0.256e3 / 0.19683e5 * t2785 - 0.16e2 / 0.27e2 * t2789 * t290 - 0.32e2 / 0.81e2 * t2793 - 0.256e3 / 0.6561e4 * t1056 * t1006 - 0.256e3 / 0.6561e4 * t1060 * t1006 - 0.512e3 / 0.59049e5 * t1018 * t2808 - 0.2816e4 / 0.531441e6 * t359 * t2808 - 0.256e3 / 0.19683e5 * t1033 * t1006;
  t2822 = t364 * t1011;
  t2826 = t143 * t378 * t357;
  t2830 = t143 * t146 * t1016;
  t2832 = M_PI * t898 * t43;
  t2833 = t2803 * t2832;
  t2836 = t364 * t1017;
  t2840 = t143 * t388 * t1016;
  t2844 = 0.1e1 / t1015 / t52;
  t2846 = t143 * t152 * t2844;
  t2849 = t364 * t992;
  t2853 = t143 * t954 * t155;
  t2855 = M_PI * t134 * t43;
  t2860 = t143 * t282 * t357;
  t2862 = M_PI * t334 * t43;
  t2863 = t2803 * t2862;
  t2874 = t855 * t283;
  t2875 = t2874 * t290;
  t2877 = -0.256e3 / 0.19683e5 * t1037 * t1006 - 0.256e3 / 0.177147e6 * t344 * t2808 - 0.256e3 / 0.2187e4 * t2822 * t1001 - 0.256e3 / 0.2187e4 * t2826 * t1001 - 0.1024e4 / 0.59049e5 * t2830 * t2833 - 0.256e3 / 0.6561e4 * t2836 * t1006 - 0.256e3 / 0.6561e4 * t2840 * t1006 - 0.1024e4 / 0.177147e6 * t2846 * t2808 - 0.256e3 / 0.729e3 * t2849 * t996 - 0.1024e4 / 0.6561e4 * t2853 * t2803 * t2855 - 0.1024e4 / 0.19683e5 * t2860 * t2863 - 0.512e3 / 0.19683e5 * t993 * t2863 - 0.128e3 / 0.2187e4 * t1040 * t1001 - 0.128e3 / 0.2187e4 * t1053 * t1001 - 0.1024e4 / 0.59049e5 * t1012 * t2833 + 0.32e2 / 0.243e3 * t2875;
  t2878 = t1025 * t1030;
  t2885 = 0.1e1 / t2799;
  t2886 = t753 * t2885;
  t2887 = t2886 * t1005;
  t2894 = t2886 * t1000;
  t2908 = t19 * t19;
  t2910 = 0.1e1 / t300 / t2908;
  t2911 = t302 * t302;
  t2917 = t310 * t310;
  t2923 = 0.1e1 / t932 / t6;
  t2924 = t16 * t2923;
  t2927 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t933 + 0.24e2 * t2924);
  t2931 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t2911 - 0.16e2 / 0.9e1 * t925 * t302 * t310 + 0.4e1 / 0.3e1 * t301 * t2917 + 0.16e2 / 0.9e1 * t929 * t937 + 0.4e1 / 0.3e1 * t23 * t2927);
  t2942 = 0.1e1 / t116 / t305;
  t2946 = 0.1e2 / 0.27e2 * t26 * t2942 * t54 * t60;
  t2947 = t113 * t913;
  t2949 = 0.224e3 / 0.243e3 * t2878 - 0.3416e4 / 0.729e3 * t284 * t31 * t2709 * t41 * t3 + 0.896e3 / 0.6561e4 * t1018 * t2887 + 0.224e3 / 0.81e2 * t1021 * t1030 + 0.896e3 / 0.19683e5 * t344 * t2887 + 0.896e3 / 0.2187e4 * t1012 * t2894 + 0.448e3 / 0.2187e4 * t351 * t2894 + 0.896e3 / 0.6561e4 * t359 * t2887 + 0.224e3 / 0.81e2 * t989 * t1030 + 0.896e3 / 0.729e3 * t993 * t2886 * t995 - 0.1024e4 / 0.177147e6 * t351 * t2833 - 0.3e1 / 0.8e1 * t5 * t2931 * t61 - 0.3e1 / 0.2e1 * t942 * t140 - 0.9e1 / 0.4e1 * t315 * t340 + 0.7e1 / 0.9e1 * t978 * t297 + t2946 - 0.5e1 / 0.9e1 * t2947;
  t2951 = t315 * t371;
  t2953 = t113 * t921;
  t2956 = t26 * t911 * t138 * t60;
  t2958 = t942 * t119;
  t2960 = t315 * t321;
  t2962 = t113 * t877;
  t2966 = t26 * t369 * t338 * t60;
  t2972 = t26 * t117 * t902 * t60;
  t2976 = t2616 * t134;
  t2986 = t3 * t893;
  t2990 = t2805 * t41 * t43;
  t2998 = t859 * t388;
  t3001 = t364 * t977;
  t3004 = t374 * t977;
  t3005 = t3004 * t157;
  t3008 = t143 * t902 * t58;
  t3011 = t374 * t954;
  t3012 = t3011 * t959;
  t3022 = t143 * t54 / t952 / t57;
  t3029 = t2951 / 0.2e1 + t2953 - 0.5e1 / 0.9e1 * t2956 - t2958 / 0.2e1 - 0.3e1 / 0.2e1 * t2960 - 0.3e1 / 0.2e1 * t2962 + t2966 / 0.2e1 - 0.3e1 / 0.2e1 * t113 * t904 - t2972 / 0.2e1 - 0.3e1 / 0.8e1 * t26 * t27 * (0.41888e5 / 0.6561e4 * t29 * t2710 + 0.364e4 / 0.2187e4 * t130 * t2976 - 0.13664e5 / 0.19683e5 * t331 * sigma[0] * t2709 * t334 + 0.7168e4 / 0.59049e5 * t894 * t2885 * t898 - 0.2048e4 / 0.1594323e7 * t2986 * t2442 * t2802 * t2990) * t60 - 0.2e1 / 0.3e1 * t2998 * t157 - 0.2e1 / 0.3e1 * t3001 * t157 - 0.2e1 / 0.9e1 * t3005 - 0.2e1 / 0.9e1 * t3008 * t157 - 0.256e3 / 0.729e3 * t3012 + 0.896e3 / 0.243e3 * t955 * t956 * t2885 * t2 * t28 - 0.1024e4 / 0.2187e4 * t3022 * t59 * t2442 * t2802 * M_PI * t43;
  t3034 = t855 * t388;
  t3035 = t3034 * t157;
  t3038 = t143 * t138 * t953;
  t3041 = t981 * t297;
  t3043 = t974 * t297;
  t3049 = t364 * t954;
  t3052 = t2656 * t152;
  t3055 = t2648 * t152;
  t3056 = t3055 * t157;
  t3058 = t2641 * t152;
  t3059 = t3058 * t157;
  t3061 = t851 * t388;
  t3062 = t3061 * t157;
  t3064 = t984 * t297;
  t3066 = t385 * t949;
  t3071 = t2637 * t152;
  t3072 = t3071 * t157;
  t3074 = 0.7e1 / 0.9e1 * t966 * t297 + 0.14e2 / 0.9e1 * t971 * t297 + 0.4e1 / 0.27e2 * t3035 - 0.256e3 / 0.243e3 * t3038 * t959 + 0.14e2 / 0.27e2 * t3041 + 0.14e2 / 0.27e2 * t3043 - 0.14e3 / 0.81e2 * t382 * t949 - 0.14e3 / 0.81e2 * t389 * t949 - 0.256e3 / 0.243e3 * t3049 * t959 - 0.2e1 / 0.9e1 * t3052 * t157 - 0.2e2 / 0.243e3 * t3056 - 0.2e1 / 0.9e1 * t3059 - 0.4e1 / 0.9e1 * t3062 - 0.14e2 / 0.81e2 * t3064 - 0.14e3 / 0.243e3 * t3066 + 0.455e3 / 0.243e3 * t153 * t156 * t2976 + 0.4e1 / 0.27e2 * t3072;
  t3078 = my_piecewise3(t1, 0, t2655 + t2703 + t2758 + t2815 + t2877 + t2949 + t3029 + t3074);
  t3079 = t69 * t69;
  t3081 = 0.1e1 / t397 / t3079;
  t3082 = t399 * t399;
  t3088 = t405 * t405;
  t3093 = t66 * t2923;
  t3096 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t933 + 0.24e2 * t3093);
  t3100 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t3082 - 0.16e2 / 0.9e1 * t1076 * t399 * t405 + 0.4e1 / 0.3e1 * t398 * t3088 + 0.16e2 / 0.9e1 * t1080 * t1086 + 0.4e1 / 0.3e1 * t71 * t3096);
  t3104 = t1091 * t172;
  t3106 = t410 * t416;
  t3108 = t168 * t1099;
  t3113 = 0.1e2 / 0.27e2 * t74 * t2942 * t94 * t100;
  t3115 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t5 * t3100 * t101 - t3104 / 0.2e1 + t3106 / 0.2e1 - 0.5e1 / 0.9e1 * t3108 + t3113);
  tv4rho40 = 0.4e1 * t1074 + 0.4e1 * t1103 + t6 * (t3078 + t3115);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3120 = t431 * t117;
  t3121 = t3120 * t146;
  t3122 = t3121 * t149;
  t3124 = t1142 * t27;
  t3125 = t3124 * t146;
  t3128 = t1108 * t378;
  t3130 = t183 * t369;
  t3131 = t3130 * t146;
  t3132 = t3131 * t149;
  t3133 = t3132 / 0.9e1;
  t3134 = t1112 * t378;
  t3135 = t3134 * t149;
  t3137 = t439 * t847;
  t3144 = t1113 * t392;
  t3151 = -t3122 / 0.3e1 - t3125 * t149 / 0.2e1 - t3128 * t149 + t3133 - t3135 / 0.3e1 - t3137 * t149 / 0.2e1 - 0.35e2 / 0.27e2 * t440 * t844 + 0.7e1 / 0.6e1 * t1109 * t392 + 0.7e1 / 0.18e2 * t3144 + 0.7e1 / 0.6e1 * t1116 * t392 - 0.35e2 / 0.81e2 * t2610 + 0.7e1 / 0.18e2 * t2624 - 0.7e1 / 0.27e2 * t2626;
  t3159 = t439 * t1052;
  t3163 = t1112 * t358;
  t3164 = t3163 * t347;
  t3166 = t1112 * t343;
  t3167 = t3166 * t347;
  t3169 = t1108 * t343;
  t3172 = t439 * t1036;
  t3175 = -t2631 / 0.6e1 + 0.7e1 / 0.18e2 * t2635 + 0.2e1 / 0.9e1 * t2639 - t2643 / 0.6e1 - t2646 / 0.3e1 - 0.5e1 / 0.27e2 * t2650 + 0.2e1 / 0.9e1 * t2653 - 0.8e1 / 0.81e2 * t3159 * t353 + 0.16e2 / 0.2187e4 * t2671 - 0.8e1 / 0.729e3 * t3164 - 0.4e1 / 0.729e3 * t3167 - 0.4e1 / 0.243e3 * t3169 * t347 - 0.4e1 / 0.243e3 * t3172 * t347;
  t3183 = t1108 * t358;
  t3186 = t439 * t1059;
  t3189 = t1108 * t350;
  t3192 = t1112 * t350;
  t3193 = t3192 * t353;
  t3201 = 0.56e2 / 0.243e3 * t1179 * t1063 + 0.56e2 / 0.729e3 * t1182 * t1066 + 0.28e2 / 0.729e3 * t1185 * t1066 - 0.8e1 / 0.243e3 * t3183 * t347 - 0.8e1 / 0.243e3 * t3186 * t347 - 0.8e1 / 0.81e2 * t3189 * t353 - 0.8e1 / 0.243e3 * t3193 + 0.56e2 / 0.2187e4 * t2679 + 0.8e1 / 0.2187e4 * t2682 + 0.28e2 / 0.2187e4 * t2684 + 0.16e2 / 0.729e3 * t2687 + 0.56e2 / 0.729e3 * t2689 - 0.4e1 / 0.729e3 * t2723;
  t3217 = -0.4e1 / 0.729e3 * t2726 - 0.8e1 / 0.243e3 * t2729 - 0.8e1 / 0.243e3 * t2732 - 0.8e1 / 0.729e3 * t2735 - 0.8e1 / 0.729e3 * t2738 + 0.56e2 / 0.81e2 * t1175 * t1030 - 0.8e1 / 0.81e2 * t2766 - 0.32e2 / 0.6561e4 * t2772 - 0.64e2 / 0.19683e5 * t2774 - 0.64e2 / 0.59049e5 * t2776 - 0.64e2 / 0.2187e4 * t2779 - 0.64e2 / 0.6561e4 * t2782 - 0.64e2 / 0.19683e5 * t2785 - 0.8e1 / 0.81e2 * t2793;
  t3220 = t439 * t1011;
  t3225 = t439 * t1017;
  t3232 = t1108 * t283;
  t3235 = t1112 * t283;
  t3236 = t3235 * t290;
  t3238 = t439 * t988;
  t3241 = t439 * t992;
  t3246 = t184 * t877;
  t3248 = t432 * t371;
  t3249 = t3248 / 0.4e1;
  t3250 = -0.64e2 / 0.2187e4 * t3220 * t1001 - 0.32e2 / 0.2187e4 * t1179 * t1001 - 0.64e2 / 0.6561e4 * t3225 * t1006 - 0.64e2 / 0.6561e4 * t1182 * t1006 - 0.64e2 / 0.19683e5 * t1185 * t1006 - 0.8e1 / 0.27e2 * t3232 * t290 - 0.8e1 / 0.81e2 * t3236 - 0.8e1 / 0.27e2 * t3238 * t290 - 0.64e2 / 0.729e3 * t3241 * t996 + 0.16e2 / 0.243e3 * t2875 + 0.56e2 / 0.243e3 * t2878 - 0.3e1 / 0.8e1 * t3246 + t3249;
  t3251 = t184 * t913;
  t3253 = t1143 * t119;
  t3255 = t432 * t321;
  t3257 = t184 * t921;
  t3258 = t3257 / 0.4e1;
  t3279 = 0.12e2 * t933;
  t3280 = 0.24e2 * t2924;
  t3282 = my_piecewise5(t10, 0, t14, 0, -t3279 + t3280);
  t3286 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t180 * t926 - 0.8e1 / 0.9e1 * t925 * t427 * t302 - 0.8e1 / 0.9e1 * t1127 * t109 * t310 + 0.4e1 / 0.3e1 * t301 * t1138 * t109 + 0.4e1 / 0.3e1 * t1130 * t310 + 0.4e1 / 0.9e1 * t423 * t937 + 0.4e1 / 0.3e1 * t23 * t3282);
  t3296 = -0.5e1 / 0.36e2 * t3251 - 0.3e1 / 0.8e1 * t3253 - 0.3e1 / 0.4e1 * t3255 + t3258 - 0.9e1 / 0.8e1 * t432 * t340 - 0.3e1 / 0.8e1 * t184 * t904 - 0.3e1 / 0.8e1 * t5 * t3286 * t61 - 0.9e1 / 0.8e1 * t1143 * t140 + t2946 - 0.5e1 / 0.12e2 * t2947 + t2951 / 0.4e1 + t2953 / 0.2e1 - 0.5e1 / 0.12e2 * t2956;
  t3311 = -t2958 / 0.8e1 - 0.3e1 / 0.8e1 * t2960 - 0.3e1 / 0.8e1 * t2962 + t2966 / 0.4e1 - t2972 / 0.8e1 - t3005 / 0.18e2 - 0.64e2 / 0.729e3 * t3012 + 0.2e1 / 0.27e2 * t3035 + 0.7e1 / 0.54e2 * t3041 + 0.7e1 / 0.54e2 * t3043 - 0.5e1 / 0.81e2 * t3056 - t3059 / 0.18e2 - t3062 / 0.9e1;
  t3317 = t1165 * t297;
  t3319 = t439 * t954;
  t3326 = t439 * t977;
  t3329 = t3124 * t152;
  t3332 = t1108 * t388;
  t3335 = t1112 * t388;
  t3336 = t3335 * t157;
  t3338 = t3120 * t152;
  t3339 = t3338 * t157;
  t3341 = t3130 * t152;
  t3342 = t3341 * t157;
  t3343 = t3342 / 0.27e2;
  t3344 = -0.7e1 / 0.81e2 * t3064 - 0.35e2 / 0.243e3 * t3066 + 0.2e1 / 0.27e2 * t3072 - 0.35e2 / 0.81e2 * t443 * t949 + 0.7e1 / 0.54e2 * t3317 - 0.64e2 / 0.243e3 * t3319 * t959 + 0.7e1 / 0.18e2 * t1162 * t297 + 0.7e1 / 0.18e2 * t1168 * t297 - t3326 * t157 / 0.6e1 - t3329 * t157 / 0.6e1 - t3332 * t157 / 0.3e1 - t3336 / 0.9e1 - t3339 / 0.9e1 + t3343;
  t3348 = my_piecewise3(t1, 0, t3151 + t3175 + t3201 + t3217 + t3250 + t3296 + t3311 + t3344);
  t3349 = t167 * t369;
  t3350 = t3349 * t224;
  t3351 = t3350 * t229;
  t3352 = t3351 / 0.27e2;
  t3353 = t73 * t911;
  t3354 = t3353 * t224;
  t3355 = t3354 * t229;
  t3357 = t409 * t117;
  t3358 = t3357 * t224;
  t3359 = t3358 * t229;
  t3361 = t1090 * t27;
  t3362 = t3361 * t218;
  t3365 = t1209 * t172;
  t3367 = t461 * t416;
  t3368 = t3367 / 0.4e1;
  t3369 = t194 * t1099;
  t3371 = t410 * t470;
  t3373 = t168 * t1223;
  t3374 = t3373 / 0.4e1;
  t3377 = t74 * t911 * t210 * t100;
  t3400 = 0.24e2 * t3093;
  t3402 = my_piecewise5(t14, 0, t10, 0, t3279 + t3400);
  t3406 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t190 * t1077 - 0.8e1 / 0.9e1 * t1076 * t456 * t399 - 0.8e1 / 0.9e1 * t1194 * t164 * t405 + 0.4e1 / 0.3e1 * t398 * t1204 * t164 + 0.4e1 / 0.3e1 * t1197 * t405 + 0.4e1 / 0.9e1 * t452 * t1086 + 0.4e1 / 0.3e1 * t71 * t3402);
  t3410 = t3353 * t218;
  t3411 = t3410 * t221;
  t3413 = t3361 * t224;
  t3416 = t3357 * t218;
  t3417 = t3416 * t221;
  t3419 = t3349 * t218;
  t3420 = t3419 * t221;
  t3421 = t3420 / 0.9e1;
  t3422 = t3352 - 0.5e1 / 0.243e3 * t3355 - t3359 / 0.18e2 - t3362 * t221 / 0.6e1 - 0.3e1 / 0.8e1 * t3365 + t3368 - 0.5e1 / 0.36e2 * t3369 - 0.3e1 / 0.8e1 * t3371 + t3374 - 0.5e1 / 0.36e2 * t3377 - t3104 / 0.8e1 + t3106 / 0.4e1 - 0.5e1 / 0.12e2 * t3108 + t3113 - 0.3e1 / 0.8e1 * t1091 * t212 - 0.3e1 / 0.8e1 * t5 * t3406 * t101 - 0.5e1 / 0.81e2 * t3411 - t3413 * t229 / 0.18e2 - t3417 / 0.6e1 + t3421;
  t3423 = my_piecewise3(t65, 0, t3422);
  tv4rho41 = t1074 + t1103 + 0.3e1 * t1193 + 0.3e1 * t1248 + t6 * (t3348 + t3423);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3430 = t1272 * t378;
  t3433 = t1264 * t27;
  t3434 = t3433 * t146;
  t3437 = t502 * t117;
  t3438 = t3437 * t146;
  t3439 = t3438 * t149;
  t3451 = t1272 * t350;
  t3454 = -t3430 * t149 / 0.3e1 - t3434 * t149 / 0.3e1 - t3439 / 0.9e1 + 0.7e1 / 0.18e2 * t1273 * t392 - 0.2e1 / 0.9e1 * t3122 + 0.4e1 / 0.27e2 * t3132 - 0.2e1 / 0.9e1 * t3135 + 0.7e1 / 0.27e2 * t3144 - 0.7e1 / 0.81e2 * t2626 + 0.2e1 / 0.27e2 * t2639 - 0.1e2 / 0.81e2 * t2650 + 0.2e1 / 0.27e2 * t2653 - 0.8e1 / 0.243e3 * t3451 * t353;
  t3455 = t1272 * t358;
  t3458 = t1272 * t343;
  t3467 = t1272 * t283;
  t3472 = t1265 * t119;
  t3474 = t503 * t371;
  t3484 = t427 * t427;
  t3497 = my_piecewise5(t10, 0, t14, 0, t3280);
  t3501 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t493 * t302 - 0.32e2 / 0.27e2 * t1127 * t109 * t427 - 0.8e1 / 0.27e2 * t1251 * t310 + 0.8e1 / 0.9e1 * t301 * t3484 + 0.8e1 / 0.9e1 * t423 * t1138 - 0.8e1 / 0.27e2 * t925 * t498 * t302 + 0.8e1 / 0.9e1 * t301 * t1260 * t109 + 0.4e1 / 0.9e1 * t1256 * t310 + 0.4e1 / 0.3e1 * t23 * t3497);
  t3505 = -0.8e1 / 0.729e3 * t3455 * t347 - 0.4e1 / 0.729e3 * t3458 * t347 + 0.16e2 / 0.6561e4 * t2671 - 0.16e2 / 0.2187e4 * t3164 - 0.8e1 / 0.2187e4 * t3167 - 0.16e2 / 0.729e3 * t3193 + 0.8e1 / 0.6561e4 * t2682 + 0.16e2 / 0.2187e4 * t2687 - 0.8e1 / 0.81e2 * t3467 * t290 - 0.16e2 / 0.243e3 * t3236 + 0.16e2 / 0.729e3 * t2875 - t3472 / 0.4e1 + t3474 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t3501 * t61;
  t3509 = t503 * t321;
  t3522 = -0.3e1 / 0.4e1 * t1265 * t140 - t3509 / 0.4e1 - 0.3e1 / 0.8e1 * t503 * t340 - t3246 / 0.4e1 + t3248 / 0.3e1 - 0.5e1 / 0.18e2 * t3251 - t3253 / 0.4e1 - t3255 / 0.2e1 + t3257 / 0.3e1 + t2946 - 0.5e1 / 0.18e2 * t2947 + t2951 / 0.12e2 + t2953 / 0.6e1;
  t3535 = t3437 * t152;
  t3536 = t3535 * t157;
  t3538 = t1272 * t388;
  t3541 = t3433 * t152;
  t3544 = -0.5e1 / 0.18e2 * t2956 + t2966 / 0.12e2 + 0.2e1 / 0.81e2 * t3035 - 0.1e2 / 0.243e3 * t3056 - 0.7e1 / 0.243e3 * t3064 + 0.2e1 / 0.81e2 * t3072 + 0.7e1 / 0.81e2 * t3317 - 0.2e1 / 0.27e2 * t3336 - 0.2e1 / 0.27e2 * t3339 + 0.4e1 / 0.81e2 * t3342 + 0.7e1 / 0.54e2 * t1276 * t297 - t3536 / 0.27e2 - t3538 * t157 / 0.9e1 - t3541 * t157 / 0.9e1;
  t3547 = my_piecewise3(t1, 0, t3454 + t3505 + t3522 + t3544);
  t3550 = t1208 * t27;
  t3551 = t3550 * t218;
  t3554 = t1226 * t513;
  t3557 = t1234 * t513;
  t3558 = t3557 * t221;
  t3560 = t1235 * t598;
  t3562 = t1230 * t513;
  t3563 = t3562 * t221;
  t3565 = t193 * t369;
  t3566 = t3565 * t218;
  t3567 = t3566 * t221;
  t3569 = t1231 * t598;
  t3571 = t460 * t117;
  t3572 = t3571 * t218;
  t3573 = t3572 * t221;
  t3578 = t1230 * t578;
  t3579 = t3578 * t582;
  t3581 = 0.7e1 / 0.18e2 * t1227 * t598 - t3551 * t221 / 0.3e1 - t3554 * t221 / 0.3e1 + 0.2e1 / 0.27e2 * t3558 - 0.7e1 / 0.81e2 * t3560 - 0.2e1 / 0.9e1 * t3563 + 0.2e1 / 0.27e2 * t3567 + 0.7e1 / 0.27e2 * t3569 - 0.2e1 / 0.9e1 * t3573 - 0.1e2 / 0.81e2 * t3411 - t3417 / 0.9e1 + 0.4e1 / 0.27e2 * t3420 - 0.16e2 / 0.2187e4 * t3579;
  t3582 = t1234 * t578;
  t3583 = t3582 * t582;
  t3585 = t1234 * t585;
  t3586 = t3585 * t582;
  t3588 = t1234 * t570;
  t3589 = t3588 * t573;
  t3591 = t1226 * t570;
  t3594 = t1226 * t578;
  t3597 = t1226 * t585;
  t3600 = t1230 * t585;
  t3601 = t3600 * t582;
  t3603 = t1230 * t570;
  t3604 = t3603 * t573;
  t3606 = t1226 * t529;
  t3609 = t1230 * t529;
  t3610 = t3609 * t536;
  t3612 = t1234 * t529;
  t3613 = t3612 * t536;
  t3619 = t461 * t470;
  t3621 = 0.16e2 / 0.6561e4 * t3583 + 0.8e1 / 0.6561e4 * t3586 + 0.16e2 / 0.2187e4 * t3589 - 0.8e1 / 0.243e3 * t3591 * t573 - 0.8e1 / 0.729e3 * t3594 * t582 - 0.4e1 / 0.729e3 * t3597 * t582 - 0.8e1 / 0.2187e4 * t3601 - 0.16e2 / 0.729e3 * t3604 - 0.8e1 / 0.81e2 * t3606 * t536 - 0.16e2 / 0.243e3 * t3610 + 0.16e2 / 0.729e3 * t3613 - 0.3e1 / 0.4e1 * t1209 * t212 - 0.3e1 / 0.8e1 * t410 * t567 - t3619 / 0.2e1;
  t3623 = t168 * t1308;
  t3625 = t1327 * t172;
  t3635 = t456 * t456;
  t3648 = my_piecewise5(t14, 0, t10, 0, t3400);
  t3652 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t539 * t399 - 0.32e2 / 0.27e2 * t1194 * t164 * t456 - 0.8e1 / 0.27e2 * t1313 * t405 + 0.8e1 / 0.9e1 * t398 * t3635 + 0.8e1 / 0.9e1 * t452 * t1204 - 0.8e1 / 0.27e2 * t1076 * t544 * t399 + 0.8e1 / 0.9e1 * t398 * t1322 * t164 + 0.4e1 / 0.9e1 * t1318 * t405 + 0.4e1 / 0.3e1 * t71 * t3648);
  t3656 = t549 * t416;
  t3658 = t194 * t1223;
  t3662 = t74 * t369 * t565 * t100;
  t3670 = -t3623 / 0.4e1 - t3625 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t3652 * t101 + t3656 / 0.12e2 + t3658 / 0.6e1 + t3662 / 0.12e2 - 0.5e1 / 0.18e2 * t3377 - t3365 / 0.4e1 + t3367 / 0.3e1 - 0.5e1 / 0.18e2 * t3369 - t3371 / 0.4e1 + t3373 / 0.3e1 + t3113;
  t3676 = t1244 * t522;
  t3678 = t3565 * t224;
  t3679 = t3678 * t229;
  t3681 = t1234 * t594;
  t3682 = t3681 * t229;
  t3686 = t3550 * t224;
  t3689 = t1226 * t594;
  t3692 = t3571 * t224;
  t3693 = t3692 * t229;
  t3695 = t1230 * t594;
  t3696 = t3695 * t229;
  t3698 = t1241 * t522;
  t3700 = t3106 / 0.12e2 - 0.5e1 / 0.18e2 * t3108 + 0.4e1 / 0.81e2 * t3351 - 0.1e2 / 0.243e3 * t3355 - t3359 / 0.27e2 - 0.7e1 / 0.243e3 * t3676 + 0.2e1 / 0.81e2 * t3679 + 0.2e1 / 0.81e2 * t3682 + 0.7e1 / 0.54e2 * t1238 * t522 - t3686 * t229 / 0.9e1 - t3689 * t229 / 0.9e1 - 0.2e1 / 0.27e2 * t3693 - 0.2e1 / 0.27e2 * t3696 + 0.7e1 / 0.81e2 * t3698;
  t3703 = my_piecewise3(t65, 0, t3581 + t3621 + t3670 + t3700);
  tv4rho42 = 0.2e1 * t1193 + 0.2e1 * t1248 + 0.2e1 * t1285 + 0.2e1 * t1381 + t6 * (t3547 + t3703);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3724 = my_piecewise5(t10, 0, t14, 0, t3279 + t3280);
  t3728 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t1386 * t109 - 0.8e1 / 0.9e1 * t1251 * t427 - 0.8e1 / 0.9e1 * t1127 * t498 * t109 + 0.4e1 / 0.3e1 * t1130 * t498 + 0.4e1 / 0.3e1 * t423 * t1260 + 0.4e1 / 0.9e1 * t301 * t1393 * t109 + 0.4e1 / 0.3e1 * t23 * t3724);
  t3732 = t1398 * t119;
  t3736 = t1397 * t27;
  t3737 = t3736 * t146;
  t3740 = t3736 * t152;
  t3753 = -0.3e1 / 0.8e1 * t5 * t3728 * t61 - t3732 / 0.8e1 - 0.3e1 / 0.8e1 * t1398 * t140 - t3737 * t149 / 0.6e1 - t3740 * t157 / 0.18e2 - 0.3e1 / 0.8e1 * t3472 + t3474 / 0.4e1 - 0.3e1 / 0.8e1 * t3509 - t3439 / 0.6e1 - t3536 / 0.18e2 + t3249 - 0.5e1 / 0.12e2 * t3251 + t3258 + t3133 + t3343 - 0.5e1 / 0.36e2 * t2947 + t2946 - 0.5e1 / 0.36e2 * t2956 - 0.5e1 / 0.81e2 * t2650 - 0.5e1 / 0.243e3 * t3056;
  t3754 = my_piecewise3(t1, 0, t3753);
  t3755 = t478 * t1425;
  t3757 = t1287 * t598;
  t3759 = t1290 * t598;
  t3761 = t548 * t117;
  t3762 = t3761 * t218;
  t3763 = t3762 * t221;
  t3765 = t1286 * t513;
  t3766 = t3765 * t221;
  t3768 = t477 * t1418;
  t3769 = t3768 * t221;
  t3777 = t1326 * t27;
  t3778 = t3777 * t218;
  t3781 = t1298 * t513;
  t3783 = t473 * t1418;
  t3787 = -0.35e2 / 0.81e2 * t3755 + 0.7e1 / 0.18e2 * t3757 + 0.7e1 / 0.18e2 * t3759 - t3763 / 0.6e1 - t3766 / 0.3e1 - t3769 / 0.6e1 - 0.35e2 / 0.27e2 * t474 * t1425 + 0.7e1 / 0.6e1 * t1299 * t598 + 0.7e1 / 0.6e1 * t1302 * t598 - t3778 * t221 / 0.2e1 - t3781 * t221 - t3783 * t221 / 0.2e1 + 0.2e1 / 0.9e1 * t3558;
  t3795 = t473 * t1573;
  t3804 = t1298 * t578;
  t3807 = -0.7e1 / 0.27e2 * t3560 - t3563 / 0.3e1 + 0.2e1 / 0.9e1 * t3567 + 0.7e1 / 0.18e2 * t3569 - t3573 / 0.3e1 - 0.5e1 / 0.27e2 * t3411 + t3421 - 0.8e1 / 0.729e3 * t3579 - 0.8e1 / 0.81e2 * t3795 * t573 + 0.56e2 / 0.243e3 * t1370 * t1577 + 0.56e2 / 0.729e3 * t1373 * t1580 + 0.28e2 / 0.729e3 * t1376 * t1580 - 0.8e1 / 0.243e3 * t3804 * t582;
  t3809 = t473 * t1559;
  t3812 = t1298 * t585;
  t3815 = t473 * t1566;
  t3818 = t1298 * t570;
  t3821 = t1361 * t1580;
  t3823 = t1364 * t1580;
  t3825 = t477 * t1573;
  t3826 = t3825 * t573;
  t3828 = t1367 * t1577;
  t3830 = t1286 * t585;
  t3831 = t3830 * t582;
  t3833 = t477 * t1566;
  t3834 = t3833 * t582;
  t3836 = t1286 * t570;
  t3837 = t3836 * t573;
  t3839 = t1286 * t578;
  t3840 = t3839 * t582;
  t3842 = t477 * t1559;
  t3843 = t3842 * t582;
  t3845 = -0.8e1 / 0.243e3 * t3809 * t582 - 0.4e1 / 0.243e3 * t3812 * t582 - 0.4e1 / 0.243e3 * t3815 * t582 - 0.8e1 / 0.81e2 * t3818 * t573 + 0.56e2 / 0.2187e4 * t3821 + 0.28e2 / 0.2187e4 * t3823 - 0.8e1 / 0.243e3 * t3826 + 0.56e2 / 0.729e3 * t3828 - 0.4e1 / 0.729e3 * t3831 - 0.4e1 / 0.729e3 * t3834 - 0.8e1 / 0.243e3 * t3837 - 0.8e1 / 0.729e3 * t3840 - 0.8e1 / 0.729e3 * t3843;
  t3851 = t1286 * t529;
  t3852 = t3851 * t536;
  t3854 = t477 * t1547;
  t3855 = t3854 * t536;
  t3857 = t1355 * t1553;
  t3859 = t477 * t1531;
  t3860 = t3859 * t1535;
  t3862 = t1361 * t1535;
  t3864 = t1364 * t1535;
  t3866 = t477 * t1521;
  t3867 = t3866 * t1524;
  t3869 = t1367 * t1524;
  t3871 = t477 * t1514;
  t3872 = t3871 * t1518;
  t3874 = 0.16e2 / 0.2187e4 * t3583 + 0.8e1 / 0.2187e4 * t3586 + 0.16e2 / 0.729e3 * t3589 - 0.4e1 / 0.729e3 * t3601 - 0.8e1 / 0.243e3 * t3604 - 0.8e1 / 0.81e2 * t3852 - 0.8e1 / 0.81e2 * t3855 + 0.56e2 / 0.243e3 * t3857 - 0.64e2 / 0.19683e5 * t3860 - 0.64e2 / 0.19683e5 * t3862 - 0.64e2 / 0.59049e5 * t3864 - 0.64e2 / 0.6561e4 * t3867 - 0.32e2 / 0.6561e4 * t3869 - 0.64e2 / 0.2187e4 * t3872;
  t3881 = t473 * t1531;
  t3888 = t1298 * t529;
  t3891 = t473 * t1547;
  t3894 = t473 * t1514;
  t3897 = t473 * t1521;
  t3918 = my_piecewise5(t14, 0, t10, 0, -t3279 + t3400);
  t3922 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t1429 * t164 - 0.8e1 / 0.9e1 * t1313 * t456 - 0.8e1 / 0.9e1 * t1194 * t544 * t164 + 0.4e1 / 0.3e1 * t1197 * t544 + 0.4e1 / 0.3e1 * t452 * t1322 + 0.4e1 / 0.9e1 * t398 * t1436 * t164 + 0.4e1 / 0.3e1 * t71 * t3918);
  t3928 = 0.56e2 / 0.81e2 * t1358 * t1553 - 0.32e2 / 0.2187e4 * t1370 * t1524 - 0.64e2 / 0.6561e4 * t3881 * t1535 - 0.64e2 / 0.6561e4 * t1373 * t1535 - 0.64e2 / 0.19683e5 * t1376 * t1535 - 0.8e1 / 0.27e2 * t3888 * t536 - 0.8e1 / 0.27e2 * t3891 * t536 - 0.64e2 / 0.729e3 * t3894 * t1518 - 0.64e2 / 0.2187e4 * t3897 * t1524 - 0.8e1 / 0.81e2 * t3610 + 0.16e2 / 0.243e3 * t3613 - 0.3e1 / 0.8e1 * t5 * t3922 * t101 - 0.9e1 / 0.8e1 * t1327 * t212;
  t3933 = t549 * t470;
  t3935 = t194 * t1308;
  t3939 = t74 * t117 * t1470 * t100;
  t3941 = t1441 * t172;
  t3950 = -0.9e1 / 0.8e1 * t461 * t567 - 0.3e1 / 0.8e1 * t168 * t1472 - 0.3e1 / 0.8e1 * t3933 - 0.3e1 / 0.8e1 * t3935 - t3939 / 0.8e1 - t3941 / 0.8e1 - 0.3e1 / 0.4e1 * t3619 - 0.3e1 / 0.8e1 * t3623 - 0.3e1 / 0.8e1 * t3625 + t3656 / 0.4e1 + t3658 / 0.2e1 + t3662 / 0.4e1 - 0.5e1 / 0.12e2 * t3377;
  t3961 = t3368 - 0.5e1 / 0.12e2 * t3369 + t3374 + t3113 - 0.5e1 / 0.36e2 * t3108 + t3352 - 0.5e1 / 0.81e2 * t3355 - 0.7e1 / 0.81e2 * t3676 + 0.2e1 / 0.27e2 * t3679 + 0.2e1 / 0.27e2 * t3682 - t3693 / 0.9e1 - t3696 / 0.9e1 + 0.7e1 / 0.54e2 * t3698;
  t3962 = t477 * t1486;
  t3963 = t3962 * t1491;
  t3965 = t3761 * t224;
  t3966 = t3965 * t229;
  t3968 = t1286 * t594;
  t3969 = t3968 * t229;
  t3971 = t477 * t1500;
  t3972 = t3971 * t229;
  t3974 = t1338 * t522;
  t3976 = t1341 * t522;
  t3978 = t484 * t1509;
  t3982 = t473 * t1486;
  t3985 = t3777 * t224;
  t3988 = t1298 * t594;
  t3991 = t473 * t1500;
  t3998 = -0.64e2 / 0.729e3 * t3963 - t3966 / 0.18e2 - t3969 / 0.9e1 - t3972 / 0.18e2 + 0.7e1 / 0.54e2 * t3974 + 0.7e1 / 0.54e2 * t3976 - 0.35e2 / 0.243e3 * t3978 + 0.7e1 / 0.18e2 * t1351 * t522 - 0.64e2 / 0.243e3 * t3982 * t1491 - t3985 * t229 / 0.6e1 - t3988 * t229 / 0.3e1 - t3991 * t229 / 0.6e1 + 0.7e1 / 0.18e2 * t1348 * t522 - 0.35e2 / 0.81e2 * t481 * t1509;
  t4002 = my_piecewise3(t65, 0, t3787 + t3807 + t3845 + t3874 + t3928 + t3950 + t3961 + t3998);
  tv4rho43 = 0.3e1 * t1285 + 0.3e1 * t1381 + t1404 + t1591 + t6 * (t3754 + t4002);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4007 = t493 * t493;
  t4012 = t498 * t498;
  t4019 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t933 + 0.24e2 * t2924);
  t4023 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t4007 - 0.16e2 / 0.9e1 * t1251 * t498 + 0.4e1 / 0.3e1 * t301 * t4012 + 0.16e2 / 0.9e1 * t423 * t1393 + 0.4e1 / 0.3e1 * t23 * t4019);
  t4031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t4023 * t61 - t3732 / 0.2e1 + t3474 / 0.2e1 - 0.5e1 / 0.9e1 * t3251 + t2946);
  t4038 = t1440 * t27;
  t4039 = t4038 * t218;
  t4042 = t1412 * t513;
  t4045 = t509 * t1418;
  t4049 = t215 * t1470 * t217;
  t4053 = 0.1e1 / t77 / t1449;
  t4054 = t84 * t4053;
  t4068 = 0.7e1 / 0.3e1 * t1419 * t598 - 0.14e3 / 0.27e2 * t510 * t1425 - 0.14e3 / 0.27e2 * t514 * t1425 - 0.2e1 / 0.3e1 * t4039 * t221 - 0.2e1 * t4042 * t221 - 0.2e1 * t4045 * t221 - 0.2e1 / 0.3e1 * t4049 * t221 + 0.455e3 / 0.81e2 * t219 * t220 * t4054 + 0.7e1 / 0.3e1 * t1413 * t598 + 0.14e2 / 0.3e1 * t1416 * t598 - 0.14e3 / 0.81e2 * t3755 + 0.14e2 / 0.9e1 * t3757 + 0.14e2 / 0.9e1 * t3759 - 0.2e1 / 0.3e1 * t3763 - 0.4e1 / 0.3e1 * t3766 - 0.2e1 / 0.3e1 * t3769;
  t4073 = t509 * t1573;
  t4077 = t215 * t1418 * t227;
  t4092 = t509 * t1566;
  t4096 = t215 * t1500 * t227;
  t4099 = t1412 * t578;
  t4102 = t509 * t1559;
  t4106 = t215 * t1500 * t577;
  t4109 = 0.4e1 / 0.9e1 * t3558 - 0.14e2 / 0.27e2 * t3560 + 0.4e1 / 0.9e1 * t3567 - 0.2e2 / 0.81e2 * t3411 - 0.32e2 / 0.81e2 * t4073 * t573 - 0.16e2 / 0.81e2 * t4077 * t573 + 0.224e3 / 0.243e3 * t1574 * t1577 + 0.112e3 / 0.729e3 * t1563 * t1580 + 0.112e3 / 0.729e3 * t1567 * t1580 + 0.224e3 / 0.243e3 * t1570 * t1577 + 0.224e3 / 0.729e3 * t1556 * t1580 + 0.224e3 / 0.729e3 * t1560 * t1580 - 0.16e2 / 0.243e3 * t4092 * t582 - 0.8e1 / 0.243e3 * t4096 * t582 - 0.16e2 / 0.243e3 * t4099 * t582 - 0.32e2 / 0.243e3 * t4102 * t582 - 0.16e2 / 0.243e3 * t4106 * t582;
  t4111 = t1412 * t585;
  t4115 = 0.1e1 / t78 / t1991;
  t4116 = t75 * t4115;
  t4120 = t4116 * t581;
  t4125 = t1412 * t570;
  t4140 = -0.8e1 / 0.243e3 * t4111 * t582 - 0.3416e4 / 0.2187e4 * t571 * t4116 * t572 - 0.3416e4 / 0.6561e4 * t579 * t4120 - 0.1708e4 / 0.6561e4 * t586 * t4120 - 0.16e2 / 0.81e2 * t4125 * t573 + 0.224e3 / 0.2187e4 * t3821 + 0.112e3 / 0.2187e4 * t3823 - 0.32e2 / 0.243e3 * t3826 + 0.224e3 / 0.729e3 * t3828 - 0.16e2 / 0.729e3 * t3831 - 0.16e2 / 0.729e3 * t3834 - 0.32e2 / 0.243e3 * t3837 - 0.32e2 / 0.729e3 * t3840 - 0.32e2 / 0.729e3 * t3843 + 0.32e2 / 0.2187e4 * t3583 + 0.16e2 / 0.2187e4 * t3586 + 0.32e2 / 0.729e3 * t3589;
  t4143 = t531 * t531;
  t4146 = 0.1e1 / t77 / t4143 / rho[1];
  t4147 = t2525 * t4146;
  t4149 = M_PI * t1466 * t43;
  t4150 = t4147 * t4149;
  t4153 = t509 * t1531;
  t4157 = t215 * t594 * t1530;
  t4160 = t1412 * t529;
  t4163 = t509 * t1547;
  t4166 = 0.1e1 / t4143;
  t4167 = t796 * t4166;
  t4168 = t4167 * t1534;
  t4174 = t4167 * t1523;
  t4180 = 0.1e1 / t1529 / t92;
  t4182 = t215 * t224 * t4180;
  t4183 = t560 * t560;
  t4184 = 0.1e1 / t4183;
  t4186 = t4184 * M_PI * t43;
  t4187 = t4147 * t4186;
  t4202 = -0.128e3 / 0.2187e4 * t1574 * t1524 - 0.1024e4 / 0.177147e6 * t571 * t4150 - 0.256e3 / 0.6561e4 * t4153 * t1535 - 0.256e3 / 0.6561e4 * t4157 * t1535 - 0.16e2 / 0.27e2 * t4160 * t536 - 0.32e2 / 0.27e2 * t4163 * t536 + 0.896e3 / 0.19683e5 * t586 * t4168 + 0.896e3 / 0.729e3 * t1515 * t4167 * t1517 + 0.896e3 / 0.2187e4 * t1522 * t4174 + 0.448e3 / 0.2187e4 * t571 * t4174 - 0.1024e4 / 0.177147e6 * t4182 * t4187 - 0.512e3 / 0.59049e5 * t1532 * t4187 - 0.256e3 / 0.6561e4 * t1556 * t1535 - 0.256e3 / 0.6561e4 * t1560 * t1535 - 0.2816e4 / 0.531441e6 * t579 * t4187 - 0.256e3 / 0.19683e5 * t1563 * t1535 - 0.256e3 / 0.19683e5 * t1567 * t1535;
  t4207 = t565 * t527;
  t4209 = t215 * t4207 * t99;
  t4212 = t509 * t1514;
  t4216 = t215 * t1546 * t227;
  t4220 = t215 * t1486 * t227;
  t4222 = M_PI * t206 * t43;
  t4227 = t215 * t528 * t577;
  t4229 = M_PI * t561 * t43;
  t4230 = t4147 * t4229;
  t4235 = t509 * t1521;
  t4239 = t215 * t513 * t577;
  t4243 = t215 * t218 * t1530;
  t4254 = -0.256e3 / 0.177147e6 * t586 * t4187 - 0.16e2 / 0.27e2 * t4209 * t536 - 0.256e3 / 0.729e3 * t4212 * t1518 - 0.256e3 / 0.729e3 * t4216 * t1518 - 0.1024e4 / 0.6561e4 * t4220 * t4147 * t4222 - 0.1024e4 / 0.19683e5 * t4227 * t4230 - 0.512e3 / 0.19683e5 * t1515 * t4230 - 0.256e3 / 0.2187e4 * t4235 * t1524 - 0.256e3 / 0.2187e4 * t4239 * t1524 - 0.1024e4 / 0.59049e5 * t4243 * t4150 - 0.1024e4 / 0.59049e5 * t1522 * t4150 - 0.128e3 / 0.2187e4 * t1570 * t1524 - 0.32e2 / 0.81e2 * t3852 - 0.32e2 / 0.81e2 * t3855 + 0.224e3 / 0.243e3 * t3857 - 0.256e3 / 0.19683e5 * t3860;
  t4278 = t4054 * t206;
  t4291 = t4184 * t41 * t43;
  t4299 = t539 * t539;
  t4304 = t544 * t544;
  t4311 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t933 + 0.24e2 * t3093);
  t4315 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t4299 - 0.16e2 / 0.9e1 * t1313 * t544 + 0.4e1 / 0.3e1 * t398 * t4304 + 0.16e2 / 0.9e1 * t452 * t1436 + 0.4e1 / 0.3e1 * t71 * t4311);
  t4324 = -0.256e3 / 0.19683e5 * t3862 - 0.256e3 / 0.59049e5 * t3864 - 0.256e3 / 0.6561e4 * t3867 - 0.128e3 / 0.6561e4 * t3869 - 0.256e3 / 0.2187e4 * t3872 - 0.3416e4 / 0.729e3 * t530 * t75 * t4115 * t41 * t3 + 0.224e3 / 0.81e2 * t1542 * t1553 + 0.224e3 / 0.81e2 * t1548 * t1553 + 0.896e3 / 0.6561e4 * t1532 * t4168 + 0.896e3 / 0.6561e4 * t579 * t4168 + 0.32e2 / 0.243e3 * t3613 - 0.3e1 / 0.2e1 * t194 * t1472 - 0.3e1 / 0.8e1 * t74 * t27 * (0.41888e5 / 0.6561e4 * t29 * t4116 + 0.364e4 / 0.2187e4 * t130 * t4278 - 0.13664e5 / 0.19683e5 * t331 * sigma[2] * t4115 * t561 + 0.7168e4 / 0.59049e5 * t1462 * t4166 * t1466 - 0.2048e4 / 0.1594323e7 * t2986 * t2525 * t4146 * t4291) * t100 - 0.3e1 / 0.8e1 * t5 * t4315 * t101 - 0.3e1 / 0.2e1 * t1441 * t212 - 0.9e1 / 0.4e1 * t549 * t567 - 0.3e1 / 0.2e1 * t3933;
  t4341 = -0.3e1 / 0.2e1 * t3935 - t3939 / 0.2e1 - t3941 / 0.2e1 + t3656 / 0.2e1 + t3658 + t3662 / 0.2e1 - 0.5e1 / 0.9e1 * t3377 - 0.5e1 / 0.9e1 * t3369 + t3113 - 0.2e2 / 0.243e3 * t3355 - 0.14e2 / 0.81e2 * t3676 + 0.4e1 / 0.27e2 * t3679 + 0.4e1 / 0.27e2 * t3682 - 0.256e3 / 0.729e3 * t3963 - 0.2e1 / 0.9e1 * t3966 - 0.4e1 / 0.9e1 * t3969 - 0.2e1 / 0.9e1 * t3972;
  t4354 = t215 * t94 / t1484 / t97;
  t4364 = t4038 * t224;
  t4367 = t1412 * t594;
  t4370 = t509 * t1500;
  t4374 = t215 * t1470 * t98;
  t4382 = t509 * t1486;
  t4386 = t215 * t210 * t1485;
  t4393 = 0.14e2 / 0.27e2 * t3974 + 0.14e2 / 0.27e2 * t3976 - 0.14e3 / 0.243e3 * t3978 + 0.7e1 / 0.9e1 * t1494 * t522 + 0.14e2 / 0.9e1 * t1497 * t522 + 0.7e1 / 0.9e1 * t1501 * t522 - 0.1024e4 / 0.2187e4 * t4354 * t99 * t2525 * t4146 * M_PI * t43 + 0.455e3 / 0.243e3 * t225 * t228 * t4278 - 0.2e1 / 0.9e1 * t4364 * t229 - 0.2e1 / 0.3e1 * t4367 * t229 - 0.2e1 / 0.3e1 * t4370 * t229 - 0.2e1 / 0.9e1 * t4374 * t229 + 0.896e3 / 0.243e3 * t1487 * t1488 * t4166 * t2 * t28 - 0.256e3 / 0.243e3 * t4382 * t1491 - 0.256e3 / 0.243e3 * t4386 * t1491 - 0.14e3 / 0.81e2 * t591 * t1509 - 0.14e3 / 0.81e2 * t595 * t1509;
  t4397 = my_piecewise3(t65, 0, t4068 + t4109 + t4140 + t4202 + t4254 + t4324 + t4341 + t4393);
  tv4rho44 = 0.4e1 * t1404 + 0.4e1 * t1591 + t6 * (t4031 + t4397);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4403 = t859 * t626;
  t4416 = t2642 * t249;
  t4418 = t2645 * t249;
  t4423 = t2652 * t249;
  t4425 = t852 * t650;
  t4428 = 0.5e1 / 0.216e3 * t2649 * t249;
  t4429 = t856 * t650;
  t4431 = t375 * t1655;
  t4433 = t239 * t842;
  t4437 = t1668 * t392;
  t4441 = t2638 * t249;
  t4443 = t865 * t650;
  t4447 = -t4423 / 0.24e2 - t4425 / 0.6e1 + t4428 + t4429 / 0.18e2 + 0.7e1 / 0.36e2 * t4431 - 0.35e2 / 0.54e2 * t147 * t148 * t4433 + 0.7e1 / 0.18e2 * t4437 - 0.35e2 / 0.27e2 * t627 * t844 - t4441 / 0.24e2 - t4443 / 0.6e1 + 0.7e1 / 0.12e2 * t379 * t1655;
  t4449 = t855 * t626;
  t4450 = t4449 * t149;
  t4452 = t851 * t626;
  t4453 = t4452 * t149;
  t4455 = t374 * t1671;
  t4456 = t4455 * t149;
  t4458 = t364 * t1671;
  t4461 = t143 * t1714 * t145;
  t4470 = t2630 * t249;
  t4472 = t364 * t1769;
  t4476 = t143 * t1671 * t155;
  t4479 = t4450 / 0.9e1 - t4453 / 0.3e1 - t4456 / 0.3e1 - t4458 * t149 - t4461 * t149 / 0.2e1 + t2657 * t249 / 0.16e2 + 0.3e1 / 0.16e2 * t2660 * t249 + 0.3e1 / 0.16e2 * t2663 * t249 + t4470 / 0.16e2 - 0.8e1 / 0.81e2 * t4472 * t353 - 0.8e1 / 0.81e2 * t4476 * t353;
  t4481 = t143 * t1759 * t357;
  t4485 = t143 * t1759 * t155;
  t4488 = t374 * t1777;
  t4489 = t4488 * t347;
  t4491 = t374 * t1773;
  t4492 = t4491 * t347;
  t4494 = t364 * t1773;
  t4497 = t364 * t1777;
  t4506 = t374 * t1769;
  t4507 = t4506 * t353;
  t4509 = t2781 * t1619;
  t4511 = -0.8e1 / 0.243e3 * t4481 * t347 - 0.4e1 / 0.243e3 * t4485 * t347 - 0.4e1 / 0.729e3 * t4489 - 0.8e1 / 0.729e3 * t4492 - 0.8e1 / 0.243e3 * t4494 * t347 - 0.4e1 / 0.243e3 * t4497 * t347 + 0.56e2 / 0.729e3 * t1774 * t1066 + 0.28e2 / 0.729e3 * t1778 * t1066 + 0.56e2 / 0.243e3 * t1770 * t1063 - 0.8e1 / 0.243e3 * t4507 + 0.8e1 / 0.729e3 * t4509;
  t4514 = t1046 * t1619;
  t4520 = t2670 * t659;
  t4522 = t2681 * t659;
  t4524 = t30 * t882;
  t4525 = t4524 * t346;
  t4528 = t2734 * t659;
  t4530 = t2722 * t659;
  t4540 = 0.1e1 / t33 / t2799;
  t4543 = M_PI * sigma[0] * t43;
  t4544 = t4540 * t898 * t4543;
  t4548 = t4540 * t2805 * t4543;
  t4560 = t143 * t626 * t357;
  t4566 = t143 * t630 * t1016;
  t4571 = 0.8e1 / 0.729e3 * t2836 * t1640 + 0.128e3 / 0.19683e5 * t2830 * t4544 + 0.128e3 / 0.59049e5 * t2846 * t4548 + 0.64e2 / 0.19683e5 * t1018 * t4548 + 0.8e1 / 0.729e3 * t1056 * t1640 + 0.128e3 / 0.19683e5 * t1012 * t4544 + 0.8e1 / 0.2187e4 * t1033 * t1640 - 0.64e2 / 0.2187e4 * t4560 * t1001 - 0.32e2 / 0.2187e4 * t1770 * t1001 - 0.64e2 / 0.6561e4 * t4566 * t1006 - 0.64e2 / 0.6561e4 * t1774 * t1006;
  t4575 = t4540 * M_PI;
  t4578 = t4575 * sigma[0] * t334 * t43;
  t4584 = t143 * t1624 * t155;
  t4590 = t1049 * t1630;
  t4595 = 0.5e1 / 0.36e2 * t26 * t911 * t244 * t60;
  t4598 = t4433 * t134;
  t4618 = t113 * t1689;
  t4622 = t26 * t369 * t621 * t60;
  t4624 = t315 * t608;
  t4626 = -0.64e2 / 0.19683e5 * t1778 * t1006 + 0.128e3 / 0.6561e4 * t2860 * t4578 + 0.64e2 / 0.6561e4 * t993 * t4578 - 0.64e2 / 0.729e3 * t4584 * t996 - 0.88e2 / 0.243e3 * t993 * t957 * t1613 - 0.5e1 / 0.243e3 * t4590 - t4595 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t4524 - 0.14e3 / 0.729e3 * t130 * t4598 + 0.952e3 / 0.6561e4 * t330 * t4524 * t334 - 0.704e3 / 0.19683e5 * t893 * t896 * t1711 + 0.256e3 / 0.531441e6 * t2986 * t4540 * t2805 * sigma[0] * t41 * t43) * t60 + t4618 / 0.4e1 + t4622 / 0.4e1 - 0.3e1 / 0.8e1 * t4624;
  t4627 = t113 * t1699;
  t4637 = t26 * t117 * t1714 * t60;
  t4639 = t957 * t1618;
  t4642 = t2784 * t1640;
  t4644 = t899 * t1639;
  t4647 = t1049 * t1640;
  t4649 = t1043 * t1630;
  t4653 = -0.3e1 / 0.4e1 * t4627 - 0.3e1 / 0.8e1 * t942 * t246 - 0.9e1 / 0.8e1 * t315 * t623 - 0.9e1 / 0.8e1 * t113 * t1716 - 0.3e1 / 0.8e1 * t4637 - 0.88e2 / 0.729e3 * t1012 * t4639 + 0.8e1 / 0.2187e4 * t4642 - 0.88e2 / 0.2187e4 * t1018 * t4644 + 0.8e1 / 0.2187e4 * t4647 - 0.5e1 / 0.486e3 * t4649 + 0.119e3 / 0.2187e4 * t344 * t4525;
  t4657 = t1043 * t1640;
  t4684 = t2686 * t647;
  t4686 = t1046 * t1633;
  t4688 = t2778 * t1614;
  t4690 = t374 * t1625;
  t4691 = t4690 * t290;
  t4693 = t621 * t281;
  t4695 = t143 * t4693 * t59;
  t4700 = t2728 * t647;
  t4708 = -0.88e2 / 0.6561e4 * t344 * t4644 - 0.2e1 / 0.243e3 * t4684 - 0.5e1 / 0.81e2 * t4686 + 0.8e1 / 0.243e3 * t4688 - 0.8e1 / 0.81e2 * t4691 - 0.8e1 / 0.27e2 * t4695 * t290 + 0.56e2 / 0.81e2 * t1626 * t1030 + 0.2e1 / 0.81e2 * t4700 - 0.5e1 / 0.27e2 * t1040 * t1633 + 0.8e1 / 0.81e2 * t2849 * t1614 + 0.2e1 / 0.27e2 * t2719 * t647;
  t4714 = t2731 * t647;
  t4716 = t2737 * t659;
  t4718 = t2725 * t659;
  t4732 = 0.2e1 / 0.81e2 * t2705 * t659 + t2747 * t659 / 0.81e2 + 0.2e1 / 0.81e2 * t4714 + 0.2e1 / 0.243e3 * t4716 + t4718 / 0.243e3 + 0.8e1 / 0.81e2 * t2769 * t1614 + 0.8e1 / 0.2187e4 * t1037 * t1640 + 0.128e3 / 0.59049e5 * t351 * t4544 + 0.352e3 / 0.177147e6 * t359 * t4548 + 0.32e2 / 0.59049e5 * t344 * t4548 - 0.5e1 / 0.81e2 * t1060 * t1630;
  t4739 = t364 * t1625;
  t4752 = t1741 * t297;
  t4755 = 0.5e1 / 0.648e3 * t3055 * t252;
  t4756 = 0.8e1 / 0.243e3 * t2826 * t1619 + 0.8e1 / 0.729e3 * t2840 * t1640 + 0.8e1 / 0.729e3 * t1060 * t1640 - 0.8e1 / 0.27e2 * t4739 * t290 - 0.5e1 / 0.162e3 * t1033 * t1630 - 0.5e1 / 0.162e3 * t1037 * t1630 - 0.44e2 / 0.729e3 * t351 * t4639 - 0.88e2 / 0.2187e4 * t359 * t4644 - 0.35e2 / 0.81e2 * t631 * t949 + 0.7e1 / 0.54e2 * t4752 + t4755;
  t4759 = t984 * t662;
  t4761 = t3071 * t252;
  t4763 = t981 * t662;
  t4765 = t385 * t1721;
  t4776 = t3034 * t252;
  t4778 = t974 * t662;
  t4781 = t374 * t1759;
  t4782 = t4781 * t157;
  t4784 = t3011 * t1750;
  t4790 = t3058 * t252;
  t4794 = t3061 * t252;
  t4796 = t3004 * t252;
  t4801 = t374 * t987 * t644;
  t4804 = t143 * t244 * t953;
  t4809 = -t4782 / 0.9e1 + 0.8e1 / 0.81e2 * t4784 - 0.88e2 / 0.81e2 * t955 * t59 * t896 * t1639 + t4790 / 0.48e2 - t966 * t662 / 0.12e2 + t4794 / 0.24e2 + t4796 / 0.48e2 - t978 * t662 / 0.12e2 + 0.2e1 / 0.27e2 * t4801 - 0.64e2 / 0.243e3 * t4804 * t959 + 0.7e1 / 0.18e2 * t1738 * t297;
  t4811 = t859 * t630;
  t4814 = t851 * t630;
  t4815 = t4814 * t157;
  t4819 = t1766 * t1733;
  t4821 = t855 * t630;
  t4822 = t4821 * t157;
  t4825 = t851 * t282 * t644;
  t4833 = t855 * t282 * t644;
  t4840 = -t4811 * t157 / 0.6e1 - t4815 / 0.9e1 + 0.7e1 / 0.36e2 * t382 * t1721 - 0.5e1 / 0.27e2 * t4819 + t4822 / 0.27e2 + 0.2e1 / 0.27e2 * t4825 - 0.5e1 / 0.9e1 * t1763 * t1733 + t859 * t282 * t644 / 0.9e1 - 0.2e1 / 0.81e2 * t4833 + 0.238e3 / 0.243e3 * t640 * t641 * t1029 + t3052 * t252 / 0.48e2;
  t4843 = t364 * t1759;
  t4847 = t143 * t1714 * t58;
  t4870 = t2998 * t252 / 0.16e2 - t4843 * t157 / 0.3e1 - t4847 * t157 / 0.6e1 + t3001 * t252 / 0.16e2 + t3008 * t252 / 0.48e2 - 0.5e1 / 0.9e1 * t1746 * t1733 + 0.2e1 / 0.9e1 * t364 * t987 * t644 + t143 * t2787 * t644 / 0.9e1 + 0.8e1 / 0.27e2 * t3038 * t1750 + 0.8e1 / 0.27e2 * t3049 * t1750 + 0.128e3 / 0.729e3 * t3022 * t59 * t4540 * t4543;
  t4875 = my_piecewise3(t1, 0, 0.128e3 / 0.2187e4 * t2853 * t4575 * sigma[0] * t43 * t134 + t2667 * t249 / 0.16e2 - t860 * t650 / 0.4e1 + 0.7e1 / 0.6e1 * t1672 * t392 - t4403 * t149 / 0.2e1 - t863 * t650 / 0.2e1 - t848 * t650 / 0.4e1 + 0.7e1 / 0.12e2 * t365 * t1655 + 0.7e1 / 0.6e1 * t1685 * t392 + 0.238e3 / 0.729e3 * t351 * t4524 * t352 - 0.35e2 / 0.162e3 * t153 * t156 * t4598 + 0.7e1 / 0.36e2 * t389 * t1721 + 0.7e1 / 0.18e2 * t1760 * t297 - t971 * t662 / 0.6e1 + 0.8e1 / 0.243e3 * t2822 * t1619 + 0.4e1 / 0.243e3 * t1040 * t1619 + 0.238e3 / 0.2187e4 * t359 * t4525 - 0.5e1 / 0.81e2 * t1056 * t1630 + 0.4e1 / 0.243e3 * t1053 * t1619 + t2695 * t647 / 0.27e2 + t2700 * t659 / 0.81e2 + t2744 * t659 / 0.162e3 + t2692 * t647 / 0.27e2 + t2755 * t659 / 0.81e2 + t2751 * t659 / 0.162e3 - 0.5e1 / 0.27e2 * t1053 * t1633 + t4870 + t4840 + t4809 - t4776 / 0.72e2 - t4778 / 0.18e2 - t4761 / 0.72e2 - t4763 / 0.18e2 + 0.7e1 / 0.108e3 * t4765 + t4759 / 0.54e2 + t4756 + t4732 + t4708 + 0.8e1 / 0.6561e4 * t4657 + t4653 + t4626 + t4416 / 0.16e2 + t4418 / 0.8e1 + t4447 + t4479 + t4511 + 0.4e1 / 0.729e3 * t4514 - 0.2e1 / 0.729e3 * t4520 - t4522 / 0.729e3 + 0.2e1 / 0.243e3 * t4528 + t4530 / 0.243e3 + t4571);
  tv4rho3sigma0 = t6 * t4875 + 0.3e1 * t1784;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4880 = t410 * t673;
  t4882 = t168 * t1792;
  t4887 = 0.5e1 / 0.36e2 * t74 * t911 * t265 * t100;
  t4890 = t3416 * t270;
  t4892 = t3419 * t270;
  t4895 = 0.5e1 / 0.216e3 * t3410 * t270;
  t4898 = t3358 * t273;
  t4900 = t3350 * t273;
  t4903 = 0.5e1 / 0.648e3 * t3354 * t273;
  t4904 = -0.3e1 / 0.8e1 * t1091 * t267 - 0.3e1 / 0.8e1 * t4880 + t4882 / 0.4e1 - t4887 + t3362 * t270 / 0.16e2 + t4890 / 0.16e2 - t4892 / 0.24e2 + t4895 + t3413 * t273 / 0.48e2 + t4898 / 0.48e2 - t4900 / 0.72e2 + t4903;
  t4905 = my_piecewise3(t65, 0, t4904);
  tv4rho3sigma2 = t6 * t4905 + 0.3e1 * t1808;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4907 = 0.2e1 * t1864;
  t4909 = t3121 * t249 / 0.24e2;
  t4911 = t3134 * t249 / 0.24e2;
  t4916 = t1112 * t626;
  t4918 = t4916 * t149 / 0.9e1;
  t4919 = t1108 * t626;
  t4922 = t439 * t1671;
  t4931 = t3131 * t249;
  t4934 = t1113 * t650 / 0.18e2;
  t4939 = t4909 + t4911 - t1109 * t650 / 0.6e1 - t1116 * t650 / 0.6e1 - t4918 - t4919 * t149 / 0.3e1 - t4922 * t149 / 0.3e1 + t3125 * t249 / 0.16e2 + t3128 * t249 / 0.8e1 + 0.7e1 / 0.18e2 * t1823 * t392 - t4931 / 0.72e2 - t4934 + 0.7e1 / 0.36e2 * t440 * t1655 + t4416 / 0.48e2 + t4418 / 0.24e2;
  t4955 = -t4423 / 0.36e2 + t3137 * t249 / 0.16e2 - t4425 / 0.18e2 + t4428 + t4429 / 0.27e2 + 0.7e1 / 0.108e3 * t4431 + 0.7e1 / 0.54e2 * t4437 - t4441 / 0.36e2 - t4443 / 0.18e2 + 0.2e1 / 0.27e2 * t4450 - t4453 / 0.9e1 - t4456 / 0.9e1 + t4470 / 0.48e2 - 0.4e1 / 0.2187e4 * t4489 - 0.8e1 / 0.2187e4 * t4492;
  t4957 = t439 * t1769;
  t4960 = t439 * t1773;
  t4963 = t439 * t1777;
  t4977 = t432 * t608 / 0.4e1;
  t4979 = t184 * t1699 / 0.4e1;
  t4982 = -0.8e1 / 0.243e3 * t4957 * t353 - 0.8e1 / 0.729e3 * t4960 * t347 - 0.4e1 / 0.729e3 * t4963 * t347 - 0.8e1 / 0.729e3 * t4507 + 0.8e1 / 0.2187e4 * t4509 + 0.4e1 / 0.2187e4 * t4514 - 0.4e1 / 0.2187e4 * t4520 - 0.2e1 / 0.2187e4 * t4522 + 0.2e1 / 0.729e3 * t4528 + t4530 / 0.729e3 - 0.5e1 / 0.729e3 * t4590 - 0.3e1 / 0.8e1 * t184 * t1716 - t4977 - t4979 - 0.3e1 / 0.8e1 * t1143 * t246;
  t4985 = t184 * t1689;
  t4993 = 0.2e1 / 0.729e3 * t3163 * t659;
  t4995 = t3166 * t659 / 0.729e3;
  t5008 = -0.3e1 / 0.4e1 * t432 * t623 + t4985 / 0.12e2 - t4595 + t4618 / 0.6e1 + t4622 / 0.6e1 - t4624 / 0.8e1 - t4627 / 0.4e1 - t4637 / 0.8e1 + t4993 + t4995 + 0.2e1 / 0.81e2 * t3189 * t647 + 0.2e1 / 0.243e3 * t3183 * t659 + t3169 * t659 / 0.243e3 + 0.2e1 / 0.81e2 * t3159 * t647 + 0.2e1 / 0.243e3 * t3186 * t659 + t3172 * t659 / 0.243e3;
  t5011 = t439 * t1625;
  t5015 = 0.2e1 / 0.243e3 * t3192 * t647;
  t5038 = -0.8e1 / 0.81e2 * t5011 * t290 + t5015 - 0.5e1 / 0.81e2 * t1179 * t1633 + 0.8e1 / 0.243e3 * t3241 * t1614 + 0.8e1 / 0.6561e4 * t4642 + 0.8e1 / 0.6561e4 * t4647 - 0.5e1 / 0.1458e4 * t4649 + 0.8e1 / 0.19683e5 * t4657 - 0.5e1 / 0.243e3 * t1182 * t1630 - 0.5e1 / 0.486e3 * t1185 * t1630 + 0.8e1 / 0.2187e4 * t3225 * t1640 + 0.8e1 / 0.2187e4 * t1182 * t1640 + 0.8e1 / 0.6561e4 * t1185 * t1640 + 0.8e1 / 0.729e3 * t3220 * t1619 + 0.4e1 / 0.729e3 * t1179 * t1619;
  t5053 = -0.4e1 / 0.729e3 * t4684 - 0.5e1 / 0.243e3 * t4686 + 0.8e1 / 0.729e3 * t4688 - 0.8e1 / 0.243e3 * t4691 + 0.2e1 / 0.243e3 * t4700 + 0.2e1 / 0.243e3 * t4714 + 0.2e1 / 0.729e3 * t4716 + t4718 / 0.729e3 + 0.7e1 / 0.162e3 * t4752 + t4755 + t4759 / 0.81e2 - t4761 / 0.108e3 - t4763 / 0.54e2 + 0.7e1 / 0.324e3 * t4765 - t4776 / 0.108e3;
  t5069 = t3341 * t252;
  t5072 = t1165 * t662 / 0.54e2;
  t5073 = -t4778 / 0.54e2 - t4782 / 0.27e2 + 0.8e1 / 0.243e3 * t4784 + t4790 / 0.144e3 + t4794 / 0.72e2 + t4796 / 0.144e3 + 0.2e1 / 0.81e2 * t4801 - t4815 / 0.27e2 - 0.5e1 / 0.81e2 * t4819 + 0.2e1 / 0.81e2 * t4822 + 0.2e1 / 0.81e2 * t4825 - 0.4e1 / 0.243e3 * t4833 + 0.7e1 / 0.108e3 * t443 * t1721 - t5069 / 0.216e3 - t5072;
  t5077 = t3335 * t252 / 0.72e2;
  t5083 = t3338 * t252 / 0.72e2;
  t5084 = t1112 * t630;
  t5086 = t5084 * t157 / 0.27e2;
  t5087 = t439 * t1759;
  t5092 = 0.2e1 / 0.81e2 * t1112 * t282 * t644;
  t5109 = t1108 * t630;
  t5112 = -t1162 * t662 / 0.18e2 + t5077 - t1168 * t662 / 0.18e2 + 0.7e1 / 0.54e2 * t1857 * t297 + t5083 - t5086 - t5087 * t157 / 0.9e1 + t5092 - 0.5e1 / 0.27e2 * t1843 * t1733 + 0.2e1 / 0.27e2 * t1108 * t282 * t644 + 0.2e1 / 0.27e2 * t439 * t987 * t644 + 0.8e1 / 0.81e2 * t3319 * t1750 + t3329 * t252 / 0.48e2 + t3332 * t252 / 0.24e2 + t3326 * t252 / 0.48e2 - t5109 * t157 / 0.9e1;
  t5116 = my_piecewise3(t1, 0, t4939 + t4955 + t4982 + t5008 + t5038 + t5053 + t5073 + t5112);
  tv4rho3sigma3 = t6 * t5116 + t1784 + t4907;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5118 = 0.2e1 * t1936;
  t5120 = t3572 * t270 / 0.24e2;
  t5122 = t3562 * t270 / 0.24e2;
  t5123 = t1226 * t713;
  t5133 = t1231 * t735 / 0.18e2;
  t5134 = t1230 * t713;
  t5136 = t5134 * t221 / 0.9e1;
  t5137 = t3557 * t270;
  t5139 = t1234 * t713;
  t5140 = t5139 * t221;
  t5142 = t3566 * t270;
  t5144 = t1235 * t735;
  t5146 = t5120 + t5122 - t5123 * t221 / 0.6e1 + t3551 * t270 / 0.16e2 + t3554 * t270 / 0.16e2 - t1227 * t735 / 0.12e2 - t5133 - t5136 - t5137 / 0.72e2 + t5140 / 0.27e2 - t5142 / 0.72e2 + t5144 / 0.54e2;
  t5150 = t461 * t673 / 0.4e1;
  t5152 = t168 * t1906 / 0.4e1;
  t5157 = t194 * t1792;
  t5161 = t74 * t369 * t708 * t100;
  t5165 = t3585 * t742;
  t5167 = t4890 / 0.48e2 - t4892 / 0.36e2 + t4895 - t5150 - t5152 - 0.3e1 / 0.8e1 * t1209 * t267 - 0.3e1 / 0.8e1 * t410 * t710 + t5157 / 0.12e2 + t5161 / 0.12e2 - t4880 / 0.8e1 + t4882 / 0.6e1 - t4887 - t5165 / 0.2187e4;
  t5169 = t3588 * t732;
  t5172 = 0.2e1 / 0.243e3 * t3603 * t732;
  t5173 = t3582 * t742;
  t5176 = 0.2e1 / 0.729e3 * t3578 * t742;
  t5178 = t3600 * t742 / 0.729e3;
  t5187 = t3678 * t273;
  t5189 = t1244 * t745;
  t5191 = -0.2e1 / 0.729e3 * t5169 + t5172 - 0.2e1 / 0.2187e4 * t5173 + t5176 + t5178 + t3591 * t732 / 0.81e2 + t3594 * t742 / 0.243e3 + t3597 * t742 / 0.486e3 + t4898 / 0.144e3 - t4900 / 0.108e3 + t4903 - t5187 / 0.216e3 + t5189 / 0.162e3;
  t5192 = t1234 * t717;
  t5193 = t5192 * t229;
  t5196 = t1234 * t528 * t729;
  t5198 = t1230 * t717;
  t5200 = t5198 * t229 / 0.27e2;
  t5201 = t3681 * t273;
  t5204 = t3692 * t273 / 0.72e2;
  t5206 = t3695 * t273 / 0.72e2;
  t5208 = t1241 * t745 / 0.54e2;
  t5211 = 0.2e1 / 0.81e2 * t1230 * t528 * t729;
  t5218 = t1226 * t717;
  t5224 = t5193 / 0.81e2 - 0.2e1 / 0.243e3 * t5196 - t5200 - t5201 / 0.216e3 + t5204 + t5206 - t5208 + t5211 + t3686 * t273 / 0.48e2 + t3689 * t273 / 0.48e2 - t1238 * t745 / 0.36e2 - t5218 * t229 / 0.18e2 + t1226 * t528 * t729 / 0.27e2;
  t5227 = my_piecewise3(t65, 0, t5146 + t5167 + t5191 + t5224);
  tv4rho3sigma5 = t6 * t5227 + t1808 + t5118;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5229 = t1272 * t626;
  t5236 = t3438 * t249;
  t5242 = -t5229 * t149 / 0.6e1 + t3434 * t249 / 0.16e2 + t3430 * t249 / 0.16e2 + t5236 / 0.48e2 - t1273 * t650 / 0.12e2 + t4909 + t4911 - t4918 - t4931 / 0.36e2 - t4934 - t4423 / 0.72e2 + t4428;
  t5252 = t503 * t608;
  t5256 = t4429 / 0.54e2 - t4441 / 0.72e2 + t4450 / 0.27e2 - 0.2e1 / 0.2187e4 * t4520 - t4522 / 0.2187e4 - 0.3e1 / 0.8e1 * t1265 * t246 - 0.3e1 / 0.8e1 * t503 * t623 - t5252 / 0.8e1 - t4977 - t4979 + t4985 / 0.6e1 - t4595 + t4618 / 0.12e2;
  t5266 = t3535 * t252;
  t5270 = t1272 * t630;
  t5279 = t4622 / 0.12e2 + t1272 * t282 * t644 / 0.27e2 + t3541 * t252 / 0.48e2 + t3538 * t252 / 0.48e2 + t5266 / 0.144e3 - t1276 * t662 / 0.36e2 - t5270 * t157 / 0.18e2 + t3455 * t659 / 0.243e3 + t3458 * t659 / 0.486e3 + t3451 * t647 / 0.81e2 + t4993 + t4995 + t5015;
  t5287 = -0.2e1 / 0.729e3 * t4684 + t4755 + t4759 / 0.162e3 - t4761 / 0.216e3 - t4776 / 0.216e3 + t4822 / 0.81e2 - 0.2e1 / 0.243e3 * t4833 - t5069 / 0.108e3 - t5072 + t5077 + t5083 - t5086 + t5092;
  t5290 = my_piecewise3(t1, 0, t5242 + t5256 + t5279 + t5287);
  tv4rho3sigma6 = t6 * t5290 + t1949 + t4907;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5292 = t1286 * t713;
  t5293 = t5292 * t221;
  t5295 = t477 * t1971;
  t5296 = t5295 * t221;
  t5298 = t1885 * t598;
  t5300 = t3762 * t270;
  t5302 = t3765 * t270;
  t5304 = t3768 * t270;
  t5306 = t473 * t1971;
  t5323 = t1298 * t713;
  t5326 = -t5293 / 0.9e1 - t5296 / 0.9e1 + 0.7e1 / 0.54e2 * t5298 + t5300 / 0.48e2 + t5302 / 0.24e2 + t5304 / 0.48e2 - t5306 * t221 / 0.3e1 + 0.7e1 / 0.36e2 * t474 * t1953 - t1299 * t735 / 0.6e1 - t1302 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t1892 * t598 + t3778 * t270 / 0.16e2 + t3781 * t270 / 0.8e1 + t3783 * t270 / 0.16e2 - t5323 * t221 / 0.3e1;
  t5327 = t1287 * t735;
  t5329 = t1290 * t735;
  t5331 = t478 * t1953;
  t5342 = -t5327 / 0.18e2 - t5329 / 0.18e2 + 0.7e1 / 0.108e3 * t5331 + t5120 + t5122 - t5133 - t5136 - t5137 / 0.36e2 + 0.2e1 / 0.27e2 * t5140 - t5142 / 0.36e2 + t5144 / 0.27e2 - t4892 / 0.72e2 + t4895 - 0.3e1 / 0.8e1 * t168 * t2065 - 0.3e1 / 0.8e1 * t1327 * t267;
  t5346 = t549 * t673;
  t5348 = t194 * t1906;
  t5352 = t74 * t117 * t2063 * t100;
  t5365 = t1298 * t717;
  t5370 = -0.3e1 / 0.4e1 * t461 * t710 - t5346 / 0.8e1 - t5348 / 0.4e1 - t5352 / 0.8e1 - t5150 - t5152 + t5157 / 0.6e1 + t5161 / 0.6e1 + t4882 / 0.12e2 - t4887 + 0.2e1 / 0.27e2 * t1298 * t528 * t729 + 0.2e1 / 0.27e2 * t473 * t1546 * t729 + 0.8e1 / 0.81e2 * t3982 * t2086 - t5365 * t229 / 0.9e1 - t1351 * t745 / 0.18e2;
  t5385 = t477 * t2092;
  t5386 = t5385 * t229;
  t5389 = t477 * t1546 * t729;
  t5391 = t3962 * t2086;
  t5393 = t1286 * t717;
  t5394 = t5393 * t229;
  t5396 = t3965 * t273;
  t5398 = t3968 * t273;
  t5400 = t3971 * t273;
  t5403 = t1286 * t528 * t729;
  t5405 = t1913 * t522;
  t5407 = -0.5e1 / 0.27e2 * t1921 * t2106 - t1348 * t745 / 0.18e2 + 0.7e1 / 0.54e2 * t1930 * t522 + t3985 * t273 / 0.48e2 + t3988 * t273 / 0.24e2 + 0.7e1 / 0.108e3 * t481 * t2101 + t3991 * t273 / 0.48e2 - t5386 / 0.27e2 + 0.2e1 / 0.81e2 * t5389 + 0.8e1 / 0.243e3 * t5391 - t5394 / 0.27e2 + t5396 / 0.144e3 + t5398 / 0.72e2 + t5400 / 0.144e3 + 0.2e1 / 0.81e2 * t5403 + 0.7e1 / 0.162e3 * t5405;
  t5410 = t1916 * t2106;
  t5412 = t1338 * t745;
  t5414 = t1341 * t745;
  t5416 = t484 * t2101;
  t5418 = t473 * t2092;
  t5421 = t1361 * t2018;
  t5423 = t1367 * t1988;
  t5425 = t3825 * t732;
  t5427 = t477 * t2014;
  t5428 = t5427 * t536;
  t5430 = t3839 * t742;
  t5432 = t3836 * t732;
  t5434 = t3871 * t1996;
  t5436 = t3866 * t2001;
  t5438 = t1367 * t2001;
  t5440 = t3842 * t742;
  t5442 = -0.5e1 / 0.81e2 * t5410 - t5412 / 0.54e2 - t5414 / 0.54e2 + 0.7e1 / 0.324e3 * t5416 - t5418 * t229 / 0.9e1 - 0.5e1 / 0.729e3 * t5421 - 0.5e1 / 0.243e3 * t5423 + 0.2e1 / 0.243e3 * t5425 - 0.8e1 / 0.243e3 * t5428 + 0.2e1 / 0.729e3 * t5430 + 0.2e1 / 0.243e3 * t5432 + 0.8e1 / 0.729e3 * t5434 + 0.8e1 / 0.2187e4 * t5436 + 0.4e1 / 0.2187e4 * t5438 + 0.2e1 / 0.729e3 * t5440;
  t5443 = t3833 * t742;
  t5445 = t1364 * t2018;
  t5447 = t1364 * t2026;
  t5449 = t3830 * t742;
  t5451 = t3859 * t2026;
  t5453 = t1361 * t2026;
  t5473 = t5443 / 0.729e3 - 0.5e1 / 0.1458e4 * t5445 + 0.8e1 / 0.19683e5 * t5447 + t5449 / 0.729e3 + 0.8e1 / 0.6561e4 * t5451 + 0.8e1 / 0.6561e4 * t5453 + 0.8e1 / 0.243e3 * t3894 * t1996 + 0.8e1 / 0.729e3 * t3897 * t2001 + 0.4e1 / 0.729e3 * t1370 * t2001 - 0.5e1 / 0.486e3 * t1376 * t2018 + 0.8e1 / 0.6561e4 * t1376 * t2026 + t3812 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t3809 * t742 + 0.8e1 / 0.2187e4 * t3881 * t2026 + 0.8e1 / 0.2187e4 * t1373 * t2026;
  t5485 = t473 * t2014;
  t5493 = t477 * t1975;
  t5494 = t5493 * t573;
  t5496 = t477 * t1979;
  t5497 = t5496 * t582;
  t5499 = -0.5e1 / 0.243e3 * t1373 * t2018 - 0.5e1 / 0.81e2 * t1370 * t1988 + 0.2e1 / 0.243e3 * t3804 * t742 + 0.2e1 / 0.81e2 * t3818 * t732 + 0.2e1 / 0.81e2 * t3795 * t732 - 0.8e1 / 0.81e2 * t5485 * t536 + t3815 * t742 / 0.243e3 - 0.2e1 / 0.2187e4 * t5165 - 0.4e1 / 0.729e3 * t5169 + t5172 - 0.4e1 / 0.2187e4 * t5173 + t5176 + t5178 - 0.8e1 / 0.729e3 * t5494 - 0.8e1 / 0.2187e4 * t5497;
  t5500 = t473 * t1979;
  t5503 = t473 * t1983;
  t5506 = t473 * t1975;
  t5509 = t477 * t1983;
  t5510 = t5509 * t582;
  t5518 = -0.8e1 / 0.729e3 * t5500 * t582 - 0.4e1 / 0.729e3 * t5503 * t582 - 0.8e1 / 0.243e3 * t5506 * t573 - 0.4e1 / 0.2187e4 * t5510 - t4900 / 0.216e3 + t4903 - t5187 / 0.108e3 + t5189 / 0.81e2 + 0.2e1 / 0.81e2 * t5193 - 0.4e1 / 0.243e3 * t5196 - t5200 - t5201 / 0.108e3 + t5204 + t5206 - t5208 + t5211;
  t5522 = my_piecewise3(t65, 0, t5326 + t5342 + t5370 + t5407 + t5442 + t5473 + t5499 + t5518);
  tv4rho3sigma8 = t6 * t5522 + t2114 + t5118;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5537 = -0.3e1 / 0.8e1 * t1398 * t246 - 0.3e1 / 0.8e1 * t5252 + t4985 / 0.4e1 - t4595 + t3737 * t249 / 0.16e2 + t5236 / 0.16e2 - t4931 / 0.24e2 + t4428 + t3740 * t252 / 0.48e2 + t5266 / 0.48e2 - t5069 / 0.72e2 + t4755;
  t5538 = my_piecewise3(t1, 0, t5537);
  tv4rho3sigma9 = t6 * t5538 + 0.3e1 * t1949;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5555 = t30 * t1451;
  t5558 = t260 * t1423;
  t5559 = t5558 * t206;
  t5569 = 0.1e1 / t77 / t4143;
  t5590 = t5140 / 0.9e1 - t5142 / 0.24e2 + t5144 / 0.18e2 + t4895 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t5555 - 0.14e3 / 0.729e3 * t130 * t5559 + 0.952e3 / 0.6561e4 * t330 * t5555 * t561 - 0.704e3 / 0.19683e5 * t893 * t1464 * t2060 + 0.256e3 / 0.531441e6 * t2986 * t5569 * t4184 * sigma[2] * t41 * t43) * t100 - 0.3e1 / 0.8e1 * t1441 * t267 - 0.9e1 / 0.8e1 * t549 * t710 - 0.9e1 / 0.8e1 * t194 * t2065 - 0.3e1 / 0.8e1 * t5346 - 0.3e1 / 0.4e1 * t5348 - 0.3e1 / 0.8e1 * t5352;
  t5612 = t5157 / 0.4e1 + t5161 / 0.4e1 - t4887 + 0.7e1 / 0.36e2 * t591 * t2101 + 0.7e1 / 0.36e2 * t595 * t2101 - t1497 * t745 / 0.6e1 - t1501 * t745 / 0.12e2 - 0.5e1 / 0.9e1 * t2079 * t2106 - 0.5e1 / 0.9e1 * t2082 * t2106 - 0.88e2 / 0.81e2 * t1487 * t99 * t1464 * t2025 - t1494 * t745 / 0.12e2;
  t5618 = t215 * t265 * t1485;
  t5636 = M_PI * sigma[2] * t43;
  t5640 = t1412 * t717;
  t5643 = t509 * t2092;
  t5646 = 0.7e1 / 0.18e2 * t2089 * t522 + 0.7e1 / 0.18e2 * t2093 * t522 - 0.64e2 / 0.243e3 * t5618 * t1491 - 0.35e2 / 0.81e2 * t718 * t1509 + 0.238e3 / 0.243e3 * t725 * t726 * t1552 - 0.35e2 / 0.162e3 * t225 * t228 * t5559 + t215 * t4207 * t729 / 0.9e1 + 0.8e1 / 0.27e2 * t4386 * t2086 + 0.128e3 / 0.729e3 * t4354 * t99 * t5569 * t5636 - t5640 * t229 / 0.6e1 - t5643 * t229 / 0.3e1;
  t5650 = t215 * t2063 * t98;
  t5683 = 0.8e1 / 0.81e2 * t5391 - t5394 / 0.9e1 + t5396 / 0.48e2 + t5398 / 0.24e2 + t5400 / 0.48e2 + 0.2e1 / 0.27e2 * t5403 + 0.7e1 / 0.54e2 * t5405 - 0.5e1 / 0.27e2 * t5410 - t5412 / 0.18e2 - t5414 / 0.18e2 + 0.7e1 / 0.108e3 * t5416;
  t5687 = t1489 * t2000;
  t5690 = t1467 * t2025;
  t5698 = t5569 * t1466 * t5636;
  t5702 = t5569 * t4184 * t5636;
  t5713 = 0.56e2 / 0.81e2 * t2015 * t1553 - 0.88e2 / 0.729e3 * t1522 * t5687 - 0.88e2 / 0.2187e4 * t579 * t5690 - 0.88e2 / 0.2187e4 * t1532 * t5690 + 0.8e1 / 0.729e3 * t4157 * t2026 + 0.128e3 / 0.19683e5 * t4243 * t5698 + 0.128e3 / 0.59049e5 * t4182 * t5702 + 0.64e2 / 0.19683e5 * t1532 * t5702 + 0.8e1 / 0.729e3 * t1556 * t2026 + 0.8e1 / 0.729e3 * t1560 * t2026 + 0.128e3 / 0.19683e5 * t1522 * t5698;
  t5727 = t5555 * t581;
  t5738 = 0.352e3 / 0.177147e6 * t579 * t5702 + 0.238e3 / 0.729e3 * t571 * t5555 * t572 + t4106 * t742 / 0.81e2 + 0.8e1 / 0.243e3 * t4239 * t2001 + t4096 * t742 / 0.162e3 + 0.4e1 / 0.243e3 * t1574 * t2001 + 0.238e3 / 0.2187e4 * t579 * t5727 + 0.119e3 / 0.2187e4 * t586 * t5727 - 0.5e1 / 0.162e3 * t1563 * t2018 - 0.5e1 / 0.162e3 * t1567 * t2018 - 0.44e2 / 0.729e3 * t571 * t5687;
  t5763 = t509 * t2014;
  t5766 = t708 * t527;
  t5768 = t215 * t5766 * t99;
  t5772 = t215 * t2013 * t227;
  t5792 = -0.8e1 / 0.27e2 * t5763 * t536 - 0.8e1 / 0.27e2 * t5768 * t536 - 0.64e2 / 0.729e3 * t5772 * t1518 - 0.5e1 / 0.27e2 * t1570 * t1988 - 0.5e1 / 0.81e2 * t1556 * t2018 + t4099 * t742 / 0.81e2 + t4125 * t732 / 0.27e2 + 0.2e1 / 0.27e2 * t4073 * t732 - 0.88e2 / 0.243e3 * t1515 * t1489 * t1995 + 0.8e1 / 0.81e2 * t4212 * t1996 + 0.8e1 / 0.81e2 * t4216 * t1996;
  t5794 = t5569 * M_PI;
  t5802 = t5794 * sigma[2] * t561 * t43;
  t5816 = t215 * t713 * t577;
  t5822 = t215 * t717 * t1530;
  t5827 = 0.128e3 / 0.2187e4 * t4220 * t5794 * sigma[2] * t206 * t43 + 0.128e3 / 0.6561e4 * t4227 * t5802 + 0.64e2 / 0.6561e4 * t1515 * t5802 + 0.8e1 / 0.243e3 * t4235 * t2001 - 0.5e1 / 0.27e2 * t1574 * t1988 - 0.5e1 / 0.81e2 * t1560 * t2018 + 0.2e1 / 0.81e2 * t4102 * t742 - 0.64e2 / 0.2187e4 * t5816 * t1524 - 0.32e2 / 0.2187e4 * t1976 * t1524 - 0.64e2 / 0.6561e4 * t5822 * t1535 - 0.64e2 / 0.6561e4 * t1980 * t1535;
  t5840 = -0.64e2 / 0.19683e5 * t1984 * t1535 - 0.5e1 / 0.243e3 * t5421 - 0.5e1 / 0.81e2 * t5423 + 0.2e1 / 0.81e2 * t5425 - 0.8e1 / 0.81e2 * t5428 + 0.2e1 / 0.243e3 * t5430 + 0.2e1 / 0.81e2 * t5432 + 0.8e1 / 0.243e3 * t5434 + 0.8e1 / 0.729e3 * t5436 + 0.4e1 / 0.729e3 * t5438 + 0.2e1 / 0.243e3 * t5440;
  t5852 = t509 * t1975;
  t5856 = t509 * t1979;
  t5859 = t509 * t1983;
  t5863 = t215 * t1971 * t227;
  t5867 = t215 * t2092 * t577;
  t5871 = t215 * t2092 * t227;
  t5883 = -0.8e1 / 0.243e3 * t5856 * t582 - 0.4e1 / 0.243e3 * t5859 * t582 - 0.8e1 / 0.81e2 * t5863 * t573 - 0.8e1 / 0.243e3 * t5867 * t582 - 0.4e1 / 0.243e3 * t5871 * t582 + 0.56e2 / 0.243e3 * t1976 * t1577 + 0.56e2 / 0.729e3 * t1980 * t1580 + 0.28e2 / 0.729e3 * t1984 * t1580 - 0.8e1 / 0.243e3 * t5494 - 0.8e1 / 0.729e3 * t5497 - 0.4e1 / 0.729e3 * t5510;
  t5896 = t1412 * t713;
  t5899 = t509 * t1971;
  t5902 = t215 * t2063 * t217;
  t5911 = -0.35e2 / 0.27e2 * t714 * t1425 - 0.35e2 / 0.54e2 * t219 * t220 * t5558 + 0.3e1 / 0.16e2 * t4042 * t270 + 0.3e1 / 0.16e2 * t4045 * t270 + t4049 * t270 / 0.16e2 - t5896 * t221 / 0.2e1 - t5899 * t221 - t5902 * t221 / 0.2e1 + 0.7e1 / 0.12e2 * t510 * t1953 + 0.7e1 / 0.12e2 * t514 * t1953 - t1413 * t735 / 0.4e1;
  t5927 = -t1416 * t735 / 0.2e1 - t1419 * t735 / 0.4e1 + 0.7e1 / 0.6e1 * t1968 * t598 + 0.7e1 / 0.6e1 * t1972 * t598 + t4039 * t270 / 0.16e2 + t4903 - t5187 / 0.72e2 + t5189 / 0.54e2 + t5193 / 0.27e2 - 0.2e1 / 0.81e2 * t5196 - t5201 / 0.72e2;
  t5932 = my_piecewise3(t65, 0, 0.128e3 / 0.59049e5 * t571 * t5698 + 0.32e2 / 0.59049e5 * t586 * t5702 + t4111 * t742 / 0.162e3 + t4092 * t742 / 0.81e2 + 0.4e1 / 0.243e3 * t1570 * t2001 + 0.8e1 / 0.729e3 * t4153 * t2026 + t4077 * t732 / 0.27e2 - 0.8e1 / 0.81e2 * t5852 * t573 - t5650 * t229 / 0.6e1 + t4364 * t273 / 0.48e2 + t4367 * t273 / 0.16e2 + t4370 * t273 / 0.16e2 + t4374 * t273 / 0.48e2 + 0.8e1 / 0.27e2 * t4382 * t2086 - 0.88e2 / 0.6561e4 * t586 * t5690 + 0.8e1 / 0.2187e4 * t1563 * t2026 + 0.8e1 / 0.2187e4 * t1567 * t2026 + 0.7e1 / 0.36e2 * t5331 + t5840 + t5827 - 0.2e1 / 0.729e3 * t5173 + t5792 - 0.2e1 / 0.243e3 * t5169 - t5165 / 0.729e3 + t5738 - t5137 / 0.24e2 + t5713 + t5683 + t5302 / 0.8e1 + t5304 / 0.16e2 + t5927 + t5911 + t5883 + t5646 + t5612 + 0.7e1 / 0.18e2 * t5298 + t5300 / 0.16e2 + t5590 - t5293 / 0.3e1 - t5296 / 0.3e1 + 0.2e1 / 0.27e2 * t5389 + t5443 / 0.243e3 - 0.5e1 / 0.486e3 * t5445 + 0.8e1 / 0.6561e4 * t5447 + t5449 / 0.243e3 + 0.8e1 / 0.2187e4 * t5451 + 0.8e1 / 0.2187e4 * t5453 - t5386 / 0.9e1 - t5327 / 0.6e1 - t5329 / 0.6e1 + t1412 * t528 * t729 / 0.9e1 + 0.2e1 / 0.9e1 * t509 * t1546 * t729);
  tv4rho3sigma11 = t6 * t5932 + 0.3e1 * t2114;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5938 = t26 * t369 * t764 * t60 / 0.12e2;
  t5939 = t113 * t2201;
  t5943 = t26 * t117 * t2218 * t60;
  t5949 = t754 * t294;
  t5950 = t5949 * t134;
  t5960 = 0.1e1 / t33 / t895;
  t5977 = t4506 * t647;
  t5979 = t4491 * t659;
  t5981 = t4488 * t659;
  t5997 = t5938 - t5939 / 0.4e1 - t5943 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t766 - 0.3e1 / 0.4e1 * t113 * t2220 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.7e1 / 0.243e3 * t130 * t5950 - 0.14e2 / 0.2187e4 * t331 * t759 * t287 * t334 + 0.152e3 / 0.19683e5 * t2214 * t1638 - 0.32e2 / 0.177147e6 * t2986 * t5960 * t2990) * t60 - t2759 * t776 / 0.72e2 - t2762 * t776 / 0.36e2 - 0.2e1 / 0.2187e4 * t1033 * t2173 - 0.2e1 / 0.2187e4 * t1037 * t2173 + 0.4e1 / 0.243e3 * t5977 + 0.4e1 / 0.729e3 * t5979 + 0.2e1 / 0.729e3 * t5981 - 0.2e1 / 0.729e3 * t1056 * t2173 - 0.2e1 / 0.729e3 * t1060 * t2173 - 0.2e1 / 0.729e3 * t2836 * t2173 - 0.2e1 / 0.729e3 * t2840 * t2173 + 0.4e1 / 0.81e2 * t4472 * t647 + 0.4e1 / 0.81e2 * t4476 * t647 + 0.16e2 / 0.243e3 * t4584 * t1614;
  t6022 = t239 * t1610;
  t6026 = t2792 * t776;
  t6028 = t1043 * t2173;
  t6030 = t6022 * t1005;
  t6033 = t1049 * t2173;
  t6037 = t764 * t281;
  t6039 = t143 * t6037 * t59;
  t6042 = t1025 * t2168;
  t6044 = -0.1e2 / 0.81e2 * t1770 * t1633 - 0.1e2 / 0.243e3 * t1774 * t1630 - 0.5e1 / 0.243e3 * t1778 * t1630 + 0.4e1 / 0.243e3 * t4494 * t659 + 0.4e1 / 0.243e3 * t4481 * t659 + 0.16e2 / 0.729e3 * t4560 * t1619 + 0.16e2 / 0.2187e4 * t4566 * t1640 + 0.16e2 / 0.2187e4 * t1774 * t1640 + 0.2e1 / 0.243e3 * t4497 * t659 + 0.2e1 / 0.243e3 * t4485 * t659 + 0.8e1 / 0.729e3 * t1770 * t1619 + 0.16e2 / 0.6561e4 * t1778 * t1640 + 0.19e2 / 0.243e3 * t993 * t6022 * t995 - t6026 / 0.108e3 - 0.2e1 / 0.6561e4 * t6028 + 0.19e2 / 0.6561e4 * t344 * t6030 - 0.2e1 / 0.2187e4 * t6033 + 0.19e2 / 0.2187e4 * t359 * t6030 - 0.8e1 / 0.81e2 * t6039 * t290 + t6042 / 0.81e2;
  t6064 = t2874 * t776 / 0.324e3;
  t6065 = t2781 * t2191;
  t6067 = t6022 * t1000;
  t6070 = t1046 * t2191;
  t6074 = t2784 * t2173;
  t6080 = t2765 * t776;
  t6084 = t2778 * t2188;
  t6088 = -0.7e1 / 0.162e3 * t284 * t773 * t289 - 0.2e1 / 0.81e2 * t2849 * t2188 - t2789 * t776 / 0.72e2 - 0.2e1 / 0.81e2 * t2769 * t2188 - 0.2e1 / 0.243e3 * t2822 * t2191 - 0.2e1 / 0.243e3 * t2826 * t2191 - t1040 * t2191 / 0.243e3 - t1053 * t2191 / 0.243e3 + t6064 - 0.2e1 / 0.729e3 * t6065 + 0.19e2 / 0.729e3 * t1012 * t6067 - t6070 / 0.729e3 + 0.19e2 / 0.1458e4 * t351 * t6067 - 0.2e1 / 0.2187e4 * t6074 + 0.19e2 / 0.2187e4 * t1018 * t6030 + t1021 * t2168 / 0.27e2 - t6080 / 0.108e3 + t989 * t2168 / 0.27e2 - 0.2e1 / 0.243e3 * t6084 + t382 * t2225 / 0.36e2;
  t6091 = t155 * t5960;
  t6098 = t4814 * t252;
  t6100 = t4781 * t252;
  t6109 = t357 * t5960;
  t6116 = t1016 * t5960;
  t6141 = t981 * t789;
  t6143 = t974 * t789;
  t6145 = t389 * t2225 / 0.36e2 - 0.16e2 / 0.19683e5 * t147 * t6091 * t2832 - 0.4e1 / 0.19683e5 * t153 * t6091 * t2807 + t6098 / 0.36e2 + t6100 / 0.36e2 - 0.2e1 / 0.27e2 * t3049 * t2242 - 0.2e1 / 0.27e2 * t3038 * t2242 - 0.16e2 / 0.729e3 * t955 * t6091 * t2855 - 0.16e2 / 0.2187e4 * t640 * t6109 * t2862 - 0.8e1 / 0.2187e4 * t640 * t6091 * t2862 - 0.16e2 / 0.6561e4 * t147 * t6116 * t2832 - 0.16e2 / 0.19683e5 * t153 * t2844 * t5960 * t2807 - 0.1e2 / 0.27e2 * t2232 * t1733 + 0.4e1 / 0.27e2 * t364 * t1624 * t644 + 0.4e1 / 0.27e2 * t143 * t4693 * t644 - 0.16e2 / 0.6561e4 * t147 * t6109 * t2832 - 0.8e1 / 0.6561e4 * t153 * t6116 * t2807 - 0.44e2 / 0.59049e5 * t153 * t6109 * t2807 - t6141 / 0.144e3 - t6143 / 0.144e3;
  t6149 = t4821 * t252 / 0.108e3;
  t6150 = t1741 * t662;
  t6153 = t984 * t789 / 0.432e3;
  t6156 = t364 * t2249;
  t6160 = t143 * t2218 * t58;
  t6179 = t374 * t2249;
  t6180 = t6179 * t157;
  t6184 = t3011 * t2242;
  t6191 = t374 * t1624 * t644;
  t6195 = -t6149 - t6150 / 0.27e2 + t6153 - t978 * t789 / 0.96e2 - t6156 * t157 / 0.9e1 - t6160 * t157 / 0.9e1 + 0.16e2 / 0.81e2 * t4804 * t1750 + t4811 * t252 / 0.24e2 + t4843 * t252 / 0.12e2 + t4847 * t252 / 0.24e2 - t966 * t789 / 0.96e2 - t971 * t789 / 0.48e2 - t1738 * t662 / 0.9e1 - t1760 * t662 / 0.9e1 - t6180 / 0.27e2 + 0.7e1 / 0.54e2 * t2250 * t297 - 0.2e1 / 0.81e2 * t6184 + 0.19e2 / 0.81e2 * t955 * t2239 * t1611 * t28 + 0.4e1 / 0.81e2 * t6191 + 0.7e1 / 0.54e2 * t631 * t1721;
  t6196 = t385 * t2225;
  t6202 = t2670 * t786 / 0.2916e4;
  t6204 = t2681 * t786 / 0.5832e4;
  t6206 = t2686 * t780 / 0.972e3;
  t6207 = t1049 * t2147;
  t6209 = t1043 * t2147;
  t6211 = t773 * t287;
  t6215 = t6211 * t346;
  t6220 = t1046 * t2141;
  t6231 = t143 * t2126 * t155;
  t6240 = t2737 * t786;
  t6242 = t6196 / 0.108e3 - 0.7e1 / 0.216e3 * t153 * t156 * t5950 + t6202 + t6204 + t6206 + t6207 / 0.729e3 + t6209 / 0.1458e4 - 0.7e1 / 0.486e3 * t351 * t6211 * t352 - 0.7e1 / 0.1458e4 * t359 * t6215 - 0.7e1 / 0.2916e4 * t344 * t6215 + t6220 / 0.243e3 + t1033 * t2147 / 0.486e3 + t1053 * t2141 / 0.81e2 + t1060 * t2147 / 0.243e3 + t1037 * t2147 / 0.486e3 - 0.8e1 / 0.243e3 * t6231 * t353 - t2700 * t786 / 0.648e3 - t2705 * t786 / 0.324e3 - t2755 * t786 / 0.648e3 - t6240 / 0.972e3;
  t6251 = t143 * t2249 * t357;
  t6255 = t143 * t2249 * t155;
  t6258 = t2722 * t786;
  t6260 = t2725 * t786;
  t6262 = t2728 * t780;
  t6264 = t2731 * t780;
  t6266 = t2734 * t786;
  t6279 = t4449 * t249 / 0.36e2;
  t6280 = t374 * t2126;
  t6281 = t6280 * t149;
  t6286 = t856 * t783 / 0.144e3;
  t6287 = t375 * t2121;
  t6289 = -t2744 * t786 / 0.1296e4 - t2747 * t786 / 0.648e3 - t2751 * t786 / 0.1296e4 - 0.8e1 / 0.729e3 * t6251 * t347 - 0.4e1 / 0.729e3 * t6255 * t347 - t6258 / 0.1944e4 - t6260 / 0.1944e4 - t6262 / 0.324e3 - t6264 / 0.324e3 - t6266 / 0.972e3 + t1040 * t2141 / 0.81e2 + t1056 * t2147 / 0.243e3 - t2695 * t780 / 0.216e3 - t2719 * t780 / 0.108e3 - t2692 * t780 / 0.216e3 - t6279 - t6281 / 0.9e1 + 0.7e1 / 0.18e2 * t2127 * t392 + t6286 + t6287 / 0.36e2;
  t6293 = t1668 * t650;
  t6302 = M_PI * t43;
  t6306 = t852 * t783;
  t6308 = t865 * t783;
  t6314 = t4452 * t249;
  t6316 = t4455 * t249;
  t6318 = t364 * t2126;
  t6322 = t143 * t2218 * t145;
  t6337 = -0.7e1 / 0.72e2 * t147 * t148 * t5949 - t6293 / 0.9e1 + 0.7e1 / 0.18e2 * t627 * t1655 - t1685 * t650 / 0.3e1 - t1672 * t650 / 0.3e1 - 0.16e2 / 0.243e3 * t3022 * t59 * t5960 * t6302 - t6306 / 0.48e2 - t6308 / 0.48e2 + t365 * t2121 / 0.12e2 + t379 * t2121 / 0.12e2 + t6314 / 0.12e2 + t6316 / 0.12e2 - t6318 * t149 / 0.3e1 - t6322 * t149 / 0.3e1 + t4403 * t249 / 0.8e1 + t4458 * t249 / 0.4e1 + t4461 * t249 / 0.8e1 - t860 * t783 / 0.32e2 - t863 * t783 / 0.16e2 - t848 * t783 / 0.32e2;
  t6341 = my_piecewise3(t1, 0, t5997 + t6044 + t6088 + t6145 + t6195 + t6242 + t6289 + t6337);
  tv4rho2sigma20 = t6 * t6341 + 0.2e1 * t2256;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6344 = t168 * t2261;
  t6349 = t74 * t369 * t807 * t100 / 0.12e2;
  t6354 = t3609 * t819;
  t6357 = t3612 * t819 / 0.324e3;
  t6358 = t1241 * t832;
  t6361 = t1244 * t832 / 0.432e3;
  t6362 = t5198 * t273;
  t6365 = t5192 * t273 / 0.108e3;
  t6372 = -t6344 / 0.4e1 + t6349 - 0.3e1 / 0.8e1 * t410 * t809 - t3606 * t819 / 0.72e2 - t6354 / 0.108e3 + t6357 - t6358 / 0.144e3 + t6361 + t6362 / 0.36e2 - t6365 - t1238 * t832 / 0.96e2 + t5218 * t273 / 0.24e2 - t3591 * t823 / 0.216e3;
  t6378 = t3585 * t829 / 0.5832e4;
  t6380 = t3582 * t829 / 0.2916e4;
  t6381 = t3600 * t829;
  t6383 = t3603 * t823;
  t6386 = t3588 * t823 / 0.972e3;
  t6387 = t3578 * t829;
  t6390 = t1235 * t826 / 0.144e3;
  t6391 = t5134 * t270;
  t6394 = t5139 * t270 / 0.36e2;
  t6395 = t1231 * t826;
  t6401 = -t3594 * t829 / 0.648e3 - t3597 * t829 / 0.1296e4 + t6378 + t6380 - t6381 / 0.1944e4 - t6383 / 0.324e3 + t6386 - t6387 / 0.972e3 + t6390 + t6391 / 0.12e2 - t6394 - t6395 / 0.48e2 + t5123 * t270 / 0.8e1 - t1227 * t826 / 0.32e2;
  t6403 = my_piecewise3(t65, 0, t6372 + t6401);
  tv4rho2sigma25 = t6 * t6403 + 0.2e1 * t2297;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6405 = t184 * t2201;
  t6425 = -t6405 / 0.8e1 - 0.3e1 / 0.8e1 * t432 * t766 - 0.3e1 / 0.8e1 * t184 * t2220 + t5938 - t5939 / 0.8e1 - t5943 / 0.8e1 - t3232 * t776 / 0.72e2 - t3238 * t776 / 0.72e2 - t3241 * t2188 / 0.81e2 - t3220 * t2191 / 0.243e3 - t1179 * t2191 / 0.486e3 - t3225 * t2173 / 0.729e3;
  t6430 = t3235 * t776;
  t6445 = -t1182 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t4957 * t647 - t6430 / 0.216e3 + t1175 * t2168 / 0.54e2 - t1185 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t4960 * t659 + t4963 * t659 / 0.243e3 + 0.2e1 / 0.243e3 * t5977 + 0.2e1 / 0.729e3 * t5979 + t5981 / 0.729e3 - t6026 / 0.216e3 - t6028 / 0.6561e4;
  t6463 = -t6033 / 0.2187e4 + t6042 / 0.162e3 + t6064 - t6065 / 0.729e3 - t6070 / 0.1458e4 - t6074 / 0.2187e4 - t6080 / 0.216e3 - t6084 / 0.243e3 + 0.2e1 / 0.27e2 * t439 * t1624 * t644 + t5109 * t252 / 0.24e2 + t5087 * t252 / 0.24e2 - t3319 * t2242 / 0.27e2;
  t6468 = t439 * t2249;
  t6475 = t1165 * t789;
  t6477 = t5084 * t252;
  t6483 = -t1162 * t789 / 0.96e2 - t1168 * t789 / 0.96e2 - t6468 * t157 / 0.18e2 + t443 * t2225 / 0.72e2 - t1857 * t662 / 0.18e2 - t6475 / 0.288e3 + t6477 / 0.72e2 + t6098 / 0.72e2 + t6100 / 0.72e2 - t6141 / 0.288e3 - t6143 / 0.288e3 - t6149;
  t6493 = t3163 * t786;
  t6497 = t3166 * t786;
  t6499 = t3192 * t780;
  t6503 = -t6150 / 0.54e2 + t6153 - t6180 / 0.54e2 - t6184 / 0.81e2 + 0.2e1 / 0.81e2 * t6191 + t6196 / 0.216e3 + t1179 * t2141 / 0.162e3 - t6493 / 0.1944e4 + t1182 * t2147 / 0.486e3 - t6497 / 0.3888e4 - t6499 / 0.648e3 + t1185 * t2147 / 0.972e3;
  t6519 = -t3169 * t786 / 0.1296e4 - t3172 * t786 / 0.1296e4 - t3189 * t780 / 0.216e3 - t3159 * t780 / 0.216e3 - t3183 * t786 / 0.648e3 - t3186 * t786 / 0.648e3 + t6202 + t6204 + t6206 + t6207 / 0.1458e4 + t6209 / 0.2916e4 + t6220 / 0.486e3;
  t6531 = -t6240 / 0.1944e4 - t6258 / 0.3888e4 - t6260 / 0.3888e4 - t6262 / 0.648e3 - t6264 / 0.648e3 - t6266 / 0.1944e4 - t6279 - t6281 / 0.18e2 + t6286 + t6287 / 0.72e2 - t6293 / 0.18e2 - t6306 / 0.96e2;
  t6537 = t1113 * t783;
  t6541 = t4916 * t249;
  t6547 = t439 * t2126;
  t6554 = -t6308 / 0.96e2 + t6314 / 0.24e2 + t6316 / 0.24e2 - t1823 * t650 / 0.6e1 - t6537 / 0.96e2 + t440 * t2121 / 0.24e2 + t6541 / 0.24e2 - t1109 * t783 / 0.32e2 - t1116 * t783 / 0.32e2 - t6547 * t149 / 0.6e1 + t4919 * t249 / 0.8e1 + t4922 * t249 / 0.8e1;
  t6558 = my_piecewise3(t1, 0, t6425 + t6445 + t6463 + t6483 + t6503 + t6519 + t6531 + t6554);
  tv4rho2sigma26 = t6 * t6558 + t2256 + t2318;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6564 = t194 * t2261;
  t6568 = t74 * t117 * t2403 * t100;
  t6583 = -0.3e1 / 0.8e1 * t168 * t2405 - 0.3e1 / 0.8e1 * t461 * t809 - t6564 / 0.8e1 - t6568 / 0.8e1 - t6344 / 0.8e1 + t6349 + 0.2e1 / 0.243e3 * t5500 * t742 + t5503 * t742 / 0.243e3 - t3888 * t819 / 0.72e2 - t3891 * t819 / 0.72e2 - t3894 * t2370 / 0.81e2 - t3897 * t2373 / 0.243e3;
  t6596 = t3866 * t2373;
  t6598 = t1367 * t2373;
  t6600 = t5509 * t742;
  t6602 = t3851 * t819;
  t6604 = t3854 * t819;
  t6606 = t5493 * t732;
  t6608 = -t1370 * t2373 / 0.486e3 - t1373 * t2381 / 0.729e3 - t1376 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t5506 * t732 + t1358 * t2378 / 0.54e2 - t3881 * t2381 / 0.729e3 - t6596 / 0.729e3 - t6598 / 0.1458e4 + t6600 / 0.729e3 - t6602 / 0.216e3 - t6604 / 0.216e3 + 0.2e1 / 0.243e3 * t6606;
  t6610 = t5496 * t742;
  t6612 = t3859 * t2381;
  t6614 = t1361 * t2381;
  t6616 = t1364 * t2381;
  t6618 = t1355 * t2378;
  t6620 = t3871 * t2370;
  t6627 = t473 * t2416;
  t6633 = 0.2e1 / 0.729e3 * t6610 - t6612 / 0.2187e4 - t6614 / 0.2187e4 - t6616 / 0.6561e4 + t6618 / 0.162e3 - t6620 / 0.243e3 - t6354 / 0.216e3 + t6357 + t481 * t2411 / 0.72e2 - t1930 * t745 / 0.18e2 - t6627 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t473 * t2013 * t729;
  t6635 = t477 * t2013 * t729;
  t6637 = t5393 * t273;
  t6639 = t5385 * t273;
  t6641 = t477 * t2416;
  t6642 = t6641 * t229;
  t6644 = t484 * t2411;
  t6646 = t1913 * t745;
  t6648 = t3962 * t2430;
  t6650 = t1338 * t832;
  t6652 = t1341 * t832;
  t6660 = 0.2e1 / 0.81e2 * t6635 + t6637 / 0.72e2 + t6639 / 0.72e2 - t6642 / 0.54e2 + t6644 / 0.216e3 - t6646 / 0.54e2 - t6648 / 0.81e2 - t6650 / 0.288e3 - t6652 / 0.288e3 + t5365 * t273 / 0.24e2 + t5418 * t273 / 0.24e2 - t3982 * t2430 / 0.27e2;
  t6669 = t1367 * t2339;
  t6671 = t1361 * t2342;
  t6673 = t3842 * t829;
  t6675 = t3825 * t823;
  t6677 = t3839 * t829;
  t6679 = t3833 * t829;
  t6681 = -t1348 * t832 / 0.96e2 - t1351 * t832 / 0.96e2 - t6358 / 0.288e3 + t6361 + t6362 / 0.72e2 - t6365 + t6669 / 0.486e3 + t6671 / 0.1458e4 - t6673 / 0.1944e4 - t6675 / 0.648e3 - t6677 / 0.1944e4 - t6679 / 0.3888e4;
  t6682 = t3836 * t823;
  t6684 = t1364 * t2342;
  t6686 = t3830 * t829;
  t6706 = -t6682 / 0.648e3 + t6684 / 0.2916e4 - t6686 / 0.3888e4 - t3809 * t829 / 0.648e3 - t3815 * t829 / 0.1296e4 - t3818 * t823 / 0.216e3 - t3795 * t823 / 0.216e3 - t3804 * t829 / 0.648e3 + t1376 * t2342 / 0.972e3 - t3812 * t829 / 0.1296e4 + t1370 * t2339 / 0.162e3 + t1373 * t2342 / 0.486e3;
  t6713 = t5295 * t270;
  t6715 = t1287 * t826;
  t6717 = t6378 + t6380 - t6381 / 0.3888e4 - t6383 / 0.648e3 + t6386 - t6387 / 0.1944e4 + t6390 + t6391 / 0.24e2 - t6394 - t6395 / 0.96e2 + t6713 / 0.24e2 - t6715 / 0.96e2;
  t6718 = t1290 * t826;
  t6720 = t477 * t2332;
  t6721 = t6720 * t221;
  t6723 = t478 * t2321;
  t6725 = t5292 * t270;
  t6727 = t1885 * t735;
  t6741 = t473 * t2332;
  t6744 = -t6718 / 0.96e2 - t6721 / 0.18e2 + t6723 / 0.72e2 + t6725 / 0.24e2 - t6727 / 0.18e2 - t1892 * t735 / 0.6e1 + t474 * t2321 / 0.24e2 + t5323 * t270 / 0.8e1 + t5306 * t270 / 0.8e1 - t1299 * t826 / 0.32e2 - t1302 * t826 / 0.32e2 - t6741 * t221 / 0.6e1;
  t6748 = my_piecewise3(t65, 0, t6583 + t6608 + t6633 + t6660 + t6681 + t6706 + t6717 + t6744);
  tv4rho2sigma211 = t6 * t6748 + t2297 + t2440;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6765 = -t6405 / 0.4e1 + t5938 - t3467 * t776 / 0.72e2 - t6430 / 0.108e3 + t6064 - t1276 * t789 / 0.96e2 + t5270 * t252 / 0.24e2 - t6475 / 0.144e3 + t6477 / 0.36e2 - t6149 + t6153 - t3451 * t780 / 0.216e3 - t3455 * t786 / 0.648e3;
  t6779 = -t3458 * t786 / 0.1296e4 - t6493 / 0.972e3 - t6497 / 0.1944e4 - t6499 / 0.324e3 + t6202 + t6204 + t6206 - 0.3e1 / 0.8e1 * t503 * t766 - t6279 + t6286 - t6537 / 0.48e2 + t6541 / 0.12e2 + t5229 * t249 / 0.8e1 - t1273 * t783 / 0.32e2;
  t6781 = my_piecewise3(t1, 0, t6765 + t6779);
  tv4rho2sigma212 = t6 * t6781 + 0.2e1 * t2318;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6787 = 0.1e1 / t77 / t1463;
  t6788 = t227 * t6787;
  t6812 = t577 * t6787;
  t6819 = t509 * t2416;
  t6823 = t215 * t2403 * t98;
  t6830 = t1530 * t6787;
  t6838 = -t6564 / 0.4e1 - t6568 / 0.4e1 + t6349 - 0.16e2 / 0.19683e5 * t219 * t6788 * t4149 - 0.4e1 / 0.19683e5 * t225 * t6788 * t4186 + t5650 * t273 / 0.24e2 - t1494 * t832 / 0.96e2 - t1497 * t832 / 0.48e2 - t2089 * t745 / 0.9e1 - t2093 * t745 / 0.9e1 - 0.2e1 / 0.27e2 * t4382 * t2430 - 0.2e1 / 0.27e2 * t4386 * t2430 - 0.16e2 / 0.729e3 * t1487 * t6788 * t4222 - 0.16e2 / 0.2187e4 * t725 * t6812 * t4229 - 0.8e1 / 0.2187e4 * t725 * t6788 * t4229 - t6819 * t229 / 0.9e1 - t6823 * t229 / 0.9e1 + 0.19e2 / 0.81e2 * t1487 * t2427 * t1993 * t28 - 0.16e2 / 0.6561e4 * t219 * t6830 * t4149 - 0.16e2 / 0.19683e5 * t225 * t4180 * t6787 * t4186;
  t6852 = t260 * t1992;
  t6853 = t6852 * t1534;
  t6885 = -0.8e1 / 0.6561e4 * t225 * t6830 * t4186 - 0.16e2 / 0.6561e4 * t219 * t6812 * t4149 - 0.44e2 / 0.59049e5 * t225 * t6812 * t4186 + t591 * t2411 / 0.36e2 + t595 * t2411 / 0.36e2 + 0.19e2 / 0.6561e4 * t586 * t6853 - t1570 * t2373 / 0.243e3 - 0.2e1 / 0.729e3 * t1556 * t2381 - 0.2e1 / 0.2187e4 * t1563 * t2381 - t1574 * t2373 / 0.243e3 - 0.2e1 / 0.729e3 * t1560 * t2381 - 0.2e1 / 0.2187e4 * t1567 * t2381 + t1542 * t2378 / 0.27e2 + t1548 * t2378 / 0.27e2 + 0.19e2 / 0.243e3 * t1515 * t6852 * t1517 - 0.2e1 / 0.81e2 * t4212 * t2370 - 0.2e1 / 0.243e3 * t4235 * t2373 - 0.2e1 / 0.81e2 * t4216 * t2370 - 0.2e1 / 0.243e3 * t4239 * t2373 - t4160 * t819 / 0.72e2;
  t6921 = t6852 * t1523;
  t6928 = -t4163 * t819 / 0.36e2 - t4209 * t819 / 0.72e2 + 0.4e1 / 0.81e2 * t5852 * t732 + 0.4e1 / 0.81e2 * t5863 * t732 + 0.16e2 / 0.243e3 * t5772 * t1996 + 0.16e2 / 0.729e3 * t5816 * t2001 + 0.8e1 / 0.729e3 * t1976 * t2001 - 0.1e2 / 0.243e3 * t1980 * t2018 - 0.5e1 / 0.243e3 * t1984 * t2018 + 0.4e1 / 0.243e3 * t5856 * t742 + 0.4e1 / 0.243e3 * t5867 * t742 + 0.16e2 / 0.2187e4 * t5822 * t2026 + 0.16e2 / 0.2187e4 * t1980 * t2026 + 0.2e1 / 0.243e3 * t5859 * t742 + 0.2e1 / 0.243e3 * t5871 * t742 - 0.2e1 / 0.729e3 * t4153 * t2381 - 0.2e1 / 0.729e3 * t4157 * t2381 + 0.19e2 / 0.1458e4 * t571 * t6921 + 0.19e2 / 0.2187e4 * t579 * t6853 + 0.19e2 / 0.729e3 * t1522 * t6921;
  t6936 = t807 * t527;
  t6938 = t215 * t6936 * t99;
  t6959 = -0.1e2 / 0.81e2 * t1976 * t1988 + 0.19e2 / 0.2187e4 * t1532 * t6853 - 0.7e1 / 0.162e3 * t530 * t816 * t535 - 0.8e1 / 0.81e2 * t6938 * t536 + 0.16e2 / 0.6561e4 * t1984 * t2026 - 0.2e1 / 0.729e3 * t6596 - t6598 / 0.729e3 + 0.2e1 / 0.729e3 * t6600 - t6602 / 0.108e3 - t6604 / 0.108e3 + 0.4e1 / 0.243e3 * t6606 + 0.4e1 / 0.729e3 * t6610 - 0.2e1 / 0.2187e4 * t6612 - 0.2e1 / 0.2187e4 * t6614 - 0.2e1 / 0.6561e4 * t6616 + t6618 / 0.81e2 - 0.2e1 / 0.243e3 * t6620 + t6357 + 0.7e1 / 0.54e2 * t2417 * t522 + 0.7e1 / 0.54e2 * t718 * t2101;
  t6962 = t797 * t519;
  t6963 = t6962 * t206;
  t7008 = -0.7e1 / 0.216e3 * t225 * t228 * t6963 - t1501 * t832 / 0.96e2 - 0.1e2 / 0.27e2 * t2420 * t2106 + 0.4e1 / 0.27e2 * t509 * t2013 * t729 + 0.4e1 / 0.27e2 * t215 * t5766 * t729 + 0.16e2 / 0.81e2 * t5618 * t2086 + t5640 * t273 / 0.24e2 + t5643 * t273 / 0.12e2 + 0.4e1 / 0.81e2 * t6635 + t6637 / 0.36e2 + t6639 / 0.36e2 - t6642 / 0.27e2 + t6644 / 0.108e3 - t6646 / 0.27e2 - 0.2e1 / 0.81e2 * t6648 - t6650 / 0.144e3 - t6652 / 0.144e3 + t6361 - t6365 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.7e1 / 0.243e3 * t130 * t6963 - 0.14e2 / 0.2187e4 * t331 * t802 * t533 * t561 + 0.152e3 / 0.19683e5 * t2399 * t2024 - 0.32e2 / 0.177147e6 * t2986 * t6787 * t4291) * t100;
  t7013 = t816 * t533;
  t7014 = t7013 * t581;
  t7050 = t215 * t2332 * t227;
  t7053 = -0.3e1 / 0.8e1 * t549 * t809 - 0.3e1 / 0.4e1 * t194 * t2405 - 0.7e1 / 0.2916e4 * t586 * t7014 - 0.7e1 / 0.1458e4 * t579 * t7014 - t4077 * t823 / 0.216e3 - t4099 * t829 / 0.648e3 - t4102 * t829 / 0.324e3 - t4106 * t829 / 0.648e3 + t1563 * t2342 / 0.486e3 + t1567 * t2342 / 0.486e3 - t4111 * t829 / 0.1296e4 - t4092 * t829 / 0.648e3 - t4096 * t829 / 0.1296e4 - t4125 * t823 / 0.216e3 - t4073 * t823 / 0.108e3 + t1560 * t2342 / 0.243e3 + t1570 * t2339 / 0.81e2 + t1574 * t2339 / 0.81e2 + t1556 * t2342 / 0.243e3 - 0.8e1 / 0.243e3 * t7050 * t573;
  t7056 = t215 * t2416 * t577;
  t7060 = t215 * t2416 * t227;
  t7078 = -0.8e1 / 0.729e3 * t7056 * t582 - 0.4e1 / 0.729e3 * t7060 * t582 - 0.7e1 / 0.486e3 * t571 * t7013 * t572 + t6669 / 0.243e3 + t6671 / 0.729e3 - t6673 / 0.972e3 - t6675 / 0.324e3 - t6677 / 0.972e3 - t6679 / 0.1944e4 - t6682 / 0.324e3 + t6684 / 0.1458e4 - t6686 / 0.1944e4 + t6378 + t6380 + t6386 + t6390 - t6394 + t6713 / 0.12e2 - t6715 / 0.48e2 - t6718 / 0.48e2;
  t7107 = t509 * t2332;
  t7111 = t215 * t2403 * t217;
  t7121 = -t6721 / 0.9e1 + t6723 / 0.36e2 + t6725 / 0.12e2 - t6727 / 0.9e1 - t1968 * t735 / 0.3e1 - t1972 * t735 / 0.3e1 - 0.16e2 / 0.243e3 * t4354 * t99 * t6787 * t6302 + t510 * t2321 / 0.12e2 + t514 * t2321 / 0.12e2 + t5896 * t270 / 0.8e1 + t5899 * t270 / 0.4e1 + t5902 * t270 / 0.8e1 - t1413 * t826 / 0.32e2 - t1416 * t826 / 0.16e2 - t1419 * t826 / 0.32e2 - t7107 * t221 / 0.3e1 - t7111 * t221 / 0.3e1 + 0.7e1 / 0.18e2 * t2333 * t598 + 0.7e1 / 0.18e2 * t714 * t1953 - 0.7e1 / 0.72e2 * t219 * t220 * t6962;
  t7125 = my_piecewise3(t65, 0, t6838 + t6885 + t6928 + t6959 + t7008 + t7053 + t7078 + t7121);
  tv4rho2sigma217 = t6 * t7125 + 0.2e1 * t2440;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7146 = 0.1e1 / t33 / t1609;
  t7147 = t759 * t7146;
  t7148 = t7147 * t2832;
  t7151 = t7147 * t2807;
  t7158 = -t4560 * t2191 / 0.81e2 - t1770 * t2191 / 0.162e3 - t4566 * t2173 / 0.243e3 - t1774 * t2173 / 0.243e3 - t1778 * t2173 / 0.729e3 + t1021 * t2455 / 0.48e2 + t989 * t2455 / 0.48e2 + t1033 * t2460 / 0.5832e4 + t1037 * t2460 / 0.5832e4 + 0.2e1 / 0.6561e4 * t351 * t7148 + 0.11e2 / 0.39366e5 * t359 * t7151 + t344 * t7151 / 0.13122e5 + t2849 * t2463 / 0.216e3;
  t7164 = t7147 * t2862;
  t7184 = t2778 * t2463 / 0.648e3;
  t7186 = t1025 * t2455 / 0.144e3;
  t7187 = t2769 * t2463 / 0.216e3 + 0.2e1 / 0.243e3 * t2853 * t7147 * t2855 + 0.2e1 / 0.729e3 * t2860 * t7164 + t993 * t7164 / 0.729e3 + t2822 * t2466 / 0.648e3 + t2826 * t2466 / 0.648e3 + 0.2e1 / 0.2187e4 * t2830 * t7148 + 0.2e1 / 0.2187e4 * t1012 * t7148 + t1040 * t2466 / 0.1296e4 + t1053 * t2466 / 0.1296e4 - t4584 * t2188 / 0.27e2 + t7184 + t7186;
  t7215 = t6231 * t647 / 0.27e2 + t6251 * t659 / 0.81e2 + t6255 * t659 / 0.162e3 + t2836 * t2460 / 0.1944e4 + t2840 * t2460 / 0.1944e4 + 0.2e1 / 0.6561e4 * t2846 * t7151 + t1018 * t7151 / 0.2187e4 + t1056 * t2460 / 0.1944e4 + t1060 * t2460 / 0.1944e4 - t4739 * t776 / 0.24e2 - t4695 * t776 / 0.24e2 + t3049 * t2494 / 0.72e2 + t3038 * t2494 / 0.72e2;
  t7226 = t143 * t2517 * t58;
  t7246 = t6179 * t252 / 0.48e2;
  t7249 = 0.2e1 / 0.81e2 * t3022 * t59 * t759 * t7146 * M_PI * t43 + t143 * t6037 * t644 / 0.9e1 - t7226 * t157 / 0.18e2 + t382 * t2480 / 0.64e2 + t389 * t2480 / 0.64e2 - t4804 * t2242 / 0.9e1 - t1738 * t789 / 0.32e2 - t1760 * t789 / 0.32e2 + t6156 * t252 / 0.16e2 + t6160 * t252 / 0.16e2 + t631 * t2225 / 0.24e2 + t7246 - t2250 * t662 / 0.12e2;
  t7253 = t3011 * t2494 / 0.216e3;
  t7255 = t385 * t2480 / 0.192e3;
  t7256 = t2477 * t132;
  t7257 = t7256 * t134;
  t7262 = t1741 * t789 / 0.96e2;
  t7263 = t2444 * t124;
  t7264 = t7263 * t346;
  t7268 = t4506 * t780 / 0.216e3;
  t7272 = t4491 * t786 / 0.648e3;
  t7274 = t1043 * t2446 / 0.2592e4;
  t7283 = t7253 + t7255 - t153 * t156 * t7257 / 0.48e2 - t7262 - t344 * t7264 / 0.648e3 - t7268 + t1770 * t2141 / 0.54e2 - t7272 + t7274 + t1033 * t2446 / 0.864e3 + t1037 * t2446 / 0.864e3 - t4472 * t780 / 0.72e2 - t4476 * t780 / 0.72e2;
  t7293 = t1046 * t2502 / 0.432e3;
  t7295 = t1049 * t2446 / 0.1296e4;
  t7299 = t4488 * t786 / 0.1296e4;
  t7310 = -t4494 * t786 / 0.216e3 - t4481 * t786 / 0.216e3 - t4497 * t786 / 0.432e3 - t4485 * t786 / 0.432e3 + t7293 + t7295 + t1774 * t2147 / 0.162e3 - t7299 + t1778 * t2147 / 0.324e3 + t1053 * t2502 / 0.144e3 + t1056 * t2446 / 0.432e3 + t1060 * t2446 / 0.432e3 + t1040 * t2502 / 0.144e3;
  t7320 = t1049 * t2460 / 0.5832e4;
  t7322 = t4690 * t776 / 0.72e2;
  t7324 = t2781 * t2466 / 0.1944e4;
  t7326 = t1046 * t2466 / 0.3888e4;
  t7328 = t2784 * t2460 / 0.5832e4;
  t7333 = t1043 * t2460 / 0.17496e5;
  t7354 = t26 * t117 * t2517 * t60 / 0.8e1;
  t7355 = -t351 * t7263 * t352 / 0.108e3 - t359 * t7264 / 0.324e3 + t1626 * t2168 / 0.18e2 + t7320 - t7322 + t7324 + t7326 + t7328 - t284 * t2444 * t643 / 0.36e2 + t7333 - 0.3e1 / 0.8e1 * t26 * t27 * (-t130 * t7257 / 0.54e2 - t331 * t2443 * t124 * t334 / 0.243e3 + 0.4e1 / 0.59049e5 * t2986 * t759 * t7146 * t2990) * t60 - 0.3e1 / 0.8e1 * t113 * t2519 - t7354;
  t7369 = t143 * t2517 * t145;
  t7375 = t375 * t2497 / 0.64e2;
  t7380 = t6280 * t249 / 0.16e2;
  t7384 = t1668 * t783 / 0.32e2;
  t7385 = -0.3e1 / 0.32e2 * t1685 * t783 - 0.3e1 / 0.32e2 * t1672 * t783 + 0.3e1 / 0.64e2 * t365 * t2497 + 0.3e1 / 0.64e2 * t379 * t2497 + 0.3e1 / 0.16e2 * t6318 * t249 + 0.3e1 / 0.16e2 * t6322 * t249 - t7369 * t149 / 0.6e1 + t627 * t2121 / 0.8e1 + t7375 - t147 * t148 * t7256 / 0.16e2 + t7380 - t2127 * t650 / 0.4e1 - t7384;
  t7389 = my_piecewise3(t1, 0, t7158 + t7187 + t7215 + t7249 + t7283 + t7310 + t7355 + t7385);
  tv4rhosigma30 = t6 * t7389 + t2524;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t7392 = t3871 * t2555 / 0.648e3;
  t7394 = t3866 * t2558 / 0.1944e4;
  t7396 = t1355 * t2534 / 0.144e3;
  t7398 = t1364 * t2550 / 0.17496e5;
  t7413 = t7392 + t7394 + t7396 + t7398 - t5485 * t819 / 0.24e2 + t3894 * t2555 / 0.216e3 + t3897 * t2558 / 0.648e3 + t1370 * t2558 / 0.1296e4 + t3881 * t2550 / 0.1944e4 + t1373 * t2550 / 0.1944e4 + t1358 * t2534 / 0.48e2;
  t7417 = t5427 * t819 / 0.72e2;
  t7419 = t1367 * t2558 / 0.3888e4;
  t7421 = t3859 * t2550 / 0.5832e4;
  t7423 = t1361 * t2550 / 0.5832e4;
  t7425 = t484 * t2545 / 0.192e3;
  t7435 = t6641 * t273 / 0.48e2;
  t7436 = t1376 * t2550 / 0.5832e4 - t7417 + t7419 + t7421 + t7423 + t7425 + t3982 * t2580 / 0.72e2 + t481 * t2545 / 0.64e2 - t1930 * t832 / 0.32e2 + t6627 * t273 / 0.16e2 + t7435;
  t7439 = t3962 * t2580 / 0.216e3;
  t7441 = t1913 * t832 / 0.96e2;
  t7443 = t1367 * t2587 / 0.432e3;
  t7445 = t1361 * t2529 / 0.1296e4;
  t7447 = t5493 * t823 / 0.216e3;
  t7449 = t5496 * t829 / 0.648e3;
  t7451 = t1364 * t2529 / 0.2592e4;
  t7453 = t5509 * t829 / 0.1296e4;
  t7460 = t7439 - t7441 + t7443 + t7445 - t7447 - t7449 + t7451 - t7453 + t1373 * t2529 / 0.432e3 + t1370 * t2587 / 0.144e3 + t1376 * t2529 / 0.864e3;
  t7472 = t74 * t117 * t2600 * t100 / 0.8e1;
  t7480 = t6720 * t270 / 0.16e2;
  t7482 = t478 * t2570 / 0.64e2;
  t7484 = t1885 * t826 / 0.32e2;
  t7485 = -t5503 * t829 / 0.432e3 - t5506 * t823 / 0.72e2 - t5500 * t829 / 0.216e3 - 0.3e1 / 0.8e1 * t168 * t2602 - t7472 + 0.3e1 / 0.64e2 * t474 * t2570 - 0.3e1 / 0.32e2 * t1892 * t826 + 0.3e1 / 0.16e2 * t6741 * t270 + t7480 + t7482 - t7484;
  t7488 = my_piecewise3(t65, 0, t7413 + t7436 + t7460 + t7485);
  tv4rhosigma39 = t6 * t7488 + t2607;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t7508 = t1185 * t2460 / 0.5832e4 + t3241 * t2463 / 0.216e3 + t3220 * t2466 / 0.648e3 + t1179 * t2466 / 0.1296e4 + t3225 * t2460 / 0.1944e4 + t1182 * t2460 / 0.1944e4 + t1175 * t2455 / 0.48e2 - t5011 * t776 / 0.24e2 + t7184 + t7186 + t3319 * t2494 / 0.72e2;
  t7523 = t443 * t2480 / 0.64e2 - t1857 * t789 / 0.32e2 + t6468 * t252 / 0.16e2 + t7246 + t7253 + t7255 - t7262 - t4957 * t780 / 0.72e2 - t4960 * t786 / 0.216e3 - t4963 * t786 / 0.432e3 + t1179 * t2502 / 0.144e3;
  t7529 = t1182 * t2446 / 0.432e3 + t1185 * t2446 / 0.864e3 - t7268 - t7272 + t7274 + t7293 + t7295 - t7299 + t7320 - t7322 + t7324;
  t7538 = t7326 + t7328 + t7333 - 0.3e1 / 0.8e1 * t184 * t2519 - t7354 + t7375 + t7380 - t7384 - 0.3e1 / 0.32e2 * t1823 * t783 + 0.3e1 / 0.64e2 * t440 * t2497 + 0.3e1 / 0.16e2 * t6547 * t249;
  t7541 = my_piecewise3(t1, 0, t7508 + t7523 + t7529 + t7538);
  tv4rhosigma310 = t6 * t7541 + t2524;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t7544 = 0.1e1 / t77 / t1991;
  t7545 = t802 * t7544;
  t7546 = t7545 * t4229;
  t7555 = t7545 * t4149;
  t7574 = 0.2e1 / 0.729e3 * t4227 * t7546 + t1515 * t7546 / 0.729e3 + t4235 * t2558 / 0.648e3 + t4239 * t2558 / 0.648e3 + 0.2e1 / 0.2187e4 * t4243 * t7555 + 0.2e1 / 0.2187e4 * t1522 * t7555 + t1570 * t2558 / 0.1296e4 - t1976 * t2373 / 0.162e3 - t1980 * t2381 / 0.243e3 - t1984 * t2381 / 0.729e3 + t1542 * t2534 / 0.48e2 + t1548 * t2534 / 0.48e2 - t5772 * t2370 / 0.27e2;
  t7600 = t7545 * t4186;
  t7603 = -t5816 * t2373 / 0.81e2 - t5822 * t2381 / 0.243e3 + t1563 * t2550 / 0.5832e4 + t1567 * t2550 / 0.5832e4 + t2015 * t2378 / 0.18e2 - t530 * t2527 * t728 / 0.36e2 + t7050 * t732 / 0.27e2 + t7056 * t742 / 0.81e2 + t7060 * t742 / 0.162e3 + t1574 * t2558 / 0.1296e4 + t4153 * t2550 / 0.1944e4 + t4157 * t2550 / 0.1944e4 + 0.2e1 / 0.6561e4 * t4182 * t7600;
  t7628 = t1532 * t7600 / 0.2187e4 + t1556 * t2550 / 0.1944e4 + t1560 * t2550 / 0.1944e4 - t5763 * t819 / 0.24e2 - t5768 * t819 / 0.24e2 + 0.2e1 / 0.6561e4 * t571 * t7555 + 0.11e2 / 0.39366e5 * t579 * t7600 + t586 * t7600 / 0.13122e5 + t4212 * t2555 / 0.216e3 + t4216 * t2555 / 0.216e3 + 0.2e1 / 0.243e3 * t4220 * t7545 * t4222 + t7392 + t7394;
  t7643 = t7396 + t7398 - t7417 + t7419 + t7421 + t7423 + t595 * t2545 / 0.64e2 - t2089 * t832 / 0.32e2 - t2093 * t832 / 0.32e2 - t5618 * t2430 / 0.9e1 + t6819 * t273 / 0.16e2 + t6823 * t273 / 0.16e2 + t718 * t2411 / 0.24e2;
  t7646 = t2542 * t204;
  t7647 = t7646 * t206;
  t7665 = t215 * t2600 * t98;
  t7674 = -t225 * t228 * t7647 / 0.48e2 + t4382 * t2580 / 0.72e2 + t4386 * t2580 / 0.72e2 + 0.2e1 / 0.81e2 * t4354 * t99 * t802 * t7544 * M_PI * t43 + t215 * t6936 * t729 / 0.9e1 - t7665 * t229 / 0.18e2 + t591 * t2545 / 0.64e2 + t7425 - t2417 * t745 / 0.12e2 + t7435 + t7439 - t7441 - t5859 * t829 / 0.432e3;
  t7681 = t2527 * t199;
  t7682 = t7681 * t581;
  t7703 = -t5871 * t829 / 0.432e3 + t1976 * t2339 / 0.54e2 + t1980 * t2342 / 0.162e3 - t586 * t7682 / 0.648e3 + t1984 * t2342 / 0.324e3 + t1556 * t2529 / 0.432e3 + t1560 * t2529 / 0.432e3 + t1570 * t2587 / 0.144e3 + t1574 * t2587 / 0.144e3 - t5852 * t823 / 0.72e2 - t5863 * t823 / 0.72e2 - t5856 * t829 / 0.216e3 - t5867 * t829 / 0.216e3;
  t7731 = -t571 * t7681 * t572 / 0.108e3 - t579 * t7682 / 0.324e3 + t1563 * t2529 / 0.864e3 + t1567 * t2529 / 0.864e3 + t7443 + t7445 - t7447 - t7449 + t7451 - t7453 - 0.3e1 / 0.8e1 * t194 * t2602 - 0.3e1 / 0.8e1 * t74 * t27 * (-t130 * t7647 / 0.54e2 - t331 * t2526 * t199 * t561 / 0.243e3 + 0.4e1 / 0.59049e5 * t2986 * t802 * t7544 * t4291) * t100 - t7472;
  t7733 = t215 * t2600 * t217;
  t7755 = t7480 + t7482 - t7484 - t7733 * t221 / 0.6e1 + 0.3e1 / 0.64e2 * t510 * t2570 + 0.3e1 / 0.64e2 * t514 * t2570 - 0.3e1 / 0.32e2 * t1968 * t826 - 0.3e1 / 0.32e2 * t1972 * t826 + 0.3e1 / 0.16e2 * t7107 * t270 + 0.3e1 / 0.16e2 * t7111 * t270 + t714 * t2321 / 0.8e1 - t2333 * t735 / 0.4e1 - t219 * t220 * t7646 / 0.16e2;
  t7759 = my_piecewise3(t65, 0, t7574 + t7603 + t7628 + t7643 + t7674 + t7703 + t7731 + t7755);
  tv4rhosigma319 = t6 * t7759 + t2607;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t7761 = t2443 * t2615;
  t7762 = t7761 * t2862;
  t7765 = t7761 * t2832;
  t7770 = t2477 * t2458;
  t7771 = t7770 * t1000;
  t7774 = t7770 * t1005;
  t7789 = -t993 * t7762 / 0.1944e4 - t2830 * t7765 / 0.2916e4 - t1012 * t7765 / 0.2916e4 - t351 * t7771 / 0.432e3 - t359 * t7774 / 0.648e3 - t344 * t7774 / 0.1944e4 + t4584 * t2463 / 0.54e2 + t4560 * t2466 / 0.162e3 + t1770 * t2466 / 0.324e3 + t4566 * t2460 / 0.486e3 + t1774 * t2460 / 0.486e3;
  t7796 = t2442 * sigma[0];
  t7797 = 0.1e1 / t7796;
  t7798 = t30 * t7797;
  t7804 = t7761 * t2807;
  t7820 = t1778 * t2460 / 0.1458e4 - t1018 * t7774 / 0.648e3 - t1012 * t7771 / 0.216e3 - 0.5e1 / 0.96e2 * t284 * t7798 * t775 - t6039 * t776 / 0.12e2 - t2846 * t7804 / 0.8748e4 - t1018 * t7804 / 0.5832e4 + t1626 * t2455 / 0.12e2 - t993 * t7770 * t995 / 0.72e2 - t351 * t7765 / 0.8748e4 - 0.11e2 / 0.104976e6 * t359 * t7804 - t344 * t7804 / 0.34992e5;
  t7847 = 0.1e1 / t44 / t7796 * t47;
  t7848 = t7847 * t134;
  t7856 = -t2853 * t7761 * t2855 / 0.324e3 - t2860 * t7762 / 0.972e3 - t955 * t59 * t2477 * t2493 / 0.24e2 + t631 * t2480 / 0.16e2 + t4804 * t2494 / 0.18e2 - t2250 * t789 / 0.16e2 + t7226 * t252 / 0.12e2 - t3022 * t59 * t2443 * t2615 * M_PI * t43 / 0.108e3 - 0.5e1 / 0.128e3 * t153 * t156 * t7848 + t1778 * t2446 / 0.216e3 - t6231 * t780 / 0.36e2;
  t7859 = t7798 * t36;
  t7863 = t7859 * t346;
  t7901 = -t6251 * t786 / 0.108e3 - 0.5e1 / 0.288e3 * t351 * t7859 * t352 - 0.5e1 / 0.864e3 * t359 * t7863 - t6255 * t786 / 0.216e3 + t1770 * t2502 / 0.36e2 + t1774 * t2446 / 0.108e3 - 0.5e1 / 0.1728e4 * t344 * t7863 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.5e1 / 0.144e3 * t130 * t7848 - 0.5e1 / 0.648e3 * t331 * t7797 * t36 * t334 - t893 * t2477 * t2514 / 0.729e3 - t2986 * t2443 * t2615 * t2990 / 0.39366e5) * t60 + 0.3e1 / 0.16e2 * t627 * t2497 - 0.15e2 / 0.128e3 * t147 * t148 * t7847 - 0.3e1 / 0.16e2 * t2127 * t783 + t7369 * t249 / 0.4e1;
  t7904 = my_piecewise3(t1, 0, t7789 + t7820 + t7856 + t7901);
  tv4sigma40 = t6 * t7904;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t7907 = t2542 * t2548;
  t7908 = t7907 * t1523;
  t7913 = t7907 * t1534;
  t7916 = t2525 * sigma[2];
  t7917 = 0.1e1 / t7916;
  t7918 = t30 * t7917;
  t7922 = t2526 * t4053;
  t7923 = t7922 * t4186;
  t7930 = t7922 * t4149;
  t7937 = t5822 * t2550 / 0.486e3 - t571 * t7908 / 0.432e3 - t1522 * t7908 / 0.216e3 - t1532 * t7913 / 0.648e3 - 0.5e1 / 0.96e2 * t530 * t7918 * t818 - t4182 * t7923 / 0.8748e4 - t1532 * t7923 / 0.5832e4 - t6938 * t819 / 0.12e2 - t571 * t7930 / 0.8748e4 - 0.11e2 / 0.104976e6 * t579 * t7923 - t586 * t7923 / 0.34992e5;
  t7941 = t7922 * t4229;
  t7965 = -t4220 * t7922 * t4222 / 0.324e3 - t4227 * t7941 / 0.972e3 - t1515 * t7941 / 0.1944e4 - t4243 * t7930 / 0.2916e4 - t1522 * t7930 / 0.2916e4 - t579 * t7913 / 0.648e3 - t586 * t7913 / 0.1944e4 + t1976 * t2558 / 0.324e3 + t1980 * t2550 / 0.486e3 + t1984 * t2550 / 0.1458e4 + t2015 * t2534 / 0.12e2 - t1515 * t7907 * t1517 / 0.72e2;
  t7973 = 0.1e1 / t84 / t7916 * t87;
  t7974 = t7973 * t206;
  t8016 = t5772 * t2555 / 0.54e2 + t5816 * t2558 / 0.162e3 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.5e1 / 0.144e3 * t130 * t7974 - 0.5e1 / 0.648e3 * t331 * t7917 * t80 * t561 - t893 * t2542 * t2597 / 0.729e3 - t2986 * t2526 * t4053 * t4291 / 0.39366e5) * t100 + t7665 * t273 / 0.12e2 - t4354 * t99 * t2526 * t4053 * M_PI * t43 / 0.108e3 - t1487 * t99 * t2542 * t2579 / 0.24e2 + t718 * t2545 / 0.16e2 - t2417 * t832 / 0.16e2 + t5618 * t2580 / 0.18e2 - 0.5e1 / 0.128e3 * t225 * t228 * t7974 + t1984 * t2529 / 0.216e3;
  t8023 = t7918 * t80;
  t8027 = t8023 * t581;
  t8045 = -t7060 * t829 / 0.216e3 - t7050 * t823 / 0.36e2 - t7056 * t829 / 0.108e3 - 0.5e1 / 0.288e3 * t571 * t8023 * t572 - 0.5e1 / 0.864e3 * t579 * t8027 + t1976 * t2587 / 0.36e2 + t1980 * t2529 / 0.108e3 - 0.5e1 / 0.1728e4 * t586 * t8027 - 0.15e2 / 0.128e3 * t219 * t220 * t7973 + 0.3e1 / 0.16e2 * t714 * t2570 - 0.3e1 / 0.16e2 * t2333 * t826 + t7733 * t270 / 0.4e1;
  t8048 = my_piecewise3(t65, 0, t7937 + t7965 + t8016 + t8045);
  tv4sigma414 = t6 * t8048;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

