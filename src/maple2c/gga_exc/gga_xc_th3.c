/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_xc_th3.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t39, t40;
  double t43, t45, t50, t56, t62, t68, t69, t71;
  double t76, t77, t78, t79, t80, t85, t86, t87;
  double t88, t92, t93, t95, t96, t98, t103, t104;
  double t108, t109, t112, t113, t116, tzk0;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = pow(0.2e1, 0.1e1 / 0.12e2);
  t34 = t33 * t33;
  t36 = t34 * t34;
  t38 = params->omega[4] * t36 * t34 * t33;
  t39 = pow(rho[0], 0.1e1 / 0.12e2);
  t40 = sqrt(sigma[0]);
  t43 = POW_1_3(p->zeta_threshold);
  t45 = my_piecewise3(0.1e1 <= p->zeta_threshold, t43 * p->zeta_threshold, 1);
  t50 = params->omega[5] * t20;
  t56 = params->omega[6] * t12;
  t62 = params->omega[7] * t2;
  t68 = params->omega[8] * t12;
  t69 = 0.1e1 / rho[0];
  t71 = t45 * t45;
  t76 = params->omega[9] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[10];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t71;
  t92 = params->omega[11] * t12;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t71 - t96;
  t103 = params->omega[12] * t2;
  t104 = t79 * rho[0];
  t108 = params->omega[13];
  t109 = t108 * t93;
  t112 = params->omega[18];
  t113 = pow(rho[0], 0.10833333333333333333e1);
  t116 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t38 * t39 * t40 * t45 / 0.4e1 + t50 * t7 * t40 * t45 / 0.4e1 + t56 * t15 * t40 * t45 / 0.4e1 + t62 * t22 * t40 * t45 / 0.4e1 + t68 * t69 * sigma[0] * t71 / 0.8e1 + t76 * t80 * sigma[0] * t71 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t29 * t98 / 0.2e1 + t103 * t104 * t98 / 0.2e1 + t109 * t98 / 0.2e1 + 0.94387431268169349665e0 * t112 * t113;
  tzk0 = t116 * t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t39, t40;
  double t43, t45, t50, t56, t62, t68, t69, t71;
  double t76, t77, t78, t79, t80, t85, t86, t87;
  double t88, t92, t93, t95, t96, t98, t103, t104;
  double t108, t109, t112, t113, t116, tzk0;

  double t125, t127, t128, t129, t130, t143, t148, t153;
  double t158, t159, t165, t167, t168, t171, t181, t185;
  double tvrho0, t188, t214, tvsigma0;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = pow(0.2e1, 0.1e1 / 0.12e2);
  t34 = t33 * t33;
  t36 = t34 * t34;
  t38 = params->omega[4] * t36 * t34 * t33;
  t39 = pow(rho[0], 0.1e1 / 0.12e2);
  t40 = sqrt(sigma[0]);
  t43 = POW_1_3(p->zeta_threshold);
  t45 = my_piecewise3(0.1e1 <= p->zeta_threshold, t43 * p->zeta_threshold, 1);
  t50 = params->omega[5] * t20;
  t56 = params->omega[6] * t12;
  t62 = params->omega[7] * t2;
  t68 = params->omega[8] * t12;
  t69 = 0.1e1 / rho[0];
  t71 = t45 * t45;
  t76 = params->omega[9] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[10];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t71;
  t92 = params->omega[11] * t12;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t71 - t96;
  t103 = params->omega[12] * t2;
  t104 = t79 * rho[0];
  t108 = params->omega[13];
  t109 = t108 * t93;
  t112 = params->omega[18];
  t113 = pow(rho[0], 0.10833333333333333333e1);
  t116 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t38 * t39 * t40 * t45 / 0.4e1 + t50 * t7 * t40 * t45 / 0.4e1 + t56 * t15 * t40 * t45 / 0.4e1 + t62 * t22 * t40 * t45 / 0.4e1 + t68 * t69 * sigma[0] * t71 / 0.8e1 + t76 * t80 * sigma[0] * t71 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t29 * t98 / 0.2e1 + t103 * t104 * t98 / 0.2e1 + t109 * t98 / 0.2e1 + 0.94387431268169349665e0 * t112 * t113;
  tzk0 = t116 * t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t39 * t39;
  t127 = t125 * t125;
  t128 = t127 * t127;
  t129 = t128 * t125 * t39;
  t130 = 0.1e1 / t129;
  t143 = 0.1e1 / t22;
  t148 = 0.1e1 / t93;
  t153 = 0.1e1 / t104;
  t158 = 0.1e1 / t29;
  t159 = t85 * t158;
  t165 = t93 * rho[0];
  t167 = 0.1e1 / t28 / t165;
  t168 = sigma[0] * t167;
  t171 = -0.8e1 / 0.3e1 * t168 * t71 + 0.8e1 / 0.3e1 * t168;
  t181 = t108 * rho[0];
  t185 = pow(rho[0], 0.833333333333333333e-1);
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t38 * t130 * t40 * t45 / 0.48e2 + t50 * t80 * t40 * t45 / 0.24e2 + t56 * t86 * t40 * t45 / 0.12e2 + t62 * t143 * t40 * t45 / 0.8e1 - t68 * t148 * sigma[0] * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * sigma[0] * t71 - t159 * t88 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t98 + t92 * t29 * t171 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t98 + t103 * t104 * t171 / 0.2e1 + t181 * t98 + t109 * t171 / 0.2e1 + 0.10225305054051679547e1 * t112 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t188 = 0.1e1 / t40;
  t214 = t95 * t71 - t95;
  tvsigma0 = t38 * t39 * t188 * t45 / 0.8e1 + t50 * t7 * t188 * t45 / 0.8e1 + t56 * t15 * t188 * t45 / 0.8e1 + t62 * t22 * t188 * t45 / 0.8e1 + t68 * t69 * t71 / 0.8e1 + t76 * t80 * t71 / 0.8e1 + t87 * t71 / 0.8e1 + t92 * t29 * t214 / 0.2e1 + t103 * t104 * t214 / 0.2e1 + t109 * t214 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t39, t40;
  double t43, t45, t50, t56, t62, t68, t69, t71;
  double t76, t77, t78, t79, t80, t85, t86, t87;
  double t88, t92, t93, t95, t96, t98, t103, t104;
  double t108, t109, t112, t113, t116, tzk0;

  double t125, t127, t128, t129, t130, t143, t148, t153;
  double t158, t159, t165, t167, t168, t171, t181, t185;
  double tvrho0, t188, t214, tvsigma0;

  double t229, t233, t246, t251, t257, t263, t272, t274;
  double t275, t278, t282, t297, t300, tv2rho20, t330, tv2rhosigma0;
  double t344, tv2sigma20;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = pow(0.2e1, 0.1e1 / 0.12e2);
  t34 = t33 * t33;
  t36 = t34 * t34;
  t38 = params->omega[4] * t36 * t34 * t33;
  t39 = pow(rho[0], 0.1e1 / 0.12e2);
  t40 = sqrt(sigma[0]);
  t43 = POW_1_3(p->zeta_threshold);
  t45 = my_piecewise3(0.1e1 <= p->zeta_threshold, t43 * p->zeta_threshold, 1);
  t50 = params->omega[5] * t20;
  t56 = params->omega[6] * t12;
  t62 = params->omega[7] * t2;
  t68 = params->omega[8] * t12;
  t69 = 0.1e1 / rho[0];
  t71 = t45 * t45;
  t76 = params->omega[9] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[10];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t71;
  t92 = params->omega[11] * t12;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t71 - t96;
  t103 = params->omega[12] * t2;
  t104 = t79 * rho[0];
  t108 = params->omega[13];
  t109 = t108 * t93;
  t112 = params->omega[18];
  t113 = pow(rho[0], 0.10833333333333333333e1);
  t116 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t38 * t39 * t40 * t45 / 0.4e1 + t50 * t7 * t40 * t45 / 0.4e1 + t56 * t15 * t40 * t45 / 0.4e1 + t62 * t22 * t40 * t45 / 0.4e1 + t68 * t69 * sigma[0] * t71 / 0.8e1 + t76 * t80 * sigma[0] * t71 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t29 * t98 / 0.2e1 + t103 * t104 * t98 / 0.2e1 + t109 * t98 / 0.2e1 + 0.94387431268169349665e0 * t112 * t113;
  tzk0 = t116 * t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t39 * t39;
  t127 = t125 * t125;
  t128 = t127 * t127;
  t129 = t128 * t125 * t39;
  t130 = 0.1e1 / t129;
  t143 = 0.1e1 / t22;
  t148 = 0.1e1 / t93;
  t153 = 0.1e1 / t104;
  t158 = 0.1e1 / t29;
  t159 = t85 * t158;
  t165 = t93 * rho[0];
  t167 = 0.1e1 / t28 / t165;
  t168 = sigma[0] * t167;
  t171 = -0.8e1 / 0.3e1 * t168 * t71 + 0.8e1 / 0.3e1 * t168;
  t181 = t108 * rho[0];
  t185 = pow(rho[0], 0.833333333333333333e-1);
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t38 * t130 * t40 * t45 / 0.48e2 + t50 * t80 * t40 * t45 / 0.24e2 + t56 * t86 * t40 * t45 / 0.12e2 + t62 * t143 * t40 * t45 / 0.8e1 - t68 * t148 * sigma[0] * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * sigma[0] * t71 - t159 * t88 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t98 + t92 * t29 * t171 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t98 + t103 * t104 * t171 / 0.2e1 + t181 * t98 + t109 * t171 / 0.2e1 + 0.10225305054051679547e1 * t112 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t188 = 0.1e1 / t40;
  t214 = t95 * t71 - t95;
  tvsigma0 = t38 * t39 * t188 * t45 / 0.8e1 + t50 * t7 * t188 * t45 / 0.8e1 + t56 * t15 * t188 * t45 / 0.8e1 + t62 * t22 * t188 * t45 / 0.8e1 + t68 * t69 * t71 / 0.8e1 + t76 * t80 * t71 / 0.8e1 + t87 * t71 / 0.8e1 + t92 * t29 * t214 / 0.2e1 + t103 * t104 * t214 / 0.2e1 + t109 * t214 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t229 = 0.1e1 / t15;
  t233 = 0.1e1 / t129 / rho[0];
  t246 = 0.1e1 / t23;
  t251 = 0.1e1 / t165;
  t257 = 0.1e1 / t79 / t93;
  t263 = t85 * t95;
  t272 = t93 * t93;
  t274 = 0.1e1 / t28 / t272;
  t275 = sigma[0] * t274;
  t278 = 0.88e2 / 0.9e1 * t275 * t71 - 0.88e2 / 0.9e1 * t275;
  t282 = 0.1e1 / t7;
  t297 = pow(rho[0], -0.9166666666666666667e0);
  t300 = 0.5e1 / 0.36e2 * t263 * t88 + 0.5e1 / 0.9e1 * t92 * t229 * t98 + 0.5e1 / 0.3e1 * t92 * t28 * t171 + t92 * t29 * t278 / 0.2e1 + 0.55e2 / 0.72e2 * t103 * t282 * t98 + 0.11e2 / 0.6e1 * t103 * t79 * t171 + t103 * t104 * t278 / 0.2e1 + t108 * t98 + 0.2e1 * t181 * t171 + t109 * t278 / 0.2e1 + 0.85210875450430662858e-1 * t112 * t297;
  tv2rho20 = 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t143 + 0.5e1 / 0.9e1 * t27 * t229 - 0.11e2 / 0.576e3 * t38 * t233 * t40 * t45 - 0.5e1 / 0.144e3 * t50 * t153 * t40 * t45 - t56 * t158 * t40 * t45 / 0.18e2 - t62 * t246 * t40 * t45 / 0.16e2 + t68 * t251 * sigma[0] * t71 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t257 * sigma[0] * t71 + t300;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = -0.8e1 / 0.3e1 * t167 * t71 + 0.8e1 / 0.3e1 * t167;
  tv2rhosigma0 = t38 * t130 * t188 * t45 / 0.96e2 + t50 * t80 * t188 * t45 / 0.48e2 + t56 * t86 * t188 * t45 / 0.24e2 + t62 * t143 * t188 * t45 / 0.16e2 - t68 * t148 * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * t71 - t159 * t71 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t214 + t92 * t29 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t214 + t103 * t104 * t330 / 0.2e1 + t181 * t214 + t109 * t330 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t344 = 0.1e1 / t40 / sigma[0];
  tv2sigma20 = -t56 * t15 * t344 * t45 / 0.16e2 - t62 * t22 * t344 * t45 / 0.16e2 - t38 * t39 * t344 * t45 / 0.16e2 - t50 * t7 * t344 * t45 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t39, t40;
  double t43, t45, t50, t56, t62, t68, t69, t71;
  double t76, t77, t78, t79, t80, t85, t86, t87;
  double t88, t92, t93, t95, t96, t98, t103, t104;
  double t108, t109, t112, t113, t116, tzk0;

  double t125, t127, t128, t129, t130, t143, t148, t153;
  double t158, t159, t165, t167, t168, t171, t181, t185;
  double tvrho0, t188, t214, tvsigma0;

  double t229, t233, t246, t251, t257, t263, t272, t274;
  double t275, t278, t282, t297, t300, tv2rho20, t330, tv2rhosigma0;
  double t344, tv2sigma20;

  double t364, t369, t371, t372, t375, t379, t393, t398;
  double t403, t405, t413, t429, t440, t443, tv3rho30, t476;
  double tv3rho2sigma0, tv3rhosigma20, t510, t512, tv3sigma30;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = pow(0.2e1, 0.1e1 / 0.12e2);
  t34 = t33 * t33;
  t36 = t34 * t34;
  t38 = params->omega[4] * t36 * t34 * t33;
  t39 = pow(rho[0], 0.1e1 / 0.12e2);
  t40 = sqrt(sigma[0]);
  t43 = POW_1_3(p->zeta_threshold);
  t45 = my_piecewise3(0.1e1 <= p->zeta_threshold, t43 * p->zeta_threshold, 1);
  t50 = params->omega[5] * t20;
  t56 = params->omega[6] * t12;
  t62 = params->omega[7] * t2;
  t68 = params->omega[8] * t12;
  t69 = 0.1e1 / rho[0];
  t71 = t45 * t45;
  t76 = params->omega[9] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[10];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t71;
  t92 = params->omega[11] * t12;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t71 - t96;
  t103 = params->omega[12] * t2;
  t104 = t79 * rho[0];
  t108 = params->omega[13];
  t109 = t108 * t93;
  t112 = params->omega[18];
  t113 = pow(rho[0], 0.10833333333333333333e1);
  t116 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t38 * t39 * t40 * t45 / 0.4e1 + t50 * t7 * t40 * t45 / 0.4e1 + t56 * t15 * t40 * t45 / 0.4e1 + t62 * t22 * t40 * t45 / 0.4e1 + t68 * t69 * sigma[0] * t71 / 0.8e1 + t76 * t80 * sigma[0] * t71 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t29 * t98 / 0.2e1 + t103 * t104 * t98 / 0.2e1 + t109 * t98 / 0.2e1 + 0.94387431268169349665e0 * t112 * t113;
  tzk0 = t116 * t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t39 * t39;
  t127 = t125 * t125;
  t128 = t127 * t127;
  t129 = t128 * t125 * t39;
  t130 = 0.1e1 / t129;
  t143 = 0.1e1 / t22;
  t148 = 0.1e1 / t93;
  t153 = 0.1e1 / t104;
  t158 = 0.1e1 / t29;
  t159 = t85 * t158;
  t165 = t93 * rho[0];
  t167 = 0.1e1 / t28 / t165;
  t168 = sigma[0] * t167;
  t171 = -0.8e1 / 0.3e1 * t168 * t71 + 0.8e1 / 0.3e1 * t168;
  t181 = t108 * rho[0];
  t185 = pow(rho[0], 0.833333333333333333e-1);
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t38 * t130 * t40 * t45 / 0.48e2 + t50 * t80 * t40 * t45 / 0.24e2 + t56 * t86 * t40 * t45 / 0.12e2 + t62 * t143 * t40 * t45 / 0.8e1 - t68 * t148 * sigma[0] * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * sigma[0] * t71 - t159 * t88 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t98 + t92 * t29 * t171 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t98 + t103 * t104 * t171 / 0.2e1 + t181 * t98 + t109 * t171 / 0.2e1 + 0.10225305054051679547e1 * t112 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t188 = 0.1e1 / t40;
  t214 = t95 * t71 - t95;
  tvsigma0 = t38 * t39 * t188 * t45 / 0.8e1 + t50 * t7 * t188 * t45 / 0.8e1 + t56 * t15 * t188 * t45 / 0.8e1 + t62 * t22 * t188 * t45 / 0.8e1 + t68 * t69 * t71 / 0.8e1 + t76 * t80 * t71 / 0.8e1 + t87 * t71 / 0.8e1 + t92 * t29 * t214 / 0.2e1 + t103 * t104 * t214 / 0.2e1 + t109 * t214 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t229 = 0.1e1 / t15;
  t233 = 0.1e1 / t129 / rho[0];
  t246 = 0.1e1 / t23;
  t251 = 0.1e1 / t165;
  t257 = 0.1e1 / t79 / t93;
  t263 = t85 * t95;
  t272 = t93 * t93;
  t274 = 0.1e1 / t28 / t272;
  t275 = sigma[0] * t274;
  t278 = 0.88e2 / 0.9e1 * t275 * t71 - 0.88e2 / 0.9e1 * t275;
  t282 = 0.1e1 / t7;
  t297 = pow(rho[0], -0.9166666666666666667e0);
  t300 = 0.5e1 / 0.36e2 * t263 * t88 + 0.5e1 / 0.9e1 * t92 * t229 * t98 + 0.5e1 / 0.3e1 * t92 * t28 * t171 + t92 * t29 * t278 / 0.2e1 + 0.55e2 / 0.72e2 * t103 * t282 * t98 + 0.11e2 / 0.6e1 * t103 * t79 * t171 + t103 * t104 * t278 / 0.2e1 + t108 * t98 + 0.2e1 * t181 * t171 + t109 * t278 / 0.2e1 + 0.85210875450430662858e-1 * t112 * t297;
  tv2rho20 = 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t143 + 0.5e1 / 0.9e1 * t27 * t229 - 0.11e2 / 0.576e3 * t38 * t233 * t40 * t45 - 0.5e1 / 0.144e3 * t50 * t153 * t40 * t45 - t56 * t158 * t40 * t45 / 0.18e2 - t62 * t246 * t40 * t45 / 0.16e2 + t68 * t251 * sigma[0] * t71 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t257 * sigma[0] * t71 + t300;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = -0.8e1 / 0.3e1 * t167 * t71 + 0.8e1 / 0.3e1 * t167;
  tv2rhosigma0 = t38 * t130 * t188 * t45 / 0.96e2 + t50 * t80 * t188 * t45 / 0.48e2 + t56 * t86 * t188 * t45 / 0.24e2 + t62 * t143 * t188 * t45 / 0.16e2 - t68 * t148 * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * t71 - t159 * t71 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t214 + t92 * t29 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t214 + t103 * t104 * t330 / 0.2e1 + t181 * t214 + t109 * t330 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t344 = 0.1e1 / t40 / sigma[0];
  tv2sigma20 = -t56 * t15 * t344 * t45 / 0.16e2 - t62 * t22 * t344 * t45 / 0.16e2 - t38 * t39 * t344 * t45 / 0.16e2 - t50 * t7 * t344 * t45 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t364 = 0.1e1 / t16;
  t369 = t272 * rho[0];
  t371 = 0.1e1 / t28 / t369;
  t372 = sigma[0] * t371;
  t375 = -0.1232e4 / 0.27e2 * t372 * t71 + 0.1232e4 / 0.27e2 * t372;
  t379 = 0.1e1 / t129 / t93;
  t393 = 0.1e1 / t22 / t93;
  t398 = 0.1e1 / t272;
  t403 = -0.35e2 / 0.432e3 * t6 * t153 - 0.4e1 / 0.27e2 * t14 * t158 - 0.3e1 / 0.16e2 * t21 * t246 - 0.5e1 / 0.27e2 * t27 * t364 + 0.3e1 * t181 * t278 + t109 * t375 / 0.2e1 + 0.253e3 / 0.6912e4 * t38 * t379 * t40 * t45 + 0.55e2 / 0.864e3 * t50 * t257 * t40 * t45 + 0.5e1 / 0.54e2 * t56 * t95 * t40 * t45 + 0.3e1 / 0.32e2 * t62 * t393 * t40 * t45 - 0.3e1 / 0.4e1 * t68 * t398 * sigma[0] * t71;
  t405 = 0.1e1 / t79 / t165;
  t413 = 0.1e1 / t8;
  t429 = t85 * t167;
  t440 = pow(rho[0], -0.19166666666666666667e1);
  t443 = -0.935e3 / 0.1728e4 * t76 * t405 * sigma[0] * t71 - 0.5e1 / 0.27e2 * t92 * t364 * t98 - 0.55e2 / 0.432e3 * t103 * t413 * t98 + t92 * t29 * t375 / 0.2e1 + 0.55e2 / 0.24e2 * t103 * t282 * t171 + 0.11e2 / 0.4e1 * t103 * t79 * t278 + t103 * t104 * t375 / 0.2e1 - 0.1e2 / 0.27e2 * t429 * t88 + 0.5e1 / 0.3e1 * t92 * t229 * t171 + 0.5e1 / 0.2e1 * t92 * t28 * t278 + 0.3e1 * t108 * t171 - 0.78109969162894774289e-1 * t112 * t440;
  tv3rho30 = t403 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t476 = 0.88e2 / 0.9e1 * t274 * t71 - 0.88e2 / 0.9e1 * t274;
  tv3rho2sigma0 = -0.11e2 / 0.1152e4 * t38 * t233 * t188 * t45 - 0.5e1 / 0.288e3 * t50 * t153 * t188 * t45 - t56 * t158 * t188 * t45 / 0.36e2 - t62 * t246 * t188 * t45 / 0.32e2 + t68 * t251 * t71 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t257 * t71 + 0.5e1 / 0.36e2 * t263 * t71 + 0.5e1 / 0.9e1 * t92 * t229 * t214 + 0.5e1 / 0.3e1 * t92 * t28 * t330 + t92 * t29 * t476 / 0.2e1 + 0.55e2 / 0.72e2 * t103 * t282 * t214 + 0.11e2 / 0.6e1 * t103 * t79 * t330 + t103 * t104 * t476 / 0.2e1 + t108 * t214 + 0.2e1 * t181 * t330 + t109 * t476 / 0.2e1;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t38 * t130 * t344 * t45 / 0.192e3 - t50 * t80 * t344 * t45 / 0.96e2 - t56 * t86 * t344 * t45 / 0.48e2 - t62 * t143 * t344 * t45 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t510 = sigma[0] * sigma[0];
  t512 = 0.1e1 / t40 / t510;
  tv3sigma30 = 0.3e1 / 0.32e2 * t56 * t15 * t512 * t45 + 0.3e1 / 0.32e2 * t62 * t22 * t512 * t45 + 0.3e1 / 0.32e2 * t38 * t39 * t512 * t45 + 0.3e1 / 0.32e2 * t50 * t7 * t512 * t45;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t39, t40;
  double t43, t45, t50, t56, t62, t68, t69, t71;
  double t76, t77, t78, t79, t80, t85, t86, t87;
  double t88, t92, t93, t95, t96, t98, t103, t104;
  double t108, t109, t112, t113, t116, tzk0;

  double t125, t127, t128, t129, t130, t143, t148, t153;
  double t158, t159, t165, t167, t168, t171, t181, t185;
  double tvrho0, t188, t214, tvsigma0;

  double t229, t233, t246, t251, t257, t263, t272, t274;
  double t275, t278, t282, t297, t300, tv2rho20, t330, tv2rhosigma0;
  double t344, tv2sigma20;

  double t364, t369, t371, t372, t375, t379, t393, t398;
  double t403, t405, t413, t429, t440, t443, tv3rho30, t476;
  double tv3rho2sigma0, tv3rhosigma20, t510, t512, tv3sigma30;

  double t533, t541, t544, t549, t572, t619, tv4rho40, t655;
  double tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30, t711, tv4sigma40;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = pow(0.2e1, 0.1e1 / 0.12e2);
  t34 = t33 * t33;
  t36 = t34 * t34;
  t38 = params->omega[4] * t36 * t34 * t33;
  t39 = pow(rho[0], 0.1e1 / 0.12e2);
  t40 = sqrt(sigma[0]);
  t43 = POW_1_3(p->zeta_threshold);
  t45 = my_piecewise3(0.1e1 <= p->zeta_threshold, t43 * p->zeta_threshold, 1);
  t50 = params->omega[5] * t20;
  t56 = params->omega[6] * t12;
  t62 = params->omega[7] * t2;
  t68 = params->omega[8] * t12;
  t69 = 0.1e1 / rho[0];
  t71 = t45 * t45;
  t76 = params->omega[9] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[10];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t71;
  t92 = params->omega[11] * t12;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t71 - t96;
  t103 = params->omega[12] * t2;
  t104 = t79 * rho[0];
  t108 = params->omega[13];
  t109 = t108 * t93;
  t112 = params->omega[18];
  t113 = pow(rho[0], 0.10833333333333333333e1);
  t116 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t38 * t39 * t40 * t45 / 0.4e1 + t50 * t7 * t40 * t45 / 0.4e1 + t56 * t15 * t40 * t45 / 0.4e1 + t62 * t22 * t40 * t45 / 0.4e1 + t68 * t69 * sigma[0] * t71 / 0.8e1 + t76 * t80 * sigma[0] * t71 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t29 * t98 / 0.2e1 + t103 * t104 * t98 / 0.2e1 + t109 * t98 / 0.2e1 + 0.94387431268169349665e0 * t112 * t113;
  tzk0 = t116 * t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t39 * t39;
  t127 = t125 * t125;
  t128 = t127 * t127;
  t129 = t128 * t125 * t39;
  t130 = 0.1e1 / t129;
  t143 = 0.1e1 / t22;
  t148 = 0.1e1 / t93;
  t153 = 0.1e1 / t104;
  t158 = 0.1e1 / t29;
  t159 = t85 * t158;
  t165 = t93 * rho[0];
  t167 = 0.1e1 / t28 / t165;
  t168 = sigma[0] * t167;
  t171 = -0.8e1 / 0.3e1 * t168 * t71 + 0.8e1 / 0.3e1 * t168;
  t181 = t108 * rho[0];
  t185 = pow(rho[0], 0.833333333333333333e-1);
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t38 * t130 * t40 * t45 / 0.48e2 + t50 * t80 * t40 * t45 / 0.24e2 + t56 * t86 * t40 * t45 / 0.12e2 + t62 * t143 * t40 * t45 / 0.8e1 - t68 * t148 * sigma[0] * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * sigma[0] * t71 - t159 * t88 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t98 + t92 * t29 * t171 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t98 + t103 * t104 * t171 / 0.2e1 + t181 * t98 + t109 * t171 / 0.2e1 + 0.10225305054051679547e1 * t112 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t188 = 0.1e1 / t40;
  t214 = t95 * t71 - t95;
  tvsigma0 = t38 * t39 * t188 * t45 / 0.8e1 + t50 * t7 * t188 * t45 / 0.8e1 + t56 * t15 * t188 * t45 / 0.8e1 + t62 * t22 * t188 * t45 / 0.8e1 + t68 * t69 * t71 / 0.8e1 + t76 * t80 * t71 / 0.8e1 + t87 * t71 / 0.8e1 + t92 * t29 * t214 / 0.2e1 + t103 * t104 * t214 / 0.2e1 + t109 * t214 / 0.2e1;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t229 = 0.1e1 / t15;
  t233 = 0.1e1 / t129 / rho[0];
  t246 = 0.1e1 / t23;
  t251 = 0.1e1 / t165;
  t257 = 0.1e1 / t79 / t93;
  t263 = t85 * t95;
  t272 = t93 * t93;
  t274 = 0.1e1 / t28 / t272;
  t275 = sigma[0] * t274;
  t278 = 0.88e2 / 0.9e1 * t275 * t71 - 0.88e2 / 0.9e1 * t275;
  t282 = 0.1e1 / t7;
  t297 = pow(rho[0], -0.9166666666666666667e0);
  t300 = 0.5e1 / 0.36e2 * t263 * t88 + 0.5e1 / 0.9e1 * t92 * t229 * t98 + 0.5e1 / 0.3e1 * t92 * t28 * t171 + t92 * t29 * t278 / 0.2e1 + 0.55e2 / 0.72e2 * t103 * t282 * t98 + 0.11e2 / 0.6e1 * t103 * t79 * t171 + t103 * t104 * t278 / 0.2e1 + t108 * t98 + 0.2e1 * t181 * t171 + t109 * t278 / 0.2e1 + 0.85210875450430662858e-1 * t112 * t297;
  tv2rho20 = 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t143 + 0.5e1 / 0.9e1 * t27 * t229 - 0.11e2 / 0.576e3 * t38 * t233 * t40 * t45 - 0.5e1 / 0.144e3 * t50 * t153 * t40 * t45 - t56 * t158 * t40 * t45 / 0.18e2 - t62 * t246 * t40 * t45 / 0.16e2 + t68 * t251 * sigma[0] * t71 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t257 * sigma[0] * t71 + t300;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = -0.8e1 / 0.3e1 * t167 * t71 + 0.8e1 / 0.3e1 * t167;
  tv2rhosigma0 = t38 * t130 * t188 * t45 / 0.96e2 + t50 * t80 * t188 * t45 / 0.48e2 + t56 * t86 * t188 * t45 / 0.24e2 + t62 * t143 * t188 * t45 / 0.16e2 - t68 * t148 * t71 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t153 * t71 - t159 * t71 / 0.12e2 + 0.5e1 / 0.6e1 * t92 * t28 * t214 + t92 * t29 * t330 / 0.2e1 + 0.11e2 / 0.12e2 * t103 * t79 * t214 + t103 * t104 * t330 / 0.2e1 + t181 * t214 + t109 * t330 / 0.2e1;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t344 = 0.1e1 / t40 / sigma[0];
  tv2sigma20 = -t56 * t15 * t344 * t45 / 0.16e2 - t62 * t22 * t344 * t45 / 0.16e2 - t38 * t39 * t344 * t45 / 0.16e2 - t50 * t7 * t344 * t45 / 0.16e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t364 = 0.1e1 / t16;
  t369 = t272 * rho[0];
  t371 = 0.1e1 / t28 / t369;
  t372 = sigma[0] * t371;
  t375 = -0.1232e4 / 0.27e2 * t372 * t71 + 0.1232e4 / 0.27e2 * t372;
  t379 = 0.1e1 / t129 / t93;
  t393 = 0.1e1 / t22 / t93;
  t398 = 0.1e1 / t272;
  t403 = -0.35e2 / 0.432e3 * t6 * t153 - 0.4e1 / 0.27e2 * t14 * t158 - 0.3e1 / 0.16e2 * t21 * t246 - 0.5e1 / 0.27e2 * t27 * t364 + 0.3e1 * t181 * t278 + t109 * t375 / 0.2e1 + 0.253e3 / 0.6912e4 * t38 * t379 * t40 * t45 + 0.55e2 / 0.864e3 * t50 * t257 * t40 * t45 + 0.5e1 / 0.54e2 * t56 * t95 * t40 * t45 + 0.3e1 / 0.32e2 * t62 * t393 * t40 * t45 - 0.3e1 / 0.4e1 * t68 * t398 * sigma[0] * t71;
  t405 = 0.1e1 / t79 / t165;
  t413 = 0.1e1 / t8;
  t429 = t85 * t167;
  t440 = pow(rho[0], -0.19166666666666666667e1);
  t443 = -0.935e3 / 0.1728e4 * t76 * t405 * sigma[0] * t71 - 0.5e1 / 0.27e2 * t92 * t364 * t98 - 0.55e2 / 0.432e3 * t103 * t413 * t98 + t92 * t29 * t375 / 0.2e1 + 0.55e2 / 0.24e2 * t103 * t282 * t171 + 0.11e2 / 0.4e1 * t103 * t79 * t278 + t103 * t104 * t375 / 0.2e1 - 0.1e2 / 0.27e2 * t429 * t88 + 0.5e1 / 0.3e1 * t92 * t229 * t171 + 0.5e1 / 0.2e1 * t92 * t28 * t278 + 0.3e1 * t108 * t171 - 0.78109969162894774289e-1 * t112 * t440;
  tv3rho30 = t403 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t476 = 0.88e2 / 0.9e1 * t274 * t71 - 0.88e2 / 0.9e1 * t274;
  tv3rho2sigma0 = -0.11e2 / 0.1152e4 * t38 * t233 * t188 * t45 - 0.5e1 / 0.288e3 * t50 * t153 * t188 * t45 - t56 * t158 * t188 * t45 / 0.36e2 - t62 * t246 * t188 * t45 / 0.32e2 + t68 * t251 * t71 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t257 * t71 + 0.5e1 / 0.36e2 * t263 * t71 + 0.5e1 / 0.9e1 * t92 * t229 * t214 + 0.5e1 / 0.3e1 * t92 * t28 * t330 + t92 * t29 * t476 / 0.2e1 + 0.55e2 / 0.72e2 * t103 * t282 * t214 + 0.11e2 / 0.6e1 * t103 * t79 * t330 + t103 * t104 * t476 / 0.2e1 + t108 * t214 + 0.2e1 * t181 * t330 + t109 * t476 / 0.2e1;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t38 * t130 * t344 * t45 / 0.192e3 - t50 * t80 * t344 * t45 / 0.96e2 - t56 * t86 * t344 * t45 / 0.48e2 - t62 * t143 * t344 * t45 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t510 = sigma[0] * sigma[0];
  t512 = 0.1e1 / t40 / t510;
  tv3sigma30 = 0.3e1 / 0.32e2 * t56 * t15 * t512 * t45 + 0.3e1 / 0.32e2 * t62 * t22 * t512 * t45 + 0.3e1 / 0.32e2 * t38 * t39 * t512 * t45 + 0.3e1 / 0.32e2 * t50 * t7 * t512 * t45;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t533 = 0.1e1 / t15 / t93;
  t541 = sigma[0] / t28 / t272 / t93;
  t544 = 0.20944e5 / 0.81e2 * t541 * t71 - 0.20944e5 / 0.81e2 * t541;
  t549 = pow(rho[0], -0.29166666666666666667e1);
  t572 = 0.385e3 / 0.2592e4 * t6 * t257 + 0.2e2 / 0.81e2 * t14 * t95 + 0.9e1 / 0.32e2 * t21 * t393 + 0.2e2 / 0.81e2 * t27 * t533 + 0.4e1 * t181 * t375 + t109 * t544 / 0.2e1 + 0.6e1 * t108 * t278 + 0.14971077422888165072e0 * t112 * t549 - 0.8855e4 / 0.82944e5 * t38 / t129 / t165 * t40 * t45 - 0.935e3 / 0.5184e4 * t50 * t405 * t40 * t45 - 0.2e2 / 0.81e2 * t56 * t167 * t40 * t45 - 0.15e2 / 0.64e2 * t62 / t22 / t165 * t40 * t45;
  t619 = 0.3e1 * t68 / t369 * sigma[0] * t71 + 0.21505e5 / 0.10368e5 * t76 / t79 / t272 * sigma[0] * t71 + 0.2e2 / 0.81e2 * t92 * t533 * t98 + 0.385e3 / 0.2592e4 * t103 / t7 / t93 * t98 + 0.1e2 / 0.3e1 * t92 * t28 * t375 - 0.2e2 / 0.27e2 * t92 * t364 * t171 - 0.55e2 / 0.108e3 * t103 * t413 * t171 + t92 * t29 * t544 / 0.2e1 + 0.55e2 / 0.12e2 * t103 * t282 * t278 + 0.11e2 / 0.3e1 * t103 * t79 * t375 + t103 * t104 * t544 / 0.2e1 + 0.11e3 / 0.81e2 * t85 * t274 * t88 + 0.1e2 / 0.3e1 * t92 * t229 * t278;
  tv4rho40 = t572 + t619;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t655 = -0.1232e4 / 0.27e2 * t371 * t71 + 0.1232e4 / 0.27e2 * t371;
  tv4rho3sigma0 = 0.253e3 / 0.13824e5 * t38 * t379 * t188 * t45 + 0.55e2 / 0.1728e4 * t50 * t257 * t188 * t45 + 0.5e1 / 0.108e3 * t56 * t95 * t188 * t45 + 0.3e1 / 0.64e2 * t62 * t393 * t188 * t45 - 0.3e1 / 0.4e1 * t68 * t398 * t71 - 0.935e3 / 0.1728e4 * t76 * t405 * t71 - 0.1e2 / 0.27e2 * t429 * t71 - 0.5e1 / 0.27e2 * t92 * t364 * t214 + 0.5e1 / 0.3e1 * t92 * t229 * t330 + 0.5e1 / 0.2e1 * t92 * t28 * t476 + t92 * t29 * t655 / 0.2e1 - 0.55e2 / 0.432e3 * t103 * t413 * t214 + 0.55e2 / 0.24e2 * t103 * t282 * t330 + 0.11e2 / 0.4e1 * t103 * t79 * t476 + t103 * t104 * t655 / 0.2e1 + 0.3e1 * t108 * t330 + 0.3e1 * t181 * t476 + t109 * t655 / 0.2e1;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.11e2 / 0.2304e4 * t38 * t233 * t344 * t45 + 0.5e1 / 0.576e3 * t50 * t153 * t344 * t45 + t56 * t158 * t344 * t45 / 0.72e2 + t62 * t246 * t344 * t45 / 0.64e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = t38 * t130 * t512 * t45 / 0.128e3 + t50 * t80 * t512 * t45 / 0.64e2 + t56 * t86 * t512 * t45 / 0.32e2 + 0.3e1 / 0.64e2 * t62 * t143 * t512 * t45;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t711 = 0.1e1 / t40 / t510 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.64e2 * t56 * t15 * t711 * t45 - 0.15e2 / 0.64e2 * t62 * t22 * t711 * t45 - 0.15e2 / 0.64e2 * t38 * t39 * t711 * t45 - 0.15e2 / 0.64e2 * t50 * t7 * t711 * t45;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t38, t41, t42, t43, t44, t45, t46, t47;
  double t48, t49, t50, t51, t52, t53, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t65;
  double t67, t68, t71, t74, t75, t78, t79, t82;
  double t83, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t95, t96, t97, t99, t100, t101;
  double t102, t103, t104, t106, t107, t108, t109, t110;
  double t112, t115, t116, t119, t120, t121, t124, t125;
  double t129, t130, t131, t132, t134, t136, t138, t139;
  double t141, t142, t144, t145, t146, t147, t148, t150;
  double t151, t153, t154, t156, t157, t159, t160, t161;
  double t164, tzk0;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = pow(rho[0], 0.1e1 / 0.12e2);
  t31 = t30 * t30;
  t32 = t31 * t31;
  t33 = t32 * t30;
  t35 = pow(rho[1], 0.1e1 / 0.12e2);
  t36 = t35 * t35;
  t37 = t36 * t36;
  t38 = t37 * t35;
  t41 = t29 * (t33 * rho[0] + t38 * rho[1]);
  t42 = sqrt(sigma[0]);
  t43 = 0.1e1 / t10;
  t44 = t42 * t43;
  t45 = rho[0] - rho[1];
  t46 = rho[0] + rho[1];
  t47 = 0.1e1 / t46;
  t48 = t45 * t47;
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * p->zeta_threshold;
  t53 = POW_1_3(t49);
  t55 = my_piecewise3(t50, t52, t53 * t49);
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = t55 * t57;
  t60 = sqrt(sigma[2]);
  t61 = 0.1e1 / t12;
  t62 = t60 * t61;
  t63 = 0.1e1 - t48;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t52, t65 * t63);
  t68 = t67 * t57;
  t71 = t44 * t58 / 0.4e1 + t62 * t68 / 0.4e1;
  t74 = params->omega[5];
  t75 = t74 * t20;
  t78 = params->omega[6];
  t79 = t78 * t27;
  t82 = params->omega[7];
  t83 = t2 * t2;
  t84 = t83 * t83;
  t85 = t84 * t2;
  t86 = t85 * rho[0];
  t87 = t4 * t4;
  t88 = t87 * t87;
  t89 = t88 * t4;
  t90 = t89 * rho[1];
  t91 = t86 + t90;
  t92 = t82 * t91;
  t95 = params->omega[8];
  t96 = t95 * t27;
  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t23 / t97;
  t100 = sigma[0] * t99;
  t101 = t55 * t55;
  t102 = t101 * t56;
  t103 = t100 * t102;
  t104 = rho[1] * rho[1];
  t106 = 0.1e1 / t25 / t104;
  t107 = sigma[2] * t106;
  t108 = t67 * t67;
  t109 = t108 * t56;
  t110 = t107 * t109;
  t112 = t103 / 0.8e1 + t110 / 0.8e1;
  t115 = params->omega[9];
  t116 = t115 * t91;
  t119 = params->omega[10];
  t120 = t97 + t104;
  t121 = t119 * t120;
  t124 = params->omega[11];
  t125 = t124 * t27;
  t129 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t130 = t46 * t46;
  t131 = POW_1_3(t46);
  t132 = t131 * t131;
  t134 = 0.1e1 / t132 / t130;
  t136 = t103 / 0.4e1 + t110 / 0.4e1 - t129 * t134;
  t138 = params->omega[12];
  t139 = t138 * t91;
  t141 = params->omega[13];
  t142 = t141 * t120;
  t144 = params->omega[14];
  t145 = t144 * t6;
  t146 = t45 * t45;
  t147 = 0.1e1 / t130;
  t148 = t146 * t147;
  t150 = params->omega[15];
  t151 = t150 * t13;
  t153 = params->omega[16];
  t154 = t153 * t20;
  t156 = params->omega[17];
  t157 = t156 * t27;
  t159 = params->omega[18];
  t160 = pow(rho[0], 0.10833333333333333333e1);
  t161 = pow(rho[1], 0.10833333333333333333e1);
  t164 = t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t41 * t71 / 0.2e1 + t75 * t71 / 0.2e1 + t79 * t71 / 0.2e1 + t92 * t71 / 0.2e1 + t96 * t112 / 0.2e1 + t116 * t112 / 0.2e1 + t121 * t112 / 0.2e1 + t125 * t136 + t139 * t136 + t142 * t136 + t145 * t148 + t151 * t148 + t154 * t148 + t157 * t148 + t159 * (t160 + t161);
  tzk0 = t164 * t47;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t38, t41, t42, t43, t44, t45, t46, t47;
  double t48, t49, t50, t51, t52, t53, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t65;
  double t67, t68, t71, t74, t75, t78, t79, t82;
  double t83, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t95, t96, t97, t99, t100, t101;
  double t102, t103, t104, t106, t107, t108, t109, t110;
  double t112, t115, t116, t119, t120, t121, t124, t125;
  double t129, t130, t131, t132, t134, t136, t138, t139;
  double t141, t142, t144, t145, t146, t147, t148, t150;
  double t151, t153, t154, t156, t157, t159, t160, t161;
  double t164, tzk0;

  double t173, t177, t178, t181, t182, t185, t186, t189;
  double t192, t193, t196, t199, t204, t209, t214, t217;
  double t219, t220, t221, t223, t224, t225, t227, t228;
  double t229, t231, t234, t239, t244, t245, t250, t252;
  double t254, t255, t257, t261, t265, t268, t269, t271;
  double t273, t275, t277, t279, t281, t283, t285, t286;
  double t289, t292, t295, t298, tvrho0, t307, t310, t313;
  double t314, t318, t319, t322, t325, t326, t329, t332;
  double t337, t342, t347, t350, t351, t353, t355, t356;
  double t357, t359, t360, t362, t365, t370, t375, t376;
  double t381, t383, t387, t391, t394, t397, t400, t403;
  double t406, tvrho1, t407, t408, t410, t413, t416, t419;
  double t423, t431, tvsigma0, tvsigma1, t439, t440, t442, t445;
  double t448, t451, t455, t463, tvsigma2;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = pow(rho[0], 0.1e1 / 0.12e2);
  t31 = t30 * t30;
  t32 = t31 * t31;
  t33 = t32 * t30;
  t35 = pow(rho[1], 0.1e1 / 0.12e2);
  t36 = t35 * t35;
  t37 = t36 * t36;
  t38 = t37 * t35;
  t41 = t29 * (t33 * rho[0] + t38 * rho[1]);
  t42 = sqrt(sigma[0]);
  t43 = 0.1e1 / t10;
  t44 = t42 * t43;
  t45 = rho[0] - rho[1];
  t46 = rho[0] + rho[1];
  t47 = 0.1e1 / t46;
  t48 = t45 * t47;
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * p->zeta_threshold;
  t53 = POW_1_3(t49);
  t55 = my_piecewise3(t50, t52, t53 * t49);
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = t55 * t57;
  t60 = sqrt(sigma[2]);
  t61 = 0.1e1 / t12;
  t62 = t60 * t61;
  t63 = 0.1e1 - t48;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t52, t65 * t63);
  t68 = t67 * t57;
  t71 = t44 * t58 / 0.4e1 + t62 * t68 / 0.4e1;
  t74 = params->omega[5];
  t75 = t74 * t20;
  t78 = params->omega[6];
  t79 = t78 * t27;
  t82 = params->omega[7];
  t83 = t2 * t2;
  t84 = t83 * t83;
  t85 = t84 * t2;
  t86 = t85 * rho[0];
  t87 = t4 * t4;
  t88 = t87 * t87;
  t89 = t88 * t4;
  t90 = t89 * rho[1];
  t91 = t86 + t90;
  t92 = t82 * t91;
  t95 = params->omega[8];
  t96 = t95 * t27;
  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t23 / t97;
  t100 = sigma[0] * t99;
  t101 = t55 * t55;
  t102 = t101 * t56;
  t103 = t100 * t102;
  t104 = rho[1] * rho[1];
  t106 = 0.1e1 / t25 / t104;
  t107 = sigma[2] * t106;
  t108 = t67 * t67;
  t109 = t108 * t56;
  t110 = t107 * t109;
  t112 = t103 / 0.8e1 + t110 / 0.8e1;
  t115 = params->omega[9];
  t116 = t115 * t91;
  t119 = params->omega[10];
  t120 = t97 + t104;
  t121 = t119 * t120;
  t124 = params->omega[11];
  t125 = t124 * t27;
  t129 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t130 = t46 * t46;
  t131 = POW_1_3(t46);
  t132 = t131 * t131;
  t134 = 0.1e1 / t132 / t130;
  t136 = t103 / 0.4e1 + t110 / 0.4e1 - t129 * t134;
  t138 = params->omega[12];
  t139 = t138 * t91;
  t141 = params->omega[13];
  t142 = t141 * t120;
  t144 = params->omega[14];
  t145 = t144 * t6;
  t146 = t45 * t45;
  t147 = 0.1e1 / t130;
  t148 = t146 * t147;
  t150 = params->omega[15];
  t151 = t150 * t13;
  t153 = params->omega[16];
  t154 = t153 * t20;
  t156 = params->omega[17];
  t157 = t156 * t27;
  t159 = params->omega[18];
  t160 = pow(rho[0], 0.10833333333333333333e1);
  t161 = pow(rho[1], 0.10833333333333333333e1);
  t164 = t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t41 * t71 / 0.2e1 + t75 * t71 / 0.2e1 + t79 * t71 / 0.2e1 + t92 * t71 / 0.2e1 + t96 * t112 / 0.2e1 + t116 * t112 / 0.2e1 + t121 * t112 / 0.2e1 + t125 * t136 + t139 * t136 + t142 * t136 + t145 * t148 + t151 * t148 + t154 * t148 + t157 * t148 + t159 * (t160 + t161);
  tzk0 = t164 * t47;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t173 = pow(rho[0], 0.833333333333333333e-1);
  t177 = 0.1e1 / t9 / t97;
  t178 = t42 * t177;
  t181 = t45 * t147;
  t182 = t47 - t181;
  t185 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t182);
  t186 = t185 * t57;
  t189 = -t182;
  t192 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t189);
  t193 = t192 * t57;
  t196 = -t178 * t58 / 0.3e1 + t44 * t186 / 0.4e1 + t62 * t193 / 0.4e1;
  t199 = t29 * t33;
  t204 = t74 * t16;
  t209 = t78 * t23;
  t214 = t82 * t85;
  t217 = t97 * rho[0];
  t219 = 0.1e1 / t23 / t217;
  t220 = sigma[0] * t219;
  t221 = t220 * t102;
  t223 = t55 * t56;
  t224 = t223 * t185;
  t225 = t100 * t224;
  t227 = t67 * t56;
  t228 = t227 * t192;
  t229 = t107 * t228;
  t231 = -t221 / 0.3e1 + t225 / 0.4e1 + t229 / 0.4e1;
  t234 = t95 * t23;
  t239 = t115 * t85;
  t244 = 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.10833333333333333333e1 * t159 * t173 + t41 * t196 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t71 + t75 * t196 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t71 + t79 * t196 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t71 + t92 * t196 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t71 + t96 * t231 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t112 + t116 * t231 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t112 + t121 * t231 / 0.2e1;
  t245 = t119 * rho[0];
  t250 = t130 * t46;
  t252 = 0.1e1 / t132 / t250;
  t254 = 0.8e1 / 0.3e1 * t129 * t252;
  t255 = -0.2e1 / 0.3e1 * t221 + t225 / 0.2e1 + t229 / 0.2e1 + t254;
  t257 = t124 * t23;
  t261 = t138 * t85;
  t265 = t141 * rho[0];
  t268 = 0.1e1 / t250;
  t269 = t146 * t268;
  t271 = 0.2e1 * t145 * t269;
  t273 = 0.2e1 * t151 * t181;
  t275 = 0.2e1 * t151 * t269;
  t277 = 0.2e1 * t154 * t181;
  t279 = 0.2e1 * t154 * t269;
  t281 = 0.2e1 * t157 * t181;
  t283 = 0.2e1 * t157 * t269;
  t285 = 0.2e1 * t145 * t181;
  t286 = t144 * t2;
  t289 = t150 * t9;
  t292 = t153 * t16;
  t295 = t156 * t23;
  t298 = t245 * t112 + t125 * t255 + 0.5e1 / 0.3e1 * t257 * t136 + t139 * t255 + 0.11e2 / 0.6e1 * t261 * t136 + t142 * t255 + 0.2e1 * t265 * t136 - t271 + t273 - t275 + t277 - t279 + t281 - t283 + t285 + 0.7e1 / 0.6e1 * t286 * t148 + 0.4e1 / 0.3e1 * t289 * t148 + 0.3e1 / 0.2e1 * t292 * t148 + 0.5e1 / 0.3e1 * t295 * t148;
  tvrho0 = t244 + t298;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t307 = pow(rho[1], 0.833333333333333333e-1);
  t310 = -t47 - t181;
  t313 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t310);
  t314 = t313 * t57;
  t318 = 0.1e1 / t11 / t104;
  t319 = t60 * t318;
  t322 = -t310;
  t325 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t322);
  t326 = t325 * t57;
  t329 = t44 * t314 / 0.4e1 - t319 * t68 / 0.3e1 + t62 * t326 / 0.4e1;
  t332 = t29 * t38;
  t337 = t74 * t18;
  t342 = t78 * t25;
  t347 = t82 * t89;
  t350 = t223 * t313;
  t351 = t100 * t350;
  t353 = t104 * rho[1];
  t355 = 0.1e1 / t25 / t353;
  t356 = sigma[2] * t355;
  t357 = t356 * t109;
  t359 = t227 * t325;
  t360 = t107 * t359;
  t362 = t351 / 0.4e1 - t357 / 0.3e1 + t360 / 0.4e1;
  t365 = t95 * t25;
  t370 = t115 * t89;
  t375 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.10833333333333333333e1 * t159 * t307 + t41 * t329 / 0.2e1 + 0.17e2 / 0.24e2 * t332 * t71 + t75 * t329 / 0.2e1 + 0.3e1 / 0.4e1 * t337 * t71 + t79 * t329 / 0.2e1 + 0.5e1 / 0.6e1 * t342 * t71 + t92 * t329 / 0.2e1 + 0.11e2 / 0.12e2 * t347 * t71 + t96 * t362 / 0.2e1 + 0.5e1 / 0.6e1 * t365 * t112 + t116 * t362 / 0.2e1 + 0.11e2 / 0.12e2 * t370 * t112 + t121 * t362 / 0.2e1;
  t376 = t119 * rho[1];
  t381 = t351 / 0.2e1 - 0.2e1 / 0.3e1 * t357 + t360 / 0.2e1 + t254;
  t383 = t124 * t25;
  t387 = t138 * t89;
  t391 = t141 * rho[1];
  t394 = t144 * t4;
  t397 = t150 * t11;
  t400 = t153 * t18;
  t403 = t156 * t25;
  t406 = t376 * t112 + t125 * t381 + 0.5e1 / 0.3e1 * t383 * t136 + t139 * t381 + 0.11e2 / 0.6e1 * t387 * t136 + t142 * t381 + 0.2e1 * t391 * t136 - t271 - t273 - t275 - t277 - t279 - t281 - t283 + 0.7e1 / 0.6e1 * t394 * t148 + 0.4e1 / 0.3e1 * t397 * t148 + 0.3e1 / 0.2e1 * t400 * t148 + 0.5e1 / 0.3e1 * t403 * t148 - t285;
  tvrho1 = t375 + t406;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t407 = 0.1e1 / t42;
  t408 = t41 * t407;
  t410 = t43 * t55 * t57;
  t413 = t75 * t407;
  t416 = t79 * t407;
  t419 = t92 * t407;
  t423 = t99 * t101 * t56;
  t431 = t423 / 0.4e1 - t134;
  tvsigma0 = t408 * t410 / 0.16e2 + t413 * t410 / 0.16e2 + t416 * t410 / 0.16e2 + t419 * t410 / 0.16e2 + t96 * t423 / 0.16e2 + t116 * t423 / 0.16e2 + t121 * t423 / 0.16e2 + t125 * t431 + t139 * t431 + t142 * t431;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t125 * t134 - 0.2e1 * t139 * t134 - 0.2e1 * t142 * t134;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.1e1 / t60;
  t440 = t41 * t439;
  t442 = t61 * t67 * t57;
  t445 = t75 * t439;
  t448 = t79 * t439;
  t451 = t92 * t439;
  t455 = t106 * t108 * t56;
  t463 = t455 / 0.4e1 - t134;
  tvsigma2 = t440 * t442 / 0.16e2 + t445 * t442 / 0.16e2 + t448 * t442 / 0.16e2 + t451 * t442 / 0.16e2 + t96 * t455 / 0.16e2 + t116 * t455 / 0.16e2 + t121 * t455 / 0.16e2 + t125 * t463 + t139 * t463 + t142 * t463;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t38, t41, t42, t43, t44, t45, t46, t47;
  double t48, t49, t50, t51, t52, t53, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t65;
  double t67, t68, t71, t74, t75, t78, t79, t82;
  double t83, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t95, t96, t97, t99, t100, t101;
  double t102, t103, t104, t106, t107, t108, t109, t110;
  double t112, t115, t116, t119, t120, t121, t124, t125;
  double t129, t130, t131, t132, t134, t136, t138, t139;
  double t141, t142, t144, t145, t146, t147, t148, t150;
  double t151, t153, t154, t156, t157, t159, t160, t161;
  double t164, tzk0;

  double t173, t177, t178, t181, t182, t185, t186, t189;
  double t192, t193, t196, t199, t204, t209, t214, t217;
  double t219, t220, t221, t223, t224, t225, t227, t228;
  double t229, t231, t234, t239, t244, t245, t250, t252;
  double t254, t255, t257, t261, t265, t268, t269, t271;
  double t273, t275, t277, t279, t281, t283, t285, t286;
  double t289, t292, t295, t298, tvrho0, t307, t310, t313;
  double t314, t318, t319, t322, t325, t326, t329, t332;
  double t337, t342, t347, t350, t351, t353, t355, t356;
  double t357, t359, t360, t362, t365, t370, t375, t376;
  double t381, t383, t387, t391, t394, t397, t400, t403;
  double t406, tvrho1, t407, t408, t410, t413, t416, t419;
  double t423, t431, tvsigma0, tvsigma1, t439, t440, t442, t445;
  double t448, t451, t455, t463, tvsigma2;

  double t467, t469, t471, t472, t477, t478, t479, t482;
  double t484, t488, t489, t492, t493, t494, t497, t501;
  double t502, t505, t522, t524, t525, t526, t528, t530;
  double t531, t532, t534, t535, t537, t538, t539, t541;
  double t542, t544, t553, t564, t566, t568, t569, t579;
  double t580, t582, t585, t586, t589, t590, t593, t594;
  double t597, t600, t603, t606, t608, t612, t614, t615;
  double t616, t619, t621, t623, t624, t627, t629, t631;
  double t634, t636, t638, t641, t643, t645, t647, t648;
  double t649, t651, t653, t655, t657, t659, t661, t663;
  double t672, t676, t678, t679, tv2rho20, t681, t683, t685;
  double t687, t689, t691, t693, t695, t700, t708, t711;
  double t715, t716, t721, t724, t728, t729, t732, t739;
  double t759, t761, t762, t763, t765, t766, t768, t770;
  double t771, t772, t774, t775, t777, t786, t801, t817;
  double tv2rho21, t827, t828, t829, t832, t833, t836, t837;
  double t840, t841, t852, t855, t857, t861, t865, t866;
  double t870, t871, t876, t879, t883, t884, t887, t904;
  double t905, t906, t908, t909, t911, t913, t914, t915;
  double t917, t919, t920, t921, t923, t924, t926, t937;
  double t946, t956, t957, t959, t962, t965, t968, t969;
  double t972, t975, t978, t981, t984, tv2rho22, t987, t996;
  double t999, t1002, t1006, t1016, t1019, t1020, t1023, t1024;
  double t1025, t1028, t1029, t1031, t1033, t1036, t1039, t1042;
  double t1046, t1054, t1057, t1058, t1068, tv2rhosigma0, t1072, t1076;
  double t1080, tv2rhosigma1, t1081, t1085, t1088, t1093, t1098, t1105;
  double t1110, t1115, t1120, t1123, tv2rhosigma2, t1131, t1135, t1138;
  double t1143, t1148, t1167, t1170, tv2rhosigma3, tv2rhosigma4, t1185, t1201;
  double t1211, t1214, t1215, t1218, t1219, t1220, t1224, t1231;
  double t1232, t1234, t1236, t1239, t1242, t1245, t1249, t1252;
  double t1262, tv2rhosigma5, t1264, t1265, t1267, t1269, t1271, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1275, t1276, t1278, t1280;
  double t1282, tv2sigma25;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = pow(rho[0], 0.1e1 / 0.12e2);
  t31 = t30 * t30;
  t32 = t31 * t31;
  t33 = t32 * t30;
  t35 = pow(rho[1], 0.1e1 / 0.12e2);
  t36 = t35 * t35;
  t37 = t36 * t36;
  t38 = t37 * t35;
  t41 = t29 * (t33 * rho[0] + t38 * rho[1]);
  t42 = sqrt(sigma[0]);
  t43 = 0.1e1 / t10;
  t44 = t42 * t43;
  t45 = rho[0] - rho[1];
  t46 = rho[0] + rho[1];
  t47 = 0.1e1 / t46;
  t48 = t45 * t47;
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * p->zeta_threshold;
  t53 = POW_1_3(t49);
  t55 = my_piecewise3(t50, t52, t53 * t49);
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = t55 * t57;
  t60 = sqrt(sigma[2]);
  t61 = 0.1e1 / t12;
  t62 = t60 * t61;
  t63 = 0.1e1 - t48;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t52, t65 * t63);
  t68 = t67 * t57;
  t71 = t44 * t58 / 0.4e1 + t62 * t68 / 0.4e1;
  t74 = params->omega[5];
  t75 = t74 * t20;
  t78 = params->omega[6];
  t79 = t78 * t27;
  t82 = params->omega[7];
  t83 = t2 * t2;
  t84 = t83 * t83;
  t85 = t84 * t2;
  t86 = t85 * rho[0];
  t87 = t4 * t4;
  t88 = t87 * t87;
  t89 = t88 * t4;
  t90 = t89 * rho[1];
  t91 = t86 + t90;
  t92 = t82 * t91;
  t95 = params->omega[8];
  t96 = t95 * t27;
  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t23 / t97;
  t100 = sigma[0] * t99;
  t101 = t55 * t55;
  t102 = t101 * t56;
  t103 = t100 * t102;
  t104 = rho[1] * rho[1];
  t106 = 0.1e1 / t25 / t104;
  t107 = sigma[2] * t106;
  t108 = t67 * t67;
  t109 = t108 * t56;
  t110 = t107 * t109;
  t112 = t103 / 0.8e1 + t110 / 0.8e1;
  t115 = params->omega[9];
  t116 = t115 * t91;
  t119 = params->omega[10];
  t120 = t97 + t104;
  t121 = t119 * t120;
  t124 = params->omega[11];
  t125 = t124 * t27;
  t129 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t130 = t46 * t46;
  t131 = POW_1_3(t46);
  t132 = t131 * t131;
  t134 = 0.1e1 / t132 / t130;
  t136 = t103 / 0.4e1 + t110 / 0.4e1 - t129 * t134;
  t138 = params->omega[12];
  t139 = t138 * t91;
  t141 = params->omega[13];
  t142 = t141 * t120;
  t144 = params->omega[14];
  t145 = t144 * t6;
  t146 = t45 * t45;
  t147 = 0.1e1 / t130;
  t148 = t146 * t147;
  t150 = params->omega[15];
  t151 = t150 * t13;
  t153 = params->omega[16];
  t154 = t153 * t20;
  t156 = params->omega[17];
  t157 = t156 * t27;
  t159 = params->omega[18];
  t160 = pow(rho[0], 0.10833333333333333333e1);
  t161 = pow(rho[1], 0.10833333333333333333e1);
  t164 = t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t41 * t71 / 0.2e1 + t75 * t71 / 0.2e1 + t79 * t71 / 0.2e1 + t92 * t71 / 0.2e1 + t96 * t112 / 0.2e1 + t116 * t112 / 0.2e1 + t121 * t112 / 0.2e1 + t125 * t136 + t139 * t136 + t142 * t136 + t145 * t148 + t151 * t148 + t154 * t148 + t157 * t148 + t159 * (t160 + t161);
  tzk0 = t164 * t47;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t173 = pow(rho[0], 0.833333333333333333e-1);
  t177 = 0.1e1 / t9 / t97;
  t178 = t42 * t177;
  t181 = t45 * t147;
  t182 = t47 - t181;
  t185 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t182);
  t186 = t185 * t57;
  t189 = -t182;
  t192 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t189);
  t193 = t192 * t57;
  t196 = -t178 * t58 / 0.3e1 + t44 * t186 / 0.4e1 + t62 * t193 / 0.4e1;
  t199 = t29 * t33;
  t204 = t74 * t16;
  t209 = t78 * t23;
  t214 = t82 * t85;
  t217 = t97 * rho[0];
  t219 = 0.1e1 / t23 / t217;
  t220 = sigma[0] * t219;
  t221 = t220 * t102;
  t223 = t55 * t56;
  t224 = t223 * t185;
  t225 = t100 * t224;
  t227 = t67 * t56;
  t228 = t227 * t192;
  t229 = t107 * t228;
  t231 = -t221 / 0.3e1 + t225 / 0.4e1 + t229 / 0.4e1;
  t234 = t95 * t23;
  t239 = t115 * t85;
  t244 = 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.10833333333333333333e1 * t159 * t173 + t41 * t196 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t71 + t75 * t196 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t71 + t79 * t196 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t71 + t92 * t196 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t71 + t96 * t231 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t112 + t116 * t231 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t112 + t121 * t231 / 0.2e1;
  t245 = t119 * rho[0];
  t250 = t130 * t46;
  t252 = 0.1e1 / t132 / t250;
  t254 = 0.8e1 / 0.3e1 * t129 * t252;
  t255 = -0.2e1 / 0.3e1 * t221 + t225 / 0.2e1 + t229 / 0.2e1 + t254;
  t257 = t124 * t23;
  t261 = t138 * t85;
  t265 = t141 * rho[0];
  t268 = 0.1e1 / t250;
  t269 = t146 * t268;
  t271 = 0.2e1 * t145 * t269;
  t273 = 0.2e1 * t151 * t181;
  t275 = 0.2e1 * t151 * t269;
  t277 = 0.2e1 * t154 * t181;
  t279 = 0.2e1 * t154 * t269;
  t281 = 0.2e1 * t157 * t181;
  t283 = 0.2e1 * t157 * t269;
  t285 = 0.2e1 * t145 * t181;
  t286 = t144 * t2;
  t289 = t150 * t9;
  t292 = t153 * t16;
  t295 = t156 * t23;
  t298 = t245 * t112 + t125 * t255 + 0.5e1 / 0.3e1 * t257 * t136 + t139 * t255 + 0.11e2 / 0.6e1 * t261 * t136 + t142 * t255 + 0.2e1 * t265 * t136 - t271 + t273 - t275 + t277 - t279 + t281 - t283 + t285 + 0.7e1 / 0.6e1 * t286 * t148 + 0.4e1 / 0.3e1 * t289 * t148 + 0.3e1 / 0.2e1 * t292 * t148 + 0.5e1 / 0.3e1 * t295 * t148;
  tvrho0 = t244 + t298;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t307 = pow(rho[1], 0.833333333333333333e-1);
  t310 = -t47 - t181;
  t313 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t310);
  t314 = t313 * t57;
  t318 = 0.1e1 / t11 / t104;
  t319 = t60 * t318;
  t322 = -t310;
  t325 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t322);
  t326 = t325 * t57;
  t329 = t44 * t314 / 0.4e1 - t319 * t68 / 0.3e1 + t62 * t326 / 0.4e1;
  t332 = t29 * t38;
  t337 = t74 * t18;
  t342 = t78 * t25;
  t347 = t82 * t89;
  t350 = t223 * t313;
  t351 = t100 * t350;
  t353 = t104 * rho[1];
  t355 = 0.1e1 / t25 / t353;
  t356 = sigma[2] * t355;
  t357 = t356 * t109;
  t359 = t227 * t325;
  t360 = t107 * t359;
  t362 = t351 / 0.4e1 - t357 / 0.3e1 + t360 / 0.4e1;
  t365 = t95 * t25;
  t370 = t115 * t89;
  t375 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.10833333333333333333e1 * t159 * t307 + t41 * t329 / 0.2e1 + 0.17e2 / 0.24e2 * t332 * t71 + t75 * t329 / 0.2e1 + 0.3e1 / 0.4e1 * t337 * t71 + t79 * t329 / 0.2e1 + 0.5e1 / 0.6e1 * t342 * t71 + t92 * t329 / 0.2e1 + 0.11e2 / 0.12e2 * t347 * t71 + t96 * t362 / 0.2e1 + 0.5e1 / 0.6e1 * t365 * t112 + t116 * t362 / 0.2e1 + 0.11e2 / 0.12e2 * t370 * t112 + t121 * t362 / 0.2e1;
  t376 = t119 * rho[1];
  t381 = t351 / 0.2e1 - 0.2e1 / 0.3e1 * t357 + t360 / 0.2e1 + t254;
  t383 = t124 * t25;
  t387 = t138 * t89;
  t391 = t141 * rho[1];
  t394 = t144 * t4;
  t397 = t150 * t11;
  t400 = t153 * t18;
  t403 = t156 * t25;
  t406 = t376 * t112 + t125 * t381 + 0.5e1 / 0.3e1 * t383 * t136 + t139 * t381 + 0.11e2 / 0.6e1 * t387 * t136 + t142 * t381 + 0.2e1 * t391 * t136 - t271 - t273 - t275 - t277 - t279 - t281 - t283 + 0.7e1 / 0.6e1 * t394 * t148 + 0.4e1 / 0.3e1 * t397 * t148 + 0.3e1 / 0.2e1 * t400 * t148 + 0.5e1 / 0.3e1 * t403 * t148 - t285;
  tvrho1 = t375 + t406;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t407 = 0.1e1 / t42;
  t408 = t41 * t407;
  t410 = t43 * t55 * t57;
  t413 = t75 * t407;
  t416 = t79 * t407;
  t419 = t92 * t407;
  t423 = t99 * t101 * t56;
  t431 = t423 / 0.4e1 - t134;
  tvsigma0 = t408 * t410 / 0.16e2 + t413 * t410 / 0.16e2 + t416 * t410 / 0.16e2 + t419 * t410 / 0.16e2 + t96 * t423 / 0.16e2 + t116 * t423 / 0.16e2 + t121 * t423 / 0.16e2 + t125 * t431 + t139 * t431 + t142 * t431;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t125 * t134 - 0.2e1 * t139 * t134 - 0.2e1 * t142 * t134;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.1e1 / t60;
  t440 = t41 * t439;
  t442 = t61 * t67 * t57;
  t445 = t75 * t439;
  t448 = t79 * t439;
  t451 = t92 * t439;
  t455 = t106 * t108 * t56;
  t463 = t455 / 0.4e1 - t134;
  tvsigma2 = t440 * t442 / 0.16e2 + t445 * t442 / 0.16e2 + t448 * t442 / 0.16e2 + t451 * t442 / 0.16e2 + t96 * t455 / 0.16e2 + t116 * t455 / 0.16e2 + t121 * t455 / 0.16e2 + t125 * t463 + t139 * t463 + t142 * t463;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t467 = t119 * t112;
  t469 = 0.2e1 * t141 * t136;
  t471 = 0.1e1 / t9 / t217;
  t472 = t42 * t471;
  t477 = t53 * t53;
  t478 = 0.1e1 / t477;
  t479 = t182 * t182;
  t482 = t45 * t268;
  t484 = -0.2e1 * t147 + 0.2e1 * t482;
  t488 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t53 * t484);
  t489 = t488 * t57;
  t492 = t65 * t65;
  t493 = 0.1e1 / t492;
  t494 = t189 * t189;
  t497 = -t484;
  t501 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t494 + 0.4e1 / 0.3e1 * t65 * t497);
  t502 = t501 * t57;
  t505 = 0.7e1 / 0.9e1 * t472 * t58 - 0.2e1 / 0.3e1 * t178 * t186 + t44 * t489 / 0.4e1 + t62 * t502 / 0.4e1;
  t522 = t97 * t97;
  t524 = 0.1e1 / t23 / t522;
  t525 = sigma[0] * t524;
  t526 = t525 * t102;
  t528 = t220 * t224;
  t530 = t185 * t185;
  t531 = t530 * t56;
  t532 = t100 * t531;
  t534 = t223 * t488;
  t535 = t100 * t534;
  t537 = t192 * t192;
  t538 = t537 * t56;
  t539 = t107 * t538;
  t541 = t227 * t501;
  t542 = t107 * t541;
  t544 = 0.11e2 / 0.9e1 * t526 - 0.4e1 / 0.3e1 * t528 + t532 / 0.4e1 + t535 / 0.4e1 + t539 / 0.4e1 + t542 / 0.4e1;
  t553 = t467 + t469 + t41 * t505 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t196 + t75 * t505 / 0.2e1 + 0.3e1 / 0.2e1 * t204 * t196 + t79 * t505 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t196 + t92 * t505 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t196 + t96 * t544 / 0.2e1 + 0.5e1 / 0.3e1 * t234 * t231 + t116 * t544 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t231;
  t564 = t130 * t130;
  t566 = 0.1e1 / t132 / t564;
  t568 = 0.88e2 / 0.9e1 * t129 * t566;
  t569 = 0.22e2 / 0.9e1 * t526 - 0.8e1 / 0.3e1 * t528 + t532 / 0.2e1 + t535 / 0.2e1 + t539 / 0.2e1 + t542 / 0.2e1 - t568;
  t579 = t31 * t30;
  t580 = t32 * t579;
  t582 = t29 / t580;
  t585 = 0.1e1 / t16;
  t586 = t74 * t585;
  t589 = 0.1e1 / t9;
  t590 = t78 * t589;
  t593 = 0.1e1 / t2;
  t594 = t82 * t593;
  t597 = t95 * t589;
  t600 = t115 * t593;
  t603 = t124 * t589;
  t606 = t121 * t544 / 0.2e1 + 0.2e1 * t245 * t231 + t125 * t569 + 0.1e2 / 0.3e1 * t257 * t255 + t139 * t569 + 0.11e2 / 0.3e1 * t261 * t255 + t142 * t569 + 0.4e1 * t265 * t255 + 0.85e2 / 0.288e3 * t582 * t71 + 0.3e1 / 0.8e1 * t586 * t71 + 0.5e1 / 0.9e1 * t590 * t71 + 0.55e2 / 0.72e2 * t594 * t71 + 0.5e1 / 0.9e1 * t597 * t112 + 0.55e2 / 0.72e2 * t600 * t112 + 0.1e2 / 0.9e1 * t603 * t136;
  t608 = t138 * t593;
  t612 = 0.2e1 * t145 * t147;
  t614 = 0.2e1 * t151 * t147;
  t615 = 0.1e1 / t85;
  t616 = t144 * t615;
  t619 = t286 * t181;
  t621 = t286 * t269;
  t623 = 0.1e1 / t23;
  t624 = t150 * t623;
  t627 = t289 * t181;
  t629 = t289 * t269;
  t631 = t153 * t585;
  t634 = t292 * t181;
  t636 = t292 * t269;
  t638 = t156 * t589;
  t641 = t295 * t181;
  t643 = t295 * t269;
  t645 = 0.55e2 / 0.36e2 * t608 * t136 + t612 + t614 + 0.7e1 / 0.36e2 * t616 * t148 + 0.14e2 / 0.3e1 * t619 - 0.14e2 / 0.3e1 * t621 + 0.4e1 / 0.9e1 * t624 * t148 + 0.16e2 / 0.3e1 * t627 - 0.16e2 / 0.3e1 * t629 + 0.3e1 / 0.4e1 * t631 * t148 + 0.6e1 * t634 - 0.6e1 * t636 + 0.1e2 / 0.9e1 * t638 * t148 + 0.2e2 / 0.3e1 * t641 - 0.2e2 / 0.3e1 * t643;
  t647 = 0.8e1 * t145 * t482;
  t648 = 0.1e1 / t564;
  t649 = t146 * t648;
  t651 = 0.6e1 * t145 * t649;
  t653 = 0.8e1 * t151 * t482;
  t655 = 0.6e1 * t151 * t649;
  t657 = 0.8e1 * t154 * t482;
  t659 = 0.6e1 * t154 * t649;
  t661 = 0.8e1 * t157 * t482;
  t663 = 0.6e1 * t157 * t649;
  t672 = pow(rho[0], -0.9166666666666666667e0);
  t676 = 0.2e1 * t154 * t147;
  t678 = 0.2e1 * t157 * t147;
  t679 = -t647 + t651 - t653 + t655 - t657 + t659 - t661 + t663 + 0.7e1 / 0.36e2 * t1 * t615 + 0.4e1 / 0.9e1 * t8 * t623 + 0.3e1 / 0.4e1 * t15 * t585 + 0.1e2 / 0.9e1 * t22 * t589 + 0.90277777777777777739e-1 * t159 * t672 + t676 + t678;
  tv2rho20 = t553 + t606 + t645 + t679;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t681 = t394 * t181;
  t683 = t394 * t269;
  t685 = t397 * t181;
  t687 = t397 * t269;
  t689 = t400 * t181;
  t691 = t400 * t269;
  t693 = t403 * t181;
  t695 = t403 * t269;
  t700 = -t612 - t614 + 0.7e1 / 0.3e1 * t681 - 0.7e1 / 0.3e1 * t683 + 0.8e1 / 0.3e1 * t685 - 0.8e1 / 0.3e1 * t687 + 0.3e1 * t689 - 0.3e1 * t691 + 0.1e2 / 0.3e1 * t693 - 0.1e2 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t619 - 0.7e1 / 0.3e1 * t621 - 0.8e1 / 0.3e1 * t627;
  t708 = t478 * t310;
  t711 = t53 * t45;
  t715 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t708 * t182 + 0.8e1 / 0.3e1 * t711 * t268);
  t716 = t715 * t57;
  t721 = t493 * t322;
  t724 = t65 * t45;
  t728 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t721 * t189 - 0.8e1 / 0.3e1 * t724 * t268);
  t729 = t728 * t57;
  t732 = -t178 * t314 / 0.3e1 + t44 * t716 / 0.4e1 - t319 * t193 / 0.3e1 + t62 * t729 / 0.4e1;
  t739 = -0.8e1 / 0.3e1 * t629 - 0.3e1 * t634 - 0.3e1 * t636 - 0.1e2 / 0.3e1 * t641 - 0.1e2 / 0.3e1 * t643 + t651 + t655 + t659 + t663 - t676 - t678 + t41 * t732 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t329 + 0.17e2 / 0.24e2 * t332 * t196;
  t759 = t220 * t350;
  t761 = t185 * t56;
  t762 = t761 * t313;
  t763 = t100 * t762;
  t765 = t223 * t715;
  t766 = t100 * t765;
  t768 = t356 * t228;
  t770 = t192 * t56;
  t771 = t770 * t325;
  t772 = t107 * t771;
  t774 = t227 * t728;
  t775 = t107 * t774;
  t777 = -0.2e1 / 0.3e1 * t759 + t763 / 0.4e1 + t766 / 0.4e1 - 0.2e1 / 0.3e1 * t768 + t772 / 0.4e1 + t775 / 0.4e1;
  t786 = t75 * t732 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t329 + 0.3e1 / 0.4e1 * t337 * t196 + 0.5e1 / 0.6e1 * t342 * t196 + 0.5e1 / 0.6e1 * t209 * t329 + t92 * t732 / 0.2e1 + t79 * t732 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t329 + 0.11e2 / 0.12e2 * t347 * t196 + t96 * t777 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t362 + 0.5e1 / 0.6e1 * t365 * t231 + t116 * t777 / 0.2e1;
  t801 = -0.4e1 / 0.3e1 * t759 + t763 / 0.2e1 + t766 / 0.2e1 - 0.4e1 / 0.3e1 * t768 + t772 / 0.2e1 + t775 / 0.2e1 - t568;
  t817 = 0.11e2 / 0.12e2 * t239 * t362 + 0.11e2 / 0.12e2 * t370 * t231 + t121 * t777 / 0.2e1 + t245 * t362 + t376 * t231 + t125 * t801 + 0.5e1 / 0.3e1 * t257 * t381 + 0.5e1 / 0.3e1 * t383 * t255 + t139 * t801 + 0.11e2 / 0.6e1 * t261 * t381 + 0.11e2 / 0.6e1 * t387 * t255 + t142 * t801 + 0.2e1 * t265 * t381 + 0.2e1 * t391 * t255;
  tv2rho21 = t700 + t739 + t786 + t817;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t827 = t467 + t469 + t612 + t614 - 0.14e2 / 0.3e1 * t681 - 0.14e2 / 0.3e1 * t683 - 0.16e2 / 0.3e1 * t685 - 0.16e2 / 0.3e1 * t687 - 0.6e1 * t689 - 0.6e1 * t691 - 0.2e2 / 0.3e1 * t693 - 0.2e2 / 0.3e1 * t695 + t647 + t651;
  t828 = 0.1e1 / t89;
  t829 = t144 * t828;
  t832 = 0.1e1 / t25;
  t833 = t150 * t832;
  t836 = 0.1e1 / t18;
  t837 = t153 * t836;
  t840 = 0.1e1 / t11;
  t841 = t156 * t840;
  t852 = pow(rho[1], -0.9166666666666666667e0);
  t855 = t653 + t655 + t657 + t659 + t661 + t663 + 0.7e1 / 0.36e2 * t829 * t148 + 0.4e1 / 0.9e1 * t833 * t148 + 0.3e1 / 0.4e1 * t837 * t148 + 0.1e2 / 0.9e1 * t841 * t148 + 0.7e1 / 0.36e2 * t1 * t828 + 0.4e1 / 0.9e1 * t8 * t832 + 0.3e1 / 0.4e1 * t15 * t836 + 0.1e2 / 0.9e1 * t22 * t840 + 0.90277777777777777739e-1 * t159 * t852;
  t857 = t310 * t310;
  t861 = 0.2e1 * t147 + 0.2e1 * t482;
  t865 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t857 + 0.4e1 / 0.3e1 * t53 * t861);
  t866 = t865 * t57;
  t870 = 0.1e1 / t11 / t353;
  t871 = t60 * t870;
  t876 = t322 * t322;
  t879 = -t861;
  t883 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t876 + 0.4e1 / 0.3e1 * t65 * t879);
  t884 = t883 * t57;
  t887 = t44 * t866 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t68 - 0.2e1 / 0.3e1 * t319 * t326 + t62 * t884 / 0.4e1;
  t904 = t313 * t313;
  t905 = t904 * t56;
  t906 = t100 * t905;
  t908 = t223 * t865;
  t909 = t100 * t908;
  t911 = t104 * t104;
  t913 = 0.1e1 / t25 / t911;
  t914 = sigma[2] * t913;
  t915 = t914 * t109;
  t917 = t356 * t359;
  t919 = t325 * t325;
  t920 = t919 * t56;
  t921 = t107 * t920;
  t923 = t227 * t883;
  t924 = t107 * t923;
  t926 = t906 / 0.4e1 + t909 / 0.4e1 + 0.11e2 / 0.9e1 * t915 - 0.4e1 / 0.3e1 * t917 + t921 / 0.4e1 + t924 / 0.4e1;
  t937 = t676 + t678 + t41 * t887 / 0.2e1 + 0.17e2 / 0.12e2 * t332 * t329 + t75 * t887 / 0.2e1 + 0.3e1 / 0.2e1 * t337 * t329 + t79 * t887 / 0.2e1 + 0.5e1 / 0.3e1 * t342 * t329 + t92 * t887 / 0.2e1 + 0.11e2 / 0.6e1 * t347 * t329 + t96 * t926 / 0.2e1 + 0.5e1 / 0.3e1 * t365 * t362 + t116 * t926 / 0.2e1 + 0.11e2 / 0.6e1 * t370 * t362 + t121 * t926 / 0.2e1;
  t946 = t906 / 0.2e1 + t909 / 0.2e1 + 0.22e2 / 0.9e1 * t915 - 0.8e1 / 0.3e1 * t917 + t921 / 0.2e1 + t924 / 0.2e1 - t568;
  t956 = t36 * t35;
  t957 = t37 * t956;
  t959 = t29 / t957;
  t962 = t74 * t836;
  t965 = t78 * t840;
  t968 = 0.1e1 / t4;
  t969 = t82 * t968;
  t972 = t95 * t840;
  t975 = t115 * t968;
  t978 = t124 * t840;
  t981 = t138 * t968;
  t984 = 0.2e1 * t376 * t362 + t125 * t946 + 0.1e2 / 0.3e1 * t383 * t381 + t139 * t946 + 0.11e2 / 0.3e1 * t387 * t381 + t142 * t946 + 0.4e1 * t391 * t381 + 0.85e2 / 0.288e3 * t959 * t71 + 0.3e1 / 0.8e1 * t962 * t71 + 0.5e1 / 0.9e1 * t965 * t71 + 0.55e2 / 0.72e2 * t969 * t71 + 0.5e1 / 0.9e1 * t972 * t112 + 0.55e2 / 0.72e2 * t975 * t112 + 0.1e2 / 0.9e1 * t978 * t136 + 0.55e2 / 0.36e2 * t981 * t136;
  tv2rho22 = t827 + t855 + t937 + t984;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t987 = t43 * t185 * t57;
  t996 = t96 * t99;
  t999 = t116 * t99;
  t1002 = t121 * t99;
  t1006 = t177 * t55 * t57;
  t1016 = t95 / t97;
  t1019 = 0.1e1 / t86;
  t1020 = t115 * t1019;
  t1023 = t408 * t987 / 0.16e2 + t413 * t987 / 0.16e2 + t416 * t987 / 0.16e2 + t419 * t987 / 0.16e2 + t996 * t224 / 0.8e1 + t999 * t224 / 0.8e1 + t1002 * t224 / 0.8e1 - t408 * t1006 / 0.12e2 - t413 * t1006 / 0.12e2 - t416 * t1006 / 0.12e2 - t419 * t1006 / 0.12e2 + 0.5e1 / 0.48e2 * t1016 * t102 + 0.11e2 / 0.96e2 * t1020 * t102;
  t1024 = 0.1e1 / t24;
  t1025 = t119 * t1024;
  t1028 = t32 * t32;
  t1029 = t1028 * t579;
  t1031 = t29 / t1029;
  t1033 = t407 * t55 * t57;
  t1036 = t74 * t615;
  t1039 = t78 * t623;
  t1042 = t82 * t585;
  t1046 = t219 * t101 * t56;
  t1054 = t99 * t55;
  t1057 = 0.8e1 / 0.3e1 * t252;
  t1058 = -0.2e1 / 0.3e1 * t1046 + t1054 * t761 / 0.2e1 + t1057;
  t1068 = t1025 * t102 / 0.8e1 + 0.17e2 / 0.192e3 * t1031 * t1033 + 0.3e1 / 0.32e2 * t1036 * t1033 + 0.5e1 / 0.48e2 * t1039 * t1033 + 0.11e2 / 0.96e2 * t1042 * t1033 - t96 * t1046 / 0.6e1 - t116 * t1046 / 0.6e1 - t121 * t1046 / 0.6e1 + t125 * t1058 + 0.5e1 / 0.3e1 * t257 * t431 + t139 * t1058 + 0.11e2 / 0.6e1 * t261 * t431 + t142 * t1058 + 0.2e1 * t265 * t431;
  tv2rhosigma0 = t1023 + t1068;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1072 = 0.16e2 / 0.3e1 * t125 * t252;
  t1076 = 0.16e2 / 0.3e1 * t139 * t252;
  t1080 = 0.16e2 / 0.3e1 * t142 * t252;
  tv2rhosigma1 = -0.1e2 / 0.3e1 * t257 * t134 + t1072 - 0.11e2 / 0.3e1 * t261 * t134 + t1076 - 0.4e1 * t265 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1081 = t199 * t439;
  t1085 = t61 * t192 * t57;
  t1088 = t204 * t439;
  t1093 = t209 * t439;
  t1098 = t214 * t439;
  t1105 = t96 * t106;
  t1110 = t116 * t106;
  t1115 = t121 * t106;
  t1120 = t106 * t67;
  t1123 = t1120 * t770 / 0.2e1 + t1057;
  tv2rhosigma2 = 0.17e2 / 0.192e3 * t1081 * t442 + t440 * t1085 / 0.16e2 + 0.3e1 / 0.32e2 * t1088 * t442 + t445 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t442 + t448 * t1085 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t442 + t451 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t234 * t455 + t1105 * t228 / 0.8e1 + 0.11e2 / 0.96e2 * t239 * t455 + t1110 * t228 / 0.8e1 + t245 * t455 / 0.8e1 + t1115 * t228 / 0.8e1 + 0.5e1 / 0.3e1 * t257 * t463 + t125 * t1123 + 0.11e2 / 0.6e1 * t261 * t463 + t139 * t1123 + 0.2e1 * t265 * t463 + t142 * t1123;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1131 = t332 * t407;
  t1135 = t43 * t313 * t57;
  t1138 = t337 * t407;
  t1143 = t342 * t407;
  t1148 = t347 * t407;
  t1167 = t56 * t313;
  t1170 = t1054 * t1167 / 0.2e1 + t1057;
  tv2rhosigma3 = 0.17e2 / 0.192e3 * t1131 * t410 + t408 * t1135 / 0.16e2 + 0.3e1 / 0.32e2 * t1138 * t410 + t413 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t410 + t416 * t1135 / 0.16e2 + 0.11e2 / 0.96e2 * t1148 * t410 + t419 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t365 * t423 + t996 * t350 / 0.8e1 + 0.11e2 / 0.96e2 * t370 * t423 + t999 * t350 / 0.8e1 + t376 * t423 / 0.8e1 + t1002 * t350 / 0.8e1 + 0.5e1 / 0.3e1 * t383 * t431 + t125 * t1170 + 0.11e2 / 0.6e1 * t387 * t431 + t139 * t1170 + 0.2e1 * t391 * t431 + t142 * t1170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.1e2 / 0.3e1 * t383 * t134 + t1072 - 0.11e2 / 0.3e1 * t387 * t134 + t1076 - 0.4e1 * t391 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1185 = t61 * t325 * t57;
  t1201 = t318 * t67 * t57;
  t1211 = t95 / t104;
  t1214 = 0.1e1 / t90;
  t1215 = t115 * t1214;
  t1218 = t440 * t1185 / 0.16e2 + t445 * t1185 / 0.16e2 + t448 * t1185 / 0.16e2 + t451 * t1185 / 0.16e2 + t1105 * t359 / 0.8e1 + t1110 * t359 / 0.8e1 + t1115 * t359 / 0.8e1 - t440 * t1201 / 0.12e2 - t445 * t1201 / 0.12e2 - t448 * t1201 / 0.12e2 - t451 * t1201 / 0.12e2 + 0.5e1 / 0.48e2 * t1211 * t109 + 0.11e2 / 0.96e2 * t1215 * t109;
  t1219 = 0.1e1 / t26;
  t1220 = t119 * t1219;
  t1224 = t355 * t108 * t56;
  t1231 = t37 * t37;
  t1232 = t1231 * t956;
  t1234 = t29 / t1232;
  t1236 = t439 * t67 * t57;
  t1239 = t74 * t828;
  t1242 = t78 * t832;
  t1245 = t82 * t836;
  t1249 = t56 * t325;
  t1252 = -0.2e1 / 0.3e1 * t1224 + t1120 * t1249 / 0.2e1 + t1057;
  t1262 = t1220 * t109 / 0.8e1 - t96 * t1224 / 0.6e1 - t116 * t1224 / 0.6e1 - t121 * t1224 / 0.6e1 + 0.17e2 / 0.192e3 * t1234 * t1236 + 0.3e1 / 0.32e2 * t1239 * t1236 + 0.5e1 / 0.48e2 * t1242 * t1236 + 0.11e2 / 0.96e2 * t1245 * t1236 + t125 * t1252 + 0.5e1 / 0.3e1 * t383 * t463 + t139 * t1252 + 0.11e2 / 0.6e1 * t387 * t463 + t142 * t1252 + 0.2e1 * t391 * t463;
  tv2rhosigma5 = t1218 + t1262;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1264 = 0.1e1 / t42 / sigma[0];
  t1265 = t41 * t1264;
  t1267 = t75 * t1264;
  t1269 = t79 * t1264;
  t1271 = t92 * t1264;
  tv2sigma20 = -t1265 * t410 / 0.32e2 - t1267 * t410 / 0.32e2 - t1269 * t410 / 0.32e2 - t1271 * t410 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1275 = 0.1e1 / t60 / sigma[2];
  t1276 = t41 * t1275;
  t1278 = t75 * t1275;
  t1280 = t79 * t1275;
  t1282 = t92 * t1275;
  tv2sigma25 = -t1276 * t442 / 0.32e2 - t1278 * t442 / 0.32e2 - t1280 * t442 / 0.32e2 - t1282 * t442 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t38, t41, t42, t43, t44, t45, t46, t47;
  double t48, t49, t50, t51, t52, t53, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t65;
  double t67, t68, t71, t74, t75, t78, t79, t82;
  double t83, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t95, t96, t97, t99, t100, t101;
  double t102, t103, t104, t106, t107, t108, t109, t110;
  double t112, t115, t116, t119, t120, t121, t124, t125;
  double t129, t130, t131, t132, t134, t136, t138, t139;
  double t141, t142, t144, t145, t146, t147, t148, t150;
  double t151, t153, t154, t156, t157, t159, t160, t161;
  double t164, tzk0;

  double t173, t177, t178, t181, t182, t185, t186, t189;
  double t192, t193, t196, t199, t204, t209, t214, t217;
  double t219, t220, t221, t223, t224, t225, t227, t228;
  double t229, t231, t234, t239, t244, t245, t250, t252;
  double t254, t255, t257, t261, t265, t268, t269, t271;
  double t273, t275, t277, t279, t281, t283, t285, t286;
  double t289, t292, t295, t298, tvrho0, t307, t310, t313;
  double t314, t318, t319, t322, t325, t326, t329, t332;
  double t337, t342, t347, t350, t351, t353, t355, t356;
  double t357, t359, t360, t362, t365, t370, t375, t376;
  double t381, t383, t387, t391, t394, t397, t400, t403;
  double t406, tvrho1, t407, t408, t410, t413, t416, t419;
  double t423, t431, tvsigma0, tvsigma1, t439, t440, t442, t445;
  double t448, t451, t455, t463, tvsigma2;

  double t467, t469, t471, t472, t477, t478, t479, t482;
  double t484, t488, t489, t492, t493, t494, t497, t501;
  double t502, t505, t522, t524, t525, t526, t528, t530;
  double t531, t532, t534, t535, t537, t538, t539, t541;
  double t542, t544, t553, t564, t566, t568, t569, t579;
  double t580, t582, t585, t586, t589, t590, t593, t594;
  double t597, t600, t603, t606, t608, t612, t614, t615;
  double t616, t619, t621, t623, t624, t627, t629, t631;
  double t634, t636, t638, t641, t643, t645, t647, t648;
  double t649, t651, t653, t655, t657, t659, t661, t663;
  double t672, t676, t678, t679, tv2rho20, t681, t683, t685;
  double t687, t689, t691, t693, t695, t700, t708, t711;
  double t715, t716, t721, t724, t728, t729, t732, t739;
  double t759, t761, t762, t763, t765, t766, t768, t770;
  double t771, t772, t774, t775, t777, t786, t801, t817;
  double tv2rho21, t827, t828, t829, t832, t833, t836, t837;
  double t840, t841, t852, t855, t857, t861, t865, t866;
  double t870, t871, t876, t879, t883, t884, t887, t904;
  double t905, t906, t908, t909, t911, t913, t914, t915;
  double t917, t919, t920, t921, t923, t924, t926, t937;
  double t946, t956, t957, t959, t962, t965, t968, t969;
  double t972, t975, t978, t981, t984, tv2rho22, t987, t996;
  double t999, t1002, t1006, t1016, t1019, t1020, t1023, t1024;
  double t1025, t1028, t1029, t1031, t1033, t1036, t1039, t1042;
  double t1046, t1054, t1057, t1058, t1068, tv2rhosigma0, t1072, t1076;
  double t1080, tv2rhosigma1, t1081, t1085, t1088, t1093, t1098, t1105;
  double t1110, t1115, t1120, t1123, tv2rhosigma2, t1131, t1135, t1138;
  double t1143, t1148, t1167, t1170, tv2rhosigma3, tv2rhosigma4, t1185, t1201;
  double t1211, t1214, t1215, t1218, t1219, t1220, t1224, t1231;
  double t1232, t1234, t1236, t1239, t1242, t1245, t1249, t1252;
  double t1262, tv2rhosigma5, t1264, t1265, t1267, t1269, t1271, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1275, t1276, t1278, t1280;
  double t1282, tv2sigma25;

  double t1285, t1286, t1287, t1289, t1290, t1291, t1292, t1294;
  double t1295, t1296, t1298, t1299, t1302, t1304, t1306, t1308;
  double t1310, t1313, t1315, t1317, t1319, t1321, t1322, t1325;
  double t1327, t1329, t1331, t1332, t1334, t1337, t1339, t1341;
  double t1343, t1345, t1346, t1348, t1349, t1350, t1359, t1362;
  double t1364, t1366, t1368, t1370, t1372, t1374, t1377, t1378;
  double t1385, t1386, t1389, t1393, t1397, t1398, t1402, t1403;
  double t1406, t1409, t1413, t1414, t1417, t1426, t1428, t1429;
  double t1430, t1432, t1434, t1436, t1438, t1439, t1441, t1442;
  double t1444, t1445, t1447, t1448, t1450, t1472, t1474, t1475;
  double t1493, t1494, t1495, t1496, t1497, t1498, t1499, t1500;
  double t1501, t1504, t1507, t1510, t1513, t1514, t1517, t1520;
  double t1523, t1526, t1545, tv3rho30, t1547, t1548, t1561, t1562;
  double t1563, t1564, t1566, t1568, t1570, t1572, t1574, t1576;
  double t1578, t1580, t1582, t1587, t1588, t1589, t1590, t1595;
  double t1597, t1599, t1601, t1603, t1604, t1605, t1607, t1608;
  double t1610, t1613, t1624, t1625, t1626, t1628, t1630, t1632;
  double t1633, t1634, t1636, t1637, t1639, t1642, t1653, t1654;
  double t1655, t1657, t1684, t1700, t1705, t1708, t1717, t1734;
  double t1736, t1738, t1740, t1758, tv3rho31, t1772, t1794, t1802;
  double t1807, t1812, t1816, t1817, t1824, t1829, t1832, t1836;
  double t1837, t1840, t1859, t1861, t1862, t1864, t1866, t1867;
  double t1869, t1870, t1872, t1874, t1876, t1878, t1879, t1881;
  double t1882, t1884, t1885, t1887, t1905, t1915, t1937, t1939;
  double t1941, t1943, t1945, t1947, t1949, t1951, t1953, tv3rho32;
  double t1955, t1958, t1961, t1962, t1965, t1976, t1981, t1996;
  double t1999, t2002, t2005, t2006, t2009, t2011, t2014, t2017;
  double t2020, t2031, t2032, t2034, t2040, t2044, t2045, t2046;
  double t2048, t2050, t2051, t2052, t2054, t2056, t2058, t2060;
  double t2061, t2063, t2068, t2072, t2073, t2074, t2076, t2085;
  double t2089, t2090, t2096, t2099, t2120, t2123, t2155, tv3rho33;
  double t2158, t2162, t2163, t2166, t2167, t2170, t2175, t2178;
  double t2181, t2185, t2194, t2202, t2204, t2208, t2217, t2224;
  double t2229, t2231, t2237, t2238, t2252, t2259, t2263, t2272;
  double t2277, t2288, tv3rho2sigma0, t2292, t2295, t2298, t2301, t2303;
  double t2304, t2307, tv3rho2sigma1, t2308, t2309, t2312, t2324, t2334;
  double t2342, t2345, t2346, t2349, t2352, t2357, t2362, t2370;
  double t2385, t2388, tv3rho2sigma2, t2390, t2413, t2416, t2419, t2422;
  double t2437, t2446, t2464, t2472, t2475, t2488, t2495, t2502;
  double tv3rho2sigma3, t2504, t2507, t2510, tv3rho2sigma4, t2513, t2523, t2537;
  double t2540, t2559, t2562, t2565, t2568, t2574, t2587, t2600;
  double t2609, t2618, t2627, tv3rho2sigma5, t2634, t2651, t2654, t2657;
  double t2660, t2667, t2674, t2692, t2695, t2703, tv3rho2sigma6, tv3rho2sigma7;
  double t2712, t2716, t2717, t2721, t2727, t2742, t2744, t2765;
  double t2770, t2773, t2775, t2778, t2781, t2785, t2797, t2806;
  double t2821, t2824, t2834, tv3rho2sigma8, t2837, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2862, t2867, t2872, t2877, tv3rhosigma25, t2882;
  double t2887, t2892, t2897, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2903, tv3rhosigma211, t2928, t2930, t2931, t2933, t2935, t2937;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t2940, t2942, t2943, t2945, t2947, t2949, tv3sigma39;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = pow(rho[0], 0.1e1 / 0.12e2);
  t31 = t30 * t30;
  t32 = t31 * t31;
  t33 = t32 * t30;
  t35 = pow(rho[1], 0.1e1 / 0.12e2);
  t36 = t35 * t35;
  t37 = t36 * t36;
  t38 = t37 * t35;
  t41 = t29 * (t33 * rho[0] + t38 * rho[1]);
  t42 = sqrt(sigma[0]);
  t43 = 0.1e1 / t10;
  t44 = t42 * t43;
  t45 = rho[0] - rho[1];
  t46 = rho[0] + rho[1];
  t47 = 0.1e1 / t46;
  t48 = t45 * t47;
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * p->zeta_threshold;
  t53 = POW_1_3(t49);
  t55 = my_piecewise3(t50, t52, t53 * t49);
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = t55 * t57;
  t60 = sqrt(sigma[2]);
  t61 = 0.1e1 / t12;
  t62 = t60 * t61;
  t63 = 0.1e1 - t48;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t52, t65 * t63);
  t68 = t67 * t57;
  t71 = t44 * t58 / 0.4e1 + t62 * t68 / 0.4e1;
  t74 = params->omega[5];
  t75 = t74 * t20;
  t78 = params->omega[6];
  t79 = t78 * t27;
  t82 = params->omega[7];
  t83 = t2 * t2;
  t84 = t83 * t83;
  t85 = t84 * t2;
  t86 = t85 * rho[0];
  t87 = t4 * t4;
  t88 = t87 * t87;
  t89 = t88 * t4;
  t90 = t89 * rho[1];
  t91 = t86 + t90;
  t92 = t82 * t91;
  t95 = params->omega[8];
  t96 = t95 * t27;
  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t23 / t97;
  t100 = sigma[0] * t99;
  t101 = t55 * t55;
  t102 = t101 * t56;
  t103 = t100 * t102;
  t104 = rho[1] * rho[1];
  t106 = 0.1e1 / t25 / t104;
  t107 = sigma[2] * t106;
  t108 = t67 * t67;
  t109 = t108 * t56;
  t110 = t107 * t109;
  t112 = t103 / 0.8e1 + t110 / 0.8e1;
  t115 = params->omega[9];
  t116 = t115 * t91;
  t119 = params->omega[10];
  t120 = t97 + t104;
  t121 = t119 * t120;
  t124 = params->omega[11];
  t125 = t124 * t27;
  t129 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t130 = t46 * t46;
  t131 = POW_1_3(t46);
  t132 = t131 * t131;
  t134 = 0.1e1 / t132 / t130;
  t136 = t103 / 0.4e1 + t110 / 0.4e1 - t129 * t134;
  t138 = params->omega[12];
  t139 = t138 * t91;
  t141 = params->omega[13];
  t142 = t141 * t120;
  t144 = params->omega[14];
  t145 = t144 * t6;
  t146 = t45 * t45;
  t147 = 0.1e1 / t130;
  t148 = t146 * t147;
  t150 = params->omega[15];
  t151 = t150 * t13;
  t153 = params->omega[16];
  t154 = t153 * t20;
  t156 = params->omega[17];
  t157 = t156 * t27;
  t159 = params->omega[18];
  t160 = pow(rho[0], 0.10833333333333333333e1);
  t161 = pow(rho[1], 0.10833333333333333333e1);
  t164 = t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t41 * t71 / 0.2e1 + t75 * t71 / 0.2e1 + t79 * t71 / 0.2e1 + t92 * t71 / 0.2e1 + t96 * t112 / 0.2e1 + t116 * t112 / 0.2e1 + t121 * t112 / 0.2e1 + t125 * t136 + t139 * t136 + t142 * t136 + t145 * t148 + t151 * t148 + t154 * t148 + t157 * t148 + t159 * (t160 + t161);
  tzk0 = t164 * t47;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t173 = pow(rho[0], 0.833333333333333333e-1);
  t177 = 0.1e1 / t9 / t97;
  t178 = t42 * t177;
  t181 = t45 * t147;
  t182 = t47 - t181;
  t185 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t182);
  t186 = t185 * t57;
  t189 = -t182;
  t192 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t189);
  t193 = t192 * t57;
  t196 = -t178 * t58 / 0.3e1 + t44 * t186 / 0.4e1 + t62 * t193 / 0.4e1;
  t199 = t29 * t33;
  t204 = t74 * t16;
  t209 = t78 * t23;
  t214 = t82 * t85;
  t217 = t97 * rho[0];
  t219 = 0.1e1 / t23 / t217;
  t220 = sigma[0] * t219;
  t221 = t220 * t102;
  t223 = t55 * t56;
  t224 = t223 * t185;
  t225 = t100 * t224;
  t227 = t67 * t56;
  t228 = t227 * t192;
  t229 = t107 * t228;
  t231 = -t221 / 0.3e1 + t225 / 0.4e1 + t229 / 0.4e1;
  t234 = t95 * t23;
  t239 = t115 * t85;
  t244 = 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.10833333333333333333e1 * t159 * t173 + t41 * t196 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t71 + t75 * t196 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t71 + t79 * t196 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t71 + t92 * t196 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t71 + t96 * t231 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t112 + t116 * t231 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t112 + t121 * t231 / 0.2e1;
  t245 = t119 * rho[0];
  t250 = t130 * t46;
  t252 = 0.1e1 / t132 / t250;
  t254 = 0.8e1 / 0.3e1 * t129 * t252;
  t255 = -0.2e1 / 0.3e1 * t221 + t225 / 0.2e1 + t229 / 0.2e1 + t254;
  t257 = t124 * t23;
  t261 = t138 * t85;
  t265 = t141 * rho[0];
  t268 = 0.1e1 / t250;
  t269 = t146 * t268;
  t271 = 0.2e1 * t145 * t269;
  t273 = 0.2e1 * t151 * t181;
  t275 = 0.2e1 * t151 * t269;
  t277 = 0.2e1 * t154 * t181;
  t279 = 0.2e1 * t154 * t269;
  t281 = 0.2e1 * t157 * t181;
  t283 = 0.2e1 * t157 * t269;
  t285 = 0.2e1 * t145 * t181;
  t286 = t144 * t2;
  t289 = t150 * t9;
  t292 = t153 * t16;
  t295 = t156 * t23;
  t298 = t245 * t112 + t125 * t255 + 0.5e1 / 0.3e1 * t257 * t136 + t139 * t255 + 0.11e2 / 0.6e1 * t261 * t136 + t142 * t255 + 0.2e1 * t265 * t136 - t271 + t273 - t275 + t277 - t279 + t281 - t283 + t285 + 0.7e1 / 0.6e1 * t286 * t148 + 0.4e1 / 0.3e1 * t289 * t148 + 0.3e1 / 0.2e1 * t292 * t148 + 0.5e1 / 0.3e1 * t295 * t148;
  tvrho0 = t244 + t298;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t307 = pow(rho[1], 0.833333333333333333e-1);
  t310 = -t47 - t181;
  t313 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t310);
  t314 = t313 * t57;
  t318 = 0.1e1 / t11 / t104;
  t319 = t60 * t318;
  t322 = -t310;
  t325 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t322);
  t326 = t325 * t57;
  t329 = t44 * t314 / 0.4e1 - t319 * t68 / 0.3e1 + t62 * t326 / 0.4e1;
  t332 = t29 * t38;
  t337 = t74 * t18;
  t342 = t78 * t25;
  t347 = t82 * t89;
  t350 = t223 * t313;
  t351 = t100 * t350;
  t353 = t104 * rho[1];
  t355 = 0.1e1 / t25 / t353;
  t356 = sigma[2] * t355;
  t357 = t356 * t109;
  t359 = t227 * t325;
  t360 = t107 * t359;
  t362 = t351 / 0.4e1 - t357 / 0.3e1 + t360 / 0.4e1;
  t365 = t95 * t25;
  t370 = t115 * t89;
  t375 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.10833333333333333333e1 * t159 * t307 + t41 * t329 / 0.2e1 + 0.17e2 / 0.24e2 * t332 * t71 + t75 * t329 / 0.2e1 + 0.3e1 / 0.4e1 * t337 * t71 + t79 * t329 / 0.2e1 + 0.5e1 / 0.6e1 * t342 * t71 + t92 * t329 / 0.2e1 + 0.11e2 / 0.12e2 * t347 * t71 + t96 * t362 / 0.2e1 + 0.5e1 / 0.6e1 * t365 * t112 + t116 * t362 / 0.2e1 + 0.11e2 / 0.12e2 * t370 * t112 + t121 * t362 / 0.2e1;
  t376 = t119 * rho[1];
  t381 = t351 / 0.2e1 - 0.2e1 / 0.3e1 * t357 + t360 / 0.2e1 + t254;
  t383 = t124 * t25;
  t387 = t138 * t89;
  t391 = t141 * rho[1];
  t394 = t144 * t4;
  t397 = t150 * t11;
  t400 = t153 * t18;
  t403 = t156 * t25;
  t406 = t376 * t112 + t125 * t381 + 0.5e1 / 0.3e1 * t383 * t136 + t139 * t381 + 0.11e2 / 0.6e1 * t387 * t136 + t142 * t381 + 0.2e1 * t391 * t136 - t271 - t273 - t275 - t277 - t279 - t281 - t283 + 0.7e1 / 0.6e1 * t394 * t148 + 0.4e1 / 0.3e1 * t397 * t148 + 0.3e1 / 0.2e1 * t400 * t148 + 0.5e1 / 0.3e1 * t403 * t148 - t285;
  tvrho1 = t375 + t406;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t407 = 0.1e1 / t42;
  t408 = t41 * t407;
  t410 = t43 * t55 * t57;
  t413 = t75 * t407;
  t416 = t79 * t407;
  t419 = t92 * t407;
  t423 = t99 * t101 * t56;
  t431 = t423 / 0.4e1 - t134;
  tvsigma0 = t408 * t410 / 0.16e2 + t413 * t410 / 0.16e2 + t416 * t410 / 0.16e2 + t419 * t410 / 0.16e2 + t96 * t423 / 0.16e2 + t116 * t423 / 0.16e2 + t121 * t423 / 0.16e2 + t125 * t431 + t139 * t431 + t142 * t431;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t125 * t134 - 0.2e1 * t139 * t134 - 0.2e1 * t142 * t134;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.1e1 / t60;
  t440 = t41 * t439;
  t442 = t61 * t67 * t57;
  t445 = t75 * t439;
  t448 = t79 * t439;
  t451 = t92 * t439;
  t455 = t106 * t108 * t56;
  t463 = t455 / 0.4e1 - t134;
  tvsigma2 = t440 * t442 / 0.16e2 + t445 * t442 / 0.16e2 + t448 * t442 / 0.16e2 + t451 * t442 / 0.16e2 + t96 * t455 / 0.16e2 + t116 * t455 / 0.16e2 + t121 * t455 / 0.16e2 + t125 * t463 + t139 * t463 + t142 * t463;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t467 = t119 * t112;
  t469 = 0.2e1 * t141 * t136;
  t471 = 0.1e1 / t9 / t217;
  t472 = t42 * t471;
  t477 = t53 * t53;
  t478 = 0.1e1 / t477;
  t479 = t182 * t182;
  t482 = t45 * t268;
  t484 = -0.2e1 * t147 + 0.2e1 * t482;
  t488 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t53 * t484);
  t489 = t488 * t57;
  t492 = t65 * t65;
  t493 = 0.1e1 / t492;
  t494 = t189 * t189;
  t497 = -t484;
  t501 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t494 + 0.4e1 / 0.3e1 * t65 * t497);
  t502 = t501 * t57;
  t505 = 0.7e1 / 0.9e1 * t472 * t58 - 0.2e1 / 0.3e1 * t178 * t186 + t44 * t489 / 0.4e1 + t62 * t502 / 0.4e1;
  t522 = t97 * t97;
  t524 = 0.1e1 / t23 / t522;
  t525 = sigma[0] * t524;
  t526 = t525 * t102;
  t528 = t220 * t224;
  t530 = t185 * t185;
  t531 = t530 * t56;
  t532 = t100 * t531;
  t534 = t223 * t488;
  t535 = t100 * t534;
  t537 = t192 * t192;
  t538 = t537 * t56;
  t539 = t107 * t538;
  t541 = t227 * t501;
  t542 = t107 * t541;
  t544 = 0.11e2 / 0.9e1 * t526 - 0.4e1 / 0.3e1 * t528 + t532 / 0.4e1 + t535 / 0.4e1 + t539 / 0.4e1 + t542 / 0.4e1;
  t553 = t467 + t469 + t41 * t505 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t196 + t75 * t505 / 0.2e1 + 0.3e1 / 0.2e1 * t204 * t196 + t79 * t505 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t196 + t92 * t505 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t196 + t96 * t544 / 0.2e1 + 0.5e1 / 0.3e1 * t234 * t231 + t116 * t544 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t231;
  t564 = t130 * t130;
  t566 = 0.1e1 / t132 / t564;
  t568 = 0.88e2 / 0.9e1 * t129 * t566;
  t569 = 0.22e2 / 0.9e1 * t526 - 0.8e1 / 0.3e1 * t528 + t532 / 0.2e1 + t535 / 0.2e1 + t539 / 0.2e1 + t542 / 0.2e1 - t568;
  t579 = t31 * t30;
  t580 = t32 * t579;
  t582 = t29 / t580;
  t585 = 0.1e1 / t16;
  t586 = t74 * t585;
  t589 = 0.1e1 / t9;
  t590 = t78 * t589;
  t593 = 0.1e1 / t2;
  t594 = t82 * t593;
  t597 = t95 * t589;
  t600 = t115 * t593;
  t603 = t124 * t589;
  t606 = t121 * t544 / 0.2e1 + 0.2e1 * t245 * t231 + t125 * t569 + 0.1e2 / 0.3e1 * t257 * t255 + t139 * t569 + 0.11e2 / 0.3e1 * t261 * t255 + t142 * t569 + 0.4e1 * t265 * t255 + 0.85e2 / 0.288e3 * t582 * t71 + 0.3e1 / 0.8e1 * t586 * t71 + 0.5e1 / 0.9e1 * t590 * t71 + 0.55e2 / 0.72e2 * t594 * t71 + 0.5e1 / 0.9e1 * t597 * t112 + 0.55e2 / 0.72e2 * t600 * t112 + 0.1e2 / 0.9e1 * t603 * t136;
  t608 = t138 * t593;
  t612 = 0.2e1 * t145 * t147;
  t614 = 0.2e1 * t151 * t147;
  t615 = 0.1e1 / t85;
  t616 = t144 * t615;
  t619 = t286 * t181;
  t621 = t286 * t269;
  t623 = 0.1e1 / t23;
  t624 = t150 * t623;
  t627 = t289 * t181;
  t629 = t289 * t269;
  t631 = t153 * t585;
  t634 = t292 * t181;
  t636 = t292 * t269;
  t638 = t156 * t589;
  t641 = t295 * t181;
  t643 = t295 * t269;
  t645 = 0.55e2 / 0.36e2 * t608 * t136 + t612 + t614 + 0.7e1 / 0.36e2 * t616 * t148 + 0.14e2 / 0.3e1 * t619 - 0.14e2 / 0.3e1 * t621 + 0.4e1 / 0.9e1 * t624 * t148 + 0.16e2 / 0.3e1 * t627 - 0.16e2 / 0.3e1 * t629 + 0.3e1 / 0.4e1 * t631 * t148 + 0.6e1 * t634 - 0.6e1 * t636 + 0.1e2 / 0.9e1 * t638 * t148 + 0.2e2 / 0.3e1 * t641 - 0.2e2 / 0.3e1 * t643;
  t647 = 0.8e1 * t145 * t482;
  t648 = 0.1e1 / t564;
  t649 = t146 * t648;
  t651 = 0.6e1 * t145 * t649;
  t653 = 0.8e1 * t151 * t482;
  t655 = 0.6e1 * t151 * t649;
  t657 = 0.8e1 * t154 * t482;
  t659 = 0.6e1 * t154 * t649;
  t661 = 0.8e1 * t157 * t482;
  t663 = 0.6e1 * t157 * t649;
  t672 = pow(rho[0], -0.9166666666666666667e0);
  t676 = 0.2e1 * t154 * t147;
  t678 = 0.2e1 * t157 * t147;
  t679 = -t647 + t651 - t653 + t655 - t657 + t659 - t661 + t663 + 0.7e1 / 0.36e2 * t1 * t615 + 0.4e1 / 0.9e1 * t8 * t623 + 0.3e1 / 0.4e1 * t15 * t585 + 0.1e2 / 0.9e1 * t22 * t589 + 0.90277777777777777739e-1 * t159 * t672 + t676 + t678;
  tv2rho20 = t553 + t606 + t645 + t679;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t681 = t394 * t181;
  t683 = t394 * t269;
  t685 = t397 * t181;
  t687 = t397 * t269;
  t689 = t400 * t181;
  t691 = t400 * t269;
  t693 = t403 * t181;
  t695 = t403 * t269;
  t700 = -t612 - t614 + 0.7e1 / 0.3e1 * t681 - 0.7e1 / 0.3e1 * t683 + 0.8e1 / 0.3e1 * t685 - 0.8e1 / 0.3e1 * t687 + 0.3e1 * t689 - 0.3e1 * t691 + 0.1e2 / 0.3e1 * t693 - 0.1e2 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t619 - 0.7e1 / 0.3e1 * t621 - 0.8e1 / 0.3e1 * t627;
  t708 = t478 * t310;
  t711 = t53 * t45;
  t715 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t708 * t182 + 0.8e1 / 0.3e1 * t711 * t268);
  t716 = t715 * t57;
  t721 = t493 * t322;
  t724 = t65 * t45;
  t728 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t721 * t189 - 0.8e1 / 0.3e1 * t724 * t268);
  t729 = t728 * t57;
  t732 = -t178 * t314 / 0.3e1 + t44 * t716 / 0.4e1 - t319 * t193 / 0.3e1 + t62 * t729 / 0.4e1;
  t739 = -0.8e1 / 0.3e1 * t629 - 0.3e1 * t634 - 0.3e1 * t636 - 0.1e2 / 0.3e1 * t641 - 0.1e2 / 0.3e1 * t643 + t651 + t655 + t659 + t663 - t676 - t678 + t41 * t732 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t329 + 0.17e2 / 0.24e2 * t332 * t196;
  t759 = t220 * t350;
  t761 = t185 * t56;
  t762 = t761 * t313;
  t763 = t100 * t762;
  t765 = t223 * t715;
  t766 = t100 * t765;
  t768 = t356 * t228;
  t770 = t192 * t56;
  t771 = t770 * t325;
  t772 = t107 * t771;
  t774 = t227 * t728;
  t775 = t107 * t774;
  t777 = -0.2e1 / 0.3e1 * t759 + t763 / 0.4e1 + t766 / 0.4e1 - 0.2e1 / 0.3e1 * t768 + t772 / 0.4e1 + t775 / 0.4e1;
  t786 = t75 * t732 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t329 + 0.3e1 / 0.4e1 * t337 * t196 + 0.5e1 / 0.6e1 * t342 * t196 + 0.5e1 / 0.6e1 * t209 * t329 + t92 * t732 / 0.2e1 + t79 * t732 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t329 + 0.11e2 / 0.12e2 * t347 * t196 + t96 * t777 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t362 + 0.5e1 / 0.6e1 * t365 * t231 + t116 * t777 / 0.2e1;
  t801 = -0.4e1 / 0.3e1 * t759 + t763 / 0.2e1 + t766 / 0.2e1 - 0.4e1 / 0.3e1 * t768 + t772 / 0.2e1 + t775 / 0.2e1 - t568;
  t817 = 0.11e2 / 0.12e2 * t239 * t362 + 0.11e2 / 0.12e2 * t370 * t231 + t121 * t777 / 0.2e1 + t245 * t362 + t376 * t231 + t125 * t801 + 0.5e1 / 0.3e1 * t257 * t381 + 0.5e1 / 0.3e1 * t383 * t255 + t139 * t801 + 0.11e2 / 0.6e1 * t261 * t381 + 0.11e2 / 0.6e1 * t387 * t255 + t142 * t801 + 0.2e1 * t265 * t381 + 0.2e1 * t391 * t255;
  tv2rho21 = t700 + t739 + t786 + t817;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t827 = t467 + t469 + t612 + t614 - 0.14e2 / 0.3e1 * t681 - 0.14e2 / 0.3e1 * t683 - 0.16e2 / 0.3e1 * t685 - 0.16e2 / 0.3e1 * t687 - 0.6e1 * t689 - 0.6e1 * t691 - 0.2e2 / 0.3e1 * t693 - 0.2e2 / 0.3e1 * t695 + t647 + t651;
  t828 = 0.1e1 / t89;
  t829 = t144 * t828;
  t832 = 0.1e1 / t25;
  t833 = t150 * t832;
  t836 = 0.1e1 / t18;
  t837 = t153 * t836;
  t840 = 0.1e1 / t11;
  t841 = t156 * t840;
  t852 = pow(rho[1], -0.9166666666666666667e0);
  t855 = t653 + t655 + t657 + t659 + t661 + t663 + 0.7e1 / 0.36e2 * t829 * t148 + 0.4e1 / 0.9e1 * t833 * t148 + 0.3e1 / 0.4e1 * t837 * t148 + 0.1e2 / 0.9e1 * t841 * t148 + 0.7e1 / 0.36e2 * t1 * t828 + 0.4e1 / 0.9e1 * t8 * t832 + 0.3e1 / 0.4e1 * t15 * t836 + 0.1e2 / 0.9e1 * t22 * t840 + 0.90277777777777777739e-1 * t159 * t852;
  t857 = t310 * t310;
  t861 = 0.2e1 * t147 + 0.2e1 * t482;
  t865 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t857 + 0.4e1 / 0.3e1 * t53 * t861);
  t866 = t865 * t57;
  t870 = 0.1e1 / t11 / t353;
  t871 = t60 * t870;
  t876 = t322 * t322;
  t879 = -t861;
  t883 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t876 + 0.4e1 / 0.3e1 * t65 * t879);
  t884 = t883 * t57;
  t887 = t44 * t866 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t68 - 0.2e1 / 0.3e1 * t319 * t326 + t62 * t884 / 0.4e1;
  t904 = t313 * t313;
  t905 = t904 * t56;
  t906 = t100 * t905;
  t908 = t223 * t865;
  t909 = t100 * t908;
  t911 = t104 * t104;
  t913 = 0.1e1 / t25 / t911;
  t914 = sigma[2] * t913;
  t915 = t914 * t109;
  t917 = t356 * t359;
  t919 = t325 * t325;
  t920 = t919 * t56;
  t921 = t107 * t920;
  t923 = t227 * t883;
  t924 = t107 * t923;
  t926 = t906 / 0.4e1 + t909 / 0.4e1 + 0.11e2 / 0.9e1 * t915 - 0.4e1 / 0.3e1 * t917 + t921 / 0.4e1 + t924 / 0.4e1;
  t937 = t676 + t678 + t41 * t887 / 0.2e1 + 0.17e2 / 0.12e2 * t332 * t329 + t75 * t887 / 0.2e1 + 0.3e1 / 0.2e1 * t337 * t329 + t79 * t887 / 0.2e1 + 0.5e1 / 0.3e1 * t342 * t329 + t92 * t887 / 0.2e1 + 0.11e2 / 0.6e1 * t347 * t329 + t96 * t926 / 0.2e1 + 0.5e1 / 0.3e1 * t365 * t362 + t116 * t926 / 0.2e1 + 0.11e2 / 0.6e1 * t370 * t362 + t121 * t926 / 0.2e1;
  t946 = t906 / 0.2e1 + t909 / 0.2e1 + 0.22e2 / 0.9e1 * t915 - 0.8e1 / 0.3e1 * t917 + t921 / 0.2e1 + t924 / 0.2e1 - t568;
  t956 = t36 * t35;
  t957 = t37 * t956;
  t959 = t29 / t957;
  t962 = t74 * t836;
  t965 = t78 * t840;
  t968 = 0.1e1 / t4;
  t969 = t82 * t968;
  t972 = t95 * t840;
  t975 = t115 * t968;
  t978 = t124 * t840;
  t981 = t138 * t968;
  t984 = 0.2e1 * t376 * t362 + t125 * t946 + 0.1e2 / 0.3e1 * t383 * t381 + t139 * t946 + 0.11e2 / 0.3e1 * t387 * t381 + t142 * t946 + 0.4e1 * t391 * t381 + 0.85e2 / 0.288e3 * t959 * t71 + 0.3e1 / 0.8e1 * t962 * t71 + 0.5e1 / 0.9e1 * t965 * t71 + 0.55e2 / 0.72e2 * t969 * t71 + 0.5e1 / 0.9e1 * t972 * t112 + 0.55e2 / 0.72e2 * t975 * t112 + 0.1e2 / 0.9e1 * t978 * t136 + 0.55e2 / 0.36e2 * t981 * t136;
  tv2rho22 = t827 + t855 + t937 + t984;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t987 = t43 * t185 * t57;
  t996 = t96 * t99;
  t999 = t116 * t99;
  t1002 = t121 * t99;
  t1006 = t177 * t55 * t57;
  t1016 = t95 / t97;
  t1019 = 0.1e1 / t86;
  t1020 = t115 * t1019;
  t1023 = t408 * t987 / 0.16e2 + t413 * t987 / 0.16e2 + t416 * t987 / 0.16e2 + t419 * t987 / 0.16e2 + t996 * t224 / 0.8e1 + t999 * t224 / 0.8e1 + t1002 * t224 / 0.8e1 - t408 * t1006 / 0.12e2 - t413 * t1006 / 0.12e2 - t416 * t1006 / 0.12e2 - t419 * t1006 / 0.12e2 + 0.5e1 / 0.48e2 * t1016 * t102 + 0.11e2 / 0.96e2 * t1020 * t102;
  t1024 = 0.1e1 / t24;
  t1025 = t119 * t1024;
  t1028 = t32 * t32;
  t1029 = t1028 * t579;
  t1031 = t29 / t1029;
  t1033 = t407 * t55 * t57;
  t1036 = t74 * t615;
  t1039 = t78 * t623;
  t1042 = t82 * t585;
  t1046 = t219 * t101 * t56;
  t1054 = t99 * t55;
  t1057 = 0.8e1 / 0.3e1 * t252;
  t1058 = -0.2e1 / 0.3e1 * t1046 + t1054 * t761 / 0.2e1 + t1057;
  t1068 = t1025 * t102 / 0.8e1 + 0.17e2 / 0.192e3 * t1031 * t1033 + 0.3e1 / 0.32e2 * t1036 * t1033 + 0.5e1 / 0.48e2 * t1039 * t1033 + 0.11e2 / 0.96e2 * t1042 * t1033 - t96 * t1046 / 0.6e1 - t116 * t1046 / 0.6e1 - t121 * t1046 / 0.6e1 + t125 * t1058 + 0.5e1 / 0.3e1 * t257 * t431 + t139 * t1058 + 0.11e2 / 0.6e1 * t261 * t431 + t142 * t1058 + 0.2e1 * t265 * t431;
  tv2rhosigma0 = t1023 + t1068;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1072 = 0.16e2 / 0.3e1 * t125 * t252;
  t1076 = 0.16e2 / 0.3e1 * t139 * t252;
  t1080 = 0.16e2 / 0.3e1 * t142 * t252;
  tv2rhosigma1 = -0.1e2 / 0.3e1 * t257 * t134 + t1072 - 0.11e2 / 0.3e1 * t261 * t134 + t1076 - 0.4e1 * t265 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1081 = t199 * t439;
  t1085 = t61 * t192 * t57;
  t1088 = t204 * t439;
  t1093 = t209 * t439;
  t1098 = t214 * t439;
  t1105 = t96 * t106;
  t1110 = t116 * t106;
  t1115 = t121 * t106;
  t1120 = t106 * t67;
  t1123 = t1120 * t770 / 0.2e1 + t1057;
  tv2rhosigma2 = 0.17e2 / 0.192e3 * t1081 * t442 + t440 * t1085 / 0.16e2 + 0.3e1 / 0.32e2 * t1088 * t442 + t445 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t442 + t448 * t1085 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t442 + t451 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t234 * t455 + t1105 * t228 / 0.8e1 + 0.11e2 / 0.96e2 * t239 * t455 + t1110 * t228 / 0.8e1 + t245 * t455 / 0.8e1 + t1115 * t228 / 0.8e1 + 0.5e1 / 0.3e1 * t257 * t463 + t125 * t1123 + 0.11e2 / 0.6e1 * t261 * t463 + t139 * t1123 + 0.2e1 * t265 * t463 + t142 * t1123;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1131 = t332 * t407;
  t1135 = t43 * t313 * t57;
  t1138 = t337 * t407;
  t1143 = t342 * t407;
  t1148 = t347 * t407;
  t1167 = t56 * t313;
  t1170 = t1054 * t1167 / 0.2e1 + t1057;
  tv2rhosigma3 = 0.17e2 / 0.192e3 * t1131 * t410 + t408 * t1135 / 0.16e2 + 0.3e1 / 0.32e2 * t1138 * t410 + t413 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t410 + t416 * t1135 / 0.16e2 + 0.11e2 / 0.96e2 * t1148 * t410 + t419 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t365 * t423 + t996 * t350 / 0.8e1 + 0.11e2 / 0.96e2 * t370 * t423 + t999 * t350 / 0.8e1 + t376 * t423 / 0.8e1 + t1002 * t350 / 0.8e1 + 0.5e1 / 0.3e1 * t383 * t431 + t125 * t1170 + 0.11e2 / 0.6e1 * t387 * t431 + t139 * t1170 + 0.2e1 * t391 * t431 + t142 * t1170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.1e2 / 0.3e1 * t383 * t134 + t1072 - 0.11e2 / 0.3e1 * t387 * t134 + t1076 - 0.4e1 * t391 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1185 = t61 * t325 * t57;
  t1201 = t318 * t67 * t57;
  t1211 = t95 / t104;
  t1214 = 0.1e1 / t90;
  t1215 = t115 * t1214;
  t1218 = t440 * t1185 / 0.16e2 + t445 * t1185 / 0.16e2 + t448 * t1185 / 0.16e2 + t451 * t1185 / 0.16e2 + t1105 * t359 / 0.8e1 + t1110 * t359 / 0.8e1 + t1115 * t359 / 0.8e1 - t440 * t1201 / 0.12e2 - t445 * t1201 / 0.12e2 - t448 * t1201 / 0.12e2 - t451 * t1201 / 0.12e2 + 0.5e1 / 0.48e2 * t1211 * t109 + 0.11e2 / 0.96e2 * t1215 * t109;
  t1219 = 0.1e1 / t26;
  t1220 = t119 * t1219;
  t1224 = t355 * t108 * t56;
  t1231 = t37 * t37;
  t1232 = t1231 * t956;
  t1234 = t29 / t1232;
  t1236 = t439 * t67 * t57;
  t1239 = t74 * t828;
  t1242 = t78 * t832;
  t1245 = t82 * t836;
  t1249 = t56 * t325;
  t1252 = -0.2e1 / 0.3e1 * t1224 + t1120 * t1249 / 0.2e1 + t1057;
  t1262 = t1220 * t109 / 0.8e1 - t96 * t1224 / 0.6e1 - t116 * t1224 / 0.6e1 - t121 * t1224 / 0.6e1 + 0.17e2 / 0.192e3 * t1234 * t1236 + 0.3e1 / 0.32e2 * t1239 * t1236 + 0.5e1 / 0.48e2 * t1242 * t1236 + 0.11e2 / 0.96e2 * t1245 * t1236 + t125 * t1252 + 0.5e1 / 0.3e1 * t383 * t463 + t139 * t1252 + 0.11e2 / 0.6e1 * t387 * t463 + t142 * t1252 + 0.2e1 * t391 * t463;
  tv2rhosigma5 = t1218 + t1262;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1264 = 0.1e1 / t42 / sigma[0];
  t1265 = t41 * t1264;
  t1267 = t75 * t1264;
  t1269 = t79 * t1264;
  t1271 = t92 * t1264;
  tv2sigma20 = -t1265 * t410 / 0.32e2 - t1267 * t410 / 0.32e2 - t1269 * t410 / 0.32e2 - t1271 * t410 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1275 = 0.1e1 / t60 / sigma[2];
  t1276 = t41 * t1275;
  t1278 = t75 * t1275;
  t1280 = t79 * t1275;
  t1282 = t92 * t1275;
  tv2sigma25 = -t1276 * t442 / 0.32e2 - t1278 * t442 / 0.32e2 - t1280 * t442 / 0.32e2 - t1282 * t442 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1285 = t564 * t46;
  t1286 = 0.1e1 / t1285;
  t1287 = t146 * t1286;
  t1289 = 0.24e2 * t151 * t1287;
  t1290 = t45 * t648;
  t1291 = t154 * t1290;
  t1292 = 0.36e2 * t1291;
  t1294 = 0.24e2 * t154 * t1287;
  t1295 = t157 * t1290;
  t1296 = 0.36e2 * t1295;
  t1298 = 0.24e2 * t157 * t1287;
  t1299 = t144 * t1019;
  t1302 = t616 * t181;
  t1304 = t616 * t269;
  t1306 = t286 * t482;
  t1308 = t286 * t649;
  t1310 = t150 * t1024;
  t1313 = t624 * t181;
  t1315 = t624 * t269;
  t1317 = t289 * t482;
  t1319 = t289 * t649;
  t1321 = 0.1e1 / t17;
  t1322 = t153 * t1321;
  t1325 = t631 * t181;
  t1327 = t631 * t269;
  t1329 = t292 * t482;
  t1331 = -t1289 + t1292 - t1294 + t1296 - t1298 - 0.35e2 / 0.216e3 * t1299 * t148 + 0.7e1 / 0.6e1 * t1302 - 0.7e1 / 0.6e1 * t1304 - 0.28e2 * t1306 + 0.21e2 * t1308 - 0.8e1 / 0.27e2 * t1310 * t148 + 0.8e1 / 0.3e1 * t1313 - 0.8e1 / 0.3e1 * t1315 - 0.32e2 * t1317 + 0.24e2 * t1319 - 0.3e1 / 0.8e1 * t1322 * t148 + 0.9e1 / 0.2e1 * t1325 - 0.9e1 / 0.2e1 * t1327 - 0.36e2 * t1329;
  t1332 = t292 * t649;
  t1334 = t156 * t43;
  t1337 = t638 * t181;
  t1339 = t638 * t269;
  t1341 = t295 * t482;
  t1343 = t295 * t649;
  t1345 = t145 * t1290;
  t1346 = 0.36e2 * t1345;
  t1348 = 0.24e2 * t145 * t1287;
  t1349 = t151 * t1290;
  t1350 = 0.36e2 * t1349;
  t1359 = pow(rho[0], -0.19166666666666666667e1);
  t1362 = t119 * t231;
  t1364 = t141 * t255;
  t1366 = t286 * t147;
  t1368 = t289 * t147;
  t1370 = t292 * t147;
  t1372 = t295 * t147;
  t1374 = 0.27e2 * t1332 - 0.1e2 / 0.27e2 * t1334 * t148 + 0.2e2 / 0.3e1 * t1337 - 0.2e2 / 0.3e1 * t1339 - 0.4e2 * t1341 + 0.3e2 * t1343 + t1346 - t1348 + t1350 - 0.35e2 / 0.216e3 * t1 * t1019 - 0.8e1 / 0.27e2 * t8 * t1024 - 0.3e1 / 0.8e1 * t15 * t1321 - 0.1e2 / 0.27e2 * t22 * t43 - 0.82754629629629629597e-1 * t159 * t1359 + 0.3e1 * t1362 + 0.6e1 * t1364 + 0.7e1 * t1366 + 0.8e1 * t1368 + 0.9e1 * t1370 + 0.1e2 * t1372;
  t1377 = 0.1e1 / t9 / t522;
  t1378 = t42 * t1377;
  t1385 = 0.1e1 / t477 / t49;
  t1386 = t479 * t182;
  t1389 = t478 * t182;
  t1393 = 0.6e1 * t268 - 0.6e1 * t1290;
  t1397 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1385 * t1386 + 0.4e1 / 0.3e1 * t1389 * t484 + 0.4e1 / 0.3e1 * t53 * t1393);
  t1398 = t1397 * t57;
  t1402 = 0.1e1 / t492 / t63;
  t1403 = t494 * t189;
  t1406 = t493 * t189;
  t1409 = -t1393;
  t1413 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1402 * t1403 + 0.4e1 / 0.3e1 * t1406 * t497 + 0.4e1 / 0.3e1 * t65 * t1409);
  t1414 = t1413 * t57;
  t1417 = -0.7e2 / 0.27e2 * t1378 * t58 + 0.7e1 / 0.3e1 * t472 * t186 - t178 * t489 + t44 * t1398 / 0.4e1 + t62 * t1414 / 0.4e1;
  t1426 = t522 * rho[0];
  t1428 = 0.1e1 / t23 / t1426;
  t1429 = sigma[0] * t1428;
  t1430 = t1429 * t102;
  t1432 = t525 * t224;
  t1434 = t220 * t531;
  t1436 = t220 * t534;
  t1438 = t761 * t488;
  t1439 = t100 * t1438;
  t1441 = t223 * t1397;
  t1442 = t100 * t1441;
  t1444 = t770 * t501;
  t1445 = t107 * t1444;
  t1447 = t227 * t1413;
  t1448 = t107 * t1447;
  t1450 = -0.154e3 / 0.27e2 * t1430 + 0.22e2 / 0.3e1 * t1432 - 0.2e1 * t1434 - 0.2e1 * t1436 + 0.3e1 / 0.4e1 * t1439 + t1442 / 0.4e1 + 0.3e1 / 0.4e1 * t1445 + t1448 / 0.4e1;
  t1472 = 0.1e1 / t132 / t1285;
  t1474 = 0.1232e4 / 0.27e2 * t129 * t1472;
  t1475 = -0.308e3 / 0.27e2 * t1430 + 0.44e2 / 0.3e1 * t1432 - 0.4e1 * t1434 - 0.4e1 * t1436 + 0.3e1 / 0.2e1 * t1439 + t1442 / 0.2e1 + 0.3e1 / 0.2e1 * t1445 + t1448 / 0.2e1 + t1474;
  t1493 = t79 * t1417 / 0.2e1 + 0.5e1 / 0.2e1 * t209 * t505 + t92 * t1417 / 0.2e1 + 0.11e2 / 0.4e1 * t214 * t505 + t96 * t1450 / 0.2e1 + 0.5e1 / 0.2e1 * t234 * t544 + t116 * t1450 / 0.2e1 + 0.11e2 / 0.4e1 * t239 * t544 + t121 * t1450 / 0.2e1 + 0.3e1 * t245 * t544 + t125 * t1475 + 0.5e1 * t257 * t569 + t139 * t1475 + 0.11e2 / 0.2e1 * t261 * t569 + t142 * t1475 + 0.6e1 * t265 * t569 + t41 * t1417 / 0.2e1 + 0.17e2 / 0.8e1 * t199 * t505 + t75 * t1417 / 0.2e1 + 0.9e1 / 0.4e1 * t204 * t505;
  t1494 = t145 * t268;
  t1495 = 0.12e2 * t1494;
  t1496 = t151 * t268;
  t1497 = 0.12e2 * t1496;
  t1498 = t154 * t268;
  t1499 = 0.12e2 * t1498;
  t1500 = t157 * t268;
  t1501 = 0.12e2 * t1500;
  t1504 = t29 / t580 / rho[0];
  t1507 = t74 * t1321;
  t1510 = t78 * t43;
  t1513 = 0.1e1 / t3;
  t1514 = t82 * t1513;
  t1517 = t95 * t43;
  t1520 = t115 * t1513;
  t1523 = t124 * t43;
  t1526 = t138 * t1513;
  t1545 = -t1495 - t1497 - t1499 - t1501 - 0.595e3 / 0.3456e4 * t1504 * t71 - 0.3e1 / 0.16e2 * t1507 * t71 - 0.5e1 / 0.27e2 * t1510 * t71 - 0.55e2 / 0.432e3 * t1514 * t71 - 0.5e1 / 0.27e2 * t1517 * t112 - 0.55e2 / 0.432e3 * t1520 * t112 - 0.1e2 / 0.27e2 * t1523 * t136 - 0.55e2 / 0.216e3 * t1526 * t136 + 0.5e1 / 0.3e1 * t597 * t231 + 0.55e2 / 0.24e2 * t600 * t231 + 0.1e2 / 0.3e1 * t603 * t255 + 0.55e2 / 0.12e2 * t608 * t255 + 0.9e1 / 0.8e1 * t586 * t196 + 0.5e1 / 0.3e1 * t590 * t196 + 0.55e2 / 0.24e2 * t594 * t196 + 0.85e2 / 0.96e2 * t582 * t196;
  tv3rho30 = t1331 + t1374 + t1493 + t1545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1547 = 0.12e2 * t1291;
  t1548 = 0.12e2 * t1295;
  t1561 = 0.12e2 * t1345;
  t1562 = 0.12e2 * t1349;
  t1563 = -t1289 + t1547 - t1294 + t1548 - t1298 - 0.7e1 / 0.18e2 * t1302 - 0.7e1 / 0.18e2 * t1304 + 0.14e2 * t1308 - 0.8e1 / 0.9e1 * t1313 - 0.8e1 / 0.9e1 * t1315 + 0.16e2 * t1319 - 0.3e1 / 0.2e1 * t1325 - 0.3e1 / 0.2e1 * t1327 + 0.18e2 * t1332 - 0.2e2 / 0.9e1 * t1337 - 0.2e2 / 0.9e1 * t1339 + 0.2e2 * t1343 + t1561 - t1348 + t1562;
  t1564 = t397 * t482;
  t1566 = t397 * t649;
  t1568 = t400 * t482;
  t1570 = t400 * t649;
  t1572 = t403 * t482;
  t1574 = t403 * t649;
  t1576 = t394 * t482;
  t1578 = t394 * t649;
  t1580 = t141 * t381;
  t1582 = t119 * t362;
  t1587 = 0.4e1 * t1494;
  t1588 = 0.4e1 * t1496;
  t1589 = 0.4e1 * t1498;
  t1590 = 0.4e1 * t1500;
  t1595 = -0.32e2 / 0.3e1 * t1564 + 0.8e1 * t1566 - 0.12e2 * t1568 + 0.9e1 * t1570 - 0.4e2 / 0.3e1 * t1572 + 0.1e2 * t1574 - 0.28e2 / 0.3e1 * t1576 + 0.7e1 * t1578 + 0.2e1 * t1580 + t1582 - 0.14e2 / 0.3e1 * t1366 - 0.16e2 / 0.3e1 * t1368 - 0.6e1 * t1370 - 0.2e2 / 0.3e1 * t1372 + t1587 + t1588 + t1589 + t1590 + 0.4e1 * t265 * t801 + 0.2e1 * t391 * t569;
  t1597 = t525 * t350;
  t1599 = t220 * t762;
  t1601 = t220 * t765;
  t1603 = t488 * t56;
  t1604 = t1603 * t313;
  t1605 = t100 * t1604;
  t1607 = t761 * t715;
  t1608 = t100 * t1607;
  t1610 = t1385 * t310;
  t1613 = t478 * t45;
  t1624 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1610 * t479 + 0.16e2 / 0.9e1 * t1613 * t268 * t182 + 0.4e1 / 0.9e1 * t708 * t484 + 0.8e1 / 0.3e1 * t53 * t268 - 0.8e1 * t711 * t648);
  t1625 = t223 * t1624;
  t1626 = t100 * t1625;
  t1628 = t356 * t538;
  t1630 = t356 * t541;
  t1632 = t501 * t56;
  t1633 = t1632 * t325;
  t1634 = t107 * t1633;
  t1636 = t770 * t728;
  t1637 = t107 * t1636;
  t1639 = t1402 * t322;
  t1642 = t493 * t45;
  t1653 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1639 * t494 - 0.16e2 / 0.9e1 * t1642 * t268 * t189 + 0.4e1 / 0.9e1 * t721 * t497 - 0.8e1 / 0.3e1 * t65 * t268 + 0.8e1 * t724 * t648);
  t1654 = t227 * t1653;
  t1655 = t107 * t1654;
  t1657 = 0.22e2 / 0.9e1 * t1597 - 0.4e1 / 0.3e1 * t1599 - 0.4e1 / 0.3e1 * t1601 + t1605 / 0.4e1 + t1608 / 0.2e1 + t1626 / 0.4e1 - 0.2e1 / 0.3e1 * t1628 - 0.2e1 / 0.3e1 * t1630 + t1634 / 0.4e1 + t1637 / 0.2e1 + t1655 / 0.4e1;
  t1684 = 0.44e2 / 0.9e1 * t1597 - 0.8e1 / 0.3e1 * t1599 - 0.8e1 / 0.3e1 * t1601 + t1605 / 0.2e1 + t1608 + t1626 / 0.2e1 - 0.4e1 / 0.3e1 * t1628 - 0.4e1 / 0.3e1 * t1630 + t1634 / 0.2e1 + t1637 + t1655 / 0.2e1 + t1474;
  t1700 = t1624 * t57;
  t1705 = t1653 * t57;
  t1708 = 0.7e1 / 0.9e1 * t472 * t314 - 0.2e1 / 0.3e1 * t178 * t716 + t44 * t1700 / 0.4e1 - t319 * t502 / 0.3e1 + t62 * t1705 / 0.4e1;
  t1717 = t96 * t1657 / 0.2e1 + 0.5e1 / 0.3e1 * t234 * t777 + 0.5e1 / 0.6e1 * t365 * t544 + t116 * t1657 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t777 + 0.11e2 / 0.12e2 * t370 * t544 + t121 * t1657 / 0.2e1 + 0.2e1 * t245 * t777 + t376 * t544 + t125 * t1684 + 0.1e2 / 0.3e1 * t257 * t801 + 0.5e1 / 0.3e1 * t383 * t569 + t139 * t1684 + 0.11e2 / 0.3e1 * t261 * t801 + 0.11e2 / 0.6e1 * t387 * t569 + t142 * t1684 + t41 * t1708 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t732 + 0.17e2 / 0.24e2 * t332 * t505 + t75 * t1708 / 0.2e1;
  t1734 = t394 * t147;
  t1736 = t397 * t147;
  t1738 = t400 * t147;
  t1740 = t403 * t147;
  t1758 = 0.3e1 / 0.2e1 * t204 * t732 + 0.3e1 / 0.4e1 * t337 * t505 + t79 * t1708 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t732 + 0.5e1 / 0.6e1 * t342 * t505 + t92 * t1708 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t732 + 0.11e2 / 0.12e2 * t347 * t505 + 0.7e1 / 0.3e1 * t1734 + 0.8e1 / 0.3e1 * t1736 + 0.3e1 * t1738 + 0.1e2 / 0.3e1 * t1740 + 0.3e1 / 0.8e1 * t586 * t329 + 0.5e1 / 0.9e1 * t590 * t329 + 0.55e2 / 0.72e2 * t594 * t329 + 0.5e1 / 0.9e1 * t597 * t362 + 0.55e2 / 0.72e2 * t600 * t362 + 0.1e2 / 0.9e1 * t603 * t381 + 0.55e2 / 0.36e2 * t608 * t381 + 0.85e2 / 0.288e3 * t582 * t329;
  tv3rho31 = t1563 + t1595 + t1717 + t1758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1772 = -t1289 - t1547 - t1294 - t1548 - t1298 + 0.28e2 / 0.3e1 * t1306 + 0.7e1 * t1308 + 0.32e2 / 0.3e1 * t1317 + 0.8e1 * t1319 + 0.12e2 * t1329 + 0.9e1 * t1332 + 0.4e2 / 0.3e1 * t1341 + 0.1e2 * t1343 - t1561 - t1348 - t1562 + 0.16e2 * t1566 + 0.18e2 * t1570 + 0.2e2 * t1574 + 0.14e2 * t1578;
  t1794 = t1362 + 0.2e1 * t1364 + 0.7e1 / 0.3e1 * t1366 + 0.8e1 / 0.3e1 * t1368 + 0.3e1 * t1370 + 0.1e2 / 0.3e1 * t1372 + t1587 + t1588 + t1589 + t1590 - 0.14e2 / 0.3e1 * t1734 - 0.16e2 / 0.3e1 * t1736 - 0.6e1 * t1738 - 0.2e2 / 0.3e1 * t1740 + 0.85e2 / 0.288e3 * t959 * t196 + 0.3e1 / 0.8e1 * t962 * t196 + 0.5e1 / 0.9e1 * t965 * t196 + 0.55e2 / 0.72e2 * t969 * t196 + 0.5e1 / 0.9e1 * t972 * t231 + 0.55e2 / 0.72e2 * t975 * t231;
  t1802 = t1385 * t857;
  t1807 = t478 * t861;
  t1812 = -0.2e1 * t268 - 0.6e1 * t1290;
  t1816 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1802 * t182 + 0.16e2 / 0.9e1 * t708 * t482 + 0.4e1 / 0.9e1 * t1807 * t182 + 0.4e1 / 0.3e1 * t53 * t1812);
  t1817 = t1816 * t57;
  t1824 = t1402 * t876;
  t1829 = t493 * t879;
  t1832 = -t1812;
  t1836 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1824 * t189 - 0.16e2 / 0.9e1 * t721 * t482 + 0.4e1 / 0.9e1 * t1829 * t189 + 0.4e1 / 0.3e1 * t65 * t1832);
  t1837 = t1836 * t57;
  t1840 = -t178 * t866 / 0.3e1 + t44 * t1817 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t193 - 0.2e1 / 0.3e1 * t319 * t729 + t62 * t1837 / 0.4e1;
  t1859 = t220 * t905;
  t1861 = t1167 * t715;
  t1862 = t100 * t1861;
  t1864 = t220 * t908;
  t1866 = t761 * t865;
  t1867 = t100 * t1866;
  t1869 = t223 * t1816;
  t1870 = t100 * t1869;
  t1872 = t914 * t228;
  t1874 = t356 * t771;
  t1876 = t356 * t774;
  t1878 = t1249 * t728;
  t1879 = t107 * t1878;
  t1881 = t770 * t883;
  t1882 = t107 * t1881;
  t1884 = t227 * t1836;
  t1885 = t107 * t1884;
  t1887 = -0.2e1 / 0.3e1 * t1859 + t1862 / 0.2e1 - 0.2e1 / 0.3e1 * t1864 + t1867 / 0.4e1 + t1870 / 0.4e1 + 0.22e2 / 0.9e1 * t1872 - 0.4e1 / 0.3e1 * t1874 - 0.4e1 / 0.3e1 * t1876 + t1879 / 0.2e1 + t1882 / 0.4e1 + t1885 / 0.4e1;
  t1905 = 0.1e2 / 0.9e1 * t978 * t255 + 0.55e2 / 0.36e2 * t981 * t255 + t75 * t1840 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t887 + 0.3e1 / 0.2e1 * t337 * t732 + t79 * t1840 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t887 + 0.5e1 / 0.3e1 * t342 * t732 + t92 * t1840 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t887 + 0.11e2 / 0.6e1 * t347 * t732 + t96 * t1887 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t926 + 0.5e1 / 0.3e1 * t365 * t777 + t116 * t1887 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t926 + 0.11e2 / 0.6e1 * t370 * t777 + t121 * t1887 / 0.2e1 + t245 * t926 + 0.2e1 * t376 * t777;
  t1915 = -0.4e1 / 0.3e1 * t1859 + t1862 - 0.4e1 / 0.3e1 * t1864 + t1867 / 0.2e1 + t1870 / 0.2e1 + 0.44e2 / 0.9e1 * t1872 - 0.8e1 / 0.3e1 * t1874 - 0.8e1 / 0.3e1 * t1876 + t1879 + t1882 / 0.2e1 + t1885 / 0.2e1 + t1474;
  t1937 = t829 * t181;
  t1939 = t829 * t269;
  t1941 = t833 * t181;
  t1943 = t833 * t269;
  t1945 = t837 * t181;
  t1947 = t837 * t269;
  t1949 = t841 * t181;
  t1951 = t841 * t269;
  t1953 = t125 * t1915 + 0.5e1 / 0.3e1 * t257 * t946 + 0.1e2 / 0.3e1 * t383 * t801 + t139 * t1915 + 0.11e2 / 0.6e1 * t261 * t946 + 0.11e2 / 0.3e1 * t387 * t801 + t142 * t1915 + 0.2e1 * t265 * t946 + 0.4e1 * t391 * t801 + t41 * t1840 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t887 + 0.17e2 / 0.12e2 * t332 * t732 + 0.7e1 / 0.18e2 * t1937 - 0.7e1 / 0.18e2 * t1939 + 0.8e1 / 0.9e1 * t1941 - 0.8e1 / 0.9e1 * t1943 + 0.3e1 / 0.2e1 * t1945 - 0.3e1 / 0.2e1 * t1947 + 0.2e2 / 0.9e1 * t1949 - 0.2e2 / 0.9e1 * t1951;
  tv3rho32 = t1772 + t1794 + t1905 + t1953;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1955 = t144 * t1214;
  t1958 = t150 * t1219;
  t1961 = 0.1e1 / t19;
  t1962 = t153 * t1961;
  t1965 = t156 * t61;
  t1976 = pow(rho[1], -0.19166666666666666667e1);
  t1981 = -0.35e2 / 0.216e3 * t1955 * t148 - 0.8e1 / 0.27e2 * t1958 * t148 - 0.3e1 / 0.8e1 * t1962 * t148 - 0.1e2 / 0.27e2 * t1965 * t148 - 0.35e2 / 0.216e3 * t1 * t1214 - 0.8e1 / 0.27e2 * t8 * t1219 - 0.3e1 / 0.8e1 * t15 * t1961 - 0.1e2 / 0.27e2 * t22 * t61 - 0.82754629629629629597e-1 * t159 * t1976 - t1289 - t1292 - t1294 - t1296 - t1298 - t1346 - t1348 - t1350 + 0.32e2 * t1564 + 0.24e2 * t1566;
  t1996 = t29 / t957 / rho[1];
  t1999 = t74 * t1961;
  t2002 = t78 * t61;
  t2005 = 0.1e1 / t5;
  t2006 = t82 * t2005;
  t2009 = 0.36e2 * t1568 + 0.27e2 * t1570 + 0.4e2 * t1572 + 0.3e2 * t1574 + 0.28e2 * t1576 + 0.21e2 * t1578 + 0.6e1 * t1580 + 0.3e1 * t1582 - t1495 - t1497 - t1499 - t1501 + 0.7e1 * t1734 + 0.8e1 * t1736 + 0.9e1 * t1738 + 0.1e2 * t1740 - 0.595e3 / 0.3456e4 * t1996 * t71 - 0.3e1 / 0.16e2 * t1999 * t71 - 0.5e1 / 0.27e2 * t2002 * t71 - 0.55e2 / 0.432e3 * t2006 * t71;
  t2011 = t95 * t61;
  t2014 = t115 * t2005;
  t2017 = t124 * t61;
  t2020 = t138 * t2005;
  t2031 = t1167 * t865;
  t2032 = t100 * t2031;
  t2034 = t857 * t310;
  t2040 = -0.6e1 * t268 - 0.6e1 * t1290;
  t2044 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1385 * t2034 + 0.4e1 / 0.3e1 * t708 * t861 + 0.4e1 / 0.3e1 * t53 * t2040);
  t2045 = t223 * t2044;
  t2046 = t100 * t2045;
  t2048 = t911 * rho[1];
  t2050 = 0.1e1 / t25 / t2048;
  t2051 = sigma[2] * t2050;
  t2052 = t2051 * t109;
  t2054 = t914 * t359;
  t2056 = t356 * t920;
  t2058 = t356 * t923;
  t2060 = t1249 * t883;
  t2061 = t107 * t2060;
  t2063 = t876 * t322;
  t2068 = -t2040;
  t2072 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1402 * t2063 + 0.4e1 / 0.3e1 * t721 * t879 + 0.4e1 / 0.3e1 * t65 * t2068);
  t2073 = t227 * t2072;
  t2074 = t107 * t2073;
  t2076 = 0.3e1 / 0.2e1 * t2032 + t2046 / 0.2e1 - 0.308e3 / 0.27e2 * t2052 + 0.44e2 / 0.3e1 * t2054 - 0.4e1 * t2056 - 0.4e1 * t2058 + 0.3e1 / 0.2e1 * t2061 + t2074 / 0.2e1 + t1474;
  t2085 = t2044 * t57;
  t2089 = 0.1e1 / t11 / t911;
  t2090 = t60 * t2089;
  t2096 = t2072 * t57;
  t2099 = t44 * t2085 / 0.4e1 - 0.7e2 / 0.27e2 * t2090 * t68 + 0.7e1 / 0.3e1 * t871 * t326 - t319 * t884 + t62 * t2096 / 0.4e1;
  t2120 = 0.3e1 / 0.4e1 * t2032 + t2046 / 0.4e1 - 0.154e3 / 0.27e2 * t2052 + 0.22e2 / 0.3e1 * t2054 - 0.2e1 * t2056 - 0.2e1 * t2058 + 0.3e1 / 0.4e1 * t2061 + t2074 / 0.4e1;
  t2123 = -0.5e1 / 0.27e2 * t2011 * t112 - 0.55e2 / 0.432e3 * t2014 * t112 - 0.1e2 / 0.27e2 * t2017 * t136 - 0.55e2 / 0.216e3 * t2020 * t136 + 0.5e1 / 0.3e1 * t972 * t362 + 0.55e2 / 0.24e2 * t975 * t362 + 0.1e2 / 0.3e1 * t978 * t381 + 0.55e2 / 0.12e2 * t981 * t381 + t139 * t2076 + 0.11e2 / 0.2e1 * t387 * t946 + t142 * t2076 + 0.6e1 * t391 * t946 + 0.17e2 / 0.8e1 * t332 * t887 + t75 * t2099 / 0.2e1 + 0.9e1 / 0.4e1 * t337 * t887 + t79 * t2099 / 0.2e1 + 0.5e1 / 0.2e1 * t342 * t887 + t92 * t2099 / 0.2e1 + 0.11e2 / 0.4e1 * t347 * t887 + t96 * t2120 / 0.2e1;
  t2155 = 0.5e1 / 0.2e1 * t365 * t926 + t116 * t2120 / 0.2e1 + 0.11e2 / 0.4e1 * t370 * t926 + t121 * t2120 / 0.2e1 + 0.3e1 * t376 * t926 + t125 * t2076 + 0.5e1 * t383 * t946 + t41 * t2099 / 0.2e1 + 0.85e2 / 0.96e2 * t959 * t329 + 0.9e1 / 0.8e1 * t962 * t329 + 0.5e1 / 0.3e1 * t965 * t329 + 0.55e2 / 0.24e2 * t969 * t329 - 0.7e1 / 0.6e1 * t1937 - 0.7e1 / 0.6e1 * t1939 - 0.8e1 / 0.3e1 * t1941 - 0.8e1 / 0.3e1 * t1943 - 0.9e1 / 0.2e1 * t1945 - 0.9e1 / 0.2e1 * t1947 - 0.2e2 / 0.3e1 * t1949 - 0.2e2 / 0.3e1 * t1951;
  tv3rho33 = t1981 + t2009 + t2123 + t2155;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2158 = t95 / t217;
  t2162 = 0.1e1 / t85 / t97;
  t2163 = t115 * t2162;
  t2166 = t119 * t99;
  t2167 = t2166 * t102;
  t2170 = t99 * t530 * t56;
  t2175 = t29 / t1029 / rho[0];
  t2178 = t74 * t1019;
  t2181 = t78 * t1024;
  t2185 = t407 * t185 * t57;
  t2194 = -0.35e2 / 0.72e2 * t2158 * t102 - 0.33e2 / 0.64e2 * t2163 * t102 - 0.13e2 / 0.24e2 * t2167 + t116 * t2170 / 0.8e1 - 0.51e2 / 0.256e3 * t2175 * t1033 - 0.13e2 / 0.64e2 * t2178 * t1033 - 0.5e1 / 0.24e2 * t2181 * t1033 + 0.11e2 / 0.48e2 * t1042 * t2185 + 0.5e1 / 0.12e2 * t1016 * t224 + 0.11e2 / 0.24e2 * t1020 * t224 + t1025 * t224 / 0.2e1;
  t2202 = 0.2e1 * t141 * t431;
  t2204 = t177 * t185 * t57;
  t2208 = t471 * t55 * t57;
  t2217 = t121 * t219;
  t2224 = 0.17e2 / 0.96e2 * t1031 * t2185 + 0.3e1 / 0.16e2 * t1036 * t2185 + 0.5e1 / 0.24e2 * t1039 * t2185 + t2202 - t419 * t2204 / 0.6e1 + 0.7e1 / 0.36e2 * t408 * t2208 + 0.7e1 / 0.36e2 * t413 * t2208 + 0.7e1 / 0.36e2 * t416 * t2208 + 0.7e1 / 0.36e2 * t419 * t2208 - 0.2e1 / 0.3e1 * t2217 * t224 + t1002 * t534 / 0.8e1 + 0.1e2 / 0.9e1 * t603 * t431;
  t2229 = t524 * t101 * t56;
  t2231 = t219 * t55;
  t2237 = 0.88e2 / 0.9e1 * t566;
  t2238 = 0.22e2 / 0.9e1 * t2229 - 0.8e1 / 0.3e1 * t2231 * t761 + t2170 / 0.2e1 + t1054 * t1603 / 0.2e1 - t2237;
  t2252 = t82 * t1321;
  t2259 = 0.55e2 / 0.36e2 * t608 * t431 + t142 * t2238 + 0.4e1 * t265 * t1058 + t125 * t2238 + 0.1e2 / 0.3e1 * t257 * t1058 + t139 * t2238 + 0.11e2 / 0.3e1 * t261 * t1058 + 0.11e2 / 0.18e2 * t121 * t2229 + t121 * t2170 / 0.8e1 - 0.121e3 / 0.576e3 * t2252 * t1033 + 0.11e2 / 0.18e2 * t96 * t2229 + t96 * t2170 / 0.8e1;
  t2263 = t43 * t488 * t57;
  t2272 = t96 * t219;
  t2277 = t116 * t219;
  t2288 = 0.11e2 / 0.18e2 * t116 * t2229 + t408 * t2263 / 0.16e2 + t413 * t2263 / 0.16e2 + t416 * t2263 / 0.16e2 + t419 * t2263 / 0.16e2 - 0.2e1 / 0.3e1 * t2272 * t224 + t996 * t534 / 0.8e1 - 0.2e1 / 0.3e1 * t2277 * t224 + t999 * t534 / 0.8e1 - t408 * t2204 / 0.6e1 - t413 * t2204 / 0.6e1 - t416 * t2204 / 0.6e1;
  tv3rho2sigma0 = t2194 + t2224 + t2259 + t2288;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2292 = t257 * t252;
  t2295 = 0.176e3 / 0.9e1 * t125 * t566;
  t2298 = t261 * t252;
  t2301 = 0.176e3 / 0.9e1 * t139 * t566;
  t2303 = 0.4e1 * t141 * t134;
  t2304 = t265 * t252;
  t2307 = 0.176e3 / 0.9e1 * t142 * t566;
  tv3rho2sigma1 = -0.2e2 / 0.9e1 * t603 * t134 + 0.16e3 / 0.9e1 * t2292 - t2295 - 0.55e2 / 0.18e2 * t608 * t134 + 0.176e3 / 0.9e1 * t2298 - t2301 - t2303 + 0.64e2 / 0.3e1 * t2304 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2308 = t119 * t106;
  t2309 = t2308 * t109;
  t2312 = t106 * t537 * t56;
  t2324 = 0.2e1 * t141 * t463;
  t2334 = t2312 / 0.2e1 + t1120 * t1632 / 0.2e1 - t2237;
  t2342 = t582 * t439;
  t2345 = t2309 / 0.8e1 + t96 * t2312 / 0.8e1 + 0.55e2 / 0.576e3 * t600 * t455 + t116 * t2312 / 0.8e1 + t121 * t2312 / 0.8e1 + 0.5e1 / 0.72e2 * t597 * t455 + t2324 + 0.55e2 / 0.36e2 * t608 * t463 + 0.1e2 / 0.9e1 * t603 * t463 + 0.1e2 / 0.3e1 * t257 * t1123 + t125 * t2334 + 0.11e2 / 0.3e1 * t261 * t1123 + t139 * t2334 + 0.4e1 * t265 * t1123 + t142 * t2334 + 0.85e2 / 0.2304e4 * t2342 * t442;
  t2346 = t586 * t439;
  t2349 = t590 * t439;
  t2352 = t594 * t439;
  t2357 = t239 * t106;
  t2362 = t245 * t106;
  t2370 = t61 * t501 * t57;
  t2385 = t234 * t106;
  t2388 = 0.3e1 / 0.64e2 * t2346 * t442 + 0.5e1 / 0.72e2 * t2349 * t442 + 0.55e2 / 0.576e3 * t2352 * t442 + t1105 * t541 / 0.8e1 + 0.11e2 / 0.24e2 * t2357 * t228 + t1110 * t541 / 0.8e1 + t2362 * t228 / 0.2e1 + t1115 * t541 / 0.8e1 + 0.17e2 / 0.96e2 * t1081 * t1085 + t440 * t2370 / 0.16e2 + 0.3e1 / 0.16e2 * t1088 * t1085 + t445 * t2370 / 0.16e2 + 0.5e1 / 0.24e2 * t1093 * t1085 + t448 * t2370 / 0.16e2 + 0.11e2 / 0.48e2 * t1098 * t1085 + t451 * t2370 / 0.16e2 + 0.5e1 / 0.12e2 * t2385 * t228;
  tv3rho2sigma2 = t2345 + t2388;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2390 = t407 * t313 * t57;
  t2413 = 0.5e1 / 0.48e2 * t1039 * t2390 + 0.11e2 / 0.96e2 * t1042 * t2390 + 0.5e1 / 0.24e2 * t1016 * t350 + 0.11e2 / 0.48e2 * t1020 * t350 + t1025 * t350 / 0.4e1 - t376 * t1046 / 0.3e1 - 0.5e1 / 0.18e2 * t365 * t1046 - 0.11e2 / 0.36e2 * t370 * t1046 + 0.17e2 / 0.192e3 * t1031 * t2390 + 0.3e1 / 0.32e2 * t1036 * t2390 + 0.5e1 / 0.3e1 * t383 * t1058;
  t2416 = t99 * t185;
  t2419 = t56 * t715;
  t2422 = -0.4e1 / 0.3e1 * t2231 * t1167 + t2416 * t1167 / 0.2e1 + t1054 * t2419 / 0.2e1 - t2237;
  t2437 = t177 * t313 * t57;
  t2446 = t125 * t2422 + 0.5e1 / 0.3e1 * t257 * t1170 + 0.11e2 / 0.6e1 * t387 * t1058 + t139 * t2422 + 0.11e2 / 0.6e1 * t261 * t1170 + 0.2e1 * t391 * t1058 + t142 * t2422 + 0.2e1 * t265 * t1170 - t416 * t2437 / 0.12e2 - 0.11e2 / 0.72e2 * t1148 * t1006 - t419 * t2437 / 0.12e2 - t2272 * t350 / 0.3e1;
  t2464 = t376 * t99;
  t2472 = t43 * t715 * t57;
  t2475 = -t2277 * t350 / 0.3e1 - t2217 * t350 / 0.3e1 - 0.17e2 / 0.144e3 * t1131 * t1006 - t408 * t2437 / 0.12e2 - t1138 * t1006 / 0.8e1 - t413 * t2437 / 0.12e2 - 0.5e1 / 0.36e2 * t1143 * t1006 + t999 * t765 / 0.8e1 + t2464 * t224 / 0.4e1 + t1002 * t762 / 0.8e1 + t1002 * t765 / 0.8e1 + t408 * t2472 / 0.16e2;
  t2488 = t365 * t99;
  t2495 = t370 * t99;
  t2502 = 0.3e1 / 0.32e2 * t1138 * t987 + t413 * t2472 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t987 + t416 * t2472 / 0.16e2 + 0.11e2 / 0.96e2 * t1148 * t987 + t419 * t2472 / 0.16e2 + 0.5e1 / 0.24e2 * t2488 * t224 + t996 * t762 / 0.8e1 + t996 * t765 / 0.8e1 + 0.11e2 / 0.48e2 * t2495 * t224 + t999 * t762 / 0.8e1 + 0.17e2 / 0.192e3 * t1131 * t987;
  tv3rho2sigma3 = t2413 + t2446 + t2475 + t2502;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2504 = t383 * t252;
  t2507 = t387 * t252;
  t2510 = t391 * t252;
  tv3rho2sigma4 = 0.8e2 / 0.9e1 * t2504 + 0.8e2 / 0.9e1 * t2292 - t2295 + 0.88e2 / 0.9e1 * t2507 + 0.88e2 / 0.9e1 * t2298 - t2301 + 0.32e2 / 0.3e1 * t2510 + 0.32e2 / 0.3e1 * t2304 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2513 = t121 * t355;
  t2523 = t61 * t728 * t57;
  t2537 = t439 * t192 * t57;
  t2540 = -t2513 * t228 / 0.3e1 + t1115 * t771 / 0.8e1 + t1115 * t774 / 0.8e1 + t2362 * t359 / 0.4e1 + t440 * t2523 / 0.16e2 + 0.17e2 / 0.192e3 * t1081 * t1185 + t445 * t2523 / 0.16e2 + 0.3e1 / 0.32e2 * t1088 * t1185 + t448 * t2523 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t1185 + 0.11e2 / 0.96e2 * t1245 * t2537;
  t2559 = t355 * t67;
  t2562 = t106 * t192;
  t2565 = t56 * t728;
  t2568 = -0.4e1 / 0.3e1 * t2559 * t770 + t2562 * t1249 / 0.2e1 + t1120 * t2565 / 0.2e1 - t2237;
  t2574 = -0.5e1 / 0.18e2 * t234 * t1224 - 0.11e2 / 0.36e2 * t239 * t1224 - t245 * t1224 / 0.3e1 + 0.5e1 / 0.24e2 * t1211 * t228 + 0.11e2 / 0.48e2 * t1215 * t228 + t1220 * t228 / 0.4e1 + 0.17e2 / 0.192e3 * t1234 * t2537 + 0.3e1 / 0.32e2 * t1239 * t2537 + 0.5e1 / 0.48e2 * t1242 * t2537 + t125 * t2568 + 0.5e1 / 0.3e1 * t257 * t1252 + 0.5e1 / 0.3e1 * t383 * t1123;
  t2587 = t318 * t192 * t57;
  t2600 = t139 * t2568 + 0.11e2 / 0.6e1 * t261 * t1252 + 0.11e2 / 0.6e1 * t387 * t1123 + t142 * t2568 + 0.2e1 * t265 * t1252 + 0.2e1 * t391 * t1123 - t440 * t2587 / 0.12e2 - 0.17e2 / 0.144e3 * t1081 * t1201 - t445 * t2587 / 0.12e2 - t1088 * t1201 / 0.8e1 - t448 * t2587 / 0.12e2 - 0.5e1 / 0.36e2 * t1093 * t1201;
  t2609 = t96 * t355;
  t2618 = t116 * t355;
  t2627 = -t451 * t2587 / 0.12e2 - 0.11e2 / 0.72e2 * t1098 * t1201 + t451 * t2523 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t1185 - t2609 * t228 / 0.3e1 + t1105 * t771 / 0.8e1 + t1105 * t774 / 0.8e1 + 0.5e1 / 0.24e2 * t2385 * t359 - t2618 * t228 / 0.3e1 + t1110 * t771 / 0.8e1 + t1110 * t774 / 0.8e1 + 0.11e2 / 0.48e2 * t2357 * t359;
  tv3rho2sigma5 = t2540 + t2574 + t2600 + t2627;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2634 = t43 * t865 * t57;
  t2651 = t969 * t407;
  t2654 = t959 * t407;
  t2657 = t962 * t407;
  t2660 = t965 * t407;
  t2667 = t1002 * t908 / 0.8e1 + 0.17e2 / 0.96e2 * t1131 * t1135 + t408 * t2634 / 0.16e2 + 0.3e1 / 0.16e2 * t1138 * t1135 + t413 * t2634 / 0.16e2 + 0.5e1 / 0.24e2 * t1143 * t1135 + t416 * t2634 / 0.16e2 + 0.11e2 / 0.48e2 * t1148 * t1135 + t419 * t2634 / 0.16e2 + 0.5e1 / 0.12e2 * t2488 * t350 + 0.55e2 / 0.576e3 * t2651 * t410 + 0.85e2 / 0.2304e4 * t2654 * t410 + 0.3e1 / 0.64e2 * t2657 * t410 + 0.5e1 / 0.72e2 * t2660 * t410 + t996 * t908 / 0.8e1 + 0.11e2 / 0.24e2 * t2495 * t350;
  t2674 = t99 * t904 * t56;
  t2692 = t56 * t865;
  t2695 = t2674 / 0.2e1 + t1054 * t2692 / 0.2e1 - t2237;
  t2703 = t999 * t908 / 0.8e1 + t2464 * t350 / 0.2e1 + t2167 / 0.8e1 + t96 * t2674 / 0.8e1 + 0.55e2 / 0.576e3 * t975 * t423 + t116 * t2674 / 0.8e1 + t121 * t2674 / 0.8e1 + 0.5e1 / 0.72e2 * t972 * t423 + t2202 + 0.1e2 / 0.9e1 * t978 * t431 + 0.55e2 / 0.36e2 * t981 * t431 + 0.1e2 / 0.3e1 * t383 * t1170 + t125 * t2695 + 0.11e2 / 0.3e1 * t387 * t1170 + t139 * t2695 + 0.4e1 * t391 * t1170 + t142 * t2695;
  tv3rho2sigma6 = t2667 + t2703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.2e2 / 0.9e1 * t978 * t134 + 0.16e3 / 0.9e1 * t2504 - t2295 - 0.55e2 / 0.18e2 * t981 * t134 + 0.176e3 / 0.9e1 * t2507 - t2301 - t2303 + 0.64e2 / 0.3e1 * t2510 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2712 = t95 / t353;
  t2716 = 0.1e1 / t89 / t104;
  t2717 = t115 * t2716;
  t2721 = t870 * t67 * t57;
  t2727 = t318 * t325 * t57;
  t2742 = -0.35e2 / 0.72e2 * t2712 * t109 - 0.33e2 / 0.64e2 * t2717 * t109 + 0.7e1 / 0.36e2 * t448 * t2721 + 0.7e1 / 0.36e2 * t451 * t2721 - t448 * t2727 / 0.6e1 - t451 * t2727 / 0.6e1 + 0.7e1 / 0.36e2 * t440 * t2721 + 0.7e1 / 0.36e2 * t445 * t2721 - t440 * t2727 / 0.6e1 - t445 * t2727 / 0.6e1 + t1115 * t923 / 0.8e1;
  t2744 = t61 * t883 * t57;
  t2765 = t106 * t919 * t56;
  t2770 = t29 / t1232 / rho[1];
  t2773 = t440 * t2744 / 0.16e2 + t445 * t2744 / 0.16e2 + t448 * t2744 / 0.16e2 + t451 * t2744 / 0.16e2 - 0.2e1 / 0.3e1 * t2609 * t359 + t1105 * t923 / 0.8e1 - 0.2e1 / 0.3e1 * t2618 * t359 + t1110 * t923 / 0.8e1 - 0.2e1 / 0.3e1 * t2513 * t359 - 0.13e2 / 0.24e2 * t2309 + t121 * t2765 / 0.8e1 - 0.51e2 / 0.256e3 * t2770 * t1236;
  t2775 = t74 * t1214;
  t2778 = t78 * t1219;
  t2781 = t82 * t1961;
  t2785 = t913 * t108 * t56;
  t2797 = t439 * t325 * t57;
  t2806 = -0.13e2 / 0.64e2 * t2775 * t1236 - 0.5e1 / 0.24e2 * t2778 * t1236 - 0.121e3 / 0.576e3 * t2781 * t1236 + 0.11e2 / 0.18e2 * t96 * t2785 + t96 * t2765 / 0.8e1 + 0.11e2 / 0.18e2 * t116 * t2785 + t116 * t2765 / 0.8e1 + 0.11e2 / 0.18e2 * t121 * t2785 + 0.17e2 / 0.96e2 * t1234 * t2797 + 0.3e1 / 0.16e2 * t1239 * t2797 + 0.5e1 / 0.24e2 * t1242 * t2797 + 0.11e2 / 0.48e2 * t1245 * t2797;
  t2821 = t56 * t883;
  t2824 = 0.22e2 / 0.9e1 * t2785 - 0.8e1 / 0.3e1 * t2559 * t1249 + t2765 / 0.2e1 + t1120 * t2821 / 0.2e1 - t2237;
  t2834 = 0.5e1 / 0.12e2 * t1211 * t359 + 0.11e2 / 0.24e2 * t1215 * t359 + t1220 * t359 / 0.2e1 + t2324 + 0.1e2 / 0.9e1 * t978 * t463 + 0.55e2 / 0.36e2 * t981 * t463 + t125 * t2824 + 0.1e2 / 0.3e1 * t383 * t1252 + t139 * t2824 + 0.11e2 / 0.3e1 * t387 * t1252 + t142 * t2824 + 0.4e1 * t391 * t1252;
  tv3rho2sigma8 = t2742 + t2773 + t2806 + t2834;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2837 = t1264 * t55 * t57;
  tv3rhosigma20 = -0.17e2 / 0.384e3 * t1031 * t2837 + t1265 * t1006 / 0.24e2 - t1265 * t987 / 0.32e2 - 0.3e1 / 0.64e2 * t1036 * t2837 + t1267 * t1006 / 0.24e2 - t1267 * t987 / 0.32e2 - 0.5e1 / 0.96e2 * t1039 * t2837 + t1269 * t1006 / 0.24e2 - t1269 * t987 / 0.32e2 - 0.11e2 / 0.192e3 * t1042 * t2837 + t1271 * t1006 / 0.24e2 - t1271 * t987 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2862 = t199 * t1275;
  t2867 = t204 * t1275;
  t2872 = t209 * t1275;
  t2877 = t214 * t1275;
  tv3rhosigma25 = -0.17e2 / 0.384e3 * t2862 * t442 - t1276 * t1085 / 0.32e2 - 0.3e1 / 0.64e2 * t2867 * t442 - t1278 * t1085 / 0.32e2 - 0.5e1 / 0.96e2 * t2872 * t442 - t1280 * t1085 / 0.32e2 - 0.11e2 / 0.192e3 * t2877 * t442 - t1282 * t1085 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2882 = t332 * t1264;
  t2887 = t337 * t1264;
  t2892 = t342 * t1264;
  t2897 = t347 * t1264;
  tv3rhosigma26 = -0.17e2 / 0.384e3 * t2882 * t410 - t1265 * t1135 / 0.32e2 - 0.3e1 / 0.64e2 * t2887 * t410 - t1267 * t1135 / 0.32e2 - 0.5e1 / 0.96e2 * t2892 * t410 - t1269 * t1135 / 0.32e2 - 0.11e2 / 0.192e3 * t2897 * t410 - t1271 * t1135 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2903 = t1275 * t67 * t57;
  tv3rhosigma211 = -0.17e2 / 0.384e3 * t1234 * t2903 + t1276 * t1201 / 0.24e2 - t1276 * t1185 / 0.32e2 - 0.3e1 / 0.64e2 * t1239 * t2903 + t1278 * t1201 / 0.24e2 - t1278 * t1185 / 0.32e2 - 0.5e1 / 0.96e2 * t1242 * t2903 + t1280 * t1201 / 0.24e2 - t1280 * t1185 / 0.32e2 - 0.11e2 / 0.192e3 * t1245 * t2903 + t1282 * t1201 / 0.24e2 - t1282 * t1185 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2928 = sigma[0] * sigma[0];
  t2930 = 0.1e1 / t42 / t2928;
  t2931 = t41 * t2930;
  t2933 = t75 * t2930;
  t2935 = t79 * t2930;
  t2937 = t92 * t2930;
  tv3sigma30 = 0.3e1 / 0.64e2 * t2931 * t410 + 0.3e1 / 0.64e2 * t2933 * t410 + 0.3e1 / 0.64e2 * t2935 * t410 + 0.3e1 / 0.64e2 * t2937 * t410;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2940 = sigma[2] * sigma[2];
  t2942 = 0.1e1 / t60 / t2940;
  t2943 = t41 * t2942;
  t2945 = t75 * t2942;
  t2947 = t79 * t2942;
  t2949 = t92 * t2942;
  tv3sigma39 = 0.3e1 / 0.64e2 * t2943 * t442 + 0.3e1 / 0.64e2 * t2945 * t442 + 0.3e1 / 0.64e2 * t2947 * t442 + 0.3e1 / 0.64e2 * t2949 * t442;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t38, t41, t42, t43, t44, t45, t46, t47;
  double t48, t49, t50, t51, t52, t53, t55, t56;
  double t57, t58, t60, t61, t62, t63, t64, t65;
  double t67, t68, t71, t74, t75, t78, t79, t82;
  double t83, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t95, t96, t97, t99, t100, t101;
  double t102, t103, t104, t106, t107, t108, t109, t110;
  double t112, t115, t116, t119, t120, t121, t124, t125;
  double t129, t130, t131, t132, t134, t136, t138, t139;
  double t141, t142, t144, t145, t146, t147, t148, t150;
  double t151, t153, t154, t156, t157, t159, t160, t161;
  double t164, tzk0;

  double t173, t177, t178, t181, t182, t185, t186, t189;
  double t192, t193, t196, t199, t204, t209, t214, t217;
  double t219, t220, t221, t223, t224, t225, t227, t228;
  double t229, t231, t234, t239, t244, t245, t250, t252;
  double t254, t255, t257, t261, t265, t268, t269, t271;
  double t273, t275, t277, t279, t281, t283, t285, t286;
  double t289, t292, t295, t298, tvrho0, t307, t310, t313;
  double t314, t318, t319, t322, t325, t326, t329, t332;
  double t337, t342, t347, t350, t351, t353, t355, t356;
  double t357, t359, t360, t362, t365, t370, t375, t376;
  double t381, t383, t387, t391, t394, t397, t400, t403;
  double t406, tvrho1, t407, t408, t410, t413, t416, t419;
  double t423, t431, tvsigma0, tvsigma1, t439, t440, t442, t445;
  double t448, t451, t455, t463, tvsigma2;

  double t467, t469, t471, t472, t477, t478, t479, t482;
  double t484, t488, t489, t492, t493, t494, t497, t501;
  double t502, t505, t522, t524, t525, t526, t528, t530;
  double t531, t532, t534, t535, t537, t538, t539, t541;
  double t542, t544, t553, t564, t566, t568, t569, t579;
  double t580, t582, t585, t586, t589, t590, t593, t594;
  double t597, t600, t603, t606, t608, t612, t614, t615;
  double t616, t619, t621, t623, t624, t627, t629, t631;
  double t634, t636, t638, t641, t643, t645, t647, t648;
  double t649, t651, t653, t655, t657, t659, t661, t663;
  double t672, t676, t678, t679, tv2rho20, t681, t683, t685;
  double t687, t689, t691, t693, t695, t700, t708, t711;
  double t715, t716, t721, t724, t728, t729, t732, t739;
  double t759, t761, t762, t763, t765, t766, t768, t770;
  double t771, t772, t774, t775, t777, t786, t801, t817;
  double tv2rho21, t827, t828, t829, t832, t833, t836, t837;
  double t840, t841, t852, t855, t857, t861, t865, t866;
  double t870, t871, t876, t879, t883, t884, t887, t904;
  double t905, t906, t908, t909, t911, t913, t914, t915;
  double t917, t919, t920, t921, t923, t924, t926, t937;
  double t946, t956, t957, t959, t962, t965, t968, t969;
  double t972, t975, t978, t981, t984, tv2rho22, t987, t996;
  double t999, t1002, t1006, t1016, t1019, t1020, t1023, t1024;
  double t1025, t1028, t1029, t1031, t1033, t1036, t1039, t1042;
  double t1046, t1054, t1057, t1058, t1068, tv2rhosigma0, t1072, t1076;
  double t1080, tv2rhosigma1, t1081, t1085, t1088, t1093, t1098, t1105;
  double t1110, t1115, t1120, t1123, tv2rhosigma2, t1131, t1135, t1138;
  double t1143, t1148, t1167, t1170, tv2rhosigma3, tv2rhosigma4, t1185, t1201;
  double t1211, t1214, t1215, t1218, t1219, t1220, t1224, t1231;
  double t1232, t1234, t1236, t1239, t1242, t1245, t1249, t1252;
  double t1262, tv2rhosigma5, t1264, t1265, t1267, t1269, t1271, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1275, t1276, t1278, t1280;
  double t1282, tv2sigma25;

  double t1285, t1286, t1287, t1289, t1290, t1291, t1292, t1294;
  double t1295, t1296, t1298, t1299, t1302, t1304, t1306, t1308;
  double t1310, t1313, t1315, t1317, t1319, t1321, t1322, t1325;
  double t1327, t1329, t1331, t1332, t1334, t1337, t1339, t1341;
  double t1343, t1345, t1346, t1348, t1349, t1350, t1359, t1362;
  double t1364, t1366, t1368, t1370, t1372, t1374, t1377, t1378;
  double t1385, t1386, t1389, t1393, t1397, t1398, t1402, t1403;
  double t1406, t1409, t1413, t1414, t1417, t1426, t1428, t1429;
  double t1430, t1432, t1434, t1436, t1438, t1439, t1441, t1442;
  double t1444, t1445, t1447, t1448, t1450, t1472, t1474, t1475;
  double t1493, t1494, t1495, t1496, t1497, t1498, t1499, t1500;
  double t1501, t1504, t1507, t1510, t1513, t1514, t1517, t1520;
  double t1523, t1526, t1545, tv3rho30, t1547, t1548, t1561, t1562;
  double t1563, t1564, t1566, t1568, t1570, t1572, t1574, t1576;
  double t1578, t1580, t1582, t1587, t1588, t1589, t1590, t1595;
  double t1597, t1599, t1601, t1603, t1604, t1605, t1607, t1608;
  double t1610, t1613, t1624, t1625, t1626, t1628, t1630, t1632;
  double t1633, t1634, t1636, t1637, t1639, t1642, t1653, t1654;
  double t1655, t1657, t1684, t1700, t1705, t1708, t1717, t1734;
  double t1736, t1738, t1740, t1758, tv3rho31, t1772, t1794, t1802;
  double t1807, t1812, t1816, t1817, t1824, t1829, t1832, t1836;
  double t1837, t1840, t1859, t1861, t1862, t1864, t1866, t1867;
  double t1869, t1870, t1872, t1874, t1876, t1878, t1879, t1881;
  double t1882, t1884, t1885, t1887, t1905, t1915, t1937, t1939;
  double t1941, t1943, t1945, t1947, t1949, t1951, t1953, tv3rho32;
  double t1955, t1958, t1961, t1962, t1965, t1976, t1981, t1996;
  double t1999, t2002, t2005, t2006, t2009, t2011, t2014, t2017;
  double t2020, t2031, t2032, t2034, t2040, t2044, t2045, t2046;
  double t2048, t2050, t2051, t2052, t2054, t2056, t2058, t2060;
  double t2061, t2063, t2068, t2072, t2073, t2074, t2076, t2085;
  double t2089, t2090, t2096, t2099, t2120, t2123, t2155, tv3rho33;
  double t2158, t2162, t2163, t2166, t2167, t2170, t2175, t2178;
  double t2181, t2185, t2194, t2202, t2204, t2208, t2217, t2224;
  double t2229, t2231, t2237, t2238, t2252, t2259, t2263, t2272;
  double t2277, t2288, tv3rho2sigma0, t2292, t2295, t2298, t2301, t2303;
  double t2304, t2307, tv3rho2sigma1, t2308, t2309, t2312, t2324, t2334;
  double t2342, t2345, t2346, t2349, t2352, t2357, t2362, t2370;
  double t2385, t2388, tv3rho2sigma2, t2390, t2413, t2416, t2419, t2422;
  double t2437, t2446, t2464, t2472, t2475, t2488, t2495, t2502;
  double tv3rho2sigma3, t2504, t2507, t2510, tv3rho2sigma4, t2513, t2523, t2537;
  double t2540, t2559, t2562, t2565, t2568, t2574, t2587, t2600;
  double t2609, t2618, t2627, tv3rho2sigma5, t2634, t2651, t2654, t2657;
  double t2660, t2667, t2674, t2692, t2695, t2703, tv3rho2sigma6, tv3rho2sigma7;
  double t2712, t2716, t2717, t2721, t2727, t2742, t2744, t2765;
  double t2770, t2773, t2775, t2778, t2781, t2785, t2797, t2806;
  double t2821, t2824, t2834, tv3rho2sigma8, t2837, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2862, t2867, t2872, t2877, tv3rhosigma25, t2882;
  double t2887, t2892, t2897, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2903, tv3rhosigma211, t2928, t2930, t2931, t2933, t2935, t2937;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t2940, t2942, t2943, t2945, t2947, t2949, tv3sigma39;

  double t2952, t2955, t2959, t2961, t2963, t2965, t2970, t2972;
  double t2974, t2976, t2978, t2979, t2980, t2981, t2982, t2983;
  double t2984, t2986, t2987, t2988, t2990, t2991, t2992, t2994;
  double t2995, t2996, t2998, t3002, t3004, t3006, t3008, t3010;
  double t3012, t3014, t3016, t3018, t3020, t3022, t3024, t3029;
  double t3031, t3033, t3035, t3037, t3046, t3049, t3051, t3053;
  double t3054, t3067, t3074, t3086, t3087, t3092, t3093, t3094;
  double t3095, t3104, t3109, t3111, t3113, t3115, t3117, t3119;
  double t3121, t3123, t3131, t3143, t3145, t3147, t3149, t3151;
  double t3153, t3155, t3157, t3160, t3161, t3163, t3164, t3170;
  double t3176, t3180, t3182, t3184, t3186, t3189, t3190, t3192;
  double t3193, t3199, t3208, t3210, t3212, t3232, t3233, t3260;
  double t3263, t3290, tv4rho40, t3293, t3295, t3296, t3297, t3299;
  double t3300, t3301, t3303, t3304, t3305, t3307, t3308, t3309;
  double t3313, t3317, t3318, t3319, t3320, t3322, t3326, t3329;
  double t3331, t3336, t3338, t3340, t3342, t3344, t3346, t3348;
  double t3351, t3353, t3355, t3357, t3359, t3362, t3365, t3391;
  double t3393, t3395, t3397, t3399, t3401, t3403, t3406, t3409;
  double t3435, t3437, t3439, t3441, t3443, t3445, t3447, t3449;
  double t3465, t3490, t3507, t3530, t3555, t3564, t3565, t3574;
  double t3575, t3576, t3577, t3578, t3579, t3580, tv4rho41, t3583;
  double t3585, t3587, t3589, t3591, t3593, t3595, t3597, t3604;
  double t3614, t3630, t3632, t3634, t3636, t3637, t3639, t3642;
  double t3645, t3671, t3673, t3675, t3677, t3680, t3682, t3684;
  double t3686, t3688, t3690, t3692, t3695, t3721, t3723, t3725;
  double t3727, t3729, t3730, t3732, t3751, t3794, t3797, t3826;
  double t3834, t3836, t3843, t3861, t3872, t3874, t3876, t3878;
  double t3888, tv4rho42, t3891, t3893, t3895, t3897, t3899, t3901;
  double t3903, t3905, t3911, t3916, t3922, t3945, t3949, t3978;
  double t3982, t3999, t4002, t4005, t4007, t4010, t4013, t4015;
  double t4017, t4019, t4021, t4023, t4025, t4028, t4031, t4034;
  double t4037, t4039, t4045, t4084, t4089, t4112, t4133, t4138;
  double tv4rho43, t4151, t4163, t4176, t4182, t4192, t4221, t4224;
  double t4229, t4235, t4239, t4254, t4259, t4268, t4272, t4285;
  double t4287, t4290, t4292, t4298, t4300, t4302, t4304, t4306;
  double t4308, t4310, t4312, t4315, t4317, t4319, t4332, t4345;
  double t4370, t4393, t4394, t4405, tv4rho44, t4424, t4429, t4450;
  double t4454, t4457, t4467, t4474, t4478, t4488, t4493, t4504;
  double t4518, t4527, t4530, t4536, t4556, t4566, t4567, t4581;
  double t4583, tv4rho3sigma0, t4587, t4589, t4592, t4595, t4597, t4600;
  double t4601, t4602, t4603, t4606, tv4rho3sigma1, t4611, t4628, t4631;
  double t4648, t4657, t4675, t4684, t4695, t4707, t4709, tv4rho3sigma2;
  double t4720, t4753, t4758, t4761, t4770, t4776, t4802, t4816;
  double t4832, t4851, t4861, t4891, t4907, t4909, tv4rho3sigma3, t4912;
  double t4916, t4920, t4922, tv4rho3sigma4, t4929, t4932, t4939, t4966;
  double t4967, t4982, t4992, t5009, t5012, t5043, t5052, t5060;
  double t5078, t5098, t5100, tv4rho3sigma5, t5103, t5109, t5137, t5144;
  double t5148, t5155, t5186, t5211, t5228, t5249, t5258, t5273;
  double tv4rho3sigma6, t5275, t5279, tv4rho3sigma7, t5302, t5327, t5342, t5355;
  double t5368, t5375, t5388, t5406, t5420, t5425, t5450, t5458;
  double t5465, t5482, tv4rho3sigma8, t5507, t5509, t5532, t5559, t5571;
  double t5584, tv4rho3sigma9, tv4rho3sigma10, t5617, t5633, t5636, t5640, t5653;
  double t5659, t5674, t5679, t5689, t5713, t5747, t5762, tv4rho3sigma11;
  double t5789, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t5839;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t5877, tv4rho2sigma211, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t5971, tv4rho2sigma217, t5989, tv4rhosigma30;
  double tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38;
  double tv4rhosigma39, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316;
  double tv4rhosigma317, tv4rhosigma318, t6055, tv4rhosigma319, t6082, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t6094, tv4sigma414;

  gga_xc_th3_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th3_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = pow(rho[0], 0.1e1 / 0.12e2);
  t31 = t30 * t30;
  t32 = t31 * t31;
  t33 = t32 * t30;
  t35 = pow(rho[1], 0.1e1 / 0.12e2);
  t36 = t35 * t35;
  t37 = t36 * t36;
  t38 = t37 * t35;
  t41 = t29 * (t33 * rho[0] + t38 * rho[1]);
  t42 = sqrt(sigma[0]);
  t43 = 0.1e1 / t10;
  t44 = t42 * t43;
  t45 = rho[0] - rho[1];
  t46 = rho[0] + rho[1];
  t47 = 0.1e1 / t46;
  t48 = t45 * t47;
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * p->zeta_threshold;
  t53 = POW_1_3(t49);
  t55 = my_piecewise3(t50, t52, t53 * t49);
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = t55 * t57;
  t60 = sqrt(sigma[2]);
  t61 = 0.1e1 / t12;
  t62 = t60 * t61;
  t63 = 0.1e1 - t48;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t52, t65 * t63);
  t68 = t67 * t57;
  t71 = t44 * t58 / 0.4e1 + t62 * t68 / 0.4e1;
  t74 = params->omega[5];
  t75 = t74 * t20;
  t78 = params->omega[6];
  t79 = t78 * t27;
  t82 = params->omega[7];
  t83 = t2 * t2;
  t84 = t83 * t83;
  t85 = t84 * t2;
  t86 = t85 * rho[0];
  t87 = t4 * t4;
  t88 = t87 * t87;
  t89 = t88 * t4;
  t90 = t89 * rho[1];
  t91 = t86 + t90;
  t92 = t82 * t91;
  t95 = params->omega[8];
  t96 = t95 * t27;
  t97 = rho[0] * rho[0];
  t99 = 0.1e1 / t23 / t97;
  t100 = sigma[0] * t99;
  t101 = t55 * t55;
  t102 = t101 * t56;
  t103 = t100 * t102;
  t104 = rho[1] * rho[1];
  t106 = 0.1e1 / t25 / t104;
  t107 = sigma[2] * t106;
  t108 = t67 * t67;
  t109 = t108 * t56;
  t110 = t107 * t109;
  t112 = t103 / 0.8e1 + t110 / 0.8e1;
  t115 = params->omega[9];
  t116 = t115 * t91;
  t119 = params->omega[10];
  t120 = t97 + t104;
  t121 = t119 * t120;
  t124 = params->omega[11];
  t125 = t124 * t27;
  t129 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t130 = t46 * t46;
  t131 = POW_1_3(t46);
  t132 = t131 * t131;
  t134 = 0.1e1 / t132 / t130;
  t136 = t103 / 0.4e1 + t110 / 0.4e1 - t129 * t134;
  t138 = params->omega[12];
  t139 = t138 * t91;
  t141 = params->omega[13];
  t142 = t141 * t120;
  t144 = params->omega[14];
  t145 = t144 * t6;
  t146 = t45 * t45;
  t147 = 0.1e1 / t130;
  t148 = t146 * t147;
  t150 = params->omega[15];
  t151 = t150 * t13;
  t153 = params->omega[16];
  t154 = t153 * t20;
  t156 = params->omega[17];
  t157 = t156 * t27;
  t159 = params->omega[18];
  t160 = pow(rho[0], 0.10833333333333333333e1);
  t161 = pow(rho[1], 0.10833333333333333333e1);
  t164 = t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t41 * t71 / 0.2e1 + t75 * t71 / 0.2e1 + t79 * t71 / 0.2e1 + t92 * t71 / 0.2e1 + t96 * t112 / 0.2e1 + t116 * t112 / 0.2e1 + t121 * t112 / 0.2e1 + t125 * t136 + t139 * t136 + t142 * t136 + t145 * t148 + t151 * t148 + t154 * t148 + t157 * t148 + t159 * (t160 + t161);
  tzk0 = t164 * t47;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t173 = pow(rho[0], 0.833333333333333333e-1);
  t177 = 0.1e1 / t9 / t97;
  t178 = t42 * t177;
  t181 = t45 * t147;
  t182 = t47 - t181;
  t185 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t182);
  t186 = t185 * t57;
  t189 = -t182;
  t192 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t189);
  t193 = t192 * t57;
  t196 = -t178 * t58 / 0.3e1 + t44 * t186 / 0.4e1 + t62 * t193 / 0.4e1;
  t199 = t29 * t33;
  t204 = t74 * t16;
  t209 = t78 * t23;
  t214 = t82 * t85;
  t217 = t97 * rho[0];
  t219 = 0.1e1 / t23 / t217;
  t220 = sigma[0] * t219;
  t221 = t220 * t102;
  t223 = t55 * t56;
  t224 = t223 * t185;
  t225 = t100 * t224;
  t227 = t67 * t56;
  t228 = t227 * t192;
  t229 = t107 * t228;
  t231 = -t221 / 0.3e1 + t225 / 0.4e1 + t229 / 0.4e1;
  t234 = t95 * t23;
  t239 = t115 * t85;
  t244 = 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + 0.10833333333333333333e1 * t159 * t173 + t41 * t196 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t71 + t75 * t196 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t71 + t79 * t196 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t71 + t92 * t196 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t71 + t96 * t231 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t112 + t116 * t231 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t112 + t121 * t231 / 0.2e1;
  t245 = t119 * rho[0];
  t250 = t130 * t46;
  t252 = 0.1e1 / t132 / t250;
  t254 = 0.8e1 / 0.3e1 * t129 * t252;
  t255 = -0.2e1 / 0.3e1 * t221 + t225 / 0.2e1 + t229 / 0.2e1 + t254;
  t257 = t124 * t23;
  t261 = t138 * t85;
  t265 = t141 * rho[0];
  t268 = 0.1e1 / t250;
  t269 = t146 * t268;
  t271 = 0.2e1 * t145 * t269;
  t273 = 0.2e1 * t151 * t181;
  t275 = 0.2e1 * t151 * t269;
  t277 = 0.2e1 * t154 * t181;
  t279 = 0.2e1 * t154 * t269;
  t281 = 0.2e1 * t157 * t181;
  t283 = 0.2e1 * t157 * t269;
  t285 = 0.2e1 * t145 * t181;
  t286 = t144 * t2;
  t289 = t150 * t9;
  t292 = t153 * t16;
  t295 = t156 * t23;
  t298 = t245 * t112 + t125 * t255 + 0.5e1 / 0.3e1 * t257 * t136 + t139 * t255 + 0.11e2 / 0.6e1 * t261 * t136 + t142 * t255 + 0.2e1 * t265 * t136 - t271 + t273 - t275 + t277 - t279 + t281 - t283 + t285 + 0.7e1 / 0.6e1 * t286 * t148 + 0.4e1 / 0.3e1 * t289 * t148 + 0.3e1 / 0.2e1 * t292 * t148 + 0.5e1 / 0.3e1 * t295 * t148;
  tvrho0 = t244 + t298;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t307 = pow(rho[1], 0.833333333333333333e-1);
  t310 = -t47 - t181;
  t313 = my_piecewise3(t50, 0, 0.4e1 / 0.3e1 * t53 * t310);
  t314 = t313 * t57;
  t318 = 0.1e1 / t11 / t104;
  t319 = t60 * t318;
  t322 = -t310;
  t325 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t322);
  t326 = t325 * t57;
  t329 = t44 * t314 / 0.4e1 - t319 * t68 / 0.3e1 + t62 * t326 / 0.4e1;
  t332 = t29 * t38;
  t337 = t74 * t18;
  t342 = t78 * t25;
  t347 = t82 * t89;
  t350 = t223 * t313;
  t351 = t100 * t350;
  t353 = t104 * rho[1];
  t355 = 0.1e1 / t25 / t353;
  t356 = sigma[2] * t355;
  t357 = t356 * t109;
  t359 = t227 * t325;
  t360 = t107 * t359;
  t362 = t351 / 0.4e1 - t357 / 0.3e1 + t360 / 0.4e1;
  t365 = t95 * t25;
  t370 = t115 * t89;
  t375 = 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.10833333333333333333e1 * t159 * t307 + t41 * t329 / 0.2e1 + 0.17e2 / 0.24e2 * t332 * t71 + t75 * t329 / 0.2e1 + 0.3e1 / 0.4e1 * t337 * t71 + t79 * t329 / 0.2e1 + 0.5e1 / 0.6e1 * t342 * t71 + t92 * t329 / 0.2e1 + 0.11e2 / 0.12e2 * t347 * t71 + t96 * t362 / 0.2e1 + 0.5e1 / 0.6e1 * t365 * t112 + t116 * t362 / 0.2e1 + 0.11e2 / 0.12e2 * t370 * t112 + t121 * t362 / 0.2e1;
  t376 = t119 * rho[1];
  t381 = t351 / 0.2e1 - 0.2e1 / 0.3e1 * t357 + t360 / 0.2e1 + t254;
  t383 = t124 * t25;
  t387 = t138 * t89;
  t391 = t141 * rho[1];
  t394 = t144 * t4;
  t397 = t150 * t11;
  t400 = t153 * t18;
  t403 = t156 * t25;
  t406 = t376 * t112 + t125 * t381 + 0.5e1 / 0.3e1 * t383 * t136 + t139 * t381 + 0.11e2 / 0.6e1 * t387 * t136 + t142 * t381 + 0.2e1 * t391 * t136 - t271 - t273 - t275 - t277 - t279 - t281 - t283 + 0.7e1 / 0.6e1 * t394 * t148 + 0.4e1 / 0.3e1 * t397 * t148 + 0.3e1 / 0.2e1 * t400 * t148 + 0.5e1 / 0.3e1 * t403 * t148 - t285;
  tvrho1 = t375 + t406;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t407 = 0.1e1 / t42;
  t408 = t41 * t407;
  t410 = t43 * t55 * t57;
  t413 = t75 * t407;
  t416 = t79 * t407;
  t419 = t92 * t407;
  t423 = t99 * t101 * t56;
  t431 = t423 / 0.4e1 - t134;
  tvsigma0 = t408 * t410 / 0.16e2 + t413 * t410 / 0.16e2 + t416 * t410 / 0.16e2 + t419 * t410 / 0.16e2 + t96 * t423 / 0.16e2 + t116 * t423 / 0.16e2 + t121 * t423 / 0.16e2 + t125 * t431 + t139 * t431 + t142 * t431;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t125 * t134 - 0.2e1 * t139 * t134 - 0.2e1 * t142 * t134;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.1e1 / t60;
  t440 = t41 * t439;
  t442 = t61 * t67 * t57;
  t445 = t75 * t439;
  t448 = t79 * t439;
  t451 = t92 * t439;
  t455 = t106 * t108 * t56;
  t463 = t455 / 0.4e1 - t134;
  tvsigma2 = t440 * t442 / 0.16e2 + t445 * t442 / 0.16e2 + t448 * t442 / 0.16e2 + t451 * t442 / 0.16e2 + t96 * t455 / 0.16e2 + t116 * t455 / 0.16e2 + t121 * t455 / 0.16e2 + t125 * t463 + t139 * t463 + t142 * t463;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t467 = t119 * t112;
  t469 = 0.2e1 * t141 * t136;
  t471 = 0.1e1 / t9 / t217;
  t472 = t42 * t471;
  t477 = t53 * t53;
  t478 = 0.1e1 / t477;
  t479 = t182 * t182;
  t482 = t45 * t268;
  t484 = -0.2e1 * t147 + 0.2e1 * t482;
  t488 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t53 * t484);
  t489 = t488 * t57;
  t492 = t65 * t65;
  t493 = 0.1e1 / t492;
  t494 = t189 * t189;
  t497 = -t484;
  t501 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t494 + 0.4e1 / 0.3e1 * t65 * t497);
  t502 = t501 * t57;
  t505 = 0.7e1 / 0.9e1 * t472 * t58 - 0.2e1 / 0.3e1 * t178 * t186 + t44 * t489 / 0.4e1 + t62 * t502 / 0.4e1;
  t522 = t97 * t97;
  t524 = 0.1e1 / t23 / t522;
  t525 = sigma[0] * t524;
  t526 = t525 * t102;
  t528 = t220 * t224;
  t530 = t185 * t185;
  t531 = t530 * t56;
  t532 = t100 * t531;
  t534 = t223 * t488;
  t535 = t100 * t534;
  t537 = t192 * t192;
  t538 = t537 * t56;
  t539 = t107 * t538;
  t541 = t227 * t501;
  t542 = t107 * t541;
  t544 = 0.11e2 / 0.9e1 * t526 - 0.4e1 / 0.3e1 * t528 + t532 / 0.4e1 + t535 / 0.4e1 + t539 / 0.4e1 + t542 / 0.4e1;
  t553 = t467 + t469 + t41 * t505 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t196 + t75 * t505 / 0.2e1 + 0.3e1 / 0.2e1 * t204 * t196 + t79 * t505 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t196 + t92 * t505 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t196 + t96 * t544 / 0.2e1 + 0.5e1 / 0.3e1 * t234 * t231 + t116 * t544 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t231;
  t564 = t130 * t130;
  t566 = 0.1e1 / t132 / t564;
  t568 = 0.88e2 / 0.9e1 * t129 * t566;
  t569 = 0.22e2 / 0.9e1 * t526 - 0.8e1 / 0.3e1 * t528 + t532 / 0.2e1 + t535 / 0.2e1 + t539 / 0.2e1 + t542 / 0.2e1 - t568;
  t579 = t31 * t30;
  t580 = t32 * t579;
  t582 = t29 / t580;
  t585 = 0.1e1 / t16;
  t586 = t74 * t585;
  t589 = 0.1e1 / t9;
  t590 = t78 * t589;
  t593 = 0.1e1 / t2;
  t594 = t82 * t593;
  t597 = t95 * t589;
  t600 = t115 * t593;
  t603 = t124 * t589;
  t606 = t121 * t544 / 0.2e1 + 0.2e1 * t245 * t231 + t125 * t569 + 0.1e2 / 0.3e1 * t257 * t255 + t139 * t569 + 0.11e2 / 0.3e1 * t261 * t255 + t142 * t569 + 0.4e1 * t265 * t255 + 0.85e2 / 0.288e3 * t582 * t71 + 0.3e1 / 0.8e1 * t586 * t71 + 0.5e1 / 0.9e1 * t590 * t71 + 0.55e2 / 0.72e2 * t594 * t71 + 0.5e1 / 0.9e1 * t597 * t112 + 0.55e2 / 0.72e2 * t600 * t112 + 0.1e2 / 0.9e1 * t603 * t136;
  t608 = t138 * t593;
  t612 = 0.2e1 * t145 * t147;
  t614 = 0.2e1 * t151 * t147;
  t615 = 0.1e1 / t85;
  t616 = t144 * t615;
  t619 = t286 * t181;
  t621 = t286 * t269;
  t623 = 0.1e1 / t23;
  t624 = t150 * t623;
  t627 = t289 * t181;
  t629 = t289 * t269;
  t631 = t153 * t585;
  t634 = t292 * t181;
  t636 = t292 * t269;
  t638 = t156 * t589;
  t641 = t295 * t181;
  t643 = t295 * t269;
  t645 = 0.55e2 / 0.36e2 * t608 * t136 + t612 + t614 + 0.7e1 / 0.36e2 * t616 * t148 + 0.14e2 / 0.3e1 * t619 - 0.14e2 / 0.3e1 * t621 + 0.4e1 / 0.9e1 * t624 * t148 + 0.16e2 / 0.3e1 * t627 - 0.16e2 / 0.3e1 * t629 + 0.3e1 / 0.4e1 * t631 * t148 + 0.6e1 * t634 - 0.6e1 * t636 + 0.1e2 / 0.9e1 * t638 * t148 + 0.2e2 / 0.3e1 * t641 - 0.2e2 / 0.3e1 * t643;
  t647 = 0.8e1 * t145 * t482;
  t648 = 0.1e1 / t564;
  t649 = t146 * t648;
  t651 = 0.6e1 * t145 * t649;
  t653 = 0.8e1 * t151 * t482;
  t655 = 0.6e1 * t151 * t649;
  t657 = 0.8e1 * t154 * t482;
  t659 = 0.6e1 * t154 * t649;
  t661 = 0.8e1 * t157 * t482;
  t663 = 0.6e1 * t157 * t649;
  t672 = pow(rho[0], -0.9166666666666666667e0);
  t676 = 0.2e1 * t154 * t147;
  t678 = 0.2e1 * t157 * t147;
  t679 = -t647 + t651 - t653 + t655 - t657 + t659 - t661 + t663 + 0.7e1 / 0.36e2 * t1 * t615 + 0.4e1 / 0.9e1 * t8 * t623 + 0.3e1 / 0.4e1 * t15 * t585 + 0.1e2 / 0.9e1 * t22 * t589 + 0.90277777777777777739e-1 * t159 * t672 + t676 + t678;
  tv2rho20 = t553 + t606 + t645 + t679;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t681 = t394 * t181;
  t683 = t394 * t269;
  t685 = t397 * t181;
  t687 = t397 * t269;
  t689 = t400 * t181;
  t691 = t400 * t269;
  t693 = t403 * t181;
  t695 = t403 * t269;
  t700 = -t612 - t614 + 0.7e1 / 0.3e1 * t681 - 0.7e1 / 0.3e1 * t683 + 0.8e1 / 0.3e1 * t685 - 0.8e1 / 0.3e1 * t687 + 0.3e1 * t689 - 0.3e1 * t691 + 0.1e2 / 0.3e1 * t693 - 0.1e2 / 0.3e1 * t695 - 0.7e1 / 0.3e1 * t619 - 0.7e1 / 0.3e1 * t621 - 0.8e1 / 0.3e1 * t627;
  t708 = t478 * t310;
  t711 = t53 * t45;
  t715 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t708 * t182 + 0.8e1 / 0.3e1 * t711 * t268);
  t716 = t715 * t57;
  t721 = t493 * t322;
  t724 = t65 * t45;
  t728 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t721 * t189 - 0.8e1 / 0.3e1 * t724 * t268);
  t729 = t728 * t57;
  t732 = -t178 * t314 / 0.3e1 + t44 * t716 / 0.4e1 - t319 * t193 / 0.3e1 + t62 * t729 / 0.4e1;
  t739 = -0.8e1 / 0.3e1 * t629 - 0.3e1 * t634 - 0.3e1 * t636 - 0.1e2 / 0.3e1 * t641 - 0.1e2 / 0.3e1 * t643 + t651 + t655 + t659 + t663 - t676 - t678 + t41 * t732 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t329 + 0.17e2 / 0.24e2 * t332 * t196;
  t759 = t220 * t350;
  t761 = t185 * t56;
  t762 = t761 * t313;
  t763 = t100 * t762;
  t765 = t223 * t715;
  t766 = t100 * t765;
  t768 = t356 * t228;
  t770 = t192 * t56;
  t771 = t770 * t325;
  t772 = t107 * t771;
  t774 = t227 * t728;
  t775 = t107 * t774;
  t777 = -0.2e1 / 0.3e1 * t759 + t763 / 0.4e1 + t766 / 0.4e1 - 0.2e1 / 0.3e1 * t768 + t772 / 0.4e1 + t775 / 0.4e1;
  t786 = t75 * t732 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t329 + 0.3e1 / 0.4e1 * t337 * t196 + 0.5e1 / 0.6e1 * t342 * t196 + 0.5e1 / 0.6e1 * t209 * t329 + t92 * t732 / 0.2e1 + t79 * t732 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t329 + 0.11e2 / 0.12e2 * t347 * t196 + t96 * t777 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t362 + 0.5e1 / 0.6e1 * t365 * t231 + t116 * t777 / 0.2e1;
  t801 = -0.4e1 / 0.3e1 * t759 + t763 / 0.2e1 + t766 / 0.2e1 - 0.4e1 / 0.3e1 * t768 + t772 / 0.2e1 + t775 / 0.2e1 - t568;
  t817 = 0.11e2 / 0.12e2 * t239 * t362 + 0.11e2 / 0.12e2 * t370 * t231 + t121 * t777 / 0.2e1 + t245 * t362 + t376 * t231 + t125 * t801 + 0.5e1 / 0.3e1 * t257 * t381 + 0.5e1 / 0.3e1 * t383 * t255 + t139 * t801 + 0.11e2 / 0.6e1 * t261 * t381 + 0.11e2 / 0.6e1 * t387 * t255 + t142 * t801 + 0.2e1 * t265 * t381 + 0.2e1 * t391 * t255;
  tv2rho21 = t700 + t739 + t786 + t817;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t827 = t467 + t469 + t612 + t614 - 0.14e2 / 0.3e1 * t681 - 0.14e2 / 0.3e1 * t683 - 0.16e2 / 0.3e1 * t685 - 0.16e2 / 0.3e1 * t687 - 0.6e1 * t689 - 0.6e1 * t691 - 0.2e2 / 0.3e1 * t693 - 0.2e2 / 0.3e1 * t695 + t647 + t651;
  t828 = 0.1e1 / t89;
  t829 = t144 * t828;
  t832 = 0.1e1 / t25;
  t833 = t150 * t832;
  t836 = 0.1e1 / t18;
  t837 = t153 * t836;
  t840 = 0.1e1 / t11;
  t841 = t156 * t840;
  t852 = pow(rho[1], -0.9166666666666666667e0);
  t855 = t653 + t655 + t657 + t659 + t661 + t663 + 0.7e1 / 0.36e2 * t829 * t148 + 0.4e1 / 0.9e1 * t833 * t148 + 0.3e1 / 0.4e1 * t837 * t148 + 0.1e2 / 0.9e1 * t841 * t148 + 0.7e1 / 0.36e2 * t1 * t828 + 0.4e1 / 0.9e1 * t8 * t832 + 0.3e1 / 0.4e1 * t15 * t836 + 0.1e2 / 0.9e1 * t22 * t840 + 0.90277777777777777739e-1 * t159 * t852;
  t857 = t310 * t310;
  t861 = 0.2e1 * t147 + 0.2e1 * t482;
  t865 = my_piecewise3(t50, 0, 0.4e1 / 0.9e1 * t478 * t857 + 0.4e1 / 0.3e1 * t53 * t861);
  t866 = t865 * t57;
  t870 = 0.1e1 / t11 / t353;
  t871 = t60 * t870;
  t876 = t322 * t322;
  t879 = -t861;
  t883 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t493 * t876 + 0.4e1 / 0.3e1 * t65 * t879);
  t884 = t883 * t57;
  t887 = t44 * t866 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t68 - 0.2e1 / 0.3e1 * t319 * t326 + t62 * t884 / 0.4e1;
  t904 = t313 * t313;
  t905 = t904 * t56;
  t906 = t100 * t905;
  t908 = t223 * t865;
  t909 = t100 * t908;
  t911 = t104 * t104;
  t913 = 0.1e1 / t25 / t911;
  t914 = sigma[2] * t913;
  t915 = t914 * t109;
  t917 = t356 * t359;
  t919 = t325 * t325;
  t920 = t919 * t56;
  t921 = t107 * t920;
  t923 = t227 * t883;
  t924 = t107 * t923;
  t926 = t906 / 0.4e1 + t909 / 0.4e1 + 0.11e2 / 0.9e1 * t915 - 0.4e1 / 0.3e1 * t917 + t921 / 0.4e1 + t924 / 0.4e1;
  t937 = t676 + t678 + t41 * t887 / 0.2e1 + 0.17e2 / 0.12e2 * t332 * t329 + t75 * t887 / 0.2e1 + 0.3e1 / 0.2e1 * t337 * t329 + t79 * t887 / 0.2e1 + 0.5e1 / 0.3e1 * t342 * t329 + t92 * t887 / 0.2e1 + 0.11e2 / 0.6e1 * t347 * t329 + t96 * t926 / 0.2e1 + 0.5e1 / 0.3e1 * t365 * t362 + t116 * t926 / 0.2e1 + 0.11e2 / 0.6e1 * t370 * t362 + t121 * t926 / 0.2e1;
  t946 = t906 / 0.2e1 + t909 / 0.2e1 + 0.22e2 / 0.9e1 * t915 - 0.8e1 / 0.3e1 * t917 + t921 / 0.2e1 + t924 / 0.2e1 - t568;
  t956 = t36 * t35;
  t957 = t37 * t956;
  t959 = t29 / t957;
  t962 = t74 * t836;
  t965 = t78 * t840;
  t968 = 0.1e1 / t4;
  t969 = t82 * t968;
  t972 = t95 * t840;
  t975 = t115 * t968;
  t978 = t124 * t840;
  t981 = t138 * t968;
  t984 = 0.2e1 * t376 * t362 + t125 * t946 + 0.1e2 / 0.3e1 * t383 * t381 + t139 * t946 + 0.11e2 / 0.3e1 * t387 * t381 + t142 * t946 + 0.4e1 * t391 * t381 + 0.85e2 / 0.288e3 * t959 * t71 + 0.3e1 / 0.8e1 * t962 * t71 + 0.5e1 / 0.9e1 * t965 * t71 + 0.55e2 / 0.72e2 * t969 * t71 + 0.5e1 / 0.9e1 * t972 * t112 + 0.55e2 / 0.72e2 * t975 * t112 + 0.1e2 / 0.9e1 * t978 * t136 + 0.55e2 / 0.36e2 * t981 * t136;
  tv2rho22 = t827 + t855 + t937 + t984;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t987 = t43 * t185 * t57;
  t996 = t96 * t99;
  t999 = t116 * t99;
  t1002 = t121 * t99;
  t1006 = t177 * t55 * t57;
  t1016 = t95 / t97;
  t1019 = 0.1e1 / t86;
  t1020 = t115 * t1019;
  t1023 = t408 * t987 / 0.16e2 + t413 * t987 / 0.16e2 + t416 * t987 / 0.16e2 + t419 * t987 / 0.16e2 + t996 * t224 / 0.8e1 + t999 * t224 / 0.8e1 + t1002 * t224 / 0.8e1 - t408 * t1006 / 0.12e2 - t413 * t1006 / 0.12e2 - t416 * t1006 / 0.12e2 - t419 * t1006 / 0.12e2 + 0.5e1 / 0.48e2 * t1016 * t102 + 0.11e2 / 0.96e2 * t1020 * t102;
  t1024 = 0.1e1 / t24;
  t1025 = t119 * t1024;
  t1028 = t32 * t32;
  t1029 = t1028 * t579;
  t1031 = t29 / t1029;
  t1033 = t407 * t55 * t57;
  t1036 = t74 * t615;
  t1039 = t78 * t623;
  t1042 = t82 * t585;
  t1046 = t219 * t101 * t56;
  t1054 = t99 * t55;
  t1057 = 0.8e1 / 0.3e1 * t252;
  t1058 = -0.2e1 / 0.3e1 * t1046 + t1054 * t761 / 0.2e1 + t1057;
  t1068 = t1025 * t102 / 0.8e1 + 0.17e2 / 0.192e3 * t1031 * t1033 + 0.3e1 / 0.32e2 * t1036 * t1033 + 0.5e1 / 0.48e2 * t1039 * t1033 + 0.11e2 / 0.96e2 * t1042 * t1033 - t96 * t1046 / 0.6e1 - t116 * t1046 / 0.6e1 - t121 * t1046 / 0.6e1 + t125 * t1058 + 0.5e1 / 0.3e1 * t257 * t431 + t139 * t1058 + 0.11e2 / 0.6e1 * t261 * t431 + t142 * t1058 + 0.2e1 * t265 * t431;
  tv2rhosigma0 = t1023 + t1068;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1072 = 0.16e2 / 0.3e1 * t125 * t252;
  t1076 = 0.16e2 / 0.3e1 * t139 * t252;
  t1080 = 0.16e2 / 0.3e1 * t142 * t252;
  tv2rhosigma1 = -0.1e2 / 0.3e1 * t257 * t134 + t1072 - 0.11e2 / 0.3e1 * t261 * t134 + t1076 - 0.4e1 * t265 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1081 = t199 * t439;
  t1085 = t61 * t192 * t57;
  t1088 = t204 * t439;
  t1093 = t209 * t439;
  t1098 = t214 * t439;
  t1105 = t96 * t106;
  t1110 = t116 * t106;
  t1115 = t121 * t106;
  t1120 = t106 * t67;
  t1123 = t1120 * t770 / 0.2e1 + t1057;
  tv2rhosigma2 = 0.17e2 / 0.192e3 * t1081 * t442 + t440 * t1085 / 0.16e2 + 0.3e1 / 0.32e2 * t1088 * t442 + t445 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t442 + t448 * t1085 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t442 + t451 * t1085 / 0.16e2 + 0.5e1 / 0.48e2 * t234 * t455 + t1105 * t228 / 0.8e1 + 0.11e2 / 0.96e2 * t239 * t455 + t1110 * t228 / 0.8e1 + t245 * t455 / 0.8e1 + t1115 * t228 / 0.8e1 + 0.5e1 / 0.3e1 * t257 * t463 + t125 * t1123 + 0.11e2 / 0.6e1 * t261 * t463 + t139 * t1123 + 0.2e1 * t265 * t463 + t142 * t1123;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1131 = t332 * t407;
  t1135 = t43 * t313 * t57;
  t1138 = t337 * t407;
  t1143 = t342 * t407;
  t1148 = t347 * t407;
  t1167 = t56 * t313;
  t1170 = t1054 * t1167 / 0.2e1 + t1057;
  tv2rhosigma3 = 0.17e2 / 0.192e3 * t1131 * t410 + t408 * t1135 / 0.16e2 + 0.3e1 / 0.32e2 * t1138 * t410 + t413 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t410 + t416 * t1135 / 0.16e2 + 0.11e2 / 0.96e2 * t1148 * t410 + t419 * t1135 / 0.16e2 + 0.5e1 / 0.48e2 * t365 * t423 + t996 * t350 / 0.8e1 + 0.11e2 / 0.96e2 * t370 * t423 + t999 * t350 / 0.8e1 + t376 * t423 / 0.8e1 + t1002 * t350 / 0.8e1 + 0.5e1 / 0.3e1 * t383 * t431 + t125 * t1170 + 0.11e2 / 0.6e1 * t387 * t431 + t139 * t1170 + 0.2e1 * t391 * t431 + t142 * t1170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.1e2 / 0.3e1 * t383 * t134 + t1072 - 0.11e2 / 0.3e1 * t387 * t134 + t1076 - 0.4e1 * t391 * t134 + t1080;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1185 = t61 * t325 * t57;
  t1201 = t318 * t67 * t57;
  t1211 = t95 / t104;
  t1214 = 0.1e1 / t90;
  t1215 = t115 * t1214;
  t1218 = t440 * t1185 / 0.16e2 + t445 * t1185 / 0.16e2 + t448 * t1185 / 0.16e2 + t451 * t1185 / 0.16e2 + t1105 * t359 / 0.8e1 + t1110 * t359 / 0.8e1 + t1115 * t359 / 0.8e1 - t440 * t1201 / 0.12e2 - t445 * t1201 / 0.12e2 - t448 * t1201 / 0.12e2 - t451 * t1201 / 0.12e2 + 0.5e1 / 0.48e2 * t1211 * t109 + 0.11e2 / 0.96e2 * t1215 * t109;
  t1219 = 0.1e1 / t26;
  t1220 = t119 * t1219;
  t1224 = t355 * t108 * t56;
  t1231 = t37 * t37;
  t1232 = t1231 * t956;
  t1234 = t29 / t1232;
  t1236 = t439 * t67 * t57;
  t1239 = t74 * t828;
  t1242 = t78 * t832;
  t1245 = t82 * t836;
  t1249 = t56 * t325;
  t1252 = -0.2e1 / 0.3e1 * t1224 + t1120 * t1249 / 0.2e1 + t1057;
  t1262 = t1220 * t109 / 0.8e1 - t96 * t1224 / 0.6e1 - t116 * t1224 / 0.6e1 - t121 * t1224 / 0.6e1 + 0.17e2 / 0.192e3 * t1234 * t1236 + 0.3e1 / 0.32e2 * t1239 * t1236 + 0.5e1 / 0.48e2 * t1242 * t1236 + 0.11e2 / 0.96e2 * t1245 * t1236 + t125 * t1252 + 0.5e1 / 0.3e1 * t383 * t463 + t139 * t1252 + 0.11e2 / 0.6e1 * t387 * t463 + t142 * t1252 + 0.2e1 * t391 * t463;
  tv2rhosigma5 = t1218 + t1262;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1264 = 0.1e1 / t42 / sigma[0];
  t1265 = t41 * t1264;
  t1267 = t75 * t1264;
  t1269 = t79 * t1264;
  t1271 = t92 * t1264;
  tv2sigma20 = -t1265 * t410 / 0.32e2 - t1267 * t410 / 0.32e2 - t1269 * t410 / 0.32e2 - t1271 * t410 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1275 = 0.1e1 / t60 / sigma[2];
  t1276 = t41 * t1275;
  t1278 = t75 * t1275;
  t1280 = t79 * t1275;
  t1282 = t92 * t1275;
  tv2sigma25 = -t1276 * t442 / 0.32e2 - t1278 * t442 / 0.32e2 - t1280 * t442 / 0.32e2 - t1282 * t442 / 0.32e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1285 = t564 * t46;
  t1286 = 0.1e1 / t1285;
  t1287 = t146 * t1286;
  t1289 = 0.24e2 * t151 * t1287;
  t1290 = t45 * t648;
  t1291 = t154 * t1290;
  t1292 = 0.36e2 * t1291;
  t1294 = 0.24e2 * t154 * t1287;
  t1295 = t157 * t1290;
  t1296 = 0.36e2 * t1295;
  t1298 = 0.24e2 * t157 * t1287;
  t1299 = t144 * t1019;
  t1302 = t616 * t181;
  t1304 = t616 * t269;
  t1306 = t286 * t482;
  t1308 = t286 * t649;
  t1310 = t150 * t1024;
  t1313 = t624 * t181;
  t1315 = t624 * t269;
  t1317 = t289 * t482;
  t1319 = t289 * t649;
  t1321 = 0.1e1 / t17;
  t1322 = t153 * t1321;
  t1325 = t631 * t181;
  t1327 = t631 * t269;
  t1329 = t292 * t482;
  t1331 = -t1289 + t1292 - t1294 + t1296 - t1298 - 0.35e2 / 0.216e3 * t1299 * t148 + 0.7e1 / 0.6e1 * t1302 - 0.7e1 / 0.6e1 * t1304 - 0.28e2 * t1306 + 0.21e2 * t1308 - 0.8e1 / 0.27e2 * t1310 * t148 + 0.8e1 / 0.3e1 * t1313 - 0.8e1 / 0.3e1 * t1315 - 0.32e2 * t1317 + 0.24e2 * t1319 - 0.3e1 / 0.8e1 * t1322 * t148 + 0.9e1 / 0.2e1 * t1325 - 0.9e1 / 0.2e1 * t1327 - 0.36e2 * t1329;
  t1332 = t292 * t649;
  t1334 = t156 * t43;
  t1337 = t638 * t181;
  t1339 = t638 * t269;
  t1341 = t295 * t482;
  t1343 = t295 * t649;
  t1345 = t145 * t1290;
  t1346 = 0.36e2 * t1345;
  t1348 = 0.24e2 * t145 * t1287;
  t1349 = t151 * t1290;
  t1350 = 0.36e2 * t1349;
  t1359 = pow(rho[0], -0.19166666666666666667e1);
  t1362 = t119 * t231;
  t1364 = t141 * t255;
  t1366 = t286 * t147;
  t1368 = t289 * t147;
  t1370 = t292 * t147;
  t1372 = t295 * t147;
  t1374 = 0.27e2 * t1332 - 0.1e2 / 0.27e2 * t1334 * t148 + 0.2e2 / 0.3e1 * t1337 - 0.2e2 / 0.3e1 * t1339 - 0.4e2 * t1341 + 0.3e2 * t1343 + t1346 - t1348 + t1350 - 0.35e2 / 0.216e3 * t1 * t1019 - 0.8e1 / 0.27e2 * t8 * t1024 - 0.3e1 / 0.8e1 * t15 * t1321 - 0.1e2 / 0.27e2 * t22 * t43 - 0.82754629629629629597e-1 * t159 * t1359 + 0.3e1 * t1362 + 0.6e1 * t1364 + 0.7e1 * t1366 + 0.8e1 * t1368 + 0.9e1 * t1370 + 0.1e2 * t1372;
  t1377 = 0.1e1 / t9 / t522;
  t1378 = t42 * t1377;
  t1385 = 0.1e1 / t477 / t49;
  t1386 = t479 * t182;
  t1389 = t478 * t182;
  t1393 = 0.6e1 * t268 - 0.6e1 * t1290;
  t1397 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1385 * t1386 + 0.4e1 / 0.3e1 * t1389 * t484 + 0.4e1 / 0.3e1 * t53 * t1393);
  t1398 = t1397 * t57;
  t1402 = 0.1e1 / t492 / t63;
  t1403 = t494 * t189;
  t1406 = t493 * t189;
  t1409 = -t1393;
  t1413 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1402 * t1403 + 0.4e1 / 0.3e1 * t1406 * t497 + 0.4e1 / 0.3e1 * t65 * t1409);
  t1414 = t1413 * t57;
  t1417 = -0.7e2 / 0.27e2 * t1378 * t58 + 0.7e1 / 0.3e1 * t472 * t186 - t178 * t489 + t44 * t1398 / 0.4e1 + t62 * t1414 / 0.4e1;
  t1426 = t522 * rho[0];
  t1428 = 0.1e1 / t23 / t1426;
  t1429 = sigma[0] * t1428;
  t1430 = t1429 * t102;
  t1432 = t525 * t224;
  t1434 = t220 * t531;
  t1436 = t220 * t534;
  t1438 = t761 * t488;
  t1439 = t100 * t1438;
  t1441 = t223 * t1397;
  t1442 = t100 * t1441;
  t1444 = t770 * t501;
  t1445 = t107 * t1444;
  t1447 = t227 * t1413;
  t1448 = t107 * t1447;
  t1450 = -0.154e3 / 0.27e2 * t1430 + 0.22e2 / 0.3e1 * t1432 - 0.2e1 * t1434 - 0.2e1 * t1436 + 0.3e1 / 0.4e1 * t1439 + t1442 / 0.4e1 + 0.3e1 / 0.4e1 * t1445 + t1448 / 0.4e1;
  t1472 = 0.1e1 / t132 / t1285;
  t1474 = 0.1232e4 / 0.27e2 * t129 * t1472;
  t1475 = -0.308e3 / 0.27e2 * t1430 + 0.44e2 / 0.3e1 * t1432 - 0.4e1 * t1434 - 0.4e1 * t1436 + 0.3e1 / 0.2e1 * t1439 + t1442 / 0.2e1 + 0.3e1 / 0.2e1 * t1445 + t1448 / 0.2e1 + t1474;
  t1493 = t79 * t1417 / 0.2e1 + 0.5e1 / 0.2e1 * t209 * t505 + t92 * t1417 / 0.2e1 + 0.11e2 / 0.4e1 * t214 * t505 + t96 * t1450 / 0.2e1 + 0.5e1 / 0.2e1 * t234 * t544 + t116 * t1450 / 0.2e1 + 0.11e2 / 0.4e1 * t239 * t544 + t121 * t1450 / 0.2e1 + 0.3e1 * t245 * t544 + t125 * t1475 + 0.5e1 * t257 * t569 + t139 * t1475 + 0.11e2 / 0.2e1 * t261 * t569 + t142 * t1475 + 0.6e1 * t265 * t569 + t41 * t1417 / 0.2e1 + 0.17e2 / 0.8e1 * t199 * t505 + t75 * t1417 / 0.2e1 + 0.9e1 / 0.4e1 * t204 * t505;
  t1494 = t145 * t268;
  t1495 = 0.12e2 * t1494;
  t1496 = t151 * t268;
  t1497 = 0.12e2 * t1496;
  t1498 = t154 * t268;
  t1499 = 0.12e2 * t1498;
  t1500 = t157 * t268;
  t1501 = 0.12e2 * t1500;
  t1504 = t29 / t580 / rho[0];
  t1507 = t74 * t1321;
  t1510 = t78 * t43;
  t1513 = 0.1e1 / t3;
  t1514 = t82 * t1513;
  t1517 = t95 * t43;
  t1520 = t115 * t1513;
  t1523 = t124 * t43;
  t1526 = t138 * t1513;
  t1545 = -t1495 - t1497 - t1499 - t1501 - 0.595e3 / 0.3456e4 * t1504 * t71 - 0.3e1 / 0.16e2 * t1507 * t71 - 0.5e1 / 0.27e2 * t1510 * t71 - 0.55e2 / 0.432e3 * t1514 * t71 - 0.5e1 / 0.27e2 * t1517 * t112 - 0.55e2 / 0.432e3 * t1520 * t112 - 0.1e2 / 0.27e2 * t1523 * t136 - 0.55e2 / 0.216e3 * t1526 * t136 + 0.5e1 / 0.3e1 * t597 * t231 + 0.55e2 / 0.24e2 * t600 * t231 + 0.1e2 / 0.3e1 * t603 * t255 + 0.55e2 / 0.12e2 * t608 * t255 + 0.9e1 / 0.8e1 * t586 * t196 + 0.5e1 / 0.3e1 * t590 * t196 + 0.55e2 / 0.24e2 * t594 * t196 + 0.85e2 / 0.96e2 * t582 * t196;
  tv3rho30 = t1331 + t1374 + t1493 + t1545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1547 = 0.12e2 * t1291;
  t1548 = 0.12e2 * t1295;
  t1561 = 0.12e2 * t1345;
  t1562 = 0.12e2 * t1349;
  t1563 = -t1289 + t1547 - t1294 + t1548 - t1298 - 0.7e1 / 0.18e2 * t1302 - 0.7e1 / 0.18e2 * t1304 + 0.14e2 * t1308 - 0.8e1 / 0.9e1 * t1313 - 0.8e1 / 0.9e1 * t1315 + 0.16e2 * t1319 - 0.3e1 / 0.2e1 * t1325 - 0.3e1 / 0.2e1 * t1327 + 0.18e2 * t1332 - 0.2e2 / 0.9e1 * t1337 - 0.2e2 / 0.9e1 * t1339 + 0.2e2 * t1343 + t1561 - t1348 + t1562;
  t1564 = t397 * t482;
  t1566 = t397 * t649;
  t1568 = t400 * t482;
  t1570 = t400 * t649;
  t1572 = t403 * t482;
  t1574 = t403 * t649;
  t1576 = t394 * t482;
  t1578 = t394 * t649;
  t1580 = t141 * t381;
  t1582 = t119 * t362;
  t1587 = 0.4e1 * t1494;
  t1588 = 0.4e1 * t1496;
  t1589 = 0.4e1 * t1498;
  t1590 = 0.4e1 * t1500;
  t1595 = -0.32e2 / 0.3e1 * t1564 + 0.8e1 * t1566 - 0.12e2 * t1568 + 0.9e1 * t1570 - 0.4e2 / 0.3e1 * t1572 + 0.1e2 * t1574 - 0.28e2 / 0.3e1 * t1576 + 0.7e1 * t1578 + 0.2e1 * t1580 + t1582 - 0.14e2 / 0.3e1 * t1366 - 0.16e2 / 0.3e1 * t1368 - 0.6e1 * t1370 - 0.2e2 / 0.3e1 * t1372 + t1587 + t1588 + t1589 + t1590 + 0.4e1 * t265 * t801 + 0.2e1 * t391 * t569;
  t1597 = t525 * t350;
  t1599 = t220 * t762;
  t1601 = t220 * t765;
  t1603 = t488 * t56;
  t1604 = t1603 * t313;
  t1605 = t100 * t1604;
  t1607 = t761 * t715;
  t1608 = t100 * t1607;
  t1610 = t1385 * t310;
  t1613 = t478 * t45;
  t1624 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1610 * t479 + 0.16e2 / 0.9e1 * t1613 * t268 * t182 + 0.4e1 / 0.9e1 * t708 * t484 + 0.8e1 / 0.3e1 * t53 * t268 - 0.8e1 * t711 * t648);
  t1625 = t223 * t1624;
  t1626 = t100 * t1625;
  t1628 = t356 * t538;
  t1630 = t356 * t541;
  t1632 = t501 * t56;
  t1633 = t1632 * t325;
  t1634 = t107 * t1633;
  t1636 = t770 * t728;
  t1637 = t107 * t1636;
  t1639 = t1402 * t322;
  t1642 = t493 * t45;
  t1653 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1639 * t494 - 0.16e2 / 0.9e1 * t1642 * t268 * t189 + 0.4e1 / 0.9e1 * t721 * t497 - 0.8e1 / 0.3e1 * t65 * t268 + 0.8e1 * t724 * t648);
  t1654 = t227 * t1653;
  t1655 = t107 * t1654;
  t1657 = 0.22e2 / 0.9e1 * t1597 - 0.4e1 / 0.3e1 * t1599 - 0.4e1 / 0.3e1 * t1601 + t1605 / 0.4e1 + t1608 / 0.2e1 + t1626 / 0.4e1 - 0.2e1 / 0.3e1 * t1628 - 0.2e1 / 0.3e1 * t1630 + t1634 / 0.4e1 + t1637 / 0.2e1 + t1655 / 0.4e1;
  t1684 = 0.44e2 / 0.9e1 * t1597 - 0.8e1 / 0.3e1 * t1599 - 0.8e1 / 0.3e1 * t1601 + t1605 / 0.2e1 + t1608 + t1626 / 0.2e1 - 0.4e1 / 0.3e1 * t1628 - 0.4e1 / 0.3e1 * t1630 + t1634 / 0.2e1 + t1637 + t1655 / 0.2e1 + t1474;
  t1700 = t1624 * t57;
  t1705 = t1653 * t57;
  t1708 = 0.7e1 / 0.9e1 * t472 * t314 - 0.2e1 / 0.3e1 * t178 * t716 + t44 * t1700 / 0.4e1 - t319 * t502 / 0.3e1 + t62 * t1705 / 0.4e1;
  t1717 = t96 * t1657 / 0.2e1 + 0.5e1 / 0.3e1 * t234 * t777 + 0.5e1 / 0.6e1 * t365 * t544 + t116 * t1657 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t777 + 0.11e2 / 0.12e2 * t370 * t544 + t121 * t1657 / 0.2e1 + 0.2e1 * t245 * t777 + t376 * t544 + t125 * t1684 + 0.1e2 / 0.3e1 * t257 * t801 + 0.5e1 / 0.3e1 * t383 * t569 + t139 * t1684 + 0.11e2 / 0.3e1 * t261 * t801 + 0.11e2 / 0.6e1 * t387 * t569 + t142 * t1684 + t41 * t1708 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t732 + 0.17e2 / 0.24e2 * t332 * t505 + t75 * t1708 / 0.2e1;
  t1734 = t394 * t147;
  t1736 = t397 * t147;
  t1738 = t400 * t147;
  t1740 = t403 * t147;
  t1758 = 0.3e1 / 0.2e1 * t204 * t732 + 0.3e1 / 0.4e1 * t337 * t505 + t79 * t1708 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t732 + 0.5e1 / 0.6e1 * t342 * t505 + t92 * t1708 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t732 + 0.11e2 / 0.12e2 * t347 * t505 + 0.7e1 / 0.3e1 * t1734 + 0.8e1 / 0.3e1 * t1736 + 0.3e1 * t1738 + 0.1e2 / 0.3e1 * t1740 + 0.3e1 / 0.8e1 * t586 * t329 + 0.5e1 / 0.9e1 * t590 * t329 + 0.55e2 / 0.72e2 * t594 * t329 + 0.5e1 / 0.9e1 * t597 * t362 + 0.55e2 / 0.72e2 * t600 * t362 + 0.1e2 / 0.9e1 * t603 * t381 + 0.55e2 / 0.36e2 * t608 * t381 + 0.85e2 / 0.288e3 * t582 * t329;
  tv3rho31 = t1563 + t1595 + t1717 + t1758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1772 = -t1289 - t1547 - t1294 - t1548 - t1298 + 0.28e2 / 0.3e1 * t1306 + 0.7e1 * t1308 + 0.32e2 / 0.3e1 * t1317 + 0.8e1 * t1319 + 0.12e2 * t1329 + 0.9e1 * t1332 + 0.4e2 / 0.3e1 * t1341 + 0.1e2 * t1343 - t1561 - t1348 - t1562 + 0.16e2 * t1566 + 0.18e2 * t1570 + 0.2e2 * t1574 + 0.14e2 * t1578;
  t1794 = t1362 + 0.2e1 * t1364 + 0.7e1 / 0.3e1 * t1366 + 0.8e1 / 0.3e1 * t1368 + 0.3e1 * t1370 + 0.1e2 / 0.3e1 * t1372 + t1587 + t1588 + t1589 + t1590 - 0.14e2 / 0.3e1 * t1734 - 0.16e2 / 0.3e1 * t1736 - 0.6e1 * t1738 - 0.2e2 / 0.3e1 * t1740 + 0.85e2 / 0.288e3 * t959 * t196 + 0.3e1 / 0.8e1 * t962 * t196 + 0.5e1 / 0.9e1 * t965 * t196 + 0.55e2 / 0.72e2 * t969 * t196 + 0.5e1 / 0.9e1 * t972 * t231 + 0.55e2 / 0.72e2 * t975 * t231;
  t1802 = t1385 * t857;
  t1807 = t478 * t861;
  t1812 = -0.2e1 * t268 - 0.6e1 * t1290;
  t1816 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1802 * t182 + 0.16e2 / 0.9e1 * t708 * t482 + 0.4e1 / 0.9e1 * t1807 * t182 + 0.4e1 / 0.3e1 * t53 * t1812);
  t1817 = t1816 * t57;
  t1824 = t1402 * t876;
  t1829 = t493 * t879;
  t1832 = -t1812;
  t1836 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1824 * t189 - 0.16e2 / 0.9e1 * t721 * t482 + 0.4e1 / 0.9e1 * t1829 * t189 + 0.4e1 / 0.3e1 * t65 * t1832);
  t1837 = t1836 * t57;
  t1840 = -t178 * t866 / 0.3e1 + t44 * t1817 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t193 - 0.2e1 / 0.3e1 * t319 * t729 + t62 * t1837 / 0.4e1;
  t1859 = t220 * t905;
  t1861 = t1167 * t715;
  t1862 = t100 * t1861;
  t1864 = t220 * t908;
  t1866 = t761 * t865;
  t1867 = t100 * t1866;
  t1869 = t223 * t1816;
  t1870 = t100 * t1869;
  t1872 = t914 * t228;
  t1874 = t356 * t771;
  t1876 = t356 * t774;
  t1878 = t1249 * t728;
  t1879 = t107 * t1878;
  t1881 = t770 * t883;
  t1882 = t107 * t1881;
  t1884 = t227 * t1836;
  t1885 = t107 * t1884;
  t1887 = -0.2e1 / 0.3e1 * t1859 + t1862 / 0.2e1 - 0.2e1 / 0.3e1 * t1864 + t1867 / 0.4e1 + t1870 / 0.4e1 + 0.22e2 / 0.9e1 * t1872 - 0.4e1 / 0.3e1 * t1874 - 0.4e1 / 0.3e1 * t1876 + t1879 / 0.2e1 + t1882 / 0.4e1 + t1885 / 0.4e1;
  t1905 = 0.1e2 / 0.9e1 * t978 * t255 + 0.55e2 / 0.36e2 * t981 * t255 + t75 * t1840 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t887 + 0.3e1 / 0.2e1 * t337 * t732 + t79 * t1840 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t887 + 0.5e1 / 0.3e1 * t342 * t732 + t92 * t1840 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t887 + 0.11e2 / 0.6e1 * t347 * t732 + t96 * t1887 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t926 + 0.5e1 / 0.3e1 * t365 * t777 + t116 * t1887 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t926 + 0.11e2 / 0.6e1 * t370 * t777 + t121 * t1887 / 0.2e1 + t245 * t926 + 0.2e1 * t376 * t777;
  t1915 = -0.4e1 / 0.3e1 * t1859 + t1862 - 0.4e1 / 0.3e1 * t1864 + t1867 / 0.2e1 + t1870 / 0.2e1 + 0.44e2 / 0.9e1 * t1872 - 0.8e1 / 0.3e1 * t1874 - 0.8e1 / 0.3e1 * t1876 + t1879 + t1882 / 0.2e1 + t1885 / 0.2e1 + t1474;
  t1937 = t829 * t181;
  t1939 = t829 * t269;
  t1941 = t833 * t181;
  t1943 = t833 * t269;
  t1945 = t837 * t181;
  t1947 = t837 * t269;
  t1949 = t841 * t181;
  t1951 = t841 * t269;
  t1953 = t125 * t1915 + 0.5e1 / 0.3e1 * t257 * t946 + 0.1e2 / 0.3e1 * t383 * t801 + t139 * t1915 + 0.11e2 / 0.6e1 * t261 * t946 + 0.11e2 / 0.3e1 * t387 * t801 + t142 * t1915 + 0.2e1 * t265 * t946 + 0.4e1 * t391 * t801 + t41 * t1840 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t887 + 0.17e2 / 0.12e2 * t332 * t732 + 0.7e1 / 0.18e2 * t1937 - 0.7e1 / 0.18e2 * t1939 + 0.8e1 / 0.9e1 * t1941 - 0.8e1 / 0.9e1 * t1943 + 0.3e1 / 0.2e1 * t1945 - 0.3e1 / 0.2e1 * t1947 + 0.2e2 / 0.9e1 * t1949 - 0.2e2 / 0.9e1 * t1951;
  tv3rho32 = t1772 + t1794 + t1905 + t1953;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1955 = t144 * t1214;
  t1958 = t150 * t1219;
  t1961 = 0.1e1 / t19;
  t1962 = t153 * t1961;
  t1965 = t156 * t61;
  t1976 = pow(rho[1], -0.19166666666666666667e1);
  t1981 = -0.35e2 / 0.216e3 * t1955 * t148 - 0.8e1 / 0.27e2 * t1958 * t148 - 0.3e1 / 0.8e1 * t1962 * t148 - 0.1e2 / 0.27e2 * t1965 * t148 - 0.35e2 / 0.216e3 * t1 * t1214 - 0.8e1 / 0.27e2 * t8 * t1219 - 0.3e1 / 0.8e1 * t15 * t1961 - 0.1e2 / 0.27e2 * t22 * t61 - 0.82754629629629629597e-1 * t159 * t1976 - t1289 - t1292 - t1294 - t1296 - t1298 - t1346 - t1348 - t1350 + 0.32e2 * t1564 + 0.24e2 * t1566;
  t1996 = t29 / t957 / rho[1];
  t1999 = t74 * t1961;
  t2002 = t78 * t61;
  t2005 = 0.1e1 / t5;
  t2006 = t82 * t2005;
  t2009 = 0.36e2 * t1568 + 0.27e2 * t1570 + 0.4e2 * t1572 + 0.3e2 * t1574 + 0.28e2 * t1576 + 0.21e2 * t1578 + 0.6e1 * t1580 + 0.3e1 * t1582 - t1495 - t1497 - t1499 - t1501 + 0.7e1 * t1734 + 0.8e1 * t1736 + 0.9e1 * t1738 + 0.1e2 * t1740 - 0.595e3 / 0.3456e4 * t1996 * t71 - 0.3e1 / 0.16e2 * t1999 * t71 - 0.5e1 / 0.27e2 * t2002 * t71 - 0.55e2 / 0.432e3 * t2006 * t71;
  t2011 = t95 * t61;
  t2014 = t115 * t2005;
  t2017 = t124 * t61;
  t2020 = t138 * t2005;
  t2031 = t1167 * t865;
  t2032 = t100 * t2031;
  t2034 = t857 * t310;
  t2040 = -0.6e1 * t268 - 0.6e1 * t1290;
  t2044 = my_piecewise3(t50, 0, -0.8e1 / 0.27e2 * t1385 * t2034 + 0.4e1 / 0.3e1 * t708 * t861 + 0.4e1 / 0.3e1 * t53 * t2040);
  t2045 = t223 * t2044;
  t2046 = t100 * t2045;
  t2048 = t911 * rho[1];
  t2050 = 0.1e1 / t25 / t2048;
  t2051 = sigma[2] * t2050;
  t2052 = t2051 * t109;
  t2054 = t914 * t359;
  t2056 = t356 * t920;
  t2058 = t356 * t923;
  t2060 = t1249 * t883;
  t2061 = t107 * t2060;
  t2063 = t876 * t322;
  t2068 = -t2040;
  t2072 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1402 * t2063 + 0.4e1 / 0.3e1 * t721 * t879 + 0.4e1 / 0.3e1 * t65 * t2068);
  t2073 = t227 * t2072;
  t2074 = t107 * t2073;
  t2076 = 0.3e1 / 0.2e1 * t2032 + t2046 / 0.2e1 - 0.308e3 / 0.27e2 * t2052 + 0.44e2 / 0.3e1 * t2054 - 0.4e1 * t2056 - 0.4e1 * t2058 + 0.3e1 / 0.2e1 * t2061 + t2074 / 0.2e1 + t1474;
  t2085 = t2044 * t57;
  t2089 = 0.1e1 / t11 / t911;
  t2090 = t60 * t2089;
  t2096 = t2072 * t57;
  t2099 = t44 * t2085 / 0.4e1 - 0.7e2 / 0.27e2 * t2090 * t68 + 0.7e1 / 0.3e1 * t871 * t326 - t319 * t884 + t62 * t2096 / 0.4e1;
  t2120 = 0.3e1 / 0.4e1 * t2032 + t2046 / 0.4e1 - 0.154e3 / 0.27e2 * t2052 + 0.22e2 / 0.3e1 * t2054 - 0.2e1 * t2056 - 0.2e1 * t2058 + 0.3e1 / 0.4e1 * t2061 + t2074 / 0.4e1;
  t2123 = -0.5e1 / 0.27e2 * t2011 * t112 - 0.55e2 / 0.432e3 * t2014 * t112 - 0.1e2 / 0.27e2 * t2017 * t136 - 0.55e2 / 0.216e3 * t2020 * t136 + 0.5e1 / 0.3e1 * t972 * t362 + 0.55e2 / 0.24e2 * t975 * t362 + 0.1e2 / 0.3e1 * t978 * t381 + 0.55e2 / 0.12e2 * t981 * t381 + t139 * t2076 + 0.11e2 / 0.2e1 * t387 * t946 + t142 * t2076 + 0.6e1 * t391 * t946 + 0.17e2 / 0.8e1 * t332 * t887 + t75 * t2099 / 0.2e1 + 0.9e1 / 0.4e1 * t337 * t887 + t79 * t2099 / 0.2e1 + 0.5e1 / 0.2e1 * t342 * t887 + t92 * t2099 / 0.2e1 + 0.11e2 / 0.4e1 * t347 * t887 + t96 * t2120 / 0.2e1;
  t2155 = 0.5e1 / 0.2e1 * t365 * t926 + t116 * t2120 / 0.2e1 + 0.11e2 / 0.4e1 * t370 * t926 + t121 * t2120 / 0.2e1 + 0.3e1 * t376 * t926 + t125 * t2076 + 0.5e1 * t383 * t946 + t41 * t2099 / 0.2e1 + 0.85e2 / 0.96e2 * t959 * t329 + 0.9e1 / 0.8e1 * t962 * t329 + 0.5e1 / 0.3e1 * t965 * t329 + 0.55e2 / 0.24e2 * t969 * t329 - 0.7e1 / 0.6e1 * t1937 - 0.7e1 / 0.6e1 * t1939 - 0.8e1 / 0.3e1 * t1941 - 0.8e1 / 0.3e1 * t1943 - 0.9e1 / 0.2e1 * t1945 - 0.9e1 / 0.2e1 * t1947 - 0.2e2 / 0.3e1 * t1949 - 0.2e2 / 0.3e1 * t1951;
  tv3rho33 = t1981 + t2009 + t2123 + t2155;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2158 = t95 / t217;
  t2162 = 0.1e1 / t85 / t97;
  t2163 = t115 * t2162;
  t2166 = t119 * t99;
  t2167 = t2166 * t102;
  t2170 = t99 * t530 * t56;
  t2175 = t29 / t1029 / rho[0];
  t2178 = t74 * t1019;
  t2181 = t78 * t1024;
  t2185 = t407 * t185 * t57;
  t2194 = -0.35e2 / 0.72e2 * t2158 * t102 - 0.33e2 / 0.64e2 * t2163 * t102 - 0.13e2 / 0.24e2 * t2167 + t116 * t2170 / 0.8e1 - 0.51e2 / 0.256e3 * t2175 * t1033 - 0.13e2 / 0.64e2 * t2178 * t1033 - 0.5e1 / 0.24e2 * t2181 * t1033 + 0.11e2 / 0.48e2 * t1042 * t2185 + 0.5e1 / 0.12e2 * t1016 * t224 + 0.11e2 / 0.24e2 * t1020 * t224 + t1025 * t224 / 0.2e1;
  t2202 = 0.2e1 * t141 * t431;
  t2204 = t177 * t185 * t57;
  t2208 = t471 * t55 * t57;
  t2217 = t121 * t219;
  t2224 = 0.17e2 / 0.96e2 * t1031 * t2185 + 0.3e1 / 0.16e2 * t1036 * t2185 + 0.5e1 / 0.24e2 * t1039 * t2185 + t2202 - t419 * t2204 / 0.6e1 + 0.7e1 / 0.36e2 * t408 * t2208 + 0.7e1 / 0.36e2 * t413 * t2208 + 0.7e1 / 0.36e2 * t416 * t2208 + 0.7e1 / 0.36e2 * t419 * t2208 - 0.2e1 / 0.3e1 * t2217 * t224 + t1002 * t534 / 0.8e1 + 0.1e2 / 0.9e1 * t603 * t431;
  t2229 = t524 * t101 * t56;
  t2231 = t219 * t55;
  t2237 = 0.88e2 / 0.9e1 * t566;
  t2238 = 0.22e2 / 0.9e1 * t2229 - 0.8e1 / 0.3e1 * t2231 * t761 + t2170 / 0.2e1 + t1054 * t1603 / 0.2e1 - t2237;
  t2252 = t82 * t1321;
  t2259 = 0.55e2 / 0.36e2 * t608 * t431 + t142 * t2238 + 0.4e1 * t265 * t1058 + t125 * t2238 + 0.1e2 / 0.3e1 * t257 * t1058 + t139 * t2238 + 0.11e2 / 0.3e1 * t261 * t1058 + 0.11e2 / 0.18e2 * t121 * t2229 + t121 * t2170 / 0.8e1 - 0.121e3 / 0.576e3 * t2252 * t1033 + 0.11e2 / 0.18e2 * t96 * t2229 + t96 * t2170 / 0.8e1;
  t2263 = t43 * t488 * t57;
  t2272 = t96 * t219;
  t2277 = t116 * t219;
  t2288 = 0.11e2 / 0.18e2 * t116 * t2229 + t408 * t2263 / 0.16e2 + t413 * t2263 / 0.16e2 + t416 * t2263 / 0.16e2 + t419 * t2263 / 0.16e2 - 0.2e1 / 0.3e1 * t2272 * t224 + t996 * t534 / 0.8e1 - 0.2e1 / 0.3e1 * t2277 * t224 + t999 * t534 / 0.8e1 - t408 * t2204 / 0.6e1 - t413 * t2204 / 0.6e1 - t416 * t2204 / 0.6e1;
  tv3rho2sigma0 = t2194 + t2224 + t2259 + t2288;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2292 = t257 * t252;
  t2295 = 0.176e3 / 0.9e1 * t125 * t566;
  t2298 = t261 * t252;
  t2301 = 0.176e3 / 0.9e1 * t139 * t566;
  t2303 = 0.4e1 * t141 * t134;
  t2304 = t265 * t252;
  t2307 = 0.176e3 / 0.9e1 * t142 * t566;
  tv3rho2sigma1 = -0.2e2 / 0.9e1 * t603 * t134 + 0.16e3 / 0.9e1 * t2292 - t2295 - 0.55e2 / 0.18e2 * t608 * t134 + 0.176e3 / 0.9e1 * t2298 - t2301 - t2303 + 0.64e2 / 0.3e1 * t2304 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2308 = t119 * t106;
  t2309 = t2308 * t109;
  t2312 = t106 * t537 * t56;
  t2324 = 0.2e1 * t141 * t463;
  t2334 = t2312 / 0.2e1 + t1120 * t1632 / 0.2e1 - t2237;
  t2342 = t582 * t439;
  t2345 = t2309 / 0.8e1 + t96 * t2312 / 0.8e1 + 0.55e2 / 0.576e3 * t600 * t455 + t116 * t2312 / 0.8e1 + t121 * t2312 / 0.8e1 + 0.5e1 / 0.72e2 * t597 * t455 + t2324 + 0.55e2 / 0.36e2 * t608 * t463 + 0.1e2 / 0.9e1 * t603 * t463 + 0.1e2 / 0.3e1 * t257 * t1123 + t125 * t2334 + 0.11e2 / 0.3e1 * t261 * t1123 + t139 * t2334 + 0.4e1 * t265 * t1123 + t142 * t2334 + 0.85e2 / 0.2304e4 * t2342 * t442;
  t2346 = t586 * t439;
  t2349 = t590 * t439;
  t2352 = t594 * t439;
  t2357 = t239 * t106;
  t2362 = t245 * t106;
  t2370 = t61 * t501 * t57;
  t2385 = t234 * t106;
  t2388 = 0.3e1 / 0.64e2 * t2346 * t442 + 0.5e1 / 0.72e2 * t2349 * t442 + 0.55e2 / 0.576e3 * t2352 * t442 + t1105 * t541 / 0.8e1 + 0.11e2 / 0.24e2 * t2357 * t228 + t1110 * t541 / 0.8e1 + t2362 * t228 / 0.2e1 + t1115 * t541 / 0.8e1 + 0.17e2 / 0.96e2 * t1081 * t1085 + t440 * t2370 / 0.16e2 + 0.3e1 / 0.16e2 * t1088 * t1085 + t445 * t2370 / 0.16e2 + 0.5e1 / 0.24e2 * t1093 * t1085 + t448 * t2370 / 0.16e2 + 0.11e2 / 0.48e2 * t1098 * t1085 + t451 * t2370 / 0.16e2 + 0.5e1 / 0.12e2 * t2385 * t228;
  tv3rho2sigma2 = t2345 + t2388;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2390 = t407 * t313 * t57;
  t2413 = 0.5e1 / 0.48e2 * t1039 * t2390 + 0.11e2 / 0.96e2 * t1042 * t2390 + 0.5e1 / 0.24e2 * t1016 * t350 + 0.11e2 / 0.48e2 * t1020 * t350 + t1025 * t350 / 0.4e1 - t376 * t1046 / 0.3e1 - 0.5e1 / 0.18e2 * t365 * t1046 - 0.11e2 / 0.36e2 * t370 * t1046 + 0.17e2 / 0.192e3 * t1031 * t2390 + 0.3e1 / 0.32e2 * t1036 * t2390 + 0.5e1 / 0.3e1 * t383 * t1058;
  t2416 = t99 * t185;
  t2419 = t56 * t715;
  t2422 = -0.4e1 / 0.3e1 * t2231 * t1167 + t2416 * t1167 / 0.2e1 + t1054 * t2419 / 0.2e1 - t2237;
  t2437 = t177 * t313 * t57;
  t2446 = t125 * t2422 + 0.5e1 / 0.3e1 * t257 * t1170 + 0.11e2 / 0.6e1 * t387 * t1058 + t139 * t2422 + 0.11e2 / 0.6e1 * t261 * t1170 + 0.2e1 * t391 * t1058 + t142 * t2422 + 0.2e1 * t265 * t1170 - t416 * t2437 / 0.12e2 - 0.11e2 / 0.72e2 * t1148 * t1006 - t419 * t2437 / 0.12e2 - t2272 * t350 / 0.3e1;
  t2464 = t376 * t99;
  t2472 = t43 * t715 * t57;
  t2475 = -t2277 * t350 / 0.3e1 - t2217 * t350 / 0.3e1 - 0.17e2 / 0.144e3 * t1131 * t1006 - t408 * t2437 / 0.12e2 - t1138 * t1006 / 0.8e1 - t413 * t2437 / 0.12e2 - 0.5e1 / 0.36e2 * t1143 * t1006 + t999 * t765 / 0.8e1 + t2464 * t224 / 0.4e1 + t1002 * t762 / 0.8e1 + t1002 * t765 / 0.8e1 + t408 * t2472 / 0.16e2;
  t2488 = t365 * t99;
  t2495 = t370 * t99;
  t2502 = 0.3e1 / 0.32e2 * t1138 * t987 + t413 * t2472 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t987 + t416 * t2472 / 0.16e2 + 0.11e2 / 0.96e2 * t1148 * t987 + t419 * t2472 / 0.16e2 + 0.5e1 / 0.24e2 * t2488 * t224 + t996 * t762 / 0.8e1 + t996 * t765 / 0.8e1 + 0.11e2 / 0.48e2 * t2495 * t224 + t999 * t762 / 0.8e1 + 0.17e2 / 0.192e3 * t1131 * t987;
  tv3rho2sigma3 = t2413 + t2446 + t2475 + t2502;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2504 = t383 * t252;
  t2507 = t387 * t252;
  t2510 = t391 * t252;
  tv3rho2sigma4 = 0.8e2 / 0.9e1 * t2504 + 0.8e2 / 0.9e1 * t2292 - t2295 + 0.88e2 / 0.9e1 * t2507 + 0.88e2 / 0.9e1 * t2298 - t2301 + 0.32e2 / 0.3e1 * t2510 + 0.32e2 / 0.3e1 * t2304 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2513 = t121 * t355;
  t2523 = t61 * t728 * t57;
  t2537 = t439 * t192 * t57;
  t2540 = -t2513 * t228 / 0.3e1 + t1115 * t771 / 0.8e1 + t1115 * t774 / 0.8e1 + t2362 * t359 / 0.4e1 + t440 * t2523 / 0.16e2 + 0.17e2 / 0.192e3 * t1081 * t1185 + t445 * t2523 / 0.16e2 + 0.3e1 / 0.32e2 * t1088 * t1185 + t448 * t2523 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t1185 + 0.11e2 / 0.96e2 * t1245 * t2537;
  t2559 = t355 * t67;
  t2562 = t106 * t192;
  t2565 = t56 * t728;
  t2568 = -0.4e1 / 0.3e1 * t2559 * t770 + t2562 * t1249 / 0.2e1 + t1120 * t2565 / 0.2e1 - t2237;
  t2574 = -0.5e1 / 0.18e2 * t234 * t1224 - 0.11e2 / 0.36e2 * t239 * t1224 - t245 * t1224 / 0.3e1 + 0.5e1 / 0.24e2 * t1211 * t228 + 0.11e2 / 0.48e2 * t1215 * t228 + t1220 * t228 / 0.4e1 + 0.17e2 / 0.192e3 * t1234 * t2537 + 0.3e1 / 0.32e2 * t1239 * t2537 + 0.5e1 / 0.48e2 * t1242 * t2537 + t125 * t2568 + 0.5e1 / 0.3e1 * t257 * t1252 + 0.5e1 / 0.3e1 * t383 * t1123;
  t2587 = t318 * t192 * t57;
  t2600 = t139 * t2568 + 0.11e2 / 0.6e1 * t261 * t1252 + 0.11e2 / 0.6e1 * t387 * t1123 + t142 * t2568 + 0.2e1 * t265 * t1252 + 0.2e1 * t391 * t1123 - t440 * t2587 / 0.12e2 - 0.17e2 / 0.144e3 * t1081 * t1201 - t445 * t2587 / 0.12e2 - t1088 * t1201 / 0.8e1 - t448 * t2587 / 0.12e2 - 0.5e1 / 0.36e2 * t1093 * t1201;
  t2609 = t96 * t355;
  t2618 = t116 * t355;
  t2627 = -t451 * t2587 / 0.12e2 - 0.11e2 / 0.72e2 * t1098 * t1201 + t451 * t2523 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t1185 - t2609 * t228 / 0.3e1 + t1105 * t771 / 0.8e1 + t1105 * t774 / 0.8e1 + 0.5e1 / 0.24e2 * t2385 * t359 - t2618 * t228 / 0.3e1 + t1110 * t771 / 0.8e1 + t1110 * t774 / 0.8e1 + 0.11e2 / 0.48e2 * t2357 * t359;
  tv3rho2sigma5 = t2540 + t2574 + t2600 + t2627;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2634 = t43 * t865 * t57;
  t2651 = t969 * t407;
  t2654 = t959 * t407;
  t2657 = t962 * t407;
  t2660 = t965 * t407;
  t2667 = t1002 * t908 / 0.8e1 + 0.17e2 / 0.96e2 * t1131 * t1135 + t408 * t2634 / 0.16e2 + 0.3e1 / 0.16e2 * t1138 * t1135 + t413 * t2634 / 0.16e2 + 0.5e1 / 0.24e2 * t1143 * t1135 + t416 * t2634 / 0.16e2 + 0.11e2 / 0.48e2 * t1148 * t1135 + t419 * t2634 / 0.16e2 + 0.5e1 / 0.12e2 * t2488 * t350 + 0.55e2 / 0.576e3 * t2651 * t410 + 0.85e2 / 0.2304e4 * t2654 * t410 + 0.3e1 / 0.64e2 * t2657 * t410 + 0.5e1 / 0.72e2 * t2660 * t410 + t996 * t908 / 0.8e1 + 0.11e2 / 0.24e2 * t2495 * t350;
  t2674 = t99 * t904 * t56;
  t2692 = t56 * t865;
  t2695 = t2674 / 0.2e1 + t1054 * t2692 / 0.2e1 - t2237;
  t2703 = t999 * t908 / 0.8e1 + t2464 * t350 / 0.2e1 + t2167 / 0.8e1 + t96 * t2674 / 0.8e1 + 0.55e2 / 0.576e3 * t975 * t423 + t116 * t2674 / 0.8e1 + t121 * t2674 / 0.8e1 + 0.5e1 / 0.72e2 * t972 * t423 + t2202 + 0.1e2 / 0.9e1 * t978 * t431 + 0.55e2 / 0.36e2 * t981 * t431 + 0.1e2 / 0.3e1 * t383 * t1170 + t125 * t2695 + 0.11e2 / 0.3e1 * t387 * t1170 + t139 * t2695 + 0.4e1 * t391 * t1170 + t142 * t2695;
  tv3rho2sigma6 = t2667 + t2703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.2e2 / 0.9e1 * t978 * t134 + 0.16e3 / 0.9e1 * t2504 - t2295 - 0.55e2 / 0.18e2 * t981 * t134 + 0.176e3 / 0.9e1 * t2507 - t2301 - t2303 + 0.64e2 / 0.3e1 * t2510 - t2307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2712 = t95 / t353;
  t2716 = 0.1e1 / t89 / t104;
  t2717 = t115 * t2716;
  t2721 = t870 * t67 * t57;
  t2727 = t318 * t325 * t57;
  t2742 = -0.35e2 / 0.72e2 * t2712 * t109 - 0.33e2 / 0.64e2 * t2717 * t109 + 0.7e1 / 0.36e2 * t448 * t2721 + 0.7e1 / 0.36e2 * t451 * t2721 - t448 * t2727 / 0.6e1 - t451 * t2727 / 0.6e1 + 0.7e1 / 0.36e2 * t440 * t2721 + 0.7e1 / 0.36e2 * t445 * t2721 - t440 * t2727 / 0.6e1 - t445 * t2727 / 0.6e1 + t1115 * t923 / 0.8e1;
  t2744 = t61 * t883 * t57;
  t2765 = t106 * t919 * t56;
  t2770 = t29 / t1232 / rho[1];
  t2773 = t440 * t2744 / 0.16e2 + t445 * t2744 / 0.16e2 + t448 * t2744 / 0.16e2 + t451 * t2744 / 0.16e2 - 0.2e1 / 0.3e1 * t2609 * t359 + t1105 * t923 / 0.8e1 - 0.2e1 / 0.3e1 * t2618 * t359 + t1110 * t923 / 0.8e1 - 0.2e1 / 0.3e1 * t2513 * t359 - 0.13e2 / 0.24e2 * t2309 + t121 * t2765 / 0.8e1 - 0.51e2 / 0.256e3 * t2770 * t1236;
  t2775 = t74 * t1214;
  t2778 = t78 * t1219;
  t2781 = t82 * t1961;
  t2785 = t913 * t108 * t56;
  t2797 = t439 * t325 * t57;
  t2806 = -0.13e2 / 0.64e2 * t2775 * t1236 - 0.5e1 / 0.24e2 * t2778 * t1236 - 0.121e3 / 0.576e3 * t2781 * t1236 + 0.11e2 / 0.18e2 * t96 * t2785 + t96 * t2765 / 0.8e1 + 0.11e2 / 0.18e2 * t116 * t2785 + t116 * t2765 / 0.8e1 + 0.11e2 / 0.18e2 * t121 * t2785 + 0.17e2 / 0.96e2 * t1234 * t2797 + 0.3e1 / 0.16e2 * t1239 * t2797 + 0.5e1 / 0.24e2 * t1242 * t2797 + 0.11e2 / 0.48e2 * t1245 * t2797;
  t2821 = t56 * t883;
  t2824 = 0.22e2 / 0.9e1 * t2785 - 0.8e1 / 0.3e1 * t2559 * t1249 + t2765 / 0.2e1 + t1120 * t2821 / 0.2e1 - t2237;
  t2834 = 0.5e1 / 0.12e2 * t1211 * t359 + 0.11e2 / 0.24e2 * t1215 * t359 + t1220 * t359 / 0.2e1 + t2324 + 0.1e2 / 0.9e1 * t978 * t463 + 0.55e2 / 0.36e2 * t981 * t463 + t125 * t2824 + 0.1e2 / 0.3e1 * t383 * t1252 + t139 * t2824 + 0.11e2 / 0.3e1 * t387 * t1252 + t142 * t2824 + 0.4e1 * t391 * t1252;
  tv3rho2sigma8 = t2742 + t2773 + t2806 + t2834;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2837 = t1264 * t55 * t57;
  tv3rhosigma20 = -0.17e2 / 0.384e3 * t1031 * t2837 + t1265 * t1006 / 0.24e2 - t1265 * t987 / 0.32e2 - 0.3e1 / 0.64e2 * t1036 * t2837 + t1267 * t1006 / 0.24e2 - t1267 * t987 / 0.32e2 - 0.5e1 / 0.96e2 * t1039 * t2837 + t1269 * t1006 / 0.24e2 - t1269 * t987 / 0.32e2 - 0.11e2 / 0.192e3 * t1042 * t2837 + t1271 * t1006 / 0.24e2 - t1271 * t987 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2862 = t199 * t1275;
  t2867 = t204 * t1275;
  t2872 = t209 * t1275;
  t2877 = t214 * t1275;
  tv3rhosigma25 = -0.17e2 / 0.384e3 * t2862 * t442 - t1276 * t1085 / 0.32e2 - 0.3e1 / 0.64e2 * t2867 * t442 - t1278 * t1085 / 0.32e2 - 0.5e1 / 0.96e2 * t2872 * t442 - t1280 * t1085 / 0.32e2 - 0.11e2 / 0.192e3 * t2877 * t442 - t1282 * t1085 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2882 = t332 * t1264;
  t2887 = t337 * t1264;
  t2892 = t342 * t1264;
  t2897 = t347 * t1264;
  tv3rhosigma26 = -0.17e2 / 0.384e3 * t2882 * t410 - t1265 * t1135 / 0.32e2 - 0.3e1 / 0.64e2 * t2887 * t410 - t1267 * t1135 / 0.32e2 - 0.5e1 / 0.96e2 * t2892 * t410 - t1269 * t1135 / 0.32e2 - 0.11e2 / 0.192e3 * t2897 * t410 - t1271 * t1135 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2903 = t1275 * t67 * t57;
  tv3rhosigma211 = -0.17e2 / 0.384e3 * t1234 * t2903 + t1276 * t1201 / 0.24e2 - t1276 * t1185 / 0.32e2 - 0.3e1 / 0.64e2 * t1239 * t2903 + t1278 * t1201 / 0.24e2 - t1278 * t1185 / 0.32e2 - 0.5e1 / 0.96e2 * t1242 * t2903 + t1280 * t1201 / 0.24e2 - t1280 * t1185 / 0.32e2 - 0.11e2 / 0.192e3 * t1245 * t2903 + t1282 * t1201 / 0.24e2 - t1282 * t1185 / 0.32e2;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2928 = sigma[0] * sigma[0];
  t2930 = 0.1e1 / t42 / t2928;
  t2931 = t41 * t2930;
  t2933 = t75 * t2930;
  t2935 = t79 * t2930;
  t2937 = t92 * t2930;
  tv3sigma30 = 0.3e1 / 0.64e2 * t2931 * t410 + 0.3e1 / 0.64e2 * t2933 * t410 + 0.3e1 / 0.64e2 * t2935 * t410 + 0.3e1 / 0.64e2 * t2937 * t410;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2940 = sigma[2] * sigma[2];
  t2942 = 0.1e1 / t60 / t2940;
  t2943 = t41 * t2942;
  t2945 = t75 * t2942;
  t2947 = t79 * t2942;
  t2949 = t92 * t2942;
  tv3sigma39 = 0.3e1 / 0.64e2 * t2943 * t442 + 0.3e1 / 0.64e2 * t2945 * t442 + 0.3e1 / 0.64e2 * t2947 * t442 + 0.3e1 / 0.64e2 * t2949 * t442;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2952 = t289 * t1290;
  t2955 = 0.1e1 / t16 / t97;
  t2959 = t1322 * t181;
  t2961 = t1322 * t269;
  t2963 = t631 * t482;
  t2965 = t631 * t649;
  t2970 = t1334 * t181;
  t2972 = t1334 * t269;
  t2974 = t638 * t482;
  t2976 = t638 * t649;
  t2978 = t45 * t1286;
  t2979 = t145 * t2978;
  t2980 = 0.192e3 * t2979;
  t2981 = 0.192e3 * t2952 + 0.9e1 / 0.16e2 * t153 * t2955 * t148 - 0.3e1 * t2959 + 0.3e1 * t2961 - 0.36e2 * t2963 + 0.27e2 * t2965 + 0.4e2 / 0.81e2 * t156 * t177 * t148 - 0.8e2 / 0.27e2 * t2970 + 0.8e2 / 0.27e2 * t2972 - 0.16e3 / 0.3e1 * t2974 + 0.4e2 * t2976 - t2980;
  t2982 = t564 * t130;
  t2983 = 0.1e1 / t2982;
  t2984 = t146 * t2983;
  t2986 = 0.12e3 * t145 * t2984;
  t2987 = t151 * t2978;
  t2988 = 0.192e3 * t2987;
  t2990 = 0.12e3 * t151 * t2984;
  t2991 = t154 * t2978;
  t2992 = 0.192e3 * t2991;
  t2994 = 0.12e3 * t154 * t2984;
  t2995 = t157 * t2978;
  t2996 = 0.192e3 * t2995;
  t2998 = 0.12e3 * t157 * t2984;
  t3002 = t1299 * t181;
  t3004 = t1299 * t269;
  t3006 = t616 * t482;
  t3008 = t616 * t649;
  t3010 = t2986 - t2988 + t2990 - t2992 + t2994 - t2996 + t2998 + 0.385e3 / 0.1296e4 * t144 * t2162 * t148 - 0.35e2 / 0.27e2 * t3002 + 0.35e2 / 0.27e2 * t3004 - 0.28e2 / 0.3e1 * t3006 + 0.7e1 * t3008;
  t3012 = t286 * t1290;
  t3014 = t286 * t1287;
  t3016 = t289 * t1287;
  t3018 = t292 * t1290;
  t3020 = t292 * t1287;
  t3022 = t295 * t1290;
  t3024 = t295 * t1287;
  t3029 = t1310 * t181;
  t3031 = t1310 * t269;
  t3033 = t624 * t482;
  t3035 = t624 * t649;
  t3037 = 0.168e3 * t3012 - 0.112e3 * t3014 - 0.128e3 * t3016 + 0.216e3 * t3018 - 0.144e3 * t3020 + 0.24e3 * t3022 - 0.16e3 * t3024 + 0.4e2 / 0.81e2 * t150 * t99 * t148 - 0.64e2 / 0.27e2 * t3029 + 0.64e2 / 0.27e2 * t3031 - 0.64e2 / 0.3e1 * t3033 + 0.16e2 * t3035;
  t3046 = pow(rho[0], -0.29166666666666666667e1);
  t3049 = t119 * t544;
  t3051 = t141 * t569;
  t3053 = t151 * t648;
  t3054 = 0.72e2 * t3053;
  t3067 = 0.1e1 / t2 / t97;
  t3074 = 0.385e3 / 0.1296e4 * t1 * t2162 + 0.4e2 / 0.81e2 * t8 * t99 + 0.9e1 / 0.16e2 * t15 * t2955 + 0.4e2 / 0.81e2 * t22 * t177 + 0.15861304012345679006e0 * t159 * t3046 + 0.6e1 * t3049 + 0.12e2 * t3051 + t3054 + 0.11305e5 / 0.41472e5 * t29 / t580 / t97 * t71 + 0.9e1 / 0.32e2 * t74 * t2955 * t71 + 0.2e2 / 0.81e2 * t78 * t177 * t71 + 0.385e3 / 0.2592e4 * t82 * t3067 * t71 + 0.2e2 / 0.81e2 * t95 * t177 * t112;
  t3086 = t145 * t648;
  t3087 = 0.72e2 * t3086;
  t3092 = t154 * t648;
  t3093 = 0.72e2 * t3092;
  t3094 = t157 * t648;
  t3095 = 0.72e2 * t3094;
  t3104 = 0.385e3 / 0.2592e4 * t115 * t3067 * t112 + 0.4e2 / 0.81e2 * t124 * t177 * t136 + 0.385e3 / 0.1296e4 * t138 * t3067 * t136 + t3087 + 0.85e2 / 0.48e2 * t582 * t505 + 0.9e1 / 0.4e1 * t586 * t505 + t3093 + t3095 + 0.2e2 / 0.3e1 * t603 * t569 + 0.55e2 / 0.6e1 * t608 * t569 + 0.1e2 / 0.3e1 * t590 * t505 + 0.55e2 / 0.12e2 * t594 * t505;
  t3109 = t616 * t147;
  t3111 = t286 * t268;
  t3113 = t624 * t147;
  t3115 = t289 * t268;
  t3117 = t631 * t147;
  t3119 = t292 * t268;
  t3121 = t638 * t147;
  t3123 = t295 * t268;
  t3131 = 0.1e2 / 0.3e1 * t597 * t544 + 0.55e2 / 0.12e2 * t600 * t544 + 0.7e1 / 0.3e1 * t3109 - 0.56e2 * t3111 + 0.16e2 / 0.3e1 * t3113 - 0.64e2 * t3115 + 0.9e1 * t3117 - 0.72e2 * t3119 + 0.4e2 / 0.3e1 * t3121 - 0.8e2 * t3123 - 0.2e2 / 0.27e2 * t1510 * t196 - 0.55e2 / 0.108e3 * t1514 * t196 - 0.2e2 / 0.27e2 * t1517 * t231;
  t3143 = sigma[0] / t23 / t522 / t97 * t102;
  t3145 = t1429 * t224;
  t3147 = t525 * t531;
  t3149 = t525 * t534;
  t3151 = t220 * t1438;
  t3153 = t220 * t1441;
  t3155 = t488 * t488;
  t3157 = t100 * t3155 * t56;
  t3160 = t100 * t761 * t1397;
  t3161 = t49 * t49;
  t3163 = 0.1e1 / t477 / t3161;
  t3164 = t479 * t479;
  t3170 = t484 * t484;
  t3176 = -0.24e2 * t648 + 0.24e2 * t2978;
  t3180 = my_piecewise3(t50, 0, 0.4e2 / 0.81e2 * t3163 * t3164 - 0.16e2 / 0.9e1 * t1385 * t479 * t484 + 0.4e1 / 0.3e1 * t478 * t3170 + 0.16e2 / 0.9e1 * t1389 * t1393 + 0.4e1 / 0.3e1 * t53 * t3176);
  t3182 = t100 * t223 * t3180;
  t3184 = t501 * t501;
  t3186 = t107 * t3184 * t56;
  t3189 = t107 * t770 * t1413;
  t3190 = t63 * t63;
  t3192 = 0.1e1 / t492 / t3190;
  t3193 = t494 * t494;
  t3199 = t497 * t497;
  t3208 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t3192 * t3193 - 0.16e2 / 0.9e1 * t1402 * t494 * t497 + 0.4e1 / 0.3e1 * t493 * t3199 + 0.16e2 / 0.9e1 * t1406 * t1409 - 0.4e1 / 0.3e1 * t65 * t3176);
  t3210 = t107 * t227 * t3208;
  t3212 = 0.2618e4 / 0.81e2 * t3143 - 0.1232e4 / 0.27e2 * t3145 + 0.44e2 / 0.3e1 * t3147 + 0.44e2 / 0.3e1 * t3149 - 0.8e1 * t3151 - 0.8e1 / 0.3e1 * t3153 + 0.3e1 / 0.4e1 * t3157 + t3160 + t3182 / 0.4e1 + 0.3e1 / 0.4e1 * t3186 + t3189 + t3210 / 0.4e1;
  t3232 = 0.20944e5 / 0.81e2 * t129 / t132 / t2982;
  t3233 = 0.5236e4 / 0.81e2 * t3143 - 0.2464e4 / 0.27e2 * t3145 + 0.88e2 / 0.3e1 * t3147 + 0.88e2 / 0.3e1 * t3149 - 0.16e2 * t3151 - 0.16e2 / 0.3e1 * t3153 + 0.3e1 / 0.2e1 * t3157 + 0.2e1 * t3160 + t3182 / 0.2e1 + 0.3e1 / 0.2e1 * t3186 + 0.2e1 * t3189 + t3210 / 0.2e1 - t3232;
  t3260 = 0.91e3 / 0.81e2 * t42 / t9 / t1426 * t58 - 0.28e3 / 0.27e2 * t1378 * t186 + 0.14e2 / 0.3e1 * t472 * t489 - 0.4e1 / 0.3e1 * t178 * t1398 + t44 * t3180 * t57 / 0.4e1 + t62 * t3208 * t57 / 0.4e1;
  t3263 = -0.55e2 / 0.108e3 * t1520 * t231 - 0.4e2 / 0.27e2 * t1523 * t255 - 0.55e2 / 0.54e2 * t1526 * t255 + t121 * t3212 / 0.2e1 + 0.4e1 * t245 * t1450 + t125 * t3233 + 0.2e2 / 0.3e1 * t257 * t1475 + t139 * t3233 + 0.22e2 / 0.3e1 * t261 * t1475 + t142 * t3233 + 0.8e1 * t265 * t1475 + t41 * t3260 / 0.2e1;
  t3290 = 0.17e2 / 0.6e1 * t199 * t1417 + t75 * t3260 / 0.2e1 + 0.3e1 * t204 * t1417 - 0.595e3 / 0.864e3 * t1504 * t196 - 0.3e1 / 0.4e1 * t1507 * t196 + t79 * t3260 / 0.2e1 + 0.1e2 / 0.3e1 * t209 * t1417 + t92 * t3260 / 0.2e1 + 0.11e2 / 0.3e1 * t214 * t1417 + t96 * t3212 / 0.2e1 + 0.1e2 / 0.3e1 * t234 * t1450 + t116 * t3212 / 0.2e1 + 0.11e2 / 0.3e1 * t239 * t1450;
  tv4rho40 = t2981 + t3010 + t3037 + t3074 + t3104 + t3131 + t3263 + t3290;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3293 = t394 * t1287;
  t3295 = t397 * t1290;
  t3296 = 0.48e2 * t3295;
  t3297 = t397 * t1287;
  t3299 = t400 * t1290;
  t3300 = 0.54e2 * t3299;
  t3301 = t400 * t1287;
  t3303 = t403 * t1290;
  t3304 = 0.6e2 * t3303;
  t3305 = t403 * t1287;
  t3307 = t394 * t1290;
  t3308 = 0.42e2 * t3307;
  t3309 = 0.48e2 * t2952;
  t3313 = -0.28e2 * t3293 + t3296 - 0.32e2 * t3297 + t3300 - 0.36e2 * t3301 + t3304 - 0.4e2 * t3305 + t3308 + t3309 + 0.3e1 / 0.4e1 * t2959 + 0.3e1 / 0.4e1 * t2961 + 0.27e2 / 0.2e1 * t2965;
  t3317 = 0.96e2 * t2979;
  t3318 = 0.96e2 * t2987;
  t3319 = 0.96e2 * t2991;
  t3320 = 0.96e2 * t2995;
  t3322 = 0.2e2 / 0.27e2 * t2970 + 0.2e2 / 0.27e2 * t2972 + 0.2e2 * t2976 - t3317 + t2986 - t3318 + t2990 - t3319 + t2994 - t3320 + t2998 + 0.35e2 / 0.108e3 * t3002;
  t3326 = 0.42e2 * t3012;
  t3329 = 0.54e2 * t3018;
  t3331 = 0.6e2 * t3022;
  t3336 = 0.35e2 / 0.108e3 * t3004 + 0.7e1 / 0.2e1 * t3008 + t3326 - 0.84e2 * t3014 - 0.96e2 * t3016 + t3329 - 0.108e3 * t3020 + t3331 - 0.12e3 * t3024 + 0.16e2 / 0.27e2 * t3029 + 0.16e2 / 0.27e2 * t3031 + 0.8e1 * t3035;
  t3338 = 0.3e1 * t119 * t777;
  t3340 = 0.6e1 * t141 * t801;
  t3342 = 0.14e2 * t3111;
  t3344 = 0.16e2 * t3115;
  t3346 = 0.18e2 * t3119;
  t3348 = 0.2e2 * t3123;
  t3351 = t220 * t1604;
  t3353 = t220 * t1607;
  t3355 = t220 * t1625;
  t3357 = t1397 * t56;
  t3359 = t100 * t3357 * t313;
  t3362 = t100 * t1603 * t715;
  t3365 = t100 * t761 * t1624;
  t3391 = 0.32e2 * t711 * t1286;
  t3393 = my_piecewise3(t50, 0, 0.4e2 / 0.81e2 * t3163 * t310 * t1386 - 0.16e2 / 0.9e1 * t1385 * t45 * t268 * t479 - 0.8e1 / 0.9e1 * t1610 * t182 * t484 + 0.8e1 / 0.3e1 * t478 * t268 * t182 - 0.8e1 * t1613 * t648 * t182 + 0.8e1 / 0.3e1 * t1613 * t268 * t484 + 0.4e1 / 0.9e1 * t708 * t1393 - 0.16e2 * t53 * t648 + t3391);
  t3395 = t100 * t223 * t3393;
  t3397 = t356 * t1444;
  t3399 = t356 * t1447;
  t3401 = t1413 * t56;
  t3403 = t107 * t3401 * t325;
  t3406 = t107 * t1632 * t728;
  t3409 = t107 * t770 * t1653;
  t3435 = 0.32e2 * t724 * t1286;
  t3437 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t3192 * t322 * t1403 + 0.16e2 / 0.9e1 * t1402 * t45 * t268 * t494 - 0.8e1 / 0.9e1 * t1639 * t189 * t497 - 0.8e1 / 0.3e1 * t493 * t268 * t189 + 0.8e1 * t1642 * t648 * t189 - 0.8e1 / 0.3e1 * t1642 * t268 * t497 + 0.4e1 / 0.9e1 * t721 * t1409 + 0.16e2 * t65 * t648 - t3435);
  t3439 = t107 * t227 * t3437;
  t3441 = t525 * t762;
  t3443 = t525 * t765;
  t3445 = t1429 * t350;
  t3447 = -0.4e1 * t3351 - 0.8e1 * t3353 - 0.4e1 * t3355 + t3359 / 0.2e1 + 0.3e1 / 0.2e1 * t3362 + 0.3e1 / 0.2e1 * t3365 + t3395 / 0.2e1 - 0.4e1 * t3397 - 0.4e1 / 0.3e1 * t3399 + t3403 / 0.2e1 + 0.3e1 / 0.2e1 * t3406 + 0.3e1 / 0.2e1 * t3409 + t3439 / 0.2e1 + 0.44e2 / 0.3e1 * t3441 + 0.44e2 / 0.3e1 * t3443 - 0.616e3 / 0.27e2 * t3445 - t3232;
  t3449 = t3338 + t3340 - 0.7e1 / 0.6e1 * t3109 + t3342 - 0.8e1 / 0.3e1 * t3113 + t3344 - 0.9e1 / 0.2e1 * t3117 + t3346 - 0.2e2 / 0.3e1 * t3121 + t3348 + 0.11e2 / 0.6e1 * t387 * t1475 + t142 * t3447;
  t3465 = -0.7e2 / 0.27e2 * t1378 * t314 + 0.7e1 / 0.3e1 * t472 * t716 - t178 * t1700 + t44 * t3393 * t57 / 0.4e1 - t319 * t1414 / 0.3e1 + t62 * t3437 * t57 / 0.4e1;
  t3490 = t41 * t3465 / 0.2e1 + 0.17e2 / 0.8e1 * t199 * t1708 + 0.17e2 / 0.24e2 * t332 * t1417 + t75 * t3465 / 0.2e1 + 0.9e1 / 0.4e1 * t204 * t1708 + 0.3e1 / 0.4e1 * t337 * t1417 + t79 * t3465 / 0.2e1 + 0.5e1 / 0.2e1 * t209 * t1708 + 0.5e1 / 0.6e1 * t342 * t1417 + t92 * t3465 / 0.2e1 + 0.11e2 / 0.4e1 * t214 * t1708 + 0.11e2 / 0.12e2 * t347 * t1417;
  t3507 = -0.2e1 * t3351 - 0.4e1 * t3353 - 0.2e1 * t3355 + t3359 / 0.4e1 + 0.3e1 / 0.4e1 * t3362 + 0.3e1 / 0.4e1 * t3365 + t3395 / 0.4e1 - 0.2e1 * t3397 - 0.2e1 / 0.3e1 * t3399 + t3403 / 0.4e1 + 0.3e1 / 0.4e1 * t3406 + 0.3e1 / 0.4e1 * t3409 + t3439 / 0.4e1 + 0.22e2 / 0.3e1 * t3441 + 0.22e2 / 0.3e1 * t3443 - 0.308e3 / 0.27e2 * t3445;
  t3530 = t96 * t3507 / 0.2e1 + 0.5e1 / 0.2e1 * t234 * t1657 + 0.5e1 / 0.6e1 * t365 * t1450 + t116 * t3507 / 0.2e1 + 0.11e2 / 0.4e1 * t239 * t1657 + 0.11e2 / 0.12e2 * t370 * t1450 + t121 * t3507 / 0.2e1 + 0.3e1 * t245 * t1657 + t376 * t1450 + t125 * t3447 + 0.5e1 * t257 * t1684 + 0.5e1 / 0.3e1 * t383 * t1475;
  t3555 = t139 * t3447 + 0.11e2 / 0.2e1 * t261 * t1684 + 0.6e1 * t265 * t1684 + 0.2e1 * t391 * t1475 - 0.3e1 / 0.16e2 * t1507 * t329 - 0.5e1 / 0.27e2 * t1510 * t329 - 0.55e2 / 0.432e3 * t1514 * t329 - 0.5e1 / 0.27e2 * t1517 * t362 - 0.55e2 / 0.432e3 * t1520 * t362 - 0.1e2 / 0.27e2 * t1523 * t381 - 0.55e2 / 0.216e3 * t1526 * t381 - 0.595e3 / 0.3456e4 * t1504 * t329;
  t3564 = t394 * t268;
  t3565 = 0.14e2 * t3564;
  t3574 = t397 * t268;
  t3575 = 0.16e2 * t3574;
  t3576 = t400 * t268;
  t3577 = 0.18e2 * t3576;
  t3578 = t403 * t268;
  t3579 = 0.2e2 * t3578;
  t3580 = 0.85e2 / 0.96e2 * t582 * t732 + 0.9e1 / 0.8e1 * t586 * t732 + 0.5e1 / 0.3e1 * t590 * t732 + 0.55e2 / 0.24e2 * t594 * t732 - t3565 + 0.5e1 / 0.3e1 * t597 * t777 + 0.55e2 / 0.24e2 * t600 * t777 + 0.1e2 / 0.3e1 * t603 * t801 + 0.55e2 / 0.12e2 * t608 * t801 - t3575 - t3577 - t3579;
  tv4rho41 = t3313 + t3322 + t3336 + t3449 + t3490 + t3530 + t3555 + t3580;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3583 = t837 * t649;
  t3585 = t841 * t482;
  t3587 = t841 * t649;
  t3589 = t829 * t482;
  t3591 = t829 * t649;
  t3593 = t833 * t482;
  t3595 = t833 * t649;
  t3597 = t837 * t482;
  t3604 = 0.9e1 / 0.2e1 * t3583 - 0.8e2 / 0.9e1 * t3585 + 0.2e2 / 0.3e1 * t3587 - 0.14e2 / 0.9e1 * t3589 + 0.7e1 / 0.6e1 * t3591 - 0.32e2 / 0.9e1 * t3593 + 0.8e1 / 0.3e1 * t3595 - 0.6e1 * t3597 - 0.56e2 * t3293 + 0.32e2 * t3295 - 0.64e2 * t3297 + 0.36e2 * t3299 - 0.72e2 * t3301;
  t3614 = 0.4e2 * t3303 - 0.8e2 * t3305 + 0.28e2 * t3307 - 0.32e2 * t2952 + 0.6e1 * t2963 + 0.9e1 / 0.2e1 * t2965 + 0.8e2 / 0.9e1 * t2974 + 0.2e2 / 0.3e1 * t2976 + t2986 + t2990 + t2994 + t2998 + 0.14e2 / 0.9e1 * t3006;
  t3630 = t220 * t1861;
  t3632 = t715 * t715;
  t3634 = t100 * t3632 * t56;
  t3636 = t100 * t1167 * t1624;
  t3637 = t220 * t1866;
  t3639 = t220 * t1869;
  t3642 = t100 * t1603 * t865;
  t3645 = t100 * t761 * t1816;
  t3671 = my_piecewise3(t50, 0, 0.4e2 / 0.81e2 * t3163 * t857 * t479 - 0.64e2 / 0.27e2 * t1610 * t182 * t45 * t268 - 0.8e1 / 0.27e2 * t1802 * t484 + 0.32e2 / 0.9e1 * t478 * t146 * t2983 + 0.16e2 / 0.9e1 * t708 * t268 - 0.16e2 / 0.3e1 * t708 * t1290 - 0.8e1 / 0.27e2 * t1385 * t861 * t479 + 0.8e1 / 0.9e1 * t478 * t1812 * t182 + 0.4e1 / 0.9e1 * t1807 * t484 + t3391);
  t3673 = t100 * t223 * t3671;
  t3675 = t914 * t538;
  t3677 = t914 * t541;
  t3680 = t356 * t1633;
  t3682 = t356 * t1636;
  t3684 = t356 * t1654;
  t3686 = t728 * t728;
  t3688 = t107 * t3686 * t56;
  t3690 = t107 * t1249 * t1653;
  t3692 = t107 * t1632 * t883;
  t3695 = t107 * t770 * t1836;
  t3721 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t3192 * t876 * t494 + 0.64e2 / 0.27e2 * t1639 * t189 * t45 * t268 - 0.8e1 / 0.27e2 * t1824 * t497 + 0.32e2 / 0.9e1 * t493 * t146 * t2983 - 0.16e2 / 0.9e1 * t721 * t268 + 0.16e2 / 0.3e1 * t721 * t1290 - 0.8e1 / 0.27e2 * t1402 * t879 * t494 + 0.8e1 / 0.9e1 * t493 * t1832 * t189 + 0.4e1 / 0.9e1 * t1829 * t497 - t3435);
  t3723 = t107 * t227 * t3721;
  t3725 = t525 * t905;
  t3727 = t525 * t908;
  t3729 = -0.8e1 / 0.3e1 * t3680 - 0.16e2 / 0.3e1 * t3682 - 0.8e1 / 0.3e1 * t3684 + t3688 + t3690 + t3692 / 0.2e1 + t3695 + t3723 / 0.2e1 + 0.44e2 / 0.9e1 * t3725 + 0.44e2 / 0.9e1 * t3727 - t3232;
  t3730 = -0.16e2 / 0.3e1 * t3630 + t3634 + t3636 - 0.8e1 / 0.3e1 * t3637 - 0.8e1 / 0.3e1 * t3639 + t3642 / 0.2e1 + t3645 + t3673 / 0.2e1 + 0.44e2 / 0.9e1 * t3675 + 0.44e2 / 0.9e1 * t3677 + t3729;
  t3732 = 0.7e1 / 0.6e1 * t3008 - 0.28e2 * t3012 - 0.56e2 * t3014 - 0.64e2 * t3016 - 0.36e2 * t3018 - 0.72e2 * t3020 - 0.4e2 * t3022 - 0.8e2 * t3024 + 0.32e2 / 0.9e1 * t3033 + 0.8e1 / 0.3e1 * t3035 + 0.11e2 / 0.3e1 * t261 * t1915 + 0.11e2 / 0.3e1 * t387 * t1684 + t142 * t3730;
  t3751 = 0.7e1 / 0.9e1 * t472 * t866 - 0.2e1 / 0.3e1 * t178 * t1817 + t44 * t3671 * t57 / 0.4e1 + 0.7e1 / 0.9e1 * t871 * t502 - 0.2e1 / 0.3e1 * t319 * t1705 + t62 * t3721 * t57 / 0.4e1;
  t3794 = -0.8e1 / 0.3e1 * t3630 + t3634 / 0.2e1 + t3636 / 0.2e1 - 0.4e1 / 0.3e1 * t3637 - 0.4e1 / 0.3e1 * t3639 + t3642 / 0.4e1 + t3645 / 0.2e1 + t3673 / 0.4e1 + 0.22e2 / 0.9e1 * t3675 + 0.22e2 / 0.9e1 * t3677 - 0.4e1 / 0.3e1 * t3680 - 0.8e1 / 0.3e1 * t3682 - 0.4e1 / 0.3e1 * t3684 + t3688 / 0.2e1 + t3690 / 0.2e1 + t3692 / 0.4e1 + t3695 / 0.2e1 + t3723 / 0.4e1 + 0.22e2 / 0.9e1 * t3725 + 0.22e2 / 0.9e1 * t3727;
  t3797 = 0.4e1 * t265 * t1915 + 0.4e1 * t391 * t1684 + t41 * t3751 / 0.2e1 + 0.17e2 / 0.12e2 * t199 * t1840 + 0.17e2 / 0.12e2 * t332 * t1708 + 0.3e1 / 0.2e1 * t204 * t1840 + 0.3e1 / 0.2e1 * t337 * t1708 + t79 * t3751 / 0.2e1 + 0.5e1 / 0.3e1 * t209 * t1840 + 0.5e1 / 0.3e1 * t342 * t1708 + t92 * t3751 / 0.2e1 + 0.11e2 / 0.6e1 * t214 * t1840 + 0.11e2 / 0.6e1 * t347 * t1708 + t96 * t3794 / 0.2e1;
  t3826 = 0.5e1 / 0.3e1 * t234 * t1887 + 0.5e1 / 0.3e1 * t365 * t1657 + t116 * t3794 / 0.2e1 + 0.11e2 / 0.6e1 * t239 * t1887 + 0.11e2 / 0.6e1 * t370 * t1657 + t121 * t3794 / 0.2e1 + 0.2e1 * t245 * t1887 + 0.85e2 / 0.288e3 * t959 * t505 + 0.3e1 / 0.8e1 * t962 * t505 + 0.5e1 / 0.9e1 * t965 * t505 + 0.55e2 / 0.72e2 * t969 * t505 + 0.5e1 / 0.9e1 * t972 * t544 + 0.55e2 / 0.72e2 * t975 * t544;
  t3834 = t141 * t946;
  t3836 = t119 * t926;
  t3843 = 0.1e2 / 0.9e1 * t978 * t569 + 0.55e2 / 0.36e2 * t981 * t569 + t75 * t3751 / 0.2e1 + t3049 + 0.2e1 * t3051 + 0.2e1 * t3834 + t3836 - 0.24e2 * t3053 - 0.24e2 * t3086 - 0.24e2 * t3092 - 0.24e2 * t3094 + 0.7e1 / 0.18e2 * t3109 + 0.28e2 / 0.3e1 * t3111;
  t3861 = 0.8e1 / 0.9e1 * t3113 + 0.32e2 / 0.3e1 * t3115 + 0.3e1 / 0.2e1 * t3117 + 0.12e2 * t3119 + 0.2e2 / 0.9e1 * t3121 + 0.4e2 / 0.3e1 * t3123 + 0.28e2 / 0.3e1 * t3564 + 0.32e2 / 0.3e1 * t3574 + 0.12e2 * t3576 + 0.4e2 / 0.3e1 * t3578 + 0.55e2 / 0.72e2 * t600 * t926 + 0.1e2 / 0.9e1 * t603 * t946 + 0.55e2 / 0.36e2 * t608 * t946;
  t3872 = t829 * t147;
  t3874 = t833 * t147;
  t3876 = t837 * t147;
  t3878 = t841 * t147;
  t3888 = 0.85e2 / 0.288e3 * t582 * t887 + 0.3e1 / 0.8e1 * t586 * t887 + 0.5e1 / 0.9e1 * t590 * t887 + 0.55e2 / 0.72e2 * t594 * t887 + 0.5e1 / 0.9e1 * t597 * t926 + 0.7e1 / 0.18e2 * t3872 + 0.8e1 / 0.9e1 * t3874 + 0.3e1 / 0.2e1 * t3876 + 0.2e2 / 0.9e1 * t3878 + 0.2e1 * t376 * t1657 + t125 * t3730 + 0.1e2 / 0.3e1 * t257 * t1915 + 0.1e2 / 0.3e1 * t383 * t1684 + t139 * t3730;
  tv4rho42 = t3604 + t3614 + t3732 + t3797 + t3826 + t3843 + t3861 + t3888;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3891 = t1955 * t181;
  t3893 = t1955 * t269;
  t3895 = t1958 * t181;
  t3897 = t1958 * t269;
  t3899 = t1962 * t181;
  t3901 = t1962 * t269;
  t3903 = t1965 * t181;
  t3905 = t1965 * t269;
  t3911 = -0.35e2 / 0.108e3 * t3891 + 0.35e2 / 0.108e3 * t3893 - 0.16e2 / 0.27e2 * t3895 + 0.16e2 / 0.27e2 * t3897 - 0.3e1 / 0.4e1 * t3899 + 0.3e1 / 0.4e1 * t3901 - 0.2e2 / 0.27e2 * t3903 + 0.2e2 / 0.27e2 * t3905 + 0.27e2 / 0.2e1 * t3583 + 0.2e2 * t3587 + 0.7e1 / 0.2e1 * t3591 + 0.8e1 * t3595;
  t3916 = -0.84e2 * t3293 - t3296 - 0.96e2 * t3297 - t3300 - 0.108e3 * t3301 - t3304 - 0.12e3 * t3305 - t3308 - t3309 + t3317 + t2986 + t3318;
  t3922 = t2990 + t3319 + t2994 + t3320 + t2998 - t3326 - 0.28e2 * t3014 - 0.32e2 * t3016 - t3329 - 0.36e2 * t3020 - t3331 - 0.4e2 * t3024;
  t3945 = 0.12e2 * t648 + 0.24e2 * t2978;
  t3949 = my_piecewise3(t50, 0, 0.4e2 / 0.81e2 * t3163 * t2034 * t182 - 0.16e2 / 0.9e1 * t1802 * t482 - 0.8e1 / 0.9e1 * t1610 * t861 * t182 + 0.8e1 / 0.3e1 * t1613 * t268 * t861 + 0.4e1 / 0.3e1 * t708 * t1812 + 0.4e1 / 0.9e1 * t478 * t2040 * t182 + 0.4e1 / 0.3e1 * t53 * t3945);
  t3978 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t3192 * t2063 * t189 + 0.16e2 / 0.9e1 * t1824 * t482 - 0.8e1 / 0.9e1 * t1639 * t879 * t189 - 0.8e1 / 0.3e1 * t1642 * t268 * t879 + 0.4e1 / 0.3e1 * t721 * t1832 + 0.4e1 / 0.9e1 * t493 * t2068 * t189 - 0.4e1 / 0.3e1 * t65 * t3945);
  t3982 = -t178 * t2085 / 0.3e1 + t44 * t3949 * t57 / 0.4e1 - 0.7e2 / 0.27e2 * t2090 * t193 + 0.7e1 / 0.3e1 * t871 * t729 - t319 * t1837 + t62 * t3978 * t57 / 0.4e1;
  t3999 = t220 * t2031;
  t4002 = t100 * t2419 * t865;
  t4005 = t100 * t1167 * t1816;
  t4007 = t220 * t2045;
  t4010 = t100 * t761 * t2044;
  t4013 = t100 * t223 * t3949;
  t4015 = t2051 * t228;
  t4017 = t914 * t771;
  t4019 = t914 * t774;
  t4021 = t356 * t1878;
  t4023 = t356 * t1881;
  t4025 = t356 * t1884;
  t4028 = t107 * t2565 * t883;
  t4031 = t107 * t1249 * t1836;
  t4034 = t107 * t770 * t2072;
  t4037 = t107 * t227 * t3978;
  t4039 = -0.4e1 * t3999 + 0.3e1 / 0.2e1 * t4002 + 0.3e1 / 0.2e1 * t4005 - 0.4e1 / 0.3e1 * t4007 + t4010 / 0.2e1 + t4013 / 0.2e1 - 0.616e3 / 0.27e2 * t4015 + 0.44e2 / 0.3e1 * t4017 + 0.44e2 / 0.3e1 * t4019 - 0.8e1 * t4021 - 0.4e1 * t4023 - 0.4e1 * t4025 + 0.3e1 / 0.2e1 * t4028 + 0.3e1 / 0.2e1 * t4031 + t4034 / 0.2e1 + t4037 / 0.2e1 - t3232;
  t4045 = 0.5e1 * t383 * t1915 + t41 * t3982 / 0.2e1 + 0.17e2 / 0.24e2 * t199 * t2099 + 0.85e2 / 0.96e2 * t959 * t732 + 0.9e1 / 0.8e1 * t962 * t732 + 0.5e1 / 0.3e1 * t965 * t732 + 0.55e2 / 0.24e2 * t969 * t732 + 0.11e2 / 0.6e1 * t261 * t2076 + 0.11e2 / 0.2e1 * t387 * t1915 + t142 * t4039 + 0.2e1 * t265 * t2076 + 0.6e1 * t391 * t1915;
  t4084 = -0.2e1 * t3999 + 0.3e1 / 0.4e1 * t4002 + 0.3e1 / 0.4e1 * t4005 - 0.2e1 / 0.3e1 * t4007 + t4010 / 0.4e1 + t4013 / 0.4e1 - 0.308e3 / 0.27e2 * t4015 + 0.22e2 / 0.3e1 * t4017 + 0.22e2 / 0.3e1 * t4019 - 0.4e1 * t4021 - 0.2e1 * t4023 - 0.2e1 * t4025 + 0.3e1 / 0.4e1 * t4028 + 0.3e1 / 0.4e1 * t4031 + t4034 / 0.4e1 + t4037 / 0.4e1;
  t4089 = 0.17e2 / 0.8e1 * t332 * t1840 + t75 * t3982 / 0.2e1 + 0.3e1 / 0.4e1 * t204 * t2099 + 0.9e1 / 0.4e1 * t337 * t1840 + t79 * t3982 / 0.2e1 + 0.5e1 / 0.6e1 * t209 * t2099 + 0.5e1 / 0.2e1 * t342 * t1840 + t92 * t3982 / 0.2e1 + 0.11e2 / 0.12e2 * t214 * t2099 + 0.11e2 / 0.4e1 * t347 * t1840 + t96 * t4084 / 0.2e1 + 0.5e1 / 0.6e1 * t234 * t2120;
  t4112 = 0.5e1 / 0.2e1 * t365 * t1887 + t116 * t4084 / 0.2e1 + 0.11e2 / 0.12e2 * t239 * t2120 + 0.11e2 / 0.4e1 * t370 * t1887 + t121 * t4084 / 0.2e1 + t245 * t2120 + 0.3e1 * t376 * t1887 + t125 * t4039 + 0.5e1 / 0.3e1 * t257 * t2076 - 0.595e3 / 0.3456e4 * t1996 * t196 - 0.3e1 / 0.16e2 * t1999 * t196 - 0.5e1 / 0.27e2 * t2002 * t196;
  t4133 = -0.55e2 / 0.432e3 * t2006 * t196 - 0.5e1 / 0.27e2 * t2011 * t231 - 0.55e2 / 0.432e3 * t2014 * t231 - 0.1e2 / 0.27e2 * t2017 * t255 - 0.55e2 / 0.216e3 * t2020 * t255 + 0.5e1 / 0.3e1 * t972 * t777 + 0.55e2 / 0.24e2 * t975 * t777 + 0.1e2 / 0.3e1 * t978 * t801 + 0.55e2 / 0.12e2 * t981 * t801 + t139 * t4039 + t3338 + t3340;
  t4138 = -t3342 - t3344 - t3346 - t3348 + t3565 + t3575 + t3577 + t3579 - 0.7e1 / 0.6e1 * t3872 - 0.8e1 / 0.3e1 * t3874 - 0.9e1 / 0.2e1 * t3876 - 0.2e2 / 0.3e1 * t3878;
  tv4rho43 = t3911 + t3916 + t3922 + t4045 + t4089 + t4112 + t4133 + t4138;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4151 = 0.1e1 / t18 / t104;
  t4163 = 0.4e2 / 0.81e2 * t156 * t318 * t148 + 0.385e3 / 0.1296e4 * t144 * t2716 * t148 + 0.4e2 / 0.81e2 * t150 * t106 * t148 + 0.9e1 / 0.16e2 * t153 * t4151 * t148 + 0.35e2 / 0.27e2 * t3891 + 0.35e2 / 0.27e2 * t3893 + 0.64e2 / 0.27e2 * t3895 + 0.64e2 / 0.27e2 * t3897 + 0.3e1 * t3899 + 0.3e1 * t3901 + 0.8e2 / 0.27e2 * t3903 + 0.8e2 / 0.27e2 * t3905;
  t4176 = 0.27e2 * t3583 + 0.16e3 / 0.3e1 * t3585 + 0.4e2 * t3587 + 0.28e2 / 0.3e1 * t3589 + 0.7e1 * t3591 + 0.64e2 / 0.3e1 * t3593 + 0.16e2 * t3595 + 0.36e2 * t3597 - 0.112e3 * t3293 - 0.192e3 * t3295 - 0.128e3 * t3297 - 0.216e3 * t3299;
  t4182 = -0.144e3 * t3301 - 0.24e3 * t3303 - 0.16e3 * t3305 - 0.168e3 * t3307 + t2980 + t2986 + t2988 + t2990 + t2992 + t2994 + t2996 + t2998;
  t4192 = 0.1e1 / t4 / t104;
  t4221 = 0.55e2 / 0.12e2 * t969 * t887 + 0.85e2 / 0.48e2 * t959 * t887 + 0.9e1 / 0.4e1 * t962 * t887 + 0.1e2 / 0.3e1 * t965 * t887 + 0.385e3 / 0.2592e4 * t115 * t4192 * t112 + 0.4e2 / 0.81e2 * t124 * t318 * t136 + 0.385e3 / 0.1296e4 * t138 * t4192 * t136 + 0.11305e5 / 0.41472e5 * t29 / t957 / t104 * t71 + 0.9e1 / 0.32e2 * t74 * t4151 * t71 + 0.2e2 / 0.81e2 * t78 * t318 * t71 + 0.385e3 / 0.2592e4 * t82 * t4192 * t71 + 0.2e2 / 0.81e2 * t95 * t318 * t112 + 0.17e2 / 0.6e1 * t332 * t2099;
  t4224 = t857 * t857;
  t4229 = t861 * t861;
  t4235 = 0.24e2 * t648 + 0.24e2 * t2978;
  t4239 = my_piecewise3(t50, 0, 0.4e2 / 0.81e2 * t3163 * t4224 - 0.16e2 / 0.9e1 * t1802 * t861 + 0.4e1 / 0.3e1 * t478 * t4229 + 0.16e2 / 0.9e1 * t708 * t2040 + 0.4e1 / 0.3e1 * t53 * t4235);
  t4254 = t876 * t876;
  t4259 = t879 * t879;
  t4268 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t3192 * t4254 - 0.16e2 / 0.9e1 * t1824 * t879 + 0.4e1 / 0.3e1 * t493 * t4259 + 0.16e2 / 0.9e1 * t721 * t2068 - 0.4e1 / 0.3e1 * t65 * t4235);
  t4272 = t44 * t4239 * t57 / 0.4e1 + 0.91e3 / 0.81e2 * t60 / t11 / t2048 * t68 - 0.28e3 / 0.27e2 * t2090 * t326 + 0.14e2 / 0.3e1 * t871 * t884 - 0.4e1 / 0.3e1 * t319 * t2096 + t62 * t4268 * t57 / 0.4e1;
  t4285 = t865 * t865;
  t4287 = t100 * t4285 * t56;
  t4290 = t100 * t1167 * t2044;
  t4292 = t100 * t223 * t4239;
  t4298 = sigma[2] / t25 / t911 / t104 * t109;
  t4300 = t2051 * t359;
  t4302 = t914 * t920;
  t4304 = t914 * t923;
  t4306 = t356 * t2060;
  t4308 = t356 * t2073;
  t4310 = t883 * t883;
  t4312 = t107 * t4310 * t56;
  t4315 = t107 * t1249 * t2072;
  t4317 = t107 * t227 * t4268;
  t4319 = 0.3e1 / 0.4e1 * t4287 + t4290 + t4292 / 0.4e1 + 0.2618e4 / 0.81e2 * t4298 - 0.1232e4 / 0.27e2 * t4300 + 0.44e2 / 0.3e1 * t4302 + 0.44e2 / 0.3e1 * t4304 - 0.8e1 * t4306 - 0.8e1 / 0.3e1 * t4308 + 0.3e1 / 0.4e1 * t4312 + t4315 + t4317 / 0.4e1;
  t4332 = t75 * t4272 / 0.2e1 + 0.3e1 * t337 * t2099 + t79 * t4272 / 0.2e1 + 0.1e2 / 0.3e1 * t342 * t2099 + t92 * t4272 / 0.2e1 + 0.11e2 / 0.3e1 * t347 * t2099 + t96 * t4319 / 0.2e1 + 0.1e2 / 0.3e1 * t365 * t2120 + t116 * t4319 / 0.2e1 + 0.11e2 / 0.3e1 * t370 * t2120 + t121 * t4319 / 0.2e1 + 0.4e1 * t376 * t2120;
  t4345 = 0.3e1 / 0.2e1 * t4287 + 0.2e1 * t4290 + t4292 / 0.2e1 + 0.5236e4 / 0.81e2 * t4298 - 0.2464e4 / 0.27e2 * t4300 + 0.88e2 / 0.3e1 * t4302 + 0.88e2 / 0.3e1 * t4304 - 0.16e2 * t4306 - 0.16e2 / 0.3e1 * t4308 + 0.3e1 / 0.2e1 * t4312 + 0.2e1 * t4315 + t4317 / 0.2e1 - t3232;
  t4370 = t125 * t4345 + 0.2e2 / 0.3e1 * t383 * t2076 + t41 * t4272 / 0.2e1 - 0.2e2 / 0.27e2 * t2011 * t362 - 0.55e2 / 0.108e3 * t2014 * t362 - 0.4e2 / 0.27e2 * t2017 * t381 - 0.55e2 / 0.54e2 * t2020 * t381 + 0.1e2 / 0.3e1 * t972 * t926 + 0.55e2 / 0.12e2 * t975 * t926 + 0.2e2 / 0.3e1 * t978 * t946 + 0.55e2 / 0.6e1 * t981 * t946 + t139 * t4345 + 0.22e2 / 0.3e1 * t387 * t2076;
  t4393 = t142 * t4345 + 0.8e1 * t391 * t2076 - 0.595e3 / 0.864e3 * t1996 * t329 - 0.3e1 / 0.4e1 * t1999 * t329 - 0.2e2 / 0.27e2 * t2002 * t329 - 0.55e2 / 0.108e3 * t2006 * t329 + 0.12e2 * t3834 + 0.6e1 * t3836 + 0.385e3 / 0.1296e4 * t1 * t2716 + 0.4e2 / 0.81e2 * t8 * t106 + 0.9e1 / 0.16e2 * t15 * t4151 + 0.4e2 / 0.81e2 * t22 * t318;
  t4394 = pow(rho[1], -0.29166666666666666667e1);
  t4405 = 0.15861304012345679006e0 * t159 * t4394 + t3054 + t3087 + t3093 + t3095 - 0.56e2 * t3564 - 0.64e2 * t3574 - 0.72e2 * t3576 - 0.8e2 * t3578 + 0.7e1 / 0.3e1 * t3872 + 0.16e2 / 0.3e1 * t3874 + 0.9e1 * t3876 + 0.4e2 / 0.3e1 * t3878;
  tv4rho44 = t4163 + t4176 + t4182 + t4221 + t4332 + t4370 + t4393 + t4405;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4424 = t2166 * t224;
  t4429 = t407 * t488 * t57;
  t4450 = -0.121e3 / 0.192e3 * t2252 * t2185 + 0.18173e5 / 0.27648e5 * t29 / t1029 / t97 * t1033 + 0.85e2 / 0.128e3 * t74 * t2162 * t1033 + 0.145e3 / 0.216e3 * t78 * t99 * t1033 + 0.2321e4 / 0.3456e4 * t82 * t2955 * t1033 - 0.13e2 / 0.4e1 * t4424 + 0.3e1 / 0.4e1 * t1025 * t534 + 0.17e2 / 0.64e2 * t1031 * t4429 + 0.9e1 / 0.32e2 * t1036 * t4429 + 0.5e1 / 0.16e2 * t1039 * t4429 + 0.11e2 / 0.32e2 * t1042 * t4429 - 0.35e2 / 0.12e2 * t2158 * t224 + 0.5e1 / 0.8e1 * t1016 * t534 - 0.99e2 / 0.32e2 * t2163 * t224 + 0.11e2 / 0.16e2 * t1020 * t534 - 0.153e3 / 0.256e3 * t2175 * t2185 - 0.39e2 / 0.64e2 * t2178 * t2185;
  t4454 = t219 * t530 * t56;
  t4457 = t1428 * t101 * t56;
  t4467 = t471 * t185 * t57;
  t4474 = t121 * t524;
  t4478 = t177 * t488 * t57;
  t4488 = t1377 * t55 * t57;
  t4493 = -0.5e1 / 0.8e1 * t2181 * t2185 - t96 * t4454 - 0.77e2 / 0.27e2 * t116 * t4457 - t116 * t4454 - t121 * t4454 - 0.77e2 / 0.27e2 * t96 * t4457 - 0.77e2 / 0.27e2 * t121 * t4457 + 0.7e1 / 0.12e2 * t408 * t4467 + 0.7e1 / 0.12e2 * t413 * t4467 + 0.7e1 / 0.12e2 * t416 * t4467 + 0.11e2 / 0.3e1 * t4474 * t224 - t408 * t4478 / 0.4e1 - t413 * t4478 / 0.4e1 - t416 * t4478 / 0.4e1 + 0.7e1 / 0.12e2 * t419 * t4467 - 0.35e2 / 0.54e2 * t408 * t4488 - 0.35e2 / 0.54e2 * t413 * t4488;
  t4504 = t116 * t524;
  t4518 = t43 * t1397 * t57;
  t4527 = t96 * t524;
  t4530 = -0.35e2 / 0.54e2 * t416 * t4488 - 0.35e2 / 0.54e2 * t419 * t4488 - t2272 * t534 + 0.3e1 / 0.8e1 * t996 * t1438 + t996 * t1441 / 0.8e1 + 0.11e2 / 0.3e1 * t4504 * t224 - t2277 * t534 + 0.3e1 / 0.8e1 * t999 * t1438 + t999 * t1441 / 0.8e1 - t2217 * t534 + 0.3e1 / 0.8e1 * t1002 * t1438 + t1002 * t1441 / 0.8e1 + t408 * t4518 / 0.16e2 + t413 * t4518 / 0.16e2 + t416 * t4518 / 0.16e2 + t419 * t4518 / 0.16e2 + 0.11e2 / 0.3e1 * t4527 * t224;
  t4536 = t119 * t219 * t102;
  t4556 = t524 * t55;
  t4566 = 0.1232e4 / 0.27e2 * t1472;
  t4567 = -0.308e3 / 0.27e2 * t4457 + 0.44e2 / 0.3e1 * t4556 * t761 - 0.4e1 * t4454 - 0.4e1 * t2231 * t1603 + 0.3e1 / 0.2e1 * t2416 * t1603 + t1054 * t3357 / 0.2e1 + t4566;
  t4581 = t141 * t1058;
  t4583 = -t419 * t4478 / 0.4e1 + 0.11e2 / 0.16e2 * t1020 * t531 + 0.8e1 / 0.3e1 * t4536 + 0.3e1 / 0.4e1 * t1025 * t531 + 0.535e3 / 0.216e3 * t95 / t522 * t102 + 0.5e1 / 0.8e1 * t1016 * t531 + 0.8921e4 / 0.3456e4 * t115 / t85 / t217 * t102 + 0.1e2 / 0.3e1 * t603 * t1058 + 0.55e2 / 0.12e2 * t608 * t1058 + t142 * t4567 + 0.6e1 * t265 * t2238 + t125 * t4567 + 0.5e1 * t257 * t2238 + t139 * t4567 + 0.11e2 / 0.2e1 * t261 * t2238 - 0.1e2 / 0.27e2 * t1523 * t431 - 0.55e2 / 0.216e3 * t1526 * t431 + 0.6e1 * t4581;
  tv4rho3sigma0 = t4450 + t4493 + t4530 + t4583;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t4587 = t603 * t252;
  t4589 = t257 * t566;
  t4592 = 0.2464e4 / 0.27e2 * t125 * t1472;
  t4595 = t608 * t252;
  t4597 = t261 * t566;
  t4600 = 0.2464e4 / 0.27e2 * t139 * t1472;
  t4601 = t141 * t252;
  t4602 = 0.32e2 * t4601;
  t4603 = t265 * t566;
  t4606 = 0.2464e4 / 0.27e2 * t142 * t1472;
  tv4rho3sigma1 = 0.2e2 / 0.27e2 * t1523 * t134 + 0.16e3 / 0.9e1 * t4587 - 0.88e3 / 0.9e1 * t4589 + t4592 + 0.55e2 / 0.108e3 * t1526 * t134 + 0.22e3 / 0.9e1 * t4595 - 0.968e3 / 0.9e1 * t4597 + t4600 + t4602 - 0.352e3 / 0.3e1 * t4603 + t4606;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4611 = t2308 * t228;
  t4628 = t61 * t1413 * t57;
  t4631 = 0.5e1 / 0.8e1 * t234 * t2312 - 0.5e1 / 0.216e3 * t1517 * t455 + 0.3e1 / 0.4e1 * t4611 + 0.3e1 / 0.4e1 * t245 * t2312 - 0.55e2 / 0.3456e4 * t1520 * t455 + 0.11e2 / 0.16e2 * t239 * t2312 + 0.3e1 / 0.4e1 * t2362 * t541 + 0.3e1 / 0.8e1 * t1115 * t1444 + t1115 * t1447 / 0.8e1 + 0.17e2 / 0.64e2 * t1081 * t2370 + t440 * t4628 / 0.16e2;
  t4648 = t600 * t106;
  t4657 = 0.9e1 / 0.32e2 * t1088 * t2370 + 0.85e2 / 0.768e3 * t2342 * t1085 + 0.9e1 / 0.64e2 * t2346 * t1085 + 0.5e1 / 0.24e2 * t2349 * t1085 + 0.55e2 / 0.192e3 * t2352 * t1085 + 0.3e1 / 0.8e1 * t1105 * t1444 + t1105 * t1447 / 0.8e1 + 0.5e1 / 0.8e1 * t2385 * t541 + 0.55e2 / 0.96e2 * t4648 * t228 - 0.55e2 / 0.3456e4 * t1514 * t439 * t442 - 0.595e3 / 0.27648e5 * t1504 * t439 * t442;
  t4675 = t597 * t106;
  t4684 = -0.3e1 / 0.128e3 * t1507 * t439 * t442 - 0.5e1 / 0.216e3 * t1510 * t439 * t442 + t445 * t4628 / 0.16e2 + 0.5e1 / 0.16e2 * t1093 * t2370 + t448 * t4628 / 0.16e2 + 0.11e2 / 0.32e2 * t1098 * t2370 + t451 * t4628 / 0.16e2 + 0.5e1 / 0.12e2 * t4675 * t228 + 0.11e2 / 0.16e2 * t2357 * t541 + 0.3e1 / 0.8e1 * t1110 * t1444 + t1110 * t1447 / 0.8e1;
  t4695 = 0.3e1 / 0.2e1 * t2562 * t1632 + t1120 * t3401 / 0.2e1 + t4566;
  t4707 = t141 * t1123;
  t4709 = -0.55e2 / 0.216e3 * t1526 * t463 - 0.1e2 / 0.27e2 * t1523 * t463 + 0.5e1 * t257 * t2334 + t125 * t4695 + 0.11e2 / 0.2e1 * t261 * t2334 + t139 * t4695 + 0.6e1 * t265 * t2334 + t142 * t4695 + 0.55e2 / 0.12e2 * t608 * t1123 + 0.1e2 / 0.3e1 * t603 * t1123 + 0.6e1 * t4707;
  tv4rho3sigma2 = t4631 + t4657 + t4684 + t4709;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4720 = t407 * t715 * t57;
  t4753 = 0.5e1 / 0.24e2 * t365 * t2170 + 0.121e3 / 0.108e3 * t370 * t2229 + 0.11e2 / 0.48e2 * t370 * t2170 + 0.55e2 / 0.54e2 * t365 * t2229 + 0.17e2 / 0.96e2 * t1031 * t4720 + 0.3e1 / 0.16e2 * t1036 * t4720 + 0.5e1 / 0.24e2 * t1039 * t4720 + 0.11e2 / 0.48e2 * t1042 * t4720 + 0.5e1 / 0.12e2 * t1016 * t762 + 0.5e1 / 0.12e2 * t1016 * t765 + 0.11e2 / 0.24e2 * t1020 * t762 + 0.11e2 / 0.24e2 * t1020 * t765 + t1025 * t762 / 0.2e1 + t1025 * t765 / 0.2e1 + 0.11e2 / 0.9e1 * t376 * t2229 + t376 * t2170 / 0.4e1 - 0.51e2 / 0.256e3 * t2175 * t2390 - 0.13e2 / 0.64e2 * t2178 * t2390 - 0.5e1 / 0.24e2 * t2181 * t2390 - 0.121e3 / 0.576e3 * t2252 * t2390;
  t4758 = t2166 * t350;
  t4761 = t471 * t313 * t57;
  t4770 = t376 * t219;
  t4776 = t177 * t715 * t57;
  t4802 = -0.11e2 / 0.36e2 * t1148 * t2204 - t419 * t4776 / 0.6e1 - 0.2e1 / 0.3e1 * t2272 * t762 - 0.2e1 / 0.3e1 * t2272 * t765 + 0.7e1 / 0.24e2 * t1138 * t2208 + 0.7e1 / 0.36e2 * t413 * t4761 + 0.35e2 / 0.108e3 * t1143 * t2208 + 0.7e1 / 0.36e2 * t416 * t4761 + 0.77e2 / 0.216e3 * t1148 * t2208 + 0.7e1 / 0.36e2 * t419 * t4761 + 0.11e2 / 0.9e1 * t4527 * t350;
  t4816 = t43 * t1624 * t57;
  t4832 = t365 * t219;
  t4851 = 0.11e2 / 0.96e2 * t1148 * t2263 + t419 * t4816 / 0.16e2 - 0.1e2 / 0.9e1 * t4832 * t224 - 0.2e1 / 0.3e1 * t2277 * t762 - 0.2e1 / 0.3e1 * t2277 * t765 - 0.2e1 / 0.3e1 * t2217 * t762 - 0.2e1 / 0.3e1 * t2217 * t765 - 0.17e2 / 0.72e2 * t1131 * t2204 - t408 * t4776 / 0.6e1 - t1138 * t2204 / 0.4e1 - t413 * t4776 / 0.6e1;
  t4861 = t370 * t219;
  t4891 = 0.44e2 / 0.9e1 * t4556 * t1167 - 0.8e1 / 0.3e1 * t219 * t185 * t1167 - 0.8e1 / 0.3e1 * t2231 * t2419 + t99 * t488 * t1167 / 0.2e1 + t2416 * t2419 + t1054 * t56 * t1624 / 0.2e1 + t4566;
  t4907 = t141 * t1170;
  t4909 = 0.55e2 / 0.36e2 * t608 * t1170 + t125 * t4891 + 0.1e2 / 0.3e1 * t257 * t2422 + 0.11e2 / 0.6e1 * t387 * t2238 + t139 * t4891 + 0.11e2 / 0.3e1 * t261 * t2422 + 0.2e1 * t391 * t2238 + t142 * t4891 + 0.4e1 * t265 * t2422 + 0.5e1 / 0.3e1 * t383 * t2238 + 0.2e1 * t4907;
  tv4rho3sigma3 = -0.35e2 / 0.36e2 * t2158 * t350 - 0.33e2 / 0.32e2 * t2163 * t350 + 0.7e1 / 0.36e2 * t408 * t4761 - 0.5e1 / 0.18e2 * t1143 * t2204 + t999 * t1607 / 0.4e1 + t999 * t1625 / 0.8e1 - 0.4e1 / 0.3e1 * t4770 * t224 + t2464 * t534 / 0.4e1 - t416 * t4776 / 0.6e1 + 0.11e2 / 0.9e1 * t4504 * t350 + 0.11e2 / 0.9e1 * t4474 * t350 + 0.119e3 / 0.432e3 * t1131 * t2208 + t1002 * t1607 / 0.4e1 + t1002 * t1625 / 0.8e1 + t408 * t4816 / 0.16e2 + 0.3e1 / 0.32e2 * t1138 * t2263 + t413 * t4816 / 0.16e2 + 0.5e1 / 0.48e2 * t1143 * t2263 + t416 * t4816 / 0.16e2 + 0.5e1 / 0.24e2 * t2488 * t534 + t996 * t1604 / 0.8e1 + t996 * t1607 / 0.4e1 + t996 * t1625 / 0.8e1 - 0.11e2 / 0.9e1 * t4861 * t224 + 0.11e2 / 0.48e2 * t2495 * t534 + t999 * t1604 / 0.8e1 + 0.17e2 / 0.192e3 * t1131 * t2263 + t1002 * t1604 / 0.8e1 + 0.1e2 / 0.9e1 * t603 * t1170 + t4753 - 0.13e2 / 0.12e2 * t4758 + t4802 + t4851 + t4909;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t4912 = t383 * t566;
  t4916 = t387 * t566;
  t4920 = t391 * t566;
  t4922 = 0.32e2 / 0.3e1 * t4601;
  tv4rho3sigma4 = -0.88e3 / 0.27e2 * t4912 + 0.16e3 / 0.27e2 * t4587 - 0.176e4 / 0.27e2 * t4589 + t4592 - 0.968e3 / 0.27e2 * t4916 + 0.22e3 / 0.27e2 * t4595 - 0.1936e4 / 0.27e2 * t4597 + t4600 - 0.352e3 / 0.9e1 * t4920 + t4922 - 0.704e3 / 0.9e1 * t4603 + t4606;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t4929 = t355 * t537 * t56;
  t4932 = t2308 * t359;
  t4939 = t439 * t501 * t57;
  t4966 = -0.5e1 / 0.27e2 * t597 * t1224 - 0.55e2 / 0.216e3 * t600 * t1224 - t121 * t4929 / 0.3e1 + t4932 / 0.4e1 - t96 * t4929 / 0.3e1 - t116 * t4929 / 0.3e1 + 0.11e2 / 0.96e2 * t1245 * t4939 + 0.5e1 / 0.24e2 * t1211 * t541 + 0.11e2 / 0.48e2 * t1215 * t541 + t1220 * t541 / 0.4e1 + 0.17e2 / 0.192e3 * t1234 * t4939 + 0.3e1 / 0.32e2 * t1239 * t4939 + 0.5e1 / 0.48e2 * t1242 * t4939 - 0.85e2 / 0.1728e4 * t2342 * t1201 - t2346 * t1201 / 0.16e2 - 0.5e1 / 0.54e2 * t2349 * t1201 + 0.17e2 / 0.96e2 * t1081 * t2523 + 0.11e2 / 0.48e2 * t1098 * t2523 - t2609 * t541 / 0.3e1;
  t4967 = t234 * t355;
  t4982 = t239 * t355;
  t4992 = t318 * t501 * t57;
  t5009 = -0.1e2 / 0.9e1 * t4967 * t228 + t1105 * t1633 / 0.8e1 + t1105 * t1636 / 0.4e1 + 0.5e1 / 0.12e2 * t2385 * t771 + t1105 * t1654 / 0.8e1 + 0.5e1 / 0.12e2 * t2385 * t774 - t2618 * t541 / 0.3e1 - 0.11e2 / 0.9e1 * t4982 * t228 + t1110 * t1633 / 0.8e1 + t1110 * t1636 / 0.4e1 + 0.11e2 / 0.24e2 * t2357 * t771 - t440 * t4992 / 0.12e2 - 0.17e2 / 0.72e2 * t1081 * t2587 - t445 * t4992 / 0.12e2 - t1088 * t2587 / 0.4e1 - t448 * t4992 / 0.12e2 - 0.5e1 / 0.18e2 * t1093 * t2587 - t451 * t4992 / 0.12e2 - 0.11e2 / 0.36e2 * t1098 * t2587;
  t5012 = t61 * t1653 * t57;
  t5043 = t245 * t355;
  t5052 = t451 * t5012 / 0.16e2 + 0.5e1 / 0.72e2 * t2349 * t1185 + 0.55e2 / 0.288e3 * t4648 * t359 + 0.85e2 / 0.2304e4 * t2342 * t1185 + 0.3e1 / 0.64e2 * t2346 * t1185 - 0.55e2 / 0.432e3 * t2352 * t1201 + 0.55e2 / 0.576e3 * t2352 * t1185 + 0.5e1 / 0.36e2 * t4675 * t359 + t445 * t5012 / 0.16e2 + 0.3e1 / 0.16e2 * t1088 * t2523 + t448 * t5012 / 0.16e2 + 0.5e1 / 0.24e2 * t1093 * t2523 + t1110 * t1654 / 0.8e1 + 0.11e2 / 0.24e2 * t2357 * t774 - t2513 * t541 / 0.3e1 - 0.4e1 / 0.3e1 * t5043 * t228 + t1115 * t1633 / 0.8e1 + t1115 * t1636 / 0.4e1 + t2362 * t771 / 0.2e1;
  t5060 = t119 * t355 * t109;
  t5078 = -0.4e1 / 0.3e1 * t4929 - 0.4e1 / 0.3e1 * t2559 * t1632 + t106 * t501 * t1249 / 0.2e1 + t2562 * t2565 + t1120 * t56 * t1653 / 0.2e1 + t4566;
  t5098 = t141 * t1252;
  t5100 = t1115 * t1654 / 0.8e1 + t2362 * t774 / 0.2e1 + t440 * t5012 / 0.16e2 - t5060 / 0.3e1 + 0.5e1 / 0.24e2 * t1211 * t538 + 0.11e2 / 0.48e2 * t1215 * t538 + t1220 * t538 / 0.4e1 + t125 * t5078 + 0.1e2 / 0.3e1 * t257 * t2568 + 0.5e1 / 0.3e1 * t383 * t2334 + t139 * t5078 + 0.11e2 / 0.3e1 * t261 * t2568 + 0.11e2 / 0.6e1 * t387 * t2334 + t142 * t5078 + 0.4e1 * t265 * t2568 + 0.2e1 * t391 * t2334 + 0.1e2 / 0.9e1 * t603 * t1252 + 0.55e2 / 0.36e2 * t608 * t1252 + 0.2e1 * t5098;
  tv4rho3sigma5 = t4966 + t5009 + t5052 + t5100;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5103 = t407 * t865 * t57;
  t5109 = t219 * t904 * t56;
  t5137 = t975 * t99;
  t5144 = 0.11e2 / 0.96e2 * t1042 * t5103 - 0.5e1 / 0.27e2 * t972 * t1046 - t121 * t5109 / 0.3e1 - t96 * t5109 / 0.3e1 - 0.55e2 / 0.216e3 * t975 * t1046 - t116 * t5109 / 0.3e1 + 0.5e1 / 0.24e2 * t1016 * t908 + 0.11e2 / 0.48e2 * t1020 * t908 + t1025 * t908 / 0.4e1 + 0.17e2 / 0.192e3 * t1031 * t5103 + 0.3e1 / 0.32e2 * t1036 * t5103 + 0.5e1 / 0.48e2 * t1039 * t5103 + t4424 / 0.4e1 + t996 * t1861 / 0.4e1 + t996 * t1866 / 0.8e1 + t996 * t1869 / 0.8e1 + 0.55e2 / 0.288e3 * t5137 * t224 + 0.11e2 / 0.24e2 * t2495 * t762 + 0.11e2 / 0.24e2 * t2495 * t765;
  t5148 = t43 * t1816 * t57;
  t5155 = t972 * t99;
  t5186 = t999 * t1861 / 0.4e1 + t416 * t5148 / 0.16e2 + 0.11e2 / 0.48e2 * t1148 * t2472 + t419 * t5148 / 0.16e2 + 0.5e1 / 0.36e2 * t5155 * t224 + 0.5e1 / 0.12e2 * t2488 * t762 + 0.5e1 / 0.12e2 * t2488 * t765 + 0.55e2 / 0.576e3 * t2651 * t987 + 0.85e2 / 0.2304e4 * t2654 * t987 + 0.3e1 / 0.64e2 * t2657 * t987 + 0.5e1 / 0.72e2 * t2660 * t987 + t999 * t1866 / 0.8e1 + t999 * t1869 / 0.8e1 + t2464 * t762 / 0.2e1 + t2464 * t765 / 0.2e1 + t1002 * t1861 / 0.4e1 + t1002 * t1866 / 0.8e1 + t1002 * t1869 / 0.8e1 + 0.17e2 / 0.96e2 * t1131 * t2472;
  t5211 = t177 * t865 * t57;
  t5228 = t408 * t5148 / 0.16e2 + 0.3e1 / 0.16e2 * t1138 * t2472 + t413 * t5148 / 0.16e2 + 0.5e1 / 0.24e2 * t1143 * t2472 - 0.1e2 / 0.9e1 * t4832 * t350 - 0.55e2 / 0.432e3 * t2651 * t1006 - 0.85e2 / 0.1728e4 * t2654 * t1006 - t2657 * t1006 / 0.16e2 - 0.5e1 / 0.54e2 * t2660 * t1006 - t2217 * t908 / 0.3e1 - 0.17e2 / 0.72e2 * t1131 * t2437 - t408 * t5211 / 0.12e2 - t1138 * t2437 / 0.4e1 - t413 * t5211 / 0.12e2 - 0.5e1 / 0.18e2 * t1143 * t2437 - t416 * t5211 / 0.12e2 - 0.11e2 / 0.36e2 * t1148 * t2437 - t419 * t5211 / 0.12e2 - t2272 * t908 / 0.3e1;
  t5249 = t99 * t313;
  t5258 = -0.4e1 / 0.3e1 * t5109 + t5249 * t2419 - 0.4e1 / 0.3e1 * t2231 * t2692 + t2416 * t2692 / 0.2e1 + t1054 * t56 * t1816 / 0.2e1 + t4566;
  t5273 = -0.11e2 / 0.9e1 * t4861 * t350 - t2277 * t908 / 0.3e1 - 0.4e1 / 0.3e1 * t4770 * t350 + 0.5e1 / 0.24e2 * t1016 * t905 + 0.11e2 / 0.48e2 * t1020 * t905 + t1025 * t905 / 0.4e1 - t4536 / 0.3e1 + 0.1e2 / 0.9e1 * t978 * t1058 + 0.55e2 / 0.36e2 * t981 * t1058 + 0.1e2 / 0.3e1 * t383 * t2422 + t125 * t5258 + 0.5e1 / 0.3e1 * t257 * t2695 + 0.11e2 / 0.3e1 * t387 * t2422 + t139 * t5258 + 0.11e2 / 0.6e1 * t261 * t2695 + 0.4e1 * t391 * t2422 + t142 * t5258 + 0.2e1 * t265 * t2695 + 0.2e1 * t4581;
  tv4rho3sigma6 = t5144 + t5186 + t5228 + t5273;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t5275 = t978 * t252;
  t5279 = t981 * t252;
  tv4rho3sigma7 = 0.16e3 / 0.27e2 * t5275 - 0.176e4 / 0.27e2 * t4912 - 0.88e3 / 0.27e2 * t4589 + t4592 + 0.22e3 / 0.27e2 * t5279 - 0.1936e4 / 0.27e2 * t4916 - 0.968e3 / 0.27e2 * t4597 + t4600 + t4922 - 0.704e3 / 0.9e1 * t4920 - 0.352e3 / 0.9e1 * t4603 + t4606;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5302 = t439 * t728 * t57;
  t5327 = -0.121e3 / 0.576e3 * t2781 * t2537 + 0.55e2 / 0.54e2 * t234 * t2785 + 0.5e1 / 0.24e2 * t234 * t2765 + 0.121e3 / 0.108e3 * t239 * t2785 + 0.11e2 / 0.48e2 * t239 * t2765 + 0.11e2 / 0.9e1 * t245 * t2785 - 0.35e2 / 0.36e2 * t2712 * t228 - 0.33e2 / 0.32e2 * t2717 * t228 + 0.17e2 / 0.96e2 * t1234 * t5302 + 0.3e1 / 0.16e2 * t1239 * t5302 + 0.5e1 / 0.24e2 * t1242 * t5302 + 0.11e2 / 0.48e2 * t1245 * t5302 + t245 * t2765 / 0.4e1 - 0.51e2 / 0.256e3 * t2770 * t2537 + 0.5e1 / 0.12e2 * t1211 * t771 + 0.5e1 / 0.12e2 * t1211 * t774 + 0.11e2 / 0.24e2 * t1215 * t771 + 0.11e2 / 0.24e2 * t1215 * t774 + t1220 * t771 / 0.2e1 + t1220 * t774 / 0.2e1;
  t5342 = t61 * t1836 * t57;
  t5355 = t318 * t728 * t57;
  t5368 = t121 * t913;
  t5375 = 0.3e1 / 0.32e2 * t1088 * t2744 + 0.7e1 / 0.24e2 * t1088 * t2721 - t440 * t5355 / 0.6e1 - 0.17e2 / 0.72e2 * t1081 * t2727 + t1110 * t1878 / 0.4e1 + t1110 * t1881 / 0.8e1 + t1110 * t1884 / 0.8e1 + 0.11e2 / 0.48e2 * t2357 * t923 + 0.11e2 / 0.9e1 * t5368 * t228 - 0.2e1 / 0.3e1 * t2513 * t771 - 0.2e1 / 0.3e1 * t2513 * t774;
  t5388 = t96 * t913;
  t5406 = t116 * t913;
  t5420 = t870 * t192 * t57;
  t5425 = t1105 * t1881 / 0.8e1 + t1105 * t1884 / 0.8e1 + 0.5e1 / 0.24e2 * t2385 * t923 + 0.11e2 / 0.9e1 * t5406 * t228 - 0.2e1 / 0.3e1 * t2618 * t771 - 0.2e1 / 0.3e1 * t2618 * t774 - 0.11e2 / 0.9e1 * t4982 * t359 - t445 * t5355 / 0.6e1 - t1088 * t2727 / 0.4e1 + 0.7e1 / 0.36e2 * t448 * t5420 + 0.35e2 / 0.108e3 * t1093 * t2721;
  t5450 = t913 * t67;
  t5458 = t106 * t325;
  t5465 = 0.44e2 / 0.9e1 * t5450 * t770 - 0.8e1 / 0.3e1 * t355 * t192 * t1249 - 0.8e1 / 0.3e1 * t2559 * t2565 + t5458 * t2565 + t2562 * t2821 / 0.2e1 + t1120 * t56 * t1836 / 0.2e1 + t4566;
  t5482 = 0.1e2 / 0.3e1 * t383 * t2568 + t139 * t5465 + 0.11e2 / 0.6e1 * t261 * t2824 + 0.11e2 / 0.3e1 * t387 * t2568 + t142 * t5465 + 0.2e1 * t265 * t2824 + 0.4e1 * t391 * t2568 + 0.1e2 / 0.9e1 * t978 * t1123 + 0.55e2 / 0.36e2 * t981 * t1123 + t125 * t5465 + 0.2e1 * t4707;
  tv4rho3sigma8 = 0.11e2 / 0.9e1 * t5388 * t228 - 0.2e1 / 0.3e1 * t2609 * t771 - 0.2e1 / 0.3e1 * t2609 * t774 - 0.1e2 / 0.9e1 * t4967 * t359 + t1105 * t1878 / 0.4e1 + 0.7e1 / 0.36e2 * t451 * t5420 + 0.77e2 / 0.216e3 * t1098 * t2721 - t448 * t5355 / 0.6e1 - 0.5e1 / 0.18e2 * t1093 * t2727 - t451 * t5355 / 0.6e1 - 0.11e2 / 0.36e2 * t1098 * t2727 + 0.7e1 / 0.36e2 * t440 * t5420 + 0.119e3 / 0.432e3 * t1081 * t2721 + 0.7e1 / 0.36e2 * t445 * t5420 + 0.5e1 / 0.3e1 * t257 * t2824 - 0.13e2 / 0.64e2 * t2775 * t2537 - 0.5e1 / 0.24e2 * t2778 * t2537 + t1115 * t1878 / 0.4e1 + t1115 * t1881 / 0.8e1 + t1115 * t1884 / 0.8e1 + t2362 * t923 / 0.4e1 + t440 * t5342 / 0.16e2 + 0.17e2 / 0.192e3 * t1081 * t2744 + t445 * t5342 / 0.16e2 - 0.4e1 / 0.3e1 * t5043 * t359 + t448 * t5342 / 0.16e2 + 0.5e1 / 0.48e2 * t1093 * t2744 + t451 * t5342 / 0.16e2 + 0.11e2 / 0.96e2 * t1098 * t2744 + t5327 - 0.13e2 / 0.12e2 * t4611 + t5482 + t5425 + t5375;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5507 = -0.5e1 / 0.216e3 * t2011 * t423 + 0.3e1 / 0.4e1 * t376 * t2674 - 0.55e2 / 0.3456e4 * t2014 * t423 + 0.11e2 / 0.16e2 * t370 * t2674 + 0.5e1 / 0.8e1 * t365 * t2674 + 0.3e1 / 0.4e1 * t4758 + 0.9e1 / 0.64e2 * t2657 * t1135 + 0.5e1 / 0.24e2 * t2660 * t1135 + 0.55e2 / 0.192e3 * t2651 * t1135 - 0.55e2 / 0.3456e4 * t2006 * t407 * t410 + 0.85e2 / 0.768e3 * t2654 * t1135;
  t5509 = t43 * t2044 * t57;
  t5532 = t416 * t5509 / 0.16e2 + 0.11e2 / 0.32e2 * t1148 * t2634 + t419 * t5509 / 0.16e2 + 0.5e1 / 0.12e2 * t5155 * t350 + t999 * t2045 / 0.8e1 + 0.3e1 / 0.4e1 * t2464 * t908 + 0.3e1 / 0.8e1 * t1002 * t2031 + t1002 * t2045 / 0.8e1 + 0.17e2 / 0.64e2 * t1131 * t2634 + t408 * t5509 / 0.16e2 + 0.9e1 / 0.32e2 * t1138 * t2634;
  t5559 = t413 * t5509 / 0.16e2 + 0.5e1 / 0.16e2 * t1143 * t2634 + 0.3e1 / 0.8e1 * t996 * t2031 + t996 * t2045 / 0.8e1 + 0.5e1 / 0.8e1 * t2488 * t908 + 0.55e2 / 0.96e2 * t5137 * t350 + 0.11e2 / 0.16e2 * t2495 * t908 + 0.3e1 / 0.8e1 * t999 * t2031 - 0.595e3 / 0.27648e5 * t1996 * t407 * t410 - 0.3e1 / 0.128e3 * t1999 * t407 * t410 - 0.5e1 / 0.216e3 * t2002 * t407 * t410;
  t5571 = 0.3e1 / 0.2e1 * t5249 * t2692 + t1054 * t56 * t2044 / 0.2e1 + t4566;
  t5584 = -0.1e2 / 0.27e2 * t2017 * t431 - 0.55e2 / 0.216e3 * t2020 * t431 + 0.5e1 * t383 * t2695 + t125 * t5571 + 0.11e2 / 0.2e1 * t387 * t2695 + t139 * t5571 + 0.6e1 * t391 * t2695 + t142 * t5571 + 0.1e2 / 0.3e1 * t978 * t1170 + 0.55e2 / 0.12e2 * t981 * t1170 + 0.6e1 * t4907;
  tv4rho3sigma9 = t5507 + t5532 + t5559 + t5584;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.2e2 / 0.27e2 * t2017 * t134 + 0.16e3 / 0.9e1 * t5275 - 0.88e3 / 0.9e1 * t4912 + t4592 + 0.55e2 / 0.108e3 * t2020 * t134 + 0.22e3 / 0.9e1 * t5279 - 0.968e3 / 0.9e1 * t4916 + t4600 + t4602 - 0.352e3 / 0.3e1 * t4920 + t4606;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5617 = t439 * t883 * t57;
  t5633 = t2050 * t108 * t56;
  t5636 = 0.85e2 / 0.128e3 * t74 * t2716 * t1236 + 0.145e3 / 0.216e3 * t78 * t106 * t1236 + 0.2321e4 / 0.3456e4 * t82 * t4151 * t1236 + 0.11e2 / 0.16e2 * t1215 * t923 + 0.3e1 / 0.4e1 * t1220 * t923 - 0.153e3 / 0.256e3 * t2770 * t2797 - 0.39e2 / 0.64e2 * t2775 * t2797 - 0.5e1 / 0.8e1 * t2778 * t2797 - 0.121e3 / 0.192e3 * t2781 * t2797 + 0.17e2 / 0.64e2 * t1234 * t5617 + 0.9e1 / 0.32e2 * t1239 * t5617 + 0.5e1 / 0.16e2 * t1242 * t5617 + 0.11e2 / 0.32e2 * t1245 * t5617 - 0.35e2 / 0.12e2 * t2712 * t359 + 0.5e1 / 0.8e1 * t1211 * t923 - 0.99e2 / 0.32e2 * t2717 * t359 - 0.77e2 / 0.27e2 * t121 * t5633;
  t5640 = t355 * t919 * t56;
  t5653 = t2089 * t67 * t57;
  t5659 = t318 * t883 * t57;
  t5674 = -0.77e2 / 0.27e2 * t96 * t5633 - t96 * t5640 - 0.77e2 / 0.27e2 * t116 * t5633 - t116 * t5640 - t121 * t5640 + 0.18173e5 / 0.27648e5 * t29 / t1232 / t104 * t1236 - 0.13e2 / 0.4e1 * t4932 - 0.35e2 / 0.54e2 * t440 * t5653 - 0.35e2 / 0.54e2 * t445 * t5653 - t448 * t5659 / 0.4e1 - t451 * t5659 / 0.4e1 - t2513 * t923 - t440 * t5659 / 0.4e1 - t445 * t5659 / 0.4e1 - t2618 * t923 + 0.3e1 / 0.8e1 * t1110 * t2060 + 0.3e1 / 0.8e1 * t1115 * t2060;
  t5679 = t61 * t2072 * t57;
  t5689 = t870 * t325 * t57;
  t5713 = t1115 * t2073 / 0.8e1 + t440 * t5679 / 0.16e2 + t445 * t5679 / 0.16e2 - 0.35e2 / 0.54e2 * t448 * t5653 - 0.35e2 / 0.54e2 * t451 * t5653 + 0.7e1 / 0.12e2 * t451 * t5689 + 0.7e1 / 0.12e2 * t440 * t5689 + 0.7e1 / 0.12e2 * t445 * t5689 + t1110 * t2073 / 0.8e1 + 0.11e2 / 0.3e1 * t5368 * t359 + 0.7e1 / 0.12e2 * t448 * t5689 + t448 * t5679 / 0.16e2 + t451 * t5679 / 0.16e2 + 0.11e2 / 0.3e1 * t5388 * t359 - t2609 * t923 + 0.3e1 / 0.8e1 * t1105 * t2060 + t1105 * t2073 / 0.8e1;
  t5747 = -0.308e3 / 0.27e2 * t5633 + 0.44e2 / 0.3e1 * t5450 * t1249 - 0.4e1 * t5640 - 0.4e1 * t2559 * t2821 + 0.3e1 / 0.2e1 * t5458 * t2821 + t1120 * t56 * t2072 / 0.2e1 + t4566;
  t5762 = 0.11e2 / 0.3e1 * t5406 * t359 + 0.3e1 / 0.4e1 * t1220 * t920 + 0.535e3 / 0.216e3 * t95 / t911 * t109 + 0.5e1 / 0.8e1 * t1211 * t920 + 0.8921e4 / 0.3456e4 * t115 / t89 / t353 * t109 + 0.11e2 / 0.16e2 * t1215 * t920 + 0.8e1 / 0.3e1 * t5060 + 0.1e2 / 0.3e1 * t978 * t1252 + 0.55e2 / 0.12e2 * t981 * t1252 + t125 * t5747 + 0.5e1 * t383 * t2824 + t139 * t5747 + 0.11e2 / 0.2e1 * t387 * t2824 + t142 * t5747 + 0.6e1 * t391 * t2824 - 0.1e2 / 0.27e2 * t2017 * t463 - 0.55e2 / 0.216e3 * t2020 * t463 + 0.6e1 * t5098;
  tv4rho3sigma11 = t5636 + t5674 + t5713 + t5762;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5789 = t1264 * t185 * t57;
  tv4rho2sigma20 = -t1271 * t2263 / 0.32e2 + t1265 * t2204 / 0.12e2 - t1265 * t2263 / 0.32e2 + 0.13e2 / 0.128e3 * t2178 * t2837 + t1267 * t2204 / 0.12e2 - t1267 * t2263 / 0.32e2 + 0.5e1 / 0.48e2 * t2181 * t2837 + t1269 * t2204 / 0.12e2 - t1269 * t2263 / 0.32e2 + 0.121e3 / 0.1152e4 * t2252 * t2837 + t1271 * t2204 / 0.12e2 + 0.51e2 / 0.512e3 * t2175 * t2837 - 0.11e2 / 0.96e2 * t1042 * t5789 - 0.17e2 / 0.192e3 * t1031 * t5789 - 0.3e1 / 0.32e2 * t1036 * t5789 - 0.5e1 / 0.48e2 * t1039 * t5789 - 0.7e1 / 0.72e2 * t1265 * t2208 - 0.7e1 / 0.72e2 * t1267 * t2208 - 0.7e1 / 0.72e2 * t1269 * t2208 - 0.7e1 / 0.72e2 * t1271 * t2208;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = -0.85e2 / 0.4608e4 * t582 * t1275 * t442 - 0.17e2 / 0.192e3 * t2862 * t1085 - t1276 * t2370 / 0.32e2 - 0.3e1 / 0.128e3 * t586 * t1275 * t442 - 0.3e1 / 0.32e2 * t2867 * t1085 - t1278 * t2370 / 0.32e2 - 0.5e1 / 0.144e3 * t590 * t1275 * t442 - 0.5e1 / 0.48e2 * t2872 * t1085 - t1280 * t2370 / 0.32e2 - 0.55e2 / 0.1152e4 * t594 * t1275 * t442 - 0.11e2 / 0.96e2 * t2877 * t1085 - t1282 * t2370 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t5839 = t1264 * t313 * t57;
  tv4rho2sigma26 = 0.17e2 / 0.288e3 * t2882 * t1006 - 0.17e2 / 0.384e3 * t2882 * t987 - 0.17e2 / 0.384e3 * t1031 * t5839 + t1265 * t2437 / 0.24e2 - t1265 * t2472 / 0.32e2 + t2887 * t1006 / 0.16e2 - 0.3e1 / 0.64e2 * t2887 * t987 - 0.3e1 / 0.64e2 * t1036 * t5839 + t1267 * t2437 / 0.24e2 - t1267 * t2472 / 0.32e2 + 0.5e1 / 0.72e2 * t2892 * t1006 - 0.5e1 / 0.96e2 * t2892 * t987 - 0.5e1 / 0.96e2 * t1039 * t5839 + t1269 * t2437 / 0.24e2 - t1269 * t2472 / 0.32e2 + 0.11e2 / 0.144e3 * t2897 * t1006 - 0.11e2 / 0.192e3 * t2897 * t987 - 0.11e2 / 0.192e3 * t1042 * t5839 + t1271 * t2437 / 0.24e2 - t1271 * t2472 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t5877 = t1275 * t192 * t57;
  tv4rho2sigma211 = -0.17e2 / 0.384e3 * t1234 * t5877 + 0.17e2 / 0.288e3 * t2862 * t1201 + t1276 * t2587 / 0.24e2 - 0.17e2 / 0.384e3 * t2862 * t1185 - t1276 * t2523 / 0.32e2 - 0.3e1 / 0.64e2 * t1239 * t5877 + t2867 * t1201 / 0.16e2 + t1278 * t2587 / 0.24e2 - 0.3e1 / 0.64e2 * t2867 * t1185 - t1278 * t2523 / 0.32e2 - 0.5e1 / 0.96e2 * t1242 * t5877 + 0.5e1 / 0.72e2 * t2872 * t1201 + t1280 * t2587 / 0.24e2 - 0.5e1 / 0.96e2 * t2872 * t1185 - t1280 * t2523 / 0.32e2 - 0.11e2 / 0.192e3 * t1245 * t5877 + 0.11e2 / 0.144e3 * t2877 * t1201 + t1282 * t2587 / 0.24e2 - 0.11e2 / 0.192e3 * t2877 * t1185 - t1282 * t2523 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = -0.85e2 / 0.4608e4 * t959 * t1264 * t410 - 0.17e2 / 0.192e3 * t2882 * t1135 - t1265 * t2634 / 0.32e2 - 0.3e1 / 0.128e3 * t962 * t1264 * t410 - 0.3e1 / 0.32e2 * t2887 * t1135 - t1267 * t2634 / 0.32e2 - 0.5e1 / 0.144e3 * t965 * t1264 * t410 - 0.5e1 / 0.48e2 * t2892 * t1135 - t1269 * t2634 / 0.32e2 - 0.55e2 / 0.1152e4 * t969 * t1264 * t410 - 0.11e2 / 0.96e2 * t2897 * t1135 - t1271 * t2634 / 0.32e2;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t5971 = t1275 * t325 * t57;
  tv4rho2sigma217 = t1282 * t2727 / 0.12e2 - t1282 * t2744 / 0.32e2 + 0.51e2 / 0.512e3 * t2770 * t2903 + t1276 * t2727 / 0.12e2 - t1276 * t2744 / 0.32e2 + 0.13e2 / 0.128e3 * t2775 * t2903 + t1278 * t2727 / 0.12e2 - t1278 * t2744 / 0.32e2 + 0.5e1 / 0.48e2 * t2778 * t2903 + t1280 * t2727 / 0.12e2 - t1280 * t2744 / 0.32e2 + 0.121e3 / 0.1152e4 * t2781 * t2903 - 0.17e2 / 0.192e3 * t1234 * t5971 - 0.3e1 / 0.32e2 * t1239 * t5971 - 0.5e1 / 0.48e2 * t1242 * t5971 - 0.11e2 / 0.96e2 * t1245 * t5971 - 0.7e1 / 0.72e2 * t1282 * t2721 - 0.7e1 / 0.72e2 * t1276 * t2721 - 0.7e1 / 0.72e2 * t1278 * t2721 - 0.7e1 / 0.72e2 * t1280 * t2721;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t5989 = t2930 * t55 * t57;
  tv4rhosigma30 = 0.17e2 / 0.256e3 * t1031 * t5989 - t2931 * t1006 / 0.16e2 + 0.3e1 / 0.64e2 * t2931 * t987 + 0.9e1 / 0.128e3 * t1036 * t5989 - t2933 * t1006 / 0.16e2 + 0.3e1 / 0.64e2 * t2933 * t987 + 0.5e1 / 0.64e2 * t1039 * t5989 - t2935 * t1006 / 0.16e2 + 0.3e1 / 0.64e2 * t2935 * t987 + 0.11e2 / 0.128e3 * t1042 * t5989 - t2937 * t1006 / 0.16e2 + 0.3e1 / 0.64e2 * t2937 * t987;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.17e2 / 0.256e3 * t199 * t2942 * t442 + 0.3e1 / 0.64e2 * t2943 * t1085 + 0.9e1 / 0.128e3 * t204 * t2942 * t442 + 0.3e1 / 0.64e2 * t2945 * t1085 + 0.5e1 / 0.64e2 * t209 * t2942 * t442 + 0.3e1 / 0.64e2 * t2947 * t1085 + 0.11e2 / 0.128e3 * t214 * t2942 * t442 + 0.3e1 / 0.64e2 * t2949 * t1085;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.17e2 / 0.256e3 * t332 * t2930 * t410 + 0.3e1 / 0.64e2 * t2931 * t1135 + 0.9e1 / 0.128e3 * t337 * t2930 * t410 + 0.3e1 / 0.64e2 * t2933 * t1135 + 0.5e1 / 0.64e2 * t342 * t2930 * t410 + 0.3e1 / 0.64e2 * t2935 * t1135 + 0.11e2 / 0.128e3 * t347 * t2930 * t410 + 0.3e1 / 0.64e2 * t2937 * t1135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t6055 = t2942 * t67 * t57;
  tv4rhosigma319 = 0.17e2 / 0.256e3 * t1234 * t6055 - t2943 * t1201 / 0.16e2 + 0.3e1 / 0.64e2 * t2943 * t1185 + 0.9e1 / 0.128e3 * t1239 * t6055 - t2945 * t1201 / 0.16e2 + 0.3e1 / 0.64e2 * t2945 * t1185 + 0.5e1 / 0.64e2 * t1242 * t6055 - t2947 * t1201 / 0.16e2 + 0.3e1 / 0.64e2 * t2947 * t1185 + 0.11e2 / 0.128e3 * t1245 * t6055 - t2949 * t1201 / 0.16e2 + 0.3e1 / 0.64e2 * t2949 * t1185;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t6082 = 0.1e1 / t42 / t2928 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.128e3 * t41 * t6082 * t410 - 0.15e2 / 0.128e3 * t75 * t6082 * t410 - 0.15e2 / 0.128e3 * t79 * t6082 * t410 - 0.15e2 / 0.128e3 * t92 * t6082 * t410;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t6094 = 0.1e1 / t60 / t2940 / sigma[2];
  tv4sigma414 = -0.15e2 / 0.128e3 * t41 * t6094 * t442 - 0.15e2 / 0.128e3 * t75 * t6094 * t442 - 0.15e2 / 0.128e3 * t79 * t6094 * t442 - 0.15e2 / 0.128e3 * t92 * t6094 * t442;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

