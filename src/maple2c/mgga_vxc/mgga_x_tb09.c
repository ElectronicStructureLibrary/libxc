/* 
  This file was generated automatically with ./scripts/maple2c_new.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : .//maple/mgga_vxc/mgga_x_tb09.mpl
  Type of functional: mgga_vxc
*/

#define maple2c_order 3

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t13, t14, t16, t17, t19, t22, t23, t24;
  double t25, t26, t27, t28, t30, t31, t34, t35;
  double t36, t37, t38, t43, t44, t45, t46, t48;
  double t49, t52, t53, t54, t55, t60, t62, t63;
  double t66, t70, t74, t75, t76, t77, t79, t80;
  double t81, t82, t83, t85, t86, t87, t88, t89;
  double t90, t93, t94, t95, t96, t97, t99, t100;
  double t102, t106, t107, t110, t111, t112, t113, t114;
  double t117, t119, t121, t125, t130, t133, t137, t138;
  double t139, t140, t143, t144, t146, t150, t151, t154;
  double t157, t160, t165, t167, t169, t170, t171, t172;
  double t175, t176, t178, t182, t183, t186, t190, t193;
  double t194, t195, t196, t199, t200, t202, t206, t207;
  double t210, t213, t218, t222, t224, t226, t230, t231;
  double t236, t238, t239, t245, t246, t247, t248, t249;
  double t250, t252, t253, t254, t255, t256, t257, t260;
  double t261, t262, t263, t265, t269, t271, t274, t275;
  double t276, t279, t282, t285, t288, t289, t293, t294;
  double t295, t296, t297, t301, t303, t306, t307, t309;
  double t318, t322, t330, t336, t337, t347, t351, t352;
  double t358, t359, t368, t372, t381, t382, t388, t390;
  double t391, t392, t396, t397, t398, t399, t404, t405;
  double t410, t412, t415, t418, t421, t422, t423, t427;
  double t428, t432, t435, t436, t442, t446, t454, t459;
  double t466, t473, t483, t487, t494, t495, t501, t502;
  double t506, t507, t518, t521, t524, t528, t549, t569;
  double t576, t577, t583, t584, t588, t589, t600, t603;
  double t606, t610, t631, t656, t660, t666, t667, t671;
  double t672, t673, t678, t680, t687, t689, t698, t700;
  double t701, t705, t706, t710, t714, t719, t723, t739;
  double t743, t750, t754, t757, t758, t761, t762, t765;
  double t770, t776, t781, t782, t785, t789, t792, t793;
  double t796, t800, t811, t815, t822, t826, t881, t884;
  double t885, t890, t892, t899, t901, t910, t914, t915;
  double t919, t923, t929, t946, t953, t956, t976, t987;
  double t1021, t1024, t1025, t1030, t1032, t1039, t1050, t1054;
  double t1055, t1063, t1093, t1097;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = M_CBRT2;
  t5 = t4 * t4;
  t6 = lapl[0] * t5;
  t7 = POW_1_3(rho[0]);
  t8 = t7 * t7;
  t10 = 0.1e1 / t8 / rho[0];
  t13 = tau[0] * t5;
  t14 = t13 * t10;
  t16 = sigma[0] * t5;
  t17 = rho[0] * rho[0];
  t19 = 0.1e1 / t8 / t17;
  t22 = t6 * t10 / 0.6e1 - 0.53333333333333333333e0 * t14 + 0.66666666666666666667e-1 * t16 * t19;
  t23 = fabs(t22);
  t24 = t23 < 0.50e-12;
  t25 = 0.0e0 < t22;
  t26 = my_piecewise3(t25, 0.50e-12, -0.50e-12);
  t27 = my_piecewise3(t24, t26, t22);
  t28 = xc_mgga_x_br89_get_x(t27);
  t30 = exp(t28 / 0.3e1);
  t31 = exp(-t28);
  t34 = t31 * (0.1e1 + t28 / 0.2e1);
  t35 = 0.1e1 - t34;
  t36 = t30 * t35;
  t37 = 0.1e1 / t28;
  t38 = t36 * t37;
  t43 = sqrt(0.15e2);
  t44 = (0.3e1 * params->c - 0.2e1) * t43;
  t45 = 0.1e1 / M_PI;
  t46 = M_SQRT2;
  t48 = params->alpha * sigma[0];
  t49 = t5 * t19;
  t52 = t14 - t48 * t49 / 0.8e1;
  t53 = 0.1e-9 < t52;
  t54 = my_piecewise3(t53, t52, 0.1e-9);
  t55 = sqrt(t54);
  t60 = (-0.2e1 * t3 * t38 + t44 * t45 * t46 * t55 / 0.6e1) * t5;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t60 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t62 = params->c * M_PI;
  t63 = my_piecewise3(t25, 0, 0);
  t66 = t13 * t19;
  t70 = 0.1e1 / t8 / t17 / rho[0];
  t74 = my_piecewise3(t24, t63, -0.5e1 / 0.18e2 * t6 * t19 + 0.88888888888888888889e0 * t66 - 0.17777777777777777778e0 * t16 * t70);
  t75 = t27 * t27;
  t76 = 0.1e1 / t75;
  t77 = t74 * t76;
  t79 = exp(-0.2e1 / 0.3e1 * t28);
  t80 = 0.1e1 / t79;
  t81 = t77 * t80;
  t82 = t62 * t81;
  t83 = t28 * t28;
  t85 = t83 - 0.2e1 * t28 + 0.3e1;
  t86 = 0.1e1 / t85;
  t87 = t28 - 0.2e1;
  t88 = t87 * t87;
  t89 = t86 * t88;
  t90 = t89 * t38;
  t93 = t2 * t2;
  t94 = t93 * t74;
  t95 = t76 * t80;
  t96 = t94 * t95;
  t97 = t89 * t34;
  t99 = t94 * t76;
  t100 = t80 * t86;
  t102 = t100 * t88 * t31;
  t106 = t30 * (t96 * t97 - t99 * t102 / 0.2e1);
  t107 = t106 * t37;
  t110 = 0.1e1 / t83;
  t111 = t36 * t110;
  t112 = t62 * t111;
  t113 = t100 * t88;
  t114 = t77 * t113;
  t117 = t44 * t45;
  t119 = t46 / t55;
  t121 = t5 * t70;
  t125 = my_piecewise3(t53, -0.5e1 / 0.3e1 * t66 + t48 * t121 / 0.3e1, 0);
  t130 = (-0.2e1 / 0.3e1 * t82 * t90 - 0.2e1 * t3 * t107 + 0.2e1 * t112 * t114 + t117 * t119 * t125 / 0.12e2) * t5;
  t133 = 0.1e1 / t8;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t130 * t7 / 0.2e1 + t60 * t133 / 0.6e1;

  t137 = my_piecewise3(t24, t63, 0.66666666666666666667e-1 * t49);
  t138 = t137 * t76;
  t139 = t138 * t80;
  t140 = t62 * t139;
  t143 = t93 * t137;
  t144 = t143 * t95;
  t146 = t143 * t76;
  t150 = t30 * (t144 * t97 - t146 * t102 / 0.2e1);
  t151 = t150 * t37;
  t154 = t138 * t113;
  t157 = params->alpha * t5;
  t160 = my_piecewise3(t53, -t157 * t19 / 0.8e1, 0);
  t165 = (-0.2e1 / 0.3e1 * t140 * t90 - 0.2e1 * t3 * t151 + 0.2e1 * t112 * t154 + t117 * t119 * t160 / 0.12e2) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t165 * t7 / 0.2e1;

  t167 = t5 * t10;
  t169 = my_piecewise3(t24, t63, t167 / 0.6e1);
  t170 = t169 * t76;
  t171 = t170 * t80;
  t172 = t62 * t171;
  t175 = t93 * t169;
  t176 = t175 * t95;
  t178 = t175 * t76;
  t182 = t30 * (t176 * t97 - t178 * t102 / 0.2e1);
  t183 = t182 * t37;
  t186 = t170 * t113;
  t190 = (-0.2e1 / 0.3e1 * t172 * t90 - 0.2e1 * t3 * t183 + 0.2e1 * t112 * t186) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t190 * t7 / 0.2e1;

  t193 = my_piecewise3(t24, t63, -0.53333333333333333333e0 * t167);
  t194 = t193 * t76;
  t195 = t194 * t80;
  t196 = t62 * t195;
  t199 = t93 * t193;
  t200 = t199 * t95;
  t202 = t199 * t76;
  t206 = t30 * (t200 * t97 - t202 * t102 / 0.2e1);
  t207 = t206 * t37;
  t210 = t194 * t113;
  t213 = my_piecewise3(t53, t167, 0);
  t218 = (-0.2e1 / 0.3e1 * t196 * t90 - 0.2e1 * t3 * t207 + 0.2e1 * t112 * t210 + t117 * t119 * t213 / 0.12e2) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t218 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t222 = t13 * t70;
  t224 = t17 * t17;
  t226 = 0.1e1 / t8 / t224;
  t230 = my_piecewise3(t24, t63, 0.20e2 / 0.27e2 * t6 * t70 - 0.23703703703703703704e1 * t222 + 0.65185185185185185186e0 * t16 * t226);
  t231 = t230 * t76;
  t236 = t74 * t74;
  t238 = 0.1e1 / t75 / t27;
  t239 = t236 * t238;
  t245 = params->c * t93 * M_PI;
  t246 = t75 * t75;
  t247 = 0.1e1 / t246;
  t248 = t236 * t247;
  t249 = t79 * t79;
  t250 = 0.1e1 / t249;
  t252 = t245 * t248 * t250;
  t253 = t85 * t85;
  t254 = 0.1e1 / t253;
  t255 = t88 * t88;
  t256 = t254 * t255;
  t257 = t256 * t38;
  t260 = t254 * t88;
  t261 = t260 * t30;
  t262 = t35 * t37;
  t263 = t28 * t93;
  t265 = t95 * t89;
  t269 = 0.2e1 * t263 * t74 * t265 - 0.2e1 * t99 * t113;
  t271 = t261 * t262 * t269;
  t274 = t88 * t87;
  t275 = t254 * t274;
  t276 = t275 * t38;
  t279 = t89 * t107;
  t282 = t256 * t111;
  t285 = t93 * t230;
  t288 = t93 * t236;
  t289 = t238 * t80;
  t293 = t2 * M_PI;
  t294 = t293 * t236;
  t295 = t247 * t250;
  t296 = t294 * t295;
  t297 = t256 * t34;
  t301 = t260 * t34 * t269;
  t303 = t275 * t34;
  t306 = t294 * t247;
  t307 = t250 * t254;
  t309 = t307 * t255 * t31;
  t318 = t260 * t31 * t269;
  t322 = t307 * t274 * t31;
  t330 = t62 * t106 * t110;
  t336 = t245 * t36 / t83 / t28;
  t337 = t307 * t255;
  t347 = t260 * t269;
  t351 = t245 * t111;
  t352 = t307 * t274;
  t358 = t46 / t55 / t54;
  t359 = t125 * t125;
  t368 = my_piecewise3(t53, 0.40e2 / 0.9e1 * t222 - 0.11e2 / 0.9e1 * t48 * t5 * t226, 0);
  t372 = -0.2e1 / 0.3e1 * t62 * t231 * t80 * t90 + 0.4e1 / 0.3e1 * t62 * t239 * t80 * t90 - 0.2e1 / 0.3e1 * t252 * t257 + 0.2e1 / 0.3e1 * t82 * t271 - 0.4e1 / 0.3e1 * t252 * t276 - 0.4e1 / 0.3e1 * t82 * t279 + 0.8e1 / 0.3e1 * t252 * t282 - 0.2e1 * t3 * t30 * (t285 * t95 * t97 - 0.2e1 * t288 * t289 * t97 - t296 * t297 / 0.3e1 - t96 * t301 + 0.2e1 * t296 * t303 + 0.2e1 / 0.3e1 * t306 * t309 - t285 * t76 * t102 / 0.2e1 + t288 * t238 * t102 + t96 * t318 / 0.2e1 - t306 * t322) * t37 + 0.4e1 * t330 * t114 - 0.4e1 * t336 * t248 * t337 + 0.2e1 * t112 * t231 * t113 - 0.4e1 * t112 * t239 * t113 - 0.2e1 * t112 * t81 * t347 + 0.4e1 * t351 * t248 * t352 - t117 * t358 * t359 / 0.24e2 + t117 * t119 * t368 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t372 * t5 * t7 / 0.2e1 + t130 * t133 / 0.3e1 - t60 * t10 / 0.9e1;

  t381 = my_piecewise3(t24, t63, -0.17777777777777777778e0 * t121);
  t382 = t381 * t76;
  t388 = t137 * t238 * t80;
  t390 = t89 * t30;
  t391 = t262 * t74;
  t392 = t390 * t391;
  t396 = t137 * t247 * t250;
  t397 = t245 * t396;
  t398 = t256 * t30;
  t399 = t398 * t391;
  t404 = t275 * t30;
  t405 = t404 * t391;
  t410 = t35 * t110;
  t412 = t398 * t410 * t74;
  t415 = t89 * t151;
  t418 = t93 * t381;
  t421 = t143 * t289;
  t422 = t34 * t74;
  t423 = t89 * t422;
  t427 = t293 * t137 * t295;
  t428 = t256 * t422;
  t432 = t275 * t422;
  t435 = t31 * t74;
  t436 = t256 * t435;
  t442 = t89 * t435;
  t446 = t275 * t435;
  t454 = t62 * t150 * t110;
  t459 = t256 * t74;
  t466 = t89 * t74;
  t473 = t275 * t74;
  t483 = my_piecewise3(t53, t157 * t70 / 0.3e1, 0);
  t487 = -0.2e1 / 0.3e1 * t62 * t382 * t80 * t90 + 0.4e1 / 0.3e1 * t62 * t388 * t392 - 0.2e1 / 0.3e1 * t397 * t399 + 0.2e1 / 0.3e1 * t140 * t271 - 0.4e1 / 0.3e1 * t397 * t405 - 0.2e1 / 0.3e1 * t140 * t279 + 0.8e1 / 0.3e1 * t397 * t412 - 0.2e1 / 0.3e1 * t82 * t415 - 0.2e1 * t3 * t30 * (t418 * t95 * t97 - 0.2e1 * t421 * t423 - t427 * t428 / 0.3e1 - t144 * t301 + 0.2e1 * t427 * t432 + 0.2e1 / 0.3e1 * t427 * t436 - t418 * t76 * t102 / 0.2e1 + t421 * t442 + t144 * t318 / 0.2e1 - t427 * t446) * t37 + 0.2e1 * t454 * t114 + 0.2e1 * t330 * t154 - 0.4e1 * t336 * t396 * t459 + 0.2e1 * t112 * t382 * t113 - 0.4e1 * t112 * t388 * t466 - 0.2e1 * t112 * t139 * t347 + 0.4e1 * t351 * t396 * t473 - t117 * t358 * t160 * t125 / 0.24e2 + t117 * t119 * t483 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t487 * t5 * t7 / 0.2e1 + t165 * t133 / 0.6e1;

  t494 = my_piecewise3(t24, t63, -0.5e1 / 0.18e2 * t49);
  t495 = t494 * t76;
  t501 = t169 * t238 * t80;
  t502 = t62 * t501;
  t506 = t169 * t247 * t250;
  t507 = t245 * t506;
  t518 = t89 * t183;
  t521 = t93 * t494;
  t524 = t175 * t289;
  t528 = t293 * t169 * t295;
  t549 = t62 * t182 * t110;
  t569 = -0.2e1 / 0.3e1 * t62 * t495 * t80 * t90 + 0.4e1 / 0.3e1 * t502 * t392 - 0.2e1 / 0.3e1 * t507 * t399 + 0.2e1 / 0.3e1 * t172 * t271 - 0.4e1 / 0.3e1 * t507 * t405 - 0.2e1 / 0.3e1 * t172 * t279 + 0.8e1 / 0.3e1 * t507 * t412 - 0.2e1 / 0.3e1 * t82 * t518 - 0.2e1 * t3 * t30 * (t521 * t95 * t97 - 0.2e1 * t524 * t423 - t528 * t428 / 0.3e1 - t176 * t301 + 0.2e1 * t528 * t432 + 0.2e1 / 0.3e1 * t528 * t436 - t521 * t76 * t102 / 0.2e1 + t524 * t442 + t176 * t318 / 0.2e1 - t528 * t446) * t37 + 0.2e1 * t549 * t114 + 0.2e1 * t330 * t186 - 0.4e1 * t336 * t506 * t459 + 0.2e1 * t112 * t495 * t113 - 0.4e1 * t112 * t501 * t466 - 0.2e1 * t112 * t171 * t347 + 0.4e1 * t351 * t506 * t473;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = t569 * t5 * t7 / 0.2e1 + t190 * t133 / 0.6e1;

  t576 = my_piecewise3(t24, t63, 0.88888888888888888889e0 * t49);
  t577 = t576 * t76;
  t583 = t193 * t238 * t80;
  t584 = t62 * t583;
  t588 = t193 * t247 * t250;
  t589 = t245 * t588;
  t600 = t89 * t207;
  t603 = t93 * t576;
  t606 = t199 * t289;
  t610 = t293 * t193 * t295;
  t631 = t62 * t206 * t110;
  t656 = my_piecewise3(t53, -0.5e1 / 0.3e1 * t49, 0);
  t660 = -0.2e1 / 0.3e1 * t62 * t577 * t80 * t90 + 0.4e1 / 0.3e1 * t584 * t392 - 0.2e1 / 0.3e1 * t589 * t399 + 0.2e1 / 0.3e1 * t196 * t271 - 0.4e1 / 0.3e1 * t589 * t405 - 0.2e1 / 0.3e1 * t196 * t279 + 0.8e1 / 0.3e1 * t589 * t412 - 0.2e1 / 0.3e1 * t82 * t600 - 0.2e1 * t3 * t30 * (t603 * t95 * t97 - 0.2e1 * t606 * t423 - t610 * t428 / 0.3e1 - t200 * t301 + 0.2e1 * t610 * t432 + 0.2e1 / 0.3e1 * t610 * t436 - t603 * t76 * t102 / 0.2e1 + t606 * t442 + t200 * t318 / 0.2e1 - t610 * t446) * t37 + 0.2e1 * t631 * t114 + 0.2e1 * t330 * t210 - 0.4e1 * t336 * t588 * t459 + 0.2e1 * t112 * t577 * t113 - 0.4e1 * t112 * t583 * t466 - 0.2e1 * t112 * t195 * t347 + 0.4e1 * t351 * t588 * t473 - t117 * t358 * t213 * t125 / 0.24e2 + t117 * t119 * t656 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t660 * t5 * t7 / 0.2e1 + t218 * t133 / 0.6e1;

  t666 = my_piecewise3(t24, t63, 0);
  t667 = t666 * t76;
  t671 = 0.2e1 / 0.3e1 * t62 * t667 * t80 * t90;
  t672 = t137 * t137;
  t673 = t672 * t238;
  t678 = t672 * t247;
  t680 = t245 * t678 * t250;
  t687 = 0.2e1 * t263 * t137 * t265 - 0.2e1 * t146 * t113;
  t689 = t261 * t262 * t687;
  t698 = t93 * t666;
  t700 = t698 * t95 * t97;
  t701 = t93 * t672;
  t705 = t293 * t672;
  t706 = t705 * t295;
  t710 = t260 * t34 * t687;
  t714 = t705 * t247;
  t719 = t698 * t76 * t102 / 0.2e1;
  t723 = t260 * t31 * t687;
  t739 = 0.2e1 * t112 * t667 * t113;
  t743 = t260 * t687;
  t750 = t160 * t160;
  t754 = my_piecewise3(t53, 0, 0);
  t757 = t117 * t119 * t754 / 0.12e2;
  t758 = -t671 + 0.4e1 / 0.3e1 * t62 * t673 * t80 * t90 - 0.2e1 / 0.3e1 * t680 * t257 + 0.2e1 / 0.3e1 * t140 * t689 - 0.4e1 / 0.3e1 * t680 * t276 - 0.4e1 / 0.3e1 * t140 * t415 + 0.8e1 / 0.3e1 * t680 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t701 * t289 * t97 - t706 * t297 / 0.3e1 - t144 * t710 + 0.2e1 * t706 * t303 + 0.2e1 / 0.3e1 * t714 * t309 - t719 + t701 * t238 * t102 + t144 * t723 / 0.2e1 - t714 * t322) * t37 + 0.4e1 * t454 * t154 - 0.4e1 * t336 * t678 * t337 + t739 - 0.4e1 * t112 * t673 * t113 - 0.2e1 * t112 * t139 * t743 + 0.4e1 * t351 * t678 * t352 - t117 * t358 * t750 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t758 * t5 * t7 / 0.2e1;

  t761 = t262 * t137;
  t762 = t390 * t761;
  t765 = t398 * t761;
  t770 = t404 * t761;
  t776 = t398 * t410 * t137;
  t781 = t34 * t137;
  t782 = t89 * t781;
  t785 = t256 * t781;
  t789 = t275 * t781;
  t792 = t31 * t137;
  t793 = t256 * t792;
  t796 = t89 * t792;
  t800 = t275 * t792;
  t811 = t256 * t137;
  t815 = t89 * t137;
  t822 = t275 * t137;
  t826 = -t671 + 0.4e1 / 0.3e1 * t502 * t762 - 0.2e1 / 0.3e1 * t507 * t765 + 0.2e1 / 0.3e1 * t172 * t689 - 0.4e1 / 0.3e1 * t507 * t770 - 0.2e1 / 0.3e1 * t172 * t415 + 0.8e1 / 0.3e1 * t507 * t776 - 0.2e1 / 0.3e1 * t140 * t518 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t524 * t782 - t528 * t785 / 0.3e1 - t176 * t710 + 0.2e1 * t528 * t789 + 0.2e1 / 0.3e1 * t528 * t793 - t719 + t524 * t796 + t176 * t723 / 0.2e1 - t528 * t800) * t37 + 0.2e1 * t549 * t154 + 0.2e1 * t454 * t186 - 0.4e1 * t336 * t506 * t811 + t739 - 0.4e1 * t112 * t501 * t815 - 0.2e1 * t112 * t171 * t743 + 0.4e1 * t351 * t506 * t822;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = t826 * t5 * t7 / 0.2e1;

  t881 = -t671 + 0.4e1 / 0.3e1 * t584 * t762 - 0.2e1 / 0.3e1 * t589 * t765 + 0.2e1 / 0.3e1 * t196 * t689 - 0.4e1 / 0.3e1 * t589 * t770 - 0.2e1 / 0.3e1 * t196 * t415 + 0.8e1 / 0.3e1 * t589 * t776 - 0.2e1 / 0.3e1 * t140 * t600 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t606 * t782 - t610 * t785 / 0.3e1 - t200 * t710 + 0.2e1 * t610 * t789 + 0.2e1 / 0.3e1 * t610 * t793 - t719 + t606 * t796 + t200 * t723 / 0.2e1 - t610 * t800) * t37 + 0.2e1 * t631 * t154 + 0.2e1 * t454 * t210 - 0.4e1 * t336 * t588 * t811 + t739 - 0.4e1 * t112 * t583 * t815 - 0.2e1 * t112 * t195 * t743 + 0.4e1 * t351 * t588 * t822 - t117 * t358 * t213 * t160 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = t881 * t5 * t7 / 0.2e1;

  t884 = t169 * t169;
  t885 = t884 * t238;
  t890 = t884 * t247;
  t892 = t245 * t890 * t250;
  t899 = 0.2e1 * t263 * t169 * t265 - 0.2e1 * t178 * t113;
  t901 = t261 * t262 * t899;
  t910 = t93 * t884;
  t914 = t293 * t884;
  t915 = t914 * t295;
  t919 = t260 * t34 * t899;
  t923 = t914 * t247;
  t929 = t260 * t31 * t899;
  t946 = t260 * t899;
  t953 = -t671 + 0.4e1 / 0.3e1 * t62 * t885 * t80 * t90 - 0.2e1 / 0.3e1 * t892 * t257 + 0.2e1 / 0.3e1 * t172 * t901 - 0.4e1 / 0.3e1 * t892 * t276 - 0.4e1 / 0.3e1 * t172 * t518 + 0.8e1 / 0.3e1 * t892 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t910 * t289 * t97 - t915 * t297 / 0.3e1 - t176 * t919 + 0.2e1 * t915 * t303 + 0.2e1 / 0.3e1 * t923 * t309 - t719 + t910 * t238 * t102 + t176 * t929 / 0.2e1 - t923 * t322) * t37 + 0.4e1 * t549 * t186 - 0.4e1 * t336 * t890 * t337 + t739 - 0.4e1 * t112 * t885 * t113 - 0.2e1 * t112 * t171 * t946 + 0.4e1 * t351 * t890 * t352;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = t953 * t5 * t7 / 0.2e1;

  t956 = t262 * t169;
  t976 = t34 * t169;
  t987 = t31 * t169;
  t1021 = -t671 + 0.4e1 / 0.3e1 * t584 * t390 * t956 - 0.2e1 / 0.3e1 * t589 * t398 * t956 + 0.2e1 / 0.3e1 * t196 * t901 - 0.4e1 / 0.3e1 * t589 * t404 * t956 - 0.2e1 / 0.3e1 * t196 * t518 + 0.8e1 / 0.3e1 * t589 * t398 * t410 * t169 - 0.2e1 / 0.3e1 * t172 * t600 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t606 * t89 * t976 - t610 * t256 * t976 / 0.3e1 - t200 * t919 + 0.2e1 * t610 * t275 * t976 + 0.2e1 / 0.3e1 * t610 * t256 * t987 - t719 + t606 * t89 * t987 + t200 * t929 / 0.2e1 - t610 * t275 * t987) * t37 + 0.2e1 * t631 * t186 + 0.2e1 * t549 * t210 - 0.4e1 * t336 * t588 * t256 * t169 + t739 - 0.4e1 * t112 * t583 * t89 * t169 - 0.2e1 * t112 * t195 * t946 + 0.4e1 * t351 * t588 * t275 * t169;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = t1021 * t5 * t7 / 0.2e1;

  t1024 = t193 * t193;
  t1025 = t1024 * t238;
  t1030 = t1024 * t247;
  t1032 = t245 * t1030 * t250;
  t1039 = 0.2e1 * t263 * t193 * t265 - 0.2e1 * t202 * t113;
  t1050 = t93 * t1024;
  t1054 = t293 * t1024;
  t1055 = t1054 * t295;
  t1063 = t1054 * t247;
  t1093 = t213 * t213;
  t1097 = -t671 + 0.4e1 / 0.3e1 * t62 * t1025 * t80 * t90 - 0.2e1 / 0.3e1 * t1032 * t257 + 0.2e1 / 0.3e1 * t196 * t261 * t262 * t1039 - 0.4e1 / 0.3e1 * t1032 * t276 - 0.4e1 / 0.3e1 * t196 * t600 + 0.8e1 / 0.3e1 * t1032 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t1050 * t289 * t97 - t1055 * t297 / 0.3e1 - t200 * t260 * t34 * t1039 + 0.2e1 * t1055 * t303 + 0.2e1 / 0.3e1 * t1063 * t309 - t719 + t1050 * t238 * t102 + t200 * t260 * t31 * t1039 / 0.2e1 - t1063 * t322) * t37 + 0.4e1 * t631 * t210 - 0.4e1 * t336 * t1030 * t337 + t739 - 0.4e1 * t112 * t1025 * t113 - 0.2e1 * t112 * t195 * t260 * t1039 + 0.4e1 * t351 * t1030 * t352 - t117 * t358 * t1093 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t1097 * t5 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}


static inline void
func_ferr(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t7, t10, t12, t14;
  double t17, t18, t19, t20, t21, t22, t23, t25;
  double t26, t29, t30, t31, t32, t33, t38, t39;
  double t40, t41, t43, t46, t47, t48, t49, t53;
  double t54, t55, t58, t62, t66, t67, t68, t69;
  double t71, t72, t73, t74, t75, t77, t78, t79;
  double t80, t81, t82, t85, t86, t87, t88, t89;
  double t91, t92, t94, t98, t99, t102, t103, t104;
  double t105, t106, t109, t111, t116, t120, t122, t126;
  double t127, t128, t129, t132, t133, t135, t139, t140;
  double t143, t148, t152, t154, t155, t156, t157, t160;
  double t161, t163, t167, t168, t171, t174, t176, t177;
  double t178, t179, t182, t183, t185, t189, t190, t193;
  double t196, t200, t203, t205, t207, t211, t212, t217;
  double t219, t220, t226, t227, t228, t229, t230, t231;
  double t233, t234, t235, t236, t237, t238, t241, t242;
  double t243, t244, t246, t250, t252, t255, t256, t257;
  double t260, t263, t266, t269, t270, t274, t275, t276;
  double t277, t278, t282, t284, t287, t288, t290, t299;
  double t303, t311, t317, t318, t328, t332, t333, t339;
  double t340, t348, t352, t359, t360, t366, t368, t369;
  double t370, t374, t375, t376, t377, t382, t383, t388;
  double t390, t393, t396, t399, t400, t401, t405, t406;
  double t410, t413, t414, t420, t424, t432, t437, t444;
  double t451, t461, t465, t470, t471, t477, t478, t482;
  double t483, t494, t497, t500, t504, t525, t545, t550;
  double t551, t557, t558, t562, t563, t574, t577, t580;
  double t584, t605, t630, t634, t638, t639, t643, t644;
  double t645, t650, t652, t659, t661, t670, t672, t673;
  double t677, t678, t682, t686, t691, t695, t711, t715;
  double t722, t726, t729, t730, t731, t732, t735, t740;
  double t746, t751, t752, t755, t759, t762, t763, t766;
  double t770, t781, t785, t792, t796, t849, t850, t851;
  double t856, t858, t865, t867, t876, t880, t881, t885;
  double t889, t895, t912, t919, t920, t940, t951, t985;
  double t986, t987, t992, t994, t1001, t1012, t1016, t1017;
  double t1025, t1055, t1059;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * t4;
  t7 = 0.1e1 / t5 / rho[0];
  t10 = tau[0] * t7;
  t12 = rho[0] * rho[0];
  t14 = 0.1e1 / t5 / t12;
  t17 = lapl[0] * t7 / 0.6e1 - 0.53333333333333333333e0 * t10 + 0.66666666666666666667e-1 * sigma[0] * t14;
  t18 = fabs(t17);
  t19 = t18 < 0.50e-12;
  t20 = 0.0e0 < t17;
  t21 = my_piecewise3(t20, 0.50e-12, -0.50e-12);
  t22 = my_piecewise3(t19, t21, t17);
  t23 = xc_mgga_x_br89_get_x(t22);
  t25 = exp(t23 / 0.3e1);
  t26 = exp(-t23);
  t29 = t26 * (0.1e1 + t23 / 0.2e1);
  t30 = 0.1e1 - t29;
  t31 = t25 * t30;
  t32 = 0.1e1 / t23;
  t33 = t31 * t32;
  t38 = sqrt(0.15e2);
  t39 = (0.3e1 * params->c - 0.2e1) * t38;
  t40 = 0.1e1 / M_PI;
  t41 = M_SQRT2;
  t43 = params->alpha * sigma[0];
  t46 = t10 - t43 * t14 / 0.8e1;
  t47 = 0.1e-9 < t46;
  t48 = my_piecewise3(t47, t46, 0.1e-9);
  t49 = sqrt(t48);
  t53 = -0.2e1 * t3 * t33 + t39 * t40 * t41 * t49 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t53 * t4;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t54 = params->c * M_PI;
  t55 = my_piecewise3(t20, 0, 0);
  t58 = tau[0] * t14;
  t62 = 0.1e1 / t5 / t12 / rho[0];
  t66 = my_piecewise3(t19, t55, -0.5e1 / 0.18e2 * lapl[0] * t14 + 0.88888888888888888889e0 * t58 - 0.17777777777777777778e0 * sigma[0] * t62);
  t67 = t22 * t22;
  t68 = 0.1e1 / t67;
  t69 = t66 * t68;
  t71 = exp(-0.2e1 / 0.3e1 * t23);
  t72 = 0.1e1 / t71;
  t73 = t69 * t72;
  t74 = t54 * t73;
  t75 = t23 * t23;
  t77 = t75 - 0.2e1 * t23 + 0.3e1;
  t78 = 0.1e1 / t77;
  t79 = t23 - 0.2e1;
  t80 = t79 * t79;
  t81 = t78 * t80;
  t82 = t81 * t33;
  t85 = t2 * t2;
  t86 = t85 * t66;
  t87 = t68 * t72;
  t88 = t86 * t87;
  t89 = t81 * t29;
  t91 = t86 * t68;
  t92 = t72 * t78;
  t94 = t92 * t80 * t26;
  t98 = t25 * (t88 * t89 - t91 * t94 / 0.2e1);
  t99 = t98 * t32;
  t102 = 0.1e1 / t75;
  t103 = t31 * t102;
  t104 = t54 * t103;
  t105 = t92 * t80;
  t106 = t69 * t105;
  t109 = t39 * t40;
  t111 = t41 / t49;
  t116 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t58 + t43 * t62 / 0.3e1, 0);
  t120 = -0.2e1 / 0.3e1 * t74 * t82 - 0.2e1 * t3 * t99 + 0.2e1 * t104 * t106 + t109 * t111 * t116 / 0.12e2;
  t122 = 0.1e1 / t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t120 * t4 + t53 * t122 / 0.3e1;

  t126 = my_piecewise3(t19, t55, 0.66666666666666666667e-1 * t14);
  t127 = t126 * t68;
  t128 = t127 * t72;
  t129 = t54 * t128;
  t132 = t85 * t126;
  t133 = t132 * t87;
  t135 = t132 * t68;
  t139 = t25 * (t133 * t89 - t135 * t94 / 0.2e1);
  t140 = t139 * t32;
  t143 = t127 * t105;
  t148 = my_piecewise3(t47, -params->alpha * t14 / 0.8e1, 0);
  t152 = -0.2e1 / 0.3e1 * t129 * t82 - 0.2e1 * t3 * t140 + 0.2e1 * t104 * t143 + t109 * t111 * t148 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t152 * t4;

  t154 = my_piecewise3(t19, t55, t7 / 0.6e1);
  t155 = t154 * t68;
  t156 = t155 * t72;
  t157 = t54 * t156;
  t160 = t85 * t154;
  t161 = t160 * t87;
  t163 = t160 * t68;
  t167 = t25 * (t161 * t89 - t163 * t94 / 0.2e1);
  t168 = t167 * t32;
  t171 = t155 * t105;
  t174 = -0.2e1 / 0.3e1 * t157 * t82 - 0.2e1 * t3 * t168 + 0.2e1 * t104 * t171;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t174 * t4;

  t176 = my_piecewise3(t19, t55, -0.53333333333333333333e0 * t7);
  t177 = t176 * t68;
  t178 = t177 * t72;
  t179 = t54 * t178;
  t182 = t85 * t176;
  t183 = t182 * t87;
  t185 = t182 * t68;
  t189 = t25 * (t183 * t89 - t185 * t94 / 0.2e1);
  t190 = t189 * t32;
  t193 = t177 * t105;
  t196 = my_piecewise3(t47, t7, 0);
  t200 = -0.2e1 / 0.3e1 * t179 * t82 - 0.2e1 * t3 * t190 + 0.2e1 * t104 * t193 + t109 * t111 * t196 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t200 * t4;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t203 = tau[0] * t62;
  t205 = t12 * t12;
  t207 = 0.1e1 / t5 / t205;
  t211 = my_piecewise3(t19, t55, 0.20e2 / 0.27e2 * lapl[0] * t62 - 0.23703703703703703704e1 * t203 + 0.65185185185185185186e0 * sigma[0] * t207);
  t212 = t211 * t68;
  t217 = t66 * t66;
  t219 = 0.1e1 / t67 / t22;
  t220 = t217 * t219;
  t226 = params->c * t85 * M_PI;
  t227 = t67 * t67;
  t228 = 0.1e1 / t227;
  t229 = t217 * t228;
  t230 = t71 * t71;
  t231 = 0.1e1 / t230;
  t233 = t226 * t229 * t231;
  t234 = t77 * t77;
  t235 = 0.1e1 / t234;
  t236 = t80 * t80;
  t237 = t235 * t236;
  t238 = t237 * t33;
  t241 = t235 * t80;
  t242 = t241 * t25;
  t243 = t30 * t32;
  t244 = t23 * t85;
  t246 = t87 * t81;
  t250 = 0.2e1 * t244 * t66 * t246 - 0.2e1 * t91 * t105;
  t252 = t242 * t243 * t250;
  t255 = t80 * t79;
  t256 = t235 * t255;
  t257 = t256 * t33;
  t260 = t81 * t99;
  t263 = t237 * t103;
  t266 = t85 * t211;
  t269 = t85 * t217;
  t270 = t219 * t72;
  t274 = t2 * M_PI;
  t275 = t274 * t217;
  t276 = t228 * t231;
  t277 = t275 * t276;
  t278 = t237 * t29;
  t282 = t241 * t29 * t250;
  t284 = t256 * t29;
  t287 = t275 * t228;
  t288 = t231 * t235;
  t290 = t288 * t236 * t26;
  t299 = t241 * t26 * t250;
  t303 = t288 * t255 * t26;
  t311 = t54 * t98 * t102;
  t317 = t226 * t31 / t75 / t23;
  t318 = t288 * t236;
  t328 = t241 * t250;
  t332 = t226 * t103;
  t333 = t288 * t255;
  t339 = t41 / t49 / t48;
  t340 = t116 * t116;
  t348 = my_piecewise3(t47, 0.40e2 / 0.9e1 * t203 - 0.11e2 / 0.9e1 * t43 * t207, 0);
  t352 = -0.2e1 / 0.3e1 * t54 * t212 * t72 * t82 + 0.4e1 / 0.3e1 * t54 * t220 * t72 * t82 - 0.2e1 / 0.3e1 * t233 * t238 + 0.2e1 / 0.3e1 * t74 * t252 - 0.4e1 / 0.3e1 * t233 * t257 - 0.4e1 / 0.3e1 * t74 * t260 + 0.8e1 / 0.3e1 * t233 * t263 - 0.2e1 * t3 * t25 * (t266 * t87 * t89 - 0.2e1 * t269 * t270 * t89 - t277 * t278 / 0.3e1 - t88 * t282 + 0.2e1 * t277 * t284 + 0.2e1 / 0.3e1 * t287 * t290 - t266 * t68 * t94 / 0.2e1 + t269 * t219 * t94 + t88 * t299 / 0.2e1 - t287 * t303) * t32 + 0.4e1 * t311 * t106 - 0.4e1 * t317 * t229 * t318 + 0.2e1 * t104 * t212 * t105 - 0.4e1 * t104 * t220 * t105 - 0.2e1 * t104 * t73 * t328 + 0.4e1 * t332 * t229 * t333 - t109 * t339 * t340 / 0.24e2 + t109 * t111 * t348 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t352 * t4 + 0.2e1 / 0.3e1 * t120 * t122 - 0.2e1 / 0.9e1 * t53 * t7;

  t359 = my_piecewise3(t19, t55, -0.17777777777777777778e0 * t62);
  t360 = t359 * t68;
  t366 = t126 * t219 * t72;
  t368 = t81 * t25;
  t369 = t243 * t66;
  t370 = t368 * t369;
  t374 = t126 * t228 * t231;
  t375 = t226 * t374;
  t376 = t237 * t25;
  t377 = t376 * t369;
  t382 = t256 * t25;
  t383 = t382 * t369;
  t388 = t30 * t102;
  t390 = t376 * t388 * t66;
  t393 = t81 * t140;
  t396 = t85 * t359;
  t399 = t132 * t270;
  t400 = t29 * t66;
  t401 = t81 * t400;
  t405 = t274 * t126 * t276;
  t406 = t237 * t400;
  t410 = t256 * t400;
  t413 = t26 * t66;
  t414 = t237 * t413;
  t420 = t81 * t413;
  t424 = t256 * t413;
  t432 = t54 * t139 * t102;
  t437 = t237 * t66;
  t444 = t81 * t66;
  t451 = t256 * t66;
  t461 = my_piecewise3(t47, params->alpha * t62 / 0.3e1, 0);
  t465 = -0.2e1 / 0.3e1 * t54 * t360 * t72 * t82 + 0.4e1 / 0.3e1 * t54 * t366 * t370 - 0.2e1 / 0.3e1 * t375 * t377 + 0.2e1 / 0.3e1 * t129 * t252 - 0.4e1 / 0.3e1 * t375 * t383 - 0.2e1 / 0.3e1 * t129 * t260 + 0.8e1 / 0.3e1 * t375 * t390 - 0.2e1 / 0.3e1 * t74 * t393 - 0.2e1 * t3 * t25 * (t396 * t87 * t89 - 0.2e1 * t399 * t401 - t405 * t406 / 0.3e1 - t133 * t282 + 0.2e1 * t405 * t410 + 0.2e1 / 0.3e1 * t405 * t414 - t396 * t68 * t94 / 0.2e1 + t399 * t420 + t133 * t299 / 0.2e1 - t405 * t424) * t32 + 0.2e1 * t432 * t106 + 0.2e1 * t311 * t143 - 0.4e1 * t317 * t374 * t437 + 0.2e1 * t104 * t360 * t105 - 0.4e1 * t104 * t366 * t444 - 0.2e1 * t104 * t128 * t328 + 0.4e1 * t332 * t374 * t451 - t109 * t339 * t148 * t116 / 0.24e2 + t109 * t111 * t461 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t465 * t4 + t152 * t122 / 0.3e1;

  t470 = my_piecewise3(t19, t55, -0.5e1 / 0.18e2 * t14);
  t471 = t470 * t68;
  t477 = t154 * t219 * t72;
  t478 = t54 * t477;
  t482 = t154 * t228 * t231;
  t483 = t226 * t482;
  t494 = t81 * t168;
  t497 = t85 * t470;
  t500 = t160 * t270;
  t504 = t274 * t154 * t276;
  t525 = t54 * t167 * t102;
  t545 = -0.2e1 / 0.3e1 * t54 * t471 * t72 * t82 + 0.4e1 / 0.3e1 * t478 * t370 - 0.2e1 / 0.3e1 * t483 * t377 + 0.2e1 / 0.3e1 * t157 * t252 - 0.4e1 / 0.3e1 * t483 * t383 - 0.2e1 / 0.3e1 * t157 * t260 + 0.8e1 / 0.3e1 * t483 * t390 - 0.2e1 / 0.3e1 * t74 * t494 - 0.2e1 * t3 * t25 * (t497 * t87 * t89 - 0.2e1 * t500 * t401 - t504 * t406 / 0.3e1 - t161 * t282 + 0.2e1 * t504 * t410 + 0.2e1 / 0.3e1 * t504 * t414 - t497 * t68 * t94 / 0.2e1 + t500 * t420 + t161 * t299 / 0.2e1 - t504 * t424) * t32 + 0.2e1 * t525 * t106 + 0.2e1 * t311 * t171 - 0.4e1 * t317 * t482 * t437 + 0.2e1 * t104 * t471 * t105 - 0.4e1 * t104 * t477 * t444 - 0.2e1 * t104 * t156 * t328 + 0.4e1 * t332 * t482 * t451;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = t545 * t4 + t174 * t122 / 0.3e1;

  t550 = my_piecewise3(t19, t55, 0.88888888888888888889e0 * t14);
  t551 = t550 * t68;
  t557 = t176 * t219 * t72;
  t558 = t54 * t557;
  t562 = t176 * t228 * t231;
  t563 = t226 * t562;
  t574 = t81 * t190;
  t577 = t85 * t550;
  t580 = t182 * t270;
  t584 = t274 * t176 * t276;
  t605 = t54 * t189 * t102;
  t630 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t14, 0);
  t634 = -0.2e1 / 0.3e1 * t54 * t551 * t72 * t82 + 0.4e1 / 0.3e1 * t558 * t370 - 0.2e1 / 0.3e1 * t563 * t377 + 0.2e1 / 0.3e1 * t179 * t252 - 0.4e1 / 0.3e1 * t563 * t383 - 0.2e1 / 0.3e1 * t179 * t260 + 0.8e1 / 0.3e1 * t563 * t390 - 0.2e1 / 0.3e1 * t74 * t574 - 0.2e1 * t3 * t25 * (t577 * t87 * t89 - 0.2e1 * t580 * t401 - t584 * t406 / 0.3e1 - t183 * t282 + 0.2e1 * t584 * t410 + 0.2e1 / 0.3e1 * t584 * t414 - t577 * t68 * t94 / 0.2e1 + t580 * t420 + t183 * t299 / 0.2e1 - t584 * t424) * t32 + 0.2e1 * t605 * t106 + 0.2e1 * t311 * t193 - 0.4e1 * t317 * t562 * t437 + 0.2e1 * t104 * t551 * t105 - 0.4e1 * t104 * t557 * t444 - 0.2e1 * t104 * t178 * t328 + 0.4e1 * t332 * t562 * t451 - t109 * t339 * t196 * t116 / 0.24e2 + t109 * t111 * t630 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t634 * t4 + t200 * t122 / 0.3e1;

  t638 = my_piecewise3(t19, t55, 0);
  t639 = t638 * t68;
  t643 = 0.2e1 / 0.3e1 * t54 * t639 * t72 * t82;
  t644 = t126 * t126;
  t645 = t644 * t219;
  t650 = t644 * t228;
  t652 = t226 * t650 * t231;
  t659 = 0.2e1 * t244 * t126 * t246 - 0.2e1 * t135 * t105;
  t661 = t242 * t243 * t659;
  t670 = t85 * t638;
  t672 = t670 * t87 * t89;
  t673 = t85 * t644;
  t677 = t274 * t644;
  t678 = t677 * t276;
  t682 = t241 * t29 * t659;
  t686 = t677 * t228;
  t691 = t670 * t68 * t94 / 0.2e1;
  t695 = t241 * t26 * t659;
  t711 = 0.2e1 * t104 * t639 * t105;
  t715 = t241 * t659;
  t722 = t148 * t148;
  t726 = my_piecewise3(t47, 0, 0);
  t729 = t109 * t111 * t726 / 0.12e2;
  t730 = -t643 + 0.4e1 / 0.3e1 * t54 * t645 * t72 * t82 - 0.2e1 / 0.3e1 * t652 * t238 + 0.2e1 / 0.3e1 * t129 * t661 - 0.4e1 / 0.3e1 * t652 * t257 - 0.4e1 / 0.3e1 * t129 * t393 + 0.8e1 / 0.3e1 * t652 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t673 * t270 * t89 - t678 * t278 / 0.3e1 - t133 * t682 + 0.2e1 * t678 * t284 + 0.2e1 / 0.3e1 * t686 * t290 - t691 + t673 * t219 * t94 + t133 * t695 / 0.2e1 - t686 * t303) * t32 + 0.4e1 * t432 * t143 - 0.4e1 * t317 * t650 * t318 + t711 - 0.4e1 * t104 * t645 * t105 - 0.2e1 * t104 * t128 * t715 + 0.4e1 * t332 * t650 * t333 - t109 * t339 * t722 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t730 * t4;

  t731 = t243 * t126;
  t732 = t368 * t731;
  t735 = t376 * t731;
  t740 = t382 * t731;
  t746 = t376 * t388 * t126;
  t751 = t29 * t126;
  t752 = t81 * t751;
  t755 = t237 * t751;
  t759 = t256 * t751;
  t762 = t26 * t126;
  t763 = t237 * t762;
  t766 = t81 * t762;
  t770 = t256 * t762;
  t781 = t237 * t126;
  t785 = t81 * t126;
  t792 = t256 * t126;
  t796 = -t643 + 0.4e1 / 0.3e1 * t478 * t732 - 0.2e1 / 0.3e1 * t483 * t735 + 0.2e1 / 0.3e1 * t157 * t661 - 0.4e1 / 0.3e1 * t483 * t740 - 0.2e1 / 0.3e1 * t157 * t393 + 0.8e1 / 0.3e1 * t483 * t746 - 0.2e1 / 0.3e1 * t129 * t494 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t500 * t752 - t504 * t755 / 0.3e1 - t161 * t682 + 0.2e1 * t504 * t759 + 0.2e1 / 0.3e1 * t504 * t763 - t691 + t500 * t766 + t161 * t695 / 0.2e1 - t504 * t770) * t32 + 0.2e1 * t525 * t143 + 0.2e1 * t432 * t171 - 0.4e1 * t317 * t482 * t781 + t711 - 0.4e1 * t104 * t477 * t785 - 0.2e1 * t104 * t156 * t715 + 0.4e1 * t332 * t482 * t792;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = t796 * t4;

  t849 = -t643 + 0.4e1 / 0.3e1 * t558 * t732 - 0.2e1 / 0.3e1 * t563 * t735 + 0.2e1 / 0.3e1 * t179 * t661 - 0.4e1 / 0.3e1 * t563 * t740 - 0.2e1 / 0.3e1 * t179 * t393 + 0.8e1 / 0.3e1 * t563 * t746 - 0.2e1 / 0.3e1 * t129 * t574 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t580 * t752 - t584 * t755 / 0.3e1 - t183 * t682 + 0.2e1 * t584 * t759 + 0.2e1 / 0.3e1 * t584 * t763 - t691 + t580 * t766 + t183 * t695 / 0.2e1 - t584 * t770) * t32 + 0.2e1 * t605 * t143 + 0.2e1 * t432 * t193 - 0.4e1 * t317 * t562 * t781 + t711 - 0.4e1 * t104 * t557 * t785 - 0.2e1 * t104 * t178 * t715 + 0.4e1 * t332 * t562 * t792 - t109 * t339 * t196 * t148 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = t849 * t4;

  t850 = t154 * t154;
  t851 = t850 * t219;
  t856 = t850 * t228;
  t858 = t226 * t856 * t231;
  t865 = 0.2e1 * t244 * t154 * t246 - 0.2e1 * t163 * t105;
  t867 = t242 * t243 * t865;
  t876 = t85 * t850;
  t880 = t274 * t850;
  t881 = t880 * t276;
  t885 = t241 * t29 * t865;
  t889 = t880 * t228;
  t895 = t241 * t26 * t865;
  t912 = t241 * t865;
  t919 = -t643 + 0.4e1 / 0.3e1 * t54 * t851 * t72 * t82 - 0.2e1 / 0.3e1 * t858 * t238 + 0.2e1 / 0.3e1 * t157 * t867 - 0.4e1 / 0.3e1 * t858 * t257 - 0.4e1 / 0.3e1 * t157 * t494 + 0.8e1 / 0.3e1 * t858 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t876 * t270 * t89 - t881 * t278 / 0.3e1 - t161 * t885 + 0.2e1 * t881 * t284 + 0.2e1 / 0.3e1 * t889 * t290 - t691 + t876 * t219 * t94 + t161 * t895 / 0.2e1 - t889 * t303) * t32 + 0.4e1 * t525 * t171 - 0.4e1 * t317 * t856 * t318 + t711 - 0.4e1 * t104 * t851 * t105 - 0.2e1 * t104 * t156 * t912 + 0.4e1 * t332 * t856 * t333;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = t919 * t4;

  t920 = t243 * t154;
  t940 = t29 * t154;
  t951 = t26 * t154;
  t985 = -t643 + 0.4e1 / 0.3e1 * t558 * t368 * t920 - 0.2e1 / 0.3e1 * t563 * t376 * t920 + 0.2e1 / 0.3e1 * t179 * t867 - 0.4e1 / 0.3e1 * t563 * t382 * t920 - 0.2e1 / 0.3e1 * t179 * t494 + 0.8e1 / 0.3e1 * t563 * t376 * t388 * t154 - 0.2e1 / 0.3e1 * t157 * t574 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t580 * t81 * t940 - t584 * t237 * t940 / 0.3e1 - t183 * t885 + 0.2e1 * t584 * t256 * t940 + 0.2e1 / 0.3e1 * t584 * t237 * t951 - t691 + t580 * t81 * t951 + t183 * t895 / 0.2e1 - t584 * t256 * t951) * t32 + 0.2e1 * t605 * t171 + 0.2e1 * t525 * t193 - 0.4e1 * t317 * t562 * t237 * t154 + t711 - 0.4e1 * t104 * t557 * t81 * t154 - 0.2e1 * t104 * t178 * t912 + 0.4e1 * t332 * t562 * t256 * t154;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = t985 * t4;

  t986 = t176 * t176;
  t987 = t986 * t219;
  t992 = t986 * t228;
  t994 = t226 * t992 * t231;
  t1001 = 0.2e1 * t244 * t176 * t246 - 0.2e1 * t185 * t105;
  t1012 = t85 * t986;
  t1016 = t274 * t986;
  t1017 = t1016 * t276;
  t1025 = t1016 * t228;
  t1055 = t196 * t196;
  t1059 = -t643 + 0.4e1 / 0.3e1 * t54 * t987 * t72 * t82 - 0.2e1 / 0.3e1 * t994 * t238 + 0.2e1 / 0.3e1 * t179 * t242 * t243 * t1001 - 0.4e1 / 0.3e1 * t994 * t257 - 0.4e1 / 0.3e1 * t179 * t574 + 0.8e1 / 0.3e1 * t994 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t1012 * t270 * t89 - t1017 * t278 / 0.3e1 - t183 * t241 * t29 * t1001 + 0.2e1 * t1017 * t284 + 0.2e1 / 0.3e1 * t1025 * t290 - t691 + t1012 * t219 * t94 + t183 * t241 * t26 * t1001 / 0.2e1 - t1025 * t303) * t32 + 0.4e1 * t605 * t193 - 0.4e1 * t317 * t992 * t318 + t711 - 0.4e1 * t104 * t987 * t105 - 0.2e1 * t104 * t178 * t241 * t1001 + 0.4e1 * t332 * t992 * t333 - t109 * t339 * t1055 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t1059 * t4;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t7, t10, t12, t14;
  double t17, t18, t19, t20, t21, t22, t23, t25;
  double t26, t29, t30, t31, t32, t33, t38, t39;
  double t40, t41, t42, t43, t46, t47, t48, t49;
  double t54, t55, t56, t57, t58, t59, t60, t62;
  double t63, t65, t66, t68, t71, t73, t75, t78;
  double t79, t80, t81, t82, t83, t84, t86, t87;
  double t90, t91, t92, t93, t94, t99, t100, t101;
  double t102, t107, t108, t109, t111, t112, t114, t115;
  double t118, t122, t126, t127, t128, t129, t131, t132;
  double t133, t134, t135, t137, t138, t139, t140, t141;
  double t142, t145, t146, t147, t148, t149, t151, t152;
  double t154, t158, t159, t162, t163, t164, t165, t166;
  double t169, t171, t176, t181, t184, t185, t186, t187;
  double t188, t191, t192, t197, t198, t201, t202, t203;
  double t204, t207, t208, t210, t214, t215, t218, t223;
  double t228, t231, t232, t233, t234, t237, t238, t240;
  double t244, t245, t248, t252, t255, t256, t257, t258;
  double t261, t262, t264, t268, t269, t272, t275, t280;
  double t284, t286, t288, t292, t293, t298, t300, t301;
  double t307, t308, t309, t310, t311, t312, t314, t315;
  double t316, t317, t318, t319, t322, t323, t324, t325;
  double t327, t331, t333, t336, t337, t338, t341, t344;
  double t347, t350, t351, t355, t356, t357, t358, t359;
  double t363, t365, t368, t369, t371, t380, t384, t392;
  double t398, t399, t409, t413, t414, t420, t421, t429;
  double t433, t440, t441, t446, t447, t451, t452, t463;
  double t475, t476, t482, t484, t485, t486, t490, t491;
  double t492, t493, t498, t499, t504, t506, t509, t512;
  double t515, t516, t517, t521, t522, t526, t529, t530;
  double t536, t540, t548, t553, t560, t567, t577, t581;
  double t589, t590, t596, t597, t601, t602, t613, t616;
  double t619, t623, t644, t664, t672, t673, t679, t680;
  double t684, t685, t696, t699, t702, t706, t727, t752;
  double t756, t763, t764, t768, t769, t770, t775, t777;
  double t784, t786, t795, t797, t798, t802, t803, t807;
  double t811, t816, t820, t836, t840, t847, t851, t854;
  double t855, t858, t859, t862, t867, t873, t878, t879;
  double t882, t886, t889, t890, t893, t897, t908, t912;
  double t919, t923, t978, t981, t982, t987, t989, t996;
  double t998, t1007, t1011, t1012, t1016, t1020, t1026, t1043;
  double t1050, t1053, t1073, t1084, t1118, t1121, t1122, t1127;
  double t1129, t1136, t1147, t1151, t1152, t1160, t1190, t1194;
  double t1197, t1200, t1204, t1208, t1209, t1210, t1211, t1213;
  double t1214, t1215, t1216, t1217, t1219, t1220, t1221, t1222;
  double t1223, t1224, t1227, t1228, t1229, t1230, t1232, t1233;
  double t1235, t1239, t1240, t1243, t1244, t1245, t1246, t1247;
  double t1251, t1256, t1261, t1264, t1265, t1266, t1269, t1270;
  double t1274, t1275, t1276, t1277, t1280, t1281, t1283, t1287;
  double t1288, t1291, t1296, t1301, t1304, t1305, t1306, t1307;
  double t1310, t1311, t1313, t1317, t1318, t1321, t1325, t1328;
  double t1329, t1330, t1331, t1334, t1335, t1337, t1341, t1342;
  double t1345, t1348, t1353, t1357, t1359, t1361, t1365, t1366;
  double t1371, t1373, t1374, t1379, t1380, t1381, t1382, t1383;
  double t1385, t1386, t1387, t1388, t1389, t1390, t1393, t1394;
  double t1395, t1396, t1398, t1402, t1404, t1407, t1408, t1409;
  double t1412, t1415, t1418, t1421, t1422, t1426, t1427, t1428;
  double t1429, t1433, t1435, t1438, t1439, t1441, t1450, t1454;
  double t1462, t1468, t1469, t1479, t1483, t1484, t1490, t1491;
  double t1499, t1503, t1511, t1525, t1526, t1532, t1534, t1535;
  double t1536, t1540, t1541, t1542, t1543, t1548, t1549, t1554;
  double t1556, t1559, t1562, t1565, t1566, t1567, t1571, t1572;
  double t1576, t1579, t1580, t1586, t1590, t1598, t1603, t1610;
  double t1617, t1627, t1631, t1638, t1639, t1645, t1646, t1650;
  double t1651, t1662, t1665, t1668, t1672, t1693, t1718, t1722;
  double t1729, t1730, t1736, t1737, t1741, t1742, t1753, t1756;
  double t1759, t1763, t1784, t1804, t1810, t1811, t1815, t1816;
  double t1817, t1822, t1824, t1831, t1833, t1842, t1844, t1845;
  double t1849, t1850, t1854, t1858, t1863, t1867, t1883, t1887;
  double t1894, t1898, t1901, t1902, t1905, t1906, t1909, t1914;
  double t1920, t1925, t1926, t1929, t1933, t1936, t1937, t1940;
  double t1944, t1955, t1959, t1966, t1970, t2025, t2028, t2029;
  double t2034, t2036, t2043, t2045, t2054, t2058, t2059, t2063;
  double t2067, t2073, t2090, t2097, t2100, t2120, t2131, t2165;
  double t2168, t2169, t2174, t2176, t2183, t2194, t2198, t2199;
  double t2207, t2237, t2241;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * t4;
  t7 = 0.1e1 / t5 / rho[0];
  t10 = tau[0] * t7;
  t12 = rho[0] * rho[0];
  t14 = 0.1e1 / t5 / t12;
  t17 = lapl[0] * t7 / 0.6e1 - 0.53333333333333333333e0 * t10 + 0.66666666666666666667e-1 * sigma[0] * t14;
  t18 = fabs(t17);
  t19 = t18 < 0.50e-12;
  t20 = 0.0e0 < t17;
  t21 = my_piecewise3(t20, 0.50e-12, -0.50e-12);
  t22 = my_piecewise3(t19, t21, t17);
  t23 = xc_mgga_x_br89_get_x(t22);
  t25 = exp(t23 / 0.3e1);
  t26 = exp(-t23);
  t29 = t26 * (0.1e1 + t23 / 0.2e1);
  t30 = 0.1e1 - t29;
  t31 = t25 * t30;
  t32 = 0.1e1 / t23;
  t33 = t31 * t32;
  t38 = sqrt(0.15e2);
  t39 = (0.3e1 * params->c - 0.2e1) * t38;
  t40 = 0.1e1 / M_PI;
  t41 = M_SQRT2;
  t42 = t40 * t41;
  t43 = params->alpha * sigma[0];
  t46 = t10 - t43 * t14 / 0.8e1;
  t47 = 0.1e-9 < t46;
  t48 = my_piecewise3(t47, t46, 0.1e-9);
  t49 = sqrt(t48);
  t54 = M_CBRT2;
  t55 = t54 * t54;
  t56 = (-0.2e1 * t3 * t33 + t39 * t42 * t49 / 0.6e1) * t55;
  t57 = rho[0] - rho[1];
  t58 = rho[0] + rho[1];
  t59 = 0.1e1 / t58;
  t60 = t57 * t59;
  t62 = (0.1e1 + t60) * t58;
  t63 = POW_1_3(t62);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t56 * t63 / 0.2e1;

  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / rho[1];
  t71 = tau[1] * t68;
  t73 = rho[1] * rho[1];
  t75 = 0.1e1 / t66 / t73;
  t78 = lapl[1] * t68 / 0.6e1 - 0.53333333333333333333e0 * t71 + 0.66666666666666666667e-1 * sigma[0] * t75;
  t79 = fabs(t78);
  t80 = t79 < 0.50e-12;
  t81 = 0.0e0 < t78;
  t82 = my_piecewise3(t81, 0.50e-12, -0.50e-12);
  t83 = my_piecewise3(t80, t82, t78);
  t84 = xc_mgga_x_br89_get_x(t83);
  t86 = exp(t84 / 0.3e1);
  t87 = exp(-t84);
  t90 = t87 * (0.1e1 + t84 / 0.2e1);
  t91 = 0.1e1 - t90;
  t92 = t86 * t91;
  t93 = 0.1e1 / t84;
  t94 = t92 * t93;
  t99 = t71 - t43 * t75 / 0.8e1;
  t100 = 0.1e-9 < t99;
  t101 = my_piecewise3(t100, t99, 0.1e-9);
  t102 = sqrt(t101);
  t107 = (-0.2e1 * t3 * t94 + t39 * t42 * t102 / 0.6e1) * t55;
  t108 = -t57;
  t109 = t108 * t59;
  t111 = (0.1e1 + t109) * t58;
  t112 = POW_1_3(t111);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t107 * t112 / 0.2e1;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t114 = params->c * M_PI;
  t115 = my_piecewise3(t20, 0, 0);
  t118 = tau[0] * t14;
  t122 = 0.1e1 / t5 / t12 / rho[0];
  t126 = my_piecewise3(t19, t115, -0.5e1 / 0.18e2 * lapl[0] * t14 + 0.88888888888888888889e0 * t118 - 0.17777777777777777778e0 * sigma[0] * t122);
  t127 = t22 * t22;
  t128 = 0.1e1 / t127;
  t129 = t126 * t128;
  t131 = exp(-0.2e1 / 0.3e1 * t23);
  t132 = 0.1e1 / t131;
  t133 = t129 * t132;
  t134 = t114 * t133;
  t135 = t23 * t23;
  t137 = t135 - 0.2e1 * t23 + 0.3e1;
  t138 = 0.1e1 / t137;
  t139 = t23 - 0.2e1;
  t140 = t139 * t139;
  t141 = t138 * t140;
  t142 = t141 * t33;
  t145 = t2 * t2;
  t146 = t145 * t126;
  t147 = t128 * t132;
  t148 = t146 * t147;
  t149 = t141 * t29;
  t151 = t146 * t128;
  t152 = t132 * t138;
  t154 = t152 * t140 * t26;
  t158 = t25 * (t148 * t149 - t151 * t154 / 0.2e1);
  t159 = t158 * t32;
  t162 = 0.1e1 / t135;
  t163 = t31 * t162;
  t164 = t114 * t163;
  t165 = t152 * t140;
  t166 = t129 * t165;
  t169 = t39 * t40;
  t171 = t41 / t49;
  t176 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t118 + t43 * t122 / 0.3e1, 0);
  t181 = (-0.2e1 / 0.3e1 * t134 * t142 - 0.2e1 * t3 * t159 + 0.2e1 * t164 * t166 + t169 * t171 * t176 / 0.12e2) * t55;
  t184 = t63 * t63;
  t185 = 0.1e1 / t184;
  t186 = t58 * t58;
  t187 = 0.1e1 / t186;
  t188 = t57 * t187;
  t191 = (t59 - t188) * t58 + 0.1e1 + t60;
  t192 = t185 * t191;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t181 * t63 / 0.2e1 + t56 * t192 / 0.6e1;

  t197 = (-t59 - t188) * t58 + 0.1e1 + t60;
  t198 = t185 * t197;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t56 * t198 / 0.6e1;

  t201 = my_piecewise3(t19, t115, 0.66666666666666666667e-1 * t14);
  t202 = t201 * t128;
  t203 = t202 * t132;
  t204 = t114 * t203;
  t207 = t145 * t201;
  t208 = t207 * t147;
  t210 = t207 * t128;
  t214 = t25 * (t208 * t149 - t210 * t154 / 0.2e1);
  t215 = t214 * t32;
  t218 = t202 * t165;
  t223 = my_piecewise3(t47, -params->alpha * t14 / 0.8e1, 0);
  t228 = (-0.2e1 / 0.3e1 * t204 * t142 - 0.2e1 * t3 * t215 + 0.2e1 * t164 * t218 + t169 * t171 * t223 / 0.12e2) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t228 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = 0.0e0;

  t231 = my_piecewise3(t19, t115, t7 / 0.6e1);
  t232 = t231 * t128;
  t233 = t232 * t132;
  t234 = t114 * t233;
  t237 = t145 * t231;
  t238 = t237 * t147;
  t240 = t237 * t128;
  t244 = t25 * (t238 * t149 - t240 * t154 / 0.2e1);
  t245 = t244 * t32;
  t248 = t232 * t165;
  t252 = (-0.2e1 / 0.3e1 * t234 * t142 - 0.2e1 * t3 * t245 + 0.2e1 * t164 * t248) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t252 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = 0.0e0;

  t255 = my_piecewise3(t19, t115, -0.53333333333333333333e0 * t7);
  t256 = t255 * t128;
  t257 = t256 * t132;
  t258 = t114 * t257;
  t261 = t145 * t255;
  t262 = t261 * t147;
  t264 = t261 * t128;
  t268 = t25 * (t262 * t149 - t264 * t154 / 0.2e1);
  t269 = t268 * t32;
  t272 = t256 * t165;
  t275 = my_piecewise3(t47, t7, 0);
  t280 = (-0.2e1 / 0.3e1 * t258 * t142 - 0.2e1 * t3 * t269 + 0.2e1 * t164 * t272 + t169 * t171 * t275 / 0.12e2) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t280 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = 0.0e0;

  t284 = tau[0] * t122;
  t286 = t12 * t12;
  t288 = 0.1e1 / t5 / t286;
  t292 = my_piecewise3(t19, t115, 0.20e2 / 0.27e2 * lapl[0] * t122 - 0.23703703703703703704e1 * t284 + 0.65185185185185185186e0 * sigma[0] * t288);
  t293 = t292 * t128;
  t298 = t126 * t126;
  t300 = 0.1e1 / t127 / t22;
  t301 = t298 * t300;
  t307 = params->c * t145 * M_PI;
  t308 = t127 * t127;
  t309 = 0.1e1 / t308;
  t310 = t298 * t309;
  t311 = t131 * t131;
  t312 = 0.1e1 / t311;
  t314 = t307 * t310 * t312;
  t315 = t137 * t137;
  t316 = 0.1e1 / t315;
  t317 = t140 * t140;
  t318 = t316 * t317;
  t319 = t318 * t33;
  t322 = t316 * t140;
  t323 = t322 * t25;
  t324 = t30 * t32;
  t325 = t23 * t145;
  t327 = t147 * t141;
  t331 = 0.2e1 * t325 * t126 * t327 - 0.2e1 * t151 * t165;
  t333 = t323 * t324 * t331;
  t336 = t140 * t139;
  t337 = t316 * t336;
  t338 = t337 * t33;
  t341 = t141 * t159;
  t344 = t318 * t163;
  t347 = t145 * t292;
  t350 = t145 * t298;
  t351 = t300 * t132;
  t355 = t2 * M_PI;
  t356 = t355 * t298;
  t357 = t309 * t312;
  t358 = t356 * t357;
  t359 = t318 * t29;
  t363 = t322 * t29 * t331;
  t365 = t337 * t29;
  t368 = t356 * t309;
  t369 = t312 * t316;
  t371 = t369 * t317 * t26;
  t380 = t322 * t26 * t331;
  t384 = t369 * t336 * t26;
  t392 = t114 * t158 * t162;
  t398 = t307 * t31 / t135 / t23;
  t399 = t369 * t317;
  t409 = t322 * t331;
  t413 = t307 * t163;
  t414 = t369 * t336;
  t420 = t41 / t49 / t48;
  t421 = t176 * t176;
  t429 = my_piecewise3(t47, 0.40e2 / 0.9e1 * t284 - 0.11e2 / 0.9e1 * t43 * t288, 0);
  t433 = -0.2e1 / 0.3e1 * t114 * t293 * t132 * t142 + 0.4e1 / 0.3e1 * t114 * t301 * t132 * t142 - 0.2e1 / 0.3e1 * t314 * t319 + 0.2e1 / 0.3e1 * t134 * t333 - 0.4e1 / 0.3e1 * t314 * t338 - 0.4e1 / 0.3e1 * t134 * t341 + 0.8e1 / 0.3e1 * t314 * t344 - 0.2e1 * t3 * t25 * (t347 * t147 * t149 - 0.2e1 * t350 * t351 * t149 - t358 * t359 / 0.3e1 - t148 * t363 + 0.2e1 * t358 * t365 + 0.2e1 / 0.3e1 * t368 * t371 - t347 * t128 * t154 / 0.2e1 + t350 * t300 * t154 + t148 * t380 / 0.2e1 - t368 * t384) * t32 + 0.4e1 * t392 * t166 - 0.4e1 * t398 * t310 * t399 + 0.2e1 * t164 * t293 * t165 - 0.4e1 * t164 * t301 * t165 - 0.2e1 * t164 * t133 * t409 + 0.4e1 * t413 * t310 * t414 - t169 * t420 * t421 / 0.24e2 + t169 * t171 * t429 / 0.12e2;
  t440 = 0.1e1 / t184 / t62;
  t441 = t191 * t191;
  t446 = 0.1e1 / t186 / t58;
  t447 = t57 * t446;
  t451 = 0.2e1 * t59;
  t452 = 0.2e1 * t188;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho3[0] = t433 * t55 * t63 / 0.2e1 + t181 * t192 / 0.3e1 - t56 * t440 * t441 / 0.9e1 + t56 * t185 * ((-0.2e1 * t187 + 0.2e1 * t447) * t58 + t451 - t452) / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho3[1] = t181 * t198 / 0.6e1 - t56 * t440 * t197 * t191 / 0.9e1;

  t463 = t197 * t197;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho3[2] = -t56 * t440 * t463 / 0.9e1 + t56 * t185 * ((0.2e1 * t187 + 0.2e1 * t447) * t58 - t451 - t452) / 0.6e1;

  t475 = my_piecewise3(t19, t115, -0.17777777777777777778e0 * t122);
  t476 = t475 * t128;
  t482 = t201 * t300 * t132;
  t484 = t141 * t25;
  t485 = t324 * t126;
  t486 = t484 * t485;
  t490 = t201 * t309 * t312;
  t491 = t307 * t490;
  t492 = t318 * t25;
  t493 = t492 * t485;
  t498 = t337 * t25;
  t499 = t498 * t485;
  t504 = t30 * t162;
  t506 = t492 * t504 * t126;
  t509 = t141 * t215;
  t512 = t145 * t475;
  t515 = t207 * t351;
  t516 = t29 * t126;
  t517 = t141 * t516;
  t521 = t355 * t201 * t357;
  t522 = t318 * t516;
  t526 = t337 * t516;
  t529 = t26 * t126;
  t530 = t318 * t529;
  t536 = t141 * t529;
  t540 = t337 * t529;
  t548 = t114 * t214 * t162;
  t553 = t318 * t126;
  t560 = t141 * t126;
  t567 = t337 * t126;
  t577 = my_piecewise3(t47, params->alpha * t122 / 0.3e1, 0);
  t581 = -0.2e1 / 0.3e1 * t114 * t476 * t132 * t142 + 0.4e1 / 0.3e1 * t114 * t482 * t486 - 0.2e1 / 0.3e1 * t491 * t493 + 0.2e1 / 0.3e1 * t204 * t333 - 0.4e1 / 0.3e1 * t491 * t499 - 0.2e1 / 0.3e1 * t204 * t341 + 0.8e1 / 0.3e1 * t491 * t506 - 0.2e1 / 0.3e1 * t134 * t509 - 0.2e1 * t3 * t25 * (t512 * t147 * t149 - 0.2e1 * t515 * t517 - t521 * t522 / 0.3e1 - t208 * t363 + 0.2e1 * t521 * t526 + 0.2e1 / 0.3e1 * t521 * t530 - t512 * t128 * t154 / 0.2e1 + t515 * t536 + t208 * t380 / 0.2e1 - t521 * t540) * t32 + 0.2e1 * t548 * t166 + 0.2e1 * t392 * t218 - 0.4e1 * t398 * t490 * t553 + 0.2e1 * t164 * t476 * t165 - 0.4e1 * t164 * t482 * t560 - 0.2e1 * t164 * t203 * t409 + 0.4e1 * t413 * t490 * t567 - t169 * t420 * t223 * t176 / 0.24e2 + t169 * t171 * t577 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[0] = t581 * t55 * t63 / 0.2e1 + t228 * t192 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[3] = t228 * t198 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2sigma[5] = 0.0e0;

  t589 = my_piecewise3(t19, t115, -0.5e1 / 0.18e2 * t14);
  t590 = t589 * t128;
  t596 = t231 * t300 * t132;
  t597 = t114 * t596;
  t601 = t231 * t309 * t312;
  t602 = t307 * t601;
  t613 = t141 * t245;
  t616 = t145 * t589;
  t619 = t237 * t351;
  t623 = t355 * t231 * t357;
  t644 = t114 * t244 * t162;
  t664 = -0.2e1 / 0.3e1 * t114 * t590 * t132 * t142 + 0.4e1 / 0.3e1 * t597 * t486 - 0.2e1 / 0.3e1 * t602 * t493 + 0.2e1 / 0.3e1 * t234 * t333 - 0.4e1 / 0.3e1 * t602 * t499 - 0.2e1 / 0.3e1 * t234 * t341 + 0.8e1 / 0.3e1 * t602 * t506 - 0.2e1 / 0.3e1 * t134 * t613 - 0.2e1 * t3 * t25 * (t616 * t147 * t149 - 0.2e1 * t619 * t517 - t623 * t522 / 0.3e1 - t238 * t363 + 0.2e1 * t623 * t526 + 0.2e1 / 0.3e1 * t623 * t530 - t616 * t128 * t154 / 0.2e1 + t619 * t536 + t238 * t380 / 0.2e1 - t623 * t540) * t32 + 0.2e1 * t644 * t166 + 0.2e1 * t392 * t248 - 0.4e1 * t398 * t601 * t553 + 0.2e1 * t164 * t590 * t165 - 0.4e1 * t164 * t596 * t560 - 0.2e1 * t164 * t233 * t409 + 0.4e1 * t413 * t601 * t567;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2lapl[0] = t664 * t55 * t63 / 0.2e1 + t252 * t192 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2lapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2lapl[2] = t252 * t198 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2lapl[3] = 0.0e0;

  t672 = my_piecewise3(t19, t115, 0.88888888888888888889e0 * t14);
  t673 = t672 * t128;
  t679 = t255 * t300 * t132;
  t680 = t114 * t679;
  t684 = t255 * t309 * t312;
  t685 = t307 * t684;
  t696 = t141 * t269;
  t699 = t145 * t672;
  t702 = t261 * t351;
  t706 = t355 * t255 * t357;
  t727 = t114 * t268 * t162;
  t752 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t14, 0);
  t756 = -0.2e1 / 0.3e1 * t114 * t673 * t132 * t142 + 0.4e1 / 0.3e1 * t680 * t486 - 0.2e1 / 0.3e1 * t685 * t493 + 0.2e1 / 0.3e1 * t258 * t333 - 0.4e1 / 0.3e1 * t685 * t499 - 0.2e1 / 0.3e1 * t258 * t341 + 0.8e1 / 0.3e1 * t685 * t506 - 0.2e1 / 0.3e1 * t134 * t696 - 0.2e1 * t3 * t25 * (t699 * t147 * t149 - 0.2e1 * t702 * t517 - t706 * t522 / 0.3e1 - t262 * t363 + 0.2e1 * t706 * t526 + 0.2e1 / 0.3e1 * t706 * t530 - t699 * t128 * t154 / 0.2e1 + t702 * t536 + t262 * t380 / 0.2e1 - t706 * t540) * t32 + 0.2e1 * t727 * t166 + 0.2e1 * t392 * t272 - 0.4e1 * t398 * t684 * t553 + 0.2e1 * t164 * t673 * t165 - 0.4e1 * t164 * t679 * t560 - 0.2e1 * t164 * t257 * t409 + 0.4e1 * t413 * t684 * t567 - t169 * t420 * t275 * t176 / 0.24e2 + t169 * t171 * t752 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2tau[0] = t756 * t55 * t63 / 0.2e1 + t280 * t192 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2tau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2tau[2] = t280 * t198 / 0.6e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rho2tau[3] = 0.0e0;

  t763 = my_piecewise3(t19, t115, 0);
  t764 = t763 * t128;
  t768 = 0.2e1 / 0.3e1 * t114 * t764 * t132 * t142;
  t769 = t201 * t201;
  t770 = t769 * t300;
  t775 = t769 * t309;
  t777 = t307 * t775 * t312;
  t784 = 0.2e1 * t325 * t201 * t327 - 0.2e1 * t210 * t165;
  t786 = t323 * t324 * t784;
  t795 = t145 * t763;
  t797 = t795 * t147 * t149;
  t798 = t145 * t769;
  t802 = t355 * t769;
  t803 = t802 * t357;
  t807 = t322 * t29 * t784;
  t811 = t802 * t309;
  t816 = t795 * t128 * t154 / 0.2e1;
  t820 = t322 * t26 * t784;
  t836 = 0.2e1 * t164 * t764 * t165;
  t840 = t322 * t784;
  t847 = t223 * t223;
  t851 = my_piecewise3(t47, 0, 0);
  t854 = t169 * t171 * t851 / 0.12e2;
  t855 = -t768 + 0.4e1 / 0.3e1 * t114 * t770 * t132 * t142 - 0.2e1 / 0.3e1 * t777 * t319 + 0.2e1 / 0.3e1 * t204 * t786 - 0.4e1 / 0.3e1 * t777 * t338 - 0.4e1 / 0.3e1 * t204 * t509 + 0.8e1 / 0.3e1 * t777 * t344 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t798 * t351 * t149 - t803 * t359 / 0.3e1 - t208 * t807 + 0.2e1 * t803 * t365 + 0.2e1 / 0.3e1 * t811 * t371 - t816 + t798 * t300 * t154 + t208 * t820 / 0.2e1 - t811 * t384) * t32 + 0.4e1 * t548 * t218 - 0.4e1 * t398 * t775 * t399 + t836 - 0.4e1 * t164 * t770 * t165 - 0.2e1 * t164 * t203 * t840 + 0.4e1 * t413 * t775 * t414 - t169 * t420 * t847 / 0.24e2 + t854;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[0] = t855 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigma2[5] = 0.0e0;

  t858 = t324 * t201;
  t859 = t484 * t858;
  t862 = t492 * t858;
  t867 = t498 * t858;
  t873 = t492 * t504 * t201;
  t878 = t29 * t201;
  t879 = t141 * t878;
  t882 = t318 * t878;
  t886 = t337 * t878;
  t889 = t26 * t201;
  t890 = t318 * t889;
  t893 = t141 * t889;
  t897 = t337 * t889;
  t908 = t318 * t201;
  t912 = t141 * t201;
  t919 = t337 * t201;
  t923 = -t768 + 0.4e1 / 0.3e1 * t597 * t859 - 0.2e1 / 0.3e1 * t602 * t862 + 0.2e1 / 0.3e1 * t234 * t786 - 0.4e1 / 0.3e1 * t602 * t867 - 0.2e1 / 0.3e1 * t234 * t509 + 0.8e1 / 0.3e1 * t602 * t873 - 0.2e1 / 0.3e1 * t204 * t613 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t619 * t879 - t623 * t882 / 0.3e1 - t238 * t807 + 0.2e1 * t623 * t886 + 0.2e1 / 0.3e1 * t623 * t890 - t816 + t619 * t893 + t238 * t820 / 0.2e1 - t623 * t897) * t32 + 0.2e1 * t644 * t218 + 0.2e1 * t548 * t248 - 0.4e1 * t398 * t601 * t908 + t836 - 0.4e1 * t164 * t596 * t912 - 0.2e1 * t164 * t233 * t840 + 0.4e1 * t413 * t601 * t919;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[0] = t923 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmalapl[5] = 0.0e0;

  t978 = -t768 + 0.4e1 / 0.3e1 * t680 * t859 - 0.2e1 / 0.3e1 * t685 * t862 + 0.2e1 / 0.3e1 * t258 * t786 - 0.4e1 / 0.3e1 * t685 * t867 - 0.2e1 / 0.3e1 * t258 * t509 + 0.8e1 / 0.3e1 * t685 * t873 - 0.2e1 / 0.3e1 * t204 * t696 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t702 * t879 - t706 * t882 / 0.3e1 - t262 * t807 + 0.2e1 * t706 * t886 + 0.2e1 / 0.3e1 * t706 * t890 - t816 + t702 * t893 + t262 * t820 / 0.2e1 - t706 * t897) * t32 + 0.2e1 * t727 * t218 + 0.2e1 * t548 * t272 - 0.4e1 * t398 * t684 * t908 + t836 - 0.4e1 * t164 * t679 * t912 - 0.2e1 * t164 * t257 * t840 + 0.4e1 * t413 * t684 * t919 - t169 * t420 * t275 * t223 / 0.24e2 + t854;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[0] = t978 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhosigmatau[5] = 0.0e0;

  t981 = t231 * t231;
  t982 = t981 * t300;
  t987 = t981 * t309;
  t989 = t307 * t987 * t312;
  t996 = 0.2e1 * t325 * t231 * t327 - 0.2e1 * t240 * t165;
  t998 = t323 * t324 * t996;
  t1007 = t145 * t981;
  t1011 = t355 * t981;
  t1012 = t1011 * t357;
  t1016 = t322 * t29 * t996;
  t1020 = t1011 * t309;
  t1026 = t322 * t26 * t996;
  t1043 = t322 * t996;
  t1050 = -t768 + 0.4e1 / 0.3e1 * t114 * t982 * t132 * t142 - 0.2e1 / 0.3e1 * t989 * t319 + 0.2e1 / 0.3e1 * t234 * t998 - 0.4e1 / 0.3e1 * t989 * t338 - 0.4e1 / 0.3e1 * t234 * t613 + 0.8e1 / 0.3e1 * t989 * t344 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t1007 * t351 * t149 - t1012 * t359 / 0.3e1 - t238 * t1016 + 0.2e1 * t1012 * t365 + 0.2e1 / 0.3e1 * t1020 * t371 - t816 + t1007 * t300 * t154 + t238 * t1026 / 0.2e1 - t1020 * t384) * t32 + 0.4e1 * t644 * t248 - 0.4e1 * t398 * t987 * t399 + t836 - 0.4e1 * t164 * t982 * t165 - 0.2e1 * t164 * t233 * t1043 + 0.4e1 * t413 * t987 * t414;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapl2[0] = t1050 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapl2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapl2[2] = 0.0e0;

  t1053 = t324 * t231;
  t1073 = t29 * t231;
  t1084 = t26 * t231;
  t1118 = -t768 + 0.4e1 / 0.3e1 * t680 * t484 * t1053 - 0.2e1 / 0.3e1 * t685 * t492 * t1053 + 0.2e1 / 0.3e1 * t258 * t998 - 0.4e1 / 0.3e1 * t685 * t498 * t1053 - 0.2e1 / 0.3e1 * t258 * t613 + 0.8e1 / 0.3e1 * t685 * t492 * t504 * t231 - 0.2e1 / 0.3e1 * t234 * t696 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t702 * t141 * t1073 - t706 * t318 * t1073 / 0.3e1 - t262 * t1016 + 0.2e1 * t706 * t337 * t1073 + 0.2e1 / 0.3e1 * t706 * t318 * t1084 - t816 + t702 * t141 * t1084 + t262 * t1026 / 0.2e1 - t706 * t337 * t1084) * t32 + 0.2e1 * t727 * t248 + 0.2e1 * t644 * t272 - 0.4e1 * t398 * t684 * t318 * t231 + t836 - 0.4e1 * t164 * t679 * t141 * t231 - 0.2e1 * t164 * t257 * t1043 + 0.4e1 * t413 * t684 * t337 * t231;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapltau[0] = t1118 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapltau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapltau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rholapltau[3] = 0.0e0;

  t1121 = t255 * t255;
  t1122 = t1121 * t300;
  t1127 = t1121 * t309;
  t1129 = t307 * t1127 * t312;
  t1136 = 0.2e1 * t325 * t255 * t327 - 0.2e1 * t264 * t165;
  t1147 = t145 * t1121;
  t1151 = t355 * t1121;
  t1152 = t1151 * t357;
  t1160 = t1151 * t309;
  t1190 = t275 * t275;
  t1194 = -t768 + 0.4e1 / 0.3e1 * t114 * t1122 * t132 * t142 - 0.2e1 / 0.3e1 * t1129 * t319 + 0.2e1 / 0.3e1 * t258 * t323 * t324 * t1136 - 0.4e1 / 0.3e1 * t1129 * t338 - 0.4e1 / 0.3e1 * t258 * t696 + 0.8e1 / 0.3e1 * t1129 * t344 - 0.2e1 * t3 * t25 * (t797 - 0.2e1 * t1147 * t351 * t149 - t1152 * t359 / 0.3e1 - t262 * t322 * t29 * t1136 + 0.2e1 * t1152 * t365 + 0.2e1 / 0.3e1 * t1160 * t371 - t816 + t1147 * t300 * t154 + t262 * t322 * t26 * t1136 / 0.2e1 - t1160 * t384) * t32 + 0.4e1 * t727 * t272 - 0.4e1 * t398 * t1127 * t399 + t836 - 0.4e1 * t164 * t1122 * t165 - 0.2e1 * t164 * t257 * t322 * t1136 + 0.4e1 * t413 * t1127 * t414 - t169 * t420 * t1190 / 0.24e2 + t854;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhotau2[0] = t1194 * t55 * t63 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhotau2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v3rhotau2[2] = 0.0e0;

  t1197 = my_piecewise3(t81, 0, 0);
  t1200 = tau[1] * t75;
  t1204 = 0.1e1 / t66 / t73 / rho[1];
  t1208 = my_piecewise3(t80, t1197, -0.5e1 / 0.18e2 * lapl[1] * t75 + 0.88888888888888888889e0 * t1200 - 0.17777777777777777778e0 * sigma[0] * t1204);
  t1209 = t83 * t83;
  t1210 = 0.1e1 / t1209;
  t1211 = t1208 * t1210;
  t1213 = exp(-0.2e1 / 0.3e1 * t84);
  t1214 = 0.1e1 / t1213;
  t1215 = t1211 * t1214;
  t1216 = t114 * t1215;
  t1217 = t84 * t84;
  t1219 = t1217 - 0.2e1 * t84 + 0.3e1;
  t1220 = 0.1e1 / t1219;
  t1221 = t84 - 0.2e1;
  t1222 = t1221 * t1221;
  t1223 = t1220 * t1222;
  t1224 = t1223 * t94;
  t1227 = t145 * t1208;
  t1228 = t1210 * t1214;
  t1229 = t1227 * t1228;
  t1230 = t1223 * t90;
  t1232 = t1227 * t1210;
  t1233 = t1214 * t1220;
  t1235 = t1233 * t1222 * t87;
  t1239 = t86 * (t1229 * t1230 - t1232 * t1235 / 0.2e1);
  t1240 = t1239 * t93;
  t1243 = 0.1e1 / t1217;
  t1244 = t92 * t1243;
  t1245 = t114 * t1244;
  t1246 = t1233 * t1222;
  t1247 = t1211 * t1246;
  t1251 = t41 / t102;
  t1256 = my_piecewise3(t100, -0.5e1 / 0.3e1 * t1200 + t43 * t1204 / 0.3e1, 0);
  t1261 = (-0.2e1 / 0.3e1 * t1216 * t1224 - 0.2e1 * t3 * t1240 + 0.2e1 * t1245 * t1247 + t169 * t1251 * t1256 / 0.12e2) * t55;
  t1264 = t112 * t112;
  t1265 = 0.1e1 / t1264;
  t1266 = t108 * t187;
  t1269 = (t59 - t1266) * t58 + 0.1e1 + t109;
  t1270 = t1265 * t1269;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = t1261 * t112 / 0.2e1 + t107 * t1270 / 0.6e1;

  t1274 = my_piecewise3(t80, t1197, 0.66666666666666666667e-1 * t75);
  t1275 = t1274 * t1210;
  t1276 = t1275 * t1214;
  t1277 = t114 * t1276;
  t1280 = t145 * t1274;
  t1281 = t1280 * t1228;
  t1283 = t1280 * t1210;
  t1287 = t86 * (t1281 * t1230 - t1283 * t1235 / 0.2e1);
  t1288 = t1287 * t93;
  t1291 = t1275 * t1246;
  t1296 = my_piecewise3(t100, -params->alpha * t75 / 0.8e1, 0);
  t1301 = (-0.2e1 / 0.3e1 * t1277 * t1224 - 0.2e1 * t3 * t1288 + 0.2e1 * t1245 * t1291 + t169 * t1251 * t1296 / 0.12e2) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t1301 * t112 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = 0.0e0;

  t1304 = my_piecewise3(t80, t1197, t68 / 0.6e1);
  t1305 = t1304 * t1210;
  t1306 = t1305 * t1214;
  t1307 = t114 * t1306;
  t1310 = t145 * t1304;
  t1311 = t1310 * t1228;
  t1313 = t1310 * t1210;
  t1317 = t86 * (t1311 * t1230 - t1313 * t1235 / 0.2e1);
  t1318 = t1317 * t93;
  t1321 = t1305 * t1246;
  t1325 = (-0.2e1 / 0.3e1 * t1307 * t1224 - 0.2e1 * t3 * t1318 + 0.2e1 * t1245 * t1321) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = t1325 * t112 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = 0.0e0;

  t1328 = my_piecewise3(t80, t1197, -0.53333333333333333333e0 * t68);
  t1329 = t1328 * t1210;
  t1330 = t1329 * t1214;
  t1331 = t114 * t1330;
  t1334 = t145 * t1328;
  t1335 = t1334 * t1228;
  t1337 = t1334 * t1210;
  t1341 = t86 * (t1335 * t1230 - t1337 * t1235 / 0.2e1);
  t1342 = t1341 * t93;
  t1345 = t1329 * t1246;
  t1348 = my_piecewise3(t100, t68, 0);
  t1353 = (-0.2e1 / 0.3e1 * t1331 * t1224 - 0.2e1 * t3 * t1342 + 0.2e1 * t1245 * t1345 + t169 * t1251 * t1348 / 0.12e2) * t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = t1353 * t112 / 0.2e1;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t1357 = tau[1] * t1204;
  t1359 = t73 * t73;
  t1361 = 0.1e1 / t66 / t1359;
  t1365 = my_piecewise3(t80, t1197, 0.20e2 / 0.27e2 * lapl[1] * t1204 - 0.23703703703703703704e1 * t1357 + 0.65185185185185185186e0 * sigma[0] * t1361);
  t1366 = t1365 * t1210;
  t1371 = t1208 * t1208;
  t1373 = 0.1e1 / t1209 / t83;
  t1374 = t1371 * t1373;
  t1379 = t1209 * t1209;
  t1380 = 0.1e1 / t1379;
  t1381 = t1371 * t1380;
  t1382 = t1213 * t1213;
  t1383 = 0.1e1 / t1382;
  t1385 = t307 * t1381 * t1383;
  t1386 = t1219 * t1219;
  t1387 = 0.1e1 / t1386;
  t1388 = t1222 * t1222;
  t1389 = t1387 * t1388;
  t1390 = t1389 * t94;
  t1393 = t1387 * t1222;
  t1394 = t1393 * t86;
  t1395 = t91 * t93;
  t1396 = t84 * t145;
  t1398 = t1228 * t1223;
  t1402 = 0.2e1 * t1396 * t1208 * t1398 - 0.2e1 * t1232 * t1246;
  t1404 = t1394 * t1395 * t1402;
  t1407 = t1222 * t1221;
  t1408 = t1387 * t1407;
  t1409 = t1408 * t94;
  t1412 = t1223 * t1240;
  t1415 = t1389 * t1244;
  t1418 = t145 * t1365;
  t1421 = t145 * t1371;
  t1422 = t1373 * t1214;
  t1426 = t355 * t1371;
  t1427 = t1380 * t1383;
  t1428 = t1426 * t1427;
  t1429 = t1389 * t90;
  t1433 = t1393 * t90 * t1402;
  t1435 = t1408 * t90;
  t1438 = t1426 * t1380;
  t1439 = t1383 * t1387;
  t1441 = t1439 * t1388 * t87;
  t1450 = t1393 * t87 * t1402;
  t1454 = t1439 * t1407 * t87;
  t1462 = t114 * t1239 * t1243;
  t1468 = t307 * t92 / t1217 / t84;
  t1469 = t1439 * t1388;
  t1479 = t1393 * t1402;
  t1483 = t307 * t1244;
  t1484 = t1439 * t1407;
  t1490 = t41 / t102 / t101;
  t1491 = t1256 * t1256;
  t1499 = my_piecewise3(t100, 0.40e2 / 0.9e1 * t1357 - 0.11e2 / 0.9e1 * t43 * t1361, 0);
  t1503 = -0.2e1 / 0.3e1 * t114 * t1366 * t1214 * t1224 + 0.4e1 / 0.3e1 * t114 * t1374 * t1214 * t1224 - 0.2e1 / 0.3e1 * t1385 * t1390 + 0.2e1 / 0.3e1 * t1216 * t1404 - 0.4e1 / 0.3e1 * t1385 * t1409 - 0.4e1 / 0.3e1 * t1216 * t1412 + 0.8e1 / 0.3e1 * t1385 * t1415 - 0.2e1 * t3 * t86 * (t1418 * t1228 * t1230 - 0.2e1 * t1421 * t1422 * t1230 - t1428 * t1429 / 0.3e1 - t1229 * t1433 + 0.2e1 * t1428 * t1435 + 0.2e1 / 0.3e1 * t1438 * t1441 - t1418 * t1210 * t1235 / 0.2e1 + t1421 * t1373 * t1235 + t1229 * t1450 / 0.2e1 - t1438 * t1454) * t93 + 0.4e1 * t1462 * t1247 - 0.4e1 * t1468 * t1381 * t1469 + 0.2e1 * t1245 * t1366 * t1246 - 0.4e1 * t1245 * t1374 * t1246 - 0.2e1 * t1245 * t1215 * t1479 + 0.4e1 * t1483 * t1381 * t1484 - t169 * t1490 * t1491 / 0.24e2 + t169 * t1251 * t1499 / 0.12e2;
  t1511 = t1269 * t1269;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = t1503 * t55 * t112 / 0.2e1 + t1261 * t1270 / 0.3e1 - t107 / t1264 / t111 * t1511 / 0.9e1 + t107 * t1265 * ((0.2e1 * t108 * t446 - 0.2e1 * t187) * t58 + t451 - 0.2e1 * t1266) / 0.6e1;

  t1525 = my_piecewise3(t80, t1197, -0.17777777777777777778e0 * t1204);
  t1526 = t1525 * t1210;
  t1532 = t1274 * t1373 * t1214;
  t1534 = t1223 * t86;
  t1535 = t1395 * t1208;
  t1536 = t1534 * t1535;
  t1540 = t1274 * t1380 * t1383;
  t1541 = t307 * t1540;
  t1542 = t1389 * t86;
  t1543 = t1542 * t1535;
  t1548 = t1408 * t86;
  t1549 = t1548 * t1535;
  t1554 = t91 * t1243;
  t1556 = t1542 * t1554 * t1208;
  t1559 = t1223 * t1288;
  t1562 = t145 * t1525;
  t1565 = t1280 * t1422;
  t1566 = t90 * t1208;
  t1567 = t1223 * t1566;
  t1571 = t355 * t1274 * t1427;
  t1572 = t1389 * t1566;
  t1576 = t1408 * t1566;
  t1579 = t87 * t1208;
  t1580 = t1389 * t1579;
  t1586 = t1223 * t1579;
  t1590 = t1408 * t1579;
  t1598 = t114 * t1287 * t1243;
  t1603 = t1389 * t1208;
  t1610 = t1223 * t1208;
  t1617 = t1408 * t1208;
  t1627 = my_piecewise3(t100, params->alpha * t1204 / 0.3e1, 0);
  t1631 = -0.2e1 / 0.3e1 * t114 * t1526 * t1214 * t1224 + 0.4e1 / 0.3e1 * t114 * t1532 * t1536 - 0.2e1 / 0.3e1 * t1541 * t1543 + 0.2e1 / 0.3e1 * t1277 * t1404 - 0.4e1 / 0.3e1 * t1541 * t1549 - 0.2e1 / 0.3e1 * t1277 * t1412 + 0.8e1 / 0.3e1 * t1541 * t1556 - 0.2e1 / 0.3e1 * t1216 * t1559 - 0.2e1 * t3 * t86 * (t1562 * t1228 * t1230 - 0.2e1 * t1565 * t1567 - t1571 * t1572 / 0.3e1 - t1281 * t1433 + 0.2e1 * t1571 * t1576 + 0.2e1 / 0.3e1 * t1571 * t1580 - t1562 * t1210 * t1235 / 0.2e1 + t1565 * t1586 + t1281 * t1450 / 0.2e1 - t1571 * t1590) * t93 + 0.2e1 * t1598 * t1247 + 0.2e1 * t1462 * t1291 - 0.4e1 * t1468 * t1540 * t1603 + 0.2e1 * t1245 * t1526 * t1246 - 0.4e1 * t1245 * t1532 * t1610 - 0.2e1 * t1245 * t1276 * t1479 + 0.4e1 * t1483 * t1540 * t1617 - t169 * t1490 * t1296 * t1256 / 0.24e2 + t169 * t1251 * t1627 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t1631 * t55 * t112 / 0.2e1 + t1301 * t1270 / 0.6e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[4] = 0.0e0;

  t1638 = my_piecewise3(t80, t1197, 0.88888888888888888889e0 * t75);
  t1639 = t1638 * t1210;
  t1645 = t1328 * t1373 * t1214;
  t1646 = t114 * t1645;
  t1650 = t1328 * t1380 * t1383;
  t1651 = t307 * t1650;
  t1662 = t1223 * t1342;
  t1665 = t145 * t1638;
  t1668 = t1334 * t1422;
  t1672 = t355 * t1328 * t1427;
  t1693 = t114 * t1341 * t1243;
  t1718 = my_piecewise3(t100, -0.5e1 / 0.3e1 * t75, 0);
  t1722 = -0.2e1 / 0.3e1 * t114 * t1639 * t1214 * t1224 + 0.4e1 / 0.3e1 * t1646 * t1536 - 0.2e1 / 0.3e1 * t1651 * t1543 + 0.2e1 / 0.3e1 * t1331 * t1404 - 0.4e1 / 0.3e1 * t1651 * t1549 - 0.2e1 / 0.3e1 * t1331 * t1412 + 0.8e1 / 0.3e1 * t1651 * t1556 - 0.2e1 / 0.3e1 * t1216 * t1662 - 0.2e1 * t3 * t86 * (t1665 * t1228 * t1230 - 0.2e1 * t1668 * t1567 - t1672 * t1572 / 0.3e1 - t1335 * t1433 + 0.2e1 * t1672 * t1576 + 0.2e1 / 0.3e1 * t1672 * t1580 - t1665 * t1210 * t1235 / 0.2e1 + t1668 * t1586 + t1335 * t1450 / 0.2e1 - t1672 * t1590) * t93 + 0.2e1 * t1693 * t1247 + 0.2e1 * t1462 * t1345 - 0.4e1 * t1468 * t1650 * t1603 + 0.2e1 * t1245 * t1639 * t1246 - 0.4e1 * t1245 * t1645 * t1610 - 0.2e1 * t1245 * t1330 * t1479 + 0.4e1 * t1483 * t1650 * t1617 - t169 * t1490 * t1348 * t1256 / 0.24e2 + t169 * t1251 * t1718 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[5] = t1722 * t55 * t112 / 0.2e1 + t1353 * t1270 / 0.6e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[4] = 0.0e0;

  t1729 = my_piecewise3(t80, t1197, -0.5e1 / 0.18e2 * t75);
  t1730 = t1729 * t1210;
  t1736 = t1304 * t1373 * t1214;
  t1737 = t114 * t1736;
  t1741 = t1304 * t1380 * t1383;
  t1742 = t307 * t1741;
  t1753 = t1223 * t1318;
  t1756 = t145 * t1729;
  t1759 = t1310 * t1422;
  t1763 = t355 * t1304 * t1427;
  t1784 = t114 * t1317 * t1243;
  t1804 = -0.2e1 / 0.3e1 * t114 * t1730 * t1214 * t1224 + 0.4e1 / 0.3e1 * t1737 * t1536 - 0.2e1 / 0.3e1 * t1742 * t1543 + 0.2e1 / 0.3e1 * t1307 * t1404 - 0.4e1 / 0.3e1 * t1742 * t1549 - 0.2e1 / 0.3e1 * t1307 * t1412 + 0.8e1 / 0.3e1 * t1742 * t1556 - 0.2e1 / 0.3e1 * t1216 * t1753 - 0.2e1 * t3 * t86 * (t1756 * t1228 * t1230 - 0.2e1 * t1759 * t1567 - t1763 * t1572 / 0.3e1 - t1311 * t1433 + 0.2e1 * t1763 * t1576 + 0.2e1 / 0.3e1 * t1763 * t1580 - t1756 * t1210 * t1235 / 0.2e1 + t1759 * t1586 + t1311 * t1450 / 0.2e1 - t1763 * t1590) * t93 + 0.2e1 * t1784 * t1247 + 0.2e1 * t1462 * t1321 - 0.4e1 * t1468 * t1741 * t1603 + 0.2e1 * t1245 * t1730 * t1246 - 0.4e1 * t1245 * t1736 * t1610 - 0.2e1 * t1245 * t1306 * t1479 + 0.4e1 * t1483 * t1741 * t1617;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[5] = t1804 * t55 * t112 / 0.2e1 + t1325 * t1270 / 0.6e1;

  t1810 = my_piecewise3(t80, t1197, 0);
  t1811 = t1810 * t1210;
  t1815 = 0.2e1 / 0.3e1 * t114 * t1811 * t1214 * t1224;
  t1816 = t1274 * t1274;
  t1817 = t1816 * t1373;
  t1822 = t1816 * t1380;
  t1824 = t307 * t1822 * t1383;
  t1831 = 0.2e1 * t1396 * t1274 * t1398 - 0.2e1 * t1283 * t1246;
  t1833 = t1394 * t1395 * t1831;
  t1842 = t145 * t1810;
  t1844 = t1842 * t1228 * t1230;
  t1845 = t145 * t1816;
  t1849 = t355 * t1816;
  t1850 = t1849 * t1427;
  t1854 = t1393 * t90 * t1831;
  t1858 = t1849 * t1380;
  t1863 = t1842 * t1210 * t1235 / 0.2e1;
  t1867 = t1393 * t87 * t1831;
  t1883 = 0.2e1 * t1245 * t1811 * t1246;
  t1887 = t1393 * t1831;
  t1894 = t1296 * t1296;
  t1898 = my_piecewise3(t100, 0, 0);
  t1901 = t169 * t1251 * t1898 / 0.12e2;
  t1902 = -t1815 + 0.4e1 / 0.3e1 * t114 * t1817 * t1214 * t1224 - 0.2e1 / 0.3e1 * t1824 * t1390 + 0.2e1 / 0.3e1 * t1277 * t1833 - 0.4e1 / 0.3e1 * t1824 * t1409 - 0.4e1 / 0.3e1 * t1277 * t1559 + 0.8e1 / 0.3e1 * t1824 * t1415 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t1845 * t1422 * t1230 - t1850 * t1429 / 0.3e1 - t1281 * t1854 + 0.2e1 * t1850 * t1435 + 0.2e1 / 0.3e1 * t1858 * t1441 - t1863 + t1845 * t1373 * t1235 + t1281 * t1867 / 0.2e1 - t1858 * t1454) * t93 + 0.4e1 * t1598 * t1291 - 0.4e1 * t1468 * t1822 * t1469 + t1883 - 0.4e1 * t1245 * t1817 * t1246 - 0.2e1 * t1245 * t1276 * t1887 + 0.4e1 * t1483 * t1822 * t1484 - t169 * t1490 * t1894 / 0.24e2 + t1901;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t1902 * t55 * t112 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[6] = 0.0e0;

  t1905 = t1395 * t1274;
  t1906 = t1534 * t1905;
  t1909 = t1542 * t1905;
  t1914 = t1548 * t1905;
  t1920 = t1542 * t1554 * t1274;
  t1925 = t90 * t1274;
  t1926 = t1223 * t1925;
  t1929 = t1389 * t1925;
  t1933 = t1408 * t1925;
  t1936 = t87 * t1274;
  t1937 = t1389 * t1936;
  t1940 = t1223 * t1936;
  t1944 = t1408 * t1936;
  t1955 = t1389 * t1274;
  t1959 = t1223 * t1274;
  t1966 = t1408 * t1274;
  t1970 = -t1815 + 0.4e1 / 0.3e1 * t1737 * t1906 - 0.2e1 / 0.3e1 * t1742 * t1909 + 0.2e1 / 0.3e1 * t1307 * t1833 - 0.4e1 / 0.3e1 * t1742 * t1914 - 0.2e1 / 0.3e1 * t1307 * t1559 + 0.8e1 / 0.3e1 * t1742 * t1920 - 0.2e1 / 0.3e1 * t1277 * t1753 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t1759 * t1926 - t1763 * t1929 / 0.3e1 - t1311 * t1854 + 0.2e1 * t1763 * t1933 + 0.2e1 / 0.3e1 * t1763 * t1937 - t1863 + t1759 * t1940 + t1311 * t1867 / 0.2e1 - t1763 * t1944) * t93 + 0.2e1 * t1784 * t1291 + 0.2e1 * t1598 * t1321 - 0.4e1 * t1468 * t1741 * t1955 + t1883 - 0.4e1 * t1245 * t1736 * t1959 - 0.2e1 * t1245 * t1306 * t1887 + 0.4e1 * t1483 * t1741 * t1966;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[7] = t1970 * t55 * t112 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[6] = 0.0e0;

  t2025 = -t1815 + 0.4e1 / 0.3e1 * t1646 * t1906 - 0.2e1 / 0.3e1 * t1651 * t1909 + 0.2e1 / 0.3e1 * t1331 * t1833 - 0.4e1 / 0.3e1 * t1651 * t1914 - 0.2e1 / 0.3e1 * t1331 * t1559 + 0.8e1 / 0.3e1 * t1651 * t1920 - 0.2e1 / 0.3e1 * t1277 * t1662 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t1668 * t1926 - t1672 * t1929 / 0.3e1 - t1335 * t1854 + 0.2e1 * t1672 * t1933 + 0.2e1 / 0.3e1 * t1672 * t1937 - t1863 + t1668 * t1940 + t1335 * t1867 / 0.2e1 - t1672 * t1944) * t93 + 0.2e1 * t1693 * t1291 + 0.2e1 * t1598 * t1345 - 0.4e1 * t1468 * t1650 * t1955 + t1883 - 0.4e1 * t1245 * t1645 * t1959 - 0.2e1 * t1245 * t1330 * t1887 + 0.4e1 * t1483 * t1650 * t1966 - t169 * t1490 * t1348 * t1296 / 0.24e2 + t1901;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[7] = t2025 * t55 * t112 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[10] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[11] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[4] = 0.0e0;

  t2028 = t1304 * t1304;
  t2029 = t2028 * t1373;
  t2034 = t2028 * t1380;
  t2036 = t307 * t2034 * t1383;
  t2043 = 0.2e1 * t1396 * t1304 * t1398 - 0.2e1 * t1313 * t1246;
  t2045 = t1394 * t1395 * t2043;
  t2054 = t145 * t2028;
  t2058 = t355 * t2028;
  t2059 = t2058 * t1427;
  t2063 = t1393 * t90 * t2043;
  t2067 = t2058 * t1380;
  t2073 = t1393 * t87 * t2043;
  t2090 = t1393 * t2043;
  t2097 = -t1815 + 0.4e1 / 0.3e1 * t114 * t2029 * t1214 * t1224 - 0.2e1 / 0.3e1 * t2036 * t1390 + 0.2e1 / 0.3e1 * t1307 * t2045 - 0.4e1 / 0.3e1 * t2036 * t1409 - 0.4e1 / 0.3e1 * t1307 * t1753 + 0.8e1 / 0.3e1 * t2036 * t1415 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t2054 * t1422 * t1230 - t2059 * t1429 / 0.3e1 - t1311 * t2063 + 0.2e1 * t2059 * t1435 + 0.2e1 / 0.3e1 * t2067 * t1441 - t1863 + t2054 * t1373 * t1235 + t1311 * t2073 / 0.2e1 - t2067 * t1454) * t93 + 0.4e1 * t1784 * t1321 - 0.4e1 * t1468 * t2034 * t1469 + t1883 - 0.4e1 * t1245 * t2029 * t1246 - 0.2e1 * t1245 * t1306 * t2090 + 0.4e1 * t1483 * t2034 * t1484;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[5] = t2097 * t55 * t112 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[6] = 0.0e0;

  t2100 = t1395 * t1304;
  t2120 = t90 * t1304;
  t2131 = t87 * t1304;
  t2165 = -t1815 + 0.4e1 / 0.3e1 * t1646 * t1534 * t2100 - 0.2e1 / 0.3e1 * t1651 * t1542 * t2100 + 0.2e1 / 0.3e1 * t1331 * t2045 - 0.4e1 / 0.3e1 * t1651 * t1548 * t2100 - 0.2e1 / 0.3e1 * t1331 * t1753 + 0.8e1 / 0.3e1 * t1651 * t1542 * t1554 * t1304 - 0.2e1 / 0.3e1 * t1307 * t1662 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t1668 * t1223 * t2120 - t1672 * t1389 * t2120 / 0.3e1 - t1335 * t2063 + 0.2e1 * t1672 * t1408 * t2120 + 0.2e1 / 0.3e1 * t1672 * t1389 * t2131 - t1863 + t1668 * t1223 * t2131 + t1335 * t2073 / 0.2e1 - t1672 * t1408 * t2131) * t93 + 0.2e1 * t1693 * t1321 + 0.2e1 * t1784 * t1345 - 0.4e1 * t1468 * t1650 * t1389 * t1304 + t1883 - 0.4e1 * t1245 * t1645 * t1223 * t1304 - 0.2e1 * t1245 * t1330 * t2090 + 0.4e1 * t1483 * t1650 * t1408 * t1304;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[7] = t2165 * t55 * t112 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[4] = 0.0e0;

  t2168 = t1328 * t1328;
  t2169 = t2168 * t1373;
  t2174 = t2168 * t1380;
  t2176 = t307 * t2174 * t1383;
  t2183 = 0.2e1 * t1396 * t1328 * t1398 - 0.2e1 * t1337 * t1246;
  t2194 = t145 * t2168;
  t2198 = t355 * t2168;
  t2199 = t2198 * t1427;
  t2207 = t2198 * t1380;
  t2237 = t1348 * t1348;
  t2241 = -t1815 + 0.4e1 / 0.3e1 * t114 * t2169 * t1214 * t1224 - 0.2e1 / 0.3e1 * t2176 * t1390 + 0.2e1 / 0.3e1 * t1331 * t1394 * t1395 * t2183 - 0.4e1 / 0.3e1 * t2176 * t1409 - 0.4e1 / 0.3e1 * t1331 * t1662 + 0.8e1 / 0.3e1 * t2176 * t1415 - 0.2e1 * t3 * t86 * (t1844 - 0.2e1 * t2194 * t1422 * t1230 - t2199 * t1429 / 0.3e1 - t1335 * t1393 * t90 * t2183 + 0.2e1 * t2199 * t1435 + 0.2e1 / 0.3e1 * t2207 * t1441 - t1863 + t2194 * t1373 * t1235 + t1335 * t1393 * t87 * t2183 / 0.2e1 - t2207 * t1454) * t93 + 0.4e1 * t1693 * t1345 - 0.4e1 * t1468 * t2174 * t1469 + t1883 - 0.4e1 * t1245 * t2169 * t1246 - 0.2e1 * t1245 * t1330 * t1393 * t2183 + 0.4e1 * t1483 * t2174 * t1484 - t169 * t1490 * t2237 / 0.24e2 + t1901;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[5] = t2241 * t55 * t112 / 0.2e1;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}

