/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_wc.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t37, t39, t40, t43, t46, t47;
  double t49, t50, t52, t56, t57, t58, t61, t65;
  double tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = t25 * sigma[0];
  t37 = t27 * t32;
  t39 = exp(-t34 / 0.24e2);
  t40 = t37 * t39;
  t43 = t20 * t20;
  t46 = t43 / t22 / t21;
  t47 = sigma[0] * sigma[0];
  t49 = t29 * t29;
  t50 = t49 * rho[0];
  t52 = 0.1e1 / t18 / t50;
  t56 = 0.1e1 + 0.27560657413756315278e-4 * t46 * t47 * t26 * t52;
  t57 = log(t56);
  t58 = 0.804e0 + 0.5e1 / 0.972e3 * t34 + 0.4002424276710846245e-2 * t36 * t40 + t57;
  t61 = 0.1804e1 - 0.646416e0 / t58;
  t65 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t17 * t18 * t61);
  tzk0 = 0.2e1 * t65;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t37, t39, t40, t43, t46, t47;
  double t49, t50, t52, t56, t57, t58, t61, t65;
  double tzk0;

  double t66, t71, t72, t73, t74, t75, t77, t81;
  double t82, t85, t86, t88, t89, t90, t93, t94;
  double t97, t102, tvrho0, t109, t110, t111, t114, t117;
  double t121, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = t25 * sigma[0];
  t37 = t27 * t32;
  t39 = exp(-t34 / 0.24e2);
  t40 = t37 * t39;
  t43 = t20 * t20;
  t46 = t43 / t22 / t21;
  t47 = sigma[0] * sigma[0];
  t49 = t29 * t29;
  t50 = t49 * rho[0];
  t52 = 0.1e1 / t18 / t50;
  t56 = 0.1e1 + 0.27560657413756315278e-4 * t46 * t47 * t26 * t52;
  t57 = log(t56);
  t58 = 0.804e0 + 0.5e1 / 0.972e3 * t34 + 0.4002424276710846245e-2 * t36 * t40 + t57;
  t61 = 0.1804e1 - 0.646416e0 / t58;
  t65 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t17 * t18 * t61);
  tzk0 = 0.2e1 * t65;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t66 = 0.1e1 / t30;
  t71 = t3 * t17;
  t72 = t58 * t58;
  t73 = 0.1e1 / t72;
  t74 = t18 * t73;
  t75 = t29 * rho[0];
  t77 = 0.1e1 / t30 / t75;
  t81 = t27 * t77;
  t82 = t81 * t39;
  t85 = t46 * t47;
  t86 = t49 * t29;
  t88 = 0.1e1 / t18 / t86;
  t89 = t26 * t88;
  t90 = t89 * t39;
  t93 = 0.1e1 / t56;
  t94 = t89 * t93;
  t97 = -0.1e2 / 0.729e3 * t25 * t28 * t77 - 0.10673131404562256653e-1 * t36 * t82 + 0.88942761704685472111e-3 * t85 * t90 - 0.14699017287336701482e-3 * t85 * t94;
  t102 = my_piecewise3(t2, 0, -t6 * t17 * t66 * t61 / 0.8e1 - 0.16551095363746320496e0 * t71 * t74 * t97);
  tvrho0 = 0.2e1 * rho[0] * t102 + 0.2e1 * t65;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t109 = t46 * sigma[0];
  t110 = t26 * t52;
  t111 = t110 * t39;
  t114 = t110 * t93;
  t117 = 0.5e1 / 0.972e3 * t25 * t37 + 0.4002424276710846245e-2 * t25 * t40 - 0.33353535639257052042e-3 * t109 * t111 + 0.55121314827512630556e-4 * t109 * t114;
  t121 = my_piecewise3(t2, 0, -0.16551095363746320496e0 * t71 * t74 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t37, t39, t40, t43, t46, t47;
  double t49, t50, t52, t56, t57, t58, t61, t65;
  double tzk0;

  double t66, t71, t72, t73, t74, t75, t77, t81;
  double t82, t85, t86, t88, t89, t90, t93, t94;
  double t97, t102, tvrho0, t109, t110, t111, t114, t117;
  double t121, tvsigma0;

  double t125, t130, t135, t136, t137, t142, t146, t147;
  double t150, t152, t153, t154, t157, t158, t159, t160;
  double t161, t162, t163, t167, t172, t173, t174, t175;
  double t177, t179, t180, t181, t184, t189, tv2rho20, t195;
  double t196, t197, t204, t209, t210, t211, t217, t218;
  double t220, t225, t230, tv2rhosigma0, t233, t239, t240, t248;
  double t250, t253, t258, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = t25 * sigma[0];
  t37 = t27 * t32;
  t39 = exp(-t34 / 0.24e2);
  t40 = t37 * t39;
  t43 = t20 * t20;
  t46 = t43 / t22 / t21;
  t47 = sigma[0] * sigma[0];
  t49 = t29 * t29;
  t50 = t49 * rho[0];
  t52 = 0.1e1 / t18 / t50;
  t56 = 0.1e1 + 0.27560657413756315278e-4 * t46 * t47 * t26 * t52;
  t57 = log(t56);
  t58 = 0.804e0 + 0.5e1 / 0.972e3 * t34 + 0.4002424276710846245e-2 * t36 * t40 + t57;
  t61 = 0.1804e1 - 0.646416e0 / t58;
  t65 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t17 * t18 * t61);
  tzk0 = 0.2e1 * t65;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t66 = 0.1e1 / t30;
  t71 = t3 * t17;
  t72 = t58 * t58;
  t73 = 0.1e1 / t72;
  t74 = t18 * t73;
  t75 = t29 * rho[0];
  t77 = 0.1e1 / t30 / t75;
  t81 = t27 * t77;
  t82 = t81 * t39;
  t85 = t46 * t47;
  t86 = t49 * t29;
  t88 = 0.1e1 / t18 / t86;
  t89 = t26 * t88;
  t90 = t89 * t39;
  t93 = 0.1e1 / t56;
  t94 = t89 * t93;
  t97 = -0.1e2 / 0.729e3 * t25 * t28 * t77 - 0.10673131404562256653e-1 * t36 * t82 + 0.88942761704685472111e-3 * t85 * t90 - 0.14699017287336701482e-3 * t85 * t94;
  t102 = my_piecewise3(t2, 0, -t6 * t17 * t66 * t61 / 0.8e1 - 0.16551095363746320496e0 * t71 * t74 * t97);
  tvrho0 = 0.2e1 * rho[0] * t102 + 0.2e1 * t65;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t109 = t46 * sigma[0];
  t110 = t26 * t52;
  t111 = t110 * t39;
  t114 = t110 * t93;
  t117 = 0.5e1 / 0.972e3 * t25 * t37 + 0.4002424276710846245e-2 * t25 * t40 - 0.33353535639257052042e-3 * t109 * t111 + 0.55121314827512630556e-4 * t109 * t114;
  t121 = my_piecewise3(t2, 0, -0.16551095363746320496e0 * t71 * t74 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t125 = 0.1e1 / t30 / rho[0];
  t130 = t66 * t73;
  t135 = 0.1e1 / t72 / t58;
  t136 = t18 * t135;
  t137 = t97 * t97;
  t142 = 0.1e1 / t30 / t49;
  t146 = t27 * t142;
  t147 = t146 * t39;
  t150 = t49 * t75;
  t152 = 0.1e1 / t18 / t150;
  t153 = t26 * t152;
  t154 = t153 * t39;
  t157 = t21 * t21;
  t158 = 0.1e1 / t157;
  t159 = t47 * sigma[0];
  t160 = t158 * t159;
  t161 = t49 * t49;
  t162 = t161 * t29;
  t163 = 0.1e1 / t162;
  t167 = t153 * t93;
  t172 = t20 / t23 / t157;
  t173 = t47 * t47;
  t174 = t172 * t173;
  t175 = t161 * t49;
  t177 = 0.1e1 / t30 / t175;
  t179 = t56 * t56;
  t180 = 0.1e1 / t179;
  t181 = t27 * t177 * t180;
  t184 = 0.11e3 / 0.2187e4 * t25 * t28 * t142 + 0.39134815150061607728e-1 * t36 * t147 - 0.800484855342169249e-2 * t85 * t154 + 0.11859034893958062948e-2 * t160 * t163 * t39 + 0.93093776153132442719e-3 * t85 * t167 - 0.12963666552805392131e-6 * t174 * t181;
  t189 = my_piecewise3(t2, 0, t6 * t17 * t125 * t61 / 0.12e2 - 0.11034063575830880331e0 * t71 * t130 * t97 + 0.33102190727492640992e0 * t71 * t136 * t137 - 0.16551095363746320496e0 * t71 * t74 * t184);
  tv2rho20 = 0.2e1 * rho[0] * t189 + 0.4e1 * t102;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t195 = t71 * t18;
  t196 = t135 * t117;
  t197 = t196 * t97;
  t204 = t46 * t26;
  t209 = t158 * t47;
  t210 = t161 * rho[0];
  t211 = 0.1e1 / t210;
  t217 = t172 * t159;
  t218 = t161 * t75;
  t220 = 0.1e1 / t30 / t218;
  t225 = -0.1e2 / 0.729e3 * t25 * t81 - 0.10673131404562256653e-1 * t25 * t82 + 0.26682828511405641633e-2 * t204 * t88 * sigma[0] * t39 - 0.44471380852342736056e-3 * t209 * t211 * t39 - 0.29398034574673402963e-3 * t109 * t94 + 0.48613749573020220489e-7 * t217 * t27 * t220 * t180;
  t230 = my_piecewise3(t2, 0, -0.55170317879154401653e-1 * t71 * t130 * t117 + 0.33102190727492640992e0 * t195 * t197 - 0.16551095363746320496e0 * t71 * t74 * t225);
  tv2rhosigma0 = 0.2e1 * rho[0] * t230 + 0.2e1 * t121;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t117 * t117;
  t239 = t158 * sigma[0];
  t240 = 0.1e1 / t161;
  t248 = 0.1e1 / t30 / t162;
  t250 = t27 * t248 * t180;
  t253 = -0.66707071278514104084e-3 * t46 * t111 + 0.16676767819628526021e-3 * t239 * t240 * t39 + 0.55121314827512630556e-4 * t46 * t114 - 0.18230156089882582683e-7 * t172 * t47 * t250;
  t258 = my_piecewise3(t2, 0, 0.33102190727492640992e0 * t71 * t136 * t233 - 0.16551095363746320496e0 * t71 * t74 * t253);
  tv2sigma20 = 0.2e1 * rho[0] * t258;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t37, t39, t40, t43, t46, t47;
  double t49, t50, t52, t56, t57, t58, t61, t65;
  double tzk0;

  double t66, t71, t72, t73, t74, t75, t77, t81;
  double t82, t85, t86, t88, t89, t90, t93, t94;
  double t97, t102, tvrho0, t109, t110, t111, t114, t117;
  double t121, tvsigma0;

  double t125, t130, t135, t136, t137, t142, t146, t147;
  double t150, t152, t153, t154, t157, t158, t159, t160;
  double t161, t162, t163, t167, t172, t173, t174, t175;
  double t177, t179, t180, t181, t184, t189, tv2rho20, t195;
  double t196, t197, t204, t209, t210, t211, t217, t218;
  double t220, t225, t230, tv2rhosigma0, t233, t239, t240, t248;
  double t250, t253, t258, tv2sigma20;

  double t265, t269, t276, t277, t278, t279, t283, t284;
  double t288, t292, t293, t297, t298, t302, t306, t307;
  double t309, t311, t312, t315, t319, t322, t323, t325;
  double t328, t331, t336, tv3rho30, t343, t349, t350, t353;
  double t354, t357, t368, t369, t379, t381, t385, t390;
  double tv3rho2sigma0, t396, t397, t400, t406, t407, t412, t413;
  double t421, t422, t426, t427, t431, t436, tv3rhosigma20, t439;
  double t443, t456, t460, t465, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = t25 * sigma[0];
  t37 = t27 * t32;
  t39 = exp(-t34 / 0.24e2);
  t40 = t37 * t39;
  t43 = t20 * t20;
  t46 = t43 / t22 / t21;
  t47 = sigma[0] * sigma[0];
  t49 = t29 * t29;
  t50 = t49 * rho[0];
  t52 = 0.1e1 / t18 / t50;
  t56 = 0.1e1 + 0.27560657413756315278e-4 * t46 * t47 * t26 * t52;
  t57 = log(t56);
  t58 = 0.804e0 + 0.5e1 / 0.972e3 * t34 + 0.4002424276710846245e-2 * t36 * t40 + t57;
  t61 = 0.1804e1 - 0.646416e0 / t58;
  t65 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t17 * t18 * t61);
  tzk0 = 0.2e1 * t65;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t66 = 0.1e1 / t30;
  t71 = t3 * t17;
  t72 = t58 * t58;
  t73 = 0.1e1 / t72;
  t74 = t18 * t73;
  t75 = t29 * rho[0];
  t77 = 0.1e1 / t30 / t75;
  t81 = t27 * t77;
  t82 = t81 * t39;
  t85 = t46 * t47;
  t86 = t49 * t29;
  t88 = 0.1e1 / t18 / t86;
  t89 = t26 * t88;
  t90 = t89 * t39;
  t93 = 0.1e1 / t56;
  t94 = t89 * t93;
  t97 = -0.1e2 / 0.729e3 * t25 * t28 * t77 - 0.10673131404562256653e-1 * t36 * t82 + 0.88942761704685472111e-3 * t85 * t90 - 0.14699017287336701482e-3 * t85 * t94;
  t102 = my_piecewise3(t2, 0, -t6 * t17 * t66 * t61 / 0.8e1 - 0.16551095363746320496e0 * t71 * t74 * t97);
  tvrho0 = 0.2e1 * rho[0] * t102 + 0.2e1 * t65;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t109 = t46 * sigma[0];
  t110 = t26 * t52;
  t111 = t110 * t39;
  t114 = t110 * t93;
  t117 = 0.5e1 / 0.972e3 * t25 * t37 + 0.4002424276710846245e-2 * t25 * t40 - 0.33353535639257052042e-3 * t109 * t111 + 0.55121314827512630556e-4 * t109 * t114;
  t121 = my_piecewise3(t2, 0, -0.16551095363746320496e0 * t71 * t74 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t125 = 0.1e1 / t30 / rho[0];
  t130 = t66 * t73;
  t135 = 0.1e1 / t72 / t58;
  t136 = t18 * t135;
  t137 = t97 * t97;
  t142 = 0.1e1 / t30 / t49;
  t146 = t27 * t142;
  t147 = t146 * t39;
  t150 = t49 * t75;
  t152 = 0.1e1 / t18 / t150;
  t153 = t26 * t152;
  t154 = t153 * t39;
  t157 = t21 * t21;
  t158 = 0.1e1 / t157;
  t159 = t47 * sigma[0];
  t160 = t158 * t159;
  t161 = t49 * t49;
  t162 = t161 * t29;
  t163 = 0.1e1 / t162;
  t167 = t153 * t93;
  t172 = t20 / t23 / t157;
  t173 = t47 * t47;
  t174 = t172 * t173;
  t175 = t161 * t49;
  t177 = 0.1e1 / t30 / t175;
  t179 = t56 * t56;
  t180 = 0.1e1 / t179;
  t181 = t27 * t177 * t180;
  t184 = 0.11e3 / 0.2187e4 * t25 * t28 * t142 + 0.39134815150061607728e-1 * t36 * t147 - 0.800484855342169249e-2 * t85 * t154 + 0.11859034893958062948e-2 * t160 * t163 * t39 + 0.93093776153132442719e-3 * t85 * t167 - 0.12963666552805392131e-6 * t174 * t181;
  t189 = my_piecewise3(t2, 0, t6 * t17 * t125 * t61 / 0.12e2 - 0.11034063575830880331e0 * t71 * t130 * t97 + 0.33102190727492640992e0 * t71 * t136 * t137 - 0.16551095363746320496e0 * t71 * t74 * t184);
  tv2rho20 = 0.2e1 * rho[0] * t189 + 0.4e1 * t102;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t195 = t71 * t18;
  t196 = t135 * t117;
  t197 = t196 * t97;
  t204 = t46 * t26;
  t209 = t158 * t47;
  t210 = t161 * rho[0];
  t211 = 0.1e1 / t210;
  t217 = t172 * t159;
  t218 = t161 * t75;
  t220 = 0.1e1 / t30 / t218;
  t225 = -0.1e2 / 0.729e3 * t25 * t81 - 0.10673131404562256653e-1 * t25 * t82 + 0.26682828511405641633e-2 * t204 * t88 * sigma[0] * t39 - 0.44471380852342736056e-3 * t209 * t211 * t39 - 0.29398034574673402963e-3 * t109 * t94 + 0.48613749573020220489e-7 * t217 * t27 * t220 * t180;
  t230 = my_piecewise3(t2, 0, -0.55170317879154401653e-1 * t71 * t130 * t117 + 0.33102190727492640992e0 * t195 * t197 - 0.16551095363746320496e0 * t71 * t74 * t225);
  tv2rhosigma0 = 0.2e1 * rho[0] * t230 + 0.2e1 * t121;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t117 * t117;
  t239 = t158 * sigma[0];
  t240 = 0.1e1 / t161;
  t248 = 0.1e1 / t30 / t162;
  t250 = t27 * t248 * t180;
  t253 = -0.66707071278514104084e-3 * t46 * t111 + 0.16676767819628526021e-3 * t239 * t240 * t39 + 0.55121314827512630556e-4 * t46 * t114 - 0.18230156089882582683e-7 * t172 * t47 * t250;
  t258 = my_piecewise3(t2, 0, 0.33102190727492640992e0 * t71 * t136 * t233 - 0.16551095363746320496e0 * t71 * t74 * t253);
  tv2sigma20 = 0.2e1 * rho[0] * t258;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t265 = t125 * t73;
  t269 = t66 * t135;
  t276 = t72 * t72;
  t277 = 0.1e1 / t276;
  t278 = t18 * t277;
  t279 = t137 * t97;
  t283 = t135 * t97;
  t284 = t283 * t184;
  t288 = 0.1e1 / t30 / t50;
  t292 = t27 * t288;
  t293 = t292 * t39;
  t297 = 0.1e1 / t18 / t161;
  t298 = t26 * t297;
  t302 = 0.1e1 / t218;
  t306 = t158 * t173;
  t307 = t161 * t50;
  t309 = 0.1e1 / t30 / t307;
  t311 = t27 * t39;
  t312 = t25 * t311;
  t315 = t298 * t93;
  t319 = t27 * t309 * t180;
  t322 = t173 * t47;
  t323 = t161 * t161;
  t325 = 0.1e1 / t323 / t75;
  t328 = 0.1e1 / t179 / t56;
  t331 = -0.154e4 / 0.6561e4 * t25 * t28 * t288 - 0.1826291373669541694e0 * t36 * t293 + 0.67398848313994991088e-1 * t85 * t298 * t39 - 0.22532166298520319601e-1 * t160 * t302 * t39 + 0.13176705437731181053e-3 * t306 * t309 * t312 - 0.68268769178963791327e-2 * t85 * t315 + 0.24630966450330245049e-5 * t174 * t319 - 0.48197932879823405316e-13 * t322 * t325 * t328;
  t336 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t17 * t32 * t61 + 0.11034063575830880331e0 * t71 * t265 * t97 + 0.33102190727492640993e0 * t71 * t269 * t137 - 0.16551095363746320496e0 * t71 * t130 * t184 - 0.99306572182477922976e0 * t71 * t278 * t279 + 0.99306572182477922976e0 * t195 * t284 - 0.16551095363746320496e0 * t71 * t74 * t331);
  tv3rho30 = 0.2e1 * rho[0] * t336 + 0.6e1 * t189;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t343 = t71 * t66;
  t349 = t277 * t117;
  t350 = t349 * t137;
  t353 = t135 * t225;
  t354 = t353 * t97;
  t357 = t196 * t184;
  t368 = t158 * t163;
  t369 = t47 * t39;
  t379 = t173 * sigma[0];
  t381 = 0.1e1 / t323 / t29;
  t385 = 0.11e3 / 0.2187e4 * t25 * t146 + 0.39134815150061607728e-1 * t25 * t147 - 0.19270931702681852291e-1 * t204 * t152 * sigma[0] * t39 + 0.75601347448982651294e-2 * t368 * t369 - 0.49412645391491928951e-4 * t160 * t177 * t312 + 0.18618755230626488543e-2 * t109 * t167 - 0.82643374274134374831e-6 * t217 * t181 + 0.18074224829933776993e-13 * t379 * t381 * t328;
  t390 = my_piecewise3(t2, 0, 0.36780211919436267769e-1 * t71 * t265 * t117 + 0.22068127151661760662e0 * t343 * t197 - 0.11034063575830880331e0 * t71 * t130 * t225 - 0.99306572182477922976e0 * t195 * t350 + 0.66204381454985281984e0 * t195 * t354 + 0.33102190727492640992e0 * t195 * t357 - 0.16551095363746320496e0 * t71 * t74 * t385);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t390 + 0.4e1 * t230;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t396 = t277 * t233;
  t397 = t396 * t97;
  t400 = t196 * t225;
  t406 = t135 * t253;
  t407 = t406 * t97;
  t412 = t158 * t211;
  t413 = sigma[0] * t39;
  t421 = t172 * t27;
  t422 = t220 * t180;
  t426 = t323 * rho[0];
  t427 = 0.1e1 / t426;
  t431 = 0.35577104681874188845e-2 * t46 * t90 - 0.22235690426171368028e-2 * t412 * t413 + 0.18529742021809473357e-4 * t209 * t220 * t312 - 0.29398034574673402963e-3 * t46 * t94 + 0.24306874786510110244e-6 * t421 * t422 * t47 - 0.67778343112251663721e-14 * t173 * t427 * t328;
  t436 = my_piecewise3(t2, 0, 0.11034063575830880331e0 * t71 * t269 * t233 - 0.99306572182477922976e0 * t195 * t397 + 0.66204381454985281984e0 * t195 * t400 - 0.55170317879154401653e-1 * t71 * t130 * t253 + 0.33102190727492640992e0 * t195 * t407 - 0.16551095363746320496e0 * t71 * t74 * t431);
  tv3rhosigma20 = 0.2e1 * rho[0] * t436 + 0.2e1 * t258;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t439 = t233 * t117;
  t443 = t196 * t253;
  t456 = 0.1e1 / t323;
  t460 = 0.50030303458885578063e-3 * t158 * t240 * t39 - 0.69486532581785525088e-5 * t239 * t248 * t312 - 0.54690468269647748049e-7 * t421 * t248 * t180 * sigma[0] + 0.25416878667094373895e-14 * t159 * t456 * t328;
  t465 = my_piecewise3(t2, 0, -0.99306572182477922976e0 * t71 * t278 * t439 + 0.99306572182477922976e0 * t195 * t443 - 0.16551095363746320496e0 * t71 * t74 * t460);
  tv3sigma30 = 0.2e1 * rho[0] * t465;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t37, t39, t40, t43, t46, t47;
  double t49, t50, t52, t56, t57, t58, t61, t65;
  double tzk0;

  double t66, t71, t72, t73, t74, t75, t77, t81;
  double t82, t85, t86, t88, t89, t90, t93, t94;
  double t97, t102, tvrho0, t109, t110, t111, t114, t117;
  double t121, tvsigma0;

  double t125, t130, t135, t136, t137, t142, t146, t147;
  double t150, t152, t153, t154, t157, t158, t159, t160;
  double t161, t162, t163, t167, t172, t173, t174, t175;
  double t177, t179, t180, t181, t184, t189, tv2rho20, t195;
  double t196, t197, t204, t209, t210, t211, t217, t218;
  double t220, t225, t230, tv2rhosigma0, t233, t239, t240, t248;
  double t250, t253, t258, tv2sigma20;

  double t265, t269, t276, t277, t278, t279, t283, t284;
  double t288, t292, t293, t297, t298, t302, t306, t307;
  double t309, t311, t312, t315, t319, t322, t323, t325;
  double t328, t331, t336, tv3rho30, t343, t349, t350, t353;
  double t354, t357, t368, t369, t379, t381, t385, t390;
  double tv3rho2sigma0, t396, t397, t400, t406, t407, t412, t413;
  double t421, t422, t426, t427, t431, t436, tv3rhosigma20, t439;
  double t443, t456, t460, t465, tv3sigma30;

  double t472, t476, t483, t493, t494, t495, t503, t511;
  double t521, t529, t531, t540, t555, t560, t561, t569;
  double t570, tv4rho40, t653, t654, tv4rho3sigma0, t676, t736, t737;
  double tv4rho2sigma20, t800, tv4rhosigma30, t803, t810, t845, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = t25 * sigma[0];
  t37 = t27 * t32;
  t39 = exp(-t34 / 0.24e2);
  t40 = t37 * t39;
  t43 = t20 * t20;
  t46 = t43 / t22 / t21;
  t47 = sigma[0] * sigma[0];
  t49 = t29 * t29;
  t50 = t49 * rho[0];
  t52 = 0.1e1 / t18 / t50;
  t56 = 0.1e1 + 0.27560657413756315278e-4 * t46 * t47 * t26 * t52;
  t57 = log(t56);
  t58 = 0.804e0 + 0.5e1 / 0.972e3 * t34 + 0.4002424276710846245e-2 * t36 * t40 + t57;
  t61 = 0.1804e1 - 0.646416e0 / t58;
  t65 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t17 * t18 * t61);
  tzk0 = 0.2e1 * t65;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t66 = 0.1e1 / t30;
  t71 = t3 * t17;
  t72 = t58 * t58;
  t73 = 0.1e1 / t72;
  t74 = t18 * t73;
  t75 = t29 * rho[0];
  t77 = 0.1e1 / t30 / t75;
  t81 = t27 * t77;
  t82 = t81 * t39;
  t85 = t46 * t47;
  t86 = t49 * t29;
  t88 = 0.1e1 / t18 / t86;
  t89 = t26 * t88;
  t90 = t89 * t39;
  t93 = 0.1e1 / t56;
  t94 = t89 * t93;
  t97 = -0.1e2 / 0.729e3 * t25 * t28 * t77 - 0.10673131404562256653e-1 * t36 * t82 + 0.88942761704685472111e-3 * t85 * t90 - 0.14699017287336701482e-3 * t85 * t94;
  t102 = my_piecewise3(t2, 0, -t6 * t17 * t66 * t61 / 0.8e1 - 0.16551095363746320496e0 * t71 * t74 * t97);
  tvrho0 = 0.2e1 * rho[0] * t102 + 0.2e1 * t65;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t109 = t46 * sigma[0];
  t110 = t26 * t52;
  t111 = t110 * t39;
  t114 = t110 * t93;
  t117 = 0.5e1 / 0.972e3 * t25 * t37 + 0.4002424276710846245e-2 * t25 * t40 - 0.33353535639257052042e-3 * t109 * t111 + 0.55121314827512630556e-4 * t109 * t114;
  t121 = my_piecewise3(t2, 0, -0.16551095363746320496e0 * t71 * t74 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t125 = 0.1e1 / t30 / rho[0];
  t130 = t66 * t73;
  t135 = 0.1e1 / t72 / t58;
  t136 = t18 * t135;
  t137 = t97 * t97;
  t142 = 0.1e1 / t30 / t49;
  t146 = t27 * t142;
  t147 = t146 * t39;
  t150 = t49 * t75;
  t152 = 0.1e1 / t18 / t150;
  t153 = t26 * t152;
  t154 = t153 * t39;
  t157 = t21 * t21;
  t158 = 0.1e1 / t157;
  t159 = t47 * sigma[0];
  t160 = t158 * t159;
  t161 = t49 * t49;
  t162 = t161 * t29;
  t163 = 0.1e1 / t162;
  t167 = t153 * t93;
  t172 = t20 / t23 / t157;
  t173 = t47 * t47;
  t174 = t172 * t173;
  t175 = t161 * t49;
  t177 = 0.1e1 / t30 / t175;
  t179 = t56 * t56;
  t180 = 0.1e1 / t179;
  t181 = t27 * t177 * t180;
  t184 = 0.11e3 / 0.2187e4 * t25 * t28 * t142 + 0.39134815150061607728e-1 * t36 * t147 - 0.800484855342169249e-2 * t85 * t154 + 0.11859034893958062948e-2 * t160 * t163 * t39 + 0.93093776153132442719e-3 * t85 * t167 - 0.12963666552805392131e-6 * t174 * t181;
  t189 = my_piecewise3(t2, 0, t6 * t17 * t125 * t61 / 0.12e2 - 0.11034063575830880331e0 * t71 * t130 * t97 + 0.33102190727492640992e0 * t71 * t136 * t137 - 0.16551095363746320496e0 * t71 * t74 * t184);
  tv2rho20 = 0.2e1 * rho[0] * t189 + 0.4e1 * t102;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t195 = t71 * t18;
  t196 = t135 * t117;
  t197 = t196 * t97;
  t204 = t46 * t26;
  t209 = t158 * t47;
  t210 = t161 * rho[0];
  t211 = 0.1e1 / t210;
  t217 = t172 * t159;
  t218 = t161 * t75;
  t220 = 0.1e1 / t30 / t218;
  t225 = -0.1e2 / 0.729e3 * t25 * t81 - 0.10673131404562256653e-1 * t25 * t82 + 0.26682828511405641633e-2 * t204 * t88 * sigma[0] * t39 - 0.44471380852342736056e-3 * t209 * t211 * t39 - 0.29398034574673402963e-3 * t109 * t94 + 0.48613749573020220489e-7 * t217 * t27 * t220 * t180;
  t230 = my_piecewise3(t2, 0, -0.55170317879154401653e-1 * t71 * t130 * t117 + 0.33102190727492640992e0 * t195 * t197 - 0.16551095363746320496e0 * t71 * t74 * t225);
  tv2rhosigma0 = 0.2e1 * rho[0] * t230 + 0.2e1 * t121;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t117 * t117;
  t239 = t158 * sigma[0];
  t240 = 0.1e1 / t161;
  t248 = 0.1e1 / t30 / t162;
  t250 = t27 * t248 * t180;
  t253 = -0.66707071278514104084e-3 * t46 * t111 + 0.16676767819628526021e-3 * t239 * t240 * t39 + 0.55121314827512630556e-4 * t46 * t114 - 0.18230156089882582683e-7 * t172 * t47 * t250;
  t258 = my_piecewise3(t2, 0, 0.33102190727492640992e0 * t71 * t136 * t233 - 0.16551095363746320496e0 * t71 * t74 * t253);
  tv2sigma20 = 0.2e1 * rho[0] * t258;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t265 = t125 * t73;
  t269 = t66 * t135;
  t276 = t72 * t72;
  t277 = 0.1e1 / t276;
  t278 = t18 * t277;
  t279 = t137 * t97;
  t283 = t135 * t97;
  t284 = t283 * t184;
  t288 = 0.1e1 / t30 / t50;
  t292 = t27 * t288;
  t293 = t292 * t39;
  t297 = 0.1e1 / t18 / t161;
  t298 = t26 * t297;
  t302 = 0.1e1 / t218;
  t306 = t158 * t173;
  t307 = t161 * t50;
  t309 = 0.1e1 / t30 / t307;
  t311 = t27 * t39;
  t312 = t25 * t311;
  t315 = t298 * t93;
  t319 = t27 * t309 * t180;
  t322 = t173 * t47;
  t323 = t161 * t161;
  t325 = 0.1e1 / t323 / t75;
  t328 = 0.1e1 / t179 / t56;
  t331 = -0.154e4 / 0.6561e4 * t25 * t28 * t288 - 0.1826291373669541694e0 * t36 * t293 + 0.67398848313994991088e-1 * t85 * t298 * t39 - 0.22532166298520319601e-1 * t160 * t302 * t39 + 0.13176705437731181053e-3 * t306 * t309 * t312 - 0.68268769178963791327e-2 * t85 * t315 + 0.24630966450330245049e-5 * t174 * t319 - 0.48197932879823405316e-13 * t322 * t325 * t328;
  t336 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t17 * t32 * t61 + 0.11034063575830880331e0 * t71 * t265 * t97 + 0.33102190727492640993e0 * t71 * t269 * t137 - 0.16551095363746320496e0 * t71 * t130 * t184 - 0.99306572182477922976e0 * t71 * t278 * t279 + 0.99306572182477922976e0 * t195 * t284 - 0.16551095363746320496e0 * t71 * t74 * t331);
  tv3rho30 = 0.2e1 * rho[0] * t336 + 0.6e1 * t189;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t343 = t71 * t66;
  t349 = t277 * t117;
  t350 = t349 * t137;
  t353 = t135 * t225;
  t354 = t353 * t97;
  t357 = t196 * t184;
  t368 = t158 * t163;
  t369 = t47 * t39;
  t379 = t173 * sigma[0];
  t381 = 0.1e1 / t323 / t29;
  t385 = 0.11e3 / 0.2187e4 * t25 * t146 + 0.39134815150061607728e-1 * t25 * t147 - 0.19270931702681852291e-1 * t204 * t152 * sigma[0] * t39 + 0.75601347448982651294e-2 * t368 * t369 - 0.49412645391491928951e-4 * t160 * t177 * t312 + 0.18618755230626488543e-2 * t109 * t167 - 0.82643374274134374831e-6 * t217 * t181 + 0.18074224829933776993e-13 * t379 * t381 * t328;
  t390 = my_piecewise3(t2, 0, 0.36780211919436267769e-1 * t71 * t265 * t117 + 0.22068127151661760662e0 * t343 * t197 - 0.11034063575830880331e0 * t71 * t130 * t225 - 0.99306572182477922976e0 * t195 * t350 + 0.66204381454985281984e0 * t195 * t354 + 0.33102190727492640992e0 * t195 * t357 - 0.16551095363746320496e0 * t71 * t74 * t385);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t390 + 0.4e1 * t230;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t396 = t277 * t233;
  t397 = t396 * t97;
  t400 = t196 * t225;
  t406 = t135 * t253;
  t407 = t406 * t97;
  t412 = t158 * t211;
  t413 = sigma[0] * t39;
  t421 = t172 * t27;
  t422 = t220 * t180;
  t426 = t323 * rho[0];
  t427 = 0.1e1 / t426;
  t431 = 0.35577104681874188845e-2 * t46 * t90 - 0.22235690426171368028e-2 * t412 * t413 + 0.18529742021809473357e-4 * t209 * t220 * t312 - 0.29398034574673402963e-3 * t46 * t94 + 0.24306874786510110244e-6 * t421 * t422 * t47 - 0.67778343112251663721e-14 * t173 * t427 * t328;
  t436 = my_piecewise3(t2, 0, 0.11034063575830880331e0 * t71 * t269 * t233 - 0.99306572182477922976e0 * t195 * t397 + 0.66204381454985281984e0 * t195 * t400 - 0.55170317879154401653e-1 * t71 * t130 * t253 + 0.33102190727492640992e0 * t195 * t407 - 0.16551095363746320496e0 * t71 * t74 * t431);
  tv3rhosigma20 = 0.2e1 * rho[0] * t436 + 0.2e1 * t258;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t439 = t233 * t117;
  t443 = t196 * t253;
  t456 = 0.1e1 / t323;
  t460 = 0.50030303458885578063e-3 * t158 * t240 * t39 - 0.69486532581785525088e-5 * t239 * t248 * t312 - 0.54690468269647748049e-7 * t421 * t248 * t180 * sigma[0] + 0.25416878667094373895e-14 * t159 * t456 * t328;
  t465 = my_piecewise3(t2, 0, -0.99306572182477922976e0 * t71 * t278 * t439 + 0.99306572182477922976e0 * t195 * t443 - 0.16551095363746320496e0 * t71 * t74 * t460);
  tv3sigma30 = 0.2e1 * rho[0] * t465;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t472 = t32 * t73;
  t476 = t125 * t135;
  t483 = t66 * t277;
  t493 = 0.1e1 / t276 / t58;
  t494 = t18 * t493;
  t495 = t137 * t137;
  t503 = t184 * t184;
  t511 = 0.1e1 / t30 / t86;
  t521 = t26 / t18 / t210;
  t529 = t161 * t86;
  t531 = 0.1e1 / t30 / t529;
  t540 = t46 * t26 * t39;
  t555 = t173 * t173;
  t560 = t179 * t179;
  t561 = 0.1e1 / t560;
  t569 = 0.1e2 / 0.27e2 * t6 * t17 * t77 * t61 - 0.24520141279624178513e0 * t71 * t472 * t97 - 0.44136254303323521324e0 * t71 * t476 * t137 + 0.22068127151661760662e0 * t71 * t265 * t184 - 0.13240876290997056397e1 * t71 * t483 * t279 + 0.13240876290997056397e1 * t343 * t284 - 0.22068127151661760661e0 * t71 * t130 * t331 + 0.3972262887299116919e1 * t71 * t494 * t495 - 0.59583943309486753786e1 * t195 * t277 * t137 * t184 + 0.99306572182477922976e0 * t71 * t136 * t503 + 0.13240876290997056397e1 * t195 * t283 * t331 - 0.16551095363746320496e0 * t71 * t74 * (0.2618e5 / 0.19683e5 * t25 * t28 * t511 + 0.10348984450794069599e1 * t36 * t27 * t511 * t39 - 0.60224132203150363004e0 * t85 * t521 * t39 + 0.33771896036905017039e0 * t160 / t175 * t39 - 0.43043904429921858107e-2 * t306 * t531 * t312 + 0.29281567639402624562e-4 * t158 * t379 / t18 / t426 * t540 + 0.56890640982469826106e-1 * t85 * t521 * t93 - 0.39683223725532061467e-4 * t174 * t27 * t531 * t180 + 0.1831521449433289402e-11 * t322 / t323 / t49 * t328 - 0.2125386745843254731e-16 * t555 / t18 / t323 / t210 * t561 * t204);
  t570 = my_piecewise3(t2, 0, t569);
  tv4rho40 = 0.2e1 * rho[0] * t570 + 0.8e1 * t336;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t653 = 0.3972262887299116919e1 * t195 * t493 * t117 * t279 - 0.29791971654743376893e1 * t195 * t349 * t97 * t184 + 0.33102190727492640992e0 * t195 * t196 * t331 + 0.99306572182477922976e0 * t195 * t353 * t184 + 0.99306572182477922976e0 * t195 * t135 * t385 * t97 - 0.29791971654743376893e1 * t195 * t277 * t225 * t137 + 0.66204381454985281985e0 * t343 * t354 + 0.33102190727492640993e0 * t343 * t357 - 0.61300353199060446282e-1 * t71 * t472 * t117 - 0.22068127151661760662e0 * t71 * t125 * t197 - 0.99306572182477922978e0 * t343 * t350 - 0.16551095363746320496e0 * t71 * t74 * (-0.154e4 / 0.6561e4 * t25 * t292 - 0.1826291373669541694e0 * t25 * t293 + 0.1500167914085694963e0 * t204 * t297 * sigma[0] * t39 - 0.10129592305255845435e0 * t158 * t302 * t369 + 0.14659084799475938922e-2 * t158 * t309 * t159 * t312 - 0.10980587864775984211e-4 * t306 / t18 / t323 * t540 - 0.13653753835792758265e-1 * t109 * t315 + 0.12110225171412370482e-4 * t217 * t319 - 0.63259786904768219474e-12 * t379 * t325 * t328 + 0.79702002969122052411e-17 * t173 * t159 / t18 / t323 / t161 * t561 * t204) + 0.11034063575830880331e0 * t71 * t265 * t225 - 0.16551095363746320496e0 * t71 * t130 * t385;
  t654 = my_piecewise3(t2, 0, t653);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t654 + 0.6e1 * t390;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t676 = t225 * t225;
  t736 = -0.7356042383887253554e-1 * t71 * t476 * t233 - 0.66204381454985281985e0 * t343 * t397 + 0.44136254303323521323e0 * t343 * t400 + 0.3972262887299116919e1 * t195 * t493 * t233 * t137 - 0.3972262887299116919e1 * t195 * t349 * t97 * t225 - 0.99306572182477922976e0 * t195 * t396 * t184 + 0.66204381454985281984e0 * t71 * t136 * t676 + 0.66204381454985281984e0 * t195 * t196 * t385 + 0.36780211919436267769e-1 * t71 * t265 * t253 + 0.22068127151661760662e0 * t343 * t407 - 0.11034063575830880331e0 * t71 * t130 * t431 - 0.99306572182477922976e0 * t195 * t277 * t253 * t137 + 0.66204381454985281984e0 * t195 * t135 * t431 * t97 + 0.33102190727492640992e0 * t195 * t406 * t184 - 0.16551095363746320496e0 * t71 * t74 * (-0.22532166298520319602e-1 * t46 * t154 + 0.24755735341137456404e-1 * t368 * t413 - 0.46324355054523683393e-3 * t158 * t177 * t47 * t312 + 0.41177204492909940793e-5 * t160 / t18 / t161 / t150 * t540 + 0.18618755230626488543e-2 * t46 * t167 - 0.30950753894822873711e-5 * t421 * t177 * t180 * t47 + 0.20559430744049671329e-12 * t381 * t328 * t173 - 0.29888251113420769653e-17 * t322 / t18 / t323 / t150 * t561 * t204);
  t737 = my_piecewise3(t2, 0, t736);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t737 + 0.4e1 * t436;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t800 = my_piecewise3(t2, 0, -0.33102190727492640992e0 * t71 * t483 * t439 + 0.3972262887299116919e1 * t195 * t493 * t439 * t97 - 0.29791971654743376893e1 * t195 * t396 * t225 + 0.33102190727492640992e0 * t343 * t443 - 0.29791971654743376893e1 * t195 * t349 * t253 * t97 + 0.99306572182477922976e0 * t195 * t353 * t253 + 0.99306572182477922976e0 * t195 * t196 * t431 - 0.55170317879154401653e-1 * t71 * t130 * t460 + 0.33102190727492640992e0 * t195 * t135 * t460 * t97 - 0.16551095363746320496e0 * t71 * t74 * (-0.4002424276710846245e-2 * t412 * t39 + 0.1297081941526663135e-3 * t158 * t220 * t20 * t24 * sigma[0] * t311 - 0.15441451684841227797e-5 * t209 / t18 / t529 * t540 + 0.58336499487624264586e-6 * t421 * t422 * sigma[0] - 0.61000508801026497348e-13 * t427 * t328 * t159 + 0.1120809416753278862e-17 * t379 / t18 / t323 / t86 * t561 * t204));
  tv4rhosigma30 = 0.2e1 * rho[0] * t800 + 0.2e1 * t465;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t803 = t233 * t233;
  t810 = t253 * t253;
  t845 = my_piecewise3(t2, 0, 0.3972262887299116919e1 * t71 * t494 * t803 - 0.59583943309486753786e1 * t195 * t396 * t253 + 0.99306572182477922976e0 * t71 * t136 * t810 + 0.13240876290997056397e1 * t195 * t196 * t460 - 0.16551095363746320496e0 * t71 * t74 * (-0.27794613032714210035e-4 * t158 * t248 * t20 * t24 * t27 * t39 + 0.5790544381815460424e-6 * t239 / t18 / t307 * t540 + 0.15250127200256624337e-13 * t456 * t328 * t47 - 0.54690468269647748049e-7 * t172 * t250 - 0.42030353128247957323e-18 * t173 / t18 / t323 / t50 * t561 * t204));
  tv4sigma40 = 0.2e1 * rho[0] * t845;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t47, t49, t50, t51, t52, t53, t55, t59;
  double t60, t61, t64, t68, t69, t70, t72, t73;
  double t74, t75, t77, t79, t80, t81, t83, t84;
  double t85, t88, t92, t93, t94, t96, t100, t101;
  double t102, t105, t109, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t43 = exp(-t40 / 0.24e2);
  t47 = t28 * t28;
  t49 = 0.1e1 / t30 / t29;
  t50 = t47 * t49;
  t51 = sigma[0] * sigma[0];
  t52 = t34 * t34;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t35 / t53;
  t59 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t51 * t55;
  t60 = log(t59);
  t61 = 0.804e0 + 0.5e1 / 0.972e3 * t40 + 0.4002424276710846245e-2 * t33 * t39 * t43 + t60;
  t64 = 0.1804e1 - 0.646416e0 / t61;
  t68 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t25 * t26 * t64);
  t69 = rho[1] <= p->dens_threshold;
  t70 = -t16;
  t72 = my_piecewise5(t14, t11, t10, t15, t70 * t7);
  t73 = 0.1e1 + t72;
  t74 = t73 <= p->zeta_threshold;
  t75 = POW_1_3(t73);
  t77 = my_piecewise3(t74, t22, t75 * t73);
  t79 = rho[1] * rho[1];
  t80 = POW_1_3(rho[1]);
  t81 = t80 * t80;
  t83 = 0.1e1 / t81 / t79;
  t84 = sigma[2] * t83;
  t85 = t33 * t84;
  t88 = exp(-t85 / 0.24e2);
  t92 = sigma[2] * sigma[2];
  t93 = t79 * t79;
  t94 = t93 * rho[1];
  t96 = 0.1e1 / t80 / t94;
  t100 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t92 * t96;
  t101 = log(t100);
  t102 = 0.804e0 + 0.5e1 / 0.972e3 * t85 + 0.4002424276710846245e-2 * t33 * t84 * t88 + t101;
  t105 = 0.1804e1 - 0.646416e0 / t102;
  t109 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t77 * t26 * t105);
  tzk0 = t68 + t109;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t47, t49, t50, t51, t52, t53, t55, t59;
  double t60, t61, t64, t68, t69, t70, t72, t73;
  double t74, t75, t77, t79, t80, t81, t83, t84;
  double t85, t88, t92, t93, t94, t96, t100, t101;
  double t102, t105, t109, tzk0;

  double t110, t111, t112, t114, t117, t122, t123, t127;
  double t128, t129, t130, t131, t132, t134, t135, t141;
  double t143, t144, t148, t152, t153, t157, t158, t160;
  double t163, t171, t173, tvrho0, t177, t180, t186, t188;
  double t191, t196, t197, t198, t199, t200, t202, t203;
  double t209, t211, t212, t216, t220, t221, t225, tvrho1;
  double t233, t240, t241, t244, tvsigma0, tvsigma1, t250, t257;
  double t258, t261, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t43 = exp(-t40 / 0.24e2);
  t47 = t28 * t28;
  t49 = 0.1e1 / t30 / t29;
  t50 = t47 * t49;
  t51 = sigma[0] * sigma[0];
  t52 = t34 * t34;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t35 / t53;
  t59 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t51 * t55;
  t60 = log(t59);
  t61 = 0.804e0 + 0.5e1 / 0.972e3 * t40 + 0.4002424276710846245e-2 * t33 * t39 * t43 + t60;
  t64 = 0.1804e1 - 0.646416e0 / t61;
  t68 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t25 * t26 * t64);
  t69 = rho[1] <= p->dens_threshold;
  t70 = -t16;
  t72 = my_piecewise5(t14, t11, t10, t15, t70 * t7);
  t73 = 0.1e1 + t72;
  t74 = t73 <= p->zeta_threshold;
  t75 = POW_1_3(t73);
  t77 = my_piecewise3(t74, t22, t75 * t73);
  t79 = rho[1] * rho[1];
  t80 = POW_1_3(rho[1]);
  t81 = t80 * t80;
  t83 = 0.1e1 / t81 / t79;
  t84 = sigma[2] * t83;
  t85 = t33 * t84;
  t88 = exp(-t85 / 0.24e2);
  t92 = sigma[2] * sigma[2];
  t93 = t79 * t79;
  t94 = t93 * rho[1];
  t96 = 0.1e1 / t80 / t94;
  t100 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t92 * t96;
  t101 = log(t100);
  t102 = 0.804e0 + 0.5e1 / 0.972e3 * t85 + 0.4002424276710846245e-2 * t33 * t84 * t88 + t101;
  t105 = 0.1804e1 - 0.646416e0 / t102;
  t109 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t77 * t26 * t105);
  tzk0 = t68 + t109;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t110 = t6 * t6;
  t111 = 0.1e1 / t110;
  t112 = t16 * t111;
  t114 = my_piecewise5(t10, 0, t14, 0, t7 - t112);
  t117 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t114);
  t122 = t26 * t26;
  t123 = 0.1e1 / t122;
  t127 = t5 * t25 * t123 * t64 / 0.8e1;
  t128 = t2 * t25;
  t129 = t61 * t61;
  t130 = 0.1e1 / t129;
  t131 = t26 * t130;
  t132 = t34 * rho[0];
  t134 = 0.1e1 / t36 / t132;
  t135 = sigma[0] * t134;
  t141 = t52 * t34;
  t143 = 0.1e1 / t35 / t141;
  t144 = t51 * t143;
  t148 = 0.1e1 / t59;
  t152 = -0.1e2 / 0.729e3 * t33 * t135 - 0.10673131404562256653e-1 * t33 * t135 * t43 + 0.44471380852342736056e-3 * t50 * t144 * t43 - 0.73495086436683507408e-4 * t50 * t144 * t148;
  t153 = t131 * t152;
  t157 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t26 * t64 - t127 - 0.16551095363746320496e0 * t128 * t153);
  t158 = t70 * t111;
  t160 = my_piecewise5(t14, 0, t10, 0, -t7 - t158);
  t163 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t160);
  t171 = t5 * t77 * t123 * t105 / 0.8e1;
  t173 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t163 * t26 * t105 - t171);
  tvrho0 = t68 + t109 + t6 * (t157 + t173);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t177 = my_piecewise5(t10, 0, t14, 0, -t7 - t112);
  t180 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t177);
  t186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t26 * t64 - t127);
  t188 = my_piecewise5(t14, 0, t10, 0, t7 - t158);
  t191 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t188);
  t196 = t2 * t77;
  t197 = t102 * t102;
  t198 = 0.1e1 / t197;
  t199 = t26 * t198;
  t200 = t79 * rho[1];
  t202 = 0.1e1 / t81 / t200;
  t203 = sigma[2] * t202;
  t209 = t93 * t79;
  t211 = 0.1e1 / t80 / t209;
  t212 = t92 * t211;
  t216 = 0.1e1 / t100;
  t220 = -0.1e2 / 0.729e3 * t33 * t203 - 0.10673131404562256653e-1 * t33 * t203 * t88 + 0.44471380852342736056e-3 * t50 * t212 * t88 - 0.73495086436683507408e-4 * t50 * t212 * t216;
  t221 = t199 * t220;
  t225 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t191 * t26 * t105 - t171 - 0.16551095363746320496e0 * t196 * t221);
  tvrho1 = t68 + t109 + t6 * (t186 + t225);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t233 = sigma[0] * t55;
  t240 = 0.5e1 / 0.972e3 * t33 * t38 + 0.4002424276710846245e-2 * t33 * t38 * t43 - 0.16676767819628526021e-3 * t50 * t233 * t43 + 0.27560657413756315278e-4 * t50 * t233 * t148;
  t241 = t131 * t240;
  t244 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t128 * t241);
  tvsigma0 = t6 * t244;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t250 = sigma[2] * t96;
  t257 = 0.5e1 / 0.972e3 * t33 * t83 + 0.4002424276710846245e-2 * t33 * t83 * t88 - 0.16676767819628526021e-3 * t50 * t250 * t88 + 0.27560657413756315278e-4 * t50 * t250 * t216;
  t258 = t199 * t257;
  t261 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t196 * t258);
  tvsigma2 = t6 * t261;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t47, t49, t50, t51, t52, t53, t55, t59;
  double t60, t61, t64, t68, t69, t70, t72, t73;
  double t74, t75, t77, t79, t80, t81, t83, t84;
  double t85, t88, t92, t93, t94, t96, t100, t101;
  double t102, t105, t109, tzk0;

  double t110, t111, t112, t114, t117, t122, t123, t127;
  double t128, t129, t130, t131, t132, t134, t135, t141;
  double t143, t144, t148, t152, t153, t157, t158, t160;
  double t163, t171, t173, tvrho0, t177, t180, t186, t188;
  double t191, t196, t197, t198, t199, t200, t202, t203;
  double t209, t211, t212, t216, t220, t221, t225, tvrho1;
  double t233, t240, t241, t244, tvsigma0, tvsigma1, t250, t257;
  double t258, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t274, t278;
  double t285, t287, t291, t295, t296, t297, t298, t301;
  double t302, t303, t304, t308, t309, t315, t317, t318;
  double t322, t323, t324, t325, t326, t327, t328, t337;
  double t338, t339, t341, t343, t344, t348, t349, t353;
  double t354, t355, t356, t359, t362, t366, t373, t378;
  double t380, tv2rho20, t383, t387, t391, t398, t400, t406;
  double t407, t411, t415, t422, t425, t428, t429, t430;
  double t433, tv2rho21, t438, t443, t447, t454, t455, t460;
  double t464, t470, t475, t476, t477, t478, t482, t483;
  double t489, t491, t492, t496, t497, t498, t499, t500;
  double t507, t508, t510, t512, t513, t517, t518, t522;
  double tv2rho22, t527, t529, t530, t531, t532, t540, t544;
  double t545, t546, t553, t555, t560, t561, t565, tv2rhosigma0;
  double tv2rhosigma1, t569, t571, t573, tv2rhosigma2, t578, tv2rhosigma3, tv2rhosigma4;
  double t582, t583, t584, t592, t596, t597, t598, t605;
  double t607, t612, t613, t617, tv2rhosigma5, t619, t620, t626;
  double t627, t635, t640, t641, t645, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t646, t647, t653, t654, t662, t667;
  double t668, t672, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t43 = exp(-t40 / 0.24e2);
  t47 = t28 * t28;
  t49 = 0.1e1 / t30 / t29;
  t50 = t47 * t49;
  t51 = sigma[0] * sigma[0];
  t52 = t34 * t34;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t35 / t53;
  t59 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t51 * t55;
  t60 = log(t59);
  t61 = 0.804e0 + 0.5e1 / 0.972e3 * t40 + 0.4002424276710846245e-2 * t33 * t39 * t43 + t60;
  t64 = 0.1804e1 - 0.646416e0 / t61;
  t68 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t25 * t26 * t64);
  t69 = rho[1] <= p->dens_threshold;
  t70 = -t16;
  t72 = my_piecewise5(t14, t11, t10, t15, t70 * t7);
  t73 = 0.1e1 + t72;
  t74 = t73 <= p->zeta_threshold;
  t75 = POW_1_3(t73);
  t77 = my_piecewise3(t74, t22, t75 * t73);
  t79 = rho[1] * rho[1];
  t80 = POW_1_3(rho[1]);
  t81 = t80 * t80;
  t83 = 0.1e1 / t81 / t79;
  t84 = sigma[2] * t83;
  t85 = t33 * t84;
  t88 = exp(-t85 / 0.24e2);
  t92 = sigma[2] * sigma[2];
  t93 = t79 * t79;
  t94 = t93 * rho[1];
  t96 = 0.1e1 / t80 / t94;
  t100 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t92 * t96;
  t101 = log(t100);
  t102 = 0.804e0 + 0.5e1 / 0.972e3 * t85 + 0.4002424276710846245e-2 * t33 * t84 * t88 + t101;
  t105 = 0.1804e1 - 0.646416e0 / t102;
  t109 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t77 * t26 * t105);
  tzk0 = t68 + t109;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t110 = t6 * t6;
  t111 = 0.1e1 / t110;
  t112 = t16 * t111;
  t114 = my_piecewise5(t10, 0, t14, 0, t7 - t112);
  t117 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t114);
  t122 = t26 * t26;
  t123 = 0.1e1 / t122;
  t127 = t5 * t25 * t123 * t64 / 0.8e1;
  t128 = t2 * t25;
  t129 = t61 * t61;
  t130 = 0.1e1 / t129;
  t131 = t26 * t130;
  t132 = t34 * rho[0];
  t134 = 0.1e1 / t36 / t132;
  t135 = sigma[0] * t134;
  t141 = t52 * t34;
  t143 = 0.1e1 / t35 / t141;
  t144 = t51 * t143;
  t148 = 0.1e1 / t59;
  t152 = -0.1e2 / 0.729e3 * t33 * t135 - 0.10673131404562256653e-1 * t33 * t135 * t43 + 0.44471380852342736056e-3 * t50 * t144 * t43 - 0.73495086436683507408e-4 * t50 * t144 * t148;
  t153 = t131 * t152;
  t157 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t26 * t64 - t127 - 0.16551095363746320496e0 * t128 * t153);
  t158 = t70 * t111;
  t160 = my_piecewise5(t14, 0, t10, 0, -t7 - t158);
  t163 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t160);
  t171 = t5 * t77 * t123 * t105 / 0.8e1;
  t173 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t163 * t26 * t105 - t171);
  tvrho0 = t68 + t109 + t6 * (t157 + t173);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t177 = my_piecewise5(t10, 0, t14, 0, -t7 - t112);
  t180 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t177);
  t186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t26 * t64 - t127);
  t188 = my_piecewise5(t14, 0, t10, 0, t7 - t158);
  t191 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t188);
  t196 = t2 * t77;
  t197 = t102 * t102;
  t198 = 0.1e1 / t197;
  t199 = t26 * t198;
  t200 = t79 * rho[1];
  t202 = 0.1e1 / t81 / t200;
  t203 = sigma[2] * t202;
  t209 = t93 * t79;
  t211 = 0.1e1 / t80 / t209;
  t212 = t92 * t211;
  t216 = 0.1e1 / t100;
  t220 = -0.1e2 / 0.729e3 * t33 * t203 - 0.10673131404562256653e-1 * t33 * t203 * t88 + 0.44471380852342736056e-3 * t50 * t212 * t88 - 0.73495086436683507408e-4 * t50 * t212 * t216;
  t221 = t199 * t220;
  t225 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t191 * t26 * t105 - t171 - 0.16551095363746320496e0 * t196 * t221);
  tvrho1 = t68 + t109 + t6 * (t186 + t225);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t233 = sigma[0] * t55;
  t240 = 0.5e1 / 0.972e3 * t33 * t38 + 0.4002424276710846245e-2 * t33 * t38 * t43 - 0.16676767819628526021e-3 * t50 * t233 * t43 + 0.27560657413756315278e-4 * t50 * t233 * t148;
  t241 = t131 * t240;
  t244 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t128 * t241);
  tvsigma0 = t6 * t244;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t250 = sigma[2] * t96;
  t257 = 0.5e1 / 0.972e3 * t33 * t83 + 0.4002424276710846245e-2 * t33 * t83 * t88 - 0.16676767819628526021e-3 * t50 * t250 * t88 + 0.27560657413756315278e-4 * t50 * t250 * t216;
  t258 = t199 * t257;
  t261 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t196 * t258);
  tvsigma2 = t6 * t261;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t114 * t114;
  t269 = t110 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t274 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t111 + 0.2e1 * t271);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t285 = t5 * t117 * t123 * t64;
  t287 = t2 * t117;
  t291 = 0.1e1 / t122 / t6;
  t295 = t5 * t25 * t291 * t64 / 0.12e2;
  t296 = t123 * t130;
  t297 = t296 * t152;
  t298 = t128 * t297;
  t301 = 0.1e1 / t129 / t61;
  t302 = t26 * t301;
  t303 = t152 * t152;
  t304 = t302 * t303;
  t308 = 0.1e1 / t36 / t52;
  t309 = sigma[0] * t308;
  t315 = t52 * t132;
  t317 = 0.1e1 / t35 / t315;
  t318 = t51 * t317;
  t322 = t29 * t29;
  t323 = 0.1e1 / t322;
  t324 = t51 * sigma[0];
  t325 = t323 * t324;
  t326 = t52 * t52;
  t327 = t326 * t34;
  t328 = 0.1e1 / t327;
  t337 = t28 / t31 / t322;
  t338 = t51 * t51;
  t339 = t326 * t52;
  t341 = 0.1e1 / t36 / t339;
  t343 = t59 * t59;
  t344 = 0.1e1 / t343;
  t348 = 0.11e3 / 0.2187e4 * t33 * t309 + 0.39134815150061607728e-1 * t33 * t309 * t43 - 0.4002424276710846245e-2 * t50 * t318 * t43 + 0.29647587234895157371e-3 * t325 * t328 * t43 + 0.46546888076566221358e-3 * t50 * t318 * t148 - 0.32409166382013480325e-7 * t337 * t338 * t341 * t344;
  t349 = t131 * t348;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t278 * t26 * t64 - t285 / 0.4e1 - 0.33102190727492640992e0 * t287 * t153 + t295 - 0.11034063575830880331e0 * t298 + 0.33102190727492640992e0 * t128 * t304 - 0.16551095363746320496e0 * t128 * t349);
  t354 = t75 * t75;
  t355 = 0.1e1 / t354;
  t356 = t160 * t160;
  t359 = t70 * t270;
  t362 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t111 + 0.2e1 * t359);
  t366 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t75 * t362);
  t373 = t5 * t163 * t123 * t105;
  t378 = t5 * t77 * t291 * t105 / 0.12e2;
  t380 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t366 * t26 * t105 - t373 / 0.4e1 + t378);
  tv2rho20 = 0.2e1 * t157 + 0.2e1 * t173 + t6 * (t353 + t380);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t383 = t265 * t177;
  t387 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t271);
  t391 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t383 * t114 + 0.4e1 / 0.3e1 * t23 * t387);
  t398 = t5 * t180 * t123 * t64;
  t400 = t2 * t180;
  t406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t391 * t26 * t64 - t398 / 0.8e1 - 0.16551095363746320496e0 * t400 * t153 - t285 / 0.8e1 + t295 - 0.55170317879154401654e-1 * t298);
  t407 = t355 * t188;
  t411 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t359);
  t415 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t407 * t160 + 0.4e1 / 0.3e1 * t75 * t411);
  t422 = t5 * t191 * t123 * t105;
  t425 = t2 * t163;
  t428 = t123 * t198;
  t429 = t428 * t220;
  t430 = t196 * t429;
  t433 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t415 * t26 * t105 - t422 / 0.8e1 - t373 / 0.8e1 + t378 - 0.16551095363746320496e0 * t425 * t221 - 0.55170317879154401653e-1 * t430);
  tv2rho21 = t157 + t173 + t186 + t225 + t6 * (t406 + t433);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t438 = t177 * t177;
  t443 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t111 + 0.2e1 * t271);
  t447 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t438 + 0.4e1 / 0.3e1 * t23 * t443);
  t454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t447 * t26 * t64 - t398 / 0.4e1 + t295);
  t455 = t188 * t188;
  t460 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t111 + 0.2e1 * t359);
  t464 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t455 + 0.4e1 / 0.3e1 * t75 * t460);
  t470 = t2 * t191;
  t475 = 0.1e1 / t197 / t102;
  t476 = t26 * t475;
  t477 = t220 * t220;
  t478 = t476 * t477;
  t482 = 0.1e1 / t81 / t93;
  t483 = sigma[2] * t482;
  t489 = t93 * t200;
  t491 = 0.1e1 / t80 / t489;
  t492 = t92 * t491;
  t496 = t92 * sigma[2];
  t497 = t323 * t496;
  t498 = t93 * t93;
  t499 = t498 * t79;
  t500 = 0.1e1 / t499;
  t507 = t92 * t92;
  t508 = t498 * t93;
  t510 = 0.1e1 / t81 / t508;
  t512 = t100 * t100;
  t513 = 0.1e1 / t512;
  t517 = 0.11e3 / 0.2187e4 * t33 * t483 + 0.39134815150061607728e-1 * t33 * t483 * t88 - 0.4002424276710846245e-2 * t50 * t492 * t88 + 0.29647587234895157371e-3 * t497 * t500 * t88 + 0.46546888076566221358e-3 * t50 * t492 * t216 - 0.32409166382013480325e-7 * t337 * t507 * t510 * t513;
  t518 = t199 * t517;
  t522 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t464 * t26 * t105 - t422 / 0.4e1 - 0.33102190727492640992e0 * t470 * t221 + t378 - 0.11034063575830880331e0 * t430 + 0.33102190727492640992e0 * t196 * t478 - 0.16551095363746320496e0 * t196 * t518);
  tv2rho22 = 0.2e1 * t186 + 0.2e1 * t225 + t6 * (t454 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t527 = t296 * t240;
  t529 = 0.55170317879154401653e-1 * t128 * t527;
  t530 = t128 * t26;
  t531 = t301 * t240;
  t532 = t531 * t152;
  t540 = t143 * sigma[0];
  t544 = t323 * t51;
  t545 = t326 * rho[0];
  t546 = 0.1e1 / t545;
  t553 = t326 * t132;
  t555 = 0.1e1 / t36 / t553;
  t560 = -0.1e2 / 0.729e3 * t33 * t134 - 0.10673131404562256653e-1 * t33 * t134 * t43 + 0.13341414255702820817e-2 * t50 * t540 * t43 - 0.11117845213085684014e-3 * t544 * t546 * t43 - 0.14699017287336701482e-3 * t50 * t540 * t148 + 0.12153437393255055122e-7 * t337 * t324 * t555 * t344;
  t561 = t131 * t560;
  t565 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t287 * t241 - t529 + 0.33102190727492640992e0 * t530 * t532 - 0.16551095363746320496e0 * t128 * t561);
  tv2rhosigma0 = t6 * t565 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t569 = t428 * t257;
  t571 = 0.55170317879154401653e-1 * t196 * t569;
  t573 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t425 * t258 - t571);
  tv2rhosigma2 = t6 * t573 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t578 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t400 * t241 - t529);
  tv2rhosigma3 = t6 * t578 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t582 = t196 * t26;
  t583 = t475 * t257;
  t584 = t583 * t220;
  t592 = t211 * sigma[2];
  t596 = t323 * t92;
  t597 = t498 * rho[1];
  t598 = 0.1e1 / t597;
  t605 = t498 * t200;
  t607 = 0.1e1 / t81 / t605;
  t612 = -0.1e2 / 0.729e3 * t33 * t202 - 0.10673131404562256653e-1 * t33 * t202 * t88 + 0.13341414255702820817e-2 * t50 * t592 * t88 - 0.11117845213085684014e-3 * t596 * t598 * t88 - 0.14699017287336701482e-3 * t50 * t592 * t216 + 0.12153437393255055122e-7 * t337 * t496 * t607 * t513;
  t613 = t199 * t612;
  t617 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t470 * t258 - t571 + 0.33102190727492640992e0 * t582 * t584 - 0.16551095363746320496e0 * t196 * t613);
  tv2rhosigma5 = t6 * t617 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t619 = t240 * t240;
  t620 = t302 * t619;
  t626 = t323 * sigma[0];
  t627 = 0.1e1 / t326;
  t635 = 0.1e1 / t36 / t327;
  t640 = -0.33353535639257052042e-3 * t50 * t55 * t43 + 0.41691919549071315052e-4 * t626 * t627 * t43 + 0.27560657413756315278e-4 * t50 * t55 * t148 - 0.45575390224706456708e-8 * t337 * t51 * t635 * t344;
  t641 = t131 * t640;
  t645 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t128 * t620 - 0.16551095363746320496e0 * t128 * t641);
  tv2sigma20 = t6 * t645;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t646 = t257 * t257;
  t647 = t476 * t646;
  t653 = t323 * sigma[2];
  t654 = 0.1e1 / t498;
  t662 = 0.1e1 / t81 / t499;
  t667 = -0.33353535639257052042e-3 * t50 * t96 * t88 + 0.41691919549071315052e-4 * t653 * t654 * t88 + 0.27560657413756315278e-4 * t50 * t96 * t216 - 0.45575390224706456708e-8 * t337 * t92 * t662 * t513;
  t668 = t199 * t667;
  t672 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t196 * t647 - 0.16551095363746320496e0 * t196 * t668);
  tv2sigma25 = t6 * t672;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t47, t49, t50, t51, t52, t53, t55, t59;
  double t60, t61, t64, t68, t69, t70, t72, t73;
  double t74, t75, t77, t79, t80, t81, t83, t84;
  double t85, t88, t92, t93, t94, t96, t100, t101;
  double t102, t105, t109, tzk0;

  double t110, t111, t112, t114, t117, t122, t123, t127;
  double t128, t129, t130, t131, t132, t134, t135, t141;
  double t143, t144, t148, t152, t153, t157, t158, t160;
  double t163, t171, t173, tvrho0, t177, t180, t186, t188;
  double t191, t196, t197, t198, t199, t200, t202, t203;
  double t209, t211, t212, t216, t220, t221, t225, tvrho1;
  double t233, t240, t241, t244, tvsigma0, tvsigma1, t250, t257;
  double t258, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t274, t278;
  double t285, t287, t291, t295, t296, t297, t298, t301;
  double t302, t303, t304, t308, t309, t315, t317, t318;
  double t322, t323, t324, t325, t326, t327, t328, t337;
  double t338, t339, t341, t343, t344, t348, t349, t353;
  double t354, t355, t356, t359, t362, t366, t373, t378;
  double t380, tv2rho20, t383, t387, t391, t398, t400, t406;
  double t407, t411, t415, t422, t425, t428, t429, t430;
  double t433, tv2rho21, t438, t443, t447, t454, t455, t460;
  double t464, t470, t475, t476, t477, t478, t482, t483;
  double t489, t491, t492, t496, t497, t498, t499, t500;
  double t507, t508, t510, t512, t513, t517, t518, t522;
  double tv2rho22, t527, t529, t530, t531, t532, t540, t544;
  double t545, t546, t553, t555, t560, t561, t565, tv2rhosigma0;
  double tv2rhosigma1, t569, t571, t573, tv2rhosigma2, t578, tv2rhosigma3, tv2rhosigma4;
  double t582, t583, t584, t592, t596, t597, t598, t605;
  double t607, t612, t613, t617, tv2rhosigma5, t619, t620, t626;
  double t627, t635, t640, t641, t645, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t646, t647, t653, t654, t662, t667;
  double t668, t672, tv2sigma25;

  double t676, t677, t684, t685, t689, t693, t694, t696;
  double t698, t708, t709, t711, t714, t717, t718, t721;
  double t722, t723, t725, t726, t728, t731, t735, t736;
  double t737, t738, t739, t743, t747, t751, t752, t753;
  double t754, t758, t762, t767, t768, t771, t774, t775;
  double t776, t779, t783, t788, t789, t791, t792, t795;
  double t798, t801, t805, t812, t816, t821, t823, tv3rho30;
  double t826, t827, t828, t831, t836, t837, t839, t843;
  double t851, t852, t857, t860, t871, t872, t873, t876;
  double t881, t883, t887, t895, t898, t902, t906, t907;
  double t908, t909, t912, tv3rho31, t915, t920, t924, t928;
  double t935, t937, t944, t945, t950, t954, t958, t965;
  double t968, t971, t977, t978, t979, t983, t984, t986;
  double t987, tv3rho32, t992, t999, t1003, t1011, t1013, t1014;
  double t1021, t1022, t1026, t1030, t1031, t1033, t1035, t1045;
  double t1046, t1048, t1051, t1054, t1055, t1058, t1063, t1070;
  double t1074, t1079, t1080, t1081, t1082, t1083, t1087, t1098;
  double t1099, tv3rho33, t1105, t1107, t1112, t1114, t1115, t1116;
  double t1118, t1119, t1121, t1122, t1125, t1126, t1129, t1137;
  double t1141, t1142, t1155, t1157, t1161, t1162, t1165, t1166;
  double tv3rho2sigma0, tv3rho2sigma1, t1171, t1173, t1175, t1177, tv3rho2sigma2, t1181;
  double t1183, t1192, tv3rho2sigma3, tv3rho2sigma4, t1196, t1199, t1202, t1203;
  double t1207, t1208, t1211, tv3rho2sigma5, t1218, tv3rho2sigma6, tv3rho2sigma7, t1224;
  double t1231, t1232, t1235, t1236, t1239, t1247, t1251, t1252;
  double t1265, t1267, t1271, t1272, t1275, t1276, tv3rho2sigma8, t1280;
  double t1282, t1283, t1284, t1287, t1292, t1294, t1295, t1296;
  double t1302, t1303, t1312, t1316, t1317, t1321, t1322, t1326;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1330, t1332, t1335;
  double t1337, t1339, tv3rhosigma25, t1346, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t1350, t1351, t1354, t1359, t1360, t1366, t1367;
  double t1376, t1380, t1381, t1385, t1386, t1390, tv3rhosigma211, t1392;
  double t1393, t1396, t1405, t1409, t1413, t1414, t1418, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1419, t1420, t1423, t1432, t1436, t1440, t1441, t1445;
  double tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t43 = exp(-t40 / 0.24e2);
  t47 = t28 * t28;
  t49 = 0.1e1 / t30 / t29;
  t50 = t47 * t49;
  t51 = sigma[0] * sigma[0];
  t52 = t34 * t34;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t35 / t53;
  t59 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t51 * t55;
  t60 = log(t59);
  t61 = 0.804e0 + 0.5e1 / 0.972e3 * t40 + 0.4002424276710846245e-2 * t33 * t39 * t43 + t60;
  t64 = 0.1804e1 - 0.646416e0 / t61;
  t68 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t25 * t26 * t64);
  t69 = rho[1] <= p->dens_threshold;
  t70 = -t16;
  t72 = my_piecewise5(t14, t11, t10, t15, t70 * t7);
  t73 = 0.1e1 + t72;
  t74 = t73 <= p->zeta_threshold;
  t75 = POW_1_3(t73);
  t77 = my_piecewise3(t74, t22, t75 * t73);
  t79 = rho[1] * rho[1];
  t80 = POW_1_3(rho[1]);
  t81 = t80 * t80;
  t83 = 0.1e1 / t81 / t79;
  t84 = sigma[2] * t83;
  t85 = t33 * t84;
  t88 = exp(-t85 / 0.24e2);
  t92 = sigma[2] * sigma[2];
  t93 = t79 * t79;
  t94 = t93 * rho[1];
  t96 = 0.1e1 / t80 / t94;
  t100 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t92 * t96;
  t101 = log(t100);
  t102 = 0.804e0 + 0.5e1 / 0.972e3 * t85 + 0.4002424276710846245e-2 * t33 * t84 * t88 + t101;
  t105 = 0.1804e1 - 0.646416e0 / t102;
  t109 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t77 * t26 * t105);
  tzk0 = t68 + t109;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t110 = t6 * t6;
  t111 = 0.1e1 / t110;
  t112 = t16 * t111;
  t114 = my_piecewise5(t10, 0, t14, 0, t7 - t112);
  t117 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t114);
  t122 = t26 * t26;
  t123 = 0.1e1 / t122;
  t127 = t5 * t25 * t123 * t64 / 0.8e1;
  t128 = t2 * t25;
  t129 = t61 * t61;
  t130 = 0.1e1 / t129;
  t131 = t26 * t130;
  t132 = t34 * rho[0];
  t134 = 0.1e1 / t36 / t132;
  t135 = sigma[0] * t134;
  t141 = t52 * t34;
  t143 = 0.1e1 / t35 / t141;
  t144 = t51 * t143;
  t148 = 0.1e1 / t59;
  t152 = -0.1e2 / 0.729e3 * t33 * t135 - 0.10673131404562256653e-1 * t33 * t135 * t43 + 0.44471380852342736056e-3 * t50 * t144 * t43 - 0.73495086436683507408e-4 * t50 * t144 * t148;
  t153 = t131 * t152;
  t157 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t26 * t64 - t127 - 0.16551095363746320496e0 * t128 * t153);
  t158 = t70 * t111;
  t160 = my_piecewise5(t14, 0, t10, 0, -t7 - t158);
  t163 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t160);
  t171 = t5 * t77 * t123 * t105 / 0.8e1;
  t173 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t163 * t26 * t105 - t171);
  tvrho0 = t68 + t109 + t6 * (t157 + t173);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t177 = my_piecewise5(t10, 0, t14, 0, -t7 - t112);
  t180 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t177);
  t186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t26 * t64 - t127);
  t188 = my_piecewise5(t14, 0, t10, 0, t7 - t158);
  t191 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t188);
  t196 = t2 * t77;
  t197 = t102 * t102;
  t198 = 0.1e1 / t197;
  t199 = t26 * t198;
  t200 = t79 * rho[1];
  t202 = 0.1e1 / t81 / t200;
  t203 = sigma[2] * t202;
  t209 = t93 * t79;
  t211 = 0.1e1 / t80 / t209;
  t212 = t92 * t211;
  t216 = 0.1e1 / t100;
  t220 = -0.1e2 / 0.729e3 * t33 * t203 - 0.10673131404562256653e-1 * t33 * t203 * t88 + 0.44471380852342736056e-3 * t50 * t212 * t88 - 0.73495086436683507408e-4 * t50 * t212 * t216;
  t221 = t199 * t220;
  t225 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t191 * t26 * t105 - t171 - 0.16551095363746320496e0 * t196 * t221);
  tvrho1 = t68 + t109 + t6 * (t186 + t225);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t233 = sigma[0] * t55;
  t240 = 0.5e1 / 0.972e3 * t33 * t38 + 0.4002424276710846245e-2 * t33 * t38 * t43 - 0.16676767819628526021e-3 * t50 * t233 * t43 + 0.27560657413756315278e-4 * t50 * t233 * t148;
  t241 = t131 * t240;
  t244 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t128 * t241);
  tvsigma0 = t6 * t244;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t250 = sigma[2] * t96;
  t257 = 0.5e1 / 0.972e3 * t33 * t83 + 0.4002424276710846245e-2 * t33 * t83 * t88 - 0.16676767819628526021e-3 * t50 * t250 * t88 + 0.27560657413756315278e-4 * t50 * t250 * t216;
  t258 = t199 * t257;
  t261 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t196 * t258);
  tvsigma2 = t6 * t261;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t114 * t114;
  t269 = t110 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t274 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t111 + 0.2e1 * t271);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t285 = t5 * t117 * t123 * t64;
  t287 = t2 * t117;
  t291 = 0.1e1 / t122 / t6;
  t295 = t5 * t25 * t291 * t64 / 0.12e2;
  t296 = t123 * t130;
  t297 = t296 * t152;
  t298 = t128 * t297;
  t301 = 0.1e1 / t129 / t61;
  t302 = t26 * t301;
  t303 = t152 * t152;
  t304 = t302 * t303;
  t308 = 0.1e1 / t36 / t52;
  t309 = sigma[0] * t308;
  t315 = t52 * t132;
  t317 = 0.1e1 / t35 / t315;
  t318 = t51 * t317;
  t322 = t29 * t29;
  t323 = 0.1e1 / t322;
  t324 = t51 * sigma[0];
  t325 = t323 * t324;
  t326 = t52 * t52;
  t327 = t326 * t34;
  t328 = 0.1e1 / t327;
  t337 = t28 / t31 / t322;
  t338 = t51 * t51;
  t339 = t326 * t52;
  t341 = 0.1e1 / t36 / t339;
  t343 = t59 * t59;
  t344 = 0.1e1 / t343;
  t348 = 0.11e3 / 0.2187e4 * t33 * t309 + 0.39134815150061607728e-1 * t33 * t309 * t43 - 0.4002424276710846245e-2 * t50 * t318 * t43 + 0.29647587234895157371e-3 * t325 * t328 * t43 + 0.46546888076566221358e-3 * t50 * t318 * t148 - 0.32409166382013480325e-7 * t337 * t338 * t341 * t344;
  t349 = t131 * t348;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t278 * t26 * t64 - t285 / 0.4e1 - 0.33102190727492640992e0 * t287 * t153 + t295 - 0.11034063575830880331e0 * t298 + 0.33102190727492640992e0 * t128 * t304 - 0.16551095363746320496e0 * t128 * t349);
  t354 = t75 * t75;
  t355 = 0.1e1 / t354;
  t356 = t160 * t160;
  t359 = t70 * t270;
  t362 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t111 + 0.2e1 * t359);
  t366 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t75 * t362);
  t373 = t5 * t163 * t123 * t105;
  t378 = t5 * t77 * t291 * t105 / 0.12e2;
  t380 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t366 * t26 * t105 - t373 / 0.4e1 + t378);
  tv2rho20 = 0.2e1 * t157 + 0.2e1 * t173 + t6 * (t353 + t380);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t383 = t265 * t177;
  t387 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t271);
  t391 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t383 * t114 + 0.4e1 / 0.3e1 * t23 * t387);
  t398 = t5 * t180 * t123 * t64;
  t400 = t2 * t180;
  t406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t391 * t26 * t64 - t398 / 0.8e1 - 0.16551095363746320496e0 * t400 * t153 - t285 / 0.8e1 + t295 - 0.55170317879154401654e-1 * t298);
  t407 = t355 * t188;
  t411 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t359);
  t415 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t407 * t160 + 0.4e1 / 0.3e1 * t75 * t411);
  t422 = t5 * t191 * t123 * t105;
  t425 = t2 * t163;
  t428 = t123 * t198;
  t429 = t428 * t220;
  t430 = t196 * t429;
  t433 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t415 * t26 * t105 - t422 / 0.8e1 - t373 / 0.8e1 + t378 - 0.16551095363746320496e0 * t425 * t221 - 0.55170317879154401653e-1 * t430);
  tv2rho21 = t157 + t173 + t186 + t225 + t6 * (t406 + t433);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t438 = t177 * t177;
  t443 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t111 + 0.2e1 * t271);
  t447 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t438 + 0.4e1 / 0.3e1 * t23 * t443);
  t454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t447 * t26 * t64 - t398 / 0.4e1 + t295);
  t455 = t188 * t188;
  t460 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t111 + 0.2e1 * t359);
  t464 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t455 + 0.4e1 / 0.3e1 * t75 * t460);
  t470 = t2 * t191;
  t475 = 0.1e1 / t197 / t102;
  t476 = t26 * t475;
  t477 = t220 * t220;
  t478 = t476 * t477;
  t482 = 0.1e1 / t81 / t93;
  t483 = sigma[2] * t482;
  t489 = t93 * t200;
  t491 = 0.1e1 / t80 / t489;
  t492 = t92 * t491;
  t496 = t92 * sigma[2];
  t497 = t323 * t496;
  t498 = t93 * t93;
  t499 = t498 * t79;
  t500 = 0.1e1 / t499;
  t507 = t92 * t92;
  t508 = t498 * t93;
  t510 = 0.1e1 / t81 / t508;
  t512 = t100 * t100;
  t513 = 0.1e1 / t512;
  t517 = 0.11e3 / 0.2187e4 * t33 * t483 + 0.39134815150061607728e-1 * t33 * t483 * t88 - 0.4002424276710846245e-2 * t50 * t492 * t88 + 0.29647587234895157371e-3 * t497 * t500 * t88 + 0.46546888076566221358e-3 * t50 * t492 * t216 - 0.32409166382013480325e-7 * t337 * t507 * t510 * t513;
  t518 = t199 * t517;
  t522 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t464 * t26 * t105 - t422 / 0.4e1 - 0.33102190727492640992e0 * t470 * t221 + t378 - 0.11034063575830880331e0 * t430 + 0.33102190727492640992e0 * t196 * t478 - 0.16551095363746320496e0 * t196 * t518);
  tv2rho22 = 0.2e1 * t186 + 0.2e1 * t225 + t6 * (t454 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t527 = t296 * t240;
  t529 = 0.55170317879154401653e-1 * t128 * t527;
  t530 = t128 * t26;
  t531 = t301 * t240;
  t532 = t531 * t152;
  t540 = t143 * sigma[0];
  t544 = t323 * t51;
  t545 = t326 * rho[0];
  t546 = 0.1e1 / t545;
  t553 = t326 * t132;
  t555 = 0.1e1 / t36 / t553;
  t560 = -0.1e2 / 0.729e3 * t33 * t134 - 0.10673131404562256653e-1 * t33 * t134 * t43 + 0.13341414255702820817e-2 * t50 * t540 * t43 - 0.11117845213085684014e-3 * t544 * t546 * t43 - 0.14699017287336701482e-3 * t50 * t540 * t148 + 0.12153437393255055122e-7 * t337 * t324 * t555 * t344;
  t561 = t131 * t560;
  t565 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t287 * t241 - t529 + 0.33102190727492640992e0 * t530 * t532 - 0.16551095363746320496e0 * t128 * t561);
  tv2rhosigma0 = t6 * t565 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t569 = t428 * t257;
  t571 = 0.55170317879154401653e-1 * t196 * t569;
  t573 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t425 * t258 - t571);
  tv2rhosigma2 = t6 * t573 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t578 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t400 * t241 - t529);
  tv2rhosigma3 = t6 * t578 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t582 = t196 * t26;
  t583 = t475 * t257;
  t584 = t583 * t220;
  t592 = t211 * sigma[2];
  t596 = t323 * t92;
  t597 = t498 * rho[1];
  t598 = 0.1e1 / t597;
  t605 = t498 * t200;
  t607 = 0.1e1 / t81 / t605;
  t612 = -0.1e2 / 0.729e3 * t33 * t202 - 0.10673131404562256653e-1 * t33 * t202 * t88 + 0.13341414255702820817e-2 * t50 * t592 * t88 - 0.11117845213085684014e-3 * t596 * t598 * t88 - 0.14699017287336701482e-3 * t50 * t592 * t216 + 0.12153437393255055122e-7 * t337 * t496 * t607 * t513;
  t613 = t199 * t612;
  t617 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t470 * t258 - t571 + 0.33102190727492640992e0 * t582 * t584 - 0.16551095363746320496e0 * t196 * t613);
  tv2rhosigma5 = t6 * t617 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t619 = t240 * t240;
  t620 = t302 * t619;
  t626 = t323 * sigma[0];
  t627 = 0.1e1 / t326;
  t635 = 0.1e1 / t36 / t327;
  t640 = -0.33353535639257052042e-3 * t50 * t55 * t43 + 0.41691919549071315052e-4 * t626 * t627 * t43 + 0.27560657413756315278e-4 * t50 * t55 * t148 - 0.45575390224706456708e-8 * t337 * t51 * t635 * t344;
  t641 = t131 * t640;
  t645 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t128 * t620 - 0.16551095363746320496e0 * t128 * t641);
  tv2sigma20 = t6 * t645;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t646 = t257 * t257;
  t647 = t476 * t646;
  t653 = t323 * sigma[2];
  t654 = 0.1e1 / t498;
  t662 = 0.1e1 / t81 / t499;
  t667 = -0.33353535639257052042e-3 * t50 * t96 * t88 + 0.41691919549071315052e-4 * t653 * t654 * t88 + 0.27560657413756315278e-4 * t50 * t96 * t216 - 0.45575390224706456708e-8 * t337 * t92 * t662 * t513;
  t668 = t199 * t667;
  t672 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t196 * t647 - 0.16551095363746320496e0 * t196 * t668);
  tv2sigma25 = t6 * t672;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t676 = 0.1e1 / t36 / t53;
  t677 = sigma[0] * t676;
  t684 = 0.1e1 / t35 / t326;
  t685 = t51 * t684;
  t689 = 0.1e1 / t553;
  t693 = t323 * t338;
  t694 = t326 * t53;
  t696 = 0.1e1 / t36 / t694;
  t698 = t33 * t43;
  t708 = t338 * t51;
  t709 = t326 * t326;
  t711 = 0.1e1 / t709 / t132;
  t714 = 0.1e1 / t343 / t59;
  t717 = -0.154e4 / 0.6561e4 * t33 * t677 - 0.1826291373669541694e0 * t33 * t677 * t43 + 0.33699424156997495545e-1 * t50 * t685 * t43 - 0.56330415746300799004e-2 * t325 * t689 * t43 + 0.32941763594327952634e-4 * t693 * t696 * t698 - 0.34134384589481895663e-2 * t50 * t685 * t148 + 0.61577416125825612618e-6 * t337 * t338 * t696 * t344 - 0.3012370804988962832e-14 * t708 * t711 * t714;
  t718 = t131 * t717;
  t721 = t291 * t130;
  t722 = t721 * t152;
  t723 = t128 * t722;
  t725 = t296 * t348;
  t726 = t128 * t725;
  t728 = t2 * t278;
  t731 = t287 * t297;
  t735 = t129 * t129;
  t736 = 0.1e1 / t735;
  t737 = t26 * t736;
  t738 = t303 * t152;
  t739 = t737 * t738;
  t743 = t301 * t152 * t348;
  t747 = 0.1e1 / t122 / t110;
  t751 = 0.5e1 / 0.36e2 * t5 * t25 * t747 * t64;
  t752 = t123 * t301;
  t753 = t752 * t303;
  t754 = t128 * t753;
  t758 = t5 * t278 * t123 * t64;
  t762 = t5 * t117 * t291 * t64;
  t767 = 0.1e1 / t264 / t19;
  t768 = t266 * t114;
  t771 = t265 * t114;
  t774 = t110 * t110;
  t775 = 0.1e1 / t774;
  t776 = t16 * t775;
  t779 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t270 - 0.6e1 * t776);
  t783 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t767 * t768 + 0.4e1 / 0.3e1 * t771 * t274 + 0.4e1 / 0.3e1 * t23 * t779);
  t788 = -0.16551095363746320496e0 * t128 * t718 + 0.11034063575830880331e0 * t723 - 0.16551095363746320496e0 * t726 - 0.49653286091238961488e0 * t728 * t153 - 0.33102190727492640993e0 * t731 - 0.49653286091238961488e0 * t287 * t349 - 0.99306572182477922976e0 * t128 * t739 + 0.99306572182477922976e0 * t530 * t743 - t751 + 0.33102190727492640993e0 * t754 - 0.3e1 / 0.8e1 * t758 + t762 / 0.4e1 + 0.99306572182477922976e0 * t287 * t304 - 0.3e1 / 0.8e1 * t5 * t783 * t26 * t64;
  t789 = my_piecewise3(t1, 0, t788);
  t791 = 0.1e1 / t354 / t73;
  t792 = t356 * t160;
  t795 = t355 * t160;
  t798 = t70 * t775;
  t801 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t270 - 0.6e1 * t798);
  t805 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t791 * t792 + 0.4e1 / 0.3e1 * t795 * t362 + 0.4e1 / 0.3e1 * t75 * t801);
  t812 = t5 * t366 * t123 * t105;
  t816 = t5 * t163 * t291 * t105;
  t821 = 0.5e1 / 0.36e2 * t5 * t77 * t747 * t105;
  t823 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t805 * t26 * t105 - 0.3e1 / 0.8e1 * t812 + t816 / 0.4e1 - t821);
  tv3rho30 = 0.3e1 * t353 + 0.3e1 * t380 + t6 * (t789 + t823);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t826 = 0.2e1 * t406;
  t827 = 0.2e1 * t433;
  t828 = t767 * t177;
  t831 = t265 * t387;
  t836 = 0.2e1 * t270;
  t837 = 0.6e1 * t776;
  t839 = my_piecewise5(t10, 0, t14, 0, t836 - t837);
  t843 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t828 * t266 + 0.8e1 / 0.9e1 * t831 * t114 + 0.4e1 / 0.9e1 * t383 * t274 + 0.4e1 / 0.3e1 * t23 * t839);
  t851 = t5 * t391 * t123 * t64 / 0.4e1;
  t852 = t2 * t391;
  t857 = t5 * t180 * t291 * t64;
  t860 = 0.11034063575830880331e0 * t400 * t297;
  t871 = -0.3e1 / 0.8e1 * t5 * t843 * t26 * t64 - t851 - 0.33102190727492640992e0 * t852 * t153 + t857 / 0.12e2 - t860 + 0.33102190727492640992e0 * t400 * t304 - 0.16551095363746320496e0 * t400 * t349 - t758 / 0.8e1 + t762 / 0.6e1 - 0.11034063575830880331e0 * t731 - t751 + 0.73560423838872535538e-1 * t723 + 0.11034063575830880331e0 * t754 - 0.55170317879154401654e-1 * t726;
  t872 = my_piecewise3(t1, 0, t871);
  t873 = t791 * t188;
  t876 = t355 * t411;
  t881 = 0.6e1 * t798;
  t883 = my_piecewise5(t14, 0, t10, 0, -t836 - t881);
  t887 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t873 * t356 + 0.8e1 / 0.9e1 * t876 * t160 + 0.4e1 / 0.9e1 * t407 * t362 + 0.4e1 / 0.3e1 * t75 * t883);
  t895 = t5 * t415 * t123 * t105 / 0.4e1;
  t898 = t5 * t191 * t291 * t105;
  t902 = t2 * t366;
  t906 = 0.11034063575830880331e0 * t425 * t429;
  t907 = t291 * t198;
  t908 = t907 * t220;
  t909 = t196 * t908;
  t912 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t887 * t26 * t105 - t895 + t898 / 0.12e2 - t812 / 0.8e1 + t816 / 0.6e1 - t821 - 0.16551095363746320496e0 * t902 * t221 - t906 + 0.36780211919436267769e-1 * t909);
  tv3rho31 = t353 + t380 + t826 + t827 + t6 * (t872 + t912);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t915 = t767 * t438;
  t920 = t265 * t443;
  t924 = my_piecewise5(t10, 0, t14, 0, -t836 - t837);
  t928 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t915 * t114 + 0.8e1 / 0.9e1 * t383 * t387 + 0.4e1 / 0.9e1 * t920 * t114 + 0.4e1 / 0.3e1 * t23 * t924);
  t935 = t5 * t447 * t123 * t64;
  t937 = t2 * t447;
  t944 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t928 * t26 * t64 - t935 / 0.8e1 - 0.16551095363746320496e0 * t937 * t153 - t851 + t857 / 0.6e1 - t860 + t762 / 0.12e2 - t751 + 0.36780211919436267769e-1 * t723);
  t945 = t791 * t455;
  t950 = t355 * t460;
  t954 = my_piecewise5(t14, 0, t10, 0, t836 - t881);
  t958 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t945 * t160 + 0.8e1 / 0.9e1 * t407 * t411 + 0.4e1 / 0.9e1 * t950 * t160 + 0.4e1 / 0.3e1 * t75 * t954);
  t965 = t5 * t464 * t123 * t105;
  t968 = t2 * t415;
  t971 = t470 * t429;
  t977 = t123 * t475;
  t978 = t977 * t477;
  t979 = t196 * t978;
  t983 = t428 * t517;
  t984 = t196 * t983;
  t986 = -0.3e1 / 0.8e1 * t5 * t958 * t26 * t105 - t965 / 0.8e1 - t895 + t898 / 0.6e1 - 0.33102190727492640992e0 * t968 * t221 - 0.11034063575830880331e0 * t971 + t816 / 0.12e2 - t821 - t906 + 0.7356042383887253554e-1 * t909 + 0.33102190727492640992e0 * t425 * t478 + 0.11034063575830880331e0 * t979 - 0.16551095363746320496e0 * t425 * t518 - 0.55170317879154401653e-1 * t984;
  t987 = my_piecewise3(t69, 0, t986);
  tv3rho32 = t826 + t827 + t454 + t522 + t6 * (t944 + t987);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t992 = t438 * t177;
  t999 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t270 - 0.6e1 * t776);
  t1003 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t767 * t992 + 0.4e1 / 0.3e1 * t383 * t443 + 0.4e1 / 0.3e1 * t23 * t999);
  t1011 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1003 * t26 * t64 - 0.3e1 / 0.8e1 * t935 + t857 / 0.4e1 - t751);
  t1013 = 0.1e1 / t81 / t94;
  t1014 = sigma[2] * t1013;
  t1021 = 0.1e1 / t80 / t498;
  t1022 = t92 * t1021;
  t1026 = 0.1e1 / t605;
  t1030 = t323 * t507;
  t1031 = t498 * t94;
  t1033 = 0.1e1 / t81 / t1031;
  t1035 = t33 * t88;
  t1045 = t507 * t92;
  t1046 = t498 * t498;
  t1048 = 0.1e1 / t1046 / t200;
  t1051 = 0.1e1 / t512 / t100;
  t1054 = -0.154e4 / 0.6561e4 * t33 * t1014 - 0.1826291373669541694e0 * t33 * t1014 * t88 + 0.33699424156997495545e-1 * t50 * t1022 * t88 - 0.56330415746300799004e-2 * t497 * t1026 * t88 + 0.32941763594327952634e-4 * t1030 * t1033 * t1035 - 0.34134384589481895663e-2 * t50 * t1022 * t216 + 0.61577416125825612618e-6 * t337 * t507 * t1033 * t513 - 0.3012370804988962832e-14 * t1045 * t1048 * t1051;
  t1055 = t199 * t1054;
  t1058 = t2 * t464;
  t1063 = t455 * t188;
  t1070 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t270 - 0.6e1 * t798);
  t1074 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t791 * t1063 + 0.4e1 / 0.3e1 * t407 * t460 + 0.4e1 / 0.3e1 * t75 * t1070);
  t1079 = t197 * t197;
  t1080 = 0.1e1 / t1079;
  t1081 = t26 * t1080;
  t1082 = t477 * t220;
  t1083 = t1081 * t1082;
  t1087 = t475 * t220 * t517;
  t1098 = -0.16551095363746320496e0 * t196 * t1055 - 0.49653286091238961488e0 * t1058 * t221 - 0.49653286091238961488e0 * t470 * t518 - 0.3e1 / 0.8e1 * t5 * t1074 * t26 * t105 - 0.99306572182477922976e0 * t196 * t1083 + 0.99306572182477922976e0 * t582 * t1087 + 0.99306572182477922976e0 * t470 * t478 - 0.33102190727492640993e0 * t971 + 0.33102190727492640993e0 * t979 - 0.16551095363746320496e0 * t984 - 0.3e1 / 0.8e1 * t965 + t898 / 0.4e1 + 0.11034063575830880331e0 * t909 - t821;
  t1099 = my_piecewise3(t69, 0, t1098);
  tv3rho33 = 0.3e1 * t454 + 0.3e1 * t522 + t6 * (t1011 + t1099);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1105 = t287 * t527;
  t1107 = t287 * t26;
  t1112 = t721 * t240;
  t1114 = 0.36780211919436267769e-1 * t128 * t1112;
  t1115 = t128 * t123;
  t1116 = t1115 * t532;
  t1118 = t296 * t560;
  t1119 = t128 * t1118;
  t1121 = t736 * t240;
  t1122 = t1121 * t303;
  t1125 = t301 * t560;
  t1126 = t1125 * t152;
  t1129 = t531 * t348;
  t1137 = t317 * sigma[0];
  t1141 = t323 * t328;
  t1142 = t51 * t43;
  t1155 = t338 * sigma[0];
  t1157 = 0.1e1 / t709 / t34;
  t1161 = 0.11e3 / 0.2187e4 * t33 * t308 + 0.39134815150061607728e-1 * t33 * t308 * t43 - 0.96354658513409261456e-2 * t50 * t1137 * t43 + 0.18900336862245662824e-2 * t1141 * t1142 - 0.12353161347872982238e-4 * t325 * t341 * t698 + 0.93093776153132442719e-3 * t50 * t1137 * t148 - 0.20660843568533593707e-6 * t337 * t324 * t341 * t344 + 0.1129639051870861062e-14 * t1155 * t1157 * t714;
  t1162 = t131 * t1161;
  t1165 = -0.16551095363746320496e0 * t728 * t241 - 0.11034063575830880331e0 * t1105 + 0.66204381454985281984e0 * t1107 * t532 - 0.33102190727492640992e0 * t287 * t561 + t1114 + 0.22068127151661760662e0 * t1116 - 0.11034063575830880331e0 * t1119 - 0.99306572182477922976e0 * t530 * t1122 + 0.66204381454985281984e0 * t530 * t1126 + 0.33102190727492640992e0 * t530 * t1129 - 0.16551095363746320496e0 * t128 * t1162;
  t1166 = my_piecewise3(t1, 0, t1165);
  tv3rho2sigma0 = t6 * t1166 + 0.2e1 * t565;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1171 = t425 * t569;
  t1173 = t907 * t257;
  t1175 = 0.36780211919436267769e-1 * t196 * t1173;
  t1177 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t902 * t258 - 0.11034063575830880331e0 * t1171 + t1175);
  tv3rho2sigma2 = t6 * t1177 + 0.2e1 * t573;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1181 = t400 * t527;
  t1183 = t400 * t26;
  t1192 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t852 * t241 - 0.55170317879154401653e-1 * t1181 + 0.33102190727492640992e0 * t1183 * t532 - 0.16551095363746320496e0 * t400 * t561 - 0.55170317879154401653e-1 * t1105 + t1114 + 0.11034063575830880331e0 * t1116 - 0.55170317879154401653e-1 * t1119);
  tv3rho2sigma3 = t6 * t1192 + t565 + t578;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1196 = t470 * t569;
  t1199 = t425 * t26;
  t1202 = t196 * t123;
  t1203 = t1202 * t584;
  t1207 = t428 * t612;
  t1208 = t196 * t1207;
  t1211 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t968 * t258 - 0.55170317879154401653e-1 * t1196 - 0.55170317879154401653e-1 * t1171 + t1175 + 0.33102190727492640992e0 * t1199 * t584 + 0.11034063575830880331e0 * t1203 - 0.16551095363746320496e0 * t425 * t613 - 0.55170317879154401653e-1 * t1208);
  tv3rho2sigma5 = t6 * t1211 + t573 + t617;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1218 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t937 * t241 - 0.11034063575830880331e0 * t1181 + t1114);
  tv3rho2sigma6 = t6 * t1218 + 0.2e1 * t578;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1224 = t470 * t26;
  t1231 = t1080 * t257;
  t1232 = t1231 * t477;
  t1235 = t475 * t612;
  t1236 = t1235 * t220;
  t1239 = t583 * t517;
  t1247 = t491 * sigma[2];
  t1251 = t323 * t500;
  t1252 = t92 * t88;
  t1265 = t507 * sigma[2];
  t1267 = 0.1e1 / t1046 / t79;
  t1271 = 0.11e3 / 0.2187e4 * t33 * t482 + 0.39134815150061607728e-1 * t33 * t482 * t88 - 0.96354658513409261456e-2 * t50 * t1247 * t88 + 0.18900336862245662824e-2 * t1251 * t1252 - 0.12353161347872982238e-4 * t497 * t510 * t1035 + 0.93093776153132442719e-3 * t50 * t1247 * t216 - 0.20660843568533593707e-6 * t337 * t496 * t510 * t513 + 0.1129639051870861062e-14 * t1265 * t1267 * t1051;
  t1272 = t199 * t1271;
  t1275 = -0.16551095363746320496e0 * t1058 * t258 - 0.11034063575830880331e0 * t1196 + 0.66204381454985281984e0 * t1224 * t584 - 0.33102190727492640992e0 * t470 * t613 + t1175 + 0.22068127151661760662e0 * t1203 - 0.11034063575830880331e0 * t1208 - 0.99306572182477922976e0 * t582 * t1232 + 0.66204381454985281984e0 * t582 * t1236 + 0.33102190727492640992e0 * t582 * t1239 - 0.16551095363746320496e0 * t196 * t1272;
  t1276 = my_piecewise3(t69, 0, t1275);
  tv3rho2sigma8 = t6 * t1276 + 0.2e1 * t617;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1280 = t752 * t619;
  t1282 = 0.11034063575830880331e0 * t128 * t1280;
  t1283 = t736 * t619;
  t1284 = t1283 * t152;
  t1287 = t531 * t560;
  t1292 = t296 * t640;
  t1294 = 0.55170317879154401653e-1 * t128 * t1292;
  t1295 = t301 * t640;
  t1296 = t1295 * t152;
  t1302 = t323 * t546;
  t1303 = sigma[0] * t43;
  t1312 = t555 * t344;
  t1316 = t709 * rho[0];
  t1317 = 0.1e1 / t1316;
  t1321 = 0.17788552340937094422e-2 * t50 * t143 * t43 - 0.5558922606542842007e-3 * t1302 * t1303 + 0.46324355054523683391e-5 * t544 * t555 * t698 - 0.14699017287336701482e-3 * t50 * t143 * t148 + 0.60767186966275275611e-7 * t337 * t1312 * t51 - 0.42361464445157289826e-15 * t338 * t1317 * t714;
  t1322 = t131 * t1321;
  t1326 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t287 * t620 + t1282 - 0.99306572182477922976e0 * t530 * t1284 + 0.66204381454985281984e0 * t530 * t1287 - 0.16551095363746320496e0 * t287 * t641 - t1294 + 0.33102190727492640992e0 * t530 * t1296 - 0.16551095363746320496e0 * t128 * t1322);
  tv3rhosigma20 = t6 * t1326 + t645;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1330 = t977 * t646;
  t1332 = 0.11034063575830880331e0 * t196 * t1330;
  t1335 = t428 * t667;
  t1337 = 0.55170317879154401653e-1 * t196 * t1335;
  t1339 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t425 * t647 + t1332 - 0.16551095363746320496e0 * t425 * t668 - t1337);
  tv3rhosigma25 = t6 * t1339 + t672;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1346 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t400 * t620 + t1282 - 0.16551095363746320496e0 * t400 * t641 - t1294);
  tv3rhosigma26 = t6 * t1346 + t645;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1350 = t1080 * t646;
  t1351 = t1350 * t220;
  t1354 = t583 * t612;
  t1359 = t475 * t667;
  t1360 = t1359 * t220;
  t1366 = t323 * t598;
  t1367 = sigma[2] * t88;
  t1376 = t607 * t513;
  t1380 = t1046 * rho[1];
  t1381 = 0.1e1 / t1380;
  t1385 = 0.17788552340937094422e-2 * t50 * t211 * t88 - 0.5558922606542842007e-3 * t1366 * t1367 + 0.46324355054523683391e-5 * t596 * t607 * t1035 - 0.14699017287336701482e-3 * t50 * t211 * t216 + 0.60767186966275275611e-7 * t337 * t1376 * t92 - 0.42361464445157289826e-15 * t507 * t1381 * t1051;
  t1386 = t199 * t1385;
  t1390 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t470 * t647 + t1332 - 0.99306572182477922976e0 * t582 * t1351 + 0.66204381454985281984e0 * t582 * t1354 - 0.16551095363746320496e0 * t470 * t668 - t1337 + 0.33102190727492640992e0 * t582 * t1360 - 0.16551095363746320496e0 * t196 * t1386);
  tv3rhosigma211 = t6 * t1390 + t672;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1392 = t619 * t240;
  t1393 = t737 * t1392;
  t1396 = t531 * t640;
  t1405 = t635 * t344;
  t1409 = 0.1e1 / t709;
  t1413 = 0.12507575864721394516e-3 * t323 * t627 * t43 - 0.17371633145446381272e-5 * t626 * t635 * t698 - 0.13672617067411937012e-7 * t337 * t1405 * sigma[0] + 0.15885549166933983685e-15 * t324 * t1409 * t714;
  t1414 = t131 * t1413;
  t1418 = my_piecewise3(t1, 0, -0.99306572182477922976e0 * t128 * t1393 + 0.99306572182477922976e0 * t530 * t1396 - 0.16551095363746320496e0 * t128 * t1414);
  tv3sigma30 = t6 * t1418;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1419 = t646 * t257;
  t1420 = t1081 * t1419;
  t1423 = t583 * t667;
  t1432 = t662 * t513;
  t1436 = 0.1e1 / t1046;
  t1440 = 0.12507575864721394516e-3 * t323 * t654 * t88 - 0.17371633145446381272e-5 * t653 * t662 * t1035 - 0.13672617067411937012e-7 * t337 * t1432 * sigma[2] + 0.15885549166933983685e-15 * t496 * t1436 * t1051;
  t1441 = t199 * t1440;
  t1445 = my_piecewise3(t69, 0, -0.99306572182477922976e0 * t196 * t1420 + 0.99306572182477922976e0 * t582 * t1423 - 0.16551095363746320496e0 * t196 * t1441);
  tv3sigma39 = t6 * t1445;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type * const p, size_t ip, const double * const rho, const double * const sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t47, t49, t50, t51, t52, t53, t55, t59;
  double t60, t61, t64, t68, t69, t70, t72, t73;
  double t74, t75, t77, t79, t80, t81, t83, t84;
  double t85, t88, t92, t93, t94, t96, t100, t101;
  double t102, t105, t109, tzk0;

  double t110, t111, t112, t114, t117, t122, t123, t127;
  double t128, t129, t130, t131, t132, t134, t135, t141;
  double t143, t144, t148, t152, t153, t157, t158, t160;
  double t163, t171, t173, tvrho0, t177, t180, t186, t188;
  double t191, t196, t197, t198, t199, t200, t202, t203;
  double t209, t211, t212, t216, t220, t221, t225, tvrho1;
  double t233, t240, t241, t244, tvsigma0, tvsigma1, t250, t257;
  double t258, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t274, t278;
  double t285, t287, t291, t295, t296, t297, t298, t301;
  double t302, t303, t304, t308, t309, t315, t317, t318;
  double t322, t323, t324, t325, t326, t327, t328, t337;
  double t338, t339, t341, t343, t344, t348, t349, t353;
  double t354, t355, t356, t359, t362, t366, t373, t378;
  double t380, tv2rho20, t383, t387, t391, t398, t400, t406;
  double t407, t411, t415, t422, t425, t428, t429, t430;
  double t433, tv2rho21, t438, t443, t447, t454, t455, t460;
  double t464, t470, t475, t476, t477, t478, t482, t483;
  double t489, t491, t492, t496, t497, t498, t499, t500;
  double t507, t508, t510, t512, t513, t517, t518, t522;
  double tv2rho22, t527, t529, t530, t531, t532, t540, t544;
  double t545, t546, t553, t555, t560, t561, t565, tv2rhosigma0;
  double tv2rhosigma1, t569, t571, t573, tv2rhosigma2, t578, tv2rhosigma3, tv2rhosigma4;
  double t582, t583, t584, t592, t596, t597, t598, t605;
  double t607, t612, t613, t617, tv2rhosigma5, t619, t620, t626;
  double t627, t635, t640, t641, t645, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t646, t647, t653, t654, t662, t667;
  double t668, t672, tv2sigma25;

  double t676, t677, t684, t685, t689, t693, t694, t696;
  double t698, t708, t709, t711, t714, t717, t718, t721;
  double t722, t723, t725, t726, t728, t731, t735, t736;
  double t737, t738, t739, t743, t747, t751, t752, t753;
  double t754, t758, t762, t767, t768, t771, t774, t775;
  double t776, t779, t783, t788, t789, t791, t792, t795;
  double t798, t801, t805, t812, t816, t821, t823, tv3rho30;
  double t826, t827, t828, t831, t836, t837, t839, t843;
  double t851, t852, t857, t860, t871, t872, t873, t876;
  double t881, t883, t887, t895, t898, t902, t906, t907;
  double t908, t909, t912, tv3rho31, t915, t920, t924, t928;
  double t935, t937, t944, t945, t950, t954, t958, t965;
  double t968, t971, t977, t978, t979, t983, t984, t986;
  double t987, tv3rho32, t992, t999, t1003, t1011, t1013, t1014;
  double t1021, t1022, t1026, t1030, t1031, t1033, t1035, t1045;
  double t1046, t1048, t1051, t1054, t1055, t1058, t1063, t1070;
  double t1074, t1079, t1080, t1081, t1082, t1083, t1087, t1098;
  double t1099, tv3rho33, t1105, t1107, t1112, t1114, t1115, t1116;
  double t1118, t1119, t1121, t1122, t1125, t1126, t1129, t1137;
  double t1141, t1142, t1155, t1157, t1161, t1162, t1165, t1166;
  double tv3rho2sigma0, tv3rho2sigma1, t1171, t1173, t1175, t1177, tv3rho2sigma2, t1181;
  double t1183, t1192, tv3rho2sigma3, tv3rho2sigma4, t1196, t1199, t1202, t1203;
  double t1207, t1208, t1211, tv3rho2sigma5, t1218, tv3rho2sigma6, tv3rho2sigma7, t1224;
  double t1231, t1232, t1235, t1236, t1239, t1247, t1251, t1252;
  double t1265, t1267, t1271, t1272, t1275, t1276, tv3rho2sigma8, t1280;
  double t1282, t1283, t1284, t1287, t1292, t1294, t1295, t1296;
  double t1302, t1303, t1312, t1316, t1317, t1321, t1322, t1326;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1330, t1332, t1335;
  double t1337, t1339, tv3rhosigma25, t1346, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t1350, t1351, t1354, t1359, t1360, t1366, t1367;
  double t1376, t1380, t1381, t1385, t1386, t1390, tv3rhosigma211, t1392;
  double t1393, t1396, t1405, t1409, t1413, t1414, t1418, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1419, t1420, t1423, t1432, t1436, t1440, t1441, t1445;
  double tv3sigma39;

  double t1449, t1451, t1453, t1455, t1457, t1459, t1461, t1467;
  double t1473, t1481, t1489, t1491, t1499, t1514, t1519, t1522;
  double t1529, t1531, t1534, t1535, t1536, t1542, t1544, t1546;
  double t1548, t1552, t1555, t1559, t1560, t1562, t1563, t1569;
  double t1575, t1576, t1579, t1583, t1590, t1594, t1598, t1605;
  double t1613, t1615, t1616, t1618, t1619, t1625, t1630, t1633;
  double t1637, t1644, t1648, t1652, t1657, t1659, tv4rho40, t1668;
  double t1669, t1670, t1688, t1689, t1691, t1695, t1700, t1703;
  double t1707, t1709, t1713, t1717, t1718, t1724, t1739, t1741;
  double t1758, t1760, t1764, t1771, t1775, t1776, t1779, t1784;
  double t1787, t1789, t1790, t1791, t1793, t1795, t1796, tv4rho41;
  double t1807, t1811, t1813, t1825, t1838, t1842, t1847, t1864;
  double t1866, t1868, t1872, t1876, t1878, t1880, t1882, t1884;
  double t1886, t1888, t1903, t1916, t1920, t1925, t1936, t1938;
  double tv4rho42, t1959, t1963, t1970, t1972, t1981, t1982, t1983;
  double t1990, t1992, t1996, t2017, t2021, t2028, t2030, t2034;
  double t2036, t2038, t2040, t2052, t2054, tv4rho43, t2059, t2064;
  double t2071, t2075, t2084, t2094, t2102, t2110, t2112, t2120;
  double t2135, t2140, t2143, t2150, t2159, t2164, t2171, t2175;
  double t2182, t2187, t2188, t2189, t2194, t2210, t2212, tv4rho44;
  double t2220, t2225, t2237, t2239, t2243, t2248, t2265, t2303;
  double t2306, t2312, t2318, t2319, t2321, t2323, t2325, tv4rho3sigma0;
  double tv4rho3sigma1, t2330, t2332, t2336, t2338, tv4rho3sigma2, t2340, t2344;
  double t2354, t2358, t2362, t2364, t2376, t2378, tv4rho3sigma3, tv4rho3sigma4;
  double t2380, t2384, t2385, t2394, t2396, t2401, t2403, t2405;
  double t2406, tv4rho3sigma5, t2410, t2421, t2422, tv4rho3sigma6, tv4rho3sigma7, t2426;
  double t2433, t2437, t2440, t2445, t2449, t2453, t2458, t2460;
  double t2462, tv4rho3sigma8, t2470, tv4rho3sigma9, tv4rho3sigma10, t2482, t2536, t2563;
  double t2565, tv4rho3sigma11, t2604, t2615, t2616, t2625, t2629, t2633;
  double t2639, t2640, t2642, t2644, t2664, t2666, tv4rho2sigma20, tv4rho2sigma21;
  double tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2671, t2675, t2678, t2682, t2684;
  double tv4rho2sigma25, t2688, t2699, t2708, t2709, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t2713, t2718, t2722, t2726, t2731, t2736;
  double t2738, t2739, tv4rho2sigma211, t2749, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215;
  double tv4rho2sigma216, t2800, t2814, t2835, t2837, tv4rho2sigma217, t2843, t2854;
  double t2869, t2903, t2904, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34;
  double tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2910, t2914, t2919, t2921;
  double tv4rhosigma39, t2930, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315;
  double tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2988, t2989, tv4rhosigma319, t2991, t2998;
  double t3029, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46;
  double tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t3030;
  double t3037, t3068, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t43 = exp(-t40 / 0.24e2);
  t47 = t28 * t28;
  t49 = 0.1e1 / t30 / t29;
  t50 = t47 * t49;
  t51 = sigma[0] * sigma[0];
  t52 = t34 * t34;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t35 / t53;
  t59 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t51 * t55;
  t60 = log(t59);
  t61 = 0.804e0 + 0.5e1 / 0.972e3 * t40 + 0.4002424276710846245e-2 * t33 * t39 * t43 + t60;
  t64 = 0.1804e1 - 0.646416e0 / t61;
  t68 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t25 * t26 * t64);
  t69 = rho[1] <= p->dens_threshold;
  t70 = -t16;
  t72 = my_piecewise5(t14, t11, t10, t15, t70 * t7);
  t73 = 0.1e1 + t72;
  t74 = t73 <= p->zeta_threshold;
  t75 = POW_1_3(t73);
  t77 = my_piecewise3(t74, t22, t75 * t73);
  t79 = rho[1] * rho[1];
  t80 = POW_1_3(rho[1]);
  t81 = t80 * t80;
  t83 = 0.1e1 / t81 / t79;
  t84 = sigma[2] * t83;
  t85 = t33 * t84;
  t88 = exp(-t85 / 0.24e2);
  t92 = sigma[2] * sigma[2];
  t93 = t79 * t79;
  t94 = t93 * rho[1];
  t96 = 0.1e1 / t80 / t94;
  t100 = 0.1e1 + 0.13780328706878157639e-4 * t50 * t92 * t96;
  t101 = log(t100);
  t102 = 0.804e0 + 0.5e1 / 0.972e3 * t85 + 0.4002424276710846245e-2 * t33 * t84 * t88 + t101;
  t105 = 0.1804e1 - 0.646416e0 / t102;
  t109 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t77 * t26 * t105);
  tzk0 = t68 + t109;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t110 = t6 * t6;
  t111 = 0.1e1 / t110;
  t112 = t16 * t111;
  t114 = my_piecewise5(t10, 0, t14, 0, t7 - t112);
  t117 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t114);
  t122 = t26 * t26;
  t123 = 0.1e1 / t122;
  t127 = t5 * t25 * t123 * t64 / 0.8e1;
  t128 = t2 * t25;
  t129 = t61 * t61;
  t130 = 0.1e1 / t129;
  t131 = t26 * t130;
  t132 = t34 * rho[0];
  t134 = 0.1e1 / t36 / t132;
  t135 = sigma[0] * t134;
  t141 = t52 * t34;
  t143 = 0.1e1 / t35 / t141;
  t144 = t51 * t143;
  t148 = 0.1e1 / t59;
  t152 = -0.1e2 / 0.729e3 * t33 * t135 - 0.10673131404562256653e-1 * t33 * t135 * t43 + 0.44471380852342736056e-3 * t50 * t144 * t43 - 0.73495086436683507408e-4 * t50 * t144 * t148;
  t153 = t131 * t152;
  t157 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t26 * t64 - t127 - 0.16551095363746320496e0 * t128 * t153);
  t158 = t70 * t111;
  t160 = my_piecewise5(t14, 0, t10, 0, -t7 - t158);
  t163 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t160);
  t171 = t5 * t77 * t123 * t105 / 0.8e1;
  t173 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t163 * t26 * t105 - t171);
  tvrho0 = t68 + t109 + t6 * (t157 + t173);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t177 = my_piecewise5(t10, 0, t14, 0, -t7 - t112);
  t180 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t177);
  t186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t26 * t64 - t127);
  t188 = my_piecewise5(t14, 0, t10, 0, t7 - t158);
  t191 = my_piecewise3(t74, 0, 0.4e1 / 0.3e1 * t75 * t188);
  t196 = t2 * t77;
  t197 = t102 * t102;
  t198 = 0.1e1 / t197;
  t199 = t26 * t198;
  t200 = t79 * rho[1];
  t202 = 0.1e1 / t81 / t200;
  t203 = sigma[2] * t202;
  t209 = t93 * t79;
  t211 = 0.1e1 / t80 / t209;
  t212 = t92 * t211;
  t216 = 0.1e1 / t100;
  t220 = -0.1e2 / 0.729e3 * t33 * t203 - 0.10673131404562256653e-1 * t33 * t203 * t88 + 0.44471380852342736056e-3 * t50 * t212 * t88 - 0.73495086436683507408e-4 * t50 * t212 * t216;
  t221 = t199 * t220;
  t225 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t191 * t26 * t105 - t171 - 0.16551095363746320496e0 * t196 * t221);
  tvrho1 = t68 + t109 + t6 * (t186 + t225);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t233 = sigma[0] * t55;
  t240 = 0.5e1 / 0.972e3 * t33 * t38 + 0.4002424276710846245e-2 * t33 * t38 * t43 - 0.16676767819628526021e-3 * t50 * t233 * t43 + 0.27560657413756315278e-4 * t50 * t233 * t148;
  t241 = t131 * t240;
  t244 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t128 * t241);
  tvsigma0 = t6 * t244;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t250 = sigma[2] * t96;
  t257 = 0.5e1 / 0.972e3 * t33 * t83 + 0.4002424276710846245e-2 * t33 * t83 * t88 - 0.16676767819628526021e-3 * t50 * t250 * t88 + 0.27560657413756315278e-4 * t50 * t250 * t216;
  t258 = t199 * t257;
  t261 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t196 * t258);
  tvsigma2 = t6 * t261;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t114 * t114;
  t269 = t110 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t274 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t111 + 0.2e1 * t271);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t285 = t5 * t117 * t123 * t64;
  t287 = t2 * t117;
  t291 = 0.1e1 / t122 / t6;
  t295 = t5 * t25 * t291 * t64 / 0.12e2;
  t296 = t123 * t130;
  t297 = t296 * t152;
  t298 = t128 * t297;
  t301 = 0.1e1 / t129 / t61;
  t302 = t26 * t301;
  t303 = t152 * t152;
  t304 = t302 * t303;
  t308 = 0.1e1 / t36 / t52;
  t309 = sigma[0] * t308;
  t315 = t52 * t132;
  t317 = 0.1e1 / t35 / t315;
  t318 = t51 * t317;
  t322 = t29 * t29;
  t323 = 0.1e1 / t322;
  t324 = t51 * sigma[0];
  t325 = t323 * t324;
  t326 = t52 * t52;
  t327 = t326 * t34;
  t328 = 0.1e1 / t327;
  t337 = t28 / t31 / t322;
  t338 = t51 * t51;
  t339 = t326 * t52;
  t341 = 0.1e1 / t36 / t339;
  t343 = t59 * t59;
  t344 = 0.1e1 / t343;
  t348 = 0.11e3 / 0.2187e4 * t33 * t309 + 0.39134815150061607728e-1 * t33 * t309 * t43 - 0.4002424276710846245e-2 * t50 * t318 * t43 + 0.29647587234895157371e-3 * t325 * t328 * t43 + 0.46546888076566221358e-3 * t50 * t318 * t148 - 0.32409166382013480325e-7 * t337 * t338 * t341 * t344;
  t349 = t131 * t348;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t278 * t26 * t64 - t285 / 0.4e1 - 0.33102190727492640992e0 * t287 * t153 + t295 - 0.11034063575830880331e0 * t298 + 0.33102190727492640992e0 * t128 * t304 - 0.16551095363746320496e0 * t128 * t349);
  t354 = t75 * t75;
  t355 = 0.1e1 / t354;
  t356 = t160 * t160;
  t359 = t70 * t270;
  t362 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t111 + 0.2e1 * t359);
  t366 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t75 * t362);
  t373 = t5 * t163 * t123 * t105;
  t378 = t5 * t77 * t291 * t105 / 0.12e2;
  t380 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t366 * t26 * t105 - t373 / 0.4e1 + t378);
  tv2rho20 = 0.2e1 * t157 + 0.2e1 * t173 + t6 * (t353 + t380);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t383 = t265 * t177;
  t387 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t271);
  t391 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t383 * t114 + 0.4e1 / 0.3e1 * t23 * t387);
  t398 = t5 * t180 * t123 * t64;
  t400 = t2 * t180;
  t406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t391 * t26 * t64 - t398 / 0.8e1 - 0.16551095363746320496e0 * t400 * t153 - t285 / 0.8e1 + t295 - 0.55170317879154401654e-1 * t298);
  t407 = t355 * t188;
  t411 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t359);
  t415 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t407 * t160 + 0.4e1 / 0.3e1 * t75 * t411);
  t422 = t5 * t191 * t123 * t105;
  t425 = t2 * t163;
  t428 = t123 * t198;
  t429 = t428 * t220;
  t430 = t196 * t429;
  t433 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t415 * t26 * t105 - t422 / 0.8e1 - t373 / 0.8e1 + t378 - 0.16551095363746320496e0 * t425 * t221 - 0.55170317879154401653e-1 * t430);
  tv2rho21 = t157 + t173 + t186 + t225 + t6 * (t406 + t433);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t438 = t177 * t177;
  t443 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t111 + 0.2e1 * t271);
  t447 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t438 + 0.4e1 / 0.3e1 * t23 * t443);
  t454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t447 * t26 * t64 - t398 / 0.4e1 + t295);
  t455 = t188 * t188;
  t460 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t111 + 0.2e1 * t359);
  t464 = my_piecewise3(t74, 0, 0.4e1 / 0.9e1 * t355 * t455 + 0.4e1 / 0.3e1 * t75 * t460);
  t470 = t2 * t191;
  t475 = 0.1e1 / t197 / t102;
  t476 = t26 * t475;
  t477 = t220 * t220;
  t478 = t476 * t477;
  t482 = 0.1e1 / t81 / t93;
  t483 = sigma[2] * t482;
  t489 = t93 * t200;
  t491 = 0.1e1 / t80 / t489;
  t492 = t92 * t491;
  t496 = t92 * sigma[2];
  t497 = t323 * t496;
  t498 = t93 * t93;
  t499 = t498 * t79;
  t500 = 0.1e1 / t499;
  t507 = t92 * t92;
  t508 = t498 * t93;
  t510 = 0.1e1 / t81 / t508;
  t512 = t100 * t100;
  t513 = 0.1e1 / t512;
  t517 = 0.11e3 / 0.2187e4 * t33 * t483 + 0.39134815150061607728e-1 * t33 * t483 * t88 - 0.4002424276710846245e-2 * t50 * t492 * t88 + 0.29647587234895157371e-3 * t497 * t500 * t88 + 0.46546888076566221358e-3 * t50 * t492 * t216 - 0.32409166382013480325e-7 * t337 * t507 * t510 * t513;
  t518 = t199 * t517;
  t522 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t464 * t26 * t105 - t422 / 0.4e1 - 0.33102190727492640992e0 * t470 * t221 + t378 - 0.11034063575830880331e0 * t430 + 0.33102190727492640992e0 * t196 * t478 - 0.16551095363746320496e0 * t196 * t518);
  tv2rho22 = 0.2e1 * t186 + 0.2e1 * t225 + t6 * (t454 + t522);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t527 = t296 * t240;
  t529 = 0.55170317879154401653e-1 * t128 * t527;
  t530 = t128 * t26;
  t531 = t301 * t240;
  t532 = t531 * t152;
  t540 = t143 * sigma[0];
  t544 = t323 * t51;
  t545 = t326 * rho[0];
  t546 = 0.1e1 / t545;
  t553 = t326 * t132;
  t555 = 0.1e1 / t36 / t553;
  t560 = -0.1e2 / 0.729e3 * t33 * t134 - 0.10673131404562256653e-1 * t33 * t134 * t43 + 0.13341414255702820817e-2 * t50 * t540 * t43 - 0.11117845213085684014e-3 * t544 * t546 * t43 - 0.14699017287336701482e-3 * t50 * t540 * t148 + 0.12153437393255055122e-7 * t337 * t324 * t555 * t344;
  t561 = t131 * t560;
  t565 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t287 * t241 - t529 + 0.33102190727492640992e0 * t530 * t532 - 0.16551095363746320496e0 * t128 * t561);
  tv2rhosigma0 = t6 * t565 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t569 = t428 * t257;
  t571 = 0.55170317879154401653e-1 * t196 * t569;
  t573 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t425 * t258 - t571);
  tv2rhosigma2 = t6 * t573 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t578 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t400 * t241 - t529);
  tv2rhosigma3 = t6 * t578 + t244;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t582 = t196 * t26;
  t583 = t475 * t257;
  t584 = t583 * t220;
  t592 = t211 * sigma[2];
  t596 = t323 * t92;
  t597 = t498 * rho[1];
  t598 = 0.1e1 / t597;
  t605 = t498 * t200;
  t607 = 0.1e1 / t81 / t605;
  t612 = -0.1e2 / 0.729e3 * t33 * t202 - 0.10673131404562256653e-1 * t33 * t202 * t88 + 0.13341414255702820817e-2 * t50 * t592 * t88 - 0.11117845213085684014e-3 * t596 * t598 * t88 - 0.14699017287336701482e-3 * t50 * t592 * t216 + 0.12153437393255055122e-7 * t337 * t496 * t607 * t513;
  t613 = t199 * t612;
  t617 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t470 * t258 - t571 + 0.33102190727492640992e0 * t582 * t584 - 0.16551095363746320496e0 * t196 * t613);
  tv2rhosigma5 = t6 * t617 + t261;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t619 = t240 * t240;
  t620 = t302 * t619;
  t626 = t323 * sigma[0];
  t627 = 0.1e1 / t326;
  t635 = 0.1e1 / t36 / t327;
  t640 = -0.33353535639257052042e-3 * t50 * t55 * t43 + 0.41691919549071315052e-4 * t626 * t627 * t43 + 0.27560657413756315278e-4 * t50 * t55 * t148 - 0.45575390224706456708e-8 * t337 * t51 * t635 * t344;
  t641 = t131 * t640;
  t645 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t128 * t620 - 0.16551095363746320496e0 * t128 * t641);
  tv2sigma20 = t6 * t645;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t646 = t257 * t257;
  t647 = t476 * t646;
  t653 = t323 * sigma[2];
  t654 = 0.1e1 / t498;
  t662 = 0.1e1 / t81 / t499;
  t667 = -0.33353535639257052042e-3 * t50 * t96 * t88 + 0.41691919549071315052e-4 * t653 * t654 * t88 + 0.27560657413756315278e-4 * t50 * t96 * t216 - 0.45575390224706456708e-8 * t337 * t92 * t662 * t513;
  t668 = t199 * t667;
  t672 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t196 * t647 - 0.16551095363746320496e0 * t196 * t668);
  tv2sigma25 = t6 * t672;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t676 = 0.1e1 / t36 / t53;
  t677 = sigma[0] * t676;
  t684 = 0.1e1 / t35 / t326;
  t685 = t51 * t684;
  t689 = 0.1e1 / t553;
  t693 = t323 * t338;
  t694 = t326 * t53;
  t696 = 0.1e1 / t36 / t694;
  t698 = t33 * t43;
  t708 = t338 * t51;
  t709 = t326 * t326;
  t711 = 0.1e1 / t709 / t132;
  t714 = 0.1e1 / t343 / t59;
  t717 = -0.154e4 / 0.6561e4 * t33 * t677 - 0.1826291373669541694e0 * t33 * t677 * t43 + 0.33699424156997495545e-1 * t50 * t685 * t43 - 0.56330415746300799004e-2 * t325 * t689 * t43 + 0.32941763594327952634e-4 * t693 * t696 * t698 - 0.34134384589481895663e-2 * t50 * t685 * t148 + 0.61577416125825612618e-6 * t337 * t338 * t696 * t344 - 0.3012370804988962832e-14 * t708 * t711 * t714;
  t718 = t131 * t717;
  t721 = t291 * t130;
  t722 = t721 * t152;
  t723 = t128 * t722;
  t725 = t296 * t348;
  t726 = t128 * t725;
  t728 = t2 * t278;
  t731 = t287 * t297;
  t735 = t129 * t129;
  t736 = 0.1e1 / t735;
  t737 = t26 * t736;
  t738 = t303 * t152;
  t739 = t737 * t738;
  t743 = t301 * t152 * t348;
  t747 = 0.1e1 / t122 / t110;
  t751 = 0.5e1 / 0.36e2 * t5 * t25 * t747 * t64;
  t752 = t123 * t301;
  t753 = t752 * t303;
  t754 = t128 * t753;
  t758 = t5 * t278 * t123 * t64;
  t762 = t5 * t117 * t291 * t64;
  t767 = 0.1e1 / t264 / t19;
  t768 = t266 * t114;
  t771 = t265 * t114;
  t774 = t110 * t110;
  t775 = 0.1e1 / t774;
  t776 = t16 * t775;
  t779 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t270 - 0.6e1 * t776);
  t783 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t767 * t768 + 0.4e1 / 0.3e1 * t771 * t274 + 0.4e1 / 0.3e1 * t23 * t779);
  t788 = -0.16551095363746320496e0 * t128 * t718 + 0.11034063575830880331e0 * t723 - 0.16551095363746320496e0 * t726 - 0.49653286091238961488e0 * t728 * t153 - 0.33102190727492640993e0 * t731 - 0.49653286091238961488e0 * t287 * t349 - 0.99306572182477922976e0 * t128 * t739 + 0.99306572182477922976e0 * t530 * t743 - t751 + 0.33102190727492640993e0 * t754 - 0.3e1 / 0.8e1 * t758 + t762 / 0.4e1 + 0.99306572182477922976e0 * t287 * t304 - 0.3e1 / 0.8e1 * t5 * t783 * t26 * t64;
  t789 = my_piecewise3(t1, 0, t788);
  t791 = 0.1e1 / t354 / t73;
  t792 = t356 * t160;
  t795 = t355 * t160;
  t798 = t70 * t775;
  t801 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t270 - 0.6e1 * t798);
  t805 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t791 * t792 + 0.4e1 / 0.3e1 * t795 * t362 + 0.4e1 / 0.3e1 * t75 * t801);
  t812 = t5 * t366 * t123 * t105;
  t816 = t5 * t163 * t291 * t105;
  t821 = 0.5e1 / 0.36e2 * t5 * t77 * t747 * t105;
  t823 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t805 * t26 * t105 - 0.3e1 / 0.8e1 * t812 + t816 / 0.4e1 - t821);
  tv3rho30 = 0.3e1 * t353 + 0.3e1 * t380 + t6 * (t789 + t823);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t826 = 0.2e1 * t406;
  t827 = 0.2e1 * t433;
  t828 = t767 * t177;
  t831 = t265 * t387;
  t836 = 0.2e1 * t270;
  t837 = 0.6e1 * t776;
  t839 = my_piecewise5(t10, 0, t14, 0, t836 - t837);
  t843 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t828 * t266 + 0.8e1 / 0.9e1 * t831 * t114 + 0.4e1 / 0.9e1 * t383 * t274 + 0.4e1 / 0.3e1 * t23 * t839);
  t851 = t5 * t391 * t123 * t64 / 0.4e1;
  t852 = t2 * t391;
  t857 = t5 * t180 * t291 * t64;
  t860 = 0.11034063575830880331e0 * t400 * t297;
  t871 = -0.3e1 / 0.8e1 * t5 * t843 * t26 * t64 - t851 - 0.33102190727492640992e0 * t852 * t153 + t857 / 0.12e2 - t860 + 0.33102190727492640992e0 * t400 * t304 - 0.16551095363746320496e0 * t400 * t349 - t758 / 0.8e1 + t762 / 0.6e1 - 0.11034063575830880331e0 * t731 - t751 + 0.73560423838872535538e-1 * t723 + 0.11034063575830880331e0 * t754 - 0.55170317879154401654e-1 * t726;
  t872 = my_piecewise3(t1, 0, t871);
  t873 = t791 * t188;
  t876 = t355 * t411;
  t881 = 0.6e1 * t798;
  t883 = my_piecewise5(t14, 0, t10, 0, -t836 - t881);
  t887 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t873 * t356 + 0.8e1 / 0.9e1 * t876 * t160 + 0.4e1 / 0.9e1 * t407 * t362 + 0.4e1 / 0.3e1 * t75 * t883);
  t895 = t5 * t415 * t123 * t105 / 0.4e1;
  t898 = t5 * t191 * t291 * t105;
  t902 = t2 * t366;
  t906 = 0.11034063575830880331e0 * t425 * t429;
  t907 = t291 * t198;
  t908 = t907 * t220;
  t909 = t196 * t908;
  t912 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t887 * t26 * t105 - t895 + t898 / 0.12e2 - t812 / 0.8e1 + t816 / 0.6e1 - t821 - 0.16551095363746320496e0 * t902 * t221 - t906 + 0.36780211919436267769e-1 * t909);
  tv3rho31 = t353 + t380 + t826 + t827 + t6 * (t872 + t912);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t915 = t767 * t438;
  t920 = t265 * t443;
  t924 = my_piecewise5(t10, 0, t14, 0, -t836 - t837);
  t928 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t915 * t114 + 0.8e1 / 0.9e1 * t383 * t387 + 0.4e1 / 0.9e1 * t920 * t114 + 0.4e1 / 0.3e1 * t23 * t924);
  t935 = t5 * t447 * t123 * t64;
  t937 = t2 * t447;
  t944 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t928 * t26 * t64 - t935 / 0.8e1 - 0.16551095363746320496e0 * t937 * t153 - t851 + t857 / 0.6e1 - t860 + t762 / 0.12e2 - t751 + 0.36780211919436267769e-1 * t723);
  t945 = t791 * t455;
  t950 = t355 * t460;
  t954 = my_piecewise5(t14, 0, t10, 0, t836 - t881);
  t958 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t945 * t160 + 0.8e1 / 0.9e1 * t407 * t411 + 0.4e1 / 0.9e1 * t950 * t160 + 0.4e1 / 0.3e1 * t75 * t954);
  t965 = t5 * t464 * t123 * t105;
  t968 = t2 * t415;
  t971 = t470 * t429;
  t977 = t123 * t475;
  t978 = t977 * t477;
  t979 = t196 * t978;
  t983 = t428 * t517;
  t984 = t196 * t983;
  t986 = -0.3e1 / 0.8e1 * t5 * t958 * t26 * t105 - t965 / 0.8e1 - t895 + t898 / 0.6e1 - 0.33102190727492640992e0 * t968 * t221 - 0.11034063575830880331e0 * t971 + t816 / 0.12e2 - t821 - t906 + 0.7356042383887253554e-1 * t909 + 0.33102190727492640992e0 * t425 * t478 + 0.11034063575830880331e0 * t979 - 0.16551095363746320496e0 * t425 * t518 - 0.55170317879154401653e-1 * t984;
  t987 = my_piecewise3(t69, 0, t986);
  tv3rho32 = t826 + t827 + t454 + t522 + t6 * (t944 + t987);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t992 = t438 * t177;
  t999 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t270 - 0.6e1 * t776);
  t1003 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t767 * t992 + 0.4e1 / 0.3e1 * t383 * t443 + 0.4e1 / 0.3e1 * t23 * t999);
  t1011 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1003 * t26 * t64 - 0.3e1 / 0.8e1 * t935 + t857 / 0.4e1 - t751);
  t1013 = 0.1e1 / t81 / t94;
  t1014 = sigma[2] * t1013;
  t1021 = 0.1e1 / t80 / t498;
  t1022 = t92 * t1021;
  t1026 = 0.1e1 / t605;
  t1030 = t323 * t507;
  t1031 = t498 * t94;
  t1033 = 0.1e1 / t81 / t1031;
  t1035 = t33 * t88;
  t1045 = t507 * t92;
  t1046 = t498 * t498;
  t1048 = 0.1e1 / t1046 / t200;
  t1051 = 0.1e1 / t512 / t100;
  t1054 = -0.154e4 / 0.6561e4 * t33 * t1014 - 0.1826291373669541694e0 * t33 * t1014 * t88 + 0.33699424156997495545e-1 * t50 * t1022 * t88 - 0.56330415746300799004e-2 * t497 * t1026 * t88 + 0.32941763594327952634e-4 * t1030 * t1033 * t1035 - 0.34134384589481895663e-2 * t50 * t1022 * t216 + 0.61577416125825612618e-6 * t337 * t507 * t1033 * t513 - 0.3012370804988962832e-14 * t1045 * t1048 * t1051;
  t1055 = t199 * t1054;
  t1058 = t2 * t464;
  t1063 = t455 * t188;
  t1070 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t270 - 0.6e1 * t798);
  t1074 = my_piecewise3(t74, 0, -0.8e1 / 0.27e2 * t791 * t1063 + 0.4e1 / 0.3e1 * t407 * t460 + 0.4e1 / 0.3e1 * t75 * t1070);
  t1079 = t197 * t197;
  t1080 = 0.1e1 / t1079;
  t1081 = t26 * t1080;
  t1082 = t477 * t220;
  t1083 = t1081 * t1082;
  t1087 = t475 * t220 * t517;
  t1098 = -0.16551095363746320496e0 * t196 * t1055 - 0.49653286091238961488e0 * t1058 * t221 - 0.49653286091238961488e0 * t470 * t518 - 0.3e1 / 0.8e1 * t5 * t1074 * t26 * t105 - 0.99306572182477922976e0 * t196 * t1083 + 0.99306572182477922976e0 * t582 * t1087 + 0.99306572182477922976e0 * t470 * t478 - 0.33102190727492640993e0 * t971 + 0.33102190727492640993e0 * t979 - 0.16551095363746320496e0 * t984 - 0.3e1 / 0.8e1 * t965 + t898 / 0.4e1 + 0.11034063575830880331e0 * t909 - t821;
  t1099 = my_piecewise3(t69, 0, t1098);
  tv3rho33 = 0.3e1 * t454 + 0.3e1 * t522 + t6 * (t1011 + t1099);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1105 = t287 * t527;
  t1107 = t287 * t26;
  t1112 = t721 * t240;
  t1114 = 0.36780211919436267769e-1 * t128 * t1112;
  t1115 = t128 * t123;
  t1116 = t1115 * t532;
  t1118 = t296 * t560;
  t1119 = t128 * t1118;
  t1121 = t736 * t240;
  t1122 = t1121 * t303;
  t1125 = t301 * t560;
  t1126 = t1125 * t152;
  t1129 = t531 * t348;
  t1137 = t317 * sigma[0];
  t1141 = t323 * t328;
  t1142 = t51 * t43;
  t1155 = t338 * sigma[0];
  t1157 = 0.1e1 / t709 / t34;
  t1161 = 0.11e3 / 0.2187e4 * t33 * t308 + 0.39134815150061607728e-1 * t33 * t308 * t43 - 0.96354658513409261456e-2 * t50 * t1137 * t43 + 0.18900336862245662824e-2 * t1141 * t1142 - 0.12353161347872982238e-4 * t325 * t341 * t698 + 0.93093776153132442719e-3 * t50 * t1137 * t148 - 0.20660843568533593707e-6 * t337 * t324 * t341 * t344 + 0.1129639051870861062e-14 * t1155 * t1157 * t714;
  t1162 = t131 * t1161;
  t1165 = -0.16551095363746320496e0 * t728 * t241 - 0.11034063575830880331e0 * t1105 + 0.66204381454985281984e0 * t1107 * t532 - 0.33102190727492640992e0 * t287 * t561 + t1114 + 0.22068127151661760662e0 * t1116 - 0.11034063575830880331e0 * t1119 - 0.99306572182477922976e0 * t530 * t1122 + 0.66204381454985281984e0 * t530 * t1126 + 0.33102190727492640992e0 * t530 * t1129 - 0.16551095363746320496e0 * t128 * t1162;
  t1166 = my_piecewise3(t1, 0, t1165);
  tv3rho2sigma0 = t6 * t1166 + 0.2e1 * t565;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1171 = t425 * t569;
  t1173 = t907 * t257;
  t1175 = 0.36780211919436267769e-1 * t196 * t1173;
  t1177 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t902 * t258 - 0.11034063575830880331e0 * t1171 + t1175);
  tv3rho2sigma2 = t6 * t1177 + 0.2e1 * t573;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1181 = t400 * t527;
  t1183 = t400 * t26;
  t1192 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t852 * t241 - 0.55170317879154401653e-1 * t1181 + 0.33102190727492640992e0 * t1183 * t532 - 0.16551095363746320496e0 * t400 * t561 - 0.55170317879154401653e-1 * t1105 + t1114 + 0.11034063575830880331e0 * t1116 - 0.55170317879154401653e-1 * t1119);
  tv3rho2sigma3 = t6 * t1192 + t565 + t578;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1196 = t470 * t569;
  t1199 = t425 * t26;
  t1202 = t196 * t123;
  t1203 = t1202 * t584;
  t1207 = t428 * t612;
  t1208 = t196 * t1207;
  t1211 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t968 * t258 - 0.55170317879154401653e-1 * t1196 - 0.55170317879154401653e-1 * t1171 + t1175 + 0.33102190727492640992e0 * t1199 * t584 + 0.11034063575830880331e0 * t1203 - 0.16551095363746320496e0 * t425 * t613 - 0.55170317879154401653e-1 * t1208);
  tv3rho2sigma5 = t6 * t1211 + t573 + t617;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1218 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t937 * t241 - 0.11034063575830880331e0 * t1181 + t1114);
  tv3rho2sigma6 = t6 * t1218 + 0.2e1 * t578;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1224 = t470 * t26;
  t1231 = t1080 * t257;
  t1232 = t1231 * t477;
  t1235 = t475 * t612;
  t1236 = t1235 * t220;
  t1239 = t583 * t517;
  t1247 = t491 * sigma[2];
  t1251 = t323 * t500;
  t1252 = t92 * t88;
  t1265 = t507 * sigma[2];
  t1267 = 0.1e1 / t1046 / t79;
  t1271 = 0.11e3 / 0.2187e4 * t33 * t482 + 0.39134815150061607728e-1 * t33 * t482 * t88 - 0.96354658513409261456e-2 * t50 * t1247 * t88 + 0.18900336862245662824e-2 * t1251 * t1252 - 0.12353161347872982238e-4 * t497 * t510 * t1035 + 0.93093776153132442719e-3 * t50 * t1247 * t216 - 0.20660843568533593707e-6 * t337 * t496 * t510 * t513 + 0.1129639051870861062e-14 * t1265 * t1267 * t1051;
  t1272 = t199 * t1271;
  t1275 = -0.16551095363746320496e0 * t1058 * t258 - 0.11034063575830880331e0 * t1196 + 0.66204381454985281984e0 * t1224 * t584 - 0.33102190727492640992e0 * t470 * t613 + t1175 + 0.22068127151661760662e0 * t1203 - 0.11034063575830880331e0 * t1208 - 0.99306572182477922976e0 * t582 * t1232 + 0.66204381454985281984e0 * t582 * t1236 + 0.33102190727492640992e0 * t582 * t1239 - 0.16551095363746320496e0 * t196 * t1272;
  t1276 = my_piecewise3(t69, 0, t1275);
  tv3rho2sigma8 = t6 * t1276 + 0.2e1 * t617;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1280 = t752 * t619;
  t1282 = 0.11034063575830880331e0 * t128 * t1280;
  t1283 = t736 * t619;
  t1284 = t1283 * t152;
  t1287 = t531 * t560;
  t1292 = t296 * t640;
  t1294 = 0.55170317879154401653e-1 * t128 * t1292;
  t1295 = t301 * t640;
  t1296 = t1295 * t152;
  t1302 = t323 * t546;
  t1303 = sigma[0] * t43;
  t1312 = t555 * t344;
  t1316 = t709 * rho[0];
  t1317 = 0.1e1 / t1316;
  t1321 = 0.17788552340937094422e-2 * t50 * t143 * t43 - 0.5558922606542842007e-3 * t1302 * t1303 + 0.46324355054523683391e-5 * t544 * t555 * t698 - 0.14699017287336701482e-3 * t50 * t143 * t148 + 0.60767186966275275611e-7 * t337 * t1312 * t51 - 0.42361464445157289826e-15 * t338 * t1317 * t714;
  t1322 = t131 * t1321;
  t1326 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t287 * t620 + t1282 - 0.99306572182477922976e0 * t530 * t1284 + 0.66204381454985281984e0 * t530 * t1287 - 0.16551095363746320496e0 * t287 * t641 - t1294 + 0.33102190727492640992e0 * t530 * t1296 - 0.16551095363746320496e0 * t128 * t1322);
  tv3rhosigma20 = t6 * t1326 + t645;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1330 = t977 * t646;
  t1332 = 0.11034063575830880331e0 * t196 * t1330;
  t1335 = t428 * t667;
  t1337 = 0.55170317879154401653e-1 * t196 * t1335;
  t1339 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t425 * t647 + t1332 - 0.16551095363746320496e0 * t425 * t668 - t1337);
  tv3rhosigma25 = t6 * t1339 + t672;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1346 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t400 * t620 + t1282 - 0.16551095363746320496e0 * t400 * t641 - t1294);
  tv3rhosigma26 = t6 * t1346 + t645;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1350 = t1080 * t646;
  t1351 = t1350 * t220;
  t1354 = t583 * t612;
  t1359 = t475 * t667;
  t1360 = t1359 * t220;
  t1366 = t323 * t598;
  t1367 = sigma[2] * t88;
  t1376 = t607 * t513;
  t1380 = t1046 * rho[1];
  t1381 = 0.1e1 / t1380;
  t1385 = 0.17788552340937094422e-2 * t50 * t211 * t88 - 0.5558922606542842007e-3 * t1366 * t1367 + 0.46324355054523683391e-5 * t596 * t607 * t1035 - 0.14699017287336701482e-3 * t50 * t211 * t216 + 0.60767186966275275611e-7 * t337 * t1376 * t92 - 0.42361464445157289826e-15 * t507 * t1381 * t1051;
  t1386 = t199 * t1385;
  t1390 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t470 * t647 + t1332 - 0.99306572182477922976e0 * t582 * t1351 + 0.66204381454985281984e0 * t582 * t1354 - 0.16551095363746320496e0 * t470 * t668 - t1337 + 0.33102190727492640992e0 * t582 * t1360 - 0.16551095363746320496e0 * t196 * t1386);
  tv3rhosigma211 = t6 * t1390 + t672;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1392 = t619 * t240;
  t1393 = t737 * t1392;
  t1396 = t531 * t640;
  t1405 = t635 * t344;
  t1409 = 0.1e1 / t709;
  t1413 = 0.12507575864721394516e-3 * t323 * t627 * t43 - 0.17371633145446381272e-5 * t626 * t635 * t698 - 0.13672617067411937012e-7 * t337 * t1405 * sigma[0] + 0.15885549166933983685e-15 * t324 * t1409 * t714;
  t1414 = t131 * t1413;
  t1418 = my_piecewise3(t1, 0, -0.99306572182477922976e0 * t128 * t1393 + 0.99306572182477922976e0 * t530 * t1396 - 0.16551095363746320496e0 * t128 * t1414);
  tv3sigma30 = t6 * t1418;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1419 = t646 * t257;
  t1420 = t1081 * t1419;
  t1423 = t583 * t667;
  t1432 = t662 * t513;
  t1436 = 0.1e1 / t1046;
  t1440 = 0.12507575864721394516e-3 * t323 * t654 * t88 - 0.17371633145446381272e-5 * t653 * t662 * t1035 - 0.13672617067411937012e-7 * t337 * t1432 * sigma[2] + 0.15885549166933983685e-15 * t496 * t1436 * t1051;
  t1441 = t199 * t1440;
  t1445 = my_piecewise3(t69, 0, -0.99306572182477922976e0 * t196 * t1420 + 0.99306572182477922976e0 * t582 * t1423 - 0.16551095363746320496e0 * t196 * t1441);
  tv3sigma39 = t6 * t1445;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1449 = t128 * t296 * t717;
  t1451 = t728 * t297;
  t1453 = t747 * t130;
  t1455 = t128 * t1453 * t152;
  t1457 = t291 * t301;
  t1459 = t128 * t1457 * t303;
  t1461 = t348 * t348;
  t1467 = t287 * t753;
  t1473 = sigma[0] / t36 / t141;
  t1481 = t51 / t35 / t545;
  t1489 = t326 * t141;
  t1491 = 0.1e1 / t36 / t1489;
  t1499 = t50 * t43;
  t1514 = t338 * t338;
  t1519 = t343 * t343;
  t1522 = 0.1e1 / t1519 * t47 * t49;
  t1529 = t123 * t736;
  t1531 = t128 * t1529 * t738;
  t1534 = 0.1e1 / t735 / t61;
  t1535 = t26 * t1534;
  t1536 = t303 * t303;
  t1542 = t287 * t722;
  t1544 = -0.22068127151661760661e0 * t1449 - 0.66204381454985281985e0 * t1451 - 0.24520141279624178513e0 * t1455 - 0.44136254303323521324e0 * t1459 + 0.99306572182477922976e0 * t128 * t302 * t1461 + 0.19861314436495584595e1 * t728 * t304 + 0.13240876290997056397e1 * t1467 - 0.66204381454985281984e0 * t287 * t718 - 0.16551095363746320496e0 * t128 * t131 * (0.2618e5 / 0.19683e5 * t33 * t1473 + 0.10348984450794069599e1 * t33 * t1473 * t43 - 0.30112066101575181503e0 * t50 * t1481 * t43 + 0.84429740092262542601e-1 * t325 / t339 * t43 - 0.10760976107480464527e-2 * t693 * t1491 * t698 + 0.36601959549253280704e-5 * t323 * t1155 / t35 / t1316 * t1499 + 0.28445320491234913052e-1 * t50 * t1481 * t148 - 0.99208059313830153663e-5 * t337 * t338 * t1491 * t344 + 0.11447009058958058762e-12 * t708 / t709 / t52 * t714 - 0.66418335807601710336e-18 * t1514 / t35 / t709 / t545 * t1522) - 0.13240876290997056397e1 * t1531 + 0.3972262887299116919e1 * t128 * t1535 * t1536 - 0.99306572182477922976e0 * t728 * t349 + 0.44136254303323521324e0 * t1542;
  t1546 = t128 * t721 * t348;
  t1548 = t287 * t725;
  t1552 = t5 * t278 * t291 * t64;
  t1555 = 0.1e1 / t122 / t269;
  t1559 = 0.1e2 / 0.27e2 * t5 * t25 * t1555 * t64;
  t1560 = t19 * t19;
  t1562 = 0.1e1 / t264 / t1560;
  t1563 = t266 * t266;
  t1569 = t274 * t274;
  t1575 = 0.1e1 / t774 / t6;
  t1576 = t16 * t1575;
  t1579 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t775 + 0.24e2 * t1576);
  t1583 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1562 * t1563 - 0.16e2 / 0.9e1 * t767 * t266 * t274 + 0.4e1 / 0.3e1 * t265 * t1569 + 0.16e2 / 0.9e1 * t771 * t779 + 0.4e1 / 0.3e1 * t23 * t1579);
  t1590 = t5 * t783 * t123 * t64;
  t1594 = t5 * t117 * t747 * t64;
  t1598 = t2 * t783;
  t1605 = t1115 * t743;
  t1613 = 0.22068127151661760662e0 * t1546 - 0.66204381454985281985e0 * t1548 + t1552 / 0.2e1 + t1559 - 0.3e1 / 0.8e1 * t5 * t1583 * t26 * t64 - t1590 / 0.2e1 - 0.5e1 / 0.9e1 * t1594 - 0.39722628872991169191e1 * t287 * t739 - 0.66204381454985281984e0 * t1598 * t153 + 0.13240876290997056397e1 * t530 * t301 * t717 * t152 + 0.13240876290997056397e1 * t1605 - 0.59583943309486753786e1 * t530 * t736 * t303 * t348 + 0.3972262887299116919e1 * t1107 * t743;
  t1615 = my_piecewise3(t1, 0, t1544 + t1613);
  t1616 = t73 * t73;
  t1618 = 0.1e1 / t354 / t1616;
  t1619 = t356 * t356;
  t1625 = t362 * t362;
  t1630 = t70 * t1575;
  t1633 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t775 + 0.24e2 * t1630);
  t1637 = my_piecewise3(t74, 0, 0.4e2 / 0.81e2 * t1618 * t1619 - 0.16e2 / 0.9e1 * t791 * t356 * t362 + 0.4e1 / 0.3e1 * t355 * t1625 + 0.16e2 / 0.9e1 * t795 * t801 + 0.4e1 / 0.3e1 * t75 * t1633);
  t1644 = t5 * t805 * t123 * t105;
  t1648 = t5 * t366 * t291 * t105;
  t1652 = t5 * t163 * t747 * t105;
  t1657 = 0.1e2 / 0.27e2 * t5 * t77 * t1555 * t105;
  t1659 = my_piecewise3(t69, 0, -0.3e1 / 0.8e1 * t5 * t1637 * t26 * t105 - t1644 / 0.2e1 + t1648 / 0.2e1 - 0.5e1 / 0.9e1 * t1652 + t1657);
  tv4rho40 = 0.4e1 * t789 + 0.4e1 * t823 + t6 * (t1615 + t1659);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1668 = t400 * t722;
  t1669 = 0.11034063575830880331e0 * t1668;
  t1670 = t400 * t725;
  t1688 = 0.12e2 * t775;
  t1689 = 0.24e2 * t1576;
  t1691 = my_piecewise5(t10, 0, t14, 0, -t1688 + t1689);
  t1695 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1562 * t177 * t768 - 0.8e1 / 0.9e1 * t767 * t387 * t266 - 0.8e1 / 0.9e1 * t828 * t114 * t274 + 0.4e1 / 0.3e1 * t265 * t839 * t114 + 0.4e1 / 0.3e1 * t831 * t274 + 0.4e1 / 0.9e1 * t383 * t779 + 0.4e1 / 0.3e1 * t23 * t1691);
  t1700 = t2 * t843;
  t1703 = t852 * t297;
  t1707 = t5 * t180 * t747 * t64;
  t1709 = t400 * t753;
  t1713 = t5 * t843 * t123 * t64;
  t1717 = t5 * t391 * t291 * t64;
  t1718 = t1717 / 0.4e1;
  t1724 = -0.49653286091238961488e0 * t852 * t349 - 0.16551095363746320496e0 * t400 * t718 + t1669 - 0.16551095363746320496e0 * t1670 - 0.3e1 / 0.8e1 * t5 * t1695 * t26 * t64 - 0.49653286091238961488e0 * t1700 * t153 - 0.33102190727492640993e0 * t1703 - 0.5e1 / 0.36e2 * t1707 + 0.33102190727492640993e0 * t1709 - 0.3e1 / 0.8e1 * t1713 + t1718 + 0.99306572182477922976e0 * t852 * t304 - 0.55170317879154401654e-1 * t1449 - 0.99306572182477922976e0 * t400 * t739;
  t1739 = -0.16551095363746320496e0 * t1451 - 0.18390105959718133884e0 * t1455 - 0.22068127151661760662e0 * t1459 + 0.33102190727492640993e0 * t1467 - 0.33102190727492640993e0 * t1531 + 0.22068127151661760662e0 * t1542 + 0.11034063575830880331e0 * t1546 - 0.16551095363746320496e0 * t1548 + t1552 / 0.4e1 + t1559 - t1590 / 0.8e1 - 0.5e1 / 0.12e2 * t1594 + 0.99306572182477922976e0 * t1183 * t743 + 0.33102190727492640993e0 * t1605;
  t1741 = my_piecewise3(t1, 0, t1724 + t1739);
  t1758 = 0.24e2 * t1630;
  t1760 = my_piecewise5(t14, 0, t10, 0, t1688 + t1758);
  t1764 = my_piecewise3(t74, 0, 0.4e2 / 0.81e2 * t1618 * t188 * t792 - 0.8e1 / 0.9e1 * t791 * t411 * t356 - 0.8e1 / 0.9e1 * t873 * t160 * t362 + 0.4e1 / 0.3e1 * t355 * t883 * t160 + 0.4e1 / 0.3e1 * t876 * t362 + 0.4e1 / 0.9e1 * t407 * t801 + 0.4e1 / 0.3e1 * t75 * t1760);
  t1771 = t5 * t887 * t123 * t105;
  t1775 = t5 * t415 * t291 * t105;
  t1776 = t1775 / 0.4e1;
  t1779 = t5 * t191 * t747 * t105;
  t1784 = t2 * t805;
  t1787 = t902 * t429;
  t1789 = t425 * t908;
  t1790 = 0.11034063575830880331e0 * t1789;
  t1791 = t747 * t198;
  t1793 = t196 * t1791 * t220;
  t1795 = -0.3e1 / 0.8e1 * t5 * t1764 * t26 * t105 - 0.3e1 / 0.8e1 * t1771 + t1776 - 0.5e1 / 0.36e2 * t1779 - t1644 / 0.8e1 + t1648 / 0.4e1 - 0.5e1 / 0.12e2 * t1652 + t1657 - 0.16551095363746320496e0 * t1784 * t221 - 0.16551095363746320496e0 * t1787 + t1790 - 0.61300353199060446282e-1 * t1793;
  t1796 = my_piecewise3(t69, 0, t1795);
  tv4rho41 = t789 + t823 + 0.3e1 * t872 + 0.3e1 * t912 + t6 * (t1741 + t1796);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1807 = t5 * t928 * t123 * t64;
  t1811 = t5 * t447 * t291 * t64;
  t1813 = t937 * t297;
  t1825 = t387 * t387;
  t1838 = my_piecewise5(t10, 0, t14, 0, t1689);
  t1842 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1562 * t438 * t266 - 0.32e2 / 0.27e2 * t828 * t114 * t387 - 0.8e1 / 0.27e2 * t915 * t274 + 0.8e1 / 0.9e1 * t265 * t1825 + 0.8e1 / 0.9e1 * t383 * t839 - 0.8e1 / 0.27e2 * t767 * t443 * t266 + 0.8e1 / 0.9e1 * t265 * t924 * t114 + 0.4e1 / 0.9e1 * t920 * t274 + 0.4e1 / 0.3e1 * t23 * t1838);
  t1847 = t2 * t928;
  t1864 = t1717 / 0.3e1 + 0.14712084767774507108e0 * t1668 - 0.11034063575830880331e0 * t1670 - 0.22068127151661760662e0 * t1703 + t1552 / 0.12e2 + t1559 - 0.5e1 / 0.18e2 * t1594 + 0.73560423838872535538e-1 * t1542 + 0.36780211919436267769e-1 * t1546 - 0.12260070639812089256e0 * t1455 - 0.73560423838872535538e-1 * t1459;
  t1866 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t937 * t304 - t1807 / 0.4e1 + t1811 / 0.12e2 - 0.11034063575830880331e0 * t1813 - 0.16551095363746320496e0 * t937 * t349 - 0.3e1 / 0.8e1 * t5 * t1842 * t26 * t64 - 0.33102190727492640992e0 * t1847 * t153 - 0.5e1 / 0.18e2 * t1707 + 0.22068127151661760662e0 * t1709 - t1713 / 0.4e1 + t1864);
  t1868 = t196 * t907 * t517;
  t1872 = t5 * t958 * t123 * t105;
  t1876 = t5 * t464 * t291 * t105;
  t1878 = t968 * t429;
  t1880 = t470 * t908;
  t1882 = t425 * t978;
  t1884 = t291 * t475;
  t1886 = t196 * t1884 * t477;
  t1888 = t425 * t983;
  t1903 = t411 * t411;
  t1916 = my_piecewise5(t14, 0, t10, 0, t1758);
  t1920 = my_piecewise3(t74, 0, 0.4e2 / 0.81e2 * t1618 * t455 * t356 - 0.32e2 / 0.27e2 * t873 * t160 * t411 - 0.8e1 / 0.27e2 * t945 * t362 + 0.8e1 / 0.9e1 * t355 * t1903 + 0.8e1 / 0.9e1 * t407 * t883 - 0.8e1 / 0.27e2 * t791 * t460 * t356 + 0.8e1 / 0.9e1 * t355 * t954 * t160 + 0.4e1 / 0.9e1 * t950 * t362 + 0.4e1 / 0.3e1 * t75 * t1916);
  t1925 = t2 * t887;
  t1936 = -0.3e1 / 0.8e1 * t5 * t1920 * t26 * t105 - 0.33102190727492640992e0 * t1925 * t221 - t1771 / 0.4e1 + t1775 / 0.3e1 - 0.5e1 / 0.18e2 * t1779 - 0.11034063575830880331e0 * t1787 + 0.14712084767774507108e0 * t1789 - 0.12260070639812089257e0 * t1793 + t1648 / 0.12e2 - 0.5e1 / 0.18e2 * t1652 + t1657;
  t1938 = my_piecewise3(t69, 0, 0.36780211919436267769e-1 * t1868 - t1872 / 0.4e1 + t1876 / 0.12e2 - 0.22068127151661760662e0 * t1878 + 0.7356042383887253554e-1 * t1880 + 0.22068127151661760662e0 * t1882 - 0.7356042383887253554e-1 * t1886 - 0.11034063575830880331e0 * t1888 + 0.33102190727492640992e0 * t902 * t478 - 0.16551095363746320496e0 * t902 * t518 + t1936);
  tv4rho42 = 0.2e1 * t872 + 0.2e1 * t912 + 0.2e1 * t944 + 0.2e1 * t987 + t6 * (t1866 + t1938);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1959 = my_piecewise5(t10, 0, t14, 0, t1688 + t1689);
  t1963 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1562 * t992 * t114 - 0.8e1 / 0.9e1 * t915 * t387 - 0.8e1 / 0.9e1 * t828 * t443 * t114 + 0.4e1 / 0.3e1 * t831 * t443 + 0.4e1 / 0.3e1 * t383 * t924 + 0.4e1 / 0.9e1 * t265 * t999 * t114 + 0.4e1 / 0.3e1 * t23 * t1959);
  t1970 = t5 * t1003 * t123 * t64;
  t1972 = t2 * t1003;
  t1981 = -0.3e1 / 0.8e1 * t5 * t1963 * t26 * t64 - t1970 / 0.8e1 - 0.16551095363746320496e0 * t1972 * t153 - 0.3e1 / 0.8e1 * t1807 + t1811 / 0.4e1 - 0.16551095363746320496e0 * t1813 + t1718 - 0.5e1 / 0.12e2 * t1707 + t1669 - 0.5e1 / 0.36e2 * t1594 + t1559 - 0.61300353199060446282e-1 * t1455;
  t1982 = my_piecewise3(t1, 0, t1981);
  t1983 = t1202 * t1087;
  t1990 = t196 * t428 * t1054;
  t1992 = t470 * t978;
  t1996 = t2 * t958;
  t2017 = my_piecewise5(t14, 0, t10, 0, -t1688 + t1758);
  t2021 = my_piecewise3(t74, 0, 0.4e2 / 0.81e2 * t1618 * t1063 * t160 - 0.8e1 / 0.9e1 * t945 * t411 - 0.8e1 / 0.9e1 * t873 * t460 * t160 + 0.4e1 / 0.3e1 * t876 * t460 + 0.4e1 / 0.3e1 * t407 * t954 + 0.4e1 / 0.9e1 * t355 * t1070 * t160 + 0.4e1 / 0.3e1 * t75 * t2017);
  t2028 = t1058 * t429;
  t2030 = t470 * t983;
  t2034 = t5 * t1074 * t123 * t105;
  t2036 = t123 * t1080;
  t2038 = t196 * t2036 * t1082;
  t2040 = 0.33102190727492640992e0 * t1983 + 0.99306572182477922976e0 * t1199 * t1087 + 0.99306572182477922976e0 * t968 * t478 - 0.55170317879154401653e-1 * t1990 + 0.33102190727492640992e0 * t1992 - 0.16551095363746320496e0 * t425 * t1055 - 0.49653286091238961488e0 * t1996 * t221 - 0.49653286091238961488e0 * t968 * t518 - 0.3e1 / 0.8e1 * t5 * t2021 * t26 * t105 - 0.99306572182477922976e0 * t425 * t1083 - 0.16551095363746320496e0 * t2028 - 0.16551095363746320496e0 * t2030 - t2034 / 0.8e1 - 0.33102190727492640992e0 * t2038;
  t2052 = -0.16551095363746320496e0 * t1888 - 0.3e1 / 0.8e1 * t1872 + t1876 / 0.4e1 - 0.33102190727492640993e0 * t1878 + 0.22068127151661760662e0 * t1880 + 0.33102190727492640993e0 * t1882 - 0.22068127151661760662e0 * t1886 + 0.11034063575830880331e0 * t1868 + t1790 - 0.18390105959718133885e0 * t1793 + t1776 - 0.5e1 / 0.12e2 * t1779 - 0.5e1 / 0.36e2 * t1652 + t1657;
  t2054 = my_piecewise3(t69, 0, t2040 + t2052);
  tv4rho43 = 0.3e1 * t944 + 0.3e1 * t987 + t1011 + t1099 + t6 * (t1982 + t2054);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2059 = t438 * t438;
  t2064 = t443 * t443;
  t2071 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t775 + 0.24e2 * t1576);
  t2075 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1562 * t2059 - 0.16e2 / 0.9e1 * t915 * t443 + 0.4e1 / 0.3e1 * t265 * t2064 + 0.16e2 / 0.9e1 * t383 * t999 + 0.4e1 / 0.3e1 * t23 * t2071);
  t2084 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2075 * t26 * t64 - t1970 / 0.2e1 + t1811 / 0.2e1 - 0.5e1 / 0.9e1 * t1707 + t1559);
  t2094 = sigma[2] / t81 / t209;
  t2102 = t92 / t80 / t597;
  t2110 = t498 * t209;
  t2112 = 0.1e1 / t81 / t2110;
  t2120 = t50 * t88;
  t2135 = t507 * t507;
  t2140 = t512 * t512;
  t2143 = 0.1e1 / t2140 * t47 * t49;
  t2150 = t2 * t1074;
  t2159 = t455 * t455;
  t2164 = t460 * t460;
  t2171 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t775 + 0.24e2 * t1630);
  t2175 = my_piecewise3(t74, 0, 0.4e2 / 0.81e2 * t1618 * t2159 - 0.16e2 / 0.9e1 * t945 * t460 + 0.4e1 / 0.3e1 * t355 * t2164 + 0.16e2 / 0.9e1 * t407 * t1070 + 0.4e1 / 0.3e1 * t75 * t2171);
  t2182 = t517 * t517;
  t2187 = 0.1e1 / t1079 / t102;
  t2188 = t26 * t2187;
  t2189 = t477 * t477;
  t2194 = -0.59583943309486753786e1 * t582 * t1080 * t477 * t517 + 0.3972262887299116919e1 * t1224 * t1087 + 0.13240876290997056397e1 * t1983 - 0.16551095363746320496e0 * t196 * t199 * (0.2618e5 / 0.19683e5 * t33 * t2094 + 0.10348984450794069599e1 * t33 * t2094 * t88 - 0.30112066101575181503e0 * t50 * t2102 * t88 + 0.84429740092262542601e-1 * t497 / t508 * t88 - 0.10760976107480464527e-2 * t1030 * t2112 * t1035 + 0.36601959549253280704e-5 * t323 * t1265 / t80 / t1380 * t2120 + 0.28445320491234913052e-1 * t50 * t2102 * t216 - 0.99208059313830153663e-5 * t337 * t507 * t2112 * t513 + 0.11447009058958058762e-12 * t1045 / t1046 / t93 * t1051 - 0.66418335807601710336e-18 * t2135 / t80 / t1046 / t597 * t2143) - 0.66204381454985281984e0 * t2150 * t221 - 0.99306572182477922976e0 * t1058 * t518 - 0.66204381454985281984e0 * t470 * t1055 - 0.39722628872991169191e1 * t470 * t1083 - 0.3e1 / 0.8e1 * t5 * t2175 * t26 * t105 + 0.19861314436495584595e1 * t1058 * t478 + 0.99306572182477922976e0 * t196 * t476 * t2182 + 0.3972262887299116919e1 * t196 * t2188 * t2189 - 0.22068127151661760661e0 * t1990;
  t2210 = 0.13240876290997056397e1 * t1992 - 0.66204381454985281985e0 * t2028 - 0.66204381454985281985e0 * t2030 - t2034 / 0.2e1 - 0.13240876290997056397e1 * t2038 + t1876 / 0.2e1 + 0.44136254303323521324e0 * t1880 - 0.44136254303323521324e0 * t1886 + 0.22068127151661760662e0 * t1868 - 0.24520141279624178513e0 * t1793 - 0.5e1 / 0.9e1 * t1779 + t1657 + 0.13240876290997056397e1 * t582 * t475 * t1054 * t220;
  t2212 = my_piecewise3(t69, 0, t2194 + t2210);
  tv4rho44 = 0.4e1 * t1011 + 0.4e1 * t1099 + t6 * (t2084 + t2212);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2220 = t1115 * t1122;
  t2225 = t287 * t123 * t532;
  t2237 = t128 * t291 * t532;
  t2239 = t1115 * t1126;
  t2243 = t1115 * t1129;
  t2248 = -0.29791971654743376893e1 * t530 * t1121 * t152 * t348 - 0.99306572182477922978e0 * t2220 - 0.29791971654743376893e1 * t1107 * t1122 + 0.66204381454985281985e0 * t2225 + 0.19861314436495584595e1 * t1107 * t1126 + 0.99306572182477922976e0 * t728 * t26 * t532 + 0.3972262887299116919e1 * t530 * t1534 * t240 * t738 - 0.22068127151661760662e0 * t2237 + 0.66204381454985281985e0 * t2239 + 0.99306572182477922976e0 * t1107 * t1129 + 0.33102190727492640993e0 * t2243 + 0.33102190727492640992e0 * t530 * t531 * t717;
  t2265 = t684 * sigma[0];
  t2303 = t128 * t296 * t1161;
  t2306 = t128 * t721 * t560;
  t2312 = t287 * t1118;
  t2318 = 0.61300353199060446282e-1 * t128 * t1453 * t240;
  t2319 = t287 * t1112;
  t2321 = t728 * t527;
  t2323 = 0.99306572182477922976e0 * t530 * t1125 * t348 + 0.99306572182477922976e0 * t530 * t301 * t1161 * t152 - 0.29791971654743376893e1 * t530 * t736 * t560 * t303 - 0.16551095363746320496e0 * t128 * t131 * (-0.154e4 / 0.6561e4 * t33 * t676 - 0.1826291373669541694e0 * t33 * t676 * t43 + 0.75008395704284748149e-1 * t50 * t2265 * t43 - 0.25323980763139613588e-1 * t323 * t689 * t1142 + 0.36647711998689847306e-3 * t323 * t696 * t324 * t698 - 0.13725734830969980264e-5 * t693 / t35 / t709 * t1499 - 0.68268769178963791327e-2 * t50 * t2265 * t148 + 0.30275562928530926203e-5 * t337 * t324 * t696 * t344 - 0.3953736681548013717e-13 * t1155 * t711 * t714 + 0.24906875927850641376e-18 * t338 * t324 / t35 / t709 / t326 * t1522) - 0.16551095363746320496e0 * t2303 + 0.11034063575830880331e0 * t2306 - 0.49653286091238961488e0 * t287 * t1162 - 0.49653286091238961488e0 * t728 * t561 - 0.33102190727492640993e0 * t2312 - 0.16551095363746320496e0 * t1598 * t241 - t2318 + 0.11034063575830880331e0 * t2319 - 0.16551095363746320496e0 * t2321;
  t2325 = my_piecewise3(t1, 0, t2248 + t2323);
  tv4rho3sigma0 = t6 * t2325 + 0.3e1 * t1166;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2330 = t902 * t569;
  t2332 = t425 * t1173;
  t2336 = 0.61300353199060446282e-1 * t196 * t1791 * t257;
  t2338 = my_piecewise3(t69, 0, -0.16551095363746320496e0 * t1784 * t258 - 0.16551095363746320496e0 * t2330 + 0.11034063575830880331e0 * t2332 - t2336);
  tv4rho3sigma2 = t6 * t2338 + 0.3e1 * t1177;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2340 = 0.2e1 * t1192;
  t2344 = 0.11034063575830880331e0 * t400 * t1118;
  t2354 = 0.11034063575830880331e0 * t852 * t527;
  t2358 = t400 * t1112;
  t2362 = 0.22068127151661760662e0 * t400 * t123 * t532;
  t2364 = -0.16551095363746320496e0 * t400 * t1162 - t2344 - 0.16551095363746320496e0 * t1700 * t241 - 0.33102190727492640992e0 * t852 * t561 + 0.66204381454985281984e0 * t1183 * t1126 + 0.33102190727492640992e0 * t1183 * t1129 - t2354 + 0.66204381454985281984e0 * t852 * t26 * t532 + 0.36780211919436267769e-1 * t2358 + t2362 + 0.11034063575830880331e0 * t2243;
  t2376 = -0.55170317879154401653e-1 * t2303 + 0.73560423838872535538e-1 * t2306 - 0.11034063575830880331e0 * t2312 - t2318 - 0.14712084767774507108e0 * t2237 + 0.22068127151661760662e0 * t2239 + 0.73560423838872535538e-1 * t2319 + 0.22068127151661760662e0 * t2225 - 0.55170317879154401653e-1 * t2321 - 0.99306572182477922976e0 * t1183 * t1122 - 0.33102190727492640993e0 * t2220;
  t2378 = my_piecewise3(t1, 0, t2364 + t2376);
  tv4rho3sigma3 = t6 * t2378 + t1166 + t2340;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2380 = 0.2e1 * t1211;
  t2384 = 0.11034063575830880331e0 * t968 * t569;
  t2385 = t470 * t1173;
  t2394 = 0.22068127151661760662e0 * t425 * t123 * t584;
  t2396 = t196 * t291 * t584;
  t2401 = 0.11034063575830880331e0 * t425 * t1207;
  t2403 = t196 * t907 * t612;
  t2405 = -0.16551095363746320496e0 * t1925 * t258 - t2384 + 0.36780211919436267769e-1 * t2385 - 0.55170317879154401653e-1 * t2330 + 0.73560423838872535538e-1 * t2332 - t2336 + 0.33102190727492640992e0 * t902 * t26 * t584 + t2394 - 0.7356042383887253554e-1 * t2396 - 0.16551095363746320496e0 * t902 * t613 - t2401 + 0.36780211919436267769e-1 * t2403;
  t2406 = my_piecewise3(t69, 0, t2405);
  tv4rho3sigma5 = t6 * t2406 + t1177 + t2380;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2410 = t937 * t527;
  t2421 = -0.16551095363746320496e0 * t1847 * t241 - 0.55170317879154401653e-1 * t2410 + 0.33102190727492640992e0 * t937 * t26 * t532 - 0.16551095363746320496e0 * t937 * t561 - t2354 + 0.7356042383887253554e-1 * t2358 + t2362 - t2344 + 0.36780211919436267769e-1 * t2319 - t2318 - 0.73560423838872535538e-1 * t2237 + 0.36780211919436267769e-1 * t2306;
  t2422 = my_piecewise3(t1, 0, t2421);
  tv4rho3sigma6 = t6 * t2422 + t1218 + t2340;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2426 = t1058 * t569;
  t2433 = t470 * t123 * t584;
  t2437 = t470 * t1207;
  t2440 = -0.16551095363746320496e0 * t1996 * t258 - 0.55170317879154401653e-1 * t2426 - t2384 + 0.7356042383887253554e-1 * t2385 + 0.66204381454985281984e0 * t968 * t26 * t584 + 0.22068127151661760661e0 * t2433 - 0.33102190727492640992e0 * t968 * t613 - 0.11034063575830880331e0 * t2437 + 0.36780211919436267769e-1 * t2332 - t2336 + t2394;
  t2445 = t1202 * t1232;
  t2449 = t1202 * t1236;
  t2453 = t1202 * t1239;
  t2458 = t196 * t428 * t1271;
  t2460 = -0.14712084767774507108e0 * t2396 - t2401 + 0.7356042383887253554e-1 * t2403 - 0.99306572182477922976e0 * t1199 * t1232 - 0.33102190727492640992e0 * t2445 + 0.66204381454985281984e0 * t1199 * t1236 + 0.22068127151661760661e0 * t2449 + 0.33102190727492640992e0 * t1199 * t1239 + 0.11034063575830880331e0 * t2453 - 0.16551095363746320496e0 * t425 * t1272 - 0.55170317879154401653e-1 * t2458;
  t2462 = my_piecewise3(t69, 0, t2440 + t2460);
  tv4rho3sigma8 = t6 * t2462 + t1276 + t2380;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2470 = my_piecewise3(t1, 0, -0.16551095363746320496e0 * t1972 * t241 - 0.16551095363746320496e0 * t2410 + 0.11034063575830880331e0 * t2358 - t2318);
  tv4rho3sigma9 = t6 * t2470 + 0.3e1 * t1218;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2482 = t1021 * sigma[2];
  t2536 = -0.29791971654743376893e1 * t582 * t1231 * t220 * t517 - 0.16551095363746320496e0 * t196 * t199 * (-0.154e4 / 0.6561e4 * t33 * t1013 - 0.1826291373669541694e0 * t33 * t1013 * t88 + 0.75008395704284748149e-1 * t50 * t2482 * t88 - 0.25323980763139613588e-1 * t323 * t1026 * t1252 + 0.36647711998689847306e-3 * t323 * t1033 * t496 * t1035 - 0.13725734830969980264e-5 * t1030 / t80 / t1046 * t2120 - 0.68268769178963791327e-2 * t50 * t2482 * t216 + 0.30275562928530926203e-5 * t337 * t496 * t1033 * t513 - 0.3953736681548013717e-13 * t1265 * t1048 * t1051 + 0.24906875927850641376e-18 * t507 * t496 / t80 / t1046 / t498 * t2143) - 0.49653286091238961488e0 * t470 * t1272 - 0.16551095363746320496e0 * t2150 * t258 - 0.49653286091238961488e0 * t1058 * t613 - 0.16551095363746320496e0 * t2458 - 0.33102190727492640993e0 * t2437 + 0.3972262887299116919e1 * t582 * t2187 * t257 * t1082 - 0.29791971654743376893e1 * t1224 * t1232 - 0.16551095363746320496e0 * t2426 + 0.11034063575830880331e0 * t2403 + 0.11034063575830880331e0 * t2385;
  t2563 = -t2336 + 0.19861314436495584595e1 * t1224 * t1236 + 0.99306572182477922976e0 * t1058 * t26 * t584 + 0.33102190727492640992e0 * t582 * t583 * t1054 + 0.99306572182477922976e0 * t582 * t475 * t1271 * t220 - 0.29791971654743376893e1 * t582 * t1080 * t612 * t477 + 0.99306572182477922976e0 * t1224 * t1239 + 0.99306572182477922976e0 * t582 * t1235 * t517 + 0.33102190727492640993e0 * t2453 - 0.99306572182477922978e0 * t2445 + 0.66204381454985281985e0 * t2449 + 0.66204381454985281985e0 * t2433 - 0.22068127151661760662e0 * t2396;
  t2565 = my_piecewise3(t69, 0, t2536 + t2563);
  tv4rho3sigma11 = t6 * t2565 + 0.3e1 * t1276;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2604 = t128 * t296 * t1321;
  t2615 = 0.36780211919436267769e-1 * t128 * t721 * t640;
  t2616 = t1115 * t1296;
  t2625 = t287 * t1292;
  t2629 = -0.16551095363746320496e0 * t128 * t131 * (-0.11266083149260159801e-1 * t50 * t317 * t43 + 0.61889338352843641011e-2 * t1141 * t1303 - 0.11581088763630920848e-3 * t323 * t341 * t51 * t698 + 0.5147150561613742599e-6 * t325 / t35 / t326 / t315 * t1499 + 0.93093776153132442719e-3 * t50 * t317 * t148 - 0.77376884737057184278e-6 * t337 * t341 * t344 * t51 + 0.1284964421503104458e-13 * t1157 * t714 * t338 - 0.93400784729439905162e-19 * t708 / t35 / t709 / t315 * t1522) - 0.11034063575830880331e0 * t2604 - 0.16551095363746320496e0 * t728 * t641 - 0.33102190727492640992e0 * t287 * t1322 + 0.33102190727492640992e0 * t530 * t1295 * t348 + t2615 + 0.22068127151661760662e0 * t2616 + 0.66204381454985281984e0 * t530 * t301 * t1321 * t152 + 0.66204381454985281984e0 * t530 * t531 * t1161 - 0.11034063575830880331e0 * t2625 + 0.66204381454985281984e0 * t1107 * t1296;
  t2633 = t560 * t560;
  t2639 = 0.7356042383887253554e-1 * t128 * t1457 * t619;
  t2640 = t1115 * t1284;
  t2642 = t1115 * t1287;
  t2644 = t287 * t1280;
  t2664 = -0.99306572182477922976e0 * t530 * t1283 * t348 + 0.66204381454985281984e0 * t128 * t302 * t2633 - t2639 - 0.66204381454985281985e0 * t2640 + 0.44136254303323521323e0 * t2642 + 0.22068127151661760662e0 * t2644 - 0.19861314436495584595e1 * t1107 * t1284 + 0.13240876290997056397e1 * t1107 * t1287 + 0.33102190727492640992e0 * t728 * t620 - 0.99306572182477922976e0 * t530 * t736 * t640 * t303 + 0.3972262887299116919e1 * t530 * t1534 * t619 * t303 - 0.3972262887299116919e1 * t530 * t1121 * t152 * t560;
  t2666 = my_piecewise3(t1, 0, t2629 + t2664);
  tv4rho2sigma20 = t6 * t2666 + 0.2e1 * t1326;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2671 = t425 * t1330;
  t2675 = 0.7356042383887253554e-1 * t196 * t1884 * t646;
  t2678 = t425 * t1335;
  t2682 = 0.36780211919436267769e-1 * t196 * t907 * t667;
  t2684 = my_piecewise3(t69, 0, 0.33102190727492640992e0 * t902 * t647 + 0.22068127151661760662e0 * t2671 - t2675 - 0.16551095363746320496e0 * t902 * t668 - 0.11034063575830880331e0 * t2678 + t2682);
  tv4rho2sigma25 = t6 * t2684 + 0.2e1 * t1339;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2688 = t400 * t1280;
  t2699 = t400 * t1292;
  t2708 = 0.33102190727492640992e0 * t852 * t620 + 0.11034063575830880331e0 * t2688 - 0.99306572182477922976e0 * t1183 * t1284 + 0.66204381454985281984e0 * t1183 * t1287 + 0.11034063575830880331e0 * t2644 - t2639 - 0.33102190727492640993e0 * t2640 + 0.22068127151661760662e0 * t2642 - 0.16551095363746320496e0 * t852 * t641 - 0.55170317879154401653e-1 * t2699 + 0.33102190727492640992e0 * t1183 * t1296 - 0.16551095363746320496e0 * t400 * t1322 - 0.55170317879154401653e-1 * t2625 + t2615 + 0.11034063575830880331e0 * t2616 - 0.55170317879154401653e-1 * t2604;
  t2709 = my_piecewise3(t1, 0, t2708);
  tv4rho2sigma26 = t6 * t2709 + t1326 + t1346;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2713 = t470 * t1330;
  t2718 = t1202 * t1351;
  t2722 = t1202 * t1354;
  t2726 = t470 * t1335;
  t2731 = t1202 * t1360;
  t2736 = t196 * t428 * t1385;
  t2738 = 0.33102190727492640992e0 * t968 * t647 + 0.11034063575830880331e0 * t2713 + 0.11034063575830880331e0 * t2671 - t2675 - 0.99306572182477922976e0 * t1199 * t1351 - 0.33102190727492640992e0 * t2718 + 0.66204381454985281984e0 * t1199 * t1354 + 0.22068127151661760661e0 * t2722 - 0.16551095363746320496e0 * t968 * t668 - 0.55170317879154401653e-1 * t2726 - 0.55170317879154401653e-1 * t2678 + t2682 + 0.33102190727492640992e0 * t1199 * t1360 + 0.11034063575830880331e0 * t2731 - 0.16551095363746320496e0 * t425 * t1386 - 0.55170317879154401653e-1 * t2736;
  t2739 = my_piecewise3(t69, 0, t2738);
  tv4rho2sigma211 = t6 * t2739 + t1339 + t1390;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2749 = my_piecewise3(t1, 0, 0.33102190727492640992e0 * t937 * t620 + 0.22068127151661760662e0 * t2688 - t2639 - 0.16551095363746320496e0 * t937 * t641 - 0.11034063575830880331e0 * t2699 + t2615);
  tv4rho2sigma212 = t6 * t2749 + 0.2e1 * t1346;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2800 = t612 * t612;
  t2814 = 0.66204381454985281984e0 * t582 * t475 * t1385 * t220 + 0.33102190727492640992e0 * t582 * t1359 * t517 - 0.16551095363746320496e0 * t196 * t199 * (-0.11266083149260159801e-1 * t50 * t491 * t88 + 0.61889338352843641011e-2 * t1251 * t1367 - 0.11581088763630920848e-3 * t323 * t510 * t92 * t1035 + 0.5147150561613742599e-6 * t497 / t80 / t498 / t489 * t2120 + 0.93093776153132442719e-3 * t50 * t491 * t216 - 0.77376884737057184278e-6 * t337 * t510 * t513 * t92 + 0.1284964421503104458e-13 * t1267 * t1051 * t507 - 0.93400784729439905162e-19 * t1045 / t80 / t1046 / t489 * t2143) - 0.16551095363746320496e0 * t1058 * t668 - 0.33102190727492640992e0 * t470 * t1386 + 0.33102190727492640992e0 * t1058 * t647 + 0.66204381454985281984e0 * t196 * t476 * t2800 + 0.66204381454985281984e0 * t582 * t583 * t1271 + 0.66204381454985281984e0 * t1224 * t1360 - 0.99306572182477922976e0 * t582 * t1350 * t517 + 0.13240876290997056397e1 * t1224 * t1354;
  t2835 = -0.19861314436495584595e1 * t1224 * t1351 - 0.11034063575830880331e0 * t2736 + 0.22068127151661760662e0 * t2713 - 0.11034063575830880331e0 * t2726 - 0.99306572182477922976e0 * t582 * t1080 * t667 * t477 + 0.3972262887299116919e1 * t582 * t2187 * t646 * t477 - 0.3972262887299116919e1 * t582 * t1231 * t220 * t612 - 0.66204381454985281985e0 * t2718 + 0.44136254303323521323e0 * t2722 + 0.22068127151661760662e0 * t2731 - t2675 + t2682;
  t2837 = my_piecewise3(t69, 0, t2814 + t2835);
  tv4rho2sigma217 = t6 * t2837 + 0.2e1 * t1390;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2843 = 0.33102190727492640992e0 * t128 * t1529 * t1392;
  t2854 = 0.33102190727492640992e0 * t1115 * t1396;
  t2869 = 0.55170317879154401653e-1 * t128 * t296 * t1413;
  t2903 = -0.99306572182477922976e0 * t287 * t1393 - t2843 + 0.3972262887299116919e1 * t530 * t1534 * t1392 * t152 - 0.29791971654743376893e1 * t530 * t1283 * t560 + 0.99306572182477922976e0 * t1107 * t1396 + t2854 - 0.29791971654743376893e1 * t530 * t1121 * t640 * t152 + 0.99306572182477922976e0 * t530 * t1125 * t640 + 0.99306572182477922976e0 * t530 * t531 * t1321 - 0.16551095363746320496e0 * t287 * t1414 - t2869 + 0.33102190727492640992e0 * t530 * t301 * t1413 * t152 - 0.16551095363746320496e0 * t128 * t131 * (-0.10006060691777115613e-2 * t1302 * t43 + 0.32427048538166578375e-4 * t323 * t555 * t28 * t32 * sigma[0] * t43 - 0.19301814606051534747e-6 * t544 / t35 / t1489 * t1499 + 0.14584124871906066146e-6 * t337 * t1312 * sigma[0] - 0.38125318000641560843e-14 * t1317 * t714 * t324 + 0.35025294273539964436e-19 * t1155 / t35 / t709 / t141 * t1522);
  t2904 = my_piecewise3(t1, 0, t2903);
  tv4rhosigma30 = t6 * t2904 + t1418;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2910 = 0.33102190727492640992e0 * t196 * t2036 * t1419;
  t2914 = 0.33102190727492640992e0 * t1202 * t1423;
  t2919 = 0.55170317879154401653e-1 * t196 * t428 * t1440;
  t2921 = my_piecewise3(t69, 0, -0.99306572182477922976e0 * t425 * t1420 - t2910 + 0.99306572182477922976e0 * t1199 * t1423 + t2914 - 0.16551095363746320496e0 * t425 * t1441 - t2919);
  tv4rhosigma39 = t6 * t2921 + t1445;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2930 = my_piecewise3(t1, 0, -0.99306572182477922976e0 * t400 * t1393 - t2843 + 0.99306572182477922976e0 * t1183 * t1396 + t2854 - 0.16551095363746320496e0 * t400 * t1414 - t2869);
  tv4rhosigma310 = t6 * t2930 + t1418;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2988 = -0.99306572182477922976e0 * t470 * t1420 - t2910 + 0.3972262887299116919e1 * t582 * t2187 * t1419 * t220 - 0.29791971654743376893e1 * t582 * t1350 * t612 + 0.99306572182477922976e0 * t1224 * t1423 + t2914 - 0.29791971654743376893e1 * t582 * t1231 * t667 * t220 + 0.99306572182477922976e0 * t582 * t1235 * t667 + 0.99306572182477922976e0 * t582 * t583 * t1385 - 0.16551095363746320496e0 * t470 * t1441 - t2919 + 0.33102190727492640992e0 * t582 * t475 * t1440 * t220 - 0.16551095363746320496e0 * t196 * t199 * (-0.10006060691777115613e-2 * t1366 * t88 + 0.32427048538166578375e-4 * t323 * t607 * t28 * t32 * sigma[2] * t88 - 0.19301814606051534747e-6 * t596 / t80 / t2110 * t2120 + 0.14584124871906066146e-6 * t337 * t1376 * sigma[2] - 0.38125318000641560843e-14 * t1381 * t1051 * t496 + 0.35025294273539964436e-19 * t1265 / t80 / t1046 / t209 * t2143);
  t2989 = my_piecewise3(t69, 0, t2988);
  tv4rhosigma319 = t6 * t2989 + t1445;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2991 = t619 * t619;
  t2998 = t640 * t640;
  t3029 = my_piecewise3(t1, 0, 0.3972262887299116919e1 * t128 * t1535 * t2991 - 0.59583943309486753786e1 * t530 * t1283 * t640 + 0.99306572182477922976e0 * t128 * t302 * t2998 + 0.13240876290997056397e1 * t530 * t531 * t1413 - 0.16551095363746320496e0 * t128 * t131 * (-0.69486532581785525089e-5 * t323 * t635 * t698 + 0.723818047726932553e-7 * t626 / t35 / t694 * t1499 + 0.95313295001603902108e-15 * t1409 * t714 * t51 - 0.13672617067411937012e-7 * t337 * t1405 - 0.13134485352577486664e-19 * t338 / t35 / t709 / t53 * t1522));
  tv4sigma40 = t6 * t3029;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t3030 = t646 * t646;
  t3037 = t667 * t667;
  t3068 = my_piecewise3(t69, 0, 0.3972262887299116919e1 * t196 * t2188 * t3030 - 0.59583943309486753786e1 * t582 * t1350 * t667 + 0.99306572182477922976e0 * t196 * t476 * t3037 + 0.13240876290997056397e1 * t582 * t583 * t1440 - 0.16551095363746320496e0 * t196 * t199 * (-0.69486532581785525089e-5 * t323 * t662 * t1035 + 0.723818047726932553e-7 * t653 / t80 / t1031 * t2120 + 0.95313295001603902108e-15 * t1436 * t1051 * t92 - 0.13672617067411937012e-7 * t337 * t1432 - 0.13134485352577486664e-19 * t507 / t80 / t1046 / t94 * t2143));
  tv4sigma414 = t6 * t3068;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

