/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : mgga_k_csk.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t41, t43, t45, t48, t53, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t73, t77;
  double t78, t79, t80, t81, t82, t83, t85, t86;
  double t87, t88, t89, t91, t93, t96, t101, t102;
  double t103, t104, t105, t106, t107, t108, t109, t110;
  double t111, t112, t113, t115, t119, tzk0;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t19 = t18 * t9;
  t20 = my_piecewise5(t12, t13, t16, t17, t19);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t38 = t33 / t36;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t45 = t38 * sigma[0] * t43;
  t48 = 0.1e1 / t41 / rho[0];
  t53 = 0.5e1 / 0.54e2 * t38 * lapl[0] * t48 - 0.5e1 / 0.81e2 * t45;
  t55 = log(0.1e1 - DBL_EPSILON);
  t56 = 0.1e1 / params->csk_a;
  t57 = pow(-t55, -t56);
  t58 = t53 < -t57;
  t59 = log(DBL_EPSILON);
  t60 = pow(-t59, -t56);
  t61 = -t60 < t53;
  t62 = my_piecewise3(t61, -t60, t53);
  t63 = -t57 < t62;
  t64 = my_piecewise3(t63, t62, -t57);
  t65 = fabs(t64);
  t66 = pow(t65, params->csk_a);
  t67 = 0.1e1 / t66;
  t68 = exp(-t67);
  t69 = 0.1e1 - t68;
  t70 = pow(t69, t56);
  t71 = my_piecewise5(t58, 0, t61, 1, t70);
  t73 = 0.1e1 + 0.5e1 / 0.72e2 * t45 + t53 * t71;
  t77 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = my_piecewise5(t16, t13, t12, t17, -t19);
  t80 = 0.1e1 + t79;
  t81 = t80 <= p->zeta_threshold;
  t82 = POW_1_3(t80);
  t83 = t82 * t82;
  t85 = my_piecewise3(t81, t25, t83 * t80);
  t86 = t85 * t31;
  t87 = rho[1] * rho[1];
  t88 = POW_1_3(rho[1]);
  t89 = t88 * t88;
  t91 = 0.1e1 / t89 / t87;
  t93 = t38 * sigma[2] * t91;
  t96 = 0.1e1 / t89 / rho[1];
  t101 = 0.5e1 / 0.54e2 * t38 * lapl[1] * t96 - 0.5e1 / 0.81e2 * t93;
  t102 = t101 < -t57;
  t103 = -t60 < t101;
  t104 = my_piecewise3(t103, -t60, t101);
  t105 = -t57 < t104;
  t106 = my_piecewise3(t105, t104, -t57);
  t107 = fabs(t106);
  t108 = pow(t107, params->csk_a);
  t109 = 0.1e1 / t108;
  t110 = exp(-t109);
  t111 = 0.1e1 - t110;
  t112 = pow(t111, t56);
  t113 = my_piecewise5(t102, 0, t103, 1, t112);
  t115 = 0.1e1 + 0.5e1 / 0.72e2 * t93 + t101 * t113;
  t119 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t115);
  tzk0 = t77 + t119;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t41, t43, t45, t48, t53, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t73, t77;
  double t78, t79, t80, t81, t82, t83, t85, t86;
  double t87, t88, t89, t91, t93, t96, t101, t102;
  double t103, t104, t105, t106, t107, t108, t109, t110;
  double t111, t112, t113, t115, t119, tzk0;

  double t120, t121, t122, t123, t124, t127, t128, t132;
  double t133, t136, t139, t141, t147, t149, t150, t151;
  double t153, t154, t156, t157, t158, t160, t162, t167;
  double t169, t172, t173, t177, t180, t182, tvrho0, t185;
  double t186, t189, t190, t195, t197, t200, t201, t207;
  double t209, t215, t217, t218, t219, t221, t222, t224;
  double t225, t226, t228, t230, t235, tvrho1, t238, t241;
  double t244, t245, t248, t250, t254, tvsigma0, tvsigma1, t255;
  double t258, t261, t262, t265, t267, t271, tvsigma2, t277;
  double t278, t281, t283, t287, tvlapl0, t293, t294, t297;
  double t299, t303, tvlapl1, tvtau0, tvtau1;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t19 = t18 * t9;
  t20 = my_piecewise5(t12, t13, t16, t17, t19);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t38 = t33 / t36;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t45 = t38 * sigma[0] * t43;
  t48 = 0.1e1 / t41 / rho[0];
  t53 = 0.5e1 / 0.54e2 * t38 * lapl[0] * t48 - 0.5e1 / 0.81e2 * t45;
  t55 = log(0.1e1 - DBL_EPSILON);
  t56 = 0.1e1 / params->csk_a;
  t57 = pow(-t55, -t56);
  t58 = t53 < -t57;
  t59 = log(DBL_EPSILON);
  t60 = pow(-t59, -t56);
  t61 = -t60 < t53;
  t62 = my_piecewise3(t61, -t60, t53);
  t63 = -t57 < t62;
  t64 = my_piecewise3(t63, t62, -t57);
  t65 = fabs(t64);
  t66 = pow(t65, params->csk_a);
  t67 = 0.1e1 / t66;
  t68 = exp(-t67);
  t69 = 0.1e1 - t68;
  t70 = pow(t69, t56);
  t71 = my_piecewise5(t58, 0, t61, 1, t70);
  t73 = 0.1e1 + 0.5e1 / 0.72e2 * t45 + t53 * t71;
  t77 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = my_piecewise5(t16, t13, t12, t17, -t19);
  t80 = 0.1e1 + t79;
  t81 = t80 <= p->zeta_threshold;
  t82 = POW_1_3(t80);
  t83 = t82 * t82;
  t85 = my_piecewise3(t81, t25, t83 * t80);
  t86 = t85 * t31;
  t87 = rho[1] * rho[1];
  t88 = POW_1_3(rho[1]);
  t89 = t88 * t88;
  t91 = 0.1e1 / t89 / t87;
  t93 = t38 * sigma[2] * t91;
  t96 = 0.1e1 / t89 / rho[1];
  t101 = 0.5e1 / 0.54e2 * t38 * lapl[1] * t96 - 0.5e1 / 0.81e2 * t93;
  t102 = t101 < -t57;
  t103 = -t60 < t101;
  t104 = my_piecewise3(t103, -t60, t101);
  t105 = -t57 < t104;
  t106 = my_piecewise3(t105, t104, -t57);
  t107 = fabs(t106);
  t108 = pow(t107, params->csk_a);
  t109 = 0.1e1 / t108;
  t110 = exp(-t109);
  t111 = 0.1e1 - t110;
  t112 = pow(t111, t56);
  t113 = my_piecewise5(t102, 0, t103, 1, t112);
  t115 = 0.1e1 + 0.5e1 / 0.72e2 * t93 + t101 * t113;
  t119 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t115);
  tzk0 = t77 + t119;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = t8 * t8;
  t121 = 0.1e1 / t120;
  t122 = t18 * t121;
  t123 = t9 - t122;
  t124 = my_piecewise5(t12, 0, t16, 0, t123);
  t127 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t124);
  t128 = t127 * t31;
  t132 = 0.1e1 / t30;
  t133 = t29 * t132;
  t136 = t7 * t133 * t73 / 0.1e2;
  t139 = 0.1e1 / t41 / t39 / rho[0];
  t141 = t38 * sigma[0] * t139;
  t147 = -0.25e2 / 0.162e3 * t38 * lapl[0] * t43 + 0.4e2 / 0.243e3 * t141;
  t149 = t70 * t67;
  t150 = my_piecewise3(t61, 0, t147);
  t151 = my_piecewise3(t63, t150, 0);
  t153 = fabs(t64) / t64;
  t154 = 0.1e1 / t65;
  t156 = 0.1e1 / t69;
  t157 = t68 * t156;
  t158 = t153 * t154 * t157;
  t160 = my_piecewise5(t58, 0, t61, 0, -t149 * t151 * t158);
  t162 = -0.5e1 / 0.27e2 * t141 + t147 * t71 + t53 * t160;
  t167 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t73 + t136 + 0.3e1 / 0.2e2 * t7 * t32 * t162);
  t169 = my_piecewise5(t16, 0, t12, 0, -t123);
  t172 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t169);
  t173 = t172 * t31;
  t177 = t85 * t132;
  t180 = t7 * t177 * t115 / 0.1e2;
  t182 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t115 + t180);
  tvrho0 = t77 + t119 + t8 * (t167 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t185 = -t9 - t122;
  t186 = my_piecewise5(t12, 0, t16, 0, t185);
  t189 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t186);
  t190 = t189 * t31;
  t195 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t73 + t136);
  t197 = my_piecewise5(t16, 0, t12, 0, -t185);
  t200 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t197);
  t201 = t200 * t31;
  t207 = 0.1e1 / t89 / t87 / rho[1];
  t209 = t38 * sigma[2] * t207;
  t215 = -0.25e2 / 0.162e3 * t38 * lapl[1] * t91 + 0.4e2 / 0.243e3 * t209;
  t217 = t112 * t109;
  t218 = my_piecewise3(t103, 0, t215);
  t219 = my_piecewise3(t105, t218, 0);
  t221 = fabs(t106) / t106;
  t222 = 0.1e1 / t107;
  t224 = 0.1e1 / t111;
  t225 = t110 * t224;
  t226 = t221 * t222 * t225;
  t228 = my_piecewise5(t102, 0, t103, 0, -t217 * t219 * t226);
  t230 = -0.5e1 / 0.27e2 * t209 + t215 * t113 + t101 * t228;
  t235 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t115 + t180 + 0.3e1 / 0.2e2 * t7 * t86 * t230);
  tvrho1 = t77 + t119 + t8 * (t195 + t235);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t238 = t38 * t43;
  t241 = t38 * t43 * t71;
  t244 = my_piecewise3(t61, 0, -0.5e1 / 0.81e2 * t238);
  t245 = my_piecewise3(t63, t244, 0);
  t248 = my_piecewise5(t58, 0, t61, 0, -t149 * t245 * t158);
  t250 = 0.5e1 / 0.72e2 * t238 - 0.5e1 / 0.81e2 * t241 + t53 * t248;
  t254 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t250);
  tvsigma0 = t8 * t254;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t255 = t38 * t91;
  t258 = t38 * t91 * t113;
  t261 = my_piecewise3(t103, 0, -0.5e1 / 0.81e2 * t255);
  t262 = my_piecewise3(t105, t261, 0);
  t265 = my_piecewise5(t102, 0, t103, 0, -t217 * t262 * t226);
  t267 = 0.5e1 / 0.72e2 * t255 - 0.5e1 / 0.81e2 * t258 + t101 * t265;
  t271 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t267);
  tvsigma2 = t8 * t271;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t277 = my_piecewise3(t61, 0, 0.5e1 / 0.54e2 * t38 * t48);
  t278 = my_piecewise3(t63, t277, 0);
  t281 = my_piecewise5(t58, 0, t61, 0, -t149 * t278 * t158);
  t283 = 0.5e1 / 0.54e2 * t38 * t48 * t71 + t53 * t281;
  t287 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t283);
  tvlapl0 = t8 * t287;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t293 = my_piecewise3(t103, 0, 0.5e1 / 0.54e2 * t38 * t96);
  t294 = my_piecewise3(t105, t293, 0);
  t297 = my_piecewise5(t102, 0, t103, 0, -t217 * t294 * t226);
  t299 = 0.5e1 / 0.54e2 * t38 * t96 * t113 + t101 * t297;
  t303 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t299);
  tvlapl1 = t8 * t303;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t41, t43, t45, t48, t53, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t73, t77;
  double t78, t79, t80, t81, t82, t83, t85, t86;
  double t87, t88, t89, t91, t93, t96, t101, t102;
  double t103, t104, t105, t106, t107, t108, t109, t110;
  double t111, t112, t113, t115, t119, tzk0;

  double t120, t121, t122, t123, t124, t127, t128, t132;
  double t133, t136, t139, t141, t147, t149, t150, t151;
  double t153, t154, t156, t157, t158, t160, t162, t167;
  double t169, t172, t173, t177, t180, t182, tvrho0, t185;
  double t186, t189, t190, t195, t197, t200, t201, t207;
  double t209, t215, t217, t218, t219, t221, t222, t224;
  double t225, t226, t228, t230, t235, tvrho1, t238, t241;
  double t244, t245, t248, t250, t254, tvsigma0, tvsigma1, t255;
  double t258, t261, t262, t265, t267, t271, tvsigma2, t277;
  double t278, t281, t283, t287, tvlapl0, t293, t294, t297;
  double t299, t303, tvlapl1, tvtau0, tvtau1;

  double t306, t307, t310, t311, t312, t314, t315, t319;
  double t320, t324, t326, t332, t333, t336, t338, t340;
  double t342, t344, t350, t354, t356, t357, t359, t360;
  double t361, t362, t363, t364, t365, t366, t367, t369;
  double t371, t372, t373, t375, t376, t379, t380, t382;
  double t383, t384, t386, t388, t389, t390, t393, t395;
  double t400, t401, t402, t406, t410, t411, t415, t417;
  double t419, t422, t424, tv2rho20, t427, t430, t431, t435;
  double t436, t440, t442, t450, t451, t454, t458, t459;
  double t463, t465, t472, t475, tv2rho21, t480, t484, t485;
  double t489, t490, t496, t497, t501, t505, t506, t515;
  double t517, t519, t525, t529, t531, t532, t534, t535;
  double t536, t537, t538, t539, t540, t541, t542, t544;
  double t546, t547, t548, t550, t551, t554, t555, t557;
  double t558, t559, t561, t563, t564, t565, t568, t570;
  double t575, tv2rho22, t583, t584, t587, t590, t593, t594;
  double t595, t596, t598, t599, t601, t604, t605, t608;
  double t610, t611, t612, t614, t616, t617, t620, t622;
  double t627, tv2rhosigma0, tv2rhosigma1, t634, t636, tv2rhosigma2, t642, tv2rhosigma3;
  double tv2rhosigma4, t647, t650, t653, t656, t657, t658, t659;
  double t661, t662, t664, t667, t668, t671, t673, t674;
  double t675, t677, t679, t680, t683, t685, t690, tv2rhosigma5;
  double t697, t703, t704, t706, t707, t710, t711, t714;
  double t716, t718, t722, t724, t729, tv2rholapl0, t736, t738;
  double tv2rholapl1, t744, tv2rholapl2, t754, t755, t757, t758, t761;
  double t762, t765, t767, t769, t773, t775, t780, tv2rholapl3;
  double tv2rhotau0, tv2rhotau1, tv2rhotau2, tv2rhotau3, t783, t785, t788, t791;
  double t792, t794, t795, t796, t798, t802, t804, t808;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t810, t812, t815;
  double t818, t819, t821, t822, t823, t825, t829, t831;
  double t835, tv2sigma25, t840, t843, t844, t846, t847, t848;
  double t849, t850, t853, t854, t857, t859, t863, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, t868, t872, t874, t875;
  double t876, t877, t878, t881, t882, t885, t887, t891;
  double tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t895;
  double t898, t901, t902, t904, t908, t910, t914, tv2lapl20;
  double tv2lapl21, t918, t921, t924, t925, t927, t931, t933;
  double t937, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21;
  double tv2tau22;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t19 = t18 * t9;
  t20 = my_piecewise5(t12, t13, t16, t17, t19);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t38 = t33 / t36;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t45 = t38 * sigma[0] * t43;
  t48 = 0.1e1 / t41 / rho[0];
  t53 = 0.5e1 / 0.54e2 * t38 * lapl[0] * t48 - 0.5e1 / 0.81e2 * t45;
  t55 = log(0.1e1 - DBL_EPSILON);
  t56 = 0.1e1 / params->csk_a;
  t57 = pow(-t55, -t56);
  t58 = t53 < -t57;
  t59 = log(DBL_EPSILON);
  t60 = pow(-t59, -t56);
  t61 = -t60 < t53;
  t62 = my_piecewise3(t61, -t60, t53);
  t63 = -t57 < t62;
  t64 = my_piecewise3(t63, t62, -t57);
  t65 = fabs(t64);
  t66 = pow(t65, params->csk_a);
  t67 = 0.1e1 / t66;
  t68 = exp(-t67);
  t69 = 0.1e1 - t68;
  t70 = pow(t69, t56);
  t71 = my_piecewise5(t58, 0, t61, 1, t70);
  t73 = 0.1e1 + 0.5e1 / 0.72e2 * t45 + t53 * t71;
  t77 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = my_piecewise5(t16, t13, t12, t17, -t19);
  t80 = 0.1e1 + t79;
  t81 = t80 <= p->zeta_threshold;
  t82 = POW_1_3(t80);
  t83 = t82 * t82;
  t85 = my_piecewise3(t81, t25, t83 * t80);
  t86 = t85 * t31;
  t87 = rho[1] * rho[1];
  t88 = POW_1_3(rho[1]);
  t89 = t88 * t88;
  t91 = 0.1e1 / t89 / t87;
  t93 = t38 * sigma[2] * t91;
  t96 = 0.1e1 / t89 / rho[1];
  t101 = 0.5e1 / 0.54e2 * t38 * lapl[1] * t96 - 0.5e1 / 0.81e2 * t93;
  t102 = t101 < -t57;
  t103 = -t60 < t101;
  t104 = my_piecewise3(t103, -t60, t101);
  t105 = -t57 < t104;
  t106 = my_piecewise3(t105, t104, -t57);
  t107 = fabs(t106);
  t108 = pow(t107, params->csk_a);
  t109 = 0.1e1 / t108;
  t110 = exp(-t109);
  t111 = 0.1e1 - t110;
  t112 = pow(t111, t56);
  t113 = my_piecewise5(t102, 0, t103, 1, t112);
  t115 = 0.1e1 + 0.5e1 / 0.72e2 * t93 + t101 * t113;
  t119 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t115);
  tzk0 = t77 + t119;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = t8 * t8;
  t121 = 0.1e1 / t120;
  t122 = t18 * t121;
  t123 = t9 - t122;
  t124 = my_piecewise5(t12, 0, t16, 0, t123);
  t127 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t124);
  t128 = t127 * t31;
  t132 = 0.1e1 / t30;
  t133 = t29 * t132;
  t136 = t7 * t133 * t73 / 0.1e2;
  t139 = 0.1e1 / t41 / t39 / rho[0];
  t141 = t38 * sigma[0] * t139;
  t147 = -0.25e2 / 0.162e3 * t38 * lapl[0] * t43 + 0.4e2 / 0.243e3 * t141;
  t149 = t70 * t67;
  t150 = my_piecewise3(t61, 0, t147);
  t151 = my_piecewise3(t63, t150, 0);
  t153 = fabs(t64) / t64;
  t154 = 0.1e1 / t65;
  t156 = 0.1e1 / t69;
  t157 = t68 * t156;
  t158 = t153 * t154 * t157;
  t160 = my_piecewise5(t58, 0, t61, 0, -t149 * t151 * t158);
  t162 = -0.5e1 / 0.27e2 * t141 + t147 * t71 + t53 * t160;
  t167 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t73 + t136 + 0.3e1 / 0.2e2 * t7 * t32 * t162);
  t169 = my_piecewise5(t16, 0, t12, 0, -t123);
  t172 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t169);
  t173 = t172 * t31;
  t177 = t85 * t132;
  t180 = t7 * t177 * t115 / 0.1e2;
  t182 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t115 + t180);
  tvrho0 = t77 + t119 + t8 * (t167 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t185 = -t9 - t122;
  t186 = my_piecewise5(t12, 0, t16, 0, t185);
  t189 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t186);
  t190 = t189 * t31;
  t195 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t73 + t136);
  t197 = my_piecewise5(t16, 0, t12, 0, -t185);
  t200 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t197);
  t201 = t200 * t31;
  t207 = 0.1e1 / t89 / t87 / rho[1];
  t209 = t38 * sigma[2] * t207;
  t215 = -0.25e2 / 0.162e3 * t38 * lapl[1] * t91 + 0.4e2 / 0.243e3 * t209;
  t217 = t112 * t109;
  t218 = my_piecewise3(t103, 0, t215);
  t219 = my_piecewise3(t105, t218, 0);
  t221 = fabs(t106) / t106;
  t222 = 0.1e1 / t107;
  t224 = 0.1e1 / t111;
  t225 = t110 * t224;
  t226 = t221 * t222 * t225;
  t228 = my_piecewise5(t102, 0, t103, 0, -t217 * t219 * t226);
  t230 = -0.5e1 / 0.27e2 * t209 + t215 * t113 + t101 * t228;
  t235 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t115 + t180 + 0.3e1 / 0.2e2 * t7 * t86 * t230);
  tvrho1 = t77 + t119 + t8 * (t195 + t235);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t238 = t38 * t43;
  t241 = t38 * t43 * t71;
  t244 = my_piecewise3(t61, 0, -0.5e1 / 0.81e2 * t238);
  t245 = my_piecewise3(t63, t244, 0);
  t248 = my_piecewise5(t58, 0, t61, 0, -t149 * t245 * t158);
  t250 = 0.5e1 / 0.72e2 * t238 - 0.5e1 / 0.81e2 * t241 + t53 * t248;
  t254 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t250);
  tvsigma0 = t8 * t254;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t255 = t38 * t91;
  t258 = t38 * t91 * t113;
  t261 = my_piecewise3(t103, 0, -0.5e1 / 0.81e2 * t255);
  t262 = my_piecewise3(t105, t261, 0);
  t265 = my_piecewise5(t102, 0, t103, 0, -t217 * t262 * t226);
  t267 = 0.5e1 / 0.72e2 * t255 - 0.5e1 / 0.81e2 * t258 + t101 * t265;
  t271 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t267);
  tvsigma2 = t8 * t271;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t277 = my_piecewise3(t61, 0, 0.5e1 / 0.54e2 * t38 * t48);
  t278 = my_piecewise3(t63, t277, 0);
  t281 = my_piecewise5(t58, 0, t61, 0, -t149 * t278 * t158);
  t283 = 0.5e1 / 0.54e2 * t38 * t48 * t71 + t53 * t281;
  t287 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t283);
  tvlapl0 = t8 * t287;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t293 = my_piecewise3(t103, 0, 0.5e1 / 0.54e2 * t38 * t96);
  t294 = my_piecewise3(t105, t293, 0);
  t297 = my_piecewise5(t102, 0, t103, 0, -t217 * t294 * t226);
  t299 = 0.5e1 / 0.54e2 * t38 * t96 * t113 + t101 * t297;
  t303 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t299);
  tvlapl1 = t8 * t303;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t306 = 0.1e1 / t26;
  t307 = t124 * t124;
  t310 = t120 * t8;
  t311 = 0.1e1 / t310;
  t312 = t18 * t311;
  t314 = -0.2e1 * t121 + 0.2e1 * t312;
  t315 = my_piecewise5(t12, 0, t16, 0, t314);
  t319 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t307 + 0.5e1 / 0.3e1 * t27 * t315);
  t320 = t319 * t31;
  t324 = t127 * t132;
  t326 = t7 * t324 * t73;
  t332 = 0.1e1 / t30 / t8;
  t333 = t29 * t332;
  t336 = t7 * t333 * t73 / 0.3e2;
  t338 = t7 * t133 * t162;
  t340 = t39 * t39;
  t342 = 0.1e1 / t41 / t340;
  t344 = t38 * sigma[0] * t342;
  t350 = 0.1e3 / 0.243e3 * t38 * lapl[0] * t139 - 0.44e3 / 0.729e3 * t344;
  t354 = t66 * t66;
  t356 = t70 / t354;
  t357 = t151 * t151;
  t359 = t153 * t153;
  t360 = t65 * t65;
  t361 = 0.1e1 / t360;
  t362 = t359 * t361;
  t363 = t68 * t68;
  t364 = t69 * t69;
  t365 = 0.1e1 / t364;
  t366 = t363 * t365;
  t367 = t362 * t366;
  t369 = t357 * t359;
  t371 = t361 * t68;
  t372 = t156 * params->csk_a;
  t373 = t371 * t372;
  t375 = my_piecewise3(t61, 0, t350);
  t376 = my_piecewise3(t63, t375, 0);
  t379 = t149 * t357;
  t380 = 0.0;
  t382 = t380 * t154 * t157;
  t383 = t379 * t382;
  t384 = t362 * t157;
  t386 = t356 * t369;
  t388 = t361 * t363;
  t389 = t365 * params->csk_a;
  t390 = t388 * t389;
  t393 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t376 + t149 * t369 * t373 + t356 * t357 * t367 - t373 * t386 + t379 * t384 - t386 * t390 - t383);
  t395 = 0.55e2 / 0.81e2 * t344 + t350 * t71 + 0.2e1 * t147 * t160 + t53 * t393;
  t400 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t73 + t326 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t162 - t336 + t338 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t395);
  t401 = 0.1e1 / t82;
  t402 = t169 * t169;
  t406 = my_piecewise5(t16, 0, t12, 0, -t314);
  t410 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t402 + 0.5e1 / 0.3e1 * t83 * t406);
  t411 = t410 * t31;
  t415 = t172 * t132;
  t417 = t7 * t415 * t115;
  t419 = t85 * t332;
  t422 = t7 * t419 * t115 / 0.3e2;
  t424 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t115 + t417 / 0.5e1 - t422);
  tv2rho20 = 0.2e1 * t167 + 0.2e1 * t182 + t8 * (t400 + t424);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t427 = t306 * t186;
  t430 = 0.2e1 * t312;
  t431 = my_piecewise5(t12, 0, t16, 0, t430);
  t435 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t427 * t124 + 0.5e1 / 0.3e1 * t27 * t431);
  t436 = t435 * t31;
  t440 = t189 * t132;
  t442 = t7 * t440 * t73;
  t450 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t73 + t442 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t162 + t326 / 0.1e2 - t336 + t338 / 0.1e2);
  t451 = t401 * t197;
  t454 = my_piecewise5(t16, 0, t12, 0, -t430);
  t458 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t451 * t169 + 0.5e1 / 0.3e1 * t83 * t454);
  t459 = t458 * t31;
  t463 = t200 * t132;
  t465 = t7 * t463 * t115;
  t472 = t7 * t177 * t230;
  t475 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t115 + t465 / 0.1e2 + t417 / 0.1e2 - t422 + 0.3e1 / 0.2e2 * t7 * t173 * t230 + t472 / 0.1e2);
  tv2rho21 = t167 + t182 + t195 + t235 + t8 * (t450 + t475);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t480 = t186 * t186;
  t484 = 0.2e1 * t121 + 0.2e1 * t312;
  t485 = my_piecewise5(t12, 0, t16, 0, t484);
  t489 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t480 + 0.5e1 / 0.3e1 * t27 * t485);
  t490 = t489 * t31;
  t496 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t73 + t442 / 0.5e1 - t336);
  t497 = t197 * t197;
  t501 = my_piecewise5(t16, 0, t12, 0, -t484);
  t505 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t497 + 0.5e1 / 0.3e1 * t83 * t501);
  t506 = t505 * t31;
  t515 = t87 * t87;
  t517 = 0.1e1 / t89 / t515;
  t519 = t38 * sigma[2] * t517;
  t525 = 0.1e3 / 0.243e3 * t38 * lapl[1] * t207 - 0.44e3 / 0.729e3 * t519;
  t529 = t108 * t108;
  t531 = t112 / t529;
  t532 = t219 * t219;
  t534 = t221 * t221;
  t535 = t107 * t107;
  t536 = 0.1e1 / t535;
  t537 = t534 * t536;
  t538 = t110 * t110;
  t539 = t111 * t111;
  t540 = 0.1e1 / t539;
  t541 = t538 * t540;
  t542 = t537 * t541;
  t544 = t532 * t534;
  t546 = t536 * t110;
  t547 = t224 * params->csk_a;
  t548 = t546 * t547;
  t550 = my_piecewise3(t103, 0, t525);
  t551 = my_piecewise3(t105, t550, 0);
  t554 = t217 * t532;
  t555 = 0.0;
  t557 = t555 * t222 * t225;
  t558 = t554 * t557;
  t559 = t537 * t225;
  t561 = t531 * t544;
  t563 = t536 * t538;
  t564 = t540 * params->csk_a;
  t565 = t563 * t564;
  t568 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t551 + t217 * t544 * t548 + t531 * t532 * t542 - t548 * t561 + t554 * t559 - t561 * t565 - t558);
  t570 = 0.55e2 / 0.81e2 * t519 + t525 * t113 + 0.2e1 * t215 * t228 + t101 * t568;
  t575 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t115 + t465 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t230 - t422 + t472 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t570);
  tv2rho22 = 0.2e1 * t195 + 0.2e1 * t235 + t8 * (t496 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t7 * t133 * t250 / 0.1e2;
  t584 = t38 * t139;
  t587 = t38 * t139 * t71;
  t590 = t38 * t43 * t160;
  t593 = t151 * t359;
  t594 = t356 * t593;
  t595 = t365 * t245;
  t596 = t388 * t595;
  t598 = t245 * t359;
  t599 = t149 * t598;
  t601 = t371 * t372 * t151;
  t604 = my_piecewise3(t61, 0, 0.4e2 / 0.243e3 * t584);
  t605 = my_piecewise3(t63, t604, 0);
  t608 = t245 * t151;
  t610 = t149 * t608 * t382;
  t611 = t156 * t151;
  t612 = t371 * t611;
  t614 = t356 * t598;
  t616 = t389 * t151;
  t617 = t388 * t616;
  t620 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t605 + t594 * t596 + t599 * t601 + t599 * t612 - t601 * t614 - t614 * t617 - t610);
  t622 = -0.5e1 / 0.27e2 * t584 + 0.4e2 / 0.243e3 * t587 - 0.5e1 / 0.81e2 * t590 + t147 * t248 + t53 * t620;
  t627 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t250 + t583 + 0.3e1 / 0.2e2 * t7 * t32 * t622);
  tv2rhosigma0 = t627 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t634 = t7 * t177 * t267 / 0.1e2;
  t636 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t267 + t634);
  tv2rhosigma2 = t636 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t642 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t250 + t583);
  tv2rhosigma3 = t642 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t647 = t38 * t207;
  t650 = t38 * t207 * t113;
  t653 = t38 * t91 * t228;
  t656 = t219 * t534;
  t657 = t531 * t656;
  t658 = t540 * t262;
  t659 = t563 * t658;
  t661 = t262 * t534;
  t662 = t217 * t661;
  t664 = t546 * t547 * t219;
  t667 = my_piecewise3(t103, 0, 0.4e2 / 0.243e3 * t647);
  t668 = my_piecewise3(t105, t667, 0);
  t671 = t262 * t219;
  t673 = t217 * t671 * t557;
  t674 = t224 * t219;
  t675 = t546 * t674;
  t677 = t531 * t661;
  t679 = t564 * t219;
  t680 = t563 * t679;
  t683 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t668 + t657 * t659 + t662 * t664 + t662 * t675 - t664 * t677 - t677 * t680 - t673);
  t685 = -0.5e1 / 0.27e2 * t647 + 0.4e2 / 0.243e3 * t650 - 0.5e1 / 0.81e2 * t653 + t215 * t265 + t101 * t683;
  t690 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t267 + t634 + 0.3e1 / 0.2e2 * t7 * t86 * t685);
  tv2rhosigma5 = t690 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t697 = t7 * t133 * t283 / 0.1e2;
  t703 = t365 * t278;
  t704 = t388 * t703;
  t706 = t278 * t359;
  t707 = t149 * t706;
  t710 = my_piecewise3(t61, 0, -0.25e2 / 0.162e3 * t238);
  t711 = my_piecewise3(t63, t710, 0);
  t714 = t278 * t151;
  t716 = t149 * t714 * t382;
  t718 = t356 * t706;
  t722 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t711 + t594 * t704 + t601 * t707 - t601 * t718 + t612 * t707 - t617 * t718 - t716);
  t724 = -0.25e2 / 0.162e3 * t241 + 0.5e1 / 0.54e2 * t38 * t48 * t160 + t147 * t281 + t53 * t722;
  t729 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t283 + t697 + 0.3e1 / 0.2e2 * t7 * t32 * t724);
  tv2rholapl0 = t729 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t736 = t7 * t177 * t299 / 0.1e2;
  t738 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t299 + t736);
  tv2rholapl1 = t738 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  t744 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t283 + t697);
  tv2rholapl2 = t744 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  t754 = t540 * t294;
  t755 = t563 * t754;
  t757 = t294 * t534;
  t758 = t217 * t757;
  t761 = my_piecewise3(t103, 0, -0.25e2 / 0.162e3 * t255);
  t762 = my_piecewise3(t105, t761, 0);
  t765 = t294 * t219;
  t767 = t217 * t765 * t557;
  t769 = t531 * t757;
  t773 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t762 + t657 * t755 + t664 * t758 - t664 * t769 + t675 * t758 - t680 * t769 - t767);
  t775 = -0.25e2 / 0.162e3 * t258 + 0.5e1 / 0.54e2 * t38 * t96 * t228 + t215 * t297 + t101 * t773;
  t780 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t299 + t736 + 0.3e1 / 0.2e2 * t7 * t86 * t775);
  tv2rholapl3 = t780 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t783 = t38 * t43 * t248;
  t785 = t245 * t245;
  t788 = t785 * t359;
  t791 = my_piecewise3(t61, 0, 0);
  t792 = my_piecewise3(t63, t791, 0);
  t794 = t149 * t792 * t158;
  t795 = t149 * t785;
  t796 = t795 * t382;
  t798 = t356 * t788;
  t802 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t788 + t356 * t367 * t785 - t373 * t798 + t384 * t795 - t390 * t798 - t794 - t796);
  t804 = -0.1e2 / 0.81e2 * t783 + t53 * t802;
  t808 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t804);
  tv2sigma20 = t8 * t808;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t810 = t38 * t91 * t265;
  t812 = t262 * t262;
  t815 = t812 * t534;
  t818 = my_piecewise3(t103, 0, 0);
  t819 = my_piecewise3(t105, t818, 0);
  t821 = t217 * t819 * t226;
  t822 = t217 * t812;
  t823 = t822 * t557;
  t825 = t531 * t815;
  t829 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t815 + t531 * t542 * t812 - t548 * t825 + t559 * t822 - t565 * t825 - t821 - t823);
  t831 = -0.1e2 / 0.81e2 * t810 + t101 * t829;
  t835 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t831);
  tv2sigma25 = t8 * t835;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t840 = t38 * t43 * t281;
  t843 = t372 * t245;
  t844 = t371 * t843;
  t846 = t278 * t245;
  t847 = t149 * t846;
  t848 = t847 * t382;
  t849 = t156 * t245;
  t850 = t371 * t849;
  t853 = t389 * t245;
  t854 = t388 * t853;
  t857 = my_piecewise5(t58, 0, t61, 0, t614 * t704 + t707 * t844 + t707 * t850 - t718 * t844 - t718 * t854 - t794 - t848);
  t859 = 0.5e1 / 0.54e2 * t38 * t48 * t248 - 0.5e1 / 0.81e2 * t840 + t53 * t857;
  t863 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t859);
  tv2sigmalapl0 = t8 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  t868 = t38 * t91 * t297;
  t872 = t546 * t547 * t262;
  t874 = t294 * t262;
  t875 = t217 * t874;
  t876 = t875 * t557;
  t877 = t224 * t262;
  t878 = t546 * t877;
  t881 = t564 * t262;
  t882 = t563 * t881;
  t885 = my_piecewise5(t102, 0, t103, 0, t677 * t755 + t758 * t872 + t758 * t878 - t769 * t872 - t769 * t882 - t821 - t876);
  t887 = 0.5e1 / 0.54e2 * t38 * t96 * t265 - 0.5e1 / 0.81e2 * t868 + t101 * t885;
  t891 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t887);
  tv2sigmalapl5 = t8 * t891;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  t895 = t278 * t278;
  t898 = t895 * t359;
  t901 = t149 * t895;
  t902 = t901 * t382;
  t904 = t356 * t898;
  t908 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t898 + t356 * t367 * t895 - t373 * t904 + t384 * t901 - t390 * t904 - t794 - t902);
  t910 = 0.5e1 / 0.27e2 * t38 * t48 * t281 + t53 * t908;
  t914 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t910);
  tv2lapl20 = t8 * t914;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  t918 = t294 * t294;
  t921 = t918 * t534;
  t924 = t217 * t918;
  t925 = t924 * t557;
  t927 = t531 * t921;
  t931 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t921 + t531 * t542 * t918 - t548 * t927 + t559 * t924 - t565 * t927 - t821 - t925);
  t933 = 0.5e1 / 0.27e2 * t38 * t96 * t297 + t101 * t931;
  t937 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t933);
  tv2lapl22 = t8 * t937;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t41, t43, t45, t48, t53, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t73, t77;
  double t78, t79, t80, t81, t82, t83, t85, t86;
  double t87, t88, t89, t91, t93, t96, t101, t102;
  double t103, t104, t105, t106, t107, t108, t109, t110;
  double t111, t112, t113, t115, t119, tzk0;

  double t120, t121, t122, t123, t124, t127, t128, t132;
  double t133, t136, t139, t141, t147, t149, t150, t151;
  double t153, t154, t156, t157, t158, t160, t162, t167;
  double t169, t172, t173, t177, t180, t182, tvrho0, t185;
  double t186, t189, t190, t195, t197, t200, t201, t207;
  double t209, t215, t217, t218, t219, t221, t222, t224;
  double t225, t226, t228, t230, t235, tvrho1, t238, t241;
  double t244, t245, t248, t250, t254, tvsigma0, tvsigma1, t255;
  double t258, t261, t262, t265, t267, t271, tvsigma2, t277;
  double t278, t281, t283, t287, tvlapl0, t293, t294, t297;
  double t299, t303, tvlapl1, tvtau0, tvtau1;

  double t306, t307, t310, t311, t312, t314, t315, t319;
  double t320, t324, t326, t332, t333, t336, t338, t340;
  double t342, t344, t350, t354, t356, t357, t359, t360;
  double t361, t362, t363, t364, t365, t366, t367, t369;
  double t371, t372, t373, t375, t376, t379, t380, t382;
  double t383, t384, t386, t388, t389, t390, t393, t395;
  double t400, t401, t402, t406, t410, t411, t415, t417;
  double t419, t422, t424, tv2rho20, t427, t430, t431, t435;
  double t436, t440, t442, t450, t451, t454, t458, t459;
  double t463, t465, t472, t475, tv2rho21, t480, t484, t485;
  double t489, t490, t496, t497, t501, t505, t506, t515;
  double t517, t519, t525, t529, t531, t532, t534, t535;
  double t536, t537, t538, t539, t540, t541, t542, t544;
  double t546, t547, t548, t550, t551, t554, t555, t557;
  double t558, t559, t561, t563, t564, t565, t568, t570;
  double t575, tv2rho22, t583, t584, t587, t590, t593, t594;
  double t595, t596, t598, t599, t601, t604, t605, t608;
  double t610, t611, t612, t614, t616, t617, t620, t622;
  double t627, tv2rhosigma0, tv2rhosigma1, t634, t636, tv2rhosigma2, t642, tv2rhosigma3;
  double tv2rhosigma4, t647, t650, t653, t656, t657, t658, t659;
  double t661, t662, t664, t667, t668, t671, t673, t674;
  double t675, t677, t679, t680, t683, t685, t690, tv2rhosigma5;
  double t697, t703, t704, t706, t707, t710, t711, t714;
  double t716, t718, t722, t724, t729, tv2rholapl0, t736, t738;
  double tv2rholapl1, t744, tv2rholapl2, t754, t755, t757, t758, t761;
  double t762, t765, t767, t769, t773, t775, t780, tv2rholapl3;
  double tv2rhotau0, tv2rhotau1, tv2rhotau2, tv2rhotau3, t783, t785, t788, t791;
  double t792, t794, t795, t796, t798, t802, t804, t808;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t810, t812, t815;
  double t818, t819, t821, t822, t823, t825, t829, t831;
  double t835, tv2sigma25, t840, t843, t844, t846, t847, t848;
  double t849, t850, t853, t854, t857, t859, t863, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, t868, t872, t874, t875;
  double t876, t877, t878, t881, t882, t885, t887, t891;
  double tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t895;
  double t898, t901, t902, t904, t908, t910, t914, tv2lapl20;
  double tv2lapl21, t918, t921, t924, t925, t927, t931, t933;
  double t937, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21;
  double tv2tau22;

  double t941, t942, t945, t948, t949, t950, t952, t953;
  double t957, t958, t962, t964, t969, t971, t974, t980;
  double t981, t984, t986, t989, t993, t995, t1001, t1007;
  double t1011, t1012, t1014, t1015, t1016, t1020, t1021, t1022;
  double t1023, t1025, t1026, t1027, t1030, t1031, t1032, t1033;
  double t1034, t1036, t1040, t1041, t1043, t1044, t1045, t1048;
  double t1049, t1054, t1058, t1062, t1063, t1066, t1067, t1070;
  double t1073, t1075, t1076, t1077, t1080, t1081, t1084, t1087;
  double t1089, t1090, t1094, t1096, t1097, t1098, t1101, t1102;
  double t1103, t1106, t1107, t1108, t1110, t1111, t1115, t1119;
  double t1122, t1124, t1126, t1131, t1133, t1134, t1137, t1141;
  double t1145, t1146, t1150, t1152, t1154, t1156, t1158, t1161;
  double t1163, tv3rho30, t1166, t1167, t1168, t1171, t1176, t1177;
  double t1178, t1179, t1183, t1184, t1188, t1191, t1195, t1197;
  double t1201, t1210, t1211, t1212, t1215, t1221, t1225, t1226;
  double t1230, t1233, t1234, t1236, t1245, t1247, t1250, tv3rho31;
  double t1253, t1258, t1261, t1262, t1266, t1267, t1271, t1273;
  double t1282, t1283, t1288, t1292, t1296, t1297, t1301, t1303;
  double t1310, t1318, t1320, t1321, tv3rho32, t1326, t1332, t1333;
  double t1337, t1338, t1345, t1346, t1352, t1356, t1357, t1374;
  double t1376, t1382, t1390, t1391, t1392, t1393, t1394, t1396;
  double t1397, t1398, t1401, t1402, t1403, t1404, t1406, t1410;
  double t1411, t1414, t1415, t1417, t1418, t1419, t1422, t1426;
  double t1427, t1432, t1434, t1436, t1437, t1442, t1446, t1447;
  double t1449, t1450, t1451, t1453, t1455, t1456, t1457, t1459;
  double t1461, t1462, t1464, t1467, t1469, t1470, t1471, t1474;
  double t1475, t1476, t1480, t1486, t1487, t1488, t1490, t1491;
  double t1495, t1499, t1502, t1504, t1506, t1511, tv3rho33, t1519;
  double t1526, t1528, t1530, t1533, t1536, t1539, t1546, t1548;
  double t1550, t1551, t1552, t1555, t1556, t1559, t1560, t1561;
  double t1564, t1565, t1568, t1569, t1570, t1571, t1574, t1575;
  double t1578, t1581, t1582, t1584, t1585, t1587, t1591, t1594;
  double t1597, t1601, t1602, t1603, t1604, t1606, t1609, t1610;
  double t1616, t1617, t1620, t1621, t1623, t1624, t1627, t1628;
  double t1636, t1637, t1638, t1640, t1642, t1643, t1644, t1645;
  double t1646, t1647, t1648, t1651, t1652, t1655, t1657, t1659;
  double t1664, tv3rho2sigma0, tv3rho2sigma1, t1671, t1675, t1677, tv3rho2sigma2, t1683;
  double t1691, tv3rho2sigma3, tv3rho2sigma4, t1697, t1704, t1707, tv3rho2sigma5, t1715;
  double tv3rho2sigma6, tv3rho2sigma7, t1726, t1729, t1732, t1735, t1741, t1742;
  double t1745, t1746, t1747, t1750, t1751, t1754, t1755, t1756;
  double t1757, t1760, t1761, t1766, t1768, t1770, t1771, t1772;
  double t1775, t1778, t1779, t1781, t1784, t1787, t1788, t1791;
  double t1792, t1796, t1797, t1798, t1799, t1801, t1804, t1805;
  double t1809, t1810, t1812, t1813, t1816, t1817, t1818, t1826;
  double t1827, t1832, t1833, t1834, t1836, t1838, t1839, t1840;
  double t1841, t1842, t1843, t1844, t1847, t1848, t1851, t1853;
  double t1855, t1860, tv3rho2sigma8, t1867, t1874, t1876, t1886, t1888;
  double t1890, t1892, t1895, t1896, t1899, t1900, t1902, t1905;
  double t1906, t1909, t1910, t1913, t1916, t1918, t1919, t1925;
  double t1928, t1929, t1930, t1931, t1933, t1935, t1947, t1948;
  double t1956, t1957, t1958, t1960, t1963, t1964, t1965, t1968;
  double t1969, t1972, t1974, t1976, t1981, tv3rho2lapl0, t1988, t1992;
  double t1994, tv3rho2lapl1, t2000, t2008, tv3rho2lapl2, t2014, t2021, t2024;
  double tv3rho2lapl3, t2032, tv3rho2lapl4, t2051, t2053, t2055, t2057, t2058;
  double t2059, t2062, t2065, t2066, t2071, t2072, t2075, t2076;
  double t2079, t2080, t2084, t2087, t2090, t2095, t2098, t2100;
  double t2102, t2103, t2104, t2115, t2116, t2121, t2122, t2123;
  double t2125, t2128, t2129, t2130, t2133, t2134, t2137, t2139;
  double t2141, t2146, tv3rho2lapl5, tv3rho2tau0, tv3rho2tau1, tv3rho2tau2, tv3rho2tau3, tv3rho2tau4;
  double tv3rho2tau5, t2153, t2155, t2158, t2161, t2162, t2163, t2164;
  double t2165, t2166, t2169, t2170, t2171, t2174, t2175, t2180;
  double t2181, t2182, t2183, t2185, t2186, t2187, t2188, t2190;
  double t2191, t2192, t2193, t2195, t2196, t2197, t2198, t2199;
  double t2201, t2202, t2207, t2208, t2209, t2212, t2213, t2216;
  double t2217, t2218, t2219, t2221, t2222, t2224, t2225, t2230;
  double t2231, t2234, t2235, t2236, t2237, t2238, t2240, t2241;
  double t2246, t2249, t2250, t2256, t2257, t2258, t2259, t2262;
  double t2263, t2264, t2265, t2267, t2268, t2269, t2271, t2273;
  double t2275, t2280, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2287;
  double t2289, tv3rhosigma25, t2295, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2301, t2304, t2307, t2308, t2309, t2310, t2312, t2313;
  double t2314, t2315, t2316, t2318, t2319, t2320, t2325, t2326;
  double t2327, t2328, t2331, t2332, t2333, t2334, t2335, t2338;
  double t2339, t2340, t2341, t2343, t2344, t2345, t2347, t2348;
  double t2353, t2354, t2355, t2358, t2359, t2362, t2363, t2366;
  double t2367, t2368, t2369, t2370, t2371, t2373, t2374, t2377;
  double t2378, t2383, t2384, t2385, t2387, t2388, t2392, t2395;
  double t2396, t2402, t2403, t2404, t2405, t2408, t2409, t2410;
  double t2411, t2413, t2414, t2415, t2417, t2419, t2421, t2426;
  double tv3rhosigma211, t2433, t2439, t2442, t2447, t2449, t2450, t2452;
  double t2455, t2456, t2458, t2460, t2461, t2462, t2463, t2464;
  double t2467, t2468, t2476, t2477, t2478, t2480, t2481, t2484;
  double t2485, t2488, t2489, t2490, t2491, t2492, t2495, t2496;
  double t2498, t2499, t2500, t2501, t2504, t2505, t2506, t2507;
  double t2508, t2511, t2515, t2521, t2524, t2525, t2526, t2527;
  double t2529, t2532, t2534, t2536, t2541, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2;
  double tv3rhosigmalapl3, tv3rhosigmalapl4, t2548, t2550, tv3rhosigmalapl5, t2556, tv3rhosigmalapl6, tv3rhosigmalapl7;
  double tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, t2566, t2569, t2576, t2578, t2579;
  double t2581, t2582, t2583, t2585, t2586, t2588, t2589, t2591;
  double t2593, t2594, t2595, t2600, t2601, t2605, t2608, t2611;
  double t2612, t2615, t2616, t2617, t2618, t2619, t2622, t2623;
  double t2624, t2626, t2629, t2630, t2631, t2632, t2633, t2636;
  double t2640, t2643, t2646, t2647, t2648, t2649, t2651, t2656;
  double t2657, t2659, t2661, t2663, t2668, tv3rhosigmalapl11, tv3rhosigmatau0, tv3rhosigmatau1;
  double tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4, tv3rhosigmatau5, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9;
  double tv3rhosigmatau10, tv3rhosigmatau11, t2675, t2681, t2682, t2683, t2685, t2686;
  double t2692, t2693, t2695, t2696, t2699, t2702, t2715, t2716;
  double t2722, t2723, t2724, t2729, t2734, t2735, t2736, t2741;
  double t2742, t2744, t2747, t2748, t2750, t2752, t2754, t2759;
  double tv3rholapl20, tv3rholapl21, t2766, t2768, tv3rholapl22, t2774, tv3rholapl23, tv3rholapl24;
  double t2784, t2785, t2786, t2788, t2789, t2793, t2794, t2797;
  double t2802, t2803, t2808, t2818, t2819, t2820, t2825, t2826;
  double t2827, t2833, t2837, t2838, t2839, t2844, t2845, t2847;
  double t2850, t2851, t2853, t2855, t2857, t2862, tv3rholapl25, tv3rholapltau0;
  double tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rhotau20;
  double tv3rhotau21, tv3rhotau22, tv3rhotau23, tv3rhotau24, tv3rhotau25, t2865, t2867, t2868;
  double t2869, t2870, t2872, t2873, t2874, t2875, t2878, t2882;
  double t2888, t2890, t2891, t2896, t2897, t2900, t2903, t2905;
  double t2906, t2907, t2908, t2909, t2910, t2911, t2913, t2914;
  double t2915, t2916, t2917, t2918, t2919, t2920, t2921, t2922;
  double t2931, t2933, t2935, t2939, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2941, t2943, t2944;
  double t2945, t2948, t2952, t2959, t2960, t2965, t2967, t2968;
  double t2969, t2971, t2972, t2973, t2974, t2975, t2976, t2977;
  double t2978, t2979, t2984, t2985, t2986, t2987, t2988, t2989;
  double t2990, t2991, t2992, t2993, t2994, t2995, t2996, t2997;
  double t2998, t3007, t3009, t3011, t3015, tv3sigma39, t3020, t3024;
  double t3025, t3028, t3029, t3030, t3031, t3033, t3035, t3036;
  double t3037, t3038, t3040, t3041, t3045, t3046, t3047, t3048;
  double t3049, t3050, t3051, t3052, t3053, t3054, t3055, t3058;
  double t3059, t3060, t3061, t3064, t3069, t3074, t3078, t3079;
  double t3080, t3081, t3082, t3083, t3084, t3085, t3086, t3087;
  double t3088, t3089, t3090, t3091, t3093, t3095, t3099, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, t3104, t3107, t3108, t3113, t3115, t3116;
  double t3117, t3118, t3119, t3120, t3121, t3122, t3123, t3124;
  double t3125, t3126, t3127, t3132, t3133, t3134, t3139, t3140;
  double t3141, t3146, t3147, t3148, t3149, t3150, t3151, t3154;
  double t3159, t3162, t3163, t3164, t3165, t3166, t3167, t3168;
  double t3169, t3170, t3171, t3172, t3173, t3174, t3175, t3176;
  double t3178, t3180, t3184, tv3sigma2lapl11, tv3sigma2tau0, tv3sigma2tau1, tv3sigma2tau2, tv3sigma2tau3;
  double tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9, tv3sigma2tau10, tv3sigma2tau11;
  double t3189, t3197, t3198, t3199, t3200, t3201, t3204, t3205;
  double t3206, t3207, t3209, t3210, t3211, t3213, t3214, t3215;
  double t3217, t3218, t3219, t3220, t3226, t3227, t3232, t3233;
  double t3236, t3240, t3241, t3248, t3250, t3252, t3256, tv3sigmalapl20;
  double tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26, tv3sigmalapl27, t3261;
  double t3269, t3270, t3271, t3272, t3273, t3274, t3275, t3276;
  double t3277, t3278, t3279, t3280, t3282, t3283, t3285, t3286;
  double t3289, t3290, t3296, t3297, t3300, t3301, t3306, t3307;
  double t3310, t3314, t3315, t3320, t3322, t3324, t3328, tv3sigmalapl28;
  double tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5, tv3sigmalapltau6, tv3sigmalapltau7;
  double tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmatau20, tv3sigmatau21, tv3sigmatau22, tv3sigmatau23;
  double tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, tv3sigmatau28, t3332, t3333, t3334;
  double t3338, t3340, t3353, t3354, t3355, t3356, t3357, t3359;
  double t3360, t3363, t3364, t3365, t3366, t3367, t3368, t3369;
  double t3378, t3379, t3380, t3381, t3382, t3384, t3385, t3386;
  double t3388, t3390, t3394, tv3lapl30, tv3lapl31, tv3lapl32, t3398, t3399;
  double t3400, t3403, t3412, t3414, t3415, t3416, t3417, t3418;
  double t3419, t3420, t3429, t3430, t3431, t3432, t3433, t3434;
  double t3435, t3445, t3446, t3447, t3448, t3449, t3450, t3451;
  double t3452, t3454, t3456, t3460, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2;
  double tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20, tv3lapltau21, tv3lapltau22, tv3lapltau23, tv3lapltau24;
  double tv3lapltau25, tv3tau30, tv3tau31, tv3tau32, tv3tau33;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t19 = t18 * t9;
  t20 = my_piecewise5(t12, t13, t16, t17, t19);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t38 = t33 / t36;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t45 = t38 * sigma[0] * t43;
  t48 = 0.1e1 / t41 / rho[0];
  t53 = 0.5e1 / 0.54e2 * t38 * lapl[0] * t48 - 0.5e1 / 0.81e2 * t45;
  t55 = log(0.1e1 - DBL_EPSILON);
  t56 = 0.1e1 / params->csk_a;
  t57 = pow(-t55, -t56);
  t58 = t53 < -t57;
  t59 = log(DBL_EPSILON);
  t60 = pow(-t59, -t56);
  t61 = -t60 < t53;
  t62 = my_piecewise3(t61, -t60, t53);
  t63 = -t57 < t62;
  t64 = my_piecewise3(t63, t62, -t57);
  t65 = fabs(t64);
  t66 = pow(t65, params->csk_a);
  t67 = 0.1e1 / t66;
  t68 = exp(-t67);
  t69 = 0.1e1 - t68;
  t70 = pow(t69, t56);
  t71 = my_piecewise5(t58, 0, t61, 1, t70);
  t73 = 0.1e1 + 0.5e1 / 0.72e2 * t45 + t53 * t71;
  t77 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = my_piecewise5(t16, t13, t12, t17, -t19);
  t80 = 0.1e1 + t79;
  t81 = t80 <= p->zeta_threshold;
  t82 = POW_1_3(t80);
  t83 = t82 * t82;
  t85 = my_piecewise3(t81, t25, t83 * t80);
  t86 = t85 * t31;
  t87 = rho[1] * rho[1];
  t88 = POW_1_3(rho[1]);
  t89 = t88 * t88;
  t91 = 0.1e1 / t89 / t87;
  t93 = t38 * sigma[2] * t91;
  t96 = 0.1e1 / t89 / rho[1];
  t101 = 0.5e1 / 0.54e2 * t38 * lapl[1] * t96 - 0.5e1 / 0.81e2 * t93;
  t102 = t101 < -t57;
  t103 = -t60 < t101;
  t104 = my_piecewise3(t103, -t60, t101);
  t105 = -t57 < t104;
  t106 = my_piecewise3(t105, t104, -t57);
  t107 = fabs(t106);
  t108 = pow(t107, params->csk_a);
  t109 = 0.1e1 / t108;
  t110 = exp(-t109);
  t111 = 0.1e1 - t110;
  t112 = pow(t111, t56);
  t113 = my_piecewise5(t102, 0, t103, 1, t112);
  t115 = 0.1e1 + 0.5e1 / 0.72e2 * t93 + t101 * t113;
  t119 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t115);
  tzk0 = t77 + t119;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = t8 * t8;
  t121 = 0.1e1 / t120;
  t122 = t18 * t121;
  t123 = t9 - t122;
  t124 = my_piecewise5(t12, 0, t16, 0, t123);
  t127 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t124);
  t128 = t127 * t31;
  t132 = 0.1e1 / t30;
  t133 = t29 * t132;
  t136 = t7 * t133 * t73 / 0.1e2;
  t139 = 0.1e1 / t41 / t39 / rho[0];
  t141 = t38 * sigma[0] * t139;
  t147 = -0.25e2 / 0.162e3 * t38 * lapl[0] * t43 + 0.4e2 / 0.243e3 * t141;
  t149 = t70 * t67;
  t150 = my_piecewise3(t61, 0, t147);
  t151 = my_piecewise3(t63, t150, 0);
  t153 = fabs(t64) / t64;
  t154 = 0.1e1 / t65;
  t156 = 0.1e1 / t69;
  t157 = t68 * t156;
  t158 = t153 * t154 * t157;
  t160 = my_piecewise5(t58, 0, t61, 0, -t149 * t151 * t158);
  t162 = -0.5e1 / 0.27e2 * t141 + t147 * t71 + t53 * t160;
  t167 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t73 + t136 + 0.3e1 / 0.2e2 * t7 * t32 * t162);
  t169 = my_piecewise5(t16, 0, t12, 0, -t123);
  t172 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t169);
  t173 = t172 * t31;
  t177 = t85 * t132;
  t180 = t7 * t177 * t115 / 0.1e2;
  t182 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t115 + t180);
  tvrho0 = t77 + t119 + t8 * (t167 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t185 = -t9 - t122;
  t186 = my_piecewise5(t12, 0, t16, 0, t185);
  t189 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t186);
  t190 = t189 * t31;
  t195 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t73 + t136);
  t197 = my_piecewise5(t16, 0, t12, 0, -t185);
  t200 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t197);
  t201 = t200 * t31;
  t207 = 0.1e1 / t89 / t87 / rho[1];
  t209 = t38 * sigma[2] * t207;
  t215 = -0.25e2 / 0.162e3 * t38 * lapl[1] * t91 + 0.4e2 / 0.243e3 * t209;
  t217 = t112 * t109;
  t218 = my_piecewise3(t103, 0, t215);
  t219 = my_piecewise3(t105, t218, 0);
  t221 = fabs(t106) / t106;
  t222 = 0.1e1 / t107;
  t224 = 0.1e1 / t111;
  t225 = t110 * t224;
  t226 = t221 * t222 * t225;
  t228 = my_piecewise5(t102, 0, t103, 0, -t217 * t219 * t226);
  t230 = -0.5e1 / 0.27e2 * t209 + t215 * t113 + t101 * t228;
  t235 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t115 + t180 + 0.3e1 / 0.2e2 * t7 * t86 * t230);
  tvrho1 = t77 + t119 + t8 * (t195 + t235);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t238 = t38 * t43;
  t241 = t38 * t43 * t71;
  t244 = my_piecewise3(t61, 0, -0.5e1 / 0.81e2 * t238);
  t245 = my_piecewise3(t63, t244, 0);
  t248 = my_piecewise5(t58, 0, t61, 0, -t149 * t245 * t158);
  t250 = 0.5e1 / 0.72e2 * t238 - 0.5e1 / 0.81e2 * t241 + t53 * t248;
  t254 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t250);
  tvsigma0 = t8 * t254;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t255 = t38 * t91;
  t258 = t38 * t91 * t113;
  t261 = my_piecewise3(t103, 0, -0.5e1 / 0.81e2 * t255);
  t262 = my_piecewise3(t105, t261, 0);
  t265 = my_piecewise5(t102, 0, t103, 0, -t217 * t262 * t226);
  t267 = 0.5e1 / 0.72e2 * t255 - 0.5e1 / 0.81e2 * t258 + t101 * t265;
  t271 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t267);
  tvsigma2 = t8 * t271;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t277 = my_piecewise3(t61, 0, 0.5e1 / 0.54e2 * t38 * t48);
  t278 = my_piecewise3(t63, t277, 0);
  t281 = my_piecewise5(t58, 0, t61, 0, -t149 * t278 * t158);
  t283 = 0.5e1 / 0.54e2 * t38 * t48 * t71 + t53 * t281;
  t287 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t283);
  tvlapl0 = t8 * t287;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t293 = my_piecewise3(t103, 0, 0.5e1 / 0.54e2 * t38 * t96);
  t294 = my_piecewise3(t105, t293, 0);
  t297 = my_piecewise5(t102, 0, t103, 0, -t217 * t294 * t226);
  t299 = 0.5e1 / 0.54e2 * t38 * t96 * t113 + t101 * t297;
  t303 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t299);
  tvlapl1 = t8 * t303;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t306 = 0.1e1 / t26;
  t307 = t124 * t124;
  t310 = t120 * t8;
  t311 = 0.1e1 / t310;
  t312 = t18 * t311;
  t314 = -0.2e1 * t121 + 0.2e1 * t312;
  t315 = my_piecewise5(t12, 0, t16, 0, t314);
  t319 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t307 + 0.5e1 / 0.3e1 * t27 * t315);
  t320 = t319 * t31;
  t324 = t127 * t132;
  t326 = t7 * t324 * t73;
  t332 = 0.1e1 / t30 / t8;
  t333 = t29 * t332;
  t336 = t7 * t333 * t73 / 0.3e2;
  t338 = t7 * t133 * t162;
  t340 = t39 * t39;
  t342 = 0.1e1 / t41 / t340;
  t344 = t38 * sigma[0] * t342;
  t350 = 0.1e3 / 0.243e3 * t38 * lapl[0] * t139 - 0.44e3 / 0.729e3 * t344;
  t354 = t66 * t66;
  t356 = t70 / t354;
  t357 = t151 * t151;
  t359 = t153 * t153;
  t360 = t65 * t65;
  t361 = 0.1e1 / t360;
  t362 = t359 * t361;
  t363 = t68 * t68;
  t364 = t69 * t69;
  t365 = 0.1e1 / t364;
  t366 = t363 * t365;
  t367 = t362 * t366;
  t369 = t357 * t359;
  t371 = t361 * t68;
  t372 = t156 * params->csk_a;
  t373 = t371 * t372;
  t375 = my_piecewise3(t61, 0, t350);
  t376 = my_piecewise3(t63, t375, 0);
  t379 = t149 * t357;
  t380 = 0.0;
  t382 = t380 * t154 * t157;
  t383 = t379 * t382;
  t384 = t362 * t157;
  t386 = t356 * t369;
  t388 = t361 * t363;
  t389 = t365 * params->csk_a;
  t390 = t388 * t389;
  t393 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t376 + t149 * t369 * t373 + t356 * t357 * t367 - t373 * t386 + t379 * t384 - t386 * t390 - t383);
  t395 = 0.55e2 / 0.81e2 * t344 + t350 * t71 + 0.2e1 * t147 * t160 + t53 * t393;
  t400 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t73 + t326 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t162 - t336 + t338 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t395);
  t401 = 0.1e1 / t82;
  t402 = t169 * t169;
  t406 = my_piecewise5(t16, 0, t12, 0, -t314);
  t410 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t402 + 0.5e1 / 0.3e1 * t83 * t406);
  t411 = t410 * t31;
  t415 = t172 * t132;
  t417 = t7 * t415 * t115;
  t419 = t85 * t332;
  t422 = t7 * t419 * t115 / 0.3e2;
  t424 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t115 + t417 / 0.5e1 - t422);
  tv2rho20 = 0.2e1 * t167 + 0.2e1 * t182 + t8 * (t400 + t424);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t427 = t306 * t186;
  t430 = 0.2e1 * t312;
  t431 = my_piecewise5(t12, 0, t16, 0, t430);
  t435 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t427 * t124 + 0.5e1 / 0.3e1 * t27 * t431);
  t436 = t435 * t31;
  t440 = t189 * t132;
  t442 = t7 * t440 * t73;
  t450 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t73 + t442 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t162 + t326 / 0.1e2 - t336 + t338 / 0.1e2);
  t451 = t401 * t197;
  t454 = my_piecewise5(t16, 0, t12, 0, -t430);
  t458 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t451 * t169 + 0.5e1 / 0.3e1 * t83 * t454);
  t459 = t458 * t31;
  t463 = t200 * t132;
  t465 = t7 * t463 * t115;
  t472 = t7 * t177 * t230;
  t475 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t115 + t465 / 0.1e2 + t417 / 0.1e2 - t422 + 0.3e1 / 0.2e2 * t7 * t173 * t230 + t472 / 0.1e2);
  tv2rho21 = t167 + t182 + t195 + t235 + t8 * (t450 + t475);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t480 = t186 * t186;
  t484 = 0.2e1 * t121 + 0.2e1 * t312;
  t485 = my_piecewise5(t12, 0, t16, 0, t484);
  t489 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t480 + 0.5e1 / 0.3e1 * t27 * t485);
  t490 = t489 * t31;
  t496 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t73 + t442 / 0.5e1 - t336);
  t497 = t197 * t197;
  t501 = my_piecewise5(t16, 0, t12, 0, -t484);
  t505 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t497 + 0.5e1 / 0.3e1 * t83 * t501);
  t506 = t505 * t31;
  t515 = t87 * t87;
  t517 = 0.1e1 / t89 / t515;
  t519 = t38 * sigma[2] * t517;
  t525 = 0.1e3 / 0.243e3 * t38 * lapl[1] * t207 - 0.44e3 / 0.729e3 * t519;
  t529 = t108 * t108;
  t531 = t112 / t529;
  t532 = t219 * t219;
  t534 = t221 * t221;
  t535 = t107 * t107;
  t536 = 0.1e1 / t535;
  t537 = t534 * t536;
  t538 = t110 * t110;
  t539 = t111 * t111;
  t540 = 0.1e1 / t539;
  t541 = t538 * t540;
  t542 = t537 * t541;
  t544 = t532 * t534;
  t546 = t536 * t110;
  t547 = t224 * params->csk_a;
  t548 = t546 * t547;
  t550 = my_piecewise3(t103, 0, t525);
  t551 = my_piecewise3(t105, t550, 0);
  t554 = t217 * t532;
  t555 = 0.0;
  t557 = t555 * t222 * t225;
  t558 = t554 * t557;
  t559 = t537 * t225;
  t561 = t531 * t544;
  t563 = t536 * t538;
  t564 = t540 * params->csk_a;
  t565 = t563 * t564;
  t568 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t551 + t217 * t544 * t548 + t531 * t532 * t542 - t548 * t561 + t554 * t559 - t561 * t565 - t558);
  t570 = 0.55e2 / 0.81e2 * t519 + t525 * t113 + 0.2e1 * t215 * t228 + t101 * t568;
  t575 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t115 + t465 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t230 - t422 + t472 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t570);
  tv2rho22 = 0.2e1 * t195 + 0.2e1 * t235 + t8 * (t496 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t7 * t133 * t250 / 0.1e2;
  t584 = t38 * t139;
  t587 = t38 * t139 * t71;
  t590 = t38 * t43 * t160;
  t593 = t151 * t359;
  t594 = t356 * t593;
  t595 = t365 * t245;
  t596 = t388 * t595;
  t598 = t245 * t359;
  t599 = t149 * t598;
  t601 = t371 * t372 * t151;
  t604 = my_piecewise3(t61, 0, 0.4e2 / 0.243e3 * t584);
  t605 = my_piecewise3(t63, t604, 0);
  t608 = t245 * t151;
  t610 = t149 * t608 * t382;
  t611 = t156 * t151;
  t612 = t371 * t611;
  t614 = t356 * t598;
  t616 = t389 * t151;
  t617 = t388 * t616;
  t620 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t605 + t594 * t596 + t599 * t601 + t599 * t612 - t601 * t614 - t614 * t617 - t610);
  t622 = -0.5e1 / 0.27e2 * t584 + 0.4e2 / 0.243e3 * t587 - 0.5e1 / 0.81e2 * t590 + t147 * t248 + t53 * t620;
  t627 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t250 + t583 + 0.3e1 / 0.2e2 * t7 * t32 * t622);
  tv2rhosigma0 = t627 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t634 = t7 * t177 * t267 / 0.1e2;
  t636 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t267 + t634);
  tv2rhosigma2 = t636 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t642 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t250 + t583);
  tv2rhosigma3 = t642 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t647 = t38 * t207;
  t650 = t38 * t207 * t113;
  t653 = t38 * t91 * t228;
  t656 = t219 * t534;
  t657 = t531 * t656;
  t658 = t540 * t262;
  t659 = t563 * t658;
  t661 = t262 * t534;
  t662 = t217 * t661;
  t664 = t546 * t547 * t219;
  t667 = my_piecewise3(t103, 0, 0.4e2 / 0.243e3 * t647);
  t668 = my_piecewise3(t105, t667, 0);
  t671 = t262 * t219;
  t673 = t217 * t671 * t557;
  t674 = t224 * t219;
  t675 = t546 * t674;
  t677 = t531 * t661;
  t679 = t564 * t219;
  t680 = t563 * t679;
  t683 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t668 + t657 * t659 + t662 * t664 + t662 * t675 - t664 * t677 - t677 * t680 - t673);
  t685 = -0.5e1 / 0.27e2 * t647 + 0.4e2 / 0.243e3 * t650 - 0.5e1 / 0.81e2 * t653 + t215 * t265 + t101 * t683;
  t690 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t267 + t634 + 0.3e1 / 0.2e2 * t7 * t86 * t685);
  tv2rhosigma5 = t690 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t697 = t7 * t133 * t283 / 0.1e2;
  t703 = t365 * t278;
  t704 = t388 * t703;
  t706 = t278 * t359;
  t707 = t149 * t706;
  t710 = my_piecewise3(t61, 0, -0.25e2 / 0.162e3 * t238);
  t711 = my_piecewise3(t63, t710, 0);
  t714 = t278 * t151;
  t716 = t149 * t714 * t382;
  t718 = t356 * t706;
  t722 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t711 + t594 * t704 + t601 * t707 - t601 * t718 + t612 * t707 - t617 * t718 - t716);
  t724 = -0.25e2 / 0.162e3 * t241 + 0.5e1 / 0.54e2 * t38 * t48 * t160 + t147 * t281 + t53 * t722;
  t729 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t283 + t697 + 0.3e1 / 0.2e2 * t7 * t32 * t724);
  tv2rholapl0 = t729 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t736 = t7 * t177 * t299 / 0.1e2;
  t738 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t299 + t736);
  tv2rholapl1 = t738 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  t744 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t283 + t697);
  tv2rholapl2 = t744 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  t754 = t540 * t294;
  t755 = t563 * t754;
  t757 = t294 * t534;
  t758 = t217 * t757;
  t761 = my_piecewise3(t103, 0, -0.25e2 / 0.162e3 * t255);
  t762 = my_piecewise3(t105, t761, 0);
  t765 = t294 * t219;
  t767 = t217 * t765 * t557;
  t769 = t531 * t757;
  t773 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t762 + t657 * t755 + t664 * t758 - t664 * t769 + t675 * t758 - t680 * t769 - t767);
  t775 = -0.25e2 / 0.162e3 * t258 + 0.5e1 / 0.54e2 * t38 * t96 * t228 + t215 * t297 + t101 * t773;
  t780 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t299 + t736 + 0.3e1 / 0.2e2 * t7 * t86 * t775);
  tv2rholapl3 = t780 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t783 = t38 * t43 * t248;
  t785 = t245 * t245;
  t788 = t785 * t359;
  t791 = my_piecewise3(t61, 0, 0);
  t792 = my_piecewise3(t63, t791, 0);
  t794 = t149 * t792 * t158;
  t795 = t149 * t785;
  t796 = t795 * t382;
  t798 = t356 * t788;
  t802 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t788 + t356 * t367 * t785 - t373 * t798 + t384 * t795 - t390 * t798 - t794 - t796);
  t804 = -0.1e2 / 0.81e2 * t783 + t53 * t802;
  t808 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t804);
  tv2sigma20 = t8 * t808;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t810 = t38 * t91 * t265;
  t812 = t262 * t262;
  t815 = t812 * t534;
  t818 = my_piecewise3(t103, 0, 0);
  t819 = my_piecewise3(t105, t818, 0);
  t821 = t217 * t819 * t226;
  t822 = t217 * t812;
  t823 = t822 * t557;
  t825 = t531 * t815;
  t829 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t815 + t531 * t542 * t812 - t548 * t825 + t559 * t822 - t565 * t825 - t821 - t823);
  t831 = -0.1e2 / 0.81e2 * t810 + t101 * t829;
  t835 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t831);
  tv2sigma25 = t8 * t835;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t840 = t38 * t43 * t281;
  t843 = t372 * t245;
  t844 = t371 * t843;
  t846 = t278 * t245;
  t847 = t149 * t846;
  t848 = t847 * t382;
  t849 = t156 * t245;
  t850 = t371 * t849;
  t853 = t389 * t245;
  t854 = t388 * t853;
  t857 = my_piecewise5(t58, 0, t61, 0, t614 * t704 + t707 * t844 + t707 * t850 - t718 * t844 - t718 * t854 - t794 - t848);
  t859 = 0.5e1 / 0.54e2 * t38 * t48 * t248 - 0.5e1 / 0.81e2 * t840 + t53 * t857;
  t863 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t859);
  tv2sigmalapl0 = t8 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  t868 = t38 * t91 * t297;
  t872 = t546 * t547 * t262;
  t874 = t294 * t262;
  t875 = t217 * t874;
  t876 = t875 * t557;
  t877 = t224 * t262;
  t878 = t546 * t877;
  t881 = t564 * t262;
  t882 = t563 * t881;
  t885 = my_piecewise5(t102, 0, t103, 0, t677 * t755 + t758 * t872 + t758 * t878 - t769 * t872 - t769 * t882 - t821 - t876);
  t887 = 0.5e1 / 0.54e2 * t38 * t96 * t265 - 0.5e1 / 0.81e2 * t868 + t101 * t885;
  t891 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t887);
  tv2sigmalapl5 = t8 * t891;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  t895 = t278 * t278;
  t898 = t895 * t359;
  t901 = t149 * t895;
  t902 = t901 * t382;
  t904 = t356 * t898;
  t908 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t898 + t356 * t367 * t895 - t373 * t904 + t384 * t901 - t390 * t904 - t794 - t902);
  t910 = 0.5e1 / 0.27e2 * t38 * t48 * t281 + t53 * t908;
  t914 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t910);
  tv2lapl20 = t8 * t914;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  t918 = t294 * t294;
  t921 = t918 * t534;
  t924 = t217 * t918;
  t925 = t924 * t557;
  t927 = t531 * t921;
  t931 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t921 + t531 * t542 * t918 - t548 * t927 + t559 * t924 - t565 * t927 - t821 - t925);
  t933 = 0.5e1 / 0.27e2 * t38 * t96 * t297 + t101 * t931;
  t937 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t933);
  tv2lapl22 = t8 * t937;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

  t941 = 0.1e1 / t26 / t21;
  t942 = t307 * t124;
  t945 = t306 * t124;
  t948 = t120 * t120;
  t949 = 0.1e1 / t948;
  t950 = t18 * t949;
  t952 = 0.6e1 * t311 - 0.6e1 * t950;
  t953 = my_piecewise5(t12, 0, t16, 0, t952);
  t957 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t941 * t942 + 0.1e2 / 0.3e1 * t945 * t315 + 0.5e1 / 0.3e1 * t27 * t953);
  t958 = t957 * t31;
  t962 = t319 * t132;
  t964 = t7 * t962 * t73;
  t969 = t127 * t332;
  t971 = t7 * t969 * t73;
  t974 = t7 * t324 * t162;
  t980 = 0.1e1 / t30 / t120;
  t981 = t29 * t980;
  t984 = 0.2e1 / 0.45e2 * t7 * t981 * t73;
  t986 = t7 * t333 * t162;
  t989 = t7 * t133 * t395;
  t993 = 0.1e1 / t41 / t340 / rho[0];
  t995 = t38 * sigma[0] * t993;
  t1001 = -0.11e4 / 0.729e3 * t38 * lapl[0] * t342 + 0.616e4 / 0.2187e4 * t995;
  t1007 = t376 * t359;
  t1011 = t357 * t151;
  t1012 = t1011 * t380;
  t1014 = t156 * t153;
  t1015 = t371 * t1014;
  t1016 = t149 * t1012 * t1015;
  t1020 = t70 / t354 / t66;
  t1021 = t359 * t153;
  t1022 = t1011 * t1021;
  t1023 = t1020 * t1022;
  t1025 = 0.1e1 / t360 / t65;
  t1026 = t1025 * t363;
  t1027 = t1026 * t389;
  t1030 = t149 * t1022;
  t1031 = t1025 * t68;
  t1032 = params->csk_a * params->csk_a;
  t1033 = t156 * t1032;
  t1034 = t1031 * t1033;
  t1036 = t356 * t1022;
  t1040 = t363 * t68;
  t1041 = t1025 * t1040;
  t1043 = 0.1e1 / t364 / t69;
  t1044 = t1043 * t1032;
  t1045 = t1041 * t1044;
  t1048 = t365 * t1032;
  t1049 = t1026 * t1048;
  t1054 = t149 * t376 * t151 * t382;
  t1058 = t365 * t376;
  t1062 = t1043 * params->csk_a;
  t1063 = t1041 * t1062;
  t1066 = t1025 * params->csk_a;
  t1067 = t1066 * t157;
  t1070 = 0.3e1 * t1007 * t149 * t612 + 0.3e1 * t1058 * t388 * t594 + 0.3e1 * t1023 * t1027 - t1023 * t1034 - 0.2e1 * t1023 * t1045 - 0.3e1 * t1023 * t1049 + 0.3e1 * t1023 * t1063 - t1030 * t1034 + 0.3e1 * t1034 * t1036 + 0.3e1 * t1036 * t1049 + 0.3e1 * t1036 * t1067 + 0.3e1 * t1016 - 0.3e1 * t1054;
  t1073 = t1011 * t153;
  t1075 = t365 * t380;
  t1076 = t388 * t1075;
  t1077 = t356 * t1073 * t1076;
  t1080 = t372 * t376;
  t1081 = t371 * t1080;
  t1084 = t356 * t1007;
  t1087 = t356 * t1012;
  t1089 = t388 * t389 * t153;
  t1090 = t1087 * t1089;
  t1094 = t361 * params->csk_a;
  t1096 = t153 * t68 * t156;
  t1097 = t1094 * t1096;
  t1098 = t1087 * t1097;
  t1101 = t372 * t380;
  t1102 = t371 * t1101;
  t1103 = t149 * t1073 * t1102;
  t1106 = t1021 * t1025;
  t1107 = t1040 * t1043;
  t1108 = t1106 * t1107;
  t1110 = my_piecewise3(t61, 0, t1001);
  t1111 = my_piecewise3(t63, t1110, 0);
  t1115 = t1106 * t157;
  t1119 = t1106 * t366;
  t1122 = -t1011 * t1020 * t1108 - 0.2e1 * t1011 * t1115 * t149 - 0.3e1 * t1011 * t1119 * t356 + 0.3e1 * t1081 * t149 * t593 - t1111 * t149 * t158 - 0.3e1 * t1030 * t1067 - 0.3e1 * t1084 * t601 - 0.3e1 * t1084 * t617 + 0.3e1 * t1077 - 0.3e1 * t1090 - 0.3e1 * t1098 + 0.3e1 * t1103 - t383;
  t1124 = my_piecewise5(t58, 0, t61, 0, t1070 + t1122);
  t1126 = -0.77e3 / 0.243e3 * t995 + t1001 * t71 + 0.3e1 * t350 * t160 + 0.3e1 * t147 * t393 + t53 * t1124;
  t1131 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t958 * t73 + 0.3e1 / 0.1e2 * t964 + 0.9e1 / 0.2e2 * t7 * t320 * t162 - t971 / 0.1e2 + 0.3e1 / 0.5e1 * t974 + 0.9e1 / 0.2e2 * t7 * t128 * t395 + t984 - t986 / 0.1e2 + 0.3e1 / 0.1e2 * t989 + 0.3e1 / 0.2e2 * t7 * t32 * t1126);
  t1133 = 0.1e1 / t82 / t80;
  t1134 = t402 * t169;
  t1137 = t401 * t169;
  t1141 = my_piecewise5(t16, 0, t12, 0, -t952);
  t1145 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1133 * t1134 + 0.1e2 / 0.3e1 * t1137 * t406 + 0.5e1 / 0.3e1 * t83 * t1141);
  t1146 = t1145 * t31;
  t1150 = t410 * t132;
  t1152 = t7 * t1150 * t115;
  t1154 = t172 * t332;
  t1156 = t7 * t1154 * t115;
  t1158 = t85 * t980;
  t1161 = 0.2e1 / 0.45e2 * t7 * t1158 * t115;
  t1163 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1146 * t115 + 0.3e1 / 0.1e2 * t1152 - t1156 / 0.1e2 + t1161);
  tv3rho30 = 0.3e1 * t400 + 0.3e1 * t424 + t8 * (t1131 + t1163);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1166 = 0.2e1 * t450;
  t1167 = 0.2e1 * t475;
  t1168 = t941 * t186;
  t1171 = t306 * t431;
  t1176 = 0.2e1 * t311;
  t1177 = 0.6e1 * t950;
  t1178 = t1176 - t1177;
  t1179 = my_piecewise5(t12, 0, t16, 0, t1178);
  t1183 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1168 * t307 + 0.2e2 / 0.9e1 * t1171 * t124 + 0.1e2 / 0.9e1 * t427 * t315 + 0.5e1 / 0.3e1 * t27 * t1179);
  t1184 = t1183 * t31;
  t1188 = t435 * t132;
  t1191 = t7 * t1188 * t73 / 0.5e1;
  t1195 = t189 * t332;
  t1197 = t7 * t1195 * t73;
  t1201 = t7 * t440 * t162 / 0.5e1;
  t1210 = 0.3e1 / 0.2e2 * t7 * t1184 * t73 + t1191 + 0.3e1 / 0.1e2 * t7 * t436 * t162 - t1197 / 0.3e2 + t1201 + 0.3e1 / 0.2e2 * t7 * t190 * t395 + t964 / 0.1e2 - t971 / 0.15e2 + t974 / 0.5e1 + t984 - t986 / 0.15e2 + t989 / 0.1e2;
  t1211 = my_piecewise3(t2, 0, t1210);
  t1212 = t1133 * t197;
  t1215 = t401 * t454;
  t1221 = my_piecewise5(t16, 0, t12, 0, -t1178);
  t1225 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1212 * t402 + 0.2e2 / 0.9e1 * t1215 * t169 + 0.1e2 / 0.9e1 * t451 * t406 + 0.5e1 / 0.3e1 * t83 * t1221);
  t1226 = t1225 * t31;
  t1230 = t458 * t132;
  t1233 = t7 * t1230 * t115 / 0.5e1;
  t1234 = t200 * t332;
  t1236 = t7 * t1234 * t115;
  t1245 = t7 * t415 * t230 / 0.5e1;
  t1247 = t7 * t419 * t230;
  t1250 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1226 * t115 + t1233 - t1236 / 0.3e2 + t1152 / 0.1e2 - t1156 / 0.15e2 + t1161 + 0.3e1 / 0.2e2 * t7 * t411 * t230 + t1245 - t1247 / 0.3e2);
  tv3rho31 = t400 + t424 + t1166 + t1167 + t8 * (t1211 + t1250);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1253 = t941 * t480;
  t1258 = t306 * t485;
  t1261 = -t1176 - t1177;
  t1262 = my_piecewise5(t12, 0, t16, 0, t1261);
  t1266 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1253 * t124 + 0.2e2 / 0.9e1 * t427 * t431 + 0.1e2 / 0.9e1 * t1258 * t124 + 0.5e1 / 0.3e1 * t27 * t1262);
  t1267 = t1266 * t31;
  t1271 = t489 * t132;
  t1273 = t7 * t1271 * t73;
  t1282 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1267 * t73 + t1273 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t490 * t162 + t1191 - t1197 / 0.15e2 + t1201 - t971 / 0.3e2 + t984 - t986 / 0.3e2);
  t1283 = t1133 * t497;
  t1288 = t401 * t501;
  t1292 = my_piecewise5(t16, 0, t12, 0, -t1261);
  t1296 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1283 * t169 + 0.2e2 / 0.9e1 * t451 * t454 + 0.1e2 / 0.9e1 * t1288 * t169 + 0.5e1 / 0.3e1 * t83 * t1292);
  t1297 = t1296 * t31;
  t1301 = t505 * t132;
  t1303 = t7 * t1301 * t115;
  t1310 = t7 * t463 * t230;
  t1318 = t7 * t177 * t570;
  t1320 = 0.3e1 / 0.2e2 * t7 * t1297 * t115 + t1303 / 0.1e2 + t1233 - t1236 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t459 * t230 + t1310 / 0.5e1 - t1156 / 0.3e2 + t1161 + t1245 - t1247 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t173 * t570 + t1318 / 0.1e2;
  t1321 = my_piecewise3(t78, 0, t1320);
  tv3rho32 = t1166 + t1167 + t496 + t575 + t8 * (t1282 + t1321);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1326 = t480 * t186;
  t1332 = -0.6e1 * t311 - 0.6e1 * t950;
  t1333 = my_piecewise5(t12, 0, t16, 0, t1332);
  t1337 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t941 * t1326 + 0.1e2 / 0.3e1 * t427 * t485 + 0.5e1 / 0.3e1 * t27 * t1333);
  t1338 = t1337 * t31;
  t1345 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1338 * t73 + 0.3e1 / 0.1e2 * t1273 - t1197 / 0.1e2 + t984);
  t1346 = t497 * t197;
  t1352 = my_piecewise5(t16, 0, t12, 0, -t1332);
  t1356 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1133 * t1346 + 0.1e2 / 0.3e1 * t451 * t501 + 0.5e1 / 0.3e1 * t83 * t1352);
  t1357 = t1356 * t31;
  t1374 = 0.1e1 / t89 / t515 / rho[1];
  t1376 = t38 * sigma[2] * t1374;
  t1382 = -0.11e4 / 0.729e3 * t38 * lapl[1] * t517 + 0.616e4 / 0.2187e4 * t1376;
  t1390 = t112 / t529 / t108;
  t1391 = t532 * t219;
  t1392 = t534 * t221;
  t1393 = t1391 * t1392;
  t1394 = t1390 * t1393;
  t1396 = 0.1e1 / t535 / t107;
  t1397 = t1396 * t538;
  t1398 = t1397 * t564;
  t1401 = t217 * t1393;
  t1402 = t1396 * t110;
  t1403 = t224 * t1032;
  t1404 = t1402 * t1403;
  t1406 = t531 * t1393;
  t1410 = t1396 * t1032;
  t1411 = t1410 * t541;
  t1414 = t538 * t110;
  t1415 = t1396 * t1414;
  t1417 = 0.1e1 / t539 / t111;
  t1418 = t1417 * t1032;
  t1419 = t1415 * t1418;
  t1422 = t540 * t551;
  t1426 = t1417 * params->csk_a;
  t1427 = t1415 * t1426;
  t1432 = t551 * t219;
  t1434 = t217 * t1432 * t557;
  t1436 = t1396 * params->csk_a;
  t1437 = t1436 * t225;
  t1442 = t551 * t534;
  t1446 = 0.3e1 * t1422 * t563 * t657 + 0.3e1 * t1442 * t217 * t675 + 0.3e1 * t1394 * t1398 - t1394 * t1404 - 0.3e1 * t1394 * t1411 - 0.2e1 * t1394 * t1419 + 0.3e1 * t1394 * t1427 - t1401 * t1404 - 0.3e1 * t1401 * t1437 + 0.3e1 * t1404 * t1406 + 0.3e1 * t1406 * t1411 + 0.3e1 * t1406 * t1437 - 0.3e1 * t1434;
  t1447 = t1391 * t555;
  t1449 = t224 * t221;
  t1450 = t546 * t1449;
  t1451 = t217 * t1447 * t1450;
  t1453 = t1391 * t221;
  t1455 = t540 * t555;
  t1456 = t563 * t1455;
  t1457 = t531 * t1453 * t1456;
  t1459 = t531 * t1447;
  t1461 = t563 * t564 * t221;
  t1462 = t1459 * t1461;
  t1464 = t531 * t1442;
  t1467 = t536 * params->csk_a;
  t1469 = t221 * t110 * t224;
  t1470 = t1467 * t1469;
  t1471 = t1459 * t1470;
  t1474 = t547 * t555;
  t1475 = t546 * t1474;
  t1476 = t217 * t1453 * t1475;
  t1480 = t546 * t547 * t551;
  t1486 = t1392 * t1396;
  t1487 = t1414 * t1417;
  t1488 = t1486 * t1487;
  t1490 = my_piecewise3(t103, 0, t1382);
  t1491 = my_piecewise3(t105, t1490, 0);
  t1495 = t1486 * t225;
  t1499 = t1486 * t541;
  t1502 = -t1390 * t1391 * t1488 - 0.2e1 * t1391 * t1495 * t217 - 0.3e1 * t1391 * t1499 * t531 + 0.3e1 * t1480 * t217 * t656 - t1491 * t217 * t226 - 0.3e1 * t1464 * t664 - 0.3e1 * t1464 * t680 + 0.3e1 * t1451 + 0.3e1 * t1457 - 0.3e1 * t1462 - 0.3e1 * t1471 + 0.3e1 * t1476 - t558;
  t1504 = my_piecewise5(t102, 0, t103, 0, t1446 + t1502);
  t1506 = -0.77e3 / 0.243e3 * t1376 + t1382 * t113 + 0.3e1 * t525 * t228 + 0.3e1 * t215 * t568 + t101 * t1504;
  t1511 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1357 * t115 + 0.3e1 / 0.1e2 * t1303 + 0.9e1 / 0.2e2 * t7 * t506 * t230 - t1236 / 0.1e2 + 0.3e1 / 0.5e1 * t1310 + 0.9e1 / 0.2e2 * t7 * t201 * t570 + t1161 - t1247 / 0.1e2 + 0.3e1 / 0.1e2 * t1318 + 0.3e1 / 0.2e2 * t7 * t86 * t1506);
  tv3rho33 = 0.3e1 * t496 + 0.3e1 * t575 + t8 * (t1345 + t1511);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1519 = t7 * t324 * t250;
  t1526 = t7 * t333 * t250 / 0.3e2;
  t1528 = t7 * t133 * t622;
  t1530 = t38 * t342;
  t1533 = t38 * t342 * t71;
  t1536 = t38 * t139 * t160;
  t1539 = t38 * t43 * t393;
  t1546 = t149 * t605 * t151 * t382;
  t1548 = t245 * t376;
  t1550 = t149 * t1548 * t382;
  t1551 = t156 * t376;
  t1552 = t371 * t1551;
  t1555 = t365 * t605;
  t1556 = t388 * t1555;
  t1559 = t357 * t1021;
  t1560 = t1020 * t1559;
  t1561 = t1043 * t245;
  t1564 = t356 * t1559;
  t1565 = t1026 * t595;
  t1568 = t245 * t1021;
  t1569 = t149 * t1568;
  t1570 = t156 * t357;
  t1571 = t1031 * t1570;
  t1574 = t605 * t359;
  t1575 = t149 * t1574;
  t1578 = t356 * t1574;
  t1581 = t1020 * t1568;
  t1582 = t1025 * t1032;
  t1584 = t357 * t68 * t156;
  t1585 = t1582 * t1584;
  t1587 = t1026 * t853;
  t1591 = t356 * t1568;
  t1594 = t1066 * t1584;
  t1597 = -t1041 * t1560 * t1561 + t1084 * t596 + t1552 * t599 + 0.2e1 * t1556 * t594 + 0.3e1 * t1560 * t1587 - 0.3e1 * t1564 * t1565 - 0.2e1 * t1569 * t1571 - t1569 * t1585 + 0.2e1 * t1575 * t612 - 0.2e1 * t1578 * t617 - t1581 * t1585 + 0.3e1 * t1585 * t1591 + 0.3e1 * t1591 * t1594 - 0.2e1 * t1546 - t1550 - t610;
  t1601 = t356 * t357 * t153;
  t1602 = t595 * t380;
  t1603 = t388 * t1602;
  t1604 = t1601 * t1603;
  t1606 = t245 * t357;
  t1609 = t380 * t361 * t1096;
  t1610 = t149 * t1606 * t1609;
  t1616 = t357 * t363 * t365;
  t1617 = t1582 * t1616;
  t1620 = t389 * t376;
  t1621 = t388 * t1620;
  t1623 = t1044 * t357;
  t1624 = t1041 * t1623;
  t1627 = t1561 * params->csk_a;
  t1628 = t1041 * t1627;
  t1636 = t1606 * t380;
  t1637 = t356 * t1636;
  t1638 = t1637 * t1097;
  t1640 = t1637 * t1089;
  t1642 = t245 * t153;
  t1643 = t1642 * t361;
  t1644 = t149 * t1643;
  t1645 = params->csk_a * t357;
  t1646 = t1645 * t380;
  t1647 = t157 * t1646;
  t1648 = t1644 * t1647;
  t1651 = my_piecewise3(t61, 0, -0.44e3 / 0.729e3 * t1530);
  t1652 = my_piecewise3(t63, t1651, 0);
  t1655 = -t149 * t158 * t1652 + t1081 * t599 - t1081 * t614 + 0.3e1 * t1560 * t1628 - 0.3e1 * t1569 * t1594 + 0.2e1 * t1575 * t601 - 0.2e1 * t1578 * t601 - 0.3e1 * t1581 * t1617 - 0.2e1 * t1581 * t1624 + 0.3e1 * t1591 * t1617 - t1621 * t614 + 0.3e1 * t1604 + 0.3e1 * t1610 - 0.3e1 * t1638 - 0.3e1 * t1640 + 0.3e1 * t1648;
  t1657 = my_piecewise5(t58, 0, t61, 0, t1597 + t1655);
  t1659 = 0.55e2 / 0.81e2 * t1530 - 0.44e3 / 0.729e3 * t1533 + 0.8e2 / 0.243e3 * t1536 - 0.5e1 / 0.81e2 * t1539 + t350 * t248 + 0.2e1 * t147 * t620 + t53 * t1657;
  t1664 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t250 + t1519 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t622 - t1526 + t1528 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1659);
  tv3rho2sigma0 = t1664 * t8 + 0.2e1 * t627;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1671 = t7 * t415 * t267;
  t1675 = t7 * t419 * t267 / 0.3e2;
  t1677 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t267 + t1671 / 0.5e1 - t1675);
  tv3rho2sigma2 = t1677 * t8 + 0.2e1 * t636;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1683 = t7 * t440 * t250;
  t1691 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t250 + t1683 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t622 + t1519 / 0.1e2 - t1526 + t1528 / 0.1e2);
  tv3rho2sigma3 = t1691 * t8 + t627 + t642;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1697 = t7 * t463 * t267;
  t1704 = t7 * t177 * t685;
  t1707 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t267 + t1697 / 0.1e2 + t1671 / 0.1e2 - t1675 + 0.3e1 / 0.2e2 * t7 * t173 * t685 + t1704 / 0.1e2);
  tv3rho2sigma5 = t1707 * t8 + t636 + t690;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1715 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t250 + t1683 / 0.5e1 - t1526);
  tv3rho2sigma6 = t1715 * t8 + 0.2e1 * t642;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1726 = t38 * t517;
  t1729 = t38 * t517 * t113;
  t1732 = t38 * t207 * t228;
  t1735 = t38 * t91 * t568;
  t1741 = t540 * t668;
  t1742 = t563 * t1741;
  t1745 = t532 * t1392;
  t1746 = t1390 * t1745;
  t1747 = t1417 * t262;
  t1750 = t531 * t1745;
  t1751 = t1397 * t658;
  t1754 = t262 * t1392;
  t1755 = t217 * t1754;
  t1756 = t224 * t532;
  t1757 = t1402 * t1756;
  t1760 = t668 * t534;
  t1761 = t217 * t1760;
  t1766 = t217 * t668 * t219 * t557;
  t1768 = t262 * t551;
  t1770 = t217 * t1768 * t557;
  t1771 = t224 * t551;
  t1772 = t546 * t1771;
  t1775 = t1397 * t881;
  t1778 = t1403 * t532;
  t1779 = t1402 * t1778;
  t1781 = t531 * t1754;
  t1784 = t1390 * t1754;
  t1787 = t532 * t110 * t224;
  t1788 = t1436 * t1787;
  t1791 = -t1415 * t1746 * t1747 + t1464 * t659 + t1480 * t662 + 0.2e1 * t1742 * t657 + 0.3e1 * t1746 * t1775 - 0.3e1 * t1750 * t1751 - 0.2e1 * t1755 * t1757 - t1755 * t1779 + 0.2e1 * t1761 * t675 + t1772 * t662 + 0.3e1 * t1779 * t1781 - t1779 * t1784 + 0.3e1 * t1781 * t1788 - 0.2e1 * t1766 - t1770 - t673;
  t1792 = t531 * t1760;
  t1796 = t531 * t532 * t221;
  t1797 = t658 * t555;
  t1798 = t563 * t1797;
  t1799 = t1796 * t1798;
  t1801 = t262 * t532;
  t1804 = t555 * t536 * t1469;
  t1805 = t217 * t1801 * t1804;
  t1809 = t564 * t551;
  t1810 = t563 * t1809;
  t1812 = t1418 * t532;
  t1813 = t1415 * t1812;
  t1816 = t540 * t1032;
  t1817 = t1816 * t532;
  t1818 = t1397 * t1817;
  t1826 = t1747 * params->csk_a;
  t1827 = t1415 * t1826;
  t1832 = t1801 * t555;
  t1833 = t531 * t1832;
  t1834 = t1833 * t1470;
  t1836 = t1833 * t1461;
  t1838 = t262 * t221;
  t1839 = t1838 * t536;
  t1840 = t217 * t1839;
  t1841 = params->csk_a * t532;
  t1842 = t1841 * t555;
  t1843 = t225 * t1842;
  t1844 = t1840 * t1843;
  t1847 = my_piecewise3(t103, 0, -0.44e3 / 0.729e3 * t1726);
  t1848 = my_piecewise3(t105, t1847, 0);
  t1851 = -t1848 * t217 * t226 - t1480 * t677 + 0.3e1 * t1746 * t1827 - 0.3e1 * t1755 * t1788 + 0.2e1 * t1761 * t664 + 0.3e1 * t1781 * t1818 - 0.2e1 * t1784 * t1813 - 0.3e1 * t1784 * t1818 - 0.2e1 * t1792 * t664 - 0.2e1 * t1792 * t680 - t1810 * t677 + 0.3e1 * t1799 + 0.3e1 * t1805 - 0.3e1 * t1834 - 0.3e1 * t1836 + 0.3e1 * t1844;
  t1853 = my_piecewise5(t102, 0, t103, 0, t1791 + t1851);
  t1855 = 0.55e2 / 0.81e2 * t1726 - 0.44e3 / 0.729e3 * t1729 + 0.8e2 / 0.243e3 * t1732 - 0.5e1 / 0.81e2 * t1735 + t525 * t265 + 0.2e1 * t215 * t683 + t101 * t1853;
  t1860 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t267 + t1697 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t685 - t1675 + t1704 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t1855);
  tv3rho2sigma8 = t1860 * t8 + 0.2e1 * t690;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1867 = t7 * t324 * t283;
  t1874 = t7 * t333 * t283 / 0.3e2;
  t1876 = t7 * t133 * t724;
  t1886 = t711 * t151;
  t1888 = t149 * t1886 * t382;
  t1890 = t278 * t376;
  t1892 = t149 * t1890 * t382;
  t1895 = t365 * t711;
  t1896 = t388 * t1895;
  t1899 = t1043 * t278;
  t1900 = t1041 * t1899;
  t1902 = t1026 * t703;
  t1905 = t278 * t1021;
  t1906 = t149 * t1905;
  t1909 = t711 * t359;
  t1910 = t149 * t1909;
  t1913 = t356 * t1905;
  t1916 = t1020 * t1905;
  t1918 = t703 * params->csk_a;
  t1919 = t1026 * t1918;
  t1925 = t356 * t1909;
  t1928 = t1084 * t704 + t1552 * t707 - t1560 * t1900 + 0.3e1 * t1560 * t1919 - 0.3e1 * t1564 * t1902 - 0.2e1 * t1571 * t1906 - t1585 * t1906 + 0.3e1 * t1585 * t1913 - t1585 * t1916 + 0.3e1 * t1594 * t1913 + 0.2e1 * t1896 * t594 + 0.2e1 * t1910 * t612 - 0.2e1 * t1925 * t601 - 0.2e1 * t1888 - t1892 - t716;
  t1929 = t703 * t380;
  t1930 = t388 * t1929;
  t1931 = t1601 * t1930;
  t1933 = t278 * t357;
  t1935 = t149 * t1933 * t1609;
  t1947 = t1899 * params->csk_a;
  t1948 = t1041 * t1947;
  t1956 = t1933 * t380;
  t1957 = t356 * t1956;
  t1958 = t1957 * t1097;
  t1960 = t1957 * t1089;
  t1963 = t278 * t153 * t361;
  t1964 = t149 * t1963;
  t1965 = t1964 * t1647;
  t1968 = my_piecewise3(t61, 0, 0.1e3 / 0.243e3 * t584);
  t1969 = my_piecewise3(t63, t1968, 0);
  t1972 = -t149 * t158 * t1969 + t1081 * t707 - t1081 * t718 + 0.3e1 * t1560 * t1948 - 0.3e1 * t1594 * t1906 + 0.3e1 * t1617 * t1913 - 0.3e1 * t1617 * t1916 - t1621 * t718 - 0.2e1 * t1624 * t1916 + 0.2e1 * t1910 * t601 - 0.2e1 * t1925 * t617 + 0.3e1 * t1931 + 0.3e1 * t1935 - 0.3e1 * t1958 - 0.3e1 * t1960 + 0.3e1 * t1965;
  t1974 = my_piecewise5(t58, 0, t61, 0, t1928 + t1972);
  t1976 = 0.1e3 / 0.243e3 * t587 - 0.25e2 / 0.81e2 * t590 + 0.5e1 / 0.54e2 * t38 * t48 * t393 + t350 * t281 + 0.2e1 * t147 * t722 + t53 * t1974;
  t1981 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t283 + t1867 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t724 - t1874 + t1876 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1976);
  tv3rho2lapl0 = t1981 * t8 + 0.2e1 * t729;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  t1988 = t7 * t415 * t299;
  t1992 = t7 * t419 * t299 / 0.3e2;
  t1994 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t299 + t1988 / 0.5e1 - t1992);
  tv3rho2lapl1 = t1994 * t8 + 0.2e1 * t738;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 1] += tv3rho2lapl1;

  t2000 = t7 * t440 * t283;
  t2008 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t283 + t2000 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t724 + t1867 / 0.1e2 - t1874 + t1876 / 0.1e2);
  tv3rho2lapl2 = t2008 * t8 + t729 + t744;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 2] += tv3rho2lapl2;

  t2014 = t7 * t463 * t299;
  t2021 = t7 * t177 * t775;
  t2024 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t299 + t2014 / 0.1e2 + t1988 / 0.1e2 - t1992 + 0.3e1 / 0.2e2 * t7 * t173 * t775 + t2021 / 0.1e2);
  tv3rho2lapl3 = t2024 * t8 + t738 + t780;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 3] += tv3rho2lapl3;

  t2032 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t283 + t2000 / 0.5e1 - t1874);
  tv3rho2lapl4 = t2032 * t8 + 0.2e1 * t744;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 4] += tv3rho2lapl4;

  t2051 = t762 * t219;
  t2053 = t217 * t2051 * t557;
  t2055 = t294 * t551;
  t2057 = t217 * t2055 * t557;
  t2058 = t294 * t1392;
  t2059 = t217 * t2058;
  t2062 = t1397 * t754;
  t2065 = t762 * t534;
  t2066 = t217 * t2065;
  t2071 = t540 * t762;
  t2072 = t563 * t2071;
  t2075 = t1417 * t294;
  t2076 = t1415 * t2075;
  t2079 = t754 * params->csk_a;
  t2080 = t1397 * t2079;
  t2084 = t531 * t2058;
  t2087 = t1390 * t2058;
  t2090 = t1464 * t755 + t1480 * t758 - t1746 * t2076 + 0.3e1 * t1746 * t2080 - 0.3e1 * t1750 * t2062 - 0.2e1 * t1757 * t2059 + t1772 * t758 - t1779 * t2059 + 0.3e1 * t1779 * t2084 - t1779 * t2087 - t1810 * t769 + 0.2e1 * t2066 * t675 + 0.2e1 * t2072 * t657 - 0.2e1 * t2053 - t2057 - t767;
  t2095 = t531 * t2065;
  t2098 = t294 * t532;
  t2100 = t217 * t2098 * t1804;
  t2102 = t754 * t555;
  t2103 = t563 * t2102;
  t2104 = t1796 * t2103;
  t2115 = t2075 * params->csk_a;
  t2116 = t1415 * t2115;
  t2121 = t2098 * t555;
  t2122 = t531 * t2121;
  t2123 = t2122 * t1470;
  t2125 = t2122 * t1461;
  t2128 = t294 * t221 * t536;
  t2129 = t217 * t2128;
  t2130 = t2129 * t1843;
  t2133 = my_piecewise3(t103, 0, 0.1e3 / 0.243e3 * t647);
  t2134 = my_piecewise3(t105, t2133, 0);
  t2137 = -t2134 * t217 * t226 - t1480 * t769 + 0.3e1 * t1746 * t2116 - 0.3e1 * t1788 * t2059 + 0.3e1 * t1788 * t2084 - 0.2e1 * t1813 * t2087 + 0.3e1 * t1818 * t2084 - 0.3e1 * t1818 * t2087 + 0.2e1 * t2066 * t664 - 0.2e1 * t2095 * t664 - 0.2e1 * t2095 * t680 + 0.3e1 * t2100 + 0.3e1 * t2104 - 0.3e1 * t2123 - 0.3e1 * t2125 + 0.3e1 * t2130;
  t2139 = my_piecewise5(t102, 0, t103, 0, t2090 + t2137);
  t2141 = 0.1e3 / 0.243e3 * t650 - 0.25e2 / 0.81e2 * t653 + 0.5e1 / 0.54e2 * t38 * t96 * t568 + t525 * t297 + 0.2e1 * t215 * t773 + t101 * t2139;
  t2146 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t299 + t2014 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t775 - t1992 + t2021 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t2141);
  tv3rho2lapl5 = t2146 * t8 + 0.2e1 * t780;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 5] += tv3rho2lapl5;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  tv3rho2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 1] += tv3rho2tau1;

  tv3rho2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 2] += tv3rho2tau2;

  tv3rho2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 3] += tv3rho2tau3;

  tv3rho2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 4] += tv3rho2tau4;

  tv3rho2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 5] += tv3rho2tau5;

  t2153 = t7 * t133 * t804 / 0.1e2;
  t2155 = t38 * t139 * t248;
  t2158 = t38 * t43 * t620;
  t2161 = t792 * t359;
  t2162 = t149 * t2161;
  t2163 = t2162 * t612;
  t2164 = t785 * t1021;
  t2165 = t149 * t2164;
  t2166 = t1031 * t611;
  t2169 = t356 * t2164;
  t2170 = t365 * t151;
  t2171 = t1026 * t2170;
  t2174 = t156 * t605;
  t2175 = t371 * t2174;
  t2180 = t151 * t1021;
  t2181 = t1020 * t2180;
  t2182 = t1043 * t785;
  t2183 = t1041 * t2182;
  t2185 = t365 * t792;
  t2186 = t388 * t2185;
  t2187 = t594 * t2186;
  t2188 = t792 * t151;
  t2190 = t149 * t2188 * t382;
  t2191 = t245 * t380;
  t2192 = t149 * t2191;
  t2193 = t154 * t68;
  t2195 = t2192 * t2193 * t2174;
  t2196 = 0.2e1 * t2195;
  t2197 = t2162 * t601;
  t2198 = t356 * t2161;
  t2199 = t2198 * t601;
  t2201 = t151 * t68 * t156;
  t2202 = t1066 * t2201;
  t2207 = t1020 * t2164;
  t2208 = t1044 * t151;
  t2209 = t1041 * t2208;
  t2212 = t1048 * t151;
  t2213 = t1026 * t2212;
  t2216 = t2198 * t617;
  t2217 = 0.2e1 * t614 * t1556 - 0.2e1 * t2165 * t2166 - 0.3e1 * t2165 * t2202 - 0.3e1 * t2169 * t2171 + 0.3e1 * t2169 * t2202 + 0.3e1 * t2169 * t2213 + 0.2e1 * t599 * t2175 - t2181 * t2183 - 0.2e1 * t2207 * t2209 + t2163 + t2187 - t2190 - t2196 + t2197 - t2199 - t2216;
  t2218 = t785 * t380;
  t2219 = t149 * t2218;
  t2221 = t371 * t611 * t153;
  t2222 = t2219 * t2221;
  t2224 = t157 * t605;
  t2225 = t1094 * t2224;
  t2230 = t389 * t605;
  t2231 = t388 * t2230;
  t2234 = t785 * t153;
  t2235 = t356 * t2234;
  t2236 = t2170 * t380;
  t2237 = t388 * t2236;
  t2238 = t2235 * t2237;
  t2240 = t1062 * t151;
  t2241 = t1041 * t2240;
  t2246 = t1026 * t616;
  t2249 = t1033 * t151;
  t2250 = t1031 * t2249;
  t2256 = t356 * t2218 * t361;
  t2257 = params->csk_a * t151;
  t2258 = t2257 * t1096;
  t2259 = t2256 * t2258;
  t2262 = t149 * t2234 * t361;
  t2263 = t2257 * t380;
  t2264 = t157 * t2263;
  t2265 = t2262 * t2264;
  t2267 = t2257 * t153;
  t2268 = t366 * t2267;
  t2269 = t2256 * t2268;
  t2271 = -t2165 * t2250 + 0.3e1 * t2169 * t2250 - 0.3e1 * t2207 * t2213 + 0.3e1 * t2207 * t2241 + 0.3e1 * t2207 * t2246 - t2207 * t2250 + 0.2e1 * t599 * t2225 - 0.2e1 * t614 * t2225 - 0.2e1 * t614 * t2231 + 0.3e1 * t2222 + 0.3e1 * t2238 - 0.3e1 * t2259 + 0.3e1 * t2265 - 0.3e1 * t2269 - t794 - t796;
  t2273 = my_piecewise5(t58, 0, t61, 0, t2217 + t2271);
  t2275 = 0.8e2 / 0.243e3 * t2155 - 0.1e2 / 0.81e2 * t2158 + t147 * t802 + t53 * t2273;
  t2280 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t804 + t2153 + 0.3e1 / 0.2e2 * t7 * t32 * t2275);
  tv3rhosigma20 = t8 * t2280 + t808;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2287 = t7 * t177 * t831 / 0.1e2;
  t2289 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t831 + t2287);
  tv3rhosigma25 = t8 * t2289 + t835;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2295 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t804 + t2153);
  tv3rhosigma26 = t8 * t2295 + t808;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2301 = t38 * t207 * t265;
  t2304 = t38 * t91 * t683;
  t2307 = t540 * t819;
  t2308 = t563 * t2307;
  t2309 = t657 * t2308;
  t2310 = t819 * t219;
  t2312 = t217 * t2310 * t557;
  t2313 = t262 * t555;
  t2314 = t217 * t2313;
  t2315 = t222 * t110;
  t2316 = t224 * t668;
  t2318 = t2314 * t2315 * t2316;
  t2319 = 0.2e1 * t2318;
  t2320 = t546 * t2316;
  t2325 = t812 * t1392;
  t2326 = t531 * t2325;
  t2327 = t540 * t219;
  t2328 = t1397 * t2327;
  t2331 = t819 * t534;
  t2332 = t217 * t2331;
  t2333 = t2332 * t675;
  t2334 = t217 * t2325;
  t2335 = t1402 * t674;
  t2338 = t219 * t1392;
  t2339 = t1390 * t2338;
  t2340 = t1417 * t812;
  t2341 = t1415 * t2340;
  t2343 = t2332 * t664;
  t2344 = t531 * t2331;
  t2345 = t2344 * t664;
  t2347 = t219 * t110 * t224;
  t2348 = t1436 * t2347;
  t2353 = t1390 * t2325;
  t2354 = t541 * t219;
  t2355 = t1410 * t2354;
  t2358 = t564 * t668;
  t2359 = t563 * t2358;
  t2362 = t1418 * t219;
  t2363 = t1415 * t2362;
  t2366 = 0.2e1 * t677 * t1742 + 0.2e1 * t662 * t2320 - 0.3e1 * t2326 * t2328 + 0.3e1 * t2326 * t2348 - 0.2e1 * t2334 * t2335 - 0.3e1 * t2334 * t2348 - t2339 * t2341 - 0.3e1 * t2353 * t2355 - 0.2e1 * t2353 * t2363 - 0.2e1 * t677 * t2359 + t2309 - t2312 - t2319 + t2333 + t2343 - t2345;
  t2367 = t812 * t221;
  t2368 = t531 * t2367;
  t2369 = t2327 * t555;
  t2370 = t563 * t2369;
  t2371 = t2368 * t2370;
  t2373 = t1426 * t219;
  t2374 = t1415 * t2373;
  t2377 = t547 * t668;
  t2378 = t546 * t2377;
  t2383 = t2344 * t680;
  t2384 = t812 * t555;
  t2385 = t217 * t2384;
  t2387 = t546 * t674 * t221;
  t2388 = t2385 * t2387;
  t2392 = t1397 * t679;
  t2395 = t1403 * t219;
  t2396 = t1402 * t2395;
  t2402 = t531 * t2384 * t536;
  t2403 = params->csk_a * t219;
  t2404 = t2403 * t1469;
  t2405 = t2402 * t2404;
  t2408 = t217 * t2367 * t536;
  t2409 = t2403 * t555;
  t2410 = t225 * t2409;
  t2411 = t2408 * t2410;
  t2413 = t2403 * t221;
  t2414 = t541 * t2413;
  t2415 = t2402 * t2414;
  t2417 = 0.3e1 * t2326 * t2355 + 0.3e1 * t2326 * t2396 - t2334 * t2396 + 0.3e1 * t2353 * t2374 + 0.3e1 * t2353 * t2392 - t2353 * t2396 + 0.2e1 * t662 * t2378 - 0.2e1 * t677 * t2378 + 0.3e1 * t2371 - t2383 + 0.3e1 * t2388 - 0.3e1 * t2405 + 0.3e1 * t2411 - 0.3e1 * t2415 - t821 - t823;
  t2419 = my_piecewise5(t102, 0, t103, 0, t2366 + t2417);
  t2421 = 0.8e2 / 0.243e3 * t2301 - 0.1e2 / 0.81e2 * t2304 + t215 * t829 + t101 * t2419;
  t2426 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t831 + t2287 + 0.3e1 / 0.2e2 * t7 * t86 * t2421);
  tv3rhosigma211 = t8 * t2426 + t835;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2433 = t7 * t133 * t859 / 0.1e2;
  t2439 = t38 * t139 * t281;
  t2442 = t38 * t43 * t722;
  t2447 = t711 * t245;
  t2449 = t149 * t2447 * t382;
  t2450 = t278 * t605;
  t2452 = t149 * t2450 * t382;
  t2455 = t157 * params->csk_a;
  t2456 = t608 * t380;
  t2458 = t1964 * t2455 * t2456;
  t2460 = t846 * t380;
  t2461 = t356 * t2460;
  t2462 = t388 * t365;
  t2463 = t2462 * t2267;
  t2464 = t2461 * t2463;
  t2467 = t1094 * t151 * t1096;
  t2468 = t2461 * t2467;
  t2476 = t1578 * t704 + t614 * t1896 + t1910 * t844 + t1910 * t850 - t1925 * t844 - t1925 * t854 + t707 * t2175 + t707 * t2225 - t718 * t2225 - t718 * t2231 + t2163 + t2187 - t2190 - t2449 - t2452 + 0.3e1 * t2458 - 0.3e1 * t2464 - 0.3e1 * t2468 - t848;
  t2477 = t1561 * t278;
  t2478 = t1041 * t2477;
  t2480 = t703 * t151;
  t2481 = t1026 * t2480;
  t2484 = t849 * t151;
  t2485 = t1031 * t2484;
  t2488 = t1905 * t1025;
  t2489 = t356 * t2488;
  t2490 = t1032 * t245;
  t2491 = t2490 * t151;
  t2492 = t366 * t2491;
  t2495 = t149 * t2460;
  t2496 = t2495 * t2221;
  t2498 = t149 * t2488;
  t2499 = params->csk_a * t245;
  t2500 = t2499 * t151;
  t2501 = t157 * t2500;
  t2504 = t1568 * t1025;
  t2505 = t1020 * t2504;
  t2506 = t278 * params->csk_a;
  t2507 = t2506 * t151;
  t2508 = t366 * t2507;
  t2511 = t157 * t2491;
  t2515 = t1020 * t2488;
  t2521 = t1107 * t2491;
  t2524 = t356 * t1643;
  t2525 = t714 * t380;
  t2526 = t366 * t2525;
  t2527 = t2524 * t2526;
  t2529 = t1107 * t2507;
  t2532 = -0.3e1 * t1591 * t2481 - 0.2e1 * t1906 * t2485 - t2181 * t2478 + 0.3e1 * t2489 * t2492 + 0.3e1 * t2489 * t2501 + 0.3e1 * t2489 * t2511 - 0.3e1 * t2515 * t2492 - 0.3e1 * t2498 * t2501 - t2498 * t2511 + 0.3e1 * t2505 * t2508 + 0.3e1 * t2505 * t2529 - t2515 * t2511 - 0.2e1 * t2515 * t2521 + t2197 - t2199 - t2216 + 0.3e1 * t2496 + 0.3e1 * t2527 - t794;
  t2534 = my_piecewise5(t58, 0, t61, 0, t2476 + t2532);
  t2536 = -0.25e2 / 0.162e3 * t783 + 0.5e1 / 0.54e2 * t38 * t48 * t620 + 0.4e2 / 0.243e3 * t2439 - 0.5e1 / 0.81e2 * t2442 + t147 * t857 + t53 * t2534;
  t2541 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t859 + t2433 + 0.3e1 / 0.2e2 * t7 * t32 * t2536);
  tv3rhosigmalapl0 = t8 * t2541 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  t2548 = t7 * t177 * t887 / 0.1e2;
  t2550 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t887 + t2548);
  tv3rhosigmalapl5 = t8 * t2550 + t891;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  t2556 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t859 + t2433);
  tv3rhosigmalapl6 = t8 * t2556 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  t2566 = t38 * t207 * t297;
  t2569 = t38 * t91 * t773;
  t2576 = t762 * t262;
  t2578 = t217 * t2576 * t557;
  t2579 = t294 * t668;
  t2581 = t217 * t2579 * t557;
  t2582 = t874 * t555;
  t2583 = t531 * t2582;
  t2585 = t1467 * t219 * t1469;
  t2586 = t2583 * t2585;
  t2588 = t225 * params->csk_a;
  t2589 = t671 * t555;
  t2591 = t2129 * t2588 * t2589;
  t2593 = t563 * t540;
  t2594 = t2593 * t2413;
  t2595 = t2583 * t2594;
  t2600 = t877 * t219;
  t2601 = t1402 * t2600;
  t2605 = t1397 * t754 * t219;
  t2608 = -0.3e1 * t1781 * t2605 + t1792 * t755 - 0.2e1 * t2059 * t2601 + t2066 * t878 + t677 * t2072 - t2095 * t872 + t758 * t2320 + t758 * t2378 - t769 * t2378 + t2309 - t2312 + t2333 + t2343 - t2578 - t2581 - 0.3e1 * t2586 + 0.3e1 * t2591 - 0.3e1 * t2595 - t876;
  t2611 = t1747 * t294;
  t2612 = t1415 * t2611;
  t2615 = t2058 * t1396;
  t2616 = t217 * t2615;
  t2617 = params->csk_a * t262;
  t2618 = t2617 * t219;
  t2619 = t225 * t2618;
  t2622 = t1032 * t262;
  t2623 = t2622 * t219;
  t2624 = t225 * t2623;
  t2626 = t531 * t2615;
  t2629 = t1754 * t1396;
  t2630 = t1390 * t2629;
  t2631 = t294 * params->csk_a;
  t2632 = t2631 * t219;
  t2633 = t541 * t2632;
  t2636 = t1390 * t2615;
  t2640 = t2622 * t2354;
  t2643 = t1487 * t2623;
  t2646 = t531 * t1839;
  t2647 = t765 * t555;
  t2648 = t541 * t2647;
  t2649 = t2646 * t2648;
  t2651 = t1487 * t2632;
  t2656 = t217 * t2582;
  t2657 = t2656 * t2387;
  t2659 = t2066 * t872 - t2095 * t882 - t2339 * t2612 - t769 * t2359 - 0.3e1 * t2616 * t2619 - t2616 * t2624 + 0.3e1 * t2626 * t2619 + 0.3e1 * t2626 * t2624 - t2636 * t2624 + 0.3e1 * t2626 * t2640 + 0.3e1 * t2630 * t2633 + 0.3e1 * t2630 * t2651 - 0.3e1 * t2636 * t2640 - 0.2e1 * t2636 * t2643 - t2345 - t2383 + 0.3e1 * t2649 + 0.3e1 * t2657 - t821;
  t2661 = my_piecewise5(t102, 0, t103, 0, t2608 + t2659);
  t2663 = -0.25e2 / 0.162e3 * t810 + 0.5e1 / 0.54e2 * t38 * t96 * t683 + 0.4e2 / 0.243e3 * t2566 - 0.5e1 / 0.81e2 * t2569 + t215 * t885 + t101 * t2661;
  t2668 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t887 + t2548 + 0.3e1 / 0.2e2 * t7 * t86 * t2663);
  tv3rhosigmalapl11 = t8 * t2668 + t891;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 4] += tv3rhosigmatau4;

  tv3rhosigmatau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 5] += tv3rhosigmatau5;

  tv3rhosigmatau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 10] += tv3rhosigmatau10;

  tv3rhosigmatau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2675 = t7 * t133 * t910 / 0.1e2;
  t2681 = t278 * t380;
  t2682 = t149 * t2681;
  t2683 = t156 * t711;
  t2685 = t2682 * t2193 * t2683;
  t2686 = 0.2e1 * t2685;
  t2692 = t1043 * t895;
  t2693 = t1041 * t2692;
  t2695 = t895 * t1021;
  t2696 = t356 * t2695;
  t2699 = t149 * t2695;
  t2702 = t1020 * t2695;
  t2715 = 0.2e1 * t2683 * t371 * t707 + 0.2e1 * t718 * t1896 - 0.2e1 * t2699 * t2166 - 0.3e1 * t2696 * t2171 - t2181 * t2693 + 0.3e1 * t2696 * t2202 - 0.3e1 * t2699 * t2202 - 0.3e1 * t2702 * t2213 + 0.3e1 * t2702 * t2246 + 0.3e1 * t2696 * t2250 - t2699 * t2250 - t2702 * t2250 + t2163 + t2187 - t2190 - t2686;
  t2716 = t389 * t711;
  t2722 = t895 * t153;
  t2723 = t356 * t2722;
  t2724 = t2723 * t2237;
  t2729 = t371 * t372 * t711;
  t2734 = t895 * t380;
  t2735 = t149 * t2734;
  t2736 = t2735 * t2221;
  t2741 = t356 * t2734 * t361;
  t2742 = t2741 * t2258;
  t2744 = t2741 * t2268;
  t2747 = t149 * t2722 * t361;
  t2748 = t2747 * t2264;
  t2750 = -0.2e1 * t2716 * t388 * t718 - 0.2e1 * t2702 * t2209 + 0.3e1 * t2696 * t2213 + 0.3e1 * t2702 * t2241 + 0.2e1 * t707 * t2729 - 0.2e1 * t718 * t2729 + t2197 - t2199 - t2216 + 0.3e1 * t2724 + 0.3e1 * t2736 - 0.3e1 * t2742 - 0.3e1 * t2744 + 0.3e1 * t2748 - t794 - t902;
  t2752 = my_piecewise5(t58, 0, t61, 0, t2715 + t2750);
  t2754 = -0.25e2 / 0.81e2 * t840 + 0.5e1 / 0.27e2 * t38 * t48 * t722 + t147 * t908 + t53 * t2752;
  t2759 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t910 + t2675 + 0.3e1 / 0.2e2 * t7 * t32 * t2754);
  tv3rholapl20 = t8 * t2759 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 1] += tv3rholapl21;

  t2766 = t7 * t177 * t933 / 0.1e2;
  t2768 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t933 + t2766);
  tv3rholapl22 = t8 * t2768 + t937;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 2] += tv3rholapl22;

  t2774 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t910 + t2675);
  tv3rholapl23 = t8 * t2774 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 4] += tv3rholapl24;

  t2784 = t294 * t555;
  t2785 = t217 * t2784;
  t2786 = t224 * t762;
  t2788 = t2785 * t2315 * t2786;
  t2789 = 0.2e1 * t2788;
  t2793 = t918 * t1392;
  t2794 = t217 * t2793;
  t2797 = t531 * t2793;
  t2802 = t1417 * t918;
  t2803 = t1415 * t2802;
  t2808 = t1390 * t2793;
  t2818 = 0.2e1 * t2786 * t546 * t758 + 0.2e1 * t769 * t2072 - 0.3e1 * t2797 * t2328 - 0.2e1 * t2794 * t2335 - t2339 * t2803 - 0.3e1 * t2794 * t2348 + 0.3e1 * t2797 * t2348 - 0.2e1 * t2808 * t2363 + 0.3e1 * t2808 * t2374 - t2794 * t2396 + 0.3e1 * t2797 * t2396 - t2808 * t2396 + t2309 - t2312 + t2333 - t2789;
  t2819 = t547 * t762;
  t2820 = t546 * t2819;
  t2825 = t918 * t555;
  t2826 = t217 * t2825;
  t2827 = t2826 * t2387;
  t2833 = t564 * t762;
  t2837 = t918 * t221;
  t2838 = t531 * t2837;
  t2839 = t2838 * t2370;
  t2844 = t531 * t2825 * t536;
  t2845 = t2844 * t2414;
  t2847 = t2844 * t2404;
  t2850 = t217 * t2837 * t536;
  t2851 = t2850 * t2410;
  t2853 = -0.2e1 * t2833 * t563 * t769 + 0.3e1 * t2797 * t2355 - 0.3e1 * t2808 * t2355 + 0.3e1 * t2808 * t2392 + 0.2e1 * t758 * t2820 - 0.2e1 * t769 * t2820 + t2343 - t2345 - t2383 + 0.3e1 * t2827 + 0.3e1 * t2839 - 0.3e1 * t2845 - 0.3e1 * t2847 + 0.3e1 * t2851 - t821 - t925;
  t2855 = my_piecewise5(t102, 0, t103, 0, t2818 + t2853);
  t2857 = -0.25e2 / 0.81e2 * t868 + 0.5e1 / 0.27e2 * t38 * t96 * t773 + t215 * t931 + t101 * t2855;
  t2862 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t933 + t2766 + 0.3e1 / 0.2e2 * t7 * t86 * t2857);
  tv3rholapl25 = t8 * t2862 + t937;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 7] += tv3rholapltau7;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 1] += tv3rhotau21;

  tv3rhotau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 2] += tv3rhotau22;

  tv3rhotau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 4] += tv3rhotau24;

  tv3rhotau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 5] += tv3rhotau25;

  t2865 = t38 * t43 * t802;
  t2867 = t2162 * t850;
  t2868 = 0.3e1 * t2867;
  t2869 = t785 * t245;
  t2870 = t2869 * t380;
  t2872 = t149 * t2870 * t1015;
  t2873 = 0.3e1 * t2872;
  t2874 = t2869 * t1021;
  t2875 = t356 * t2874;
  t2878 = t1020 * t2874;
  t2882 = t149 * t2874;
  t2888 = t792 * t245;
  t2890 = t149 * t2888 * t382;
  t2891 = 0.3e1 * t2890;
  t2896 = t614 * t2186;
  t2897 = 0.3e1 * t2896;
  t2900 = 0.3e1 * t2878 * t1027 + 0.3e1 * t2875 * t1034 - t2878 * t1034 - t2882 * t1034 - 0.2e1 * t2878 * t1045 - 0.3e1 * t2878 * t1049 + 0.3e1 * t2878 * t1063 + 0.3e1 * t2875 * t1067 - 0.3e1 * t2882 * t1067 + t2868 + t2873 - t2891 + t2897;
  t2903 = t2869 * t153;
  t2905 = t356 * t2903 * t1076;
  t2906 = 0.3e1 * t2905;
  t2907 = t2198 * t844;
  t2908 = 0.3e1 * t2907;
  t2909 = t356 * t2870;
  t2910 = t2909 * t1097;
  t2911 = 0.3e1 * t2910;
  t2913 = t149 * t2903 * t1102;
  t2914 = 0.3e1 * t2913;
  t2915 = t372 * t792;
  t2916 = t371 * t2915;
  t2917 = t599 * t2916;
  t2918 = 0.3e1 * t2917;
  t2919 = t2198 * t854;
  t2920 = 0.3e1 * t2919;
  t2921 = t2909 * t1089;
  t2922 = 0.3e1 * t2921;
  t2931 = -t1020 * t1108 * t2869 - 0.2e1 * t1115 * t149 * t2869 - 0.3e1 * t1119 * t2869 * t356 + 0.3e1 * t2875 * t1049 + t2906 - t2908 - t2911 + t2914 + t2918 - t2920 - t2922 - t794 - t796;
  t2933 = my_piecewise5(t58, 0, t61, 0, t2900 + t2931);
  t2935 = -0.5e1 / 0.27e2 * t2865 + t53 * t2933;
  t2939 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t2935);
  tv3sigma30 = t8 * t2939;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2941 = t38 * t91 * t829;
  t2943 = t812 * t262;
  t2944 = t2943 * t1392;
  t2945 = t531 * t2944;
  t2948 = t1390 * t2944;
  t2952 = t217 * t2944;
  t2959 = t677 * t2308;
  t2960 = 0.3e1 * t2959;
  t2965 = t819 * t262;
  t2967 = t217 * t2965 * t557;
  t2968 = 0.3e1 * t2967;
  t2969 = t2943 * t221;
  t2971 = t531 * t2969 * t1456;
  t2972 = 0.3e1 * t2971;
  t2973 = t2332 * t878;
  t2974 = 0.3e1 * t2973;
  t2975 = t2943 * t555;
  t2976 = t217 * t2975;
  t2977 = t2976 * t1450;
  t2978 = 0.3e1 * t2977;
  t2979 = 0.3e1 * t2945 * t1404 - t2948 * t1404 + 0.3e1 * t2945 * t1411 - 0.3e1 * t2948 * t1411 - 0.2e1 * t2948 * t1419 + 0.3e1 * t2948 * t1427 + 0.3e1 * t2945 * t1437 - 0.3e1 * t2952 * t1437 + t2960 - t2968 + t2972 + t2974 + t2978;
  t2984 = t217 * t2969 * t1475;
  t2985 = 0.3e1 * t2984;
  t2986 = t547 * t819;
  t2987 = t546 * t2986;
  t2988 = t662 * t2987;
  t2989 = 0.3e1 * t2988;
  t2990 = t2344 * t882;
  t2991 = 0.3e1 * t2990;
  t2992 = t531 * t2975;
  t2993 = t2992 * t1461;
  t2994 = 0.3e1 * t2993;
  t2995 = t2344 * t872;
  t2996 = 0.3e1 * t2995;
  t2997 = t2992 * t1470;
  t2998 = 0.3e1 * t2997;
  t3007 = -t1390 * t1488 * t2943 - 0.2e1 * t1495 * t217 * t2943 - 0.3e1 * t1499 * t2943 * t531 + 0.3e1 * t2948 * t1398 - t2952 * t1404 + t2985 + t2989 - t2991 - t2994 - t2996 - t2998 - t821 - t823;
  t3009 = my_piecewise5(t102, 0, t103, 0, t2979 + t3007);
  t3011 = -0.5e1 / 0.27e2 * t2941 + t101 * t3009;
  t3015 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3011);
  tv3sigma39 = t8 * t3015;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3020 = t38 * t43 * t857;
  t3024 = t156 * t785;
  t3025 = t1031 * t3024;
  t3028 = t156 * t792;
  t3029 = t371 * t3028;
  t3030 = t707 * t3029;
  t3031 = t2198 * t704;
  t3033 = t278 * t792;
  t3035 = t149 * t3033 * t382;
  t3036 = 0.2e1 * t2867;
  t3037 = 0.2e1 * t2890;
  t3038 = 0.2e1 * t2896;
  t3040 = t785 * t68 * t156;
  t3041 = t1582 * t3040;
  t3045 = t278 * t785;
  t3046 = t149 * t3045;
  t3047 = t3046 * t1609;
  t3048 = 0.3e1 * t3047;
  t3049 = t2235 * t1930;
  t3050 = 0.3e1 * t3049;
  t3051 = t389 * t792;
  t3052 = t388 * t3051;
  t3053 = t718 * t3052;
  t3054 = t1044 * t785;
  t3055 = t1041 * t3054;
  t3058 = -t2207 * t1900 - 0.3e1 * t2169 * t1902 - 0.2e1 * t1906 * t3025 + 0.3e1 * t1913 * t3041 - t1916 * t3041 - 0.2e1 * t1916 * t3055 + t3030 + t3031 - t3035 + t3036 - t3037 + t3038 + t3048 + t3050 - t3053 - t848;
  t3059 = t707 * t2916;
  t3060 = t1048 * t785;
  t3061 = t1026 * t3060;
  t3064 = t718 * t2916;
  t3069 = t1066 * t3040;
  t3074 = 0.2e1 * t2907;
  t3078 = 0.2e1 * t2917;
  t3079 = 0.2e1 * t2919;
  t3080 = t3045 * t380;
  t3081 = t356 * t3080;
  t3082 = t3081 * t1097;
  t3083 = 0.3e1 * t3082;
  t3084 = params->csk_a * t785;
  t3085 = t3084 * t380;
  t3086 = t157 * t3085;
  t3087 = t1964 * t3086;
  t3088 = 0.3e1 * t3087;
  t3089 = t3081 * t1089;
  t3090 = 0.3e1 * t3089;
  t3091 = -t1906 * t3041 - 0.3e1 * t1906 * t3069 + 0.3e1 * t1913 * t3061 + 0.3e1 * t1913 * t3069 - 0.3e1 * t1916 * t3061 + 0.3e1 * t2207 * t1919 + 0.3e1 * t2207 * t1948 + t3059 - t3064 - t3074 + t3078 - t3079 - t3083 + t3088 - t3090 - t794;
  t3093 = my_piecewise5(t58, 0, t61, 0, t3058 + t3091);
  t3095 = 0.5e1 / 0.54e2 * t38 * t48 * t802 - 0.1e2 / 0.81e2 * t3020 + t53 * t3093;
  t3099 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3095);
  tv3sigma2lapl0 = t8 * t3099;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 10] += tv3sigma2lapl10;

  t3104 = t38 * t91 * t885;
  t3107 = t224 * t812;
  t3108 = t1402 * t3107;
  t3113 = t294 * t819;
  t3115 = t217 * t3113 * t557;
  t3116 = t224 * t819;
  t3117 = t546 * t3116;
  t3118 = t758 * t3117;
  t3119 = t2344 * t755;
  t3120 = 0.2e1 * t2959;
  t3121 = 0.2e1 * t2967;
  t3122 = 0.2e1 * t2973;
  t3123 = t564 * t819;
  t3124 = t563 * t3123;
  t3125 = t769 * t3124;
  t3126 = t1418 * t812;
  t3127 = t1415 * t3126;
  t3132 = t758 * t2987;
  t3133 = t1816 * t812;
  t3134 = t1397 * t3133;
  t3139 = -0.2e1 * t2059 * t3108 - 0.3e1 * t2326 * t2062 - t2353 * t2076 + 0.3e1 * t2353 * t2080 + 0.3e1 * t2084 * t3134 - 0.2e1 * t2087 * t3127 + 0.3e1 * t2353 * t2116 - t3115 + t3118 + t3119 + t3120 - t3121 + t3122 - t3125 + t3132 - t876;
  t3140 = t1403 * t812;
  t3141 = t1402 * t3140;
  t3146 = t294 * t812;
  t3147 = t217 * t3146;
  t3148 = t3147 * t1804;
  t3149 = 0.3e1 * t3148;
  t3150 = t2368 * t2103;
  t3151 = 0.3e1 * t3150;
  t3154 = t1436 * t812 * t110 * t224;
  t3159 = t769 * t2987;
  t3162 = 0.2e1 * t2988;
  t3163 = 0.2e1 * t2990;
  t3164 = 0.2e1 * t2995;
  t3165 = t3146 * t555;
  t3166 = t531 * t3165;
  t3167 = t3166 * t1470;
  t3168 = 0.3e1 * t3167;
  t3169 = params->csk_a * t812;
  t3170 = t3169 * t555;
  t3171 = t225 * t3170;
  t3172 = t2129 * t3171;
  t3173 = 0.3e1 * t3172;
  t3174 = t3166 * t1461;
  t3175 = 0.3e1 * t3174;
  t3176 = -t2059 * t3141 - 0.3e1 * t2059 * t3154 + 0.3e1 * t2084 * t3141 + 0.3e1 * t2084 * t3154 - 0.3e1 * t2087 * t3134 - t2087 * t3141 + t3149 + t3151 - t3159 + t3162 - t3163 - t3164 - t3168 + t3173 - t3175 - t821;
  t3178 = my_piecewise5(t102, 0, t103, 0, t3139 + t3176);
  t3180 = 0.5e1 / 0.54e2 * t38 * t96 * t829 - 0.1e2 / 0.81e2 * t3104 + t101 * t3178;
  t3184 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3180);
  tv3sigma2lapl11 = t8 * t3184;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 11] += tv3sigma2lapl11;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 10] += tv3sigma2tau10;

  tv3sigma2tau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 11] += tv3sigma2tau11;

  t3189 = t38 * t43 * t908;
  t3197 = 0.2e1 * t3030;
  t3198 = 0.2e1 * t3031;
  t3199 = 0.2e1 * t3035;
  t3200 = t1048 * t245;
  t3201 = t1026 * t3200;
  t3204 = 0.2e1 * t3053;
  t3205 = 0.2e1 * t3059;
  t3206 = 0.2e1 * t3064;
  t3207 = -0.2e1 * t1031 * t2699 * t849 - 0.3e1 * t2696 * t1565 - t1581 * t2693 + 0.3e1 * t2696 * t3201 + t2867 - t2890 + t2896 - t2907 + t2917 - t2919 + t3197 + t3198 - t3199 - t3204 + t3205 - t3206;
  t3209 = t2741 * t2499 * t1096;
  t3210 = 0.3e1 * t3209;
  t3211 = t2499 * t380;
  t3213 = t2747 * t157 * t3211;
  t3214 = 0.3e1 * t3213;
  t3215 = t2499 * t153;
  t3217 = t2741 * t366 * t3215;
  t3218 = 0.3e1 * t3217;
  t3219 = t1033 * t245;
  t3220 = t1031 * t3219;
  t3226 = t245 * t68 * t156;
  t3227 = t1066 * t3226;
  t3232 = t2735 * t371 * t849 * t153;
  t3233 = 0.3e1 * t3232;
  t3236 = t1044 * t245;
  t3240 = t2723 * t1603;
  t3241 = 0.3e1 * t3240;
  t3248 = -0.2e1 * t1041 * t2702 * t3236 + 0.3e1 * t2702 * t1587 + 0.3e1 * t2702 * t1628 + 0.3e1 * t2696 * t3220 + 0.3e1 * t2696 * t3227 - t2699 * t3220 - 0.3e1 * t2699 * t3227 - 0.3e1 * t2702 * t3201 - t2702 * t3220 - t3210 + t3214 - t3218 + t3233 + t3241 - t794 - t902;
  t3250 = my_piecewise5(t58, 0, t61, 0, t3207 + t3248);
  t3252 = 0.5e1 / 0.27e2 * t38 * t48 * t857 - 0.5e1 / 0.81e2 * t3189 + t53 * t3250;
  t3256 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3252);
  tv3sigmalapl20 = t8 * t3256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 7] += tv3sigmalapl27;

  t3261 = t38 * t91 * t931;
  t3269 = 0.2e1 * t3115;
  t3270 = 0.2e1 * t3118;
  t3271 = 0.2e1 * t3119;
  t3272 = 0.2e1 * t3125;
  t3273 = 0.2e1 * t3132;
  t3274 = 0.2e1 * t3159;
  t3275 = -0.2e1 * t1402 * t2794 * t877 - 0.3e1 * t2797 * t1751 - t1784 * t2803 + t2959 - t2967 + t2973 + t2988 - t2990 - t2995 - t3269 + t3270 + t3271 - t3272 + t3273 - t3274 - t821;
  t3276 = t2617 * t555;
  t3277 = t225 * t3276;
  t3278 = t2850 * t3277;
  t3279 = 0.3e1 * t3278;
  t3280 = t2617 * t221;
  t3282 = t2844 * t541 * t3280;
  t3283 = 0.3e1 * t3282;
  t3285 = t2844 * t2617 * t1469;
  t3286 = 0.3e1 * t3285;
  t3289 = t1403 * t262;
  t3290 = t1402 * t3289;
  t3296 = t262 * t110 * t224;
  t3297 = t1436 * t3296;
  t3300 = t1816 * t262;
  t3301 = t1397 * t3300;
  t3306 = t2826 * t546 * t877 * t221;
  t3307 = 0.3e1 * t3306;
  t3310 = t1418 * t262;
  t3314 = t2838 * t1798;
  t3315 = 0.3e1 * t3314;
  t3320 = -0.2e1 * t1415 * t2808 * t3310 + 0.3e1 * t2808 * t1775 + 0.3e1 * t2808 * t1827 - t2794 * t3290 - 0.3e1 * t2794 * t3297 + 0.3e1 * t2797 * t3290 + 0.3e1 * t2797 * t3297 + 0.3e1 * t2797 * t3301 - t2808 * t3290 - 0.3e1 * t2808 * t3301 + t3279 - t3283 - t3286 + t3307 + t3315 - t925;
  t3322 = my_piecewise5(t102, 0, t103, 0, t3275 + t3320);
  t3324 = 0.5e1 / 0.27e2 * t38 * t96 * t885 - 0.5e1 / 0.81e2 * t3261 + t101 * t3322;
  t3328 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3324);
  tv3sigmalapl28 = t8 * t3328;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 7] += tv3sigmatau27;

  tv3sigmatau28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 8] += tv3sigmatau28;

  t3332 = t895 * t278;
  t3333 = t3332 * t1021;
  t3334 = t1020 * t3333;
  t3338 = t149 * t3333;
  t3340 = t356 * t3333;
  t3353 = t3332 * t380;
  t3354 = t149 * t3353;
  t3355 = t3354 * t1015;
  t3356 = 0.3e1 * t3355;
  t3357 = t3332 * t153;
  t3359 = t356 * t3357 * t1076;
  t3360 = 0.3e1 * t3359;
  t3363 = 0.3e1 * t3030;
  t3364 = 0.3e1 * t3334 * t1027 - t3334 * t1034 - t3338 * t1034 + 0.3e1 * t3340 * t1034 - 0.2e1 * t3334 * t1045 - 0.3e1 * t3334 * t1049 + 0.3e1 * t3340 * t1049 + 0.3e1 * t3334 * t1063 - 0.3e1 * t3338 * t1067 + 0.3e1 * t3340 * t1067 + t3356 + t3360 + t3363;
  t3365 = 0.3e1 * t3031;
  t3366 = 0.3e1 * t3035;
  t3367 = 0.3e1 * t3053;
  t3368 = 0.3e1 * t3059;
  t3369 = 0.3e1 * t3064;
  t3378 = t356 * t3353;
  t3379 = t3378 * t1097;
  t3380 = 0.3e1 * t3379;
  t3381 = t3378 * t1089;
  t3382 = 0.3e1 * t3381;
  t3384 = t149 * t3357 * t1102;
  t3385 = 0.3e1 * t3384;
  t3386 = -t1020 * t1108 * t3332 - 0.2e1 * t1115 * t149 * t3332 - 0.3e1 * t1119 * t3332 * t356 + t3365 - t3366 - t3367 + t3368 - t3369 - t3380 - t3382 + t3385 - t794 - t902;
  t3388 = my_piecewise5(t58, 0, t61, 0, t3364 + t3386);
  t3390 = 0.5e1 / 0.18e2 * t38 * t48 * t908 + t53 * t3388;
  t3394 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3390);
  tv3lapl30 = t8 * t3394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 2] += tv3lapl32;

  t3398 = t918 * t294;
  t3399 = t3398 * t1392;
  t3400 = t531 * t3399;
  t3403 = t1390 * t3399;
  t3412 = t3398 * t221;
  t3414 = t531 * t3412 * t1456;
  t3415 = 0.3e1 * t3414;
  t3416 = t3398 * t555;
  t3417 = t217 * t3416;
  t3418 = t3417 * t1450;
  t3419 = 0.3e1 * t3418;
  t3420 = t217 * t3399;
  t3429 = 0.3e1 * t3115;
  t3430 = 0.3e1 * t3403 * t1398 + 0.3e1 * t3400 * t1404 - t3403 * t1404 - t3420 * t1404 + 0.3e1 * t3400 * t1411 - 0.3e1 * t3403 * t1411 - 0.2e1 * t3403 * t1419 + 0.3e1 * t3403 * t1427 + 0.3e1 * t3400 * t1437 - 0.3e1 * t3420 * t1437 + t3415 + t3419 - t3429;
  t3431 = 0.3e1 * t3118;
  t3432 = 0.3e1 * t3119;
  t3433 = 0.3e1 * t3125;
  t3434 = 0.3e1 * t3132;
  t3435 = 0.3e1 * t3159;
  t3445 = t217 * t3412 * t1475;
  t3446 = 0.3e1 * t3445;
  t3447 = t531 * t3416;
  t3448 = t3447 * t1470;
  t3449 = 0.3e1 * t3448;
  t3450 = t3447 * t1461;
  t3451 = 0.3e1 * t3450;
  t3452 = -t1390 * t1488 * t3398 - 0.2e1 * t1495 * t217 * t3398 - 0.3e1 * t1499 * t3398 * t531 + t3431 + t3432 - t3433 + t3434 - t3435 + t3446 - t3449 - t3451 - t821 - t925;
  t3454 = my_piecewise5(t102, 0, t103, 0, t3430 + t3452);
  t3456 = 0.5e1 / 0.18e2 * t38 * t96 * t931 + t101 * t3454;
  t3460 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3456);
  tv3lapl33 = t8 * t3460;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 5] += tv3lapltau25;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 2] += tv3tau32;

  tv3tau33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 3] += tv3tau33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t41, t43, t45, t48, t53, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t73, t77;
  double t78, t79, t80, t81, t82, t83, t85, t86;
  double t87, t88, t89, t91, t93, t96, t101, t102;
  double t103, t104, t105, t106, t107, t108, t109, t110;
  double t111, t112, t113, t115, t119, tzk0;

  double t120, t121, t122, t123, t124, t127, t128, t132;
  double t133, t136, t139, t141, t147, t149, t150, t151;
  double t153, t154, t156, t157, t158, t160, t162, t167;
  double t169, t172, t173, t177, t180, t182, tvrho0, t185;
  double t186, t189, t190, t195, t197, t200, t201, t207;
  double t209, t215, t217, t218, t219, t221, t222, t224;
  double t225, t226, t228, t230, t235, tvrho1, t238, t241;
  double t244, t245, t248, t250, t254, tvsigma0, tvsigma1, t255;
  double t258, t261, t262, t265, t267, t271, tvsigma2, t277;
  double t278, t281, t283, t287, tvlapl0, t293, t294, t297;
  double t299, t303, tvlapl1, tvtau0, tvtau1;

  double t306, t307, t310, t311, t312, t314, t315, t319;
  double t320, t324, t326, t332, t333, t336, t338, t340;
  double t342, t344, t350, t354, t356, t357, t359, t360;
  double t361, t362, t363, t364, t365, t366, t367, t369;
  double t371, t372, t373, t375, t376, t379, t380, t382;
  double t383, t384, t386, t388, t389, t390, t393, t395;
  double t400, t401, t402, t406, t410, t411, t415, t417;
  double t419, t422, t424, tv2rho20, t427, t430, t431, t435;
  double t436, t440, t442, t450, t451, t454, t458, t459;
  double t463, t465, t472, t475, tv2rho21, t480, t484, t485;
  double t489, t490, t496, t497, t501, t505, t506, t515;
  double t517, t519, t525, t529, t531, t532, t534, t535;
  double t536, t537, t538, t539, t540, t541, t542, t544;
  double t546, t547, t548, t550, t551, t554, t555, t557;
  double t558, t559, t561, t563, t564, t565, t568, t570;
  double t575, tv2rho22, t583, t584, t587, t590, t593, t594;
  double t595, t596, t598, t599, t601, t604, t605, t608;
  double t610, t611, t612, t614, t616, t617, t620, t622;
  double t627, tv2rhosigma0, tv2rhosigma1, t634, t636, tv2rhosigma2, t642, tv2rhosigma3;
  double tv2rhosigma4, t647, t650, t653, t656, t657, t658, t659;
  double t661, t662, t664, t667, t668, t671, t673, t674;
  double t675, t677, t679, t680, t683, t685, t690, tv2rhosigma5;
  double t697, t703, t704, t706, t707, t710, t711, t714;
  double t716, t718, t722, t724, t729, tv2rholapl0, t736, t738;
  double tv2rholapl1, t744, tv2rholapl2, t754, t755, t757, t758, t761;
  double t762, t765, t767, t769, t773, t775, t780, tv2rholapl3;
  double tv2rhotau0, tv2rhotau1, tv2rhotau2, tv2rhotau3, t783, t785, t788, t791;
  double t792, t794, t795, t796, t798, t802, t804, t808;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t810, t812, t815;
  double t818, t819, t821, t822, t823, t825, t829, t831;
  double t835, tv2sigma25, t840, t843, t844, t846, t847, t848;
  double t849, t850, t853, t854, t857, t859, t863, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, t868, t872, t874, t875;
  double t876, t877, t878, t881, t882, t885, t887, t891;
  double tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t895;
  double t898, t901, t902, t904, t908, t910, t914, tv2lapl20;
  double tv2lapl21, t918, t921, t924, t925, t927, t931, t933;
  double t937, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21;
  double tv2tau22;

  double t941, t942, t945, t948, t949, t950, t952, t953;
  double t957, t958, t962, t964, t969, t971, t974, t980;
  double t981, t984, t986, t989, t993, t995, t1001, t1007;
  double t1011, t1012, t1014, t1015, t1016, t1020, t1021, t1022;
  double t1023, t1025, t1026, t1027, t1030, t1031, t1032, t1033;
  double t1034, t1036, t1040, t1041, t1043, t1044, t1045, t1048;
  double t1049, t1054, t1058, t1062, t1063, t1066, t1067, t1070;
  double t1073, t1075, t1076, t1077, t1080, t1081, t1084, t1087;
  double t1089, t1090, t1094, t1096, t1097, t1098, t1101, t1102;
  double t1103, t1106, t1107, t1108, t1110, t1111, t1115, t1119;
  double t1122, t1124, t1126, t1131, t1133, t1134, t1137, t1141;
  double t1145, t1146, t1150, t1152, t1154, t1156, t1158, t1161;
  double t1163, tv3rho30, t1166, t1167, t1168, t1171, t1176, t1177;
  double t1178, t1179, t1183, t1184, t1188, t1191, t1195, t1197;
  double t1201, t1210, t1211, t1212, t1215, t1221, t1225, t1226;
  double t1230, t1233, t1234, t1236, t1245, t1247, t1250, tv3rho31;
  double t1253, t1258, t1261, t1262, t1266, t1267, t1271, t1273;
  double t1282, t1283, t1288, t1292, t1296, t1297, t1301, t1303;
  double t1310, t1318, t1320, t1321, tv3rho32, t1326, t1332, t1333;
  double t1337, t1338, t1345, t1346, t1352, t1356, t1357, t1374;
  double t1376, t1382, t1390, t1391, t1392, t1393, t1394, t1396;
  double t1397, t1398, t1401, t1402, t1403, t1404, t1406, t1410;
  double t1411, t1414, t1415, t1417, t1418, t1419, t1422, t1426;
  double t1427, t1432, t1434, t1436, t1437, t1442, t1446, t1447;
  double t1449, t1450, t1451, t1453, t1455, t1456, t1457, t1459;
  double t1461, t1462, t1464, t1467, t1469, t1470, t1471, t1474;
  double t1475, t1476, t1480, t1486, t1487, t1488, t1490, t1491;
  double t1495, t1499, t1502, t1504, t1506, t1511, tv3rho33, t1519;
  double t1526, t1528, t1530, t1533, t1536, t1539, t1546, t1548;
  double t1550, t1551, t1552, t1555, t1556, t1559, t1560, t1561;
  double t1564, t1565, t1568, t1569, t1570, t1571, t1574, t1575;
  double t1578, t1581, t1582, t1584, t1585, t1587, t1591, t1594;
  double t1597, t1601, t1602, t1603, t1604, t1606, t1609, t1610;
  double t1616, t1617, t1620, t1621, t1623, t1624, t1627, t1628;
  double t1636, t1637, t1638, t1640, t1642, t1643, t1644, t1645;
  double t1646, t1647, t1648, t1651, t1652, t1655, t1657, t1659;
  double t1664, tv3rho2sigma0, tv3rho2sigma1, t1671, t1675, t1677, tv3rho2sigma2, t1683;
  double t1691, tv3rho2sigma3, tv3rho2sigma4, t1697, t1704, t1707, tv3rho2sigma5, t1715;
  double tv3rho2sigma6, tv3rho2sigma7, t1726, t1729, t1732, t1735, t1741, t1742;
  double t1745, t1746, t1747, t1750, t1751, t1754, t1755, t1756;
  double t1757, t1760, t1761, t1766, t1768, t1770, t1771, t1772;
  double t1775, t1778, t1779, t1781, t1784, t1787, t1788, t1791;
  double t1792, t1796, t1797, t1798, t1799, t1801, t1804, t1805;
  double t1809, t1810, t1812, t1813, t1816, t1817, t1818, t1826;
  double t1827, t1832, t1833, t1834, t1836, t1838, t1839, t1840;
  double t1841, t1842, t1843, t1844, t1847, t1848, t1851, t1853;
  double t1855, t1860, tv3rho2sigma8, t1867, t1874, t1876, t1886, t1888;
  double t1890, t1892, t1895, t1896, t1899, t1900, t1902, t1905;
  double t1906, t1909, t1910, t1913, t1916, t1918, t1919, t1925;
  double t1928, t1929, t1930, t1931, t1933, t1935, t1947, t1948;
  double t1956, t1957, t1958, t1960, t1963, t1964, t1965, t1968;
  double t1969, t1972, t1974, t1976, t1981, tv3rho2lapl0, t1988, t1992;
  double t1994, tv3rho2lapl1, t2000, t2008, tv3rho2lapl2, t2014, t2021, t2024;
  double tv3rho2lapl3, t2032, tv3rho2lapl4, t2051, t2053, t2055, t2057, t2058;
  double t2059, t2062, t2065, t2066, t2071, t2072, t2075, t2076;
  double t2079, t2080, t2084, t2087, t2090, t2095, t2098, t2100;
  double t2102, t2103, t2104, t2115, t2116, t2121, t2122, t2123;
  double t2125, t2128, t2129, t2130, t2133, t2134, t2137, t2139;
  double t2141, t2146, tv3rho2lapl5, tv3rho2tau0, tv3rho2tau1, tv3rho2tau2, tv3rho2tau3, tv3rho2tau4;
  double tv3rho2tau5, t2153, t2155, t2158, t2161, t2162, t2163, t2164;
  double t2165, t2166, t2169, t2170, t2171, t2174, t2175, t2180;
  double t2181, t2182, t2183, t2185, t2186, t2187, t2188, t2190;
  double t2191, t2192, t2193, t2195, t2196, t2197, t2198, t2199;
  double t2201, t2202, t2207, t2208, t2209, t2212, t2213, t2216;
  double t2217, t2218, t2219, t2221, t2222, t2224, t2225, t2230;
  double t2231, t2234, t2235, t2236, t2237, t2238, t2240, t2241;
  double t2246, t2249, t2250, t2256, t2257, t2258, t2259, t2262;
  double t2263, t2264, t2265, t2267, t2268, t2269, t2271, t2273;
  double t2275, t2280, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2287;
  double t2289, tv3rhosigma25, t2295, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2301, t2304, t2307, t2308, t2309, t2310, t2312, t2313;
  double t2314, t2315, t2316, t2318, t2319, t2320, t2325, t2326;
  double t2327, t2328, t2331, t2332, t2333, t2334, t2335, t2338;
  double t2339, t2340, t2341, t2343, t2344, t2345, t2347, t2348;
  double t2353, t2354, t2355, t2358, t2359, t2362, t2363, t2366;
  double t2367, t2368, t2369, t2370, t2371, t2373, t2374, t2377;
  double t2378, t2383, t2384, t2385, t2387, t2388, t2392, t2395;
  double t2396, t2402, t2403, t2404, t2405, t2408, t2409, t2410;
  double t2411, t2413, t2414, t2415, t2417, t2419, t2421, t2426;
  double tv3rhosigma211, t2433, t2439, t2442, t2447, t2449, t2450, t2452;
  double t2455, t2456, t2458, t2460, t2461, t2462, t2463, t2464;
  double t2467, t2468, t2476, t2477, t2478, t2480, t2481, t2484;
  double t2485, t2488, t2489, t2490, t2491, t2492, t2495, t2496;
  double t2498, t2499, t2500, t2501, t2504, t2505, t2506, t2507;
  double t2508, t2511, t2515, t2521, t2524, t2525, t2526, t2527;
  double t2529, t2532, t2534, t2536, t2541, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2;
  double tv3rhosigmalapl3, tv3rhosigmalapl4, t2548, t2550, tv3rhosigmalapl5, t2556, tv3rhosigmalapl6, tv3rhosigmalapl7;
  double tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, t2566, t2569, t2576, t2578, t2579;
  double t2581, t2582, t2583, t2585, t2586, t2588, t2589, t2591;
  double t2593, t2594, t2595, t2600, t2601, t2605, t2608, t2611;
  double t2612, t2615, t2616, t2617, t2618, t2619, t2622, t2623;
  double t2624, t2626, t2629, t2630, t2631, t2632, t2633, t2636;
  double t2640, t2643, t2646, t2647, t2648, t2649, t2651, t2656;
  double t2657, t2659, t2661, t2663, t2668, tv3rhosigmalapl11, tv3rhosigmatau0, tv3rhosigmatau1;
  double tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4, tv3rhosigmatau5, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9;
  double tv3rhosigmatau10, tv3rhosigmatau11, t2675, t2681, t2682, t2683, t2685, t2686;
  double t2692, t2693, t2695, t2696, t2699, t2702, t2715, t2716;
  double t2722, t2723, t2724, t2729, t2734, t2735, t2736, t2741;
  double t2742, t2744, t2747, t2748, t2750, t2752, t2754, t2759;
  double tv3rholapl20, tv3rholapl21, t2766, t2768, tv3rholapl22, t2774, tv3rholapl23, tv3rholapl24;
  double t2784, t2785, t2786, t2788, t2789, t2793, t2794, t2797;
  double t2802, t2803, t2808, t2818, t2819, t2820, t2825, t2826;
  double t2827, t2833, t2837, t2838, t2839, t2844, t2845, t2847;
  double t2850, t2851, t2853, t2855, t2857, t2862, tv3rholapl25, tv3rholapltau0;
  double tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rhotau20;
  double tv3rhotau21, tv3rhotau22, tv3rhotau23, tv3rhotau24, tv3rhotau25, t2865, t2867, t2868;
  double t2869, t2870, t2872, t2873, t2874, t2875, t2878, t2882;
  double t2888, t2890, t2891, t2896, t2897, t2900, t2903, t2905;
  double t2906, t2907, t2908, t2909, t2910, t2911, t2913, t2914;
  double t2915, t2916, t2917, t2918, t2919, t2920, t2921, t2922;
  double t2931, t2933, t2935, t2939, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2941, t2943, t2944;
  double t2945, t2948, t2952, t2959, t2960, t2965, t2967, t2968;
  double t2969, t2971, t2972, t2973, t2974, t2975, t2976, t2977;
  double t2978, t2979, t2984, t2985, t2986, t2987, t2988, t2989;
  double t2990, t2991, t2992, t2993, t2994, t2995, t2996, t2997;
  double t2998, t3007, t3009, t3011, t3015, tv3sigma39, t3020, t3024;
  double t3025, t3028, t3029, t3030, t3031, t3033, t3035, t3036;
  double t3037, t3038, t3040, t3041, t3045, t3046, t3047, t3048;
  double t3049, t3050, t3051, t3052, t3053, t3054, t3055, t3058;
  double t3059, t3060, t3061, t3064, t3069, t3074, t3078, t3079;
  double t3080, t3081, t3082, t3083, t3084, t3085, t3086, t3087;
  double t3088, t3089, t3090, t3091, t3093, t3095, t3099, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, t3104, t3107, t3108, t3113, t3115, t3116;
  double t3117, t3118, t3119, t3120, t3121, t3122, t3123, t3124;
  double t3125, t3126, t3127, t3132, t3133, t3134, t3139, t3140;
  double t3141, t3146, t3147, t3148, t3149, t3150, t3151, t3154;
  double t3159, t3162, t3163, t3164, t3165, t3166, t3167, t3168;
  double t3169, t3170, t3171, t3172, t3173, t3174, t3175, t3176;
  double t3178, t3180, t3184, tv3sigma2lapl11, tv3sigma2tau0, tv3sigma2tau1, tv3sigma2tau2, tv3sigma2tau3;
  double tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9, tv3sigma2tau10, tv3sigma2tau11;
  double t3189, t3197, t3198, t3199, t3200, t3201, t3204, t3205;
  double t3206, t3207, t3209, t3210, t3211, t3213, t3214, t3215;
  double t3217, t3218, t3219, t3220, t3226, t3227, t3232, t3233;
  double t3236, t3240, t3241, t3248, t3250, t3252, t3256, tv3sigmalapl20;
  double tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26, tv3sigmalapl27, t3261;
  double t3269, t3270, t3271, t3272, t3273, t3274, t3275, t3276;
  double t3277, t3278, t3279, t3280, t3282, t3283, t3285, t3286;
  double t3289, t3290, t3296, t3297, t3300, t3301, t3306, t3307;
  double t3310, t3314, t3315, t3320, t3322, t3324, t3328, tv3sigmalapl28;
  double tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5, tv3sigmalapltau6, tv3sigmalapltau7;
  double tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmatau20, tv3sigmatau21, tv3sigmatau22, tv3sigmatau23;
  double tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, tv3sigmatau28, t3332, t3333, t3334;
  double t3338, t3340, t3353, t3354, t3355, t3356, t3357, t3359;
  double t3360, t3363, t3364, t3365, t3366, t3367, t3368, t3369;
  double t3378, t3379, t3380, t3381, t3382, t3384, t3385, t3386;
  double t3388, t3390, t3394, tv3lapl30, tv3lapl31, tv3lapl32, t3398, t3399;
  double t3400, t3403, t3412, t3414, t3415, t3416, t3417, t3418;
  double t3419, t3420, t3429, t3430, t3431, t3432, t3433, t3434;
  double t3435, t3445, t3446, t3447, t3448, t3449, t3450, t3451;
  double t3452, t3454, t3456, t3460, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2;
  double tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20, tv3lapltau21, tv3lapltau22, tv3lapltau23, tv3lapltau24;
  double tv3lapltau25, tv3tau30, tv3tau31, tv3tau32, tv3tau33;

  double t3467, t3473, t3487, t3488, t3489, t3498, t3499, t3507;
  double t3508, t3509, t3510, t3511, t3514, t3515, t3519, t3520;
  double t3521, t3522, t3523, t3526, t3529, t3531, t3533, t3534;
  double t3535, t3536, t3537, t3539, t3540, t3543, t3546, t3547;
  double t3549, t3550, t3553, t3555, t3556, t3557, t3560, t3561;
  double t3564, t3566, t3570, t3573, t3575, t3580, t3583, t3590;
  double t3599, t3600, t3603, t3604, t3610, t3614, t3618, t3621;
  double t3623, t3627, t3632, t3636, t3639, t3642, t3645, t3646;
  double t3647, t3648, t3651, t3658, t3659, t3660, t3670, t3671;
  double t3672, t3676, t3680, t3683, t3684, t3685, t3688, t3689;
  double t3696, t3702, t3707, t3710, t3711, t3714, t3716, t3717;
  double t3722, t3723, t3728, t3729, t3735, t3738, t3743, t3746;
  double t3749, t3754, t3755, t3756, t3767, t3768, t3775, t3779;
  double t3787, t3791, t3795, t3798, t3802, t3803, t3805, t3806;
  double t3812, t3819, t3821, t3822, t3826, t3835, t3841, t3844;
  double t3850, t3853, t3856, t3858, t3859, t3860, t3862, t3863;
  double t3869, t3875, t3879, t3886, t3890, t3894, t3899, t3901;
  double tv4rho40, t3907, t3928, t3929, t3930, t3931, t3935, t3944;
  double t3950, t3951, t3954, t3958, t3959, t3962, t3973, t3974;
  double t3992, t3996, t4003, t4007, t4008, t4011, t4020, t4023;
  double t4024, t4026, t4028, t4029, tv4rho41, t4038, t4042, t4045;
  double t4059, t4072, t4076, t4094, t4095, t4104, t4117, t4121;
  double t4128, t4132, t4141, t4144, t4155, t4158, t4160, t4161;
  double tv4rho42, t4181, t4182, t4186, t4193, t4204, t4205, t4222;
  double t4226, t4233, t4241, t4250, t4260, t4262, t4263, tv4rho43;
  double t4268, t4273, t4279, t4280, t4284, t4293, t4311, t4317;
  double t4331, t4332, t4336, t4342, t4343, t4346, t4347, t4348;
  double t4349, t4350, t4353, t4354, t4357, t4358, t4359, t4360;
  double t4361, t4365, t4368, t4369, t4377, t4380, t4382, t4384;
  double t4385, t4386, t4387, t4388, t4390, t4391, t4392, t4395;
  double t4400, t4403, t4404, t4405, t4409, t4413, t4417, t4420;
  double t4422, t4425, t4428, t4432, t4436, t4439, t4440, t4447;
  double t4452, t4454, t4458, t4461, t4462, t4465, t4466, t4472;
  double t4477, t4480, t4486, t4489, t4490, t4494, t4504, t4507;
  double t4508, t4509, t4510, t4514, t4517, t4518, t4519, t4522;
  double t4523, t4526, t4528, t4531, t4532, t4542, t4543, t4550;
  double t4553, t4556, t4558, t4559, t4565, t4566, t4567, t4574;
  double t4575, t4586, t4589, t4592, t4593, t4600, t4616, t4620;
  double t4626, t4631, t4637, t4641, t4651, t4652, tv4rho44, t4660;
  double t4666, t4669, t4676, t4678, t4681, t4683, t4704, t4705;
  double t4713, t4714, t4715, t4718, t4719, t4720, t4722, t4725;
  double t4729, t4734, t4735, t4741, t4742, t4744, t4747, t4748;
  double t4751, t4752, t4753, t4757, t4758, t4764, t4766, t4767;
  double t4770, t4779, t4781, t4787, t4798, t4804, t4808, t4809;
  double t4812, t4813, t4814, t4817, t4818, t4821, t4822, t4823;
  double t4825, t4828, t4830, t4833, t4837, t4839, t4842, t4843;
  double t4844, t4845, t4848, t4853, t4857, t4861, t4864, t4865;
  double t4868, t4872, t4875, t4878, t4882, t4889, t4892, t4895;
  double t4904, t4907, t4910, t4911, t4914, t4927, t4929, t4932;
  double t4938, t4941, t4957, t4960, t4969, t4971, t4976, t4980;
  double t4988, t4991, t4995, t4999, t5000, t5001, t5009, t5016;
  double t5018, t5024, t5027, t5045, t5052, t5058, t5062, t5069;
  double tv4rho3sigma0, tv4rho3sigma1, t5076, t5079, t5083, t5085, tv4rho3sigma2, t5087;
  double t5093, t5098, t5102, t5111, t5112, tv4rho3sigma3, tv4rho3sigma4, t5114;
  double t5120, t5122, t5131, t5133, t5136, tv4rho3sigma5, t5142, t5151;
  double tv4rho3sigma6, tv4rho3sigma7, t5157, t5164, t5172, t5174, t5175, tv4rho3sigma8;
  double t5184, tv4rho3sigma9, tv4rho3sigma10, t5201, t5227, t5228, t5229, t5231;
  double t5234, t5237, t5238, t5241, t5242, t5243, t5248, t5251;
  double t5252, t5253, t5257, t5258, t5260, t5263, t5266, t5272;
  double t5280, t5281, t5284, t5287, t5289, t5290, t5297, t5298;
  double t5304, t5306, t5309, t5318, t5320, t5324, t5325, t5326;
  double t5329, t5332, t5333, t5335, t5338, t5339, t5341, t5344;
  double t5345, t5347, t5354, t5357, t5358, t5359, t5360, t5363;
  double t5364, t5367, t5370, t5377, t5380, t5383, t5384, t5387;
  double t5389, t5392, t5396, t5401, t5402, t5405, t5409, t5415;
  double t5418, t5423, t5424, t5427, t5430, t5432, t5442, t5447;
  double t5449, t5453, t5459, t5468, t5470, t5477, t5485, t5486;
  double t5490, t5491, t5496, t5502, t5505, t5513, t5519, t5526;
  double t5530, t5533, t5538, t5539, t5553, t5559, t5562, t5577;
  double t5581, t5588, tv4rho3sigma11, t5595, t5601, t5604, t5611, t5613;
  double t5616, t5638, t5639, t5640, t5643, t5644, t5647, t5652;
  double t5655, t5656, t5677, t5678, t5681, t5688, t5690, t5693;
  double t5694, t5697, t5706, t5709, t5712, t5713, t5716, t5719;
  double t5722, t5727, t5730, t5731, t5740, t5743, t5744, t5747;
  double t5762, t5765, t5779, t5780, t5783, t5789, t5791, t5794;
  double t5796, t5799, t5802, t5810, t5814, t5824, t5829, t5833;
  double t5841, t5850, t5858, t5859, t5876, t5879, t5880, t5885;
  double t5895, t5898, t5901, t5916, t5920, t5927, tv4rho3lapl0, t5934;
  double t5937, t5941, t5943, tv4rho3lapl1, t5945, t5951, t5956, t5960;
  double t5969, t5970, tv4rho3lapl2, t5972, t5978, t5980, t5989, t5991;
  double t5994, tv4rho3lapl3, t6000, t6009, tv4rho3lapl4, t6015, t6022, t6030;
  double t6032, t6033, tv4rho3lapl5, t6042, tv4rho3lapl6, t6077, t6078, t6082;
  double t6083, t6084, t6087, t6094, t6097, t6098, t6115, t6125;
  double t6129, t6130, t6131, t6136, t6140, t6141, t6148, t6151;
  double t6155, t6156, t6159, t6160, t6163, t6167, t6172, t6175;
  double t6178, t6181, t6182, t6191, t6194, t6195, t6205, t6213;
  double t6220, t6225, t6228, t6235, t6247, t6249, t6252, t6254;
  double t6257, t6264, t6271, t6275, t6279, t6283, t6294, t6298;
  double t6310, t6311, t6314, t6318, t6331, t6334, t6335, t6345;
  double t6355, t6358, t6361, t6371, t6375, t6382, tv4rho3lapl7, tv4rho3tau0;
  double tv4rho3tau1, tv4rho3tau2, tv4rho3tau3, tv4rho3tau4, tv4rho3tau5, tv4rho3tau6, tv4rho3tau7, t6389;
  double t6396, t6398, t6412, t6413, t6414, t6416, t6417, t6418;
  double t6425, t6426, t6429, t6430, t6431, t6432, t6433, t6434;
  double t6437, t6442, t6443, t6446, t6449, t6452, t6454, t6455;
  double t6457, t6461, t6464, t6467, t6472, t6475, t6482, t6489;
  double t6490, t6491, t6494, t6495, t6498, t6500, t6504, t6508;
  double t6509, t6514, t6518, t6532, t6535, t6539, t6540, t6541;
  double t6542, t6545, t6546, t6547, t6550, t6553, t6556, t6559;
  double t6562, t6564, t6568, t6572, t6578, t6580, t6582, t6583;
  double t6584, t6585, t6586, t6588, t6590, t6594, t6598, t6599;
  double t6602, t6604, t6611, t6617, t6619, t6621, t6627, t6632;
  double t6633, t6634, t6641, t6650, t6655, t6660, t6670, t6671;
  double t6673, t6675, t6677, t6679, t6682, t6683, t6687, t6694;
  double t6707, t6709, t6714, t6717, t6727, t6728, t6733, t6734;
  double t6742, t6754, t6757, t6761, t6762, t6763, t6767, t6775;
  double t6776, t6777, t6780, t6781, t6785, t6786, t6788, t6797;
  double t6801, t6806, t6810, t6817, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t6824, t6828, t6830, tv4rho2sigma25, t6836, t6844, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6850, t6857, t6860, tv4rho2sigma211;
  double t6868, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t6891, t6892;
  double t6894, t6895, t6896, t6898, t6903, t6904, t6906, t6907;
  double t6912, t6915, t6916, t6917, t6920, t6923, t6925, t6930;
  double t6933, t6939, t6942, t6945, t6946, t6947, t6948, t6955;
  double t6956, t6971, t6974, t6978, t6982, t6986, t6990, t6991;
  double t6995, t6998, t7005, t7012, t7013, t7014, t7017, t7022;
  double t7023, t7027, t7030, t7033, t7035, t7037, t7038, t7039;
  double t7040, t7041, t7042, t7044, t7045, t7046, t7050, t7053;
  double t7054, t7060, t7061, t7063, t7071, t7073, t7074, t7076;
  double t7085, t7088, t7089, t7096, t7101, t7107, t7114, t7115;
  double t7120, t7132, t7133, t7134, t7136, t7138, t7140, t7142;
  double t7146, t7151, t7173, t7175, t7176, t7181, t7183, t7189;
  double t7190, t7191, t7194, t7197, t7201, t7208, t7209, t7217;
  double t7225, t7229, t7236, t7237, t7241, t7242, t7244, t7245;
  double t7251, t7252, t7253, t7256, t7257, t7258, t7267, t7269;
  double t7272, t7281, t7285, t7292, tv4rho2sigma217, t7299, t7306, t7308;
  double t7334, t7335, t7336, t7341, t7342, t7343, t7344, t7347;
  double t7350, t7351, t7352, t7355, t7356, t7357, t7361, t7365;
  double t7366, t7367, t7368, t7377, t7380, t7381, t7384, t7401;
  double t7406, t7412, t7418, t7429, t7433, t7434, t7445, t7450;
  double t7453, t7454, t7457, t7458, t7466, t7474, t7494, t7498;
  double t7505, t7506, t7513, t7530, t7534, t7563, t7565, t7580;
  double t7581, t7601, t7603, t7608, t7612, t7619, t7623, t7624;
  double t7627, t7630, t7631, t7635, t7636, t7646, t7647, t7651;
  double t7684, t7688, t7695, tv4rho2sigmalapl0, tv4rho2sigmalapl1, tv4rho2sigmalapl2, tv4rho2sigmalapl3, tv4rho2sigmalapl4;
  double t7702, t7706, t7708, tv4rho2sigmalapl5, t7714, t7722, tv4rho2sigmalapl6, tv4rho2sigmalapl7;
  double tv4rho2sigmalapl8, tv4rho2sigmalapl9, tv4rho2sigmalapl10, t7728, t7735, t7738, tv4rho2sigmalapl11, t7746;
  double tv4rho2sigmalapl12, tv4rho2sigmalapl13, tv4rho2sigmalapl14, tv4rho2sigmalapl15, tv4rho2sigmalapl16, t7779, t7780, t7783;
  double t7786, t7787, t7790, t7794, t7797, t7801, t7802, t7805;
  double t7810, t7814, t7815, t7816, t7826, t7827, t7828, t7829;
  double t7832, t7833, t7834, t7836, t7839, t7842, t7844, t7845;
  double t7850, t7851, t7852, t7853, t7860, t7863, t7865, t7868;
  double t7871, t7874, t7875, t7876, t7886, t7902, t7913, t7917;
  double t7918, t7925, t7928, t7942, t7963, t7966, t7975, t7976;
  double t7983, t7988, t8007, t8011, t8028, t8031, t8041, t8067;
  double t8068, t8078, t8082, t8083, t8092, t8093, t8097, t8130;
  double t8134, t8141, tv4rho2sigmalapl17, tv4rho2sigmatau0, tv4rho2sigmatau1, tv4rho2sigmatau2, tv4rho2sigmatau3, tv4rho2sigmatau4;
  double tv4rho2sigmatau5, tv4rho2sigmatau6, tv4rho2sigmatau7, tv4rho2sigmatau8, tv4rho2sigmatau9, tv4rho2sigmatau10, tv4rho2sigmatau11, tv4rho2sigmatau12;
  double tv4rho2sigmatau13, tv4rho2sigmatau14, tv4rho2sigmatau15, tv4rho2sigmatau16, tv4rho2sigmatau17, t8148, t8155, t8157;
  double t8168, t8169, t8170, t8171, t8178, t8185, t8187, t8188;
  double t8191, t8196, t8197, t8200, t8203, t8209, t8210, t8217;
  double t8220, t8231, t8256, t8257, t8263, t8266, t8269, t8270;
  double t8278, t8292, t8293, t8306, t8318, t8334, t8337, t8339;
  double t8345, t8350, t8358, t8365, t8370, t8386, t8388, t8389;
  double t8397, t8398, t8409, t8412, t8413, t8421, t8427, t8437;
  double t8441, t8448, tv4rho2lapl20, tv4rho2lapl21, t8455, t8459, t8461, tv4rho2lapl22;
  double t8467, t8475, tv4rho2lapl23, tv4rho2lapl24, t8481, t8488, t8491, tv4rho2lapl25;
  double t8499, tv4rho2lapl26, tv4rho2lapl27, t8519, t8520, t8521, t8522, t8525;
  double t8532, t8537, t8538, t8542, t8543, t8548, t8549, t8552;
  double t8559, t8562, t8565, t8586, t8588, t8602, t8603, t8607;
  double t8610, t8613, t8616, t8624, t8650, t8652, t8658, t8663;
  double t8668, t8670, t8682, t8686, t8689, t8690, t8695, t8711;
  double t8713, t8730, t8733, t8737, t8744, t8748, t8753, t8756;
  double t8757, t8768, t8770, t8779, t8784, t8788, t8795, tv4rho2lapl28;
  double tv4rho2lapltau0, tv4rho2lapltau1, tv4rho2lapltau2, tv4rho2lapltau3, tv4rho2lapltau4, tv4rho2lapltau5, tv4rho2lapltau6, tv4rho2lapltau7;
  double tv4rho2lapltau8, tv4rho2lapltau9, tv4rho2lapltau10, tv4rho2lapltau11, tv4rho2tau20, tv4rho2tau21, tv4rho2tau22, tv4rho2tau23;
  double tv4rho2tau24, tv4rho2tau25, tv4rho2tau26, tv4rho2tau27, tv4rho2tau28, t8802, t8810, t8811;
  double t8812, t8813, t8815, t8817, t8818, t8820, t8821, t8822;
  double t8824, t8826, t8827, t8828, t8832, t8836, t8839, t8840;
  double t8841, t8844, t8845, t8846, t8847, t8850, t8851, t8854;
  double t8858, t8860, t8861, t8864, t8865, t8866, t8867, t8869;
  double t8872, t8874, t8877, t8878, t8880, t8882, t8884, t8887;
  double t8891, t8893, t8897, t8900, t8902, t8903, t8908, t8909;
  double t8913, t8916, t8920, t8925, t8926, t8927, t8934, t8936;
  double t8939, t8942, t8943, t8946, t8947, t8948, t8951, t8953;
  double t8955, t8958, t8961, t8964, t8965, t8968, t8970, t8975;
  double t8980, t8986, t8991, t8996, t8999, t9004, t9007, t9008;
  double t9019, t9023, t9029, t9036, t9045, t9049, t9051, t9057;
  double t9060, t9063, t9066, t9072, t9090, t9092, t9094, t9102;
  double t9104, t9108, t9115, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34;
  double tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t9122, t9124, tv4rhosigma39, t9130;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t9142, t9143, t9144, t9145, t9147, t9148, t9150;
  double t9152, t9153, t9154, t9155, t9158, t9159, t9160, t9161;
  double t9163, t9164, t9166, t9167, t9168, t9170, t9172, t9173;
  double t9176, t9179, t9180, t9182, t9185, t9187, t9190, t9192;
  double t9194, t9197, t9202, t9205, t9207, t9209, t9210, t9213;
  double t9217, t9218, t9220, t9222, t9223, t9228, t9229, t9231;
  double t9234, t9238, t9241, t9242, t9243, t9244, t9247, t9248;
  double t9249, t9255, t9260, t9262, t9267, t9270, t9273, t9276;
  double t9278, t9281, t9282, t9291, t9292, t9297, t9301, t9305;
  double t9308, t9309, t9316, t9318, t9319, t9322, t9323, t9327;
  double t9330, t9331, t9334, t9336, t9347, t9350, t9353, t9359;
  double t9361, t9363, t9368, t9377, t9378, t9385, t9388, t9393;
  double t9396, t9405, t9411, t9421, t9425, t9429, t9431, t9434;
  double t9438, t9445, tv4rhosigma319, t9452, t9465, t9468, t9469, t9481;
  double t9482, t9483, t9487, t9488, t9491, t9492, t9494, t9496;
  double t9497, t9507, t9509, t9519, t9520, t9528, t9534, t9535;
  double t9539, t9540, t9542, t9544, t9546, t9547, t9548, t9551;
  double t9552, t9555, t9558, t9563, t9564, t9569, t9570, t9575;
  double t9576, t9583, t9591, t9597, t9598, t9602, t9608, t9611;
  double t9613, t9615, t9620, t9622, t9633, t9641, t9643, t9649;
  double t9659, t9660, t9666, t9668, t9678, t9680, t9687, t9697;
  double t9713, t9719, t9720, t9723, t9724, t9727, t9732, t9756;
  double t9765, t9783, t9784, t9787, t9804, t9805, t9809, t9810;
  double t9815, t9822, tv4rhosigma2lapl0, tv4rhosigma2lapl1, tv4rhosigma2lapl2, tv4rhosigma2lapl3, tv4rhosigma2lapl4, tv4rhosigma2lapl5;
  double tv4rhosigma2lapl6, tv4rhosigma2lapl7, tv4rhosigma2lapl8, tv4rhosigma2lapl9, tv4rhosigma2lapl10, t9829, t9831, tv4rhosigma2lapl11;
  double t9837, tv4rhosigma2lapl12, tv4rhosigma2lapl13, tv4rhosigma2lapl14, tv4rhosigma2lapl15, tv4rhosigma2lapl16, tv4rhosigma2lapl17, tv4rhosigma2lapl18;
  double tv4rhosigma2lapl19, tv4rhosigma2lapl20, tv4rhosigma2lapl21, tv4rhosigma2lapl22, t9853, t9854, t9861, t9862;
  double t9864, t9870, t9873, t9878, t9880, t9882, t9883, t9884;
  double t9903, t9905, t9906, t9908, t9909, t9910, t9913, t9919;
  double t9921, t9924, t9926, t9930, t9935, t9936, t9941, t9942;
  double t9943, t9955, t9956, t9959, t9966, t9975, t9976, t9981;
  double t9982, t9983, t9986, t9988, t9992, t9993, t9995, t9997;
  double t10000, t10002, t10011, t10020, t10024, t10025, t10026, t10030;
  double t10034, t10052, t10063, t10070, t10075, t10076, t10077, t10080;
  double t10084, t10097, t10114, t10125, t10130, t10131, t10137, t10155;
  double t10161, t10162, t10164, t10166, t10167, t10191, t10192, t10193;
  double t10195, t10200, t10207, tv4rhosigma2lapl23, tv4rhosigma2tau0, tv4rhosigma2tau1, tv4rhosigma2tau2, tv4rhosigma2tau3;
  double tv4rhosigma2tau4, tv4rhosigma2tau5, tv4rhosigma2tau6, tv4rhosigma2tau7, tv4rhosigma2tau8, tv4rhosigma2tau9, tv4rhosigma2tau10, tv4rhosigma2tau11;
  double tv4rhosigma2tau12, tv4rhosigma2tau13, tv4rhosigma2tau14, tv4rhosigma2tau15, tv4rhosigma2tau16, tv4rhosigma2tau17, tv4rhosigma2tau18, tv4rhosigma2tau19;
  double tv4rhosigma2tau20, tv4rhosigma2tau21, tv4rhosigma2tau22, tv4rhosigma2tau23, t10214, t10226, t10232, t10238;
  double t10242, t10257, t10266, t10267, t10270, t10271, t10272, t10273;
  double t10276, t10279, t10287, t10290, t10291, t10304, t10320, t10321;
  double t10333, t10342, t10344, t10345, t10352, t10353, t10358, t10392;
  double t10404, t10419, t10439, t10446, t10457, t10500, t10513, t10518;
  double t10525, tv4rhosigmalapl20, tv4rhosigmalapl21, tv4rhosigmalapl22, tv4rhosigmalapl23, tv4rhosigmalapl24, tv4rhosigmalapl25, tv4rhosigmalapl26;
  double tv4rhosigmalapl27, t10532, t10534, tv4rhosigmalapl28, t10540, tv4rhosigmalapl29, tv4rhosigmalapl210, tv4rhosigmalapl211;
  double tv4rhosigmalapl212, tv4rhosigmalapl213, tv4rhosigmalapl214, tv4rhosigmalapl215, tv4rhosigmalapl216, t10556, t10560, t10574;
  double t10583, t10588, t10600, t10603, t10604, t10607, t10614, t10615;
  double t10622, t10627, t10628, t10631, t10638, t10639, t10642, t10661;
  double t10669, t10673, t10692, t10693, t10706, t10711, t10714, t10721;
  double t10732, t10749, t10768, t10789, t10830, t10841, t10846, t10853;
  double tv4rhosigmalapl217, tv4rhosigmalapltau0, tv4rhosigmalapltau1, tv4rhosigmalapltau2, tv4rhosigmalapltau3, tv4rhosigmalapltau4, tv4rhosigmalapltau5, tv4rhosigmalapltau6;
  double tv4rhosigmalapltau7, tv4rhosigmalapltau8, tv4rhosigmalapltau9, tv4rhosigmalapltau10, tv4rhosigmalapltau11, tv4rhosigmalapltau12, tv4rhosigmalapltau13, tv4rhosigmalapltau14;
  double tv4rhosigmalapltau15, tv4rhosigmalapltau16, tv4rhosigmalapltau17, tv4rhosigmalapltau18, tv4rhosigmalapltau19, tv4rhosigmalapltau20, tv4rhosigmalapltau21, tv4rhosigmalapltau22;
  double tv4rhosigmalapltau23, tv4rhosigmatau20, tv4rhosigmatau21, tv4rhosigmatau22, tv4rhosigmatau23, tv4rhosigmatau24, tv4rhosigmatau25, tv4rhosigmatau26;
  double tv4rhosigmatau27, tv4rhosigmatau28, tv4rhosigmatau29, tv4rhosigmatau210, tv4rhosigmatau211, tv4rhosigmatau212, tv4rhosigmatau213, tv4rhosigmatau214;
  double tv4rhosigmatau215, tv4rhosigmatau216, tv4rhosigmatau217, t10860, t10867, t10868, t10888, t10891;
  double t10892, t10904, t10910, t10911, t10912, t10915, t10918, t10921;
  double t10938, t10947, t10949, t10957, t10961, t10970, t10974, t10981;
  double t10982, t10984, t10992, t10994, t11004, t11010, t11013, t11014;
  double t11017, t11027, t11041, t11046, t11047, t11050, t11055, t11062;
  double t11067, t11072, t11077, t11082, t11086, t11093, tv4rholapl30, tv4rholapl31;
  double tv4rholapl32, t11100, t11102, tv4rholapl33, t11108, tv4rholapl34, tv4rholapl35, tv4rholapl36;
  double t11131, t11132, t11135, t11137, t11138, t11141, t11143, t11156;
  double t11159, t11171, t11180, t11186, t11188, t11196, t11199, t11208;
  double t11210, t11218, t11222, t11229, t11234, t11235, t11242, t11246;
  double t11255, t11256, t11265, t11266, t11270, t11273, t11276, t11278;
  double t11304, t11307, t11311, t11320, t11330, t11334, t11341, tv4rholapl37;
  double tv4rholapl2tau0, tv4rholapl2tau1, tv4rholapl2tau2, tv4rholapl2tau3, tv4rholapl2tau4, tv4rholapl2tau5, tv4rholapl2tau6, tv4rholapl2tau7;
  double tv4rholapl2tau8, tv4rholapl2tau9, tv4rholapl2tau10, tv4rholapl2tau11, tv4rholapltau20, tv4rholapltau21, tv4rholapltau22, tv4rholapltau23;
  double tv4rholapltau24, tv4rholapltau25, tv4rholapltau26, tv4rholapltau27, tv4rholapltau28, tv4rholapltau29, tv4rholapltau210, tv4rholapltau211;
  double tv4rhotau30, tv4rhotau31, tv4rhotau32, tv4rhotau33, tv4rhotau34, tv4rhotau35, tv4rhotau36, tv4rhotau37;
  double t11358, t11360, t11365, t11366, t11370, t11371, t11374, t11375;
  double t11377, t11379, t11382, t11383, t11385, t11387, t11389, t11391;
  double t11395, t11396, t11398, t11400, t11408, t11410, t11419, t11422;
  double t11423, t11426, t11427, t11429, t11433, t11436, t11441, t11449;
  double t11450, t11452, t11455, t11457, t11458, t11459, t11471, t11472;
  double t11474, t11479, t11483, t11496, t11499, t11507, t11508, t11510;
  double t11522, t11523, t11537, t11540, t11543, t11546, t11550, t11556;
  double tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47;
  double tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t11572, t11574;
  double t11575, t11579, t11580, t11583, t11585, t11589, t11590, t11592;
  double t11596, t11598, t11605, t11609, t11611, t11613, t11615, t11618;
  double t11619, t11621, t11625, t11626, t11630, t11631, t11636, t11637;
  double t11639, t11642, t11643, t11645, t11650, t11655, t11661, t11662;
  double t11664, t11667, t11669, t11672, t11673, t11678, t11683, t11692;
  double t11696, t11708, t11716, t11717, t11726, t11739, t11741, t11742;
  double t11744, t11746, t11749, t11760, t11764, t11770, tv4sigma414, t11777;
  double t11779, t11780, t11782, t11783, t11784, t11785, t11786, t11787;
  double t11788, t11791, t11796, t11798, t11803, t11805, t11811, t11830;
  double t11835, t11842, t11847, t11862, t11863, t11864, t11865, t11870;
  double t11871, t11879, t11893, t11894, t11897, t11900, t11903, t11913;
  double t11914, t11915, t11916, t11917, t11918, t11919, t11920, t11921;
  double t11924, t11925, t11930, t11931, t11932, t11934, t11935, t11936;
  double t11939, t11940, t11941, t11943, t11944, t11947, t11948, t11949;
  double t11950, t11952, t11953, t11957, t11958, t11965, t11981, t11985;
  double t11991, tv4sigma3lapl0, tv4sigma3lapl1, tv4sigma3lapl2, tv4sigma3lapl3, tv4sigma3lapl4, tv4sigma3lapl5, tv4sigma3lapl6;
  double tv4sigma3lapl7, tv4sigma3lapl8, tv4sigma3lapl9, tv4sigma3lapl10, tv4sigma3lapl11, tv4sigma3lapl12, tv4sigma3lapl13, tv4sigma3lapl14;
  double tv4sigma3lapl15, tv4sigma3lapl16, tv4sigma3lapl17, tv4sigma3lapl18, t11998, t11999, t12000, t12001;
  double t12002, t12004, t12005, t12008, t12015, t12020, t12026, t12029;
  double t12031, t12050, t12051, t12054, t12056, t12057, t12060, t12061;
  double t12066, t12067, t12078, t12087, t12091, t12100, t12101, t12105;
  double t12111, t12112, t12113, t12114, t12115, t12116, t12119, t12120;
  double t12121, t12122, t12123, t12124, t12125, t12126, t12127, t12128;
  double t12135, t12136, t12140, t12154, t12161, t12164, t12165, t12166;
  double t12167, t12168, t12170, t12171, t12172, t12173, t12174, t12175;
  double t12176, t12177, t12184, t12200, t12204, t12210, tv4sigma3lapl19, tv4sigma3tau0;
  double tv4sigma3tau1, tv4sigma3tau2, tv4sigma3tau3, tv4sigma3tau4, tv4sigma3tau5, tv4sigma3tau6, tv4sigma3tau7, tv4sigma3tau8;
  double tv4sigma3tau9, tv4sigma3tau10, tv4sigma3tau11, tv4sigma3tau12, tv4sigma3tau13, tv4sigma3tau14, tv4sigma3tau15, tv4sigma3tau16;
  double tv4sigma3tau17, tv4sigma3tau18, tv4sigma3tau19, t12222, t12228, t12233, t12236, t12237;
  double t12245, t12252, t12253, t12259, t12262, t12268, t12269, t12271;
  double t12273, t12274, t12276, t12278, t12280, t12284, t12290, t12298;
  double t12302, t12311, t12317, t12330, t12331, t12336, t12340, t12346;
  double t12348, t12351, t12356, t12371, t12386, t12401, t12403, t12405;
  double t12418, t12425, t12429, t12435, tv4sigma2lapl20, tv4sigma2lapl21, tv4sigma2lapl22, tv4sigma2lapl23;
  double tv4sigma2lapl24, tv4sigma2lapl25, tv4sigma2lapl26, tv4sigma2lapl27, tv4sigma2lapl28, tv4sigma2lapl29, tv4sigma2lapl210, tv4sigma2lapl211;
  double tv4sigma2lapl212, tv4sigma2lapl213, tv4sigma2lapl214, tv4sigma2lapl215, tv4sigma2lapl216, t12448, t12453, t12456;
  double t12461, t12469, t12474, t12475, t12478, t12481, t12485, t12492;
  double t12498, t12504, t12511, t12512, t12514, t12516, t12518, t12519;
  double t12521, t12529, t12531, t12533, t12539, t12544, t12557, t12560;
  double t12563, t12564, t12583, t12599, t12601, t12605, t12618, t12631;
  double t12635, t12637, t12641, t12644, t12653, t12657, t12663, tv4sigma2lapl217;
  double tv4sigma2lapltau0, tv4sigma2lapltau1, tv4sigma2lapltau2, tv4sigma2lapltau3, tv4sigma2lapltau4, tv4sigma2lapltau5, tv4sigma2lapltau6, tv4sigma2lapltau7;
  double tv4sigma2lapltau8, tv4sigma2lapltau9, tv4sigma2lapltau10, tv4sigma2lapltau11, tv4sigma2lapltau12, tv4sigma2lapltau13, tv4sigma2lapltau14, tv4sigma2lapltau15;
  double tv4sigma2lapltau16, tv4sigma2lapltau17, tv4sigma2lapltau18, tv4sigma2lapltau19, tv4sigma2lapltau20, tv4sigma2lapltau21, tv4sigma2lapltau22, tv4sigma2lapltau23;
  double tv4sigma2tau20, tv4sigma2tau21, tv4sigma2tau22, tv4sigma2tau23, tv4sigma2tau24, tv4sigma2tau25, tv4sigma2tau26, tv4sigma2tau27;
  double tv4sigma2tau28, tv4sigma2tau29, tv4sigma2tau210, tv4sigma2tau211, tv4sigma2tau212, tv4sigma2tau213, tv4sigma2tau214, tv4sigma2tau215;
  double tv4sigma2tau216, tv4sigma2tau217, t12670, t12677, t12682, t12686, t12695, t12707;
  double t12712, t12718, t12747, t12760, t12763, t12768, t12774, t12781;
  double t12784, t12792, t12807, t12811, t12815, t12821, tv4sigmalapl30, tv4sigmalapl31;
  double tv4sigmalapl32, tv4sigmalapl33, tv4sigmalapl34, tv4sigmalapl35, tv4sigmalapl36, tv4sigmalapl37, tv4sigmalapl38, tv4sigmalapl39;
  double tv4sigmalapl310, t12828, t12831, t12833, t12844, t12853, t12862, t12866;
  double t12888, t12905, t12918, t12927, t12928, t12933, t12938, t12948;
  double t12966, t12970, t12974, t12980, tv4sigmalapl311, tv4sigmalapl2tau0, tv4sigmalapl2tau1, tv4sigmalapl2tau2;
  double tv4sigmalapl2tau3, tv4sigmalapl2tau4, tv4sigmalapl2tau5, tv4sigmalapl2tau6, tv4sigmalapl2tau7, tv4sigmalapl2tau8, tv4sigmalapl2tau9, tv4sigmalapl2tau10;
  double tv4sigmalapl2tau11, tv4sigmalapl2tau12, tv4sigmalapl2tau13, tv4sigmalapl2tau14, tv4sigmalapl2tau15, tv4sigmalapl2tau16, tv4sigmalapl2tau17, tv4sigmalapltau20;
  double tv4sigmalapltau21, tv4sigmalapltau22, tv4sigmalapltau23, tv4sigmalapltau24, tv4sigmalapltau25, tv4sigmalapltau26, tv4sigmalapltau27, tv4sigmalapltau28;
  double tv4sigmalapltau29, tv4sigmalapltau210, tv4sigmalapltau211, tv4sigmalapltau212, tv4sigmalapltau213, tv4sigmalapltau214, tv4sigmalapltau215, tv4sigmalapltau216;
  double tv4sigmalapltau217, tv4sigmatau30, tv4sigmatau31, tv4sigmatau32, tv4sigmatau33, tv4sigmatau34, tv4sigmatau35, tv4sigmatau36;
  double tv4sigmatau37, tv4sigmatau38, tv4sigmatau39, tv4sigmatau310, tv4sigmatau311, t12984, t12985, t12986;
  double t12992, t12993, t12999, t13024, t13039, t13040, t13043, t13047;
  double t13049, t13056, t13067, t13068, t13106, t13114, t13117, t13136;
  double t13140, t13146, tv4lapl40, tv4lapl41, tv4lapl42, tv4lapl43, t13150, t13152;
  double t13155, t13156, t13168, t13189, t13201, t13202, t13204, t13206;
  double t13209, t13226, t13229, t13230, t13274, t13281, t13289, t13300;
  double t13304, t13310, tv4lapl44, tv4lapl3tau0, tv4lapl3tau1, tv4lapl3tau2, tv4lapl3tau3, tv4lapl3tau4;
  double tv4lapl3tau5, tv4lapl3tau6, tv4lapl3tau7, tv4lapl2tau20, tv4lapl2tau21, tv4lapl2tau22, tv4lapl2tau23, tv4lapl2tau24;
  double tv4lapl2tau25, tv4lapl2tau26, tv4lapl2tau27, tv4lapl2tau28, tv4lapltau30, tv4lapltau31, tv4lapltau32, tv4lapltau33;
  double tv4lapltau34, tv4lapltau35, tv4lapltau36, tv4lapltau37, tv4tau40, tv4tau41, tv4tau42, tv4tau43;
  double tv4tau44;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t19 = t18 * t9;
  t20 = my_piecewise5(t12, t13, t16, t17, t19);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t38 = t33 / t36;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t45 = t38 * sigma[0] * t43;
  t48 = 0.1e1 / t41 / rho[0];
  t53 = 0.5e1 / 0.54e2 * t38 * lapl[0] * t48 - 0.5e1 / 0.81e2 * t45;
  t55 = log(0.1e1 - DBL_EPSILON);
  t56 = 0.1e1 / params->csk_a;
  t57 = pow(-t55, -t56);
  t58 = t53 < -t57;
  t59 = log(DBL_EPSILON);
  t60 = pow(-t59, -t56);
  t61 = -t60 < t53;
  t62 = my_piecewise3(t61, -t60, t53);
  t63 = -t57 < t62;
  t64 = my_piecewise3(t63, t62, -t57);
  t65 = fabs(t64);
  t66 = pow(t65, params->csk_a);
  t67 = 0.1e1 / t66;
  t68 = exp(-t67);
  t69 = 0.1e1 - t68;
  t70 = pow(t69, t56);
  t71 = my_piecewise5(t58, 0, t61, 1, t70);
  t73 = 0.1e1 + 0.5e1 / 0.72e2 * t45 + t53 * t71;
  t77 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = my_piecewise5(t16, t13, t12, t17, -t19);
  t80 = 0.1e1 + t79;
  t81 = t80 <= p->zeta_threshold;
  t82 = POW_1_3(t80);
  t83 = t82 * t82;
  t85 = my_piecewise3(t81, t25, t83 * t80);
  t86 = t85 * t31;
  t87 = rho[1] * rho[1];
  t88 = POW_1_3(rho[1]);
  t89 = t88 * t88;
  t91 = 0.1e1 / t89 / t87;
  t93 = t38 * sigma[2] * t91;
  t96 = 0.1e1 / t89 / rho[1];
  t101 = 0.5e1 / 0.54e2 * t38 * lapl[1] * t96 - 0.5e1 / 0.81e2 * t93;
  t102 = t101 < -t57;
  t103 = -t60 < t101;
  t104 = my_piecewise3(t103, -t60, t101);
  t105 = -t57 < t104;
  t106 = my_piecewise3(t105, t104, -t57);
  t107 = fabs(t106);
  t108 = pow(t107, params->csk_a);
  t109 = 0.1e1 / t108;
  t110 = exp(-t109);
  t111 = 0.1e1 - t110;
  t112 = pow(t111, t56);
  t113 = my_piecewise5(t102, 0, t103, 1, t112);
  t115 = 0.1e1 + 0.5e1 / 0.72e2 * t93 + t101 * t113;
  t119 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t115);
  tzk0 = t77 + t119;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = t8 * t8;
  t121 = 0.1e1 / t120;
  t122 = t18 * t121;
  t123 = t9 - t122;
  t124 = my_piecewise5(t12, 0, t16, 0, t123);
  t127 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t124);
  t128 = t127 * t31;
  t132 = 0.1e1 / t30;
  t133 = t29 * t132;
  t136 = t7 * t133 * t73 / 0.1e2;
  t139 = 0.1e1 / t41 / t39 / rho[0];
  t141 = t38 * sigma[0] * t139;
  t147 = -0.25e2 / 0.162e3 * t38 * lapl[0] * t43 + 0.4e2 / 0.243e3 * t141;
  t149 = t70 * t67;
  t150 = my_piecewise3(t61, 0, t147);
  t151 = my_piecewise3(t63, t150, 0);
  t153 = fabs(t64) / t64;
  t154 = 0.1e1 / t65;
  t156 = 0.1e1 / t69;
  t157 = t68 * t156;
  t158 = t153 * t154 * t157;
  t160 = my_piecewise5(t58, 0, t61, 0, -t149 * t151 * t158);
  t162 = -0.5e1 / 0.27e2 * t141 + t147 * t71 + t53 * t160;
  t167 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t73 + t136 + 0.3e1 / 0.2e2 * t7 * t32 * t162);
  t169 = my_piecewise5(t16, 0, t12, 0, -t123);
  t172 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t169);
  t173 = t172 * t31;
  t177 = t85 * t132;
  t180 = t7 * t177 * t115 / 0.1e2;
  t182 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t115 + t180);
  tvrho0 = t77 + t119 + t8 * (t167 + t182);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t185 = -t9 - t122;
  t186 = my_piecewise5(t12, 0, t16, 0, t185);
  t189 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t186);
  t190 = t189 * t31;
  t195 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t73 + t136);
  t197 = my_piecewise5(t16, 0, t12, 0, -t185);
  t200 = my_piecewise3(t81, 0, 0.5e1 / 0.3e1 * t83 * t197);
  t201 = t200 * t31;
  t207 = 0.1e1 / t89 / t87 / rho[1];
  t209 = t38 * sigma[2] * t207;
  t215 = -0.25e2 / 0.162e3 * t38 * lapl[1] * t91 + 0.4e2 / 0.243e3 * t209;
  t217 = t112 * t109;
  t218 = my_piecewise3(t103, 0, t215);
  t219 = my_piecewise3(t105, t218, 0);
  t221 = fabs(t106) / t106;
  t222 = 0.1e1 / t107;
  t224 = 0.1e1 / t111;
  t225 = t110 * t224;
  t226 = t221 * t222 * t225;
  t228 = my_piecewise5(t102, 0, t103, 0, -t217 * t219 * t226);
  t230 = -0.5e1 / 0.27e2 * t209 + t215 * t113 + t101 * t228;
  t235 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t115 + t180 + 0.3e1 / 0.2e2 * t7 * t86 * t230);
  tvrho1 = t77 + t119 + t8 * (t195 + t235);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t238 = t38 * t43;
  t241 = t38 * t43 * t71;
  t244 = my_piecewise3(t61, 0, -0.5e1 / 0.81e2 * t238);
  t245 = my_piecewise3(t63, t244, 0);
  t248 = my_piecewise5(t58, 0, t61, 0, -t149 * t245 * t158);
  t250 = 0.5e1 / 0.72e2 * t238 - 0.5e1 / 0.81e2 * t241 + t53 * t248;
  t254 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t250);
  tvsigma0 = t8 * t254;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t255 = t38 * t91;
  t258 = t38 * t91 * t113;
  t261 = my_piecewise3(t103, 0, -0.5e1 / 0.81e2 * t255);
  t262 = my_piecewise3(t105, t261, 0);
  t265 = my_piecewise5(t102, 0, t103, 0, -t217 * t262 * t226);
  t267 = 0.5e1 / 0.72e2 * t255 - 0.5e1 / 0.81e2 * t258 + t101 * t265;
  t271 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t267);
  tvsigma2 = t8 * t271;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t277 = my_piecewise3(t61, 0, 0.5e1 / 0.54e2 * t38 * t48);
  t278 = my_piecewise3(t63, t277, 0);
  t281 = my_piecewise5(t58, 0, t61, 0, -t149 * t278 * t158);
  t283 = 0.5e1 / 0.54e2 * t38 * t48 * t71 + t53 * t281;
  t287 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t283);
  tvlapl0 = t8 * t287;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t293 = my_piecewise3(t103, 0, 0.5e1 / 0.54e2 * t38 * t96);
  t294 = my_piecewise3(t105, t293, 0);
  t297 = my_piecewise5(t102, 0, t103, 0, -t217 * t294 * t226);
  t299 = 0.5e1 / 0.54e2 * t38 * t96 * t113 + t101 * t297;
  t303 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t299);
  tvlapl1 = t8 * t303;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t306 = 0.1e1 / t26;
  t307 = t124 * t124;
  t310 = t120 * t8;
  t311 = 0.1e1 / t310;
  t312 = t18 * t311;
  t314 = -0.2e1 * t121 + 0.2e1 * t312;
  t315 = my_piecewise5(t12, 0, t16, 0, t314);
  t319 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t307 + 0.5e1 / 0.3e1 * t27 * t315);
  t320 = t319 * t31;
  t324 = t127 * t132;
  t326 = t7 * t324 * t73;
  t332 = 0.1e1 / t30 / t8;
  t333 = t29 * t332;
  t336 = t7 * t333 * t73 / 0.3e2;
  t338 = t7 * t133 * t162;
  t340 = t39 * t39;
  t342 = 0.1e1 / t41 / t340;
  t344 = t38 * sigma[0] * t342;
  t350 = 0.1e3 / 0.243e3 * t38 * lapl[0] * t139 - 0.44e3 / 0.729e3 * t344;
  t354 = t66 * t66;
  t356 = t70 / t354;
  t357 = t151 * t151;
  t359 = t153 * t153;
  t360 = t65 * t65;
  t361 = 0.1e1 / t360;
  t362 = t359 * t361;
  t363 = t68 * t68;
  t364 = t69 * t69;
  t365 = 0.1e1 / t364;
  t366 = t363 * t365;
  t367 = t362 * t366;
  t369 = t357 * t359;
  t371 = t361 * t68;
  t372 = t156 * params->csk_a;
  t373 = t371 * t372;
  t375 = my_piecewise3(t61, 0, t350);
  t376 = my_piecewise3(t63, t375, 0);
  t379 = t149 * t357;
  t380 = 0.0;
  t382 = t380 * t154 * t157;
  t383 = t379 * t382;
  t384 = t362 * t157;
  t386 = t356 * t369;
  t388 = t361 * t363;
  t389 = t365 * params->csk_a;
  t390 = t388 * t389;
  t393 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t376 + t149 * t369 * t373 + t356 * t357 * t367 - t373 * t386 + t379 * t384 - t386 * t390 - t383);
  t395 = 0.55e2 / 0.81e2 * t344 + t350 * t71 + 0.2e1 * t147 * t160 + t53 * t393;
  t400 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t73 + t326 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t162 - t336 + t338 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t395);
  t401 = 0.1e1 / t82;
  t402 = t169 * t169;
  t406 = my_piecewise5(t16, 0, t12, 0, -t314);
  t410 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t402 + 0.5e1 / 0.3e1 * t83 * t406);
  t411 = t410 * t31;
  t415 = t172 * t132;
  t417 = t7 * t415 * t115;
  t419 = t85 * t332;
  t422 = t7 * t419 * t115 / 0.3e2;
  t424 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t115 + t417 / 0.5e1 - t422);
  tv2rho20 = 0.2e1 * t167 + 0.2e1 * t182 + t8 * (t400 + t424);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t427 = t306 * t186;
  t430 = 0.2e1 * t312;
  t431 = my_piecewise5(t12, 0, t16, 0, t430);
  t435 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t427 * t124 + 0.5e1 / 0.3e1 * t27 * t431);
  t436 = t435 * t31;
  t440 = t189 * t132;
  t442 = t7 * t440 * t73;
  t450 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t73 + t442 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t162 + t326 / 0.1e2 - t336 + t338 / 0.1e2);
  t451 = t401 * t197;
  t454 = my_piecewise5(t16, 0, t12, 0, -t430);
  t458 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t451 * t169 + 0.5e1 / 0.3e1 * t83 * t454);
  t459 = t458 * t31;
  t463 = t200 * t132;
  t465 = t7 * t463 * t115;
  t472 = t7 * t177 * t230;
  t475 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t115 + t465 / 0.1e2 + t417 / 0.1e2 - t422 + 0.3e1 / 0.2e2 * t7 * t173 * t230 + t472 / 0.1e2);
  tv2rho21 = t167 + t182 + t195 + t235 + t8 * (t450 + t475);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t480 = t186 * t186;
  t484 = 0.2e1 * t121 + 0.2e1 * t312;
  t485 = my_piecewise5(t12, 0, t16, 0, t484);
  t489 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t306 * t480 + 0.5e1 / 0.3e1 * t27 * t485);
  t490 = t489 * t31;
  t496 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t73 + t442 / 0.5e1 - t336);
  t497 = t197 * t197;
  t501 = my_piecewise5(t16, 0, t12, 0, -t484);
  t505 = my_piecewise3(t81, 0, 0.1e2 / 0.9e1 * t401 * t497 + 0.5e1 / 0.3e1 * t83 * t501);
  t506 = t505 * t31;
  t515 = t87 * t87;
  t517 = 0.1e1 / t89 / t515;
  t519 = t38 * sigma[2] * t517;
  t525 = 0.1e3 / 0.243e3 * t38 * lapl[1] * t207 - 0.44e3 / 0.729e3 * t519;
  t529 = t108 * t108;
  t531 = t112 / t529;
  t532 = t219 * t219;
  t534 = t221 * t221;
  t535 = t107 * t107;
  t536 = 0.1e1 / t535;
  t537 = t534 * t536;
  t538 = t110 * t110;
  t539 = t111 * t111;
  t540 = 0.1e1 / t539;
  t541 = t538 * t540;
  t542 = t537 * t541;
  t544 = t532 * t534;
  t546 = t536 * t110;
  t547 = t224 * params->csk_a;
  t548 = t546 * t547;
  t550 = my_piecewise3(t103, 0, t525);
  t551 = my_piecewise3(t105, t550, 0);
  t554 = t217 * t532;
  t555 = 0.0;
  t557 = t555 * t222 * t225;
  t558 = t554 * t557;
  t559 = t537 * t225;
  t561 = t531 * t544;
  t563 = t536 * t538;
  t564 = t540 * params->csk_a;
  t565 = t563 * t564;
  t568 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t551 + t217 * t544 * t548 + t531 * t532 * t542 - t548 * t561 + t554 * t559 - t561 * t565 - t558);
  t570 = 0.55e2 / 0.81e2 * t519 + t525 * t113 + 0.2e1 * t215 * t228 + t101 * t568;
  t575 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t115 + t465 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t230 - t422 + t472 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t570);
  tv2rho22 = 0.2e1 * t195 + 0.2e1 * t235 + t8 * (t496 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t7 * t133 * t250 / 0.1e2;
  t584 = t38 * t139;
  t587 = t38 * t139 * t71;
  t590 = t38 * t43 * t160;
  t593 = t151 * t359;
  t594 = t356 * t593;
  t595 = t365 * t245;
  t596 = t388 * t595;
  t598 = t245 * t359;
  t599 = t149 * t598;
  t601 = t371 * t372 * t151;
  t604 = my_piecewise3(t61, 0, 0.4e2 / 0.243e3 * t584);
  t605 = my_piecewise3(t63, t604, 0);
  t608 = t245 * t151;
  t610 = t149 * t608 * t382;
  t611 = t156 * t151;
  t612 = t371 * t611;
  t614 = t356 * t598;
  t616 = t389 * t151;
  t617 = t388 * t616;
  t620 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t605 + t594 * t596 + t599 * t601 + t599 * t612 - t601 * t614 - t614 * t617 - t610);
  t622 = -0.5e1 / 0.27e2 * t584 + 0.4e2 / 0.243e3 * t587 - 0.5e1 / 0.81e2 * t590 + t147 * t248 + t53 * t620;
  t627 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t250 + t583 + 0.3e1 / 0.2e2 * t7 * t32 * t622);
  tv2rhosigma0 = t627 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t634 = t7 * t177 * t267 / 0.1e2;
  t636 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t267 + t634);
  tv2rhosigma2 = t636 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t642 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t250 + t583);
  tv2rhosigma3 = t642 * t8 + t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t647 = t38 * t207;
  t650 = t38 * t207 * t113;
  t653 = t38 * t91 * t228;
  t656 = t219 * t534;
  t657 = t531 * t656;
  t658 = t540 * t262;
  t659 = t563 * t658;
  t661 = t262 * t534;
  t662 = t217 * t661;
  t664 = t546 * t547 * t219;
  t667 = my_piecewise3(t103, 0, 0.4e2 / 0.243e3 * t647);
  t668 = my_piecewise3(t105, t667, 0);
  t671 = t262 * t219;
  t673 = t217 * t671 * t557;
  t674 = t224 * t219;
  t675 = t546 * t674;
  t677 = t531 * t661;
  t679 = t564 * t219;
  t680 = t563 * t679;
  t683 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t668 + t657 * t659 + t662 * t664 + t662 * t675 - t664 * t677 - t677 * t680 - t673);
  t685 = -0.5e1 / 0.27e2 * t647 + 0.4e2 / 0.243e3 * t650 - 0.5e1 / 0.81e2 * t653 + t215 * t265 + t101 * t683;
  t690 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t267 + t634 + 0.3e1 / 0.2e2 * t7 * t86 * t685);
  tv2rhosigma5 = t690 * t8 + t271;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t697 = t7 * t133 * t283 / 0.1e2;
  t703 = t365 * t278;
  t704 = t388 * t703;
  t706 = t278 * t359;
  t707 = t149 * t706;
  t710 = my_piecewise3(t61, 0, -0.25e2 / 0.162e3 * t238);
  t711 = my_piecewise3(t63, t710, 0);
  t714 = t278 * t151;
  t716 = t149 * t714 * t382;
  t718 = t356 * t706;
  t722 = my_piecewise5(t58, 0, t61, 0, -t149 * t158 * t711 + t594 * t704 + t601 * t707 - t601 * t718 + t612 * t707 - t617 * t718 - t716);
  t724 = -0.25e2 / 0.162e3 * t241 + 0.5e1 / 0.54e2 * t38 * t48 * t160 + t147 * t281 + t53 * t722;
  t729 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t283 + t697 + 0.3e1 / 0.2e2 * t7 * t32 * t724);
  tv2rholapl0 = t729 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t736 = t7 * t177 * t299 / 0.1e2;
  t738 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t299 + t736);
  tv2rholapl1 = t738 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  t744 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t283 + t697);
  tv2rholapl2 = t744 * t8 + t287;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  t754 = t540 * t294;
  t755 = t563 * t754;
  t757 = t294 * t534;
  t758 = t217 * t757;
  t761 = my_piecewise3(t103, 0, -0.25e2 / 0.162e3 * t255);
  t762 = my_piecewise3(t105, t761, 0);
  t765 = t294 * t219;
  t767 = t217 * t765 * t557;
  t769 = t531 * t757;
  t773 = my_piecewise5(t102, 0, t103, 0, -t217 * t226 * t762 + t657 * t755 + t664 * t758 - t664 * t769 + t675 * t758 - t680 * t769 - t767);
  t775 = -0.25e2 / 0.162e3 * t258 + 0.5e1 / 0.54e2 * t38 * t96 * t228 + t215 * t297 + t101 * t773;
  t780 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t299 + t736 + 0.3e1 / 0.2e2 * t7 * t86 * t775);
  tv2rholapl3 = t780 * t8 + t303;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t783 = t38 * t43 * t248;
  t785 = t245 * t245;
  t788 = t785 * t359;
  t791 = my_piecewise3(t61, 0, 0);
  t792 = my_piecewise3(t63, t791, 0);
  t794 = t149 * t792 * t158;
  t795 = t149 * t785;
  t796 = t795 * t382;
  t798 = t356 * t788;
  t802 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t788 + t356 * t367 * t785 - t373 * t798 + t384 * t795 - t390 * t798 - t794 - t796);
  t804 = -0.1e2 / 0.81e2 * t783 + t53 * t802;
  t808 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t804);
  tv2sigma20 = t8 * t808;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t810 = t38 * t91 * t265;
  t812 = t262 * t262;
  t815 = t812 * t534;
  t818 = my_piecewise3(t103, 0, 0);
  t819 = my_piecewise3(t105, t818, 0);
  t821 = t217 * t819 * t226;
  t822 = t217 * t812;
  t823 = t822 * t557;
  t825 = t531 * t815;
  t829 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t815 + t531 * t542 * t812 - t548 * t825 + t559 * t822 - t565 * t825 - t821 - t823);
  t831 = -0.1e2 / 0.81e2 * t810 + t101 * t829;
  t835 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t831);
  tv2sigma25 = t8 * t835;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t840 = t38 * t43 * t281;
  t843 = t372 * t245;
  t844 = t371 * t843;
  t846 = t278 * t245;
  t847 = t149 * t846;
  t848 = t847 * t382;
  t849 = t156 * t245;
  t850 = t371 * t849;
  t853 = t389 * t245;
  t854 = t388 * t853;
  t857 = my_piecewise5(t58, 0, t61, 0, t614 * t704 + t707 * t844 + t707 * t850 - t718 * t844 - t718 * t854 - t794 - t848);
  t859 = 0.5e1 / 0.54e2 * t38 * t48 * t248 - 0.5e1 / 0.81e2 * t840 + t53 * t857;
  t863 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t859);
  tv2sigmalapl0 = t8 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  t868 = t38 * t91 * t297;
  t872 = t546 * t547 * t262;
  t874 = t294 * t262;
  t875 = t217 * t874;
  t876 = t875 * t557;
  t877 = t224 * t262;
  t878 = t546 * t877;
  t881 = t564 * t262;
  t882 = t563 * t881;
  t885 = my_piecewise5(t102, 0, t103, 0, t677 * t755 + t758 * t872 + t758 * t878 - t769 * t872 - t769 * t882 - t821 - t876);
  t887 = 0.5e1 / 0.54e2 * t38 * t96 * t265 - 0.5e1 / 0.81e2 * t868 + t101 * t885;
  t891 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t887);
  tv2sigmalapl5 = t8 * t891;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  t895 = t278 * t278;
  t898 = t895 * t359;
  t901 = t149 * t895;
  t902 = t901 * t382;
  t904 = t356 * t898;
  t908 = my_piecewise5(t58, 0, t61, 0, t149 * t373 * t898 + t356 * t367 * t895 - t373 * t904 + t384 * t901 - t390 * t904 - t794 - t902);
  t910 = 0.5e1 / 0.27e2 * t38 * t48 * t281 + t53 * t908;
  t914 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t910);
  tv2lapl20 = t8 * t914;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  t918 = t294 * t294;
  t921 = t918 * t534;
  t924 = t217 * t918;
  t925 = t924 * t557;
  t927 = t531 * t921;
  t931 = my_piecewise5(t102, 0, t103, 0, t217 * t548 * t921 + t531 * t542 * t918 - t548 * t927 + t559 * t924 - t565 * t927 - t821 - t925);
  t933 = 0.5e1 / 0.27e2 * t38 * t96 * t297 + t101 * t931;
  t937 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t933);
  tv2lapl22 = t8 * t937;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

  t941 = 0.1e1 / t26 / t21;
  t942 = t307 * t124;
  t945 = t306 * t124;
  t948 = t120 * t120;
  t949 = 0.1e1 / t948;
  t950 = t18 * t949;
  t952 = 0.6e1 * t311 - 0.6e1 * t950;
  t953 = my_piecewise5(t12, 0, t16, 0, t952);
  t957 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t941 * t942 + 0.1e2 / 0.3e1 * t945 * t315 + 0.5e1 / 0.3e1 * t27 * t953);
  t958 = t957 * t31;
  t962 = t319 * t132;
  t964 = t7 * t962 * t73;
  t969 = t127 * t332;
  t971 = t7 * t969 * t73;
  t974 = t7 * t324 * t162;
  t980 = 0.1e1 / t30 / t120;
  t981 = t29 * t980;
  t984 = 0.2e1 / 0.45e2 * t7 * t981 * t73;
  t986 = t7 * t333 * t162;
  t989 = t7 * t133 * t395;
  t993 = 0.1e1 / t41 / t340 / rho[0];
  t995 = t38 * sigma[0] * t993;
  t1001 = -0.11e4 / 0.729e3 * t38 * lapl[0] * t342 + 0.616e4 / 0.2187e4 * t995;
  t1007 = t376 * t359;
  t1011 = t357 * t151;
  t1012 = t1011 * t380;
  t1014 = t156 * t153;
  t1015 = t371 * t1014;
  t1016 = t149 * t1012 * t1015;
  t1020 = t70 / t354 / t66;
  t1021 = t359 * t153;
  t1022 = t1011 * t1021;
  t1023 = t1020 * t1022;
  t1025 = 0.1e1 / t360 / t65;
  t1026 = t1025 * t363;
  t1027 = t1026 * t389;
  t1030 = t149 * t1022;
  t1031 = t1025 * t68;
  t1032 = params->csk_a * params->csk_a;
  t1033 = t156 * t1032;
  t1034 = t1031 * t1033;
  t1036 = t356 * t1022;
  t1040 = t363 * t68;
  t1041 = t1025 * t1040;
  t1043 = 0.1e1 / t364 / t69;
  t1044 = t1043 * t1032;
  t1045 = t1041 * t1044;
  t1048 = t365 * t1032;
  t1049 = t1026 * t1048;
  t1054 = t149 * t376 * t151 * t382;
  t1058 = t365 * t376;
  t1062 = t1043 * params->csk_a;
  t1063 = t1041 * t1062;
  t1066 = t1025 * params->csk_a;
  t1067 = t1066 * t157;
  t1070 = 0.3e1 * t1007 * t149 * t612 + 0.3e1 * t1058 * t388 * t594 + 0.3e1 * t1023 * t1027 - t1023 * t1034 - 0.2e1 * t1023 * t1045 - 0.3e1 * t1023 * t1049 + 0.3e1 * t1023 * t1063 - t1030 * t1034 + 0.3e1 * t1034 * t1036 + 0.3e1 * t1036 * t1049 + 0.3e1 * t1036 * t1067 + 0.3e1 * t1016 - 0.3e1 * t1054;
  t1073 = t1011 * t153;
  t1075 = t365 * t380;
  t1076 = t388 * t1075;
  t1077 = t356 * t1073 * t1076;
  t1080 = t372 * t376;
  t1081 = t371 * t1080;
  t1084 = t356 * t1007;
  t1087 = t356 * t1012;
  t1089 = t388 * t389 * t153;
  t1090 = t1087 * t1089;
  t1094 = t361 * params->csk_a;
  t1096 = t153 * t68 * t156;
  t1097 = t1094 * t1096;
  t1098 = t1087 * t1097;
  t1101 = t372 * t380;
  t1102 = t371 * t1101;
  t1103 = t149 * t1073 * t1102;
  t1106 = t1021 * t1025;
  t1107 = t1040 * t1043;
  t1108 = t1106 * t1107;
  t1110 = my_piecewise3(t61, 0, t1001);
  t1111 = my_piecewise3(t63, t1110, 0);
  t1115 = t1106 * t157;
  t1119 = t1106 * t366;
  t1122 = -t1011 * t1020 * t1108 - 0.2e1 * t1011 * t1115 * t149 - 0.3e1 * t1011 * t1119 * t356 + 0.3e1 * t1081 * t149 * t593 - t1111 * t149 * t158 - 0.3e1 * t1030 * t1067 - 0.3e1 * t1084 * t601 - 0.3e1 * t1084 * t617 + 0.3e1 * t1077 - 0.3e1 * t1090 - 0.3e1 * t1098 + 0.3e1 * t1103 - t383;
  t1124 = my_piecewise5(t58, 0, t61, 0, t1070 + t1122);
  t1126 = -0.77e3 / 0.243e3 * t995 + t1001 * t71 + 0.3e1 * t350 * t160 + 0.3e1 * t147 * t393 + t53 * t1124;
  t1131 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t958 * t73 + 0.3e1 / 0.1e2 * t964 + 0.9e1 / 0.2e2 * t7 * t320 * t162 - t971 / 0.1e2 + 0.3e1 / 0.5e1 * t974 + 0.9e1 / 0.2e2 * t7 * t128 * t395 + t984 - t986 / 0.1e2 + 0.3e1 / 0.1e2 * t989 + 0.3e1 / 0.2e2 * t7 * t32 * t1126);
  t1133 = 0.1e1 / t82 / t80;
  t1134 = t402 * t169;
  t1137 = t401 * t169;
  t1141 = my_piecewise5(t16, 0, t12, 0, -t952);
  t1145 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1133 * t1134 + 0.1e2 / 0.3e1 * t1137 * t406 + 0.5e1 / 0.3e1 * t83 * t1141);
  t1146 = t1145 * t31;
  t1150 = t410 * t132;
  t1152 = t7 * t1150 * t115;
  t1154 = t172 * t332;
  t1156 = t7 * t1154 * t115;
  t1158 = t85 * t980;
  t1161 = 0.2e1 / 0.45e2 * t7 * t1158 * t115;
  t1163 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1146 * t115 + 0.3e1 / 0.1e2 * t1152 - t1156 / 0.1e2 + t1161);
  tv3rho30 = 0.3e1 * t400 + 0.3e1 * t424 + t8 * (t1131 + t1163);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1166 = 0.2e1 * t450;
  t1167 = 0.2e1 * t475;
  t1168 = t941 * t186;
  t1171 = t306 * t431;
  t1176 = 0.2e1 * t311;
  t1177 = 0.6e1 * t950;
  t1178 = t1176 - t1177;
  t1179 = my_piecewise5(t12, 0, t16, 0, t1178);
  t1183 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1168 * t307 + 0.2e2 / 0.9e1 * t1171 * t124 + 0.1e2 / 0.9e1 * t427 * t315 + 0.5e1 / 0.3e1 * t27 * t1179);
  t1184 = t1183 * t31;
  t1188 = t435 * t132;
  t1191 = t7 * t1188 * t73 / 0.5e1;
  t1195 = t189 * t332;
  t1197 = t7 * t1195 * t73;
  t1201 = t7 * t440 * t162 / 0.5e1;
  t1210 = 0.3e1 / 0.2e2 * t7 * t1184 * t73 + t1191 + 0.3e1 / 0.1e2 * t7 * t436 * t162 - t1197 / 0.3e2 + t1201 + 0.3e1 / 0.2e2 * t7 * t190 * t395 + t964 / 0.1e2 - t971 / 0.15e2 + t974 / 0.5e1 + t984 - t986 / 0.15e2 + t989 / 0.1e2;
  t1211 = my_piecewise3(t2, 0, t1210);
  t1212 = t1133 * t197;
  t1215 = t401 * t454;
  t1221 = my_piecewise5(t16, 0, t12, 0, -t1178);
  t1225 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1212 * t402 + 0.2e2 / 0.9e1 * t1215 * t169 + 0.1e2 / 0.9e1 * t451 * t406 + 0.5e1 / 0.3e1 * t83 * t1221);
  t1226 = t1225 * t31;
  t1230 = t458 * t132;
  t1233 = t7 * t1230 * t115 / 0.5e1;
  t1234 = t200 * t332;
  t1236 = t7 * t1234 * t115;
  t1245 = t7 * t415 * t230 / 0.5e1;
  t1247 = t7 * t419 * t230;
  t1250 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1226 * t115 + t1233 - t1236 / 0.3e2 + t1152 / 0.1e2 - t1156 / 0.15e2 + t1161 + 0.3e1 / 0.2e2 * t7 * t411 * t230 + t1245 - t1247 / 0.3e2);
  tv3rho31 = t400 + t424 + t1166 + t1167 + t8 * (t1211 + t1250);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1253 = t941 * t480;
  t1258 = t306 * t485;
  t1261 = -t1176 - t1177;
  t1262 = my_piecewise5(t12, 0, t16, 0, t1261);
  t1266 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1253 * t124 + 0.2e2 / 0.9e1 * t427 * t431 + 0.1e2 / 0.9e1 * t1258 * t124 + 0.5e1 / 0.3e1 * t27 * t1262);
  t1267 = t1266 * t31;
  t1271 = t489 * t132;
  t1273 = t7 * t1271 * t73;
  t1282 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1267 * t73 + t1273 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t490 * t162 + t1191 - t1197 / 0.15e2 + t1201 - t971 / 0.3e2 + t984 - t986 / 0.3e2);
  t1283 = t1133 * t497;
  t1288 = t401 * t501;
  t1292 = my_piecewise5(t16, 0, t12, 0, -t1261);
  t1296 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1283 * t169 + 0.2e2 / 0.9e1 * t451 * t454 + 0.1e2 / 0.9e1 * t1288 * t169 + 0.5e1 / 0.3e1 * t83 * t1292);
  t1297 = t1296 * t31;
  t1301 = t505 * t132;
  t1303 = t7 * t1301 * t115;
  t1310 = t7 * t463 * t230;
  t1318 = t7 * t177 * t570;
  t1320 = 0.3e1 / 0.2e2 * t7 * t1297 * t115 + t1303 / 0.1e2 + t1233 - t1236 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t459 * t230 + t1310 / 0.5e1 - t1156 / 0.3e2 + t1161 + t1245 - t1247 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t173 * t570 + t1318 / 0.1e2;
  t1321 = my_piecewise3(t78, 0, t1320);
  tv3rho32 = t1166 + t1167 + t496 + t575 + t8 * (t1282 + t1321);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1326 = t480 * t186;
  t1332 = -0.6e1 * t311 - 0.6e1 * t950;
  t1333 = my_piecewise5(t12, 0, t16, 0, t1332);
  t1337 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t941 * t1326 + 0.1e2 / 0.3e1 * t427 * t485 + 0.5e1 / 0.3e1 * t27 * t1333);
  t1338 = t1337 * t31;
  t1345 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1338 * t73 + 0.3e1 / 0.1e2 * t1273 - t1197 / 0.1e2 + t984);
  t1346 = t497 * t197;
  t1352 = my_piecewise5(t16, 0, t12, 0, -t1332);
  t1356 = my_piecewise3(t81, 0, -0.1e2 / 0.27e2 * t1133 * t1346 + 0.1e2 / 0.3e1 * t451 * t501 + 0.5e1 / 0.3e1 * t83 * t1352);
  t1357 = t1356 * t31;
  t1374 = 0.1e1 / t89 / t515 / rho[1];
  t1376 = t38 * sigma[2] * t1374;
  t1382 = -0.11e4 / 0.729e3 * t38 * lapl[1] * t517 + 0.616e4 / 0.2187e4 * t1376;
  t1390 = t112 / t529 / t108;
  t1391 = t532 * t219;
  t1392 = t534 * t221;
  t1393 = t1391 * t1392;
  t1394 = t1390 * t1393;
  t1396 = 0.1e1 / t535 / t107;
  t1397 = t1396 * t538;
  t1398 = t1397 * t564;
  t1401 = t217 * t1393;
  t1402 = t1396 * t110;
  t1403 = t224 * t1032;
  t1404 = t1402 * t1403;
  t1406 = t531 * t1393;
  t1410 = t1396 * t1032;
  t1411 = t1410 * t541;
  t1414 = t538 * t110;
  t1415 = t1396 * t1414;
  t1417 = 0.1e1 / t539 / t111;
  t1418 = t1417 * t1032;
  t1419 = t1415 * t1418;
  t1422 = t540 * t551;
  t1426 = t1417 * params->csk_a;
  t1427 = t1415 * t1426;
  t1432 = t551 * t219;
  t1434 = t217 * t1432 * t557;
  t1436 = t1396 * params->csk_a;
  t1437 = t1436 * t225;
  t1442 = t551 * t534;
  t1446 = 0.3e1 * t1422 * t563 * t657 + 0.3e1 * t1442 * t217 * t675 + 0.3e1 * t1394 * t1398 - t1394 * t1404 - 0.3e1 * t1394 * t1411 - 0.2e1 * t1394 * t1419 + 0.3e1 * t1394 * t1427 - t1401 * t1404 - 0.3e1 * t1401 * t1437 + 0.3e1 * t1404 * t1406 + 0.3e1 * t1406 * t1411 + 0.3e1 * t1406 * t1437 - 0.3e1 * t1434;
  t1447 = t1391 * t555;
  t1449 = t224 * t221;
  t1450 = t546 * t1449;
  t1451 = t217 * t1447 * t1450;
  t1453 = t1391 * t221;
  t1455 = t540 * t555;
  t1456 = t563 * t1455;
  t1457 = t531 * t1453 * t1456;
  t1459 = t531 * t1447;
  t1461 = t563 * t564 * t221;
  t1462 = t1459 * t1461;
  t1464 = t531 * t1442;
  t1467 = t536 * params->csk_a;
  t1469 = t221 * t110 * t224;
  t1470 = t1467 * t1469;
  t1471 = t1459 * t1470;
  t1474 = t547 * t555;
  t1475 = t546 * t1474;
  t1476 = t217 * t1453 * t1475;
  t1480 = t546 * t547 * t551;
  t1486 = t1392 * t1396;
  t1487 = t1414 * t1417;
  t1488 = t1486 * t1487;
  t1490 = my_piecewise3(t103, 0, t1382);
  t1491 = my_piecewise3(t105, t1490, 0);
  t1495 = t1486 * t225;
  t1499 = t1486 * t541;
  t1502 = -t1390 * t1391 * t1488 - 0.2e1 * t1391 * t1495 * t217 - 0.3e1 * t1391 * t1499 * t531 + 0.3e1 * t1480 * t217 * t656 - t1491 * t217 * t226 - 0.3e1 * t1464 * t664 - 0.3e1 * t1464 * t680 + 0.3e1 * t1451 + 0.3e1 * t1457 - 0.3e1 * t1462 - 0.3e1 * t1471 + 0.3e1 * t1476 - t558;
  t1504 = my_piecewise5(t102, 0, t103, 0, t1446 + t1502);
  t1506 = -0.77e3 / 0.243e3 * t1376 + t1382 * t113 + 0.3e1 * t525 * t228 + 0.3e1 * t215 * t568 + t101 * t1504;
  t1511 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1357 * t115 + 0.3e1 / 0.1e2 * t1303 + 0.9e1 / 0.2e2 * t7 * t506 * t230 - t1236 / 0.1e2 + 0.3e1 / 0.5e1 * t1310 + 0.9e1 / 0.2e2 * t7 * t201 * t570 + t1161 - t1247 / 0.1e2 + 0.3e1 / 0.1e2 * t1318 + 0.3e1 / 0.2e2 * t7 * t86 * t1506);
  tv3rho33 = 0.3e1 * t496 + 0.3e1 * t575 + t8 * (t1345 + t1511);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1519 = t7 * t324 * t250;
  t1526 = t7 * t333 * t250 / 0.3e2;
  t1528 = t7 * t133 * t622;
  t1530 = t38 * t342;
  t1533 = t38 * t342 * t71;
  t1536 = t38 * t139 * t160;
  t1539 = t38 * t43 * t393;
  t1546 = t149 * t605 * t151 * t382;
  t1548 = t245 * t376;
  t1550 = t149 * t1548 * t382;
  t1551 = t156 * t376;
  t1552 = t371 * t1551;
  t1555 = t365 * t605;
  t1556 = t388 * t1555;
  t1559 = t357 * t1021;
  t1560 = t1020 * t1559;
  t1561 = t1043 * t245;
  t1564 = t356 * t1559;
  t1565 = t1026 * t595;
  t1568 = t245 * t1021;
  t1569 = t149 * t1568;
  t1570 = t156 * t357;
  t1571 = t1031 * t1570;
  t1574 = t605 * t359;
  t1575 = t149 * t1574;
  t1578 = t356 * t1574;
  t1581 = t1020 * t1568;
  t1582 = t1025 * t1032;
  t1584 = t357 * t68 * t156;
  t1585 = t1582 * t1584;
  t1587 = t1026 * t853;
  t1591 = t356 * t1568;
  t1594 = t1066 * t1584;
  t1597 = -t1041 * t1560 * t1561 + t1084 * t596 + t1552 * t599 + 0.2e1 * t1556 * t594 + 0.3e1 * t1560 * t1587 - 0.3e1 * t1564 * t1565 - 0.2e1 * t1569 * t1571 - t1569 * t1585 + 0.2e1 * t1575 * t612 - 0.2e1 * t1578 * t617 - t1581 * t1585 + 0.3e1 * t1585 * t1591 + 0.3e1 * t1591 * t1594 - 0.2e1 * t1546 - t1550 - t610;
  t1601 = t356 * t357 * t153;
  t1602 = t595 * t380;
  t1603 = t388 * t1602;
  t1604 = t1601 * t1603;
  t1606 = t245 * t357;
  t1609 = t380 * t361 * t1096;
  t1610 = t149 * t1606 * t1609;
  t1616 = t357 * t363 * t365;
  t1617 = t1582 * t1616;
  t1620 = t389 * t376;
  t1621 = t388 * t1620;
  t1623 = t1044 * t357;
  t1624 = t1041 * t1623;
  t1627 = t1561 * params->csk_a;
  t1628 = t1041 * t1627;
  t1636 = t1606 * t380;
  t1637 = t356 * t1636;
  t1638 = t1637 * t1097;
  t1640 = t1637 * t1089;
  t1642 = t245 * t153;
  t1643 = t1642 * t361;
  t1644 = t149 * t1643;
  t1645 = params->csk_a * t357;
  t1646 = t1645 * t380;
  t1647 = t157 * t1646;
  t1648 = t1644 * t1647;
  t1651 = my_piecewise3(t61, 0, -0.44e3 / 0.729e3 * t1530);
  t1652 = my_piecewise3(t63, t1651, 0);
  t1655 = -t149 * t158 * t1652 + t1081 * t599 - t1081 * t614 + 0.3e1 * t1560 * t1628 - 0.3e1 * t1569 * t1594 + 0.2e1 * t1575 * t601 - 0.2e1 * t1578 * t601 - 0.3e1 * t1581 * t1617 - 0.2e1 * t1581 * t1624 + 0.3e1 * t1591 * t1617 - t1621 * t614 + 0.3e1 * t1604 + 0.3e1 * t1610 - 0.3e1 * t1638 - 0.3e1 * t1640 + 0.3e1 * t1648;
  t1657 = my_piecewise5(t58, 0, t61, 0, t1597 + t1655);
  t1659 = 0.55e2 / 0.81e2 * t1530 - 0.44e3 / 0.729e3 * t1533 + 0.8e2 / 0.243e3 * t1536 - 0.5e1 / 0.81e2 * t1539 + t350 * t248 + 0.2e1 * t147 * t620 + t53 * t1657;
  t1664 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t250 + t1519 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t622 - t1526 + t1528 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1659);
  tv3rho2sigma0 = t1664 * t8 + 0.2e1 * t627;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1671 = t7 * t415 * t267;
  t1675 = t7 * t419 * t267 / 0.3e2;
  t1677 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t267 + t1671 / 0.5e1 - t1675);
  tv3rho2sigma2 = t1677 * t8 + 0.2e1 * t636;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1683 = t7 * t440 * t250;
  t1691 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t250 + t1683 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t622 + t1519 / 0.1e2 - t1526 + t1528 / 0.1e2);
  tv3rho2sigma3 = t1691 * t8 + t627 + t642;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1697 = t7 * t463 * t267;
  t1704 = t7 * t177 * t685;
  t1707 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t267 + t1697 / 0.1e2 + t1671 / 0.1e2 - t1675 + 0.3e1 / 0.2e2 * t7 * t173 * t685 + t1704 / 0.1e2);
  tv3rho2sigma5 = t1707 * t8 + t636 + t690;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1715 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t250 + t1683 / 0.5e1 - t1526);
  tv3rho2sigma6 = t1715 * t8 + 0.2e1 * t642;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1726 = t38 * t517;
  t1729 = t38 * t517 * t113;
  t1732 = t38 * t207 * t228;
  t1735 = t38 * t91 * t568;
  t1741 = t540 * t668;
  t1742 = t563 * t1741;
  t1745 = t532 * t1392;
  t1746 = t1390 * t1745;
  t1747 = t1417 * t262;
  t1750 = t531 * t1745;
  t1751 = t1397 * t658;
  t1754 = t262 * t1392;
  t1755 = t217 * t1754;
  t1756 = t224 * t532;
  t1757 = t1402 * t1756;
  t1760 = t668 * t534;
  t1761 = t217 * t1760;
  t1766 = t217 * t668 * t219 * t557;
  t1768 = t262 * t551;
  t1770 = t217 * t1768 * t557;
  t1771 = t224 * t551;
  t1772 = t546 * t1771;
  t1775 = t1397 * t881;
  t1778 = t1403 * t532;
  t1779 = t1402 * t1778;
  t1781 = t531 * t1754;
  t1784 = t1390 * t1754;
  t1787 = t532 * t110 * t224;
  t1788 = t1436 * t1787;
  t1791 = -t1415 * t1746 * t1747 + t1464 * t659 + t1480 * t662 + 0.2e1 * t1742 * t657 + 0.3e1 * t1746 * t1775 - 0.3e1 * t1750 * t1751 - 0.2e1 * t1755 * t1757 - t1755 * t1779 + 0.2e1 * t1761 * t675 + t1772 * t662 + 0.3e1 * t1779 * t1781 - t1779 * t1784 + 0.3e1 * t1781 * t1788 - 0.2e1 * t1766 - t1770 - t673;
  t1792 = t531 * t1760;
  t1796 = t531 * t532 * t221;
  t1797 = t658 * t555;
  t1798 = t563 * t1797;
  t1799 = t1796 * t1798;
  t1801 = t262 * t532;
  t1804 = t555 * t536 * t1469;
  t1805 = t217 * t1801 * t1804;
  t1809 = t564 * t551;
  t1810 = t563 * t1809;
  t1812 = t1418 * t532;
  t1813 = t1415 * t1812;
  t1816 = t540 * t1032;
  t1817 = t1816 * t532;
  t1818 = t1397 * t1817;
  t1826 = t1747 * params->csk_a;
  t1827 = t1415 * t1826;
  t1832 = t1801 * t555;
  t1833 = t531 * t1832;
  t1834 = t1833 * t1470;
  t1836 = t1833 * t1461;
  t1838 = t262 * t221;
  t1839 = t1838 * t536;
  t1840 = t217 * t1839;
  t1841 = params->csk_a * t532;
  t1842 = t1841 * t555;
  t1843 = t225 * t1842;
  t1844 = t1840 * t1843;
  t1847 = my_piecewise3(t103, 0, -0.44e3 / 0.729e3 * t1726);
  t1848 = my_piecewise3(t105, t1847, 0);
  t1851 = -t1848 * t217 * t226 - t1480 * t677 + 0.3e1 * t1746 * t1827 - 0.3e1 * t1755 * t1788 + 0.2e1 * t1761 * t664 + 0.3e1 * t1781 * t1818 - 0.2e1 * t1784 * t1813 - 0.3e1 * t1784 * t1818 - 0.2e1 * t1792 * t664 - 0.2e1 * t1792 * t680 - t1810 * t677 + 0.3e1 * t1799 + 0.3e1 * t1805 - 0.3e1 * t1834 - 0.3e1 * t1836 + 0.3e1 * t1844;
  t1853 = my_piecewise5(t102, 0, t103, 0, t1791 + t1851);
  t1855 = 0.55e2 / 0.81e2 * t1726 - 0.44e3 / 0.729e3 * t1729 + 0.8e2 / 0.243e3 * t1732 - 0.5e1 / 0.81e2 * t1735 + t525 * t265 + 0.2e1 * t215 * t683 + t101 * t1853;
  t1860 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t267 + t1697 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t685 - t1675 + t1704 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t1855);
  tv3rho2sigma8 = t1860 * t8 + 0.2e1 * t690;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1867 = t7 * t324 * t283;
  t1874 = t7 * t333 * t283 / 0.3e2;
  t1876 = t7 * t133 * t724;
  t1886 = t711 * t151;
  t1888 = t149 * t1886 * t382;
  t1890 = t278 * t376;
  t1892 = t149 * t1890 * t382;
  t1895 = t365 * t711;
  t1896 = t388 * t1895;
  t1899 = t1043 * t278;
  t1900 = t1041 * t1899;
  t1902 = t1026 * t703;
  t1905 = t278 * t1021;
  t1906 = t149 * t1905;
  t1909 = t711 * t359;
  t1910 = t149 * t1909;
  t1913 = t356 * t1905;
  t1916 = t1020 * t1905;
  t1918 = t703 * params->csk_a;
  t1919 = t1026 * t1918;
  t1925 = t356 * t1909;
  t1928 = t1084 * t704 + t1552 * t707 - t1560 * t1900 + 0.3e1 * t1560 * t1919 - 0.3e1 * t1564 * t1902 - 0.2e1 * t1571 * t1906 - t1585 * t1906 + 0.3e1 * t1585 * t1913 - t1585 * t1916 + 0.3e1 * t1594 * t1913 + 0.2e1 * t1896 * t594 + 0.2e1 * t1910 * t612 - 0.2e1 * t1925 * t601 - 0.2e1 * t1888 - t1892 - t716;
  t1929 = t703 * t380;
  t1930 = t388 * t1929;
  t1931 = t1601 * t1930;
  t1933 = t278 * t357;
  t1935 = t149 * t1933 * t1609;
  t1947 = t1899 * params->csk_a;
  t1948 = t1041 * t1947;
  t1956 = t1933 * t380;
  t1957 = t356 * t1956;
  t1958 = t1957 * t1097;
  t1960 = t1957 * t1089;
  t1963 = t278 * t153 * t361;
  t1964 = t149 * t1963;
  t1965 = t1964 * t1647;
  t1968 = my_piecewise3(t61, 0, 0.1e3 / 0.243e3 * t584);
  t1969 = my_piecewise3(t63, t1968, 0);
  t1972 = -t149 * t158 * t1969 + t1081 * t707 - t1081 * t718 + 0.3e1 * t1560 * t1948 - 0.3e1 * t1594 * t1906 + 0.3e1 * t1617 * t1913 - 0.3e1 * t1617 * t1916 - t1621 * t718 - 0.2e1 * t1624 * t1916 + 0.2e1 * t1910 * t601 - 0.2e1 * t1925 * t617 + 0.3e1 * t1931 + 0.3e1 * t1935 - 0.3e1 * t1958 - 0.3e1 * t1960 + 0.3e1 * t1965;
  t1974 = my_piecewise5(t58, 0, t61, 0, t1928 + t1972);
  t1976 = 0.1e3 / 0.243e3 * t587 - 0.25e2 / 0.81e2 * t590 + 0.5e1 / 0.54e2 * t38 * t48 * t393 + t350 * t281 + 0.2e1 * t147 * t722 + t53 * t1974;
  t1981 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t283 + t1867 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t724 - t1874 + t1876 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1976);
  tv3rho2lapl0 = t1981 * t8 + 0.2e1 * t729;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  t1988 = t7 * t415 * t299;
  t1992 = t7 * t419 * t299 / 0.3e2;
  t1994 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t299 + t1988 / 0.5e1 - t1992);
  tv3rho2lapl1 = t1994 * t8 + 0.2e1 * t738;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 1] += tv3rho2lapl1;

  t2000 = t7 * t440 * t283;
  t2008 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t283 + t2000 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t724 + t1867 / 0.1e2 - t1874 + t1876 / 0.1e2);
  tv3rho2lapl2 = t2008 * t8 + t729 + t744;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 2] += tv3rho2lapl2;

  t2014 = t7 * t463 * t299;
  t2021 = t7 * t177 * t775;
  t2024 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t299 + t2014 / 0.1e2 + t1988 / 0.1e2 - t1992 + 0.3e1 / 0.2e2 * t7 * t173 * t775 + t2021 / 0.1e2);
  tv3rho2lapl3 = t2024 * t8 + t738 + t780;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 3] += tv3rho2lapl3;

  t2032 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t283 + t2000 / 0.5e1 - t1874);
  tv3rho2lapl4 = t2032 * t8 + 0.2e1 * t744;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 4] += tv3rho2lapl4;

  t2051 = t762 * t219;
  t2053 = t217 * t2051 * t557;
  t2055 = t294 * t551;
  t2057 = t217 * t2055 * t557;
  t2058 = t294 * t1392;
  t2059 = t217 * t2058;
  t2062 = t1397 * t754;
  t2065 = t762 * t534;
  t2066 = t217 * t2065;
  t2071 = t540 * t762;
  t2072 = t563 * t2071;
  t2075 = t1417 * t294;
  t2076 = t1415 * t2075;
  t2079 = t754 * params->csk_a;
  t2080 = t1397 * t2079;
  t2084 = t531 * t2058;
  t2087 = t1390 * t2058;
  t2090 = t1464 * t755 + t1480 * t758 - t1746 * t2076 + 0.3e1 * t1746 * t2080 - 0.3e1 * t1750 * t2062 - 0.2e1 * t1757 * t2059 + t1772 * t758 - t1779 * t2059 + 0.3e1 * t1779 * t2084 - t1779 * t2087 - t1810 * t769 + 0.2e1 * t2066 * t675 + 0.2e1 * t2072 * t657 - 0.2e1 * t2053 - t2057 - t767;
  t2095 = t531 * t2065;
  t2098 = t294 * t532;
  t2100 = t217 * t2098 * t1804;
  t2102 = t754 * t555;
  t2103 = t563 * t2102;
  t2104 = t1796 * t2103;
  t2115 = t2075 * params->csk_a;
  t2116 = t1415 * t2115;
  t2121 = t2098 * t555;
  t2122 = t531 * t2121;
  t2123 = t2122 * t1470;
  t2125 = t2122 * t1461;
  t2128 = t294 * t221 * t536;
  t2129 = t217 * t2128;
  t2130 = t2129 * t1843;
  t2133 = my_piecewise3(t103, 0, 0.1e3 / 0.243e3 * t647);
  t2134 = my_piecewise3(t105, t2133, 0);
  t2137 = -t2134 * t217 * t226 - t1480 * t769 + 0.3e1 * t1746 * t2116 - 0.3e1 * t1788 * t2059 + 0.3e1 * t1788 * t2084 - 0.2e1 * t1813 * t2087 + 0.3e1 * t1818 * t2084 - 0.3e1 * t1818 * t2087 + 0.2e1 * t2066 * t664 - 0.2e1 * t2095 * t664 - 0.2e1 * t2095 * t680 + 0.3e1 * t2100 + 0.3e1 * t2104 - 0.3e1 * t2123 - 0.3e1 * t2125 + 0.3e1 * t2130;
  t2139 = my_piecewise5(t102, 0, t103, 0, t2090 + t2137);
  t2141 = 0.1e3 / 0.243e3 * t650 - 0.25e2 / 0.81e2 * t653 + 0.5e1 / 0.54e2 * t38 * t96 * t568 + t525 * t297 + 0.2e1 * t215 * t773 + t101 * t2139;
  t2146 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t299 + t2014 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t775 - t1992 + t2021 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * t2141);
  tv3rho2lapl5 = t2146 * t8 + 0.2e1 * t780;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 5] += tv3rho2lapl5;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  tv3rho2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 1] += tv3rho2tau1;

  tv3rho2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 2] += tv3rho2tau2;

  tv3rho2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 3] += tv3rho2tau3;

  tv3rho2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 4] += tv3rho2tau4;

  tv3rho2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 5] += tv3rho2tau5;

  t2153 = t7 * t133 * t804 / 0.1e2;
  t2155 = t38 * t139 * t248;
  t2158 = t38 * t43 * t620;
  t2161 = t792 * t359;
  t2162 = t149 * t2161;
  t2163 = t2162 * t612;
  t2164 = t785 * t1021;
  t2165 = t149 * t2164;
  t2166 = t1031 * t611;
  t2169 = t356 * t2164;
  t2170 = t365 * t151;
  t2171 = t1026 * t2170;
  t2174 = t156 * t605;
  t2175 = t371 * t2174;
  t2180 = t151 * t1021;
  t2181 = t1020 * t2180;
  t2182 = t1043 * t785;
  t2183 = t1041 * t2182;
  t2185 = t365 * t792;
  t2186 = t388 * t2185;
  t2187 = t594 * t2186;
  t2188 = t792 * t151;
  t2190 = t149 * t2188 * t382;
  t2191 = t245 * t380;
  t2192 = t149 * t2191;
  t2193 = t154 * t68;
  t2195 = t2192 * t2193 * t2174;
  t2196 = 0.2e1 * t2195;
  t2197 = t2162 * t601;
  t2198 = t356 * t2161;
  t2199 = t2198 * t601;
  t2201 = t151 * t68 * t156;
  t2202 = t1066 * t2201;
  t2207 = t1020 * t2164;
  t2208 = t1044 * t151;
  t2209 = t1041 * t2208;
  t2212 = t1048 * t151;
  t2213 = t1026 * t2212;
  t2216 = t2198 * t617;
  t2217 = 0.2e1 * t614 * t1556 - 0.2e1 * t2165 * t2166 - 0.3e1 * t2165 * t2202 - 0.3e1 * t2169 * t2171 + 0.3e1 * t2169 * t2202 + 0.3e1 * t2169 * t2213 + 0.2e1 * t599 * t2175 - t2181 * t2183 - 0.2e1 * t2207 * t2209 + t2163 + t2187 - t2190 - t2196 + t2197 - t2199 - t2216;
  t2218 = t785 * t380;
  t2219 = t149 * t2218;
  t2221 = t371 * t611 * t153;
  t2222 = t2219 * t2221;
  t2224 = t157 * t605;
  t2225 = t1094 * t2224;
  t2230 = t389 * t605;
  t2231 = t388 * t2230;
  t2234 = t785 * t153;
  t2235 = t356 * t2234;
  t2236 = t2170 * t380;
  t2237 = t388 * t2236;
  t2238 = t2235 * t2237;
  t2240 = t1062 * t151;
  t2241 = t1041 * t2240;
  t2246 = t1026 * t616;
  t2249 = t1033 * t151;
  t2250 = t1031 * t2249;
  t2256 = t356 * t2218 * t361;
  t2257 = params->csk_a * t151;
  t2258 = t2257 * t1096;
  t2259 = t2256 * t2258;
  t2262 = t149 * t2234 * t361;
  t2263 = t2257 * t380;
  t2264 = t157 * t2263;
  t2265 = t2262 * t2264;
  t2267 = t2257 * t153;
  t2268 = t366 * t2267;
  t2269 = t2256 * t2268;
  t2271 = -t2165 * t2250 + 0.3e1 * t2169 * t2250 - 0.3e1 * t2207 * t2213 + 0.3e1 * t2207 * t2241 + 0.3e1 * t2207 * t2246 - t2207 * t2250 + 0.2e1 * t599 * t2225 - 0.2e1 * t614 * t2225 - 0.2e1 * t614 * t2231 + 0.3e1 * t2222 + 0.3e1 * t2238 - 0.3e1 * t2259 + 0.3e1 * t2265 - 0.3e1 * t2269 - t794 - t796;
  t2273 = my_piecewise5(t58, 0, t61, 0, t2217 + t2271);
  t2275 = 0.8e2 / 0.243e3 * t2155 - 0.1e2 / 0.81e2 * t2158 + t147 * t802 + t53 * t2273;
  t2280 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t804 + t2153 + 0.3e1 / 0.2e2 * t7 * t32 * t2275);
  tv3rhosigma20 = t8 * t2280 + t808;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2287 = t7 * t177 * t831 / 0.1e2;
  t2289 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t831 + t2287);
  tv3rhosigma25 = t8 * t2289 + t835;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2295 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t804 + t2153);
  tv3rhosigma26 = t8 * t2295 + t808;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2301 = t38 * t207 * t265;
  t2304 = t38 * t91 * t683;
  t2307 = t540 * t819;
  t2308 = t563 * t2307;
  t2309 = t657 * t2308;
  t2310 = t819 * t219;
  t2312 = t217 * t2310 * t557;
  t2313 = t262 * t555;
  t2314 = t217 * t2313;
  t2315 = t222 * t110;
  t2316 = t224 * t668;
  t2318 = t2314 * t2315 * t2316;
  t2319 = 0.2e1 * t2318;
  t2320 = t546 * t2316;
  t2325 = t812 * t1392;
  t2326 = t531 * t2325;
  t2327 = t540 * t219;
  t2328 = t1397 * t2327;
  t2331 = t819 * t534;
  t2332 = t217 * t2331;
  t2333 = t2332 * t675;
  t2334 = t217 * t2325;
  t2335 = t1402 * t674;
  t2338 = t219 * t1392;
  t2339 = t1390 * t2338;
  t2340 = t1417 * t812;
  t2341 = t1415 * t2340;
  t2343 = t2332 * t664;
  t2344 = t531 * t2331;
  t2345 = t2344 * t664;
  t2347 = t219 * t110 * t224;
  t2348 = t1436 * t2347;
  t2353 = t1390 * t2325;
  t2354 = t541 * t219;
  t2355 = t1410 * t2354;
  t2358 = t564 * t668;
  t2359 = t563 * t2358;
  t2362 = t1418 * t219;
  t2363 = t1415 * t2362;
  t2366 = 0.2e1 * t677 * t1742 + 0.2e1 * t662 * t2320 - 0.3e1 * t2326 * t2328 + 0.3e1 * t2326 * t2348 - 0.2e1 * t2334 * t2335 - 0.3e1 * t2334 * t2348 - t2339 * t2341 - 0.3e1 * t2353 * t2355 - 0.2e1 * t2353 * t2363 - 0.2e1 * t677 * t2359 + t2309 - t2312 - t2319 + t2333 + t2343 - t2345;
  t2367 = t812 * t221;
  t2368 = t531 * t2367;
  t2369 = t2327 * t555;
  t2370 = t563 * t2369;
  t2371 = t2368 * t2370;
  t2373 = t1426 * t219;
  t2374 = t1415 * t2373;
  t2377 = t547 * t668;
  t2378 = t546 * t2377;
  t2383 = t2344 * t680;
  t2384 = t812 * t555;
  t2385 = t217 * t2384;
  t2387 = t546 * t674 * t221;
  t2388 = t2385 * t2387;
  t2392 = t1397 * t679;
  t2395 = t1403 * t219;
  t2396 = t1402 * t2395;
  t2402 = t531 * t2384 * t536;
  t2403 = params->csk_a * t219;
  t2404 = t2403 * t1469;
  t2405 = t2402 * t2404;
  t2408 = t217 * t2367 * t536;
  t2409 = t2403 * t555;
  t2410 = t225 * t2409;
  t2411 = t2408 * t2410;
  t2413 = t2403 * t221;
  t2414 = t541 * t2413;
  t2415 = t2402 * t2414;
  t2417 = 0.3e1 * t2326 * t2355 + 0.3e1 * t2326 * t2396 - t2334 * t2396 + 0.3e1 * t2353 * t2374 + 0.3e1 * t2353 * t2392 - t2353 * t2396 + 0.2e1 * t662 * t2378 - 0.2e1 * t677 * t2378 + 0.3e1 * t2371 - t2383 + 0.3e1 * t2388 - 0.3e1 * t2405 + 0.3e1 * t2411 - 0.3e1 * t2415 - t821 - t823;
  t2419 = my_piecewise5(t102, 0, t103, 0, t2366 + t2417);
  t2421 = 0.8e2 / 0.243e3 * t2301 - 0.1e2 / 0.81e2 * t2304 + t215 * t829 + t101 * t2419;
  t2426 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t831 + t2287 + 0.3e1 / 0.2e2 * t7 * t86 * t2421);
  tv3rhosigma211 = t8 * t2426 + t835;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2433 = t7 * t133 * t859 / 0.1e2;
  t2439 = t38 * t139 * t281;
  t2442 = t38 * t43 * t722;
  t2447 = t711 * t245;
  t2449 = t149 * t2447 * t382;
  t2450 = t278 * t605;
  t2452 = t149 * t2450 * t382;
  t2455 = t157 * params->csk_a;
  t2456 = t608 * t380;
  t2458 = t1964 * t2455 * t2456;
  t2460 = t846 * t380;
  t2461 = t356 * t2460;
  t2462 = t388 * t365;
  t2463 = t2462 * t2267;
  t2464 = t2461 * t2463;
  t2467 = t1094 * t151 * t1096;
  t2468 = t2461 * t2467;
  t2476 = t1578 * t704 + t614 * t1896 + t1910 * t844 + t1910 * t850 - t1925 * t844 - t1925 * t854 + t707 * t2175 + t707 * t2225 - t718 * t2225 - t718 * t2231 + t2163 + t2187 - t2190 - t2449 - t2452 + 0.3e1 * t2458 - 0.3e1 * t2464 - 0.3e1 * t2468 - t848;
  t2477 = t1561 * t278;
  t2478 = t1041 * t2477;
  t2480 = t703 * t151;
  t2481 = t1026 * t2480;
  t2484 = t849 * t151;
  t2485 = t1031 * t2484;
  t2488 = t1905 * t1025;
  t2489 = t356 * t2488;
  t2490 = t1032 * t245;
  t2491 = t2490 * t151;
  t2492 = t366 * t2491;
  t2495 = t149 * t2460;
  t2496 = t2495 * t2221;
  t2498 = t149 * t2488;
  t2499 = params->csk_a * t245;
  t2500 = t2499 * t151;
  t2501 = t157 * t2500;
  t2504 = t1568 * t1025;
  t2505 = t1020 * t2504;
  t2506 = t278 * params->csk_a;
  t2507 = t2506 * t151;
  t2508 = t366 * t2507;
  t2511 = t157 * t2491;
  t2515 = t1020 * t2488;
  t2521 = t1107 * t2491;
  t2524 = t356 * t1643;
  t2525 = t714 * t380;
  t2526 = t366 * t2525;
  t2527 = t2524 * t2526;
  t2529 = t1107 * t2507;
  t2532 = -0.3e1 * t1591 * t2481 - 0.2e1 * t1906 * t2485 - t2181 * t2478 + 0.3e1 * t2489 * t2492 + 0.3e1 * t2489 * t2501 + 0.3e1 * t2489 * t2511 - 0.3e1 * t2515 * t2492 - 0.3e1 * t2498 * t2501 - t2498 * t2511 + 0.3e1 * t2505 * t2508 + 0.3e1 * t2505 * t2529 - t2515 * t2511 - 0.2e1 * t2515 * t2521 + t2197 - t2199 - t2216 + 0.3e1 * t2496 + 0.3e1 * t2527 - t794;
  t2534 = my_piecewise5(t58, 0, t61, 0, t2476 + t2532);
  t2536 = -0.25e2 / 0.162e3 * t783 + 0.5e1 / 0.54e2 * t38 * t48 * t620 + 0.4e2 / 0.243e3 * t2439 - 0.5e1 / 0.81e2 * t2442 + t147 * t857 + t53 * t2534;
  t2541 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t859 + t2433 + 0.3e1 / 0.2e2 * t7 * t32 * t2536);
  tv3rhosigmalapl0 = t8 * t2541 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  t2548 = t7 * t177 * t887 / 0.1e2;
  t2550 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t887 + t2548);
  tv3rhosigmalapl5 = t8 * t2550 + t891;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  t2556 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t859 + t2433);
  tv3rhosigmalapl6 = t8 * t2556 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  t2566 = t38 * t207 * t297;
  t2569 = t38 * t91 * t773;
  t2576 = t762 * t262;
  t2578 = t217 * t2576 * t557;
  t2579 = t294 * t668;
  t2581 = t217 * t2579 * t557;
  t2582 = t874 * t555;
  t2583 = t531 * t2582;
  t2585 = t1467 * t219 * t1469;
  t2586 = t2583 * t2585;
  t2588 = t225 * params->csk_a;
  t2589 = t671 * t555;
  t2591 = t2129 * t2588 * t2589;
  t2593 = t563 * t540;
  t2594 = t2593 * t2413;
  t2595 = t2583 * t2594;
  t2600 = t877 * t219;
  t2601 = t1402 * t2600;
  t2605 = t1397 * t754 * t219;
  t2608 = -0.3e1 * t1781 * t2605 + t1792 * t755 - 0.2e1 * t2059 * t2601 + t2066 * t878 + t677 * t2072 - t2095 * t872 + t758 * t2320 + t758 * t2378 - t769 * t2378 + t2309 - t2312 + t2333 + t2343 - t2578 - t2581 - 0.3e1 * t2586 + 0.3e1 * t2591 - 0.3e1 * t2595 - t876;
  t2611 = t1747 * t294;
  t2612 = t1415 * t2611;
  t2615 = t2058 * t1396;
  t2616 = t217 * t2615;
  t2617 = params->csk_a * t262;
  t2618 = t2617 * t219;
  t2619 = t225 * t2618;
  t2622 = t1032 * t262;
  t2623 = t2622 * t219;
  t2624 = t225 * t2623;
  t2626 = t531 * t2615;
  t2629 = t1754 * t1396;
  t2630 = t1390 * t2629;
  t2631 = t294 * params->csk_a;
  t2632 = t2631 * t219;
  t2633 = t541 * t2632;
  t2636 = t1390 * t2615;
  t2640 = t2622 * t2354;
  t2643 = t1487 * t2623;
  t2646 = t531 * t1839;
  t2647 = t765 * t555;
  t2648 = t541 * t2647;
  t2649 = t2646 * t2648;
  t2651 = t1487 * t2632;
  t2656 = t217 * t2582;
  t2657 = t2656 * t2387;
  t2659 = t2066 * t872 - t2095 * t882 - t2339 * t2612 - t769 * t2359 - 0.3e1 * t2616 * t2619 - t2616 * t2624 + 0.3e1 * t2626 * t2619 + 0.3e1 * t2626 * t2624 - t2636 * t2624 + 0.3e1 * t2626 * t2640 + 0.3e1 * t2630 * t2633 + 0.3e1 * t2630 * t2651 - 0.3e1 * t2636 * t2640 - 0.2e1 * t2636 * t2643 - t2345 - t2383 + 0.3e1 * t2649 + 0.3e1 * t2657 - t821;
  t2661 = my_piecewise5(t102, 0, t103, 0, t2608 + t2659);
  t2663 = -0.25e2 / 0.162e3 * t810 + 0.5e1 / 0.54e2 * t38 * t96 * t683 + 0.4e2 / 0.243e3 * t2566 - 0.5e1 / 0.81e2 * t2569 + t215 * t885 + t101 * t2661;
  t2668 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t887 + t2548 + 0.3e1 / 0.2e2 * t7 * t86 * t2663);
  tv3rhosigmalapl11 = t8 * t2668 + t891;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 4] += tv3rhosigmatau4;

  tv3rhosigmatau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 5] += tv3rhosigmatau5;

  tv3rhosigmatau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 10] += tv3rhosigmatau10;

  tv3rhosigmatau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2675 = t7 * t133 * t910 / 0.1e2;
  t2681 = t278 * t380;
  t2682 = t149 * t2681;
  t2683 = t156 * t711;
  t2685 = t2682 * t2193 * t2683;
  t2686 = 0.2e1 * t2685;
  t2692 = t1043 * t895;
  t2693 = t1041 * t2692;
  t2695 = t895 * t1021;
  t2696 = t356 * t2695;
  t2699 = t149 * t2695;
  t2702 = t1020 * t2695;
  t2715 = 0.2e1 * t2683 * t371 * t707 + 0.2e1 * t718 * t1896 - 0.2e1 * t2699 * t2166 - 0.3e1 * t2696 * t2171 - t2181 * t2693 + 0.3e1 * t2696 * t2202 - 0.3e1 * t2699 * t2202 - 0.3e1 * t2702 * t2213 + 0.3e1 * t2702 * t2246 + 0.3e1 * t2696 * t2250 - t2699 * t2250 - t2702 * t2250 + t2163 + t2187 - t2190 - t2686;
  t2716 = t389 * t711;
  t2722 = t895 * t153;
  t2723 = t356 * t2722;
  t2724 = t2723 * t2237;
  t2729 = t371 * t372 * t711;
  t2734 = t895 * t380;
  t2735 = t149 * t2734;
  t2736 = t2735 * t2221;
  t2741 = t356 * t2734 * t361;
  t2742 = t2741 * t2258;
  t2744 = t2741 * t2268;
  t2747 = t149 * t2722 * t361;
  t2748 = t2747 * t2264;
  t2750 = -0.2e1 * t2716 * t388 * t718 - 0.2e1 * t2702 * t2209 + 0.3e1 * t2696 * t2213 + 0.3e1 * t2702 * t2241 + 0.2e1 * t707 * t2729 - 0.2e1 * t718 * t2729 + t2197 - t2199 - t2216 + 0.3e1 * t2724 + 0.3e1 * t2736 - 0.3e1 * t2742 - 0.3e1 * t2744 + 0.3e1 * t2748 - t794 - t902;
  t2752 = my_piecewise5(t58, 0, t61, 0, t2715 + t2750);
  t2754 = -0.25e2 / 0.81e2 * t840 + 0.5e1 / 0.27e2 * t38 * t48 * t722 + t147 * t908 + t53 * t2752;
  t2759 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t910 + t2675 + 0.3e1 / 0.2e2 * t7 * t32 * t2754);
  tv3rholapl20 = t8 * t2759 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 1] += tv3rholapl21;

  t2766 = t7 * t177 * t933 / 0.1e2;
  t2768 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t933 + t2766);
  tv3rholapl22 = t8 * t2768 + t937;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 2] += tv3rholapl22;

  t2774 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t910 + t2675);
  tv3rholapl23 = t8 * t2774 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 4] += tv3rholapl24;

  t2784 = t294 * t555;
  t2785 = t217 * t2784;
  t2786 = t224 * t762;
  t2788 = t2785 * t2315 * t2786;
  t2789 = 0.2e1 * t2788;
  t2793 = t918 * t1392;
  t2794 = t217 * t2793;
  t2797 = t531 * t2793;
  t2802 = t1417 * t918;
  t2803 = t1415 * t2802;
  t2808 = t1390 * t2793;
  t2818 = 0.2e1 * t2786 * t546 * t758 + 0.2e1 * t769 * t2072 - 0.3e1 * t2797 * t2328 - 0.2e1 * t2794 * t2335 - t2339 * t2803 - 0.3e1 * t2794 * t2348 + 0.3e1 * t2797 * t2348 - 0.2e1 * t2808 * t2363 + 0.3e1 * t2808 * t2374 - t2794 * t2396 + 0.3e1 * t2797 * t2396 - t2808 * t2396 + t2309 - t2312 + t2333 - t2789;
  t2819 = t547 * t762;
  t2820 = t546 * t2819;
  t2825 = t918 * t555;
  t2826 = t217 * t2825;
  t2827 = t2826 * t2387;
  t2833 = t564 * t762;
  t2837 = t918 * t221;
  t2838 = t531 * t2837;
  t2839 = t2838 * t2370;
  t2844 = t531 * t2825 * t536;
  t2845 = t2844 * t2414;
  t2847 = t2844 * t2404;
  t2850 = t217 * t2837 * t536;
  t2851 = t2850 * t2410;
  t2853 = -0.2e1 * t2833 * t563 * t769 + 0.3e1 * t2797 * t2355 - 0.3e1 * t2808 * t2355 + 0.3e1 * t2808 * t2392 + 0.2e1 * t758 * t2820 - 0.2e1 * t769 * t2820 + t2343 - t2345 - t2383 + 0.3e1 * t2827 + 0.3e1 * t2839 - 0.3e1 * t2845 - 0.3e1 * t2847 + 0.3e1 * t2851 - t821 - t925;
  t2855 = my_piecewise5(t102, 0, t103, 0, t2818 + t2853);
  t2857 = -0.25e2 / 0.81e2 * t868 + 0.5e1 / 0.27e2 * t38 * t96 * t773 + t215 * t931 + t101 * t2855;
  t2862 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t933 + t2766 + 0.3e1 / 0.2e2 * t7 * t86 * t2857);
  tv3rholapl25 = t8 * t2862 + t937;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 7] += tv3rholapltau7;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 1] += tv3rhotau21;

  tv3rhotau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 2] += tv3rhotau22;

  tv3rhotau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 4] += tv3rhotau24;

  tv3rhotau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 5] += tv3rhotau25;

  t2865 = t38 * t43 * t802;
  t2867 = t2162 * t850;
  t2868 = 0.3e1 * t2867;
  t2869 = t785 * t245;
  t2870 = t2869 * t380;
  t2872 = t149 * t2870 * t1015;
  t2873 = 0.3e1 * t2872;
  t2874 = t2869 * t1021;
  t2875 = t356 * t2874;
  t2878 = t1020 * t2874;
  t2882 = t149 * t2874;
  t2888 = t792 * t245;
  t2890 = t149 * t2888 * t382;
  t2891 = 0.3e1 * t2890;
  t2896 = t614 * t2186;
  t2897 = 0.3e1 * t2896;
  t2900 = 0.3e1 * t2878 * t1027 + 0.3e1 * t2875 * t1034 - t2878 * t1034 - t2882 * t1034 - 0.2e1 * t2878 * t1045 - 0.3e1 * t2878 * t1049 + 0.3e1 * t2878 * t1063 + 0.3e1 * t2875 * t1067 - 0.3e1 * t2882 * t1067 + t2868 + t2873 - t2891 + t2897;
  t2903 = t2869 * t153;
  t2905 = t356 * t2903 * t1076;
  t2906 = 0.3e1 * t2905;
  t2907 = t2198 * t844;
  t2908 = 0.3e1 * t2907;
  t2909 = t356 * t2870;
  t2910 = t2909 * t1097;
  t2911 = 0.3e1 * t2910;
  t2913 = t149 * t2903 * t1102;
  t2914 = 0.3e1 * t2913;
  t2915 = t372 * t792;
  t2916 = t371 * t2915;
  t2917 = t599 * t2916;
  t2918 = 0.3e1 * t2917;
  t2919 = t2198 * t854;
  t2920 = 0.3e1 * t2919;
  t2921 = t2909 * t1089;
  t2922 = 0.3e1 * t2921;
  t2931 = -t1020 * t1108 * t2869 - 0.2e1 * t1115 * t149 * t2869 - 0.3e1 * t1119 * t2869 * t356 + 0.3e1 * t2875 * t1049 + t2906 - t2908 - t2911 + t2914 + t2918 - t2920 - t2922 - t794 - t796;
  t2933 = my_piecewise5(t58, 0, t61, 0, t2900 + t2931);
  t2935 = -0.5e1 / 0.27e2 * t2865 + t53 * t2933;
  t2939 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t2935);
  tv3sigma30 = t8 * t2939;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2941 = t38 * t91 * t829;
  t2943 = t812 * t262;
  t2944 = t2943 * t1392;
  t2945 = t531 * t2944;
  t2948 = t1390 * t2944;
  t2952 = t217 * t2944;
  t2959 = t677 * t2308;
  t2960 = 0.3e1 * t2959;
  t2965 = t819 * t262;
  t2967 = t217 * t2965 * t557;
  t2968 = 0.3e1 * t2967;
  t2969 = t2943 * t221;
  t2971 = t531 * t2969 * t1456;
  t2972 = 0.3e1 * t2971;
  t2973 = t2332 * t878;
  t2974 = 0.3e1 * t2973;
  t2975 = t2943 * t555;
  t2976 = t217 * t2975;
  t2977 = t2976 * t1450;
  t2978 = 0.3e1 * t2977;
  t2979 = 0.3e1 * t2945 * t1404 - t2948 * t1404 + 0.3e1 * t2945 * t1411 - 0.3e1 * t2948 * t1411 - 0.2e1 * t2948 * t1419 + 0.3e1 * t2948 * t1427 + 0.3e1 * t2945 * t1437 - 0.3e1 * t2952 * t1437 + t2960 - t2968 + t2972 + t2974 + t2978;
  t2984 = t217 * t2969 * t1475;
  t2985 = 0.3e1 * t2984;
  t2986 = t547 * t819;
  t2987 = t546 * t2986;
  t2988 = t662 * t2987;
  t2989 = 0.3e1 * t2988;
  t2990 = t2344 * t882;
  t2991 = 0.3e1 * t2990;
  t2992 = t531 * t2975;
  t2993 = t2992 * t1461;
  t2994 = 0.3e1 * t2993;
  t2995 = t2344 * t872;
  t2996 = 0.3e1 * t2995;
  t2997 = t2992 * t1470;
  t2998 = 0.3e1 * t2997;
  t3007 = -t1390 * t1488 * t2943 - 0.2e1 * t1495 * t217 * t2943 - 0.3e1 * t1499 * t2943 * t531 + 0.3e1 * t2948 * t1398 - t2952 * t1404 + t2985 + t2989 - t2991 - t2994 - t2996 - t2998 - t821 - t823;
  t3009 = my_piecewise5(t102, 0, t103, 0, t2979 + t3007);
  t3011 = -0.5e1 / 0.27e2 * t2941 + t101 * t3009;
  t3015 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3011);
  tv3sigma39 = t8 * t3015;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3020 = t38 * t43 * t857;
  t3024 = t156 * t785;
  t3025 = t1031 * t3024;
  t3028 = t156 * t792;
  t3029 = t371 * t3028;
  t3030 = t707 * t3029;
  t3031 = t2198 * t704;
  t3033 = t278 * t792;
  t3035 = t149 * t3033 * t382;
  t3036 = 0.2e1 * t2867;
  t3037 = 0.2e1 * t2890;
  t3038 = 0.2e1 * t2896;
  t3040 = t785 * t68 * t156;
  t3041 = t1582 * t3040;
  t3045 = t278 * t785;
  t3046 = t149 * t3045;
  t3047 = t3046 * t1609;
  t3048 = 0.3e1 * t3047;
  t3049 = t2235 * t1930;
  t3050 = 0.3e1 * t3049;
  t3051 = t389 * t792;
  t3052 = t388 * t3051;
  t3053 = t718 * t3052;
  t3054 = t1044 * t785;
  t3055 = t1041 * t3054;
  t3058 = -t2207 * t1900 - 0.3e1 * t2169 * t1902 - 0.2e1 * t1906 * t3025 + 0.3e1 * t1913 * t3041 - t1916 * t3041 - 0.2e1 * t1916 * t3055 + t3030 + t3031 - t3035 + t3036 - t3037 + t3038 + t3048 + t3050 - t3053 - t848;
  t3059 = t707 * t2916;
  t3060 = t1048 * t785;
  t3061 = t1026 * t3060;
  t3064 = t718 * t2916;
  t3069 = t1066 * t3040;
  t3074 = 0.2e1 * t2907;
  t3078 = 0.2e1 * t2917;
  t3079 = 0.2e1 * t2919;
  t3080 = t3045 * t380;
  t3081 = t356 * t3080;
  t3082 = t3081 * t1097;
  t3083 = 0.3e1 * t3082;
  t3084 = params->csk_a * t785;
  t3085 = t3084 * t380;
  t3086 = t157 * t3085;
  t3087 = t1964 * t3086;
  t3088 = 0.3e1 * t3087;
  t3089 = t3081 * t1089;
  t3090 = 0.3e1 * t3089;
  t3091 = -t1906 * t3041 - 0.3e1 * t1906 * t3069 + 0.3e1 * t1913 * t3061 + 0.3e1 * t1913 * t3069 - 0.3e1 * t1916 * t3061 + 0.3e1 * t2207 * t1919 + 0.3e1 * t2207 * t1948 + t3059 - t3064 - t3074 + t3078 - t3079 - t3083 + t3088 - t3090 - t794;
  t3093 = my_piecewise5(t58, 0, t61, 0, t3058 + t3091);
  t3095 = 0.5e1 / 0.54e2 * t38 * t48 * t802 - 0.1e2 / 0.81e2 * t3020 + t53 * t3093;
  t3099 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3095);
  tv3sigma2lapl0 = t8 * t3099;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 10] += tv3sigma2lapl10;

  t3104 = t38 * t91 * t885;
  t3107 = t224 * t812;
  t3108 = t1402 * t3107;
  t3113 = t294 * t819;
  t3115 = t217 * t3113 * t557;
  t3116 = t224 * t819;
  t3117 = t546 * t3116;
  t3118 = t758 * t3117;
  t3119 = t2344 * t755;
  t3120 = 0.2e1 * t2959;
  t3121 = 0.2e1 * t2967;
  t3122 = 0.2e1 * t2973;
  t3123 = t564 * t819;
  t3124 = t563 * t3123;
  t3125 = t769 * t3124;
  t3126 = t1418 * t812;
  t3127 = t1415 * t3126;
  t3132 = t758 * t2987;
  t3133 = t1816 * t812;
  t3134 = t1397 * t3133;
  t3139 = -0.2e1 * t2059 * t3108 - 0.3e1 * t2326 * t2062 - t2353 * t2076 + 0.3e1 * t2353 * t2080 + 0.3e1 * t2084 * t3134 - 0.2e1 * t2087 * t3127 + 0.3e1 * t2353 * t2116 - t3115 + t3118 + t3119 + t3120 - t3121 + t3122 - t3125 + t3132 - t876;
  t3140 = t1403 * t812;
  t3141 = t1402 * t3140;
  t3146 = t294 * t812;
  t3147 = t217 * t3146;
  t3148 = t3147 * t1804;
  t3149 = 0.3e1 * t3148;
  t3150 = t2368 * t2103;
  t3151 = 0.3e1 * t3150;
  t3154 = t1436 * t812 * t110 * t224;
  t3159 = t769 * t2987;
  t3162 = 0.2e1 * t2988;
  t3163 = 0.2e1 * t2990;
  t3164 = 0.2e1 * t2995;
  t3165 = t3146 * t555;
  t3166 = t531 * t3165;
  t3167 = t3166 * t1470;
  t3168 = 0.3e1 * t3167;
  t3169 = params->csk_a * t812;
  t3170 = t3169 * t555;
  t3171 = t225 * t3170;
  t3172 = t2129 * t3171;
  t3173 = 0.3e1 * t3172;
  t3174 = t3166 * t1461;
  t3175 = 0.3e1 * t3174;
  t3176 = -t2059 * t3141 - 0.3e1 * t2059 * t3154 + 0.3e1 * t2084 * t3141 + 0.3e1 * t2084 * t3154 - 0.3e1 * t2087 * t3134 - t2087 * t3141 + t3149 + t3151 - t3159 + t3162 - t3163 - t3164 - t3168 + t3173 - t3175 - t821;
  t3178 = my_piecewise5(t102, 0, t103, 0, t3139 + t3176);
  t3180 = 0.5e1 / 0.54e2 * t38 * t96 * t829 - 0.1e2 / 0.81e2 * t3104 + t101 * t3178;
  t3184 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3180);
  tv3sigma2lapl11 = t8 * t3184;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 11] += tv3sigma2lapl11;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 10] += tv3sigma2tau10;

  tv3sigma2tau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 11] += tv3sigma2tau11;

  t3189 = t38 * t43 * t908;
  t3197 = 0.2e1 * t3030;
  t3198 = 0.2e1 * t3031;
  t3199 = 0.2e1 * t3035;
  t3200 = t1048 * t245;
  t3201 = t1026 * t3200;
  t3204 = 0.2e1 * t3053;
  t3205 = 0.2e1 * t3059;
  t3206 = 0.2e1 * t3064;
  t3207 = -0.2e1 * t1031 * t2699 * t849 - 0.3e1 * t2696 * t1565 - t1581 * t2693 + 0.3e1 * t2696 * t3201 + t2867 - t2890 + t2896 - t2907 + t2917 - t2919 + t3197 + t3198 - t3199 - t3204 + t3205 - t3206;
  t3209 = t2741 * t2499 * t1096;
  t3210 = 0.3e1 * t3209;
  t3211 = t2499 * t380;
  t3213 = t2747 * t157 * t3211;
  t3214 = 0.3e1 * t3213;
  t3215 = t2499 * t153;
  t3217 = t2741 * t366 * t3215;
  t3218 = 0.3e1 * t3217;
  t3219 = t1033 * t245;
  t3220 = t1031 * t3219;
  t3226 = t245 * t68 * t156;
  t3227 = t1066 * t3226;
  t3232 = t2735 * t371 * t849 * t153;
  t3233 = 0.3e1 * t3232;
  t3236 = t1044 * t245;
  t3240 = t2723 * t1603;
  t3241 = 0.3e1 * t3240;
  t3248 = -0.2e1 * t1041 * t2702 * t3236 + 0.3e1 * t2702 * t1587 + 0.3e1 * t2702 * t1628 + 0.3e1 * t2696 * t3220 + 0.3e1 * t2696 * t3227 - t2699 * t3220 - 0.3e1 * t2699 * t3227 - 0.3e1 * t2702 * t3201 - t2702 * t3220 - t3210 + t3214 - t3218 + t3233 + t3241 - t794 - t902;
  t3250 = my_piecewise5(t58, 0, t61, 0, t3207 + t3248);
  t3252 = 0.5e1 / 0.27e2 * t38 * t48 * t857 - 0.5e1 / 0.81e2 * t3189 + t53 * t3250;
  t3256 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3252);
  tv3sigmalapl20 = t8 * t3256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 7] += tv3sigmalapl27;

  t3261 = t38 * t91 * t931;
  t3269 = 0.2e1 * t3115;
  t3270 = 0.2e1 * t3118;
  t3271 = 0.2e1 * t3119;
  t3272 = 0.2e1 * t3125;
  t3273 = 0.2e1 * t3132;
  t3274 = 0.2e1 * t3159;
  t3275 = -0.2e1 * t1402 * t2794 * t877 - 0.3e1 * t2797 * t1751 - t1784 * t2803 + t2959 - t2967 + t2973 + t2988 - t2990 - t2995 - t3269 + t3270 + t3271 - t3272 + t3273 - t3274 - t821;
  t3276 = t2617 * t555;
  t3277 = t225 * t3276;
  t3278 = t2850 * t3277;
  t3279 = 0.3e1 * t3278;
  t3280 = t2617 * t221;
  t3282 = t2844 * t541 * t3280;
  t3283 = 0.3e1 * t3282;
  t3285 = t2844 * t2617 * t1469;
  t3286 = 0.3e1 * t3285;
  t3289 = t1403 * t262;
  t3290 = t1402 * t3289;
  t3296 = t262 * t110 * t224;
  t3297 = t1436 * t3296;
  t3300 = t1816 * t262;
  t3301 = t1397 * t3300;
  t3306 = t2826 * t546 * t877 * t221;
  t3307 = 0.3e1 * t3306;
  t3310 = t1418 * t262;
  t3314 = t2838 * t1798;
  t3315 = 0.3e1 * t3314;
  t3320 = -0.2e1 * t1415 * t2808 * t3310 + 0.3e1 * t2808 * t1775 + 0.3e1 * t2808 * t1827 - t2794 * t3290 - 0.3e1 * t2794 * t3297 + 0.3e1 * t2797 * t3290 + 0.3e1 * t2797 * t3297 + 0.3e1 * t2797 * t3301 - t2808 * t3290 - 0.3e1 * t2808 * t3301 + t3279 - t3283 - t3286 + t3307 + t3315 - t925;
  t3322 = my_piecewise5(t102, 0, t103, 0, t3275 + t3320);
  t3324 = 0.5e1 / 0.27e2 * t38 * t96 * t885 - 0.5e1 / 0.81e2 * t3261 + t101 * t3322;
  t3328 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3324);
  tv3sigmalapl28 = t8 * t3328;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 7] += tv3sigmatau27;

  tv3sigmatau28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 8] += tv3sigmatau28;

  t3332 = t895 * t278;
  t3333 = t3332 * t1021;
  t3334 = t1020 * t3333;
  t3338 = t149 * t3333;
  t3340 = t356 * t3333;
  t3353 = t3332 * t380;
  t3354 = t149 * t3353;
  t3355 = t3354 * t1015;
  t3356 = 0.3e1 * t3355;
  t3357 = t3332 * t153;
  t3359 = t356 * t3357 * t1076;
  t3360 = 0.3e1 * t3359;
  t3363 = 0.3e1 * t3030;
  t3364 = 0.3e1 * t3334 * t1027 - t3334 * t1034 - t3338 * t1034 + 0.3e1 * t3340 * t1034 - 0.2e1 * t3334 * t1045 - 0.3e1 * t3334 * t1049 + 0.3e1 * t3340 * t1049 + 0.3e1 * t3334 * t1063 - 0.3e1 * t3338 * t1067 + 0.3e1 * t3340 * t1067 + t3356 + t3360 + t3363;
  t3365 = 0.3e1 * t3031;
  t3366 = 0.3e1 * t3035;
  t3367 = 0.3e1 * t3053;
  t3368 = 0.3e1 * t3059;
  t3369 = 0.3e1 * t3064;
  t3378 = t356 * t3353;
  t3379 = t3378 * t1097;
  t3380 = 0.3e1 * t3379;
  t3381 = t3378 * t1089;
  t3382 = 0.3e1 * t3381;
  t3384 = t149 * t3357 * t1102;
  t3385 = 0.3e1 * t3384;
  t3386 = -t1020 * t1108 * t3332 - 0.2e1 * t1115 * t149 * t3332 - 0.3e1 * t1119 * t3332 * t356 + t3365 - t3366 - t3367 + t3368 - t3369 - t3380 - t3382 + t3385 - t794 - t902;
  t3388 = my_piecewise5(t58, 0, t61, 0, t3364 + t3386);
  t3390 = 0.5e1 / 0.18e2 * t38 * t48 * t908 + t53 * t3388;
  t3394 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3390);
  tv3lapl30 = t8 * t3394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 2] += tv3lapl32;

  t3398 = t918 * t294;
  t3399 = t3398 * t1392;
  t3400 = t531 * t3399;
  t3403 = t1390 * t3399;
  t3412 = t3398 * t221;
  t3414 = t531 * t3412 * t1456;
  t3415 = 0.3e1 * t3414;
  t3416 = t3398 * t555;
  t3417 = t217 * t3416;
  t3418 = t3417 * t1450;
  t3419 = 0.3e1 * t3418;
  t3420 = t217 * t3399;
  t3429 = 0.3e1 * t3115;
  t3430 = 0.3e1 * t3403 * t1398 + 0.3e1 * t3400 * t1404 - t3403 * t1404 - t3420 * t1404 + 0.3e1 * t3400 * t1411 - 0.3e1 * t3403 * t1411 - 0.2e1 * t3403 * t1419 + 0.3e1 * t3403 * t1427 + 0.3e1 * t3400 * t1437 - 0.3e1 * t3420 * t1437 + t3415 + t3419 - t3429;
  t3431 = 0.3e1 * t3118;
  t3432 = 0.3e1 * t3119;
  t3433 = 0.3e1 * t3125;
  t3434 = 0.3e1 * t3132;
  t3435 = 0.3e1 * t3159;
  t3445 = t217 * t3412 * t1475;
  t3446 = 0.3e1 * t3445;
  t3447 = t531 * t3416;
  t3448 = t3447 * t1470;
  t3449 = 0.3e1 * t3448;
  t3450 = t3447 * t1461;
  t3451 = 0.3e1 * t3450;
  t3452 = -t1390 * t1488 * t3398 - 0.2e1 * t1495 * t217 * t3398 - 0.3e1 * t1499 * t3398 * t531 + t3431 + t3432 - t3433 + t3434 - t3435 + t3446 - t3449 - t3451 - t821 - t925;
  t3454 = my_piecewise5(t102, 0, t103, 0, t3430 + t3452);
  t3456 = 0.5e1 / 0.18e2 * t38 * t96 * t931 + t101 * t3454;
  t3460 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * t3456);
  tv3lapl33 = t8 * t3460;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 5] += tv3lapltau25;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 2] += tv3tau32;

  tv3tau33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 3] += tv3tau33;

  t3467 = t38 * sigma[0] / t41 / t340 / t39;
  t3473 = 0.154e5 / 0.2187e4 * t38 * lapl[0] * t993 - 0.10472e6 / 0.6561e4 * t3467;
  t3487 = t376 * t357;
  t3488 = t3487 * t380;
  t3489 = t356 * t3488;
  t3498 = t376 * t376;
  t3499 = t149 * t3498;
  t3507 = t357 * t357;
  t3508 = t149 * t3507;
  t3509 = t380 * t380;
  t3510 = t3509 * t361;
  t3511 = t3510 * t157;
  t3514 = t356 * t3507;
  t3515 = t3510 * t366;
  t3519 = t359 * t359;
  t3520 = t360 * t360;
  t3521 = 0.1e1 / t3520;
  t3522 = t3519 * t3521;
  t3523 = t3522 * t1107;
  t3526 = t3522 * t157;
  t3529 = t354 * t354;
  t3531 = t70 / t3529;
  t3533 = t363 * t363;
  t3534 = t364 * t364;
  t3535 = 0.1e1 / t3534;
  t3536 = t3533 * t3535;
  t3537 = t3522 * t3536;
  t3539 = my_piecewise3(t61, 0, t3473);
  t3540 = my_piecewise3(t63, t3539, 0);
  t3543 = t3522 * t366;
  t3546 = t3507 * t380;
  t3547 = t356 * t3546;
  t3549 = t359 * t68 * t156;
  t3550 = t1066 * t3549;
  t3553 = 0.6e1 * t1020 * t3507 * t3523 - t149 * t158 * t3540 + 0.3e1 * t3498 * t356 * t367 + t3507 * t3531 * t3537 - 0.3e1 * t3499 * t382 + 0.3e1 * t3499 * t384 + 0.3e1 * t3508 * t3511 + 0.6e1 * t3508 * t3526 + 0.3e1 * t3514 * t3515 + 0.11e2 * t3514 * t3543 + 0.18e2 * t3547 * t3550;
  t3555 = t3507 * t359;
  t3556 = t149 * t3555;
  t3557 = t1031 * t1101;
  t3560 = t376 * t1021;
  t3561 = t356 * t3560;
  t3564 = t1020 * t3555;
  t3566 = t1041 * t1062 * t380;
  t3570 = t1041 * t1044 * t380;
  t3573 = t356 * t3555;
  t3575 = t1026 * t1048 * t380;
  t3580 = t1020 * t3560;
  t3583 = t1582 * t3549;
  t3590 = t1031 * t1033 * t380;
  t3599 = t149 * t1559;
  t3600 = t1031 * t1080;
  t3603 = t1111 * t359;
  t3604 = t356 * t3603;
  t3610 = t1026 * t1075 * params->csk_a;
  t3614 = t388 * t1058 * t380;
  t3618 = t1582 * t366 * t376;
  t3621 = t1043 * t376;
  t3623 = t1041 * t3621 * params->csk_a;
  t3627 = t1041 * t1044 * t376;
  t3632 = 0.18e2 * t149 * t1609 * t3487 - 0.18e2 * t1560 * t3618 + 0.18e2 * t1560 * t3623 - 0.12e2 * t1560 * t3627 + 0.18e2 * t1564 * t3618 + 0.18e2 * t1601 * t3614 - 0.18e2 * t3564 * t3575 + 0.18e2 * t3564 * t3610 - 0.18e2 * t3599 * t3600 - 0.4e1 * t3604 * t601 - 0.4e1 * t3604 * t617;
  t3636 = t1031 * t1033 * t376;
  t3639 = t1026 * t1620;
  t3642 = t149 * t3603;
  t3645 = t3507 * t3519;
  t3646 = t356 * t3645;
  t3647 = t3521 * t363;
  t3648 = t3647 * t389;
  t3651 = t1031 * t1551;
  t3658 = t3531 * t3645;
  t3659 = t3521 * t1040;
  t3660 = t3659 * t1044;
  t3670 = t3521 * t3533;
  t3671 = t3535 * params->csk_a;
  t3672 = t3670 * t3671;
  t3676 = t1020 * t3645;
  t3680 = t3670 * t3535 * t1032;
  t3683 = t1032 * params->csk_a;
  t3684 = t3535 * t3683;
  t3685 = t3670 * t3684;
  t3688 = t3498 * t359;
  t3689 = t356 * t3688;
  t3696 = t1041 * t1043 * t380;
  t3702 = t1031 * t156 * t380;
  t3707 = t3647 * t1048;
  t3710 = t1043 * t3683;
  t3711 = t3659 * t3710;
  t3714 = 0.3e1 * t149 * t3688 * t373 - 0.12e2 * t3556 * t3702 - 0.6e1 * t3564 * t3696 + 0.4e1 * t3642 * t612 - 0.18e2 * t3676 * t3648 + 0.11e2 * t3658 * t3680 - 0.6e1 * t3658 * t3685 + 0.7e1 * t3658 * t3707 - 0.12e2 * t3658 * t3711 - 0.3e1 * t3689 * t373 - 0.3e1 * t3689 * t390;
  t3716 = t365 * t3683;
  t3717 = t3647 * t3716;
  t3722 = t3507 * t3509;
  t3723 = t356 * t3722;
  t3728 = t3521 * params->csk_a;
  t3729 = t3728 * t157;
  t3735 = t149 * t3645;
  t3738 = t1026 * t1075;
  t3743 = t1026 * t1058;
  t3746 = t3659 * t1062;
  t3749 = 0.3e1 * t149 * t3722 * t373 - 0.18e2 * t1564 * t3743 - 0.18e2 * t3573 * t3738 - 0.11e2 * t3646 * t3707 - 0.11e2 * t3646 * t3729 - 0.7e1 * t3658 * t3717 + 0.18e2 * t3676 * t3717 - 0.12e2 * t3676 * t3746 - 0.3e1 * t3723 * t373 - 0.3e1 * t3723 * t390 + 0.11e2 * t3735 * t3729;
  t3754 = t3521 * t68;
  t3755 = t156 * t3683;
  t3756 = t3754 * t3755;
  t3767 = t3521 * t1032;
  t3768 = t3767 * t157;
  t3775 = -0.7e1 * t3646 * t3717 - 0.7e1 * t3646 * t3756 - 0.18e2 * t3646 * t3768 - 0.6e1 * t3658 * t3746 - t3658 * t3756 - 0.6e1 * t3676 * t3660 + 0.12e2 * t3676 * t3711 + 0.6e1 * t3676 * t3756 + 0.6e1 * t3676 * t3768 + t3735 * t3756 + 0.6e1 * t3735 * t3768;
  t3779 = my_piecewise5(t58, 0, t61, 0, t3749 + t3714 - t383 + t3632 + 0.18e2 * t149 * t3488 * t1097 - 0.6e1 * t1020 * t3546 * t3583 - 0.6e1 * t1560 * t1041 * t3621 + 0.4e1 * t1077 - 0.5e1 * t1054 + t3553 + 0.4e1 * t1016 - 0.4e1 * t149 * t1111 * t151 * t382 + 0.4e1 * t594 * t388 * t365 * t1111 + 0.18e2 * t3658 * t3660 - 0.6e1 * t3658 * t3672 + 0.18e2 * t1560 * t3639 + 0.4e1 * t3642 * t601 + 0.7e1 * t3646 * t3648 - 0.12e2 * t3599 * t3651 - 0.6e1 * t3599 * t3636 - 0.6e1 * t3580 * t1585 + 0.18e2 * t3547 * t3583 - 0.6e1 * t3556 * t3590 + 0.18e2 * t3573 * t3575 + 0.18e2 * t3561 * t1585 - 0.12e2 * t3564 * t3570 - 0.18e2 * t3556 * t3557 + 0.18e2 * t3561 * t1594 + 0.18e2 * t3564 * t3566 - 0.18e2 * t3489 * t1097 - 0.18e2 * t3489 * t1089 + t3775 + 0.4e1 * t1103 - 0.4e1 * t1098 - 0.4e1 * t1090);
  t3787 = t7 * t957 * t132 * t73;
  t3791 = t7 * t319 * t332 * t73;
  t3795 = t7 * t127 * t980 * t73;
  t3798 = 0.1e1 / t30 / t310;
  t3802 = 0.14e2 / 0.135e3 * t7 * t29 * t3798 * t73;
  t3803 = t21 * t21;
  t3805 = 0.1e1 / t26 / t3803;
  t3806 = t307 * t307;
  t3812 = t315 * t315;
  t3819 = t18 / t948 / t8;
  t3821 = -0.24e2 * t949 + 0.24e2 * t3819;
  t3822 = my_piecewise5(t12, 0, t16, 0, t3821);
  t3826 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3805 * t3806 - 0.2e2 / 0.9e1 * t941 * t307 * t315 + 0.1e2 / 0.3e1 * t306 * t3812 + 0.4e2 / 0.9e1 * t945 * t953 + 0.5e1 / 0.3e1 * t27 * t3822);
  t3835 = t7 * t962 * t162;
  t3841 = t7 * t969 * t162;
  t3844 = t7 * t324 * t395;
  t3850 = t7 * t981 * t162;
  t3853 = t7 * t333 * t395;
  t3856 = t7 * t133 * t1126;
  t3858 = 0.3e1 / 0.2e2 * t7 * t32 * (0.1309e5 / 0.729e3 * t3467 + t3473 * t71 + 0.4e1 * t1001 * t160 + 0.6e1 * t350 * t393 + 0.4e1 * t147 * t1124 + t53 * t3779) + 0.2e1 / 0.5e1 * t3787 - t3791 / 0.5e1 + 0.8e1 / 0.45e2 * t3795 - t3802 + 0.3e1 / 0.2e2 * t7 * t3826 * t31 * t73 + 0.3e1 / 0.5e1 * t7 * t958 * t162 + 0.6e1 / 0.5e1 * t3835 + 0.9e1 / 0.1e2 * t7 * t320 * t395 - 0.2e1 / 0.5e1 * t3841 + 0.6e1 / 0.5e1 * t3844 + 0.3e1 / 0.5e1 * t7 * t128 * t1126 + 0.8e1 / 0.45e2 * t3850 - t3853 / 0.5e1 + 0.2e1 / 0.5e1 * t3856;
  t3859 = my_piecewise3(t2, 0, t3858);
  t3860 = t80 * t80;
  t3862 = 0.1e1 / t82 / t3860;
  t3863 = t402 * t402;
  t3869 = t406 * t406;
  t3875 = my_piecewise5(t16, 0, t12, 0, -t3821);
  t3879 = my_piecewise3(t81, 0, 0.4e2 / 0.81e2 * t3862 * t3863 - 0.2e2 / 0.9e1 * t1133 * t402 * t406 + 0.1e2 / 0.3e1 * t401 * t3869 + 0.4e2 / 0.9e1 * t1137 * t1141 + 0.5e1 / 0.3e1 * t83 * t3875);
  t3886 = t7 * t1145 * t132 * t115;
  t3890 = t7 * t410 * t332 * t115;
  t3894 = t7 * t172 * t980 * t115;
  t3899 = 0.14e2 / 0.135e3 * t7 * t85 * t3798 * t115;
  t3901 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t3879 * t31 * t115 + 0.2e1 / 0.5e1 * t3886 - t3890 / 0.5e1 + 0.8e1 / 0.45e2 * t3894 - t3899);
  tv4rho40 = 0.4e1 * t1131 + 0.4e1 * t1163 + t8 * (t3859 + t3901);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3907 = t7 * t440 * t395;
  t3928 = 0.12e2 * t949;
  t3929 = 0.24e2 * t3819;
  t3930 = -t3928 + t3929;
  t3931 = my_piecewise5(t12, 0, t16, 0, t3930);
  t3935 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3805 * t186 * t942 - 0.1e2 / 0.9e1 * t941 * t431 * t307 - 0.1e2 / 0.9e1 * t1168 * t124 * t315 + 0.1e2 / 0.3e1 * t306 * t1179 * t124 + 0.1e2 / 0.3e1 * t1171 * t315 + 0.1e2 / 0.9e1 * t427 * t953 + 0.5e1 / 0.3e1 * t27 * t3931);
  t3944 = t7 * t1188 * t162;
  t3950 = t7 * t1195 * t162;
  t3951 = t3950 / 0.1e2;
  t3954 = t7 * t1183 * t132 * t73;
  t3958 = t7 * t435 * t332 * t73;
  t3959 = t3958 / 0.1e2;
  t3962 = t7 * t189 * t980 * t73;
  t3973 = 0.3e1 / 0.1e2 * t3907 + 0.3e1 / 0.2e2 * t7 * t190 * t1126 + 0.3e1 / 0.2e2 * t7 * t3935 * t31 * t73 + 0.9e1 / 0.2e2 * t7 * t1184 * t162 + 0.3e1 / 0.5e1 * t3944 + 0.9e1 / 0.2e2 * t7 * t436 * t395 - t3951 + 0.3e1 / 0.1e2 * t3954 - t3959 + 0.2e1 / 0.45e2 * t3962 + t3787 / 0.1e2 - t3791 / 0.1e2 + 0.2e1 / 0.15e2 * t3795 - t3802 + 0.3e1 / 0.1e2 * t3835 - t3841 / 0.5e1 + 0.3e1 / 0.1e2 * t3844 + 0.2e1 / 0.15e2 * t3850 - t3853 / 0.1e2 + t3856 / 0.1e2;
  t3974 = my_piecewise3(t2, 0, t3973);
  t3992 = my_piecewise5(t16, 0, t12, 0, -t3930);
  t3996 = my_piecewise3(t81, 0, 0.4e2 / 0.81e2 * t3862 * t197 * t1134 - 0.1e2 / 0.9e1 * t1133 * t454 * t402 - 0.1e2 / 0.9e1 * t1212 * t169 * t406 + 0.1e2 / 0.3e1 * t401 * t1221 * t169 + 0.1e2 / 0.3e1 * t1215 * t406 + 0.1e2 / 0.9e1 * t451 * t1141 + 0.5e1 / 0.3e1 * t83 * t3992);
  t4003 = t7 * t1225 * t132 * t115;
  t4007 = t7 * t458 * t332 * t115;
  t4008 = t4007 / 0.1e2;
  t4011 = t7 * t200 * t980 * t115;
  t4020 = t7 * t1150 * t230;
  t4023 = t7 * t1154 * t230;
  t4024 = t4023 / 0.1e2;
  t4026 = t7 * t1158 * t230;
  t4028 = 0.3e1 / 0.2e2 * t7 * t3996 * t31 * t115 + 0.3e1 / 0.1e2 * t4003 - t4008 + 0.2e1 / 0.45e2 * t4011 + t3886 / 0.1e2 - t3890 / 0.1e2 + 0.2e1 / 0.15e2 * t3894 - t3899 + 0.3e1 / 0.2e2 * t7 * t1146 * t230 + 0.3e1 / 0.1e2 * t4020 - t4024 + 0.2e1 / 0.45e2 * t4026;
  t4029 = my_piecewise3(t78, 0, t4028);
  tv4rho41 = t1131 + t1163 + 0.3e1 * t1211 + 0.3e1 * t1250 + t8 * (t3974 + t4029);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4038 = t7 * t1266 * t132 * t73;
  t4042 = t7 * t489 * t332 * t73;
  t4045 = t7 * t1271 * t162;
  t4059 = t431 * t431;
  t4072 = my_piecewise5(t12, 0, t16, 0, t3929);
  t4076 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3805 * t480 * t307 - 0.4e2 / 0.27e2 * t1168 * t124 * t431 - 0.1e2 / 0.27e2 * t1253 * t315 + 0.2e2 / 0.9e1 * t306 * t4059 + 0.2e2 / 0.9e1 * t427 * t1179 - 0.1e2 / 0.27e2 * t941 * t485 * t307 + 0.2e2 / 0.9e1 * t306 * t1262 * t124 + 0.1e2 / 0.9e1 * t1258 * t315 + 0.5e1 / 0.3e1 * t27 * t4072);
  t4094 = t4038 / 0.5e1 - t4042 / 0.3e2 + t4045 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t490 * t395 + t3907 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t4076 * t31 * t73 + 0.3e1 / 0.1e2 * t7 * t1267 * t162 + 0.2e1 / 0.5e1 * t3944 - 0.2e1 / 0.15e2 * t3950 + t3954 / 0.5e1 - 0.2e1 / 0.15e2 * t3958 + 0.4e1 / 0.45e2 * t3962 - t3791 / 0.3e2 + 0.4e1 / 0.45e2 * t3795 - t3802 - t3841 / 0.15e2 + 0.4e1 / 0.45e2 * t3850 - t3853 / 0.3e2;
  t4095 = my_piecewise3(t2, 0, t4094);
  t4104 = t454 * t454;
  t4117 = my_piecewise5(t16, 0, t12, 0, -t3929);
  t4121 = my_piecewise3(t81, 0, 0.4e2 / 0.81e2 * t3862 * t497 * t402 - 0.4e2 / 0.27e2 * t1212 * t169 * t454 - 0.1e2 / 0.27e2 * t1283 * t406 + 0.2e2 / 0.9e1 * t401 * t4104 + 0.2e2 / 0.9e1 * t451 * t1221 - 0.1e2 / 0.27e2 * t1133 * t501 * t402 + 0.2e2 / 0.9e1 * t401 * t1292 * t169 + 0.1e2 / 0.9e1 * t1288 * t406 + 0.5e1 / 0.3e1 * t83 * t4117);
  t4128 = t7 * t1296 * t132 * t115;
  t4132 = t7 * t505 * t332 * t115;
  t4141 = t7 * t1230 * t230;
  t4144 = t7 * t1234 * t230;
  t4155 = t7 * t415 * t570;
  t4158 = t7 * t419 * t570;
  t4160 = 0.3e1 / 0.2e2 * t7 * t4121 * t31 * t115 + t4128 / 0.5e1 - t4132 / 0.3e2 + t4003 / 0.5e1 - 0.2e1 / 0.15e2 * t4007 + 0.4e1 / 0.45e2 * t4011 + 0.3e1 / 0.1e2 * t7 * t1226 * t230 + 0.2e1 / 0.5e1 * t4141 - t4144 / 0.15e2 - t3890 / 0.3e2 + 0.4e1 / 0.45e2 * t3894 - t3899 + t4020 / 0.5e1 - 0.2e1 / 0.15e2 * t4023 + 0.4e1 / 0.45e2 * t4026 + 0.3e1 / 0.2e2 * t7 * t411 * t570 + t4155 / 0.5e1 - t4158 / 0.3e2;
  t4161 = my_piecewise3(t78, 0, t4160);
  tv4rho42 = 0.2e1 * t1211 + 0.2e1 * t1250 + 0.2e1 * t1282 + 0.2e1 * t1321 + t8 * (t4095 + t4161);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t4181 = t3928 + t3929;
  t4182 = my_piecewise5(t12, 0, t16, 0, t4181);
  t4186 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3805 * t1326 * t124 - 0.1e2 / 0.9e1 * t1253 * t431 - 0.1e2 / 0.9e1 * t1168 * t485 * t124 + 0.1e2 / 0.3e1 * t1171 * t485 + 0.1e2 / 0.3e1 * t427 * t1262 + 0.1e2 / 0.9e1 * t306 * t1333 * t124 + 0.5e1 / 0.3e1 * t27 * t4182);
  t4193 = t7 * t1337 * t132 * t73;
  t4204 = 0.3e1 / 0.2e2 * t7 * t4186 * t31 * t73 + t4193 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t1338 * t162 + 0.3e1 / 0.1e2 * t4038 - t4042 / 0.1e2 + 0.3e1 / 0.1e2 * t4045 - t3959 + 0.2e1 / 0.15e2 * t3962 - t3951 + 0.2e1 / 0.45e2 * t3795 - t3802 + 0.2e1 / 0.45e2 * t3850;
  t4205 = my_piecewise3(t2, 0, t4204);
  t4222 = my_piecewise5(t16, 0, t12, 0, -t4181);
  t4226 = my_piecewise3(t81, 0, 0.4e2 / 0.81e2 * t3862 * t1346 * t169 - 0.1e2 / 0.9e1 * t1283 * t454 - 0.1e2 / 0.9e1 * t1212 * t501 * t169 + 0.1e2 / 0.3e1 * t1215 * t501 + 0.1e2 / 0.3e1 * t451 * t1292 + 0.1e2 / 0.9e1 * t401 * t1352 * t169 + 0.5e1 / 0.3e1 * t83 * t4222);
  t4233 = t7 * t1356 * t132 * t115;
  t4241 = t7 * t1301 * t230;
  t4250 = t7 * t463 * t570;
  t4260 = t7 * t177 * t1506;
  t4262 = 0.3e1 / 0.2e2 * t7 * t4226 * t31 * t115 + t4233 / 0.1e2 + 0.3e1 / 0.1e2 * t4128 - t4132 / 0.1e2 + 0.9e1 / 0.2e2 * t7 * t1297 * t230 + 0.3e1 / 0.1e2 * t4241 - t4008 + 0.2e1 / 0.15e2 * t4011 + 0.3e1 / 0.5e1 * t4141 - t4144 / 0.5e1 + 0.9e1 / 0.2e2 * t7 * t459 * t570 + 0.3e1 / 0.1e2 * t4250 + 0.2e1 / 0.45e2 * t3894 - t3899 - t4024 + 0.2e1 / 0.15e2 * t4026 + 0.3e1 / 0.1e2 * t4155 - t4158 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t173 * t1506 + t4260 / 0.1e2;
  t4263 = my_piecewise3(t78, 0, t4262);
  tv4rho43 = 0.3e1 * t1282 + 0.3e1 * t1321 + t1345 + t1511 + t8 * (t4205 + t4263);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4268 = t480 * t480;
  t4273 = t485 * t485;
  t4279 = 0.24e2 * t949 + 0.24e2 * t3819;
  t4280 = my_piecewise5(t12, 0, t16, 0, t4279);
  t4284 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3805 * t4268 - 0.2e2 / 0.9e1 * t1253 * t485 + 0.1e2 / 0.3e1 * t306 * t4273 + 0.4e2 / 0.9e1 * t427 * t1333 + 0.5e1 / 0.3e1 * t27 * t4280);
  t4293 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t4284 * t31 * t73 + 0.2e1 / 0.5e1 * t4193 - t4042 / 0.5e1 + 0.8e1 / 0.45e2 * t3962 - t3802);
  t4311 = t38 * sigma[2] / t89 / t515 / t87;
  t4317 = 0.154e5 / 0.2187e4 * t38 * lapl[1] * t1374 - 0.10472e6 / 0.6561e4 * t4311;
  t4331 = t551 * t532;
  t4332 = t4331 * t555;
  t4336 = t531 * t4332;
  t4342 = my_piecewise3(t103, 0, t4317);
  t4343 = my_piecewise3(t105, t4342, 0);
  t4346 = t532 * t532;
  t4347 = t531 * t4346;
  t4348 = t555 * t555;
  t4349 = t4348 * t536;
  t4350 = t4349 * t541;
  t4353 = t217 * t4346;
  t4354 = t4349 * t225;
  t4357 = t534 * t534;
  t4358 = t535 * t535;
  t4359 = 0.1e1 / t4358;
  t4360 = t4357 * t4359;
  t4361 = t4360 * t225;
  t4365 = t4360 * t1487;
  t4368 = t551 * t551;
  t4369 = t217 * t4368;
  t4377 = t4360 * t541;
  t4380 = t529 * t529;
  t4382 = t112 / t4380;
  t4384 = t538 * t538;
  t4385 = t539 * t539;
  t4386 = 0.1e1 / t4385;
  t4387 = t4384 * t4386;
  t4388 = t4360 * t4387;
  t4390 = t4346 * t534;
  t4391 = t217 * t4390;
  t4392 = t1402 * t1474;
  t4395 = 0.6e1 * t1390 * t4346 * t4365 - t217 * t226 * t4343 + t4346 * t4382 * t4388 + 0.3e1 * t4368 * t531 * t542 + 0.3e1 * t4347 * t4350 + 0.11e2 * t4347 * t4377 + 0.3e1 * t4353 * t4354 + 0.6e1 * t4353 * t4361 - 0.3e1 * t4369 * t557 + 0.3e1 * t4369 * t559 - 0.18e2 * t4391 * t4392;
  t4400 = t531 * t4390;
  t4403 = t1390 * t4390;
  t4404 = t541 * t555;
  t4405 = t1410 * t4404;
  t4409 = t1415 * t1418 * t555;
  t4413 = t563 * t1422 * t555;
  t4417 = t1415 * t1426 * t555;
  t4420 = t217 * t1745;
  t4422 = t1402 * t1403 * t551;
  t4425 = t1397 * t1809;
  t4428 = t551 * t1392;
  t4432 = t1390 * t4428;
  t4436 = t4346 * t555;
  t4439 = t534 * t110 * t224;
  t4440 = t1410 * t4439;
  t4447 = t1402 * t1403 * t555;
  t4452 = t1417 * t551;
  t4454 = t1415 * t4452 * params->csk_a;
  t4458 = t1397 * t1816 * t551;
  t4461 = t225 * t551;
  t4462 = t1436 * t4461;
  t4465 = t1491 * t534;
  t4466 = t217 * t4465;
  t4472 = t1415 * t1418 * t551;
  t4477 = -0.6e1 * t1390 * t4436 * t4440 + 0.18e2 * t4436 * t4440 * t531 + 0.18e2 * t1746 * t4454 - 0.18e2 * t1746 * t4458 - 0.12e2 * t1746 * t4472 + 0.18e2 * t1750 * t4458 + 0.18e2 * t1750 * t4462 - 0.6e1 * t4391 * t4447 + 0.18e2 * t4400 * t4405 - 0.18e2 * t4420 * t4462 + 0.4e1 * t4466 * t664;
  t4480 = t531 * t4465;
  t4486 = t1397 * t1455 * params->csk_a;
  t4489 = t4368 * t534;
  t4490 = t531 * t4489;
  t4494 = t1415 * t1417 * t555;
  t4504 = t1397 * t1455;
  t4507 = t4346 * t4357;
  t4508 = t1390 * t4507;
  t4509 = t4359 * t538;
  t4510 = t4509 * t564;
  t4514 = t531 * t4507;
  t4517 = t4382 * t4507;
  t4518 = t4359 * t1414;
  t4519 = t4518 * t1418;
  t4522 = t4359 * t3683;
  t4523 = t4522 * t1487;
  t4526 = t4359 * t4384;
  t4528 = t4526 * t4386 * t1032;
  t4531 = t4386 * t3683;
  t4532 = t4526 * t4531;
  t4542 = t4386 * params->csk_a;
  t4543 = t4526 * t4542;
  t4550 = t4509 * t1816;
  t4553 = t4522 * t541;
  t4556 = -0.4e1 * t1491 * t217 * t219 * t557 + 0.4e1 * t1491 * t540 * t563 * t657 - 0.6e1 * t1415 * t1746 * t4452 + 0.7e1 * t4514 * t4510 + 0.18e2 * t4517 * t4519 - 0.12e2 * t4517 * t4523 + 0.11e2 * t4517 * t4528 - 0.6e1 * t4517 * t4532 - 0.6e1 * t4517 * t4543 + 0.7e1 * t4517 * t4550 - 0.7e1 * t4517 * t4553;
  t4558 = t4346 * t4348;
  t4559 = t531 * t4558;
  t4565 = t217 * t4507;
  t4566 = t4359 * t110;
  t4567 = t4566 * t547;
  t4574 = t224 * t534;
  t4575 = t1402 * t4574;
  t4586 = t1397 * t1422;
  t4589 = t4518 * t1426;
  t4592 = -0.12e2 * t1757 * t217 * t4428 - 0.12e2 * t217 * t4436 * t4575 + 0.3e1 * t217 * t4558 * t548 - 0.18e2 * t1750 * t4586 - 0.6e1 * t4508 * t4519 - 0.12e2 * t4508 * t4589 - 0.11e2 * t4514 * t4550 - 0.11e2 * t4514 * t4567 - 0.3e1 * t4559 * t548 - 0.3e1 * t4559 * t565 + 0.11e2 * t4565 * t4567;
  t4593 = t4522 * t225;
  t4600 = t4359 * t1032 * t225;
  t4616 = 0.12e2 * t4508 * t4523 + 0.18e2 * t4508 * t4553 + 0.6e1 * t4508 * t4593 + 0.6e1 * t4508 * t4600 - 0.7e1 * t4514 * t4553 - 0.7e1 * t4514 * t4593 - 0.18e2 * t4514 * t4600 - 0.6e1 * t4517 * t4589 - t4517 * t4593 + t4565 * t4593 + 0.6e1 * t4565 * t4600;
  t4620 = my_piecewise5(t102, 0, t103, 0, t4592 - t558 - 0.3e1 * t4490 * t548 - 0.18e2 * t4400 * t4504 - 0.18e2 * t4508 * t4510 - 0.4e1 * t4480 * t680 - 0.4e1 * t4480 * t664 + 0.18e2 * t4403 * t4486 - 0.3e1 * t4490 * t565 - 0.6e1 * t4403 * t4494 + 0.4e1 * t4466 * t675 + 0.18e2 * t4403 * t4417 - 0.6e1 * t4420 * t4422 + 0.18e2 * t1746 * t4425 - 0.6e1 * t4432 * t1779 + 0.18e2 * t4400 * t4392 - 0.18e2 * t4403 * t4405 - 0.12e2 * t4403 * t4409 + 0.18e2 * t1796 * t4413 - 0.18e2 * t4336 * t1470 - 0.18e2 * t4336 * t1461 + t4477 + t4556 + t4395 + 0.4e1 * t1476 - 0.4e1 * t1471 - 0.4e1 * t1462 + 0.4e1 * t1457 + 0.4e1 * t1451 - 0.5e1 * t1434 + 0.18e2 * t217 * t4332 * t1470 + 0.18e2 * t217 * t4331 * t1804 + 0.18e2 * t531 * t4428 * t1779 + 0.3e1 * t217 * t4489 * t548 + t4616);
  t4626 = t497 * t497;
  t4631 = t501 * t501;
  t4637 = my_piecewise5(t16, 0, t12, 0, -t4279);
  t4641 = my_piecewise3(t81, 0, 0.4e2 / 0.81e2 * t3862 * t4626 - 0.2e2 / 0.9e1 * t1283 * t501 + 0.1e2 / 0.3e1 * t401 * t4631 + 0.4e2 / 0.9e1 * t451 * t1352 + 0.5e1 / 0.3e1 * t83 * t4637);
  t4651 = 0.2e1 / 0.5e1 * t4233 + 0.6e1 / 0.5e1 * t4241 + 0.6e1 / 0.5e1 * t4250 + 0.2e1 / 0.5e1 * t4260 - t4132 / 0.5e1 - 0.2e1 / 0.5e1 * t4144 - t4158 / 0.5e1 + 0.9e1 / 0.1e2 * t7 * t506 * t570 + 0.3e1 / 0.5e1 * t7 * t201 * t1506 + 0.3e1 / 0.2e2 * t7 * t86 * (0.1309e5 / 0.729e3 * t4311 + t4317 * t113 + 0.4e1 * t1382 * t228 + 0.6e1 * t525 * t568 + 0.4e1 * t215 * t1504 + t101 * t4620) + 0.3e1 / 0.2e2 * t7 * t4641 * t31 * t115 + 0.3e1 / 0.5e1 * t7 * t1357 * t230 + 0.8e1 / 0.45e2 * t4011 + 0.8e1 / 0.45e2 * t4026 - t3899;
  t4652 = my_piecewise3(t78, 0, t4651);
  tv4rho44 = 0.4e1 * t1345 + 0.4e1 * t1511 + t8 * (t4293 + t4652);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4660 = t7 * t962 * t250;
  t4666 = t7 * t969 * t250;
  t4669 = t7 * t324 * t622;
  t4676 = 0.2e1 / 0.45e2 * t7 * t981 * t250;
  t4678 = t7 * t333 * t622;
  t4681 = t7 * t133 * t1659;
  t4683 = t38 * t993;
  t4704 = t1548 * t380;
  t4705 = t149 * t4704;
  t4713 = t605 * t357;
  t4714 = t4713 * t380;
  t4715 = t356 * t4714;
  t4718 = t245 * t1011;
  t4719 = t4718 * t380;
  t4720 = t356 * t4719;
  t4722 = t1026 * t1048 * t359;
  t4725 = t598 * t1025;
  t4729 = t157 * t1032 * t1011 * t380;
  t4734 = -0.6e1 * t149 * t4725 * t4729 - 0.9e1 * t4715 * t1097 + 0.9e1 * t4705 * t2467 + 0.18e2 * t4720 * t3583 + 0.18e2 * t4720 * t4722 - 0.3e1 * t1546 - 0.2e1 * t1550 + 0.4e1 * t1604 + 0.4e1 * t1610 - 0.4e1 * t1638 - 0.4e1 * t1640 + 0.4e1 * t1648 - t610;
  t4735 = t1020 * t4719;
  t4741 = t149 * t2504;
  t4742 = t376 * params->csk_a;
  t4744 = t157 * t4742 * t151;
  t4747 = t1032 * t376;
  t4748 = t4747 * t2201;
  t4751 = t356 * t2504;
  t4752 = t4747 * t151;
  t4753 = t366 * t4752;
  t4757 = t1020 * t3560 * t1025;
  t4758 = t366 * t2500;
  t4764 = t1011 * t359;
  t4766 = t1020 * t4764 * t1025;
  t4767 = t1107 * t3211;
  t4770 = t366 * t3211;
  t4779 = t151 * t153;
  t4781 = t356 * t4779 * t361;
  t4787 = 0.9e1 * t1097 * t149 * t4714 + 0.9e1 * t1107 * t2500 * t4757 + 0.9e1 * t366 * t4704 * t4781 - 0.9e1 * t4715 * t1089 + 0.9e1 * t4705 * t2221 - 0.3e1 * t2505 * t4748 - 0.6e1 * t4735 * t3583 - 0.18e2 * t4735 * t4722 - 0.9e1 * t4741 * t4744 + 0.9e1 * t4751 * t4744 + 0.9e1 * t4751 * t4753 + 0.9e1 * t4757 * t4758 + 0.18e2 * t4766 * t4767 + 0.18e2 * t4766 * t4770;
  t4798 = t1107 * t4752;
  t4804 = t1041 * t1044 * t359;
  t4808 = my_piecewise3(t61, 0, 0.616e4 / 0.2187e4 * t4683);
  t4809 = my_piecewise3(t63, t4808, 0);
  t4812 = t1011 * t3519;
  t4813 = t1020 * t4812;
  t4814 = t3659 * t1627;
  t4817 = t356 * t4812;
  t4818 = t3647 * t853;
  t4821 = t245 * t3519;
  t4822 = t149 * t4821;
  t4823 = t156 * t1011;
  t4825 = t3754 * t4823 * params->csk_a;
  t4828 = t1020 * t4821;
  t4830 = t3659 * t1044 * t1011;
  t4833 = t356 * t4764;
  t4837 = t149 * t4718;
  t4839 = t380 * t1025 * t3549;
  t4842 = -0.18e2 * t1026 * t1602 * t4833 - t149 * t158 * t4809 - 0.18e2 * t149 * t3550 * t4719 - 0.9e1 * t2505 * t4753 - 0.6e1 * t2505 * t4798 + 0.18e2 * t4720 * t3550 - 0.12e2 * t4735 * t4804 - 0.3e1 * t4741 * t4748 + 0.9e1 * t4751 * t4748 - 0.12e2 * t4813 * t4814 + 0.7e1 * t4817 * t4818 + 0.11e2 * t4822 * t4825 - 0.6e1 * t4828 * t4830 - 0.12e2 * t4837 * t4839;
  t4843 = t356 * t4718;
  t4844 = t366 * params->csk_a;
  t4845 = t3510 * t4844;
  t4848 = t3510 * t2455;
  t4853 = t356 * t4821;
  t4857 = t3754 * t3755 * t1011;
  t4861 = t3531 * t4812;
  t4864 = t605 * t1021;
  t4865 = t356 * t4864;
  t4868 = t1020 * t4864;
  t4872 = t3754 * t1033 * t1011;
  t4875 = t3521 * t3683;
  t4878 = t4875 * t1011 * t363 * t365;
  t4882 = t3659 * t3710 * t1011;
  t4889 = 0.9e1 * t4865 * t1585 - 0.3e1 * t4868 * t1585 - 0.6e1 * t4861 * t4814 + t4822 * t4857 + 0.6e1 * t4822 * t4872 - 0.11e2 * t4853 * t4825 + 0.6e1 * t4828 * t4872 + 0.18e2 * t4828 * t4878 + 0.12e2 * t4828 * t4882 + 0.3e1 * t4837 * t4848 - 0.3e1 * t4843 * t4845 - 0.3e1 * t4843 * t4848 - 0.7e1 * t4853 * t4857 - 0.18e2 * t4853 * t4872;
  t4892 = t1026 * t2230;
  t4895 = t1020 * t4764;
  t4904 = t1031 * t1551 * t151;
  t4907 = t3531 * t4821;
  t4910 = t1652 * t359;
  t4911 = t149 * t4910;
  t4914 = t149 * t4864;
  t4927 = t388 * t389 * t1111;
  t4929 = -0.6e1 * t1041 * t1561 * t380 * t4895 + 0.9e1 * t149 * t1609 * t4713 + 0.9e1 * t1560 * t4892 - 0.6e1 * t1569 * t4904 - 0.3e1 * t1578 * t1621 - 0.3e1 * t4914 * t1585 + 0.6e1 * t4828 * t4857 - 0.7e1 * t4853 * t4878 - t4907 * t4857 - 0.7e1 * t4907 * t4878 - 0.12e2 * t4907 * t4882 + 0.3e1 * t4911 * t601 - t614 * t4927;
  t4932 = t3535 * t245;
  t4938 = t3670 * t3684 * t1011;
  t4941 = t356 * t4910;
  t4957 = t388 * t1555 * t380;
  t4960 = t356 * t2180;
  t4969 = t1043 * t605;
  t4971 = t1041 * t4969 * params->csk_a;
  t4976 = -0.9e1 * t1026 * t376 * t4960 * t595 + 0.11e2 * t1032 * t3670 * t4861 * t4932 - 0.3e1 * t1041 * t2181 * t245 * t3621 - 0.6e1 * t3670 * t4861 * t4932 * params->csk_a - 0.3e1 * t1578 * t1081 + 0.9e1 * t1560 * t4971 + 0.9e1 * t4865 * t1594 - 0.9e1 * t4914 * t1594 + 0.9e1 * t1601 * t4957 - 0.9e1 * t4868 * t1617 - 0.6e1 * t4868 * t1624 - 0.6e1 * t4907 * t4938 - 0.3e1 * t4941 * t601 - 0.3e1 * t4941 * t617;
  t4980 = t3647 * t3200;
  t4988 = t371 * t372 * t1111;
  t4991 = t3647 * t1048 * t1011;
  t4995 = t3659 * t3236;
  t4999 = t1094 * t153;
  t5000 = t157 * t376;
  t5001 = t4999 * t5000;
  t5009 = t3754 * t4823;
  t5016 = -0.9e1 * t2456 * t356 * t5001 - 0.9e1 * t2463 * t356 * t4704 + 0.3e1 * t1575 * t1081 + 0.3e1 * t1575 * t1552 + 0.9e1 * t4865 * t1617 + 0.3e1 * t4837 * t3511 - 0.18e2 * t4813 * t4818 + 0.6e1 * t4822 * t5009 - 0.11e2 * t4853 * t4991 + 0.7e1 * t4861 * t4980 + 0.18e2 * t4861 * t4995 + 0.3e1 * t4911 * t612 + t599 * t4988 - t614 * t4988;
  t5018 = t371 * t156 * t1111;
  t5024 = t388 * t365 * t1652;
  t5027 = t1041 * t4969;
  t5045 = t1026 * t1555;
  t5052 = t356 * t1011 * t3509;
  t5058 = t599 * t5018 + t3604 * t596 + 0.3e1 * t1084 * t1556 + 0.3e1 * t594 * t5024 - 0.3e1 * t1560 * t5027 + t4861 * t3670 * t4932 - 0.6e1 * t4914 * t1571 - 0.3e1 * t149 * t1652 * t151 * t382 - 0.3e1 * t149 * t605 * t376 * t382 - t149 * t245 * t1111 * t382 - 0.9e1 * t1564 * t5045 + 0.6e1 * t4813 * t3659 * t1561 + 0.3e1 * t5052 * t596 + 0.11e2 * t4817 * t3647 * t595;
  t5062 = my_piecewise5(t58, 0, t61, 0, t4734 + t4787 + t4842 + t4889 + t4929 + t4976 + t5016 + t5058);
  t5069 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t958 * t250 + 0.3e1 / 0.1e2 * t4660 + 0.9e1 / 0.2e2 * t7 * t320 * t622 - t4666 / 0.1e2 + 0.3e1 / 0.5e1 * t4669 + 0.9e1 / 0.2e2 * t7 * t128 * t1659 + t4676 - t4678 / 0.1e2 + 0.3e1 / 0.1e2 * t4681 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.77e3 / 0.243e3 * t4683 + 0.616e4 / 0.2187e4 * t38 * t993 * t71 - 0.44e3 / 0.243e3 * t38 * t342 * t160 + 0.4e2 / 0.81e2 * t38 * t139 * t393 - 0.5e1 / 0.81e2 * t38 * t43 * t1124 + t1001 * t248 + 0.3e1 * t350 * t620 + 0.3e1 * t147 * t1657 + t53 * t5062));
  tv4rho3sigma0 = t8 * t5069 + 0.3e1 * t1664;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t5076 = t7 * t1150 * t267;
  t5079 = t7 * t1154 * t267;
  t5083 = 0.2e1 / 0.45e2 * t7 * t1158 * t267;
  t5085 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1146 * t267 + 0.3e1 / 0.1e2 * t5076 - t5079 / 0.1e2 + t5083);
  tv4rho3sigma2 = t8 * t5085 + 0.3e1 * t1677;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t5087 = 0.2e1 * t1691;
  t5093 = t7 * t1188 * t250 / 0.5e1;
  t5098 = t7 * t1195 * t250;
  t5102 = t7 * t440 * t622 / 0.5e1;
  t5111 = 0.3e1 / 0.2e2 * t7 * t1184 * t250 + t5093 + 0.3e1 / 0.1e2 * t7 * t436 * t622 - t5098 / 0.3e2 + t5102 + 0.3e1 / 0.2e2 * t7 * t190 * t1659 + t4660 / 0.1e2 - t4666 / 0.15e2 + t4669 / 0.5e1 + t4676 - t4678 / 0.15e2 + t4681 / 0.1e2;
  t5112 = my_piecewise3(t2, 0, t5111);
  tv4rho3sigma3 = t8 * t5112 + t1664 + t5087;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5114 = 0.2e1 * t1707;
  t5120 = t7 * t1230 * t267 / 0.5e1;
  t5122 = t7 * t1234 * t267;
  t5131 = t7 * t415 * t685 / 0.5e1;
  t5133 = t7 * t419 * t685;
  t5136 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1226 * t267 + t5120 - t5122 / 0.3e2 + t5076 / 0.1e2 - t5079 / 0.15e2 + t5083 + 0.3e1 / 0.2e2 * t7 * t411 * t685 + t5131 - t5133 / 0.3e2);
  tv4rho3sigma5 = t8 * t5136 + t1677 + t5114;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5142 = t7 * t1271 * t250;
  t5151 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1267 * t250 + t5142 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t490 * t622 + t5093 - t5098 / 0.15e2 + t5102 - t4666 / 0.3e2 + t4676 - t4678 / 0.3e2);
  tv4rho3sigma6 = t8 * t5151 + t1715 + t5087;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5157 = t7 * t1301 * t267;
  t5164 = t7 * t463 * t685;
  t5172 = t7 * t177 * t1855;
  t5174 = 0.3e1 / 0.2e2 * t7 * t1297 * t267 + t5157 / 0.1e2 + t5120 - t5122 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t459 * t685 + t5164 / 0.5e1 - t5079 / 0.3e2 + t5083 + t5131 - t5133 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t173 * t1855 + t5172 / 0.1e2;
  t5175 = my_piecewise3(t78, 0, t5174);
  tv4rho3sigma8 = t8 * t5175 + t1860 + t5114;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5184 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1338 * t250 + 0.3e1 / 0.1e2 * t5142 - t5098 / 0.1e2 + t4676);
  tv4rho3sigma9 = t8 * t5184 + 0.3e1 * t1715;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5201 = t38 * t1374;
  t5227 = t262 * t1391;
  t5228 = t5227 * t555;
  t5229 = t531 * t5228;
  t5231 = t1397 * t1816 * t534;
  t5234 = t661 * t1396;
  t5237 = t1032 * t1391 * t555;
  t5238 = t225 * t5237;
  t5241 = t1032 * t551;
  t5242 = t5241 * t219;
  t5243 = t541 * t5242;
  t5248 = t1390 * t5228;
  t5251 = -0.6e1 * t217 * t5234 * t5238 - 0.9e1 * t2630 * t5243 + 0.18e2 * t5229 * t4440 - 0.6e1 * t5248 * t4440 + 0.18e2 * t5229 * t5231 - 0.3e1 * t1766 - 0.2e1 * t1770 + 0.4e1 * t1799 + 0.4e1 * t1805 - 0.4e1 * t1834 - 0.4e1 * t1836 + 0.4e1 * t1844 - t673;
  t5252 = t668 * t532;
  t5253 = t5252 * t555;
  t5257 = t217 * t2629;
  t5258 = t551 * params->csk_a;
  t5260 = t225 * t5258 * t219;
  t5263 = t1436 * t4439;
  t5266 = t225 * t5242;
  t5272 = t531 * t2629;
  t5280 = t1390 * t4428 * t1396;
  t5281 = t541 * t2618;
  t5284 = t1487 * t5242;
  t5287 = t1391 * t534;
  t5289 = t1390 * t5287 * t1396;
  t5290 = t1487 * t3276;
  t5297 = t1768 * t555;
  t5298 = t217 * t5297;
  t5304 = -0.12e2 * t1415 * t1418 * t5248 * t534 + 0.9e1 * t1470 * t217 * t5253 + 0.9e1 * t1487 * t2618 * t5280 - 0.18e2 * t217 * t5228 * t5263 + 0.9e1 * t5298 * t2387 - 0.3e1 * t2630 * t5266 - 0.6e1 * t2630 * t5284 + 0.18e2 * t5229 * t5263 + 0.9e1 * t5272 * t5243 - 0.9e1 * t5257 * t5260 - 0.3e1 * t5257 * t5266 + 0.9e1 * t5272 * t5266 + 0.9e1 * t5280 * t5281 + 0.18e2 * t5289 * t5290;
  t5306 = t531 * t5253;
  t5309 = t541 * t3276;
  t5318 = t219 * t221;
  t5320 = t531 * t5318 * t536;
  t5324 = t531 * t5227;
  t5325 = t541 * params->csk_a;
  t5326 = t4349 * t5325;
  t5329 = t4349 * t2588;
  t5332 = t262 * t4357;
  t5333 = t217 * t5332;
  t5335 = t4566 * t1403 * t1391;
  t5338 = t1390 * t5332;
  t5339 = t1417 * t3683;
  t5341 = t4518 * t5339 * t1391;
  t5344 = t531 * t5332;
  t5345 = t540 * t3683;
  t5347 = t4509 * t5345 * t1391;
  t5354 = t1397 * t2358;
  t5357 = 0.9e1 * t5297 * t5320 * t541 - 0.9e1 * t5306 * t1461 - 0.9e1 * t5306 * t1470 + 0.9e1 * t1746 * t5354 - 0.18e2 * t5248 * t5231 + 0.9e1 * t5272 * t5260 + 0.18e2 * t5289 * t5309 - 0.3e1 * t5324 * t5326 - 0.3e1 * t5324 * t5329 + 0.6e1 * t5333 * t5335 + 0.6e1 * t5338 * t5335 - 0.18e2 * t5344 * t5335 + 0.12e2 * t5338 * t5341 - 0.7e1 * t5344 * t5347;
  t5358 = t1391 * t4357;
  t5359 = t4382 * t5358;
  t5360 = t4518 * t1826;
  t5363 = t668 * t1392;
  t5364 = t531 * t5363;
  t5367 = t1390 * t5363;
  t5370 = t4382 * t5332;
  t5377 = t4509 * t3300;
  t5380 = t1390 * t5358;
  t5383 = t531 * t5358;
  t5384 = t4509 * t881;
  t5387 = t224 * t1391;
  t5389 = t4566 * t5387 * params->csk_a;
  t5392 = t217 * t5227;
  t5396 = t4518 * t1418 * t1391;
  t5401 = t531 * t5287;
  t5402 = t1397 * t1797;
  t5405 = 0.9e1 * t5364 * t1779 - 0.3e1 * t5367 * t1779 + 0.3e1 * t5392 * t5329 + 0.11e2 * t5333 * t5389 + 0.18e2 * t5338 * t5347 - 0.6e1 * t5338 * t5396 - 0.12e2 * t5370 * t5341 - 0.11e2 * t5344 * t5389 - 0.7e1 * t5370 * t5347 - 0.6e1 * t5359 * t5360 + 0.7e1 * t5359 * t5377 - 0.12e2 * t5380 * t5360 + 0.7e1 * t5383 * t5384 - 0.18e2 * t5401 * t5402;
  t5409 = t555 * t1396 * t4439;
  t5415 = t563 * t1741 * t555;
  t5418 = t531 * t2338;
  t5423 = t1848 * t534;
  t5424 = t217 * t5423;
  t5427 = t217 * t5363;
  t5430 = t224 * t3683;
  t5432 = t4566 * t5430 * t1391;
  t5442 = t4509 * t1816 * t1391;
  t5447 = -0.9e1 * t1397 * t5418 * t551 * t658 - 0.3e1 * t5427 * t1779 - 0.9e1 * t5427 * t1788 - 0.3e1 * t1792 * t1810 + 0.9e1 * t1796 * t5415 + t5333 * t5432 + 0.6e1 * t5338 * t5432 - 0.7e1 * t5344 * t5432 - 0.11e2 * t5344 * t5442 - t5370 * t5432 - 0.18e2 * t5380 * t5384 - 0.12e2 * t5392 * t5409 + 0.3e1 * t5424 * t664;
  t5449 = t563 * t564 * t1491;
  t5453 = t4386 * t262;
  t5459 = t4526 * t4531 * t1391;
  t5468 = t1417 * t668;
  t5470 = t1415 * t5468 * params->csk_a;
  t5477 = t531 * t5423;
  t5485 = my_piecewise3(t103, 0, 0.616e4 / 0.2187e4 * t5201);
  t5486 = my_piecewise3(t105, t5485, 0);
  t5490 = t1467 * t221;
  t5491 = t5490 * t4461;
  t5496 = -t677 * t5449 - 0.6e1 * t5367 * t1813 + 0.11e2 * t5359 * t4526 * t5453 * t1032 - 0.6e1 * t5370 * t5459 - 0.9e1 * t5367 * t1818 - 0.3e1 * t2339 * t1415 * t4452 * t262 + 0.9e1 * t1746 * t5470 - 0.6e1 * t5359 * t4526 * t5453 * params->csk_a - 0.3e1 * t5477 * t664 - 0.3e1 * t1792 * t1480 + 0.9e1 * t5364 * t1788 - t217 * t5486 * t226 - 0.9e1 * t531 * t2589 * t5491 + 0.9e1 * t5298 * t2585;
  t5502 = t1402 * t1771 * t219;
  t5505 = t1390 * t5287;
  t5513 = t4518 * t3310;
  t5519 = t546 * t547 * t1491;
  t5526 = t4566 * t5387;
  t5530 = t531 * t1391 * t4348;
  t5533 = t4509 * t658;
  t5538 = -0.9e1 * t531 * t5297 * t2594 - 0.6e1 * t1755 * t5502 - 0.6e1 * t5505 * t1415 * t1747 * t555 + 0.9e1 * t217 * t5252 * t1804 + 0.18e2 * t5359 * t5513 + 0.3e1 * t1761 * t1480 + t662 * t5519 + 0.9e1 * t5364 * t1818 - t677 * t5519 - 0.3e1 * t5477 * t680 + 0.6e1 * t5333 * t5526 + 0.3e1 * t5530 * t659 + 0.11e2 * t5383 * t5533 + 0.3e1 * t5392 * t4354;
  t5539 = t1397 * t1741;
  t5553 = t546 * t224 * t1491;
  t5559 = t563 * t540 * t1848;
  t5562 = t1415 * t5468;
  t5577 = -0.9e1 * t1750 * t5539 + 0.6e1 * t5380 * t4518 * t1747 + 0.3e1 * t5424 * t675 - t217 * t262 * t1491 * t557 + 0.3e1 * t1761 * t1772 + t662 * t5553 + t4480 * t659 + 0.3e1 * t1464 * t1742 + 0.3e1 * t657 * t5559 - 0.3e1 * t1746 * t5562 + t5359 * t4526 * t5453 - 0.6e1 * t5427 * t1757 - 0.3e1 * t217 * t1848 * t219 * t557 - 0.3e1 * t217 * t668 * t551 * t557;
  t5581 = my_piecewise5(t102, 0, t103, 0, t5251 + t5304 + t5357 + t5405 + t5447 + t5496 + t5538 + t5577);
  t5588 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1357 * t267 + 0.3e1 / 0.1e2 * t5157 + 0.9e1 / 0.2e2 * t7 * t506 * t685 - t5122 / 0.1e2 + 0.3e1 / 0.5e1 * t5164 + 0.9e1 / 0.2e2 * t7 * t201 * t1855 + t5083 - t5133 / 0.1e2 + 0.3e1 / 0.1e2 * t5172 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.77e3 / 0.243e3 * t5201 + 0.616e4 / 0.2187e4 * t38 * t1374 * t113 - 0.44e3 / 0.243e3 * t38 * t517 * t228 + 0.4e2 / 0.81e2 * t38 * t207 * t568 - 0.5e1 / 0.81e2 * t38 * t91 * t1504 + t1382 * t265 + 0.3e1 * t525 * t683 + 0.3e1 * t215 * t1853 + t101 * t5581));
  tv4rho3sigma11 = t8 * t5588 + 0.3e1 * t1860;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5595 = t7 * t962 * t283;
  t5601 = t7 * t969 * t283;
  t5604 = t7 * t324 * t724;
  t5611 = 0.2e1 / 0.45e2 * t7 * t981 * t283;
  t5613 = t7 * t333 * t724;
  t5616 = t7 * t133 * t1976;
  t5638 = t278 * t1011;
  t5639 = t5638 * t380;
  t5640 = t356 * t5639;
  t5643 = t706 * t1025;
  t5644 = t149 * t5643;
  t5647 = t1020 * t5639;
  t5652 = 0.9e1 * t4757 * t2508 + 0.18e2 * t5640 * t3583 - 0.6e1 * t5647 * t3583 + 0.18e2 * t5640 * t4722 - 0.6e1 * t5644 * t4729 - 0.3e1 * t1888 - 0.2e1 * t1892 + 0.4e1 * t1931 + 0.4e1 * t1935 - 0.4e1 * t1958 - 0.4e1 * t1960 + 0.4e1 * t1965 - t716;
  t5655 = t711 * t357;
  t5656 = t5655 * t380;
  t5677 = t2681 * params->csk_a;
  t5678 = t1107 * t5677;
  t5681 = t366 * t5677;
  t5688 = 0.9e1 * t1097 * t149 * t5656 - 0.18e2 * t149 * t3550 * t5639 + 0.9e1 * t2489 * t4744 + 0.9e1 * t2489 * t4748 + 0.9e1 * t2489 * t4753 - 0.9e1 * t2498 * t4744 - 0.3e1 * t2498 * t4748 - 0.3e1 * t2515 * t4748 - 0.9e1 * t2515 * t4753 - 0.6e1 * t2515 * t4798 - 0.18e2 * t5647 * t4722 + 0.18e2 * t4766 * t5678 + 0.18e2 * t4766 * t5681 - 0.12e2 * t5647 * t4804;
  t5690 = t356 * t5656;
  t5693 = t1890 * t380;
  t5694 = t366 * t5693;
  t5697 = t149 * t5693;
  t5706 = t3659 * t1947;
  t5709 = t3647 * t1918;
  t5712 = t278 * t3519;
  t5713 = t149 * t5712;
  t5716 = t356 * t5638;
  t5719 = t149 * t5638;
  t5722 = t1020 * t5712;
  t5727 = t356 * t5712;
  t5730 = -0.9e1 * t5690 * t1089 - 0.9e1 * t5690 * t1097 + 0.9e1 * t5697 * t2221 + 0.9e1 * t4757 * t2529 + 0.18e2 * t5640 * t3550 + 0.9e1 * t4781 * t5694 - 0.12e2 * t4813 * t5706 + 0.7e1 * t4817 * t5709 + 0.11e2 * t5713 * t4825 - 0.11e2 * t5727 * t4825 - 0.6e1 * t5722 * t4830 - 0.3e1 * t5716 * t4845 - 0.3e1 * t5716 * t4848 + 0.3e1 * t5719 * t4848;
  t5731 = t1026 * t1929;
  t5740 = t3531 * t5712;
  t5743 = t711 * t1021;
  t5744 = t356 * t5743;
  t5747 = t1020 * t5743;
  t5762 = 0.9e1 * t5744 * t1585 - 0.3e1 * t5747 * t1585 + 0.9e1 * t5744 * t1617 - 0.18e2 * t4833 * t5731 - 0.12e2 * t5719 * t4839 + t5713 * t4857 + 0.6e1 * t5722 * t4857 - 0.7e1 * t5727 * t4857 - t5740 * t4857 + 0.6e1 * t5713 * t4872 + 0.6e1 * t5722 * t4872 - 0.18e2 * t5727 * t4872 + 0.18e2 * t5722 * t4878 + 0.12e2 * t5722 * t4882;
  t5765 = t1026 * t2716;
  t5779 = t1969 * t359;
  t5780 = t149 * t5779;
  t5783 = t149 * t5743;
  t5789 = t1043 * t711;
  t5791 = t1041 * t5789 * params->csk_a;
  t5794 = t3535 * t278;
  t5796 = t3670 * t5794 * params->csk_a;
  t5799 = t356 * t5779;
  t5802 = 0.9e1 * t149 * t1609 * t5655 + 0.9e1 * t1560 * t5765 + 0.9e1 * t1560 * t5791 - 0.3e1 * t5783 * t1585 - 0.6e1 * t1906 * t4904 - 0.6e1 * t4861 * t5706 - 0.6e1 * t4861 * t5796 - 0.7e1 * t5727 * t4878 - 0.7e1 * t5740 * t4878 - 0.12e2 * t5740 * t4882 - t718 * t4988 + 0.3e1 * t5780 * t601 - 0.3e1 * t5799 * t601;
  t5810 = t388 * t1895 * t380;
  t5814 = t1026 * t703 * t376;
  t5824 = t1041 * t1899 * t380;
  t5829 = t3647 * t703 * t1032;
  t5833 = t3659 * t1899 * t1032;
  t5841 = -0.3e1 * t1041 * t2181 * t278 * t3621 + 0.3e1 * t1910 * t1081 - 0.3e1 * t1925 * t1081 + 0.9e1 * t5744 * t1594 + 0.9e1 * t1601 * t5810 - 0.9e1 * t5747 * t1617 - 0.18e2 * t4813 * t5709 + 0.7e1 * t4861 * t5829 + 0.18e2 * t4861 * t5833 - 0.6e1 * t4895 * t5824 - t718 * t4927 - 0.9e1 * t4960 * t5814 + t707 * t4988 - 0.3e1 * t5799 * t617;
  t5850 = t3670 * t5794 * t1032;
  t5858 = my_piecewise3(t61, 0, -0.11e4 / 0.729e3 * t1530);
  t5859 = my_piecewise3(t63, t5858, 0);
  t5876 = t1026 * t1895;
  t5879 = -t149 * t158 * t5859 - 0.9e1 * t2463 * t356 * t5693 - 0.9e1 * t2525 * t356 * t5001 - 0.9e1 * t1564 * t5876 - 0.9e1 * t5783 * t1594 - 0.3e1 * t1925 * t1621 - 0.6e1 * t5747 * t1624 + 0.9e1 * t5697 * t2467 + 0.3e1 * t5719 * t3511 + 0.11e2 * t4861 * t5850 - 0.6e1 * t5740 * t4938 - 0.11e2 * t5727 * t4991 + 0.6e1 * t5713 * t5009 + 0.3e1 * t5780 * t612;
  t5880 = t3659 * t1899;
  t5885 = t3647 * t703;
  t5895 = t388 * t365 * t1969;
  t5898 = t1041 * t5789;
  t5901 = t3670 * t5794;
  t5916 = -t1111 * t149 * t278 * t382 - 0.3e1 * t149 * t151 * t1969 * t382 - 0.3e1 * t149 * t376 * t382 * t711 + 0.3e1 * t1084 * t1896 + 0.3e1 * t1910 * t1552 - 0.3e1 * t1560 * t5898 - 0.6e1 * t5783 * t1571 + t3604 * t704 + 0.6e1 * t4813 * t5880 + 0.11e2 * t4817 * t5885 + t4861 * t5901 + t707 * t5018 + 0.3e1 * t5052 * t704 + 0.3e1 * t594 * t5895;
  t5920 = my_piecewise5(t58, 0, t61, 0, t5652 + t5688 + t5730 + t5762 + t5802 + t5841 + t5879 + t5916);
  t5927 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t958 * t283 + 0.3e1 / 0.1e2 * t5595 + 0.9e1 / 0.2e2 * t7 * t320 * t724 - t5601 / 0.1e2 + 0.3e1 / 0.5e1 * t5604 + 0.9e1 / 0.2e2 * t7 * t128 * t1976 + t5611 - t5613 / 0.1e2 + 0.3e1 / 0.1e2 * t5616 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.11e4 / 0.729e3 * t1533 + 0.1e3 / 0.81e2 * t1536 - 0.25e2 / 0.54e2 * t1539 + 0.5e1 / 0.54e2 * t38 * t48 * t1124 + t1001 * t281 + 0.3e1 * t350 * t722 + 0.3e1 * t147 * t1974 + t53 * t5920));
  tv4rho3lapl0 = t8 * t5927 + 0.3e1 * t1981;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 0] += tv4rho3lapl0;

  t5934 = t7 * t1150 * t299;
  t5937 = t7 * t1154 * t299;
  t5941 = 0.2e1 / 0.45e2 * t7 * t1158 * t299;
  t5943 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1146 * t299 + 0.3e1 / 0.1e2 * t5934 - t5937 / 0.1e2 + t5941);
  tv4rho3lapl1 = t8 * t5943 + 0.3e1 * t1994;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 1] += tv4rho3lapl1;

  t5945 = 0.2e1 * t2008;
  t5951 = t7 * t1188 * t283 / 0.5e1;
  t5956 = t7 * t1195 * t283;
  t5960 = t7 * t440 * t724 / 0.5e1;
  t5969 = 0.3e1 / 0.2e2 * t7 * t1184 * t283 + t5951 + 0.3e1 / 0.1e2 * t7 * t436 * t724 - t5956 / 0.3e2 + t5960 + 0.3e1 / 0.2e2 * t7 * t190 * t1976 + t5595 / 0.1e2 - t5601 / 0.15e2 + t5604 / 0.5e1 + t5611 - t5613 / 0.15e2 + t5616 / 0.1e2;
  t5970 = my_piecewise3(t2, 0, t5969);
  tv4rho3lapl2 = t8 * t5970 + t1981 + t5945;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 2] += tv4rho3lapl2;

  t5972 = 0.2e1 * t2024;
  t5978 = t7 * t1230 * t299 / 0.5e1;
  t5980 = t7 * t1234 * t299;
  t5989 = t7 * t415 * t775 / 0.5e1;
  t5991 = t7 * t419 * t775;
  t5994 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1226 * t299 + t5978 - t5980 / 0.3e2 + t5934 / 0.1e2 - t5937 / 0.15e2 + t5941 + 0.3e1 / 0.2e2 * t7 * t411 * t775 + t5989 - t5991 / 0.3e2);
  tv4rho3lapl3 = t8 * t5994 + t1994 + t5972;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 3] += tv4rho3lapl3;

  t6000 = t7 * t1271 * t283;
  t6009 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1267 * t283 + t6000 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t490 * t724 + t5951 - t5956 / 0.15e2 + t5960 - t5601 / 0.3e2 + t5611 - t5613 / 0.3e2);
  tv4rho3lapl4 = t8 * t6009 + t2032 + t5945;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 4] += tv4rho3lapl4;

  t6015 = t7 * t1301 * t299;
  t6022 = t7 * t463 * t775;
  t6030 = t7 * t177 * t2141;
  t6032 = 0.3e1 / 0.2e2 * t7 * t1297 * t299 + t6015 / 0.1e2 + t5978 - t5980 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t459 * t775 + t6022 / 0.5e1 - t5937 / 0.3e2 + t5941 + t5989 - t5991 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t173 * t2141 + t6030 / 0.1e2;
  t6033 = my_piecewise3(t78, 0, t6032);
  tv4rho3lapl5 = t8 * t6033 + t2146 + t5972;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 5] += tv4rho3lapl5;

  t6042 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1338 * t283 + 0.3e1 / 0.1e2 * t6000 - t5956 / 0.1e2 + t5611);
  tv4rho3lapl6 = t8 * t6042 + 0.3e1 * t2032;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 6] += tv4rho3lapl6;

  t6077 = t757 * t1396;
  t6078 = t1390 * t6077;
  t6082 = t294 * t1391;
  t6083 = t6082 * t555;
  t6084 = t531 * t6083;
  t6087 = t1390 * t6083;
  t6094 = -0.12e2 * t1487 * t5237 * t6078 - 0.9e1 * t2636 * t5243 + 0.18e2 * t6084 * t4440 - 0.6e1 * t6087 * t4440 + 0.18e2 * t6084 * t5231 - 0.3e1 * t2053 - 0.2e1 * t2057 + 0.4e1 * t2100 + 0.4e1 * t2104 - 0.4e1 * t2123 - 0.4e1 * t2125 + 0.4e1 * t2130 - t767;
  t6097 = t762 * t532;
  t6098 = t6097 * t555;
  t6115 = t217 * t6077;
  t6125 = t531 * t6098;
  t6129 = t1390 * t2338 * t1396;
  t6130 = t2631 * t551;
  t6131 = t1487 * t6130;
  t6136 = 0.9e1 * t221 * t2648 * t531 * t536 * t551 + 0.9e1 * t1470 * t217 * t6098 - 0.18e2 * t217 * t5263 * t6083 - 0.9e1 * t6125 * t1461 - 0.9e1 * t2616 * t5260 - 0.3e1 * t2616 * t5266 + 0.9e1 * t2626 * t5243 + 0.9e1 * t2626 * t5266 + 0.9e1 * t5280 * t2633 - 0.3e1 * t2636 * t5266 - 0.6e1 * t2636 * t5284 - 0.6e1 * t6115 * t5238 + 0.18e2 * t6084 * t5263 + 0.9e1 * t6129 * t6131;
  t6140 = t2784 * params->csk_a;
  t6141 = t541 * t6140;
  t6148 = t1487 * t6140;
  t6151 = t1432 * t555;
  t6155 = t762 * t1392;
  t6156 = t1390 * t6155;
  t6159 = t294 * t4357;
  t6160 = t1390 * t6159;
  t6163 = t4382 * t6159;
  t6167 = t4509 * t754 * t1032;
  t6172 = t217 * t6159;
  t6175 = t4518 * t2115;
  t6178 = t217 * t6082;
  t6181 = 0.9e1 * t2129 * t225 * t6151 - 0.9e1 * t6125 * t1470 - 0.3e1 * t6156 * t1779 + 0.9e1 * t2626 * t5260 - 0.18e2 * t6087 * t5231 + 0.18e2 * t5289 * t6141 + 0.18e2 * t5289 * t6148 - 0.12e2 * t6163 * t5341 + 0.18e2 * t6160 * t5347 - 0.7e1 * t6163 * t5347 + 0.7e1 * t5359 * t6167 - 0.12e2 * t5380 * t6175 + 0.11e2 * t6172 * t5389 - 0.12e2 * t6178 * t5409;
  t6182 = t531 * t6082;
  t6191 = t531 * t6159;
  t6194 = t2134 * t534;
  t6195 = t217 * t6194;
  t6205 = t217 * t6155;
  t6213 = -0.3e1 * t6205 * t1779 - 0.3e1 * t6182 * t5326 + 0.3e1 * t6178 * t5329 - 0.3e1 * t6182 * t5329 + 0.6e1 * t6172 * t5335 + 0.12e2 * t6160 * t5341 - 0.7e1 * t6191 * t5347 - 0.11e2 * t6191 * t5389 - 0.6e1 * t6160 * t5396 + 0.6e1 * t6160 * t5432 - t6163 * t5432 + t6172 * t5432 - 0.7e1 * t6191 * t5432 + 0.3e1 * t6195 * t664;
  t6220 = t1397 * t2833;
  t6225 = t531 * t6155;
  t6228 = t531 * t6194;
  t6235 = t1397 * t2102;
  t6247 = t1417 * t762;
  t6249 = t1415 * t6247 * params->csk_a;
  t6252 = t4386 * t294;
  t6254 = t4526 * t6252 * params->csk_a;
  t6257 = 0.7e1 * t1391 * t4509 * t540 * t6191 * params->csk_a - 0.3e1 * t1415 * t2339 * t294 * t4452 - 0.3e1 * t2095 * t1480 + 0.9e1 * t1746 * t6220 + 0.9e1 * t1746 * t6249 + 0.9e1 * t6225 * t1779 - 0.9e1 * t6156 * t1818 + 0.6e1 * t6160 * t5335 - 0.18e2 * t6191 * t5335 - 0.6e1 * t5359 * t6175 - 0.6e1 * t5359 * t6254 - 0.18e2 * t5401 * t6235 - 0.3e1 * t6228 * t664;
  t6264 = t4526 * t6252 * t1032;
  t6271 = t4509 * t2079;
  t6275 = t1397 * t754 * t551;
  t6279 = t563 * t2071 * t555;
  t6283 = t1415 * t2075 * t555;
  t6294 = 0.9e1 * t1804 * t217 * t6097 + 0.3e1 * t2066 * t1480 + 0.9e1 * t6225 * t1788 + 0.9e1 * t1796 * t6279 - 0.3e1 * t2095 * t1810 - 0.6e1 * t6156 * t1813 + 0.9e1 * t6225 * t1818 + 0.11e2 * t5359 * t6264 - 0.18e2 * t5380 * t6271 - 0.9e1 * t5418 * t6275 - t769 * t5449 - 0.6e1 * t6163 * t5459 - 0.6e1 * t5505 * t6283 + t758 * t5519;
  t6298 = t4518 * t2075 * t1032;
  t6310 = my_piecewise3(t103, 0, -0.11e4 / 0.729e3 * t1726);
  t6311 = my_piecewise3(t105, t6310, 0);
  t6314 = t2055 * t555;
  t6318 = t531 * t2128;
  t6331 = t1397 * t2071;
  t6334 = -t217 * t226 * t6311 + 0.9e1 * t217 * t2585 * t6314 - 0.9e1 * t2647 * t531 * t5491 - 0.9e1 * t5325 * t6151 * t6318 - 0.9e1 * t1750 * t6331 - 0.9e1 * t6205 * t1788 - 0.6e1 * t2059 * t5502 + 0.3e1 * t6178 * t4354 + 0.18e2 * t5359 * t6298 - 0.11e2 * t6191 * t5442 - t769 * t5519 + 0.6e1 * t6172 * t5526 + 0.3e1 * t5530 * t755 - 0.3e1 * t6228 * t680;
  t6335 = t4518 * t2075;
  t6345 = t4509 * t754;
  t6355 = t563 * t540 * t2134;
  t6358 = t1415 * t6247;
  t6361 = t4526 * t6252;
  t6371 = -t1491 * t217 * t294 * t557 - 0.3e1 * t2134 * t217 * t219 * t557 - 0.3e1 * t217 * t551 * t557 * t762 + 0.3e1 * t1464 * t2072 - 0.3e1 * t1746 * t6358 - 0.6e1 * t6205 * t1757 + 0.3e1 * t2066 * t1772 + t4480 * t755 + t5359 * t6361 + 0.6e1 * t5380 * t6335 + 0.11e2 * t5383 * t6345 + t758 * t5553 + 0.3e1 * t6195 * t675 + 0.3e1 * t657 * t6355;
  t6375 = my_piecewise5(t102, 0, t103, 0, t6094 + t6136 + t6181 + t6213 + t6257 + t6294 + t6334 + t6371);
  t6382 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t1357 * t299 + 0.3e1 / 0.1e2 * t6015 + 0.9e1 / 0.2e2 * t7 * t506 * t775 - t5980 / 0.1e2 + 0.3e1 / 0.5e1 * t6022 + 0.9e1 / 0.2e2 * t7 * t201 * t2141 + t5941 - t5991 / 0.1e2 + 0.3e1 / 0.1e2 * t6030 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.11e4 / 0.729e3 * t1729 + 0.1e3 / 0.81e2 * t1732 - 0.25e2 / 0.54e2 * t1735 + 0.5e1 / 0.54e2 * t38 * t96 * t1504 + t1382 * t297 + 0.3e1 * t525 * t773 + 0.3e1 * t215 * t2139 + t101 * t6375));
  tv4rho3lapl7 = t8 * t6382 + 0.3e1 * t2146;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 7] += tv4rho3lapl7;

  tv4rho3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 0] += tv4rho3tau0;

  tv4rho3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 1] += tv4rho3tau1;

  tv4rho3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 2] += tv4rho3tau2;

  tv4rho3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 3] += tv4rho3tau3;

  tv4rho3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 4] += tv4rho3tau4;

  tv4rho3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 5] += tv4rho3tau5;

  tv4rho3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 6] += tv4rho3tau6;

  tv4rho3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 7] += tv4rho3tau7;

  t6389 = t7 * t324 * t804;
  t6396 = t7 * t333 * t804 / 0.3e2;
  t6398 = t7 * t133 * t2275;
  t6412 = 0.2e1 * t2163;
  t6413 = 0.2e1 * t2187;
  t6414 = 0.3e1 * t2190;
  t6416 = 0.2e1 * t2197;
  t6417 = 0.2e1 * t2199;
  t6418 = 0.2e1 * t2216;
  t6425 = t2174 * t151;
  t6426 = params->csk_a * t68 * t6425;
  t6429 = t788 * t1025;
  t6430 = t1020 * t6429;
  t6431 = t1032 * t363;
  t6432 = t365 * t357;
  t6433 = t6432 * t380;
  t6434 = t6431 * t6433;
  t6437 = 0.12e2 * t4751 * t6426 - 0.18e2 * t6430 * t6434 - 0.4e1 * t2195 + 0.4e1 * t2222 + 0.4e1 * t2238 - 0.4e1 * t2259 + 0.4e1 * t2265 - 0.4e1 * t2269 + t6412 + t6413 - t6414 + t6416 - t6417 - t6418 - t794 - t796;
  t6442 = t1032 * t357 * t380;
  t6443 = t157 * t6442;
  t6446 = t1107 * t6442;
  t6449 = t356 * t6429;
  t6452 = t792 * t153;
  t6454 = t356 * t6452 * t361;
  t6455 = t366 * t1646;
  t6457 = 0.3e1 * t6454 * t6455;
  t6461 = t792 * t357 * t380;
  t6464 = 0.3e1 * t149 * t6461 * t1097;
  t6467 = 0.3e1 * t356 * t6461 * t1097;
  t6472 = t2218 * t1025;
  t6475 = t157 * t369 * params->csk_a;
  t6482 = t1032 * t68 * t6425;
  t6489 = t1032 * t151;
  t6490 = t6489 * t605;
  t6491 = t366 * t6490;
  t6494 = t4742 * t153;
  t6495 = t366 * t6494;
  t6498 = -0.6e1 * t149 * t6429 * t6443 - 0.18e2 * t149 * t6472 * t6475 + 0.18e2 * t356 * t6472 * t6475 - 0.3e1 * t2256 * t6495 - 0.4e1 * t2505 * t6482 - 0.12e2 * t4741 * t6426 - 0.4e1 * t4741 * t6482 + 0.12e2 * t4751 * t6482 + 0.12e2 * t4751 * t6491 - 0.6e1 * t6430 * t6443 - 0.12e2 * t6430 * t6446 + 0.18e2 * t6430 * t6455 + 0.18e2 * t6449 * t6434 + 0.18e2 * t6449 * t6443 - t6457 + t6464 - t6467;
  t6500 = t4742 * t1096;
  t6504 = t157 * t4742 * t380;
  t6508 = t1020 * t2180 * t1025;
  t6509 = t2499 * t605;
  t6514 = t151 * t380 * t605;
  t6518 = t1107 * t1646;
  t6532 = t1107 * t6490;
  t6535 = t785 * t357;
  t6539 = t785 * t3509;
  t6540 = t356 * t6539;
  t6541 = t389 * t357;
  t6542 = t388 * t6541;
  t6545 = t785 * t3519;
  t6546 = t356 * t6545;
  t6547 = t3767 * t1584;
  t6550 = t1020 * t6545;
  t6553 = t1094 * t1584;
  t6556 = t149 * t6545;
  t6559 = t3659 * t1623;
  t6562 = -0.3e1 * t2256 * t6500 + 0.3e1 * t2262 * t6504 + 0.12e2 * t6508 * t1107 * t6509 + 0.12e2 * t2524 * t366 * t6514 + 0.18e2 * t6430 * t6518 + 0.12e2 * t149 * t2191 * t361 * t157 * t4779 * t605 + 0.12e2 * t6508 * t366 * t6509 - 0.12e2 * t2505 * t6491 - 0.8e1 * t2505 * t6532 + 0.3e1 * t149 * t6535 * t4848 - 0.3e1 * t6540 * t6542 - 0.18e2 * t6546 * t6547 + 0.6e1 * t6550 * t6547 - 0.3e1 * t6540 * t6553 + 0.6e1 * t6556 * t6547 - 0.6e1 * t6550 * t6559;
  t6564 = t3647 * t1048 * t357;
  t6568 = t1031 * t1570 * t359;
  t6572 = t3754 * t3755 * t357;
  t6578 = t3531 * t6545;
  t6580 = t1026 * t3051;
  t6582 = 0.3e1 * t1560 * t6580;
  t6583 = t792 * t1021;
  t6584 = t149 * t6583;
  t6585 = t6584 * t1585;
  t6586 = t356 * t6583;
  t6588 = 0.3e1 * t6586 * t1585;
  t6590 = t3659 * t3710 * t357;
  t6594 = t3647 * t3716 * t357;
  t6598 = 0.3e1 * t6586 * t1617;
  t6599 = t3647 * t6541;
  t6602 = t1020 * t6583;
  t6604 = 0.3e1 * t6602 * t1617;
  t6611 = -0.12e2 * t2219 * t6568 - 0.11e2 * t6546 * t6564 - 0.7e1 * t6546 * t6572 - 0.7e1 * t6546 * t6594 + 0.6e1 * t6550 * t6572 + 0.12e2 * t6550 * t6590 - 0.18e2 * t6550 * t6599 + t6556 * t6572 + 0.7e1 * t6578 * t6564 - t6578 * t6572 - 0.12e2 * t6578 * t6590 - 0.7e1 * t6578 * t6594 + t6582 - t6585 + t6588 + t6598 - t6604;
  t6617 = 0.3e1 * t6584 * t1594;
  t6619 = 0.3e1 * t6586 * t1594;
  t6621 = t3754 * t1570 * params->csk_a;
  t6627 = t3670 * t3684 * t357;
  t6632 = t6602 * t1585;
  t6633 = t357 * t3519;
  t6634 = t3531 * t6633;
  t6641 = t1094 * t157 * t1652;
  t6650 = t388 * t389 * t1652;
  t6655 = t1020 * t369;
  t6660 = -0.6e1 * t1041 * t2182 * t380 * t6655 - 0.6e1 * t2182 * t3659 * t6634 * params->csk_a + 0.18e2 * t3054 * t3659 * t6634 - t2165 * t3636 + 0.3e1 * t2169 * t3618 - 0.3e1 * t2207 * t3618 + 0.3e1 * t2235 * t3614 - 0.2e1 * t614 * t6641 - 0.2e1 * t614 * t6650 - 0.11e2 * t6546 * t6621 + 0.18e2 * t6550 * t6594 + 0.11e2 * t6556 * t6621 - 0.6e1 * t6578 * t6627 - t6617 + t6619 - t6632;
  t6670 = t2198 * t1621;
  t6671 = t1043 * t792;
  t6673 = t1041 * t6671 * params->csk_a;
  t6675 = 0.3e1 * t1560 * t6673;
  t6677 = 0.2e1 * t6602 * t1624;
  t6679 = t371 * t1551 * t153;
  t6682 = t365 * t785;
  t6683 = t6682 * t380;
  t6687 = t1031 * t6425;
  t6694 = t3535 * t785;
  t6707 = t388 * t2185 * t380;
  t6709 = 0.3e1 * t1601 * t6707;
  t6714 = 0.3e1 * t149 * t6452 * t371 * t1570 * t380;
  t6717 = -0.12e2 * t1591 * t1026 * t2170 * t605 - 0.12e2 * t6550 * t3659 * t1043 * t357 * params->csk_a - t6670 + t6675 - t6677 + 0.3e1 * t2219 * t6679 - 0.18e2 * t386 * t1026 * t6683 - 0.8e1 * t1569 * t6687 + 0.7e1 * t6546 * t6599 - 0.2e1 * t2207 * t3627 + 0.11e2 * t6634 * t3670 * t6694 * t1032 + 0.3e1 * t2169 * t3636 - t2207 * t3636 - 0.4e1 * t2181 * t1041 * t1561 * t605 + t6709 + t6714 + 0.3e1 * t2207 * t3623;
  t6727 = t2162 * t1081;
  t6728 = t2198 * t1081;
  t6733 = t605 * t605;
  t6734 = t149 * t6733;
  t6742 = t2455 * t6514;
  t6754 = t371 * t1570;
  t6757 = t3754 * t1570;
  t6761 = 0.2e1 * t6584 * t1571;
  t6762 = -0.6e1 * t6634 * t3670 * t6694 * params->csk_a + 0.2e1 * t599 * t6641 + 0.3e1 * t2207 * t3639 + t6727 - t6728 + 0.3e1 * t2169 * t3600 - 0.3e1 * t2165 * t3600 - 0.2e1 * t6734 * t382 + 0.2e1 * t6734 * t384 + 0.2e1 * t356 * t6733 * t367 - 0.12e2 * t2524 * t6742 - 0.12e2 * t2524 * t4844 * t6514 + 0.12e2 * t1644 * t6742 + 0.3e1 * t356 * t6535 * t3515 + 0.3e1 * t149 * t6539 * t6754 + 0.6e1 * t6556 * t6757 - t6761;
  t6763 = t6733 * t359;
  t6767 = t356 * t6763;
  t6775 = t1084 * t2186;
  t6776 = t1041 * t6671;
  t6777 = t1560 * t6776;
  t6780 = t149 * t792 * t376 * t382;
  t6781 = t156 * t1652;
  t6785 = t2162 * t1552;
  t6786 = t1026 * t2185;
  t6788 = 0.3e1 * t1564 * t6786;
  t6797 = t1020 * t6633;
  t6801 = t371 * t6781;
  t6806 = 0.2e1 * t149 * t6763 * t373 - 0.2e1 * t6767 * t390 - 0.2e1 * t6767 * t373 - t3580 * t2183 + t6634 * t3670 * t6694 + t6775 - t6777 - t6780 - 0.2e1 * t2192 * t2193 * t6781 + t6785 - t6788 - 0.2e1 * t2165 * t3651 + 0.11e2 * t356 * t6633 * t3647 * t6682 - 0.3e1 * t2169 * t3743 + 0.6e1 * t6797 * t3659 * t2182 + 0.2e1 * t599 * t6801 + 0.2e1 * t614 * t5024;
  t6810 = my_piecewise5(t58, 0, t61, 0, t6437 + t6498 + t6562 + t6611 + t6660 + t6717 + t6762 + t6806);
  t6817 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t804 + t6389 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t2275 - t6396 + t6398 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.88e3 / 0.729e3 * t38 * t342 * t248 + 0.16e3 / 0.243e3 * t38 * t139 * t620 - 0.1e2 / 0.81e2 * t38 * t43 * t1657 + t350 * t802 + 0.2e1 * t147 * t2273 + t53 * t6810));
  tv4rho2sigma20 = t8 * t6817 + 0.2e1 * t2280;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6824 = t7 * t415 * t831;
  t6828 = t7 * t419 * t831 / 0.3e2;
  t6830 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t831 + t6824 / 0.5e1 - t6828);
  tv4rho2sigma25 = t8 * t6830 + 0.2e1 * t2289;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6836 = t7 * t440 * t804;
  t6844 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t804 + t6836 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t2275 + t6389 / 0.1e2 - t6396 + t6398 / 0.1e2);
  tv4rho2sigma26 = t8 * t6844 + t2280 + t2295;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6850 = t7 * t463 * t831;
  t6857 = t7 * t177 * t2421;
  t6860 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t831 + t6850 / 0.1e2 + t6824 / 0.1e2 - t6828 + 0.3e1 / 0.2e2 * t7 * t173 * t2421 + t6857 / 0.1e2);
  tv4rho2sigma211 = t8 * t6860 + t2289 + t2426;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6868 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t804 + t6836 / 0.5e1 - t6396);
  tv4rho2sigma212 = t8 * t6868 + 0.2e1 * t2295;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6891 = 0.2e1 * t2309;
  t6892 = 0.3e1 * t2312;
  t6894 = 0.2e1 * t2333;
  t6895 = 0.2e1 * t2343;
  t6896 = 0.2e1 * t2345;
  t6898 = 0.2e1 * t2383;
  t6903 = t815 * t1396;
  t6904 = t1390 * t6903;
  t6906 = t1032 * t532 * t555;
  t6907 = t1487 * t6906;
  t6912 = t225 * params->csk_a * t668 * t219;
  t6915 = -0.12e2 * t5257 * t6912 - 0.12e2 * t6904 * t6907 - 0.4e1 * t2318 + 0.4e1 * t2371 + 0.4e1 * t2388 - 0.4e1 * t2405 + 0.4e1 * t2411 - 0.4e1 * t2415 + t6891 - t6892 + t6894 + t6895 - t6896 - t6898 - t821 - t823;
  t6916 = t531 * t6903;
  t6917 = t541 * t6906;
  t6920 = t819 * t221;
  t6923 = t541 * t1842;
  t6925 = 0.3e1 * t531 * t6920 * t536 * t6923;
  t6930 = t2384 * t1396;
  t6933 = t225 * t544 * params->csk_a;
  t6939 = t819 * t532 * t555;
  t6942 = 0.3e1 * t217 * t6939 * t1470;
  t6945 = 0.3e1 * t531 * t6939 * t1470;
  t6946 = t1032 * t538;
  t6947 = t2327 * t668;
  t6948 = t6946 * t6947;
  t6955 = t225 * t668;
  t6956 = t1032 * t219 * t6955;
  t6971 = t1487 * t1842;
  t6974 = t2617 * t668;
  t6978 = 0.12e2 * t217 * t225 * t2313 * t5318 * t536 * t668 + 0.12e2 * t1487 * t6129 * t6974 - 0.18e2 * t217 * t6930 * t6933 + 0.18e2 * t531 * t6930 * t6933 - 0.12e2 * t2630 * t6948 - 0.4e1 * t2630 * t6956 - 0.4e1 * t5257 * t6956 + 0.12e2 * t5272 * t6912 + 0.12e2 * t5272 * t6948 + 0.12e2 * t5272 * t6956 - 0.18e2 * t6904 * t6917 + 0.18e2 * t6904 * t6923 + 0.18e2 * t6904 * t6971 + 0.18e2 * t6916 * t6917 - t6925 + t6942 - t6945;
  t6982 = t1487 * t1032 * t668 * t219;
  t6986 = t219 * t555 * t668;
  t6990 = t5258 * t221;
  t6991 = t541 * t6990;
  t6995 = t225 * t5258 * t555;
  t6998 = t5258 * t1469;
  t7005 = t225 * t6906;
  t7012 = t812 * t4357;
  t7013 = t1390 * t7012;
  t7014 = t4518 * t1812;
  t7017 = t540 * t532;
  t7022 = t531 * t7012;
  t7023 = t4509 * t1817;
  t7027 = t1402 * t1756 * t534;
  t7030 = t4522 * t1787;
  t7033 = t4382 * t7012;
  t7035 = t1397 * t3123;
  t7037 = 0.3e1 * t1746 * t7035;
  t7038 = -0.18e2 * t1397 * t555 * t7017 * t825 - 0.6e1 * t217 * t6903 * t7005 + 0.12e2 * t2646 * t541 * t6986 + 0.12e2 * t541 * t6129 * t6974 - 0.12e2 * t2385 * t7027 - 0.3e1 * t2402 * t6991 - 0.3e1 * t2402 * t6998 + 0.3e1 * t2408 * t6995 - 0.8e1 * t2630 * t6982 - 0.6e1 * t6904 * t7005 + 0.18e2 * t6916 * t7005 - 0.6e1 * t7013 * t7014 + 0.6e1 * t7013 * t7030 - 0.11e2 * t7022 * t7023 - t7033 * t7030 + t7037;
  t7039 = t819 * t1392;
  t7040 = t217 * t7039;
  t7041 = t7040 * t1779;
  t7042 = t531 * t7039;
  t7044 = 0.3e1 * t7042 * t1779;
  t7045 = t541 * t532;
  t7046 = t4522 * t7045;
  t7050 = t4518 * t5339 * t532;
  t7053 = t7017 * params->csk_a;
  t7054 = t4509 * t7053;
  t7060 = 0.3e1 * t7042 * t1818;
  t7061 = t1390 * t7039;
  t7063 = 0.3e1 * t7061 * t1818;
  t7071 = 0.3e1 * t7040 * t1788;
  t7073 = 0.3e1 * t7042 * t1788;
  t7074 = t217 * t7012;
  t7076 = t4566 * t1756 * params->csk_a;
  t7085 = 0.3e1 * t2326 * t4458 - 0.3e1 * t2353 * t4458 + 0.18e2 * t7013 * t7046 + 0.12e2 * t7013 * t7050 - 0.18e2 * t7013 * t7054 - 0.7e1 * t7022 * t7046 + 0.7e1 * t7022 * t7054 - 0.11e2 * t7022 * t7076 + 0.7e1 * t7033 * t7023 - 0.7e1 * t7033 * t7046 + 0.11e2 * t7074 * t7076 - t7041 + t7044 + t7060 - t7063 - t7071 + t7073;
  t7088 = t532 * t4357;
  t7089 = t4382 * t7088;
  t7096 = t563 * t564 * t1848;
  t7101 = t4386 * t812;
  t7107 = t4526 * t4531 * t532;
  t7114 = 0.3e1 * t217 * t6920 * t546 * t1756 * t555;
  t7115 = t7061 * t1779;
  t7120 = t1467 * t225 * t1848;
  t7132 = t2344 * t1810;
  t7133 = 0.11e2 * t1032 * t4526 * t7089 * t7101 - 0.6e1 * t2340 * t4518 * t7089 * params->csk_a + 0.18e2 * t3126 * t4518 * t7089 + 0.3e1 * t2326 * t4422 - t2334 * t4422 + 0.3e1 * t2353 * t4425 - 0.2e1 * t2353 * t4472 - 0.2e1 * t677 * t7096 - 0.2e1 * t677 * t7120 - 0.7e1 * t7022 * t7030 + t7074 * t7030 - 0.12e2 * t7033 * t7050 - 0.6e1 * t7033 * t7107 + t7114 - t7115 - t7132;
  t7134 = t1417 * t819;
  t7136 = t1415 * t7134 * params->csk_a;
  t7138 = 0.3e1 * t1746 * t7136;
  t7140 = 0.2e1 * t7061 * t1813;
  t7142 = t546 * t1771 * t221;
  t7146 = t1402 * t674 * t668;
  t7151 = t1390 * t544;
  t7173 = t563 * t2307 * t555;
  t7175 = 0.3e1 * t1796 * t7173;
  t7176 = t2344 * t1480;
  t7181 = t2332 * t1480;
  t7183 = t7138 - t7140 + 0.3e1 * t2385 * t7142 - 0.8e1 * t1755 * t7146 + 0.3e1 * t2368 * t4413 - 0.6e1 * t7151 * t1415 * t2340 * t555 - 0.12e2 * t1781 * t1397 * t6947 - 0.12e2 * t7013 * t4518 * t1417 * t532 * params->csk_a + 0.3e1 * t2353 * t4454 - 0.6e1 * t7089 * t4526 * t7101 * params->csk_a + 0.2e1 * t662 * t7120 + t7175 - t7176 + 0.3e1 * t2326 * t4462 - 0.3e1 * t2334 * t4462 + t7181 - t2353 * t4422;
  t7189 = t812 * t4348;
  t7190 = t531 * t7189;
  t7191 = t563 * t7053;
  t7194 = t1467 * t1787;
  t7197 = t812 * t532;
  t7201 = t4566 * t1778;
  t7208 = t668 * t668;
  t7209 = t217 * t7208;
  t7217 = t2588 * t6986;
  t7225 = t224 * t1848;
  t7229 = t546 * t7225;
  t7236 = -0.4e1 * t2339 * t1415 * t1747 * t668 - 0.3e1 * t7190 * t7191 - 0.3e1 * t7190 * t7194 + 0.3e1 * t217 * t7197 * t5329 + 0.6e1 * t7074 * t7201 - 0.18e2 * t7022 * t7201 + 0.6e1 * t7013 * t7201 - 0.2e1 * t7209 * t557 + 0.2e1 * t7209 * t559 + 0.2e1 * t531 * t7208 * t542 - 0.12e2 * t2646 * t7217 - 0.12e2 * t2646 * t5325 * t6986 + 0.12e2 * t1840 * t7217 - 0.2e1 * t2314 * t2315 * t7225 + 0.2e1 * t662 * t7229 + 0.2e1 * t677 * t5559 - 0.3e1 * t2326 * t4586;
  t7237 = t1390 * t7088;
  t7241 = t2332 * t1772;
  t7242 = t1397 * t2307;
  t7244 = 0.3e1 * t1750 * t7242;
  t7245 = t1402 * t1771;
  t7251 = t1464 * t2308;
  t7252 = t1415 * t7134;
  t7253 = t1746 * t7252;
  t7256 = t217 * t819 * t551 * t557;
  t7257 = t7208 * t534;
  t7258 = t531 * t7257;
  t7267 = 0.2e1 * t7040 * t1757;
  t7269 = t546 * t1756;
  t7272 = t4566 * t1756;
  t7281 = 0.2e1 * t217 * t548 * t7257 + 0.3e1 * t217 * t7189 * t7269 + 0.6e1 * t2340 * t4518 * t7237 + 0.3e1 * t4350 * t531 * t7197 + 0.11e2 * t4509 * t7017 * t7022 + t4526 * t7089 * t7101 - 0.2e1 * t2334 * t7245 - t4432 * t2341 - 0.2e1 * t7258 * t548 - 0.2e1 * t7258 * t565 + 0.6e1 * t7074 * t7272 + t7241 - t7244 + t7251 - t7253 - t7256 - t7267;
  t7285 = my_piecewise5(t102, 0, t103, 0, t6915 + t6978 + t7038 + t7085 + t7133 + t7183 + t7236 + t7281);
  t7292 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t831 + t6850 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t2421 - t6828 + t6857 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.88e3 / 0.729e3 * t38 * t517 * t265 + 0.16e3 / 0.243e3 * t38 * t207 * t683 - 0.1e2 / 0.81e2 * t38 * t91 * t1853 + t525 * t829 + 0.2e1 * t215 * t2419 + t101 * t7285));
  tv4rho2sigma217 = t8 * t7292 + 0.2e1 * t2426;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7299 = t7 * t324 * t859;
  t7306 = t7 * t333 * t859 / 0.3e2;
  t7308 = t7 * t133 * t2536;
  t7334 = t4821 * t3521;
  t7335 = t3531 * t7334;
  t7336 = t278 * t1032;
  t7341 = t5712 * t3521;
  t7342 = t3531 * t7341;
  t7343 = t3683 * t245;
  t7344 = t7343 * t1616;
  t7347 = t356 * t7341;
  t7350 = t149 * t7341;
  t7351 = t2490 * t357;
  t7352 = t157 * t7351;
  t7355 = 0.7e1 * t357 * t366 * t7335 * t7336 - 0.7e1 * t7342 * t7344 - 0.7e1 * t7347 * t7344 + 0.6e1 * t7350 * t7352 - 0.2e1 * t2449 - 0.2e1 * t2452 + 0.4e1 * t2458 - 0.4e1 * t2464 - 0.4e1 * t2468 + 0.4e1 * t2496 + 0.4e1 * t2527 + t6412 + t6413 - t6414 + t6416 - t6417 - t6418 - t794 - t848;
  t7356 = t7343 * t357;
  t7357 = t157 * t7356;
  t7361 = t1020 * t7341;
  t7365 = t6633 * t3521;
  t7366 = t3531 * t7365;
  t7367 = t846 * params->csk_a;
  t7368 = t1107 * t7367;
  t7377 = t1107 * t7356;
  t7380 = t5743 * t1025;
  t7381 = t149 * t7380;
  t7384 = t356 * t7380;
  t7401 = t356 * t846 * t3509;
  t7406 = t1645 * t3226;
  t7412 = 0.3e1 * t149 * t1933 * t3509 * t844 - 0.6e1 * t1107 * t7351 * t7361 - 0.11e2 * t366 * t7347 * t7351 + 0.6e1 * t2489 * t6426 - 0.12e2 * t2495 * t6568 - 0.6e1 * t2498 * t6426 - 0.6e1 * t7381 * t2501 + 0.6e1 * t7384 * t2501 - 0.3e1 * t7401 * t6542 - 0.3e1 * t7401 * t6553 - t7342 * t7357 + 0.18e2 * t7361 * t7344 - 0.18e2 * t7347 * t7352 - 0.7e1 * t7347 * t7357 - 0.11e2 * t7347 * t7406 + t7350 * t7357 + 0.6e1 * t7361 * t7352 + 0.6e1 * t7361 * t7357 + 0.12e2 * t7361 * t7377 - 0.6e1 * t7366 * t7368;
  t7418 = t1020 * t7365;
  t7429 = t1020 * t4864 * t1025;
  t7433 = t711 * params->csk_a * t151;
  t7434 = t366 * t7433;
  t7445 = t1020 * t7380;
  t7450 = t1107 * t7433;
  t7453 = t2447 * t380;
  t7454 = t149 * t7453;
  t7457 = t2450 * t380;
  t7458 = t149 * t7457;
  t7466 = t4742 * t3226;
  t7474 = -0.18e2 * t356 * t4725 * t366 * t1956 - 0.12e2 * t7418 * t7368 + 0.7e1 * t356 * t7334 * t366 * t1933 * params->csk_a + 0.11e2 * t7350 * t7406 + 0.6e1 * t7429 * t2508 + 0.6e1 * t2505 * t7434 - 0.2e1 * t7381 * t2511 + 0.6e1 * t7384 * t2511 - 0.2e1 * t2498 * t6482 + 0.6e1 * t2489 * t6482 - 0.2e1 * t7445 * t2511 - 0.2e1 * t2515 * t6482 + 0.6e1 * t2505 * t7450 + 0.6e1 * t7454 * t2221 + 0.6e1 * t7458 * t2221 - 0.4e1 * t2515 * t6532 - 0.6e1 * t7366 * t3536 * t7367 + 0.3e1 * t2489 * t7466 - 0.18e2 * t7418 * t366 * t7367 - 0.6e1 * t7445 * t2492;
  t7494 = t2490 * t5000;
  t7498 = t2506 * t376;
  t7505 = t2490 * t376;
  t7506 = t366 * t7505;
  t7513 = t7336 * t245;
  t7530 = -0.6e1 * t2515 * t6491 - 0.4e1 * t7445 * t2521 + 0.6e1 * t7384 * t2492 + 0.6e1 * t2489 * t6491 + 0.6e1 * t356 * t605 * t153 * t361 * t2526 + 0.6e1 * t7429 * t2529 + 0.6e1 * t2524 * t366 * t1886 * t380 - t2515 * t7494 - 0.3e1 * t2498 * t7466 + 0.3e1 * t2505 * t366 * t7498 + 0.3e1 * t2505 * t1107 * t7498 + 0.3e1 * t2489 * t7506 + 0.3e1 * t2495 * t6679 - 0.3e1 * t2515 * t7506 + 0.18e2 * t7366 * t1107 * t7513 - 0.12e2 * t7342 * t7377 - 0.2e1 * t2515 * t1107 * t7505 + 0.11e2 * t7366 * t3536 * t7513 - 0.6e1 * t7342 * t3536 * t7356 + 0.3e1 * t2524 * t5694;
  t7534 = t1020 * t369 * t1025;
  t7563 = -0.6e1 * t7534 * t1107 * t2460 - t2498 * t7494 + 0.3e1 * t2489 * t7494 - t6457 + t6464 - t6467 - 0.2e1 * t1906 * t1031 * t849 * t376 - t718 * t6641 - t5799 * t854 - 0.2e1 * t1925 * t2231 - t718 * t6650 - t3580 * t2478 + t6634 * t3670 * t4932 * t278 - 0.3e1 * t1591 * t5814 + t5780 * t844 + 0.2e1 * t1910 * t2225 + t707 * t6641 - t5799 * t844 - 0.2e1 * t1925 * t2225;
  t7565 = t1041 * t4969 * t278;
  t7580 = t366 * t278;
  t7581 = t3510 * t7580;
  t7601 = -0.2e1 * t2181 * t7565 - 0.2e1 * t2181 * t1041 * t1561 * t711 + 0.3e1 * t847 * t3510 * t1584 + 0.6e1 * t5713 * t3754 * t849 * t357 + 0.3e1 * t356 * t1606 * t7581 + 0.11e2 * t4853 * t3647 * t703 * t357 + 0.6e1 * t6797 * t3659 * t2477 - 0.4e1 * t5783 * t2485 - 0.4e1 * t1906 * t6687 - 0.6e1 * t4865 * t2481 - 0.6e1 * t1591 * t1026 * t1895 * t151 + t6582 - t6585 + t6588 + t6598 - t6604 - t6617 + t6619 - t6632 - t6670;
  t7603 = t356 * t7453;
  t7608 = t356 * t7457;
  t7612 = t1066 * t357 * t3549;
  t7619 = t157 * t1032;
  t7623 = t1582 * t357;
  t7624 = t7623 * t3549;
  t7627 = t1020 * t2460;
  t7630 = t1020 * t5643;
  t7631 = t1107 * t1032;
  t7635 = t356 * t5643;
  t7636 = t366 * t1032;
  t7646 = t1020 * t4725;
  t7647 = t1107 * t278;
  t7651 = -0.6e1 * t1636 * t5644 * t7619 - 0.12e2 * t1636 * t7630 * t7631 + 0.18e2 * t1636 * t7635 * t7636 + 0.18e2 * t1646 * t7646 * t7647 + 0.3e1 * t1964 * t2455 * t4704 - 0.3e1 * t2461 * t2462 * t6494 + 0.18e2 * t2461 * t7612 + 0.18e2 * t2461 * t7624 + 0.6e1 * t7454 * t2467 + 0.6e1 * t7458 * t2467 - 0.6e1 * t7603 * t2467 - 0.6e1 * t7608 * t2467 - 0.18e2 * t2495 * t7612 - 0.6e1 * t7627 * t7624 + t6675 - t6677 + t6709 + t6714 + t6727 - t6728;
  t7684 = -0.3e1 * t2461 * t5001 + 0.18e2 * t7534 * t7580 * t3211 - 0.18e2 * t7627 * t7623 * t359 * t363 * t365 - 0.6e1 * t7603 * t2463 - 0.6e1 * t7608 * t2463 - t6761 + t6775 - t6777 - t6780 + t6785 - t6788 - t149 * t278 * t1652 * t382 + t5780 * t850 + 0.2e1 * t1910 * t2175 + t707 * t6801 + t4941 * t704 + 0.2e1 * t1578 * t1896 + t614 * t5895 - t149 * t1969 * t245 * t382 - 0.2e1 * t149 * t711 * t605 * t382;
  t7688 = my_piecewise5(t58, 0, t61, 0, t7355 + t7412 + t7474 + t7530 + t7563 + t7601 + t7651 + t7684);
  t7695 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t859 + t7299 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t2536 - t7306 + t7308 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (0.1e3 / 0.243e3 * t2155 - 0.25e2 / 0.81e2 * t2158 + 0.5e1 / 0.54e2 * t38 * t48 * t1657 - 0.44e3 / 0.729e3 * t38 * t342 * t281 + 0.8e2 / 0.243e3 * t38 * t139 * t722 - 0.5e1 / 0.81e2 * t38 * t43 * t1974 + t350 * t857 + 0.2e1 * t147 * t2534 + t53 * t7688));
  tv4rho2sigmalapl0 = t8 * t7695 + 0.2e1 * t2541;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmalapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 1] += tv4rho2sigmalapl1;

  tv4rho2sigmalapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 2] += tv4rho2sigmalapl2;

  tv4rho2sigmalapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 3] += tv4rho2sigmalapl3;

  tv4rho2sigmalapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 4] += tv4rho2sigmalapl4;

  t7702 = t7 * t415 * t887;
  t7706 = t7 * t419 * t887 / 0.3e2;
  t7708 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t887 + t7702 / 0.5e1 - t7706);
  tv4rho2sigmalapl5 = t8 * t7708 + 0.2e1 * t2550;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 5] += tv4rho2sigmalapl5;

  t7714 = t7 * t440 * t859;
  t7722 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t859 + t7714 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t2536 + t7299 / 0.1e2 - t7306 + t7308 / 0.1e2);
  tv4rho2sigmalapl6 = t8 * t7722 + t2541 + t2556;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 6] += tv4rho2sigmalapl6;

  tv4rho2sigmalapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 7] += tv4rho2sigmalapl7;

  tv4rho2sigmalapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 8] += tv4rho2sigmalapl8;

  tv4rho2sigmalapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 9] += tv4rho2sigmalapl9;

  tv4rho2sigmalapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 10] += tv4rho2sigmalapl10;

  t7728 = t7 * t463 * t887;
  t7735 = t7 * t177 * t2663;
  t7738 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t887 + t7728 / 0.1e2 + t7702 / 0.1e2 - t7706 + 0.3e1 / 0.2e2 * t7 * t173 * t2663 + t7735 / 0.1e2);
  tv4rho2sigmalapl11 = t8 * t7738 + t2550 + t2668;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 11] += tv4rho2sigmalapl11;

  t7746 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t859 + t7714 / 0.5e1 - t7306);
  tv4rho2sigmalapl12 = t8 * t7746 + 0.2e1 * t2556;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 12] += tv4rho2sigmalapl12;

  tv4rho2sigmalapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 13] += tv4rho2sigmalapl13;

  tv4rho2sigmalapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 14] += tv4rho2sigmalapl14;

  tv4rho2sigmalapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 15] += tv4rho2sigmalapl15;

  tv4rho2sigmalapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 16] += tv4rho2sigmalapl16;

  t7779 = t2576 * t555;
  t7780 = t217 * t7779;
  t7783 = t531 * t7779;
  t7786 = t2579 * t555;
  t7787 = t217 * t7786;
  t7790 = t531 * t7786;
  t7794 = t1436 * t532 * t4439;
  t7797 = t225 * t1032;
  t7801 = t1410 * t532;
  t7802 = t7801 * t4439;
  t7805 = t1390 * t2582;
  t7810 = t1487 * t1032;
  t7814 = -0.12e2 * t1832 * t6078 * t7810 - 0.6e1 * t1832 * t6115 * t7797 + 0.18e2 * t2583 * t7794 + 0.18e2 * t2583 * t7802 + 0.6e1 * t7780 * t2585 - 0.6e1 * t7783 * t2585 + 0.6e1 * t7787 * t2585 - 0.6e1 * t7790 * t2585 - 0.18e2 * t2656 * t7794 - 0.6e1 * t7805 * t7802 - 0.2e1 * t2578 - 0.2e1 * t2581 - 0.4e1 * t2586 + 0.4e1 * t2591 - 0.4e1 * t2595 + t6891 - t6892 + t6894 - t876;
  t7815 = t531 * t6077;
  t7816 = t541 * t1032;
  t7826 = t6159 * t4359;
  t7827 = t217 * t7826;
  t7828 = t2622 * t532;
  t7829 = t225 * t7828;
  t7832 = t3683 * t262;
  t7833 = t7832 * t532;
  t7834 = t225 * t7833;
  t7836 = t531 * t7826;
  t7839 = t1390 * t7826;
  t7842 = t4382 * t7826;
  t7844 = t6155 * t1396;
  t7845 = t1390 * t7844;
  t7850 = t7088 * t4359;
  t7851 = t4382 * t7850;
  t7852 = t874 * params->csk_a;
  t7853 = t1487 * t7852;
  t7860 = t7832 * t7045;
  t7863 = 0.18e2 * t1832 * t7815 * t7816 - 0.6e1 * t2616 * t6912 + 0.6e1 * t2626 * t6912 - 0.6e1 * t2636 * t6948 - 0.6e1 * t7845 * t2640 + 0.6e1 * t7827 * t7829 + t7827 * t7834 - 0.18e2 * t7836 * t7829 + 0.6e1 * t7839 * t7829 - 0.7e1 * t7836 * t7834 + 0.6e1 * t7839 * t7834 - t7842 * t7834 + 0.18e2 * t7839 * t7860 - 0.6e1 * t7851 * t7853 + 0.4e1 * t2649 + 0.4e1 * t2657 + t6895 - t6896 - t6898 - t821;
  t7865 = t1487 * t7833;
  t7868 = t217 * t7844;
  t7871 = t531 * t7844;
  t7874 = t5332 * t4359;
  t7875 = t4382 * t7874;
  t7876 = t294 * t1032;
  t7886 = t531 * t874 * t4348;
  t7902 = t1841 * t3296;
  t7913 = t1390 * t5363 * t1396;
  t7917 = t762 * params->csk_a * t219;
  t7918 = t541 * t7917;
  t7925 = t1390 * t7850;
  t7928 = 0.12e2 * t7839 * t7865 - 0.6e1 * t7868 * t2619 + 0.6e1 * t7871 * t2619 + 0.7e1 * t7875 * t541 * t7876 * t532 - 0.7e1 * t7842 * t7860 - 0.7e1 * t7836 * t7860 - 0.3e1 * t7886 * t7191 - 0.18e2 * t531 * t5234 * t541 * t2121 - 0.11e2 * t7836 * t541 * t7828 + 0.3e1 * t217 * t2098 * t4348 * t872 - 0.3e1 * t7886 * t7194 - 0.11e2 * t7836 * t7902 - 0.6e1 * t7839 * t1487 * t7828 - 0.2e1 * t2636 * t6956 + 0.11e2 * t7827 * t7902 + 0.6e1 * t7913 * t2633 + 0.6e1 * t2630 * t7918 + 0.6e1 * t7871 * t2640 + 0.6e1 * t2626 * t6948 - 0.12e2 * t7925 * t7853;
  t7942 = t5258 * t3296;
  t7963 = t541 * t2051 * t555;
  t7966 = t1487 * t7917;
  t7975 = t2622 * t551;
  t7976 = t541 * t7975;
  t7983 = -0.2e1 * t7868 * t2624 + 0.6e1 * t7871 * t2624 - 0.2e1 * t2616 * t6956 + 0.6e1 * t2626 * t6956 - 0.2e1 * t7845 * t2624 + 0.3e1 * t2646 * t541 * t6314 + 0.3e1 * t2626 * t7942 - 0.18e2 * t7925 * t541 * t7852 - 0.6e1 * t7851 * t4387 * t7852 - 0.4e1 * t7845 * t2643 - 0.4e1 * t2636 * t6982 + 0.6e1 * t531 * t668 * t221 * t536 * t2648 + 0.6e1 * t7913 * t2651 + 0.6e1 * t2646 * t7963 + 0.6e1 * t2630 * t7966 + 0.6e1 * t7780 * t2387 + 0.6e1 * t7787 * t2387 + 0.3e1 * t2630 * t6131 + 0.3e1 * t2626 * t7976 + 0.7e1 * t7836 * t541 * t1801 * params->csk_a;
  t7988 = t7876 * t262;
  t8007 = t1390 * t544 * t1396;
  t8011 = t5241 * t3296;
  t8028 = t1415 * t5468 * t294;
  t8031 = -0.3e1 * t2636 * t7976 + 0.18e2 * t7851 * t1487 * t7988 - 0.12e2 * t7842 * t7865 - 0.2e1 * t2636 * t1487 * t7975 + 0.11e2 * t7851 * t4387 * t7988 - 0.6e1 * t7842 * t4387 * t7833 - 0.12e2 * t6115 * t225 * t1832 - 0.6e1 * t8007 * t1487 * t2582 + 0.3e1 * t2626 * t8011 + 0.3e1 * t2630 * t541 * t6130 - t2636 * t8011 + 0.3e1 * t2656 * t7142 - 0.3e1 * t2616 * t7942 - t2616 * t8011 - t6925 + t6942 - t6945 - 0.2e1 * t2339 * t1415 * t1747 * t762 - 0.2e1 * t2339 * t8028;
  t8041 = t531 * t7088;
  t8067 = t541 * t294;
  t8068 = t4349 * t8067;
  t8078 = t758 * t7120 - t6228 * t872 - 0.2e1 * t2095 * t2378 - t769 * t7120 - 0.2e1 * t2059 * t1402 * t877 * t551 + 0.11e2 * t8041 * t4509 * t754 * t262 - 0.3e1 * t1781 * t6275 - t6228 * t882 - 0.2e1 * t2095 * t2359 - t769 * t7096 - t4432 * t2612 + t7089 * t4526 * t5453 * t294 + t6195 * t872 + 0.2e1 * t2066 * t2378 + 0.3e1 * t875 * t4349 * t1787 + 0.6e1 * t6172 * t4566 * t877 * t532 + 0.3e1 * t531 * t1801 * t8068 + 0.6e1 * t7237 * t4518 * t2611 - 0.4e1 * t6205 * t2601 - 0.4e1 * t2059 * t7146;
  t8082 = t2071 * t219;
  t8083 = t1397 * t8082;
  t8092 = t1390 * t5234;
  t8093 = t1487 * t294;
  t8097 = 0.18e2 * t1842 * t8092 * t8093 + 0.3e1 * t2129 * t2588 * t5297 - 0.3e1 * t2583 * t2593 * t6990 - 0.6e1 * t1781 * t8083 - 0.6e1 * t5364 * t2605 + t7037 - t7041 + t7044 + t7060 - t7063 - t7071 + t7073 + t7114 - t7115 - t7132 + t7138 - t7140 + t7175 - t7176 + t7181;
  t8130 = -0.3e1 * t2583 * t5491 + 0.18e2 * t8007 * t8067 * t3276 - 0.18e2 * t7805 * t7801 * t534 * t538 * t540 - 0.6e1 * t7783 * t2594 - 0.6e1 * t7790 * t2594 + t7241 - t7244 + t7251 - t7253 - t7256 - t7267 + t677 * t6355 - t217 * t2134 * t262 * t557 - 0.2e1 * t217 * t762 * t668 * t557 - t217 * t294 * t1848 * t557 + t6195 * t878 + 0.2e1 * t2066 * t2320 + t758 * t7229 + t5477 * t755 + 0.2e1 * t1792 * t2072;
  t8134 = my_piecewise5(t102, 0, t103, 0, t7814 + t7863 + t7928 + t7983 + t8031 + t8078 + t8097 + t8130);
  t8141 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t887 + t7728 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t2663 - t7706 + t7735 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * (0.1e3 / 0.243e3 * t2301 - 0.25e2 / 0.81e2 * t2304 + 0.5e1 / 0.54e2 * t38 * t96 * t1853 - 0.44e3 / 0.729e3 * t38 * t517 * t297 + 0.8e2 / 0.243e3 * t38 * t207 * t773 - 0.5e1 / 0.81e2 * t38 * t91 * t2139 + t525 * t885 + 0.2e1 * t215 * t2661 + t101 * t8134));
  tv4rho2sigmalapl17 = t8 * t8141 + 0.2e1 * t2668;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 17] += tv4rho2sigmalapl17;

  tv4rho2sigmatau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  tv4rho2sigmatau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 1] += tv4rho2sigmatau1;

  tv4rho2sigmatau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 2] += tv4rho2sigmatau2;

  tv4rho2sigmatau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 3] += tv4rho2sigmatau3;

  tv4rho2sigmatau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 4] += tv4rho2sigmatau4;

  tv4rho2sigmatau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 5] += tv4rho2sigmatau5;

  tv4rho2sigmatau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 6] += tv4rho2sigmatau6;

  tv4rho2sigmatau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 7] += tv4rho2sigmatau7;

  tv4rho2sigmatau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 8] += tv4rho2sigmatau8;

  tv4rho2sigmatau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 9] += tv4rho2sigmatau9;

  tv4rho2sigmatau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 10] += tv4rho2sigmatau10;

  tv4rho2sigmatau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 11] += tv4rho2sigmatau11;

  tv4rho2sigmatau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 12] += tv4rho2sigmatau12;

  tv4rho2sigmatau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 13] += tv4rho2sigmatau13;

  tv4rho2sigmatau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 14] += tv4rho2sigmatau14;

  tv4rho2sigmatau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 15] += tv4rho2sigmatau15;

  tv4rho2sigmatau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 16] += tv4rho2sigmatau16;

  tv4rho2sigmatau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 17] += tv4rho2sigmatau17;

  t8148 = t7 * t324 * t910;
  t8155 = t7 * t333 * t910 / 0.3e2;
  t8157 = t7 * t133 * t2754;
  t8168 = t2681 * t361;
  t8169 = t356 * t8168;
  t8170 = t157 * t711;
  t8171 = t2267 * t8170;
  t8178 = t149 * t8168;
  t8185 = -0.12e2 * t2267 * t366 * t711 * t8169 - 0.12e2 * t8169 * t8171 + 0.12e2 * t8178 * t8171 - 0.4e1 * t2685 + 0.4e1 * t2724 + 0.4e1 * t2736 - 0.4e1 * t2742 - 0.4e1 * t2744 + t6412 + t6413 - t6414 + t6416 - t6417 - t6418 - t794 - t902;
  t8187 = t898 * t1025;
  t8188 = t1020 * t8187;
  t8191 = t157 * t7433;
  t8196 = t2734 * t1025;
  t8197 = t149 * t8196;
  t8200 = t356 * t8196;
  t8203 = t6489 * t8170;
  t8209 = t1032 * t711 * t151;
  t8210 = t366 * t8209;
  t8217 = t356 * t8187;
  t8220 = t149 * t8187;
  t8231 = 0.12e2 * t2489 * t8191 + 0.12e2 * t2489 * t8203 + 0.12e2 * t2489 * t8210 - 0.12e2 * t2498 * t8191 - 0.4e1 * t2498 * t8203 + 0.12e2 * t2515 * t7434 - 0.4e1 * t2515 * t8203 - 0.18e2 * t8188 * t6434 + 0.18e2 * t8217 * t6434 - 0.6e1 * t8188 * t6443 + 0.18e2 * t8217 * t6443 - 0.6e1 * t8220 * t6443 - 0.12e2 * t8188 * t6446 + 0.18e2 * t8188 * t6455 - 0.18e2 * t8197 * t6475 + 0.18e2 * t8200 * t6475 + 0.4e1 * t2748;
  t8256 = t895 * t3519;
  t8257 = t3531 * t8256;
  t8263 = t3659 * t2692 * params->csk_a;
  t8266 = t356 * t8256;
  t8269 = 0.12e2 * t153 * t157 * t1886 * t8178 + 0.12e2 * t2681 * t366 * t4781 * t711 - 0.8e1 * t1107 * t2515 * t8209 + 0.12e2 * t2515 * t7450 - 0.12e2 * t2515 * t8210 - 0.3e1 * t2741 * t6495 - 0.3e1 * t2741 * t6500 + 0.3e1 * t2747 * t6504 + 0.18e2 * t8188 * t6518 + 0.7e1 * t8257 * t6564 - 0.7e1 * t8257 * t6594 + 0.7e1 * t8266 * t6599 - 0.12e2 * t6797 * t8263 - t6457 + t6464 - t6467;
  t8270 = t149 * t8256;
  t8278 = t1020 * t8256;
  t8292 = t895 * t3509;
  t8293 = t356 * t8292;
  t8306 = -0.12e2 * t2735 * t6568 - 0.3e1 * t8293 * t6542 - 0.18e2 * t8266 * t6547 + 0.6e1 * t8270 * t6547 - 0.3e1 * t8293 * t6553 - 0.11e2 * t8266 * t6564 - t8257 * t6572 - 0.7e1 * t8266 * t6572 + t8270 * t6572 + 0.6e1 * t8278 * t6572 + 0.12e2 * t8278 * t6590 - 0.7e1 * t8266 * t6594 + 0.18e2 * t8278 * t6594 - 0.18e2 * t8278 * t6599 - 0.11e2 * t8266 * t6621 + 0.11e2 * t8270 * t6621 - 0.6e1 * t6634 * t8263;
  t8318 = t371 * t372 * t1969;
  t8334 = t1041 * t1899 * t711;
  t8337 = t3535 * t895;
  t8339 = t3670 * t8337 * params->csk_a;
  t8345 = t3659 * t2692 * t1032;
  t8350 = -0.18e2 * t1026 * t6433 * t904 - 0.4e1 * t2181 * t8334 + 0.3e1 * t2696 * t3618 - 0.3e1 * t2702 * t3618 + 0.3e1 * t2702 * t3623 - t2702 * t3636 + 0.3e1 * t2723 * t3614 + 0.3e1 * t2735 * t6679 + 0.6e1 * t8278 * t6547 - 0.6e1 * t8278 * t6559 - 0.12e2 * t8257 * t6590 - 0.6e1 * t8257 * t6627 - 0.6e1 * t6634 * t8339 + 0.18e2 * t6634 * t8345 + 0.2e1 * t707 * t8318 - 0.2e1 * t718 * t8318;
  t8358 = t3670 * t8337 * t1032;
  t8365 = t895 * t357;
  t8370 = t1041 * t2692 * t380;
  t8386 = -0.2e1 * t718 * t388 * t389 * t1969 - 0.2e1 * t2702 * t3627 + 0.11e2 * t6634 * t8358 - 0.12e2 * t4960 * t1026 * t703 * t711 + 0.3e1 * t149 * t8365 * t4848 - 0.6e1 * t6655 * t8370 - 0.8e1 * t1906 * t1031 * t2683 * t151 + 0.3e1 * t2696 * t3600 - 0.3e1 * t2699 * t3600 + 0.3e1 * t2702 * t3639 - t2699 * t3636 + 0.3e1 * t2696 * t3636 + t6582 - t6585 + t6588 + t6598 - t6604;
  t8388 = t711 * t711;
  t8389 = t149 * t8388;
  t8397 = 0.2e1 * t356 * t367 * t8388 - 0.2e1 * t8389 * t382 + 0.2e1 * t8389 * t384 - t6617 + t6619 - t6632 - t6670 + t6675 - t6677 + t6709 + t6714 + t6727 - t6728 - t6761 + t6775 - t6777 - t6780;
  t8398 = t149 * t8292;
  t8409 = t3659 * t2692;
  t8412 = t8388 * t359;
  t8413 = t356 * t8412;
  t8421 = t3670 * t8337;
  t8427 = t156 * t1969;
  t8437 = t6785 - t6788 + 0.3e1 * t8398 * t6754 + 0.6e1 * t8270 * t6757 + 0.3e1 * t356 * t8365 * t3515 + 0.11e2 * t8266 * t3647 * t6432 + 0.6e1 * t6797 * t8409 - 0.2e1 * t8413 * t373 + 0.2e1 * t149 * t8412 * t373 - 0.2e1 * t8413 * t390 + t6634 * t8421 - 0.3e1 * t2696 * t3743 - 0.2e1 * t2699 * t3651 - 0.2e1 * t2682 * t2193 * t8427 + 0.2e1 * t707 * t371 * t8427 + 0.2e1 * t718 * t5895 - t3580 * t2693;
  t8441 = my_piecewise5(t58, 0, t61, 0, t8185 + t8231 + t8269 + t8306 + t8350 + t8386 + t8397 + t8437);
  t8448 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t320 * t910 + t8148 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t128 * t2754 - t8155 + t8157 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (0.2e3 / 0.243e3 * t2439 - 0.5e2 / 0.81e2 * t2442 + 0.5e1 / 0.27e2 * t38 * t48 * t1974 + t350 * t908 + 0.2e1 * t147 * t2752 + t53 * t8441));
  tv4rho2lapl20 = t8 * t8448 + 0.2e1 * t2759;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 1] += tv4rho2lapl21;

  t8455 = t7 * t415 * t933;
  t8459 = t7 * t419 * t933 / 0.3e2;
  t8461 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t411 * t933 + t8455 / 0.5e1 - t8459);
  tv4rho2lapl22 = t8 * t8461 + 0.2e1 * t2768;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 2] += tv4rho2lapl22;

  t8467 = t7 * t440 * t910;
  t8475 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t436 * t910 + t8467 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t190 * t2754 + t8148 / 0.1e2 - t8155 + t8157 / 0.1e2);
  tv4rho2lapl23 = t8 * t8475 + t2759 + t2774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 3] += tv4rho2lapl23;

  tv4rho2lapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 4] += tv4rho2lapl24;

  t8481 = t7 * t463 * t933;
  t8488 = t7 * t177 * t2857;
  t8491 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t459 * t933 + t8481 / 0.1e2 + t8455 / 0.1e2 - t8459 + 0.3e1 / 0.2e2 * t7 * t173 * t2857 + t8488 / 0.1e2);
  tv4rho2lapl25 = t8 * t8491 + t2768 + t2862;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 5] += tv4rho2lapl25;

  t8499 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t490 * t910 + t8467 / 0.5e1 - t8155);
  tv4rho2lapl26 = t8 * t8499 + 0.2e1 * t2774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 6] += tv4rho2lapl26;

  tv4rho2lapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 7] += tv4rho2lapl27;

  t8519 = t2784 * t536;
  t8520 = t217 * t8519;
  t8521 = t225 * t762;
  t8522 = t8521 * t2413;
  t8525 = t531 * t8519;
  t8532 = t225 * t7917;
  t8537 = t921 * t1396;
  t8538 = t1390 * t8537;
  t8542 = t1032 * t762 * t219;
  t8543 = t225 * t8542;
  t8548 = t2825 * t1396;
  t8549 = t217 * t8548;
  t8552 = t531 * t8548;
  t8559 = -0.12e2 * t2413 * t541 * t762 * t8525 - 0.12e2 * t2616 * t8532 - 0.4e1 * t2616 * t8543 + 0.12e2 * t2626 * t8532 + 0.12e2 * t2626 * t8543 + 0.12e2 * t2636 * t7918 - 0.4e1 * t2636 * t8543 + 0.18e2 * t8538 * t6923 - 0.18e2 * t8549 * t6933 + 0.18e2 * t8552 * t6933 + 0.12e2 * t8520 * t8522 - 0.12e2 * t8525 * t8522 - 0.4e1 * t2788 + t6891 - t6892 + t6894;
  t8562 = t217 * t8537;
  t8565 = t531 * t8537;
  t8586 = 0.12e2 * t2636 * t7966 - 0.3e1 * t2844 * t6991 - 0.3e1 * t2844 * t6998 + 0.3e1 * t2850 * t6995 - 0.12e2 * t8538 * t6907 - 0.18e2 * t8538 * t6917 + 0.18e2 * t8565 * t6917 + 0.18e2 * t8538 * t6971 - 0.6e1 * t8538 * t7005 - 0.6e1 * t8562 * t7005 + 0.18e2 * t8565 * t7005 + 0.4e1 * t2827 + 0.4e1 * t2839 + t6895 - t6896 - t6898 - t821;
  t8588 = t6946 * t8082;
  t8602 = t918 * t4357;
  t8603 = t4382 * t8602;
  t8607 = t4518 * t2802 * params->csk_a;
  t8610 = t217 * t8602;
  t8613 = t531 * t8602;
  t8616 = t1390 * t8602;
  t8624 = 0.12e2 * t2051 * t221 * t225 * t8520 - 0.8e1 * t1487 * t2636 * t8542 + 0.12e2 * t2626 * t8588 - 0.12e2 * t2636 * t8588 + 0.12e2 * t6318 * t7963 - t8603 * t7030 + 0.6e1 * t8616 * t7030 - 0.7e1 * t8613 * t7046 - 0.12e2 * t8603 * t7050 + 0.12e2 * t8616 * t7050 + 0.11e2 * t8610 * t7076 - 0.11e2 * t8613 * t7076 - 0.12e2 * t7237 * t8607 - t6925 + t6942 - t6945;
  t8650 = t540 * t918;
  t8652 = t1397 * t8650 * t555;
  t8658 = t1467 * t225 * t2134;
  t8663 = -0.3e1 * t2808 * t4458 - 0.12e2 * t2826 * t7027 + 0.3e1 * t2826 * t7142 + 0.3e1 * t2838 * t4413 - 0.18e2 * t561 * t8652 + 0.18e2 * t8603 * t7014 - 0.6e1 * t8616 * t7014 + 0.7e1 * t8603 * t7023 - 0.11e2 * t8613 * t7023 + t8610 * t7030 - 0.7e1 * t8613 * t7030 - 0.7e1 * t8603 * t7046 + 0.18e2 * t8616 * t7046 + 0.7e1 * t8613 * t7054 - 0.18e2 * t8616 * t7054 - 0.6e1 * t7089 * t8607 - 0.2e1 * t769 * t8658;
  t8668 = t4386 * t918;
  t8670 = t4526 * t8668 * t1032;
  t8682 = t1415 * t2075 * t762;
  t8686 = t4526 * t8668 * params->csk_a;
  t8689 = t918 * t4348;
  t8690 = t531 * t8689;
  t8695 = t918 * t532;
  t8711 = -0.8e1 * t1402 * t2059 * t219 * t2786 + 0.3e1 * t217 * t5329 * t8695 - 0.12e2 * t2084 * t8083 - 0.4e1 * t2339 * t8682 + 0.3e1 * t2797 * t4458 + 0.3e1 * t2808 * t4454 - 0.2e1 * t2808 * t4472 + 0.11e2 * t7089 * t8670 - 0.6e1 * t7089 * t8686 - 0.6e1 * t8603 * t7107 - 0.3e1 * t8690 * t7191 - 0.3e1 * t8690 * t7194 + 0.6e1 * t8610 * t7201 - 0.18e2 * t8613 * t7201 + 0.6e1 * t8616 * t7201 + 0.2e1 * t758 * t8658;
  t8713 = t1415 * t2802 * t555;
  t8730 = -0.2e1 * t2134 * t563 * t564 * t769 - t2794 * t4422 - 0.3e1 * t2794 * t4462 + 0.3e1 * t2797 * t4422 + 0.3e1 * t2797 * t4462 - t2808 * t4422 + 0.3e1 * t2808 * t4425 - 0.6e1 * t7151 * t8713 + t7037 - t7041 + t7044 + t7060 - t7063 - t7071 + t7073 + t7114 - t7115;
  t8733 = t762 * t762;
  t8737 = t217 * t8733;
  t8744 = 0.2e1 * t531 * t542 * t8733 - 0.2e1 * t8737 * t557 + 0.2e1 * t8737 * t559 - 0.4e1 * t2845 - 0.4e1 * t2847 + 0.4e1 * t2851 - t7132 + t7138 - t7140 + t7175 - t7176 + t7181 + t7241 - t7244 + t7251 - t7253 - t925;
  t8748 = t217 * t8689;
  t8753 = t4518 * t2802;
  t8756 = t8733 * t534;
  t8757 = t531 * t8756;
  t8768 = t4526 * t8668;
  t8770 = t224 * t2134;
  t8779 = t4509 * t8650;
  t8784 = -t7256 - t7267 + 0.3e1 * t531 * t8695 * t4350 + 0.3e1 * t8748 * t7269 + 0.6e1 * t8610 * t7272 + 0.6e1 * t7237 * t8753 - 0.2e1 * t8757 * t565 - 0.2e1 * t8757 * t548 + 0.2e1 * t217 * t8756 * t548 + 0.2e1 * t769 * t6355 - t4432 * t2803 + t7089 * t8768 - 0.2e1 * t2785 * t2315 * t8770 + 0.2e1 * t758 * t546 * t8770 - 0.2e1 * t2794 * t7245 + 0.11e2 * t8041 * t8779 - 0.3e1 * t2797 * t4586;
  t8788 = my_piecewise5(t102, 0, t103, 0, t8559 + t8586 + t8624 + t8663 + t8711 + t8730 + t8744 + t8784);
  t8795 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t506 * t933 + t8481 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t201 * t2857 - t8459 + t8488 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t86 * (0.2e3 / 0.243e3 * t2566 - 0.5e2 / 0.81e2 * t2569 + 0.5e1 / 0.27e2 * t38 * t96 * t2139 + t525 * t931 + 0.2e1 * t215 * t2855 + t101 * t8788));
  tv4rho2lapl28 = t8 * t8795 + 0.2e1 * t2862;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 8] += tv4rho2lapl28;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2lapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 1] += tv4rho2lapltau1;

  tv4rho2lapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 2] += tv4rho2lapltau2;

  tv4rho2lapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 3] += tv4rho2lapltau3;

  tv4rho2lapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 4] += tv4rho2lapltau4;

  tv4rho2lapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 5] += tv4rho2lapltau5;

  tv4rho2lapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 6] += tv4rho2lapltau6;

  tv4rho2lapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 7] += tv4rho2lapltau7;

  tv4rho2lapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 8] += tv4rho2lapltau8;

  tv4rho2lapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 9] += tv4rho2lapltau9;

  tv4rho2lapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 10] += tv4rho2lapltau10;

  tv4rho2lapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 11] += tv4rho2lapltau11;

  tv4rho2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 0] += tv4rho2tau20;

  tv4rho2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 1] += tv4rho2tau21;

  tv4rho2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 2] += tv4rho2tau22;

  tv4rho2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 3] += tv4rho2tau23;

  tv4rho2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 4] += tv4rho2tau24;

  tv4rho2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 5] += tv4rho2tau25;

  tv4rho2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 6] += tv4rho2tau26;

  tv4rho2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 7] += tv4rho2tau27;

  tv4rho2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 8] += tv4rho2tau28;

  t8802 = t7 * t133 * t2935 / 0.1e2;
  t8810 = 0.6e1 * t2890;
  t8811 = t2888 * t380;
  t8812 = t356 * t8811;
  t8813 = t8812 * t2467;
  t8815 = t8812 * t2463;
  t8817 = t149 * t8811;
  t8818 = t8817 * t2467;
  t8820 = t6583 * t1025;
  t8821 = t1020 * t8820;
  t8822 = t8821 * t2492;
  t8824 = t8821 * t2511;
  t8826 = t2868 + t2873 - t8810 + t2897 + t2906 + t2163 + t2187 - t2190 - t2196 - 0.9e1 * t8813 - 0.9e1 * t8815 + 0.9e1 * t8818 - 0.9e1 * t8822 - 0.3e1 * t8824;
  t8827 = params->csk_a * t153;
  t8828 = t8827 * t2224;
  t8832 = t356 * t8820 * t2501;
  t8836 = t2257 * t3549;
  t8839 = t2869 * t359;
  t8840 = t8839 * t1025;
  t8841 = t149 * t8840;
  t8844 = params->csk_a * t792;
  t8845 = t8844 * t151;
  t8846 = t157 * t8845;
  t8847 = t4741 * t8846;
  t8850 = t1032 * t380 * t151;
  t8851 = t157 * t8850;
  t8854 = t356 * t8840;
  t8858 = t2505 * t366 * t8845;
  t8860 = t1020 * t8840;
  t8861 = t366 * t2263;
  t8864 = t1032 * t792;
  t8865 = t8864 * t151;
  t8866 = t157 * t8865;
  t8867 = t4741 * t8866;
  t8869 = t4751 * t8866;
  t8872 = t2505 * t1107 * t8845;
  t8874 = t1107 * t2263;
  t8877 = t366 * t8865;
  t8878 = t4751 * t8877;
  t8880 = 0.18e2 * t1025 * t2870 * t356 * t8836 - 0.9e1 * t2256 * t8828 - 0.18e2 * t8841 * t2264 - 0.6e1 * t8841 * t8851 + 0.18e2 * t8854 * t8851 + 0.18e2 * t8860 * t8861 + 0.18e2 * t8860 * t8874 + 0.9e1 * t8832 - 0.9e1 * t8847 + 0.9e1 * t8858 - 0.3e1 * t8867 + 0.9e1 * t8869 + 0.9e1 * t8872 + 0.9e1 * t8878;
  t8882 = params->csk_a * t380;
  t8884 = t157 * t8882 * t605;
  t8887 = t366 * t8850;
  t8891 = t4781 * t366 * t8811;
  t8893 = t8817 * t2221;
  t8897 = t1107 * t8850;
  t8900 = t8821 * t2521;
  t8902 = t8827 * t605;
  t8903 = t366 * t8902;
  t8908 = -0.9e1 * t2256 * t8903 + 0.9e1 * t2262 * t8884 - 0.6e1 * t8860 * t8851 + 0.18e2 * t8854 * t8887 - 0.18e2 * t8860 * t8887 - 0.12e2 * t8860 * t8897 - t2908 - t2911 + t2914 + t2918 - t2920 + 0.9e1 * t8891 + 0.9e1 * t8893 - 0.6e1 * t8900;
  t8909 = t1066 * t2224;
  t8913 = t1031 * t1033 * t605;
  t8916 = t2198 * t2225;
  t8920 = -0.3e1 * t2165 * t8913 + 0.9e1 * t2169 * t8909 + 0.9e1 * t2169 * t8913 + t2197 - t2199 - t2216 + t2222 + t2238 - t2259 + t2265 - t2269 - t2922 - t794 - t796 - 0.3e1 * t8916;
  t8925 = t151 * t3519;
  t8926 = t3531 * t8925;
  t8927 = t365 * t2869;
  t8934 = t1575 * t2916;
  t8936 = t2198 * t2231;
  t8939 = t371 * t1014 * t605;
  t8942 = t2869 * t3509;
  t8943 = t356 * t8942;
  t8946 = t2869 * t3519;
  t8947 = t1020 * t8946;
  t8948 = t4875 * t2201;
  t8951 = t3531 * t8946;
  t8953 = t149 * t8946;
  t8955 = t3754 * t2249;
  t8958 = t356 * t8946;
  t8961 = t3659 * t2240;
  t8964 = t366 * t151;
  t8965 = t4875 * t8964;
  t8968 = 0.7e1 * t1032 * t3647 * t8926 * t8927 + 0.9e1 * t2207 * t4892 - 0.3e1 * t2207 * t8913 + 0.9e1 * t2219 * t8939 - 0.3e1 * t8943 * t601 + 0.6e1 * t8947 * t8948 + 0.18e2 * t8947 * t8965 - t8951 * t8948 + t8953 * t8948 - 0.6e1 * t8951 * t8961 + 0.6e1 * t8953 * t8955 - 0.18e2 * t8958 * t8955 + 0.3e1 * t8934 - 0.3e1 * t8936;
  t8970 = t3659 * t3710 * t151;
  t8975 = t3647 * t616;
  t8980 = t3535 * t2869;
  t8986 = t3670 * t3684 * t151;
  t8991 = t2181 * t1041 * t1561 * t792;
  t8996 = t1026 * t1048 * t605;
  t8999 = t356 * t8925;
  t9004 = t3647 * t2212;
  t9007 = t1020 * t8839;
  t9008 = t1043 * t151;
  t9019 = 0.11e2 * t1032 * t3670 * t8926 * t8980 - 0.6e1 * t1041 * t380 * t9007 * t9008 - 0.6e1 * t151 * t3670 * t3671 * t8951 + 0.7e1 * t3647 * t8927 * t8999 * params->csk_a + 0.9e1 * t2169 * t8996 + 0.9e1 * t2207 * t4971 - 0.9e1 * t2207 * t8996 + 0.12e2 * t8947 * t8970 - 0.18e2 * t8947 * t8975 - 0.7e1 * t8958 * t8948 - 0.6e1 * t8951 * t8986 - 0.7e1 * t8958 * t8965 - 0.11e2 * t8958 * t9004 - 0.3e1 * t8991;
  t9023 = t3659 * t1043 * t2869 * t1032;
  t9029 = t1041 * t1044 * t605;
  t9036 = t3728 * t2201;
  t9045 = t356 * t8839;
  t9049 = t6584 * t2485;
  t9051 = t2869 * t151;
  t9057 = t3659 * t2208;
  t9060 = -0.18e2 * t1026 * t2236 * t9045 + 0.3e1 * t149 * t4848 * t9051 - 0.9e1 * t2165 * t8909 - 0.6e1 * t2207 * t9029 - 0.3e1 * t8943 * t617 + 0.18e2 * t8926 * t9023 + 0.6e1 * t8947 * t8955 - 0.12e2 * t8947 * t8961 - 0.6e1 * t8947 * t9057 - 0.7e1 * t8951 * t8965 - 0.12e2 * t8951 * t8970 + 0.11e2 * t8953 * t9036 - 0.11e2 * t8958 * t9036 - 0.6e1 * t9049;
  t9063 = t1591 * t1026 * t2185 * t151;
  t9066 = t611 * t380;
  t9072 = t3754 * t611;
  t9090 = t149 * t792 * t605 * t382;
  t9092 = t1578 * t2186;
  t9094 = t1031 * t2174;
  t9102 = t2162 * t2175;
  t9104 = -0.9e1 * t9063 - 0.12e2 * t149 * t8839 * t1031 * t9066 + 0.9e1 * t2235 * t4957 + 0.6e1 * t8953 * t9072 + 0.3e1 * t356 * t9051 * t3515 + 0.6e1 * t8947 * t3659 * t9008 + 0.3e1 * t149 * t8942 * t612 - 0.3e1 * t2207 * t5027 + t8926 * t3670 * t8980 - 0.3e1 * t9090 + 0.3e1 * t9092 - 0.6e1 * t2165 * t9094 + 0.11e2 * t8999 * t3647 * t8927 - 0.9e1 * t2169 * t5045 + 0.3e1 * t9102;
  t9108 = my_piecewise5(t58, 0, t61, 0, t8826 + t8880 + t8908 + t8920 + t8968 + t9019 + t9060 + t9104);
  t9115 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t2935 + t8802 + 0.3e1 / 0.2e2 * t7 * t32 * (0.4e2 / 0.81e2 * t38 * t139 * t802 - 0.5e1 / 0.27e2 * t38 * t43 * t2273 + t147 * t2933 + t53 * t9108));
  tv4rhosigma30 = t8 * t9115 + t2939;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t9122 = t7 * t177 * t3011 / 0.1e2;
  t9124 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t3011 + t9122);
  tv4rhosigma39 = t8 * t9124 + t3015;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t9130 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t2935 + t8802);
  tv4rhosigma310 = t8 * t9130 + t2939;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t9142 = 0.6e1 * t2967;
  t9143 = t2965 * t555;
  t9144 = t531 * t9143;
  t9145 = t9144 * t2594;
  t9147 = t217 * t9143;
  t9148 = t9147 * t2585;
  t9150 = t9144 * t2585;
  t9152 = t2943 * t534;
  t9153 = t9152 * t1396;
  t9154 = t1390 * t9153;
  t9155 = t541 * t2409;
  t9158 = t1032 * t819;
  t9159 = t9158 * t219;
  t9160 = t225 * t9159;
  t9161 = t5257 * t9160;
  t9163 = 0.18e2 * t9154 * t9155 + t2309 - t2312 - t2319 + t2333 + t2960 + t2972 + t2974 + t2978 - t9142 - 0.9e1 * t9145 + 0.9e1 * t9148 - 0.9e1 * t9150 - 0.3e1 * t9161;
  t9164 = t5272 * t9160;
  t9166 = t7039 * t1396;
  t9167 = t1390 * t9166;
  t9168 = t9167 * t2624;
  t9170 = t217 * t9153;
  t9172 = t1032 * t555 * t219;
  t9173 = t225 * t9172;
  t9176 = t531 * t9153;
  t9179 = t819 * params->csk_a;
  t9180 = t9179 * t219;
  t9182 = t2630 * t541 * t9180;
  t9185 = t2630 * t1487 * t9180;
  t9187 = t1487 * t2409;
  t9190 = t9147 * t2387;
  t9192 = params->csk_a * t555;
  t9194 = t225 * t9192 * t668;
  t9197 = t541 * t9172;
  t9202 = t1487 * t9172;
  t9205 = t2310 * t555;
  t9207 = t2646 * t541 * t9205;
  t9209 = params->csk_a * t221;
  t9210 = t9209 * t6955;
  t9213 = -0.9e1 * t2402 * t9210 + 0.9e1 * t2408 * t9194 + 0.18e2 * t9154 * t9187 - 0.18e2 * t9154 * t9197 - 0.12e2 * t9154 * t9202 - 0.6e1 * t9170 * t9173 + 0.18e2 * t9176 * t9173 + 0.18e2 * t9176 * t9197 + 0.9e1 * t9164 - 0.3e1 * t9168 + 0.9e1 * t9182 + 0.9e1 * t9185 + 0.9e1 * t9190 + 0.9e1 * t9207;
  t9217 = t541 * t9159;
  t9218 = t5272 * t9217;
  t9220 = t9167 * t2643;
  t9222 = t9209 * t668;
  t9223 = t541 * t9222;
  t9228 = t225 * t9180;
  t9229 = t5257 * t9228;
  t9231 = t9167 * t2640;
  t9234 = t531 * t9166 * t2619;
  t9238 = t2403 * t4439;
  t9241 = 0.18e2 * t1396 * t2975 * t531 * t9238 - 0.9e1 * t2402 * t9223 - 0.18e2 * t9170 * t2410 - 0.6e1 * t9154 * t9173 + t2985 + t2989 - t2991 - t2994 - t2996 + 0.9e1 * t9218 - 0.6e1 * t9220 - 0.9e1 * t9229 - 0.9e1 * t9231 + 0.9e1 * t9234;
  t9242 = t2943 * t4357;
  t9243 = t4382 * t9242;
  t9244 = t4522 * t2354;
  t9247 = t219 * t4357;
  t9248 = t4382 * t9247;
  t9249 = t4386 * t2943;
  t9255 = t4526 * t4531 * t219;
  t9260 = t2339 * t1415 * t1747 * t819;
  t9262 = 0.11e2 * t1032 * t4526 * t9248 * t9249 - 0.7e1 * t9243 * t9244 - 0.6e1 * t9243 * t9255 + t2343 - t2345 + t2371 - t2383 + t2388 - t2405 + t2411 - t2415 - t2998 - t821 - t823 - 0.3e1 * t9260;
  t9267 = t1402 * t2377;
  t9270 = t531 * t9247;
  t9273 = t4509 * t540 * t2943 * params->csk_a;
  t9276 = t531 * t9242;
  t9278 = t4509 * t1816 * t219;
  t9281 = t1390 * t9152;
  t9282 = t1417 * t219;
  t9291 = t541 * t668;
  t9292 = t1410 * t9291;
  t9297 = t4518 * t1417 * t2943 * t1032;
  t9301 = t4522 * t1487 * t219;
  t9305 = t1415 * t1418 * t668;
  t9308 = t4359 * params->csk_a;
  t9309 = t9308 * t2347;
  t9316 = t1781 * t1397 * t2307 * t219;
  t9318 = t531 * t9152;
  t9319 = t1397 * t2369;
  t9322 = -0.6e1 * t1415 * t555 * t9281 * t9282 - 0.6e1 * t219 * t4526 * t4542 * t9243 - 0.9e1 * t2334 * t9267 + 0.9e1 * t2353 * t5470 - 0.9e1 * t2353 * t9292 - 0.6e1 * t2353 * t9305 + 0.7e1 * t9243 * t9278 - 0.12e2 * t9243 * t9301 + 0.18e2 * t9248 * t9297 + 0.7e1 * t9270 * t9273 - 0.11e2 * t9276 * t9278 - 0.11e2 * t9276 * t9309 - 0.18e2 * t9318 * t9319 - 0.9e1 * t9316;
  t9323 = t2943 * t219;
  t9327 = t217 * t9242;
  t9330 = t1390 * t9242;
  t9331 = t4518 * t2362;
  t9334 = t2344 * t2378;
  t9336 = t1410 * t6955;
  t9347 = t2344 * t2359;
  t9350 = t546 * t1449 * t668;
  t9353 = t1761 * t2987;
  t9359 = 0.3e1 * t217 * t5329 * t9323 + 0.9e1 * t2326 * t9267 + 0.9e1 * t2326 * t9292 + 0.9e1 * t2326 * t9336 - 0.3e1 * t2334 * t9336 + 0.9e1 * t2353 * t5354 - 0.3e1 * t2353 * t9336 + 0.9e1 * t2368 * t5415 + 0.9e1 * t2385 * t9350 + 0.11e2 * t9327 * t9309 - 0.6e1 * t9330 * t9331 - 0.3e1 * t9334 - 0.3e1 * t9347 + 0.3e1 * t9353;
  t9361 = t4522 * t2347;
  t9363 = t4566 * t2395;
  t9368 = t4518 * t2373;
  t9377 = t2943 * t4348;
  t9378 = t531 * t9377;
  t9385 = t7040 * t2601;
  t9388 = t1402 * t4574 * t219;
  t9393 = t4509 * t679;
  t9396 = -0.12e2 * t2976 * t9388 - 0.3e1 * t9378 * t664 - 0.3e1 * t9378 * t680 - t9243 * t9361 - 0.6e1 * t9243 * t9368 - 0.7e1 * t9276 * t9244 + 0.18e2 * t9330 * t9244 - 0.18e2 * t9276 * t9363 + 0.12e2 * t9330 * t9301 + 0.6e1 * t9327 * t9363 + 0.6e1 * t9330 * t9363 - 0.12e2 * t9330 * t9368 - 0.18e2 * t9330 * t9393 - 0.6e1 * t9385;
  t9405 = t4566 * t674;
  t9411 = t4509 * t2327;
  t9421 = t1792 * t2308;
  t9425 = t217 * t819 * t668 * t557;
  t9429 = t2332 * t2320;
  t9431 = t1402 * t2316;
  t9434 = 0.3e1 * t217 * t675 * t9377 + 0.3e1 * t4350 * t531 * t9323 + 0.6e1 * t4518 * t9282 * t9330 + t4526 * t9248 * t9249 - 0.9e1 * t2326 * t5539 - 0.6e1 * t2334 * t9431 - 0.3e1 * t2353 * t5562 - 0.7e1 * t9276 * t9361 + 0.11e2 * t9276 * t9411 + t9327 * t9361 + 0.6e1 * t9327 * t9405 + 0.6e1 * t9330 * t9361 + 0.3e1 * t9421 - 0.3e1 * t9425 + 0.3e1 * t9429;
  t9438 = my_piecewise5(t102, 0, t103, 0, t9163 + t9213 + t9241 + t9262 + t9322 + t9359 + t9396 + t9434);
  t9445 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t3011 + t9122 + 0.3e1 / 0.2e2 * t7 * t86 * (0.4e2 / 0.81e2 * t38 * t207 * t829 - 0.5e1 / 0.27e2 * t38 * t91 * t2419 + t215 * t3009 + t101 * t9438));
  tv4rhosigma319 = t8 * t9445 + t3015;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t9452 = t7 * t133 * t3095 / 0.1e2;
  t9465 = t149 * t3080;
  t9468 = t359 * params->csk_a * t151;
  t9469 = t1031 * t156 * t9468;
  t9481 = t3033 * t380;
  t9482 = t356 * t9481;
  t9483 = t9482 * t2463;
  t9487 = t1032 * t359 * t151;
  t9488 = t1026 * t365 * t9487;
  t9491 = t149 * t9481;
  t9492 = t9491 * t2467;
  t9494 = t9482 * t2467;
  t9496 = 0.6e1 * t1964 * t2191 * t2455 * t605 - 0.6e1 * t2224 * t2461 * t4999 + 0.18e2 * t3081 * t9469 + 0.18e2 * t3081 * t9488 - 0.18e2 * t9465 * t9469 + t2163 + t2187 - t2190 - t2449 - t2452 - 0.4e1 * t2890 + t3030 + t3031 + t3036 + t3038 - t3199 - t848 - 0.3e1 * t9483 + 0.3e1 * t9492 - 0.3e1 * t9494;
  t9497 = t1020 * t3080;
  t9507 = t785 * t151;
  t9509 = t7619 * t9507 * t380;
  t9519 = t593 * t1025;
  t9520 = t1020 * t9519;
  t9528 = t3683 * t151 * t3040;
  t9534 = t1032 * t785;
  t9535 = t9534 * t151;
  t9539 = t2515 * t8866;
  t9540 = t8821 * t2508;
  t9542 = -0.18e2 * t9497 * t9488 - 0.12e2 * t9497 * t1041 * t1043 * t9487 + 0.18e2 * t6430 * t7580 * t2263 - 0.6e1 * t5644 * t9509 + 0.18e2 * t7635 * t9509 - 0.6e1 * t7630 * t9509 - 0.6e1 * t2461 * t2462 * t8902 + 0.18e2 * t9520 * t7647 * t3085 + t2458 - t2464 - 0.6e1 * t8813 - t2468 - 0.6e1 * t8815 + 0.6e1 * t8818 - 0.7e1 * t7347 * t9528 + 0.6e1 * t7361 * t9528 - t7342 * t9528 - 0.6e1 * t7361 * t1107 * t9535 - t9539 + 0.3e1 * t9540;
  t9544 = t2489 * t8877;
  t9546 = t3683 * t785;
  t9547 = t9546 * t151;
  t9548 = t1107 * t9547;
  t9551 = t2498 * t8866;
  t9552 = t2489 * t8866;
  t9555 = t2490 * t2224;
  t9558 = t9546 * t8964;
  t9563 = t6545 * t3521;
  t9564 = t1020 * t9563;
  t9569 = t8925 * t3521;
  t9570 = t3531 * t9569;
  t9575 = t3531 * t9563;
  t9576 = t7336 * t151;
  t9583 = t7336 * t785;
  t9591 = t2506 * t605;
  t9597 = t372 * t785;
  t9598 = t371 * t9597;
  t9602 = t356 * t3045 * t3509;
  t9608 = 0.3e1 * t9544 + 0.12e2 * t7361 * t9548 - t9551 + 0.3e1 * t9552 + t7350 * t9528 - 0.2e1 * t2515 * t9555 - 0.7e1 * t7342 * t9558 - 0.18e2 * t6449 * t2526 - 0.12e2 * t9564 * t2529 + 0.6e1 * t2495 * t8939 - 0.6e1 * t9570 * t1107 * t3045 * params->csk_a + 0.18e2 * t9575 * t1107 * t9576 - 0.2e1 * t2498 * t9555 - 0.11e2 * t356 * t9569 * t366 * t9583 - 0.7e1 * t7347 * t9558 + 0.6e1 * t2489 * t9555 + 0.6e1 * t2505 * t366 * t9591 + 0.3e1 * t149 * t714 * t3509 * t9598 - 0.3e1 * t9602 * t601 - 0.6e1 * t7342 * t3536 * t9547;
  t9611 = t1964 * t157 * t2188 * t380;
  t9613 = t6454 * t2526;
  t9615 = t8821 * t2529;
  t9620 = t711 * t785;
  t9622 = t356 * t9620 * t380;
  t9633 = t2515 * t8877;
  t9641 = t2498 * t8846;
  t9643 = t2489 * t8846;
  t9649 = t157 * t3084 * t151;
  t9659 = t2490 * t605;
  t9660 = t366 * t9659;
  t9666 = t2515 * t1107 * t8865;
  t9668 = 0.6e1 * t1107 * t2505 * t9591 + 0.7e1 * t2508 * t356 * t9563 + 0.7e1 * t366 * t9575 * t9576 - 0.3e1 * t1097 * t9622 + 0.6e1 * t2489 * t9660 - 0.6e1 * t2515 * t9660 - 0.11e2 * t7347 * t9649 + 0.11e2 * t7350 * t9649 - 0.3e1 * t9641 + 0.3e1 * t9643 - 0.2e1 * t9666;
  t9678 = t156 * t359;
  t9680 = t1031 * t9678 * t151;
  t9687 = t2499 * t2224;
  t9697 = t157 * t9535;
  t9713 = -0.4e1 * t2515 * t1107 * t9659 + 0.11e2 * t9570 * t3536 * t9583 - 0.12e2 * t9465 * t9680 - 0.3e1 * t9602 * t617 - 0.18e2 * t9564 * t2508 + 0.6e1 * t2489 * t9687 + 0.3e1 * t149 * t711 * t153 * t361 * t3086 - 0.6e1 * t2498 * t9687 + 0.6e1 * t7350 * t9697 - 0.18e2 * t7347 * t9697 + 0.6e1 * t7361 * t9697 - 0.6e1 * t8822 - 0.2e1 * t8824 + 0.6e1 * t8832 - 0.6e1 * t8847 + 0.6e1 * t8858 - 0.2e1 * t8867 + 0.6e1 * t8869 + 0.6e1 * t8872 + 0.6e1 * t8878;
  t9719 = t1026 * t703 * t792;
  t9720 = t4960 * t9719;
  t9723 = t1041 * t6671 * t278;
  t9724 = t2181 * t9723;
  t9727 = t1020 * t8925;
  t9732 = 0.6e1 * t2182 * t278 * t3659 * t9727 - 0.2e1 * t1581 * t7565 + t2197 - t2199 - t2216 + t2496 + t2527 - t3079 - t794 - 0.3e1 * t9720 - t9724;
  t9756 = t1925 * t2916;
  t9765 = t1906 * t1031 * t3028 * t151;
  t9783 = t1925 * t3052;
  t9784 = 0.3e1 * t149 * t9620 * t1609 - 0.4e1 * t1906 * t1031 * t849 * t605 + 0.3e1 * t2207 * t5765 - t5783 * t3041 + 0.3e1 * t5744 * t3041 - t5747 * t3041 - 0.6e1 * t1591 * t1026 * t703 * t605 - 0.3e1 * t5783 * t3069 + 0.3e1 * t5744 * t3061 - t9756 - 0.3e1 * t5747 * t3061 + 0.3e1 * t2207 * t5791 + 0.3e1 * t5744 * t3069 - 0.2e1 * t9765 + 0.3e1 * t3046 * t3510 * t2201 + 0.6e1 * t5713 * t3754 * t3024 * t151 + 0.3e1 * t356 * t9507 * t7581 + 0.11e2 * t6546 * t3647 * t2480 + t8926 * t3670 * t6694 * t278 - t9783;
  t9787 = t1910 * t2916;
  t9804 = t1910 * t3029;
  t9805 = t2198 * t1896;
  t9809 = t149 * t711 * t792 * t382;
  t9810 = -0.3e1 * t2169 * t5876 - t2207 * t5898 - 0.2e1 * t3025 * t5783 + t3088 - t3090 - 0.2e1 * t9090 + 0.2e1 * t9092 + 0.2e1 * t9102 + t9804 + t9805 - t9809;
  t9815 = my_piecewise5(t58, 0, t61, 0, t9608 + t9668 + 0.6e1 * t8891 + 0.6e1 * t8893 + t9732 + t9713 - 0.2e1 * t8991 - 0.3e1 * t9633 + t9542 + t9496 - t3083 + t3078 - 0.6e1 * t9063 - t3074 - t3064 + t3059 - t3053 + t3048 + t3050 - 0.2e1 * t5747 * t3055 + 0.3e1 * t2235 * t5810 - 0.3e1 * t9622 * t1089 + 0.18e2 * t7361 * t9558 - 0.12e2 * t7342 * t9548 - 0.2e1 * t8916 + 0.2e1 * t8934 - 0.2e1 * t8936 - 0.6e1 * t9575 * t3536 * t2507 + 0.6e1 * t2524 * t366 * t7457 - 0.6e1 * t9520 * t1107 * t3080 - 0.4e1 * t9049 + t9810 + t9787 + t9784 + 0.3e1 * t9611 + 0.3e1 * t9613 + 0.3e1 * t9615 - 0.4e1 * t8900);
  t9822 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t3095 + t9452 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.25e2 / 0.162e3 * t2865 + 0.5e1 / 0.54e2 * t38 * t48 * t2273 + 0.8e2 / 0.243e3 * t38 * t139 * t857 - 0.1e2 / 0.81e2 * t38 * t43 * t2534 + t147 * t3093 + t53 * t9815));
  tv4rhosigma2lapl0 = t8 * t9822 + t3099;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2lapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 1] += tv4rhosigma2lapl1;

  tv4rhosigma2lapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 2] += tv4rhosigma2lapl2;

  tv4rhosigma2lapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 3] += tv4rhosigma2lapl3;

  tv4rhosigma2lapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 4] += tv4rhosigma2lapl4;

  tv4rhosigma2lapl5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 5] += tv4rhosigma2lapl5;

  tv4rhosigma2lapl6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 6] += tv4rhosigma2lapl6;

  tv4rhosigma2lapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 7] += tv4rhosigma2lapl7;

  tv4rhosigma2lapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 8] += tv4rhosigma2lapl8;

  tv4rhosigma2lapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 9] += tv4rhosigma2lapl9;

  tv4rhosigma2lapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 10] += tv4rhosigma2lapl10;

  t9829 = t7 * t177 * t3180 / 0.1e2;
  t9831 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t3180 + t9829);
  tv4rhosigma2lapl11 = t8 * t9831 + t3184;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 11] += tv4rhosigma2lapl11;

  t9837 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t3095 + t9452);
  tv4rhosigma2lapl12 = t8 * t9837 + t3099;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 12] += tv4rhosigma2lapl12;

  tv4rhosigma2lapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 13] += tv4rhosigma2lapl13;

  tv4rhosigma2lapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 14] += tv4rhosigma2lapl14;

  tv4rhosigma2lapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 15] += tv4rhosigma2lapl15;

  tv4rhosigma2lapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 16] += tv4rhosigma2lapl16;

  tv4rhosigma2lapl17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 17] += tv4rhosigma2lapl17;

  tv4rhosigma2lapl18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 18] += tv4rhosigma2lapl18;

  tv4rhosigma2lapl19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 19] += tv4rhosigma2lapl19;

  tv4rhosigma2lapl20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 20] += tv4rhosigma2lapl20;

  tv4rhosigma2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 21] += tv4rhosigma2lapl21;

  tv4rhosigma2lapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 22] += tv4rhosigma2lapl22;

  t9853 = t812 * t219;
  t9854 = t9853 * t555;
  t9861 = t2588 * t9205;
  t9862 = t2129 * t9861;
  t9864 = t7816 * t9854;
  t9870 = t7797 * t9854;
  t9873 = t6318 * t9861;
  t9878 = t6318 * t5325 * t9205;
  t9880 = t217 * t3165;
  t9882 = t534 * params->csk_a;
  t9883 = t9882 * t219;
  t9884 = t1402 * t224 * t9883;
  t9903 = t2626 * t9228;
  t9905 = t3683 * t812;
  t9906 = t9905 * t2347;
  t9908 = t2616 * t9160;
  t9909 = t9905 * t219;
  t9910 = t541 * t9909;
  t9913 = -0.12e2 * t6078 * t7810 * t9854 + 0.18e2 * t6904 * t8093 * t2409 + 0.3e1 * t9862 + 0.18e2 * t7815 * t9864 + 0.18e2 * t6904 * t8067 * t2409 - 0.6e1 * t6115 * t9870 - 0.3e1 * t9873 - 0.18e2 * t6078 * t9864 - 0.3e1 * t9878 - 0.18e2 * t9880 * t9884 + 0.18e2 * t3166 * t9884 + 0.6e1 * t2129 * t2588 * t2313 * t668 - 0.6e1 * t2583 * t5490 * t6955 + 0.18e2 * t7815 * t9870 - 0.6e1 * t6078 * t9870 - 0.6e1 * t2583 * t2593 * t9222 + 0.3e1 * t9903 - t7842 * t9906 - t9908 - 0.7e1 * t7836 * t9910;
  t9919 = t2626 * t9160;
  t9921 = t2636 * t9160;
  t9924 = t2626 * t9217;
  t9926 = t1487 * t9909;
  t9930 = t531 * t3146 * t4348;
  t9935 = t547 * t812;
  t9936 = t546 * t9935;
  t9941 = t1032 * t812;
  t9942 = t9941 * t219;
  t9943 = t225 * t9942;
  t9955 = t7012 * t4359;
  t9956 = t1390 * t9955;
  t9959 = t2616 * t9228;
  t9966 = 0.3e1 * t217 * t4348 * t765 * t9936 - 0.6e1 * t1487 * t7839 * t9942 - 0.11e2 * t541 * t7836 * t9942 - 0.18e2 * t2633 * t9956 - 0.12e2 * t2651 * t9956 - 0.3e1 * t664 * t9930 - 0.3e1 * t680 * t9930 + t7827 * t9906 + 0.6e1 * t7827 * t9943 - 0.7e1 * t7836 * t9906 - 0.18e2 * t7836 * t9943 + 0.6e1 * t7839 * t9906 + 0.18e2 * t7839 * t9910 + 0.12e2 * t7839 * t9926 + 0.6e1 * t7839 * t9943 - 0.12e2 * t9388 * t9880 + 0.3e1 * t9919 - t9921 + 0.3e1 * t9924 - 0.3e1 * t9959;
  t9975 = t3169 * t219;
  t9976 = t225 * t9975;
  t9981 = t2631 * t819;
  t9982 = t1487 * t9981;
  t9983 = t6129 * t9982;
  t9986 = t2636 * t1487 * t9159;
  t9988 = t2622 * t668;
  t9992 = t541 * t9981;
  t9993 = t6129 * t9992;
  t9995 = t2636 * t9217;
  t9997 = t2622 * t9291;
  t10000 = t762 * t812;
  t10002 = t531 * t10000 * t555;
  t10011 = t225 * t9988;
  t10020 = t2631 * t668;
  t10024 = t9247 * t4359;
  t10025 = t4382 * t10024;
  t10026 = t3146 * params->csk_a;
  t10030 = t7876 * t812;
  t10034 = -0.7e1 * t7842 * t9910 + 0.7e1 * t4382 * t9955 * t541 * t7876 * t219 + 0.11e2 * t7827 * t9976 - 0.11e2 * t7836 * t9976 + 0.3e1 * t9983 - 0.2e1 * t9986 - 0.4e1 * t2636 * t1487 * t9988 + 0.3e1 * t9993 - 0.3e1 * t9995 - 0.6e1 * t2636 * t9997 - 0.3e1 * t10002 * t1461 + 0.7e1 * t7836 * t541 * t9975 + 0.6e1 * t2646 * t541 * t7786 - 0.2e1 * t2616 * t10011 + 0.6e1 * t2626 * t10011 - 0.2e1 * t2636 * t10011 + 0.6e1 * t2626 * t9997 + 0.6e1 * t2630 * t541 * t10020 - 0.6e1 * t10025 * t1487 * t10026 + 0.11e2 * t10025 * t4387 * t10030;
  t10052 = t3122 + t2309 - t2312 - t2578 - t2581 + t2333 - t876 - t2586 + t2591 - t2595 - 0.6e1 * t9145;
  t10063 = t225 * t6974;
  t10070 = t656 * t1396;
  t10075 = t3113 * t555;
  t10076 = t541 * t10075;
  t10077 = t5320 * t10076;
  t10080 = t217 * t10075 * t2387;
  t10084 = t531 * t10070;
  t10097 = 0.6e1 * t9148 - 0.6e1 * t9150 + 0.3e1 * t217 * t762 * t221 * t536 * t3171 - 0.6e1 * t2616 * t10063 + 0.6e1 * t2626 * t10063 - 0.3e1 * t10002 * t1470 - 0.6e1 * t1390 * t10070 * t1487 * t3165 + 0.3e1 * t10077 + 0.3e1 * t10080 + 0.6e1 * t2656 * t9350 - 0.18e2 * t10084 * t541 * t3165 - 0.2e1 * t9161 + 0.6e1 * t9164 - 0.2e1 * t9168 + 0.6e1 * t9182 + 0.6e1 * t9185 + 0.6e1 * t9190 + 0.6e1 * t9207 + 0.6e1 * t9218 - 0.4e1 * t9220;
  t10114 = -0.6e1 * t1397 * t1781 * t668 * t754 + 0.11e2 * t4509 * t754 * t812 * t9270 + 0.3e1 * t2368 * t6279 + 0.3e1 * t3134 * t6225 + t2343 - t2345 - t2383 + t2649 + t2657 - t3164 - t821;
  t10125 = t2095 * t3124;
  t10130 = t2066 * t2987;
  t10131 = t2095 * t2987;
  t10137 = t2059 * t1402 * t3116 * t219;
  t10155 = t1390 * t9247;
  t10161 = t1397 * t754 * t819;
  t10162 = t5418 * t10161;
  t10164 = 0.3e1 * t2353 * t6220 - t6205 * t3141 + 0.3e1 * t6225 * t3141 - t6156 * t3141 - 0.3e1 * t6156 * t3134 - t10125 - 0.2e1 * t6156 * t3127 + 0.3e1 * t2353 * t6249 + t10130 - t10131 + 0.3e1 * t531 * t9853 * t8068 - 0.2e1 * t10137 + 0.3e1 * t3147 * t4349 * t2347 + 0.6e1 * t6172 * t4566 * t3107 * t219 - 0.2e1 * t1784 * t8028 + t9248 * t4526 * t7101 * t294 + 0.3e1 * t6225 * t3154 - 0.3e1 * t6205 * t3154 + 0.6e1 * t10155 * t4518 * t2340 * t294 - 0.3e1 * t10162;
  t10166 = t1415 * t7134 * t294;
  t10167 = t2339 * t10166;
  t10191 = t217 * t762 * t819 * t557;
  t10192 = t2066 * t3117;
  t10193 = t2344 * t2072;
  t10195 = -0.3e1 * t2326 * t6331 - t2353 * t6358 - 0.2e1 * t3108 * t6205 - t10191 + t10192 + t10193 + t3173 - t3175 + 0.2e1 * t9421 - 0.2e1 * t9425 + 0.2e1 * t9429;
  t10200 = my_piecewise5(t102, 0, t103, 0, t3132 - t3125 - 0.6e1 * t9316 - 0.2e1 * t9334 - 0.2e1 * t9347 + 0.2e1 * t9353 - 0.4e1 * t9385 + t3120 - t3168 + t3162 - t3163 + t3118 + t3119 + t10114 - t3159 + t9966 - 0.2e1 * t9260 + 0.6e1 * t9234 + t10052 - 0.6e1 * t9231 - 0.6e1 * t9229 + t10097 + t9913 + t3151 + t10195 + t3149 + t10164 - t10167 + t10034 - 0.12e2 * t7842 * t9926 - 0.6e1 * t7842 * t4387 * t9909 + 0.6e1 * t2630 * t1487 * t10020 - 0.6e1 * t10025 * t4387 * t10026 + 0.18e2 * t10025 * t1487 * t10030 + 0.3e1 * t217 * t10000 * t1804 - t3269 - 0.4e1 * t2059 * t1402 * t877 * t668 - 0.4e1 * t2967);
  t10207 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t3180 + t9829 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.25e2 / 0.162e3 * t2941 + 0.5e1 / 0.54e2 * t38 * t96 * t2419 + 0.8e2 / 0.243e3 * t38 * t207 * t885 - 0.1e2 / 0.81e2 * t38 * t91 * t2661 + t215 * t3178 + t101 * t10200));
  tv4rhosigma2lapl23 = t10207 * t8 + t3184;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 23] += tv4rhosigma2lapl23;

  tv4rhosigma2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigma2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 1] += tv4rhosigma2tau1;

  tv4rhosigma2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 2] += tv4rhosigma2tau2;

  tv4rhosigma2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 3] += tv4rhosigma2tau3;

  tv4rhosigma2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 4] += tv4rhosigma2tau4;

  tv4rhosigma2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 5] += tv4rhosigma2tau5;

  tv4rhosigma2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 6] += tv4rhosigma2tau6;

  tv4rhosigma2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 7] += tv4rhosigma2tau7;

  tv4rhosigma2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 8] += tv4rhosigma2tau8;

  tv4rhosigma2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 9] += tv4rhosigma2tau9;

  tv4rhosigma2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 10] += tv4rhosigma2tau10;

  tv4rhosigma2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 11] += tv4rhosigma2tau11;

  tv4rhosigma2tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 12] += tv4rhosigma2tau12;

  tv4rhosigma2tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 13] += tv4rhosigma2tau13;

  tv4rhosigma2tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 14] += tv4rhosigma2tau14;

  tv4rhosigma2tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 15] += tv4rhosigma2tau15;

  tv4rhosigma2tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 16] += tv4rhosigma2tau16;

  tv4rhosigma2tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 17] += tv4rhosigma2tau17;

  tv4rhosigma2tau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 18] += tv4rhosigma2tau18;

  tv4rhosigma2tau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 19] += tv4rhosigma2tau19;

  tv4rhosigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 20] += tv4rhosigma2tau20;

  tv4rhosigma2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 21] += tv4rhosigma2tau21;

  tv4rhosigma2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 22] += tv4rhosigma2tau22;

  tv4rhosigma2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 23] += tv4rhosigma2tau23;

  t10214 = t7 * t133 * t3252 / 0.1e2;
  t10226 = t3226 * t9468;
  t10232 = t2490 * t68 * t9066;
  t10238 = t1642 * t711;
  t10242 = t7636 * t2456;
  t10257 = t366 * t245;
  t10266 = t895 * params->csk_a * t151;
  t10267 = t1107 * t10266;
  t10270 = t8256 * t3521;
  t10271 = t356 * t10270;
  t10272 = t7343 * t151;
  t10273 = t366 * t10272;
  t10276 = t1020 * t10270;
  t10279 = t149 * t10270;
  t10287 = t356 * t8292 * t361;
  t10290 = -0.18e2 * t8197 * t10226 + 0.18e2 * t8200 * t10226 - 0.6e1 * t8188 * t10232 - 0.6e1 * t8169 * t3215 * t8170 - 0.6e1 * t8169 * t4844 * t10238 - 0.18e2 * t8188 * t10242 - 0.12e2 * t8188 * t7631 * t2456 + 0.18e2 * t8188 * t1107 * t245 * t2263 + 0.6e1 * t1964 * t2455 * t7453 + 0.18e2 * t8217 * t10242 + 0.18e2 * t8188 * t10257 * t2263 - 0.6e1 * t8220 * t10232 + 0.18e2 * t8217 * t10232 - 0.6e1 * t7335 * t10267 - 0.7e1 * t10271 * t10273 - 0.18e2 * t10276 * t4758 + 0.6e1 * t10279 * t2511 - 0.18e2 * t10271 * t2511 + 0.6e1 * t10276 * t2511 - 0.3e1 * t10287 * t2501;
  t10291 = t895 * t151;
  t10304 = t3531 * t10270;
  t10320 = t595 * t711;
  t10321 = t6431 * t10320;
  t10333 = t157 * t10272;
  t10342 = 0.3e1 * t149 * t10291 * t3509 * t844 - 0.3e1 * t10287 * t4758 - 0.12e2 * t8197 * t157 * t598 * t151 - 0.11e2 * t10271 * t2492 + 0.7e1 * t10304 * t2492 + 0.18e2 * t10276 * t10273 - 0.7e1 * t10304 * t10273 - 0.12e2 * t1020 * t7334 * t10267 + 0.11e2 * t10279 * t2501 - 0.11e2 * t10271 * t2501 + 0.7e1 * t10271 * t4758 - 0.6e1 * t2515 * t10321 - 0.6e1 * t7646 * t1107 * t10291 * t380 - 0.6e1 * t7335 * t3536 * t10266 + 0.6e1 * t2489 * t10321 + t10279 * t10333 - 0.7e1 * t10271 * t10333 + 0.6e1 * t10276 * t10333 - t10304 * t10333 + 0.3e1 * t2747 * t8884;
  t10344 = t2499 * t711;
  t10345 = t157 * t10344;
  t10352 = t895 * t1032 * t245;
  t10353 = t1107 * t10352;
  t10358 = t3683 * t1040 * t1561 * t151;
  t10392 = t2490 * t8170;
  t10404 = -0.6e1 * t2498 * t10345 + 0.6e1 * t2515 * t1107 * t10344 + 0.18e2 * t9570 * t10353 - 0.12e2 * t10304 * t10358 - 0.4e1 * t2515 * t1107 * t2490 * t711 + 0.11e2 * t9570 * t3536 * t10352 - 0.6e1 * t10304 * t3536 * t10272 + 0.6e1 * t356 * t1963 * t366 * t7453 - 0.6e1 * t1020 * t9569 * t10353 + 0.12e2 * t10276 * t10358 + 0.6e1 * t8178 * t157 * t10238 - 0.18e2 * t356 * t9519 * t366 * t2734 * t245 - 0.3e1 * t2741 * t8828 + 0.6e1 * t2489 * t10345 + 0.6e1 * t2489 * t10392 - 0.2e1 * t2515 * t10392 - 0.3e1 * t2741 * t8903 + 0.6e1 * t2515 * t366 * t10344 - 0.2e1 * t2498 * t10392 + t3197;
  t10419 = 0.6e1 * t9492 - 0.6e1 * t9494 - 0.3e1 * t8813 - 0.3e1 * t8815 + 0.3e1 * t8818 - 0.2e1 * t9539 + 0.6e1 * t9540 + 0.6e1 * t9544 - 0.2e1 * t9551 + 0.6e1 * t9552 + 0.6e1 * t9611;
  t10439 = 0.6e1 * t9613 + 0.6e1 * t9615 - 0.6e1 * t9633 - 0.6e1 * t9641 + 0.6e1 * t9643 - 0.4e1 * t9666 - 0.3e1 * t8822 - t8824 + 0.3e1 * t8832 - 0.3e1 * t8847 + 0.3e1 * t8858 - t8867 + 0.3e1 * t8869 + 0.3e1 * t8872 + 0.3e1 * t8878 + 0.3e1 * t8891 + 0.3e1 * t8893 - 0.2e1 * t8900 - t3204 + t3205;
  t10446 = t365 * t895;
  t10457 = -0.4e1 * t1031 * t1906 * t711 * t849 + 0.11e2 * t10446 * t245 * t3647 * t8999 - 0.2e1 * t1581 * t8334 - 0.3e1 * t2702 * t8996 - 0.2e1 * t2702 * t9029 + 0.3e1 * t2735 * t8939 + t2197 - t2199 - t2216 + t2724 + t2736 - t2742 - t2744 + t2748 - t2907 + t2917 - t2919 - t3206 - t794 - t902;
  t10500 = t8926 * t3670 * t4932 * t895 + 0.3e1 * t2696 * t8996 + 0.3e1 * t356 * t10291 * t3510 * t10257 + 0.3e1 * t8398 * t371 * t2484 + 0.6e1 * t8270 * t3754 * t2484 + 0.6e1 * t4828 * t3659 * t2692 * t151 + 0.3e1 * t2696 * t8909 + 0.3e1 * t2702 * t4892 - t2699 * t8913 + 0.3e1 * t2696 * t8913 - t2702 * t8913 + 0.3e1 * t2723 * t4957 - 0.6e1 * t1913 * t1026 * t10320 + 0.3e1 * t2702 * t4971 - 0.3e1 * t2699 * t8909 - 0.6e1 * t9720 - 0.2e1 * t9724 - 0.2e1 * t9756 - 0.4e1 * t9765 - 0.2e1 * t9783;
  t10513 = -t2693 * t4868 - 0.3e1 * t2696 * t5045 - 0.2e1 * t2699 * t9094 + t3233 + t3241 - t9090 + t9092 + t9102 + 0.2e1 * t9804 + 0.2e1 * t9805 - 0.2e1 * t9809;
  t10518 = my_piecewise5(t58, 0, t61, 0, -0.6e1 * t9483 + t2867 + t10500 + t10457 + t2896 + t10513 - t8991 + t10439 + t10419 + t10404 - t3218 + t3214 - t3210 - t2190 + t2187 + t2163 + t10342 - t2686 + t3198 + t10290 - 0.3e1 * t9063 - t3037 - 0.4e1 * t3035 - t8916 + t8934 - t8936 - 0.2e1 * t9049 + 0.2e1 * t9787);
  t10525 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t3252 + t10214 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.25e2 / 0.81e2 * t3020 + 0.5e1 / 0.27e2 * t38 * t48 * t2534 + 0.4e2 / 0.243e3 * t38 * t139 * t908 - 0.5e1 / 0.81e2 * t38 * t43 * t2752 + t147 * t3250 + t53 * t10518));
  tv4rhosigmalapl20 = t10525 * t8 + t3256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 1] += tv4rhosigmalapl21;

  tv4rhosigmalapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 2] += tv4rhosigmalapl22;

  tv4rhosigmalapl23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 3] += tv4rhosigmalapl23;

  tv4rhosigmalapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 4] += tv4rhosigmalapl24;

  tv4rhosigmalapl25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 5] += tv4rhosigmalapl25;

  tv4rhosigmalapl26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 6] += tv4rhosigmalapl26;

  tv4rhosigmalapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 7] += tv4rhosigmalapl27;

  t10532 = t7 * t177 * t3324 / 0.1e2;
  t10534 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t3324 + t10532);
  tv4rhosigmalapl28 = t10534 * t8 + t3328;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 8] += tv4rhosigmalapl28;

  t10540 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t3252 + t10214);
  tv4rhosigmalapl29 = t10540 * t8 + t3256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 9] += tv4rhosigmalapl29;

  tv4rhosigmalapl210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 10] += tv4rhosigmalapl210;

  tv4rhosigmalapl211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 11] += tv4rhosigmalapl211;

  tv4rhosigmalapl212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 12] += tv4rhosigmalapl212;

  tv4rhosigmalapl213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 13] += tv4rhosigmalapl213;

  tv4rhosigmalapl214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 14] += tv4rhosigmalapl214;

  tv4rhosigmalapl215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 15] += tv4rhosigmalapl215;

  tv4rhosigmalapl216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 16] += tv4rhosigmalapl216;

  t10556 = t1838 * t762;
  t10560 = t7816 * t2589;
  t10574 = t2622 * t110 * t674 * t555;
  t10583 = t3296 * t9883;
  t10588 = t541 * t262;
  t10600 = t531 * t8689 * t536;
  t10603 = t8602 * t4359;
  t10604 = t1390 * t10603;
  t10607 = t918 * t219;
  t10614 = -0.6e1 * t8525 * t5325 * t10556 - 0.18e2 * t8538 * t10560 - 0.12e2 * t8538 * t7810 * t2589 + 0.18e2 * t8538 * t1487 * t262 * t2409 + 0.18e2 * t8565 * t10560 - 0.6e1 * t8538 * t10574 - 0.6e1 * t8525 * t3280 * t8521 + 0.6e1 * t2129 * t2588 * t7779 - 0.18e2 * t8549 * t10583 + 0.18e2 * t8552 * t10583 + 0.18e2 * t8538 * t10588 * t2409 - 0.6e1 * t8562 * t10574 + 0.18e2 * t8565 * t10574 + 0.6e1 * t9862 - 0.6e1 * t9873 - 0.6e1 * t9878 - 0.3e1 * t10600 * t2619 + 0.6e1 * t10604 * t2624 + 0.3e1 * t217 * t10607 * t4348 * t872 - 0.3e1 * t10600 * t5281;
  t10615 = t531 * t10603;
  t10622 = t217 * t10603;
  t10627 = t7832 * t219;
  t10628 = t541 * t10627;
  t10631 = t4382 * t10603;
  t10638 = t918 * params->csk_a * t219;
  t10639 = t1487 * t10638;
  t10642 = t225 * t10627;
  t10661 = t3683 * t1414 * t1747 * t219;
  t10669 = t918 * t1032 * t262;
  t10673 = -0.4e1 * t1487 * t2622 * t2636 * t762 - 0.12e2 * t219 * t225 * t661 * t8549 + 0.11e2 * t10025 * t10669 * t4387 - 0.12e2 * t10639 * t1390 * t7874 + 0.18e2 * t10604 * t10628 + 0.6e1 * t10604 * t10642 - 0.18e2 * t10604 * t5281 - 0.7e1 * t10615 * t10628 - 0.7e1 * t10615 * t10642 - 0.11e2 * t10615 * t2619 - 0.18e2 * t10615 * t2624 - 0.11e2 * t10615 * t2640 + t10622 * t10642 + 0.11e2 * t10622 * t2619 + 0.6e1 * t10622 * t2624 - 0.7e1 * t10628 * t10631 - t10631 * t10642 - 0.12e2 * t10631 * t10661 + 0.7e1 * t10631 * t2640 - 0.6e1 * t10639 * t7875;
  t10692 = t658 * t762;
  t10693 = t6946 * t10692;
  t10706 = t1487 * t10669;
  t10711 = t2617 * t8521;
  t10714 = t2622 * t8521;
  t10721 = t2617 * t762;
  t10732 = -0.6e1 * t10631 * t4387 * t10627 + 0.6e1 * t6318 * t541 * t7779 + 0.12e2 * t10604 * t10661 + 0.6e1 * t8520 * t225 * t10556 - 0.18e2 * t10084 * t541 * t2825 * t262 + 0.7e1 * t10615 * t5281 - 0.6e1 * t2636 * t10693 - 0.6e1 * t8092 * t1487 * t10607 * t555 - 0.6e1 * t7875 * t4387 * t10638 + 0.6e1 * t2626 * t10693 - 0.6e1 * t1390 * t10024 * t10706 - 0.3e1 * t2844 * t9210 + 0.6e1 * t2626 * t10711 + 0.6e1 * t2626 * t10714 - 0.2e1 * t2636 * t10714 - 0.3e1 * t2844 * t9223 + 0.6e1 * t2636 * t541 * t10721 - 0.2e1 * t2616 * t10714 + 0.6e1 * t2636 * t1487 * t10721 + 0.3e1 * t2850 * t9194;
  t10749 = 0.6e1 * t9993 - 0.6e1 * t9995 - 0.4e1 * t3115 + t3270 + t3271 + t2959 - t3121 + t2973 - t2789 + t2309 - t2312;
  t10768 = t2333 - 0.3e1 * t9145 + 0.3e1 * t9148 - 0.3e1 * t9150 + 0.6e1 * t10077 + 0.6e1 * t10080 - t9161 + 0.3e1 * t9164 - t9168 + 0.3e1 * t9182 + 0.3e1 * t9185 + 0.3e1 * t9190 + 0.3e1 * t9207 + 0.3e1 * t9218 - 0.2e1 * t9220 - 0.3e1 * t9229 - 0.3e1 * t9231 + 0.3e1 * t9234 - t3272 + t3273;
  t10789 = t4526 * t5453 * t918 * t9248 - 0.6e1 * t10692 * t1397 * t2084 - 0.2e1 * t1784 * t8682 - t2794 * t9336 + 0.3e1 * t2797 * t9267 + 0.3e1 * t2797 * t9336 - 0.3e1 * t2808 * t9292 - 0.2e1 * t2808 * t9305 - t2808 * t9336 + 0.3e1 * t2838 * t5415 + t2343 - t2345 - t2383 + t2827 + t2839 + t2988 - t2990 - t2995 - t3274 - t821;
  t10830 = 0.3e1 * t2808 * t5470 - 0.3e1 * t2794 * t9267 + 0.3e1 * t2808 * t5354 + 0.3e1 * t2797 * t9292 + 0.3e1 * t2826 * t9350 - 0.4e1 * t2059 * t1402 * t877 * t762 + 0.11e2 * t9270 * t4509 * t8650 * t262 + 0.3e1 * t531 * t10607 * t4349 * t10588 + 0.3e1 * t8748 * t546 * t2600 + 0.6e1 * t8610 * t4566 * t2600 + 0.6e1 * t5338 * t4518 * t2802 * t219 - 0.2e1 * t10125 + 0.2e1 * t10130 - 0.2e1 * t10131 - 0.4e1 * t10137 - 0.6e1 * t10162 - 0.2e1 * t10167 - t9260 - 0.3e1 * t9316 - t9334;
  t10841 = -0.2e1 * t2794 * t9431 - 0.3e1 * t2797 * t5539 - t2803 * t5367 - 0.2e1 * t10191 + 0.2e1 * t10192 + 0.2e1 * t10193 - t2847 + t2851 + t9421 - t9425 + t9429;
  t10846 = my_piecewise5(t102, 0, t103, 0, 0.18e2 * t10025 * t10706 - 0.6e1 * t10711 * t2616 + t10614 + t10673 + t10732 + t10749 + t10768 + t10789 + t10830 + t10841 - t2845 + t3279 - t3283 - t3286 + t3307 + t3315 - t925 - t9347 + t9353 - 0.2e1 * t9385 + 0.6e1 * t9903 - 0.2e1 * t9908 + 0.6e1 * t9919 - 0.2e1 * t9921 + 0.6e1 * t9924 - 0.6e1 * t9959 + 0.6e1 * t9983 - 0.4e1 * t9986);
  t10853 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t3324 + t10532 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.25e2 / 0.81e2 * t3104 + 0.5e1 / 0.27e2 * t38 * t96 * t2661 + 0.4e2 / 0.243e3 * t38 * t207 * t931 - 0.5e1 / 0.81e2 * t38 * t91 * t2855 + t215 * t3322 + t101 * t10846));
  tv4rhosigmalapl217 = t10853 * t8 + t3328;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 17] += tv4rhosigmalapl217;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmalapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 1] += tv4rhosigmalapltau1;

  tv4rhosigmalapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 2] += tv4rhosigmalapltau2;

  tv4rhosigmalapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 3] += tv4rhosigmalapltau3;

  tv4rhosigmalapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 4] += tv4rhosigmalapltau4;

  tv4rhosigmalapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 5] += tv4rhosigmalapltau5;

  tv4rhosigmalapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 6] += tv4rhosigmalapltau6;

  tv4rhosigmalapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 7] += tv4rhosigmalapltau7;

  tv4rhosigmalapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 8] += tv4rhosigmalapltau8;

  tv4rhosigmalapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 9] += tv4rhosigmalapltau9;

  tv4rhosigmalapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 10] += tv4rhosigmalapltau10;

  tv4rhosigmalapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 11] += tv4rhosigmalapltau11;

  tv4rhosigmalapltau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 12] += tv4rhosigmalapltau12;

  tv4rhosigmalapltau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 13] += tv4rhosigmalapltau13;

  tv4rhosigmalapltau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 14] += tv4rhosigmalapltau14;

  tv4rhosigmalapltau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 15] += tv4rhosigmalapltau15;

  tv4rhosigmalapltau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 16] += tv4rhosigmalapltau16;

  tv4rhosigmalapltau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 17] += tv4rhosigmalapltau17;

  tv4rhosigmalapltau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 18] += tv4rhosigmalapltau18;

  tv4rhosigmalapltau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 19] += tv4rhosigmalapltau19;

  tv4rhosigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 20] += tv4rhosigmalapltau20;

  tv4rhosigmalapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 21] += tv4rhosigmalapltau21;

  tv4rhosigmalapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 22] += tv4rhosigmalapltau22;

  tv4rhosigmalapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 23] += tv4rhosigmalapltau23;

  tv4rhosigmatau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  tv4rhosigmatau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 1] += tv4rhosigmatau21;

  tv4rhosigmatau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 2] += tv4rhosigmatau22;

  tv4rhosigmatau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 3] += tv4rhosigmatau23;

  tv4rhosigmatau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 4] += tv4rhosigmatau24;

  tv4rhosigmatau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 5] += tv4rhosigmatau25;

  tv4rhosigmatau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 6] += tv4rhosigmatau26;

  tv4rhosigmatau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 7] += tv4rhosigmatau27;

  tv4rhosigmatau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 8] += tv4rhosigmatau28;

  tv4rhosigmatau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 9] += tv4rhosigmatau29;

  tv4rhosigmatau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 10] += tv4rhosigmatau210;

  tv4rhosigmatau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 11] += tv4rhosigmatau211;

  tv4rhosigmatau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 12] += tv4rhosigmatau212;

  tv4rhosigmatau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 13] += tv4rhosigmatau213;

  tv4rhosigmatau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 14] += tv4rhosigmatau214;

  tv4rhosigmatau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 15] += tv4rhosigmatau215;

  tv4rhosigmatau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 16] += tv4rhosigmatau216;

  tv4rhosigmatau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 17] += tv4rhosigmatau217;

  t10860 = t7 * t133 * t3390 / 0.1e2;
  t10867 = t3332 * t359 * t1025;
  t10868 = t1020 * t10867;
  t10888 = t356 * t10867;
  t10891 = 0.6e1 * t3035;
  t10892 = 0.9e1 * t157 * t2747 * t711 * t8882 - 0.9e1 * t2741 * t366 * t711 * t8827 - 0.9e1 * t2741 * t8170 * t8827 - 0.6e1 * t10868 * t8851 + 0.18e2 * t10868 * t8874 - 0.18e2 * t10868 * t8887 - 0.12e2 * t10868 * t8897 + 0.18e2 * t10888 * t8887 - t10891 - t2686 + t3356 + t3360 + t3363 + t3365;
  t10904 = t2163 + t2187 - t2190 - 0.9e1 * t9483 + 0.9e1 * t9492 - 0.9e1 * t9494 - 0.3e1 * t9539 + 0.9e1 * t9540 + 0.9e1 * t9544 - 0.3e1 * t9551 + 0.9e1 * t9552 + 0.9e1 * t9611 + 0.9e1 * t9613 + 0.9e1 * t9615;
  t10910 = -0.9e1 * t9633 - 0.9e1 * t9641 + 0.9e1 * t9643 - 0.6e1 * t9666 - t3367 + t3368 - t3369 + t2724 + t2736 + t2197 - t2199 - t2216 - t794 - t902;
  t10911 = t3332 * t3519;
  t10912 = t149 * t10911;
  t10915 = t356 * t10911;
  t10918 = t3531 * t10911;
  t10921 = t1020 * t10911;
  t10938 = t10912 * t8948 + 0.6e1 * t10912 * t8955 + 0.11e2 * t10912 * t9036 - 0.7e1 * t10915 * t8948 - 0.7e1 * t10915 * t8965 - 0.11e2 * t10915 * t9036 - t10918 * t8948 - 0.6e1 * t10918 * t8961 + 0.6e1 * t10921 * t8948 + 0.18e2 * t10921 * t8965 + 0.12e2 * t10921 * t8970 - 0.18e2 * t10921 * t8975 - t2742 - t2744 + t2748;
  t10947 = t3535 * t3332;
  t10949 = t3670 * t10947 * t1032;
  t10957 = t3670 * t10947 * params->csk_a;
  t10961 = t1026 * t1048 * t711;
  t10970 = t1066 * t8170;
  t10974 = t1031 * t1033 * t711;
  t10981 = -0.6e1 * t1041 * t1044 * t2702 * t711 - 0.18e2 * t10915 * t8955 - 0.7e1 * t10918 * t8965 - 0.12e2 * t10918 * t8970 - 0.6e1 * t10918 * t8986 + 0.11e2 * t10949 * t8926 - 0.6e1 * t10957 * t8926 + 0.9e1 * t10961 * t2696 - 0.9e1 * t10961 * t2702 + 0.9e1 * t10970 * t2696 + 0.9e1 * t10974 * t2696 - 0.3e1 * t10974 * t2699 - 0.3e1 * t10974 * t2702 + 0.9e1 * t2702 * t5791;
  t10982 = t365 * t3332;
  t10984 = t3647 * t10982 * t1032;
  t10992 = t1043 * t3332;
  t10994 = t1041 * t10992 * t380;
  t11004 = t1026 * t10982 * t380;
  t11010 = t3659 * t10992 * t1032;
  t11013 = t3332 * t3509;
  t11014 = t356 * t11013;
  t11017 = t3332 * t151;
  t11027 = 0.9e1 * t1014 * t2735 * t371 * t711 - 0.6e1 * t1020 * t10994 * t593 + 0.3e1 * t11017 * t149 * t4848 + 0.7e1 * t10915 * t8975 - 0.11e2 * t10915 * t9004 + 0.6e1 * t10921 * t8955 - 0.9e1 * t10970 * t2699 + 0.7e1 * t10984 * t8926 - 0.18e2 * t11004 * t594 + 0.18e2 * t11010 * t8926 - 0.3e1 * t11014 * t601 + 0.9e1 * t2702 * t5765 + 0.9e1 * t2723 * t5810 - 0.12e2 * t3354 * t9680;
  t11041 = t149 * t10867;
  t11046 = t3353 * t1025;
  t11047 = t149 * t11046;
  t11050 = t356 * t11046;
  t11055 = 0.18e2 * t10868 * t8861 + 0.18e2 * t10888 * t8851 - 0.12e2 * t10921 * t8961 - 0.6e1 * t10921 * t9057 - 0.3e1 * t11014 * t617 - 0.6e1 * t11041 * t8851 - 0.18e2 * t11047 * t8836 + 0.18e2 * t11050 * t8836 - 0.9e1 * t9720 - 0.3e1 * t9724 - 0.3e1 * t9756 - 0.6e1 * t9765 - 0.3e1 * t9783 + 0.3e1 * t9787;
  t11062 = t149 * t11013;
  t11067 = t3647 * t10982;
  t11072 = t3659 * t10992;
  t11077 = t3670 * t10947;
  t11082 = -0.6e1 * t1031 * t2683 * t2699 + 0.3e1 * t11017 * t3515 * t356 + 0.6e1 * t10912 * t9072 + 0.3e1 * t11062 * t612 + 0.11e2 * t11067 * t8999 + 0.6e1 * t11072 * t9727 + t11077 * t8926 - 0.9e1 * t2696 * t5876 - 0.3e1 * t2702 * t5898 - t3380 - t3382 + t3385 + 0.3e1 * t9804 + 0.3e1 * t9805 - 0.3e1 * t9809;
  t11086 = my_piecewise5(t58, 0, t61, 0, t10892 + t10904 + t10910 + t10938 + t10981 + t11027 + t11055 + t11082);
  t11093 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t128 * t3390 + t10860 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.25e2 / 0.54e2 * t3189 + 0.5e1 / 0.18e2 * t38 * t48 * t2752 + t147 * t3388 + t53 * t11086));
  tv4rholapl30 = t11093 * t8 + t3394;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 1] += tv4rholapl31;

  tv4rholapl32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 2] += tv4rholapl32;

  t11100 = t7 * t177 * t3456 / 0.1e2;
  t11102 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t173 * t3456 + t11100);
  tv4rholapl33 = t11102 * t8 + t3460;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 3] += tv4rholapl33;

  t11108 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t190 * t3390 + t10860);
  tv4rholapl34 = t11108 * t8 + t3394;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 4] += tv4rholapl34;

  tv4rholapl35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 5] += tv4rholapl35;

  tv4rholapl36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 6] += tv4rholapl36;

  t11131 = 0.9e1 * t9862 - 0.9e1 * t9873 - 0.9e1 * t9878 + 0.9e1 * t9903 - 0.3e1 * t9908 + 0.9e1 * t9919 - 0.3e1 * t9921 + 0.9e1 * t9924 - 0.9e1 * t9959 + 0.9e1 * t9983 - 0.6e1 * t9986 + 0.9e1 * t9993 - 0.9e1 * t9995 + t3415;
  t11132 = 0.6e1 * t3115;
  t11135 = t3419 - t11132 + t3431 + t3432 - t2789 + t2309 - t2312 + t2333 + 0.9e1 * t10077 + 0.9e1 * t10080 - t3433 + t3434 - t3435 + t2827;
  t11137 = t3398 * t4357;
  t11138 = t1390 * t11137;
  t11141 = t4382 * t11137;
  t11143 = t531 * t11137;
  t11156 = t217 * t11137;
  t11159 = 0.18e2 * t11138 * t9244 + 0.12e2 * t11138 * t9301 + 0.6e1 * t11138 * t9361 + 0.6e1 * t11138 * t9363 - t11141 * t9361 - 0.7e1 * t11143 * t9244 - 0.18e2 * t11143 * t9363 + 0.7e1 * t11143 * t9393 + 0.11e2 * t11156 * t9309 + t2343 - t2345 - t2383 + t2839 - t821;
  t11171 = t1410 * t8521;
  t11180 = t1402 * t2819;
  t11186 = t1417 * t3398;
  t11188 = t1415 * t11186 * t555;
  t11196 = t4518 * t11186 * t1032;
  t11199 = 0.9e1 * t1449 * t2826 * t546 * t762 - 0.6e1 * t11188 * t1390 * t656 - 0.7e1 * t11141 * t9244 + 0.7e1 * t11141 * t9278 - 0.6e1 * t11141 * t9368 - 0.7e1 * t11143 * t9361 + t11156 * t9361 + 0.6e1 * t11156 * t9363 - 0.3e1 * t11171 * t2794 + 0.9e1 * t11171 * t2797 - 0.3e1 * t11171 * t2808 - 0.9e1 * t11180 * t2794 + 0.18e2 * t11196 * t9248 + 0.9e1 * t2808 * t6220 + 0.9e1 * t2838 * t6279;
  t11208 = t4386 * t3398;
  t11210 = t4526 * t11208 * t1032;
  t11218 = t4526 * t11208 * params->csk_a;
  t11222 = t1397 * t1816 * t762;
  t11229 = t4509 * t540 * t3398 * params->csk_a;
  t11234 = t3398 * t4348;
  t11235 = t531 * t11234;
  t11242 = t3398 * t219;
  t11246 = -0.6e1 * t1415 * t1418 * t2808 * t762 + 0.3e1 * t11242 * t217 * t5329 - 0.18e2 * t10155 * t11229 - 0.6e1 * t11141 * t9255 - 0.12e2 * t11141 * t9301 + 0.9e1 * t11180 * t2797 + 0.11e2 * t11210 * t9248 - 0.6e1 * t11218 * t9248 + 0.9e1 * t11222 * t2797 - 0.9e1 * t11222 * t2808 - 0.3e1 * t11235 * t664 - 0.3e1 * t11235 * t680 + 0.9e1 * t2808 * t6249 - 0.12e2 * t3417 * t9388;
  t11255 = t3398 * t534;
  t11256 = t531 * t11255;
  t11265 = t11255 * t1396;
  t11266 = t1390 * t11265;
  t11270 = t217 * t3416 * t1396;
  t11273 = t217 * t11265;
  t11276 = -0.6e1 * t11138 * t9331 - 0.12e2 * t11138 * t9368 - 0.11e2 * t11143 * t9278 - 0.11e2 * t11143 * t9309 - 0.18e2 * t11256 * t9319 + 0.18e2 * t11266 * t9155 - 0.18e2 * t11270 * t9238 - 0.6e1 * t11273 * t9173 - 0.3e1 * t10125 + 0.3e1 * t10130 - 0.3e1 * t10131 - 0.6e1 * t10137 - 0.9e1 * t10162 - 0.3e1 * t10167;
  t11278 = t531 * t11265;
  t11304 = 0.9e1 * t225 * t2850 * t762 * t9192 - 0.9e1 * t2844 * t541 * t762 * t9209 - 0.9e1 * t2844 * t8521 * t9209 - 0.6e1 * t11266 * t9173 + 0.18e2 * t11266 * t9187 - 0.18e2 * t11266 * t9197 - 0.12e2 * t11266 * t9202 + 0.18e2 * t11278 * t2410 + 0.18e2 * t11278 * t9173 + 0.18e2 * t11278 * t9197 - t2845 + t3446 - t3449 - t3451;
  t11307 = t4526 * t11208;
  t11311 = t4518 * t11186;
  t11320 = t217 * t11234;
  t11330 = 0.3e1 * t11242 * t4350 * t531 - 0.6e1 * t1402 * t2786 * t2794 + 0.6e1 * t10155 * t11311 + 0.11e2 * t11143 * t9411 + 0.6e1 * t11156 * t9405 + t11307 * t9248 + 0.3e1 * t11320 * t675 - 0.9e1 * t2797 * t6331 - 0.3e1 * t2808 * t6358 - 0.3e1 * t10191 + 0.3e1 * t10192 + 0.3e1 * t10193 - t2847 + t2851 - t925;
  t11334 = my_piecewise5(t102, 0, t103, 0, t11131 + t11135 + t11159 + t11199 + t11246 + t11276 + t11304 + t11330);
  t11341 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t201 * t3456 + t11100 + 0.3e1 / 0.2e2 * t7 * t86 * (-0.25e2 / 0.54e2 * t3261 + 0.5e1 / 0.18e2 * t38 * t96 * t2855 + t215 * t3454 + t101 * t11334));
  tv4rholapl37 = t11341 * t8 + t3460;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 7] += tv4rholapl37;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapl2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 1] += tv4rholapl2tau1;

  tv4rholapl2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 2] += tv4rholapl2tau2;

  tv4rholapl2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 3] += tv4rholapl2tau3;

  tv4rholapl2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 4] += tv4rholapl2tau4;

  tv4rholapl2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 5] += tv4rholapl2tau5;

  tv4rholapl2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 6] += tv4rholapl2tau6;

  tv4rholapl2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 7] += tv4rholapl2tau7;

  tv4rholapl2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 8] += tv4rholapl2tau8;

  tv4rholapl2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 9] += tv4rholapl2tau9;

  tv4rholapl2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 10] += tv4rholapl2tau10;

  tv4rholapl2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 11] += tv4rholapl2tau11;

  tv4rholapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rholapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 1] += tv4rholapltau21;

  tv4rholapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 2] += tv4rholapltau22;

  tv4rholapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 3] += tv4rholapltau23;

  tv4rholapltau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 4] += tv4rholapltau24;

  tv4rholapltau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 5] += tv4rholapltau25;

  tv4rholapltau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 6] += tv4rholapltau26;

  tv4rholapltau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 7] += tv4rholapltau27;

  tv4rholapltau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 8] += tv4rholapltau28;

  tv4rholapltau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 9] += tv4rholapltau29;

  tv4rholapltau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 10] += tv4rholapltau210;

  tv4rholapltau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 11] += tv4rholapltau211;

  tv4rhotau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 0] += tv4rhotau30;

  tv4rhotau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 1] += tv4rhotau31;

  tv4rhotau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 2] += tv4rhotau32;

  tv4rhotau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 3] += tv4rhotau33;

  tv4rhotau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 4] += tv4rhotau34;

  tv4rhotau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 5] += tv4rhotau35;

  tv4rhotau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 6] += tv4rhotau36;

  tv4rhotau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 7] += tv4rhotau37;

  t11358 = t6586 * t3069;
  t11360 = t785 * t785;
  t11365 = t11360 * t359;
  t11366 = t149 * t11365;
  t11370 = t1026 * t1048 * t792;
  t11371 = t2169 * t11370;
  t11374 = t1041 * t1044 * t792;
  t11375 = t2207 * t11374;
  t11377 = t2207 * t6673;
  t11379 = t356 * t11365;
  t11382 = t1031 * t2915;
  t11383 = t2165 * t11382;
  t11385 = 0.18e2 * t11360 * t3550 * t356 * t380 - 0.18e2 * t11366 * t3557 + 0.18e2 * t11379 * t3575 + 0.18e2 * t11358 + 0.18e2 * t11371 - 0.12e2 * t11375 + 0.18e2 * t11377 - 0.18e2 * t11383 - 0.4e1 * t2921 - t794 - t796;
  t11387 = t2235 * t6707;
  t11389 = t2207 * t11370;
  t11391 = t1020 * t11365;
  t11395 = t1031 * t1033 * t792;
  t11396 = t2165 * t11395;
  t11398 = t2169 * t11395;
  t11400 = t2207 * t6580;
  t11408 = t792 * t785;
  t11410 = t149 * t11408 * t1609;
  t11419 = t2207 * t11395;
  t11422 = t356 * t11408 * t380;
  t11423 = t11422 * t1097;
  t11426 = t157 * t8882 * t792;
  t11427 = t2262 * t11426;
  t11429 = t11422 * t1089;
  t11433 = t356 * t11360;
  t11436 = t149 * t11360;
  t11441 = t11360 * t3531 * t3537 + 0.18e2 * t11391 * t3566 - 0.12e2 * t11391 * t3570 - 0.18e2 * t11391 * t3575 + 0.11e2 * t11433 * t3543 + 0.3e1 * t11436 * t3511 + 0.6e1 * t11436 * t3526 - 0.6e1 * t11419 - 0.18e2 * t11423 + 0.18e2 * t11427 - 0.18e2 * t11429;
  t11449 = t792 * t792;
  t11450 = t149 * t11449;
  t11452 = 0.3e1 * t11450 * t384;
  t11455 = 0.3e1 * t356 * t11449 * t367;
  t11457 = 0.3e1 * t11450 * t382;
  t11458 = t11360 * t3519;
  t11459 = t3531 * t11458;
  t11471 = t1031 * t3028;
  t11472 = t2165 * t11471;
  t11474 = t356 * t11458;
  t11479 = t2207 * t6776;
  t11483 = t1020 * t11458;
  t11496 = -0.6e1 * t11459 * t3672 + 0.7e1 * t11474 * t3648 - 0.11e2 * t11474 * t3707 - 0.7e1 * t11474 * t3717 - 0.7e1 * t11474 * t3756 - 0.18e2 * t11483 * t3648 + 0.12e2 * t11483 * t3711 + 0.18e2 * t11483 * t3717 + 0.6e1 * t11483 * t3756 - 0.12e2 * t11472 - 0.6e1 * t11479;
  t11499 = t149 * t11458;
  t11507 = t11449 * t359;
  t11508 = t356 * t11507;
  t11510 = 0.3e1 * t11508 * t390;
  t11522 = t11360 * t3509;
  t11523 = t356 * t11522;
  t11537 = t2169 * t6786;
  t11540 = 0.3e1 * t11508 * t373;
  t11543 = 0.3e1 * t149 * t11507 * t373;
  t11546 = 0.3e1 * t11522 * t149 * t373 - 0.18e2 * t11379 * t3738 - 0.7e1 * t11459 * t3717 - 0.6e1 * t11483 * t3660 + 0.6e1 * t11483 * t3768 + 0.11e2 * t11499 * t3729 - 0.3e1 * t11523 * t373 - 0.3e1 * t11523 * t390 - 0.18e2 * t11537 - t11540 + t11543;
  t11550 = my_piecewise5(t58, 0, t61, 0, 0.4e1 * t2867 + 0.4e1 * t2917 - 0.4e1 * t2919 + 0.4e1 * t2913 - 0.4e1 * t2907 - 0.4e1 * t2910 + 0.4e1 * t2905 + 0.4e1 * t2896 - 0.9e1 * t2890 + 0.4e1 * t2872 + t11546 - t11510 + t11496 + t11455 - t11457 + t11452 + t11441 + 0.18e2 * t11410 + 0.18e2 * t11398 + 0.18e2 * t11400 - 0.6e1 * t11396 - 0.18e2 * t11389 + t11385 + 0.18e2 * t11387 + 0.7e1 * t11459 * t3707 + 0.18e2 * t11459 * t3660 - 0.12e2 * t11459 * t3711 + 0.11e2 * t11459 * t3680 - 0.6e1 * t11459 * t3685 + 0.3e1 * t11433 * t3515 - 0.6e1 * t11366 * t3590 + 0.18e2 * t11379 * t3590 - 0.6e1 * t11391 * t3590 + 0.18e2 * t11391 * t3610 - 0.6e1 * t11391 * t3696 - 0.12e2 * t11483 * t3746 - 0.11e2 * t11474 * t3729 + t11499 * t3756 + 0.6e1 * t11499 * t3768 - 0.18e2 * t11474 * t3768 - 0.6e1 * t11459 * t3746 - 0.12e2 * t11366 * t3702 - t11459 * t3756 + 0.6e1 * t1020 * t11360 * t3523);
  t11556 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (-0.2e2 / 0.81e2 * t38 * t43 * t2933 + t53 * t11550));
  tv4sigma40 = t8 * t11556;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t11572 = t7042 * t3154;
  t11574 = t812 * t812;
  t11575 = t11574 * t555;
  t11579 = t11574 * t534;
  t11580 = t217 * t11579;
  t11583 = t2353 * t7035;
  t11585 = t1390 * t11579;
  t11589 = t1402 * t1403 * t819;
  t11590 = t2334 * t11589;
  t11592 = t2326 * t11589;
  t11596 = 0.18e2 * t11575 * t5263 * t531 - 0.18e2 * t11580 * t4392 - 0.6e1 * t11580 * t4447 + 0.18e2 * t11585 * t4486 + 0.18e2 * t11572 + 0.18e2 * t11583 - 0.6e1 * t11590 + 0.18e2 * t11592 - 0.4e1 * t2997 - t821 - t823;
  t11598 = t531 * t11579;
  t11605 = t2368 * t7173;
  t11609 = t819 * t812;
  t11611 = t217 * t11609 * t1804;
  t11613 = t2353 * t11589;
  t11615 = t2353 * t7136;
  t11618 = t1397 * t1816 * t819;
  t11619 = t2326 * t11618;
  t11621 = t2353 * t11618;
  t11625 = t1415 * t1418 * t819;
  t11626 = t2353 * t11625;
  t11630 = t1402 * t2986;
  t11631 = t2334 * t11630;
  t11636 = t531 * t11609 * t555;
  t11637 = t11636 * t1470;
  t11639 = t11636 * t1461;
  t11642 = t225 * t9192 * t819;
  t11643 = t2408 * t11642;
  t11645 = t217 * t11574;
  t11650 = t531 * t11574;
  t11655 = -0.6e1 * t11585 * t4447 + 0.18e2 * t11598 * t4405 + 0.3e1 * t11645 * t4354 + 0.6e1 * t11645 * t4361 + 0.3e1 * t11650 * t4350 + 0.11e2 * t11650 * t4377 - 0.12e2 * t11626 - 0.18e2 * t11631 - 0.18e2 * t11637 - 0.18e2 * t11639 + 0.18e2 * t11643;
  t11661 = t819 * t819;
  t11662 = t217 * t11661;
  t11664 = 0.3e1 * t11662 * t559;
  t11667 = 0.3e1 * t531 * t11661 * t542;
  t11669 = 0.3e1 * t11662 * t557;
  t11672 = t11574 * t4357;
  t11673 = t4382 * t11672;
  t11678 = t531 * t11672;
  t11683 = t2353 * t7252;
  t11692 = t217 * t11672;
  t11696 = t1390 * t11672;
  t11708 = 0.18e2 * t11673 * t4519 - 0.12e2 * t11673 * t4523 - 0.6e1 * t11673 * t4543 - 0.6e1 * t11673 * t4589 - t11673 * t4593 - 0.7e1 * t11678 * t4593 - 0.18e2 * t11678 * t4600 + t11692 * t4593 + 0.6e1 * t11692 * t4600 + 0.18e2 * t11696 * t4553 + 0.6e1 * t11696 * t4593;
  t11716 = t11574 * t4348;
  t11717 = t531 * t11716;
  t11726 = t7040 * t3108;
  t11739 = t2326 * t7242;
  t11741 = t11661 * t534;
  t11742 = t531 * t11741;
  t11744 = 0.3e1 * t11742 * t548;
  t11746 = 0.3e1 * t11742 * t565;
  t11749 = 0.3e1 * t217 * t11741 * t548;
  t11760 = -0.6e1 * t11585 * t4494 + 0.7e1 * t11673 * t4550 - 0.7e1 * t11673 * t4553 - 0.11e2 * t11678 * t4567 + 0.11e2 * t11692 * t4567 - 0.6e1 * t11696 * t4519 - 0.12e2 * t11696 * t4589 - 0.18e2 * t11739 - t11744 - t11746 + t11749;
  t11764 = my_piecewise5(t102, 0, t103, 0, -0.12e2 * t11726 + t11708 - 0.6e1 * t11683 + t11667 - t11669 + t11664 + t11655 - 0.18e2 * t11621 + 0.18e2 * t11619 + 0.18e2 * t11611 - 0.6e1 * t11613 + 0.18e2 * t11615 + 0.18e2 * t11605 + t11596 - 0.3e1 * t11717 * t548 - 0.3e1 * t11717 * t565 + 0.6e1 * t11696 * t4600 - 0.18e2 * t11598 * t4504 + 0.12e2 * t11696 * t4523 - 0.7e1 * t11678 * t4553 + 0.7e1 * t11678 * t4510 - 0.11e2 * t11678 * t4550 + 0.11e2 * t11673 * t4528 - 0.6e1 * t11673 * t4532 - 0.12e2 * t11585 * t4409 + 0.18e2 * t11585 * t4417 + 0.18e2 * t11598 * t4447 - 0.18e2 * t11585 * t4405 - 0.18e2 * t11696 * t4510 + t11760 + 0.6e1 * t1390 * t11574 * t4365 + t4382 * t11574 * t4388 - 0.12e2 * t217 * t11575 * t4575 + 0.3e1 * t217 * t11716 * t548 + 0.4e1 * t2959 - 0.9e1 * t2967 + 0.4e1 * t2971 + 0.4e1 * t2973 + 0.4e1 * t2977 + 0.4e1 * t2984 + 0.4e1 * t2988 - 0.4e1 * t2990 - 0.4e1 * t2993 - 0.4e1 * t2995);
  t11770 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * (-0.2e2 / 0.81e2 * t38 * t91 * t3009 + t101 * t11764));
  tv4sigma414 = t8 * t11770;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

  t11777 = t8827 * t792;
  t11779 = t2461 * t2462 * t11777;
  t11780 = 0.9e1 * t11779;
  t11782 = t371 * t156 * t3215;
  t11783 = t9491 * t11782;
  t11784 = 0.9e1 * t11783;
  t11785 = t9482 * t11782;
  t11786 = 0.9e1 * t11785;
  t11787 = t278 * t2869;
  t11788 = t149 * t11787;
  t11791 = t356 * t11787;
  t11796 = -0.12e2 * t11788 * t4839 - 0.3e1 * t11791 * t4845 - 0.18e2 * t5709 * t8947 - t11780 + t11784 - t11786 + t2868 + t2897 + t3030 + t3031 - t3366 - t848 - t8810;
  t11798 = t3754 * t1033 * t2869;
  t11803 = t156 * t2869;
  t11805 = t3754 * t11803 * params->csk_a;
  t11811 = t3659 * t3710 * t2869;
  t11830 = t4875 * t2869 * t68 * t156;
  t11835 = 0.3e1 * t11788 * t4848 - 0.3e1 * t11791 * t4848 + 0.6e1 * t11798 * t5713 + 0.6e1 * t11798 * t5722 - 0.18e2 * t11798 * t5727 + 0.11e2 * t11805 * t5713 - 0.11e2 * t11805 * t5727 + 0.12e2 * t11811 * t5722 - 0.12e2 * t11811 * t5740 + 0.6e1 * t11830 * t5722 - 0.7e1 * t11830 * t5727 + 0.7e1 * t5709 * t8958 - 0.6e1 * t5722 * t9023 + 0.7e1 * t5829 * t8951;
  t11842 = t3647 * t3716 * t2869;
  t11847 = t11830 * t5713 - t11830 * t5740 + 0.18e2 * t11842 * t5722 - 0.7e1 * t11842 * t5727 - t2908 + t2918 - t2920 + 0.4e1 * t3047 + 0.4e1 * t3049 - t3053 + t3059 - t3064 - t794;
  t11862 = t1581 * t9723;
  t11863 = 0.3e1 * t11862;
  t11864 = t1591 * t9719;
  t11865 = 0.9e1 * t11864;
  t11870 = t1906 * t1031 * t849 * t792;
  t11871 = 0.6e1 * t11870;
  t11879 = -0.6e1 * t2869 * t3670 * t3684 * t5740 - 0.7e1 * t11842 * t5740 - 0.12e2 * t5706 * t8947 - 0.6e1 * t5706 * t8951 - 0.18e2 * t5731 * t9045 - 0.6e1 * t5796 * t8951 - 0.6e1 * t5824 * t9007 - 0.11e2 * t5829 * t8958 + 0.18e2 * t5833 * t8951 + 0.11e2 * t5850 * t8951 + 0.9e1 * t11358 - t11863 - t11865 - t11871;
  t11893 = t11787 * t380;
  t11894 = t356 * t11893;
  t11897 = t1020 * t11893;
  t11900 = 0.18e2 * t11894 * t4722 - 0.18e2 * t11897 * t4722 + 0.9e1 * t11371 - 0.6e1 * t11375 + 0.9e1 * t11377 - 0.9e1 * t11383 + 0.9e1 * t11387 - 0.9e1 * t11389 - 0.3e1 * t11396 + 0.9e1 * t11398 + 0.9e1 * t11400 + 0.9e1 * t11410 - 0.3e1 * t11419;
  t11903 = t1032 * t2869 * t157 * t380;
  t11913 = t157 * t8844 * t245;
  t11914 = t2498 * t11913;
  t11915 = 0.9e1 * t11914;
  t11916 = t2489 * t11913;
  t11917 = 0.9e1 * t11916;
  t11918 = t8864 * t245;
  t11919 = t366 * t11918;
  t11920 = t2515 * t11919;
  t11921 = 0.9e1 * t11920;
  t11924 = t2489 * t11919;
  t11925 = 0.9e1 * t11924;
  t11930 = t2490 * t157 * t792;
  t11931 = t2515 * t11930;
  t11932 = 0.3e1 * t11931;
  t11934 = t371 * t1014 * t792;
  t11935 = t2495 * t11934;
  t11936 = 0.9e1 * t11935;
  t11939 = t2498 * t11930;
  t11940 = 0.3e1 * t11939;
  t11941 = -0.18e2 * t11893 * t149 * t3550 + 0.18e2 * t11894 * t3550 - 0.6e1 * t11903 * t5644 - 0.6e1 * t11903 * t7630 + 0.18e2 * t11903 * t7635 + 0.18e2 * t5678 * t8860 + 0.18e2 * t5681 * t8860 - t11915 + t11917 - t11921 + t11925 - t11932 + t11936 - t11940;
  t11943 = t2489 * t11930;
  t11944 = 0.9e1 * t11943;
  t11947 = t2505 * t366 * t2506 * t792;
  t11948 = 0.9e1 * t11947;
  t11949 = t8821 * t7368;
  t11950 = 0.9e1 * t11949;
  t11952 = t2515 * t1107 * t11918;
  t11953 = 0.6e1 * t11952;
  t11957 = t2524 * t366 * t9481;
  t11958 = 0.9e1 * t11957;
  t11965 = -0.12e2 * t11897 * t4804 - 0.9e1 * t11423 + 0.9e1 * t11427 - 0.9e1 * t11429 + t11452 + t11944 + t11948 + t11950 - t11953 + t11958 - 0.4e1 * t3082 + 0.4e1 * t3087 - 0.4e1 * t3089;
  t11981 = 0.6e1 * t11803 * t3754 * t5713 + 0.3e1 * t11788 * t3511 + 0.6e1 * t5880 * t8947 + 0.11e2 * t5885 * t8958 + t5901 * t8951 + 0.3e1 * t704 * t8943 + t11455 - t11457 - 0.6e1 * t11472 - 0.3e1 * t11479 - t11510 - 0.9e1 * t11537 - t11540 + t11543;
  t11985 = my_piecewise5(t58, 0, t61, 0, t11796 + t11835 + t11847 + t11879 + t11900 + t11941 + t11965 + t11981);
  t11991 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (0.5e1 / 0.54e2 * t38 * t48 * t2933 - 0.5e1 / 0.27e2 * t38 * t43 * t3093 + t53 * t11985));
  tv4sigma3lapl0 = t8 * t11991;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3lapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 1] += tv4sigma3lapl1;

  tv4sigma3lapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 2] += tv4sigma3lapl2;

  tv4sigma3lapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 3] += tv4sigma3lapl3;

  tv4sigma3lapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 4] += tv4sigma3lapl4;

  tv4sigma3lapl5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 5] += tv4sigma3lapl5;

  tv4sigma3lapl6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 6] += tv4sigma3lapl6;

  tv4sigma3lapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 7] += tv4sigma3lapl7;

  tv4sigma3lapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 8] += tv4sigma3lapl8;

  tv4sigma3lapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 9] += tv4sigma3lapl9;

  tv4sigma3lapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 10] += tv4sigma3lapl10;

  tv4sigma3lapl11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 11] += tv4sigma3lapl11;

  tv4sigma3lapl12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 12] += tv4sigma3lapl12;

  tv4sigma3lapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 13] += tv4sigma3lapl13;

  tv4sigma3lapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 14] += tv4sigma3lapl14;

  tv4sigma3lapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 15] += tv4sigma3lapl15;

  tv4sigma3lapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 16] += tv4sigma3lapl16;

  tv4sigma3lapl17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 17] += tv4sigma3lapl17;

  tv4sigma3lapl18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 18] += tv4sigma3lapl18;

  t11998 = t2588 * t9143;
  t11999 = t2129 * t11998;
  t12000 = 0.9e1 * t11999;
  t12001 = t6318 * t11998;
  t12002 = 0.9e1 * t12001;
  t12004 = t6318 * t5325 * t9143;
  t12005 = 0.9e1 * t12004;
  t12008 = t4522 * t2943 * t538 * t540;
  t12015 = -0.7e1 * t12008 * t6163 - 0.6e1 * t6160 * t9297 + 0.7e1 * t6167 * t9243 + t12000 - t12002 - t12005 + t2960 + t2974 + t3118 + t3119 - t3429 - t876 - t9142;
  t12020 = t4522 * t2943 * t110 * t224;
  t12026 = t4518 * t5339 * t2943;
  t12029 = t224 * t2943;
  t12031 = t4566 * t12029 * params->csk_a;
  t12050 = t294 * t2943;
  t12051 = t217 * t12050;
  t12054 = -0.6e1 * t2943 * t4526 * t4531 * t6163 + 0.18e2 * t12008 * t6160 - 0.7e1 * t12008 * t6191 + 0.6e1 * t12020 * t6160 - t12020 * t6163 + t12020 * t6172 - 0.7e1 * t12020 * t6191 + 0.12e2 * t12026 * t6160 + 0.11e2 * t12031 * t6172 - 0.11e2 * t12031 * t6191 - 0.12e2 * t12051 * t5409 - 0.12e2 * t6175 * t9330 - 0.6e1 * t6254 * t9243 + 0.11e2 * t6264 * t9243;
  t12056 = t1784 * t10166;
  t12057 = 0.3e1 * t12056;
  t12060 = t2059 * t1402 * t877 * t819;
  t12061 = 0.6e1 * t12060;
  t12066 = t1781 * t10161;
  t12067 = 0.9e1 * t12066;
  t12078 = t531 * t12050;
  t12087 = -0.11e2 * t1816 * t2943 * t4509 * t6191 - 0.12e2 * t12026 * t6163 + 0.3e1 * t12051 * t5329 - 0.3e1 * t12078 * t5326 - 0.3e1 * t12078 * t5329 - 0.6e1 * t6175 * t9243 + 0.7e1 * t6191 * t9273 - 0.18e2 * t6235 * t9318 - 0.6e1 * t6283 * t9281 + 0.18e2 * t6298 * t9243 - t12057 - t12061 - t12067;
  t12091 = t4566 * t1403 * t2943;
  t12100 = t1032 * t2943;
  t12101 = t12100 * t555;
  t12105 = -0.12e2 * t12101 * t1487 * t6078 + 0.6e1 * t12091 * t6160 + 0.6e1 * t12091 * t6172 - 0.18e2 * t12091 * t6191 - 0.18e2 * t6271 * t9330 + t2989 - t2991 - t2996 - t3125 + t3132 + 0.4e1 * t3148 + 0.4e1 * t3150 - t3159 - t821;
  t12111 = t225 * t9179 * t262;
  t12112 = t2616 * t12111;
  t12113 = 0.9e1 * t12112;
  t12114 = t2626 * t12111;
  t12115 = 0.9e1 * t12114;
  t12116 = t12100 * t4404;
  t12119 = t9158 * t3296;
  t12120 = t2636 * t12119;
  t12121 = 0.3e1 * t12120;
  t12122 = t9158 * t262;
  t12123 = t541 * t12122;
  t12124 = t2626 * t12123;
  t12125 = 0.9e1 * t12124;
  t12126 = t2626 * t12119;
  t12127 = 0.9e1 * t12126;
  t12128 = t12050 * t555;
  t12135 = t2616 * t12119;
  t12136 = 0.3e1 * t12135;
  t12140 = -0.18e2 * t12128 * t217 * t5263 + 0.18e2 * t12128 * t5263 * t531 - 0.18e2 * t12116 * t6078 + 0.18e2 * t6148 * t9154 + 0.9e1 * t11572 + 0.9e1 * t11583 - 0.3e1 * t11590 - t12113 + t12115 - t12121 + t12125 + t12127 - t12136;
  t12154 = t225 * t12101;
  t12161 = 0.18e2 * t12116 * t7815 - 0.6e1 * t12154 * t6078 - 0.6e1 * t12154 * t6115 + 0.18e2 * t12154 * t7815 + 0.18e2 * t6141 * t9154 + 0.9e1 * t11592 + 0.9e1 * t11605 + 0.9e1 * t11611 - 0.3e1 * t11613 + 0.9e1 * t11615 + 0.9e1 * t11619 - 0.9e1 * t11621 - 0.6e1 * t11626 - 0.9e1 * t11631;
  t12164 = t546 * t1449 * t819;
  t12165 = t2656 * t12164;
  t12166 = 0.9e1 * t12165;
  t12167 = t2630 * t9982;
  t12168 = 0.9e1 * t12167;
  t12170 = t2636 * t1487 * t12122;
  t12171 = 0.6e1 * t12170;
  t12172 = t2630 * t9992;
  t12173 = 0.9e1 * t12172;
  t12174 = t2636 * t12123;
  t12175 = 0.9e1 * t12174;
  t12176 = t2646 * t10076;
  t12177 = 0.9e1 * t12176;
  t12184 = t12166 + t12168 - t12171 + t12173 - t12175 + t12177 - 0.9e1 * t11637 - 0.9e1 * t11639 + 0.9e1 * t11643 - 0.4e1 * t3167 + 0.4e1 * t3172 - 0.4e1 * t3174 + t11664;
  t12200 = 0.6e1 * t12029 * t4566 * t6172 + 0.3e1 * t12051 * t4354 + 0.6e1 * t6335 * t9330 + 0.11e2 * t6345 * t9276 + t6361 * t9243 + 0.3e1 * t755 * t9378 + t11667 - t11669 - 0.3e1 * t11683 - 0.6e1 * t11726 - 0.9e1 * t11739 - t11744 - t11746 + t11749;
  t12204 = my_piecewise5(t102, 0, t103, 0, t12015 + t12054 + t12087 + t12105 + t12140 + t12161 + t12184 + t12200);
  t12210 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * (0.5e1 / 0.54e2 * t38 * t96 * t3009 - 0.5e1 / 0.27e2 * t38 * t91 * t3178 + t101 * t12204));
  tv4sigma3lapl19 = t8 * t12210;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 19] += tv4sigma3lapl19;

  tv4sigma3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 1] += tv4sigma3tau1;

  tv4sigma3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 2] += tv4sigma3tau2;

  tv4sigma3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 3] += tv4sigma3tau3;

  tv4sigma3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 4] += tv4sigma3tau4;

  tv4sigma3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 5] += tv4sigma3tau5;

  tv4sigma3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 6] += tv4sigma3tau6;

  tv4sigma3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 7] += tv4sigma3tau7;

  tv4sigma3tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 8] += tv4sigma3tau8;

  tv4sigma3tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 9] += tv4sigma3tau9;

  tv4sigma3tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 10] += tv4sigma3tau10;

  tv4sigma3tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 11] += tv4sigma3tau11;

  tv4sigma3tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 12] += tv4sigma3tau12;

  tv4sigma3tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 13] += tv4sigma3tau13;

  tv4sigma3tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 14] += tv4sigma3tau14;

  tv4sigma3tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 15] += tv4sigma3tau15;

  tv4sigma3tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 16] += tv4sigma3tau16;

  tv4sigma3tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 17] += tv4sigma3tau17;

  tv4sigma3tau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 18] += tv4sigma3tau18;

  tv4sigma3tau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 19] += tv4sigma3tau19;

  t12222 = t3754 * t9597;
  t12228 = t3647 * t3716 * t785;
  t12233 = t3647 * t3060;
  t12236 = -0.11e2 * t12222 * t8266 + 0.11e2 * t12222 * t8270 - 0.7e1 * t12228 * t8257 + 0.18e2 * t12228 * t8278 + 0.7e1 * t12233 * t8257 - 0.12e2 * t6550 * t8263 - t10891 - 0.12e2 * t11779 + 0.12e2 * t11783 - 0.12e2 * t11785 - t2891 + t3036 + t3038 + t3197 + t3198;
  t12237 = t4875 * t3040;
  t12245 = t3754 * t1033 * t785;
  t12252 = t6682 * params->csk_a;
  t12253 = t3647 * t12252;
  t12259 = t3659 * t3710 * t785;
  t12262 = t2735 * t11934;
  t12268 = t2702 * t11395;
  t12269 = t2696 * t11382;
  t12271 = t2702 * t6580;
  t12273 = t2699 * t11395;
  t12274 = -0.18e2 * t1026 * t10446 * t380 * t798 - 0.7e1 * t12228 * t8266 - t12237 * t8257 - 0.7e1 * t12237 * t8266 + t12237 * t8270 + 0.6e1 * t12237 * t8278 - 0.18e2 * t12245 * t8266 + 0.6e1 * t12245 * t8270 - 0.18e2 * t12253 * t8278 + 0.12e2 * t12259 * t8278 - 0.6e1 * t6578 * t8263 + 0.3e1 * t12262 - t12268 + 0.3e1 * t12269 + 0.3e1 * t12271 - t12273;
  t12276 = t2696 * t11395;
  t12278 = t2702 * t6673;
  t12280 = t2699 * t11382;
  t12284 = t2702 * t11370;
  t12290 = t2702 * t11374;
  t12298 = t2723 * t6707;
  t12302 = t2696 * t11370;
  t12311 = -0.6e1 * t3670 * t3684 * t785 * t8257 - 0.6e1 * t1020 * t788 * t8370 + 0.7e1 * t12253 * t8266 - 0.12e2 * t12259 * t8257 - 0.6e1 * t6550 * t8345 - 0.6e1 * t6578 * t8339 + 0.18e2 * t6578 * t8345 + 0.11e2 * t6578 * t8358 - 0.3e1 * t8293 * t9598 + 0.3e1 * t12276 + 0.3e1 * t12278 - 0.3e1 * t12280 - 0.3e1 * t12284 - 0.2e1 * t12290 + 0.3e1 * t12298 + 0.3e1 * t12302;
  t12317 = t895 * t785;
  t12330 = t9534 * t380;
  t12331 = t157 * t12330;
  t12336 = -0.12e2 * t1031 * t2735 * t3024 * t359 - 0.3e1 * t12252 * t388 * t8293 + 0.3e1 * t12317 * t149 * t4848 + 0.18e2 * t3085 * t366 * t8188 - 0.11e2 * t12233 * t8266 + 0.6e1 * t12245 * t8278 + 0.18e2 * t12331 * t8217 - 0.6e1 * t12331 * t8220 - t3074 + t3078 - t3079 - t3204 + t3205 - t3206 - t794 - t902;
  t12340 = t157 * t788 * params->csk_a;
  t12346 = t2741 * t8844 * t1096;
  t12348 = t2747 * t11426;
  t12351 = t2741 * t366 * t11777;
  t12356 = t6431 * t6683;
  t12371 = -0.12e2 * t1107 * t12330 * t8188 + 0.18e2 * t1107 * t3085 * t8188 - 0.6e1 * t12331 * t8188 - 0.18e2 * t12340 * t8197 + 0.18e2 * t12340 * t8200 - 0.18e2 * t12356 * t8188 + 0.18e2 * t12356 * t8217 + 0.3e1 * t11358 + 0.3e1 * t11371 - 0.4e1 * t11862 - 0.12e2 * t11864 - 0.8e1 * t11870 - 0.3e1 * t12346 + 0.3e1 * t12348 - 0.3e1 * t12351;
  t12386 = -0.2e1 * t11375 + 0.3e1 * t11377 - 0.3e1 * t11383 + 0.3e1 * t11387 - 0.3e1 * t11389 - t11396 + 0.3e1 * t11398 + 0.3e1 * t11400 + 0.3e1 * t11410 - t11419 - 0.12e2 * t11914 + 0.12e2 * t11916 - 0.12e2 * t11920 + 0.12e2 * t11924 - 0.4e1 * t11931 + 0.12e2 * t11935;
  t12401 = -0.4e1 * t11939 + 0.12e2 * t11943 + 0.12e2 * t11947 + 0.12e2 * t11949 - 0.8e1 * t11952 + 0.12e2 * t11957 - 0.3e1 * t11423 + 0.3e1 * t11427 - 0.3e1 * t11429 - 0.4e1 * t3209 + 0.4e1 * t3213 - 0.4e1 * t3217 + t11452 + t11455 - t11457 + 0.4e1 * t3232;
  t12403 = t2696 * t6786;
  t12405 = t6602 * t2693;
  t12418 = t2699 * t11471;
  t12425 = 0.11e2 * t10446 * t3647 * t6546 + 0.3e1 * t12317 * t3515 * t356 + 0.3e1 * t3024 * t371 * t8398 + 0.6e1 * t3024 * t3754 * t8270 + 0.6e1 * t6550 * t8409 + t6578 * t8421 - 0.2e1 * t11472 - t11479 - t11510 - 0.3e1 * t11537 - t11540 + t11543 - 0.3e1 * t12403 - t12405 - 0.2e1 * t12418 + 0.4e1 * t3240;
  t12429 = my_piecewise5(t58, 0, t61, 0, t12236 + t12274 + t12311 + t12336 + t12371 + t12386 + t12401 + t12425);
  t12435 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (0.5e1 / 0.27e2 * t38 * t48 * t3093 - 0.1e2 / 0.81e2 * t38 * t43 * t3250 + t53 * t12429));
  tv4sigma2lapl20 = t8 * t12435;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 1] += tv4sigma2lapl21;

  tv4sigma2lapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 2] += tv4sigma2lapl22;

  tv4sigma2lapl23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 3] += tv4sigma2lapl23;

  tv4sigma2lapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 4] += tv4sigma2lapl24;

  tv4sigma2lapl25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 5] += tv4sigma2lapl25;

  tv4sigma2lapl26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 6] += tv4sigma2lapl26;

  tv4sigma2lapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 7] += tv4sigma2lapl27;

  tv4sigma2lapl28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 8] += tv4sigma2lapl28;

  tv4sigma2lapl29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 9] += tv4sigma2lapl29;

  tv4sigma2lapl210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 10] += tv4sigma2lapl210;

  tv4sigma2lapl211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 11] += tv4sigma2lapl211;

  tv4sigma2lapl212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 12] += tv4sigma2lapl212;

  tv4sigma2lapl213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 13] += tv4sigma2lapl213;

  tv4sigma2lapl214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 14] += tv4sigma2lapl214;

  tv4sigma2lapl215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 15] += tv4sigma2lapl215;

  tv4sigma2lapl216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 16] += tv4sigma2lapl216;

  t12448 = t4509 * t5345 * t812;
  t12453 = t4509 * t3133;
  t12456 = t4566 * t9935;
  t12461 = -0.7e1 * t12448 * t8603 + 0.18e2 * t12448 * t8616 + 0.7e1 * t12453 * t8603 + 0.11e2 * t12456 * t8610 - 0.11e2 * t12456 * t8613 - 0.12e2 * t7013 * t8607 - t11132 + 0.12e2 * t11999 - 0.12e2 * t12001 - 0.12e2 * t12004 - t2968 + t3120 + t3122 + t3270 + t3271;
  t12469 = t2826 * t12164;
  t12474 = t540 * t812 * params->csk_a;
  t12475 = t4509 * t12474;
  t12478 = t2808 * t11618;
  t12481 = t4518 * t2802 * t1032;
  t12485 = t4522 * t1487 * t812;
  t12492 = t4566 * t3140;
  t12498 = t4566 * t5430 * t812;
  t12504 = -0.6e1 * t1390 * t815 * t8713 - 0.7e1 * t12448 * t8613 + 0.7e1 * t12475 * t8613 - 0.18e2 * t12475 * t8616 + 0.18e2 * t12481 * t7033 - 0.12e2 * t12485 * t8603 + 0.6e1 * t12492 * t8610 - 0.18e2 * t12492 * t8613 + t12498 * t8610 - 0.7e1 * t12498 * t8613 + 0.6e1 * t12498 * t8616 - 0.6e1 * t7033 * t8607 - 0.6e1 * t7033 * t8686 - 0.18e2 * t825 * t8652 + 0.3e1 * t12469 - 0.3e1 * t12478;
  t12511 = t2808 * t11589;
  t12512 = t2797 * t11630;
  t12514 = t2794 * t11630;
  t12516 = t2808 * t7035;
  t12518 = t2794 * t11589;
  t12519 = t2797 * t11589;
  t12521 = t2808 * t11625;
  t12529 = t2838 * t7173;
  t12531 = t2808 * t7136;
  t12533 = t2797 * t11618;
  t12539 = -0.12e2 * t1402 * t2826 * t3107 * t534 - 0.6e1 * t4526 * t4531 * t812 * t8603 - 0.6e1 * t12481 * t7013 + 0.12e2 * t12485 * t8616 - t12498 * t8603 + 0.11e2 * t7033 * t8670 - t12511 + 0.3e1 * t12512 - 0.3e1 * t12514 + 0.3e1 * t12516 - t12518 + 0.3e1 * t12519 - 0.2e1 * t12521 + 0.3e1 * t12529 + 0.3e1 * t12531 + 0.3e1 * t12533;
  t12544 = t918 * t812;
  t12557 = t9941 * t225 * t555;
  t12560 = -0.3e1 * t12474 * t563 * t8690 + 0.3e1 * t12544 * t217 * t5329 - 0.11e2 * t12453 * t8613 + 0.6e1 * t12492 * t8616 - 0.6e1 * t12557 * t8538 - 0.3e1 * t8690 * t9936 - 0.4e1 * t12056 - 0.8e1 * t12060 - 0.12e2 * t12066 + t3162 - t3163 - t3164 - t3272 + t3273 - t3274 - t821;
  t12563 = t9941 * t555;
  t12564 = t541 * t12563;
  t12583 = -0.12e2 * t12563 * t1487 * t8538 - 0.18e2 * t12564 * t8538 + 0.18e2 * t12564 * t8565 + 0.3e1 * t11572 + 0.3e1 * t11583 - t11590 + 0.3e1 * t11592 + 0.3e1 * t11605 + 0.3e1 * t11611 - 0.12e2 * t12112 + 0.12e2 * t12114 - 0.4e1 * t12120 + 0.12e2 * t12124 + 0.12e2 * t12126 - 0.4e1 * t12135;
  t12599 = t2794 * t1402 * t3116;
  t12601 = -t11613 + 0.3e1 * t11615 + 0.3e1 * t11619 - 0.3e1 * t11621 - 0.2e1 * t11626 - 0.3e1 * t11631 + 0.12e2 * t12165 + 0.12e2 * t12167 - 0.8e1 * t12170 + 0.12e2 * t12172 - 0.12e2 * t12174 + 0.12e2 * t12176 - 0.3e1 * t11637 - 0.3e1 * t11639 + 0.3e1 * t11643 - 0.2e1 * t12599;
  t12605 = t2797 * t7242;
  t12618 = t7061 * t2803;
  t12631 = t2844 * t9179 * t1469;
  t12635 = t2844 * t541 * t9179 * t221;
  t12637 = 0.3e1 * t12544 * t4350 * t531 + 0.6e1 * t3107 * t4566 * t8610 + 0.3e1 * t3107 * t546 * t8748 + 0.18e2 * t3170 * t541 * t8538 - 0.6e1 * t12557 * t8562 + 0.18e2 * t12557 * t8565 + 0.6e1 * t7013 * t8753 + 0.11e2 * t7022 * t8779 + t7033 * t8768 - 0.3e1 * t12605 - t12618 - 0.3e1 * t12631 - 0.3e1 * t12635 + 0.4e1 * t3278 - 0.4e1 * t3282 - 0.4e1 * t3285;
  t12641 = t2850 * t11642;
  t12644 = t225 * t815 * params->csk_a;
  t12653 = 0.18e2 * t1487 * t3170 * t8538 - 0.18e2 * t12644 * t8549 + 0.18e2 * t12644 * t8552 + t11664 + t11667 - t11669 - t11683 - 0.2e1 * t11726 - 0.3e1 * t11739 - t11744 - t11746 + t11749 + 0.3e1 * t12641 + 0.4e1 * t3306 + 0.4e1 * t3314 - t925;
  t12657 = my_piecewise5(t102, 0, t103, 0, t12461 + t12504 + t12539 + t12560 + t12583 + t12601 + t12637 + t12653);
  t12663 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * (0.5e1 / 0.27e2 * t38 * t96 * t3178 - 0.1e2 / 0.81e2 * t38 * t91 * t3322 + t101 * t12657));
  tv4sigma2lapl217 = t8 * t12663;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 17] += tv4sigma2lapl217;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2lapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 1] += tv4sigma2lapltau1;

  tv4sigma2lapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 2] += tv4sigma2lapltau2;

  tv4sigma2lapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 3] += tv4sigma2lapltau3;

  tv4sigma2lapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 4] += tv4sigma2lapltau4;

  tv4sigma2lapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 5] += tv4sigma2lapltau5;

  tv4sigma2lapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 6] += tv4sigma2lapltau6;

  tv4sigma2lapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 7] += tv4sigma2lapltau7;

  tv4sigma2lapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 8] += tv4sigma2lapltau8;

  tv4sigma2lapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 9] += tv4sigma2lapltau9;

  tv4sigma2lapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 10] += tv4sigma2lapltau10;

  tv4sigma2lapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 11] += tv4sigma2lapltau11;

  tv4sigma2lapltau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 12] += tv4sigma2lapltau12;

  tv4sigma2lapltau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 13] += tv4sigma2lapltau13;

  tv4sigma2lapltau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 14] += tv4sigma2lapltau14;

  tv4sigma2lapltau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 15] += tv4sigma2lapltau15;

  tv4sigma2lapltau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 16] += tv4sigma2lapltau16;

  tv4sigma2lapltau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 17] += tv4sigma2lapltau17;

  tv4sigma2lapltau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 18] += tv4sigma2lapltau18;

  tv4sigma2lapltau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 19] += tv4sigma2lapltau19;

  tv4sigma2lapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 20] += tv4sigma2lapltau20;

  tv4sigma2lapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 21] += tv4sigma2lapltau21;

  tv4sigma2lapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 22] += tv4sigma2lapltau22;

  tv4sigma2lapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 23] += tv4sigma2lapltau23;

  tv4sigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigma2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 1] += tv4sigma2tau21;

  tv4sigma2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 2] += tv4sigma2tau22;

  tv4sigma2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 3] += tv4sigma2tau23;

  tv4sigma2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 4] += tv4sigma2tau24;

  tv4sigma2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 5] += tv4sigma2tau25;

  tv4sigma2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 6] += tv4sigma2tau26;

  tv4sigma2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 7] += tv4sigma2tau27;

  tv4sigma2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 8] += tv4sigma2tau28;

  tv4sigma2tau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 9] += tv4sigma2tau29;

  tv4sigma2tau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 10] += tv4sigma2tau210;

  tv4sigma2tau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 11] += tv4sigma2tau211;

  tv4sigma2tau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 12] += tv4sigma2tau212;

  tv4sigma2tau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 13] += tv4sigma2tau213;

  tv4sigma2tau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 14] += tv4sigma2tau214;

  tv4sigma2tau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 15] += tv4sigma2tau215;

  tv4sigma2tau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 16] += tv4sigma2tau216;

  tv4sigma2tau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 17] += tv4sigma2tau217;

  t12670 = t3754 * t3219;
  t12677 = t4875 * t3226;
  t12682 = t4875 * t10257;
  t12686 = t3659 * t3710 * t245;
  t12695 = 0.6e1 * t10912 * t12670 + t10912 * t12677 - 0.18e2 * t10915 * t12670 - 0.7e1 * t10915 * t12682 - 0.11e2 * t10915 * t4980 - t10918 * t12677 - 0.6e1 * t10918 * t4814 + 0.6e1 * t10921 * t12677 + 0.18e2 * t10921 * t12682 + 0.12e2 * t10921 * t12686 - 0.12e2 * t10921 * t4814 - t11780 + t11784 - t11786;
  t12707 = t3754 * t843;
  t12712 = -0.12e2 * t1031 * t245 * t3354 * t9678 + 0.11e2 * t10912 * t12707 - 0.7e1 * t10915 * t12677 - 0.11e2 * t10915 * t12707 - 0.18e2 * t10921 * t4818 - 0.3e1 * t11014 * t854 + t2867 - t2890 + t2896 - 0.8e1 * t3035 + t3356 + t3360 + t3363 + t3365;
  t12718 = t3332 * t245;
  t12747 = -0.6e1 * t10918 * t245 * t3670 * t3684 - 0.6e1 * t1020 * t10994 * t598 + 0.3e1 * t12718 * t149 * t4848 + 0.7e1 * t10915 * t4818 - 0.7e1 * t10918 * t12682 - 0.12e2 * t10918 * t12686 + 0.6e1 * t10921 * t12670 - 0.6e1 * t10921 * t4995 + 0.11e2 * t10949 * t4907 - 0.6e1 * t10957 * t4907 + 0.7e1 * t10984 * t4907 - 0.18e2 * t11004 * t614 + 0.18e2 * t11010 * t4907 - 0.3e1 * t11014 * t844;
  t12760 = 0.9e1 * t12262 - 0.3e1 * t12268 + 0.9e1 * t12269 + 0.9e1 * t12271 - 0.3e1 * t12273 + 0.9e1 * t12276 + 0.9e1 * t12278 - 0.9e1 * t12280 - 0.9e1 * t12284 - 0.6e1 * t12290 + 0.9e1 * t12298 + 0.9e1 * t12302 - t3367 + t3368;
  t12763 = t2499 * t3549;
  t12768 = t2490 * t380;
  t12774 = t366 * t12768;
  t12781 = t157 * t12768;
  t12784 = -0.12e2 * t10868 * t1107 * t12768 - 0.18e2 * t10868 * t12774 + 0.18e2 * t10868 * t4767 + 0.18e2 * t10868 * t4770 + 0.18e2 * t10888 * t12774 - 0.6e1 * t11041 * t12781 - 0.18e2 * t11047 * t12763 + 0.18e2 * t11050 * t12763 - t2907 + t2917 - t2919 - t3369 - t794 - t902;
  t12792 = -0.6e1 * t10868 * t12781 + 0.18e2 * t10888 * t12781 - t11863 - t11865 - t11871 - t11915 + t11917 - t11921 + t11925 - t11932 + t11936 - 0.9e1 * t12346 + 0.9e1 * t12348 - 0.9e1 * t12351;
  t12807 = 0.6e1 * t10912 * t3754 * t849 + 0.3e1 * t12718 * t3515 * t356 + 0.3e1 * t11062 * t850 + 0.11e2 * t11067 * t4853 + 0.6e1 * t11072 * t4828 + t11077 * t4907 - t11940 + t11944 + t11948 + t11950 - t11953 + t11958 - t3209 + t3213;
  t12811 = -t3217 + t11452 + t11455 - t11457 - t3380 - t3382 + t3385 + t3232 + t3240 - 0.9e1 * t12403 - 0.3e1 * t12405 - 0.6e1 * t12418 - t11510 - t11540 + t11543;
  t12815 = my_piecewise5(t58, 0, t61, 0, t12695 + t12712 + t12747 + t12760 + t12784 + t12792 + t12807 + t12811);
  t12821 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (0.5e1 / 0.18e2 * t38 * t48 * t3250 - 0.5e1 / 0.81e2 * t38 * t43 * t3388 + t53 * t12815));
  tv4sigmalapl30 = t8 * t12821;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 1] += tv4sigmalapl31;

  tv4sigmalapl32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 2] += tv4sigmalapl32;

  tv4sigmalapl33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 3] += tv4sigmalapl33;

  tv4sigmalapl34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 4] += tv4sigmalapl34;

  tv4sigmalapl35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 5] += tv4sigmalapl35;

  tv4sigmalapl36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 6] += tv4sigmalapl36;

  tv4sigmalapl37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 7] += tv4sigmalapl37;

  tv4sigmalapl38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 8] += tv4sigmalapl38;

  tv4sigmalapl39 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 9] += tv4sigmalapl39;

  tv4sigmalapl310 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 10] += tv4sigmalapl310;

  t12828 = t4522 * t10588;
  t12831 = t4522 * t3296;
  t12833 = t4566 * t3289;
  t12844 = t4518 * t5339 * t262;
  t12853 = 0.18e2 * t11138 * t12828 + 0.6e1 * t11138 * t12831 + 0.6e1 * t11138 * t12833 + 0.12e2 * t11138 * t12844 - t11141 * t12831 - 0.6e1 * t11141 * t5360 - 0.7e1 * t11143 * t12828 - 0.7e1 * t11143 * t12831 - 0.18e2 * t11143 * t12833 + t11156 * t12831 + 0.6e1 * t11156 * t12833 + t12000 - t12002 - t12005;
  t12862 = t3398 * t262;
  t12866 = t9308 * t3296;
  t12888 = -0.12e2 * t1402 * t262 * t3417 * t4574 - 0.6e1 * t11188 * t1390 * t661 + 0.3e1 * t12862 * t217 * t5329 - 0.12e2 * t11138 * t5360 - 0.6e1 * t11138 * t5513 - 0.7e1 * t11141 * t12828 + 0.7e1 * t11141 * t5377 - 0.11e2 * t11143 * t12866 - 0.11e2 * t11143 * t5377 + 0.7e1 * t11143 * t5384 + 0.11e2 * t11156 * t12866 - 0.3e1 * t11235 * t872 - 0.3e1 * t11235 * t882 - 0.18e2 * t11256 * t5402;
  t12905 = -0.6e1 * t11141 * t262 * t4526 * t4531 - 0.12e2 * t11141 * t12844 + 0.18e2 * t11196 * t5370 + 0.11e2 * t11210 * t5370 - 0.6e1 * t11218 * t5370 - 0.18e2 * t11229 * t5338 + t2959 - t2967 + t2973 - 0.8e1 * t3115 + t3415 + t3419 + t3431 + t3432;
  t12918 = 0.9e1 * t12469 - 0.9e1 * t12478 - 0.3e1 * t12511 + 0.9e1 * t12512 - 0.9e1 * t12514 + 0.9e1 * t12516 - 0.3e1 * t12518 + 0.9e1 * t12519 - 0.6e1 * t12521 + 0.9e1 * t12529 + 0.9e1 * t12531 + 0.9e1 * t12533 - t12057 - t12061;
  t12927 = t2622 * t555;
  t12928 = t541 * t12927;
  t12933 = t225 * t12927;
  t12938 = -0.18e2 * t11270 * t225 * t262 * t9882 + 0.18e2 * t11266 * t5290 + 0.18e2 * t11266 * t5309 - 0.6e1 * t11273 * t12933 + 0.18e2 * t11278 * t12928 + 0.18e2 * t11278 * t12933 - t12067 + t2988 - t2990 - t2995 - t3433 + t3434 - t3435 - t821;
  t12948 = -0.12e2 * t11266 * t12927 * t1487 - 0.18e2 * t11266 * t12928 - 0.6e1 * t11266 * t12933 + 0.18e2 * t11278 * t3277 - t12113 + t12115 - t12121 + t12125 + t12127 - t12136 + t12166 + t12168 - t12171 + t12173;
  t12966 = 0.6e1 * t11156 * t4566 * t877 + 0.3e1 * t12862 * t4350 * t531 + 0.11e2 * t11143 * t5533 + t11307 * t5370 + 0.6e1 * t11311 * t5338 + 0.3e1 * t11320 * t878 - t12175 + t12177 - 0.6e1 * t12599 - 0.9e1 * t12605 - 0.3e1 * t12618 + t3278 - t3282 - t3285;
  t12970 = -0.9e1 * t12631 - 0.9e1 * t12635 + 0.9e1 * t12641 + t11664 + t11667 - t11669 + t3446 - t3449 - t3451 + t3306 + t3314 - t925 - t11744 - t11746 + t11749;
  t12974 = my_piecewise5(t102, 0, t103, 0, t12853 + t12888 + t12905 + t12918 + t12938 + t12948 + t12966 + t12970);
  t12980 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * (0.5e1 / 0.18e2 * t38 * t96 * t3322 - 0.5e1 / 0.81e2 * t38 * t91 * t3454 + t101 * t12974));
  tv4sigmalapl311 = t8 * t12980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 11] += tv4sigmalapl311;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapl2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 1] += tv4sigmalapl2tau1;

  tv4sigmalapl2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 2] += tv4sigmalapl2tau2;

  tv4sigmalapl2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 3] += tv4sigmalapl2tau3;

  tv4sigmalapl2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 4] += tv4sigmalapl2tau4;

  tv4sigmalapl2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 5] += tv4sigmalapl2tau5;

  tv4sigmalapl2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 6] += tv4sigmalapl2tau6;

  tv4sigmalapl2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 7] += tv4sigmalapl2tau7;

  tv4sigmalapl2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 8] += tv4sigmalapl2tau8;

  tv4sigmalapl2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 9] += tv4sigmalapl2tau9;

  tv4sigmalapl2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 10] += tv4sigmalapl2tau10;

  tv4sigmalapl2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 11] += tv4sigmalapl2tau11;

  tv4sigmalapl2tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 12] += tv4sigmalapl2tau12;

  tv4sigmalapl2tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 13] += tv4sigmalapl2tau13;

  tv4sigmalapl2tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 14] += tv4sigmalapl2tau14;

  tv4sigmalapl2tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 15] += tv4sigmalapl2tau15;

  tv4sigmalapl2tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 16] += tv4sigmalapl2tau16;

  tv4sigmalapl2tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 17] += tv4sigmalapl2tau17;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmalapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 1] += tv4sigmalapltau21;

  tv4sigmalapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 2] += tv4sigmalapltau22;

  tv4sigmalapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 3] += tv4sigmalapltau23;

  tv4sigmalapltau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 4] += tv4sigmalapltau24;

  tv4sigmalapltau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 5] += tv4sigmalapltau25;

  tv4sigmalapltau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 6] += tv4sigmalapltau26;

  tv4sigmalapltau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 7] += tv4sigmalapltau27;

  tv4sigmalapltau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 8] += tv4sigmalapltau28;

  tv4sigmalapltau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 9] += tv4sigmalapltau29;

  tv4sigmalapltau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 10] += tv4sigmalapltau210;

  tv4sigmalapltau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 11] += tv4sigmalapltau211;

  tv4sigmalapltau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 12] += tv4sigmalapltau212;

  tv4sigmalapltau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 13] += tv4sigmalapltau213;

  tv4sigmalapltau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 14] += tv4sigmalapltau214;

  tv4sigmalapltau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 15] += tv4sigmalapltau215;

  tv4sigmalapltau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 16] += tv4sigmalapltau216;

  tv4sigmalapltau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 17] += tv4sigmalapltau217;

  tv4sigmatau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 0] += tv4sigmatau30;

  tv4sigmatau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 1] += tv4sigmatau31;

  tv4sigmatau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 2] += tv4sigmatau32;

  tv4sigmatau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 3] += tv4sigmatau33;

  tv4sigmatau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 4] += tv4sigmatau34;

  tv4sigmatau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 5] += tv4sigmatau35;

  tv4sigmatau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 6] += tv4sigmatau36;

  tv4sigmatau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 7] += tv4sigmatau37;

  tv4sigmatau38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 8] += tv4sigmatau38;

  tv4sigmatau39 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 9] += tv4sigmatau39;

  tv4sigmatau310 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 10] += tv4sigmatau310;

  tv4sigmatau311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 11] += tv4sigmatau311;

  t12984 = t895 * t895;
  t12985 = t12984 * t380;
  t12986 = t149 * t12985;
  t12992 = t12984 * t359;
  t12993 = t1020 * t12992;
  t12999 = t356 * t12992;
  t13024 = 0.4e1 * t3355 + 0.4e1 * t3359 + 0.4e1 * t3030 + 0.4e1 * t3031 - 0.9e1 * t3035 + 0.18e2 * t12262 - 0.6e1 * t12268 + 0.18e2 * t12269 + 0.18e2 * t12271 - 0.6e1 * t12273 + 0.18e2 * t12276;
  t13039 = t12984 * t3519;
  t13040 = t3531 * t13039;
  t13043 = t1020 * t13039;
  t13047 = t149 * t13039;
  t13049 = t356 * t13039;
  t13056 = -0.6e1 * t13040 * t3746 - t13040 * t3756 - 0.18e2 * t13043 * t3648 + 0.6e1 * t13043 * t3756 + t13047 * t3756 + 0.6e1 * t13047 * t3768 - 0.7e1 * t13049 * t3756 - 0.18e2 * t12346 + 0.18e2 * t12348 - 0.18e2 * t12351 - t902;
  t13067 = t12984 * t3509;
  t13068 = t356 * t13067;
  t13106 = -0.12e2 * t1031 * t12986 * t9678 - 0.6e1 * t12993 * t3696 - 0.18e2 * t12999 * t3738 + 0.18e2 * t13040 * t3660 + 0.7e1 * t13040 * t3707 - 0.12e2 * t13040 * t3711 - 0.7e1 * t13040 * t3717 + 0.11e2 * t13047 * t3729 + 0.7e1 * t13049 * t3648 - 0.11e2 * t13049 * t3729 - 0.3e1 * t13068 * t390;
  t13114 = t149 * t12984;
  t13117 = t356 * t12984;
  t13136 = t11455 - t11457 - 0.4e1 * t3379 - 0.4e1 * t3381 + 0.4e1 * t3384 - 0.18e2 * t12403 - 0.6e1 * t12405 - 0.12e2 * t12418 - t11510 - t11540 + t11543;
  t13140 = my_piecewise5(t58, 0, t61, 0, t13056 - 0.18e2 * t12284 + 0.18e2 * t12278 - 0.18e2 * t12280 + t11452 + 0.18e2 * t12302 + 0.18e2 * t12298 + 0.12e2 * t13043 * t3711 - 0.7e1 * t13049 * t3717 - 0.3e1 * t13068 * t373 + 0.6e1 * t13043 * t3768 + 0.18e2 * t12999 * t3590 - 0.6e1 * t12993 * t3590 - 0.12e2 * t12993 * t3570 + 0.18e2 * t12993 * t3566 + 0.18e2 * t12999 * t3575 - 0.18e2 * t12993 * t3575 - 0.18e2 * t12986 * t3550 + 0.18e2 * t12993 * t3610 + 0.11e2 * t13117 * t3543 + 0.11e2 * t13040 * t3680 - 0.6e1 * t13040 * t3685 - 0.6e1 * t13040 * t3672 + 0.6e1 * t13114 * t3526 + 0.3e1 * t13117 * t3515 + 0.3e1 * t13114 * t3511 - 0.11e2 * t13049 * t3707 - 0.12e2 * t13043 * t3746 - 0.6e1 * t13043 * t3660 - 0.18e2 * t13049 * t3768 + 0.18e2 * t13043 * t3717 - 0.12e2 * t12290 + t13136 + t13106 - 0.6e1 * t149 * t12992 * t3590 + 0.3e1 * t149 * t13067 * t373 + t3531 * t12984 * t3537 + 0.6e1 * t1020 * t12984 * t3523 + 0.18e2 * t356 * t12985 * t3550 - 0.4e1 * t3064 + 0.4e1 * t3059 - 0.4e1 * t3053 + t13024 - t794);
  t13146 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (0.1e2 / 0.27e2 * t38 * t48 * t3388 + t53 * t13140));
  tv4lapl40 = t8 * t13146;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 0] += tv4lapl40;

  tv4lapl41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 1] += tv4lapl41;

  tv4lapl42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 2] += tv4lapl42;

  tv4lapl43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 3] += tv4lapl43;

  t13150 = t918 * t918;
  t13152 = t217 * t13150 * t555;
  t13155 = t13150 * t534;
  t13156 = t1390 * t13155;
  t13168 = t531 * t13155;
  t13189 = 0.4e1 * t3414 + 0.4e1 * t3418 - 0.9e1 * t3115 + 0.4e1 * t3118 + 0.4e1 * t3119 + 0.18e2 * t12469 - 0.18e2 * t12478 - 0.6e1 * t12511 + 0.18e2 * t12512 - 0.18e2 * t12514 + 0.18e2 * t12516;
  t13201 = t13150 * t4357;
  t13202 = t4382 * t13201;
  t13204 = t217 * t13201;
  t13206 = t531 * t13201;
  t13209 = t1390 * t13201;
  t13226 = -0.6e1 * t13202 * t4589 - t13202 * t4593 + t13204 * t4593 + 0.6e1 * t13204 * t4600 - 0.7e1 * t13206 * t4553 - 0.7e1 * t13206 * t4593 - 0.18e2 * t13206 * t4600 + 0.12e2 * t13209 * t4523 + 0.18e2 * t13209 * t4553 + 0.6e1 * t13209 * t4593 + 0.6e1 * t13209 * t4600;
  t13229 = t13150 * t4348;
  t13230 = t531 * t13229;
  t13274 = 0.3e1 * t13229 * t217 * t548 - 0.12e2 * t13152 * t4575 - 0.6e1 * t13156 * t4494 - 0.18e2 * t13168 * t4504 + 0.11e2 * t13202 * t4528 - 0.6e1 * t13202 * t4532 - 0.6e1 * t13202 * t4543 - 0.11e2 * t13206 * t4550 - 0.18e2 * t13209 * t4510 - 0.3e1 * t13230 * t548 - 0.12e2 * t12599;
  t13281 = t531 * t13150;
  t13289 = t217 * t13150;
  t13300 = 0.3e1 * t13281 * t4350 + t11664 + t11667 - t11669 - t11744 - t11746 + t11749 + 0.4e1 * t3445 - 0.4e1 * t3448 - 0.4e1 * t3450 - t925;
  t13304 = my_piecewise5(t102, 0, t103, 0, 0.4e1 * t3132 - 0.4e1 * t3125 - 0.18e2 * t12605 - 0.6e1 * t12618 - 0.18e2 * t12631 - 0.18e2 * t12635 + 0.18e2 * t12641 - 0.4e1 * t3159 + t13300 + t13274 + t13226 + t13189 - 0.6e1 * t217 * t13155 * t4447 + 0.6e1 * t1390 * t13150 * t4365 + t4382 * t13150 * t4388 + 0.11e2 * t13281 * t4377 + 0.3e1 * t13289 * t4354 + 0.6e1 * t13289 * t4361 - 0.6e1 * t13209 * t4519 - 0.12e2 * t13209 * t4589 + 0.7e1 * t13206 * t4510 + 0.11e2 * t13204 * t4567 + 0.7e1 * t13202 * t4550 - 0.7e1 * t13202 * t4553 + 0.18e2 * t13202 * t4519 - 0.3e1 * t13230 * t565 - 0.11e2 * t13206 * t4567 + 0.18e2 * t13168 * t4447 - 0.6e1 * t13156 * t4447 + 0.18e2 * t13168 * t4405 + 0.18e2 * t13168 * t4392 - 0.18e2 * t13152 * t5263 - 0.18e2 * t13156 * t4405 - 0.12e2 * t13156 * t4409 + 0.18e2 * t13156 * t4417 + 0.18e2 * t13156 * t4486 - 0.12e2 * t13202 * t4523 - 0.6e1 * t12518 + 0.18e2 * t12519 - 0.12e2 * t12521 - t821 + 0.18e2 * t12531 + 0.18e2 * t12533 + 0.18e2 * t12529);
  t13310 = my_piecewise3(t78, 0, 0.3e1 / 0.2e2 * t7 * t86 * (0.1e2 / 0.27e2 * t38 * t96 * t3454 + t101 * t13304));
  tv4lapl44 = t8 * t13310;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 4] += tv4lapl44;

  tv4lapl3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 1] += tv4lapl3tau1;

  tv4lapl3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 2] += tv4lapl3tau2;

  tv4lapl3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 3] += tv4lapl3tau3;

  tv4lapl3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 4] += tv4lapl3tau4;

  tv4lapl3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 5] += tv4lapl3tau5;

  tv4lapl3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 6] += tv4lapl3tau6;

  tv4lapl3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 7] += tv4lapl3tau7;

  tv4lapl2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapl2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 1] += tv4lapl2tau21;

  tv4lapl2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 2] += tv4lapl2tau22;

  tv4lapl2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 3] += tv4lapl2tau23;

  tv4lapl2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 4] += tv4lapl2tau24;

  tv4lapl2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 5] += tv4lapl2tau25;

  tv4lapl2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 6] += tv4lapl2tau26;

  tv4lapl2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 7] += tv4lapl2tau27;

  tv4lapl2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 8] += tv4lapl2tau28;

  tv4lapltau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 0] += tv4lapltau30;

  tv4lapltau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 1] += tv4lapltau31;

  tv4lapltau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 2] += tv4lapltau32;

  tv4lapltau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 3] += tv4lapltau33;

  tv4lapltau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 4] += tv4lapltau34;

  tv4lapltau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 5] += tv4lapltau35;

  tv4lapltau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 6] += tv4lapltau36;

  tv4lapltau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 7] += tv4lapltau37;

  tv4tau40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 0] += tv4tau40;

  tv4tau41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 1] += tv4tau41;

  tv4tau42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 2] += tv4tau42;

  tv4tau43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 3] += tv4tau43;

  tv4tau44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 4] += tv4tau44;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t30, t31, t32;
  double t33, t34, t36, t38, t40, t42, t47, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t67, t71, tzk0;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t30 = t25 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t38 = t30 * t33 * t36;
  t40 = lapl[0] * t32;
  t42 = 0.1e1 / t23 / rho[0];
  t47 = 0.5e1 / 0.54e2 * t30 * t40 * t42 - 0.5e1 / 0.81e2 * t38;
  t49 = log(0.1e1 - DBL_EPSILON);
  t50 = 0.1e1 / params->csk_a;
  t51 = pow(-t49, -t50);
  t52 = t47 < -t51;
  t53 = log(DBL_EPSILON);
  t54 = pow(-t53, -t50);
  t55 = -t54 < t47;
  t56 = my_piecewise3(t55, -t54, t47);
  t57 = -t51 < t56;
  t58 = my_piecewise3(t57, t56, -t51);
  t59 = fabs(t58);
  t60 = pow(t59, params->csk_a);
  t61 = 0.1e1 / t60;
  t62 = exp(-t61);
  t63 = 0.1e1 - t62;
  t64 = pow(t63, t50);
  t65 = my_piecewise5(t52, 0, t55, 1, t64);
  t67 = 0.1e1 + 0.5e1 / 0.72e2 * t38 + t47 * t65;
  t71 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t30, t31, t32;
  double t33, t34, t36, t38, t40, t42, t47, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t67, t71, tzk0;

  double t73, t77, t79, t81, t87, t89, t90, t91;
  double t93, t94, t96, t97, t98, t100, t102, t107;
  double tvrho0, t110, t111, t114, t117, t118, t121, t123;
  double t127, tvsigma0, t129, t135, t136, t139, t141, t145;
  double tvlapl0, tvtau0;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t30 = t25 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t38 = t30 * t33 * t36;
  t40 = lapl[0] * t32;
  t42 = 0.1e1 / t23 / rho[0];
  t47 = 0.5e1 / 0.54e2 * t30 * t40 * t42 - 0.5e1 / 0.81e2 * t38;
  t49 = log(0.1e1 - DBL_EPSILON);
  t50 = 0.1e1 / params->csk_a;
  t51 = pow(-t49, -t50);
  t52 = t47 < -t51;
  t53 = log(DBL_EPSILON);
  t54 = pow(-t53, -t50);
  t55 = -t54 < t47;
  t56 = my_piecewise3(t55, -t54, t47);
  t57 = -t51 < t56;
  t58 = my_piecewise3(t57, t56, -t51);
  t59 = fabs(t58);
  t60 = pow(t59, params->csk_a);
  t61 = 0.1e1 / t60;
  t62 = exp(-t61);
  t63 = 0.1e1 - t62;
  t64 = pow(t63, t50);
  t65 = my_piecewise5(t52, 0, t55, 1, t64);
  t67 = 0.1e1 + 0.5e1 / 0.72e2 * t38 + t47 * t65;
  t71 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t73 = t21 / t22;
  t77 = t34 * rho[0];
  t79 = 0.1e1 / t23 / t77;
  t81 = t30 * t33 * t79;
  t87 = -0.25e2 / 0.162e3 * t30 * t40 * t36 + 0.4e2 / 0.243e3 * t81;
  t89 = t64 * t61;
  t90 = my_piecewise3(t55, 0, t87);
  t91 = my_piecewise3(t57, t90, 0);
  t93 = fabs(t58) / t58;
  t94 = 0.1e1 / t59;
  t96 = 0.1e1 / t63;
  t97 = t62 * t96;
  t98 = t93 * t94 * t97;
  t100 = my_piecewise5(t52, 0, t55, 0, -t89 * t91 * t98);
  t102 = -0.5e1 / 0.27e2 * t81 + t87 * t65 + t47 * t100;
  t107 = my_piecewise3(t3, 0, t8 * t73 * t67 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t102);
  tvrho0 = 0.2e1 * rho[0] * t107 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t110 = t32 * t36;
  t111 = t30 * t110;
  t114 = t30 * t110 * t65;
  t117 = my_piecewise3(t55, 0, -0.5e1 / 0.81e2 * t111);
  t118 = my_piecewise3(t57, t117, 0);
  t121 = my_piecewise5(t52, 0, t55, 0, -t89 * t118 * t98);
  t123 = 0.5e1 / 0.72e2 * t111 - 0.5e1 / 0.81e2 * t114 + t47 * t121;
  t127 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t123);
  tvsigma0 = 0.2e1 * rho[0] * t127;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t129 = t32 * t42;
  t135 = my_piecewise3(t55, 0, 0.5e1 / 0.54e2 * t30 * t129);
  t136 = my_piecewise3(t57, t135, 0);
  t139 = my_piecewise5(t52, 0, t55, 0, -t89 * t136 * t98);
  t141 = 0.5e1 / 0.54e2 * t30 * t129 * t65 + t47 * t139;
  t145 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t141);
  tvlapl0 = 0.2e1 * rho[0] * t145;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t30, t31, t32;
  double t33, t34, t36, t38, t40, t42, t47, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t67, t71, tzk0;

  double t73, t77, t79, t81, t87, t89, t90, t91;
  double t93, t94, t96, t97, t98, t100, t102, t107;
  double tvrho0, t110, t111, t114, t117, t118, t121, t123;
  double t127, tvsigma0, t129, t135, t136, t139, t141, t145;
  double tvlapl0, tvtau0;

  double t150, t157, t159, t161, t167, t171, t173, t174;
  double t176, t177, t178, t179, t180, t181, t182, t183;
  double t184, t186, t188, t189, t190, t192, t193, t196;
  double t197, t199, t200, t201, t203, t205, t206, t207;
  double t210, t212, t217, tv2rho20, t223, t224, t227, t230;
  double t233, t234, t235, t236, t238, t239, t240, t241;
  double t244, t245, t248, t250, t251, t252, t254, t256;
  double t257, t260, t262, t267, tv2rhosigma0, t278, t279, t281;
  double t282, t285, t286, t289, t291, t293, t297, t299;
  double t304, tv2rholapl0, tv2rhotau0, t308, t310, t313, t316, t317;
  double t319, t320, t321, t323, t327, t329, t333, tv2sigma20;
  double t339, t343, t345, t346, t347, t348, t349, t352;
  double t353, t356, t358, t362, tv2sigmalapl0, tv2sigmatau0, t367, t370;
  double t373, t374, t376, t380, t382, t386, tv2lapl20, tv2lapltau0;
  double tv2tau20;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t30 = t25 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t38 = t30 * t33 * t36;
  t40 = lapl[0] * t32;
  t42 = 0.1e1 / t23 / rho[0];
  t47 = 0.5e1 / 0.54e2 * t30 * t40 * t42 - 0.5e1 / 0.81e2 * t38;
  t49 = log(0.1e1 - DBL_EPSILON);
  t50 = 0.1e1 / params->csk_a;
  t51 = pow(-t49, -t50);
  t52 = t47 < -t51;
  t53 = log(DBL_EPSILON);
  t54 = pow(-t53, -t50);
  t55 = -t54 < t47;
  t56 = my_piecewise3(t55, -t54, t47);
  t57 = -t51 < t56;
  t58 = my_piecewise3(t57, t56, -t51);
  t59 = fabs(t58);
  t60 = pow(t59, params->csk_a);
  t61 = 0.1e1 / t60;
  t62 = exp(-t61);
  t63 = 0.1e1 - t62;
  t64 = pow(t63, t50);
  t65 = my_piecewise5(t52, 0, t55, 1, t64);
  t67 = 0.1e1 + 0.5e1 / 0.72e2 * t38 + t47 * t65;
  t71 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t73 = t21 / t22;
  t77 = t34 * rho[0];
  t79 = 0.1e1 / t23 / t77;
  t81 = t30 * t33 * t79;
  t87 = -0.25e2 / 0.162e3 * t30 * t40 * t36 + 0.4e2 / 0.243e3 * t81;
  t89 = t64 * t61;
  t90 = my_piecewise3(t55, 0, t87);
  t91 = my_piecewise3(t57, t90, 0);
  t93 = fabs(t58) / t58;
  t94 = 0.1e1 / t59;
  t96 = 0.1e1 / t63;
  t97 = t62 * t96;
  t98 = t93 * t94 * t97;
  t100 = my_piecewise5(t52, 0, t55, 0, -t89 * t91 * t98);
  t102 = -0.5e1 / 0.27e2 * t81 + t87 * t65 + t47 * t100;
  t107 = my_piecewise3(t3, 0, t8 * t73 * t67 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t102);
  tvrho0 = 0.2e1 * rho[0] * t107 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t110 = t32 * t36;
  t111 = t30 * t110;
  t114 = t30 * t110 * t65;
  t117 = my_piecewise3(t55, 0, -0.5e1 / 0.81e2 * t111);
  t118 = my_piecewise3(t57, t117, 0);
  t121 = my_piecewise5(t52, 0, t55, 0, -t89 * t118 * t98);
  t123 = 0.5e1 / 0.72e2 * t111 - 0.5e1 / 0.81e2 * t114 + t47 * t121;
  t127 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t123);
  tvsigma0 = 0.2e1 * rho[0] * t127;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t129 = t32 * t42;
  t135 = my_piecewise3(t55, 0, 0.5e1 / 0.54e2 * t30 * t129);
  t136 = my_piecewise3(t57, t135, 0);
  t139 = my_piecewise5(t52, 0, t55, 0, -t89 * t136 * t98);
  t141 = 0.5e1 / 0.54e2 * t30 * t129 * t65 + t47 * t139;
  t145 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t141);
  tvlapl0 = 0.2e1 * rho[0] * t145;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t150 = t21 / t22 / rho[0];
  t157 = t34 * t34;
  t159 = 0.1e1 / t23 / t157;
  t161 = t30 * t33 * t159;
  t167 = 0.1e3 / 0.243e3 * t30 * t40 * t79 - 0.44e3 / 0.729e3 * t161;
  t171 = t60 * t60;
  t173 = t64 / t171;
  t174 = t91 * t91;
  t176 = t93 * t93;
  t177 = t59 * t59;
  t178 = 0.1e1 / t177;
  t179 = t176 * t178;
  t180 = t62 * t62;
  t181 = t63 * t63;
  t182 = 0.1e1 / t181;
  t183 = t180 * t182;
  t184 = t179 * t183;
  t186 = t174 * t176;
  t188 = t178 * t62;
  t189 = t96 * params->csk_a;
  t190 = t188 * t189;
  t192 = my_piecewise3(t55, 0, t167);
  t193 = my_piecewise3(t57, t192, 0);
  t196 = t89 * t174;
  t197 = 0.0;
  t199 = t197 * t94 * t97;
  t200 = t196 * t199;
  t201 = t179 * t97;
  t203 = t173 * t186;
  t205 = t178 * t180;
  t206 = t182 * params->csk_a;
  t207 = t205 * t206;
  t210 = my_piecewise5(t52, 0, t55, 0, t173 * t174 * t184 + t89 * t186 * t190 - t89 * t193 * t98 - t203 * t190 + t196 * t201 - t203 * t207 - t200);
  t212 = 0.55e2 / 0.81e2 * t161 + t167 * t65 + 0.2e1 * t87 * t100 + t47 * t210;
  t217 = my_piecewise3(t3, 0, -t8 * t150 * t67 / 0.3e2 + t8 * t73 * t102 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t107;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t32 * t79;
  t224 = t30 * t223;
  t227 = t30 * t223 * t65;
  t230 = t30 * t110 * t100;
  t233 = t91 * t176;
  t234 = t173 * t233;
  t235 = t182 * t118;
  t236 = t205 * t235;
  t238 = t118 * t176;
  t239 = t89 * t238;
  t240 = t189 * t91;
  t241 = t188 * t240;
  t244 = my_piecewise3(t55, 0, 0.4e2 / 0.243e3 * t224);
  t245 = my_piecewise3(t57, t244, 0);
  t248 = t118 * t91;
  t250 = t89 * t248 * t199;
  t251 = t96 * t91;
  t252 = t188 * t251;
  t254 = t173 * t238;
  t256 = t206 * t91;
  t257 = t205 * t256;
  t260 = my_piecewise5(t52, 0, t55, 0, -t89 * t245 * t98 + t234 * t236 + t239 * t241 + t239 * t252 - t254 * t241 - t254 * t257 - t250);
  t262 = -0.5e1 / 0.27e2 * t224 + 0.4e2 / 0.243e3 * t227 - 0.5e1 / 0.81e2 * t230 + t87 * t121 + t47 * t260;
  t267 = my_piecewise3(t3, 0, t8 * t73 * t123 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t262);
  tv2rhosigma0 = 0.2e1 * rho[0] * t267 + 0.2e1 * t127;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t278 = t182 * t136;
  t279 = t205 * t278;
  t281 = t136 * t176;
  t282 = t89 * t281;
  t285 = my_piecewise3(t55, 0, -0.25e2 / 0.162e3 * t111);
  t286 = my_piecewise3(t57, t285, 0);
  t289 = t136 * t91;
  t291 = t89 * t289 * t199;
  t293 = t173 * t281;
  t297 = my_piecewise5(t52, 0, t55, 0, -t89 * t286 * t98 + t234 * t279 + t282 * t241 - t293 * t241 + t282 * t252 - t293 * t257 - t291);
  t299 = -0.25e2 / 0.162e3 * t114 + 0.5e1 / 0.54e2 * t30 * t129 * t100 + t87 * t139 + t47 * t297;
  t304 = my_piecewise3(t3, 0, t8 * t73 * t141 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t299);
  tv2rholapl0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t308 = t30 * t110 * t121;
  t310 = t118 * t118;
  t313 = t310 * t176;
  t316 = my_piecewise3(t55, 0, 0);
  t317 = my_piecewise3(t57, t316, 0);
  t319 = t89 * t317 * t98;
  t320 = t89 * t310;
  t321 = t320 * t199;
  t323 = t173 * t313;
  t327 = my_piecewise5(t52, 0, t55, 0, t173 * t310 * t184 + t89 * t313 * t190 - t323 * t190 + t320 * t201 - t323 * t207 - t319 - t321);
  t329 = -0.1e2 / 0.81e2 * t308 + t47 * t327;
  t333 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t329);
  tv2sigma20 = 0.2e1 * rho[0] * t333;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t339 = t30 * t110 * t139;
  t343 = t188 * t189 * t118;
  t345 = t136 * t118;
  t346 = t89 * t345;
  t347 = t346 * t199;
  t348 = t96 * t118;
  t349 = t188 * t348;
  t352 = t206 * t118;
  t353 = t205 * t352;
  t356 = my_piecewise5(t52, 0, t55, 0, t254 * t279 + t282 * t343 + t282 * t349 - t293 * t343 - t293 * t353 - t319 - t347);
  t358 = 0.5e1 / 0.54e2 * t30 * t129 * t121 - 0.5e1 / 0.81e2 * t339 + t47 * t356;
  t362 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t358);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t362;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  t367 = t136 * t136;
  t370 = t367 * t176;
  t373 = t89 * t367;
  t374 = t373 * t199;
  t376 = t173 * t370;
  t380 = my_piecewise5(t52, 0, t55, 0, t173 * t367 * t184 + t89 * t370 * t190 - t376 * t190 + t373 * t201 - t376 * t207 - t319 - t374);
  t382 = 0.5e1 / 0.27e2 * t30 * t129 * t139 + t47 * t380;
  t386 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t382);
  tv2lapl20 = 0.2e1 * rho[0] * t386;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t30, t31, t32;
  double t33, t34, t36, t38, t40, t42, t47, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t67, t71, tzk0;

  double t73, t77, t79, t81, t87, t89, t90, t91;
  double t93, t94, t96, t97, t98, t100, t102, t107;
  double tvrho0, t110, t111, t114, t117, t118, t121, t123;
  double t127, tvsigma0, t129, t135, t136, t139, t141, t145;
  double tvlapl0, tvtau0;

  double t150, t157, t159, t161, t167, t171, t173, t174;
  double t176, t177, t178, t179, t180, t181, t182, t183;
  double t184, t186, t188, t189, t190, t192, t193, t196;
  double t197, t199, t200, t201, t203, t205, t206, t207;
  double t210, t212, t217, tv2rho20, t223, t224, t227, t230;
  double t233, t234, t235, t236, t238, t239, t240, t241;
  double t244, t245, t248, t250, t251, t252, t254, t256;
  double t257, t260, t262, t267, tv2rhosigma0, t278, t279, t281;
  double t282, t285, t286, t289, t291, t293, t297, t299;
  double t304, tv2rholapl0, tv2rhotau0, t308, t310, t313, t316, t317;
  double t319, t320, t321, t323, t327, t329, t333, tv2sigma20;
  double t339, t343, t345, t346, t347, t348, t349, t352;
  double t353, t356, t358, t362, tv2sigmalapl0, tv2sigmatau0, t367, t370;
  double t373, t374, t376, t380, t382, t386, tv2lapl20, tv2lapltau0;
  double tv2tau20;

  double t391, t403, t405, t411, t417, t423, t424, t425;
  double t426, t427, t429, t430, t431, t433, t434, t435;
  double t438, t439, t440, t441, t442, t445, t447, t451;
  double t452, t455, t456, t459, t462, t464, t465, t466;
  double t468, t472, t474, t475, t476, t478, t481, t482;
  double t483, t485, t490, t491, t492, t494, t495, t499;
  double t503, t506, t509, t510, t512, t513, t514, t517;
  double t518, t519, t522, t523, t529, t530, t532, t534;
  double t536, t541, tv3rho30, t551, t552, t555, t558, t561;
  double t566, t567, t568, t571, t572, t573, t574, t577;
  double t578, t582, t583, t586, t587, t590, t592, t596;
  double t597, t598, t601, t602, t605, t606, t607, t608;
  double t610, t611, t612, t613, t614, t615, t616, t618;
  double t620, t623, t624, t626, t627, t630, t632, t635;
  double t636, t637, t638, t639, t643, t644, t647, t649;
  double t650, t653, t654, t656, t657, t667, t668, t671;
  double t672, t677, t679, t681, t686, tv3rho2sigma0, t704, t706;
  double t709, t710, t713, t714, t716, t719, t720, t723;
  double t724, t730, t732, t733, t736, t738, t739, t743;
  double t748, t749, t752, t754, t756, t757, t758, t766;
  double t767, t779, t780, t781, t784, t785, t786, t788;
  double t790, t792, t794, t799, tv3rho2lapl0, tv3rho2tau0, t806, t809;
  double t812, t813, t814, t815, t817, t818, t819, t820;
  double t821, t823, t824, t825, t830, t831, t832, t833;
  double t835, t836, t837, t838, t839, t840, t843, t844;
  double t845, t848, t850, t851, t852, t853, t855, t857;
  double t858, t859, t860, t862, t863, t864, t866, t868;
  double t869, t871, t872, t875, t876, t877, t878, t881;
  double t882, t885, t886, t887, t888, t890, t891, t896;
  double t899, t900, t905, t906, t907, t909, t910, t915;
  double t916, t921, t922, t924, t926, t931, tv3rhosigma20, t942;
  double t945, t952, t954, t955, t957, t958, t959, t960;
  double t961, t962, t965, t966, t968, t969, t971, t973;
  double t974, t975, t976, t977, t979, t982, t983, t986;
  double t987, t990, t993, t994, t995, t996, t997, t999;
  double t1000, t1001, t1002, t1003, t1008, t1009, t1014, t1017;
  double t1018, t1021, t1022, t1029, t1030, t1034, t1036, t1038;
  double t1043, tv3rhosigmalapl0, tv3rhosigmatau0, t1056, t1057, t1059, t1060, t1061;
  double t1063, t1064, t1068, t1069, t1072, t1075, t1077, t1078;
  double t1080, t1082, t1083, t1085, t1087, t1088, t1090, t1091;
  double t1094, t1095, t1098, t1114, t1115, t1123, t1125, t1127;
  double t1132, tv3rholapl20, tv3rholapltau0, tv3rhotau20, t1136, t1138, t1139, t1141;
  double t1142, t1143, t1144, t1145, t1146, t1147, t1148, t1149;
  double t1150, t1155, t1156, t1159, t1162, t1164, t1165, t1168;
  double t1173, t1186, t1187, t1188, t1189, t1190, t1191, t1192;
  double t1193, t1194, t1195, t1196, t1197, t1198, t1200, t1201;
  double t1202, t1204, t1206, t1210, tv3sigma30, t1216, t1218, t1220;
  double t1222, t1223, t1224, t1225, t1228, t1229, t1232, t1233;
  double t1234, t1235, t1236, t1237, t1238, t1239, t1240, t1241;
  double t1242, t1243, t1244, t1245, t1246, t1247, t1248, t1253;
  double t1254, t1255, t1262, t1265, t1266, t1267, t1268, t1269;
  double t1274, t1279, t1280, t1281, t1282, t1283, t1284, t1285;
  double t1286, t1287, t1288, t1290, t1292, t1296, tv3sigma2lapl0, tv3sigma2tau0;
  double t1302, t1304, t1305, t1306, t1313, t1314, t1315, t1316;
  double t1317, t1318, t1320, t1321, t1323, t1324, t1327, t1328;
  double t1330, t1334, t1339, t1343, t1344, t1348, t1349, t1350;
  double t1353, t1354, t1357, t1358, t1359, t1360, t1362, t1364;
  double t1368, tv3sigmalapl20, tv3sigmalapltau0, tv3sigmatau20, t1373, t1374, t1375, t1378;
  double t1385, t1388, t1390, t1391, t1392, t1393, t1394, t1403;
  double t1404, t1405, t1406, t1407, t1409, t1410, t1411, t1412;
  double t1413, t1414, t1415, t1416, t1417, t1418, t1427, t1429;
  double t1431, t1435, tv3lapl30, tv3lapl2tau0, tv3lapltau20, tv3tau30;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t30 = t25 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t38 = t30 * t33 * t36;
  t40 = lapl[0] * t32;
  t42 = 0.1e1 / t23 / rho[0];
  t47 = 0.5e1 / 0.54e2 * t30 * t40 * t42 - 0.5e1 / 0.81e2 * t38;
  t49 = log(0.1e1 - DBL_EPSILON);
  t50 = 0.1e1 / params->csk_a;
  t51 = pow(-t49, -t50);
  t52 = t47 < -t51;
  t53 = log(DBL_EPSILON);
  t54 = pow(-t53, -t50);
  t55 = -t54 < t47;
  t56 = my_piecewise3(t55, -t54, t47);
  t57 = -t51 < t56;
  t58 = my_piecewise3(t57, t56, -t51);
  t59 = fabs(t58);
  t60 = pow(t59, params->csk_a);
  t61 = 0.1e1 / t60;
  t62 = exp(-t61);
  t63 = 0.1e1 - t62;
  t64 = pow(t63, t50);
  t65 = my_piecewise5(t52, 0, t55, 1, t64);
  t67 = 0.1e1 + 0.5e1 / 0.72e2 * t38 + t47 * t65;
  t71 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t73 = t21 / t22;
  t77 = t34 * rho[0];
  t79 = 0.1e1 / t23 / t77;
  t81 = t30 * t33 * t79;
  t87 = -0.25e2 / 0.162e3 * t30 * t40 * t36 + 0.4e2 / 0.243e3 * t81;
  t89 = t64 * t61;
  t90 = my_piecewise3(t55, 0, t87);
  t91 = my_piecewise3(t57, t90, 0);
  t93 = fabs(t58) / t58;
  t94 = 0.1e1 / t59;
  t96 = 0.1e1 / t63;
  t97 = t62 * t96;
  t98 = t93 * t94 * t97;
  t100 = my_piecewise5(t52, 0, t55, 0, -t89 * t91 * t98);
  t102 = -0.5e1 / 0.27e2 * t81 + t87 * t65 + t47 * t100;
  t107 = my_piecewise3(t3, 0, t8 * t73 * t67 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t102);
  tvrho0 = 0.2e1 * rho[0] * t107 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t110 = t32 * t36;
  t111 = t30 * t110;
  t114 = t30 * t110 * t65;
  t117 = my_piecewise3(t55, 0, -0.5e1 / 0.81e2 * t111);
  t118 = my_piecewise3(t57, t117, 0);
  t121 = my_piecewise5(t52, 0, t55, 0, -t89 * t118 * t98);
  t123 = 0.5e1 / 0.72e2 * t111 - 0.5e1 / 0.81e2 * t114 + t47 * t121;
  t127 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t123);
  tvsigma0 = 0.2e1 * rho[0] * t127;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t129 = t32 * t42;
  t135 = my_piecewise3(t55, 0, 0.5e1 / 0.54e2 * t30 * t129);
  t136 = my_piecewise3(t57, t135, 0);
  t139 = my_piecewise5(t52, 0, t55, 0, -t89 * t136 * t98);
  t141 = 0.5e1 / 0.54e2 * t30 * t129 * t65 + t47 * t139;
  t145 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t141);
  tvlapl0 = 0.2e1 * rho[0] * t145;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t150 = t21 / t22 / rho[0];
  t157 = t34 * t34;
  t159 = 0.1e1 / t23 / t157;
  t161 = t30 * t33 * t159;
  t167 = 0.1e3 / 0.243e3 * t30 * t40 * t79 - 0.44e3 / 0.729e3 * t161;
  t171 = t60 * t60;
  t173 = t64 / t171;
  t174 = t91 * t91;
  t176 = t93 * t93;
  t177 = t59 * t59;
  t178 = 0.1e1 / t177;
  t179 = t176 * t178;
  t180 = t62 * t62;
  t181 = t63 * t63;
  t182 = 0.1e1 / t181;
  t183 = t180 * t182;
  t184 = t179 * t183;
  t186 = t174 * t176;
  t188 = t178 * t62;
  t189 = t96 * params->csk_a;
  t190 = t188 * t189;
  t192 = my_piecewise3(t55, 0, t167);
  t193 = my_piecewise3(t57, t192, 0);
  t196 = t89 * t174;
  t197 = 0.0;
  t199 = t197 * t94 * t97;
  t200 = t196 * t199;
  t201 = t179 * t97;
  t203 = t173 * t186;
  t205 = t178 * t180;
  t206 = t182 * params->csk_a;
  t207 = t205 * t206;
  t210 = my_piecewise5(t52, 0, t55, 0, t173 * t174 * t184 + t89 * t186 * t190 - t89 * t193 * t98 - t203 * t190 + t196 * t201 - t203 * t207 - t200);
  t212 = 0.55e2 / 0.81e2 * t161 + t167 * t65 + 0.2e1 * t87 * t100 + t47 * t210;
  t217 = my_piecewise3(t3, 0, -t8 * t150 * t67 / 0.3e2 + t8 * t73 * t102 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t107;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t32 * t79;
  t224 = t30 * t223;
  t227 = t30 * t223 * t65;
  t230 = t30 * t110 * t100;
  t233 = t91 * t176;
  t234 = t173 * t233;
  t235 = t182 * t118;
  t236 = t205 * t235;
  t238 = t118 * t176;
  t239 = t89 * t238;
  t240 = t189 * t91;
  t241 = t188 * t240;
  t244 = my_piecewise3(t55, 0, 0.4e2 / 0.243e3 * t224);
  t245 = my_piecewise3(t57, t244, 0);
  t248 = t118 * t91;
  t250 = t89 * t248 * t199;
  t251 = t96 * t91;
  t252 = t188 * t251;
  t254 = t173 * t238;
  t256 = t206 * t91;
  t257 = t205 * t256;
  t260 = my_piecewise5(t52, 0, t55, 0, -t89 * t245 * t98 + t234 * t236 + t239 * t241 + t239 * t252 - t254 * t241 - t254 * t257 - t250);
  t262 = -0.5e1 / 0.27e2 * t224 + 0.4e2 / 0.243e3 * t227 - 0.5e1 / 0.81e2 * t230 + t87 * t121 + t47 * t260;
  t267 = my_piecewise3(t3, 0, t8 * t73 * t123 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t262);
  tv2rhosigma0 = 0.2e1 * rho[0] * t267 + 0.2e1 * t127;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t278 = t182 * t136;
  t279 = t205 * t278;
  t281 = t136 * t176;
  t282 = t89 * t281;
  t285 = my_piecewise3(t55, 0, -0.25e2 / 0.162e3 * t111);
  t286 = my_piecewise3(t57, t285, 0);
  t289 = t136 * t91;
  t291 = t89 * t289 * t199;
  t293 = t173 * t281;
  t297 = my_piecewise5(t52, 0, t55, 0, -t89 * t286 * t98 + t234 * t279 + t282 * t241 - t293 * t241 + t282 * t252 - t293 * t257 - t291);
  t299 = -0.25e2 / 0.162e3 * t114 + 0.5e1 / 0.54e2 * t30 * t129 * t100 + t87 * t139 + t47 * t297;
  t304 = my_piecewise3(t3, 0, t8 * t73 * t141 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t299);
  tv2rholapl0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t308 = t30 * t110 * t121;
  t310 = t118 * t118;
  t313 = t310 * t176;
  t316 = my_piecewise3(t55, 0, 0);
  t317 = my_piecewise3(t57, t316, 0);
  t319 = t89 * t317 * t98;
  t320 = t89 * t310;
  t321 = t320 * t199;
  t323 = t173 * t313;
  t327 = my_piecewise5(t52, 0, t55, 0, t173 * t310 * t184 + t89 * t313 * t190 - t323 * t190 + t320 * t201 - t323 * t207 - t319 - t321);
  t329 = -0.1e2 / 0.81e2 * t308 + t47 * t327;
  t333 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t329);
  tv2sigma20 = 0.2e1 * rho[0] * t333;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t339 = t30 * t110 * t139;
  t343 = t188 * t189 * t118;
  t345 = t136 * t118;
  t346 = t89 * t345;
  t347 = t346 * t199;
  t348 = t96 * t118;
  t349 = t188 * t348;
  t352 = t206 * t118;
  t353 = t205 * t352;
  t356 = my_piecewise5(t52, 0, t55, 0, t254 * t279 + t282 * t343 + t282 * t349 - t293 * t343 - t293 * t353 - t319 - t347);
  t358 = 0.5e1 / 0.54e2 * t30 * t129 * t121 - 0.5e1 / 0.81e2 * t339 + t47 * t356;
  t362 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t358);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t362;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  t367 = t136 * t136;
  t370 = t367 * t176;
  t373 = t89 * t367;
  t374 = t373 * t199;
  t376 = t173 * t370;
  t380 = my_piecewise5(t52, 0, t55, 0, t173 * t367 * t184 + t89 * t370 * t190 - t376 * t190 + t373 * t201 - t376 * t207 - t319 - t374);
  t382 = 0.5e1 / 0.27e2 * t30 * t129 * t139 + t47 * t380;
  t386 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t382);
  tv2lapl20 = 0.2e1 * rho[0] * t386;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  t391 = t21 / t22 / t34;
  t403 = 0.1e1 / t23 / t157 / rho[0];
  t405 = t30 * t33 * t403;
  t411 = -0.11e4 / 0.729e3 * t30 * t40 * t159 + 0.616e4 / 0.2187e4 * t405;
  t417 = t182 * t193;
  t423 = t64 / t171 / t60;
  t424 = t174 * t91;
  t425 = t176 * t93;
  t426 = t424 * t425;
  t427 = t423 * t426;
  t429 = 0.1e1 / t177 / t59;
  t430 = t180 * t62;
  t431 = t429 * t430;
  t433 = 0.1e1 / t181 / t63;
  t434 = t433 * params->csk_a;
  t435 = t431 * t434;
  t438 = t173 * t426;
  t439 = t429 * t180;
  t440 = params->csk_a * params->csk_a;
  t441 = t182 * t440;
  t442 = t439 * t441;
  t445 = t193 * t91;
  t447 = t89 * t445 * t199;
  t451 = t433 * t440;
  t452 = t431 * t451;
  t455 = t429 * params->csk_a;
  t456 = t455 * t97;
  t459 = t89 * t426;
  t462 = t424 * t93;
  t464 = t182 * t197;
  t465 = t205 * t464;
  t466 = t173 * t462 * t465;
  t468 = t193 * t176;
  t472 = t424 * t197;
  t474 = t96 * t93;
  t475 = t188 * t474;
  t476 = t89 * t472 * t475;
  t478 = t439 * t206;
  t481 = t429 * t62;
  t482 = t96 * t440;
  t483 = t481 * t482;
  t485 = 0.3e1 * t234 * t205 * t417 + 0.3e1 * t89 * t468 * t252 + 0.3e1 * t427 * t435 - 0.3e1 * t427 * t442 - 0.2e1 * t427 * t452 + 0.3e1 * t427 * t478 + 0.3e1 * t438 * t442 + 0.3e1 * t438 * t456 - 0.3e1 * t459 * t456 - t459 * t483 - 0.3e1 * t447 + 0.3e1 * t466 + 0.3e1 * t476;
  t490 = t425 * t429;
  t491 = t430 * t433;
  t492 = t490 * t491;
  t494 = my_piecewise3(t55, 0, t411);
  t495 = my_piecewise3(t57, t494, 0);
  t499 = t490 * t183;
  t503 = t490 * t97;
  t506 = t173 * t468;
  t509 = t173 * t472;
  t510 = t178 * params->csk_a;
  t512 = t93 * t62 * t96;
  t513 = t510 * t512;
  t514 = t509 * t513;
  t517 = t189 * t197;
  t518 = t188 * t517;
  t519 = t89 * t462 * t518;
  t522 = t189 * t193;
  t523 = t188 * t522;
  t529 = t205 * t206 * t93;
  t530 = t509 * t529;
  t532 = -0.3e1 * t173 * t424 * t499 + 0.3e1 * t89 * t233 * t523 - t423 * t424 * t492 - 0.2e1 * t89 * t424 * t503 - t89 * t495 * t98 - 0.3e1 * t506 * t241 - 0.3e1 * t506 * t257 - t427 * t483 + 0.3e1 * t438 * t483 - t200 - 0.3e1 * t514 + 0.3e1 * t519 - 0.3e1 * t530;
  t534 = my_piecewise5(t52, 0, t55, 0, t485 + t532);
  t536 = -0.77e3 / 0.243e3 * t405 + t411 * t65 + 0.3e1 * t167 * t100 + 0.3e1 * t87 * t210 + t47 * t534;
  t541 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t391 * t67 - t8 * t150 * t102 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t73 * t212 + 0.3e1 / 0.2e2 * t8 * t24 * t536);
  tv3rho30 = 0.2e1 * rho[0] * t541 + 0.6e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t551 = t32 * t159;
  t552 = t30 * t551;
  t555 = t30 * t551 * t65;
  t558 = t30 * t223 * t100;
  t561 = t30 * t110 * t210;
  t566 = t174 * t425;
  t567 = t173 * t566;
  t568 = t439 * t235;
  t571 = t118 * t425;
  t572 = t89 * t571;
  t573 = t96 * t174;
  t574 = t481 * t573;
  t577 = t245 * t176;
  t578 = t89 * t577;
  t582 = t182 * t245;
  t583 = t205 * t582;
  t586 = t423 * t566;
  t587 = t433 * t118;
  t590 = t245 * t91;
  t592 = t89 * t590 * t199;
  t596 = t89 * t118 * t193 * t199;
  t597 = t96 * t193;
  t598 = t188 * t597;
  t601 = my_piecewise3(t55, 0, -0.44e3 / 0.729e3 * t552);
  t602 = my_piecewise3(t57, t601, 0);
  t605 = t118 * t174;
  t606 = t605 * t197;
  t607 = t173 * t606;
  t608 = t607 * t529;
  t610 = t118 * t93;
  t611 = t610 * t178;
  t612 = t89 * t611;
  t613 = params->csk_a * t174;
  t614 = t613 * t197;
  t615 = t97 * t614;
  t616 = t612 * t615;
  t618 = t607 * t513;
  t620 = t439 * t352;
  t623 = t482 * t174;
  t624 = t481 * t623;
  t626 = -t586 * t431 * t587 - t89 * t602 * t98 + 0.2e1 * t234 * t583 + t506 * t236 + t239 * t598 + 0.2e1 * t578 * t252 - 0.3e1 * t567 * t568 - 0.2e1 * t572 * t574 - t572 * t624 + 0.3e1 * t586 * t620 - t250 - 0.2e1 * t592 - t596 - 0.3e1 * t608 + 0.3e1 * t616 - 0.3e1 * t618;
  t627 = t173 * t571;
  t630 = t423 * t571;
  t632 = t173 * t577;
  t635 = t174 * t93;
  t636 = t173 * t635;
  t637 = t235 * t197;
  t638 = t205 * t637;
  t639 = t636 * t638;
  t643 = t197 * t178 * t512;
  t644 = t89 * t605 * t643;
  t647 = t429 * t440;
  t649 = t174 * t180 * t182;
  t650 = t647 * t649;
  t653 = t206 * t193;
  t654 = t205 * t653;
  t656 = t451 * t174;
  t657 = t431 * t656;
  t667 = t587 * params->csk_a;
  t668 = t431 * t667;
  t671 = t189 * t174;
  t672 = t481 * t671;
  t677 = t239 * t523 + 0.2e1 * t578 * t241 - 0.2e1 * t632 * t241 - t254 * t523 - t254 * t654 - 0.2e1 * t632 * t257 - 0.3e1 * t572 * t672 + 0.3e1 * t586 * t668 + 0.3e1 * t627 * t624 - t630 * t624 + 0.3e1 * t627 * t650 + 0.3e1 * t627 * t672 - 0.3e1 * t630 * t650 - 0.2e1 * t630 * t657 + 0.3e1 * t639 + 0.3e1 * t644;
  t679 = my_piecewise5(t52, 0, t55, 0, t626 + t677);
  t681 = 0.55e2 / 0.81e2 * t552 - 0.44e3 / 0.729e3 * t555 + 0.8e2 / 0.243e3 * t558 - 0.5e1 / 0.81e2 * t561 + t167 * t121 + 0.2e1 * t87 * t260 + t47 * t679;
  t686 = my_piecewise3(t3, 0, -t8 * t150 * t123 / 0.3e2 + t8 * t73 * t262 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t681);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t686 + 0.4e1 * t267;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t704 = t286 * t91;
  t706 = t89 * t704 * t199;
  t709 = t182 * t286;
  t710 = t205 * t709;
  t713 = t433 * t136;
  t714 = t431 * t713;
  t716 = t439 * t278;
  t719 = t136 * t425;
  t720 = t89 * t719;
  t723 = t286 * t176;
  t724 = t89 * t723;
  t730 = t89 * t136 * t193 * t199;
  t732 = my_piecewise3(t55, 0, 0.1e3 / 0.243e3 * t224);
  t733 = my_piecewise3(t57, t732, 0);
  t736 = t423 * t719;
  t738 = t278 * params->csk_a;
  t739 = t439 * t738;
  t743 = t173 * t719;
  t748 = -t89 * t733 * t98 + 0.2e1 * t234 * t710 + 0.2e1 * t724 * t252 + t506 * t279 + t282 * t598 - 0.3e1 * t567 * t716 - 0.2e1 * t720 * t574 - t586 * t714 + 0.3e1 * t586 * t739 - t720 * t624 - t736 * t624 + 0.3e1 * t743 * t624 + 0.3e1 * t743 * t672 - t291 - 0.2e1 * t706 - t730;
  t749 = t173 * t723;
  t752 = t136 * t174;
  t754 = t89 * t752 * t643;
  t756 = t278 * t197;
  t757 = t205 * t756;
  t758 = t636 * t757;
  t766 = t713 * params->csk_a;
  t767 = t431 * t766;
  t779 = t752 * t197;
  t780 = t173 * t779;
  t781 = t780 * t529;
  t784 = t136 * t93 * t178;
  t785 = t89 * t784;
  t786 = t785 * t615;
  t788 = t780 * t513;
  t790 = 0.2e1 * t724 * t241 - 0.2e1 * t749 * t241 - 0.2e1 * t749 * t257 + t282 * t523 - t293 * t523 - t293 * t654 + 0.3e1 * t586 * t767 - 0.3e1 * t736 * t650 + 0.3e1 * t743 * t650 - 0.2e1 * t736 * t657 - 0.3e1 * t720 * t672 + 0.3e1 * t754 + 0.3e1 * t758 - 0.3e1 * t781 + 0.3e1 * t786 - 0.3e1 * t788;
  t792 = my_piecewise5(t52, 0, t55, 0, t748 + t790);
  t794 = 0.1e3 / 0.243e3 * t227 - 0.25e2 / 0.81e2 * t230 + 0.5e1 / 0.54e2 * t30 * t129 * t210 + t167 * t139 + 0.2e1 * t87 * t297 + t47 * t792;
  t799 = my_piecewise3(t3, 0, -t8 * t150 * t141 / 0.3e2 + t8 * t73 * t299 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t794);
  tv3rho2lapl0 = 0.2e1 * rho[0] * t799 + 0.4e1 * t304;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t806 = t30 * t223 * t121;
  t809 = t30 * t110 * t260;
  t812 = t182 * t317;
  t813 = t205 * t812;
  t814 = t234 * t813;
  t815 = t317 * t91;
  t817 = t89 * t815 * t199;
  t818 = t118 * t197;
  t819 = t89 * t818;
  t820 = t94 * t62;
  t821 = t96 * t245;
  t823 = t819 * t820 * t821;
  t824 = 0.2e1 * t823;
  t825 = t188 * t821;
  t830 = t91 * t425;
  t831 = t423 * t830;
  t832 = t433 * t310;
  t833 = t431 * t832;
  t835 = t317 * t176;
  t836 = t89 * t835;
  t837 = t836 * t252;
  t838 = t310 * t425;
  t839 = t89 * t838;
  t840 = t481 * t251;
  t843 = t173 * t838;
  t844 = t182 * t91;
  t845 = t439 * t844;
  t848 = t310 * t197;
  t850 = t173 * t848 * t178;
  t851 = params->csk_a * t91;
  t852 = t851 * t512;
  t853 = t850 * t852;
  t855 = t310 * t93;
  t857 = t89 * t855 * t178;
  t858 = t851 * t197;
  t859 = t97 * t858;
  t860 = t857 * t859;
  t862 = t851 * t93;
  t863 = t183 * t862;
  t864 = t850 * t863;
  t866 = t89 * t848;
  t868 = t188 * t251 * t93;
  t869 = t866 * t868;
  t871 = t97 * t245;
  t872 = t510 * t871;
  t875 = 0.2e1 * t239 * t825 + 0.2e1 * t254 * t583 - 0.2e1 * t254 * t872 - t831 * t833 - 0.2e1 * t839 * t840 - 0.3e1 * t843 * t845 - t319 - t321 + t814 - t817 - t824 + t837 - 0.3e1 * t853 + 0.3e1 * t860 - 0.3e1 * t864 + 0.3e1 * t869;
  t876 = t423 * t838;
  t877 = t183 * t91;
  t878 = t647 * t877;
  t881 = t206 * t245;
  t882 = t205 * t881;
  t885 = t173 * t855;
  t886 = t844 * t197;
  t887 = t205 * t886;
  t888 = t885 * t887;
  t890 = t434 * t91;
  t891 = t431 * t890;
  t896 = t439 * t256;
  t899 = t482 * t91;
  t900 = t481 * t899;
  t905 = t836 * t241;
  t906 = t173 * t835;
  t907 = t906 * t241;
  t909 = t91 * t62 * t96;
  t910 = t455 * t909;
  t915 = t451 * t91;
  t916 = t431 * t915;
  t921 = t906 * t257;
  t922 = 0.2e1 * t239 * t872 - 0.2e1 * t254 * t882 - t839 * t900 - 0.3e1 * t839 * t910 + 0.3e1 * t843 * t878 + 0.3e1 * t843 * t900 + 0.3e1 * t843 * t910 - 0.3e1 * t876 * t878 + 0.3e1 * t876 * t891 + 0.3e1 * t876 * t896 - t876 * t900 - 0.2e1 * t876 * t916 + 0.3e1 * t888 + t905 - t907 - t921;
  t924 = my_piecewise5(t52, 0, t55, 0, t875 + t922);
  t926 = 0.8e2 / 0.243e3 * t806 - 0.1e2 / 0.81e2 * t809 + t87 * t327 + t47 * t924;
  t931 = my_piecewise3(t3, 0, t8 * t73 * t329 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t926);
  tv3rhosigma20 = 0.2e1 * rho[0] * t931 + 0.2e1 * t333;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t942 = t30 * t223 * t139;
  t945 = t30 * t110 * t297;
  t952 = t286 * t118;
  t954 = t89 * t952 * t199;
  t955 = t136 * t245;
  t957 = t89 * t955 * t199;
  t958 = t345 * t197;
  t959 = t173 * t958;
  t960 = t205 * t182;
  t961 = t960 * t862;
  t962 = t959 * t961;
  t965 = t510 * t91 * t512;
  t966 = t959 * t965;
  t968 = t97 * params->csk_a;
  t969 = t248 * t197;
  t971 = t785 * t968 * t969;
  t973 = t719 * t429;
  t974 = t89 * t973;
  t975 = t440 * t118;
  t976 = t975 * t91;
  t977 = t97 * t976;
  t979 = t173 * t973;
  t982 = t97 * t118;
  t983 = t851 * t982;
  t986 = t423 * t973;
  t987 = t975 * t877;
  t990 = t491 * t976;
  t993 = t254 * t710 + t632 * t279 + t282 * t825 + t724 * t349 - t974 * t977 + 0.3e1 * t979 * t977 + 0.3e1 * t979 * t983 - 0.3e1 * t986 * t987 - 0.2e1 * t986 * t990 - t319 - t347 + t814 - t817 + t837 - t954 - t957 - 0.3e1 * t962 - 0.3e1 * t966 + 0.3e1 * t971;
  t994 = t173 * t611;
  t995 = t289 * t197;
  t996 = t183 * t995;
  t997 = t994 * t996;
  t999 = t571 * t429;
  t1000 = t423 * t999;
  t1001 = t136 * params->csk_a;
  t1002 = t1001 * t91;
  t1003 = t491 * t1002;
  t1008 = t89 * t958;
  t1009 = t1008 * t868;
  t1014 = t183 * t1002;
  t1017 = t348 * t91;
  t1018 = t481 * t1017;
  t1021 = t278 * t91;
  t1022 = t439 * t1021;
  t1029 = t587 * t136;
  t1030 = t431 * t1029;
  t1034 = 0.3e1 * t1000 * t1003 + 0.3e1 * t1000 * t1014 - 0.2e1 * t720 * t1018 - 0.3e1 * t627 * t1022 - t831 * t1030 + t282 * t872 - t293 * t872 - t293 * t882 + t724 * t343 - t749 * t343 - t749 * t353 - 0.3e1 * t974 * t983 - t986 * t977 + 0.3e1 * t979 * t987 + 0.3e1 * t1009 + t905 - t907 - t921 + 0.3e1 * t997;
  t1036 = my_piecewise5(t52, 0, t55, 0, t993 + t1034);
  t1038 = -0.25e2 / 0.162e3 * t308 + 0.5e1 / 0.54e2 * t30 * t129 * t260 + 0.4e2 / 0.243e3 * t942 - 0.5e1 / 0.81e2 * t945 + t87 * t356 + t47 * t1036;
  t1043 = my_piecewise3(t3, 0, t8 * t73 * t358 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1038);
  tv3rhosigmalapl0 = 0.2e1 * rho[0] * t1043 + 0.2e1 * t362;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  t1056 = t433 * t367;
  t1057 = t431 * t1056;
  t1059 = t136 * t197;
  t1060 = t89 * t1059;
  t1061 = t96 * t286;
  t1063 = t1060 * t820 * t1061;
  t1064 = 0.2e1 * t1063;
  t1068 = t367 * t425;
  t1069 = t173 * t1068;
  t1072 = t89 * t1068;
  t1075 = t367 * t197;
  t1077 = t173 * t1075 * t178;
  t1078 = t1077 * t852;
  t1080 = t367 * t93;
  t1082 = t89 * t1080 * t178;
  t1083 = t1082 * t859;
  t1085 = t1077 * t863;
  t1087 = t89 * t1075;
  t1088 = t1087 * t868;
  t1090 = t97 * t286;
  t1091 = t510 * t1090;
  t1094 = 0.2e1 * t282 * t188 * t1061 - t831 * t1057 - 0.3e1 * t1069 * t845 - 0.2e1 * t1072 * t840 - 0.2e1 * t293 * t1091 + 0.2e1 * t293 * t710 - t1064 - 0.3e1 * t1078 + 0.3e1 * t1083 - 0.3e1 * t1085 + 0.3e1 * t1088 - t319 - t374 + t814 - t817 + t837;
  t1095 = t423 * t1068;
  t1098 = t206 * t286;
  t1114 = t173 * t1080;
  t1115 = t1114 * t887;
  t1123 = -0.2e1 * t293 * t205 * t1098 + 0.3e1 * t1069 * t878 + 0.3e1 * t1069 * t900 + 0.3e1 * t1069 * t910 - t1072 * t900 - 0.3e1 * t1072 * t910 + 0.2e1 * t282 * t1091 - 0.3e1 * t1095 * t878 + 0.3e1 * t1095 * t891 + 0.3e1 * t1095 * t896 - t1095 * t900 - 0.2e1 * t1095 * t916 + 0.3e1 * t1115 + t905 - t907 - t921;
  t1125 = my_piecewise5(t52, 0, t55, 0, t1094 + t1123);
  t1127 = -0.25e2 / 0.81e2 * t339 + 0.5e1 / 0.27e2 * t30 * t129 * t297 + t87 * t380 + t47 * t1125;
  t1132 = my_piecewise3(t3, 0, t8 * t73 * t382 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1127);
  tv3rholapl20 = 0.2e1 * rho[0] * t1132 + 0.2e1 * t386;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  t1136 = t30 * t110 * t327;
  t1138 = t310 * t118;
  t1139 = t1138 * t93;
  t1141 = t173 * t1139 * t465;
  t1142 = 0.3e1 * t1141;
  t1143 = t836 * t349;
  t1144 = 0.3e1 * t1143;
  t1145 = t1138 * t197;
  t1146 = t89 * t1145;
  t1147 = t1146 * t475;
  t1148 = 0.3e1 * t1147;
  t1149 = t1138 * t425;
  t1150 = t423 * t1149;
  t1155 = t254 * t813;
  t1156 = 0.3e1 * t1155;
  t1159 = t173 * t1149;
  t1162 = t317 * t118;
  t1164 = t89 * t1162 * t199;
  t1165 = 0.3e1 * t1164;
  t1168 = t89 * t1149;
  t1173 = 0.3e1 * t1150 * t435 - 0.3e1 * t1150 * t442 - 0.2e1 * t1150 * t452 + 0.3e1 * t1150 * t478 - t1150 * t483 + 0.3e1 * t1159 * t442 + 0.3e1 * t1159 * t483 - t1168 * t483 + t1142 + t1144 + t1148 + t1156 - t1165;
  t1186 = t189 * t317;
  t1187 = t188 * t1186;
  t1188 = t239 * t1187;
  t1189 = 0.3e1 * t1188;
  t1190 = t906 * t353;
  t1191 = 0.3e1 * t1190;
  t1192 = t173 * t1145;
  t1193 = t1192 * t529;
  t1194 = 0.3e1 * t1193;
  t1195 = t906 * t343;
  t1196 = 0.3e1 * t1195;
  t1197 = t1192 * t513;
  t1198 = 0.3e1 * t1197;
  t1200 = t89 * t1139 * t518;
  t1201 = 0.3e1 * t1200;
  t1202 = -0.3e1 * t173 * t1138 * t499 - t423 * t1138 * t492 - 0.2e1 * t89 * t1138 * t503 + 0.3e1 * t1159 * t456 - 0.3e1 * t1168 * t456 + t1189 - t1191 - t1194 - t1196 - t1198 + t1201 - t319 - t321;
  t1204 = my_piecewise5(t52, 0, t55, 0, t1173 + t1202);
  t1206 = -0.5e1 / 0.27e2 * t1136 + t47 * t1204;
  t1210 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1206);
  tv3sigma30 = 0.2e1 * rho[0] * t1210;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1216 = t30 * t110 * t356;
  t1218 = t906 * t279;
  t1220 = t136 * t317;
  t1222 = t89 * t1220 * t199;
  t1223 = t96 * t317;
  t1224 = t188 * t1223;
  t1225 = t282 * t1224;
  t1228 = t96 * t310;
  t1229 = t481 * t1228;
  t1232 = 0.2e1 * t1143;
  t1233 = 0.2e1 * t1155;
  t1234 = 0.2e1 * t1164;
  t1235 = t136 * t310;
  t1236 = t1235 * t197;
  t1237 = t173 * t1236;
  t1238 = t1237 * t513;
  t1239 = 0.3e1 * t1238;
  t1240 = t1237 * t529;
  t1241 = 0.3e1 * t1240;
  t1242 = params->csk_a * t310;
  t1243 = t1242 * t197;
  t1244 = t97 * t1243;
  t1245 = t785 * t1244;
  t1246 = 0.3e1 * t1245;
  t1247 = t189 * t310;
  t1248 = t481 * t1247;
  t1253 = -0.2e1 * t720 * t1229 - 0.3e1 * t720 * t1248 - t876 * t714 - 0.3e1 * t843 * t716 + 0.3e1 * t876 * t739 + t1218 - t1222 + t1225 + t1232 + t1233 - t1234 - t1239 - t1241 + t1246 - t319 - t347;
  t1254 = t482 * t310;
  t1255 = t481 * t1254;
  t1262 = t647 * t310 * t180 * t182;
  t1265 = t206 * t317;
  t1266 = t205 * t1265;
  t1267 = t293 * t1266;
  t1268 = t451 * t310;
  t1269 = t431 * t1268;
  t1274 = t282 * t1187;
  t1279 = t885 * t757;
  t1280 = 0.3e1 * t1279;
  t1281 = t89 * t1235;
  t1282 = t1281 * t643;
  t1283 = 0.3e1 * t1282;
  t1284 = 0.2e1 * t1188;
  t1285 = 0.2e1 * t1190;
  t1286 = 0.2e1 * t1195;
  t1287 = t293 * t1187;
  t1288 = 0.3e1 * t743 * t1248 - t720 * t1255 - t736 * t1255 + 0.3e1 * t743 * t1255 - 0.3e1 * t736 * t1262 + 0.3e1 * t743 * t1262 - 0.2e1 * t736 * t1269 + 0.3e1 * t876 * t767 - t1267 + t1274 + t1280 + t1283 + t1284 - t1285 - t1286 - t1287;
  t1290 = my_piecewise5(t52, 0, t55, 0, t1253 + t1288);
  t1292 = 0.5e1 / 0.54e2 * t30 * t129 * t327 - 0.1e2 / 0.81e2 * t1216 + t47 * t1290;
  t1296 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1292);
  tv3sigma2lapl0 = 0.2e1 * rho[0] * t1296;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  t1302 = t30 * t110 * t380;
  t1304 = 0.2e1 * t1218;
  t1305 = 0.2e1 * t1222;
  t1306 = 0.2e1 * t1225;
  t1313 = params->csk_a * t118;
  t1314 = t1313 * t197;
  t1315 = t97 * t1314;
  t1316 = t1082 * t1315;
  t1317 = 0.3e1 * t1316;
  t1318 = t1313 * t93;
  t1320 = t1077 * t183 * t1318;
  t1321 = 0.3e1 * t1320;
  t1323 = t1077 * t1313 * t512;
  t1324 = 0.3e1 * t1323;
  t1327 = t482 * t118;
  t1328 = t481 * t1327;
  t1330 = -0.2e1 * t1072 * t481 * t348 - t630 * t1057 - 0.3e1 * t1069 * t568 - t1072 * t1328 + 0.3e1 * t1095 * t620 + t1143 + t1155 - t1164 + t1304 - t1305 + t1306 + t1317 - t1321 - t1324 - t319 - t374;
  t1334 = t455 * t982;
  t1339 = t451 * t118;
  t1343 = t441 * t118;
  t1344 = t439 * t1343;
  t1348 = t188 * t348 * t93;
  t1349 = t1087 * t1348;
  t1350 = 0.3e1 * t1349;
  t1353 = t1114 * t638;
  t1354 = 0.3e1 * t1353;
  t1357 = 0.2e1 * t1267;
  t1358 = 0.2e1 * t1274;
  t1359 = 0.2e1 * t1287;
  t1360 = -0.2e1 * t1095 * t431 * t1339 + 0.3e1 * t1069 * t1328 + 0.3e1 * t1069 * t1334 + 0.3e1 * t1069 * t1344 - 0.3e1 * t1072 * t1334 - t1095 * t1328 - 0.3e1 * t1095 * t1344 + 0.3e1 * t1095 * t668 + t1188 - t1190 - t1195 + t1350 + t1354 - t1357 + t1358 - t1359;
  t1362 = my_piecewise5(t52, 0, t55, 0, t1330 + t1360);
  t1364 = 0.5e1 / 0.27e2 * t30 * t129 * t356 - 0.5e1 / 0.81e2 * t1302 + t47 * t1362;
  t1368 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1364);
  tv3sigmalapl20 = 0.2e1 * rho[0] * t1368;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  t1373 = t367 * t136;
  t1374 = t1373 * t425;
  t1375 = t89 * t1374;
  t1378 = t423 * t1374;
  t1385 = t173 * t1374;
  t1388 = t1373 * t93;
  t1390 = t173 * t1388 * t465;
  t1391 = 0.3e1 * t1390;
  t1392 = 0.3e1 * t1218;
  t1393 = 0.3e1 * t1222;
  t1394 = 0.3e1 * t1225;
  t1403 = -0.3e1 * t173 * t1373 * t499 - t423 * t1373 * t492 - 0.2e1 * t89 * t1373 * t503 - 0.3e1 * t1375 * t456 + 0.3e1 * t1378 * t435 - 0.3e1 * t1378 * t442 - 0.2e1 * t1378 * t452 + 0.3e1 * t1385 * t442 + t1391 + t1392 - t1393 + t1394 - t374;
  t1404 = t1373 * t197;
  t1405 = t173 * t1404;
  t1406 = t1405 * t513;
  t1407 = 0.3e1 * t1406;
  t1409 = t89 * t1388 * t518;
  t1410 = 0.3e1 * t1409;
  t1411 = t1405 * t529;
  t1412 = 0.3e1 * t1411;
  t1413 = 0.3e1 * t1267;
  t1414 = 0.3e1 * t1274;
  t1415 = 0.3e1 * t1287;
  t1416 = t89 * t1404;
  t1417 = t1416 * t475;
  t1418 = 0.3e1 * t1417;
  t1427 = -t1375 * t483 + 0.3e1 * t1378 * t478 - t1378 * t483 + 0.3e1 * t1385 * t456 + 0.3e1 * t1385 * t483 - t1407 + t1410 - t1412 - t1413 + t1414 - t1415 + t1418 - t319;
  t1429 = my_piecewise5(t52, 0, t55, 0, t1403 + t1427);
  t1431 = 0.5e1 / 0.18e2 * t30 * t129 * t380 + t47 * t1429;
  t1435 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1431);
  tv3lapl30 = 0.2e1 * rho[0] * t1435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t30, t31, t32;
  double t33, t34, t36, t38, t40, t42, t47, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t67, t71, tzk0;

  double t73, t77, t79, t81, t87, t89, t90, t91;
  double t93, t94, t96, t97, t98, t100, t102, t107;
  double tvrho0, t110, t111, t114, t117, t118, t121, t123;
  double t127, tvsigma0, t129, t135, t136, t139, t141, t145;
  double tvlapl0, tvtau0;

  double t150, t157, t159, t161, t167, t171, t173, t174;
  double t176, t177, t178, t179, t180, t181, t182, t183;
  double t184, t186, t188, t189, t190, t192, t193, t196;
  double t197, t199, t200, t201, t203, t205, t206, t207;
  double t210, t212, t217, tv2rho20, t223, t224, t227, t230;
  double t233, t234, t235, t236, t238, t239, t240, t241;
  double t244, t245, t248, t250, t251, t252, t254, t256;
  double t257, t260, t262, t267, tv2rhosigma0, t278, t279, t281;
  double t282, t285, t286, t289, t291, t293, t297, t299;
  double t304, tv2rholapl0, tv2rhotau0, t308, t310, t313, t316, t317;
  double t319, t320, t321, t323, t327, t329, t333, tv2sigma20;
  double t339, t343, t345, t346, t347, t348, t349, t352;
  double t353, t356, t358, t362, tv2sigmalapl0, tv2sigmatau0, t367, t370;
  double t373, t374, t376, t380, t382, t386, tv2lapl20, tv2lapltau0;
  double tv2tau20;

  double t391, t403, t405, t411, t417, t423, t424, t425;
  double t426, t427, t429, t430, t431, t433, t434, t435;
  double t438, t439, t440, t441, t442, t445, t447, t451;
  double t452, t455, t456, t459, t462, t464, t465, t466;
  double t468, t472, t474, t475, t476, t478, t481, t482;
  double t483, t485, t490, t491, t492, t494, t495, t499;
  double t503, t506, t509, t510, t512, t513, t514, t517;
  double t518, t519, t522, t523, t529, t530, t532, t534;
  double t536, t541, tv3rho30, t551, t552, t555, t558, t561;
  double t566, t567, t568, t571, t572, t573, t574, t577;
  double t578, t582, t583, t586, t587, t590, t592, t596;
  double t597, t598, t601, t602, t605, t606, t607, t608;
  double t610, t611, t612, t613, t614, t615, t616, t618;
  double t620, t623, t624, t626, t627, t630, t632, t635;
  double t636, t637, t638, t639, t643, t644, t647, t649;
  double t650, t653, t654, t656, t657, t667, t668, t671;
  double t672, t677, t679, t681, t686, tv3rho2sigma0, t704, t706;
  double t709, t710, t713, t714, t716, t719, t720, t723;
  double t724, t730, t732, t733, t736, t738, t739, t743;
  double t748, t749, t752, t754, t756, t757, t758, t766;
  double t767, t779, t780, t781, t784, t785, t786, t788;
  double t790, t792, t794, t799, tv3rho2lapl0, tv3rho2tau0, t806, t809;
  double t812, t813, t814, t815, t817, t818, t819, t820;
  double t821, t823, t824, t825, t830, t831, t832, t833;
  double t835, t836, t837, t838, t839, t840, t843, t844;
  double t845, t848, t850, t851, t852, t853, t855, t857;
  double t858, t859, t860, t862, t863, t864, t866, t868;
  double t869, t871, t872, t875, t876, t877, t878, t881;
  double t882, t885, t886, t887, t888, t890, t891, t896;
  double t899, t900, t905, t906, t907, t909, t910, t915;
  double t916, t921, t922, t924, t926, t931, tv3rhosigma20, t942;
  double t945, t952, t954, t955, t957, t958, t959, t960;
  double t961, t962, t965, t966, t968, t969, t971, t973;
  double t974, t975, t976, t977, t979, t982, t983, t986;
  double t987, t990, t993, t994, t995, t996, t997, t999;
  double t1000, t1001, t1002, t1003, t1008, t1009, t1014, t1017;
  double t1018, t1021, t1022, t1029, t1030, t1034, t1036, t1038;
  double t1043, tv3rhosigmalapl0, tv3rhosigmatau0, t1056, t1057, t1059, t1060, t1061;
  double t1063, t1064, t1068, t1069, t1072, t1075, t1077, t1078;
  double t1080, t1082, t1083, t1085, t1087, t1088, t1090, t1091;
  double t1094, t1095, t1098, t1114, t1115, t1123, t1125, t1127;
  double t1132, tv3rholapl20, tv3rholapltau0, tv3rhotau20, t1136, t1138, t1139, t1141;
  double t1142, t1143, t1144, t1145, t1146, t1147, t1148, t1149;
  double t1150, t1155, t1156, t1159, t1162, t1164, t1165, t1168;
  double t1173, t1186, t1187, t1188, t1189, t1190, t1191, t1192;
  double t1193, t1194, t1195, t1196, t1197, t1198, t1200, t1201;
  double t1202, t1204, t1206, t1210, tv3sigma30, t1216, t1218, t1220;
  double t1222, t1223, t1224, t1225, t1228, t1229, t1232, t1233;
  double t1234, t1235, t1236, t1237, t1238, t1239, t1240, t1241;
  double t1242, t1243, t1244, t1245, t1246, t1247, t1248, t1253;
  double t1254, t1255, t1262, t1265, t1266, t1267, t1268, t1269;
  double t1274, t1279, t1280, t1281, t1282, t1283, t1284, t1285;
  double t1286, t1287, t1288, t1290, t1292, t1296, tv3sigma2lapl0, tv3sigma2tau0;
  double t1302, t1304, t1305, t1306, t1313, t1314, t1315, t1316;
  double t1317, t1318, t1320, t1321, t1323, t1324, t1327, t1328;
  double t1330, t1334, t1339, t1343, t1344, t1348, t1349, t1350;
  double t1353, t1354, t1357, t1358, t1359, t1360, t1362, t1364;
  double t1368, tv3sigmalapl20, tv3sigmalapltau0, tv3sigmatau20, t1373, t1374, t1375, t1378;
  double t1385, t1388, t1390, t1391, t1392, t1393, t1394, t1403;
  double t1404, t1405, t1406, t1407, t1409, t1410, t1411, t1412;
  double t1413, t1414, t1415, t1416, t1417, t1418, t1427, t1429;
  double t1431, t1435, tv3lapl30, tv3lapl2tau0, tv3lapltau20, tv3tau30;

  double t1457, t1463, t1474, t1475, t1478, t1479, t1480, t1481;
  double t1482, t1485, t1486, t1487, t1488, t1489, t1492, t1493;
  double t1497, t1500, t1503, t1505, t1507, t1508, t1509, t1510;
  double t1511, t1514, t1515, t1526, t1528, t1531, t1536, t1538;
  double t1541, t1542, t1545, t1547, t1548, t1550, t1551, t1554;
  double t1555, t1556, t1559, t1561, t1566, t1569, t1572, t1576;
  double t1579, t1580, t1584, t1588, t1589, t1591, t1596, t1602;
  double t1606, t1607, t1610, t1614, t1618, t1621, t1623, t1628;
  double t1631, t1633, t1636, t1644, t1645, t1648, t1655, t1656;
  double t1661, t1662, t1663, t1664, t1671, t1674, t1675, t1676;
  double t1677, t1678, t1681, t1684, t1685, t1686, t1689, t1692;
  double t1693, t1694, t1702, t1705, t1708, t1711, t1715, t1721;
  double t1722, t1733, t1737, t1740, t1747, t1748, t1749, t1757;
  double t1758, t1765, t1773, t1777, t1784, tv4rho40, t1797, t1798;
  double t1820, t1821, t1828, t1832, t1833, t1834, t1839, t1840;
  double t1844, t1847, t1848, t1849, t1852, t1855, t1856, t1859;
  double t1862, t1866, t1870, t1874, t1876, t1881, t1885, t1886;
  double t1890, t1893, t1903, t1904, t1908, t1910, t1912, t1913;
  double t1918, t1921, t1928, t1933, t1938, t1939, t1942, t1943;
  double t1945, t1949, t1952, t1953, t1956, t1957, t1961, t1964;
  double t1965, t1966, t1967, t1970, t1972, t1975, t1978, t1979;
  double t1980, t1985, t1988, t1989, t1991, t1998, t1999, t2002;
  double t2004, t2010, t2012, t2018, t2021, t2031, t2032, t2037;
  double t2040, t2043, t2045, t2050, t2055, t2056, t2063, t2065;
  double t2069, t2077, t2080, t2086, t2093, t2096, t2107, t2110;
  double t2112, t2119, t2121, t2130, t2135, t2138, t2149, t2153;
  double t2156, t2161, t2164, t2170, t2177, t2181, t2188, tv4rho3sigma0;
  double t2215, t2216, t2224, t2228, t2234, t2235, t2245, t2246;
  double t2254, t2255, t2258, t2259, t2262, t2265, t2271, t2275;
  double t2276, t2281, t2286, t2291, t2293, t2299, t2307, t2308;
  double t2311, t2314, t2317, t2320, t2322, t2323, t2326, t2333;
  double t2334, t2341, t2347, t2350, t2353, t2360, t2363, t2370;
  double t2383, t2393, t2395, t2400, t2402, t2405, t2414, t2418;
  double t2425, t2426, t2434, t2438, t2445, t2448, t2472, t2475;
  double t2478, t2480, t2483, t2489, t2506, t2509, t2513, t2520;
  double tv4rho3lapl0, tv4rho3tau0, t2542, t2543, t2545, t2546, t2550, t2555;
  double t2556, t2557, t2560, t2563, t2567, t2568, t2569, t2570;
  double t2575, t2578, t2581, t2582, t2583, t2586, t2587, t2589;
  double t2591, t2592, t2598, t2599, t2602, t2607, t2608, t2611;
  double t2615, t2616, t2619, t2620, t2625, t2631, t2639, t2640;
  double t2642, t2654, t2664, t2665, t2666, t2669, t2670, t2671;
  double t2672, t2675, t2676, t2680, t2683, t2684, t2686, t2687;
  double t2689, t2691, t2692, t2695, t2698, t2702, t2703, t2706;
  double t2721, t2722, t2723, t2730, t2734, t2736, t2738, t2739;
  double t2741, t2745, t2749, t2752, t2755, t2757, t2758, t2762;
  double t2763, t2764, t2767, t2769, t2773, t2780, t2782, t2784;
  double t2787, t2789, t2792, t2798, t2803, t2805, t2810, t2812;
  double t2815, t2820, t2822, t2827, t2828, t2829, t2833, t2841;
  double t2847, t2852, t2868, t2869, t2870, t2871, t2875, t2883;
  double t2885, t2888, t2892, t2893, t2895, t2904, t2905, t2913;
  double t2914, t2915, t2918, t2919, t2923, t2926, t2930, t2937;
  double tv4rho2sigma20, t2967, t2977, t2978, t2982, t2983, t2987, t2991;
  double t2995, t2996, t2999, t3002, t3003, t3006, t3009, t3010;
  double t3014, t3020, t3021, t3023, t3026, t3029, t3032, t3033;
  double t3036, t3037, t3046, t3055, t3058, t3061, t3068, t3069;
  double t3072, t3074, t3079, t3080, t3081, t3085, t3092, t3098;
  double t3101, t3102, t3112, t3119, t3122, t3123, t3127, t3133;
  double t3143, t3147, t3175, t3176, t3186, t3222, t3223, t3232;
  double t3234, t3256, t3266, t3270, t3277, t3284, t3317, t3321;
  double t3328, tv4rho2sigmalapl0, tv4rho2sigmatau0, t3347, t3351, t3356, t3357, t3360;
  double t3363, t3367, t3368, t3378, t3379, t3380, t3387, t3388;
  double t3394, t3395, t3398, t3399, t3406, t3430, t3434, t3435;
  double t3438, t3447, t3448, t3451, t3455, t3458, t3469, t3475;
  double t3485, t3494, t3497, t3499, t3503, t3509, t3514, t3524;
  double t3545, t3555, t3565, t3568, t3584, t3585, t3596, t3601;
  double t3612, t3615, t3619, t3624, t3628, t3635, tv4rho2lapl20, tv4rho2lapltau0;
  double tv4rho2tau20, t3648, t3649, t3650, t3651, t3652, t3654, t3656;
  double t3658, t3661, t3662, t3665, t3666, t3669, t3670, t3672;
  double t3674, t3675, t3678, t3679, t3685, t3686, t3687, t3688;
  double t3691, t3692, t3693, t3694, t3696, t3697, t3700, t3702;
  double t3704, t3707, t3708, t3710, t3715, t3717, t3720, t3723;
  double t3727, t3730, t3732, t3742, t3744, t3746, t3747, t3749;
  double t3752, t3754, t3758, t3761, t3763, t3766, t3770, t3773;
  double t3774, t3777, t3781, t3784, t3790, t3795, t3796, t3799;
  double t3805, t3810, t3816, t3822, t3827, t3830, t3836, t3839;
  double t3843, t3844, t3855, t3857, t3860, t3866, t3872, t3878;
  double t3886, t3889, t3893, t3895, t3897, t3902, t3904, t3905;
  double t3906, t3907, t3909, t3911, t3913, t3914, t3916, t3925;
  double t3932, t3936, t3938, t3941, t3949, t3953, t3960, tv4rhosigma30;
  double t3978, t3980, t3981, t3986, t3987, t3990, t3992, t3993;
  double t3994, t3995, t3998, t4000, t4001, t4004, t4009, t4012;
  double t4022, t4026, t4027, t4028, t4032, t4033, t4034, t4036;
  double t4038, t4041, t4050, t4053, t4057, t4065, t4067, t4070;
  double t4082, t4088, t4089, t4091, t4092, t4095, t4097, t4107;
  double t4110, t4126, t4130, t4135, t4142, t4157, t4168, t4170;
  double t4203, t4204, t4208, t4209, t4210, t4213, t4214, t4238;
  double t4242, t4246, t4248, t4256, t4260, t4266, t4270, t4274;
  double t4282, t4302, t4303, t4308, t4310, t4315, t4322, tv4rhosigma2lapl0;
  double tv4rhosigma2tau0, t4341, t4342, t4345, t4346, t4349, t4352, t4353;
  double t4354, t4357, t4358, t4365, t4367, t4373, t4381, t4392;
  double t4400, t4407, t4418, t4419, t4420, t4424, t4428, t4430;
  double t4451, t4465, t4470, t4482, t4503, t4519, t4543, t4559;
  double t4571, t4575, t4580, t4583, t4593, t4600, t4625, t4630;
  double t4637, tv4rhosigmalapl20, tv4rhosigmalapltau0, tv4rhosigmatau20, t4648, t4650, t4653, t4654;
  double t4655, t4658, t4661, t4664, t4666, t4667, t4697, t4706;
  double t4707, t4711, t4714, t4717, t4724, t4739, t4743, t4746;
  double t4748, t4757, t4759, t4766, t4769, t4770, t4779, t4780;
  double t4789, t4797, t4805, t4810, t4814, t4829, t4838, t4841;
  double t4852, t4867, t4869, t4873, t4880, tv4rholapl30, tv4rholapl2tau0, tv4rholapltau20;
  double tv4rhotau30, t4891, t4892, t4900, t4903, t4904, t4906, t4909;
  double t4910, t4920, t4923, t4924, t4926, t4927, t4929, t4930;
  double t4933, t4935, t4938, t4939, t4941, t4944, t4946, t4948;
  double t4953, t4955, t4957, t4962, t4964, t4965, t4969, t4970;
  double t4972, t4973, t4977, t4982, t4990, t4993, t5001, t5002;
  double t5011, t5020, t5022, t5027, t5028, t5036, t5039, t5042;
  double t5046, t5060, t5061, t5063, t5065, t5069, t5088, t5092;
  double t5098, tv4sigma40, t5106, t5107, t5108, t5114, t5115, t5116;
  double t5120, t5121, t5122, t5123, t5124, t5125, t5126, t5130;
  double t5131, t5132, t5133, t5134, t5135, t5136, t5138, t5147;
  double t5148, t5149, t5150, t5151, t5152, t5154, t5155, t5156;
  double t5158, t5159, t5160, t5161, t5164, t5165, t5173, t5175;
  double t5182, t5186, t5188, t5197, t5206, t5215, t5216, t5217;
  double t5220, t5227, t5245, t5246, t5257, t5263, t5264, t5278;
  double t5286, t5287, t5288, t5289, t5290, t5291, t5293, t5294;
  double t5310, t5314, t5320, tv4sigma3lapl0, tv4sigma3tau0, t5330, t5334, t5339;
  double t5341, t5346, t5354, t5358, t5362, t5371, t5383, t5389;
  double t5393, t5400, t5403, t5413, t5420, t5441, t5448, t5456;
  double t5461, t5463, t5464, t5466, t5468, t5470, t5472, t5475;
  double t5481, t5484, t5488, t5501, t5512, t5516, t5519, t5524;
  double t5537, t5541, t5547, tv4sigma2lapl20, tv4sigma2lapltau0, tv4sigma2tau20, t5556, t5561;
  double t5573, t5585, t5588, t5591, t5599, t5601, t5609, t5616;
  double t5631, t5635, t5666, t5677, t5679, t5696, t5700, t5706;
  double tv4sigmalapl30, tv4sigmalapl2tau0, tv4sigmalapltau20, tv4sigmatau30, t5715, t5718, t5721, t5735;
  double t5739, t5740, t5745, t5747, t5750, t5780, t5792, t5793;
  double t5796, t5801, t5816, t5820, t5821, t5836, t5864, t5868;
  double t5874, tv4lapl40, tv4lapl3tau0, tv4lapl2tau20, tv4lapltau30, tv4tau40;

  mgga_k_csk_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t30 = t25 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t38 = t30 * t33 * t36;
  t40 = lapl[0] * t32;
  t42 = 0.1e1 / t23 / rho[0];
  t47 = 0.5e1 / 0.54e2 * t30 * t40 * t42 - 0.5e1 / 0.81e2 * t38;
  t49 = log(0.1e1 - DBL_EPSILON);
  t50 = 0.1e1 / params->csk_a;
  t51 = pow(-t49, -t50);
  t52 = t47 < -t51;
  t53 = log(DBL_EPSILON);
  t54 = pow(-t53, -t50);
  t55 = -t54 < t47;
  t56 = my_piecewise3(t55, -t54, t47);
  t57 = -t51 < t56;
  t58 = my_piecewise3(t57, t56, -t51);
  t59 = fabs(t58);
  t60 = pow(t59, params->csk_a);
  t61 = 0.1e1 / t60;
  t62 = exp(-t61);
  t63 = 0.1e1 - t62;
  t64 = pow(t63, t50);
  t65 = my_piecewise5(t52, 0, t55, 1, t64);
  t67 = 0.1e1 + 0.5e1 / 0.72e2 * t38 + t47 * t65;
  t71 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t73 = t21 / t22;
  t77 = t34 * rho[0];
  t79 = 0.1e1 / t23 / t77;
  t81 = t30 * t33 * t79;
  t87 = -0.25e2 / 0.162e3 * t30 * t40 * t36 + 0.4e2 / 0.243e3 * t81;
  t89 = t64 * t61;
  t90 = my_piecewise3(t55, 0, t87);
  t91 = my_piecewise3(t57, t90, 0);
  t93 = fabs(t58) / t58;
  t94 = 0.1e1 / t59;
  t96 = 0.1e1 / t63;
  t97 = t62 * t96;
  t98 = t93 * t94 * t97;
  t100 = my_piecewise5(t52, 0, t55, 0, -t89 * t91 * t98);
  t102 = -0.5e1 / 0.27e2 * t81 + t87 * t65 + t47 * t100;
  t107 = my_piecewise3(t3, 0, t8 * t73 * t67 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t102);
  tvrho0 = 0.2e1 * rho[0] * t107 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t110 = t32 * t36;
  t111 = t30 * t110;
  t114 = t30 * t110 * t65;
  t117 = my_piecewise3(t55, 0, -0.5e1 / 0.81e2 * t111);
  t118 = my_piecewise3(t57, t117, 0);
  t121 = my_piecewise5(t52, 0, t55, 0, -t89 * t118 * t98);
  t123 = 0.5e1 / 0.72e2 * t111 - 0.5e1 / 0.81e2 * t114 + t47 * t121;
  t127 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t123);
  tvsigma0 = 0.2e1 * rho[0] * t127;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t129 = t32 * t42;
  t135 = my_piecewise3(t55, 0, 0.5e1 / 0.54e2 * t30 * t129);
  t136 = my_piecewise3(t57, t135, 0);
  t139 = my_piecewise5(t52, 0, t55, 0, -t89 * t136 * t98);
  t141 = 0.5e1 / 0.54e2 * t30 * t129 * t65 + t47 * t139;
  t145 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t141);
  tvlapl0 = 0.2e1 * rho[0] * t145;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t150 = t21 / t22 / rho[0];
  t157 = t34 * t34;
  t159 = 0.1e1 / t23 / t157;
  t161 = t30 * t33 * t159;
  t167 = 0.1e3 / 0.243e3 * t30 * t40 * t79 - 0.44e3 / 0.729e3 * t161;
  t171 = t60 * t60;
  t173 = t64 / t171;
  t174 = t91 * t91;
  t176 = t93 * t93;
  t177 = t59 * t59;
  t178 = 0.1e1 / t177;
  t179 = t176 * t178;
  t180 = t62 * t62;
  t181 = t63 * t63;
  t182 = 0.1e1 / t181;
  t183 = t180 * t182;
  t184 = t179 * t183;
  t186 = t174 * t176;
  t188 = t178 * t62;
  t189 = t96 * params->csk_a;
  t190 = t188 * t189;
  t192 = my_piecewise3(t55, 0, t167);
  t193 = my_piecewise3(t57, t192, 0);
  t196 = t89 * t174;
  t197 = 0.0;
  t199 = t197 * t94 * t97;
  t200 = t196 * t199;
  t201 = t179 * t97;
  t203 = t173 * t186;
  t205 = t178 * t180;
  t206 = t182 * params->csk_a;
  t207 = t205 * t206;
  t210 = my_piecewise5(t52, 0, t55, 0, t173 * t174 * t184 + t89 * t186 * t190 - t89 * t193 * t98 - t203 * t190 + t196 * t201 - t203 * t207 - t200);
  t212 = 0.55e2 / 0.81e2 * t161 + t167 * t65 + 0.2e1 * t87 * t100 + t47 * t210;
  t217 = my_piecewise3(t3, 0, -t8 * t150 * t67 / 0.3e2 + t8 * t73 * t102 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t107;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t32 * t79;
  t224 = t30 * t223;
  t227 = t30 * t223 * t65;
  t230 = t30 * t110 * t100;
  t233 = t91 * t176;
  t234 = t173 * t233;
  t235 = t182 * t118;
  t236 = t205 * t235;
  t238 = t118 * t176;
  t239 = t89 * t238;
  t240 = t189 * t91;
  t241 = t188 * t240;
  t244 = my_piecewise3(t55, 0, 0.4e2 / 0.243e3 * t224);
  t245 = my_piecewise3(t57, t244, 0);
  t248 = t118 * t91;
  t250 = t89 * t248 * t199;
  t251 = t96 * t91;
  t252 = t188 * t251;
  t254 = t173 * t238;
  t256 = t206 * t91;
  t257 = t205 * t256;
  t260 = my_piecewise5(t52, 0, t55, 0, -t89 * t245 * t98 + t234 * t236 + t239 * t241 + t239 * t252 - t254 * t241 - t254 * t257 - t250);
  t262 = -0.5e1 / 0.27e2 * t224 + 0.4e2 / 0.243e3 * t227 - 0.5e1 / 0.81e2 * t230 + t87 * t121 + t47 * t260;
  t267 = my_piecewise3(t3, 0, t8 * t73 * t123 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t262);
  tv2rhosigma0 = 0.2e1 * rho[0] * t267 + 0.2e1 * t127;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t278 = t182 * t136;
  t279 = t205 * t278;
  t281 = t136 * t176;
  t282 = t89 * t281;
  t285 = my_piecewise3(t55, 0, -0.25e2 / 0.162e3 * t111);
  t286 = my_piecewise3(t57, t285, 0);
  t289 = t136 * t91;
  t291 = t89 * t289 * t199;
  t293 = t173 * t281;
  t297 = my_piecewise5(t52, 0, t55, 0, -t89 * t286 * t98 + t234 * t279 + t282 * t241 - t293 * t241 + t282 * t252 - t293 * t257 - t291);
  t299 = -0.25e2 / 0.162e3 * t114 + 0.5e1 / 0.54e2 * t30 * t129 * t100 + t87 * t139 + t47 * t297;
  t304 = my_piecewise3(t3, 0, t8 * t73 * t141 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t299);
  tv2rholapl0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t308 = t30 * t110 * t121;
  t310 = t118 * t118;
  t313 = t310 * t176;
  t316 = my_piecewise3(t55, 0, 0);
  t317 = my_piecewise3(t57, t316, 0);
  t319 = t89 * t317 * t98;
  t320 = t89 * t310;
  t321 = t320 * t199;
  t323 = t173 * t313;
  t327 = my_piecewise5(t52, 0, t55, 0, t173 * t310 * t184 + t89 * t313 * t190 - t323 * t190 + t320 * t201 - t323 * t207 - t319 - t321);
  t329 = -0.1e2 / 0.81e2 * t308 + t47 * t327;
  t333 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t329);
  tv2sigma20 = 0.2e1 * rho[0] * t333;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t339 = t30 * t110 * t139;
  t343 = t188 * t189 * t118;
  t345 = t136 * t118;
  t346 = t89 * t345;
  t347 = t346 * t199;
  t348 = t96 * t118;
  t349 = t188 * t348;
  t352 = t206 * t118;
  t353 = t205 * t352;
  t356 = my_piecewise5(t52, 0, t55, 0, t254 * t279 + t282 * t343 + t282 * t349 - t293 * t343 - t293 * t353 - t319 - t347);
  t358 = 0.5e1 / 0.54e2 * t30 * t129 * t121 - 0.5e1 / 0.81e2 * t339 + t47 * t356;
  t362 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t358);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t362;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  t367 = t136 * t136;
  t370 = t367 * t176;
  t373 = t89 * t367;
  t374 = t373 * t199;
  t376 = t173 * t370;
  t380 = my_piecewise5(t52, 0, t55, 0, t173 * t367 * t184 + t89 * t370 * t190 - t376 * t190 + t373 * t201 - t376 * t207 - t319 - t374);
  t382 = 0.5e1 / 0.27e2 * t30 * t129 * t139 + t47 * t380;
  t386 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t382);
  tv2lapl20 = 0.2e1 * rho[0] * t386;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  t391 = t21 / t22 / t34;
  t403 = 0.1e1 / t23 / t157 / rho[0];
  t405 = t30 * t33 * t403;
  t411 = -0.11e4 / 0.729e3 * t30 * t40 * t159 + 0.616e4 / 0.2187e4 * t405;
  t417 = t182 * t193;
  t423 = t64 / t171 / t60;
  t424 = t174 * t91;
  t425 = t176 * t93;
  t426 = t424 * t425;
  t427 = t423 * t426;
  t429 = 0.1e1 / t177 / t59;
  t430 = t180 * t62;
  t431 = t429 * t430;
  t433 = 0.1e1 / t181 / t63;
  t434 = t433 * params->csk_a;
  t435 = t431 * t434;
  t438 = t173 * t426;
  t439 = t429 * t180;
  t440 = params->csk_a * params->csk_a;
  t441 = t182 * t440;
  t442 = t439 * t441;
  t445 = t193 * t91;
  t447 = t89 * t445 * t199;
  t451 = t433 * t440;
  t452 = t431 * t451;
  t455 = t429 * params->csk_a;
  t456 = t455 * t97;
  t459 = t89 * t426;
  t462 = t424 * t93;
  t464 = t182 * t197;
  t465 = t205 * t464;
  t466 = t173 * t462 * t465;
  t468 = t193 * t176;
  t472 = t424 * t197;
  t474 = t96 * t93;
  t475 = t188 * t474;
  t476 = t89 * t472 * t475;
  t478 = t439 * t206;
  t481 = t429 * t62;
  t482 = t96 * t440;
  t483 = t481 * t482;
  t485 = 0.3e1 * t234 * t205 * t417 + 0.3e1 * t89 * t468 * t252 + 0.3e1 * t427 * t435 - 0.3e1 * t427 * t442 - 0.2e1 * t427 * t452 + 0.3e1 * t427 * t478 + 0.3e1 * t438 * t442 + 0.3e1 * t438 * t456 - 0.3e1 * t459 * t456 - t459 * t483 - 0.3e1 * t447 + 0.3e1 * t466 + 0.3e1 * t476;
  t490 = t425 * t429;
  t491 = t430 * t433;
  t492 = t490 * t491;
  t494 = my_piecewise3(t55, 0, t411);
  t495 = my_piecewise3(t57, t494, 0);
  t499 = t490 * t183;
  t503 = t490 * t97;
  t506 = t173 * t468;
  t509 = t173 * t472;
  t510 = t178 * params->csk_a;
  t512 = t93 * t62 * t96;
  t513 = t510 * t512;
  t514 = t509 * t513;
  t517 = t189 * t197;
  t518 = t188 * t517;
  t519 = t89 * t462 * t518;
  t522 = t189 * t193;
  t523 = t188 * t522;
  t529 = t205 * t206 * t93;
  t530 = t509 * t529;
  t532 = -0.3e1 * t173 * t424 * t499 + 0.3e1 * t89 * t233 * t523 - t423 * t424 * t492 - 0.2e1 * t89 * t424 * t503 - t89 * t495 * t98 - 0.3e1 * t506 * t241 - 0.3e1 * t506 * t257 - t427 * t483 + 0.3e1 * t438 * t483 - t200 - 0.3e1 * t514 + 0.3e1 * t519 - 0.3e1 * t530;
  t534 = my_piecewise5(t52, 0, t55, 0, t485 + t532);
  t536 = -0.77e3 / 0.243e3 * t405 + t411 * t65 + 0.3e1 * t167 * t100 + 0.3e1 * t87 * t210 + t47 * t534;
  t541 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t391 * t67 - t8 * t150 * t102 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t73 * t212 + 0.3e1 / 0.2e2 * t8 * t24 * t536);
  tv3rho30 = 0.2e1 * rho[0] * t541 + 0.6e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t551 = t32 * t159;
  t552 = t30 * t551;
  t555 = t30 * t551 * t65;
  t558 = t30 * t223 * t100;
  t561 = t30 * t110 * t210;
  t566 = t174 * t425;
  t567 = t173 * t566;
  t568 = t439 * t235;
  t571 = t118 * t425;
  t572 = t89 * t571;
  t573 = t96 * t174;
  t574 = t481 * t573;
  t577 = t245 * t176;
  t578 = t89 * t577;
  t582 = t182 * t245;
  t583 = t205 * t582;
  t586 = t423 * t566;
  t587 = t433 * t118;
  t590 = t245 * t91;
  t592 = t89 * t590 * t199;
  t596 = t89 * t118 * t193 * t199;
  t597 = t96 * t193;
  t598 = t188 * t597;
  t601 = my_piecewise3(t55, 0, -0.44e3 / 0.729e3 * t552);
  t602 = my_piecewise3(t57, t601, 0);
  t605 = t118 * t174;
  t606 = t605 * t197;
  t607 = t173 * t606;
  t608 = t607 * t529;
  t610 = t118 * t93;
  t611 = t610 * t178;
  t612 = t89 * t611;
  t613 = params->csk_a * t174;
  t614 = t613 * t197;
  t615 = t97 * t614;
  t616 = t612 * t615;
  t618 = t607 * t513;
  t620 = t439 * t352;
  t623 = t482 * t174;
  t624 = t481 * t623;
  t626 = -t586 * t431 * t587 - t89 * t602 * t98 + 0.2e1 * t234 * t583 + t506 * t236 + t239 * t598 + 0.2e1 * t578 * t252 - 0.3e1 * t567 * t568 - 0.2e1 * t572 * t574 - t572 * t624 + 0.3e1 * t586 * t620 - t250 - 0.2e1 * t592 - t596 - 0.3e1 * t608 + 0.3e1 * t616 - 0.3e1 * t618;
  t627 = t173 * t571;
  t630 = t423 * t571;
  t632 = t173 * t577;
  t635 = t174 * t93;
  t636 = t173 * t635;
  t637 = t235 * t197;
  t638 = t205 * t637;
  t639 = t636 * t638;
  t643 = t197 * t178 * t512;
  t644 = t89 * t605 * t643;
  t647 = t429 * t440;
  t649 = t174 * t180 * t182;
  t650 = t647 * t649;
  t653 = t206 * t193;
  t654 = t205 * t653;
  t656 = t451 * t174;
  t657 = t431 * t656;
  t667 = t587 * params->csk_a;
  t668 = t431 * t667;
  t671 = t189 * t174;
  t672 = t481 * t671;
  t677 = t239 * t523 + 0.2e1 * t578 * t241 - 0.2e1 * t632 * t241 - t254 * t523 - t254 * t654 - 0.2e1 * t632 * t257 - 0.3e1 * t572 * t672 + 0.3e1 * t586 * t668 + 0.3e1 * t627 * t624 - t630 * t624 + 0.3e1 * t627 * t650 + 0.3e1 * t627 * t672 - 0.3e1 * t630 * t650 - 0.2e1 * t630 * t657 + 0.3e1 * t639 + 0.3e1 * t644;
  t679 = my_piecewise5(t52, 0, t55, 0, t626 + t677);
  t681 = 0.55e2 / 0.81e2 * t552 - 0.44e3 / 0.729e3 * t555 + 0.8e2 / 0.243e3 * t558 - 0.5e1 / 0.81e2 * t561 + t167 * t121 + 0.2e1 * t87 * t260 + t47 * t679;
  t686 = my_piecewise3(t3, 0, -t8 * t150 * t123 / 0.3e2 + t8 * t73 * t262 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t681);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t686 + 0.4e1 * t267;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t704 = t286 * t91;
  t706 = t89 * t704 * t199;
  t709 = t182 * t286;
  t710 = t205 * t709;
  t713 = t433 * t136;
  t714 = t431 * t713;
  t716 = t439 * t278;
  t719 = t136 * t425;
  t720 = t89 * t719;
  t723 = t286 * t176;
  t724 = t89 * t723;
  t730 = t89 * t136 * t193 * t199;
  t732 = my_piecewise3(t55, 0, 0.1e3 / 0.243e3 * t224);
  t733 = my_piecewise3(t57, t732, 0);
  t736 = t423 * t719;
  t738 = t278 * params->csk_a;
  t739 = t439 * t738;
  t743 = t173 * t719;
  t748 = -t89 * t733 * t98 + 0.2e1 * t234 * t710 + 0.2e1 * t724 * t252 + t506 * t279 + t282 * t598 - 0.3e1 * t567 * t716 - 0.2e1 * t720 * t574 - t586 * t714 + 0.3e1 * t586 * t739 - t720 * t624 - t736 * t624 + 0.3e1 * t743 * t624 + 0.3e1 * t743 * t672 - t291 - 0.2e1 * t706 - t730;
  t749 = t173 * t723;
  t752 = t136 * t174;
  t754 = t89 * t752 * t643;
  t756 = t278 * t197;
  t757 = t205 * t756;
  t758 = t636 * t757;
  t766 = t713 * params->csk_a;
  t767 = t431 * t766;
  t779 = t752 * t197;
  t780 = t173 * t779;
  t781 = t780 * t529;
  t784 = t136 * t93 * t178;
  t785 = t89 * t784;
  t786 = t785 * t615;
  t788 = t780 * t513;
  t790 = 0.2e1 * t724 * t241 - 0.2e1 * t749 * t241 - 0.2e1 * t749 * t257 + t282 * t523 - t293 * t523 - t293 * t654 + 0.3e1 * t586 * t767 - 0.3e1 * t736 * t650 + 0.3e1 * t743 * t650 - 0.2e1 * t736 * t657 - 0.3e1 * t720 * t672 + 0.3e1 * t754 + 0.3e1 * t758 - 0.3e1 * t781 + 0.3e1 * t786 - 0.3e1 * t788;
  t792 = my_piecewise5(t52, 0, t55, 0, t748 + t790);
  t794 = 0.1e3 / 0.243e3 * t227 - 0.25e2 / 0.81e2 * t230 + 0.5e1 / 0.54e2 * t30 * t129 * t210 + t167 * t139 + 0.2e1 * t87 * t297 + t47 * t792;
  t799 = my_piecewise3(t3, 0, -t8 * t150 * t141 / 0.3e2 + t8 * t73 * t299 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t794);
  tv3rho2lapl0 = 0.2e1 * rho[0] * t799 + 0.4e1 * t304;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t806 = t30 * t223 * t121;
  t809 = t30 * t110 * t260;
  t812 = t182 * t317;
  t813 = t205 * t812;
  t814 = t234 * t813;
  t815 = t317 * t91;
  t817 = t89 * t815 * t199;
  t818 = t118 * t197;
  t819 = t89 * t818;
  t820 = t94 * t62;
  t821 = t96 * t245;
  t823 = t819 * t820 * t821;
  t824 = 0.2e1 * t823;
  t825 = t188 * t821;
  t830 = t91 * t425;
  t831 = t423 * t830;
  t832 = t433 * t310;
  t833 = t431 * t832;
  t835 = t317 * t176;
  t836 = t89 * t835;
  t837 = t836 * t252;
  t838 = t310 * t425;
  t839 = t89 * t838;
  t840 = t481 * t251;
  t843 = t173 * t838;
  t844 = t182 * t91;
  t845 = t439 * t844;
  t848 = t310 * t197;
  t850 = t173 * t848 * t178;
  t851 = params->csk_a * t91;
  t852 = t851 * t512;
  t853 = t850 * t852;
  t855 = t310 * t93;
  t857 = t89 * t855 * t178;
  t858 = t851 * t197;
  t859 = t97 * t858;
  t860 = t857 * t859;
  t862 = t851 * t93;
  t863 = t183 * t862;
  t864 = t850 * t863;
  t866 = t89 * t848;
  t868 = t188 * t251 * t93;
  t869 = t866 * t868;
  t871 = t97 * t245;
  t872 = t510 * t871;
  t875 = 0.2e1 * t239 * t825 + 0.2e1 * t254 * t583 - 0.2e1 * t254 * t872 - t831 * t833 - 0.2e1 * t839 * t840 - 0.3e1 * t843 * t845 - t319 - t321 + t814 - t817 - t824 + t837 - 0.3e1 * t853 + 0.3e1 * t860 - 0.3e1 * t864 + 0.3e1 * t869;
  t876 = t423 * t838;
  t877 = t183 * t91;
  t878 = t647 * t877;
  t881 = t206 * t245;
  t882 = t205 * t881;
  t885 = t173 * t855;
  t886 = t844 * t197;
  t887 = t205 * t886;
  t888 = t885 * t887;
  t890 = t434 * t91;
  t891 = t431 * t890;
  t896 = t439 * t256;
  t899 = t482 * t91;
  t900 = t481 * t899;
  t905 = t836 * t241;
  t906 = t173 * t835;
  t907 = t906 * t241;
  t909 = t91 * t62 * t96;
  t910 = t455 * t909;
  t915 = t451 * t91;
  t916 = t431 * t915;
  t921 = t906 * t257;
  t922 = 0.2e1 * t239 * t872 - 0.2e1 * t254 * t882 - t839 * t900 - 0.3e1 * t839 * t910 + 0.3e1 * t843 * t878 + 0.3e1 * t843 * t900 + 0.3e1 * t843 * t910 - 0.3e1 * t876 * t878 + 0.3e1 * t876 * t891 + 0.3e1 * t876 * t896 - t876 * t900 - 0.2e1 * t876 * t916 + 0.3e1 * t888 + t905 - t907 - t921;
  t924 = my_piecewise5(t52, 0, t55, 0, t875 + t922);
  t926 = 0.8e2 / 0.243e3 * t806 - 0.1e2 / 0.81e2 * t809 + t87 * t327 + t47 * t924;
  t931 = my_piecewise3(t3, 0, t8 * t73 * t329 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t926);
  tv3rhosigma20 = 0.2e1 * rho[0] * t931 + 0.2e1 * t333;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t942 = t30 * t223 * t139;
  t945 = t30 * t110 * t297;
  t952 = t286 * t118;
  t954 = t89 * t952 * t199;
  t955 = t136 * t245;
  t957 = t89 * t955 * t199;
  t958 = t345 * t197;
  t959 = t173 * t958;
  t960 = t205 * t182;
  t961 = t960 * t862;
  t962 = t959 * t961;
  t965 = t510 * t91 * t512;
  t966 = t959 * t965;
  t968 = t97 * params->csk_a;
  t969 = t248 * t197;
  t971 = t785 * t968 * t969;
  t973 = t719 * t429;
  t974 = t89 * t973;
  t975 = t440 * t118;
  t976 = t975 * t91;
  t977 = t97 * t976;
  t979 = t173 * t973;
  t982 = t97 * t118;
  t983 = t851 * t982;
  t986 = t423 * t973;
  t987 = t975 * t877;
  t990 = t491 * t976;
  t993 = t254 * t710 + t632 * t279 + t282 * t825 + t724 * t349 - t974 * t977 + 0.3e1 * t979 * t977 + 0.3e1 * t979 * t983 - 0.3e1 * t986 * t987 - 0.2e1 * t986 * t990 - t319 - t347 + t814 - t817 + t837 - t954 - t957 - 0.3e1 * t962 - 0.3e1 * t966 + 0.3e1 * t971;
  t994 = t173 * t611;
  t995 = t289 * t197;
  t996 = t183 * t995;
  t997 = t994 * t996;
  t999 = t571 * t429;
  t1000 = t423 * t999;
  t1001 = t136 * params->csk_a;
  t1002 = t1001 * t91;
  t1003 = t491 * t1002;
  t1008 = t89 * t958;
  t1009 = t1008 * t868;
  t1014 = t183 * t1002;
  t1017 = t348 * t91;
  t1018 = t481 * t1017;
  t1021 = t278 * t91;
  t1022 = t439 * t1021;
  t1029 = t587 * t136;
  t1030 = t431 * t1029;
  t1034 = 0.3e1 * t1000 * t1003 + 0.3e1 * t1000 * t1014 - 0.2e1 * t720 * t1018 - 0.3e1 * t627 * t1022 - t831 * t1030 + t282 * t872 - t293 * t872 - t293 * t882 + t724 * t343 - t749 * t343 - t749 * t353 - 0.3e1 * t974 * t983 - t986 * t977 + 0.3e1 * t979 * t987 + 0.3e1 * t1009 + t905 - t907 - t921 + 0.3e1 * t997;
  t1036 = my_piecewise5(t52, 0, t55, 0, t993 + t1034);
  t1038 = -0.25e2 / 0.162e3 * t308 + 0.5e1 / 0.54e2 * t30 * t129 * t260 + 0.4e2 / 0.243e3 * t942 - 0.5e1 / 0.81e2 * t945 + t87 * t356 + t47 * t1036;
  t1043 = my_piecewise3(t3, 0, t8 * t73 * t358 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1038);
  tv3rhosigmalapl0 = 0.2e1 * rho[0] * t1043 + 0.2e1 * t362;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  t1056 = t433 * t367;
  t1057 = t431 * t1056;
  t1059 = t136 * t197;
  t1060 = t89 * t1059;
  t1061 = t96 * t286;
  t1063 = t1060 * t820 * t1061;
  t1064 = 0.2e1 * t1063;
  t1068 = t367 * t425;
  t1069 = t173 * t1068;
  t1072 = t89 * t1068;
  t1075 = t367 * t197;
  t1077 = t173 * t1075 * t178;
  t1078 = t1077 * t852;
  t1080 = t367 * t93;
  t1082 = t89 * t1080 * t178;
  t1083 = t1082 * t859;
  t1085 = t1077 * t863;
  t1087 = t89 * t1075;
  t1088 = t1087 * t868;
  t1090 = t97 * t286;
  t1091 = t510 * t1090;
  t1094 = 0.2e1 * t282 * t188 * t1061 - t831 * t1057 - 0.3e1 * t1069 * t845 - 0.2e1 * t1072 * t840 - 0.2e1 * t293 * t1091 + 0.2e1 * t293 * t710 - t1064 - 0.3e1 * t1078 + 0.3e1 * t1083 - 0.3e1 * t1085 + 0.3e1 * t1088 - t319 - t374 + t814 - t817 + t837;
  t1095 = t423 * t1068;
  t1098 = t206 * t286;
  t1114 = t173 * t1080;
  t1115 = t1114 * t887;
  t1123 = -0.2e1 * t293 * t205 * t1098 + 0.3e1 * t1069 * t878 + 0.3e1 * t1069 * t900 + 0.3e1 * t1069 * t910 - t1072 * t900 - 0.3e1 * t1072 * t910 + 0.2e1 * t282 * t1091 - 0.3e1 * t1095 * t878 + 0.3e1 * t1095 * t891 + 0.3e1 * t1095 * t896 - t1095 * t900 - 0.2e1 * t1095 * t916 + 0.3e1 * t1115 + t905 - t907 - t921;
  t1125 = my_piecewise5(t52, 0, t55, 0, t1094 + t1123);
  t1127 = -0.25e2 / 0.81e2 * t339 + 0.5e1 / 0.27e2 * t30 * t129 * t297 + t87 * t380 + t47 * t1125;
  t1132 = my_piecewise3(t3, 0, t8 * t73 * t382 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1127);
  tv3rholapl20 = 0.2e1 * rho[0] * t1132 + 0.2e1 * t386;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  t1136 = t30 * t110 * t327;
  t1138 = t310 * t118;
  t1139 = t1138 * t93;
  t1141 = t173 * t1139 * t465;
  t1142 = 0.3e1 * t1141;
  t1143 = t836 * t349;
  t1144 = 0.3e1 * t1143;
  t1145 = t1138 * t197;
  t1146 = t89 * t1145;
  t1147 = t1146 * t475;
  t1148 = 0.3e1 * t1147;
  t1149 = t1138 * t425;
  t1150 = t423 * t1149;
  t1155 = t254 * t813;
  t1156 = 0.3e1 * t1155;
  t1159 = t173 * t1149;
  t1162 = t317 * t118;
  t1164 = t89 * t1162 * t199;
  t1165 = 0.3e1 * t1164;
  t1168 = t89 * t1149;
  t1173 = 0.3e1 * t1150 * t435 - 0.3e1 * t1150 * t442 - 0.2e1 * t1150 * t452 + 0.3e1 * t1150 * t478 - t1150 * t483 + 0.3e1 * t1159 * t442 + 0.3e1 * t1159 * t483 - t1168 * t483 + t1142 + t1144 + t1148 + t1156 - t1165;
  t1186 = t189 * t317;
  t1187 = t188 * t1186;
  t1188 = t239 * t1187;
  t1189 = 0.3e1 * t1188;
  t1190 = t906 * t353;
  t1191 = 0.3e1 * t1190;
  t1192 = t173 * t1145;
  t1193 = t1192 * t529;
  t1194 = 0.3e1 * t1193;
  t1195 = t906 * t343;
  t1196 = 0.3e1 * t1195;
  t1197 = t1192 * t513;
  t1198 = 0.3e1 * t1197;
  t1200 = t89 * t1139 * t518;
  t1201 = 0.3e1 * t1200;
  t1202 = -0.3e1 * t173 * t1138 * t499 - t423 * t1138 * t492 - 0.2e1 * t89 * t1138 * t503 + 0.3e1 * t1159 * t456 - 0.3e1 * t1168 * t456 + t1189 - t1191 - t1194 - t1196 - t1198 + t1201 - t319 - t321;
  t1204 = my_piecewise5(t52, 0, t55, 0, t1173 + t1202);
  t1206 = -0.5e1 / 0.27e2 * t1136 + t47 * t1204;
  t1210 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1206);
  tv3sigma30 = 0.2e1 * rho[0] * t1210;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1216 = t30 * t110 * t356;
  t1218 = t906 * t279;
  t1220 = t136 * t317;
  t1222 = t89 * t1220 * t199;
  t1223 = t96 * t317;
  t1224 = t188 * t1223;
  t1225 = t282 * t1224;
  t1228 = t96 * t310;
  t1229 = t481 * t1228;
  t1232 = 0.2e1 * t1143;
  t1233 = 0.2e1 * t1155;
  t1234 = 0.2e1 * t1164;
  t1235 = t136 * t310;
  t1236 = t1235 * t197;
  t1237 = t173 * t1236;
  t1238 = t1237 * t513;
  t1239 = 0.3e1 * t1238;
  t1240 = t1237 * t529;
  t1241 = 0.3e1 * t1240;
  t1242 = params->csk_a * t310;
  t1243 = t1242 * t197;
  t1244 = t97 * t1243;
  t1245 = t785 * t1244;
  t1246 = 0.3e1 * t1245;
  t1247 = t189 * t310;
  t1248 = t481 * t1247;
  t1253 = -0.2e1 * t720 * t1229 - 0.3e1 * t720 * t1248 - t876 * t714 - 0.3e1 * t843 * t716 + 0.3e1 * t876 * t739 + t1218 - t1222 + t1225 + t1232 + t1233 - t1234 - t1239 - t1241 + t1246 - t319 - t347;
  t1254 = t482 * t310;
  t1255 = t481 * t1254;
  t1262 = t647 * t310 * t180 * t182;
  t1265 = t206 * t317;
  t1266 = t205 * t1265;
  t1267 = t293 * t1266;
  t1268 = t451 * t310;
  t1269 = t431 * t1268;
  t1274 = t282 * t1187;
  t1279 = t885 * t757;
  t1280 = 0.3e1 * t1279;
  t1281 = t89 * t1235;
  t1282 = t1281 * t643;
  t1283 = 0.3e1 * t1282;
  t1284 = 0.2e1 * t1188;
  t1285 = 0.2e1 * t1190;
  t1286 = 0.2e1 * t1195;
  t1287 = t293 * t1187;
  t1288 = 0.3e1 * t743 * t1248 - t720 * t1255 - t736 * t1255 + 0.3e1 * t743 * t1255 - 0.3e1 * t736 * t1262 + 0.3e1 * t743 * t1262 - 0.2e1 * t736 * t1269 + 0.3e1 * t876 * t767 - t1267 + t1274 + t1280 + t1283 + t1284 - t1285 - t1286 - t1287;
  t1290 = my_piecewise5(t52, 0, t55, 0, t1253 + t1288);
  t1292 = 0.5e1 / 0.54e2 * t30 * t129 * t327 - 0.1e2 / 0.81e2 * t1216 + t47 * t1290;
  t1296 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1292);
  tv3sigma2lapl0 = 0.2e1 * rho[0] * t1296;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  t1302 = t30 * t110 * t380;
  t1304 = 0.2e1 * t1218;
  t1305 = 0.2e1 * t1222;
  t1306 = 0.2e1 * t1225;
  t1313 = params->csk_a * t118;
  t1314 = t1313 * t197;
  t1315 = t97 * t1314;
  t1316 = t1082 * t1315;
  t1317 = 0.3e1 * t1316;
  t1318 = t1313 * t93;
  t1320 = t1077 * t183 * t1318;
  t1321 = 0.3e1 * t1320;
  t1323 = t1077 * t1313 * t512;
  t1324 = 0.3e1 * t1323;
  t1327 = t482 * t118;
  t1328 = t481 * t1327;
  t1330 = -0.2e1 * t1072 * t481 * t348 - t630 * t1057 - 0.3e1 * t1069 * t568 - t1072 * t1328 + 0.3e1 * t1095 * t620 + t1143 + t1155 - t1164 + t1304 - t1305 + t1306 + t1317 - t1321 - t1324 - t319 - t374;
  t1334 = t455 * t982;
  t1339 = t451 * t118;
  t1343 = t441 * t118;
  t1344 = t439 * t1343;
  t1348 = t188 * t348 * t93;
  t1349 = t1087 * t1348;
  t1350 = 0.3e1 * t1349;
  t1353 = t1114 * t638;
  t1354 = 0.3e1 * t1353;
  t1357 = 0.2e1 * t1267;
  t1358 = 0.2e1 * t1274;
  t1359 = 0.2e1 * t1287;
  t1360 = -0.2e1 * t1095 * t431 * t1339 + 0.3e1 * t1069 * t1328 + 0.3e1 * t1069 * t1334 + 0.3e1 * t1069 * t1344 - 0.3e1 * t1072 * t1334 - t1095 * t1328 - 0.3e1 * t1095 * t1344 + 0.3e1 * t1095 * t668 + t1188 - t1190 - t1195 + t1350 + t1354 - t1357 + t1358 - t1359;
  t1362 = my_piecewise5(t52, 0, t55, 0, t1330 + t1360);
  t1364 = 0.5e1 / 0.27e2 * t30 * t129 * t356 - 0.5e1 / 0.81e2 * t1302 + t47 * t1362;
  t1368 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1364);
  tv3sigmalapl20 = 0.2e1 * rho[0] * t1368;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  t1373 = t367 * t136;
  t1374 = t1373 * t425;
  t1375 = t89 * t1374;
  t1378 = t423 * t1374;
  t1385 = t173 * t1374;
  t1388 = t1373 * t93;
  t1390 = t173 * t1388 * t465;
  t1391 = 0.3e1 * t1390;
  t1392 = 0.3e1 * t1218;
  t1393 = 0.3e1 * t1222;
  t1394 = 0.3e1 * t1225;
  t1403 = -0.3e1 * t173 * t1373 * t499 - t423 * t1373 * t492 - 0.2e1 * t89 * t1373 * t503 - 0.3e1 * t1375 * t456 + 0.3e1 * t1378 * t435 - 0.3e1 * t1378 * t442 - 0.2e1 * t1378 * t452 + 0.3e1 * t1385 * t442 + t1391 + t1392 - t1393 + t1394 - t374;
  t1404 = t1373 * t197;
  t1405 = t173 * t1404;
  t1406 = t1405 * t513;
  t1407 = 0.3e1 * t1406;
  t1409 = t89 * t1388 * t518;
  t1410 = 0.3e1 * t1409;
  t1411 = t1405 * t529;
  t1412 = 0.3e1 * t1411;
  t1413 = 0.3e1 * t1267;
  t1414 = 0.3e1 * t1274;
  t1415 = 0.3e1 * t1287;
  t1416 = t89 * t1404;
  t1417 = t1416 * t475;
  t1418 = 0.3e1 * t1417;
  t1427 = -t1375 * t483 + 0.3e1 * t1378 * t478 - t1378 * t483 + 0.3e1 * t1385 * t456 + 0.3e1 * t1385 * t483 - t1407 + t1410 - t1412 - t1413 + t1414 - t1415 + t1418 - t319;
  t1429 = my_piecewise5(t52, 0, t55, 0, t1403 + t1427);
  t1431 = 0.5e1 / 0.18e2 * t30 * t129 * t380 + t47 * t1429;
  t1435 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1431);
  tv3lapl30 = 0.2e1 * rho[0] * t1435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  t1457 = t30 * t33 / t23 / t157 / t34;
  t1463 = 0.154e5 / 0.2187e4 * t30 * t40 * t403 - 0.10472e6 / 0.6561e4 * t1457;
  t1474 = t193 * t193;
  t1475 = t89 * t1474;
  t1478 = t174 * t174;
  t1479 = t89 * t1478;
  t1480 = t197 * t197;
  t1481 = t1480 * t178;
  t1482 = t1481 * t97;
  t1485 = t176 * t176;
  t1486 = t177 * t177;
  t1487 = 0.1e1 / t1486;
  t1488 = t1485 * t1487;
  t1489 = t1488 * t97;
  t1492 = t173 * t1478;
  t1493 = t1488 * t183;
  t1497 = t1488 * t491;
  t1500 = t1481 * t183;
  t1503 = t171 * t171;
  t1505 = t64 / t1503;
  t1507 = t180 * t180;
  t1508 = t181 * t181;
  t1509 = 0.1e1 / t1508;
  t1510 = t1507 * t1509;
  t1511 = t1488 * t1510;
  t1514 = my_piecewise3(t55, 0, t1463);
  t1515 = my_piecewise3(t57, t1514, 0);
  t1526 = t193 * t93;
  t1528 = t173 * t1526 * t178;
  t1531 = t183 * t614;
  t1536 = params->csk_a * t197;
  t1538 = t97 * t1536 * t193;
  t1541 = t193 * t425;
  t1542 = t173 * t1541;
  t1545 = 0.18e2 * t89 * t635 * t178 * t1538 + 0.3e1 * t173 * t1474 * t184 - t89 * t1515 * t98 - 0.3e1 * t1475 * t199 - 0.18e2 * t1528 * t1531 - 0.18e2 * t1528 * t615 + 0.18e2 * t1542 * t672 - t200 - 0.4e1 * t514 + 0.4e1 * t519 - 0.4e1 * t530;
  t1547 = t1478 * t197;
  t1548 = t173 * t1547;
  t1550 = t176 * t62 * t96;
  t1551 = t455 * t1550;
  t1554 = t1478 * t176;
  t1555 = t89 * t1554;
  t1556 = t481 * t517;
  t1559 = t89 * t566;
  t1561 = t481 * t482 * t193;
  t1566 = t423 * t1541;
  t1569 = t647 * t1550;
  t1572 = t423 * t1547;
  t1576 = t481 * t482 * t197;
  t1579 = t495 * t176;
  t1580 = t173 * t1579;
  t1584 = t205 * t464 * t193;
  t1588 = t423 * t1554;
  t1589 = t433 * t197;
  t1591 = t431 * t1589 * params->csk_a;
  t1596 = t439 * t653;
  t1602 = t439 * t464 * params->csk_a;
  t1606 = t176 * t180 * t182;
  t1607 = t647 * t1606;
  t1610 = t89 * t1579;
  t1614 = t431 * t451 * t176;
  t1618 = t439 * t441 * t193;
  t1621 = t433 * t193;
  t1623 = t431 * t1621 * params->csk_a;
  t1628 = -0.18e2 * t1566 * t650 - 0.12e2 * t1566 * t657 - 0.18e2 * t1572 * t1607 - 0.12e2 * t1572 * t1614 - 0.4e1 * t1580 * t241 + 0.18e2 * t1588 * t1591 + 0.18e2 * t1588 * t1602 + 0.18e2 * t586 * t1596 + 0.4e1 * t1610 * t241 + 0.18e2 * t567 * t1618 + 0.18e2 * t586 * t1623;
  t1631 = t173 * t1554;
  t1633 = t439 * t441 * t197;
  t1636 = t481 * t522;
  t1644 = t1478 * t1480;
  t1645 = t173 * t1644;
  t1648 = t439 * t464;
  t1655 = t96 * t176;
  t1656 = t481 * t1655;
  t1661 = t1478 * t1485;
  t1662 = t173 * t1661;
  t1663 = t1487 * params->csk_a;
  t1664 = t1663 * t97;
  t1671 = t89 * t1661;
  t1674 = t423 * t1661;
  t1675 = t1487 * t430;
  t1676 = t440 * params->csk_a;
  t1677 = t433 * t1676;
  t1678 = t1675 * t1677;
  t1681 = t1505 * t1661;
  t1684 = t1487 * t1507;
  t1685 = t1509 * t1676;
  t1686 = t1684 * t1685;
  t1689 = t1675 * t451;
  t1692 = t1487 * t180;
  t1693 = t182 * t1676;
  t1694 = t1692 * t1693;
  t1702 = t1684 * t1509 * t440;
  t1705 = t439 * t417;
  t1708 = t1692 * t206;
  t1711 = -0.7e1 * t1662 * t1694 + 0.11e2 * t1671 * t1664 + 0.12e2 * t1674 * t1678 + 0.18e2 * t1674 * t1694 - 0.18e2 * t1674 * t1708 - 0.12e2 * t1681 * t1678 - 0.6e1 * t1681 * t1686 + 0.18e2 * t1681 * t1689 - 0.7e1 * t1681 * t1694 + 0.11e2 * t1681 * t1702 - 0.18e2 * t567 * t1705;
  t1715 = t1692 * t441;
  t1721 = t1509 * params->csk_a;
  t1722 = t1684 * t1721;
  t1733 = t1474 * t176;
  t1737 = t173 * t1733;
  t1740 = t431 * t1589;
  t1747 = 0.4e1 * t234 * t205 * t182 * t495 - 0.4e1 * t89 * t495 * t91 * t199 - 0.6e1 * t586 * t431 * t1621 + 0.3e1 * t89 * t1733 * t190 - 0.6e1 * t1588 * t1740 + 0.4e1 * t1610 * t252 + 0.7e1 * t1662 * t1708 - 0.11e2 * t1662 * t1715 - 0.6e1 * t1681 * t1722 - 0.3e1 * t1737 * t190 - 0.3e1 * t1737 * t207;
  t1748 = t1487 * t1676;
  t1749 = t1748 * t97;
  t1757 = t1487 * t440;
  t1758 = t1757 * t97;
  t1765 = t1675 * t434;
  t1773 = -0.7e1 * t1662 * t1749 - 0.18e2 * t1662 * t1758 + t1671 * t1749 + 0.6e1 * t1671 * t1758 - 0.6e1 * t1674 * t1689 + 0.6e1 * t1674 * t1749 + 0.6e1 * t1674 * t1758 - 0.12e2 * t1674 * t1765 + 0.7e1 * t1681 * t1715 - t1681 * t1749 - 0.6e1 * t1681 * t1765;
  t1777 = my_piecewise5(t52, 0, t55, 0, t1711 + t1628 + t1545 + 0.18e2 * t89 * t1526 * t188 * t573 * t197 + 0.4e1 * t476 + 0.4e1 * t466 - 0.5e1 * t447 + t1773 + t1747 - 0.18e2 * t1631 * t1648 - 0.3e1 * t1645 * t190 - 0.11e2 * t1662 * t1664 - 0.3e1 * t1645 * t207 + 0.18e2 * t1631 * t1633 - 0.18e2 * t1559 * t1636 - 0.6e1 * t1566 * t624 + 0.18e2 * t1548 * t1569 - 0.6e1 * t1572 * t1569 - 0.6e1 * t1555 * t1576 - 0.4e1 * t1580 * t257 + 0.18e2 * t636 * t1584 + 0.18e2 * t1548 * t1551 - 0.18e2 * t1555 * t1556 - 0.6e1 * t1559 * t1561 + 0.18e2 * t1542 * t624 + 0.3e1 * t1492 * t1500 + 0.3e1 * t1475 * t201 + 0.3e1 * t1479 * t1482 + 0.6e1 * t1479 * t1489 + 0.11e2 * t1492 * t1493 + 0.6e1 * t423 * t1478 * t1497 + t1505 * t1478 * t1511 - 0.12e2 * t89 * t1541 * t574 - 0.12e2 * t89 * t1547 * t1656 + 0.3e1 * t89 * t1644 * t190);
  t1784 = my_piecewise3(t3, 0, -0.14e2 / 0.135e3 * t8 * t21 / t22 / t77 * t67 + 0.8e1 / 0.45e2 * t8 * t391 * t102 - t8 * t150 * t212 / 0.5e1 + 0.2e1 / 0.5e1 * t8 * t73 * t536 + 0.3e1 / 0.2e2 * t8 * t24 * (0.1309e5 / 0.729e3 * t1457 + t1463 * t65 + 0.4e1 * t411 * t100 + 0.6e1 * t167 * t210 + 0.4e1 * t87 * t534 + t47 * t1777));
  tv4rho40 = 0.2e1 * rho[0] * t1784 + 0.8e1 * t541;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1797 = t32 * t403;
  t1798 = t30 * t1797;
  t1820 = my_piecewise3(t55, 0, 0.616e4 / 0.2187e4 * t1798);
  t1821 = my_piecewise3(t57, t1820, 0);
  t1828 = t968 * t445 * t197;
  t1832 = params->csk_a * t93;
  t1833 = t1832 * t193;
  t1834 = t960 * t1833;
  t1839 = t118 * t424;
  t1840 = t1839 * t197;
  t1844 = t173 * t1840;
  t1847 = t173 * t999;
  t1848 = t440 * t193;
  t1849 = t1848 * t909;
  t1852 = -0.18e2 * t89 * t1840 * t1551 - 0.9e1 * t173 * t969 * t1834 - t89 * t1821 * t98 + 0.18e2 * t1844 * t1551 + 0.9e1 * t612 * t1828 - 0.9e1 * t994 * t1828 + 0.9e1 * t1847 * t1849 - t250 - 0.3e1 * t592 - 0.2e1 * t596 - 0.4e1 * t608 + 0.4e1 * t616 - 0.4e1 * t618;
  t1855 = t1848 * t91;
  t1856 = t183 * t1855;
  t1859 = t89 * t999;
  t1862 = t238 * t429;
  t1866 = t97 * t440 * t424 * t197;
  t1870 = t245 * t93 * t178;
  t1874 = params->csk_a * t193;
  t1876 = t97 * t1874 * t91;
  t1881 = t173 * t1870;
  t1885 = t423 * t830 * t429;
  t1886 = t1313 * t193;
  t1890 = t491 * t1855;
  t1893 = t423 * t1840;
  t1903 = t173 * t91 * t93 * t178;
  t1904 = t818 * t193;
  t1908 = 0.9e1 * t1885 * t183 * t1886 + 0.9e1 * t1903 * t183 * t1904 - 0.6e1 * t89 * t1862 * t1866 + 0.9e1 * t89 * t1870 * t615 + 0.9e1 * t1885 * t491 * t1886 - 0.3e1 * t1000 * t1849 - 0.9e1 * t1000 * t1856 - 0.6e1 * t1000 * t1890 - 0.12e2 * t1893 * t1614 + 0.9e1 * t1847 * t1856 + 0.9e1 * t1847 * t1876 - 0.3e1 * t1859 * t1849 - 0.9e1 * t1859 * t1876 - 0.9e1 * t1881 * t615;
  t1910 = t424 * t176;
  t1912 = t423 * t1910 * t429;
  t1913 = t491 * t1314;
  t1918 = t188 * t474 * t193;
  t1921 = t245 * t174;
  t1928 = t173 * t1862;
  t1933 = t183 * t1314;
  t1938 = t245 * t425;
  t1939 = t89 * t1938;
  t1942 = t118 * t1485;
  t1943 = t173 * t1942;
  t1945 = t1692 * t1693 * t424;
  t1949 = t1692 * t441 * t424;
  t1952 = t89 * t1839;
  t1953 = t1481 * t968;
  t1956 = t173 * t1910;
  t1957 = t439 * t637;
  t1961 = t197 * t429 * t1550;
  t1964 = -0.9e1 * t173 * t1921 * t197 * t529 + 0.9e1 * t89 * t969 * t1918 - 0.6e1 * t1893 * t1569 + 0.18e2 * t1844 * t1607 - 0.18e2 * t1893 * t1607 + 0.18e2 * t1928 * t1866 + 0.18e2 * t1912 * t1913 + 0.18e2 * t1912 * t1933 - 0.3e1 * t1939 * t624 - 0.7e1 * t1943 * t1945 - 0.11e2 * t1943 * t1949 + 0.3e1 * t1952 * t1953 - 0.12e2 * t1952 * t1961 - 0.18e2 * t1956 * t1957;
  t1965 = t173 * t1839;
  t1966 = t183 * params->csk_a;
  t1967 = t1481 * t1966;
  t1970 = t423 * t1942;
  t1972 = t1675 * t451 * t424;
  t1975 = t173 * t1938;
  t1978 = t424 * t1485;
  t1979 = t423 * t1978;
  t1980 = t1692 * t352;
  t1985 = t423 * t1938;
  t1988 = t89 * t1942;
  t1989 = t1487 * t62;
  t1991 = t1989 * t482 * t424;
  t1998 = t1505 * t1978;
  t1999 = t1675 * t667;
  t2002 = t96 * t1676;
  t2004 = t1989 * t2002 * t424;
  t2010 = t1505 * t1942;
  t2012 = -0.18e2 * t1943 * t1991 - 0.7e1 * t1943 * t2004 - 0.3e1 * t1965 * t1967 - 0.6e1 * t1970 * t1972 + 0.6e1 * t1970 * t1991 + 0.6e1 * t1970 * t2004 + 0.9e1 * t1975 * t624 + 0.9e1 * t1975 * t672 - 0.18e2 * t1979 * t1980 - 0.3e1 * t1985 * t624 + 0.6e1 * t1988 * t1991 + t1988 * t2004 - 0.6e1 * t1998 * t1999 - t2010 * t2004;
  t2018 = t1675 * t1677 * t424;
  t2021 = t173 * t830;
  t2031 = t602 * t176;
  t2032 = t173 * t2031;
  t2037 = t439 * t881;
  t2040 = t173 * t1978;
  t2043 = t96 * t424;
  t2045 = t1989 * t2043 * params->csk_a;
  t2050 = t1692 * t1343;
  t2055 = -0.9e1 * t2021 * t439 * t235 * t193 + 0.9e1 * t89 * t1921 * t643 - 0.11e2 * t1943 * t2045 + 0.18e2 * t1970 * t1945 - 0.7e1 * t2010 * t1945 + 0.12e2 * t1970 * t2018 - 0.12e2 * t1979 * t1999 + 0.7e1 * t2040 * t1980 + 0.11e2 * t1988 * t2045 + 0.7e1 * t1998 * t2050 - 0.3e1 * t2032 * t241 + 0.9e1 * t586 * t2037 - 0.3e1 * t632 * t523;
  t2056 = t89 * t2031;
  t2063 = t1509 * t118;
  t2065 = t1684 * t2063 * params->csk_a;
  t2069 = t1684 * t1685 * t424;
  t2077 = t188 * t189 * t495;
  t2080 = t481 * t251 * t193;
  t2086 = t1675 * t1339;
  t2093 = -0.9e1 * t1939 * t672 - 0.3e1 * t1965 * t1953 + 0.9e1 * t1975 * t650 - 0.6e1 * t1998 * t2065 + 0.18e2 * t1998 * t2086 - 0.12e2 * t2010 * t2018 - 0.6e1 * t2010 * t2069 - 0.3e1 * t2032 * t257 + 0.3e1 * t2056 * t241 + t239 * t2077 - t254 * t2077 - 0.6e1 * t572 * t2080 + 0.3e1 * t578 * t523 - 0.3e1 * t632 * t654;
  t2096 = t205 * t206 * t495;
  t2107 = t205 * t582 * t197;
  t2110 = t423 * t1910;
  t2112 = t431 * t587 * t197;
  t2119 = t433 * t245;
  t2121 = t431 * t2119 * params->csk_a;
  t2130 = t188 * t96 * t495;
  t2135 = -0.3e1 * t831 * t431 * t1621 * t118 - t89 * t118 * t495 * t199 + 0.11e2 * t1998 * t1684 * t2063 * t440 + t1580 * t236 - 0.9e1 * t1985 * t650 - 0.6e1 * t1985 * t657 - t254 * t2096 + 0.9e1 * t636 * t2107 - 0.6e1 * t2110 * t2112 + 0.9e1 * t586 * t2121 + t239 * t2130 + 0.3e1 * t578 * t598 + 0.4e1 * t639 + 0.4e1 * t644;
  t2138 = t431 * t2119;
  t2149 = t1989 * t2043;
  t2153 = t173 * t424 * t1480;
  t2156 = t1692 * t235;
  t2161 = t439 * t582;
  t2164 = t1675 * t587;
  t2170 = t205 * t182 * t602;
  t2177 = 0.3e1 * t506 * t583 - 0.3e1 * t586 * t2138 + t1998 * t1684 * t2063 - 0.3e1 * t89 * t245 * t193 * t199 + 0.3e1 * t2056 * t252 + 0.6e1 * t1988 * t2149 + 0.3e1 * t2153 * t236 + 0.11e2 * t2040 * t2156 + 0.3e1 * t1952 * t1482 - 0.9e1 * t567 * t2161 + 0.6e1 * t1979 * t2164 - 0.6e1 * t1939 * t574 + 0.3e1 * t234 * t2170 - 0.3e1 * t89 * t602 * t91 * t199;
  t2181 = my_piecewise5(t52, 0, t55, 0, t1852 + t1908 + t1964 + t2012 + t2055 + t2093 + t2135 + t2177);
  t2188 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t391 * t123 - t8 * t150 * t262 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t73 * t681 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.77e3 / 0.243e3 * t1798 + 0.616e4 / 0.2187e4 * t30 * t1797 * t65 - 0.44e3 / 0.243e3 * t30 * t551 * t100 + 0.4e2 / 0.81e2 * t30 * t223 * t210 - 0.5e1 / 0.81e2 * t30 * t110 * t534 + t411 * t121 + 0.3e1 * t167 * t260 + 0.3e1 * t87 * t679 + t47 * t2181));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t2188 + 0.6e1 * t686;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2215 = my_piecewise3(t55, 0, -0.11e4 / 0.729e3 * t552);
  t2216 = my_piecewise3(t57, t2215, 0);
  t2224 = t173 * t784;
  t2228 = t286 * t93 * t178;
  t2234 = t136 * t424;
  t2235 = t2234 * t197;
  t2245 = -0.18e2 * t89 * t2235 * t1551 - 0.9e1 * t173 * t995 * t1834 - 0.9e1 * t173 * t2228 * t615 - t89 * t2216 * t98 - 0.9e1 * t2224 * t1828 + 0.9e1 * t785 * t1828 - 0.3e1 * t974 * t1849 + 0.9e1 * t979 * t1849 - 0.3e1 * t986 * t1849 + 0.9e1 * t979 * t1856 - t291 - 0.3e1 * t706 - 0.2e1 * t730;
  t2246 = t423 * t2235;
  t2254 = t1059 * params->csk_a;
  t2255 = t183 * t2254;
  t2258 = t281 * t429;
  t2259 = t89 * t2258;
  t2262 = t173 * t2258;
  t2265 = t89 * t2228;
  t2271 = t97 * t197;
  t2275 = t1001 * t193;
  t2276 = t183 * t2275;
  t2281 = t491 * t2275;
  t2286 = t286 * t174;
  t2291 = -0.9e1 * t173 * t2286 * t197 * t529 + 0.18e2 * t2262 * params->csk_a * t424 * t2271 + 0.18e2 * t173 * t2235 * t1607 - 0.6e1 * t2246 * t1569 - 0.18e2 * t2246 * t1607 - 0.9e1 * t986 * t1856 - 0.6e1 * t2259 * t1866 + 0.18e2 * t2262 * t1866 - 0.9e1 * t974 * t1876 + 0.9e1 * t1885 * t2276 + 0.9e1 * t1885 * t2281 - 0.6e1 * t986 * t1890 + 0.18e2 * t1912 * t2255 + 0.9e1 * t2265 * t615;
  t2293 = t491 * t2254;
  t2299 = t183 * t1059 * t193;
  t2307 = t136 * t1485;
  t2308 = t173 * t2307;
  t2311 = t89 * t2307;
  t2314 = t1675 * t766;
  t2317 = t423 * t2307;
  t2320 = t1505 * t2307;
  t2322 = t286 * t425;
  t2323 = t173 * t2322;
  t2326 = t423 * t2322;
  t2333 = 0.9e1 * t89 * t995 * t1918 - 0.12e2 * t2246 * t1614 + 0.9e1 * t979 * t1876 + 0.9e1 * t1903 * t2299 + 0.18e2 * t1912 * t2293 - 0.7e1 * t2308 * t1945 + 0.18e2 * t2317 * t1945 + 0.6e1 * t2311 * t1991 - 0.6e1 * t1998 * t2314 + 0.6e1 * t2317 * t2004 - t2320 * t2004 + 0.12e2 * t2317 * t2018 + 0.9e1 * t2323 * t624 - 0.3e1 * t2326 * t624;
  t2334 = t89 * t2322;
  t2341 = t439 * t1098;
  t2347 = t439 * t278 * t193;
  t2350 = t439 * t756;
  t2353 = t1692 * t738;
  t2360 = t89 * t2234;
  t2363 = t173 * t2234;
  t2370 = -0.7e1 * t2320 * t1945 + 0.3e1 * t2360 * t1953 - 0.3e1 * t2363 * t1953 - 0.18e2 * t1956 * t2350 - 0.6e1 * t2317 * t1972 - 0.18e2 * t2308 * t1991 + 0.6e1 * t2317 * t1991 - 0.9e1 * t2021 * t2347 + 0.7e1 * t2040 * t2353 + 0.11e2 * t2311 * t2045 - 0.9e1 * t2326 * t650 - 0.3e1 * t2334 * t624 - 0.9e1 * t2334 * t672 + 0.9e1 * t586 * t2341;
  t2383 = t1675 * t713 * t440;
  t2393 = t1509 * t136;
  t2395 = t1684 * t2393 * t440;
  t2400 = t433 * t286;
  t2402 = t431 * t2400 * params->csk_a;
  t2405 = -0.11e2 * t2308 * t1949 - 0.12e2 * t2360 * t1961 - 0.3e1 * t2363 * t1967 + 0.18e2 * t1998 * t2383 + 0.11e2 * t1998 * t2395 - 0.12e2 * t2320 * t2018 - 0.11e2 * t2308 * t2045 - 0.6e1 * t2320 * t2069 - t293 * t2077 - t293 * t2096 - 0.6e1 * t2326 * t657 + 0.9e1 * t586 * t2402 - 0.3e1 * t749 * t654;
  t2414 = t205 * t709 * t197;
  t2418 = t431 * t713 * t197;
  t2425 = t733 * t176;
  t2426 = t173 * t2425;
  t2434 = t89 * t2425;
  t2438 = t1692 * t278 * t440;
  t2445 = -0.3e1 * t831 * t431 * t1621 * t136 + 0.9e1 * t89 * t2286 * t643 - 0.12e2 * t1979 * t2314 - 0.18e2 * t1979 * t2353 + 0.7e1 * t1998 * t2438 - 0.7e1 * t2308 * t2004 + t2311 * t2004 - 0.6e1 * t720 * t2080 - 0.6e1 * t2110 * t2418 + 0.9e1 * t2323 * t672 - 0.3e1 * t2426 * t241 + 0.3e1 * t2434 * t241 + 0.9e1 * t636 * t2414 - 0.3e1 * t749 * t523;
  t2448 = t1684 * t2393 * params->csk_a;
  t2472 = -t89 * t136 * t495 * t199 - 0.3e1 * t89 * t286 * t193 * t199 + t1580 * t279 - 0.6e1 * t1998 * t2448 + t282 * t2077 + t282 * t2130 + 0.9e1 * t2323 * t650 - 0.3e1 * t2426 * t257 + 0.3e1 * t724 * t523 + 0.4e1 * t754 + 0.4e1 * t758 - 0.4e1 * t781 + 0.4e1 * t786 - 0.4e1 * t788;
  t2475 = t431 * t2400;
  t2478 = t1684 * t2393;
  t2480 = t439 * t709;
  t2483 = t1675 * t713;
  t2489 = t205 * t182 * t733;
  t2506 = t1692 * t278;
  t2509 = -0.3e1 * t89 * t733 * t91 * t199 + 0.3e1 * t2360 * t1482 + 0.6e1 * t1979 * t2483 + t1998 * t2478 + 0.11e2 * t2040 * t2506 + 0.6e1 * t2311 * t2149 + 0.3e1 * t2153 * t279 - 0.6e1 * t2334 * t574 + 0.3e1 * t234 * t2489 + 0.3e1 * t2434 * t252 - 0.3e1 * t586 * t2475 - 0.9e1 * t567 * t2480 + 0.3e1 * t506 * t710 + 0.3e1 * t724 * t598;
  t2513 = my_piecewise5(t52, 0, t55, 0, t2245 + t2291 + t2333 + t2370 + t2405 + t2445 + t2472 + t2509);
  t2520 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t391 * t141 - t8 * t150 * t299 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t73 * t794 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.11e4 / 0.729e3 * t555 + 0.1e3 / 0.81e2 * t558 - 0.25e2 / 0.54e2 * t561 + 0.5e1 / 0.54e2 * t30 * t129 * t534 + t411 * t139 + 0.3e1 * t167 * t297 + 0.3e1 * t87 * t792 + t47 * t2513));
  tv4rho3lapl0 = 0.2e1 * rho[0] * t2520 + 0.6e1 * t799;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 0] += tv4rho3lapl0;

  tv4rho3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 0] += tv4rho3tau0;

  t2542 = 0.2e1 * t814;
  t2543 = 0.3e1 * t817;
  t2545 = 0.2e1 * t837;
  t2546 = t245 * t245;
  t2550 = t89 * t2546;
  t2555 = t818 * t178;
  t2556 = t89 * t2555;
  t2557 = t871 * t862;
  t2560 = t173 * t2555;
  t2563 = t183 * t245;
  t2567 = t313 * t429;
  t2568 = t423 * t2567;
  t2569 = t440 * t174;
  t2570 = t2569 * t2271;
  t2575 = t89 * t2567;
  t2578 = t173 * t2567;
  t2581 = 0.2e1 * t173 * t2546 * t184 - 0.12e2 * t2560 * t2563 * t862 + 0.18e2 * t2568 * t1531 - 0.2e1 * t2550 * t199 + 0.2e1 * t2550 * t201 + 0.12e2 * t2556 * t2557 - 0.12e2 * t2560 * t2557 - 0.6e1 * t2568 * t2570 - 0.6e1 * t2575 * t2570 + 0.18e2 * t2578 * t2570 + t2542 - t2543 + t2545 - t319 - t321 - 0.4e1 * t823;
  t2582 = t317 * t174;
  t2583 = t2582 * t197;
  t2586 = 0.3e1 * t89 * t2583 * t513;
  t2587 = t173 * t2583;
  t2589 = 0.3e1 * t2587 * t513;
  t2591 = t245 * params->csk_a * t91;
  t2592 = t97 * t2591;
  t2598 = t440 * t91 * t245;
  t2599 = t491 * t2598;
  t2602 = t183 * t2598;
  t2607 = t2569 * t197;
  t2608 = t183 * t2607;
  t2611 = t183 * t1833;
  t2615 = t423 * t186 * t429;
  t2616 = t491 * t1243;
  t2619 = t848 * t429;
  t2620 = t423 * t2619;
  t2625 = t1874 * t512;
  t2631 = t97 * t2598;
  t2639 = 0.3e1 * t2587 * t529;
  t2640 = -0.12e2 * t2620 * t491 * t2569 * t176 - 0.18e2 * t2620 * t2569 * t1606 - 0.8e1 * t1000 * t2599 - 0.4e1 * t1000 * t2631 + 0.3e1 * t857 * t1538 + 0.12e2 * t1847 * t2592 + 0.12e2 * t1847 * t2602 + 0.12e2 * t1847 * t2631 - 0.12e2 * t1859 * t2592 - 0.4e1 * t1859 * t2631 + 0.18e2 * t2578 * t2608 - 0.3e1 * t850 * t2611 + 0.18e2 * t2615 * t2616 - 0.3e1 * t850 * t2625 + t2586 - t2589 - t2639;
  t2642 = t818 * t245;
  t2654 = t613 * t1550;
  t2664 = t310 * t1485;
  t2665 = t89 * t2664;
  t2666 = t1989 * t671;
  t2669 = t310 * t1480;
  t2670 = t173 * t2669;
  t2671 = t206 * t174;
  t2672 = t205 * t2671;
  t2675 = t423 * t2664;
  t2676 = t1675 * t656;
  t2680 = t481 * t573 * t176;
  t2683 = t317 * t425;
  t2684 = t89 * t2683;
  t2686 = 0.3e1 * t2684 * t672;
  t2687 = t173 * t2683;
  t2689 = 0.3e1 * t2687 * t672;
  t2691 = t174 * t62 * t96;
  t2692 = t510 * t2691;
  t2695 = t173 * t2664;
  t2698 = t310 * t174;
  t2702 = 0.12e2 * t1903 * t183 * t2642 + 0.12e2 * t2556 * t97 * t590 * t93 + 0.12e2 * t1000 * t491 * t2591 + 0.18e2 * t173 * t2619 * t2654 - 0.18e2 * t2575 * t615 + 0.12e2 * t1000 * t183 * t2591 - 0.12e2 * t1000 * t2602 + 0.11e2 * t2665 * t2666 - 0.3e1 * t2670 * t2672 - 0.6e1 * t2675 * t2676 - 0.12e2 * t866 * t2680 - t2686 + t2689 - 0.3e1 * t2670 * t2692 - 0.11e2 * t2695 * t2666 + 0.3e1 * t89 * t2698 * t1953;
  t2703 = t1692 * t2671;
  t2706 = t1989 * t623;
  t2721 = t174 * t1485;
  t2722 = t1505 * t2721;
  t2723 = t1509 * t310;
  t2730 = t1505 * t2664;
  t2734 = t433 * t317;
  t2736 = t431 * t2734 * params->csk_a;
  t2738 = 0.3e1 * t586 * t2736;
  t2739 = t423 * t2721;
  t2741 = t1675 * t832 * params->csk_a;
  t2745 = t1675 * t1677 * t174;
  t2749 = t1692 * t441 * t174;
  t2752 = t1748 * t649;
  t2755 = t836 * t523;
  t2757 = 0.3e1 * t2687 * t650;
  t2758 = -0.6e1 * t2722 * t1684 * t2723 * params->csk_a - 0.12e2 * t2021 * t439 * t235 * t245 - 0.4e1 * t831 * t431 * t587 * t245 - t839 * t1561 + 0.3e1 * t876 * t1596 + 0.6e1 * t2665 * t2706 - 0.18e2 * t2675 * t2703 + 0.6e1 * t2675 * t2706 + 0.18e2 * t2730 * t2676 - 0.18e2 * t2695 * t2706 - 0.12e2 * t2730 * t2745 + 0.7e1 * t2730 * t2749 - 0.7e1 * t2730 * t2752 - 0.12e2 * t2739 * t2741 + t2738 + t2755 + t2757;
  t2762 = 0.3e1 * t2687 * t624;
  t2763 = t423 * t2683;
  t2764 = t2763 * t624;
  t2767 = t439 * t1265;
  t2769 = 0.3e1 * t586 * t2767;
  t2773 = t1989 * t2002 * t174;
  t2780 = t2684 * t624;
  t2782 = t205 * t812 * t197;
  t2784 = 0.3e1 * t636 * t2782;
  t2787 = 0.3e1 * t89 * t2582 * t643;
  t2789 = t481 * t821 * t91;
  t2792 = t423 * t186;
  t2798 = t510 * t97 * t602;
  t2803 = -0.6e1 * t2792 * t431 * t832 * t197 - 0.3e1 * t876 * t1618 - 0.2e1 * t254 * t2798 + t2665 * t2773 + 0.12e2 * t2675 * t2745 + 0.6e1 * t2675 * t2773 - 0.7e1 * t2695 * t2773 - 0.6e1 * t2722 * t2741 - t2730 * t2773 - 0.8e1 * t572 * t2789 + t2762 - t2764 + t2769 - t2780 + t2784 + t2787;
  t2805 = t205 * t206 * t602;
  t2810 = t906 * t654;
  t2812 = 0.2e1 * t2763 * t657;
  t2815 = t182 * t310;
  t2820 = t906 * t523;
  t2822 = 0.3e1 * t2763 * t650;
  t2827 = t173 * t2721;
  t2828 = t2815 * params->csk_a;
  t2829 = t1692 * t2828;
  t2833 = t431 * t451 * t193;
  t2841 = t1684 * t1685 * t174;
  t2847 = t1692 * t2815 * t440;
  t2852 = -0.2e1 * t254 * t2805 + 0.3e1 * t885 * t1584 - t2810 - t2812 + 0.3e1 * t866 * t1918 - 0.18e2 * t203 * t439 * t2815 * t197 - t2820 - t2822 + 0.3e1 * t843 * t1636 - 0.3e1 * t839 * t1636 + 0.7e1 * t2827 * t2829 - 0.2e1 * t876 * t2833 + 0.11e2 * t2722 * t1684 * t2723 * t440 - 0.6e1 * t2730 * t2841 + 0.3e1 * t843 * t1618 - 0.11e2 * t2827 * t2847 - 0.7e1 * t2695 * t2752;
  t2868 = 0.2e1 * t905;
  t2869 = 0.2e1 * t907;
  t2870 = 0.2e1 * t921;
  t2871 = t2546 * t176;
  t2875 = t173 * t2871;
  t2883 = 0.3e1 * t173 * t2698 * t1500 + 0.2e1 * t89 * t2871 * t190 + 0.3e1 * t843 * t1561 - t876 * t1561 + 0.3e1 * t876 * t1623 - 0.2e1 * t2875 * t190 - 0.2e1 * t2875 * t207 + 0.2e1 * t239 * t2798 + 0.18e2 * t2675 * t2752 + t2868 - t2869 - t2870 - 0.4e1 * t853 + 0.4e1 * t860 - 0.4e1 * t864 + 0.4e1 * t869 + 0.4e1 * t888;
  t2885 = t188 * t573;
  t2888 = t1989 * t573;
  t2892 = 0.2e1 * t2684 * t574;
  t2893 = t439 * t812;
  t2895 = 0.3e1 * t567 * t2893;
  t2904 = t836 * t598;
  t2905 = t481 * t597;
  t2913 = t506 * t813;
  t2914 = t431 * t2734;
  t2915 = t586 * t2914;
  t2918 = t89 * t317 * t193 * t199;
  t2919 = t96 * t602;
  t2923 = t188 * t2919;
  t2926 = 0.3e1 * t89 * t2669 * t2885 + 0.6e1 * t2665 * t2888 - t2892 - t2895 + 0.6e1 * t2739 * t1675 * t832 + 0.2e1 * t254 * t2170 - t1566 * t833 + t2722 * t1684 * t2723 + t2904 - 0.2e1 * t839 * t2905 + 0.11e2 * t2827 * t1692 * t2815 - 0.3e1 * t843 * t1705 + t2913 - t2915 - t2918 - 0.2e1 * t819 * t820 * t2919 + 0.2e1 * t239 * t2923;
  t2930 = my_piecewise5(t52, 0, t55, 0, t2581 + t2640 + t2702 + t2758 + t2803 + t2852 + t2883 + t2926);
  t2937 = my_piecewise3(t3, 0, -t8 * t150 * t329 / 0.3e2 + t8 * t73 * t926 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.88e3 / 0.729e3 * t30 * t551 * t121 + 0.16e3 / 0.243e3 * t30 * t223 * t260 - 0.1e2 / 0.81e2 * t30 * t110 * t679 + t167 * t327 + 0.2e1 * t87 * t924 + t47 * t2930));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t2937 + 0.4e1 * t931;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2967 = t455 * t174 * t1550;
  t2977 = t423 * t1862;
  t2978 = t491 * t136;
  t2982 = t423 * t2258;
  t2983 = t491 * t440;
  t2987 = t183 * t440;
  t2991 = t97 * t440;
  t2995 = t647 * t174;
  t2996 = t2995 * t1550;
  t2999 = t423 * t958;
  t3002 = t952 * t197;
  t3003 = t89 * t3002;
  t3006 = t173 * t3002;
  t3009 = 0.3e1 * t785 * t968 * t1904 - 0.6e1 * t2259 * t2991 * t606 + 0.18e2 * t2262 * t2987 * t606 + 0.18e2 * t2977 * t2978 * t614 - 0.12e2 * t2982 * t2983 * t606 - 0.18e2 * t1008 * t2967 - 0.3e1 * t959 * t1834 + 0.18e2 * t959 * t2967 - 0.6e1 * t2999 * t2996 + 0.18e2 * t959 * t2996 + 0.6e1 * t3003 * t965 - 0.6e1 * t3006 * t965 + t2542 - t2543 + t2545 - t319 - t347 - 0.2e1 * t954 - 0.2e1 * t957;
  t3010 = t955 * t197;
  t3014 = t173 * t3010;
  t3020 = t2307 * t1487;
  t3021 = t173 * t3020;
  t3023 = t1676 * t174 * t982;
  t3026 = t2569 * t982;
  t3029 = t423 * t3020;
  t3032 = t1676 * t118;
  t3033 = t3032 * t649;
  t3036 = t3032 * t174;
  t3037 = t491 * t3036;
  t3046 = t975 * t174;
  t3055 = t173 * t345 * t1480;
  t3058 = t613 * t982;
  t3061 = t1505 * t3020;
  t3068 = t2322 * t429;
  t3069 = t89 * t3068;
  t3072 = 0.6e1 * t89 * t3010 * t965 - 0.6e1 * t3014 * t965 - 0.4e1 * t962 - 0.4e1 * t966 + 0.4e1 * t971 - 0.7e1 * t3021 * t3023 - 0.18e2 * t3021 * t3026 + 0.6e1 * t3029 * t3026 + 0.18e2 * t3029 * t3033 + 0.12e2 * t3029 * t3037 - 0.12e2 * t2259 * t97 * t606 - 0.18e2 * t1928 * t183 * t779 - 0.11e2 * t3021 * t183 * t3046 + 0.3e1 * t89 * t752 * t1480 * t343 - 0.3e1 * t3055 * t2692 - 0.11e2 * t3021 * t3058 - 0.7e1 * t3061 * t3033 - 0.6e1 * t974 * t2592 + 0.6e1 * t979 * t2592 - 0.6e1 * t3069 * t983;
  t3074 = t173 * t3068;
  t3079 = t2721 * t1487;
  t3080 = t1505 * t3079;
  t3081 = t345 * params->csk_a;
  t3085 = t89 * t3020;
  t3092 = t423 * t3068;
  t3098 = t975 * t183 * t193;
  t3101 = t136 * t440;
  t3102 = t3101 * t118;
  t3112 = t975 * t193;
  t3119 = t423 * t1938 * t429;
  t3122 = t704 * t197;
  t3123 = t183 * t3122;
  t3127 = t286 * params->csk_a * t91;
  t3133 = 0.6e1 * t3074 * t983 - 0.7e1 * t3021 * t3033 - 0.6e1 * t3080 * t491 * t3081 + 0.6e1 * t3085 * t3026 + 0.6e1 * t3029 * t3023 - t3061 * t3023 + t3085 * t3023 - 0.6e1 * t3092 * t987 - 0.6e1 * t986 * t2602 - 0.3e1 * t986 * t3098 + 0.18e2 * t3080 * t491 * t3102 - 0.12e2 * t3061 * t3037 - 0.4e1 * t3092 * t990 - 0.4e1 * t986 * t2599 - 0.2e1 * t986 * t491 * t3112 + 0.6e1 * t1881 * t996 + 0.6e1 * t3119 * t1003 + 0.6e1 * t994 * t3123 + 0.6e1 * t1000 * t491 * t3127 + 0.6e1 * t3003 * t868;
  t3143 = t97 * t3112;
  t3147 = t97 * t1886;
  t3175 = t1942 * t1487;
  t3176 = t423 * t3175;
  t3186 = 0.6e1 * t785 * t97 * t590 * t197 - 0.3e1 * t3055 * t2672 - 0.6e1 * t3029 * t491 * t3046 - t974 * t3143 + 0.3e1 * t979 * t3143 - 0.3e1 * t974 * t3147 - t986 * t3143 + 0.7e1 * t3080 * t183 * t3102 + 0.3e1 * t1000 * t2276 + 0.6e1 * t3074 * t987 + 0.6e1 * t979 * t2602 + 0.3e1 * t979 * t3098 + 0.3e1 * t1008 * t1918 + 0.11e2 * t3080 * t1510 * t3102 - 0.6e1 * t3061 * t1510 * t3036 + 0.3e1 * t994 * t2299 - 0.6e1 * t2615 * t491 * t958 - 0.12e2 * t3176 * t491 * t752 * params->csk_a + 0.3e1 * t1000 * t2281 - 0.6e1 * t3080 * t1510 * t3081;
  t3222 = t183 * t136;
  t3223 = t1481 * t3222;
  t3232 = 0.3e1 * t979 * t3147 - 0.18e2 * t423 * t3079 * t183 * t3081 + 0.7e1 * t3021 * t183 * t605 * params->csk_a - 0.2e1 * t3069 * t977 - 0.2e1 * t974 * t2631 + 0.6e1 * t3119 * t1014 + 0.6e1 * t1000 * t183 * t3127 + 0.11e2 * t3085 * t3058 + 0.6e1 * t3074 * t977 - 0.2e1 * t3092 * t977 + 0.6e1 * t979 * t2631 - 0.2e1 * t986 * t2631 + t2586 - t2589 - t2639 + 0.3e1 * t346 * t1481 * t2691 + 0.3e1 * t173 * t605 * t3223 + 0.6e1 * t2311 * t1989 * t348 * t174 - 0.4e1 * t720 * t2789;
  t3234 = t439 * t709 * t91;
  t3256 = t278 * t118;
  t3266 = t439 * t278 * t245;
  t3270 = t431 * t2119 * t136;
  t3277 = -0.6e1 * t627 * t3234 - 0.4e1 * t2334 * t1018 + t282 * t2798 - t2426 * t343 - 0.2e1 * t749 * t872 - t293 * t2798 - t2426 * t353 - 0.2e1 * t749 * t882 - t293 * t2805 - t1566 * t1030 + t2722 * t1684 * t2063 * t136 - 0.2e1 * t720 * t481 * t348 * t193 + 0.11e2 * t2827 * t1692 * t3256 - 0.3e1 * t627 * t2347 + 0.6e1 * t2739 * t1675 * t1029 - 0.6e1 * t2021 * t3266 - 0.2e1 * t831 * t3270 - 0.2e1 * t831 * t431 * t587 * t286 - t2686 + t2689;
  t3284 = t2434 * t343 + 0.2e1 * t724 * t872 + 0.4e1 * t1009 + t2738 + t2755 + t2757 + t2762 - t2764 + t2769 - t2780 + t2784 + t2787 - t2810 - t2812 - t2820 - t2822 + t2868 - t2869 - t2870 + 0.4e1 * t997;
  t3317 = -0.3e1 * t959 * t510 * t193 * t512 + 0.18e2 * t2615 * t3222 * t1314 - 0.18e2 * t2999 * t2995 * t1606 - 0.6e1 * t3006 * t961 - 0.6e1 * t3014 * t961 - t2892 - t2895 + t2904 + t2913 - t2915 - t2918 - t89 * t136 * t602 * t199 + t2434 * t349 + 0.2e1 * t724 * t825 + t282 * t2923 + t2032 * t279 + 0.2e1 * t632 * t710 + t254 * t2489 - t89 * t733 * t118 * t199 - 0.2e1 * t89 * t286 * t245 * t199;
  t3321 = my_piecewise5(t52, 0, t55, 0, t3009 + t3072 + t3133 + t3186 + t3232 + t3277 + t3284 + t3317);
  t3328 = my_piecewise3(t3, 0, -t8 * t150 * t358 / 0.3e2 + t8 * t73 * t1038 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (0.1e3 / 0.243e3 * t806 - 0.25e2 / 0.81e2 * t809 + 0.5e1 / 0.54e2 * t30 * t129 * t679 - 0.44e3 / 0.729e3 * t30 * t551 * t139 + 0.8e2 / 0.243e3 * t30 * t223 * t297 - 0.5e1 / 0.81e2 * t30 * t110 * t792 + t167 * t356 + 0.2e1 * t87 * t1036 + t47 * t3321));
  tv4rho2sigmalapl0 = 0.2e1 * rho[0] * t3328 + 0.4e1 * t1043;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmatau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  t3347 = t286 * t286;
  t3351 = t89 * t3347;
  t3356 = t370 * t429;
  t3357 = t89 * t3356;
  t3360 = t173 * t3356;
  t3363 = t423 * t3356;
  t3367 = t1061 * t91;
  t3368 = params->csk_a * t62 * t3367;
  t3378 = 0.2e1 * t173 * t3347 * t184 - 0.12e2 * t3363 * t491 * t2607 + 0.18e2 * t3363 * t1531 - 0.2e1 * t3351 * t199 + 0.2e1 * t3351 * t201 - 0.6e1 * t3357 * t2570 + 0.18e2 * t3360 * t2570 - 0.6e1 * t3363 * t2570 - 0.18e2 * t3363 * t2608 + 0.12e2 * t979 * t3368 - 0.4e1 * t1063 + t2542 - t2543 + t2545 - t319 - t374;
  t3379 = t1075 * t429;
  t3380 = t173 * t3379;
  t3387 = t440 * t62;
  t3388 = t3387 * t3367;
  t3394 = t440 * t286 * t91;
  t3395 = t183 * t3394;
  t3398 = t1059 * t178;
  t3399 = t89 * t3398;
  t3406 = t1001 * t286;
  t3430 = 0.18e2 * t2615 * t491 * t1075 * params->csk_a + 0.12e2 * t3399 * t97 * t704 * t93 + 0.12e2 * t1885 * t183 * t3406 + 0.12e2 * t1885 * t491 * t3406 - 0.8e1 * t986 * t491 * t3394 - 0.3e1 * t1077 * t2611 + 0.3e1 * t1082 * t1538 + 0.12e2 * t2224 * t3123 + 0.18e2 * t3360 * t2608 + 0.18e2 * t3380 * t2654 - 0.18e2 * t3357 * t615 - 0.12e2 * t974 * t3368 - 0.4e1 * t974 * t3388 + 0.12e2 * t979 * t3388 - 0.4e1 * t986 * t3388 + 0.12e2 * t979 * t3395 - 0.12e2 * t986 * t3395;
  t3434 = t367 * t1480;
  t3435 = t173 * t3434;
  t3438 = t182 * t174;
  t3447 = t367 * t1485;
  t3448 = t173 * t3447;
  t3451 = t367 * t174;
  t3455 = t89 * t3447;
  t3458 = t423 * t3447;
  t3469 = -0.18e2 * t376 * t439 * t3438 * t197 + 0.3e1 * t89 * t3451 * t1953 - 0.3e1 * t1077 * t2625 - 0.12e2 * t1087 * t2680 - 0.11e2 * t3448 * t2666 + 0.11e2 * t3455 * t2666 - 0.3e1 * t3435 * t2672 - 0.6e1 * t3458 * t2676 - 0.3e1 * t3435 * t2692 - 0.18e2 * t3458 * t2703 - 0.18e2 * t3448 * t2706 + 0.6e1 * t3455 * t2706 + 0.6e1 * t3458 * t2706 + t2586 - t2589 - t2639;
  t3475 = t1675 * t1056 * params->csk_a;
  t3485 = t1505 * t3447;
  t3494 = t431 * t713 * t286;
  t3497 = t1509 * t367;
  t3499 = t1684 * t3497 * params->csk_a;
  t3503 = t510 * t97 * t733;
  t3509 = t1675 * t1056 * t440;
  t3514 = -t1095 * t1561 - 0.3e1 * t1095 * t1618 - 0.6e1 * t2722 * t3475 - 0.6e1 * t2722 * t3499 + 0.18e2 * t2722 * t3509 - 0.12e2 * t2739 * t3475 + 0.12e2 * t3458 * t2745 - 0.12e2 * t3485 * t2745 + 0.7e1 * t3485 * t2749 + 0.18e2 * t3458 * t2752 - 0.7e1 * t3485 * t2752 - 0.7e1 * t3448 * t2773 + t3455 * t2773 + 0.6e1 * t3458 * t2773 - 0.6e1 * t3485 * t2841 - 0.2e1 * t293 * t3503 - 0.4e1 * t831 * t3494;
  t3524 = t1684 * t3497 * t440;
  t3545 = t182 * t367;
  t3555 = -0.2e1 * t293 * t205 * t206 * t733 - 0.2e1 * t1095 * t2833 + 0.11e2 * t2722 * t3524 - t3485 * t2773 - 0.8e1 * t720 * t481 * t3367 - 0.12e2 * t743 * t3234 + 0.3e1 * t1095 * t1623 + 0.2e1 * t282 * t3503 + 0.3e1 * t1069 * t1618 + 0.3e1 * t1087 * t1918 + 0.3e1 * t1069 * t1636 - 0.3e1 * t1072 * t1636 + 0.7e1 * t2827 * t1692 * t3545 * params->csk_a + 0.3e1 * t1114 * t1584 + 0.3e1 * t1095 * t1596 - t1072 * t1561;
  t3565 = t431 * t1056 * t197;
  t3568 = -0.11e2 * t2827 * t1692 * t3545 * t440 + 0.3e1 * t1069 * t1561 - 0.7e1 * t3448 * t2752 - 0.6e1 * t2792 * t3565 - t2686 + t2689 + t2738 + t2755 + t2757 + t2762 - t2764 + t2769 - t2780 + t2784 + t2787 - t2810 - t2812;
  t3584 = 0.12e2 * t3399 * t1090 * t862 - 0.12e2 * t2224 * t1966 * t3122 - 0.12e2 * t2224 * t968 * t3122 - 0.4e1 * t1078 + 0.4e1 * t1083 - 0.4e1 * t1085 + 0.4e1 * t1088 + 0.4e1 * t1115 - t2820 - t2822 + t2868 - t2869 - t2870 - t2892 - t2895 + t2904 + t2913;
  t3585 = t96 * t733;
  t3596 = t1684 * t3497;
  t3601 = t89 * t3434;
  t3612 = t1675 * t1056;
  t3615 = t3347 * t176;
  t3619 = t173 * t3615;
  t3624 = -t2915 - t2918 + 0.2e1 * t282 * t188 * t3585 - 0.3e1 * t1069 * t1705 - 0.2e1 * t1072 * t2905 + 0.2e1 * t293 * t2489 - t1566 * t1057 + t2722 * t3596 - 0.2e1 * t1060 * t820 * t3585 + 0.3e1 * t3601 * t2885 + 0.6e1 * t3455 * t2888 + 0.3e1 * t173 * t3451 * t1500 + 0.11e2 * t3448 * t1692 * t3438 + 0.6e1 * t2739 * t3612 + 0.2e1 * t89 * t3615 * t190 - 0.2e1 * t3619 * t190 - 0.2e1 * t3619 * t207;
  t3628 = my_piecewise5(t52, 0, t55, 0, t3378 + t3430 + t3469 + t3514 + t3555 + t3568 + t3584 + t3624);
  t3635 = my_piecewise3(t3, 0, -t8 * t150 * t382 / 0.3e2 + t8 * t73 * t1127 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (0.2e3 / 0.243e3 * t942 - 0.5e2 / 0.81e2 * t945 + 0.5e1 / 0.27e2 * t30 * t129 * t792 + t167 * t380 + 0.2e1 * t87 * t1125 + t47 * t3628));
  tv4rho2lapl20 = 0.2e1 * rho[0] * t3635 + 0.4e1 * t1132;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 0] += tv4rho2tau20;

  t3648 = 0.6e1 * t1164;
  t3649 = params->csk_a * t317;
  t3650 = t3649 * t91;
  t3651 = t97 * t3650;
  t3652 = t1859 * t3651;
  t3654 = t2683 * t429;
  t3656 = t173 * t3654 * t983;
  t3658 = t1145 * t429;
  t3661 = t176 * params->csk_a * t91;
  t3662 = t97 * t3661;
  t3665 = -0.18e2 * t89 * t3658 * t3662 + t1142 + t1144 + t1148 + t1156 - t319 - t321 - t3648 - 0.9e1 * t3652 + 0.9e1 * t3656 + t814 - t817 - t824 + t837;
  t3666 = t173 * t3658;
  t3669 = t423 * t3654;
  t3670 = t3669 * t987;
  t3672 = t423 * t3658;
  t3674 = t440 * t176 * t91;
  t3675 = t183 * t3674;
  t3678 = t1832 * t245;
  t3679 = t183 * t3678;
  t3685 = t1138 * t176;
  t3686 = t3685 * t429;
  t3687 = t423 * t3686;
  t3688 = t491 * t858;
  t3691 = t440 * t317;
  t3692 = t3691 * t91;
  t3693 = t183 * t3692;
  t3694 = t1847 * t3693;
  t3696 = t317 * t93;
  t3697 = t3696 * t178;
  t3700 = t89 * t3697 * t97 * t969;
  t3702 = t3669 * t977;
  t3704 = t183 * t858;
  t3707 = t97 * t3692;
  t3708 = t1859 * t3707;
  t3710 = t1847 * t3707;
  t3715 = t1000 * t183 * t3650;
  t3717 = -0.12e2 * t3672 * t491 * t3674 + 0.18e2 * t3666 * t3662 + 0.18e2 * t3666 * t3675 - 0.18e2 * t3672 * t3675 - 0.9e1 * t850 * t3679 + 0.18e2 * t3687 * t3688 + 0.18e2 * t3687 * t3704 - 0.9e1 * t3670 + 0.9e1 * t3694 + 0.9e1 * t3700 - 0.3e1 * t3702 - 0.3e1 * t3708 + 0.9e1 * t3710 + 0.9e1 * t3715;
  t3720 = t3387 * t251 * t197;
  t3723 = t1832 * t871;
  t3727 = t97 * t1536 * t245;
  t3730 = t815 * t197;
  t3732 = t994 * t183 * t3730;
  t3742 = t1885 * t491 * t3649 * t118;
  t3744 = t3669 * t990;
  t3746 = t1138 * t1485;
  t3747 = t173 * t3746;
  t3749 = t1692 * t1693 * t91;
  t3752 = t89 * t3746;
  t3754 = t1989 * t2002 * t91;
  t3758 = t423 * t3746;
  t3761 = t1505 * t3746;
  t3763 = t1692 * t256;
  t3766 = 0.18e2 * t173 * t3686 * t3720 - 0.6e1 * t89 * t3686 * t3720 - 0.6e1 * t3687 * t3720 - 0.9e1 * t850 * t3723 + 0.9e1 * t857 * t3727 - 0.7e1 * t3747 * t3749 - 0.7e1 * t3747 * t3754 + t3752 * t3754 + 0.6e1 * t3758 * t3754 - t3761 * t3754 - 0.18e2 * t3758 * t3763 + 0.9e1 * t3732 + 0.9e1 * t3742 - 0.6e1 * t3744;
  t3770 = t1675 * t1677 * t91;
  t3773 = t1138 * t1480;
  t3774 = t173 * t3773;
  t3777 = t1675 * t915;
  t3781 = t1692 * t441 * t91;
  t3784 = t1989 * t899;
  t3790 = t481 * t1655 * t91;
  t3795 = t173 * t3685;
  t3796 = t439 * t886;
  t3799 = t2684 * t1018;
  t3805 = t1989 * t240;
  t3810 = -0.12e2 * t1146 * t3790 - 0.3e1 * t3774 * t241 - 0.3e1 * t3774 * t257 - 0.11e2 * t3747 * t3781 - 0.18e2 * t3747 * t3784 - 0.11e2 * t3747 * t3805 + 0.18e2 * t3758 * t3749 - 0.7e1 * t3761 * t3749 + 0.6e1 * t3752 * t3784 + 0.11e2 * t3752 * t3805 + 0.12e2 * t3758 * t3770 - 0.6e1 * t3758 * t3777 + 0.7e1 * t3761 * t3781 - 0.18e2 * t3795 * t3796 - 0.6e1 * t3799;
  t3816 = t188 * t474 * t245;
  t3822 = t433 * t1138;
  t3827 = t1675 * t890;
  t3830 = t1138 * t91;
  t3836 = t647 * t871;
  t3839 = t906 * t872;
  t3843 = t91 * t1485;
  t3844 = t1505 * t3843;
  t3855 = t831 * t431 * t587 * t317;
  t3857 = -0.6e1 * t423 * t233 * t431 * t3822 * t197 - 0.6e1 * t3844 * t1675 * t3822 * params->csk_a + 0.3e1 * t89 * t3830 * t1953 + 0.9e1 * t876 * t2037 + 0.9e1 * t885 * t2107 + 0.7e1 * t3747 * t3763 + 0.6e1 * t3758 * t3784 - 0.12e2 * t3758 * t3827 + 0.9e1 * t866 * t3816 - 0.3e1 * t839 * t3836 + 0.9e1 * t843 * t3836 - 0.3e1 * t876 * t3836 - 0.3e1 * t3839 - 0.3e1 * t3855;
  t3860 = t1509 * t1138;
  t3866 = t439 * t441 * t245;
  t3872 = t1675 * t3822 * t440;
  t3878 = t431 * t451 * t245;
  t3886 = t1684 * t1685 * t91;
  t3889 = t578 * t1187;
  t3893 = t2021 * t439 * t812 * t118;
  t3895 = t906 * t882;
  t3897 = t455 * t871;
  t3902 = 0.11e2 * t3844 * t1684 * t3860 * t440 - 0.6e1 * t3844 * t1684 * t3860 * params->csk_a + 0.9e1 * t876 * t2121 - 0.12e2 * t3761 * t3770 - 0.6e1 * t3761 * t3886 + 0.18e2 * t3844 * t3872 + 0.9e1 * t843 * t3866 - 0.9e1 * t876 * t3866 - 0.6e1 * t876 * t3878 - 0.9e1 * t839 * t3897 + 0.9e1 * t843 * t3897 + 0.3e1 * t3889 - 0.9e1 * t3893 - 0.3e1 * t3895;
  t3904 = -t853 + t860 - t864 + t1189 - t1191 - t1194 - t1196 - t1198 + t1201 + t869 + t888 + t905 - t907 - t921;
  t3905 = t173 * t3697;
  t3906 = t1966 * t969;
  t3907 = t3905 * t3906;
  t3909 = t1162 * t197;
  t3911 = t173 * t3909 * t965;
  t3913 = t968 * t3730;
  t3914 = t612 * t3913;
  t3916 = t1989 * t251;
  t3925 = t1692 * t844;
  t3932 = t89 * t317 * t245 * t199;
  t3936 = t836 * t825;
  t3938 = t481 * t821;
  t3941 = t632 * t813;
  t3949 = 0.6e1 * t423 * t3843 * t1675 * t3822 + 0.3e1 * t173 * t3830 * t1500 + t3844 * t1684 * t3860 + 0.3e1 * t89 * t3773 * t252 - 0.3e1 * t876 * t2138 - 0.9e1 * t843 * t2161 + 0.11e2 * t3747 * t3925 + 0.6e1 * t3752 * t3916 - 0.6e1 * t839 * t3938 - 0.9e1 * t3907 - 0.9e1 * t3911 + 0.9e1 * t3914 - 0.3e1 * t3932 + 0.3e1 * t3936 + 0.3e1 * t3941;
  t3953 = my_piecewise5(t52, 0, t55, 0, t3665 + t3717 + t3766 + t3810 + t3857 + t3902 + t3904 + t3949);
  t3960 = my_piecewise3(t3, 0, t8 * t73 * t1206 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (0.4e2 / 0.81e2 * t30 * t223 * t327 - 0.5e1 / 0.27e2 * t30 * t110 * t924 + t87 * t1204 + t47 * t3953));
  tv4rhosigma30 = 0.2e1 * rho[0] * t3960 + 0.2e1 * t1210;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t3978 = t979 * t3651;
  t3980 = t440 * t310;
  t3981 = t3980 * t91;
  t3986 = t97 * t310;
  t3987 = t1676 * t91 * t3986;
  t3990 = t979 * t3707;
  t3992 = -0.6e1 * t3029 * t491 * t3981 - 0.7e1 * t3021 * t3987 - 0.4e1 * t1164 + t1218 + t1225 + t1232 + t1233 - t1305 - t319 - t347 + 0.3e1 * t3978 + 0.3e1 * t3990 + t814 - t817 + t837 - t954 - t957 - t962 - t966 + t971;
  t3993 = t986 * t3707;
  t3994 = t1676 * t310;
  t3995 = t3994 * t877;
  t3998 = t979 * t3693;
  t4000 = t3994 * t91;
  t4001 = t491 * t4000;
  t4004 = t2664 * t1487;
  t4009 = t97 * t1242 * t91;
  t4012 = t1505 * t4004;
  t4022 = t1001 * t245;
  t4026 = t3843 * t1487;
  t4027 = t1505 * t4026;
  t4028 = t1235 * params->csk_a;
  t4032 = t1001 * t317;
  t4033 = t183 * t4032;
  t4034 = t1885 * t4033;
  t4036 = t986 * t3693;
  t4038 = t975 * t2563;
  t4041 = t3101 * t310;
  t4050 = t974 * t3707;
  t4053 = 0.7e1 * t4012 * t183 * t3101 * t91 + 0.6e1 * t1000 * t491 * t4022 + 0.7e1 * t173 * t4004 * t1014 - 0.6e1 * t3061 * t1510 * t4000 - 0.6e1 * t4027 * t1510 * t4028 + 0.18e2 * t4027 * t491 * t4041 - 0.7e1 * t3021 * t3995 + 0.6e1 * t3029 * t3987 + 0.18e2 * t3029 * t3995 + 0.12e2 * t3029 * t4001 - t3061 * t3987 - 0.7e1 * t3061 * t3995 - 0.12e2 * t3061 * t4001 + 0.11e2 * t3085 * t4009 - 0.6e1 * t986 * t4038 - t3993 + 0.3e1 * t3998 + 0.3e1 * t4034 - 0.3e1 * t4036 - t4050;
  t4057 = t3980 * t909;
  t4065 = t286 * t310;
  t4067 = t173 * t4065 * t197;
  t4070 = t1313 * t871;
  t4082 = t3905 * t996;
  t4088 = t89 * t1220 * t197;
  t4089 = t4088 * t868;
  t4091 = t491 * t4032;
  t4092 = t1885 * t4091;
  t4095 = t986 * t491 * t3692;
  t4097 = t975 * t245;
  t4107 = t97 * t4097;
  t4110 = -0.6e1 * t4012 * t1003 - 0.18e2 * t3021 * t4057 + 0.6e1 * t3029 * t4057 + 0.6e1 * t3085 * t4057 + t3085 * t3987 - 0.3e1 * t4067 * t513 + 0.6e1 * t979 * t4070 - 0.18e2 * t423 * t4026 * t183 * t4028 + 0.6e1 * t994 * t183 * t3010 + 0.6e1 * t979 * t4038 + 0.3e1 * t4082 - 0.6e1 * t2568 * t491 * t995 + 0.3e1 * t4089 + 0.3e1 * t4092 - 0.2e1 * t4095 - 0.4e1 * t986 * t491 * t4097 + 0.11e2 * t4027 * t1510 * t4041 - 0.18e2 * t2578 * t996 - 0.6e1 * t3652 - 0.2e1 * t974 * t4107;
  t4126 = t89 * t1236;
  t4130 = t173 * t1235 * t1480;
  t4135 = t188 * t1247;
  t4142 = t974 * t3651;
  t4157 = -0.12e2 * t423 * t4004 * t1003 - 0.11e2 * t3021 * t183 * t3981 - 0.3e1 * t4130 * t241 - 0.11e2 * t3021 * t4009 + 0.6e1 * t3656 - 0.6e1 * t3670 + 0.6e1 * t3694 + 0.6e1 * t3700 - 0.2e1 * t3702 - 0.2e1 * t3708 - 0.3e1 * t4142;
  t4168 = t720 * t481 * t1223 * t91;
  t4170 = t2687 * t1022;
  t4203 = 0.6e1 * t3710 + 0.6e1 * t3715 + 0.6e1 * t3732 + 0.6e1 * t3742 - 0.4e1 * t3744 - 0.2e1 * t4168 - 0.3e1 * t4170 + 0.6e1 * t2675 * t1675 * t713 * t91 + 0.3e1 * t2323 * t1255 - t2326 * t1255 - 0.6e1 * t627 * t3266 + 0.3e1 * t89 * t4065 * t643 - 0.4e1 * t720 * t481 * t348 * t245 - 0.3e1 * t2334 * t1248 - 0.2e1 * t630 * t3270 + t3844 * t1684 * t2723 * t136 + 0.3e1 * t2323 * t1248 + 0.3e1 * t885 * t2414 - 0.2e1 * t2326 * t1269 + 0.3e1 * t876 * t2402;
  t4204 = t724 * t1187;
  t4208 = t431 * t2734 * t136;
  t4209 = t831 * t4208;
  t4210 = t749 * t1187;
  t4213 = t749 * t1266;
  t4214 = t310 * t91;
  t4238 = -t2334 * t1255 + 0.3e1 * t876 * t2341 - t1239 - t1241 + t1246 - 0.4e1 * t3799 - 0.2e1 * t3839 - 0.2e1 * t3855 + 0.2e1 * t3889 - 0.6e1 * t3893 - 0.2e1 * t3895;
  t4242 = t3980 * t180 * t886;
  t4246 = t2224 * t1966 * t3730;
  t4248 = t4214 * t197;
  t4256 = t455 * t176 * t909;
  t4260 = t647 * t176 * t909;
  t4266 = -0.6e1 * t423 * t1236 * t4260 + 0.18e2 * t2568 * t2978 * t858 - 0.12e2 * t2982 * t2983 * t4248 + 0.18e2 * t1237 * t4256 + 0.18e2 * t1237 * t4260 - 0.18e2 * t2982 * t4242 + t1009 - t1267 + t1274 + t1280 + t1283 + t1284 - t1285 - t1286 - t1287 - 0.3e1 * t4246 + t905 - t907 - t921 + t997;
  t4270 = t2224 * t3913;
  t4274 = t785 * t3913;
  t4282 = t233 * t429;
  t4302 = t89 * t286 * t317 * t199;
  t4303 = t724 * t1224;
  t4308 = t906 * t710;
  t4310 = -0.2e1 * t2334 * t1229 - t876 * t2475 - 0.3e1 * t843 * t2480 - 0.6e1 * t3911 + 0.6e1 * t3914 - 0.2e1 * t3932 + 0.2e1 * t3936 + 0.2e1 * t3941 - t4302 + t4303 + t4308;
  t4315 = my_piecewise5(t52, 0, t55, 0, t4157 + t4203 + t4204 + t4238 + t4310 - 0.3e1 * t4270 + 0.3e1 * t4274 - 0.12e2 * t4126 * t3790 - 0.3e1 * t4130 * t257 + 0.6e1 * t979 * t4107 - 0.2e1 * t986 * t4107 + 0.3e1 * t2265 * t1244 - 0.6e1 * t974 * t4070 + 0.6e1 * t1008 * t3816 - 0.3e1 * t4067 * t529 - 0.18e2 * t4126 * t4256 + 0.18e2 * t2262 * t4242 + 0.3e1 * t2323 * t1262 - 0.3e1 * t2326 * t1262 + 0.6e1 * t1000 * t183 * t4022 + 0.3e1 * t173 * t4214 * t3223 + 0.11e2 * t2695 * t1692 * t1021 + 0.3e1 * t1281 * t1481 * t909 - 0.6e1 * t2259 * t2991 * t4248 - 0.6e1 * t959 * t960 * t3678 + 0.6e1 * t785 * t968 * t2642 + t4266 - t4213 - t4209 - t4210 + 0.3e1 * t89 * t289 * t1480 * t4135 + 0.6e1 * t2311 * t1989 * t1228 * t91 - 0.6e1 * t959 * t510 * t93 * t871 + 0.18e2 * t423 * t4282 * t3222 * t1243 + t4110 + t4053 + t3992 - 0.6e1 * t3907);
  t4322 = my_piecewise3(t3, 0, t8 * t73 * t1292 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.25e2 / 0.162e3 * t1136 + 0.5e1 / 0.54e2 * t30 * t129 * t924 + 0.8e2 / 0.243e3 * t30 * t223 * t356 - 0.1e2 / 0.81e2 * t30 * t110 * t1036 + t87 * t1290 + t47 * t4315));
  tv4rhosigma2lapl0 = 0.2e1 * rho[0] * t4322 + 0.2e1 * t1296;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  t4341 = t367 * params->csk_a * t91;
  t4342 = t491 * t4341;
  t4345 = t3447 * t1487;
  t4346 = t89 * t4345;
  t4349 = t173 * t4345;
  t4352 = t1505 * t4345;
  t4353 = t3032 * t91;
  t4354 = t491 * t4353;
  t4357 = t423 * t4345;
  t4358 = t183 * t4353;
  t4365 = t97 * t4353;
  t4367 = -0.12e2 * t3176 * t4342 + t4346 * t4365 + 0.11e2 * t4346 * t983 - 0.11e2 * t4349 * t983 - 0.12e2 * t4352 * t4354 - 0.7e1 * t4352 * t4358 + 0.7e1 * t4352 * t987 + 0.18e2 * t4357 * t4358 - t1064 + t1143 + t1155 - 0.4e1 * t1222 - t1234 + t1304 + t1306 - t319 - t374 + t814 - t817 + t837;
  t4373 = t1505 * t3175;
  t4381 = t183 * t1313 * t91;
  t4392 = t89 * t3379;
  t4400 = t1313 * t286;
  t4407 = t610 * t286;
  t4418 = t440 * t180;
  t4419 = t235 * t286;
  t4420 = t4418 * t4419;
  t4424 = t367 * t440 * t118;
  t4428 = -0.7e1 * t4349 * t4365 + 0.6e1 * t4357 * t4365 - t4352 * t4365 - 0.6e1 * t4373 * t4342 + 0.12e2 * t4357 * t4354 - 0.7e1 * t4349 * t4358 - 0.18e2 * t4357 * t4381 - 0.18e2 * t4349 * t977 + 0.6e1 * t4357 * t977 - 0.6e1 * t4357 * t990 - 0.11e2 * t4349 * t987 - 0.12e2 * t4392 * t97 * t238 * t91 + 0.6e1 * t2224 * t183 * t3002 + 0.6e1 * t986 * t491 * t4400 + 0.6e1 * t986 * t183 * t4400 + 0.6e1 * t3399 * t97 * t4407 - 0.18e2 * t173 * t4282 * t183 * t1075 * t118 + 0.7e1 * t4349 * t4381 - 0.6e1 * t986 * t4420 + 0.18e2 * t4027 * t491 * t4424;
  t4430 = t367 * t91;
  t4451 = t173 * t3434 * t178;
  t4465 = t97 * t4400;
  t4470 = t975 * t1090;
  t4482 = -0.6e1 * t2977 * t491 * t4430 * t197 - 0.6e1 * t4373 * t1510 * t4341 - 0.4e1 * t986 * t491 * t975 * t286 + 0.11e2 * t4027 * t1510 * t4424 - 0.6e1 * t4352 * t1510 * t4353 + 0.6e1 * t979 * t4420 - 0.3e1 * t4451 * t4381 - 0.3e1 * t4451 * t983 + 0.3e1 * t89 * t4430 * t1480 * t343 + 0.6e1 * t4346 * t977 + 0.6e1 * t3978 + 0.3e1 * t1082 * t3727 - 0.6e1 * t974 * t4465 - 0.3e1 * t1077 * t3679 - 0.2e1 * t986 * t4470 - 0.3e1 * t1077 * t3723 + 0.6e1 * t979 * t4465 - 0.2e1 * t974 * t4470 + 0.6e1 * t979 * t4470 + 0.6e1 * t3990;
  t4503 = -0.6e1 * t4142 + 0.3e1 * t3656 - 0.3e1 * t3670 + 0.3e1 * t3694 + 0.3e1 * t3700 - t3702 - t3708 + 0.3e1 * t3710 + 0.3e1 * t3715 + 0.3e1 * t3732 + 0.3e1 * t3742;
  t4519 = t173 * t3843;
  t4543 = t183 * t118;
  t4559 = -0.2e1 * t3744 + 0.3e1 * t1069 * t3836 - t1095 * t3836 + 0.3e1 * t1069 * t3897 + 0.3e1 * t1087 * t3816 - 0.4e1 * t720 * t481 * t348 * t286 + 0.11e2 * t4519 * t1692 * t3545 * t118 - 0.3e1 * t1095 * t3866 + 0.3e1 * t1114 * t2107 - 0.6e1 * t743 * t439 * t4419 - 0.2e1 * t630 * t3494 + t3844 * t1684 * t2063 * t367 - 0.2e1 * t1095 * t3878 + 0.3e1 * t1069 * t3866 - 0.3e1 * t1072 * t3897 + 0.3e1 * t173 * t4430 * t1481 * t4543 + 0.3e1 * t3601 * t188 * t1017 + 0.6e1 * t3455 * t1989 * t1017 + 0.6e1 * t1970 * t1675 * t1056 * t91 + 0.3e1 * t1095 * t2121;
  t4571 = -t1072 * t3836 + 0.3e1 * t1095 * t2037 - t1078 + t1083 - t1085 + t1317 - t1321 - t1324 - 0.2e1 * t3799 - t3839 - t3855 + t3889 - 0.3e1 * t3893 - t3895 - 0.4e1 * t4168 - 0.6e1 * t4170 + 0.2e1 * t4204 - 0.2e1 * t4209 - 0.2e1 * t4210 - 0.2e1 * t4213;
  t4575 = t982 * t3661;
  t4580 = t2987 * t969;
  t4583 = t173 * t3398;
  t4593 = -0.6e1 * t4583 * t1318 * t1090 - 0.6e1 * t4583 * t1966 * t4407 + 0.6e1 * t785 * t968 * t3002 + 0.18e2 * t3360 * t4580 + 0.18e2 * t3363 * t3906 + 0.18e2 * t3380 * t4575 - 0.18e2 * t4392 * t4575 + t1088 + t1115 + t1188 - t1190 - t1195 + t1350 + t1354 - t1357 + t1358 - t1359 + t905 - t907 - t921;
  t4600 = t2991 * t969;
  t4625 = -t1985 * t1057 - 0.3e1 * t1069 * t2161 - 0.2e1 * t1072 * t3938 - 0.3e1 * t3911 + 0.3e1 * t3914 - t3932 + t3936 + t3941 - 0.2e1 * t4302 + 0.2e1 * t4303 + 0.2e1 * t4308;
  t4630 = my_piecewise5(t52, 0, t55, 0, -0.3e1 * t3652 + t4593 + t4571 + t4559 + t4503 + t4482 + t4428 + t4367 - 0.6e1 * t4246 - 0.6e1 * t3357 * t4600 + 0.18e2 * t3360 * t4600 - 0.6e1 * t3363 * t4600 - 0.18e2 * t3363 * t4580 - 0.6e1 * t4270 + 0.6e1 * t4274 + t4625 - 0.12e2 * t3363 * t2983 * t969 + 0.6e1 * t4092 + 0.18e2 * t3363 * t491 * t118 * t858 - 0.4e1 * t4095 + 0.6e1 * t4089 + 0.6e1 * t4082 - 0.2e1 * t4050 - 0.6e1 * t4036 + 0.6e1 * t4034 + 0.6e1 * t3998 - 0.2e1 * t3993 - 0.3e1 * t3907);
  t4637 = my_piecewise3(t3, 0, t8 * t73 * t1364 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.25e2 / 0.81e2 * t1216 + 0.5e1 / 0.27e2 * t30 * t129 * t1036 + 0.4e2 / 0.243e3 * t30 * t223 * t380 - 0.5e1 / 0.81e2 * t30 * t110 * t1125 + t87 * t1362 + t47 * t4630));
  tv4rhosigmalapl20 = 0.2e1 * rho[0] * t4637 + 0.2e1 * t1368;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmatau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  t4648 = 0.6e1 * t1222;
  t4650 = t173 * t1404 * t429;
  t4653 = t1373 * t176;
  t4654 = t4653 * t429;
  t4655 = t89 * t4654;
  t4658 = t173 * t4654;
  t4661 = t423 * t4654;
  t4664 = 0.18e2 * t4650 * t3662 + 0.18e2 * t4661 * t3704 - 0.6e1 * t4655 * t3720 + 0.18e2 * t4658 * t3720 - t1064 + t1391 + t1392 + t1394 - t319 - t374 - t4648 + t814 - t817 + t837;
  t4666 = t440 * t197 * t91;
  t4667 = t183 * t4666;
  t4697 = -0.9e1 * t1077 * t183 * t1832 * t286 + 0.9e1 * t1082 * t97 * t1536 * t286 - 0.9e1 * t1077 * t1832 * t1090 - 0.12e2 * t4661 * t491 * t4666 + 0.18e2 * t4661 * t3688 - 0.6e1 * t4661 * t3720 - 0.18e2 * t4655 * t859 + 0.18e2 * t4658 * t4667 - 0.18e2 * t4661 * t4667 + 0.9e1 * t3978 + 0.9e1 * t3990 - 0.3e1 * t3993 + 0.9e1 * t3998 + 0.9e1 * t4034;
  t4706 = t1373 * t1485;
  t4707 = t1505 * t4706;
  t4711 = t89 * t4706;
  t4714 = t173 * t4706;
  t4717 = t423 * t4706;
  t4724 = -0.7e1 * t4714 * t3749 + 0.18e2 * t4717 * t3749 - t4707 * t3754 + 0.12e2 * t4717 * t3770 + 0.6e1 * t4711 * t3784 - 0.18e2 * t4714 * t3784 - 0.6e1 * t4707 * t3827 - 0.9e1 * t4036 - 0.3e1 * t4050 + 0.9e1 * t4082 + 0.9e1 * t4089 + 0.9e1 * t4092 - 0.6e1 * t4095 - 0.9e1 * t4142;
  t4739 = t439 * t441 * t286;
  t4743 = t481 * t189 * t286;
  t4746 = t182 * t1373;
  t4748 = t1692 * t4746 * params->csk_a;
  t4757 = t1509 * t1373;
  t4759 = t1684 * t4757 * t440;
  t4766 = -0.6e1 * t1095 * t431 * t451 * t286 + 0.9e1 * t1069 * t4739 - 0.9e1 * t1072 * t4743 + 0.9e1 * t1095 * t2402 - 0.9e1 * t1095 * t4739 - 0.7e1 * t4707 * t3749 + t4711 * t3754 - 0.7e1 * t4714 * t3754 + 0.6e1 * t4717 * t3754 - 0.18e2 * t4717 * t3763 - 0.12e2 * t4707 * t3770 - 0.11e2 * t4714 * t3781 + 0.11e2 * t3844 * t4759 - 0.6e1 * t4707 * t3886 + 0.7e1 * t4519 * t4748;
  t4769 = t423 * t4653;
  t4770 = t433 * t91;
  t4779 = t1373 * t1480;
  t4780 = t173 * t4779;
  t4789 = t1373 * t91;
  t4797 = t173 * t4653;
  t4805 = t1692 * t4746 * t440;
  t4810 = -0.6e1 * t4707 * t1684 * t1721 * t91 - 0.6e1 * t4769 * t431 * t4770 * t197 + 0.3e1 * t89 * t4789 * t1953 + 0.9e1 * t1095 * t2341 - 0.12e2 * t1416 * t3790 - 0.3e1 * t4780 * t241 - 0.3e1 * t4780 * t257 - 0.6e1 * t4717 * t3777 + 0.6e1 * t4717 * t3784 - 0.18e2 * t4797 * t3796 + 0.11e2 * t4711 * t3805 - 0.11e2 * t4714 * t3805 - 0.12e2 * t4717 * t3827 + 0.7e1 * t3844 * t4805;
  t4814 = t481 * t482 * t286;
  t4829 = t1675 * t433 * t1373 * t440;
  t4838 = 0.9e1 * t1087 * t188 * t474 * t286 + 0.9e1 * t1069 * t4743 + 0.9e1 * t1069 * t4814 - 0.3e1 * t1072 * t4814 - 0.3e1 * t1095 * t4814 + 0.9e1 * t1114 * t2414 + 0.18e2 * t3844 * t4829 - t1078 - 0.6e1 * t4168 - 0.9e1 * t4170 + 0.3e1 * t4204 - 0.3e1 * t4209 - 0.3e1 * t4210 - 0.3e1 * t4213;
  t4841 = t1083 - t1085 - t1407 + t1410 - t1412 - t1413 + t1414 + t1088 - t1415 + t1115 + t905 - t907 - t921 - 0.9e1 * t4246;
  t4852 = t89 * t4779;
  t4867 = t1684 * t4757;
  t4869 = -0.6e1 * t1072 * t481 * t1061 + 0.3e1 * t173 * t4789 * t1500 + 0.6e1 * t4717 * t1675 * t4770 - 0.9e1 * t1069 * t2480 - 0.3e1 * t1095 * t2475 + 0.3e1 * t4852 * t252 + t3844 * t4867 + 0.6e1 * t4711 * t3916 + 0.11e2 * t4714 * t3925 + t1418 - 0.9e1 * t4270 + 0.9e1 * t4274 - 0.3e1 * t4302 + 0.3e1 * t4303 + 0.3e1 * t4308;
  t4873 = my_piecewise5(t52, 0, t55, 0, t4664 + t4697 + t4724 + t4766 + t4810 + t4838 + t4841 + t4869);
  t4880 = my_piecewise3(t3, 0, t8 * t73 * t1431 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.25e2 / 0.54e2 * t1302 + 0.5e1 / 0.18e2 * t30 * t129 * t1125 + t87 * t1429 + t47 * t4873));
  tv4rholapl30 = 0.2e1 * rho[0] * t4880 + 0.2e1 * t1435;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rhotau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 0] += tv4rhotau30;

  t4891 = t310 * t310;
  t4892 = t173 * t4891;
  t4900 = t317 * t317;
  t4903 = 0.3e1 * t173 * t4900 * t184;
  t4904 = t89 * t4900;
  t4906 = 0.3e1 * t4904 * t199;
  t4909 = 0.3e1 * t4904 * t201;
  t4910 = t89 * t4891;
  t4920 = t173 * t317 * t310 * t197 * t513;
  t4923 = t97 * t3649 * t197;
  t4924 = t857 * t4923;
  t4926 = t183 * t1243;
  t4927 = t3905 * t4926;
  t4929 = t4891 * t197;
  t4930 = t423 * t4929;
  t4933 = t2763 * t1262;
  t4935 = 0.3e1 * t4910 * t1482 + 0.6e1 * t4910 * t1489 + 0.3e1 * t4892 * t1500 - 0.18e2 * t4930 * t1607 - t319 - t321 + t4909 - 0.18e2 * t4920 + 0.18e2 * t4924 - 0.18e2 * t4927 - 0.18e2 * t4933;
  t4938 = t647 * t97 * t317;
  t4939 = t843 * t4938;
  t4941 = t173 * t4929;
  t4944 = t876 * t2767;
  t4946 = t2687 * t1248;
  t4948 = t89 * t4929;
  t4953 = t876 * t4938;
  t4955 = t876 * t2736;
  t4957 = t2763 * t1269;
  t4962 = t885 * t2782;
  t4964 = t4891 * t176;
  t4965 = t423 * t4964;
  t4969 = t439 * t441 * t317;
  t4970 = t843 * t4969;
  t4972 = t481 * t1186;
  t4973 = t839 * t4972;
  t4977 = t839 * t4938;
  t4982 = t173 * t4964;
  t4990 = t89 * t3696 * t188 * t1228 * t197;
  t4993 = -0.6e1 * t89 * t4964 * t1576 - 0.6e1 * t4965 * t1576 + 0.18e2 * t4982 * t1576 + 0.18e2 * t4965 * t1591 + 0.18e2 * t4965 * t1602 + 0.4e1 * t1188 + 0.18e2 * t4962 + 0.18e2 * t4970 - 0.18e2 * t4973 - 0.6e1 * t4977 + 0.18e2 * t4990;
  t5001 = t4891 * t1485;
  t5002 = t1505 * t5001;
  t5011 = t876 * t2914;
  t5020 = t843 * t2893;
  t5022 = t423 * t5001;
  t5027 = t4891 * t1480;
  t5028 = t173 * t5027;
  t5036 = t173 * t5001;
  t5039 = t89 * t5001;
  t5042 = 0.3e1 * t89 * t5027 * t190 - 0.6e1 * t5022 * t1689 - 0.11e2 * t5036 * t1715 - 0.6e1 * t5002 * t1722 - 0.6e1 * t4965 * t1740 + 0.6e1 * t5022 * t1758 + 0.6e1 * t5039 * t1758 - 0.6e1 * t5002 * t1765 - 0.12e2 * t5022 * t1765 - 0.3e1 * t5028 * t190 - 0.18e2 * t5020;
  t5046 = t2684 * t1229;
  t5060 = t4900 * t176;
  t5061 = t173 * t5060;
  t5063 = 0.3e1 * t5061 * t190;
  t5065 = 0.3e1 * t5061 * t207;
  t5069 = 0.3e1 * t89 * t5060 * t190;
  t5088 = 0.12e2 * t5022 * t1678 - 0.7e1 * t5002 * t1694 + 0.18e2 * t5022 * t1694 - 0.7e1 * t5036 * t1694 - 0.18e2 * t5022 * t1708 + 0.7e1 * t5002 * t1715 - t5002 * t1749 + 0.6e1 * t5022 * t1749 - 0.7e1 * t5036 * t1749 + t5039 * t1749 + t5069;
  t5092 = my_piecewise5(t52, 0, t55, 0, -0.6e1 * t5011 + t4903 - t4906 + 0.4e1 * t1200 - 0.4e1 * t1195 - 0.4e1 * t1197 - 0.4e1 * t1190 - 0.4e1 * t1193 - 0.9e1 * t1164 + 0.4e1 * t1155 + 0.4e1 * t1147 + 0.4e1 * t1141 + 0.4e1 * t1143 + t5088 + 0.11e2 * t5039 * t1664 - 0.11e2 * t5036 * t1664 + 0.18e2 * t5002 * t1689 - 0.12e2 * t5002 * t1678 + 0.11e2 * t5002 * t1702 - 0.6e1 * t5002 * t1686 - 0.12e2 * t4930 * t1614 + 0.18e2 * t4941 * t1607 - 0.18e2 * t4948 * t1551 + 0.18e2 * t4941 * t1551 + 0.11e2 * t4892 * t1493 - t5065 - t5063 - 0.18e2 * t5036 * t1758 - 0.12e2 * t4948 * t1656 - 0.3e1 * t5028 * t207 - 0.18e2 * t4982 * t1648 + 0.7e1 * t5036 * t1708 + t4993 + 0.6e1 * t423 * t4891 * t1497 + t1505 * t4891 * t1511 - 0.6e1 * t4953 + 0.18e2 * t4955 - 0.12e2 * t4957 + 0.18e2 * t4944 + 0.18e2 * t4946 + 0.18e2 * t4939 + t4935 - 0.12e2 * t5046 + t5042);
  t5098 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (-0.2e2 / 0.81e2 * t30 * t110 * t1204 + t47 * t5092));
  tv4sigma40 = 0.2e1 * rho[0] * t5098;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  t5106 = t136 * t1138;
  t5107 = t5106 * t197;
  t5108 = t173 * t5107;
  t5114 = -0.6e1 * t423 * t5107 * t1569 + 0.18e2 * t5108 * t1569 + t1144 + t1156 + t1218 + t1225 - t1393 - t319 - t347 - t3648 + t4903 - t4906 + t4909;
  t5115 = t440 * t1138;
  t5116 = t5115 * t197;
  t5120 = t3691 * t118;
  t5121 = t183 * t5120;
  t5122 = t979 * t5121;
  t5123 = 0.9e1 * t5122;
  t5124 = t97 * t5120;
  t5125 = t974 * t5124;
  t5126 = 0.3e1 * t5125;
  t5130 = t979 * t5124;
  t5131 = 0.9e1 * t5130;
  t5132 = t986 * t5124;
  t5133 = 0.3e1 * t5132;
  t5134 = t3649 * t982;
  t5135 = t979 * t5134;
  t5136 = 0.9e1 * t5135;
  t5138 = t5115 * t183 * t197;
  t5147 = t3905 * t183 * t958;
  t5148 = 0.9e1 * t5147;
  t5149 = t4088 * t1348;
  t5150 = 0.9e1 * t5149;
  t5151 = t1000 * t4091;
  t5152 = 0.9e1 * t5151;
  t5154 = t986 * t491 * t5120;
  t5155 = 0.6e1 * t5154;
  t5156 = -0.18e2 * t89 * t5107 * t1551 - 0.6e1 * t2259 * t97 * t5116 - 0.12e2 * t2982 * t491 * t5116 + 0.18e2 * t3687 * t2293 - 0.18e2 * t2982 * t5138 + t5123 - t5126 + t5131 - t5133 + t5136 + t5148 + t5150 + t5152 - t5155;
  t5158 = t1000 * t4033;
  t5159 = 0.9e1 * t5158;
  t5160 = t986 * t5121;
  t5161 = 0.9e1 * t5160;
  t5164 = t974 * t5134;
  t5165 = 0.9e1 * t5164;
  t5173 = t96 * t1138;
  t5175 = t1989 * t5173 * params->csk_a;
  t5182 = t1748 * t1138 * t180 * t182;
  t5186 = t1989 * t2002 * t1138;
  t5188 = 0.18e2 * t5108 * t1551 + 0.18e2 * t3687 * t2255 + 0.18e2 * t2262 * t5138 + 0.11e2 * t2311 * t5175 + t2311 * t5186 - 0.7e1 * t2320 * t5182 + 0.7e1 * t3761 * t2438 - 0.9e1 * t4920 + 0.9e1 * t4924 - 0.9e1 * t4927 + t5159 - t5161 - t5165;
  t5197 = t1675 * t1677 * t1138;
  t5206 = t1757 * t1138 * t62 * t96;
  t5215 = t720 * t481 * t1223 * t118;
  t5216 = 0.6e1 * t5215;
  t5217 = t173 * t5106;
  t5220 = t89 * t5106;
  t5227 = -0.11e2 * t2308 * t1692 * t441 * t1138 + 0.3e1 * t5220 * t1953 - 0.3e1 * t5217 * t1967 - 0.7e1 * t2308 * t5182 - 0.7e1 * t2308 * t5186 - 0.18e2 * t2308 * t5206 - 0.6e1 * t3761 * t2314 + 0.18e2 * t2317 * t5182 + 0.6e1 * t2317 * t5186 + 0.12e2 * t2317 * t5197 + 0.6e1 * t2317 * t5206 - t2320 * t5186 + 0.7e1 * t3747 * t2353 - t5216;
  t5245 = t630 * t4208;
  t5246 = 0.3e1 * t5245;
  t5257 = -0.6e1 * t2320 * t1684 * t1685 * t1138 - 0.3e1 * t5217 * t1953 - 0.12e2 * t5220 * t1961 - 0.11e2 * t2308 * t5175 + 0.6e1 * t2311 * t5206 - 0.12e2 * t3758 * t2314 - 0.6e1 * t2317 * t3872 - 0.18e2 * t3795 * t2350 - 0.18e2 * t3758 * t2353 + 0.11e2 * t3761 * t2395 - 0.6e1 * t3761 * t2448 - 0.9e1 * t4933 - t5246;
  t5263 = t2687 * t439 * t3256;
  t5264 = 0.9e1 * t5263;
  t5278 = -0.6e1 * t423 * t3685 * t2418 - 0.12e2 * t2320 * t5197 + 0.18e2 * t3761 * t2383 + 0.9e1 * t4939 + 0.9e1 * t4944 + 0.9e1 * t4946 - 0.3e1 * t4953 + 0.9e1 * t4955 - 0.6e1 * t4957 + 0.9e1 * t4962 + 0.9e1 * t4970 - 0.9e1 * t4973 - 0.3e1 * t4977 - t5264;
  t5286 = t968 * t3909;
  t5287 = t785 * t5286;
  t5288 = 0.9e1 * t5287;
  t5289 = 0.9e1 * t4990 - 0.4e1 * t1238 - 0.4e1 * t1240 + 0.4e1 * t1245 - t1267 + t1274 + 0.4e1 * t1279 + 0.4e1 * t1282 + t1189 - t1191 - t1196 - t1287 + t5288;
  t5290 = t2224 * t5286;
  t5291 = 0.9e1 * t5290;
  t5293 = t2224 * t1966 * t3909;
  t5294 = 0.9e1 * t5293;
  t5310 = 0.6e1 * t2311 * t1989 * t5173 + 0.3e1 * t5220 * t1482 + t3761 * t2478 + 0.6e1 * t3758 * t2483 + 0.11e2 * t3747 * t2506 + 0.3e1 * t3774 * t279 - 0.3e1 * t5011 - 0.9e1 * t5020 - 0.6e1 * t5046 - t5063 - t5065 + t5069 - t5291 - t5294;
  t5314 = my_piecewise5(t52, 0, t55, 0, t5114 + t5156 + t5188 + t5227 + t5257 + t5278 + t5289 + t5310);
  t5320 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (0.5e1 / 0.54e2 * t30 * t129 * t1204 - 0.5e1 / 0.27e2 * t30 * t110 * t1290 + t47 * t5314));
  tv4sigma3lapl0 = 0.2e1 * rho[0] * t5320;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 0] += tv4sigma3tau0;

  t5330 = t3980 * t197;
  t5334 = t183 * t5330;
  t5339 = -0.12e2 * t3363 * t491 * t5330 + 0.18e2 * t3360 * t5334 + 0.18e2 * t3363 * t4926 - 0.18e2 * t3363 * t5334 - t1165 + t1232 + t1233 + t1304 + t1306 - t319 - t374 - t4648 + t4903 - t4906 + t4909;
  t5341 = t97 * t313 * params->csk_a;
  t5346 = t97 * t5330;
  t5354 = t1077 * t3649 * t512;
  t5358 = t1082 * t4923;
  t5362 = t1077 * t183 * t3649 * t93;
  t5371 = 0.18e2 * t3363 * t2616 - 0.6e1 * t3357 * t5346 + 0.18e2 * t3360 * t5346 - 0.6e1 * t3363 * t5346 + 0.18e2 * t3380 * t5341 - 0.18e2 * t4392 * t5341 + 0.12e2 * t5122 - 0.4e1 * t5125 + 0.12e2 * t5130 - 0.4e1 * t5132 + 0.12e2 * t5135 + 0.12e2 * t5147 + 0.12e2 * t5149 - 0.3e1 * t5354 + 0.3e1 * t5358 - 0.3e1 * t5362;
  t5383 = t1989 * t1247;
  t5389 = t1675 * t1677 * t310;
  t5393 = t1692 * t1693 * t310;
  t5400 = t1748 * t3986;
  t5403 = -0.12e2 * t2675 * t3475 + 0.7e1 * t3485 * t2847 - 0.11e2 * t3448 * t5383 - 0.7e1 * t3448 * t5400 + 0.11e2 * t3455 * t5383 + 0.18e2 * t3458 * t5393 - 0.12e2 * t3485 * t5389 - 0.7e1 * t3485 * t5393 - 0.3e1 * t4920 + 0.3e1 * t4924 - 0.3e1 * t4927 + 0.12e2 * t5151 - 0.8e1 * t5154 + 0.12e2 * t5158 - 0.12e2 * t5160 - 0.12e2 * t5164;
  t5413 = t367 * t310;
  t5420 = t1989 * t1254;
  t5441 = -0.12e2 * t1087 * t481 * t1228 * t176 - 0.6e1 * t3458 * t1675 * t1268 + 0.3e1 * t89 * t5413 * t1953 - 0.3e1 * t3435 * t205 * t2828 - 0.6e1 * t2730 * t3475 - 0.18e2 * t3458 * t2829 - 0.11e2 * t3448 * t2847 - 0.3e1 * t3435 * t4135 - 0.7e1 * t3448 * t5393 - 0.18e2 * t3448 * t5420 + t3455 * t5400 + 0.6e1 * t3455 * t5420 + 0.12e2 * t3458 * t5389 + 0.6e1 * t3458 * t5400 + 0.6e1 * t3458 * t5420 - t3485 * t5400;
  t5448 = t1095 * t431 * t451 * t317;
  t5456 = t1069 * t4969;
  t5461 = t1069 * t4938;
  t5463 = t1095 * t4938;
  t5464 = t1069 * t4972;
  t5466 = t1072 * t4972;
  t5468 = t1095 * t2736;
  t5470 = t1095 * t2767;
  t5472 = t1072 * t4938;
  t5475 = t1087 * t188 * t1223 * t93;
  t5481 = -0.6e1 * t3485 * t1684 * t1685 * t310 - 0.18e2 * t323 * t439 * t3545 * t197 - 0.6e1 * t423 * t313 * t3565 - 0.6e1 * t2730 * t3499 + 0.11e2 * t2730 * t3524 - 0.2e1 * t5448 + 0.3e1 * t5456 + 0.3e1 * t5461 - t5463 + 0.3e1 * t5464 - 0.3e1 * t5466 + 0.3e1 * t5468 + 0.3e1 * t5470 - t5472 + 0.3e1 * t5475;
  t5484 = t1095 * t4969;
  t5488 = t1114 * t2782;
  t5501 = 0.18e2 * t2730 * t3509 + 0.7e1 * t3448 * t2829 - 0.3e1 * t4933 + 0.3e1 * t4939 + 0.3e1 * t4944 + 0.3e1 * t4946 - t4953 + 0.3e1 * t4955 - 0.2e1 * t4957 + 0.3e1 * t4962 + 0.3e1 * t4970 - 0.8e1 * t5215 - 0.4e1 * t5245 - 0.12e2 * t5263 - 0.3e1 * t5484 + 0.3e1 * t5488;
  t5512 = -0.3e1 * t4973 - t4977 + 0.3e1 * t4990 + 0.4e1 * t1316 - 0.4e1 * t1320 - 0.4e1 * t1323 + 0.4e1 * t1349 + 0.4e1 * t1353 - t1357 + t1358 + t1284 - t1285 - t1286 - t1359 + 0.12e2 * t5287 - 0.12e2 * t5290;
  t5516 = t2763 * t1057;
  t5519 = t1072 * t481 * t1223;
  t5524 = t1069 * t2893;
  t5537 = 0.3e1 * t3601 * t188 * t1228 + 0.6e1 * t3455 * t1989 * t1228 + 0.3e1 * t173 * t5413 * t1500 + 0.11e2 * t2695 * t1692 * t3545 + 0.6e1 * t2675 * t3612 + t2730 * t3596 - t5011 - 0.3e1 * t5020 - 0.2e1 * t5046 - t5063 - t5065 + t5069 - 0.12e2 * t5293 - t5516 - 0.2e1 * t5519 - 0.3e1 * t5524;
  t5541 = my_piecewise5(t52, 0, t55, 0, t5339 + t5371 + t5403 + t5441 + t5481 + t5501 + t5512 + t5537);
  t5547 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (0.5e1 / 0.27e2 * t30 * t129 * t1290 - 0.1e2 / 0.81e2 * t30 * t110 * t1362 + t47 * t5541));
  tv4sigma2lapl20 = 0.2e1 * rho[0] * t5547;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 0] += tv4sigma2tau20;

  t5556 = t975 * t2271;
  t5561 = 0.18e2 * t4661 * t1933 + 0.18e2 * t4658 * t5556 + t1143 + t1155 - t1164 - 0.8e1 * t1222 + t1391 + t1392 + t1394 - t319 - t374 + t4903 - t4906 + t4909;
  t5573 = t4418 * t637;
  t5585 = -0.12e2 * t4661 * t491 * t975 * t197 + 0.18e2 * t4650 * t1313 * t1550 - 0.18e2 * t4655 * t1315 + 0.18e2 * t4661 * t1913 - 0.6e1 * t4655 * t5556 + 0.18e2 * t4658 * t5573 - 0.6e1 * t4661 * t5556 - 0.18e2 * t4661 * t5573 + t5123 - t5126 + t5131 - 0.9e1 * t5354 + 0.9e1 * t5358 - 0.9e1 * t5362;
  t5588 = t1675 * t1677 * t118;
  t5591 = t1748 * t4543;
  t5599 = t1989 * t2002 * t118;
  t5601 = -0.18e2 * t4717 * t1980 + t4711 * t5599 - 0.7e1 * t4714 * t5591 + 0.12e2 * t4717 * t5588 + 0.18e2 * t4717 * t5591 - t5133 + t5136 + t5148 + t5150 + t5152 - t5155 + t5159 - t5161 - t5165;
  t5609 = t1989 * t1327;
  t5616 = t1663 * t982;
  t5631 = t1373 * t118;
  t5635 = -0.12e2 * t1416 * t481 * t1655 * t118 + 0.3e1 * t89 * t5631 * t1953 - 0.6e1 * t4707 * t1999 - 0.12e2 * t4717 * t1999 - 0.3e1 * t4780 * t353 - 0.12e2 * t4707 * t5588 - 0.7e1 * t4707 * t5591 - t4707 * t5599 + 0.6e1 * t4711 * t5609 - 0.7e1 * t4714 * t5599 - 0.18e2 * t4714 * t5609 - 0.11e2 * t4714 * t5616 + 0.6e1 * t4717 * t5599 + 0.6e1 * t4717 * t5609;
  t5666 = -0.6e1 * t4707 * t1684 * t1685 * t118 + 0.7e1 * t1943 * t4748 - 0.18e2 * t4797 * t1957 + 0.11e2 * t2010 * t4759 + 0.7e1 * t2010 * t4805 + 0.18e2 * t2010 * t4829 - 0.11e2 * t4714 * t2050 - 0.6e1 * t4707 * t2065 - 0.6e1 * t4717 * t2086 - 0.6e1 * t4769 * t2112 - 0.3e1 * t4780 * t343 + 0.11e2 * t4711 * t5616 - 0.6e1 * t5448 + 0.9e1 * t5456;
  t5677 = 0.9e1 * t5461 - 0.3e1 * t5463 + 0.9e1 * t5464 - 0.9e1 * t5466 + 0.9e1 * t5468 + 0.9e1 * t5470 - 0.3e1 * t5472 + 0.9e1 * t5475 - 0.9e1 * t5484 + 0.9e1 * t5488 - t5216 - t5246 - t5264 + t1316;
  t5679 = -t1320 - t1323 - t1407 + t1410 - t1412 + t1349 + t1353 - t1413 + t1414 + t1188 - t1190 - t1195 - t1415 + t5288;
  t5696 = 0.3e1 * t173 * t5631 * t1500 + 0.6e1 * t4711 * t1989 * t348 + t2010 * t4867 + 0.11e2 * t4714 * t2156 + 0.6e1 * t4717 * t2164 + 0.3e1 * t4852 * t349 + t1418 - t5063 - t5065 + t5069 - t5291 - t5294 - 0.3e1 * t5516 - 0.6e1 * t5519 - 0.9e1 * t5524;
  t5700 = my_piecewise5(t52, 0, t55, 0, t5561 + t5585 + t5601 + t5635 + t5666 + t5677 + t5679 + t5696);
  t5706 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (0.5e1 / 0.18e2 * t30 * t129 * t1362 - 0.5e1 / 0.81e2 * t30 * t110 * t1429 + t47 * t5700));
  tv4sigmalapl30 = 0.2e1 * rho[0] * t5706;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmatau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 0] += tv4sigmatau30;

  t5715 = t367 * t367;
  t5718 = t89 * t5715;
  t5721 = t173 * t5715;
  t5735 = t5715 * t197;
  t5739 = t5715 * t176;
  t5740 = t89 * t5739;
  t5745 = 0.18e2 * t173 * t5735 * t1551 - 0.18e2 * t5740 * t1556 - 0.6e1 * t5740 * t1576 - t319 - t374 + t4903 - t4906 + t4909 - 0.18e2 * t5354 + 0.18e2 * t5358 - 0.18e2 * t5362;
  t5747 = t173 * t5739;
  t5750 = t423 * t5739;
  t5780 = -0.6e1 * t5463 + 0.18e2 * t5464 - 0.18e2 * t5466 + 0.18e2 * t5468 + 0.18e2 * t5470 - 0.6e1 * t5472 + 0.18e2 * t5475 - 0.18e2 * t5484 + 0.18e2 * t5488 - 0.4e1 * t1406 + 0.4e1 * t1409;
  t5792 = t5715 * t1485;
  t5793 = t423 * t5792;
  t5796 = t173 * t5792;
  t5801 = t1505 * t5792;
  t5816 = -0.11e2 * t5796 * t1664 - 0.6e1 * t5801 * t1686 + 0.18e2 * t5801 * t1689 + 0.11e2 * t5801 * t1702 + 0.7e1 * t5796 * t1708 - 0.11e2 * t5796 * t1715 + 0.7e1 * t5801 * t1715 - 0.6e1 * t5801 * t1722 - 0.6e1 * t5750 * t1740 - 0.12e2 * t5793 * t1765 - 0.18e2 * t5524;
  t5820 = t5715 * t1480;
  t5821 = t173 * t5820;
  t5836 = t89 * t5792;
  t5864 = 0.12e2 * t5793 * t1678 + 0.18e2 * t5793 * t1694 - 0.7e1 * t5796 * t1694 - 0.18e2 * t5793 * t1708 + 0.6e1 * t5793 * t1749 - 0.7e1 * t5796 * t1749 - t5801 * t1749 + t5836 * t1749 - 0.18e2 * t5796 * t1758 + 0.6e1 * t5836 * t1758 - 0.6e1 * t5801 * t1765;
  t5868 = my_piecewise5(t52, 0, t55, 0, t5864 + t5816 + t5780 + 0.4e1 * t1417 - 0.4e1 * t1411 + 0.4e1 * t1390 + t5745 - 0.4e1 * t1287 + 0.4e1 * t1274 - 0.4e1 * t1267 + 0.4e1 * t1225 - 0.9e1 * t1222 + 0.4e1 * t1218 - 0.12e2 * t5519 - 0.6e1 * t5516 - 0.3e1 * t5821 * t207 + 0.11e2 * t5836 * t1664 - 0.12e2 * t5801 * t1678 - 0.7e1 * t5801 * t1694 + 0.6e1 * t5793 * t1758 - 0.3e1 * t5821 * t190 - 0.6e1 * t5793 * t1689 - 0.18e2 * t5747 * t1648 - 0.18e2 * t5750 * t1633 + 0.18e2 * t5750 * t1591 + 0.18e2 * t5747 * t1576 + 0.18e2 * t5750 * t1602 + 0.18e2 * t5747 * t1633 - 0.6e1 * t5750 * t1576 + 0.6e1 * t5718 * t1489 + 0.3e1 * t5721 * t1500 + 0.11e2 * t5721 * t1493 + 0.3e1 * t5718 * t1482 + t1505 * t5715 * t1511 + 0.6e1 * t423 * t5715 * t1497 - 0.12e2 * t89 * t5735 * t1656 + 0.3e1 * t89 * t5820 * t190 - t5065 + t5069 - t5063 + 0.18e2 * t5461 + 0.18e2 * t5456 - 0.12e2 * t5448 - 0.12e2 * t5750 * t431 * t451 * t197);
  t5874 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (0.1e2 / 0.27e2 * t30 * t129 * t1429 + t47 * t5868));
  tv4lapl40 = 0.2e1 * rho[0] * t5874;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 0] += tv4lapl40;

  tv4lapl3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapltau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 0] += tv4lapltau30;

  tv4tau40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 0] += tv4tau40;

}

#endif

