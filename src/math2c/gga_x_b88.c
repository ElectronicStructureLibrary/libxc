/* 
  This file was generated automatically with scripts/math2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Mathematica source: ./mathematica/functionals/gga_x_b88.m
  Type of functional: work_gga_x
*/

void XC(math2c_gga_x_b88_enhance)
  (const XC(func_type) *p, int order, 
   FLOAT x, FLOAT *f, FLOAT *dfdx, FLOAT *d2fdx2, FLOAT *d3fdx3)
{
  gga_x_b88_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_b88_params * )(p->params);


  if(order < 0) return;

  *f = 1. + (params->beta*POW(x,2))/(1.*X_FACTOR_C + params->beta*params->gamma*x*X_FACTOR_C*asinh(x));

  if(order < 1) return;

  *dfdx = (params->beta*x*(2. - (params->beta*params->gamma*POW(x,2))/SQRT(1 + POW(x,2)) + params->beta*params->gamma*x*asinh(x)))/(X_FACTOR_C*POW(1. + params->beta*params->gamma*x*asinh(x),2));

  if(order < 2) return;

  *d2fdx2 = (params->beta*(params->beta*params->gamma*POW(x,2)*(-6. - 5.*POW(x,2)) + 2.*POW(params->beta,2)*POW(params->gamma,2)*POW(x,4)*SQRT(1 + POW(x,2)) + 2.*SQRT(1 + POW(x,2))*(1. + 1.*POW(x,2)) + POW(params->beta,2)*POW(params->gamma,2)*POW(x,3)*(-2. - 1.*POW(x,2))*asinh(x)))/(SQRT(1 + POW(x,2))*(1. + POW(x,2))*X_FACTOR_C*POW(1. + params->beta*params->gamma*x*asinh(x),3));

  if(order < 3) return;

  *d3fdx3 = (POW(params->beta,2)*params->gamma*(-18.*x - 6.*POW(params->beta,2)*POW(params->gamma,2)*POW(x,7) + POW(x,5)*(-11.000000000000004 - 6.*POW(params->beta,2)*POW(params->gamma,2) + 18.*params->beta*params->gamma*SQRT(1 + POW(x,2))) + POW(x,3)*(-26.000000000000004 + 24.*params->beta*params->gamma*SQRT(1 + POW(x,2))) + (6.*POW(params->beta,2)*POW(params->gamma,2)*POW(x,4)*SQRT(1 + POW(x,2)) - 6.000000000000001*SQRT(1 + POW(x,2))*POW(1. + 1.*POW(x,2),2) + params->beta*params->gamma*POW(x,4)*(14. + 8.000000000000002*POW(x,2)))*asinh(x) + POW(params->beta,2)*POW(params->gamma,2)*POW(x,5)*(4. + 1.*POW(x,2))*POW(asinh(x),2)))/(SQRT(1 + POW(x,2))*POW(1. + POW(x,2),2)*X_FACTOR_C*POW(1. + params->beta*params->gamma*x*asinh(x),4));
}


#define math2c_order 3
#define math2c_func  XC(math2c_gga_x_b88_enhance)

