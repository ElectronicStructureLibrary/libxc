/* 
  This file was generated automatically with ./scripts/maple2c_new.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : .//maple/mgga_vxc/mgga_x_tb09.mpl
  Type of functional: mgga_vxc
*/

#define maple2c_order 3

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t13, t14, t16, t17, t19, t22, t23, t24;
  double t25, t26, t27, t28, t30, t31, t34, t35;
  double t36, t37, t38, t43, t44, t45, t46, t48;
  double t49, t52, t53, t54, t55, t60, t62, t63;
  double t66, t70, t74, t75, t76, t77, t79, t80;
  double t81, t82, t83, t85, t86, t87, t88, t89;
  double t90, t93, t94, t95, t96, t97, t99, t100;
  double t102, t106, t107, t110, t111, t112, t113, t114;
  double t117, t119, t121, t125, t130, t133, t137, t138;
  double t139, t140, t143, t144, t146, t150, t151, t154;
  double t157, t160, t165, t167, t169, t170, t171, t172;
  double t175, t176, t178, t182, t183, t186, t190, t193;
  double t194, t195, t196, t199, t200, t202, t206, t207;
  double t210, t213, t218, t222, t224, t226, t230, t231;
  double t236, t238, t239, t245, t246, t247, t248, t249;
  double t250, t252, t253, t254, t255, t256, t257, t260;
  double t261, t262, t263, t265, t269, t271, t274, t275;
  double t276, t279, t282, t285, t288, t289, t293, t294;
  double t295, t296, t297, t301, t303, t306, t307, t309;
  double t318, t322, t330, t336, t337, t347, t351, t352;
  double t358, t359, t368, t372, t381, t382, t388, t390;
  double t391, t392, t396, t397, t398, t399, t404, t405;
  double t410, t412, t415, t418, t421, t422, t423, t427;
  double t428, t432, t435, t436, t442, t446, t454, t459;
  double t466, t473, t483, t487, t494, t495, t501, t502;
  double t506, t507, t518, t521, t524, t528, t549, t569;
  double t576, t577, t583, t584, t588, t589, t600, t603;
  double t606, t610, t631, t656, t660, t666, t667, t671;
  double t672, t673, t678, t680, t687, t689, t698, t700;
  double t701, t705, t706, t710, t714, t719, t723, t739;
  double t743, t750, t754, t757, t758, t761, t762, t765;
  double t770, t776, t781, t782, t785, t789, t792, t793;
  double t796, t800, t811, t815, t822, t826, t881, t884;
  double t885, t890, t892, t899, t901, t910, t914, t915;
  double t919, t923, t929, t946, t953, t956, t976, t987;
  double t1021, t1024, t1025, t1030, t1032, t1039, t1050, t1054;
  double t1055, t1063, t1093, t1097;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = M_CBRT2;
  t5 = t4 * t4;
  t6 = lapl[0] * t5;
  t7 = POW_1_3(rho[0]);
  t8 = t7 * t7;
  t10 = 0.1e1 / t8 / rho[0];
  t13 = tau[0] * t5;
  t14 = t13 * t10;
  t16 = sigma[0] * t5;
  t17 = rho[0] * rho[0];
  t19 = 0.1e1 / t8 / t17;
  t22 = t6 * t10 / 0.6e1 - 0.53333333333333333333e0 * t14 + 0.66666666666666666667e-1 * t16 * t19;
  t23 = fabs(t22);
  t24 = t23 < 0.50e-12;
  t25 = 0.0e0 < t22;
  t26 = my_piecewise3(t25, 0.50e-12, -0.50e-12);
  t27 = my_piecewise3(t24, t26, t22);
  t28 = xc_mgga_x_br89_get_x(t27);
  t30 = exp(t28 / 0.3e1);
  t31 = exp(-t28);
  t34 = t31 * (0.1e1 + t28 / 0.2e1);
  t35 = 0.1e1 - t34;
  t36 = t30 * t35;
  t37 = 0.1e1 / t28;
  t38 = t36 * t37;
  t43 = sqrt(0.15e2);
  t44 = (0.3e1 * params->c - 0.2e1) * t43;
  t45 = 0.1e1 / M_PI;
  t46 = M_SQRT2;
  t48 = params->alpha * sigma[0];
  t49 = t5 * t19;
  t52 = t14 - t48 * t49 / 0.8e1;
  t53 = 0.1e-9 < t52;
  t54 = my_piecewise3(t53, t52, 0.1e-9);
  t55 = sqrt(t54);
  t60 = (-0.2e1 * t3 * t38 + t44 * t45 * t46 * t55 / 0.6e1) * t5;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t60 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t62 = params->c * M_PI;
  t63 = my_piecewise3(t25, 0, 0);
  t66 = t13 * t19;
  t70 = 0.1e1 / t8 / t17 / rho[0];
  t74 = my_piecewise3(t24, t63, -0.5e1 / 0.18e2 * t6 * t19 + 0.88888888888888888889e0 * t66 - 0.17777777777777777778e0 * t16 * t70);
  t75 = t27 * t27;
  t76 = 0.1e1 / t75;
  t77 = t74 * t76;
  t79 = exp(-0.2e1 / 0.3e1 * t28);
  t80 = 0.1e1 / t79;
  t81 = t77 * t80;
  t82 = t62 * t81;
  t83 = t28 * t28;
  t85 = t83 - 0.2e1 * t28 + 0.3e1;
  t86 = 0.1e1 / t85;
  t87 = t28 - 0.2e1;
  t88 = t87 * t87;
  t89 = t86 * t88;
  t90 = t89 * t38;
  t93 = t2 * t2;
  t94 = t93 * t74;
  t95 = t76 * t80;
  t96 = t94 * t95;
  t97 = t89 * t34;
  t99 = t94 * t76;
  t100 = t80 * t86;
  t102 = t100 * t88 * t31;
  t106 = t30 * (t96 * t97 - t99 * t102 / 0.2e1);
  t107 = t106 * t37;
  t110 = 0.1e1 / t83;
  t111 = t36 * t110;
  t112 = t62 * t111;
  t113 = t100 * t88;
  t114 = t77 * t113;
  t117 = t44 * t45;
  t119 = t46 / t55;
  t121 = t5 * t70;
  t125 = my_piecewise3(t53, -0.5e1 / 0.3e1 * t66 + t48 * t121 / 0.3e1, 0);
  t130 = (-0.2e1 / 0.3e1 * t82 * t90 - 0.2e1 * t3 * t107 + 0.2e1 * t112 * t114 + t117 * t119 * t125 / 0.12e2) * t5;
  t133 = 0.1e1 / t8;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t130 * t7 / 0.2e1 + t60 * t133 / 0.6e1;

  t137 = my_piecewise3(t24, t63, 0.66666666666666666667e-1 * t49);
  t138 = t137 * t76;
  t139 = t138 * t80;
  t140 = t62 * t139;
  t143 = t93 * t137;
  t144 = t143 * t95;
  t146 = t143 * t76;
  t150 = t30 * (t144 * t97 - t146 * t102 / 0.2e1);
  t151 = t150 * t37;
  t154 = t138 * t113;
  t157 = params->alpha * t5;
  t160 = my_piecewise3(t53, -t157 * t19 / 0.8e1, 0);
  t165 = (-0.2e1 / 0.3e1 * t140 * t90 - 0.2e1 * t3 * t151 + 0.2e1 * t112 * t154 + t117 * t119 * t160 / 0.12e2) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t165 * t7 / 0.2e1;

  t167 = t5 * t10;
  t169 = my_piecewise3(t24, t63, t167 / 0.6e1);
  t170 = t169 * t76;
  t171 = t170 * t80;
  t172 = t62 * t171;
  t175 = t93 * t169;
  t176 = t175 * t95;
  t178 = t175 * t76;
  t182 = t30 * (t176 * t97 - t178 * t102 / 0.2e1);
  t183 = t182 * t37;
  t186 = t170 * t113;
  t190 = (-0.2e1 / 0.3e1 * t172 * t90 - 0.2e1 * t3 * t183 + 0.2e1 * t112 * t186) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t190 * t7 / 0.2e1;

  t193 = my_piecewise3(t24, t63, -0.53333333333333333333e0 * t167);
  t194 = t193 * t76;
  t195 = t194 * t80;
  t196 = t62 * t195;
  t199 = t93 * t193;
  t200 = t199 * t95;
  t202 = t199 * t76;
  t206 = t30 * (t200 * t97 - t202 * t102 / 0.2e1);
  t207 = t206 * t37;
  t210 = t194 * t113;
  t213 = my_piecewise3(t53, t167, 0);
  t218 = (-0.2e1 / 0.3e1 * t196 * t90 - 0.2e1 * t3 * t207 + 0.2e1 * t112 * t210 + t117 * t119 * t213 / 0.12e2) * t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t218 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t222 = t13 * t70;
  t224 = t17 * t17;
  t226 = 0.1e1 / t8 / t224;
  t230 = my_piecewise3(t24, t63, 0.20e2 / 0.27e2 * t6 * t70 - 0.23703703703703703704e1 * t222 + 0.65185185185185185186e0 * t16 * t226);
  t231 = t230 * t76;
  t236 = t74 * t74;
  t238 = 0.1e1 / t75 / t27;
  t239 = t236 * t238;
  t245 = params->c * t93 * M_PI;
  t246 = t75 * t75;
  t247 = 0.1e1 / t246;
  t248 = t236 * t247;
  t249 = t79 * t79;
  t250 = 0.1e1 / t249;
  t252 = t245 * t248 * t250;
  t253 = t85 * t85;
  t254 = 0.1e1 / t253;
  t255 = t88 * t88;
  t256 = t254 * t255;
  t257 = t256 * t38;
  t260 = t254 * t88;
  t261 = t260 * t30;
  t262 = t35 * t37;
  t263 = t28 * t93;
  t265 = t95 * t89;
  t269 = 0.2e1 * t263 * t74 * t265 - 0.2e1 * t99 * t113;
  t271 = t261 * t262 * t269;
  t274 = t88 * t87;
  t275 = t254 * t274;
  t276 = t275 * t38;
  t279 = t89 * t107;
  t282 = t256 * t111;
  t285 = t93 * t230;
  t288 = t93 * t236;
  t289 = t238 * t80;
  t293 = t2 * M_PI;
  t294 = t293 * t236;
  t295 = t247 * t250;
  t296 = t294 * t295;
  t297 = t256 * t34;
  t301 = t260 * t34 * t269;
  t303 = t275 * t34;
  t306 = t294 * t247;
  t307 = t250 * t254;
  t309 = t307 * t255 * t31;
  t318 = t260 * t31 * t269;
  t322 = t307 * t274 * t31;
  t330 = t62 * t106 * t110;
  t336 = t245 * t36 / t83 / t28;
  t337 = t307 * t255;
  t347 = t260 * t269;
  t351 = t245 * t111;
  t352 = t307 * t274;
  t358 = t46 / t55 / t54;
  t359 = t125 * t125;
  t368 = my_piecewise3(t53, 0.40e2 / 0.9e1 * t222 - 0.11e2 / 0.9e1 * t48 * t5 * t226, 0);
  t372 = -0.2e1 / 0.3e1 * t62 * t231 * t80 * t90 + 0.4e1 / 0.3e1 * t62 * t239 * t80 * t90 - 0.2e1 / 0.3e1 * t252 * t257 + 0.2e1 / 0.3e1 * t82 * t271 - 0.4e1 / 0.3e1 * t252 * t276 - 0.4e1 / 0.3e1 * t82 * t279 + 0.8e1 / 0.3e1 * t252 * t282 - 0.2e1 * t3 * t30 * (t285 * t95 * t97 - 0.2e1 * t288 * t289 * t97 - t296 * t297 / 0.3e1 - t96 * t301 + 0.2e1 * t296 * t303 + 0.2e1 / 0.3e1 * t306 * t309 - t285 * t76 * t102 / 0.2e1 + t288 * t238 * t102 + t96 * t318 / 0.2e1 - t306 * t322) * t37 + 0.4e1 * t330 * t114 - 0.4e1 * t336 * t248 * t337 + 0.2e1 * t112 * t231 * t113 - 0.4e1 * t112 * t239 * t113 - 0.2e1 * t112 * t81 * t347 + 0.4e1 * t351 * t248 * t352 - t117 * t358 * t359 / 0.24e2 + t117 * t119 * t368 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t372 * t5 * t7 / 0.2e1 + t130 * t133 / 0.3e1 - t60 * t10 / 0.9e1;

  t381 = my_piecewise3(t24, t63, -0.17777777777777777778e0 * t121);
  t382 = t381 * t76;
  t388 = t137 * t238 * t80;
  t390 = t89 * t30;
  t391 = t262 * t74;
  t392 = t390 * t391;
  t396 = t137 * t247 * t250;
  t397 = t245 * t396;
  t398 = t256 * t30;
  t399 = t398 * t391;
  t404 = t275 * t30;
  t405 = t404 * t391;
  t410 = t35 * t110;
  t412 = t398 * t410 * t74;
  t415 = t89 * t151;
  t418 = t93 * t381;
  t421 = t143 * t289;
  t422 = t34 * t74;
  t423 = t89 * t422;
  t427 = t293 * t137 * t295;
  t428 = t256 * t422;
  t432 = t275 * t422;
  t435 = t31 * t74;
  t436 = t256 * t435;
  t442 = t89 * t435;
  t446 = t275 * t435;
  t454 = t62 * t150 * t110;
  t459 = t256 * t74;
  t466 = t89 * t74;
  t473 = t275 * t74;
  t483 = my_piecewise3(t53, t157 * t70 / 0.3e1, 0);
  t487 = -0.2e1 / 0.3e1 * t62 * t382 * t80 * t90 + 0.4e1 / 0.3e1 * t62 * t388 * t392 - 0.2e1 / 0.3e1 * t397 * t399 + 0.2e1 / 0.3e1 * t140 * t271 - 0.4e1 / 0.3e1 * t397 * t405 - 0.2e1 / 0.3e1 * t140 * t279 + 0.8e1 / 0.3e1 * t397 * t412 - 0.2e1 / 0.3e1 * t82 * t415 - 0.2e1 * t3 * t30 * (t418 * t95 * t97 - 0.2e1 * t421 * t423 - t427 * t428 / 0.3e1 - t144 * t301 + 0.2e1 * t427 * t432 + 0.2e1 / 0.3e1 * t427 * t436 - t418 * t76 * t102 / 0.2e1 + t421 * t442 + t144 * t318 / 0.2e1 - t427 * t446) * t37 + 0.2e1 * t454 * t114 + 0.2e1 * t330 * t154 - 0.4e1 * t336 * t396 * t459 + 0.2e1 * t112 * t382 * t113 - 0.4e1 * t112 * t388 * t466 - 0.2e1 * t112 * t139 * t347 + 0.4e1 * t351 * t396 * t473 - t117 * t358 * t160 * t125 / 0.24e2 + t117 * t119 * t483 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t487 * t5 * t7 / 0.2e1 + t165 * t133 / 0.6e1;

  t494 = my_piecewise3(t24, t63, -0.5e1 / 0.18e2 * t49);
  t495 = t494 * t76;
  t501 = t169 * t238 * t80;
  t502 = t62 * t501;
  t506 = t169 * t247 * t250;
  t507 = t245 * t506;
  t518 = t89 * t183;
  t521 = t93 * t494;
  t524 = t175 * t289;
  t528 = t293 * t169 * t295;
  t549 = t62 * t182 * t110;
  t569 = -0.2e1 / 0.3e1 * t62 * t495 * t80 * t90 + 0.4e1 / 0.3e1 * t502 * t392 - 0.2e1 / 0.3e1 * t507 * t399 + 0.2e1 / 0.3e1 * t172 * t271 - 0.4e1 / 0.3e1 * t507 * t405 - 0.2e1 / 0.3e1 * t172 * t279 + 0.8e1 / 0.3e1 * t507 * t412 - 0.2e1 / 0.3e1 * t82 * t518 - 0.2e1 * t3 * t30 * (t521 * t95 * t97 - 0.2e1 * t524 * t423 - t528 * t428 / 0.3e1 - t176 * t301 + 0.2e1 * t528 * t432 + 0.2e1 / 0.3e1 * t528 * t436 - t521 * t76 * t102 / 0.2e1 + t524 * t442 + t176 * t318 / 0.2e1 - t528 * t446) * t37 + 0.2e1 * t549 * t114 + 0.2e1 * t330 * t186 - 0.4e1 * t336 * t506 * t459 + 0.2e1 * t112 * t495 * t113 - 0.4e1 * t112 * t501 * t466 - 0.2e1 * t112 * t171 * t347 + 0.4e1 * t351 * t506 * t473;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = t569 * t5 * t7 / 0.2e1 + t190 * t133 / 0.6e1;

  t576 = my_piecewise3(t24, t63, 0.88888888888888888889e0 * t49);
  t577 = t576 * t76;
  t583 = t193 * t238 * t80;
  t584 = t62 * t583;
  t588 = t193 * t247 * t250;
  t589 = t245 * t588;
  t600 = t89 * t207;
  t603 = t93 * t576;
  t606 = t199 * t289;
  t610 = t293 * t193 * t295;
  t631 = t62 * t206 * t110;
  t656 = my_piecewise3(t53, -0.5e1 / 0.3e1 * t49, 0);
  t660 = -0.2e1 / 0.3e1 * t62 * t577 * t80 * t90 + 0.4e1 / 0.3e1 * t584 * t392 - 0.2e1 / 0.3e1 * t589 * t399 + 0.2e1 / 0.3e1 * t196 * t271 - 0.4e1 / 0.3e1 * t589 * t405 - 0.2e1 / 0.3e1 * t196 * t279 + 0.8e1 / 0.3e1 * t589 * t412 - 0.2e1 / 0.3e1 * t82 * t600 - 0.2e1 * t3 * t30 * (t603 * t95 * t97 - 0.2e1 * t606 * t423 - t610 * t428 / 0.3e1 - t200 * t301 + 0.2e1 * t610 * t432 + 0.2e1 / 0.3e1 * t610 * t436 - t603 * t76 * t102 / 0.2e1 + t606 * t442 + t200 * t318 / 0.2e1 - t610 * t446) * t37 + 0.2e1 * t631 * t114 + 0.2e1 * t330 * t210 - 0.4e1 * t336 * t588 * t459 + 0.2e1 * t112 * t577 * t113 - 0.4e1 * t112 * t583 * t466 - 0.2e1 * t112 * t195 * t347 + 0.4e1 * t351 * t588 * t473 - t117 * t358 * t213 * t125 / 0.24e2 + t117 * t119 * t656 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t660 * t5 * t7 / 0.2e1 + t218 * t133 / 0.6e1;

  t666 = my_piecewise3(t24, t63, 0);
  t667 = t666 * t76;
  t671 = 0.2e1 / 0.3e1 * t62 * t667 * t80 * t90;
  t672 = t137 * t137;
  t673 = t672 * t238;
  t678 = t672 * t247;
  t680 = t245 * t678 * t250;
  t687 = 0.2e1 * t263 * t137 * t265 - 0.2e1 * t146 * t113;
  t689 = t261 * t262 * t687;
  t698 = t93 * t666;
  t700 = t698 * t95 * t97;
  t701 = t93 * t672;
  t705 = t293 * t672;
  t706 = t705 * t295;
  t710 = t260 * t34 * t687;
  t714 = t705 * t247;
  t719 = t698 * t76 * t102 / 0.2e1;
  t723 = t260 * t31 * t687;
  t739 = 0.2e1 * t112 * t667 * t113;
  t743 = t260 * t687;
  t750 = t160 * t160;
  t754 = my_piecewise3(t53, 0, 0);
  t757 = t117 * t119 * t754 / 0.12e2;
  t758 = -t671 + 0.4e1 / 0.3e1 * t62 * t673 * t80 * t90 - 0.2e1 / 0.3e1 * t680 * t257 + 0.2e1 / 0.3e1 * t140 * t689 - 0.4e1 / 0.3e1 * t680 * t276 - 0.4e1 / 0.3e1 * t140 * t415 + 0.8e1 / 0.3e1 * t680 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t701 * t289 * t97 - t706 * t297 / 0.3e1 - t144 * t710 + 0.2e1 * t706 * t303 + 0.2e1 / 0.3e1 * t714 * t309 - t719 + t701 * t238 * t102 + t144 * t723 / 0.2e1 - t714 * t322) * t37 + 0.4e1 * t454 * t154 - 0.4e1 * t336 * t678 * t337 + t739 - 0.4e1 * t112 * t673 * t113 - 0.2e1 * t112 * t139 * t743 + 0.4e1 * t351 * t678 * t352 - t117 * t358 * t750 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t758 * t5 * t7 / 0.2e1;

  t761 = t262 * t137;
  t762 = t390 * t761;
  t765 = t398 * t761;
  t770 = t404 * t761;
  t776 = t398 * t410 * t137;
  t781 = t34 * t137;
  t782 = t89 * t781;
  t785 = t256 * t781;
  t789 = t275 * t781;
  t792 = t31 * t137;
  t793 = t256 * t792;
  t796 = t89 * t792;
  t800 = t275 * t792;
  t811 = t256 * t137;
  t815 = t89 * t137;
  t822 = t275 * t137;
  t826 = -t671 + 0.4e1 / 0.3e1 * t502 * t762 - 0.2e1 / 0.3e1 * t507 * t765 + 0.2e1 / 0.3e1 * t172 * t689 - 0.4e1 / 0.3e1 * t507 * t770 - 0.2e1 / 0.3e1 * t172 * t415 + 0.8e1 / 0.3e1 * t507 * t776 - 0.2e1 / 0.3e1 * t140 * t518 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t524 * t782 - t528 * t785 / 0.3e1 - t176 * t710 + 0.2e1 * t528 * t789 + 0.2e1 / 0.3e1 * t528 * t793 - t719 + t524 * t796 + t176 * t723 / 0.2e1 - t528 * t800) * t37 + 0.2e1 * t549 * t154 + 0.2e1 * t454 * t186 - 0.4e1 * t336 * t506 * t811 + t739 - 0.4e1 * t112 * t501 * t815 - 0.2e1 * t112 * t171 * t743 + 0.4e1 * t351 * t506 * t822;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = t826 * t5 * t7 / 0.2e1;

  t881 = -t671 + 0.4e1 / 0.3e1 * t584 * t762 - 0.2e1 / 0.3e1 * t589 * t765 + 0.2e1 / 0.3e1 * t196 * t689 - 0.4e1 / 0.3e1 * t589 * t770 - 0.2e1 / 0.3e1 * t196 * t415 + 0.8e1 / 0.3e1 * t589 * t776 - 0.2e1 / 0.3e1 * t140 * t600 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t606 * t782 - t610 * t785 / 0.3e1 - t200 * t710 + 0.2e1 * t610 * t789 + 0.2e1 / 0.3e1 * t610 * t793 - t719 + t606 * t796 + t200 * t723 / 0.2e1 - t610 * t800) * t37 + 0.2e1 * t631 * t154 + 0.2e1 * t454 * t210 - 0.4e1 * t336 * t588 * t811 + t739 - 0.4e1 * t112 * t583 * t815 - 0.2e1 * t112 * t195 * t743 + 0.4e1 * t351 * t588 * t822 - t117 * t358 * t213 * t160 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = t881 * t5 * t7 / 0.2e1;

  t884 = t169 * t169;
  t885 = t884 * t238;
  t890 = t884 * t247;
  t892 = t245 * t890 * t250;
  t899 = 0.2e1 * t263 * t169 * t265 - 0.2e1 * t178 * t113;
  t901 = t261 * t262 * t899;
  t910 = t93 * t884;
  t914 = t293 * t884;
  t915 = t914 * t295;
  t919 = t260 * t34 * t899;
  t923 = t914 * t247;
  t929 = t260 * t31 * t899;
  t946 = t260 * t899;
  t953 = -t671 + 0.4e1 / 0.3e1 * t62 * t885 * t80 * t90 - 0.2e1 / 0.3e1 * t892 * t257 + 0.2e1 / 0.3e1 * t172 * t901 - 0.4e1 / 0.3e1 * t892 * t276 - 0.4e1 / 0.3e1 * t172 * t518 + 0.8e1 / 0.3e1 * t892 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t910 * t289 * t97 - t915 * t297 / 0.3e1 - t176 * t919 + 0.2e1 * t915 * t303 + 0.2e1 / 0.3e1 * t923 * t309 - t719 + t910 * t238 * t102 + t176 * t929 / 0.2e1 - t923 * t322) * t37 + 0.4e1 * t549 * t186 - 0.4e1 * t336 * t890 * t337 + t739 - 0.4e1 * t112 * t885 * t113 - 0.2e1 * t112 * t171 * t946 + 0.4e1 * t351 * t890 * t352;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = t953 * t5 * t7 / 0.2e1;

  t956 = t262 * t169;
  t976 = t34 * t169;
  t987 = t31 * t169;
  t1021 = -t671 + 0.4e1 / 0.3e1 * t584 * t390 * t956 - 0.2e1 / 0.3e1 * t589 * t398 * t956 + 0.2e1 / 0.3e1 * t196 * t901 - 0.4e1 / 0.3e1 * t589 * t404 * t956 - 0.2e1 / 0.3e1 * t196 * t518 + 0.8e1 / 0.3e1 * t589 * t398 * t410 * t169 - 0.2e1 / 0.3e1 * t172 * t600 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t606 * t89 * t976 - t610 * t256 * t976 / 0.3e1 - t200 * t919 + 0.2e1 * t610 * t275 * t976 + 0.2e1 / 0.3e1 * t610 * t256 * t987 - t719 + t606 * t89 * t987 + t200 * t929 / 0.2e1 - t610 * t275 * t987) * t37 + 0.2e1 * t631 * t186 + 0.2e1 * t549 * t210 - 0.4e1 * t336 * t588 * t256 * t169 + t739 - 0.4e1 * t112 * t583 * t89 * t169 - 0.2e1 * t112 * t195 * t946 + 0.4e1 * t351 * t588 * t275 * t169;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = t1021 * t5 * t7 / 0.2e1;

  t1024 = t193 * t193;
  t1025 = t1024 * t238;
  t1030 = t1024 * t247;
  t1032 = t245 * t1030 * t250;
  t1039 = 0.2e1 * t263 * t193 * t265 - 0.2e1 * t202 * t113;
  t1050 = t93 * t1024;
  t1054 = t293 * t1024;
  t1055 = t1054 * t295;
  t1063 = t1054 * t247;
  t1093 = t213 * t213;
  t1097 = -t671 + 0.4e1 / 0.3e1 * t62 * t1025 * t80 * t90 - 0.2e1 / 0.3e1 * t1032 * t257 + 0.2e1 / 0.3e1 * t196 * t261 * t262 * t1039 - 0.4e1 / 0.3e1 * t1032 * t276 - 0.4e1 / 0.3e1 * t196 * t600 + 0.8e1 / 0.3e1 * t1032 * t282 - 0.2e1 * t3 * t30 * (t700 - 0.2e1 * t1050 * t289 * t97 - t1055 * t297 / 0.3e1 - t200 * t260 * t34 * t1039 + 0.2e1 * t1055 * t303 + 0.2e1 / 0.3e1 * t1063 * t309 - t719 + t1050 * t238 * t102 + t200 * t260 * t31 * t1039 / 0.2e1 - t1063 * t322) * t37 + 0.4e1 * t631 * t210 - 0.4e1 * t336 * t1030 * t337 + t739 - 0.4e1 * t112 * t1025 * t113 - 0.2e1 * t112 * t195 * t260 * t1039 + 0.4e1 * t351 * t1030 * t352 - t117 * t358 * t1093 / 0.24e2 + t757;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t1097 * t5 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}


static inline void
func_ferr(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t7, t10, t12, t14;
  double t17, t18, t19, t20, t21, t22, t23, t25;
  double t26, t29, t30, t31, t32, t33, t38, t39;
  double t40, t41, t43, t46, t47, t48, t49, t53;
  double t54, t55, t58, t62, t66, t67, t68, t69;
  double t71, t72, t73, t74, t75, t77, t78, t79;
  double t80, t81, t82, t85, t86, t87, t88, t89;
  double t91, t92, t94, t98, t99, t102, t103, t104;
  double t105, t106, t109, t111, t116, t120, t122, t126;
  double t127, t128, t129, t132, t133, t135, t139, t140;
  double t143, t148, t152, t154, t155, t156, t157, t160;
  double t161, t163, t167, t168, t171, t174, t176, t177;
  double t178, t179, t182, t183, t185, t189, t190, t193;
  double t196, t200, t203, t205, t207, t211, t212, t217;
  double t219, t220, t226, t227, t228, t229, t230, t231;
  double t233, t234, t235, t236, t237, t238, t241, t242;
  double t243, t244, t246, t250, t252, t255, t256, t257;
  double t260, t263, t266, t269, t270, t274, t275, t276;
  double t277, t278, t282, t284, t287, t288, t290, t299;
  double t303, t311, t317, t318, t328, t332, t333, t339;
  double t340, t348, t352, t359, t360, t366, t368, t369;
  double t370, t374, t375, t376, t377, t382, t383, t388;
  double t390, t393, t396, t399, t400, t401, t405, t406;
  double t410, t413, t414, t420, t424, t432, t437, t444;
  double t451, t461, t465, t470, t471, t477, t478, t482;
  double t483, t494, t497, t500, t504, t525, t545, t550;
  double t551, t557, t558, t562, t563, t574, t577, t580;
  double t584, t605, t630, t634, t638, t639, t643, t644;
  double t645, t650, t652, t659, t661, t670, t672, t673;
  double t677, t678, t682, t686, t691, t695, t711, t715;
  double t722, t726, t729, t730, t731, t732, t735, t740;
  double t746, t751, t752, t755, t759, t762, t763, t766;
  double t770, t781, t785, t792, t796, t849, t850, t851;
  double t856, t858, t865, t867, t876, t880, t881, t885;
  double t889, t895, t912, t919, t920, t940, t951, t985;
  double t986, t987, t992, t994, t1001, t1012, t1016, t1017;
  double t1025, t1055, t1059;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * t4;
  t7 = 0.1e1 / t5 / rho[0];
  t10 = tau[0] * t7;
  t12 = rho[0] * rho[0];
  t14 = 0.1e1 / t5 / t12;
  t17 = lapl[0] * t7 / 0.6e1 - 0.53333333333333333333e0 * t10 + 0.66666666666666666667e-1 * sigma[0] * t14;
  t18 = fabs(t17);
  t19 = t18 < 0.50e-12;
  t20 = 0.0e0 < t17;
  t21 = my_piecewise3(t20, 0.50e-12, -0.50e-12);
  t22 = my_piecewise3(t19, t21, t17);
  t23 = xc_mgga_x_br89_get_x(t22);
  t25 = exp(t23 / 0.3e1);
  t26 = exp(-t23);
  t29 = t26 * (0.1e1 + t23 / 0.2e1);
  t30 = 0.1e1 - t29;
  t31 = t25 * t30;
  t32 = 0.1e1 / t23;
  t33 = t31 * t32;
  t38 = sqrt(0.15e2);
  t39 = (0.3e1 * params->c - 0.2e1) * t38;
  t40 = 0.1e1 / M_PI;
  t41 = M_SQRT2;
  t43 = params->alpha * sigma[0];
  t46 = t10 - t43 * t14 / 0.8e1;
  t47 = 0.1e-9 < t46;
  t48 = my_piecewise3(t47, t46, 0.1e-9);
  t49 = sqrt(t48);
  t53 = -0.2e1 * t3 * t33 + t39 * t40 * t41 * t49 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t53 * t4;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t54 = params->c * M_PI;
  t55 = my_piecewise3(t20, 0, 0);
  t58 = tau[0] * t14;
  t62 = 0.1e1 / t5 / t12 / rho[0];
  t66 = my_piecewise3(t19, t55, -0.5e1 / 0.18e2 * lapl[0] * t14 + 0.88888888888888888889e0 * t58 - 0.17777777777777777778e0 * sigma[0] * t62);
  t67 = t22 * t22;
  t68 = 0.1e1 / t67;
  t69 = t66 * t68;
  t71 = exp(-0.2e1 / 0.3e1 * t23);
  t72 = 0.1e1 / t71;
  t73 = t69 * t72;
  t74 = t54 * t73;
  t75 = t23 * t23;
  t77 = t75 - 0.2e1 * t23 + 0.3e1;
  t78 = 0.1e1 / t77;
  t79 = t23 - 0.2e1;
  t80 = t79 * t79;
  t81 = t78 * t80;
  t82 = t81 * t33;
  t85 = t2 * t2;
  t86 = t85 * t66;
  t87 = t68 * t72;
  t88 = t86 * t87;
  t89 = t81 * t29;
  t91 = t86 * t68;
  t92 = t72 * t78;
  t94 = t92 * t80 * t26;
  t98 = t25 * (t88 * t89 - t91 * t94 / 0.2e1);
  t99 = t98 * t32;
  t102 = 0.1e1 / t75;
  t103 = t31 * t102;
  t104 = t54 * t103;
  t105 = t92 * t80;
  t106 = t69 * t105;
  t109 = t39 * t40;
  t111 = t41 / t49;
  t116 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t58 + t43 * t62 / 0.3e1, 0);
  t120 = -0.2e1 / 0.3e1 * t74 * t82 - 0.2e1 * t3 * t99 + 0.2e1 * t104 * t106 + t109 * t111 * t116 / 0.12e2;
  t122 = 0.1e1 / t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t120 * t4 + t53 * t122 / 0.3e1;

  t126 = my_piecewise3(t19, t55, 0.66666666666666666667e-1 * t14);
  t127 = t126 * t68;
  t128 = t127 * t72;
  t129 = t54 * t128;
  t132 = t85 * t126;
  t133 = t132 * t87;
  t135 = t132 * t68;
  t139 = t25 * (t133 * t89 - t135 * t94 / 0.2e1);
  t140 = t139 * t32;
  t143 = t127 * t105;
  t148 = my_piecewise3(t47, -params->alpha * t14 / 0.8e1, 0);
  t152 = -0.2e1 / 0.3e1 * t129 * t82 - 0.2e1 * t3 * t140 + 0.2e1 * t104 * t143 + t109 * t111 * t148 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t152 * t4;

  t154 = my_piecewise3(t19, t55, t7 / 0.6e1);
  t155 = t154 * t68;
  t156 = t155 * t72;
  t157 = t54 * t156;
  t160 = t85 * t154;
  t161 = t160 * t87;
  t163 = t160 * t68;
  t167 = t25 * (t161 * t89 - t163 * t94 / 0.2e1);
  t168 = t167 * t32;
  t171 = t155 * t105;
  t174 = -0.2e1 / 0.3e1 * t157 * t82 - 0.2e1 * t3 * t168 + 0.2e1 * t104 * t171;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t174 * t4;

  t176 = my_piecewise3(t19, t55, -0.53333333333333333333e0 * t7);
  t177 = t176 * t68;
  t178 = t177 * t72;
  t179 = t54 * t178;
  t182 = t85 * t176;
  t183 = t182 * t87;
  t185 = t182 * t68;
  t189 = t25 * (t183 * t89 - t185 * t94 / 0.2e1);
  t190 = t189 * t32;
  t193 = t177 * t105;
  t196 = my_piecewise3(t47, t7, 0);
  t200 = -0.2e1 / 0.3e1 * t179 * t82 - 0.2e1 * t3 * t190 + 0.2e1 * t104 * t193 + t109 * t111 * t196 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t200 * t4;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t203 = tau[0] * t62;
  t205 = t12 * t12;
  t207 = 0.1e1 / t5 / t205;
  t211 = my_piecewise3(t19, t55, 0.20e2 / 0.27e2 * lapl[0] * t62 - 0.23703703703703703704e1 * t203 + 0.65185185185185185186e0 * sigma[0] * t207);
  t212 = t211 * t68;
  t217 = t66 * t66;
  t219 = 0.1e1 / t67 / t22;
  t220 = t217 * t219;
  t226 = params->c * t85 * M_PI;
  t227 = t67 * t67;
  t228 = 0.1e1 / t227;
  t229 = t217 * t228;
  t230 = t71 * t71;
  t231 = 0.1e1 / t230;
  t233 = t226 * t229 * t231;
  t234 = t77 * t77;
  t235 = 0.1e1 / t234;
  t236 = t80 * t80;
  t237 = t235 * t236;
  t238 = t237 * t33;
  t241 = t235 * t80;
  t242 = t241 * t25;
  t243 = t30 * t32;
  t244 = t23 * t85;
  t246 = t87 * t81;
  t250 = 0.2e1 * t244 * t66 * t246 - 0.2e1 * t91 * t105;
  t252 = t242 * t243 * t250;
  t255 = t80 * t79;
  t256 = t235 * t255;
  t257 = t256 * t33;
  t260 = t81 * t99;
  t263 = t237 * t103;
  t266 = t85 * t211;
  t269 = t85 * t217;
  t270 = t219 * t72;
  t274 = t2 * M_PI;
  t275 = t274 * t217;
  t276 = t228 * t231;
  t277 = t275 * t276;
  t278 = t237 * t29;
  t282 = t241 * t29 * t250;
  t284 = t256 * t29;
  t287 = t275 * t228;
  t288 = t231 * t235;
  t290 = t288 * t236 * t26;
  t299 = t241 * t26 * t250;
  t303 = t288 * t255 * t26;
  t311 = t54 * t98 * t102;
  t317 = t226 * t31 / t75 / t23;
  t318 = t288 * t236;
  t328 = t241 * t250;
  t332 = t226 * t103;
  t333 = t288 * t255;
  t339 = t41 / t49 / t48;
  t340 = t116 * t116;
  t348 = my_piecewise3(t47, 0.40e2 / 0.9e1 * t203 - 0.11e2 / 0.9e1 * t43 * t207, 0);
  t352 = -0.2e1 / 0.3e1 * t54 * t212 * t72 * t82 + 0.4e1 / 0.3e1 * t54 * t220 * t72 * t82 - 0.2e1 / 0.3e1 * t233 * t238 + 0.2e1 / 0.3e1 * t74 * t252 - 0.4e1 / 0.3e1 * t233 * t257 - 0.4e1 / 0.3e1 * t74 * t260 + 0.8e1 / 0.3e1 * t233 * t263 - 0.2e1 * t3 * t25 * (t266 * t87 * t89 - 0.2e1 * t269 * t270 * t89 - t277 * t278 / 0.3e1 - t88 * t282 + 0.2e1 * t277 * t284 + 0.2e1 / 0.3e1 * t287 * t290 - t266 * t68 * t94 / 0.2e1 + t269 * t219 * t94 + t88 * t299 / 0.2e1 - t287 * t303) * t32 + 0.4e1 * t311 * t106 - 0.4e1 * t317 * t229 * t318 + 0.2e1 * t104 * t212 * t105 - 0.4e1 * t104 * t220 * t105 - 0.2e1 * t104 * t73 * t328 + 0.4e1 * t332 * t229 * t333 - t109 * t339 * t340 / 0.24e2 + t109 * t111 * t348 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t352 * t4 + 0.2e1 / 0.3e1 * t120 * t122 - 0.2e1 / 0.9e1 * t53 * t7;

  t359 = my_piecewise3(t19, t55, -0.17777777777777777778e0 * t62);
  t360 = t359 * t68;
  t366 = t126 * t219 * t72;
  t368 = t81 * t25;
  t369 = t243 * t66;
  t370 = t368 * t369;
  t374 = t126 * t228 * t231;
  t375 = t226 * t374;
  t376 = t237 * t25;
  t377 = t376 * t369;
  t382 = t256 * t25;
  t383 = t382 * t369;
  t388 = t30 * t102;
  t390 = t376 * t388 * t66;
  t393 = t81 * t140;
  t396 = t85 * t359;
  t399 = t132 * t270;
  t400 = t29 * t66;
  t401 = t81 * t400;
  t405 = t274 * t126 * t276;
  t406 = t237 * t400;
  t410 = t256 * t400;
  t413 = t26 * t66;
  t414 = t237 * t413;
  t420 = t81 * t413;
  t424 = t256 * t413;
  t432 = t54 * t139 * t102;
  t437 = t237 * t66;
  t444 = t81 * t66;
  t451 = t256 * t66;
  t461 = my_piecewise3(t47, params->alpha * t62 / 0.3e1, 0);
  t465 = -0.2e1 / 0.3e1 * t54 * t360 * t72 * t82 + 0.4e1 / 0.3e1 * t54 * t366 * t370 - 0.2e1 / 0.3e1 * t375 * t377 + 0.2e1 / 0.3e1 * t129 * t252 - 0.4e1 / 0.3e1 * t375 * t383 - 0.2e1 / 0.3e1 * t129 * t260 + 0.8e1 / 0.3e1 * t375 * t390 - 0.2e1 / 0.3e1 * t74 * t393 - 0.2e1 * t3 * t25 * (t396 * t87 * t89 - 0.2e1 * t399 * t401 - t405 * t406 / 0.3e1 - t133 * t282 + 0.2e1 * t405 * t410 + 0.2e1 / 0.3e1 * t405 * t414 - t396 * t68 * t94 / 0.2e1 + t399 * t420 + t133 * t299 / 0.2e1 - t405 * t424) * t32 + 0.2e1 * t432 * t106 + 0.2e1 * t311 * t143 - 0.4e1 * t317 * t374 * t437 + 0.2e1 * t104 * t360 * t105 - 0.4e1 * t104 * t366 * t444 - 0.2e1 * t104 * t128 * t328 + 0.4e1 * t332 * t374 * t451 - t109 * t339 * t148 * t116 / 0.24e2 + t109 * t111 * t461 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t465 * t4 + t152 * t122 / 0.3e1;

  t470 = my_piecewise3(t19, t55, -0.5e1 / 0.18e2 * t14);
  t471 = t470 * t68;
  t477 = t154 * t219 * t72;
  t478 = t54 * t477;
  t482 = t154 * t228 * t231;
  t483 = t226 * t482;
  t494 = t81 * t168;
  t497 = t85 * t470;
  t500 = t160 * t270;
  t504 = t274 * t154 * t276;
  t525 = t54 * t167 * t102;
  t545 = -0.2e1 / 0.3e1 * t54 * t471 * t72 * t82 + 0.4e1 / 0.3e1 * t478 * t370 - 0.2e1 / 0.3e1 * t483 * t377 + 0.2e1 / 0.3e1 * t157 * t252 - 0.4e1 / 0.3e1 * t483 * t383 - 0.2e1 / 0.3e1 * t157 * t260 + 0.8e1 / 0.3e1 * t483 * t390 - 0.2e1 / 0.3e1 * t74 * t494 - 0.2e1 * t3 * t25 * (t497 * t87 * t89 - 0.2e1 * t500 * t401 - t504 * t406 / 0.3e1 - t161 * t282 + 0.2e1 * t504 * t410 + 0.2e1 / 0.3e1 * t504 * t414 - t497 * t68 * t94 / 0.2e1 + t500 * t420 + t161 * t299 / 0.2e1 - t504 * t424) * t32 + 0.2e1 * t525 * t106 + 0.2e1 * t311 * t171 - 0.4e1 * t317 * t482 * t437 + 0.2e1 * t104 * t471 * t105 - 0.4e1 * t104 * t477 * t444 - 0.2e1 * t104 * t156 * t328 + 0.4e1 * t332 * t482 * t451;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = t545 * t4 + t174 * t122 / 0.3e1;

  t550 = my_piecewise3(t19, t55, 0.88888888888888888889e0 * t14);
  t551 = t550 * t68;
  t557 = t176 * t219 * t72;
  t558 = t54 * t557;
  t562 = t176 * t228 * t231;
  t563 = t226 * t562;
  t574 = t81 * t190;
  t577 = t85 * t550;
  t580 = t182 * t270;
  t584 = t274 * t176 * t276;
  t605 = t54 * t189 * t102;
  t630 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t14, 0);
  t634 = -0.2e1 / 0.3e1 * t54 * t551 * t72 * t82 + 0.4e1 / 0.3e1 * t558 * t370 - 0.2e1 / 0.3e1 * t563 * t377 + 0.2e1 / 0.3e1 * t179 * t252 - 0.4e1 / 0.3e1 * t563 * t383 - 0.2e1 / 0.3e1 * t179 * t260 + 0.8e1 / 0.3e1 * t563 * t390 - 0.2e1 / 0.3e1 * t74 * t574 - 0.2e1 * t3 * t25 * (t577 * t87 * t89 - 0.2e1 * t580 * t401 - t584 * t406 / 0.3e1 - t183 * t282 + 0.2e1 * t584 * t410 + 0.2e1 / 0.3e1 * t584 * t414 - t577 * t68 * t94 / 0.2e1 + t580 * t420 + t183 * t299 / 0.2e1 - t584 * t424) * t32 + 0.2e1 * t605 * t106 + 0.2e1 * t311 * t193 - 0.4e1 * t317 * t562 * t437 + 0.2e1 * t104 * t551 * t105 - 0.4e1 * t104 * t557 * t444 - 0.2e1 * t104 * t178 * t328 + 0.4e1 * t332 * t562 * t451 - t109 * t339 * t196 * t116 / 0.24e2 + t109 * t111 * t630 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t634 * t4 + t200 * t122 / 0.3e1;

  t638 = my_piecewise3(t19, t55, 0);
  t639 = t638 * t68;
  t643 = 0.2e1 / 0.3e1 * t54 * t639 * t72 * t82;
  t644 = t126 * t126;
  t645 = t644 * t219;
  t650 = t644 * t228;
  t652 = t226 * t650 * t231;
  t659 = 0.2e1 * t244 * t126 * t246 - 0.2e1 * t135 * t105;
  t661 = t242 * t243 * t659;
  t670 = t85 * t638;
  t672 = t670 * t87 * t89;
  t673 = t85 * t644;
  t677 = t274 * t644;
  t678 = t677 * t276;
  t682 = t241 * t29 * t659;
  t686 = t677 * t228;
  t691 = t670 * t68 * t94 / 0.2e1;
  t695 = t241 * t26 * t659;
  t711 = 0.2e1 * t104 * t639 * t105;
  t715 = t241 * t659;
  t722 = t148 * t148;
  t726 = my_piecewise3(t47, 0, 0);
  t729 = t109 * t111 * t726 / 0.12e2;
  t730 = -t643 + 0.4e1 / 0.3e1 * t54 * t645 * t72 * t82 - 0.2e1 / 0.3e1 * t652 * t238 + 0.2e1 / 0.3e1 * t129 * t661 - 0.4e1 / 0.3e1 * t652 * t257 - 0.4e1 / 0.3e1 * t129 * t393 + 0.8e1 / 0.3e1 * t652 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t673 * t270 * t89 - t678 * t278 / 0.3e1 - t133 * t682 + 0.2e1 * t678 * t284 + 0.2e1 / 0.3e1 * t686 * t290 - t691 + t673 * t219 * t94 + t133 * t695 / 0.2e1 - t686 * t303) * t32 + 0.4e1 * t432 * t143 - 0.4e1 * t317 * t650 * t318 + t711 - 0.4e1 * t104 * t645 * t105 - 0.2e1 * t104 * t128 * t715 + 0.4e1 * t332 * t650 * t333 - t109 * t339 * t722 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t730 * t4;

  t731 = t243 * t126;
  t732 = t368 * t731;
  t735 = t376 * t731;
  t740 = t382 * t731;
  t746 = t376 * t388 * t126;
  t751 = t29 * t126;
  t752 = t81 * t751;
  t755 = t237 * t751;
  t759 = t256 * t751;
  t762 = t26 * t126;
  t763 = t237 * t762;
  t766 = t81 * t762;
  t770 = t256 * t762;
  t781 = t237 * t126;
  t785 = t81 * t126;
  t792 = t256 * t126;
  t796 = -t643 + 0.4e1 / 0.3e1 * t478 * t732 - 0.2e1 / 0.3e1 * t483 * t735 + 0.2e1 / 0.3e1 * t157 * t661 - 0.4e1 / 0.3e1 * t483 * t740 - 0.2e1 / 0.3e1 * t157 * t393 + 0.8e1 / 0.3e1 * t483 * t746 - 0.2e1 / 0.3e1 * t129 * t494 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t500 * t752 - t504 * t755 / 0.3e1 - t161 * t682 + 0.2e1 * t504 * t759 + 0.2e1 / 0.3e1 * t504 * t763 - t691 + t500 * t766 + t161 * t695 / 0.2e1 - t504 * t770) * t32 + 0.2e1 * t525 * t143 + 0.2e1 * t432 * t171 - 0.4e1 * t317 * t482 * t781 + t711 - 0.4e1 * t104 * t477 * t785 - 0.2e1 * t104 * t156 * t715 + 0.4e1 * t332 * t482 * t792;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = t796 * t4;

  t849 = -t643 + 0.4e1 / 0.3e1 * t558 * t732 - 0.2e1 / 0.3e1 * t563 * t735 + 0.2e1 / 0.3e1 * t179 * t661 - 0.4e1 / 0.3e1 * t563 * t740 - 0.2e1 / 0.3e1 * t179 * t393 + 0.8e1 / 0.3e1 * t563 * t746 - 0.2e1 / 0.3e1 * t129 * t574 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t580 * t752 - t584 * t755 / 0.3e1 - t183 * t682 + 0.2e1 * t584 * t759 + 0.2e1 / 0.3e1 * t584 * t763 - t691 + t580 * t766 + t183 * t695 / 0.2e1 - t584 * t770) * t32 + 0.2e1 * t605 * t143 + 0.2e1 * t432 * t193 - 0.4e1 * t317 * t562 * t781 + t711 - 0.4e1 * t104 * t557 * t785 - 0.2e1 * t104 * t178 * t715 + 0.4e1 * t332 * t562 * t792 - t109 * t339 * t196 * t148 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = t849 * t4;

  t850 = t154 * t154;
  t851 = t850 * t219;
  t856 = t850 * t228;
  t858 = t226 * t856 * t231;
  t865 = 0.2e1 * t244 * t154 * t246 - 0.2e1 * t163 * t105;
  t867 = t242 * t243 * t865;
  t876 = t85 * t850;
  t880 = t274 * t850;
  t881 = t880 * t276;
  t885 = t241 * t29 * t865;
  t889 = t880 * t228;
  t895 = t241 * t26 * t865;
  t912 = t241 * t865;
  t919 = -t643 + 0.4e1 / 0.3e1 * t54 * t851 * t72 * t82 - 0.2e1 / 0.3e1 * t858 * t238 + 0.2e1 / 0.3e1 * t157 * t867 - 0.4e1 / 0.3e1 * t858 * t257 - 0.4e1 / 0.3e1 * t157 * t494 + 0.8e1 / 0.3e1 * t858 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t876 * t270 * t89 - t881 * t278 / 0.3e1 - t161 * t885 + 0.2e1 * t881 * t284 + 0.2e1 / 0.3e1 * t889 * t290 - t691 + t876 * t219 * t94 + t161 * t895 / 0.2e1 - t889 * t303) * t32 + 0.4e1 * t525 * t171 - 0.4e1 * t317 * t856 * t318 + t711 - 0.4e1 * t104 * t851 * t105 - 0.2e1 * t104 * t156 * t912 + 0.4e1 * t332 * t856 * t333;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = t919 * t4;

  t920 = t243 * t154;
  t940 = t29 * t154;
  t951 = t26 * t154;
  t985 = -t643 + 0.4e1 / 0.3e1 * t558 * t368 * t920 - 0.2e1 / 0.3e1 * t563 * t376 * t920 + 0.2e1 / 0.3e1 * t179 * t867 - 0.4e1 / 0.3e1 * t563 * t382 * t920 - 0.2e1 / 0.3e1 * t179 * t494 + 0.8e1 / 0.3e1 * t563 * t376 * t388 * t154 - 0.2e1 / 0.3e1 * t157 * t574 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t580 * t81 * t940 - t584 * t237 * t940 / 0.3e1 - t183 * t885 + 0.2e1 * t584 * t256 * t940 + 0.2e1 / 0.3e1 * t584 * t237 * t951 - t691 + t580 * t81 * t951 + t183 * t895 / 0.2e1 - t584 * t256 * t951) * t32 + 0.2e1 * t605 * t171 + 0.2e1 * t525 * t193 - 0.4e1 * t317 * t562 * t237 * t154 + t711 - 0.4e1 * t104 * t557 * t81 * t154 - 0.2e1 * t104 * t178 * t912 + 0.4e1 * t332 * t562 * t256 * t154;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = t985 * t4;

  t986 = t176 * t176;
  t987 = t986 * t219;
  t992 = t986 * t228;
  t994 = t226 * t992 * t231;
  t1001 = 0.2e1 * t244 * t176 * t246 - 0.2e1 * t185 * t105;
  t1012 = t85 * t986;
  t1016 = t274 * t986;
  t1017 = t1016 * t276;
  t1025 = t1016 * t228;
  t1055 = t196 * t196;
  t1059 = -t643 + 0.4e1 / 0.3e1 * t54 * t987 * t72 * t82 - 0.2e1 / 0.3e1 * t994 * t238 + 0.2e1 / 0.3e1 * t179 * t242 * t243 * t1001 - 0.4e1 / 0.3e1 * t994 * t257 - 0.4e1 / 0.3e1 * t179 * t574 + 0.8e1 / 0.3e1 * t994 * t263 - 0.2e1 * t3 * t25 * (t672 - 0.2e1 * t1012 * t270 * t89 - t1017 * t278 / 0.3e1 - t183 * t241 * t29 * t1001 + 0.2e1 * t1017 * t284 + 0.2e1 / 0.3e1 * t1025 * t290 - t691 + t1012 * t219 * t94 + t183 * t241 * t26 * t1001 / 0.2e1 - t1025 * t303) * t32 + 0.4e1 * t605 * t193 - 0.4e1 * t317 * t992 * t318 + t711 - 0.4e1 * t104 * t987 * t105 - 0.2e1 * t104 * t178 * t241 * t1001 + 0.4e1 * t332 * t992 * t333 - t109 * t339 * t1055 / 0.24e2 + t729;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t1059 * t4;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau, double *vrho, double *vsigma, double *vlapl, double *vtau, double *v2rho2, double *v2rhosigma, double *v2rholapl, double *v2rhotau, double *v2sigma2, double *v2sigmalapl, double *v2sigmatau, double *v2lapl2, double *v2lapltau, double *v2tau2, double *v3rho3, double *v3rho2sigma, double *v3rho2lapl, double *v3rho2tau, double *v3rhosigma2, double *v3rhosigmalapl, double *v3rhosigmatau, double *v3rholapl2, double *v3rholapltau, double *v3rhotau2, double *v3sigma3, double *v3sigma2lapl, double *v3sigma2tau, double *v3sigmalapl2, double *v3sigmalapltau, double *v3sigmatau2, double *v3lapl3, double *v3lapl2tau, double *v3lapltau2, double *v3tau3)
{
  double t2, t3, t4, t5, t7, t10, t12, t14;
  double t17, t18, t19, t20, t21, t22, t23, t25;
  double t26, t29, t30, t31, t32, t33, t38, t39;
  double t40, t41, t42, t43, t46, t47, t48, t49;
  double t53, t54, t55, t57, t60, t62, t64, t67;
  double t68, t69, t70, t71, t72, t73, t75, t76;
  double t79, t80, t81, t82, t83, t86, t89, t90;
  double t91, t92, t96, t97, t98, t101, t105, t109;
  double t110, t111, t112, t114, t115, t116, t117, t118;
  double t120, t121, t122, t123, t124, t125, t128, t129;
  double t130, t131, t132, t134, t135, t137, t141, t142;
  double t145, t146, t147, t148, t149, t152, t154, t159;
  double t163, t165, t168, t171, t175, t179, t180, t181;
  double t182, t184, t185, t186, t187, t188, t190, t191;
  double t192, t193, t194, t195, t198, t199, t200, t201;
  double t203, t204, t206, t210, t211, t214, t215, t216;
  double t217, t218, t222, t227, t231, t233, t237, t238;
  double t239, t240, t243, t244, t246, t250, t251, t254;
  double t257, t259, t260, t261, t262, t265, t266, t268;
  double t272, t273, t276, t279, t281, t282, t283, t284;
  double t287, t288, t290, t294, t295, t298, t303, t307;
  double t309, t310, t311, t312, t315, t316, t318, t322;
  double t323, t326, t331, t335, t337, t338, t339, t340;
  double t343, t344, t346, t350, t351, t354, t357, t361;
  double t363, t364, t365, t366, t369, t370, t372, t376;
  double t377, t380, t383, t387, t389, t390, t396, t398;
  double t399, t400, t401, t402, t403, t407, t408, t409;
  double t411, t412, t413, t414, t415, t416, t417, t418;
  double t419, t420, t423, t424, t425, t427, t431, t433;
  double t436, t437, t438, t439, t442, t445, t447, t450;
  double t453, t456, t457, t458, t459, t462, t464, t465;
  double t466, t470, t472, t475, t476, t482, t485, t488;
  double t496, t500, t506, t507, t514, t518, t522, t523;
  double t527, t532, t533, t539, t541, t542, t543, t544;
  double t545, t546, t549, t550, t552, t553, t554, t555;
  double t556, t557, t558, t559, t560, t561, t564, t565;
  double t566, t568, t572, t574, t577, t578, t579, t580;
  double t583, t586, t588, t591, t594, t597, t598, t599;
  double t600, t604, t605, t606, t610, t612, t615, t616;
  double t622, t625, t628, t636, t640, t646, t647, t654;
  double t658, t662, t663, t667, t672, t673, t679, t684;
  double t685, t696, t699, t702, t706, t727, t749, t756;
  double t760, t765, t766, t772, t777, t778, t789, t792;
  double t795, t799, t820, t842, t849, t853, t858, t859;
  double t865, t866, t870, t871, t882, t885, t888, t892;
  double t913, t938, t942, t947, t948, t954, t955, t959;
  double t960, t971, t974, t977, t981, t1002, t1027, t1031;
  double t1037, t1039, t1041, t1045, t1046, t1051, t1052, t1057;
  double t1059, t1060, t1065, t1070, t1073, t1076, t1080, t1081;
  double t1082, t1086, t1089, t1090, t1092, t1103, t1112, t1125;
  double t1129, t1137, t1141, t1149, t1151, t1153, t1157, t1158;
  double t1163, t1164, t1169, t1171, t1172, t1177, t1182, t1185;
  double t1188, t1192, t1193, t1194, t1198, t1201, t1202, t1204;
  double t1215, t1224, t1237, t1241, t1249, t1253, t1259, t1260;
  double t1264, t1265, t1266, t1271, t1273, t1280, t1282, t1291;
  double t1293, t1294, t1298, t1299, t1303, t1307, t1312, t1316;
  double t1332, t1336, t1343, t1344, t1345, t1349, t1350, t1351;
  double t1356, t1358, t1365, t1367, t1376, t1378, t1379, t1383;
  double t1384, t1388, t1392, t1397, t1401, t1417, t1421, t1428;
  double t1429, t1449, t1460, t1494, t1495, t1515, t1526, t1560;
  double t1561, t1562, t1567, t1569, t1576, t1578, t1587, t1591;
  double t1592, t1596, t1600, t1606, t1623, t1630, t1634, t1637;
  double t1638, t1639, t1640, t1645, t1647, t1654, t1656, t1665;
  double t1669, t1670, t1674, t1678, t1684, t1701, t1708, t1712;
  double t1715, t1716, t1717, t1718, t1721, t1726, t1732, t1737;
  double t1738, t1741, t1745, t1748, t1749, t1752, t1756, t1767;
  double t1771, t1778, t1782, t1783, t1784, t1787, t1792, t1798;
  double t1803, t1804, t1807, t1811, t1814, t1815, t1818, t1822;
  double t1833, t1837, t1844, t1848, t1901, t1954, t1955, t1956;
  double t1961, t1963, t1970, t1981, t1985, t1986, t1994, t2024;
  double t2028, t2029, t2030, t2035, t2037, t2044, t2055, t2059;
  double t2060, t2068, t2098, t2102;

  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * t4;
  t7 = 0.1e1 / t5 / rho[0];
  t10 = tau[0] * t7;
  t12 = rho[0] * rho[0];
  t14 = 0.1e1 / t5 / t12;
  t17 = lapl[0] * t7 / 0.6e1 - 0.53333333333333333333e0 * t10 + 0.66666666666666666667e-1 * sigma[0] * t14;
  t18 = fabs(t17);
  t19 = t18 < 0.50e-12;
  t20 = 0.0e0 < t17;
  t21 = my_piecewise3(t20, 0.50e-12, -0.50e-12);
  t22 = my_piecewise3(t19, t21, t17);
  t23 = xc_mgga_x_br89_get_x(t22);
  t25 = exp(t23 / 0.3e1);
  t26 = exp(-t23);
  t29 = t26 * (0.1e1 + t23 / 0.2e1);
  t30 = 0.1e1 - t29;
  t31 = t25 * t30;
  t32 = 0.1e1 / t23;
  t33 = t31 * t32;
  t38 = sqrt(0.15e2);
  t39 = (0.3e1 * params->c - 0.2e1) * t38;
  t40 = 0.1e1 / M_PI;
  t41 = M_SQRT2;
  t42 = t40 * t41;
  t43 = params->alpha * sigma[0];
  t46 = t10 - t43 * t14 / 0.8e1;
  t47 = 0.1e-9 < t46;
  t48 = my_piecewise3(t47, t46, 0.1e-9);
  t49 = sqrt(t48);
  t53 = -0.2e1 * t3 * t33 + t39 * t42 * t49 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t53 * t4;

  t54 = POW_1_3(rho[1]);
  t55 = t54 * t54;
  t57 = 0.1e1 / t55 / rho[1];
  t60 = tau[1] * t57;
  t62 = rho[1] * rho[1];
  t64 = 0.1e1 / t55 / t62;
  t67 = lapl[1] * t57 / 0.6e1 - 0.53333333333333333333e0 * t60 + 0.66666666666666666667e-1 * sigma[2] * t64;
  t68 = fabs(t67);
  t69 = t68 < 0.50e-12;
  t70 = 0.0e0 < t67;
  t71 = my_piecewise3(t70, 0.50e-12, -0.50e-12);
  t72 = my_piecewise3(t69, t71, t67);
  t73 = xc_mgga_x_br89_get_x(t72);
  t75 = exp(t73 / 0.3e1);
  t76 = exp(-t73);
  t79 = t76 * (0.1e1 + t73 / 0.2e1);
  t80 = 0.1e1 - t79;
  t81 = t75 * t80;
  t82 = 0.1e1 / t73;
  t83 = t81 * t82;
  t86 = params->alpha * sigma[2];
  t89 = t60 - t86 * t64 / 0.8e1;
  t90 = 0.1e-9 < t89;
  t91 = my_piecewise3(t90, t89, 0.1e-9);
  t92 = sqrt(t91);
  t96 = -0.2e1 * t3 * t83 + t39 * t42 * t92 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t96 * t54;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t97 = params->c * M_PI;
  t98 = my_piecewise3(t20, 0, 0);
  t101 = tau[0] * t14;
  t105 = 0.1e1 / t5 / t12 / rho[0];
  t109 = my_piecewise3(t19, t98, -0.5e1 / 0.18e2 * lapl[0] * t14 + 0.88888888888888888889e0 * t101 - 0.17777777777777777778e0 * sigma[0] * t105);
  t110 = t22 * t22;
  t111 = 0.1e1 / t110;
  t112 = t109 * t111;
  t114 = exp(-0.2e1 / 0.3e1 * t23);
  t115 = 0.1e1 / t114;
  t116 = t112 * t115;
  t117 = t97 * t116;
  t118 = t23 * t23;
  t120 = t118 - 0.2e1 * t23 + 0.3e1;
  t121 = 0.1e1 / t120;
  t122 = t23 - 0.2e1;
  t123 = t122 * t122;
  t124 = t121 * t123;
  t125 = t124 * t33;
  t128 = t2 * t2;
  t129 = t128 * t109;
  t130 = t111 * t115;
  t131 = t129 * t130;
  t132 = t124 * t29;
  t134 = t129 * t111;
  t135 = t115 * t121;
  t137 = t135 * t123 * t26;
  t141 = t25 * (t131 * t132 - t134 * t137 / 0.2e1);
  t142 = t141 * t32;
  t145 = 0.1e1 / t118;
  t146 = t31 * t145;
  t147 = t97 * t146;
  t148 = t135 * t123;
  t149 = t112 * t148;
  t152 = t39 * t40;
  t154 = t41 / t49;
  t159 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t101 + t43 * t105 / 0.3e1, 0);
  t163 = -0.2e1 / 0.3e1 * t117 * t125 - 0.2e1 * t3 * t142 + 0.2e1 * t147 * t149 + t152 * t154 * t159 / 0.12e2;
  t165 = 0.1e1 / t5;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = t163 * t4 + t53 * t165 / 0.3e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = 0.0e0;

  t168 = my_piecewise3(t70, 0, 0);
  t171 = tau[1] * t64;
  t175 = 0.1e1 / t55 / t62 / rho[1];
  t179 = my_piecewise3(t69, t168, -0.5e1 / 0.18e2 * lapl[1] * t64 + 0.88888888888888888889e0 * t171 - 0.17777777777777777778e0 * sigma[2] * t175);
  t180 = t72 * t72;
  t181 = 0.1e1 / t180;
  t182 = t179 * t181;
  t184 = exp(-0.2e1 / 0.3e1 * t73);
  t185 = 0.1e1 / t184;
  t186 = t182 * t185;
  t187 = t97 * t186;
  t188 = t73 * t73;
  t190 = t188 - 0.2e1 * t73 + 0.3e1;
  t191 = 0.1e1 / t190;
  t192 = t73 - 0.2e1;
  t193 = t192 * t192;
  t194 = t191 * t193;
  t195 = t194 * t83;
  t198 = t128 * t179;
  t199 = t181 * t185;
  t200 = t198 * t199;
  t201 = t194 * t79;
  t203 = t198 * t181;
  t204 = t185 * t191;
  t206 = t204 * t193 * t76;
  t210 = t75 * (t200 * t201 - t203 * t206 / 0.2e1);
  t211 = t210 * t82;
  t214 = 0.1e1 / t188;
  t215 = t81 * t214;
  t216 = t97 * t215;
  t217 = t204 * t193;
  t218 = t182 * t217;
  t222 = t41 / t92;
  t227 = my_piecewise3(t90, -0.5e1 / 0.3e1 * t171 + t86 * t175 / 0.3e1, 0);
  t231 = -0.2e1 / 0.3e1 * t187 * t195 - 0.2e1 * t3 * t211 + 0.2e1 * t216 * t218 + t152 * t222 * t227 / 0.12e2;
  t233 = 0.1e1 / t55;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = t231 * t54 + t96 * t233 / 0.3e1;

  t237 = my_piecewise3(t19, t98, t7 / 0.6e1);
  t238 = t237 * t111;
  t239 = t238 * t115;
  t240 = t97 * t239;
  t243 = t128 * t237;
  t244 = t243 * t130;
  t246 = t243 * t111;
  t250 = t25 * (t244 * t132 - t246 * t137 / 0.2e1);
  t251 = t250 * t32;
  t254 = t238 * t148;
  t257 = -0.2e1 / 0.3e1 * t240 * t125 - 0.2e1 * t3 * t251 + 0.2e1 * t147 * t254;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t257 * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = 0.0e0;

  t259 = my_piecewise3(t69, t168, t57 / 0.6e1);
  t260 = t259 * t181;
  t261 = t260 * t185;
  t262 = t97 * t261;
  t265 = t128 * t259;
  t266 = t265 * t199;
  t268 = t265 * t181;
  t272 = t75 * (t266 * t201 - t268 * t206 / 0.2e1);
  t273 = t272 * t82;
  t276 = t260 * t217;
  t279 = -0.2e1 / 0.3e1 * t262 * t195 - 0.2e1 * t3 * t273 + 0.2e1 * t216 * t276;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = t279 * t54;

  t281 = my_piecewise3(t19, t98, 0.66666666666666666667e-1 * t14);
  t282 = t281 * t111;
  t283 = t282 * t115;
  t284 = t97 * t283;
  t287 = t128 * t281;
  t288 = t287 * t130;
  t290 = t287 * t111;
  t294 = t25 * (t288 * t132 - t290 * t137 / 0.2e1);
  t295 = t294 * t32;
  t298 = t282 * t148;
  t303 = my_piecewise3(t47, -params->alpha * t14 / 0.8e1, 0);
  t307 = -0.2e1 / 0.3e1 * t284 * t125 - 0.2e1 * t3 * t295 + 0.2e1 * t147 * t298 + t152 * t154 * t303 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t307 * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t309 = my_piecewise3(t69, t168, 0.66666666666666666667e-1 * t64);
  t310 = t309 * t181;
  t311 = t310 * t185;
  t312 = t97 * t311;
  t315 = t128 * t309;
  t316 = t315 * t199;
  t318 = t315 * t181;
  t322 = t75 * (t316 * t201 - t318 * t206 / 0.2e1);
  t323 = t322 * t82;
  t326 = t310 * t217;
  t331 = my_piecewise3(t90, -params->alpha * t64 / 0.8e1, 0);
  t335 = -0.2e1 / 0.3e1 * t312 * t195 - 0.2e1 * t3 * t323 + 0.2e1 * t216 * t326 + t152 * t222 * t331 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t335 * t54;

  t337 = my_piecewise3(t19, t98, -0.53333333333333333333e0 * t7);
  t338 = t337 * t111;
  t339 = t338 * t115;
  t340 = t97 * t339;
  t343 = t128 * t337;
  t344 = t343 * t130;
  t346 = t343 * t111;
  t350 = t25 * (t344 * t132 - t346 * t137 / 0.2e1);
  t351 = t350 * t32;
  t354 = t338 * t148;
  t357 = my_piecewise3(t47, t7, 0);
  t361 = -0.2e1 / 0.3e1 * t340 * t125 - 0.2e1 * t3 * t351 + 0.2e1 * t147 * t354 + t152 * t154 * t357 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = t361 * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = 0.0e0;

  t363 = my_piecewise3(t69, t168, -0.53333333333333333333e0 * t57);
  t364 = t363 * t181;
  t365 = t364 * t185;
  t366 = t97 * t365;
  t369 = t128 * t363;
  t370 = t369 * t199;
  t372 = t369 * t181;
  t376 = t75 * (t370 * t201 - t372 * t206 / 0.2e1);
  t377 = t376 * t82;
  t380 = t364 * t217;
  t383 = my_piecewise3(t90, t57, 0);
  t387 = -0.2e1 / 0.3e1 * t366 * t195 - 0.2e1 * t3 * t377 + 0.2e1 * t216 * t380 + t152 * t222 * t383 / 0.12e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = t387 * t54;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t389 = my_piecewise3(t19, t98, -0.5e1 / 0.18e2 * t14);
  t390 = t389 * t111;
  t396 = 0.1e1 / t110 / t22;
  t398 = t237 * t396 * t115;
  t399 = t97 * t398;
  t400 = t124 * t25;
  t401 = t30 * t32;
  t402 = t401 * t109;
  t403 = t400 * t402;
  t407 = params->c * t128 * M_PI;
  t408 = t110 * t110;
  t409 = 0.1e1 / t408;
  t411 = t114 * t114;
  t412 = 0.1e1 / t411;
  t413 = t237 * t409 * t412;
  t414 = t407 * t413;
  t415 = t120 * t120;
  t416 = 0.1e1 / t415;
  t417 = t123 * t123;
  t418 = t416 * t417;
  t419 = t418 * t25;
  t420 = t419 * t402;
  t423 = t416 * t123;
  t424 = t423 * t25;
  t425 = t23 * t128;
  t427 = t130 * t124;
  t431 = 0.2e1 * t425 * t109 * t427 - 0.2e1 * t134 * t148;
  t433 = t424 * t401 * t431;
  t436 = t123 * t122;
  t437 = t416 * t436;
  t438 = t437 * t25;
  t439 = t438 * t402;
  t442 = t124 * t142;
  t445 = t30 * t145;
  t447 = t419 * t445 * t109;
  t450 = t124 * t251;
  t453 = t128 * t389;
  t456 = t396 * t115;
  t457 = t243 * t456;
  t458 = t29 * t109;
  t459 = t124 * t458;
  t462 = t2 * M_PI;
  t464 = t409 * t412;
  t465 = t462 * t237 * t464;
  t466 = t418 * t458;
  t470 = t423 * t29 * t431;
  t472 = t437 * t458;
  t475 = t26 * t109;
  t476 = t418 * t475;
  t482 = t124 * t475;
  t485 = t423 * t26 * t431;
  t488 = t437 * t475;
  t496 = t97 * t250 * t145;
  t500 = t97 * t141 * t145;
  t506 = t407 * t31 / t118 / t23;
  t507 = t418 * t109;
  t514 = t124 * t109;
  t518 = t423 * t431;
  t522 = t407 * t146;
  t523 = t437 * t109;
  t527 = -0.2e1 / 0.3e1 * t97 * t390 * t115 * t125 + 0.4e1 / 0.3e1 * t399 * t403 - 0.2e1 / 0.3e1 * t414 * t420 + 0.2e1 / 0.3e1 * t240 * t433 - 0.4e1 / 0.3e1 * t414 * t439 - 0.2e1 / 0.3e1 * t240 * t442 + 0.8e1 / 0.3e1 * t414 * t447 - 0.2e1 / 0.3e1 * t117 * t450 - 0.2e1 * t3 * t25 * (t453 * t130 * t132 - 0.2e1 * t457 * t459 - t465 * t466 / 0.3e1 - t244 * t470 + 0.2e1 * t465 * t472 + 0.2e1 / 0.3e1 * t465 * t476 - t453 * t111 * t137 / 0.2e1 + t457 * t482 + t244 * t485 / 0.2e1 - t465 * t488) * t32 + 0.2e1 * t496 * t149 + 0.2e1 * t500 * t254 - 0.4e1 * t506 * t413 * t507 + 0.2e1 * t147 * t390 * t148 - 0.4e1 * t147 * t398 * t514 - 0.2e1 * t147 * t239 * t518 + 0.4e1 * t522 * t413 * t523;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[0] = t527 * t4 + t257 * t165 / 0.3e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[4] = 0.0e0;

  t532 = my_piecewise3(t69, t168, -0.5e1 / 0.18e2 * t64);
  t533 = t532 * t181;
  t539 = 0.1e1 / t180 / t72;
  t541 = t259 * t539 * t185;
  t542 = t97 * t541;
  t543 = t194 * t75;
  t544 = t80 * t82;
  t545 = t544 * t179;
  t546 = t543 * t545;
  t549 = t180 * t180;
  t550 = 0.1e1 / t549;
  t552 = t184 * t184;
  t553 = 0.1e1 / t552;
  t554 = t259 * t550 * t553;
  t555 = t407 * t554;
  t556 = t190 * t190;
  t557 = 0.1e1 / t556;
  t558 = t193 * t193;
  t559 = t557 * t558;
  t560 = t559 * t75;
  t561 = t560 * t545;
  t564 = t557 * t193;
  t565 = t564 * t75;
  t566 = t73 * t128;
  t568 = t199 * t194;
  t572 = 0.2e1 * t566 * t179 * t568 - 0.2e1 * t203 * t217;
  t574 = t565 * t544 * t572;
  t577 = t193 * t192;
  t578 = t557 * t577;
  t579 = t578 * t75;
  t580 = t579 * t545;
  t583 = t194 * t211;
  t586 = t80 * t214;
  t588 = t560 * t586 * t179;
  t591 = t194 * t273;
  t594 = t128 * t532;
  t597 = t539 * t185;
  t598 = t265 * t597;
  t599 = t79 * t179;
  t600 = t194 * t599;
  t604 = t550 * t553;
  t605 = t462 * t259 * t604;
  t606 = t559 * t599;
  t610 = t564 * t79 * t572;
  t612 = t578 * t599;
  t615 = t76 * t179;
  t616 = t559 * t615;
  t622 = t194 * t615;
  t625 = t564 * t76 * t572;
  t628 = t578 * t615;
  t636 = t97 * t272 * t214;
  t640 = t97 * t210 * t214;
  t646 = t407 * t81 / t188 / t73;
  t647 = t559 * t179;
  t654 = t194 * t179;
  t658 = t564 * t572;
  t662 = t407 * t215;
  t663 = t578 * t179;
  t667 = -0.2e1 / 0.3e1 * t97 * t533 * t185 * t195 + 0.4e1 / 0.3e1 * t542 * t546 - 0.2e1 / 0.3e1 * t555 * t561 + 0.2e1 / 0.3e1 * t262 * t574 - 0.4e1 / 0.3e1 * t555 * t580 - 0.2e1 / 0.3e1 * t262 * t583 + 0.8e1 / 0.3e1 * t555 * t588 - 0.2e1 / 0.3e1 * t187 * t591 - 0.2e1 * t3 * t75 * (t594 * t199 * t201 - 0.2e1 * t598 * t600 - t605 * t606 / 0.3e1 - t266 * t610 + 0.2e1 * t605 * t612 + 0.2e1 / 0.3e1 * t605 * t616 - t594 * t181 * t206 / 0.2e1 + t598 * t622 + t266 * t625 / 0.2e1 - t605 * t628) * t82 + 0.2e1 * t636 * t218 + 0.2e1 * t640 * t276 - 0.4e1 * t646 * t554 * t647 + 0.2e1 * t216 * t533 * t217 - 0.4e1 * t216 * t541 * t654 - 0.2e1 * t216 * t261 * t658 + 0.4e1 * t662 * t554 * t663;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2lapl[5] = t667 * t54 + t279 * t233 / 0.3e1;

  t672 = my_piecewise3(t19, t98, -0.17777777777777777778e0 * t105);
  t673 = t672 * t111;
  t679 = t281 * t396 * t115;
  t684 = t281 * t409 * t412;
  t685 = t407 * t684;
  t696 = t124 * t295;
  t699 = t128 * t672;
  t702 = t287 * t456;
  t706 = t462 * t281 * t464;
  t727 = t97 * t294 * t145;
  t749 = t41 / t49 / t48;
  t756 = my_piecewise3(t47, params->alpha * t105 / 0.3e1, 0);
  t760 = -0.2e1 / 0.3e1 * t97 * t673 * t115 * t125 + 0.4e1 / 0.3e1 * t97 * t679 * t403 - 0.2e1 / 0.3e1 * t685 * t420 + 0.2e1 / 0.3e1 * t284 * t433 - 0.4e1 / 0.3e1 * t685 * t439 - 0.2e1 / 0.3e1 * t284 * t442 + 0.8e1 / 0.3e1 * t685 * t447 - 0.2e1 / 0.3e1 * t117 * t696 - 0.2e1 * t3 * t25 * (t699 * t130 * t132 - 0.2e1 * t702 * t459 - t706 * t466 / 0.3e1 - t288 * t470 + 0.2e1 * t706 * t472 + 0.2e1 / 0.3e1 * t706 * t476 - t699 * t111 * t137 / 0.2e1 + t702 * t482 + t288 * t485 / 0.2e1 - t706 * t488) * t32 + 0.2e1 * t727 * t149 + 0.2e1 * t500 * t298 - 0.4e1 * t506 * t684 * t507 + 0.2e1 * t147 * t673 * t148 - 0.4e1 * t147 * t679 * t514 - 0.2e1 * t147 * t283 * t518 + 0.4e1 * t522 * t684 * t523 - t152 * t749 * t303 * t159 / 0.24e2 + t152 * t154 * t756 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t760 * t4 + t307 * t165 / 0.3e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t765 = my_piecewise3(t69, t168, -0.17777777777777777778e0 * t175);
  t766 = t765 * t181;
  t772 = t309 * t539 * t185;
  t777 = t309 * t550 * t553;
  t778 = t407 * t777;
  t789 = t194 * t323;
  t792 = t128 * t765;
  t795 = t315 * t597;
  t799 = t462 * t309 * t604;
  t820 = t97 * t322 * t214;
  t842 = t41 / t92 / t91;
  t849 = my_piecewise3(t90, params->alpha * t175 / 0.3e1, 0);
  t853 = -0.2e1 / 0.3e1 * t97 * t766 * t185 * t195 + 0.4e1 / 0.3e1 * t97 * t772 * t546 - 0.2e1 / 0.3e1 * t778 * t561 + 0.2e1 / 0.3e1 * t312 * t574 - 0.4e1 / 0.3e1 * t778 * t580 - 0.2e1 / 0.3e1 * t312 * t583 + 0.8e1 / 0.3e1 * t778 * t588 - 0.2e1 / 0.3e1 * t187 * t789 - 0.2e1 * t3 * t75 * (t792 * t199 * t201 - 0.2e1 * t795 * t600 - t799 * t606 / 0.3e1 - t316 * t610 + 0.2e1 * t799 * t612 + 0.2e1 / 0.3e1 * t799 * t616 - t792 * t181 * t206 / 0.2e1 + t795 * t622 + t316 * t625 / 0.2e1 - t799 * t628) * t82 + 0.2e1 * t820 * t218 + 0.2e1 * t640 * t326 - 0.4e1 * t646 * t777 * t647 + 0.2e1 * t216 * t766 * t217 - 0.4e1 * t216 * t772 * t654 - 0.2e1 * t216 * t311 * t658 + 0.4e1 * t662 * t777 * t663 - t152 * t842 * t331 * t227 / 0.24e2 + t152 * t222 * t849 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t853 * t54 + t335 * t233 / 0.3e1;

  t858 = my_piecewise3(t19, t98, 0.88888888888888888889e0 * t14);
  t859 = t858 * t111;
  t865 = t337 * t396 * t115;
  t866 = t97 * t865;
  t870 = t337 * t409 * t412;
  t871 = t407 * t870;
  t882 = t124 * t351;
  t885 = t128 * t858;
  t888 = t343 * t456;
  t892 = t462 * t337 * t464;
  t913 = t97 * t350 * t145;
  t938 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t14, 0);
  t942 = -0.2e1 / 0.3e1 * t97 * t859 * t115 * t125 + 0.4e1 / 0.3e1 * t866 * t403 - 0.2e1 / 0.3e1 * t871 * t420 + 0.2e1 / 0.3e1 * t340 * t433 - 0.4e1 / 0.3e1 * t871 * t439 - 0.2e1 / 0.3e1 * t340 * t442 + 0.8e1 / 0.3e1 * t871 * t447 - 0.2e1 / 0.3e1 * t117 * t882 - 0.2e1 * t3 * t25 * (t885 * t130 * t132 - 0.2e1 * t888 * t459 - t892 * t466 / 0.3e1 - t344 * t470 + 0.2e1 * t892 * t472 + 0.2e1 / 0.3e1 * t892 * t476 - t885 * t111 * t137 / 0.2e1 + t888 * t482 + t344 * t485 / 0.2e1 - t892 * t488) * t32 + 0.2e1 * t913 * t149 + 0.2e1 * t500 * t354 - 0.4e1 * t506 * t870 * t507 + 0.2e1 * t147 * t859 * t148 - 0.4e1 * t147 * t865 * t514 - 0.2e1 * t147 * t339 * t518 + 0.4e1 * t522 * t870 * t523 - t152 * t749 * t357 * t159 / 0.24e2 + t152 * t154 * t938 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[0] = t942 * t4 + t361 * t165 / 0.3e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[4] = 0.0e0;

  t947 = my_piecewise3(t69, t168, 0.88888888888888888889e0 * t64);
  t948 = t947 * t181;
  t954 = t363 * t539 * t185;
  t955 = t97 * t954;
  t959 = t363 * t550 * t553;
  t960 = t407 * t959;
  t971 = t194 * t377;
  t974 = t128 * t947;
  t977 = t369 * t597;
  t981 = t462 * t363 * t604;
  t1002 = t97 * t376 * t214;
  t1027 = my_piecewise3(t90, -0.5e1 / 0.3e1 * t64, 0);
  t1031 = -0.2e1 / 0.3e1 * t97 * t948 * t185 * t195 + 0.4e1 / 0.3e1 * t955 * t546 - 0.2e1 / 0.3e1 * t960 * t561 + 0.2e1 / 0.3e1 * t366 * t574 - 0.4e1 / 0.3e1 * t960 * t580 - 0.2e1 / 0.3e1 * t366 * t583 + 0.8e1 / 0.3e1 * t960 * t588 - 0.2e1 / 0.3e1 * t187 * t971 - 0.2e1 * t3 * t75 * (t974 * t199 * t201 - 0.2e1 * t977 * t600 - t981 * t606 / 0.3e1 - t370 * t610 + 0.2e1 * t981 * t612 + 0.2e1 / 0.3e1 * t981 * t616 - t974 * t181 * t206 / 0.2e1 + t977 * t622 + t370 * t625 / 0.2e1 - t981 * t628) * t82 + 0.2e1 * t1002 * t218 + 0.2e1 * t640 * t380 - 0.4e1 * t646 * t959 * t647 + 0.2e1 * t216 * t948 * t217 - 0.4e1 * t216 * t954 * t654 - 0.2e1 * t216 * t365 * t658 + 0.4e1 * t662 * t959 * t663 - t152 * t842 * t383 * t227 / 0.24e2 + t152 * t222 * t1027 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2tau[5] = t1031 * t54 + t387 * t233 / 0.3e1;

  t1037 = tau[0] * t105;
  t1039 = t12 * t12;
  t1041 = 0.1e1 / t5 / t1039;
  t1045 = my_piecewise3(t19, t98, 0.20e2 / 0.27e2 * lapl[0] * t105 - 0.23703703703703703704e1 * t1037 + 0.65185185185185185186e0 * sigma[0] * t1041);
  t1046 = t1045 * t111;
  t1051 = t109 * t109;
  t1052 = t1051 * t396;
  t1057 = t1051 * t409;
  t1059 = t407 * t1057 * t412;
  t1060 = t418 * t33;
  t1065 = t437 * t33;
  t1070 = t418 * t146;
  t1073 = t128 * t1045;
  t1076 = t128 * t1051;
  t1080 = t462 * t1051;
  t1081 = t1080 * t464;
  t1082 = t418 * t29;
  t1086 = t437 * t29;
  t1089 = t1080 * t409;
  t1090 = t412 * t416;
  t1092 = t1090 * t417 * t26;
  t1103 = t1090 * t436 * t26;
  t1112 = t1090 * t417;
  t1125 = t1090 * t436;
  t1129 = t159 * t159;
  t1137 = my_piecewise3(t47, 0.40e2 / 0.9e1 * t1037 - 0.11e2 / 0.9e1 * t43 * t1041, 0);
  t1141 = -0.2e1 / 0.3e1 * t97 * t1046 * t115 * t125 + 0.4e1 / 0.3e1 * t97 * t1052 * t115 * t125 - 0.2e1 / 0.3e1 * t1059 * t1060 + 0.2e1 / 0.3e1 * t117 * t433 - 0.4e1 / 0.3e1 * t1059 * t1065 - 0.4e1 / 0.3e1 * t117 * t442 + 0.8e1 / 0.3e1 * t1059 * t1070 - 0.2e1 * t3 * t25 * (t1073 * t130 * t132 - 0.2e1 * t1076 * t456 * t132 - t1081 * t1082 / 0.3e1 - t131 * t470 + 0.2e1 * t1081 * t1086 + 0.2e1 / 0.3e1 * t1089 * t1092 - t1073 * t111 * t137 / 0.2e1 + t1076 * t396 * t137 + t131 * t485 / 0.2e1 - t1089 * t1103) * t32 + 0.4e1 * t500 * t149 - 0.4e1 * t506 * t1057 * t1112 + 0.2e1 * t147 * t1046 * t148 - 0.4e1 * t147 * t1052 * t148 - 0.2e1 * t147 * t116 * t518 + 0.4e1 * t522 * t1057 * t1125 - t152 * t749 * t1129 / 0.24e2 + t152 * t154 * t1137 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t1141 * t4 + 0.2e1 / 0.3e1 * t163 * t165 - 0.2e1 / 0.9e1 * t53 * t7;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = 0.0e0;

  t1149 = tau[1] * t175;
  t1151 = t62 * t62;
  t1153 = 0.1e1 / t55 / t1151;
  t1157 = my_piecewise3(t69, t168, 0.20e2 / 0.27e2 * lapl[1] * t175 - 0.23703703703703703704e1 * t1149 + 0.65185185185185185186e0 * sigma[2] * t1153);
  t1158 = t1157 * t181;
  t1163 = t179 * t179;
  t1164 = t1163 * t539;
  t1169 = t1163 * t550;
  t1171 = t407 * t1169 * t553;
  t1172 = t559 * t83;
  t1177 = t578 * t83;
  t1182 = t559 * t215;
  t1185 = t128 * t1157;
  t1188 = t128 * t1163;
  t1192 = t462 * t1163;
  t1193 = t1192 * t604;
  t1194 = t559 * t79;
  t1198 = t578 * t79;
  t1201 = t1192 * t550;
  t1202 = t553 * t557;
  t1204 = t1202 * t558 * t76;
  t1215 = t1202 * t577 * t76;
  t1224 = t1202 * t558;
  t1237 = t1202 * t577;
  t1241 = t227 * t227;
  t1249 = my_piecewise3(t90, 0.40e2 / 0.9e1 * t1149 - 0.11e2 / 0.9e1 * t86 * t1153, 0);
  t1253 = -0.2e1 / 0.3e1 * t97 * t1158 * t185 * t195 + 0.4e1 / 0.3e1 * t97 * t1164 * t185 * t195 - 0.2e1 / 0.3e1 * t1171 * t1172 + 0.2e1 / 0.3e1 * t187 * t574 - 0.4e1 / 0.3e1 * t1171 * t1177 - 0.4e1 / 0.3e1 * t187 * t583 + 0.8e1 / 0.3e1 * t1171 * t1182 - 0.2e1 * t3 * t75 * (t1185 * t199 * t201 - 0.2e1 * t1188 * t597 * t201 - t1193 * t1194 / 0.3e1 - t200 * t610 + 0.2e1 * t1193 * t1198 + 0.2e1 / 0.3e1 * t1201 * t1204 - t1185 * t181 * t206 / 0.2e1 + t1188 * t539 * t206 + t200 * t625 / 0.2e1 - t1201 * t1215) * t82 + 0.4e1 * t640 * t218 - 0.4e1 * t646 * t1169 * t1224 + 0.2e1 * t216 * t1158 * t217 - 0.4e1 * t216 * t1164 * t217 - 0.2e1 * t216 * t186 * t658 + 0.4e1 * t662 * t1169 * t1237 - t152 * t842 * t1241 / 0.24e2 + t152 * t222 * t1249 / 0.12e2;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = t1253 * t54 + 0.2e1 / 0.3e1 * t231 * t233 - 0.2e1 / 0.9e1 * t96 * t57;

  t1259 = my_piecewise3(t19, t98, 0);
  t1260 = t1259 * t111;
  t1264 = 0.2e1 / 0.3e1 * t97 * t1260 * t115 * t125;
  t1265 = t237 * t237;
  t1266 = t1265 * t396;
  t1271 = t1265 * t409;
  t1273 = t407 * t1271 * t412;
  t1280 = 0.2e1 * t425 * t237 * t427 - 0.2e1 * t246 * t148;
  t1282 = t424 * t401 * t1280;
  t1291 = t128 * t1259;
  t1293 = t1291 * t130 * t132;
  t1294 = t128 * t1265;
  t1298 = t462 * t1265;
  t1299 = t1298 * t464;
  t1303 = t423 * t29 * t1280;
  t1307 = t1298 * t409;
  t1312 = t1291 * t111 * t137 / 0.2e1;
  t1316 = t423 * t26 * t1280;
  t1332 = 0.2e1 * t147 * t1260 * t148;
  t1336 = t423 * t1280;
  t1343 = -t1264 + 0.4e1 / 0.3e1 * t97 * t1266 * t115 * t125 - 0.2e1 / 0.3e1 * t1273 * t1060 + 0.2e1 / 0.3e1 * t240 * t1282 - 0.4e1 / 0.3e1 * t1273 * t1065 - 0.4e1 / 0.3e1 * t240 * t450 + 0.8e1 / 0.3e1 * t1273 * t1070 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t1294 * t456 * t132 - t1299 * t1082 / 0.3e1 - t244 * t1303 + 0.2e1 * t1299 * t1086 + 0.2e1 / 0.3e1 * t1307 * t1092 - t1312 + t1294 * t396 * t137 + t244 * t1316 / 0.2e1 - t1307 * t1103) * t32 + 0.4e1 * t496 * t254 - 0.4e1 * t506 * t1271 * t1112 + t1332 - 0.4e1 * t147 * t1266 * t148 - 0.2e1 * t147 * t239 * t1336 + 0.4e1 * t522 * t1271 * t1125;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[0] = t1343 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[4] = 0.0e0;

  t1344 = my_piecewise3(t69, t168, 0);
  t1345 = t1344 * t181;
  t1349 = 0.2e1 / 0.3e1 * t97 * t1345 * t185 * t195;
  t1350 = t259 * t259;
  t1351 = t1350 * t539;
  t1356 = t1350 * t550;
  t1358 = t407 * t1356 * t553;
  t1365 = 0.2e1 * t566 * t259 * t568 - 0.2e1 * t268 * t217;
  t1367 = t565 * t544 * t1365;
  t1376 = t128 * t1344;
  t1378 = t1376 * t199 * t201;
  t1379 = t128 * t1350;
  t1383 = t462 * t1350;
  t1384 = t1383 * t604;
  t1388 = t564 * t79 * t1365;
  t1392 = t1383 * t550;
  t1397 = t1376 * t181 * t206 / 0.2e1;
  t1401 = t564 * t76 * t1365;
  t1417 = 0.2e1 * t216 * t1345 * t217;
  t1421 = t564 * t1365;
  t1428 = -t1349 + 0.4e1 / 0.3e1 * t97 * t1351 * t185 * t195 - 0.2e1 / 0.3e1 * t1358 * t1172 + 0.2e1 / 0.3e1 * t262 * t1367 - 0.4e1 / 0.3e1 * t1358 * t1177 - 0.4e1 / 0.3e1 * t262 * t591 + 0.8e1 / 0.3e1 * t1358 * t1182 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t1379 * t597 * t201 - t1384 * t1194 / 0.3e1 - t266 * t1388 + 0.2e1 * t1384 * t1198 + 0.2e1 / 0.3e1 * t1392 * t1204 - t1397 + t1379 * t539 * t206 + t266 * t1401 / 0.2e1 - t1392 * t1215) * t82 + 0.4e1 * t636 * t276 - 0.4e1 * t646 * t1356 * t1224 + t1417 - 0.4e1 * t216 * t1351 * t217 - 0.2e1 * t216 * t261 * t1421 + 0.4e1 * t662 * t1356 * t1237;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapl2[5] = t1428 * t54;

  t1429 = t401 * t237;
  t1449 = t29 * t237;
  t1460 = t26 * t237;
  t1494 = -t1264 + 0.4e1 / 0.3e1 * t866 * t400 * t1429 - 0.2e1 / 0.3e1 * t871 * t419 * t1429 + 0.2e1 / 0.3e1 * t340 * t1282 - 0.4e1 / 0.3e1 * t871 * t438 * t1429 - 0.2e1 / 0.3e1 * t340 * t450 + 0.8e1 / 0.3e1 * t871 * t419 * t445 * t237 - 0.2e1 / 0.3e1 * t240 * t882 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t888 * t124 * t1449 - t892 * t418 * t1449 / 0.3e1 - t344 * t1303 + 0.2e1 * t892 * t437 * t1449 + 0.2e1 / 0.3e1 * t892 * t418 * t1460 - t1312 + t888 * t124 * t1460 + t344 * t1316 / 0.2e1 - t892 * t437 * t1460) * t32 + 0.2e1 * t913 * t254 + 0.2e1 * t496 * t354 - 0.4e1 * t506 * t870 * t418 * t237 + t1332 - 0.4e1 * t147 * t865 * t124 * t237 - 0.2e1 * t147 * t339 * t1336 + 0.4e1 * t522 * t870 * t437 * t237;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[0] = t1494 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[6] = 0.0e0;

  t1495 = t544 * t259;
  t1515 = t79 * t259;
  t1526 = t76 * t259;
  t1560 = -t1349 + 0.4e1 / 0.3e1 * t955 * t543 * t1495 - 0.2e1 / 0.3e1 * t960 * t560 * t1495 + 0.2e1 / 0.3e1 * t366 * t1367 - 0.4e1 / 0.3e1 * t960 * t579 * t1495 - 0.2e1 / 0.3e1 * t366 * t591 + 0.8e1 / 0.3e1 * t960 * t560 * t586 * t259 - 0.2e1 / 0.3e1 * t262 * t971 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t977 * t194 * t1515 - t981 * t559 * t1515 / 0.3e1 - t370 * t1388 + 0.2e1 * t981 * t578 * t1515 + 0.2e1 / 0.3e1 * t981 * t559 * t1526 - t1397 + t977 * t194 * t1526 + t370 * t1401 / 0.2e1 - t981 * t578 * t1526) * t82 + 0.2e1 * t1002 * t276 + 0.2e1 * t636 * t380 - 0.4e1 * t646 * t959 * t559 * t259 + t1417 - 0.4e1 * t216 * t954 * t194 * t259 - 0.2e1 * t216 * t365 * t1421 + 0.4e1 * t662 * t959 * t578 * t259;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rholapltau[7] = t1560 * t54;

  t1561 = t281 * t281;
  t1562 = t1561 * t396;
  t1567 = t1561 * t409;
  t1569 = t407 * t1567 * t412;
  t1576 = 0.2e1 * t425 * t281 * t427 - 0.2e1 * t290 * t148;
  t1578 = t424 * t401 * t1576;
  t1587 = t128 * t1561;
  t1591 = t462 * t1561;
  t1592 = t1591 * t464;
  t1596 = t423 * t29 * t1576;
  t1600 = t1591 * t409;
  t1606 = t423 * t26 * t1576;
  t1623 = t423 * t1576;
  t1630 = t303 * t303;
  t1634 = my_piecewise3(t47, 0, 0);
  t1637 = t152 * t154 * t1634 / 0.12e2;
  t1638 = -t1264 + 0.4e1 / 0.3e1 * t97 * t1562 * t115 * t125 - 0.2e1 / 0.3e1 * t1569 * t1060 + 0.2e1 / 0.3e1 * t284 * t1578 - 0.4e1 / 0.3e1 * t1569 * t1065 - 0.4e1 / 0.3e1 * t284 * t696 + 0.8e1 / 0.3e1 * t1569 * t1070 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t1587 * t456 * t132 - t1592 * t1082 / 0.3e1 - t288 * t1596 + 0.2e1 * t1592 * t1086 + 0.2e1 / 0.3e1 * t1600 * t1092 - t1312 + t1587 * t396 * t137 + t288 * t1606 / 0.2e1 - t1600 * t1103) * t32 + 0.4e1 * t727 * t298 - 0.4e1 * t506 * t1567 * t1112 + t1332 - 0.4e1 * t147 * t1562 * t148 - 0.2e1 * t147 * t283 * t1623 + 0.4e1 * t522 * t1567 * t1125 - t152 * t749 * t1630 / 0.24e2 + t1637;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t1638 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1639 = t309 * t309;
  t1640 = t1639 * t539;
  t1645 = t1639 * t550;
  t1647 = t407 * t1645 * t553;
  t1654 = 0.2e1 * t566 * t309 * t568 - 0.2e1 * t318 * t217;
  t1656 = t565 * t544 * t1654;
  t1665 = t128 * t1639;
  t1669 = t462 * t1639;
  t1670 = t1669 * t604;
  t1674 = t564 * t79 * t1654;
  t1678 = t1669 * t550;
  t1684 = t564 * t76 * t1654;
  t1701 = t564 * t1654;
  t1708 = t331 * t331;
  t1712 = my_piecewise3(t90, 0, 0);
  t1715 = t152 * t222 * t1712 / 0.12e2;
  t1716 = -t1349 + 0.4e1 / 0.3e1 * t97 * t1640 * t185 * t195 - 0.2e1 / 0.3e1 * t1647 * t1172 + 0.2e1 / 0.3e1 * t312 * t1656 - 0.4e1 / 0.3e1 * t1647 * t1177 - 0.4e1 / 0.3e1 * t312 * t789 + 0.8e1 / 0.3e1 * t1647 * t1182 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t1665 * t597 * t201 - t1670 * t1194 / 0.3e1 - t316 * t1674 + 0.2e1 * t1670 * t1198 + 0.2e1 / 0.3e1 * t1678 * t1204 - t1397 + t1665 * t539 * t206 + t316 * t1684 / 0.2e1 - t1678 * t1215) * t82 + 0.4e1 * t820 * t326 - 0.4e1 * t646 * t1645 * t1224 + t1417 - 0.4e1 * t216 * t1640 * t217 - 0.2e1 * t216 * t311 * t1701 + 0.4e1 * t662 * t1645 * t1237 - t152 * t842 * t1708 / 0.24e2 + t1715;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t1716 * t54;

  t1717 = t401 * t281;
  t1718 = t400 * t1717;
  t1721 = t419 * t1717;
  t1726 = t438 * t1717;
  t1732 = t419 * t445 * t281;
  t1737 = t29 * t281;
  t1738 = t124 * t1737;
  t1741 = t418 * t1737;
  t1745 = t437 * t1737;
  t1748 = t26 * t281;
  t1749 = t418 * t1748;
  t1752 = t124 * t1748;
  t1756 = t437 * t1748;
  t1767 = t418 * t281;
  t1771 = t124 * t281;
  t1778 = t437 * t281;
  t1782 = -t1264 + 0.4e1 / 0.3e1 * t399 * t1718 - 0.2e1 / 0.3e1 * t414 * t1721 + 0.2e1 / 0.3e1 * t240 * t1578 - 0.4e1 / 0.3e1 * t414 * t1726 - 0.2e1 / 0.3e1 * t240 * t696 + 0.8e1 / 0.3e1 * t414 * t1732 - 0.2e1 / 0.3e1 * t284 * t450 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t457 * t1738 - t465 * t1741 / 0.3e1 - t244 * t1596 + 0.2e1 * t465 * t1745 + 0.2e1 / 0.3e1 * t465 * t1749 - t1312 + t457 * t1752 + t244 * t1606 / 0.2e1 - t465 * t1756) * t32 + 0.2e1 * t496 * t298 + 0.2e1 * t727 * t254 - 0.4e1 * t506 * t413 * t1767 + t1332 - 0.4e1 * t147 * t398 * t1771 - 0.2e1 * t147 * t239 * t1623 + 0.4e1 * t522 * t413 * t1778;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[0] = t1782 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[10] = 0.0e0;

  t1783 = t544 * t309;
  t1784 = t543 * t1783;
  t1787 = t560 * t1783;
  t1792 = t579 * t1783;
  t1798 = t560 * t586 * t309;
  t1803 = t79 * t309;
  t1804 = t194 * t1803;
  t1807 = t559 * t1803;
  t1811 = t578 * t1803;
  t1814 = t76 * t309;
  t1815 = t559 * t1814;
  t1818 = t194 * t1814;
  t1822 = t578 * t1814;
  t1833 = t559 * t309;
  t1837 = t194 * t309;
  t1844 = t578 * t309;
  t1848 = -t1349 + 0.4e1 / 0.3e1 * t542 * t1784 - 0.2e1 / 0.3e1 * t555 * t1787 + 0.2e1 / 0.3e1 * t262 * t1656 - 0.4e1 / 0.3e1 * t555 * t1792 - 0.2e1 / 0.3e1 * t262 * t789 + 0.8e1 / 0.3e1 * t555 * t1798 - 0.2e1 / 0.3e1 * t312 * t591 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t598 * t1804 - t605 * t1807 / 0.3e1 - t266 * t1674 + 0.2e1 * t605 * t1811 + 0.2e1 / 0.3e1 * t605 * t1815 - t1397 + t598 * t1818 + t266 * t1684 / 0.2e1 - t605 * t1822) * t82 + 0.2e1 * t636 * t326 + 0.2e1 * t820 * t276 - 0.4e1 * t646 * t554 * t1833 + t1417 - 0.4e1 * t216 * t541 * t1837 - 0.2e1 * t216 * t261 * t1701 + 0.4e1 * t662 * t554 * t1844;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmalapl[11] = t1848 * t54;

  t1901 = -t1264 + 0.4e1 / 0.3e1 * t866 * t1718 - 0.2e1 / 0.3e1 * t871 * t1721 + 0.2e1 / 0.3e1 * t340 * t1578 - 0.4e1 / 0.3e1 * t871 * t1726 - 0.2e1 / 0.3e1 * t340 * t696 + 0.8e1 / 0.3e1 * t871 * t1732 - 0.2e1 / 0.3e1 * t284 * t882 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t888 * t1738 - t892 * t1741 / 0.3e1 - t344 * t1596 + 0.2e1 * t892 * t1745 + 0.2e1 / 0.3e1 * t892 * t1749 - t1312 + t888 * t1752 + t344 * t1606 / 0.2e1 - t892 * t1756) * t32 + 0.2e1 * t913 * t298 + 0.2e1 * t727 * t354 - 0.4e1 * t506 * t870 * t1767 + t1332 - 0.4e1 * t147 * t865 * t1771 - 0.2e1 * t147 * t339 * t1623 + 0.4e1 * t522 * t870 * t1778 - t152 * t749 * t357 * t303 / 0.24e2 + t1637;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[0] = t1901 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[10] = 0.0e0;

  t1954 = -t1349 + 0.4e1 / 0.3e1 * t955 * t1784 - 0.2e1 / 0.3e1 * t960 * t1787 + 0.2e1 / 0.3e1 * t366 * t1656 - 0.4e1 / 0.3e1 * t960 * t1792 - 0.2e1 / 0.3e1 * t366 * t789 + 0.8e1 / 0.3e1 * t960 * t1798 - 0.2e1 / 0.3e1 * t312 * t971 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t977 * t1804 - t981 * t1807 / 0.3e1 - t370 * t1674 + 0.2e1 * t981 * t1811 + 0.2e1 / 0.3e1 * t981 * t1815 - t1397 + t977 * t1818 + t370 * t1684 / 0.2e1 - t981 * t1822) * t82 + 0.2e1 * t1002 * t326 + 0.2e1 * t820 * t380 - 0.4e1 * t646 * t959 * t1833 + t1417 - 0.4e1 * t216 * t954 * t1837 - 0.2e1 * t216 * t365 * t1701 + 0.4e1 * t662 * t959 * t1844 - t152 * t842 * t383 * t331 / 0.24e2 + t1715;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigmatau[11] = t1954 * t54;

  t1955 = t337 * t337;
  t1956 = t1955 * t396;
  t1961 = t1955 * t409;
  t1963 = t407 * t1961 * t412;
  t1970 = 0.2e1 * t425 * t337 * t427 - 0.2e1 * t346 * t148;
  t1981 = t128 * t1955;
  t1985 = t462 * t1955;
  t1986 = t1985 * t464;
  t1994 = t1985 * t409;
  t2024 = t357 * t357;
  t2028 = -t1264 + 0.4e1 / 0.3e1 * t97 * t1956 * t115 * t125 - 0.2e1 / 0.3e1 * t1963 * t1060 + 0.2e1 / 0.3e1 * t340 * t424 * t401 * t1970 - 0.4e1 / 0.3e1 * t1963 * t1065 - 0.4e1 / 0.3e1 * t340 * t882 + 0.8e1 / 0.3e1 * t1963 * t1070 - 0.2e1 * t3 * t25 * (t1293 - 0.2e1 * t1981 * t456 * t132 - t1986 * t1082 / 0.3e1 - t344 * t423 * t29 * t1970 + 0.2e1 * t1986 * t1086 + 0.2e1 / 0.3e1 * t1994 * t1092 - t1312 + t1981 * t396 * t137 + t344 * t423 * t26 * t1970 / 0.2e1 - t1994 * t1103) * t32 + 0.4e1 * t913 * t354 - 0.4e1 * t506 * t1961 * t1112 + t1332 - 0.4e1 * t147 * t1956 * t148 - 0.2e1 * t147 * t339 * t423 * t1970 + 0.4e1 * t522 * t1961 * t1125 - t152 * t749 * t2024 / 0.24e2 + t1637;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[0] = t2028 * t4;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[4] = 0.0e0;

  t2029 = t363 * t363;
  t2030 = t2029 * t539;
  t2035 = t2029 * t550;
  t2037 = t407 * t2035 * t553;
  t2044 = 0.2e1 * t566 * t363 * t568 - 0.2e1 * t372 * t217;
  t2055 = t128 * t2029;
  t2059 = t462 * t2029;
  t2060 = t2059 * t604;
  t2068 = t2059 * t550;
  t2098 = t383 * t383;
  t2102 = -t1349 + 0.4e1 / 0.3e1 * t97 * t2030 * t185 * t195 - 0.2e1 / 0.3e1 * t2037 * t1172 + 0.2e1 / 0.3e1 * t366 * t565 * t544 * t2044 - 0.4e1 / 0.3e1 * t2037 * t1177 - 0.4e1 / 0.3e1 * t366 * t971 + 0.8e1 / 0.3e1 * t2037 * t1182 - 0.2e1 * t3 * t75 * (t1378 - 0.2e1 * t2055 * t597 * t201 - t2060 * t1194 / 0.3e1 - t370 * t564 * t79 * t2044 + 0.2e1 * t2060 * t1198 + 0.2e1 / 0.3e1 * t2068 * t1204 - t1397 + t2055 * t539 * t206 + t370 * t564 * t76 * t2044 / 0.2e1 - t2068 * t1215) * t82 + 0.4e1 * t1002 * t380 - 0.4e1 * t646 * t2035 * t1224 + t1417 - 0.4e1 * t216 * t2030 * t217 - 0.2e1 * t216 * t365 * t564 * t2044 + 0.4e1 * t662 * t2035 * t1237 - t152 * t842 * t2098 / 0.24e2 + t1715;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhotau2[5] = t2102 * t54;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif


}

