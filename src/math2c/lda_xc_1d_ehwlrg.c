/* 
  This file was generated automatically with scripts/math2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Mathematica source: ./mathematica/functionals/lda_xc_1d_ehwlrg.m
  Type of functional: work_lda
*/

void XC(math2c_lda_xc_1d_ehwlrg_func)
  (const XC(func_type) *p, XC(lda_work_t) *r)
{
  lda_xc_1d_ehwlrg_params *params;
 
  assert(p->params != NULL);
  params = (lda_xc_1d_ehwlrg_params * )(p->params);


  if(p->nspin == XC_UNPOLARIZED){

    if(r->order >= 0){
      r->zk = POW(2,-2 - params->alpha)*POW(1/r->rs[1],2 + params->alpha)*(params->a3 + 2*r->rs[1]*(params->a2 + 2*params->a1*r->rs[1]));
    }


    if(r->order >= 1){
      r->dedz = 0.0;
      r->dedrs = -(POW(2,-2 - params->alpha)*POW(1/r->rs[1],3 + params->alpha)*(params->a3*(2 + params->alpha) + 2*r->rs[1]*(params->a2 + params->a2*params->alpha + 2*params->a1*params->alpha*r->rs[1])));
    }


    if(r->order >= 2){
      r->d2edz2 = 0.0;
      r->d2edrsz = 0.0;
      r->d2edrs2 = POW(2,-2 - params->alpha)*POW(1/r->rs[1],4 + params->alpha)*(params->a3*(6 + 5*params->alpha + POW(params->alpha,2)) + 2*(1 + params->alpha)*r->rs[1]*(params->a2*(2 + params->alpha) + 2*params->a1*params->alpha*r->rs[1]));
    }


    if(r->order >= 3){
      r->d3edz3 = 0.0;
      r->d3edrs2z = 0.0;
      r->d3edrsz2 = 0.0;
      r->d3edrs3 = -(POW(2,-2 - params->alpha)*(2 + params->alpha)*POW(1/r->rs[1],5 + params->alpha)*(params->a3*(12 + 7*params->alpha + POW(params->alpha,2)) + 2*(1 + params->alpha)*r->rs[1]*(params->a2*(3 + params->alpha) + 2*params->a1*params->alpha*r->rs[1])));
    }

  }else{

    if(r->order >= 0){
      r->zk = POW(2,-2 - params->alpha)*POW(1/r->rs[1],2 + params->alpha)*(params->a3 + 2*r->rs[1]*(params->a2 + 2*params->a1*r->rs[1]));
    }


    if(r->order >= 1){
      r->dedz = 0;
      r->dedrs = -(POW(2,-2 - params->alpha)*POW(1/r->rs[1],3 + params->alpha)*(params->a3*(2 + params->alpha) + 2*r->rs[1]*(params->a2 + params->a2*params->alpha + 2*params->a1*params->alpha*r->rs[1])));
    }


    if(r->order >= 2){
      r->d2edz2 = 0;
      r->d2edrsz = 0;
      r->d2edrs2 = POW(2,-2 - params->alpha)*POW(1/r->rs[1],4 + params->alpha)*(params->a3*(6 + 5*params->alpha + POW(params->alpha,2)) + 2*(1 + params->alpha)*r->rs[1]*(params->a2*(2 + params->alpha) + 2*params->a1*params->alpha*r->rs[1]));
    }


    if(r->order >= 3){
      r->d3edz3 = 0;
      r->d3edrs2z = 0;
      r->d3edrsz2 = 0;
      r->d3edrs3 = -(POW(2,-2 - params->alpha)*(2 + params->alpha)*POW(1/r->rs[1],5 + params->alpha)*(params->a3*(12 + 7*params->alpha + POW(params->alpha,2)) + 2*(1 + params->alpha)*r->rs[1]*(params->a2*(3 + params->alpha) + 2*params->a1*params->alpha*r->rs[1])));
    }

  }
}


#define math2c_order 3
#define math2c_func  XC(math2c_lda_xc_1d_ehwlrg_func)

