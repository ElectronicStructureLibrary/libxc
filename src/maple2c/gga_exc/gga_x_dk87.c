/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_dk87.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t2, t3, t4, t6, t8, t9, t10, t11;
  double t12, t13, t14, t15, t16, t17, t18, t20;
  double t21, t23, t24, t25, t26, t27, t28, t29;
  double t30, t32, t33, t38, t39, t40, t42, t43;
  double t45, t46, t47, t51, t55;

#ifndef XC_DONT_COMPILE_VXC
  double t57, t61, t63, t65, t69, t70, t72, t73;
  double t76, t80, t81, t82, t83, t85, t87, t88;
  double t90, t94, t99, t102, t106, t107, t108, t113;
  double t115, t120, t124;

#ifndef XC_DONT_COMPILE_FXC
  double t129, t137, t139, t143, t147, t149, t154, t156;
  double t160, t162, t163, t164, t165, t166, t167, t170;
  double t171, t172, t173, t174, t177, t179, t180, t184;
  double t189, t199, t203, t205, t209, t210, t214, t216;
  double t218, t220, t224, t225, t230, t235, t238, t239;
  double t240, t248, t257, t262, t266;

#ifndef XC_DONT_COMPILE_KXC
  double t269, t280, t282, t286, t291, t299, t300, t304;
  double t305, t310, t312, t316, t322, t323, t327, t328;
  double t330, t333, t334, t335, t336, t337, t341, t346;
  double t360, t372, t377, t378, t382, t383, t388, t393;
  double t394, t395, t396, t400, t402, t408, t413, t425;
  double t433, t435, t439, t447, t448, t449, t454, t460;
  double t465, t468, t469, t470, t475, t476, t477, t485;
  double t489, t490, t495, t496, t501, t507, t511;

#ifndef XC_DONT_COMPILE_LXC
  double t527, t529, t536, t544, t546, t551, t558, t563;
  double t564, t570, t572, t594, t601, t612, t616, t621;
  double t637, t644, t658, t669, t685, t686, t708, t713;
  double t781, t786, t848, t853, t857, t909, t913;
#endif

#endif

#endif

#endif

#endif


  gga_x_dk87_params *params;

  assert(p->params != NULL);
  params = (gga_x_dk87_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = my_piecewise3(0.1e1 <= p->zeta_threshold, 0, 1);
  t9 = POW_1_3(rho[0]);
  t10 = t8 * t9;
  t11 = 0.1e1 / M_PI;
  t12 = M_CBRT6;
  t13 = t12 * t12;
  t14 = t11 * t13;
  t15 = M_PI * M_PI;
  t16 = POW_1_3(t15);
  t17 = 0.1e1 / t16;
  t18 = t3 * t3;
  t20 = POW_1_3(t11);
  t21 = 0.1e1 / t20;
  t23 = t14 * t17 * t18 * t21;
  t24 = M_CBRT4;
  t25 = t24 * sigma[0];
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = t25 * t27;
  t29 = rho[0] * rho[0];
  t30 = t9 * t9;
  t32 = 0.1e1 / t30 / t29;
  t33 = sqrt(sigma[0]);
  t38 = pow(t33 * t26 / t9 / rho[0], params->alpha);
  t39 = params->a1 * t38;
  t40 = 0.1e1 + t39;
  t42 = params->b1 * sigma[0];
  t43 = t27 * t32;
  t45 = t42 * t43 + 0.1e1;
  t46 = 0.1e1 / t45;
  t47 = t32 * t40 * t46;
  t51 = 0.1e1 + 0.7e1 / 0.11664e5 * t23 * t28 * t47;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t51);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t55;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t57 = t8 / t30;
  t61 = t29 * rho[0];
  t63 = 0.1e1 / t30 / t61;
  t65 = t63 * t40 * t46;
  t69 = t14 * t17;
  t70 = t18 * t21;
  t72 = t69 * t70 * t24;
  t73 = sigma[0] * t27;
  t76 = t39 * params->alpha * t46;
  t80 = sigma[0] * sigma[0];
  t81 = t80 * t26;
  t82 = t29 * t29;
  t83 = t82 * t29;
  t85 = 0.1e1 / t9 / t83;
  t87 = t45 * t45;
  t88 = 0.1e1 / t87;
  t90 = t40 * t88 * params->b1;
  t94 = -0.7e1 / 0.4374e4 * t23 * t28 * t65 - 0.7e1 / 0.8748e4 * t72 * t73 * t63 * t76 + 0.7e1 / 0.2187e4 * t72 * t81 * t85 * t90;
  t99 = my_piecewise3(t2, 0, -t6 * t57 * t51 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t94);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t99 + 0.2e1 * t55;

  t102 = t24 * t27;
  t106 = t43 * params->a1;
  t107 = t38 * params->alpha;
  t108 = t107 * t46;
  t113 = t82 * rho[0];
  t115 = 0.1e1 / t9 / t113;
  t120 = 0.7e1 / 0.11664e5 * t23 * t102 * t47 + 0.7e1 / 0.23328e5 * t72 * t106 * t108 - 0.7e1 / 0.5832e4 * t72 * sigma[0] * t26 * t115 * t90;
  t124 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t120);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t124;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t129 = t8 / t30 / rho[0];
  t137 = 0.1e1 / t30 / t82;
  t139 = t137 * t40 * t46;
  t143 = t73 * t137;
  t147 = t82 * t61;
  t149 = 0.1e1 / t9 / t147;
  t154 = params->alpha * params->alpha;
  t156 = t39 * t154 * t46;
  t160 = t24 * t80;
  t162 = t69 * t70 * t160;
  t163 = t26 * t149;
  t164 = t163 * params->a1;
  t165 = t88 * params->b1;
  t166 = t107 * t165;
  t167 = t164 * t166;
  t170 = t80 * sigma[0];
  t171 = t24 * t170;
  t172 = t82 * t82;
  t173 = t172 * t29;
  t174 = 0.1e1 / t173;
  t177 = 0.1e1 / t87 / t45;
  t179 = params->b1 * params->b1;
  t180 = t40 * t177 * t179;
  t184 = 0.77e2 / 0.13122e5 * t23 * t28 * t139 + 0.133e3 / 0.26244e5 * t72 * t143 * t76 - 0.7e1 / 0.243e3 * t72 * t81 * t149 * t90 + 0.7e1 / 0.6561e4 * t72 * t143 * t156 - 0.56e2 / 0.6561e4 * t162 * t167 + 0.224e3 / 0.6561e4 * t23 * t171 * t174 * t180;
  t189 = my_piecewise3(t2, 0, t6 * t129 * t51 / 0.12e2 - t6 * t57 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * t184);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t189 + 0.4e1 * t99;

  t199 = t27 * t63 * params->a1;
  t203 = t26 * t85;
  t205 = t165 * sigma[0];
  t209 = t38 * t154;
  t210 = t209 * t46;
  t214 = t24 * t26;
  t216 = t69 * t70 * t214;
  t218 = t85 * params->a1 * t38;
  t220 = params->alpha * t88 * t42;
  t224 = t172 * rho[0];
  t225 = 0.1e1 / t224;
  t230 = -0.7e1 / 0.4374e4 * t23 * t102 * t65 - 0.7e1 / 0.4374e4 * t72 * t199 * t108 + 0.7e1 / 0.729e3 * t72 * t203 * t40 * t205 - 0.7e1 / 0.17496e5 * t72 * t199 * t210 + 0.7e1 / 0.2187e4 * t216 * t218 * t220 - 0.28e2 / 0.2187e4 * t23 * t160 * t225 * t180;
  t235 = my_piecewise3(t2, 0, -t6 * t57 * t120 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t230);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t235 + 0.2e1 * t124;

  t238 = 0.1e1 / sigma[0];
  t239 = t238 * t46;
  t240 = t107 * t239;
  t248 = t209 * t239;
  t257 = 0.1e1 / t172;
  t262 = 0.7e1 / 0.23328e5 * t72 * t106 * t240 - 0.7e1 / 0.2916e4 * t23 * t214 * t115 * t90 + 0.7e1 / 0.46656e5 * t72 * t106 * t248 - 0.7e1 / 0.5832e4 * t72 * t26 * t115 * params->a1 * t166 + 0.7e1 / 0.1458e4 * t23 * t25 * t257 * t180;
  t266 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t262);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t266;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t269 = t8 * t32;
  t280 = 0.1e1 / t30 / t113;
  t282 = t280 * t40 * t46;
  t286 = t73 * t280;
  t291 = 0.1e1 / t9 / t172;
  t299 = t26 * t291;
  t300 = t299 * params->a1;
  t304 = t172 * t61;
  t305 = 0.1e1 / t304;
  t310 = t154 * params->alpha;
  t312 = t39 * t310 * t46;
  t316 = t209 * t165;
  t322 = t177 * t179;
  t323 = t107 * t322;
  t327 = t80 * t80;
  t328 = t172 * t113;
  t330 = 0.1e1 / t30 / t328;
  t333 = t87 * t87;
  t334 = 0.1e1 / t333;
  t335 = t179 * params->b1;
  t336 = t334 * t335;
  t337 = t336 * t27;
  t341 = -0.539e3 / 0.19683e5 * t23 * t28 * t282 - 0.413e3 / 0.13122e5 * t72 * t286 * t76 + 0.4774e4 / 0.19683e5 * t72 * t81 * t291 * t90 - 0.77e2 / 0.6561e4 * t72 * t286 * t156 + 0.280e3 / 0.2187e4 * t162 * t300 * t166 - 0.4256e4 / 0.6561e4 * t23 * t171 * t305 * t180 - 0.28e2 / 0.19683e5 * t72 * t286 * t312 + 0.112e3 / 0.6561e4 * t162 * t300 * t316 - 0.896e3 / 0.6561e4 * t72 * t170 * t305 * params->a1 * t323 + 0.1792e4 / 0.6561e4 * t72 * t327 * t330 * t40 * t337;
  t346 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t269 * t51 + t6 * t129 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t57 * t184 - 0.3e1 / 0.8e1 * t6 * t10 * t341);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t346 + 0.6e1 * t189;

  t360 = t27 * t137 * params->a1;
  t372 = t149 * params->a1 * t38;
  t377 = t24 * t174 * t40;
  t378 = t322 * t80;
  t382 = t38 * t310;
  t383 = t382 * t46;
  t388 = t154 * t88 * t42;
  t393 = t174 * params->a1 * t38;
  t394 = params->alpha * t177;
  t395 = t179 * t80;
  t396 = t394 * t395;
  t400 = t172 * t82;
  t402 = 0.1e1 / t30 / t400;
  t408 = 0.77e2 / 0.13122e5 * t23 * t102 * t139 + 0.35e2 / 0.4374e4 * t72 * t360 * t108 - 0.455e3 / 0.6561e4 * t72 * t163 * t40 * t205 + 0.7e1 / 0.1944e4 * t72 * t360 * t210 - 0.91e2 / 0.2187e4 * t216 * t372 * t220 + 0.476e3 / 0.2187e4 * t23 * t377 * t378 + 0.7e1 / 0.13122e5 * t72 * t360 * t383 - 0.14e2 / 0.2187e4 * t216 * t372 * t388 + 0.112e3 / 0.2187e4 * t72 * t393 * t396 - 0.224e3 / 0.2187e4 * t72 * t170 * t402 * t40 * t337;
  t413 = my_piecewise3(t2, 0, t6 * t129 * t120 / 0.12e2 - t6 * t57 * t230 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * t408);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t413 + 0.4e1 * t235;

  t425 = t203 * params->a1;
  t433 = t24 * t225;
  t435 = t322 * sigma[0];
  t439 = t382 * t239;
  t447 = t225 * params->a1 * t38;
  t448 = t179 * sigma[0];
  t449 = t394 * t448;
  t454 = 0.1e1 / t30 / t304;
  t460 = -0.7e1 / 0.8748e4 * t72 * t199 * t240 - 0.7e1 / 0.8748e4 * t72 * t199 * t248 + 0.49e2 / 0.4374e4 * t72 * t425 * t166 + 0.28e2 / 0.2187e4 * t23 * t214 * t85 * t90 - 0.140e3 / 0.2187e4 * t23 * t433 * t40 * t435 - 0.7e1 / 0.34992e5 * t72 * t199 * t439 + 0.7e1 / 0.2916e4 * t72 * t425 * t316 - 0.14e2 / 0.729e3 * t72 * t447 * t449 + 0.28e2 / 0.729e3 * t72 * t80 * t454 * t40 * t337;
  t465 = my_piecewise3(t2, 0, -t6 * t57 * t262 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t460);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t465 + 0.2e1 * t266;

  t468 = 0.1e1 / t80;
  t469 = t468 * t46;
  t470 = t107 * t469;
  t475 = t115 * params->a1 * t38;
  t476 = params->alpha * t238;
  t477 = t476 * t165;
  t485 = t382 * t469;
  t489 = t154 * t238;
  t490 = t489 * t165;
  t495 = t257 * params->a1 * t38;
  t496 = t394 * t179;
  t501 = 0.1e1 / t30 / t173;
  t507 = -0.7e1 / 0.23328e5 * t72 * t106 * t470 - 0.7e1 / 0.3888e4 * t216 * t475 * t477 + 0.7e1 / 0.486e3 * t23 * t24 * t257 * t180 + 0.7e1 / 0.93312e5 * t72 * t106 * t485 - 0.7e1 / 0.7776e4 * t216 * t475 * t490 + 0.7e1 / 0.972e3 * t72 * t495 * t496 - 0.7e1 / 0.486e3 * t72 * sigma[0] * t501 * t40 * t337;
  t511 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t507);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t511;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t527 = t172 * t83;
  t529 = 0.1e1 / t30 / t527;
  t536 = t172 * t172;
  t544 = t179 * t179;
  t546 = 0.1e1 / t333 / t45 * t544 * t26;
  t551 = 0.1e1 / t30 / t83;
  t558 = 0.1e1 / t9 / t224;
  t563 = t73 * t551;
  t564 = t154 * t154;
  t570 = 0.1e1 / t400;
  t572 = t170 * t570 * params->a1;
  t594 = t26 * t558 * params->a1;
  t601 = t382 * t165;
  t612 = params->alpha * t334 * t335 * t27;
  t616 = -0.175616e6 / 0.19683e5 * t72 * t327 * t529 * t40 * t337 + 0.114688e6 / 0.19683e5 * t72 * t327 * sigma[0] / t9 / t536 / rho[0] * t40 * t546 + 0.9163e4 / 0.59049e5 * t23 * t28 * t551 * t40 * t46 - 0.42658e5 / 0.19683e5 * t72 * t81 * t558 * t90 + 0.112e3 / 0.59049e5 * t72 * t563 * t39 * t564 * t46 + 0.7168e4 / 0.19683e5 * t72 * t572 * t209 * t322 + 0.1400e4 / 0.59049e5 * t72 * t563 * t312 + 0.73472e5 / 0.19683e5 * t72 * t572 * t323 + 0.25375e5 / 0.118098e6 * t72 * t563 * t76 + 0.2135e4 / 0.19683e5 * t72 * t563 * t156 + 0.574112e6 / 0.59049e5 * t23 * t171 * t570 * t180 - 0.92008e5 / 0.59049e5 * t162 * t594 * t166 - 0.2464e4 / 0.6561e4 * t162 * t594 * t316 - 0.1792e4 / 0.59049e5 * t162 * t594 * t601 - 0.28672e5 / 0.19683e5 * t69 * t70 * t24 * t327 * t529 * params->a1 * t38 * t612;
  t621 = my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t8 * t63 * t51 - 0.5e1 / 0.9e1 * t6 * t269 * t94 + t6 * t129 * t184 / 0.2e1 - t6 * t57 * t341 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t10 * t616);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t621 + 0.8e1 * t346;

  t637 = t39 * params->alpha;
  t644 = t291 * params->a1 * t38;
  t658 = t27 * t280 * params->a1;
  t669 = t38 * t564;
  t685 = t305 * params->a1 * t38;
  t686 = t154 * t177;
  t708 = 0.3584e4 / 0.6561e4 * t69 * t70 * t24 * t330 * t637 * t336 * t170 * t27 + 0.224e3 / 0.19683e5 * t216 * t644 * t310 * t88 * t42 - 0.14336e5 / 0.6561e4 * t72 * t327 / t9 / t536 * t40 * t546 - 0.287e3 / 0.39366e5 * t72 * t658 * t383 + 0.19936e5 / 0.6561e4 * t72 * t330 * t40 * t334 * t335 * t170 * t27 - 0.14e2 / 0.19683e5 * t72 * t658 * t669 * t46 - 0.889e3 / 0.19683e5 * t72 * t658 * t108 + 0.3542e4 / 0.6561e4 * t72 * t299 * t40 * t205 - 0.721e3 / 0.26244e5 * t72 * t658 * t210 - 0.896e3 / 0.6561e4 * t72 * t685 * t686 * t395 - 0.8176e4 / 0.6561e4 * t72 * t685 * t396 - 0.539e3 / 0.19683e5 * t23 * t102 * t282 - 0.57400e5 / 0.19683e5 * t23 * t24 * t305 * t40 * t378 + 0.8666e4 / 0.19683e5 * t216 * t644 * t220 + 0.266e3 / 0.2187e4 * t216 * t644 * t388;
  t713 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t269 * t120 + t6 * t129 * t230 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t57 * t408 - 0.3e1 / 0.8e1 * t6 * t10 * t708);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t713 + 0.6e1 * t413;

  t781 = 0.112e3 / 0.2187e4 * t72 * t393 * t686 * t448 + 0.7e1 / 0.26244e5 * t72 * t360 * t669 * t239 - 0.28e2 / 0.6561e4 * t72 * t164 * t601 - 0.448e3 / 0.2187e4 * t69 * t70 * t24 * t402 * t637 * t336 * t80 * t27 + 0.77e2 / 0.26244e5 * t72 * t360 * t240 - 0.700e3 / 0.729e3 * t72 * t402 * t40 * t334 * t335 * t80 * t27 + 0.1792e4 / 0.2187e4 * t72 * t170 / t9 / t172 / t147 * t40 * t546 - 0.532e3 / 0.6561e4 * t23 * t214 * t149 * t90 + 0.35e2 / 0.8748e4 * t72 * t360 * t248 - 0.1211e4 / 0.13122e5 * t72 * t167 + 0.7e1 / 0.3888e4 * t72 * t360 * t439 - 0.301e3 / 0.8748e4 * t72 * t164 * t316 + 0.826e3 / 0.2187e4 * t72 * t393 * t449 + 0.4676e4 / 0.6561e4 * t23 * t377 * t435;
  t786 = my_piecewise3(t2, 0, t6 * t129 * t262 / 0.12e2 - t6 * t57 * t460 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t10 * t781);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t786 + 0.4e1 * t465;

  t848 = 0.7e1 / 0.8748e4 * t72 * t199 * t470 + 0.7e1 / 0.17496e5 * t72 * t199 * t209 * t469 + 0.35e2 / 0.4374e4 * t216 * t218 * t477 + 0.7e1 / 0.972e3 * t216 * t218 * t490 - 0.70e2 / 0.729e3 * t72 * t447 * t496 - 0.28e2 / 0.243e3 * t23 * t433 * t180 + 0.196e3 / 0.729e3 * t72 * t454 * t40 * t334 * t335 * sigma[0] * t27 - 0.7e1 / 0.34992e5 * t72 * t199 * t485 - 0.7e1 / 0.69984e5 * t72 * t199 * t669 * t469 + 0.7e1 / 0.4374e4 * t216 * t218 * t310 * t238 * t165 - 0.14e2 / 0.729e3 * t72 * t447 * t686 * t179 + 0.56e2 / 0.729e3 * t69 * t70 * t24 * t454 * t637 * t336 * t73 - 0.224e3 / 0.729e3 * t72 * t80 / t9 / t527 * t40 * t546;
  t853 = my_piecewise3(t2, 0, -t6 * t57 * t507 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t10 * t848);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t853 + 0.2e1 * t511;

  t857 = 0.1e1 / t170 * t46;
  t909 = -0.7e1 / 0.46656e5 * t72 * t106 * t209 * t857 + 0.7e1 / 0.11664e5 * t72 * t106 * t107 * t857 + 0.7e1 / 0.2916e4 * t216 * t475 * params->alpha * t468 * t165 + 0.7e1 / 0.486e3 * t72 * t495 * t476 * t322 - 0.14e2 / 0.243e3 * t23 * t24 * t501 * t40 * t337 + 0.7e1 / 0.186624e6 * t72 * t106 * t669 * t857 - 0.7e1 / 0.46656e5 * t72 * t106 * t382 * t857 - 0.7e1 / 0.11664e5 * t216 * t475 * t310 * t468 * t165 + 0.7e1 / 0.972e3 * t72 * t495 * t489 * t322 - 0.7e1 / 0.243e3 * t72 * t501 * params->a1 * t38 * t612 + 0.28e2 / 0.243e3 * t72 * sigma[0] / t9 / t328 * t40 * t546;
  t913 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t909);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t913;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t32, t33, t34, t35, t36, t37, t39;
  double t40, t44, t46, t48, t50, t51, t52, t56;
  double t60, t61, t62, t64, t65, t66, t70, t71;
  double t72, t73, t74, t75, t77, t78, t82, t84;
  double t86, t88, t89, t90, t94, t98;

#ifndef XC_DONT_COMPILE_VXC
  double t99, t102, t103, t106, t107, t108, t109, t111;
  double t116, t117, t121, t122, t123, t126, t127, t129;
  double t131, t138, t141, t142, t146, t147, t148, t149;
  double t151, t153, t154, t156, t160, t165, t168, t169;
  double t170, t171, t172, t173, t174, t178, t179, t183;
  double t186, t188, t191, t192, t196, t197, t202, t205;
  double t207, t212, t213, t217, t219, t221, t227, t228;
  double t232, t233, t234, t235, t237, t239, t240, t242;
  double t246, t251, t254, t255, t264, t266, t271, t275;
  double t284, t286, t291, t295;

#ifndef XC_DONT_COMPILE_FXC
  double t298, t299, t301, t306, t307, t309, t312, t313;
  double t314, t320, t325, t326, t330, t332, t338, t339;
  double t342, t344, t347, t349, t354, t358, t360, t365;
  double t366, t367, t373, t374, t378, t379, t380, t381;
  double t382, t385, t387, t388, t392, t397, t400, t401;
  double t402, t403, t404, t406, t408, t410, t411, t415;
  double t416, t420, t422, t424, t427, t429, t436, t437;
  double t439, t440, t444, t445, t449, t451, t459, t460;
  double t462, t463, t467, t469, t471, t475, t477, t482;
  double t483, t487, t489, t496, t499, t505, t506, t510;
  double t511, t517, t519, t523, t524, t529, t534, t535;
  double t545, t547, t552, t556, t558, t563, t564, t570;
  double t571, t575, t576, t577, t578, t579, t582, t584;
  double t588, t593, t601, t606, t610, t612, t620, t621;
  double t622, t626, t627, t632, t637, t644, t646, t652;
  double t661, t665, t667, t675, t676, t677, t681, t682;
  double t687, t692, t695, t696, t697, t698, t706, t707;
  double t712, t713, t717, t722, t726, t728, t729, t730;
  double t731, t739, t740, t745, t746, t750, t755, t759;

#ifndef XC_DONT_COMPILE_KXC
  double t762, t764, t766, t769, t774, t776, t780, t783;
  double t787, t789, t793, t794, t795, t800, t804, t805;
  double t806, t810, t812, t817, t819, t822, t828, t829;
  double t832, t834, t837, t840, t842, t847, t852, t861;
  double t865, t866, t871, t872, t873, t877, t883, t884;
  double t888, t889, t890, t892, t894, t895, t897, t898;
  double t902, t907, t910, t912, t915, t917, t919, t921;
  double t924, t929, t930, t934, t936, t938, t940, t942;
  double t945, t947, t950, t951, t959, t963, t964, t966;
  double t967, t968, t971, t974, t977, t978, t979, t983;
  double t986, t990, t992, t996, t1005, t1006, t1007, t1009;
  double t1010, t1012, t1013, t1019, t1021, t1023, t1027, t1028;
  double t1036, t1037, t1038, t1042, t1043, t1044, t1048, t1051;
  double t1052, t1054, t1063, t1065, t1068, t1078, t1079, t1081;
  double t1082, t1086, t1087, t1091, t1093, t1102, t1105, t1107;
  double t1108, t1111, t1119, t1125, t1126, t1130, t1136, t1140;
  double t1141, t1142, t1146, t1148, t1155, t1163, t1165, t1166;
  double t1173, t1174, t1178, t1179, t1186, t1189, t1192, t1199;
  double t1203, t1207, t1211, t1212, t1213, t1229, t1231, t1236;
  double t1241, t1250, t1254, t1255, t1260, t1261, t1265, t1271;
  double t1272, t1276, t1277, t1278, t1280, t1282, t1283, t1285;
  double t1289, t1294, t1302, t1309, t1311, t1317, t1321, t1330;
  double t1335, t1336, t1343, t1344, t1349, t1350, t1351, t1352;
  double t1356, t1358, t1363, t1368, t1375, t1379, t1381, t1387;
  double t1395, t1401, t1408, t1411, t1419, t1434, t1438, t1447;
  double t1452, t1453, t1460, t1461, t1466, t1467, t1468, t1469;
  double t1473, t1475, t1480, t1485, t1492, t1494, t1507, t1509;
  double t1513, t1514, t1518, t1523, t1524, t1525, t1530, t1535;
  double t1540, t1547, t1549, t1555, t1561, t1574, t1576, t1580;
  double t1581, t1585, t1590, t1591, t1592, t1597, t1602, t1607;
  double t1609, t1610, t1611, t1615, t1623, t1624, t1628, t1633;
  double t1634, t1639, t1644, t1648, t1649, t1650, t1651, t1655;
  double t1663, t1664, t1668, t1673, t1674, t1679, t1684, t1688;

#ifndef XC_DONT_COMPILE_LXC
  double t1692, t1696, t1699, t1703, t1707, t1713, t1716, t1719;
  double t1722, t1724, t1729, t1731, t1736, t1738, t1741, t1759;
  double t1767, t1768, t1773, t1775, t1779, t1781, t1806, t1811;
  double t1815, t1818, t1822, t1824, t1832, t1839, t1848, t1850;
  double t1853, t1856, t1864, t1866, t1868, t1873, t1874, t1883;
  double t1889, t1891, t1893, t1894, t1897, t1899, t1902, t1904;
  double t1905, t1907, t1911, t1914, t1919, t1926, t1930, t1934;
  double t1939, t1941, t1948, t1952, t1953, t1956, t1965, t1979;
  double t1981, t1986, t1989, t1991, t1993, t2005, t2009, t2011;
  double t2020, t2026, t2027, t2029, t2040, t2041, t2043, t2044;
  double t2046, t2049, t2053, t2056, t2069, t2070, t2076, t2081;
  double t2083, t2086, t2092, t2093, t2100, t2104, t2105, t2108;
  double t2117, t2120, t2121, t2123, t2125, t2126, t2135, t2140;
  double t2144, t2165, t2166, t2175, t2182, t2186, t2199, t2200;
  double t2207, t2210, t2223, t2225, t2229, t2235, t2238, t2240;
  double t2245, t2248, t2254, t2255, t2257, t2264, t2266, t2275;
  double t2277, t2284, t2288, t2297, t2300, t2311, t2314, t2316;
  double t2317, t2333, t2339, t2340, t2347, t2358, t2359, t2363;
  double t2384, t2388, t2396, t2411, t2416, t2418, t2425, t2427;
  double t2434, t2442, t2451, t2461, t2463, t2464, t2477, t2486;
  double t2497, t2499, t2504, t2506, t2511, t2513, t2516, t2532;
  double t2540, t2545, t2564, t2566, t2579, t2597, t2604, t2621;
  double t2622, t2635, t2636, t2644, t2650, t2653, t2660, t2662;
  double t2665, t2669, t2676, t2677, t2683, t2684, t2699, t2737;
  double t2742, t2749, t2752, t2756, t2758, t2760, t2766, t2771;
  double t2775, t2784, t2785, t2787, t2793, t2795, t2804, t2806;
  double t2809, t2815, t2824, t2830, t2837, t2845, t2847, t2848;
  double t2857, t2876, t2883, t2884, t2890, t2891, t2906, t2944;
  double t2949, t2956, t2963, t2965, t2968, t3026, t3031, t3038;
  double t3042, t3044, t3050, t3058, t3064, t3071, t3074, t3082;
  double t3094, t3152, t3157, t3164, t3220, t3225, t3232, t3234;
  double t3240, t3300, t3305, t3307, t3360, t3364, t3365, t3418;
  double t3422;
#endif

#endif

#endif

#endif

#endif


  gga_x_dk87_params *params;

  assert(p->params != NULL);
  params = (gga_x_dk87_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = M_CBRT2;
  t12 = t11 * rho[0];
  t13 = POW_1_3(t8);
  t17 = my_piecewise3(t10, 0, 0.2e1 * t12 * t7 * t13);
  t18 = POW_1_3(t6);
  t19 = t17 * t18;
  t20 = 0.1e1 / M_PI;
  t21 = M_CBRT6;
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = 0.1e1 / t25;
  t27 = t2 * t2;
  t28 = t26 * t27;
  t29 = POW_1_3(t20);
  t30 = 0.1e1 / t29;
  t32 = t23 * t28 * t30;
  t33 = M_CBRT4;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sqrt(sigma[0]);
  t44 = pow(t40 / t36 / rho[0], params->alpha);
  t46 = params->a1 * t44 + 0.1e1;
  t48 = params->b1 * sigma[0];
  t50 = t48 * t39 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t39 * t46 * t51;
  t56 = 0.1e1 + 0.7e1 / 0.11664e5 * t32 * t34 * t52;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = rho[1] * t7;
  t64 = 0.2e1 * t62 <= p->zeta_threshold;
  t65 = t11 * rho[1];
  t66 = POW_1_3(t62);
  t70 = my_piecewise3(t64, 0, 0.2e1 * t65 * t7 * t66);
  t71 = t70 * t18;
  t72 = t33 * sigma[2];
  t73 = rho[1] * rho[1];
  t74 = POW_1_3(rho[1]);
  t75 = t74 * t74;
  t77 = 0.1e1 / t75 / t73;
  t78 = sqrt(sigma[2]);
  t82 = pow(t78 / t74 / rho[1], params->alpha);
  t84 = params->a1 * t82 + 0.1e1;
  t86 = params->b1 * sigma[2];
  t88 = t86 * t77 + 0.1e1;
  t89 = 0.1e1 / t88;
  t90 = t77 * t84 * t89;
  t94 = 0.1e1 + 0.7e1 / 0.11664e5 * t32 * t72 * t90;
  t98 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t71 * t94);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t60 + t98;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t99 = t11 * t7;
  t102 = t6 * t6;
  t103 = 0.1e1 / t102;
  t106 = 0.2e1 * t12 * t103 * t13;
  t107 = t13 * t13;
  t108 = 0.1e1 / t107;
  t109 = t7 * t108;
  t111 = -rho[0] * t103 + t7;
  t116 = my_piecewise3(t10, 0, 0.2e1 * t99 * t13 - t106 + 0.2e1 / 0.3e1 * t12 * t109 * t111);
  t117 = t116 * t18;
  t121 = t18 * t18;
  t122 = 0.1e1 / t121;
  t123 = t17 * t122;
  t126 = t5 * t123 * t56 / 0.8e1;
  t127 = t35 * rho[0];
  t129 = 0.1e1 / t37 / t127;
  t131 = t129 * t46 * t51;
  t138 = t23 * t26 * t27 * t30 * t33;
  t141 = t44 * params->alpha;
  t142 = t141 * t51;
  t146 = sigma[0] * sigma[0];
  t147 = t33 * t146;
  t148 = t35 * t35;
  t149 = t148 * t35;
  t151 = 0.1e1 / t36 / t149;
  t153 = t50 * t50;
  t154 = 0.1e1 / t153;
  t156 = t46 * t154 * params->b1;
  t160 = -0.7e1 / 0.4374e4 * t32 * t34 * t131 - 0.7e1 / 0.8748e4 * t138 * sigma[0] * t129 * params->a1 * t142 + 0.7e1 / 0.4374e4 * t32 * t147 * t151 * t156;
  t165 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t56 - t126 - 0.3e1 / 0.8e1 * t5 * t19 * t160);
  t168 = 0.2e1 * t65 * t103 * t66;
  t169 = t11 * t73;
  t170 = t102 * t6;
  t171 = 0.1e1 / t170;
  t172 = t66 * t66;
  t173 = 0.1e1 / t172;
  t174 = t171 * t173;
  t178 = my_piecewise3(t64, 0, -t168 - 0.2e1 / 0.3e1 * t169 * t174);
  t179 = t178 * t18;
  t183 = t70 * t122;
  t186 = t5 * t183 * t94 / 0.8e1;
  t188 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t179 * t94 - t186);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t60 + t98 + t6 * (t165 + t188);

  t191 = t11 * t35;
  t192 = t171 * t108;
  t196 = my_piecewise3(t10, 0, -t106 - 0.2e1 / 0.3e1 * t191 * t192);
  t197 = t196 * t18;
  t202 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t197 * t56 - t126);
  t205 = t7 * t173;
  t207 = -rho[1] * t103 + t7;
  t212 = my_piecewise3(t64, 0, 0.2e1 * t99 * t66 - t168 + 0.2e1 / 0.3e1 * t65 * t205 * t207);
  t213 = t212 * t18;
  t217 = t73 * rho[1];
  t219 = 0.1e1 / t75 / t217;
  t221 = t219 * t84 * t89;
  t227 = t82 * params->alpha;
  t228 = t227 * t89;
  t232 = sigma[2] * sigma[2];
  t233 = t33 * t232;
  t234 = t73 * t73;
  t235 = t234 * t73;
  t237 = 0.1e1 / t74 / t235;
  t239 = t88 * t88;
  t240 = 0.1e1 / t239;
  t242 = t84 * t240 * params->b1;
  t246 = -0.7e1 / 0.4374e4 * t32 * t72 * t221 - 0.7e1 / 0.8748e4 * t138 * sigma[2] * t219 * params->a1 * t228 + 0.7e1 / 0.4374e4 * t32 * t233 * t237 * t242;
  t251 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t213 * t94 - t186 - 0.3e1 / 0.8e1 * t5 * t71 * t246);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t60 + t98 + t6 * (t202 + t251);

  t254 = t23 * t28;
  t255 = t30 * t33;
  t264 = t148 * rho[0];
  t266 = 0.1e1 / t36 / t264;
  t271 = 0.7e1 / 0.11664e5 * t254 * t255 * t52 + 0.7e1 / 0.23328e5 * t32 * t33 * t39 * params->a1 * t142 - 0.7e1 / 0.11664e5 * t32 * t34 * t266 * t156;
  t275 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t271);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t6 * t275;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t284 = t234 * rho[1];
  t286 = 0.1e1 / t74 / t284;
  t291 = 0.7e1 / 0.11664e5 * t254 * t255 * t90 + 0.7e1 / 0.23328e5 * t32 * t33 * t77 * params->a1 * t228 - 0.7e1 / 0.11664e5 * t32 * t72 * t286 * t242;
  t295 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t71 * t291);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t295;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t298 = t11 * t103;
  t299 = t298 * t13;
  t301 = t108 * t111;
  t306 = 0.4e1 * t12 * t171 * t13;
  t307 = t103 * t108;
  t309 = t12 * t307 * t111;
  t312 = 0.1e1 / t107 / t8;
  t313 = t7 * t312;
  t314 = t111 * t111;
  t320 = 0.2e1 * rho[0] * t171 - 0.2e1 * t103;
  t325 = my_piecewise3(t10, 0, -0.4e1 * t299 + 0.4e1 / 0.3e1 * t99 * t301 + t306 - 0.4e1 / 0.3e1 * t309 - 0.4e1 / 0.9e1 * t12 * t313 * t314 + 0.2e1 / 0.3e1 * t12 * t109 * t320);
  t326 = t325 * t18;
  t330 = t116 * t122;
  t332 = t5 * t330 * t56;
  t338 = 0.1e1 / t121 / t6;
  t339 = t17 * t338;
  t342 = t5 * t339 * t56 / 0.12e2;
  t344 = t5 * t123 * t160;
  t347 = 0.1e1 / t37 / t148;
  t349 = t347 * t46 * t51;
  t354 = sigma[0] * t347 * params->a1;
  t358 = t148 * t127;
  t360 = 0.1e1 / t36 / t358;
  t365 = params->alpha * params->alpha;
  t366 = t44 * t365;
  t367 = t366 * t51;
  t373 = t154 * params->b1;
  t374 = t141 * t373;
  t378 = t146 * sigma[0];
  t379 = t33 * t378;
  t380 = t148 * t148;
  t381 = t380 * t35;
  t382 = 0.1e1 / t381;
  t385 = 0.1e1 / t153 / t50;
  t387 = params->b1 * params->b1;
  t388 = t46 * t385 * t387;
  t392 = 0.77e2 / 0.13122e5 * t32 * t34 * t349 + 0.133e3 / 0.26244e5 * t138 * t354 * t142 - 0.7e1 / 0.486e3 * t32 * t147 * t360 * t156 + 0.7e1 / 0.6561e4 * t138 * t354 * t367 - 0.28e2 / 0.6561e4 * t138 * t146 * t360 * params->a1 * t374 + 0.56e2 / 0.6561e4 * t32 * t379 * t382 * t388;
  t397 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t326 * t56 - t332 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t117 * t160 + t342 - t344 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * t392);
  t400 = 0.4e1 * t65 * t171 * t66;
  t401 = t102 * t102;
  t402 = 0.1e1 / t401;
  t403 = t402 * t173;
  t404 = t169 * t403;
  t406 = t11 * t217;
  t408 = 0.1e1 / t401 / t6;
  t410 = 0.1e1 / t172 / t62;
  t411 = t408 * t410;
  t415 = my_piecewise3(t64, 0, t400 + 0.8e1 / 0.3e1 * t404 - 0.4e1 / 0.9e1 * t406 * t411);
  t416 = t415 * t18;
  t420 = t178 * t122;
  t422 = t5 * t420 * t94;
  t424 = t70 * t338;
  t427 = t5 * t424 * t94 / 0.12e2;
  t429 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t416 * t94 - t422 / 0.4e1 + t427);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t165 + 0.2e1 * t188 + t6 * (t397 + t429);

  t436 = t402 * t108;
  t437 = t191 * t436;
  t439 = t171 * t312;
  t440 = t439 * t111;
  t444 = my_piecewise3(t10, 0, -0.2e1 * t299 + t306 - 0.2e1 / 0.3e1 * t309 - 0.4e1 / 0.3e1 * t12 * t192 + 0.2e1 * t437 + 0.4e1 / 0.9e1 * t191 * t440);
  t445 = t444 * t18;
  t449 = t196 * t122;
  t451 = t5 * t449 * t56;
  t459 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t445 * t56 - t451 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t197 * t160 - t332 / 0.8e1 + t342 - t344 / 0.8e1);
  t460 = t298 * t66;
  t462 = t11 * t171;
  t463 = t173 * rho[1];
  t467 = t103 * t173;
  t469 = t65 * t467 * t207;
  t471 = t171 * t410;
  t475 = rho[1] * t171;
  t477 = -t103 + 0.2e1 * t475;
  t482 = my_piecewise3(t64, 0, -0.2e1 * t460 - 0.2e1 / 0.3e1 * t462 * t463 + t400 + 0.2e1 / 0.3e1 * t404 - 0.2e1 / 0.3e1 * t469 + 0.4e1 / 0.9e1 * t169 * t471 * t207 + 0.2e1 / 0.3e1 * t65 * t205 * t477);
  t483 = t482 * t18;
  t487 = t212 * t122;
  t489 = t5 * t487 * t94;
  t496 = t5 * t183 * t246;
  t499 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t483 * t94 - t489 / 0.8e1 - t422 / 0.8e1 + t427 - 0.3e1 / 0.8e1 * t5 * t179 * t246 - t496 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t165 + t188 + t202 + t251 + t6 * (t459 + t499);

  t505 = t11 * t127;
  t506 = t408 * t312;
  t510 = my_piecewise3(t10, 0, t306 + 0.8e1 / 0.3e1 * t437 - 0.4e1 / 0.9e1 * t505 * t506);
  t511 = t510 * t18;
  t517 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t511 * t56 - t451 / 0.4e1 + t342);
  t519 = t173 * t207;
  t523 = t7 * t410;
  t524 = t207 * t207;
  t529 = -0.2e1 * t103 + 0.2e1 * t475;
  t534 = my_piecewise3(t64, 0, -0.4e1 * t460 + 0.4e1 / 0.3e1 * t99 * t519 + t400 - 0.4e1 / 0.3e1 * t469 - 0.4e1 / 0.9e1 * t65 * t523 * t524 + 0.2e1 / 0.3e1 * t65 * t205 * t529);
  t535 = t534 * t18;
  t545 = 0.1e1 / t75 / t234;
  t547 = t545 * t84 * t89;
  t552 = sigma[2] * t545 * params->a1;
  t556 = t234 * t217;
  t558 = 0.1e1 / t74 / t556;
  t563 = t82 * t365;
  t564 = t563 * t89;
  t570 = t240 * params->b1;
  t571 = t227 * t570;
  t575 = t232 * sigma[2];
  t576 = t33 * t575;
  t577 = t234 * t234;
  t578 = t577 * t73;
  t579 = 0.1e1 / t578;
  t582 = 0.1e1 / t239 / t88;
  t584 = t84 * t582 * t387;
  t588 = 0.77e2 / 0.13122e5 * t32 * t72 * t547 + 0.133e3 / 0.26244e5 * t138 * t552 * t228 - 0.7e1 / 0.486e3 * t32 * t233 * t558 * t242 + 0.7e1 / 0.6561e4 * t138 * t552 * t564 - 0.28e2 / 0.6561e4 * t138 * t232 * t558 * params->a1 * t571 + 0.56e2 / 0.6561e4 * t32 * t576 * t579 * t584;
  t593 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t535 * t94 - t489 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t213 * t246 + t427 - t496 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t71 * t588);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t202 + 0.2e1 * t251 + t6 * (t517 + t593);

  t601 = t5 * t123 * t271 / 0.8e1;
  t606 = t33 * t129 * params->a1;
  t610 = t33 * t151;
  t612 = t373 * sigma[0];
  t620 = t151 * params->a1 * t44;
  t621 = params->alpha * t154;
  t622 = t621 * t48;
  t626 = t380 * rho[0];
  t627 = 0.1e1 / t626;
  t632 = -0.7e1 / 0.4374e4 * t254 * t255 * t131 - 0.7e1 / 0.4374e4 * t32 * t606 * t142 + 0.7e1 / 0.1458e4 * t32 * t610 * t46 * t612 - 0.7e1 / 0.17496e5 * t32 * t606 * t367 + 0.7e1 / 0.4374e4 * t138 * t620 * t622 - 0.7e1 / 0.2187e4 * t32 * t147 * t627 * t388;
  t637 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t271 - t601 - 0.3e1 / 0.8e1 * t5 * t19 * t632);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t6 * t637 + t275;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t644 = t5 * t183 * t291 / 0.8e1;
  t646 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t179 * t291 - t644);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t6 * t646 + t295;

  t652 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t197 * t271 - t601);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t6 * t652 + t275;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t661 = t33 * t219 * params->a1;
  t665 = t33 * t237;
  t667 = t570 * sigma[2];
  t675 = t237 * params->a1 * t82;
  t676 = params->alpha * t240;
  t677 = t676 * t86;
  t681 = t577 * rho[1];
  t682 = 0.1e1 / t681;
  t687 = -0.7e1 / 0.4374e4 * t254 * t255 * t221 - 0.7e1 / 0.4374e4 * t32 * t661 * t228 + 0.7e1 / 0.1458e4 * t32 * t665 * t84 * t667 - 0.7e1 / 0.17496e5 * t32 * t661 * t564 + 0.7e1 / 0.4374e4 * t138 * t675 * t677 - 0.7e1 / 0.2187e4 * t32 * t233 * t682 * t584;
  t692 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t213 * t291 - t644 - 0.3e1 / 0.8e1 * t5 * t71 * t687);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t6 * t692 + t295;

  t695 = t39 * params->a1 * t44;
  t696 = 0.1e1 / sigma[0];
  t697 = params->alpha * t696;
  t698 = t697 * t51;
  t706 = t365 * t696;
  t707 = t706 * t51;
  t712 = t266 * params->a1 * t44;
  t713 = t621 * params->b1;
  t717 = 0.1e1 / t380;
  t722 = 0.7e1 / 0.23328e5 * t138 * t695 * t698 - 0.7e1 / 0.5832e4 * t32 * t33 * t266 * t156 + 0.7e1 / 0.46656e5 * t138 * t695 * t707 - 0.7e1 / 0.11664e5 * t138 * t712 * t713 + 0.7e1 / 0.5832e4 * t32 * t34 * t717 * t388;
  t726 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t722);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t726;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t728 = t77 * params->a1 * t82;
  t729 = 0.1e1 / sigma[2];
  t730 = params->alpha * t729;
  t731 = t730 * t89;
  t739 = t365 * t729;
  t740 = t739 * t89;
  t745 = t286 * params->a1 * t82;
  t746 = t676 * params->b1;
  t750 = 0.1e1 / t577;
  t755 = 0.7e1 / 0.23328e5 * t138 * t728 * t731 - 0.7e1 / 0.5832e4 * t32 * t33 * t286 * t242 + 0.7e1 / 0.46656e5 * t138 * t728 * t740 - 0.7e1 / 0.11664e5 * t138 * t745 * t746 + 0.7e1 / 0.5832e4 * t32 * t72 * t750 * t584;
  t759 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t71 * t755);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t759;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t762 = t462 * t13;
  t764 = t298 * t301;
  t766 = t312 * t314;
  t769 = t108 * t320;
  t774 = 0.12e2 * t12 * t402 * t13;
  t776 = t12 * t192 * t111;
  t780 = t12 * t103 * t312 * t314;
  t783 = t12 * t307 * t320;
  t787 = 0.1e1 / t107 / t35 / t103;
  t789 = t314 * t111;
  t793 = t12 * t7;
  t794 = t312 * t111;
  t795 = t794 * t320;
  t800 = -0.6e1 * rho[0] * t402 + 0.6e1 * t171;
  t804 = 0.12e2 * t762 - 0.4e1 * t764 - 0.4e1 / 0.3e1 * t99 * t766 + 0.2e1 * t99 * t769 - t774 + 0.4e1 * t776 + 0.4e1 / 0.3e1 * t780 - 0.2e1 * t783 + 0.20e2 / 0.27e2 * t12 * t7 * t787 * t789 - 0.4e1 / 0.3e1 * t793 * t795 + 0.2e1 / 0.3e1 * t12 * t109 * t800;
  t805 = my_piecewise3(t10, 0, t804);
  t806 = t805 * t18;
  t810 = t325 * t122;
  t812 = t5 * t810 * t56;
  t817 = t116 * t338;
  t819 = t5 * t817 * t56;
  t822 = t5 * t330 * t160;
  t828 = 0.1e1 / t121 / t102;
  t829 = t17 * t828;
  t832 = 0.5e1 / 0.36e2 * t5 * t829 * t56;
  t834 = t5 * t339 * t160;
  t837 = t5 * t123 * t392;
  t840 = 0.1e1 / t37 / t264;
  t842 = t840 * t46 * t51;
  t847 = sigma[0] * t840 * params->a1;
  t852 = 0.1e1 / t36 / t380;
  t861 = t146 * t852 * params->a1;
  t865 = t380 * t127;
  t866 = 0.1e1 / t865;
  t871 = t365 * params->alpha;
  t872 = t44 * t871;
  t873 = t872 * t51;
  t877 = t366 * t373;
  t883 = t385 * t387;
  t884 = t141 * t883;
  t888 = t146 * t146;
  t889 = t33 * t888;
  t890 = t380 * t264;
  t892 = 0.1e1 / t37 / t890;
  t894 = t153 * t153;
  t895 = 0.1e1 / t894;
  t897 = t387 * params->b1;
  t898 = t46 * t895 * t897;
  t902 = -0.539e3 / 0.19683e5 * t32 * t34 * t842 - 0.413e3 / 0.13122e5 * t138 * t847 * t142 + 0.2387e4 / 0.19683e5 * t32 * t147 * t852 * t156 - 0.77e2 / 0.6561e4 * t138 * t847 * t367 + 0.140e3 / 0.2187e4 * t138 * t861 * t374 - 0.1064e4 / 0.6561e4 * t32 * t379 * t866 * t388 - 0.28e2 / 0.19683e5 * t138 * t847 * t873 + 0.56e2 / 0.6561e4 * t138 * t861 * t877 - 0.224e3 / 0.6561e4 * t138 * t378 * t866 * params->a1 * t884 + 0.448e3 / 0.6561e4 * t32 * t889 * t892 * t898;
  t907 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t806 * t56 - 0.3e1 / 0.8e1 * t812 - 0.9e1 / 0.8e1 * t5 * t326 * t160 + t819 / 0.4e1 - 0.3e1 / 0.4e1 * t822 - 0.9e1 / 0.8e1 * t5 * t117 * t392 - t832 + t834 / 0.4e1 - 0.3e1 / 0.8e1 * t837 - 0.3e1 / 0.8e1 * t5 * t19 * t902);
  t910 = 0.12e2 * t65 * t402 * t66;
  t912 = t169 * t408 * t173;
  t915 = 0.1e1 / t401 / t102;
  t917 = t406 * t915 * t410;
  t919 = t11 * t234;
  t921 = 0.1e1 / t401 / t170;
  t924 = 0.1e1 / t172 / t73 / t103;
  t929 = my_piecewise3(t64, 0, -t910 - 0.12e2 * t912 + 0.4e1 * t917 - 0.20e2 / 0.27e2 * t919 * t921 * t924);
  t930 = t929 * t18;
  t934 = t415 * t122;
  t936 = t5 * t934 * t94;
  t938 = t178 * t338;
  t940 = t5 * t938 * t94;
  t942 = t70 * t828;
  t945 = 0.5e1 / 0.36e2 * t5 * t942 * t94;
  t947 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t930 * t94 - 0.3e1 / 0.8e1 * t936 + t940 / 0.4e1 - t945);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t397 + 0.3e1 * t429 + t6 * (t907 + t947);

  t950 = 0.2e1 * t459;
  t951 = 0.2e1 * t499;
  t959 = t12 * t436;
  t963 = t408 * t108;
  t964 = t191 * t963;
  t966 = t402 * t312;
  t967 = t966 * t111;
  t968 = t191 * t967;
  t971 = t171 * t787 * t314;
  t974 = t439 * t320;
  t977 = 0.8e1 * t762 - 0.4e1 / 0.3e1 * t764 - t774 + 0.8e1 / 0.3e1 * t776 + 0.4e1 / 0.9e1 * t780 - 0.2e1 / 0.3e1 * t783 - 0.4e1 / 0.3e1 * t462 * t108 + 0.8e1 * t959 + 0.16e2 / 0.9e1 * t12 * t440 - 0.8e1 * t964 - 0.8e1 / 0.3e1 * t968 - 0.20e2 / 0.27e2 * t191 * t971 + 0.4e1 / 0.9e1 * t191 * t974;
  t978 = my_piecewise3(t10, 0, t977);
  t979 = t978 * t18;
  t983 = t444 * t122;
  t986 = t5 * t983 * t56 / 0.4e1;
  t990 = t196 * t338;
  t992 = t5 * t990 * t56;
  t996 = t5 * t449 * t160 / 0.4e1;
  t1005 = -0.3e1 / 0.8e1 * t5 * t979 * t56 - t986 - 0.3e1 / 0.4e1 * t5 * t445 * t160 + t992 / 0.12e2 - t996 - 0.3e1 / 0.8e1 * t5 * t197 * t392 - t812 / 0.8e1 + t819 / 0.6e1 - t822 / 0.4e1 - t832 + t834 / 0.6e1 - t837 / 0.8e1;
  t1006 = my_piecewise3(t1, 0, t1005);
  t1007 = t462 * t66;
  t1009 = t11 * t402;
  t1010 = t1009 * t463;
  t1012 = t11 * t408;
  t1013 = t410 * t73;
  t1019 = t65 * t174 * t207;
  t1021 = t402 * t410;
  t1023 = t169 * t1021 * t207;
  t1027 = 0.4e1 / 0.3e1 * t65 * t467 * t477;
  t1028 = t408 * t924;
  t1036 = rho[1] * t402;
  t1037 = 0.6e1 * t1036;
  t1038 = 0.2e1 * t171 - t1037;
  t1042 = 0.4e1 * t1007 + 0.8e1 / 0.3e1 * t1010 - 0.4e1 / 0.9e1 * t1012 * t1013 - t910 - 0.4e1 * t912 + 0.4e1 / 0.9e1 * t917 + 0.4e1 / 0.3e1 * t1019 - 0.16e2 / 0.9e1 * t1023 - t1027 + 0.20e2 / 0.27e2 * t406 * t1028 * t207 + 0.8e1 / 0.9e1 * t169 * t471 * t477 + 0.2e1 / 0.3e1 * t65 * t205 * t1038;
  t1043 = my_piecewise3(t64, 0, t1042);
  t1044 = t1043 * t18;
  t1048 = t482 * t122;
  t1051 = t5 * t1048 * t94 / 0.4e1;
  t1052 = t212 * t338;
  t1054 = t5 * t1052 * t94;
  t1063 = t5 * t420 * t246 / 0.4e1;
  t1065 = t5 * t424 * t246;
  t1068 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1044 * t94 - t1051 + t1054 / 0.12e2 - t936 / 0.8e1 + t940 / 0.6e1 - t945 - 0.3e1 / 0.8e1 * t5 * t416 * t246 - t1063 + t1065 / 0.12e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t397 + t429 + t950 + t951 + t6 * (t1006 + t1068);

  t1078 = t915 * t312;
  t1079 = t505 * t1078;
  t1081 = t408 * t787;
  t1082 = t1081 * t111;
  t1086 = my_piecewise3(t10, 0, 0.4e1 * t762 - t774 + 0.4e1 / 0.3e1 * t776 + 0.16e2 / 0.3e1 * t959 - 0.32e2 / 0.3e1 * t964 - 0.16e2 / 0.9e1 * t968 - 0.4e1 / 0.3e1 * t191 * t506 + 0.20e2 / 0.9e1 * t1079 + 0.20e2 / 0.27e2 * t505 * t1082);
  t1087 = t1086 * t18;
  t1091 = t510 * t122;
  t1093 = t5 * t1091 * t56;
  t1102 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1087 * t56 - t1093 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t511 * t160 - t986 + t992 / 0.6e1 - t996 + t819 / 0.12e2 - t832 + t834 / 0.12e2);
  t1105 = t298 * t519;
  t1107 = t410 * t207;
  t1108 = t1107 * rho[1];
  t1111 = t173 * t477;
  t1119 = t65 * t103 * t410 * t524;
  t1125 = t65 * t7;
  t1126 = t1107 * t477;
  t1130 = t65 * t467 * t529;
  t1136 = 0.4e1 * t171 - t1037;
  t1140 = 0.8e1 * t1007 + 0.4e1 / 0.3e1 * t1010 - 0.4e1 / 0.3e1 * t1105 + 0.8e1 / 0.9e1 * t462 * t1108 + 0.4e1 / 0.3e1 * t99 * t1111 - t910 - 0.4e1 / 0.3e1 * t912 + 0.8e1 / 0.3e1 * t1019 - 0.8e1 / 0.9e1 * t1023 - t1027 + 0.4e1 / 0.9e1 * t1119 - 0.20e2 / 0.27e2 * t169 * t171 * t924 * t524 - 0.8e1 / 0.9e1 * t1125 * t1126 - 0.2e1 / 0.3e1 * t1130 + 0.4e1 / 0.9e1 * t169 * t471 * t529 + 0.2e1 / 0.3e1 * t65 * t205 * t1136;
  t1141 = my_piecewise3(t64, 0, t1140);
  t1142 = t1141 * t18;
  t1146 = t534 * t122;
  t1148 = t5 * t1146 * t94;
  t1155 = t5 * t487 * t246;
  t1163 = t5 * t183 * t588;
  t1165 = -0.3e1 / 0.8e1 * t5 * t1142 * t94 - t1148 / 0.8e1 - t1051 + t1054 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t483 * t246 - t1155 / 0.4e1 + t940 / 0.12e2 - t945 - t1063 + t1065 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t179 * t588 - t1163 / 0.8e1;
  t1166 = my_piecewise3(t61, 0, t1165);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t950 + t951 + t517 + t593 + t6 * (t1102 + t1166);

  t1173 = t11 * t148;
  t1174 = t921 * t787;
  t1178 = my_piecewise3(t10, 0, -t774 - 0.12e2 * t964 + 0.4e1 * t1079 - 0.20e2 / 0.27e2 * t1173 * t1174);
  t1179 = t1178 * t18;
  t1186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1179 * t56 - 0.3e1 / 0.8e1 * t1093 + t992 / 0.4e1 - t832);
  t1189 = t410 * t524;
  t1192 = t173 * t529;
  t1199 = t524 * t207;
  t1203 = t1107 * t529;
  t1207 = 0.6e1 * t171 - 0.6e1 * t1036;
  t1211 = 0.12e2 * t1007 - 0.4e1 * t1105 - 0.4e1 / 0.3e1 * t99 * t1189 + 0.2e1 * t99 * t1192 - t910 + 0.4e1 * t1019 + 0.4e1 / 0.3e1 * t1119 - 0.2e1 * t1130 + 0.20e2 / 0.27e2 * t65 * t7 * t924 * t1199 - 0.4e1 / 0.3e1 * t1125 * t1203 + 0.2e1 / 0.3e1 * t65 * t205 * t1207;
  t1212 = my_piecewise3(t64, 0, t1211);
  t1213 = t1212 * t18;
  t1229 = 0.1e1 / t75 / t284;
  t1231 = t1229 * t84 * t89;
  t1236 = sigma[2] * t1229 * params->a1;
  t1241 = 0.1e1 / t74 / t577;
  t1250 = t232 * t1241 * params->a1;
  t1254 = t577 * t217;
  t1255 = 0.1e1 / t1254;
  t1260 = t82 * t871;
  t1261 = t1260 * t89;
  t1265 = t563 * t570;
  t1271 = t582 * t387;
  t1272 = t227 * t1271;
  t1276 = t232 * t232;
  t1277 = t33 * t1276;
  t1278 = t577 * t284;
  t1280 = 0.1e1 / t75 / t1278;
  t1282 = t239 * t239;
  t1283 = 0.1e1 / t1282;
  t1285 = t84 * t1283 * t897;
  t1289 = -0.539e3 / 0.19683e5 * t32 * t72 * t1231 - 0.413e3 / 0.13122e5 * t138 * t1236 * t228 + 0.2387e4 / 0.19683e5 * t32 * t233 * t1241 * t242 - 0.77e2 / 0.6561e4 * t138 * t1236 * t564 + 0.140e3 / 0.2187e4 * t138 * t1250 * t571 - 0.1064e4 / 0.6561e4 * t32 * t576 * t1255 * t584 - 0.28e2 / 0.19683e5 * t138 * t1236 * t1261 + 0.56e2 / 0.6561e4 * t138 * t1250 * t1265 - 0.224e3 / 0.6561e4 * t138 * t575 * t1255 * params->a1 * t1272 + 0.448e3 / 0.6561e4 * t32 * t1277 * t1280 * t1285;
  t1294 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1213 * t94 - 0.3e1 / 0.8e1 * t1148 - 0.9e1 / 0.8e1 * t5 * t535 * t246 + t1054 / 0.4e1 - 0.3e1 / 0.4e1 * t1155 - 0.9e1 / 0.8e1 * t5 * t213 * t588 - t945 + t1065 / 0.4e1 - 0.3e1 / 0.8e1 * t1163 - 0.3e1 / 0.8e1 * t5 * t71 * t1289);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t517 + 0.3e1 * t593 + t6 * (t1186 + t1294);

  t1302 = t5 * t330 * t271;
  t1309 = t5 * t339 * t271 / 0.12e2;
  t1311 = t5 * t123 * t632;
  t1317 = t33 * t347 * params->a1;
  t1321 = t33 * t360;
  t1330 = t360 * params->a1 * t44;
  t1335 = t33 * t382 * t46;
  t1336 = t883 * t146;
  t1343 = t365 * t154;
  t1344 = t1343 * t48;
  t1349 = t382 * params->a1 * t44;
  t1350 = params->alpha * t385;
  t1351 = t387 * t146;
  t1352 = t1350 * t1351;
  t1356 = t380 * t148;
  t1358 = 0.1e1 / t37 / t1356;
  t1363 = 0.77e2 / 0.13122e5 * t254 * t255 * t349 + 0.35e2 / 0.4374e4 * t32 * t1317 * t142 - 0.455e3 / 0.13122e5 * t32 * t1321 * t46 * t612 + 0.7e1 / 0.1944e4 * t32 * t1317 * t367 - 0.91e2 / 0.4374e4 * t138 * t1330 * t622 + 0.119e3 / 0.2187e4 * t32 * t1335 * t1336 + 0.7e1 / 0.13122e5 * t32 * t1317 * t873 - 0.7e1 / 0.2187e4 * t138 * t1330 * t1344 + 0.28e2 / 0.2187e4 * t138 * t1349 * t1352 - 0.56e2 / 0.2187e4 * t32 * t379 * t1358 * t898;
  t1368 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t326 * t271 - t1302 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t117 * t632 + t1309 - t1311 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * t1363);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t6 * t1368 + 0.2e1 * t637;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t1375 = t5 * t420 * t291;
  t1379 = t5 * t424 * t291 / 0.12e2;
  t1381 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t416 * t291 - t1375 / 0.4e1 + t1379);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t6 * t1381 + 0.2e1 * t646;

  t1387 = t5 * t449 * t271;
  t1395 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t445 * t271 - t1387 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t197 * t632 - t1302 / 0.8e1 + t1309 - t1311 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t6 * t1395 + t637 + t652;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1401 = t5 * t487 * t291;
  t1408 = t5 * t183 * t687;
  t1411 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t483 * t291 - t1401 / 0.8e1 - t1375 / 0.8e1 + t1379 - 0.3e1 / 0.8e1 * t5 * t179 * t687 - t1408 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t6 * t1411 + t646 + t692;

  t1419 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t511 * t271 - t1387 / 0.4e1 + t1309);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t6 * t1419 + 0.2e1 * t652;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1434 = t33 * t545 * params->a1;
  t1438 = t33 * t558;
  t1447 = t558 * params->a1 * t82;
  t1452 = t33 * t579 * t84;
  t1453 = t1271 * t232;
  t1460 = t365 * t240;
  t1461 = t1460 * t86;
  t1466 = t579 * params->a1 * t82;
  t1467 = params->alpha * t582;
  t1468 = t387 * t232;
  t1469 = t1467 * t1468;
  t1473 = t577 * t234;
  t1475 = 0.1e1 / t75 / t1473;
  t1480 = 0.77e2 / 0.13122e5 * t254 * t255 * t547 + 0.35e2 / 0.4374e4 * t32 * t1434 * t228 - 0.455e3 / 0.13122e5 * t32 * t1438 * t84 * t667 + 0.7e1 / 0.1944e4 * t32 * t1434 * t564 - 0.91e2 / 0.4374e4 * t138 * t1447 * t677 + 0.119e3 / 0.2187e4 * t32 * t1452 * t1453 + 0.7e1 / 0.13122e5 * t32 * t1434 * t1261 - 0.7e1 / 0.2187e4 * t138 * t1447 * t1461 + 0.28e2 / 0.2187e4 * t138 * t1466 * t1469 - 0.56e2 / 0.2187e4 * t32 * t576 * t1475 * t1285;
  t1485 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t535 * t291 - t1401 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t213 * t687 + t1379 - t1408 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t71 * t1480);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t6 * t1485 + 0.2e1 * t692;

  t1492 = t5 * t123 * t722 / 0.8e1;
  t1494 = t129 * params->a1 * t44;
  t1507 = t33 * t627;
  t1509 = t883 * sigma[0];
  t1513 = t871 * t696;
  t1514 = t1513 * t51;
  t1518 = t1343 * params->b1;
  t1523 = t627 * params->a1 * t44;
  t1524 = t387 * sigma[0];
  t1525 = t1350 * t1524;
  t1530 = 0.1e1 / t37 / t865;
  t1535 = -0.7e1 / 0.8748e4 * t138 * t1494 * t698 - 0.7e1 / 0.8748e4 * t138 * t1494 * t707 + 0.49e2 / 0.8748e4 * t138 * t620 * t713 + 0.14e2 / 0.2187e4 * t32 * t610 * t156 - 0.35e2 / 0.2187e4 * t32 * t1507 * t46 * t1509 - 0.7e1 / 0.34992e5 * t138 * t1494 * t1514 + 0.7e1 / 0.5832e4 * t138 * t620 * t1518 - 0.7e1 / 0.1458e4 * t138 * t1523 * t1525 + 0.7e1 / 0.729e3 * t32 * t147 * t1530 * t898;
  t1540 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t722 - t1492 - 0.3e1 / 0.8e1 * t5 * t19 * t1535);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t6 * t1540 + t726;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1547 = t5 * t183 * t755 / 0.8e1;
  t1549 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t179 * t755 - t1547);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = t6 * t1549 + t759;

  t1555 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t197 * t722 - t1492);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t6 * t1555 + t726;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1561 = t219 * params->a1 * t82;
  t1574 = t33 * t682;
  t1576 = t1271 * sigma[2];
  t1580 = t871 * t729;
  t1581 = t1580 * t89;
  t1585 = t1460 * params->b1;
  t1590 = t682 * params->a1 * t82;
  t1591 = t387 * sigma[2];
  t1592 = t1467 * t1591;
  t1597 = 0.1e1 / t75 / t1254;
  t1602 = -0.7e1 / 0.8748e4 * t138 * t1561 * t731 - 0.7e1 / 0.8748e4 * t138 * t1561 * t740 + 0.49e2 / 0.8748e4 * t138 * t675 * t746 + 0.14e2 / 0.2187e4 * t32 * t665 * t242 - 0.35e2 / 0.2187e4 * t32 * t1574 * t84 * t1576 - 0.7e1 / 0.34992e5 * t138 * t1561 * t1581 + 0.7e1 / 0.5832e4 * t138 * t675 * t1585 - 0.7e1 / 0.1458e4 * t138 * t1590 * t1592 + 0.7e1 / 0.729e3 * t32 * t233 * t1597 * t1285;
  t1607 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t213 * t755 - t1547 - 0.3e1 / 0.8e1 * t5 * t71 * t1602);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t6 * t1607 + t759;

  t1609 = 0.1e1 / t146;
  t1610 = params->alpha * t1609;
  t1611 = t1610 * t51;
  t1615 = t697 * t373;
  t1623 = t871 * t1609;
  t1624 = t1623 * t51;
  t1628 = t706 * t373;
  t1633 = t717 * params->a1 * t44;
  t1634 = t1350 * t387;
  t1639 = 0.1e1 / t37 / t381;
  t1644 = -0.7e1 / 0.23328e5 * t138 * t695 * t1611 - 0.7e1 / 0.7776e4 * t138 * t712 * t1615 + 0.7e1 / 0.1944e4 * t32 * t33 * t717 * t388 + 0.7e1 / 0.93312e5 * t138 * t695 * t1624 - 0.7e1 / 0.15552e5 * t138 * t712 * t1628 + 0.7e1 / 0.3888e4 * t138 * t1633 * t1634 - 0.7e1 / 0.1944e4 * t32 * t34 * t1639 * t898;
  t1648 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t1644);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = t6 * t1648;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1649 = 0.1e1 / t232;
  t1650 = params->alpha * t1649;
  t1651 = t1650 * t89;
  t1655 = t730 * t570;
  t1663 = t871 * t1649;
  t1664 = t1663 * t89;
  t1668 = t739 * t570;
  t1673 = t750 * params->a1 * t82;
  t1674 = t1467 * t387;
  t1679 = 0.1e1 / t75 / t578;
  t1684 = -0.7e1 / 0.23328e5 * t138 * t728 * t1651 - 0.7e1 / 0.7776e4 * t138 * t745 * t1655 + 0.7e1 / 0.1944e4 * t32 * t33 * t750 * t584 + 0.7e1 / 0.93312e5 * t138 * t728 * t1664 - 0.7e1 / 0.15552e5 * t138 * t745 * t1668 + 0.7e1 / 0.3888e4 * t138 * t1673 * t1674 - 0.7e1 / 0.1944e4 * t32 * t72 * t1679 * t1285;
  t1688 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t71 * t1684);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = t6 * t1688;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1692 = 0.1e1 / t121 / t170;
  t1696 = 0.10e2 / 0.27e2 * t5 * t17 * t1692 * t56;
  t1699 = t5 * t805 * t122 * t56;
  t1703 = t5 * t325 * t338 * t56;
  t1707 = t5 * t116 * t828 * t56;
  t1713 = t5 * t829 * t160;
  t1716 = t5 * t339 * t392;
  t1719 = t5 * t123 * t902;
  t1722 = 0.1e1 / t36 / t626;
  t1724 = t146 * t1722 * params->a1;
  t1729 = 0.1e1 / t1356;
  t1731 = t378 * t1729 * params->a1;
  t1736 = t380 * t149;
  t1738 = 0.1e1 / t37 / t1736;
  t1741 = t895 * t897;
  t1759 = t380 * t380;
  t1767 = t387 * t387;
  t1768 = t46 / t894 / t50 * t1767;
  t1773 = 0.1e1 / t37 / t149;
  t1775 = sigma[0] * t1773 * params->a1;
  t1779 = t365 * t365;
  t1781 = t44 * t1779 * t51;
  t1806 = -0.896e3 / 0.59049e5 * t138 * t1724 * t872 * t373 + 0.1792e4 / 0.19683e5 * t138 * t1731 * t366 * t883 - 0.7168e4 / 0.19683e5 * t138 * t888 * t1738 * params->a1 * t141 * t1741 + 0.18368e5 / 0.19683e5 * t138 * t1731 * t884 + 0.143528e6 / 0.59049e5 * t32 * t379 * t1729 * t388 - 0.43904e5 / 0.19683e5 * t32 * t889 * t1738 * t898 + 0.14336e5 / 0.19683e5 * t32 * t33 * t888 * sigma[0] / t36 / t1759 / rho[0] * t1768 + 0.1400e4 / 0.59049e5 * t138 * t1775 * t873 + 0.112e3 / 0.59049e5 * t138 * t1775 * t1781 + 0.2135e4 / 0.19683e5 * t138 * t1775 * t367 + 0.25375e5 / 0.118098e6 * t138 * t1775 * t142 - 0.1232e4 / 0.6561e4 * t138 * t1724 * t877 - 0.46004e5 / 0.59049e5 * t138 * t1724 * t374 - 0.21329e5 / 0.19683e5 * t32 * t147 * t1722 * t156 + 0.9163e4 / 0.59049e5 * t32 * t34 * t1773 * t46 * t51;
  t1811 = t12 * t439 * t314;
  t1815 = t12 * t103 * t787 * t789;
  t1818 = t12 * t103 * t795;
  t1822 = 0.1e1 / t107 / t127 / t171;
  t1824 = t314 * t314;
  t1832 = t320 * t320;
  t1839 = t298 * t766;
  t1848 = 0.48e2 * t12 * t408 * t13;
  t1850 = t12 * t436 * t111;
  t1853 = t12 * t192 * t320;
  t1856 = t12 * t307 * t800;
  t1864 = t1009 * t13;
  t1866 = t462 * t301;
  t1868 = t298 * t769;
  t1873 = -0.16e2 / 0.3e1 * t1811 - 0.80e2 / 0.27e2 * t1815 + 0.16e2 / 0.3e1 * t1818 - 0.160e3 / 0.81e2 * t12 * t7 * t1822 * t1824 + 0.40e2 / 0.9e1 * t793 * t787 * t314 * t320 - 0.4e1 / 0.3e1 * t12 * t313 * t1832 - 0.16e2 / 0.9e1 * t793 * t794 * t800 + 0.16e2 / 0.3e1 * t1839 + 0.80e2 / 0.27e2 * t99 * t787 * t789 - 0.16e2 / 0.3e1 * t99 * t795 + t1848 - 0.16e2 * t1850 + 0.8e1 * t1853 - 0.8e1 / 0.3e1 * t1856 + 0.2e1 / 0.3e1 * t12 * t109 * (0.24e2 * rho[0] * t408 - 0.24e2 * t402) - 0.48e2 * t1864 + 0.16e2 * t1866 - 0.8e1 * t1868 + 0.8e1 / 0.3e1 * t99 * t108 * t800;
  t1874 = my_piecewise3(t10, 0, t1873);
  t1883 = t5 * t810 * t160;
  t1889 = t5 * t817 * t160;
  t1891 = t5 * t330 * t392;
  t1893 = t1696 - t1699 / 0.2e1 + t1703 / 0.2e1 - 0.5e1 / 0.9e1 * t1707 - 0.3e1 / 0.2e1 * t5 * t117 * t902 - 0.5e1 / 0.9e1 * t1713 + t1716 / 0.2e1 - t1719 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t19 * t1806 - 0.3e1 / 0.8e1 * t5 * t1874 * t18 * t56 - 0.3e1 / 0.2e1 * t5 * t806 * t160 - 0.3e1 / 0.2e1 * t1883 - 0.9e1 / 0.4e1 * t5 * t326 * t392 + t1889 - 0.3e1 / 0.2e1 * t1891;
  t1894 = my_piecewise3(t1, 0, t1893);
  t1897 = 0.48e2 * t65 * t408 * t66;
  t1899 = t169 * t915 * t173;
  t1902 = t406 * t921 * t410;
  t1904 = t401 * t401;
  t1905 = 0.1e1 / t1904;
  t1907 = t919 * t1905 * t924;
  t1911 = 0.1e1 / t1904 / t6;
  t1914 = 0.1e1 / t172 / t217 / t171;
  t1919 = my_piecewise3(t64, 0, t1897 + 0.64e2 * t1899 - 0.32e2 * t1902 + 0.320e3 / 0.27e2 * t1907 - 0.160e3 / 0.81e2 * t11 * t284 * t1911 * t1914);
  t1926 = t5 * t929 * t122 * t94;
  t1930 = t5 * t415 * t338 * t94;
  t1934 = t5 * t178 * t828 * t94;
  t1939 = 0.10e2 / 0.27e2 * t5 * t70 * t1692 * t94;
  t1941 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1919 * t18 * t94 - t1926 / 0.2e1 + t1930 / 0.2e1 - 0.5e1 / 0.9e1 * t1934 + t1939);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t907 + 0.4e1 * t947 + t6 * (t1894 + t1941);

  t1948 = t5 * t978 * t122 * t56;
  t1952 = t5 * t444 * t338 * t56;
  t1953 = t1952 / 0.4e1;
  t1956 = t5 * t196 * t828 * t56;
  t1965 = t191 * t402 * t787 * t314;
  t1979 = t12 * t963;
  t1981 = t12 * t967;
  t1986 = t191 * t915 * t108;
  t1989 = t191 * t506 * t111;
  t1991 = -0.40e2 / 0.9e1 * t12 * t971 + 0.20e2 / 0.3e1 * t1965 + 0.160e3 / 0.81e2 * t191 * t171 * t1822 * t789 - 0.20e2 / 0.9e1 * t191 * t171 * t787 * t111 * t320 - 0.8e1 / 0.3e1 * t1811 - 0.20e2 / 0.27e2 * t1815 + 0.4e1 / 0.3e1 * t1818 - 0.48e2 * t1979 - 0.16e2 * t1981 + 0.8e1 / 0.3e1 * t12 * t974 + 0.40e2 * t1986 + 0.16e2 * t1989;
  t1993 = t191 * t966 * t320;
  t2005 = t1009 * t108;
  t2009 = -0.4e1 * t1993 + 0.4e1 / 0.9e1 * t191 * t439 * t800 + 0.4e1 / 0.3e1 * t1839 + t1848 - 0.12e2 * t1850 + 0.4e1 * t1853 - 0.2e1 / 0.3e1 * t1856 - 0.36e2 * t1864 + 0.8e1 * t1866 - 0.2e1 * t1868 + 0.12e2 * t2005 + 0.8e1 / 0.3e1 * t462 * t794;
  t2011 = my_piecewise3(t10, 0, t1991 + t2009);
  t2020 = t5 * t983 * t160;
  t2026 = t5 * t990 * t160;
  t2027 = t2026 / 0.4e1;
  t2029 = t5 * t449 * t392;
  t2040 = -0.3e1 / 0.8e1 * t1948 + t1953 - 0.5e1 / 0.36e2 * t1956 + t1696 - t1699 / 0.8e1 + t1703 / 0.4e1 - 0.5e1 / 0.12e2 * t1707 - 0.3e1 / 0.8e1 * t5 * t2011 * t18 * t56 - 0.9e1 / 0.8e1 * t5 * t979 * t160 - 0.3e1 / 0.4e1 * t2020 - 0.9e1 / 0.8e1 * t5 * t445 * t392 + t2027 - 0.3e1 / 0.8e1 * t2029 - 0.3e1 / 0.8e1 * t5 * t197 * t902 - 0.5e1 / 0.12e2 * t1713 + t1716 / 0.4e1 - t1719 / 0.8e1 - 0.3e1 / 0.8e1 * t1883 + t1889 / 0.2e1 - 0.3e1 / 0.8e1 * t1891;
  t2041 = my_piecewise3(t1, 0, t2040);
  t2043 = t65 * t174 * t477;
  t2044 = 0.4e1 * t2043;
  t2046 = t169 * t411 * t207;
  t2049 = t169 * t1021 * t477;
  t2053 = t406 * t915 * t924 * t207;
  t2056 = t65 * t467 * t1038;
  t2069 = rho[1] * t408;
  t2070 = 0.24e2 * t2069;
  t2076 = t65 * t403 * t207;
  t2081 = t1009 * t66;
  t2083 = t1012 * t463;
  t2086 = t11 * t915 * t1013;
  t2092 = t2044 + 0.8e1 * t2046 - 0.16e2 / 0.3e1 * t2049 - 0.20e2 / 0.3e1 * t2053 - 0.2e1 * t2056 + 0.20e2 / 0.9e1 * t406 * t1028 * t477 + 0.160e3 / 0.81e2 * t919 * t921 * t1914 * t207 + 0.4e1 / 0.3e1 * t169 * t471 * t1038 + 0.2e1 / 0.3e1 * t65 * t205 * (-0.6e1 * t402 + t2070) - 0.4e1 * t2076 + t1897 + 0.24e2 * t1899 - 0.16e2 / 0.3e1 * t1902 + 0.20e2 / 0.27e2 * t1907 - 0.12e2 * t2081 - 0.12e2 * t2083 + 0.4e1 * t2086 - 0.20e2 / 0.27e2 * t11 * t921 * t924 * t217;
  t2093 = my_piecewise3(t64, 0, t2092);
  t2100 = t5 * t1043 * t122 * t94;
  t2104 = t5 * t482 * t338 * t94;
  t2105 = t2104 / 0.4e1;
  t2108 = t5 * t212 * t828 * t94;
  t2117 = t5 * t934 * t246;
  t2120 = t5 * t938 * t246;
  t2121 = t2120 / 0.4e1;
  t2123 = t5 * t942 * t246;
  t2125 = -0.3e1 / 0.8e1 * t5 * t2093 * t18 * t94 - 0.3e1 / 0.8e1 * t2100 + t2105 - 0.5e1 / 0.36e2 * t2108 - t1926 / 0.8e1 + t1930 / 0.4e1 - 0.5e1 / 0.12e2 * t1934 + t1939 - 0.3e1 / 0.8e1 * t5 * t930 * t246 - 0.3e1 / 0.8e1 * t2117 + t2121 - 0.5e1 / 0.36e2 * t2123;
  t2126 = my_piecewise3(t61, 0, t2125);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t907 + t947 + 0.3e1 * t1006 + 0.3e1 * t1068 + t6 * (t2041 + t2126);

  t2135 = t191 * t1078;
  t2140 = t505 * t921 * t312;
  t2144 = t505 * t915 * t787 * t111;
  t2165 = -0.8e1 / 0.3e1 * t12 * t506 + 0.40e2 / 0.3e1 * t2135 + 0.40e2 / 0.9e1 * t191 * t1082 - 0.40e2 / 0.3e1 * t2140 - 0.200e3 / 0.27e2 * t2144 + 0.20e2 / 0.27e2 * t505 * t1081 * t320 - 0.160e3 / 0.81e2 * t505 * t408 * t1822 * t314 + 0.80e2 / 0.27e2 * t1965 - 0.8e1 / 0.9e1 * t1811 - 0.128e3 / 0.3e1 * t1979 - 0.64e2 / 0.9e1 * t1981 + 0.160e3 / 0.3e1 * t1986 + 0.128e3 / 0.9e1 * t1989 - 0.16e2 / 0.9e1 * t1993 + t1848 - 0.8e1 * t1850 + 0.4e1 / 0.3e1 * t1853 - 0.24e2 * t1864 + 0.8e1 / 0.3e1 * t1866 + 0.16e2 / 0.3e1 * t2005;
  t2166 = my_piecewise3(t10, 0, t2165);
  t2175 = t5 * t1091 * t160;
  t2182 = t5 * t1086 * t122 * t56;
  t2186 = t5 * t510 * t338 * t56;
  t2199 = -0.3e1 / 0.8e1 * t5 * t2166 * t18 * t56 - 0.3e1 / 0.4e1 * t5 * t1087 * t160 - t2175 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t511 * t392 - t2182 / 0.4e1 + t2186 / 0.12e2 - t1948 / 0.4e1 + t1952 / 0.3e1 - 0.5e1 / 0.18e2 * t1956 + t1696 + t1703 / 0.12e2 - 0.5e1 / 0.18e2 * t1707 - t2020 / 0.2e1 + t2026 / 0.3e1 - t2029 / 0.4e1 - 0.5e1 / 0.18e2 * t1713 + t1716 / 0.12e2 + t1889 / 0.6e1;
  t2200 = my_piecewise3(t1, 0, t2199);
  t2207 = t65 * t467 * t1136;
  t2210 = t169 * t1021 * t529;
  t2223 = t1009 * t1108;
  t2225 = t410 * t477;
  t2229 = t924 * t207;
  t2235 = t169 * t402 * t924 * t524;
  t2238 = t65 * t471 * t524;
  t2240 = t477 * t477;
  t2245 = t65 * t174 * t529;
  t2248 = -0.24e2 * t2081 - 0.160e3 / 0.81e2 * t406 * t408 * t1914 * t524 - 0.4e1 / 0.3e1 * t2207 - 0.16e2 / 0.9e1 * t2210 + 0.8e1 / 0.9e1 * t169 * t471 * t1136 + 0.20e2 / 0.27e2 * t406 * t1028 * t529 + 0.2e1 / 0.3e1 * t65 * t205 * (-0.12e2 * t402 + t2070) - 0.32e2 / 0.9e1 * t2223 + 0.16e2 / 0.9e1 * t462 * t2225 * rho[1] + 0.40e2 / 0.27e2 * t1012 * t2229 * t73 + 0.80e2 / 0.27e2 * t2235 - 0.8e1 / 0.9e1 * t2238 - 0.8e1 / 0.9e1 * t65 * t523 * t2240 + 0.4e1 / 0.3e1 * t2245 + 0.16e2 / 0.3e1 * t2043;
  t2254 = t65 * t103;
  t2255 = t2254 * t1126;
  t2257 = t169 * t171;
  t2264 = t462 * t519;
  t2266 = t298 * t1111;
  t2275 = 0.16e2 / 0.3e1 * t2046 - 0.16e2 / 0.9e1 * t2049 - 0.40e2 / 0.27e2 * t2053 - 0.4e1 / 0.3e1 * t2056 - 0.8e1 * t2076 + 0.16e2 / 0.9e1 * t2255 - 0.80e2 / 0.27e2 * t2257 * t2229 * t477 - 0.8e1 / 0.9e1 * t1125 * t1107 * t1038 + 0.8e1 / 0.3e1 * t2264 - 0.8e1 / 0.3e1 * t2266 + 0.4e1 / 0.3e1 * t99 * t173 * t1038 + t1897 + 0.32e2 / 0.3e1 * t1899 - 0.8e1 / 0.9e1 * t1902 - 0.8e1 * t2083 + 0.8e1 / 0.9e1 * t2086;
  t2277 = my_piecewise3(t64, 0, t2248 + t2275);
  t2284 = t5 * t1141 * t122 * t94;
  t2288 = t5 * t534 * t338 * t94;
  t2297 = t5 * t1048 * t246;
  t2300 = t5 * t1052 * t246;
  t2311 = t5 * t420 * t588;
  t2314 = t5 * t424 * t588;
  t2316 = -0.3e1 / 0.8e1 * t5 * t2277 * t18 * t94 - t2284 / 0.4e1 + t2288 / 0.12e2 - t2100 / 0.4e1 + t2104 / 0.3e1 - 0.5e1 / 0.18e2 * t2108 - 0.3e1 / 0.4e1 * t5 * t1044 * t246 - t2297 / 0.2e1 + t2300 / 0.6e1 + t1930 / 0.12e2 - 0.5e1 / 0.18e2 * t1934 + t1939 - t2117 / 0.4e1 + t2120 / 0.3e1 - 0.5e1 / 0.18e2 * t2123 - 0.3e1 / 0.8e1 * t5 * t416 * t588 - t2311 / 0.4e1 + t2314 / 0.12e2;
  t2317 = my_piecewise3(t61, 0, t2316);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t1006 + 0.2e1 * t1068 + 0.2e1 * t1102 + 0.2e1 * t1166 + t6 * (t2200 + t2317);

  t2333 = t1173 * t1905 * t787;
  t2339 = -0.12e2 * t1864 + t1848 - 0.4e1 * t1850 - 0.24e2 * t1979 + 0.60e2 * t1986 + 0.8e1 * t1989 + 0.12e2 * t2135 - 0.24e2 * t2140 - 0.20e2 / 0.3e1 * t2144 - 0.80e2 / 0.27e2 * t505 * t1174 + 0.140e3 / 0.27e2 * t2333 + 0.160e3 / 0.81e2 * t1173 * t921 * t1822 * t111;
  t2340 = my_piecewise3(t10, 0, t2339);
  t2347 = t5 * t1178 * t122 * t56;
  t2358 = -0.3e1 / 0.8e1 * t5 * t2340 * t18 * t56 - t2347 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1179 * t160 - 0.3e1 / 0.8e1 * t2182 + t2186 / 0.4e1 - 0.3e1 / 0.8e1 * t2175 + t1953 - 0.5e1 / 0.12e2 * t1956 + t2027 - 0.5e1 / 0.36e2 * t1707 + t1696 - 0.5e1 / 0.36e2 * t1713;
  t2359 = my_piecewise3(t1, 0, t2358);
  t2363 = t924 * t524;
  t2384 = t65 * t467 * t1207;
  t2388 = t65 * t103 * t924 * t1199;
  t2396 = -0.36e2 * t2081 - 0.8e1 / 0.3e1 * t99 * t1126 - 0.20e2 / 0.9e1 * t462 * t2363 * rho[1] + 0.4e1 / 0.3e1 * t462 * t410 * t529 * rho[1] + 0.160e3 / 0.81e2 * t169 * t171 * t1914 * t1199 + 0.2e1 / 0.3e1 * t65 * t205 * (-0.18e2 * t402 + t2070) + 0.4e1 / 0.9e1 * t169 * t471 * t1207 - 0.2e1 / 0.3e1 * t2384 - 0.20e2 / 0.27e2 * t2388 - 0.2e1 * t2207 - 0.4e1 / 0.3e1 * t2210 - 0.8e1 / 0.3e1 * t2223 + 0.20e2 / 0.9e1 * t2235 - 0.8e1 / 0.3e1 * t2238 + 0.4e1 * t2245 + t2044;
  t2411 = t2254 * t1203;
  t2416 = t298 * t1189;
  t2418 = t298 * t1192;
  t2425 = 0.8e1 / 0.3e1 * t2046 - 0.12e2 * t2076 - 0.4e1 / 0.3e1 * t1125 * t2225 * t529 - 0.4e1 / 0.3e1 * t1125 * t1107 * t1136 - 0.20e2 / 0.9e1 * t2257 * t2229 * t529 + 0.20e2 / 0.9e1 * t1125 * t2363 * t477 + 0.4e1 / 0.3e1 * t2411 + 0.8e1 / 0.3e1 * t2255 + 0.8e1 * t2264 - 0.4e1 * t2266 + 0.4e1 / 0.3e1 * t2416 - 0.2e1 * t2418 + 0.2e1 * t99 * t173 * t1136 + t1897 + 0.4e1 * t1899 - 0.4e1 * t2083;
  t2427 = my_piecewise3(t64, 0, t2396 + t2425);
  t2434 = t5 * t1212 * t122 * t94;
  t2442 = t5 * t1146 * t246;
  t2451 = t5 * t487 * t588;
  t2461 = t5 * t183 * t1289;
  t2463 = -0.3e1 / 0.8e1 * t5 * t2427 * t18 * t94 - t2434 / 0.8e1 - 0.3e1 / 0.8e1 * t2284 + t2288 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1142 * t246 - 0.3e1 / 0.8e1 * t2442 + t2105 - 0.5e1 / 0.12e2 * t2108 - 0.3e1 / 0.4e1 * t2297 + t2300 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t483 * t588 - 0.3e1 / 0.8e1 * t2451 - 0.5e1 / 0.36e2 * t1934 + t1939 + t2121 - 0.5e1 / 0.12e2 * t2123 - 0.3e1 / 0.8e1 * t2311 + t2314 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t179 * t1289 - t2461 / 0.8e1;
  t2464 = my_piecewise3(t61, 0, t2463);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t1102 + 0.3e1 * t1166 + t1186 + t1294 + t6 * (t2359 + t2464);

  t2477 = my_piecewise3(t10, 0, t1848 + 0.64e2 * t1986 - 0.32e2 * t2140 + 0.320e3 / 0.27e2 * t2333 - 0.160e3 / 0.81e2 * t11 * t264 * t1911 * t1822);
  t2486 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2477 * t18 * t56 - t2347 / 0.2e1 + t2186 / 0.2e1 - 0.5e1 / 0.9e1 * t1956 + t1696);
  t2497 = 0.1e1 / t74 / t681;
  t2499 = t232 * t2497 * params->a1;
  t2504 = 0.1e1 / t1473;
  t2506 = t575 * t2504 * params->a1;
  t2511 = t577 * t235;
  t2513 = 0.1e1 / t75 / t2511;
  t2516 = t1283 * t897;
  t2532 = t577 * t577;
  t2540 = t84 / t1282 / t88 * t1767;
  t2545 = 0.1e1 / t75 / t235;
  t2564 = sigma[2] * t2545 * params->a1;
  t2566 = t82 * t1779 * t89;
  t2579 = -0.896e3 / 0.59049e5 * t138 * t2499 * t1260 * t570 + 0.1792e4 / 0.19683e5 * t138 * t2506 * t563 * t1271 - 0.7168e4 / 0.19683e5 * t138 * t1276 * t2513 * params->a1 * t227 * t2516 - 0.1232e4 / 0.6561e4 * t138 * t2499 * t1265 + 0.18368e5 / 0.19683e5 * t138 * t2506 * t1272 - 0.46004e5 / 0.59049e5 * t138 * t2499 * t571 + 0.14336e5 / 0.19683e5 * t32 * t33 * t1276 * sigma[2] / t74 / t2532 / rho[1] * t2540 + 0.9163e4 / 0.59049e5 * t32 * t72 * t2545 * t84 * t89 - 0.21329e5 / 0.19683e5 * t32 * t233 * t2497 * t242 + 0.143528e6 / 0.59049e5 * t32 * t576 * t2504 * t584 - 0.43904e5 / 0.19683e5 * t32 * t1277 * t2513 * t1285 + 0.112e3 / 0.59049e5 * t138 * t2564 * t2566 + 0.2135e4 / 0.19683e5 * t138 * t2564 * t564 + 0.1400e4 / 0.59049e5 * t138 * t2564 * t1261 + 0.25375e5 / 0.118098e6 * t138 * t2564 * t228;
  t2597 = t524 * t524;
  t2604 = t529 * t529;
  t2621 = 0.2e1 / 0.3e1 * t65 * t205 * (-0.24e2 * t402 + 0.24e2 * t2069) + 0.80e2 / 0.27e2 * t99 * t924 * t1199 - 0.16e2 / 0.3e1 * t99 * t1203 + 0.16e2 / 0.3e1 * t2416 - 0.8e1 * t2418 + 0.16e2 * t2264 - 0.160e3 / 0.81e2 * t65 * t7 * t1914 * t2597 + 0.40e2 / 0.9e1 * t1125 * t2363 * t529 - 0.4e1 / 0.3e1 * t65 * t523 * t2604 - 0.16e2 / 0.9e1 * t1125 * t1107 * t1207 - 0.8e1 / 0.3e1 * t2384 - 0.80e2 / 0.27e2 * t2388 - 0.16e2 / 0.3e1 * t2238 + 0.8e1 * t2245 - 0.16e2 * t2076 + t1897 + 0.16e2 / 0.3e1 * t2411 - 0.48e2 * t2081 + 0.8e1 / 0.3e1 * t99 * t173 * t1207;
  t2622 = my_piecewise3(t64, 0, t2621);
  t2635 = -0.3e1 / 0.2e1 * t5 * t1213 * t246 - 0.9e1 / 0.4e1 * t5 * t535 * t588 - 0.3e1 / 0.2e1 * t5 * t213 * t1289 - 0.3e1 / 0.8e1 * t5 * t71 * t2579 - 0.3e1 / 0.8e1 * t5 * t2622 * t18 * t94 - t2434 / 0.2e1 - 0.3e1 / 0.2e1 * t2442 - 0.3e1 / 0.2e1 * t2451 - t2461 / 0.2e1 + t2300 + t2314 / 0.2e1 + t2288 / 0.2e1 - 0.5e1 / 0.9e1 * t2108 - 0.5e1 / 0.9e1 * t2123 + t1939;
  t2636 = my_piecewise3(t61, 0, t2635);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t1186 + 0.4e1 * t1294 + t6 * (t2486 + t2636);

  t2644 = t5 * t810 * t271;
  t2650 = t5 * t817 * t271;
  t2653 = t5 * t330 * t632;
  t2660 = 0.5e1 / 0.36e2 * t5 * t829 * t271;
  t2662 = t5 * t339 * t632;
  t2665 = t5 * t123 * t1363;
  t2669 = params->alpha * t895;
  t2676 = t852 * params->a1 * t44;
  t2677 = t871 * t154;
  t2683 = t866 * params->a1 * t44;
  t2684 = t365 * t385;
  t2699 = t33 * t840 * params->a1;
  t2737 = 0.896e3 / 0.6561e4 * t138 * t892 * params->a1 * t44 * t2669 * t897 * t378 + 0.112e3 / 0.19683e5 * t138 * t2676 * t2677 * t48 - 0.224e3 / 0.6561e4 * t138 * t2683 * t2684 * t1351 + 0.133e3 / 0.2187e4 * t138 * t2676 * t1344 - 0.2044e4 / 0.6561e4 * t138 * t2683 * t1352 + 0.4333e4 / 0.19683e5 * t138 * t2676 * t622 - 0.287e3 / 0.39366e5 * t32 * t2699 * t873 + 0.4984e4 / 0.6561e4 * t32 * t33 * t892 * t46 * t1741 * t378 - 0.14e2 / 0.19683e5 * t32 * t2699 * t1781 - 0.1792e4 / 0.6561e4 * t32 * t889 / t36 / t1759 * t1768 - 0.889e3 / 0.19683e5 * t32 * t2699 * t142 + 0.1771e4 / 0.6561e4 * t32 * t33 * t852 * t46 * t612 - 0.721e3 / 0.26244e5 * t32 * t2699 * t367 - 0.14350e5 / 0.19683e5 * t32 * t33 * t866 * t46 * t1336 - 0.539e3 / 0.19683e5 * t254 * t255 * t842;
  t2742 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t806 * t271 - 0.3e1 / 0.8e1 * t2644 - 0.9e1 / 0.8e1 * t5 * t326 * t632 + t2650 / 0.4e1 - 0.3e1 / 0.4e1 * t2653 - 0.9e1 / 0.8e1 * t5 * t117 * t1363 - t2660 + t2662 / 0.4e1 - 0.3e1 / 0.8e1 * t2665 - 0.3e1 / 0.8e1 * t5 * t19 * t2737);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t6 * t2742 + 0.3e1 * t1368;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  t2749 = t5 * t934 * t291;
  t2752 = t5 * t938 * t291;
  t2756 = 0.5e1 / 0.36e2 * t5 * t942 * t291;
  t2758 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t930 * t291 - 0.3e1 / 0.8e1 * t2749 + t2752 / 0.4e1 - t2756);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t6 * t2758 + 0.3e1 * t1381;

  t2760 = 0.2e1 * t1395;
  t2766 = t5 * t983 * t271 / 0.4e1;
  t2771 = t5 * t990 * t271;
  t2775 = t5 * t449 * t632 / 0.4e1;
  t2784 = -0.3e1 / 0.8e1 * t5 * t979 * t271 - t2766 - 0.3e1 / 0.4e1 * t5 * t445 * t632 + t2771 / 0.12e2 - t2775 - 0.3e1 / 0.8e1 * t5 * t197 * t1363 - t2644 / 0.8e1 + t2650 / 0.6e1 - t2653 / 0.4e1 - t2660 + t2662 / 0.6e1 - t2665 / 0.8e1;
  t2785 = my_piecewise3(t1, 0, t2784);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t6 * t2785 + t1368 + t2760;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  t2787 = 0.2e1 * t1411;
  t2793 = t5 * t1048 * t291 / 0.4e1;
  t2795 = t5 * t1052 * t291;
  t2804 = t5 * t420 * t687 / 0.4e1;
  t2806 = t5 * t424 * t687;
  t2809 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1044 * t291 - t2793 + t2795 / 0.12e2 - t2749 / 0.8e1 + t2752 / 0.6e1 - t2756 - 0.3e1 / 0.8e1 * t5 * t416 * t687 - t2804 + t2806 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t6 * t2809 + t1381 + t2787;

  t2815 = t5 * t1091 * t271;
  t2824 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1087 * t271 - t2815 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t511 * t632 - t2766 + t2771 / 0.6e1 - t2775 + t2650 / 0.12e2 - t2660 + t2662 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t6 * t2824 + t1419 + t2760;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  t2830 = t5 * t1146 * t291;
  t2837 = t5 * t487 * t687;
  t2845 = t5 * t183 * t1480;
  t2847 = -0.3e1 / 0.8e1 * t5 * t1142 * t291 - t2830 / 0.8e1 - t2793 + t2795 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t483 * t687 - t2837 / 0.4e1 + t2752 / 0.12e2 - t2756 - t2804 + t2806 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t179 * t1480 - t2845 / 0.8e1;
  t2848 = my_piecewise3(t61, 0, t2847);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t6 * t2848 + t1485 + t2787;

  t2857 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1179 * t271 - 0.3e1 / 0.8e1 * t2815 + t2771 / 0.4e1 - t2660);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t6 * t2857 + 0.3e1 * t1419;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  t2876 = params->alpha * t1283;
  t2883 = t1241 * params->a1 * t82;
  t2884 = t871 * t240;
  t2890 = t1255 * params->a1 * t82;
  t2891 = t365 * t582;
  t2906 = t33 * t1229 * params->a1;
  t2944 = 0.896e3 / 0.6561e4 * t138 * t1280 * params->a1 * t82 * t2876 * t897 * t575 + 0.112e3 / 0.19683e5 * t138 * t2883 * t2884 * t86 - 0.224e3 / 0.6561e4 * t138 * t2890 * t2891 * t1468 + 0.133e3 / 0.2187e4 * t138 * t2883 * t1461 - 0.2044e4 / 0.6561e4 * t138 * t2890 * t1469 + 0.4333e4 / 0.19683e5 * t138 * t2883 * t677 - 0.721e3 / 0.26244e5 * t32 * t2906 * t564 - 0.14350e5 / 0.19683e5 * t32 * t33 * t1255 * t84 * t1453 - 0.287e3 / 0.39366e5 * t32 * t2906 * t1261 + 0.4984e4 / 0.6561e4 * t32 * t33 * t1280 * t84 * t2516 * t575 - 0.14e2 / 0.19683e5 * t32 * t2906 * t2566 - 0.1792e4 / 0.6561e4 * t32 * t1277 / t74 / t2532 * t2540 - 0.889e3 / 0.19683e5 * t32 * t2906 * t228 + 0.1771e4 / 0.6561e4 * t32 * t33 * t1241 * t84 * t667 - 0.539e3 / 0.19683e5 * t254 * t255 * t1231;
  t2949 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1213 * t291 - 0.3e1 / 0.8e1 * t2830 - 0.9e1 / 0.8e1 * t5 * t535 * t687 + t2795 / 0.4e1 - 0.3e1 / 0.4e1 * t2837 - 0.9e1 / 0.8e1 * t5 * t213 * t1480 - t2756 + t2806 / 0.4e1 - 0.3e1 / 0.8e1 * t2845 - 0.3e1 / 0.8e1 * t5 * t71 * t2944);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = t6 * t2949 + 0.3e1 * t1485;

  t2956 = t5 * t330 * t722;
  t2963 = t5 * t339 * t722 / 0.12e2;
  t2965 = t5 * t123 * t1535;
  t2968 = t347 * params->a1 * t44;
  t3026 = 0.7e1 / 0.26244e5 * t138 * t2968 * t1779 * t696 * t51 - 0.14e2 / 0.6561e4 * t138 * t1330 * t2677 * params->b1 + 0.35e2 / 0.8748e4 * t138 * t2968 * t707 - 0.1211e4 / 0.26244e5 * t138 * t1330 * t713 + 0.7e1 / 0.3888e4 * t138 * t2968 * t1514 - 0.301e3 / 0.17496e5 * t138 * t1330 * t1518 - 0.112e3 / 0.2187e4 * t138 * t1358 * params->a1 * t44 * t2669 * t897 * t146 + 0.28e2 / 0.2187e4 * t138 * t1349 * t2684 * t1524 + 0.413e3 / 0.4374e4 * t138 * t1349 * t1525 + 0.77e2 / 0.26244e5 * t138 * t2968 * t698 - 0.266e3 / 0.6561e4 * t32 * t1321 * t156 + 0.1169e4 / 0.6561e4 * t32 * t1335 * t1509 - 0.175e3 / 0.729e3 * t32 * t33 * t1358 * t46 * t1741 * t146 + 0.224e3 / 0.2187e4 * t32 * t379 / t36 / t380 / t358 * t1768;
  t3031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t326 * t722 - t2956 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t117 * t1535 + t2963 - t2965 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t19 * t3026);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = t6 * t3031 + 0.2e1 * t1540;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  t3038 = t5 * t420 * t755;
  t3042 = t5 * t424 * t755 / 0.12e2;
  t3044 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t416 * t755 - t3038 / 0.4e1 + t3042);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = t6 * t3044 + 0.2e1 * t1549;

  t3050 = t5 * t449 * t722;
  t3058 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t445 * t722 - t3050 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t197 * t1535 - t2956 / 0.8e1 + t2963 - t2965 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t6 * t3058 + t1540 + t1555;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t3064 = t5 * t487 * t755;
  t3071 = t5 * t183 * t1602;
  t3074 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t483 * t755 - t3064 / 0.8e1 - t3038 / 0.8e1 + t3042 - 0.3e1 / 0.8e1 * t5 * t179 * t1602 - t3071 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = t6 * t3074 + t1549 + t1607;

  t3082 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t511 * t722 - t3050 / 0.4e1 + t2963);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = t6 * t3082 + 0.2e1 * t1555;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t3094 = t545 * params->a1 * t82;
  t3152 = 0.7e1 / 0.26244e5 * t138 * t3094 * t1779 * t729 * t89 - 0.14e2 / 0.6561e4 * t138 * t1447 * t2884 * params->b1 + 0.35e2 / 0.8748e4 * t138 * t3094 * t740 - 0.1211e4 / 0.26244e5 * t138 * t1447 * t746 + 0.7e1 / 0.3888e4 * t138 * t3094 * t1581 - 0.301e3 / 0.17496e5 * t138 * t1447 * t1585 + 0.28e2 / 0.2187e4 * t138 * t1466 * t2891 * t1591 - 0.112e3 / 0.2187e4 * t138 * t1475 * params->a1 * t82 * t2876 * t897 * t232 + 0.413e3 / 0.4374e4 * t138 * t1466 * t1592 + 0.77e2 / 0.26244e5 * t138 * t3094 * t731 - 0.266e3 / 0.6561e4 * t32 * t1438 * t242 + 0.1169e4 / 0.6561e4 * t32 * t1452 * t1576 - 0.175e3 / 0.729e3 * t32 * t33 * t1475 * t84 * t2516 * t232 + 0.224e3 / 0.2187e4 * t32 * t576 / t74 / t577 / t556 * t2540;
  t3157 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t535 * t755 - t3064 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t213 * t1602 + t3042 - t3071 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t71 * t3152);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = t6 * t3157 + 0.2e1 * t1607;

  t3164 = t5 * t123 * t1644 / 0.8e1;
  t3220 = 0.7e1 / 0.8748e4 * t138 * t1494 * t1611 + 0.7e1 / 0.17496e5 * t138 * t1494 * t365 * t1609 * t51 + 0.35e2 / 0.8748e4 * t138 * t620 * t1615 + 0.7e1 / 0.1944e4 * t138 * t620 * t1628 - 0.35e2 / 0.1458e4 * t138 * t1523 * t1634 - 0.7e1 / 0.243e3 * t32 * t1507 * t388 + 0.49e2 / 0.729e3 * t32 * t33 * t1530 * t46 * t1741 * sigma[0] - 0.7e1 / 0.34992e5 * t138 * t1494 * t1624 - 0.7e1 / 0.69984e5 * t138 * t1494 * t1779 * t1609 * t51 + 0.7e1 / 0.8748e4 * t138 * t620 * t1513 * t373 - 0.7e1 / 0.1458e4 * t138 * t1523 * t2684 * t387 + 0.14e2 / 0.729e3 * t138 * t1530 * params->a1 * t44 * t2669 * t897 * sigma[0] - 0.28e2 / 0.729e3 * t32 * t147 / t36 / t1736 * t1768;
  t3225 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t117 * t1644 - t3164 - 0.3e1 / 0.8e1 * t5 * t19 * t3220);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t6 * t3225 + t1648;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  t3232 = t5 * t183 * t1684 / 0.8e1;
  t3234 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t179 * t1684 - t3232);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t6 * t3234 + t1688;

  t3240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t197 * t1644 - t3164);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t6 * t3240 + t1648;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t3300 = 0.7e1 / 0.8748e4 * t138 * t1561 * t1651 + 0.7e1 / 0.17496e5 * t138 * t1561 * t365 * t1649 * t89 + 0.35e2 / 0.8748e4 * t138 * t675 * t1655 + 0.7e1 / 0.1944e4 * t138 * t675 * t1668 - 0.35e2 / 0.1458e4 * t138 * t1590 * t1674 - 0.7e1 / 0.243e3 * t32 * t1574 * t584 + 0.49e2 / 0.729e3 * t32 * t33 * t1597 * t84 * t2516 * sigma[2] - 0.7e1 / 0.34992e5 * t138 * t1561 * t1664 - 0.7e1 / 0.69984e5 * t138 * t1561 * t1779 * t1649 * t89 + 0.7e1 / 0.8748e4 * t138 * t675 * t1580 * t570 - 0.7e1 / 0.1458e4 * t138 * t1590 * t2891 * t387 + 0.14e2 / 0.729e3 * t138 * t1597 * params->a1 * t82 * t2876 * t897 * sigma[2] - 0.28e2 / 0.729e3 * t32 * t233 / t74 / t2511 * t2540;
  t3305 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t213 * t1684 - t3232 - 0.3e1 / 0.8e1 * t5 * t71 * t3300);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t6 * t3305 + t1688;

  t3307 = 0.1e1 / t378;
  t3360 = -0.7e1 / 0.46656e5 * t138 * t695 * t365 * t3307 * t51 + 0.7e1 / 0.11664e5 * t138 * t695 * params->alpha * t3307 * t51 + 0.7e1 / 0.5832e4 * t138 * t712 * t1610 * t373 + 0.7e1 / 0.1944e4 * t138 * t1633 * t697 * t883 - 0.7e1 / 0.486e3 * t32 * t33 * t1639 * t898 + 0.7e1 / 0.186624e6 * t138 * t695 * t1779 * t3307 * t51 - 0.7e1 / 0.46656e5 * t138 * t695 * t871 * t3307 * t51 - 0.7e1 / 0.23328e5 * t138 * t712 * t1623 * t373 + 0.7e1 / 0.3888e4 * t138 * t1633 * t706 * t883 - 0.7e1 / 0.972e3 * t138 * t1639 * params->a1 * t44 * t2669 * t897 + 0.7e1 / 0.486e3 * t32 * t34 / t36 / t890 * t1768;
  t3364 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t3360);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = t6 * t3364;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t3365 = 0.1e1 / t575;
  t3418 = -0.7e1 / 0.46656e5 * t138 * t728 * t365 * t3365 * t89 + 0.7e1 / 0.11664e5 * t138 * t728 * params->alpha * t3365 * t89 + 0.7e1 / 0.5832e4 * t138 * t745 * t1650 * t570 + 0.7e1 / 0.1944e4 * t138 * t1673 * t730 * t1271 - 0.7e1 / 0.486e3 * t32 * t33 * t1679 * t1285 + 0.7e1 / 0.186624e6 * t138 * t728 * t1779 * t3365 * t89 - 0.7e1 / 0.46656e5 * t138 * t728 * t871 * t3365 * t89 - 0.7e1 / 0.23328e5 * t138 * t745 * t1663 * t570 + 0.7e1 / 0.3888e4 * t138 * t1673 * t739 * t1271 - 0.7e1 / 0.972e3 * t138 * t1679 * params->a1 * t82 * t2876 * t897 + 0.7e1 / 0.486e3 * t32 * t72 / t74 / t1278 * t2540;
  t3422 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t71 * t3418);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = t6 * t3422;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

