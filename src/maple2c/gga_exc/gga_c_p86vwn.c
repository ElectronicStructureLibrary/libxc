/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_c_p86vwn.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t19, t20;
  double t21, t24, t25, t26, t27, t28, t30, t31;
  double t32, t33, t35, t36, t40, t41, t44, t46;
  double t47, t49, t53, t54, t56, t59, t60, t65;
  double t67, t68, t70, t71, t72, t73, t74, t75;
  double t76, t79, t80, t81, t82, t83, t84, t85;
  double t88, t89, t92, t95, t98, t99, t101, t102;
  double t103, t104, t105, t107, t110, t112, t114, t115;
  double t116, t117, t118, tzk0;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = 0.1e1 / t7;
  t9 = t6 * t8;
  t10 = t4 * t9;
  t11 = t10 / 0.4e1;
  t12 = sqrt(t10);
  t14 = t11 + 0.186372e1 * t12 + 0.129352e2;
  t15 = 0.1e1 / t14;
  t19 = log(t4 * t9 * t15 / 0.4e1);
  t20 = 0.310907e-1 * t19;
  t21 = t12 + 0.372744e1;
  t24 = atan(0.61519908197590802322e1 / t21);
  t25 = 0.38783294878113014393e-1 * t24;
  t26 = t12 / 0.2e1;
  t27 = t26 + 0.10498e0;
  t28 = t27 * t27;
  t30 = log(t28 * t15);
  t31 = 0.96902277115443742139e-3 * t30;
  t32 = M_PI * M_PI;
  t33 = 0.1e1 / t32;
  t35 = t11 + 0.565535e0 * t12 + 0.130045e2;
  t36 = 0.1e1 / t35;
  t40 = log(t4 * t9 * t36 / 0.4e1);
  t41 = t12 + 0.113107e1;
  t44 = atan(0.71231089178181179908e1 / t41);
  t46 = t26 + 0.47584e-2;
  t47 = t46 * t46;
  t49 = log(t47 * t36);
  t53 = 0.1e1 <= p->zeta_threshold;
  t54 = POW_1_3(p->zeta_threshold);
  t56 = my_piecewise3(t53, t54 * p->zeta_threshold, 1);
  t59 = M_CBRT2;
  t60 = t59 - 0.1e1;
  t65 = 0.9e1 * t56 - 0.9e1;
  t67 = t33 * (t40 + 0.317708004743941464e0 * t44 + 0.41403379428206274608e-3 * t49) * t65 / 0.24e2;
  t68 = rho[0] * rho[0];
  t70 = 0.1e1 / t7 / t68;
  t71 = sigma[0] * t70;
  t72 = params->aa + params->bb;
  t73 = params->ftilde * t72;
  t74 = params->malpha * t1;
  t75 = t3 * t6;
  t76 = t75 * t8;
  t79 = t1 * t1;
  t80 = params->mbeta * t79;
  t81 = t3 * t3;
  t82 = t81 * t5;
  t83 = t7 * t7;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t88 = params->bb + t74 * t76 / 0.4e1 + t80 * t85 / 0.4e1;
  t89 = params->mgamma * t1;
  t92 = params->mdelta * t79;
  t95 = 0.1e1 / rho[0];
  t98 = 0.1e1 + t89 * t76 / 0.4e1 + t92 * t85 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t95;
  t99 = 0.1e1 / t98;
  t101 = t88 * t99 + params->aa;
  t102 = 0.1e1 / t101;
  t103 = sqrt(sigma[0]);
  t104 = t102 * t103;
  t105 = pow(rho[0], 0.1e1 / 0.6e1);
  t107 = 0.1e1 / t105 / rho[0];
  t110 = exp(-t73 * t104 * t107);
  t112 = t54 * t54;
  t114 = my_piecewise3(t53, t112 * p->zeta_threshold, 1);
  t115 = sqrt(t114);
  t116 = 0.1e1 / t115;
  t117 = t110 * t101 * t116;
  t118 = t71 * t117;
  tzk0 = t20 + t25 + t31 - t67 + t118;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t19, t20;
  double t21, t24, t25, t26, t27, t28, t30, t31;
  double t32, t33, t35, t36, t40, t41, t44, t46;
  double t47, t49, t53, t54, t56, t59, t60, t65;
  double t67, t68, t70, t71, t72, t73, t74, t75;
  double t76, t79, t80, t81, t82, t83, t84, t85;
  double t88, t89, t92, t95, t98, t99, t101, t102;
  double t103, t104, t105, t107, t110, t112, t114, t115;
  double t116, t117, t118, tzk0;

  double t120, t121, t125, t126, t127, t128, t129, t130;
  double t131, t132, t133, t134, t136, t142, t143, t144;
  double t145, t146, t148, t149, t151, t153, t154, t157;
  double t159, t160, t163, t165, t166, t167, t168, t173;
  double t174, t175, t177, t183, t184, t187, t188, t190;
  double t192, t193, t198, t199, t202, t204, t205, t206;
  double t211, t213, t215, t216, t217, t219, t220, t221;
  double t222, t226, t227, t230, t232, t233, t234, t242;
  double t244, t248, t252, t253, t254, t256, t257, tvrho0;
  double t260, t261, t262, t263, t265, t266, t267, t269;
  double t271, tvsigma0;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = 0.1e1 / t7;
  t9 = t6 * t8;
  t10 = t4 * t9;
  t11 = t10 / 0.4e1;
  t12 = sqrt(t10);
  t14 = t11 + 0.186372e1 * t12 + 0.129352e2;
  t15 = 0.1e1 / t14;
  t19 = log(t4 * t9 * t15 / 0.4e1);
  t20 = 0.310907e-1 * t19;
  t21 = t12 + 0.372744e1;
  t24 = atan(0.61519908197590802322e1 / t21);
  t25 = 0.38783294878113014393e-1 * t24;
  t26 = t12 / 0.2e1;
  t27 = t26 + 0.10498e0;
  t28 = t27 * t27;
  t30 = log(t28 * t15);
  t31 = 0.96902277115443742139e-3 * t30;
  t32 = M_PI * M_PI;
  t33 = 0.1e1 / t32;
  t35 = t11 + 0.565535e0 * t12 + 0.130045e2;
  t36 = 0.1e1 / t35;
  t40 = log(t4 * t9 * t36 / 0.4e1);
  t41 = t12 + 0.113107e1;
  t44 = atan(0.71231089178181179908e1 / t41);
  t46 = t26 + 0.47584e-2;
  t47 = t46 * t46;
  t49 = log(t47 * t36);
  t53 = 0.1e1 <= p->zeta_threshold;
  t54 = POW_1_3(p->zeta_threshold);
  t56 = my_piecewise3(t53, t54 * p->zeta_threshold, 1);
  t59 = M_CBRT2;
  t60 = t59 - 0.1e1;
  t65 = 0.9e1 * t56 - 0.9e1;
  t67 = t33 * (t40 + 0.317708004743941464e0 * t44 + 0.41403379428206274608e-3 * t49) * t65 / 0.24e2;
  t68 = rho[0] * rho[0];
  t70 = 0.1e1 / t7 / t68;
  t71 = sigma[0] * t70;
  t72 = params->aa + params->bb;
  t73 = params->ftilde * t72;
  t74 = params->malpha * t1;
  t75 = t3 * t6;
  t76 = t75 * t8;
  t79 = t1 * t1;
  t80 = params->mbeta * t79;
  t81 = t3 * t3;
  t82 = t81 * t5;
  t83 = t7 * t7;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t88 = params->bb + t74 * t76 / 0.4e1 + t80 * t85 / 0.4e1;
  t89 = params->mgamma * t1;
  t92 = params->mdelta * t79;
  t95 = 0.1e1 / rho[0];
  t98 = 0.1e1 + t89 * t76 / 0.4e1 + t92 * t85 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t95;
  t99 = 0.1e1 / t98;
  t101 = t88 * t99 + params->aa;
  t102 = 0.1e1 / t101;
  t103 = sqrt(sigma[0]);
  t104 = t102 * t103;
  t105 = pow(rho[0], 0.1e1 / 0.6e1);
  t107 = 0.1e1 / t105 / rho[0];
  t110 = exp(-t73 * t104 * t107);
  t112 = t54 * t54;
  t114 = my_piecewise3(t53, t112 * p->zeta_threshold, 1);
  t115 = sqrt(t114);
  t116 = 0.1e1 / t115;
  t117 = t110 * t101 * t116;
  t118 = t71 * t117;
  tzk0 = t20 + t25 + t31 - t67 + t118;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = 0.1e1 / t7 / rho[0];
  t121 = t6 * t120;
  t125 = t4 * t6;
  t126 = t14 * t14;
  t127 = 0.1e1 / t126;
  t128 = t8 * t127;
  t129 = t4 * t121;
  t130 = t129 / 0.12e2;
  t131 = 0.1e1 / t12;
  t132 = t131 * t1;
  t133 = t75 * t120;
  t134 = t132 * t133;
  t136 = -t130 - 0.31062e0 * t134;
  t142 = 0.1e1 / t3;
  t143 = (-t4 * t121 * t15 / 0.12e2 - t125 * t128 * t136 / 0.4e1) * t79 * t142;
  t144 = t5 * t7;
  t145 = t144 * t14;
  t146 = t143 * t145;
  t148 = t21 * t21;
  t149 = 0.1e1 / t148;
  t151 = t149 * t131 * t1;
  t153 = 0.378469910464e2 * t149 + 0.1e1;
  t154 = 0.1e1 / t153;
  t157 = t151 * t75 * t120 * t154;
  t159 = t27 * t15;
  t160 = t159 * t131;
  t163 = t28 * t127;
  t165 = -t160 * t129 / 0.6e1 - t163 * t136;
  t166 = 0.1e1 / t28;
  t167 = t165 * t166;
  t168 = t167 * t14;
  t173 = t35 * t35;
  t174 = 0.1e1 / t173;
  t175 = t8 * t174;
  t177 = -t130 - 0.94255833333333333334e-1 * t134;
  t183 = (-t4 * t121 * t36 / 0.12e2 - t125 * t175 * t177 / 0.4e1) * t79 * t142;
  t184 = t144 * t35;
  t187 = t41 * t41;
  t188 = 0.1e1 / t187;
  t190 = t188 * t131 * t1;
  t192 = 0.50738680655100000001e2 * t188 + 0.1e1;
  t193 = 0.1e1 / t192;
  t198 = t46 * t36;
  t199 = t198 * t131;
  t202 = t47 * t174;
  t204 = -t199 * t129 / 0.6e1 - t202 * t177;
  t205 = 0.1e1 / t47;
  t206 = t204 * t205;
  t211 = t33 * (t183 * t184 / 0.3e1 + 0.37717812030896172975e0 * t190 * t75 * t120 * t193 + 0.41403379428206274608e-3 * t206 * t35) * t65;
  t213 = t68 * rho[0];
  t215 = 0.1e1 / t7 / t213;
  t216 = sigma[0] * t215;
  t217 = t216 * t117;
  t219 = t101 * t101;
  t220 = 0.1e1 / t219;
  t221 = t73 * t220;
  t222 = t103 * t107;
  t226 = 0.1e1 / t83 / rho[0];
  t227 = t82 * t226;
  t230 = -t74 * t133 / 0.12e2 - t80 * t227 / 0.6e1;
  t232 = t98 * t98;
  t233 = 0.1e1 / t232;
  t234 = t88 * t233;
  t242 = -t89 * t133 / 0.12e2 - t92 * t227 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta / t68;
  t244 = t230 * t99 - t234 * t242;
  t248 = 0.1e1 / t105 / t68;
  t252 = t221 * t222 * t244 + 0.7e1 / 0.6e1 * t73 * t104 * t248;
  t253 = t71 * t252;
  t254 = t253 * t117;
  t256 = t110 * t244 * t116;
  t257 = t71 * t256;
  tvrho0 = t20 + t25 + t31 - t67 + t118 + rho[0] * (0.10363566666666666667e-1 * t146 + 0.39765745675026770179e-1 * t157 + 0.96902277115443742139e-3 * t168 - t211 / 0.24e2 - 0.7e1 / 0.3e1 * t217 + t254 + t257);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = t70 * t110;
  t261 = t101 * t116;
  t262 = t260 * t261;
  t263 = sqrt(rho[0]);
  t265 = 0.1e1 / t263 / t213;
  t266 = t103 * t265;
  t267 = t266 * params->ftilde;
  t269 = t72 * t110 * t116;
  t271 = t267 * t269 / 0.2e1;
  tvsigma0 = rho[0] * (t262 - t271);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t19, t20;
  double t21, t24, t25, t26, t27, t28, t30, t31;
  double t32, t33, t35, t36, t40, t41, t44, t46;
  double t47, t49, t53, t54, t56, t59, t60, t65;
  double t67, t68, t70, t71, t72, t73, t74, t75;
  double t76, t79, t80, t81, t82, t83, t84, t85;
  double t88, t89, t92, t95, t98, t99, t101, t102;
  double t103, t104, t105, t107, t110, t112, t114, t115;
  double t116, t117, t118, tzk0;

  double t120, t121, t125, t126, t127, t128, t129, t130;
  double t131, t132, t133, t134, t136, t142, t143, t144;
  double t145, t146, t148, t149, t151, t153, t154, t157;
  double t159, t160, t163, t165, t166, t167, t168, t173;
  double t174, t175, t177, t183, t184, t187, t188, t190;
  double t192, t193, t198, t199, t202, t204, t205, t206;
  double t211, t213, t215, t216, t217, t219, t220, t221;
  double t222, t226, t227, t230, t232, t233, t234, t242;
  double t244, t248, t252, t253, t254, t256, t257, tvrho0;
  double t260, t261, t262, t263, t265, t266, t267, t269;
  double t271, tvsigma0;

  double t280, t282, t284, t289, t290, t291, t295, t296;
  double t298, t299, t301, t302, t303, t305, t306, t308;
  double t314, t315, t317, t318, t319, t321, t322, t324;
  double t325, t326, t327, t329, t332, t335, t339, t341;
  double t343, t344, t345, t346, t347, t349, t352, t353;
  double t354, t358, t359, t360, t361, t366, t370, t371;
  double t372, t375, t376, t377, t378, t379, t381, t384;
  double t386, t391, t392, t393, t399, t405, t408, t411;
  double t414, t415, t416, t417, t422, t431, t433, t434;
  double t435, t436, t437, t442, t443, t444, t448, t453;
  double t457, t458, t462, t463, t464, t465, t472, t474;
  double t476, t477, t478, t480, t481, t483, t486, t487;
  double t488, t492, t500, t502, t506, t507, t508, t518;
  double t520, t524, t528, t529, t530, t531, t532, t533;
  double t534, t537, t538, t539, tv2rho20, t541, t542, t544;
  double t545, t546, t547, t549, t551, t552, t555, t556;
  double t557, tv2rhosigma0, t562, t563, t564, t565, t567, t569;
  double t570, t571, t572, t573, t575, t577, tv2sigma20;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = 0.1e1 / t7;
  t9 = t6 * t8;
  t10 = t4 * t9;
  t11 = t10 / 0.4e1;
  t12 = sqrt(t10);
  t14 = t11 + 0.186372e1 * t12 + 0.129352e2;
  t15 = 0.1e1 / t14;
  t19 = log(t4 * t9 * t15 / 0.4e1);
  t20 = 0.310907e-1 * t19;
  t21 = t12 + 0.372744e1;
  t24 = atan(0.61519908197590802322e1 / t21);
  t25 = 0.38783294878113014393e-1 * t24;
  t26 = t12 / 0.2e1;
  t27 = t26 + 0.10498e0;
  t28 = t27 * t27;
  t30 = log(t28 * t15);
  t31 = 0.96902277115443742139e-3 * t30;
  t32 = M_PI * M_PI;
  t33 = 0.1e1 / t32;
  t35 = t11 + 0.565535e0 * t12 + 0.130045e2;
  t36 = 0.1e1 / t35;
  t40 = log(t4 * t9 * t36 / 0.4e1);
  t41 = t12 + 0.113107e1;
  t44 = atan(0.71231089178181179908e1 / t41);
  t46 = t26 + 0.47584e-2;
  t47 = t46 * t46;
  t49 = log(t47 * t36);
  t53 = 0.1e1 <= p->zeta_threshold;
  t54 = POW_1_3(p->zeta_threshold);
  t56 = my_piecewise3(t53, t54 * p->zeta_threshold, 1);
  t59 = M_CBRT2;
  t60 = t59 - 0.1e1;
  t65 = 0.9e1 * t56 - 0.9e1;
  t67 = t33 * (t40 + 0.317708004743941464e0 * t44 + 0.41403379428206274608e-3 * t49) * t65 / 0.24e2;
  t68 = rho[0] * rho[0];
  t70 = 0.1e1 / t7 / t68;
  t71 = sigma[0] * t70;
  t72 = params->aa + params->bb;
  t73 = params->ftilde * t72;
  t74 = params->malpha * t1;
  t75 = t3 * t6;
  t76 = t75 * t8;
  t79 = t1 * t1;
  t80 = params->mbeta * t79;
  t81 = t3 * t3;
  t82 = t81 * t5;
  t83 = t7 * t7;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t88 = params->bb + t74 * t76 / 0.4e1 + t80 * t85 / 0.4e1;
  t89 = params->mgamma * t1;
  t92 = params->mdelta * t79;
  t95 = 0.1e1 / rho[0];
  t98 = 0.1e1 + t89 * t76 / 0.4e1 + t92 * t85 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t95;
  t99 = 0.1e1 / t98;
  t101 = t88 * t99 + params->aa;
  t102 = 0.1e1 / t101;
  t103 = sqrt(sigma[0]);
  t104 = t102 * t103;
  t105 = pow(rho[0], 0.1e1 / 0.6e1);
  t107 = 0.1e1 / t105 / rho[0];
  t110 = exp(-t73 * t104 * t107);
  t112 = t54 * t54;
  t114 = my_piecewise3(t53, t112 * p->zeta_threshold, 1);
  t115 = sqrt(t114);
  t116 = 0.1e1 / t115;
  t117 = t110 * t101 * t116;
  t118 = t71 * t117;
  tzk0 = t20 + t25 + t31 - t67 + t118;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = 0.1e1 / t7 / rho[0];
  t121 = t6 * t120;
  t125 = t4 * t6;
  t126 = t14 * t14;
  t127 = 0.1e1 / t126;
  t128 = t8 * t127;
  t129 = t4 * t121;
  t130 = t129 / 0.12e2;
  t131 = 0.1e1 / t12;
  t132 = t131 * t1;
  t133 = t75 * t120;
  t134 = t132 * t133;
  t136 = -t130 - 0.31062e0 * t134;
  t142 = 0.1e1 / t3;
  t143 = (-t4 * t121 * t15 / 0.12e2 - t125 * t128 * t136 / 0.4e1) * t79 * t142;
  t144 = t5 * t7;
  t145 = t144 * t14;
  t146 = t143 * t145;
  t148 = t21 * t21;
  t149 = 0.1e1 / t148;
  t151 = t149 * t131 * t1;
  t153 = 0.378469910464e2 * t149 + 0.1e1;
  t154 = 0.1e1 / t153;
  t157 = t151 * t75 * t120 * t154;
  t159 = t27 * t15;
  t160 = t159 * t131;
  t163 = t28 * t127;
  t165 = -t160 * t129 / 0.6e1 - t163 * t136;
  t166 = 0.1e1 / t28;
  t167 = t165 * t166;
  t168 = t167 * t14;
  t173 = t35 * t35;
  t174 = 0.1e1 / t173;
  t175 = t8 * t174;
  t177 = -t130 - 0.94255833333333333334e-1 * t134;
  t183 = (-t4 * t121 * t36 / 0.12e2 - t125 * t175 * t177 / 0.4e1) * t79 * t142;
  t184 = t144 * t35;
  t187 = t41 * t41;
  t188 = 0.1e1 / t187;
  t190 = t188 * t131 * t1;
  t192 = 0.50738680655100000001e2 * t188 + 0.1e1;
  t193 = 0.1e1 / t192;
  t198 = t46 * t36;
  t199 = t198 * t131;
  t202 = t47 * t174;
  t204 = -t199 * t129 / 0.6e1 - t202 * t177;
  t205 = 0.1e1 / t47;
  t206 = t204 * t205;
  t211 = t33 * (t183 * t184 / 0.3e1 + 0.37717812030896172975e0 * t190 * t75 * t120 * t193 + 0.41403379428206274608e-3 * t206 * t35) * t65;
  t213 = t68 * rho[0];
  t215 = 0.1e1 / t7 / t213;
  t216 = sigma[0] * t215;
  t217 = t216 * t117;
  t219 = t101 * t101;
  t220 = 0.1e1 / t219;
  t221 = t73 * t220;
  t222 = t103 * t107;
  t226 = 0.1e1 / t83 / rho[0];
  t227 = t82 * t226;
  t230 = -t74 * t133 / 0.12e2 - t80 * t227 / 0.6e1;
  t232 = t98 * t98;
  t233 = 0.1e1 / t232;
  t234 = t88 * t233;
  t242 = -t89 * t133 / 0.12e2 - t92 * t227 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta / t68;
  t244 = t230 * t99 - t234 * t242;
  t248 = 0.1e1 / t105 / t68;
  t252 = t221 * t222 * t244 + 0.7e1 / 0.6e1 * t73 * t104 * t248;
  t253 = t71 * t252;
  t254 = t253 * t117;
  t256 = t110 * t244 * t116;
  t257 = t71 * t256;
  tvrho0 = t20 + t25 + t31 - t67 + t118 + rho[0] * (0.10363566666666666667e-1 * t146 + 0.39765745675026770179e-1 * t157 + 0.96902277115443742139e-3 * t168 - t211 / 0.24e2 - 0.7e1 / 0.3e1 * t217 + t254 + t257);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = t70 * t110;
  t261 = t101 * t116;
  t262 = t260 * t261;
  t263 = sqrt(rho[0]);
  t265 = 0.1e1 / t263 / t213;
  t266 = t103 * t265;
  t267 = t266 * params->ftilde;
  t269 = t72 * t110 * t116;
  t271 = t267 * t269 / 0.2e1;
  tvsigma0 = rho[0] * (t262 - t271);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t280 = t6 * t70;
  t282 = t4 * t280 * t15;
  t284 = t120 * t127;
  t289 = 0.1e1 / t126 / t14;
  t290 = t8 * t289;
  t291 = t136 * t136;
  t295 = t4 * t280;
  t296 = t295 / 0.9e1;
  t298 = 0.1e1 / t12 / t10;
  t299 = t298 * t79;
  t301 = 0.1e1 / t83 / t68;
  t302 = t82 * t301;
  t303 = t299 * t302;
  t305 = t75 * t70;
  t306 = t132 * t305;
  t308 = t296 - 0.20708e0 * t303 + 0.41416e0 * t306;
  t314 = (t282 / 0.9e1 + t125 * t284 * t136 / 0.6e1 + t125 * t290 * t291 / 0.2e1 - t125 * t128 * t308 / 0.4e1) * t79 * t142;
  t315 = t314 * t145;
  t317 = t5 * t84;
  t318 = t317 * t14;
  t319 = t143 * t318;
  t321 = t144 * t136;
  t322 = t143 * t321;
  t324 = t148 * t21;
  t325 = 0.1e1 / t324;
  t326 = t325 * t1;
  t327 = t326 * t3;
  t329 = t327 * t280 * t154;
  t332 = t149 * t298 * t79;
  t335 = t332 * t82 * t301 * t154;
  t339 = t151 * t75 * t70 * t154;
  t341 = t148 * t148;
  t343 = 0.1e1 / t341 / t21;
  t344 = t343 * t1;
  t345 = t344 * t3;
  t346 = t153 * t153;
  t347 = 0.1e1 / t346;
  t349 = t345 * t280 * t347;
  t352 = t27 * t127;
  t353 = t352 * t132;
  t354 = t120 * t136;
  t358 = t159 * t298;
  t359 = t79 * t81;
  t360 = t5 * t301;
  t361 = t359 * t360;
  t366 = t28 * t289;
  t370 = t282 / 0.72e2 + t353 * t75 * t354 / 0.3e1 - t358 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t160 * t295 + 0.2e1 * t366 * t291 - t163 * t308;
  t371 = t370 * t166;
  t372 = t371 * t14;
  t375 = 0.1e1 / t28 / t27;
  t376 = t165 * t375;
  t377 = t14 * t131;
  t378 = t376 * t377;
  t379 = t378 * t129;
  t381 = t167 * t136;
  t384 = t4 * t280 * t36;
  t386 = t120 * t174;
  t391 = 0.1e1 / t173 / t35;
  t392 = t8 * t391;
  t393 = t177 * t177;
  t399 = t296 - 0.62837222222222222223e-1 * t303 + 0.12567444444444444445e0 * t306;
  t405 = (t384 / 0.9e1 + t125 * t386 * t177 / 0.6e1 + t125 * t392 * t393 / 0.2e1 - t125 * t175 * t399 / 0.4e1) * t79 * t142;
  t408 = t317 * t35;
  t411 = t144 * t177;
  t414 = t187 * t41;
  t415 = 0.1e1 / t414;
  t416 = t415 * t1;
  t417 = t416 * t3;
  t422 = t188 * t298 * t79;
  t431 = t187 * t187;
  t433 = 0.1e1 / t431 / t41;
  t434 = t433 * t1;
  t435 = t434 * t3;
  t436 = t192 * t192;
  t437 = 0.1e1 / t436;
  t442 = t46 * t174;
  t443 = t442 * t132;
  t444 = t120 * t177;
  t448 = t198 * t298;
  t453 = t47 * t391;
  t457 = t384 / 0.72e2 + t443 * t75 * t444 / 0.3e1 - t448 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t199 * t295 + 0.2e1 * t453 * t393 - t202 * t399;
  t458 = t457 * t205;
  t462 = 0.1e1 / t47 / t46;
  t463 = t204 * t462;
  t464 = t35 * t131;
  t465 = t463 * t464;
  t472 = t33 * (t405 * t184 / 0.3e1 + t183 * t408 / 0.9e1 + t183 * t411 / 0.3e1 + 0.12572604010298724325e0 * t417 * t280 * t193 + 0.2514520802059744865e0 * t422 * t82 * t301 * t193 - 0.502904160411948973e0 * t190 * t75 * t70 * t193 - 0.63791733988157656508e1 * t435 * t280 * t437 + 0.41403379428206274608e-3 * t458 * t35 + 0.69005632380343791013e-4 * t465 * t129 + 0.41403379428206274608e-3 * t206 * t177) * t65;
  t474 = t68 * t68;
  t476 = 0.1e1 / t7 / t474;
  t477 = sigma[0] * t476;
  t478 = t477 * t117;
  t480 = t216 * t252;
  t481 = t480 * t117;
  t483 = t216 * t256;
  t486 = 0.1e1 / t219 / t101;
  t487 = t73 * t486;
  t488 = t244 * t244;
  t492 = t103 * t248;
  t500 = t74 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t80 * t302;
  t502 = t230 * t233;
  t506 = 0.1e1 / t232 / t98;
  t507 = t88 * t506;
  t508 = t242 * t242;
  t518 = t89 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t92 * t302 + 0.4774648292756860073e4 * params->mbeta / t213;
  t520 = -t234 * t518 - 0.2e1 * t242 * t502 + t500 * t99 + 0.2e1 * t507 * t508;
  t524 = 0.1e1 / t105 / t213;
  t528 = -0.2e1 * t487 * t222 * t488 - 0.7e1 / 0.3e1 * t221 * t492 * t244 + t221 * t222 * t520 - 0.91e2 / 0.36e2 * t73 * t104 * t524;
  t529 = t71 * t528;
  t530 = t529 * t117;
  t531 = t252 * t252;
  t532 = t71 * t531;
  t533 = t532 * t117;
  t534 = t253 * t256;
  t537 = t110 * t520 * t116;
  t538 = t71 * t537;
  t539 = 0.10363566666666666667e-1 * t315 + 0.34545222222222222223e-2 * t319 + 0.10363566666666666667e-1 * t322 + 0.13255248558342256726e-1 * t329 + 0.26510497116684513453e-1 * t335 - 0.53020994233369026905e-1 * t339 - 0.50167127350538589834e0 * t349 + 0.96902277115443742139e-3 * t372 + 0.1615037951924062369e-3 * t379 + 0.96902277115443742139e-3 * t381 - t472 / 0.24e2 + 0.7e2 / 0.9e1 * t478 - 0.14e2 / 0.3e1 * t481 - 0.14e2 / 0.3e1 * t483 + t530 + t533 + 0.2e1 * t534 + t538;
  tv2rho20 = 0.20727133333333333334e-1 * t146 + 0.79531491350053540358e-1 * t157 + 0.19380455423088748428e-2 * t168 - t211 / 0.12e2 - 0.14e2 / 0.3e1 * t217 + 0.2e1 * t254 + 0.2e1 * t257 + rho[0] * t539;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t215 * t110;
  t542 = t541 * t261;
  t544 = t70 * t252;
  t545 = t544 * t117;
  t546 = t244 * t116;
  t547 = t260 * t546;
  t549 = 0.1e1 / t263 / t474;
  t551 = t103 * t549 * params->ftilde;
  t552 = t551 * t269;
  t555 = t110 * t116;
  t556 = t72 * t252 * t555;
  t557 = t267 * t556;
  tv2rhosigma0 = t262 - t271 + rho[0] * (-0.7e1 / 0.3e1 * t542 + t545 + t547 + 0.7e1 / 0.4e1 * t552 - t557 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t562 = t265 * params->ftilde * t72;
  t563 = 0.1e1 / t103;
  t564 = t563 * t110;
  t565 = t564 * t116;
  t567 = 0.3e1 / 0.4e1 * t562 * t565;
  t569 = 0.1e1 / t83 / t474;
  t570 = params->ftilde * params->ftilde;
  t571 = t569 * t570;
  t572 = t72 * t72;
  t573 = t571 * t572;
  t575 = t102 * t110 * t116;
  t577 = t573 * t575 / 0.4e1;
  tv2sigma20 = rho[0] * (-t567 + t577);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t19, t20;
  double t21, t24, t25, t26, t27, t28, t30, t31;
  double t32, t33, t35, t36, t40, t41, t44, t46;
  double t47, t49, t53, t54, t56, t59, t60, t65;
  double t67, t68, t70, t71, t72, t73, t74, t75;
  double t76, t79, t80, t81, t82, t83, t84, t85;
  double t88, t89, t92, t95, t98, t99, t101, t102;
  double t103, t104, t105, t107, t110, t112, t114, t115;
  double t116, t117, t118, tzk0;

  double t120, t121, t125, t126, t127, t128, t129, t130;
  double t131, t132, t133, t134, t136, t142, t143, t144;
  double t145, t146, t148, t149, t151, t153, t154, t157;
  double t159, t160, t163, t165, t166, t167, t168, t173;
  double t174, t175, t177, t183, t184, t187, t188, t190;
  double t192, t193, t198, t199, t202, t204, t205, t206;
  double t211, t213, t215, t216, t217, t219, t220, t221;
  double t222, t226, t227, t230, t232, t233, t234, t242;
  double t244, t248, t252, t253, t254, t256, t257, tvrho0;
  double t260, t261, t262, t263, t265, t266, t267, t269;
  double t271, tvsigma0;

  double t280, t282, t284, t289, t290, t291, t295, t296;
  double t298, t299, t301, t302, t303, t305, t306, t308;
  double t314, t315, t317, t318, t319, t321, t322, t324;
  double t325, t326, t327, t329, t332, t335, t339, t341;
  double t343, t344, t345, t346, t347, t349, t352, t353;
  double t354, t358, t359, t360, t361, t366, t370, t371;
  double t372, t375, t376, t377, t378, t379, t381, t384;
  double t386, t391, t392, t393, t399, t405, t408, t411;
  double t414, t415, t416, t417, t422, t431, t433, t434;
  double t435, t436, t437, t442, t443, t444, t448, t453;
  double t457, t458, t462, t463, t464, t465, t472, t474;
  double t476, t477, t478, t480, t481, t483, t486, t487;
  double t488, t492, t500, t502, t506, t507, t508, t518;
  double t520, t524, t528, t529, t530, t531, t532, t533;
  double t534, t537, t538, t539, tv2rho20, t541, t542, t544;
  double t545, t546, t547, t549, t551, t552, t555, t556;
  double t557, tv2rhosigma0, t562, t563, t564, t565, t567, t569;
  double t570, t571, t572, t573, t575, t577, tv2sigma20;

  double t579, t581, t582, t583, t585, t587, t591, t592;
  double t595, t597, t600, t605, t606, t607, t608, t611;
  double t618, t621, t623, t625, t626, t627, t629, t631;
  double t633, t635, t636, t640, t653, t655, t656, t663;
  double t664, t665, t668, t669, t672, t675, t676, t677;
  double t678, t681, t684, t686, t688, t690, t692, t693;
  double t694, t696, t698, t700, t701, t702, t704, t705;
  double t706, t708, t709, t710, t712, t716, t720, t722;
  double t723, t724, t726, t727, t728, t729, t731, t734;
  double t735, t736, t737, t739, t741, t742, t744, t746;
  double t747, t748, t749, t751, t752, t754, t756, t757;
  double t758, t759, t760, t762, t763, t764, t765, t766;
  double t768, t769, t771, t773, t775, t777, t778, t780;
  double t781, t783, t785, t787, t788, t795, t799, t809;
  double t813, t814, t815, t816, t817, t818, t819, t822;
  double t825, t828, t831, t836, t837, t842, t844, t846;
  double t848, t855, t856, t857, t858, t862, t869, t875;
  double t880, t881, t882, t883, t885, t886, t892, t893;
  double t897, t919, t925, t926, t931, t942, t943, t946;
  double t947, t950, t951, t956, t957, t963, t964, t965;
  double t966, t971, t972, t973, t974, t978, t979, t983;
  double t986, t988, t990, t992, t993, t994, t996, t998;
  double t999, t1001, t1002, t1004, t1008, t1015, t1027, t1028;
  double t1030, t1032, t1033, t1036, t1038, tv3rho30, t1063, t1064;
  double t1066, t1067, t1069, t1071, t1072, t1073, t1074, t1075;
  double t1077, t1078, t1080, t1082, t1083, t1085, t1088, t1089;
  double t1092, t1093, t1095, tv3rho2sigma0, t1098, t1099, t1102, t1103;
  double t1108, t1109, t1111, t1112, t1113, t1116, t1117, tv3rhosigma20;
  double t1122, t1124, t1126, t1127, t1129, t1131, t1132, t1133;
  double t1134, t1137, t1138, t1139, t1140, t1142, t1144, tv3sigma30;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = 0.1e1 / t7;
  t9 = t6 * t8;
  t10 = t4 * t9;
  t11 = t10 / 0.4e1;
  t12 = sqrt(t10);
  t14 = t11 + 0.186372e1 * t12 + 0.129352e2;
  t15 = 0.1e1 / t14;
  t19 = log(t4 * t9 * t15 / 0.4e1);
  t20 = 0.310907e-1 * t19;
  t21 = t12 + 0.372744e1;
  t24 = atan(0.61519908197590802322e1 / t21);
  t25 = 0.38783294878113014393e-1 * t24;
  t26 = t12 / 0.2e1;
  t27 = t26 + 0.10498e0;
  t28 = t27 * t27;
  t30 = log(t28 * t15);
  t31 = 0.96902277115443742139e-3 * t30;
  t32 = M_PI * M_PI;
  t33 = 0.1e1 / t32;
  t35 = t11 + 0.565535e0 * t12 + 0.130045e2;
  t36 = 0.1e1 / t35;
  t40 = log(t4 * t9 * t36 / 0.4e1);
  t41 = t12 + 0.113107e1;
  t44 = atan(0.71231089178181179908e1 / t41);
  t46 = t26 + 0.47584e-2;
  t47 = t46 * t46;
  t49 = log(t47 * t36);
  t53 = 0.1e1 <= p->zeta_threshold;
  t54 = POW_1_3(p->zeta_threshold);
  t56 = my_piecewise3(t53, t54 * p->zeta_threshold, 1);
  t59 = M_CBRT2;
  t60 = t59 - 0.1e1;
  t65 = 0.9e1 * t56 - 0.9e1;
  t67 = t33 * (t40 + 0.317708004743941464e0 * t44 + 0.41403379428206274608e-3 * t49) * t65 / 0.24e2;
  t68 = rho[0] * rho[0];
  t70 = 0.1e1 / t7 / t68;
  t71 = sigma[0] * t70;
  t72 = params->aa + params->bb;
  t73 = params->ftilde * t72;
  t74 = params->malpha * t1;
  t75 = t3 * t6;
  t76 = t75 * t8;
  t79 = t1 * t1;
  t80 = params->mbeta * t79;
  t81 = t3 * t3;
  t82 = t81 * t5;
  t83 = t7 * t7;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t88 = params->bb + t74 * t76 / 0.4e1 + t80 * t85 / 0.4e1;
  t89 = params->mgamma * t1;
  t92 = params->mdelta * t79;
  t95 = 0.1e1 / rho[0];
  t98 = 0.1e1 + t89 * t76 / 0.4e1 + t92 * t85 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t95;
  t99 = 0.1e1 / t98;
  t101 = t88 * t99 + params->aa;
  t102 = 0.1e1 / t101;
  t103 = sqrt(sigma[0]);
  t104 = t102 * t103;
  t105 = pow(rho[0], 0.1e1 / 0.6e1);
  t107 = 0.1e1 / t105 / rho[0];
  t110 = exp(-t73 * t104 * t107);
  t112 = t54 * t54;
  t114 = my_piecewise3(t53, t112 * p->zeta_threshold, 1);
  t115 = sqrt(t114);
  t116 = 0.1e1 / t115;
  t117 = t110 * t101 * t116;
  t118 = t71 * t117;
  tzk0 = t20 + t25 + t31 - t67 + t118;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = 0.1e1 / t7 / rho[0];
  t121 = t6 * t120;
  t125 = t4 * t6;
  t126 = t14 * t14;
  t127 = 0.1e1 / t126;
  t128 = t8 * t127;
  t129 = t4 * t121;
  t130 = t129 / 0.12e2;
  t131 = 0.1e1 / t12;
  t132 = t131 * t1;
  t133 = t75 * t120;
  t134 = t132 * t133;
  t136 = -t130 - 0.31062e0 * t134;
  t142 = 0.1e1 / t3;
  t143 = (-t4 * t121 * t15 / 0.12e2 - t125 * t128 * t136 / 0.4e1) * t79 * t142;
  t144 = t5 * t7;
  t145 = t144 * t14;
  t146 = t143 * t145;
  t148 = t21 * t21;
  t149 = 0.1e1 / t148;
  t151 = t149 * t131 * t1;
  t153 = 0.378469910464e2 * t149 + 0.1e1;
  t154 = 0.1e1 / t153;
  t157 = t151 * t75 * t120 * t154;
  t159 = t27 * t15;
  t160 = t159 * t131;
  t163 = t28 * t127;
  t165 = -t160 * t129 / 0.6e1 - t163 * t136;
  t166 = 0.1e1 / t28;
  t167 = t165 * t166;
  t168 = t167 * t14;
  t173 = t35 * t35;
  t174 = 0.1e1 / t173;
  t175 = t8 * t174;
  t177 = -t130 - 0.94255833333333333334e-1 * t134;
  t183 = (-t4 * t121 * t36 / 0.12e2 - t125 * t175 * t177 / 0.4e1) * t79 * t142;
  t184 = t144 * t35;
  t187 = t41 * t41;
  t188 = 0.1e1 / t187;
  t190 = t188 * t131 * t1;
  t192 = 0.50738680655100000001e2 * t188 + 0.1e1;
  t193 = 0.1e1 / t192;
  t198 = t46 * t36;
  t199 = t198 * t131;
  t202 = t47 * t174;
  t204 = -t199 * t129 / 0.6e1 - t202 * t177;
  t205 = 0.1e1 / t47;
  t206 = t204 * t205;
  t211 = t33 * (t183 * t184 / 0.3e1 + 0.37717812030896172975e0 * t190 * t75 * t120 * t193 + 0.41403379428206274608e-3 * t206 * t35) * t65;
  t213 = t68 * rho[0];
  t215 = 0.1e1 / t7 / t213;
  t216 = sigma[0] * t215;
  t217 = t216 * t117;
  t219 = t101 * t101;
  t220 = 0.1e1 / t219;
  t221 = t73 * t220;
  t222 = t103 * t107;
  t226 = 0.1e1 / t83 / rho[0];
  t227 = t82 * t226;
  t230 = -t74 * t133 / 0.12e2 - t80 * t227 / 0.6e1;
  t232 = t98 * t98;
  t233 = 0.1e1 / t232;
  t234 = t88 * t233;
  t242 = -t89 * t133 / 0.12e2 - t92 * t227 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta / t68;
  t244 = t230 * t99 - t234 * t242;
  t248 = 0.1e1 / t105 / t68;
  t252 = t221 * t222 * t244 + 0.7e1 / 0.6e1 * t73 * t104 * t248;
  t253 = t71 * t252;
  t254 = t253 * t117;
  t256 = t110 * t244 * t116;
  t257 = t71 * t256;
  tvrho0 = t20 + t25 + t31 - t67 + t118 + rho[0] * (0.10363566666666666667e-1 * t146 + 0.39765745675026770179e-1 * t157 + 0.96902277115443742139e-3 * t168 - t211 / 0.24e2 - 0.7e1 / 0.3e1 * t217 + t254 + t257);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = t70 * t110;
  t261 = t101 * t116;
  t262 = t260 * t261;
  t263 = sqrt(rho[0]);
  t265 = 0.1e1 / t263 / t213;
  t266 = t103 * t265;
  t267 = t266 * params->ftilde;
  t269 = t72 * t110 * t116;
  t271 = t267 * t269 / 0.2e1;
  tvsigma0 = rho[0] * (t262 - t271);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t280 = t6 * t70;
  t282 = t4 * t280 * t15;
  t284 = t120 * t127;
  t289 = 0.1e1 / t126 / t14;
  t290 = t8 * t289;
  t291 = t136 * t136;
  t295 = t4 * t280;
  t296 = t295 / 0.9e1;
  t298 = 0.1e1 / t12 / t10;
  t299 = t298 * t79;
  t301 = 0.1e1 / t83 / t68;
  t302 = t82 * t301;
  t303 = t299 * t302;
  t305 = t75 * t70;
  t306 = t132 * t305;
  t308 = t296 - 0.20708e0 * t303 + 0.41416e0 * t306;
  t314 = (t282 / 0.9e1 + t125 * t284 * t136 / 0.6e1 + t125 * t290 * t291 / 0.2e1 - t125 * t128 * t308 / 0.4e1) * t79 * t142;
  t315 = t314 * t145;
  t317 = t5 * t84;
  t318 = t317 * t14;
  t319 = t143 * t318;
  t321 = t144 * t136;
  t322 = t143 * t321;
  t324 = t148 * t21;
  t325 = 0.1e1 / t324;
  t326 = t325 * t1;
  t327 = t326 * t3;
  t329 = t327 * t280 * t154;
  t332 = t149 * t298 * t79;
  t335 = t332 * t82 * t301 * t154;
  t339 = t151 * t75 * t70 * t154;
  t341 = t148 * t148;
  t343 = 0.1e1 / t341 / t21;
  t344 = t343 * t1;
  t345 = t344 * t3;
  t346 = t153 * t153;
  t347 = 0.1e1 / t346;
  t349 = t345 * t280 * t347;
  t352 = t27 * t127;
  t353 = t352 * t132;
  t354 = t120 * t136;
  t358 = t159 * t298;
  t359 = t79 * t81;
  t360 = t5 * t301;
  t361 = t359 * t360;
  t366 = t28 * t289;
  t370 = t282 / 0.72e2 + t353 * t75 * t354 / 0.3e1 - t358 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t160 * t295 + 0.2e1 * t366 * t291 - t163 * t308;
  t371 = t370 * t166;
  t372 = t371 * t14;
  t375 = 0.1e1 / t28 / t27;
  t376 = t165 * t375;
  t377 = t14 * t131;
  t378 = t376 * t377;
  t379 = t378 * t129;
  t381 = t167 * t136;
  t384 = t4 * t280 * t36;
  t386 = t120 * t174;
  t391 = 0.1e1 / t173 / t35;
  t392 = t8 * t391;
  t393 = t177 * t177;
  t399 = t296 - 0.62837222222222222223e-1 * t303 + 0.12567444444444444445e0 * t306;
  t405 = (t384 / 0.9e1 + t125 * t386 * t177 / 0.6e1 + t125 * t392 * t393 / 0.2e1 - t125 * t175 * t399 / 0.4e1) * t79 * t142;
  t408 = t317 * t35;
  t411 = t144 * t177;
  t414 = t187 * t41;
  t415 = 0.1e1 / t414;
  t416 = t415 * t1;
  t417 = t416 * t3;
  t422 = t188 * t298 * t79;
  t431 = t187 * t187;
  t433 = 0.1e1 / t431 / t41;
  t434 = t433 * t1;
  t435 = t434 * t3;
  t436 = t192 * t192;
  t437 = 0.1e1 / t436;
  t442 = t46 * t174;
  t443 = t442 * t132;
  t444 = t120 * t177;
  t448 = t198 * t298;
  t453 = t47 * t391;
  t457 = t384 / 0.72e2 + t443 * t75 * t444 / 0.3e1 - t448 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t199 * t295 + 0.2e1 * t453 * t393 - t202 * t399;
  t458 = t457 * t205;
  t462 = 0.1e1 / t47 / t46;
  t463 = t204 * t462;
  t464 = t35 * t131;
  t465 = t463 * t464;
  t472 = t33 * (t405 * t184 / 0.3e1 + t183 * t408 / 0.9e1 + t183 * t411 / 0.3e1 + 0.12572604010298724325e0 * t417 * t280 * t193 + 0.2514520802059744865e0 * t422 * t82 * t301 * t193 - 0.502904160411948973e0 * t190 * t75 * t70 * t193 - 0.63791733988157656508e1 * t435 * t280 * t437 + 0.41403379428206274608e-3 * t458 * t35 + 0.69005632380343791013e-4 * t465 * t129 + 0.41403379428206274608e-3 * t206 * t177) * t65;
  t474 = t68 * t68;
  t476 = 0.1e1 / t7 / t474;
  t477 = sigma[0] * t476;
  t478 = t477 * t117;
  t480 = t216 * t252;
  t481 = t480 * t117;
  t483 = t216 * t256;
  t486 = 0.1e1 / t219 / t101;
  t487 = t73 * t486;
  t488 = t244 * t244;
  t492 = t103 * t248;
  t500 = t74 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t80 * t302;
  t502 = t230 * t233;
  t506 = 0.1e1 / t232 / t98;
  t507 = t88 * t506;
  t508 = t242 * t242;
  t518 = t89 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t92 * t302 + 0.4774648292756860073e4 * params->mbeta / t213;
  t520 = -t234 * t518 - 0.2e1 * t242 * t502 + t500 * t99 + 0.2e1 * t507 * t508;
  t524 = 0.1e1 / t105 / t213;
  t528 = -0.2e1 * t487 * t222 * t488 - 0.7e1 / 0.3e1 * t221 * t492 * t244 + t221 * t222 * t520 - 0.91e2 / 0.36e2 * t73 * t104 * t524;
  t529 = t71 * t528;
  t530 = t529 * t117;
  t531 = t252 * t252;
  t532 = t71 * t531;
  t533 = t532 * t117;
  t534 = t253 * t256;
  t537 = t110 * t520 * t116;
  t538 = t71 * t537;
  t539 = 0.10363566666666666667e-1 * t315 + 0.34545222222222222223e-2 * t319 + 0.10363566666666666667e-1 * t322 + 0.13255248558342256726e-1 * t329 + 0.26510497116684513453e-1 * t335 - 0.53020994233369026905e-1 * t339 - 0.50167127350538589834e0 * t349 + 0.96902277115443742139e-3 * t372 + 0.1615037951924062369e-3 * t379 + 0.96902277115443742139e-3 * t381 - t472 / 0.24e2 + 0.7e2 / 0.9e1 * t478 - 0.14e2 / 0.3e1 * t481 - 0.14e2 / 0.3e1 * t483 + t530 + t533 + 0.2e1 * t534 + t538;
  tv2rho20 = 0.20727133333333333334e-1 * t146 + 0.79531491350053540358e-1 * t157 + 0.19380455423088748428e-2 * t168 - t211 / 0.12e2 - 0.14e2 / 0.3e1 * t217 + 0.2e1 * t254 + 0.2e1 * t257 + rho[0] * t539;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t215 * t110;
  t542 = t541 * t261;
  t544 = t70 * t252;
  t545 = t544 * t117;
  t546 = t244 * t116;
  t547 = t260 * t546;
  t549 = 0.1e1 / t263 / t474;
  t551 = t103 * t549 * params->ftilde;
  t552 = t551 * t269;
  t555 = t110 * t116;
  t556 = t72 * t252 * t555;
  t557 = t267 * t556;
  tv2rhosigma0 = t262 - t271 + rho[0] * (-0.7e1 / 0.3e1 * t542 + t545 + t547 + 0.7e1 / 0.4e1 * t552 - t557 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t562 = t265 * params->ftilde * t72;
  t563 = 0.1e1 / t103;
  t564 = t563 * t110;
  t565 = t564 * t116;
  t567 = 0.3e1 / 0.4e1 * t562 * t565;
  t569 = 0.1e1 / t83 / t474;
  t570 = params->ftilde * params->ftilde;
  t571 = t569 * t570;
  t572 = t72 * t72;
  t573 = t571 * t572;
  t575 = t102 * t110 * t116;
  t577 = t573 * t575 / 0.4e1;
  tv2sigma20 = rho[0] * (-t567 + t577);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t579 = t474 * rho[0];
  t581 = 0.1e1 / t7 / t579;
  t582 = sigma[0] * t581;
  t583 = t582 * t117;
  t585 = t216 * t537;
  t587 = t75 * t215;
  t591 = 0.1e1 / t83 / t213;
  t592 = t82 * t591;
  t595 = -0.7e1 / 0.27e2 * t74 * t587 - 0.2e2 / 0.27e2 * t80 * t592;
  t597 = t500 * t233;
  t600 = t230 * t506;
  t605 = t232 * t232;
  t606 = 0.1e1 / t605;
  t607 = t88 * t606;
  t608 = t508 * t242;
  t611 = t242 * t518;
  t618 = 0.1e1 / t474;
  t621 = -0.7e1 / 0.27e2 * t89 * t587 - 0.2e2 / 0.27e2 * t92 * t592 - 0.14323944878270580219e5 * params->mbeta * t618;
  t623 = -t234 * t621 - 0.3e1 * t242 * t597 - 0.3e1 * t502 * t518 + 0.6e1 * t507 * t611 + 0.6e1 * t508 * t600 + t595 * t99 - 0.6e1 * t607 * t608;
  t625 = t110 * t623 * t116;
  t626 = t71 * t625;
  t627 = t6 * t215;
  t629 = t4 * t627 * t15;
  t631 = t70 * t127;
  t633 = t125 * t631 * t136;
  t635 = t27 * t289;
  t636 = t635 * t132;
  t640 = t352 * t299;
  t653 = 0.1e1 / t81;
  t655 = t1 * t653 * t6;
  t656 = t215 * t2;
  t663 = 0.1e1 / t12 / t359 / t317 / 0.4e1;
  t664 = t663 * t2;
  t665 = t664 * t618;
  t668 = t5 * t591;
  t669 = t359 * t668;
  t672 = t4 * t627;
  t675 = t126 * t126;
  t676 = 0.1e1 / t675;
  t677 = t28 * t676;
  t678 = t291 * t136;
  t681 = t136 * t308;
  t684 = 0.7e1 / 0.27e2 * t672;
  t686 = t299 * t592;
  t688 = t132 * t587;
  t690 = -t684 - 0.124248e1 * t665 + 0.82832e0 * t686 - 0.96637333333333333333e0 * t688;
  t692 = -0.11e2 / 0.216e3 * t629 - t633 / 0.24e2 - t636 * t75 * t120 * t291 + t640 * t82 * t301 * t136 / 0.3e1 - 0.2e1 / 0.3e1 * t353 * t75 * t70 * t136 + t353 * t75 * t120 * t308 / 0.2e1 + t655 * t656 * t15 / 0.432e3 - 0.2e1 / 0.3e1 * t159 * t665 + 0.4e1 / 0.9e1 * t358 * t669 - 0.14e2 / 0.27e2 * t160 * t672 - 0.6e1 * t677 * t678 + 0.6e1 * t366 * t681 - t163 * t690;
  t693 = t692 * t166;
  t694 = t693 * t14;
  t696 = t371 * t136;
  t698 = t167 * t308;
  t700 = t370 * t375;
  t701 = t700 * t377;
  t702 = t701 * t129;
  t704 = t136 * t131;
  t705 = t376 * t704;
  t706 = t705 * t129;
  t708 = t14 * t298;
  t709 = t376 * t708;
  t710 = t709 * t361;
  t712 = t378 * t295;
  t716 = t332 * t82 * t591 * t154;
  t720 = t151 * t75 * t215 * t154;
  t722 = t252 * t110;
  t723 = t722 * t261;
  t724 = t529 * t723;
  t726 = 0.1e1 / t341;
  t727 = t726 * t79;
  t728 = t727 * t81;
  t729 = t154 * t131;
  t731 = t728 * t668 * t729;
  t734 = 0.1e1 / t341 / t148;
  t735 = t734 * t79;
  t736 = t735 * t81;
  t737 = t347 * t131;
  t739 = t736 * t668 * t737;
  t741 = t326 * t653;
  t742 = t2 * t154;
  t744 = t741 * t627 * t742;
  t746 = t341 * t341;
  t747 = 0.1e1 / t746;
  t748 = t747 * t79;
  t749 = t748 * t81;
  t751 = 0.1e1 / t346 / t153;
  t752 = t751 * t131;
  t754 = t749 * t668 * t752;
  t756 = t28 * t28;
  t757 = 0.1e1 / t756;
  t758 = t165 * t757;
  t759 = t758 * t14;
  t760 = t759 * t295;
  t762 = t531 * t252;
  t763 = t71 * t762;
  t764 = t763 * t117;
  t765 = -0.91e3 / 0.27e2 * t583 - 0.7e1 * t585 + t626 + 0.96902277115443742139e-3 * t694 + 0.19380455423088748428e-2 * t696 + 0.96902277115443742139e-3 * t698 + 0.3230075903848124738e-3 * t702 + 0.3230075903848124738e-3 * t706 + 0.10766919679493749127e-3 * t710 - 0.21533839358987498253e-3 * t712 - 0.10604198846673805381e0 * t716 + 0.12371565321119439611e0 * t720 + 0.3e1 * t724 + 0.26510497116684513452e-1 * t731 - 0.23411326096918008589e1 * t739 + 0.22092080930570427878e-2 * t744 + 0.50631328524251801694e2 * t754 + 0.40375948798101559225e-4 * t760 + t764;
  t766 = t477 * t256;
  t768 = t216 * t531;
  t769 = t768 * t117;
  t771 = t253 * t537;
  t773 = t529 * t256;
  t775 = t532 * t256;
  t777 = t477 * t252;
  t778 = t777 * t117;
  t780 = t216 * t528;
  t781 = t780 * t117;
  t783 = t480 * t256;
  t785 = t219 * t219;
  t787 = t73 / t785;
  t788 = t488 * t244;
  t795 = t244 * t520;
  t799 = t103 * t524;
  t809 = 0.1e1 / t105 / t474;
  t813 = 0.6e1 * t787 * t222 * t788 + 0.7e1 * t487 * t492 * t488 - 0.6e1 * t487 * t222 * t795 + 0.91e2 / 0.12e2 * t221 * t799 * t244 - 0.7e1 / 0.2e1 * t221 * t492 * t520 + t221 * t222 * t623 + 0.1729e4 / 0.216e3 * t73 * t104 * t809;
  t814 = t71 * t813;
  t815 = t814 * t117;
  t816 = t47 * t47;
  t817 = 0.1e1 / t816;
  t818 = t204 * t817;
  t819 = t818 * t35;
  t822 = t627 * t437;
  t825 = t144 * t399;
  t828 = t434 * t653;
  t831 = t317 * t177;
  t836 = t188 * t663;
  t837 = t2 * t618;
  t842 = t4 * t627 * t36;
  t844 = t70 * t174;
  t846 = t125 * t844 * t177;
  t848 = t120 * t391;
  t855 = t173 * t173;
  t856 = 0.1e1 / t855;
  t857 = t8 * t856;
  t858 = t393 * t177;
  t862 = t177 * t399;
  t869 = -t684 - 0.37702333333333333334e0 * t665 + 0.2513488888888888889e0 * t686 - 0.29324037037037037038e0 * t688;
  t875 = (-0.7e1 / 0.27e2 * t842 - t846 / 0.3e1 - t125 * t848 * t393 / 0.2e1 + t125 * t386 * t399 / 0.4e1 - 0.3e1 / 0.2e1 * t125 * t857 * t858 + 0.3e1 / 0.2e1 * t125 * t392 * t862 - t125 * t175 * t869 / 0.4e1) * t79 * t142;
  t880 = t431 * t431;
  t881 = 0.1e1 / t880;
  t882 = t881 * t79;
  t883 = t882 * t81;
  t885 = 0.1e1 / t436 / t192;
  t886 = t885 * t131;
  t892 = t46 * t391;
  t893 = t892 * t132;
  t897 = t442 * t299;
  t919 = t47 * t856;
  t925 = -0.11e2 / 0.216e3 * t842 - t846 / 0.24e2 - t893 * t75 * t120 * t393 + t897 * t82 * t301 * t177 / 0.3e1 - 0.2e1 / 0.3e1 * t443 * t75 * t70 * t177 + t443 * t75 * t120 * t399 / 0.2e1 + t655 * t656 * t36 / 0.432e3 - 0.2e1 / 0.3e1 * t198 * t665 + 0.4e1 / 0.9e1 * t448 * t669 - 0.14e2 / 0.27e2 * t199 * t672 - 0.6e1 * t919 * t858 + 0.6e1 * t453 * t862 - t202 * t869;
  t926 = t925 * t205;
  t931 = 0.17251408095085947753e-4 * t819 * t295 + 0.23390302462324474053e2 * t435 * t822 + t183 * t825 / 0.3e1 - 0.33842565975395191035e0 * t828 * t822 + 0.2e1 / 0.9e1 * t183 * t831 + 0.2e1 / 0.3e1 * t405 * t411 + 0.1508712481235846919e1 * t836 * t837 * t193 + t875 * t184 / 0.3e1 - 0.92007509840458388017e-4 * t465 * t295 + 0.86312224513605868233e3 * t883 * t668 * t886 + 0.41403379428206274608e-3 * t926 * t35 + 0.82806758856412549216e-3 * t458 * t177;
  t942 = t457 * t462;
  t943 = t942 * t464;
  t946 = t177 * t131;
  t947 = t463 * t946;
  t950 = t35 * t298;
  t951 = t463 * t950;
  t956 = t5 * t226;
  t957 = t956 * t35;
  t963 = 0.1e1 / t431;
  t964 = t963 * t79;
  t965 = t964 * t81;
  t966 = t193 * t131;
  t971 = 0.1e1 / t431 / t187;
  t972 = t971 * t79;
  t973 = t972 * t81;
  t974 = t437 * t131;
  t978 = t416 * t653;
  t979 = t2 * t193;
  t983 = 0.41403379428206274608e-3 * t206 * t399 - 0.1005808320823897946e1 * t422 * t82 * t591 * t193 + 0.11734430409612142703e1 * t190 * t75 * t215 * t193 + 0.13801126476068758203e-3 * t943 * t129 + 0.13801126476068758203e-3 * t947 * t129 + 0.46003754920229194009e-4 * t951 * t361 + 0.2e1 / 0.9e1 * t405 * t408 - 0.2e1 / 0.27e2 * t183 * t957 - 0.46099548037761989191e0 * t417 * t627 * t193 + 0.2514520802059744865e0 * t965 * t668 * t966 - 0.29769475861140239704e2 * t973 * t668 * t974 + 0.20954340017164540542e-1 * t978 * t627 * t979;
  t986 = t33 * (t931 + t983) * t65;
  t988 = t149 * t663;
  t990 = t988 * t837 * t154;
  t992 = t344 * t653;
  t993 = t627 * t347;
  t994 = t992 * t993;
  t996 = t345 * t993;
  t998 = t317 * t136;
  t999 = t143 * t998;
  t1001 = t144 * t308;
  t1002 = t143 * t1001;
  t1004 = t314 * t321;
  t1008 = t120 * t289;
  t1015 = t8 * t676;
  t1027 = (-0.7e1 / 0.27e2 * t629 - t633 / 0.3e1 - t125 * t1008 * t291 / 0.2e1 + t125 * t284 * t308 / 0.4e1 - 0.3e1 / 0.2e1 * t125 * t1015 * t678 + 0.3e1 / 0.2e1 * t125 * t290 * t681 - t125 * t128 * t690 / 0.4e1) * t79 * t142;
  t1028 = t1027 * t145;
  t1030 = t314 * t318;
  t1032 = t956 * t14;
  t1033 = t143 * t1032;
  t1036 = t327 * t627 * t154;
  t1038 = 0.7e2 / 0.3e1 * t766 - 0.7e1 * t769 + 0.3e1 * t771 + 0.3e1 * t773 + 0.3e1 * t775 + 0.7e2 / 0.3e1 * t778 - 0.7e1 * t781 - 0.14e2 * t783 + t815 - t986 / 0.24e2 + 0.15906298270010708072e0 * t990 - 0.26614487661862784322e-1 * t994 + 0.18394613361864149606e1 * t996 + 0.69090444444444444446e-2 * t999 + 0.10363566666666666667e-1 * t1002 + 0.20727133333333333334e-1 * t1004 + 0.10363566666666666667e-1 * t1028 + 0.69090444444444444446e-2 * t1030 - 0.23030148148148148149e-2 * t1033 - 0.48602578047254941329e-1 * t1036;
  tv3rho30 = rho[0] * (t765 + t1038) - t472 / 0.8e1 - 0.15906298270010708072e0 * t339 + 0.4845113855772187107e-3 * t379 - 0.14e2 * t483 + 0.3e1 * t538 + 0.29070683134633122642e-2 * t372 + 0.29070683134633122642e-2 * t381 + 0.31090700000000000001e-1 * t315 + 0.31090700000000000001e-1 * t322 + 0.39765745675026770179e-1 * t329 - 0.1505013820516157695e1 * t349 + 0.7e2 / 0.3e1 * t478 - 0.14e2 * t481 + 0.3e1 * t530 + 0.6e1 * t534 + 0.10363566666666666667e-1 * t319 + 0.79531491350053540358e-1 * t335 + 0.3e1 * t533;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1063 = t476 * t110;
  t1064 = t1063 * t261;
  t1066 = t215 * t252;
  t1067 = t1066 * t117;
  t1069 = t541 * t546;
  t1071 = t70 * t528;
  t1072 = t1071 * t117;
  t1073 = t70 * t531;
  t1074 = t1073 * t117;
  t1075 = t544 * t256;
  t1077 = t520 * t116;
  t1078 = t260 * t1077;
  t1080 = 0.1e1 / t263 / t579;
  t1082 = t103 * t1080 * params->ftilde;
  t1083 = t1082 * t269;
  t1085 = t551 * t556;
  t1088 = t72 * t528 * t555;
  t1089 = t267 * t1088;
  t1092 = t72 * t531 * t555;
  t1093 = t267 * t1092;
  t1095 = 0.7e2 / 0.9e1 * t1064 - 0.14e2 / 0.3e1 * t1067 - 0.14e2 / 0.3e1 * t1069 + t1072 + t1074 + 0.2e1 * t1075 + t1078 - 0.63e2 / 0.8e1 * t1083 + 0.7e1 / 0.2e1 * t1085 - t1089 / 0.2e1 - t1093 / 0.2e1;
  tv3rho2sigma0 = -0.14e2 / 0.3e1 * t542 + 0.2e1 * t545 + 0.2e1 * t547 + 0.7e1 / 0.2e1 * t552 - t557 + rho[0] * t1095;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1098 = t549 * params->ftilde * t72;
  t1099 = t1098 * t565;
  t1102 = t563 * t252 * t555;
  t1103 = t562 * t1102;
  t1108 = 0.1e1 / t83 / t579 * t570 * t572;
  t1109 = t1108 * t575;
  t1111 = t220 * t110;
  t1112 = t1111 * t546;
  t1113 = t573 * t1112;
  t1116 = t102 * t252 * t555;
  t1117 = t573 * t1116;
  tv3rhosigma20 = -t567 + t577 + rho[0] * (0.21e2 / 0.8e1 * t1099 - 0.3e1 / 0.4e1 * t1103 - 0.7e1 / 0.6e1 * t1109 - t1113 / 0.4e1 + t1117 / 0.4e1);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1122 = 0.1e1 / t103 / sigma[0];
  t1124 = t1122 * t110 * t116;
  t1126 = 0.3e1 / 0.8e1 * t562 * t1124;
  t1127 = 0.1e1 / sigma[0];
  t1129 = t1127 * t102 * t555;
  t1131 = 0.3e1 / 0.8e1 * t573 * t1129;
  t1132 = t105 * t105;
  t1133 = t1132 * t1132;
  t1134 = t1133 * t105;
  t1137 = t570 * params->ftilde;
  t1138 = 0.1e1 / t1134 / t579 * t1137;
  t1139 = t572 * t72;
  t1140 = t1138 * t1139;
  t1142 = t220 * t563 * t555;
  t1144 = t1140 * t1142 / 0.8e1;
  tv3sigma30 = rho[0] * (t1126 + t1131 - t1144);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t19, t20;
  double t21, t24, t25, t26, t27, t28, t30, t31;
  double t32, t33, t35, t36, t40, t41, t44, t46;
  double t47, t49, t53, t54, t56, t59, t60, t65;
  double t67, t68, t70, t71, t72, t73, t74, t75;
  double t76, t79, t80, t81, t82, t83, t84, t85;
  double t88, t89, t92, t95, t98, t99, t101, t102;
  double t103, t104, t105, t107, t110, t112, t114, t115;
  double t116, t117, t118, tzk0;

  double t120, t121, t125, t126, t127, t128, t129, t130;
  double t131, t132, t133, t134, t136, t142, t143, t144;
  double t145, t146, t148, t149, t151, t153, t154, t157;
  double t159, t160, t163, t165, t166, t167, t168, t173;
  double t174, t175, t177, t183, t184, t187, t188, t190;
  double t192, t193, t198, t199, t202, t204, t205, t206;
  double t211, t213, t215, t216, t217, t219, t220, t221;
  double t222, t226, t227, t230, t232, t233, t234, t242;
  double t244, t248, t252, t253, t254, t256, t257, tvrho0;
  double t260, t261, t262, t263, t265, t266, t267, t269;
  double t271, tvsigma0;

  double t280, t282, t284, t289, t290, t291, t295, t296;
  double t298, t299, t301, t302, t303, t305, t306, t308;
  double t314, t315, t317, t318, t319, t321, t322, t324;
  double t325, t326, t327, t329, t332, t335, t339, t341;
  double t343, t344, t345, t346, t347, t349, t352, t353;
  double t354, t358, t359, t360, t361, t366, t370, t371;
  double t372, t375, t376, t377, t378, t379, t381, t384;
  double t386, t391, t392, t393, t399, t405, t408, t411;
  double t414, t415, t416, t417, t422, t431, t433, t434;
  double t435, t436, t437, t442, t443, t444, t448, t453;
  double t457, t458, t462, t463, t464, t465, t472, t474;
  double t476, t477, t478, t480, t481, t483, t486, t487;
  double t488, t492, t500, t502, t506, t507, t508, t518;
  double t520, t524, t528, t529, t530, t531, t532, t533;
  double t534, t537, t538, t539, tv2rho20, t541, t542, t544;
  double t545, t546, t547, t549, t551, t552, t555, t556;
  double t557, tv2rhosigma0, t562, t563, t564, t565, t567, t569;
  double t570, t571, t572, t573, t575, t577, tv2sigma20;

  double t579, t581, t582, t583, t585, t587, t591, t592;
  double t595, t597, t600, t605, t606, t607, t608, t611;
  double t618, t621, t623, t625, t626, t627, t629, t631;
  double t633, t635, t636, t640, t653, t655, t656, t663;
  double t664, t665, t668, t669, t672, t675, t676, t677;
  double t678, t681, t684, t686, t688, t690, t692, t693;
  double t694, t696, t698, t700, t701, t702, t704, t705;
  double t706, t708, t709, t710, t712, t716, t720, t722;
  double t723, t724, t726, t727, t728, t729, t731, t734;
  double t735, t736, t737, t739, t741, t742, t744, t746;
  double t747, t748, t749, t751, t752, t754, t756, t757;
  double t758, t759, t760, t762, t763, t764, t765, t766;
  double t768, t769, t771, t773, t775, t777, t778, t780;
  double t781, t783, t785, t787, t788, t795, t799, t809;
  double t813, t814, t815, t816, t817, t818, t819, t822;
  double t825, t828, t831, t836, t837, t842, t844, t846;
  double t848, t855, t856, t857, t858, t862, t869, t875;
  double t880, t881, t882, t883, t885, t886, t892, t893;
  double t897, t919, t925, t926, t931, t942, t943, t946;
  double t947, t950, t951, t956, t957, t963, t964, t965;
  double t966, t971, t972, t973, t974, t978, t979, t983;
  double t986, t988, t990, t992, t993, t994, t996, t998;
  double t999, t1001, t1002, t1004, t1008, t1015, t1027, t1028;
  double t1030, t1032, t1033, t1036, t1038, tv3rho30, t1063, t1064;
  double t1066, t1067, t1069, t1071, t1072, t1073, t1074, t1075;
  double t1077, t1078, t1080, t1082, t1083, t1085, t1088, t1089;
  double t1092, t1093, t1095, tv3rho2sigma0, t1098, t1099, t1102, t1103;
  double t1108, t1109, t1111, t1112, t1113, t1116, t1117, tv3rhosigma20;
  double t1122, t1124, t1126, t1127, t1129, t1131, t1132, t1133;
  double t1134, t1137, t1138, t1139, t1140, t1142, t1144, tv3sigma30;

  double t1146, t1154, t1157, t1180, t1186, t1196, t1201, t1205;
  double t1227, t1228, t1243, t1247, t1251, t1254, t1267, t1269;
  double t1273, t1277, t1281, t1285, t1286, t1290, t1291, t1293;
  double t1295, t1297, t1299, t1301, t1305, t1312, t1323, t1327;
  double t1331, t1337, t1348, t1350, t1361, t1368, t1374, t1418;
  double t1430, t1445, t1446, t1451, t1475, t1489, t1497, t1520;
  double t1524, t1548, t1566, t1573, t1590, t1635, t1652, t1677;
  double t1702, t1711, t1715, t1719, t1722, t1735, t1737, t1741;
  double t1745, t1749, t1757, t1761, t1790, t1798, t1804, t1847;
  double t1896, t1903, t1954, t1958, t1965, t1976, t1999, t2020;
  double tv4rho40, t2080, tv4rho3sigma0, t2143, tv4rho2sigma20, t2154, tv4rhosigma30, t2176;
  double t2194, t2196, tv4sigma40;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = 0.1e1 / t7;
  t9 = t6 * t8;
  t10 = t4 * t9;
  t11 = t10 / 0.4e1;
  t12 = sqrt(t10);
  t14 = t11 + 0.186372e1 * t12 + 0.129352e2;
  t15 = 0.1e1 / t14;
  t19 = log(t4 * t9 * t15 / 0.4e1);
  t20 = 0.310907e-1 * t19;
  t21 = t12 + 0.372744e1;
  t24 = atan(0.61519908197590802322e1 / t21);
  t25 = 0.38783294878113014393e-1 * t24;
  t26 = t12 / 0.2e1;
  t27 = t26 + 0.10498e0;
  t28 = t27 * t27;
  t30 = log(t28 * t15);
  t31 = 0.96902277115443742139e-3 * t30;
  t32 = M_PI * M_PI;
  t33 = 0.1e1 / t32;
  t35 = t11 + 0.565535e0 * t12 + 0.130045e2;
  t36 = 0.1e1 / t35;
  t40 = log(t4 * t9 * t36 / 0.4e1);
  t41 = t12 + 0.113107e1;
  t44 = atan(0.71231089178181179908e1 / t41);
  t46 = t26 + 0.47584e-2;
  t47 = t46 * t46;
  t49 = log(t47 * t36);
  t53 = 0.1e1 <= p->zeta_threshold;
  t54 = POW_1_3(p->zeta_threshold);
  t56 = my_piecewise3(t53, t54 * p->zeta_threshold, 1);
  t59 = M_CBRT2;
  t60 = t59 - 0.1e1;
  t65 = 0.9e1 * t56 - 0.9e1;
  t67 = t33 * (t40 + 0.317708004743941464e0 * t44 + 0.41403379428206274608e-3 * t49) * t65 / 0.24e2;
  t68 = rho[0] * rho[0];
  t70 = 0.1e1 / t7 / t68;
  t71 = sigma[0] * t70;
  t72 = params->aa + params->bb;
  t73 = params->ftilde * t72;
  t74 = params->malpha * t1;
  t75 = t3 * t6;
  t76 = t75 * t8;
  t79 = t1 * t1;
  t80 = params->mbeta * t79;
  t81 = t3 * t3;
  t82 = t81 * t5;
  t83 = t7 * t7;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t88 = params->bb + t74 * t76 / 0.4e1 + t80 * t85 / 0.4e1;
  t89 = params->mgamma * t1;
  t92 = params->mdelta * t79;
  t95 = 0.1e1 / rho[0];
  t98 = 0.1e1 + t89 * t76 / 0.4e1 + t92 * t85 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t95;
  t99 = 0.1e1 / t98;
  t101 = t88 * t99 + params->aa;
  t102 = 0.1e1 / t101;
  t103 = sqrt(sigma[0]);
  t104 = t102 * t103;
  t105 = pow(rho[0], 0.1e1 / 0.6e1);
  t107 = 0.1e1 / t105 / rho[0];
  t110 = exp(-t73 * t104 * t107);
  t112 = t54 * t54;
  t114 = my_piecewise3(t53, t112 * p->zeta_threshold, 1);
  t115 = sqrt(t114);
  t116 = 0.1e1 / t115;
  t117 = t110 * t101 * t116;
  t118 = t71 * t117;
  tzk0 = t20 + t25 + t31 - t67 + t118;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t120 = 0.1e1 / t7 / rho[0];
  t121 = t6 * t120;
  t125 = t4 * t6;
  t126 = t14 * t14;
  t127 = 0.1e1 / t126;
  t128 = t8 * t127;
  t129 = t4 * t121;
  t130 = t129 / 0.12e2;
  t131 = 0.1e1 / t12;
  t132 = t131 * t1;
  t133 = t75 * t120;
  t134 = t132 * t133;
  t136 = -t130 - 0.31062e0 * t134;
  t142 = 0.1e1 / t3;
  t143 = (-t4 * t121 * t15 / 0.12e2 - t125 * t128 * t136 / 0.4e1) * t79 * t142;
  t144 = t5 * t7;
  t145 = t144 * t14;
  t146 = t143 * t145;
  t148 = t21 * t21;
  t149 = 0.1e1 / t148;
  t151 = t149 * t131 * t1;
  t153 = 0.378469910464e2 * t149 + 0.1e1;
  t154 = 0.1e1 / t153;
  t157 = t151 * t75 * t120 * t154;
  t159 = t27 * t15;
  t160 = t159 * t131;
  t163 = t28 * t127;
  t165 = -t160 * t129 / 0.6e1 - t163 * t136;
  t166 = 0.1e1 / t28;
  t167 = t165 * t166;
  t168 = t167 * t14;
  t173 = t35 * t35;
  t174 = 0.1e1 / t173;
  t175 = t8 * t174;
  t177 = -t130 - 0.94255833333333333334e-1 * t134;
  t183 = (-t4 * t121 * t36 / 0.12e2 - t125 * t175 * t177 / 0.4e1) * t79 * t142;
  t184 = t144 * t35;
  t187 = t41 * t41;
  t188 = 0.1e1 / t187;
  t190 = t188 * t131 * t1;
  t192 = 0.50738680655100000001e2 * t188 + 0.1e1;
  t193 = 0.1e1 / t192;
  t198 = t46 * t36;
  t199 = t198 * t131;
  t202 = t47 * t174;
  t204 = -t199 * t129 / 0.6e1 - t202 * t177;
  t205 = 0.1e1 / t47;
  t206 = t204 * t205;
  t211 = t33 * (t183 * t184 / 0.3e1 + 0.37717812030896172975e0 * t190 * t75 * t120 * t193 + 0.41403379428206274608e-3 * t206 * t35) * t65;
  t213 = t68 * rho[0];
  t215 = 0.1e1 / t7 / t213;
  t216 = sigma[0] * t215;
  t217 = t216 * t117;
  t219 = t101 * t101;
  t220 = 0.1e1 / t219;
  t221 = t73 * t220;
  t222 = t103 * t107;
  t226 = 0.1e1 / t83 / rho[0];
  t227 = t82 * t226;
  t230 = -t74 * t133 / 0.12e2 - t80 * t227 / 0.6e1;
  t232 = t98 * t98;
  t233 = 0.1e1 / t232;
  t234 = t88 * t233;
  t242 = -t89 * t133 / 0.12e2 - t92 * t227 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta / t68;
  t244 = t230 * t99 - t234 * t242;
  t248 = 0.1e1 / t105 / t68;
  t252 = t221 * t222 * t244 + 0.7e1 / 0.6e1 * t73 * t104 * t248;
  t253 = t71 * t252;
  t254 = t253 * t117;
  t256 = t110 * t244 * t116;
  t257 = t71 * t256;
  tvrho0 = t20 + t25 + t31 - t67 + t118 + rho[0] * (0.10363566666666666667e-1 * t146 + 0.39765745675026770179e-1 * t157 + 0.96902277115443742139e-3 * t168 - t211 / 0.24e2 - 0.7e1 / 0.3e1 * t217 + t254 + t257);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = t70 * t110;
  t261 = t101 * t116;
  t262 = t260 * t261;
  t263 = sqrt(rho[0]);
  t265 = 0.1e1 / t263 / t213;
  t266 = t103 * t265;
  t267 = t266 * params->ftilde;
  t269 = t72 * t110 * t116;
  t271 = t267 * t269 / 0.2e1;
  tvsigma0 = rho[0] * (t262 - t271);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t280 = t6 * t70;
  t282 = t4 * t280 * t15;
  t284 = t120 * t127;
  t289 = 0.1e1 / t126 / t14;
  t290 = t8 * t289;
  t291 = t136 * t136;
  t295 = t4 * t280;
  t296 = t295 / 0.9e1;
  t298 = 0.1e1 / t12 / t10;
  t299 = t298 * t79;
  t301 = 0.1e1 / t83 / t68;
  t302 = t82 * t301;
  t303 = t299 * t302;
  t305 = t75 * t70;
  t306 = t132 * t305;
  t308 = t296 - 0.20708e0 * t303 + 0.41416e0 * t306;
  t314 = (t282 / 0.9e1 + t125 * t284 * t136 / 0.6e1 + t125 * t290 * t291 / 0.2e1 - t125 * t128 * t308 / 0.4e1) * t79 * t142;
  t315 = t314 * t145;
  t317 = t5 * t84;
  t318 = t317 * t14;
  t319 = t143 * t318;
  t321 = t144 * t136;
  t322 = t143 * t321;
  t324 = t148 * t21;
  t325 = 0.1e1 / t324;
  t326 = t325 * t1;
  t327 = t326 * t3;
  t329 = t327 * t280 * t154;
  t332 = t149 * t298 * t79;
  t335 = t332 * t82 * t301 * t154;
  t339 = t151 * t75 * t70 * t154;
  t341 = t148 * t148;
  t343 = 0.1e1 / t341 / t21;
  t344 = t343 * t1;
  t345 = t344 * t3;
  t346 = t153 * t153;
  t347 = 0.1e1 / t346;
  t349 = t345 * t280 * t347;
  t352 = t27 * t127;
  t353 = t352 * t132;
  t354 = t120 * t136;
  t358 = t159 * t298;
  t359 = t79 * t81;
  t360 = t5 * t301;
  t361 = t359 * t360;
  t366 = t28 * t289;
  t370 = t282 / 0.72e2 + t353 * t75 * t354 / 0.3e1 - t358 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t160 * t295 + 0.2e1 * t366 * t291 - t163 * t308;
  t371 = t370 * t166;
  t372 = t371 * t14;
  t375 = 0.1e1 / t28 / t27;
  t376 = t165 * t375;
  t377 = t14 * t131;
  t378 = t376 * t377;
  t379 = t378 * t129;
  t381 = t167 * t136;
  t384 = t4 * t280 * t36;
  t386 = t120 * t174;
  t391 = 0.1e1 / t173 / t35;
  t392 = t8 * t391;
  t393 = t177 * t177;
  t399 = t296 - 0.62837222222222222223e-1 * t303 + 0.12567444444444444445e0 * t306;
  t405 = (t384 / 0.9e1 + t125 * t386 * t177 / 0.6e1 + t125 * t392 * t393 / 0.2e1 - t125 * t175 * t399 / 0.4e1) * t79 * t142;
  t408 = t317 * t35;
  t411 = t144 * t177;
  t414 = t187 * t41;
  t415 = 0.1e1 / t414;
  t416 = t415 * t1;
  t417 = t416 * t3;
  t422 = t188 * t298 * t79;
  t431 = t187 * t187;
  t433 = 0.1e1 / t431 / t41;
  t434 = t433 * t1;
  t435 = t434 * t3;
  t436 = t192 * t192;
  t437 = 0.1e1 / t436;
  t442 = t46 * t174;
  t443 = t442 * t132;
  t444 = t120 * t177;
  t448 = t198 * t298;
  t453 = t47 * t391;
  t457 = t384 / 0.72e2 + t443 * t75 * t444 / 0.3e1 - t448 * t361 / 0.9e1 + 0.2e1 / 0.9e1 * t199 * t295 + 0.2e1 * t453 * t393 - t202 * t399;
  t458 = t457 * t205;
  t462 = 0.1e1 / t47 / t46;
  t463 = t204 * t462;
  t464 = t35 * t131;
  t465 = t463 * t464;
  t472 = t33 * (t405 * t184 / 0.3e1 + t183 * t408 / 0.9e1 + t183 * t411 / 0.3e1 + 0.12572604010298724325e0 * t417 * t280 * t193 + 0.2514520802059744865e0 * t422 * t82 * t301 * t193 - 0.502904160411948973e0 * t190 * t75 * t70 * t193 - 0.63791733988157656508e1 * t435 * t280 * t437 + 0.41403379428206274608e-3 * t458 * t35 + 0.69005632380343791013e-4 * t465 * t129 + 0.41403379428206274608e-3 * t206 * t177) * t65;
  t474 = t68 * t68;
  t476 = 0.1e1 / t7 / t474;
  t477 = sigma[0] * t476;
  t478 = t477 * t117;
  t480 = t216 * t252;
  t481 = t480 * t117;
  t483 = t216 * t256;
  t486 = 0.1e1 / t219 / t101;
  t487 = t73 * t486;
  t488 = t244 * t244;
  t492 = t103 * t248;
  t500 = t74 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t80 * t302;
  t502 = t230 * t233;
  t506 = 0.1e1 / t232 / t98;
  t507 = t88 * t506;
  t508 = t242 * t242;
  t518 = t89 * t305 / 0.9e1 + 0.5e1 / 0.18e2 * t92 * t302 + 0.4774648292756860073e4 * params->mbeta / t213;
  t520 = -t234 * t518 - 0.2e1 * t242 * t502 + t500 * t99 + 0.2e1 * t507 * t508;
  t524 = 0.1e1 / t105 / t213;
  t528 = -0.2e1 * t487 * t222 * t488 - 0.7e1 / 0.3e1 * t221 * t492 * t244 + t221 * t222 * t520 - 0.91e2 / 0.36e2 * t73 * t104 * t524;
  t529 = t71 * t528;
  t530 = t529 * t117;
  t531 = t252 * t252;
  t532 = t71 * t531;
  t533 = t532 * t117;
  t534 = t253 * t256;
  t537 = t110 * t520 * t116;
  t538 = t71 * t537;
  t539 = 0.10363566666666666667e-1 * t315 + 0.34545222222222222223e-2 * t319 + 0.10363566666666666667e-1 * t322 + 0.13255248558342256726e-1 * t329 + 0.26510497116684513453e-1 * t335 - 0.53020994233369026905e-1 * t339 - 0.50167127350538589834e0 * t349 + 0.96902277115443742139e-3 * t372 + 0.1615037951924062369e-3 * t379 + 0.96902277115443742139e-3 * t381 - t472 / 0.24e2 + 0.7e2 / 0.9e1 * t478 - 0.14e2 / 0.3e1 * t481 - 0.14e2 / 0.3e1 * t483 + t530 + t533 + 0.2e1 * t534 + t538;
  tv2rho20 = 0.20727133333333333334e-1 * t146 + 0.79531491350053540358e-1 * t157 + 0.19380455423088748428e-2 * t168 - t211 / 0.12e2 - 0.14e2 / 0.3e1 * t217 + 0.2e1 * t254 + 0.2e1 * t257 + rho[0] * t539;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t215 * t110;
  t542 = t541 * t261;
  t544 = t70 * t252;
  t545 = t544 * t117;
  t546 = t244 * t116;
  t547 = t260 * t546;
  t549 = 0.1e1 / t263 / t474;
  t551 = t103 * t549 * params->ftilde;
  t552 = t551 * t269;
  t555 = t110 * t116;
  t556 = t72 * t252 * t555;
  t557 = t267 * t556;
  tv2rhosigma0 = t262 - t271 + rho[0] * (-0.7e1 / 0.3e1 * t542 + t545 + t547 + 0.7e1 / 0.4e1 * t552 - t557 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t562 = t265 * params->ftilde * t72;
  t563 = 0.1e1 / t103;
  t564 = t563 * t110;
  t565 = t564 * t116;
  t567 = 0.3e1 / 0.4e1 * t562 * t565;
  t569 = 0.1e1 / t83 / t474;
  t570 = params->ftilde * params->ftilde;
  t571 = t569 * t570;
  t572 = t72 * t72;
  t573 = t571 * t572;
  t575 = t102 * t110 * t116;
  t577 = t573 * t575 / 0.4e1;
  tv2sigma20 = rho[0] * (-t567 + t577);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t579 = t474 * rho[0];
  t581 = 0.1e1 / t7 / t579;
  t582 = sigma[0] * t581;
  t583 = t582 * t117;
  t585 = t216 * t537;
  t587 = t75 * t215;
  t591 = 0.1e1 / t83 / t213;
  t592 = t82 * t591;
  t595 = -0.7e1 / 0.27e2 * t74 * t587 - 0.2e2 / 0.27e2 * t80 * t592;
  t597 = t500 * t233;
  t600 = t230 * t506;
  t605 = t232 * t232;
  t606 = 0.1e1 / t605;
  t607 = t88 * t606;
  t608 = t508 * t242;
  t611 = t242 * t518;
  t618 = 0.1e1 / t474;
  t621 = -0.7e1 / 0.27e2 * t89 * t587 - 0.2e2 / 0.27e2 * t92 * t592 - 0.14323944878270580219e5 * params->mbeta * t618;
  t623 = -t234 * t621 - 0.3e1 * t242 * t597 - 0.3e1 * t502 * t518 + 0.6e1 * t507 * t611 + 0.6e1 * t508 * t600 + t595 * t99 - 0.6e1 * t607 * t608;
  t625 = t110 * t623 * t116;
  t626 = t71 * t625;
  t627 = t6 * t215;
  t629 = t4 * t627 * t15;
  t631 = t70 * t127;
  t633 = t125 * t631 * t136;
  t635 = t27 * t289;
  t636 = t635 * t132;
  t640 = t352 * t299;
  t653 = 0.1e1 / t81;
  t655 = t1 * t653 * t6;
  t656 = t215 * t2;
  t663 = 0.1e1 / t12 / t359 / t317 / 0.4e1;
  t664 = t663 * t2;
  t665 = t664 * t618;
  t668 = t5 * t591;
  t669 = t359 * t668;
  t672 = t4 * t627;
  t675 = t126 * t126;
  t676 = 0.1e1 / t675;
  t677 = t28 * t676;
  t678 = t291 * t136;
  t681 = t136 * t308;
  t684 = 0.7e1 / 0.27e2 * t672;
  t686 = t299 * t592;
  t688 = t132 * t587;
  t690 = -t684 - 0.124248e1 * t665 + 0.82832e0 * t686 - 0.96637333333333333333e0 * t688;
  t692 = -0.11e2 / 0.216e3 * t629 - t633 / 0.24e2 - t636 * t75 * t120 * t291 + t640 * t82 * t301 * t136 / 0.3e1 - 0.2e1 / 0.3e1 * t353 * t75 * t70 * t136 + t353 * t75 * t120 * t308 / 0.2e1 + t655 * t656 * t15 / 0.432e3 - 0.2e1 / 0.3e1 * t159 * t665 + 0.4e1 / 0.9e1 * t358 * t669 - 0.14e2 / 0.27e2 * t160 * t672 - 0.6e1 * t677 * t678 + 0.6e1 * t366 * t681 - t163 * t690;
  t693 = t692 * t166;
  t694 = t693 * t14;
  t696 = t371 * t136;
  t698 = t167 * t308;
  t700 = t370 * t375;
  t701 = t700 * t377;
  t702 = t701 * t129;
  t704 = t136 * t131;
  t705 = t376 * t704;
  t706 = t705 * t129;
  t708 = t14 * t298;
  t709 = t376 * t708;
  t710 = t709 * t361;
  t712 = t378 * t295;
  t716 = t332 * t82 * t591 * t154;
  t720 = t151 * t75 * t215 * t154;
  t722 = t252 * t110;
  t723 = t722 * t261;
  t724 = t529 * t723;
  t726 = 0.1e1 / t341;
  t727 = t726 * t79;
  t728 = t727 * t81;
  t729 = t154 * t131;
  t731 = t728 * t668 * t729;
  t734 = 0.1e1 / t341 / t148;
  t735 = t734 * t79;
  t736 = t735 * t81;
  t737 = t347 * t131;
  t739 = t736 * t668 * t737;
  t741 = t326 * t653;
  t742 = t2 * t154;
  t744 = t741 * t627 * t742;
  t746 = t341 * t341;
  t747 = 0.1e1 / t746;
  t748 = t747 * t79;
  t749 = t748 * t81;
  t751 = 0.1e1 / t346 / t153;
  t752 = t751 * t131;
  t754 = t749 * t668 * t752;
  t756 = t28 * t28;
  t757 = 0.1e1 / t756;
  t758 = t165 * t757;
  t759 = t758 * t14;
  t760 = t759 * t295;
  t762 = t531 * t252;
  t763 = t71 * t762;
  t764 = t763 * t117;
  t765 = -0.91e3 / 0.27e2 * t583 - 0.7e1 * t585 + t626 + 0.96902277115443742139e-3 * t694 + 0.19380455423088748428e-2 * t696 + 0.96902277115443742139e-3 * t698 + 0.3230075903848124738e-3 * t702 + 0.3230075903848124738e-3 * t706 + 0.10766919679493749127e-3 * t710 - 0.21533839358987498253e-3 * t712 - 0.10604198846673805381e0 * t716 + 0.12371565321119439611e0 * t720 + 0.3e1 * t724 + 0.26510497116684513452e-1 * t731 - 0.23411326096918008589e1 * t739 + 0.22092080930570427878e-2 * t744 + 0.50631328524251801694e2 * t754 + 0.40375948798101559225e-4 * t760 + t764;
  t766 = t477 * t256;
  t768 = t216 * t531;
  t769 = t768 * t117;
  t771 = t253 * t537;
  t773 = t529 * t256;
  t775 = t532 * t256;
  t777 = t477 * t252;
  t778 = t777 * t117;
  t780 = t216 * t528;
  t781 = t780 * t117;
  t783 = t480 * t256;
  t785 = t219 * t219;
  t787 = t73 / t785;
  t788 = t488 * t244;
  t795 = t244 * t520;
  t799 = t103 * t524;
  t809 = 0.1e1 / t105 / t474;
  t813 = 0.6e1 * t787 * t222 * t788 + 0.7e1 * t487 * t492 * t488 - 0.6e1 * t487 * t222 * t795 + 0.91e2 / 0.12e2 * t221 * t799 * t244 - 0.7e1 / 0.2e1 * t221 * t492 * t520 + t221 * t222 * t623 + 0.1729e4 / 0.216e3 * t73 * t104 * t809;
  t814 = t71 * t813;
  t815 = t814 * t117;
  t816 = t47 * t47;
  t817 = 0.1e1 / t816;
  t818 = t204 * t817;
  t819 = t818 * t35;
  t822 = t627 * t437;
  t825 = t144 * t399;
  t828 = t434 * t653;
  t831 = t317 * t177;
  t836 = t188 * t663;
  t837 = t2 * t618;
  t842 = t4 * t627 * t36;
  t844 = t70 * t174;
  t846 = t125 * t844 * t177;
  t848 = t120 * t391;
  t855 = t173 * t173;
  t856 = 0.1e1 / t855;
  t857 = t8 * t856;
  t858 = t393 * t177;
  t862 = t177 * t399;
  t869 = -t684 - 0.37702333333333333334e0 * t665 + 0.2513488888888888889e0 * t686 - 0.29324037037037037038e0 * t688;
  t875 = (-0.7e1 / 0.27e2 * t842 - t846 / 0.3e1 - t125 * t848 * t393 / 0.2e1 + t125 * t386 * t399 / 0.4e1 - 0.3e1 / 0.2e1 * t125 * t857 * t858 + 0.3e1 / 0.2e1 * t125 * t392 * t862 - t125 * t175 * t869 / 0.4e1) * t79 * t142;
  t880 = t431 * t431;
  t881 = 0.1e1 / t880;
  t882 = t881 * t79;
  t883 = t882 * t81;
  t885 = 0.1e1 / t436 / t192;
  t886 = t885 * t131;
  t892 = t46 * t391;
  t893 = t892 * t132;
  t897 = t442 * t299;
  t919 = t47 * t856;
  t925 = -0.11e2 / 0.216e3 * t842 - t846 / 0.24e2 - t893 * t75 * t120 * t393 + t897 * t82 * t301 * t177 / 0.3e1 - 0.2e1 / 0.3e1 * t443 * t75 * t70 * t177 + t443 * t75 * t120 * t399 / 0.2e1 + t655 * t656 * t36 / 0.432e3 - 0.2e1 / 0.3e1 * t198 * t665 + 0.4e1 / 0.9e1 * t448 * t669 - 0.14e2 / 0.27e2 * t199 * t672 - 0.6e1 * t919 * t858 + 0.6e1 * t453 * t862 - t202 * t869;
  t926 = t925 * t205;
  t931 = 0.17251408095085947753e-4 * t819 * t295 + 0.23390302462324474053e2 * t435 * t822 + t183 * t825 / 0.3e1 - 0.33842565975395191035e0 * t828 * t822 + 0.2e1 / 0.9e1 * t183 * t831 + 0.2e1 / 0.3e1 * t405 * t411 + 0.1508712481235846919e1 * t836 * t837 * t193 + t875 * t184 / 0.3e1 - 0.92007509840458388017e-4 * t465 * t295 + 0.86312224513605868233e3 * t883 * t668 * t886 + 0.41403379428206274608e-3 * t926 * t35 + 0.82806758856412549216e-3 * t458 * t177;
  t942 = t457 * t462;
  t943 = t942 * t464;
  t946 = t177 * t131;
  t947 = t463 * t946;
  t950 = t35 * t298;
  t951 = t463 * t950;
  t956 = t5 * t226;
  t957 = t956 * t35;
  t963 = 0.1e1 / t431;
  t964 = t963 * t79;
  t965 = t964 * t81;
  t966 = t193 * t131;
  t971 = 0.1e1 / t431 / t187;
  t972 = t971 * t79;
  t973 = t972 * t81;
  t974 = t437 * t131;
  t978 = t416 * t653;
  t979 = t2 * t193;
  t983 = 0.41403379428206274608e-3 * t206 * t399 - 0.1005808320823897946e1 * t422 * t82 * t591 * t193 + 0.11734430409612142703e1 * t190 * t75 * t215 * t193 + 0.13801126476068758203e-3 * t943 * t129 + 0.13801126476068758203e-3 * t947 * t129 + 0.46003754920229194009e-4 * t951 * t361 + 0.2e1 / 0.9e1 * t405 * t408 - 0.2e1 / 0.27e2 * t183 * t957 - 0.46099548037761989191e0 * t417 * t627 * t193 + 0.2514520802059744865e0 * t965 * t668 * t966 - 0.29769475861140239704e2 * t973 * t668 * t974 + 0.20954340017164540542e-1 * t978 * t627 * t979;
  t986 = t33 * (t931 + t983) * t65;
  t988 = t149 * t663;
  t990 = t988 * t837 * t154;
  t992 = t344 * t653;
  t993 = t627 * t347;
  t994 = t992 * t993;
  t996 = t345 * t993;
  t998 = t317 * t136;
  t999 = t143 * t998;
  t1001 = t144 * t308;
  t1002 = t143 * t1001;
  t1004 = t314 * t321;
  t1008 = t120 * t289;
  t1015 = t8 * t676;
  t1027 = (-0.7e1 / 0.27e2 * t629 - t633 / 0.3e1 - t125 * t1008 * t291 / 0.2e1 + t125 * t284 * t308 / 0.4e1 - 0.3e1 / 0.2e1 * t125 * t1015 * t678 + 0.3e1 / 0.2e1 * t125 * t290 * t681 - t125 * t128 * t690 / 0.4e1) * t79 * t142;
  t1028 = t1027 * t145;
  t1030 = t314 * t318;
  t1032 = t956 * t14;
  t1033 = t143 * t1032;
  t1036 = t327 * t627 * t154;
  t1038 = 0.7e2 / 0.3e1 * t766 - 0.7e1 * t769 + 0.3e1 * t771 + 0.3e1 * t773 + 0.3e1 * t775 + 0.7e2 / 0.3e1 * t778 - 0.7e1 * t781 - 0.14e2 * t783 + t815 - t986 / 0.24e2 + 0.15906298270010708072e0 * t990 - 0.26614487661862784322e-1 * t994 + 0.18394613361864149606e1 * t996 + 0.69090444444444444446e-2 * t999 + 0.10363566666666666667e-1 * t1002 + 0.20727133333333333334e-1 * t1004 + 0.10363566666666666667e-1 * t1028 + 0.69090444444444444446e-2 * t1030 - 0.23030148148148148149e-2 * t1033 - 0.48602578047254941329e-1 * t1036;
  tv3rho30 = rho[0] * (t765 + t1038) - t472 / 0.8e1 - 0.15906298270010708072e0 * t339 + 0.4845113855772187107e-3 * t379 - 0.14e2 * t483 + 0.3e1 * t538 + 0.29070683134633122642e-2 * t372 + 0.29070683134633122642e-2 * t381 + 0.31090700000000000001e-1 * t315 + 0.31090700000000000001e-1 * t322 + 0.39765745675026770179e-1 * t329 - 0.1505013820516157695e1 * t349 + 0.7e2 / 0.3e1 * t478 - 0.14e2 * t481 + 0.3e1 * t530 + 0.6e1 * t534 + 0.10363566666666666667e-1 * t319 + 0.79531491350053540358e-1 * t335 + 0.3e1 * t533;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1063 = t476 * t110;
  t1064 = t1063 * t261;
  t1066 = t215 * t252;
  t1067 = t1066 * t117;
  t1069 = t541 * t546;
  t1071 = t70 * t528;
  t1072 = t1071 * t117;
  t1073 = t70 * t531;
  t1074 = t1073 * t117;
  t1075 = t544 * t256;
  t1077 = t520 * t116;
  t1078 = t260 * t1077;
  t1080 = 0.1e1 / t263 / t579;
  t1082 = t103 * t1080 * params->ftilde;
  t1083 = t1082 * t269;
  t1085 = t551 * t556;
  t1088 = t72 * t528 * t555;
  t1089 = t267 * t1088;
  t1092 = t72 * t531 * t555;
  t1093 = t267 * t1092;
  t1095 = 0.7e2 / 0.9e1 * t1064 - 0.14e2 / 0.3e1 * t1067 - 0.14e2 / 0.3e1 * t1069 + t1072 + t1074 + 0.2e1 * t1075 + t1078 - 0.63e2 / 0.8e1 * t1083 + 0.7e1 / 0.2e1 * t1085 - t1089 / 0.2e1 - t1093 / 0.2e1;
  tv3rho2sigma0 = -0.14e2 / 0.3e1 * t542 + 0.2e1 * t545 + 0.2e1 * t547 + 0.7e1 / 0.2e1 * t552 - t557 + rho[0] * t1095;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1098 = t549 * params->ftilde * t72;
  t1099 = t1098 * t565;
  t1102 = t563 * t252 * t555;
  t1103 = t562 * t1102;
  t1108 = 0.1e1 / t83 / t579 * t570 * t572;
  t1109 = t1108 * t575;
  t1111 = t220 * t110;
  t1112 = t1111 * t546;
  t1113 = t573 * t1112;
  t1116 = t102 * t252 * t555;
  t1117 = t573 * t1116;
  tv3rhosigma20 = -t567 + t577 + rho[0] * (0.21e2 / 0.8e1 * t1099 - 0.3e1 / 0.4e1 * t1103 - 0.7e1 / 0.6e1 * t1109 - t1113 / 0.4e1 + t1117 / 0.4e1);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1122 = 0.1e1 / t103 / sigma[0];
  t1124 = t1122 * t110 * t116;
  t1126 = 0.3e1 / 0.8e1 * t562 * t1124;
  t1127 = 0.1e1 / sigma[0];
  t1129 = t1127 * t102 * t555;
  t1131 = 0.3e1 / 0.8e1 * t573 * t1129;
  t1132 = t105 * t105;
  t1133 = t1132 * t1132;
  t1134 = t1133 * t105;
  t1137 = t570 * params->ftilde;
  t1138 = 0.1e1 / t1134 / t579 * t1137;
  t1139 = t572 * t72;
  t1140 = t1138 * t1139;
  t1142 = t220 * t563 * t555;
  t1144 = t1140 * t1142 / 0.8e1;
  tv3sigma30 = rho[0] * (t1126 + t1131 - t1144);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1146 = t474 * t68;
  t1154 = t75 * t476;
  t1157 = t82 * t569;
  t1180 = t508 * t508;
  t1186 = t518 * t518;
  t1196 = 0.1e1 / t579;
  t1201 = (0.7e2 / 0.81e2 * t74 * t1154 + 0.22e3 / 0.81e2 * t80 * t1157) * t99 - 0.4e1 * t595 * t233 * t242 + 0.12e2 * t500 * t506 * t508 - 0.6e1 * t597 * t518 - 0.24e2 * t230 * t606 * t608 + 0.24e2 * t600 * t611 - 0.4e1 * t502 * t621 + 0.24e2 * t88 / t605 / t98 * t1180 - 0.36e2 * t607 * t508 * t518 + 0.6e1 * t507 * t1186 + 0.8e1 * t507 * t242 * t621 - t234 * (0.7e2 / 0.81e2 * t89 * t1154 + 0.22e3 / 0.81e2 * t92 * t1157 + 0.57295779513082320876e5 * params->mbeta * t1196);
  t1205 = t2 * t1196;
  t1227 = t6 * t476;
  t1228 = t1227 * t437;
  t1243 = t4 * t1227 * t36;
  t1247 = t125 * t215 * t174 * t177;
  t1251 = t125 * t70 * t391 * t393;
  t1254 = t125 * t844 * t399;
  t1267 = 0.1e1 / t855 / t35;
  t1269 = t393 * t393;
  t1273 = t393 * t399;
  t1277 = t399 * t399;
  t1281 = t177 * t869;
  t1285 = t4 * t1227;
  t1286 = 0.7e2 / 0.81e2 * t1285;
  t1290 = 0.1e1 / t12 / t2 / t95 / 0.48e2;
  t1291 = t1290 * t2;
  t1293 = t1291 * t581 * t125;
  t1295 = t664 * t1196;
  t1297 = t299 * t1157;
  t1299 = t132 * t1154;
  t1301 = t1286 - 0.31418611111111111112e0 * t1293 + 0.30161866666666666668e1 * t1295 - 0.11171061728395061729e1 * t1297 + 0.97746790123456790127e0 * t1299;
  t1305 = 0.7e2 / 0.81e2 * t1243 + 0.28e2 / 0.27e2 * t1247 + 0.4e1 / 0.3e1 * t1251 - 0.2e1 / 0.3e1 * t1254 + 0.2e1 * t125 * t120 * t856 * t858 - 0.2e1 * t125 * t848 * t862 + t125 * t386 * t869 / 0.3e1 + 0.6e1 * t125 * t8 * t1267 * t1269 - 0.9e1 * t125 * t857 * t1273 + 0.3e1 / 0.2e1 * t125 * t392 * t1277 + 0.2e1 * t125 * t392 * t1281 - t125 * t175 * t1301 / 0.4e1;
  t1312 = -0.12069699849886775352e2 * t836 * t1205 * t193 - 0.59538951722280479408e2 * t971 * t2 * t1196 * t437 * t298 + 0.502904160411948973e0 * t963 * t2 * t1196 * t193 * t298 + 0.17262444902721173647e4 * t881 * t2 * t1196 * t885 * t298 + t183 * t317 * t399 / 0.3e1 + 0.24817881715289806759e1 * t828 * t1228 - 0.9834558989840972045e2 * t435 * t1228 + t183 * t144 * t869 / 0.3e1 + t405 * t825 + t875 * t408 / 0.3e1 - 0.2e1 / 0.9e1 * t183 * t956 * t177 + t1305 * t79 * t142 * t184 / 0.3e1 + 0.2e1 / 0.3e1 * t405 * t831;
  t1323 = t436 * t436;
  t1327 = t79 * t142 * t5;
  t1331 = 0.1e1 / t431 / t414;
  t1337 = 0.1e1 / t880 / t41;
  t1348 = t142 * t5;
  t1350 = t569 * t2;
  t1361 = t653 * t6 * t656;
  t1368 = t875 * t411 + 0.193827645158772e1 * t415 * t476 * t193 * t125 - 0.2e1 / 0.9e1 * t405 * t957 - 0.13939962557599514819e5 / t880 / t414 * t569 / t1323 * t1327 - 0.13537026390158076414e1 * t1331 * t569 * t437 * t1327 + 0.32053040088061616249e3 * t1337 * t569 * t885 * t1327 + 0.27602252952137516405e-3 * t463 * t35 * t665 + 0.1e2 / 0.81e2 * t183 * t360 * t35 + 0.41908680034329081084e-1 * t964 * t1348 * t1350 * t966 + 0.13801126476068758203e-3 * t463 * t177 * t298 * t361 + 0.28752346825143246256e-5 * t818 * t35 * t1 * t1361 + 0.41403379428206274608e-3 * t206 * t869 + 0.12421013828461882382e-2 * t926 * t177;
  t1374 = t581 * t1 * t75;
  t1418 = -0.5e1 / 0.9e1 * t198 * t1291 * t1374 - 0.4e1 / 0.3e1 * t892 * t299 * t82 * t301 * t393 + 0.2e1 / 0.3e1 * t897 * t82 * t301 * t399 - 0.4e1 / 0.3e1 * t443 * t75 * t70 * t399 + 0.2e1 / 0.3e1 * t443 * t75 * t120 * t869 + 0.56e2 / 0.27e2 * t443 * t75 * t215 * t177 + 0.4e1 * t46 * t856 * t132 * t75 * t120 * t858 + 0.8e1 / 0.3e1 * t893 * t75 * t70 * t393 - 0.16e2 / 0.9e1 * t897 * t82 * t591 * t177 - 0.36e2 * t919 * t1273 + 0.8e1 * t453 * t1281 + 0.16e2 / 0.3e1 * t198 * t1295;
  t1430 = t476 * t2;
  t1445 = t5 * t569;
  t1446 = t359 * t1445;
  t1451 = 0.185e3 / 0.864e3 * t1243 - 0.4e1 * t893 * t75 * t444 * t399 + 0.8e1 / 0.3e1 * t442 * t663 * t837 * t177 - t1254 / 0.12e2 + 0.11e2 / 0.54e2 * t1247 - 0.11e2 / 0.648e3 * t655 * t1430 * t36 + t1251 / 0.6e1 - t202 * t1301 + 0.24e2 * t47 * t1267 * t1269 + 0.6e1 * t453 * t1277 - t655 * t656 * t174 * t177 / 0.108e3 - 0.16e3 / 0.81e2 * t448 * t1446 + 0.14e3 / 0.81e2 * t199 * t1285;
  t1475 = t2 * t581;
  t1489 = t82 * t591 * t131;
  t1497 = 0.12421013828461882382e-2 * t458 * t399 + 0.41403379428206274608e-3 * (t1418 + t1451) * t205 * t35 + 0.13801126476068758203e-3 * t942 * t950 * t361 + 0.41403379428206274609e-3 * t942 * t946 * t129 + 0.20701689714103137304e-3 * t463 * t399 * t131 * t129 + 0.20701689714103137304e-3 * t925 * t462 * t464 * t129 - 0.27602252952137516406e-3 * t947 * t295 - 0.18401501968091677604e-3 * t951 * t669 + 0.12572604010298724325e1 * t188 * t1290 * t1475 * t193 * t1 * t75 - 0.27602252952137516406e-3 * t943 * t295 + 0.23001877460114597004e-4 * t204 / t816 / t46 * t35 * t79 * t1489 + 0.21468418962773623871e-3 * t465 * t672 - 0.18439819215104795676e1 * t965 * t1445 * t966;
  t1520 = t1445 * t974;
  t1524 = t1445 * t886;
  t1548 = 0.16763472013731632433e0 * t433 * t2 * t569 * t193 * t79 * t1348 - 0.29769475861140239704e2 * t1331 * t2 * t569 * t437 * t79 * t1348 - 0.15366516012587329731e0 * t978 * t1227 * t979 + 0.11508296601814115764e4 * t1337 * t2 * t569 * t885 * t79 * t1348 - 0.15793197455184422483e1 * t972 * t142 * t1520 + 0.45790057268659451785e2 * t882 * t142 * t1524 + 0.51754224285257843261e-4 * t457 * t817 * t35 * t295 + 0.51754224285257843261e-4 * t818 * t177 * t295 + 0.21830948964836175782e3 * t973 * t1520 - 0.63295631309977636704e4 * t883 * t1524 - 0.39114768032040475677e1 * t190 * t75 * t476 * t193 + 0.44702592036617686488e1 * t422 * t82 * t569 * t193 - 0.63255163015315141761e-4 * t819 * t672;
  t1566 = t528 * t528;
  t1573 = t531 * t531;
  t1590 = 0.1456e5 / 0.81e2 * sigma[0] / t7 / t1146 * t117 - 0.364e4 / 0.27e2 * t582 * t256 + t71 * t110 * t1201 * t116 - t33 * (t1312 + t1368 + t1497 + t1548) * t65 / 0.24e2 - 0.28e2 / 0.3e1 * t216 * t625 + 0.14e3 / 0.3e1 * t477 * t537 + 0.4e1 * t253 * t625 - 0.28e2 * t480 * t537 + 0.6e1 * t532 * t537 - 0.28e2 * t780 * t256 + 0.3e1 * t71 * t1566 * t117 - 0.28e2 / 0.3e1 * t216 * t762 * t117 + t71 * t1573 * t117 + 0.14e3 / 0.3e1 * t477 * t531 * t117 + 0.4e1 * t763 * t256 + 0.4e1 * t814 * t256 + 0.6e1 * t529 * t537 - 0.28e2 * t768 * t256 + 0.14e3 / 0.3e1 * t477 * t528 * t117;
  t1635 = t488 * t488;
  t1652 = t520 * t520;
  t1677 = -0.24e2 * t73 / t785 / t101 * t222 * t1635 - 0.28e2 * t787 * t492 * t788 + 0.36e2 * t787 * t222 * t488 * t520 - 0.91e2 / 0.3e1 * t487 * t799 * t488 + 0.28e2 * t487 * t492 * t795 - 0.6e1 * t487 * t222 * t1652 - 0.8e1 * t487 * t222 * t244 * t623 - 0.1729e4 / 0.54e2 * t221 * t103 * t809 * t244 + 0.91e2 / 0.6e1 * t221 * t799 * t520 - 0.14e2 / 0.3e1 * t221 * t492 * t623 + t221 * t222 * t1201 - 0.43225e5 / 0.1296e4 * t73 * t104 / t105 / t579;
  t1702 = 0.4845113855772187107e-3 * t692 * t375 * t377 * t129 + 0.9690227711544374214e-3 * t700 * t704 * t129 + 0.53834598397468745633e-4 * t165 / t756 / t27 * t14 * t79 * t1489 + 0.44184161861140855756e-2 * t727 * t1348 * t1350 * t729 + 0.67293247996835932044e-5 * t758 * t14 * t1 * t1361 + 0.3230075903848124738e-3 * t700 * t708 * t361 + 0.3230075903848124738e-3 * t376 * t136 * t298 * t361 + 0.4845113855772187107e-3 * t376 * t308 * t131 * t129 - 0.364e4 / 0.27e2 * t582 * t252 * t117 - 0.28e2 / 0.3e1 * t216 * t813 * t117 + 0.28e3 / 0.3e1 * t777 * t256 + t71 * t1677 * t117 - 0.12725038616008566457e1 * t988 * t1205 * t154 + 0.10363566666666666667e-1 * t1027 * t318 + 0.19517290952032708503e0 * t992 * t1227 * t347 - 0.69090444444444444446e-2 * t143 * t956 * t136 + 0.31090700000000000001e-1 * t1027 * t321 + 0.10363566666666666667e-1 * t143 * t317 * t308 + 0.31090700000000000001e-1 * t314 * t1001 + 0.20435174860777645786e0 * t325 * t476 * t154 * t125;
  t1711 = t4 * t1227 * t15;
  t1715 = t125 * t215 * t127 * t136;
  t1719 = t125 * t70 * t289 * t291;
  t1722 = t125 * t631 * t308;
  t1735 = 0.1e1 / t675 / t14;
  t1737 = t291 * t291;
  t1741 = t291 * t308;
  t1745 = t308 * t308;
  t1749 = t136 * t690;
  t1757 = t1286 - 0.10354e1 * t1293 + 0.993984e1 * t1295 - 0.36814222222222222222e1 * t1297 + 0.32212444444444444444e1 * t1299;
  t1761 = 0.7e2 / 0.81e2 * t1711 + 0.28e2 / 0.27e2 * t1715 + 0.4e1 / 0.3e1 * t1719 - 0.2e1 / 0.3e1 * t1722 + 0.2e1 * t125 * t120 * t676 * t678 - 0.2e1 * t125 * t1008 * t681 + t125 * t284 * t690 / 0.3e1 + 0.6e1 * t125 * t8 * t1735 * t1737 - 0.9e1 * t125 * t1015 * t1741 + 0.3e1 / 0.2e1 * t125 * t290 * t1745 + 0.2e1 * t125 * t290 * t1749 - t125 * t128 * t1757 / 0.4e1;
  t1790 = 0.1e1 / t746 / t21;
  t1798 = t346 * t346;
  t1804 = 0.1e1 / t341 / t324;
  t1847 = 0.16e2 / 0.3e1 * t159 * t1295 - 0.4e1 * t636 * t75 * t354 * t308 + 0.8e1 / 0.3e1 * t352 * t663 * t837 * t136 - 0.11e2 / 0.648e3 * t655 * t1430 * t15 + 0.185e3 / 0.864e3 * t1711 + 0.11e2 / 0.54e2 * t1715 + t1719 / 0.6e1 - t1722 / 0.12e2 - 0.36e2 * t677 * t1741 + 0.8e1 * t366 * t1749 - t163 * t1757 + 0.24e2 * t28 * t1735 * t1737;
  t1896 = 0.6e1 * t366 * t1745 + 0.56e2 / 0.27e2 * t353 * t75 * t215 * t136 - 0.4e1 / 0.3e1 * t635 * t299 * t82 * t301 * t291 + 0.2e1 / 0.3e1 * t640 * t82 * t301 * t308 - 0.4e1 / 0.3e1 * t353 * t75 * t70 * t308 + 0.2e1 / 0.3e1 * t353 * t75 * t120 * t690 - 0.5e1 / 0.9e1 * t159 * t1291 * t1374 + 0.4e1 * t27 * t676 * t132 * t75 * t120 * t678 + 0.8e1 / 0.3e1 * t636 * t75 * t70 * t291 - 0.16e2 / 0.9e1 * t640 * t82 * t591 * t136 - t655 * t656 * t127 * t136 / 0.108e3 - 0.16e3 / 0.81e2 * t358 * t1446 + 0.14e3 / 0.81e2 * t160 * t1285;
  t1903 = -0.77340987998746992661e1 * t343 * t476 * t347 * t125 + 0.20727133333333333334e-1 * t314 * t998 + 0.10363566666666666667e-1 * t1761 * t79 * t142 * t145 + 0.10363566666666666667e-1 * t143 * t144 * t690 + 0.10126265704850360339e3 * t747 * t2 * t1196 * t751 * t298 + 0.53020994233369026904e-1 * t726 * t2 * t1196 * t154 * t298 - 0.46822652193836017178e1 * t734 * t2 * t1196 * t347 * t298 - 0.69090444444444444446e-2 * t314 * t1032 + 0.38383580246913580248e-2 * t143 * t360 * t14 + 0.18802527823203489287e2 * t1790 * t569 * t751 * t1327 - 0.60995923043525943529e3 / t746 / t324 * t569 / t1798 * t1327 - 0.10645795064745113728e0 * t1804 * t569 * t347 * t1327 + 0.64601518076962494762e-3 * t376 * t14 * t665 + 0.96902277115443742139e-3 * t167 * t690 + 0.29070683134633122642e-2 * t693 * t136 + 0.29070683134633122642e-2 * t371 * t308 - 0.6460151807696249476e-3 * t701 * t295 - 0.6460151807696249476e-3 * t705 * t295 + 0.96902277115443742139e-3 * (t1847 + t1896) * t166 * t14 - 0.43067678717974996507e-3 * t709 * t669;
  t1954 = t1445 * t737;
  t1958 = t1445 * t752;
  t1965 = t722 * t546;
  t1976 = 0.13255248558342256727e0 * t149 * t1290 * t1475 * t154 * t1 * t75 + 0.50245625170970829257e-3 * t378 * t672 + 0.67508438032335735592e2 * t1790 * t2 * t569 * t751 * t79 * t1348 - 0.19441031218901976532e0 * t728 * t1445 * t729 + 0.17673664744456342301e-1 * t343 * t2 * t569 * t154 * t79 * t1348 - 0.23411326096918008589e1 * t1804 * t2 * t569 * t347 * t79 * t1348 + 0.47129772651883579471e0 * t332 * t82 * t569 * t154 - 0.41238551070398132037e0 * t151 * t75 * t476 * t154 + 0.12112784639430467768e-3 * t370 * t757 * t14 * t295 + 0.12112784639430467768e-3 * t758 * t136 * t295 - 0.16200859349084980444e-1 * t741 * t1227 * t742 - 0.14804514559303905049e-3 * t759 * t672 - 0.12420094242202632684e0 * t735 * t142 * t1954 + 0.26860754033147841838e1 * t748 * t142 * t1958 + 0.17168305804406539632e2 * t736 * t1954 - 0.37129640917784654576e3 * t749 * t1958 + 0.12e2 * t529 * t1965 + 0.4e1 * t814 * t723 - 0.28e2 * t780 * t723 + 0.6e1 * t529 * t531 * t110 * t261;
  t1999 = rho[0] * (t1590 + t1702 + t1903 + t1976) - 0.364e4 / 0.27e2 * t583 - 0.28e2 * t585 + 0.4e1 * t626 + 0.38760910846177496856e-2 * t694 + 0.77521821692354993712e-2 * t696 + 0.38760910846177496856e-2 * t698 + 0.12920303615392498952e-2 * t702 + 0.12920303615392498952e-2 * t706 + 0.43067678717974996507e-3 * t710 - 0.86135357435949993013e-3 * t712 - 0.42416795386695221524e0 * t716 + 0.49486261284477758446e0 * t720 + 0.12e2 * t724 + 0.10604198846673805381e0 * t731 - 0.93645304387672034355e1 * t739 + 0.8836832372228171151e-2 * t744 + 0.20252531409700720677e3 * t754 + 0.1615037951924062369e-3 * t760 + 0.4e1 * t764;
  t2020 = 0.28e3 / 0.3e1 * t766 - 0.28e2 * t769 + 0.12e2 * t771 + 0.12e2 * t773 + 0.12e2 * t775 + 0.28e3 / 0.3e1 * t778 - 0.28e2 * t781 - 0.56e2 * t783 + 0.4e1 * t815 - t986 / 0.6e1 + 0.63625193080042832287e0 * t990 - 0.10645795064745113729e0 * t994 + 0.73578453447456598423e1 * t996 + 0.27636177777777777779e-1 * t999 + 0.41454266666666666668e-1 * t1002 + 0.82908533333333333336e-1 * t1004 + 0.41454266666666666668e-1 * t1028 + 0.27636177777777777779e-1 * t1030 - 0.92120592592592592596e-2 * t1033 - 0.19441031218901976532e0 * t1036;
  tv4rho40 = t1999 + t2020;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2080 = -0.91e3 / 0.27e2 * t581 * t110 * t261 - t267 * t72 * t813 * t555 / 0.2e1 + 0.693e3 / 0.16e2 * t103 / t263 / t1146 * params->ftilde * t269 - 0.189e3 / 0.8e1 * t1082 * t556 + 0.21e2 / 0.4e1 * t551 * t1088 + t260 * t623 * t116 + 0.7e2 / 0.3e1 * t1063 * t546 - 0.7e1 * t541 * t1077 + 0.21e2 / 0.4e1 * t551 * t1092 - 0.3e1 / 0.2e1 * t266 * t73 * t528 * t252 * t555 - t267 * t72 * t762 * t555 / 0.2e1;
  tv4rho3sigma0 = rho[0] * (0.3e1 * t544 * t537 + 0.3e1 * t1071 * t256 + 0.3e1 * t1073 * t256 + t70 * t762 * t117 - 0.7e1 * t215 * t531 * t117 + 0.3e1 * t1071 * t252 * t117 + t70 * t813 * t117 + 0.7e2 / 0.3e1 * t476 * t252 * t117 - 0.7e1 * t215 * t528 * t117 - 0.14e2 * t1066 * t256 + t2080) + 0.3e1 * t1078 - 0.14e2 * t1067 + 0.3e1 * t1072 + 0.6e1 * t1075 + 0.7e2 / 0.3e1 * t1064 - 0.189e3 / 0.8e1 * t1083 + 0.21e2 / 0.2e1 * t1085 - 0.3e1 / 0.2e1 * t1089 + 0.3e1 * t1074 - 0.14e2 * t1069 - 0.3e1 / 0.2e1 * t1093;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2143 = -0.189e3 / 0.16e2 * t1080 * params->ftilde * t72 * t565 + 0.21e2 / 0.4e1 * t1098 * t1102 - 0.3e1 / 0.4e1 * t562 * t563 * t528 * t555 - 0.3e1 / 0.4e1 * t562 * t563 * t531 * t555 + 0.119e3 / 0.18e2 / t83 / t1146 * t570 * t572 * t575 + 0.7e1 / 0.3e1 * t1108 * t1112 - 0.7e1 / 0.3e1 * t1108 * t1116 + t573 * t486 * t110 * t116 * t488 / 0.2e1 - t571 * t572 * t220 * t1965 / 0.2e1 - t573 * t1111 * t1077 / 0.4e1 + t573 * t102 * t528 * t555 / 0.4e1 + t573 * t102 * t531 * t555 / 0.4e1;
  tv4rho2sigma20 = 0.21e2 / 0.4e1 * t1099 - 0.3e1 / 0.2e1 * t1103 - 0.7e1 / 0.3e1 * t1109 - t1113 / 0.2e1 + t1117 / 0.2e1 + rho[0] * t2143;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2154 = t571 * t572 * t1127;
  tv4rhosigma30 = t1126 + t1131 - t1144 + rho[0] * (-0.21e2 / 0.16e2 * t1098 * t1124 + 0.3e1 / 0.8e1 * t562 * t1122 * t252 * t555 - 0.7e1 / 0.4e1 * t1108 * t1129 - 0.3e1 / 0.8e1 * t2154 * t1112 + 0.3e1 / 0.8e1 * t2154 * t1116 + 0.35e2 / 0.48e2 / t1134 / t1146 * t1137 * t1139 * t1142 + t1138 * t1139 * t486 * t564 * t546 / 0.4e1 - t1138 * t1139 * t220 * t1102 / 0.8e1);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t2176 = sigma[0] * sigma[0];
  t2194 = t570 * t570;
  t2196 = t572 * t572;
  tv4sigma40 = rho[0] * (-0.9e1 / 0.16e2 * t562 / t103 / t2176 * t110 * t116 - 0.9e1 / 0.16e2 * t573 / t2176 * t102 * t555 - t1140 * t1122 * t220 * t555 / 0.8e1 + 0.1e1 / t474 / t213 * t2194 * t2196 * t486 * t1127 * t555 / 0.16e2);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t15, t16, t20;
  double t21, t22, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t36, t37, t41, t42, t45;
  double t47, t48, t50, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t72, t74;
  double t75, t76, t77, t78, t79, t83, t84, t86;
  double t88, t89, t93, t95, t98, t100, t101, t103;
  double t105, t106, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t119, t122, t123, t124;
  double t125, t126, t127, t128, t131, t132, t135, t140;
  double t141, t143, t144, t145, t146, t147, t149, t152;
  double t153, t154, t155, t156, t157, t158, t159, t160;
  double t161, t162, t163, t164, t165, t166, t167, t168;
  double tzk0;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = rho[0] + rho[1];
  t8 = POW_1_3(t7);
  t9 = 0.1e1 / t8;
  t10 = t6 * t9;
  t11 = t4 * t10;
  t12 = t11 / 0.4e1;
  t13 = sqrt(t11);
  t15 = t12 + 0.186372e1 * t13 + 0.129352e2;
  t16 = 0.1e1 / t15;
  t20 = log(t4 * t10 * t16 / 0.4e1);
  t21 = 0.310907e-1 * t20;
  t22 = t13 + 0.372744e1;
  t25 = atan(0.61519908197590802322e1 / t22);
  t26 = 0.38783294878113014393e-1 * t25;
  t27 = t13 / 0.2e1;
  t28 = t27 + 0.10498e0;
  t29 = t28 * t28;
  t31 = log(t29 * t16);
  t32 = 0.96902277115443742139e-3 * t31;
  t33 = M_PI * M_PI;
  t34 = 0.1e1 / t33;
  t36 = t12 + 0.565535e0 * t13 + 0.130045e2;
  t37 = 0.1e1 / t36;
  t41 = log(t4 * t10 * t37 / 0.4e1);
  t42 = t13 + 0.113107e1;
  t45 = atan(0.71231089178181179908e1 / t42);
  t47 = t27 + 0.47584e-2;
  t48 = t47 * t47;
  t50 = log(t48 * t37);
  t53 = t34 * (t41 + 0.317708004743941464e0 * t45 + 0.41403379428206274608e-3 * t50);
  t54 = rho[0] - rho[1];
  t55 = 0.1e1 / t7;
  t56 = t54 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t62 = t61 * t57;
  t63 = my_piecewise3(t58, t60, t62);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t67 = t66 * t64;
  t68 = my_piecewise3(t65, t60, t67);
  t69 = t63 + t68 - 0.2e1;
  t70 = t53 * t69;
  t71 = M_CBRT2;
  t72 = t71 - 0.1e1;
  t74 = 0.1e1 / t72 / 0.2e1;
  t75 = t54 * t54;
  t76 = t75 * t75;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = 0.1e1 / t78;
  t83 = 0.9e1 * t72;
  t84 = t74 * (-t76 * t79 + 0.1e1) * t83;
  t86 = t70 * t84 / 0.24e2;
  t88 = t12 + 0.353021e1 * t13 + 0.180578e2;
  t89 = 0.1e1 / t88;
  t93 = log(t4 * t10 * t89 / 0.4e1);
  t95 = t13 + 0.706042e1;
  t98 = atan(0.473092690956011283e1 / t95);
  t100 = t27 + 0.325e0;
  t101 = t100 * t100;
  t103 = log(t101 * t89);
  t105 = 0.1554535e-1 * t93 + 0.52491393169780936218e-1 * t98 + 0.22478670955426118383e-2 * t103 - t21 - t26 - t32;
  t106 = t105 * t69;
  t107 = t74 * t76;
  t108 = t107 * t79;
  t109 = t106 * t108;
  t111 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t113 = 0.1e1 / t8 / t77;
  t114 = t111 * t113;
  t115 = params->aa + params->bb;
  t116 = params->ftilde * t115;
  t117 = params->malpha * t1;
  t118 = t3 * t6;
  t119 = t118 * t9;
  t122 = t1 * t1;
  t123 = params->mbeta * t122;
  t124 = t3 * t3;
  t125 = t124 * t5;
  t126 = t8 * t8;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t131 = params->bb + t117 * t119 / 0.4e1 + t123 * t128 / 0.4e1;
  t132 = params->mgamma * t1;
  t135 = params->mdelta * t122;
  t140 = 0.1e1 + t132 * t119 / 0.4e1 + t135 * t128 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t55;
  t141 = 0.1e1 / t140;
  t143 = t131 * t141 + params->aa;
  t144 = 0.1e1 / t143;
  t145 = sqrt(t111);
  t146 = t144 * t145;
  t147 = pow(t7, 0.1e1 / 0.6e1);
  t149 = 0.1e1 / t147 / t7;
  t152 = exp(-t116 * t146 * t149);
  t153 = t114 * t152;
  t154 = t59 * t59;
  t155 = t154 * p->zeta_threshold;
  t156 = t61 * t61;
  t157 = t156 * t57;
  t158 = my_piecewise3(t58, t155, t157);
  t159 = t66 * t66;
  t160 = t159 * t64;
  t161 = my_piecewise3(t65, t155, t160);
  t162 = t158 + t161;
  t163 = sqrt(t162);
  t164 = 0.1e1 / t163;
  t165 = t143 * t164;
  t166 = M_SQRT2;
  t167 = t165 * t166;
  t168 = t153 * t167;
  tzk0 = t21 + t26 + t32 - t86 + t109 + t168;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t15, t16, t20;
  double t21, t22, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t36, t37, t41, t42, t45;
  double t47, t48, t50, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t72, t74;
  double t75, t76, t77, t78, t79, t83, t84, t86;
  double t88, t89, t93, t95, t98, t100, t101, t103;
  double t105, t106, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t119, t122, t123, t124;
  double t125, t126, t127, t128, t131, t132, t135, t140;
  double t141, t143, t144, t145, t146, t147, t149, t152;
  double t153, t154, t155, t156, t157, t158, t159, t160;
  double t161, t162, t163, t164, t165, t166, t167, t168;
  double tzk0;

  double t170, t171, t175, t176, t177, t178, t179, t180;
  double t181, t182, t183, t184, t186, t192, t193, t194;
  double t195, t196, t197, t198, t199, t201, t203, t204;
  double t207, t208, t209, t210, t213, t215, t216, t217;
  double t218, t219, t223, t224, t225, t227, t233, t234;
  double t237, t238, t240, t242, t243, t248, t249, t252;
  double t254, t255, t256, t260, t261, t262, t263, t264;
  double t265, t266, t269, t270, t273, t274, t275, t276;
  double t277, t278, t279, t280, t281, t282, t286, t287;
  double t288, t292, t293, t294, t296, t302, t303, t306;
  double t307, t309, t311, t312, t317, t318, t321, t323;
  double t324, t325, t328, t329, t330, t331, t332, t333;
  double t334, t335, t336, t337, t338, t339, t340, t342;
  double t343, t344, t345, t346, t347, t348, t349, t350;
  double t354, t355, t358, t360, t361, t362, t369, t371;
  double t375, t379, t380, t381, t382, t383, t384, t386;
  double t387, t389, t390, t393, t396, t397, t398, t399;
  double t400, t401, t402, tvrho0, t404, t407, t408, t411;
  double t412, t413, t414, t415, t419, t420, t421, t422;
  double t423, t426, t429, t430, t431, t432, t433, t434;
  double t435, tvrho1, t437, t438, t439, t441, t442, t445;
  double t446, t447, tvsigma0, t449, tvsigma1, tvsigma2;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = rho[0] + rho[1];
  t8 = POW_1_3(t7);
  t9 = 0.1e1 / t8;
  t10 = t6 * t9;
  t11 = t4 * t10;
  t12 = t11 / 0.4e1;
  t13 = sqrt(t11);
  t15 = t12 + 0.186372e1 * t13 + 0.129352e2;
  t16 = 0.1e1 / t15;
  t20 = log(t4 * t10 * t16 / 0.4e1);
  t21 = 0.310907e-1 * t20;
  t22 = t13 + 0.372744e1;
  t25 = atan(0.61519908197590802322e1 / t22);
  t26 = 0.38783294878113014393e-1 * t25;
  t27 = t13 / 0.2e1;
  t28 = t27 + 0.10498e0;
  t29 = t28 * t28;
  t31 = log(t29 * t16);
  t32 = 0.96902277115443742139e-3 * t31;
  t33 = M_PI * M_PI;
  t34 = 0.1e1 / t33;
  t36 = t12 + 0.565535e0 * t13 + 0.130045e2;
  t37 = 0.1e1 / t36;
  t41 = log(t4 * t10 * t37 / 0.4e1);
  t42 = t13 + 0.113107e1;
  t45 = atan(0.71231089178181179908e1 / t42);
  t47 = t27 + 0.47584e-2;
  t48 = t47 * t47;
  t50 = log(t48 * t37);
  t53 = t34 * (t41 + 0.317708004743941464e0 * t45 + 0.41403379428206274608e-3 * t50);
  t54 = rho[0] - rho[1];
  t55 = 0.1e1 / t7;
  t56 = t54 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t62 = t61 * t57;
  t63 = my_piecewise3(t58, t60, t62);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t67 = t66 * t64;
  t68 = my_piecewise3(t65, t60, t67);
  t69 = t63 + t68 - 0.2e1;
  t70 = t53 * t69;
  t71 = M_CBRT2;
  t72 = t71 - 0.1e1;
  t74 = 0.1e1 / t72 / 0.2e1;
  t75 = t54 * t54;
  t76 = t75 * t75;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = 0.1e1 / t78;
  t83 = 0.9e1 * t72;
  t84 = t74 * (-t76 * t79 + 0.1e1) * t83;
  t86 = t70 * t84 / 0.24e2;
  t88 = t12 + 0.353021e1 * t13 + 0.180578e2;
  t89 = 0.1e1 / t88;
  t93 = log(t4 * t10 * t89 / 0.4e1);
  t95 = t13 + 0.706042e1;
  t98 = atan(0.473092690956011283e1 / t95);
  t100 = t27 + 0.325e0;
  t101 = t100 * t100;
  t103 = log(t101 * t89);
  t105 = 0.1554535e-1 * t93 + 0.52491393169780936218e-1 * t98 + 0.22478670955426118383e-2 * t103 - t21 - t26 - t32;
  t106 = t105 * t69;
  t107 = t74 * t76;
  t108 = t107 * t79;
  t109 = t106 * t108;
  t111 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t113 = 0.1e1 / t8 / t77;
  t114 = t111 * t113;
  t115 = params->aa + params->bb;
  t116 = params->ftilde * t115;
  t117 = params->malpha * t1;
  t118 = t3 * t6;
  t119 = t118 * t9;
  t122 = t1 * t1;
  t123 = params->mbeta * t122;
  t124 = t3 * t3;
  t125 = t124 * t5;
  t126 = t8 * t8;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t131 = params->bb + t117 * t119 / 0.4e1 + t123 * t128 / 0.4e1;
  t132 = params->mgamma * t1;
  t135 = params->mdelta * t122;
  t140 = 0.1e1 + t132 * t119 / 0.4e1 + t135 * t128 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t55;
  t141 = 0.1e1 / t140;
  t143 = t131 * t141 + params->aa;
  t144 = 0.1e1 / t143;
  t145 = sqrt(t111);
  t146 = t144 * t145;
  t147 = pow(t7, 0.1e1 / 0.6e1);
  t149 = 0.1e1 / t147 / t7;
  t152 = exp(-t116 * t146 * t149);
  t153 = t114 * t152;
  t154 = t59 * t59;
  t155 = t154 * p->zeta_threshold;
  t156 = t61 * t61;
  t157 = t156 * t57;
  t158 = my_piecewise3(t58, t155, t157);
  t159 = t66 * t66;
  t160 = t159 * t64;
  t161 = my_piecewise3(t65, t155, t160);
  t162 = t158 + t161;
  t163 = sqrt(t162);
  t164 = 0.1e1 / t163;
  t165 = t143 * t164;
  t166 = M_SQRT2;
  t167 = t165 * t166;
  t168 = t153 * t167;
  tzk0 = t21 + t26 + t32 - t86 + t109 + t168;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t170 = 0.1e1 / t8 / t7;
  t171 = t6 * t170;
  t175 = t4 * t6;
  t176 = t15 * t15;
  t177 = 0.1e1 / t176;
  t178 = t9 * t177;
  t179 = t4 * t171;
  t180 = t179 / 0.12e2;
  t181 = 0.1e1 / t13;
  t182 = t181 * t1;
  t183 = t118 * t170;
  t184 = t182 * t183;
  t186 = -t180 - 0.31062e0 * t184;
  t192 = 0.1e1 / t3;
  t193 = (-t4 * t171 * t16 / 0.12e2 - t175 * t178 * t186 / 0.4e1) * t122 * t192;
  t194 = t5 * t8;
  t195 = t194 * t15;
  t196 = t193 * t195;
  t197 = 0.10363566666666666667e-1 * t196;
  t198 = t22 * t22;
  t199 = 0.1e1 / t198;
  t201 = t199 * t181 * t1;
  t203 = 0.378469910464e2 * t199 + 0.1e1;
  t204 = 0.1e1 / t203;
  t207 = t201 * t118 * t170 * t204;
  t208 = 0.39765745675026770179e-1 * t207;
  t209 = t28 * t16;
  t210 = t209 * t181;
  t213 = t29 * t177;
  t215 = -t210 * t179 / 0.6e1 - t213 * t186;
  t216 = 0.1e1 / t29;
  t217 = t215 * t216;
  t218 = t217 * t15;
  t219 = 0.96902277115443742139e-3 * t218;
  t223 = t36 * t36;
  t224 = 0.1e1 / t223;
  t225 = t9 * t224;
  t227 = -t180 - 0.94255833333333333334e-1 * t184;
  t233 = (-t4 * t171 * t37 / 0.12e2 - t175 * t225 * t227 / 0.4e1) * t122 * t192;
  t234 = t194 * t36;
  t237 = t42 * t42;
  t238 = 0.1e1 / t237;
  t240 = t238 * t181 * t1;
  t242 = 0.50738680655100000001e2 * t238 + 0.1e1;
  t243 = 0.1e1 / t242;
  t248 = t47 * t37;
  t249 = t248 * t181;
  t252 = t48 * t224;
  t254 = -t249 * t179 / 0.6e1 - t252 * t227;
  t255 = 0.1e1 / t48;
  t256 = t254 * t255;
  t260 = t34 * (t233 * t234 / 0.3e1 + 0.37717812030896172975e0 * t240 * t118 * t170 * t243 + 0.41403379428206274608e-3 * t256 * t36);
  t261 = t260 * t69;
  t262 = t261 * t84;
  t263 = t262 / 0.24e2;
  t264 = 0.1e1 / t77;
  t265 = t54 * t264;
  t266 = t55 - t265;
  t269 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t266);
  t270 = -t266;
  t273 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t270);
  t274 = t269 + t273;
  t275 = t53 * t274;
  t276 = t275 * t84;
  t277 = t276 / 0.24e2;
  t278 = t75 * t54;
  t279 = t278 * t79;
  t280 = t78 * t7;
  t281 = 0.1e1 / t280;
  t282 = t76 * t281;
  t286 = t74 * (-0.4e1 * t279 + 0.4e1 * t282) * t83;
  t287 = t70 * t286;
  t288 = t287 / 0.24e2;
  t292 = t88 * t88;
  t293 = 0.1e1 / t292;
  t294 = t9 * t293;
  t296 = -t180 - 0.58836833333333333333e0 * t184;
  t302 = (-t4 * t171 * t89 / 0.12e2 - t175 * t294 * t296 / 0.4e1) * t122 * t192;
  t303 = t194 * t88;
  t306 = t95 * t95;
  t307 = 0.1e1 / t306;
  t309 = t307 * t181 * t1;
  t311 = 0.223816694236e2 * t307 + 0.1e1;
  t312 = 0.1e1 / t311;
  t317 = t100 * t89;
  t318 = t317 * t181;
  t321 = t101 * t293;
  t323 = -t318 * t179 / 0.6e1 - t321 * t296;
  t324 = 0.1e1 / t101;
  t325 = t323 * t324;
  t328 = 0.51817833333333333333e-2 * t302 * t303 + 0.41388824077869423261e-1 * t309 * t118 * t170 * t312 + 0.22478670955426118383e-2 * t325 * t88 - t197 - t208 - t219;
  t329 = t328 * t69;
  t330 = t329 * t108;
  t331 = t105 * t274;
  t332 = t331 * t108;
  t333 = t74 * t278;
  t334 = t333 * t79;
  t335 = t106 * t334;
  t336 = 0.4e1 * t335;
  t337 = t107 * t281;
  t338 = t106 * t337;
  t339 = 0.4e1 * t338;
  t340 = t77 * t7;
  t342 = 0.1e1 / t8 / t340;
  t343 = t111 * t342;
  t344 = t343 * t152;
  t345 = t344 * t167;
  t346 = 0.7e1 / 0.3e1 * t345;
  t347 = t143 * t143;
  t348 = 0.1e1 / t347;
  t349 = t116 * t348;
  t350 = t145 * t149;
  t354 = 0.1e1 / t126 / t7;
  t355 = t125 * t354;
  t358 = -t117 * t183 / 0.12e2 - t123 * t355 / 0.6e1;
  t360 = t140 * t140;
  t361 = 0.1e1 / t360;
  t362 = t131 * t361;
  t369 = -t132 * t183 / 0.12e2 - t135 * t355 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta * t264;
  t371 = t141 * t358 - t362 * t369;
  t375 = 0.1e1 / t147 / t77;
  t379 = t349 * t350 * t371 + 0.7e1 / 0.6e1 * t116 * t146 * t375;
  t380 = t114 * t379;
  t381 = t152 * t143;
  t382 = t164 * t166;
  t383 = t381 * t382;
  t384 = t380 * t383;
  t386 = t371 * t164 * t166;
  t387 = t153 * t386;
  t389 = 0.1e1 / t163 / t162;
  t390 = t143 * t389;
  t393 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t266);
  t396 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t270);
  t397 = t393 + t396;
  t398 = t166 * t397;
  t399 = t390 * t398;
  t400 = t153 * t399;
  t401 = t400 / 0.2e1;
  t402 = t197 + t208 + t219 - t263 - t277 - t288 + t330 + t332 + t336 - t339 - t346 + t384 + t387 - t401;
  tvrho0 = t402 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t404 = -t55 - t265;
  t407 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t404);
  t408 = -t404;
  t411 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t408);
  t412 = t407 + t411;
  t413 = t53 * t412;
  t414 = t413 * t84;
  t415 = t414 / 0.24e2;
  t419 = t74 * (0.4e1 * t279 + 0.4e1 * t282) * t83;
  t420 = t70 * t419;
  t421 = t420 / 0.24e2;
  t422 = t105 * t412;
  t423 = t422 * t108;
  t426 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t404);
  t429 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t408);
  t430 = t426 + t429;
  t431 = t166 * t430;
  t432 = t390 * t431;
  t433 = t153 * t432;
  t434 = t433 / 0.2e1;
  t435 = t197 + t208 + t219 - t263 - t415 - t421 + t330 + t423 - t336 - t339 - t346 + t384 + t387 - t434;
  tvrho1 = t435 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t437 = t113 * t152;
  t438 = t437 * t167;
  t439 = sqrt(t7);
  t441 = 0.1e1 / t439 / t340;
  t442 = t145 * t441;
  t445 = t115 * t152 * t382;
  t446 = t442 * params->ftilde * t445;
  t447 = t446 / 0.2e1;
  tvsigma0 = t7 * (t438 - t447);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t449 = 0.2e1 * t438;
  tvsigma1 = t7 * (t449 - t446);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = tvsigma0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t15, t16, t20;
  double t21, t22, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t36, t37, t41, t42, t45;
  double t47, t48, t50, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t72, t74;
  double t75, t76, t77, t78, t79, t83, t84, t86;
  double t88, t89, t93, t95, t98, t100, t101, t103;
  double t105, t106, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t119, t122, t123, t124;
  double t125, t126, t127, t128, t131, t132, t135, t140;
  double t141, t143, t144, t145, t146, t147, t149, t152;
  double t153, t154, t155, t156, t157, t158, t159, t160;
  double t161, t162, t163, t164, t165, t166, t167, t168;
  double tzk0;

  double t170, t171, t175, t176, t177, t178, t179, t180;
  double t181, t182, t183, t184, t186, t192, t193, t194;
  double t195, t196, t197, t198, t199, t201, t203, t204;
  double t207, t208, t209, t210, t213, t215, t216, t217;
  double t218, t219, t223, t224, t225, t227, t233, t234;
  double t237, t238, t240, t242, t243, t248, t249, t252;
  double t254, t255, t256, t260, t261, t262, t263, t264;
  double t265, t266, t269, t270, t273, t274, t275, t276;
  double t277, t278, t279, t280, t281, t282, t286, t287;
  double t288, t292, t293, t294, t296, t302, t303, t306;
  double t307, t309, t311, t312, t317, t318, t321, t323;
  double t324, t325, t328, t329, t330, t331, t332, t333;
  double t334, t335, t336, t337, t338, t339, t340, t342;
  double t343, t344, t345, t346, t347, t348, t349, t350;
  double t354, t355, t358, t360, t361, t362, t369, t371;
  double t375, t379, t380, t381, t382, t383, t384, t386;
  double t387, t389, t390, t393, t396, t397, t398, t399;
  double t400, t401, t402, tvrho0, t404, t407, t408, t411;
  double t412, t413, t414, t415, t419, t420, t421, t422;
  double t423, t426, t429, t430, t431, t432, t433, t434;
  double t435, tvrho1, t437, t438, t439, t441, t442, t445;
  double t446, t447, tvsigma0, t449, tvsigma1, tvsigma2;

  double t451, t452, t453, t454, t455, t456, t457, t458;
  double t459, t460, t461, t462, t463, t464, t465, t466;
  double t467, t468, t470, t472, t477, t478, t479, t483;
  double t484, t486, t487, t489, t490, t491, t493, t494;
  double t496, t502, t505, t506, t509, t512, t514, t515;
  double t520, t529, t531, t532, t533, t534, t535, t540;
  double t541, t542, t546, t547, t548, t549, t554, t558;
  double t559, t563, t564, t565, t566, t572, t574, t579;
  double t580, t581, t587, t593, t594, t595, t596, t597;
  double t598, t599, t600, t601, t602, t603, t604, t605;
  double t607, t608, t610, t613, t614, t617, t618, t619;
  double t621, t622, t623, t624, t625, t627, t628, t630;
  double t631, t632, t636, t641, t645, t646, t647, t648;
  double t650, t651, t652, t653, t654, t655, t656, t657;
  double t658, t659, t660, t661, t662, t663, t664, t665;
  double t666, t667, t670, t671, t673, t677, t678, t679;
  double t682, t686, t687, t688, t689, t690, t691, t692;
  double t693, t695, t696, t697, t698, t699, t700, t701;
  double t702, t708, t709, t715, t716, t717, t718, t719;
  double t720, t721, t722, t723, t724, t725, t726, t727;
  double t728, t729, t730, t731, t732, t734, t735, t736;
  double t740, t748, t750, t754, t755, t756, t765, t767;
  double t771, t775, t776, t777, t778, t780, t781, t782;
  double t783, t784, t786, t788, t793, t794, t795, t801;
  double t807, t810, t813, t816, t817, t818, t819, t824;
  double t833, t835, t836, t837, t838, t839, t844, t845;
  double t846, t850, t855, t859, t860, t864, t865, t866;
  double t867, t873, t874, t875, t876, t877, t878, t879;
  double t880, t881, t882, t883, t884, t885, t886, t887;
  double t888, t890, t891, t892, t893, t895, t897, t899;
  double t902, t903, t904, t905, t906, t907, t908, t909;
  double t910, t913, t915, t916, t917, t920, t921, t922;
  double tv2rho20, t925, t927, t928, t930, t933, t937, t938;
  double t941, t945, t946, t947, t948, t949, t951, t954;
  double t956, t958, t961, t965, t966, t969, t973, t974;
  double t975, t976, t977, t978, t979, t981, t985, t986;
  double t988, t989, t991, t993, t995, t996, t1000, t1002;
  double t1003, t1004, t1005, t1006, t1008, t1010, tv2rho21, t1014;
  double t1015, t1019, t1023, t1024, t1027, t1031, t1032, t1033;
  double t1034, t1035, t1036, t1042, t1048, t1049, t1050, t1051;
  double t1054, t1055, t1056, t1057, t1058, t1059, t1060, t1061;
  double t1062, t1063, t1064, t1065, t1066, t1067, t1068, t1069;
  double t1070, t1071, t1072, t1073, tv2rho22, t1079, t1080, t1081;
  double t1082, t1083, t1084, t1085, t1086, t1087, t1088, t1089;
  double t1090, t1092, t1093, t1095, t1096, t1097, t1098, t1099;
  double t1100, t1101, t1102, t1103, t1104, tv2rhosigma0, t1107, t1108;
  double t1109, t1110, t1111, tv2rhosigma1, tv2rhosigma2, t1114, t1115, t1116;
  double t1117, t1118, t1119, tv2rhosigma3, t1122, tv2rhosigma4, tv2rhosigma5, t1125;
  double t1126, t1127, t1128, t1129, t1130, t1131, t1133, t1134;
  double t1135, t1136, t1138, t1139, t1140, t1141, tv2sigma20, t1143;
  double t1144, tv2sigma21, tv2sigma22, t1146, tv2sigma23, tv2sigma24, tv2sigma25;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = rho[0] + rho[1];
  t8 = POW_1_3(t7);
  t9 = 0.1e1 / t8;
  t10 = t6 * t9;
  t11 = t4 * t10;
  t12 = t11 / 0.4e1;
  t13 = sqrt(t11);
  t15 = t12 + 0.186372e1 * t13 + 0.129352e2;
  t16 = 0.1e1 / t15;
  t20 = log(t4 * t10 * t16 / 0.4e1);
  t21 = 0.310907e-1 * t20;
  t22 = t13 + 0.372744e1;
  t25 = atan(0.61519908197590802322e1 / t22);
  t26 = 0.38783294878113014393e-1 * t25;
  t27 = t13 / 0.2e1;
  t28 = t27 + 0.10498e0;
  t29 = t28 * t28;
  t31 = log(t29 * t16);
  t32 = 0.96902277115443742139e-3 * t31;
  t33 = M_PI * M_PI;
  t34 = 0.1e1 / t33;
  t36 = t12 + 0.565535e0 * t13 + 0.130045e2;
  t37 = 0.1e1 / t36;
  t41 = log(t4 * t10 * t37 / 0.4e1);
  t42 = t13 + 0.113107e1;
  t45 = atan(0.71231089178181179908e1 / t42);
  t47 = t27 + 0.47584e-2;
  t48 = t47 * t47;
  t50 = log(t48 * t37);
  t53 = t34 * (t41 + 0.317708004743941464e0 * t45 + 0.41403379428206274608e-3 * t50);
  t54 = rho[0] - rho[1];
  t55 = 0.1e1 / t7;
  t56 = t54 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t62 = t61 * t57;
  t63 = my_piecewise3(t58, t60, t62);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t67 = t66 * t64;
  t68 = my_piecewise3(t65, t60, t67);
  t69 = t63 + t68 - 0.2e1;
  t70 = t53 * t69;
  t71 = M_CBRT2;
  t72 = t71 - 0.1e1;
  t74 = 0.1e1 / t72 / 0.2e1;
  t75 = t54 * t54;
  t76 = t75 * t75;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = 0.1e1 / t78;
  t83 = 0.9e1 * t72;
  t84 = t74 * (-t76 * t79 + 0.1e1) * t83;
  t86 = t70 * t84 / 0.24e2;
  t88 = t12 + 0.353021e1 * t13 + 0.180578e2;
  t89 = 0.1e1 / t88;
  t93 = log(t4 * t10 * t89 / 0.4e1);
  t95 = t13 + 0.706042e1;
  t98 = atan(0.473092690956011283e1 / t95);
  t100 = t27 + 0.325e0;
  t101 = t100 * t100;
  t103 = log(t101 * t89);
  t105 = 0.1554535e-1 * t93 + 0.52491393169780936218e-1 * t98 + 0.22478670955426118383e-2 * t103 - t21 - t26 - t32;
  t106 = t105 * t69;
  t107 = t74 * t76;
  t108 = t107 * t79;
  t109 = t106 * t108;
  t111 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t113 = 0.1e1 / t8 / t77;
  t114 = t111 * t113;
  t115 = params->aa + params->bb;
  t116 = params->ftilde * t115;
  t117 = params->malpha * t1;
  t118 = t3 * t6;
  t119 = t118 * t9;
  t122 = t1 * t1;
  t123 = params->mbeta * t122;
  t124 = t3 * t3;
  t125 = t124 * t5;
  t126 = t8 * t8;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t131 = params->bb + t117 * t119 / 0.4e1 + t123 * t128 / 0.4e1;
  t132 = params->mgamma * t1;
  t135 = params->mdelta * t122;
  t140 = 0.1e1 + t132 * t119 / 0.4e1 + t135 * t128 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t55;
  t141 = 0.1e1 / t140;
  t143 = t131 * t141 + params->aa;
  t144 = 0.1e1 / t143;
  t145 = sqrt(t111);
  t146 = t144 * t145;
  t147 = pow(t7, 0.1e1 / 0.6e1);
  t149 = 0.1e1 / t147 / t7;
  t152 = exp(-t116 * t146 * t149);
  t153 = t114 * t152;
  t154 = t59 * t59;
  t155 = t154 * p->zeta_threshold;
  t156 = t61 * t61;
  t157 = t156 * t57;
  t158 = my_piecewise3(t58, t155, t157);
  t159 = t66 * t66;
  t160 = t159 * t64;
  t161 = my_piecewise3(t65, t155, t160);
  t162 = t158 + t161;
  t163 = sqrt(t162);
  t164 = 0.1e1 / t163;
  t165 = t143 * t164;
  t166 = M_SQRT2;
  t167 = t165 * t166;
  t168 = t153 * t167;
  tzk0 = t21 + t26 + t32 - t86 + t109 + t168;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t170 = 0.1e1 / t8 / t7;
  t171 = t6 * t170;
  t175 = t4 * t6;
  t176 = t15 * t15;
  t177 = 0.1e1 / t176;
  t178 = t9 * t177;
  t179 = t4 * t171;
  t180 = t179 / 0.12e2;
  t181 = 0.1e1 / t13;
  t182 = t181 * t1;
  t183 = t118 * t170;
  t184 = t182 * t183;
  t186 = -t180 - 0.31062e0 * t184;
  t192 = 0.1e1 / t3;
  t193 = (-t4 * t171 * t16 / 0.12e2 - t175 * t178 * t186 / 0.4e1) * t122 * t192;
  t194 = t5 * t8;
  t195 = t194 * t15;
  t196 = t193 * t195;
  t197 = 0.10363566666666666667e-1 * t196;
  t198 = t22 * t22;
  t199 = 0.1e1 / t198;
  t201 = t199 * t181 * t1;
  t203 = 0.378469910464e2 * t199 + 0.1e1;
  t204 = 0.1e1 / t203;
  t207 = t201 * t118 * t170 * t204;
  t208 = 0.39765745675026770179e-1 * t207;
  t209 = t28 * t16;
  t210 = t209 * t181;
  t213 = t29 * t177;
  t215 = -t210 * t179 / 0.6e1 - t213 * t186;
  t216 = 0.1e1 / t29;
  t217 = t215 * t216;
  t218 = t217 * t15;
  t219 = 0.96902277115443742139e-3 * t218;
  t223 = t36 * t36;
  t224 = 0.1e1 / t223;
  t225 = t9 * t224;
  t227 = -t180 - 0.94255833333333333334e-1 * t184;
  t233 = (-t4 * t171 * t37 / 0.12e2 - t175 * t225 * t227 / 0.4e1) * t122 * t192;
  t234 = t194 * t36;
  t237 = t42 * t42;
  t238 = 0.1e1 / t237;
  t240 = t238 * t181 * t1;
  t242 = 0.50738680655100000001e2 * t238 + 0.1e1;
  t243 = 0.1e1 / t242;
  t248 = t47 * t37;
  t249 = t248 * t181;
  t252 = t48 * t224;
  t254 = -t249 * t179 / 0.6e1 - t252 * t227;
  t255 = 0.1e1 / t48;
  t256 = t254 * t255;
  t260 = t34 * (t233 * t234 / 0.3e1 + 0.37717812030896172975e0 * t240 * t118 * t170 * t243 + 0.41403379428206274608e-3 * t256 * t36);
  t261 = t260 * t69;
  t262 = t261 * t84;
  t263 = t262 / 0.24e2;
  t264 = 0.1e1 / t77;
  t265 = t54 * t264;
  t266 = t55 - t265;
  t269 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t266);
  t270 = -t266;
  t273 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t270);
  t274 = t269 + t273;
  t275 = t53 * t274;
  t276 = t275 * t84;
  t277 = t276 / 0.24e2;
  t278 = t75 * t54;
  t279 = t278 * t79;
  t280 = t78 * t7;
  t281 = 0.1e1 / t280;
  t282 = t76 * t281;
  t286 = t74 * (-0.4e1 * t279 + 0.4e1 * t282) * t83;
  t287 = t70 * t286;
  t288 = t287 / 0.24e2;
  t292 = t88 * t88;
  t293 = 0.1e1 / t292;
  t294 = t9 * t293;
  t296 = -t180 - 0.58836833333333333333e0 * t184;
  t302 = (-t4 * t171 * t89 / 0.12e2 - t175 * t294 * t296 / 0.4e1) * t122 * t192;
  t303 = t194 * t88;
  t306 = t95 * t95;
  t307 = 0.1e1 / t306;
  t309 = t307 * t181 * t1;
  t311 = 0.223816694236e2 * t307 + 0.1e1;
  t312 = 0.1e1 / t311;
  t317 = t100 * t89;
  t318 = t317 * t181;
  t321 = t101 * t293;
  t323 = -t318 * t179 / 0.6e1 - t321 * t296;
  t324 = 0.1e1 / t101;
  t325 = t323 * t324;
  t328 = 0.51817833333333333333e-2 * t302 * t303 + 0.41388824077869423261e-1 * t309 * t118 * t170 * t312 + 0.22478670955426118383e-2 * t325 * t88 - t197 - t208 - t219;
  t329 = t328 * t69;
  t330 = t329 * t108;
  t331 = t105 * t274;
  t332 = t331 * t108;
  t333 = t74 * t278;
  t334 = t333 * t79;
  t335 = t106 * t334;
  t336 = 0.4e1 * t335;
  t337 = t107 * t281;
  t338 = t106 * t337;
  t339 = 0.4e1 * t338;
  t340 = t77 * t7;
  t342 = 0.1e1 / t8 / t340;
  t343 = t111 * t342;
  t344 = t343 * t152;
  t345 = t344 * t167;
  t346 = 0.7e1 / 0.3e1 * t345;
  t347 = t143 * t143;
  t348 = 0.1e1 / t347;
  t349 = t116 * t348;
  t350 = t145 * t149;
  t354 = 0.1e1 / t126 / t7;
  t355 = t125 * t354;
  t358 = -t117 * t183 / 0.12e2 - t123 * t355 / 0.6e1;
  t360 = t140 * t140;
  t361 = 0.1e1 / t360;
  t362 = t131 * t361;
  t369 = -t132 * t183 / 0.12e2 - t135 * t355 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta * t264;
  t371 = t141 * t358 - t362 * t369;
  t375 = 0.1e1 / t147 / t77;
  t379 = t349 * t350 * t371 + 0.7e1 / 0.6e1 * t116 * t146 * t375;
  t380 = t114 * t379;
  t381 = t152 * t143;
  t382 = t164 * t166;
  t383 = t381 * t382;
  t384 = t380 * t383;
  t386 = t371 * t164 * t166;
  t387 = t153 * t386;
  t389 = 0.1e1 / t163 / t162;
  t390 = t143 * t389;
  t393 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t266);
  t396 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t270);
  t397 = t393 + t396;
  t398 = t166 * t397;
  t399 = t390 * t398;
  t400 = t153 * t399;
  t401 = t400 / 0.2e1;
  t402 = t197 + t208 + t219 - t263 - t277 - t288 + t330 + t332 + t336 - t339 - t346 + t384 + t387 - t401;
  tvrho0 = t402 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t404 = -t55 - t265;
  t407 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t404);
  t408 = -t404;
  t411 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t408);
  t412 = t407 + t411;
  t413 = t53 * t412;
  t414 = t413 * t84;
  t415 = t414 / 0.24e2;
  t419 = t74 * (0.4e1 * t279 + 0.4e1 * t282) * t83;
  t420 = t70 * t419;
  t421 = t420 / 0.24e2;
  t422 = t105 * t412;
  t423 = t422 * t108;
  t426 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t404);
  t429 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t408);
  t430 = t426 + t429;
  t431 = t166 * t430;
  t432 = t390 * t431;
  t433 = t153 * t432;
  t434 = t433 / 0.2e1;
  t435 = t197 + t208 + t219 - t263 - t415 - t421 + t330 + t423 - t336 - t339 - t346 + t384 + t387 - t434;
  tvrho1 = t435 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t437 = t113 * t152;
  t438 = t437 * t167;
  t439 = sqrt(t7);
  t441 = 0.1e1 / t439 / t340;
  t442 = t145 * t441;
  t445 = t115 * t152 * t382;
  t446 = t442 * params->ftilde * t445;
  t447 = t446 / 0.2e1;
  tvsigma0 = t7 * (t438 - t447);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t449 = 0.2e1 * t438;
  tvsigma1 = t7 * (t449 - t446);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = tvsigma0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t451 = 0.14e2 / 0.3e1 * t345;
  t452 = 0.2e1 * t384;
  t453 = 0.79531491350053540358e-1 * t207;
  t454 = t74 * t75;
  t455 = t454 * t79;
  t456 = t106 * t455;
  t457 = 0.12e2 * t456;
  t458 = t333 * t281;
  t459 = t106 * t458;
  t460 = 0.32e2 * t459;
  t461 = t331 * t334;
  t462 = 0.8e1 * t461;
  t463 = t331 * t337;
  t464 = 0.8e1 * t463;
  t465 = t328 * t274;
  t466 = t465 * t108;
  t467 = 0.2e1 * t466;
  t468 = t6 * t113;
  t470 = t4 * t468 * t89;
  t472 = t170 * t293;
  t477 = 0.1e1 / t292 / t88;
  t478 = t9 * t477;
  t479 = t296 * t296;
  t483 = t4 * t468;
  t484 = t483 / 0.9e1;
  t486 = 0.1e1 / t13 / t11;
  t487 = t486 * t122;
  t489 = 0.1e1 / t126 / t77;
  t490 = t125 * t489;
  t491 = t487 * t490;
  t493 = t118 * t113;
  t494 = t182 * t493;
  t496 = t484 - 0.39224555555555555555e0 * t491 + 0.7844911111111111111e0 * t494;
  t502 = (t470 / 0.9e1 + t175 * t472 * t296 / 0.6e1 + t175 * t478 * t479 / 0.2e1 - t175 * t294 * t496 / 0.4e1) * t122 * t192;
  t505 = t5 * t127;
  t506 = t505 * t88;
  t509 = t194 * t296;
  t512 = t306 * t95;
  t514 = 0.1e1 / t512 * t1;
  t515 = t514 * t3;
  t520 = t307 * t486 * t122;
  t529 = t306 * t306;
  t531 = 0.1e1 / t529 / t95;
  t532 = t531 * t1;
  t533 = t532 * t3;
  t534 = t311 * t311;
  t535 = 0.1e1 / t534;
  t540 = t100 * t293;
  t541 = t540 * t182;
  t542 = t170 * t296;
  t546 = t317 * t486;
  t547 = t122 * t124;
  t548 = t5 * t489;
  t549 = t547 * t548;
  t554 = t101 * t477;
  t558 = t470 / 0.72e2 + t541 * t118 * t542 / 0.3e1 - t546 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t318 * t483 + 0.2e1 * t554 * t479 - t321 * t496;
  t559 = t558 * t324;
  t563 = 0.1e1 / t101 / t100;
  t564 = t323 * t563;
  t565 = t88 * t181;
  t566 = t564 * t565;
  t572 = t4 * t468 * t16;
  t574 = t170 * t177;
  t579 = 0.1e1 / t176 / t15;
  t580 = t9 * t579;
  t581 = t186 * t186;
  t587 = t484 - 0.20708e0 * t491 + 0.41416e0 * t494;
  t593 = (t572 / 0.9e1 + t175 * t574 * t186 / 0.6e1 + t175 * t580 * t581 / 0.2e1 - t175 * t178 * t587 / 0.4e1) * t122 * t192;
  t594 = t593 * t195;
  t595 = 0.10363566666666666667e-1 * t594;
  t596 = t505 * t15;
  t597 = t193 * t596;
  t598 = 0.34545222222222222223e-2 * t597;
  t599 = t194 * t186;
  t600 = t193 * t599;
  t601 = 0.10363566666666666667e-1 * t600;
  t602 = t198 * t22;
  t603 = 0.1e1 / t602;
  t604 = t603 * t1;
  t605 = t604 * t3;
  t607 = t605 * t468 * t204;
  t608 = 0.13255248558342256726e-1 * t607;
  t610 = t199 * t486 * t122;
  t613 = t610 * t125 * t489 * t204;
  t614 = 0.26510497116684513453e-1 * t613;
  t617 = t201 * t118 * t113 * t204;
  t618 = 0.53020994233369026905e-1 * t617;
  t619 = t198 * t198;
  t621 = 0.1e1 / t619 / t22;
  t622 = t621 * t1;
  t623 = t622 * t3;
  t624 = t203 * t203;
  t625 = 0.1e1 / t624;
  t627 = t623 * t468 * t625;
  t628 = 0.50167127350538589834e0 * t627;
  t630 = t28 * t177;
  t631 = t630 * t182;
  t632 = t170 * t186;
  t636 = t209 * t486;
  t641 = t29 * t579;
  t645 = t572 / 0.72e2 + t631 * t118 * t632 / 0.3e1 - t636 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t210 * t483 + 0.2e1 * t641 * t581 - t213 * t587;
  t646 = t645 * t216;
  t647 = t646 * t15;
  t648 = 0.96902277115443742139e-3 * t647;
  t650 = 0.1e1 / t29 / t28;
  t651 = t215 * t650;
  t652 = t15 * t181;
  t653 = t651 * t652;
  t654 = t653 * t179;
  t655 = 0.1615037951924062369e-3 * t654;
  t656 = t217 * t186;
  t657 = 0.96902277115443742139e-3 * t656;
  t658 = 0.51817833333333333333e-2 * t502 * t303 + 0.17272611111111111111e-2 * t302 * t506 + 0.51817833333333333333e-2 * t302 * t509 + 0.13796274692623141087e-1 * t515 * t468 * t312 + 0.27592549385246282174e-1 * t520 * t125 * t489 * t312 - 0.55185098770492564348e-1 * t309 * t118 * t113 * t312 - 0.30878365944746984535e0 * t533 * t468 * t535 + 0.22478670955426118383e-2 * t559 * t88 + 0.37464451592376863972e-3 * t566 * t179 + 0.22478670955426118383e-2 * t325 * t296 - t595 - t598 - t601 - t608 - t614 + t618 + t628 - t648 - t655 - t657;
  t659 = t658 * t69;
  t660 = t659 * t108;
  t661 = t78 * t77;
  t662 = 0.1e1 / t661;
  t663 = t107 * t662;
  t664 = t106 * t663;
  t665 = 0.2e2 * t664;
  t666 = 0.1e1 / t156;
  t667 = t266 * t266;
  t670 = 0.1e1 / t340;
  t671 = t54 * t670;
  t673 = -0.2e1 * t264 + 0.2e1 * t671;
  t677 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t667 + 0.4e1 / 0.3e1 * t61 * t673);
  t678 = 0.1e1 / t159;
  t679 = t270 * t270;
  t682 = -t673;
  t686 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t679 + 0.4e1 / 0.3e1 * t66 * t682);
  t687 = t677 + t686;
  t688 = t105 * t687;
  t689 = t688 * t108;
  t690 = t379 * t379;
  t691 = t114 * t690;
  t692 = t691 * t383;
  t693 = t162 * t162;
  t695 = 0.1e1 / t163 / t693;
  t696 = t143 * t695;
  t697 = t397 * t397;
  t698 = t166 * t697;
  t699 = t696 * t698;
  t700 = t153 * t699;
  t701 = 0.3e1 / 0.4e1 * t700;
  t702 = 0.1e1 / t61;
  t708 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t667 + 0.5e1 / 0.3e1 * t156 * t673);
  t709 = 0.1e1 / t66;
  t715 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t679 + 0.5e1 / 0.3e1 * t159 * t682);
  t716 = t708 + t715;
  t717 = t166 * t716;
  t718 = t390 * t717;
  t719 = t153 * t718;
  t720 = t719 / 0.2e1;
  t721 = t371 * t389;
  t722 = t721 * t398;
  t723 = t153 * t722;
  t724 = t152 * t371;
  t725 = t724 * t382;
  t726 = t380 * t725;
  t727 = 0.2e1 * t726;
  t728 = t344 * t399;
  t729 = 0.7e1 / 0.3e1 * t728;
  t730 = t343 * t379;
  t731 = t730 * t383;
  t732 = 0.14e2 / 0.3e1 * t731;
  t734 = 0.1e1 / t347 / t143;
  t735 = t116 * t734;
  t736 = t371 * t371;
  t740 = t145 * t375;
  t748 = t117 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t123 * t490;
  t750 = t358 * t361;
  t754 = 0.1e1 / t360 / t140;
  t755 = t131 * t754;
  t756 = t369 * t369;
  t765 = t132 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t135 * t490 + 0.4774648292756860073e4 * params->mbeta * t670;
  t767 = t141 * t748 - t362 * t765 - 0.2e1 * t369 * t750 + 0.2e1 * t755 * t756;
  t771 = 0.1e1 / t147 / t340;
  t775 = -0.2e1 * t735 * t350 * t736 - 0.7e1 / 0.3e1 * t349 * t740 * t371 + t349 * t350 * t767 - 0.91e2 / 0.36e2 * t116 * t146 * t771;
  t776 = t114 * t775;
  t777 = t776 * t383;
  t778 = t457 - t460 + t462 - t464 + t467 + t660 + t665 + t689 + t655 + t692 + t701 - t720 - t723 + t727 + t729 - t732 + t777 + t614 - t618;
  t780 = 0.1e1 / t8 / t78;
  t781 = t111 * t780;
  t782 = t781 * t152;
  t783 = t782 * t167;
  t784 = 0.7e2 / 0.9e1 * t783;
  t786 = t4 * t468 * t37;
  t788 = t170 * t224;
  t793 = 0.1e1 / t223 / t36;
  t794 = t9 * t793;
  t795 = t227 * t227;
  t801 = t484 - 0.62837222222222222223e-1 * t491 + 0.12567444444444444445e0 * t494;
  t807 = (t786 / 0.9e1 + t175 * t788 * t227 / 0.6e1 + t175 * t794 * t795 / 0.2e1 - t175 * t225 * t801 / 0.4e1) * t122 * t192;
  t810 = t505 * t36;
  t813 = t194 * t227;
  t816 = t237 * t42;
  t817 = 0.1e1 / t816;
  t818 = t817 * t1;
  t819 = t818 * t3;
  t824 = t238 * t486 * t122;
  t833 = t237 * t237;
  t835 = 0.1e1 / t833 / t42;
  t836 = t835 * t1;
  t837 = t836 * t3;
  t838 = t242 * t242;
  t839 = 0.1e1 / t838;
  t844 = t47 * t224;
  t845 = t844 * t182;
  t846 = t170 * t227;
  t850 = t248 * t486;
  t855 = t48 * t793;
  t859 = t786 / 0.72e2 + t845 * t118 * t846 / 0.3e1 - t850 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t249 * t483 + 0.2e1 * t855 * t795 - t252 * t801;
  t860 = t859 * t255;
  t864 = 0.1e1 / t48 / t47;
  t865 = t254 * t864;
  t866 = t36 * t181;
  t867 = t865 * t866;
  t873 = t34 * (t807 * t234 / 0.3e1 + t233 * t810 / 0.9e1 + t233 * t813 / 0.3e1 + 0.12572604010298724325e0 * t819 * t468 * t243 + 0.2514520802059744865e0 * t824 * t125 * t489 * t243 - 0.502904160411948973e0 * t240 * t118 * t113 * t243 - 0.63791733988157656508e1 * t837 * t468 * t839 + 0.41403379428206274608e-3 * t860 * t36 + 0.69005632380343791013e-4 * t867 * t179 + 0.41403379428206274608e-3 * t256 * t227);
  t874 = t873 * t69;
  t875 = t874 * t84;
  t876 = t875 / 0.24e2;
  t877 = t260 * t274;
  t878 = t877 * t84;
  t879 = t878 / 0.12e2;
  t880 = t261 * t286;
  t881 = t880 / 0.12e2;
  t882 = t379 * t152;
  t883 = t114 * t882;
  t884 = t883 * t399;
  t885 = t329 * t334;
  t886 = 0.8e1 * t885;
  t887 = t329 * t337;
  t888 = 0.8e1 * t887;
  t890 = t767 * t164 * t166;
  t891 = t153 * t890;
  t892 = t344 * t386;
  t893 = 0.14e2 / 0.3e1 * t892;
  t895 = 0.12e2 * t75 * t79;
  t897 = 0.32e2 * t278 * t281;
  t899 = 0.2e2 * t76 * t662;
  t902 = t74 * (-t895 + t897 - t899) * t83;
  t903 = t70 * t902;
  t904 = t903 / 0.24e2;
  t905 = t53 * t687;
  t906 = t905 * t84;
  t907 = t906 / 0.24e2;
  t908 = t275 * t286;
  t909 = t908 / 0.12e2;
  t910 = t784 - t876 - t879 - t881 + t648 + t657 - t884 + t886 - t888 + t891 - t893 + t595 + t598 + t601 + t608 - t628 - t904 - t907 - t909;
  t913 = 0.2e1 * t330;
  t915 = 0.19380455423088748428e-2 * t218;
  t916 = 0.20727133333333333334e-1 * t196;
  t917 = t262 / 0.12e2;
  t920 = 0.8e1 * t335;
  t921 = 0.8e1 * t338;
  t922 = 0.2e1 * t387;
  tv2rho20 = -t451 - t400 + t452 + t453 + t7 * (t778 + t910) + t913 + 0.2e1 * t332 + t915 + t916 - t917 - t276 / 0.12e2 - t287 / 0.12e2 + t920 - t921 + t922;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t925 = t344 * t432;
  t927 = t721 * t431;
  t928 = t153 * t927;
  t930 = t702 * t404;
  t933 = t156 * t54;
  t937 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t930 * t266 + 0.1e2 / 0.3e1 * t933 * t670);
  t938 = t709 * t408;
  t941 = t159 * t54;
  t945 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t938 * t270 - 0.1e2 / 0.3e1 * t941 * t670);
  t946 = t937 + t945;
  t947 = t166 * t946;
  t948 = t390 * t947;
  t949 = t153 * t948;
  t951 = -t457 - 0.4e1 * t461 - 0.4e1 * t463 + t466 + t660 + t665 + t655 + 0.7e1 / 0.6e1 * t925 - t928 / 0.2e1 - t949 / 0.2e1 + t692;
  t954 = t422 * t334;
  t956 = t422 * t337;
  t958 = t666 * t404;
  t961 = t61 * t54;
  t965 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t958 * t266 + 0.8e1 / 0.3e1 * t961 * t670);
  t966 = t678 * t408;
  t969 = t66 * t54;
  t973 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t966 * t270 - 0.8e1 / 0.3e1 * t969 * t670);
  t974 = t965 + t973;
  t975 = t105 * t974;
  t976 = t975 * t108;
  t977 = t328 * t412;
  t978 = t977 * t108;
  t979 = -t723 / 0.2e1 + t727 + 0.7e1 / 0.6e1 * t728 - t732 + t777 + t614 - t618 + 0.4e1 * t954 - 0.4e1 * t956 + t976 + t978;
  t981 = t275 * t419;
  t985 = t74 * (t895 - t899) * t83;
  t986 = t70 * t985;
  t988 = t53 * t974;
  t989 = t988 * t84;
  t991 = t413 * t286;
  t993 = t261 * t419;
  t995 = t260 * t412;
  t996 = t995 * t84;
  t1000 = -t981 / 0.24e2 - t986 / 0.24e2 - t989 / 0.24e2 - t991 / 0.24e2 - t993 / 0.24e2 - t996 / 0.24e2 + t784 - t876 - t878 / 0.24e2 - t880 / 0.24e2 + t648;
  t1002 = t114 * t381;
  t1003 = t695 * t166;
  t1004 = t430 * t397;
  t1005 = t1003 * t1004;
  t1006 = t1002 * t1005;
  t1008 = t883 * t432;
  t1010 = t657 - t884 / 0.2e1 - t888 + 0.3e1 / 0.4e1 * t1006 - t1008 / 0.2e1 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho21 = -t434 - t451 - t401 + t452 + t453 + t423 + t913 + t332 + t7 * (t951 + t979 + t1000 + t1010) + t915 + t916 - t917 - t277 - t288 - t921 + t922 - t415 - t421;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1014 = 0.7e1 / 0.3e1 * t925;
  t1015 = t404 * t404;
  t1019 = 0.2e1 * t264 + 0.2e1 * t671;
  t1023 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t1015 + 0.5e1 / 0.3e1 * t156 * t1019);
  t1024 = t408 * t408;
  t1027 = -t1019;
  t1031 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t1024 + 0.5e1 / 0.3e1 * t159 * t1027);
  t1032 = t1023 + t1031;
  t1033 = t166 * t1032;
  t1034 = t390 * t1033;
  t1035 = t153 * t1034;
  t1036 = t1035 / 0.2e1;
  t1042 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t1015 + 0.4e1 / 0.3e1 * t61 * t1019);
  t1048 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t1024 + 0.4e1 / 0.3e1 * t66 * t1027);
  t1049 = t1042 + t1048;
  t1050 = t105 * t1049;
  t1051 = t1050 * t108;
  t1054 = t74 * (-t895 - t897 - t899) * t83;
  t1055 = t70 * t1054;
  t1056 = t1055 / 0.24e2;
  t1057 = t53 * t1049;
  t1058 = t1057 * t84;
  t1059 = t1058 / 0.24e2;
  t1060 = t413 * t419;
  t1061 = t1060 / 0.12e2;
  t1062 = 0.8e1 * t954;
  t1063 = t457 + t460 + t660 + t665 + t655 + t1014 - t1036 - t928 + t1051 + t692 + t727 - t732 + t777 - t1056 - t1059 - t1061 + t614 - t618 - t1062;
  t1064 = 0.8e1 * t956;
  t1065 = 0.2e1 * t978;
  t1066 = t993 / 0.12e2;
  t1067 = t996 / 0.12e2;
  t1068 = t430 * t430;
  t1069 = t166 * t1068;
  t1070 = t696 * t1069;
  t1071 = t153 * t1070;
  t1072 = 0.3e1 / 0.4e1 * t1071;
  t1073 = -t1064 + t1065 - t1066 - t1067 + t784 - t876 + t1072 + t648 + t657 - t886 - t888 - t1008 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho22 = t7 * (t1063 + t1073) - t433 - t451 + t452 + t453 + 0.2e1 * t423 + t913 + t915 + t916 - t917 - t920 - t921 + t922 - t414 / 0.12e2 - t420 / 0.12e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1079 = t342 * t152;
  t1080 = t1079 * t167;
  t1081 = 0.7e1 / 0.3e1 * t1080;
  t1082 = t113 * t379;
  t1083 = t1082 * t152;
  t1084 = t1083 * t167;
  t1085 = t437 * t386;
  t1086 = t437 * t143;
  t1087 = t389 * t166;
  t1088 = t1087 * t397;
  t1089 = t1086 * t1088;
  t1090 = t1089 / 0.2e1;
  t1092 = 0.1e1 / t439 / t78;
  t1093 = t145 * t1092;
  t1095 = t1093 * params->ftilde * t445;
  t1096 = 0.7e1 / 0.4e1 * t1095;
  t1097 = t442 * t116;
  t1098 = t882 * t382;
  t1099 = t1097 * t1098;
  t1100 = t1099 / 0.2e1;
  t1101 = t152 * t389;
  t1102 = t1101 * t398;
  t1103 = t1097 * t1102;
  t1104 = t1103 / 0.4e1;
  tv2rhosigma0 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1090 + t1096 - t1100 + t1104);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1107 = 0.14e2 / 0.3e1 * t1080;
  t1108 = 0.2e1 * t1084;
  t1109 = 0.2e1 * t1085;
  t1110 = 0.7e1 / 0.2e1 * t1095;
  t1111 = t1103 / 0.2e1;
  tv2rhosigma1 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1089 + t1110 - t1099 + t1111);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = tv2rhosigma0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1114 = t1087 * t430;
  t1115 = t1086 * t1114;
  t1116 = t1115 / 0.2e1;
  t1117 = t1101 * t431;
  t1118 = t1097 * t1117;
  t1119 = t1118 / 0.4e1;
  tv2rhosigma3 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1116 + t1096 - t1100 + t1119);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1122 = t1118 / 0.2e1;
  tv2rhosigma4 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1115 + t1110 - t1099 + t1122);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = tv2rhosigma3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1125 = t441 * params->ftilde;
  t1126 = t1125 * t115;
  t1127 = 0.1e1 / t145;
  t1128 = t1127 * t152;
  t1129 = t1128 * t382;
  t1130 = t1126 * t1129;
  t1131 = 0.3e1 / 0.4e1 * t1130;
  t1133 = 0.1e1 / t126 / t78;
  t1134 = params->ftilde * params->ftilde;
  t1135 = t1133 * t1134;
  t1136 = t115 * t115;
  t1138 = t144 * t152;
  t1139 = t1138 * t382;
  t1140 = t1135 * t1136 * t1139;
  t1141 = t1140 / 0.4e1;
  tv2sigma20 = t7 * (-t1131 + t1141);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t1143 = 0.3e1 / 0.2e1 * t1130;
  t1144 = t1140 / 0.2e1;
  tv2sigma21 = t7 * (-t1143 + t1144);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t1146 = 0.3e1 * t1130;
  tv2sigma23 = t7 * (-t1146 + t1140);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t15, t16, t20;
  double t21, t22, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t36, t37, t41, t42, t45;
  double t47, t48, t50, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t72, t74;
  double t75, t76, t77, t78, t79, t83, t84, t86;
  double t88, t89, t93, t95, t98, t100, t101, t103;
  double t105, t106, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t119, t122, t123, t124;
  double t125, t126, t127, t128, t131, t132, t135, t140;
  double t141, t143, t144, t145, t146, t147, t149, t152;
  double t153, t154, t155, t156, t157, t158, t159, t160;
  double t161, t162, t163, t164, t165, t166, t167, t168;
  double tzk0;

  double t170, t171, t175, t176, t177, t178, t179, t180;
  double t181, t182, t183, t184, t186, t192, t193, t194;
  double t195, t196, t197, t198, t199, t201, t203, t204;
  double t207, t208, t209, t210, t213, t215, t216, t217;
  double t218, t219, t223, t224, t225, t227, t233, t234;
  double t237, t238, t240, t242, t243, t248, t249, t252;
  double t254, t255, t256, t260, t261, t262, t263, t264;
  double t265, t266, t269, t270, t273, t274, t275, t276;
  double t277, t278, t279, t280, t281, t282, t286, t287;
  double t288, t292, t293, t294, t296, t302, t303, t306;
  double t307, t309, t311, t312, t317, t318, t321, t323;
  double t324, t325, t328, t329, t330, t331, t332, t333;
  double t334, t335, t336, t337, t338, t339, t340, t342;
  double t343, t344, t345, t346, t347, t348, t349, t350;
  double t354, t355, t358, t360, t361, t362, t369, t371;
  double t375, t379, t380, t381, t382, t383, t384, t386;
  double t387, t389, t390, t393, t396, t397, t398, t399;
  double t400, t401, t402, tvrho0, t404, t407, t408, t411;
  double t412, t413, t414, t415, t419, t420, t421, t422;
  double t423, t426, t429, t430, t431, t432, t433, t434;
  double t435, tvrho1, t437, t438, t439, t441, t442, t445;
  double t446, t447, tvsigma0, t449, tvsigma1, tvsigma2;

  double t451, t452, t453, t454, t455, t456, t457, t458;
  double t459, t460, t461, t462, t463, t464, t465, t466;
  double t467, t468, t470, t472, t477, t478, t479, t483;
  double t484, t486, t487, t489, t490, t491, t493, t494;
  double t496, t502, t505, t506, t509, t512, t514, t515;
  double t520, t529, t531, t532, t533, t534, t535, t540;
  double t541, t542, t546, t547, t548, t549, t554, t558;
  double t559, t563, t564, t565, t566, t572, t574, t579;
  double t580, t581, t587, t593, t594, t595, t596, t597;
  double t598, t599, t600, t601, t602, t603, t604, t605;
  double t607, t608, t610, t613, t614, t617, t618, t619;
  double t621, t622, t623, t624, t625, t627, t628, t630;
  double t631, t632, t636, t641, t645, t646, t647, t648;
  double t650, t651, t652, t653, t654, t655, t656, t657;
  double t658, t659, t660, t661, t662, t663, t664, t665;
  double t666, t667, t670, t671, t673, t677, t678, t679;
  double t682, t686, t687, t688, t689, t690, t691, t692;
  double t693, t695, t696, t697, t698, t699, t700, t701;
  double t702, t708, t709, t715, t716, t717, t718, t719;
  double t720, t721, t722, t723, t724, t725, t726, t727;
  double t728, t729, t730, t731, t732, t734, t735, t736;
  double t740, t748, t750, t754, t755, t756, t765, t767;
  double t771, t775, t776, t777, t778, t780, t781, t782;
  double t783, t784, t786, t788, t793, t794, t795, t801;
  double t807, t810, t813, t816, t817, t818, t819, t824;
  double t833, t835, t836, t837, t838, t839, t844, t845;
  double t846, t850, t855, t859, t860, t864, t865, t866;
  double t867, t873, t874, t875, t876, t877, t878, t879;
  double t880, t881, t882, t883, t884, t885, t886, t887;
  double t888, t890, t891, t892, t893, t895, t897, t899;
  double t902, t903, t904, t905, t906, t907, t908, t909;
  double t910, t913, t915, t916, t917, t920, t921, t922;
  double tv2rho20, t925, t927, t928, t930, t933, t937, t938;
  double t941, t945, t946, t947, t948, t949, t951, t954;
  double t956, t958, t961, t965, t966, t969, t973, t974;
  double t975, t976, t977, t978, t979, t981, t985, t986;
  double t988, t989, t991, t993, t995, t996, t1000, t1002;
  double t1003, t1004, t1005, t1006, t1008, t1010, tv2rho21, t1014;
  double t1015, t1019, t1023, t1024, t1027, t1031, t1032, t1033;
  double t1034, t1035, t1036, t1042, t1048, t1049, t1050, t1051;
  double t1054, t1055, t1056, t1057, t1058, t1059, t1060, t1061;
  double t1062, t1063, t1064, t1065, t1066, t1067, t1068, t1069;
  double t1070, t1071, t1072, t1073, tv2rho22, t1079, t1080, t1081;
  double t1082, t1083, t1084, t1085, t1086, t1087, t1088, t1089;
  double t1090, t1092, t1093, t1095, t1096, t1097, t1098, t1099;
  double t1100, t1101, t1102, t1103, t1104, tv2rhosigma0, t1107, t1108;
  double t1109, t1110, t1111, tv2rhosigma1, tv2rhosigma2, t1114, t1115, t1116;
  double t1117, t1118, t1119, tv2rhosigma3, t1122, tv2rhosigma4, tv2rhosigma5, t1125;
  double t1126, t1127, t1128, t1129, t1130, t1131, t1133, t1134;
  double t1135, t1136, t1138, t1139, t1140, t1141, tv2sigma20, t1143;
  double t1144, tv2sigma21, tv2sigma22, t1146, tv2sigma23, tv2sigma24, tv2sigma25;

  double t1148, t1149, t1153, t1154, t1156, t1157, t1158, t1159;
  double t1163, t1164, t1165, t1167, t1168, t1169, t1170, t1171;
  double t1175, t1176, t1179, t1181, t1184, t1189, t1190, t1191;
  double t1192, t1195, t1204, t1206, t1208, t1209, t1210, t1211;
  double t1212, t1213, t1214, t1216, t1218, t1220, t1222, t1229;
  double t1230, t1231, t1232, t1236, t1240, t1241, t1242, t1243;
  double t1245, t1247, t1249, t1255, t1256, t1257, t1259, t1260;
  double t1261, t1262, t1264, t1265, t1266, t1267, t1268, t1269;
  double t1270, t1271, t1272, t1273, t1274, t1275, t1276, t1277;
  double t1278, t1279, t1280, t1281, t1282, t1283, t1284, t1285;
  double t1286, t1287, t1288, t1289, t1290, t1292, t1293, t1294;
  double t1295, t1296, t1297, t1298, t1299, t1301, t1303, t1306;
  double t1307, t1308, t1309, t1311, t1312, t1314, t1315, t1316;
  double t1317, t1318, t1321, t1325, t1329, t1330, t1331, t1334;
  double t1337, t1341, t1342, t1343, t1344, t1345, t1346, t1347;
  double t1348, t1350, t1351, t1352, t1356, t1359, t1362, t1365;
  double t1371, t1373, t1375, t1377, t1384, t1385, t1386, t1387;
  double t1391, t1398, t1404, t1407, t1408, t1409, t1410, t1411;
  double t1413, t1414, t1418, t1419, t1420, t1421, t1427, t1428;
  double t1429, t1430, t1435, t1436, t1437, t1438, t1442, t1443;
  double t1444, t1450, t1453, t1454, t1457, t1458, t1461, t1462;
  double t1477, t1478, t1482, t1496, t1497, t1503, t1508, t1514;
  double t1515, t1522, t1524, t1525, t1526, t1527, t1529, t1530;
  double t1531, t1532, t1533, t1534, t1535, t1536, t1537, t1539;
  double t1540, t1543, t1544, t1547, t1548, t1549, t1550, t1551;
  double t1552, t1553, t1554, t1555, t1556, t1557, t1558, t1559;
  double t1560, t1561, t1562, t1563, t1564, t1565, t1567, t1569;
  double t1572, t1573, t1574, t1575, t1576, t1577, t1578, t1579;
  double t1581, t1582, t1583, t1584, t1585, t1586, t1587, t1588;
  double t1589, t1590, t1591, t1592, t1593, t1594, t1595, t1596;
  double t1597, t1599, t1600, t1602, t1603, t1604, t1605, t1606;
  double t1607, t1609, t1610, t1612, t1613, t1614, t1615, t1617;
  double t1618, t1620, t1621, t1623, t1624, t1625, t1626, t1627;
  double t1629, t1630, t1631, t1632, t1633, t1635, t1637, t1638;
  double t1645, t1649, t1659, t1663, t1664, t1665, t1666, t1667;
  double t1668, t1669, t1670, t1671, t1674, t1680, t1681, t1684;
  double t1690, t1691, t1692, t1693, t1694, t1695, t1696, t1697;
  double t1699, t1700, t1701, t1702, t1706, t1707, t1708, t1709;
  double t1710, t1711, t1712, t1713, t1714, t1715, t1716, t1717;
  double t1718, t1719, t1722, t1724, t1726, t1728, t1735, t1736;
  double t1737, t1738, t1742, t1749, t1755, t1763, t1766, t1767;
  double t1772, t1775, t1780, t1789, t1790, t1791, t1792, t1794;
  double t1795, t1799, t1800, t1801, t1802, t1805, t1806, t1807;
  double t1808, t1812, t1815, t1816, t1817, t1818, t1822, t1823;
  double t1827, t1828, t1829, t1830, t1833, t1834, t1838, t1860;
  double t1866, t1867, t1868, t1869, t1870, t1871, t1872, t1873;
  double t1874, t1875, t1876, t1877, t1878, t1879, t1880, t1881;
  double t1882, t1883, t1884, t1887, t1888, t1891, t1892, t1895;
  double t1896, t1899, t1909, t1910, t1914, t1936, t1942, t1943;
  double t1946, t1948, t1949, t1950, t1951, t1953, t1954, t1955;
  double t1956, t1958, t1959, t1960, t1961, t1962, t1963, t1964;
  double t1965, t1967, t1968, t1969, t1970, t1972, t1973, t1974;
  double t1975, t1976, t1977, t1978, t1979, t1984, t1985, t1989;
  double t1991, t1992, t1993, t1994, t1995, t1996, t1997, t2000;
  double t2001, t2003, t2004, t2005, t2006, t2007, t2008, t2009;
  double t2010, t2011, t2015, tv3rho30, t2018, t2021, t2022, t2023;
  double t2025, t2026, t2027, t2030, t2031, t2032, t2033, t2036;
  double t2037, t2038, t2039, t2041, t2042, t2043, t2044, t2045;
  double t2048, t2049, t2059, t2060, t2063, t2064, t2074, t2075;
  double t2076, t2077, t2078, t2079, t2080, t2081, t2082, t2083;
  double t2084, t2086, t2088, t2090, t2091, t2092, t2094, t2096;
  double t2097, t2098, t2099, t2102, t2103, t2105, t2106, t2107;
  double t2112, t2114, t2116, t2117, t2119, t2120, t2122, t2123;
  double t2124, t2127, t2137, t2138, t2141, t2151, t2152, t2153;
  double t2154, t2155, t2157, t2158, t2159, t2161, t2163, t2164;
  double t2165, t2167, t2169, t2170, t2173, t2174, t2176, t2177;
  double t2180, t2181, t2182, t2183, t2184, t2185, t2186, t2187;
  double t2189, t2190, t2191, t2193, t2198, t2200, t2204, t2210;
  double t2211, t2212, t2213, t2214, t2219, t2220, t2222, t2224;
  double t2226, t2232, t2233, t2234, tv3rho31, t2236, t2241, t2246;
  double t2250, t2251, t2256, t2259, t2263, t2264, t2265, t2266;
  double t2267, t2268, t2270, t2272, t2273, t2275, t2278, t2279;
  double t2282, t2283, t2285, t2287, t2288, t2290, t2292, t2296;
  double t2297, t2299, t2301, t2306, t2312, t2313, t2318, t2324;
  double t2325, t2326, t2327, t2328, t2332, t2334, t2338, t2340;
  double t2342, t2351, t2353, t2355, t2357, t2359, t2363, t2364;
  double t2366, t2367, t2369, t2371, t2372, t2374, t2376, t2379;
  double t2385, t2392, t2394, t2399, t2401, tv3rho32, t2411, t2419;
  double t2420, t2421, t2422, t2423, t2424, t2430, t2434, t2435;
  double t2440, t2444, t2445, t2446, t2447, t2448, t2449, t2450;
  double t2451, t2452, t2453, t2455, t2464, t2472, t2473, t2474;
  double t2475, t2476, t2477, t2478, t2479, t2480, t2483, t2484;
  double t2485, t2490, t2491, t2495, t2496, t2497, t2498, t2499;
  double t2500, t2501, t2502, t2507, t2508, t2509, t2510, t2515;
  double t2518, t2519, t2520, t2521, t2522, t2527, tv3rho33, t2528;
  double t2529, t2530, t2531, t2532, t2533, t2534, t2535, t2536;
  double t2537, t2538, t2539, t2541, t2542, t2543, t2544, t2545;
  double t2546, t2547, t2549, t2550, t2551, t2553, t2554, t2555;
  double t2556, t2557, t2558, t2559, t2560, t2562, t2563, t2565;
  double t2566, t2567, t2568, t2569, t2570, t2571, t2572, t2573;
  double t2574, t2575, t2576, t2577, t2578, t2579, t2580, t2581;
  double t2582, t2583, t2584, t2585, tv3rho2sigma0, t2587, t2588, t2589;
  double t2591, t2592, t2593, t2594, t2595, t2596, t2597, t2598;
  double t2599, t2600, t2601, t2602, t2603, t2604, t2605, t2606;
  double t2607, t2608, t2609, tv3rho2sigma1, tv3rho2sigma2, t2611, t2613, t2616;
  double t2618, t2619, t2622, t2623, t2624, t2626, t2627, t2631;
  double t2633, t2635, t2636, t2639, tv3rho2sigma3, t2642, t2643, t2644;
  double t2645, t2646, t2647, t2648, t2649, tv3rho2sigma4, tv3rho2sigma5, t2652;
  double t2653, t2654, t2655, t2656, t2657, t2658, t2659, t2660;
  double t2661, t2662, t2663, t2664, tv3rho2sigma6, t2667, t2668, t2669;
  double t2670, t2671, t2672, t2673, t2674, tv3rho2sigma7, tv3rho2sigma8, t2676;
  double t2677, t2678, t2679, t2680, t2681, t2682, t2683, t2684;
  double t2685, t2688, t2690, t2691, t2692, t2693, t2694, t2695;
  double t2696, t2697, t2698, t2699, t2700, t2701, tv3rhosigma20, t2704;
  double t2705, t2706, t2707, t2708, t2709, t2710, tv3rhosigma21, tv3rhosigma22;
  double t2713, t2714, t2715, t2716, t2717, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25;
  double t2720, t2721, t2722, t2723, tv3rhosigma26, t2726, t2727, tv3rhosigma27;
  double tv3rhosigma28, t2730, t2731, tv3rhosigma29, tv3rhosigma210, tv3rhosigma211, t2735, t2737;
  double t2738, t2739, t2740, t2741, t2742, t2743, t2744, t2745;
  double t2746, t2747, t2750, t2751, t2752, t2753, t2754, t2755;
  double t2756, tv3sigma30, t2758, t2759, t2760, tv3sigma31, tv3sigma32, t2762;
  double t2763, t2764, tv3sigma33, tv3sigma34, tv3sigma35, t2766, t2767, tv3sigma36;
  double tv3sigma37, tv3sigma38, tv3sigma39;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = rho[0] + rho[1];
  t8 = POW_1_3(t7);
  t9 = 0.1e1 / t8;
  t10 = t6 * t9;
  t11 = t4 * t10;
  t12 = t11 / 0.4e1;
  t13 = sqrt(t11);
  t15 = t12 + 0.186372e1 * t13 + 0.129352e2;
  t16 = 0.1e1 / t15;
  t20 = log(t4 * t10 * t16 / 0.4e1);
  t21 = 0.310907e-1 * t20;
  t22 = t13 + 0.372744e1;
  t25 = atan(0.61519908197590802322e1 / t22);
  t26 = 0.38783294878113014393e-1 * t25;
  t27 = t13 / 0.2e1;
  t28 = t27 + 0.10498e0;
  t29 = t28 * t28;
  t31 = log(t29 * t16);
  t32 = 0.96902277115443742139e-3 * t31;
  t33 = M_PI * M_PI;
  t34 = 0.1e1 / t33;
  t36 = t12 + 0.565535e0 * t13 + 0.130045e2;
  t37 = 0.1e1 / t36;
  t41 = log(t4 * t10 * t37 / 0.4e1);
  t42 = t13 + 0.113107e1;
  t45 = atan(0.71231089178181179908e1 / t42);
  t47 = t27 + 0.47584e-2;
  t48 = t47 * t47;
  t50 = log(t48 * t37);
  t53 = t34 * (t41 + 0.317708004743941464e0 * t45 + 0.41403379428206274608e-3 * t50);
  t54 = rho[0] - rho[1];
  t55 = 0.1e1 / t7;
  t56 = t54 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t62 = t61 * t57;
  t63 = my_piecewise3(t58, t60, t62);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t67 = t66 * t64;
  t68 = my_piecewise3(t65, t60, t67);
  t69 = t63 + t68 - 0.2e1;
  t70 = t53 * t69;
  t71 = M_CBRT2;
  t72 = t71 - 0.1e1;
  t74 = 0.1e1 / t72 / 0.2e1;
  t75 = t54 * t54;
  t76 = t75 * t75;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = 0.1e1 / t78;
  t83 = 0.9e1 * t72;
  t84 = t74 * (-t76 * t79 + 0.1e1) * t83;
  t86 = t70 * t84 / 0.24e2;
  t88 = t12 + 0.353021e1 * t13 + 0.180578e2;
  t89 = 0.1e1 / t88;
  t93 = log(t4 * t10 * t89 / 0.4e1);
  t95 = t13 + 0.706042e1;
  t98 = atan(0.473092690956011283e1 / t95);
  t100 = t27 + 0.325e0;
  t101 = t100 * t100;
  t103 = log(t101 * t89);
  t105 = 0.1554535e-1 * t93 + 0.52491393169780936218e-1 * t98 + 0.22478670955426118383e-2 * t103 - t21 - t26 - t32;
  t106 = t105 * t69;
  t107 = t74 * t76;
  t108 = t107 * t79;
  t109 = t106 * t108;
  t111 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t113 = 0.1e1 / t8 / t77;
  t114 = t111 * t113;
  t115 = params->aa + params->bb;
  t116 = params->ftilde * t115;
  t117 = params->malpha * t1;
  t118 = t3 * t6;
  t119 = t118 * t9;
  t122 = t1 * t1;
  t123 = params->mbeta * t122;
  t124 = t3 * t3;
  t125 = t124 * t5;
  t126 = t8 * t8;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t131 = params->bb + t117 * t119 / 0.4e1 + t123 * t128 / 0.4e1;
  t132 = params->mgamma * t1;
  t135 = params->mdelta * t122;
  t140 = 0.1e1 + t132 * t119 / 0.4e1 + t135 * t128 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t55;
  t141 = 0.1e1 / t140;
  t143 = t131 * t141 + params->aa;
  t144 = 0.1e1 / t143;
  t145 = sqrt(t111);
  t146 = t144 * t145;
  t147 = pow(t7, 0.1e1 / 0.6e1);
  t149 = 0.1e1 / t147 / t7;
  t152 = exp(-t116 * t146 * t149);
  t153 = t114 * t152;
  t154 = t59 * t59;
  t155 = t154 * p->zeta_threshold;
  t156 = t61 * t61;
  t157 = t156 * t57;
  t158 = my_piecewise3(t58, t155, t157);
  t159 = t66 * t66;
  t160 = t159 * t64;
  t161 = my_piecewise3(t65, t155, t160);
  t162 = t158 + t161;
  t163 = sqrt(t162);
  t164 = 0.1e1 / t163;
  t165 = t143 * t164;
  t166 = M_SQRT2;
  t167 = t165 * t166;
  t168 = t153 * t167;
  tzk0 = t21 + t26 + t32 - t86 + t109 + t168;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t170 = 0.1e1 / t8 / t7;
  t171 = t6 * t170;
  t175 = t4 * t6;
  t176 = t15 * t15;
  t177 = 0.1e1 / t176;
  t178 = t9 * t177;
  t179 = t4 * t171;
  t180 = t179 / 0.12e2;
  t181 = 0.1e1 / t13;
  t182 = t181 * t1;
  t183 = t118 * t170;
  t184 = t182 * t183;
  t186 = -t180 - 0.31062e0 * t184;
  t192 = 0.1e1 / t3;
  t193 = (-t4 * t171 * t16 / 0.12e2 - t175 * t178 * t186 / 0.4e1) * t122 * t192;
  t194 = t5 * t8;
  t195 = t194 * t15;
  t196 = t193 * t195;
  t197 = 0.10363566666666666667e-1 * t196;
  t198 = t22 * t22;
  t199 = 0.1e1 / t198;
  t201 = t199 * t181 * t1;
  t203 = 0.378469910464e2 * t199 + 0.1e1;
  t204 = 0.1e1 / t203;
  t207 = t201 * t118 * t170 * t204;
  t208 = 0.39765745675026770179e-1 * t207;
  t209 = t28 * t16;
  t210 = t209 * t181;
  t213 = t29 * t177;
  t215 = -t210 * t179 / 0.6e1 - t213 * t186;
  t216 = 0.1e1 / t29;
  t217 = t215 * t216;
  t218 = t217 * t15;
  t219 = 0.96902277115443742139e-3 * t218;
  t223 = t36 * t36;
  t224 = 0.1e1 / t223;
  t225 = t9 * t224;
  t227 = -t180 - 0.94255833333333333334e-1 * t184;
  t233 = (-t4 * t171 * t37 / 0.12e2 - t175 * t225 * t227 / 0.4e1) * t122 * t192;
  t234 = t194 * t36;
  t237 = t42 * t42;
  t238 = 0.1e1 / t237;
  t240 = t238 * t181 * t1;
  t242 = 0.50738680655100000001e2 * t238 + 0.1e1;
  t243 = 0.1e1 / t242;
  t248 = t47 * t37;
  t249 = t248 * t181;
  t252 = t48 * t224;
  t254 = -t249 * t179 / 0.6e1 - t252 * t227;
  t255 = 0.1e1 / t48;
  t256 = t254 * t255;
  t260 = t34 * (t233 * t234 / 0.3e1 + 0.37717812030896172975e0 * t240 * t118 * t170 * t243 + 0.41403379428206274608e-3 * t256 * t36);
  t261 = t260 * t69;
  t262 = t261 * t84;
  t263 = t262 / 0.24e2;
  t264 = 0.1e1 / t77;
  t265 = t54 * t264;
  t266 = t55 - t265;
  t269 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t266);
  t270 = -t266;
  t273 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t270);
  t274 = t269 + t273;
  t275 = t53 * t274;
  t276 = t275 * t84;
  t277 = t276 / 0.24e2;
  t278 = t75 * t54;
  t279 = t278 * t79;
  t280 = t78 * t7;
  t281 = 0.1e1 / t280;
  t282 = t76 * t281;
  t286 = t74 * (-0.4e1 * t279 + 0.4e1 * t282) * t83;
  t287 = t70 * t286;
  t288 = t287 / 0.24e2;
  t292 = t88 * t88;
  t293 = 0.1e1 / t292;
  t294 = t9 * t293;
  t296 = -t180 - 0.58836833333333333333e0 * t184;
  t302 = (-t4 * t171 * t89 / 0.12e2 - t175 * t294 * t296 / 0.4e1) * t122 * t192;
  t303 = t194 * t88;
  t306 = t95 * t95;
  t307 = 0.1e1 / t306;
  t309 = t307 * t181 * t1;
  t311 = 0.223816694236e2 * t307 + 0.1e1;
  t312 = 0.1e1 / t311;
  t317 = t100 * t89;
  t318 = t317 * t181;
  t321 = t101 * t293;
  t323 = -t318 * t179 / 0.6e1 - t321 * t296;
  t324 = 0.1e1 / t101;
  t325 = t323 * t324;
  t328 = 0.51817833333333333333e-2 * t302 * t303 + 0.41388824077869423261e-1 * t309 * t118 * t170 * t312 + 0.22478670955426118383e-2 * t325 * t88 - t197 - t208 - t219;
  t329 = t328 * t69;
  t330 = t329 * t108;
  t331 = t105 * t274;
  t332 = t331 * t108;
  t333 = t74 * t278;
  t334 = t333 * t79;
  t335 = t106 * t334;
  t336 = 0.4e1 * t335;
  t337 = t107 * t281;
  t338 = t106 * t337;
  t339 = 0.4e1 * t338;
  t340 = t77 * t7;
  t342 = 0.1e1 / t8 / t340;
  t343 = t111 * t342;
  t344 = t343 * t152;
  t345 = t344 * t167;
  t346 = 0.7e1 / 0.3e1 * t345;
  t347 = t143 * t143;
  t348 = 0.1e1 / t347;
  t349 = t116 * t348;
  t350 = t145 * t149;
  t354 = 0.1e1 / t126 / t7;
  t355 = t125 * t354;
  t358 = -t117 * t183 / 0.12e2 - t123 * t355 / 0.6e1;
  t360 = t140 * t140;
  t361 = 0.1e1 / t360;
  t362 = t131 * t361;
  t369 = -t132 * t183 / 0.12e2 - t135 * t355 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta * t264;
  t371 = t141 * t358 - t362 * t369;
  t375 = 0.1e1 / t147 / t77;
  t379 = t349 * t350 * t371 + 0.7e1 / 0.6e1 * t116 * t146 * t375;
  t380 = t114 * t379;
  t381 = t152 * t143;
  t382 = t164 * t166;
  t383 = t381 * t382;
  t384 = t380 * t383;
  t386 = t371 * t164 * t166;
  t387 = t153 * t386;
  t389 = 0.1e1 / t163 / t162;
  t390 = t143 * t389;
  t393 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t266);
  t396 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t270);
  t397 = t393 + t396;
  t398 = t166 * t397;
  t399 = t390 * t398;
  t400 = t153 * t399;
  t401 = t400 / 0.2e1;
  t402 = t197 + t208 + t219 - t263 - t277 - t288 + t330 + t332 + t336 - t339 - t346 + t384 + t387 - t401;
  tvrho0 = t402 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t404 = -t55 - t265;
  t407 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t404);
  t408 = -t404;
  t411 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t408);
  t412 = t407 + t411;
  t413 = t53 * t412;
  t414 = t413 * t84;
  t415 = t414 / 0.24e2;
  t419 = t74 * (0.4e1 * t279 + 0.4e1 * t282) * t83;
  t420 = t70 * t419;
  t421 = t420 / 0.24e2;
  t422 = t105 * t412;
  t423 = t422 * t108;
  t426 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t404);
  t429 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t408);
  t430 = t426 + t429;
  t431 = t166 * t430;
  t432 = t390 * t431;
  t433 = t153 * t432;
  t434 = t433 / 0.2e1;
  t435 = t197 + t208 + t219 - t263 - t415 - t421 + t330 + t423 - t336 - t339 - t346 + t384 + t387 - t434;
  tvrho1 = t435 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t437 = t113 * t152;
  t438 = t437 * t167;
  t439 = sqrt(t7);
  t441 = 0.1e1 / t439 / t340;
  t442 = t145 * t441;
  t445 = t115 * t152 * t382;
  t446 = t442 * params->ftilde * t445;
  t447 = t446 / 0.2e1;
  tvsigma0 = t7 * (t438 - t447);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t449 = 0.2e1 * t438;
  tvsigma1 = t7 * (t449 - t446);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = tvsigma0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t451 = 0.14e2 / 0.3e1 * t345;
  t452 = 0.2e1 * t384;
  t453 = 0.79531491350053540358e-1 * t207;
  t454 = t74 * t75;
  t455 = t454 * t79;
  t456 = t106 * t455;
  t457 = 0.12e2 * t456;
  t458 = t333 * t281;
  t459 = t106 * t458;
  t460 = 0.32e2 * t459;
  t461 = t331 * t334;
  t462 = 0.8e1 * t461;
  t463 = t331 * t337;
  t464 = 0.8e1 * t463;
  t465 = t328 * t274;
  t466 = t465 * t108;
  t467 = 0.2e1 * t466;
  t468 = t6 * t113;
  t470 = t4 * t468 * t89;
  t472 = t170 * t293;
  t477 = 0.1e1 / t292 / t88;
  t478 = t9 * t477;
  t479 = t296 * t296;
  t483 = t4 * t468;
  t484 = t483 / 0.9e1;
  t486 = 0.1e1 / t13 / t11;
  t487 = t486 * t122;
  t489 = 0.1e1 / t126 / t77;
  t490 = t125 * t489;
  t491 = t487 * t490;
  t493 = t118 * t113;
  t494 = t182 * t493;
  t496 = t484 - 0.39224555555555555555e0 * t491 + 0.7844911111111111111e0 * t494;
  t502 = (t470 / 0.9e1 + t175 * t472 * t296 / 0.6e1 + t175 * t478 * t479 / 0.2e1 - t175 * t294 * t496 / 0.4e1) * t122 * t192;
  t505 = t5 * t127;
  t506 = t505 * t88;
  t509 = t194 * t296;
  t512 = t306 * t95;
  t514 = 0.1e1 / t512 * t1;
  t515 = t514 * t3;
  t520 = t307 * t486 * t122;
  t529 = t306 * t306;
  t531 = 0.1e1 / t529 / t95;
  t532 = t531 * t1;
  t533 = t532 * t3;
  t534 = t311 * t311;
  t535 = 0.1e1 / t534;
  t540 = t100 * t293;
  t541 = t540 * t182;
  t542 = t170 * t296;
  t546 = t317 * t486;
  t547 = t122 * t124;
  t548 = t5 * t489;
  t549 = t547 * t548;
  t554 = t101 * t477;
  t558 = t470 / 0.72e2 + t541 * t118 * t542 / 0.3e1 - t546 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t318 * t483 + 0.2e1 * t554 * t479 - t321 * t496;
  t559 = t558 * t324;
  t563 = 0.1e1 / t101 / t100;
  t564 = t323 * t563;
  t565 = t88 * t181;
  t566 = t564 * t565;
  t572 = t4 * t468 * t16;
  t574 = t170 * t177;
  t579 = 0.1e1 / t176 / t15;
  t580 = t9 * t579;
  t581 = t186 * t186;
  t587 = t484 - 0.20708e0 * t491 + 0.41416e0 * t494;
  t593 = (t572 / 0.9e1 + t175 * t574 * t186 / 0.6e1 + t175 * t580 * t581 / 0.2e1 - t175 * t178 * t587 / 0.4e1) * t122 * t192;
  t594 = t593 * t195;
  t595 = 0.10363566666666666667e-1 * t594;
  t596 = t505 * t15;
  t597 = t193 * t596;
  t598 = 0.34545222222222222223e-2 * t597;
  t599 = t194 * t186;
  t600 = t193 * t599;
  t601 = 0.10363566666666666667e-1 * t600;
  t602 = t198 * t22;
  t603 = 0.1e1 / t602;
  t604 = t603 * t1;
  t605 = t604 * t3;
  t607 = t605 * t468 * t204;
  t608 = 0.13255248558342256726e-1 * t607;
  t610 = t199 * t486 * t122;
  t613 = t610 * t125 * t489 * t204;
  t614 = 0.26510497116684513453e-1 * t613;
  t617 = t201 * t118 * t113 * t204;
  t618 = 0.53020994233369026905e-1 * t617;
  t619 = t198 * t198;
  t621 = 0.1e1 / t619 / t22;
  t622 = t621 * t1;
  t623 = t622 * t3;
  t624 = t203 * t203;
  t625 = 0.1e1 / t624;
  t627 = t623 * t468 * t625;
  t628 = 0.50167127350538589834e0 * t627;
  t630 = t28 * t177;
  t631 = t630 * t182;
  t632 = t170 * t186;
  t636 = t209 * t486;
  t641 = t29 * t579;
  t645 = t572 / 0.72e2 + t631 * t118 * t632 / 0.3e1 - t636 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t210 * t483 + 0.2e1 * t641 * t581 - t213 * t587;
  t646 = t645 * t216;
  t647 = t646 * t15;
  t648 = 0.96902277115443742139e-3 * t647;
  t650 = 0.1e1 / t29 / t28;
  t651 = t215 * t650;
  t652 = t15 * t181;
  t653 = t651 * t652;
  t654 = t653 * t179;
  t655 = 0.1615037951924062369e-3 * t654;
  t656 = t217 * t186;
  t657 = 0.96902277115443742139e-3 * t656;
  t658 = 0.51817833333333333333e-2 * t502 * t303 + 0.17272611111111111111e-2 * t302 * t506 + 0.51817833333333333333e-2 * t302 * t509 + 0.13796274692623141087e-1 * t515 * t468 * t312 + 0.27592549385246282174e-1 * t520 * t125 * t489 * t312 - 0.55185098770492564348e-1 * t309 * t118 * t113 * t312 - 0.30878365944746984535e0 * t533 * t468 * t535 + 0.22478670955426118383e-2 * t559 * t88 + 0.37464451592376863972e-3 * t566 * t179 + 0.22478670955426118383e-2 * t325 * t296 - t595 - t598 - t601 - t608 - t614 + t618 + t628 - t648 - t655 - t657;
  t659 = t658 * t69;
  t660 = t659 * t108;
  t661 = t78 * t77;
  t662 = 0.1e1 / t661;
  t663 = t107 * t662;
  t664 = t106 * t663;
  t665 = 0.2e2 * t664;
  t666 = 0.1e1 / t156;
  t667 = t266 * t266;
  t670 = 0.1e1 / t340;
  t671 = t54 * t670;
  t673 = -0.2e1 * t264 + 0.2e1 * t671;
  t677 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t667 + 0.4e1 / 0.3e1 * t61 * t673);
  t678 = 0.1e1 / t159;
  t679 = t270 * t270;
  t682 = -t673;
  t686 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t679 + 0.4e1 / 0.3e1 * t66 * t682);
  t687 = t677 + t686;
  t688 = t105 * t687;
  t689 = t688 * t108;
  t690 = t379 * t379;
  t691 = t114 * t690;
  t692 = t691 * t383;
  t693 = t162 * t162;
  t695 = 0.1e1 / t163 / t693;
  t696 = t143 * t695;
  t697 = t397 * t397;
  t698 = t166 * t697;
  t699 = t696 * t698;
  t700 = t153 * t699;
  t701 = 0.3e1 / 0.4e1 * t700;
  t702 = 0.1e1 / t61;
  t708 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t667 + 0.5e1 / 0.3e1 * t156 * t673);
  t709 = 0.1e1 / t66;
  t715 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t679 + 0.5e1 / 0.3e1 * t159 * t682);
  t716 = t708 + t715;
  t717 = t166 * t716;
  t718 = t390 * t717;
  t719 = t153 * t718;
  t720 = t719 / 0.2e1;
  t721 = t371 * t389;
  t722 = t721 * t398;
  t723 = t153 * t722;
  t724 = t152 * t371;
  t725 = t724 * t382;
  t726 = t380 * t725;
  t727 = 0.2e1 * t726;
  t728 = t344 * t399;
  t729 = 0.7e1 / 0.3e1 * t728;
  t730 = t343 * t379;
  t731 = t730 * t383;
  t732 = 0.14e2 / 0.3e1 * t731;
  t734 = 0.1e1 / t347 / t143;
  t735 = t116 * t734;
  t736 = t371 * t371;
  t740 = t145 * t375;
  t748 = t117 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t123 * t490;
  t750 = t358 * t361;
  t754 = 0.1e1 / t360 / t140;
  t755 = t131 * t754;
  t756 = t369 * t369;
  t765 = t132 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t135 * t490 + 0.4774648292756860073e4 * params->mbeta * t670;
  t767 = t141 * t748 - t362 * t765 - 0.2e1 * t369 * t750 + 0.2e1 * t755 * t756;
  t771 = 0.1e1 / t147 / t340;
  t775 = -0.2e1 * t735 * t350 * t736 - 0.7e1 / 0.3e1 * t349 * t740 * t371 + t349 * t350 * t767 - 0.91e2 / 0.36e2 * t116 * t146 * t771;
  t776 = t114 * t775;
  t777 = t776 * t383;
  t778 = t457 - t460 + t462 - t464 + t467 + t660 + t665 + t689 + t655 + t692 + t701 - t720 - t723 + t727 + t729 - t732 + t777 + t614 - t618;
  t780 = 0.1e1 / t8 / t78;
  t781 = t111 * t780;
  t782 = t781 * t152;
  t783 = t782 * t167;
  t784 = 0.7e2 / 0.9e1 * t783;
  t786 = t4 * t468 * t37;
  t788 = t170 * t224;
  t793 = 0.1e1 / t223 / t36;
  t794 = t9 * t793;
  t795 = t227 * t227;
  t801 = t484 - 0.62837222222222222223e-1 * t491 + 0.12567444444444444445e0 * t494;
  t807 = (t786 / 0.9e1 + t175 * t788 * t227 / 0.6e1 + t175 * t794 * t795 / 0.2e1 - t175 * t225 * t801 / 0.4e1) * t122 * t192;
  t810 = t505 * t36;
  t813 = t194 * t227;
  t816 = t237 * t42;
  t817 = 0.1e1 / t816;
  t818 = t817 * t1;
  t819 = t818 * t3;
  t824 = t238 * t486 * t122;
  t833 = t237 * t237;
  t835 = 0.1e1 / t833 / t42;
  t836 = t835 * t1;
  t837 = t836 * t3;
  t838 = t242 * t242;
  t839 = 0.1e1 / t838;
  t844 = t47 * t224;
  t845 = t844 * t182;
  t846 = t170 * t227;
  t850 = t248 * t486;
  t855 = t48 * t793;
  t859 = t786 / 0.72e2 + t845 * t118 * t846 / 0.3e1 - t850 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t249 * t483 + 0.2e1 * t855 * t795 - t252 * t801;
  t860 = t859 * t255;
  t864 = 0.1e1 / t48 / t47;
  t865 = t254 * t864;
  t866 = t36 * t181;
  t867 = t865 * t866;
  t873 = t34 * (t807 * t234 / 0.3e1 + t233 * t810 / 0.9e1 + t233 * t813 / 0.3e1 + 0.12572604010298724325e0 * t819 * t468 * t243 + 0.2514520802059744865e0 * t824 * t125 * t489 * t243 - 0.502904160411948973e0 * t240 * t118 * t113 * t243 - 0.63791733988157656508e1 * t837 * t468 * t839 + 0.41403379428206274608e-3 * t860 * t36 + 0.69005632380343791013e-4 * t867 * t179 + 0.41403379428206274608e-3 * t256 * t227);
  t874 = t873 * t69;
  t875 = t874 * t84;
  t876 = t875 / 0.24e2;
  t877 = t260 * t274;
  t878 = t877 * t84;
  t879 = t878 / 0.12e2;
  t880 = t261 * t286;
  t881 = t880 / 0.12e2;
  t882 = t379 * t152;
  t883 = t114 * t882;
  t884 = t883 * t399;
  t885 = t329 * t334;
  t886 = 0.8e1 * t885;
  t887 = t329 * t337;
  t888 = 0.8e1 * t887;
  t890 = t767 * t164 * t166;
  t891 = t153 * t890;
  t892 = t344 * t386;
  t893 = 0.14e2 / 0.3e1 * t892;
  t895 = 0.12e2 * t75 * t79;
  t897 = 0.32e2 * t278 * t281;
  t899 = 0.2e2 * t76 * t662;
  t902 = t74 * (-t895 + t897 - t899) * t83;
  t903 = t70 * t902;
  t904 = t903 / 0.24e2;
  t905 = t53 * t687;
  t906 = t905 * t84;
  t907 = t906 / 0.24e2;
  t908 = t275 * t286;
  t909 = t908 / 0.12e2;
  t910 = t784 - t876 - t879 - t881 + t648 + t657 - t884 + t886 - t888 + t891 - t893 + t595 + t598 + t601 + t608 - t628 - t904 - t907 - t909;
  t913 = 0.2e1 * t330;
  t915 = 0.19380455423088748428e-2 * t218;
  t916 = 0.20727133333333333334e-1 * t196;
  t917 = t262 / 0.12e2;
  t920 = 0.8e1 * t335;
  t921 = 0.8e1 * t338;
  t922 = 0.2e1 * t387;
  tv2rho20 = -t451 - t400 + t452 + t453 + t7 * (t778 + t910) + t913 + 0.2e1 * t332 + t915 + t916 - t917 - t276 / 0.12e2 - t287 / 0.12e2 + t920 - t921 + t922;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t925 = t344 * t432;
  t927 = t721 * t431;
  t928 = t153 * t927;
  t930 = t702 * t404;
  t933 = t156 * t54;
  t937 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t930 * t266 + 0.1e2 / 0.3e1 * t933 * t670);
  t938 = t709 * t408;
  t941 = t159 * t54;
  t945 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t938 * t270 - 0.1e2 / 0.3e1 * t941 * t670);
  t946 = t937 + t945;
  t947 = t166 * t946;
  t948 = t390 * t947;
  t949 = t153 * t948;
  t951 = -t457 - 0.4e1 * t461 - 0.4e1 * t463 + t466 + t660 + t665 + t655 + 0.7e1 / 0.6e1 * t925 - t928 / 0.2e1 - t949 / 0.2e1 + t692;
  t954 = t422 * t334;
  t956 = t422 * t337;
  t958 = t666 * t404;
  t961 = t61 * t54;
  t965 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t958 * t266 + 0.8e1 / 0.3e1 * t961 * t670);
  t966 = t678 * t408;
  t969 = t66 * t54;
  t973 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t966 * t270 - 0.8e1 / 0.3e1 * t969 * t670);
  t974 = t965 + t973;
  t975 = t105 * t974;
  t976 = t975 * t108;
  t977 = t328 * t412;
  t978 = t977 * t108;
  t979 = -t723 / 0.2e1 + t727 + 0.7e1 / 0.6e1 * t728 - t732 + t777 + t614 - t618 + 0.4e1 * t954 - 0.4e1 * t956 + t976 + t978;
  t981 = t275 * t419;
  t985 = t74 * (t895 - t899) * t83;
  t986 = t70 * t985;
  t988 = t53 * t974;
  t989 = t988 * t84;
  t991 = t413 * t286;
  t993 = t261 * t419;
  t995 = t260 * t412;
  t996 = t995 * t84;
  t1000 = -t981 / 0.24e2 - t986 / 0.24e2 - t989 / 0.24e2 - t991 / 0.24e2 - t993 / 0.24e2 - t996 / 0.24e2 + t784 - t876 - t878 / 0.24e2 - t880 / 0.24e2 + t648;
  t1002 = t114 * t381;
  t1003 = t695 * t166;
  t1004 = t430 * t397;
  t1005 = t1003 * t1004;
  t1006 = t1002 * t1005;
  t1008 = t883 * t432;
  t1010 = t657 - t884 / 0.2e1 - t888 + 0.3e1 / 0.4e1 * t1006 - t1008 / 0.2e1 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho21 = -t434 - t451 - t401 + t452 + t453 + t423 + t913 + t332 + t7 * (t951 + t979 + t1000 + t1010) + t915 + t916 - t917 - t277 - t288 - t921 + t922 - t415 - t421;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1014 = 0.7e1 / 0.3e1 * t925;
  t1015 = t404 * t404;
  t1019 = 0.2e1 * t264 + 0.2e1 * t671;
  t1023 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t1015 + 0.5e1 / 0.3e1 * t156 * t1019);
  t1024 = t408 * t408;
  t1027 = -t1019;
  t1031 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t1024 + 0.5e1 / 0.3e1 * t159 * t1027);
  t1032 = t1023 + t1031;
  t1033 = t166 * t1032;
  t1034 = t390 * t1033;
  t1035 = t153 * t1034;
  t1036 = t1035 / 0.2e1;
  t1042 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t1015 + 0.4e1 / 0.3e1 * t61 * t1019);
  t1048 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t1024 + 0.4e1 / 0.3e1 * t66 * t1027);
  t1049 = t1042 + t1048;
  t1050 = t105 * t1049;
  t1051 = t1050 * t108;
  t1054 = t74 * (-t895 - t897 - t899) * t83;
  t1055 = t70 * t1054;
  t1056 = t1055 / 0.24e2;
  t1057 = t53 * t1049;
  t1058 = t1057 * t84;
  t1059 = t1058 / 0.24e2;
  t1060 = t413 * t419;
  t1061 = t1060 / 0.12e2;
  t1062 = 0.8e1 * t954;
  t1063 = t457 + t460 + t660 + t665 + t655 + t1014 - t1036 - t928 + t1051 + t692 + t727 - t732 + t777 - t1056 - t1059 - t1061 + t614 - t618 - t1062;
  t1064 = 0.8e1 * t956;
  t1065 = 0.2e1 * t978;
  t1066 = t993 / 0.12e2;
  t1067 = t996 / 0.12e2;
  t1068 = t430 * t430;
  t1069 = t166 * t1068;
  t1070 = t696 * t1069;
  t1071 = t153 * t1070;
  t1072 = 0.3e1 / 0.4e1 * t1071;
  t1073 = -t1064 + t1065 - t1066 - t1067 + t784 - t876 + t1072 + t648 + t657 - t886 - t888 - t1008 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho22 = t7 * (t1063 + t1073) - t433 - t451 + t452 + t453 + 0.2e1 * t423 + t913 + t915 + t916 - t917 - t920 - t921 + t922 - t414 / 0.12e2 - t420 / 0.12e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1079 = t342 * t152;
  t1080 = t1079 * t167;
  t1081 = 0.7e1 / 0.3e1 * t1080;
  t1082 = t113 * t379;
  t1083 = t1082 * t152;
  t1084 = t1083 * t167;
  t1085 = t437 * t386;
  t1086 = t437 * t143;
  t1087 = t389 * t166;
  t1088 = t1087 * t397;
  t1089 = t1086 * t1088;
  t1090 = t1089 / 0.2e1;
  t1092 = 0.1e1 / t439 / t78;
  t1093 = t145 * t1092;
  t1095 = t1093 * params->ftilde * t445;
  t1096 = 0.7e1 / 0.4e1 * t1095;
  t1097 = t442 * t116;
  t1098 = t882 * t382;
  t1099 = t1097 * t1098;
  t1100 = t1099 / 0.2e1;
  t1101 = t152 * t389;
  t1102 = t1101 * t398;
  t1103 = t1097 * t1102;
  t1104 = t1103 / 0.4e1;
  tv2rhosigma0 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1090 + t1096 - t1100 + t1104);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1107 = 0.14e2 / 0.3e1 * t1080;
  t1108 = 0.2e1 * t1084;
  t1109 = 0.2e1 * t1085;
  t1110 = 0.7e1 / 0.2e1 * t1095;
  t1111 = t1103 / 0.2e1;
  tv2rhosigma1 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1089 + t1110 - t1099 + t1111);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = tv2rhosigma0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1114 = t1087 * t430;
  t1115 = t1086 * t1114;
  t1116 = t1115 / 0.2e1;
  t1117 = t1101 * t431;
  t1118 = t1097 * t1117;
  t1119 = t1118 / 0.4e1;
  tv2rhosigma3 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1116 + t1096 - t1100 + t1119);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1122 = t1118 / 0.2e1;
  tv2rhosigma4 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1115 + t1110 - t1099 + t1122);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = tv2rhosigma3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1125 = t441 * params->ftilde;
  t1126 = t1125 * t115;
  t1127 = 0.1e1 / t145;
  t1128 = t1127 * t152;
  t1129 = t1128 * t382;
  t1130 = t1126 * t1129;
  t1131 = 0.3e1 / 0.4e1 * t1130;
  t1133 = 0.1e1 / t126 / t78;
  t1134 = params->ftilde * params->ftilde;
  t1135 = t1133 * t1134;
  t1136 = t115 * t115;
  t1138 = t144 * t152;
  t1139 = t1138 * t382;
  t1140 = t1135 * t1136 * t1139;
  t1141 = t1140 / 0.4e1;
  tv2sigma20 = t7 * (-t1131 + t1141);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t1143 = 0.3e1 / 0.2e1 * t1130;
  t1144 = t1140 / 0.2e1;
  tv2sigma21 = t7 * (-t1143 + t1144);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t1146 = 0.3e1 * t1130;
  tv2sigma23 = t7 * (-t1146 + t1140);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1148 = 0.36e2 * t456;
  t1149 = 0.96e2 * t459;
  t1153 = 0.3e1 * t660;
  t1154 = 0.6e2 * t664;
  t1156 = t329 * t458;
  t1157 = 0.96e2 * t1156;
  t1158 = t329 * t455;
  t1159 = 0.36e2 * t1158;
  t1163 = 0.1e1 / t13 / t547 / t505 / 0.4e1;
  t1164 = t199 * t1163;
  t1165 = t2 * t79;
  t1167 = t1164 * t1165 * t204;
  t1168 = 0.15906298270010708072e0 * t1167;
  t1169 = t344 * t890;
  t1170 = 0.7e1 * t1169;
  t1171 = t118 * t342;
  t1175 = 0.1e1 / t126 / t340;
  t1176 = t125 * t1175;
  t1179 = -0.7e1 / 0.27e2 * t117 * t1171 - 0.2e2 / 0.27e2 * t123 * t1176;
  t1181 = t748 * t361;
  t1184 = t358 * t754;
  t1189 = t360 * t360;
  t1190 = 0.1e1 / t1189;
  t1191 = t131 * t1190;
  t1192 = t756 * t369;
  t1195 = t369 * t765;
  t1204 = -0.7e1 / 0.27e2 * t132 * t1171 - 0.2e2 / 0.27e2 * t135 * t1176 - 0.14323944878270580219e5 * params->mbeta * t79;
  t1206 = t1179 * t141 - 0.3e1 * t1181 * t369 + 0.6e1 * t1184 * t756 - 0.6e1 * t1191 * t1192 + 0.6e1 * t1195 * t755 - t1204 * t362 - 0.3e1 * t750 * t765;
  t1208 = t1206 * t164 * t166;
  t1209 = t153 * t1208;
  t1210 = t782 * t386;
  t1211 = 0.7e2 / 0.3e1 * t1210;
  t1212 = t593 * t599;
  t1213 = 0.20727133333333333334e-1 * t1212;
  t1214 = t6 * t342;
  t1216 = t4 * t1214 * t16;
  t1218 = t113 * t177;
  t1220 = t175 * t1218 * t186;
  t1222 = t170 * t579;
  t1229 = t176 * t176;
  t1230 = 0.1e1 / t1229;
  t1231 = t9 * t1230;
  t1232 = t581 * t186;
  t1236 = t186 * t587;
  t1240 = t4 * t1214;
  t1241 = 0.7e1 / 0.27e2 * t1240;
  t1242 = t1163 * t2;
  t1243 = t1242 * t79;
  t1245 = t487 * t1176;
  t1247 = t182 * t1171;
  t1249 = -t1241 - 0.124248e1 * t1243 + 0.82832e0 * t1245 - 0.96637333333333333333e0 * t1247;
  t1255 = (-0.7e1 / 0.27e2 * t1216 - t1220 / 0.3e1 - t175 * t1222 * t581 / 0.2e1 + t175 * t574 * t587 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1231 * t1232 + 0.3e1 / 0.2e1 * t175 * t580 * t1236 - t175 * t178 * t1249 / 0.4e1) * t122 * t192;
  t1256 = t1255 * t195;
  t1257 = 0.10363566666666666667e-1 * t1256;
  t1259 = t605 * t1214 * t204;
  t1260 = 0.48602578047254941329e-1 * t1259;
  t1261 = t593 * t596;
  t1262 = 0.69090444444444444446e-2 * t1261;
  t1264 = t5 * t354;
  t1265 = t1264 * t15;
  t1266 = t193 * t1265;
  t1267 = 0.23030148148148148149e-2 * t1266;
  t1268 = t331 * t458;
  t1269 = 0.96e2 * t1268;
  t1270 = t74 * t54;
  t1271 = t1270 * t79;
  t1272 = t106 * t1271;
  t1273 = 0.24e2 * t1272;
  t1274 = t454 * t281;
  t1275 = t106 * t1274;
  t1276 = 0.144e3 * t1275;
  t1277 = 0.1e1 / t124;
  t1278 = t622 * t1277;
  t1279 = t1214 * t625;
  t1280 = t1278 * t1279;
  t1281 = 0.26614487661862784322e-1 * t1280;
  t1282 = t623 * t1279;
  t1283 = 0.18394613361864149606e1 * t1282;
  t1284 = t194 * t587;
  t1285 = t193 * t1284;
  t1286 = 0.10363566666666666667e-1 * t1285;
  t1287 = t505 * t186;
  t1288 = t193 * t1287;
  t1289 = 0.69090444444444444446e-2 * t1288;
  t1290 = t261 * t902;
  t1292 = t275 * t902;
  t1293 = t1292 / 0.8e1;
  t1294 = t54 * t79;
  t1295 = 0.24e2 * t1294;
  t1296 = t75 * t281;
  t1297 = 0.144e3 * t1296;
  t1298 = t278 * t662;
  t1299 = 0.24e3 * t1298;
  t1301 = 0.1e1 / t78 / t340;
  t1303 = 0.12e3 * t76 * t1301;
  t1306 = t74 * (-t1295 + t1297 - t1299 + t1303) * t83;
  t1307 = t70 * t1306;
  t1308 = t1307 / 0.24e2;
  t1309 = -t1267 - t1269 + t1273 - t1276 - t1281 + t1283 + t1286 + t1289 - t1290 / 0.8e1 - t1293 - t1308;
  t1311 = t260 * t687;
  t1312 = t1311 * t84;
  t1314 = t873 * t274;
  t1315 = t1314 * t84;
  t1316 = t1315 / 0.8e1;
  t1317 = 0.1e1 / t157;
  t1318 = t667 * t266;
  t1321 = t666 * t266;
  t1325 = 0.6e1 * t670 - 0.6e1 * t1294;
  t1329 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1317 * t1318 + 0.4e1 / 0.3e1 * t1321 * t673 + 0.4e1 / 0.3e1 * t61 * t1325);
  t1330 = 0.1e1 / t160;
  t1331 = t679 * t270;
  t1334 = t678 * t270;
  t1337 = -t1325;
  t1341 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1330 * t1331 + 0.4e1 / 0.3e1 * t1334 * t682 + 0.4e1 / 0.3e1 * t66 * t1337);
  t1342 = t1329 + t1341;
  t1343 = t53 * t1342;
  t1344 = t1343 * t84;
  t1345 = t1344 / 0.24e2;
  t1346 = t905 * t286;
  t1347 = t1346 / 0.8e1;
  t1348 = t877 * t286;
  t1350 = t874 * t286;
  t1351 = t1350 / 0.8e1;
  t1352 = t238 * t1163;
  t1356 = t1214 * t839;
  t1359 = t194 * t801;
  t1362 = t836 * t1277;
  t1365 = t505 * t227;
  t1371 = t4 * t1214 * t37;
  t1373 = t113 * t224;
  t1375 = t175 * t1373 * t227;
  t1377 = t170 * t793;
  t1384 = t223 * t223;
  t1385 = 0.1e1 / t1384;
  t1386 = t9 * t1385;
  t1387 = t795 * t227;
  t1391 = t227 * t801;
  t1398 = -t1241 - 0.37702333333333333334e0 * t1243 + 0.2513488888888888889e0 * t1245 - 0.29324037037037037038e0 * t1247;
  t1404 = (-0.7e1 / 0.27e2 * t1371 - t1375 / 0.3e1 - t175 * t1377 * t795 / 0.2e1 + t175 * t788 * t801 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1386 * t1387 + 0.3e1 / 0.2e1 * t175 * t794 * t1391 - t175 * t225 * t1398 / 0.4e1) * t122 * t192;
  t1407 = t833 * t833;
  t1408 = 0.1e1 / t1407;
  t1409 = t1408 * t122;
  t1410 = t1409 * t124;
  t1411 = t5 * t1175;
  t1413 = 0.1e1 / t838 / t242;
  t1414 = t1413 * t181;
  t1418 = t48 * t48;
  t1419 = 0.1e1 / t1418;
  t1420 = t254 * t1419;
  t1421 = t1420 * t36;
  t1427 = 0.1e1 / t833;
  t1428 = t1427 * t122;
  t1429 = t1428 * t124;
  t1430 = t243 * t181;
  t1435 = 0.1e1 / t833 / t237;
  t1436 = t1435 * t122;
  t1437 = t1436 * t124;
  t1438 = t839 * t181;
  t1442 = 0.1508712481235846919e1 * t1352 * t1165 * t243 + 0.23390302462324474053e2 * t837 * t1356 + t233 * t1359 / 0.3e1 - 0.33842565975395191035e0 * t1362 * t1356 + 0.2e1 / 0.9e1 * t233 * t1365 + 0.2e1 / 0.3e1 * t807 * t813 + t1404 * t234 / 0.3e1 + 0.86312224513605868233e3 * t1410 * t1411 * t1414 + 0.17251408095085947753e-4 * t1421 * t483 - 0.46099548037761989191e0 * t819 * t1214 * t243 + 0.2514520802059744865e0 * t1429 * t1411 * t1430 - 0.29769475861140239704e2 * t1437 * t1411 * t1438;
  t1443 = t818 * t1277;
  t1444 = t2 * t243;
  t1450 = t1264 * t36;
  t1453 = t859 * t864;
  t1454 = t1453 * t866;
  t1457 = t227 * t181;
  t1458 = t865 * t1457;
  t1461 = t36 * t486;
  t1462 = t865 * t1461;
  t1477 = t47 * t793;
  t1478 = t1477 * t182;
  t1482 = t844 * t487;
  t1496 = t1 * t1277 * t6;
  t1497 = t342 * t2;
  t1503 = t547 * t1411;
  t1508 = t48 * t1385;
  t1514 = -0.11e2 / 0.216e3 * t1371 - t1375 / 0.24e2 - t1478 * t118 * t170 * t795 + t1482 * t125 * t489 * t227 / 0.3e1 - 0.2e1 / 0.3e1 * t845 * t118 * t113 * t227 + t845 * t118 * t170 * t801 / 0.2e1 + t1496 * t1497 * t37 / 0.432e3 - 0.2e1 / 0.3e1 * t248 * t1243 + 0.4e1 / 0.9e1 * t850 * t1503 - 0.14e2 / 0.27e2 * t249 * t1240 - 0.6e1 * t1508 * t1387 + 0.6e1 * t855 * t1391 - t252 * t1398;
  t1515 = t1514 * t255;
  t1522 = 0.20954340017164540542e-1 * t1443 * t1214 * t1444 + 0.2e1 / 0.9e1 * t807 * t810 - 0.2e1 / 0.27e2 * t233 * t1450 + 0.13801126476068758203e-3 * t1454 * t179 + 0.13801126476068758203e-3 * t1458 * t179 + 0.46003754920229194009e-4 * t1462 * t549 + 0.11734430409612142703e1 * t240 * t118 * t342 * t243 - 0.1005808320823897946e1 * t824 * t125 * t1175 * t243 + 0.41403379428206274608e-3 * t256 * t801 + 0.41403379428206274608e-3 * t1515 * t36 + 0.82806758856412549216e-3 * t860 * t227 - 0.92007509840458388017e-4 * t867 * t483;
  t1524 = t34 * (t1442 + t1522);
  t1525 = t1524 * t69;
  t1526 = t1525 * t84;
  t1527 = t1526 / 0.24e2;
  t1529 = 0.1e1 / t8 / t280;
  t1530 = t111 * t1529;
  t1531 = t1530 * t152;
  t1532 = t1531 * t167;
  t1533 = 0.91e3 / 0.27e2 * t1532;
  t1534 = t659 * t337;
  t1535 = 0.12e2 * t1534;
  t1536 = t331 * t455;
  t1537 = 0.36e2 * t1536;
  t1539 = t659 * t334;
  t1540 = 0.12e2 * t1539;
  t1543 = t610 * t125 * t1175 * t204;
  t1544 = 0.10604198846673805381e0 * t1543;
  t1547 = t201 * t118 * t342 * t204;
  t1548 = 0.12371565321119439611e0 * t1547;
  t1549 = t344 * t722;
  t1550 = 0.7e1 * t1549;
  t1551 = t730 * t725;
  t1552 = 0.14e2 * t1551;
  t1553 = t767 * t389;
  t1554 = t1553 * t398;
  t1555 = t153 * t1554;
  t1556 = 0.3e1 / 0.2e1 * t1555;
  t1557 = t152 * t767;
  t1558 = t1557 * t382;
  t1559 = t380 * t1558;
  t1560 = 0.3e1 * t1559;
  t1561 = t465 * t334;
  t1562 = 0.24e2 * t1561;
  t1563 = t465 * t337;
  t1564 = 0.24e2 * t1563;
  t1565 = t688 * t334;
  t1567 = t688 * t337;
  t1569 = t1540 - t1544 + t1548 + t1550 - t1552 - t1556 + t1560 + t1562 - t1564 + 0.12e2 * t1565 - 0.12e2 * t1567;
  t1572 = t333 * t662;
  t1573 = t106 * t1572;
  t1574 = 0.24e3 * t1573;
  t1575 = t107 * t1301;
  t1576 = t106 * t1575;
  t1577 = 0.12e3 * t1576;
  t1578 = t328 * t687;
  t1579 = t1578 * t108;
  t1581 = t329 * t663;
  t1582 = 0.6e2 * t1581;
  t1583 = t658 * t274;
  t1584 = t1583 * t108;
  t1585 = 0.3e1 * t1584;
  t1586 = t331 * t663;
  t1587 = 0.6e2 * t1586;
  t1588 = t29 * t29;
  t1589 = 0.1e1 / t1588;
  t1590 = t215 * t1589;
  t1591 = t1590 * t15;
  t1592 = t1591 * t483;
  t1593 = 0.40375948798101559225e-4 * t1592;
  t1594 = t619 * t619;
  t1595 = 0.1e1 / t1594;
  t1596 = t1595 * t122;
  t1597 = t1596 * t124;
  t1599 = 0.1e1 / t624 / t203;
  t1600 = t1599 * t181;
  t1602 = t1597 * t1411 * t1600;
  t1603 = 0.50631328524251801694e2 * t1602;
  t1604 = 0.1e1 / t619;
  t1605 = t1604 * t122;
  t1606 = t1605 * t124;
  t1607 = t204 * t181;
  t1609 = t1606 * t1411 * t1607;
  t1610 = 0.26510497116684513452e-1 * t1609;
  t1612 = 0.1e1 / t619 / t198;
  t1613 = t1612 * t122;
  t1614 = t1613 * t124;
  t1615 = t625 * t181;
  t1617 = t1614 * t1411 * t1615;
  t1618 = 0.23411326096918008589e1 * t1617;
  t1620 = t604 * t1277;
  t1621 = t2 * t204;
  t1623 = t1620 * t1214 * t1621;
  t1624 = 0.22092080930570427878e-2 * t1623;
  t1625 = t371 * t695;
  t1626 = t1625 * t698;
  t1627 = t153 * t1626;
  t1629 = t691 * t725;
  t1630 = 0.3e1 * t1629;
  t1631 = t782 * t399;
  t1632 = 0.35e2 / 0.3e1 * t1631;
  t1633 = t344 * t699;
  t1635 = t347 * t347;
  t1637 = t116 / t1635;
  t1638 = t736 * t371;
  t1645 = t371 * t767;
  t1649 = t145 * t771;
  t1659 = 0.1e1 / t147 / t78;
  t1663 = 0.6e1 * t1637 * t350 * t1638 + 0.7e1 * t735 * t740 * t736 - 0.6e1 * t735 * t350 * t1645 + 0.91e2 / 0.12e2 * t349 * t1649 * t371 - 0.7e1 / 0.2e1 * t349 * t740 * t767 + t349 * t350 * t1206 + 0.1729e4 / 0.216e3 * t116 * t146 * t1659;
  t1664 = t114 * t1663;
  t1665 = t1664 * t383;
  t1666 = t343 * t775;
  t1667 = t1666 * t383;
  t1668 = 0.7e1 * t1667;
  t1669 = t776 * t725;
  t1670 = 0.3e1 * t1669;
  t1671 = 0.1e1 / t62;
  t1674 = t702 * t266;
  t1680 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t1671 * t1318 + 0.1e2 / 0.3e1 * t1674 * t673 + 0.5e1 / 0.3e1 * t156 * t1325);
  t1681 = 0.1e1 / t67;
  t1684 = t709 * t270;
  t1690 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t1681 * t1331 + 0.1e2 / 0.3e1 * t1684 * t682 + 0.5e1 / 0.3e1 * t159 * t1337);
  t1691 = t1680 + t1690;
  t1692 = t166 * t1691;
  t1693 = t390 * t1692;
  t1694 = t153 * t1693;
  t1695 = t1694 / 0.2e1;
  t1696 = t721 * t717;
  t1697 = t153 * t1696;
  t1699 = t690 * t379;
  t1700 = t114 * t1699;
  t1701 = t1700 * t383;
  t1702 = t1624 + 0.9e1 / 0.4e1 * t1627 + t1630 - t1632 - 0.21e2 / 0.4e1 * t1633 + t1665 - t1668 + t1670 - t1695 - 0.3e1 / 0.2e1 * t1697 + t1701;
  t1706 = 0.1e1 / t163 / t693 / t162;
  t1707 = t143 * t1706;
  t1708 = t697 * t397;
  t1709 = t166 * t1708;
  t1710 = t1707 * t1709;
  t1711 = t153 * t1710;
  t1712 = 0.15e2 / 0.8e1 * t1711;
  t1713 = t781 * t379;
  t1714 = t1713 * t383;
  t1715 = 0.7e2 / 0.3e1 * t1714;
  t1716 = t343 * t690;
  t1717 = t1716 * t383;
  t1718 = 0.7e1 * t1717;
  t1719 = t344 * t718;
  t1722 = t4 * t1214 * t89;
  t1724 = t113 * t293;
  t1726 = t175 * t1724 * t296;
  t1728 = t170 * t477;
  t1735 = t292 * t292;
  t1736 = 0.1e1 / t1735;
  t1737 = t9 * t1736;
  t1738 = t479 * t296;
  t1742 = t296 * t496;
  t1749 = -t1241 - 0.23534733333333333333e1 * t1243 + 0.15689822222222222222e1 * t1245 - 0.18304792592592592592e1 * t1247;
  t1755 = (-0.7e1 / 0.27e2 * t1722 - t1726 / 0.3e1 - t175 * t1728 * t479 / 0.2e1 + t175 * t472 * t496 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1737 * t1738 + 0.3e1 / 0.2e1 * t175 * t478 * t1742 - t175 * t294 * t1749 / 0.4e1) * t122 * t192;
  t1763 = t1264 * t88;
  t1766 = t532 * t1277;
  t1767 = t1214 * t535;
  t1772 = t194 * t496;
  t1775 = t505 * t296;
  t1780 = -t1168 + 0.51817833333333333333e-2 * t1755 * t303 - 0.50586340539618183985e-1 * t515 * t1214 * t312 + 0.34545222222222222222e-2 * t502 * t506 - 0.11515074074074074074e-2 * t302 * t1763 - 0.16381481915689750931e-1 * t1766 * t1767 + 0.1132206751307389433e1 * t533 * t1767 + 0.51817833333333333333e-2 * t302 * t1772 + 0.34545222222222222222e-2 * t302 * t1775 + 0.10363566666666666667e-1 * t502 * t509 - t1213 - t1257;
  t1789 = t529 * t529;
  t1790 = 0.1e1 / t1789;
  t1791 = t1790 * t122;
  t1792 = t1791 * t124;
  t1794 = 0.1e1 / t534 / t311;
  t1795 = t1794 * t181;
  t1799 = t101 * t101;
  t1800 = 0.1e1 / t1799;
  t1801 = t323 * t1800;
  t1802 = t1801 * t88;
  t1805 = 0.1e1 / t529;
  t1806 = t1805 * t122;
  t1807 = t1806 * t124;
  t1808 = t312 * t181;
  t1812 = t1260 - t1262 + t1267 + t1281 - t1283 - t1286 - t1289 + 0.12876523046448265015e0 * t309 * t118 * t342 * t312 - 0.1103701975409851287e0 * t520 * t125 * t1175 * t312 + 0.18429583437767336288e2 * t1792 * t1411 * t1795 + 0.9366112898094215993e-4 * t1802 * t483 + 0.27592549385246282174e-1 * t1807 * t1411 * t1808;
  t1815 = 0.1e1 / t529 / t306;
  t1816 = t1815 * t122;
  t1817 = t1816 * t124;
  t1818 = t535 * t181;
  t1822 = t514 * t1277;
  t1823 = t2 * t312;
  t1827 = t217 * t587;
  t1828 = 0.96902277115443742139e-3 * t1827;
  t1829 = t646 * t186;
  t1830 = 0.19380455423088748428e-2 * t1829;
  t1833 = t28 * t579;
  t1834 = t1833 * t182;
  t1838 = t630 * t487;
  t1860 = t29 * t1230;
  t1866 = -0.11e2 / 0.216e3 * t1216 - t1220 / 0.24e2 - t1834 * t118 * t170 * t581 + t1838 * t125 * t489 * t186 / 0.3e1 - 0.2e1 / 0.3e1 * t631 * t118 * t113 * t186 + t631 * t118 * t170 * t587 / 0.2e1 + t1496 * t1497 * t16 / 0.432e3 - 0.2e1 / 0.3e1 * t209 * t1243 + 0.4e1 / 0.9e1 * t636 * t1503 - 0.14e2 / 0.27e2 * t210 * t1240 - 0.6e1 * t1860 * t1232 + 0.6e1 * t641 * t1236 - t213 * t1249;
  t1867 = t1866 * t216;
  t1868 = t1867 * t15;
  t1869 = 0.96902277115443742139e-3 * t1868;
  t1870 = -0.14409904107548592783e1 * t1817 * t1411 * t1818 + 0.22993791154371901812e-2 * t1822 * t1214 * t1823 + t1544 - t1548 - t1593 - t1603 - t1610 + t1618 - t1624 - t1828 - t1830 - t1869;
  t1871 = t186 * t181;
  t1872 = t651 * t1871;
  t1873 = t1872 * t179;
  t1874 = 0.3230075903848124738e-3 * t1873;
  t1875 = t15 * t486;
  t1876 = t651 * t1875;
  t1877 = t1876 * t549;
  t1878 = 0.10766919679493749127e-3 * t1877;
  t1879 = t645 * t650;
  t1880 = t1879 * t652;
  t1881 = t1880 * t179;
  t1882 = 0.3230075903848124738e-3 * t1881;
  t1883 = t558 * t563;
  t1884 = t1883 * t565;
  t1887 = t296 * t181;
  t1888 = t564 * t1887;
  t1891 = t88 * t486;
  t1892 = t564 * t1891;
  t1895 = t653 * t483;
  t1896 = 0.21533839358987498253e-3 * t1895;
  t1899 = t307 * t1163;
  t1909 = t100 * t477;
  t1910 = t1909 * t182;
  t1914 = t540 * t487;
  t1936 = t101 * t1736;
  t1942 = -0.11e2 / 0.216e3 * t1722 - t1726 / 0.24e2 - t1910 * t118 * t170 * t479 + t1914 * t125 * t489 * t296 / 0.3e1 - 0.2e1 / 0.3e1 * t541 * t118 * t113 * t296 + t541 * t118 * t170 * t496 / 0.2e1 + t1496 * t1497 * t89 / 0.432e3 - 0.2e1 / 0.3e1 * t317 * t1243 + 0.4e1 / 0.9e1 * t546 * t1503 - 0.14e2 / 0.27e2 * t318 * t1240 - 0.6e1 * t1936 * t1738 + 0.6e1 * t554 * t1742 - t321 * t1749;
  t1943 = t1942 * t324;
  t1946 = -t1874 - t1878 - t1882 + 0.74928903184753727944e-3 * t1884 * t179 + 0.74928903184753727944e-3 * t1888 * t179 + 0.24976301061584575981e-3 * t1892 * t549 + t1896 - 0.49952602123169151963e-3 * t566 * t483 + 0.16555529631147769304e0 * t1899 * t1165 * t312 + 0.22478670955426118383e-2 * t325 * t496 + 0.44957341910852236766e-2 * t559 * t296 + 0.22478670955426118383e-2 * t1943 * t88;
  t1948 = t1780 + t1812 + t1870 + t1946;
  t1949 = t1948 * t69;
  t1950 = t1949 * t108;
  t1951 = t883 * t699;
  t1953 = t690 * t152;
  t1954 = t114 * t1953;
  t1955 = t1954 * t399;
  t1956 = 0.3e1 / 0.2e1 * t1955;
  t1958 = t775 * t152;
  t1959 = t114 * t1958;
  t1960 = t1959 * t399;
  t1961 = 0.3e1 / 0.2e1 * t1960;
  t1962 = t775 * t379;
  t1963 = t114 * t1962;
  t1964 = t1963 * t383;
  t1965 = 0.3e1 * t1964;
  t1967 = t1003 * t716 * t397;
  t1968 = t1002 * t1967;
  t1969 = 0.9e1 / 0.4e1 * t1968;
  t1970 = t883 * t718;
  t1972 = t883 * t722;
  t1973 = 0.3e1 * t1972;
  t1974 = t343 * t882;
  t1975 = t1974 * t399;
  t1976 = 0.7e1 * t1975;
  t1977 = t105 * t1342;
  t1978 = t1977 * t108;
  t1979 = -t1961 + t1965 + t1969 - 0.3e1 / 0.2e1 * t1970 - t1973 + t1976 + t1874 + t1878 + t1882 - t1896 + t1978;
  t1984 = 0.4845113855772187107e-3 * t654;
  t1985 = 0.3e1 * t692;
  t1989 = 0.6e1 * t726;
  t1991 = 0.14e2 * t731;
  t1992 = 0.3e1 * t777;
  t1993 = 0.79531491350053540358e-1 * t613;
  t1994 = t1148 - t1149 + 0.24e2 * t461 - 0.24e2 * t463 + 0.6e1 * t466 + t1153 + t1154 + 0.3e1 * t689 + t7 * (t1950 + 0.9e1 / 0.4e1 * t1951 - t1348 / 0.4e1 - t1351 - t1535 + t1537 + t1979 + t1168 + t1603 + t1211 + t1213 + t1610 + t1262 - t1157 + t1159 - t1718 + 0.7e1 / 0.2e1 * t1719 - t1312 / 0.8e1 + t1569 + t1869 - t1345 - t1347 - t1170 + t1830 - t1527 + t1309 - t1956 + t1593 - t1533 + t1585 + t1587 + 0.3e1 * t1579 + t1582 + t1257 - t1260 + t1574 - t1577 + t1702 + t1209 + t1828 - t1316 - t1712 + t1715 - t1618) + t1984 + t1985 + 0.9e1 / 0.4e1 * t700 - 0.3e1 / 0.2e1 * t719 - 0.3e1 * t723 + t1989 + 0.7e1 * t728 - t1991 + t1992 + t1993;
  t1995 = 0.15906298270010708072e0 * t617;
  t1996 = 0.7e2 / 0.3e1 * t783;
  t1997 = t875 / 0.8e1;
  t2000 = 0.29070683134633122642e-2 * t647;
  t2001 = 0.29070683134633122642e-2 * t656;
  t2003 = 0.24e2 * t885;
  t2004 = 0.24e2 * t887;
  t2005 = 0.3e1 * t891;
  t2006 = 0.14e2 * t892;
  t2007 = 0.31090700000000000001e-1 * t594;
  t2008 = 0.10363566666666666667e-1 * t597;
  t2009 = 0.31090700000000000001e-1 * t600;
  t2010 = 0.39765745675026770179e-1 * t607;
  t2011 = 0.1505013820516157695e1 * t627;
  t2015 = -t1995 + t1996 - t1997 - t878 / 0.4e1 - t880 / 0.4e1 + t2000 + t2001 - 0.3e1 * t884 + t2003 - t2004 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011 - t903 / 0.8e1 - t906 / 0.8e1 - t908 / 0.4e1;
  tv3rho30 = t1994 + t2015;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2018 = -t457 - t460 - 0.16e2 * t463 + 0.4e1 * t466 + t1153 + t1154 + t689 + t1984 + t1014 - t928 - t949 + t1985 + t701;
  t2021 = 0.2e1 * t976;
  t2022 = t981 / 0.12e2;
  t2023 = -t720 - 0.2e1 * t723 + t1989 + 0.14e2 / 0.3e1 * t728 - t1991 + t1992 + t1993 - t1995 + t1062 - t1064 + t2021 + t1065 - t2022;
  t2025 = t986 / 0.12e2;
  t2026 = t989 / 0.12e2;
  t2027 = t991 / 0.12e2;
  t2030 = 0.32e2 * t1156;
  t2031 = 0.12e2 * t1158;
  t2032 = 0.48e2 * t1275;
  t2033 = -t2030 - t2031 + t1168 - t1170 + t1209 + t1211 + t1213 + t1257 - t1260 + t1262 - t1267 - t1273 + t2032 - t1281;
  t2036 = t328 * t974;
  t2037 = t2036 * t108;
  t2038 = 0.2e1 * t2037;
  t2039 = t977 * t337;
  t2041 = t975 * t334;
  t2042 = 0.8e1 * t2041;
  t2043 = t975 * t337;
  t2044 = 0.8e1 * t2043;
  t2045 = t1317 * t404;
  t2048 = t666 * t54;
  t2049 = t670 * t266;
  t2059 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t2045 * t667 + 0.16e2 / 0.9e1 * t2048 * t2049 + 0.4e1 / 0.9e1 * t958 * t673 + 0.8e1 / 0.3e1 * t61 * t670 - 0.8e1 * t961 * t79);
  t2060 = t1330 * t408;
  t2063 = t678 * t54;
  t2064 = t670 * t270;
  t2074 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t2060 * t679 - 0.16e2 / 0.9e1 * t2063 * t2064 + 0.4e1 / 0.9e1 * t966 * t682 - 0.8e1 / 0.3e1 * t66 * t670 + 0.8e1 * t969 * t79);
  t2075 = t2059 + t2074;
  t2076 = t105 * t2075;
  t2077 = t2076 * t108;
  t2078 = t658 * t412;
  t2079 = t2078 * t108;
  t2080 = t260 * t974;
  t2081 = t2080 * t84;
  t2082 = t2081 / 0.12e2;
  t2083 = t53 * t2075;
  t2084 = t2083 * t84;
  t2086 = t988 * t286;
  t2088 = t1283 + t1286 + t1289 - t1290 / 0.24e2 - t1312 / 0.24e2 + t2038 - 0.8e1 * t2039 + t2042 - t2044 + t2077 + t2079 - t2082 - t2084 / 0.24e2 - t2086 / 0.12e2;
  t2090 = t995 * t286;
  t2091 = t2090 / 0.12e2;
  t2092 = t905 * t419;
  t2094 = t275 * t985;
  t2096 = t261 * t985;
  t2097 = t2096 / 0.12e2;
  t2098 = 0.48e2 * t1296;
  t2099 = 0.8e2 * t1298;
  t2102 = t74 * (t1295 - t2098 - t2099 + t1303) * t83;
  t2103 = t70 * t2102;
  t2105 = t877 * t419;
  t2106 = t2105 / 0.12e2;
  t2107 = t977 * t334;
  t2112 = t422 * t663;
  t2114 = t422 * t455;
  t2116 = -t2091 - t2092 / 0.24e2 - t2094 / 0.12e2 - t2097 - t2103 / 0.24e2 - t2106 + 0.8e1 * t2107 - t1315 / 0.12e2 - t1348 / 0.12e2 - t1350 / 0.12e2 - t1527 - t1533 + 0.2e2 * t2112 + 0.12e2 * t2114;
  t2117 = t422 * t458;
  t2119 = t1553 * t431;
  t2120 = t153 * t2119;
  t2122 = t721 * t947;
  t2123 = t153 * t2122;
  t2124 = t1671 * t404;
  t2127 = t702 * t54;
  t2137 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t2124 * t667 + 0.4e2 / 0.9e1 * t2127 * t2049 + 0.1e2 / 0.9e1 * t930 * t673 + 0.1e2 / 0.3e1 * t156 * t670 - 0.1e2 * t933 * t79);
  t2138 = t1681 * t408;
  t2141 = t709 * t54;
  t2151 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t2138 * t679 - 0.4e2 / 0.9e1 * t2141 * t2064 + 0.1e2 / 0.9e1 * t938 * t682 - 0.1e2 / 0.3e1 * t159 * t670 + 0.1e2 * t941 * t79);
  t2152 = t2137 + t2151;
  t2153 = t166 * t2152;
  t2154 = t390 * t2153;
  t2155 = t153 * t2154;
  t2157 = t344 * t948;
  t2158 = 0.7e1 / 0.3e1 * t2157;
  t2159 = t344 * t927;
  t2161 = t782 * t432;
  t2163 = 0.24e2 * t1536;
  t2164 = 0.4e1 * t1539;
  t2165 = t1954 * t432;
  t2167 = t1706 * t166;
  t2169 = t2167 * t430 * t697;
  t2170 = t1002 * t2169;
  t2173 = t1003 * t946 * t397;
  t2174 = t1002 * t2173;
  t2176 = t883 * t948;
  t2177 = -0.32e2 * t2117 - t2120 / 0.2e1 - t2123 - t2155 / 0.2e1 + t2158 + 0.7e1 / 0.3e1 * t2159 - 0.35e2 / 0.9e1 * t2161 - t1535 - t2163 + t2164 - t2165 / 0.2e1 - 0.15e2 / 0.8e1 * t2170 + 0.3e1 / 0.2e1 * t2174 - t2176;
  t2180 = t114 * t724;
  t2181 = t2180 * t1005;
  t2182 = 0.3e1 / 0.2e1 * t2181;
  t2183 = t883 * t927;
  t2184 = t343 * t381;
  t2185 = t2184 * t1005;
  t2186 = 0.7e1 / 0.2e1 * t2185;
  t2187 = t1974 * t432;
  t2189 = t430 * t716;
  t2190 = t1003 * t2189;
  t2191 = t1002 * t2190;
  t2193 = t1959 * t432;
  t2198 = t2182 - t2183 - t2186 + 0.7e1 / 0.3e1 * t2187 + 0.3e1 / 0.4e1 * t2191 - t2193 / 0.2e1 - t1544 + t1548 + 0.14e2 / 0.3e1 * t1549 - t1552 - t1555 + t1560 - 0.16e2 * t1563 - 0.4e1 * t1565;
  t2200 = 0.8e2 * t1573;
  t2204 = -0.4e1 * t1567 + t2200 - t1577 + t1579 + t1582 + 0.2e1 * t1584 + 0.4e2 * t1586 + t1593 + t1603 + t1610 - t1618 + t1624 + 0.3e1 / 0.4e1 * t1627 + t1630;
  t2210 = t431 * t397;
  t2211 = t696 * t2210;
  t2212 = t883 * t2211;
  t2213 = 0.3e1 / 0.2e1 * t2212;
  t2214 = -0.7e2 / 0.9e1 * t1631 - 0.7e1 / 0.4e1 * t1633 + t1665 - t1668 + t1670 - t1697 / 0.2e1 + t1701 + t1715 - t1718 + 0.7e1 / 0.6e1 * t1719 + t2213 + t1950 + t1828 + t1830;
  t2219 = t873 * t412;
  t2220 = t2219 * t84;
  t2222 = t413 * t902;
  t2224 = t874 * t419;
  t2226 = t1869 + 0.3e1 / 0.4e1 * t1951 - t1955 - t1960 + t1965 - t1970 / 0.2e1 - 0.2e1 * t1972 + 0.14e2 / 0.3e1 * t1975 + t1874 + t1878 + t1882 - t1896 - t2220 / 0.24e2 - t2222 / 0.24e2 - t2224 / 0.24e2;
  t2232 = -t2025 - t2026 - t2027 - t1066 - t1067 + t1996 - t1997 - t878 / 0.6e1 - t880 / 0.6e1 + t2000 + t2001 + t7 * (t2033 + t2088 + t2116 + t2177 + t2198 + t2204 + t2214 + t2226) - 0.2e1 * t884;
  t2233 = 0.3e1 / 0.2e1 * t1006;
  t2234 = t886 - t2004 + t2233 - t1008 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011 - t904 - t907 - t909;
  tv3rho31 = t2018 + t2023 + t2232 + t2234;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2236 = t1317 * t1015;
  t2241 = t666 * t1019;
  t2246 = -0.2e1 * t670 - 0.6e1 * t1294;
  t2250 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t2236 * t266 + 0.16e2 / 0.9e1 * t958 * t671 + 0.4e1 / 0.9e1 * t2241 * t266 + 0.4e1 / 0.3e1 * t61 * t2246);
  t2251 = t1330 * t1024;
  t2256 = t678 * t1027;
  t2259 = -t2246;
  t2263 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t2251 * t270 - 0.16e2 / 0.9e1 * t966 * t671 + 0.4e1 / 0.9e1 * t2256 * t270 + 0.4e1 / 0.3e1 * t66 * t2259);
  t2264 = t2250 + t2263;
  t2265 = t105 * t2264;
  t2266 = t2265 * t108;
  t2267 = t328 * t1049;
  t2268 = t2267 * t108;
  t2270 = t2030 - t2031 + t1168 - t1170 + t1209 + t1211 + t1213 + t1257 - t1260 + t1262 - t1267 + t2266 + t2268 + 0.32e2 * t1268;
  t2272 = t1003 * t1032 * t397;
  t2273 = t1002 * t2272;
  t2275 = t883 * t1034;
  t2278 = t2167 * t1068 * t397;
  t2279 = t1002 * t2278;
  t2282 = t1003 * t430 * t946;
  t2283 = t1002 * t2282;
  t2285 = t883 * t1070;
  t2287 = t721 * t1033;
  t2288 = t153 * t2287;
  t2290 = t344 * t1034;
  t2292 = t1273 + t2032 - t1281 + t1283 + t1286 + t1289 + 0.3e1 / 0.4e1 * t2273 - t2275 / 0.2e1 - 0.15e2 / 0.8e1 * t2279 + 0.3e1 / 0.2e1 * t2283 + 0.3e1 / 0.4e1 * t2285 + t2038 - t2288 / 0.2e1 + 0.7e1 / 0.6e1 * t2290;
  t2296 = t1625 * t1069;
  t2297 = t153 * t2296;
  t2299 = t344 * t1070;
  t2301 = t1671 * t1015;
  t2306 = t702 * t1019;
  t2312 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t2301 * t266 + 0.4e2 / 0.9e1 * t930 * t671 + 0.1e2 / 0.9e1 * t2306 * t266 + 0.5e1 / 0.3e1 * t156 * t2246);
  t2313 = t1681 * t1024;
  t2318 = t709 * t1027;
  t2324 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t2313 * t270 - 0.4e2 / 0.9e1 * t938 * t671 + 0.1e2 / 0.9e1 * t2318 * t270 + 0.5e1 / 0.3e1 * t159 * t2259);
  t2325 = t2312 + t2324;
  t2326 = t166 * t2325;
  t2327 = t390 * t2326;
  t2328 = t153 * t2327;
  t2332 = -0.16e2 * t2039 - t2042 - t2044 + 0.2e1 * t2079 - t2082 - t2091 - t2097 - t2106 + 0.3e1 / 0.4e1 * t2297 - 0.7e1 / 0.4e1 * t2299 - t2328 / 0.2e1 - t1315 / 0.24e2 - t1350 / 0.24e2 - t1527;
  t2334 = 0.24e2 * t2114;
  t2338 = t1050 * t334;
  t2340 = t1050 * t337;
  t2342 = -t1533 + 0.4e2 * t2112 - t2334 - t2120 - t2123 + t2158 + 0.14e2 / 0.3e1 * t2159 - 0.7e2 / 0.9e1 * t2161 - t1535 + 0.12e2 * t1536 - t2164 + 0.4e1 * t2338 - 0.4e1 * t2340 - t2165;
  t2351 = -t2176 + t2182 - 0.2e1 * t2183 - t2186 + 0.14e2 / 0.3e1 * t2187 - t2193 - t1544 + t1548 + 0.7e1 / 0.3e1 * t1549 - t1552 - t1555 / 0.2e1 + t1560 - 0.8e1 * t1561 - 0.8e1 * t1563;
  t2353 = t995 * t419;
  t2355 = t988 * t419;
  t2357 = t413 * t985;
  t2359 = t275 * t1054;
  t2363 = t74 * (-t1295 - t2098 + t2099 + t1303) * t83;
  t2364 = t70 * t2363;
  t2366 = t260 * t1049;
  t2367 = t2366 * t84;
  t2369 = t261 * t1054;
  t2371 = t53 * t2264;
  t2372 = t2371 * t84;
  t2374 = t1057 * t286;
  t2376 = -t2200 - t1577 + t1582 + t1584 + 0.2e2 * t1586 - t2353 / 0.12e2 - t2355 / 0.12e2 - t2357 / 0.12e2 - t2359 / 0.24e2 - t2364 / 0.24e2 - t2367 / 0.24e2 - t2369 / 0.24e2 - t2372 / 0.24e2 - t2374 / 0.24e2;
  t2379 = t1593 + t1603 + t1610 - t1618 + t1624 + t1630 - 0.35e2 / 0.9e1 * t1631 + t1665 - t1668 + t1670 + t1701 + t1715 - t1718 + t2213;
  t2385 = t1950 + t1828 + t1830 + t1869 - t1955 / 0.2e1 - t1960 / 0.2e1 + t1965 - t1972 + 0.7e1 / 0.3e1 * t1975 + t1874 + t1878 + t1882 - t1896 - t2220 / 0.12e2 - t2224 / 0.12e2;
  t2392 = -t457 + t460 - t462 - t464 + t467 + t1153 + t1154 + t7 * (t2270 + t2292 + t2332 + t2342 + t2351 + t2376 + t2379 + t2385) + t1984 + 0.14e2 / 0.3e1 * t925 - t1036 - 0.2e1 * t928 + t1051;
  t2394 = -t949 + t1985 - t723 + t1989 + t729 - t1991 + t1992 - t1056 - t1059 - t1061 + t1993 - t1995 - 0.16e2 * t956;
  t2399 = t2021 + 0.4e1 * t978 - t2022 - t2025 - t2026 - t2027 - t993 / 0.6e1 - t996 / 0.6e1 + t1996 - t1997 - t879 - t881 + t1072;
  t2401 = t2000 + t2001 - t884 - t886 - t2004 + t2233 - 0.2e1 * t1008 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011;
  tv3rho32 = t2392 + t2394 + t2399 + t2401;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2411 = t1148 + t1149 + t1153 + t1154 + t1984 + 0.7e1 * t925 - 0.3e1 / 0.2e1 * t1035 - 0.3e1 * t928 + 0.3e1 * t1051 + t1985 + t1989 - t1991 + t1992 - t1055 / 0.8e1 - t1058 / 0.8e1 - t1060 / 0.4e1 + t1993 - t1995 - 0.24e2 * t954;
  t2419 = t1068 * t430;
  t2420 = t166 * t2419;
  t2421 = t1707 * t2420;
  t2422 = t153 * t2421;
  t2423 = 0.15e2 / 0.8e1 * t2422;
  t2424 = t1015 * t404;
  t2430 = -0.6e1 * t670 - 0.6e1 * t1294;
  t2434 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t1671 * t2424 + 0.1e2 / 0.3e1 * t930 * t1019 + 0.5e1 / 0.3e1 * t156 * t2430);
  t2435 = t1024 * t408;
  t2440 = -t2430;
  t2444 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t1681 * t2435 + 0.1e2 / 0.3e1 * t938 * t1027 + 0.5e1 / 0.3e1 * t159 * t2440);
  t2445 = t2434 + t2444;
  t2446 = t166 * t2445;
  t2447 = t390 * t2446;
  t2448 = t153 * t2447;
  t2449 = t2448 / 0.2e1;
  t2450 = t1032 * t430;
  t2451 = t1003 * t2450;
  t2452 = t1002 * t2451;
  t2453 = 0.9e1 / 0.4e1 * t2452;
  t2455 = -t1267 - t2423 - t2449 + t2453 + 0.3e1 * t2268 - t1273 - t1276 - t1281 + t1283 + t1286 + t1289;
  t2464 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1317 * t2424 + 0.4e1 / 0.3e1 * t958 * t1019 + 0.4e1 / 0.3e1 * t61 * t2430);
  t2472 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1330 * t2435 + 0.4e1 / 0.3e1 * t966 * t1027 + 0.4e1 / 0.3e1 * t66 * t2440);
  t2473 = t2464 + t2472;
  t2474 = t53 * t2473;
  t2475 = t2474 * t84;
  t2476 = t2475 / 0.24e2;
  t2477 = t1057 * t419;
  t2478 = t2477 / 0.8e1;
  t2479 = t413 * t1054;
  t2480 = t2479 / 0.8e1;
  t2483 = t74 * (t1295 + t1297 + t1299 + t1303) * t83;
  t2484 = t70 * t2483;
  t2485 = t2484 / 0.24e2;
  t2490 = 0.24e2 * t2039;
  t2491 = 0.3e1 * t2079;
  t2495 = 0.24e2 * t2107;
  t2496 = 0.6e2 * t2112;
  t2497 = 0.36e2 * t2114;
  t2498 = 0.96e2 * t2117;
  t2499 = 0.3e1 / 0.2e1 * t2120;
  t2500 = 0.7e1 * t2159;
  t2501 = 0.35e2 / 0.3e1 * t2161;
  t2502 = 0.9e1 / 0.4e1 * t2297 - 0.21e2 / 0.4e1 * t2299 - t2495 - t1527 - t1533 + t2496 + t2497 + t2498 - t2499 + t2500 - t2501;
  t2507 = 0.3e1 / 0.2e1 * t2165;
  t2508 = 0.3e1 * t2183;
  t2509 = 0.7e1 * t2187;
  t2510 = 0.3e1 / 0.2e1 * t2193;
  t2515 = -t1552 + t1560 - t1574 - t1577 + t1582 - t2353 / 0.4e1 - t2367 / 0.8e1 - t2369 / 0.8e1 + t1593 + t1603 + t1610;
  t2518 = t105 * t2473;
  t2519 = t2518 * t108;
  t2520 = t2220 / 0.8e1;
  t2521 = t2224 / 0.8e1;
  t2522 = t1828 + t1830 + t1869 + t1965 + t1874 + t1878 + t1882 - t1896 + t2519 - t2520 - t2521;
  t2527 = -0.24e2 * t956 + 0.6e1 * t978 - t993 / 0.4e1 - t996 / 0.4e1 + t1996 - t1997 + 0.9e1 / 0.4e1 * t1071 + t2000 + t2001 - t2003 - t2004 - 0.3e1 * t1008 + t7 * (t1950 + t1548 - t1535 - t1540 + 0.7e1 / 0.2e1 * t2290 + t1168 - t1544 - 0.12e2 * t2338 - t2510 - t2478 - t2480 + t2502 + t1211 + t1213 - t2476 + t1262 + t1157 + t1159 - t1718 + t1670 - t1170 - 0.12e2 * t2340 + t1624 - t2507 - t2508 + t2509 - 0.3e1 / 0.2e1 * t2288 + t1257 - t1260 + t1630 + 0.9e1 / 0.4e1 * t2285 - 0.3e1 / 0.2e1 * t2275 + t1701 + t1209 + t2515 - t2490 + t2491 + t2455 - t2485 + t1715 - t1618 + t1665 - t1668 + t2522) + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011;
  tv3rho33 = t2411 + t2527;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2528 = t1087 * t716;
  t2529 = t1086 * t2528;
  t2530 = t2529 / 0.2e1;
  t2531 = t437 * t371;
  t2532 = t2531 * t1088;
  t2533 = t437 * t890;
  t2534 = t1079 * t386;
  t2535 = 0.14e2 / 0.3e1 * t2534;
  t2536 = t1003 * t697;
  t2537 = t1086 * t2536;
  t2538 = 0.3e1 / 0.4e1 * t2537;
  t2539 = t1083 * t399;
  t2541 = t113 * t690 * t152;
  t2542 = t2541 * t167;
  t2543 = t1083 * t386;
  t2544 = 0.2e1 * t2543;
  t2545 = t1079 * t143;
  t2546 = t2545 * t1088;
  t2547 = 0.7e1 / 0.3e1 * t2546;
  t2549 = t342 * t379 * t152;
  t2550 = t2549 * t167;
  t2551 = 0.14e2 / 0.3e1 * t2550;
  t2553 = t113 * t775 * t152;
  t2554 = t2553 * t167;
  t2555 = t780 * t152;
  t2556 = t2555 * t167;
  t2557 = 0.7e2 / 0.9e1 * t2556;
  t2558 = t1101 * t717;
  t2559 = t1097 * t2558;
  t2560 = t2559 / 0.4e1;
  t2562 = 0.1e1 / t439 / t280;
  t2563 = t145 * t2562;
  t2565 = t2563 * params->ftilde * t445;
  t2566 = 0.63e2 / 0.8e1 * t2565;
  t2567 = t1093 * t116;
  t2568 = t2567 * t1102;
  t2569 = 0.7e1 / 0.4e1 * t2568;
  t2570 = t2567 * t1098;
  t2571 = 0.7e1 / 0.2e1 * t2570;
  t2572 = t1958 * t382;
  t2573 = t1097 * t2572;
  t2574 = t2573 / 0.2e1;
  t2575 = t882 * t1088;
  t2576 = t1097 * t2575;
  t2577 = t2576 / 0.2e1;
  t2578 = t1953 * t382;
  t2579 = t1097 * t2578;
  t2580 = t2579 / 0.2e1;
  t2581 = t152 * t695;
  t2582 = t2581 * t698;
  t2583 = t1097 * t2582;
  t2584 = 0.3e1 / 0.8e1 * t2583;
  t2585 = -t2530 - t2532 + t2533 - t2535 + t2538 - t2539 + t2542 + t2544 + t2547 - t2551 + t2554 + t2557 + t2560 - t2566 - t2569 + t2571 - t2574 + t2577 - t2580 - t2584;
  tv3rho2sigma0 = t2585 * t7 - t1089 - t1099 - t1107 + t1108 + t1109 + t1110 + t1111;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2587 = 0.28e2 / 0.3e1 * t1080;
  t2588 = 0.4e1 * t1084;
  t2589 = 0.4e1 * t1085;
  t2591 = 0.7e1 * t1095;
  t2592 = 0.2e1 * t1099;
  t2593 = 0.2e1 * t2532;
  t2594 = 0.2e1 * t2533;
  t2595 = 0.28e2 / 0.3e1 * t2534;
  t2596 = 0.3e1 / 0.2e1 * t2537;
  t2597 = 0.2e1 * t2539;
  t2598 = 0.2e1 * t2542;
  t2599 = 0.4e1 * t2543;
  t2600 = 0.14e2 / 0.3e1 * t2546;
  t2601 = 0.28e2 / 0.3e1 * t2550;
  t2602 = 0.2e1 * t2554;
  t2603 = 0.14e3 / 0.9e1 * t2556;
  t2604 = t2559 / 0.2e1;
  t2605 = 0.63e2 / 0.4e1 * t2565;
  t2606 = 0.7e1 / 0.2e1 * t2568;
  t2607 = 0.7e1 * t2570;
  t2608 = 0.3e1 / 0.4e1 * t2583;
  t2609 = -t2529 - t2593 + t2594 - t2595 + t2596 - t2597 + t2598 + t2599 + t2600 - t2601 + t2602 + t2603 + t2604 - t2605 - t2606 + t2607 - t2573 + t2576 - t2579 - t2608;
  tv3rho2sigma1 = t2609 * t7 - 0.2e1 * t1089 + t1103 - t2587 + t2588 + t2589 + t2591 - t2592;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = tv3rho2sigma0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2611 = t1086 * t1005;
  t2613 = t1083 * t432;
  t2616 = t2567 * t1117;
  t2618 = t1101 * t947;
  t2619 = t1097 * t2618;
  t2622 = 0.3e1 / 0.4e1 * t2611 - t2613 / 0.2e1 - t2539 / 0.2e1 - t2566 - 0.7e1 / 0.8e1 * t2616 + t2619 / 0.4e1 - 0.7e1 / 0.8e1 * t2568 + t2571 - t2574 - t2580 - t2551 + t2554;
  t2623 = t2581 * t2210;
  t2624 = t1097 * t2623;
  t2626 = t882 * t1114;
  t2627 = t1097 * t2626;
  t2631 = t2545 * t1114;
  t2633 = t2531 * t1114;
  t2635 = t1087 * t946;
  t2636 = t1086 * t2635;
  t2639 = -0.3e1 / 0.8e1 * t2624 + t2627 / 0.4e1 + t2576 / 0.4e1 + t2542 - t2532 / 0.2e1 + t2557 + t2533 - t2535 + 0.7e1 / 0.6e1 * t2631 - t2633 / 0.2e1 - t2636 / 0.2e1 + t2544 + 0.7e1 / 0.6e1 * t2546;
  tv3rho2sigma3 = -t1107 + t1108 + t1109 - t1090 + t1110 - t1099 + t1104 - t1116 + t1119 + t7 * (t2622 + t2639);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2642 = 0.3e1 / 0.2e1 * t2611;
  t2643 = 0.7e1 / 0.4e1 * t2616;
  t2644 = t2619 / 0.2e1;
  t2645 = t2642 - t2613 - t2539 - t2605 - t2643 + t2644 - t2569 + t2607 - t2573 - t2579 - t2601 + t2602;
  t2646 = 0.3e1 / 0.4e1 * t2624;
  t2647 = t2627 / 0.2e1;
  t2648 = 0.7e1 / 0.3e1 * t2631;
  t2649 = -t2646 + t2647 + t2577 + t2598 - t2532 + t2603 + t2594 - t2595 + t2648 - t2633 - t2636 + t2599 + t2547;
  tv3rho2sigma4 = -t2587 + t2588 + t2589 - t1089 + t2591 - t2592 + t1111 - t1115 + t1122 + t7 * (t2645 + t2649);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = tv3rho2sigma3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2652 = t1087 * t1032;
  t2653 = t1086 * t2652;
  t2654 = t2653 / 0.2e1;
  t2655 = t1003 * t1068;
  t2656 = t1086 * t2655;
  t2657 = 0.3e1 / 0.4e1 * t2656;
  t2658 = t1101 * t1033;
  t2659 = t1097 * t2658;
  t2660 = t2659 / 0.4e1;
  t2661 = t2581 * t1069;
  t2662 = t1097 * t2661;
  t2663 = 0.3e1 / 0.8e1 * t2662;
  t2664 = -t2654 + t2657 - t2633 + t2648 - t2613 + t2533 - t2535 + t2542 + t2544 - t2551 + t2554 + t2557 + t2660 - t2566 + t2571 - t2574 - t2663 - t2643 + t2647 - t2580;
  tv3rho2sigma6 = t2664 * t7 - t1099 - t1107 + t1108 + t1109 + t1110 - t1115 + t1122;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t2667 = 0.3e1 / 0.2e1 * t2656;
  t2668 = 0.2e1 * t2633;
  t2669 = 0.14e2 / 0.3e1 * t2631;
  t2670 = 0.2e1 * t2613;
  t2671 = t2659 / 0.2e1;
  t2672 = 0.3e1 / 0.4e1 * t2662;
  t2673 = 0.7e1 / 0.2e1 * t2616;
  t2674 = -t2653 + t2667 - t2668 + t2669 - t2670 + t2594 - t2595 + t2598 + t2599 - t2601 + t2602 + t2603 + t2671 - t2605 + t2607 - t2573 - t2672 - t2673 + t2627 - t2579;
  tv3rho2sigma7 = t2674 * t7 - 0.2e1 * t1115 + t1118 - t2587 + t2588 + t2589 + t2591 - t2592;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  tv3rho2sigma8 = tv3rho2sigma6;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2676 = t1092 * params->ftilde;
  t2677 = t2676 * t115;
  t2678 = t2677 * t1129;
  t2679 = 0.21e2 / 0.8e1 * t2678;
  t2680 = t115 * t1127;
  t2681 = t1125 * t2680;
  t2682 = t2681 * t1098;
  t2683 = 0.3e1 / 0.4e1 * t2682;
  t2684 = t2681 * t1102;
  t2685 = 0.3e1 / 0.8e1 * t2684;
  t2688 = 0.1e1 / t126 / t280 * t1134;
  t2690 = t2688 * t1136 * t1139;
  t2691 = 0.7e1 / 0.6e1 * t2690;
  t2692 = t1136 * t348;
  t2693 = t1135 * t2692;
  t2694 = t2693 * t725;
  t2695 = t2694 / 0.4e1;
  t2696 = t1136 * t144;
  t2697 = t1135 * t2696;
  t2698 = t2697 * t1098;
  t2699 = t2698 / 0.4e1;
  t2700 = t2697 * t1102;
  t2701 = t2700 / 0.8e1;
  tv3rhosigma20 = -t1131 + t1141 + t7 * (t2679 - t2683 + t2685 - t2691 - t2695 + t2699 - t2701);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t2704 = 0.21e2 / 0.4e1 * t2678;
  t2705 = 0.3e1 / 0.2e1 * t2682;
  t2706 = 0.3e1 / 0.4e1 * t2684;
  t2707 = 0.7e1 / 0.3e1 * t2690;
  t2708 = t2694 / 0.2e1;
  t2709 = t2698 / 0.2e1;
  t2710 = t2700 / 0.4e1;
  tv3rhosigma21 = -t1143 + t1144 + t7 * (t2704 - t2705 + t2706 - t2707 - t2708 + t2709 - t2710);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = tv3rhosigma20;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  t2713 = 0.21e2 / 0.2e1 * t2678;
  t2714 = 0.3e1 * t2682;
  t2715 = 0.3e1 / 0.2e1 * t2684;
  t2716 = 0.14e2 / 0.3e1 * t2690;
  t2717 = t2700 / 0.2e1;
  tv3rhosigma23 = -t1146 + t1140 + t7 * (t2713 - t2714 + t2715 - t2716 - t2694 + t2698 - t2717);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = tv3rhosigma21;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = tv3rhosigma22;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2720 = t2681 * t1117;
  t2721 = 0.3e1 / 0.8e1 * t2720;
  t2722 = t2697 * t1117;
  t2723 = t2722 / 0.8e1;
  tv3rhosigma26 = -t1131 + t1141 + t7 * (t2679 - t2683 + t2721 - t2691 - t2695 + t2699 - t2723);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  t2726 = 0.3e1 / 0.4e1 * t2720;
  t2727 = t2722 / 0.4e1;
  tv3rhosigma27 = -t1143 + t1144 + t7 * (t2704 - t2705 + t2726 - t2707 - t2708 + t2709 - t2727);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = tv3rhosigma26;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  t2730 = 0.3e1 / 0.2e1 * t2720;
  t2731 = t2722 / 0.2e1;
  tv3rhosigma29 = -t1146 + t1140 + t7 * (t2713 - t2714 + t2730 - t2716 - t2694 + t2698 - t2731);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = tv3rhosigma27;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = tv3rhosigma28;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2735 = 0.1e1 / t145 / t111;
  t2737 = t2735 * t152 * t382;
  t2738 = t1126 * t2737;
  t2739 = 0.3e1 / 0.8e1 * t2738;
  t2740 = 0.1e1 / t111;
  t2741 = t1136 * t2740;
  t2742 = t1135 * t2741;
  t2743 = t2742 * t1139;
  t2744 = 0.3e1 / 0.8e1 * t2743;
  t2745 = t147 * t147;
  t2746 = t2745 * t2745;
  t2747 = t2746 * t147;
  t2750 = t1134 * params->ftilde;
  t2751 = 0.1e1 / t2747 / t280 * t2750;
  t2752 = t1136 * t115;
  t2753 = t2752 * t348;
  t2754 = t2751 * t2753;
  t2755 = t2754 * t1129;
  t2756 = t2755 / 0.8e1;
  tv3sigma30 = t7 * (t2739 + t2744 - t2756);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t2758 = 0.3e1 / 0.4e1 * t2738;
  t2759 = 0.3e1 / 0.4e1 * t2743;
  t2760 = t2755 / 0.4e1;
  tv3sigma31 = t7 * (t2758 + t2759 - t2760);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = tv3sigma30;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  t2762 = 0.3e1 / 0.2e1 * t2738;
  t2763 = 0.3e1 / 0.2e1 * t2743;
  t2764 = t2755 / 0.2e1;
  tv3sigma33 = t7 * (t2762 + t2763 - t2764);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = tv3sigma31;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = tv3sigma32;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  t2766 = 0.3e1 * t2738;
  t2767 = 0.3e1 * t2743;
  tv3sigma36 = t7 * (t2766 + t2767 - t2755);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = tv3sigma33;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = tv3sigma34;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = tv3sigma35;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t15, t16, t20;
  double t21, t22, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t36, t37, t41, t42, t45;
  double t47, t48, t50, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t66, t67, t68, t69, t70, t71, t72, t74;
  double t75, t76, t77, t78, t79, t83, t84, t86;
  double t88, t89, t93, t95, t98, t100, t101, t103;
  double t105, t106, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t119, t122, t123, t124;
  double t125, t126, t127, t128, t131, t132, t135, t140;
  double t141, t143, t144, t145, t146, t147, t149, t152;
  double t153, t154, t155, t156, t157, t158, t159, t160;
  double t161, t162, t163, t164, t165, t166, t167, t168;
  double tzk0;

  double t170, t171, t175, t176, t177, t178, t179, t180;
  double t181, t182, t183, t184, t186, t192, t193, t194;
  double t195, t196, t197, t198, t199, t201, t203, t204;
  double t207, t208, t209, t210, t213, t215, t216, t217;
  double t218, t219, t223, t224, t225, t227, t233, t234;
  double t237, t238, t240, t242, t243, t248, t249, t252;
  double t254, t255, t256, t260, t261, t262, t263, t264;
  double t265, t266, t269, t270, t273, t274, t275, t276;
  double t277, t278, t279, t280, t281, t282, t286, t287;
  double t288, t292, t293, t294, t296, t302, t303, t306;
  double t307, t309, t311, t312, t317, t318, t321, t323;
  double t324, t325, t328, t329, t330, t331, t332, t333;
  double t334, t335, t336, t337, t338, t339, t340, t342;
  double t343, t344, t345, t346, t347, t348, t349, t350;
  double t354, t355, t358, t360, t361, t362, t369, t371;
  double t375, t379, t380, t381, t382, t383, t384, t386;
  double t387, t389, t390, t393, t396, t397, t398, t399;
  double t400, t401, t402, tvrho0, t404, t407, t408, t411;
  double t412, t413, t414, t415, t419, t420, t421, t422;
  double t423, t426, t429, t430, t431, t432, t433, t434;
  double t435, tvrho1, t437, t438, t439, t441, t442, t445;
  double t446, t447, tvsigma0, t449, tvsigma1, tvsigma2;

  double t451, t452, t453, t454, t455, t456, t457, t458;
  double t459, t460, t461, t462, t463, t464, t465, t466;
  double t467, t468, t470, t472, t477, t478, t479, t483;
  double t484, t486, t487, t489, t490, t491, t493, t494;
  double t496, t502, t505, t506, t509, t512, t514, t515;
  double t520, t529, t531, t532, t533, t534, t535, t540;
  double t541, t542, t546, t547, t548, t549, t554, t558;
  double t559, t563, t564, t565, t566, t572, t574, t579;
  double t580, t581, t587, t593, t594, t595, t596, t597;
  double t598, t599, t600, t601, t602, t603, t604, t605;
  double t607, t608, t610, t613, t614, t617, t618, t619;
  double t621, t622, t623, t624, t625, t627, t628, t630;
  double t631, t632, t636, t641, t645, t646, t647, t648;
  double t650, t651, t652, t653, t654, t655, t656, t657;
  double t658, t659, t660, t661, t662, t663, t664, t665;
  double t666, t667, t670, t671, t673, t677, t678, t679;
  double t682, t686, t687, t688, t689, t690, t691, t692;
  double t693, t695, t696, t697, t698, t699, t700, t701;
  double t702, t708, t709, t715, t716, t717, t718, t719;
  double t720, t721, t722, t723, t724, t725, t726, t727;
  double t728, t729, t730, t731, t732, t734, t735, t736;
  double t740, t748, t750, t754, t755, t756, t765, t767;
  double t771, t775, t776, t777, t778, t780, t781, t782;
  double t783, t784, t786, t788, t793, t794, t795, t801;
  double t807, t810, t813, t816, t817, t818, t819, t824;
  double t833, t835, t836, t837, t838, t839, t844, t845;
  double t846, t850, t855, t859, t860, t864, t865, t866;
  double t867, t873, t874, t875, t876, t877, t878, t879;
  double t880, t881, t882, t883, t884, t885, t886, t887;
  double t888, t890, t891, t892, t893, t895, t897, t899;
  double t902, t903, t904, t905, t906, t907, t908, t909;
  double t910, t913, t915, t916, t917, t920, t921, t922;
  double tv2rho20, t925, t927, t928, t930, t933, t937, t938;
  double t941, t945, t946, t947, t948, t949, t951, t954;
  double t956, t958, t961, t965, t966, t969, t973, t974;
  double t975, t976, t977, t978, t979, t981, t985, t986;
  double t988, t989, t991, t993, t995, t996, t1000, t1002;
  double t1003, t1004, t1005, t1006, t1008, t1010, tv2rho21, t1014;
  double t1015, t1019, t1023, t1024, t1027, t1031, t1032, t1033;
  double t1034, t1035, t1036, t1042, t1048, t1049, t1050, t1051;
  double t1054, t1055, t1056, t1057, t1058, t1059, t1060, t1061;
  double t1062, t1063, t1064, t1065, t1066, t1067, t1068, t1069;
  double t1070, t1071, t1072, t1073, tv2rho22, t1079, t1080, t1081;
  double t1082, t1083, t1084, t1085, t1086, t1087, t1088, t1089;
  double t1090, t1092, t1093, t1095, t1096, t1097, t1098, t1099;
  double t1100, t1101, t1102, t1103, t1104, tv2rhosigma0, t1107, t1108;
  double t1109, t1110, t1111, tv2rhosigma1, tv2rhosigma2, t1114, t1115, t1116;
  double t1117, t1118, t1119, tv2rhosigma3, t1122, tv2rhosigma4, tv2rhosigma5, t1125;
  double t1126, t1127, t1128, t1129, t1130, t1131, t1133, t1134;
  double t1135, t1136, t1138, t1139, t1140, t1141, tv2sigma20, t1143;
  double t1144, tv2sigma21, tv2sigma22, t1146, tv2sigma23, tv2sigma24, tv2sigma25;

  double t1148, t1149, t1153, t1154, t1156, t1157, t1158, t1159;
  double t1163, t1164, t1165, t1167, t1168, t1169, t1170, t1171;
  double t1175, t1176, t1179, t1181, t1184, t1189, t1190, t1191;
  double t1192, t1195, t1204, t1206, t1208, t1209, t1210, t1211;
  double t1212, t1213, t1214, t1216, t1218, t1220, t1222, t1229;
  double t1230, t1231, t1232, t1236, t1240, t1241, t1242, t1243;
  double t1245, t1247, t1249, t1255, t1256, t1257, t1259, t1260;
  double t1261, t1262, t1264, t1265, t1266, t1267, t1268, t1269;
  double t1270, t1271, t1272, t1273, t1274, t1275, t1276, t1277;
  double t1278, t1279, t1280, t1281, t1282, t1283, t1284, t1285;
  double t1286, t1287, t1288, t1289, t1290, t1292, t1293, t1294;
  double t1295, t1296, t1297, t1298, t1299, t1301, t1303, t1306;
  double t1307, t1308, t1309, t1311, t1312, t1314, t1315, t1316;
  double t1317, t1318, t1321, t1325, t1329, t1330, t1331, t1334;
  double t1337, t1341, t1342, t1343, t1344, t1345, t1346, t1347;
  double t1348, t1350, t1351, t1352, t1356, t1359, t1362, t1365;
  double t1371, t1373, t1375, t1377, t1384, t1385, t1386, t1387;
  double t1391, t1398, t1404, t1407, t1408, t1409, t1410, t1411;
  double t1413, t1414, t1418, t1419, t1420, t1421, t1427, t1428;
  double t1429, t1430, t1435, t1436, t1437, t1438, t1442, t1443;
  double t1444, t1450, t1453, t1454, t1457, t1458, t1461, t1462;
  double t1477, t1478, t1482, t1496, t1497, t1503, t1508, t1514;
  double t1515, t1522, t1524, t1525, t1526, t1527, t1529, t1530;
  double t1531, t1532, t1533, t1534, t1535, t1536, t1537, t1539;
  double t1540, t1543, t1544, t1547, t1548, t1549, t1550, t1551;
  double t1552, t1553, t1554, t1555, t1556, t1557, t1558, t1559;
  double t1560, t1561, t1562, t1563, t1564, t1565, t1567, t1569;
  double t1572, t1573, t1574, t1575, t1576, t1577, t1578, t1579;
  double t1581, t1582, t1583, t1584, t1585, t1586, t1587, t1588;
  double t1589, t1590, t1591, t1592, t1593, t1594, t1595, t1596;
  double t1597, t1599, t1600, t1602, t1603, t1604, t1605, t1606;
  double t1607, t1609, t1610, t1612, t1613, t1614, t1615, t1617;
  double t1618, t1620, t1621, t1623, t1624, t1625, t1626, t1627;
  double t1629, t1630, t1631, t1632, t1633, t1635, t1637, t1638;
  double t1645, t1649, t1659, t1663, t1664, t1665, t1666, t1667;
  double t1668, t1669, t1670, t1671, t1674, t1680, t1681, t1684;
  double t1690, t1691, t1692, t1693, t1694, t1695, t1696, t1697;
  double t1699, t1700, t1701, t1702, t1706, t1707, t1708, t1709;
  double t1710, t1711, t1712, t1713, t1714, t1715, t1716, t1717;
  double t1718, t1719, t1722, t1724, t1726, t1728, t1735, t1736;
  double t1737, t1738, t1742, t1749, t1755, t1763, t1766, t1767;
  double t1772, t1775, t1780, t1789, t1790, t1791, t1792, t1794;
  double t1795, t1799, t1800, t1801, t1802, t1805, t1806, t1807;
  double t1808, t1812, t1815, t1816, t1817, t1818, t1822, t1823;
  double t1827, t1828, t1829, t1830, t1833, t1834, t1838, t1860;
  double t1866, t1867, t1868, t1869, t1870, t1871, t1872, t1873;
  double t1874, t1875, t1876, t1877, t1878, t1879, t1880, t1881;
  double t1882, t1883, t1884, t1887, t1888, t1891, t1892, t1895;
  double t1896, t1899, t1909, t1910, t1914, t1936, t1942, t1943;
  double t1946, t1948, t1949, t1950, t1951, t1953, t1954, t1955;
  double t1956, t1958, t1959, t1960, t1961, t1962, t1963, t1964;
  double t1965, t1967, t1968, t1969, t1970, t1972, t1973, t1974;
  double t1975, t1976, t1977, t1978, t1979, t1984, t1985, t1989;
  double t1991, t1992, t1993, t1994, t1995, t1996, t1997, t2000;
  double t2001, t2003, t2004, t2005, t2006, t2007, t2008, t2009;
  double t2010, t2011, t2015, tv3rho30, t2018, t2021, t2022, t2023;
  double t2025, t2026, t2027, t2030, t2031, t2032, t2033, t2036;
  double t2037, t2038, t2039, t2041, t2042, t2043, t2044, t2045;
  double t2048, t2049, t2059, t2060, t2063, t2064, t2074, t2075;
  double t2076, t2077, t2078, t2079, t2080, t2081, t2082, t2083;
  double t2084, t2086, t2088, t2090, t2091, t2092, t2094, t2096;
  double t2097, t2098, t2099, t2102, t2103, t2105, t2106, t2107;
  double t2112, t2114, t2116, t2117, t2119, t2120, t2122, t2123;
  double t2124, t2127, t2137, t2138, t2141, t2151, t2152, t2153;
  double t2154, t2155, t2157, t2158, t2159, t2161, t2163, t2164;
  double t2165, t2167, t2169, t2170, t2173, t2174, t2176, t2177;
  double t2180, t2181, t2182, t2183, t2184, t2185, t2186, t2187;
  double t2189, t2190, t2191, t2193, t2198, t2200, t2204, t2210;
  double t2211, t2212, t2213, t2214, t2219, t2220, t2222, t2224;
  double t2226, t2232, t2233, t2234, tv3rho31, t2236, t2241, t2246;
  double t2250, t2251, t2256, t2259, t2263, t2264, t2265, t2266;
  double t2267, t2268, t2270, t2272, t2273, t2275, t2278, t2279;
  double t2282, t2283, t2285, t2287, t2288, t2290, t2292, t2296;
  double t2297, t2299, t2301, t2306, t2312, t2313, t2318, t2324;
  double t2325, t2326, t2327, t2328, t2332, t2334, t2338, t2340;
  double t2342, t2351, t2353, t2355, t2357, t2359, t2363, t2364;
  double t2366, t2367, t2369, t2371, t2372, t2374, t2376, t2379;
  double t2385, t2392, t2394, t2399, t2401, tv3rho32, t2411, t2419;
  double t2420, t2421, t2422, t2423, t2424, t2430, t2434, t2435;
  double t2440, t2444, t2445, t2446, t2447, t2448, t2449, t2450;
  double t2451, t2452, t2453, t2455, t2464, t2472, t2473, t2474;
  double t2475, t2476, t2477, t2478, t2479, t2480, t2483, t2484;
  double t2485, t2490, t2491, t2495, t2496, t2497, t2498, t2499;
  double t2500, t2501, t2502, t2507, t2508, t2509, t2510, t2515;
  double t2518, t2519, t2520, t2521, t2522, t2527, tv3rho33, t2528;
  double t2529, t2530, t2531, t2532, t2533, t2534, t2535, t2536;
  double t2537, t2538, t2539, t2541, t2542, t2543, t2544, t2545;
  double t2546, t2547, t2549, t2550, t2551, t2553, t2554, t2555;
  double t2556, t2557, t2558, t2559, t2560, t2562, t2563, t2565;
  double t2566, t2567, t2568, t2569, t2570, t2571, t2572, t2573;
  double t2574, t2575, t2576, t2577, t2578, t2579, t2580, t2581;
  double t2582, t2583, t2584, t2585, tv3rho2sigma0, t2587, t2588, t2589;
  double t2591, t2592, t2593, t2594, t2595, t2596, t2597, t2598;
  double t2599, t2600, t2601, t2602, t2603, t2604, t2605, t2606;
  double t2607, t2608, t2609, tv3rho2sigma1, tv3rho2sigma2, t2611, t2613, t2616;
  double t2618, t2619, t2622, t2623, t2624, t2626, t2627, t2631;
  double t2633, t2635, t2636, t2639, tv3rho2sigma3, t2642, t2643, t2644;
  double t2645, t2646, t2647, t2648, t2649, tv3rho2sigma4, tv3rho2sigma5, t2652;
  double t2653, t2654, t2655, t2656, t2657, t2658, t2659, t2660;
  double t2661, t2662, t2663, t2664, tv3rho2sigma6, t2667, t2668, t2669;
  double t2670, t2671, t2672, t2673, t2674, tv3rho2sigma7, tv3rho2sigma8, t2676;
  double t2677, t2678, t2679, t2680, t2681, t2682, t2683, t2684;
  double t2685, t2688, t2690, t2691, t2692, t2693, t2694, t2695;
  double t2696, t2697, t2698, t2699, t2700, t2701, tv3rhosigma20, t2704;
  double t2705, t2706, t2707, t2708, t2709, t2710, tv3rhosigma21, tv3rhosigma22;
  double t2713, t2714, t2715, t2716, t2717, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25;
  double t2720, t2721, t2722, t2723, tv3rhosigma26, t2726, t2727, tv3rhosigma27;
  double tv3rhosigma28, t2730, t2731, tv3rhosigma29, tv3rhosigma210, tv3rhosigma211, t2735, t2737;
  double t2738, t2739, t2740, t2741, t2742, t2743, t2744, t2745;
  double t2746, t2747, t2750, t2751, t2752, t2753, t2754, t2755;
  double t2756, tv3sigma30, t2758, t2759, t2760, tv3sigma31, tv3sigma32, t2762;
  double t2763, t2764, tv3sigma33, tv3sigma34, tv3sigma35, t2766, t2767, tv3sigma36;
  double tv3sigma37, tv3sigma38, tv3sigma39;

  double t2769, t2770, t2771, t2772, t2773, t2774, t2775, t2776;
  double t2777, t2778, t2780, t2782, t2783, t2784, t2785, t2786;
  double t2787, t2791, t2798, t2799, t2800, t2803, t2806, t2807;
  double t2811, t2814, t2816, t2818, t2821, t2822, t2826, t2827;
  double t2829, t2831, t2833, t2834, t2836, t2837, t2839, t2842;
  double t2844, t2847, t2858, t2864, t2868, t2871, t2873, t2876;
  double t2877, t2888, t2926, t2930, t2936, t2938, t2940, t2944;
  double t2946, t2949, t2957, t2959, t2962, t2969, t2980, t2984;
  double t2987, t2989, t3038, t3044, t3048, t3052, t3053, t3056;
  double t3115, t3122, t3125, t3129, t3133, t3141, t3149, t3153;
  double t3156, t3158, t3161, t3164, t3166, t3169, t3171, t3173;
  double t3174, t3176, t3179, t3210, t3214, t3216, t3220, t3224;
  double t3228, t3230, t3234, t3237, t3240, t3244, t3247, t3253;
  double t3257, t3260, t3266, t3267, t3271, t3273, t3274, t3276;
  double t3278, t3281, t3286, t3291, t3311, t3314, t3316, t3319;
  double t3325, t3329, t3371, t3375, t3377, t3379, t3381, t3385;
  double t3388, t3392, t3394, t3410, t3420, t3425, t3437, t3450;
  double t3457, t3461, t3464, t3470, t3474, t3475, t3480, t3481;
  double t3485, t3489, t3490, t3491, t3492, t3493, t3494, t3495;
  double t3496, t3497, t3499, t3505, t3507, t3509, t3510, t3516;
  double t3522, t3526, t3527, t3529, t3530, t3536, t3541, t3545;
  double t3546, t3550, t3552, t3554, t3556, t3558, t3560, t3561;
  double t3562, t3564, t3567, t3568, t3572, t3574, t3575, t3576;
  double t3578, t3582, t3583, t3585, t3586, t3590, t3592, t3597;
  double t3599, t3601, t3603, t3604, t3605, t3612, t3613, t3616;
  double t3617, t3621, t3625, t3642, t3684, t3690, t3704, t3712;
  double t3714, t3715, t3716, t3717, t3719, t3723, t3725, t3727;
  double t3731, t3735, t3736, t3738, t3740, t3742, t3744, t3746;
  double t3749, t3750, t3751, t3756, t3757, t3758, t3762, t3763;
  double t3766, t3771, t3773, t3775, t3778, t3780, t3781, t3783;
  double t3785, t3791, t3792, t3794, t3796, t3798, t3800, t3805;
  double t3806, t3808, t3810, t3811, t3814, t3816, t3821, t3828;
  double t3831, t3832, t3834, t3838, t3840, t3843, t3845, t3858;
  double t3860, t3873, t3880, t3883, t3886, t3888, t3890, t3893;
  double t3894, t3896, t3898, t3899, t3901, t3902, t3903, t3906;
  double t3907, t3909, t3910, t3911, t3912, t3914, t3915, t3917;
  double t3920, t3922, t3925, t3926, t3930, t3937, t3966, t3990;
  double t3993, t3995, t4035, t4042, t4053, t4089, t4099, t4101;
  double t4104, t4111, t4122, t4126, t4129, t4131, t4134, t4139;
  double t4175, t4211, t4231, t4255, t4261, t4262, t4265, t4266;
  double t4268, t4270, t4272, t4274, t4276, t4278, t4280, t4282;
  double t4283, t4285, t4286, t4287, t4289, t4291, t4293, t4294;
  double t4295, t4297, t4299, t4305, t4308, t4309, t4310, t4312;
  double t4314, t4318, t4322, t4323, t4325, t4328, t4329, t4330;
  double t4332, t4333, t4335, t4338, t4339, t4340, t4343, t4345;
  double t4347, t4348, t4350, t4351, t4352, t4353, t4356, t4358;
  double t4363, t4364, t4365, t4366, t4368, tv4rho40, t4371, t4374;
  double t4376, t4377, t4382, t4384, t4389, t4391, t4397, t4398;
  double t4399, t4402, t4403, t4404, t4406, t4407, t4409, t4410;
  double t4411, t4413, t4414, t4415, t4421, t4424, t4430, t4433;
  double t4441, t4443, t4448, t4451, t4457, t4460, t4468, t4470;
  double t4477, t4480, t4481, t4483, t4485, t4487, t4489, t4491;
  double t4493, t4494, t4496, t4497, t4498, t4500, t4503, t4504;
  double t4505, t4507, t4509, t4511, t4513, t4514, t4515, t4525;
  double t4526, t4528, t4529, t4532, t4534, t4535, t4557, t4559;
  double t4580, t4582, t4583, t4593, t4595, t4599, t4606, t4607;
  double t4608, t4614, t4622, t4624, t4627, t4629, t4633, t4636;
  double t4637, t4646, t4652, t4653, t4660, t4666, t4670, t4671;
  double t4673, t4674, t4675, t4676, t4678, t4679, t4681, t4682;
  double t4692, t4694, t4695, t4700, t4702, t4704, t4705, t4706;
  double t4710, t4713, t4714, t4715, t4717, t4719, t4721, t4723;
  double t4724, t4725, t4727, t4728, t4729, t4730, t4731, t4733;
  double t4743, t4746, t4748, t4749, t4750, t4751, t4753, t4754;
  double t4755, t4756, t4757, t4758, t4759, t4760, t4761, t4762;
  double t4764, t4765, t4766, t4767, t4772, t4775, t4776, t4778;
  double t4779, t4780, t4782, t4788, t4789, t4792, t4793, t4794;
  double t4796, t4799, t4801, t4804, t4806, t4810, t4811, t4813;
  double t4814, t4817, t4818, t4821, t4822, t4828, t4829, t4836;
  double t4840, t4841, t4849, tv4rho41, t4857, t4870, t4872, t4874;
  double t4875, t4885, t4906, t4911, t4932, t4933, t4939, t4944;
  double t4950, t4954, t4956, t4966, t4970, t4972, t4973, t4977;
  double t4983, t4991, t4993, t5007, t5013, t5017, t5042, t5066;
  double t5073, t5075, t5085, t5091, t5092, t5094, t5096, t5098;
  double t5100, t5101, t5103, t5106, t5108, t5118, t5120, t5122;
  double t5133, t5135, t5137, t5143, t5145, t5147, t5149, t5159;
  double t5162, t5171, t5173, t5175, t5177, t5181, t5186, t5191;
  double t5193, t5195, t5197, t5199, t5200, t5202, t5205, t5211;
  double t5226, t5234, t5242, t5256, t5274, t5291, t5304, t5319;
  double t5333, t5340, t5349, tv4rho42, t5354, t5360, t5371, t5378;
  double t5391, t5400, t5403, t5413, t5417, t5423, t5426, t5434;
  double t5438, t5439, t5445, t5447, t5460, t5467, t5484, t5505;
  double t5523, t5530, t5532, t5535, t5547, t5557, t5564, t5566;
  double t5567, t5570, t5574, t5576, t5579, t5581, t5583, t5586;
  double t5593, t5598, t5600, t5606, t5608, t5610, t5612, t5626;
  double t5636, t5640, t5653, t5658, t5666, t5675, t5678, t5681;
  double tv4rho43, t5689, t5711, t5723, t5725, t5731, t5736, t5742;
  double t5746, t5747, t5752, t5757, t5761, t5762, t5785, t5797;
  double t5812, t5817, t5825, t5843, t5854, t5867, t5870, t5882;
  double t5889, t5900, t5904, t5913, t5921, tv4rho44, t5926, t5927;
  double t5930, t5931, t5933, t5935, t5936, t5938, t5940, t5941;
  double t5943, t5945, t5948, t5950, t5951, t5953, t5954, t5956;
  double t5957, t5959, t5961, t5963, t5964, t5965, t5966, t5967;
  double t5969, t5972, t5974, t5977, t5978, t5979, t5980, t5981;
  double t5983, t5984, t5985, t5986, t5988, t5989, t5991, t5993;
  double t5994, t5996, t5997, t5998, t5999, t6002, t6005, t6006;
  double t6007, t6011, t6012, t6013, t6014, t6017, t6018, t6019;
  double t6021, t6023, t6026, t6028, t6031, t6033, t6034, t6036;
  double t6037, t6039, t6042, t6046, t6047, t6049, t6050, t6051;
  double t6053, t6055, t6057, t6059, t6061, t6063, t6069, t6070;
  double t6071, t6072, t6073, t6074, t6075, t6076, t6080, tv4rho3sigma0;
  double t6083, t6084, t6087, t6088, t6090, t6092, t6093, t6095;
  double t6097, t6098, t6100, t6105, t6108, t6109, t6113, t6114;
  double t6115, t6117, t6118, t6121, t6122, t6123, t6124, t6125;
  double t6127, t6134, t6137, t6138, t6139, t6147, t6148, t6149;
  double t6150, t6151, t6155, tv4rho3sigma1, tv4rho3sigma2, t6156, t6158, t6160;
  double t6165, t6167, t6168, t6170, t6171, t6173, t6175, t6177;
  double t6179, t6180, t6181, t6183, t6186, t6188, t6189, t6190;
  double t6193, t6196, t6199, t6200, t6202, t6205, t6206, t6207;
  double t6209, t6212, t6213, t6215, t6217, t6219, t6220, t6221;
  double t6223, t6225, t6227, t6228, t6229, t6230, t6232, t6233;
  double t6234, t6235, t6237, t6240, t6242, t6243, t6245, t6249;
  double tv4rho3sigma3, t6250, t6259, t6260, t6261, t6263, t6264, t6265;
  double t6266, t6267, t6269, t6270, t6272, t6275, t6276, t6287;
  double t6290, t6291, t6293, t6294, t6295, t6297, t6298, t6302;
  double t6303, t6306, t6308, tv4rho3sigma4, tv4rho3sigma5, t6309, t6313, t6315;
  double t6317, t6319, t6324, t6327, t6330, t6332, t6334, t6336;
  double t6341, t6343, t6345, t6347, t6348, t6350, t6353, t6356;
  double t6359, t6362, t6365, t6367, t6371, tv4rho3sigma6, t6375, t6384;
  double t6386, t6394, t6406, t6410, tv4rho3sigma7, tv4rho3sigma8, t6412, t6415;
  double t6418, t6425, t6429, t6432, t6438, t6440, t6450, t6453;
  double t6467, tv4rho3sigma9, t6475, t6479, t6487, t6498, t6512, tv4rho3sigma10;
  double tv4rho3sigma11, t6513, t6515, t6516, t6517, t6518, t6519, t6521;
  double t6522, t6523, t6524, t6525, t6526, t6527, t6528, t6534;
  double t6535, t6537, t6538, t6540, t6541, t6542, t6543, t6544;
  double t6545, t6546, t6547, t6548, t6551, t6552, t6553, t6554;
  double t6555, t6556, t6557, t6563, t6564, t6568, t6569, t6571;
  double t6572, t6573, tv4rho2sigma20, t6577, t6578, t6580, t6581, t6582;
  double t6584, t6585, t6587, t6588, t6589, t6590, t6591, t6592;
  double t6593, t6595, t6596, tv4rho2sigma21, tv4rho2sigma22, t6599, t6600, t6602;
  double t6603, t6604, t6608, t6609, t6611, t6612, t6615, t6616;
  double t6618, t6620, t6621, t6622, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t6625;
  double t6627, t6629, t6633, t6635, t6637, t6639, t6641, t6643;
  double t6646, t6651, tv4rho2sigma26, t6654, t6655, t6657, t6659, t6661;
  double t6663, t6664, tv4rho2sigma27, tv4rho2sigma28, t6667, t6668, t6670, t6672;
  double t6674, t6676, t6677, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211, t6681, t6683;
  double t6685, t6687, t6689, tv4rho2sigma212, t6697, tv4rho2sigma213, tv4rho2sigma214, t6709;
  double tv4rho2sigma215, tv4rho2sigma216, tv4rho2sigma217, t6712, t6713, t6715, t6716, t6717;
  double t6718, t6721, t6722, t6723, t6725, t6726, t6729, t6730;
  double t6732, t6738, t6739, t6743, t6744, t6747, t6748, t6750;
  double t6752, tv4rhosigma30, t6754, t6755, t6757, t6758, t6759, t6761;
  double t6762, t6763, t6765, tv4rhosigma31, tv4rhosigma32, t6767, t6768, t6770;
  double t6771, t6772, t6774, t6775, t6777, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double t6779, t6780, t6782, t6783, t6784, t6786, t6787, t6789;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39, t6791, t6794, t6797, t6799;
  double tv4rhosigma310, t6804, tv4rhosigma311, tv4rhosigma312, t6809, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315;
  double t6814, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, tv4rhosigma319, t6816, t6821, t6826;
  double t6831, t6833, t6835, t6840, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, tv4sigma414;

  gga_c_p86vwn_params *params;

  assert(p->params != NULL);
  params = (gga_c_p86vwn_params * )(p->params);

  t1 = M_CBRT3;
  t2 = 0.1e1 / M_PI;
  t3 = POW_1_3(t2);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = rho[0] + rho[1];
  t8 = POW_1_3(t7);
  t9 = 0.1e1 / t8;
  t10 = t6 * t9;
  t11 = t4 * t10;
  t12 = t11 / 0.4e1;
  t13 = sqrt(t11);
  t15 = t12 + 0.186372e1 * t13 + 0.129352e2;
  t16 = 0.1e1 / t15;
  t20 = log(t4 * t10 * t16 / 0.4e1);
  t21 = 0.310907e-1 * t20;
  t22 = t13 + 0.372744e1;
  t25 = atan(0.61519908197590802322e1 / t22);
  t26 = 0.38783294878113014393e-1 * t25;
  t27 = t13 / 0.2e1;
  t28 = t27 + 0.10498e0;
  t29 = t28 * t28;
  t31 = log(t29 * t16);
  t32 = 0.96902277115443742139e-3 * t31;
  t33 = M_PI * M_PI;
  t34 = 0.1e1 / t33;
  t36 = t12 + 0.565535e0 * t13 + 0.130045e2;
  t37 = 0.1e1 / t36;
  t41 = log(t4 * t10 * t37 / 0.4e1);
  t42 = t13 + 0.113107e1;
  t45 = atan(0.71231089178181179908e1 / t42);
  t47 = t27 + 0.47584e-2;
  t48 = t47 * t47;
  t50 = log(t48 * t37);
  t53 = t34 * (t41 + 0.317708004743941464e0 * t45 + 0.41403379428206274608e-3 * t50);
  t54 = rho[0] - rho[1];
  t55 = 0.1e1 / t7;
  t56 = t54 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t62 = t61 * t57;
  t63 = my_piecewise3(t58, t60, t62);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t67 = t66 * t64;
  t68 = my_piecewise3(t65, t60, t67);
  t69 = t63 + t68 - 0.2e1;
  t70 = t53 * t69;
  t71 = M_CBRT2;
  t72 = t71 - 0.1e1;
  t74 = 0.1e1 / t72 / 0.2e1;
  t75 = t54 * t54;
  t76 = t75 * t75;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = 0.1e1 / t78;
  t83 = 0.9e1 * t72;
  t84 = t74 * (-t76 * t79 + 0.1e1) * t83;
  t86 = t70 * t84 / 0.24e2;
  t88 = t12 + 0.353021e1 * t13 + 0.180578e2;
  t89 = 0.1e1 / t88;
  t93 = log(t4 * t10 * t89 / 0.4e1);
  t95 = t13 + 0.706042e1;
  t98 = atan(0.473092690956011283e1 / t95);
  t100 = t27 + 0.325e0;
  t101 = t100 * t100;
  t103 = log(t101 * t89);
  t105 = 0.1554535e-1 * t93 + 0.52491393169780936218e-1 * t98 + 0.22478670955426118383e-2 * t103 - t21 - t26 - t32;
  t106 = t105 * t69;
  t107 = t74 * t76;
  t108 = t107 * t79;
  t109 = t106 * t108;
  t111 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t113 = 0.1e1 / t8 / t77;
  t114 = t111 * t113;
  t115 = params->aa + params->bb;
  t116 = params->ftilde * t115;
  t117 = params->malpha * t1;
  t118 = t3 * t6;
  t119 = t118 * t9;
  t122 = t1 * t1;
  t123 = params->mbeta * t122;
  t124 = t3 * t3;
  t125 = t124 * t5;
  t126 = t8 * t8;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t131 = params->bb + t117 * t119 / 0.4e1 + t123 * t128 / 0.4e1;
  t132 = params->mgamma * t1;
  t135 = params->mdelta * t122;
  t140 = 0.1e1 + t132 * t119 / 0.4e1 + t135 * t128 / 0.4e1 + 0.23873241463784300365e4 * params->mbeta * t55;
  t141 = 0.1e1 / t140;
  t143 = t131 * t141 + params->aa;
  t144 = 0.1e1 / t143;
  t145 = sqrt(t111);
  t146 = t144 * t145;
  t147 = pow(t7, 0.1e1 / 0.6e1);
  t149 = 0.1e1 / t147 / t7;
  t152 = exp(-t116 * t146 * t149);
  t153 = t114 * t152;
  t154 = t59 * t59;
  t155 = t154 * p->zeta_threshold;
  t156 = t61 * t61;
  t157 = t156 * t57;
  t158 = my_piecewise3(t58, t155, t157);
  t159 = t66 * t66;
  t160 = t159 * t64;
  t161 = my_piecewise3(t65, t155, t160);
  t162 = t158 + t161;
  t163 = sqrt(t162);
  t164 = 0.1e1 / t163;
  t165 = t143 * t164;
  t166 = M_SQRT2;
  t167 = t165 * t166;
  t168 = t153 * t167;
  tzk0 = t21 + t26 + t32 - t86 + t109 + t168;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t170 = 0.1e1 / t8 / t7;
  t171 = t6 * t170;
  t175 = t4 * t6;
  t176 = t15 * t15;
  t177 = 0.1e1 / t176;
  t178 = t9 * t177;
  t179 = t4 * t171;
  t180 = t179 / 0.12e2;
  t181 = 0.1e1 / t13;
  t182 = t181 * t1;
  t183 = t118 * t170;
  t184 = t182 * t183;
  t186 = -t180 - 0.31062e0 * t184;
  t192 = 0.1e1 / t3;
  t193 = (-t4 * t171 * t16 / 0.12e2 - t175 * t178 * t186 / 0.4e1) * t122 * t192;
  t194 = t5 * t8;
  t195 = t194 * t15;
  t196 = t193 * t195;
  t197 = 0.10363566666666666667e-1 * t196;
  t198 = t22 * t22;
  t199 = 0.1e1 / t198;
  t201 = t199 * t181 * t1;
  t203 = 0.378469910464e2 * t199 + 0.1e1;
  t204 = 0.1e1 / t203;
  t207 = t201 * t118 * t170 * t204;
  t208 = 0.39765745675026770179e-1 * t207;
  t209 = t28 * t16;
  t210 = t209 * t181;
  t213 = t29 * t177;
  t215 = -t210 * t179 / 0.6e1 - t213 * t186;
  t216 = 0.1e1 / t29;
  t217 = t215 * t216;
  t218 = t217 * t15;
  t219 = 0.96902277115443742139e-3 * t218;
  t223 = t36 * t36;
  t224 = 0.1e1 / t223;
  t225 = t9 * t224;
  t227 = -t180 - 0.94255833333333333334e-1 * t184;
  t233 = (-t4 * t171 * t37 / 0.12e2 - t175 * t225 * t227 / 0.4e1) * t122 * t192;
  t234 = t194 * t36;
  t237 = t42 * t42;
  t238 = 0.1e1 / t237;
  t240 = t238 * t181 * t1;
  t242 = 0.50738680655100000001e2 * t238 + 0.1e1;
  t243 = 0.1e1 / t242;
  t248 = t47 * t37;
  t249 = t248 * t181;
  t252 = t48 * t224;
  t254 = -t249 * t179 / 0.6e1 - t252 * t227;
  t255 = 0.1e1 / t48;
  t256 = t254 * t255;
  t260 = t34 * (t233 * t234 / 0.3e1 + 0.37717812030896172975e0 * t240 * t118 * t170 * t243 + 0.41403379428206274608e-3 * t256 * t36);
  t261 = t260 * t69;
  t262 = t261 * t84;
  t263 = t262 / 0.24e2;
  t264 = 0.1e1 / t77;
  t265 = t54 * t264;
  t266 = t55 - t265;
  t269 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t266);
  t270 = -t266;
  t273 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t270);
  t274 = t269 + t273;
  t275 = t53 * t274;
  t276 = t275 * t84;
  t277 = t276 / 0.24e2;
  t278 = t75 * t54;
  t279 = t278 * t79;
  t280 = t78 * t7;
  t281 = 0.1e1 / t280;
  t282 = t76 * t281;
  t286 = t74 * (-0.4e1 * t279 + 0.4e1 * t282) * t83;
  t287 = t70 * t286;
  t288 = t287 / 0.24e2;
  t292 = t88 * t88;
  t293 = 0.1e1 / t292;
  t294 = t9 * t293;
  t296 = -t180 - 0.58836833333333333333e0 * t184;
  t302 = (-t4 * t171 * t89 / 0.12e2 - t175 * t294 * t296 / 0.4e1) * t122 * t192;
  t303 = t194 * t88;
  t306 = t95 * t95;
  t307 = 0.1e1 / t306;
  t309 = t307 * t181 * t1;
  t311 = 0.223816694236e2 * t307 + 0.1e1;
  t312 = 0.1e1 / t311;
  t317 = t100 * t89;
  t318 = t317 * t181;
  t321 = t101 * t293;
  t323 = -t318 * t179 / 0.6e1 - t321 * t296;
  t324 = 0.1e1 / t101;
  t325 = t323 * t324;
  t328 = 0.51817833333333333333e-2 * t302 * t303 + 0.41388824077869423261e-1 * t309 * t118 * t170 * t312 + 0.22478670955426118383e-2 * t325 * t88 - t197 - t208 - t219;
  t329 = t328 * t69;
  t330 = t329 * t108;
  t331 = t105 * t274;
  t332 = t331 * t108;
  t333 = t74 * t278;
  t334 = t333 * t79;
  t335 = t106 * t334;
  t336 = 0.4e1 * t335;
  t337 = t107 * t281;
  t338 = t106 * t337;
  t339 = 0.4e1 * t338;
  t340 = t77 * t7;
  t342 = 0.1e1 / t8 / t340;
  t343 = t111 * t342;
  t344 = t343 * t152;
  t345 = t344 * t167;
  t346 = 0.7e1 / 0.3e1 * t345;
  t347 = t143 * t143;
  t348 = 0.1e1 / t347;
  t349 = t116 * t348;
  t350 = t145 * t149;
  t354 = 0.1e1 / t126 / t7;
  t355 = t125 * t354;
  t358 = -t117 * t183 / 0.12e2 - t123 * t355 / 0.6e1;
  t360 = t140 * t140;
  t361 = 0.1e1 / t360;
  t362 = t131 * t361;
  t369 = -t132 * t183 / 0.12e2 - t135 * t355 / 0.6e1 - 0.23873241463784300365e4 * params->mbeta * t264;
  t371 = t141 * t358 - t362 * t369;
  t375 = 0.1e1 / t147 / t77;
  t379 = t349 * t350 * t371 + 0.7e1 / 0.6e1 * t116 * t146 * t375;
  t380 = t114 * t379;
  t381 = t152 * t143;
  t382 = t164 * t166;
  t383 = t381 * t382;
  t384 = t380 * t383;
  t386 = t371 * t164 * t166;
  t387 = t153 * t386;
  t389 = 0.1e1 / t163 / t162;
  t390 = t143 * t389;
  t393 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t266);
  t396 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t270);
  t397 = t393 + t396;
  t398 = t166 * t397;
  t399 = t390 * t398;
  t400 = t153 * t399;
  t401 = t400 / 0.2e1;
  t402 = t197 + t208 + t219 - t263 - t277 - t288 + t330 + t332 + t336 - t339 - t346 + t384 + t387 - t401;
  tvrho0 = t402 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t404 = -t55 - t265;
  t407 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t404);
  t408 = -t404;
  t411 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t408);
  t412 = t407 + t411;
  t413 = t53 * t412;
  t414 = t413 * t84;
  t415 = t414 / 0.24e2;
  t419 = t74 * (0.4e1 * t279 + 0.4e1 * t282) * t83;
  t420 = t70 * t419;
  t421 = t420 / 0.24e2;
  t422 = t105 * t412;
  t423 = t422 * t108;
  t426 = my_piecewise3(t58, 0, 0.5e1 / 0.3e1 * t156 * t404);
  t429 = my_piecewise3(t65, 0, 0.5e1 / 0.3e1 * t159 * t408);
  t430 = t426 + t429;
  t431 = t166 * t430;
  t432 = t390 * t431;
  t433 = t153 * t432;
  t434 = t433 / 0.2e1;
  t435 = t197 + t208 + t219 - t263 - t415 - t421 + t330 + t423 - t336 - t339 - t346 + t384 + t387 - t434;
  tvrho1 = t435 * t7 + t109 + t168 + t21 + t26 + t32 - t86;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t437 = t113 * t152;
  t438 = t437 * t167;
  t439 = sqrt(t7);
  t441 = 0.1e1 / t439 / t340;
  t442 = t145 * t441;
  t445 = t115 * t152 * t382;
  t446 = t442 * params->ftilde * t445;
  t447 = t446 / 0.2e1;
  tvsigma0 = t7 * (t438 - t447);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t449 = 0.2e1 * t438;
  tvsigma1 = t7 * (t449 - t446);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = tvsigma0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t451 = 0.14e2 / 0.3e1 * t345;
  t452 = 0.2e1 * t384;
  t453 = 0.79531491350053540358e-1 * t207;
  t454 = t74 * t75;
  t455 = t454 * t79;
  t456 = t106 * t455;
  t457 = 0.12e2 * t456;
  t458 = t333 * t281;
  t459 = t106 * t458;
  t460 = 0.32e2 * t459;
  t461 = t331 * t334;
  t462 = 0.8e1 * t461;
  t463 = t331 * t337;
  t464 = 0.8e1 * t463;
  t465 = t328 * t274;
  t466 = t465 * t108;
  t467 = 0.2e1 * t466;
  t468 = t6 * t113;
  t470 = t4 * t468 * t89;
  t472 = t170 * t293;
  t477 = 0.1e1 / t292 / t88;
  t478 = t9 * t477;
  t479 = t296 * t296;
  t483 = t4 * t468;
  t484 = t483 / 0.9e1;
  t486 = 0.1e1 / t13 / t11;
  t487 = t486 * t122;
  t489 = 0.1e1 / t126 / t77;
  t490 = t125 * t489;
  t491 = t487 * t490;
  t493 = t118 * t113;
  t494 = t182 * t493;
  t496 = t484 - 0.39224555555555555555e0 * t491 + 0.7844911111111111111e0 * t494;
  t502 = (t470 / 0.9e1 + t175 * t472 * t296 / 0.6e1 + t175 * t478 * t479 / 0.2e1 - t175 * t294 * t496 / 0.4e1) * t122 * t192;
  t505 = t5 * t127;
  t506 = t505 * t88;
  t509 = t194 * t296;
  t512 = t306 * t95;
  t514 = 0.1e1 / t512 * t1;
  t515 = t514 * t3;
  t520 = t307 * t486 * t122;
  t529 = t306 * t306;
  t531 = 0.1e1 / t529 / t95;
  t532 = t531 * t1;
  t533 = t532 * t3;
  t534 = t311 * t311;
  t535 = 0.1e1 / t534;
  t540 = t100 * t293;
  t541 = t540 * t182;
  t542 = t170 * t296;
  t546 = t317 * t486;
  t547 = t122 * t124;
  t548 = t5 * t489;
  t549 = t547 * t548;
  t554 = t101 * t477;
  t558 = t470 / 0.72e2 + t541 * t118 * t542 / 0.3e1 - t546 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t318 * t483 + 0.2e1 * t554 * t479 - t321 * t496;
  t559 = t558 * t324;
  t563 = 0.1e1 / t101 / t100;
  t564 = t323 * t563;
  t565 = t88 * t181;
  t566 = t564 * t565;
  t572 = t4 * t468 * t16;
  t574 = t170 * t177;
  t579 = 0.1e1 / t176 / t15;
  t580 = t9 * t579;
  t581 = t186 * t186;
  t587 = t484 - 0.20708e0 * t491 + 0.41416e0 * t494;
  t593 = (t572 / 0.9e1 + t175 * t574 * t186 / 0.6e1 + t175 * t580 * t581 / 0.2e1 - t175 * t178 * t587 / 0.4e1) * t122 * t192;
  t594 = t593 * t195;
  t595 = 0.10363566666666666667e-1 * t594;
  t596 = t505 * t15;
  t597 = t193 * t596;
  t598 = 0.34545222222222222223e-2 * t597;
  t599 = t194 * t186;
  t600 = t193 * t599;
  t601 = 0.10363566666666666667e-1 * t600;
  t602 = t198 * t22;
  t603 = 0.1e1 / t602;
  t604 = t603 * t1;
  t605 = t604 * t3;
  t607 = t605 * t468 * t204;
  t608 = 0.13255248558342256726e-1 * t607;
  t610 = t199 * t486 * t122;
  t613 = t610 * t125 * t489 * t204;
  t614 = 0.26510497116684513453e-1 * t613;
  t617 = t201 * t118 * t113 * t204;
  t618 = 0.53020994233369026905e-1 * t617;
  t619 = t198 * t198;
  t621 = 0.1e1 / t619 / t22;
  t622 = t621 * t1;
  t623 = t622 * t3;
  t624 = t203 * t203;
  t625 = 0.1e1 / t624;
  t627 = t623 * t468 * t625;
  t628 = 0.50167127350538589834e0 * t627;
  t630 = t28 * t177;
  t631 = t630 * t182;
  t632 = t170 * t186;
  t636 = t209 * t486;
  t641 = t29 * t579;
  t645 = t572 / 0.72e2 + t631 * t118 * t632 / 0.3e1 - t636 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t210 * t483 + 0.2e1 * t641 * t581 - t213 * t587;
  t646 = t645 * t216;
  t647 = t646 * t15;
  t648 = 0.96902277115443742139e-3 * t647;
  t650 = 0.1e1 / t29 / t28;
  t651 = t215 * t650;
  t652 = t15 * t181;
  t653 = t651 * t652;
  t654 = t653 * t179;
  t655 = 0.1615037951924062369e-3 * t654;
  t656 = t217 * t186;
  t657 = 0.96902277115443742139e-3 * t656;
  t658 = 0.51817833333333333333e-2 * t502 * t303 + 0.17272611111111111111e-2 * t302 * t506 + 0.51817833333333333333e-2 * t302 * t509 + 0.13796274692623141087e-1 * t515 * t468 * t312 + 0.27592549385246282174e-1 * t520 * t125 * t489 * t312 - 0.55185098770492564348e-1 * t309 * t118 * t113 * t312 - 0.30878365944746984535e0 * t533 * t468 * t535 + 0.22478670955426118383e-2 * t559 * t88 + 0.37464451592376863972e-3 * t566 * t179 + 0.22478670955426118383e-2 * t325 * t296 - t595 - t598 - t601 - t608 - t614 + t618 + t628 - t648 - t655 - t657;
  t659 = t658 * t69;
  t660 = t659 * t108;
  t661 = t78 * t77;
  t662 = 0.1e1 / t661;
  t663 = t107 * t662;
  t664 = t106 * t663;
  t665 = 0.2e2 * t664;
  t666 = 0.1e1 / t156;
  t667 = t266 * t266;
  t670 = 0.1e1 / t340;
  t671 = t54 * t670;
  t673 = -0.2e1 * t264 + 0.2e1 * t671;
  t677 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t667 + 0.4e1 / 0.3e1 * t61 * t673);
  t678 = 0.1e1 / t159;
  t679 = t270 * t270;
  t682 = -t673;
  t686 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t679 + 0.4e1 / 0.3e1 * t66 * t682);
  t687 = t677 + t686;
  t688 = t105 * t687;
  t689 = t688 * t108;
  t690 = t379 * t379;
  t691 = t114 * t690;
  t692 = t691 * t383;
  t693 = t162 * t162;
  t695 = 0.1e1 / t163 / t693;
  t696 = t143 * t695;
  t697 = t397 * t397;
  t698 = t166 * t697;
  t699 = t696 * t698;
  t700 = t153 * t699;
  t701 = 0.3e1 / 0.4e1 * t700;
  t702 = 0.1e1 / t61;
  t708 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t667 + 0.5e1 / 0.3e1 * t156 * t673);
  t709 = 0.1e1 / t66;
  t715 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t679 + 0.5e1 / 0.3e1 * t159 * t682);
  t716 = t708 + t715;
  t717 = t166 * t716;
  t718 = t390 * t717;
  t719 = t153 * t718;
  t720 = t719 / 0.2e1;
  t721 = t371 * t389;
  t722 = t721 * t398;
  t723 = t153 * t722;
  t724 = t152 * t371;
  t725 = t724 * t382;
  t726 = t380 * t725;
  t727 = 0.2e1 * t726;
  t728 = t344 * t399;
  t729 = 0.7e1 / 0.3e1 * t728;
  t730 = t343 * t379;
  t731 = t730 * t383;
  t732 = 0.14e2 / 0.3e1 * t731;
  t734 = 0.1e1 / t347 / t143;
  t735 = t116 * t734;
  t736 = t371 * t371;
  t740 = t145 * t375;
  t748 = t117 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t123 * t490;
  t750 = t358 * t361;
  t754 = 0.1e1 / t360 / t140;
  t755 = t131 * t754;
  t756 = t369 * t369;
  t765 = t132 * t493 / 0.9e1 + 0.5e1 / 0.18e2 * t135 * t490 + 0.4774648292756860073e4 * params->mbeta * t670;
  t767 = t141 * t748 - t362 * t765 - 0.2e1 * t369 * t750 + 0.2e1 * t755 * t756;
  t771 = 0.1e1 / t147 / t340;
  t775 = -0.2e1 * t735 * t350 * t736 - 0.7e1 / 0.3e1 * t349 * t740 * t371 + t349 * t350 * t767 - 0.91e2 / 0.36e2 * t116 * t146 * t771;
  t776 = t114 * t775;
  t777 = t776 * t383;
  t778 = t457 - t460 + t462 - t464 + t467 + t660 + t665 + t689 + t655 + t692 + t701 - t720 - t723 + t727 + t729 - t732 + t777 + t614 - t618;
  t780 = 0.1e1 / t8 / t78;
  t781 = t111 * t780;
  t782 = t781 * t152;
  t783 = t782 * t167;
  t784 = 0.7e2 / 0.9e1 * t783;
  t786 = t4 * t468 * t37;
  t788 = t170 * t224;
  t793 = 0.1e1 / t223 / t36;
  t794 = t9 * t793;
  t795 = t227 * t227;
  t801 = t484 - 0.62837222222222222223e-1 * t491 + 0.12567444444444444445e0 * t494;
  t807 = (t786 / 0.9e1 + t175 * t788 * t227 / 0.6e1 + t175 * t794 * t795 / 0.2e1 - t175 * t225 * t801 / 0.4e1) * t122 * t192;
  t810 = t505 * t36;
  t813 = t194 * t227;
  t816 = t237 * t42;
  t817 = 0.1e1 / t816;
  t818 = t817 * t1;
  t819 = t818 * t3;
  t824 = t238 * t486 * t122;
  t833 = t237 * t237;
  t835 = 0.1e1 / t833 / t42;
  t836 = t835 * t1;
  t837 = t836 * t3;
  t838 = t242 * t242;
  t839 = 0.1e1 / t838;
  t844 = t47 * t224;
  t845 = t844 * t182;
  t846 = t170 * t227;
  t850 = t248 * t486;
  t855 = t48 * t793;
  t859 = t786 / 0.72e2 + t845 * t118 * t846 / 0.3e1 - t850 * t549 / 0.9e1 + 0.2e1 / 0.9e1 * t249 * t483 + 0.2e1 * t855 * t795 - t252 * t801;
  t860 = t859 * t255;
  t864 = 0.1e1 / t48 / t47;
  t865 = t254 * t864;
  t866 = t36 * t181;
  t867 = t865 * t866;
  t873 = t34 * (t807 * t234 / 0.3e1 + t233 * t810 / 0.9e1 + t233 * t813 / 0.3e1 + 0.12572604010298724325e0 * t819 * t468 * t243 + 0.2514520802059744865e0 * t824 * t125 * t489 * t243 - 0.502904160411948973e0 * t240 * t118 * t113 * t243 - 0.63791733988157656508e1 * t837 * t468 * t839 + 0.41403379428206274608e-3 * t860 * t36 + 0.69005632380343791013e-4 * t867 * t179 + 0.41403379428206274608e-3 * t256 * t227);
  t874 = t873 * t69;
  t875 = t874 * t84;
  t876 = t875 / 0.24e2;
  t877 = t260 * t274;
  t878 = t877 * t84;
  t879 = t878 / 0.12e2;
  t880 = t261 * t286;
  t881 = t880 / 0.12e2;
  t882 = t379 * t152;
  t883 = t114 * t882;
  t884 = t883 * t399;
  t885 = t329 * t334;
  t886 = 0.8e1 * t885;
  t887 = t329 * t337;
  t888 = 0.8e1 * t887;
  t890 = t767 * t164 * t166;
  t891 = t153 * t890;
  t892 = t344 * t386;
  t893 = 0.14e2 / 0.3e1 * t892;
  t895 = 0.12e2 * t75 * t79;
  t897 = 0.32e2 * t278 * t281;
  t899 = 0.2e2 * t76 * t662;
  t902 = t74 * (-t895 + t897 - t899) * t83;
  t903 = t70 * t902;
  t904 = t903 / 0.24e2;
  t905 = t53 * t687;
  t906 = t905 * t84;
  t907 = t906 / 0.24e2;
  t908 = t275 * t286;
  t909 = t908 / 0.12e2;
  t910 = t784 - t876 - t879 - t881 + t648 + t657 - t884 + t886 - t888 + t891 - t893 + t595 + t598 + t601 + t608 - t628 - t904 - t907 - t909;
  t913 = 0.2e1 * t330;
  t915 = 0.19380455423088748428e-2 * t218;
  t916 = 0.20727133333333333334e-1 * t196;
  t917 = t262 / 0.12e2;
  t920 = 0.8e1 * t335;
  t921 = 0.8e1 * t338;
  t922 = 0.2e1 * t387;
  tv2rho20 = -t451 - t400 + t452 + t453 + t7 * (t778 + t910) + t913 + 0.2e1 * t332 + t915 + t916 - t917 - t276 / 0.12e2 - t287 / 0.12e2 + t920 - t921 + t922;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t925 = t344 * t432;
  t927 = t721 * t431;
  t928 = t153 * t927;
  t930 = t702 * t404;
  t933 = t156 * t54;
  t937 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t930 * t266 + 0.1e2 / 0.3e1 * t933 * t670);
  t938 = t709 * t408;
  t941 = t159 * t54;
  t945 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t938 * t270 - 0.1e2 / 0.3e1 * t941 * t670);
  t946 = t937 + t945;
  t947 = t166 * t946;
  t948 = t390 * t947;
  t949 = t153 * t948;
  t951 = -t457 - 0.4e1 * t461 - 0.4e1 * t463 + t466 + t660 + t665 + t655 + 0.7e1 / 0.6e1 * t925 - t928 / 0.2e1 - t949 / 0.2e1 + t692;
  t954 = t422 * t334;
  t956 = t422 * t337;
  t958 = t666 * t404;
  t961 = t61 * t54;
  t965 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t958 * t266 + 0.8e1 / 0.3e1 * t961 * t670);
  t966 = t678 * t408;
  t969 = t66 * t54;
  t973 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t966 * t270 - 0.8e1 / 0.3e1 * t969 * t670);
  t974 = t965 + t973;
  t975 = t105 * t974;
  t976 = t975 * t108;
  t977 = t328 * t412;
  t978 = t977 * t108;
  t979 = -t723 / 0.2e1 + t727 + 0.7e1 / 0.6e1 * t728 - t732 + t777 + t614 - t618 + 0.4e1 * t954 - 0.4e1 * t956 + t976 + t978;
  t981 = t275 * t419;
  t985 = t74 * (t895 - t899) * t83;
  t986 = t70 * t985;
  t988 = t53 * t974;
  t989 = t988 * t84;
  t991 = t413 * t286;
  t993 = t261 * t419;
  t995 = t260 * t412;
  t996 = t995 * t84;
  t1000 = -t981 / 0.24e2 - t986 / 0.24e2 - t989 / 0.24e2 - t991 / 0.24e2 - t993 / 0.24e2 - t996 / 0.24e2 + t784 - t876 - t878 / 0.24e2 - t880 / 0.24e2 + t648;
  t1002 = t114 * t381;
  t1003 = t695 * t166;
  t1004 = t430 * t397;
  t1005 = t1003 * t1004;
  t1006 = t1002 * t1005;
  t1008 = t883 * t432;
  t1010 = t657 - t884 / 0.2e1 - t888 + 0.3e1 / 0.4e1 * t1006 - t1008 / 0.2e1 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho21 = -t434 - t451 - t401 + t452 + t453 + t423 + t913 + t332 + t7 * (t951 + t979 + t1000 + t1010) + t915 + t916 - t917 - t277 - t288 - t921 + t922 - t415 - t421;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1014 = 0.7e1 / 0.3e1 * t925;
  t1015 = t404 * t404;
  t1019 = 0.2e1 * t264 + 0.2e1 * t671;
  t1023 = my_piecewise3(t58, 0, 0.1e2 / 0.9e1 * t702 * t1015 + 0.5e1 / 0.3e1 * t156 * t1019);
  t1024 = t408 * t408;
  t1027 = -t1019;
  t1031 = my_piecewise3(t65, 0, 0.1e2 / 0.9e1 * t709 * t1024 + 0.5e1 / 0.3e1 * t159 * t1027);
  t1032 = t1023 + t1031;
  t1033 = t166 * t1032;
  t1034 = t390 * t1033;
  t1035 = t153 * t1034;
  t1036 = t1035 / 0.2e1;
  t1042 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t666 * t1015 + 0.4e1 / 0.3e1 * t61 * t1019);
  t1048 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t678 * t1024 + 0.4e1 / 0.3e1 * t66 * t1027);
  t1049 = t1042 + t1048;
  t1050 = t105 * t1049;
  t1051 = t1050 * t108;
  t1054 = t74 * (-t895 - t897 - t899) * t83;
  t1055 = t70 * t1054;
  t1056 = t1055 / 0.24e2;
  t1057 = t53 * t1049;
  t1058 = t1057 * t84;
  t1059 = t1058 / 0.24e2;
  t1060 = t413 * t419;
  t1061 = t1060 / 0.12e2;
  t1062 = 0.8e1 * t954;
  t1063 = t457 + t460 + t660 + t665 + t655 + t1014 - t1036 - t928 + t1051 + t692 + t727 - t732 + t777 - t1056 - t1059 - t1061 + t614 - t618 - t1062;
  t1064 = 0.8e1 * t956;
  t1065 = 0.2e1 * t978;
  t1066 = t993 / 0.12e2;
  t1067 = t996 / 0.12e2;
  t1068 = t430 * t430;
  t1069 = t166 * t1068;
  t1070 = t696 * t1069;
  t1071 = t153 * t1070;
  t1072 = 0.3e1 / 0.4e1 * t1071;
  t1073 = -t1064 + t1065 - t1066 - t1067 + t784 - t876 + t1072 + t648 + t657 - t886 - t888 - t1008 + t891 - t893 + t595 + t598 + t601 + t608 - t628;
  tv2rho22 = t7 * (t1063 + t1073) - t433 - t451 + t452 + t453 + 0.2e1 * t423 + t913 + t915 + t916 - t917 - t920 - t921 + t922 - t414 / 0.12e2 - t420 / 0.12e2;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1079 = t342 * t152;
  t1080 = t1079 * t167;
  t1081 = 0.7e1 / 0.3e1 * t1080;
  t1082 = t113 * t379;
  t1083 = t1082 * t152;
  t1084 = t1083 * t167;
  t1085 = t437 * t386;
  t1086 = t437 * t143;
  t1087 = t389 * t166;
  t1088 = t1087 * t397;
  t1089 = t1086 * t1088;
  t1090 = t1089 / 0.2e1;
  t1092 = 0.1e1 / t439 / t78;
  t1093 = t145 * t1092;
  t1095 = t1093 * params->ftilde * t445;
  t1096 = 0.7e1 / 0.4e1 * t1095;
  t1097 = t442 * t116;
  t1098 = t882 * t382;
  t1099 = t1097 * t1098;
  t1100 = t1099 / 0.2e1;
  t1101 = t152 * t389;
  t1102 = t1101 * t398;
  t1103 = t1097 * t1102;
  t1104 = t1103 / 0.4e1;
  tv2rhosigma0 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1090 + t1096 - t1100 + t1104);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1107 = 0.14e2 / 0.3e1 * t1080;
  t1108 = 0.2e1 * t1084;
  t1109 = 0.2e1 * t1085;
  t1110 = 0.7e1 / 0.2e1 * t1095;
  t1111 = t1103 / 0.2e1;
  tv2rhosigma1 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1089 + t1110 - t1099 + t1111);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = tv2rhosigma0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1114 = t1087 * t430;
  t1115 = t1086 * t1114;
  t1116 = t1115 / 0.2e1;
  t1117 = t1101 * t431;
  t1118 = t1097 * t1117;
  t1119 = t1118 / 0.4e1;
  tv2rhosigma3 = t438 - t447 + t7 * (-t1081 + t1084 + t1085 - t1116 + t1096 - t1100 + t1119);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1122 = t1118 / 0.2e1;
  tv2rhosigma4 = t449 - t446 + t7 * (-t1107 + t1108 + t1109 - t1115 + t1110 - t1099 + t1122);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = tv2rhosigma3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1125 = t441 * params->ftilde;
  t1126 = t1125 * t115;
  t1127 = 0.1e1 / t145;
  t1128 = t1127 * t152;
  t1129 = t1128 * t382;
  t1130 = t1126 * t1129;
  t1131 = 0.3e1 / 0.4e1 * t1130;
  t1133 = 0.1e1 / t126 / t78;
  t1134 = params->ftilde * params->ftilde;
  t1135 = t1133 * t1134;
  t1136 = t115 * t115;
  t1138 = t144 * t152;
  t1139 = t1138 * t382;
  t1140 = t1135 * t1136 * t1139;
  t1141 = t1140 / 0.4e1;
  tv2sigma20 = t7 * (-t1131 + t1141);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t1143 = 0.3e1 / 0.2e1 * t1130;
  t1144 = t1140 / 0.2e1;
  tv2sigma21 = t7 * (-t1143 + t1144);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t1146 = 0.3e1 * t1130;
  tv2sigma23 = t7 * (-t1146 + t1140);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1148 = 0.36e2 * t456;
  t1149 = 0.96e2 * t459;
  t1153 = 0.3e1 * t660;
  t1154 = 0.6e2 * t664;
  t1156 = t329 * t458;
  t1157 = 0.96e2 * t1156;
  t1158 = t329 * t455;
  t1159 = 0.36e2 * t1158;
  t1163 = 0.1e1 / t13 / t547 / t505 / 0.4e1;
  t1164 = t199 * t1163;
  t1165 = t2 * t79;
  t1167 = t1164 * t1165 * t204;
  t1168 = 0.15906298270010708072e0 * t1167;
  t1169 = t344 * t890;
  t1170 = 0.7e1 * t1169;
  t1171 = t118 * t342;
  t1175 = 0.1e1 / t126 / t340;
  t1176 = t125 * t1175;
  t1179 = -0.7e1 / 0.27e2 * t117 * t1171 - 0.2e2 / 0.27e2 * t123 * t1176;
  t1181 = t748 * t361;
  t1184 = t358 * t754;
  t1189 = t360 * t360;
  t1190 = 0.1e1 / t1189;
  t1191 = t131 * t1190;
  t1192 = t756 * t369;
  t1195 = t369 * t765;
  t1204 = -0.7e1 / 0.27e2 * t132 * t1171 - 0.2e2 / 0.27e2 * t135 * t1176 - 0.14323944878270580219e5 * params->mbeta * t79;
  t1206 = t1179 * t141 - 0.3e1 * t1181 * t369 + 0.6e1 * t1184 * t756 - 0.6e1 * t1191 * t1192 + 0.6e1 * t1195 * t755 - t1204 * t362 - 0.3e1 * t750 * t765;
  t1208 = t1206 * t164 * t166;
  t1209 = t153 * t1208;
  t1210 = t782 * t386;
  t1211 = 0.7e2 / 0.3e1 * t1210;
  t1212 = t593 * t599;
  t1213 = 0.20727133333333333334e-1 * t1212;
  t1214 = t6 * t342;
  t1216 = t4 * t1214 * t16;
  t1218 = t113 * t177;
  t1220 = t175 * t1218 * t186;
  t1222 = t170 * t579;
  t1229 = t176 * t176;
  t1230 = 0.1e1 / t1229;
  t1231 = t9 * t1230;
  t1232 = t581 * t186;
  t1236 = t186 * t587;
  t1240 = t4 * t1214;
  t1241 = 0.7e1 / 0.27e2 * t1240;
  t1242 = t1163 * t2;
  t1243 = t1242 * t79;
  t1245 = t487 * t1176;
  t1247 = t182 * t1171;
  t1249 = -t1241 - 0.124248e1 * t1243 + 0.82832e0 * t1245 - 0.96637333333333333333e0 * t1247;
  t1255 = (-0.7e1 / 0.27e2 * t1216 - t1220 / 0.3e1 - t175 * t1222 * t581 / 0.2e1 + t175 * t574 * t587 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1231 * t1232 + 0.3e1 / 0.2e1 * t175 * t580 * t1236 - t175 * t178 * t1249 / 0.4e1) * t122 * t192;
  t1256 = t1255 * t195;
  t1257 = 0.10363566666666666667e-1 * t1256;
  t1259 = t605 * t1214 * t204;
  t1260 = 0.48602578047254941329e-1 * t1259;
  t1261 = t593 * t596;
  t1262 = 0.69090444444444444446e-2 * t1261;
  t1264 = t5 * t354;
  t1265 = t1264 * t15;
  t1266 = t193 * t1265;
  t1267 = 0.23030148148148148149e-2 * t1266;
  t1268 = t331 * t458;
  t1269 = 0.96e2 * t1268;
  t1270 = t74 * t54;
  t1271 = t1270 * t79;
  t1272 = t106 * t1271;
  t1273 = 0.24e2 * t1272;
  t1274 = t454 * t281;
  t1275 = t106 * t1274;
  t1276 = 0.144e3 * t1275;
  t1277 = 0.1e1 / t124;
  t1278 = t622 * t1277;
  t1279 = t1214 * t625;
  t1280 = t1278 * t1279;
  t1281 = 0.26614487661862784322e-1 * t1280;
  t1282 = t623 * t1279;
  t1283 = 0.18394613361864149606e1 * t1282;
  t1284 = t194 * t587;
  t1285 = t193 * t1284;
  t1286 = 0.10363566666666666667e-1 * t1285;
  t1287 = t505 * t186;
  t1288 = t193 * t1287;
  t1289 = 0.69090444444444444446e-2 * t1288;
  t1290 = t261 * t902;
  t1292 = t275 * t902;
  t1293 = t1292 / 0.8e1;
  t1294 = t54 * t79;
  t1295 = 0.24e2 * t1294;
  t1296 = t75 * t281;
  t1297 = 0.144e3 * t1296;
  t1298 = t278 * t662;
  t1299 = 0.24e3 * t1298;
  t1301 = 0.1e1 / t78 / t340;
  t1303 = 0.12e3 * t76 * t1301;
  t1306 = t74 * (-t1295 + t1297 - t1299 + t1303) * t83;
  t1307 = t70 * t1306;
  t1308 = t1307 / 0.24e2;
  t1309 = -t1267 - t1269 + t1273 - t1276 - t1281 + t1283 + t1286 + t1289 - t1290 / 0.8e1 - t1293 - t1308;
  t1311 = t260 * t687;
  t1312 = t1311 * t84;
  t1314 = t873 * t274;
  t1315 = t1314 * t84;
  t1316 = t1315 / 0.8e1;
  t1317 = 0.1e1 / t157;
  t1318 = t667 * t266;
  t1321 = t666 * t266;
  t1325 = 0.6e1 * t670 - 0.6e1 * t1294;
  t1329 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1317 * t1318 + 0.4e1 / 0.3e1 * t1321 * t673 + 0.4e1 / 0.3e1 * t61 * t1325);
  t1330 = 0.1e1 / t160;
  t1331 = t679 * t270;
  t1334 = t678 * t270;
  t1337 = -t1325;
  t1341 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1330 * t1331 + 0.4e1 / 0.3e1 * t1334 * t682 + 0.4e1 / 0.3e1 * t66 * t1337);
  t1342 = t1329 + t1341;
  t1343 = t53 * t1342;
  t1344 = t1343 * t84;
  t1345 = t1344 / 0.24e2;
  t1346 = t905 * t286;
  t1347 = t1346 / 0.8e1;
  t1348 = t877 * t286;
  t1350 = t874 * t286;
  t1351 = t1350 / 0.8e1;
  t1352 = t238 * t1163;
  t1356 = t1214 * t839;
  t1359 = t194 * t801;
  t1362 = t836 * t1277;
  t1365 = t505 * t227;
  t1371 = t4 * t1214 * t37;
  t1373 = t113 * t224;
  t1375 = t175 * t1373 * t227;
  t1377 = t170 * t793;
  t1384 = t223 * t223;
  t1385 = 0.1e1 / t1384;
  t1386 = t9 * t1385;
  t1387 = t795 * t227;
  t1391 = t227 * t801;
  t1398 = -t1241 - 0.37702333333333333334e0 * t1243 + 0.2513488888888888889e0 * t1245 - 0.29324037037037037038e0 * t1247;
  t1404 = (-0.7e1 / 0.27e2 * t1371 - t1375 / 0.3e1 - t175 * t1377 * t795 / 0.2e1 + t175 * t788 * t801 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1386 * t1387 + 0.3e1 / 0.2e1 * t175 * t794 * t1391 - t175 * t225 * t1398 / 0.4e1) * t122 * t192;
  t1407 = t833 * t833;
  t1408 = 0.1e1 / t1407;
  t1409 = t1408 * t122;
  t1410 = t1409 * t124;
  t1411 = t5 * t1175;
  t1413 = 0.1e1 / t838 / t242;
  t1414 = t1413 * t181;
  t1418 = t48 * t48;
  t1419 = 0.1e1 / t1418;
  t1420 = t254 * t1419;
  t1421 = t1420 * t36;
  t1427 = 0.1e1 / t833;
  t1428 = t1427 * t122;
  t1429 = t1428 * t124;
  t1430 = t243 * t181;
  t1435 = 0.1e1 / t833 / t237;
  t1436 = t1435 * t122;
  t1437 = t1436 * t124;
  t1438 = t839 * t181;
  t1442 = 0.1508712481235846919e1 * t1352 * t1165 * t243 + 0.23390302462324474053e2 * t837 * t1356 + t233 * t1359 / 0.3e1 - 0.33842565975395191035e0 * t1362 * t1356 + 0.2e1 / 0.9e1 * t233 * t1365 + 0.2e1 / 0.3e1 * t807 * t813 + t1404 * t234 / 0.3e1 + 0.86312224513605868233e3 * t1410 * t1411 * t1414 + 0.17251408095085947753e-4 * t1421 * t483 - 0.46099548037761989191e0 * t819 * t1214 * t243 + 0.2514520802059744865e0 * t1429 * t1411 * t1430 - 0.29769475861140239704e2 * t1437 * t1411 * t1438;
  t1443 = t818 * t1277;
  t1444 = t2 * t243;
  t1450 = t1264 * t36;
  t1453 = t859 * t864;
  t1454 = t1453 * t866;
  t1457 = t227 * t181;
  t1458 = t865 * t1457;
  t1461 = t36 * t486;
  t1462 = t865 * t1461;
  t1477 = t47 * t793;
  t1478 = t1477 * t182;
  t1482 = t844 * t487;
  t1496 = t1 * t1277 * t6;
  t1497 = t342 * t2;
  t1503 = t547 * t1411;
  t1508 = t48 * t1385;
  t1514 = -0.11e2 / 0.216e3 * t1371 - t1375 / 0.24e2 - t1478 * t118 * t170 * t795 + t1482 * t125 * t489 * t227 / 0.3e1 - 0.2e1 / 0.3e1 * t845 * t118 * t113 * t227 + t845 * t118 * t170 * t801 / 0.2e1 + t1496 * t1497 * t37 / 0.432e3 - 0.2e1 / 0.3e1 * t248 * t1243 + 0.4e1 / 0.9e1 * t850 * t1503 - 0.14e2 / 0.27e2 * t249 * t1240 - 0.6e1 * t1508 * t1387 + 0.6e1 * t855 * t1391 - t252 * t1398;
  t1515 = t1514 * t255;
  t1522 = 0.20954340017164540542e-1 * t1443 * t1214 * t1444 + 0.2e1 / 0.9e1 * t807 * t810 - 0.2e1 / 0.27e2 * t233 * t1450 + 0.13801126476068758203e-3 * t1454 * t179 + 0.13801126476068758203e-3 * t1458 * t179 + 0.46003754920229194009e-4 * t1462 * t549 + 0.11734430409612142703e1 * t240 * t118 * t342 * t243 - 0.1005808320823897946e1 * t824 * t125 * t1175 * t243 + 0.41403379428206274608e-3 * t256 * t801 + 0.41403379428206274608e-3 * t1515 * t36 + 0.82806758856412549216e-3 * t860 * t227 - 0.92007509840458388017e-4 * t867 * t483;
  t1524 = t34 * (t1442 + t1522);
  t1525 = t1524 * t69;
  t1526 = t1525 * t84;
  t1527 = t1526 / 0.24e2;
  t1529 = 0.1e1 / t8 / t280;
  t1530 = t111 * t1529;
  t1531 = t1530 * t152;
  t1532 = t1531 * t167;
  t1533 = 0.91e3 / 0.27e2 * t1532;
  t1534 = t659 * t337;
  t1535 = 0.12e2 * t1534;
  t1536 = t331 * t455;
  t1537 = 0.36e2 * t1536;
  t1539 = t659 * t334;
  t1540 = 0.12e2 * t1539;
  t1543 = t610 * t125 * t1175 * t204;
  t1544 = 0.10604198846673805381e0 * t1543;
  t1547 = t201 * t118 * t342 * t204;
  t1548 = 0.12371565321119439611e0 * t1547;
  t1549 = t344 * t722;
  t1550 = 0.7e1 * t1549;
  t1551 = t730 * t725;
  t1552 = 0.14e2 * t1551;
  t1553 = t767 * t389;
  t1554 = t1553 * t398;
  t1555 = t153 * t1554;
  t1556 = 0.3e1 / 0.2e1 * t1555;
  t1557 = t152 * t767;
  t1558 = t1557 * t382;
  t1559 = t380 * t1558;
  t1560 = 0.3e1 * t1559;
  t1561 = t465 * t334;
  t1562 = 0.24e2 * t1561;
  t1563 = t465 * t337;
  t1564 = 0.24e2 * t1563;
  t1565 = t688 * t334;
  t1567 = t688 * t337;
  t1569 = t1540 - t1544 + t1548 + t1550 - t1552 - t1556 + t1560 + t1562 - t1564 + 0.12e2 * t1565 - 0.12e2 * t1567;
  t1572 = t333 * t662;
  t1573 = t106 * t1572;
  t1574 = 0.24e3 * t1573;
  t1575 = t107 * t1301;
  t1576 = t106 * t1575;
  t1577 = 0.12e3 * t1576;
  t1578 = t328 * t687;
  t1579 = t1578 * t108;
  t1581 = t329 * t663;
  t1582 = 0.6e2 * t1581;
  t1583 = t658 * t274;
  t1584 = t1583 * t108;
  t1585 = 0.3e1 * t1584;
  t1586 = t331 * t663;
  t1587 = 0.6e2 * t1586;
  t1588 = t29 * t29;
  t1589 = 0.1e1 / t1588;
  t1590 = t215 * t1589;
  t1591 = t1590 * t15;
  t1592 = t1591 * t483;
  t1593 = 0.40375948798101559225e-4 * t1592;
  t1594 = t619 * t619;
  t1595 = 0.1e1 / t1594;
  t1596 = t1595 * t122;
  t1597 = t1596 * t124;
  t1599 = 0.1e1 / t624 / t203;
  t1600 = t1599 * t181;
  t1602 = t1597 * t1411 * t1600;
  t1603 = 0.50631328524251801694e2 * t1602;
  t1604 = 0.1e1 / t619;
  t1605 = t1604 * t122;
  t1606 = t1605 * t124;
  t1607 = t204 * t181;
  t1609 = t1606 * t1411 * t1607;
  t1610 = 0.26510497116684513452e-1 * t1609;
  t1612 = 0.1e1 / t619 / t198;
  t1613 = t1612 * t122;
  t1614 = t1613 * t124;
  t1615 = t625 * t181;
  t1617 = t1614 * t1411 * t1615;
  t1618 = 0.23411326096918008589e1 * t1617;
  t1620 = t604 * t1277;
  t1621 = t2 * t204;
  t1623 = t1620 * t1214 * t1621;
  t1624 = 0.22092080930570427878e-2 * t1623;
  t1625 = t371 * t695;
  t1626 = t1625 * t698;
  t1627 = t153 * t1626;
  t1629 = t691 * t725;
  t1630 = 0.3e1 * t1629;
  t1631 = t782 * t399;
  t1632 = 0.35e2 / 0.3e1 * t1631;
  t1633 = t344 * t699;
  t1635 = t347 * t347;
  t1637 = t116 / t1635;
  t1638 = t736 * t371;
  t1645 = t371 * t767;
  t1649 = t145 * t771;
  t1659 = 0.1e1 / t147 / t78;
  t1663 = 0.6e1 * t1637 * t350 * t1638 + 0.7e1 * t735 * t740 * t736 - 0.6e1 * t735 * t350 * t1645 + 0.91e2 / 0.12e2 * t349 * t1649 * t371 - 0.7e1 / 0.2e1 * t349 * t740 * t767 + t349 * t350 * t1206 + 0.1729e4 / 0.216e3 * t116 * t146 * t1659;
  t1664 = t114 * t1663;
  t1665 = t1664 * t383;
  t1666 = t343 * t775;
  t1667 = t1666 * t383;
  t1668 = 0.7e1 * t1667;
  t1669 = t776 * t725;
  t1670 = 0.3e1 * t1669;
  t1671 = 0.1e1 / t62;
  t1674 = t702 * t266;
  t1680 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t1671 * t1318 + 0.1e2 / 0.3e1 * t1674 * t673 + 0.5e1 / 0.3e1 * t156 * t1325);
  t1681 = 0.1e1 / t67;
  t1684 = t709 * t270;
  t1690 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t1681 * t1331 + 0.1e2 / 0.3e1 * t1684 * t682 + 0.5e1 / 0.3e1 * t159 * t1337);
  t1691 = t1680 + t1690;
  t1692 = t166 * t1691;
  t1693 = t390 * t1692;
  t1694 = t153 * t1693;
  t1695 = t1694 / 0.2e1;
  t1696 = t721 * t717;
  t1697 = t153 * t1696;
  t1699 = t690 * t379;
  t1700 = t114 * t1699;
  t1701 = t1700 * t383;
  t1702 = t1624 + 0.9e1 / 0.4e1 * t1627 + t1630 - t1632 - 0.21e2 / 0.4e1 * t1633 + t1665 - t1668 + t1670 - t1695 - 0.3e1 / 0.2e1 * t1697 + t1701;
  t1706 = 0.1e1 / t163 / t693 / t162;
  t1707 = t143 * t1706;
  t1708 = t697 * t397;
  t1709 = t166 * t1708;
  t1710 = t1707 * t1709;
  t1711 = t153 * t1710;
  t1712 = 0.15e2 / 0.8e1 * t1711;
  t1713 = t781 * t379;
  t1714 = t1713 * t383;
  t1715 = 0.7e2 / 0.3e1 * t1714;
  t1716 = t343 * t690;
  t1717 = t1716 * t383;
  t1718 = 0.7e1 * t1717;
  t1719 = t344 * t718;
  t1722 = t4 * t1214 * t89;
  t1724 = t113 * t293;
  t1726 = t175 * t1724 * t296;
  t1728 = t170 * t477;
  t1735 = t292 * t292;
  t1736 = 0.1e1 / t1735;
  t1737 = t9 * t1736;
  t1738 = t479 * t296;
  t1742 = t296 * t496;
  t1749 = -t1241 - 0.23534733333333333333e1 * t1243 + 0.15689822222222222222e1 * t1245 - 0.18304792592592592592e1 * t1247;
  t1755 = (-0.7e1 / 0.27e2 * t1722 - t1726 / 0.3e1 - t175 * t1728 * t479 / 0.2e1 + t175 * t472 * t496 / 0.4e1 - 0.3e1 / 0.2e1 * t175 * t1737 * t1738 + 0.3e1 / 0.2e1 * t175 * t478 * t1742 - t175 * t294 * t1749 / 0.4e1) * t122 * t192;
  t1763 = t1264 * t88;
  t1766 = t532 * t1277;
  t1767 = t1214 * t535;
  t1772 = t194 * t496;
  t1775 = t505 * t296;
  t1780 = -t1168 + 0.51817833333333333333e-2 * t1755 * t303 - 0.50586340539618183985e-1 * t515 * t1214 * t312 + 0.34545222222222222222e-2 * t502 * t506 - 0.11515074074074074074e-2 * t302 * t1763 - 0.16381481915689750931e-1 * t1766 * t1767 + 0.1132206751307389433e1 * t533 * t1767 + 0.51817833333333333333e-2 * t302 * t1772 + 0.34545222222222222222e-2 * t302 * t1775 + 0.10363566666666666667e-1 * t502 * t509 - t1213 - t1257;
  t1789 = t529 * t529;
  t1790 = 0.1e1 / t1789;
  t1791 = t1790 * t122;
  t1792 = t1791 * t124;
  t1794 = 0.1e1 / t534 / t311;
  t1795 = t1794 * t181;
  t1799 = t101 * t101;
  t1800 = 0.1e1 / t1799;
  t1801 = t323 * t1800;
  t1802 = t1801 * t88;
  t1805 = 0.1e1 / t529;
  t1806 = t1805 * t122;
  t1807 = t1806 * t124;
  t1808 = t312 * t181;
  t1812 = t1260 - t1262 + t1267 + t1281 - t1283 - t1286 - t1289 + 0.12876523046448265015e0 * t309 * t118 * t342 * t312 - 0.1103701975409851287e0 * t520 * t125 * t1175 * t312 + 0.18429583437767336288e2 * t1792 * t1411 * t1795 + 0.9366112898094215993e-4 * t1802 * t483 + 0.27592549385246282174e-1 * t1807 * t1411 * t1808;
  t1815 = 0.1e1 / t529 / t306;
  t1816 = t1815 * t122;
  t1817 = t1816 * t124;
  t1818 = t535 * t181;
  t1822 = t514 * t1277;
  t1823 = t2 * t312;
  t1827 = t217 * t587;
  t1828 = 0.96902277115443742139e-3 * t1827;
  t1829 = t646 * t186;
  t1830 = 0.19380455423088748428e-2 * t1829;
  t1833 = t28 * t579;
  t1834 = t1833 * t182;
  t1838 = t630 * t487;
  t1860 = t29 * t1230;
  t1866 = -0.11e2 / 0.216e3 * t1216 - t1220 / 0.24e2 - t1834 * t118 * t170 * t581 + t1838 * t125 * t489 * t186 / 0.3e1 - 0.2e1 / 0.3e1 * t631 * t118 * t113 * t186 + t631 * t118 * t170 * t587 / 0.2e1 + t1496 * t1497 * t16 / 0.432e3 - 0.2e1 / 0.3e1 * t209 * t1243 + 0.4e1 / 0.9e1 * t636 * t1503 - 0.14e2 / 0.27e2 * t210 * t1240 - 0.6e1 * t1860 * t1232 + 0.6e1 * t641 * t1236 - t213 * t1249;
  t1867 = t1866 * t216;
  t1868 = t1867 * t15;
  t1869 = 0.96902277115443742139e-3 * t1868;
  t1870 = -0.14409904107548592783e1 * t1817 * t1411 * t1818 + 0.22993791154371901812e-2 * t1822 * t1214 * t1823 + t1544 - t1548 - t1593 - t1603 - t1610 + t1618 - t1624 - t1828 - t1830 - t1869;
  t1871 = t186 * t181;
  t1872 = t651 * t1871;
  t1873 = t1872 * t179;
  t1874 = 0.3230075903848124738e-3 * t1873;
  t1875 = t15 * t486;
  t1876 = t651 * t1875;
  t1877 = t1876 * t549;
  t1878 = 0.10766919679493749127e-3 * t1877;
  t1879 = t645 * t650;
  t1880 = t1879 * t652;
  t1881 = t1880 * t179;
  t1882 = 0.3230075903848124738e-3 * t1881;
  t1883 = t558 * t563;
  t1884 = t1883 * t565;
  t1887 = t296 * t181;
  t1888 = t564 * t1887;
  t1891 = t88 * t486;
  t1892 = t564 * t1891;
  t1895 = t653 * t483;
  t1896 = 0.21533839358987498253e-3 * t1895;
  t1899 = t307 * t1163;
  t1909 = t100 * t477;
  t1910 = t1909 * t182;
  t1914 = t540 * t487;
  t1936 = t101 * t1736;
  t1942 = -0.11e2 / 0.216e3 * t1722 - t1726 / 0.24e2 - t1910 * t118 * t170 * t479 + t1914 * t125 * t489 * t296 / 0.3e1 - 0.2e1 / 0.3e1 * t541 * t118 * t113 * t296 + t541 * t118 * t170 * t496 / 0.2e1 + t1496 * t1497 * t89 / 0.432e3 - 0.2e1 / 0.3e1 * t317 * t1243 + 0.4e1 / 0.9e1 * t546 * t1503 - 0.14e2 / 0.27e2 * t318 * t1240 - 0.6e1 * t1936 * t1738 + 0.6e1 * t554 * t1742 - t321 * t1749;
  t1943 = t1942 * t324;
  t1946 = -t1874 - t1878 - t1882 + 0.74928903184753727944e-3 * t1884 * t179 + 0.74928903184753727944e-3 * t1888 * t179 + 0.24976301061584575981e-3 * t1892 * t549 + t1896 - 0.49952602123169151963e-3 * t566 * t483 + 0.16555529631147769304e0 * t1899 * t1165 * t312 + 0.22478670955426118383e-2 * t325 * t496 + 0.44957341910852236766e-2 * t559 * t296 + 0.22478670955426118383e-2 * t1943 * t88;
  t1948 = t1780 + t1812 + t1870 + t1946;
  t1949 = t1948 * t69;
  t1950 = t1949 * t108;
  t1951 = t883 * t699;
  t1953 = t690 * t152;
  t1954 = t114 * t1953;
  t1955 = t1954 * t399;
  t1956 = 0.3e1 / 0.2e1 * t1955;
  t1958 = t775 * t152;
  t1959 = t114 * t1958;
  t1960 = t1959 * t399;
  t1961 = 0.3e1 / 0.2e1 * t1960;
  t1962 = t775 * t379;
  t1963 = t114 * t1962;
  t1964 = t1963 * t383;
  t1965 = 0.3e1 * t1964;
  t1967 = t1003 * t716 * t397;
  t1968 = t1002 * t1967;
  t1969 = 0.9e1 / 0.4e1 * t1968;
  t1970 = t883 * t718;
  t1972 = t883 * t722;
  t1973 = 0.3e1 * t1972;
  t1974 = t343 * t882;
  t1975 = t1974 * t399;
  t1976 = 0.7e1 * t1975;
  t1977 = t105 * t1342;
  t1978 = t1977 * t108;
  t1979 = -t1961 + t1965 + t1969 - 0.3e1 / 0.2e1 * t1970 - t1973 + t1976 + t1874 + t1878 + t1882 - t1896 + t1978;
  t1984 = 0.4845113855772187107e-3 * t654;
  t1985 = 0.3e1 * t692;
  t1989 = 0.6e1 * t726;
  t1991 = 0.14e2 * t731;
  t1992 = 0.3e1 * t777;
  t1993 = 0.79531491350053540358e-1 * t613;
  t1994 = t1148 - t1149 + 0.24e2 * t461 - 0.24e2 * t463 + 0.6e1 * t466 + t1153 + t1154 + 0.3e1 * t689 + t7 * (t1950 + 0.9e1 / 0.4e1 * t1951 - t1348 / 0.4e1 - t1351 - t1535 + t1537 + t1979 + t1168 + t1603 + t1211 + t1213 + t1610 + t1262 - t1157 + t1159 - t1718 + 0.7e1 / 0.2e1 * t1719 - t1312 / 0.8e1 + t1569 + t1869 - t1345 - t1347 - t1170 + t1830 - t1527 + t1309 - t1956 + t1593 - t1533 + t1585 + t1587 + 0.3e1 * t1579 + t1582 + t1257 - t1260 + t1574 - t1577 + t1702 + t1209 + t1828 - t1316 - t1712 + t1715 - t1618) + t1984 + t1985 + 0.9e1 / 0.4e1 * t700 - 0.3e1 / 0.2e1 * t719 - 0.3e1 * t723 + t1989 + 0.7e1 * t728 - t1991 + t1992 + t1993;
  t1995 = 0.15906298270010708072e0 * t617;
  t1996 = 0.7e2 / 0.3e1 * t783;
  t1997 = t875 / 0.8e1;
  t2000 = 0.29070683134633122642e-2 * t647;
  t2001 = 0.29070683134633122642e-2 * t656;
  t2003 = 0.24e2 * t885;
  t2004 = 0.24e2 * t887;
  t2005 = 0.3e1 * t891;
  t2006 = 0.14e2 * t892;
  t2007 = 0.31090700000000000001e-1 * t594;
  t2008 = 0.10363566666666666667e-1 * t597;
  t2009 = 0.31090700000000000001e-1 * t600;
  t2010 = 0.39765745675026770179e-1 * t607;
  t2011 = 0.1505013820516157695e1 * t627;
  t2015 = -t1995 + t1996 - t1997 - t878 / 0.4e1 - t880 / 0.4e1 + t2000 + t2001 - 0.3e1 * t884 + t2003 - t2004 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011 - t903 / 0.8e1 - t906 / 0.8e1 - t908 / 0.4e1;
  tv3rho30 = t1994 + t2015;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2018 = -t457 - t460 - 0.16e2 * t463 + 0.4e1 * t466 + t1153 + t1154 + t689 + t1984 + t1014 - t928 - t949 + t1985 + t701;
  t2021 = 0.2e1 * t976;
  t2022 = t981 / 0.12e2;
  t2023 = -t720 - 0.2e1 * t723 + t1989 + 0.14e2 / 0.3e1 * t728 - t1991 + t1992 + t1993 - t1995 + t1062 - t1064 + t2021 + t1065 - t2022;
  t2025 = t986 / 0.12e2;
  t2026 = t989 / 0.12e2;
  t2027 = t991 / 0.12e2;
  t2030 = 0.32e2 * t1156;
  t2031 = 0.12e2 * t1158;
  t2032 = 0.48e2 * t1275;
  t2033 = -t2030 - t2031 + t1168 - t1170 + t1209 + t1211 + t1213 + t1257 - t1260 + t1262 - t1267 - t1273 + t2032 - t1281;
  t2036 = t328 * t974;
  t2037 = t2036 * t108;
  t2038 = 0.2e1 * t2037;
  t2039 = t977 * t337;
  t2041 = t975 * t334;
  t2042 = 0.8e1 * t2041;
  t2043 = t975 * t337;
  t2044 = 0.8e1 * t2043;
  t2045 = t1317 * t404;
  t2048 = t666 * t54;
  t2049 = t670 * t266;
  t2059 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t2045 * t667 + 0.16e2 / 0.9e1 * t2048 * t2049 + 0.4e1 / 0.9e1 * t958 * t673 + 0.8e1 / 0.3e1 * t61 * t670 - 0.8e1 * t961 * t79);
  t2060 = t1330 * t408;
  t2063 = t678 * t54;
  t2064 = t670 * t270;
  t2074 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t2060 * t679 - 0.16e2 / 0.9e1 * t2063 * t2064 + 0.4e1 / 0.9e1 * t966 * t682 - 0.8e1 / 0.3e1 * t66 * t670 + 0.8e1 * t969 * t79);
  t2075 = t2059 + t2074;
  t2076 = t105 * t2075;
  t2077 = t2076 * t108;
  t2078 = t658 * t412;
  t2079 = t2078 * t108;
  t2080 = t260 * t974;
  t2081 = t2080 * t84;
  t2082 = t2081 / 0.12e2;
  t2083 = t53 * t2075;
  t2084 = t2083 * t84;
  t2086 = t988 * t286;
  t2088 = t1283 + t1286 + t1289 - t1290 / 0.24e2 - t1312 / 0.24e2 + t2038 - 0.8e1 * t2039 + t2042 - t2044 + t2077 + t2079 - t2082 - t2084 / 0.24e2 - t2086 / 0.12e2;
  t2090 = t995 * t286;
  t2091 = t2090 / 0.12e2;
  t2092 = t905 * t419;
  t2094 = t275 * t985;
  t2096 = t261 * t985;
  t2097 = t2096 / 0.12e2;
  t2098 = 0.48e2 * t1296;
  t2099 = 0.8e2 * t1298;
  t2102 = t74 * (t1295 - t2098 - t2099 + t1303) * t83;
  t2103 = t70 * t2102;
  t2105 = t877 * t419;
  t2106 = t2105 / 0.12e2;
  t2107 = t977 * t334;
  t2112 = t422 * t663;
  t2114 = t422 * t455;
  t2116 = -t2091 - t2092 / 0.24e2 - t2094 / 0.12e2 - t2097 - t2103 / 0.24e2 - t2106 + 0.8e1 * t2107 - t1315 / 0.12e2 - t1348 / 0.12e2 - t1350 / 0.12e2 - t1527 - t1533 + 0.2e2 * t2112 + 0.12e2 * t2114;
  t2117 = t422 * t458;
  t2119 = t1553 * t431;
  t2120 = t153 * t2119;
  t2122 = t721 * t947;
  t2123 = t153 * t2122;
  t2124 = t1671 * t404;
  t2127 = t702 * t54;
  t2137 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t2124 * t667 + 0.4e2 / 0.9e1 * t2127 * t2049 + 0.1e2 / 0.9e1 * t930 * t673 + 0.1e2 / 0.3e1 * t156 * t670 - 0.1e2 * t933 * t79);
  t2138 = t1681 * t408;
  t2141 = t709 * t54;
  t2151 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t2138 * t679 - 0.4e2 / 0.9e1 * t2141 * t2064 + 0.1e2 / 0.9e1 * t938 * t682 - 0.1e2 / 0.3e1 * t159 * t670 + 0.1e2 * t941 * t79);
  t2152 = t2137 + t2151;
  t2153 = t166 * t2152;
  t2154 = t390 * t2153;
  t2155 = t153 * t2154;
  t2157 = t344 * t948;
  t2158 = 0.7e1 / 0.3e1 * t2157;
  t2159 = t344 * t927;
  t2161 = t782 * t432;
  t2163 = 0.24e2 * t1536;
  t2164 = 0.4e1 * t1539;
  t2165 = t1954 * t432;
  t2167 = t1706 * t166;
  t2169 = t2167 * t430 * t697;
  t2170 = t1002 * t2169;
  t2173 = t1003 * t946 * t397;
  t2174 = t1002 * t2173;
  t2176 = t883 * t948;
  t2177 = -0.32e2 * t2117 - t2120 / 0.2e1 - t2123 - t2155 / 0.2e1 + t2158 + 0.7e1 / 0.3e1 * t2159 - 0.35e2 / 0.9e1 * t2161 - t1535 - t2163 + t2164 - t2165 / 0.2e1 - 0.15e2 / 0.8e1 * t2170 + 0.3e1 / 0.2e1 * t2174 - t2176;
  t2180 = t114 * t724;
  t2181 = t2180 * t1005;
  t2182 = 0.3e1 / 0.2e1 * t2181;
  t2183 = t883 * t927;
  t2184 = t343 * t381;
  t2185 = t2184 * t1005;
  t2186 = 0.7e1 / 0.2e1 * t2185;
  t2187 = t1974 * t432;
  t2189 = t430 * t716;
  t2190 = t1003 * t2189;
  t2191 = t1002 * t2190;
  t2193 = t1959 * t432;
  t2198 = t2182 - t2183 - t2186 + 0.7e1 / 0.3e1 * t2187 + 0.3e1 / 0.4e1 * t2191 - t2193 / 0.2e1 - t1544 + t1548 + 0.14e2 / 0.3e1 * t1549 - t1552 - t1555 + t1560 - 0.16e2 * t1563 - 0.4e1 * t1565;
  t2200 = 0.8e2 * t1573;
  t2204 = -0.4e1 * t1567 + t2200 - t1577 + t1579 + t1582 + 0.2e1 * t1584 + 0.4e2 * t1586 + t1593 + t1603 + t1610 - t1618 + t1624 + 0.3e1 / 0.4e1 * t1627 + t1630;
  t2210 = t431 * t397;
  t2211 = t696 * t2210;
  t2212 = t883 * t2211;
  t2213 = 0.3e1 / 0.2e1 * t2212;
  t2214 = -0.7e2 / 0.9e1 * t1631 - 0.7e1 / 0.4e1 * t1633 + t1665 - t1668 + t1670 - t1697 / 0.2e1 + t1701 + t1715 - t1718 + 0.7e1 / 0.6e1 * t1719 + t2213 + t1950 + t1828 + t1830;
  t2219 = t873 * t412;
  t2220 = t2219 * t84;
  t2222 = t413 * t902;
  t2224 = t874 * t419;
  t2226 = t1869 + 0.3e1 / 0.4e1 * t1951 - t1955 - t1960 + t1965 - t1970 / 0.2e1 - 0.2e1 * t1972 + 0.14e2 / 0.3e1 * t1975 + t1874 + t1878 + t1882 - t1896 - t2220 / 0.24e2 - t2222 / 0.24e2 - t2224 / 0.24e2;
  t2232 = -t2025 - t2026 - t2027 - t1066 - t1067 + t1996 - t1997 - t878 / 0.6e1 - t880 / 0.6e1 + t2000 + t2001 + t7 * (t2033 + t2088 + t2116 + t2177 + t2198 + t2204 + t2214 + t2226) - 0.2e1 * t884;
  t2233 = 0.3e1 / 0.2e1 * t1006;
  t2234 = t886 - t2004 + t2233 - t1008 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011 - t904 - t907 - t909;
  tv3rho31 = t2018 + t2023 + t2232 + t2234;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2236 = t1317 * t1015;
  t2241 = t666 * t1019;
  t2246 = -0.2e1 * t670 - 0.6e1 * t1294;
  t2250 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t2236 * t266 + 0.16e2 / 0.9e1 * t958 * t671 + 0.4e1 / 0.9e1 * t2241 * t266 + 0.4e1 / 0.3e1 * t61 * t2246);
  t2251 = t1330 * t1024;
  t2256 = t678 * t1027;
  t2259 = -t2246;
  t2263 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t2251 * t270 - 0.16e2 / 0.9e1 * t966 * t671 + 0.4e1 / 0.9e1 * t2256 * t270 + 0.4e1 / 0.3e1 * t66 * t2259);
  t2264 = t2250 + t2263;
  t2265 = t105 * t2264;
  t2266 = t2265 * t108;
  t2267 = t328 * t1049;
  t2268 = t2267 * t108;
  t2270 = t2030 - t2031 + t1168 - t1170 + t1209 + t1211 + t1213 + t1257 - t1260 + t1262 - t1267 + t2266 + t2268 + 0.32e2 * t1268;
  t2272 = t1003 * t1032 * t397;
  t2273 = t1002 * t2272;
  t2275 = t883 * t1034;
  t2278 = t2167 * t1068 * t397;
  t2279 = t1002 * t2278;
  t2282 = t1003 * t430 * t946;
  t2283 = t1002 * t2282;
  t2285 = t883 * t1070;
  t2287 = t721 * t1033;
  t2288 = t153 * t2287;
  t2290 = t344 * t1034;
  t2292 = t1273 + t2032 - t1281 + t1283 + t1286 + t1289 + 0.3e1 / 0.4e1 * t2273 - t2275 / 0.2e1 - 0.15e2 / 0.8e1 * t2279 + 0.3e1 / 0.2e1 * t2283 + 0.3e1 / 0.4e1 * t2285 + t2038 - t2288 / 0.2e1 + 0.7e1 / 0.6e1 * t2290;
  t2296 = t1625 * t1069;
  t2297 = t153 * t2296;
  t2299 = t344 * t1070;
  t2301 = t1671 * t1015;
  t2306 = t702 * t1019;
  t2312 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t2301 * t266 + 0.4e2 / 0.9e1 * t930 * t671 + 0.1e2 / 0.9e1 * t2306 * t266 + 0.5e1 / 0.3e1 * t156 * t2246);
  t2313 = t1681 * t1024;
  t2318 = t709 * t1027;
  t2324 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t2313 * t270 - 0.4e2 / 0.9e1 * t938 * t671 + 0.1e2 / 0.9e1 * t2318 * t270 + 0.5e1 / 0.3e1 * t159 * t2259);
  t2325 = t2312 + t2324;
  t2326 = t166 * t2325;
  t2327 = t390 * t2326;
  t2328 = t153 * t2327;
  t2332 = -0.16e2 * t2039 - t2042 - t2044 + 0.2e1 * t2079 - t2082 - t2091 - t2097 - t2106 + 0.3e1 / 0.4e1 * t2297 - 0.7e1 / 0.4e1 * t2299 - t2328 / 0.2e1 - t1315 / 0.24e2 - t1350 / 0.24e2 - t1527;
  t2334 = 0.24e2 * t2114;
  t2338 = t1050 * t334;
  t2340 = t1050 * t337;
  t2342 = -t1533 + 0.4e2 * t2112 - t2334 - t2120 - t2123 + t2158 + 0.14e2 / 0.3e1 * t2159 - 0.7e2 / 0.9e1 * t2161 - t1535 + 0.12e2 * t1536 - t2164 + 0.4e1 * t2338 - 0.4e1 * t2340 - t2165;
  t2351 = -t2176 + t2182 - 0.2e1 * t2183 - t2186 + 0.14e2 / 0.3e1 * t2187 - t2193 - t1544 + t1548 + 0.7e1 / 0.3e1 * t1549 - t1552 - t1555 / 0.2e1 + t1560 - 0.8e1 * t1561 - 0.8e1 * t1563;
  t2353 = t995 * t419;
  t2355 = t988 * t419;
  t2357 = t413 * t985;
  t2359 = t275 * t1054;
  t2363 = t74 * (-t1295 - t2098 + t2099 + t1303) * t83;
  t2364 = t70 * t2363;
  t2366 = t260 * t1049;
  t2367 = t2366 * t84;
  t2369 = t261 * t1054;
  t2371 = t53 * t2264;
  t2372 = t2371 * t84;
  t2374 = t1057 * t286;
  t2376 = -t2200 - t1577 + t1582 + t1584 + 0.2e2 * t1586 - t2353 / 0.12e2 - t2355 / 0.12e2 - t2357 / 0.12e2 - t2359 / 0.24e2 - t2364 / 0.24e2 - t2367 / 0.24e2 - t2369 / 0.24e2 - t2372 / 0.24e2 - t2374 / 0.24e2;
  t2379 = t1593 + t1603 + t1610 - t1618 + t1624 + t1630 - 0.35e2 / 0.9e1 * t1631 + t1665 - t1668 + t1670 + t1701 + t1715 - t1718 + t2213;
  t2385 = t1950 + t1828 + t1830 + t1869 - t1955 / 0.2e1 - t1960 / 0.2e1 + t1965 - t1972 + 0.7e1 / 0.3e1 * t1975 + t1874 + t1878 + t1882 - t1896 - t2220 / 0.12e2 - t2224 / 0.12e2;
  t2392 = -t457 + t460 - t462 - t464 + t467 + t1153 + t1154 + t7 * (t2270 + t2292 + t2332 + t2342 + t2351 + t2376 + t2379 + t2385) + t1984 + 0.14e2 / 0.3e1 * t925 - t1036 - 0.2e1 * t928 + t1051;
  t2394 = -t949 + t1985 - t723 + t1989 + t729 - t1991 + t1992 - t1056 - t1059 - t1061 + t1993 - t1995 - 0.16e2 * t956;
  t2399 = t2021 + 0.4e1 * t978 - t2022 - t2025 - t2026 - t2027 - t993 / 0.6e1 - t996 / 0.6e1 + t1996 - t1997 - t879 - t881 + t1072;
  t2401 = t2000 + t2001 - t884 - t886 - t2004 + t2233 - 0.2e1 * t1008 + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011;
  tv3rho32 = t2392 + t2394 + t2399 + t2401;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2411 = t1148 + t1149 + t1153 + t1154 + t1984 + 0.7e1 * t925 - 0.3e1 / 0.2e1 * t1035 - 0.3e1 * t928 + 0.3e1 * t1051 + t1985 + t1989 - t1991 + t1992 - t1055 / 0.8e1 - t1058 / 0.8e1 - t1060 / 0.4e1 + t1993 - t1995 - 0.24e2 * t954;
  t2419 = t1068 * t430;
  t2420 = t166 * t2419;
  t2421 = t1707 * t2420;
  t2422 = t153 * t2421;
  t2423 = 0.15e2 / 0.8e1 * t2422;
  t2424 = t1015 * t404;
  t2430 = -0.6e1 * t670 - 0.6e1 * t1294;
  t2434 = my_piecewise3(t58, 0, -0.1e2 / 0.27e2 * t1671 * t2424 + 0.1e2 / 0.3e1 * t930 * t1019 + 0.5e1 / 0.3e1 * t156 * t2430);
  t2435 = t1024 * t408;
  t2440 = -t2430;
  t2444 = my_piecewise3(t65, 0, -0.1e2 / 0.27e2 * t1681 * t2435 + 0.1e2 / 0.3e1 * t938 * t1027 + 0.5e1 / 0.3e1 * t159 * t2440);
  t2445 = t2434 + t2444;
  t2446 = t166 * t2445;
  t2447 = t390 * t2446;
  t2448 = t153 * t2447;
  t2449 = t2448 / 0.2e1;
  t2450 = t1032 * t430;
  t2451 = t1003 * t2450;
  t2452 = t1002 * t2451;
  t2453 = 0.9e1 / 0.4e1 * t2452;
  t2455 = -t1267 - t2423 - t2449 + t2453 + 0.3e1 * t2268 - t1273 - t1276 - t1281 + t1283 + t1286 + t1289;
  t2464 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1317 * t2424 + 0.4e1 / 0.3e1 * t958 * t1019 + 0.4e1 / 0.3e1 * t61 * t2430);
  t2472 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1330 * t2435 + 0.4e1 / 0.3e1 * t966 * t1027 + 0.4e1 / 0.3e1 * t66 * t2440);
  t2473 = t2464 + t2472;
  t2474 = t53 * t2473;
  t2475 = t2474 * t84;
  t2476 = t2475 / 0.24e2;
  t2477 = t1057 * t419;
  t2478 = t2477 / 0.8e1;
  t2479 = t413 * t1054;
  t2480 = t2479 / 0.8e1;
  t2483 = t74 * (t1295 + t1297 + t1299 + t1303) * t83;
  t2484 = t70 * t2483;
  t2485 = t2484 / 0.24e2;
  t2490 = 0.24e2 * t2039;
  t2491 = 0.3e1 * t2079;
  t2495 = 0.24e2 * t2107;
  t2496 = 0.6e2 * t2112;
  t2497 = 0.36e2 * t2114;
  t2498 = 0.96e2 * t2117;
  t2499 = 0.3e1 / 0.2e1 * t2120;
  t2500 = 0.7e1 * t2159;
  t2501 = 0.35e2 / 0.3e1 * t2161;
  t2502 = 0.9e1 / 0.4e1 * t2297 - 0.21e2 / 0.4e1 * t2299 - t2495 - t1527 - t1533 + t2496 + t2497 + t2498 - t2499 + t2500 - t2501;
  t2507 = 0.3e1 / 0.2e1 * t2165;
  t2508 = 0.3e1 * t2183;
  t2509 = 0.7e1 * t2187;
  t2510 = 0.3e1 / 0.2e1 * t2193;
  t2515 = -t1552 + t1560 - t1574 - t1577 + t1582 - t2353 / 0.4e1 - t2367 / 0.8e1 - t2369 / 0.8e1 + t1593 + t1603 + t1610;
  t2518 = t105 * t2473;
  t2519 = t2518 * t108;
  t2520 = t2220 / 0.8e1;
  t2521 = t2224 / 0.8e1;
  t2522 = t1828 + t1830 + t1869 + t1965 + t1874 + t1878 + t1882 - t1896 + t2519 - t2520 - t2521;
  t2527 = -0.24e2 * t956 + 0.6e1 * t978 - t993 / 0.4e1 - t996 / 0.4e1 + t1996 - t1997 + 0.9e1 / 0.4e1 * t1071 + t2000 + t2001 - t2003 - t2004 - 0.3e1 * t1008 + t7 * (t1950 + t1548 - t1535 - t1540 + 0.7e1 / 0.2e1 * t2290 + t1168 - t1544 - 0.12e2 * t2338 - t2510 - t2478 - t2480 + t2502 + t1211 + t1213 - t2476 + t1262 + t1157 + t1159 - t1718 + t1670 - t1170 - 0.12e2 * t2340 + t1624 - t2507 - t2508 + t2509 - 0.3e1 / 0.2e1 * t2288 + t1257 - t1260 + t1630 + 0.9e1 / 0.4e1 * t2285 - 0.3e1 / 0.2e1 * t2275 + t1701 + t1209 + t2515 - t2490 + t2491 + t2455 - t2485 + t1715 - t1618 + t1665 - t1668 + t2522) + t2005 - t2006 + t2007 + t2008 + t2009 + t2010 - t2011;
  tv3rho33 = t2411 + t2527;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2528 = t1087 * t716;
  t2529 = t1086 * t2528;
  t2530 = t2529 / 0.2e1;
  t2531 = t437 * t371;
  t2532 = t2531 * t1088;
  t2533 = t437 * t890;
  t2534 = t1079 * t386;
  t2535 = 0.14e2 / 0.3e1 * t2534;
  t2536 = t1003 * t697;
  t2537 = t1086 * t2536;
  t2538 = 0.3e1 / 0.4e1 * t2537;
  t2539 = t1083 * t399;
  t2541 = t113 * t690 * t152;
  t2542 = t2541 * t167;
  t2543 = t1083 * t386;
  t2544 = 0.2e1 * t2543;
  t2545 = t1079 * t143;
  t2546 = t2545 * t1088;
  t2547 = 0.7e1 / 0.3e1 * t2546;
  t2549 = t342 * t379 * t152;
  t2550 = t2549 * t167;
  t2551 = 0.14e2 / 0.3e1 * t2550;
  t2553 = t113 * t775 * t152;
  t2554 = t2553 * t167;
  t2555 = t780 * t152;
  t2556 = t2555 * t167;
  t2557 = 0.7e2 / 0.9e1 * t2556;
  t2558 = t1101 * t717;
  t2559 = t1097 * t2558;
  t2560 = t2559 / 0.4e1;
  t2562 = 0.1e1 / t439 / t280;
  t2563 = t145 * t2562;
  t2565 = t2563 * params->ftilde * t445;
  t2566 = 0.63e2 / 0.8e1 * t2565;
  t2567 = t1093 * t116;
  t2568 = t2567 * t1102;
  t2569 = 0.7e1 / 0.4e1 * t2568;
  t2570 = t2567 * t1098;
  t2571 = 0.7e1 / 0.2e1 * t2570;
  t2572 = t1958 * t382;
  t2573 = t1097 * t2572;
  t2574 = t2573 / 0.2e1;
  t2575 = t882 * t1088;
  t2576 = t1097 * t2575;
  t2577 = t2576 / 0.2e1;
  t2578 = t1953 * t382;
  t2579 = t1097 * t2578;
  t2580 = t2579 / 0.2e1;
  t2581 = t152 * t695;
  t2582 = t2581 * t698;
  t2583 = t1097 * t2582;
  t2584 = 0.3e1 / 0.8e1 * t2583;
  t2585 = -t2530 - t2532 + t2533 - t2535 + t2538 - t2539 + t2542 + t2544 + t2547 - t2551 + t2554 + t2557 + t2560 - t2566 - t2569 + t2571 - t2574 + t2577 - t2580 - t2584;
  tv3rho2sigma0 = t2585 * t7 - t1089 - t1099 - t1107 + t1108 + t1109 + t1110 + t1111;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2587 = 0.28e2 / 0.3e1 * t1080;
  t2588 = 0.4e1 * t1084;
  t2589 = 0.4e1 * t1085;
  t2591 = 0.7e1 * t1095;
  t2592 = 0.2e1 * t1099;
  t2593 = 0.2e1 * t2532;
  t2594 = 0.2e1 * t2533;
  t2595 = 0.28e2 / 0.3e1 * t2534;
  t2596 = 0.3e1 / 0.2e1 * t2537;
  t2597 = 0.2e1 * t2539;
  t2598 = 0.2e1 * t2542;
  t2599 = 0.4e1 * t2543;
  t2600 = 0.14e2 / 0.3e1 * t2546;
  t2601 = 0.28e2 / 0.3e1 * t2550;
  t2602 = 0.2e1 * t2554;
  t2603 = 0.14e3 / 0.9e1 * t2556;
  t2604 = t2559 / 0.2e1;
  t2605 = 0.63e2 / 0.4e1 * t2565;
  t2606 = 0.7e1 / 0.2e1 * t2568;
  t2607 = 0.7e1 * t2570;
  t2608 = 0.3e1 / 0.4e1 * t2583;
  t2609 = -t2529 - t2593 + t2594 - t2595 + t2596 - t2597 + t2598 + t2599 + t2600 - t2601 + t2602 + t2603 + t2604 - t2605 - t2606 + t2607 - t2573 + t2576 - t2579 - t2608;
  tv3rho2sigma1 = t2609 * t7 - 0.2e1 * t1089 + t1103 - t2587 + t2588 + t2589 + t2591 - t2592;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = tv3rho2sigma0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2611 = t1086 * t1005;
  t2613 = t1083 * t432;
  t2616 = t2567 * t1117;
  t2618 = t1101 * t947;
  t2619 = t1097 * t2618;
  t2622 = 0.3e1 / 0.4e1 * t2611 - t2613 / 0.2e1 - t2539 / 0.2e1 - t2566 - 0.7e1 / 0.8e1 * t2616 + t2619 / 0.4e1 - 0.7e1 / 0.8e1 * t2568 + t2571 - t2574 - t2580 - t2551 + t2554;
  t2623 = t2581 * t2210;
  t2624 = t1097 * t2623;
  t2626 = t882 * t1114;
  t2627 = t1097 * t2626;
  t2631 = t2545 * t1114;
  t2633 = t2531 * t1114;
  t2635 = t1087 * t946;
  t2636 = t1086 * t2635;
  t2639 = -0.3e1 / 0.8e1 * t2624 + t2627 / 0.4e1 + t2576 / 0.4e1 + t2542 - t2532 / 0.2e1 + t2557 + t2533 - t2535 + 0.7e1 / 0.6e1 * t2631 - t2633 / 0.2e1 - t2636 / 0.2e1 + t2544 + 0.7e1 / 0.6e1 * t2546;
  tv3rho2sigma3 = -t1107 + t1108 + t1109 - t1090 + t1110 - t1099 + t1104 - t1116 + t1119 + t7 * (t2622 + t2639);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2642 = 0.3e1 / 0.2e1 * t2611;
  t2643 = 0.7e1 / 0.4e1 * t2616;
  t2644 = t2619 / 0.2e1;
  t2645 = t2642 - t2613 - t2539 - t2605 - t2643 + t2644 - t2569 + t2607 - t2573 - t2579 - t2601 + t2602;
  t2646 = 0.3e1 / 0.4e1 * t2624;
  t2647 = t2627 / 0.2e1;
  t2648 = 0.7e1 / 0.3e1 * t2631;
  t2649 = -t2646 + t2647 + t2577 + t2598 - t2532 + t2603 + t2594 - t2595 + t2648 - t2633 - t2636 + t2599 + t2547;
  tv3rho2sigma4 = -t2587 + t2588 + t2589 - t1089 + t2591 - t2592 + t1111 - t1115 + t1122 + t7 * (t2645 + t2649);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = tv3rho2sigma3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2652 = t1087 * t1032;
  t2653 = t1086 * t2652;
  t2654 = t2653 / 0.2e1;
  t2655 = t1003 * t1068;
  t2656 = t1086 * t2655;
  t2657 = 0.3e1 / 0.4e1 * t2656;
  t2658 = t1101 * t1033;
  t2659 = t1097 * t2658;
  t2660 = t2659 / 0.4e1;
  t2661 = t2581 * t1069;
  t2662 = t1097 * t2661;
  t2663 = 0.3e1 / 0.8e1 * t2662;
  t2664 = -t2654 + t2657 - t2633 + t2648 - t2613 + t2533 - t2535 + t2542 + t2544 - t2551 + t2554 + t2557 + t2660 - t2566 + t2571 - t2574 - t2663 - t2643 + t2647 - t2580;
  tv3rho2sigma6 = t2664 * t7 - t1099 - t1107 + t1108 + t1109 + t1110 - t1115 + t1122;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t2667 = 0.3e1 / 0.2e1 * t2656;
  t2668 = 0.2e1 * t2633;
  t2669 = 0.14e2 / 0.3e1 * t2631;
  t2670 = 0.2e1 * t2613;
  t2671 = t2659 / 0.2e1;
  t2672 = 0.3e1 / 0.4e1 * t2662;
  t2673 = 0.7e1 / 0.2e1 * t2616;
  t2674 = -t2653 + t2667 - t2668 + t2669 - t2670 + t2594 - t2595 + t2598 + t2599 - t2601 + t2602 + t2603 + t2671 - t2605 + t2607 - t2573 - t2672 - t2673 + t2627 - t2579;
  tv3rho2sigma7 = t2674 * t7 - 0.2e1 * t1115 + t1118 - t2587 + t2588 + t2589 + t2591 - t2592;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  tv3rho2sigma8 = tv3rho2sigma6;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2676 = t1092 * params->ftilde;
  t2677 = t2676 * t115;
  t2678 = t2677 * t1129;
  t2679 = 0.21e2 / 0.8e1 * t2678;
  t2680 = t115 * t1127;
  t2681 = t1125 * t2680;
  t2682 = t2681 * t1098;
  t2683 = 0.3e1 / 0.4e1 * t2682;
  t2684 = t2681 * t1102;
  t2685 = 0.3e1 / 0.8e1 * t2684;
  t2688 = 0.1e1 / t126 / t280 * t1134;
  t2690 = t2688 * t1136 * t1139;
  t2691 = 0.7e1 / 0.6e1 * t2690;
  t2692 = t1136 * t348;
  t2693 = t1135 * t2692;
  t2694 = t2693 * t725;
  t2695 = t2694 / 0.4e1;
  t2696 = t1136 * t144;
  t2697 = t1135 * t2696;
  t2698 = t2697 * t1098;
  t2699 = t2698 / 0.4e1;
  t2700 = t2697 * t1102;
  t2701 = t2700 / 0.8e1;
  tv3rhosigma20 = -t1131 + t1141 + t7 * (t2679 - t2683 + t2685 - t2691 - t2695 + t2699 - t2701);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t2704 = 0.21e2 / 0.4e1 * t2678;
  t2705 = 0.3e1 / 0.2e1 * t2682;
  t2706 = 0.3e1 / 0.4e1 * t2684;
  t2707 = 0.7e1 / 0.3e1 * t2690;
  t2708 = t2694 / 0.2e1;
  t2709 = t2698 / 0.2e1;
  t2710 = t2700 / 0.4e1;
  tv3rhosigma21 = -t1143 + t1144 + t7 * (t2704 - t2705 + t2706 - t2707 - t2708 + t2709 - t2710);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = tv3rhosigma20;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  t2713 = 0.21e2 / 0.2e1 * t2678;
  t2714 = 0.3e1 * t2682;
  t2715 = 0.3e1 / 0.2e1 * t2684;
  t2716 = 0.14e2 / 0.3e1 * t2690;
  t2717 = t2700 / 0.2e1;
  tv3rhosigma23 = -t1146 + t1140 + t7 * (t2713 - t2714 + t2715 - t2716 - t2694 + t2698 - t2717);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = tv3rhosigma21;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = tv3rhosigma22;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2720 = t2681 * t1117;
  t2721 = 0.3e1 / 0.8e1 * t2720;
  t2722 = t2697 * t1117;
  t2723 = t2722 / 0.8e1;
  tv3rhosigma26 = -t1131 + t1141 + t7 * (t2679 - t2683 + t2721 - t2691 - t2695 + t2699 - t2723);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  t2726 = 0.3e1 / 0.4e1 * t2720;
  t2727 = t2722 / 0.4e1;
  tv3rhosigma27 = -t1143 + t1144 + t7 * (t2704 - t2705 + t2726 - t2707 - t2708 + t2709 - t2727);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = tv3rhosigma26;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  t2730 = 0.3e1 / 0.2e1 * t2720;
  t2731 = t2722 / 0.2e1;
  tv3rhosigma29 = -t1146 + t1140 + t7 * (t2713 - t2714 + t2730 - t2716 - t2694 + t2698 - t2731);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = tv3rhosigma27;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = tv3rhosigma28;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2735 = 0.1e1 / t145 / t111;
  t2737 = t2735 * t152 * t382;
  t2738 = t1126 * t2737;
  t2739 = 0.3e1 / 0.8e1 * t2738;
  t2740 = 0.1e1 / t111;
  t2741 = t1136 * t2740;
  t2742 = t1135 * t2741;
  t2743 = t2742 * t1139;
  t2744 = 0.3e1 / 0.8e1 * t2743;
  t2745 = t147 * t147;
  t2746 = t2745 * t2745;
  t2747 = t2746 * t147;
  t2750 = t1134 * params->ftilde;
  t2751 = 0.1e1 / t2747 / t280 * t2750;
  t2752 = t1136 * t115;
  t2753 = t2752 * t348;
  t2754 = t2751 * t2753;
  t2755 = t2754 * t1129;
  t2756 = t2755 / 0.8e1;
  tv3sigma30 = t7 * (t2739 + t2744 - t2756);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t2758 = 0.3e1 / 0.4e1 * t2738;
  t2759 = 0.3e1 / 0.4e1 * t2743;
  t2760 = t2755 / 0.4e1;
  tv3sigma31 = t7 * (t2758 + t2759 - t2760);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = tv3sigma30;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  t2762 = 0.3e1 / 0.2e1 * t2738;
  t2763 = 0.3e1 / 0.2e1 * t2743;
  t2764 = t2755 / 0.2e1;
  tv3sigma33 = t7 * (t2762 + t2763 - t2764);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = tv3sigma31;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = tv3sigma32;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  t2766 = 0.3e1 * t2738;
  t2767 = 0.3e1 * t2743;
  tv3sigma36 = t7 * (t2766 + t2767 - t2755);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = tv3sigma33;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = tv3sigma34;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = tv3sigma35;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2769 = 0.384e3 * t1156;
  t2770 = 0.144e3 * t1158;
  t2771 = 0.63625193080042832287e0 * t1167;
  t2772 = 0.28e2 * t1169;
  t2773 = 0.4e1 * t1209;
  t2774 = 0.28e3 / 0.3e1 * t1210;
  t2775 = 0.82908533333333333336e-1 * t1212;
  t2776 = 0.41454266666666666668e-1 * t1256;
  t2777 = 0.19441031218901976532e0 * t1259;
  t2778 = 0.27636177777777777779e-1 * t1261;
  t2780 = 0.92120592592592592596e-2 * t1266;
  t2782 = 0.96e2 * t1272;
  t2783 = 0.576e3 * t1275;
  t2784 = 0.10645795064745113729e0 * t1280;
  t2785 = 0.73578453447456598423e1 * t1282;
  t2786 = 0.41454266666666666668e-1 * t1285;
  t2787 = 0.27636177777777777779e-1 * t1288;
  t2791 = -t2780 - 0.384e3 * t1268 + t2782 - t2783 - t2784 + t2785 + t2786 + t2787 - t1290 / 0.2e1 - t1292 / 0.2e1 - t1307 / 0.6e1;
  t2798 = t1526 / 0.6e1;
  t2799 = 0.364e4 / 0.27e2 * t1532;
  t2800 = t1583 * t337;
  t2803 = t1948 * t274 * t108;
  t2806 = 0.28e2 / 0.3e1 * t344 * t1208;
  t2807 = t2 * t281;
  t2811 = t186 * t1249;
  t2814 = t6 * t780;
  t2816 = t4 * t2814 * t16;
  t2818 = t587 * t587;
  t2821 = t4 * t2814;
  t2822 = 0.7e2 / 0.81e2 * t2821;
  t2826 = 0.1e1 / t13 / t2 / t55 / 0.48e2;
  t2827 = t2826 * t2;
  t2829 = t2827 * t1529 * t175;
  t2831 = t1242 * t281;
  t2833 = t125 * t1133;
  t2834 = t487 * t2833;
  t2836 = t118 * t780;
  t2837 = t182 * t2836;
  t2839 = t2822 - 0.10354e1 * t2829 + 0.993984e1 * t2831 - 0.36814222222222222222e1 * t2834 + 0.32212444444444444444e1 * t2837;
  t2842 = 0.1e1 / t1229 / t15;
  t2844 = t581 * t581;
  t2847 = t581 * t587;
  t2858 = t780 * t2;
  t2864 = t175 * t342 * t177 * t186;
  t2868 = t175 * t113 * t579 * t581;
  t2871 = t175 * t1218 * t587;
  t2873 = 0.8e1 * t641 * t2811 + 0.185e3 / 0.864e3 * t2816 + 0.6e1 * t641 * t2818 - t213 * t2839 + 0.24e2 * t29 * t2842 * t2844 - 0.36e2 * t1860 * t2847 - 0.4e1 * t1834 * t118 * t632 * t587 + 0.8e1 / 0.3e1 * t630 * t1163 * t1165 * t186 - 0.11e2 / 0.648e3 * t1496 * t2858 * t16 + 0.11e2 / 0.54e2 * t2864 + t2868 / 0.6e1 - t2871 / 0.12e2;
  t2876 = t5 * t1133;
  t2877 = t547 * t2876;
  t2888 = t1529 * t1 * t118;
  t2926 = 0.16e2 / 0.3e1 * t209 * t2831 - 0.16e3 / 0.81e2 * t636 * t2877 + 0.14e3 / 0.81e2 * t210 * t2821 - t1496 * t1497 * t177 * t186 / 0.108e3 - 0.5e1 / 0.9e1 * t209 * t2827 * t2888 - 0.4e1 / 0.3e1 * t1833 * t487 * t125 * t489 * t581 + 0.2e1 / 0.3e1 * t1838 * t125 * t489 * t587 - 0.4e1 / 0.3e1 * t631 * t118 * t113 * t587 + 0.2e1 / 0.3e1 * t631 * t118 * t170 * t1249 + 0.4e1 * t28 * t1230 * t182 * t118 * t170 * t1232 + 0.8e1 / 0.3e1 * t1834 * t118 * t113 * t581 - 0.16e2 / 0.9e1 * t1838 * t125 * t1175 * t186 + 0.56e2 / 0.27e2 * t631 * t118 * t342 * t186;
  t2930 = 0.96902277115443742139e-3 * (t2873 + t2926) * t216 * t15;
  t2936 = 0.29070683134633122642e-2 * t646 * t587;
  t2938 = 0.96902277115443742139e-3 * t217 * t1249;
  t2940 = 0.29070683134633122642e-2 * t1867 * t186;
  t2944 = t4 * t2814 * t89;
  t2946 = t296 * t1749;
  t2949 = t479 * t496;
  t2957 = 0.1e1 / t1735 / t88;
  t2959 = t479 * t479;
  t2962 = t496 * t496;
  t2969 = t2822 - 0.19612277777777777777e1 * t2829 + 0.18827786666666666666e2 * t2831 - 0.69732543209876543208e1 * t2834 + 0.61015975308641975307e1 * t2837;
  t2980 = t175 * t342 * t293 * t296;
  t2984 = t175 * t113 * t477 * t479;
  t2987 = t175 * t1724 * t496;
  t2989 = 0.185e3 / 0.864e3 * t2944 + 0.8e1 * t554 * t2946 - 0.36e2 * t1936 * t2949 - 0.4e1 * t1910 * t118 * t542 * t496 + 0.24e2 * t101 * t2957 * t2959 + 0.6e1 * t554 * t2962 - t321 * t2969 + 0.8e1 / 0.3e1 * t540 * t1163 * t1165 * t296 - 0.11e2 / 0.648e3 * t1496 * t2858 * t89 + 0.11e2 / 0.54e2 * t2980 + t2984 / 0.6e1 - t2987 / 0.12e2;
  t3038 = 0.16e2 / 0.3e1 * t317 * t2831 - t1496 * t1497 * t293 * t296 / 0.108e3 - 0.16e3 / 0.81e2 * t546 * t2877 + 0.14e3 / 0.81e2 * t318 * t2821 + 0.8e1 / 0.3e1 * t1910 * t118 * t113 * t479 - 0.16e2 / 0.9e1 * t1914 * t125 * t1175 * t296 + 0.56e2 / 0.27e2 * t541 * t118 * t342 * t296 + 0.4e1 * t100 * t1736 * t182 * t118 * t170 * t1738 - 0.4e1 / 0.3e1 * t541 * t118 * t113 * t496 + 0.2e1 / 0.3e1 * t541 * t118 * t170 * t1749 - 0.5e1 / 0.9e1 * t317 * t2827 * t2888 - 0.4e1 / 0.3e1 * t1909 * t487 * t125 * t489 * t479 + 0.2e1 / 0.3e1 * t1914 * t125 * t489 * t496;
  t3044 = 0.50245625170970829257e-3 * t653 * t1240;
  t3048 = 0.20435174860777645786e0 * t603 * t780 * t204 * t175;
  t3052 = 0.77340987998746992661e1 * t621 * t780 * t625 * t175;
  t3053 = t2814 * t535;
  t3056 = -0.13244423704918215444e1 * t1899 * t2807 * t312 - t2930 + 0.67436012866278355149e-2 * t559 * t496 + 0.22478670955426118383e-2 * t325 * t1749 - t2936 - t2938 - t2940 + 0.67436012866278355149e-2 * t1943 * t296 + 0.22478670955426118383e-2 * (t2989 + t3038) * t324 * t88 - t3044 - t3048 + t3052 + 0.12013086738172484016e0 * t1766 * t3053;
  t3115 = 0.7e2 / 0.81e2 * t2944 + 0.28e2 / 0.27e2 * t2980 + 0.4e1 / 0.3e1 * t2984 - 0.2e1 / 0.3e1 * t2987 + 0.2e1 * t175 * t170 * t1736 * t1738 - 0.2e1 * t175 * t1728 * t1742 + t175 * t472 * t1749 / 0.3e1 + 0.6e1 * t175 * t9 * t2957 * t2959 - 0.9e1 * t175 * t1737 * t2949 + 0.3e1 / 0.2e1 * t175 * t478 * t2962 + 0.2e1 * t175 * t478 * t2946 - t175 * t294 * t2969 / 0.4e1;
  t3122 = -0.4760414749815160116e1 * t533 * t3053 + 0.14985780636950745589e-2 * t564 * t88 * t1243 + 0.51817833333333333333e-2 * t302 * t505 * t496 - 0.34545222222222222222e-2 * t302 * t1264 * t296 + 0.19191790123456790123e-2 * t302 * t548 * t88 - 0.34545222222222222222e-2 * t502 * t1763 + 0.21269256817794009175e0 * t515 * t2814 * t312 + 0.1554535e-1 * t1755 * t509 + 0.51817833333333333333e-2 * t302 * t194 * t1749 + 0.10363566666666666667e-1 * t502 * t1775 + 0.1554535e-1 * t502 * t1772 + 0.51817833333333333333e-2 * t3115 * t122 * t192 * t303 + 0.51817833333333333333e-2 * t1755 * t506;
  t3125 = 0.1e1 / t529 / t512;
  t3129 = t122 * t192 * t5;
  t3133 = 0.1e1 / t1789 / t95;
  t3141 = t534 * t534;
  t3149 = 0.47129772651883579471e0 * t610 * t125 * t1133 * t204;
  t3153 = 0.41238551070398132037e0 * t201 * t118 * t780 * t204;
  t3156 = 0.19517290952032708503e0 * t1278 * t2814 * t625;
  t3158 = 0.10363566666666666667e-1 * t1255 * t596;
  t3161 = 0.69090444444444444446e-2 * t193 * t1264 * t186;
  t3164 = 0.10363566666666666667e-1 * t193 * t505 * t587;
  t3166 = 0.69090444444444444446e-2 * t593 * t1265;
  t3169 = 0.38383580246913580248e-2 * t193 * t548 * t15;
  t3171 = 0.31090700000000000001e-1 * t1255 * t599;
  t3173 = 0.20727133333333333334e-1 * t593 * t1287;
  t3174 = -0.65525927662759003726e-1 * t3125 * t1133 * t535 * t3129 + 0.68440383742387934953e1 * t3133 * t1133 * t1794 * t3129 - 0.1312980037839818214e3 / t1789 / t512 * t1133 / t3141 * t3129 - t3149 + t3153 - t3156 - t3158 + t3161 - t3164 + t3166 - t3169 - t3171 - t3173;
  t3176 = 0.31090700000000000001e-1 * t593 * t1284;
  t3179 = 0.10363566666666666667e-1 * t193 * t194 * t1249;
  t3210 = 0.7e2 / 0.81e2 * t2816 + 0.28e2 / 0.27e2 * t2864 + 0.4e1 / 0.3e1 * t2868 - 0.2e1 / 0.3e1 * t2871 + 0.2e1 * t175 * t170 * t1230 * t1232 - 0.2e1 * t175 * t1222 * t1236 + t175 * t574 * t1249 / 0.3e1 + 0.6e1 * t175 * t9 * t2842 * t2844 - 0.9e1 * t175 * t1231 * t2847 + 0.3e1 / 0.2e1 * t175 * t580 * t2818 + 0.2e1 * t175 * t580 * t2811 - t175 * t178 * t2839 / 0.4e1;
  t3214 = 0.10363566666666666667e-1 * t3210 * t122 * t192 * t195;
  t3216 = 0.1e1 / t1594 / t22;
  t3220 = 0.18802527823203489287e2 * t3216 * t1133 * t1599 * t3129;
  t3224 = t624 * t624;
  t3228 = 0.60995923043525943529e3 / t1594 / t602 * t1133 / t3224 * t3129;
  t3230 = 0.1e1 / t619 / t602;
  t3234 = 0.10645795064745113728e0 * t3230 * t1133 * t625 * t3129;
  t3237 = 0.64601518076962494762e-3 * t651 * t15 * t1243;
  t3240 = 0.19441031218901976532e0 * t1606 * t2876 * t1607;
  t3244 = t192 * t5;
  t3247 = 0.17673664744456342301e-1 * t621 * t2 * t1133 * t204 * t122 * t3244;
  t3253 = 0.23411326096918008589e1 * t3230 * t2 * t1133 * t625 * t122 * t3244;
  t3257 = 0.12112784639430467768e-3 * t645 * t1589 * t15 * t483;
  t3260 = 0.12112784639430467768e-3 * t1590 * t186 * t483;
  t3266 = 0.67508438032335735592e2 * t3216 * t2 * t1133 * t1599 * t122 * t3244;
  t3267 = -t3176 - t3179 - t3214 - t3220 + t3228 + t3234 - t3237 + t3240 - t3247 + t3253 - t3257 - t3260 - t3266;
  t3271 = t2876 * t1600;
  t3273 = 0.26860754033147841838e1 * t1596 * t192 * t3271;
  t3274 = t2876 * t1615;
  t3276 = 0.17168305804406539632e2 * t1614 * t3274;
  t3278 = 0.37129640917784654576e3 * t1597 * t3271;
  t3281 = 0.12725038616008566457e1 * t1164 * t2807 * t204;
  t3286 = 0.53020994233369026904e-1 * t1604 * t2 * t281 * t204 * t486;
  t3291 = 0.46822652193836017178e1 * t1612 * t2 * t281 * t625 * t486;
  t3311 = 0.10126265704850360339e3 * t1595 * t2 * t281 * t1599 * t486;
  t3314 = 0.16200859349084980444e-1 * t1620 * t2814 * t1621;
  t3316 = 0.14804514559303905049e-3 * t1591 * t1240;
  t3319 = -t3273 - t3276 + t3278 + t3281 - t3286 + t3291 + 0.55185098770492564348e-1 * t1805 * t2 * t281 * t312 * t486 - 0.28819808215097185566e1 * t1815 * t2 * t281 * t535 * t486 + 0.36859166875534672576e2 * t1790 * t2 * t281 * t1794 * t486 - t3311 + t3314 + t3316 - 0.34342413959678791975e-3 * t1802 * t1240;
  t3325 = t2876 * t1818;
  t3329 = t2876 * t1795;
  t3371 = -0.42921743488160883383e0 * t309 * t118 * t780 * t312 - 0.76446915606552171013e-1 * t1816 * t192 * t3325 + 0.9777197677483990707e0 * t1791 * t192 * t3329 + 0.10567263012202301374e2 * t1817 * t3325 - 0.13515027854362713278e3 * t1792 * t3329 - 0.16862113513206061329e-1 * t1822 * t2814 * t1823 + 0.49053421129326723867e0 * t520 * t125 * t1133 * t312 + 0.28098338694282647979e-3 * t1801 * t296 * t483 - 0.20234536215847273594e0 * t1807 * t2876 * t1808 + 0.18395032923497521449e-1 * t531 * t2 * t1133 * t312 * t122 * t3244 - 0.14409904107548592783e1 * t3125 * t2 * t1133 * t535 * t122 * t3244 + 0.24572777917023115051e2 * t3133 * t2 * t1133 * t1794 * t122 * t3244 + 0.28098338694282647979e-3 * t558 * t1800 * t88 * t483;
  t3375 = 0.12420094242202632684e0 * t1613 * t192 * t3274;
  t3377 = 0.6460151807696249476e-3 * t1880 * t483;
  t3379 = 0.6460151807696249476e-3 * t1872 * t483;
  t3381 = 0.43067678717974996507e-3 * t1876 * t1503;
  t3385 = 0.3230075903848124738e-3 * t651 * t186 * t486 * t549;
  t3388 = 0.3230075903848124738e-3 * t1879 * t1875 * t549;
  t3392 = t1277 * t6 * t1497;
  t3394 = 0.67293247996835932044e-5 * t1590 * t15 * t1 * t3392;
  t3410 = t3375 + t3377 + t3379 + t3381 - t3385 - t3388 - t3394 + 0.11655607162072802125e-2 * t566 * t1240 - 0.14985780636950745589e-2 * t1888 * t483 - 0.99905204246338303925e-3 * t1892 * t1503 - 0.14985780636950745589e-2 * t1884 * t483 + 0.15610188163490359988e-4 * t1801 * t88 * t1 * t3392 + 0.74928903184753727944e-3 * t1883 * t1891 * t549;
  t3420 = t1133 * t2;
  t3425 = t2 * t1529;
  t3437 = t125 * t1175 * t181;
  t3450 = 0.44184161861140855756e-2 * t1605 * t3244 * t3420 * t1607;
  t3457 = 0.53834598397468745633e-4 * t215 / t1588 / t28 * t15 * t122 * t3437;
  t3461 = 0.4845113855772187107e-3 * t1866 * t650 * t652 * t179;
  t3464 = 0.9690227711544374214e-3 * t1879 * t1871 * t179;
  t3470 = 0.13255248558342256727e0 * t199 * t2826 * t3425 * t204 * t1 * t118;
  t3474 = 0.4845113855772187107e-3 * t651 * t587 * t181 * t179;
  t3475 = 0.74928903184753727944e-3 * t564 * t296 * t486 * t549 + 0.11239335477713059192e-2 * t1942 * t563 * t565 * t179 + 0.45987582308743803624e-2 * t1806 * t3244 * t3420 * t1808 + 0.13796274692623141087e0 * t307 * t2826 * t3425 * t312 * t1 * t118 + 0.12488150530792287991e-3 * t323 / t1799 / t100 * t88 * t122 * t3437 + 0.22478670955426118383e-2 * t1883 * t1887 * t179 + 0.11239335477713059192e-2 * t564 * t496 * t181 * t179 - t3450 - t3457 - t3461 - t3464 - t3470 - t3474;
  t3480 = (t3056 + t3122 + t3174 + t3267 + t3319 + t3371 + t3410 + t3475) * t69 * t108;
  t3481 = t1531 * t399;
  t3485 = 0.364e4 / 0.27e2 * t1530 * t379 * t383;
  t3489 = 0.24e2 * t79;
  t3490 = t54 * t281;
  t3491 = 0.384e3 * t3490;
  t3492 = t75 * t662;
  t3493 = 0.144e4 * t3492;
  t3494 = t278 * t1301;
  t3495 = 0.192e4 * t3494;
  t3496 = t78 * t78;
  t3497 = 0.1e1 / t3496;
  t3499 = 0.84e3 * t76 * t3497;
  t3505 = t465 * t663;
  t3507 = t57 * t57;
  t3509 = 0.1e1 / t156 / t3507;
  t3510 = t667 * t667;
  t3516 = t673 * t673;
  t3522 = -0.24e2 * t79 + 0.24e2 * t3490;
  t3526 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3509 * t3510 - 0.16e2 / 0.9e1 * t1317 * t667 * t673 + 0.4e1 / 0.3e1 * t666 * t3516 + 0.16e2 / 0.9e1 * t1321 * t1325 + 0.4e1 / 0.3e1 * t61 * t3522);
  t3527 = t64 * t64;
  t3529 = 0.1e1 / t159 / t3527;
  t3530 = t679 * t679;
  t3536 = t682 * t682;
  t3541 = -t3522;
  t3545 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3529 * t3530 - 0.16e2 / 0.9e1 * t1330 * t679 * t682 + 0.4e1 / 0.3e1 * t678 * t3536 + 0.16e2 / 0.9e1 * t1334 * t1337 + 0.4e1 / 0.3e1 * t66 * t3541);
  t3546 = t3526 + t3545;
  t3550 = t658 * t687 * t108;
  t3552 = t1578 * t337;
  t3554 = t331 * t1575;
  t3556 = t688 * t455;
  t3558 = t688 * t663;
  t3560 = t329 * t1274;
  t3561 = 0.576e3 * t3560;
  t3562 = t261 * t1306;
  t3564 = -t275 * t1306 / 0.6e1 - t70 * t74 * (-t3489 + t3491 - t3493 + t3495 - t3499) * t83 / 0.24e2 + 0.24e3 * t3505 + t105 * t3546 * t108 + 0.6e1 * t3550 - 0.48e2 * t3552 - 0.48e3 * t3554 + 0.72e2 * t3556 + 0.12e3 * t3558 - t3561 - t3562 / 0.6e1;
  t3567 = 0.48e3 * t329 * t1575;
  t3568 = t1578 * t334;
  t3572 = 0.84e3 * t106 * t107 * t3497;
  t3574 = t106 * t333 * t1301;
  t3575 = 0.192e4 * t3574;
  t3576 = t344 * t1693;
  t3578 = t344 * t1696;
  t3582 = 0.28e2 / 0.3e1 * t343 * t1699 * t383;
  t3583 = t690 * t690;
  t3585 = t114 * t3583 * t383;
  t3586 = t344 * t1710;
  t3590 = 0.28e2 / 0.3e1 * t343 * t1663 * t383;
  t3592 = t716 * t716;
  t3597 = t344 * t1626;
  t3599 = t782 * t699;
  t3601 = t693 * t693;
  t3603 = 0.1e1 / t163 / t3601;
  t3604 = t143 * t3603;
  t3605 = t697 * t697;
  t3612 = 0.14e3 / 0.3e1 * t781 * t690 * t383;
  t3613 = t775 * t775;
  t3616 = 0.3e1 * t114 * t3613 * t383;
  t3617 = t782 * t718;
  t3621 = 0.14e3 / 0.3e1 * t781 * t775 * t383;
  t3625 = t736 * t736;
  t3642 = t767 * t767;
  t3684 = t756 * t756;
  t3690 = t765 * t765;
  t3704 = (0.7e2 / 0.81e2 * t117 * t2836 + 0.22e3 / 0.81e2 * t123 * t2833) * t141 - 0.4e1 * t1179 * t361 * t369 + 0.12e2 * t748 * t754 * t756 - 0.6e1 * t1181 * t765 - 0.24e2 * t358 * t1190 * t1192 + 0.24e2 * t1184 * t1195 - 0.4e1 * t750 * t1204 + 0.24e2 * t131 / t1189 / t140 * t3684 - 0.36e2 * t1191 * t756 * t765 + 0.6e1 * t755 * t3690 + 0.8e1 * t755 * t369 * t1204 - t362 * (0.7e2 / 0.81e2 * t132 * t2836 + 0.22e3 / 0.81e2 * t135 * t2833 + 0.57295779513082320876e5 * params->mbeta * t281);
  t3712 = -0.24e2 * t116 / t1635 / t143 * t350 * t3625 - 0.28e2 * t1637 * t740 * t1638 + 0.36e2 * t1637 * t350 * t736 * t767 - 0.91e2 / 0.3e1 * t735 * t1649 * t736 + 0.28e2 * t735 * t740 * t1645 - 0.6e1 * t735 * t350 * t3642 - 0.8e1 * t735 * t350 * t371 * t1206 - 0.1729e4 / 0.54e2 * t349 * t145 * t1659 * t371 + 0.91e2 / 0.6e1 * t349 * t1649 * t767 - 0.14e2 / 0.3e1 * t349 * t740 * t1206 + t349 * t350 * t3704 - 0.43225e5 / 0.1296e4 * t116 * t146 / t147 / t280;
  t3714 = t114 * t3712 * t383;
  t3715 = t329 * t1271;
  t3716 = 0.96e2 * t3715;
  t3717 = t331 * t1271;
  t3719 = 0.9e1 / 0.4e1 * t153 * t696 * t166 * t3592 - 0.21e2 * t3597 + 0.35e2 * t3599 + 0.105e3 / 0.16e2 * t153 * t3604 * t166 * t3605 + t3612 + t3616 - 0.7e2 / 0.3e1 * t3617 + t3621 + t3714 + t3716 + 0.96e2 * t3717;
  t3723 = t328 * t1342 * t108;
  t3725 = t398 * t716;
  t3727 = t883 * t696 * t3725;
  t3731 = t883 * t390 * t398 * t775;
  t3735 = 0.24e2 * t106 * t74 * t79;
  t3736 = t874 * t902;
  t3738 = t688 * t458;
  t3740 = t331 * t1274;
  t3742 = t331 * t1572;
  t3744 = t2184 * t1967;
  t3746 = t1974 * t718;
  t3749 = t1663 * t152;
  t3750 = t114 * t3749;
  t3751 = t3750 * t399;
  t3756 = 0.4e1 * t114 * t1663 * t379 * t383;
  t3757 = t343 * t1958;
  t3758 = t3757 * t399;
  t3762 = 0.28e2 * t343 * t1962 * t383;
  t3763 = t1959 * t722;
  t3766 = 0.12e2 * t1963 * t725;
  t3771 = t883 * t1693;
  t3773 = t2180 * t1967;
  t3775 = t883 * t1696;
  t3778 = t165 * t166 * t775;
  t3780 = 0.6e1 * t1954 * t3778;
  t3781 = 0.3e1 * t1002 * t1003 * t1691 * t397 - 0.2e1 * t3751 + t3756 + 0.14e2 * t3758 - t3762 - 0.6e1 * t3763 + t3766 - 0.2e1 * t3771 + 0.9e1 * t3773 - 0.6e1 * t3775 + t3780;
  t3783 = t1974 * t722;
  t3785 = t883 * t1554;
  t3791 = t781 * t882;
  t3792 = t3791 * t399;
  t3794 = t1959 * t718;
  t3796 = t465 * t455;
  t3798 = t1977 * t334;
  t3800 = t1977 * t337;
  t3805 = 0.4e1 * t380 * t152 * t1206 * t382;
  t3806 = t1206 * t389;
  t3808 = t153 * t3806 * t398;
  t3810 = 0.28e2 * t3783 + t3044 - 0.6e1 * t3785 - 0.45e2 / 0.4e1 * t1002 * t2167 * t697 * t716 - 0.14e3 / 0.3e1 * t3792 - 0.3e1 * t3794 + 0.144e3 * t3796 + 0.16e2 * t3798 - 0.16e2 * t3800 + t3805 - 0.2e1 * t3808;
  t3811 = t1314 * t286;
  t3814 = t873 * t687 * t84;
  t3816 = t877 * t902;
  t3821 = t260 * t1342 * t84;
  t3828 = t1311 * t286;
  t3831 = 0.12e3 * t659 * t663;
  t3832 = t465 * t458;
  t3834 = -t3811 / 0.2e1 - t3814 / 0.4e1 - t3816 / 0.2e1 - t905 * t902 / 0.4e1 - t3821 / 0.6e1 - t53 * t3546 * t84 / 0.24e2 - t1343 * t286 / 0.6e1 - t3828 / 0.2e1 + t3831 - 0.384e3 * t3832 + t3048;
  t3838 = t371 * t1706;
  t3840 = t153 * t3838 * t1709;
  t3843 = 0.4e1 * t1700 * t725;
  t3845 = 0.1e1 / t61 / t3507;
  t3858 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3845 * t3510 - 0.2e2 / 0.9e1 * t1671 * t667 * t673 + 0.1e2 / 0.3e1 * t702 * t3516 + 0.4e2 / 0.9e1 * t1674 * t1325 + 0.5e1 / 0.3e1 * t156 * t3522);
  t3860 = 0.1e1 / t66 / t3527;
  t3873 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3860 * t3530 - 0.2e2 / 0.9e1 * t1681 * t679 * t682 + 0.1e2 / 0.3e1 * t709 * t3536 + 0.4e2 / 0.9e1 * t1684 * t1337 + 0.5e1 / 0.3e1 * t159 * t3541);
  t3880 = t153 * t1553 * t717;
  t3883 = t153 * t721 * t1692;
  t3886 = 0.6e1 * t776 * t1558;
  t3888 = 0.28e2 * t1666 * t725;
  t3890 = 0.4e1 * t1664 * t725;
  t3893 = 0.16e2 * t1949 * t337;
  t3894 = -t3153 + t3156 + t3158 - t3161 + t3164 - t3166 + t3169 - t3893 + t3171 + t3173 + t3176;
  t3896 = t1583 * t334;
  t3898 = t329 * t1572;
  t3899 = 0.96e3 * t3898;
  t3901 = 0.14e3 / 0.3e1 * t782 * t890;
  t3902 = t659 * t458;
  t3903 = 0.192e3 * t3902;
  t3906 = t106 * t1270 * t281;
  t3907 = 0.384e3 * t3906;
  t3909 = t106 * t454 * t662;
  t3910 = 0.144e4 * t3909;
  t3911 = t659 * t455;
  t3912 = 0.72e2 * t3911;
  t3914 = 0.28e2 * t730 * t1558;
  t3915 = t344 * t1554;
  t3917 = -t3907 + t3910 + t3912 - t3914 + 0.14e2 * t3915 - t3240 + t3247 - t3253 + t3257 + t3260 + t3266;
  t3920 = t767 * t695;
  t3922 = t153 * t3920 * t698;
  t3925 = 0.6e1 * t691 * t1558;
  t3926 = t782 * t722;
  t3930 = t153 * t3704 * t164 * t166;
  t3937 = 0.1456e5 / 0.81e2 * t111 / t8 / t661 * t152 * t167;
  t3966 = 0.1e1 / t1407 / t42;
  t3990 = t2876 * t1438;
  t3993 = -0.12069699849886775352e2 * t1352 * t2807 * t243 + 0.502904160411948973e0 * t1427 * t2 * t281 * t243 * t486 - 0.59538951722280479408e2 * t1435 * t2 * t281 * t839 * t486 + 0.17262444902721173647e4 * t1408 * t2 * t281 * t1413 * t486 - 0.39114768032040475677e1 * t240 * t118 * t780 * t243 - 0.15366516012587329731e0 * t1443 * t2814 * t1444 - 0.63255163015315141761e-4 * t1421 * t1240 + 0.11508296601814115764e4 * t3966 * t2 * t1133 * t1413 * t122 * t3244 + 0.51754224285257843261e-4 * t859 * t1419 * t36 * t483 + 0.51754224285257843261e-4 * t1420 * t227 * t483 - 0.18439819215104795676e1 * t1429 * t2876 * t1430 + 0.16763472013731632433e0 * t835 * t2 * t1133 * t243 * t122 * t3244 - 0.15793197455184422483e1 * t1436 * t192 * t3990;
  t3995 = t2876 * t1414;
  t4035 = 0.1e1 / t833 / t816;
  t4042 = 0.45790057268659451785e2 * t1409 * t192 * t3995 + 0.21830948964836175782e3 * t1437 * t3990 - 0.63295631309977636704e4 * t1410 * t3995 + 0.20701689714103137304e-3 * t865 * t801 * t181 * t179 + 0.13801126476068758203e-3 * t865 * t227 * t486 * t549 + 0.28752346825143246256e-5 * t1420 * t36 * t1 * t3392 + 0.21468418962773623871e-3 * t867 * t1240 + 0.41908680034329081084e-1 * t1428 * t3244 * t3420 * t1430 + 0.20701689714103137304e-3 * t1514 * t864 * t866 * t179 + 0.41403379428206274609e-3 * t1453 * t1457 * t179 + 0.13801126476068758203e-3 * t1453 * t1461 * t549 + 0.44702592036617686488e1 * t824 * t125 * t1133 * t243 - 0.29769475861140239704e2 * t4035 * t2 * t1133 * t839 * t122 * t3244;
  t4053 = t4 * t2814 * t37;
  t4089 = -t1496 * t1497 * t224 * t227 / 0.108e3 - 0.16e3 / 0.81e2 * t850 * t2877 + 0.14e3 / 0.81e2 * t249 * t2821 + 0.185e3 / 0.864e3 * t4053 - 0.4e1 * t1478 * t118 * t846 * t801 - 0.16e2 / 0.9e1 * t1482 * t125 * t1175 * t227 + 0.56e2 / 0.27e2 * t845 * t118 * t342 * t227 + 0.4e1 * t47 * t1385 * t182 * t118 * t170 * t1387 + 0.8e1 / 0.3e1 * t1478 * t118 * t113 * t795 - 0.5e1 / 0.9e1 * t248 * t2827 * t2888 - 0.4e1 / 0.3e1 * t1477 * t487 * t125 * t489 * t795 + 0.2e1 / 0.3e1 * t1482 * t125 * t489 * t801;
  t4099 = 0.1e1 / t1384 / t36;
  t4101 = t795 * t795;
  t4104 = t801 * t801;
  t4111 = t2822 - 0.31418611111111111112e0 * t2829 + 0.30161866666666666668e1 * t2831 - 0.11171061728395061729e1 * t2834 + 0.97746790123456790127e0 * t2837;
  t4122 = t175 * t342 * t224 * t227;
  t4126 = t175 * t113 * t793 * t795;
  t4129 = t175 * t1373 * t801;
  t4131 = t227 * t1398;
  t4134 = t795 * t801;
  t4139 = -0.4e1 / 0.3e1 * t845 * t118 * t113 * t801 + 0.2e1 / 0.3e1 * t845 * t118 * t170 * t1398 + 0.24e2 * t48 * t4099 * t4101 + 0.6e1 * t855 * t4104 - t252 * t4111 + 0.8e1 / 0.3e1 * t844 * t1163 * t1165 * t227 - 0.11e2 / 0.648e3 * t1496 * t2858 * t37 + 0.11e2 / 0.54e2 * t4122 + t4126 / 0.6e1 - t4129 / 0.12e2 + 0.8e1 * t855 * t4131 - 0.36e2 * t1508 * t4134 + 0.16e2 / 0.3e1 * t248 * t2831;
  t4175 = 0.41403379428206274608e-3 * (t4089 + t4139) * t255 * t36 + 0.12421013828461882382e-2 * t1515 * t227 + 0.12421013828461882382e-2 * t860 * t801 + 0.41403379428206274608e-3 * t256 * t1398 + 0.24817881715289806759e1 * t1362 * t2814 * t839 - 0.2e1 / 0.9e1 * t233 * t1264 * t227 + t233 * t505 * t801 / 0.3e1 - 0.2e1 / 0.9e1 * t807 * t1450 + 0.1e2 / 0.81e2 * t233 * t548 * t36 + t1404 * t810 / 0.3e1 + t233 * t194 * t1398 / 0.3e1 + 0.2e1 / 0.3e1 * t807 * t1365 + 0.19382764515877200001e1 * t817 * t780 * t243 * t175;
  t4211 = 0.7e2 / 0.81e2 * t4053 + 0.28e2 / 0.27e2 * t4122 + 0.4e1 / 0.3e1 * t4126 - 0.2e1 / 0.3e1 * t4129 + 0.2e1 * t175 * t170 * t1385 * t1387 - 0.2e1 * t175 * t1377 * t1391 + t175 * t788 * t1398 / 0.3e1 + 0.6e1 * t175 * t9 * t4099 * t4101 - 0.9e1 * t175 * t1386 * t4134 + 0.3e1 / 0.2e1 * t175 * t794 * t4104 + 0.2e1 * t175 * t794 * t4131 - t175 * t225 * t4111 / 0.4e1;
  t4231 = t838 * t838;
  t4255 = -0.9834558989840972045e2 * t835 * t780 * t839 * t175 + t807 * t1359 + t4211 * t122 * t192 * t234 / 0.3e1 + t1404 * t813 + 0.27602252952137516405e-3 * t865 * t36 * t1243 + 0.32053040088061616249e3 * t3966 * t1133 * t1413 * t3129 - 0.13537026390158076414e1 * t4035 * t1133 * t839 * t3129 - 0.13939962557599514819e5 / t1407 / t816 * t1133 / t4231 * t3129 + 0.23001877460114597004e-4 * t254 / t1418 / t47 * t36 * t122 * t3437 + 0.12572604010298724325e1 * t238 * t2826 * t3425 * t243 * t1 * t118 - 0.27602252952137516406e-3 * t1458 * t483 - 0.18401501968091677604e-3 * t1462 * t1503 - 0.27602252952137516406e-3 * t1454 * t483;
  t4261 = t34 * (t3993 + t4042 + t4175 + t4255) * t69 * t84 / 0.24e2;
  t4262 = t1525 * t286;
  t4265 = 0.364e4 / 0.27e2 * t1531 * t386;
  t4266 = t1959 * t699;
  t4268 = t883 * t1626;
  t4270 = t1954 * t722;
  t4272 = t3311 + t3937 - t4261 - t4262 / 0.6e1 - t4265 - t3314 - t3316 - t3375 + 0.9e1 / 0.2e1 * t4266 + 0.9e1 * t4268 - 0.6e1 * t4270;
  t4274 = t1954 * t718;
  t4276 = t1974 * t699;
  t4278 = t883 * t1710;
  t4280 = t1954 * t699;
  t4282 = t343 * t1953;
  t4283 = t4282 * t399;
  t4285 = t1699 * t152;
  t4286 = t114 * t4285;
  t4287 = t4286 * t399;
  t4289 = -0.3e1 * t4274 - t3377 - t3379 - 0.21e2 * t4276 - 0.15e2 / 0.2e1 * t4278 + 0.9e1 / 0.2e1 * t4280 + 0.14e2 * t4283 - t3381 - 0.2e1 * t4287 + t3385 + t3388;
  t4291 = 0.28e2 * t1716 * t725;
  t4293 = 0.28e3 / 0.3e1 * t1713 * t725;
  t4294 = t1949 * t334;
  t4295 = 0.16e2 * t4294;
  t4297 = t1524 * t274 * t84;
  t4299 = t3394 - t4291 + t4293 + t3450 + t3457 + t3461 + t3464 + t3470 + t3474 + t4295 - t4297 / 0.6e1;
  t4305 = 0.48e2 * t1534;
  t4308 = 0.48e2 * t1539;
  t4309 = 0.42416795386695221524e0 * t1543;
  t4310 = 0.49486261284477758446e0 * t1547;
  t4312 = 0.56e2 * t1551;
  t4314 = 0.12e2 * t1559;
  t4318 = 0.144e3 * t1536 + t4308 - t4309 + t4310 + 0.28e2 * t1549 - t4312 - 0.6e1 * t1555 + t4314 + 0.96e2 * t1561 - 0.96e2 * t1563 + 0.48e2 * t1565;
  t4322 = 0.96e3 * t1573;
  t4323 = 0.48e3 * t1576;
  t4325 = 0.24e3 * t1581;
  t4328 = 0.1615037951924062369e-3 * t1592;
  t4329 = 0.20252531409700720677e3 * t1602;
  t4330 = 0.10604198846673805381e0 * t1609;
  t4332 = 0.93645304387672034355e1 * t1617;
  t4333 = 0.8836832372228171151e-2 * t1623;
  t4335 = 0.12e2 * t1629;
  t4338 = 0.4e1 * t1665;
  t4339 = 0.28e2 * t1667;
  t4340 = 0.12e2 * t1669;
  t4343 = -t4332 + t4333 + 0.9e1 * t1627 + t4335 - 0.14e3 / 0.3e1 * t1631 - 0.21e2 * t1633 + t4338 - t4339 + t4340 - 0.2e1 * t1694 - 0.6e1 * t1697;
  t4345 = 0.4e1 * t1701;
  t4347 = 0.28e3 / 0.3e1 * t1714;
  t4348 = 0.28e2 * t1717;
  t4350 = 0.4e1 * t1950;
  t4351 = 0.38760910846177496856e-2 * t1827;
  t4352 = 0.77521821692354993712e-2 * t1829;
  t4353 = 0.38760910846177496856e-2 * t1868;
  t4356 = t4345 - 0.15e2 / 0.2e1 * t1711 + t4347 - t4348 + 0.14e2 * t1719 + t4350 + t4351 + t4352 + t4353 + 0.9e1 * t1951 - 0.6e1 * t1955;
  t4358 = 0.12e2 * t1964;
  t4363 = 0.12920303615392498952e-2 * t1873;
  t4364 = 0.43067678717974996507e-3 * t1877;
  t4365 = 0.12920303615392498952e-2 * t1881;
  t4366 = 0.86135357435949993013e-3 * t1895;
  t4368 = -0.6e1 * t1960 + t4358 + 0.9e1 * t1968 - 0.6e1 * t1970 - 0.12e2 * t1972 + 0.28e2 * t1975 + t4363 + t4364 + t4365 - t4366 + 0.4e1 * t1978;
  tv4rho40 = -t1348 - t1350 / 0.2e1 - t2798 - t2799 + t4343 + t4325 + t4328 + t4329 - t2777 + t2778 + t2773 + t2774 + t2775 + t2776 - t1312 / 0.2e1 - 0.48e2 * t1567 - t1344 / 0.6e1 - t1346 / 0.2e1 - t4305 + t7 * (t2938 + t2940 + t3810 - t3575 + 0.14e2 / 0.3e1 * t3576 + 0.14e2 * t3578 - t3234 - 0.48e2 * t2800 + 0.4e1 * t2803 + t3214 + t4272 - t3582 + 0.48e2 * t3896 + t3930 + t3917 - t3485 + t3890 + 0.9e1 / 0.2e1 * t3922 + t3719 - t2806 + t4289 + t3834 + t3220 + t3237 + t3572 + t3894 + t2930 + t3585 + 0.35e2 / 0.2e1 * t3586 + t4299 + t3886 - t3888 + t3286 - 0.21e2 * t3744 + 0.14e2 * t3746 - t3291 - t3228 + t3149 - 0.3e1 * t3880 - 0.2e1 * t3883 + t3179 - t153 * t390 * t166 * (t3858 + t3873) / 0.2e1 - t3903 + t3273 + t3925 - 0.14e3 / 0.3e1 * t3926 + t3564 + t3276 + t2936 + t3899 + t3901 + t3480 + 0.182e4 / 0.27e2 * t3481 + t3843 - t3567 + 0.48e2 * t3568 - t3052 - 0.192e3 * t3738 - 0.576e3 * t3740 + 0.96e3 * t3742 - 0.6e1 * t3731 - 0.15e2 / 0.2e1 * t3840 + t3735 - t3736 / 0.4e1 + 0.9e1 * t3727 - t3278 - t3281 - t3590 + t3781 + 0.4e1 * t3723) + t4322 - t4323 - t2769 + t2770 + t2771 - t2772 + t4368 + 0.12e2 * t1584 + 0.24e3 * t1586 + 0.12e2 * t1579 + t4356 + t4318 - t1315 / 0.2e1 + t4330 + t2791;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t4371 = 0.192e3 * t1156;
  t4374 = t782 * t927;
  t4376 = t782 * t948;
  t4377 = 0.35e2 / 0.3e1 * t4376;
  t4382 = t883 * t2154;
  t4384 = t3603 * t166;
  t4389 = t4286 * t432;
  t4391 = t1954 * t927;
  t4397 = t1954 * t948;
  t4398 = 0.3e1 / 0.2e1 * t4397;
  t4399 = t2180 * t2169;
  t4402 = t114 * t1557 * t1005;
  t4403 = 0.9e1 / 0.4e1 * t4402;
  t4404 = t883 * t2119;
  t4406 = -0.36e2 * t2800 + 0.3e1 * t2803 - t2806 - 0.35e2 / 0.3e1 * t4374 - t4377 + 0.9e1 / 0.4e1 * t1002 * t1003 * t2152 * t397 - 0.3e1 / 0.2e1 * t4382 + 0.105e3 / 0.16e2 * t1002 * t4384 * t430 * t1708 - t4389 / 0.2e1 - 0.3e1 / 0.2e1 * t4391 - 0.45e2 / 0.8e1 * t1002 * t2167 * t946 * t697 - t4398 - 0.45e2 / 0.8e1 * t4399 + t4403 - 0.3e1 / 0.2e1 * t4404;
  t4407 = t2180 * t2173;
  t4409 = t883 * t2122;
  t4410 = 0.3e1 * t4409;
  t4411 = t344 * t2119;
  t4413 = t344 * t2122;
  t4414 = 0.7e1 * t4413;
  t4415 = t344 * t2154;
  t4421 = t670 * t667;
  t4424 = t266 * t673;
  t4430 = t79 * t266;
  t4433 = t670 * t673;
  t4441 = 0.4e2 * t933 * t281;
  t4443 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3845 * t404 * t1318 - 0.2e2 / 0.9e1 * t1671 * t54 * t4421 - 0.1e2 / 0.9e1 * t2124 * t4424 + 0.2e2 / 0.3e1 * t702 * t670 * t266 - 0.2e2 * t2127 * t4430 + 0.2e2 / 0.3e1 * t2127 * t4433 + 0.1e2 / 0.9e1 * t930 * t1325 - 0.2e2 * t156 * t79 + t4441);
  t4448 = t670 * t679;
  t4451 = t270 * t682;
  t4457 = t79 * t270;
  t4460 = t670 * t682;
  t4468 = 0.4e2 * t941 * t281;
  t4470 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3860 * t408 * t1331 + 0.2e2 / 0.9e1 * t1681 * t54 * t4448 - 0.1e2 / 0.9e1 * t2138 * t4451 - 0.2e2 / 0.3e1 * t709 * t670 * t270 + 0.2e2 * t2141 * t4457 - 0.2e2 / 0.3e1 * t2141 * t4460 + 0.1e2 / 0.9e1 * t938 * t1337 + 0.2e2 * t159 * t79 - t4468);
  t4477 = t153 * t721 * t2153;
  t4480 = t153 * t1553 * t947;
  t4481 = 0.3e1 / 0.2e1 * t4480;
  t4483 = t153 * t3806 * t431;
  t4485 = t2184 * t2169;
  t4487 = t4282 * t432;
  t4489 = t3750 * t432;
  t4491 = t1959 * t927;
  t4493 = t1959 * t948;
  t4494 = 0.3e1 / 0.2e1 * t4493;
  t4496 = t781 * t381 * t1005;
  t4497 = 0.35e2 / 0.2e1 * t4496;
  t4498 = 0.9e1 / 0.2e1 * t4407 - t4410 + 0.7e1 / 0.2e1 * t4411 + t4414 + 0.7e1 / 0.2e1 * t4415 - t153 * t390 * t166 * (t4443 + t4470) / 0.2e1 - 0.3e1 / 0.2e1 * t4477 - t4481 - t4483 / 0.2e1 + 0.105e3 / 0.8e1 * t4485 + 0.7e1 / 0.2e1 * t4487 - t4489 / 0.2e1 - 0.3e1 / 0.2e1 * t4491 - t4494 + t4497;
  t4500 = t3791 * t432;
  t4503 = t343 * t724 * t1005;
  t4504 = 0.21e2 / 0.2e1 * t4503;
  t4505 = t2184 * t2173;
  t4507 = t2184 * t2190;
  t4509 = t3757 * t432;
  t4511 = t1974 * t927;
  t4513 = t1974 * t948;
  t4514 = 0.7e1 * t4513;
  t4515 = t2180 * t2190;
  t4525 = t2036 * t337;
  t4526 = 0.24e2 * t4525;
  t4528 = 0.24e2 * t2036 * t334;
  t4529 = t2076 * t337;
  t4532 = t328 * t2075 * t108;
  t4534 = -0.35e2 / 0.3e1 * t4500 - t4504 - 0.21e2 / 0.2e1 * t4505 - 0.21e2 / 0.4e1 * t4507 + 0.7e1 / 0.2e1 * t4509 + 0.7e1 * t4511 + t4514 + 0.9e1 / 0.4e1 * t4515 + 0.9e1 / 0.4e1 * t1002 * t1003 * t946 * t716 + 0.3e1 / 0.4e1 * t1002 * t1003 * t430 * t1691 - t4526 + t4528 - 0.12e2 * t4529 + t3480 + 0.3e1 * t4532;
  t4535 = t2076 * t334;
  t4557 = 0.32e2 * t961 * t281;
  t4559 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3509 * t404 * t1318 - 0.16e2 / 0.9e1 * t1317 * t54 * t4421 - 0.8e1 / 0.9e1 * t2045 * t4424 + 0.8e1 / 0.3e1 * t666 * t670 * t266 - 0.8e1 * t2048 * t4430 + 0.8e1 / 0.3e1 * t2048 * t4433 + 0.4e1 / 0.9e1 * t958 * t1325 - 0.16e2 * t61 * t79 + t4557);
  t4580 = 0.32e2 * t969 * t281;
  t4582 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3529 * t408 * t1331 + 0.16e2 / 0.9e1 * t1330 * t54 * t4448 - 0.8e1 / 0.9e1 * t2060 * t4451 - 0.8e1 / 0.3e1 * t678 * t670 * t270 + 0.8e1 * t2063 * t4457 - 0.8e1 / 0.3e1 * t2063 * t4460 + 0.4e1 / 0.9e1 * t966 * t1337 + 0.16e2 * t66 * t79 - t4580);
  t4583 = t4559 + t4582;
  t4593 = t1531 * t432;
  t4595 = 0.12e2 * t4535 + t2930 + t2936 + t2938 + t2940 + t105 * t4583 * t108 + 0.455e3 / 0.9e1 * t3481 - t3485 + 0.18e3 * t3505 + 0.3e1 * t3550 - 0.24e2 * t3552 - 0.36e3 * t3554 - 0.36e2 * t3556 + 0.6e2 * t3558 + 0.455e3 / 0.27e2 * t4593;
  t4599 = 0.96e3 * t3574;
  t4606 = -t3562 / 0.24e2 - t3567 + t3572 - t4599 + 0.7e1 / 0.6e1 * t3576 + 0.7e1 * t3578 - t3582 + t3585 + 0.35e2 / 0.8e1 * t3586 - t3590 - 0.21e2 / 0.2e1 * t3597 + 0.35e2 / 0.2e1 * t3599 + t3612 + t3616 - 0.35e2 / 0.3e1 * t3617;
  t4607 = 0.192e3 * t3490;
  t4608 = 0.96e3 * t3494;
  t4614 = t261 * t2102;
  t4622 = t877 * t985;
  t4624 = t1311 * t419;
  t4627 = t260 * t2075 * t84;
  t4629 = 0.48e2 * t3715;
  t4633 = t3621 + t3714 - t70 * t74 * (t3489 - t4607 + t4608 - t3499) * t83 / 0.24e2 - t4614 / 0.8e1 - t275 * t2102 / 0.8e1 - t1343 * t419 / 0.24e2 - t905 * t985 / 0.8e1 - t4622 / 0.4e1 - t4624 / 0.8e1 - t4627 / 0.8e1 - t4629 - 0.72e2 * t3717 + t3723 + 0.9e1 / 0.4e1 * t3727 - 0.9e1 / 0.2e1 * t3731;
  t4636 = 0.144e3 * t3740;
  t4637 = 0.24e3 * t3742;
  t4646 = -t3735 - t3736 / 0.8e1 + t4636 + t4637 - 0.21e2 / 0.4e1 * t3744 + 0.7e1 * t3746 - 0.3e1 / 0.2e1 * t3751 + t3756 + 0.21e2 / 0.2e1 * t3758 - t3762 - 0.9e1 / 0.2e1 * t3763 + t3766 - t3771 / 0.2e1 + 0.9e1 / 0.4e1 * t3773 - 0.3e1 * t3775;
  t4652 = t1948 * t412 * t108;
  t4653 = 0.36e2 * t3796;
  t4660 = t3780 + 0.21e2 * t3783 + t3044 - 0.9e1 / 0.2e1 * t3785 - 0.35e2 * t3792 - 0.3e1 / 0.2e1 * t3794 + t4652 - t4653 - 0.4e1 * t3798 - 0.4e1 * t3800 + t3805 - 0.3e1 / 0.2e1 * t3808 - t3811 / 0.4e1 - t3814 / 0.8e1 - t3816 / 0.8e1;
  t4666 = 0.96e2 * t3832;
  t4670 = -t3821 / 0.24e2 - t3828 / 0.8e1 + t3831 - t4666 + t3048 - t3052 - 0.15e2 / 0.8e1 * t3840 + t3843 - 0.3e1 / 0.2e1 * t3880 - t3883 / 0.2e1 + t3886 - t3888 + t3890 + t3149 - t3153;
  t4671 = t3156 + t3158 - t3161 + t3164 - t3166 + t3169 - t3893 + t3171 + t3173 + t3176 + t3179 + t3214 + t3220 - t3228 - t3234;
  t4673 = 0.12e2 * t3896;
  t4674 = 0.48e3 * t3898;
  t4675 = 0.96e2 * t3902;
  t4676 = 0.192e3 * t3906;
  t4678 = t658 * t974 * t108;
  t4679 = 0.3e1 * t4678;
  t4681 = t3237 + t4673 + t4674 + t3901 - t4675 + t4676 + t4679 - t3914 + 0.21e2 / 0.2e1 * t3915 - t3240 + t3247 - t3253 + t3257 + t3260 + t3266;
  t4682 = t2080 * t286;
  t4692 = t1524 * t412 * t84;
  t4694 = t1974 * t2211;
  t4695 = 0.21e2 / 0.2e1 * t4694;
  t4700 = t431 * t716;
  t4702 = t883 * t696 * t4700;
  t4704 = t1959 * t2211;
  t4705 = 0.9e1 / 0.4e1 * t4704;
  t4706 = -t4682 / 0.4e1 - t53 * t4583 * t84 / 0.24e2 - t2083 * t286 / 0.8e1 + 0.9e1 / 0.4e1 * t3922 + t3925 - 0.35e2 * t3926 + t3930 + t3273 + t3276 - t3278 - t4692 / 0.24e2 - t4695 - 0.45e2 / 0.8e1 * t1002 * t2167 * t2189 * t397 + 0.9e1 / 0.4e1 * t4702 + t4705;
  t4710 = t1963 * t381 * t1114;
  t4713 = t883 * t1625 * t2210;
  t4714 = 0.9e1 / 0.2e1 * t4713;
  t4715 = t947 * t397;
  t4717 = t883 * t696 * t4715;
  t4719 = t431 * t697;
  t4721 = t883 * t1707 * t4719;
  t4723 = t1954 * t2211;
  t4724 = 0.9e1 / 0.4e1 * t4723;
  t4725 = t422 * t1271;
  t4727 = t422 * t1274;
  t4728 = 0.144e3 * t4727;
  t4729 = t422 * t1572;
  t4730 = 0.24e3 * t4729;
  t4731 = t422 * t1575;
  t4733 = -0.3e1 / 0.2e1 * t4710 + t4714 + 0.9e1 / 0.2e1 * t4717 - 0.45e2 / 0.8e1 * t4721 + t4724 - t3281 + t3286 - t3291 + t3311 + 0.24e2 * t4725 - t4728 + t4730 - 0.12e3 * t4731 + t3937 - t4261;
  t4743 = -t4262 / 0.8e1 - t4265 - t3314 - t3316 - t3375 + 0.9e1 / 0.4e1 * t4266 + 0.9e1 / 0.2e1 * t4268 - 0.9e1 / 0.2e1 * t4270 - 0.3e1 / 0.2e1 * t4274 - t3377 - t3379 - 0.21e2 / 0.2e1 * t4276 - 0.15e2 / 0.8e1 * t4278 + 0.9e1 / 0.4e1 * t4280 + 0.21e2 / 0.2e1 * t4283;
  t4746 = t2078 * t337;
  t4748 = 0.8e1 * t4294;
  t4749 = -t3381 - 0.3e1 / 0.2e1 * t4287 + t3385 + t3388 + t3394 - 0.12e2 * t4746 - t4291 + t4293 + t3450 + t3457 + t3461 + t3464 + t3470 + t3474 + t4748;
  t4750 = t2078 * t334;
  t4751 = 0.12e2 * t4750;
  t4753 = 0.96e2 * t975 * t458;
  t4754 = t975 * t455;
  t4755 = 0.36e2 * t4754;
  t4756 = t977 * t458;
  t4757 = 0.96e2 * t4756;
  t4758 = t977 * t455;
  t4759 = 0.36e2 * t4758;
  t4760 = t975 * t663;
  t4761 = 0.6e2 * t4760;
  t4762 = t977 * t663;
  t4764 = t1314 * t419;
  t4765 = t4764 / 0.8e1;
  t4766 = t874 * t985;
  t4767 = t4766 / 0.8e1;
  t4772 = t1525 * t419;
  t4775 = t873 * t974 * t84;
  t4776 = t4775 / 0.8e1;
  t4778 = t2219 * t286;
  t4779 = t4778 / 0.8e1;
  t4780 = t995 * t902;
  t4782 = t4751 - t4753 + t4755 - t4757 + t4759 + t4761 + 0.6e2 * t4762 - t4765 - t4767 - t988 * t902 / 0.8e1 - t413 * t1306 / 0.24e2 - t4772 / 0.24e2 - t4776 - t4297 / 0.8e1 - t4779 - t4780 / 0.8e1;
  t4788 = 0.48e2 * t1272;
  t4789 = -t4371 + t2771 - t2772 + t2773 + t2774 + t2775 + t2776 - t2777 + t2778 - t2780 + t7 * (t4406 + t4498 + t4534 + t4595 + t4606 + t4633 + t4646 + t4660 + t4670 + t4671 + t4681 + t4706 + t4733 + t4743 + t4749 + t4782) - t1269 - t4788 - t2784 + t2785;
  t4792 = 0.6e1 * t2037;
  t4793 = 0.24e2 * t2041;
  t4794 = 0.24e2 * t2043;
  t4796 = t2081 / 0.4e1;
  t4799 = t2786 + t2787 - t1290 / 0.4e1 - t1293 - t1308 - t1312 / 0.4e1 + t4792 - t2490 + t4793 - t4794 + 0.3e1 * t2077 + t2491 - t4796 - t2084 / 0.8e1 - t2086 / 0.4e1;
  t4801 = t2090 / 0.4e1;
  t4804 = t2096 / 0.4e1;
  t4806 = t2105 / 0.4e1;
  t4810 = -t4801 - t2092 / 0.8e1 - t2094 / 0.4e1 - t4804 - t2103 / 0.8e1 - t4806 + t2495 - 0.3e1 / 0.8e1 * t1315 - t1345 - t1347 - t1348 / 0.2e1 - 0.3e1 / 0.8e1 * t1350 - t2798 - t2799 + t2496;
  t4811 = 0.3e1 * t2123;
  t4813 = 0.7e1 * t2157;
  t4814 = 0.24e2 * t1539;
  t4817 = 0.3e1 * t2176;
  t4818 = t2497 - t2498 - t2499 - t4811 - 0.3e1 / 0.2e1 * t2155 + t4813 + t2500 - t2501 - t4305 - t1537 + t4814 - t2507 - 0.45e2 / 0.8e1 * t2170 + 0.9e1 / 0.2e1 * t2174 - t4817;
  t4821 = 0.9e1 / 0.2e1 * t2181;
  t4822 = 0.21e2 / 0.2e1 * t2185;
  t4828 = t4821 - t2508 - t4822 + t2509 + 0.9e1 / 0.4e1 * t2191 - t2510 - t4309 + t4310 + 0.21e2 * t1549 - t4312 - 0.9e1 / 0.2e1 * t1555 + t4314 + t1562 - 0.72e2 * t1563 - 0.24e2 * t1567;
  t4829 = 0.48e3 * t1573;
  t4836 = t4829 - t4323 + 0.6e1 * t1579 + t4325 + 0.9e1 * t1584 + 0.18e3 * t1586 + t4328 + t4329 + t4330 - t4332 + t4333 + 0.9e1 / 0.2e1 * t1627 + t4335 - 0.35e2 * t1631 - 0.21e2 / 0.2e1 * t1633;
  t4840 = 0.9e1 / 0.2e1 * t2212;
  t4841 = t4338 - t4339 + t4340 - t1695 - 0.3e1 * t1697 + t4345 - t1712 + t4347 - t4348 + 0.7e1 * t1719 + t4840 + t4350 + t4351 + t4352 + t4353;
  t4849 = 0.9e1 / 0.2e1 * t1951 - 0.9e1 / 0.2e1 * t1955 - 0.9e1 / 0.2e1 * t1960 + t4358 + t1969 - 0.3e1 * t1970 - 0.9e1 * t1972 + 0.21e2 * t1975 + t4363 + t4364 + t4365 - t4366 + t1978 - t2520 - t2222 / 0.8e1 - t2521;
  tv4rho41 = t4789 + t4799 + t4810 + t4818 + t4828 + t4836 + t4841 + t4849;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4857 = -0.48e2 * t1158 + t2771 - t2772 + t2773 + t2774 + t2775 + t2776 - t2777 + t2778 - t2780 + 0.2e1 * t2266 + 0.2e1 * t2268 + 0.64e2 * t1268 + 0.192e3 * t1275 - t2784 + t2785;
  t4870 = t260 * t2264 * t84;
  t4872 = t2219 * t419;
  t4874 = -0.24e2 * t2800 + 0.2e1 * t2803 - t2806 - 0.7e2 / 0.3e1 * t4374 - 0.14e3 / 0.9e1 * t4376 - t4382 - t4389 - 0.3e1 * t4391 - 0.2e1 * t4397 - 0.15e2 / 0.4e1 * t4399 + 0.3e1 * t4402 - 0.3e1 * t4404 + 0.3e1 * t4407 - 0.4e1 * t4409 - t4870 / 0.12e2 - t4872 / 0.12e2;
  t4875 = t995 * t985;
  t4885 = t266 * t54 * t670;
  t4906 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3509 * t1015 * t667 - 0.64e2 / 0.27e2 * t2045 * t4885 - 0.8e1 / 0.27e2 * t2236 * t673 + 0.32e2 / 0.9e1 * t666 * t75 * t662 + 0.16e2 / 0.9e1 * t958 * t670 - 0.16e2 / 0.3e1 * t958 * t1294 - 0.8e1 / 0.27e2 * t1317 * t1019 * t667 + 0.8e1 / 0.9e1 * t666 * t2246 * t266 + 0.4e1 / 0.9e1 * t2241 * t673 + t4557);
  t4911 = t270 * t54 * t670;
  t4932 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3529 * t1024 * t679 + 0.64e2 / 0.27e2 * t2060 * t4911 - 0.8e1 / 0.27e2 * t2251 * t682 + 0.32e2 / 0.9e1 * t678 * t75 * t662 - 0.16e2 / 0.9e1 * t966 * t670 + 0.16e2 / 0.3e1 * t966 * t1294 - 0.8e1 / 0.27e2 * t1330 * t1027 * t679 + 0.8e1 / 0.9e1 * t678 * t2259 * t270 + 0.4e1 / 0.9e1 * t2256 * t682 - t4580);
  t4933 = t4906 + t4932;
  t4939 = t2366 * t286;
  t4944 = t873 * t1049 * t84;
  t4950 = t261 * t2363;
  t4954 = t877 * t1054;
  t4956 = t2080 * t419;
  t4966 = -t4875 / 0.6e1 - t2083 * t419 / 0.12e2 - t988 * t985 / 0.6e1 - t53 * t4933 * t84 / 0.24e2 - t2371 * t286 / 0.12e2 - t4939 / 0.12e2 - t1057 * t902 / 0.24e2 - t4944 / 0.24e2 - t905 * t1054 / 0.24e2 - t275 * t2363 / 0.12e2 - t4950 / 0.12e2 - t413 * t2102 / 0.12e2 - t4954 / 0.12e2 - t4956 / 0.6e1 - t70 * t74 * (-t3489 + 0.48e3 * t3492 - t3499) * t83 / 0.24e2 + 0.7e1 * t4411 + 0.28e2 / 0.3e1 * t4413;
  t4970 = t2180 * t2272;
  t4972 = t883 * t2287;
  t4973 = t2184 * t2272;
  t4977 = t1974 * t1034;
  t4983 = t1959 * t1034;
  t4991 = t1954 * t1034;
  t4993 = 0.7e1 / 0.3e1 * t4415 - t4477 - 0.2e1 * t4480 - t4483 + 0.3e1 / 0.2e1 * t4970 - t4972 - 0.7e1 / 0.2e1 * t4973 + 0.35e2 / 0.4e1 * t4485 + 0.7e1 * t4487 + 0.7e1 / 0.3e1 * t4977 + 0.3e1 / 0.4e1 * t1002 * t1003 * t1032 * t716 - t4983 / 0.2e1 - 0.15e2 / 0.8e1 * t1002 * t2167 * t1032 * t697 - t4489 - 0.3e1 * t4491 - 0.2e1 * t4493 - t4991 / 0.2e1;
  t5007 = t1954 * t1070;
  t5013 = 0.7e2 / 0.3e1 * t4496 - 0.7e2 / 0.3e1 * t4500 - 0.14e2 * t4503 - 0.7e1 * t4505 - 0.7e1 / 0.2e1 * t4507 + 0.7e1 * t4509 + 0.14e2 * t4511 + 0.28e2 / 0.3e1 * t4513 + 0.3e1 / 0.2e1 * t4515 + 0.105e3 / 0.16e2 * t1002 * t4384 * t1068 * t697 + 0.3e1 / 0.4e1 * t5007 - 0.32e2 * t4525 - 0.8e1 * t4529 + t3480 + 0.2e1 * t4532 - 0.8e1 * t4535 + t2930;
  t5017 = t153 * t1553 * t1033;
  t5042 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3845 * t1015 * t667 - 0.8e2 / 0.27e2 * t2124 * t4885 - 0.1e2 / 0.27e2 * t2301 * t673 + 0.8e2 / 0.9e1 * t702 * t75 * t662 + 0.4e2 / 0.9e1 * t930 * t670 - 0.4e2 / 0.3e1 * t930 * t1294 - 0.1e2 / 0.27e2 * t1671 * t1019 * t667 + 0.2e2 / 0.9e1 * t702 * t2246 * t266 + 0.1e2 / 0.9e1 * t2306 * t673 + t4441);
  t5066 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3860 * t1024 * t679 + 0.8e2 / 0.27e2 * t2138 * t4911 - 0.1e2 / 0.27e2 * t2313 * t682 + 0.8e2 / 0.9e1 * t709 * t75 * t662 - 0.4e2 / 0.9e1 * t938 * t670 + 0.4e2 / 0.3e1 * t938 * t1294 - 0.1e2 / 0.27e2 * t1681 * t1027 * t679 + 0.2e2 / 0.9e1 * t709 * t2259 * t270 + 0.1e2 / 0.9e1 * t2318 * t682 - t4468);
  t5073 = t153 * t721 * t2326;
  t5075 = t153 * t3920 * t1069;
  t5085 = t1959 * t1070;
  t5091 = t883 * t2327;
  t5092 = t2180 * t2278;
  t5094 = t2180 * t2282;
  t5096 = t883 * t2296;
  t5098 = t2184 * t2278;
  t5100 = t2936 + t2938 + t2940 - t5017 / 0.2e1 - t153 * t390 * t166 * (t5042 + t5066) / 0.2e1 - t5073 + 0.3e1 / 0.4e1 * t5075 - 0.15e2 / 0.8e1 * t1002 * t2167 * t1068 * t716 + 0.3e1 / 0.2e1 * t1002 * t1003 * t430 * t2152 + 0.3e1 / 0.4e1 * t5085 + 0.3e1 / 0.2e1 * t1002 * t1003 * t2325 * t397 - t5091 - 0.15e2 / 0.4e1 * t5092 + 0.3e1 * t5094 + 0.3e1 / 0.2e1 * t5096 + 0.35e2 / 0.4e1 * t5098;
  t5101 = t2184 * t2282;
  t5103 = t1974 * t1070;
  t5106 = t344 * t2287;
  t5108 = t782 * t1034;
  t5118 = t328 * t2264 * t108;
  t5120 = t874 * t1054;
  t5122 = -0.7e1 * t5101 - 0.7e1 / 0.2e1 * t5103 + 0.91e3 / 0.27e2 * t3481 - t3485 + 0.7e1 / 0.3e1 * t5106 - 0.35e2 / 0.9e1 * t5108 + 0.12e3 * t3505 + t3550 - 0.8e1 * t3552 - 0.24e3 * t3554 + 0.12e2 * t3556 + 0.2e2 * t3558 + 0.91e3 / 0.27e2 * t4593 + 0.192e3 * t3560 + 0.2e1 * t5118 - t5120 / 0.24e2 - t3567;
  t5133 = -0.8e1 * t3568 + t3572 + 0.7e1 / 0.3e1 * t3578 - t3582 + t3585 - t3590 - 0.7e1 / 0.2e1 * t3597 + 0.35e2 / 0.6e1 * t3599 + t3612 + t3616 - 0.35e2 / 0.9e1 * t3617 + t3621 + t3714 - t4614 / 0.12e2 - t4622 / 0.6e1 - t4624 / 0.12e2 - t4627 / 0.12e2;
  t5135 = t1033 * t397;
  t5137 = t883 * t696 * t5135;
  t5143 = t1069 * t397;
  t5145 = t883 * t1707 * t5143;
  t5147 = t431 * t946;
  t5149 = t883 * t696 * t5147;
  t5159 = t658 * t1049 * t108;
  t5162 = 0.48e2 * t3717 + 0.3e1 / 0.2e1 * t5137 - 0.15e2 / 0.2e1 * t1002 * t2167 * t1004 * t946 - 0.15e2 / 0.4e1 * t5145 + 0.3e1 * t5149 - 0.3e1 * t3731 + t3735 - t3736 / 0.24e2 + 0.32e2 * t3738 + 0.96e2 * t3740 - 0.16e3 * t3742 + t105 * t4933 * t108 + t5159 + 0.7e1 / 0.3e1 * t3746 - t3751 + t3756 + 0.7e1 * t3758;
  t5171 = t2267 * t337;
  t5173 = t2265 * t334;
  t5175 = t2265 * t337;
  t5177 = t2267 * t334;
  t5181 = -t3762 - 0.3e1 * t3763 + t3766 - t3775 + t3780 + 0.14e2 * t3783 + t3044 - 0.3e1 * t3785 - 0.7e2 / 0.3e1 * t3792 - t3794 / 0.2e1 - 0.8e1 * t5171 + 0.8e1 * t5173 - 0.8e1 * t5175 + 0.8e1 * t5177 + 0.2e1 * t4652 - 0.24e2 * t3796;
  t5186 = t946 * t946;
  t5191 = t344 * t2327;
  t5193 = t344 * t2296;
  t5195 = t782 * t1070;
  t5197 = t3805 - t3808 - t3811 / 0.12e2 - t3814 / 0.24e2 + t3831 + 0.64e2 * t3832 + t3048 - t3052 + t3843 - t3880 / 0.2e1 + t3886 - t3888 + t3890 + 0.3e1 / 0.2e1 * t153 * t696 * t166 * t5186 + 0.7e1 / 0.3e1 * t5191 - 0.7e1 / 0.2e1 * t5193 + 0.35e2 / 0.6e1 * t5195;
  t5199 = t3149 - t3153 + t3156 + t3158 - t3161 + t3164 - t3166 + t3169 - t3893 + t3171 + t3173 + t3176 + t3179 + t3214 + t3220 - t3228 - t3234;
  t5200 = t1050 * t455;
  t5202 = t1050 * t458;
  t5205 = t1050 * t663;
  t5211 = t3237 + 0.12e2 * t5200 - 0.32e2 * t5202 - 0.8e1 * t3896 + 0.2e2 * t5205 + t3901 - 0.48e3 * t3909 + 0.4e1 * t4678 - 0.24e2 * t3911 - t3914 + 0.7e1 * t3915 - t3240 + t3247 - t3253 + t3257 + t3260 + t3266;
  t5226 = -t4682 / 0.6e1 + 0.3e1 / 0.4e1 * t3922 + t3925 - 0.7e2 / 0.3e1 * t3926 + t3930 + t3273 + t3276 - t3278 - t4692 / 0.12e2 - 0.14e2 * t4694 + 0.3e1 / 0.2e1 * t4702 + 0.3e1 * t4704 - 0.3e1 * t4710 + 0.6e1 * t4713 + 0.3e1 * t4717 - 0.15e2 / 0.4e1 * t4721 + 0.3e1 * t4723;
  t5234 = -t3281 + t3286 - t3291 + t3311 - 0.48e2 * t4725 + 0.96e2 * t4727 + 0.16e3 * t4729 - 0.24e3 * t4731 + t3937 - t4261 - t4262 / 0.12e2 - t4265 - t3314 - t3316 - t3375 + 0.3e1 / 0.4e1 * t4266 + 0.3e1 / 0.2e1 * t4268;
  t5242 = -0.3e1 * t4270 - t4274 / 0.2e1 - t3377 - t3379 - 0.7e1 / 0.2e1 * t4276 + 0.3e1 / 0.4e1 * t4280 + 0.7e1 * t4283 - t3381 - t4287 + t3385 + t3388 + t3394 - 0.24e2 * t4746 - t4291 + t4293 + t3450 + t3457;
  t5256 = t3461 + t3464 + t3470 + t3474 + 0.8e1 * t4750 - 0.48e2 * t4754 - 0.64e2 * t4756 - 0.24e2 * t4758 + 0.8e2 * t4760 + 0.12e3 * t4762 - t4764 / 0.6e1 - t4766 / 0.6e1 - t4772 / 0.12e2 - t4775 / 0.6e1 - t4297 / 0.12e2 - t4778 / 0.6e1 - t4780 / 0.12e2;
  t5274 = t2786 + t2787 + t7 * (t4874 + t4966 + t4993 + t5013 + t5100 + t5122 + t5133 + t5162 + t5181 + t5197 + t5199 + t5211 + t5226 + t5234 + t5242 + t5256) - t1290 / 0.12e2 - t1312 / 0.12e2 + 0.3e1 / 0.2e1 * t2273 - t2275 - 0.15e2 / 0.4e1 * t2279 + 0.3e1 * t2283 + 0.3e1 / 0.2e1 * t2285 + 0.8e1 * t2037 - t2288 + 0.7e1 / 0.3e1 * t2290 - 0.48e2 * t2039 - 0.32e2 * t2043 + 0.2e1 * t2077 + 0.6e1 * t2079;
  t5291 = -t2081 / 0.3e1 - t2084 / 0.12e2 - t2086 / 0.6e1 - t2090 / 0.3e1 - t2092 / 0.12e2 - t2094 / 0.6e1 - t2096 / 0.3e1 - t2103 / 0.12e2 - t2105 / 0.3e1 + 0.3e1 / 0.2e1 * t2297 - 0.7e1 / 0.2e1 * t2299 - t2328 + 0.16e2 * t2107 - t1315 / 0.4e1 - t1348 / 0.6e1 - t1350 / 0.4e1 - t2798;
  t5304 = -t2799 + 0.12e3 * t2112 - t2334 - 0.64e2 * t2117 - 0.3e1 * t2120 - 0.4e1 * t2123 - t2155 + 0.28e2 / 0.3e1 * t2157 + 0.14e2 * t2159 - 0.7e2 / 0.3e1 * t2161 - t4305 - t2163 + 0.8e1 * t2338 - 0.8e1 * t2340 - 0.3e1 * t2165 - 0.15e2 / 0.4e1 * t2170 + 0.3e1 * t2174;
  t5319 = -0.4e1 * t2176 + 0.6e1 * t2181 - 0.6e1 * t2183 - 0.14e2 * t2185 + 0.14e2 * t2187 + 0.3e1 / 0.2e1 * t2191 - 0.3e1 * t2193 - t4309 + t4310 + 0.14e2 * t1549 - t4312 - 0.3e1 * t1555 + t4314 - 0.16e2 * t1561 - 0.48e2 * t1563 - 0.8e1 * t1565;
  t5333 = -0.8e1 * t1567 - t4323 + 0.2e1 * t1579 + t4325 + 0.6e1 * t1584 + 0.12e3 * t1586 - t2353 / 0.6e1 - t2355 / 0.6e1 - t2357 / 0.6e1 - t2359 / 0.12e2 - t2364 / 0.12e2 - t2367 / 0.12e2 - t2369 / 0.12e2 - t2372 / 0.12e2 - t2374 / 0.12e2 + t4328 + t4329;
  t5340 = t4330 - t4332 + t4333 + 0.3e1 / 0.2e1 * t1627 + t4335 - 0.7e2 / 0.3e1 * t1631 - 0.7e1 / 0.2e1 * t1633 + t4338 - t4339 + t4340 - t1697 + t4345 + t4347 - t4348 + 0.7e1 / 0.3e1 * t1719 + 0.6e1 * t2212 + t4350;
  t5349 = t4351 + t4352 + t4353 + 0.3e1 / 0.2e1 * t1951 - 0.3e1 * t1955 - 0.3e1 * t1960 + t4358 - t1970 - 0.6e1 * t1972 + 0.14e2 * t1975 + t4363 + t4364 + t4365 - t4366 - t2220 / 0.4e1 - t2222 / 0.12e2 - t2224 / 0.4e1;
  tv4rho42 = t4857 + t5274 + t5291 + t5304 + t5319 + t5333 + t5340 + t5349;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t5354 = t4371 + t2771 - t2772 + t2773 + t2774 + t2775 + t2776 - t2777 + t2778 - t2780 - t2423 - t2449 + t2453 + 0.3e1 * t2266 + 0.6e1 * t2268;
  t5360 = t1269 + t4788 - t2784 + t2785 + t2786 + t2787 - t2476 - t2478 - t2480 - t2485 + 0.9e1 / 0.4e1 * t2273 - 0.3e1 * t2275 - 0.45e2 / 0.8e1 * t2279 + 0.9e1 / 0.2e1 * t2283 + 0.9e1 / 0.2e1 * t2285;
  t5371 = -0.12e2 * t2800 + t2803 - t2806 - 0.35e2 * t4374 - t4377 - 0.3e1 / 0.2e1 * t4389 - 0.9e1 / 0.2e1 * t4391 - t4398 + t4403 - 0.9e1 / 0.2e1 * t4404 - t4410 - t4870 / 0.8e1 - t4872 / 0.4e1 - t4875 / 0.4e1 - t4939 / 0.8e1;
  t5378 = t261 * t2483;
  t5391 = t995 * t1054;
  t5400 = t1019 * t266;
  t5403 = t670 * t1019;
  t5413 = 0.12e2 * t79 + 0.24e2 * t3490;
  t5417 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3509 * t2424 * t266 - 0.16e2 / 0.9e1 * t2236 * t671 - 0.8e1 / 0.9e1 * t2045 * t5400 + 0.8e1 / 0.3e1 * t2048 * t5403 + 0.4e1 / 0.3e1 * t958 * t2246 + 0.4e1 / 0.9e1 * t666 * t2430 * t266 + 0.4e1 / 0.3e1 * t61 * t5413);
  t5423 = t1027 * t270;
  t5426 = t670 * t1027;
  t5434 = -t5413;
  t5438 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3529 * t2435 * t270 + 0.16e2 / 0.9e1 * t2251 * t671 - 0.8e1 / 0.9e1 * t2060 * t5423 - 0.8e1 / 0.3e1 * t2063 * t5426 + 0.4e1 / 0.3e1 * t966 * t2259 + 0.4e1 / 0.9e1 * t678 * t2440 * t270 + 0.4e1 / 0.3e1 * t66 * t5434);
  t5439 = t5417 + t5438;
  t5445 = t2366 * t419;
  t5447 = -t4944 / 0.8e1 - t4950 / 0.8e1 - t4954 / 0.8e1 - t4956 / 0.4e1 - t413 * t2363 / 0.8e1 - t5378 / 0.24e2 - t275 * t2483 / 0.24e2 - t70 * t74 * (t3489 + t4607 - t4608 - t3499) * t83 / 0.24e2 - t2371 * t419 / 0.8e1 - t1057 * t985 / 0.8e1 - t5391 / 0.8e1 - t988 * t1054 / 0.8e1 - t53 * t5439 * t84 / 0.24e2 - t2474 * t286 / 0.24e2 - t5445 / 0.8e1;
  t5460 = 0.21e2 / 0.2e1 * t4411 + t4414 - t4481 - 0.3e1 / 0.2e1 * t4483 + 0.9e1 / 0.4e1 * t4970 - 0.3e1 * t4972 - 0.21e2 / 0.4e1 * t4973 + 0.21e2 / 0.2e1 * t4487 + 0.7e1 * t4977 - 0.3e1 / 0.2e1 * t4983 - 0.3e1 / 0.2e1 * t4489 - 0.9e1 / 0.2e1 * t4491 - t4494 - 0.3e1 / 0.2e1 * t4991 + t4497;
  t5467 = -0.35e2 * t4500 - t4504 + 0.21e2 / 0.2e1 * t4509 + 0.21e2 * t4511 + t4514 + 0.9e1 / 0.4e1 * t5007 - t4526 - t4528 + t3480 + t2930 + t2936 + t2938 + t2940 - 0.3e1 / 0.2e1 * t5017 - 0.3e1 / 0.2e1 * t5073;
  t5484 = 0.9e1 / 0.4e1 * t5075 + 0.9e1 / 0.4e1 * t5085 - 0.3e1 / 0.2e1 * t5091 - 0.45e2 / 0.8e1 * t5092 + 0.9e1 / 0.2e1 * t5094 + 0.9e1 / 0.2e1 * t5096 + 0.105e3 / 0.8e1 * t5098 - 0.21e2 / 0.2e1 * t5101 - 0.21e2 / 0.2e1 * t5103 + 0.455e3 / 0.27e2 * t3481 - t3485 + 0.7e1 * t5106 - 0.35e2 / 0.3e1 * t5108 + 0.6e2 * t3505 - 0.12e3 * t3554;
  t5505 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3845 * t2424 * t266 - 0.2e2 / 0.9e1 * t2301 * t671 - 0.1e2 / 0.9e1 * t2124 * t5400 + 0.2e2 / 0.3e1 * t2127 * t5403 + 0.1e2 / 0.3e1 * t930 * t2246 + 0.1e2 / 0.9e1 * t702 * t2430 * t266 + 0.5e1 / 0.3e1 * t156 * t5413);
  t5523 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3860 * t2435 * t270 + 0.2e2 / 0.9e1 * t2313 * t671 - 0.1e2 / 0.9e1 * t2138 * t5423 - 0.2e2 / 0.3e1 * t2141 * t5426 + 0.1e2 / 0.3e1 * t938 * t2259 + 0.1e2 / 0.9e1 * t709 * t2440 * t270 + 0.5e1 / 0.3e1 * t159 * t5434);
  t5530 = t153 * t3838 * t2420;
  t5532 = 0.455e3 / 0.9e1 * t4593 + 0.3e1 * t5118 - t5120 / 0.8e1 - t3567 + t3572 + t4599 - t3582 + t3585 - t3590 + t3612 + t3616 + t3621 - t153 * t390 * t166 * (t5505 + t5523) / 0.2e1 - 0.15e2 / 0.8e1 * t5530 + t3714;
  t5535 = t153 * t721 * t2446;
  t5547 = -t5535 / 0.2e1 + t4629 - 0.24e2 * t3717 + 0.9e1 / 0.4e1 * t5137 - 0.45e2 / 0.8e1 * t5145 + 0.9e1 / 0.2e1 * t5149 - 0.3e1 / 0.2e1 * t3731 - t3735 + t105 * t5439 * t108 - t4636 - t4637 + 0.3e1 * t5159 - t3751 / 0.2e1 + t3756 + 0.7e1 / 0.2e1 * t3758;
  t5557 = -t3762 - 0.3e1 / 0.2e1 * t3763 + t3766 + t3780 + 0.7e1 * t3783 + t3044 - 0.3e1 / 0.2e1 * t3785 - 0.35e2 / 0.3e1 * t3792 - 0.24e2 * t5171 - 0.12e2 * t5173 - 0.12e2 * t5175 + 0.3e1 * t4652 + t4653 + t3805 - t3808 / 0.2e1;
  t5564 = t3831 + t4666 + t3048 - t3052 + t3843 + t3886 - t3888 + t3890 + 0.7e1 / 0.2e1 * t5191 - 0.21e2 / 0.2e1 * t5193 + 0.35e2 / 0.2e1 * t5195 + t3149 - t3153 + t3156 + t3158;
  t5566 = t328 * t2473 * t108;
  t5567 = -t3161 + t3164 - t3166 + t3169 - t3893 + t5566 + t3171 + t3173 + t3176 + t3179 + t3214 + t3220 - t3228 - t3234 + t3237;
  t5570 = t260 * t2473 * t84;
  t5574 = t344 * t2447;
  t5576 = t344 * t2421;
  t5579 = -t5570 / 0.24e2 - 0.36e2 * t5200 - t4673 + 0.6e2 * t5205 - t4674 + t3901 + t4675 - t4676 + 0.7e1 / 0.6e1 * t5574 + 0.35e2 / 0.8e1 * t5576 + t4679 - t3914 + 0.7e1 / 0.2e1 * t3915 - t3240 + t3247;
  t5581 = t2518 * t334;
  t5583 = t2518 * t337;
  t5586 = -t3253 + t3257 + t3260 + t3266 + t3925 - 0.35e2 / 0.3e1 * t3926 + 0.4e1 * t5581 - 0.4e1 * t5583 + t3930 + t3273 + t3276 - t3278 - t4692 / 0.8e1 - t4695 + t4705;
  t5593 = -0.9e1 / 0.2e1 * t4710 + t4714 + t4724 - t3281 + t3286 - t3291 + t3311 + 0.72e2 * t4725 + t4728 - t4730 - 0.36e3 * t4731 + t3937 - t4261 - t4262 / 0.24e2 - t4265;
  t5598 = t1033 * t430;
  t5600 = t883 * t696 * t5598;
  t5606 = -t3314 - t3316 - t3375 - 0.45e2 / 0.8e1 * t1002 * t2167 * t2450 * t397 + 0.9e1 / 0.4e1 * t5600 - 0.3e1 / 0.2e1 * t4270 - t3377 - t3379 + 0.7e1 / 0.2e1 * t4283 - t3381 - t4287 / 0.2e1 + t3385 + t3388 + t3394 - 0.36e2 * t4746;
  t5608 = t2184 * t2451;
  t5610 = t883 * t2421;
  t5612 = t2180 * t2451;
  t5626 = t883 * t2447;
  t5636 = -t4291 + t4293 + t3450 + t3457 + t3461 + t3464 - 0.21e2 / 0.4e1 * t5608 - 0.15e2 / 0.8e1 * t5610 + 0.9e1 / 0.4e1 * t5612 + 0.9e1 / 0.4e1 * t1002 * t1003 * t2325 * t430 + 0.9e1 / 0.4e1 * t1002 * t1003 * t1032 * t946 + 0.3e1 / 0.4e1 * t1002 * t1003 * t2445 * t397 - t5626 / 0.2e1 + 0.105e3 / 0.16e2 * t1002 * t4384 * t2419 * t397 - 0.45e2 / 0.8e1 * t1002 * t2167 * t1068 * t946;
  t5640 = t3470 + t3474 - t4748 - t4751 + t4753 + t4755 + t4757 - t4759 + t4761 + 0.18e3 * t4762 - t4765 - t4767 - t4772 / 0.8e1 - t4776 - t4297 / 0.24e2 - t4779;
  t5653 = t7 * (t5371 + t5447 + t5460 + t5467 + t5484 + t5532 + t5547 + t5557 + t5564 + t5567 + t5579 + t5586 + t5593 + t5606 + t5636 + t5640) + t4792 - 0.3e1 * t2288 + 0.7e1 * t2290 - 0.72e2 * t2039 - t4793 - t4794 + 0.9e1 * t2079 - t4796 - t4801 - t4804 - t4806 + 0.9e1 / 0.2e1 * t2297 - 0.21e2 / 0.2e1 * t2299 - 0.3e1 / 0.2e1 * t2328;
  t5658 = -t2495 - t1316 - t1351 - t2798 - t2799 + 0.18e3 * t2112 - t2497 + t2498 - 0.9e1 / 0.2e1 * t2120 - t4811 + t4813 + 0.21e2 * t2159 - 0.35e2 * t2161 - t4305 + t1537;
  t5666 = -t4814 - 0.24e2 * t2340 - 0.9e1 / 0.2e1 * t2165 - t4817 + t4821 - 0.9e1 * t2183 - t4822 + 0.21e2 * t2187 - 0.9e1 / 0.2e1 * t2193 - t4309 + t4310 + t1550 - t4312 - t1556 + t4314;
  t5675 = -t1562 - t1564 - t4829 - t4323 + t4325 + t1585 + t1587 - t2353 / 0.2e1 - t2355 / 0.4e1 - t2357 / 0.4e1 - t2359 / 0.8e1 - t2364 / 0.8e1 - t2367 / 0.4e1 - t2369 / 0.4e1 - t2372 / 0.8e1;
  t5678 = -t2374 / 0.8e1 + t4328 + t4329 + t4330 - t4332 + t4333 + t4335 - t1632 + t4338 - t4339 + t4340 + t4345 + t4347 - t4348 + t4840;
  t5681 = t4350 + t4351 + t4352 + t4353 - t1956 - t1961 + t4358 - t1973 + t1976 + t4363 + t4364 + t4365 - t4366 + t2519 - 0.3e1 / 0.8e1 * t2220 - 0.3e1 / 0.8e1 * t2224;
  tv4rho43 = t5354 + t5360 + t5653 + t5658 + t5666 + t5675 + t5678 + t5681;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t5689 = -t2780 - 0.15e2 / 0.2e1 * t2422 - 0.2e1 * t2448 + 0.9e1 * t2452 + 0.12e2 * t2268 - t2782 - t2783 - t2784 + t2785 + t2786 + t2787;
  t5711 = 0.9e1 * t2297 - 0.21e2 * t2299 - 0.96e2 * t2107 - t2798 - t2799 + 0.24e3 * t2112 + 0.144e3 * t2114 + 0.384e3 * t2117 - 0.6e1 * t2120 + 0.28e2 * t2159 - 0.14e3 / 0.3e1 * t2161;
  t5723 = -t4312 + t4314 - t4322 - t4323 + t4325 - t2353 - t2367 / 0.2e1 - t2369 / 0.2e1 + t4328 + t4329 + t4330;
  t5725 = -t4332 + t4333 + t4335 + t4338 - t4339 + t4340 + t4345 + t4347 - t4348 + t4350 + t4351;
  t5731 = t1015 * t1015;
  t5736 = t1019 * t1019;
  t5742 = 0.24e2 * t79 + 0.24e2 * t3490;
  t5746 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3509 * t5731 - 0.16e2 / 0.9e1 * t2236 * t1019 + 0.4e1 / 0.3e1 * t666 * t5736 + 0.16e2 / 0.9e1 * t958 * t2430 + 0.4e1 / 0.3e1 * t61 * t5742);
  t5747 = t1024 * t1024;
  t5752 = t1027 * t1027;
  t5757 = -t5742;
  t5761 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3529 * t5747 - 0.16e2 / 0.9e1 * t2251 * t1027 + 0.4e1 / 0.3e1 * t678 * t5752 + 0.16e2 / 0.9e1 * t966 * t2440 + 0.4e1 / 0.3e1 * t66 * t5757);
  t5762 = t5746 + t5761;
  t5785 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t3845 * t5731 - 0.2e2 / 0.9e1 * t2301 * t1019 + 0.1e2 / 0.3e1 * t702 * t5736 + 0.4e2 / 0.9e1 * t930 * t2430 + 0.5e1 / 0.3e1 * t156 * t5742);
  t5797 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t3860 * t5747 - 0.2e2 / 0.9e1 * t2313 * t1027 + 0.1e2 / 0.3e1 * t709 * t5752 + 0.4e2 / 0.9e1 * t938 * t2440 + 0.5e1 / 0.3e1 * t159 * t5757);
  t5812 = t1032 * t1032;
  t5817 = t1068 * t1068;
  t5825 = -0.6e1 * t4404 - t4872 / 0.2e1 - t4944 / 0.4e1 - t5378 / 0.6e1 - t5391 / 0.2e1 - t5445 / 0.2e1 + 0.9e1 / 0.4e1 * t153 * t696 * t166 * t5812 + 0.105e3 / 0.16e2 * t153 * t3604 * t166 * t5817 + 0.14e2 * t4411 - 0.2e1 * t4483 - 0.6e1 * t4972;
  t5843 = t3480 + t2930 + t2936 + t2938 + t2940 - 0.3e1 * t5017 + 0.9e1 / 0.2e1 * t5075 + 0.9e1 / 0.2e1 * t5085 + 0.9e1 * t5096 - 0.21e2 * t5103 - t3485;
  t5854 = -t3590 + t3612 + t3616 + t3621 - 0.15e2 / 0.2e1 * t5530 + t3714 - 0.2e1 * t5535 - t3716 + t3735 + 0.6e1 * t5159 + t3756;
  t5867 = -t3762 + t3766 + t3780 + t3044 + 0.3e1 * t1002 * t1003 * t2445 * t430 - 0.45e2 / 0.4e1 * t1002 * t2167 * t1068 * t1032 - 0.48e2 * t5171 - 0.48e2 * t5177 + 0.4e1 * t4652 + t3805 + t3831;
  t5870 = t3048 - t3052 + t3843 + t3886 - t3888 + t3890 - 0.21e2 * t5193 + 0.35e2 * t5195 + t3149 - t3153 + t3156;
  t5882 = t3179 + t3214 + t3220 - t3228 - t3234 + t3237 - t5570 / 0.6e1 + t105 * t5762 * t108 + 0.72e2 * t5200 + 0.192e3 * t5202 + 0.12e3 * t5205;
  t5889 = t3247 - t3253 + t3257 + t3260 + t3266 + t3925 - 0.16e2 * t5581 - 0.16e2 * t5583 + t3930 + t3273 + t3276;
  t5900 = -0.48e3 * t4731 + t3937 - t4261 - t4265 - t3314 - t3316 - t3375 + 0.9e1 * t5600 - t3377 - t3379 - t3381;
  t5904 = t3385 + t3388 + t3394 - 0.48e2 * t4746 - t4291 + t4293 + t3450 + t3457 + t3461 + t3464 - 0.21e2 * t5608;
  t5913 = -0.15e2 / 0.2e1 * t5610 + 0.9e1 * t5612 - 0.2e1 * t5626 + t3470 + t3474 - t4295 - 0.48e2 * t4750 + 0.384e3 * t4756 + 0.144e3 * t4758 + 0.24e3 * t4762 - t4772 / 0.6e1;
  t5921 = t4352 + t4353 + t4358 + t4363 + t4364 + t4365 - t4366 + 0.4e1 * t2519 + t7 * (0.4e1 * t5566 + t5854 - 0.2e1 * t4489 - 0.6e1 * t4491 - t70 * t74 * (-t3489 - t3491 - t3493 - t3495 - t3499) * t83 / 0.24e2 - t153 * t390 * t166 * (t5785 + t5797) / 0.2e1 + t3575 + t5825 - t3582 + 0.14e2 * t4487 - 0.3e1 * t4991 + t3912 - t3914 - t2806 + t3169 + t3171 - t5120 / 0.4e1 + t5843 - t3240 + 0.14e2 * t5106 + t3572 - t3893 + t3910 + t3585 + t3164 - t3166 - 0.6e1 * t4710 + 0.14e2 * t4509 + t3286 - t3291 + t5904 + 0.182e4 / 0.27e2 * t4593 + t5882 + t5913 + t3176 - 0.96e3 * t4729 + t5867 + t3903 + t3907 - 0.3e1 * t4983 + 0.28e2 * t4511 + t5889 - t3161 + t3173 - t3899 + t3901 + t5870 - 0.14e3 / 0.3e1 * t4374 - t4692 / 0.6e1 + 0.14e2 * t4977 + t3158 + 0.9e1 / 0.2e1 * t5007 - t3567 + t3311 + 0.14e2 / 0.3e1 * t5574 + 0.35e2 / 0.2e1 * t5576 - t3561 + t5900 - 0.2e1 * t4389 - 0.6e1 * t4391 - t3278 - t3281 - 0.14e3 / 0.3e1 * t4500 - 0.96e2 * t4725 - 0.576e3 * t4727 - t53 * t5762 * t84 / 0.24e2 - t413 * t2483 / 0.6e1 - t1057 * t1054 / 0.4e1 - t2474 * t419 / 0.6e1 - 0.7e2 / 0.3e1 * t5108) - t2220 / 0.2e1 - t2224 / 0.2e1;
  tv4rho44 = t5725 + 0.14e2 * t2290 + 0.12e2 * t2079 - 0.6e1 * t2193 + t5711 - 0.48e2 * t2338 + 0.28e2 * t2187 - t2477 / 0.2e1 - t2479 / 0.2e1 - t2777 + t2778 + t2773 + t2774 + t2775 + t2776 - 0.96e2 * t2039 - t2475 / 0.6e1 - 0.48e2 * t2340 - t4305 - t4308 - t4309 + t4310 - 0.6e1 * t2288 - 0.12e2 * t2183 + t5921 + t2769 + t2770 + t2771 - t2772 + 0.9e1 * t2285 + t5689 - 0.6e1 * t2165 - 0.6e1 * t2275 + t5723 - t2484 / 0.6e1;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t5926 = 0.3e1 * t2533;
  t5927 = 0.14e2 * t2534;
  t5930 = 0.3e1 * t2542;
  t5931 = 0.6e1 * t2543;
  t5933 = 0.14e2 * t2550;
  t5935 = 0.3e1 * t2554;
  t5936 = 0.7e2 / 0.3e1 * t2556;
  t5938 = 0.189e3 / 0.8e1 * t2565;
  t5940 = 0.21e2 / 0.2e1 * t2570;
  t5941 = 0.3e1 / 0.2e1 * t2573;
  t5943 = 0.3e1 / 0.2e1 * t2579;
  t5945 = t2531 * t2528;
  t5948 = t1086 * t1087 * t1691;
  t5950 = t437 * t767;
  t5951 = t5950 * t1088;
  t5953 = t1079 * t371;
  t5954 = t5953 * t1088;
  t5956 = t2555 * t386;
  t5957 = 0.7e2 / 0.3e1 * t5956;
  t5959 = t1097 * t2581 * t3725;
  t5961 = t2545 * t2528;
  t5963 = t1083 * t890;
  t5964 = 0.3e1 * t5963;
  t5965 = t2549 * t386;
  t5966 = 0.14e2 * t5965;
  t5967 = t2531 * t2536;
  t5969 = t2545 * t2536;
  t5972 = t1086 * t2167 * t1708;
  t5974 = -0.3e1 / 0.2e1 * t5945 - t5948 / 0.2e1 - 0.3e1 / 0.2e1 * t5951 + 0.7e1 * t5954 + t5957 - 0.9e1 / 0.8e1 * t5959 + 0.7e1 / 0.2e1 * t5961 + t5964 - t5966 + 0.9e1 / 0.4e1 * t5967 - 0.21e2 / 0.4e1 * t5969 - 0.15e2 / 0.8e1 * t5972;
  t5977 = t342 * t690 * t152 * t167;
  t5978 = 0.7e1 * t5977;
  t5979 = t2541 * t386;
  t5980 = 0.3e1 * t5979;
  t5981 = t2567 * t2582;
  t5983 = t2567 * t2578;
  t5984 = 0.21e2 / 0.4e1 * t5983;
  t5985 = t2567 * t2572;
  t5986 = 0.21e2 / 0.4e1 * t5985;
  t5988 = t1097 * t3749 * t382;
  t5989 = t5988 / 0.2e1;
  t5991 = t1097 * t1101 * t1692;
  t5993 = t2563 * t116;
  t5994 = t5993 * t1102;
  t5996 = t5993 * t1098;
  t5997 = 0.189e3 / 0.8e1 * t5996;
  t5998 = t2553 * t386;
  t5999 = 0.3e1 * t5998;
  t6002 = t113 * t1699 * t152 * t167;
  t6005 = t342 * t775 * t152 * t167;
  t6006 = 0.7e1 * t6005;
  t6007 = -t5978 + t5980 + 0.63e2 / 0.16e2 * t5981 + t5984 + t5986 - t5989 + t5991 / 0.4e1 + 0.189e3 / 0.16e2 * t5994 - t5997 + t5999 + t6002 - t6006;
  t6011 = t780 * t379 * t152 * t167;
  t6012 = 0.7e2 / 0.3e1 * t6011;
  t6013 = t2555 * t143;
  t6014 = t6013 * t1088;
  t6017 = t1097 * t4285 * t382;
  t6018 = t6017 / 0.2e1;
  t6019 = t152 * t1706;
  t6021 = t1097 * t6019 * t1709;
  t6023 = t2567 * t2558;
  t6026 = t1097 * t882 * t2528;
  t6028 = t2567 * t2575;
  t6031 = t1097 * t1958 * t1088;
  t6033 = t152 * t164;
  t6034 = t6033 * t166;
  t6036 = t1097 * t1962 * t6034;
  t6037 = 0.3e1 / 0.2e1 * t6036;
  t6039 = t1097 * t882 * t2536;
  t6042 = t1097 * t1953 * t1088;
  t6046 = t113 * t1663 * t152 * t167;
  t6047 = t6012 - 0.35e2 / 0.3e1 * t6014 - t6018 + 0.15e2 / 0.16e2 * t6021 - 0.21e2 / 0.8e1 * t6023 + 0.3e1 / 0.4e1 * t6026 - 0.21e2 / 0.4e1 * t6028 + 0.3e1 / 0.4e1 * t6031 - t6037 - 0.9e1 / 0.8e1 * t6039 + 0.3e1 / 0.4e1 * t6042 + t6046;
  t6049 = t1529 * t152 * t167;
  t6050 = 0.91e3 / 0.27e2 * t6049;
  t6051 = t2553 * t399;
  t6053 = t1083 * t699;
  t6055 = t1083 * t722;
  t6057 = t1086 * t1967;
  t6059 = t1083 * t718;
  t6061 = t2549 * t399;
  t6063 = t2541 * t399;
  t6069 = t145 / t439 / t661 * params->ftilde * t445;
  t6070 = 0.693e3 / 0.16e2 * t6069;
  t6071 = t1083 * t3778;
  t6072 = 0.3e1 * t6071;
  t6073 = t1079 * t890;
  t6074 = 0.7e1 * t6073;
  t6075 = t437 * t1208;
  t6076 = -t6050 - 0.3e1 / 0.2e1 * t6051 + 0.9e1 / 0.4e1 * t6053 - 0.3e1 * t6055 + 0.9e1 / 0.4e1 * t6057 - 0.3e1 / 0.2e1 * t6059 + 0.7e1 * t6061 - 0.3e1 / 0.2e1 * t6063 + t6070 + t6072 - t6074 + t6075;
  t6080 = t5935 + t5936 + 0.3e1 / 0.4e1 * t2559 - t5938 - 0.21e2 / 0.4e1 * t2568 + t5940 - t5941 + 0.3e1 / 0.2e1 * t2576 - t5943 - 0.9e1 / 0.8e1 * t2583 + t7 * (t5974 + t6007 + t6047 + t6076);
  tv4rho3sigma0 = -0.3e1 / 0.2e1 * t2529 - 0.3e1 * t2532 + t5926 - t5927 + 0.9e1 / 0.4e1 * t2537 - 0.3e1 * t2539 + t5930 + t5931 + 0.7e1 * t2546 - t5933 + t6080;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t6083 = 0.6e1 * t2533;
  t6084 = 0.28e2 * t2534;
  t6087 = 0.6e1 * t2542;
  t6088 = 0.12e2 * t2543;
  t6090 = 0.28e2 * t2550;
  t6092 = 0.6e1 * t2554;
  t6093 = 0.14e3 / 0.3e1 * t2556;
  t6095 = 0.189e3 / 0.4e1 * t2565;
  t6097 = 0.21e2 * t2570;
  t6098 = 0.3e1 * t2573;
  t6100 = 0.3e1 * t2579;
  t6105 = 0.14e3 / 0.3e1 * t5956;
  t6108 = 0.6e1 * t5963;
  t6109 = 0.28e2 * t5965;
  t6113 = -0.3e1 * t5945 - t5948 - 0.3e1 * t5951 + 0.14e2 * t5954 + t6105 - 0.9e1 / 0.4e1 * t5959 + 0.7e1 * t5961 + t6108 - t6109 + 0.9e1 / 0.2e1 * t5967 - 0.21e2 / 0.2e1 * t5969 - 0.15e2 / 0.4e1 * t5972;
  t6114 = 0.14e2 * t5977;
  t6115 = 0.6e1 * t5979;
  t6117 = 0.21e2 / 0.2e1 * t5983;
  t6118 = 0.21e2 / 0.2e1 * t5985;
  t6121 = 0.189e3 / 0.4e1 * t5996;
  t6122 = 0.6e1 * t5998;
  t6123 = 0.2e1 * t6002;
  t6124 = 0.14e2 * t6005;
  t6125 = -t6114 + t6115 + 0.63e2 / 0.8e1 * t5981 + t6117 + t6118 - t5988 + t5991 / 0.2e1 + 0.189e3 / 0.8e1 * t5994 - t6121 + t6122 + t6123 - t6124;
  t6127 = 0.14e3 / 0.3e1 * t6011;
  t6134 = 0.3e1 * t6036;
  t6137 = 0.2e1 * t6046;
  t6138 = t6127 - 0.7e2 / 0.3e1 * t6014 - t6017 + 0.15e2 / 0.8e1 * t6021 - 0.21e2 / 0.4e1 * t6023 + 0.3e1 / 0.2e1 * t6026 - 0.21e2 / 0.2e1 * t6028 + 0.3e1 / 0.2e1 * t6031 - t6134 - 0.9e1 / 0.4e1 * t6039 + 0.3e1 / 0.2e1 * t6042 + t6137;
  t6139 = 0.182e4 / 0.27e2 * t6049;
  t6147 = 0.693e3 / 0.8e1 * t6069;
  t6148 = 0.6e1 * t6071;
  t6149 = 0.14e2 * t6073;
  t6150 = 0.2e1 * t6075;
  t6151 = -t6139 - 0.3e1 * t6051 + 0.9e1 / 0.2e1 * t6053 - 0.6e1 * t6055 + 0.9e1 / 0.2e1 * t6057 - 0.3e1 * t6059 + 0.14e2 * t6061 - 0.3e1 * t6063 + t6147 + t6148 - t6149 + t6150;
  t6155 = t6092 + t6093 + 0.3e1 / 0.2e1 * t2559 - t6095 - 0.21e2 / 0.2e1 * t2568 + t6097 - t6098 + 0.3e1 * t2576 - t6100 - 0.9e1 / 0.4e1 * t2583 + t7 * (t6113 + t6125 + t6138 + t6151);
  tv4rho3sigma1 = -0.3e1 * t2529 - 0.6e1 * t2532 + t6083 - t6084 + 0.9e1 / 0.2e1 * t2537 - 0.6e1 * t2539 + t6087 + t6088 + 0.14e2 * t2546 - t6090 + t6155;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  tv4rho3sigma2 = tv4rho3sigma0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t6156 = t2642 - t2613 - t2597 - t5938 - t2643 + t2644 + t2560 - t2606 + t5940 - t5941 - t5943 - t2584 - t5933 + t5935 - t2646;
  t6158 = 0.14e2 / 0.3e1 * t5954;
  t6160 = t1097 * t2581 * t4715;
  t6165 = t5993 * t1117;
  t6167 = t2567 * t2618;
  t6168 = 0.7e1 / 0.4e1 * t6167;
  t6170 = t1082 * t381 * t1005;
  t6171 = 0.3e1 / 0.2e1 * t6170;
  t6173 = t1097 * t1101 * t2153;
  t6175 = t6013 * t1114;
  t6177 = t5953 * t1114;
  t6179 = t2545 * t2635;
  t6180 = 0.7e1 / 0.3e1 * t6179;
  t6181 = -t5945 / 0.2e1 - t5951 + t6158 + t5957 - 0.3e1 / 0.4e1 * t6160 + 0.7e1 / 0.6e1 * t5961 + t5964 - t5966 + 0.3e1 / 0.4e1 * t5967 - 0.7e1 / 0.4e1 * t5969 + 0.63e2 / 0.16e2 * t6165 - t6168 + t6171 + t6173 / 0.4e1 - 0.35e2 / 0.9e1 * t6175 + 0.7e1 / 0.3e1 * t6177 + t6180;
  t6183 = t1097 * t1953 * t1114;
  t6186 = t1097 * t6019 * t4719;
  t6188 = t2567 * t2623;
  t6189 = 0.21e2 / 0.8e1 * t6188;
  t6190 = t2567 * t2626;
  t6193 = t1097 * t2581 * t4700;
  t6196 = t1097 * t1958 * t1114;
  t6199 = t1097 * t882 * t2635;
  t6200 = t6199 / 0.2e1;
  t6202 = 0.63e2 / 0.8e1 * t5994;
  t6205 = t442 * t116 * t379 * t2623;
  t6206 = 0.3e1 / 0.4e1 * t6205;
  t6207 = -t5978 + t5980 + t6183 / 0.4e1 + 0.15e2 / 0.16e2 * t6186 + t6189 - 0.7e1 / 0.4e1 * t6190 - 0.3e1 / 0.8e1 * t6193 + t6196 / 0.4e1 + t6200 + 0.21e2 / 0.16e2 * t5981 + t5984 + t5986 - t5989 + t6202 - t5997 - t6206 + t5999 + t6002;
  t6209 = 0.7e2 / 0.9e1 * t6014;
  t6212 = 0.7e1 / 0.2e1 * t6028;
  t6213 = t6031 / 0.2e1;
  t6215 = t6042 / 0.2e1;
  t6217 = 0.2e1 * t6055;
  t6219 = 0.14e2 / 0.3e1 * t6061;
  t6220 = -t6006 + t6012 - t6209 - t6018 - 0.7e1 / 0.8e1 * t6023 + t6026 / 0.4e1 - t6212 + t6213 - t6037 - 0.3e1 / 0.8e1 * t6039 + t6215 + t6046 - t6050 - t6051 + 0.3e1 / 0.4e1 * t6053 - t6217 - t6059 / 0.2e1 + t6219;
  t6221 = t1086 * t2169;
  t6223 = t2541 * t432;
  t6225 = t2553 * t432;
  t6227 = t2531 * t1005;
  t6228 = 0.3e1 / 0.2e1 * t6227;
  t6229 = t1083 * t927;
  t6230 = t1086 * t2173;
  t6232 = t1083 * t948;
  t6233 = t2545 * t1005;
  t6234 = 0.7e1 / 0.2e1 * t6233;
  t6235 = t2549 * t432;
  t6237 = t1086 * t2190;
  t6240 = t1086 * t1087 * t2152;
  t6242 = t2531 * t2635;
  t6243 = t5950 * t1114;
  t6245 = -t6063 + t6070 + t6072 - 0.15e2 / 0.8e1 * t6221 - t6223 / 0.2e1 - t6225 / 0.2e1 + t6228 - t6229 + 0.3e1 / 0.2e1 * t6230 - t6232 - t6234 + 0.7e1 / 0.3e1 * t6235 + 0.3e1 / 0.4e1 * t6237 - t6074 + t6075 - t6240 / 0.2e1 - t6242 - t6243 / 0.2e1;
  t6249 = t2647 + t2576 + t2538 + t5930 + t7 * (t6181 + t6207 + t6220 + t6245) - t2593 - t2530 + t5936 + t5926 - t5927 + t2648 - t2633 - t2636 + t5931 + t2600;
  tv4rho3sigma3 = t6156 + t6249;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t6250 = 0.3e1 * t2611;
  t6259 = 0.63e2 / 0.8e1 * t6165;
  t6260 = 0.7e1 / 0.2e1 * t6167;
  t6261 = 0.3e1 * t6170;
  t6263 = 0.7e2 / 0.9e1 * t6175;
  t6264 = 0.14e2 / 0.3e1 * t6177;
  t6265 = 0.14e2 / 0.3e1 * t6179;
  t6266 = -t5945 - 0.2e1 * t5951 + 0.28e2 / 0.3e1 * t5954 + t6105 - 0.3e1 / 0.2e1 * t6160 + 0.7e1 / 0.3e1 * t5961 + t6108 - t6109 + 0.3e1 / 0.2e1 * t5967 - 0.7e1 / 0.2e1 * t5969 + t6259 - t6260 + t6261 + t6173 / 0.2e1 - t6263 + t6264 + t6265;
  t6267 = t6183 / 0.2e1;
  t6269 = 0.21e2 / 0.4e1 * t6188;
  t6270 = 0.7e1 / 0.2e1 * t6190;
  t6272 = t6196 / 0.2e1;
  t6275 = 0.3e1 / 0.2e1 * t6205;
  t6276 = -t6114 + t6115 + t6267 + 0.15e2 / 0.8e1 * t6186 + t6269 - t6270 - 0.3e1 / 0.4e1 * t6193 + t6272 + t6199 + 0.21e2 / 0.8e1 * t5981 + t6117 + t6118 - t5988 + 0.63e2 / 0.4e1 * t5994 - t6121 - t6275 + t6122 + t6123;
  t6287 = -t6124 + t6127 - 0.14e3 / 0.9e1 * t6014 - t6017 - 0.7e1 / 0.4e1 * t6023 + t6026 / 0.2e1 - 0.7e1 * t6028 + t6031 - t6134 - 0.3e1 / 0.4e1 * t6039 + t6042 + t6137 - t6139 - 0.2e1 * t6051 + 0.3e1 / 0.2e1 * t6053 - 0.4e1 * t6055 - t6059 + 0.28e2 / 0.3e1 * t6061;
  t6290 = 0.3e1 * t6227;
  t6291 = 0.2e1 * t6229;
  t6293 = 0.2e1 * t6232;
  t6294 = 0.7e1 * t6233;
  t6295 = 0.14e2 / 0.3e1 * t6235;
  t6297 = 0.2e1 * t6242;
  t6298 = -0.2e1 * t6063 + t6147 + t6148 - 0.15e2 / 0.4e1 * t6221 - t6223 - t6225 + t6290 - t6291 + 0.3e1 * t6230 - t6293 - t6294 + t6295 + 0.3e1 / 0.2e1 * t6237 - t6149 + t6150 - t6240 - t6297 - t6243;
  t6302 = t6250 - t2670 - 0.4e1 * t2539 - t6095 - t2673 + t2619 + t2604 - 0.7e1 * t2568 + t6097 - t6098 - t6100 - t2608 - t6090 + t6092 + t7 * (t6266 + t6276 + t6287 + t6298);
  t6303 = 0.3e1 / 0.2e1 * t2624;
  t6306 = 0.2e1 * t2636;
  t6308 = -t6303 + t2627 + 0.2e1 * t2576 + t2596 + t6087 - 0.4e1 * t2532 - t2529 + t6093 + t6083 - t6084 + t2669 - t2668 - t6306 + t6088 + 0.28e2 / 0.3e1 * t2546;
  tv4rho3sigma4 = t6302 + t6308;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  tv4rho3sigma5 = tv4rho3sigma3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t6309 = t2642 - t2670 - t2539 - t5938 - t2673 + t2644 - t2569 + t5940 - t5941 - t5943 - t5933 + t5935 - t2646 + t2627 + t2577;
  t6313 = t1097 * t1101 * t2326;
  t6315 = t2567 * t2661;
  t6317 = t2567 * t2658;
  t6319 = -t5951 / 0.2e1 + 0.7e1 / 0.3e1 * t5954 + t5957 + t6313 / 0.4e1 + t5964 - t5966 + 0.21e2 / 0.16e2 * t6315 - 0.7e1 / 0.8e1 * t6317 + t6259 - t6168 + t6171 - t6263 + t6264 + t6180 - t5978 + t5980 + t6267;
  t6324 = t6189 - t6270 + t6272 + t6200 + t5984 + t5986 - t5989 + 0.63e2 / 0.16e2 * t5994 - t5997 - t6206 + t5999 + t6002 - t6006 + t6012 - 0.35e2 / 0.9e1 * t6014 - t6018 - 0.7e1 / 0.4e1 * t6028 + t6031 / 0.4e1;
  t6327 = t2531 * t2652;
  t6330 = t1086 * t1087 * t2325;
  t6332 = t2531 * t2655;
  t6334 = t2545 * t2655;
  t6336 = t2545 * t2652;
  t6341 = t1086 * t2278;
  t6343 = t1086 * t2282;
  t6345 = t1083 * t1070;
  t6347 = -t6037 + t6042 / 0.4e1 + t6046 - t6327 / 0.2e1 - t6330 / 0.2e1 + 0.3e1 / 0.4e1 * t6332 - 0.7e1 / 0.4e1 * t6334 + 0.7e1 / 0.6e1 * t6336 - t6050 - t6051 / 0.2e1 - t6055 + 0.7e1 / 0.3e1 * t6061 - t6063 / 0.2e1 + t6070 + t6072 - 0.15e2 / 0.8e1 * t6341 + 0.3e1 / 0.2e1 * t6343 + 0.3e1 / 0.4e1 * t6345;
  t6348 = t1086 * t2272;
  t6350 = t1083 * t1034;
  t6353 = t1097 * t882 * t2655;
  t6356 = t1097 * t2581 * t5135;
  t6359 = t1097 * t882 * t2652;
  t6362 = t1097 * t6019 * t5143;
  t6365 = t1097 * t2581 * t5147;
  t6367 = 0.3e1 / 0.4e1 * t6348 - t6350 / 0.2e1 - 0.3e1 / 0.8e1 * t6353 - 0.3e1 / 0.8e1 * t6356 + t6359 / 0.4e1 + 0.15e2 / 0.16e2 * t6362 - 0.3e1 / 0.4e1 * t6365 - t6223 - t6225 + t6228 - t6291 - t6232 - t6234 + t6295 - t6074 + t6075 - t6242 - t6243;
  t6371 = t2660 - t2663 + t5930 - t2654 + t2657 - t2532 + t5936 + t5926 - t5927 + t2669 - t2668 - t2636 + t5931 + t2547 + t7 * (t6319 + t6324 + t6347 + t6367);
  tv4rho3sigma6 = t6309 + t6371;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t6375 = t6250 - 0.4e1 * t2613 - t2597 - t6095 - 0.7e1 * t2616 + t2619 - t2606 + t6097 - t6098 - t6100 - t6090 + t6092 - t6303 + 0.2e1 * t2627 + t2576;
  t6384 = -t5951 + t6158 + t6105 + t6313 / 0.2e1 + t6108 - t6109 + 0.21e2 / 0.8e1 * t6315 - 0.7e1 / 0.4e1 * t6317 + 0.63e2 / 0.4e1 * t6165 - t6260 + t6261 - 0.14e3 / 0.9e1 * t6175 + 0.28e2 / 0.3e1 * t6177 + t6265 - t6114 + t6115 + t6183;
  t6386 = t6269 - 0.7e1 * t6190 + t6196 + t6199 + t6117 + t6118 - t5988 + t6202 - t6121 - t6275 + t6122 + t6123 - t6124 + t6127 - t6209 - t6017 - t6212 + t6213;
  t6394 = -t6134 + t6215 + t6137 - t6327 - t6330 + 0.3e1 / 0.2e1 * t6332 - 0.7e1 / 0.2e1 * t6334 + 0.7e1 / 0.3e1 * t6336 - t6139 - t6051 - t6217 + t6219 - t6063 + t6147 + t6148 - 0.15e2 / 0.4e1 * t6341 + 0.3e1 * t6343 + 0.3e1 / 0.2e1 * t6345;
  t6406 = 0.3e1 / 0.2e1 * t6348 - t6350 - 0.3e1 / 0.4e1 * t6353 - 0.3e1 / 0.4e1 * t6356 + t6359 / 0.2e1 + 0.15e2 / 0.8e1 * t6362 - 0.3e1 / 0.2e1 * t6365 - 0.2e1 * t6223 - 0.2e1 * t6225 + t6290 - 0.4e1 * t6229 - t6293 - t6294 + 0.28e2 / 0.3e1 * t6235 - t6149 + t6150 - t6297 - 0.2e1 * t6243;
  t6410 = t2671 - t2672 + t6087 - t2653 + t2667 - t2593 + t6093 + t6083 - t6084 + 0.28e2 / 0.3e1 * t2631 - 0.4e1 * t2633 - t6306 + t7 * (t6384 + t6386 + t6394 + t6406) + t6088 + t2600;
  tv4rho3sigma7 = t6375 + t6410;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  tv4rho3sigma8 = tv4rho3sigma6;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t6412 = t1097 * t1101 * t2446;
  t6415 = t1097 * t6019 * t2420;
  t6418 = t1086 * t1087 * t2445;
  t6425 = t5957 + t6412 / 0.4e1 + 0.15e2 / 0.16e2 * t6415 + t5964 - t5966 - t6418 / 0.2e1 + 0.63e2 / 0.16e2 * t6315 - 0.21e2 / 0.8e1 * t6317 + 0.189e3 / 0.16e2 * t6165 - 0.35e2 / 0.3e1 * t6175 + 0.7e1 * t6177 - t5978;
  t6429 = t5980 + 0.3e1 / 0.4e1 * t6183 - 0.21e2 / 0.4e1 * t6190 + 0.3e1 / 0.4e1 * t6196 + t5984 + t5986 - t5989 - t5997 + t5999 + t6002 - t6006 + t6012;
  t6432 = t1097 * t2581 * t5598;
  t6438 = t1086 * t2451;
  t6440 = -t6018 - 0.9e1 / 0.8e1 * t6432 - t6037 + t6046 - 0.3e1 / 0.2e1 * t6327 + 0.9e1 / 0.4e1 * t6332 - 0.21e2 / 0.4e1 * t6334 + 0.7e1 / 0.2e1 * t6336 + 0.9e1 / 0.4e1 * t6438 - t6050 + t6070 + t6072;
  t6450 = t1086 * t2167 * t2419;
  t6453 = 0.9e1 / 0.4e1 * t6345 - 0.3e1 / 0.2e1 * t6350 - 0.9e1 / 0.8e1 * t6353 + 0.3e1 / 0.4e1 * t6359 - 0.3e1 / 0.2e1 * t6223 - 0.3e1 / 0.2e1 * t6225 - 0.3e1 * t6229 + 0.7e1 * t6235 - t6074 + t6075 - 0.15e2 / 0.8e1 * t6450 - 0.3e1 / 0.2e1 * t6243;
  t6467 = -t5933 + t5935 + t5936 + 0.3e1 / 0.4e1 * t2659 - t5938 + t5940 - t5941 - 0.9e1 / 0.8e1 * t2662 - 0.21e2 / 0.4e1 * t2616 + 0.3e1 / 0.2e1 * t2627 - t5943;
  tv4rho3sigma9 = t7 * (t6425 + t6429 + t6440 + t6453) - 0.3e1 / 0.2e1 * t2653 + 0.9e1 / 0.4e1 * t2656 - 0.3e1 * t2633 + 0.7e1 * t2631 - 0.3e1 * t2613 + t5926 - t5927 + t5930 + t5931 + t6467;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  t6475 = t6105 + t6412 / 0.2e1 + 0.15e2 / 0.8e1 * t6415 + t6108 - t6109 - t6418 + 0.63e2 / 0.8e1 * t6315 - 0.21e2 / 0.4e1 * t6317 + 0.189e3 / 0.8e1 * t6165 - 0.7e2 / 0.3e1 * t6175 + 0.14e2 * t6177 - t6114;
  t6479 = t6115 + 0.3e1 / 0.2e1 * t6183 - 0.21e2 / 0.2e1 * t6190 + 0.3e1 / 0.2e1 * t6196 + t6117 + t6118 - t5988 - t6121 + t6122 + t6123 - t6124 + t6127;
  t6487 = -t6017 - 0.9e1 / 0.4e1 * t6432 - t6134 + t6137 - 0.3e1 * t6327 + 0.9e1 / 0.2e1 * t6332 - 0.21e2 / 0.2e1 * t6334 + 0.7e1 * t6336 + 0.9e1 / 0.2e1 * t6438 - t6139 + t6147 + t6148;
  t6498 = 0.9e1 / 0.2e1 * t6345 - 0.3e1 * t6350 - 0.9e1 / 0.4e1 * t6353 + 0.3e1 / 0.2e1 * t6359 - 0.3e1 * t6223 - 0.3e1 * t6225 - 0.6e1 * t6229 + 0.14e2 * t6235 - t6149 + t6150 - 0.15e2 / 0.4e1 * t6450 - 0.3e1 * t6243;
  t6512 = -t6090 + t6092 + t6093 + 0.3e1 / 0.2e1 * t2659 - t6095 + t6097 - t6098 - 0.9e1 / 0.4e1 * t2662 - 0.21e2 / 0.2e1 * t2616 + 0.3e1 * t2627 - t6100;
  tv4rho3sigma10 = t7 * (t6475 + t6479 + t6487 + t6498) - 0.3e1 * t2653 + 0.9e1 / 0.2e1 * t2656 - 0.6e1 * t2633 + 0.14e2 * t2631 - 0.6e1 * t2613 + t6083 - t6084 + t6087 + t6088 + t6512;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  tv4rho3sigma11 = tv4rho3sigma9;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t6513 = t2697 * t2558;
  t6515 = t2697 * t2575;
  t6516 = t6515 / 0.4e1;
  t6517 = t2697 * t2578;
  t6518 = t6517 / 0.4e1;
  t6519 = t2697 * t2582;
  t6521 = t2676 * t2680;
  t6522 = t6521 * t1102;
  t6523 = 0.21e2 / 0.8e1 * t6522;
  t6524 = t6521 * t1098;
  t6525 = 0.21e2 / 0.4e1 * t6524;
  t6526 = t2681 * t2572;
  t6527 = 0.3e1 / 0.4e1 * t6526;
  t6528 = t2681 * t2558;
  t6534 = 0.1e1 / t126 / t661 * t1134 * t1136 * t1139;
  t6535 = 0.119e3 / 0.18e2 * t6534;
  t6537 = t2688 * t2692 * t725;
  t6538 = 0.7e1 / 0.3e1 * t6537;
  t6540 = t2688 * t2696;
  t6541 = t6540 * t1102;
  t6542 = 0.7e1 / 0.6e1 * t6541;
  t6543 = t6540 * t1098;
  t6544 = 0.7e1 / 0.3e1 * t6543;
  t6545 = t2693 * t1558;
  t6546 = t6545 / 0.4e1;
  t6547 = t2697 * t2572;
  t6548 = t6547 / 0.4e1;
  t6551 = t2562 * params->ftilde * t115 * t1129;
  t6552 = 0.189e3 / 0.16e2 * t6551;
  t6553 = t2681 * t2575;
  t6554 = 0.3e1 / 0.4e1 * t6553;
  t6555 = t2681 * t2578;
  t6556 = 0.3e1 / 0.4e1 * t6555;
  t6557 = t2681 * t2582;
  t6563 = t1135 * t1136 * t734 * t6033 * t166 * t736;
  t6564 = t6563 / 0.2e1;
  t6568 = t2693 * t1101 * t166 * t371 * t397;
  t6569 = t6568 / 0.4e1;
  t6571 = t2693 * t882 * t386;
  t6572 = t6571 / 0.2e1;
  t6573 = t6542 - t6544 - t6546 + t6548 - t6552 + t6554 - t6556 - 0.9e1 / 0.16e2 * t6557 + t6564 + t6569 - t6572;
  tv4rho2sigma20 = t2704 - t2705 + t2706 - t2707 - t2708 + t2709 - t2710 + t7 * (-t6513 / 0.8e1 - t6516 + t6518 + 0.3e1 / 0.16e2 * t6519 - t6523 + t6525 - t6527 + 0.3e1 / 0.8e1 * t6528 + t6535 + t6538 + t6573);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t6577 = t6515 / 0.2e1;
  t6578 = t6517 / 0.2e1;
  t6580 = 0.21e2 / 0.4e1 * t6522;
  t6581 = 0.21e2 / 0.2e1 * t6524;
  t6582 = 0.3e1 / 0.2e1 * t6526;
  t6584 = 0.119e3 / 0.9e1 * t6534;
  t6585 = 0.14e2 / 0.3e1 * t6537;
  t6587 = 0.7e1 / 0.3e1 * t6541;
  t6588 = 0.14e2 / 0.3e1 * t6543;
  t6589 = t6545 / 0.2e1;
  t6590 = t6547 / 0.2e1;
  t6591 = 0.189e3 / 0.8e1 * t6551;
  t6592 = 0.3e1 / 0.2e1 * t6553;
  t6593 = 0.3e1 / 0.2e1 * t6555;
  t6595 = t6568 / 0.2e1;
  t6596 = t6587 - t6588 - t6589 + t6590 - t6591 + t6592 - t6593 - 0.9e1 / 0.8e1 * t6557 + t6563 + t6595 - t6571;
  tv4rho2sigma21 = t2713 - t2714 + t2715 - t2716 - t2694 + t2698 - t2717 + t7 * (-t6513 / 0.4e1 - t6577 + t6578 + 0.3e1 / 0.8e1 * t6519 - t6580 + t6581 - t6582 + 0.3e1 / 0.4e1 * t6528 + t6584 + t6585 + t6596);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = tv4rho2sigma20;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  t6599 = 0.21e2 * t2678;
  t6600 = 0.6e1 * t2682;
  t6602 = 0.28e2 / 0.3e1 * t2690;
  t6603 = 0.2e1 * t2694;
  t6604 = 0.2e1 * t2698;
  t6608 = 0.21e2 * t6524;
  t6609 = 0.3e1 * t6526;
  t6611 = 0.238e3 / 0.9e1 * t6534;
  t6612 = 0.28e2 / 0.3e1 * t6537;
  t6615 = 0.28e2 / 0.3e1 * t6543;
  t6616 = 0.189e3 / 0.4e1 * t6551;
  t6618 = 0.3e1 * t6555;
  t6620 = 0.2e1 * t6563;
  t6621 = 0.2e1 * t6571;
  t6622 = 0.14e2 / 0.3e1 * t6541 - t6615 - t6545 + t6547 - t6616 + 0.3e1 * t6553 - t6618 - 0.9e1 / 0.4e1 * t6557 + t6620 + t6568 - t6621;
  tv4rho2sigma23 = t6599 - t6600 + 0.3e1 * t2684 - t6602 - t6603 + t6604 - t2700 + t7 * (-t6513 / 0.2e1 - t6515 + t6517 + 0.3e1 / 0.4e1 * t6519 - 0.21e2 / 0.2e1 * t6522 + t6608 - t6609 + 0.3e1 / 0.2e1 * t6528 + t6611 + t6612 + t6622);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = tv4rho2sigma21;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = tv4rho2sigma22;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6625 = t6540 * t1117;
  t6627 = t6521 * t1117;
  t6629 = t2697 * t2618;
  t6633 = t2693 * t1101 * t431 * t371;
  t6635 = t2697 * t2623;
  t6637 = t2697 * t2626;
  t6639 = t2681 * t2623;
  t6641 = t2681 * t2626;
  t6643 = t2681 * t2618;
  t6646 = 0.7e1 / 0.12e2 * t6625 - 0.21e2 / 0.16e2 * t6627 - t6629 / 0.8e1 + t6633 / 0.8e1 + 0.3e1 / 0.16e2 * t6635 - t6637 / 0.8e1 - 0.9e1 / 0.16e2 * t6639 + 0.3e1 / 0.8e1 * t6641 + 0.3e1 / 0.8e1 * t6643 - 0.21e2 / 0.16e2 * t6522 + t6525 - t6527 + t6538;
  t6651 = 0.7e1 / 0.12e2 * t6541 - t6544 - t6546 + t6548 - t6556 + t6564 + t6518 + 0.3e1 / 0.8e1 * t6553 + t6568 / 0.8e1 - t6572 - t6515 / 0.8e1 + t6535 - t6552;
  tv4rho2sigma26 = t2704 - t2705 + t2685 - t2707 - t2708 + t2709 - t2701 + t2721 - t2723 + t7 * (t6646 + t6651);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  t6654 = 0.7e1 / 0.6e1 * t6625;
  t6655 = 0.21e2 / 0.8e1 * t6627;
  t6657 = t6633 / 0.4e1;
  t6659 = t6637 / 0.4e1;
  t6661 = 0.3e1 / 0.4e1 * t6641;
  t6663 = t6654 - t6655 - t6629 / 0.4e1 + t6657 + 0.3e1 / 0.8e1 * t6635 - t6659 - 0.9e1 / 0.8e1 * t6639 + t6661 + 0.3e1 / 0.4e1 * t6643 - t6523 + t6581 - t6582 + t6585;
  t6664 = t6542 - t6588 - t6589 + t6590 - t6593 + t6563 + t6578 + t6554 + t6569 - t6571 - t6516 + t6584 - t6591;
  tv4rho2sigma27 = t2713 - t2714 + t2706 - t2716 - t2694 + t2698 - t2710 + t2726 - t2727 + t7 * (t6663 + t6664);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = tv4rho2sigma26;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  t6667 = 0.7e1 / 0.3e1 * t6625;
  t6668 = 0.21e2 / 0.4e1 * t6627;
  t6670 = t6633 / 0.2e1;
  t6672 = t6637 / 0.2e1;
  t6674 = 0.3e1 / 0.2e1 * t6641;
  t6676 = t6667 - t6668 - t6629 / 0.2e1 + t6670 + 0.3e1 / 0.4e1 * t6635 - t6672 - 0.9e1 / 0.4e1 * t6639 + t6674 + 0.3e1 / 0.2e1 * t6643 - t6580 + t6608 - t6609 + t6612;
  t6677 = t6587 - t6615 - t6545 + t6547 - t6618 + t6620 + t6517 + t6592 + t6595 - t6621 - t6577 + t6611 - t6616;
  tv4rho2sigma29 = t6599 - t6600 + t2715 - t6602 - t6603 + t6604 - t2717 + t2730 - t2731 + t7 * (t6676 + t6677);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = tv4rho2sigma27;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = tv4rho2sigma28;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6681 = t2697 * t2658;
  t6683 = t2681 * t2658;
  t6685 = t2681 * t2661;
  t6687 = t2697 * t2661;
  t6689 = -t6544 - t6546 + t6548 - t6552 - t6556 + t6564 - t6572 - t6681 / 0.8e1 + 0.3e1 / 0.8e1 * t6683 - 0.9e1 / 0.16e2 * t6685 + 0.3e1 / 0.16e2 * t6687;
  tv4rho2sigma212 = t2704 - t2705 + t2726 - t2707 - t2708 + t2709 - t2727 + t7 * (t6654 + t6657 - t6659 - t6655 + t6661 + t6518 + t6525 - t6527 + t6535 + t6538 + t6689);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  t6697 = -t6588 - t6589 + t6590 - t6591 - t6593 + t6563 - t6571 - t6681 / 0.4e1 + 0.3e1 / 0.4e1 * t6683 - 0.9e1 / 0.8e1 * t6685 + 0.3e1 / 0.8e1 * t6687;
  tv4rho2sigma213 = t2713 - t2714 + t2730 - t2716 - t2694 + t2698 - t2731 + t7 * (t6667 + t6670 - t6672 - t6668 + t6674 + t6578 + t6581 - t6582 + t6584 + t6585 + t6697);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = tv4rho2sigma212;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  t6709 = -t6615 - t6545 + t6547 - t6616 - t6618 + t6620 - t6621 - t6681 / 0.2e1 + 0.3e1 / 0.2e1 * t6683 - 0.9e1 / 0.4e1 * t6685 + 0.3e1 / 0.4e1 * t6687;
  tv4rho2sigma215 = t6599 - t6600 + 0.3e1 * t2720 - t6602 - t6603 + t6604 - t2722 + t7 * (0.14e2 / 0.3e1 * t6625 + t6633 - t6637 - 0.21e2 / 0.2e1 * t6627 + 0.3e1 * t6641 + t6517 + t6608 - t6609 + t6611 + t6612 + t6709);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = tv4rho2sigma213;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  tv4rho2sigma217 = tv4rho2sigma214;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t6712 = t2677 * t2737;
  t6713 = 0.21e2 / 0.16e2 * t6712;
  t6715 = t1125 * t115 * t2735;
  t6716 = t6715 * t1098;
  t6717 = 0.3e1 / 0.8e1 * t6716;
  t6718 = t6715 * t1102;
  t6721 = t2688 * t2741 * t1139;
  t6722 = 0.7e1 / 0.4e1 * t6721;
  t6723 = t348 * t152;
  t6725 = t2742 * t6723 * t386;
  t6726 = 0.3e1 / 0.8e1 * t6725;
  t6729 = t2742 * t144 * t379 * t6034;
  t6730 = 0.3e1 / 0.8e1 * t6729;
  t6732 = t2742 * t1138 * t1088;
  t6738 = 0.1e1 / t2747 / t661 * t2750 * t2753 * t1129;
  t6739 = 0.35e2 / 0.48e2 * t6738;
  t6743 = t2751 * t2752 * t734 * t1128 * t386;
  t6744 = t6743 / 0.4e1;
  t6747 = t2754 * t1127 * t379 * t6034;
  t6748 = t6747 / 0.8e1;
  t6750 = t2754 * t1128 * t1088;
  t6752 = -t6713 + t6717 - 0.3e1 / 0.16e2 * t6718 - t6722 - t6726 + t6730 - 0.3e1 / 0.16e2 * t6732 + t6739 + t6744 - t6748 + t6750 / 0.16e2;
  tv4rhosigma30 = t6752 * t7 + t2739 + t2744 - t2756;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t6754 = 0.21e2 / 0.8e1 * t6712;
  t6755 = 0.3e1 / 0.4e1 * t6716;
  t6757 = 0.7e1 / 0.2e1 * t6721;
  t6758 = 0.3e1 / 0.4e1 * t6725;
  t6759 = 0.3e1 / 0.4e1 * t6729;
  t6761 = 0.35e2 / 0.24e2 * t6738;
  t6762 = t6743 / 0.2e1;
  t6763 = t6747 / 0.4e1;
  t6765 = -t6754 + t6755 - 0.3e1 / 0.8e1 * t6718 - t6757 - t6758 + t6759 - 0.3e1 / 0.8e1 * t6732 + t6761 + t6762 - t6763 + t6750 / 0.8e1;
  tv4rhosigma31 = t6765 * t7 + t2758 + t2759 - t2760;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = tv4rhosigma30;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  t6767 = 0.21e2 / 0.4e1 * t6712;
  t6768 = 0.3e1 / 0.2e1 * t6716;
  t6770 = 0.7e1 * t6721;
  t6771 = 0.3e1 / 0.2e1 * t6725;
  t6772 = 0.3e1 / 0.2e1 * t6729;
  t6774 = 0.35e2 / 0.12e2 * t6738;
  t6775 = t6747 / 0.2e1;
  t6777 = -t6767 + t6768 - 0.3e1 / 0.4e1 * t6718 - t6770 - t6771 + t6772 - 0.3e1 / 0.4e1 * t6732 + t6774 + t6743 - t6775 + t6750 / 0.4e1;
  tv4rhosigma33 = t6777 * t7 + t2762 + t2763 - t2764;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = tv4rhosigma31;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = tv4rhosigma32;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  t6779 = 0.21e2 / 0.2e1 * t6712;
  t6780 = 0.3e1 * t6716;
  t6782 = 0.14e2 * t6721;
  t6783 = 0.3e1 * t6725;
  t6784 = 0.3e1 * t6729;
  t6786 = 0.35e2 / 0.6e1 * t6738;
  t6787 = 0.2e1 * t6743;
  t6789 = -t6779 + t6780 - 0.3e1 / 0.2e1 * t6718 - t6782 - t6783 + t6784 - 0.3e1 / 0.2e1 * t6732 + t6786 + t6787 - t6747 + t6750 / 0.2e1;
  tv4rhosigma36 = t6789 * t7 - t2755 + t2766 + t2767;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = tv4rhosigma33;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = tv4rhosigma34;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = tv4rhosigma35;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t6791 = t6715 * t1117;
  t6794 = t2742 * t1138 * t1114;
  t6797 = t2754 * t1128 * t1114;
  t6799 = -t6713 + t6717 - 0.3e1 / 0.16e2 * t6791 - t6722 - t6726 + t6730 - 0.3e1 / 0.16e2 * t6794 + t6739 + t6744 - t6748 + t6797 / 0.16e2;
  tv4rhosigma310 = t6799 * t7 + t2739 + t2744 - t2756;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  t6804 = -t6754 + t6755 - 0.3e1 / 0.8e1 * t6791 - t6757 - t6758 + t6759 - 0.3e1 / 0.8e1 * t6794 + t6761 + t6762 - t6763 + t6797 / 0.8e1;
  tv4rhosigma311 = t6804 * t7 + t2758 + t2759 - t2760;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = tv4rhosigma310;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  t6809 = -t6767 + t6768 - 0.3e1 / 0.4e1 * t6791 - t6770 - t6771 + t6772 - 0.3e1 / 0.4e1 * t6794 + t6774 + t6743 - t6775 + t6797 / 0.4e1;
  tv4rhosigma313 = t6809 * t7 + t2762 + t2763 - t2764;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = tv4rhosigma311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = tv4rhosigma312;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  t6814 = -t6779 + t6780 - 0.3e1 / 0.2e1 * t6791 - t6782 - t6783 + t6784 - 0.3e1 / 0.2e1 * t6794 + t6786 + t6787 - t6747 + t6797 / 0.2e1;
  tv4rhosigma316 = t6814 * t7 - t2755 + t2766 + t2767;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = tv4rhosigma313;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = tv4rhosigma314;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  tv4rhosigma319 = tv4rhosigma315;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t6816 = t111 * t111;
  t6821 = t1126 / t145 / t6816 * t152 * t382;
  t6826 = t1135 * t1136 / t6816 * t1139;
  t6831 = t2751 * t2752 * t2735 * t6723 * t382;
  t6833 = t1134 * t1134;
  t6835 = t1136 * t1136;
  t6840 = t1301 * t6833 * t6835 * t734 * t2740 * t152 * t382;
  tv4sigma40 = t7 * (-0.9e1 / 0.16e2 * t6821 - 0.9e1 / 0.16e2 * t6826 - t6831 / 0.8e1 + t6840 / 0.16e2);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = t7 * (-0.9e1 / 0.8e1 * t6821 - 0.9e1 / 0.8e1 * t6826 - t6831 / 0.4e1 + t6840 / 0.8e1);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = tv4sigma40;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = t7 * (-0.9e1 / 0.4e1 * t6821 - 0.9e1 / 0.4e1 * t6826 - t6831 / 0.2e1 + t6840 / 0.4e1);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = tv4sigma41;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = tv4sigma42;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = t7 * (-0.9e1 / 0.2e1 * t6821 - 0.9e1 / 0.2e1 * t6826 - t6831 + t6840 / 0.2e1);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = tv4sigma43;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = tv4sigma44;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = tv4sigma45;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = t7 * (-0.9e1 * t6821 - 0.9e1 * t6826 - 0.2e1 * t6831 + t6840);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = tv4sigma46;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = tv4sigma47;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = tv4sigma48;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  tv4sigma414 = tv4sigma49;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

