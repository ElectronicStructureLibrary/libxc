/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/mgga_k_csk_loc.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t39, t40, t41;
  double t44, t45, t46, t48, t52, t54, t55, t56;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t72, t76;
  double tzk0;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t25 * t29;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t37 = t33 * t36;
  t39 = 0.5e1 / 0.72e2 * t30 * t37;
  t40 = params->csk_cp * t25;
  t41 = t40 * t29;
  t44 = params->csk_cq * t25;
  t45 = t44 * t29;
  t46 = lapl[0] * t32;
  t48 = 0.1e1 / t23 / rho[0];
  t52 = t41 * t37 / 0.24e2 + t45 * t46 * t48 / 0.24e2 - t39;
  t54 = log(0.1e1 - DBL_EPSILON);
  t55 = 0.1e1 / params->csk_a;
  t56 = pow(-t54, -t55);
  t57 = t52 < -t56;
  t58 = log(DBL_EPSILON);
  t59 = pow(-t58, -t55);
  t60 = -t59 < t52;
  t61 = my_piecewise3(t60, -t59, t52);
  t62 = -t56 < t61;
  t63 = my_piecewise3(t62, t61, -t56);
  t64 = fabs(t63);
  t65 = pow(t64, params->csk_a);
  t66 = 0.1e1 / t65;
  t67 = exp(-t66);
  t68 = 0.1e1 - t67;
  t69 = pow(t68, t55);
  t70 = my_piecewise5(t57, 0, t60, 1, t69);
  t72 = t52 * t70 + t39 + 0.1e1;
  t76 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t39, t40, t41;
  double t44, t45, t46, t48, t52, t54, t55, t56;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t72, t76;
  double tzk0;

  double t78, t82, t84, t85, t87, t93, t95, t96;
  double t97, t99, t100, t102, t103, t104, t106, t108;
  double t113, tvrho0, t116, t118, t119, t120, t123, t125;
  double t126, t129, t131, t135, tvsigma0, t137, t144, t145;
  double t148, t150, t154, tvlapl0, tvtau0;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t25 * t29;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t37 = t33 * t36;
  t39 = 0.5e1 / 0.72e2 * t30 * t37;
  t40 = params->csk_cp * t25;
  t41 = t40 * t29;
  t44 = params->csk_cq * t25;
  t45 = t44 * t29;
  t46 = lapl[0] * t32;
  t48 = 0.1e1 / t23 / rho[0];
  t52 = t41 * t37 / 0.24e2 + t45 * t46 * t48 / 0.24e2 - t39;
  t54 = log(0.1e1 - DBL_EPSILON);
  t55 = 0.1e1 / params->csk_a;
  t56 = pow(-t54, -t55);
  t57 = t52 < -t56;
  t58 = log(DBL_EPSILON);
  t59 = pow(-t58, -t55);
  t60 = -t59 < t52;
  t61 = my_piecewise3(t60, -t59, t52);
  t62 = -t56 < t61;
  t63 = my_piecewise3(t62, t61, -t56);
  t64 = fabs(t63);
  t65 = pow(t64, params->csk_a);
  t66 = 0.1e1 / t65;
  t67 = exp(-t66);
  t68 = 0.1e1 - t67;
  t69 = pow(t68, t55);
  t70 = my_piecewise5(t57, 0, t60, 1, t69);
  t72 = t52 * t70 + t39 + 0.1e1;
  t76 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t78 = t21 / t22;
  t82 = t34 * rho[0];
  t84 = 0.1e1 / t23 / t82;
  t85 = t33 * t84;
  t87 = 0.5e1 / 0.27e2 * t30 * t85;
  t93 = -t41 * t85 / 0.9e1 - 0.5e1 / 0.72e2 * t45 * t46 * t36 + t87;
  t95 = t69 * t66;
  t96 = my_piecewise3(t60, 0, t93);
  t97 = my_piecewise3(t62, t96, 0);
  t99 = fabs(t63) / t63;
  t100 = 0.1e1 / t64;
  t102 = 0.1e1 / t68;
  t103 = t67 * t102;
  t104 = t99 * t100 * t103;
  t106 = my_piecewise5(t57, 0, t60, 0, -t95 * t97 * t104);
  t108 = t52 * t106 + t93 * t70 - t87;
  t113 = my_piecewise3(t3, 0, t8 * t78 * t72 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t108);
  tvrho0 = 0.2e1 * rho[0] * t113 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t116 = t32 * t36;
  t118 = 0.5e1 / 0.72e2 * t30 * t116;
  t119 = t29 * t32;
  t120 = t119 * t36;
  t123 = t40 * t120 / 0.24e2 - t118;
  t125 = my_piecewise3(t60, 0, t123);
  t126 = my_piecewise3(t62, t125, 0);
  t129 = my_piecewise5(t57, 0, t60, 0, -t95 * t126 * t104);
  t131 = t123 * t70 + t52 * t129 + t118;
  t135 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t131);
  tvsigma0 = 0.2e1 * rho[0] * t135;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t137 = t32 * t48;
  t144 = my_piecewise3(t60, 0, t44 * t119 * t48 / 0.24e2);
  t145 = my_piecewise3(t62, t144, 0);
  t148 = my_piecewise5(t57, 0, t60, 0, -t95 * t145 * t104);
  t150 = t45 * t137 * t70 / 0.24e2 + t52 * t148;
  t154 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t150);
  tvlapl0 = 0.2e1 * rho[0] * t154;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t39, t40, t41;
  double t44, t45, t46, t48, t52, t54, t55, t56;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t72, t76;
  double tzk0;

  double t78, t82, t84, t85, t87, t93, t95, t96;
  double t97, t99, t100, t102, t103, t104, t106, t108;
  double t113, tvrho0, t116, t118, t119, t120, t123, t125;
  double t126, t129, t131, t135, tvsigma0, t137, t144, t145;
  double t148, t150, t154, tvlapl0, tvtau0;

  double t159, t166, t168, t169, t171, t177, t181, t183;
  double t184, t186, t187, t188, t189, t190, t191, t192;
  double t193, t194, t196, t198, t199, t200, t202, t203;
  double t206, t207, t209, t210, t211, t213, t215, t216;
  double t217, t220, t222, t227, tv2rho20, t233, t235, t236;
  double t239, t243, t244, t245, t246, t248, t249, t250;
  double t251, t253, t254, t257, t259, t260, t261, t263;
  double t265, t266, t269, t271, t276, tv2rhosigma0, t289, t290;
  double t292, t293, t297, t298, t301, t303, t305, t309;
  double t311, t316, tv2rholapl0, tv2rhotau0, t321, t324, t327, t328;
  double t330, t331, t332, t334, t338, t340, t344, tv2sigma20;
  double t352, t354, t355, t356, t357, t358, t361, t362;
  double t365, t367, t371, tv2sigmalapl0, tv2sigmatau0, t376, t379, t382;
  double t383, t385, t389, t391, t395, tv2lapl20, tv2lapltau0, tv2tau20;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t25 * t29;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t37 = t33 * t36;
  t39 = 0.5e1 / 0.72e2 * t30 * t37;
  t40 = params->csk_cp * t25;
  t41 = t40 * t29;
  t44 = params->csk_cq * t25;
  t45 = t44 * t29;
  t46 = lapl[0] * t32;
  t48 = 0.1e1 / t23 / rho[0];
  t52 = t41 * t37 / 0.24e2 + t45 * t46 * t48 / 0.24e2 - t39;
  t54 = log(0.1e1 - DBL_EPSILON);
  t55 = 0.1e1 / params->csk_a;
  t56 = pow(-t54, -t55);
  t57 = t52 < -t56;
  t58 = log(DBL_EPSILON);
  t59 = pow(-t58, -t55);
  t60 = -t59 < t52;
  t61 = my_piecewise3(t60, -t59, t52);
  t62 = -t56 < t61;
  t63 = my_piecewise3(t62, t61, -t56);
  t64 = fabs(t63);
  t65 = pow(t64, params->csk_a);
  t66 = 0.1e1 / t65;
  t67 = exp(-t66);
  t68 = 0.1e1 - t67;
  t69 = pow(t68, t55);
  t70 = my_piecewise5(t57, 0, t60, 1, t69);
  t72 = t52 * t70 + t39 + 0.1e1;
  t76 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t78 = t21 / t22;
  t82 = t34 * rho[0];
  t84 = 0.1e1 / t23 / t82;
  t85 = t33 * t84;
  t87 = 0.5e1 / 0.27e2 * t30 * t85;
  t93 = -t41 * t85 / 0.9e1 - 0.5e1 / 0.72e2 * t45 * t46 * t36 + t87;
  t95 = t69 * t66;
  t96 = my_piecewise3(t60, 0, t93);
  t97 = my_piecewise3(t62, t96, 0);
  t99 = fabs(t63) / t63;
  t100 = 0.1e1 / t64;
  t102 = 0.1e1 / t68;
  t103 = t67 * t102;
  t104 = t99 * t100 * t103;
  t106 = my_piecewise5(t57, 0, t60, 0, -t95 * t97 * t104);
  t108 = t52 * t106 + t93 * t70 - t87;
  t113 = my_piecewise3(t3, 0, t8 * t78 * t72 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t108);
  tvrho0 = 0.2e1 * rho[0] * t113 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t116 = t32 * t36;
  t118 = 0.5e1 / 0.72e2 * t30 * t116;
  t119 = t29 * t32;
  t120 = t119 * t36;
  t123 = t40 * t120 / 0.24e2 - t118;
  t125 = my_piecewise3(t60, 0, t123);
  t126 = my_piecewise3(t62, t125, 0);
  t129 = my_piecewise5(t57, 0, t60, 0, -t95 * t126 * t104);
  t131 = t123 * t70 + t52 * t129 + t118;
  t135 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t131);
  tvsigma0 = 0.2e1 * rho[0] * t135;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t137 = t32 * t48;
  t144 = my_piecewise3(t60, 0, t44 * t119 * t48 / 0.24e2);
  t145 = my_piecewise3(t62, t144, 0);
  t148 = my_piecewise5(t57, 0, t60, 0, -t95 * t145 * t104);
  t150 = t45 * t137 * t70 / 0.24e2 + t52 * t148;
  t154 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t150);
  tvlapl0 = 0.2e1 * rho[0] * t154;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t159 = t21 / t22 / rho[0];
  t166 = t34 * t34;
  t168 = 0.1e1 / t23 / t166;
  t169 = t33 * t168;
  t171 = 0.55e2 / 0.81e2 * t30 * t169;
  t177 = 0.11e2 / 0.27e2 * t41 * t169 + 0.5e1 / 0.27e2 * t45 * t46 * t84 - t171;
  t181 = t65 * t65;
  t183 = t69 / t181;
  t184 = t97 * t97;
  t186 = t99 * t99;
  t187 = t64 * t64;
  t188 = 0.1e1 / t187;
  t189 = t186 * t188;
  t190 = t67 * t67;
  t191 = t68 * t68;
  t192 = 0.1e1 / t191;
  t193 = t190 * t192;
  t194 = t189 * t193;
  t196 = t184 * t186;
  t198 = t188 * t67;
  t199 = t102 * params->csk_a;
  t200 = t198 * t199;
  t202 = my_piecewise3(t60, 0, t177);
  t203 = my_piecewise3(t62, t202, 0);
  t206 = t95 * t184;
  t207 = 0.0;
  t209 = t207 * t100 * t103;
  t210 = t206 * t209;
  t211 = t189 * t103;
  t213 = t183 * t196;
  t215 = t188 * t190;
  t216 = t192 * params->csk_a;
  t217 = t215 * t216;
  t220 = my_piecewise5(t57, 0, t60, 0, -t95 * t203 * t104 + t183 * t184 * t194 + t95 * t196 * t200 - t213 * t200 + t206 * t211 - t213 * t217 - t210);
  t222 = 0.2e1 * t93 * t106 + t177 * t70 + t52 * t220 + t171;
  t227 = my_piecewise3(t3, 0, -t8 * t159 * t72 / 0.3e2 + t8 * t78 * t108 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t222);
  tv2rho20 = 0.2e1 * rho[0] * t227 + 0.4e1 * t113;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t233 = t32 * t84;
  t235 = 0.5e1 / 0.27e2 * t30 * t233;
  t236 = t119 * t84;
  t239 = -t40 * t236 / 0.9e1 + t235;
  t243 = t97 * t186;
  t244 = t183 * t243;
  t245 = t192 * t126;
  t246 = t215 * t245;
  t248 = t126 * t186;
  t249 = t95 * t248;
  t250 = t199 * t97;
  t251 = t198 * t250;
  t253 = my_piecewise3(t60, 0, t239);
  t254 = my_piecewise3(t62, t253, 0);
  t257 = t126 * t97;
  t259 = t95 * t257 * t209;
  t260 = t102 * t97;
  t261 = t198 * t260;
  t263 = t183 * t248;
  t265 = t216 * t97;
  t266 = t215 * t265;
  t269 = my_piecewise5(t57, 0, t60, 0, -t95 * t254 * t104 + t244 * t246 + t249 * t251 + t249 * t261 - t263 * t251 - t263 * t266 - t259);
  t271 = t123 * t106 + t93 * t129 + t239 * t70 + t52 * t269 - t235;
  t276 = my_piecewise3(t3, 0, t8 * t78 * t131 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t271);
  tv2rhosigma0 = 0.2e1 * rho[0] * t276 + 0.2e1 * t135;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t289 = t192 * t145;
  t290 = t215 * t289;
  t292 = t145 * t186;
  t293 = t95 * t292;
  t297 = my_piecewise3(t60, 0, -0.5e1 / 0.72e2 * t44 * t120);
  t298 = my_piecewise3(t62, t297, 0);
  t301 = t145 * t97;
  t303 = t95 * t301 * t209;
  t305 = t183 * t292;
  t309 = my_piecewise5(t57, 0, t60, 0, -t95 * t298 * t104 + t244 * t290 + t293 * t251 - t305 * t251 + t293 * t261 - t305 * t266 - t303);
  t311 = -0.5e1 / 0.72e2 * t45 * t116 * t70 + t45 * t137 * t106 / 0.24e2 + t93 * t148 + t52 * t309;
  t316 = my_piecewise3(t3, 0, t8 * t78 * t150 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t311);
  tv2rholapl0 = 0.2e1 * rho[0] * t316 + 0.2e1 * t154;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t321 = t126 * t126;
  t324 = t321 * t186;
  t327 = my_piecewise3(t60, 0, 0);
  t328 = my_piecewise3(t62, t327, 0);
  t330 = t95 * t328 * t104;
  t331 = t95 * t321;
  t332 = t331 * t209;
  t334 = t183 * t324;
  t338 = my_piecewise5(t57, 0, t60, 0, t183 * t321 * t194 + t95 * t324 * t200 - t334 * t200 + t331 * t211 - t334 * t217 - t330 - t332);
  t340 = 0.2e1 * t123 * t129 + t52 * t338;
  t344 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t340);
  tv2sigma20 = 0.2e1 * rho[0] * t344;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t352 = t198 * t199 * t126;
  t354 = t145 * t126;
  t355 = t95 * t354;
  t356 = t355 * t209;
  t357 = t102 * t126;
  t358 = t198 * t357;
  t361 = t216 * t126;
  t362 = t215 * t361;
  t365 = my_piecewise5(t57, 0, t60, 0, t263 * t290 + t293 * t352 + t293 * t358 - t305 * t352 - t305 * t362 - t330 - t356);
  t367 = t45 * t137 * t129 / 0.24e2 + t123 * t148 + t52 * t365;
  t371 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t367);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t371;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t376 = t145 * t145;
  t379 = t376 * t186;
  t382 = t95 * t376;
  t383 = t382 * t209;
  t385 = t183 * t379;
  t389 = my_piecewise5(t57, 0, t60, 0, t183 * t376 * t194 + t95 * t379 * t200 - t385 * t200 + t382 * t211 - t385 * t217 - t330 - t383);
  t391 = t45 * t137 * t148 / 0.12e2 + t52 * t389;
  t395 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t391);
  tv2lapl20 = 0.2e1 * rho[0] * t395;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t39, t40, t41;
  double t44, t45, t46, t48, t52, t54, t55, t56;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t72, t76;
  double tzk0;

  double t78, t82, t84, t85, t87, t93, t95, t96;
  double t97, t99, t100, t102, t103, t104, t106, t108;
  double t113, tvrho0, t116, t118, t119, t120, t123, t125;
  double t126, t129, t131, t135, tvsigma0, t137, t144, t145;
  double t148, t150, t154, tvlapl0, tvtau0;

  double t159, t166, t168, t169, t171, t177, t181, t183;
  double t184, t186, t187, t188, t189, t190, t191, t192;
  double t193, t194, t196, t198, t199, t200, t202, t203;
  double t206, t207, t209, t210, t211, t213, t215, t216;
  double t217, t220, t222, t227, tv2rho20, t233, t235, t236;
  double t239, t243, t244, t245, t246, t248, t249, t250;
  double t251, t253, t254, t257, t259, t260, t261, t263;
  double t265, t266, t269, t271, t276, tv2rhosigma0, t289, t290;
  double t292, t293, t297, t298, t301, t303, t305, t309;
  double t311, t316, tv2rholapl0, tv2rhotau0, t321, t324, t327, t328;
  double t330, t331, t332, t334, t338, t340, t344, tv2sigma20;
  double t352, t354, t355, t356, t357, t358, t361, t362;
  double t365, t367, t371, tv2sigmalapl0, tv2sigmatau0, t376, t379, t382;
  double t383, t385, t389, t391, t395, tv2lapl20, tv2lapltau0, tv2tau20;

  double t400, t412, t413, t415, t421, t429, t430, t432;
  double t434, t435, t436, t438, t439, t440, t442, t443;
  double t447, t451, t454, t455, t458, t459, t461, t462;
  double t466, t468, t469, t470, t472, t474, t475, t476;
  double t479, t480, t483, t484, t485, t486, t489, t492;
  double t494, t495, t496, t502, t503, t504, t506, t507;
  double t508, t511, t512, t513, t514, t519, t523, t524;
  double t525, t528, t529, t534, t538, t539, t542, t544;
  double t546, t551, tv3rho30, t561, t563, t564, t567, t575;
  double t576, t579, t580, t581, t583, t584, t587, t588;
  double t590, t591, t594, t595, t596, t597, t598, t601;
  double t602, t606, t609, t613, t614, t619, t622, t625;
  double t626, t628, t629, t630, t631, t632, t634, t636;
  double t639, t644, t645, t646, t647, t648, t649, t650;
  double t652, t653, t654, t656, t658, t659, t662, t663;
  double t669, t670, t677, t681, t682, t683, t685, t687;
  double t689, t694, tv3rho2sigma0, t718, t719, t722, t723, t726;
  double t727, t730, t733, t734, t735, t737, t739, t741;
  double t742, t748, t750, t751, t752, t756, t759, t763;
  double t764, t765, t768, t769, t771, t773, t777, t785;
  double t786, t797, t798, t799, t801, t803, t805, t807;
  double t812, tv3rho2lapl0, tv3rho2tau0, t823, t824, t825, t826, t827;
  double t828, t831, t832, t833, t838, t839, t840, t841;
  double t843, t844, t845, t846, t848, t849, t850, t851;
  double t852, t854, t855, t856, t859, t861, t862, t863;
  double t864, t866, t868, t869, t870, t871, t873, t874;
  double t875, t877, t879, t880, t882, t883, t884, t885;
  double t886, t891, t892, t895, t896, t900, t903, t904;
  double t907, t908, t910, t911, t917, t918, t919, t920;
  double t922, t923, t926, t932, t934, t936, t941, tv3rhosigma20;
  double t956, t957, t959, t960, t962, t963, t964, t965;
  double t967, t968, t969, t973, t975, t976, t978, t981;
  double t982, t983, t984, t985, t988, t989, t990, t991;
  double t994, t995, t998, t999, t1000, t1001, t1003, t1004;
  double t1005, t1006, t1007, t1010, t1011, t1014, t1015, t1017;
  double t1020, t1028, t1031, t1032, t1039, t1040, t1044, t1046;
  double t1048, t1053, tv3rhosigmalapl0, tv3rhosigmatau0, t1066, t1067, t1068, t1070;
  double t1071, t1075, t1076, t1080, t1081, t1084, t1087, t1089;
  double t1090, t1092, t1094, t1095, t1097, t1099, t1100, t1102;
  double t1105, t1106, t1107, t1112, t1113, t1119, t1135, t1137;
  double t1139, t1144, tv3rholapl20, tv3rholapltau0, tv3rhotau20, t1149, t1150, t1151;
  double t1152, t1153, t1154, t1155, t1156, t1158, t1159, t1160;
  double t1161, t1166, t1169, t1171, t1172, t1173, t1174, t1179;
  double t1181, t1197, t1198, t1199, t1200, t1201, t1203, t1204;
  double t1205, t1206, t1207, t1208, t1210, t1211, t1212, t1213;
  double t1215, t1217, t1221, tv3sigma30, t1228, t1229, t1230, t1231;
  double t1233, t1234, t1235, t1236, t1237, t1239, t1240, t1245;
  double t1246, t1247, t1248, t1249, t1250, t1251, t1252, t1253;
  double t1254, t1255, t1256, t1258, t1259, t1264, t1265, t1266;
  double t1267, t1268, t1269, t1272, t1273, t1278, t1280, t1281;
  double t1284, t1285, t1286, t1287, t1288, t1291, t1294, t1297;
  double t1298, t1299, t1301, t1303, t1307, tv3sigma2lapl0, tv3sigma2tau0, t1313;
  double t1314, t1315, t1322, t1324, t1325, t1327, t1328, t1329;
  double t1330, t1331, t1332, t1334, t1335, t1336, t1339, t1340;
  double t1341, t1347, t1348, t1353, t1354, t1357, t1361, t1362;
  double t1367, t1368, t1369, t1370, t1372, t1374, t1378, tv3sigmalapl20;
  double tv3sigmalapltau0, tv3sigmatau20, t1383, t1384, t1385, t1386, t1387, t1388;
  double t1391, t1392, t1393, t1394, t1395, t1397, t1398, t1399;
  double t1406, t1411, t1426, t1427, t1428, t1430, t1431, t1432;
  double t1433, t1434, t1435, t1436, t1437, t1439, t1441, t1445;
  double tv3lapl30, tv3lapl2tau0, tv3lapltau20, tv3tau30;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t25 * t29;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t37 = t33 * t36;
  t39 = 0.5e1 / 0.72e2 * t30 * t37;
  t40 = params->csk_cp * t25;
  t41 = t40 * t29;
  t44 = params->csk_cq * t25;
  t45 = t44 * t29;
  t46 = lapl[0] * t32;
  t48 = 0.1e1 / t23 / rho[0];
  t52 = t41 * t37 / 0.24e2 + t45 * t46 * t48 / 0.24e2 - t39;
  t54 = log(0.1e1 - DBL_EPSILON);
  t55 = 0.1e1 / params->csk_a;
  t56 = pow(-t54, -t55);
  t57 = t52 < -t56;
  t58 = log(DBL_EPSILON);
  t59 = pow(-t58, -t55);
  t60 = -t59 < t52;
  t61 = my_piecewise3(t60, -t59, t52);
  t62 = -t56 < t61;
  t63 = my_piecewise3(t62, t61, -t56);
  t64 = fabs(t63);
  t65 = pow(t64, params->csk_a);
  t66 = 0.1e1 / t65;
  t67 = exp(-t66);
  t68 = 0.1e1 - t67;
  t69 = pow(t68, t55);
  t70 = my_piecewise5(t57, 0, t60, 1, t69);
  t72 = t52 * t70 + t39 + 0.1e1;
  t76 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t78 = t21 / t22;
  t82 = t34 * rho[0];
  t84 = 0.1e1 / t23 / t82;
  t85 = t33 * t84;
  t87 = 0.5e1 / 0.27e2 * t30 * t85;
  t93 = -t41 * t85 / 0.9e1 - 0.5e1 / 0.72e2 * t45 * t46 * t36 + t87;
  t95 = t69 * t66;
  t96 = my_piecewise3(t60, 0, t93);
  t97 = my_piecewise3(t62, t96, 0);
  t99 = fabs(t63) / t63;
  t100 = 0.1e1 / t64;
  t102 = 0.1e1 / t68;
  t103 = t67 * t102;
  t104 = t99 * t100 * t103;
  t106 = my_piecewise5(t57, 0, t60, 0, -t95 * t97 * t104);
  t108 = t52 * t106 + t93 * t70 - t87;
  t113 = my_piecewise3(t3, 0, t8 * t78 * t72 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t108);
  tvrho0 = 0.2e1 * rho[0] * t113 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t116 = t32 * t36;
  t118 = 0.5e1 / 0.72e2 * t30 * t116;
  t119 = t29 * t32;
  t120 = t119 * t36;
  t123 = t40 * t120 / 0.24e2 - t118;
  t125 = my_piecewise3(t60, 0, t123);
  t126 = my_piecewise3(t62, t125, 0);
  t129 = my_piecewise5(t57, 0, t60, 0, -t95 * t126 * t104);
  t131 = t123 * t70 + t52 * t129 + t118;
  t135 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t131);
  tvsigma0 = 0.2e1 * rho[0] * t135;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t137 = t32 * t48;
  t144 = my_piecewise3(t60, 0, t44 * t119 * t48 / 0.24e2);
  t145 = my_piecewise3(t62, t144, 0);
  t148 = my_piecewise5(t57, 0, t60, 0, -t95 * t145 * t104);
  t150 = t45 * t137 * t70 / 0.24e2 + t52 * t148;
  t154 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t150);
  tvlapl0 = 0.2e1 * rho[0] * t154;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t159 = t21 / t22 / rho[0];
  t166 = t34 * t34;
  t168 = 0.1e1 / t23 / t166;
  t169 = t33 * t168;
  t171 = 0.55e2 / 0.81e2 * t30 * t169;
  t177 = 0.11e2 / 0.27e2 * t41 * t169 + 0.5e1 / 0.27e2 * t45 * t46 * t84 - t171;
  t181 = t65 * t65;
  t183 = t69 / t181;
  t184 = t97 * t97;
  t186 = t99 * t99;
  t187 = t64 * t64;
  t188 = 0.1e1 / t187;
  t189 = t186 * t188;
  t190 = t67 * t67;
  t191 = t68 * t68;
  t192 = 0.1e1 / t191;
  t193 = t190 * t192;
  t194 = t189 * t193;
  t196 = t184 * t186;
  t198 = t188 * t67;
  t199 = t102 * params->csk_a;
  t200 = t198 * t199;
  t202 = my_piecewise3(t60, 0, t177);
  t203 = my_piecewise3(t62, t202, 0);
  t206 = t95 * t184;
  t207 = 0.0;
  t209 = t207 * t100 * t103;
  t210 = t206 * t209;
  t211 = t189 * t103;
  t213 = t183 * t196;
  t215 = t188 * t190;
  t216 = t192 * params->csk_a;
  t217 = t215 * t216;
  t220 = my_piecewise5(t57, 0, t60, 0, -t95 * t203 * t104 + t183 * t184 * t194 + t95 * t196 * t200 - t213 * t200 + t206 * t211 - t213 * t217 - t210);
  t222 = 0.2e1 * t93 * t106 + t177 * t70 + t52 * t220 + t171;
  t227 = my_piecewise3(t3, 0, -t8 * t159 * t72 / 0.3e2 + t8 * t78 * t108 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t222);
  tv2rho20 = 0.2e1 * rho[0] * t227 + 0.4e1 * t113;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t233 = t32 * t84;
  t235 = 0.5e1 / 0.27e2 * t30 * t233;
  t236 = t119 * t84;
  t239 = -t40 * t236 / 0.9e1 + t235;
  t243 = t97 * t186;
  t244 = t183 * t243;
  t245 = t192 * t126;
  t246 = t215 * t245;
  t248 = t126 * t186;
  t249 = t95 * t248;
  t250 = t199 * t97;
  t251 = t198 * t250;
  t253 = my_piecewise3(t60, 0, t239);
  t254 = my_piecewise3(t62, t253, 0);
  t257 = t126 * t97;
  t259 = t95 * t257 * t209;
  t260 = t102 * t97;
  t261 = t198 * t260;
  t263 = t183 * t248;
  t265 = t216 * t97;
  t266 = t215 * t265;
  t269 = my_piecewise5(t57, 0, t60, 0, -t95 * t254 * t104 + t244 * t246 + t249 * t251 + t249 * t261 - t263 * t251 - t263 * t266 - t259);
  t271 = t123 * t106 + t93 * t129 + t239 * t70 + t52 * t269 - t235;
  t276 = my_piecewise3(t3, 0, t8 * t78 * t131 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t271);
  tv2rhosigma0 = 0.2e1 * rho[0] * t276 + 0.2e1 * t135;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t289 = t192 * t145;
  t290 = t215 * t289;
  t292 = t145 * t186;
  t293 = t95 * t292;
  t297 = my_piecewise3(t60, 0, -0.5e1 / 0.72e2 * t44 * t120);
  t298 = my_piecewise3(t62, t297, 0);
  t301 = t145 * t97;
  t303 = t95 * t301 * t209;
  t305 = t183 * t292;
  t309 = my_piecewise5(t57, 0, t60, 0, -t95 * t298 * t104 + t244 * t290 + t293 * t251 - t305 * t251 + t293 * t261 - t305 * t266 - t303);
  t311 = -0.5e1 / 0.72e2 * t45 * t116 * t70 + t45 * t137 * t106 / 0.24e2 + t93 * t148 + t52 * t309;
  t316 = my_piecewise3(t3, 0, t8 * t78 * t150 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t311);
  tv2rholapl0 = 0.2e1 * rho[0] * t316 + 0.2e1 * t154;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t321 = t126 * t126;
  t324 = t321 * t186;
  t327 = my_piecewise3(t60, 0, 0);
  t328 = my_piecewise3(t62, t327, 0);
  t330 = t95 * t328 * t104;
  t331 = t95 * t321;
  t332 = t331 * t209;
  t334 = t183 * t324;
  t338 = my_piecewise5(t57, 0, t60, 0, t183 * t321 * t194 + t95 * t324 * t200 - t334 * t200 + t331 * t211 - t334 * t217 - t330 - t332);
  t340 = 0.2e1 * t123 * t129 + t52 * t338;
  t344 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t340);
  tv2sigma20 = 0.2e1 * rho[0] * t344;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t352 = t198 * t199 * t126;
  t354 = t145 * t126;
  t355 = t95 * t354;
  t356 = t355 * t209;
  t357 = t102 * t126;
  t358 = t198 * t357;
  t361 = t216 * t126;
  t362 = t215 * t361;
  t365 = my_piecewise5(t57, 0, t60, 0, t263 * t290 + t293 * t352 + t293 * t358 - t305 * t352 - t305 * t362 - t330 - t356);
  t367 = t45 * t137 * t129 / 0.24e2 + t123 * t148 + t52 * t365;
  t371 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t367);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t371;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t376 = t145 * t145;
  t379 = t376 * t186;
  t382 = t95 * t376;
  t383 = t382 * t209;
  t385 = t183 * t379;
  t389 = my_piecewise5(t57, 0, t60, 0, t183 * t376 * t194 + t95 * t379 * t200 - t385 * t200 + t382 * t211 - t385 * t217 - t330 - t383);
  t391 = t45 * t137 * t148 / 0.12e2 + t52 * t389;
  t395 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t391);
  tv2lapl20 = 0.2e1 * rho[0] * t395;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  t400 = t21 / t22 / t34;
  t412 = 0.1e1 / t23 / t166 / rho[0];
  t413 = t33 * t412;
  t415 = 0.77e3 / 0.243e3 * t30 * t413;
  t421 = -0.154e3 / 0.81e2 * t41 * t413 - 0.55e2 / 0.81e2 * t45 * t46 * t168 + t415;
  t429 = t69 / t181 / t65;
  t430 = t184 * t97;
  t432 = t186 * t99;
  t434 = 0.1e1 / t187 / t64;
  t435 = t432 * t434;
  t436 = t190 * t67;
  t438 = 0.1e1 / t191 / t68;
  t439 = t436 * t438;
  t440 = t435 * t439;
  t442 = my_piecewise3(t60, 0, t421);
  t443 = my_piecewise3(t62, t442, 0);
  t447 = t435 * t193;
  t451 = t435 * t103;
  t454 = t203 * t186;
  t455 = t183 * t454;
  t458 = t430 * t207;
  t459 = t183 * t458;
  t461 = t215 * t216 * t99;
  t462 = t459 * t461;
  t466 = t188 * params->csk_a;
  t468 = t99 * t67 * t102;
  t469 = t466 * t468;
  t470 = t459 * t469;
  t472 = t430 * t99;
  t474 = t199 * t207;
  t475 = t198 * t474;
  t476 = t95 * t472 * t475;
  t479 = t199 * t203;
  t480 = t198 * t479;
  t483 = t430 * t432;
  t484 = t183 * t483;
  t485 = t434 * params->csk_a;
  t486 = t485 * t103;
  t489 = t95 * t483;
  t492 = -t95 * t443 * t104 - 0.3e1 * t183 * t430 * t447 + 0.3e1 * t95 * t243 * t480 - t429 * t430 * t440 - 0.2e1 * t95 * t430 * t451 - 0.3e1 * t455 * t251 - 0.3e1 * t455 * t266 + 0.3e1 * t484 * t486 - 0.3e1 * t489 * t486 - t210 - 0.3e1 * t462 - 0.3e1 * t470 + 0.3e1 * t476;
  t494 = t192 * t207;
  t495 = t215 * t494;
  t496 = t183 * t472 * t495;
  t502 = t102 * t99;
  t503 = t198 * t502;
  t504 = t95 * t458 * t503;
  t506 = t429 * t483;
  t507 = t434 * t190;
  t508 = t507 * t216;
  t511 = t434 * t67;
  t512 = params->csk_a * params->csk_a;
  t513 = t102 * t512;
  t514 = t511 * t513;
  t519 = t192 * t203;
  t523 = t434 * t436;
  t524 = t438 * params->csk_a;
  t525 = t523 * t524;
  t528 = t192 * t512;
  t529 = t507 * t528;
  t534 = t95 * t203 * t97 * t209;
  t538 = t438 * t512;
  t539 = t523 * t538;
  t542 = 0.3e1 * t244 * t215 * t519 + 0.3e1 * t95 * t454 * t261 + 0.3e1 * t484 * t514 + 0.3e1 * t484 * t529 - t489 * t514 + 0.3e1 * t506 * t508 - t506 * t514 + 0.3e1 * t506 * t525 - 0.3e1 * t506 * t529 - 0.2e1 * t506 * t539 + 0.3e1 * t496 + 0.3e1 * t504 - 0.3e1 * t534;
  t544 = my_piecewise5(t57, 0, t60, 0, t492 + t542);
  t546 = 0.3e1 * t177 * t106 + 0.3e1 * t93 * t220 + t421 * t70 + t52 * t544 - t415;
  t551 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t400 * t72 - t8 * t159 * t108 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t78 * t222 + 0.3e1 / 0.2e2 * t8 * t24 * t546);
  tv3rho30 = 0.2e1 * rho[0] * t551 + 0.6e1 * t227;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t561 = t32 * t168;
  t563 = 0.55e2 / 0.81e2 * t30 * t561;
  t564 = t119 * t168;
  t567 = 0.11e2 / 0.27e2 * t40 * t564 - t563;
  t575 = my_piecewise3(t60, 0, t567);
  t576 = my_piecewise3(t62, t575, 0);
  t579 = t126 * t432;
  t580 = t429 * t579;
  t581 = t434 * t512;
  t583 = t184 * t190 * t192;
  t584 = t581 * t583;
  t587 = t216 * t203;
  t588 = t215 * t587;
  t590 = t538 * t184;
  t591 = t523 * t590;
  t594 = t184 * t432;
  t595 = t429 * t594;
  t596 = t438 * t126;
  t597 = t596 * params->csk_a;
  t598 = t523 * t597;
  t601 = t254 * t186;
  t602 = t95 * t601;
  t606 = t183 * t579;
  t609 = t183 * t601;
  t613 = t184 * t67 * t102;
  t614 = t485 * t613;
  t619 = t95 * t579;
  t622 = t126 * t184;
  t625 = t207 * t188 * t468;
  t626 = t95 * t622 * t625;
  t628 = t184 * t99;
  t629 = t183 * t628;
  t630 = t245 * t207;
  t631 = t215 * t630;
  t632 = t629 * t631;
  t634 = t581 * t613;
  t636 = t507 * t361;
  t639 = -t95 * t576 * t104 + t249 * t480 + 0.2e1 * t602 * t251 - 0.2e1 * t609 * t251 - t263 * t588 - 0.2e1 * t609 * t266 - 0.3e1 * t580 * t584 - 0.2e1 * t580 * t591 - t580 * t634 + 0.3e1 * t606 * t584 + 0.3e1 * t595 * t598 + 0.3e1 * t595 * t636 + 0.3e1 * t606 * t614 - 0.3e1 * t619 * t614 + 0.3e1 * t626 + 0.3e1 * t632;
  t644 = t126 * t99;
  t645 = t644 * t188;
  t646 = t95 * t645;
  t647 = params->csk_a * t184;
  t648 = t647 * t207;
  t649 = t103 * t648;
  t650 = t646 * t649;
  t652 = t622 * t207;
  t653 = t183 * t652;
  t654 = t653 * t461;
  t656 = t653 * t469;
  t658 = t102 * t184;
  t659 = t511 * t658;
  t662 = t183 * t594;
  t663 = t507 * t245;
  t669 = t192 * t254;
  t670 = t215 * t669;
  t677 = t95 * t254 * t97 * t209;
  t681 = t95 * t126 * t203 * t209;
  t682 = t102 * t203;
  t683 = t198 * t682;
  t685 = -t595 * t523 * t596 + 0.2e1 * t244 * t670 + t455 * t246 + t249 * t683 + 0.2e1 * t602 * t261 - t263 * t480 + 0.3e1 * t606 * t634 - t619 * t634 - 0.2e1 * t619 * t659 - 0.3e1 * t662 * t663 - t259 + 0.3e1 * t650 - 0.3e1 * t654 - 0.3e1 * t656 - 0.2e1 * t677 - t681;
  t687 = my_piecewise5(t57, 0, t60, 0, t639 + t685);
  t689 = 0.2e1 * t239 * t106 + t123 * t220 + t177 * t129 + 0.2e1 * t93 * t269 + t52 * t687 + t567 * t70 + t563;
  t694 = my_piecewise3(t3, 0, -t8 * t159 * t131 / 0.3e2 + t8 * t78 * t271 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t689);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t694 + 0.4e1 * t276;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t718 = my_piecewise3(t60, 0, 0.5e1 / 0.27e2 * t44 * t236);
  t719 = my_piecewise3(t62, t718, 0);
  t722 = t145 * t432;
  t723 = t183 * t722;
  t726 = t298 * t186;
  t727 = t183 * t726;
  t730 = t95 * t722;
  t733 = t289 * t207;
  t734 = t215 * t733;
  t735 = t629 * t734;
  t737 = t145 * t184;
  t739 = t95 * t737 * t625;
  t741 = t289 * params->csk_a;
  t742 = t507 * t741;
  t748 = t429 * t722;
  t750 = t737 * t207;
  t751 = t183 * t750;
  t752 = t751 * t469;
  t756 = t507 * t289;
  t759 = t95 * t726;
  t763 = -t95 * t719 * t104 - 0.2e1 * t727 * t251 + 0.2e1 * t759 * t261 + t455 * t290 + 0.3e1 * t595 * t742 + 0.3e1 * t723 * t614 - 0.3e1 * t730 * t614 + 0.3e1 * t723 * t634 - t730 * t634 - t748 * t634 - 0.2e1 * t730 * t659 - 0.3e1 * t662 * t756 - t303 + 0.3e1 * t735 + 0.3e1 * t739 - 0.3e1 * t752;
  t764 = t192 * t298;
  t765 = t215 * t764;
  t768 = t438 * t145;
  t769 = t523 * t768;
  t771 = t298 * t97;
  t773 = t95 * t771 * t209;
  t777 = t95 * t145 * t203 * t209;
  t785 = t768 * params->csk_a;
  t786 = t523 * t785;
  t797 = t145 * t99 * t188;
  t798 = t95 * t797;
  t799 = t798 * t649;
  t801 = t751 * t461;
  t803 = 0.2e1 * t244 * t765 + 0.2e1 * t759 * t251 - 0.2e1 * t727 * t266 + t293 * t480 + t293 * t683 - t305 * t480 - t305 * t588 + 0.3e1 * t723 * t584 - 0.3e1 * t748 * t584 - 0.2e1 * t748 * t591 - t595 * t769 + 0.3e1 * t595 * t786 - 0.2e1 * t773 - t777 + 0.3e1 * t799 - 0.3e1 * t801;
  t805 = my_piecewise5(t57, 0, t60, 0, t763 + t803);
  t807 = 0.5e1 / 0.27e2 * t45 * t233 * t70 - 0.5e1 / 0.36e2 * t45 * t116 * t106 + t45 * t137 * t220 / 0.24e2 + t177 * t148 + 0.2e1 * t93 * t309 + t52 * t805;
  t812 = my_piecewise3(t3, 0, -t8 * t159 * t150 / 0.3e2 + t8 * t78 * t311 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t807);
  tv3rho2lapl0 = 0.2e1 * rho[0] * t812 + 0.4e1 * t316;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t823 = t328 * t186;
  t824 = t95 * t823;
  t825 = t824 * t261;
  t826 = t321 * t432;
  t827 = t95 * t826;
  t828 = t511 * t260;
  t831 = t183 * t826;
  t832 = t192 * t97;
  t833 = t507 * t832;
  t838 = t97 * t432;
  t839 = t429 * t838;
  t840 = t438 * t321;
  t841 = t523 * t840;
  t843 = t192 * t328;
  t844 = t215 * t843;
  t845 = t244 * t844;
  t846 = t328 * t97;
  t848 = t95 * t846 * t209;
  t849 = t126 * t207;
  t850 = t95 * t849;
  t851 = t100 * t67;
  t852 = t102 * t254;
  t854 = t850 * t851 * t852;
  t855 = 0.2e1 * t854;
  t856 = t198 * t852;
  t859 = t321 * t207;
  t861 = t183 * t859 * t188;
  t862 = params->csk_a * t97;
  t863 = t862 * t468;
  t864 = t861 * t863;
  t866 = t321 * t99;
  t868 = t95 * t866 * t188;
  t869 = t862 * t207;
  t870 = t103 * t869;
  t871 = t868 * t870;
  t873 = t862 * t99;
  t874 = t193 * t873;
  t875 = t861 * t874;
  t877 = t429 * t826;
  t879 = t97 * t67 * t102;
  t880 = t581 * t879;
  t882 = t824 * t251;
  t883 = 0.2e1 * t249 * t856 + 0.2e1 * t263 * t670 - 0.2e1 * t827 * t828 - 0.3e1 * t831 * t833 - t839 * t841 - t877 * t880 - t330 - t332 + t825 + t845 - t848 - t855 - 0.3e1 * t864 + 0.3e1 * t871 - 0.3e1 * t875 + t882;
  t884 = t183 * t823;
  t885 = t884 * t251;
  t886 = t485 * t879;
  t891 = t216 * t254;
  t892 = t215 * t891;
  t895 = t538 * t97;
  t896 = t523 * t895;
  t900 = t198 * t199 * t254;
  t903 = t528 * t97;
  t904 = t507 * t903;
  t907 = t884 * t266;
  t908 = t95 * t859;
  t910 = t198 * t260 * t99;
  t911 = t908 * t910;
  t917 = t183 * t866;
  t918 = t832 * t207;
  t919 = t215 * t918;
  t920 = t917 * t919;
  t922 = t524 * t97;
  t923 = t523 * t922;
  t926 = t507 * t265;
  t932 = 0.2e1 * t249 * t900 - 0.2e1 * t263 * t892 - 0.2e1 * t263 * t900 - t827 * t880 - 0.3e1 * t827 * t886 + 0.3e1 * t831 * t880 + 0.3e1 * t831 * t886 + 0.3e1 * t831 * t904 - 0.2e1 * t877 * t896 - 0.3e1 * t877 * t904 + 0.3e1 * t877 * t923 + 0.3e1 * t877 * t926 - t885 - t907 + 0.3e1 * t911 + 0.3e1 * t920;
  t934 = my_piecewise5(t57, 0, t60, 0, t883 + t932);
  t936 = 0.2e1 * t123 * t269 + 0.2e1 * t239 * t129 + t93 * t338 + t52 * t934;
  t941 = my_piecewise3(t3, 0, t8 * t78 * t340 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t936);
  tv3rhosigma20 = 0.2e1 * rho[0] * t941 + 0.2e1 * t344;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t956 = t354 * t207;
  t957 = t183 * t956;
  t959 = t466 * t97 * t468;
  t960 = t957 * t959;
  t962 = t103 * params->csk_a;
  t963 = t257 * t207;
  t964 = t962 * t963;
  t965 = t798 * t964;
  t967 = t215 * t192;
  t968 = t967 * t873;
  t969 = t957 * t968;
  t973 = t298 * t126;
  t975 = t95 * t973 * t209;
  t976 = t145 * t254;
  t978 = t95 * t976 * t209;
  t981 = t722 * t434;
  t982 = t95 * t981;
  t983 = params->csk_a * t126;
  t984 = t983 * t97;
  t985 = t103 * t984;
  t988 = t429 * t981;
  t989 = t512 * t126;
  t990 = t193 * t97;
  t991 = t989 * t990;
  t994 = t989 * t97;
  t995 = t439 * t994;
  t998 = t183 * t645;
  t999 = t301 * t207;
  t1000 = t193 * t999;
  t1001 = t998 * t1000;
  t1003 = t579 * t434;
  t1004 = t429 * t1003;
  t1005 = t145 * params->csk_a;
  t1006 = t1005 * t97;
  t1007 = t439 * t1006;
  t1010 = 0.3e1 * t1004 * t1007 + t263 * t765 + t609 * t290 + t293 * t856 + t759 * t358 - 0.3e1 * t982 * t985 - 0.3e1 * t988 * t991 - 0.2e1 * t988 * t995 + 0.3e1 * t1001 - t330 - t356 + t825 + t845 - t848 - 0.3e1 * t960 + 0.3e1 * t965 - 0.3e1 * t969 - t975 - t978;
  t1011 = t183 * t981;
  t1014 = t95 * t956;
  t1015 = t1014 * t910;
  t1017 = t193 * t1006;
  t1020 = t103 * t994;
  t1028 = t507 * t289 * t97;
  t1031 = t357 * t97;
  t1032 = t511 * t1031;
  t1039 = t596 * t145;
  t1040 = t523 * t1039;
  t1044 = 0.3e1 * t1004 * t1017 + 0.3e1 * t1011 * t1020 + 0.3e1 * t1011 * t985 + 0.3e1 * t1011 * t991 - t982 * t1020 - t988 * t1020 - 0.3e1 * t606 * t1028 - 0.2e1 * t730 * t1032 - t839 * t1040 + t293 * t900 - t305 * t892 - t305 * t900 - t727 * t352 + t759 * t352 - t727 * t362 + 0.3e1 * t1015 + t882 - t885 - t907;
  t1046 = my_piecewise5(t57, 0, t60, 0, t1010 + t1044);
  t1048 = -0.5e1 / 0.72e2 * t45 * t116 * t129 + t45 * t137 * t269 / 0.24e2 + t239 * t148 + t123 * t309 + t93 * t365 + t52 * t1046;
  t1053 = my_piecewise3(t3, 0, t8 * t78 * t367 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1048);
  tv3rhosigmalapl0 = 0.2e1 * rho[0] * t1053 + 0.2e1 * t371;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  t1066 = t145 * t207;
  t1067 = t95 * t1066;
  t1068 = t102 * t298;
  t1070 = t1067 * t851 * t1068;
  t1071 = 0.2e1 * t1070;
  t1075 = t438 * t376;
  t1076 = t523 * t1075;
  t1080 = t376 * t432;
  t1081 = t183 * t1080;
  t1084 = t95 * t1080;
  t1087 = t376 * t207;
  t1089 = t183 * t1087 * t188;
  t1090 = t1089 * t863;
  t1092 = t376 * t99;
  t1094 = t95 * t1092 * t188;
  t1095 = t1094 * t870;
  t1097 = t1089 * t874;
  t1099 = t183 * t1092;
  t1100 = t1099 * t919;
  t1102 = t429 * t1080;
  t1105 = 0.2e1 * t293 * t198 * t1068 - t839 * t1076 - 0.3e1 * t1081 * t833 - 0.2e1 * t1084 * t828 + 0.3e1 * t1102 * t923 + 0.2e1 * t305 * t765 - t1071 - 0.3e1 * t1090 + 0.3e1 * t1095 - 0.3e1 * t1097 + 0.3e1 * t1100 - t330 - t383 + t825 + t845 - t848;
  t1106 = t199 * t298;
  t1107 = t198 * t1106;
  t1112 = t95 * t1087;
  t1113 = t1112 * t910;
  t1119 = t216 * t298;
  t1135 = -0.2e1 * t305 * t215 * t1119 + 0.3e1 * t1081 * t880 + 0.3e1 * t1081 * t886 + 0.3e1 * t1081 * t904 - t1084 * t880 - 0.3e1 * t1084 * t886 - t1102 * t880 - 0.2e1 * t1102 * t896 - 0.3e1 * t1102 * t904 + 0.3e1 * t1102 * t926 + 0.2e1 * t293 * t1107 - 0.2e1 * t305 * t1107 + 0.3e1 * t1113 + t882 - t885 - t907;
  t1137 = my_piecewise5(t57, 0, t60, 0, t1105 + t1135);
  t1139 = -0.5e1 / 0.36e2 * t45 * t116 * t148 + t45 * t137 * t309 / 0.12e2 + t93 * t389 + t52 * t1137;
  t1144 = my_piecewise3(t3, 0, t8 * t78 * t391 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1139);
  tv3rholapl20 = 0.2e1 * rho[0] * t1144 + 0.2e1 * t395;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  t1149 = t824 * t358;
  t1150 = 0.3e1 * t1149;
  t1151 = t321 * t126;
  t1152 = t1151 * t207;
  t1153 = t95 * t1152;
  t1154 = t1153 * t503;
  t1155 = 0.3e1 * t1154;
  t1156 = t1151 * t99;
  t1158 = t183 * t1156 * t495;
  t1159 = 0.3e1 * t1158;
  t1160 = t1151 * t432;
  t1161 = t429 * t1160;
  t1166 = t183 * t1160;
  t1169 = t328 * t126;
  t1171 = t95 * t1169 * t209;
  t1172 = 0.3e1 * t1171;
  t1173 = t263 * t844;
  t1174 = 0.3e1 * t1173;
  t1179 = t95 * t1160;
  t1181 = 0.3e1 * t1161 * t508 + 0.3e1 * t1161 * t525 - 0.3e1 * t1161 * t529 - 0.2e1 * t1161 * t539 + 0.3e1 * t1166 * t529 - t1179 * t514 + t1150 + t1155 + t1159 - t1172 + t1174 - t330 - t332;
  t1197 = t884 * t352;
  t1198 = 0.3e1 * t1197;
  t1199 = t183 * t1152;
  t1200 = t1199 * t469;
  t1201 = 0.3e1 * t1200;
  t1203 = t95 * t1156 * t475;
  t1204 = 0.3e1 * t1203;
  t1205 = t884 * t362;
  t1206 = 0.3e1 * t1205;
  t1207 = t1199 * t461;
  t1208 = 0.3e1 * t1207;
  t1210 = t198 * t199 * t328;
  t1211 = t249 * t1210;
  t1212 = 0.3e1 * t1211;
  t1213 = -0.3e1 * t183 * t1151 * t447 - t429 * t1151 * t440 - 0.2e1 * t95 * t1151 * t451 - t1161 * t514 + 0.3e1 * t1166 * t486 + 0.3e1 * t1166 * t514 - 0.3e1 * t1179 * t486 - t1198 - t1201 + t1204 - t1206 - t1208 + t1212;
  t1215 = my_piecewise5(t57, 0, t60, 0, t1181 + t1213);
  t1217 = t52 * t1215 + 0.3e1 * t123 * t338;
  t1221 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1217);
  tv3sigma30 = 0.2e1 * rho[0] * t1221;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  t1228 = 0.2e1 * t1149;
  t1229 = 0.2e1 * t1171;
  t1230 = 0.2e1 * t1173;
  t1231 = t145 * t328;
  t1233 = t95 * t1231 * t209;
  t1234 = t102 * t328;
  t1235 = t198 * t1234;
  t1236 = t293 * t1235;
  t1237 = t884 * t290;
  t1239 = t102 * t321;
  t1240 = t511 * t1239;
  t1245 = t145 * t321;
  t1246 = t1245 * t207;
  t1247 = t183 * t1246;
  t1248 = t1247 * t469;
  t1249 = 0.3e1 * t1248;
  t1250 = params->csk_a * t321;
  t1251 = t1250 * t207;
  t1252 = t103 * t1251;
  t1253 = t798 * t1252;
  t1254 = 0.3e1 * t1253;
  t1255 = t1247 * t461;
  t1256 = 0.3e1 * t1255;
  t1258 = t321 * t67 * t102;
  t1259 = t485 * t1258;
  t1264 = -0.2e1 * t730 * t1240 + 0.3e1 * t723 * t1259 - 0.3e1 * t730 * t1259 - 0.3e1 * t831 * t756 - t877 * t769 + t1228 - t1229 + t1230 - t1233 + t1236 + t1237 - t1249 + t1254 - t1256 - t330 - t356;
  t1265 = t95 * t1245;
  t1266 = t1265 * t625;
  t1267 = 0.3e1 * t1266;
  t1268 = t917 * t734;
  t1269 = 0.3e1 * t1268;
  t1272 = t513 * t321;
  t1273 = t511 * t1272;
  t1278 = 0.2e1 * t1197;
  t1280 = t321 * t190 * t192;
  t1281 = t581 * t1280;
  t1284 = t216 * t328;
  t1285 = t215 * t1284;
  t1286 = t305 * t1285;
  t1287 = t538 * t321;
  t1288 = t523 * t1287;
  t1291 = t293 * t1210;
  t1294 = t305 * t1210;
  t1297 = 0.2e1 * t1205;
  t1298 = 0.2e1 * t1211;
  t1299 = 0.3e1 * t723 * t1273 - t730 * t1273 - t748 * t1273 + 0.3e1 * t723 * t1281 - 0.3e1 * t748 * t1281 - 0.2e1 * t748 * t1288 + 0.3e1 * t877 * t742 + 0.3e1 * t877 * t786 + t1267 + t1269 - t1278 - t1286 + t1291 - t1294 - t1297 + t1298;
  t1301 = my_piecewise5(t57, 0, t60, 0, t1264 + t1299);
  t1303 = t45 * t137 * t338 / 0.24e2 + 0.2e1 * t123 * t365 + t52 * t1301;
  t1307 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1303);
  tv3sigma2lapl0 = 0.2e1 * rho[0] * t1307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  t1313 = 0.2e1 * t1233;
  t1314 = 0.2e1 * t1236;
  t1315 = 0.2e1 * t1237;
  t1322 = t983 * t99;
  t1324 = t1089 * t193 * t1322;
  t1325 = 0.3e1 * t1324;
  t1327 = t1089 * t983 * t468;
  t1328 = 0.3e1 * t1327;
  t1329 = t983 * t207;
  t1330 = t103 * t1329;
  t1331 = t1094 * t1330;
  t1332 = 0.3e1 * t1331;
  t1334 = t198 * t357 * t99;
  t1335 = t1112 * t1334;
  t1336 = 0.3e1 * t1335;
  t1339 = -0.2e1 * t1084 * t511 * t357 - t580 * t1076 - 0.3e1 * t1081 * t663 + 0.3e1 * t1102 * t636 + t1149 - t1171 + t1173 - t1313 + t1314 + t1315 - t1325 - t1328 + t1332 + t1336 - t330 - t383;
  t1340 = t513 * t126;
  t1341 = t511 * t1340;
  t1347 = t126 * t67 * t102;
  t1348 = t485 * t1347;
  t1353 = t193 * t126;
  t1354 = t581 * t1353;
  t1357 = t538 * t126;
  t1361 = t1099 * t631;
  t1362 = 0.3e1 * t1361;
  t1367 = 0.2e1 * t1286;
  t1368 = 0.2e1 * t1291;
  t1369 = 0.2e1 * t1294;
  t1370 = -0.2e1 * t1102 * t523 * t1357 + 0.3e1 * t1081 * t1341 + 0.3e1 * t1081 * t1348 + 0.3e1 * t1081 * t1354 - t1084 * t1341 - 0.3e1 * t1084 * t1348 - t1102 * t1341 - 0.3e1 * t1102 * t1354 + 0.3e1 * t1102 * t598 - t1197 - t1205 + t1211 + t1362 - t1367 + t1368 - t1369;
  t1372 = my_piecewise5(t57, 0, t60, 0, t1339 + t1370);
  t1374 = t45 * t137 * t365 / 0.12e2 + t123 * t389 + t52 * t1372;
  t1378 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1374);
  tv3sigmalapl20 = 0.2e1 * rho[0] * t1378;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  t1383 = 0.3e1 * t1233;
  t1384 = 0.3e1 * t1236;
  t1385 = 0.3e1 * t1237;
  t1386 = t376 * t145;
  t1387 = t1386 * t432;
  t1388 = t95 * t1387;
  t1391 = t1386 * t207;
  t1392 = t95 * t1391;
  t1393 = t1392 * t503;
  t1394 = 0.3e1 * t1393;
  t1395 = t1386 * t99;
  t1397 = t183 * t1395 * t495;
  t1398 = 0.3e1 * t1397;
  t1399 = t429 * t1387;
  t1406 = t183 * t1387;
  t1411 = -0.3e1 * t1388 * t486 + 0.3e1 * t1399 * t508 + 0.3e1 * t1399 * t525 - 0.3e1 * t1399 * t529 - 0.2e1 * t1399 * t539 + 0.3e1 * t1406 * t529 - t1383 + t1384 + t1385 + t1394 + t1398 - t330 - t383;
  t1426 = t183 * t1391;
  t1427 = t1426 * t469;
  t1428 = 0.3e1 * t1427;
  t1430 = t95 * t1395 * t475;
  t1431 = 0.3e1 * t1430;
  t1432 = t1426 * t461;
  t1433 = 0.3e1 * t1432;
  t1434 = 0.3e1 * t1286;
  t1435 = 0.3e1 * t1291;
  t1436 = 0.3e1 * t1294;
  t1437 = -0.3e1 * t183 * t1386 * t447 - t429 * t1386 * t440 - 0.2e1 * t95 * t1386 * t451 - t1388 * t514 - t1399 * t514 + 0.3e1 * t1406 * t486 + 0.3e1 * t1406 * t514 - t1428 + t1431 - t1433 - t1434 + t1435 - t1436;
  t1439 = my_piecewise5(t57, 0, t60, 0, t1411 + t1437);
  t1441 = t45 * t137 * t389 / 0.8e1 + t52 * t1439;
  t1445 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1441);
  tv3lapl30 = 0.2e1 * rho[0] * t1445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t16, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t39, t40, t41;
  double t44, t45, t46, t48, t52, t54, t55, t56;
  double t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t72, t76;
  double tzk0;

  double t78, t82, t84, t85, t87, t93, t95, t96;
  double t97, t99, t100, t102, t103, t104, t106, t108;
  double t113, tvrho0, t116, t118, t119, t120, t123, t125;
  double t126, t129, t131, t135, tvsigma0, t137, t144, t145;
  double t148, t150, t154, tvlapl0, tvtau0;

  double t159, t166, t168, t169, t171, t177, t181, t183;
  double t184, t186, t187, t188, t189, t190, t191, t192;
  double t193, t194, t196, t198, t199, t200, t202, t203;
  double t206, t207, t209, t210, t211, t213, t215, t216;
  double t217, t220, t222, t227, tv2rho20, t233, t235, t236;
  double t239, t243, t244, t245, t246, t248, t249, t250;
  double t251, t253, t254, t257, t259, t260, t261, t263;
  double t265, t266, t269, t271, t276, tv2rhosigma0, t289, t290;
  double t292, t293, t297, t298, t301, t303, t305, t309;
  double t311, t316, tv2rholapl0, tv2rhotau0, t321, t324, t327, t328;
  double t330, t331, t332, t334, t338, t340, t344, tv2sigma20;
  double t352, t354, t355, t356, t357, t358, t361, t362;
  double t365, t367, t371, tv2sigmalapl0, tv2sigmatau0, t376, t379, t382;
  double t383, t385, t389, t391, t395, tv2lapl20, tv2lapltau0, tv2tau20;

  double t400, t412, t413, t415, t421, t429, t430, t432;
  double t434, t435, t436, t438, t439, t440, t442, t443;
  double t447, t451, t454, t455, t458, t459, t461, t462;
  double t466, t468, t469, t470, t472, t474, t475, t476;
  double t479, t480, t483, t484, t485, t486, t489, t492;
  double t494, t495, t496, t502, t503, t504, t506, t507;
  double t508, t511, t512, t513, t514, t519, t523, t524;
  double t525, t528, t529, t534, t538, t539, t542, t544;
  double t546, t551, tv3rho30, t561, t563, t564, t567, t575;
  double t576, t579, t580, t581, t583, t584, t587, t588;
  double t590, t591, t594, t595, t596, t597, t598, t601;
  double t602, t606, t609, t613, t614, t619, t622, t625;
  double t626, t628, t629, t630, t631, t632, t634, t636;
  double t639, t644, t645, t646, t647, t648, t649, t650;
  double t652, t653, t654, t656, t658, t659, t662, t663;
  double t669, t670, t677, t681, t682, t683, t685, t687;
  double t689, t694, tv3rho2sigma0, t718, t719, t722, t723, t726;
  double t727, t730, t733, t734, t735, t737, t739, t741;
  double t742, t748, t750, t751, t752, t756, t759, t763;
  double t764, t765, t768, t769, t771, t773, t777, t785;
  double t786, t797, t798, t799, t801, t803, t805, t807;
  double t812, tv3rho2lapl0, tv3rho2tau0, t823, t824, t825, t826, t827;
  double t828, t831, t832, t833, t838, t839, t840, t841;
  double t843, t844, t845, t846, t848, t849, t850, t851;
  double t852, t854, t855, t856, t859, t861, t862, t863;
  double t864, t866, t868, t869, t870, t871, t873, t874;
  double t875, t877, t879, t880, t882, t883, t884, t885;
  double t886, t891, t892, t895, t896, t900, t903, t904;
  double t907, t908, t910, t911, t917, t918, t919, t920;
  double t922, t923, t926, t932, t934, t936, t941, tv3rhosigma20;
  double t956, t957, t959, t960, t962, t963, t964, t965;
  double t967, t968, t969, t973, t975, t976, t978, t981;
  double t982, t983, t984, t985, t988, t989, t990, t991;
  double t994, t995, t998, t999, t1000, t1001, t1003, t1004;
  double t1005, t1006, t1007, t1010, t1011, t1014, t1015, t1017;
  double t1020, t1028, t1031, t1032, t1039, t1040, t1044, t1046;
  double t1048, t1053, tv3rhosigmalapl0, tv3rhosigmatau0, t1066, t1067, t1068, t1070;
  double t1071, t1075, t1076, t1080, t1081, t1084, t1087, t1089;
  double t1090, t1092, t1094, t1095, t1097, t1099, t1100, t1102;
  double t1105, t1106, t1107, t1112, t1113, t1119, t1135, t1137;
  double t1139, t1144, tv3rholapl20, tv3rholapltau0, tv3rhotau20, t1149, t1150, t1151;
  double t1152, t1153, t1154, t1155, t1156, t1158, t1159, t1160;
  double t1161, t1166, t1169, t1171, t1172, t1173, t1174, t1179;
  double t1181, t1197, t1198, t1199, t1200, t1201, t1203, t1204;
  double t1205, t1206, t1207, t1208, t1210, t1211, t1212, t1213;
  double t1215, t1217, t1221, tv3sigma30, t1228, t1229, t1230, t1231;
  double t1233, t1234, t1235, t1236, t1237, t1239, t1240, t1245;
  double t1246, t1247, t1248, t1249, t1250, t1251, t1252, t1253;
  double t1254, t1255, t1256, t1258, t1259, t1264, t1265, t1266;
  double t1267, t1268, t1269, t1272, t1273, t1278, t1280, t1281;
  double t1284, t1285, t1286, t1287, t1288, t1291, t1294, t1297;
  double t1298, t1299, t1301, t1303, t1307, tv3sigma2lapl0, tv3sigma2tau0, t1313;
  double t1314, t1315, t1322, t1324, t1325, t1327, t1328, t1329;
  double t1330, t1331, t1332, t1334, t1335, t1336, t1339, t1340;
  double t1341, t1347, t1348, t1353, t1354, t1357, t1361, t1362;
  double t1367, t1368, t1369, t1370, t1372, t1374, t1378, tv3sigmalapl20;
  double tv3sigmalapltau0, tv3sigmatau20, t1383, t1384, t1385, t1386, t1387, t1388;
  double t1391, t1392, t1393, t1394, t1395, t1397, t1398, t1399;
  double t1406, t1411, t1426, t1427, t1428, t1430, t1431, t1432;
  double t1433, t1434, t1435, t1436, t1437, t1439, t1441, t1445;
  double tv3lapl30, tv3lapl2tau0, tv3lapltau20, tv3tau30;

  double t1466, t1468, t1474, t1488, t1490, t1491, t1492, t1493;
  double t1494, t1495, t1496, t1497, t1498, t1499, t1500, t1501;
  double t1502, t1503, t1506, t1507, t1510, t1511, t1515, t1516;
  double t1517, t1518, t1523, t1526, t1531, t1532, t1535, t1538;
  double t1543, t1547, t1548, t1551, t1561, t1565, t1567, t1568;
  double t1571, t1572, t1573, t1578, t1579, t1585, t1588, t1589;
  double t1590, t1594, t1595, t1596, t1602, t1603, t1604, t1607;
  double t1608, t1613, t1614, t1615, t1624, t1625, t1628, t1633;
  double t1642, t1647, t1648, t1652, t1653, t1654, t1656, t1657;
  double t1661, t1662, t1665, t1666, t1669, t1673, t1679, t1681;
  double t1684, t1689, t1691, t1694, t1696, t1697, t1700, t1705;
  double t1707, t1710, t1713, t1714, t1718, t1721, t1723, t1728;
  double t1732, t1738, t1741, t1744, t1746, t1750, t1754, t1758;
  double t1762, t1763, t1766, t1770, t1775, t1782, t1785, t1789;
  double t1796, tv4rho40, t1811, t1815, t1832, t1835, t1841, t1842;
  double t1843, t1848, t1849, t1853, t1856, t1857, t1860, t1861;
  double t1862, t1873, t1876, t1883, t1884, t1887, t1891, t1894;
  double t1895, t1900, t1901, t1902, t1903, t1906, t1909, t1912;
  double t1913, t1916, t1917, t1920, t1922, t1923, t1926, t1930;
  double t1933, t1935, t1940, t1943, t1948, t1950, t1957, t1961;
  double t1962, t1964, t1965, t1968, t1971, t1972, t1977, t1982;
  double t1985, t1989, t1990, t1994, t1997, t2004, t2006, t2007;
  double t2016, t2019, t2023, t2027, t2030, t2031, t2032, t2035;
  double t2039, t2041, t2044, t2046, t2051, t2055, t2060, t2065;
  double t2066, t2072, t2078, t2083, t2086, t2093, t2101, t2105;
  double t2108, t2112, t2115, t2117, t2120, t2127, t2132, t2142;
  double t2151, t2157, t2165, t2174, t2178, t2182, t2186, t2191;
  double t2195, t2202, tv4rho3sigma0, t2237, t2240, t2242, t2247, t2249;
  double t2252, t2253, t2256, t2257, t2258, t2262, t2267, t2270;
  double t2277, t2282, t2283, t2288, t2289, t2292, t2293, t2298;
  double t2299, t2302, t2303, t2306, t2308, t2309, t2320, t2327;
  double t2330, t2333, t2336, t2346, t2347, t2354, t2355, t2360;
  double t2361, t2375, t2380, t2383, t2388, t2396, t2399, t2404;
  double t2407, t2412, t2422, t2424, t2431, t2434, t2441, t2446;
  double t2457, t2463, t2469, t2473, t2476, t2480, t2493, t2496;
  double t2498, t2502, t2529, t2533, t2540, tv4rho3lapl0, tv4rho3tau0, t2559;
  double t2560, t2561, t2565, t2570, t2571, t2574, t2575, t2576;
  double t2578, t2582, t2583, t2586, t2587, t2588, t2590, t2591;
  double t2593, t2595, t2598, t2601, t2606, t2610, t2611, t2614;
  double t2615, t2616, t2617, t2618, t2621, t2624, t2627, t2630;
  double t2642, t2658, t2664, t2669, t2671, t2672, t2674, t2677;
  double t2678, t2679, t2680, t2683, t2684, t2687, t2688, t2690;
  double t2691, t2693, t2694, t2697, t2700, t2704, t2708, t2716;
  double t2720, t2726, t2727, t2729, t2731, t2732, t2733, t2736;
  double t2742, t2744, t2747, t2748, t2750, t2762, t2766, t2769;
  double t2772, t2778, t2782, t2787, t2788, t2789, t2791, t2793;
  double t2798, t2799, t2800, t2801, t2805, t2810, t2819, t2822;
  double t2842, t2844, t2846, t2848, t2851, t2852, t2856, t2864;
  double t2866, t2867, t2869, t2870, t2871, t2872, t2874, t2876;
  double t2877, t2878, t2885, t2887, t2890, t2898, t2899, t2902;
  double t2903, t2907, t2910, t2911, t2913, t2914, t2917, t2920;
  double t2923, t2932, t2933, t2944, t2945, t2946, t2949, t2953;
  double t2960, tv4rho2sigma20, t2986, t2987, t2990, t2991, t2996, t3000;
  double t3007, t3011, t3022, t3030, t3041, t3044, t3045, t3046;
  double t3047, t3050, t3051, t3052, t3057, t3058, t3059, t3062;
  double t3065, t3066, t3069, t3072, t3082, t3083, t3084, t3088;
  double t3089, t3092, t3100, t3104, t3107, t3126, t3131, t3134;
  double t3147, t3153, t3163, t3166, t3172, t3199, t3214, t3217;
  double t3221, t3222, t3232, t3250, t3262, t3263, t3276, t3301;
  double t3305, t3328, t3332, t3336, t3343, tv4rho2sigmalapl0, tv4rho2sigmatau0, t3365;
  double t3366, t3371, t3374, t3377, t3378, t3383, t3384, t3385;
  double t3390, t3393, t3407, t3408, t3409, t3420, t3421, t3422;
  double t3440, t3441, t3446, t3448, t3450, t3452, t3456, t3461;
  double t3467, t3468, t3471, t3490, t3495, t3501, t3504, t3506;
  double t3517, t3534, t3539, t3573, t3576, t3578, t3580, t3590;
  double t3591, t3604, t3605, t3613, t3623, t3631, t3635, t3636;
  double t3644, t3648, t3655, tv4rho2lapl20, tv4rho2lapltau0, tv4rho2tau20, t3666, t3667;
  double t3668, t3670, t3671, t3672, t3673, t3674, t3677, t3679;
  double t3680, t3682, t3685, t3686, t3687, t3688, t3691, t3692;
  double t3693, t3694, t3696, t3698, t3699, t3701, t3705, t3707;
  double t3709, t3710, t3713, t3715, t3717, t3721, t3722, t3727;
  double t3731, t3734, t3736, t3739, t3740, t3748, t3749, t3750;
  double t3754, t3758, t3760, t3761, t3762, t3765, t3767, t3770;
  double t3773, t3776, t3781, t3782, t3785, t3790, t3794, t3798;
  double t3802, t3807, t3809, t3812, t3814, t3815, t3818, t3819;
  double t3822, t3827, t3836, t3841, t3844, t3849, t3851, t3854;
  double t3858, t3867, t3871, t3872, t3873, t3880, t3882, t3888;
  double t3896, t3903, t3915, t3917, t3918, t3920, t3921, t3923;
  double t3924, t3925, t3928, t3930, t3940, t3946, t3948, t3950;
  double t3952, t3955, t3962, t3965, t3969, t3976, tv4rhosigma30, t3993;
  double t3994, t3995, t3998, t3999, t4006, t4007, t4010, t4011;
  double t4013, t4014, t4017, t4018, t4028, t4030, t4034, t4035;
  double t4037, t4038, t4045, t4046, t4047, t4054, t4057, t4059;
  double t4062, t4066, t4067, t4072, t4079, t4080, t4081, t4083;
  double t4084, t4091, t4092, t4093, t4100, t4102, t4103, t4106;
  double t4112, t4138, t4139, t4143, t4150, t4156, t4163, t4183;
  double t4203, t4210, t4211, t4214, t4215, t4220, t4223, t4226;
  double t4227, t4254, t4263, t4265, t4268, t4270, t4272, t4273;
  double t4277, t4280, t4292, t4314, t4322, t4327, t4328, t4336;
  double t4337, t4342, t4349, tv4rhosigma2lapl0, tv4rhosigma2tau0, t4364, t4365, t4367;
  double t4368, t4371, t4372, t4375, t4378, t4383, t4388, t4393;
  double t4394, t4408, t4409, t4413, t4418, t4419, t4426, t4442;
  double t4445, t4446, t4453, t4457, t4479, t4483, t4516, t4548;
  double t4589, t4593, t4600, t4607, t4609, t4636, t4646, t4651;
  double t4658, tv4rhosigmalapl20, tv4rhosigmalapltau0, tv4rhosigmatau20, t4671, t4672, t4675, t4678;
  double t4679, t4680, t4683, t4686, t4694, t4710, t4726, t4727;
  double t4730, t4736, t4739, t4745, t4761, t4766, t4768, t4773;
  double t4777, t4782, t4783, t4792, t4793, t4806, t4810, t4819;
  double t4825, t4836, t4845, t4847, t4851, t4857, t4858, t4863;
  double t4867, t4872, t4877, t4890, t4894, t4901, tv4rholapl30, tv4rholapl2tau0;
  double tv4rholapltau20, tv4rhotau30, t4906, t4907, t4910, t4911, t4916, t4918;
  double t4920, t4921, t4922, t4925, t4926, t4930, t4931, t4933;
  double t4936, t4938, t4940, t4942, t4947, t4949, t4952, t4954;
  double t4960, t4962, t4964, t4969, t4976, t4984, t4992, t4993;
  double t4995, t4998, t5000, t5001, t5009, t5017, t5018, t5024;
  double t5025, t5028, t5031, t5041, t5047, t5056, t5058, t5062;
  double t5074, t5075, t5077, t5080, t5082, t5104, t5108, t5114;
  double tv4sigma40, t5121, t5122, t5123, t5124, t5125, t5126, t5127;
  double t5128, t5129, t5130, t5131, t5132, t5133, t5134, t5140;
  double t5141, t5145, t5146, t5147, t5151, t5157, t5158, t5159;
  double t5164, t5165, t5166, t5167, t5168, t5169, t5170, t5171;
  double t5172, t5173, t5175, t5176, t5187, t5190, t5193, t5202;
  double t5210, t5223, t5226, t5230, t5235, t5254, t5266, t5267;
  double t5268, t5269, t5278, t5279, t5286, t5293, t5294, t5295;
  double t5296, t5297, t5298, t5300, t5301, t5307, t5324, t5328;
  double t5334, tv4sigma3lapl0, tv4sigma3tau0, t5342, t5349, t5352, t5358, t5366;
  double t5372, t5375, t5379, t5392, t5394, t5398, t5403, t5411;
  double t5425, t5432, t5435, t5459, t5460, t5462, t5464, t5466;
  double t5467, t5469, t5471, t5472, t5476, t5478, t5485, t5495;
  double t5502, t5506, t5512, t5522, t5532, t5536, t5538, t5540;
  double t5555, t5559, t5565, tv4sigma2lapl20, tv4sigma2lapltau0, tv4sigma2tau20, t5572, t5573;
  double t5583, t5600, t5605, t5609, t5613, t5619, t5626, t5637;
  double t5640, t5653, t5675, t5694, t5696, t5698, t5715, t5719;
  double t5725, tv4sigmalapl30, tv4sigmalapl2tau0, tv4sigmalapltau20, tv4sigmatau30, t5733, t5734, t5735;
  double t5738, t5741, t5745, t5751, t5768, t5784, t5787, t5798;
  double t5810, t5811, t5816, t5819, t5834, t5844, t5845, t5855;
  double t5882, t5886, t5892, tv4lapl40, tv4lapl3tau0, tv4lapl2tau20, tv4lapltau30, tv4tau40;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = 0.1e1 <= p->zeta_threshold;
  t10 = p->zeta_threshold - 0.1e1;
  t12 = my_piecewise5(t9, t10, t9, -t10, 0);
  t13 = 0.1e1 + t12;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = t15 * t15;
  t18 = POW_1_3(t13);
  t19 = t18 * t18;
  t21 = my_piecewise3(t13 <= p->zeta_threshold, t16 * p->zeta_threshold, t19 * t13);
  t22 = POW_1_3(rho[0]);
  t23 = t22 * t22;
  t24 = t21 * t23;
  t25 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t25 * t29;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = sigma[0] * t32;
  t34 = rho[0] * rho[0];
  t36 = 0.1e1 / t23 / t34;
  t37 = t33 * t36;
  t39 = 0.5e1 / 0.72e2 * t30 * t37;
  t40 = params->csk_cp * t25;
  t41 = t40 * t29;
  t44 = params->csk_cq * t25;
  t45 = t44 * t29;
  t46 = lapl[0] * t32;
  t48 = 0.1e1 / t23 / rho[0];
  t52 = t41 * t37 / 0.24e2 + t45 * t46 * t48 / 0.24e2 - t39;
  t54 = log(0.1e1 - DBL_EPSILON);
  t55 = 0.1e1 / params->csk_a;
  t56 = pow(-t54, -t55);
  t57 = t52 < -t56;
  t58 = log(DBL_EPSILON);
  t59 = pow(-t58, -t55);
  t60 = -t59 < t52;
  t61 = my_piecewise3(t60, -t59, t52);
  t62 = -t56 < t61;
  t63 = my_piecewise3(t62, t61, -t56);
  t64 = fabs(t63);
  t65 = pow(t64, params->csk_a);
  t66 = 0.1e1 / t65;
  t67 = exp(-t66);
  t68 = 0.1e1 - t67;
  t69 = pow(t68, t55);
  t70 = my_piecewise5(t57, 0, t60, 1, t69);
  t72 = t52 * t70 + t39 + 0.1e1;
  t76 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t78 = t21 / t22;
  t82 = t34 * rho[0];
  t84 = 0.1e1 / t23 / t82;
  t85 = t33 * t84;
  t87 = 0.5e1 / 0.27e2 * t30 * t85;
  t93 = -t41 * t85 / 0.9e1 - 0.5e1 / 0.72e2 * t45 * t46 * t36 + t87;
  t95 = t69 * t66;
  t96 = my_piecewise3(t60, 0, t93);
  t97 = my_piecewise3(t62, t96, 0);
  t99 = fabs(t63) / t63;
  t100 = 0.1e1 / t64;
  t102 = 0.1e1 / t68;
  t103 = t67 * t102;
  t104 = t99 * t100 * t103;
  t106 = my_piecewise5(t57, 0, t60, 0, -t95 * t97 * t104);
  t108 = t52 * t106 + t93 * t70 - t87;
  t113 = my_piecewise3(t3, 0, t8 * t78 * t72 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t108);
  tvrho0 = 0.2e1 * rho[0] * t113 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t116 = t32 * t36;
  t118 = 0.5e1 / 0.72e2 * t30 * t116;
  t119 = t29 * t32;
  t120 = t119 * t36;
  t123 = t40 * t120 / 0.24e2 - t118;
  t125 = my_piecewise3(t60, 0, t123);
  t126 = my_piecewise3(t62, t125, 0);
  t129 = my_piecewise5(t57, 0, t60, 0, -t95 * t126 * t104);
  t131 = t123 * t70 + t52 * t129 + t118;
  t135 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t131);
  tvsigma0 = 0.2e1 * rho[0] * t135;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t137 = t32 * t48;
  t144 = my_piecewise3(t60, 0, t44 * t119 * t48 / 0.24e2);
  t145 = my_piecewise3(t62, t144, 0);
  t148 = my_piecewise5(t57, 0, t60, 0, -t95 * t145 * t104);
  t150 = t45 * t137 * t70 / 0.24e2 + t52 * t148;
  t154 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t150);
  tvlapl0 = 0.2e1 * rho[0] * t154;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t159 = t21 / t22 / rho[0];
  t166 = t34 * t34;
  t168 = 0.1e1 / t23 / t166;
  t169 = t33 * t168;
  t171 = 0.55e2 / 0.81e2 * t30 * t169;
  t177 = 0.11e2 / 0.27e2 * t41 * t169 + 0.5e1 / 0.27e2 * t45 * t46 * t84 - t171;
  t181 = t65 * t65;
  t183 = t69 / t181;
  t184 = t97 * t97;
  t186 = t99 * t99;
  t187 = t64 * t64;
  t188 = 0.1e1 / t187;
  t189 = t186 * t188;
  t190 = t67 * t67;
  t191 = t68 * t68;
  t192 = 0.1e1 / t191;
  t193 = t190 * t192;
  t194 = t189 * t193;
  t196 = t184 * t186;
  t198 = t188 * t67;
  t199 = t102 * params->csk_a;
  t200 = t198 * t199;
  t202 = my_piecewise3(t60, 0, t177);
  t203 = my_piecewise3(t62, t202, 0);
  t206 = t95 * t184;
  t207 = 0.0;
  t209 = t207 * t100 * t103;
  t210 = t206 * t209;
  t211 = t189 * t103;
  t213 = t183 * t196;
  t215 = t188 * t190;
  t216 = t192 * params->csk_a;
  t217 = t215 * t216;
  t220 = my_piecewise5(t57, 0, t60, 0, -t95 * t203 * t104 + t183 * t184 * t194 + t95 * t196 * t200 - t213 * t200 + t206 * t211 - t213 * t217 - t210);
  t222 = 0.2e1 * t93 * t106 + t177 * t70 + t52 * t220 + t171;
  t227 = my_piecewise3(t3, 0, -t8 * t159 * t72 / 0.3e2 + t8 * t78 * t108 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t222);
  tv2rho20 = 0.2e1 * rho[0] * t227 + 0.4e1 * t113;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t233 = t32 * t84;
  t235 = 0.5e1 / 0.27e2 * t30 * t233;
  t236 = t119 * t84;
  t239 = -t40 * t236 / 0.9e1 + t235;
  t243 = t97 * t186;
  t244 = t183 * t243;
  t245 = t192 * t126;
  t246 = t215 * t245;
  t248 = t126 * t186;
  t249 = t95 * t248;
  t250 = t199 * t97;
  t251 = t198 * t250;
  t253 = my_piecewise3(t60, 0, t239);
  t254 = my_piecewise3(t62, t253, 0);
  t257 = t126 * t97;
  t259 = t95 * t257 * t209;
  t260 = t102 * t97;
  t261 = t198 * t260;
  t263 = t183 * t248;
  t265 = t216 * t97;
  t266 = t215 * t265;
  t269 = my_piecewise5(t57, 0, t60, 0, -t95 * t254 * t104 + t244 * t246 + t249 * t251 + t249 * t261 - t263 * t251 - t263 * t266 - t259);
  t271 = t123 * t106 + t93 * t129 + t239 * t70 + t52 * t269 - t235;
  t276 = my_piecewise3(t3, 0, t8 * t78 * t131 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t271);
  tv2rhosigma0 = 0.2e1 * rho[0] * t276 + 0.2e1 * t135;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t289 = t192 * t145;
  t290 = t215 * t289;
  t292 = t145 * t186;
  t293 = t95 * t292;
  t297 = my_piecewise3(t60, 0, -0.5e1 / 0.72e2 * t44 * t120);
  t298 = my_piecewise3(t62, t297, 0);
  t301 = t145 * t97;
  t303 = t95 * t301 * t209;
  t305 = t183 * t292;
  t309 = my_piecewise5(t57, 0, t60, 0, -t95 * t298 * t104 + t244 * t290 + t293 * t251 - t305 * t251 + t293 * t261 - t305 * t266 - t303);
  t311 = -0.5e1 / 0.72e2 * t45 * t116 * t70 + t45 * t137 * t106 / 0.24e2 + t93 * t148 + t52 * t309;
  t316 = my_piecewise3(t3, 0, t8 * t78 * t150 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t311);
  tv2rholapl0 = 0.2e1 * rho[0] * t316 + 0.2e1 * t154;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t321 = t126 * t126;
  t324 = t321 * t186;
  t327 = my_piecewise3(t60, 0, 0);
  t328 = my_piecewise3(t62, t327, 0);
  t330 = t95 * t328 * t104;
  t331 = t95 * t321;
  t332 = t331 * t209;
  t334 = t183 * t324;
  t338 = my_piecewise5(t57, 0, t60, 0, t183 * t321 * t194 + t95 * t324 * t200 - t334 * t200 + t331 * t211 - t334 * t217 - t330 - t332);
  t340 = 0.2e1 * t123 * t129 + t52 * t338;
  t344 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t340);
  tv2sigma20 = 0.2e1 * rho[0] * t344;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t352 = t198 * t199 * t126;
  t354 = t145 * t126;
  t355 = t95 * t354;
  t356 = t355 * t209;
  t357 = t102 * t126;
  t358 = t198 * t357;
  t361 = t216 * t126;
  t362 = t215 * t361;
  t365 = my_piecewise5(t57, 0, t60, 0, t263 * t290 + t293 * t352 + t293 * t358 - t305 * t352 - t305 * t362 - t330 - t356);
  t367 = t45 * t137 * t129 / 0.24e2 + t123 * t148 + t52 * t365;
  t371 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t367);
  tv2sigmalapl0 = 0.2e1 * rho[0] * t371;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t376 = t145 * t145;
  t379 = t376 * t186;
  t382 = t95 * t376;
  t383 = t382 * t209;
  t385 = t183 * t379;
  t389 = my_piecewise5(t57, 0, t60, 0, t183 * t376 * t194 + t95 * t379 * t200 - t385 * t200 + t382 * t211 - t385 * t217 - t330 - t383);
  t391 = t45 * t137 * t148 / 0.12e2 + t52 * t389;
  t395 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t391);
  tv2lapl20 = 0.2e1 * rho[0] * t395;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  t400 = t21 / t22 / t34;
  t412 = 0.1e1 / t23 / t166 / rho[0];
  t413 = t33 * t412;
  t415 = 0.77e3 / 0.243e3 * t30 * t413;
  t421 = -0.154e3 / 0.81e2 * t41 * t413 - 0.55e2 / 0.81e2 * t45 * t46 * t168 + t415;
  t429 = t69 / t181 / t65;
  t430 = t184 * t97;
  t432 = t186 * t99;
  t434 = 0.1e1 / t187 / t64;
  t435 = t432 * t434;
  t436 = t190 * t67;
  t438 = 0.1e1 / t191 / t68;
  t439 = t436 * t438;
  t440 = t435 * t439;
  t442 = my_piecewise3(t60, 0, t421);
  t443 = my_piecewise3(t62, t442, 0);
  t447 = t435 * t193;
  t451 = t435 * t103;
  t454 = t203 * t186;
  t455 = t183 * t454;
  t458 = t430 * t207;
  t459 = t183 * t458;
  t461 = t215 * t216 * t99;
  t462 = t459 * t461;
  t466 = t188 * params->csk_a;
  t468 = t99 * t67 * t102;
  t469 = t466 * t468;
  t470 = t459 * t469;
  t472 = t430 * t99;
  t474 = t199 * t207;
  t475 = t198 * t474;
  t476 = t95 * t472 * t475;
  t479 = t199 * t203;
  t480 = t198 * t479;
  t483 = t430 * t432;
  t484 = t183 * t483;
  t485 = t434 * params->csk_a;
  t486 = t485 * t103;
  t489 = t95 * t483;
  t492 = -t95 * t443 * t104 - 0.3e1 * t183 * t430 * t447 + 0.3e1 * t95 * t243 * t480 - t429 * t430 * t440 - 0.2e1 * t95 * t430 * t451 - 0.3e1 * t455 * t251 - 0.3e1 * t455 * t266 + 0.3e1 * t484 * t486 - 0.3e1 * t489 * t486 - t210 - 0.3e1 * t462 - 0.3e1 * t470 + 0.3e1 * t476;
  t494 = t192 * t207;
  t495 = t215 * t494;
  t496 = t183 * t472 * t495;
  t502 = t102 * t99;
  t503 = t198 * t502;
  t504 = t95 * t458 * t503;
  t506 = t429 * t483;
  t507 = t434 * t190;
  t508 = t507 * t216;
  t511 = t434 * t67;
  t512 = params->csk_a * params->csk_a;
  t513 = t102 * t512;
  t514 = t511 * t513;
  t519 = t192 * t203;
  t523 = t434 * t436;
  t524 = t438 * params->csk_a;
  t525 = t523 * t524;
  t528 = t192 * t512;
  t529 = t507 * t528;
  t534 = t95 * t203 * t97 * t209;
  t538 = t438 * t512;
  t539 = t523 * t538;
  t542 = 0.3e1 * t244 * t215 * t519 + 0.3e1 * t95 * t454 * t261 + 0.3e1 * t484 * t514 + 0.3e1 * t484 * t529 - t489 * t514 + 0.3e1 * t506 * t508 - t506 * t514 + 0.3e1 * t506 * t525 - 0.3e1 * t506 * t529 - 0.2e1 * t506 * t539 + 0.3e1 * t496 + 0.3e1 * t504 - 0.3e1 * t534;
  t544 = my_piecewise5(t57, 0, t60, 0, t492 + t542);
  t546 = 0.3e1 * t177 * t106 + 0.3e1 * t93 * t220 + t421 * t70 + t52 * t544 - t415;
  t551 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t400 * t72 - t8 * t159 * t108 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t78 * t222 + 0.3e1 / 0.2e2 * t8 * t24 * t546);
  tv3rho30 = 0.2e1 * rho[0] * t551 + 0.6e1 * t227;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t561 = t32 * t168;
  t563 = 0.55e2 / 0.81e2 * t30 * t561;
  t564 = t119 * t168;
  t567 = 0.11e2 / 0.27e2 * t40 * t564 - t563;
  t575 = my_piecewise3(t60, 0, t567);
  t576 = my_piecewise3(t62, t575, 0);
  t579 = t126 * t432;
  t580 = t429 * t579;
  t581 = t434 * t512;
  t583 = t184 * t190 * t192;
  t584 = t581 * t583;
  t587 = t216 * t203;
  t588 = t215 * t587;
  t590 = t538 * t184;
  t591 = t523 * t590;
  t594 = t184 * t432;
  t595 = t429 * t594;
  t596 = t438 * t126;
  t597 = t596 * params->csk_a;
  t598 = t523 * t597;
  t601 = t254 * t186;
  t602 = t95 * t601;
  t606 = t183 * t579;
  t609 = t183 * t601;
  t613 = t184 * t67 * t102;
  t614 = t485 * t613;
  t619 = t95 * t579;
  t622 = t126 * t184;
  t625 = t207 * t188 * t468;
  t626 = t95 * t622 * t625;
  t628 = t184 * t99;
  t629 = t183 * t628;
  t630 = t245 * t207;
  t631 = t215 * t630;
  t632 = t629 * t631;
  t634 = t581 * t613;
  t636 = t507 * t361;
  t639 = -t95 * t576 * t104 + t249 * t480 + 0.2e1 * t602 * t251 - 0.2e1 * t609 * t251 - t263 * t588 - 0.2e1 * t609 * t266 - 0.3e1 * t580 * t584 - 0.2e1 * t580 * t591 - t580 * t634 + 0.3e1 * t606 * t584 + 0.3e1 * t595 * t598 + 0.3e1 * t595 * t636 + 0.3e1 * t606 * t614 - 0.3e1 * t619 * t614 + 0.3e1 * t626 + 0.3e1 * t632;
  t644 = t126 * t99;
  t645 = t644 * t188;
  t646 = t95 * t645;
  t647 = params->csk_a * t184;
  t648 = t647 * t207;
  t649 = t103 * t648;
  t650 = t646 * t649;
  t652 = t622 * t207;
  t653 = t183 * t652;
  t654 = t653 * t461;
  t656 = t653 * t469;
  t658 = t102 * t184;
  t659 = t511 * t658;
  t662 = t183 * t594;
  t663 = t507 * t245;
  t669 = t192 * t254;
  t670 = t215 * t669;
  t677 = t95 * t254 * t97 * t209;
  t681 = t95 * t126 * t203 * t209;
  t682 = t102 * t203;
  t683 = t198 * t682;
  t685 = -t595 * t523 * t596 + 0.2e1 * t244 * t670 + t455 * t246 + t249 * t683 + 0.2e1 * t602 * t261 - t263 * t480 + 0.3e1 * t606 * t634 - t619 * t634 - 0.2e1 * t619 * t659 - 0.3e1 * t662 * t663 - t259 + 0.3e1 * t650 - 0.3e1 * t654 - 0.3e1 * t656 - 0.2e1 * t677 - t681;
  t687 = my_piecewise5(t57, 0, t60, 0, t639 + t685);
  t689 = 0.2e1 * t239 * t106 + t123 * t220 + t177 * t129 + 0.2e1 * t93 * t269 + t52 * t687 + t567 * t70 + t563;
  t694 = my_piecewise3(t3, 0, -t8 * t159 * t131 / 0.3e2 + t8 * t78 * t271 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t689);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t694 + 0.4e1 * t276;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t718 = my_piecewise3(t60, 0, 0.5e1 / 0.27e2 * t44 * t236);
  t719 = my_piecewise3(t62, t718, 0);
  t722 = t145 * t432;
  t723 = t183 * t722;
  t726 = t298 * t186;
  t727 = t183 * t726;
  t730 = t95 * t722;
  t733 = t289 * t207;
  t734 = t215 * t733;
  t735 = t629 * t734;
  t737 = t145 * t184;
  t739 = t95 * t737 * t625;
  t741 = t289 * params->csk_a;
  t742 = t507 * t741;
  t748 = t429 * t722;
  t750 = t737 * t207;
  t751 = t183 * t750;
  t752 = t751 * t469;
  t756 = t507 * t289;
  t759 = t95 * t726;
  t763 = -t95 * t719 * t104 - 0.2e1 * t727 * t251 + 0.2e1 * t759 * t261 + t455 * t290 + 0.3e1 * t595 * t742 + 0.3e1 * t723 * t614 - 0.3e1 * t730 * t614 + 0.3e1 * t723 * t634 - t730 * t634 - t748 * t634 - 0.2e1 * t730 * t659 - 0.3e1 * t662 * t756 - t303 + 0.3e1 * t735 + 0.3e1 * t739 - 0.3e1 * t752;
  t764 = t192 * t298;
  t765 = t215 * t764;
  t768 = t438 * t145;
  t769 = t523 * t768;
  t771 = t298 * t97;
  t773 = t95 * t771 * t209;
  t777 = t95 * t145 * t203 * t209;
  t785 = t768 * params->csk_a;
  t786 = t523 * t785;
  t797 = t145 * t99 * t188;
  t798 = t95 * t797;
  t799 = t798 * t649;
  t801 = t751 * t461;
  t803 = 0.2e1 * t244 * t765 + 0.2e1 * t759 * t251 - 0.2e1 * t727 * t266 + t293 * t480 + t293 * t683 - t305 * t480 - t305 * t588 + 0.3e1 * t723 * t584 - 0.3e1 * t748 * t584 - 0.2e1 * t748 * t591 - t595 * t769 + 0.3e1 * t595 * t786 - 0.2e1 * t773 - t777 + 0.3e1 * t799 - 0.3e1 * t801;
  t805 = my_piecewise5(t57, 0, t60, 0, t763 + t803);
  t807 = 0.5e1 / 0.27e2 * t45 * t233 * t70 - 0.5e1 / 0.36e2 * t45 * t116 * t106 + t45 * t137 * t220 / 0.24e2 + t177 * t148 + 0.2e1 * t93 * t309 + t52 * t805;
  t812 = my_piecewise3(t3, 0, -t8 * t159 * t150 / 0.3e2 + t8 * t78 * t311 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * t807);
  tv3rho2lapl0 = 0.2e1 * rho[0] * t812 + 0.4e1 * t316;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t823 = t328 * t186;
  t824 = t95 * t823;
  t825 = t824 * t261;
  t826 = t321 * t432;
  t827 = t95 * t826;
  t828 = t511 * t260;
  t831 = t183 * t826;
  t832 = t192 * t97;
  t833 = t507 * t832;
  t838 = t97 * t432;
  t839 = t429 * t838;
  t840 = t438 * t321;
  t841 = t523 * t840;
  t843 = t192 * t328;
  t844 = t215 * t843;
  t845 = t244 * t844;
  t846 = t328 * t97;
  t848 = t95 * t846 * t209;
  t849 = t126 * t207;
  t850 = t95 * t849;
  t851 = t100 * t67;
  t852 = t102 * t254;
  t854 = t850 * t851 * t852;
  t855 = 0.2e1 * t854;
  t856 = t198 * t852;
  t859 = t321 * t207;
  t861 = t183 * t859 * t188;
  t862 = params->csk_a * t97;
  t863 = t862 * t468;
  t864 = t861 * t863;
  t866 = t321 * t99;
  t868 = t95 * t866 * t188;
  t869 = t862 * t207;
  t870 = t103 * t869;
  t871 = t868 * t870;
  t873 = t862 * t99;
  t874 = t193 * t873;
  t875 = t861 * t874;
  t877 = t429 * t826;
  t879 = t97 * t67 * t102;
  t880 = t581 * t879;
  t882 = t824 * t251;
  t883 = 0.2e1 * t249 * t856 + 0.2e1 * t263 * t670 - 0.2e1 * t827 * t828 - 0.3e1 * t831 * t833 - t839 * t841 - t877 * t880 - t330 - t332 + t825 + t845 - t848 - t855 - 0.3e1 * t864 + 0.3e1 * t871 - 0.3e1 * t875 + t882;
  t884 = t183 * t823;
  t885 = t884 * t251;
  t886 = t485 * t879;
  t891 = t216 * t254;
  t892 = t215 * t891;
  t895 = t538 * t97;
  t896 = t523 * t895;
  t900 = t198 * t199 * t254;
  t903 = t528 * t97;
  t904 = t507 * t903;
  t907 = t884 * t266;
  t908 = t95 * t859;
  t910 = t198 * t260 * t99;
  t911 = t908 * t910;
  t917 = t183 * t866;
  t918 = t832 * t207;
  t919 = t215 * t918;
  t920 = t917 * t919;
  t922 = t524 * t97;
  t923 = t523 * t922;
  t926 = t507 * t265;
  t932 = 0.2e1 * t249 * t900 - 0.2e1 * t263 * t892 - 0.2e1 * t263 * t900 - t827 * t880 - 0.3e1 * t827 * t886 + 0.3e1 * t831 * t880 + 0.3e1 * t831 * t886 + 0.3e1 * t831 * t904 - 0.2e1 * t877 * t896 - 0.3e1 * t877 * t904 + 0.3e1 * t877 * t923 + 0.3e1 * t877 * t926 - t885 - t907 + 0.3e1 * t911 + 0.3e1 * t920;
  t934 = my_piecewise5(t57, 0, t60, 0, t883 + t932);
  t936 = 0.2e1 * t123 * t269 + 0.2e1 * t239 * t129 + t93 * t338 + t52 * t934;
  t941 = my_piecewise3(t3, 0, t8 * t78 * t340 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t936);
  tv3rhosigma20 = 0.2e1 * rho[0] * t941 + 0.2e1 * t344;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t956 = t354 * t207;
  t957 = t183 * t956;
  t959 = t466 * t97 * t468;
  t960 = t957 * t959;
  t962 = t103 * params->csk_a;
  t963 = t257 * t207;
  t964 = t962 * t963;
  t965 = t798 * t964;
  t967 = t215 * t192;
  t968 = t967 * t873;
  t969 = t957 * t968;
  t973 = t298 * t126;
  t975 = t95 * t973 * t209;
  t976 = t145 * t254;
  t978 = t95 * t976 * t209;
  t981 = t722 * t434;
  t982 = t95 * t981;
  t983 = params->csk_a * t126;
  t984 = t983 * t97;
  t985 = t103 * t984;
  t988 = t429 * t981;
  t989 = t512 * t126;
  t990 = t193 * t97;
  t991 = t989 * t990;
  t994 = t989 * t97;
  t995 = t439 * t994;
  t998 = t183 * t645;
  t999 = t301 * t207;
  t1000 = t193 * t999;
  t1001 = t998 * t1000;
  t1003 = t579 * t434;
  t1004 = t429 * t1003;
  t1005 = t145 * params->csk_a;
  t1006 = t1005 * t97;
  t1007 = t439 * t1006;
  t1010 = 0.3e1 * t1004 * t1007 + t263 * t765 + t609 * t290 + t293 * t856 + t759 * t358 - 0.3e1 * t982 * t985 - 0.3e1 * t988 * t991 - 0.2e1 * t988 * t995 + 0.3e1 * t1001 - t330 - t356 + t825 + t845 - t848 - 0.3e1 * t960 + 0.3e1 * t965 - 0.3e1 * t969 - t975 - t978;
  t1011 = t183 * t981;
  t1014 = t95 * t956;
  t1015 = t1014 * t910;
  t1017 = t193 * t1006;
  t1020 = t103 * t994;
  t1028 = t507 * t289 * t97;
  t1031 = t357 * t97;
  t1032 = t511 * t1031;
  t1039 = t596 * t145;
  t1040 = t523 * t1039;
  t1044 = 0.3e1 * t1004 * t1017 + 0.3e1 * t1011 * t1020 + 0.3e1 * t1011 * t985 + 0.3e1 * t1011 * t991 - t982 * t1020 - t988 * t1020 - 0.3e1 * t606 * t1028 - 0.2e1 * t730 * t1032 - t839 * t1040 + t293 * t900 - t305 * t892 - t305 * t900 - t727 * t352 + t759 * t352 - t727 * t362 + 0.3e1 * t1015 + t882 - t885 - t907;
  t1046 = my_piecewise5(t57, 0, t60, 0, t1010 + t1044);
  t1048 = -0.5e1 / 0.72e2 * t45 * t116 * t129 + t45 * t137 * t269 / 0.24e2 + t239 * t148 + t123 * t309 + t93 * t365 + t52 * t1046;
  t1053 = my_piecewise3(t3, 0, t8 * t78 * t367 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1048);
  tv3rhosigmalapl0 = 0.2e1 * rho[0] * t1053 + 0.2e1 * t371;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  t1066 = t145 * t207;
  t1067 = t95 * t1066;
  t1068 = t102 * t298;
  t1070 = t1067 * t851 * t1068;
  t1071 = 0.2e1 * t1070;
  t1075 = t438 * t376;
  t1076 = t523 * t1075;
  t1080 = t376 * t432;
  t1081 = t183 * t1080;
  t1084 = t95 * t1080;
  t1087 = t376 * t207;
  t1089 = t183 * t1087 * t188;
  t1090 = t1089 * t863;
  t1092 = t376 * t99;
  t1094 = t95 * t1092 * t188;
  t1095 = t1094 * t870;
  t1097 = t1089 * t874;
  t1099 = t183 * t1092;
  t1100 = t1099 * t919;
  t1102 = t429 * t1080;
  t1105 = 0.2e1 * t293 * t198 * t1068 - t839 * t1076 - 0.3e1 * t1081 * t833 - 0.2e1 * t1084 * t828 + 0.3e1 * t1102 * t923 + 0.2e1 * t305 * t765 - t1071 - 0.3e1 * t1090 + 0.3e1 * t1095 - 0.3e1 * t1097 + 0.3e1 * t1100 - t330 - t383 + t825 + t845 - t848;
  t1106 = t199 * t298;
  t1107 = t198 * t1106;
  t1112 = t95 * t1087;
  t1113 = t1112 * t910;
  t1119 = t216 * t298;
  t1135 = -0.2e1 * t305 * t215 * t1119 + 0.3e1 * t1081 * t880 + 0.3e1 * t1081 * t886 + 0.3e1 * t1081 * t904 - t1084 * t880 - 0.3e1 * t1084 * t886 - t1102 * t880 - 0.2e1 * t1102 * t896 - 0.3e1 * t1102 * t904 + 0.3e1 * t1102 * t926 + 0.2e1 * t293 * t1107 - 0.2e1 * t305 * t1107 + 0.3e1 * t1113 + t882 - t885 - t907;
  t1137 = my_piecewise5(t57, 0, t60, 0, t1105 + t1135);
  t1139 = -0.5e1 / 0.36e2 * t45 * t116 * t148 + t45 * t137 * t309 / 0.12e2 + t93 * t389 + t52 * t1137;
  t1144 = my_piecewise3(t3, 0, t8 * t78 * t391 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * t1139);
  tv3rholapl20 = 0.2e1 * rho[0] * t1144 + 0.2e1 * t395;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  t1149 = t824 * t358;
  t1150 = 0.3e1 * t1149;
  t1151 = t321 * t126;
  t1152 = t1151 * t207;
  t1153 = t95 * t1152;
  t1154 = t1153 * t503;
  t1155 = 0.3e1 * t1154;
  t1156 = t1151 * t99;
  t1158 = t183 * t1156 * t495;
  t1159 = 0.3e1 * t1158;
  t1160 = t1151 * t432;
  t1161 = t429 * t1160;
  t1166 = t183 * t1160;
  t1169 = t328 * t126;
  t1171 = t95 * t1169 * t209;
  t1172 = 0.3e1 * t1171;
  t1173 = t263 * t844;
  t1174 = 0.3e1 * t1173;
  t1179 = t95 * t1160;
  t1181 = 0.3e1 * t1161 * t508 + 0.3e1 * t1161 * t525 - 0.3e1 * t1161 * t529 - 0.2e1 * t1161 * t539 + 0.3e1 * t1166 * t529 - t1179 * t514 + t1150 + t1155 + t1159 - t1172 + t1174 - t330 - t332;
  t1197 = t884 * t352;
  t1198 = 0.3e1 * t1197;
  t1199 = t183 * t1152;
  t1200 = t1199 * t469;
  t1201 = 0.3e1 * t1200;
  t1203 = t95 * t1156 * t475;
  t1204 = 0.3e1 * t1203;
  t1205 = t884 * t362;
  t1206 = 0.3e1 * t1205;
  t1207 = t1199 * t461;
  t1208 = 0.3e1 * t1207;
  t1210 = t198 * t199 * t328;
  t1211 = t249 * t1210;
  t1212 = 0.3e1 * t1211;
  t1213 = -0.3e1 * t183 * t1151 * t447 - t429 * t1151 * t440 - 0.2e1 * t95 * t1151 * t451 - t1161 * t514 + 0.3e1 * t1166 * t486 + 0.3e1 * t1166 * t514 - 0.3e1 * t1179 * t486 - t1198 - t1201 + t1204 - t1206 - t1208 + t1212;
  t1215 = my_piecewise5(t57, 0, t60, 0, t1181 + t1213);
  t1217 = t52 * t1215 + 0.3e1 * t123 * t338;
  t1221 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1217);
  tv3sigma30 = 0.2e1 * rho[0] * t1221;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  t1228 = 0.2e1 * t1149;
  t1229 = 0.2e1 * t1171;
  t1230 = 0.2e1 * t1173;
  t1231 = t145 * t328;
  t1233 = t95 * t1231 * t209;
  t1234 = t102 * t328;
  t1235 = t198 * t1234;
  t1236 = t293 * t1235;
  t1237 = t884 * t290;
  t1239 = t102 * t321;
  t1240 = t511 * t1239;
  t1245 = t145 * t321;
  t1246 = t1245 * t207;
  t1247 = t183 * t1246;
  t1248 = t1247 * t469;
  t1249 = 0.3e1 * t1248;
  t1250 = params->csk_a * t321;
  t1251 = t1250 * t207;
  t1252 = t103 * t1251;
  t1253 = t798 * t1252;
  t1254 = 0.3e1 * t1253;
  t1255 = t1247 * t461;
  t1256 = 0.3e1 * t1255;
  t1258 = t321 * t67 * t102;
  t1259 = t485 * t1258;
  t1264 = -0.2e1 * t730 * t1240 + 0.3e1 * t723 * t1259 - 0.3e1 * t730 * t1259 - 0.3e1 * t831 * t756 - t877 * t769 + t1228 - t1229 + t1230 - t1233 + t1236 + t1237 - t1249 + t1254 - t1256 - t330 - t356;
  t1265 = t95 * t1245;
  t1266 = t1265 * t625;
  t1267 = 0.3e1 * t1266;
  t1268 = t917 * t734;
  t1269 = 0.3e1 * t1268;
  t1272 = t513 * t321;
  t1273 = t511 * t1272;
  t1278 = 0.2e1 * t1197;
  t1280 = t321 * t190 * t192;
  t1281 = t581 * t1280;
  t1284 = t216 * t328;
  t1285 = t215 * t1284;
  t1286 = t305 * t1285;
  t1287 = t538 * t321;
  t1288 = t523 * t1287;
  t1291 = t293 * t1210;
  t1294 = t305 * t1210;
  t1297 = 0.2e1 * t1205;
  t1298 = 0.2e1 * t1211;
  t1299 = 0.3e1 * t723 * t1273 - t730 * t1273 - t748 * t1273 + 0.3e1 * t723 * t1281 - 0.3e1 * t748 * t1281 - 0.2e1 * t748 * t1288 + 0.3e1 * t877 * t742 + 0.3e1 * t877 * t786 + t1267 + t1269 - t1278 - t1286 + t1291 - t1294 - t1297 + t1298;
  t1301 = my_piecewise5(t57, 0, t60, 0, t1264 + t1299);
  t1303 = t45 * t137 * t338 / 0.24e2 + 0.2e1 * t123 * t365 + t52 * t1301;
  t1307 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1303);
  tv3sigma2lapl0 = 0.2e1 * rho[0] * t1307;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  t1313 = 0.2e1 * t1233;
  t1314 = 0.2e1 * t1236;
  t1315 = 0.2e1 * t1237;
  t1322 = t983 * t99;
  t1324 = t1089 * t193 * t1322;
  t1325 = 0.3e1 * t1324;
  t1327 = t1089 * t983 * t468;
  t1328 = 0.3e1 * t1327;
  t1329 = t983 * t207;
  t1330 = t103 * t1329;
  t1331 = t1094 * t1330;
  t1332 = 0.3e1 * t1331;
  t1334 = t198 * t357 * t99;
  t1335 = t1112 * t1334;
  t1336 = 0.3e1 * t1335;
  t1339 = -0.2e1 * t1084 * t511 * t357 - t580 * t1076 - 0.3e1 * t1081 * t663 + 0.3e1 * t1102 * t636 + t1149 - t1171 + t1173 - t1313 + t1314 + t1315 - t1325 - t1328 + t1332 + t1336 - t330 - t383;
  t1340 = t513 * t126;
  t1341 = t511 * t1340;
  t1347 = t126 * t67 * t102;
  t1348 = t485 * t1347;
  t1353 = t193 * t126;
  t1354 = t581 * t1353;
  t1357 = t538 * t126;
  t1361 = t1099 * t631;
  t1362 = 0.3e1 * t1361;
  t1367 = 0.2e1 * t1286;
  t1368 = 0.2e1 * t1291;
  t1369 = 0.2e1 * t1294;
  t1370 = -0.2e1 * t1102 * t523 * t1357 + 0.3e1 * t1081 * t1341 + 0.3e1 * t1081 * t1348 + 0.3e1 * t1081 * t1354 - t1084 * t1341 - 0.3e1 * t1084 * t1348 - t1102 * t1341 - 0.3e1 * t1102 * t1354 + 0.3e1 * t1102 * t598 - t1197 - t1205 + t1211 + t1362 - t1367 + t1368 - t1369;
  t1372 = my_piecewise5(t57, 0, t60, 0, t1339 + t1370);
  t1374 = t45 * t137 * t365 / 0.12e2 + t123 * t389 + t52 * t1372;
  t1378 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1374);
  tv3sigmalapl20 = 0.2e1 * rho[0] * t1378;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  t1383 = 0.3e1 * t1233;
  t1384 = 0.3e1 * t1236;
  t1385 = 0.3e1 * t1237;
  t1386 = t376 * t145;
  t1387 = t1386 * t432;
  t1388 = t95 * t1387;
  t1391 = t1386 * t207;
  t1392 = t95 * t1391;
  t1393 = t1392 * t503;
  t1394 = 0.3e1 * t1393;
  t1395 = t1386 * t99;
  t1397 = t183 * t1395 * t495;
  t1398 = 0.3e1 * t1397;
  t1399 = t429 * t1387;
  t1406 = t183 * t1387;
  t1411 = -0.3e1 * t1388 * t486 + 0.3e1 * t1399 * t508 + 0.3e1 * t1399 * t525 - 0.3e1 * t1399 * t529 - 0.2e1 * t1399 * t539 + 0.3e1 * t1406 * t529 - t1383 + t1384 + t1385 + t1394 + t1398 - t330 - t383;
  t1426 = t183 * t1391;
  t1427 = t1426 * t469;
  t1428 = 0.3e1 * t1427;
  t1430 = t95 * t1395 * t475;
  t1431 = 0.3e1 * t1430;
  t1432 = t1426 * t461;
  t1433 = 0.3e1 * t1432;
  t1434 = 0.3e1 * t1286;
  t1435 = 0.3e1 * t1291;
  t1436 = 0.3e1 * t1294;
  t1437 = -0.3e1 * t183 * t1386 * t447 - t429 * t1386 * t440 - 0.2e1 * t95 * t1386 * t451 - t1388 * t514 - t1399 * t514 + 0.3e1 * t1406 * t486 + 0.3e1 * t1406 * t514 - t1428 + t1431 - t1433 - t1434 + t1435 - t1436;
  t1439 = my_piecewise5(t57, 0, t60, 0, t1411 + t1437);
  t1441 = t45 * t137 * t389 / 0.8e1 + t52 * t1439;
  t1445 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * t1441);
  tv3lapl30 = 0.2e1 * rho[0] * t1445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  t1466 = t33 / t23 / t166 / t34;
  t1468 = 0.1309e5 / 0.729e3 * t30 * t1466;
  t1474 = 0.2618e4 / 0.243e3 * t41 * t1466 + 0.77e3 / 0.243e3 * t45 * t46 * t412 - t1468;
  t1488 = t181 * t181;
  t1490 = t69 / t1488;
  t1491 = t184 * t184;
  t1492 = t186 * t186;
  t1493 = t1491 * t1492;
  t1494 = t1490 * t1493;
  t1495 = t187 * t187;
  t1496 = 0.1e1 / t1495;
  t1497 = t190 * t190;
  t1498 = t1496 * t1497;
  t1499 = t191 * t191;
  t1500 = 0.1e1 / t1499;
  t1501 = t512 * params->csk_a;
  t1502 = t1500 * t1501;
  t1503 = t1498 * t1502;
  t1506 = t1496 * t1501;
  t1507 = t1506 * t193;
  t1510 = t1500 * t512;
  t1511 = t1498 * t1510;
  t1515 = t429 * t1493;
  t1516 = t1496 * t436;
  t1517 = t438 * t1501;
  t1518 = t1516 * t1517;
  t1523 = t1516 * t538;
  t1526 = t183 * t1493;
  t1531 = t1496 * t190;
  t1532 = t1531 * t216;
  t1535 = t1531 * t528;
  t1538 = t507 * t519;
  t1543 = t438 * t203;
  t1547 = t1500 * params->csk_a;
  t1548 = t1498 * t1547;
  t1551 = -0.6e1 * t595 * t523 * t1543 - 0.12e2 * t1494 * t1518 + 0.18e2 * t1494 * t1523 - 0.6e1 * t1494 * t1548 + 0.18e2 * t1515 * t1507 - 0.7e1 * t1526 * t1507 + 0.12e2 * t1515 * t1518 - 0.18e2 * t1515 * t1532 + 0.7e1 * t1526 * t1532 - 0.11e2 * t1526 * t1535 - 0.18e2 * t662 * t1538;
  t1561 = t203 * t432;
  t1565 = t1491 * t207;
  t1567 = t102 * t186;
  t1568 = t511 * t1567;
  t1571 = t207 * t207;
  t1572 = t1491 * t1571;
  t1573 = t183 * t1572;
  t1578 = t1496 * params->csk_a;
  t1579 = t1578 * t103;
  t1585 = t95 * t1493;
  t1588 = t1491 * t186;
  t1589 = t183 * t1588;
  t1590 = t507 * t494;
  t1594 = t203 * t203;
  t1595 = t1594 * t186;
  t1596 = t183 * t1595;
  t1602 = t429 * t1588;
  t1603 = t438 * t207;
  t1604 = t523 * t1603;
  t1607 = t443 * t186;
  t1608 = t95 * t1607;
  t1613 = t1496 * t67;
  t1614 = t102 * t1501;
  t1615 = t1613 * t1614;
  t1624 = t1496 * t512;
  t1625 = t1624 * t103;
  t1628 = 0.3e1 * t95 * t1595 * t200 - t1494 * t1615 - 0.6e1 * t1515 * t1523 + 0.6e1 * t1515 * t1615 - 0.7e1 * t1526 * t1615 - 0.18e2 * t1526 * t1625 + t1585 * t1615 - 0.3e1 * t1596 * t200 - 0.3e1 * t1596 * t217 - 0.6e1 * t1602 * t1604 + 0.4e1 * t1608 * t261;
  t1633 = t1516 * t524;
  t1642 = t95 * t1594;
  t1647 = my_piecewise3(t60, 0, t1474);
  t1648 = my_piecewise3(t62, t1647, 0);
  t1652 = t1492 * t1496;
  t1653 = t1497 * t1500;
  t1654 = t1652 * t1653;
  t1656 = t95 * t1491;
  t1657 = t1652 * t103;
  t1661 = t1571 * t188;
  t1662 = t1661 * t103;
  t1665 = t183 * t1491;
  t1666 = t1661 * t193;
  t1669 = t1652 * t193;
  t1673 = t1652 * t439;
  t1679 = t203 * t99;
  t1681 = t183 * t1679 * t188;
  t1684 = t193 * t648;
  t1689 = params->csk_a * t207;
  t1691 = t103 * t1689 * t203;
  t1694 = t183 * t1565;
  t1696 = t186 * t67 * t102;
  t1697 = t581 * t1696;
  t1700 = t429 * t1565;
  t1705 = 0.18e2 * t95 * t628 * t188 * t1691 + 0.6e1 * t429 * t1491 * t1673 + 0.3e1 * t183 * t1594 * t194 + 0.4e1 * t1608 * t251 + 0.3e1 * t1656 * t1662 + 0.3e1 * t1665 * t1666 + 0.11e2 * t1665 * t1669 - 0.18e2 * t1681 * t1684 - 0.18e2 * t1681 * t649 + 0.18e2 * t1694 * t1697 - 0.6e1 * t1700 * t1697;
  t1707 = t183 * t1561;
  t1710 = t485 * t1696;
  t1713 = t95 * t1588;
  t1714 = t511 * t474;
  t1718 = t511 * t513 * t207;
  t1721 = t95 * t594;
  t1723 = t511 * t513 * t203;
  t1728 = t429 * t1561;
  t1732 = t523 * t1543 * params->csk_a;
  t1738 = t523 * t538 * t186;
  t1741 = t511 * t479;
  t1744 = 0.18e2 * t1694 * t1710 - 0.12e2 * t1700 * t1738 + 0.18e2 * t1707 * t614 + 0.18e2 * t1707 * t634 - 0.18e2 * t1713 * t1714 - 0.6e1 * t1713 * t1718 - 0.6e1 * t1721 * t1723 - 0.18e2 * t1721 * t1741 - 0.12e2 * t1728 * t591 - 0.6e1 * t1728 * t634 + 0.18e2 * t595 * t1732;
  t1746 = t215 * t494 * t203;
  t1750 = t523 * t1603 * params->csk_a;
  t1754 = t507 * t528 * t203;
  t1758 = t507 * t494 * params->csk_a;
  t1762 = t186 * t190 * t192;
  t1763 = t581 * t1762;
  t1766 = t183 * t1607;
  t1770 = t507 * t528 * t207;
  t1775 = t507 * t587;
  t1782 = t198 * t658 * t207;
  t1785 = 0.18e2 * t95 * t1679 * t1782 + 0.18e2 * t1589 * t1770 + 0.18e2 * t1602 * t1750 + 0.18e2 * t1602 * t1758 - 0.18e2 * t1700 * t1763 - 0.18e2 * t1728 * t584 + 0.18e2 * t629 * t1746 + 0.18e2 * t662 * t1754 - 0.4e1 * t1766 * t251 - 0.4e1 * t1766 * t266 + 0.18e2 * t595 * t1775;
  t1789 = my_piecewise5(t57, 0, t60, 0, 0.4e1 * t244 * t215 * t192 * t443 - 0.4e1 * t95 * t443 * t97 * t209 + t1785 + t1744 + t1705 + t1628 + t1551 - 0.5e1 * t534 + 0.4e1 * t504 + 0.4e1 * t496 + 0.4e1 * t476 - 0.4e1 * t470 - 0.4e1 * t462 - t210 - 0.12e2 * t95 * t1561 * t659 - 0.12e2 * t95 * t1565 * t1568 + 0.3e1 * t95 * t1572 * t200 - t95 * t1648 * t104 + t1490 * t1491 * t1654 - 0.7e1 * t1494 * t1507 + 0.11e2 * t1494 * t1511 - 0.12e2 * t1515 * t1633 + 0.7e1 * t1494 * t1535 - 0.3e1 * t1642 * t209 + 0.3e1 * t1642 * t211 + 0.6e1 * t1656 * t1657 + 0.6e1 * t1515 * t1625 - 0.6e1 * t1494 * t1633 + 0.6e1 * t1585 * t1625 - 0.18e2 * t1589 * t1590 - 0.3e1 * t1573 * t217 - 0.3e1 * t1573 * t200 - 0.11e2 * t1526 * t1579 + 0.11e2 * t1585 * t1579 - 0.6e1 * t1494 * t1503);
  t1796 = my_piecewise3(t3, 0, -0.14e2 / 0.135e3 * t8 * t21 / t22 / t82 * t72 + 0.8e1 / 0.45e2 * t8 * t400 * t108 - t8 * t159 * t222 / 0.5e1 + 0.2e1 / 0.5e1 * t8 * t78 * t546 + 0.3e1 / 0.2e2 * t8 * t24 * (0.4e1 * t421 * t106 + t1474 * t70 + 0.6e1 * t177 * t220 + t52 * t1789 + 0.4e1 * t93 * t544 + t1468));
  tv4rho40 = 0.2e1 * rho[0] * t1796 + 0.8e1 * t551;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t1811 = 0.77e3 / 0.243e3 * t30 * t32 * t412;
  t1815 = -0.154e3 / 0.81e2 * t40 * t119 * t412 + t1811;
  t1832 = params->csk_a * t203;
  t1835 = t1832 * t67 * t260 * t207;
  t1841 = params->csk_a * t99;
  t1842 = t1841 * t203;
  t1843 = t967 * t1842;
  t1848 = t576 * t186;
  t1849 = t95 * t1848;
  t1853 = -0.9e1 * t183 * t963 * t1843 + t1766 * t246 + 0.9e1 * t646 * t1835 - 0.9e1 * t998 * t1835 + 0.3e1 * t1849 * t261 - t259 + 0.4e1 * t626 + 0.4e1 * t632 + 0.4e1 * t650 - 0.4e1 * t654 - 0.4e1 * t656 - 0.3e1 * t677 - 0.2e1 * t681;
  t1856 = t438 * t254;
  t1857 = t523 * t1856;
  t1860 = t430 * t1492;
  t1861 = t1490 * t1860;
  t1862 = t1500 * t126;
  t1873 = t198 * t102 * t443;
  t1876 = t215 * t192 * t576;
  t1883 = t254 * t432;
  t1884 = t95 * t1883;
  t1887 = t183 * t1860;
  t1891 = t507 * t669;
  t1894 = t429 * t1860;
  t1895 = t1516 * t596;
  t1900 = t126 * t1492;
  t1901 = t95 * t1900;
  t1902 = t102 * t430;
  t1903 = t1613 * t1902;
  t1906 = 0.3e1 * t455 * t670 - 0.3e1 * t595 * t1857 + t1861 * t1498 * t1862 - 0.3e1 * t95 * t254 * t203 * t209 - t95 * t126 * t443 * t209 + t249 * t1873 + 0.3e1 * t244 * t1876 - 0.3e1 * t95 * t576 * t97 * t209 - 0.6e1 * t1884 * t659 + 0.11e2 * t1887 * t1531 * t245 - 0.9e1 * t662 * t1891 + 0.6e1 * t1894 * t1895 + 0.3e1 * t602 * t683 + 0.6e1 * t1901 * t1903;
  t1909 = t183 * t430 * t1571;
  t1912 = t126 * t430;
  t1913 = t95 * t1912;
  t1916 = my_piecewise3(t60, 0, t1815);
  t1917 = my_piecewise3(t62, t1916, 0);
  t1920 = t183 * t1003;
  t1922 = t512 * t203 * t97;
  t1923 = t193 * t1922;
  t1926 = t1912 * t207;
  t1930 = t429 * t1926;
  t1933 = t95 * t1003;
  t1935 = t103 * t862 * t203;
  t1940 = t198 * t502 * t203;
  t1943 = t254 * t184;
  t1948 = t430 * t186;
  t1950 = t429 * t1948 * t434;
  t1957 = t254 * t99 * t188;
  t1961 = t248 * t434;
  t1962 = t95 * t1961;
  t1964 = t512 * t430 * t207;
  t1965 = t103 * t1964;
  t1968 = t183 * t1961;
  t1971 = -0.9e1 * t183 * t1943 * t207 * t461 - t95 * t1917 * t104 + 0.18e2 * t1950 * t439 * t1329 + 0.18e2 * t183 * t1926 * t1710 + 0.9e1 * t95 * t963 * t1940 + 0.9e1 * t95 * t1957 * t649 + 0.3e1 * t1913 * t1662 - 0.12e2 * t1930 * t1738 - 0.18e2 * t1930 * t1763 + 0.3e1 * t1909 * t246 + 0.9e1 * t1920 * t1923 - 0.9e1 * t1933 * t1935 - 0.6e1 * t1962 * t1965 + 0.18e2 * t1968 * t1965;
  t1972 = t193 * t1329;
  t1977 = t103 * params->csk_a * t430 * t207;
  t1982 = t429 * t1961;
  t1985 = t183 * t1957;
  t1989 = t429 * t838 * t434;
  t1990 = t983 * t203;
  t1994 = t439 * t1922;
  t1997 = t103 * t1922;
  t2004 = t97 * t99;
  t2006 = t183 * t2004 * t188;
  t2007 = t849 * t203;
  t2016 = t193 * t1964;
  t2019 = 0.9e1 * t1989 * t193 * t1990 + 0.9e1 * t2006 * t193 * t2007 + 0.9e1 * t1989 * t439 * t1990 - 0.9e1 * t1004 * t1923 - 0.6e1 * t1004 * t1994 - 0.3e1 * t1004 * t1997 + 0.9e1 * t1920 * t1935 + 0.9e1 * t1920 * t1997 - 0.3e1 * t1933 * t1997 + 0.18e2 * t1950 * t1972 - 0.18e2 * t1962 * t1977 - 0.6e1 * t1982 * t1965 + 0.18e2 * t1968 * t2016 - 0.9e1 * t1985 * t649;
  t2023 = t1613 * t199 * t430;
  t2027 = t207 * t434 * t1696;
  t2030 = t183 * t1912;
  t2031 = t193 * params->csk_a;
  t2032 = t1661 * t2031;
  t2035 = t183 * t1883;
  t2039 = t1613 * t1614 * t430;
  t2041 = t183 * t1900;
  t2044 = t429 * t1900;
  t2046 = t1516 * t1517 * t430;
  t2051 = t429 * t1883;
  t2055 = t1613 * t513 * t430;
  t2060 = t1531 * t361;
  t2065 = -0.18e2 * t1894 * t2060 + 0.11e2 * t1901 * t2023 + t1901 * t2039 + 0.6e1 * t1901 * t2055 - 0.12e2 * t1913 * t2027 - 0.3e1 * t2030 * t2032 + 0.9e1 * t2035 * t614 + 0.9e1 * t2035 * t634 - 0.7e1 * t2041 * t2039 + 0.6e1 * t2044 * t2039 - 0.18e2 * t2041 * t2055 + 0.12e2 * t2044 * t2046 - 0.3e1 * t2051 * t634;
  t2066 = t1490 * t1900;
  t2072 = t1661 * t962;
  t2078 = t1516 * t538 * t430;
  t2083 = t1516 * t597;
  t2086 = t1516 * t1357;
  t2093 = t1531 * t192 * t1501 * t430;
  t2101 = t183 * t1948;
  t2105 = 0.9e1 * t95 * t1943 * t625 - 0.18e2 * t2101 * t507 * t630 + 0.3e1 * t1849 * t251 - 0.6e1 * t1861 * t2083 + 0.18e2 * t1861 * t2086 - 0.3e1 * t1884 * t634 + 0.3e1 * t1913 * t2072 - 0.11e2 * t2041 * t2023 - 0.3e1 * t2030 * t2072 - t2066 * t2039 - 0.7e1 * t2041 * t2093 + 0.6e1 * t2044 * t2055 - 0.6e1 * t2044 * t2078 + 0.18e2 * t2044 * t2093;
  t2108 = t511 * t260 * t203;
  t2112 = t215 * t669 * t207;
  t2115 = t429 * t1948;
  t2117 = t523 * t596 * t207;
  t2120 = t183 * t838;
  t2127 = t183 * t1848;
  t2132 = t507 * t891;
  t2142 = t1531 * t528 * t430;
  t2151 = -0.6e1 * t619 * t2108 + 0.9e1 * t629 * t2112 - 0.6e1 * t2115 * t2117 - 0.9e1 * t2120 * t507 * t245 * t203 - 0.12e2 * t1894 * t2083 - 0.3e1 * t2127 * t251 - 0.3e1 * t609 * t480 + 0.9e1 * t595 * t2132 - 0.9e1 * t2051 * t584 - 0.9e1 * t1884 * t614 + 0.7e1 * t1887 * t2060 - 0.11e2 * t2041 * t2142 - 0.3e1 * t2127 * t266 - 0.3e1 * t839 * t523 * t1543 * t126;
  t2157 = t198 * t199 * t443;
  t2165 = t215 * t216 * t443;
  t2174 = t1498 * t1502 * t430;
  t2178 = t523 * t1856 * params->csk_a;
  t2182 = t1498 * t1862 * params->csk_a;
  t2186 = t1531 * t245 * t512;
  t2191 = 0.11e2 * t1861 * t1498 * t1862 * t512 - 0.6e1 * t1861 * t2182 + 0.7e1 * t1861 * t2186 + 0.9e1 * t2035 * t584 - 0.12e2 * t2066 * t2046 - 0.6e1 * t2051 * t591 - 0.7e1 * t2066 * t2093 - 0.6e1 * t2066 * t2174 + t249 * t2157 - t263 * t2157 - t263 * t2165 + 0.9e1 * t595 * t2178 + 0.3e1 * t602 * t480 - 0.3e1 * t609 * t588;
  t2195 = my_piecewise5(t57, 0, t60, 0, t1853 + t1906 + t1971 + t2019 + t2065 + t2105 + t2151 + t2191);
  t2202 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t400 * t131 - t8 * t159 * t271 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t78 * t689 + 0.3e1 / 0.2e2 * t8 * t24 * (0.3e1 * t567 * t106 + t123 * t544 + t421 * t129 + 0.3e1 * t177 * t269 + t1815 * t70 + t52 * t2195 + 0.3e1 * t239 * t220 + 0.3e1 * t93 * t687 - t1811));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t2202 + 0.6e1 * t694;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  t2237 = t183 * t999;
  t2240 = t466 * t99;
  t2242 = t2240 * t103 * t203;
  t2247 = t298 * t184;
  t2249 = t183 * t2247 * t207;
  t2252 = t1066 * params->csk_a;
  t2253 = t439 * t2252;
  t2256 = t145 * t430;
  t2257 = t2256 * t207;
  t2258 = t429 * t2257;
  t2262 = t193 * t1066 * t203;
  t2267 = t193 * t2252;
  t2270 = 0.9e1 * t1011 * t1923 - 0.12e2 * t2258 * t1738 + 0.9e1 * t798 * t1835 - 0.9e1 * t2237 * t1843 + 0.18e2 * t1950 * t2253 + 0.18e2 * t1950 * t2267 + 0.9e1 * t2006 * t2262 - 0.9e1 * t2237 * t2242 - 0.9e1 * t2249 * t461 - 0.9e1 * t2249 * t469 + 0.4e1 * t735 + 0.4e1 * t739 - 0.4e1 * t752;
  t2277 = t183 * t2257;
  t2282 = t292 * t434;
  t2283 = t95 * t2282;
  t2288 = t298 * t432;
  t2289 = t429 * t2288;
  t2292 = t145 * t1492;
  t2293 = t95 * t2292;
  t2298 = t719 * t186;
  t2299 = t95 * t2298;
  t2302 = t438 * t298;
  t2303 = t523 * t2302;
  t2306 = 0.9e1 * t1011 * t1935 - 0.6e1 * t2258 * t1697 + 0.18e2 * t2277 * t1697 - 0.18e2 * t2258 * t1763 - 0.9e1 * t982 * t1935 - 0.6e1 * t2283 * t1965 - 0.18e2 * t2283 * t1977 + 0.6e1 * t2293 * t2055 - 0.3e1 * t2289 * t634 + 0.3e1 * t2299 * t261 - 0.3e1 * t595 * t2303 - t303 - 0.3e1 * t773 - 0.2e1 * t777;
  t2308 = t1500 * t145;
  t2309 = t1498 * t2308;
  t2320 = t215 * t192 * t719;
  t2327 = t95 * t2288;
  t2330 = t1531 * t289;
  t2333 = t507 * t764;
  t2336 = t1516 * t768;
  t2346 = -t95 * t145 * t443 * t209 - 0.3e1 * t95 * t298 * t203 * t209 - 0.3e1 * t95 * t719 * t97 * t209 + t1766 * t290 + t1861 * t2309 + t293 * t1873 + 0.11e2 * t1887 * t2330 + 0.6e1 * t1894 * t2336 + 0.3e1 * t1909 * t290 + 0.3e1 * t244 * t2320 - 0.6e1 * t2327 * t659 - 0.9e1 * t662 * t2333 + 0.3e1 * t455 * t765 + 0.3e1 * t759 * t683;
  t2347 = t95 * t2256;
  t2354 = my_piecewise3(t60, 0, -0.55e2 / 0.81e2 * t44 * t564);
  t2355 = my_piecewise3(t62, t2354, 0);
  t2360 = t1005 * t203;
  t2361 = t439 * t2360;
  t2375 = t193 * t2360;
  t2380 = t95 * t298 * t99 * t188;
  t2383 = t183 * t2282;
  t2388 = -t95 * t2355 * t104 + 0.9e1 * t95 * t999 * t1940 + 0.9e1 * t1011 * t1997 + 0.3e1 * t2347 * t1662 + 0.18e2 * t2277 * t1710 + 0.6e1 * t2293 * t1903 - 0.9e1 * t988 * t1923 + 0.9e1 * t1989 * t2361 + 0.9e1 * t1989 * t2375 - 0.6e1 * t988 * t1994 - 0.3e1 * t982 * t1997 - 0.3e1 * t988 * t1997 + 0.18e2 * t2383 * t2016 + 0.9e1 * t2380 * t649;
  t2396 = t1531 * t289 * t512;
  t2399 = t429 * t2292;
  t2404 = t183 * t2256;
  t2407 = t507 * t733;
  t2412 = t183 * t2292;
  t2422 = t1490 * t2292;
  t2424 = -0.12e2 * t293 * t511 * t1902 * t207 + 0.7e1 * t1861 * t2396 + 0.11e2 * t2293 * t2023 - 0.11e2 * t2412 * t2023 - 0.3e1 * t2404 * t2032 + t2293 * t2039 + 0.6e1 * t2399 * t2039 - 0.7e1 * t2412 * t2039 - t2422 * t2039 + 0.3e1 * t2347 * t2072 - 0.3e1 * t2404 * t2072 - 0.6e1 * t2399 * t2078 - 0.18e2 * t2101 * t2407;
  t2431 = t183 * t2288;
  t2434 = t507 * t1119;
  t2441 = t1531 * t741;
  t2446 = t183 * t2298;
  t2457 = 0.7e1 * t1887 * t2441 + 0.12e2 * t2399 * t2046 - 0.12e2 * t2422 * t2046 + 0.6e1 * t2399 * t2055 - 0.18e2 * t2412 * t2055 - 0.6e1 * t730 * t2108 - 0.11e2 * t2412 * t2142 - 0.9e1 * t2289 * t584 - 0.9e1 * t2327 * t614 + 0.9e1 * t2431 * t614 + 0.9e1 * t2431 * t634 + 0.9e1 * t595 * t2434 - 0.3e1 * t2446 * t266 - 0.3e1 * t727 * t588;
  t2463 = t1498 * t2308 * t512;
  t2469 = t523 * t2302 * params->csk_a;
  t2473 = t1498 * t2308 * params->csk_a;
  t2476 = t1516 * t785;
  t2480 = t1516 * t768 * t512;
  t2493 = t215 * t764 * t207;
  t2496 = 0.11e2 * t1861 * t2463 - 0.6e1 * t1861 * t2473 - 0.6e1 * t1861 * t2476 + 0.18e2 * t1861 * t2480 + 0.18e2 * t2399 * t2093 - 0.7e1 * t2412 * t2093 - 0.7e1 * t2422 * t2093 - t305 * t2157 - t305 * t2165 - 0.6e1 * t2422 * t2174 - 0.6e1 * t2289 * t591 - 0.3e1 * t2327 * t634 + 0.9e1 * t595 * t2469 + 0.9e1 * t629 * t2493;
  t2498 = t523 * t768 * t207;
  t2502 = t507 * t289 * t203;
  t2529 = -0.3e1 * t839 * t523 * t1543 * t145 + 0.9e1 * t95 * t2247 * t625 - 0.18e2 * t1894 * t2441 - 0.12e2 * t1894 * t2476 - 0.6e1 * t2115 * t2498 - 0.9e1 * t2120 * t2502 + t293 * t2157 + 0.3e1 * t2299 * t251 + 0.9e1 * t2431 * t584 - 0.3e1 * t2446 * t251 - 0.3e1 * t727 * t480 + 0.3e1 * t759 * t480 + 0.4e1 * t799 - 0.4e1 * t801;
  t2533 = my_piecewise5(t57, 0, t60, 0, t2270 + t2306 + t2346 + t2388 + t2424 + t2457 + t2496 + t2529);
  t2540 = my_piecewise3(t3, 0, 0.2e1 / 0.45e2 * t8 * t400 * t150 - t8 * t159 * t311 / 0.1e2 + 0.3e1 / 0.1e2 * t8 * t78 * t807 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.55e2 / 0.81e2 * t45 * t561 * t70 + 0.5e1 / 0.9e1 * t45 * t233 * t106 - 0.5e1 / 0.24e2 * t45 * t116 * t220 + t45 * t137 * t544 / 0.24e2 + t421 * t148 + 0.3e1 * t177 * t309 + 0.3e1 * t93 * t805 + t52 * t2533));
  tv4rho3lapl0 = 0.2e1 * rho[0] * t2540 + 0.6e1 * t812;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 0] += tv4rho3lapl0;

  tv4rho3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 0] += tv4rho3tau0;

  t2559 = t849 * t188;
  t2560 = t183 * t2559;
  t2561 = t2004 * t254;
  t2565 = t103 * t254;
  t2570 = t97 * t207 * t254;
  t2571 = t962 * t2570;
  t2574 = t324 * t434;
  t2575 = t429 * t2574;
  t2576 = t512 * t184;
  t2578 = t2576 * t103 * t207;
  t2582 = t512 * t254 * t97;
  t2583 = t193 * t2582;
  t2586 = t328 * t99;
  t2587 = t2586 * t188;
  t2588 = t183 * t2587;
  t2590 = 0.3e1 * t2588 * t1684;
  t2591 = t95 * t2587;
  t2593 = 0.3e1 * t2591 * t649;
  t2595 = 0.3e1 * t2588 * t649;
  t2598 = t95 * t2574;
  t2601 = t183 * t2574;
  t2606 = t193 * t1842;
  t2610 = t429 * t196 * t434;
  t2611 = t439 * t1251;
  t2614 = -0.12e2 * t2560 * t2031 * t2561 - 0.12e2 * t2560 * t873 * t2565 - 0.12e2 * t1004 * t2583 + 0.18e2 * t2575 * t1684 + 0.12e2 * t1920 * t2583 + 0.12e2 * t646 * t2571 - 0.6e1 * t2575 * t2578 - 0.6e1 * t2598 * t2578 + 0.18e2 * t2601 * t2578 - 0.3e1 * t861 * t2606 + 0.18e2 * t2610 * t2611 - t2590 + t2593 - t2595 - t330 - t332;
  t2615 = t859 * t434;
  t2616 = t429 * t2615;
  t2617 = t2576 * t186;
  t2618 = t439 * t2617;
  t2621 = t1832 * t468;
  t2624 = t2576 * t1762;
  t2627 = t862 * t2565;
  t2630 = t103 * t2582;
  t2642 = t647 * t1696;
  t2658 = t439 * t2582;
  t2664 = t193 * t2576 * t207;
  t2669 = -0.12e2 * t2616 * t2618 - 0.3e1 * t861 * t2621 - 0.18e2 * t2616 * t2624 + 0.12e2 * t1920 * t2627 - 0.4e1 * t1933 * t2630 + 0.12e2 * t1920 * t2630 - 0.4e1 * t1004 * t2630 + 0.12e2 * t1004 * t193 * t862 * t254 + 0.18e2 * t183 * t2615 * t2642 - 0.18e2 * t2598 * t649 + 0.12e2 * t998 * t193 * t2570 + 0.12e2 * t95 * t2559 * t103 * t2561 + 0.12e2 * t1989 * t439 * t983 * t254 - 0.8e1 * t1004 * t2658 + 0.3e1 * t868 * t1691 + 0.18e2 * t2601 * t2664 - 0.12e2 * t1933 * t2627;
  t2671 = t321 * t1492;
  t2672 = t95 * t2671;
  t2674 = t1613 * t199 * t184;
  t2677 = t321 * t1571;
  t2678 = t183 * t2677;
  t2679 = t216 * t184;
  t2680 = t215 * t2679;
  t2683 = t429 * t2671;
  t2684 = t1516 * t590;
  t2687 = t328 * t432;
  t2688 = t95 * t2687;
  t2690 = 0.3e1 * t2688 * t614;
  t2691 = t183 * t2687;
  t2693 = 0.3e1 * t2691 * t614;
  t2694 = t466 * t613;
  t2697 = t183 * t2671;
  t2700 = t321 * t184;
  t2704 = t1531 * t2679;
  t2708 = t1613 * t513 * t184;
  t2716 = t1516 * t1517 * t184;
  t2720 = t1613 * t1614 * t184;
  t2726 = 0.3e1 * t95 * t2700 * t2072 + 0.11e2 * t2672 * t2674 + 0.6e1 * t2672 * t2708 + t2672 * t2720 - 0.11e2 * t2697 * t2674 - 0.3e1 * t2678 * t2680 - 0.3e1 * t2678 * t2694 - 0.6e1 * t2683 * t2684 - 0.18e2 * t2683 * t2704 + 0.6e1 * t2683 * t2708 + 0.12e2 * t2683 * t2716 + 0.6e1 * t2683 * t2720 - 0.18e2 * t2697 * t2708 - 0.7e1 * t2697 * t2720 - t2690 + t2693;
  t2727 = t1490 * t2671;
  t2729 = t2688 * t634;
  t2731 = 0.3e1 * t2691 * t634;
  t2732 = t429 * t2687;
  t2733 = t2732 * t634;
  t2736 = t1506 * t583;
  t2742 = t824 * t480;
  t2744 = 0.3e1 * t2691 * t584;
  t2747 = t184 * t1492;
  t2748 = t1490 * t2747;
  t2750 = t1516 * t840 * params->csk_a;
  t2762 = t511 * t658 * t186;
  t2766 = t523 * t538 * t203;
  t2769 = 0.7e1 * t2727 * t1531 * t528 * t184 + 0.3e1 * t831 * t1723 - t877 * t1723 + 0.3e1 * t877 * t1775 + 0.18e2 * t2683 * t2736 + 0.18e2 * t2727 * t2684 - 0.12e2 * t2727 * t2716 - t2727 * t2720 - 0.7e1 * t2727 * t2736 - 0.6e1 * t2748 * t2750 - 0.12e2 * t908 * t2762 - 0.2e1 * t877 * t2766 - t2729 + t2731 - t2733 + t2742 + t2744;
  t2772 = t1500 * t321;
  t2778 = t1498 * t1502 * t184;
  t2782 = t198 * t199 * t576;
  t2787 = t884 * t588;
  t2788 = t884 * t480;
  t2789 = t507 * t1284;
  t2791 = 0.3e1 * t595 * t2789;
  t2793 = 0.3e1 * t2732 * t584;
  t2798 = t183 * t2747;
  t2799 = t192 * t321;
  t2800 = t2799 * params->csk_a;
  t2801 = t1531 * t2800;
  t2805 = t215 * t216 * t576;
  t2810 = t1531 * t2799 * t512;
  t2819 = 0.11e2 * t2748 * t1498 * t2772 * t512 - 0.4e1 * t839 * t523 * t596 * t254 - t827 * t1723 - 0.3e1 * t827 * t1741 + 0.3e1 * t831 * t1741 + 0.3e1 * t831 * t1754 + 0.2e1 * t249 * t2782 - 0.2e1 * t263 * t2805 - 0.7e1 * t2697 * t2736 - 0.6e1 * t2727 * t2778 + 0.7e1 * t2798 * t2801 - 0.11e2 * t2798 * t2810 - t2787 - t2788 + t2791 - t2793;
  t2822 = t429 * t196;
  t2842 = t438 * t328;
  t2844 = t523 * t2842 * params->csk_a;
  t2846 = 0.3e1 * t595 * t2844;
  t2848 = 0.2e1 * t2732 * t591;
  t2851 = t2799 * t207;
  t2852 = t507 * t2851;
  t2856 = t511 * t260 * t254;
  t2864 = t215 * t843 * t207;
  t2866 = 0.3e1 * t629 * t2864;
  t2867 = t95 * t2586;
  t2869 = 0.3e1 * t2867 * t1782;
  t2870 = 0.2e1 * t825;
  t2871 = 0.2e1 * t845;
  t2872 = 0.3e1 * t917 * t1746 - 0.6e1 * t2822 * t523 * t840 * t207 - 0.12e2 * t606 * t507 * t832 * t254 - 0.12e2 * t2683 * t1516 * t438 * t184 * params->csk_a + 0.3e1 * t877 * t1732 - 0.6e1 * t2748 * t1498 * t2772 * params->csk_a + t2846 - t2848 + 0.3e1 * t908 * t1940 - 0.18e2 * t213 * t2852 - 0.8e1 * t619 * t2856 - 0.2e1 * t263 * t2782 - 0.3e1 * t877 * t1754 + t2866 + t2869 + t2870 + t2871;
  t2874 = 0.3e1 * t848;
  t2876 = t254 * t254;
  t2877 = t2876 * t186;
  t2878 = t183 * t2877;
  t2885 = 0.2e1 * t2688 * t659;
  t2887 = t198 * t658;
  t2890 = t1613 * t658;
  t2898 = t523 * t2842;
  t2899 = t595 * t2898;
  t2902 = t95 * t328 * t203 * t209;
  t2903 = t102 * t576;
  t2907 = t198 * t2903;
  t2910 = t824 * t683;
  t2911 = t507 * t843;
  t2913 = 0.3e1 * t662 * t2911;
  t2914 = t511 * t682;
  t2917 = t1531 * t2799;
  t2920 = 0.3e1 * t183 * t2700 * t1666 + 0.2e1 * t95 * t2877 * t200 + 0.3e1 * t95 * t2677 * t2887 - 0.2e1 * t850 * t851 * t2903 - 0.2e1 * t2878 * t200 - 0.2e1 * t2878 * t217 + 0.2e1 * t249 * t2907 + 0.6e1 * t2672 * t2890 + 0.11e2 * t2798 * t2917 - 0.2e1 * t827 * t2914 - t2874 - t2885 - t2899 - t2902 + t2910 - t2913 - 0.4e1 * t854;
  t2923 = t429 * t2747;
  t2932 = t455 * t844;
  t2933 = t95 * t2876;
  t2944 = 0.2e1 * t882;
  t2945 = 0.2e1 * t885;
  t2946 = 0.2e1 * t907;
  t2949 = t2748 * t1498 * t2772 + 0.6e1 * t2923 * t1516 * t840 + 0.2e1 * t183 * t2876 * t194 - 0.3e1 * t831 * t1538 - t1728 * t841 + 0.2e1 * t263 * t1876 - 0.2e1 * t2933 * t209 + 0.2e1 * t2933 * t211 + t2932 + t2944 - t2945 - t2946 - 0.4e1 * t864 + 0.4e1 * t871 - 0.4e1 * t875 + 0.4e1 * t911 + 0.4e1 * t920;
  t2953 = my_piecewise5(t57, 0, t60, 0, t2614 + t2669 + t2726 + t2769 + t2819 + t2872 + t2920 + t2949);
  t2960 = my_piecewise3(t3, 0, -t8 * t159 * t340 / 0.3e2 + t8 * t78 * t936 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (0.2e1 * t123 * t687 + 0.2e1 * t567 * t129 + t177 * t338 + 0.4e1 * t239 * t269 + t52 * t2953 + 0.2e1 * t93 * t934));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t2960 + 0.4e1 * t941;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2986 = t973 * t207;
  t2987 = t183 * t2986;
  t2990 = t976 * t207;
  t2991 = t183 * t2990;
  t2996 = t439 * t145;
  t3000 = t429 * t956;
  t3007 = t193 * t145;
  t3011 = t581 * t184;
  t3022 = t193 * t512;
  t3030 = t3011 * t1696;
  t3041 = -t330 - 0.6e1 * t2987 * t968 - 0.6e1 * t2991 * t968 - 0.3e1 * t957 * t1843 + 0.18e2 * t2610 * t2996 * t1329 - 0.12e2 * t3000 * t523 * t438 * t2617 - 0.3e1 * t957 * t2242 + 0.18e2 * t2610 * t3007 * t1329 - 0.18e2 * t3000 * t3011 * t1762 + 0.6e1 * t2380 * t964 + 0.6e1 * t798 * t2571 + 0.3e1 * t798 * t962 * t2007 + 0.18e2 * t2383 * t3022 * t652 - 0.6e1 * t2987 * t959 - 0.6e1 * t2991 * t959 + 0.18e2 * t957 * t3030 + 0.18e2 * t957 * t485 * t184 * t1696 - 0.18e2 * t2283 * t962 * t652 - 0.4e1 * t960;
  t3044 = t2292 * t1496;
  t3045 = t1490 * t3044;
  t3046 = t1501 * t126;
  t3047 = t3046 * t583;
  t3050 = t1900 * t1496;
  t3051 = t1490 * t3050;
  t3052 = t145 * t512;
  t3057 = t95 * t3044;
  t3058 = t989 * t184;
  t3059 = t103 * t3058;
  t3062 = t429 * t3044;
  t3065 = t3046 * t184;
  t3066 = t439 * t3065;
  t3069 = t183 * t3044;
  t3072 = t103 * t3065;
  t3082 = t2747 * t1496;
  t3083 = t1490 * t3082;
  t3084 = t3052 * t126;
  t3088 = t2288 * t434;
  t3089 = t183 * t3088;
  t3092 = t1832 * t1347;
  t3100 = t103 * t983 * t184;
  t3104 = t183 * t354 * t1571;
  t3107 = 0.7e1 * t3051 * t193 * t3052 * t184 + 0.11e2 * t3083 * t1653 * t3084 + 0.6e1 * t1011 * t2627 + 0.3e1 * t1011 * t3092 - 0.12e2 * t1014 * t2762 - 0.3e1 * t3104 * t2680 - 0.7e1 * t3045 * t3047 + 0.18e2 * t3062 * t3047 - 0.7e1 * t3069 * t3047 + 0.6e1 * t3057 * t3059 + t3057 * t3072 + 0.11e2 * t3057 * t3100 + 0.6e1 * t3062 * t3059 - 0.18e2 * t3069 * t3059 + 0.12e2 * t3062 * t3066 + 0.6e1 * t3062 * t3072 - 0.7e1 * t3069 * t3072 + 0.6e1 * t3089 * t985 + 0.4e1 * t965 - 0.4e1 * t969;
  t3126 = t354 * params->csk_a;
  t3131 = t193 * t3126;
  t3134 = t95 * t3088;
  t3147 = t429 * t3088;
  t3153 = t989 * t193 * t203;
  t3163 = -0.6e1 * t3062 * t439 * t3058 - 0.18e2 * t1968 * t193 * t750 - 0.3e1 * t3104 * t2694 - 0.11e2 * t3069 * t3100 + 0.3e1 * t95 * t737 * t1571 * t352 - t3045 * t3072 + 0.3e1 * t1004 * t2361 - 0.6e1 * t3083 * t1653 * t3126 - 0.18e2 * t429 * t3082 * t3131 - 0.6e1 * t3134 * t985 - 0.6e1 * t982 * t2627 - 0.3e1 * t982 * t3092 + 0.7e1 * t183 * t3082 * t3131 - 0.11e2 * t3069 * t193 * t3058 - 0.6e1 * t3147 * t991 - 0.6e1 * t988 * t2583 - 0.3e1 * t988 * t3153 + 0.18e2 * t3083 * t439 * t3084 - 0.12e2 * t3045 * t3066 - 0.4e1 * t3147 * t995;
  t3166 = t989 * t203;
  t3172 = t103 * t3166;
  t3199 = t771 * t207;
  t3214 = t429 * t1883 * t434;
  t3217 = -0.4e1 * t988 * t2658 - 0.2e1 * t988 * t439 * t3166 - 0.2e1 * t982 * t2630 - t982 * t3172 + 0.6e1 * t3089 * t1020 + 0.3e1 * t1011 * t3172 + 0.6e1 * t1011 * t2630 + 0.6e1 * t3089 * t991 + 0.6e1 * t1011 * t2583 + 0.3e1 * t1011 * t3153 + 0.6e1 * t95 * t2986 * t910 + 0.6e1 * t95 * t2990 * t910 + 0.3e1 * t1014 * t1940 - 0.6e1 * t3045 * t1653 * t3065 + 0.6e1 * t1985 * t1000 + 0.6e1 * t998 * t193 * t3199 + 0.3e1 * t998 * t2262 - 0.6e1 * t2610 * t439 * t956 - 0.12e2 * t429 * t3050 * t439 * t737 * params->csk_a + 0.6e1 * t3214 * t1007;
  t3221 = t298 * params->csk_a * t97;
  t3222 = t439 * t3221;
  t3232 = t193 * t3221;
  t3250 = t1661 * t3007;
  t3262 = 0.6e1 * t1004 * t3222 - 0.2e1 * t3147 * t1020 - 0.2e1 * t988 * t2630 - t988 * t3172 + 0.6e1 * t3214 * t1017 + 0.6e1 * t1004 * t3232 + 0.3e1 * t1004 * t2375 - 0.6e1 * t3083 * t439 * t3126 - 0.2e1 * t3134 * t1020 - t2590 + t2593 - t2595 + 0.3e1 * t355 * t1661 * t613 + 0.6e1 * t2293 * t1613 * t357 * t184 + 0.3e1 * t183 * t622 * t3250 + 0.11e2 * t2041 * t1531 * t289 * t184 - 0.2e1 * t727 * t892 - t305 * t2805 - 0.6e1 * t2035 * t1028;
  t3263 = t764 * t97;
  t3276 = t523 * t1856 * t145;
  t3301 = -0.6e1 * t606 * t507 * t3263 - 0.3e1 * t606 * t2502 + 0.6e1 * t2923 * t1516 * t1039 - 0.4e1 * t2327 * t1032 - t1728 * t1040 - 0.2e1 * t839 * t3276 - 0.2e1 * t839 * t523 * t596 * t298 + t2748 * t1498 * t1862 * t145 + t2299 * t352 + 0.2e1 * t759 * t900 + t293 * t2782 - 0.4e1 * t730 * t2856 - 0.2e1 * t730 * t511 * t357 * t203 - t2446 * t352 - 0.2e1 * t727 * t900 - t305 * t2782 - t2446 * t362 - t2690 + t2693 - t2729;
  t3305 = t2731 - t2733 + t2742 + t2744 - t2787 - t2788 + t2791 - t2793 + t2846 - t2848 + t2866 + t2869 - t356 + t2870 + t2871 - t2874 - 0.2e1 * t975 - 0.2e1 * t978 - t2885 - t2899;
  t3328 = t103 * t512;
  t3332 = -t2902 + t2910 - t2913 + t2932 + 0.4e1 * t1001 + 0.4e1 * t1015 + t2944 - t2945 - t2946 + t2299 * t358 + 0.2e1 * t759 * t856 + t293 * t2907 + t2127 * t290 + 0.2e1 * t609 * t765 + t263 * t2320 - t95 * t719 * t126 * t209 - 0.2e1 * t95 * t298 * t254 * t209 - t95 * t145 * t576 * t209 - 0.6e1 * t3000 * t3030 - 0.6e1 * t2283 * t3328 * t652;
  t3336 = my_piecewise5(t57, 0, t60, 0, t3041 + t3107 + t3163 + t3217 + t3262 + t3301 + t3305 + t3332);
  t3343 = my_piecewise3(t3, 0, -t8 * t159 * t367 / 0.3e2 + t8 * t78 * t1048 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (0.5e1 / 0.27e2 * t45 * t233 * t129 - 0.5e1 / 0.36e2 * t45 * t116 * t269 + t45 * t137 * t687 / 0.24e2 + t567 * t148 + 0.2e1 * t239 * t309 + t123 * t805 + t177 * t365 + 0.2e1 * t93 * t1046 + t52 * t3336));
  tv4rho2sigmalapl0 = 0.2e1 * rho[0] * t3343 + 0.4e1 * t1053;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmatau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  t3365 = t379 * t434;
  t3366 = t429 * t3365;
  t3371 = t95 * t3365;
  t3374 = t183 * t3365;
  t3377 = t1087 * t434;
  t3378 = t183 * t3377;
  t3383 = t512 * t97;
  t3384 = t103 * t298;
  t3385 = t3383 * t3384;
  t3390 = t429 * t3377;
  t3393 = t862 * t3384;
  t3407 = -0.8e1 * t988 * t439 * t512 * t298 * t97 + 0.12e2 * t1011 * t3385 + 0.12e2 * t1011 * t3393 - 0.3e1 * t1089 * t2621 + 0.18e2 * t3366 * t1684 - 0.6e1 * t3366 * t2578 - 0.6e1 * t3371 * t2578 + 0.18e2 * t3374 * t2578 - 0.18e2 * t3390 * t2624 + 0.18e2 * t3378 * t2642 + 0.12e2 * t988 * t3232 - 0.18e2 * t3371 * t649 - 0.4e1 * t982 * t3385 - 0.4e1 * t988 * t3385 - t330 - t383;
  t3408 = t512 * t190;
  t3409 = t3408 * t3263;
  t3420 = t1066 * t188;
  t3421 = t95 * t3420;
  t3422 = t771 * t99;
  t3440 = t376 * t1492;
  t3441 = t429 * t3440;
  t3446 = t1490 * t3440;
  t3448 = -0.12e2 * t988 * t3409 + 0.12e2 * t1011 * t3409 - 0.12e2 * t3390 * t2618 + 0.12e2 * t2006 * t193 * t1066 * t298 + 0.12e2 * t3421 * t103 * t3422 + 0.12e2 * t988 * t3222 + 0.3e1 * t1094 * t1691 + 0.18e2 * t3374 * t2664 - 0.12e2 * t982 * t3393 - 0.3e1 * t1089 * t2606 + 0.18e2 * t2610 * t439 * t1087 * params->csk_a - t2590 + t2593 - t2595 - 0.6e1 * t3441 * t2684 + 0.6e1 * t3441 * t2720 - t3446 * t2720;
  t3450 = t95 * t3440;
  t3452 = t183 * t3440;
  t3456 = t1516 * t1075 * params->csk_a;
  t3461 = t376 * t184;
  t3467 = t376 * t1571;
  t3468 = t183 * t3467;
  t3471 = t192 * t184;
  t3490 = t192 * t376;
  t3495 = 0.7e1 * t2798 * t1531 * t3490 * params->csk_a - 0.18e2 * t385 * t507 * t3471 * t207 + 0.3e1 * t95 * t3461 * t2072 - 0.3e1 * t1084 * t1741 - 0.12e2 * t1112 * t2762 + 0.11e2 * t3450 * t2674 - 0.11e2 * t3452 * t2674 - 0.3e1 * t3468 * t2680 - 0.3e1 * t3468 * t2694 - 0.18e2 * t3441 * t2704 + 0.6e1 * t3441 * t2708 + 0.6e1 * t3450 * t2708 - 0.18e2 * t3452 * t2708 + t3450 * t2720 - 0.7e1 * t3452 * t2720 - 0.12e2 * t2923 * t3456;
  t3501 = t523 * t768 * t298;
  t3504 = t1500 * t376;
  t3506 = t1498 * t3504 * params->csk_a;
  t3517 = t1531 * t3490 * t512;
  t3534 = t466 * t103 * t719;
  t3539 = -0.12e2 * t2120 * t507 * t289 * t298 + 0.3e1 * t1081 * t1723 + 0.3e1 * t1081 * t1741 - t1084 * t1723 - t1102 * t1723 - 0.3e1 * t1102 * t1754 + 0.3e1 * t1102 * t1775 + 0.18e2 * t3446 * t2684 + 0.18e2 * t3441 * t2736 - 0.7e1 * t3446 * t2736 - 0.7e1 * t3452 * t2736 - 0.6e1 * t2748 * t3456 - 0.6e1 * t2748 * t3506 + 0.7e1 * t2748 * t3517 - 0.11e2 * t2798 * t3517 - 0.2e1 * t305 * t3534 - 0.4e1 * t839 * t3501;
  t3573 = t523 * t1075 * t207;
  t3576 = -0.12e2 * t3446 * t2716 - 0.2e1 * t305 * t215 * t216 * t719 - 0.2e1 * t1102 * t2766 - 0.6e1 * t3446 * t2778 + 0.2e1 * t293 * t3534 + 0.3e1 * t1081 * t1754 + 0.12e2 * t3441 * t2716 + 0.3e1 * t1112 * t1940 + 0.3e1 * t1099 * t1746 + 0.3e1 * t1102 * t1732 + 0.11e2 * t3446 * t1498 * t1510 * t184 - 0.8e1 * t730 * t511 * t1068 * t97 - 0.6e1 * t2822 * t3573 - t2690 + t2693 - t2729;
  t3578 = t2731 - t2733 + t2742 + t2744 - t2787 - t2788 + t2791 - t2793 + t2846 - t2848 + t2866 + t2869 + t2870 + t2871 - t2874 - 0.4e1 * t1070 - t2885;
  t3580 = t183 * t3420;
  t3590 = t298 * t298;
  t3591 = t95 * t3590;
  t3604 = 0.2e1 * t183 * t3590 * t194 - 0.12e2 * t3580 * t2031 * t3422 + 0.12e2 * t798 * t962 * t3199 - 0.12e2 * t3580 * t873 * t3384 - 0.2e1 * t3591 * t209 + 0.2e1 * t3591 * t211 - 0.4e1 * t1090 + 0.4e1 * t1095 - 0.4e1 * t1097 + 0.4e1 * t1100 + 0.4e1 * t1113 - t2899 - t2902 + t2910 - t2913 + t2932 + t2944;
  t3605 = t95 * t3467;
  t3613 = t1516 * t1075;
  t3623 = t102 * t719;
  t3631 = t1498 * t3504;
  t3635 = t3590 * t186;
  t3636 = t183 * t3635;
  t3644 = -t2945 - t2946 + 0.3e1 * t3605 * t2887 + 0.6e1 * t3450 * t2890 + 0.11e2 * t3452 * t1531 * t3471 + 0.6e1 * t2923 * t3613 + 0.3e1 * t183 * t3461 * t1666 - 0.3e1 * t1081 * t1538 - 0.2e1 * t1084 * t2914 - 0.2e1 * t1067 * t851 * t3623 + 0.2e1 * t293 * t198 * t3623 - t1728 * t1076 + t2748 * t3631 + 0.2e1 * t305 * t2320 - 0.2e1 * t3636 * t217 + 0.2e1 * t95 * t3635 * t200 - 0.2e1 * t3636 * t200;
  t3648 = my_piecewise5(t57, 0, t60, 0, t3407 + t3448 + t3495 + t3539 + t3576 + t3578 + t3604 + t3644);
  t3655 = my_piecewise3(t3, 0, -t8 * t159 * t391 / 0.3e2 + t8 * t78 * t1139 / 0.5e1 + 0.3e1 / 0.2e2 * t8 * t24 * (0.1e2 / 0.27e2 * t45 * t233 * t148 - 0.5e1 / 0.18e2 * t45 * t116 * t309 + t45 * t137 * t805 / 0.12e2 + t177 * t389 + 0.2e1 * t93 * t1137 + t52 * t3648));
  tv4rho2lapl20 = 0.2e1 * rho[0] * t3655 + 0.4e1 * t1144;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 0] += tv4rho2tau20;

  t3666 = t2687 * t434;
  t3667 = t429 * t3666;
  t3668 = t3667 * t991;
  t3670 = t1152 * t434;
  t3671 = t429 * t3670;
  t3672 = t512 * t186;
  t3673 = t3672 * t97;
  t3674 = t193 * t3673;
  t3677 = t3667 * t1020;
  t3679 = t183 * t3666;
  t3680 = t3679 * t991;
  t3682 = t183 * t3670;
  t3685 = t1151 * t186;
  t3686 = t3685 * t434;
  t3687 = t429 * t3686;
  t3688 = t193 * t869;
  t3691 = t512 * t328;
  t3692 = t3691 * t97;
  t3693 = t103 * t3692;
  t3694 = t1933 * t3693;
  t3696 = t1920 * t3693;
  t3698 = t328 * params->csk_a;
  t3699 = t3698 * t97;
  t3701 = t1004 * t193 * t3699;
  t3705 = t1989 * t439 * t3698 * t126;
  t3707 = t3667 * t995;
  t3709 = t1841 * t254;
  t3710 = t193 * t3709;
  t3713 = -0.18e2 * t3671 * t3674 + 0.18e2 * t3682 * t3674 + 0.18e2 * t3687 * t3688 - 0.9e1 * t861 * t3710 - t330 - t332 - 0.9e1 * t3668 - 0.3e1 * t3677 + 0.9e1 * t3680 - 0.3e1 * t3694 + 0.9e1 * t3696 + 0.9e1 * t3701 + 0.9e1 * t3705 - 0.6e1 * t3707;
  t3715 = t95 * t3666 * t985;
  t3717 = t3679 * t985;
  t3721 = t186 * params->csk_a * t97;
  t3722 = t103 * t3721;
  t3727 = t1841 * t2565;
  t3731 = t103 * t1689 * t254;
  t3734 = t1169 * t207;
  t3736 = t2006 * t193 * t3734;
  t3739 = t3383 * t207;
  t3740 = t103 * t3739;
  t3748 = t243 * t434;
  t3749 = t429 * t3748;
  t3750 = t1152 * params->csk_a;
  t3754 = t439 * t3673;
  t3758 = t2591 * t103 * t963;
  t3760 = t1151 * t1492;
  t3761 = t1490 * t3760;
  t3762 = t1531 * t903;
  t3765 = 0.18e2 * t183 * t3686 * t3740 - 0.18e2 * t95 * t3670 * t3722 - 0.6e1 * t95 * t3686 * t3740 + 0.18e2 * t3749 * t439 * t3750 - 0.12e2 * t3671 * t3754 + 0.18e2 * t3682 * t3722 - 0.6e1 * t3687 * t3740 - 0.9e1 * t861 * t3727 + 0.9e1 * t868 * t3731 + 0.7e1 * t3761 * t3762 - 0.9e1 * t3715 + 0.9e1 * t3717 + 0.9e1 * t3736 + 0.9e1 * t3758;
  t3767 = t1506 * t990;
  t3770 = t884 * t892;
  t3773 = t198 * t502 * t254;
  t3776 = t192 * t1151;
  t3781 = t95 * t3760;
  t3782 = t1613 * t250;
  t3785 = t183 * t3760;
  t3790 = t1516 * t922;
  t3794 = t1613 * t1614 * t97;
  t3798 = t429 * t3760;
  t3802 = t1531 * t265;
  t3807 = -0.18e2 * t244 * t507 * t3776 * t207 - 0.7e1 * t3761 * t3767 - 0.6e1 * t3761 * t3790 - t3761 * t3794 - 0.7e1 * t3785 * t3767 + 0.18e2 * t3798 * t3767 + 0.9e1 * t908 * t3773 + 0.11e2 * t3781 * t3782 + t3781 * t3794 - 0.11e2 * t3785 * t3782 - 0.7e1 * t3785 * t3794 + 0.6e1 * t3798 * t3794 - 0.18e2 * t3798 * t3802 - 0.3e1 * t3770;
  t3809 = t1516 * t1517 * t97;
  t3812 = t602 * t1210;
  t3814 = t193 * t254;
  t3815 = t581 * t3814;
  t3818 = t1151 * t1571;
  t3819 = t183 * t3818;
  t3822 = t1151 * t97;
  t3827 = t1613 * t513 * t97;
  t3836 = t1516 * t895;
  t3841 = t2688 * t1032;
  t3844 = t511 * t1567 * t97;
  t3849 = t2120 * t507 * t843 * t126;
  t3851 = t485 * t2565;
  t3854 = 0.3e1 * t95 * t3822 * t2072 - 0.12e2 * t1153 * t3844 - 0.3e1 * t3819 * t251 - 0.3e1 * t3819 * t266 - 0.11e2 * t3785 * t3762 + 0.6e1 * t3781 * t3827 - 0.18e2 * t3785 * t3827 + 0.12e2 * t3798 * t3809 + 0.6e1 * t3798 * t3827 - 0.6e1 * t3798 * t3836 - 0.9e1 * t877 * t3815 + 0.9e1 * t831 * t3851 + 0.3e1 * t3812 - 0.6e1 * t3841 - 0.9e1 * t3849;
  t3858 = t511 * t513 * t254;
  t3867 = t839 * t523 * t596 * t328;
  t3871 = t97 * t1492;
  t3872 = t1490 * t3871;
  t3873 = t1500 * t1151;
  t3880 = t438 * t1151;
  t3882 = t1516 * t3880 * t512;
  t3888 = t523 * t538 * t254;
  t3896 = t1498 * t1502 * t97;
  t3903 = 0.11e2 * t3872 * t1498 * t3873 * t512 - 0.6e1 * t3872 * t1498 * t3873 * params->csk_a + 0.9e1 * t877 * t2132 + 0.9e1 * t877 * t2178 - 0.12e2 * t3761 * t3809 - 0.6e1 * t3761 * t3896 + 0.7e1 * t3785 * t3802 + 0.9e1 * t831 * t3815 - 0.3e1 * t827 * t3858 + 0.9e1 * t831 * t3858 - 0.3e1 * t877 * t3858 + 0.18e2 * t3872 * t3882 - 0.6e1 * t877 * t3888 - 0.3e1 * t3867;
  t3915 = t884 * t900;
  t3917 = 0.6e1 * t1171;
  t3918 = -0.6e1 * t429 * t243 * t523 * t3880 * t207 + 0.9e1 * t917 * t2112 - 0.12e2 * t3798 * t3790 - 0.9e1 * t827 * t3851 + t1150 + t1155 + t1159 + t1174 - 0.3e1 * t3915 - t3917 + t825 + t845 - t848 - t855;
  t3920 = t2031 * t963;
  t3921 = t2588 * t3920;
  t3923 = t846 * t207;
  t3924 = t962 * t3923;
  t3925 = t646 * t3924;
  t3928 = t183 * t3734 * t959;
  t3930 = -0.9e1 * t3921 + 0.9e1 * t3925 - 0.9e1 * t3928 - t864 + t871 - t875 - t1198 - t1201 + t1204 - t1206 - t1208 + t1212 + t882 - t885;
  t3940 = t429 * t3871;
  t3946 = t95 * t328 * t254 * t209;
  t3948 = t609 * t844;
  t3950 = t824 * t856;
  t3952 = t511 * t852;
  t3955 = t183 * t3871;
  t3962 = t1613 * t260;
  t3965 = t3872 * t1498 * t3873 + 0.6e1 * t3940 * t1516 * t3880 + 0.11e2 * t3955 * t1531 * t3776 + 0.3e1 * t183 * t3822 * t1666 + 0.3e1 * t95 * t3818 * t261 - 0.3e1 * t877 * t1857 - 0.9e1 * t831 * t1891 + 0.6e1 * t3781 * t3962 - 0.6e1 * t827 * t3952 - 0.3e1 * t3946 + 0.3e1 * t3948 + 0.3e1 * t3950 - t907 + t911 + t920;
  t3969 = my_piecewise5(t57, 0, t60, 0, t3713 + t3765 + t3807 + t3854 + t3903 + t3918 + t3930 + t3965);
  t3976 = my_piecewise3(t3, 0, t8 * t78 * t1217 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (t93 * t1215 + 0.3e1 * t123 * t934 + 0.3e1 * t239 * t338 + t52 * t3969));
  tv4rhosigma30 = 0.2e1 * rho[0] * t3976 + 0.2e1 * t1221;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  t3993 = t988 * t3693;
  t3994 = t2671 * t1496;
  t3995 = t1490 * t3994;
  t3998 = t512 * t321;
  t3999 = t3998 * t879;
  t4006 = t1501 * t321;
  t4007 = t4006 * t990;
  t4010 = t193 * t3692;
  t4011 = t1011 * t4010;
  t4013 = t4006 * t97;
  t4014 = t439 * t4013;
  t4017 = t982 * t3693;
  t4018 = t1011 * t3693;
  t4028 = t988 * t4010;
  t4030 = t3998 * t97;
  t4034 = t103 * t3699;
  t4035 = t982 * t4034;
  t4037 = 0.7e1 * t3995 * t193 * t3052 * t97 - 0.6e1 * t3062 * t439 * t4030 - 0.6e1 * t3995 * t1007 - 0.7e1 * t3045 * t4007 + 0.6e1 * t3057 * t3999 + 0.6e1 * t3062 * t3999 + 0.18e2 * t3062 * t4007 + 0.12e2 * t3062 * t4014 - 0.18e2 * t3069 * t3999 - 0.7e1 * t3069 * t4007 - t330 - t3993 + 0.3e1 * t4011 - t4017 + 0.3e1 * t4018 - 0.3e1 * t4028 - 0.3e1 * t4035 - t960 + t965 - t969;
  t4038 = t103 * t4013;
  t4045 = t3871 * t1496;
  t4046 = t1490 * t4045;
  t4047 = t3052 * t321;
  t4054 = t989 * t3814;
  t4057 = t298 * t321;
  t4059 = t183 * t4057 * t207;
  t4062 = t983 * t2565;
  t4066 = t1005 * t321;
  t4067 = t193 * t4066;
  t4072 = t1005 * t254;
  t4079 = t1231 * t207;
  t4080 = t193 * t4079;
  t4081 = t2006 * t4080;
  t4083 = t95 * t4079;
  t4084 = t4083 * t910;
  t4091 = t1005 * t328;
  t4092 = t193 * t4091;
  t4093 = t1989 * t4092;
  t4100 = 0.6e1 * t1004 * t439 * t4072 - 0.6e1 * t3045 * t1653 * t4013 + 0.11e2 * t4046 * t1653 * t4047 - 0.6e1 * t4046 * t1653 * t4066 - 0.6e1 * t2575 * t439 * t999 - 0.18e2 * t429 * t4045 * t4067 + 0.18e2 * t4046 * t439 * t4047 + 0.6e1 * t1011 * t4054 + 0.6e1 * t1011 * t4062 + 0.3e1 * t2380 * t1252 - 0.12e2 * t3045 * t4014 - t3045 * t4038 + t3057 * t4038 + 0.6e1 * t3062 * t4038 - 0.7e1 * t3069 * t4038 - 0.6e1 * t988 * t4054 - 0.3e1 * t4059 * t469 + 0.3e1 * t4081 + 0.3e1 * t4084 + 0.3e1 * t4093;
  t4102 = t439 * t4091;
  t4103 = t1989 * t4102;
  t4106 = t988 * t439 * t3692;
  t4112 = t989 * t2565;
  t4138 = t199 * t321;
  t4139 = t198 * t4138;
  t4143 = t103 * t1250 * t97;
  t4150 = t183 * t1245 * t1571;
  t4156 = t1011 * t4034;
  t4163 = 0.3e1 * t4103 - 0.2e1 * t4106 - 0.4e1 * t988 * t439 * t989 * t254 + 0.6e1 * t1011 * t4112 - 0.2e1 * t988 * t4112 + 0.6e1 * t1004 * t193 * t4072 - 0.6e1 * t982 * t4062 + 0.7e1 * t183 * t4045 * t4067 + 0.6e1 * t1014 * t3773 - 0.18e2 * t183 * t3748 * t193 * t1246 - 0.3e1 * t4059 * t461 + 0.6e1 * t998 * t193 * t2990 + 0.3e1 * t95 * t301 * t1571 * t4139 + 0.11e2 * t3057 * t4143 - 0.12e2 * t95 * t1246 * t3844 - 0.3e1 * t4150 * t266 - 0.11e2 * t3069 * t193 * t4030 + 0.3e1 * t4156 - 0.12e2 * t429 * t3994 * t1007 - 0.3e1 * t4150 * t251;
  t4183 = t730 * t511 * t1234 * t97;
  t4203 = t3872 * t1498 * t2772 * t145 + 0.6e1 * t2683 * t1516 * t768 * t97 - 0.4e1 * t730 * t511 * t357 * t254 + 0.3e1 * t95 * t4057 * t625 - 0.3e1 * t2327 * t1259 + 0.3e1 * t2431 * t1259 - 0.6e1 * t3715 + 0.6e1 * t3717 + 0.6e1 * t3736 + 0.6e1 * t3758 - 0.2e1 * t4183;
  t4210 = t507 * t289 * t328;
  t4211 = t2120 * t4210;
  t4214 = t523 * t2842 * t145;
  t4215 = t839 * t4214;
  t4220 = t727 * t1285;
  t4223 = t759 * t1210;
  t4226 = t727 * t1210;
  t4227 = t321 * t97;
  t4254 = 0.3e1 * t877 * t2469 - 0.3e1 * t4211 - t4215 - 0.2e1 * t580 * t3276 - 0.3e1 * t2289 * t1281 - t4220 - 0.2e1 * t2289 * t1288 + t4223 + 0.3e1 * t2431 * t1281 - t4226 + 0.3e1 * t183 * t4227 * t3250 + 0.3e1 * t1265 * t1661 * t879 + 0.6e1 * t2293 * t1613 * t1239 * t97 - t2289 * t1273 + 0.11e2 * t3955 * t1531 * t289 * t321 + 0.3e1 * t917 * t2493 - 0.6e1 * t606 * t507 * t289 * t254 + 0.3e1 * t877 * t2434 - t2327 * t1273 + 0.3e1 * t2431 * t1273;
  t4263 = t429 * t2282;
  t4265 = t3998 * t190 * t918;
  t4268 = t183 * t797;
  t4270 = t4268 * t2031 * t3923;
  t4272 = t439 * t512;
  t4273 = t4227 * t207;
  t4277 = -0.12e2 * t4263 * t4272 * t4273 - 0.18e2 * t4263 * t4265 - 0.4e1 * t1171 + t1228 + t1230 + t1236 + t1237 - t1313 - 0.3e1 * t4270 - t975 - t978;
  t4280 = t798 * t3924;
  t4292 = t581 * t186 * t879;
  t4314 = t4268 * t3924;
  t4322 = 0.3e1 * t4280 + 0.18e2 * t2383 * t4265 - 0.18e2 * t2283 * t962 * t4273 + 0.18e2 * t1247 * t485 * t186 * t879 + 0.18e2 * t1247 * t4292 - 0.6e1 * t429 * t1246 * t4292 - 0.6e1 * t2283 * t3328 * t4273 - 0.6e1 * t957 * t2240 * t2565 + 0.18e2 * t3749 * t3007 * t1251 + 0.6e1 * t798 * t962 * t849 * t254 - 0.6e1 * t957 * t967 * t3709 - 0.3e1 * t4314 + 0.18e2 * t2575 * t2996 * t869 - 0.6e1 * t3921 + 0.6e1 * t3925 - 0.6e1 * t3928 - t1249 + t1254 - t1256 + t1001;
  t4327 = t759 * t1235;
  t4328 = t884 * t765;
  t4336 = t95 * t298 * t328 * t209;
  t4337 = -0.2e1 * t2327 * t1240 - t877 * t2303 - 0.3e1 * t831 * t2333 - 0.2e1 * t3946 + 0.2e1 * t3948 + 0.2e1 * t3950 + t4327 + t4328 - t4336 - t885 - t907;
  t4342 = my_piecewise5(t57, 0, t60, 0, t4337 + t4322 + t4277 + t4254 + t4203 + t4163 + t4100 + t4037 - 0.2e1 * t3915 - 0.2e1 * t3867 - 0.6e1 * t3849 - 0.4e1 * t3841 + 0.2e1 * t3812 - 0.2e1 * t3770 + 0.6e1 * t3705 - 0.4e1 * t3707 + 0.6e1 * t3701 - 0.2e1 * t3694 + 0.6e1 * t3696 + 0.6e1 * t3680 - 0.2e1 * t3677 - 0.6e1 * t3668 + t1298 - t1294 - t1297 + t1291 - t1286 - t1278 + t1267 + t1269 + t1015 + t882 + t845 - t848 + t825 - t356 - 0.2e1 * t982 * t4112 - 0.11e2 * t3069 * t4143);
  t4349 = my_piecewise3(t3, 0, t8 * t78 * t1303 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.5e1 / 0.72e2 * t45 * t116 * t338 + t45 * t137 * t934 / 0.24e2 + 0.2e1 * t239 * t365 + 0.2e1 * t123 * t1046 + t93 * t1301 + t52 * t4342));
  tv4rhosigma2lapl0 = 0.2e1 * rho[0] * t4349 + 0.2e1 * t1307;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  t4364 = t3440 * t1496;
  t4365 = t429 * t4364;
  t4367 = t245 * t97;
  t4368 = t1501 * t190 * t4367;
  t4371 = t3046 * t97;
  t4372 = t439 * t4371;
  t4375 = t193 * t984;
  t4378 = t183 * t4364;
  t4383 = t1490 * t4364;
  t4388 = t376 * params->csk_a;
  t4393 = t95 * t4364;
  t4394 = t103 * t4371;
  t4408 = t245 * t298;
  t4409 = t3408 * t4408;
  t4413 = t183 * t3467 * t188;
  t4418 = -0.6e1 * t3051 * t439 * t4388 * t97 + 0.6e1 * t4268 * t193 * t2986 + 0.18e2 * t4365 * t4368 + 0.12e2 * t4365 * t4372 - 0.18e2 * t4365 * t4375 + 0.6e1 * t4365 * t4394 - 0.7e1 * t4378 * t4368 - 0.7e1 * t4383 * t4368 + 0.7e1 * t4378 * t4375 - 0.3e1 * t4413 * t4375 - 0.7e1 * t4378 * t4394 - 0.11e2 * t4378 * t985 - t4383 * t4394 + 0.7e1 * t4383 * t991 + t4393 * t4394 + 0.11e2 * t4393 * t985 - 0.6e1 * t988 * t4409 - 0.3e1 * t4413 * t985 - t330 - t383;
  t4419 = t376 * t97;
  t4426 = t95 * t3377;
  t4442 = t983 * t3384;
  t4445 = t989 * t298;
  t4446 = t103 * t4445;
  t4453 = t644 * t298;
  t4457 = t983 * t298;
  t4479 = t376 * t512 * t126;
  t4483 = 0.3e1 * t95 * t4419 * t1571 * t352 - 0.11e2 * t4378 * t991 - 0.12e2 * t4426 * t103 * t248 * t97 + 0.6e1 * t4393 * t1020 - 0.18e2 * t4378 * t1020 + 0.6e1 * t4365 * t1020 - 0.6e1 * t4365 * t995 - 0.18e2 * t3374 * t193 * t963 + 0.6e1 * t1011 * t4442 - 0.2e1 * t982 * t4446 + 0.6e1 * t1011 * t4446 - 0.2e1 * t988 * t4446 + 0.6e1 * t3421 * t103 * t4453 + 0.6e1 * t988 * t193 * t4457 - 0.6e1 * t3749 * t439 * t376 * t126 * t207 - 0.12e2 * t4365 * t439 * t984 + 0.6e1 * t988 * t439 * t4457 - 0.6e1 * t4046 * t1653 * t4388 * t126 + 0.6e1 * t1011 * t4409 + 0.18e2 * t4046 * t439 * t4479;
  t4516 = 0.11e2 * t4046 * t1653 * t4479 - 0.6e1 * t4383 * t1653 * t4371 - 0.4e1 * t988 * t439 * t4445 - 0.3e1 * t1089 * t3710 - 0.3e1 * t1089 * t3727 + 0.3e1 * t1094 * t3731 - 0.12e2 * t4383 * t4372 - 0.6e1 * t982 * t4442 - 0.2e1 * t3993 + 0.6e1 * t4011 - 0.2e1 * t4017 + 0.6e1 * t4018 - 0.6e1 * t4028 - 0.6e1 * t4035 + 0.6e1 * t4081 + 0.6e1 * t4084 + 0.6e1 * t4093 + 0.6e1 * t4103 - 0.4e1 * t4106 + 0.6e1 * t4156;
  t4548 = t3872 * t1498 * t1862 * t376 - 0.4e1 * t730 * t511 * t357 * t298 + 0.3e1 * t1081 * t3851 + 0.3e1 * t1081 * t3858 - 0.3e1 * t1084 * t3851 + 0.3e1 * t1102 * t2132 - t1102 * t3858 + 0.3e1 * t1112 * t3773 - 0.2e1 * t580 * t3501 + 0.3e1 * t3736 + 0.3e1 * t3758;
  t4589 = -t1084 * t3858 - 0.2e1 * t1102 * t3888 + 0.3e1 * t1099 * t2112 - 0.6e1 * t723 * t507 * t4408 + 0.6e1 * t3940 * t1516 * t1075 * t126 + 0.3e1 * t1102 * t2178 + 0.3e1 * t1081 * t3815 - 0.3e1 * t1102 * t3815 + 0.3e1 * t3605 * t198 * t1031 + 0.6e1 * t3450 * t1613 * t1031 + 0.3e1 * t183 * t4419 * t1661 * t1353 + 0.11e2 * t3452 * t1531 * t4367 - 0.4e1 * t4183 - 0.6e1 * t4211 - 0.2e1 * t4215 - 0.2e1 * t4220 + 0.2e1 * t4223 - 0.2e1 * t4226 - t3770 + t3812;
  t4593 = t1347 * t3721;
  t4600 = t3328 * t963;
  t4607 = 0.18e2 * t3366 * t3920 - 0.6e1 * t3366 * t4600 - 0.6e1 * t3371 * t4600 + 0.18e2 * t3374 * t4600 + 0.18e2 * t3378 * t4593 - 0.18e2 * t4426 * t4593 - t1071 + t1149 + t1173 - t1229 - 0.4e1 * t1233 + t1314 + t1315 - 0.2e1 * t3841 - 0.3e1 * t3849 - t3867 - t3915 + t825 + t845 - t848;
  t4609 = t3022 * t963;
  t4636 = 0.18e2 * t3366 * t439 * t126 * t869 - 0.6e1 * t3580 * t1322 * t3384 - 0.6e1 * t3580 * t2031 * t4453 + 0.6e1 * t798 * t962 * t2986 - 0.12e2 * t3366 * t4272 * t963 - 0.18e2 * t3366 * t4609 + 0.18e2 * t3374 * t4609 - t1090 + t1095 - t1097 - t1325 - t1328 + t1332 + t1336 - 0.3e1 * t3921 + 0.3e1 * t3925 - 0.3e1 * t3928 - 0.6e1 * t4270 + 0.6e1 * t4280 - 0.6e1 * t4314;
  t4646 = -t2051 * t1076 - 0.3e1 * t1081 * t1891 - 0.2e1 * t1084 * t3952 - t3946 + t3948 + t3950 + 0.2e1 * t4327 + 0.2e1 * t4328 - 0.2e1 * t4336 - t885 - t907;
  t4651 = my_piecewise5(t57, 0, t60, 0, t4646 + t4636 + t4607 + t4589 + t4548 + t4516 + t4483 + t4418 - 0.3e1 * t3715 + 0.3e1 * t3717 + 0.3e1 * t3705 - 0.2e1 * t3707 + 0.3e1 * t3701 - t3694 + 0.3e1 * t3696 + 0.3e1 * t3680 - t3677 - 0.3e1 * t3668 - t1367 + t1368 - t1369 + t1362 + t1211 - t1205 - t1197 + t1113 + t1100 + t882);
  t4658 = my_piecewise3(t3, 0, t8 * t78 * t1374 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.5e1 / 0.36e2 * t45 * t116 * t365 + t45 * t137 * t1046 / 0.12e2 + t239 * t389 + t123 * t1137 + t93 * t1372 + t52 * t4651));
  tv4rhosigmalapl20 = 0.2e1 * rho[0] * t4658 + 0.2e1 * t1378;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmatau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  t4671 = t1391 * t434;
  t4672 = t183 * t4671;
  t4675 = t429 * t4671;
  t4678 = t1386 * t186;
  t4679 = t4678 * t434;
  t4680 = t429 * t4679;
  t4683 = t95 * t4679;
  t4686 = t183 * t4679;
  t4694 = t439 * t1391 * params->csk_a;
  t4710 = 0.9e1 * t1094 * t103 * t1689 * t298 - 0.9e1 * t1089 * t193 * t1841 * t298 + 0.18e2 * t4686 * t193 * t3739 - 0.18e2 * t4675 * t3674 + 0.18e2 * t4680 * t3688 + 0.18e2 * t4672 * t3722 - 0.6e1 * t4680 * t3740 - 0.6e1 * t4683 * t3740 + 0.18e2 * t4686 * t3740 + 0.18e2 * t3749 * t4694 - 0.12e2 * t4675 * t3754 - 0.18e2 * t4683 * t870 - t330 - t383;
  t4726 = t1386 * t1492;
  t4727 = t429 * t4726;
  t4730 = -0.9e1 * t1089 * t1841 * t3384 - 0.18e2 * t4727 * t3802 - 0.3e1 * t3993 + 0.9e1 * t4011 - 0.3e1 * t4017 + 0.9e1 * t4018 - 0.9e1 * t4028 - 0.9e1 * t4035 + 0.9e1 * t4081 + 0.9e1 * t4084 + 0.9e1 * t4093 + 0.9e1 * t4103 - 0.6e1 * t4106 + 0.9e1 * t4156;
  t4736 = t183 * t4726;
  t4739 = t95 * t4726;
  t4745 = t1490 * t4726;
  t4761 = 0.9e1 * t1102 * t2469 + 0.7e1 * t4745 * t3762 + 0.18e2 * t4727 * t3767 - 0.7e1 * t4736 * t3767 - 0.7e1 * t4745 * t3767 - 0.6e1 * t4745 * t3790 + 0.6e1 * t4727 * t3794 - 0.7e1 * t4736 * t3794 + t4739 * t3794 - t4745 * t3794 + 0.12e2 * t4727 * t3809 - 0.18e2 * t4736 * t3827 + 0.6e1 * t4739 * t3827 - 0.6e1 * t4745 * t3896;
  t4766 = t192 * t1386;
  t4768 = t507 * t4766 * t207;
  t4773 = t511 * t1106;
  t4777 = t1531 * t4766 * params->csk_a;
  t4782 = t429 * t4678;
  t4783 = t438 * t97;
  t4792 = t1386 * t1571;
  t4793 = t183 * t4792;
  t4806 = t1386 * t97;
  t4810 = 0.9e1 * t1112 * t198 * t502 * t298 - 0.18e2 * t244 * t4768 + 0.9e1 * t1099 * t2493 - 0.9e1 * t1084 * t4773 + 0.7e1 * t3955 * t4777 - 0.11e2 * t4736 * t3762 - 0.6e1 * t4782 * t523 * t4783 * t207 - 0.6e1 * t4745 * t1498 * t1547 * t97 - 0.3e1 * t4793 * t251 + 0.6e1 * t4727 * t3827 + 0.11e2 * t4739 * t3782 - 0.12e2 * t1392 * t3844 - 0.3e1 * t4793 * t266 - 0.6e1 * t4727 * t3836 + 0.3e1 * t95 * t4806 * t2072;
  t4819 = t581 * t3384;
  t4825 = t507 * t528 * t298;
  t4836 = t1516 * t438 * t1386 * t512;
  t4845 = t1500 * t1386;
  t4847 = t1498 * t4845 * t512;
  t4851 = -0.6e1 * t1102 * t523 * t538 * t298 + 0.9e1 * t1081 * t4773 + 0.9e1 * t1081 * t4819 + 0.9e1 * t1081 * t4825 - 0.3e1 * t1084 * t4819 + 0.9e1 * t1102 * t2434 - 0.3e1 * t1102 * t4819 - 0.9e1 * t1102 * t4825 - 0.11e2 * t4736 * t3782 - 0.12e2 * t4727 * t3790 - 0.12e2 * t4745 * t3809 + 0.18e2 * t3872 * t4836 + 0.11e2 * t3872 * t4847 - 0.6e1 * t4183;
  t4857 = 0.6e1 * t1233;
  t4858 = -0.9e1 * t4211 - 0.3e1 * t4215 - 0.3e1 * t4220 + 0.3e1 * t4223 - 0.3e1 * t4226 + t825 + t845 - t848 - t1071 - t4857 + t1384 + t1385 + t1394 + t1398;
  t4863 = -0.9e1 * t4270 + 0.9e1 * t4280 - 0.9e1 * t4314 - t1090 + t1095 - t1097 - t1428 + t1431 - t1433 - t1434 + t1435 - t1436 + t1100 + t1113;
  t4867 = t1498 * t4845;
  t4872 = t1531 * t4766;
  t4877 = t95 * t4792;
  t4890 = -0.6e1 * t1084 * t511 * t1068 + 0.6e1 * t4727 * t1516 * t4783 + 0.3e1 * t183 * t4806 * t1666 - 0.9e1 * t1081 * t2333 - 0.3e1 * t1102 * t2303 + 0.3e1 * t4877 * t261 + t3872 * t4867 + 0.11e2 * t3955 * t4872 + 0.6e1 * t4739 * t3962 + 0.3e1 * t4327 + 0.3e1 * t4328 - 0.3e1 * t4336 + t882 - t885 - t907;
  t4894 = my_piecewise5(t57, 0, t60, 0, t4710 + t4730 + t4761 + t4810 + t4851 + t4858 + t4863 + t4890);
  t4901 = my_piecewise3(t3, 0, t8 * t78 * t1441 / 0.1e2 + 0.3e1 / 0.2e2 * t8 * t24 * (-0.5e1 / 0.24e2 * t45 * t116 * t389 + t45 * t137 * t1137 / 0.8e1 + t93 * t1439 + t52 * t4894));
  tv4rholapl30 = 0.2e1 * rho[0] * t4901 + 0.2e1 * t1445;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rhotau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 0] += tv4rhotau30;

  t4906 = t193 * t1251;
  t4907 = t2588 * t4906;
  t4910 = t103 * t3698 * t207;
  t4911 = t868 * t4910;
  t4916 = t183 * t328 * t321 * t207 * t469;
  t4918 = t2691 * t1281;
  t4920 = t321 * t321;
  t4921 = t4920 * t207;
  t4922 = t183 * t4921;
  t4925 = t4920 * t186;
  t4926 = t429 * t4925;
  t4930 = t511 * t513 * t328;
  t4931 = t827 * t4930;
  t4933 = t831 * t4930;
  t4936 = t877 * t2789;
  t4938 = t2688 * t1259;
  t4940 = t2691 * t1259;
  t4942 = t95 * t4921;
  t4947 = t2732 * t1281;
  t4949 = t429 * t4921;
  t4952 = t877 * t4930;
  t4954 = t2732 * t1288;
  t4960 = 0.18e2 * t4922 * t1710 - 0.18e2 * t4942 * t1710 - 0.12e2 * t4949 * t1738 + 0.18e2 * t4926 * t1750 - 0.18e2 * t4949 * t1763 + 0.18e2 * t4936 - 0.18e2 * t4938 + 0.18e2 * t4940 - 0.18e2 * t4947 - 0.6e1 * t4952 - 0.12e2 * t4954;
  t4962 = t917 * t2864;
  t4964 = t877 * t2844;
  t4969 = t183 * t4925;
  t4976 = t2867 * t198 * t1239 * t207;
  t4984 = t183 * t4920;
  t4992 = t328 * t328;
  t4993 = t95 * t4992;
  t4995 = 0.3e1 * t4993 * t209;
  t4998 = 0.3e1 * t183 * t4992 * t194;
  t5000 = 0.3e1 * t4993 * t211;
  t5001 = t95 * t4920;
  t5009 = t1490 * t4920 * t1654 + 0.6e1 * t429 * t4920 * t1673 + 0.6e1 * t5001 * t1657 + 0.3e1 * t5001 * t1662 + 0.3e1 * t4984 * t1666 + 0.11e2 * t4984 * t1669 + 0.4e1 * t1173 - 0.4e1 * t1197 - t4995 + t4998 + t5000;
  t5017 = t4920 * t1571;
  t5018 = t183 * t5017;
  t5024 = t4920 * t1492;
  t5025 = t95 * t5024;
  t5028 = t183 * t5024;
  t5031 = t429 * t5024;
  t5041 = t2688 * t1240;
  t5047 = t1490 * t5024;
  t5056 = t877 * t2898;
  t5058 = -0.6e1 * t5047 * t1503 + 0.11e2 * t5047 * t1511 - 0.12e2 * t5047 * t1518 - 0.6e1 * t5031 * t1523 + 0.18e2 * t5047 * t1523 - 0.11e2 * t5028 * t1535 - 0.12e2 * t4942 * t1568 - 0.12e2 * t5031 * t1633 - 0.3e1 * t5018 * t217 - 0.12e2 * t5041 - 0.6e1 * t5056;
  t5062 = t831 * t2911;
  t5074 = t4992 * t186;
  t5075 = t183 * t5074;
  t5077 = 0.3e1 * t5075 * t200;
  t5080 = 0.3e1 * t95 * t5074 * t200;
  t5082 = 0.3e1 * t5075 * t217;
  t5104 = -0.7e1 * t5028 * t1507 + 0.18e2 * t5031 * t1507 - 0.7e1 * t5047 * t1507 + 0.12e2 * t5031 * t1518 - 0.18e2 * t5031 * t1532 + 0.7e1 * t5047 * t1535 + t5025 * t1615 - 0.7e1 * t5028 * t1615 + 0.6e1 * t5031 * t1615 - t5047 * t1615 - 0.6e1 * t5047 * t1633;
  t5108 = my_piecewise5(t57, 0, t60, 0, t5104 - t5082 - t5077 + t5080 - 0.18e2 * t5062 + t5058 + t5009 + 0.18e2 * t4976 + 0.18e2 * t4964 + t4960 + 0.18e2 * t4962 - 0.6e1 * t4931 + 0.18e2 * t4933 - 0.18e2 * t4916 + 0.18e2 * t4918 + 0.18e2 * t4911 - 0.18e2 * t4907 + 0.4e1 * t1211 - 0.4e1 * t1205 - 0.4e1 * t1207 + 0.4e1 * t1203 - 0.4e1 * t1200 - 0.9e1 * t1171 + 0.4e1 * t1158 + 0.4e1 * t1154 + 0.4e1 * t1149 - t332 - t330 - 0.6e1 * t95 * t4925 * t1718 - 0.6e1 * t5047 * t1548 - 0.18e2 * t4969 * t1590 + 0.7e1 * t5028 * t1532 - 0.6e1 * t4926 * t1604 + 0.11e2 * t5025 * t1579 - 0.11e2 * t5028 * t1579 + 0.6e1 * t5025 * t1625 - 0.18e2 * t5028 * t1625 + 0.6e1 * t5031 * t1625 - 0.3e1 * t5018 * t200 + 0.18e2 * t4969 * t1718 - 0.6e1 * t4926 * t1718 + 0.18e2 * t4922 * t1763 + 0.18e2 * t4926 * t1758 + 0.3e1 * t95 * t5017 * t200);
  t5114 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (0.4e1 * t123 * t1215 + t52 * t5108));
  tv4sigma40 = 0.2e1 * rho[0] * t5114;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

  t5121 = t3691 * t126;
  t5122 = t193 * t5121;
  t5123 = t1011 * t5122;
  t5124 = 0.9e1 * t5123;
  t5125 = t103 * t5121;
  t5126 = t982 * t5125;
  t5127 = 0.3e1 * t5126;
  t5128 = t1011 * t5125;
  t5129 = 0.9e1 * t5128;
  t5130 = t988 * t5125;
  t5131 = 0.3e1 * t5130;
  t5132 = t145 * t1151;
  t5133 = t5132 * t207;
  t5134 = t183 * t5133;
  t5140 = t512 * t1151;
  t5141 = t5140 * t207;
  t5145 = t3698 * t1347;
  t5146 = t1011 * t5145;
  t5147 = 0.9e1 * t5146;
  t5151 = t5140 * t193 * t207;
  t5157 = t982 * t5145;
  t5158 = 0.9e1 * t5157;
  t5159 = -0.6e1 * t2283 * t103 * t5141 - 0.6e1 * t429 * t5133 * t1697 - 0.12e2 * t4263 * t439 * t5141 + 0.18e2 * t5134 * t1697 + 0.18e2 * t3687 * t2253 - 0.18e2 * t4263 * t5151 - t330 + t5124 - t5127 + t5129 - t5131 + t5147 - t5158;
  t5164 = t998 * t4080;
  t5165 = 0.9e1 * t5164;
  t5166 = t4083 * t1334;
  t5167 = 0.9e1 * t5166;
  t5168 = t1004 * t4092;
  t5169 = 0.9e1 * t5168;
  t5170 = t988 * t5122;
  t5171 = 0.9e1 * t5170;
  t5172 = t1004 * t4102;
  t5173 = 0.9e1 * t5172;
  t5175 = t988 * t439 * t5121;
  t5176 = 0.6e1 * t5175;
  t5187 = t1506 * t1151 * t190 * t192;
  t5190 = -0.18e2 * t2283 * t103 * t3750 + 0.18e2 * t5134 * t1710 + 0.18e2 * t3687 * t2267 + 0.18e2 * t2383 * t5151 + 0.18e2 * t2399 * t5187 - 0.9e1 * t4907 + 0.9e1 * t4911 - 0.9e1 * t4916 + t5165 + t5167 + t5169 - t5171 + t5173 - t5176;
  t5193 = t1516 * t1517 * t1151;
  t5202 = t1624 * t1151 * t67 * t102;
  t5210 = t1613 * t1614 * t1151;
  t5223 = 0.6e1 * t2293 * t5202 + t2293 * t5210 + 0.7e1 * t3761 * t2396 + 0.12e2 * t2399 * t5193 + 0.6e1 * t2399 * t5202 + 0.6e1 * t2399 * t5210 - 0.7e1 * t2412 * t5187 - 0.18e2 * t2412 * t5202 - 0.7e1 * t2412 * t5210 - 0.7e1 * t2422 * t5187 - t2422 * t5210 - 0.6e1 * t3761 * t2476 + 0.18e2 * t3761 * t2480;
  t5226 = t95 * t5132;
  t5230 = t1613 * t199 * t1151;
  t5235 = t183 * t5132;
  t5254 = -0.11e2 * t2412 * t1531 * t528 * t1151 - 0.12e2 * t5226 * t2027 - 0.3e1 * t5235 * t2032 + 0.3e1 * t5226 * t2072 - 0.3e1 * t5235 * t2072 + 0.11e2 * t2293 * t5230 - 0.6e1 * t2399 * t3882 - 0.11e2 * t2412 * t5230 - 0.12e2 * t2422 * t5193 - 0.12e2 * t3798 * t2476 + 0.9e1 * t4918 - 0.3e1 * t4931 + 0.9e1 * t4933 + 0.9e1 * t4936;
  t5266 = t606 * t4210;
  t5267 = 0.9e1 * t5266;
  t5268 = t580 * t4214;
  t5269 = 0.3e1 * t5268;
  t5278 = t730 * t511 * t1234 * t126;
  t5279 = 0.6e1 * t5278;
  t5286 = -0.6e1 * t2422 * t1498 * t1502 * t1151 - 0.18e2 * t183 * t3685 * t2407 - 0.6e1 * t429 * t3685 * t2498 + 0.7e1 * t3785 * t2441 - 0.18e2 * t3798 * t2441 + 0.11e2 * t3761 * t2463 - 0.6e1 * t3761 * t2473 - 0.9e1 * t4938 + 0.9e1 * t4940 - 0.9e1 * t4947 - t5267 - t5269 - t5279;
  t5293 = t4268 * t2031 * t3734;
  t5294 = 0.9e1 * t5293;
  t5295 = t962 * t3734;
  t5296 = t798 * t5295;
  t5297 = 0.9e1 * t5296;
  t5298 = -0.3e1 * t4952 - 0.6e1 * t4954 + 0.9e1 * t4962 + 0.9e1 * t4964 + 0.9e1 * t4976 - t356 + t1150 - t3917 + t1174 - t1383 + t1236 + t1237 - t5294 + t5297;
  t5300 = t4268 * t5295;
  t5301 = 0.9e1 * t5300;
  t5307 = -t5301 - t4995 + t4998 + t5000 - 0.4e1 * t1248 + 0.4e1 * t1253 - 0.4e1 * t1255 + 0.4e1 * t1266 + 0.4e1 * t1268 - t1198 - t1286 + t1291 - t1294;
  t5324 = 0.6e1 * t2293 * t1613 * t102 * t1151 + 0.3e1 * t5226 * t1662 + t3761 * t2309 + 0.11e2 * t3785 * t2330 + 0.6e1 * t3798 * t2336 + 0.3e1 * t3819 * t290 - t1206 + t1212 - 0.6e1 * t5041 - 0.3e1 * t5056 - 0.9e1 * t5062 - t5077 + t5080 - t5082;
  t5328 = my_piecewise5(t57, 0, t60, 0, t5159 + t5190 + t5223 + t5254 + t5286 + t5298 + t5307 + t5324);
  t5334 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (t45 * t137 * t1215 / 0.24e2 + 0.3e1 * t123 * t1301 + t52 * t5328));
  tv4sigma3lapl0 = 0.2e1 * rho[0] * t5334;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 0] += tv4sigma3tau0;

  t5342 = t103 * t324 * params->csk_a;
  t5349 = t3408 * t2851;
  t5352 = t3998 * t207;
  t5358 = t103 * t5352;
  t5366 = t1089 * t3698 * t468;
  t5372 = -0.12e2 * t3366 * t439 * t5352 + 0.18e2 * t3366 * t2611 + 0.18e2 * t3366 * t4906 - 0.18e2 * t3366 * t5349 - 0.6e1 * t3366 * t5358 - 0.6e1 * t3371 * t5358 + 0.18e2 * t3374 * t5349 + 0.18e2 * t3374 * t5358 + 0.18e2 * t3378 * t5342 - 0.18e2 * t4426 * t5342 - t330 - t383 + 0.12e2 * t5123 - 0.4e1 * t5126 - 0.3e1 * t5366;
  t5375 = t1094 * t4910;
  t5379 = t1089 * t193 * t3698 * t99;
  t5392 = t1506 * t1258;
  t5394 = -t3446 * t5392 - 0.3e1 * t4907 + 0.3e1 * t4911 - 0.3e1 * t4916 + 0.12e2 * t5128 - 0.4e1 * t5130 + 0.12e2 * t5146 - 0.12e2 * t5157 + 0.12e2 * t5164 + 0.12e2 * t5166 + 0.12e2 * t5168 - 0.12e2 * t5170 + 0.12e2 * t5172 - 0.8e1 * t5175 + 0.3e1 * t5375 - 0.3e1 * t5379;
  t5398 = t1613 * t4138;
  t5403 = t1506 * t1280;
  t5411 = t1516 * t1517 * t321;
  t5425 = t376 * t321;
  t5432 = t1613 * t1272;
  t5435 = 0.3e1 * t95 * t5425 * t2072 - 0.3e1 * t3468 * t215 * t2800 - 0.6e1 * t2727 * t3456 - 0.18e2 * t3441 * t2801 + 0.7e1 * t3452 * t2801 + 0.7e1 * t3446 * t2810 + 0.6e1 * t3441 * t5392 + 0.18e2 * t3441 * t5403 + 0.12e2 * t3441 * t5411 - 0.7e1 * t3446 * t5403 + t3450 * t5392 + 0.11e2 * t3450 * t5398 + 0.6e1 * t3450 * t5432 - 0.7e1 * t3452 * t5392 - 0.11e2 * t3452 * t5398 - 0.7e1 * t3452 * t5403;
  t5459 = t485 * t328 * t67 * t102;
  t5460 = t1081 * t5459;
  t5462 = t1084 * t5459;
  t5464 = t1102 * t2789;
  t5466 = t1084 * t4930;
  t5467 = t1081 * t4930;
  t5469 = t1102 * t4930;
  t5471 = t507 * t528 * t328;
  t5472 = t1081 * t5471;
  t5476 = t1112 * t198 * t1234 * t99;
  t5478 = 0.18e2 * t2727 * t1516 * t1075 * t512 - 0.12e2 * t1112 * t511 * t1239 * t186 - 0.6e1 * t3441 * t1516 * t1287 - 0.11e2 * t3452 * t2810 - 0.18e2 * t385 * t2852 + 0.6e1 * t3441 * t5432 - 0.18e2 * t3452 * t5432 - 0.3e1 * t3468 * t4139 + 0.3e1 * t5460 - 0.3e1 * t5462 + 0.3e1 * t5464 - t5466 + 0.3e1 * t5467 - t5469 + 0.3e1 * t5472 + 0.3e1 * t5476;
  t5485 = t1102 * t523 * t538 * t328;
  t5495 = t1099 * t2864;
  t5502 = t1102 * t2844;
  t5506 = t1102 * t5471;
  t5512 = -0.6e1 * t3446 * t1498 * t1502 * t321 + 0.11e2 * t2727 * t1498 * t3504 * t512 - 0.6e1 * t429 * t324 * t3573 - 0.6e1 * t2727 * t3506 - 0.12e2 * t3441 * t2750 - 0.12e2 * t3446 * t5411 + 0.3e1 * t4918 - t4931 + 0.3e1 * t4933 + 0.3e1 * t4936 - 0.12e2 * t5266 - 0.2e1 * t5485 + 0.3e1 * t5495 + 0.3e1 * t5502 - 0.3e1 * t5506;
  t5522 = -0.4e1 * t5268 - 0.8e1 * t5278 - 0.3e1 * t4938 + 0.3e1 * t4940 - 0.3e1 * t4947 - t4952 - 0.2e1 * t4954 + 0.3e1 * t4962 + 0.3e1 * t4964 + 0.3e1 * t4976 + t1228 - t1172 + t1230 - t4857 + t1314 + t1315;
  t5532 = -0.12e2 * t5293 + 0.12e2 * t5296 - 0.12e2 * t5300 - t4995 + t4998 + t5000 - 0.4e1 * t1324 - 0.4e1 * t1327 + 0.4e1 * t1331 + 0.4e1 * t1335 + 0.4e1 * t1361 - t1278 - t1367 + t1368 - t1369 - t1297;
  t5536 = t1084 * t511 * t1234;
  t5538 = t2732 * t1076;
  t5540 = t1081 * t2911;
  t5555 = 0.6e1 * t3450 * t1613 * t1239 + 0.3e1 * t3605 * t198 * t1239 + 0.3e1 * t183 * t5425 * t1666 + 0.6e1 * t2683 * t3613 + t2727 * t3631 + 0.11e2 * t3452 * t2917 + t1298 - 0.2e1 * t5041 - t5056 - 0.3e1 * t5062 - t5077 + t5080 - t5082 - 0.2e1 * t5536 - t5538 - 0.3e1 * t5540;
  t5559 = my_piecewise5(t57, 0, t60, 0, t5372 + t5394 + t5435 + t5478 + t5512 + t5522 + t5532 + t5555);
  t5565 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (t45 * t137 * t1301 / 0.12e2 + 0.2e1 * t123 * t1372 + t52 * t5559));
  tv4sigma2lapl20 = 0.2e1 * rho[0] * t5565;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 0] += tv4sigma2tau20;

  t5572 = t512 * t207 * t126;
  t5573 = t103 * t5572;
  t5583 = t3672 * t126;
  t5600 = 0.18e2 * t4672 * t983 * t1696 - 0.18e2 * t4675 * t193 * t5583 + 0.18e2 * t4686 * t193 * t5572 - 0.12e2 * t4675 * t439 * t5583 - 0.18e2 * t4683 * t1330 + 0.18e2 * t4680 * t1972 + 0.18e2 * t1982 * t4694 - 0.6e1 * t4680 * t5573 - 0.6e1 * t4683 * t5573 + 0.18e2 * t4686 * t5573 - t330 - t383 + t5124 - 0.9e1 * t5366;
  t5605 = -0.6e1 * t4745 * t2083 - t5127 + t5129 - t5131 + t5147 - t5158 + t5165 + t5167 + t5169 - t5171 + t5173 - t5176 + 0.9e1 * t5375 - 0.9e1 * t5379;
  t5609 = t1506 * t1353;
  t5613 = t1516 * t1517 * t126;
  t5619 = t1613 * t1614 * t126;
  t5626 = t1613 * t1340;
  t5637 = t1578 * t1347;
  t5640 = -0.18e2 * t4727 * t2060 - 0.12e2 * t4727 * t2083 + 0.7e1 * t4745 * t2186 + 0.18e2 * t4727 * t5609 + 0.12e2 * t4727 * t5613 + 0.6e1 * t4727 * t5619 - 0.7e1 * t4736 * t5609 - 0.7e1 * t4736 * t5619 - 0.18e2 * t4736 * t5626 - 0.11e2 * t4736 * t5637 + t4739 * t5619 + 0.6e1 * t4739 * t5626 - 0.7e1 * t4745 * t5609 - t4745 * t5619;
  t5653 = t1386 * t126;
  t5675 = -0.12e2 * t1392 * t511 * t1567 * t126 - 0.6e1 * t4745 * t1498 * t1502 * t126 + 0.3e1 * t95 * t5653 * t2072 + 0.18e2 * t2066 * t4836 + 0.11e2 * t2066 * t4847 - 0.6e1 * t4727 * t2086 - 0.6e1 * t4782 * t2117 - 0.6e1 * t4745 * t2182 - 0.11e2 * t4736 * t2186 - 0.3e1 * t4793 * t352 - 0.3e1 * t4793 * t362 + 0.6e1 * t4727 * t5626 + 0.11e2 * t4739 * t5637 - 0.12e2 * t4745 * t5613;
  t5694 = 0.7e1 * t2041 * t4777 - 0.18e2 * t263 * t4768 + 0.9e1 * t5460 - 0.9e1 * t5462 + 0.9e1 * t5464 - 0.3e1 * t5466 + 0.9e1 * t5467 - 0.3e1 * t5469 + 0.9e1 * t5472 + 0.9e1 * t5476 - 0.6e1 * t5485 + 0.9e1 * t5495 + 0.9e1 * t5502 - 0.9e1 * t5506;
  t5696 = -t5267 - t5269 - t5279 + t1149 - t1171 + t1173 - 0.8e1 * t1233 + t1384 + t1385 + t1394 + t1398 - t5294 + t5297 - t5301;
  t5698 = -t4995 + t4998 + t5000 - t1324 - t1327 + t1331 - t1428 + t1335 + t1431 - t1433 + t1361 - t1197 - t1434 + t1435;
  t5715 = 0.6e1 * t4739 * t1613 * t357 + 0.3e1 * t183 * t5653 * t1666 + 0.6e1 * t4727 * t1895 + 0.11e2 * t2041 * t4872 + t2066 * t4867 + 0.3e1 * t4877 * t358 - t1205 + t1211 - t1436 - t5077 + t5080 - t5082 - 0.6e1 * t5536 - 0.3e1 * t5538 - 0.9e1 * t5540;
  t5719 = my_piecewise5(t57, 0, t60, 0, t5600 + t5605 + t5640 + t5675 + t5694 + t5696 + t5698 + t5715);
  t5725 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (t45 * t137 * t1372 / 0.8e1 + t123 * t1439 + t52 * t5719));
  tv4sigmalapl30 = 0.2e1 * rho[0] * t5725;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmatau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 0] += tv4sigmatau30;

  t5733 = t376 * t376;
  t5734 = t5733 * t186;
  t5735 = t95 * t5734;
  t5738 = t183 * t5734;
  t5741 = t5733 * t207;
  t5745 = t429 * t5741;
  t5751 = t429 * t5734;
  t5768 = -0.6e1 * t5751 * t1718 - 0.12e2 * t5745 * t1738 + 0.18e2 * t5751 * t1750 + 0.18e2 * t5751 * t1758 + 0.18e2 * t5738 * t1770 + 0.18e2 * t5460 - 0.18e2 * t5462 + 0.18e2 * t5464 - 0.6e1 * t5466 + 0.18e2 * t5467 - 0.6e1 * t5469;
  t5784 = t183 * t5733;
  t5787 = t95 * t5733;
  t5798 = t1490 * t5733 * t1654 + 0.6e1 * t429 * t5733 * t1673 + 0.6e1 * t5787 * t1657 + 0.3e1 * t5787 * t1662 + 0.3e1 * t5784 * t1666 + 0.11e2 * t5784 * t1669 + 0.4e1 * t1397 - 0.4e1 * t1427 - t4995 + t4998 + t5000;
  t5810 = t5733 * t1492;
  t5811 = t1490 * t5810;
  t5816 = t429 * t5810;
  t5819 = t183 * t5810;
  t5834 = -0.6e1 * t5811 * t1503 - 0.7e1 * t5811 * t1507 + 0.11e2 * t5811 * t1511 - 0.12e2 * t5811 * t1518 + 0.18e2 * t5811 * t1523 + 0.7e1 * t5819 * t1532 + 0.7e1 * t5811 * t1535 - 0.11e2 * t5819 * t1579 - 0.18e2 * t5738 * t1590 - 0.12e2 * t5816 * t1633 - 0.18e2 * t5540;
  t5844 = t5733 * t1571;
  t5845 = t183 * t5844;
  t5855 = t95 * t5810;
  t5882 = 0.18e2 * t5816 * t1507 - 0.7e1 * t5819 * t1507 + 0.12e2 * t5816 * t1518 - 0.18e2 * t5816 * t1532 - t5811 * t1615 + 0.6e1 * t5816 * t1615 - 0.7e1 * t5819 * t1615 + t5855 * t1615 - 0.18e2 * t5819 * t1625 + 0.6e1 * t5855 * t1625 - 0.6e1 * t5811 * t1633;
  t5886 = my_piecewise5(t57, 0, t60, 0, t5882 + t5834 + t5798 + t5768 - 0.6e1 * t5538 - 0.12e2 * t5536 - 0.18e2 * t5506 + 0.18e2 * t5502 + 0.18e2 * t5495 - 0.12e2 * t5485 + 0.18e2 * t5476 + 0.18e2 * t5472 - 0.18e2 * t5379 + 0.18e2 * t5375 - 0.18e2 * t5366 - t5082 - t5077 + t5080 + 0.4e1 * t1430 - 0.4e1 * t1432 + 0.4e1 * t1393 - 0.4e1 * t1294 + 0.4e1 * t1291 - 0.4e1 * t1286 - 0.9e1 * t1233 + 0.4e1 * t1236 + 0.4e1 * t1237 - t383 - t330 - 0.6e1 * t5816 * t1523 - 0.3e1 * t5845 * t217 + 0.11e2 * t5855 * t1579 - 0.11e2 * t5819 * t1535 - 0.6e1 * t5811 * t1548 - 0.6e1 * t5751 * t1604 + 0.6e1 * t5816 * t1625 - 0.3e1 * t5845 * t200 - 0.18e2 * t5745 * t1763 - 0.18e2 * t5735 * t1714 - 0.6e1 * t5735 * t1718 + 0.18e2 * t5738 * t1718 + 0.18e2 * t183 * t5741 * t1710 + 0.3e1 * t95 * t5844 * t200 - 0.12e2 * t95 * t5741 * t1568);
  t5892 = my_piecewise3(t3, 0, 0.3e1 / 0.2e2 * t8 * t24 * (t45 * t137 * t1439 / 0.6e1 + t52 * t5886));
  tv4lapl40 = 0.2e1 * rho[0] * t5892;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 0] += tv4lapl40;

  tv4lapl3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapltau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 0] += tv4lapltau30;

  tv4tau40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 0] += tv4tau40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t40;
  double t41, t43, t46, t47, t48, t52, t53, t55;
  double t59, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75;
  double t76, t77, t79, t83, t84, t85, t87, t88;
  double t89, t90, t91, t93, t94, t95, t96, t97;
  double t99, t102, t103, t107, t109, t113, t114, t115;
  double t116, t117, t118, t119, t120, t121, t122, t123;
  double t124, t125, t127, t131, tzk0;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t20 = my_piecewise5(t12, t13, t16, t17, t18 * t9);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t33 * t37;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = 0.5e1 / 0.72e2 * t38 * sigma[0] * t43;
  t47 = params->csk_cp * t33;
  t48 = t37 * sigma[0];
  t52 = params->csk_cq * t33;
  t53 = t37 * lapl[0];
  t55 = 0.1e1 / t41 / rho[0];
  t59 = t47 * t48 * t43 / 0.24e2 + t52 * t53 * t55 / 0.24e2 - t46;
  t61 = log(0.1e1 - DBL_EPSILON);
  t62 = 0.1e1 / params->csk_a;
  t63 = pow(-t61, -t62);
  t64 = t59 < -t63;
  t65 = log(DBL_EPSILON);
  t66 = pow(-t65, -t62);
  t67 = -t66 < t59;
  t68 = my_piecewise3(t67, -t66, t59);
  t69 = -t63 < t68;
  t70 = my_piecewise3(t69, t68, -t63);
  t71 = fabs(t70);
  t72 = pow(t71, params->csk_a);
  t73 = 0.1e1 / t72;
  t74 = exp(-t73);
  t75 = 0.1e1 - t74;
  t76 = pow(t75, t62);
  t77 = my_piecewise5(t64, 0, t67, 1, t76);
  t79 = t59 * t77 + t46 + 0.1e1;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = -t18;
  t87 = my_piecewise5(t16, t13, t12, t17, t85 * t9);
  t88 = 0.1e1 + t87;
  t89 = t88 <= p->zeta_threshold;
  t90 = POW_1_3(t88);
  t91 = t90 * t90;
  t93 = my_piecewise3(t89, t25, t91 * t88);
  t94 = t93 * t31;
  t95 = rho[1] * rho[1];
  t96 = POW_1_3(rho[1]);
  t97 = t96 * t96;
  t99 = 0.1e1 / t97 / t95;
  t102 = 0.5e1 / 0.72e2 * t38 * sigma[2] * t99;
  t103 = t37 * sigma[2];
  t107 = t37 * lapl[1];
  t109 = 0.1e1 / t97 / rho[1];
  t113 = t47 * t103 * t99 / 0.24e2 + t52 * t107 * t109 / 0.24e2 - t102;
  t114 = t113 < -t63;
  t115 = -t66 < t113;
  t116 = my_piecewise3(t115, -t66, t113);
  t117 = -t63 < t116;
  t118 = my_piecewise3(t117, t116, -t63);
  t119 = fabs(t118);
  t120 = pow(t119, params->csk_a);
  t121 = 0.1e1 / t120;
  t122 = exp(-t121);
  t123 = 0.1e1 - t122;
  t124 = pow(t123, t62);
  t125 = my_piecewise5(t114, 0, t115, 1, t124);
  t127 = t113 * t125 + t102 + 0.1e1;
  t131 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t40;
  double t41, t43, t46, t47, t48, t52, t53, t55;
  double t59, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75;
  double t76, t77, t79, t83, t84, t85, t87, t88;
  double t89, t90, t91, t93, t94, t95, t96, t97;
  double t99, t102, t103, t107, t109, t113, t114, t115;
  double t116, t117, t118, t119, t120, t121, t122, t123;
  double t124, t125, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t148, t151, t154, t161, t163, t164, t165, t167;
  double t168, t170, t171, t172, t174, t176, t181, t182;
  double t184, t187, t188, t192, t195, t197, tvrho0, t201;
  double t204, t205, t210, t212, t215, t216, t222, t225;
  double t232, t234, t235, t236, t238, t239, t241, t242;
  double t243, t245, t247, t252, tvrho1, t256, t257, t260;
  double t262, t263, t266, t268, t272, tvsigma0, tvsigma1, t274;
  double t275, t278, t280, t281, t284, t286, t290, tvsigma2;
  double t291, t297, t298, t301, t303, t307, tvlapl0, t308;
  double t314, t315, t318, t320, t324, tvlapl1, tvtau0, tvtau1;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t20 = my_piecewise5(t12, t13, t16, t17, t18 * t9);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t33 * t37;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = 0.5e1 / 0.72e2 * t38 * sigma[0] * t43;
  t47 = params->csk_cp * t33;
  t48 = t37 * sigma[0];
  t52 = params->csk_cq * t33;
  t53 = t37 * lapl[0];
  t55 = 0.1e1 / t41 / rho[0];
  t59 = t47 * t48 * t43 / 0.24e2 + t52 * t53 * t55 / 0.24e2 - t46;
  t61 = log(0.1e1 - DBL_EPSILON);
  t62 = 0.1e1 / params->csk_a;
  t63 = pow(-t61, -t62);
  t64 = t59 < -t63;
  t65 = log(DBL_EPSILON);
  t66 = pow(-t65, -t62);
  t67 = -t66 < t59;
  t68 = my_piecewise3(t67, -t66, t59);
  t69 = -t63 < t68;
  t70 = my_piecewise3(t69, t68, -t63);
  t71 = fabs(t70);
  t72 = pow(t71, params->csk_a);
  t73 = 0.1e1 / t72;
  t74 = exp(-t73);
  t75 = 0.1e1 - t74;
  t76 = pow(t75, t62);
  t77 = my_piecewise5(t64, 0, t67, 1, t76);
  t79 = t59 * t77 + t46 + 0.1e1;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = -t18;
  t87 = my_piecewise5(t16, t13, t12, t17, t85 * t9);
  t88 = 0.1e1 + t87;
  t89 = t88 <= p->zeta_threshold;
  t90 = POW_1_3(t88);
  t91 = t90 * t90;
  t93 = my_piecewise3(t89, t25, t91 * t88);
  t94 = t93 * t31;
  t95 = rho[1] * rho[1];
  t96 = POW_1_3(rho[1]);
  t97 = t96 * t96;
  t99 = 0.1e1 / t97 / t95;
  t102 = 0.5e1 / 0.72e2 * t38 * sigma[2] * t99;
  t103 = t37 * sigma[2];
  t107 = t37 * lapl[1];
  t109 = 0.1e1 / t97 / rho[1];
  t113 = t47 * t103 * t99 / 0.24e2 + t52 * t107 * t109 / 0.24e2 - t102;
  t114 = t113 < -t63;
  t115 = -t66 < t113;
  t116 = my_piecewise3(t115, -t66, t113);
  t117 = -t63 < t116;
  t118 = my_piecewise3(t117, t116, -t63);
  t119 = fabs(t118);
  t120 = pow(t119, params->csk_a);
  t121 = 0.1e1 / t120;
  t122 = exp(-t121);
  t123 = 0.1e1 - t122;
  t124 = pow(t123, t62);
  t125 = my_piecewise5(t114, 0, t115, 1, t124);
  t127 = t113 * t125 + t102 + 0.1e1;
  t131 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t132 = t8 * t8;
  t133 = 0.1e1 / t132;
  t134 = t18 * t133;
  t136 = my_piecewise5(t12, 0, t16, 0, t9 - t134);
  t139 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t136);
  t140 = t139 * t31;
  t144 = 0.1e1 / t30;
  t145 = t29 * t144;
  t148 = t7 * t145 * t79 / 0.1e2;
  t151 = 0.1e1 / t41 / t39 / rho[0];
  t154 = 0.5e1 / 0.27e2 * t38 * sigma[0] * t151;
  t161 = -t47 * t48 * t151 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t53 * t43 + t154;
  t163 = t76 * t73;
  t164 = my_piecewise3(t67, 0, t161);
  t165 = my_piecewise3(t69, t164, 0);
  t167 = fabs(t70) / t70;
  t168 = 0.1e1 / t71;
  t170 = 0.1e1 / t75;
  t171 = t74 * t170;
  t172 = t167 * t168 * t171;
  t174 = my_piecewise5(t64, 0, t67, 0, -t163 * t165 * t172);
  t176 = t161 * t77 + t174 * t59 - t154;
  t181 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t79 + t148 + 0.3e1 / 0.2e2 * t7 * t32 * t176);
  t182 = t85 * t133;
  t184 = my_piecewise5(t16, 0, t12, 0, -t9 - t182);
  t187 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t184);
  t188 = t187 * t31;
  t192 = t93 * t144;
  t195 = t7 * t192 * t127 / 0.1e2;
  t197 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t127 + t195);
  tvrho0 = t83 + t131 + t8 * (t181 + t197);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t201 = my_piecewise5(t12, 0, t16, 0, -t9 - t134);
  t204 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t201);
  t205 = t204 * t31;
  t210 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t79 + t148);
  t212 = my_piecewise5(t16, 0, t12, 0, t9 - t182);
  t215 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t212);
  t216 = t215 * t31;
  t222 = 0.1e1 / t97 / t95 / rho[1];
  t225 = 0.5e1 / 0.27e2 * t38 * sigma[2] * t222;
  t232 = -t47 * t103 * t222 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t107 * t99 + t225;
  t234 = t124 * t121;
  t235 = my_piecewise3(t115, 0, t232);
  t236 = my_piecewise3(t117, t235, 0);
  t238 = fabs(t118) / t118;
  t239 = 0.1e1 / t119;
  t241 = 0.1e1 / t123;
  t242 = t122 * t241;
  t243 = t238 * t239 * t242;
  t245 = my_piecewise5(t114, 0, t115, 0, -t234 * t236 * t243);
  t247 = t113 * t245 + t125 * t232 - t225;
  t252 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t127 + t195 + 0.3e1 / 0.2e2 * t7 * t94 * t247);
  tvrho1 = t83 + t131 + t8 * (t210 + t252);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t256 = 0.5e1 / 0.72e2 * t38 * t43;
  t257 = t37 * t43;
  t260 = t47 * t257 / 0.24e2 - t256;
  t262 = my_piecewise3(t67, 0, t260);
  t263 = my_piecewise3(t69, t262, 0);
  t266 = my_piecewise5(t64, 0, t67, 0, -t163 * t263 * t172);
  t268 = t260 * t77 + t266 * t59 + t256;
  t272 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t268);
  tvsigma0 = t8 * t272;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t274 = 0.5e1 / 0.72e2 * t38 * t99;
  t275 = t37 * t99;
  t278 = t47 * t275 / 0.24e2 - t274;
  t280 = my_piecewise3(t115, 0, t278);
  t281 = my_piecewise3(t117, t280, 0);
  t284 = my_piecewise5(t114, 0, t115, 0, -t234 * t281 * t243);
  t286 = t113 * t284 + t125 * t278 + t274;
  t290 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t286);
  tvsigma2 = t8 * t290;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t291 = t37 * t55;
  t297 = my_piecewise3(t67, 0, t52 * t291 / 0.24e2);
  t298 = my_piecewise3(t69, t297, 0);
  t301 = my_piecewise5(t64, 0, t67, 0, -t163 * t298 * t172);
  t303 = t52 * t291 * t77 / 0.24e2 + t59 * t301;
  t307 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t303);
  tvlapl0 = t8 * t307;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t308 = t37 * t109;
  t314 = my_piecewise3(t115, 0, t52 * t308 / 0.24e2);
  t315 = my_piecewise3(t117, t314, 0);
  t318 = my_piecewise5(t114, 0, t115, 0, -t234 * t315 * t243);
  t320 = t52 * t308 * t125 / 0.24e2 + t113 * t318;
  t324 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t320);
  tvlapl1 = t8 * t324;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t40;
  double t41, t43, t46, t47, t48, t52, t53, t55;
  double t59, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75;
  double t76, t77, t79, t83, t84, t85, t87, t88;
  double t89, t90, t91, t93, t94, t95, t96, t97;
  double t99, t102, t103, t107, t109, t113, t114, t115;
  double t116, t117, t118, t119, t120, t121, t122, t123;
  double t124, t125, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t148, t151, t154, t161, t163, t164, t165, t167;
  double t168, t170, t171, t172, t174, t176, t181, t182;
  double t184, t187, t188, t192, t195, t197, tvrho0, t201;
  double t204, t205, t210, t212, t215, t216, t222, t225;
  double t232, t234, t235, t236, t238, t239, t241, t242;
  double t243, t245, t247, t252, tvrho1, t256, t257, t260;
  double t262, t263, t266, t268, t272, tvsigma0, tvsigma1, t274;
  double t275, t278, t280, t281, t284, t286, t290, tvsigma2;
  double t291, t297, t298, t301, t303, t307, tvlapl0, t308;
  double t314, t315, t318, t320, t324, tvlapl1, tvtau0, tvtau1;

  double t327, t328, t331, t332, t333, t336, t340, t341;
  double t345, t347, t353, t354, t357, t359, t361, t363;
  double t366, t373, t377, t379, t380, t382, t383, t384;
  double t385, t386, t387, t388, t389, t390, t392, t394;
  double t395, t396, t398, t399, t402, t403, t405, t406;
  double t407, t409, t411, t412, t413, t416, t418, t423;
  double t424, t425, t428, t431, t435, t436, t440, t442;
  double t444, t447, t449, tv2rho20, t452, t456, t460, t461;
  double t465, t467, t475, t476, t480, t484, t485, t489;
  double t491, t498, t501, tv2rho21, t506, t511, t515, t516;
  double t522, t523, t528, t532, t533, t542, t544, t547;
  double t554, t558, t560, t561, t563, t564, t565, t566;
  double t567, t568, t569, t570, t571, t573, t575, t576;
  double t577, t579, t580, t583, t584, t586, t587, t588;
  double t590, t592, t593, t594, t597, t599, t604, tv2rho22;
  double t612, t614, t615, t618, t622, t623, t624, t625;
  double t627, t628, t629, t630, t632, t633, t636, t638;
  double t639, t640, t642, t644, t645, t648, t650, t655;
  double tv2rhosigma0, tv2rhosigma1, t662, t664, tv2rhosigma2, t670, tv2rhosigma3, tv2rhosigma4;
  double t676, t677, t680, t684, t685, t686, t687, t689;
  double t690, t692, t694, t695, t698, t700, t701, t702;
  double t704, t706, t707, t710, t712, t717, tv2rhosigma5, t724;
  double t732, t733, t735, t736, t740, t741, t744, t746;
  double t748, t752, t754, t759, tv2rholapl0, t766, t768, tv2rholapl1;
  double t774, tv2rholapl2, t786, t787, t789, t790, t794, t795;
  double t798, t800, t802, t806, t808, t813, tv2rholapl3, tv2rhotau0;
  double tv2rhotau1, tv2rhotau2, tv2rhotau3, t817, t820, t823, t824, t826;
  double t827, t828, t830, t834, t836, t840, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t843, t846, t849, t850, t852;
  double t853, t854, t856, t860, t862, t866, tv2sigma25, t872;
  double t873, t875, t876, t877, t878, t879, t882, t883;
  double t886, t888, t892, tv2sigmalapl0, tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4;
  double t898, t899, t901, t902, t903, t904, t905, t908;
  double t909, t912, t914, t918, tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2;
  double tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t922, t925, t926, t928, t929;
  double t931, t935, t937, t941, tv2lapl20, tv2lapl21, t945, t948;
  double t949, t951, t952, t954, t958, t960, t964, tv2lapl22;
  double tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21, tv2tau22;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t20 = my_piecewise5(t12, t13, t16, t17, t18 * t9);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t33 * t37;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = 0.5e1 / 0.72e2 * t38 * sigma[0] * t43;
  t47 = params->csk_cp * t33;
  t48 = t37 * sigma[0];
  t52 = params->csk_cq * t33;
  t53 = t37 * lapl[0];
  t55 = 0.1e1 / t41 / rho[0];
  t59 = t47 * t48 * t43 / 0.24e2 + t52 * t53 * t55 / 0.24e2 - t46;
  t61 = log(0.1e1 - DBL_EPSILON);
  t62 = 0.1e1 / params->csk_a;
  t63 = pow(-t61, -t62);
  t64 = t59 < -t63;
  t65 = log(DBL_EPSILON);
  t66 = pow(-t65, -t62);
  t67 = -t66 < t59;
  t68 = my_piecewise3(t67, -t66, t59);
  t69 = -t63 < t68;
  t70 = my_piecewise3(t69, t68, -t63);
  t71 = fabs(t70);
  t72 = pow(t71, params->csk_a);
  t73 = 0.1e1 / t72;
  t74 = exp(-t73);
  t75 = 0.1e1 - t74;
  t76 = pow(t75, t62);
  t77 = my_piecewise5(t64, 0, t67, 1, t76);
  t79 = t59 * t77 + t46 + 0.1e1;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = -t18;
  t87 = my_piecewise5(t16, t13, t12, t17, t85 * t9);
  t88 = 0.1e1 + t87;
  t89 = t88 <= p->zeta_threshold;
  t90 = POW_1_3(t88);
  t91 = t90 * t90;
  t93 = my_piecewise3(t89, t25, t91 * t88);
  t94 = t93 * t31;
  t95 = rho[1] * rho[1];
  t96 = POW_1_3(rho[1]);
  t97 = t96 * t96;
  t99 = 0.1e1 / t97 / t95;
  t102 = 0.5e1 / 0.72e2 * t38 * sigma[2] * t99;
  t103 = t37 * sigma[2];
  t107 = t37 * lapl[1];
  t109 = 0.1e1 / t97 / rho[1];
  t113 = t47 * t103 * t99 / 0.24e2 + t52 * t107 * t109 / 0.24e2 - t102;
  t114 = t113 < -t63;
  t115 = -t66 < t113;
  t116 = my_piecewise3(t115, -t66, t113);
  t117 = -t63 < t116;
  t118 = my_piecewise3(t117, t116, -t63);
  t119 = fabs(t118);
  t120 = pow(t119, params->csk_a);
  t121 = 0.1e1 / t120;
  t122 = exp(-t121);
  t123 = 0.1e1 - t122;
  t124 = pow(t123, t62);
  t125 = my_piecewise5(t114, 0, t115, 1, t124);
  t127 = t113 * t125 + t102 + 0.1e1;
  t131 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t132 = t8 * t8;
  t133 = 0.1e1 / t132;
  t134 = t18 * t133;
  t136 = my_piecewise5(t12, 0, t16, 0, t9 - t134);
  t139 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t136);
  t140 = t139 * t31;
  t144 = 0.1e1 / t30;
  t145 = t29 * t144;
  t148 = t7 * t145 * t79 / 0.1e2;
  t151 = 0.1e1 / t41 / t39 / rho[0];
  t154 = 0.5e1 / 0.27e2 * t38 * sigma[0] * t151;
  t161 = -t47 * t48 * t151 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t53 * t43 + t154;
  t163 = t76 * t73;
  t164 = my_piecewise3(t67, 0, t161);
  t165 = my_piecewise3(t69, t164, 0);
  t167 = fabs(t70) / t70;
  t168 = 0.1e1 / t71;
  t170 = 0.1e1 / t75;
  t171 = t74 * t170;
  t172 = t167 * t168 * t171;
  t174 = my_piecewise5(t64, 0, t67, 0, -t163 * t165 * t172);
  t176 = t161 * t77 + t174 * t59 - t154;
  t181 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t79 + t148 + 0.3e1 / 0.2e2 * t7 * t32 * t176);
  t182 = t85 * t133;
  t184 = my_piecewise5(t16, 0, t12, 0, -t9 - t182);
  t187 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t184);
  t188 = t187 * t31;
  t192 = t93 * t144;
  t195 = t7 * t192 * t127 / 0.1e2;
  t197 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t127 + t195);
  tvrho0 = t83 + t131 + t8 * (t181 + t197);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t201 = my_piecewise5(t12, 0, t16, 0, -t9 - t134);
  t204 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t201);
  t205 = t204 * t31;
  t210 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t79 + t148);
  t212 = my_piecewise5(t16, 0, t12, 0, t9 - t182);
  t215 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t212);
  t216 = t215 * t31;
  t222 = 0.1e1 / t97 / t95 / rho[1];
  t225 = 0.5e1 / 0.27e2 * t38 * sigma[2] * t222;
  t232 = -t47 * t103 * t222 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t107 * t99 + t225;
  t234 = t124 * t121;
  t235 = my_piecewise3(t115, 0, t232);
  t236 = my_piecewise3(t117, t235, 0);
  t238 = fabs(t118) / t118;
  t239 = 0.1e1 / t119;
  t241 = 0.1e1 / t123;
  t242 = t122 * t241;
  t243 = t238 * t239 * t242;
  t245 = my_piecewise5(t114, 0, t115, 0, -t234 * t236 * t243);
  t247 = t113 * t245 + t125 * t232 - t225;
  t252 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t127 + t195 + 0.3e1 / 0.2e2 * t7 * t94 * t247);
  tvrho1 = t83 + t131 + t8 * (t210 + t252);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t256 = 0.5e1 / 0.72e2 * t38 * t43;
  t257 = t37 * t43;
  t260 = t47 * t257 / 0.24e2 - t256;
  t262 = my_piecewise3(t67, 0, t260);
  t263 = my_piecewise3(t69, t262, 0);
  t266 = my_piecewise5(t64, 0, t67, 0, -t163 * t263 * t172);
  t268 = t260 * t77 + t266 * t59 + t256;
  t272 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t268);
  tvsigma0 = t8 * t272;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t274 = 0.5e1 / 0.72e2 * t38 * t99;
  t275 = t37 * t99;
  t278 = t47 * t275 / 0.24e2 - t274;
  t280 = my_piecewise3(t115, 0, t278);
  t281 = my_piecewise3(t117, t280, 0);
  t284 = my_piecewise5(t114, 0, t115, 0, -t234 * t281 * t243);
  t286 = t113 * t284 + t125 * t278 + t274;
  t290 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t286);
  tvsigma2 = t8 * t290;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t291 = t37 * t55;
  t297 = my_piecewise3(t67, 0, t52 * t291 / 0.24e2);
  t298 = my_piecewise3(t69, t297, 0);
  t301 = my_piecewise5(t64, 0, t67, 0, -t163 * t298 * t172);
  t303 = t52 * t291 * t77 / 0.24e2 + t59 * t301;
  t307 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t303);
  tvlapl0 = t8 * t307;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t308 = t37 * t109;
  t314 = my_piecewise3(t115, 0, t52 * t308 / 0.24e2);
  t315 = my_piecewise3(t117, t314, 0);
  t318 = my_piecewise5(t114, 0, t115, 0, -t234 * t315 * t243);
  t320 = t52 * t308 * t125 / 0.24e2 + t113 * t318;
  t324 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t320);
  tvlapl1 = t8 * t324;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t327 = 0.1e1 / t26;
  t328 = t136 * t136;
  t331 = t132 * t8;
  t332 = 0.1e1 / t331;
  t333 = t18 * t332;
  t336 = my_piecewise5(t12, 0, t16, 0, -0.2e1 * t133 + 0.2e1 * t333);
  t340 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t328 + 0.5e1 / 0.3e1 * t27 * t336);
  t341 = t340 * t31;
  t345 = t139 * t144;
  t347 = t7 * t345 * t79;
  t353 = 0.1e1 / t30 / t8;
  t354 = t29 * t353;
  t357 = t7 * t354 * t79 / 0.3e2;
  t359 = t7 * t145 * t176;
  t361 = t39 * t39;
  t363 = 0.1e1 / t41 / t361;
  t366 = 0.55e2 / 0.81e2 * t38 * sigma[0] * t363;
  t373 = 0.11e2 / 0.27e2 * t47 * t48 * t363 + 0.5e1 / 0.27e2 * t52 * t53 * t151 - t366;
  t377 = t72 * t72;
  t379 = t76 / t377;
  t380 = t165 * t165;
  t382 = t167 * t167;
  t383 = t71 * t71;
  t384 = 0.1e1 / t383;
  t385 = t382 * t384;
  t386 = t74 * t74;
  t387 = t75 * t75;
  t388 = 0.1e1 / t387;
  t389 = t386 * t388;
  t390 = t385 * t389;
  t392 = t380 * t382;
  t394 = t384 * t74;
  t395 = t170 * params->csk_a;
  t396 = t394 * t395;
  t398 = my_piecewise3(t67, 0, t373);
  t399 = my_piecewise3(t69, t398, 0);
  t402 = t163 * t380;
  t403 = 0.0;
  t405 = t403 * t168 * t171;
  t406 = t402 * t405;
  t407 = t385 * t171;
  t409 = t379 * t392;
  t411 = t384 * t386;
  t412 = t388 * params->csk_a;
  t413 = t411 * t412;
  t416 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t399 + t163 * t392 * t396 + t379 * t380 * t390 - t396 * t409 + t402 * t407 - t409 * t413 - t406);
  t418 = 0.2e1 * t161 * t174 + t373 * t77 + t416 * t59 + t366;
  t423 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t79 + t347 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t176 - t357 + t359 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t418);
  t424 = 0.1e1 / t90;
  t425 = t184 * t184;
  t428 = t85 * t332;
  t431 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t133 + 0.2e1 * t428);
  t435 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t425 + 0.5e1 / 0.3e1 * t91 * t431);
  t436 = t435 * t31;
  t440 = t187 * t144;
  t442 = t7 * t440 * t127;
  t444 = t93 * t353;
  t447 = t7 * t444 * t127 / 0.3e2;
  t449 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t127 + t442 / 0.5e1 - t447);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t197 + t8 * (t423 + t449);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t452 = t327 * t201;
  t456 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t333);
  t460 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t452 * t136 + 0.5e1 / 0.3e1 * t27 * t456);
  t461 = t460 * t31;
  t465 = t204 * t144;
  t467 = t7 * t465 * t79;
  t475 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t79 + t467 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t176 + t347 / 0.1e2 - t357 + t359 / 0.1e2);
  t476 = t424 * t212;
  t480 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t428);
  t484 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t476 * t184 + 0.5e1 / 0.3e1 * t91 * t480);
  t485 = t484 * t31;
  t489 = t215 * t144;
  t491 = t7 * t489 * t127;
  t498 = t7 * t192 * t247;
  t501 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t127 + t491 / 0.1e2 + t442 / 0.1e2 - t447 + 0.3e1 / 0.2e2 * t7 * t188 * t247 + t498 / 0.1e2);
  tv2rho21 = t181 + t197 + t210 + t252 + t8 * (t475 + t501);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t506 = t201 * t201;
  t511 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t133 + 0.2e1 * t333);
  t515 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t506 + 0.5e1 / 0.3e1 * t27 * t511);
  t516 = t515 * t31;
  t522 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t79 + t467 / 0.5e1 - t357);
  t523 = t212 * t212;
  t528 = my_piecewise5(t16, 0, t12, 0, -0.2e1 * t133 + 0.2e1 * t428);
  t532 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t523 + 0.5e1 / 0.3e1 * t91 * t528);
  t533 = t532 * t31;
  t542 = t95 * t95;
  t544 = 0.1e1 / t97 / t542;
  t547 = 0.55e2 / 0.81e2 * t38 * sigma[2] * t544;
  t554 = 0.11e2 / 0.27e2 * t47 * t103 * t544 + 0.5e1 / 0.27e2 * t52 * t107 * t222 - t547;
  t558 = t120 * t120;
  t560 = t124 / t558;
  t561 = t236 * t236;
  t563 = t238 * t238;
  t564 = t119 * t119;
  t565 = 0.1e1 / t564;
  t566 = t563 * t565;
  t567 = t122 * t122;
  t568 = t123 * t123;
  t569 = 0.1e1 / t568;
  t570 = t567 * t569;
  t571 = t566 * t570;
  t573 = t561 * t563;
  t575 = t565 * t122;
  t576 = t241 * params->csk_a;
  t577 = t575 * t576;
  t579 = my_piecewise3(t115, 0, t554);
  t580 = my_piecewise3(t117, t579, 0);
  t583 = t234 * t561;
  t584 = 0.0;
  t586 = t584 * t239 * t242;
  t587 = t583 * t586;
  t588 = t566 * t242;
  t590 = t560 * t573;
  t592 = t565 * t567;
  t593 = t569 * params->csk_a;
  t594 = t592 * t593;
  t597 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t580 + t234 * t573 * t577 + t560 * t561 * t571 - t577 * t590 + t583 * t588 - t590 * t594 - t587);
  t599 = t113 * t597 + t125 * t554 + 0.2e1 * t232 * t245 + t547;
  t604 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t127 + t491 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t247 - t447 + t498 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t599);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t252 + t8 * (t522 + t604);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t612 = t7 * t145 * t268 / 0.1e2;
  t614 = 0.5e1 / 0.27e2 * t38 * t151;
  t615 = t37 * t151;
  t618 = -t47 * t615 / 0.9e1 + t614;
  t622 = t165 * t382;
  t623 = t379 * t622;
  t624 = t388 * t263;
  t625 = t411 * t624;
  t627 = t263 * t382;
  t628 = t163 * t627;
  t629 = t395 * t165;
  t630 = t394 * t629;
  t632 = my_piecewise3(t67, 0, t618);
  t633 = my_piecewise3(t69, t632, 0);
  t636 = t263 * t165;
  t638 = t163 * t636 * t405;
  t639 = t170 * t165;
  t640 = t394 * t639;
  t642 = t379 * t627;
  t644 = t412 * t165;
  t645 = t411 * t644;
  t648 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t633 + t623 * t625 + t628 * t630 + t628 * t640 - t630 * t642 - t642 * t645 - t638);
  t650 = t161 * t266 + t174 * t260 + t59 * t648 + t618 * t77 - t614;
  t655 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t268 + t612 + 0.3e1 / 0.2e2 * t7 * t32 * t650);
  tv2rhosigma0 = t655 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t662 = t7 * t192 * t286 / 0.1e2;
  t664 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t286 + t662);
  tv2rhosigma2 = t664 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t670 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t268 + t612);
  tv2rhosigma3 = t670 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t676 = 0.5e1 / 0.27e2 * t38 * t222;
  t677 = t37 * t222;
  t680 = -t47 * t677 / 0.9e1 + t676;
  t684 = t236 * t563;
  t685 = t560 * t684;
  t686 = t569 * t281;
  t687 = t592 * t686;
  t689 = t281 * t563;
  t690 = t234 * t689;
  t692 = t575 * t576 * t236;
  t694 = my_piecewise3(t115, 0, t680);
  t695 = my_piecewise3(t117, t694, 0);
  t698 = t281 * t236;
  t700 = t234 * t698 * t586;
  t701 = t241 * t236;
  t702 = t575 * t701;
  t704 = t560 * t689;
  t706 = t593 * t236;
  t707 = t592 * t706;
  t710 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t695 + t685 * t687 + t690 * t692 + t690 * t702 - t692 * t704 - t704 * t707 - t700);
  t712 = t113 * t710 + t125 * t680 + t232 * t284 + t245 * t278 - t676;
  t717 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t286 + t662 + 0.3e1 / 0.2e2 * t7 * t94 * t712);
  tv2rhosigma5 = t717 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t724 = t7 * t145 * t303 / 0.1e2;
  t732 = t388 * t298;
  t733 = t411 * t732;
  t735 = t298 * t382;
  t736 = t163 * t735;
  t740 = my_piecewise3(t67, 0, -0.5e1 / 0.72e2 * t52 * t257);
  t741 = my_piecewise3(t69, t740, 0);
  t744 = t298 * t165;
  t746 = t163 * t744 * t405;
  t748 = t379 * t735;
  t752 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t741 + t623 * t733 + t630 * t736 - t630 * t748 + t640 * t736 - t645 * t748 - t746);
  t754 = -0.5e1 / 0.72e2 * t52 * t257 * t77 + t52 * t291 * t174 / 0.24e2 + t161 * t301 + t59 * t752;
  t759 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t303 + t724 + 0.3e1 / 0.2e2 * t7 * t32 * t754);
  tv2rholapl0 = t759 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t766 = t7 * t192 * t320 / 0.1e2;
  t768 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t320 + t766);
  tv2rholapl1 = t768 * t8 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  t774 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t303 + t724);
  tv2rholapl2 = t774 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  t786 = t569 * t315;
  t787 = t592 * t786;
  t789 = t315 * t563;
  t790 = t234 * t789;
  t794 = my_piecewise3(t115, 0, -0.5e1 / 0.72e2 * t52 * t275);
  t795 = my_piecewise3(t117, t794, 0);
  t798 = t315 * t236;
  t800 = t234 * t798 * t586;
  t802 = t560 * t789;
  t806 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t795 + t685 * t787 + t692 * t790 - t692 * t802 + t702 * t790 - t707 * t802 - t800);
  t808 = -0.5e1 / 0.72e2 * t52 * t275 * t125 + t52 * t308 * t245 / 0.24e2 + t232 * t318 + t113 * t806;
  t813 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t320 + t766 + 0.3e1 / 0.2e2 * t7 * t94 * t808);
  tv2rholapl3 = t8 * t813 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t817 = t263 * t263;
  t820 = t817 * t382;
  t823 = my_piecewise3(t67, 0, 0);
  t824 = my_piecewise3(t69, t823, 0);
  t826 = t163 * t824 * t172;
  t827 = t163 * t817;
  t828 = t827 * t405;
  t830 = t379 * t820;
  t834 = my_piecewise5(t64, 0, t67, 0, t163 * t396 * t820 + t379 * t390 * t817 - t396 * t830 + t407 * t827 - t413 * t830 - t826 - t828);
  t836 = 0.2e1 * t260 * t266 + t59 * t834;
  t840 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t836);
  tv2sigma20 = t8 * t840;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t843 = t281 * t281;
  t846 = t843 * t563;
  t849 = my_piecewise3(t115, 0, 0);
  t850 = my_piecewise3(t117, t849, 0);
  t852 = t234 * t850 * t243;
  t853 = t234 * t843;
  t854 = t853 * t586;
  t856 = t560 * t846;
  t860 = my_piecewise5(t114, 0, t115, 0, t234 * t577 * t846 + t560 * t571 * t843 - t577 * t856 + t588 * t853 - t594 * t856 - t852 - t854);
  t862 = t113 * t860 + 0.2e1 * t278 * t284;
  t866 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t862);
  tv2sigma25 = t8 * t866;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t872 = t395 * t263;
  t873 = t394 * t872;
  t875 = t298 * t263;
  t876 = t163 * t875;
  t877 = t876 * t405;
  t878 = t170 * t263;
  t879 = t394 * t878;
  t882 = t412 * t263;
  t883 = t411 * t882;
  t886 = my_piecewise5(t64, 0, t67, 0, t642 * t733 + t736 * t873 + t736 * t879 - t748 * t873 - t748 * t883 - t826 - t877);
  t888 = t52 * t291 * t266 / 0.24e2 + t260 * t301 + t59 * t886;
  t892 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t888);
  tv2sigmalapl0 = t8 * t892;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  t898 = t576 * t281;
  t899 = t575 * t898;
  t901 = t315 * t281;
  t902 = t234 * t901;
  t903 = t902 * t586;
  t904 = t241 * t281;
  t905 = t575 * t904;
  t908 = t593 * t281;
  t909 = t592 * t908;
  t912 = my_piecewise5(t114, 0, t115, 0, t704 * t787 + t790 * t899 + t790 * t905 - t802 * t899 - t802 * t909 - t852 - t903);
  t914 = t52 * t308 * t284 / 0.24e2 + t278 * t318 + t113 * t912;
  t918 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t914);
  tv2sigmalapl5 = t8 * t918;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t922 = t298 * t298;
  t925 = t922 * t382;
  t926 = t163 * t925;
  t928 = t163 * t922;
  t929 = t928 * t405;
  t931 = t379 * t925;
  t935 = my_piecewise5(t64, 0, t67, 0, t379 * t390 * t922 + t396 * t926 - t396 * t931 + t407 * t928 - t413 * t931 - t826 - t929);
  t937 = t52 * t291 * t301 / 0.12e2 + t59 * t935;
  t941 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t937);
  tv2lapl20 = t8 * t941;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  t945 = t315 * t315;
  t948 = t945 * t563;
  t949 = t234 * t948;
  t951 = t234 * t945;
  t952 = t951 * t586;
  t954 = t560 * t948;
  t958 = my_piecewise5(t114, 0, t115, 0, t560 * t571 * t945 + t577 * t949 - t577 * t954 + t588 * t951 - t594 * t954 - t852 - t952);
  t960 = t52 * t308 * t318 / 0.12e2 + t113 * t958;
  t964 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t960);
  tv2lapl22 = t8 * t964;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t40;
  double t41, t43, t46, t47, t48, t52, t53, t55;
  double t59, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75;
  double t76, t77, t79, t83, t84, t85, t87, t88;
  double t89, t90, t91, t93, t94, t95, t96, t97;
  double t99, t102, t103, t107, t109, t113, t114, t115;
  double t116, t117, t118, t119, t120, t121, t122, t123;
  double t124, t125, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t148, t151, t154, t161, t163, t164, t165, t167;
  double t168, t170, t171, t172, t174, t176, t181, t182;
  double t184, t187, t188, t192, t195, t197, tvrho0, t201;
  double t204, t205, t210, t212, t215, t216, t222, t225;
  double t232, t234, t235, t236, t238, t239, t241, t242;
  double t243, t245, t247, t252, tvrho1, t256, t257, t260;
  double t262, t263, t266, t268, t272, tvsigma0, tvsigma1, t274;
  double t275, t278, t280, t281, t284, t286, t290, tvsigma2;
  double t291, t297, t298, t301, t303, t307, tvlapl0, t308;
  double t314, t315, t318, t320, t324, tvlapl1, tvtau0, tvtau1;

  double t327, t328, t331, t332, t333, t336, t340, t341;
  double t345, t347, t353, t354, t357, t359, t361, t363;
  double t366, t373, t377, t379, t380, t382, t383, t384;
  double t385, t386, t387, t388, t389, t390, t392, t394;
  double t395, t396, t398, t399, t402, t403, t405, t406;
  double t407, t409, t411, t412, t413, t416, t418, t423;
  double t424, t425, t428, t431, t435, t436, t440, t442;
  double t444, t447, t449, tv2rho20, t452, t456, t460, t461;
  double t465, t467, t475, t476, t480, t484, t485, t489;
  double t491, t498, t501, tv2rho21, t506, t511, t515, t516;
  double t522, t523, t528, t532, t533, t542, t544, t547;
  double t554, t558, t560, t561, t563, t564, t565, t566;
  double t567, t568, t569, t570, t571, t573, t575, t576;
  double t577, t579, t580, t583, t584, t586, t587, t588;
  double t590, t592, t593, t594, t597, t599, t604, tv2rho22;
  double t612, t614, t615, t618, t622, t623, t624, t625;
  double t627, t628, t629, t630, t632, t633, t636, t638;
  double t639, t640, t642, t644, t645, t648, t650, t655;
  double tv2rhosigma0, tv2rhosigma1, t662, t664, tv2rhosigma2, t670, tv2rhosigma3, tv2rhosigma4;
  double t676, t677, t680, t684, t685, t686, t687, t689;
  double t690, t692, t694, t695, t698, t700, t701, t702;
  double t704, t706, t707, t710, t712, t717, tv2rhosigma5, t724;
  double t732, t733, t735, t736, t740, t741, t744, t746;
  double t748, t752, t754, t759, tv2rholapl0, t766, t768, tv2rholapl1;
  double t774, tv2rholapl2, t786, t787, t789, t790, t794, t795;
  double t798, t800, t802, t806, t808, t813, tv2rholapl3, tv2rhotau0;
  double tv2rhotau1, tv2rhotau2, tv2rhotau3, t817, t820, t823, t824, t826;
  double t827, t828, t830, t834, t836, t840, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t843, t846, t849, t850, t852;
  double t853, t854, t856, t860, t862, t866, tv2sigma25, t872;
  double t873, t875, t876, t877, t878, t879, t882, t883;
  double t886, t888, t892, tv2sigmalapl0, tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4;
  double t898, t899, t901, t902, t903, t904, t905, t908;
  double t909, t912, t914, t918, tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2;
  double tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t922, t925, t926, t928, t929;
  double t931, t935, t937, t941, tv2lapl20, tv2lapl21, t945, t948;
  double t949, t951, t952, t954, t958, t960, t964, tv2lapl22;
  double tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21, tv2tau22;

  double t968, t969, t972, t975, t976, t977, t980, t984;
  double t985, t989, t991, t996, t998, t1001, t1007, t1008;
  double t1011, t1013, t1016, t1020, t1023, t1030, t1038, t1039;
  double t1040, t1041, t1042, t1044, t1045, t1046, t1049, t1050;
  double t1051, t1052, t1053, t1055, t1059, t1060, t1062, t1063;
  double t1064, t1067, t1068, t1069, t1074, t1078, t1079, t1082;
  double t1083, t1088, t1090, t1091, t1092, t1094, t1098, t1100;
  double t1101, t1102, t1104, t1108, t1111, t1112, t1114, t1115;
  double t1116, t1119, t1120, t1121, t1124, t1125, t1131, t1132;
  double t1135, t1136, t1137, t1139, t1140, t1144, t1148, t1151;
  double t1153, t1155, t1160, t1162, t1163, t1166, t1169, t1172;
  double t1176, t1177, t1181, t1183, t1185, t1187, t1189, t1192;
  double t1194, tv3rho30, t1197, t1198, t1199, t1202, t1207, t1208;
  double t1210, t1214, t1215, t1219, t1222, t1226, t1228, t1232;
  double t1241, t1242, t1243, t1246, t1251, t1253, t1257, t1258;
  double t1262, t1265, t1266, t1268, t1277, t1279, t1282, tv3rho31;
  double t1285, t1290, t1294, t1298, t1299, t1303, t1305, t1314;
  double t1315, t1320, t1324, t1328, t1329, t1333, t1335, t1342;
  double t1350, t1352, t1353, tv3rho32, t1358, t1365, t1369, t1370;
  double t1377, t1378, t1385, t1389, t1390, t1407, t1410, t1417;
  double t1423, t1429, t1430, t1431, t1432, t1433, t1435, t1436;
  double t1437, t1439, t1440, t1441, t1444, t1445, t1446, t1447;
  double t1452, t1456, t1457, t1460, t1461, t1463, t1464, t1467;
  double t1470, t1472, t1473, t1474, t1476, t1480, t1482, t1483;
  double t1484, t1486, t1489, t1493, t1496, t1497, t1499, t1500;
  double t1501, t1504, t1505, t1506, t1509, t1510, t1513, t1514;
  double t1520, t1521, t1522, t1524, t1525, t1529, t1533, t1536;
  double t1538, t1540, t1545, tv3rho33, t1553, t1560, t1562, t1565;
  double t1566, t1569, t1577, t1578, t1579, t1580, t1583, t1584;
  double t1585, t1588, t1589, t1592, t1594, t1598, t1599, t1600;
  double t1602, t1603, t1607, t1608, t1611, t1615, t1617, t1620;
  double t1623, t1625, t1626, t1629, t1630, t1631, t1633, t1634;
  double t1642, t1645, t1646, t1650, t1651, t1658, t1661, t1662;
  double t1664, t1665, t1666, t1667, t1668, t1670, t1671, t1672;
  double t1673, t1674, t1675, t1676, t1678, t1679, t1680, t1682;
  double t1684, t1685, t1688, t1690, t1692, t1697, tv3rho2sigma0, tv3rho2sigma1;
  double t1704, t1708, t1710, tv3rho2sigma2, t1716, t1724, tv3rho2sigma3, tv3rho2sigma4;
  double t1730, t1737, t1740, tv3rho2sigma5, t1748, tv3rho2sigma6, tv3rho2sigma7, t1760;
  double t1761, t1764, t1772, t1773, t1776, t1777, t1778, t1781;
  double t1782, t1783, t1784, t1785, t1788, t1789, t1791, t1792;
  double t1797, t1801, t1803, t1804, t1807, t1809, t1810, t1812;
  double t1816, t1821, t1822, t1825, t1826, t1827, t1829, t1830;
  double t1833, t1834, t1842, t1845, t1852, t1853, t1854, t1855;
  double t1856, t1858, t1861, t1862, t1864, t1865, t1866, t1868;
  double t1870, t1871, t1872, t1874, t1875, t1876, t1878, t1879;
  double t1882, t1884, t1886, t1891, tv3rho2sigma8, t1898, t1905, t1907;
  double t1922, t1923, t1926, t1927, t1929, t1931, t1933, t1935;
  double t1937, t1938, t1941, t1944, t1945, t1948, t1949, t1950;
  double t1952, t1954, t1956, t1957, t1961, t1964, t1966, t1973;
  double t1974, t1982, t1992, t1993, t1996, t1997, t1998, t2000;
  double t2004, t2005, t2008, t2010, t2012, t2017, tv3rho2lapl0, t2024;
  double t2028, t2030, tv3rho2lapl1, t2036, t2044, tv3rho2lapl2, t2050, t2057;
  double t2060, tv3rho2lapl3, t2068, tv3rho2lapl4, t2091, t2092, t2095, t2097;
  double t2100, t2101, t2104, t2105, t2107, t2109, t2111, t2114;
  double t2115, t2118, t2119, t2120, t2122, t2124, t2126, t2127;
  double t2131, t2134, t2136, t2137, t2138, t2146, t2162, t2163;
  double t2166, t2167, t2168, t2170, t2174, t2175, t2178, t2180;
  double t2182, t2187, tv3rho2lapl5, tv3rho2tau0, tv3rho2tau1, tv3rho2tau2, tv3rho2tau3, tv3rho2tau4;
  double tv3rho2tau5, t2194, t2200, t2201, t2206, t2207, t2208, t2209;
  double t2211, t2212, t2213, t2214, t2216, t2217, t2218, t2219;
  double t2221, t2222, t2223, t2224, t2225, t2226, t2227, t2228;
  double t2231, t2232, t2233, t2237, t2241, t2244, t2245, t2248;
  double t2249, t2250, t2253, t2254, t2255, t2258, t2259, t2260;
  double t2262, t2263, t2265, t2266, t2271, t2272, t2275, t2276;
  double t2277, t2278, t2279, t2281, t2282, t2287, t2288, t2291;
  double t2295, t2296, t2297, t2298, t2301, t2302, t2303, t2304;
  double t2306, t2307, t2308, t2310, t2312, t2314, t2319, tv3rhosigma20;
  double tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2326, t2328, tv3rhosigma25, t2334;
  double tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2344, t2345, t2346;
  double t2347, t2349, t2350, t2351, t2352, t2353, t2355, t2356;
  double t2357, t2360, t2361, t2362, t2363, t2364, t2365, t2368;
  double t2369, t2370, t2375, t2376, t2377, t2378, t2380, t2381;
  double t2384, t2385, t2386, t2387, t2388, t2390, t2391, t2394;
  double t2396, t2401, t2402, t2403, t2404, t2406, t2407, t2412;
  double t2413, t2416, t2417, t2420, t2421, t2424, t2425, t2432;
  double t2433, t2434, t2436, t2437, t2440, t2441, t2442, t2443;
  double t2446, t2447, t2448, t2449, t2451, t2452, t2453, t2455;
  double t2457, t2459, t2464, tv3rhosigma211, t2471, t2483, t2485, t2486;
  double t2488, t2495, t2496, t2500, t2501, t2502, t2503, t2504;
  double t2507, t2510, t2511, t2512, t2514, t2515, t2516, t2517;
  double t2520, t2521, t2524, t2526, t2527, t2529, t2530, t2531;
  double t2532, t2533, t2538, t2541, t2546, t2548, t2549, t2551;
  double t2552, t2553, t2554, t2556, t2557, t2558, t2560, t2561;
  double t2564, t2565, t2568, t2570, t2572, t2577, tv3rhosigmalapl0, tv3rhosigmalapl1;
  double tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4, t2584, t2586, tv3rhosigmalapl5, t2592, tv3rhosigmalapl6;
  double tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, t2608, t2610, t2611, t2613;
  double t2616, t2617, t2618, t2619, t2622, t2625, t2626, t2627;
  double t2628, t2631, t2634, t2635, t2636, t2640, t2641, t2643;
  double t2644, t2646, t2647, t2648, t2649, t2650, t2653, t2655;
  double t2661, t2663, t2664, t2666, t2667, t2668, t2669, t2671;
  double t2672, t2673, t2675, t2676, t2679, t2680, t2689, t2690;
  double t2692, t2694, t2696, t2701, tv3rhosigmalapl11, tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2;
  double tv3rhosigmatau3, tv3rhosigmatau4, tv3rhosigmatau5, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9, tv3rhosigmatau10;
  double tv3rhosigmatau11, t2708, t2716, t2717, t2720, t2723, t2724, t2725;
  double t2727, t2728, t2734, t2735, t2737, t2739, t2740, t2742;
  double t2744, t2745, t2747, t2749, t2752, t2761, t2769, t2770;
  double t2775, t2776, t2782, t2783, t2785, t2787, t2789, t2794;
  double tv3rholapl20, tv3rholapl21, t2801, t2803, tv3rholapl22, t2809, tv3rholapl23, tv3rholapl24;
  double t2821, t2825, t2826, t2829, t2834, t2835, t2837, t2838;
  double t2840, t2841, t2842, t2844, t2845, t2847, t2849, t2850;
  double t2852, t2854, t2855, t2856, t2859, t2862, t2866, t2867;
  double t2887, t2888, t2890, t2892, t2894, t2899, tv3rholapl25, tv3rholapltau0;
  double tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rhotau20;
  double tv3rhotau21, tv3rhotau22, tv3rhotau23, tv3rhotau24, tv3rhotau25, t2903, t2904, t2905;
  double t2910, t2912, t2913, t2914, t2915, t2916, t2917, t2918;
  double t2919, t2920, t2921, t2924, t2927, t2929, t2930, t2933;
  double t2938, t2951, t2952, t2953, t2954, t2955, t2957, t2958;
  double t2959, t2960, t2961, t2962, t2963, t2964, t2965, t2966;
  double t2967, t2969, t2971, t2975, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2978, t2979, t2980;
  double t2983, t2988, t2989, t2992, t2995, t2997, t2998, t2999;
  double t3001, t3002, t3003, t3004, t3005, t3006, t3007, t3008;
  double t3014, t3026, t3027, t3028, t3029, t3030, t3031, t3032;
  double t3033, t3034, t3036, t3037, t3038, t3039, t3040, t3041;
  double t3042, t3044, t3046, t3050, tv3sigma39, t3056, t3058, t3060;
  double t3063, t3064, t3067, t3068, t3069, t3070, t3071, t3072;
  double t3073, t3074, t3075, t3076, t3077, t3078, t3079, t3080;
  double t3081, t3082, t3083, t3084, t3085, t3086, t3087, t3088;
  double t3089, t3094, t3095, t3096, t3097, t3101, t3102, t3107;
  double t3114, t3115, t3116, t3117, t3118, t3119, t3122, t3123;
  double t3124, t3125, t3127, t3129, t3133, tv3sigma2lapl0, tv3sigma2lapl1, tv3sigma2lapl2;
  double tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8, tv3sigma2lapl9, tv3sigma2lapl10;
  double t3141, t3142, t3145, t3146, t3147, t3148, t3150, t3152;
  double t3153, t3154, t3155, t3156, t3157, t3158, t3159, t3160;
  double t3161, t3162, t3163, t3164, t3165, t3166, t3167, t3168;
  double t3169, t3175, t3177, t3181, t3182, t3183, t3184, t3186;
  double t3187, t3190, t3191, t3192, t3193, t3194, t3199, t3204;
  double t3205, t3206, t3207, t3208, t3209, t3211, t3213, t3217;
  double tv3sigma2lapl11, tv3sigma2tau0, tv3sigma2tau1, tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6;
  double tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9, tv3sigma2tau10, tv3sigma2tau11, t3228, t3229, t3230;
  double t3231, t3232, t3234, t3235, t3236, t3238, t3239, t3243;
  double t3248, t3251, t3252, t3253, t3256, t3260, t3261, t3268;
  double t3269, t3272, t3273, t3274, t3276, t3277, t3278, t3280;
  double t3282, t3286, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25;
  double tv3sigmalapl26, tv3sigmalapl27, t3297, t3298, t3299, t3300, t3302, t3303;
  double t3304, t3308, t3309, t3312, t3313, t3318, t3319, t3320;
  double t3321, t3326, t3327, t3336, t3337, t3338, t3339, t3340;
  double t3341, t3342, t3343, t3345, t3346, t3347, t3349, t3351;
  double t3355, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5;
  double tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmatau20, tv3sigmatau21;
  double tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, tv3sigmatau28, t3359;
  double t3360, t3361, t3362, t3371, t3372, t3373, t3374, t3375;
  double t3376, t3377, t3379, t3380, t3381, t3382, t3383, t3384;
  double t3386, t3387, t3389, t3390, t3391, t3392, t3395, t3402;
  double t3413, t3415, t3417, t3421, tv3lapl30, tv3lapl31, tv3lapl32, t3425;
  double t3426, t3427, t3428, t3437, t3438, t3439, t3440, t3441;
  double t3442, t3443, t3445, t3446, t3447, t3448, t3449, t3450;
  double t3451, t3452, t3455, t3460, t3461, t3462, t3464, t3465;
  double t3466, t3479, t3481, t3483, t3487, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1;
  double tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20, tv3lapltau21, tv3lapltau22, tv3lapltau23;
  double tv3lapltau24, tv3lapltau25, tv3tau30, tv3tau31, tv3tau32, tv3tau33;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t20 = my_piecewise5(t12, t13, t16, t17, t18 * t9);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t33 * t37;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = 0.5e1 / 0.72e2 * t38 * sigma[0] * t43;
  t47 = params->csk_cp * t33;
  t48 = t37 * sigma[0];
  t52 = params->csk_cq * t33;
  t53 = t37 * lapl[0];
  t55 = 0.1e1 / t41 / rho[0];
  t59 = t47 * t48 * t43 / 0.24e2 + t52 * t53 * t55 / 0.24e2 - t46;
  t61 = log(0.1e1 - DBL_EPSILON);
  t62 = 0.1e1 / params->csk_a;
  t63 = pow(-t61, -t62);
  t64 = t59 < -t63;
  t65 = log(DBL_EPSILON);
  t66 = pow(-t65, -t62);
  t67 = -t66 < t59;
  t68 = my_piecewise3(t67, -t66, t59);
  t69 = -t63 < t68;
  t70 = my_piecewise3(t69, t68, -t63);
  t71 = fabs(t70);
  t72 = pow(t71, params->csk_a);
  t73 = 0.1e1 / t72;
  t74 = exp(-t73);
  t75 = 0.1e1 - t74;
  t76 = pow(t75, t62);
  t77 = my_piecewise5(t64, 0, t67, 1, t76);
  t79 = t59 * t77 + t46 + 0.1e1;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = -t18;
  t87 = my_piecewise5(t16, t13, t12, t17, t85 * t9);
  t88 = 0.1e1 + t87;
  t89 = t88 <= p->zeta_threshold;
  t90 = POW_1_3(t88);
  t91 = t90 * t90;
  t93 = my_piecewise3(t89, t25, t91 * t88);
  t94 = t93 * t31;
  t95 = rho[1] * rho[1];
  t96 = POW_1_3(rho[1]);
  t97 = t96 * t96;
  t99 = 0.1e1 / t97 / t95;
  t102 = 0.5e1 / 0.72e2 * t38 * sigma[2] * t99;
  t103 = t37 * sigma[2];
  t107 = t37 * lapl[1];
  t109 = 0.1e1 / t97 / rho[1];
  t113 = t47 * t103 * t99 / 0.24e2 + t52 * t107 * t109 / 0.24e2 - t102;
  t114 = t113 < -t63;
  t115 = -t66 < t113;
  t116 = my_piecewise3(t115, -t66, t113);
  t117 = -t63 < t116;
  t118 = my_piecewise3(t117, t116, -t63);
  t119 = fabs(t118);
  t120 = pow(t119, params->csk_a);
  t121 = 0.1e1 / t120;
  t122 = exp(-t121);
  t123 = 0.1e1 - t122;
  t124 = pow(t123, t62);
  t125 = my_piecewise5(t114, 0, t115, 1, t124);
  t127 = t113 * t125 + t102 + 0.1e1;
  t131 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t132 = t8 * t8;
  t133 = 0.1e1 / t132;
  t134 = t18 * t133;
  t136 = my_piecewise5(t12, 0, t16, 0, t9 - t134);
  t139 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t136);
  t140 = t139 * t31;
  t144 = 0.1e1 / t30;
  t145 = t29 * t144;
  t148 = t7 * t145 * t79 / 0.1e2;
  t151 = 0.1e1 / t41 / t39 / rho[0];
  t154 = 0.5e1 / 0.27e2 * t38 * sigma[0] * t151;
  t161 = -t47 * t48 * t151 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t53 * t43 + t154;
  t163 = t76 * t73;
  t164 = my_piecewise3(t67, 0, t161);
  t165 = my_piecewise3(t69, t164, 0);
  t167 = fabs(t70) / t70;
  t168 = 0.1e1 / t71;
  t170 = 0.1e1 / t75;
  t171 = t74 * t170;
  t172 = t167 * t168 * t171;
  t174 = my_piecewise5(t64, 0, t67, 0, -t163 * t165 * t172);
  t176 = t161 * t77 + t174 * t59 - t154;
  t181 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t79 + t148 + 0.3e1 / 0.2e2 * t7 * t32 * t176);
  t182 = t85 * t133;
  t184 = my_piecewise5(t16, 0, t12, 0, -t9 - t182);
  t187 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t184);
  t188 = t187 * t31;
  t192 = t93 * t144;
  t195 = t7 * t192 * t127 / 0.1e2;
  t197 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t127 + t195);
  tvrho0 = t83 + t131 + t8 * (t181 + t197);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t201 = my_piecewise5(t12, 0, t16, 0, -t9 - t134);
  t204 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t201);
  t205 = t204 * t31;
  t210 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t79 + t148);
  t212 = my_piecewise5(t16, 0, t12, 0, t9 - t182);
  t215 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t212);
  t216 = t215 * t31;
  t222 = 0.1e1 / t97 / t95 / rho[1];
  t225 = 0.5e1 / 0.27e2 * t38 * sigma[2] * t222;
  t232 = -t47 * t103 * t222 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t107 * t99 + t225;
  t234 = t124 * t121;
  t235 = my_piecewise3(t115, 0, t232);
  t236 = my_piecewise3(t117, t235, 0);
  t238 = fabs(t118) / t118;
  t239 = 0.1e1 / t119;
  t241 = 0.1e1 / t123;
  t242 = t122 * t241;
  t243 = t238 * t239 * t242;
  t245 = my_piecewise5(t114, 0, t115, 0, -t234 * t236 * t243);
  t247 = t113 * t245 + t125 * t232 - t225;
  t252 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t127 + t195 + 0.3e1 / 0.2e2 * t7 * t94 * t247);
  tvrho1 = t83 + t131 + t8 * (t210 + t252);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t256 = 0.5e1 / 0.72e2 * t38 * t43;
  t257 = t37 * t43;
  t260 = t47 * t257 / 0.24e2 - t256;
  t262 = my_piecewise3(t67, 0, t260);
  t263 = my_piecewise3(t69, t262, 0);
  t266 = my_piecewise5(t64, 0, t67, 0, -t163 * t263 * t172);
  t268 = t260 * t77 + t266 * t59 + t256;
  t272 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t268);
  tvsigma0 = t8 * t272;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t274 = 0.5e1 / 0.72e2 * t38 * t99;
  t275 = t37 * t99;
  t278 = t47 * t275 / 0.24e2 - t274;
  t280 = my_piecewise3(t115, 0, t278);
  t281 = my_piecewise3(t117, t280, 0);
  t284 = my_piecewise5(t114, 0, t115, 0, -t234 * t281 * t243);
  t286 = t113 * t284 + t125 * t278 + t274;
  t290 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t286);
  tvsigma2 = t8 * t290;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t291 = t37 * t55;
  t297 = my_piecewise3(t67, 0, t52 * t291 / 0.24e2);
  t298 = my_piecewise3(t69, t297, 0);
  t301 = my_piecewise5(t64, 0, t67, 0, -t163 * t298 * t172);
  t303 = t52 * t291 * t77 / 0.24e2 + t59 * t301;
  t307 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t303);
  tvlapl0 = t8 * t307;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t308 = t37 * t109;
  t314 = my_piecewise3(t115, 0, t52 * t308 / 0.24e2);
  t315 = my_piecewise3(t117, t314, 0);
  t318 = my_piecewise5(t114, 0, t115, 0, -t234 * t315 * t243);
  t320 = t52 * t308 * t125 / 0.24e2 + t113 * t318;
  t324 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t320);
  tvlapl1 = t8 * t324;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t327 = 0.1e1 / t26;
  t328 = t136 * t136;
  t331 = t132 * t8;
  t332 = 0.1e1 / t331;
  t333 = t18 * t332;
  t336 = my_piecewise5(t12, 0, t16, 0, -0.2e1 * t133 + 0.2e1 * t333);
  t340 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t328 + 0.5e1 / 0.3e1 * t27 * t336);
  t341 = t340 * t31;
  t345 = t139 * t144;
  t347 = t7 * t345 * t79;
  t353 = 0.1e1 / t30 / t8;
  t354 = t29 * t353;
  t357 = t7 * t354 * t79 / 0.3e2;
  t359 = t7 * t145 * t176;
  t361 = t39 * t39;
  t363 = 0.1e1 / t41 / t361;
  t366 = 0.55e2 / 0.81e2 * t38 * sigma[0] * t363;
  t373 = 0.11e2 / 0.27e2 * t47 * t48 * t363 + 0.5e1 / 0.27e2 * t52 * t53 * t151 - t366;
  t377 = t72 * t72;
  t379 = t76 / t377;
  t380 = t165 * t165;
  t382 = t167 * t167;
  t383 = t71 * t71;
  t384 = 0.1e1 / t383;
  t385 = t382 * t384;
  t386 = t74 * t74;
  t387 = t75 * t75;
  t388 = 0.1e1 / t387;
  t389 = t386 * t388;
  t390 = t385 * t389;
  t392 = t380 * t382;
  t394 = t384 * t74;
  t395 = t170 * params->csk_a;
  t396 = t394 * t395;
  t398 = my_piecewise3(t67, 0, t373);
  t399 = my_piecewise3(t69, t398, 0);
  t402 = t163 * t380;
  t403 = 0.0;
  t405 = t403 * t168 * t171;
  t406 = t402 * t405;
  t407 = t385 * t171;
  t409 = t379 * t392;
  t411 = t384 * t386;
  t412 = t388 * params->csk_a;
  t413 = t411 * t412;
  t416 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t399 + t163 * t392 * t396 + t379 * t380 * t390 - t396 * t409 + t402 * t407 - t409 * t413 - t406);
  t418 = 0.2e1 * t161 * t174 + t373 * t77 + t416 * t59 + t366;
  t423 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t79 + t347 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t176 - t357 + t359 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t418);
  t424 = 0.1e1 / t90;
  t425 = t184 * t184;
  t428 = t85 * t332;
  t431 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t133 + 0.2e1 * t428);
  t435 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t425 + 0.5e1 / 0.3e1 * t91 * t431);
  t436 = t435 * t31;
  t440 = t187 * t144;
  t442 = t7 * t440 * t127;
  t444 = t93 * t353;
  t447 = t7 * t444 * t127 / 0.3e2;
  t449 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t127 + t442 / 0.5e1 - t447);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t197 + t8 * (t423 + t449);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t452 = t327 * t201;
  t456 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t333);
  t460 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t452 * t136 + 0.5e1 / 0.3e1 * t27 * t456);
  t461 = t460 * t31;
  t465 = t204 * t144;
  t467 = t7 * t465 * t79;
  t475 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t79 + t467 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t176 + t347 / 0.1e2 - t357 + t359 / 0.1e2);
  t476 = t424 * t212;
  t480 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t428);
  t484 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t476 * t184 + 0.5e1 / 0.3e1 * t91 * t480);
  t485 = t484 * t31;
  t489 = t215 * t144;
  t491 = t7 * t489 * t127;
  t498 = t7 * t192 * t247;
  t501 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t127 + t491 / 0.1e2 + t442 / 0.1e2 - t447 + 0.3e1 / 0.2e2 * t7 * t188 * t247 + t498 / 0.1e2);
  tv2rho21 = t181 + t197 + t210 + t252 + t8 * (t475 + t501);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t506 = t201 * t201;
  t511 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t133 + 0.2e1 * t333);
  t515 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t506 + 0.5e1 / 0.3e1 * t27 * t511);
  t516 = t515 * t31;
  t522 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t79 + t467 / 0.5e1 - t357);
  t523 = t212 * t212;
  t528 = my_piecewise5(t16, 0, t12, 0, -0.2e1 * t133 + 0.2e1 * t428);
  t532 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t523 + 0.5e1 / 0.3e1 * t91 * t528);
  t533 = t532 * t31;
  t542 = t95 * t95;
  t544 = 0.1e1 / t97 / t542;
  t547 = 0.55e2 / 0.81e2 * t38 * sigma[2] * t544;
  t554 = 0.11e2 / 0.27e2 * t47 * t103 * t544 + 0.5e1 / 0.27e2 * t52 * t107 * t222 - t547;
  t558 = t120 * t120;
  t560 = t124 / t558;
  t561 = t236 * t236;
  t563 = t238 * t238;
  t564 = t119 * t119;
  t565 = 0.1e1 / t564;
  t566 = t563 * t565;
  t567 = t122 * t122;
  t568 = t123 * t123;
  t569 = 0.1e1 / t568;
  t570 = t567 * t569;
  t571 = t566 * t570;
  t573 = t561 * t563;
  t575 = t565 * t122;
  t576 = t241 * params->csk_a;
  t577 = t575 * t576;
  t579 = my_piecewise3(t115, 0, t554);
  t580 = my_piecewise3(t117, t579, 0);
  t583 = t234 * t561;
  t584 = 0.0;
  t586 = t584 * t239 * t242;
  t587 = t583 * t586;
  t588 = t566 * t242;
  t590 = t560 * t573;
  t592 = t565 * t567;
  t593 = t569 * params->csk_a;
  t594 = t592 * t593;
  t597 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t580 + t234 * t573 * t577 + t560 * t561 * t571 - t577 * t590 + t583 * t588 - t590 * t594 - t587);
  t599 = t113 * t597 + t125 * t554 + 0.2e1 * t232 * t245 + t547;
  t604 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t127 + t491 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t247 - t447 + t498 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t599);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t252 + t8 * (t522 + t604);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t612 = t7 * t145 * t268 / 0.1e2;
  t614 = 0.5e1 / 0.27e2 * t38 * t151;
  t615 = t37 * t151;
  t618 = -t47 * t615 / 0.9e1 + t614;
  t622 = t165 * t382;
  t623 = t379 * t622;
  t624 = t388 * t263;
  t625 = t411 * t624;
  t627 = t263 * t382;
  t628 = t163 * t627;
  t629 = t395 * t165;
  t630 = t394 * t629;
  t632 = my_piecewise3(t67, 0, t618);
  t633 = my_piecewise3(t69, t632, 0);
  t636 = t263 * t165;
  t638 = t163 * t636 * t405;
  t639 = t170 * t165;
  t640 = t394 * t639;
  t642 = t379 * t627;
  t644 = t412 * t165;
  t645 = t411 * t644;
  t648 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t633 + t623 * t625 + t628 * t630 + t628 * t640 - t630 * t642 - t642 * t645 - t638);
  t650 = t161 * t266 + t174 * t260 + t59 * t648 + t618 * t77 - t614;
  t655 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t268 + t612 + 0.3e1 / 0.2e2 * t7 * t32 * t650);
  tv2rhosigma0 = t655 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t662 = t7 * t192 * t286 / 0.1e2;
  t664 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t286 + t662);
  tv2rhosigma2 = t664 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t670 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t268 + t612);
  tv2rhosigma3 = t670 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t676 = 0.5e1 / 0.27e2 * t38 * t222;
  t677 = t37 * t222;
  t680 = -t47 * t677 / 0.9e1 + t676;
  t684 = t236 * t563;
  t685 = t560 * t684;
  t686 = t569 * t281;
  t687 = t592 * t686;
  t689 = t281 * t563;
  t690 = t234 * t689;
  t692 = t575 * t576 * t236;
  t694 = my_piecewise3(t115, 0, t680);
  t695 = my_piecewise3(t117, t694, 0);
  t698 = t281 * t236;
  t700 = t234 * t698 * t586;
  t701 = t241 * t236;
  t702 = t575 * t701;
  t704 = t560 * t689;
  t706 = t593 * t236;
  t707 = t592 * t706;
  t710 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t695 + t685 * t687 + t690 * t692 + t690 * t702 - t692 * t704 - t704 * t707 - t700);
  t712 = t113 * t710 + t125 * t680 + t232 * t284 + t245 * t278 - t676;
  t717 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t286 + t662 + 0.3e1 / 0.2e2 * t7 * t94 * t712);
  tv2rhosigma5 = t717 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t724 = t7 * t145 * t303 / 0.1e2;
  t732 = t388 * t298;
  t733 = t411 * t732;
  t735 = t298 * t382;
  t736 = t163 * t735;
  t740 = my_piecewise3(t67, 0, -0.5e1 / 0.72e2 * t52 * t257);
  t741 = my_piecewise3(t69, t740, 0);
  t744 = t298 * t165;
  t746 = t163 * t744 * t405;
  t748 = t379 * t735;
  t752 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t741 + t623 * t733 + t630 * t736 - t630 * t748 + t640 * t736 - t645 * t748 - t746);
  t754 = -0.5e1 / 0.72e2 * t52 * t257 * t77 + t52 * t291 * t174 / 0.24e2 + t161 * t301 + t59 * t752;
  t759 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t303 + t724 + 0.3e1 / 0.2e2 * t7 * t32 * t754);
  tv2rholapl0 = t759 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t766 = t7 * t192 * t320 / 0.1e2;
  t768 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t320 + t766);
  tv2rholapl1 = t768 * t8 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  t774 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t303 + t724);
  tv2rholapl2 = t774 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  t786 = t569 * t315;
  t787 = t592 * t786;
  t789 = t315 * t563;
  t790 = t234 * t789;
  t794 = my_piecewise3(t115, 0, -0.5e1 / 0.72e2 * t52 * t275);
  t795 = my_piecewise3(t117, t794, 0);
  t798 = t315 * t236;
  t800 = t234 * t798 * t586;
  t802 = t560 * t789;
  t806 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t795 + t685 * t787 + t692 * t790 - t692 * t802 + t702 * t790 - t707 * t802 - t800);
  t808 = -0.5e1 / 0.72e2 * t52 * t275 * t125 + t52 * t308 * t245 / 0.24e2 + t232 * t318 + t113 * t806;
  t813 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t320 + t766 + 0.3e1 / 0.2e2 * t7 * t94 * t808);
  tv2rholapl3 = t8 * t813 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t817 = t263 * t263;
  t820 = t817 * t382;
  t823 = my_piecewise3(t67, 0, 0);
  t824 = my_piecewise3(t69, t823, 0);
  t826 = t163 * t824 * t172;
  t827 = t163 * t817;
  t828 = t827 * t405;
  t830 = t379 * t820;
  t834 = my_piecewise5(t64, 0, t67, 0, t163 * t396 * t820 + t379 * t390 * t817 - t396 * t830 + t407 * t827 - t413 * t830 - t826 - t828);
  t836 = 0.2e1 * t260 * t266 + t59 * t834;
  t840 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t836);
  tv2sigma20 = t8 * t840;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t843 = t281 * t281;
  t846 = t843 * t563;
  t849 = my_piecewise3(t115, 0, 0);
  t850 = my_piecewise3(t117, t849, 0);
  t852 = t234 * t850 * t243;
  t853 = t234 * t843;
  t854 = t853 * t586;
  t856 = t560 * t846;
  t860 = my_piecewise5(t114, 0, t115, 0, t234 * t577 * t846 + t560 * t571 * t843 - t577 * t856 + t588 * t853 - t594 * t856 - t852 - t854);
  t862 = t113 * t860 + 0.2e1 * t278 * t284;
  t866 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t862);
  tv2sigma25 = t8 * t866;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t872 = t395 * t263;
  t873 = t394 * t872;
  t875 = t298 * t263;
  t876 = t163 * t875;
  t877 = t876 * t405;
  t878 = t170 * t263;
  t879 = t394 * t878;
  t882 = t412 * t263;
  t883 = t411 * t882;
  t886 = my_piecewise5(t64, 0, t67, 0, t642 * t733 + t736 * t873 + t736 * t879 - t748 * t873 - t748 * t883 - t826 - t877);
  t888 = t52 * t291 * t266 / 0.24e2 + t260 * t301 + t59 * t886;
  t892 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t888);
  tv2sigmalapl0 = t8 * t892;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  t898 = t576 * t281;
  t899 = t575 * t898;
  t901 = t315 * t281;
  t902 = t234 * t901;
  t903 = t902 * t586;
  t904 = t241 * t281;
  t905 = t575 * t904;
  t908 = t593 * t281;
  t909 = t592 * t908;
  t912 = my_piecewise5(t114, 0, t115, 0, t704 * t787 + t790 * t899 + t790 * t905 - t802 * t899 - t802 * t909 - t852 - t903);
  t914 = t52 * t308 * t284 / 0.24e2 + t278 * t318 + t113 * t912;
  t918 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t914);
  tv2sigmalapl5 = t8 * t918;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t922 = t298 * t298;
  t925 = t922 * t382;
  t926 = t163 * t925;
  t928 = t163 * t922;
  t929 = t928 * t405;
  t931 = t379 * t925;
  t935 = my_piecewise5(t64, 0, t67, 0, t379 * t390 * t922 + t396 * t926 - t396 * t931 + t407 * t928 - t413 * t931 - t826 - t929);
  t937 = t52 * t291 * t301 / 0.12e2 + t59 * t935;
  t941 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t937);
  tv2lapl20 = t8 * t941;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  t945 = t315 * t315;
  t948 = t945 * t563;
  t949 = t234 * t948;
  t951 = t234 * t945;
  t952 = t951 * t586;
  t954 = t560 * t948;
  t958 = my_piecewise5(t114, 0, t115, 0, t560 * t571 * t945 + t577 * t949 - t577 * t954 + t588 * t951 - t594 * t954 - t852 - t952);
  t960 = t52 * t308 * t318 / 0.12e2 + t113 * t958;
  t964 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t960);
  tv2lapl22 = t8 * t964;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

  t968 = 0.1e1 / t26 / t21;
  t969 = t328 * t136;
  t972 = t327 * t136;
  t975 = t132 * t132;
  t976 = 0.1e1 / t975;
  t977 = t18 * t976;
  t980 = my_piecewise5(t12, 0, t16, 0, 0.6e1 * t332 - 0.6e1 * t977);
  t984 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t968 * t969 + 0.1e2 / 0.3e1 * t972 * t336 + 0.5e1 / 0.3e1 * t27 * t980);
  t985 = t984 * t31;
  t989 = t340 * t144;
  t991 = t7 * t989 * t79;
  t996 = t139 * t353;
  t998 = t7 * t996 * t79;
  t1001 = t7 * t345 * t176;
  t1007 = 0.1e1 / t30 / t132;
  t1008 = t29 * t1007;
  t1011 = 0.2e1 / 0.45e2 * t7 * t1008 * t79;
  t1013 = t7 * t354 * t176;
  t1016 = t7 * t145 * t418;
  t1020 = 0.1e1 / t41 / t361 / rho[0];
  t1023 = 0.77e3 / 0.243e3 * t38 * sigma[0] * t1020;
  t1030 = -0.154e3 / 0.81e2 * t47 * t48 * t1020 - 0.55e2 / 0.81e2 * t52 * t53 * t363 + t1023;
  t1038 = t76 / t377 / t72;
  t1039 = t380 * t165;
  t1040 = t382 * t167;
  t1041 = t1039 * t1040;
  t1042 = t1038 * t1041;
  t1044 = 0.1e1 / t383 / t71;
  t1045 = t1044 * t386;
  t1046 = t1045 * t412;
  t1049 = t163 * t1041;
  t1050 = t1044 * t74;
  t1051 = params->csk_a * params->csk_a;
  t1052 = t170 * t1051;
  t1053 = t1050 * t1052;
  t1055 = t388 * t399;
  t1059 = t386 * t74;
  t1060 = t1044 * t1059;
  t1062 = 0.1e1 / t387 / t75;
  t1063 = t1062 * params->csk_a;
  t1064 = t1060 * t1063;
  t1067 = t379 * t1041;
  t1068 = t388 * t1051;
  t1069 = t1045 * t1068;
  t1074 = t163 * t399 * t165 * t405;
  t1078 = t1062 * t1051;
  t1079 = t1060 * t1078;
  t1082 = t1044 * params->csk_a;
  t1083 = t1082 * t171;
  t1088 = t1039 * t167;
  t1090 = t388 * t403;
  t1091 = t411 * t1090;
  t1092 = t379 * t1088 * t1091;
  t1094 = t399 * t382;
  t1098 = t1039 * t403;
  t1100 = t170 * t167;
  t1101 = t394 * t1100;
  t1102 = t163 * t1098 * t1101;
  t1104 = 0.3e1 * t1055 * t411 * t623 + 0.3e1 * t1094 * t163 * t640 + 0.3e1 * t1042 * t1046 + 0.3e1 * t1042 * t1064 - 0.3e1 * t1042 * t1069 - 0.2e1 * t1042 * t1079 - t1049 * t1053 - 0.3e1 * t1049 * t1083 + 0.3e1 * t1067 * t1069 + 0.3e1 * t1067 * t1083 - 0.3e1 * t1074 + 0.3e1 * t1092 + 0.3e1 * t1102;
  t1108 = t379 * t1094;
  t1111 = t379 * t1098;
  t1112 = t384 * params->csk_a;
  t1114 = t167 * t74 * t170;
  t1115 = t1112 * t1114;
  t1116 = t1111 * t1115;
  t1119 = t395 * t403;
  t1120 = t394 * t1119;
  t1121 = t163 * t1088 * t1120;
  t1124 = t395 * t399;
  t1125 = t394 * t1124;
  t1131 = t411 * t412 * t167;
  t1132 = t1111 * t1131;
  t1135 = t1040 * t1044;
  t1136 = t1059 * t1062;
  t1137 = t1135 * t1136;
  t1139 = my_piecewise3(t67, 0, t1030);
  t1140 = my_piecewise3(t69, t1139, 0);
  t1144 = t1135 * t389;
  t1148 = t1135 * t171;
  t1151 = -t1038 * t1039 * t1137 - 0.3e1 * t1039 * t1144 * t379 - 0.2e1 * t1039 * t1148 * t163 + 0.3e1 * t1125 * t163 * t622 - t1140 * t163 * t172 - t1042 * t1053 + 0.3e1 * t1053 * t1067 - 0.3e1 * t1108 * t630 - 0.3e1 * t1108 * t645 - 0.3e1 * t1116 + 0.3e1 * t1121 - 0.3e1 * t1132 - t406;
  t1153 = my_piecewise5(t64, 0, t67, 0, t1104 + t1151);
  t1155 = t1030 * t77 + t1153 * t59 + 0.3e1 * t161 * t416 + 0.3e1 * t174 * t373 - t1023;
  t1160 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t985 * t79 + 0.3e1 / 0.1e2 * t991 + 0.9e1 / 0.2e2 * t7 * t341 * t176 - t998 / 0.1e2 + 0.3e1 / 0.5e1 * t1001 + 0.9e1 / 0.2e2 * t7 * t140 * t418 + t1011 - t1013 / 0.1e2 + 0.3e1 / 0.1e2 * t1016 + 0.3e1 / 0.2e2 * t7 * t32 * t1155);
  t1162 = 0.1e1 / t90 / t88;
  t1163 = t425 * t184;
  t1166 = t424 * t184;
  t1169 = t85 * t976;
  t1172 = my_piecewise5(t16, 0, t12, 0, -0.6e1 * t332 - 0.6e1 * t1169);
  t1176 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1162 * t1163 + 0.1e2 / 0.3e1 * t1166 * t431 + 0.5e1 / 0.3e1 * t91 * t1172);
  t1177 = t1176 * t31;
  t1181 = t435 * t144;
  t1183 = t7 * t1181 * t127;
  t1185 = t187 * t353;
  t1187 = t7 * t1185 * t127;
  t1189 = t93 * t1007;
  t1192 = 0.2e1 / 0.45e2 * t7 * t1189 * t127;
  t1194 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1177 * t127 + 0.3e1 / 0.1e2 * t1183 - t1187 / 0.1e2 + t1192);
  tv3rho30 = 0.3e1 * t423 + 0.3e1 * t449 + t8 * (t1160 + t1194);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1197 = 0.2e1 * t475;
  t1198 = 0.2e1 * t501;
  t1199 = t968 * t201;
  t1202 = t327 * t456;
  t1207 = 0.2e1 * t332;
  t1208 = 0.6e1 * t977;
  t1210 = my_piecewise5(t12, 0, t16, 0, t1207 - t1208);
  t1214 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1199 * t328 + 0.2e2 / 0.9e1 * t1202 * t136 + 0.1e2 / 0.9e1 * t452 * t336 + 0.5e1 / 0.3e1 * t27 * t1210);
  t1215 = t1214 * t31;
  t1219 = t460 * t144;
  t1222 = t7 * t1219 * t79 / 0.5e1;
  t1226 = t204 * t353;
  t1228 = t7 * t1226 * t79;
  t1232 = t7 * t465 * t176 / 0.5e1;
  t1241 = 0.3e1 / 0.2e2 * t7 * t1215 * t79 + t1222 + 0.3e1 / 0.1e2 * t7 * t461 * t176 - t1228 / 0.3e2 + t1232 + 0.3e1 / 0.2e2 * t7 * t205 * t418 + t991 / 0.1e2 - t998 / 0.15e2 + t1001 / 0.5e1 + t1011 - t1013 / 0.15e2 + t1016 / 0.1e2;
  t1242 = my_piecewise3(t2, 0, t1241);
  t1243 = t1162 * t212;
  t1246 = t424 * t480;
  t1251 = 0.6e1 * t1169;
  t1253 = my_piecewise5(t16, 0, t12, 0, -t1207 - t1251);
  t1257 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1243 * t425 + 0.2e2 / 0.9e1 * t1246 * t184 + 0.1e2 / 0.9e1 * t476 * t431 + 0.5e1 / 0.3e1 * t91 * t1253);
  t1258 = t1257 * t31;
  t1262 = t484 * t144;
  t1265 = t7 * t1262 * t127 / 0.5e1;
  t1266 = t215 * t353;
  t1268 = t7 * t1266 * t127;
  t1277 = t7 * t440 * t247 / 0.5e1;
  t1279 = t7 * t444 * t247;
  t1282 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1258 * t127 + t1265 - t1268 / 0.3e2 + t1183 / 0.1e2 - t1187 / 0.15e2 + t1192 + 0.3e1 / 0.2e2 * t7 * t436 * t247 + t1277 - t1279 / 0.3e2);
  tv3rho31 = t423 + t449 + t1197 + t1198 + t8 * (t1242 + t1282);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1285 = t968 * t506;
  t1290 = t327 * t511;
  t1294 = my_piecewise5(t12, 0, t16, 0, -t1207 - t1208);
  t1298 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1285 * t136 + 0.2e2 / 0.9e1 * t452 * t456 + 0.1e2 / 0.9e1 * t1290 * t136 + 0.5e1 / 0.3e1 * t27 * t1294);
  t1299 = t1298 * t31;
  t1303 = t515 * t144;
  t1305 = t7 * t1303 * t79;
  t1314 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1299 * t79 + t1305 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t516 * t176 + t1222 - t1228 / 0.15e2 + t1232 - t998 / 0.3e2 + t1011 - t1013 / 0.3e2);
  t1315 = t1162 * t523;
  t1320 = t424 * t528;
  t1324 = my_piecewise5(t16, 0, t12, 0, t1207 - t1251);
  t1328 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1315 * t184 + 0.2e2 / 0.9e1 * t476 * t480 + 0.1e2 / 0.9e1 * t1320 * t184 + 0.5e1 / 0.3e1 * t91 * t1324);
  t1329 = t1328 * t31;
  t1333 = t532 * t144;
  t1335 = t7 * t1333 * t127;
  t1342 = t7 * t489 * t247;
  t1350 = t7 * t192 * t599;
  t1352 = 0.3e1 / 0.2e2 * t7 * t1329 * t127 + t1335 / 0.1e2 + t1265 - t1268 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t485 * t247 + t1342 / 0.5e1 - t1187 / 0.3e2 + t1192 + t1277 - t1279 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t188 * t599 + t1350 / 0.1e2;
  t1353 = my_piecewise3(t84, 0, t1352);
  tv3rho32 = t1197 + t1198 + t522 + t604 + t8 * (t1314 + t1353);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1358 = t506 * t201;
  t1365 = my_piecewise5(t12, 0, t16, 0, -0.6e1 * t332 - 0.6e1 * t977);
  t1369 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t968 * t1358 + 0.1e2 / 0.3e1 * t452 * t511 + 0.5e1 / 0.3e1 * t27 * t1365);
  t1370 = t1369 * t31;
  t1377 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1370 * t79 + 0.3e1 / 0.1e2 * t1305 - t1228 / 0.1e2 + t1011);
  t1378 = t523 * t212;
  t1385 = my_piecewise5(t16, 0, t12, 0, 0.6e1 * t332 - 0.6e1 * t1169);
  t1389 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1162 * t1378 + 0.1e2 / 0.3e1 * t476 * t528 + 0.5e1 / 0.3e1 * t91 * t1385);
  t1390 = t1389 * t31;
  t1407 = 0.1e1 / t97 / t542 / rho[1];
  t1410 = 0.77e3 / 0.243e3 * t38 * sigma[2] * t1407;
  t1417 = -0.154e3 / 0.81e2 * t47 * t103 * t1407 - 0.55e2 / 0.81e2 * t52 * t107 * t544 + t1410;
  t1423 = t569 * t580;
  t1429 = t124 / t558 / t120;
  t1430 = t561 * t236;
  t1431 = t563 * t238;
  t1432 = t1430 * t1431;
  t1433 = t1429 * t1432;
  t1435 = 0.1e1 / t564 / t119;
  t1436 = t567 * t122;
  t1437 = t1435 * t1436;
  t1439 = 0.1e1 / t568 / t123;
  t1440 = t1439 * params->csk_a;
  t1441 = t1437 * t1440;
  t1444 = t560 * t1432;
  t1445 = t1435 * t567;
  t1446 = t569 * t1051;
  t1447 = t1445 * t1446;
  t1452 = t234 * t580 * t236 * t586;
  t1456 = t1439 * t1051;
  t1457 = t1437 * t1456;
  t1460 = t1435 * t1051;
  t1461 = t1460 * t242;
  t1463 = t1435 * params->csk_a;
  t1464 = t1463 * t242;
  t1467 = t234 * t1432;
  t1470 = t1430 * t238;
  t1472 = t569 * t584;
  t1473 = t592 * t1472;
  t1474 = t560 * t1470 * t1473;
  t1476 = t580 * t563;
  t1480 = t1430 * t584;
  t1482 = t241 * t238;
  t1483 = t575 * t1482;
  t1484 = t234 * t1480 * t1483;
  t1486 = t1445 * t593;
  t1489 = 0.3e1 * t1423 * t592 * t685 + 0.3e1 * t1476 * t234 * t702 + 0.3e1 * t1433 * t1441 - 0.3e1 * t1433 * t1447 - 0.2e1 * t1433 * t1457 - t1433 * t1461 + 0.3e1 * t1433 * t1486 + 0.3e1 * t1444 * t1447 + 0.3e1 * t1444 * t1464 - 0.3e1 * t1464 * t1467 - 0.3e1 * t1452 + 0.3e1 * t1474 + 0.3e1 * t1484;
  t1493 = t560 * t1476;
  t1496 = t560 * t1480;
  t1497 = t565 * params->csk_a;
  t1499 = t238 * t122 * t241;
  t1500 = t1497 * t1499;
  t1501 = t1496 * t1500;
  t1504 = t576 * t584;
  t1505 = t575 * t1504;
  t1506 = t234 * t1470 * t1505;
  t1509 = t592 * t593 * t238;
  t1510 = t1496 * t1509;
  t1513 = t576 * t580;
  t1514 = t575 * t1513;
  t1520 = t1431 * t1435;
  t1521 = t1436 * t1439;
  t1522 = t1520 * t1521;
  t1524 = my_piecewise3(t115, 0, t1417);
  t1525 = my_piecewise3(t117, t1524, 0);
  t1529 = t1520 * t242;
  t1533 = t1520 * t570;
  t1536 = -t1429 * t1430 * t1522 - 0.2e1 * t1430 * t1529 * t234 - 0.3e1 * t1430 * t1533 * t560 + 0.3e1 * t1514 * t234 * t684 - t1525 * t234 * t243 + 0.3e1 * t1444 * t1461 - t1461 * t1467 - 0.3e1 * t1493 * t692 - 0.3e1 * t1493 * t707 - 0.3e1 * t1501 + 0.3e1 * t1506 - 0.3e1 * t1510 - t587;
  t1538 = my_piecewise5(t114, 0, t115, 0, t1489 + t1536);
  t1540 = t113 * t1538 + t125 * t1417 + 0.3e1 * t232 * t597 + 0.3e1 * t245 * t554 - t1410;
  t1545 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1390 * t127 + 0.3e1 / 0.1e2 * t1335 + 0.9e1 / 0.2e2 * t7 * t533 * t247 - t1268 / 0.1e2 + 0.3e1 / 0.5e1 * t1342 + 0.9e1 / 0.2e2 * t7 * t216 * t599 + t1192 - t1279 / 0.1e2 + 0.3e1 / 0.1e2 * t1350 + 0.3e1 / 0.2e2 * t7 * t94 * t1540);
  tv3rho33 = 0.3e1 * t522 + 0.3e1 * t604 + t8 * (t1377 + t1545);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1553 = t7 * t345 * t268;
  t1560 = t7 * t354 * t268 / 0.3e2;
  t1562 = t7 * t145 * t650;
  t1565 = 0.55e2 / 0.81e2 * t38 * t363;
  t1566 = t37 * t363;
  t1569 = 0.11e2 / 0.27e2 * t47 * t1566 - t1565;
  t1577 = t263 * t1040;
  t1578 = t163 * t1577;
  t1579 = t170 * t380;
  t1580 = t1050 * t1579;
  t1583 = t380 * t1040;
  t1584 = t379 * t1583;
  t1585 = t1045 * t624;
  t1588 = t1038 * t1583;
  t1589 = t1062 * t263;
  t1592 = t633 * t165;
  t1594 = t163 * t1592 * t405;
  t1598 = t163 * t263 * t399 * t405;
  t1599 = t170 * t399;
  t1600 = t394 * t1599;
  t1602 = t633 * t382;
  t1603 = t163 * t1602;
  t1607 = t388 * t633;
  t1608 = t411 * t1607;
  t1611 = t1045 * t882;
  t1615 = t1050 * t1052 * t380;
  t1617 = t379 * t1577;
  t1620 = t1038 * t1577;
  t1623 = t1044 * t1051;
  t1625 = t380 * t386 * t388;
  t1626 = t1623 * t1625;
  t1629 = -t1060 * t1588 * t1589 + t1108 * t625 - t1125 * t642 - 0.2e1 * t1578 * t1580 - t1578 * t1615 - 0.3e1 * t1584 * t1585 + 0.3e1 * t1588 * t1611 + t1600 * t628 + 0.2e1 * t1603 * t640 + 0.2e1 * t1608 * t623 + 0.3e1 * t1615 * t1617 - t1615 * t1620 - 0.3e1 * t1620 * t1626 - 0.2e1 * t1594 - t1598 - t638;
  t1630 = t412 * t399;
  t1631 = t411 * t1630;
  t1633 = t1078 * t380;
  t1634 = t1060 * t1633;
  t1642 = t379 * t1602;
  t1645 = t1589 * params->csk_a;
  t1646 = t1060 * t1645;
  t1650 = t380 * t74 * t170;
  t1651 = t1082 * t1650;
  t1658 = t263 * t380;
  t1661 = t403 * t384 * t1114;
  t1662 = t163 * t1658 * t1661;
  t1664 = t380 * t167;
  t1665 = t379 * t1664;
  t1666 = t624 * t403;
  t1667 = t411 * t1666;
  t1668 = t1665 * t1667;
  t1670 = t263 * t167;
  t1671 = t1670 * t384;
  t1672 = t163 * t1671;
  t1673 = params->csk_a * t380;
  t1674 = t1673 * t403;
  t1675 = t171 * t1674;
  t1676 = t1672 * t1675;
  t1678 = t1658 * t403;
  t1679 = t379 * t1678;
  t1680 = t1679 * t1131;
  t1682 = t1679 * t1115;
  t1684 = my_piecewise3(t67, 0, t1569);
  t1685 = my_piecewise3(t69, t1684, 0);
  t1688 = -t163 * t1685 * t172 + t1125 * t628 - 0.3e1 * t1578 * t1651 + 0.3e1 * t1588 * t1646 + 0.2e1 * t1603 * t630 + 0.3e1 * t1617 * t1626 + 0.3e1 * t1617 * t1651 - 0.2e1 * t1620 * t1634 - t1631 * t642 - 0.2e1 * t1642 * t630 - 0.2e1 * t1642 * t645 + 0.3e1 * t1662 + 0.3e1 * t1668 + 0.3e1 * t1676 - 0.3e1 * t1680 - 0.3e1 * t1682;
  t1690 = my_piecewise5(t64, 0, t67, 0, t1629 + t1688);
  t1692 = t1569 * t77 + 0.2e1 * t161 * t648 + t1690 * t59 + 0.2e1 * t174 * t618 + t260 * t416 + t266 * t373 + t1565;
  t1697 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t268 + t1553 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t650 - t1560 + t1562 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1692);
  tv3rho2sigma0 = t1697 * t8 + 0.2e1 * t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1704 = t7 * t440 * t286;
  t1708 = t7 * t444 * t286 / 0.3e2;
  t1710 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t286 + t1704 / 0.5e1 - t1708);
  tv3rho2sigma2 = t1710 * t8 + 0.2e1 * t664;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1716 = t7 * t465 * t268;
  t1724 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t268 + t1716 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t650 + t1553 / 0.1e2 - t1560 + t1562 / 0.1e2);
  tv3rho2sigma3 = t1724 * t8 + t655 + t670;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t1730 = t7 * t489 * t286;
  t1737 = t7 * t192 * t712;
  t1740 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t286 + t1730 / 0.1e2 + t1704 / 0.1e2 - t1708 + 0.3e1 / 0.2e2 * t7 * t188 * t712 + t1737 / 0.1e2);
  tv3rho2sigma5 = t1740 * t8 + t664 + t717;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t1748 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t268 + t1716 / 0.5e1 - t1560);
  tv3rho2sigma6 = t1748 * t8 + 0.2e1 * t670;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t1760 = 0.55e2 / 0.81e2 * t38 * t544;
  t1761 = t37 * t544;
  t1764 = 0.11e2 / 0.27e2 * t47 * t1761 - t1760;
  t1772 = t695 * t563;
  t1773 = t234 * t1772;
  t1776 = t561 * t1431;
  t1777 = t560 * t1776;
  t1778 = t1445 * t686;
  t1781 = t281 * t1431;
  t1782 = t234 * t1781;
  t1783 = t1435 * t122;
  t1784 = t241 * t561;
  t1785 = t1783 * t1784;
  t1788 = t241 * t580;
  t1789 = t575 * t1788;
  t1791 = t1429 * t1776;
  t1792 = t1439 * t281;
  t1797 = t234 * t695 * t236 * t586;
  t1801 = t234 * t281 * t580 * t586;
  t1803 = t569 * t695;
  t1804 = t592 * t1803;
  t1807 = t1429 * t1781;
  t1809 = t561 * t122 * t241;
  t1810 = t1460 * t1809;
  t1812 = t1445 * t908;
  t1816 = t560 * t1781;
  t1821 = t561 * t567 * t569;
  t1822 = t1460 * t1821;
  t1825 = -t1437 * t1791 * t1792 + t1493 * t687 - t1514 * t704 + 0.2e1 * t1773 * t702 - 0.3e1 * t1777 * t1778 - 0.2e1 * t1782 * t1785 - t1782 * t1810 + t1789 * t690 + 0.3e1 * t1791 * t1812 + 0.2e1 * t1804 * t685 - t1807 * t1810 - 0.3e1 * t1807 * t1822 + 0.3e1 * t1810 * t1816 - 0.2e1 * t1797 - t1801 - t700;
  t1826 = t593 * t580;
  t1827 = t592 * t1826;
  t1829 = t1456 * t561;
  t1830 = t1437 * t1829;
  t1833 = t1792 * params->csk_a;
  t1834 = t1437 * t1833;
  t1842 = t560 * t1772;
  t1845 = t1463 * t1809;
  t1852 = t561 * t238;
  t1853 = t560 * t1852;
  t1854 = t686 * t584;
  t1855 = t592 * t1854;
  t1856 = t1853 * t1855;
  t1858 = t281 * t561;
  t1861 = t584 * t565 * t1499;
  t1862 = t234 * t1858 * t1861;
  t1864 = t1858 * t584;
  t1865 = t560 * t1864;
  t1866 = t1865 * t1509;
  t1868 = t1865 * t1500;
  t1870 = t281 * t238;
  t1871 = t1870 * t565;
  t1872 = t234 * t1871;
  t1874 = params->csk_a * t561 * t584;
  t1875 = t242 * t1874;
  t1876 = t1872 * t1875;
  t1878 = my_piecewise3(t115, 0, t1764);
  t1879 = my_piecewise3(t117, t1878, 0);
  t1882 = -t1879 * t234 * t243 + t1514 * t690 + 0.2e1 * t1773 * t692 - 0.3e1 * t1782 * t1845 + 0.3e1 * t1791 * t1834 - 0.2e1 * t1807 * t1830 + 0.3e1 * t1816 * t1822 + 0.3e1 * t1816 * t1845 - t1827 * t704 - 0.2e1 * t1842 * t692 - 0.2e1 * t1842 * t707 + 0.3e1 * t1856 + 0.3e1 * t1862 - 0.3e1 * t1866 - 0.3e1 * t1868 + 0.3e1 * t1876;
  t1884 = my_piecewise5(t114, 0, t115, 0, t1825 + t1882);
  t1886 = t113 * t1884 + t125 * t1764 + 0.2e1 * t232 * t710 + 0.2e1 * t245 * t680 + t278 * t597 + t284 * t554 + t1760;
  t1891 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t286 + t1730 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t712 - t1708 + t1737 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t1886);
  tv3rho2sigma8 = t8 * t1891 + 0.2e1 * t717;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t1898 = t7 * t345 * t303;
  t1905 = t7 * t354 * t303 / 0.3e2;
  t1907 = t7 * t145 * t754;
  t1922 = t388 * t741;
  t1923 = t411 * t1922;
  t1926 = t1062 * t298;
  t1927 = t1060 * t1926;
  t1929 = t741 * t165;
  t1931 = t163 * t1929 * t405;
  t1933 = t298 * t399;
  t1935 = t163 * t1933 * t405;
  t1937 = t298 * t1040;
  t1938 = t163 * t1937;
  t1941 = t1045 * t732;
  t1944 = t741 * t382;
  t1945 = t163 * t1944;
  t1948 = t732 * t403;
  t1949 = t411 * t1948;
  t1950 = t1665 * t1949;
  t1952 = t298 * t380;
  t1954 = t163 * t1952 * t1661;
  t1956 = t732 * params->csk_a;
  t1957 = t1045 * t1956;
  t1961 = t379 * t1937;
  t1964 = t1038 * t1937;
  t1966 = t1108 * t733 - 0.2e1 * t1938 * t1580 - 0.3e1 * t1584 * t1941 - t1588 * t1927 + 0.3e1 * t1588 * t1957 + t736 * t1600 - t1938 * t1615 + 0.3e1 * t1961 * t1615 - t1964 * t1615 + 0.2e1 * t623 * t1923 + 0.2e1 * t1945 * t640 - 0.2e1 * t1931 - t1935 + 0.3e1 * t1950 + 0.3e1 * t1954 - t746;
  t1973 = t1926 * params->csk_a;
  t1974 = t1060 * t1973;
  t1982 = t379 * t1944;
  t1992 = t379 * t1952 * t403;
  t1993 = t1992 * t1115;
  t1996 = t298 * t167 * t384;
  t1997 = t163 * t1996;
  t1998 = t1997 * t1675;
  t2000 = t1992 * t1131;
  t2004 = my_piecewise3(t67, 0, 0.5e1 / 0.27e2 * t52 * t615);
  t2005 = my_piecewise3(t69, t2004, 0);
  t2008 = -t163 * t172 * t2005 + t1125 * t736 - t1125 * t748 + 0.3e1 * t1588 * t1974 + 0.3e1 * t1626 * t1961 - 0.3e1 * t1626 * t1964 - t1631 * t748 - 0.2e1 * t1634 * t1964 - 0.3e1 * t1651 * t1938 + 0.3e1 * t1651 * t1961 + 0.2e1 * t1945 * t630 - 0.2e1 * t1982 * t630 - 0.2e1 * t1982 * t645 - 0.3e1 * t1993 + 0.3e1 * t1998 - 0.3e1 * t2000;
  t2010 = my_piecewise5(t64, 0, t67, 0, t1966 + t2008);
  t2012 = 0.5e1 / 0.27e2 * t52 * t615 * t77 - 0.5e1 / 0.36e2 * t52 * t257 * t174 + t52 * t291 * t416 / 0.24e2 + t373 * t301 + 0.2e1 * t161 * t752 + t59 * t2010;
  t2017 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t303 + t1898 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t754 - t1905 + t1907 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t2012);
  tv3rho2lapl0 = t2017 * t8 + 0.2e1 * t759;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  t2024 = t7 * t440 * t320;
  t2028 = t7 * t444 * t320 / 0.3e2;
  t2030 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t320 + t2024 / 0.5e1 - t2028);
  tv3rho2lapl1 = t2030 * t8 + 0.2e1 * t768;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 1] += tv3rho2lapl1;

  t2036 = t7 * t465 * t303;
  t2044 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t303 + t2036 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t754 + t1898 / 0.1e2 - t1905 + t1907 / 0.1e2);
  tv3rho2lapl2 = t2044 * t8 + t759 + t774;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 2] += tv3rho2lapl2;

  t2050 = t7 * t489 * t320;
  t2057 = t7 * t192 * t808;
  t2060 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t320 + t2050 / 0.1e2 + t2024 / 0.1e2 - t2028 + 0.3e1 / 0.2e2 * t7 * t188 * t808 + t2057 / 0.1e2);
  tv3rho2lapl3 = t2060 * t8 + t768 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 3] += tv3rho2lapl3;

  t2068 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t303 + t2036 / 0.5e1 - t1905);
  tv3rho2lapl4 = t2068 * t8 + 0.2e1 * t774;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 4] += tv3rho2lapl4;

  t2091 = t795 * t563;
  t2092 = t234 * t2091;
  t2095 = t315 * t580;
  t2097 = t234 * t2095 * t586;
  t2100 = t569 * t795;
  t2101 = t592 * t2100;
  t2104 = t1439 * t315;
  t2105 = t1437 * t2104;
  t2107 = t795 * t236;
  t2109 = t234 * t2107 * t586;
  t2111 = t1445 * t786;
  t2114 = t315 * t1431;
  t2115 = t234 * t2114;
  t2118 = t786 * t584;
  t2119 = t592 * t2118;
  t2120 = t1853 * t2119;
  t2122 = t315 * t561;
  t2124 = t234 * t2122 * t1861;
  t2126 = t786 * params->csk_a;
  t2127 = t1445 * t2126;
  t2131 = t560 * t2114;
  t2134 = t1429 * t2114;
  t2136 = t1493 * t787 - 0.3e1 * t1777 * t2111 - 0.2e1 * t1785 * t2115 + t1789 * t790 - t1791 * t2105 + 0.3e1 * t1791 * t2127 - t1810 * t2115 + 0.3e1 * t1810 * t2131 - t1810 * t2134 + 0.2e1 * t2092 * t702 + 0.2e1 * t2101 * t685 - t2097 - 0.2e1 * t2109 + 0.3e1 * t2120 + 0.3e1 * t2124 - t800;
  t2137 = t2104 * params->csk_a;
  t2138 = t1437 * t2137;
  t2146 = t560 * t2091;
  t2162 = t560 * t2122 * t584;
  t2163 = t2162 * t1500;
  t2166 = t315 * t238 * t565;
  t2167 = t234 * t2166;
  t2168 = t2167 * t1875;
  t2170 = t2162 * t1509;
  t2174 = my_piecewise3(t115, 0, 0.5e1 / 0.27e2 * t52 * t677);
  t2175 = my_piecewise3(t117, t2174, 0);
  t2178 = -t2175 * t234 * t243 + t1514 * t790 - t1514 * t802 + 0.3e1 * t1791 * t2138 + 0.3e1 * t1822 * t2131 - 0.3e1 * t1822 * t2134 - t1827 * t802 - 0.2e1 * t1830 * t2134 - 0.3e1 * t1845 * t2115 + 0.3e1 * t1845 * t2131 + 0.2e1 * t2092 * t692 - 0.2e1 * t2146 * t692 - 0.2e1 * t2146 * t707 - 0.3e1 * t2163 + 0.3e1 * t2168 - 0.3e1 * t2170;
  t2180 = my_piecewise5(t114, 0, t115, 0, t2136 + t2178);
  t2182 = 0.5e1 / 0.27e2 * t52 * t677 * t125 - 0.5e1 / 0.36e2 * t52 * t275 * t245 + t52 * t308 * t597 / 0.24e2 + t554 * t318 + 0.2e1 * t232 * t806 + t113 * t2180;
  t2187 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t320 + t2050 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t808 - t2028 + t2057 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t2182);
  tv3rho2lapl5 = t2187 * t8 + 0.2e1 * t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 5] += tv3rho2lapl5;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  tv3rho2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 1] += tv3rho2tau1;

  tv3rho2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 2] += tv3rho2tau2;

  tv3rho2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 3] += tv3rho2tau3;

  tv3rho2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 4] += tv3rho2tau4;

  tv3rho2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 5] += tv3rho2tau5;

  t2194 = t7 * t145 * t836 / 0.1e2;
  t2200 = t170 * t633;
  t2201 = t394 * t2200;
  t2206 = t165 * t1040;
  t2207 = t1038 * t2206;
  t2208 = t1062 * t817;
  t2209 = t1060 * t2208;
  t2211 = t388 * t824;
  t2212 = t411 * t2211;
  t2213 = t623 * t2212;
  t2214 = t824 * t165;
  t2216 = t163 * t2214 * t405;
  t2217 = t263 * t403;
  t2218 = t163 * t2217;
  t2219 = t168 * t74;
  t2221 = t2218 * t2219 * t2200;
  t2222 = 0.2e1 * t2221;
  t2223 = t824 * t382;
  t2224 = t163 * t2223;
  t2225 = t2224 * t640;
  t2226 = t817 * t1040;
  t2227 = t163 * t2226;
  t2228 = t1050 * t639;
  t2231 = t379 * t2226;
  t2232 = t388 * t165;
  t2233 = t1045 * t2232;
  t2237 = t1050 * t1052 * t165;
  t2241 = t1038 * t2226;
  t2244 = t165 * t74 * t170;
  t2245 = t1082 * t2244;
  t2248 = t2224 * t630;
  t2249 = t379 * t2223;
  t2250 = t2249 * t630;
  t2253 = 0.2e1 * t1608 * t642 + 0.2e1 * t2201 * t628 - t2207 * t2209 - 0.2e1 * t2227 * t2228 - t2227 * t2237 - 0.3e1 * t2227 * t2245 - 0.3e1 * t2231 * t2233 + 0.3e1 * t2231 * t2237 + 0.3e1 * t2231 * t2245 - t2237 * t2241 + t2213 - t2216 - t2222 + t2225 + t2248 - t2250;
  t2254 = t1068 * t165;
  t2255 = t1045 * t2254;
  t2258 = t2249 * t645;
  t2259 = t817 * t403;
  t2260 = t163 * t2259;
  t2262 = t394 * t639 * t167;
  t2263 = t2260 * t2262;
  t2265 = t171 * t633;
  t2266 = t1112 * t2265;
  t2271 = t412 * t633;
  t2272 = t411 * t2271;
  t2275 = t817 * t167;
  t2276 = t379 * t2275;
  t2277 = t2232 * t403;
  t2278 = t411 * t2277;
  t2279 = t2276 * t2278;
  t2281 = t1063 * t165;
  t2282 = t1060 * t2281;
  t2287 = t1078 * t165;
  t2288 = t1060 * t2287;
  t2291 = t1045 * t644;
  t2295 = t379 * t2259 * t384;
  t2296 = params->csk_a * t165;
  t2297 = t2296 * t1114;
  t2298 = t2295 * t2297;
  t2301 = t163 * t2275 * t384;
  t2302 = t2296 * t403;
  t2303 = t171 * t2302;
  t2304 = t2301 * t2303;
  t2306 = t2296 * t167;
  t2307 = t389 * t2306;
  t2308 = t2295 * t2307;
  t2310 = 0.3e1 * t2231 * t2255 - 0.3e1 * t2241 * t2255 + 0.3e1 * t2241 * t2282 - 0.2e1 * t2241 * t2288 + 0.3e1 * t2241 * t2291 + 0.2e1 * t2266 * t628 - 0.2e1 * t2266 * t642 - 0.2e1 * t2272 * t642 - t2258 + 0.3e1 * t2263 + 0.3e1 * t2279 - 0.3e1 * t2298 + 0.3e1 * t2304 - 0.3e1 * t2308 - t826 - t828;
  t2312 = my_piecewise5(t64, 0, t67, 0, t2253 + t2310);
  t2314 = t161 * t834 + t2312 * t59 + 0.2e1 * t260 * t648 + 0.2e1 * t266 * t618;
  t2319 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t836 + t2194 + 0.3e1 / 0.2e2 * t7 * t32 * t2314);
  tv3rhosigma20 = t2319 * t8 + t840;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t2326 = t7 * t192 * t862 / 0.1e2;
  t2328 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t862 + t2326);
  tv3rhosigma25 = t2328 * t8 + t866;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t2334 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t836 + t2194);
  tv3rhosigma26 = t2334 * t8 + t840;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t2344 = t569 * t850;
  t2345 = t592 * t2344;
  t2346 = t685 * t2345;
  t2347 = t850 * t236;
  t2349 = t234 * t2347 * t586;
  t2350 = t281 * t584;
  t2351 = t234 * t2350;
  t2352 = t239 * t122;
  t2353 = t241 * t695;
  t2355 = t2351 * t2352 * t2353;
  t2356 = 0.2e1 * t2355;
  t2357 = t575 * t2353;
  t2360 = t850 * t563;
  t2361 = t234 * t2360;
  t2362 = t2361 * t702;
  t2363 = t843 * t1431;
  t2364 = t234 * t2363;
  t2365 = t1783 * t701;
  t2368 = t560 * t2363;
  t2369 = t569 * t236;
  t2370 = t1445 * t2369;
  t2375 = t236 * t1431;
  t2376 = t1429 * t2375;
  t2377 = t1439 * t843;
  t2378 = t1437 * t2377;
  t2380 = t242 * t695;
  t2381 = t1497 * t2380;
  t2384 = t843 * t238;
  t2385 = t560 * t2384;
  t2386 = t2369 * t584;
  t2387 = t592 * t2386;
  t2388 = t2385 * t2387;
  t2390 = t1429 * t2363;
  t2391 = t1445 * t706;
  t2394 = t241 * t1051;
  t2396 = t1783 * t2394 * t236;
  t2401 = t2361 * t692;
  t2402 = 0.2e1 * t1804 * t704 + 0.2e1 * t2357 * t690 - 0.2e1 * t2364 * t2365 - t2364 * t2396 - 0.3e1 * t2368 * t2370 + 0.3e1 * t2368 * t2396 - t2376 * t2378 - 0.2e1 * t2381 * t704 + 0.3e1 * t2390 * t2391 - t2390 * t2396 + t2346 - t2349 - t2356 + t2362 + 0.3e1 * t2388 + t2401;
  t2403 = t560 * t2360;
  t2404 = t2403 * t692;
  t2406 = t236 * t122 * t241;
  t2407 = t1463 * t2406;
  t2412 = t570 * t236;
  t2413 = t1460 * t2412;
  t2416 = t593 * t695;
  t2417 = t592 * t2416;
  t2420 = t1456 * t236;
  t2421 = t1437 * t2420;
  t2424 = t1440 * t236;
  t2425 = t1437 * t2424;
  t2432 = t2403 * t707;
  t2433 = t843 * t584;
  t2434 = t234 * t2433;
  t2436 = t575 * t701 * t238;
  t2437 = t2434 * t2436;
  t2440 = t560 * t2433 * t565;
  t2441 = params->csk_a * t236;
  t2442 = t2441 * t1499;
  t2443 = t2440 * t2442;
  t2446 = t234 * t2384 * t565;
  t2447 = t2441 * t584;
  t2448 = t242 * t2447;
  t2449 = t2446 * t2448;
  t2451 = t2441 * t238;
  t2452 = t570 * t2451;
  t2453 = t2440 * t2452;
  t2455 = -0.3e1 * t2364 * t2407 + 0.3e1 * t2368 * t2407 + 0.3e1 * t2368 * t2413 + 0.2e1 * t2381 * t690 - 0.3e1 * t2390 * t2413 - 0.2e1 * t2390 * t2421 + 0.3e1 * t2390 * t2425 - 0.2e1 * t2417 * t704 - t2404 - t2432 + 0.3e1 * t2437 - 0.3e1 * t2443 + 0.3e1 * t2449 - 0.3e1 * t2453 - t852 - t854;
  t2457 = my_piecewise5(t114, 0, t115, 0, t2402 + t2455);
  t2459 = t113 * t2457 + t232 * t860 + 0.2e1 * t278 * t710 + 0.2e1 * t284 * t680;
  t2464 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t862 + t2326 + 0.3e1 / 0.2e2 * t7 * t94 * t2459);
  tv3rhosigma211 = t2464 * t8 + t866;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t2471 = t7 * t145 * t888 / 0.1e2;
  t2483 = t741 * t263;
  t2485 = t163 * t2483 * t405;
  t2486 = t298 * t633;
  t2488 = t163 * t2486 * t405;
  t2495 = t1589 * t298;
  t2496 = t1060 * t2495;
  t2500 = t1642 * t733 + t1923 * t642 + t1945 * t873 + t1945 * t879 - t1982 * t873 - t1982 * t883 + t2201 * t736 - t2207 * t2496 + t2266 * t736 - t2266 * t748 - t2272 * t748 + t2213 - t2216 + t2225 + t2248 - t2250 - t2485 - t2488 - t877;
  t2501 = t1937 * t1044;
  t2502 = t379 * t2501;
  t2503 = t171 * t263;
  t2504 = t2296 * t2503;
  t2507 = t163 * t2501;
  t2510 = t875 * t403;
  t2511 = t163 * t2510;
  t2512 = t2511 * t2262;
  t2514 = t1038 * t2501;
  t2515 = t1051 * t263;
  t2516 = t389 * t165;
  t2517 = t2515 * t2516;
  t2520 = t2515 * t165;
  t2521 = t1136 * t2520;
  t2524 = t379 * t1671;
  t2526 = t389 * t744 * t403;
  t2527 = t2524 * t2526;
  t2529 = t1577 * t1044;
  t2530 = t1038 * t2529;
  t2531 = t298 * params->csk_a;
  t2532 = t2531 * t165;
  t2533 = t1136 * t2532;
  t2538 = t389 * t2532;
  t2541 = t171 * t2520;
  t2546 = t379 * t2510;
  t2548 = t1112 * t165 * t1114;
  t2549 = t2546 * t2548;
  t2551 = t171 * params->csk_a;
  t2552 = t636 * t403;
  t2553 = t2551 * t2552;
  t2554 = t1997 * t2553;
  t2556 = t411 * t388;
  t2557 = t2556 * t2306;
  t2558 = t2546 * t2557;
  t2560 = t878 * t165;
  t2561 = t1050 * t2560;
  t2564 = t732 * t165;
  t2565 = t1045 * t2564;
  t2568 = -0.3e1 * t1617 * t2565 - 0.2e1 * t1938 * t2561 + 0.3e1 * t2502 * t2504 + 0.3e1 * t2502 * t2517 + 0.3e1 * t2502 * t2541 - 0.3e1 * t2504 * t2507 - t2507 * t2541 - 0.3e1 * t2514 * t2517 - 0.2e1 * t2514 * t2521 - t2514 * t2541 + 0.3e1 * t2530 * t2533 + 0.3e1 * t2530 * t2538 - t2258 + 0.3e1 * t2512 + 0.3e1 * t2527 - 0.3e1 * t2549 + 0.3e1 * t2554 - 0.3e1 * t2558 - t826;
  t2570 = my_piecewise5(t64, 0, t67, 0, t2500 + t2568);
  t2572 = -0.5e1 / 0.72e2 * t52 * t257 * t266 + t52 * t291 * t648 / 0.24e2 + t618 * t301 + t260 * t752 + t161 * t886 + t59 * t2570;
  t2577 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t888 + t2471 + 0.3e1 / 0.2e2 * t7 * t32 * t2572);
  tv3rhosigmalapl0 = t2577 * t8 + t892;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  t2584 = t7 * t192 * t914 / 0.1e2;
  t2586 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t914 + t2584);
  tv3rhosigmalapl5 = t2586 * t8 + t918;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  t2592 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t888 + t2471);
  tv3rhosigmalapl6 = t2592 * t8 + t892;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  t2608 = t795 * t281;
  t2610 = t234 * t2608 * t586;
  t2611 = t315 * t695;
  t2613 = t234 * t2611 * t586;
  t2616 = t2114 * t1435;
  t2617 = t560 * t2616;
  t2618 = t242 * t281;
  t2619 = t2441 * t2618;
  t2622 = t234 * t2616;
  t2625 = t1429 * t2616;
  t2626 = t1051 * t281;
  t2627 = t2626 * t236;
  t2628 = t1521 * t2627;
  t2631 = t570 * t2627;
  t2634 = t901 * t584;
  t2635 = t234 * t2634;
  t2636 = t2635 * t2436;
  t2640 = t1842 * t787 + t2092 * t905 + t2101 * t704 + t2357 * t790 + 0.3e1 * t2617 * t2619 + 0.3e1 * t2617 * t2631 - 0.3e1 * t2619 * t2622 - 0.2e1 * t2625 * t2628 - 0.3e1 * t2625 * t2631 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2610 - t2613 + 0.3e1 * t2636 - t903;
  t2641 = t560 * t1871;
  t2643 = t570 * t798 * t584;
  t2644 = t2641 * t2643;
  t2646 = t1781 * t1435;
  t2647 = t1429 * t2646;
  t2648 = t315 * params->csk_a;
  t2649 = t2648 * t236;
  t2650 = t1521 * t2649;
  t2653 = t2626 * t2406;
  t2655 = t570 * t2649;
  t2661 = t560 * t2634;
  t2663 = t1497 * t236 * t1499;
  t2664 = t2661 * t2663;
  t2666 = t242 * params->csk_a;
  t2667 = t698 * t584;
  t2668 = t2666 * t2667;
  t2669 = t2167 * t2668;
  t2671 = t592 * t569;
  t2672 = t2671 * t2451;
  t2673 = t2661 * t2672;
  t2675 = t904 * t236;
  t2676 = t1783 * t2675;
  t2679 = t786 * t236;
  t2680 = t1445 * t2679;
  t2689 = t1792 * t315;
  t2690 = t1437 * t2689;
  t2692 = -0.3e1 * t1816 * t2680 + t2092 * t899 - 0.2e1 * t2115 * t2676 - t2146 * t899 - t2146 * t909 - t2376 * t2690 + t2381 * t790 - t2381 * t802 - t2417 * t802 + 0.3e1 * t2617 * t2653 - t2622 * t2653 - t2625 * t2653 + 0.3e1 * t2647 * t2650 + 0.3e1 * t2647 * t2655 + 0.3e1 * t2644 - 0.3e1 * t2664 + 0.3e1 * t2669 - 0.3e1 * t2673 - t852;
  t2694 = my_piecewise5(t114, 0, t115, 0, t2640 + t2692);
  t2696 = -0.5e1 / 0.72e2 * t52 * t275 * t284 + t52 * t308 * t710 / 0.24e2 + t680 * t318 + t278 * t806 + t232 * t912 + t113 * t2694;
  t2701 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t914 + t2584 + 0.3e1 / 0.2e2 * t7 * t94 * t2696);
  tv3rhosigmalapl11 = t2701 * t8 + t918;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 4] += tv3rhosigmatau4;

  tv3rhosigmatau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 5] += tv3rhosigmatau5;

  tv3rhosigmatau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 10] += tv3rhosigmatau10;

  tv3rhosigmatau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2708 = t7 * t145 * t937 / 0.1e2;
  t2716 = t922 * t1040;
  t2717 = t379 * t2716;
  t2720 = t163 * t2716;
  t2723 = t298 * t403;
  t2724 = t163 * t2723;
  t2725 = t170 * t741;
  t2727 = t2724 * t2219 * t2725;
  t2728 = 0.2e1 * t2727;
  t2734 = t1062 * t922;
  t2735 = t1060 * t2734;
  t2737 = t922 * t403;
  t2739 = t379 * t2737 * t384;
  t2740 = t2739 * t2297;
  t2742 = t922 * t167;
  t2744 = t163 * t2742 * t384;
  t2745 = t2744 * t2303;
  t2747 = t2739 * t2307;
  t2749 = t1038 * t2716;
  t2752 = 0.2e1 * t2725 * t394 * t736 + 0.2e1 * t1923 * t748 - t2207 * t2735 - 0.2e1 * t2228 * t2720 - 0.3e1 * t2233 * t2717 + 0.3e1 * t2291 * t2749 + t2213 - t2216 + t2225 + t2248 - t2250 - t2258 - t2728 - 0.3e1 * t2740 + 0.3e1 * t2745 - 0.3e1 * t2747;
  t2761 = t412 * t741;
  t2769 = t395 * t741;
  t2770 = t394 * t2769;
  t2775 = t163 * t2737;
  t2776 = t2775 * t2262;
  t2782 = t379 * t2742;
  t2783 = t2782 * t2278;
  t2785 = -0.2e1 * t2761 * t411 * t748 + 0.3e1 * t2237 * t2717 - t2237 * t2720 - t2237 * t2749 + 0.3e1 * t2245 * t2717 - 0.3e1 * t2245 * t2720 + 0.3e1 * t2255 * t2717 - 0.3e1 * t2255 * t2749 + 0.3e1 * t2282 * t2749 - 0.2e1 * t2288 * t2749 + 0.2e1 * t2770 * t736 - 0.2e1 * t2770 * t748 + 0.3e1 * t2776 + 0.3e1 * t2783 - t826 - t929;
  t2787 = my_piecewise5(t64, 0, t67, 0, t2752 + t2785);
  t2789 = -0.5e1 / 0.36e2 * t52 * t257 * t301 + t52 * t291 * t752 / 0.12e2 + t161 * t935 + t59 * t2787;
  t2794 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t937 + t2708 + 0.3e1 / 0.2e2 * t7 * t32 * t2789);
  tv3rholapl20 = t2794 * t8 + t941;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 1] += tv3rholapl21;

  t2801 = t7 * t192 * t960 / 0.1e2;
  t2803 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t960 + t2801);
  tv3rholapl22 = t2803 * t8 + t964;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 2] += tv3rholapl22;

  t2809 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t937 + t2708);
  tv3rholapl23 = t2809 * t8 + t941;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 4] += tv3rholapl24;

  t2821 = t241 * t795;
  t2825 = t945 * t1431;
  t2826 = t234 * t2825;
  t2829 = t560 * t2825;
  t2834 = t1439 * t945;
  t2835 = t1437 * t2834;
  t2837 = t315 * t584;
  t2838 = t234 * t2837;
  t2840 = t2838 * t2352 * t2821;
  t2841 = 0.2e1 * t2840;
  t2842 = t945 * t584;
  t2844 = t560 * t2842 * t565;
  t2845 = t2844 * t2442;
  t2847 = t945 * t238;
  t2849 = t234 * t2847 * t565;
  t2850 = t2849 * t2448;
  t2852 = t2844 * t2452;
  t2854 = 0.2e1 * t2821 * t575 * t790 + 0.2e1 * t2101 * t802 - 0.2e1 * t2365 * t2826 - 0.3e1 * t2370 * t2829 - t2376 * t2835 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2841 - 0.3e1 * t2845 + 0.3e1 * t2850 - 0.3e1 * t2852 - t952;
  t2855 = t242 * t795;
  t2856 = t1497 * t2855;
  t2859 = t1429 * t2825;
  t2862 = t593 * t795;
  t2866 = t560 * t2847;
  t2867 = t2866 * t2387;
  t2887 = t234 * t2842;
  t2888 = t2887 * t2436;
  t2890 = -0.2e1 * t2862 * t592 * t802 + 0.3e1 * t2391 * t2859 - t2396 * t2826 + 0.3e1 * t2396 * t2829 - t2396 * t2859 - 0.3e1 * t2407 * t2826 + 0.3e1 * t2407 * t2829 + 0.3e1 * t2413 * t2829 - 0.3e1 * t2413 * t2859 - 0.2e1 * t2421 * t2859 + 0.3e1 * t2425 * t2859 + 0.2e1 * t2856 * t790 - 0.2e1 * t2856 * t802 + 0.3e1 * t2867 + 0.3e1 * t2888 - t852;
  t2892 = my_piecewise5(t114, 0, t115, 0, t2854 + t2890);
  t2894 = -0.5e1 / 0.36e2 * t52 * t275 * t318 + t52 * t308 * t806 / 0.12e2 + t232 * t958 + t113 * t2892;
  t2899 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t960 + t2801 + 0.3e1 / 0.2e2 * t7 * t94 * t2894);
  tv3rholapl25 = t2899 * t8 + t964;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 7] += tv3rholapltau7;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 1] += tv3rhotau21;

  tv3rhotau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 2] += tv3rhotau22;

  tv3rhotau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 4] += tv3rhotau24;

  tv3rhotau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 5] += tv3rhotau25;

  t2903 = t817 * t263;
  t2904 = t2903 * t1040;
  t2905 = t1038 * t2904;
  t2910 = t2903 * t167;
  t2912 = t379 * t2910 * t1091;
  t2913 = 0.3e1 * t2912;
  t2914 = t2224 * t879;
  t2915 = 0.3e1 * t2914;
  t2916 = t2903 * t403;
  t2917 = t163 * t2916;
  t2918 = t2917 * t1101;
  t2919 = 0.3e1 * t2918;
  t2920 = t642 * t2212;
  t2921 = 0.3e1 * t2920;
  t2924 = t379 * t2904;
  t2927 = t824 * t263;
  t2929 = t163 * t2927 * t405;
  t2930 = 0.3e1 * t2929;
  t2933 = t163 * t2904;
  t2938 = 0.3e1 * t1046 * t2905 - t1053 * t2905 + 0.3e1 * t1053 * t2924 - t1053 * t2933 + 0.3e1 * t1064 * t2905 - 0.3e1 * t1069 * t2905 + 0.3e1 * t1069 * t2924 - 0.2e1 * t1079 * t2905 + t2913 + t2915 + t2919 + t2921 - t2930;
  t2951 = t2249 * t873;
  t2952 = 0.3e1 * t2951;
  t2953 = t379 * t2916;
  t2954 = t2953 * t1115;
  t2955 = 0.3e1 * t2954;
  t2957 = t163 * t2910 * t1120;
  t2958 = 0.3e1 * t2957;
  t2959 = t395 * t824;
  t2960 = t394 * t2959;
  t2961 = t628 * t2960;
  t2962 = 0.3e1 * t2961;
  t2963 = t2249 * t883;
  t2964 = 0.3e1 * t2963;
  t2965 = t2953 * t1131;
  t2966 = 0.3e1 * t2965;
  t2967 = -t1038 * t1137 * t2903 - 0.3e1 * t1144 * t2903 * t379 - 0.2e1 * t1148 * t163 * t2903 + 0.3e1 * t1083 * t2924 - 0.3e1 * t1083 * t2933 - t2952 - t2955 + t2958 + t2962 - t2964 - t2966 - t826 - t828;
  t2969 = my_piecewise5(t64, 0, t67, 0, t2938 + t2967);
  t2971 = 0.3e1 * t260 * t834 + t2969 * t59;
  t2975 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t2971);
  tv3sigma30 = t8 * t2975;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t2978 = t843 * t281;
  t2979 = t2978 * t1431;
  t2980 = t234 * t2979;
  t2983 = t1429 * t2979;
  t2988 = t704 * t2345;
  t2989 = 0.3e1 * t2988;
  t2992 = t560 * t2979;
  t2995 = t850 * t281;
  t2997 = t234 * t2995 * t586;
  t2998 = 0.3e1 * t2997;
  t2999 = t2978 * t238;
  t3001 = t560 * t2999 * t1473;
  t3002 = 0.3e1 * t3001;
  t3003 = t2361 * t905;
  t3004 = 0.3e1 * t3003;
  t3005 = t2978 * t584;
  t3006 = t234 * t3005;
  t3007 = t3006 * t1483;
  t3008 = 0.3e1 * t3007;
  t3014 = 0.3e1 * t1441 * t2983 - 0.3e1 * t1447 * t2983 + 0.3e1 * t1447 * t2992 - 0.2e1 * t1457 * t2983 - t1461 * t2980 + 0.3e1 * t1461 * t2992 - 0.3e1 * t1464 * t2980 + 0.3e1 * t1486 * t2983 + t2989 - t2998 + t3002 + t3004 + t3008;
  t3026 = t2403 * t909;
  t3027 = 0.3e1 * t3026;
  t3028 = t560 * t3005;
  t3029 = t3028 * t1509;
  t3030 = 0.3e1 * t3029;
  t3031 = t2403 * t899;
  t3032 = 0.3e1 * t3031;
  t3033 = t3028 * t1500;
  t3034 = 0.3e1 * t3033;
  t3036 = t234 * t2999 * t1505;
  t3037 = 0.3e1 * t3036;
  t3038 = t576 * t850;
  t3039 = t575 * t3038;
  t3040 = t690 * t3039;
  t3041 = 0.3e1 * t3040;
  t3042 = -t1429 * t1522 * t2978 - 0.2e1 * t1529 * t234 * t2978 - 0.3e1 * t1533 * t2978 * t560 - t1461 * t2983 + 0.3e1 * t1464 * t2992 - t3027 - t3030 - t3032 - t3034 + t3037 + t3041 - t852 - t854;
  t3044 = my_piecewise5(t114, 0, t115, 0, t3014 + t3042);
  t3046 = t113 * t3044 + 0.3e1 * t278 * t860;
  t3050 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3046);
  tv3sigma39 = t8 * t3050;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  t3056 = t2249 * t733;
  t3058 = t298 * t824;
  t3060 = t163 * t3058 * t405;
  t3063 = t170 * t817;
  t3064 = t1050 * t3063;
  t3067 = t170 * t824;
  t3068 = t394 * t3067;
  t3069 = t736 * t3068;
  t3070 = 0.2e1 * t2914;
  t3071 = 0.2e1 * t2920;
  t3072 = 0.2e1 * t2929;
  t3073 = t298 * t817;
  t3074 = t3073 * t403;
  t3075 = t379 * t3074;
  t3076 = t3075 * t1115;
  t3077 = 0.3e1 * t3076;
  t3078 = params->csk_a * t817;
  t3079 = t3078 * t403;
  t3080 = t171 * t3079;
  t3081 = t1997 * t3080;
  t3082 = 0.3e1 * t3081;
  t3083 = t3075 * t1131;
  t3084 = 0.3e1 * t3083;
  t3085 = t412 * t824;
  t3086 = t411 * t3085;
  t3087 = t748 * t3086;
  t3088 = t1078 * t817;
  t3089 = t1060 * t3088;
  t3094 = -t1927 * t2241 - 0.2e1 * t1938 * t3064 - 0.3e1 * t1941 * t2231 - 0.2e1 * t1964 * t3089 + 0.3e1 * t1974 * t2241 + t3056 - t3060 + t3069 + t3070 + t3071 - t3072 - t3077 + t3082 - t3084 - t3087 - t877;
  t3095 = t736 * t2960;
  t3096 = t1068 * t817;
  t3097 = t1045 * t3096;
  t3101 = t817 * t74 * t170;
  t3102 = t1082 * t3101;
  t3107 = t1623 * t3101;
  t3114 = t2276 * t1949;
  t3115 = 0.3e1 * t3114;
  t3116 = t163 * t3073;
  t3117 = t3116 * t1661;
  t3118 = 0.3e1 * t3117;
  t3119 = t748 * t2960;
  t3122 = 0.2e1 * t2951;
  t3123 = 0.2e1 * t2961;
  t3124 = 0.2e1 * t2963;
  t3125 = -0.3e1 * t1938 * t3102 - t1938 * t3107 + 0.3e1 * t1957 * t2241 + 0.3e1 * t1961 * t3097 + 0.3e1 * t1961 * t3102 + 0.3e1 * t1961 * t3107 - 0.3e1 * t1964 * t3097 - t1964 * t3107 + t3095 + t3115 + t3118 - t3119 - t3122 + t3123 - t3124 - t826;
  t3127 = my_piecewise5(t64, 0, t67, 0, t3094 + t3125);
  t3129 = t52 * t291 * t834 / 0.24e2 + 0.2e1 * t260 * t886 + t59 * t3127;
  t3133 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3129);
  tv3sigma2lapl0 = t8 * t3133;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 10] += tv3sigma2lapl10;

  t3141 = t241 * t843;
  t3142 = t1783 * t3141;
  t3145 = t241 * t850;
  t3146 = t575 * t3145;
  t3147 = t790 * t3146;
  t3148 = t2403 * t787;
  t3150 = t315 * t850;
  t3152 = t234 * t3150 * t586;
  t3153 = 0.2e1 * t2988;
  t3154 = 0.2e1 * t2997;
  t3155 = 0.2e1 * t3003;
  t3156 = t315 * t843;
  t3157 = t3156 * t584;
  t3158 = t560 * t3157;
  t3159 = t3158 * t1500;
  t3160 = 0.3e1 * t3159;
  t3161 = params->csk_a * t843;
  t3162 = t3161 * t584;
  t3163 = t242 * t3162;
  t3164 = t2167 * t3163;
  t3165 = 0.3e1 * t3164;
  t3166 = t3158 * t1509;
  t3167 = 0.3e1 * t3166;
  t3168 = t576 * t843;
  t3169 = t1783 * t3168;
  t3175 = t1783 * t2394 * t843;
  t3177 = -t2105 * t2390 - 0.3e1 * t2111 * t2368 - 0.2e1 * t2115 * t3142 - 0.3e1 * t2115 * t3169 - t2115 * t3175 + 0.3e1 * t2127 * t2390 + t3147 + t3148 - t3152 + t3153 - t3154 + t3155 - t3160 + t3165 - t3167 - t903;
  t3181 = t234 * t3156;
  t3182 = t3181 * t1861;
  t3183 = 0.3e1 * t3182;
  t3184 = t802 * t3039;
  t3186 = t843 * t567 * t569;
  t3187 = t1460 * t3186;
  t3190 = t593 * t850;
  t3191 = t592 * t3190;
  t3192 = t802 * t3191;
  t3193 = t1456 * t843;
  t3194 = t1437 * t3193;
  t3199 = t790 * t3039;
  t3204 = t2385 * t2119;
  t3205 = 0.3e1 * t3204;
  t3206 = 0.2e1 * t3026;
  t3207 = 0.2e1 * t3031;
  t3208 = 0.2e1 * t3040;
  t3209 = 0.3e1 * t2131 * t3169 + 0.3e1 * t2131 * t3175 + 0.3e1 * t2131 * t3187 - t2134 * t3175 - 0.3e1 * t2134 * t3187 - 0.2e1 * t2134 * t3194 + 0.3e1 * t2138 * t2390 + t3183 - t3184 - t3192 + t3199 + t3205 - t3206 - t3207 + t3208 - t852;
  t3211 = my_piecewise5(t114, 0, t115, 0, t3177 + t3209);
  t3213 = t52 * t308 * t860 / 0.24e2 + 0.2e1 * t278 * t912 + t113 * t3211;
  t3217 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3213);
  tv3sigma2lapl11 = t8 * t3217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 11] += tv3sigma2lapl11;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 10] += tv3sigma2tau10;

  tv3sigma2tau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 11] += tv3sigma2tau11;

  t3228 = 0.2e1 * t3056;
  t3229 = 0.2e1 * t3060;
  t3230 = 0.2e1 * t3069;
  t3231 = params->csk_a * t263;
  t3232 = t3231 * t403;
  t3234 = t2744 * t171 * t3232;
  t3235 = 0.3e1 * t3234;
  t3236 = t3231 * t167;
  t3238 = t2739 * t389 * t3236;
  t3239 = 0.3e1 * t3238;
  t3243 = t1050 * t1052 * t263;
  t3248 = t1082 * t2503;
  t3251 = -0.2e1 * t1050 * t2720 * t878 - 0.3e1 * t1585 * t2717 + 0.3e1 * t1611 * t2749 - t1620 * t2735 + 0.3e1 * t2717 * t3243 + 0.3e1 * t2717 * t3248 - t2720 * t3243 - t2749 * t3243 + t2914 + t2920 - t2929 + t3228 - t3229 + t3230 + t3235 - t3239;
  t3252 = t389 * t263;
  t3253 = t1623 * t3252;
  t3256 = t1078 * t263;
  t3260 = t2782 * t1667;
  t3261 = 0.3e1 * t3260;
  t3268 = t2775 * t394 * t878 * t167;
  t3269 = 0.3e1 * t3268;
  t3272 = 0.2e1 * t3087;
  t3273 = 0.2e1 * t3095;
  t3274 = 0.2e1 * t3119;
  t3276 = t2739 * t3231 * t1114;
  t3277 = 0.3e1 * t3276;
  t3278 = -0.2e1 * t1060 * t2749 * t3256 + 0.3e1 * t1646 * t2749 + 0.3e1 * t2717 * t3253 - 0.3e1 * t2720 * t3248 - 0.3e1 * t2749 * t3253 - t2951 + t2961 - t2963 + t3261 + t3269 - t3272 + t3273 - t3274 - t3277 - t826 - t929;
  t3280 = my_piecewise5(t64, 0, t67, 0, t3251 + t3278);
  t3282 = t52 * t291 * t886 / 0.12e2 + t260 * t935 + t59 * t3280;
  t3286 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3282);
  tv3sigmalapl20 = t8 * t3286;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 7] += tv3sigmalapl27;

  t3297 = 0.2e1 * t3147;
  t3298 = 0.2e1 * t3148;
  t3299 = 0.2e1 * t3152;
  t3300 = params->csk_a * t281;
  t3302 = t2844 * t3300 * t1499;
  t3303 = 0.3e1 * t3302;
  t3304 = t1456 * t281;
  t3308 = t2866 * t1855;
  t3309 = 0.3e1 * t3308;
  t3312 = t1446 * t281;
  t3313 = t1445 * t3312;
  t3318 = t2887 * t575 * t904 * t238;
  t3319 = 0.3e1 * t3318;
  t3320 = -0.2e1 * t1437 * t2859 * t3304 - 0.2e1 * t1783 * t2826 * t904 - 0.3e1 * t1778 * t2829 - t1807 * t2835 + 0.3e1 * t1834 * t2859 + 0.3e1 * t2829 * t3313 + t2988 - t2997 + t3003 + t3297 + t3298 - t3299 - t3303 + t3309 + t3319 - t952;
  t3321 = t1783 * t898;
  t3326 = t2394 * t281;
  t3327 = t1783 * t3326;
  t3336 = 0.2e1 * t3184;
  t3337 = 0.2e1 * t3192;
  t3338 = 0.2e1 * t3199;
  t3339 = t3300 * t584;
  t3340 = t242 * t3339;
  t3341 = t2849 * t3340;
  t3342 = 0.3e1 * t3341;
  t3343 = t3300 * t238;
  t3345 = t2844 * t570 * t3343;
  t3346 = 0.3e1 * t3345;
  t3347 = 0.3e1 * t1812 * t2859 - 0.3e1 * t2826 * t3321 - t2826 * t3327 + 0.3e1 * t2829 * t3321 + 0.3e1 * t2829 * t3327 - 0.3e1 * t2859 * t3313 - t2859 * t3327 - t3026 - t3031 + t3040 - t3336 - t3337 + t3338 + t3342 - t3346 - t852;
  t3349 = my_piecewise5(t114, 0, t115, 0, t3320 + t3347);
  t3351 = t52 * t308 * t912 / 0.12e2 + t278 * t958 + t113 * t3349;
  t3355 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3351);
  tv3sigmalapl28 = t8 * t3355;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 7] += tv3sigmatau27;

  tv3sigmatau28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 8] += tv3sigmatau28;

  t3359 = 0.3e1 * t3056;
  t3360 = 0.3e1 * t3060;
  t3361 = 0.3e1 * t3069;
  t3362 = t922 * t298;
  t3371 = t3362 * t403;
  t3372 = t379 * t3371;
  t3373 = t3372 * t1115;
  t3374 = 0.3e1 * t3373;
  t3375 = t3372 * t1131;
  t3376 = 0.3e1 * t3375;
  t3377 = t3362 * t167;
  t3379 = t163 * t3377 * t1120;
  t3380 = 0.3e1 * t3379;
  t3381 = 0.3e1 * t3087;
  t3382 = 0.3e1 * t3095;
  t3383 = 0.3e1 * t3119;
  t3384 = -t1038 * t1137 * t3362 - 0.3e1 * t1144 * t3362 * t379 - 0.2e1 * t1148 * t163 * t3362 + t3359 - t3360 + t3361 - t3374 - t3376 + t3380 - t3381 + t3382 - t3383 - t826;
  t3386 = t379 * t3377 * t1091;
  t3387 = 0.3e1 * t3386;
  t3389 = t163 * t3371 * t1101;
  t3390 = 0.3e1 * t3389;
  t3391 = t3362 * t1040;
  t3392 = t163 * t3391;
  t3395 = t1038 * t3391;
  t3402 = t379 * t3391;
  t3413 = 0.3e1 * t1046 * t3395 - t1053 * t3392 - t1053 * t3395 + 0.3e1 * t1053 * t3402 + 0.3e1 * t1064 * t3395 - 0.3e1 * t1069 * t3395 + 0.3e1 * t1069 * t3402 - 0.2e1 * t1079 * t3395 - 0.3e1 * t1083 * t3392 + 0.3e1 * t1083 * t3402 + t3387 + t3390 - t929;
  t3415 = my_piecewise5(t64, 0, t67, 0, t3384 + t3413);
  t3417 = t52 * t291 * t935 / 0.8e1 + t59 * t3415;
  t3421 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3417);
  tv3lapl30 = t8 * t3421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 2] += tv3lapl32;

  t3425 = 0.3e1 * t3147;
  t3426 = 0.3e1 * t3148;
  t3427 = 0.3e1 * t3152;
  t3428 = t945 * t315;
  t3437 = t3428 * t584;
  t3438 = t560 * t3437;
  t3439 = t3438 * t1500;
  t3440 = 0.3e1 * t3439;
  t3441 = t3438 * t1509;
  t3442 = 0.3e1 * t3441;
  t3443 = t3428 * t238;
  t3445 = t234 * t3443 * t1505;
  t3446 = 0.3e1 * t3445;
  t3447 = 0.3e1 * t3184;
  t3448 = 0.3e1 * t3192;
  t3449 = 0.3e1 * t3199;
  t3450 = -t1429 * t1522 * t3428 - 0.2e1 * t1529 * t234 * t3428 - 0.3e1 * t1533 * t3428 * t560 + t3425 + t3426 - t3427 - t3440 - t3442 + t3446 - t3447 - t3448 + t3449 - t952;
  t3451 = t3428 * t1431;
  t3452 = t560 * t3451;
  t3455 = t1429 * t3451;
  t3460 = t234 * t3437;
  t3461 = t3460 * t1483;
  t3462 = 0.3e1 * t3461;
  t3464 = t560 * t3443 * t1473;
  t3465 = 0.3e1 * t3464;
  t3466 = t234 * t3451;
  t3479 = 0.3e1 * t1441 * t3455 + 0.3e1 * t1447 * t3452 - 0.3e1 * t1447 * t3455 - 0.2e1 * t1457 * t3455 + 0.3e1 * t1461 * t3452 - t1461 * t3455 - t1461 * t3466 + 0.3e1 * t1464 * t3452 - 0.3e1 * t1464 * t3466 + 0.3e1 * t1486 * t3455 + t3462 + t3465 - t852;
  t3481 = my_piecewise5(t114, 0, t115, 0, t3450 + t3479);
  t3483 = t52 * t308 * t958 / 0.8e1 + t113 * t3481;
  t3487 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3483);
  tv3lapl33 = t8 * t3487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 5] += tv3lapltau25;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 2] += tv3tau32;

  tv3tau33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 3] += tv3tau33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t12;
  double t13, t16, t17, t18, t20, t21, t22, t23;
  double t24, t25, t26, t27, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t40;
  double t41, t43, t46, t47, t48, t52, t53, t55;
  double t59, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75;
  double t76, t77, t79, t83, t84, t85, t87, t88;
  double t89, t90, t91, t93, t94, t95, t96, t97;
  double t99, t102, t103, t107, t109, t113, t114, t115;
  double t116, t117, t118, t119, t120, t121, t122, t123;
  double t124, t125, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t148, t151, t154, t161, t163, t164, t165, t167;
  double t168, t170, t171, t172, t174, t176, t181, t182;
  double t184, t187, t188, t192, t195, t197, tvrho0, t201;
  double t204, t205, t210, t212, t215, t216, t222, t225;
  double t232, t234, t235, t236, t238, t239, t241, t242;
  double t243, t245, t247, t252, tvrho1, t256, t257, t260;
  double t262, t263, t266, t268, t272, tvsigma0, tvsigma1, t274;
  double t275, t278, t280, t281, t284, t286, t290, tvsigma2;
  double t291, t297, t298, t301, t303, t307, tvlapl0, t308;
  double t314, t315, t318, t320, t324, tvlapl1, tvtau0, tvtau1;

  double t327, t328, t331, t332, t333, t336, t340, t341;
  double t345, t347, t353, t354, t357, t359, t361, t363;
  double t366, t373, t377, t379, t380, t382, t383, t384;
  double t385, t386, t387, t388, t389, t390, t392, t394;
  double t395, t396, t398, t399, t402, t403, t405, t406;
  double t407, t409, t411, t412, t413, t416, t418, t423;
  double t424, t425, t428, t431, t435, t436, t440, t442;
  double t444, t447, t449, tv2rho20, t452, t456, t460, t461;
  double t465, t467, t475, t476, t480, t484, t485, t489;
  double t491, t498, t501, tv2rho21, t506, t511, t515, t516;
  double t522, t523, t528, t532, t533, t542, t544, t547;
  double t554, t558, t560, t561, t563, t564, t565, t566;
  double t567, t568, t569, t570, t571, t573, t575, t576;
  double t577, t579, t580, t583, t584, t586, t587, t588;
  double t590, t592, t593, t594, t597, t599, t604, tv2rho22;
  double t612, t614, t615, t618, t622, t623, t624, t625;
  double t627, t628, t629, t630, t632, t633, t636, t638;
  double t639, t640, t642, t644, t645, t648, t650, t655;
  double tv2rhosigma0, tv2rhosigma1, t662, t664, tv2rhosigma2, t670, tv2rhosigma3, tv2rhosigma4;
  double t676, t677, t680, t684, t685, t686, t687, t689;
  double t690, t692, t694, t695, t698, t700, t701, t702;
  double t704, t706, t707, t710, t712, t717, tv2rhosigma5, t724;
  double t732, t733, t735, t736, t740, t741, t744, t746;
  double t748, t752, t754, t759, tv2rholapl0, t766, t768, tv2rholapl1;
  double t774, tv2rholapl2, t786, t787, t789, t790, t794, t795;
  double t798, t800, t802, t806, t808, t813, tv2rholapl3, tv2rhotau0;
  double tv2rhotau1, tv2rhotau2, tv2rhotau3, t817, t820, t823, t824, t826;
  double t827, t828, t830, t834, t836, t840, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t843, t846, t849, t850, t852;
  double t853, t854, t856, t860, t862, t866, tv2sigma25, t872;
  double t873, t875, t876, t877, t878, t879, t882, t883;
  double t886, t888, t892, tv2sigmalapl0, tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4;
  double t898, t899, t901, t902, t903, t904, t905, t908;
  double t909, t912, t914, t918, tv2sigmalapl5, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2;
  double tv2sigmatau3, tv2sigmatau4, tv2sigmatau5, t922, t925, t926, t928, t929;
  double t931, t935, t937, t941, tv2lapl20, tv2lapl21, t945, t948;
  double t949, t951, t952, t954, t958, t960, t964, tv2lapl22;
  double tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3, tv2tau20, tv2tau21, tv2tau22;

  double t968, t969, t972, t975, t976, t977, t980, t984;
  double t985, t989, t991, t996, t998, t1001, t1007, t1008;
  double t1011, t1013, t1016, t1020, t1023, t1030, t1038, t1039;
  double t1040, t1041, t1042, t1044, t1045, t1046, t1049, t1050;
  double t1051, t1052, t1053, t1055, t1059, t1060, t1062, t1063;
  double t1064, t1067, t1068, t1069, t1074, t1078, t1079, t1082;
  double t1083, t1088, t1090, t1091, t1092, t1094, t1098, t1100;
  double t1101, t1102, t1104, t1108, t1111, t1112, t1114, t1115;
  double t1116, t1119, t1120, t1121, t1124, t1125, t1131, t1132;
  double t1135, t1136, t1137, t1139, t1140, t1144, t1148, t1151;
  double t1153, t1155, t1160, t1162, t1163, t1166, t1169, t1172;
  double t1176, t1177, t1181, t1183, t1185, t1187, t1189, t1192;
  double t1194, tv3rho30, t1197, t1198, t1199, t1202, t1207, t1208;
  double t1210, t1214, t1215, t1219, t1222, t1226, t1228, t1232;
  double t1241, t1242, t1243, t1246, t1251, t1253, t1257, t1258;
  double t1262, t1265, t1266, t1268, t1277, t1279, t1282, tv3rho31;
  double t1285, t1290, t1294, t1298, t1299, t1303, t1305, t1314;
  double t1315, t1320, t1324, t1328, t1329, t1333, t1335, t1342;
  double t1350, t1352, t1353, tv3rho32, t1358, t1365, t1369, t1370;
  double t1377, t1378, t1385, t1389, t1390, t1407, t1410, t1417;
  double t1423, t1429, t1430, t1431, t1432, t1433, t1435, t1436;
  double t1437, t1439, t1440, t1441, t1444, t1445, t1446, t1447;
  double t1452, t1456, t1457, t1460, t1461, t1463, t1464, t1467;
  double t1470, t1472, t1473, t1474, t1476, t1480, t1482, t1483;
  double t1484, t1486, t1489, t1493, t1496, t1497, t1499, t1500;
  double t1501, t1504, t1505, t1506, t1509, t1510, t1513, t1514;
  double t1520, t1521, t1522, t1524, t1525, t1529, t1533, t1536;
  double t1538, t1540, t1545, tv3rho33, t1553, t1560, t1562, t1565;
  double t1566, t1569, t1577, t1578, t1579, t1580, t1583, t1584;
  double t1585, t1588, t1589, t1592, t1594, t1598, t1599, t1600;
  double t1602, t1603, t1607, t1608, t1611, t1615, t1617, t1620;
  double t1623, t1625, t1626, t1629, t1630, t1631, t1633, t1634;
  double t1642, t1645, t1646, t1650, t1651, t1658, t1661, t1662;
  double t1664, t1665, t1666, t1667, t1668, t1670, t1671, t1672;
  double t1673, t1674, t1675, t1676, t1678, t1679, t1680, t1682;
  double t1684, t1685, t1688, t1690, t1692, t1697, tv3rho2sigma0, tv3rho2sigma1;
  double t1704, t1708, t1710, tv3rho2sigma2, t1716, t1724, tv3rho2sigma3, tv3rho2sigma4;
  double t1730, t1737, t1740, tv3rho2sigma5, t1748, tv3rho2sigma6, tv3rho2sigma7, t1760;
  double t1761, t1764, t1772, t1773, t1776, t1777, t1778, t1781;
  double t1782, t1783, t1784, t1785, t1788, t1789, t1791, t1792;
  double t1797, t1801, t1803, t1804, t1807, t1809, t1810, t1812;
  double t1816, t1821, t1822, t1825, t1826, t1827, t1829, t1830;
  double t1833, t1834, t1842, t1845, t1852, t1853, t1854, t1855;
  double t1856, t1858, t1861, t1862, t1864, t1865, t1866, t1868;
  double t1870, t1871, t1872, t1874, t1875, t1876, t1878, t1879;
  double t1882, t1884, t1886, t1891, tv3rho2sigma8, t1898, t1905, t1907;
  double t1922, t1923, t1926, t1927, t1929, t1931, t1933, t1935;
  double t1937, t1938, t1941, t1944, t1945, t1948, t1949, t1950;
  double t1952, t1954, t1956, t1957, t1961, t1964, t1966, t1973;
  double t1974, t1982, t1992, t1993, t1996, t1997, t1998, t2000;
  double t2004, t2005, t2008, t2010, t2012, t2017, tv3rho2lapl0, t2024;
  double t2028, t2030, tv3rho2lapl1, t2036, t2044, tv3rho2lapl2, t2050, t2057;
  double t2060, tv3rho2lapl3, t2068, tv3rho2lapl4, t2091, t2092, t2095, t2097;
  double t2100, t2101, t2104, t2105, t2107, t2109, t2111, t2114;
  double t2115, t2118, t2119, t2120, t2122, t2124, t2126, t2127;
  double t2131, t2134, t2136, t2137, t2138, t2146, t2162, t2163;
  double t2166, t2167, t2168, t2170, t2174, t2175, t2178, t2180;
  double t2182, t2187, tv3rho2lapl5, tv3rho2tau0, tv3rho2tau1, tv3rho2tau2, tv3rho2tau3, tv3rho2tau4;
  double tv3rho2tau5, t2194, t2200, t2201, t2206, t2207, t2208, t2209;
  double t2211, t2212, t2213, t2214, t2216, t2217, t2218, t2219;
  double t2221, t2222, t2223, t2224, t2225, t2226, t2227, t2228;
  double t2231, t2232, t2233, t2237, t2241, t2244, t2245, t2248;
  double t2249, t2250, t2253, t2254, t2255, t2258, t2259, t2260;
  double t2262, t2263, t2265, t2266, t2271, t2272, t2275, t2276;
  double t2277, t2278, t2279, t2281, t2282, t2287, t2288, t2291;
  double t2295, t2296, t2297, t2298, t2301, t2302, t2303, t2304;
  double t2306, t2307, t2308, t2310, t2312, t2314, t2319, tv3rhosigma20;
  double tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2326, t2328, tv3rhosigma25, t2334;
  double tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2344, t2345, t2346;
  double t2347, t2349, t2350, t2351, t2352, t2353, t2355, t2356;
  double t2357, t2360, t2361, t2362, t2363, t2364, t2365, t2368;
  double t2369, t2370, t2375, t2376, t2377, t2378, t2380, t2381;
  double t2384, t2385, t2386, t2387, t2388, t2390, t2391, t2394;
  double t2396, t2401, t2402, t2403, t2404, t2406, t2407, t2412;
  double t2413, t2416, t2417, t2420, t2421, t2424, t2425, t2432;
  double t2433, t2434, t2436, t2437, t2440, t2441, t2442, t2443;
  double t2446, t2447, t2448, t2449, t2451, t2452, t2453, t2455;
  double t2457, t2459, t2464, tv3rhosigma211, t2471, t2483, t2485, t2486;
  double t2488, t2495, t2496, t2500, t2501, t2502, t2503, t2504;
  double t2507, t2510, t2511, t2512, t2514, t2515, t2516, t2517;
  double t2520, t2521, t2524, t2526, t2527, t2529, t2530, t2531;
  double t2532, t2533, t2538, t2541, t2546, t2548, t2549, t2551;
  double t2552, t2553, t2554, t2556, t2557, t2558, t2560, t2561;
  double t2564, t2565, t2568, t2570, t2572, t2577, tv3rhosigmalapl0, tv3rhosigmalapl1;
  double tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4, t2584, t2586, tv3rhosigmalapl5, t2592, tv3rhosigmalapl6;
  double tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, t2608, t2610, t2611, t2613;
  double t2616, t2617, t2618, t2619, t2622, t2625, t2626, t2627;
  double t2628, t2631, t2634, t2635, t2636, t2640, t2641, t2643;
  double t2644, t2646, t2647, t2648, t2649, t2650, t2653, t2655;
  double t2661, t2663, t2664, t2666, t2667, t2668, t2669, t2671;
  double t2672, t2673, t2675, t2676, t2679, t2680, t2689, t2690;
  double t2692, t2694, t2696, t2701, tv3rhosigmalapl11, tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2;
  double tv3rhosigmatau3, tv3rhosigmatau4, tv3rhosigmatau5, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9, tv3rhosigmatau10;
  double tv3rhosigmatau11, t2708, t2716, t2717, t2720, t2723, t2724, t2725;
  double t2727, t2728, t2734, t2735, t2737, t2739, t2740, t2742;
  double t2744, t2745, t2747, t2749, t2752, t2761, t2769, t2770;
  double t2775, t2776, t2782, t2783, t2785, t2787, t2789, t2794;
  double tv3rholapl20, tv3rholapl21, t2801, t2803, tv3rholapl22, t2809, tv3rholapl23, tv3rholapl24;
  double t2821, t2825, t2826, t2829, t2834, t2835, t2837, t2838;
  double t2840, t2841, t2842, t2844, t2845, t2847, t2849, t2850;
  double t2852, t2854, t2855, t2856, t2859, t2862, t2866, t2867;
  double t2887, t2888, t2890, t2892, t2894, t2899, tv3rholapl25, tv3rholapltau0;
  double tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rhotau20;
  double tv3rhotau21, tv3rhotau22, tv3rhotau23, tv3rhotau24, tv3rhotau25, t2903, t2904, t2905;
  double t2910, t2912, t2913, t2914, t2915, t2916, t2917, t2918;
  double t2919, t2920, t2921, t2924, t2927, t2929, t2930, t2933;
  double t2938, t2951, t2952, t2953, t2954, t2955, t2957, t2958;
  double t2959, t2960, t2961, t2962, t2963, t2964, t2965, t2966;
  double t2967, t2969, t2971, t2975, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2978, t2979, t2980;
  double t2983, t2988, t2989, t2992, t2995, t2997, t2998, t2999;
  double t3001, t3002, t3003, t3004, t3005, t3006, t3007, t3008;
  double t3014, t3026, t3027, t3028, t3029, t3030, t3031, t3032;
  double t3033, t3034, t3036, t3037, t3038, t3039, t3040, t3041;
  double t3042, t3044, t3046, t3050, tv3sigma39, t3056, t3058, t3060;
  double t3063, t3064, t3067, t3068, t3069, t3070, t3071, t3072;
  double t3073, t3074, t3075, t3076, t3077, t3078, t3079, t3080;
  double t3081, t3082, t3083, t3084, t3085, t3086, t3087, t3088;
  double t3089, t3094, t3095, t3096, t3097, t3101, t3102, t3107;
  double t3114, t3115, t3116, t3117, t3118, t3119, t3122, t3123;
  double t3124, t3125, t3127, t3129, t3133, tv3sigma2lapl0, tv3sigma2lapl1, tv3sigma2lapl2;
  double tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8, tv3sigma2lapl9, tv3sigma2lapl10;
  double t3141, t3142, t3145, t3146, t3147, t3148, t3150, t3152;
  double t3153, t3154, t3155, t3156, t3157, t3158, t3159, t3160;
  double t3161, t3162, t3163, t3164, t3165, t3166, t3167, t3168;
  double t3169, t3175, t3177, t3181, t3182, t3183, t3184, t3186;
  double t3187, t3190, t3191, t3192, t3193, t3194, t3199, t3204;
  double t3205, t3206, t3207, t3208, t3209, t3211, t3213, t3217;
  double tv3sigma2lapl11, tv3sigma2tau0, tv3sigma2tau1, tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6;
  double tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9, tv3sigma2tau10, tv3sigma2tau11, t3228, t3229, t3230;
  double t3231, t3232, t3234, t3235, t3236, t3238, t3239, t3243;
  double t3248, t3251, t3252, t3253, t3256, t3260, t3261, t3268;
  double t3269, t3272, t3273, t3274, t3276, t3277, t3278, t3280;
  double t3282, t3286, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25;
  double tv3sigmalapl26, tv3sigmalapl27, t3297, t3298, t3299, t3300, t3302, t3303;
  double t3304, t3308, t3309, t3312, t3313, t3318, t3319, t3320;
  double t3321, t3326, t3327, t3336, t3337, t3338, t3339, t3340;
  double t3341, t3342, t3343, t3345, t3346, t3347, t3349, t3351;
  double t3355, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5;
  double tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmatau20, tv3sigmatau21;
  double tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, tv3sigmatau28, t3359;
  double t3360, t3361, t3362, t3371, t3372, t3373, t3374, t3375;
  double t3376, t3377, t3379, t3380, t3381, t3382, t3383, t3384;
  double t3386, t3387, t3389, t3390, t3391, t3392, t3395, t3402;
  double t3413, t3415, t3417, t3421, tv3lapl30, tv3lapl31, tv3lapl32, t3425;
  double t3426, t3427, t3428, t3437, t3438, t3439, t3440, t3441;
  double t3442, t3443, t3445, t3446, t3447, t3448, t3449, t3450;
  double t3451, t3452, t3455, t3460, t3461, t3462, t3464, t3465;
  double t3466, t3479, t3481, t3483, t3487, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1;
  double tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20, tv3lapltau21, tv3lapltau22, tv3lapltau23;
  double tv3lapltau24, tv3lapltau25, tv3tau30, tv3tau31, tv3tau32, tv3tau33;

  double t3490, t3492, t3493, t3499, t3505, t3506, t3509, t3513;
  double t3522, t3528, t3531, t3537, t3540, t3543, t3547, t3550;
  double t3557, t3573, t3575, t3578, t3580, t3581, t3587, t3588;
  double t3589, t3590, t3591, t3594, t3595, t3596, t3597, t3598;
  double t3601, t3602, t3605, t3609, t3612, t3614, t3616, t3617;
  double t3618, t3619, t3620, t3622, t3623, t3626, t3630, t3635;
  double t3636, t3640, t3642, t3643, t3647, t3650, t3652, t3657;
  double t3660, t3661, t3663, t3664, t3667, t3670, t3672, t3680;
  double t3685, t3688, t3689, t3693, t3696, t3698, t3702, t3706;
  double t3707, t3710, t3712, t3715, t3720, t3725, t3728, t3730;
  double t3735, t3738, t3739, t3740, t3741, t3744, t3745, t3746;
  double t3747, t3750, t3751, t3752, t3755, t3758, t3761, t3765;
  double t3773, t3774, t3777, t3785, t3786, t3797, t3802, t3804;
  double t3805, t3811, t3818, t3819, t3825, t3826, t3827, t3830;
  double t3837, t3838, t3841, t3846, t3855, t3856, t3865, t3869;
  double t3877, t3881, t3885, t3888, t3892, t3893, t3894, t3895;
  double t3897, t3898, t3904, t3909, t3912, t3916, t3923, t3927;
  double t3931, t3936, t3938, tv4rho40, t3945, t3949, t3950, t3953;
  double t3971, t3972, t3974, t3978, t3987, t3993, t3994, t3996;
  double t4010, t4011, t4028, t4030, t4034, t4041, t4045, t4046;
  double t4049, t4058, t4061, t4062, t4064, t4066, t4067, tv4rho41;
  double t4082, t4095, t4099, t4108, t4115, t4119, t4132, t4133;
  double t4142, t4155, t4159, t4166, t4170, t4179, t4182, t4193;
  double t4196, t4198, t4199, tv4rho42, t4220, t4224, t4231, t4242;
  double t4243, t4260, t4264, t4271, t4279, t4288, t4298, t4300;
  double t4301, tv4rho43, t4306, t4311, t4318, t4322, t4331, t4340;
  double t4343, t4350, t4364, t4365, t4366, t4367, t4371, t4374;
  double t4376, t4380, t4384, t4387, t4388, t4391, t4394, t4397;
  double t4400, t4403, t4407, t4411, t4414, t4416, t4417, t4421;
  double t4424, t4427, t4429, t4430, t4439, t4442, t4445, t4447;
  double t4451, t4457, t4458, t4459, t4464, t4466, t4474, t4475;
  double t4476, t4477, t4480, t4481, t4489, t4490, t4491, t4492;
  double t4493, t4496, t4497, t4501, t4504, t4507, t4509, t4511;
  double t4512, t4513, t4514, t4515, t4517, t4518, t4521, t4525;
  double t4528, t4530, t4535, t4536, t4539, t4540, t4541, t4542;
  double t4545, t4546, t4549, t4552, t4553, t4554, t4557, t4560;
  double t4561, t4562, t4563, t4570, t4577, t4580, t4583, t4588;
  double t4598, t4601, t4615, t4622, t4623, t4626, t4629, t4630;
  double t4635, t4639, t4642, t4643, t4648, t4649, t4662, t4666;
  double t4672, t4677, t4684, t4688, t4705, t4706, tv4rho44, t4714;
  double t4720, t4723, t4730, t4732, t4735, t4738, t4742, t4761;
  double t4762, t4764, t4765, t4768, t4770, t4771, t4776, t4777;
  double t4780, t4781, t4784, t4787, t4788, t4790, t4794, t4797;
  double t4798, t4799, t4803, t4807, t4810, t4811, t4812, t4819;
  double t4821, t4827, t4829, t4832, t4834, t4837, t4838, t4842;
  double t4845, t4849, t4850, t4851, t4855, t4859, t4864, t4867;
  double t4868, t4873, t4878, t4881, t4885, t4895, t4907, t4912;
  double t4917, t4922, t4925, t4930, t4935, t4937, t4945, t4955;
  double t4956, t4957, t4958, t4961, t4962, t4963, t4966, t4968;
  double t4969, t4972, t4973, t4975, t4976, t4979, t4982, t4986;
  double t4990, t4994, t4995, t4998, t5001, t5006, t5007, t5012;
  double t5017, t5020, t5022, t5027, t5032, t5039, t5041, t5051;
  double t5056, t5063, t5064, t5072, t5075, t5092, t5095, t5103;
  double t5109, t5110, t5114, t5119, t5123, t5130, tv4rho3sigma0, tv4rho3sigma1;
  double t5137, t5140, t5144, t5146, tv4rho3sigma2, t5148, t5154, t5159;
  double t5163, t5172, t5173, tv4rho3sigma3, tv4rho3sigma4, t5175, t5181, t5183;
  double t5192, t5194, t5197, tv4rho3sigma5, t5203, t5212, tv4rho3sigma6, tv4rho3sigma7;
  double t5218, t5225, t5233, t5235, t5236, tv4rho3sigma8, t5245, tv4rho3sigma9;
  double tv4rho3sigma10, t5263, t5267, t5286, t5287, t5289, t5290, t5293;
  double t5295, t5298, t5299, t5301, t5304, t5305, t5306, t5309;
  double t5310, t5314, t5316, t5319, t5322, t5327, t5328, t5331;
  double t5338, t5343, t5346, t5347, t5348, t5352, t5355, t5358;
  double t5361, t5362, t5369, t5370, t5375, t5376, t5379, t5385;
  double t5390, t5395, t5400, t5403, t5407, t5409, t5416, t5421;
  double t5424, t5430, t5438, t5440, t5442, t5448, t5456, t5466;
  double t5473, t5478, t5479, t5482, t5483, t5484, t5487, t5488;
  double t5489, t5490, t5493, t5494, t5497, t5500, t5501, t5502;
  double t5503, t5508, t5512, t5513, t5518, t5519, t5523, t5529;
  double t5532, t5534, t5535, t5540, t5546, t5550, t5553, t5556;
  double t5559, t5562, t5568, t5573, t5577, t5578, t5579, t5588;
  double t5589, t5593, t5597, t5605, t5609, t5617, t5619, t5638;
  double t5644, t5648, t5655, tv4rho3sigma11, t5662, t5668, t5671, t5678;
  double t5680, t5683, t5712, t5715, t5716, t5717, t5720, t5721;
  double t5724, t5725, t5729, t5730, t5739, t5740, t5743, t5760;
  double t5763, t5765, t5766, t5771, t5780, t5781, t5784, t5785;
  double t5789, t5792, t5795, t5800, t5803, t5804, t5809, t5812;
  double t5819, t5824, t5833, t5839, t5844, t5846, t5849, t5851;
  double t5858, t5859, t5870, t5873, t5880, t5881, t5895, t5899;
  double t5914, t5920, t5926, t5933, t5940, t5941, t5952, t5953;
  double t5956, t5959, t5977, t5984, t5987, t5990, t5994, t6001;
  double tv4rho3lapl0, t6008, t6011, t6015, t6017, tv4rho3lapl1, t6019, t6025;
  double t6030, t6034, t6043, t6044, tv4rho3lapl2, t6046, t6052, t6054;
  double t6063, t6065, t6068, tv4rho3lapl3, t6074, t6083, tv4rho3lapl4, t6089;
  double t6096, t6104, t6106, t6107, tv4rho3lapl5, t6116, tv4rho3lapl6, t6157;
  double t6158, t6161, t6162, t6165, t6168, t6169, t6174, t6175;
  double t6180, t6185, t6189, t6195, t6198, t6200, t6209, t6211;
  double t6214, t6216, t6225, t6234, t6240, t6247, t6248, t6249;
  double t6257, t6264, t6266, t6269, t6273, t6276, t6288, t6302;
  double t6303, t6306, t6307, t6314, t6318, t6321, t6324, t6329;
  double t6330, t6333, t6352, t6355, t6356, t6359, t6363, t6371;
  double t6375, t6380, t6387, t6388, t6397, t6400, t6401, t6404;
  double t6407, t6429, t6432, t6437, t6441, t6448, tv4rho3lapl7, tv4rho3tau0;
  double tv4rho3tau1, tv4rho3tau2, tv4rho3tau3, tv4rho3tau4, tv4rho3tau5, tv4rho3tau6, tv4rho3tau7, t6455;
  double t6462, t6464, t6475, t6476, t6478, t6479, t6480, t6481;
  double t6487, t6488, t6490, t6494, t6497, t6498, t6500, t6503;
  double t6507, t6508, t6510, t6513, t6514, t6515, t6516, t6520;
  double t6523, t6524, t6527, t6532, t6533, t6535, t6536, t6538;
  double t6539, t6542, t6545, t6551, t6561, t6565, t6566, t6571;
  double t6573, t6575, t6577, t6585, t6597, t6604, t6605, t6607;
  double t6610, t6612, t6615, t6616, t6618, t6619, t6621, t6624;
  double t6625, t6626, t6634, t6637, t6640, t6642, t6646, t6655;
  double t6657, t6661, t6667, t6669, t6670, t6675, t6677, t6678;
  double t6684, t6686, t6687, t6688, t6689, t6690, t6691, t6694;
  double t6697, t6702, t6707, t6710, t6711, t6713, t6714, t6715;
  double t6716, t6723, t6725, t6726, t6727, t6728, t6731, t6734;
  double t6744, t6746, t6751, t6754, t6757, t6758, t6759, t6764;
  double t6766, t6767, t6782, t6783, t6784, t6789, t6794, t6795;
  double t6803, t6811, t6813, t6816, t6817, t6823, t6825, t6826;
  double t6830, t6831, t6839, t6847, t6848, t6849, t6852, t6853;
  double t6858, t6862, t6869, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24;
  double t6876, t6880, t6882, tv4rho2sigma25, t6888, t6896, tv4rho2sigma26, tv4rho2sigma27;
  double tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6902, t6909, t6912, tv4rho2sigma211, t6920;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t6940, t6941, t6943;
  double t6945, t6946, t6947, t6952, t6953, t6954, t6955, t6957;
  double t6960, t6962, t6963, t6965, t6967, t6968, t6971, t6973;
  double t6976, t6977, t6982, t6985, t6995, t6996, t6999, t7005;
  double t7011, t7014, t7017, t7018, t7021, t7024, t7036, t7041;
  double t7042, t7043, t7047, t7050, t7051, t7055, t7059, t7062;
  double t7065, t7066, t7068, t7069, t7072, t7074, t7075, t7077;
  double t7078, t7081, t7087, t7092, t7093, t7097, t7101, t7104;
  double t7105, t7106, t7112, t7124, t7126, t7127, t7131, t7132;
  double t7133, t7137, t7140, t7142, t7143, t7153, t7155, t7158;
  double t7164, t7169, t7181, t7182, t7184, t7186, t7188, t7191;
  double t7192, t7196, t7198, t7199, t7200, t7201, t7204, t7207;
  double t7212, t7219, t7227, t7232, t7235, t7243, t7244, t7250;
  double t7253, t7258, t7259, t7267, t7268, t7279, t7281, t7283;
  double t7286, t7291, t7292, t7296, t7299, t7300, t7302, t7305;
  double t7311, t7320, t7321, t7322, t7323, t7327, t7334, tv4rho2sigma217;
  double t7341, t7348, t7350, t7375, t7376, t7377, t7382, t7385;
  double t7386, t7393, t7396, t7397, t7398, t7401, t7402, t7407;
  double t7413, t7415, t7422, t7423, t7424, t7425, t7430, t7431;
  double t7434, t7448, t7449, t7454, t7460, t7463, t7468, t7469;
  double t7474, t7475, t7476, t7492, t7493, t7496, t7500, t7504;
  double t7512, t7516, t7519, t7520, t7525, t7540, t7543, t7560;
  double t7562, t7569, t7611, t7618, t7625, t7633, t7634, t7640;
  double t7649, t7650, t7653, t7656, t7660, t7674, t7675, t7678;
  double t7680, t7681, t7684, t7690, t7695, t7699, t7705, t7727;
  double t7731, t7738, tv4rho2sigmalapl0, tv4rho2sigmalapl1, tv4rho2sigmalapl2, tv4rho2sigmalapl3, tv4rho2sigmalapl4, t7745;
  double t7749, t7751, tv4rho2sigmalapl5, t7757, t7765, tv4rho2sigmalapl6, tv4rho2sigmalapl7, tv4rho2sigmalapl8;
  double tv4rho2sigmalapl9, tv4rho2sigmalapl10, t7771, t7778, t7781, tv4rho2sigmalapl11, t7789, tv4rho2sigmalapl12;
  double tv4rho2sigmalapl13, tv4rho2sigmalapl14, tv4rho2sigmalapl15, tv4rho2sigmalapl16, t7830, t7831, t7834, t7837;
  double t7841, t7842, t7846, t7847, t7848, t7853, t7854, t7855;
  double t7859, t7867, t7875, t7882, t7889, t7890, t7891, t7892;
  double t7893, t7896, t7897, t7900, t7903, t7905, t7909, t7911;
  double t7918, t7919, t7920, t7921, t7924, t7925, t7930, t7933;
  double t7936, t7948, t7952, t7955, t7969, t7978, t7979, t7994;
  double t7995, t7996, t8001, t8015, t8019, t8020, t8023, t8032;
  double t8035, t8049, t8050, t8057, t8058, t8061, t8065, t8069;
  double t8072, t8083, t8092, t8106, t8121, t8127, t8149, t8168;
  double t8172, t8179, tv4rho2sigmalapl17, tv4rho2sigmatau0, tv4rho2sigmatau1, tv4rho2sigmatau2, tv4rho2sigmatau3, tv4rho2sigmatau4;
  double tv4rho2sigmatau5, tv4rho2sigmatau6, tv4rho2sigmatau7, tv4rho2sigmatau8, tv4rho2sigmatau9, tv4rho2sigmatau10, tv4rho2sigmatau11, tv4rho2sigmatau12;
  double tv4rho2sigmatau13, tv4rho2sigmatau14, tv4rho2sigmatau15, tv4rho2sigmatau16, tv4rho2sigmatau17, t8186, t8193, t8195;
  double t8216, t8227, t8228, t8234, t8235, t8244, t8248, t8249;
  double t8252, t8257, t8268, t8271, t8276, t8277, t8279, t8282;
  double t8285, t8293, t8300, t8305, t8306, t8309, t8312, t8320;
  double t8322, t8326, t8337, t8345, t8349, t8360, t8374, t8381;
  double t8404, t8414, t8417, t8423, t8424, t8429, t8431, t8432;
  double t8442, t8443, t8444, t8449, t8454, t8469, t8476, t8482;
  double t8486, t8493, tv4rho2lapl20, tv4rho2lapl21, t8500, t8504, t8506, tv4rho2lapl22;
  double t8512, t8520, tv4rho2lapl23, tv4rho2lapl24, t8526, t8533, t8536, tv4rho2lapl25;
  double t8544, tv4rho2lapl26, tv4rho2lapl27, t8571, t8579, t8583, t8586, t8587;
  double t8592, t8599, t8605, t8606, t8616, t8617, t8620, t8623;
  double t8624, t8625, t8633, t8638, t8641, t8643, t8655, t8660;
  double t8661, t8666, t8668, t8672, t8676, t8680, t8681, t8697;
  double t8700, t8703, t8709, t8725, t8735, t8746, t8763, t8768;
  double t8779, t8780, t8785, t8787, t8791, t8798, t8799, t8800;
  double t8810, t8815, t8821, t8823, t8833, t8838, t8842, t8849;
  double tv4rho2lapl28, tv4rho2lapltau0, tv4rho2lapltau1, tv4rho2lapltau2, tv4rho2lapltau3, tv4rho2lapltau4, tv4rho2lapltau5, tv4rho2lapltau6;
  double tv4rho2lapltau7, tv4rho2lapltau8, tv4rho2lapltau9, tv4rho2lapltau10, tv4rho2lapltau11, tv4rho2tau20, tv4rho2tau21, tv4rho2tau22;
  double tv4rho2tau23, tv4rho2tau24, tv4rho2tau25, tv4rho2tau26, tv4rho2tau27, tv4rho2tau28, t8856, t8862;
  double t8863, t8864, t8865, t8866, t8867, t8871, t8873, t8875;
  double t8877, t8878, t8879, t8880, t8883, t8884, t8886, t8887;
  double t8889, t8891, t8892, t8893, t8895, t8896, t8899, t8900;
  double t8901, t8912, t8914, t8915, t8918, t8922, t8926, t8934;
  double t8937, t8939, t8941, t8942, t8943, t8946, t8949, t8950;
  double t8951, t8954, t8956, t8958, t8961, t8962, t8963, t8965;
  double t8967, t8968, t8969, t8972, t8973, t8977, t8982, t8986;
  double t8987, t8988, t8991, t8992, t8997, t8998, t9001, t9006;
  double t9009, t9012, t9015, t9018, t9020, t9023, t9024, t9035;
  double t9039, t9041, t9044, t9049, t9054, t9060, t9063, t9068;
  double t9071, t9078, t9082, t9085, t9088, t9095, t9096, t9099;
  double t9102, t9107, t9110, t9123, t9128, t9141, t9150, t9152;
  double t9155, t9159, t9161, t9165, t9172, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32;
  double tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t9179, t9181;
  double tv4rhosigma39, t9187, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315;
  double tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t9197, t9198, t9199, t9201, t9203;
  double t9204, t9206, t9208, t9209, t9210, t9214, t9215, t9216;
  double t9219, t9222, t9223, t9224, t9225, t9228, t9230, t9231;
  double t9233, t9236, t9239, t9242, t9244, t9245, t9248, t9249;
  double t9250, t9251, t9253, t9254, t9255, t9259, t9263, t9267;
  double t9270, t9273, t9274, t9276, t9281, t9283, t9286, t9287;
  double t9289, t9290, t9294, t9296, t9297, t9303, t9304, t9306;
  double t9309, t9310, t9313, t9316, t9319, t9320, t9321, t9324;
  double t9327, t9330, t9337, t9340, t9343, t9350, t9352, t9359;
  double t9360, t9366, t9374, t9379, t9385, t9386, t9389, t9390;
  double t9393, t9394, t9396, t9401, t9403, t9408, t9410, t9413;
  double t9417, t9421, t9424, t9427, t9432, t9435, t9437, t9439;
  double t9458, t9460, t9466, t9472, t9479, t9483, t9491, t9495;
  double t9502, tv4rhosigma319, t9509, t9522, t9530, t9531, t9536, t9540;
  double t9541, t9546, t9554, t9555, t9560, t9564, t9566, t9568;
  double t9572, t9574, t9577, t9579, t9583, t9585, t9591, t9594;
  double t9598, t9599, t9605, t9606, t9623, t9636, t9643, t9648;
  double t9650, t9652, t9655, t9662, t9671, t9676, t9678, t9681;
  double t9683, t9692, t9694, t9697, t9701, t9712, t9715, t9716;
  double t9717, t9719, t9720, t9723, t9737, t9745, t9762, t9780;
  double t9781, t9788, t9794, t9802, t9803, t9806, t9807, t9821;
  double t9833, t9841, t9842, t9846, t9851, t9856, t9863, tv4rhosigma2lapl0;
  double tv4rhosigma2lapl1, tv4rhosigma2lapl2, tv4rhosigma2lapl3, tv4rhosigma2lapl4, tv4rhosigma2lapl5, tv4rhosigma2lapl6, tv4rhosigma2lapl7, tv4rhosigma2lapl8;
  double tv4rhosigma2lapl9, tv4rhosigma2lapl10, t9870, t9872, tv4rhosigma2lapl11, t9878, tv4rhosigma2lapl12, tv4rhosigma2lapl13;
  double tv4rhosigma2lapl14, tv4rhosigma2lapl15, tv4rhosigma2lapl16, tv4rhosigma2lapl17, tv4rhosigma2lapl18, tv4rhosigma2lapl19, tv4rhosigma2lapl20, tv4rhosigma2lapl21;
  double tv4rhosigma2lapl22, t9895, t9906, t9907, t9908, t9912, t9913, t9914;
  double t9920, t9930, t9936, t9937, t9939, t9943, t9945, t9946;
  double t9947, t9954, t9957, t9958, t9963, t9969, t9977, t9978;
  double t9983, t9984, t9991, t9996, t9998, t10000, t10004, t10005;
  double t10009, t10012, t10014, t10018, t10020, t10022, t10025, t10029;
  double t10034, t10038, t10045, t10060, t10078, t10081, t10082, t10090;
  double t10094, t10098, t10100, t10103, t10107, t10110, t10124, t10135;
  double t10159, t10160, t10171, t10174, t10178, t10179, t10182, t10183;
  double t10195, t10210, t10218, t10219, t10223, t10228, t10233, t10240;
  double tv4rhosigma2lapl23, tv4rhosigma2tau0, tv4rhosigma2tau1, tv4rhosigma2tau2, tv4rhosigma2tau3, tv4rhosigma2tau4, tv4rhosigma2tau5, tv4rhosigma2tau6;
  double tv4rhosigma2tau7, tv4rhosigma2tau8, tv4rhosigma2tau9, tv4rhosigma2tau10, tv4rhosigma2tau11, tv4rhosigma2tau12, tv4rhosigma2tau13, tv4rhosigma2tau14;
  double tv4rhosigma2tau15, tv4rhosigma2tau16, tv4rhosigma2tau17, tv4rhosigma2tau18, tv4rhosigma2tau19, tv4rhosigma2tau20, tv4rhosigma2tau21, tv4rhosigma2tau22;
  double tv4rhosigma2tau23, t10247, t10259, t10262, t10263, t10267, t10271, t10275;
  double t10294, t10299, t10300, t10305, t10308, t10311, t10315, t10318;
  double t10321, t10326, t10327, t10330, t10333, t10335, t10336, t10355;
  double t10363, t10369, t10378, t10394, t10397, t10414, t10435, t10459;
  double t10489, t10490, t10509, t10532, t10543, t10548, t10555, tv4rhosigmalapl20;
  double tv4rhosigmalapl21, tv4rhosigmalapl22, tv4rhosigmalapl23, tv4rhosigmalapl24, tv4rhosigmalapl25, tv4rhosigmalapl26, tv4rhosigmalapl27, t10562;
  double t10564, tv4rhosigmalapl28, t10570, tv4rhosigmalapl29, tv4rhosigmalapl210, tv4rhosigmalapl211, tv4rhosigmalapl212, tv4rhosigmalapl213;
  double tv4rhosigmalapl214, tv4rhosigmalapl215, tv4rhosigmalapl216, t10585, t10586, t10590, t10601, t10604;
  double t10621, t10637, t10657, t10696, t10714, t10733, t10738, t10739;
  double t10745, t10748, t10753, t10756, t10760, t10763, t10770, t10772;
  double t10777, t10778, t10785, t10789, t10813, t10816, t10821, t10832;
  double t10856, t10870, t10875, t10882, tv4rhosigmalapl217, tv4rhosigmalapltau0, tv4rhosigmalapltau1, tv4rhosigmalapltau2;
  double tv4rhosigmalapltau3, tv4rhosigmalapltau4, tv4rhosigmalapltau5, tv4rhosigmalapltau6, tv4rhosigmalapltau7, tv4rhosigmalapltau8, tv4rhosigmalapltau9, tv4rhosigmalapltau10;
  double tv4rhosigmalapltau11, tv4rhosigmalapltau12, tv4rhosigmalapltau13, tv4rhosigmalapltau14, tv4rhosigmalapltau15, tv4rhosigmalapltau16, tv4rhosigmalapltau17, tv4rhosigmalapltau18;
  double tv4rhosigmalapltau19, tv4rhosigmalapltau20, tv4rhosigmalapltau21, tv4rhosigmalapltau22, tv4rhosigmalapltau23, tv4rhosigmatau20, tv4rhosigmatau21, tv4rhosigmatau22;
  double tv4rhosigmatau23, tv4rhosigmatau24, tv4rhosigmatau25, tv4rhosigmatau26, tv4rhosigmatau27, tv4rhosigmatau28, tv4rhosigmatau29, tv4rhosigmatau210;
  double tv4rhosigmatau211, tv4rhosigmatau212, tv4rhosigmatau213, tv4rhosigmatau214, tv4rhosigmatau215, tv4rhosigmatau216, tv4rhosigmatau217, t10889;
  double t10897, t10899, t10914, t10916, t10917, t10920, t10923, t10926;
  double t10941, t10942, t10950, t10951, t10962, t10964, t10972, t10976;
  double t10979, t10986, t10988, t10995, t11000, t11013, t11014, t11021;
  double t11027, t11036, t11048, t11053, t11057, t11063, t11066, t11072;
  double t11073, t11076, t11079, t11085, t11086, t11098, t11106, t11107;
  double t11110, t11115, t11119, t11126, tv4rholapl30, tv4rholapl31, tv4rholapl32, t11133;
  double t11135, tv4rholapl33, t11141, tv4rholapl34, tv4rholapl35, tv4rholapl36, t11153, t11155;
  double t11170, t11172, t11173, t11176, t11183, t11186, t11203, t11205;
  double t11208, t11215, t11218, t11232, t11236, t11240, t11242, t11249;
  double t11251, t11254, t11262, t11268, t11277, t11278, t11283, t11293;
  double t11300, t11305, t11310, t11318, t11321, t11328, t11329, t11333;
  double t11334, t11341, t11348, t11359, t11360, t11366, t11371, t11375;
  double t11382, tv4rholapl37, tv4rholapl2tau0, tv4rholapl2tau1, tv4rholapl2tau2, tv4rholapl2tau3, tv4rholapl2tau4, tv4rholapl2tau5;
  double tv4rholapl2tau6, tv4rholapl2tau7, tv4rholapl2tau8, tv4rholapl2tau9, tv4rholapl2tau10, tv4rholapl2tau11, tv4rholapltau20, tv4rholapltau21;
  double tv4rholapltau22, tv4rholapltau23, tv4rholapltau24, tv4rholapltau25, tv4rholapltau26, tv4rholapltau27, tv4rholapltau28, tv4rholapltau29;
  double tv4rholapltau210, tv4rholapltau211, tv4rhotau30, tv4rhotau31, tv4rhotau32, tv4rhotau33, tv4rhotau34, tv4rhotau35;
  double tv4rhotau36, tv4rhotau37, t11394, t11397, t11398, t11400, t11401, t11403;
  double t11404, t11406, t11409, t11410, t11411, t11414, t11417, t11418;
  double t11426, t11428, t11431, t11432, t11437, t11438, t11440, t11443;
  double t11444, t11446, t11448, t11450, t11452, t11457, t11464, t11466;
  double t11470, t11473, t11474, t11476, t11483, t11486, t11494, t11495;
  double t11498, t11499, t11501, t11502, t11517, t11532, t11533, t11547;
  double t11551, t11560, t11561, t11566, t11574, t11576, t11580, t11582;
  double t11591, t11595, t11601, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t11609, t11611, t11612, t11615, t11616, t11618, t11620;
  double t11621, t11622, t11625, t11628, t11632, t11635, t11636, t11638;
  double t11641, t11642, t11644, t11647, t11648, t11650, t11652, t11656;
  double t11660, t11663, t11667, t11668, t11672, t11674, t11680, t11684;
  double t11687, t11688, t11691, t11693, t11696, t11712, t11717, t11725;
  double t11726, t11727, t11729, t11731, t11734, t11758, t11762, t11767;
  double t11769, t11775, t11779, t11784, t11793, t11795, t11797, t11800;
  double t11807, t11811, t11817, tv4sigma414, t11826, t11827, t11828, t11829;
  double t11830, t11831, t11832, t11833, t11834, t11835, t11836, t11837;
  double t11838, t11839, t11840, t11841, t11842, t11844, t11845, t11849;
  double t11850, t11851, t11852, t11853, t11854, t11857, t11870, t11871;
  double t11872, t11873, t11876, t11878, t11879, t11887, t11888, t11893;
  double t11894, t11895, t11896, t11897, t11898, t11900, t11901, t11906;
  double t11909, t11918, t11919, t11926, t11927, t11930, t11931, t11934;
  double t11940, t11941, t11948, t11951, t11971, t11982, t11990, t11994;
  double t11999, t12004, t12022, t12026, t12030, t12036, tv4sigma3lapl0, tv4sigma3lapl1;
  double tv4sigma3lapl2, tv4sigma3lapl3, tv4sigma3lapl4, tv4sigma3lapl5, tv4sigma3lapl6, tv4sigma3lapl7, tv4sigma3lapl8, tv4sigma3lapl9;
  double tv4sigma3lapl10, tv4sigma3lapl11, tv4sigma3lapl12, tv4sigma3lapl13, tv4sigma3lapl14, tv4sigma3lapl15, tv4sigma3lapl16, tv4sigma3lapl17;
  double tv4sigma3lapl18, t12046, t12047, t12048, t12049, t12050, t12051, t12052;
  double t12056, t12057, t12060, t12061, t12062, t12065, t12066, t12070;
  double t12071, t12072, t12074, t12075, t12078, t12079, t12080, t12081;
  double t12082, t12083, t12084, t12085, t12086, t12087, t12088, t12093;
  double t12105, t12106, t12107, t12108, t12113, t12114, t12115, t12116;
  double t12117, t12118, t12120, t12121, t12124, t12137, t12143, t12146;
  double t12157, t12168, t12171, t12173, t12174, t12183, t12188, t12206;
  double t12212, t12213, t12220, t12221, t12224, t12225, t12229, t12238;
  double t12245, t12249, t12255, tv4sigma3lapl19, tv4sigma3tau0, tv4sigma3tau1, tv4sigma3tau2, tv4sigma3tau3;
  double tv4sigma3tau4, tv4sigma3tau5, tv4sigma3tau6, tv4sigma3tau7, tv4sigma3tau8, tv4sigma3tau9, tv4sigma3tau10, tv4sigma3tau11;
  double tv4sigma3tau12, tv4sigma3tau13, tv4sigma3tau14, tv4sigma3tau15, tv4sigma3tau16, tv4sigma3tau17, tv4sigma3tau18, tv4sigma3tau19;
  double t12264, t12267, t12269, t12274, t12280, t12283, t12284, t12285;
  double t12309, t12326, t12334, t12339, t12346, t12353, t12355, t12361;
  double t12372, t12385, t12386, t12388, t12390, t12391, t12392, t12394;
  double t12396, t12398, t12400, t12408, t12415, t12421, t12428, t12431;
  double t12433, t12454, t12460, t12465, t12469, t12475, tv4sigma2lapl20, tv4sigma2lapl21;
  double tv4sigma2lapl22, tv4sigma2lapl23, tv4sigma2lapl24, tv4sigma2lapl25, tv4sigma2lapl26, tv4sigma2lapl27, tv4sigma2lapl28, tv4sigma2lapl29;
  double tv4sigma2lapl210, tv4sigma2lapl211, tv4sigma2lapl212, tv4sigma2lapl213, tv4sigma2lapl214, tv4sigma2lapl215, tv4sigma2lapl216, t12482;
  double t12487, t12488, t12494, t12506, t12508, t12511, t12513, t12530;
  double t12546, t12552, t12555, t12559, t12566, t12571, t12582, t12586;
  double t12591, t12599, t12607, t12609, t12610, t12611, t12613, t12615;
  double t12616, t12618, t12620, t12622, t12630, t12637, t12641, t12644;
  double t12646, t12651, t12662, t12674, t12681, t12687, t12691, t12697;
  double tv4sigma2lapl217, tv4sigma2lapltau0, tv4sigma2lapltau1, tv4sigma2lapltau2, tv4sigma2lapltau3, tv4sigma2lapltau4, tv4sigma2lapltau5, tv4sigma2lapltau6;
  double tv4sigma2lapltau7, tv4sigma2lapltau8, tv4sigma2lapltau9, tv4sigma2lapltau10, tv4sigma2lapltau11, tv4sigma2lapltau12, tv4sigma2lapltau13, tv4sigma2lapltau14;
  double tv4sigma2lapltau15, tv4sigma2lapltau16, tv4sigma2lapltau17, tv4sigma2lapltau18, tv4sigma2lapltau19, tv4sigma2lapltau20, tv4sigma2lapltau21, tv4sigma2lapltau22;
  double tv4sigma2lapltau23, tv4sigma2tau20, tv4sigma2tau21, tv4sigma2tau22, tv4sigma2tau23, tv4sigma2tau24, tv4sigma2tau25, tv4sigma2tau26;
  double tv4sigma2tau27, tv4sigma2tau28, tv4sigma2tau29, tv4sigma2tau210, tv4sigma2tau211, tv4sigma2tau212, tv4sigma2tau213, tv4sigma2tau214;
  double tv4sigma2tau215, tv4sigma2tau216, tv4sigma2tau217, t12703, t12704, t12710, t12711, t12723;
  double t12733, t12751, t12756, t12759, t12774, t12787, t12790, t12792;
  double t12819, t12820, t12825, t12832, t12837, t12846, t12850, t12856;
  double tv4sigmalapl30, tv4sigmalapl31, tv4sigmalapl32, tv4sigmalapl33, tv4sigmalapl34, tv4sigmalapl35, tv4sigmalapl36, tv4sigmalapl37;
  double tv4sigmalapl38, tv4sigmalapl39, tv4sigmalapl310, t12866, t12873, t12876, t12878, t12890;
  double t12897, t12904, t12911, t12921, t12946, t12958, t12982, t12984;
  double t12985, t13007, t13008, t13012, t13018, tv4sigmalapl311, tv4sigmalapl2tau0, tv4sigmalapl2tau1;
  double tv4sigmalapl2tau2, tv4sigmalapl2tau3, tv4sigmalapl2tau4, tv4sigmalapl2tau5, tv4sigmalapl2tau6, tv4sigmalapl2tau7, tv4sigmalapl2tau8, tv4sigmalapl2tau9;
  double tv4sigmalapl2tau10, tv4sigmalapl2tau11, tv4sigmalapl2tau12, tv4sigmalapl2tau13, tv4sigmalapl2tau14, tv4sigmalapl2tau15, tv4sigmalapl2tau16, tv4sigmalapl2tau17;
  double tv4sigmalapltau20, tv4sigmalapltau21, tv4sigmalapltau22, tv4sigmalapltau23, tv4sigmalapltau24, tv4sigmalapltau25, tv4sigmalapltau26, tv4sigmalapltau27;
  double tv4sigmalapltau28, tv4sigmalapltau29, tv4sigmalapltau210, tv4sigmalapltau211, tv4sigmalapltau212, tv4sigmalapltau213, tv4sigmalapltau214, tv4sigmalapltau215;
  double tv4sigmalapltau216, tv4sigmalapltau217, tv4sigmatau30, tv4sigmatau31, tv4sigmatau32, tv4sigmatau33, tv4sigmatau34, tv4sigmatau35;
  double tv4sigmatau36, tv4sigmatau37, tv4sigmatau38, tv4sigmatau39, tv4sigmatau310, tv4sigmatau311, t13028, t13029;
  double t13030, t13033, t13037, t13040, t13044, t13051, t13058, t13059;
  double t13062, t13065, t13068, t13072, t13094, t13095, t13121, t13150;
  double t13152, t13157, t13176, t13180, t13186, tv4lapl40, tv4lapl41, tv4lapl42;
  double tv4lapl43, t13193, t13194, t13195, t13198, t13202, t13208, t13225;
  double t13226, t13229, t13232, t13236, t13239, t13275, t13276, t13285;
  double t13313, t13317, t13320, t13341, t13345, t13351, tv4lapl44, tv4lapl3tau0;
  double tv4lapl3tau1, tv4lapl3tau2, tv4lapl3tau3, tv4lapl3tau4, tv4lapl3tau5, tv4lapl3tau6, tv4lapl3tau7, tv4lapl2tau20;
  double tv4lapl2tau21, tv4lapl2tau22, tv4lapl2tau23, tv4lapl2tau24, tv4lapl2tau25, tv4lapl2tau26, tv4lapl2tau27, tv4lapl2tau28;
  double tv4lapltau30, tv4lapltau31, tv4lapltau32, tv4lapltau33, tv4lapltau34, tv4lapltau35, tv4lapltau36, tv4lapltau37;
  double tv4tau40, tv4tau41, tv4tau42, tv4tau43, tv4tau44;

  mgga_k_csk_loc_params *params;

  assert(p->params != NULL);
  params = (mgga_k_csk_loc_params * )(p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = rho[0] + rho[1];
  t9 = 0.1e1 / t8;
  t12 = 0.2e1 * rho[0] * t9 <= p->zeta_threshold;
  t13 = p->zeta_threshold - 0.1e1;
  t16 = 0.2e1 * rho[1] * t9 <= p->zeta_threshold;
  t17 = -t13;
  t18 = rho[0] - rho[1];
  t20 = my_piecewise5(t12, t13, t16, t17, t18 * t9);
  t21 = 0.1e1 + t20;
  t22 = t21 <= p->zeta_threshold;
  t23 = POW_1_3(p->zeta_threshold);
  t24 = t23 * t23;
  t25 = t24 * p->zeta_threshold;
  t26 = POW_1_3(t21);
  t27 = t26 * t26;
  t29 = my_piecewise3(t22, t25, t27 * t21);
  t30 = POW_1_3(t8);
  t31 = t30 * t30;
  t32 = t29 * t31;
  t33 = M_CBRT6;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t33 * t37;
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = 0.5e1 / 0.72e2 * t38 * sigma[0] * t43;
  t47 = params->csk_cp * t33;
  t48 = t37 * sigma[0];
  t52 = params->csk_cq * t33;
  t53 = t37 * lapl[0];
  t55 = 0.1e1 / t41 / rho[0];
  t59 = t47 * t48 * t43 / 0.24e2 + t52 * t53 * t55 / 0.24e2 - t46;
  t61 = log(0.1e1 - DBL_EPSILON);
  t62 = 0.1e1 / params->csk_a;
  t63 = pow(-t61, -t62);
  t64 = t59 < -t63;
  t65 = log(DBL_EPSILON);
  t66 = pow(-t65, -t62);
  t67 = -t66 < t59;
  t68 = my_piecewise3(t67, -t66, t59);
  t69 = -t63 < t68;
  t70 = my_piecewise3(t69, t68, -t63);
  t71 = fabs(t70);
  t72 = pow(t71, params->csk_a);
  t73 = 0.1e1 / t72;
  t74 = exp(-t73);
  t75 = 0.1e1 - t74;
  t76 = pow(t75, t62);
  t77 = my_piecewise5(t64, 0, t67, 1, t76);
  t79 = t59 * t77 + t46 + 0.1e1;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = -t18;
  t87 = my_piecewise5(t16, t13, t12, t17, t85 * t9);
  t88 = 0.1e1 + t87;
  t89 = t88 <= p->zeta_threshold;
  t90 = POW_1_3(t88);
  t91 = t90 * t90;
  t93 = my_piecewise3(t89, t25, t91 * t88);
  t94 = t93 * t31;
  t95 = rho[1] * rho[1];
  t96 = POW_1_3(rho[1]);
  t97 = t96 * t96;
  t99 = 0.1e1 / t97 / t95;
  t102 = 0.5e1 / 0.72e2 * t38 * sigma[2] * t99;
  t103 = t37 * sigma[2];
  t107 = t37 * lapl[1];
  t109 = 0.1e1 / t97 / rho[1];
  t113 = t47 * t103 * t99 / 0.24e2 + t52 * t107 * t109 / 0.24e2 - t102;
  t114 = t113 < -t63;
  t115 = -t66 < t113;
  t116 = my_piecewise3(t115, -t66, t113);
  t117 = -t63 < t116;
  t118 = my_piecewise3(t117, t116, -t63);
  t119 = fabs(t118);
  t120 = pow(t119, params->csk_a);
  t121 = 0.1e1 / t120;
  t122 = exp(-t121);
  t123 = 0.1e1 - t122;
  t124 = pow(t123, t62);
  t125 = my_piecewise5(t114, 0, t115, 1, t124);
  t127 = t113 * t125 + t102 + 0.1e1;
  t131 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t132 = t8 * t8;
  t133 = 0.1e1 / t132;
  t134 = t18 * t133;
  t136 = my_piecewise5(t12, 0, t16, 0, t9 - t134);
  t139 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t136);
  t140 = t139 * t31;
  t144 = 0.1e1 / t30;
  t145 = t29 * t144;
  t148 = t7 * t145 * t79 / 0.1e2;
  t151 = 0.1e1 / t41 / t39 / rho[0];
  t154 = 0.5e1 / 0.27e2 * t38 * sigma[0] * t151;
  t161 = -t47 * t48 * t151 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t53 * t43 + t154;
  t163 = t76 * t73;
  t164 = my_piecewise3(t67, 0, t161);
  t165 = my_piecewise3(t69, t164, 0);
  t167 = fabs(t70) / t70;
  t168 = 0.1e1 / t71;
  t170 = 0.1e1 / t75;
  t171 = t74 * t170;
  t172 = t167 * t168 * t171;
  t174 = my_piecewise5(t64, 0, t67, 0, -t163 * t165 * t172);
  t176 = t161 * t77 + t174 * t59 - t154;
  t181 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t79 + t148 + 0.3e1 / 0.2e2 * t7 * t32 * t176);
  t182 = t85 * t133;
  t184 = my_piecewise5(t16, 0, t12, 0, -t9 - t182);
  t187 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t184);
  t188 = t187 * t31;
  t192 = t93 * t144;
  t195 = t7 * t192 * t127 / 0.1e2;
  t197 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t127 + t195);
  tvrho0 = t83 + t131 + t8 * (t181 + t197);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t201 = my_piecewise5(t12, 0, t16, 0, -t9 - t134);
  t204 = my_piecewise3(t22, 0, 0.5e1 / 0.3e1 * t27 * t201);
  t205 = t204 * t31;
  t210 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t79 + t148);
  t212 = my_piecewise5(t16, 0, t12, 0, t9 - t182);
  t215 = my_piecewise3(t89, 0, 0.5e1 / 0.3e1 * t91 * t212);
  t216 = t215 * t31;
  t222 = 0.1e1 / t97 / t95 / rho[1];
  t225 = 0.5e1 / 0.27e2 * t38 * sigma[2] * t222;
  t232 = -t47 * t103 * t222 / 0.9e1 - 0.5e1 / 0.72e2 * t52 * t107 * t99 + t225;
  t234 = t124 * t121;
  t235 = my_piecewise3(t115, 0, t232);
  t236 = my_piecewise3(t117, t235, 0);
  t238 = fabs(t118) / t118;
  t239 = 0.1e1 / t119;
  t241 = 0.1e1 / t123;
  t242 = t122 * t241;
  t243 = t238 * t239 * t242;
  t245 = my_piecewise5(t114, 0, t115, 0, -t234 * t236 * t243);
  t247 = t113 * t245 + t125 * t232 - t225;
  t252 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t127 + t195 + 0.3e1 / 0.2e2 * t7 * t94 * t247);
  tvrho1 = t83 + t131 + t8 * (t210 + t252);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t256 = 0.5e1 / 0.72e2 * t38 * t43;
  t257 = t37 * t43;
  t260 = t47 * t257 / 0.24e2 - t256;
  t262 = my_piecewise3(t67, 0, t260);
  t263 = my_piecewise3(t69, t262, 0);
  t266 = my_piecewise5(t64, 0, t67, 0, -t163 * t263 * t172);
  t268 = t260 * t77 + t266 * t59 + t256;
  t272 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t268);
  tvsigma0 = t8 * t272;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t274 = 0.5e1 / 0.72e2 * t38 * t99;
  t275 = t37 * t99;
  t278 = t47 * t275 / 0.24e2 - t274;
  t280 = my_piecewise3(t115, 0, t278);
  t281 = my_piecewise3(t117, t280, 0);
  t284 = my_piecewise5(t114, 0, t115, 0, -t234 * t281 * t243);
  t286 = t113 * t284 + t125 * t278 + t274;
  t290 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t286);
  tvsigma2 = t8 * t290;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t291 = t37 * t55;
  t297 = my_piecewise3(t67, 0, t52 * t291 / 0.24e2);
  t298 = my_piecewise3(t69, t297, 0);
  t301 = my_piecewise5(t64, 0, t67, 0, -t163 * t298 * t172);
  t303 = t52 * t291 * t77 / 0.24e2 + t59 * t301;
  t307 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t303);
  tvlapl0 = t8 * t307;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t308 = t37 * t109;
  t314 = my_piecewise3(t115, 0, t52 * t308 / 0.24e2);
  t315 = my_piecewise3(t117, t314, 0);
  t318 = my_piecewise5(t114, 0, t115, 0, -t234 * t315 * t243);
  t320 = t52 * t308 * t125 / 0.24e2 + t113 * t318;
  t324 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t320);
  tvlapl1 = t8 * t324;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  tvtau0 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  tvtau1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t327 = 0.1e1 / t26;
  t328 = t136 * t136;
  t331 = t132 * t8;
  t332 = 0.1e1 / t331;
  t333 = t18 * t332;
  t336 = my_piecewise5(t12, 0, t16, 0, -0.2e1 * t133 + 0.2e1 * t333);
  t340 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t328 + 0.5e1 / 0.3e1 * t27 * t336);
  t341 = t340 * t31;
  t345 = t139 * t144;
  t347 = t7 * t345 * t79;
  t353 = 0.1e1 / t30 / t8;
  t354 = t29 * t353;
  t357 = t7 * t354 * t79 / 0.3e2;
  t359 = t7 * t145 * t176;
  t361 = t39 * t39;
  t363 = 0.1e1 / t41 / t361;
  t366 = 0.55e2 / 0.81e2 * t38 * sigma[0] * t363;
  t373 = 0.11e2 / 0.27e2 * t47 * t48 * t363 + 0.5e1 / 0.27e2 * t52 * t53 * t151 - t366;
  t377 = t72 * t72;
  t379 = t76 / t377;
  t380 = t165 * t165;
  t382 = t167 * t167;
  t383 = t71 * t71;
  t384 = 0.1e1 / t383;
  t385 = t382 * t384;
  t386 = t74 * t74;
  t387 = t75 * t75;
  t388 = 0.1e1 / t387;
  t389 = t386 * t388;
  t390 = t385 * t389;
  t392 = t380 * t382;
  t394 = t384 * t74;
  t395 = t170 * params->csk_a;
  t396 = t394 * t395;
  t398 = my_piecewise3(t67, 0, t373);
  t399 = my_piecewise3(t69, t398, 0);
  t402 = t163 * t380;
  t403 = 0.0;
  t405 = t403 * t168 * t171;
  t406 = t402 * t405;
  t407 = t385 * t171;
  t409 = t379 * t392;
  t411 = t384 * t386;
  t412 = t388 * params->csk_a;
  t413 = t411 * t412;
  t416 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t399 + t163 * t392 * t396 + t379 * t380 * t390 - t396 * t409 + t402 * t407 - t409 * t413 - t406);
  t418 = 0.2e1 * t161 * t174 + t373 * t77 + t416 * t59 + t366;
  t423 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t79 + t347 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t176 - t357 + t359 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t418);
  t424 = 0.1e1 / t90;
  t425 = t184 * t184;
  t428 = t85 * t332;
  t431 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t133 + 0.2e1 * t428);
  t435 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t425 + 0.5e1 / 0.3e1 * t91 * t431);
  t436 = t435 * t31;
  t440 = t187 * t144;
  t442 = t7 * t440 * t127;
  t444 = t93 * t353;
  t447 = t7 * t444 * t127 / 0.3e2;
  t449 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t127 + t442 / 0.5e1 - t447);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t197 + t8 * (t423 + t449);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t452 = t327 * t201;
  t456 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t333);
  t460 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t452 * t136 + 0.5e1 / 0.3e1 * t27 * t456);
  t461 = t460 * t31;
  t465 = t204 * t144;
  t467 = t7 * t465 * t79;
  t475 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t79 + t467 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t176 + t347 / 0.1e2 - t357 + t359 / 0.1e2);
  t476 = t424 * t212;
  t480 = my_piecewise5(t16, 0, t12, 0, 0.2e1 * t428);
  t484 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t476 * t184 + 0.5e1 / 0.3e1 * t91 * t480);
  t485 = t484 * t31;
  t489 = t215 * t144;
  t491 = t7 * t489 * t127;
  t498 = t7 * t192 * t247;
  t501 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t127 + t491 / 0.1e2 + t442 / 0.1e2 - t447 + 0.3e1 / 0.2e2 * t7 * t188 * t247 + t498 / 0.1e2);
  tv2rho21 = t181 + t197 + t210 + t252 + t8 * (t475 + t501);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t506 = t201 * t201;
  t511 = my_piecewise5(t12, 0, t16, 0, 0.2e1 * t133 + 0.2e1 * t333);
  t515 = my_piecewise3(t22, 0, 0.1e2 / 0.9e1 * t327 * t506 + 0.5e1 / 0.3e1 * t27 * t511);
  t516 = t515 * t31;
  t522 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t79 + t467 / 0.5e1 - t357);
  t523 = t212 * t212;
  t528 = my_piecewise5(t16, 0, t12, 0, -0.2e1 * t133 + 0.2e1 * t428);
  t532 = my_piecewise3(t89, 0, 0.1e2 / 0.9e1 * t424 * t523 + 0.5e1 / 0.3e1 * t91 * t528);
  t533 = t532 * t31;
  t542 = t95 * t95;
  t544 = 0.1e1 / t97 / t542;
  t547 = 0.55e2 / 0.81e2 * t38 * sigma[2] * t544;
  t554 = 0.11e2 / 0.27e2 * t47 * t103 * t544 + 0.5e1 / 0.27e2 * t52 * t107 * t222 - t547;
  t558 = t120 * t120;
  t560 = t124 / t558;
  t561 = t236 * t236;
  t563 = t238 * t238;
  t564 = t119 * t119;
  t565 = 0.1e1 / t564;
  t566 = t563 * t565;
  t567 = t122 * t122;
  t568 = t123 * t123;
  t569 = 0.1e1 / t568;
  t570 = t567 * t569;
  t571 = t566 * t570;
  t573 = t561 * t563;
  t575 = t565 * t122;
  t576 = t241 * params->csk_a;
  t577 = t575 * t576;
  t579 = my_piecewise3(t115, 0, t554);
  t580 = my_piecewise3(t117, t579, 0);
  t583 = t234 * t561;
  t584 = 0.0;
  t586 = t584 * t239 * t242;
  t587 = t583 * t586;
  t588 = t566 * t242;
  t590 = t560 * t573;
  t592 = t565 * t567;
  t593 = t569 * params->csk_a;
  t594 = t592 * t593;
  t597 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t580 + t234 * t573 * t577 + t560 * t561 * t571 - t577 * t590 + t583 * t588 - t590 * t594 - t587);
  t599 = t113 * t597 + t125 * t554 + 0.2e1 * t232 * t245 + t547;
  t604 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t127 + t491 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t247 - t447 + t498 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t599);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t252 + t8 * (t522 + t604);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t612 = t7 * t145 * t268 / 0.1e2;
  t614 = 0.5e1 / 0.27e2 * t38 * t151;
  t615 = t37 * t151;
  t618 = -t47 * t615 / 0.9e1 + t614;
  t622 = t165 * t382;
  t623 = t379 * t622;
  t624 = t388 * t263;
  t625 = t411 * t624;
  t627 = t263 * t382;
  t628 = t163 * t627;
  t629 = t395 * t165;
  t630 = t394 * t629;
  t632 = my_piecewise3(t67, 0, t618);
  t633 = my_piecewise3(t69, t632, 0);
  t636 = t263 * t165;
  t638 = t163 * t636 * t405;
  t639 = t170 * t165;
  t640 = t394 * t639;
  t642 = t379 * t627;
  t644 = t412 * t165;
  t645 = t411 * t644;
  t648 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t633 + t623 * t625 + t628 * t630 + t628 * t640 - t630 * t642 - t642 * t645 - t638);
  t650 = t161 * t266 + t174 * t260 + t59 * t648 + t618 * t77 - t614;
  t655 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t268 + t612 + 0.3e1 / 0.2e2 * t7 * t32 * t650);
  tv2rhosigma0 = t655 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t662 = t7 * t192 * t286 / 0.1e2;
  t664 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t286 + t662);
  tv2rhosigma2 = t664 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t670 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t268 + t612);
  tv2rhosigma3 = t670 * t8 + t272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t676 = 0.5e1 / 0.27e2 * t38 * t222;
  t677 = t37 * t222;
  t680 = -t47 * t677 / 0.9e1 + t676;
  t684 = t236 * t563;
  t685 = t560 * t684;
  t686 = t569 * t281;
  t687 = t592 * t686;
  t689 = t281 * t563;
  t690 = t234 * t689;
  t692 = t575 * t576 * t236;
  t694 = my_piecewise3(t115, 0, t680);
  t695 = my_piecewise3(t117, t694, 0);
  t698 = t281 * t236;
  t700 = t234 * t698 * t586;
  t701 = t241 * t236;
  t702 = t575 * t701;
  t704 = t560 * t689;
  t706 = t593 * t236;
  t707 = t592 * t706;
  t710 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t695 + t685 * t687 + t690 * t692 + t690 * t702 - t692 * t704 - t704 * t707 - t700);
  t712 = t113 * t710 + t125 * t680 + t232 * t284 + t245 * t278 - t676;
  t717 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t286 + t662 + 0.3e1 / 0.2e2 * t7 * t94 * t712);
  tv2rhosigma5 = t717 * t8 + t290;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t724 = t7 * t145 * t303 / 0.1e2;
  t732 = t388 * t298;
  t733 = t411 * t732;
  t735 = t298 * t382;
  t736 = t163 * t735;
  t740 = my_piecewise3(t67, 0, -0.5e1 / 0.72e2 * t52 * t257);
  t741 = my_piecewise3(t69, t740, 0);
  t744 = t298 * t165;
  t746 = t163 * t744 * t405;
  t748 = t379 * t735;
  t752 = my_piecewise5(t64, 0, t67, 0, -t163 * t172 * t741 + t623 * t733 + t630 * t736 - t630 * t748 + t640 * t736 - t645 * t748 - t746);
  t754 = -0.5e1 / 0.72e2 * t52 * t257 * t77 + t52 * t291 * t174 / 0.24e2 + t161 * t301 + t59 * t752;
  t759 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t303 + t724 + 0.3e1 / 0.2e2 * t7 * t32 * t754);
  tv2rholapl0 = t759 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t766 = t7 * t192 * t320 / 0.1e2;
  t768 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t320 + t766);
  tv2rholapl1 = t768 * t8 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  t774 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t303 + t724);
  tv2rholapl2 = t774 * t8 + t307;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  t786 = t569 * t315;
  t787 = t592 * t786;
  t789 = t315 * t563;
  t790 = t234 * t789;
  t794 = my_piecewise3(t115, 0, -0.5e1 / 0.72e2 * t52 * t275);
  t795 = my_piecewise3(t117, t794, 0);
  t798 = t315 * t236;
  t800 = t234 * t798 * t586;
  t802 = t560 * t789;
  t806 = my_piecewise5(t114, 0, t115, 0, -t234 * t243 * t795 + t685 * t787 + t692 * t790 - t692 * t802 + t702 * t790 - t707 * t802 - t800);
  t808 = -0.5e1 / 0.72e2 * t52 * t275 * t125 + t52 * t308 * t245 / 0.24e2 + t232 * t318 + t113 * t806;
  t813 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t320 + t766 + 0.3e1 / 0.2e2 * t7 * t94 * t808);
  tv2rholapl3 = t8 * t813 + t324;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  tv2rhotau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  tv2rhotau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  tv2rhotau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  tv2rhotau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t817 = t263 * t263;
  t820 = t817 * t382;
  t823 = my_piecewise3(t67, 0, 0);
  t824 = my_piecewise3(t69, t823, 0);
  t826 = t163 * t824 * t172;
  t827 = t163 * t817;
  t828 = t827 * t405;
  t830 = t379 * t820;
  t834 = my_piecewise5(t64, 0, t67, 0, t163 * t396 * t820 + t379 * t390 * t817 - t396 * t830 + t407 * t827 - t413 * t830 - t826 - t828);
  t836 = 0.2e1 * t260 * t266 + t59 * t834;
  t840 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t836);
  tv2sigma20 = t8 * t840;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t843 = t281 * t281;
  t846 = t843 * t563;
  t849 = my_piecewise3(t115, 0, 0);
  t850 = my_piecewise3(t117, t849, 0);
  t852 = t234 * t850 * t243;
  t853 = t234 * t843;
  t854 = t853 * t586;
  t856 = t560 * t846;
  t860 = my_piecewise5(t114, 0, t115, 0, t234 * t577 * t846 + t560 * t571 * t843 - t577 * t856 + t588 * t853 - t594 * t856 - t852 - t854);
  t862 = t113 * t860 + 0.2e1 * t278 * t284;
  t866 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t862);
  tv2sigma25 = t8 * t866;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t872 = t395 * t263;
  t873 = t394 * t872;
  t875 = t298 * t263;
  t876 = t163 * t875;
  t877 = t876 * t405;
  t878 = t170 * t263;
  t879 = t394 * t878;
  t882 = t412 * t263;
  t883 = t411 * t882;
  t886 = my_piecewise5(t64, 0, t67, 0, t642 * t733 + t736 * t873 + t736 * t879 - t748 * t873 - t748 * t883 - t826 - t877);
  t888 = t52 * t291 * t266 / 0.24e2 + t260 * t301 + t59 * t886;
  t892 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t888);
  tv2sigmalapl0 = t8 * t892;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  t898 = t576 * t281;
  t899 = t575 * t898;
  t901 = t315 * t281;
  t902 = t234 * t901;
  t903 = t902 * t586;
  t904 = t241 * t281;
  t905 = t575 * t904;
  t908 = t593 * t281;
  t909 = t592 * t908;
  t912 = my_piecewise5(t114, 0, t115, 0, t704 * t787 + t790 * t899 + t790 * t905 - t802 * t899 - t802 * t909 - t852 - t903);
  t914 = t52 * t308 * t284 / 0.24e2 + t278 * t318 + t113 * t912;
  t918 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t914);
  tv2sigmalapl5 = t8 * t918;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  tv2sigmatau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  tv2sigmatau5 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t922 = t298 * t298;
  t925 = t922 * t382;
  t926 = t163 * t925;
  t928 = t163 * t922;
  t929 = t928 * t405;
  t931 = t379 * t925;
  t935 = my_piecewise5(t64, 0, t67, 0, t379 * t390 * t922 + t396 * t926 - t396 * t931 + t407 * t928 - t413 * t931 - t826 - t929);
  t937 = t52 * t291 * t301 / 0.12e2 + t59 * t935;
  t941 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t937);
  tv2lapl20 = t8 * t941;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  t945 = t315 * t315;
  t948 = t945 * t563;
  t949 = t234 * t948;
  t951 = t234 * t945;
  t952 = t951 * t586;
  t954 = t560 * t948;
  t958 = my_piecewise5(t114, 0, t115, 0, t560 * t571 * t945 + t577 * t949 - t577 * t954 + t588 * t951 - t594 * t954 - t852 - t952);
  t960 = t52 * t308 * t318 / 0.12e2 + t113 * t958;
  t964 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t960);
  tv2lapl22 = t8 * t964;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2tau20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  tv2tau22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

  t968 = 0.1e1 / t26 / t21;
  t969 = t328 * t136;
  t972 = t327 * t136;
  t975 = t132 * t132;
  t976 = 0.1e1 / t975;
  t977 = t18 * t976;
  t980 = my_piecewise5(t12, 0, t16, 0, 0.6e1 * t332 - 0.6e1 * t977);
  t984 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t968 * t969 + 0.1e2 / 0.3e1 * t972 * t336 + 0.5e1 / 0.3e1 * t27 * t980);
  t985 = t984 * t31;
  t989 = t340 * t144;
  t991 = t7 * t989 * t79;
  t996 = t139 * t353;
  t998 = t7 * t996 * t79;
  t1001 = t7 * t345 * t176;
  t1007 = 0.1e1 / t30 / t132;
  t1008 = t29 * t1007;
  t1011 = 0.2e1 / 0.45e2 * t7 * t1008 * t79;
  t1013 = t7 * t354 * t176;
  t1016 = t7 * t145 * t418;
  t1020 = 0.1e1 / t41 / t361 / rho[0];
  t1023 = 0.77e3 / 0.243e3 * t38 * sigma[0] * t1020;
  t1030 = -0.154e3 / 0.81e2 * t47 * t48 * t1020 - 0.55e2 / 0.81e2 * t52 * t53 * t363 + t1023;
  t1038 = t76 / t377 / t72;
  t1039 = t380 * t165;
  t1040 = t382 * t167;
  t1041 = t1039 * t1040;
  t1042 = t1038 * t1041;
  t1044 = 0.1e1 / t383 / t71;
  t1045 = t1044 * t386;
  t1046 = t1045 * t412;
  t1049 = t163 * t1041;
  t1050 = t1044 * t74;
  t1051 = params->csk_a * params->csk_a;
  t1052 = t170 * t1051;
  t1053 = t1050 * t1052;
  t1055 = t388 * t399;
  t1059 = t386 * t74;
  t1060 = t1044 * t1059;
  t1062 = 0.1e1 / t387 / t75;
  t1063 = t1062 * params->csk_a;
  t1064 = t1060 * t1063;
  t1067 = t379 * t1041;
  t1068 = t388 * t1051;
  t1069 = t1045 * t1068;
  t1074 = t163 * t399 * t165 * t405;
  t1078 = t1062 * t1051;
  t1079 = t1060 * t1078;
  t1082 = t1044 * params->csk_a;
  t1083 = t1082 * t171;
  t1088 = t1039 * t167;
  t1090 = t388 * t403;
  t1091 = t411 * t1090;
  t1092 = t379 * t1088 * t1091;
  t1094 = t399 * t382;
  t1098 = t1039 * t403;
  t1100 = t170 * t167;
  t1101 = t394 * t1100;
  t1102 = t163 * t1098 * t1101;
  t1104 = 0.3e1 * t1055 * t411 * t623 + 0.3e1 * t1094 * t163 * t640 + 0.3e1 * t1042 * t1046 + 0.3e1 * t1042 * t1064 - 0.3e1 * t1042 * t1069 - 0.2e1 * t1042 * t1079 - t1049 * t1053 - 0.3e1 * t1049 * t1083 + 0.3e1 * t1067 * t1069 + 0.3e1 * t1067 * t1083 - 0.3e1 * t1074 + 0.3e1 * t1092 + 0.3e1 * t1102;
  t1108 = t379 * t1094;
  t1111 = t379 * t1098;
  t1112 = t384 * params->csk_a;
  t1114 = t167 * t74 * t170;
  t1115 = t1112 * t1114;
  t1116 = t1111 * t1115;
  t1119 = t395 * t403;
  t1120 = t394 * t1119;
  t1121 = t163 * t1088 * t1120;
  t1124 = t395 * t399;
  t1125 = t394 * t1124;
  t1131 = t411 * t412 * t167;
  t1132 = t1111 * t1131;
  t1135 = t1040 * t1044;
  t1136 = t1059 * t1062;
  t1137 = t1135 * t1136;
  t1139 = my_piecewise3(t67, 0, t1030);
  t1140 = my_piecewise3(t69, t1139, 0);
  t1144 = t1135 * t389;
  t1148 = t1135 * t171;
  t1151 = -t1038 * t1039 * t1137 - 0.3e1 * t1039 * t1144 * t379 - 0.2e1 * t1039 * t1148 * t163 + 0.3e1 * t1125 * t163 * t622 - t1140 * t163 * t172 - t1042 * t1053 + 0.3e1 * t1053 * t1067 - 0.3e1 * t1108 * t630 - 0.3e1 * t1108 * t645 - 0.3e1 * t1116 + 0.3e1 * t1121 - 0.3e1 * t1132 - t406;
  t1153 = my_piecewise5(t64, 0, t67, 0, t1104 + t1151);
  t1155 = t1030 * t77 + t1153 * t59 + 0.3e1 * t161 * t416 + 0.3e1 * t174 * t373 - t1023;
  t1160 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t985 * t79 + 0.3e1 / 0.1e2 * t991 + 0.9e1 / 0.2e2 * t7 * t341 * t176 - t998 / 0.1e2 + 0.3e1 / 0.5e1 * t1001 + 0.9e1 / 0.2e2 * t7 * t140 * t418 + t1011 - t1013 / 0.1e2 + 0.3e1 / 0.1e2 * t1016 + 0.3e1 / 0.2e2 * t7 * t32 * t1155);
  t1162 = 0.1e1 / t90 / t88;
  t1163 = t425 * t184;
  t1166 = t424 * t184;
  t1169 = t85 * t976;
  t1172 = my_piecewise5(t16, 0, t12, 0, -0.6e1 * t332 - 0.6e1 * t1169);
  t1176 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1162 * t1163 + 0.1e2 / 0.3e1 * t1166 * t431 + 0.5e1 / 0.3e1 * t91 * t1172);
  t1177 = t1176 * t31;
  t1181 = t435 * t144;
  t1183 = t7 * t1181 * t127;
  t1185 = t187 * t353;
  t1187 = t7 * t1185 * t127;
  t1189 = t93 * t1007;
  t1192 = 0.2e1 / 0.45e2 * t7 * t1189 * t127;
  t1194 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1177 * t127 + 0.3e1 / 0.1e2 * t1183 - t1187 / 0.1e2 + t1192);
  tv3rho30 = 0.3e1 * t423 + 0.3e1 * t449 + t8 * (t1160 + t1194);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1197 = 0.2e1 * t475;
  t1198 = 0.2e1 * t501;
  t1199 = t968 * t201;
  t1202 = t327 * t456;
  t1207 = 0.2e1 * t332;
  t1208 = 0.6e1 * t977;
  t1210 = my_piecewise5(t12, 0, t16, 0, t1207 - t1208);
  t1214 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1199 * t328 + 0.2e2 / 0.9e1 * t1202 * t136 + 0.1e2 / 0.9e1 * t452 * t336 + 0.5e1 / 0.3e1 * t27 * t1210);
  t1215 = t1214 * t31;
  t1219 = t460 * t144;
  t1222 = t7 * t1219 * t79 / 0.5e1;
  t1226 = t204 * t353;
  t1228 = t7 * t1226 * t79;
  t1232 = t7 * t465 * t176 / 0.5e1;
  t1241 = 0.3e1 / 0.2e2 * t7 * t1215 * t79 + t1222 + 0.3e1 / 0.1e2 * t7 * t461 * t176 - t1228 / 0.3e2 + t1232 + 0.3e1 / 0.2e2 * t7 * t205 * t418 + t991 / 0.1e2 - t998 / 0.15e2 + t1001 / 0.5e1 + t1011 - t1013 / 0.15e2 + t1016 / 0.1e2;
  t1242 = my_piecewise3(t2, 0, t1241);
  t1243 = t1162 * t212;
  t1246 = t424 * t480;
  t1251 = 0.6e1 * t1169;
  t1253 = my_piecewise5(t16, 0, t12, 0, -t1207 - t1251);
  t1257 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1243 * t425 + 0.2e2 / 0.9e1 * t1246 * t184 + 0.1e2 / 0.9e1 * t476 * t431 + 0.5e1 / 0.3e1 * t91 * t1253);
  t1258 = t1257 * t31;
  t1262 = t484 * t144;
  t1265 = t7 * t1262 * t127 / 0.5e1;
  t1266 = t215 * t353;
  t1268 = t7 * t1266 * t127;
  t1277 = t7 * t440 * t247 / 0.5e1;
  t1279 = t7 * t444 * t247;
  t1282 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1258 * t127 + t1265 - t1268 / 0.3e2 + t1183 / 0.1e2 - t1187 / 0.15e2 + t1192 + 0.3e1 / 0.2e2 * t7 * t436 * t247 + t1277 - t1279 / 0.3e2);
  tv3rho31 = t423 + t449 + t1197 + t1198 + t8 * (t1242 + t1282);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1285 = t968 * t506;
  t1290 = t327 * t511;
  t1294 = my_piecewise5(t12, 0, t16, 0, -t1207 - t1208);
  t1298 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t1285 * t136 + 0.2e2 / 0.9e1 * t452 * t456 + 0.1e2 / 0.9e1 * t1290 * t136 + 0.5e1 / 0.3e1 * t27 * t1294);
  t1299 = t1298 * t31;
  t1303 = t515 * t144;
  t1305 = t7 * t1303 * t79;
  t1314 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1299 * t79 + t1305 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t516 * t176 + t1222 - t1228 / 0.15e2 + t1232 - t998 / 0.3e2 + t1011 - t1013 / 0.3e2);
  t1315 = t1162 * t523;
  t1320 = t424 * t528;
  t1324 = my_piecewise5(t16, 0, t12, 0, t1207 - t1251);
  t1328 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1315 * t184 + 0.2e2 / 0.9e1 * t476 * t480 + 0.1e2 / 0.9e1 * t1320 * t184 + 0.5e1 / 0.3e1 * t91 * t1324);
  t1329 = t1328 * t31;
  t1333 = t532 * t144;
  t1335 = t7 * t1333 * t127;
  t1342 = t7 * t489 * t247;
  t1350 = t7 * t192 * t599;
  t1352 = 0.3e1 / 0.2e2 * t7 * t1329 * t127 + t1335 / 0.1e2 + t1265 - t1268 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t485 * t247 + t1342 / 0.5e1 - t1187 / 0.3e2 + t1192 + t1277 - t1279 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t188 * t599 + t1350 / 0.1e2;
  t1353 = my_piecewise3(t84, 0, t1352);
  tv3rho32 = t1197 + t1198 + t522 + t604 + t8 * (t1314 + t1353);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1358 = t506 * t201;
  t1365 = my_piecewise5(t12, 0, t16, 0, -0.6e1 * t332 - 0.6e1 * t977);
  t1369 = my_piecewise3(t22, 0, -0.1e2 / 0.27e2 * t968 * t1358 + 0.1e2 / 0.3e1 * t452 * t511 + 0.5e1 / 0.3e1 * t27 * t1365);
  t1370 = t1369 * t31;
  t1377 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1370 * t79 + 0.3e1 / 0.1e2 * t1305 - t1228 / 0.1e2 + t1011);
  t1378 = t523 * t212;
  t1385 = my_piecewise5(t16, 0, t12, 0, 0.6e1 * t332 - 0.6e1 * t1169);
  t1389 = my_piecewise3(t89, 0, -0.1e2 / 0.27e2 * t1162 * t1378 + 0.1e2 / 0.3e1 * t476 * t528 + 0.5e1 / 0.3e1 * t91 * t1385);
  t1390 = t1389 * t31;
  t1407 = 0.1e1 / t97 / t542 / rho[1];
  t1410 = 0.77e3 / 0.243e3 * t38 * sigma[2] * t1407;
  t1417 = -0.154e3 / 0.81e2 * t47 * t103 * t1407 - 0.55e2 / 0.81e2 * t52 * t107 * t544 + t1410;
  t1423 = t569 * t580;
  t1429 = t124 / t558 / t120;
  t1430 = t561 * t236;
  t1431 = t563 * t238;
  t1432 = t1430 * t1431;
  t1433 = t1429 * t1432;
  t1435 = 0.1e1 / t564 / t119;
  t1436 = t567 * t122;
  t1437 = t1435 * t1436;
  t1439 = 0.1e1 / t568 / t123;
  t1440 = t1439 * params->csk_a;
  t1441 = t1437 * t1440;
  t1444 = t560 * t1432;
  t1445 = t1435 * t567;
  t1446 = t569 * t1051;
  t1447 = t1445 * t1446;
  t1452 = t234 * t580 * t236 * t586;
  t1456 = t1439 * t1051;
  t1457 = t1437 * t1456;
  t1460 = t1435 * t1051;
  t1461 = t1460 * t242;
  t1463 = t1435 * params->csk_a;
  t1464 = t1463 * t242;
  t1467 = t234 * t1432;
  t1470 = t1430 * t238;
  t1472 = t569 * t584;
  t1473 = t592 * t1472;
  t1474 = t560 * t1470 * t1473;
  t1476 = t580 * t563;
  t1480 = t1430 * t584;
  t1482 = t241 * t238;
  t1483 = t575 * t1482;
  t1484 = t234 * t1480 * t1483;
  t1486 = t1445 * t593;
  t1489 = 0.3e1 * t1423 * t592 * t685 + 0.3e1 * t1476 * t234 * t702 + 0.3e1 * t1433 * t1441 - 0.3e1 * t1433 * t1447 - 0.2e1 * t1433 * t1457 - t1433 * t1461 + 0.3e1 * t1433 * t1486 + 0.3e1 * t1444 * t1447 + 0.3e1 * t1444 * t1464 - 0.3e1 * t1464 * t1467 - 0.3e1 * t1452 + 0.3e1 * t1474 + 0.3e1 * t1484;
  t1493 = t560 * t1476;
  t1496 = t560 * t1480;
  t1497 = t565 * params->csk_a;
  t1499 = t238 * t122 * t241;
  t1500 = t1497 * t1499;
  t1501 = t1496 * t1500;
  t1504 = t576 * t584;
  t1505 = t575 * t1504;
  t1506 = t234 * t1470 * t1505;
  t1509 = t592 * t593 * t238;
  t1510 = t1496 * t1509;
  t1513 = t576 * t580;
  t1514 = t575 * t1513;
  t1520 = t1431 * t1435;
  t1521 = t1436 * t1439;
  t1522 = t1520 * t1521;
  t1524 = my_piecewise3(t115, 0, t1417);
  t1525 = my_piecewise3(t117, t1524, 0);
  t1529 = t1520 * t242;
  t1533 = t1520 * t570;
  t1536 = -t1429 * t1430 * t1522 - 0.2e1 * t1430 * t1529 * t234 - 0.3e1 * t1430 * t1533 * t560 + 0.3e1 * t1514 * t234 * t684 - t1525 * t234 * t243 + 0.3e1 * t1444 * t1461 - t1461 * t1467 - 0.3e1 * t1493 * t692 - 0.3e1 * t1493 * t707 - 0.3e1 * t1501 + 0.3e1 * t1506 - 0.3e1 * t1510 - t587;
  t1538 = my_piecewise5(t114, 0, t115, 0, t1489 + t1536);
  t1540 = t113 * t1538 + t125 * t1417 + 0.3e1 * t232 * t597 + 0.3e1 * t245 * t554 - t1410;
  t1545 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1390 * t127 + 0.3e1 / 0.1e2 * t1335 + 0.9e1 / 0.2e2 * t7 * t533 * t247 - t1268 / 0.1e2 + 0.3e1 / 0.5e1 * t1342 + 0.9e1 / 0.2e2 * t7 * t216 * t599 + t1192 - t1279 / 0.1e2 + 0.3e1 / 0.1e2 * t1350 + 0.3e1 / 0.2e2 * t7 * t94 * t1540);
  tv3rho33 = 0.3e1 * t522 + 0.3e1 * t604 + t8 * (t1377 + t1545);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1553 = t7 * t345 * t268;
  t1560 = t7 * t354 * t268 / 0.3e2;
  t1562 = t7 * t145 * t650;
  t1565 = 0.55e2 / 0.81e2 * t38 * t363;
  t1566 = t37 * t363;
  t1569 = 0.11e2 / 0.27e2 * t47 * t1566 - t1565;
  t1577 = t263 * t1040;
  t1578 = t163 * t1577;
  t1579 = t170 * t380;
  t1580 = t1050 * t1579;
  t1583 = t380 * t1040;
  t1584 = t379 * t1583;
  t1585 = t1045 * t624;
  t1588 = t1038 * t1583;
  t1589 = t1062 * t263;
  t1592 = t633 * t165;
  t1594 = t163 * t1592 * t405;
  t1598 = t163 * t263 * t399 * t405;
  t1599 = t170 * t399;
  t1600 = t394 * t1599;
  t1602 = t633 * t382;
  t1603 = t163 * t1602;
  t1607 = t388 * t633;
  t1608 = t411 * t1607;
  t1611 = t1045 * t882;
  t1615 = t1050 * t1052 * t380;
  t1617 = t379 * t1577;
  t1620 = t1038 * t1577;
  t1623 = t1044 * t1051;
  t1625 = t380 * t386 * t388;
  t1626 = t1623 * t1625;
  t1629 = -t1060 * t1588 * t1589 + t1108 * t625 - t1125 * t642 - 0.2e1 * t1578 * t1580 - t1578 * t1615 - 0.3e1 * t1584 * t1585 + 0.3e1 * t1588 * t1611 + t1600 * t628 + 0.2e1 * t1603 * t640 + 0.2e1 * t1608 * t623 + 0.3e1 * t1615 * t1617 - t1615 * t1620 - 0.3e1 * t1620 * t1626 - 0.2e1 * t1594 - t1598 - t638;
  t1630 = t412 * t399;
  t1631 = t411 * t1630;
  t1633 = t1078 * t380;
  t1634 = t1060 * t1633;
  t1642 = t379 * t1602;
  t1645 = t1589 * params->csk_a;
  t1646 = t1060 * t1645;
  t1650 = t380 * t74 * t170;
  t1651 = t1082 * t1650;
  t1658 = t263 * t380;
  t1661 = t403 * t384 * t1114;
  t1662 = t163 * t1658 * t1661;
  t1664 = t380 * t167;
  t1665 = t379 * t1664;
  t1666 = t624 * t403;
  t1667 = t411 * t1666;
  t1668 = t1665 * t1667;
  t1670 = t263 * t167;
  t1671 = t1670 * t384;
  t1672 = t163 * t1671;
  t1673 = params->csk_a * t380;
  t1674 = t1673 * t403;
  t1675 = t171 * t1674;
  t1676 = t1672 * t1675;
  t1678 = t1658 * t403;
  t1679 = t379 * t1678;
  t1680 = t1679 * t1131;
  t1682 = t1679 * t1115;
  t1684 = my_piecewise3(t67, 0, t1569);
  t1685 = my_piecewise3(t69, t1684, 0);
  t1688 = -t163 * t1685 * t172 + t1125 * t628 - 0.3e1 * t1578 * t1651 + 0.3e1 * t1588 * t1646 + 0.2e1 * t1603 * t630 + 0.3e1 * t1617 * t1626 + 0.3e1 * t1617 * t1651 - 0.2e1 * t1620 * t1634 - t1631 * t642 - 0.2e1 * t1642 * t630 - 0.2e1 * t1642 * t645 + 0.3e1 * t1662 + 0.3e1 * t1668 + 0.3e1 * t1676 - 0.3e1 * t1680 - 0.3e1 * t1682;
  t1690 = my_piecewise5(t64, 0, t67, 0, t1629 + t1688);
  t1692 = t1569 * t77 + 0.2e1 * t161 * t648 + t1690 * t59 + 0.2e1 * t174 * t618 + t260 * t416 + t266 * t373 + t1565;
  t1697 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t268 + t1553 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t650 - t1560 + t1562 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t1692);
  tv3rho2sigma0 = t1697 * t8 + 0.2e1 * t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1704 = t7 * t440 * t286;
  t1708 = t7 * t444 * t286 / 0.3e2;
  t1710 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t286 + t1704 / 0.5e1 - t1708);
  tv3rho2sigma2 = t1710 * t8 + 0.2e1 * t664;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1716 = t7 * t465 * t268;
  t1724 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t268 + t1716 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t650 + t1553 / 0.1e2 - t1560 + t1562 / 0.1e2);
  tv3rho2sigma3 = t1724 * t8 + t655 + t670;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t1730 = t7 * t489 * t286;
  t1737 = t7 * t192 * t712;
  t1740 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t286 + t1730 / 0.1e2 + t1704 / 0.1e2 - t1708 + 0.3e1 / 0.2e2 * t7 * t188 * t712 + t1737 / 0.1e2);
  tv3rho2sigma5 = t1740 * t8 + t664 + t717;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t1748 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t268 + t1716 / 0.5e1 - t1560);
  tv3rho2sigma6 = t1748 * t8 + 0.2e1 * t670;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t1760 = 0.55e2 / 0.81e2 * t38 * t544;
  t1761 = t37 * t544;
  t1764 = 0.11e2 / 0.27e2 * t47 * t1761 - t1760;
  t1772 = t695 * t563;
  t1773 = t234 * t1772;
  t1776 = t561 * t1431;
  t1777 = t560 * t1776;
  t1778 = t1445 * t686;
  t1781 = t281 * t1431;
  t1782 = t234 * t1781;
  t1783 = t1435 * t122;
  t1784 = t241 * t561;
  t1785 = t1783 * t1784;
  t1788 = t241 * t580;
  t1789 = t575 * t1788;
  t1791 = t1429 * t1776;
  t1792 = t1439 * t281;
  t1797 = t234 * t695 * t236 * t586;
  t1801 = t234 * t281 * t580 * t586;
  t1803 = t569 * t695;
  t1804 = t592 * t1803;
  t1807 = t1429 * t1781;
  t1809 = t561 * t122 * t241;
  t1810 = t1460 * t1809;
  t1812 = t1445 * t908;
  t1816 = t560 * t1781;
  t1821 = t561 * t567 * t569;
  t1822 = t1460 * t1821;
  t1825 = -t1437 * t1791 * t1792 + t1493 * t687 - t1514 * t704 + 0.2e1 * t1773 * t702 - 0.3e1 * t1777 * t1778 - 0.2e1 * t1782 * t1785 - t1782 * t1810 + t1789 * t690 + 0.3e1 * t1791 * t1812 + 0.2e1 * t1804 * t685 - t1807 * t1810 - 0.3e1 * t1807 * t1822 + 0.3e1 * t1810 * t1816 - 0.2e1 * t1797 - t1801 - t700;
  t1826 = t593 * t580;
  t1827 = t592 * t1826;
  t1829 = t1456 * t561;
  t1830 = t1437 * t1829;
  t1833 = t1792 * params->csk_a;
  t1834 = t1437 * t1833;
  t1842 = t560 * t1772;
  t1845 = t1463 * t1809;
  t1852 = t561 * t238;
  t1853 = t560 * t1852;
  t1854 = t686 * t584;
  t1855 = t592 * t1854;
  t1856 = t1853 * t1855;
  t1858 = t281 * t561;
  t1861 = t584 * t565 * t1499;
  t1862 = t234 * t1858 * t1861;
  t1864 = t1858 * t584;
  t1865 = t560 * t1864;
  t1866 = t1865 * t1509;
  t1868 = t1865 * t1500;
  t1870 = t281 * t238;
  t1871 = t1870 * t565;
  t1872 = t234 * t1871;
  t1874 = params->csk_a * t561 * t584;
  t1875 = t242 * t1874;
  t1876 = t1872 * t1875;
  t1878 = my_piecewise3(t115, 0, t1764);
  t1879 = my_piecewise3(t117, t1878, 0);
  t1882 = -t1879 * t234 * t243 + t1514 * t690 + 0.2e1 * t1773 * t692 - 0.3e1 * t1782 * t1845 + 0.3e1 * t1791 * t1834 - 0.2e1 * t1807 * t1830 + 0.3e1 * t1816 * t1822 + 0.3e1 * t1816 * t1845 - t1827 * t704 - 0.2e1 * t1842 * t692 - 0.2e1 * t1842 * t707 + 0.3e1 * t1856 + 0.3e1 * t1862 - 0.3e1 * t1866 - 0.3e1 * t1868 + 0.3e1 * t1876;
  t1884 = my_piecewise5(t114, 0, t115, 0, t1825 + t1882);
  t1886 = t113 * t1884 + t125 * t1764 + 0.2e1 * t232 * t710 + 0.2e1 * t245 * t680 + t278 * t597 + t284 * t554 + t1760;
  t1891 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t286 + t1730 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t712 - t1708 + t1737 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t1886);
  tv3rho2sigma8 = t8 * t1891 + 0.2e1 * t717;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t1898 = t7 * t345 * t303;
  t1905 = t7 * t354 * t303 / 0.3e2;
  t1907 = t7 * t145 * t754;
  t1922 = t388 * t741;
  t1923 = t411 * t1922;
  t1926 = t1062 * t298;
  t1927 = t1060 * t1926;
  t1929 = t741 * t165;
  t1931 = t163 * t1929 * t405;
  t1933 = t298 * t399;
  t1935 = t163 * t1933 * t405;
  t1937 = t298 * t1040;
  t1938 = t163 * t1937;
  t1941 = t1045 * t732;
  t1944 = t741 * t382;
  t1945 = t163 * t1944;
  t1948 = t732 * t403;
  t1949 = t411 * t1948;
  t1950 = t1665 * t1949;
  t1952 = t298 * t380;
  t1954 = t163 * t1952 * t1661;
  t1956 = t732 * params->csk_a;
  t1957 = t1045 * t1956;
  t1961 = t379 * t1937;
  t1964 = t1038 * t1937;
  t1966 = t1108 * t733 - 0.2e1 * t1938 * t1580 - 0.3e1 * t1584 * t1941 - t1588 * t1927 + 0.3e1 * t1588 * t1957 + t736 * t1600 - t1938 * t1615 + 0.3e1 * t1961 * t1615 - t1964 * t1615 + 0.2e1 * t623 * t1923 + 0.2e1 * t1945 * t640 - 0.2e1 * t1931 - t1935 + 0.3e1 * t1950 + 0.3e1 * t1954 - t746;
  t1973 = t1926 * params->csk_a;
  t1974 = t1060 * t1973;
  t1982 = t379 * t1944;
  t1992 = t379 * t1952 * t403;
  t1993 = t1992 * t1115;
  t1996 = t298 * t167 * t384;
  t1997 = t163 * t1996;
  t1998 = t1997 * t1675;
  t2000 = t1992 * t1131;
  t2004 = my_piecewise3(t67, 0, 0.5e1 / 0.27e2 * t52 * t615);
  t2005 = my_piecewise3(t69, t2004, 0);
  t2008 = -t163 * t172 * t2005 + t1125 * t736 - t1125 * t748 + 0.3e1 * t1588 * t1974 + 0.3e1 * t1626 * t1961 - 0.3e1 * t1626 * t1964 - t1631 * t748 - 0.2e1 * t1634 * t1964 - 0.3e1 * t1651 * t1938 + 0.3e1 * t1651 * t1961 + 0.2e1 * t1945 * t630 - 0.2e1 * t1982 * t630 - 0.2e1 * t1982 * t645 - 0.3e1 * t1993 + 0.3e1 * t1998 - 0.3e1 * t2000;
  t2010 = my_piecewise5(t64, 0, t67, 0, t1966 + t2008);
  t2012 = 0.5e1 / 0.27e2 * t52 * t615 * t77 - 0.5e1 / 0.36e2 * t52 * t257 * t174 + t52 * t291 * t416 / 0.24e2 + t373 * t301 + 0.2e1 * t161 * t752 + t59 * t2010;
  t2017 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t303 + t1898 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t754 - t1905 + t1907 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * t2012);
  tv3rho2lapl0 = t2017 * t8 + 0.2e1 * t759;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  t2024 = t7 * t440 * t320;
  t2028 = t7 * t444 * t320 / 0.3e2;
  t2030 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t320 + t2024 / 0.5e1 - t2028);
  tv3rho2lapl1 = t2030 * t8 + 0.2e1 * t768;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 1] += tv3rho2lapl1;

  t2036 = t7 * t465 * t303;
  t2044 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t303 + t2036 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t754 + t1898 / 0.1e2 - t1905 + t1907 / 0.1e2);
  tv3rho2lapl2 = t2044 * t8 + t759 + t774;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 2] += tv3rho2lapl2;

  t2050 = t7 * t489 * t320;
  t2057 = t7 * t192 * t808;
  t2060 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t320 + t2050 / 0.1e2 + t2024 / 0.1e2 - t2028 + 0.3e1 / 0.2e2 * t7 * t188 * t808 + t2057 / 0.1e2);
  tv3rho2lapl3 = t2060 * t8 + t768 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 3] += tv3rho2lapl3;

  t2068 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t303 + t2036 / 0.5e1 - t1905);
  tv3rho2lapl4 = t2068 * t8 + 0.2e1 * t774;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 4] += tv3rho2lapl4;

  t2091 = t795 * t563;
  t2092 = t234 * t2091;
  t2095 = t315 * t580;
  t2097 = t234 * t2095 * t586;
  t2100 = t569 * t795;
  t2101 = t592 * t2100;
  t2104 = t1439 * t315;
  t2105 = t1437 * t2104;
  t2107 = t795 * t236;
  t2109 = t234 * t2107 * t586;
  t2111 = t1445 * t786;
  t2114 = t315 * t1431;
  t2115 = t234 * t2114;
  t2118 = t786 * t584;
  t2119 = t592 * t2118;
  t2120 = t1853 * t2119;
  t2122 = t315 * t561;
  t2124 = t234 * t2122 * t1861;
  t2126 = t786 * params->csk_a;
  t2127 = t1445 * t2126;
  t2131 = t560 * t2114;
  t2134 = t1429 * t2114;
  t2136 = t1493 * t787 - 0.3e1 * t1777 * t2111 - 0.2e1 * t1785 * t2115 + t1789 * t790 - t1791 * t2105 + 0.3e1 * t1791 * t2127 - t1810 * t2115 + 0.3e1 * t1810 * t2131 - t1810 * t2134 + 0.2e1 * t2092 * t702 + 0.2e1 * t2101 * t685 - t2097 - 0.2e1 * t2109 + 0.3e1 * t2120 + 0.3e1 * t2124 - t800;
  t2137 = t2104 * params->csk_a;
  t2138 = t1437 * t2137;
  t2146 = t560 * t2091;
  t2162 = t560 * t2122 * t584;
  t2163 = t2162 * t1500;
  t2166 = t315 * t238 * t565;
  t2167 = t234 * t2166;
  t2168 = t2167 * t1875;
  t2170 = t2162 * t1509;
  t2174 = my_piecewise3(t115, 0, 0.5e1 / 0.27e2 * t52 * t677);
  t2175 = my_piecewise3(t117, t2174, 0);
  t2178 = -t2175 * t234 * t243 + t1514 * t790 - t1514 * t802 + 0.3e1 * t1791 * t2138 + 0.3e1 * t1822 * t2131 - 0.3e1 * t1822 * t2134 - t1827 * t802 - 0.2e1 * t1830 * t2134 - 0.3e1 * t1845 * t2115 + 0.3e1 * t1845 * t2131 + 0.2e1 * t2092 * t692 - 0.2e1 * t2146 * t692 - 0.2e1 * t2146 * t707 - 0.3e1 * t2163 + 0.3e1 * t2168 - 0.3e1 * t2170;
  t2180 = my_piecewise5(t114, 0, t115, 0, t2136 + t2178);
  t2182 = 0.5e1 / 0.27e2 * t52 * t677 * t125 - 0.5e1 / 0.36e2 * t52 * t275 * t245 + t52 * t308 * t597 / 0.24e2 + t554 * t318 + 0.2e1 * t232 * t806 + t113 * t2180;
  t2187 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t320 + t2050 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t808 - t2028 + t2057 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * t2182);
  tv3rho2lapl5 = t2187 * t8 + 0.2e1 * t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 5] += tv3rho2lapl5;

  tv3rho2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  tv3rho2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 1] += tv3rho2tau1;

  tv3rho2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 2] += tv3rho2tau2;

  tv3rho2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 3] += tv3rho2tau3;

  tv3rho2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 4] += tv3rho2tau4;

  tv3rho2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 5] += tv3rho2tau5;

  t2194 = t7 * t145 * t836 / 0.1e2;
  t2200 = t170 * t633;
  t2201 = t394 * t2200;
  t2206 = t165 * t1040;
  t2207 = t1038 * t2206;
  t2208 = t1062 * t817;
  t2209 = t1060 * t2208;
  t2211 = t388 * t824;
  t2212 = t411 * t2211;
  t2213 = t623 * t2212;
  t2214 = t824 * t165;
  t2216 = t163 * t2214 * t405;
  t2217 = t263 * t403;
  t2218 = t163 * t2217;
  t2219 = t168 * t74;
  t2221 = t2218 * t2219 * t2200;
  t2222 = 0.2e1 * t2221;
  t2223 = t824 * t382;
  t2224 = t163 * t2223;
  t2225 = t2224 * t640;
  t2226 = t817 * t1040;
  t2227 = t163 * t2226;
  t2228 = t1050 * t639;
  t2231 = t379 * t2226;
  t2232 = t388 * t165;
  t2233 = t1045 * t2232;
  t2237 = t1050 * t1052 * t165;
  t2241 = t1038 * t2226;
  t2244 = t165 * t74 * t170;
  t2245 = t1082 * t2244;
  t2248 = t2224 * t630;
  t2249 = t379 * t2223;
  t2250 = t2249 * t630;
  t2253 = 0.2e1 * t1608 * t642 + 0.2e1 * t2201 * t628 - t2207 * t2209 - 0.2e1 * t2227 * t2228 - t2227 * t2237 - 0.3e1 * t2227 * t2245 - 0.3e1 * t2231 * t2233 + 0.3e1 * t2231 * t2237 + 0.3e1 * t2231 * t2245 - t2237 * t2241 + t2213 - t2216 - t2222 + t2225 + t2248 - t2250;
  t2254 = t1068 * t165;
  t2255 = t1045 * t2254;
  t2258 = t2249 * t645;
  t2259 = t817 * t403;
  t2260 = t163 * t2259;
  t2262 = t394 * t639 * t167;
  t2263 = t2260 * t2262;
  t2265 = t171 * t633;
  t2266 = t1112 * t2265;
  t2271 = t412 * t633;
  t2272 = t411 * t2271;
  t2275 = t817 * t167;
  t2276 = t379 * t2275;
  t2277 = t2232 * t403;
  t2278 = t411 * t2277;
  t2279 = t2276 * t2278;
  t2281 = t1063 * t165;
  t2282 = t1060 * t2281;
  t2287 = t1078 * t165;
  t2288 = t1060 * t2287;
  t2291 = t1045 * t644;
  t2295 = t379 * t2259 * t384;
  t2296 = params->csk_a * t165;
  t2297 = t2296 * t1114;
  t2298 = t2295 * t2297;
  t2301 = t163 * t2275 * t384;
  t2302 = t2296 * t403;
  t2303 = t171 * t2302;
  t2304 = t2301 * t2303;
  t2306 = t2296 * t167;
  t2307 = t389 * t2306;
  t2308 = t2295 * t2307;
  t2310 = 0.3e1 * t2231 * t2255 - 0.3e1 * t2241 * t2255 + 0.3e1 * t2241 * t2282 - 0.2e1 * t2241 * t2288 + 0.3e1 * t2241 * t2291 + 0.2e1 * t2266 * t628 - 0.2e1 * t2266 * t642 - 0.2e1 * t2272 * t642 - t2258 + 0.3e1 * t2263 + 0.3e1 * t2279 - 0.3e1 * t2298 + 0.3e1 * t2304 - 0.3e1 * t2308 - t826 - t828;
  t2312 = my_piecewise5(t64, 0, t67, 0, t2253 + t2310);
  t2314 = t161 * t834 + t2312 * t59 + 0.2e1 * t260 * t648 + 0.2e1 * t266 * t618;
  t2319 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t836 + t2194 + 0.3e1 / 0.2e2 * t7 * t32 * t2314);
  tv3rhosigma20 = t2319 * t8 + t840;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t2326 = t7 * t192 * t862 / 0.1e2;
  t2328 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t862 + t2326);
  tv3rhosigma25 = t2328 * t8 + t866;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t2334 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t836 + t2194);
  tv3rhosigma26 = t2334 * t8 + t840;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t2344 = t569 * t850;
  t2345 = t592 * t2344;
  t2346 = t685 * t2345;
  t2347 = t850 * t236;
  t2349 = t234 * t2347 * t586;
  t2350 = t281 * t584;
  t2351 = t234 * t2350;
  t2352 = t239 * t122;
  t2353 = t241 * t695;
  t2355 = t2351 * t2352 * t2353;
  t2356 = 0.2e1 * t2355;
  t2357 = t575 * t2353;
  t2360 = t850 * t563;
  t2361 = t234 * t2360;
  t2362 = t2361 * t702;
  t2363 = t843 * t1431;
  t2364 = t234 * t2363;
  t2365 = t1783 * t701;
  t2368 = t560 * t2363;
  t2369 = t569 * t236;
  t2370 = t1445 * t2369;
  t2375 = t236 * t1431;
  t2376 = t1429 * t2375;
  t2377 = t1439 * t843;
  t2378 = t1437 * t2377;
  t2380 = t242 * t695;
  t2381 = t1497 * t2380;
  t2384 = t843 * t238;
  t2385 = t560 * t2384;
  t2386 = t2369 * t584;
  t2387 = t592 * t2386;
  t2388 = t2385 * t2387;
  t2390 = t1429 * t2363;
  t2391 = t1445 * t706;
  t2394 = t241 * t1051;
  t2396 = t1783 * t2394 * t236;
  t2401 = t2361 * t692;
  t2402 = 0.2e1 * t1804 * t704 + 0.2e1 * t2357 * t690 - 0.2e1 * t2364 * t2365 - t2364 * t2396 - 0.3e1 * t2368 * t2370 + 0.3e1 * t2368 * t2396 - t2376 * t2378 - 0.2e1 * t2381 * t704 + 0.3e1 * t2390 * t2391 - t2390 * t2396 + t2346 - t2349 - t2356 + t2362 + 0.3e1 * t2388 + t2401;
  t2403 = t560 * t2360;
  t2404 = t2403 * t692;
  t2406 = t236 * t122 * t241;
  t2407 = t1463 * t2406;
  t2412 = t570 * t236;
  t2413 = t1460 * t2412;
  t2416 = t593 * t695;
  t2417 = t592 * t2416;
  t2420 = t1456 * t236;
  t2421 = t1437 * t2420;
  t2424 = t1440 * t236;
  t2425 = t1437 * t2424;
  t2432 = t2403 * t707;
  t2433 = t843 * t584;
  t2434 = t234 * t2433;
  t2436 = t575 * t701 * t238;
  t2437 = t2434 * t2436;
  t2440 = t560 * t2433 * t565;
  t2441 = params->csk_a * t236;
  t2442 = t2441 * t1499;
  t2443 = t2440 * t2442;
  t2446 = t234 * t2384 * t565;
  t2447 = t2441 * t584;
  t2448 = t242 * t2447;
  t2449 = t2446 * t2448;
  t2451 = t2441 * t238;
  t2452 = t570 * t2451;
  t2453 = t2440 * t2452;
  t2455 = -0.3e1 * t2364 * t2407 + 0.3e1 * t2368 * t2407 + 0.3e1 * t2368 * t2413 + 0.2e1 * t2381 * t690 - 0.3e1 * t2390 * t2413 - 0.2e1 * t2390 * t2421 + 0.3e1 * t2390 * t2425 - 0.2e1 * t2417 * t704 - t2404 - t2432 + 0.3e1 * t2437 - 0.3e1 * t2443 + 0.3e1 * t2449 - 0.3e1 * t2453 - t852 - t854;
  t2457 = my_piecewise5(t114, 0, t115, 0, t2402 + t2455);
  t2459 = t113 * t2457 + t232 * t860 + 0.2e1 * t278 * t710 + 0.2e1 * t284 * t680;
  t2464 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t862 + t2326 + 0.3e1 / 0.2e2 * t7 * t94 * t2459);
  tv3rhosigma211 = t2464 * t8 + t866;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t2471 = t7 * t145 * t888 / 0.1e2;
  t2483 = t741 * t263;
  t2485 = t163 * t2483 * t405;
  t2486 = t298 * t633;
  t2488 = t163 * t2486 * t405;
  t2495 = t1589 * t298;
  t2496 = t1060 * t2495;
  t2500 = t1642 * t733 + t1923 * t642 + t1945 * t873 + t1945 * t879 - t1982 * t873 - t1982 * t883 + t2201 * t736 - t2207 * t2496 + t2266 * t736 - t2266 * t748 - t2272 * t748 + t2213 - t2216 + t2225 + t2248 - t2250 - t2485 - t2488 - t877;
  t2501 = t1937 * t1044;
  t2502 = t379 * t2501;
  t2503 = t171 * t263;
  t2504 = t2296 * t2503;
  t2507 = t163 * t2501;
  t2510 = t875 * t403;
  t2511 = t163 * t2510;
  t2512 = t2511 * t2262;
  t2514 = t1038 * t2501;
  t2515 = t1051 * t263;
  t2516 = t389 * t165;
  t2517 = t2515 * t2516;
  t2520 = t2515 * t165;
  t2521 = t1136 * t2520;
  t2524 = t379 * t1671;
  t2526 = t389 * t744 * t403;
  t2527 = t2524 * t2526;
  t2529 = t1577 * t1044;
  t2530 = t1038 * t2529;
  t2531 = t298 * params->csk_a;
  t2532 = t2531 * t165;
  t2533 = t1136 * t2532;
  t2538 = t389 * t2532;
  t2541 = t171 * t2520;
  t2546 = t379 * t2510;
  t2548 = t1112 * t165 * t1114;
  t2549 = t2546 * t2548;
  t2551 = t171 * params->csk_a;
  t2552 = t636 * t403;
  t2553 = t2551 * t2552;
  t2554 = t1997 * t2553;
  t2556 = t411 * t388;
  t2557 = t2556 * t2306;
  t2558 = t2546 * t2557;
  t2560 = t878 * t165;
  t2561 = t1050 * t2560;
  t2564 = t732 * t165;
  t2565 = t1045 * t2564;
  t2568 = -0.3e1 * t1617 * t2565 - 0.2e1 * t1938 * t2561 + 0.3e1 * t2502 * t2504 + 0.3e1 * t2502 * t2517 + 0.3e1 * t2502 * t2541 - 0.3e1 * t2504 * t2507 - t2507 * t2541 - 0.3e1 * t2514 * t2517 - 0.2e1 * t2514 * t2521 - t2514 * t2541 + 0.3e1 * t2530 * t2533 + 0.3e1 * t2530 * t2538 - t2258 + 0.3e1 * t2512 + 0.3e1 * t2527 - 0.3e1 * t2549 + 0.3e1 * t2554 - 0.3e1 * t2558 - t826;
  t2570 = my_piecewise5(t64, 0, t67, 0, t2500 + t2568);
  t2572 = -0.5e1 / 0.72e2 * t52 * t257 * t266 + t52 * t291 * t648 / 0.24e2 + t618 * t301 + t260 * t752 + t161 * t886 + t59 * t2570;
  t2577 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t888 + t2471 + 0.3e1 / 0.2e2 * t7 * t32 * t2572);
  tv3rhosigmalapl0 = t2577 * t8 + t892;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  t2584 = t7 * t192 * t914 / 0.1e2;
  t2586 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t914 + t2584);
  tv3rhosigmalapl5 = t2586 * t8 + t918;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  t2592 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t888 + t2471);
  tv3rhosigmalapl6 = t2592 * t8 + t892;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  t2608 = t795 * t281;
  t2610 = t234 * t2608 * t586;
  t2611 = t315 * t695;
  t2613 = t234 * t2611 * t586;
  t2616 = t2114 * t1435;
  t2617 = t560 * t2616;
  t2618 = t242 * t281;
  t2619 = t2441 * t2618;
  t2622 = t234 * t2616;
  t2625 = t1429 * t2616;
  t2626 = t1051 * t281;
  t2627 = t2626 * t236;
  t2628 = t1521 * t2627;
  t2631 = t570 * t2627;
  t2634 = t901 * t584;
  t2635 = t234 * t2634;
  t2636 = t2635 * t2436;
  t2640 = t1842 * t787 + t2092 * t905 + t2101 * t704 + t2357 * t790 + 0.3e1 * t2617 * t2619 + 0.3e1 * t2617 * t2631 - 0.3e1 * t2619 * t2622 - 0.2e1 * t2625 * t2628 - 0.3e1 * t2625 * t2631 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2610 - t2613 + 0.3e1 * t2636 - t903;
  t2641 = t560 * t1871;
  t2643 = t570 * t798 * t584;
  t2644 = t2641 * t2643;
  t2646 = t1781 * t1435;
  t2647 = t1429 * t2646;
  t2648 = t315 * params->csk_a;
  t2649 = t2648 * t236;
  t2650 = t1521 * t2649;
  t2653 = t2626 * t2406;
  t2655 = t570 * t2649;
  t2661 = t560 * t2634;
  t2663 = t1497 * t236 * t1499;
  t2664 = t2661 * t2663;
  t2666 = t242 * params->csk_a;
  t2667 = t698 * t584;
  t2668 = t2666 * t2667;
  t2669 = t2167 * t2668;
  t2671 = t592 * t569;
  t2672 = t2671 * t2451;
  t2673 = t2661 * t2672;
  t2675 = t904 * t236;
  t2676 = t1783 * t2675;
  t2679 = t786 * t236;
  t2680 = t1445 * t2679;
  t2689 = t1792 * t315;
  t2690 = t1437 * t2689;
  t2692 = -0.3e1 * t1816 * t2680 + t2092 * t899 - 0.2e1 * t2115 * t2676 - t2146 * t899 - t2146 * t909 - t2376 * t2690 + t2381 * t790 - t2381 * t802 - t2417 * t802 + 0.3e1 * t2617 * t2653 - t2622 * t2653 - t2625 * t2653 + 0.3e1 * t2647 * t2650 + 0.3e1 * t2647 * t2655 + 0.3e1 * t2644 - 0.3e1 * t2664 + 0.3e1 * t2669 - 0.3e1 * t2673 - t852;
  t2694 = my_piecewise5(t114, 0, t115, 0, t2640 + t2692);
  t2696 = -0.5e1 / 0.72e2 * t52 * t275 * t284 + t52 * t308 * t710 / 0.24e2 + t680 * t318 + t278 * t806 + t232 * t912 + t113 * t2694;
  t2701 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t914 + t2584 + 0.3e1 / 0.2e2 * t7 * t94 * t2696);
  tv3rhosigmalapl11 = t2701 * t8 + t918;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  tv3rhosigmatau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 4] += tv3rhosigmatau4;

  tv3rhosigmatau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 5] += tv3rhosigmatau5;

  tv3rhosigmatau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 10] += tv3rhosigmatau10;

  tv3rhosigmatau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2708 = t7 * t145 * t937 / 0.1e2;
  t2716 = t922 * t1040;
  t2717 = t379 * t2716;
  t2720 = t163 * t2716;
  t2723 = t298 * t403;
  t2724 = t163 * t2723;
  t2725 = t170 * t741;
  t2727 = t2724 * t2219 * t2725;
  t2728 = 0.2e1 * t2727;
  t2734 = t1062 * t922;
  t2735 = t1060 * t2734;
  t2737 = t922 * t403;
  t2739 = t379 * t2737 * t384;
  t2740 = t2739 * t2297;
  t2742 = t922 * t167;
  t2744 = t163 * t2742 * t384;
  t2745 = t2744 * t2303;
  t2747 = t2739 * t2307;
  t2749 = t1038 * t2716;
  t2752 = 0.2e1 * t2725 * t394 * t736 + 0.2e1 * t1923 * t748 - t2207 * t2735 - 0.2e1 * t2228 * t2720 - 0.3e1 * t2233 * t2717 + 0.3e1 * t2291 * t2749 + t2213 - t2216 + t2225 + t2248 - t2250 - t2258 - t2728 - 0.3e1 * t2740 + 0.3e1 * t2745 - 0.3e1 * t2747;
  t2761 = t412 * t741;
  t2769 = t395 * t741;
  t2770 = t394 * t2769;
  t2775 = t163 * t2737;
  t2776 = t2775 * t2262;
  t2782 = t379 * t2742;
  t2783 = t2782 * t2278;
  t2785 = -0.2e1 * t2761 * t411 * t748 + 0.3e1 * t2237 * t2717 - t2237 * t2720 - t2237 * t2749 + 0.3e1 * t2245 * t2717 - 0.3e1 * t2245 * t2720 + 0.3e1 * t2255 * t2717 - 0.3e1 * t2255 * t2749 + 0.3e1 * t2282 * t2749 - 0.2e1 * t2288 * t2749 + 0.2e1 * t2770 * t736 - 0.2e1 * t2770 * t748 + 0.3e1 * t2776 + 0.3e1 * t2783 - t826 - t929;
  t2787 = my_piecewise5(t64, 0, t67, 0, t2752 + t2785);
  t2789 = -0.5e1 / 0.36e2 * t52 * t257 * t301 + t52 * t291 * t752 / 0.12e2 + t161 * t935 + t59 * t2787;
  t2794 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t937 + t2708 + 0.3e1 / 0.2e2 * t7 * t32 * t2789);
  tv3rholapl20 = t2794 * t8 + t941;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 1] += tv3rholapl21;

  t2801 = t7 * t192 * t960 / 0.1e2;
  t2803 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t960 + t2801);
  tv3rholapl22 = t2803 * t8 + t964;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 2] += tv3rholapl22;

  t2809 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t937 + t2708);
  tv3rholapl23 = t2809 * t8 + t941;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 4] += tv3rholapl24;

  t2821 = t241 * t795;
  t2825 = t945 * t1431;
  t2826 = t234 * t2825;
  t2829 = t560 * t2825;
  t2834 = t1439 * t945;
  t2835 = t1437 * t2834;
  t2837 = t315 * t584;
  t2838 = t234 * t2837;
  t2840 = t2838 * t2352 * t2821;
  t2841 = 0.2e1 * t2840;
  t2842 = t945 * t584;
  t2844 = t560 * t2842 * t565;
  t2845 = t2844 * t2442;
  t2847 = t945 * t238;
  t2849 = t234 * t2847 * t565;
  t2850 = t2849 * t2448;
  t2852 = t2844 * t2452;
  t2854 = 0.2e1 * t2821 * t575 * t790 + 0.2e1 * t2101 * t802 - 0.2e1 * t2365 * t2826 - 0.3e1 * t2370 * t2829 - t2376 * t2835 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2841 - 0.3e1 * t2845 + 0.3e1 * t2850 - 0.3e1 * t2852 - t952;
  t2855 = t242 * t795;
  t2856 = t1497 * t2855;
  t2859 = t1429 * t2825;
  t2862 = t593 * t795;
  t2866 = t560 * t2847;
  t2867 = t2866 * t2387;
  t2887 = t234 * t2842;
  t2888 = t2887 * t2436;
  t2890 = -0.2e1 * t2862 * t592 * t802 + 0.3e1 * t2391 * t2859 - t2396 * t2826 + 0.3e1 * t2396 * t2829 - t2396 * t2859 - 0.3e1 * t2407 * t2826 + 0.3e1 * t2407 * t2829 + 0.3e1 * t2413 * t2829 - 0.3e1 * t2413 * t2859 - 0.2e1 * t2421 * t2859 + 0.3e1 * t2425 * t2859 + 0.2e1 * t2856 * t790 - 0.2e1 * t2856 * t802 + 0.3e1 * t2867 + 0.3e1 * t2888 - t852;
  t2892 = my_piecewise5(t114, 0, t115, 0, t2854 + t2890);
  t2894 = -0.5e1 / 0.36e2 * t52 * t275 * t318 + t52 * t308 * t806 / 0.12e2 + t232 * t958 + t113 * t2892;
  t2899 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t960 + t2801 + 0.3e1 / 0.2e2 * t7 * t94 * t2894);
  tv3rholapl25 = t2899 * t8 + t964;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 7] += tv3rholapltau7;

  tv3rhotau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 1] += tv3rhotau21;

  tv3rhotau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 2] += tv3rhotau22;

  tv3rhotau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 4] += tv3rhotau24;

  tv3rhotau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 5] += tv3rhotau25;

  t2903 = t817 * t263;
  t2904 = t2903 * t1040;
  t2905 = t1038 * t2904;
  t2910 = t2903 * t167;
  t2912 = t379 * t2910 * t1091;
  t2913 = 0.3e1 * t2912;
  t2914 = t2224 * t879;
  t2915 = 0.3e1 * t2914;
  t2916 = t2903 * t403;
  t2917 = t163 * t2916;
  t2918 = t2917 * t1101;
  t2919 = 0.3e1 * t2918;
  t2920 = t642 * t2212;
  t2921 = 0.3e1 * t2920;
  t2924 = t379 * t2904;
  t2927 = t824 * t263;
  t2929 = t163 * t2927 * t405;
  t2930 = 0.3e1 * t2929;
  t2933 = t163 * t2904;
  t2938 = 0.3e1 * t1046 * t2905 - t1053 * t2905 + 0.3e1 * t1053 * t2924 - t1053 * t2933 + 0.3e1 * t1064 * t2905 - 0.3e1 * t1069 * t2905 + 0.3e1 * t1069 * t2924 - 0.2e1 * t1079 * t2905 + t2913 + t2915 + t2919 + t2921 - t2930;
  t2951 = t2249 * t873;
  t2952 = 0.3e1 * t2951;
  t2953 = t379 * t2916;
  t2954 = t2953 * t1115;
  t2955 = 0.3e1 * t2954;
  t2957 = t163 * t2910 * t1120;
  t2958 = 0.3e1 * t2957;
  t2959 = t395 * t824;
  t2960 = t394 * t2959;
  t2961 = t628 * t2960;
  t2962 = 0.3e1 * t2961;
  t2963 = t2249 * t883;
  t2964 = 0.3e1 * t2963;
  t2965 = t2953 * t1131;
  t2966 = 0.3e1 * t2965;
  t2967 = -t1038 * t1137 * t2903 - 0.3e1 * t1144 * t2903 * t379 - 0.2e1 * t1148 * t163 * t2903 + 0.3e1 * t1083 * t2924 - 0.3e1 * t1083 * t2933 - t2952 - t2955 + t2958 + t2962 - t2964 - t2966 - t826 - t828;
  t2969 = my_piecewise5(t64, 0, t67, 0, t2938 + t2967);
  t2971 = 0.3e1 * t260 * t834 + t2969 * t59;
  t2975 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t2971);
  tv3sigma30 = t8 * t2975;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t2978 = t843 * t281;
  t2979 = t2978 * t1431;
  t2980 = t234 * t2979;
  t2983 = t1429 * t2979;
  t2988 = t704 * t2345;
  t2989 = 0.3e1 * t2988;
  t2992 = t560 * t2979;
  t2995 = t850 * t281;
  t2997 = t234 * t2995 * t586;
  t2998 = 0.3e1 * t2997;
  t2999 = t2978 * t238;
  t3001 = t560 * t2999 * t1473;
  t3002 = 0.3e1 * t3001;
  t3003 = t2361 * t905;
  t3004 = 0.3e1 * t3003;
  t3005 = t2978 * t584;
  t3006 = t234 * t3005;
  t3007 = t3006 * t1483;
  t3008 = 0.3e1 * t3007;
  t3014 = 0.3e1 * t1441 * t2983 - 0.3e1 * t1447 * t2983 + 0.3e1 * t1447 * t2992 - 0.2e1 * t1457 * t2983 - t1461 * t2980 + 0.3e1 * t1461 * t2992 - 0.3e1 * t1464 * t2980 + 0.3e1 * t1486 * t2983 + t2989 - t2998 + t3002 + t3004 + t3008;
  t3026 = t2403 * t909;
  t3027 = 0.3e1 * t3026;
  t3028 = t560 * t3005;
  t3029 = t3028 * t1509;
  t3030 = 0.3e1 * t3029;
  t3031 = t2403 * t899;
  t3032 = 0.3e1 * t3031;
  t3033 = t3028 * t1500;
  t3034 = 0.3e1 * t3033;
  t3036 = t234 * t2999 * t1505;
  t3037 = 0.3e1 * t3036;
  t3038 = t576 * t850;
  t3039 = t575 * t3038;
  t3040 = t690 * t3039;
  t3041 = 0.3e1 * t3040;
  t3042 = -t1429 * t1522 * t2978 - 0.2e1 * t1529 * t234 * t2978 - 0.3e1 * t1533 * t2978 * t560 - t1461 * t2983 + 0.3e1 * t1464 * t2992 - t3027 - t3030 - t3032 - t3034 + t3037 + t3041 - t852 - t854;
  t3044 = my_piecewise5(t114, 0, t115, 0, t3014 + t3042);
  t3046 = t113 * t3044 + 0.3e1 * t278 * t860;
  t3050 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3046);
  tv3sigma39 = t8 * t3050;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  t3056 = t2249 * t733;
  t3058 = t298 * t824;
  t3060 = t163 * t3058 * t405;
  t3063 = t170 * t817;
  t3064 = t1050 * t3063;
  t3067 = t170 * t824;
  t3068 = t394 * t3067;
  t3069 = t736 * t3068;
  t3070 = 0.2e1 * t2914;
  t3071 = 0.2e1 * t2920;
  t3072 = 0.2e1 * t2929;
  t3073 = t298 * t817;
  t3074 = t3073 * t403;
  t3075 = t379 * t3074;
  t3076 = t3075 * t1115;
  t3077 = 0.3e1 * t3076;
  t3078 = params->csk_a * t817;
  t3079 = t3078 * t403;
  t3080 = t171 * t3079;
  t3081 = t1997 * t3080;
  t3082 = 0.3e1 * t3081;
  t3083 = t3075 * t1131;
  t3084 = 0.3e1 * t3083;
  t3085 = t412 * t824;
  t3086 = t411 * t3085;
  t3087 = t748 * t3086;
  t3088 = t1078 * t817;
  t3089 = t1060 * t3088;
  t3094 = -t1927 * t2241 - 0.2e1 * t1938 * t3064 - 0.3e1 * t1941 * t2231 - 0.2e1 * t1964 * t3089 + 0.3e1 * t1974 * t2241 + t3056 - t3060 + t3069 + t3070 + t3071 - t3072 - t3077 + t3082 - t3084 - t3087 - t877;
  t3095 = t736 * t2960;
  t3096 = t1068 * t817;
  t3097 = t1045 * t3096;
  t3101 = t817 * t74 * t170;
  t3102 = t1082 * t3101;
  t3107 = t1623 * t3101;
  t3114 = t2276 * t1949;
  t3115 = 0.3e1 * t3114;
  t3116 = t163 * t3073;
  t3117 = t3116 * t1661;
  t3118 = 0.3e1 * t3117;
  t3119 = t748 * t2960;
  t3122 = 0.2e1 * t2951;
  t3123 = 0.2e1 * t2961;
  t3124 = 0.2e1 * t2963;
  t3125 = -0.3e1 * t1938 * t3102 - t1938 * t3107 + 0.3e1 * t1957 * t2241 + 0.3e1 * t1961 * t3097 + 0.3e1 * t1961 * t3102 + 0.3e1 * t1961 * t3107 - 0.3e1 * t1964 * t3097 - t1964 * t3107 + t3095 + t3115 + t3118 - t3119 - t3122 + t3123 - t3124 - t826;
  t3127 = my_piecewise5(t64, 0, t67, 0, t3094 + t3125);
  t3129 = t52 * t291 * t834 / 0.24e2 + 0.2e1 * t260 * t886 + t59 * t3127;
  t3133 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3129);
  tv3sigma2lapl0 = t8 * t3133;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 10] += tv3sigma2lapl10;

  t3141 = t241 * t843;
  t3142 = t1783 * t3141;
  t3145 = t241 * t850;
  t3146 = t575 * t3145;
  t3147 = t790 * t3146;
  t3148 = t2403 * t787;
  t3150 = t315 * t850;
  t3152 = t234 * t3150 * t586;
  t3153 = 0.2e1 * t2988;
  t3154 = 0.2e1 * t2997;
  t3155 = 0.2e1 * t3003;
  t3156 = t315 * t843;
  t3157 = t3156 * t584;
  t3158 = t560 * t3157;
  t3159 = t3158 * t1500;
  t3160 = 0.3e1 * t3159;
  t3161 = params->csk_a * t843;
  t3162 = t3161 * t584;
  t3163 = t242 * t3162;
  t3164 = t2167 * t3163;
  t3165 = 0.3e1 * t3164;
  t3166 = t3158 * t1509;
  t3167 = 0.3e1 * t3166;
  t3168 = t576 * t843;
  t3169 = t1783 * t3168;
  t3175 = t1783 * t2394 * t843;
  t3177 = -t2105 * t2390 - 0.3e1 * t2111 * t2368 - 0.2e1 * t2115 * t3142 - 0.3e1 * t2115 * t3169 - t2115 * t3175 + 0.3e1 * t2127 * t2390 + t3147 + t3148 - t3152 + t3153 - t3154 + t3155 - t3160 + t3165 - t3167 - t903;
  t3181 = t234 * t3156;
  t3182 = t3181 * t1861;
  t3183 = 0.3e1 * t3182;
  t3184 = t802 * t3039;
  t3186 = t843 * t567 * t569;
  t3187 = t1460 * t3186;
  t3190 = t593 * t850;
  t3191 = t592 * t3190;
  t3192 = t802 * t3191;
  t3193 = t1456 * t843;
  t3194 = t1437 * t3193;
  t3199 = t790 * t3039;
  t3204 = t2385 * t2119;
  t3205 = 0.3e1 * t3204;
  t3206 = 0.2e1 * t3026;
  t3207 = 0.2e1 * t3031;
  t3208 = 0.2e1 * t3040;
  t3209 = 0.3e1 * t2131 * t3169 + 0.3e1 * t2131 * t3175 + 0.3e1 * t2131 * t3187 - t2134 * t3175 - 0.3e1 * t2134 * t3187 - 0.2e1 * t2134 * t3194 + 0.3e1 * t2138 * t2390 + t3183 - t3184 - t3192 + t3199 + t3205 - t3206 - t3207 + t3208 - t852;
  t3211 = my_piecewise5(t114, 0, t115, 0, t3177 + t3209);
  t3213 = t52 * t308 * t860 / 0.24e2 + 0.2e1 * t278 * t912 + t113 * t3211;
  t3217 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3213);
  tv3sigma2lapl11 = t8 * t3217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 11] += tv3sigma2lapl11;

  tv3sigma2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 10] += tv3sigma2tau10;

  tv3sigma2tau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 11] += tv3sigma2tau11;

  t3228 = 0.2e1 * t3056;
  t3229 = 0.2e1 * t3060;
  t3230 = 0.2e1 * t3069;
  t3231 = params->csk_a * t263;
  t3232 = t3231 * t403;
  t3234 = t2744 * t171 * t3232;
  t3235 = 0.3e1 * t3234;
  t3236 = t3231 * t167;
  t3238 = t2739 * t389 * t3236;
  t3239 = 0.3e1 * t3238;
  t3243 = t1050 * t1052 * t263;
  t3248 = t1082 * t2503;
  t3251 = -0.2e1 * t1050 * t2720 * t878 - 0.3e1 * t1585 * t2717 + 0.3e1 * t1611 * t2749 - t1620 * t2735 + 0.3e1 * t2717 * t3243 + 0.3e1 * t2717 * t3248 - t2720 * t3243 - t2749 * t3243 + t2914 + t2920 - t2929 + t3228 - t3229 + t3230 + t3235 - t3239;
  t3252 = t389 * t263;
  t3253 = t1623 * t3252;
  t3256 = t1078 * t263;
  t3260 = t2782 * t1667;
  t3261 = 0.3e1 * t3260;
  t3268 = t2775 * t394 * t878 * t167;
  t3269 = 0.3e1 * t3268;
  t3272 = 0.2e1 * t3087;
  t3273 = 0.2e1 * t3095;
  t3274 = 0.2e1 * t3119;
  t3276 = t2739 * t3231 * t1114;
  t3277 = 0.3e1 * t3276;
  t3278 = -0.2e1 * t1060 * t2749 * t3256 + 0.3e1 * t1646 * t2749 + 0.3e1 * t2717 * t3253 - 0.3e1 * t2720 * t3248 - 0.3e1 * t2749 * t3253 - t2951 + t2961 - t2963 + t3261 + t3269 - t3272 + t3273 - t3274 - t3277 - t826 - t929;
  t3280 = my_piecewise5(t64, 0, t67, 0, t3251 + t3278);
  t3282 = t52 * t291 * t886 / 0.12e2 + t260 * t935 + t59 * t3280;
  t3286 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3282);
  tv3sigmalapl20 = t8 * t3286;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 7] += tv3sigmalapl27;

  t3297 = 0.2e1 * t3147;
  t3298 = 0.2e1 * t3148;
  t3299 = 0.2e1 * t3152;
  t3300 = params->csk_a * t281;
  t3302 = t2844 * t3300 * t1499;
  t3303 = 0.3e1 * t3302;
  t3304 = t1456 * t281;
  t3308 = t2866 * t1855;
  t3309 = 0.3e1 * t3308;
  t3312 = t1446 * t281;
  t3313 = t1445 * t3312;
  t3318 = t2887 * t575 * t904 * t238;
  t3319 = 0.3e1 * t3318;
  t3320 = -0.2e1 * t1437 * t2859 * t3304 - 0.2e1 * t1783 * t2826 * t904 - 0.3e1 * t1778 * t2829 - t1807 * t2835 + 0.3e1 * t1834 * t2859 + 0.3e1 * t2829 * t3313 + t2988 - t2997 + t3003 + t3297 + t3298 - t3299 - t3303 + t3309 + t3319 - t952;
  t3321 = t1783 * t898;
  t3326 = t2394 * t281;
  t3327 = t1783 * t3326;
  t3336 = 0.2e1 * t3184;
  t3337 = 0.2e1 * t3192;
  t3338 = 0.2e1 * t3199;
  t3339 = t3300 * t584;
  t3340 = t242 * t3339;
  t3341 = t2849 * t3340;
  t3342 = 0.3e1 * t3341;
  t3343 = t3300 * t238;
  t3345 = t2844 * t570 * t3343;
  t3346 = 0.3e1 * t3345;
  t3347 = 0.3e1 * t1812 * t2859 - 0.3e1 * t2826 * t3321 - t2826 * t3327 + 0.3e1 * t2829 * t3321 + 0.3e1 * t2829 * t3327 - 0.3e1 * t2859 * t3313 - t2859 * t3327 - t3026 - t3031 + t3040 - t3336 - t3337 + t3338 + t3342 - t3346 - t852;
  t3349 = my_piecewise5(t114, 0, t115, 0, t3320 + t3347);
  t3351 = t52 * t308 * t912 / 0.12e2 + t278 * t958 + t113 * t3349;
  t3355 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3351);
  tv3sigmalapl28 = t8 * t3355;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmatau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 7] += tv3sigmatau27;

  tv3sigmatau28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 8] += tv3sigmatau28;

  t3359 = 0.3e1 * t3056;
  t3360 = 0.3e1 * t3060;
  t3361 = 0.3e1 * t3069;
  t3362 = t922 * t298;
  t3371 = t3362 * t403;
  t3372 = t379 * t3371;
  t3373 = t3372 * t1115;
  t3374 = 0.3e1 * t3373;
  t3375 = t3372 * t1131;
  t3376 = 0.3e1 * t3375;
  t3377 = t3362 * t167;
  t3379 = t163 * t3377 * t1120;
  t3380 = 0.3e1 * t3379;
  t3381 = 0.3e1 * t3087;
  t3382 = 0.3e1 * t3095;
  t3383 = 0.3e1 * t3119;
  t3384 = -t1038 * t1137 * t3362 - 0.3e1 * t1144 * t3362 * t379 - 0.2e1 * t1148 * t163 * t3362 + t3359 - t3360 + t3361 - t3374 - t3376 + t3380 - t3381 + t3382 - t3383 - t826;
  t3386 = t379 * t3377 * t1091;
  t3387 = 0.3e1 * t3386;
  t3389 = t163 * t3371 * t1101;
  t3390 = 0.3e1 * t3389;
  t3391 = t3362 * t1040;
  t3392 = t163 * t3391;
  t3395 = t1038 * t3391;
  t3402 = t379 * t3391;
  t3413 = 0.3e1 * t1046 * t3395 - t1053 * t3392 - t1053 * t3395 + 0.3e1 * t1053 * t3402 + 0.3e1 * t1064 * t3395 - 0.3e1 * t1069 * t3395 + 0.3e1 * t1069 * t3402 - 0.2e1 * t1079 * t3395 - 0.3e1 * t1083 * t3392 + 0.3e1 * t1083 * t3402 + t3387 + t3390 - t929;
  t3415 = my_piecewise5(t64, 0, t67, 0, t3384 + t3413);
  t3417 = t52 * t291 * t935 / 0.8e1 + t59 * t3415;
  t3421 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * t3417);
  tv3lapl30 = t8 * t3421;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 2] += tv3lapl32;

  t3425 = 0.3e1 * t3147;
  t3426 = 0.3e1 * t3148;
  t3427 = 0.3e1 * t3152;
  t3428 = t945 * t315;
  t3437 = t3428 * t584;
  t3438 = t560 * t3437;
  t3439 = t3438 * t1500;
  t3440 = 0.3e1 * t3439;
  t3441 = t3438 * t1509;
  t3442 = 0.3e1 * t3441;
  t3443 = t3428 * t238;
  t3445 = t234 * t3443 * t1505;
  t3446 = 0.3e1 * t3445;
  t3447 = 0.3e1 * t3184;
  t3448 = 0.3e1 * t3192;
  t3449 = 0.3e1 * t3199;
  t3450 = -t1429 * t1522 * t3428 - 0.2e1 * t1529 * t234 * t3428 - 0.3e1 * t1533 * t3428 * t560 + t3425 + t3426 - t3427 - t3440 - t3442 + t3446 - t3447 - t3448 + t3449 - t952;
  t3451 = t3428 * t1431;
  t3452 = t560 * t3451;
  t3455 = t1429 * t3451;
  t3460 = t234 * t3437;
  t3461 = t3460 * t1483;
  t3462 = 0.3e1 * t3461;
  t3464 = t560 * t3443 * t1473;
  t3465 = 0.3e1 * t3464;
  t3466 = t234 * t3451;
  t3479 = 0.3e1 * t1441 * t3455 + 0.3e1 * t1447 * t3452 - 0.3e1 * t1447 * t3455 - 0.2e1 * t1457 * t3455 + 0.3e1 * t1461 * t3452 - t1461 * t3455 - t1461 * t3466 + 0.3e1 * t1464 * t3452 - 0.3e1 * t1464 * t3466 + 0.3e1 * t1486 * t3455 + t3462 + t3465 - t852;
  t3481 = my_piecewise5(t114, 0, t115, 0, t3450 + t3479);
  t3483 = t52 * t308 * t958 / 0.8e1 + t113 * t3481;
  t3487 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * t3483);
  tv3lapl33 = t8 * t3487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 5] += tv3lapltau25;

  tv3tau30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 2] += tv3tau32;

  tv3tau33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 3] += tv3tau33;

  t3490 = t21 * t21;
  t3492 = 0.1e1 / t26 / t3490;
  t3493 = t328 * t328;
  t3499 = t336 * t336;
  t3505 = 0.1e1 / t975 / t8;
  t3506 = t18 * t3505;
  t3509 = my_piecewise5(t12, 0, t16, 0, -0.24e2 * t976 + 0.24e2 * t3506);
  t3513 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3492 * t3493 - 0.2e2 / 0.9e1 * t968 * t328 * t336 + 0.1e2 / 0.3e1 * t327 * t3499 + 0.4e2 / 0.9e1 * t972 * t980 + 0.5e1 / 0.3e1 * t27 * t3509);
  t3522 = t7 * t989 * t176;
  t3528 = t7 * t996 * t176;
  t3531 = t7 * t345 * t418;
  t3537 = t7 * t1008 * t176;
  t3540 = t7 * t354 * t418;
  t3543 = t7 * t145 * t1155;
  t3547 = 0.1e1 / t41 / t361 / t39;
  t3550 = 0.1309e5 / 0.729e3 * t38 * sigma[0] * t3547;
  t3557 = 0.2618e4 / 0.243e3 * t47 * t48 * t3547 + 0.77e3 / 0.243e3 * t52 * t53 * t1020 - t3550;
  t3573 = params->csk_a * t403;
  t3575 = t171 * t3573 * t399;
  t3578 = t399 * t167;
  t3580 = t379 * t3578 * t384;
  t3581 = t389 * t1674;
  t3587 = t380 * t380;
  t3588 = t163 * t3587;
  t3589 = t403 * t403;
  t3590 = t3589 * t384;
  t3591 = t3590 * t171;
  t3594 = t382 * t382;
  t3595 = t383 * t383;
  t3596 = 0.1e1 / t3595;
  t3597 = t3594 * t3596;
  t3598 = t3597 * t171;
  t3601 = t379 * t3587;
  t3602 = t3590 * t389;
  t3605 = t3597 * t389;
  t3609 = t3597 * t1136;
  t3612 = t377 * t377;
  t3614 = t76 / t3612;
  t3616 = t386 * t386;
  t3617 = t387 * t387;
  t3618 = 0.1e1 / t3617;
  t3619 = t3616 * t3618;
  t3620 = t3597 * t3619;
  t3622 = my_piecewise3(t67, 0, t3557);
  t3623 = my_piecewise3(t69, t3622, 0);
  t3626 = t399 * t399;
  t3630 = t163 * t3626;
  t3635 = t3587 * t382;
  t3636 = t163 * t3635;
  t3640 = 0.6e1 * t1038 * t3587 * t3609 - 0.18e2 * t1050 * t1119 * t3636 - t163 * t172 * t3623 + t3587 * t3614 * t3620 + 0.3e1 * t3626 * t379 * t390 + 0.3e1 * t3588 * t3591 + 0.6e1 * t3588 * t3598 + 0.3e1 * t3601 * t3602 + 0.11e2 * t3601 * t3605 - 0.3e1 * t3630 * t405 + 0.3e1 * t3630 * t407;
  t3642 = t399 * t1040;
  t3643 = t379 * t3642;
  t3647 = t1050 * t1052 * t403;
  t3650 = t163 * t1583;
  t3652 = t1050 * t1052 * t399;
  t3657 = t1038 * t3642;
  t3660 = t3587 * t403;
  t3661 = t379 * t3660;
  t3663 = t382 * t74 * t170;
  t3664 = t1623 * t3663;
  t3667 = t1038 * t3660;
  t3670 = t1038 * t3635;
  t3672 = t1045 * t1090 * params->csk_a;
  t3680 = t1082 * t3663;
  t3685 = t1060 * t1078 * t382;
  t3688 = t1140 * t382;
  t3689 = t379 * t3688;
  t3693 = t411 * t1090 * t399;
  t3696 = t1062 * t403;
  t3698 = t1060 * t3696 * params->csk_a;
  t3702 = t1045 * t1068 * t399;
  t3706 = t382 * t386 * t388;
  t3707 = t1623 * t3706;
  t3710 = t379 * t3635;
  t3712 = t1045 * t1068 * t403;
  t3715 = t1050 * t1124;
  t3720 = t1045 * t1630;
  t3725 = 0.18e2 * t1584 * t3702 + 0.18e2 * t1588 * t3720 - 0.18e2 * t1626 * t3657 + 0.18e2 * t1665 * t3693 - 0.18e2 * t3650 * t3715 - 0.12e2 * t3667 * t3685 - 0.18e2 * t3667 * t3707 + 0.18e2 * t3670 * t3698 - 0.4e1 * t3689 * t630 - 0.4e1 * t3689 * t645 + 0.18e2 * t3710 * t3712;
  t3728 = t1062 * t399;
  t3730 = t1060 * t3728 * params->csk_a;
  t3735 = t163 * t3688;
  t3738 = t3587 * t3594;
  t3739 = t1038 * t3738;
  t3740 = t3596 * t1059;
  t3741 = t3740 * t1063;
  t3744 = t3614 * t3738;
  t3745 = t1051 * params->csk_a;
  t3746 = t3596 * t3745;
  t3747 = t3746 * t1136;
  t3750 = t3596 * t3616;
  t3751 = t3618 * t3745;
  t3752 = t3750 * t3751;
  t3755 = t3746 * t389;
  t3758 = t3740 * t1078;
  t3761 = t379 * t3738;
  t3765 = t3750 * t3618 * t1051;
  t3773 = t3596 * t386;
  t3774 = t3773 * t1068;
  t3777 = t3773 * t412;
  t3785 = t3618 * params->csk_a;
  t3786 = t3750 * t3785;
  t3797 = t1045 * t1055;
  t3802 = -0.4e1 * t1140 * t163 * t165 * t405 + 0.4e1 * t1140 * t388 * t411 * t623 - 0.6e1 * t1060 * t1588 * t3728 - 0.18e2 * t1584 * t3797 + 0.12e2 * t3739 * t3747 + 0.18e2 * t3739 * t3755 - 0.18e2 * t3739 * t3777 + 0.7e1 * t3744 * t3774 - 0.6e1 * t3744 * t3786 - 0.11e2 * t3761 * t3774 + 0.7e1 * t3761 * t3777;
  t3804 = t3626 * t382;
  t3805 = t379 * t3804;
  t3811 = t1060 * t3696;
  t3818 = t3587 * t3589;
  t3819 = t379 * t3818;
  t3825 = t163 * t3738;
  t3826 = t3596 * t74;
  t3827 = t3826 * t395;
  t3830 = t1045 * t1090;
  t3837 = t170 * t382;
  t3838 = t1050 * t3837;
  t3841 = -0.12e2 * t1580 * t163 * t3642 - 0.12e2 * t163 * t3660 * t3838 + 0.3e1 * t163 * t3804 * t396 + 0.3e1 * t163 * t3818 * t396 - 0.6e1 * t3670 * t3811 - 0.18e2 * t3710 * t3830 + 0.4e1 * t3735 * t640 - 0.3e1 * t3805 * t396 - 0.3e1 * t3805 * t413 - 0.3e1 * t3819 * t413 + 0.11e2 * t3825 * t3827;
  t3846 = t3746 * t171;
  t3855 = t3596 * t1051;
  t3856 = t3855 * t171;
  t3865 = -0.6e1 * t3739 * t3758 + 0.6e1 * t3739 * t3846 + 0.6e1 * t3739 * t3856 - 0.6e1 * t3741 * t3744 - t3744 * t3846 - 0.11e2 * t3761 * t3827 - 0.7e1 * t3761 * t3846 - 0.18e2 * t3761 * t3856 - 0.3e1 * t3819 * t396 + t3825 * t3846 + 0.6e1 * t3825 * t3856;
  t3869 = my_piecewise5(t64, 0, t67, 0, 0.18e2 * t163 * t3578 * t394 * t1579 * t403 - 0.4e1 * t1132 + 0.4e1 * t1121 - 0.4e1 * t1116 + 0.4e1 * t1102 + 0.4e1 * t1092 - 0.5e1 * t1074 + 0.18e2 * t163 * t1664 * t384 * t3575 - t406 + t3865 + t3841 + t3802 - 0.6e1 * t3657 * t1615 + 0.18e2 * t3661 * t3664 - 0.6e1 * t3667 * t3664 + 0.18e2 * t3670 * t3672 + 0.18e2 * t3643 * t1651 - 0.6e1 * t3636 * t3647 - 0.18e2 * t3580 * t3581 - 0.18e2 * t3580 * t1675 - 0.6e1 * t3744 * t3752 - 0.7e1 * t3744 * t3755 + 0.18e2 * t3744 * t3758 - 0.7e1 * t3761 * t3755 + 0.11e2 * t3744 * t3765 + 0.18e2 * t1588 * t3730 - 0.12e2 * t3657 * t1634 + 0.4e1 * t3735 * t630 - 0.12e2 * t3739 * t3741 - 0.12e2 * t3744 * t3747 + 0.18e2 * t3661 * t3680 - 0.6e1 * t3650 * t3652 + 0.18e2 * t3643 * t1615 + t3640 + t3725);
  t3877 = t7 * t984 * t144 * t79;
  t3881 = t7 * t340 * t353 * t79;
  t3885 = t7 * t139 * t1007 * t79;
  t3888 = 0.1e1 / t30 / t331;
  t3892 = 0.14e2 / 0.135e3 * t7 * t29 * t3888 * t79;
  t3893 = 0.3e1 / 0.2e2 * t7 * t3513 * t31 * t79 + 0.3e1 / 0.5e1 * t7 * t985 * t176 + 0.6e1 / 0.5e1 * t3522 + 0.9e1 / 0.1e2 * t7 * t341 * t418 - 0.2e1 / 0.5e1 * t3528 + 0.6e1 / 0.5e1 * t3531 + 0.3e1 / 0.5e1 * t7 * t140 * t1155 + 0.8e1 / 0.45e2 * t3537 - t3540 / 0.5e1 + 0.2e1 / 0.5e1 * t3543 + 0.3e1 / 0.2e2 * t7 * t32 * (0.4e1 * t1030 * t174 + 0.4e1 * t1153 * t161 + t3557 * t77 + 0.6e1 * t373 * t416 + t3869 * t59 + t3550) + 0.2e1 / 0.5e1 * t3877 - t3881 / 0.5e1 + 0.8e1 / 0.45e2 * t3885 - t3892;
  t3894 = my_piecewise3(t2, 0, t3893);
  t3895 = t88 * t88;
  t3897 = 0.1e1 / t90 / t3895;
  t3898 = t425 * t425;
  t3904 = t431 * t431;
  t3909 = t85 * t3505;
  t3912 = my_piecewise5(t16, 0, t12, 0, 0.24e2 * t976 + 0.24e2 * t3909);
  t3916 = my_piecewise3(t89, 0, 0.4e2 / 0.81e2 * t3897 * t3898 - 0.2e2 / 0.9e1 * t1162 * t425 * t431 + 0.1e2 / 0.3e1 * t424 * t3904 + 0.4e2 / 0.9e1 * t1166 * t1172 + 0.5e1 / 0.3e1 * t91 * t3912);
  t3923 = t7 * t1176 * t144 * t127;
  t3927 = t7 * t435 * t353 * t127;
  t3931 = t7 * t187 * t1007 * t127;
  t3936 = 0.14e2 / 0.135e3 * t7 * t93 * t3888 * t127;
  t3938 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t3916 * t31 * t127 + 0.2e1 / 0.5e1 * t3923 - t3927 / 0.5e1 + 0.8e1 / 0.45e2 * t3931 - t3936);
  tv4rho40 = 0.4e1 * t1160 + 0.4e1 * t1194 + t8 * (t3894 + t3938);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t3945 = t7 * t1214 * t144 * t79;
  t3949 = t7 * t460 * t353 * t79;
  t3950 = t3949 / 0.1e2;
  t3953 = t7 * t204 * t1007 * t79;
  t3971 = 0.12e2 * t976;
  t3972 = 0.24e2 * t3506;
  t3974 = my_piecewise5(t12, 0, t16, 0, -t3971 + t3972);
  t3978 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3492 * t201 * t969 - 0.1e2 / 0.9e1 * t968 * t456 * t328 - 0.1e2 / 0.9e1 * t1199 * t136 * t336 + 0.1e2 / 0.3e1 * t327 * t1210 * t136 + 0.1e2 / 0.3e1 * t1202 * t336 + 0.1e2 / 0.9e1 * t452 * t980 + 0.5e1 / 0.3e1 * t27 * t3974);
  t3987 = t7 * t1219 * t176;
  t3993 = t7 * t1226 * t176;
  t3994 = t3993 / 0.1e2;
  t3996 = t7 * t465 * t418;
  t4010 = 0.3e1 / 0.1e2 * t3945 - t3950 + 0.2e1 / 0.45e2 * t3953 + 0.3e1 / 0.2e2 * t7 * t3978 * t31 * t79 + 0.9e1 / 0.2e2 * t7 * t1215 * t176 + 0.3e1 / 0.5e1 * t3987 + 0.9e1 / 0.2e2 * t7 * t461 * t418 - t3994 + 0.3e1 / 0.1e2 * t3996 + 0.3e1 / 0.2e2 * t7 * t205 * t1155 + 0.3e1 / 0.1e2 * t3522 - t3528 / 0.5e1 + 0.3e1 / 0.1e2 * t3531 + 0.2e1 / 0.15e2 * t3537 - t3540 / 0.1e2 + t3543 / 0.1e2 + t3877 / 0.1e2 - t3881 / 0.1e2 + 0.2e1 / 0.15e2 * t3885 - t3892;
  t4011 = my_piecewise3(t2, 0, t4010);
  t4028 = 0.24e2 * t3909;
  t4030 = my_piecewise5(t16, 0, t12, 0, t3971 + t4028);
  t4034 = my_piecewise3(t89, 0, 0.4e2 / 0.81e2 * t3897 * t212 * t1163 - 0.1e2 / 0.9e1 * t1162 * t480 * t425 - 0.1e2 / 0.9e1 * t1243 * t184 * t431 + 0.1e2 / 0.3e1 * t424 * t1253 * t184 + 0.1e2 / 0.3e1 * t1246 * t431 + 0.1e2 / 0.9e1 * t476 * t1172 + 0.5e1 / 0.3e1 * t91 * t4030);
  t4041 = t7 * t1257 * t144 * t127;
  t4045 = t7 * t484 * t353 * t127;
  t4046 = t4045 / 0.1e2;
  t4049 = t7 * t215 * t1007 * t127;
  t4058 = t7 * t1181 * t247;
  t4061 = t7 * t1185 * t247;
  t4062 = t4061 / 0.1e2;
  t4064 = t7 * t1189 * t247;
  t4066 = 0.3e1 / 0.2e2 * t7 * t4034 * t31 * t127 + 0.3e1 / 0.1e2 * t4041 - t4046 + 0.2e1 / 0.45e2 * t4049 + t3923 / 0.1e2 - t3927 / 0.1e2 + 0.2e1 / 0.15e2 * t3931 - t3936 + 0.3e1 / 0.2e2 * t7 * t1177 * t247 + 0.3e1 / 0.1e2 * t4058 - t4062 + 0.2e1 / 0.45e2 * t4064;
  t4067 = my_piecewise3(t84, 0, t4066);
  tv4rho41 = t1160 + t1194 + 0.3e1 * t1242 + 0.3e1 * t1282 + t8 * (t4011 + t4067);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 1] += tv4rho41;

  t4082 = t456 * t456;
  t4095 = my_piecewise5(t12, 0, t16, 0, t3972);
  t4099 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3492 * t506 * t328 - 0.4e2 / 0.27e2 * t1199 * t136 * t456 - 0.1e2 / 0.27e2 * t1285 * t336 + 0.2e2 / 0.9e1 * t327 * t4082 + 0.2e2 / 0.9e1 * t452 * t1210 - 0.1e2 / 0.27e2 * t968 * t511 * t328 + 0.2e2 / 0.9e1 * t327 * t1294 * t136 + 0.1e2 / 0.9e1 * t1290 * t336 + 0.5e1 / 0.3e1 * t27 * t4095);
  t4108 = t7 * t1303 * t176;
  t4115 = t7 * t1298 * t144 * t79;
  t4119 = t7 * t515 * t353 * t79;
  t4132 = 0.3e1 / 0.2e2 * t7 * t4099 * t31 * t79 + 0.3e1 / 0.1e2 * t7 * t1299 * t176 + t4108 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t516 * t418 + t4115 / 0.5e1 - t4119 / 0.3e2 + t3945 / 0.5e1 - 0.2e1 / 0.15e2 * t3949 + 0.4e1 / 0.45e2 * t3953 + 0.2e1 / 0.5e1 * t3987 - 0.2e1 / 0.15e2 * t3993 + t3996 / 0.5e1 - t3528 / 0.15e2 + 0.4e1 / 0.45e2 * t3537 - t3540 / 0.3e2 - t3881 / 0.3e2 + 0.4e1 / 0.45e2 * t3885 - t3892;
  t4133 = my_piecewise3(t2, 0, t4132);
  t4142 = t480 * t480;
  t4155 = my_piecewise5(t16, 0, t12, 0, t4028);
  t4159 = my_piecewise3(t89, 0, 0.4e2 / 0.81e2 * t3897 * t523 * t425 - 0.4e2 / 0.27e2 * t1243 * t184 * t480 - 0.1e2 / 0.27e2 * t1315 * t431 + 0.2e2 / 0.9e1 * t424 * t4142 + 0.2e2 / 0.9e1 * t476 * t1253 - 0.1e2 / 0.27e2 * t1162 * t528 * t425 + 0.2e2 / 0.9e1 * t424 * t1324 * t184 + 0.1e2 / 0.9e1 * t1320 * t431 + 0.5e1 / 0.3e1 * t91 * t4155);
  t4166 = t7 * t1328 * t144 * t127;
  t4170 = t7 * t532 * t353 * t127;
  t4179 = t7 * t1262 * t247;
  t4182 = t7 * t1266 * t247;
  t4193 = t7 * t440 * t599;
  t4196 = t7 * t444 * t599;
  t4198 = 0.3e1 / 0.2e2 * t7 * t4159 * t31 * t127 + t4166 / 0.5e1 - t4170 / 0.3e2 + t4041 / 0.5e1 - 0.2e1 / 0.15e2 * t4045 + 0.4e1 / 0.45e2 * t4049 + 0.3e1 / 0.1e2 * t7 * t1258 * t247 + 0.2e1 / 0.5e1 * t4179 - t4182 / 0.15e2 - t3927 / 0.3e2 + 0.4e1 / 0.45e2 * t3931 - t3936 + t4058 / 0.5e1 - 0.2e1 / 0.15e2 * t4061 + 0.4e1 / 0.45e2 * t4064 + 0.3e1 / 0.2e2 * t7 * t436 * t599 + t4193 / 0.5e1 - t4196 / 0.3e2;
  t4199 = my_piecewise3(t84, 0, t4198);
  tv4rho42 = 0.2e1 * t1242 + 0.2e1 * t1282 + 0.2e1 * t1314 + 0.2e1 * t1353 + t8 * (t4133 + t4199);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 2] += tv4rho42;

  t4220 = my_piecewise5(t12, 0, t16, 0, t3971 + t3972);
  t4224 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3492 * t1358 * t136 - 0.1e2 / 0.9e1 * t1285 * t456 - 0.1e2 / 0.9e1 * t1199 * t511 * t136 + 0.1e2 / 0.3e1 * t1202 * t511 + 0.1e2 / 0.3e1 * t452 * t1294 + 0.1e2 / 0.9e1 * t327 * t1365 * t136 + 0.5e1 / 0.3e1 * t27 * t4220);
  t4231 = t7 * t1369 * t144 * t79;
  t4242 = 0.3e1 / 0.2e2 * t7 * t4224 * t31 * t79 + t4231 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t1370 * t176 + 0.3e1 / 0.1e2 * t4115 - t4119 / 0.1e2 + 0.3e1 / 0.1e2 * t4108 - t3950 + 0.2e1 / 0.15e2 * t3953 - t3994 + 0.2e1 / 0.45e2 * t3885 - t3892 + 0.2e1 / 0.45e2 * t3537;
  t4243 = my_piecewise3(t2, 0, t4242);
  t4260 = my_piecewise5(t16, 0, t12, 0, -t3971 + t4028);
  t4264 = my_piecewise3(t89, 0, 0.4e2 / 0.81e2 * t3897 * t1378 * t184 - 0.1e2 / 0.9e1 * t1315 * t480 - 0.1e2 / 0.9e1 * t1243 * t528 * t184 + 0.1e2 / 0.3e1 * t1246 * t528 + 0.1e2 / 0.3e1 * t476 * t1324 + 0.1e2 / 0.9e1 * t424 * t1385 * t184 + 0.5e1 / 0.3e1 * t91 * t4260);
  t4271 = t7 * t1389 * t144 * t127;
  t4279 = t7 * t1333 * t247;
  t4288 = t7 * t489 * t599;
  t4298 = t7 * t192 * t1540;
  t4300 = 0.3e1 / 0.2e2 * t7 * t4264 * t31 * t127 + t4271 / 0.1e2 + 0.3e1 / 0.1e2 * t4166 - t4170 / 0.1e2 + 0.9e1 / 0.2e2 * t7 * t1329 * t247 + 0.3e1 / 0.1e2 * t4279 - t4046 + 0.2e1 / 0.15e2 * t4049 + 0.3e1 / 0.5e1 * t4179 - t4182 / 0.5e1 + 0.9e1 / 0.2e2 * t7 * t485 * t599 + 0.3e1 / 0.1e2 * t4288 + 0.2e1 / 0.45e2 * t3931 - t3936 - t4062 + 0.2e1 / 0.15e2 * t4064 + 0.3e1 / 0.1e2 * t4193 - t4196 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t188 * t1540 + t4298 / 0.1e2;
  t4301 = my_piecewise3(t84, 0, t4300);
  tv4rho43 = 0.3e1 * t1314 + 0.3e1 * t1353 + t1377 + t1545 + t8 * (t4243 + t4301);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 3] += tv4rho43;

  t4306 = t506 * t506;
  t4311 = t511 * t511;
  t4318 = my_piecewise5(t12, 0, t16, 0, 0.24e2 * t976 + 0.24e2 * t3506);
  t4322 = my_piecewise3(t22, 0, 0.4e2 / 0.81e2 * t3492 * t4306 - 0.2e2 / 0.9e1 * t1285 * t511 + 0.1e2 / 0.3e1 * t327 * t4311 + 0.4e2 / 0.9e1 * t452 * t1365 + 0.5e1 / 0.3e1 * t27 * t4318);
  t4331 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t4322 * t31 * t79 + 0.2e1 / 0.5e1 * t4231 - t4119 / 0.5e1 + 0.8e1 / 0.45e2 * t3953 - t3892);
  t4340 = 0.1e1 / t97 / t542 / t95;
  t4343 = 0.1309e5 / 0.729e3 * t38 * sigma[2] * t4340;
  t4350 = 0.2618e4 / 0.243e3 * t47 * t103 * t4340 + 0.77e3 / 0.243e3 * t52 * t107 * t1407 - t4343;
  t4364 = t561 * t561;
  t4365 = t4364 * t563;
  t4366 = t234 * t4365;
  t4367 = t1783 * t1504;
  t4371 = t1783 * t2394 * t584;
  t4374 = t234 * t1776;
  t4376 = t1783 * t2394 * t580;
  t4380 = t580 * t1431;
  t4384 = t4364 * t584;
  t4387 = t563 * t122 * t241;
  t4388 = t1460 * t4387;
  t4391 = t1429 * t4380;
  t4394 = t580 * t238;
  t4397 = t575 * t1784 * t584;
  t4400 = t560 * t4365;
  t4403 = t1429 * t4365;
  t4407 = t592 * t1472 * t580;
  t4411 = t1445 * t1472 * params->csk_a;
  t4414 = t1429 * t4384;
  t4416 = t563 * t567 * t569;
  t4417 = t1460 * t4416;
  t4421 = t1445 * t1446 * t584;
  t4424 = t1783 * t1513;
  t4427 = 0.18e2 * t1810 * t4380 * t560 + 0.18e2 * t234 * t4394 * t4397 + 0.18e2 * t4384 * t4388 * t560 - 0.18e2 * t1822 * t4391 + 0.18e2 * t1853 * t4407 + 0.18e2 * t4367 * t4400 - 0.6e1 * t4371 * t4403 - 0.18e2 * t4374 * t4424 + 0.18e2 * t4400 * t4421 + 0.18e2 * t4403 * t4411 - 0.18e2 * t4414 * t4417;
  t4429 = t1525 * t563;
  t4430 = t560 * t4429;
  t4439 = t1445 * t1826;
  t4442 = t234 * t4429;
  t4445 = t1439 * t584;
  t4447 = t1437 * t4445 * params->csk_a;
  t4451 = t1437 * t1456 * t563;
  t4457 = params->csk_a * t238;
  t4458 = t4457 * t580;
  t4459 = t570 * t4458;
  t4464 = params->csk_a * t584;
  t4466 = t242 * t4464 * t580;
  t4474 = t234 * t4364;
  t4475 = t584 * t584;
  t4476 = t4475 * t565;
  t4477 = t4476 * t242;
  t4480 = t580 * t580;
  t4481 = t234 * t4480;
  t4489 = t563 * t563;
  t4490 = t564 * t564;
  t4491 = 0.1e1 / t4490;
  t4492 = t4489 * t4491;
  t4493 = t4492 * t242;
  t4496 = t560 * t4364;
  t4497 = t4476 * t570;
  t4501 = t4492 * t1521;
  t4504 = t4492 * t570;
  t4507 = t558 * t558;
  t4509 = t124 / t4507;
  t4511 = t567 * t567;
  t4512 = t568 * t568;
  t4513 = 0.1e1 / t4512;
  t4514 = t4511 * t4513;
  t4515 = t4492 * t4514;
  t4517 = my_piecewise3(t115, 0, t4350);
  t4518 = my_piecewise3(t117, t4517, 0);
  t4521 = -0.18e2 * t1875 * t4394 * t560 * t565 + 0.6e1 * t1429 * t4364 * t4501 - t234 * t243 * t4518 + t4364 * t4509 * t4515 + 0.3e1 * t4480 * t560 * t571 + 0.3e1 * t4474 * t4477 + 0.6e1 * t4474 * t4493 - 0.3e1 * t4481 * t586 + 0.3e1 * t4481 * t588 + 0.3e1 * t4496 * t4497 + 0.11e2 * t4496 * t4504;
  t4525 = t1445 * t1446 * t580;
  t4528 = t1439 * t580;
  t4530 = t1437 * t4528 * params->csk_a;
  t4535 = t4480 * t563;
  t4536 = t560 * t4535;
  t4539 = t4364 * t4489;
  t4540 = t1429 * t4539;
  t4541 = t4491 * t1436;
  t4542 = t4541 * t1440;
  t4545 = t1439 * t3745;
  t4546 = t4541 * t4545;
  t4549 = t4509 * t4539;
  t4552 = t4491 * t4511;
  t4553 = t4513 * t3745;
  t4554 = t4552 * t4553;
  t4557 = t4541 * t1456;
  t4560 = t560 * t4539;
  t4561 = t4491 * t567;
  t4562 = t569 * t3745;
  t4563 = t4561 * t4562;
  t4570 = t4552 * t4513 * t1051;
  t4577 = t1783 * t1788;
  t4580 = t1445 * t1423;
  t4583 = t4561 * t1446;
  t4588 = t4561 * t593;
  t4598 = -0.4e1 * t1525 * t234 * t236 * t586 - 0.6e1 * t1437 * t1791 * t4528 - 0.18e2 * t1777 * t4580 - 0.12e2 * t4374 * t4577 + 0.18e2 * t4540 * t4563 - 0.18e2 * t4540 * t4588 - 0.7e1 * t4549 * t4563 + 0.11e2 * t4549 * t4570 + 0.7e1 * t4549 * t4583 - 0.11e2 * t4560 * t4583 + 0.7e1 * t4560 * t4588;
  t4601 = t4552 * t4513 * params->csk_a;
  t4615 = t1437 * t4445;
  t4622 = t4364 * t4475;
  t4623 = t560 * t4622;
  t4626 = t1445 * t1472;
  t4629 = t4491 * params->csk_a;
  t4630 = t4629 * t242;
  t4635 = 0.4e1 * t1525 * t569 * t592 * t685 - 0.12e2 * t1783 * t241 * t4366 * t584 + 0.3e1 * t234 * t4535 * t577 - 0.18e2 * t4400 * t4626 - 0.6e1 * t4403 * t4615 + 0.4e1 * t4442 * t702 - 0.3e1 * t4536 * t577 - 0.6e1 * t4549 * t4601 - 0.11e2 * t4560 * t4630 - 0.3e1 * t4623 * t577 - 0.3e1 * t4623 * t594;
  t4639 = t234 * t4539;
  t4642 = t4491 * t1051;
  t4643 = t4642 * t242;
  t4648 = t4491 * t3745;
  t4649 = t4648 * t242;
  t4662 = 0.3e1 * t234 * t4622 * t577 - 0.6e1 * t4540 * t4557 + 0.6e1 * t4540 * t4643 + 0.6e1 * t4540 * t4649 - 0.6e1 * t4542 * t4549 - t4549 * t4649 - 0.18e2 * t4560 * t4643 - 0.7e1 * t4560 * t4649 + 0.11e2 * t4630 * t4639 + 0.6e1 * t4639 * t4643 + t4639 * t4649;
  t4666 = my_piecewise5(t114, 0, t115, 0, -0.5e1 * t1452 + 0.4e1 * t1474 + 0.4e1 * t1484 - 0.4e1 * t1501 + 0.4e1 * t1506 - 0.4e1 * t1510 - 0.18e2 * t560 * t561 * t584 * t565 * t4459 - t587 + t4662 + t4635 + t4598 + t4521 + t4427 - 0.4e1 * t4430 * t692 - 0.18e2 * t4366 * t4367 - 0.6e1 * t4366 * t4371 - 0.6e1 * t4374 * t4376 - 0.7e1 * t4560 * t4563 - 0.12e2 * t4540 * t4542 + 0.12e2 * t4540 * t4546 - 0.12e2 * t4549 * t4546 - 0.6e1 * t4549 * t4554 + 0.18e2 * t4549 * t4557 + 0.18e2 * t1777 * t4525 + 0.18e2 * t1791 * t4530 - 0.12e2 * t4391 * t1830 - 0.3e1 * t4536 * t594 + 0.18e2 * t1791 * t4439 + 0.4e1 * t4442 * t692 + 0.18e2 * t4403 * t4447 - 0.12e2 * t4414 * t4451 - 0.4e1 * t4430 * t707 - 0.6e1 * t1791 * t4376 + 0.18e2 * t1777 * t4424 + 0.18e2 * t234 * t1852 * t565 * t4466);
  t4672 = t523 * t523;
  t4677 = t528 * t528;
  t4684 = my_piecewise5(t16, 0, t12, 0, -0.24e2 * t976 + 0.24e2 * t3909);
  t4688 = my_piecewise3(t89, 0, 0.4e2 / 0.81e2 * t3897 * t4672 - 0.2e2 / 0.9e1 * t1315 * t528 + 0.1e2 / 0.3e1 * t424 * t4677 + 0.4e2 / 0.9e1 * t476 * t1385 + 0.5e1 / 0.3e1 * t91 * t4684);
  t4705 = 0.9e1 / 0.1e2 * t7 * t533 * t599 + 0.3e1 / 0.5e1 * t7 * t216 * t1540 + 0.3e1 / 0.2e2 * t7 * t94 * (t113 * t4666 + t125 * t4350 + 0.4e1 * t1417 * t245 + 0.4e1 * t1538 * t232 + 0.6e1 * t554 * t597 + t4343) + 0.3e1 / 0.2e2 * t7 * t4688 * t31 * t127 + 0.3e1 / 0.5e1 * t7 * t1390 * t247 + 0.2e1 / 0.5e1 * t4271 + 0.6e1 / 0.5e1 * t4279 + 0.6e1 / 0.5e1 * t4288 + 0.2e1 / 0.5e1 * t4298 - t4170 / 0.5e1 - 0.2e1 / 0.5e1 * t4182 - t4196 / 0.5e1 + 0.8e1 / 0.45e2 * t4064 + 0.8e1 / 0.45e2 * t4049 - t3936;
  t4706 = my_piecewise3(t84, 0, t4705);
  tv4rho44 = 0.4e1 * t1377 + 0.4e1 * t1545 + t8 * (t4331 + t4706);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 4] += tv4rho44;

  t4714 = t7 * t989 * t268;
  t4720 = t7 * t996 * t268;
  t4723 = t7 * t345 * t650;
  t4730 = 0.2e1 / 0.45e2 * t7 * t1008 * t268;
  t4732 = t7 * t354 * t650;
  t4735 = t7 * t145 * t1692;
  t4738 = 0.77e3 / 0.243e3 * t38 * t1020;
  t4742 = -0.154e3 / 0.81e2 * t47 * t37 * t1020 + t4738;
  t4761 = t263 * t3594;
  t4762 = t1038 * t4761;
  t4764 = t1039 * t74 * t170;
  t4765 = t3746 * t4764;
  t4768 = t3614 * t4761;
  t4770 = t379 * t4761;
  t4771 = t3855 * t4764;
  t4776 = t633 * t1040;
  t4777 = t379 * t4776;
  t4780 = 0.9e1 * t1615 * t4777 + 0.6e1 * t4762 * t4765 + 0.6e1 * t4762 * t4771 - t4765 * t4768 - 0.18e2 * t4770 * t4771 - 0.3e1 * t1594 - 0.2e1 * t1598 + 0.4e1 * t1662 + 0.4e1 * t1668 + 0.4e1 * t1676 - 0.4e1 * t1680 - 0.4e1 * t1682 - t638;
  t4781 = t1038 * t4776;
  t4784 = t163 * t4761;
  t4787 = t1039 * t3594;
  t4788 = t3614 * t4787;
  t4790 = t3773 * t624 * t1051;
  t4794 = t3740 * t1078 * t1039;
  t4797 = t263 * t1039;
  t4798 = t163 * t4797;
  t4799 = t3590 * t2551;
  t4803 = t3826 * t395 * t1039;
  t4807 = t403 * t1044 * t3663;
  t4810 = t379 * t4797;
  t4811 = t389 * params->csk_a;
  t4812 = t3590 * t4811;
  t4819 = t1062 * t3745;
  t4821 = t3740 * t4819 * t1039;
  t4827 = t388 * t3745;
  t4829 = t3773 * t4827 * t1039;
  t4832 = -0.3e1 * t1615 * t4781 - 0.6e1 * t4762 * t4794 + 0.12e2 * t4762 * t4821 - 0.7e1 * t4765 * t4770 + t4765 * t4784 - 0.11e2 * t4770 * t4803 - 0.7e1 * t4770 * t4829 + 0.6e1 * t4771 * t4784 + 0.11e2 * t4784 * t4803 + 0.7e1 * t4788 * t4790 + 0.3e1 * t4798 * t4799 - 0.12e2 * t4798 * t4807 - 0.3e1 * t4799 * t4810 - 0.3e1 * t4810 * t4812;
  t4834 = t163 * t4776;
  t4837 = t379 * t4787;
  t4838 = t3773 * t882;
  t4842 = t3773 * t1068 * t1039;
  t4845 = t633 * t380;
  t4849 = t1039 * t382;
  t4850 = t379 * t4849;
  t4851 = t1045 * t1666;
  t4855 = t1050 * t639 * t399;
  t4859 = t411 * t1607 * t403;
  t4864 = t1038 * t4787;
  t4867 = t1685 * t382;
  t4868 = t379 * t4867;
  t4873 = t1045 * t2271;
  t4878 = t163 * t4867;
  t4881 = 0.9e1 * t163 * t1661 * t4845 - 0.3e1 * t1125 * t1642 - 0.6e1 * t1578 * t4855 + 0.9e1 * t1588 * t4873 - 0.9e1 * t1626 * t4781 + 0.9e1 * t1651 * t4777 - 0.9e1 * t1651 * t4834 + 0.9e1 * t1665 * t4859 - 0.11e2 * t4770 * t4842 + 0.7e1 * t4837 * t4838 - 0.18e2 * t4838 * t4864 - 0.18e2 * t4850 * t4851 - 0.3e1 * t4868 * t630 + 0.3e1 * t4878 * t630;
  t4885 = t394 * t395 * t1140;
  t4895 = t411 * t412 * t1140;
  t4907 = t3618 * t263;
  t4912 = t1038 * t4849;
  t4917 = t379 * t2206;
  t4922 = -0.9e1 * t1045 * t399 * t4917 * t624 - 0.3e1 * t1060 * t1589 * t2207 * t399 - 0.6e1 * t1060 * t1589 * t403 * t4912 - 0.6e1 * t3750 * t4788 * t4907 * params->csk_a + 0.9e1 * t1626 * t4777 - 0.3e1 * t1631 * t1642 - 0.6e1 * t1634 * t4781 + 0.18e2 * t4762 * t4829 - 0.12e2 * t4768 * t4821 - 0.7e1 * t4768 * t4829 - 0.3e1 * t4868 * t645 + t4885 * t628 - t4885 * t642 - t4895 * t642;
  t4925 = t3740 * t1645;
  t4930 = t3740 * t3256;
  t4935 = t1062 * t633;
  t4937 = t1060 * t4935 * params->csk_a;
  t4945 = t3750 * t3751 * t1039;
  t4955 = t379 * t2552;
  t4956 = params->csk_a * t167;
  t4957 = t4956 * t399;
  t4958 = t2556 * t4957;
  t4961 = t1112 * t167;
  t4962 = t171 * t399;
  t4963 = t4961 * t4962;
  t4966 = t379 * t2529;
  t4968 = t1051 * t399 * t165;
  t4969 = t389 * t4968;
  t4972 = t627 * t1044;
  t4973 = t163 * t4972;
  t4975 = t1051 * t1039 * t403;
  t4976 = t171 * t4975;
  t4979 = 0.9e1 * t165 * t1672 * t2551 * t399 * t403 + 0.11e2 * t1051 * t3750 * t4788 * t4907 + 0.3e1 * t1125 * t1603 + 0.9e1 * t1588 * t4937 - 0.3e1 * t1615 * t4834 - 0.6e1 * t4768 * t4945 - 0.6e1 * t4788 * t4925 + 0.18e2 * t4788 * t4930 - 0.12e2 * t4864 * t4925 - 0.9e1 * t4955 * t4958 - 0.9e1 * t4955 * t4963 + 0.9e1 * t4966 * t4969 - 0.6e1 * t4973 * t4976;
  t4982 = t171 * params->csk_a * t1039 * t403;
  t4986 = t379 * t4845 * t403;
  t4990 = t1038 * t4849 * t1044;
  t4994 = t4797 * t403;
  t4995 = t1038 * t4994;
  t4998 = t165 * t167;
  t5001 = t2217 * t399;
  t5006 = t1038 * t2206 * t1044;
  t5007 = t3231 * t399;
  t5012 = t633 * t167 * t384;
  t5017 = t389 * t4975;
  t5020 = t163 * t2529;
  t5022 = t171 * t2296 * t399;
  t5027 = t394 * t1100 * t399;
  t5032 = t389 * t3232;
  t5039 = 0.9e1 * t379 * t384 * t389 * t4998 * t5001 + 0.18e2 * t1136 * t3232 * t4990 + 0.9e1 * t163 * t1675 * t5012 + 0.9e1 * t163 * t2552 * t5027 + 0.18e2 * t379 * t4972 * t5017 + 0.9e1 * t389 * t5006 * t5007 - 0.9e1 * t1115 * t4986 - 0.9e1 * t1131 * t4986 - 0.12e2 * t3685 * t4995 - 0.18e2 * t3707 * t4995 + 0.9e1 * t4966 * t5022 - 0.18e2 * t4973 * t4982 + 0.18e2 * t4990 * t5032 - 0.9e1 * t5020 * t5022;
  t5041 = t379 * t4994;
  t5051 = t1136 * t4968;
  t5056 = t171 * t4968;
  t5063 = my_piecewise3(t67, 0, t4742);
  t5064 = my_piecewise3(t69, t5063, 0);
  t5072 = t1060 * t4935;
  t5075 = 0.9e1 * t1136 * t5006 * t5007 - t163 * t172 * t5064 + 0.3e1 * t1108 * t1608 - 0.3e1 * t1588 * t5072 - 0.9e1 * t2530 * t4969 - 0.6e1 * t2530 * t5051 - 0.3e1 * t2530 * t5056 - 0.6e1 * t3664 * t4995 + 0.18e2 * t3664 * t5041 + 0.18e2 * t3680 * t5041 + t3689 * t625 + 0.3e1 * t4878 * t640 + 0.9e1 * t4966 * t5056 - 0.3e1 * t5020 * t5056;
  t5092 = t394 * t170 * t1140;
  t5095 = t411 * t388 * t1685;
  t5103 = t1045 * t1607;
  t5109 = t170 * t1039;
  t5110 = t3826 * t5109;
  t5114 = t379 * t1039 * t3589;
  t5119 = t4788 * t3750 * t4907 - 0.3e1 * t163 * t1685 * t165 * t405 - 0.3e1 * t163 * t633 * t399 * t405 - t163 * t263 * t1140 * t405 + 0.3e1 * t1603 * t1600 + t628 * t5092 + 0.3e1 * t623 * t5095 - 0.6e1 * t4834 * t1580 + 0.11e2 * t4837 * t3773 * t624 - 0.9e1 * t1584 * t5103 + 0.6e1 * t4864 * t3740 * t1589 + 0.6e1 * t4784 * t5110 + 0.3e1 * t5114 * t625 + 0.3e1 * t4798 * t3591;
  t5123 = my_piecewise5(t64, 0, t67, 0, t4780 + t4832 + t4881 + t4922 + t4979 + t5039 + t5075 + t5119);
  t5130 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t985 * t268 + 0.3e1 / 0.1e2 * t4714 + 0.9e1 / 0.2e2 * t7 * t341 * t650 - t4720 / 0.1e2 + 0.3e1 / 0.5e1 * t4723 + 0.9e1 / 0.2e2 * t7 * t140 * t1692 + t4730 - t4732 / 0.1e2 + 0.3e1 / 0.1e2 * t4735 + 0.3e1 / 0.2e2 * t7 * t32 * (t1030 * t266 + t1153 * t260 + 0.3e1 * t1569 * t174 + 0.3e1 * t161 * t1690 + 0.3e1 * t373 * t648 + 0.3e1 * t416 * t618 + t4742 * t77 + t5123 * t59 - t4738));
  tv4rho3sigma0 = t5130 * t8 + 0.3e1 * t1697;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 1] += tv4rho3sigma1;

  t5137 = t7 * t1181 * t286;
  t5140 = t7 * t1185 * t286;
  t5144 = 0.2e1 / 0.45e2 * t7 * t1189 * t286;
  t5146 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1177 * t286 + 0.3e1 / 0.1e2 * t5137 - t5140 / 0.1e2 + t5144);
  tv4rho3sigma2 = t5146 * t8 + 0.3e1 * t1710;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 2] += tv4rho3sigma2;

  t5148 = 0.2e1 * t1724;
  t5154 = t7 * t1219 * t268 / 0.5e1;
  t5159 = t7 * t1226 * t268;
  t5163 = t7 * t465 * t650 / 0.5e1;
  t5172 = 0.3e1 / 0.2e2 * t7 * t1215 * t268 + t5154 + 0.3e1 / 0.1e2 * t7 * t461 * t650 - t5159 / 0.3e2 + t5163 + 0.3e1 / 0.2e2 * t7 * t205 * t1692 + t4714 / 0.1e2 - t4720 / 0.15e2 + t4723 / 0.5e1 + t4730 - t4732 / 0.15e2 + t4735 / 0.1e2;
  t5173 = my_piecewise3(t2, 0, t5172);
  tv4rho3sigma3 = t5173 * t8 + t1697 + t5148;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 4] += tv4rho3sigma4;

  t5175 = 0.2e1 * t1740;
  t5181 = t7 * t1262 * t286 / 0.5e1;
  t5183 = t7 * t1266 * t286;
  t5192 = t7 * t440 * t712 / 0.5e1;
  t5194 = t7 * t444 * t712;
  t5197 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1258 * t286 + t5181 - t5183 / 0.3e2 + t5137 / 0.1e2 - t5140 / 0.15e2 + t5144 + 0.3e1 / 0.2e2 * t7 * t436 * t712 + t5192 - t5194 / 0.3e2);
  tv4rho3sigma5 = t5197 * t8 + t1710 + t5175;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 5] += tv4rho3sigma5;

  t5203 = t7 * t1303 * t268;
  t5212 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1299 * t268 + t5203 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t516 * t650 + t5154 - t5159 / 0.15e2 + t5163 - t4720 / 0.3e2 + t4730 - t4732 / 0.3e2);
  tv4rho3sigma6 = t5212 * t8 + t1748 + t5148;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 7] += tv4rho3sigma7;

  t5218 = t7 * t1333 * t286;
  t5225 = t7 * t489 * t712;
  t5233 = t7 * t192 * t1886;
  t5235 = 0.3e1 / 0.2e2 * t7 * t1329 * t286 + t5218 / 0.1e2 + t5181 - t5183 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t485 * t712 + t5225 / 0.5e1 - t5140 / 0.3e2 + t5144 + t5192 - t5194 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t188 * t1886 + t5233 / 0.1e2;
  t5236 = my_piecewise3(t84, 0, t5235);
  tv4rho3sigma8 = t5236 * t8 + t1891 + t5175;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 8] += tv4rho3sigma8;

  t5245 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1370 * t268 + 0.3e1 / 0.1e2 * t5203 - t5159 / 0.1e2 + t4730);
  tv4rho3sigma9 = t5245 * t8 + 0.3e1 * t1748;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 10] += tv4rho3sigma10;

  t5263 = 0.77e3 / 0.243e3 * t38 * t1407;
  t5267 = -0.154e3 / 0.81e2 * t47 * t37 * t1407 + t5263;
  t5286 = t281 * t4489;
  t5287 = t560 * t5286;
  t5289 = t1430 * t122 * t241;
  t5290 = t4648 * t5289;
  t5293 = t1429 * t5286;
  t5295 = t4541 * t4545 * t1430;
  t5298 = t234 * t5286;
  t5299 = t4491 * t122;
  t5301 = t5299 * t576 * t1430;
  t5304 = t281 * t1430;
  t5305 = t234 * t5304;
  t5306 = t4476 * t2666;
  t5309 = t1430 * t563;
  t5310 = t560 * t5309;
  t5314 = -0.18e2 * t1445 * t1854 * t5310 - 0.7e1 * t5287 * t5290 + 0.12e2 * t5293 * t5295 + 0.11e2 * t5298 * t5301 + 0.3e1 * t5305 * t5306 - 0.3e1 * t1797 - 0.2e1 * t1801 + 0.4e1 * t1856 + 0.4e1 * t1862 - 0.4e1 * t1866 - 0.4e1 * t1868 + 0.4e1 * t1876 - t700;
  t5316 = t584 * t1435 * t4387;
  t5319 = t560 * t5304;
  t5322 = t4642 * t5289;
  t5327 = t695 * t1431;
  t5328 = t560 * t5327;
  t5331 = t1429 * t5327;
  t5338 = t4509 * t5286;
  t5343 = t234 * t5327;
  t5346 = t1430 * t4489;
  t5347 = t560 * t5346;
  t5348 = t4561 * t908;
  t5352 = t4561 * t1446 * t1430;
  t5355 = 0.9e1 * t1810 * t5328 - 0.3e1 * t1810 * t5331 - 0.9e1 * t1822 * t5331 - 0.9e1 * t1845 * t5343 - 0.18e2 * t5287 * t5322 - 0.11e2 * t5287 * t5352 + 0.6e1 * t5290 * t5293 + t5290 * t5298 - t5290 * t5338 + 0.6e1 * t5293 * t5322 + 0.6e1 * t5298 * t5322 - 0.12e2 * t5305 * t5316 - 0.3e1 * t5306 * t5319 + 0.7e1 * t5347 * t5348;
  t5358 = t592 * t1803 * t584;
  t5361 = t1879 * t563;
  t5362 = t234 * t5361;
  t5369 = t570 * params->csk_a;
  t5370 = t4476 * t5369;
  t5375 = t4509 * t5346;
  t5376 = t4541 * t1833;
  t5379 = t4541 * t3304;
  t5385 = t4561 * t4562 * t1430;
  t5390 = t1429 * t5309;
  t5395 = t560 * t2375;
  t5400 = t1429 * t5346;
  t5403 = t695 * t561;
  t5407 = -0.6e1 * t1430 * t1456 * t4541 * t5293 - 0.6e1 * t1437 * t1792 * t5390 * t584 - 0.9e1 * t1445 * t5395 * t580 * t686 + 0.9e1 * t1861 * t234 * t5403 - 0.3e1 * t1810 * t5343 + 0.9e1 * t1853 * t5358 - 0.11e2 * t5287 * t5301 - 0.7e1 * t5287 * t5385 + 0.18e2 * t5293 * t5385 - 0.3e1 * t5319 * t5370 + 0.3e1 * t5362 * t692 - 0.6e1 * t5375 * t5376 + 0.18e2 * t5375 * t5379 - 0.12e2 * t5376 * t5400;
  t5409 = t1783 * t701 * t580;
  t5416 = t560 * t5361;
  t5421 = t1445 * t2416;
  t5424 = t4513 * t281;
  t5430 = t4552 * t4553 * t1430;
  t5438 = t575 * t576 * t1525;
  t5440 = t1439 * t695;
  t5442 = t1437 * t5440 * params->csk_a;
  t5448 = 0.11e2 * t1051 * t4552 * t5375 * t5424 + 0.3e1 * t1514 * t1773 - 0.3e1 * t1514 * t1842 - 0.6e1 * t1782 * t5409 + 0.9e1 * t1791 * t5421 + 0.9e1 * t1791 * t5442 + 0.9e1 * t1822 * t5328 + 0.9e1 * t1845 * t5328 - 0.6e1 * t5338 * t5430 - 0.18e2 * t5348 * t5400 - 0.3e1 * t5416 * t692 - 0.3e1 * t5416 * t707 + t5438 * t690 - t5438 * t704;
  t5456 = t592 * t593 * t1525;
  t5466 = t4561 * t3312;
  t5473 = t236 * t584;
  t5478 = t560 * t2667;
  t5479 = t2671 * t4458;
  t5482 = t1497 * t238;
  t5483 = t242 * t580;
  t5484 = t5482 * t5483;
  t5487 = t560 * t2646;
  t5488 = t1051 * t580;
  t5489 = t5488 * t236;
  t5490 = t570 * t5489;
  t5493 = t689 * t1435;
  t5494 = t234 * t5493;
  t5497 = t242 * params->csk_a * t1430 * t584;
  t5500 = -0.3e1 * t1437 * t1792 * t2376 * t580 + 0.9e1 * t1872 * t2666 * t5473 * t580 - 0.6e1 * t4552 * t5375 * t5424 * params->csk_a - 0.3e1 * t1827 * t1842 - 0.6e1 * t1830 * t5331 - 0.12e2 * t5295 * t5338 - 0.7e1 * t5338 * t5385 + 0.7e1 * t5375 * t5466 - t5456 * t704 - 0.9e1 * t5478 * t5479 - 0.9e1 * t5478 * t5484 + 0.9e1 * t5487 * t5490 - 0.18e2 * t5494 * t5497;
  t5501 = t5304 * t584;
  t5502 = t560 * t5501;
  t5503 = t1463 * t4387;
  t5508 = t1429 * t5501;
  t5512 = t1051 * t1430 * t584;
  t5513 = t242 * t5512;
  t5518 = t1051 * t236;
  t5519 = t5518 * t5483;
  t5523 = t1429 * t2375 * t1435;
  t5529 = t570 * t5512;
  t5532 = t236 * t238;
  t5534 = t560 * t5532 * t565;
  t5535 = t2350 * t580;
  t5540 = t1429 * t5309 * t1435;
  t5546 = t575 * t1482 * t580;
  t5550 = t560 * t5403 * t584;
  t5553 = t2441 * t5483;
  t5556 = t234 * t2646;
  t5559 = 0.9e1 * t3300 * t5523 * t570 * t580 + 0.18e2 * t1521 * t3339 * t5540 + 0.9e1 * t234 * t2667 * t5546 + 0.18e2 * t5493 * t5529 * t560 + 0.9e1 * t5534 * t5535 * t570 - 0.9e1 * t1509 * t5550 - 0.3e1 * t2647 * t5519 + 0.18e2 * t4388 * t5502 - 0.6e1 * t4388 * t5508 - 0.12e2 * t4451 * t5508 + 0.9e1 * t5487 * t5553 - 0.6e1 * t5494 * t5513 + 0.18e2 * t5502 * t5503 - 0.9e1 * t5553 * t5556;
  t5562 = t695 * t238 * t565;
  t5568 = t570 * t3339;
  t5573 = t1521 * t5489;
  t5577 = t1429 * t4380 * t1435;
  t5578 = t3300 * t236;
  t5579 = t1521 * t5578;
  t5588 = my_piecewise3(t115, 0, t5267);
  t5589 = my_piecewise3(t117, t5588, 0);
  t5593 = t5299 * t241 * t1430;
  t5597 = t560 * t1430 * t4475;
  t5605 = 0.9e1 * t1875 * t234 * t5562 - t234 * t243 * t5589 + 0.11e2 * t4561 * t5347 * t686 - 0.9e1 * t1500 * t5550 - 0.9e1 * t2647 * t5490 - 0.6e1 * t2647 * t5573 - 0.18e2 * t4417 * t5508 + 0.3e1 * t4477 * t5305 + 0.6e1 * t5298 * t5593 + 0.9e1 * t5487 * t5519 - 0.3e1 * t5519 * t5556 + 0.18e2 * t5540 * t5568 + 0.9e1 * t5577 * t5579 + 0.3e1 * t5597 * t687;
  t5609 = t592 * t569 * t1879;
  t5617 = t575 * t241 * t1525;
  t5619 = t1437 * t5440;
  t5638 = t1445 * t1803;
  t5644 = 0.3e1 * t5362 * t702 + 0.3e1 * t685 * t5609 - 0.6e1 * t5343 * t1785 + 0.3e1 * t1773 * t1789 + t690 * t5617 - 0.3e1 * t1791 * t5619 + t5375 * t4552 * t5424 - 0.3e1 * t234 * t1879 * t236 * t586 - 0.3e1 * t234 * t695 * t580 * t586 - t234 * t281 * t1525 * t586 + t4430 * t687 + 0.3e1 * t1493 * t1804 - 0.9e1 * t1777 * t5638 + 0.6e1 * t5400 * t4541 * t1792;
  t5648 = my_piecewise5(t114, 0, t115, 0, t5314 + t5355 + t5407 + t5448 + t5500 + t5559 + t5605 + t5644);
  t5655 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1390 * t286 + 0.3e1 / 0.1e2 * t5218 + 0.9e1 / 0.2e2 * t7 * t533 * t712 - t5183 / 0.1e2 + 0.3e1 / 0.5e1 * t5225 + 0.9e1 / 0.2e2 * t7 * t216 * t1886 + t5144 - t5194 / 0.1e2 + 0.3e1 / 0.1e2 * t5233 + 0.3e1 / 0.2e2 * t7 * t94 * (t113 * t5648 + t125 * t5267 + t1417 * t284 + t1538 * t278 + 0.3e1 * t1764 * t245 + 0.3e1 * t1884 * t232 + 0.3e1 * t554 * t710 + 0.3e1 * t597 * t680 - t5263));
  tv4rho3sigma11 = t5655 * t8 + 0.3e1 * t1891;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 11] += tv4rho3sigma11;

  t5662 = t7 * t989 * t303;
  t5668 = t7 * t996 * t303;
  t5671 = t7 * t345 * t754;
  t5678 = 0.2e1 / 0.45e2 * t7 * t1008 * t303;
  t5680 = t7 * t354 * t754;
  t5683 = t7 * t145 * t2012;
  t5712 = t1038 * t3642 * t1044;
  t5715 = t298 * t1039;
  t5716 = t5715 * t403;
  t5717 = t1038 * t5716;
  t5720 = t735 * t1044;
  t5721 = t163 * t5720;
  t5724 = t741 * t380;
  t5725 = t5724 * t403;
  t5729 = 0.9e1 * t1115 * t163 * t5725 + 0.9e1 * t2502 * t4969 + 0.9e1 * t2538 * t5712 - 0.6e1 * t3664 * t5717 - 0.6e1 * t4976 * t5721 - 0.3e1 * t1931 - 0.2e1 * t1935 + 0.4e1 * t1950 + 0.4e1 * t1954 - 0.4e1 * t1993 + 0.4e1 * t1998 - 0.4e1 * t2000 - t746;
  t5730 = t379 * t5725;
  t5739 = t1933 * t403;
  t5740 = t163 * t5739;
  t5743 = t379 * t5716;
  t5760 = t379 * t5720;
  t5763 = -0.9e1 * t1115 * t5730 - 0.9e1 * t1131 * t5730 + 0.9e1 * t2262 * t5740 + 0.9e1 * t2502 * t5022 + 0.9e1 * t2502 * t5056 - 0.9e1 * t2507 * t5022 - 0.3e1 * t2507 * t5056 - 0.9e1 * t2514 * t4969 - 0.6e1 * t2514 * t5051 - 0.3e1 * t2514 * t5056 + 0.18e2 * t3664 * t5743 + 0.18e2 * t3680 * t5743 - 0.18e2 * t4982 * t5721 + 0.18e2 * t5017 * t5760;
  t5765 = t2723 * params->csk_a;
  t5766 = t1136 * t5765;
  t5771 = t389 * t5765;
  t5780 = t741 * t1040;
  t5781 = t1038 * t5780;
  t5784 = t298 * t3594;
  t5785 = t163 * t5784;
  t5789 = t379 * t5784;
  t5792 = t1038 * t5784;
  t5795 = t3614 * t5784;
  t5800 = t3773 * t732 * t1051;
  t5803 = -0.3e1 * t1615 * t5781 + 0.9e1 * t2526 * t3580 + 0.9e1 * t2533 * t5712 - 0.12e2 * t3685 * t5717 - 0.18e2 * t3707 * t5717 + t4765 * t5785 - 0.7e1 * t4765 * t5789 + 0.6e1 * t4765 * t5792 - t4765 * t5795 + 0.6e1 * t4771 * t5785 + 0.7e1 * t4788 * t5800 + 0.12e2 * t4821 * t5792 + 0.18e2 * t4990 * t5766 + 0.18e2 * t4990 * t5771;
  t5804 = t3740 * t1973;
  t5809 = t379 * t5715;
  t5812 = t1045 * t1948;
  t5819 = t163 * t5715;
  t5824 = t1045 * t2761;
  t5833 = t379 * t5780;
  t5839 = 0.9e1 * t163 * t1661 * t5724 + 0.9e1 * t1588 * t5824 + 0.9e1 * t1615 * t5833 - 0.18e2 * t4771 * t5789 + 0.6e1 * t4771 * t5792 - 0.6e1 * t4788 * t5804 - 0.6e1 * t4794 * t5792 - 0.3e1 * t4799 * t5809 + 0.3e1 * t4799 * t5819 + 0.11e2 * t4803 * t5785 - 0.11e2 * t4803 * t5789 - 0.3e1 * t4812 * t5809 - 0.18e2 * t4850 * t5812 - 0.12e2 * t4864 * t5804;
  t5844 = t1062 * t741;
  t5846 = t1060 * t5844 * params->csk_a;
  t5849 = t3618 * t298;
  t5851 = t3750 * t5849 * params->csk_a;
  t5858 = t2005 * t382;
  t5859 = t163 * t5858;
  t5870 = t3773 * t1956;
  t5873 = t379 * t5858;
  t5880 = -0.3e1 * t1060 * t2207 * t298 * t3728 - 0.3e1 * t1125 * t1982 + 0.9e1 * t1588 * t5846 - 0.9e1 * t1626 * t5781 + 0.9e1 * t1651 * t5833 - 0.6e1 * t1938 * t4855 - 0.6e1 * t4788 * t5851 - 0.7e1 * t4829 * t5789 + 0.18e2 * t4829 * t5792 - 0.7e1 * t4829 * t5795 - 0.18e2 * t4864 * t5870 + 0.3e1 * t5859 * t630 - 0.3e1 * t5873 * t630;
  t5881 = t163 * t5780;
  t5895 = t411 * t1922 * t403;
  t5899 = t1060 * t1926 * t403;
  t5914 = -0.12e2 * t1050 * t403 * t5109 * t736 + 0.3e1 * t1125 * t1945 + 0.9e1 * t1626 * t5833 - 0.3e1 * t1631 * t1982 - 0.9e1 * t1651 * t5881 + 0.9e1 * t1665 * t5895 - 0.9e1 * t2565 * t3643 - 0.12e2 * t4821 * t5795 + 0.7e1 * t4837 * t5870 - 0.11e2 * t4842 * t5789 + t4885 * t736 - t4885 * t748 - 0.6e1 * t4912 * t5899 - 0.3e1 * t5873 * t645;
  t5920 = t3750 * t5849 * t1051;
  t5926 = t3740 * t1926 * t1051;
  t5933 = t379 * t5739;
  t5940 = my_piecewise3(t67, 0, -0.55e2 / 0.81e2 * t52 * t1566);
  t5941 = my_piecewise3(t69, t5940, 0);
  t5952 = -t163 * t172 * t5941 - 0.3e1 * t1615 * t5881 - 0.6e1 * t1634 * t5781 + 0.9e1 * t2548 * t5740 - 0.9e1 * t2548 * t5933 - 0.9e1 * t2557 * t5933 + 0.3e1 * t3591 * t5819 + 0.11e2 * t4788 * t5920 + 0.18e2 * t4788 * t5926 - t4895 * t748 - 0.6e1 * t4945 * t5795 + 0.6e1 * t5110 * t5785 + 0.3e1 * t5114 * t733 + 0.3e1 * t5859 * t640;
  t5953 = t1045 * t1922;
  t5956 = t3740 * t1926;
  t5959 = t3750 * t5849;
  t5977 = t3773 * t732;
  t5984 = t411 * t388 * t2005;
  t5987 = t1060 * t5844;
  t5990 = -t1140 * t163 * t298 * t405 - 0.3e1 * t163 * t165 * t2005 * t405 - 0.3e1 * t163 * t399 * t405 * t741 + 0.3e1 * t1108 * t1923 - 0.6e1 * t1580 * t5881 - 0.9e1 * t1584 * t5953 - 0.3e1 * t1588 * t5987 + 0.3e1 * t1600 * t1945 + t3689 * t733 + t4788 * t5959 + 0.11e2 * t4837 * t5977 + 0.6e1 * t4864 * t5956 + t5092 * t736 + 0.3e1 * t5984 * t623;
  t5994 = my_piecewise5(t64, 0, t67, 0, t5729 + t5763 + t5803 + t5839 + t5880 + t5914 + t5952 + t5990);
  t6001 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t985 * t303 + 0.3e1 / 0.1e2 * t5662 + 0.9e1 / 0.2e2 * t7 * t341 * t754 - t5668 / 0.1e2 + 0.3e1 / 0.5e1 * t5671 + 0.9e1 / 0.2e2 * t7 * t140 * t2012 + t5678 - t5680 / 0.1e2 + 0.3e1 / 0.1e2 * t5683 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.55e2 / 0.81e2 * t52 * t1566 * t77 + 0.5e1 / 0.9e1 * t52 * t615 * t174 - 0.5e1 / 0.24e2 * t52 * t257 * t416 + t52 * t291 * t1153 / 0.24e2 + t1030 * t301 + 0.3e1 * t373 * t752 + 0.3e1 * t161 * t2010 + t59 * t5994));
  tv4rho3lapl0 = t6001 * t8 + 0.3e1 * t2017;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 0] += tv4rho3lapl0;

  t6008 = t7 * t1181 * t320;
  t6011 = t7 * t1185 * t320;
  t6015 = 0.2e1 / 0.45e2 * t7 * t1189 * t320;
  t6017 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1177 * t320 + 0.3e1 / 0.1e2 * t6008 - t6011 / 0.1e2 + t6015);
  tv4rho3lapl1 = t6017 * t8 + 0.3e1 * t2030;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 1] += tv4rho3lapl1;

  t6019 = 0.2e1 * t2044;
  t6025 = t7 * t1219 * t303 / 0.5e1;
  t6030 = t7 * t1226 * t303;
  t6034 = t7 * t465 * t754 / 0.5e1;
  t6043 = 0.3e1 / 0.2e2 * t7 * t1215 * t303 + t6025 + 0.3e1 / 0.1e2 * t7 * t461 * t754 - t6030 / 0.3e2 + t6034 + 0.3e1 / 0.2e2 * t7 * t205 * t2012 + t5662 / 0.1e2 - t5668 / 0.15e2 + t5671 / 0.5e1 + t5678 - t5680 / 0.15e2 + t5683 / 0.1e2;
  t6044 = my_piecewise3(t2, 0, t6043);
  tv4rho3lapl2 = t6044 * t8 + t2017 + t6019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 2] += tv4rho3lapl2;

  t6046 = 0.2e1 * t2060;
  t6052 = t7 * t1262 * t320 / 0.5e1;
  t6054 = t7 * t1266 * t320;
  t6063 = t7 * t440 * t808 / 0.5e1;
  t6065 = t7 * t444 * t808;
  t6068 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1258 * t320 + t6052 - t6054 / 0.3e2 + t6008 / 0.1e2 - t6011 / 0.15e2 + t6015 + 0.3e1 / 0.2e2 * t7 * t436 * t808 + t6063 - t6065 / 0.3e2);
  tv4rho3lapl3 = t6068 * t8 + t2030 + t6046;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 3] += tv4rho3lapl3;

  t6074 = t7 * t1303 * t303;
  t6083 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1299 * t303 + t6074 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t516 * t754 + t6025 - t6030 / 0.15e2 + t6034 - t5668 / 0.3e2 + t5678 - t5680 / 0.3e2);
  tv4rho3lapl4 = t6083 * t8 + t2068 + t6019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 4] += tv4rho3lapl4;

  t6089 = t7 * t1333 * t320;
  t6096 = t7 * t489 * t808;
  t6104 = t7 * t192 * t2182;
  t6106 = 0.3e1 / 0.2e2 * t7 * t1329 * t320 + t6089 / 0.1e2 + t6052 - t6054 / 0.15e2 + 0.3e1 / 0.1e2 * t7 * t485 * t808 + t6096 / 0.5e1 - t6011 / 0.3e2 + t6015 + t6063 - t6065 / 0.15e2 + 0.3e1 / 0.2e2 * t7 * t188 * t2182 + t6104 / 0.1e2;
  t6107 = my_piecewise3(t84, 0, t6106);
  tv4rho3lapl5 = t6107 * t8 + t2187 + t6046;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 5] += tv4rho3lapl5;

  t6116 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t1370 * t303 + 0.3e1 / 0.1e2 * t6074 - t6030 / 0.1e2 + t5678);
  tv4rho3lapl6 = t6116 * t8 + 0.3e1 * t2068;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 6] += tv4rho3lapl6;

  t6157 = t795 * t1431;
  t6158 = t1429 * t6157;
  t6161 = t315 * t4489;
  t6162 = t234 * t6161;
  t6165 = t4541 * t2137;
  t6168 = t315 * t1430;
  t6169 = t234 * t6168;
  t6174 = -0.3e1 * t1810 * t6158 + 0.11e2 * t5301 * t6162 + 0.3e1 * t5306 * t6169 + 0.6e1 * t5322 * t6162 - 0.12e2 * t5400 * t6165 - 0.2e1 * t2097 - 0.3e1 * t2109 + 0.4e1 * t2120 + 0.4e1 * t2124 - 0.4e1 * t2163 + 0.4e1 * t2168 - 0.4e1 * t2170 - t800;
  t6175 = t1445 * t2118;
  t6180 = t560 * t6168;
  t6185 = t560 * t6161;
  t6189 = t4541 * t2104 * t1051;
  t6195 = t1429 * t6161;
  t6198 = t4509 * t6161;
  t6200 = t1445 * t2862;
  t6209 = 0.9e1 * t1791 * t6200 + t5290 * t6162 - 0.7e1 * t5290 * t6185 + 0.6e1 * t5290 * t6195 - t5290 * t6198 - 0.11e2 * t5301 * t6185 - 0.3e1 * t5306 * t6180 - 0.18e2 * t5310 * t6175 - 0.12e2 * t5316 * t6169 - 0.18e2 * t5322 * t6185 + 0.6e1 * t5322 * t6195 - 0.3e1 * t5370 * t6180 - 0.6e1 * t5375 * t6165 - 0.6e1 * t5400 * t6189;
  t6211 = t560 * t6157;
  t6214 = t4513 * t315;
  t6216 = t4552 * t6214 * t1051;
  t6225 = t234 * t6157;
  t6234 = t4561 * t2126;
  t6240 = t4552 * t6214 * params->csk_a;
  t6247 = 0.3e1 * t1514 * t2092 + 0.9e1 * t1810 * t6211 - 0.3e1 * t1810 * t6225 + 0.9e1 * t1822 * t6211 + 0.9e1 * t1845 * t6211 - 0.9e1 * t1845 * t6225 + 0.7e1 * t5347 * t6234 - 0.11e2 * t5352 * t6185 + 0.18e2 * t5375 * t6189 + 0.11e2 * t5375 * t6216 - 0.6e1 * t5375 * t6240 - 0.7e1 * t5385 * t6185 + 0.18e2 * t5385 * t6195 - 0.18e2 * t5400 * t6234;
  t6248 = t2175 * t563;
  t6249 = t560 * t6248;
  t6257 = t1445 * t786 * t580;
  t6264 = t1439 * t795;
  t6266 = t1437 * t6264 * params->csk_a;
  t6269 = t234 * t6248;
  t6273 = t4561 * t786 * t1051;
  t6276 = t795 * t561;
  t6288 = -0.3e1 * t1437 * t2376 * t315 * t4528 + 0.9e1 * t1861 * t234 * t6276 - 0.3e1 * t1514 * t2146 + 0.9e1 * t1791 * t6266 - 0.9e1 * t1822 * t6158 + 0.12e2 * t5295 * t6195 - 0.12e2 * t5295 * t6198 + 0.7e1 * t5375 * t6273 - 0.9e1 * t5395 * t6257 - 0.6e1 * t5430 * t6198 + t5438 * t790 - t5456 * t802 - 0.3e1 * t6249 * t692 + 0.3e1 * t6269 * t692;
  t6302 = t6168 * t584;
  t6303 = t1429 * t6302;
  t6306 = t789 * t1435;
  t6307 = t234 * t6306;
  t6314 = t6276 * t584;
  t6318 = t560 * t6314;
  t6321 = t560 * t6302;
  t6324 = 0.9e1 * t1500 * t234 * t6314 - 0.9e1 * t1500 * t6318 - 0.3e1 * t1827 * t2146 - 0.6e1 * t1830 * t6158 + 0.9e1 * t2617 * t5553 - 0.9e1 * t2622 * t5553 + 0.9e1 * t2655 * t5577 - 0.6e1 * t4388 * t6303 - 0.7e1 * t5385 * t6198 - t5438 * t802 + 0.18e2 * t5503 * t6321 - 0.6e1 * t5513 * t6307 - 0.3e1 * t6249 * t707;
  t6329 = t2095 * t584;
  t6330 = t570 * t6329;
  t6333 = t234 * t6329;
  t6352 = t560 * t6306;
  t6355 = t2837 * params->csk_a;
  t6356 = t1521 * t6355;
  t6359 = 0.9e1 * t2436 * t6333 + 0.9e1 * t2617 * t5490 + 0.9e1 * t2617 * t5519 - 0.3e1 * t2622 * t5519 - 0.9e1 * t2625 * t5490 - 0.3e1 * t2625 * t5519 - 0.6e1 * t2625 * t5573 + 0.9e1 * t2650 * t5577 + 0.18e2 * t4388 * t6321 - 0.12e2 * t4451 * t6303 - 0.18e2 * t5497 * t6307 + 0.18e2 * t5529 * t6352 + 0.9e1 * t5534 * t6330 + 0.18e2 * t5540 * t6356;
  t6363 = t570 * t6355;
  t6371 = t592 * t2100 * t584;
  t6375 = t1437 * t2104 * t584;
  t6380 = t560 * t6329;
  t6387 = my_piecewise3(t115, 0, -0.55e2 / 0.81e2 * t52 * t1761);
  t6388 = my_piecewise3(t117, t6387, 0);
  t6397 = t4561 * t786;
  t6400 = -t234 * t243 * t6388 - 0.9e1 * t1509 * t6318 + 0.9e1 * t1853 * t6371 - 0.6e1 * t2115 * t5409 + 0.9e1 * t2663 * t6333 - 0.9e1 * t2663 * t6380 - 0.9e1 * t2672 * t6380 - 0.18e2 * t4417 * t6303 + 0.3e1 * t4477 * t6169 + 0.11e2 * t5347 * t6397 - 0.6e1 * t5390 * t6375 + 0.18e2 * t5540 * t6363 + 0.6e1 * t5593 * t6162 + 0.3e1 * t5597 * t787;
  t6401 = t1445 * t2100;
  t6404 = t4541 * t2104;
  t6407 = t4552 * t6214;
  t6429 = t592 * t569 * t2175;
  t6432 = t1437 * t6264;
  t6437 = -t1525 * t234 * t315 * t586 - 0.3e1 * t2175 * t234 * t236 * t586 - 0.3e1 * t234 * t580 * t586 * t795 + 0.3e1 * t1493 * t2101 - 0.9e1 * t1777 * t6401 - 0.6e1 * t1785 * t6225 + 0.3e1 * t1789 * t2092 - 0.3e1 * t1791 * t6432 + t4430 * t787 + t5375 * t6407 + 0.6e1 * t5400 * t6404 + t5617 * t790 + 0.3e1 * t6269 * t702 + 0.3e1 * t6429 * t685;
  t6441 = my_piecewise5(t114, 0, t115, 0, t6174 + t6209 + t6247 + t6288 + t6324 + t6359 + t6400 + t6437);
  t6448 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t1390 * t320 + 0.3e1 / 0.1e2 * t6089 + 0.9e1 / 0.2e2 * t7 * t533 * t808 - t6054 / 0.1e2 + 0.3e1 / 0.5e1 * t6096 + 0.9e1 / 0.2e2 * t7 * t216 * t2182 + t6015 - t6065 / 0.1e2 + 0.3e1 / 0.1e2 * t6104 + 0.3e1 / 0.2e2 * t7 * t94 * (-0.55e2 / 0.81e2 * t52 * t1761 * t125 + 0.5e1 / 0.9e1 * t52 * t677 * t245 - 0.5e1 / 0.24e2 * t52 * t275 * t597 + t52 * t308 * t1538 / 0.24e2 + t1417 * t318 + 0.3e1 * t554 * t806 + 0.3e1 * t232 * t2180 + t113 * t6441));
  tv4rho3lapl7 = t6448 * t8 + 0.3e1 * t2187;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 7] += tv4rho3lapl7;

  tv4rho3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 0] += tv4rho3tau0;

  tv4rho3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 1] += tv4rho3tau1;

  tv4rho3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 2] += tv4rho3tau2;

  tv4rho3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 3] += tv4rho3tau3;

  tv4rho3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 4] += tv4rho3tau4;

  tv4rho3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 5] += tv4rho3tau5;

  tv4rho3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 6] += tv4rho3tau6;

  tv4rho3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 7] += tv4rho3tau7;

  t6455 = t7 * t345 * t836;
  t6462 = t7 * t354 * t836 / 0.3e2;
  t6464 = t7 * t145 * t2314;
  t6475 = 0.2e1 * t2213;
  t6476 = 0.3e1 * t2216;
  t6478 = 0.2e1 * t2225;
  t6479 = 0.2e1 * t2248;
  t6480 = 0.2e1 * t2250;
  t6481 = 0.2e1 * t2258;
  t6487 = t817 * t3594;
  t6488 = t3614 * t6487;
  t6490 = t3773 * t1068 * t380;
  t6494 = t3740 * t4819 * t380;
  t6497 = t380 * t3594;
  t6498 = t1038 * t6497;
  t6500 = t3740 * t2208 * params->csk_a;
  t6503 = t817 * t380;
  t6507 = 0.3e1 * t163 * t4799 * t6503 + 0.7e1 * t6488 * t6490 - 0.12e2 * t6488 * t6494 - 0.12e2 * t6498 * t6500 - 0.4e1 * t2221 + 0.4e1 * t2263 + 0.4e1 * t2279 - 0.4e1 * t2298 + 0.4e1 * t2304 - 0.4e1 * t2308 + t6475 - t6476 + t6478 + t6479 - t6480 - t6481;
  t6508 = t163 * t6487;
  t6510 = t3826 * t395 * t380;
  t6513 = t817 * t3589;
  t6514 = t379 * t6513;
  t6515 = t412 * t380;
  t6516 = t411 * t6515;
  t6520 = t1050 * t1579 * t382;
  t6523 = t379 * t6487;
  t6524 = t3855 * t1650;
  t6527 = t1038 * t6487;
  t6532 = t824 * t1040;
  t6533 = t163 * t6532;
  t6535 = 0.3e1 * t6533 * t1651;
  t6536 = t379 * t6532;
  t6538 = 0.3e1 * t6536 * t1651;
  t6539 = t1112 * t1650;
  t6542 = t3740 * t1633;
  t6545 = t3773 * t6515;
  t6551 = t3773 * t4827 * t380;
  t6561 = 0.3e1 * t2231 * t3652 - t2241 * t3652 - 0.12e2 * t2260 * t6520 - 0.7e1 * t6488 * t6551 + 0.11e2 * t6508 * t6510 + 0.6e1 * t6508 * t6524 - 0.11e2 * t6510 * t6523 - 0.3e1 * t6514 * t6516 - 0.3e1 * t6514 * t6539 - 0.18e2 * t6523 * t6524 - 0.7e1 * t6523 * t6551 + 0.6e1 * t6524 * t6527 - 0.6e1 * t6527 * t6542 - 0.18e2 * t6527 * t6545 + 0.18e2 * t6527 * t6551 - t6535 + t6538;
  t6565 = t3614 * t6497;
  t6566 = t3618 * t817;
  t6571 = t1062 * t824;
  t6573 = t1060 * t6571 * params->csk_a;
  t6575 = 0.3e1 * t1588 * t6573;
  t6577 = t1060 * t1078 * t399;
  t6585 = t3750 * t3751 * t380;
  t6597 = t411 * t412 * t1685;
  t6604 = t2249 * t1631;
  t6605 = t1038 * t6532;
  t6607 = 0.2e1 * t6605 * t1634;
  t6610 = t388 * t817;
  t6612 = t1045 * t6610 * t403;
  t6615 = t2224 * t1125;
  t6616 = 0.3e1 * t2231 * t3715 - 0.6e1 * t6565 * t3750 * t6566 * params->csk_a + t6575 - 0.2e1 * t2241 * t6577 + 0.11e2 * t6565 * t3750 * t6566 * t1051 - 0.6e1 * t6488 * t6585 - 0.12e2 * t4917 * t1045 * t624 * t633 - 0.4e1 * t2207 * t1060 * t1589 * t633 - 0.2e1 * t642 * t6597 + 0.3e1 * t2276 * t3693 + 0.3e1 * t2231 * t3702 - t6604 - t6607 + 0.3e1 * t2260 * t5027 - 0.18e2 * t409 * t6612 + t6615;
  t6618 = 0.3e1 * t6536 * t1626;
  t6619 = t2249 * t1125;
  t6621 = 0.3e1 * t6605 * t1626;
  t6624 = t379 * t6497;
  t6625 = t6610 * params->csk_a;
  t6626 = t3773 * t6625;
  t6634 = t3773 * t3096;
  t6637 = t824 * t380;
  t6640 = 0.3e1 * t163 * t6637 * t1661;
  t6642 = t1050 * t2200 * t165;
  t6646 = t1112 * t171 * t1685;
  t6655 = t170 * t3745;
  t6657 = t3826 * t6655 * t380;
  t6661 = -0.8e1 * t1578 * t6642 - t2227 * t3652 - 0.3e1 * t2227 * t3715 - 0.3e1 * t2241 * t3702 + 0.3e1 * t2241 * t3720 + 0.3e1 * t2241 * t3730 + 0.2e1 * t628 * t6646 - 0.2e1 * t642 * t6646 + 0.18e2 * t6488 * t6542 + t6508 * t6657 - 0.7e1 * t6523 * t6657 + 0.7e1 * t6624 * t6626 - 0.11e2 * t6624 * t6634 + t6618 - t6619 - t6621 + t6640;
  t6667 = t6533 * t1615;
  t6669 = 0.3e1 * t6536 * t1615;
  t6670 = t6605 * t1615;
  t6675 = t1045 * t3085;
  t6677 = 0.3e1 * t1588 * t6675;
  t6678 = t1038 * t392;
  t6684 = t411 * t2211 * t403;
  t6686 = 0.3e1 * t1665 * t6684;
  t6687 = t820 * t1044;
  t6688 = t163 * t6687;
  t6689 = t1051 * t380;
  t6690 = t6689 * t403;
  t6691 = t171 * t6690;
  t6694 = t379 * t6687;
  t6697 = t1038 * t6687;
  t6702 = t1136 * t6690;
  t6707 = -0.6e1 * t1060 * t2208 * t403 * t6678 + 0.18e2 * t1675 * t6694 + 0.18e2 * t3581 * t6697 - t6488 * t6657 + 0.12e2 * t6494 * t6527 - 0.6e1 * t6500 * t6565 + 0.6e1 * t6527 * t6657 - 0.6e1 * t6688 * t6691 + 0.18e2 * t6691 * t6694 - 0.6e1 * t6691 * t6697 - 0.12e2 * t6697 * t6702 - t6667 + t6669 - t6670 + t6677 + t6686;
  t6710 = t6637 * t403;
  t6711 = t379 * t6710;
  t6713 = 0.3e1 * t6711 * t1115;
  t6714 = t633 * params->csk_a;
  t6715 = t6714 * t165;
  t6716 = t171 * t6715;
  t6723 = 0.3e1 * t163 * t6710 * t1115;
  t6725 = 0.3e1 * t6711 * t1131;
  t6726 = t1051 * t165;
  t6727 = t6726 * t633;
  t6728 = t171 * t6727;
  t6731 = t1136 * t6727;
  t6734 = t1592 * t403;
  t6744 = t1051 * t386;
  t6746 = t6744 * t1607 * t165;
  t6751 = t389 * t6690;
  t6754 = t389 * t4957;
  t6757 = t392 * t1044;
  t6758 = t1038 * t6757;
  t6759 = t1136 * t3079;
  t6764 = 0.12e2 * t1672 * t171 * t6734 + 0.12e2 * t2524 * t389 * t6734 + 0.12e2 * t2530 * t389 * t6715 - 0.18e2 * t1675 * t6688 - 0.3e1 * t2295 * t6754 + 0.3e1 * t2301 * t3575 - 0.8e1 * t2530 * t6731 - 0.12e2 * t2530 * t6746 + 0.12e2 * t4966 * t6716 + 0.12e2 * t4966 * t6746 - 0.12e2 * t5020 * t6716 - 0.4e1 * t5020 * t6728 + 0.18e2 * t6694 * t6751 + 0.18e2 * t6758 * t6759 - t6713 + t6723 - t6725;
  t6766 = params->csk_a * t399;
  t6767 = t6766 * t1114;
  t6782 = t2217 * t384;
  t6783 = t379 * t6782;
  t6784 = t389 * t633;
  t6789 = t2265 * t2306;
  t6794 = t633 * t633;
  t6795 = t163 * t6794;
  t6803 = t6794 * t382;
  t6811 = 0.2e1 * t6533 * t1580;
  t6813 = t394 * t1579;
  t6816 = -0.3e1 * t2295 * t6767 - 0.18e2 * t1038 * t2259 * t1044 * t6689 * t3706 + 0.12e2 * t4966 * t6728 - 0.4e1 * t2530 * t6728 + 0.12e2 * t2530 * t1136 * t6715 - 0.12e2 * t6783 * t6784 * t2306 + 0.12e2 * t163 * t6782 * t6789 - 0.12e2 * t6783 * t6789 - 0.2e1 * t6795 * t405 + 0.2e1 * t6795 * t407 + 0.2e1 * t379 * t6794 * t390 - t826 - t828 + 0.2e1 * t163 * t6803 * t396 + 0.3e1 * t379 * t6503 * t3602 - t6811 + 0.3e1 * t163 * t6513 * t6813;
  t6817 = t3826 * t1579;
  t6823 = t1045 * t2211;
  t6825 = 0.3e1 * t1584 * t6823;
  t6826 = t170 * t1685;
  t6830 = t2224 * t1600;
  t6831 = t1050 * t1599;
  t6839 = t394 * t6826;
  t6847 = t1108 * t2212;
  t6848 = t1060 * t6571;
  t6849 = t1588 * t6848;
  t6852 = t163 * t824 * t399 * t405;
  t6853 = t379 * t6803;
  t6858 = 0.6e1 * t6508 * t6817 + 0.6e1 * t6498 * t3740 * t2208 - t6825 - 0.2e1 * t2218 * t2219 * t6826 + t6830 - 0.2e1 * t2227 * t6831 + 0.11e2 * t6624 * t3773 * t6610 - 0.3e1 * t2231 * t3797 + 0.2e1 * t628 * t6839 + 0.2e1 * t642 * t5095 - t3657 * t2209 + t6565 * t3750 * t6566 + t6847 - t6849 - t6852 - 0.2e1 * t6853 * t396 - 0.2e1 * t6853 * t413;
  t6862 = my_piecewise5(t64, 0, t67, 0, t6507 + t6561 + t6616 + t6661 + t6707 + t6764 + t6816 + t6858);
  t6869 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t836 + t6455 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t2314 - t6462 + t6464 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (0.2e1 * t1569 * t266 + 0.2e1 * t161 * t2312 + 0.2e1 * t1690 * t260 + t373 * t834 + t59 * t6862 + 0.4e1 * t618 * t648));
  tv4rho2sigma20 = t6869 * t8 + 0.2e1 * t2319;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6876 = t7 * t440 * t862;
  t6880 = t7 * t444 * t862 / 0.3e2;
  t6882 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t862 + t6876 / 0.5e1 - t6880);
  tv4rho2sigma25 = t6882 * t8 + 0.2e1 * t2328;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6888 = t7 * t465 * t836;
  t6896 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t836 + t6888 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t2314 + t6455 / 0.1e2 - t6462 + t6464 / 0.1e2);
  tv4rho2sigma26 = t6896 * t8 + t2319 + t2334;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6902 = t7 * t489 * t862;
  t6909 = t7 * t192 * t2459;
  t6912 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t862 + t6902 / 0.1e2 + t6876 / 0.1e2 - t6880 + 0.3e1 / 0.2e2 * t7 * t188 * t2459 + t6909 / 0.1e2);
  tv4rho2sigma211 = t6912 * t8 + t2328 + t2464;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6920 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t836 + t6888 / 0.5e1 - t6462);
  tv4rho2sigma212 = t6920 * t8 + 0.2e1 * t2334;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6940 = 0.2e1 * t2346;
  t6941 = 0.3e1 * t2349;
  t6943 = 0.2e1 * t2362;
  t6945 = 0.2e1 * t2401;
  t6946 = 0.2e1 * t2404;
  t6947 = 0.2e1 * t2432;
  t6952 = t846 * t1435;
  t6953 = t1429 * t6952;
  t6954 = t1051 * t567;
  t6955 = t569 * t561;
  t6957 = t6954 * t6955 * t584;
  t6960 = t850 * t238;
  t6962 = t560 * t6960 * t565;
  t6963 = t570 * t1874;
  t6965 = 0.3e1 * t6962 * t6963;
  t6967 = t2353 * t236;
  t6968 = params->csk_a * t122 * t6967;
  t6971 = t1051 * t561;
  t6973 = t1521 * t6971 * t584;
  t6976 = 0.12e2 * t5487 * t6968 - 0.18e2 * t6953 * t6957 - 0.12e2 * t6953 * t6973 - 0.4e1 * t2355 + 0.4e1 * t2388 + 0.4e1 * t2437 - 0.4e1 * t2443 + 0.4e1 * t2449 - 0.4e1 * t2453 + t6940 - t6941 + t6943 + t6945 - t6946 - t6947 - t6965;
  t6977 = t1521 * t1874;
  t6982 = t560 * t6952;
  t6985 = t5473 * t695;
  t6995 = t2369 * t695;
  t6996 = t6954 * t6995;
  t6999 = t3300 * t695;
  t7005 = t1521 * t1051 * t695 * t236;
  t7011 = t850 * t561 * t584;
  t7014 = 0.3e1 * t234 * t7011 * t1500;
  t7017 = 0.3e1 * t560 * t7011 * t1500;
  t7018 = t5518 * t2380;
  t7021 = t2433 * t1435;
  t7024 = t242 * t573 * params->csk_a;
  t7036 = 0.12e2 * t234 * t2350 * t242 * t5532 * t565 * t695 + 0.12e2 * t1521 * t5523 * t6999 - 0.18e2 * t234 * t7021 * t7024 + 0.12e2 * t2641 * t570 * t6985 + 0.18e2 * t560 * t7021 * t7024 - 0.12e2 * t2647 * t6996 - 0.8e1 * t2647 * t7005 - 0.4e1 * t2647 * t7018 + 0.12e2 * t5487 * t6996 + 0.12e2 * t5487 * t7018 - 0.12e2 * t5556 * t6968 - 0.4e1 * t5556 * t7018 + 0.18e2 * t6953 * t6963 + 0.18e2 * t6953 * t6977 + 0.18e2 * t6957 * t6982 + t7014 - t7017;
  t7041 = t843 * t4489;
  t7042 = t560 * t7041;
  t7043 = t4629 * t1809;
  t7047 = t1783 * t1784 * t563;
  t7050 = t1429 * t7041;
  t7051 = t4541 * t1829;
  t7055 = t4541 * t1440 * t561;
  t7059 = t4561 * t1446 * t561;
  t7062 = t4509 * t7041;
  t7065 = t850 * t1431;
  t7066 = t1429 * t7065;
  t7068 = 0.3e1 * t7066 * t1822;
  t7069 = t4648 * t1821;
  t7072 = t234 * t7065;
  t7074 = 0.3e1 * t7072 * t1845;
  t7075 = t560 * t7065;
  t7077 = 0.3e1 * t7075 * t1845;
  t7078 = t234 * t7041;
  t7081 = t4648 * t1809;
  t7087 = t4541 * t4545 * t561;
  t7092 = 0.3e1 * t234 * t6960 * t4397;
  t7093 = 0.12e2 * t5523 * t570 * t6999 - 0.12e2 * t2434 * t7047 - 0.11e2 * t7042 * t7043 - 0.11e2 * t7042 * t7059 - 0.7e1 * t7042 * t7081 + 0.11e2 * t7043 * t7078 - 0.6e1 * t7050 * t7051 - 0.12e2 * t7050 * t7055 + 0.18e2 * t7050 * t7069 + 0.12e2 * t7050 * t7087 + 0.7e1 * t7059 * t7062 - 0.7e1 * t7062 * t7069 - t7068 - t7074 + t7077 + t7092;
  t7097 = t592 * t593 * t1879;
  t7101 = t1437 * t1456 * t580;
  t7104 = t561 * t4489;
  t7105 = t4509 * t7104;
  t7106 = t4513 * t843;
  t7112 = t4552 * t4553 * t561;
  t7124 = t7072 * t1810;
  t7126 = 0.3e1 * t7075 * t1810;
  t7127 = t7066 * t1810;
  t7131 = 0.3e1 * t7075 * t1822;
  t7132 = t6955 * params->csk_a;
  t7133 = t4561 * t7132;
  t7137 = t4541 * t2377 * params->csk_a;
  t7140 = t1445 * t3190;
  t7142 = 0.3e1 * t1791 * t7140;
  t7143 = 0.11e2 * t1051 * t4552 * t7105 * t7106 - 0.6e1 * t4552 * t7105 * t7106 * params->csk_a + 0.3e1 * t2390 * t4530 - 0.2e1 * t2390 * t7101 - 0.2e1 * t704 * t7097 - 0.7e1 * t7042 * t7069 + 0.6e1 * t7050 * t7081 - 0.18e2 * t7050 * t7133 - t7062 * t7081 - 0.12e2 * t7062 * t7087 - 0.6e1 * t7062 * t7112 - 0.6e1 * t7105 * t7137 - t7124 + t7126 - t7127 + t7131 + t7142;
  t7153 = t569 * t843;
  t7155 = t1445 * t7153 * t584;
  t7158 = t1783 * t6967;
  t7164 = t1497 * t242 * t1879;
  t7169 = t1429 * t573;
  t7181 = t2403 * t1827;
  t7182 = t1439 * t850;
  t7184 = t1437 * t7182 * params->csk_a;
  t7186 = 0.3e1 * t1791 * t7184;
  t7188 = 0.2e1 * t7066 * t1830;
  t7191 = t7078 * t7081 - 0.4e1 * t2376 * t1437 * t1792 * t695 + 0.3e1 * t2434 * t5546 - 0.18e2 * t590 * t7155 - 0.8e1 * t1782 * t7158 + 0.7e1 * t7042 * t7133 - 0.2e1 * t704 * t7164 + 0.3e1 * t2385 * t4407 - 0.6e1 * t7169 * t1437 * t2377 * t584 - 0.12e2 * t1816 * t1445 * t6995 + 0.2e1 * t690 * t7164 + 0.3e1 * t2368 * t4525 - t7181 + t7186 - t7188 - 0.3e1 * t2390 * t4525;
  t7192 = t4541 * t3193;
  t7196 = t592 * t2344 * t584;
  t7198 = 0.3e1 * t1853 * t7196;
  t7199 = t843 * t4475;
  t7200 = t560 * t7199;
  t7201 = t592 * t7132;
  t7204 = t1497 * t1809;
  t7207 = t843 * t561;
  t7212 = t5299 * t2394 * t561;
  t7219 = t2403 * t1514;
  t7227 = t2361 * t1514;
  t7232 = t6971 * t242 * t584;
  t7235 = 0.3e1 * t234 * t5306 * t7207 - t2364 * t4376 - 0.3e1 * t2364 * t4424 + 0.3e1 * t2368 * t4376 + 0.3e1 * t2368 * t4424 - t2390 * t4376 + 0.3e1 * t2390 * t4439 + 0.18e2 * t6982 * t7232 - 0.18e2 * t7042 * t7212 + 0.6e1 * t7050 * t7212 + 0.6e1 * t7078 * t7212 + 0.18e2 * t7105 * t7192 - 0.3e1 * t7200 * t7201 - 0.3e1 * t7200 * t7204 + t7198 - t7219 + t7227;
  t7243 = params->csk_a * t580;
  t7244 = t7243 * t1499;
  t7250 = t5369 * t6985;
  t7253 = t2666 * t6985;
  t7258 = t695 * t695;
  t7259 = t234 * t7258;
  t7267 = t7258 * t563;
  t7268 = t560 * t7267;
  t7279 = 0.2e1 * t234 * t577 * t7267 - 0.6e1 * t234 * t6952 * t7232 + 0.3e1 * t4497 * t560 * t7207 + 0.2e1 * t560 * t571 * t7258 + 0.12e2 * t1872 * t7253 - 0.3e1 * t2440 * t4459 - 0.3e1 * t2440 * t7244 + 0.3e1 * t2446 * t4466 - 0.12e2 * t2641 * t7250 - 0.12e2 * t2641 * t7253 - 0.2e1 * t577 * t7268 - 0.2e1 * t586 * t7259 + 0.2e1 * t588 * t7259 - 0.2e1 * t594 * t7268 - 0.6e1 * t6953 * t7232 - t852 - t854;
  t7281 = 0.2e1 * t7072 * t1785;
  t7283 = t575 * t1784;
  t7286 = t5299 * t1784;
  t7291 = t234 * t850 * t580 * t586;
  t7292 = t241 * t1879;
  t7296 = t575 * t7292;
  t7299 = t2361 * t1789;
  t7300 = t1445 * t2344;
  t7302 = 0.3e1 * t1777 * t7300;
  t7305 = t560 * t7104;
  t7311 = t1429 * t7104;
  t7320 = t1493 * t2345;
  t7321 = t1437 * t7182;
  t7322 = t1791 * t7321;
  t7323 = -t7281 + 0.3e1 * t234 * t7199 * t7283 + 0.6e1 * t7078 * t7286 - t7291 - 0.2e1 * t2351 * t2352 * t7292 + 0.2e1 * t690 * t7296 + t7299 - t7302 - 0.2e1 * t2364 * t4577 + 0.11e2 * t7305 * t4561 * t7153 - 0.3e1 * t2368 * t4580 + 0.6e1 * t7311 * t4541 * t2377 + 0.2e1 * t704 * t5609 - t4391 * t2378 + t7105 * t4552 * t7106 + t7320 - t7322;
  t7327 = my_piecewise5(t114, 0, t115, 0, t6976 + t7036 + t7093 + t7143 + t7191 + t7235 + t7279 + t7323);
  t7334 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t862 + t6902 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t2459 - t6880 + t6909 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * (t113 * t7327 + 0.2e1 * t1764 * t284 + 0.2e1 * t1884 * t278 + 0.2e1 * t232 * t2457 + t554 * t860 + 0.4e1 * t680 * t710));
  tv4rho2sigma217 = t7334 * t8 + 0.2e1 * t2464;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7341 = t7 * t345 * t888;
  t7348 = t7 * t354 * t888 / 0.3e2;
  t7350 = t7 * t145 * t2572;
  t7375 = t5784 * t3596;
  t7376 = t1038 * t7375;
  t7377 = t2515 * t380;
  t7382 = t379 * t875 * t3589;
  t7385 = t379 * t7375;
  t7386 = t1673 * t2503;
  t7393 = t163 * t7375;
  t7396 = 0.3e1 * t163 * t1952 * t3589 * t873 - 0.6e1 * t1136 * t7376 * t7377 - 0.3e1 * t6539 * t7382 - 0.11e2 * t7385 * t7386 + 0.11e2 * t7386 * t7393 - 0.2e1 * t2485 - 0.2e1 * t2488 + 0.4e1 * t2512 + 0.4e1 * t2527 - 0.4e1 * t2549 + 0.4e1 * t2554 - 0.4e1 * t2558 + t6475 - t6476 + t6478 + t6479 - t6480 - t6481 - t877;
  t7397 = t3745 * t263;
  t7398 = t7397 * t1625;
  t7401 = t7397 * t380;
  t7402 = t1136 * t7401;
  t7407 = t171 * t7401;
  t7413 = t3614 * t7375;
  t7415 = t6689 * t2503;
  t7422 = t6497 * t3596;
  t7423 = t3614 * t7422;
  t7424 = t875 * params->csk_a;
  t7425 = t1136 * t7424;
  t7430 = t5780 * t1044;
  t7431 = t379 * t7430;
  t7434 = t1038 * t7430;
  t7448 = t3614 * t4761 * t3596;
  t7449 = t298 * t1051;
  t7454 = 0.7e1 * t380 * t389 * t7448 * t7449 + 0.6e1 * t2502 * t6728 - 0.2e1 * t2507 * t6728 - 0.12e2 * t2511 * t6520 - 0.2e1 * t2514 * t6728 + 0.6e1 * t2541 * t7431 - 0.2e1 * t2541 * t7434 - 0.3e1 * t6516 * t7382 + 0.18e2 * t7376 * t7398 + 0.12e2 * t7376 * t7402 + 0.6e1 * t7376 * t7407 + 0.6e1 * t7376 * t7415 - 0.7e1 * t7385 * t7398 - 0.7e1 * t7385 * t7407 - 0.18e2 * t7385 * t7415 + t7393 * t7407 + 0.6e1 * t7393 * t7415 - 0.7e1 * t7398 * t7413 - t7407 * t7413 - 0.6e1 * t7423 * t7425;
  t7460 = t1038 * t7422;
  t7463 = t163 * t7430;
  t7468 = t2531 * t633;
  t7469 = t389 * t7468;
  t7474 = t741 * params->csk_a;
  t7475 = t7474 * t263;
  t7476 = t1136 * t7475;
  t7492 = t1929 * t403;
  t7493 = t389 * t7492;
  t7496 = t2483 * t403;
  t7500 = t2486 * t403;
  t7504 = t1136 * t7468;
  t7512 = -0.6e1 * t1136 * t2510 * t6758 + 0.6e1 * t163 * t2262 * t7496 + 0.6e1 * t163 * t2262 * t7500 - 0.6e1 * t3619 * t7423 * t7424 + 0.6e1 * t2502 * t6716 + 0.6e1 * t2502 * t6746 + 0.6e1 * t2504 * t7431 - 0.6e1 * t2504 * t7463 - 0.6e1 * t2507 * t6716 - 0.4e1 * t2514 * t6731 - 0.6e1 * t2514 * t6746 + 0.6e1 * t2517 * t7431 - 0.6e1 * t2517 * t7434 - 0.4e1 * t2521 * t7434 + 0.6e1 * t2524 * t7493 - 0.2e1 * t2541 * t7463 + 0.6e1 * t5006 * t7469 + 0.6e1 * t5006 * t7476 + 0.6e1 * t5006 * t7504 - 0.12e2 * t7425 * t7460;
  t7516 = t389 * t7475;
  t7519 = t2515 * t399;
  t7520 = t389 * t7519;
  t7525 = t7449 * t263;
  t7540 = t6766 * t2503;
  t7543 = t389 * t7424;
  t7560 = t2515 * t4962;
  t7562 = t2531 * t399;
  t7569 = 0.6e1 * t379 * t5012 * t2526 + 0.6e1 * t5006 * t7516 + 0.3e1 * t2502 * t7520 - 0.3e1 * t2514 * t7520 + 0.18e2 * t7423 * t1136 * t7525 - 0.12e2 * t7413 * t7402 - 0.2e1 * t2514 * t1136 * t7519 + 0.11e2 * t7423 * t3619 * t7525 - 0.6e1 * t7413 * t3619 * t7401 + 0.3e1 * t2502 * t7540 - 0.18e2 * t7460 * t7543 - 0.3e1 * t2507 * t7540 + 0.7e1 * t379 * t7422 * t7543 - 0.11e2 * t7385 * t389 * t7377 + 0.3e1 * t2511 * t5027 - 0.18e2 * t379 * t6757 * t389 * t2510 - t2514 * t7560 + 0.3e1 * t2530 * t389 * t7562 - t2507 * t7560 + 0.3e1 * t2502 * t7560;
  t7611 = t1060 * t4935 * t298;
  t7618 = 0.3e1 * t2524 * t389 * t5739 + 0.3e1 * t2530 * t1136 * t7562 + t5859 * t873 - t5873 * t873 - 0.2e1 * t1982 * t2266 + 0.6e1 * t5785 * t3826 * t878 * t380 + 0.6e1 * t6498 * t3740 * t2495 - 0.3e1 * t1617 * t1045 * t732 * t399 - 0.2e1 * t1938 * t1050 * t878 * t399 + 0.11e2 * t6624 * t3773 * t732 * t263 + 0.2e1 * t1945 * t2266 + t736 * t6646 - t748 * t6646 - t5873 * t883 - 0.2e1 * t1982 * t2272 - t748 * t6597 - t3657 * t2496 - 0.2e1 * t2207 * t7611 - 0.2e1 * t2207 * t1060 * t1589 * t741;
  t7625 = t1045 * t1922 * t165;
  t7633 = t389 * t298;
  t7634 = t3590 * t7633;
  t7640 = t6565 * t3750 * t4907 * t298 - 0.6e1 * t4777 * t2565 - 0.6e1 * t1617 * t7625 - 0.4e1 * t5881 * t2561 - 0.4e1 * t1938 * t6642 + 0.3e1 * t379 * t1658 * t7634 + 0.3e1 * t876 * t3590 * t1650 - t6535 + t6538 + t6575 - t6604 - t6607 + t6615 + t6618 - t6619 - t6621 + t6640 - t6667 + t6669 - t6670;
  t7649 = t1623 * t380;
  t7650 = t7649 * t3663;
  t7653 = t1038 * t2510;
  t7656 = t171 * t1051;
  t7660 = t1060 * t1062;
  t7674 = t741 * t167 * t384;
  t7675 = t379 * t7674;
  t7678 = t379 * t1996;
  t7680 = t639 * t403;
  t7681 = t6714 * t74 * t7680;
  t7684 = t4811 * t2552;
  t7690 = t163 * t7674;
  t7695 = t6677 + t6686 - t6713 + t6723 - t6725 + 0.18e2 * t2546 * t1082 * t380 * t3663 - 0.18e2 * t5721 * t2551 * t1678 + 0.18e2 * t2546 * t7650 - 0.6e1 * t7653 * t7650 - 0.6e1 * t5721 * t7656 * t1678 - 0.12e2 * t7653 * t7660 * t6689 * t382 - 0.3e1 * t2546 * t4963 + 0.18e2 * t6758 * t7633 * t3232 - 0.18e2 * t7653 * t7649 * t3706 - 0.6e1 * t7675 * t2553 - 0.6e1 * t7678 * t7681 - 0.6e1 * t7675 * t7684 - 0.6e1 * t7678 * t4811 * t6734 + 0.6e1 * t7690 * t2553 + 0.6e1 * t1997 * t7681;
  t7699 = t389 * t1051;
  t7705 = t1136 * t298;
  t7727 = 0.3e1 * t1997 * t2551 * t5001 + 0.18e2 * t5760 * t7699 * t1678 - 0.3e1 * t2546 * t4958 + 0.18e2 * t6758 * t7705 * t3232 - t826 - t6811 - t6825 + t6830 + t6847 - t6849 - t6852 - t163 * t2005 * t263 * t405 - 0.2e1 * t163 * t741 * t633 * t405 - t163 * t298 * t1685 * t405 + t5859 * t879 + 0.2e1 * t1945 * t2201 + t736 * t6839 + t4868 * t733 + 0.2e1 * t1642 * t1923 + t642 * t5984;
  t7731 = my_piecewise5(t64, 0, t67, 0, t7396 + t7454 + t7512 + t7569 + t7618 + t7640 + t7695 + t7727);
  t7738 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t888 + t7341 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t2572 - t7348 + t7350 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (0.5e1 / 0.27e2 * t52 * t615 * t266 - 0.5e1 / 0.36e2 * t52 * t257 * t648 + t52 * t291 * t1690 / 0.24e2 + t1569 * t301 + 0.2e1 * t618 * t752 + t260 * t2010 + t373 * t886 + 0.2e1 * t161 * t2570 + t59 * t7731));
  tv4rho2sigmalapl0 = t7738 * t8 + 0.2e1 * t2577;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmalapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 1] += tv4rho2sigmalapl1;

  tv4rho2sigmalapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 2] += tv4rho2sigmalapl2;

  tv4rho2sigmalapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 3] += tv4rho2sigmalapl3;

  tv4rho2sigmalapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 4] += tv4rho2sigmalapl4;

  t7745 = t7 * t440 * t914;
  t7749 = t7 * t444 * t914 / 0.3e2;
  t7751 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t914 + t7745 / 0.5e1 - t7749);
  tv4rho2sigmalapl5 = t7751 * t8 + 0.2e1 * t2586;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 5] += tv4rho2sigmalapl5;

  t7757 = t7 * t465 * t888;
  t7765 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t888 + t7757 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t2572 + t7341 / 0.1e2 - t7348 + t7350 / 0.1e2);
  tv4rho2sigmalapl6 = t7765 * t8 + t2577 + t2592;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 6] += tv4rho2sigmalapl6;

  tv4rho2sigmalapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 7] += tv4rho2sigmalapl7;

  tv4rho2sigmalapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 8] += tv4rho2sigmalapl8;

  tv4rho2sigmalapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 9] += tv4rho2sigmalapl9;

  tv4rho2sigmalapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 10] += tv4rho2sigmalapl10;

  t7771 = t7 * t489 * t914;
  t7778 = t7 * t192 * t2696;
  t7781 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t914 + t7771 / 0.1e2 + t7745 / 0.1e2 - t7749 + 0.3e1 / 0.2e2 * t7 * t188 * t2696 + t7778 / 0.1e2);
  tv4rho2sigmalapl11 = t7781 * t8 + t2586 + t2701;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 11] += tv4rho2sigmalapl11;

  t7789 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t888 + t7757 / 0.5e1 - t7348);
  tv4rho2sigmalapl12 = t7789 * t8 + 0.2e1 * t2592;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 12] += tv4rho2sigmalapl12;

  tv4rho2sigmalapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 13] += tv4rho2sigmalapl13;

  tv4rho2sigmalapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 14] += tv4rho2sigmalapl14;

  tv4rho2sigmalapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 15] += tv4rho2sigmalapl15;

  tv4rho2sigmalapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 16] += tv4rho2sigmalapl16;

  t7830 = t1460 * t561;
  t7831 = t7830 * t4387;
  t7834 = t1429 * t2634;
  t7837 = t242 * t1051;
  t7841 = 0.18e2 * t1463 * t2661 * t4387 * t561 - 0.18e2 * t1864 * t2666 * t6307 - 0.6e1 * t1864 * t6307 * t7837 + 0.18e2 * t2661 * t7831 - 0.6e1 * t7831 * t7834 - 0.2e1 * t2610 - 0.2e1 * t2613 + 0.4e1 * t2636 + 0.4e1 * t2644 - 0.4e1 * t2664 + 0.4e1 * t2669 - 0.4e1 * t2673 + t6940 - t6941 + t6943 + t6945 - t6946 - t6947 - t903;
  t7842 = t560 * t2166;
  t7846 = t795 * t238 * t565;
  t7847 = t560 * t7846;
  t7848 = t5369 * t2667;
  t7853 = t573 * t1435;
  t7854 = t1429 * t7853;
  t7855 = t1521 * t315;
  t7859 = t1437 * t1439;
  t7867 = t570 * t1051;
  t7875 = t570 * t315;
  t7882 = t234 * t7846;
  t7889 = t6161 * t4491;
  t7890 = t1429 * t7889;
  t7891 = t3745 * t281;
  t7892 = t7891 * t561;
  t7893 = t1521 * t7892;
  t7896 = t560 * t7889;
  t7897 = t570 * t7892;
  t7900 = t7891 * t1809;
  t7903 = t4509 * t7889;
  t7905 = t234 * t7889;
  t7909 = -0.6e1 * t7842 * t7253 - 0.6e1 * t7847 * t7848 - 0.6e1 * t7842 * t7250 + 0.18e2 * t7854 * t7855 * t3339 - 0.12e2 * t7834 * t7859 * t6971 * t563 + 0.3e1 * t2167 * t2666 * t5535 + 0.18e2 * t6352 * t7867 * t1864 - 0.3e1 * t2661 * t5479 - 0.3e1 * t2661 * t5484 + 0.18e2 * t7854 * t7875 * t3339 - 0.18e2 * t7834 * t7830 * t4416 + 0.6e1 * t7882 * t2668 + 0.6e1 * t2167 * t7253 - 0.6e1 * t7847 * t2668 + 0.12e2 * t7890 * t7893 - 0.7e1 * t7896 * t7897 + 0.6e1 * t7890 * t7900 - t7903 * t7900 + t7905 * t7900 - 0.7e1 * t7896 * t7900;
  t7911 = t6971 * t2618;
  t7918 = t7104 * t4491;
  t7919 = t4509 * t7918;
  t7920 = t901 * params->csk_a;
  t7921 = t1521 * t7920;
  t7924 = t6157 * t1435;
  t7925 = t1429 * t7924;
  t7930 = t1429 * t7918;
  t7933 = t234 * t7924;
  t7936 = t560 * t7924;
  t7948 = t242 * t3300 * t561;
  t7952 = t560 * t901 * t4475;
  t7955 = t2626 * t561;
  t7969 = 0.3e1 * t2122 * t234 * t4475 * t899 - 0.6e1 * t1521 * t7890 * t7955 + 0.6e1 * t2617 * t6968 + 0.6e1 * t2617 * t7018 + 0.6e1 * t2619 * t7936 - 0.2e1 * t2622 * t7018 - 0.2e1 * t2625 * t7018 - 0.12e2 * t2635 * t7047 - 0.2e1 * t2653 * t7925 - 0.2e1 * t2653 * t7933 + 0.6e1 * t2653 * t7936 - 0.3e1 * t7201 * t7952 - 0.3e1 * t7204 * t7952 + 0.6e1 * t7890 * t7911 - 0.18e2 * t7896 * t7911 - 0.11e2 * t7896 * t7948 + 0.6e1 * t7905 * t7911 + 0.11e2 * t7905 * t7948 - 0.6e1 * t7919 * t7921 - 0.12e2 * t7921 * t7930;
  t7978 = t2648 * t695;
  t7979 = t1521 * t7978;
  t7994 = t795 * params->csk_a;
  t7995 = t7994 * t281;
  t7996 = t570 * t7995;
  t8001 = t570 * t7978;
  t8015 = t2648 * t580;
  t8019 = t2626 * t580;
  t8020 = t570 * t8019;
  t8023 = 0.18e2 * t7890 * t7897 - 0.7e1 * t7903 * t7897 - 0.12e2 * t7903 * t7893 - 0.4e1 * t7925 * t2628 + 0.6e1 * t5523 * t7979 - 0.4e1 * t2625 * t7005 - 0.6e1 * t7919 * t4514 * t7920 + 0.6e1 * t560 * t5562 * t2643 + 0.6e1 * t7936 * t2631 + 0.6e1 * t2617 * t6996 + 0.6e1 * t5523 * t7996 - 0.6e1 * t7925 * t2631 + 0.6e1 * t5523 * t8001 - 0.6e1 * t2625 * t6996 - 0.6e1 * t7854 * t1521 * t2634 - 0.6e1 * t7933 * t2619 - 0.6e1 * t2622 * t6968 + 0.3e1 * t2641 * t6330 + 0.3e1 * t2647 * t1521 * t8015 + 0.3e1 * t2617 * t8020;
  t8032 = t7243 * t2618;
  t8035 = t570 * t7920;
  t8049 = t315 * t1051;
  t8050 = t8049 * t281;
  t8057 = t2107 * t584;
  t8058 = t570 * t8057;
  t8061 = t2608 * t584;
  t8065 = t2611 * t584;
  t8069 = t1521 * t7995;
  t8072 = t5488 * t2618;
  t8083 = 0.3e1 * t2635 * t5546 - 0.18e2 * t560 * t7853 * t570 * t2634 + 0.3e1 * t2617 * t8032 - 0.18e2 * t7930 * t8035 - 0.3e1 * t2622 * t8032 + 0.7e1 * t560 * t7918 * t8035 - 0.11e2 * t7896 * t570 * t7955 - 0.2e1 * t2625 * t1521 * t8019 + 0.11e2 * t7919 * t4514 * t8050 - 0.6e1 * t7903 * t4514 * t7892 + 0.6e1 * t2641 * t8058 + 0.6e1 * t234 * t8061 * t2436 + 0.6e1 * t234 * t8065 * t2436 + 0.6e1 * t5523 * t8069 + 0.3e1 * t2617 * t8072 - t2625 * t8072 + 0.7e1 * t7919 * t570 * t8050 + 0.3e1 * t2647 * t570 * t8015 - t2622 * t8072;
  t8092 = t1437 * t5440 * t315;
  t8106 = t1445 * t2100 * t236;
  t8121 = t4476 * t7875;
  t8127 = -0.3e1 * t2625 * t8020 + 0.18e2 * t7919 * t1521 * t8050 - t6965 + t7014 - t7017 - t802 * t7097 - t4391 * t2690 - 0.2e1 * t2376 * t8092 - 0.2e1 * t2376 * t1437 * t1792 * t795 + t6269 * t899 + 0.2e1 * t2092 * t2381 + t790 * t7164 - 0.6e1 * t5328 * t2680 - 0.6e1 * t1816 * t8106 - 0.4e1 * t6225 * t2676 - 0.4e1 * t2115 * t7158 + 0.3e1 * t902 * t4476 * t1809 + 0.6e1 * t6162 * t5299 * t904 * t561 + 0.3e1 * t560 * t1858 * t8121 + 0.6e1 * t7311 * t4541 * t2689;
  t8149 = -0.2e1 * t2115 * t1783 * t904 * t580 + 0.11e2 * t7305 * t4561 * t786 * t281 - 0.3e1 * t1816 * t6257 + t7105 * t4552 * t5424 * t315 - t6249 * t899 - 0.2e1 * t2146 * t2381 - t802 * t7164 - t6249 * t909 - 0.2e1 * t2146 * t2417 - t7068 - t7074 + t7077 + t7092 - t7124 + t7126 - t7127 + t7131 + t7142 - t7181 + t7186;
  t8168 = -t7188 + t7198 - t7219 + t7227 - t852 - t7281 - t7291 + t7299 - t7302 + t7320 - t7322 + t5416 * t787 + 0.2e1 * t1842 * t2101 + t704 * t6429 - t234 * t2175 * t281 * t586 - 0.2e1 * t234 * t795 * t695 * t586 - t234 * t315 * t1879 * t586 + t6269 * t905 + 0.2e1 * t2092 * t2357 + t790 * t7296;
  t8172 = my_piecewise5(t114, 0, t115, 0, t7841 + t7909 + t7969 + t8023 + t8083 + t8127 + t8149 + t8168);
  t8179 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t914 + t7771 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t2696 - t7749 + t7778 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * (0.5e1 / 0.27e2 * t52 * t677 * t284 - 0.5e1 / 0.36e2 * t52 * t275 * t710 + t52 * t308 * t1884 / 0.24e2 + t1764 * t318 + 0.2e1 * t680 * t806 + t278 * t2180 + t554 * t912 + 0.2e1 * t232 * t2694 + t113 * t8172));
  tv4rho2sigmalapl17 = t8 * t8179 + 0.2e1 * t2701;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 17] += tv4rho2sigmalapl17;

  tv4rho2sigmatau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  tv4rho2sigmatau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 1] += tv4rho2sigmatau1;

  tv4rho2sigmatau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 2] += tv4rho2sigmatau2;

  tv4rho2sigmatau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 3] += tv4rho2sigmatau3;

  tv4rho2sigmatau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 4] += tv4rho2sigmatau4;

  tv4rho2sigmatau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 5] += tv4rho2sigmatau5;

  tv4rho2sigmatau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 6] += tv4rho2sigmatau6;

  tv4rho2sigmatau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 7] += tv4rho2sigmatau7;

  tv4rho2sigmatau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 8] += tv4rho2sigmatau8;

  tv4rho2sigmatau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 9] += tv4rho2sigmatau9;

  tv4rho2sigmatau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 10] += tv4rho2sigmatau10;

  tv4rho2sigmatau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 11] += tv4rho2sigmatau11;

  tv4rho2sigmatau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 12] += tv4rho2sigmatau12;

  tv4rho2sigmatau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 13] += tv4rho2sigmatau13;

  tv4rho2sigmatau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 14] += tv4rho2sigmatau14;

  tv4rho2sigmatau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 15] += tv4rho2sigmatau15;

  tv4rho2sigmatau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 16] += tv4rho2sigmatau16;

  tv4rho2sigmatau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 17] += tv4rho2sigmatau17;

  t8186 = t7 * t345 * t937;
  t8193 = t7 * t354 * t937 / 0.3e2;
  t8195 = t7 * t145 * t2789;
  t8216 = t2551 * t7492;
  t8227 = -0.12e2 * t4811 * t7492 * t7678 + 0.12e2 * t1997 * t8216 - 0.3e1 * t2739 * t6754 - 0.3e1 * t2739 * t6767 + 0.3e1 * t2744 * t3575 - 0.12e2 * t7678 * t8216 - 0.4e1 * t2727 - 0.4e1 * t2740 + 0.4e1 * t2745 - 0.4e1 * t2747 + t6475 - t6476 + t6478 + t6479 - t6480 - t6481;
  t8228 = t2531 * t741;
  t8234 = t2723 * t384;
  t8235 = t163 * t8234;
  t8244 = t1051 * t741 * t165;
  t8248 = t925 * t1044;
  t8249 = t1038 * t8248;
  t8252 = t389 * t8244;
  t8257 = t171 * t8244;
  t8268 = t171 * t7474 * t165;
  t8271 = t379 * t8248;
  t8276 = t2737 * t1044;
  t8277 = t163 * t8276;
  t8279 = t171 * t392 * params->csk_a;
  t8282 = t379 * t8276;
  t8285 = 0.12e2 * t171 * t4998 * t741 * t8235 + 0.18e2 * t1136 * t1674 * t8249 - 0.8e1 * t1136 * t2514 * t8244 + 0.12e2 * t1136 * t5006 * t8228 + 0.12e2 * t389 * t5006 * t8228 + 0.12e2 * t2502 * t8252 + 0.12e2 * t2502 * t8257 - 0.4e1 * t2507 * t8257 - 0.12e2 * t2507 * t8268 - 0.12e2 * t2514 * t8252 + 0.18e2 * t3581 * t8249 - 0.6e1 * t6691 * t8249 - 0.12e2 * t6702 * t8249 + 0.18e2 * t6751 * t8271 + 0.12e2 * t7493 * t7678 - 0.18e2 * t8277 * t8279 + 0.18e2 * t8279 * t8282;
  t8293 = t163 * t8248;
  t8300 = t388 * t380;
  t8305 = t922 * t3594;
  t8306 = t163 * t8305;
  t8309 = t379 * t8305;
  t8312 = t1038 * t8305;
  t8320 = t3618 * t922;
  t8322 = t3750 * t8320 * params->csk_a;
  t8326 = t394 * t395 * t2005;
  t8337 = -0.4e1 * t2514 * t8257 + 0.12e2 * t2502 * t8268 - 0.18e2 * t8249 * t6751 - 0.6e1 * t8293 * t6691 + 0.18e2 * t8271 * t6691 - 0.3e1 * t2720 * t3715 - 0.18e2 * t931 * t1045 * t8300 * t403 + 0.11e2 * t8306 * t6510 - 0.11e2 * t8309 * t6510 - 0.12e2 * t8312 * t3740 * t1062 * t380 * params->csk_a + 0.3e1 * t2749 * t3730 - 0.6e1 * t6565 * t8322 + 0.2e1 * t736 * t8326 + 0.3e1 * t2717 * t3702 + 0.3e1 * t2775 * t5027 - 0.8e1 * t1938 * t1050 * t639 * t741;
  t8345 = t1060 * t2734 * t403;
  t8349 = t1060 * t1926 * t741;
  t8360 = t3614 * t8305;
  t8374 = -0.4e1 * t2207 * t8349 + 0.3e1 * t2717 * t3652 + 0.3e1 * t2717 * t3715 - t2720 * t3652 - t2749 * t3652 - 0.3e1 * t2749 * t3702 + 0.3e1 * t2749 * t3720 + 0.3e1 * t2782 * t3693 + 0.7e1 * t6490 * t8360 - 0.12e2 * t6494 * t8360 + 0.18e2 * t6542 * t8360 + 0.7e1 * t6545 * t8309 + 0.18e2 * t6551 * t8312 - 0.7e1 * t6551 * t8360 - t6657 * t8360 - 0.6e1 * t6678 * t8345 - 0.2e1 * t748 * t8326;
  t8381 = t922 * t380;
  t8404 = t3750 * t8320 * t1051;
  t8414 = t3740 * t2734 * params->csk_a;
  t8417 = -0.2e1 * t2005 * t411 * t412 * t748 + 0.3e1 * t163 * t4799 * t8381 - 0.12e2 * t1961 * t7625 - 0.2e1 * t2749 * t6577 - 0.12e2 * t2775 * t6520 - 0.11e2 * t6490 * t8309 + 0.12e2 * t6494 * t8312 + 0.6e1 * t6524 * t8306 - 0.18e2 * t6524 * t8309 + 0.6e1 * t6524 * t8312 - 0.6e1 * t6542 * t8312 - 0.18e2 * t6545 * t8312 - 0.7e1 * t6551 * t8309 + 0.11e2 * t6565 * t8404 - 0.6e1 * t6565 * t8414 - 0.6e1 * t6585 * t8360;
  t8423 = t922 * t3589;
  t8424 = t379 * t8423;
  t8429 = -0.3e1 * t6516 * t8424 - 0.3e1 * t6539 * t8424 + t6657 * t8306 - 0.7e1 * t6657 * t8309 + 0.6e1 * t6657 * t8312 - t6535 + t6538 + t6575 - t6604 - t6607 + t6615 + t6618 - t6619 - t6621 + t6640 - t6667 + t6669;
  t8431 = t741 * t741;
  t8432 = t163 * t8431;
  t8442 = 0.2e1 * t379 * t390 * t8431 - 0.2e1 * t405 * t8432 + 0.2e1 * t407 * t8432 + 0.4e1 * t2776 + 0.4e1 * t2783 - t6670 + t6677 + t6686 - t6713 + t6723 - t6725 - t6811 - t6825 + t6830 + t6847 - t826 - t929;
  t8443 = t8431 * t382;
  t8444 = t379 * t8443;
  t8449 = t3740 * t2734;
  t8454 = t170 * t2005;
  t8469 = t3750 * t8320;
  t8476 = t163 * t8423;
  t8482 = -t6849 - t6852 - 0.2e1 * t8444 * t413 - 0.3e1 * t2717 * t3797 + 0.6e1 * t6498 * t8449 - 0.2e1 * t2720 * t6831 - 0.2e1 * t2724 * t2219 * t8454 + 0.2e1 * t163 * t8443 * t396 - 0.2e1 * t8444 * t396 + 0.2e1 * t736 * t394 * t8454 + 0.2e1 * t748 * t5984 - t3657 * t2735 + t6565 * t8469 + 0.3e1 * t379 * t8381 * t3602 + 0.6e1 * t8306 * t6817 + 0.3e1 * t8476 * t6813 + 0.11e2 * t8309 * t3773 * t8300;
  t8486 = my_piecewise5(t64, 0, t67, 0, t8227 + t8285 + t8337 + t8374 + t8417 + t8429 + t8442 + t8482);
  t8493 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t341 * t937 + t8186 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t140 * t2789 - t8193 + t8195 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t32 * (0.1e2 / 0.27e2 * t52 * t615 * t301 - 0.5e1 / 0.18e2 * t52 * t257 * t752 + t52 * t291 * t2010 / 0.12e2 + t373 * t935 + 0.2e1 * t161 * t2787 + t59 * t8486));
  tv4rho2lapl20 = t8 * t8493 + 0.2e1 * t2794;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 1] += tv4rho2lapl21;

  t8500 = t7 * t440 * t960;
  t8504 = t7 * t444 * t960 / 0.3e2;
  t8506 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t436 * t960 + t8500 / 0.5e1 - t8504);
  tv4rho2lapl22 = t8 * t8506 + 0.2e1 * t2803;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 2] += tv4rho2lapl22;

  t8512 = t7 * t465 * t937;
  t8520 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t461 * t937 + t8512 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t205 * t2789 + t8186 / 0.1e2 - t8193 + t8195 / 0.1e2);
  tv4rho2lapl23 = t8 * t8520 + t2794 + t2809;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 3] += tv4rho2lapl23;

  tv4rho2lapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 4] += tv4rho2lapl24;

  t8526 = t7 * t489 * t960;
  t8533 = t7 * t192 * t2894;
  t8536 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t485 * t960 + t8526 / 0.1e2 + t8500 / 0.1e2 - t8504 + 0.3e1 / 0.2e2 * t7 * t188 * t2894 + t8533 / 0.1e2);
  tv4rho2lapl25 = t8 * t8536 + t2803 + t2899;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 5] += tv4rho2lapl25;

  t8544 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t516 * t937 + t8512 / 0.5e1 - t8193);
  tv4rho2lapl26 = t8 * t8544 + 0.2e1 * t2809;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 6] += tv4rho2lapl26;

  tv4rho2lapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 7] += tv4rho2lapl27;

  t8571 = t2666 * t8057;
  t8579 = t5518 * t795;
  t8583 = t570 * t8579;
  t8586 = t2837 * t565;
  t8587 = t234 * t8586;
  t8592 = 0.12e2 * t242 * t5532 * t795 * t8587 - 0.8e1 * t1521 * t2625 * t8579 - 0.12e2 * t5369 * t7842 * t8057 + 0.12e2 * t2167 * t8571 + 0.12e2 * t2617 * t8583 - 0.12e2 * t7842 * t8571 - 0.4e1 * t2840 - 0.4e1 * t2845 + 0.4e1 * t2850 - 0.4e1 * t2852 + t6940 - t6941 + t6943 + t6945 - t6946 - t6947;
  t8599 = t2648 * t795;
  t8605 = t948 * t1435;
  t8606 = t1429 * t8605;
  t8616 = t2842 * t1435;
  t8617 = t234 * t8616;
  t8620 = t560 * t8616;
  t8623 = t1051 * t122;
  t8624 = t2821 * t236;
  t8625 = t8623 * t8624;
  t8633 = t242 * t7994 * t236;
  t8638 = t234 * t8605;
  t8641 = 0.12e2 * t1521 * t5523 * t8599 + 0.12e2 * t5523 * t570 * t8599 + 0.12e2 * t2617 * t8625 - 0.4e1 * t2622 * t8625 - 0.12e2 * t2622 * t8633 - 0.12e2 * t2625 * t8583 - 0.4e1 * t2625 * t8625 - 0.3e1 * t2844 * t4459 - 0.3e1 * t2844 * t7244 + 0.3e1 * t2849 * t4466 + 0.18e2 * t6963 * t8606 + 0.18e2 * t6977 * t8606 - 0.18e2 * t7024 * t8617 + 0.18e2 * t7024 * t8620 - 0.6e1 * t7232 * t8606 - 0.6e1 * t7232 * t8638 + 0.12e2 * t7842 * t8058;
  t8643 = t560 * t8605;
  t8655 = t1437 * t2834 * t584;
  t8660 = t945 * t4489;
  t8661 = t1429 * t8660;
  t8666 = t4513 * t945;
  t8668 = t4552 * t8666 * params->csk_a;
  t8672 = t575 * t576 * t2175;
  t8676 = t1437 * t2104 * t795;
  t8680 = -0.12e2 * t2131 * t8106 - 0.4e1 * t2376 * t8676 + 0.12e2 * t2617 * t8633 - t2859 * t4376 + 0.3e1 * t2859 * t4530 - 0.18e2 * t6957 * t8606 + 0.18e2 * t6957 * t8643 - 0.12e2 * t6973 * t8606 - 0.12e2 * t7055 * t8661 - 0.6e1 * t7105 * t8668 - 0.6e1 * t7169 * t8655 + 0.18e2 * t7232 * t8643 + 0.2e1 * t790 * t8672 - t6965 + t7014 - t7017;
  t8681 = t569 * t945;
  t8697 = t4509 * t8660;
  t8700 = t234 * t8660;
  t8703 = t560 * t8660;
  t8709 = t4552 * t8666 * t1051;
  t8725 = 0.7e1 * t1051 * t4561 * t7105 * t8681 - 0.18e2 * t1445 * t584 * t590 * t8681 - 0.8e1 * t1783 * t2115 * t8624 - t2826 * t4376 - 0.3e1 * t2826 * t4424 + 0.3e1 * t2829 * t4376 + 0.3e1 * t2829 * t4424 + 0.3e1 * t2829 * t4525 + 0.3e1 * t2859 * t4439 - 0.2e1 * t2859 * t7101 + 0.3e1 * t2887 * t5546 + 0.11e2 * t7043 * t8700 - 0.11e2 * t7043 * t8703 + 0.18e2 * t7069 * t8661 - 0.7e1 * t7069 * t8697 + 0.11e2 * t7105 * t8709 - 0.6e1 * t7112 * t8697;
  t8735 = t4541 * t2834 * t1051;
  t8746 = t945 * t561;
  t8763 = t4541 * t2834 * params->csk_a;
  t8768 = -0.2e1 * t2175 * t592 * t593 * t802 + 0.3e1 * t234 * t5306 * t8746 - 0.3e1 * t2859 * t4525 + 0.3e1 * t2866 * t4407 - 0.12e2 * t2887 * t7047 - 0.6e1 * t7051 * t8661 - 0.11e2 * t7059 * t8703 + 0.6e1 * t7081 * t8661 - 0.12e2 * t7087 * t8697 + 0.18e2 * t7105 * t8735 - 0.6e1 * t7105 * t8763 + 0.7e1 * t7133 * t8703 + 0.6e1 * t7212 * t8661 + 0.6e1 * t7212 * t8700 - 0.18e2 * t7212 * t8703 - 0.2e1 * t802 * t8672;
  t8779 = t945 * t4475;
  t8780 = t560 * t8779;
  t8785 = -0.7e1 * t7069 * t8703 - t7081 * t8697 + t7081 * t8700 - 0.7e1 * t7081 * t8703 + 0.12e2 * t7087 * t8661 - 0.18e2 * t7133 * t8661 - 0.3e1 * t7201 * t8780 - 0.3e1 * t7204 * t8780 - t7068 - t7074 + t7077 + t7092 - t7124 + t7126 - t7127 + t7131 + t7142;
  t8787 = t795 * t795;
  t8791 = t234 * t8787;
  t8798 = 0.2e1 * t560 * t571 * t8787 - 0.2e1 * t586 * t8791 + 0.2e1 * t588 * t8791 + 0.4e1 * t2867 + 0.4e1 * t2888 - t7181 + t7186 - t7188 + t7198 - t7219 + t7227 - t7281 - t7291 + t7299 - t7302 - t852 - t952;
  t8799 = t8787 * t563;
  t8800 = t560 * t8799;
  t8810 = t4561 * t8681;
  t8815 = t4541 * t2834;
  t8821 = t4552 * t8666;
  t8823 = t241 * t2175;
  t8833 = t234 * t8779;
  t8838 = t7320 - t7322 - 0.2e1 * t8800 * t577 - 0.2e1 * t8800 * t594 + 0.2e1 * t234 * t8799 * t577 - 0.2e1 * t2826 * t4577 + 0.11e2 * t7305 * t8810 - 0.3e1 * t2829 * t4580 + 0.6e1 * t7311 * t8815 + 0.2e1 * t802 * t6429 - t4391 * t2835 + t7105 * t8821 - 0.2e1 * t2838 * t2352 * t8823 + 0.2e1 * t790 * t575 * t8823 + 0.3e1 * t560 * t8746 * t4497 + 0.3e1 * t8833 * t7283 + 0.6e1 * t8700 * t7286;
  t8842 = my_piecewise5(t114, 0, t115, 0, t8592 + t8641 + t8680 + t8725 + t8768 + t8785 + t8798 + t8838);
  t8849 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t533 * t960 + t8526 / 0.5e1 + 0.3e1 / 0.1e2 * t7 * t216 * t2894 - t8504 + t8533 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t94 * (0.1e2 / 0.27e2 * t52 * t677 * t318 - 0.5e1 / 0.18e2 * t52 * t275 * t806 + t52 * t308 * t2180 / 0.12e2 + t554 * t958 + 0.2e1 * t232 * t2892 + t113 * t8842));
  tv4rho2lapl28 = t8 * t8849 + 0.2e1 * t2899;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 8] += tv4rho2lapl28;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2lapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 1] += tv4rho2lapltau1;

  tv4rho2lapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 2] += tv4rho2lapltau2;

  tv4rho2lapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 3] += tv4rho2lapltau3;

  tv4rho2lapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 4] += tv4rho2lapltau4;

  tv4rho2lapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 5] += tv4rho2lapltau5;

  tv4rho2lapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 6] += tv4rho2lapltau6;

  tv4rho2lapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 7] += tv4rho2lapltau7;

  tv4rho2lapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 8] += tv4rho2lapltau8;

  tv4rho2lapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 9] += tv4rho2lapltau9;

  tv4rho2lapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 10] += tv4rho2lapltau10;

  tv4rho2lapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 11] += tv4rho2lapltau11;

  tv4rho2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 0] += tv4rho2tau20;

  tv4rho2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 1] += tv4rho2tau21;

  tv4rho2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 2] += tv4rho2tau22;

  tv4rho2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 3] += tv4rho2tau23;

  tv4rho2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 4] += tv4rho2tau24;

  tv4rho2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 5] += tv4rho2tau25;

  tv4rho2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 6] += tv4rho2tau26;

  tv4rho2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 7] += tv4rho2tau27;

  tv4rho2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 8] += tv4rho2tau28;

  t8856 = t7 * t145 * t2971 / 0.1e2;
  t8862 = 0.6e1 * t2929;
  t8863 = t2913 + t2915 + t2919 + t2921 - t8862 + t2213 - t2216 - t2222 + t2225 + t2248 - t2250 - t2258 + t2263 + t2279;
  t8864 = t824 * t167;
  t8865 = t8864 * t384;
  t8866 = t379 * t8865;
  t8867 = t8866 * t7684;
  t8871 = t379 * t2927 * t403 * t2548;
  t8873 = t2214 * t403;
  t8875 = t1672 * t2551 * t8873;
  t8877 = t1051 * t824;
  t8878 = t8877 * t165;
  t8879 = t389 * t8878;
  t8880 = t4966 * t8879;
  t8883 = t171 * t2552;
  t8884 = t163 * t8865 * t8883;
  t8886 = t824 * params->csk_a;
  t8887 = t8886 * t263;
  t8889 = t5006 * t1136 * t8887;
  t8891 = t6532 * t1044;
  t8892 = t1038 * t8891;
  t8893 = t8892 * t2521;
  t8895 = t4956 * t633;
  t8896 = t389 * t8895;
  t8899 = t2903 * t382;
  t8900 = t8899 * t1044;
  t8901 = t1038 * t8900;
  t8912 = -0.12e2 * t1136 * t403 * t6726 * t8901 + 0.18e2 * t1136 * t2302 * t8901 - 0.18e2 * t2277 * t6744 * t8901 - 0.9e1 * t2295 * t8896 - t2298 + t2304 - t2308 - 0.9e1 * t8867 - 0.9e1 * t8871 + 0.9e1 * t8875 + 0.9e1 * t8880 + 0.9e1 * t8884 + 0.9e1 * t8889 - 0.6e1 * t8893;
  t8914 = t1051 * t74;
  t8915 = t8914 * t7680;
  t8918 = t4956 * t2265;
  t8922 = t171 * t3573 * t633;
  t8926 = t2524 * t389 * t8873;
  t8934 = t8892 * t2517;
  t8937 = t379 * t8891 * t2504;
  t8939 = t2916 * t1044;
  t8941 = t382 * params->csk_a;
  t8942 = t8941 * t165;
  t8943 = t171 * t8942;
  t8946 = t379 * t8939;
  t8949 = t8886 * t165;
  t8950 = t171 * t8949;
  t8951 = t5020 * t8950;
  t8954 = t2530 * t389 * t8949;
  t8956 = t8892 * t2541;
  t8958 = t389 * t2302;
  t8961 = -0.6e1 * t163 * t8900 * t8915 - 0.18e2 * t163 * t8939 * t8943 + 0.18e2 * t379 * t8900 * t8915 - 0.9e1 * t2295 * t8918 + 0.9e1 * t2301 * t8922 - 0.6e1 * t8901 * t8915 + 0.18e2 * t8901 * t8958 + 0.18e2 * t8943 * t8946 + 0.9e1 * t8926 - 0.9e1 * t8934 + 0.9e1 * t8937 - 0.9e1 * t8951 + 0.9e1 * t8954 - 0.3e1 * t8956;
  t8962 = t171 * t8878;
  t8963 = t5020 * t8962;
  t8965 = t4966 * t8962;
  t8967 = t1051 * t382;
  t8968 = t8967 * t165;
  t8969 = t389 * t8968;
  t8972 = t379 * t8899;
  t8973 = t1045 * t2277;
  t8977 = t1050 * t395 * t633;
  t8982 = t2903 * t165;
  t8986 = t2903 * t3594;
  t8987 = t1038 * t8986;
  t8988 = t3855 * t2244;
  t8991 = t2903 * t3589;
  t8992 = t379 * t8991;
  t8997 = t379 * t8986;
  t8998 = t3773 * t2254;
  t9001 = t163 * t8986;
  t9006 = t6533 * t2561;
  t9009 = t1050 * t3837 * t165;
  t9012 = 0.3e1 * t163 * t4799 * t8982 - 0.9e1 * t2227 * t8977 + 0.9e1 * t2231 * t8977 - 0.12e2 * t2917 * t9009 - 0.3e1 * t630 * t8992 - 0.3e1 * t645 * t8992 + 0.18e2 * t8946 * t8969 - 0.18e2 * t8972 * t8973 + 0.6e1 * t8987 * t8988 - 0.18e2 * t8988 * t8997 + 0.6e1 * t8988 * t9001 - 0.11e2 * t8997 * t8998 - 0.3e1 * t8963 + 0.9e1 * t8965 - 0.6e1 * t9006;
  t9015 = t3740 * t2287;
  t9018 = t3614 * t8986;
  t9020 = t3750 * t3751 * t165;
  t9023 = t1038 * t8899;
  t9024 = t1062 * t165;
  t9035 = t1603 * t2960;
  t9039 = t4917 * t1045 * t2211 * t263;
  t9041 = t2249 * t2272;
  t9044 = t394 * t1100 * t633;
  t9049 = t2207 * t1060 * t1589 * t824;
  t9054 = t1045 * t1068 * t633;
  t9060 = t1050 * t1052 * t633;
  t9063 = -0.6e1 * t1060 * t403 * t9023 * t9024 - 0.6e1 * t165 * t3750 * t3785 * t9018 - 0.3e1 * t2227 * t9060 + 0.9e1 * t2231 * t9054 + 0.9e1 * t2241 * t4873 + 0.9e1 * t2241 * t4937 + 0.9e1 * t2260 * t9044 + 0.9e1 * t2276 * t4859 - 0.6e1 * t8987 * t9015 - 0.6e1 * t9018 * t9020 + 0.3e1 * t9035 - 0.9e1 * t9039 - 0.3e1 * t9041 - 0.3e1 * t9049;
  t9068 = t2249 * t2266;
  t9071 = t3826 * t6655 * t165;
  t9078 = t3746 * t2516;
  t9082 = t3740 * t4819 * t165;
  t9085 = t3740 * t2281;
  t9088 = t3773 * t644;
  t9095 = t165 * t3594;
  t9096 = t3614 * t9095;
  t9099 = t3740 * t1062 * t2903 * t1051;
  t9102 = 0.9e1 * t2231 * t9060 - 0.9e1 * t2241 * t9054 - 0.3e1 * t2241 * t9060 + 0.6e1 * t8987 * t9071 + 0.18e2 * t8987 * t9078 + 0.12e2 * t8987 * t9082 - 0.18e2 * t8987 * t9088 - 0.7e1 * t8997 * t9071 - 0.7e1 * t8997 * t9078 + t9001 * t9071 - t9018 * t9071 - 0.6e1 * t9018 * t9085 + 0.18e2 * t9096 * t9099 - 0.3e1 * t9068;
  t9107 = t1060 * t1078 * t633;
  t9110 = t3618 * t2903;
  t9123 = t3826 * t629;
  t9128 = 0.11e2 * t1051 * t3750 * t9096 * t9110 - 0.6e1 * t2241 * t9107 - 0.12e2 * t8987 * t9085 + 0.7e1 * t8997 * t9088 - 0.11e2 * t8997 * t9123 + 0.7e1 * t8998 * t9018 + 0.11e2 * t9001 * t9123 - 0.7e1 * t9018 * t9078 - 0.12e2 * t9018 * t9082 - t2952 - t2955 + t2958 + t2962 - t2964;
  t9141 = t3826 * t639;
  t9150 = t2224 * t2201;
  t9152 = t1050 * t2200;
  t9155 = t1642 * t2212;
  t9159 = t163 * t824 * t633 * t405;
  t9161 = 0.3e1 * t163 * t640 * t8991 + 0.11e2 * t2232 * t3773 * t8997 + 0.3e1 * t3602 * t379 * t8982 + 0.6e1 * t3740 * t8987 * t9024 + t3750 * t9096 * t9110 - 0.6e1 * t2227 * t9152 - 0.9e1 * t2231 * t5103 - 0.3e1 * t2241 * t5072 + 0.6e1 * t9001 * t9141 - t2966 - t826 - t828 + 0.3e1 * t9150 + 0.3e1 * t9155 - 0.3e1 * t9159;
  t9165 = my_piecewise5(t64, 0, t67, 0, t8863 + t8912 + t8961 + t9012 + t9063 + t9102 + t9128 + t9161);
  t9172 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t2971 + t8856 + 0.3e1 / 0.2e2 * t7 * t32 * (t161 * t2969 + 0.3e1 * t2312 * t260 + t59 * t9165 + 0.3e1 * t618 * t834));
  tv4rhosigma30 = t8 * t9172 + t2975;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 8] += tv4rhosigma38;

  t9179 = t7 * t192 * t3046 / 0.1e2;
  t9181 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t3046 + t9179);
  tv4rhosigma39 = t8 * t9181 + t3050;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 9] += tv4rhosigma39;

  t9187 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t2971 + t8856);
  tv4rhosigma310 = t8 * t9187 + t2975;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 18] += tv4rhosigma318;

  t9197 = 0.6e1 * t2997;
  t9198 = t2989 - t9197 + t3002 + t3004 + t3008 + t2346 - t2349 - t2356 + t2362 + t2388 + t2401 - t2404 - t2432 + t2437;
  t9199 = t2347 * t584;
  t9201 = t2641 * t570 * t9199;
  t9203 = t850 * params->csk_a;
  t9204 = t9203 * t236;
  t9206 = t2647 * t1521 * t9204;
  t9208 = t2978 * t563;
  t9209 = t9208 * t1435;
  t9210 = t1429 * t9209;
  t9214 = t2995 * t584;
  t9215 = t234 * t9214;
  t9216 = t9215 * t2436;
  t9219 = t242 * t4464 * t695;
  t9222 = t560 * t9209;
  t9223 = t1051 * t584;
  t9224 = t9223 * t236;
  t9225 = t570 * t9224;
  t9228 = t9215 * t2663;
  t9230 = t560 * t9214;
  t9231 = t9230 * t2663;
  t9233 = t9230 * t2672;
  t9236 = t8623 * t701 * t584;
  t9239 = t4457 * t2380;
  t9242 = 0.18e2 * t1521 * t2447 * t9210 - 0.9e1 * t2440 * t9239 + 0.9e1 * t2446 * t9219 - 0.6e1 * t9210 * t9236 + 0.18e2 * t9222 * t9225 - t2443 + t2449 - t2453 + 0.9e1 * t9201 + 0.9e1 * t9206 + 0.9e1 * t9216 + 0.9e1 * t9228 - 0.9e1 * t9231 - 0.9e1 * t9233;
  t9244 = t4457 * t695;
  t9245 = t570 * t9244;
  t9248 = t1051 * t850;
  t9249 = t9248 * t236;
  t9250 = t570 * t9249;
  t9251 = t5487 * t9250;
  t9253 = t7065 * t1435;
  t9254 = t1429 * t9253;
  t9255 = t9254 * t2628;
  t9259 = t1521 * t9224;
  t9263 = t560 * t9253 * t2619;
  t9267 = t2441 * t4387;
  t9270 = t234 * t9209;
  t9273 = t242 * t9204;
  t9274 = t5556 * t9273;
  t9276 = t9254 * t2653;
  t9281 = t2647 * t570 * t9204;
  t9283 = t570 * t2447;
  t9286 = t242 * t9249;
  t9287 = t5556 * t9286;
  t9289 = 0.18e2 * t1435 * t3005 * t560 * t9267 - 0.9e1 * t2440 * t9245 - 0.18e2 * t2448 * t9270 - 0.18e2 * t9210 * t9225 - 0.12e2 * t9210 * t9259 + 0.18e2 * t9210 * t9283 + 0.18e2 * t9222 * t9236 + 0.9e1 * t9251 - 0.6e1 * t9255 + 0.9e1 * t9263 - 0.9e1 * t9274 - 0.3e1 * t9276 + 0.9e1 * t9281 - 0.3e1 * t9287;
  t9290 = t5487 * t9286;
  t9294 = t9254 * t2631;
  t9296 = t236 * t4489;
  t9297 = t560 * t9296;
  t9303 = t2978 * t4489;
  t9304 = t560 * t9303;
  t9306 = t4561 * t1446 * t236;
  t9309 = t570 * t695;
  t9310 = t1460 * t9309;
  t9313 = t4509 * t9296;
  t9316 = t4541 * t1439 * t2978 * t1051;
  t9319 = t4509 * t9303;
  t9320 = t1521 * t236;
  t9321 = t4648 * t9320;
  t9324 = t4629 * t2406;
  t9327 = t1460 * t2380;
  t9330 = t1463 * t2380;
  t9337 = t2403 * t2417;
  t9340 = t575 * t1482 * t695;
  t9343 = 0.7e1 * t2978 * t4561 * t569 * t9297 * params->csk_a - 0.3e1 * t2364 * t9327 + 0.9e1 * t2368 * t9327 + 0.9e1 * t2368 * t9330 - 0.9e1 * t2390 * t9310 - 0.3e1 * t2390 * t9327 + 0.9e1 * t2434 * t9340 - 0.6e1 * t9236 * t9270 - 0.11e2 * t9304 * t9306 - 0.11e2 * t9304 * t9324 + 0.18e2 * t9313 * t9316 - 0.12e2 * t9319 * t9321 + 0.9e1 * t9290 - 0.9e1 * t9294 - 0.3e1 * t9337;
  t9350 = t1773 * t3039;
  t9352 = t4513 * t2978;
  t9359 = t1429 * t9208;
  t9360 = t1439 * t236;
  t9366 = t1437 * t1456 * t695;
  t9374 = t4552 * t4553 * t236;
  t9379 = t2376 * t1437 * t1792 * t850;
  t9385 = t2978 * t4475;
  t9386 = t560 * t9385;
  t9389 = t1429 * t9303;
  t9390 = t4642 * t2406;
  t9393 = 0.11e2 * t1051 * t4552 * t9313 * t9352 - 0.6e1 * t1437 * t584 * t9359 * t9360 - 0.6e1 * t4552 * t9313 * t9352 * params->csk_a - 0.9e1 * t2364 * t9330 + 0.9e1 * t2368 * t9310 + 0.9e1 * t2385 * t5358 + 0.9e1 * t2390 * t5421 + 0.9e1 * t2390 * t5442 - 0.6e1 * t2390 * t9366 - 0.3e1 * t692 * t9386 - 0.6e1 * t9319 * t9374 + 0.6e1 * t9389 * t9390 + 0.3e1 * t9350 - 0.3e1 * t9379;
  t9394 = t241 * t563;
  t9396 = t1783 * t9394 * t236;
  t9401 = t7072 * t2676;
  t9403 = t4541 * t2420;
  t9408 = t1816 * t1445 * t2344 * t236;
  t9410 = t4541 * t2424;
  t9413 = t560 * t9208;
  t9417 = t2978 * t236;
  t9421 = t234 * t9303;
  t9424 = t2403 * t2381;
  t9427 = t4561 * t4562 * t236;
  t9432 = t4561 * t706;
  t9435 = t241 * t3745;
  t9437 = t5299 * t9435 * t236;
  t9439 = -0.18e2 * t1445 * t2386 * t9413 + 0.3e1 * t234 * t5306 * t9417 - 0.12e2 * t3006 * t9396 - 0.3e1 * t707 * t9386 - 0.7e1 * t9304 * t9427 - 0.6e1 * t9319 * t9410 + 0.11e2 * t9324 * t9421 - 0.6e1 * t9389 * t9403 - 0.12e2 * t9389 * t9410 - 0.18e2 * t9389 * t9432 + t9421 * t9437 - 0.6e1 * t9401 - 0.9e1 * t9408 - 0.3e1 * t9424;
  t9458 = t2361 * t2357;
  t9460 = t1783 * t2353;
  t9466 = t5299 * t701;
  t9472 = 0.3e1 * t234 * t702 * t9385 + 0.3e1 * t4497 * t560 * t9417 - 0.6e1 * t2364 * t9460 - 0.18e2 * t9304 * t9390 - 0.7e1 * t9304 * t9437 + 0.7e1 * t9306 * t9319 - 0.7e1 * t9319 * t9427 - t9319 * t9437 + 0.12e2 * t9321 * t9389 + 0.18e2 * t9389 * t9427 + 0.6e1 * t9389 * t9437 + 0.6e1 * t9390 * t9421 + 0.6e1 * t9421 * t9466 + 0.3e1 * t9458;
  t9479 = t1842 * t2345;
  t9483 = t234 * t850 * t695 * t586;
  t9491 = 0.11e2 * t2369 * t4561 * t9304 + 0.6e1 * t4541 * t9360 * t9389 + t4552 * t9313 * t9352 - 0.9e1 * t2368 * t5638 - 0.3e1 * t2390 * t5619 - t3027 - t3030 - t3032 - t3034 + t3037 + t3041 - t852 - t854 + 0.3e1 * t9479 - 0.3e1 * t9483;
  t9495 = my_piecewise5(t114, 0, t115, 0, t9198 + t9242 + t9289 + t9343 + t9393 + t9439 + t9472 + t9491);
  t9502 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t3046 + t9179 + 0.3e1 / 0.2e2 * t7 * t94 * (t113 * t9495 + t232 * t3044 + 0.3e1 * t2457 * t278 + 0.3e1 * t680 * t860));
  tv4rhosigma319 = t8 * t9502 + t3050;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 19] += tv4rhosigma319;

  t9509 = t7 * t145 * t3129 / 0.1e2;
  t9522 = t3056 - t3229 + t3069 + t3070 + t3071 - 0.4e1 * t2929 - t2485 - t2488 + t2213 - t2216 + t2225 - t877 + t2248 - t2250 - t2258 - t3077 + t3082 - t3084 + t2512 + t2527;
  t9530 = t1051 * t817;
  t9531 = t9530 * t165;
  t9536 = t1038 * t622 * t1044;
  t9540 = t6487 * t3596;
  t9541 = t1038 * t9540;
  t9546 = t3745 * t817;
  t9554 = t3614 * t9095 * t3596;
  t9555 = t7449 * t817;
  t9560 = t9546 * t1136 * t165;
  t9564 = t2514 * t1136 * t8878;
  t9566 = t8892 * t2533;
  t9568 = t3614 * t9540;
  t9572 = t2514 * t8879;
  t9574 = t2515 * t6784;
  t9577 = t741 * t817;
  t9579 = t379 * t9577 * t403;
  t9583 = t1997 * t171 * t8873;
  t9585 = t8866 * t2526;
  t9591 = t379 * t3073 * t3589;
  t9594 = 0.6e1 * t1997 * t2551 * t2217 * t633 - 0.6e1 * t2546 * t4961 * t2265 - 0.6e1 * t7376 * t1136 * t9531 - 0.6e1 * t9536 * t1136 * t3074 - 0.12e2 * t9541 * t2533 + 0.6e1 * t2511 * t9044 - 0.6e1 * t7413 * t3619 * t9546 * t165 + 0.6e1 * t2530 * t7504 + 0.18e2 * t9554 * t1136 * t9555 - 0.12e2 * t7413 * t9560 - 0.2e1 * t9564 + 0.3e1 * t9566 - 0.6e1 * t9568 * t3619 * t2532 - 0.3e1 * t9572 - 0.6e1 * t2514 * t9574 - 0.3e1 * t9579 * t1131 + 0.3e1 * t9583 + 0.3e1 * t9585 + 0.6e1 * t2524 * t389 * t7500 - 0.3e1 * t9591 * t630;
  t9598 = t395 * t817;
  t9599 = t394 * t9598;
  t9605 = t2515 * t633;
  t9606 = t171 * t9605;
  t9623 = t171 * t3231 * t633;
  t9636 = t9546 * t2516;
  t9643 = t171 * t3078 * t165;
  t9648 = t2507 * t8950;
  t9650 = t2502 * t8950;
  t9652 = 0.3e1 * t163 * t744 * t3589 * t9599 - 0.11e2 * t7385 * t389 * t9531 - 0.2e1 * t2507 * t9606 + 0.6e1 * t2502 * t9606 - 0.2e1 * t2514 * t9606 + 0.7e1 * t9554 * t389 * t9555 + 0.6e1 * t2530 * t7469 - 0.3e1 * t9579 * t1115 + 0.3e1 * t7690 * t3080 - 0.6e1 * t2507 * t9623 + 0.6e1 * t2502 * t9574 + 0.6e1 * t2502 * t9623 - 0.4e1 * t2514 * t1136 * t9605 + 0.11e2 * t9554 * t3619 * t9555 - 0.7e1 * t7413 * t9636 + 0.7e1 * t379 * t9540 * t2538 + 0.11e2 * t7393 * t9643 - 0.11e2 * t7385 * t9643 - 0.3e1 * t9648 + 0.3e1 * t9650;
  t9655 = t9530 * t2244;
  t9662 = t9546 * t2244;
  t9671 = t8892 * t2538;
  t9676 = t2502 * t8962;
  t9678 = t2514 * t8962;
  t9681 = t2502 * t8879;
  t9683 = t163 * t3074;
  t9692 = t2507 * t8962;
  t9694 = t1623 * t382 * t2244;
  t9697 = -0.18e2 * t2526 * t6694 - 0.6e1 * t2533 * t9568 + 0.18e2 * t3075 * t9694 - 0.3e1 * t645 * t9591 + 0.12e2 * t7376 * t9560 + 0.18e2 * t7376 * t9636 - 0.12e2 * t9009 * t9683 + 0.3e1 * t9676 - t9678 + 0.3e1 * t9681 - t9692;
  t9701 = t1038 * t3074;
  t9712 = t1045 * t388 * t8968;
  t9715 = t3058 * t403;
  t9716 = t163 * t9715;
  t9717 = t9716 * t2548;
  t9719 = t379 * t9715;
  t9720 = t9719 * t2548;
  t9723 = t1050 * t170 * t8942;
  t9737 = t9719 * t2557;
  t9745 = -0.6e1 * t165 * t2259 * t5721 * t7656 + 0.18e2 * t2302 * t6697 * t7633 + 0.18e2 * t2302 * t6697 * t7705 - 0.6e1 * t2546 * t2556 * t8895 - 0.12e2 * t7660 * t8968 * t9701 + 0.18e2 * t3075 * t9712 + 0.18e2 * t3075 * t9723 - 0.18e2 * t9683 * t9723 - 0.6e1 * t9694 * t9701 - 0.18e2 * t9701 * t9712 - t2549 + t2554 - t2558 - 0.6e1 * t8867 - 0.6e1 * t8871 + 0.6e1 * t8875 + 0.6e1 * t8880 + 0.3e1 * t9717 - 0.3e1 * t9720 - 0.3e1 * t9737;
  t9762 = t1038 * t9095;
  t9780 = t1982 * t3086;
  t9781 = -0.6e1 * t1045 * t1617 * t633 * t732 + 0.6e1 * t2208 * t298 * t3740 * t9762 + 0.3e1 * t163 * t1661 * t9577 + 0.3e1 * t2241 * t5824 + 0.3e1 * t3102 * t5833 - 0.3e1 * t3102 * t5881 - t3107 * t5781 + 0.3e1 * t3107 * t5833 - t3107 * t5881 + 0.6e1 * t8965 - t9780;
  t9788 = t1945 * t2960;
  t9794 = t1982 * t2960;
  t9802 = t1045 * t732 * t824;
  t9803 = t4917 * t9802;
  t9806 = t1060 * t6571 * t298;
  t9807 = t2207 * t9806;
  t9821 = t1938 * t1050 * t3067 * t165;
  t9833 = -0.2e1 * t5781 * t3089 + 0.3e1 * t2241 * t5846 + t9788 + 0.3e1 * t5833 * t3097 + t9096 * t3750 * t6566 * t298 - t9794 - 0.3e1 * t5781 * t3097 - 0.4e1 * t1938 * t1050 * t878 * t633 - 0.3e1 * t9803 - t9807 - 0.2e1 * t1620 * t7611 + 0.3e1 * t2276 * t5895 + 0.3e1 * t3116 * t3590 * t2244 + 0.6e1 * t5785 * t3826 * t3063 * t165 - 0.2e1 * t9821 + 0.3e1 * t379 * t817 * t165 * t7634 + 0.11e2 * t6523 * t3773 * t2564 - 0.4e1 * t9006 + 0.2e1 * t9035 - 0.6e1 * t9039;
  t9841 = t1945 * t3068;
  t9842 = t2249 * t1923;
  t9846 = t163 * t741 * t824 * t405;
  t9851 = t3095 + t3115 + t3118 - t3119 - t3122 + t3123 - t3124 - t826 + 0.2e1 * t9150 + 0.2e1 * t9155 - 0.2e1 * t9159;
  t9856 = my_piecewise5(t64, 0, t67, 0, -0.7e1 * t7385 * t9636 - 0.18e2 * t7385 * t9655 + 0.6e1 * t7376 * t9655 + 0.6e1 * t7393 * t9655 - 0.7e1 * t7385 * t9662 + 0.6e1 * t7376 * t9662 - t7413 * t9662 - 0.3e1 * t2231 * t5953 - 0.2e1 * t5881 * t3064 - t2241 * t5987 + t7393 * t9662 - 0.18e2 * t9541 * t2538 + t9851 - t9846 + t9841 + t9842 + t9833 + t9781 + t9745 + t9697 + 0.3e1 * t9671 + t9652 + t9594 + t9522 - t3087 - 0.2e1 * t9068 - 0.2e1 * t9049 - 0.2e1 * t9041 - 0.2e1 * t8963 - 0.2e1 * t8956 - 0.6e1 * t8951 + 0.6e1 * t8954 + 0.6e1 * t8937 - 0.6e1 * t8934 + 0.6e1 * t8926 - 0.4e1 * t8893 + 0.6e1 * t8889 + 0.6e1 * t8884);
  t9863 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t3129 + t9509 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.5e1 / 0.72e2 * t52 * t257 * t834 + t52 * t291 * t2312 / 0.24e2 + 0.2e1 * t618 * t886 + 0.2e1 * t260 * t2570 + t161 * t3127 + t59 * t9856));
  tv4rhosigma2lapl0 = t8 * t9863 + t3133;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2lapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 1] += tv4rhosigma2lapl1;

  tv4rhosigma2lapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 2] += tv4rhosigma2lapl2;

  tv4rhosigma2lapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 3] += tv4rhosigma2lapl3;

  tv4rhosigma2lapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 4] += tv4rhosigma2lapl4;

  tv4rhosigma2lapl5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 5] += tv4rhosigma2lapl5;

  tv4rhosigma2lapl6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 6] += tv4rhosigma2lapl6;

  tv4rhosigma2lapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 7] += tv4rhosigma2lapl7;

  tv4rhosigma2lapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 8] += tv4rhosigma2lapl8;

  tv4rhosigma2lapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 9] += tv4rhosigma2lapl9;

  tv4rhosigma2lapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 10] += tv4rhosigma2lapl10;

  t9870 = t7 * t192 * t3213 / 0.1e2;
  t9872 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t3213 + t9870);
  tv4rhosigma2lapl11 = t8 * t9872 + t3217;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 11] += tv4rhosigma2lapl11;

  t9878 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t3129 + t9509);
  tv4rhosigma2lapl12 = t8 * t9878 + t3133;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 12] += tv4rhosigma2lapl12;

  tv4rhosigma2lapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 13] += tv4rhosigma2lapl13;

  tv4rhosigma2lapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 14] += tv4rhosigma2lapl14;

  tv4rhosigma2lapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 15] += tv4rhosigma2lapl15;

  tv4rhosigma2lapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 16] += tv4rhosigma2lapl16;

  tv4rhosigma2lapl17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 17] += tv4rhosigma2lapl17;

  tv4rhosigma2lapl18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 18] += tv4rhosigma2lapl18;

  tv4rhosigma2lapl19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 19] += tv4rhosigma2lapl19;

  tv4rhosigma2lapl20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 20] += tv4rhosigma2lapl20;

  tv4rhosigma2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 21] += tv4rhosigma2lapl21;

  tv4rhosigma2lapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 22] += tv4rhosigma2lapl22;

  t9895 = t3147 + t3148 - t3299 + t3153 - 0.4e1 * t2997 + t3155 + t2346 - t2349 - t2610 - t2613 + t2362 - t903 + t2401 - t2404 - t2432 - t3160 + t3165 - t3167 + t2636 + t2644;
  t9906 = t1429 * t3157;
  t9907 = t1051 * t563;
  t9908 = t9907 * t236;
  t9912 = t3150 * t584;
  t9913 = t560 * t9912;
  t9914 = t9913 * t2672;
  t9920 = t1460 * t563 * t2406;
  t9930 = t1445 * t569 * t9908;
  t9936 = t234 * t9912;
  t9937 = t9936 * t2663;
  t9939 = t9913 * t2663;
  t9943 = t234 * t3157;
  t9945 = t563 * params->csk_a;
  t9946 = t9945 * t236;
  t9947 = t1783 * t241 * t9946;
  t9954 = t575 * t3168;
  t9957 = t1051 * t843;
  t9958 = t9957 * t236;
  t9963 = t560 * t3156 * t4475;
  t9969 = -0.6e1 * t2661 * t5482 * t2380 + 0.6e1 * t2167 * t2666 * t2350 * t695 - 0.6e1 * t2661 * t2671 * t9244 - 0.12e2 * t9906 * t7859 * t9908 - 0.3e1 * t9914 + 0.18e2 * t6953 * t7855 * t2447 + 0.18e2 * t3158 * t9920 - 0.6e1 * t9906 * t9920 - 0.6e1 * t6307 * t7837 * t2433 * t236 + 0.18e2 * t3158 * t9930 + 0.18e2 * t6953 * t7875 * t2447 + 0.3e1 * t9937 - 0.3e1 * t9939 - 0.18e2 * t9906 * t9930 - 0.18e2 * t9943 * t9947 + 0.18e2 * t3158 * t9947 + 0.3e1 * t234 * t798 * t4475 * t9954 - 0.11e2 * t7896 * t570 * t9958 - 0.3e1 * t9963 * t692 - 0.6e1 * t7890 * t1521 * t9958;
  t9977 = t7041 * t4491;
  t9978 = t4509 * t9977;
  t9983 = t3745 * t843;
  t9984 = t9983 * t2412;
  t9991 = t242 * t3161 * t236;
  t9996 = t2622 * t9273;
  t9998 = t2617 * t9273;
  t10000 = t2626 * t9309;
  t10004 = t4509 * t9296 * t4491;
  t10005 = t8049 * t843;
  t10009 = t9983 * t9320;
  t10012 = t795 * t843;
  t10014 = t560 * t10012 * t584;
  t10018 = t2167 * t242 * t9199;
  t10020 = t6962 * t2643;
  t10022 = t9254 * t2650;
  t10025 = t1429 * t684 * t1435;
  t10029 = t1429 * t9977;
  t10034 = -0.3e1 * t9963 * t707 - 0.18e2 * t6982 * t2643 - 0.12e2 * t9943 * t9396 + 0.7e1 * t9978 * t570 * t8049 * t236 - 0.7e1 * t7903 * t9984 + 0.7e1 * t560 * t9977 * t2655 + 0.11e2 * t7905 * t9991 - 0.11e2 * t7896 * t9991 - 0.3e1 * t9996 + 0.3e1 * t9998 - 0.6e1 * t2625 * t10000 + 0.18e2 * t10004 * t1521 * t10005 - 0.12e2 * t7903 * t10009 - 0.3e1 * t10014 * t1509 + 0.3e1 * t10018 + 0.3e1 * t10020 + 0.3e1 * t10022 - 0.6e1 * t10025 * t1521 * t3157 - 0.12e2 * t10029 * t2650 + 0.6e1 * t2635 * t9340;
  t10038 = t2626 * t2380;
  t10045 = t242 * t6999;
  t10060 = t2625 * t1521 * t9249;
  t10078 = t2625 * t9250;
  t10081 = t242 * t843;
  t10082 = t3745 * t236 * t10081;
  t10090 = -0.4e1 * t1521 * t2625 * t2626 * t695 - 0.6e1 * t236 * t4514 * t7903 * t9983 + 0.11e2 * t10004 * t10005 * t4514 - 0.6e1 * t2649 * t4514 * t9978 - 0.18e2 * t10029 * t2655 + 0.6e1 * t10082 * t7890 - 0.7e1 * t10082 * t7896 - t10082 * t7903 + 0.6e1 * t2647 * t7979 - 0.2e1 * t10060 - 0.3e1 * t10078;
  t10094 = t9254 * t2655;
  t10098 = t2617 * t9286;
  t10100 = t2625 * t9286;
  t10103 = t2617 * t9250;
  t10107 = t2622 * t9286;
  t10110 = t9957 * t2406;
  t10124 = 0.12e2 * t10009 * t7890 + t10082 * t7905 + 0.6e1 * t10110 * t7890 - 0.18e2 * t10110 * t7896 + 0.6e1 * t10110 * t7905 - 0.6e1 * t2650 * t9978 + 0.18e2 * t7890 * t9984 - 0.7e1 * t7896 * t9984 + 0.3e1 * t10094 + 0.3e1 * t10098 - t10100 + 0.3e1 * t10103 - t10107 - t2664 + 0.6e1 * t9201 + 0.6e1 * t9206 + 0.6e1 * t9216 + 0.6e1 * t9228 - 0.6e1 * t9231 - 0.6e1 * t9233;
  t10135 = t1429 * t9296;
  t10159 = t2092 * t3039;
  t10160 = 0.6e1 * t10135 * t2377 * t315 * t4541 - 0.6e1 * t1445 * t1816 * t695 * t786 - 0.4e1 * t1783 * t2115 * t695 * t904 + 0.3e1 * t10012 * t1861 * t234 + 0.3e1 * t2385 * t6371 + 0.3e1 * t2390 * t6266 - t3175 * t6158 + 0.3e1 * t3175 * t6211 - t3175 * t6225 + t10159 - 0.6e1 * t9294;
  t10171 = t2146 * t3039;
  t10174 = t2146 * t3191;
  t10178 = t1445 * t786 * t850;
  t10179 = t5395 * t10178;
  t10182 = t1437 * t7182 * t315;
  t10183 = t2376 * t10182;
  t10195 = t2115 * t1783 * t3145 * t236;
  t10210 = 0.3e1 * t6211 * t3187 + 0.3e1 * t6211 * t3169 - 0.3e1 * t6225 * t3169 + 0.3e1 * t2390 * t6200 - t10171 - 0.3e1 * t6158 * t3187 - t10174 - 0.2e1 * t6158 * t3194 - 0.3e1 * t10179 - t10183 - 0.2e1 * t1807 * t8092 + t9313 * t4552 * t7106 * t315 + 0.6e1 * t6162 * t5299 * t3141 * t236 - 0.2e1 * t10195 + 0.3e1 * t560 * t843 * t236 * t8121 + 0.11e2 * t7042 * t4561 * t2679 + 0.3e1 * t3181 * t4476 * t2406 - 0.2e1 * t9337 + 0.2e1 * t9350 - 0.2e1 * t9379;
  t10218 = t2092 * t3146;
  t10219 = t2403 * t2101;
  t10223 = t234 * t795 * t850 * t586;
  t10228 = t3183 - t3184 - t3192 + t3199 + t3205 - t3206 - t3207 + t3208 - t852 + 0.2e1 * t9479 - 0.2e1 * t9483;
  t10233 = my_piecewise5(t114, 0, t115, 0, -0.2e1 * t6225 * t3142 - t2390 * t6432 - 0.6e1 * t2622 * t10045 + 0.6e1 * t2647 * t8001 - 0.3e1 * t10014 * t1500 + 0.6e1 * t2617 * t10045 + 0.3e1 * t7882 * t3163 + 0.6e1 * t2617 * t10000 - 0.2e1 * t2625 * t10038 - 0.2e1 * t2622 * t10038 + 0.6e1 * t2617 * t10038 - 0.3e1 * t2368 * t6401 + t9895 + 0.2e1 * t9458 - 0.2e1 * t9424 - 0.6e1 * t9408 - 0.4e1 * t9401 + 0.6e1 * t9290 - 0.2e1 * t9287 + 0.6e1 * t9281 - 0.2e1 * t9276 - 0.6e1 * t9274 + 0.6e1 * t9263 - 0.4e1 * t9255 + 0.6e1 * t9251 - t2673 + t2669 + t10228 - t10223 + t10218 + t10219 + t10210 + t10160 + t10124 + t10090 + t10034 + 0.6e1 * t2641 * t570 * t8065 + t9969);
  t10240 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t3213 + t9870 + 0.3e1 / 0.2e2 * t7 * t94 * (-0.5e1 / 0.72e2 * t52 * t275 * t860 + t52 * t308 * t2457 / 0.24e2 + 0.2e1 * t680 * t912 + 0.2e1 * t278 * t2694 + t232 * t3211 + t113 * t10233));
  tv4rhosigma2lapl23 = t10240 * t8 + t3217;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 23] += tv4rhosigma2lapl23;

  tv4rhosigma2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigma2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 1] += tv4rhosigma2tau1;

  tv4rhosigma2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 2] += tv4rhosigma2tau2;

  tv4rhosigma2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 3] += tv4rhosigma2tau3;

  tv4rhosigma2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 4] += tv4rhosigma2tau4;

  tv4rhosigma2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 5] += tv4rhosigma2tau5;

  tv4rhosigma2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 6] += tv4rhosigma2tau6;

  tv4rhosigma2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 7] += tv4rhosigma2tau7;

  tv4rhosigma2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 8] += tv4rhosigma2tau8;

  tv4rhosigma2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 9] += tv4rhosigma2tau9;

  tv4rhosigma2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 10] += tv4rhosigma2tau10;

  tv4rhosigma2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 11] += tv4rhosigma2tau11;

  tv4rhosigma2tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 12] += tv4rhosigma2tau12;

  tv4rhosigma2tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 13] += tv4rhosigma2tau13;

  tv4rhosigma2tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 14] += tv4rhosigma2tau14;

  tv4rhosigma2tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 15] += tv4rhosigma2tau15;

  tv4rhosigma2tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 16] += tv4rhosigma2tau16;

  tv4rhosigma2tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 17] += tv4rhosigma2tau17;

  tv4rhosigma2tau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 18] += tv4rhosigma2tau18;

  tv4rhosigma2tau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 19] += tv4rhosigma2tau19;

  tv4rhosigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 20] += tv4rhosigma2tau20;

  tv4rhosigma2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 21] += tv4rhosigma2tau21;

  tv4rhosigma2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 22] += tv4rhosigma2tau22;

  tv4rhosigma2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 23] += tv4rhosigma2tau23;

  t10247 = t7 * t145 * t3282 / 0.1e2;
  t10259 = t2515 * t74 * t7680;
  t10262 = t379 * t8234;
  t10263 = t171 * t741;
  t10267 = -0.6e1 * t10262 * t10263 * t3236 - 0.6e1 * t10259 * t8249 + t2213 - t2216 + t2225 + t2248 - t2250 - t2258 - t2728 - t2740 + t2745 - t2747 + t2914 + t2920 - 0.4e1 * t3060 - t3072 + t3228 + t3230 + t3235 - t3239;
  t10271 = t1670 * t741;
  t10275 = t7699 * t2552;
  t10294 = t2503 * t8942;
  t10299 = t8305 * t3596;
  t10300 = t3614 * t10299;
  t10305 = t3745 * t386 * t624 * t165;
  t10308 = t163 * t10299;
  t10311 = t379 * t10299;
  t10315 = t379 * t8423 * t384;
  t10318 = t1038 * t10299;
  t10321 = t922 * t165;
  t10326 = t3231 * t165;
  t10327 = t389 * t10326;
  t10330 = t171 * t7475;
  t10333 = 0.6e1 * t1997 * t2551 * t7496 - 0.6e1 * t10262 * t4811 * t10271 - 0.18e2 * t8249 * t10275 - 0.12e2 * t8249 * t1136 * t1051 * t2552 + 0.18e2 * t8249 * t1136 * t263 * t2302 + 0.18e2 * t8271 * t10275 + 0.18e2 * t8249 * t7684 - 0.6e1 * t8293 * t10259 + 0.18e2 * t8271 * t10259 - 0.18e2 * t8277 * t10294 + 0.18e2 * t8282 * t10294 + 0.7e1 * t10300 * t2517 - 0.7e1 * t10300 * t10305 + 0.11e2 * t10308 * t2504 - 0.11e2 * t10311 * t2504 - 0.3e1 * t10315 * t2504 + 0.6e1 * t10318 * t2541 + 0.3e1 * t163 * t10321 * t3589 * t873 - 0.3e1 * t10315 * t10327 - 0.6e1 * t2507 * t10330;
  t10335 = t2515 * t741;
  t10336 = t389 * t10335;
  t10355 = t922 * params->csk_a;
  t10363 = t922 * t1051 * t263;
  t10369 = t3745 * t1059 * t1589 * t165;
  t10378 = t7397 * t165;
  t10394 = t2515 * t10263;
  t10397 = 0.6e1 * t2502 * t10336 + 0.6e1 * t8235 * t171 * t10271 + 0.6e1 * t7678 * t389 * t7496 - 0.6e1 * t9536 * t1136 * t922 * t263 * t403 - 0.12e2 * t10318 * t1136 * t10326 + 0.6e1 * t2514 * t7476 - 0.6e1 * t9554 * t3619 * t10355 * t263 - 0.6e1 * t2514 * t10336 + 0.18e2 * t9554 * t1136 * t10363 - 0.12e2 * t10300 * t10369 - 0.4e1 * t2514 * t1136 * t10335 + 0.11e2 * t9554 * t3619 * t10363 - 0.6e1 * t10300 * t3619 * t10378 - 0.12e2 * t8293 * t8883 + 0.7e1 * t10311 * t10327 - 0.7e1 * t10311 * t10305 + 0.6e1 * t10308 * t2541 - 0.3e1 * t2739 * t8918 + 0.6e1 * t2502 * t10330 + 0.6e1 * t2502 * t10394;
  t10414 = t171 * t10378;
  t10435 = -t10300 * t10414 + 0.18e2 * t10305 * t10318 - 0.18e2 * t10318 * t10327 + 0.12e2 * t10318 * t10369 - 0.4e1 * t9564 + 0.6e1 * t9566 - 0.6e1 * t9572 + 0.6e1 * t9583 + 0.6e1 * t9585 - 0.6e1 * t9648 + 0.6e1 * t9650;
  t10459 = 0.6e1 * t9671 + 0.6e1 * t9676 - 0.2e1 * t9678 + 0.6e1 * t9681 - 0.2e1 * t9692 + 0.6e1 * t9717 - 0.6e1 * t9720 - 0.6e1 * t9737 - 0.3e1 * t8867 - 0.3e1 * t8871 + 0.3e1 * t8875 + 0.3e1 * t8880 + 0.3e1 * t8884 + 0.3e1 * t8889 - 0.2e1 * t8893 + 0.3e1 * t8926 - 0.3e1 * t8934 + 0.3e1 * t8937 - 0.3e1 * t8951 + 0.3e1 * t8954;
  t10489 = t379 * t9095;
  t10490 = t388 * t922;
  t10509 = -t8956 - t8963 + 0.3e1 * t8965 - 0.3e1 * t2720 * t8977 - 0.2e1 * t1620 * t8349 + t9096 * t3750 * t4907 * t922 + 0.3e1 * t2749 * t4873 - t2720 * t9060 + 0.3e1 * t2782 * t4859 - 0.6e1 * t1961 * t1045 * t624 * t741 + 0.6e1 * t9762 * t3740 * t2734 * t263 + 0.3e1 * t2749 * t4937 + 0.3e1 * t2717 * t9054 - 0.4e1 * t1938 * t1050 * t878 * t741 + 0.11e2 * t10489 * t3773 * t10490 * t263 - 0.3e1 * t2749 * t9054 - 0.2e1 * t2749 * t9107 + 0.3e1 * t8476 * t394 * t2560 + 0.3e1 * t379 * t10321 * t3590 * t3252 + 0.6e1 * t8306 * t3826 * t2560;
  t10532 = -0.3e1 * t2717 * t5103 + 0.3e1 * t2717 * t8977 + 0.3e1 * t2717 * t9060 - 0.2e1 * t2720 * t9152 - t2735 * t4781 - t2749 * t9060 + 0.3e1 * t2775 * t9044 - 0.2e1 * t9006 + t9035 - 0.3e1 * t9039 - t9041 - t9049 - t9068 - 0.2e1 * t9780 + 0.2e1 * t9788 - 0.2e1 * t9794 - 0.6e1 * t9803 - 0.2e1 * t9807 - 0.4e1 * t9821 + 0.2e1 * t9841;
  t10543 = -0.18e2 * t2552 * t389 * t8271 - 0.11e2 * t10311 * t2517 - 0.6e1 * t10318 * t2521 + t2776 + t2783 - t3277 - t826 + t9150 + t9155 - t9159 - t929;
  t10548 = my_piecewise5(t64, 0, t67, 0, -0.2e1 * t2514 * t10394 - 0.3e1 * t2739 * t8896 + 0.6e1 * t2514 * t7516 - 0.2e1 * t2507 * t10394 + 0.3e1 * t2744 * t8922 - 0.18e2 * t10311 * t2541 + t10308 * t10414 - 0.7e1 * t10311 * t10414 + 0.6e1 * t10318 * t10414 - 0.2e1 * t9846 + 0.2e1 * t9842 - t3272 + t3273 - t3274 + t3269 + t3261 - t2963 + t2961 - t2951 + t10543 + t10532 + t10509 + t10459 + t10435 + t10397 + t10333 + t10267 - 0.6e1 * t7448 * t1136 * t10355 * t165);
  t10555 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t3282 + t10247 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.5e1 / 0.36e2 * t52 * t257 * t886 + t52 * t291 * t2570 / 0.12e2 + t618 * t935 + t260 * t2787 + t161 * t3280 + t59 * t10548));
  tv4rhosigmalapl20 = t10555 * t8 + t3286;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 1] += tv4rhosigmalapl21;

  tv4rhosigmalapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 2] += tv4rhosigmalapl22;

  tv4rhosigmalapl23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 3] += tv4rhosigmalapl23;

  tv4rhosigmalapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 4] += tv4rhosigmalapl24;

  tv4rhosigmalapl25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 5] += tv4rhosigmalapl25;

  tv4rhosigmalapl26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 6] += tv4rhosigmalapl26;

  tv4rhosigmalapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 7] += tv4rhosigmalapl27;

  t10562 = t7 * t192 * t3351 / 0.1e2;
  t10564 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t3351 + t10562);
  tv4rhosigmalapl28 = t10564 * t8 + t3355;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 8] += tv4rhosigmalapl28;

  t10570 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t3282 + t10247);
  tv4rhosigmalapl29 = t10570 * t8 + t3286;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 9] += tv4rhosigmalapl29;

  tv4rhosigmalapl210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 10] += tv4rhosigmalapl210;

  tv4rhosigmalapl211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 11] += tv4rhosigmalapl211;

  tv4rhosigmalapl212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 12] += tv4rhosigmalapl212;

  tv4rhosigmalapl213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 13] += tv4rhosigmalapl213;

  tv4rhosigmalapl214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 14] += tv4rhosigmalapl214;

  tv4rhosigmalapl215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 15] += tv4rhosigmalapl215;

  tv4rhosigmalapl216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 16] += tv4rhosigmalapl216;

  t10585 = t560 * t8586;
  t10586 = t1870 * t795;
  t10590 = t7867 * t2667;
  t10601 = -0.12e2 * t1051 * t1521 * t2667 * t8606 + 0.18e2 * t1521 * t2447 * t281 * t8606 - 0.6e1 * t10585 * t10586 * t5369 - 0.18e2 * t10590 * t8606 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2841 - t2845 + t2850 - t2852 + t2988 + t3003 - 0.4e1 * t3152 - t3154 + t3297 + t3298;
  t10604 = t5518 * t122 * t904 * t584;
  t10621 = t2618 * t9946;
  t10637 = -0.6e1 * t10585 * t2855 * t3343 + 0.6e1 * t2167 * t2666 * t8061 + 0.18e2 * t10590 * t8643 - 0.6e1 * t10604 * t8606 - 0.6e1 * t10604 * t8638 + 0.18e2 * t10604 * t8643 - 0.18e2 * t10621 * t8617 + 0.18e2 * t10621 * t8620 + 0.18e2 * t7848 * t8606 + 0.6e1 * t10018 + 0.6e1 * t10020 + 0.6e1 * t10022 - 0.4e1 * t10060 - 0.6e1 * t10078 + 0.6e1 * t10094 - 0.6e1 * t9914 + 0.6e1 * t9937 - 0.6e1 * t9939 - 0.6e1 * t9996 + 0.6e1 * t9998;
  t10657 = -t2859 * t9327 + 0.6e1 * t10098 - 0.2e1 * t10100 + 0.6e1 * t10103 - 0.2e1 * t10107 + 0.3e1 * t9201 + 0.3e1 * t9206 + 0.3e1 * t9216 + 0.3e1 * t9228 - 0.3e1 * t9231 - 0.3e1 * t9233 + 0.3e1 * t9251 - 0.2e1 * t9255 + 0.3e1 * t9263 - 0.3e1 * t9274 - t9276 + 0.3e1 * t9281 - t9287 + 0.3e1 * t9290 - 0.3e1 * t9294;
  t10696 = t945 * t236;
  t10714 = 0.3e1 * t10696 * t281 * t4476 * t560 * t570 - 0.4e1 * t1783 * t2115 * t795 * t904 + 0.11e2 * t281 * t4561 * t8681 * t9297 + 0.6e1 * t2675 * t5299 * t8700 + 0.3e1 * t2675 * t575 * t8833 - t2826 * t9327 + 0.3e1 * t2829 * t9327 + 0.3e1 * t2859 * t5421 + 0.3e1 * t2859 * t5442 - 0.3e1 * t2859 * t9310 + 0.2e1 * t10159;
  t10733 = -0.2e1 * t2826 * t9460 - 0.3e1 * t2829 * t5638 - t2835 * t5331 - 0.2e1 * t10171 - 0.2e1 * t10174 - 0.6e1 * t10179 - 0.2e1 * t10183 - 0.4e1 * t10195 + 0.2e1 * t10218 + 0.2e1 * t10219 - 0.2e1 * t10223 - t3303 - t9337 + t9350 - t9379 - 0.2e1 * t9401 - 0.3e1 * t9408 - t9424 + t9458 - t952;
  t10738 = t8660 * t4491;
  t10739 = t1429 * t10738;
  t10745 = t4509 * t10738;
  t10748 = t3745 * t567 * t686 * t236;
  t10753 = t234 * t10738;
  t10756 = t560 * t10738;
  t10760 = t560 * t8779 * t565;
  t10763 = t570 * t5578;
  t10770 = 0.3e1 * t10696 * t234 * t4475 * t899 - 0.18e2 * t2667 * t570 * t8643 - 0.6e1 * t10739 * t2628 + 0.6e1 * t10739 * t2653 - 0.7e1 * t10745 * t10748 + 0.7e1 * t10745 * t2631 + 0.11e2 * t10753 * t2619 - 0.11e2 * t10756 * t2619 - 0.11e2 * t10756 * t2631 - 0.3e1 * t10760 * t10763 - 0.3e1 * t10760 * t2619 + t2867 - t3026 - t3031 + t3040 + t3309 + t3319 - t3336 - t3337 + t3338;
  t10772 = t945 * params->csk_a;
  t10777 = t2626 * t795;
  t10778 = t570 * t10777;
  t10785 = t945 * t1051 * t281;
  t10789 = t7891 * t236;
  t10813 = t3745 * t1436 * t1792 * t236;
  t10816 = t3300 * t2855;
  t10821 = t242 * t10777;
  t10832 = t2888 - 0.6e1 * t10004 * t4514 * t10772 * t281 + 0.6e1 * t2617 * t10778 - 0.4e1 * t2625 * t1521 * t10777 + 0.11e2 * t10004 * t4514 * t10785 - 0.6e1 * t10745 * t4514 * t10789 + 0.6e1 * t7842 * t570 * t8061 - 0.6e1 * t10025 * t1521 * t945 * t281 * t584 - 0.12e2 * t8638 * t242 * t2667 + 0.7e1 * t10756 * t10763 - 0.6e1 * t2625 * t10778 + 0.18e2 * t10004 * t1521 * t10785 - 0.12e2 * t10745 * t10813 + 0.6e1 * t2617 * t10816 - 0.3e1 * t2844 * t9239 - 0.2e1 * t2622 * t10821 + 0.6e1 * t2617 * t10821 - 0.2e1 * t2625 * t10821 - 0.3e1 * t2844 * t9245 + 0.6e1 * t2625 * t7996;
  t10856 = t242 * t10789;
  t10870 = 0.18e2 * t10739 * t10748 - 0.18e2 * t10739 * t10763 + 0.12e2 * t10739 * t10813 + 0.6e1 * t10739 * t10856 - t10745 * t10856 - 0.7e1 * t10756 * t10856 + t3342 - t3346 - t852 + t9479 - t9483;
  t10875 = my_piecewise5(t114, 0, t115, 0, 0.6e1 * t10753 * t2653 - 0.18e2 * t10756 * t2653 + t10753 * t10856 + 0.3e1 * t2829 * t9330 + 0.3e1 * t2829 * t9310 + 0.3e1 * t2887 * t9340 - 0.3e1 * t2826 * t9330 - 0.2e1 * t1807 * t8676 - 0.2e1 * t2859 * t9366 + 0.3e1 * t2866 * t5358 + 0.3e1 * t2849 * t9219 - 0.6e1 * t2622 * t10816 - 0.12e2 * t10739 * t5579 + 0.6e1 * t2625 * t8069 - 0.7e1 * t10756 * t10748 - 0.6e1 * t4509 * t5286 * t4491 * t1521 * t10772 * t236 + t10870 + t10832 + t10770 + t10733 + t10714 + t10657 + t10637 + t10601 + t9313 * t4552 * t5424 * t945 - 0.6e1 * t2131 * t1445 * t686 * t795 + 0.6e1 * t10135 * t4541 * t2834 * t281 + 0.6e1 * t8587 * t242 * t10586);
  t10882 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t3351 + t10562 + 0.3e1 / 0.2e2 * t7 * t94 * (-0.5e1 / 0.36e2 * t52 * t275 * t912 + t52 * t308 * t2694 / 0.12e2 + t680 * t958 + t278 * t2892 + t232 * t3349 + t113 * t10875));
  tv4rhosigmalapl217 = t10882 * t8 + t3355;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 17] += tv4rhosigmalapl217;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmalapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 1] += tv4rhosigmalapltau1;

  tv4rhosigmalapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 2] += tv4rhosigmalapltau2;

  tv4rhosigmalapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 3] += tv4rhosigmalapltau3;

  tv4rhosigmalapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 4] += tv4rhosigmalapltau4;

  tv4rhosigmalapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 5] += tv4rhosigmalapltau5;

  tv4rhosigmalapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 6] += tv4rhosigmalapltau6;

  tv4rhosigmalapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 7] += tv4rhosigmalapltau7;

  tv4rhosigmalapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 8] += tv4rhosigmalapltau8;

  tv4rhosigmalapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 9] += tv4rhosigmalapltau9;

  tv4rhosigmalapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 10] += tv4rhosigmalapltau10;

  tv4rhosigmalapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 11] += tv4rhosigmalapltau11;

  tv4rhosigmalapltau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 12] += tv4rhosigmalapltau12;

  tv4rhosigmalapltau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 13] += tv4rhosigmalapltau13;

  tv4rhosigmalapltau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 14] += tv4rhosigmalapltau14;

  tv4rhosigmalapltau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 15] += tv4rhosigmalapltau15;

  tv4rhosigmalapltau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 16] += tv4rhosigmalapltau16;

  tv4rhosigmalapltau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 17] += tv4rhosigmalapltau17;

  tv4rhosigmalapltau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 18] += tv4rhosigmalapltau18;

  tv4rhosigmalapltau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 19] += tv4rhosigmalapltau19;

  tv4rhosigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 20] += tv4rhosigmalapltau20;

  tv4rhosigmalapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 21] += tv4rhosigmalapltau21;

  tv4rhosigmalapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 22] += tv4rhosigmalapltau22;

  tv4rhosigmalapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 23] += tv4rhosigmalapltau23;

  tv4rhosigmatau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  tv4rhosigmatau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 1] += tv4rhosigmatau21;

  tv4rhosigmatau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 2] += tv4rhosigmatau22;

  tv4rhosigmatau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 3] += tv4rhosigmatau23;

  tv4rhosigmatau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 4] += tv4rhosigmatau24;

  tv4rhosigmatau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 5] += tv4rhosigmatau25;

  tv4rhosigmatau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 6] += tv4rhosigmatau26;

  tv4rhosigmatau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 7] += tv4rhosigmatau27;

  tv4rhosigmatau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 8] += tv4rhosigmatau28;

  tv4rhosigmatau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 9] += tv4rhosigmatau29;

  tv4rhosigmatau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 10] += tv4rhosigmatau210;

  tv4rhosigmatau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 11] += tv4rhosigmatau211;

  tv4rhosigmatau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 12] += tv4rhosigmatau212;

  tv4rhosigmatau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 13] += tv4rhosigmatau213;

  tv4rhosigmatau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 14] += tv4rhosigmatau214;

  tv4rhosigmatau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 15] += tv4rhosigmatau215;

  tv4rhosigmatau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 16] += tv4rhosigmatau216;

  tv4rhosigmatau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 17] += tv4rhosigmatau217;

  t10889 = t7 * t145 * t3417 / 0.1e2;
  t10897 = 0.6e1 * t3060;
  t10899 = t3359 - t10897 + t3361 - t2728 + t2213 - t2216 + t2225 + t2248 - t2250 - t2258 - t2740 + t2745 - t2747 - 0.6e1 * t9564;
  t10914 = 0.9e1 * t9566 - 0.9e1 * t9572 + 0.9e1 * t9583 + 0.9e1 * t9585 - 0.9e1 * t9648 + 0.9e1 * t9650 + 0.9e1 * t9671 + 0.9e1 * t9676 - 0.3e1 * t9678 + 0.9e1 * t9681 - 0.3e1 * t9692 + 0.9e1 * t9717 - 0.9e1 * t9720 - 0.9e1 * t9737;
  t10916 = t3362 * t3594;
  t10917 = t1038 * t10916;
  t10920 = t379 * t10916;
  t10923 = t3614 * t10916;
  t10926 = t163 * t10916;
  t10941 = t3362 * t382;
  t10942 = t163 * t10941;
  t10950 = -0.12e2 * t1050 * t10942 * t7680 + 0.6e1 * t10917 * t9071 + 0.18e2 * t10917 * t9078 + 0.12e2 * t10917 * t9082 - 0.18e2 * t10917 * t9088 - 0.18e2 * t10920 * t8988 - 0.7e1 * t10920 * t9071 - 0.7e1 * t10920 * t9078 - 0.11e2 * t10920 * t9123 - t10923 * t9071 - 0.6e1 * t10923 * t9085 + 0.6e1 * t10926 * t8988 + t10926 * t9071 + 0.11e2 * t10926 * t9123;
  t10951 = t1623 * t10263;
  t10962 = t3618 * t3362;
  t10964 = t3750 * t10962 * t1051;
  t10972 = t3750 * t10962 * params->csk_a;
  t10976 = t1045 * t1068 * t741;
  t10979 = t1050 * t2769;
  t10986 = t1062 * t3362;
  t10988 = t3740 * t10986 * t1051;
  t10995 = -0.6e1 * t1060 * t1078 * t2749 * t741 - 0.11e2 * t10920 * t8998 + 0.7e1 * t10920 * t9088 - 0.6e1 * t10923 * t9020 - 0.12e2 * t10923 * t9082 - 0.3e1 * t10951 * t2749 + 0.11e2 * t10964 * t9096 - 0.6e1 * t10972 * t9096 + 0.9e1 * t10976 * t2717 - 0.9e1 * t10976 * t2749 - 0.9e1 * t10979 * t2720 + 0.18e2 * t10988 * t9096 + 0.9e1 * t2749 * t5824 + 0.9e1 * t2749 * t5846 + 0.9e1 * t2782 * t5895;
  t11000 = t1060 * t10986 * t403;
  t11013 = t3362 * t3589;
  t11014 = t379 * t11013;
  t11021 = t3362 * t165;
  t11027 = t379 * t10941;
  t11036 = 0.9e1 * t1100 * t2775 * t394 * t741 - 0.6e1 * t1038 * t11000 * t622 + 0.3e1 * t11021 * t163 * t4799 + 0.6e1 * t10917 * t8988 - 0.6e1 * t10917 * t9015 - 0.12e2 * t10917 * t9085 + 0.7e1 * t10923 * t8998 - 0.7e1 * t10923 * t9078 + 0.9e1 * t10951 * t2717 - 0.3e1 * t10951 * t2720 + 0.9e1 * t10979 * t2717 - 0.3e1 * t11014 * t630 - 0.3e1 * t11014 * t645 - 0.18e2 * t11027 * t8973;
  t11048 = t163 * t11013;
  t11053 = t3750 * t10962;
  t11057 = t3740 * t10986;
  t11063 = -0.6e1 * t1050 * t2720 * t2725 + 0.3e1 * t11021 * t3602 * t379 + 0.6e1 * t10926 * t9141 + 0.3e1 * t11048 * t640 + t11053 * t9096 + 0.6e1 * t11057 * t9762 - 0.9e1 * t2717 * t5953 - 0.3e1 * t2749 * t5987 - 0.3e1 * t9780 + 0.3e1 * t9788 - 0.3e1 * t9794 - 0.9e1 * t9803 - 0.3e1 * t9807 - 0.6e1 * t9821;
  t11066 = t3773 * t388 * t3362;
  t11072 = t3371 * t1044;
  t11073 = t1038 * t11072;
  t11076 = t163 * t11072;
  t11079 = t379 * t11072;
  t11085 = t10941 * t1044;
  t11086 = t1038 * t11085;
  t11098 = t1136 * t3371 * params->csk_a;
  t11106 = 0.9e1 * t171 * t2744 * t3573 * t741 - 0.9e1 * t2739 * t389 * t4956 * t741 - 0.9e1 * t10263 * t2739 * t4956 - 0.12e2 * t11073 * t1136 * t8968 + 0.11e2 * t10489 * t11066 - 0.18e2 * t11073 * t8969 - 0.18e2 * t11076 * t8943 + 0.18e2 * t11079 * t8943 - 0.6e1 * t11086 * t8915 + 0.18e2 * t11086 * t8958 + 0.18e2 * t11098 * t9536 + 0.3e1 * t9841 + 0.3e1 * t9842 - 0.3e1 * t9846;
  t11107 = t163 * t11085;
  t11110 = t379 * t11085;
  t11115 = 0.18e2 * t11079 * t8969 - 0.6e1 * t11107 * t8915 + 0.18e2 * t11110 * t8915 + t2776 + t2783 - t3374 - t3376 + t3380 - t3381 + t3382 - t3383 + t3387 + t3390 - t826 - t929;
  t11119 = my_piecewise5(t64, 0, t67, 0, t10899 + t10914 + t10950 + t10995 + t11036 + t11063 + t11106 + t11115);
  t11126 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t140 * t3417 + t10889 + 0.3e1 / 0.2e2 * t7 * t32 * (-0.5e1 / 0.24e2 * t52 * t257 * t935 + t52 * t291 * t2787 / 0.8e1 + t161 * t3415 + t59 * t11119));
  tv4rholapl30 = t11126 * t8 + t3421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 1] += tv4rholapl31;

  tv4rholapl32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 2] += tv4rholapl32;

  t11133 = t7 * t192 * t3483 / 0.1e2;
  t11135 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t188 * t3483 + t11133);
  tv4rholapl33 = t11135 * t8 + t3487;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 3] += tv4rholapl33;

  t11141 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t205 * t3417 + t10889);
  tv4rholapl34 = t11141 * t8 + t3421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 4] += tv4rholapl34;

  tv4rholapl35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 5] += tv4rholapl35;

  tv4rholapl36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 6] += tv4rholapl36;

  t11153 = 0.6e1 * t3152;
  t11155 = t3425 + t3426 - t11153 - t2841 + t2346 - t2349 + t2362 + t2401 - t2404 - t2432 - t2845 + t2850 - t2852 - 0.9e1 * t9914;
  t11170 = 0.9e1 * t9937 - 0.9e1 * t9939 - 0.9e1 * t9996 + 0.9e1 * t9998 + 0.9e1 * t10018 + 0.9e1 * t10020 + 0.9e1 * t10022 - 0.6e1 * t10060 - 0.9e1 * t10078 + 0.9e1 * t10094 + 0.9e1 * t10098 - 0.3e1 * t10100 + 0.9e1 * t10103 - 0.3e1 * t10107;
  t11172 = t3428 * t4489;
  t11173 = t1429 * t11172;
  t11176 = t234 * t11172;
  t11183 = t560 * t11172;
  t11186 = t4509 * t11172;
  t11203 = t4513 * t3428;
  t11205 = t4552 * t11203 * t1051;
  t11208 = -0.6e1 * t1437 * t1456 * t2859 * t795 + 0.12e2 * t11173 * t9321 + 0.6e1 * t11173 * t9390 + 0.18e2 * t11173 * t9427 + 0.6e1 * t11173 * t9437 + 0.11e2 * t11176 * t9324 + 0.6e1 * t11176 * t9390 + t11176 * t9437 - 0.18e2 * t11183 * t9390 - 0.7e1 * t11183 * t9427 - 0.7e1 * t11183 * t9437 - 0.6e1 * t11186 * t9410 - t11186 * t9437 + 0.11e2 * t11205 * t9313;
  t11215 = t1463 * t2855;
  t11218 = t1460 * t2855;
  t11232 = t4552 * t11203 * params->csk_a;
  t11236 = t1445 * t1446 * t795;
  t11240 = t1439 * t3428;
  t11242 = t1437 * t11240 * t584;
  t11249 = t569 * t3428;
  t11251 = t1445 * t11249 * t584;
  t11254 = 0.9e1 * t1482 * t2887 * t575 * t795 - 0.6e1 * t11242 * t1429 * t684 - 0.12e2 * t11173 * t9410 - 0.11e2 * t11183 * t9306 - 0.6e1 * t11186 * t9374 - 0.9e1 * t11215 * t2826 + 0.9e1 * t11215 * t2829 - 0.3e1 * t11218 * t2826 + 0.9e1 * t11218 * t2829 - 0.3e1 * t11218 * t2859 - 0.6e1 * t11232 * t9313 + 0.9e1 * t11236 * t2829 - 0.18e2 * t11251 * t685 + 0.9e1 * t2859 * t6200 + 0.9e1 * t2859 * t6266;
  t11262 = t4561 * t11249 * params->csk_a;
  t11268 = t4541 * t11240 * t1051;
  t11277 = t3428 * t4475;
  t11278 = t560 * t11277;
  t11283 = t3428 * t236;
  t11293 = 0.3e1 * t11283 * t234 * t5306 - 0.18e2 * t10135 * t11262 - 0.6e1 * t11173 * t9403 - 0.11e2 * t11183 * t9324 + 0.7e1 * t11183 * t9432 + 0.7e1 * t11186 * t9306 - 0.12e2 * t11186 * t9321 - 0.7e1 * t11186 * t9427 - 0.9e1 * t11236 * t2859 + 0.18e2 * t11268 * t9313 - 0.3e1 * t11278 * t692 - 0.3e1 * t11278 * t707 + 0.9e1 * t2866 * t6371 - 0.12e2 * t3460 * t9396;
  t11300 = t4541 * t11240;
  t11305 = t4552 * t11203;
  t11310 = t4561 * t11249;
  t11318 = t234 * t11277;
  t11321 = 0.3e1 * t11283 * t4497 * t560 - 0.6e1 * t1783 * t2821 * t2826 + 0.6e1 * t10135 * t11300 + t11305 * t9313 + 0.11e2 * t11310 * t9297 + 0.3e1 * t11318 * t702 - 0.9e1 * t2829 * t6401 - 0.3e1 * t2859 * t6432 + 0.3e1 * t10159 - 0.3e1 * t10171 - 0.3e1 * t10174 - 0.9e1 * t10179 - 0.3e1 * t10183 - 0.6e1 * t10195;
  t11328 = t3437 * t1435;
  t11329 = t234 * t11328;
  t11333 = t3428 * t563 * t1435;
  t11334 = t1429 * t11333;
  t11341 = t1521 * t3437 * params->csk_a;
  t11348 = t560 * t11333;
  t11359 = 0.9e1 * t242 * t2849 * t4464 * t795 - 0.9e1 * t2844 * t4457 * t570 * t795 - 0.9e1 * t2844 * t2855 * t4457 + 0.18e2 * t10025 * t11341 + 0.6e1 * t11176 * t9466 - 0.18e2 * t11329 * t9267 - 0.18e2 * t11334 * t9225 - 0.6e1 * t11334 * t9236 - 0.12e2 * t11334 * t9259 + 0.18e2 * t11348 * t2448 + 0.3e1 * t10218 + 0.3e1 * t10219 - 0.3e1 * t10223 - t952;
  t11360 = t560 * t11328;
  t11366 = t234 * t11333;
  t11371 = 0.18e2 * t11360 * t570 * t9908 + 0.18e2 * t11334 * t9283 + 0.18e2 * t11348 * t9236 - 0.6e1 * t11366 * t9236 + t2867 + t2888 - t3440 - t3442 + t3446 - t3447 - t3448 + t3449 + t3462 + t3465 - t852;
  t11375 = my_piecewise5(t114, 0, t115, 0, t11155 + t11170 + t11208 + t11254 + t11293 + t11321 + t11359 + t11371);
  t11382 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t216 * t3483 + t11133 + 0.3e1 / 0.2e2 * t7 * t94 * (-0.5e1 / 0.24e2 * t52 * t275 * t958 + t52 * t308 * t2892 / 0.8e1 + t232 * t3481 + t113 * t11375));
  tv4rholapl37 = t11382 * t8 + t3487;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 7] += tv4rholapl37;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapl2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 1] += tv4rholapl2tau1;

  tv4rholapl2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 2] += tv4rholapl2tau2;

  tv4rholapl2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 3] += tv4rholapl2tau3;

  tv4rholapl2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 4] += tv4rholapl2tau4;

  tv4rholapl2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 5] += tv4rholapl2tau5;

  tv4rholapl2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 6] += tv4rholapl2tau6;

  tv4rholapl2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 7] += tv4rholapl2tau7;

  tv4rholapl2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 8] += tv4rholapl2tau8;

  tv4rholapl2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 9] += tv4rholapl2tau9;

  tv4rholapl2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 10] += tv4rholapl2tau10;

  tv4rholapl2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 11] += tv4rholapl2tau11;

  tv4rholapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rholapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 1] += tv4rholapltau21;

  tv4rholapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 2] += tv4rholapltau22;

  tv4rholapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 3] += tv4rholapltau23;

  tv4rholapltau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 4] += tv4rholapltau24;

  tv4rholapltau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 5] += tv4rholapltau25;

  tv4rholapltau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 6] += tv4rholapltau26;

  tv4rholapltau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 7] += tv4rholapltau27;

  tv4rholapltau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 8] += tv4rholapltau28;

  tv4rholapltau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 9] += tv4rholapltau29;

  tv4rholapltau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 10] += tv4rholapltau210;

  tv4rholapltau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 11] += tv4rholapltau211;

  tv4rhotau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 0] += tv4rhotau30;

  tv4rhotau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 1] += tv4rhotau31;

  tv4rhotau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 2] += tv4rhotau32;

  tv4rhotau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 3] += tv4rhotau33;

  tv4rhotau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 4] += tv4rhotau34;

  tv4rhotau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 5] += tv4rhotau35;

  tv4rhotau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 6] += tv4rhotau36;

  tv4rhotau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim->v4rhotau3 + 7] += tv4rhotau37;

  t11394 = t379 * t824 * t817 * t403 * t1115;
  t11397 = t171 * t8886 * t403;
  t11398 = t2301 * t11397;
  t11400 = t389 * t3079;
  t11401 = t8866 * t11400;
  t11403 = t1050 * t2959;
  t11404 = t2227 * t11403;
  t11406 = t6536 * t3102;
  t11409 = t817 * t817;
  t11410 = t11409 * t403;
  t11411 = t163 * t11410;
  t11414 = t379 * t11410;
  t11417 = t11409 * t382;
  t11418 = t1038 * t11417;
  t11426 = t3063 * t403;
  t11428 = t163 * t8864 * t394 * t11426;
  t11431 = t1623 * t171 * t824;
  t11432 = t2241 * t11431;
  t11437 = t1045 * t1068 * t824;
  t11438 = t2231 * t11437;
  t11440 = t2241 * t6573;
  t11443 = t1060 * t1078 * t824;
  t11444 = t2241 * t11443;
  t11446 = t2276 * t6684;
  t11448 = -0.12e2 * t1060 * t1078 * t11418 * t403 - 0.18e2 * t11411 * t3680 + 0.18e2 * t11414 * t3680 + 0.18e2 * t11418 * t3698 - 0.18e2 * t11418 * t3712 + 0.18e2 * t11428 - 0.6e1 * t11432 + 0.18e2 * t11438 + 0.18e2 * t11440 - 0.12e2 * t11444 + 0.18e2 * t11446;
  t11450 = t2241 * t11437;
  t11452 = t2241 * t6675;
  t11457 = t379 * t11417;
  t11464 = t2227 * t11431;
  t11466 = t2231 * t11431;
  t11470 = t2241 * t6848;
  t11473 = t11409 * t3594;
  t11474 = t3614 * t11473;
  t11476 = t1038 * t11473;
  t11483 = t379 * t11473;
  t11486 = t163 * t11473;
  t11494 = t824 * t824;
  t11495 = t11494 * t382;
  t11498 = 0.3e1 * t163 * t11495 * t396;
  t11499 = t379 * t11495;
  t11501 = 0.3e1 * t11499 * t413;
  t11502 = -0.6e1 * t11474 * t3741 - t11474 * t3846 + 0.12e2 * t11476 * t3747 + 0.18e2 * t11476 * t3755 - 0.18e2 * t11476 * t3777 + 0.6e1 * t11476 * t3846 - 0.7e1 * t11483 * t3755 - 0.7e1 * t11483 * t3846 + t11486 * t3846 + t11498 - t11501;
  t11517 = t2231 * t6823;
  t11532 = t11409 * t3589;
  t11533 = t379 * t11532;
  t11547 = t6533 * t3064;
  t11551 = 0.3e1 * t11532 * t163 * t396 - 0.12e2 * t11411 * t3838 - 0.6e1 * t11474 * t3752 - 0.7e1 * t11474 * t3755 + 0.7e1 * t11474 * t3774 + 0.6e1 * t11476 * t3856 - 0.11e2 * t11483 * t3774 - 0.18e2 * t11483 * t3856 + 0.6e1 * t11486 * t3856 - 0.3e1 * t11533 * t396 - 0.12e2 * t11547;
  t11560 = 0.3e1 * t11499 * t396;
  t11561 = t163 * t11409;
  t11566 = t379 * t11409;
  t11574 = t163 * t11494;
  t11576 = 0.3e1 * t11574 * t405;
  t11580 = 0.3e1 * t379 * t11494 * t390;
  t11582 = 0.3e1 * t11574 * t407;
  t11591 = t11409 * t3614 * t3620 + t11580 + t11582 - 0.4e1 * t2951 - 0.4e1 * t2954 + 0.4e1 * t2957 + 0.4e1 * t2961 - 0.4e1 * t2963 - 0.4e1 * t2965 - t826 - t828;
  t11595 = my_piecewise5(t64, 0, t67, 0, t11591 - t11576 - t11560 + t11551 - 0.18e2 * t11517 + t11502 - 0.6e1 * t11470 - 0.6e1 * t11464 + 0.18e2 * t11466 - 0.18e2 * t11450 + 0.18e2 * t11452 + t11448 + 0.11e2 * t11486 * t3827 - 0.11e2 * t11483 * t3827 - 0.6e1 * t11474 * t3786 + 0.18e2 * t11474 * t3758 - 0.12e2 * t11474 * t3747 + 0.11e2 * t11474 * t3765 - 0.6e1 * t11418 * t3811 + 0.18e2 * t11457 * t3647 - 0.6e1 * t11418 * t3647 + 0.18e2 * t11418 * t3672 + 0.18e2 * t11414 * t3707 - 0.18e2 * t11404 + 0.18e2 * t11406 + 0.18e2 * t11398 - 0.18e2 * t11401 - 0.18e2 * t11394 - 0.18e2 * t11457 * t3830 + 0.3e1 * t11561 * t3591 + 0.6e1 * t11561 * t3598 + 0.11e2 * t11566 * t3605 + 0.3e1 * t11566 * t3602 - 0.3e1 * t11533 * t413 - 0.6e1 * t11476 * t3758 - 0.12e2 * t11476 * t3741 + 0.7e1 * t11483 * t3777 - 0.9e1 * t2929 + 0.4e1 * t2918 + 0.4e1 * t2920 + 0.4e1 * t2914 + 0.4e1 * t2912 - 0.6e1 * t163 * t11417 * t3647 + 0.6e1 * t1038 * t11409 * t3609);
  t11601 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (t11595 * t59 + 0.4e1 * t260 * t2969));
  tv4sigma40 = t8 * t11601;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 13] += tv4sigma413;

  t11609 = t850 * t843;
  t11611 = t560 * t11609 * t584;
  t11612 = t11611 * t1509;
  t11615 = t242 * t4464 * t850;
  t11616 = t2446 * t11615;
  t11618 = t11611 * t1500;
  t11620 = t843 * t843;
  t11621 = t11620 * t563;
  t11622 = t234 * t11621;
  t11625 = t7075 * t3169;
  t11628 = t11620 * t584;
  t11632 = t2390 * t7184;
  t11635 = t1445 * t1446 * t850;
  t11636 = t2368 * t11635;
  t11638 = t560 * t11621;
  t11641 = t1783 * t3038;
  t11642 = t2364 * t11641;
  t11644 = t2390 * t11635;
  t11647 = t1437 * t1456 * t850;
  t11648 = t2390 * t11647;
  t11650 = t2385 * t7196;
  t11652 = t1429 * t11621;
  t11656 = t234 * t11609 * t1861;
  t11660 = 0.18e2 * t11628 * t5503 * t560 + 0.18e2 * t11638 * t4421 - 0.18e2 * t11652 * t4421 + 0.18e2 * t11652 * t4447 + 0.18e2 * t11632 + 0.18e2 * t11636 - 0.18e2 * t11642 - 0.18e2 * t11644 - 0.12e2 * t11648 + 0.18e2 * t11650 + 0.18e2 * t11656;
  t11663 = t1437 * t1456 * t584;
  t11667 = t1460 * t242 * t850;
  t11668 = t2390 * t11667;
  t11672 = t2364 * t11667;
  t11674 = t2368 * t11667;
  t11680 = t2390 * t7140;
  t11684 = t2390 * t7321;
  t11687 = t11620 * t4489;
  t11688 = t4509 * t11687;
  t11691 = t234 * t11687;
  t11693 = t560 * t11687;
  t11696 = t1429 * t11687;
  t11712 = -0.6e1 * t11688 * t4542 - 0.6e1 * t11688 * t4601 - t11688 * t4649 + 0.6e1 * t11691 * t4643 + t11691 * t4649 - 0.7e1 * t11693 * t4563 - 0.18e2 * t11693 * t4643 - 0.7e1 * t11693 * t4649 + 0.12e2 * t11696 * t4546 + 0.18e2 * t11696 * t4563 + 0.6e1 * t11696 * t4649;
  t11717 = t11620 * t4475;
  t11725 = t850 * t850;
  t11726 = t11725 * t563;
  t11727 = t560 * t11726;
  t11729 = 0.3e1 * t11727 * t577;
  t11731 = 0.3e1 * t11727 * t594;
  t11734 = 0.3e1 * t234 * t11726 * t577;
  t11758 = t560 * t11717;
  t11762 = t1783 * t9394;
  t11767 = -0.12e2 * t11628 * t11762 * t234 - 0.12e2 * t11688 * t4546 - 0.6e1 * t11688 * t4554 + 0.18e2 * t11688 * t4557 - 0.7e1 * t11688 * t4563 + 0.11e2 * t11688 * t4570 + 0.7e1 * t11688 * t4583 - 0.11e2 * t11693 * t4583 + 0.6e1 * t11696 * t4643 - 0.3e1 * t11758 * t577 - 0.3e1 * t11758 * t594;
  t11769 = t2368 * t7300;
  t11775 = t7072 * t3142;
  t11779 = t234 * t11620;
  t11784 = t560 * t11620;
  t11793 = t234 * t11725;
  t11795 = 0.3e1 * t11793 * t588;
  t11797 = 0.3e1 * t11793 * t586;
  t11800 = 0.3e1 * t560 * t11725 * t571;
  t11807 = t11795 - t11797 + t11800 - 0.4e1 * t3026 - 0.4e1 * t3029 - 0.4e1 * t3031 - 0.4e1 * t3033 + 0.4e1 * t3036 + 0.4e1 * t3040 - t852 - t854;
  t11811 = my_piecewise5(t114, 0, t115, 0, t11807 - 0.12e2 * t11775 + t11767 - 0.18e2 * t11769 - t11731 + t11734 - t11729 + t11712 - 0.6e1 * t11684 + 0.18e2 * t11680 - 0.6e1 * t11672 + 0.18e2 * t11674 - 0.6e1 * t11668 + t11660 + 0.18e2 * t11625 - 0.18e2 * t11618 - 0.18e2 * t11612 + 0.18e2 * t11616 + 0.18e2 * t11652 * t4411 - 0.6e1 * t11622 * t4371 + 0.18e2 * t11638 * t4371 - 0.6e1 * t11652 * t4371 - 0.18e2 * t11622 * t4367 + 0.3e1 * t11784 * t4497 - 0.12e2 * t11696 * t4542 - 0.18e2 * t11638 * t4626 + 0.6e1 * t11779 * t4493 + 0.3e1 * t11779 * t4477 + 0.11e2 * t11784 * t4504 - 0.6e1 * t11652 * t4615 - 0.11e2 * t11693 * t4630 + 0.7e1 * t11693 * t4588 - 0.18e2 * t11696 * t4588 + 0.11e2 * t11691 * t4630 - 0.6e1 * t11696 * t4557 - 0.12e2 * t11652 * t11663 + 0.4e1 * t3007 + 0.4e1 * t3001 + 0.4e1 * t3003 - 0.9e1 * t2997 + 0.4e1 * t2988 + 0.3e1 * t234 * t11717 * t577 + t4509 * t11620 * t4515 + 0.6e1 * t1429 * t11620 * t4501);
  t11817 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * (t113 * t11811 + 0.4e1 * t278 * t3044));
  tv4sigma414 = t8 * t11817;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 14] += tv4sigma414;

  t11826 = t171 * t8887;
  t11827 = t2507 * t11826;
  t11828 = 0.9e1 * t11827;
  t11829 = t2502 * t11826;
  t11830 = 0.9e1 * t11829;
  t11831 = t8877 * t2503;
  t11832 = t2502 * t11831;
  t11833 = 0.9e1 * t11832;
  t11834 = t3056 - t3360 + t3069 + t2915 + t2921 - t8862 - t877 - 0.4e1 * t3076 + 0.4e1 * t3081 - 0.4e1 * t3083 - t11828 + t11830 + t11833;
  t11835 = t2514 * t11831;
  t11836 = 0.3e1 * t11835;
  t11837 = t8877 * t263;
  t11838 = t389 * t11837;
  t11839 = t2502 * t11838;
  t11840 = 0.9e1 * t11839;
  t11841 = t2507 * t11831;
  t11842 = 0.3e1 * t11841;
  t11844 = t2524 * t389 * t9715;
  t11845 = 0.9e1 * t11844;
  t11849 = t394 * t1100 * t824;
  t11850 = t2511 * t11849;
  t11851 = 0.9e1 * t11850;
  t11852 = t298 * t2903;
  t11853 = t11852 * t403;
  t11854 = t379 * t11853;
  t11857 = t1038 * t11853;
  t11870 = t2514 * t1136 * t11837;
  t11871 = 0.6e1 * t11870;
  t11872 = t2514 * t11838;
  t11873 = 0.9e1 * t11872;
  t11876 = -0.6e1 * t1051 * t171 * t2903 * t403 * t5721 + 0.18e2 * t11854 * t3664 + 0.18e2 * t11854 * t3707 - 0.6e1 * t11857 * t3664 - 0.12e2 * t11857 * t3685 + 0.18e2 * t5766 * t8901 + 0.18e2 * t5771 * t8901 - t11836 + t11840 - t11842 + t11845 + t11851 - t11871 - t11873;
  t11878 = t8892 * t7425;
  t11879 = 0.9e1 * t11878;
  t11887 = t8892 * t7543;
  t11888 = 0.9e1 * t11887;
  t11893 = t394 * t170 * t3236;
  t11894 = t9716 * t11893;
  t11895 = 0.9e1 * t11894;
  t11896 = t9719 * t11893;
  t11897 = 0.9e1 * t11896;
  t11898 = t4956 * t824;
  t11900 = t2546 * t2556 * t11898;
  t11901 = 0.9e1 * t11900;
  t11906 = -0.18e2 * t11853 * t163 * t3680 + 0.18e2 * t11854 * t3680 - 0.18e2 * t11857 * t3707 + 0.7e1 * t5800 * t9018 + 0.18e2 * t5926 * t9018 - 0.9e1 * t11394 + 0.9e1 * t11398 - 0.9e1 * t11401 + t11879 + t11888 + t11895 - t11897 - t11901;
  t11909 = t3746 * t2903 * t1059 * t1062;
  t11918 = t1620 * t9806;
  t11919 = 0.3e1 * t11918;
  t11926 = t1938 * t1050 * t878 * t824;
  t11927 = 0.6e1 * t11926;
  t11930 = t1617 * t9802;
  t11931 = 0.9e1 * t11930;
  t11934 = t3746 * t2903 * t386 * t388;
  t11940 = t2903 * t74 * t170;
  t11941 = t3855 * t11940;
  t11948 = -0.6e1 * t2903 * t3750 * t3751 * t5795 - 0.12e2 * t11909 * t5795 - 0.7e1 * t11934 * t5789 - 0.7e1 * t11934 * t5795 + 0.6e1 * t11941 * t5785 - 0.18e2 * t11941 * t5789 + 0.6e1 * t11941 * t5792 - 0.12e2 * t5804 * t8987 - 0.6e1 * t5851 * t9018 - 0.6e1 * t5899 * t9023 + 0.11e2 * t5920 * t9018 - t11919 - t11927 - t11931;
  t11951 = t3746 * t11940;
  t11971 = 0.12e2 * t11909 * t5792 + 0.18e2 * t11934 * t5792 + t11951 * t5785 - 0.7e1 * t11951 * t5789 + 0.6e1 * t11951 * t5792 - t11951 * t5795 - 0.6e1 * t5804 * t9018 - 0.18e2 * t5870 * t8987 - 0.9e1 * t11404 + 0.9e1 * t11406 + 0.9e1 * t11428 - 0.3e1 * t11432 + 0.9e1 * t11438;
  t11982 = t170 * t2903;
  t11990 = t163 * t11852;
  t11994 = 0.6e1 * t11982 * t3826 * t5785 + 0.3e1 * t11990 * t3591 + 0.6e1 * t5956 * t8987 + t5959 * t9018 + 0.11e2 * t5977 * t8997 + 0.3e1 * t733 * t8992 + 0.9e1 * t11440 - 0.6e1 * t11444 + 0.9e1 * t11446 - 0.9e1 * t11450 + 0.9e1 * t11452 - 0.3e1 * t11464 + 0.9e1 * t11466 - 0.3e1 * t11470;
  t11999 = t3826 * t11982 * params->csk_a;
  t12004 = t379 * t11852;
  t12022 = -0.11e2 * t1068 * t2903 * t3773 * t5789 + 0.3e1 * t11990 * t4799 - 0.12e2 * t11990 * t4807 + 0.11e2 * t11999 * t5785 - 0.11e2 * t11999 * t5789 - 0.3e1 * t12004 * t4799 - 0.3e1 * t12004 * t4812 - 0.6e1 * t5792 * t9099 - 0.18e2 * t5812 * t8972 + 0.7e1 * t5870 * t8997 + t11498 - t11501 - 0.9e1 * t11517;
  t12026 = -0.6e1 * t11547 - t11560 - t11576 + t11580 + t11582 - t3087 + t3095 + 0.4e1 * t3114 + 0.4e1 * t3117 - t3119 - t2952 + t2962 - t2964 - t826;
  t12030 = my_piecewise5(t64, 0, t67, 0, t11834 + t11876 + t11906 + t11948 + t11971 + t11994 + t12022 + t12026);
  t12036 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (t52 * t291 * t2969 / 0.24e2 + 0.3e1 * t260 * t3127 + t59 * t12030));
  tv4sigma3lapl0 = t8 * t12036;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3lapl1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 1] += tv4sigma3lapl1;

  tv4sigma3lapl2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 2] += tv4sigma3lapl2;

  tv4sigma3lapl3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 3] += tv4sigma3lapl3;

  tv4sigma3lapl4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 4] += tv4sigma3lapl4;

  tv4sigma3lapl5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 5] += tv4sigma3lapl5;

  tv4sigma3lapl6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 6] += tv4sigma3lapl6;

  tv4sigma3lapl7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 7] += tv4sigma3lapl7;

  tv4sigma3lapl8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 8] += tv4sigma3lapl8;

  tv4sigma3lapl9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 9] += tv4sigma3lapl9;

  tv4sigma3lapl10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 10] += tv4sigma3lapl10;

  tv4sigma3lapl11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 11] += tv4sigma3lapl11;

  tv4sigma3lapl12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 12] += tv4sigma3lapl12;

  tv4sigma3lapl13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 13] += tv4sigma3lapl13;

  tv4sigma3lapl14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 14] += tv4sigma3lapl14;

  tv4sigma3lapl15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 15] += tv4sigma3lapl15;

  tv4sigma3lapl16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 16] += tv4sigma3lapl16;

  tv4sigma3lapl17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 17] += tv4sigma3lapl17;

  tv4sigma3lapl18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 18] += tv4sigma3lapl18;

  t12046 = t242 * t9203 * t281;
  t12047 = t2622 * t12046;
  t12048 = 0.9e1 * t12047;
  t12049 = t2617 * t12046;
  t12050 = 0.9e1 * t12049;
  t12051 = t315 * t2978;
  t12052 = t12051 * t584;
  t12056 = -0.18e2 * t12052 * t234 * t5503 - t12048 + t12050 + t2989 + t3004 + t3147 + t3148 - 0.4e1 * t3159 + 0.4e1 * t3164 - 0.4e1 * t3166 - t3427 - t903 - t9197;
  t12057 = t560 * t12052;
  t12060 = t9254 * t8035;
  t12061 = 0.9e1 * t12060;
  t12062 = t1429 * t12052;
  t12065 = t9254 * t7921;
  t12066 = 0.9e1 * t12065;
  t12070 = t575 * t1482 * t850;
  t12071 = t2635 * t12070;
  t12072 = 0.9e1 * t12071;
  t12074 = t2641 * t570 * t9912;
  t12075 = 0.9e1 * t12074;
  t12078 = t9248 * t2618;
  t12079 = t2617 * t12078;
  t12080 = 0.9e1 * t12079;
  t12081 = t2625 * t12078;
  t12082 = 0.3e1 * t12081;
  t12083 = t9248 * t281;
  t12084 = t570 * t12083;
  t12085 = t2617 * t12084;
  t12086 = 0.9e1 * t12085;
  t12087 = t2622 * t12078;
  t12088 = 0.3e1 * t12087;
  t12093 = 0.18e2 * t12057 * t4388 + 0.18e2 * t12057 * t5503 - 0.6e1 * t12062 * t4388 - 0.18e2 * t12062 * t4417 - 0.12e2 * t12062 * t4451 + 0.18e2 * t6356 * t9210 + t12061 + t12066 + t12072 + t12075 + t12080 - t12082 + t12086 - t12088;
  t12105 = t2625 * t1521 * t12083;
  t12106 = 0.6e1 * t12105;
  t12107 = t2625 * t12084;
  t12108 = 0.9e1 * t12107;
  t12113 = t575 * t241 * t3343;
  t12114 = t9936 * t12113;
  t12115 = 0.9e1 * t12114;
  t12116 = t9913 * t12113;
  t12117 = 0.9e1 * t12116;
  t12118 = t4457 * t850;
  t12120 = t2661 * t2671 * t12118;
  t12121 = 0.9e1 * t12120;
  t12124 = -0.6e1 * t1051 * t242 * t2978 * t584 * t6307 + 0.18e2 * t12057 * t4417 + 0.18e2 * t6363 * t9210 - 0.9e1 * t11612 + 0.9e1 * t11616 - 0.9e1 * t11618 + 0.9e1 * t11625 + 0.9e1 * t11632 - t12106 - t12108 + t12115 - t12117 - t12121;
  t12137 = t234 * t12051;
  t12143 = 0.3e1 * t12137 * t4477 + 0.11e2 * t6397 * t9304 + 0.6e1 * t6404 * t9389 + t6407 * t9319 + 0.9e1 * t11636 - 0.9e1 * t11642 - 0.9e1 * t11644 - 0.6e1 * t11648 + 0.9e1 * t11650 + 0.9e1 * t11656 - 0.3e1 * t11668 - 0.3e1 * t11672 + 0.9e1 * t11674 + 0.9e1 * t11680;
  t12146 = t241 * t2978;
  t12157 = t4648 * t2978 * t567 * t569;
  t12168 = t560 * t12051;
  t12171 = -0.11e2 * t1446 * t2978 * t4561 * t6185 + 0.6e1 * t12146 * t5299 * t6162 + 0.3e1 * t12137 * t5306 - 0.7e1 * t12157 * t6198 - 0.3e1 * t12168 * t5306 + 0.7e1 * t6273 * t9319 + 0.3e1 * t787 * t9386 - 0.3e1 * t11684 - t11729 - t11731 + t11734 - 0.9e1 * t11769 - 0.6e1 * t11775;
  t12173 = t2978 * t122 * t241;
  t12174 = t4648 * t12173;
  t12183 = t4541 * t4545 * t2978;
  t12188 = t4642 * t12173;
  t12206 = -0.6e1 * t2978 * t4552 * t4553 * t6198 - 0.7e1 * t12157 * t6185 + 0.18e2 * t12157 * t6195 + t12174 * t6162 - 0.7e1 * t12174 * t6185 + 0.6e1 * t12174 * t6195 - t12174 * t6198 + 0.12e2 * t12183 * t6195 + 0.6e1 * t12188 * t6162 - 0.18e2 * t12188 * t6185 + 0.6e1 * t12188 * t6195 - 0.6e1 * t6165 * t9319 + 0.11e2 * t6216 * t9319 - 0.18e2 * t6234 * t9389;
  t12212 = t1807 * t10182;
  t12213 = 0.3e1 * t12212;
  t12220 = t2115 * t1783 * t904 * t850;
  t12221 = 0.6e1 * t12220;
  t12224 = t1816 * t10178;
  t12225 = 0.9e1 * t12224;
  t12229 = t5299 * t12146 * params->csk_a;
  t12238 = -0.3e1 * t12168 * t5370 - 0.12e2 * t12183 * t6198 + 0.11e2 * t12229 * t6162 - 0.11e2 * t12229 * t6185 - 0.12e2 * t6165 * t9389 + 0.18e2 * t6189 * t9319 - 0.6e1 * t6195 * t9316 + 0.7e1 * t6234 * t9304 - 0.6e1 * t6240 * t9319 - 0.6e1 * t6375 * t9359 - t12213 - t12221 - t12225;
  t12245 = -0.12e2 * t12137 * t5316 - 0.18e2 * t6175 * t9413 + t11795 - t11797 + t11800 - t3027 - t3032 + t3041 + 0.4e1 * t3182 - t3184 - t3192 + t3199 + 0.4e1 * t3204 - t852;
  t12249 = my_piecewise5(t114, 0, t115, 0, t12056 + t12093 + t12124 + t12143 + t12171 + t12206 + t12238 + t12245);
  t12255 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * (t52 * t308 * t3044 / 0.24e2 + 0.3e1 * t278 * t3211 + t113 * t12249));
  tv4sigma3lapl19 = t8 * t12255;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 19] += tv4sigma3lapl19;

  tv4sigma3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 1] += tv4sigma3tau1;

  tv4sigma3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 2] += tv4sigma3tau2;

  tv4sigma3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 3] += tv4sigma3tau3;

  tv4sigma3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 4] += tv4sigma3tau4;

  tv4sigma3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 5] += tv4sigma3tau5;

  tv4sigma3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 6] += tv4sigma3tau6;

  tv4sigma3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 7] += tv4sigma3tau7;

  tv4sigma3tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 8] += tv4sigma3tau8;

  tv4sigma3tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 9] += tv4sigma3tau9;

  tv4sigma3tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 10] += tv4sigma3tau10;

  tv4sigma3tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 11] += tv4sigma3tau11;

  tv4sigma3tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 12] += tv4sigma3tau12;

  tv4sigma3tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 13] += tv4sigma3tau13;

  tv4sigma3tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 14] += tv4sigma3tau14;

  tv4sigma3tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 15] += tv4sigma3tau15;

  tv4sigma3tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 16] += tv4sigma3tau16;

  tv4sigma3tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 17] += tv4sigma3tau17;

  tv4sigma3tau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 18] += tv4sigma3tau18;

  tv4sigma3tau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 19] += tv4sigma3tau19;

  t12264 = t2739 * t8886 * t1114;
  t12267 = t2739 * t389 * t11898;
  t12269 = t2744 * t11397;
  t12274 = t171 * t820 * params->csk_a;
  t12280 = t9530 * t171 * t403;
  t12283 = -0.18e2 * t12274 * t8277 + 0.18e2 * t12274 * t8282 - 0.6e1 * t12280 * t8249 + 0.18e2 * t6759 * t8249 - t10897 - 0.3e1 * t12264 - 0.3e1 * t12267 + 0.3e1 * t12269 - t2930 + t3070 + t3071 + t3228 + t3230 + 0.4e1 * t3234 - 0.4e1 * t3238;
  t12284 = t9530 * t403;
  t12285 = t389 * t12284;
  t12309 = -0.12e2 * t1136 * t12284 * t8249 + 0.18e2 * t11400 * t8249 + 0.18e2 * t12280 * t8271 - 0.6e1 * t12280 * t8293 - 0.18e2 * t12285 * t8249 + 0.18e2 * t12285 * t8271 - 0.12e2 * t11827 + 0.12e2 * t11829 + 0.12e2 * t11832 - 0.4e1 * t11835 + 0.12e2 * t11839 - 0.4e1 * t11841 + 0.12e2 * t11844 + 0.12e2 * t11850 - 0.8e1 * t11870 - 0.12e2 * t11872;
  t12326 = 0.12e2 * t11878 + 0.12e2 * t11887 - 0.3e1 * t11394 + 0.3e1 * t11398 - 0.3e1 * t11401 + 0.12e2 * t11894 - 0.12e2 * t11896 - 0.12e2 * t11900 - 0.4e1 * t11918 - 0.8e1 * t11926 - 0.12e2 * t11930 - 0.3e1 * t11404 + 0.3e1 * t11406 + 0.3e1 * t11428 - t11432 + 0.3e1 * t11438;
  t12334 = t2720 * t1050 * t3067;
  t12339 = t2717 * t6823;
  t12346 = t922 * t817;
  t12353 = t6605 * t2735;
  t12355 = 0.11e2 * t10490 * t3773 * t6523 + 0.3e1 * t12346 * t3602 * t379 + 0.6e1 * t3063 * t3826 * t8306 + 0.3e1 * t3063 * t394 * t8476 + t6488 * t8469 + 0.6e1 * t6527 * t8449 + 0.3e1 * t11440 - 0.2e1 * t11444 + 0.3e1 * t11446 - 0.3e1 * t11450 + 0.3e1 * t11452 - t11464 + 0.3e1 * t11466 - 0.2e1 * t12334 - 0.3e1 * t12339 - t12353;
  t12361 = t3746 * t389 * t817;
  t12372 = t3855 * t3101;
  t12385 = t2749 * t11431;
  t12386 = t2717 * t11403;
  t12388 = t2749 * t6675;
  t12390 = t2720 * t11431;
  t12391 = -0.12e2 * t1050 * t11426 * t926 + 0.3e1 * t12346 * t163 * t4799 - 0.6e1 * t3088 * t3740 * t8312 - 0.3e1 * t411 * t6625 * t8424 - 0.7e1 * t12361 * t8360 + 0.6e1 * t12372 * t8312 - 0.18e2 * t6612 * t931 - 0.11e2 * t6634 * t8309 + 0.7e1 * t6634 * t8360 - 0.3e1 * t8424 * t9599 - t11470 - t12385 + 0.3e1 * t12386 + 0.3e1 * t12388 - t12390;
  t12392 = t2717 * t11431;
  t12394 = t2717 * t11437;
  t12396 = t2775 * t11849;
  t12398 = t2720 * t11403;
  t12400 = t2749 * t11443;
  t12408 = t2782 * t6684;
  t12415 = t2749 * t6573;
  t12421 = t2749 * t11437;
  t12428 = t3746 * t1136 * t817;
  t12431 = 0.18e2 * t1051 * t2734 * t3740 * t6488 - 0.6e1 * t3750 * t3751 * t817 * t8360 - 0.6e1 * t1038 * t820 * t8345 - 0.12e2 * t12428 * t8360 - 0.6e1 * t6488 * t8322 + 0.11e2 * t6488 * t8404 - 0.12e2 * t6500 * t8312 + 0.7e1 * t6626 * t8309 + 0.3e1 * t12392 + 0.3e1 * t12394 + 0.3e1 * t12396 - 0.3e1 * t12398 - 0.2e1 * t12400 + 0.3e1 * t12408 + 0.3e1 * t12415 - 0.3e1 * t12421;
  t12433 = t3746 * t3101;
  t12454 = t3826 * t9598;
  t12460 = -0.7e1 * t12361 * t8309 + 0.18e2 * t12361 * t8312 + 0.6e1 * t12372 * t8306 - 0.18e2 * t12372 * t8309 + 0.12e2 * t12428 * t8312 + t12433 * t8306 - 0.7e1 * t12433 * t8309 + 0.6e1 * t12433 * t8312 - t12433 * t8360 + 0.11e2 * t12454 * t8306 - 0.11e2 * t12454 * t8309 - 0.6e1 * t6488 * t8414 - 0.18e2 * t6626 * t8312 + t11498 - t11501 - 0.3e1 * t11517;
  t12465 = -0.2e1 * t11547 - t11560 - t11576 + t11580 + t11582 + 0.4e1 * t3260 + 0.4e1 * t3268 - t3272 + t3273 - t3274 - t3122 + t3123 - t3124 - t826 - t929 - 0.4e1 * t3276;
  t12469 = my_piecewise5(t64, 0, t67, 0, t12283 + t12309 + t12326 + t12355 + t12391 + t12431 + t12460 + t12465);
  t12475 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (t52 * t291 * t3127 / 0.12e2 + 0.2e1 * t260 * t3280 + t59 * t12469));
  tv4sigma2lapl20 = t8 * t12475;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapl21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 1] += tv4sigma2lapl21;

  tv4sigma2lapl22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 2] += tv4sigma2lapl22;

  tv4sigma2lapl23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 3] += tv4sigma2lapl23;

  tv4sigma2lapl24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 4] += tv4sigma2lapl24;

  tv4sigma2lapl25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 5] += tv4sigma2lapl25;

  tv4sigma2lapl26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 6] += tv4sigma2lapl26;

  tv4sigma2lapl27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 7] += tv4sigma2lapl27;

  tv4sigma2lapl28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 8] += tv4sigma2lapl28;

  tv4sigma2lapl29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 9] += tv4sigma2lapl29;

  tv4sigma2lapl210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 10] += tv4sigma2lapl210;

  tv4sigma2lapl211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 11] += tv4sigma2lapl211;

  tv4sigma2lapl212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 12] += tv4sigma2lapl212;

  tv4sigma2lapl213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 13] += tv4sigma2lapl213;

  tv4sigma2lapl214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 14] += tv4sigma2lapl214;

  tv4sigma2lapl215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 15] += tv4sigma2lapl215;

  tv4sigma2lapl216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 16] += tv4sigma2lapl216;

  t12482 = t242 * t846 * params->csk_a;
  t12487 = t9957 * t584;
  t12488 = t570 * t12487;
  t12494 = t242 * t12487;
  t12506 = -0.12e2 * t12487 * t1521 * t8606 + 0.18e2 * t3162 * t570 * t8606 - 0.18e2 * t12482 * t8617 + 0.18e2 * t12482 * t8620 - 0.18e2 * t12488 * t8606 + 0.18e2 * t12488 * t8643 - 0.6e1 * t12494 * t8606 - 0.6e1 * t12494 * t8638 + 0.18e2 * t12494 * t8643 - t11153 - t2998 + t3153 + t3155 + t3297 + t3298;
  t12508 = t2844 * t9203 * t1499;
  t12511 = t2844 * t570 * t12118;
  t12513 = t2849 * t11615;
  t12530 = 0.18e2 * t1521 * t3162 * t8606 - 0.12e2 * t12047 + 0.12e2 * t12049 + 0.12e2 * t12060 + 0.12e2 * t12065 + 0.12e2 * t12071 + 0.12e2 * t12074 + 0.12e2 * t12079 - 0.4e1 * t12081 + 0.12e2 * t12085 - 0.4e1 * t12087 - 0.8e1 * t12105 - 0.12e2 * t12107 - 0.3e1 * t12508 - 0.3e1 * t12511 + 0.3e1 * t12513;
  t12546 = -0.3e1 * t11612 + 0.3e1 * t11616 - 0.3e1 * t11618 + 0.12e2 * t12114 - 0.12e2 * t12116 - 0.12e2 * t12120 + 0.3e1 * t11625 + 0.3e1 * t11632 + 0.3e1 * t11636 - 0.3e1 * t11642 - 0.3e1 * t11644 - 0.2e1 * t11648 + 0.3e1 * t11650 + 0.3e1 * t11656 - t11668 - t11672;
  t12552 = t7066 * t2835;
  t12555 = t2826 * t1783 * t3145;
  t12559 = t2829 * t7300;
  t12566 = t945 * t843;
  t12571 = 0.3e1 * t12566 * t4497 * t560 + 0.6e1 * t3141 * t5299 * t8700 + 0.3e1 * t3141 * t575 * t8833 + 0.11e2 * t7042 * t8810 + 0.6e1 * t7050 * t8815 + t7062 * t8821 + 0.3e1 * t11674 + 0.3e1 * t11680 - t11684 - t11729 - t11731 + t11734 - 0.3e1 * t11769 - t12552 - 0.2e1 * t12555 - 0.3e1 * t12559;
  t12582 = t4648 * t3186;
  t12586 = t4561 * t1446 * t843;
  t12591 = t4642 * t10081;
  t12599 = t593 * t843;
  t12607 = t2829 * t11667;
  t12609 = -0.12e2 * t1783 * t3141 * t584 * t949 + 0.3e1 * t12566 * t234 * t5306 - 0.3e1 * t12599 * t592 * t8780 - 0.7e1 * t12582 * t8697 + 0.7e1 * t12586 * t8697 - 0.11e2 * t12586 * t8703 + 0.6e1 * t12591 * t8661 - 0.18e2 * t7155 * t954 - 0.6e1 * t7192 * t8661 - 0.3e1 * t8780 * t9954 - 0.2e1 * t11775 - 0.4e1 * t12212 - 0.8e1 * t12220 - 0.12e2 * t12224 + 0.3e1 * t12607;
  t12610 = t2859 * t11667;
  t12611 = t2829 * t11641;
  t12613 = t2859 * t7140;
  t12615 = t2826 * t11667;
  t12616 = t2829 * t11635;
  t12618 = t2887 * t12070;
  t12620 = t2826 * t11641;
  t12622 = t2859 * t11647;
  t12630 = t2866 * t7196;
  t12637 = t2859 * t7184;
  t12641 = t4561 * t12599;
  t12644 = -0.6e1 * t4552 * t4553 * t843 * t8697 - 0.6e1 * t1429 * t846 * t8655 + 0.7e1 * t12641 * t8703 - 0.6e1 * t7062 * t8668 + 0.11e2 * t7062 * t8709 - 0.12e2 * t7137 * t8661 - t12610 + 0.3e1 * t12611 + 0.3e1 * t12613 - t12615 + 0.3e1 * t12616 + 0.3e1 * t12618 - 0.3e1 * t12620 - 0.2e1 * t12622 + 0.3e1 * t12630 + 0.3e1 * t12637;
  t12646 = t2859 * t11635;
  t12651 = t4648 * t1521 * t843;
  t12662 = t5299 * t3168;
  t12674 = t5299 * t9435 * t843;
  t12681 = 0.18e2 * t12582 * t8661 - 0.7e1 * t12582 * t8703 + 0.6e1 * t12591 * t8700 - 0.18e2 * t12591 * t8703 - 0.18e2 * t12641 * t8661 + 0.12e2 * t12651 * t8661 - 0.12e2 * t12651 * t8697 + 0.11e2 * t12662 * t8700 - 0.11e2 * t12662 * t8703 + 0.6e1 * t12674 * t8661 - t12674 * t8697 + t12674 * t8700 - 0.7e1 * t12674 * t8703 + 0.18e2 * t7062 * t8735 - 0.6e1 * t7062 * t8763 - 0.3e1 * t12646;
  t12687 = -0.4e1 * t3302 + t11795 - t11797 + t11800 - t952 + 0.4e1 * t3308 + 0.4e1 * t3318 - t3336 - t3337 + t3338 - t3206 - t3207 + t3208 - t852 + 0.4e1 * t3341 - 0.4e1 * t3345;
  t12691 = my_piecewise5(t114, 0, t115, 0, t12506 + t12530 + t12546 + t12571 + t12609 + t12644 + t12681 + t12687);
  t12697 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * (t52 * t308 * t3211 / 0.12e2 + 0.2e1 * t278 * t3349 + t113 * t12691));
  tv4sigma2lapl217 = t8 * t12697;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 17] += tv4sigma2lapl217;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2lapltau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 1] += tv4sigma2lapltau1;

  tv4sigma2lapltau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 2] += tv4sigma2lapltau2;

  tv4sigma2lapltau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 3] += tv4sigma2lapltau3;

  tv4sigma2lapltau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 4] += tv4sigma2lapltau4;

  tv4sigma2lapltau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 5] += tv4sigma2lapltau5;

  tv4sigma2lapltau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 6] += tv4sigma2lapltau6;

  tv4sigma2lapltau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 7] += tv4sigma2lapltau7;

  tv4sigma2lapltau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 8] += tv4sigma2lapltau8;

  tv4sigma2lapltau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 9] += tv4sigma2lapltau9;

  tv4sigma2lapltau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 10] += tv4sigma2lapltau10;

  tv4sigma2lapltau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 11] += tv4sigma2lapltau11;

  tv4sigma2lapltau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 12] += tv4sigma2lapltau12;

  tv4sigma2lapltau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 13] += tv4sigma2lapltau13;

  tv4sigma2lapltau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 14] += tv4sigma2lapltau14;

  tv4sigma2lapltau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 15] += tv4sigma2lapltau15;

  tv4sigma2lapltau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 16] += tv4sigma2lapltau16;

  tv4sigma2lapltau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 17] += tv4sigma2lapltau17;

  tv4sigma2lapltau18 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 18] += tv4sigma2lapltau18;

  tv4sigma2lapltau19 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 19] += tv4sigma2lapltau19;

  tv4sigma2lapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 20] += tv4sigma2lapltau20;

  tv4sigma2lapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 21] += tv4sigma2lapltau21;

  tv4sigma2lapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 22] += tv4sigma2lapltau22;

  tv4sigma2lapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 23] += tv4sigma2lapltau23;

  tv4sigma2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigma2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 1] += tv4sigma2tau21;

  tv4sigma2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 2] += tv4sigma2tau22;

  tv4sigma2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 3] += tv4sigma2tau23;

  tv4sigma2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 4] += tv4sigma2tau24;

  tv4sigma2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 5] += tv4sigma2tau25;

  tv4sigma2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 6] += tv4sigma2tau26;

  tv4sigma2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 7] += tv4sigma2tau27;

  tv4sigma2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 8] += tv4sigma2tau28;

  tv4sigma2tau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 9] += tv4sigma2tau29;

  tv4sigma2tau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 10] += tv4sigma2tau210;

  tv4sigma2tau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 11] += tv4sigma2tau211;

  tv4sigma2tau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 12] += tv4sigma2tau212;

  tv4sigma2tau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 13] += tv4sigma2tau213;

  tv4sigma2tau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 14] += tv4sigma2tau214;

  tv4sigma2tau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 15] += tv4sigma2tau215;

  tv4sigma2tau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 16] += tv4sigma2tau216;

  tv4sigma2tau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 17] += tv4sigma2tau217;

  t12703 = t878 * t403;
  t12704 = t8914 * t12703;
  t12710 = -0.6e1 * t11086 * t12704 - t11828 + t11830 - 0.9e1 * t12264 - 0.9e1 * t12267 + 0.9e1 * t12269 + t2914 + t2920 - t2929 - 0.8e1 * t3060 + t3234 - t3238 + t3359 + t3361;
  t12711 = t11833 - t11836 + t11840 - t11842 + t11845 + t11851 - t11871 - t11873 + t11879 + t11888 + t11895 - t11897 - t11901 - t11919;
  t12723 = t3362 * t263;
  t12733 = 0.6e1 * t10926 * t3826 * t878 + 0.3e1 * t12723 * t3602 * t379 + 0.3e1 * t11048 * t879 + t11053 * t4768 + 0.6e1 * t11057 * t4762 + 0.11e2 * t11066 * t4770 - t11927 - t11931 - 0.6e1 * t12334 - 0.9e1 * t12339 - 0.3e1 * t12353 - 0.3e1 * t12385 + 0.9e1 * t12386 + 0.9e1 * t12388;
  t12751 = t3826 * t872;
  t12756 = -0.6e1 * t10923 * t263 * t3750 * t3751 - 0.11e2 * t10920 * t12751 + 0.11e2 * t10926 * t12751 + 0.11e2 * t10964 * t4768 - 0.6e1 * t10972 * t4768 - 0.3e1 * t12390 + 0.9e1 * t12392 + 0.9e1 * t12394 + 0.9e1 * t12396 - 0.9e1 * t12398 - 0.6e1 * t12400 + 0.9e1 * t12408 + 0.9e1 * t12415 - 0.9e1 * t12421;
  t12759 = t3855 * t2503;
  t12774 = t3826 * t6655 * t263;
  t12787 = t3746 * t3252;
  t12790 = 0.3e1 * t12723 * t163 * t4799 + 0.6e1 * t10917 * t12759 + 0.6e1 * t10917 * t12774 + 0.18e2 * t10917 * t12787 - 0.18e2 * t10917 * t4838 - 0.6e1 * t10917 * t4930 - 0.18e2 * t10920 * t12759 - 0.7e1 * t10920 * t12774 - t10923 * t12774 + 0.6e1 * t10926 * t12759 + t10926 * t12774 - 0.3e1 * t11014 * t873 - 0.3e1 * t11014 * t883 - 0.18e2 * t11027 * t4851;
  t12792 = t3740 * t4819 * t263;
  t12819 = t8967 * t263;
  t12820 = t389 * t12819;
  t12825 = -0.6e1 * t1038 * t11000 * t627 - 0.12e2 * t1050 * t10942 * t12703 + 0.12e2 * t10917 * t12792 - 0.12e2 * t10917 * t4925 - 0.7e1 * t10920 * t12787 - 0.11e2 * t10920 * t4790 + 0.7e1 * t10920 * t4838 - 0.7e1 * t10923 * t12787 - 0.12e2 * t10923 * t12792 + 0.7e1 * t10923 * t4790 - 0.6e1 * t10923 * t4925 + 0.18e2 * t10988 * t4768 + 0.18e2 * t11079 * t12820 + 0.18e2 * t11086 * t5032;
  t12832 = t171 * t8941 * t263;
  t12837 = -0.18e2 * t11076 * t12832 + 0.18e2 * t11079 * t12832 - 0.6e1 * t11107 * t12704 + 0.18e2 * t11110 * t12704 + t11498 - t11501 - t11560 - t11576 + t11580 + t11582 + t3260 - t3374 - t3376 + t3380;
  t12846 = 0.18e2 * t1038 * t11098 * t4972 - 0.12e2 * t11073 * t1136 * t12819 - 0.18e2 * t11073 * t12820 - t2951 + t2961 - t2963 + t3268 - t3276 - t3381 + t3382 - t3383 + t3387 + t3390 - t826 - t929;
  t12850 = my_piecewise5(t64, 0, t67, 0, t12710 + t12711 + t12733 + t12756 + t12790 + t12825 + t12837 + t12846);
  t12856 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (t52 * t291 * t3280 / 0.8e1 + t260 * t3415 + t59 * t12850));
  tv4sigmalapl30 = t8 * t12856;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 1] += tv4sigmalapl31;

  tv4sigmalapl32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 2] += tv4sigmalapl32;

  tv4sigmalapl33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 3] += tv4sigmalapl33;

  tv4sigmalapl34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 4] += tv4sigmalapl34;

  tv4sigmalapl35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 5] += tv4sigmalapl35;

  tv4sigmalapl36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 6] += tv4sigmalapl36;

  tv4sigmalapl37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 7] += tv4sigmalapl37;

  tv4sigmalapl38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 8] += tv4sigmalapl38;

  tv4sigmalapl39 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 9] += tv4sigmalapl39;

  tv4sigmalapl310 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 10] += tv4sigmalapl310;

  t12866 = t5299 * t9435 * t281;
  t12873 = t5299 * t3326;
  t12876 = 0.6e1 * t11173 * t12866 + t11176 * t12866 + 0.6e1 * t11176 * t12873 - 0.7e1 * t11183 * t12866 - t11186 * t12866 - 0.9e1 * t12508 - 0.9e1 * t12511 + 0.9e1 * t12513 + t2988 - t2997 + t3003 - 0.8e1 * t3152 + t3425 + t3426;
  t12878 = t4561 * t4562 * t281;
  t12890 = t4541 * t4545 * t281;
  t12897 = 0.6e1 * t11173 * t12873 + 0.18e2 * t11173 * t12878 + 0.12e2 * t11173 * t12890 - 0.18e2 * t11183 * t12873 - 0.7e1 * t11183 * t12878 - 0.7e1 * t11186 * t12878 - 0.6e1 * t11186 * t5376 + 0.7e1 * t11186 * t5466 - t12048 + t12050 + t12061 + t12066 + t12072 + t12075;
  t12904 = t3428 * t281;
  t12911 = 0.6e1 * t11176 * t5299 * t904 + 0.3e1 * t12904 * t4497 * t560 + 0.6e1 * t11300 * t5293 + t11305 * t5338 + 0.3e1 * t11318 * t905 + t12080 - t12082 + t12086 - t12088 - t12106 - t12108 + t12115 - t12117 - t12121;
  t12921 = 0.11e2 * t11310 * t5287 - t11729 - t11731 + t11734 - t12213 - t12221 - t12225 - 0.3e1 * t12552 - 0.6e1 * t12555 - 0.9e1 * t12559 + 0.9e1 * t12607 - 0.3e1 * t12610 + 0.9e1 * t12611 + 0.9e1 * t12613;
  t12946 = -0.6e1 * t11186 * t281 * t4552 * t4553 - 0.12e2 * t11173 * t5376 - 0.11e2 * t11183 * t5466 + 0.11e2 * t11205 * t5338 - 0.6e1 * t11232 * t5338 - 0.18e2 * t11251 * t704 - 0.3e1 * t12615 + 0.9e1 * t12616 + 0.9e1 * t12618 - 0.9e1 * t12620 - 0.6e1 * t12622 + 0.9e1 * t12630 + 0.9e1 * t12637 - 0.9e1 * t12646;
  t12958 = t5299 * t898;
  t12982 = 0.18e2 * t11360 * t281 * t570 * t9907 - 0.12e2 * t1783 * t281 * t3460 * t9394 - 0.6e1 * t11242 * t1429 * t689 + 0.3e1 * t12904 * t234 * t5306 - 0.6e1 * t11173 * t5379 + 0.11e2 * t11176 * t12958 - 0.11e2 * t11183 * t12958 + 0.7e1 * t11183 * t5348 - 0.12e2 * t11186 * t12890 - 0.18e2 * t11262 * t5293 + 0.18e2 * t11268 * t5338 - 0.3e1 * t11278 * t899 - 0.3e1 * t11278 * t909 + 0.18e2 * t11334 * t5568;
  t12984 = t9223 * t281;
  t12985 = t242 * t12984;
  t13007 = -0.18e2 * t11329 * t242 * t281 * t9945 - 0.12e2 * t11334 * t12984 * t1521 - 0.18e2 * t11334 * t1854 * t6954 + 0.18e2 * t11341 * t1429 * t5493 - 0.6e1 * t11334 * t12985 + 0.18e2 * t11348 * t12985 + 0.18e2 * t11348 * t3340 - 0.6e1 * t11366 * t12985 + t11795 - t11797 + t11800 - t3302 - t3440 - t952;
  t13008 = -t3442 + t3446 + t3308 + t3318 - t3447 - t3448 + t3449 - t3026 - t3031 + t3040 - t852 + t3341 - t3345 + t3462 + t3465;
  t13012 = my_piecewise5(t114, 0, t115, 0, t12876 + t12897 + t12911 + t12921 + t12946 + t12982 + t13007 + t13008);
  t13018 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * (t52 * t308 * t3349 / 0.8e1 + t278 * t3481 + t113 * t13012));
  tv4sigmalapl311 = t8 * t13018;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 11] += tv4sigmalapl311;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapl2tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 1] += tv4sigmalapl2tau1;

  tv4sigmalapl2tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 2] += tv4sigmalapl2tau2;

  tv4sigmalapl2tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 3] += tv4sigmalapl2tau3;

  tv4sigmalapl2tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 4] += tv4sigmalapl2tau4;

  tv4sigmalapl2tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 5] += tv4sigmalapl2tau5;

  tv4sigmalapl2tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 6] += tv4sigmalapl2tau6;

  tv4sigmalapl2tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 7] += tv4sigmalapl2tau7;

  tv4sigmalapl2tau8 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 8] += tv4sigmalapl2tau8;

  tv4sigmalapl2tau9 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 9] += tv4sigmalapl2tau9;

  tv4sigmalapl2tau10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 10] += tv4sigmalapl2tau10;

  tv4sigmalapl2tau11 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 11] += tv4sigmalapl2tau11;

  tv4sigmalapl2tau12 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 12] += tv4sigmalapl2tau12;

  tv4sigmalapl2tau13 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 13] += tv4sigmalapl2tau13;

  tv4sigmalapl2tau14 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 14] += tv4sigmalapl2tau14;

  tv4sigmalapl2tau15 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 15] += tv4sigmalapl2tau15;

  tv4sigmalapl2tau16 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 16] += tv4sigmalapl2tau16;

  tv4sigmalapl2tau17 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 17] += tv4sigmalapl2tau17;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmalapltau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 1] += tv4sigmalapltau21;

  tv4sigmalapltau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 2] += tv4sigmalapltau22;

  tv4sigmalapltau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 3] += tv4sigmalapltau23;

  tv4sigmalapltau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 4] += tv4sigmalapltau24;

  tv4sigmalapltau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 5] += tv4sigmalapltau25;

  tv4sigmalapltau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 6] += tv4sigmalapltau26;

  tv4sigmalapltau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 7] += tv4sigmalapltau27;

  tv4sigmalapltau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 8] += tv4sigmalapltau28;

  tv4sigmalapltau29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 9] += tv4sigmalapltau29;

  tv4sigmalapltau210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 10] += tv4sigmalapltau210;

  tv4sigmalapltau211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 11] += tv4sigmalapltau211;

  tv4sigmalapltau212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 12] += tv4sigmalapltau212;

  tv4sigmalapltau213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 13] += tv4sigmalapltau213;

  tv4sigmalapltau214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 14] += tv4sigmalapltau214;

  tv4sigmalapltau215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 15] += tv4sigmalapltau215;

  tv4sigmalapltau216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 16] += tv4sigmalapltau216;

  tv4sigmalapltau217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 17] += tv4sigmalapltau217;

  tv4sigmatau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 0] += tv4sigmatau30;

  tv4sigmatau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 1] += tv4sigmatau31;

  tv4sigmatau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 2] += tv4sigmatau32;

  tv4sigmatau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 3] += tv4sigmatau33;

  tv4sigmatau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 4] += tv4sigmatau34;

  tv4sigmatau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 5] += tv4sigmatau35;

  tv4sigmatau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 6] += tv4sigmatau36;

  tv4sigmatau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 7] += tv4sigmatau37;

  tv4sigmatau38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 8] += tv4sigmatau38;

  tv4sigmatau39 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 9] += tv4sigmatau39;

  tv4sigmatau310 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 10] += tv4sigmatau310;

  tv4sigmatau311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 11] += tv4sigmatau311;

  t13028 = t922 * t922;
  t13029 = t13028 * t382;
  t13030 = t1038 * t13029;
  t13033 = t13028 * t403;
  t13037 = t379 * t13033;
  t13040 = t163 * t13029;
  t13044 = t379 * t13029;
  t13051 = t1038 * t13033;
  t13058 = t13028 * t3594;
  t13059 = t1038 * t13058;
  t13062 = t379 * t13058;
  t13065 = t3614 * t13058;
  t13068 = t163 * t13058;
  t13072 = -0.6e1 * t13030 * t3647 + 0.18e2 * t13030 * t3698 + 0.18e2 * t13037 * t3707 + 0.18e2 * t13044 * t3647 - 0.12e2 * t13051 * t3685 - 0.18e2 * t13051 * t3707 + 0.12e2 * t13059 * t3747 - 0.7e1 * t13062 * t3755 - 0.7e1 * t13062 * t3846 - 0.6e1 * t13065 * t3741 + t13068 * t3846;
  t13094 = t13028 * t3589;
  t13095 = t379 * t13094;
  t13121 = 0.3e1 * t13094 * t163 * t396 - 0.18e2 * t13044 * t3830 - 0.6e1 * t13059 * t3758 + 0.6e1 * t13059 * t3846 + 0.6e1 * t13059 * t3856 - 0.12e2 * t13065 * t3747 - 0.6e1 * t13065 * t3752 + 0.18e2 * t13065 * t3758 + 0.11e2 * t13065 * t3765 - t13065 * t3846 - 0.3e1 * t13095 * t396;
  t13150 = 0.18e2 * t12388 - 0.6e1 * t12390 + 0.18e2 * t12392 + 0.18e2 * t12394 + 0.18e2 * t12396 - 0.18e2 * t12398 - 0.12e2 * t12400 + 0.18e2 * t12408 + 0.18e2 * t12415 - 0.18e2 * t12421 + t11498;
  t13152 = t163 * t13028;
  t13157 = t379 * t13028;
  t13176 = t11582 - 0.4e1 * t3373 - 0.4e1 * t3375 + 0.4e1 * t3379 - 0.4e1 * t3087 + 0.4e1 * t3095 - 0.4e1 * t3119 - t826 - t929 + 0.4e1 * t3386 + 0.4e1 * t3389;
  t13180 = my_piecewise5(t64, 0, t67, 0, t13176 + t13150 + t13121 + t13072 - 0.6e1 * t13065 * t3786 + 0.7e1 * t13062 * t3777 - 0.6e1 * t13030 * t3811 - 0.12e2 * t13059 * t3741 - 0.11e2 * t13062 * t3774 + 0.3e1 * t13152 * t3591 + 0.6e1 * t13152 * t3598 + 0.3e1 * t13157 * t3602 + 0.11e2 * t13157 * t3605 - 0.18e2 * t13059 * t3777 + 0.6e1 * t13068 * t3856 - 0.18e2 * t13062 * t3856 + 0.18e2 * t13059 * t3755 + 0.7e1 * t13065 * t3774 - 0.7e1 * t13065 * t3755 + 0.11e2 * t13068 * t3827 - 0.11e2 * t13062 * t3827 - 0.3e1 * t13095 * t413 + 0.18e2 * t13030 * t3672 + 0.18e2 * t13037 * t3680 - 0.6e1 * t13040 * t3647 - t11576 + t11580 - t11560 - t11501 - 0.6e1 * t12385 + 0.18e2 * t12386 + 0.4e1 * t3069 - 0.9e1 * t3060 + 0.4e1 * t3056 - 0.6e1 * t12353 - 0.18e2 * t12339 - 0.12e2 * t12334 - 0.18e2 * t12267 + 0.18e2 * t12269 - 0.18e2 * t12264 - 0.12e2 * t13040 * t1050 * t170 * t403 - 0.18e2 * t163 * t13033 * t3680 + 0.6e1 * t1038 * t13028 * t3609 + t3614 * t13028 * t3620);
  t13186 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t32 * (t52 * t291 * t3415 / 0.6e1 + t59 * t13180));
  tv4lapl40 = t8 * t13186;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 0] += tv4lapl40;

  tv4lapl41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 1] += tv4lapl41;

  tv4lapl42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 2] += tv4lapl42;

  tv4lapl43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 3] += tv4lapl43;

  t13193 = t945 * t945;
  t13194 = t13193 * t584;
  t13195 = t234 * t13194;
  t13198 = t13193 * t563;
  t13202 = t560 * t13198;
  t13208 = t1429 * t13198;
  t13225 = t13193 * t4489;
  t13226 = t560 * t13225;
  t13229 = t4509 * t13225;
  t13232 = t234 * t13225;
  t13236 = t1429 * t13225;
  t13239 = -0.12e2 * t11663 * t13208 + 0.18e2 * t13202 * t4367 - 0.6e1 * t13208 * t4371 - 0.18e2 * t13208 * t4421 + 0.18e2 * t13208 * t4447 - 0.7e1 * t13226 * t4563 - 0.7e1 * t13226 * t4649 - 0.6e1 * t13229 * t4542 + t13232 * t4649 + 0.6e1 * t13236 * t4649 + 0.18e2 * t12513;
  t13275 = t13193 * t4475;
  t13276 = t560 * t13275;
  t13285 = -0.12e2 * t11762 * t13195 - 0.18e2 * t13202 * t4626 - 0.12e2 * t13229 * t4546 - 0.6e1 * t13229 * t4554 + 0.11e2 * t13229 * t4570 - t13229 * t4649 + 0.11e2 * t13232 * t4630 + 0.6e1 * t13232 * t4643 - 0.6e1 * t13236 * t4557 - 0.3e1 * t13276 * t577 - 0.3e1 * t13276 * t594;
  t13313 = t11734 + 0.18e2 * t12607 - 0.6e1 * t12610 + 0.18e2 * t12611 + 0.18e2 * t12613 - 0.6e1 * t12615 + 0.18e2 * t12616 + 0.18e2 * t12618 - 0.18e2 * t12620 - 0.12e2 * t12622 + 0.18e2 * t12630;
  t13317 = t234 * t13193;
  t13320 = t560 * t13193;
  t13341 = t11800 - t952 - 0.4e1 * t3439 - 0.4e1 * t3441 + 0.4e1 * t3445 - 0.4e1 * t3184 - 0.4e1 * t3192 + 0.4e1 * t3199 - t852 + 0.4e1 * t3461 + 0.4e1 * t3464;
  t13345 = my_piecewise5(t114, 0, t115, 0, t13341 + t13313 + t13285 + t13239 - 0.7e1 * t13229 * t4563 - 0.11e2 * t13226 * t4583 - 0.6e1 * t13229 * t4601 + 0.18e2 * t13208 * t4411 - 0.18e2 * t13195 * t5503 + 0.18e2 * t13202 * t4371 + 0.3e1 * t13317 * t4477 + 0.11e2 * t13320 * t4504 - 0.11e2 * t13226 * t4630 + 0.7e1 * t13226 * t4588 - 0.6e1 * t13208 * t4615 - 0.12e2 * t13236 * t4542 + 0.6e1 * t13317 * t4493 + 0.3e1 * t13320 * t4497 - 0.18e2 * t13236 * t4588 + 0.18e2 * t13229 * t4557 - 0.18e2 * t13226 * t4643 + 0.6e1 * t13236 * t4643 + 0.18e2 * t13236 * t4563 + 0.12e2 * t13236 * t4546 + 0.7e1 * t13229 * t4583 - 0.18e2 * t12646 + 0.18e2 * t12637 - 0.18e2 * t12559 - 0.12e2 * t12555 - 0.6e1 * t12552 - 0.18e2 * t12511 - 0.18e2 * t12508 + t11795 - t11797 - t11731 - t11729 - 0.9e1 * t3152 + 0.4e1 * t3147 + 0.4e1 * t3148 - 0.6e1 * t234 * t13198 * t4371 + 0.18e2 * t560 * t13194 * t4417 + 0.3e1 * t234 * t13275 * t577 + 0.6e1 * t1429 * t13193 * t4501 + t4509 * t13193 * t4515);
  t13351 = my_piecewise3(t84, 0, 0.3e1 / 0.2e2 * t7 * t94 * (t52 * t308 * t3481 / 0.6e1 + t113 * t13345));
  tv4lapl44 = t8 * t13351;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 4] += tv4lapl44;

  tv4lapl3tau0 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl3tau1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 1] += tv4lapl3tau1;

  tv4lapl3tau2 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 2] += tv4lapl3tau2;

  tv4lapl3tau3 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 3] += tv4lapl3tau3;

  tv4lapl3tau4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 4] += tv4lapl3tau4;

  tv4lapl3tau5 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 5] += tv4lapl3tau5;

  tv4lapl3tau6 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 6] += tv4lapl3tau6;

  tv4lapl3tau7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 7] += tv4lapl3tau7;

  tv4lapl2tau20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapl2tau21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 1] += tv4lapl2tau21;

  tv4lapl2tau22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 2] += tv4lapl2tau22;

  tv4lapl2tau23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 3] += tv4lapl2tau23;

  tv4lapl2tau24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 4] += tv4lapl2tau24;

  tv4lapl2tau25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 5] += tv4lapl2tau25;

  tv4lapl2tau26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 6] += tv4lapl2tau26;

  tv4lapl2tau27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 7] += tv4lapl2tau27;

  tv4lapl2tau28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 8] += tv4lapl2tau28;

  tv4lapltau30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 0] += tv4lapltau30;

  tv4lapltau31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 1] += tv4lapltau31;

  tv4lapltau32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 2] += tv4lapltau32;

  tv4lapltau33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 3] += tv4lapltau33;

  tv4lapltau34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 4] += tv4lapltau34;

  tv4lapltau35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 5] += tv4lapltau35;

  tv4lapltau36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 6] += tv4lapltau36;

  tv4lapltau37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 7] += tv4lapltau37;

  tv4tau40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 0] += tv4tau40;

  tv4tau41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 1] += tv4tau41;

  tv4tau42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 2] += tv4tau42;

  tv4tau43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 3] += tv4tau43;

  tv4tau44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 4] += tv4tau44;

}

#endif

