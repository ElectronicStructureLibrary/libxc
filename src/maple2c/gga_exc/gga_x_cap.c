/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_cap.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t44, t46, t47, t48, t52, t56, t57;
  double t58, t59, t60, t61, t63, t64, t65, t66;
  double t68, t69, t72, t73, t75, t76, t77, t81;
  double t85, tzk0;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = sqrt(sigma[2]);
  t66 = POW_1_3(rho[1]);
  t68 = 0.1e1 / t66 / rho[1];
  t69 = t65 * t68;
  t72 = 0.1e1 + t40 * t69 / 0.12e2;
  t73 = log(t72);
  t75 = params->c * t73 + 0.1e1;
  t76 = 0.1e1 / t75;
  t77 = t73 * t76;
  t81 = 0.1e1 - t34 * t69 * t77 / 0.12e2;
  t85 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t81);
  tzk0 = t56 + t85;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t44, t46, t47, t48, t52, t56, t57;
  double t58, t59, t60, t61, t63, t64, t65, t66;
  double t68, t69, t72, t73, t75, t76, t77, t81;
  double t85, tzk0;

  double t86, t87, t88, t89, t90, t93, t94, t98;
  double t99, t100, t103, t104, t106, t111, t112, t113;
  double t114, t115, t116, t118, t120, t121, t126, t128;
  double t129, t130, t131, t132, t135, t140, t142, t145;
  double t146, t150, t153, t155, tvrho0, t158, t159, t162;
  double t163, t168, t170, t173, t174, t178, t180, t185;
  double t186, t188, t190, t191, t196, t198, t199, t200;
  double t201, t202, t205, t210, tvrho1, t213, t219, t226;
  double t228, t231, t235, tvsigma0, tvsigma1, t236, t242, t249;
  double t251, t254, t258, tvsigma2;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = sqrt(sigma[2]);
  t66 = POW_1_3(rho[1]);
  t68 = 0.1e1 / t66 / rho[1];
  t69 = t65 * t68;
  t72 = 0.1e1 + t40 * t69 / 0.12e2;
  t73 = log(t72);
  t75 = params->c * t73 + 0.1e1;
  t76 = 0.1e1 / t75;
  t77 = t73 * t76;
  t81 = 0.1e1 - t34 * t69 * t77 / 0.12e2;
  t85 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t81);
  tzk0 = t56 + t85;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t86 = t6 * t6;
  t87 = 0.1e1 / t86;
  t88 = t16 * t87;
  t89 = t7 - t88;
  t90 = my_piecewise5(t10, 0, t14, 0, t89);
  t93 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t90);
  t94 = t93 * t26;
  t98 = t26 * t26;
  t99 = 0.1e1 / t98;
  t100 = t25 * t99;
  t103 = t5 * t100 * t52 / 0.8e1;
  t104 = rho[0] * rho[0];
  t106 = 0.1e1 / t36 / t104;
  t111 = params->alphaoAx * t28;
  t112 = t32 * t32;
  t113 = 0.1e1 / t112;
  t114 = t111 * t113;
  t115 = t104 * rho[0];
  t116 = t36 * t36;
  t118 = 0.1e1 / t116 / t115;
  t120 = 0.1e1 / t43;
  t121 = t120 * t47;
  t126 = t111 * t113 * sigma[0];
  t128 = t46 * t46;
  t129 = 0.1e1 / t128;
  t130 = t129 * params->c;
  t131 = t130 * t120;
  t132 = t118 * t44 * t131;
  t135 = t34 * t35 * t106 * t48 / 0.9e1 + t114 * sigma[0] * t118 * t121 / 0.18e2 - t126 * t132 / 0.18e2;
  t140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t52 - t103 - 0.3e1 / 0.8e1 * t5 * t27 * t135);
  t142 = my_piecewise5(t14, 0, t10, 0, -t89);
  t145 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t142);
  t146 = t145 * t26;
  t150 = t63 * t99;
  t153 = t5 * t150 * t81 / 0.8e1;
  t155 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t81 - t153);
  tvrho0 = t56 + t85 + t6 * (t140 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t158 = -t7 - t88;
  t159 = my_piecewise5(t10, 0, t14, 0, t158);
  t162 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t159);
  t163 = t162 * t26;
  t168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t52 - t103);
  t170 = my_piecewise5(t14, 0, t10, 0, -t158);
  t173 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t170);
  t174 = t173 * t26;
  t178 = rho[1] * rho[1];
  t180 = 0.1e1 / t66 / t178;
  t185 = t178 * rho[1];
  t186 = t66 * t66;
  t188 = 0.1e1 / t186 / t185;
  t190 = 0.1e1 / t72;
  t191 = t190 * t76;
  t196 = t111 * t113 * sigma[2];
  t198 = t75 * t75;
  t199 = 0.1e1 / t198;
  t200 = t199 * params->c;
  t201 = t200 * t190;
  t202 = t188 * t73 * t201;
  t205 = t34 * t65 * t180 * t77 / 0.9e1 + t114 * sigma[2] * t188 * t191 / 0.18e2 - t196 * t202 / 0.18e2;
  t210 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t81 - t153 - 0.3e1 / 0.8e1 * t5 * t64 * t205);
  tvrho1 = t56 + t85 + t6 * (t168 + t210);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t213 = 0.1e1 / t35;
  t219 = 0.1e1 / t116 / t104;
  t226 = t44 * t129;
  t228 = t226 * params->c * t120;
  t231 = -t34 * t213 * t38 * t48 / 0.24e2 - t114 * t219 * t120 * t47 / 0.48e2 + t111 * t113 * t219 * t228 / 0.48e2;
  t235 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t231);
  tvsigma0 = t6 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t236 = 0.1e1 / t65;
  t242 = 0.1e1 / t186 / t178;
  t249 = t73 * t199;
  t251 = t249 * params->c * t190;
  t254 = -t34 * t236 * t68 * t77 / 0.24e2 - t114 * t242 * t190 * t76 / 0.48e2 + t111 * t113 * t242 * t251 / 0.48e2;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t44, t46, t47, t48, t52, t56, t57;
  double t58, t59, t60, t61, t63, t64, t65, t66;
  double t68, t69, t72, t73, t75, t76, t77, t81;
  double t85, tzk0;

  double t86, t87, t88, t89, t90, t93, t94, t98;
  double t99, t100, t103, t104, t106, t111, t112, t113;
  double t114, t115, t116, t118, t120, t121, t126, t128;
  double t129, t130, t131, t132, t135, t140, t142, t145;
  double t146, t150, t153, t155, tvrho0, t158, t159, t162;
  double t163, t168, t170, t173, t174, t178, t180, t185;
  double t186, t188, t190, t191, t196, t198, t199, t200;
  double t201, t202, t205, t210, tvrho1, t213, t219, t226;
  double t228, t231, t235, tvsigma0, tvsigma1, t236, t242, t249;
  double t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t302, t304, t310, t314, t315, t316, t317;
  double t318, t319, t320, t321, t322, t325, t329, t331;
  double t333, t335, t339, t342, t347, t348, t349, t350;
  double t354, t358, t359, t363, t365, t367, t370, t372;
  double tv2rho20, t375, t378, t379, t383, t384, t388, t390;
  double t398, t399, t402, t406, t407, t411, t413, t420;
  double t423, tv2rho21, t428, t432, t433, t437, t438, t444;
  double t445, t449, t453, t454, t464, t469, t471, t477;
  double t480, t481, t482, t483, t484, t485, t486, t487;
  double t490, t494, t496, t499, t503, t506, t511, tv2rho22;
  double t519, t532, t533, t534, t535, t536, t539, t541;
  double t545, t546, t548, t553, t558, tv2rhosigma0, tv2rhosigma1, t565;
  double t567, tv2rhosigma2, t573, tv2rhosigma3, tv2rhosigma4, t590, t591, t592;
  double t593, t594, t597, t599, t603, t604, t606, t611;
  double t616, tv2rhosigma5, t618, t623, t629, t631, t634, t635;
  double t640, t644, t651, t655, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t656, t661, t667, t669, t672, t673, t678;
  double t682, t689, t693, tv2sigma25;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = sqrt(sigma[2]);
  t66 = POW_1_3(rho[1]);
  t68 = 0.1e1 / t66 / rho[1];
  t69 = t65 * t68;
  t72 = 0.1e1 + t40 * t69 / 0.12e2;
  t73 = log(t72);
  t75 = params->c * t73 + 0.1e1;
  t76 = 0.1e1 / t75;
  t77 = t73 * t76;
  t81 = 0.1e1 - t34 * t69 * t77 / 0.12e2;
  t85 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t81);
  tzk0 = t56 + t85;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t86 = t6 * t6;
  t87 = 0.1e1 / t86;
  t88 = t16 * t87;
  t89 = t7 - t88;
  t90 = my_piecewise5(t10, 0, t14, 0, t89);
  t93 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t90);
  t94 = t93 * t26;
  t98 = t26 * t26;
  t99 = 0.1e1 / t98;
  t100 = t25 * t99;
  t103 = t5 * t100 * t52 / 0.8e1;
  t104 = rho[0] * rho[0];
  t106 = 0.1e1 / t36 / t104;
  t111 = params->alphaoAx * t28;
  t112 = t32 * t32;
  t113 = 0.1e1 / t112;
  t114 = t111 * t113;
  t115 = t104 * rho[0];
  t116 = t36 * t36;
  t118 = 0.1e1 / t116 / t115;
  t120 = 0.1e1 / t43;
  t121 = t120 * t47;
  t126 = t111 * t113 * sigma[0];
  t128 = t46 * t46;
  t129 = 0.1e1 / t128;
  t130 = t129 * params->c;
  t131 = t130 * t120;
  t132 = t118 * t44 * t131;
  t135 = t34 * t35 * t106 * t48 / 0.9e1 + t114 * sigma[0] * t118 * t121 / 0.18e2 - t126 * t132 / 0.18e2;
  t140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t52 - t103 - 0.3e1 / 0.8e1 * t5 * t27 * t135);
  t142 = my_piecewise5(t14, 0, t10, 0, -t89);
  t145 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t142);
  t146 = t145 * t26;
  t150 = t63 * t99;
  t153 = t5 * t150 * t81 / 0.8e1;
  t155 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t81 - t153);
  tvrho0 = t56 + t85 + t6 * (t140 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t158 = -t7 - t88;
  t159 = my_piecewise5(t10, 0, t14, 0, t158);
  t162 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t159);
  t163 = t162 * t26;
  t168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t52 - t103);
  t170 = my_piecewise5(t14, 0, t10, 0, -t158);
  t173 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t170);
  t174 = t173 * t26;
  t178 = rho[1] * rho[1];
  t180 = 0.1e1 / t66 / t178;
  t185 = t178 * rho[1];
  t186 = t66 * t66;
  t188 = 0.1e1 / t186 / t185;
  t190 = 0.1e1 / t72;
  t191 = t190 * t76;
  t196 = t111 * t113 * sigma[2];
  t198 = t75 * t75;
  t199 = 0.1e1 / t198;
  t200 = t199 * params->c;
  t201 = t200 * t190;
  t202 = t188 * t73 * t201;
  t205 = t34 * t65 * t180 * t77 / 0.9e1 + t114 * sigma[2] * t188 * t191 / 0.18e2 - t196 * t202 / 0.18e2;
  t210 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t81 - t153 - 0.3e1 / 0.8e1 * t5 * t64 * t205);
  tvrho1 = t56 + t85 + t6 * (t168 + t210);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t213 = 0.1e1 / t35;
  t219 = 0.1e1 / t116 / t104;
  t226 = t44 * t129;
  t228 = t226 * params->c * t120;
  t231 = -t34 * t213 * t38 * t48 / 0.24e2 - t114 * t219 * t120 * t47 / 0.48e2 + t111 * t113 * t219 * t228 / 0.48e2;
  t235 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t231);
  tvsigma0 = t6 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t236 = 0.1e1 / t65;
  t242 = 0.1e1 / t186 / t178;
  t249 = t73 * t199;
  t251 = t249 * params->c * t190;
  t254 = -t34 * t236 * t68 * t77 / 0.24e2 - t114 * t242 * t190 * t76 / 0.48e2 + t111 * t113 * t242 * t251 / 0.48e2;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t90 * t90;
  t266 = t86 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t87 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t93 * t99;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t98 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t100 * t135;
  t297 = 0.1e1 / t36 / t115;
  t302 = t104 * t104;
  t304 = 0.1e1 / t116 / t302;
  t310 = t304 * t44 * t131;
  t314 = params->alphaoAx / t31;
  t315 = t35 * sigma[0];
  t316 = t314 * t315;
  t317 = t302 * t104;
  t318 = 0.1e1 / t317;
  t319 = t43 * t43;
  t320 = 0.1e1 / t319;
  t321 = t318 * t320;
  t322 = t321 * t47;
  t325 = t321 * t130;
  t329 = t314 * t315 * t318;
  t331 = 0.1e1 / t128 / t46;
  t333 = params->c * params->c;
  t335 = t44 * t331 * t333 * t320;
  t339 = t226 * params->c * t320;
  t342 = -0.7e1 / 0.27e2 * t34 * t35 * t297 * t48 - 0.5e1 / 0.18e2 * t114 * sigma[0] * t304 * t121 + 0.5e1 / 0.18e2 * t126 * t310 + t316 * t322 / 0.27e2 + 0.2e1 / 0.27e2 * t316 * t325 - 0.2e1 / 0.27e2 * t329 * t335 - t329 * t339 / 0.27e2;
  t347 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t135 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t342);
  t348 = t61 * t61;
  t349 = 0.1e1 / t348;
  t350 = t142 * t142;
  t354 = my_piecewise5(t14, 0, t10, 0, -t270);
  t358 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t61 * t354);
  t359 = t358 * t26;
  t363 = t145 * t99;
  t365 = t5 * t363 * t81;
  t367 = t63 * t288;
  t370 = t5 * t367 * t81 / 0.12e2;
  t372 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t81 - t365 / 0.4e1 + t370);
  tv2rho20 = 0.2e1 * t140 + 0.2e1 * t155 + t6 * (t347 + t372);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t375 = t262 * t159;
  t378 = 0.2e1 * t268;
  t379 = my_piecewise5(t10, 0, t14, 0, t378);
  t383 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t375 * t90 + 0.4e1 / 0.3e1 * t23 * t379);
  t384 = t383 * t26;
  t388 = t162 * t99;
  t390 = t5 * t388 * t52;
  t398 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t52 - t390 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t135 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t399 = t349 * t170;
  t402 = my_piecewise5(t14, 0, t10, 0, -t378);
  t406 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t399 * t142 + 0.4e1 / 0.3e1 * t61 * t402);
  t407 = t406 * t26;
  t411 = t173 * t99;
  t413 = t5 * t411 * t81;
  t420 = t5 * t150 * t205;
  t423 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t81 - t413 / 0.8e1 - t365 / 0.8e1 + t370 - 0.3e1 / 0.8e1 * t5 * t146 * t205 - t420 / 0.8e1);
  tv2rho21 = t140 + t155 + t168 + t210 + t6 * (t398 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t428 = t159 * t159;
  t432 = 0.2e1 * t87 + 0.2e1 * t268;
  t433 = my_piecewise5(t10, 0, t14, 0, t432);
  t437 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t428 + 0.4e1 / 0.3e1 * t23 * t433);
  t438 = t437 * t26;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t52 - t390 / 0.4e1 + t292);
  t445 = t170 * t170;
  t449 = my_piecewise5(t14, 0, t10, 0, -t432);
  t453 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t445 + 0.4e1 / 0.3e1 * t61 * t449);
  t454 = t453 * t26;
  t464 = 0.1e1 / t66 / t185;
  t469 = t178 * t178;
  t471 = 0.1e1 / t186 / t469;
  t477 = t471 * t73 * t201;
  t480 = t65 * sigma[2];
  t481 = t314 * t480;
  t482 = t469 * t178;
  t483 = 0.1e1 / t482;
  t484 = t72 * t72;
  t485 = 0.1e1 / t484;
  t486 = t483 * t485;
  t487 = t486 * t76;
  t490 = t486 * t200;
  t494 = t314 * t480 * t483;
  t496 = 0.1e1 / t198 / t75;
  t499 = t73 * t496 * t333 * t485;
  t503 = t249 * params->c * t485;
  t506 = -0.7e1 / 0.27e2 * t34 * t65 * t464 * t77 - 0.5e1 / 0.18e2 * t114 * sigma[2] * t471 * t191 + 0.5e1 / 0.18e2 * t196 * t477 + t481 * t487 / 0.27e2 + 0.2e1 / 0.27e2 * t481 * t490 - 0.2e1 / 0.27e2 * t494 * t499 - t494 * t503 / 0.27e2;
  t511 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t81 - t413 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t205 + t370 - t420 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t506);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t210 + t6 * (t444 + t511);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t519 = t5 * t100 * t231 / 0.8e1;
  t532 = t302 * rho[0];
  t533 = 0.1e1 / t532;
  t534 = t314 * t533;
  t535 = t320 * t47;
  t536 = t535 * t35;
  t539 = t320 * t129;
  t541 = t539 * params->c * t35;
  t545 = t314 * t533 * t44;
  t546 = t331 * t333;
  t548 = t546 * t320 * t35;
  t553 = t34 * t213 * t106 * t48 / 0.18e2 + t114 * t118 * t120 * t47 / 0.12e2 - t111 * t113 * t118 * t228 / 0.12e2 - t534 * t536 / 0.72e2 - t534 * t541 / 0.36e2 + t545 * t548 / 0.36e2 + t545 * t541 / 0.72e2;
  t558 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t231 - t519 - 0.3e1 / 0.8e1 * t5 * t27 * t553);
  tv2rhosigma0 = t6 * t558 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t565 = t5 * t150 * t254 / 0.8e1;
  t567 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t254 - t565);
  tv2rhosigma2 = t6 * t567 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t573 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t231 - t519);
  tv2rhosigma3 = t6 * t573 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t590 = t469 * rho[1];
  t591 = 0.1e1 / t590;
  t592 = t314 * t591;
  t593 = t485 * t76;
  t594 = t593 * t65;
  t597 = t485 * t199;
  t599 = t597 * params->c * t65;
  t603 = t314 * t591 * t73;
  t604 = t496 * t333;
  t606 = t604 * t485 * t65;
  t611 = t34 * t236 * t180 * t77 / 0.18e2 + t114 * t188 * t190 * t76 / 0.12e2 - t111 * t113 * t188 * t251 / 0.12e2 - t592 * t594 / 0.72e2 - t592 * t599 / 0.36e2 + t603 * t606 / 0.36e2 + t603 * t599 / 0.72e2;
  t616 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t254 - t565 - 0.3e1 / 0.8e1 * t5 * t64 * t611);
  tv2rhosigma5 = t6 * t616 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t618 = 0.1e1 / t315;
  t623 = 0.1e1 / sigma[0];
  t629 = t111 * t113 * t623;
  t631 = t219 * t44 * t131;
  t634 = 0.1e1 / t302;
  t635 = t314 * t634;
  t640 = t539 * params->c * t213;
  t644 = t314 * t634 * t44;
  t651 = t34 * t618 * t38 * t48 / 0.48e2 - t114 * t623 * t219 * t121 / 0.96e2 + t629 * t631 / 0.96e2 + t635 * t535 * t213 / 0.192e3 + t635 * t640 / 0.96e2 - t644 * t546 * t320 * t213 / 0.96e2 - t644 * t640 / 0.192e3;
  t655 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t651);
  tv2sigma20 = t6 * t655;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t656 = 0.1e1 / t480;
  t661 = 0.1e1 / sigma[2];
  t667 = t111 * t113 * t661;
  t669 = t242 * t73 * t201;
  t672 = 0.1e1 / t469;
  t673 = t314 * t672;
  t678 = t597 * params->c * t236;
  t682 = t314 * t672 * t73;
  t689 = t34 * t656 * t68 * t77 / 0.48e2 - t114 * t661 * t242 * t191 / 0.96e2 + t667 * t669 / 0.96e2 + t673 * t593 * t236 / 0.192e3 + t673 * t678 / 0.96e2 - t682 * t604 * t485 * t236 / 0.96e2 - t682 * t678 / 0.192e3;
  t693 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t689);
  tv2sigma25 = t6 * t693;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t44, t46, t47, t48, t52, t56, t57;
  double t58, t59, t60, t61, t63, t64, t65, t66;
  double t68, t69, t72, t73, t75, t76, t77, t81;
  double t85, tzk0;

  double t86, t87, t88, t89, t90, t93, t94, t98;
  double t99, t100, t103, t104, t106, t111, t112, t113;
  double t114, t115, t116, t118, t120, t121, t126, t128;
  double t129, t130, t131, t132, t135, t140, t142, t145;
  double t146, t150, t153, t155, tvrho0, t158, t159, t162;
  double t163, t168, t170, t173, t174, t178, t180, t185;
  double t186, t188, t190, t191, t196, t198, t199, t200;
  double t201, t202, t205, t210, tvrho1, t213, t219, t226;
  double t228, t231, t235, tvsigma0, tvsigma1, t236, t242, t249;
  double t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t302, t304, t310, t314, t315, t316, t317;
  double t318, t319, t320, t321, t322, t325, t329, t331;
  double t333, t335, t339, t342, t347, t348, t349, t350;
  double t354, t358, t359, t363, t365, t367, t370, t372;
  double tv2rho20, t375, t378, t379, t383, t384, t388, t390;
  double t398, t399, t402, t406, t407, t411, t413, t420;
  double t423, tv2rho21, t428, t432, t433, t437, t438, t444;
  double t445, t449, t453, t454, t464, t469, t471, t477;
  double t480, t481, t482, t483, t484, t485, t486, t487;
  double t490, t494, t496, t499, t503, t506, t511, tv2rho22;
  double t519, t532, t533, t534, t535, t536, t539, t541;
  double t545, t546, t548, t553, t558, tv2rhosigma0, tv2rhosigma1, t565;
  double t567, tv2rhosigma2, t573, tv2rhosigma3, tv2rhosigma4, t590, t591, t592;
  double t593, t594, t597, t599, t603, t604, t606, t611;
  double t616, tv2rhosigma5, t618, t623, t629, t631, t634, t635;
  double t640, t644, t651, t655, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t656, t661, t667, t669, t672, t673, t678;
  double t682, t689, t693, tv2sigma25;

  double t697, t698, t701, t704, t705, t706, t708, t709;
  double t713, t714, t718, t720, t725, t727, t730, t736;
  double t737, t740, t742, t745, t748, t754, t763, t764;
  double t765, t773, t778, t779, t781, t782, t783, t785;
  double t787, t792, t793, t798, t799, t803, t804, t805;
  double t806, t807, t810, t817, t822, t824, t825, t828;
  double t832, t836, t837, t841, t843, t845, t847, t849;
  double t852, t854, tv3rho30, t857, t858, t859, t862, t867;
  double t868, t869, t870, t874, t875, t879, t882, t886;
  double t888, t892, t901, t902, t903, t906, t912, t916;
  double t917, t921, t924, t925, t927, t936, t938, t941;
  double tv3rho31, t944, t949, t952, t953, t957, t958, t962;
  double t964, t973, t974, t979, t983, t987, t988, t992;
  double t994, t1001, t1009, t1011, t1012, tv3rho32, t1017, t1023;
  double t1024, t1028, t1029, t1036, t1037, t1043, t1047, t1048;
  double t1064, t1070, t1079, t1080, t1081, t1089, t1094, t1095;
  double t1097, t1098, t1099, t1101, t1103, t1107, t1111, t1115;
  double t1116, t1117, t1118, t1121, t1128, t1133, tv3rho33, t1141;
  double t1148, t1150, t1164, t1170, t1176, t1178, t1180, t1184;
  double t1188, t1189, t1192, t1195, t1196, t1201, t1202, t1207;
  double t1208, t1211, t1216, tv3rho2sigma0, tv3rho2sigma1, t1223, t1227, t1229;
  double tv3rho2sigma2, t1235, t1243, tv3rho2sigma3, tv3rho2sigma4, t1249, t1256, t1259;
  double tv3rho2sigma5, t1267, tv3rho2sigma6, tv3rho2sigma7, t1290, t1296, t1302, t1304;
  double t1306, t1310, t1314, t1315, t1318, t1321, t1322, t1327;
  double t1328, t1333, t1334, t1337, t1342, tv3rho2sigma8, t1349, t1360;
  double t1361, t1362, t1365, t1369, t1375, t1380, t1381, t1384;
  double t1387, t1388, t1395, t1400, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1407, t1409, tv3rhosigma25, t1415, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1430, t1431, t1432, t1435, t1439, t1445;
  double t1450, t1451, t1454, t1457, t1458, t1465, t1470, tv3rhosigma211;
  double t1472, t1473, t1478, t1484, t1488, t1490, t1492, t1496;
  double t1500, t1501, t1504, t1506, t1507, t1511, t1512, t1516;
  double t1517, t1520, t1524, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1525, t1526, t1531, t1537;
  double t1541, t1543, t1545, t1549, t1553, t1554, t1557, t1559;
  double t1560, t1564, t1565, t1569, t1570, t1573, t1577, tv3sigma39;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = sqrt(sigma[2]);
  t66 = POW_1_3(rho[1]);
  t68 = 0.1e1 / t66 / rho[1];
  t69 = t65 * t68;
  t72 = 0.1e1 + t40 * t69 / 0.12e2;
  t73 = log(t72);
  t75 = params->c * t73 + 0.1e1;
  t76 = 0.1e1 / t75;
  t77 = t73 * t76;
  t81 = 0.1e1 - t34 * t69 * t77 / 0.12e2;
  t85 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t81);
  tzk0 = t56 + t85;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t86 = t6 * t6;
  t87 = 0.1e1 / t86;
  t88 = t16 * t87;
  t89 = t7 - t88;
  t90 = my_piecewise5(t10, 0, t14, 0, t89);
  t93 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t90);
  t94 = t93 * t26;
  t98 = t26 * t26;
  t99 = 0.1e1 / t98;
  t100 = t25 * t99;
  t103 = t5 * t100 * t52 / 0.8e1;
  t104 = rho[0] * rho[0];
  t106 = 0.1e1 / t36 / t104;
  t111 = params->alphaoAx * t28;
  t112 = t32 * t32;
  t113 = 0.1e1 / t112;
  t114 = t111 * t113;
  t115 = t104 * rho[0];
  t116 = t36 * t36;
  t118 = 0.1e1 / t116 / t115;
  t120 = 0.1e1 / t43;
  t121 = t120 * t47;
  t126 = t111 * t113 * sigma[0];
  t128 = t46 * t46;
  t129 = 0.1e1 / t128;
  t130 = t129 * params->c;
  t131 = t130 * t120;
  t132 = t118 * t44 * t131;
  t135 = t34 * t35 * t106 * t48 / 0.9e1 + t114 * sigma[0] * t118 * t121 / 0.18e2 - t126 * t132 / 0.18e2;
  t140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t52 - t103 - 0.3e1 / 0.8e1 * t5 * t27 * t135);
  t142 = my_piecewise5(t14, 0, t10, 0, -t89);
  t145 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t142);
  t146 = t145 * t26;
  t150 = t63 * t99;
  t153 = t5 * t150 * t81 / 0.8e1;
  t155 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t81 - t153);
  tvrho0 = t56 + t85 + t6 * (t140 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t158 = -t7 - t88;
  t159 = my_piecewise5(t10, 0, t14, 0, t158);
  t162 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t159);
  t163 = t162 * t26;
  t168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t52 - t103);
  t170 = my_piecewise5(t14, 0, t10, 0, -t158);
  t173 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t170);
  t174 = t173 * t26;
  t178 = rho[1] * rho[1];
  t180 = 0.1e1 / t66 / t178;
  t185 = t178 * rho[1];
  t186 = t66 * t66;
  t188 = 0.1e1 / t186 / t185;
  t190 = 0.1e1 / t72;
  t191 = t190 * t76;
  t196 = t111 * t113 * sigma[2];
  t198 = t75 * t75;
  t199 = 0.1e1 / t198;
  t200 = t199 * params->c;
  t201 = t200 * t190;
  t202 = t188 * t73 * t201;
  t205 = t34 * t65 * t180 * t77 / 0.9e1 + t114 * sigma[2] * t188 * t191 / 0.18e2 - t196 * t202 / 0.18e2;
  t210 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t81 - t153 - 0.3e1 / 0.8e1 * t5 * t64 * t205);
  tvrho1 = t56 + t85 + t6 * (t168 + t210);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t213 = 0.1e1 / t35;
  t219 = 0.1e1 / t116 / t104;
  t226 = t44 * t129;
  t228 = t226 * params->c * t120;
  t231 = -t34 * t213 * t38 * t48 / 0.24e2 - t114 * t219 * t120 * t47 / 0.48e2 + t111 * t113 * t219 * t228 / 0.48e2;
  t235 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t231);
  tvsigma0 = t6 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t236 = 0.1e1 / t65;
  t242 = 0.1e1 / t186 / t178;
  t249 = t73 * t199;
  t251 = t249 * params->c * t190;
  t254 = -t34 * t236 * t68 * t77 / 0.24e2 - t114 * t242 * t190 * t76 / 0.48e2 + t111 * t113 * t242 * t251 / 0.48e2;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t90 * t90;
  t266 = t86 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t87 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t93 * t99;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t98 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t100 * t135;
  t297 = 0.1e1 / t36 / t115;
  t302 = t104 * t104;
  t304 = 0.1e1 / t116 / t302;
  t310 = t304 * t44 * t131;
  t314 = params->alphaoAx / t31;
  t315 = t35 * sigma[0];
  t316 = t314 * t315;
  t317 = t302 * t104;
  t318 = 0.1e1 / t317;
  t319 = t43 * t43;
  t320 = 0.1e1 / t319;
  t321 = t318 * t320;
  t322 = t321 * t47;
  t325 = t321 * t130;
  t329 = t314 * t315 * t318;
  t331 = 0.1e1 / t128 / t46;
  t333 = params->c * params->c;
  t335 = t44 * t331 * t333 * t320;
  t339 = t226 * params->c * t320;
  t342 = -0.7e1 / 0.27e2 * t34 * t35 * t297 * t48 - 0.5e1 / 0.18e2 * t114 * sigma[0] * t304 * t121 + 0.5e1 / 0.18e2 * t126 * t310 + t316 * t322 / 0.27e2 + 0.2e1 / 0.27e2 * t316 * t325 - 0.2e1 / 0.27e2 * t329 * t335 - t329 * t339 / 0.27e2;
  t347 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t135 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t342);
  t348 = t61 * t61;
  t349 = 0.1e1 / t348;
  t350 = t142 * t142;
  t354 = my_piecewise5(t14, 0, t10, 0, -t270);
  t358 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t61 * t354);
  t359 = t358 * t26;
  t363 = t145 * t99;
  t365 = t5 * t363 * t81;
  t367 = t63 * t288;
  t370 = t5 * t367 * t81 / 0.12e2;
  t372 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t81 - t365 / 0.4e1 + t370);
  tv2rho20 = 0.2e1 * t140 + 0.2e1 * t155 + t6 * (t347 + t372);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t375 = t262 * t159;
  t378 = 0.2e1 * t268;
  t379 = my_piecewise5(t10, 0, t14, 0, t378);
  t383 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t375 * t90 + 0.4e1 / 0.3e1 * t23 * t379);
  t384 = t383 * t26;
  t388 = t162 * t99;
  t390 = t5 * t388 * t52;
  t398 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t52 - t390 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t135 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t399 = t349 * t170;
  t402 = my_piecewise5(t14, 0, t10, 0, -t378);
  t406 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t399 * t142 + 0.4e1 / 0.3e1 * t61 * t402);
  t407 = t406 * t26;
  t411 = t173 * t99;
  t413 = t5 * t411 * t81;
  t420 = t5 * t150 * t205;
  t423 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t81 - t413 / 0.8e1 - t365 / 0.8e1 + t370 - 0.3e1 / 0.8e1 * t5 * t146 * t205 - t420 / 0.8e1);
  tv2rho21 = t140 + t155 + t168 + t210 + t6 * (t398 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t428 = t159 * t159;
  t432 = 0.2e1 * t87 + 0.2e1 * t268;
  t433 = my_piecewise5(t10, 0, t14, 0, t432);
  t437 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t428 + 0.4e1 / 0.3e1 * t23 * t433);
  t438 = t437 * t26;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t52 - t390 / 0.4e1 + t292);
  t445 = t170 * t170;
  t449 = my_piecewise5(t14, 0, t10, 0, -t432);
  t453 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t445 + 0.4e1 / 0.3e1 * t61 * t449);
  t454 = t453 * t26;
  t464 = 0.1e1 / t66 / t185;
  t469 = t178 * t178;
  t471 = 0.1e1 / t186 / t469;
  t477 = t471 * t73 * t201;
  t480 = t65 * sigma[2];
  t481 = t314 * t480;
  t482 = t469 * t178;
  t483 = 0.1e1 / t482;
  t484 = t72 * t72;
  t485 = 0.1e1 / t484;
  t486 = t483 * t485;
  t487 = t486 * t76;
  t490 = t486 * t200;
  t494 = t314 * t480 * t483;
  t496 = 0.1e1 / t198 / t75;
  t499 = t73 * t496 * t333 * t485;
  t503 = t249 * params->c * t485;
  t506 = -0.7e1 / 0.27e2 * t34 * t65 * t464 * t77 - 0.5e1 / 0.18e2 * t114 * sigma[2] * t471 * t191 + 0.5e1 / 0.18e2 * t196 * t477 + t481 * t487 / 0.27e2 + 0.2e1 / 0.27e2 * t481 * t490 - 0.2e1 / 0.27e2 * t494 * t499 - t494 * t503 / 0.27e2;
  t511 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t81 - t413 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t205 + t370 - t420 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t506);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t210 + t6 * (t444 + t511);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t519 = t5 * t100 * t231 / 0.8e1;
  t532 = t302 * rho[0];
  t533 = 0.1e1 / t532;
  t534 = t314 * t533;
  t535 = t320 * t47;
  t536 = t535 * t35;
  t539 = t320 * t129;
  t541 = t539 * params->c * t35;
  t545 = t314 * t533 * t44;
  t546 = t331 * t333;
  t548 = t546 * t320 * t35;
  t553 = t34 * t213 * t106 * t48 / 0.18e2 + t114 * t118 * t120 * t47 / 0.12e2 - t111 * t113 * t118 * t228 / 0.12e2 - t534 * t536 / 0.72e2 - t534 * t541 / 0.36e2 + t545 * t548 / 0.36e2 + t545 * t541 / 0.72e2;
  t558 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t231 - t519 - 0.3e1 / 0.8e1 * t5 * t27 * t553);
  tv2rhosigma0 = t6 * t558 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t565 = t5 * t150 * t254 / 0.8e1;
  t567 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t254 - t565);
  tv2rhosigma2 = t6 * t567 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t573 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t231 - t519);
  tv2rhosigma3 = t6 * t573 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t590 = t469 * rho[1];
  t591 = 0.1e1 / t590;
  t592 = t314 * t591;
  t593 = t485 * t76;
  t594 = t593 * t65;
  t597 = t485 * t199;
  t599 = t597 * params->c * t65;
  t603 = t314 * t591 * t73;
  t604 = t496 * t333;
  t606 = t604 * t485 * t65;
  t611 = t34 * t236 * t180 * t77 / 0.18e2 + t114 * t188 * t190 * t76 / 0.12e2 - t111 * t113 * t188 * t251 / 0.12e2 - t592 * t594 / 0.72e2 - t592 * t599 / 0.36e2 + t603 * t606 / 0.36e2 + t603 * t599 / 0.72e2;
  t616 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t254 - t565 - 0.3e1 / 0.8e1 * t5 * t64 * t611);
  tv2rhosigma5 = t6 * t616 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t618 = 0.1e1 / t315;
  t623 = 0.1e1 / sigma[0];
  t629 = t111 * t113 * t623;
  t631 = t219 * t44 * t131;
  t634 = 0.1e1 / t302;
  t635 = t314 * t634;
  t640 = t539 * params->c * t213;
  t644 = t314 * t634 * t44;
  t651 = t34 * t618 * t38 * t48 / 0.48e2 - t114 * t623 * t219 * t121 / 0.96e2 + t629 * t631 / 0.96e2 + t635 * t535 * t213 / 0.192e3 + t635 * t640 / 0.96e2 - t644 * t546 * t320 * t213 / 0.96e2 - t644 * t640 / 0.192e3;
  t655 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t651);
  tv2sigma20 = t6 * t655;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t656 = 0.1e1 / t480;
  t661 = 0.1e1 / sigma[2];
  t667 = t111 * t113 * t661;
  t669 = t242 * t73 * t201;
  t672 = 0.1e1 / t469;
  t673 = t314 * t672;
  t678 = t597 * params->c * t236;
  t682 = t314 * t672 * t73;
  t689 = t34 * t656 * t68 * t77 / 0.48e2 - t114 * t661 * t242 * t191 / 0.96e2 + t667 * t669 / 0.96e2 + t673 * t593 * t236 / 0.192e3 + t673 * t678 / 0.96e2 - t682 * t604 * t485 * t236 / 0.96e2 - t682 * t678 / 0.192e3;
  t693 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t689);
  tv2sigma25 = t6 * t693;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t697 = 0.1e1 / t261 / t19;
  t698 = t263 * t90;
  t701 = t262 * t90;
  t704 = t86 * t86;
  t705 = 0.1e1 / t704;
  t706 = t16 * t705;
  t708 = 0.6e1 * t267 - 0.6e1 * t706;
  t709 = my_piecewise5(t10, 0, t14, 0, t708);
  t713 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t697 * t698 + 0.4e1 / 0.3e1 * t701 * t271 + 0.4e1 / 0.3e1 * t23 * t709);
  t714 = t713 * t26;
  t718 = t275 * t99;
  t720 = t5 * t718 * t52;
  t725 = t93 * t288;
  t727 = t5 * t725 * t52;
  t730 = t5 * t280 * t135;
  t736 = 0.1e1 / t98 / t86;
  t737 = t25 * t736;
  t740 = 0.5e1 / 0.36e2 * t5 * t737 * t52;
  t742 = t5 * t289 * t135;
  t745 = t5 * t100 * t342;
  t748 = 0.1e1 / t36 / t302;
  t754 = 0.1e1 / t116 / t532;
  t763 = t302 * t115;
  t764 = 0.1e1 / t763;
  t765 = t764 * t320;
  t773 = t314 * t315 * t764;
  t778 = sigma[0] * sigma[0];
  t779 = t302 * t302;
  t781 = 0.1e1 / t36 / t779;
  t782 = t778 * t781;
  t783 = t314 * t782;
  t785 = 0.1e1 / t319 / t43;
  t787 = t785 * t47 * t40;
  t792 = params->c * t29 * t33;
  t793 = t785 * t129 * t792;
  t798 = t333 * t29 * t33;
  t799 = t785 * t331 * t798;
  t803 = t314 * t782 * t44;
  t804 = t128 * t128;
  t805 = 0.1e1 / t804;
  t806 = t333 * params->c;
  t807 = t805 * t806;
  t810 = t807 * t785 * t29 * t33;
  t817 = 0.7e2 / 0.81e2 * t34 * t35 * t748 * t48 + 0.119e3 / 0.81e2 * t114 * sigma[0] * t754 * t121 - 0.119e3 / 0.81e2 * t126 * t754 * t44 * t131 - 0.11e2 / 0.27e2 * t316 * t765 * t47 - 0.22e2 / 0.27e2 * t316 * t765 * t130 + 0.22e2 / 0.27e2 * t773 * t335 + 0.11e2 / 0.27e2 * t773 * t339 + 0.2e1 / 0.243e3 * t783 * t787 + 0.2e1 / 0.81e2 * t783 * t793 + 0.2e1 / 0.81e2 * t783 * t799 - 0.2e1 / 0.81e2 * t803 * t810 - 0.2e1 / 0.81e2 * t803 * t799 - 0.2e1 / 0.243e3 * t803 * t793;
  t822 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t714 * t52 - 0.3e1 / 0.8e1 * t720 - 0.9e1 / 0.8e1 * t5 * t276 * t135 + t727 / 0.4e1 - 0.3e1 / 0.4e1 * t730 - 0.9e1 / 0.8e1 * t5 * t94 * t342 - t740 + t742 / 0.4e1 - 0.3e1 / 0.8e1 * t745 - 0.3e1 / 0.8e1 * t5 * t27 * t817);
  t824 = 0.1e1 / t348 / t59;
  t825 = t350 * t142;
  t828 = t349 * t142;
  t832 = my_piecewise5(t14, 0, t10, 0, -t708);
  t836 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t824 * t825 + 0.4e1 / 0.3e1 * t828 * t354 + 0.4e1 / 0.3e1 * t61 * t832);
  t837 = t836 * t26;
  t841 = t358 * t99;
  t843 = t5 * t841 * t81;
  t845 = t145 * t288;
  t847 = t5 * t845 * t81;
  t849 = t63 * t736;
  t852 = 0.5e1 / 0.36e2 * t5 * t849 * t81;
  t854 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t837 * t81 - 0.3e1 / 0.8e1 * t843 + t847 / 0.4e1 - t852);
  tv3rho30 = 0.3e1 * t347 + 0.3e1 * t372 + t6 * (t822 + t854);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t857 = 0.2e1 * t398;
  t858 = 0.2e1 * t423;
  t859 = t697 * t159;
  t862 = t262 * t379;
  t867 = 0.2e1 * t267;
  t868 = 0.6e1 * t706;
  t869 = t867 - t868;
  t870 = my_piecewise5(t10, 0, t14, 0, t869);
  t874 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t859 * t263 + 0.8e1 / 0.9e1 * t862 * t90 + 0.4e1 / 0.9e1 * t375 * t271 + 0.4e1 / 0.3e1 * t23 * t870);
  t875 = t874 * t26;
  t879 = t383 * t99;
  t882 = t5 * t879 * t52 / 0.4e1;
  t886 = t162 * t288;
  t888 = t5 * t886 * t52;
  t892 = t5 * t388 * t135 / 0.4e1;
  t901 = -0.3e1 / 0.8e1 * t5 * t875 * t52 - t882 - 0.3e1 / 0.4e1 * t5 * t384 * t135 + t888 / 0.12e2 - t892 - 0.3e1 / 0.8e1 * t5 * t163 * t342 - t720 / 0.8e1 + t727 / 0.6e1 - t730 / 0.4e1 - t740 + t742 / 0.6e1 - t745 / 0.8e1;
  t902 = my_piecewise3(t1, 0, t901);
  t903 = t824 * t170;
  t906 = t349 * t402;
  t912 = my_piecewise5(t14, 0, t10, 0, -t869);
  t916 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t903 * t350 + 0.8e1 / 0.9e1 * t906 * t142 + 0.4e1 / 0.9e1 * t399 * t354 + 0.4e1 / 0.3e1 * t61 * t912);
  t917 = t916 * t26;
  t921 = t406 * t99;
  t924 = t5 * t921 * t81 / 0.4e1;
  t925 = t173 * t288;
  t927 = t5 * t925 * t81;
  t936 = t5 * t363 * t205 / 0.4e1;
  t938 = t5 * t367 * t205;
  t941 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t917 * t81 - t924 + t927 / 0.12e2 - t843 / 0.8e1 + t847 / 0.6e1 - t852 - 0.3e1 / 0.8e1 * t5 * t359 * t205 - t936 + t938 / 0.12e2);
  tv3rho31 = t347 + t372 + t857 + t858 + t6 * (t902 + t941);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t944 = t697 * t428;
  t949 = t262 * t433;
  t952 = -t867 - t868;
  t953 = my_piecewise5(t10, 0, t14, 0, t952);
  t957 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t944 * t90 + 0.8e1 / 0.9e1 * t375 * t379 + 0.4e1 / 0.9e1 * t949 * t90 + 0.4e1 / 0.3e1 * t23 * t953);
  t958 = t957 * t26;
  t962 = t437 * t99;
  t964 = t5 * t962 * t52;
  t973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t958 * t52 - t964 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t438 * t135 - t882 + t888 / 0.6e1 - t892 + t727 / 0.12e2 - t740 + t742 / 0.12e2);
  t974 = t824 * t445;
  t979 = t349 * t449;
  t983 = my_piecewise5(t14, 0, t10, 0, -t952);
  t987 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t974 * t142 + 0.8e1 / 0.9e1 * t399 * t402 + 0.4e1 / 0.9e1 * t979 * t142 + 0.4e1 / 0.3e1 * t61 * t983);
  t988 = t987 * t26;
  t992 = t453 * t99;
  t994 = t5 * t992 * t81;
  t1001 = t5 * t411 * t205;
  t1009 = t5 * t150 * t506;
  t1011 = -0.3e1 / 0.8e1 * t5 * t988 * t81 - t994 / 0.8e1 - t924 + t927 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t407 * t205 - t1001 / 0.4e1 + t847 / 0.12e2 - t852 - t936 + t938 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t146 * t506 - t1009 / 0.8e1;
  t1012 = my_piecewise3(t57, 0, t1011);
  tv3rho32 = t857 + t858 + t444 + t511 + t6 * (t973 + t1012);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1017 = t428 * t159;
  t1023 = -0.6e1 * t267 - 0.6e1 * t706;
  t1024 = my_piecewise5(t10, 0, t14, 0, t1023);
  t1028 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t697 * t1017 + 0.4e1 / 0.3e1 * t375 * t433 + 0.4e1 / 0.3e1 * t23 * t1024);
  t1029 = t1028 * t26;
  t1036 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1029 * t52 - 0.3e1 / 0.8e1 * t964 + t888 / 0.4e1 - t740);
  t1037 = t445 * t170;
  t1043 = my_piecewise5(t14, 0, t10, 0, -t1023);
  t1047 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t824 * t1037 + 0.4e1 / 0.3e1 * t399 * t449 + 0.4e1 / 0.3e1 * t61 * t1043);
  t1048 = t1047 * t26;
  t1064 = 0.1e1 / t66 / t469;
  t1070 = 0.1e1 / t186 / t590;
  t1079 = t469 * t185;
  t1080 = 0.1e1 / t1079;
  t1081 = t1080 * t485;
  t1089 = t314 * t480 * t1080;
  t1094 = sigma[2] * sigma[2];
  t1095 = t469 * t469;
  t1097 = 0.1e1 / t66 / t1095;
  t1098 = t1094 * t1097;
  t1099 = t314 * t1098;
  t1101 = 0.1e1 / t484 / t72;
  t1103 = t1101 * t76 * t40;
  t1107 = t1101 * t199 * t792;
  t1111 = t1101 * t496 * t798;
  t1115 = t314 * t1098 * t73;
  t1116 = t198 * t198;
  t1117 = 0.1e1 / t1116;
  t1118 = t1117 * t806;
  t1121 = t1118 * t1101 * t29 * t33;
  t1128 = 0.7e2 / 0.81e2 * t34 * t65 * t1064 * t77 + 0.119e3 / 0.81e2 * t114 * sigma[2] * t1070 * t191 - 0.119e3 / 0.81e2 * t196 * t1070 * t73 * t201 - 0.11e2 / 0.27e2 * t481 * t1081 * t76 - 0.22e2 / 0.27e2 * t481 * t1081 * t200 + 0.22e2 / 0.27e2 * t1089 * t499 + 0.11e2 / 0.27e2 * t1089 * t503 + 0.2e1 / 0.243e3 * t1099 * t1103 + 0.2e1 / 0.81e2 * t1099 * t1107 + 0.2e1 / 0.81e2 * t1099 * t1111 - 0.2e1 / 0.81e2 * t1115 * t1121 - 0.2e1 / 0.81e2 * t1115 * t1111 - 0.2e1 / 0.243e3 * t1115 * t1107;
  t1133 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1048 * t81 - 0.3e1 / 0.8e1 * t994 - 0.9e1 / 0.8e1 * t5 * t454 * t205 + t927 / 0.4e1 - 0.3e1 / 0.4e1 * t1001 - 0.9e1 / 0.8e1 * t5 * t174 * t506 - t852 + t938 / 0.4e1 - 0.3e1 / 0.8e1 * t1009 - 0.3e1 / 0.8e1 * t5 * t64 * t1128);
  tv3rho33 = 0.3e1 * t444 + 0.3e1 * t511 + t6 * (t1036 + t1133);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1141 = t5 * t280 * t231;
  t1148 = t5 * t289 * t231 / 0.12e2;
  t1150 = t5 * t100 * t553;
  t1164 = t314 * t318;
  t1170 = t314 * t318 * t44;
  t1176 = 0.1e1 / t36 / t763;
  t1178 = t314 * t1176 * t785;
  t1180 = t47 * sigma[0] * t40;
  t1184 = t129 * sigma[0] * t792;
  t1188 = sigma[0] * t29 * t33;
  t1189 = t546 * t1188;
  t1192 = t1176 * t44;
  t1195 = t806 * t785;
  t1196 = t1195 * t1188;
  t1201 = t333 * t785;
  t1202 = t1201 * t1188;
  t1207 = params->c * t785;
  t1208 = t1207 * t1188;
  t1211 = -0.7e1 / 0.54e2 * t34 * t213 * t297 * t48 - 0.37e2 / 0.108e3 * t114 * t304 * t120 * t47 + 0.37e2 / 0.108e3 * t111 * t113 * t304 * t228 + t1164 * t536 / 0.8e1 + t1164 * t541 / 0.4e1 - t1170 * t548 / 0.4e1 - t1170 * t541 / 0.8e1 - t1178 * t1180 / 0.324e3 - t1178 * t1184 / 0.108e3 - t1178 * t1189 / 0.108e3 + t314 * t1192 * t805 * t1196 / 0.108e3 + t314 * t1192 * t331 * t1202 / 0.108e3 + t314 * t1192 * t129 * t1208 / 0.324e3;
  t1216 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t231 - t1141 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t553 + t1148 - t1150 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1211);
  tv3rho2sigma0 = t6 * t1216 + 0.2e1 * t558;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1223 = t5 * t363 * t254;
  t1227 = t5 * t367 * t254 / 0.12e2;
  t1229 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t254 - t1223 / 0.4e1 + t1227);
  tv3rho2sigma2 = t6 * t1229 + 0.2e1 * t567;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1235 = t5 * t388 * t231;
  t1243 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t231 - t1235 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t553 - t1141 / 0.8e1 + t1148 - t1150 / 0.8e1);
  tv3rho2sigma3 = t6 * t1243 + t558 + t573;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1249 = t5 * t411 * t254;
  t1256 = t5 * t150 * t611;
  t1259 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t254 - t1249 / 0.8e1 - t1223 / 0.8e1 + t1227 - 0.3e1 / 0.8e1 * t5 * t146 * t611 - t1256 / 0.8e1);
  tv3rho2sigma5 = t6 * t1259 + t567 + t616;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1267 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t231 - t1235 / 0.4e1 + t1148);
  tv3rho2sigma6 = t6 * t1267 + 0.2e1 * t573;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1290 = t314 * t483;
  t1296 = t314 * t483 * t73;
  t1302 = 0.1e1 / t66 / t1079;
  t1304 = t314 * t1302 * t1101;
  t1306 = t76 * sigma[2] * t40;
  t1310 = t199 * sigma[2] * t792;
  t1314 = sigma[2] * t29 * t33;
  t1315 = t604 * t1314;
  t1318 = t1302 * t73;
  t1321 = t806 * t1101;
  t1322 = t1321 * t1314;
  t1327 = t333 * t1101;
  t1328 = t1327 * t1314;
  t1333 = params->c * t1101;
  t1334 = t1333 * t1314;
  t1337 = -0.7e1 / 0.54e2 * t34 * t236 * t464 * t77 - 0.37e2 / 0.108e3 * t114 * t471 * t190 * t76 + 0.37e2 / 0.108e3 * t111 * t113 * t471 * t251 + t1290 * t594 / 0.8e1 + t1290 * t599 / 0.4e1 - t1296 * t606 / 0.4e1 - t1296 * t599 / 0.8e1 - t1304 * t1306 / 0.324e3 - t1304 * t1310 / 0.108e3 - t1304 * t1315 / 0.108e3 + t314 * t1318 * t1117 * t1322 / 0.108e3 + t314 * t1318 * t496 * t1328 / 0.108e3 + t314 * t1318 * t199 * t1334 / 0.324e3;
  t1342 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t254 - t1249 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t611 + t1227 - t1256 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t1337);
  tv3rho2sigma8 = t6 * t1342 + 0.2e1 * t616;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1349 = t5 * t100 * t651 / 0.8e1;
  t1360 = t314 * t213;
  t1361 = t533 * t320;
  t1362 = t1361 * t47;
  t1365 = t1361 * t130;
  t1369 = t314 * t213 * t533;
  t1375 = 0.1e1 / t36 / t317;
  t1380 = t314 * t1375 * t785;
  t1381 = t130 * t40;
  t1384 = t546 * t40;
  t1387 = t1375 * t44;
  t1388 = t314 * t1387;
  t1395 = -t34 * t618 * t106 * t48 / 0.36e2 + t114 * t623 * t118 * t121 / 0.72e2 - t629 * t132 / 0.72e2 - t1360 * t1362 / 0.36e2 - t1360 * t1365 / 0.18e2 + t1369 * t335 / 0.18e2 + t1369 * t339 / 0.36e2 + t314 * t1375 * t787 / 0.864e3 + t1380 * t1381 / 0.288e3 + t1380 * t1384 / 0.288e3 - t1388 * t810 / 0.288e3 - t1388 * t799 / 0.288e3 - t1388 * t793 / 0.864e3;
  t1400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t651 - t1349 - 0.3e1 / 0.8e1 * t5 * t27 * t1395);
  tv3rhosigma20 = t6 * t1400 + t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1407 = t5 * t150 * t689 / 0.8e1;
  t1409 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t689 - t1407);
  tv3rhosigma25 = t6 * t1409 + t693;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1415 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t651 - t1349);
  tv3rhosigma26 = t6 * t1415 + t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1430 = t314 * t236;
  t1431 = t591 * t485;
  t1432 = t1431 * t76;
  t1435 = t1431 * t200;
  t1439 = t314 * t236 * t591;
  t1445 = 0.1e1 / t66 / t482;
  t1450 = t314 * t1445 * t1101;
  t1451 = t200 * t40;
  t1454 = t604 * t40;
  t1457 = t1445 * t73;
  t1458 = t314 * t1457;
  t1465 = -t34 * t656 * t180 * t77 / 0.36e2 + t114 * t661 * t188 * t191 / 0.72e2 - t667 * t202 / 0.72e2 - t1430 * t1432 / 0.36e2 - t1430 * t1435 / 0.18e2 + t1439 * t499 / 0.18e2 + t1439 * t503 / 0.36e2 + t314 * t1445 * t1103 / 0.864e3 + t1450 * t1451 / 0.288e3 + t1450 * t1454 / 0.288e3 - t1458 * t1121 / 0.288e3 - t1458 * t1111 / 0.288e3 - t1458 * t1107 / 0.864e3;
  t1470 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t689 - t1407 - 0.3e1 / 0.8e1 * t5 * t64 * t1465);
  tv3rhosigma211 = t6 * t1470 + t693;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1472 = t35 * t778;
  t1473 = 0.1e1 / t1472;
  t1478 = 0.1e1 / t778;
  t1484 = t111 * t113 * t1478;
  t1488 = 0.1e1 / t36 / t532;
  t1490 = t314 * t1488 * t785;
  t1492 = t47 * t623 * t40;
  t1496 = t129 * t623 * t792;
  t1500 = t623 * t29 * t33;
  t1501 = t546 * t1500;
  t1504 = t1488 * t44;
  t1506 = t314 * t1504 * t805;
  t1507 = t1195 * t1500;
  t1511 = t314 * t1504 * t331;
  t1512 = t1201 * t1500;
  t1516 = t314 * t1504 * t129;
  t1517 = t1207 * t1500;
  t1520 = -t34 * t1473 * t38 * t48 / 0.32e2 + t114 * t1478 * t219 * t121 / 0.64e2 - t1484 * t631 / 0.64e2 - t1490 * t1492 / 0.2304e4 - t1490 * t1496 / 0.768e3 - t1490 * t1501 / 0.768e3 + t1506 * t1507 / 0.768e3 + t1511 * t1512 / 0.768e3 + t1516 * t1517 / 0.2304e4;
  t1524 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1520);
  tv3sigma30 = t6 * t1524;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1525 = t65 * t1094;
  t1526 = 0.1e1 / t1525;
  t1531 = 0.1e1 / t1094;
  t1537 = t111 * t113 * t1531;
  t1541 = 0.1e1 / t66 / t590;
  t1543 = t314 * t1541 * t1101;
  t1545 = t76 * t661 * t40;
  t1549 = t199 * t661 * t792;
  t1553 = t661 * t29 * t33;
  t1554 = t604 * t1553;
  t1557 = t1541 * t73;
  t1559 = t314 * t1557 * t1117;
  t1560 = t1321 * t1553;
  t1564 = t314 * t1557 * t496;
  t1565 = t1327 * t1553;
  t1569 = t314 * t1557 * t199;
  t1570 = t1333 * t1553;
  t1573 = -t34 * t1526 * t68 * t77 / 0.32e2 + t114 * t1531 * t242 * t191 / 0.64e2 - t1537 * t669 / 0.64e2 - t1543 * t1545 / 0.2304e4 - t1543 * t1549 / 0.768e3 - t1543 * t1554 / 0.768e3 + t1559 * t1560 / 0.768e3 + t1564 * t1565 / 0.768e3 + t1569 * t1570 / 0.2304e4;
  t1577 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t1573);
  tv3sigma39 = t6 * t1577;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t44, t46, t47, t48, t52, t56, t57;
  double t58, t59, t60, t61, t63, t64, t65, t66;
  double t68, t69, t72, t73, t75, t76, t77, t81;
  double t85, tzk0;

  double t86, t87, t88, t89, t90, t93, t94, t98;
  double t99, t100, t103, t104, t106, t111, t112, t113;
  double t114, t115, t116, t118, t120, t121, t126, t128;
  double t129, t130, t131, t132, t135, t140, t142, t145;
  double t146, t150, t153, t155, tvrho0, t158, t159, t162;
  double t163, t168, t170, t173, t174, t178, t180, t185;
  double t186, t188, t190, t191, t196, t198, t199, t200;
  double t201, t202, t205, t210, tvrho1, t213, t219, t226;
  double t228, t231, t235, tvsigma0, tvsigma1, t236, t242, t249;
  double t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t302, t304, t310, t314, t315, t316, t317;
  double t318, t319, t320, t321, t322, t325, t329, t331;
  double t333, t335, t339, t342, t347, t348, t349, t350;
  double t354, t358, t359, t363, t365, t367, t370, t372;
  double tv2rho20, t375, t378, t379, t383, t384, t388, t390;
  double t398, t399, t402, t406, t407, t411, t413, t420;
  double t423, tv2rho21, t428, t432, t433, t437, t438, t444;
  double t445, t449, t453, t454, t464, t469, t471, t477;
  double t480, t481, t482, t483, t484, t485, t486, t487;
  double t490, t494, t496, t499, t503, t506, t511, tv2rho22;
  double t519, t532, t533, t534, t535, t536, t539, t541;
  double t545, t546, t548, t553, t558, tv2rhosigma0, tv2rhosigma1, t565;
  double t567, tv2rhosigma2, t573, tv2rhosigma3, tv2rhosigma4, t590, t591, t592;
  double t593, t594, t597, t599, t603, t604, t606, t611;
  double t616, tv2rhosigma5, t618, t623, t629, t631, t634, t635;
  double t640, t644, t651, t655, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t656, t661, t667, t669, t672, t673, t678;
  double t682, t689, t693, tv2sigma25;

  double t697, t698, t701, t704, t705, t706, t708, t709;
  double t713, t714, t718, t720, t725, t727, t730, t736;
  double t737, t740, t742, t745, t748, t754, t763, t764;
  double t765, t773, t778, t779, t781, t782, t783, t785;
  double t787, t792, t793, t798, t799, t803, t804, t805;
  double t806, t807, t810, t817, t822, t824, t825, t828;
  double t832, t836, t837, t841, t843, t845, t847, t849;
  double t852, t854, tv3rho30, t857, t858, t859, t862, t867;
  double t868, t869, t870, t874, t875, t879, t882, t886;
  double t888, t892, t901, t902, t903, t906, t912, t916;
  double t917, t921, t924, t925, t927, t936, t938, t941;
  double tv3rho31, t944, t949, t952, t953, t957, t958, t962;
  double t964, t973, t974, t979, t983, t987, t988, t992;
  double t994, t1001, t1009, t1011, t1012, tv3rho32, t1017, t1023;
  double t1024, t1028, t1029, t1036, t1037, t1043, t1047, t1048;
  double t1064, t1070, t1079, t1080, t1081, t1089, t1094, t1095;
  double t1097, t1098, t1099, t1101, t1103, t1107, t1111, t1115;
  double t1116, t1117, t1118, t1121, t1128, t1133, tv3rho33, t1141;
  double t1148, t1150, t1164, t1170, t1176, t1178, t1180, t1184;
  double t1188, t1189, t1192, t1195, t1196, t1201, t1202, t1207;
  double t1208, t1211, t1216, tv3rho2sigma0, tv3rho2sigma1, t1223, t1227, t1229;
  double tv3rho2sigma2, t1235, t1243, tv3rho2sigma3, tv3rho2sigma4, t1249, t1256, t1259;
  double tv3rho2sigma5, t1267, tv3rho2sigma6, tv3rho2sigma7, t1290, t1296, t1302, t1304;
  double t1306, t1310, t1314, t1315, t1318, t1321, t1322, t1327;
  double t1328, t1333, t1334, t1337, t1342, tv3rho2sigma8, t1349, t1360;
  double t1361, t1362, t1365, t1369, t1375, t1380, t1381, t1384;
  double t1387, t1388, t1395, t1400, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1407, t1409, tv3rhosigma25, t1415, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1430, t1431, t1432, t1435, t1439, t1445;
  double t1450, t1451, t1454, t1457, t1458, t1465, t1470, tv3rhosigma211;
  double t1472, t1473, t1478, t1484, t1488, t1490, t1492, t1496;
  double t1500, t1501, t1504, t1506, t1507, t1511, t1512, t1516;
  double t1517, t1520, t1524, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1525, t1526, t1531, t1537;
  double t1541, t1543, t1545, t1549, t1553, t1554, t1557, t1559;
  double t1560, t1564, t1565, t1569, t1570, t1573, t1577, tv3sigma39;

  double t1582, t1586, t1590, t1593, t1597, t1602, t1605, t1608;
  double t1610, t1611, t1618, t1619, t1620, t1621, t1624, t1625;
  double t1630, t1631, t1634, t1637, t1638, t1642, t1643, t1644;
  double t1648, t1649, t1664, t1673, t1677, t1678, t1690, t1704;
  double t1709, t1711, t1712, t1718, t1725, t1727, t1728, t1732;
  double t1741, t1747, t1749, t1751, t1752, t1753, t1755, t1756;
  double t1762, t1768, t1772, t1779, t1783, t1787, t1792, t1794;
  double tv4rho40, t1801, t1805, t1809, t1810, t1818, t1819, t1821;
  double t1845, t1846, t1847, t1848, t1852, t1861, t1866, t1867;
  double t1885, t1889, t1896, t1900, t1901, t1904, t1913, t1916;
  double t1917, t1919, t1921, t1922, tv4rho41, t1931, t1935, t1943;
  double t1958, t1971, t1975, t1987, t1988, t1997, t2010, t2014;
  double t2021, t2025, t2034, t2037, t2048, t2051, t2053, t2054;
  double tv4rho42, t2074, t2075, t2079, t2086, t2097, t2098, t2115;
  double t2119, t2126, t2134, t2143, t2153, t2155, t2156, tv4rho43;
  double t2161, t2166, t2172, t2173, t2177, t2186, t2195, t2196;
  double t2203, t2204, t2205, t2206, t2208, t2212, t2216, t2220;
  double t2221, t2225, t2228, t2229, t2235, t2252, t2254, t2268;
  double t2282, t2287, t2292, t2298, t2302, t2316, t2317, tv4rho44;
  double t2325, t2331, t2334, t2341, t2343, t2346, t2352, t2356;
  double t2358, t2360, t2373, t2392, t2399, t2402, t2408, t2414;
  double t2420, t2424, t2439, t2445, tv4rho3sigma0, tv4rho3sigma1, t2452, t2455;
  double t2459, t2461, tv4rho3sigma2, t2463, t2469, t2474, t2478, t2487;
  double t2488, tv4rho3sigma3, tv4rho3sigma4, t2490, t2496, t2498, t2507, t2509;
  double t2512, tv4rho3sigma5, t2518, t2527, tv4rho3sigma6, tv4rho3sigma7, t2533, t2540;
  double t2548, t2550, t2551, tv4rho3sigma8, t2560, tv4rho3sigma9, tv4rho3sigma10, t2578;
  double t2580, t2585, t2603, t2608, t2623, t2630, t2633, t2639;
  double t2643, t2650, t2656, t2668, t2674, tv4rho3sigma11, t2681, t2688;
  double t2690, t2693, t2694, t2697, t2707, t2714, t2739, t2743;
  double t2770, t2776, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2783;
  double t2787, t2789, tv4rho2sigma25, t2795, t2803, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t2809, t2816, t2819, tv4rho2sigma211, t2827, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2839, t2841, t2842, t2846;
  double t2859, t2887, t2915, t2921, tv4rho2sigma217, t2928, t2932, t2934;
  double t2944, t2950, t2953, t2988, t3011, t3017, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t3024;
  double t3026, tv4rhosigma39, t3032, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t3050, t3052, t3054, t3070;
  double t3073, t3104, t3119, t3125, tv4rhosigma319, t3128, t3139, t3149;
  double t3153, t3154, t3163, t3164, t3197, t3219, t3224, tv4sigma40;
  double tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48;
  double tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t3225, t3226, t3231;
  double t3246, t3256, t3260, t3261, t3301, t3317, t3322, tv4sigma414;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = sqrt(sigma[2]);
  t66 = POW_1_3(rho[1]);
  t68 = 0.1e1 / t66 / rho[1];
  t69 = t65 * t68;
  t72 = 0.1e1 + t40 * t69 / 0.12e2;
  t73 = log(t72);
  t75 = params->c * t73 + 0.1e1;
  t76 = 0.1e1 / t75;
  t77 = t73 * t76;
  t81 = 0.1e1 - t34 * t69 * t77 / 0.12e2;
  t85 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t81);
  tzk0 = t56 + t85;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t86 = t6 * t6;
  t87 = 0.1e1 / t86;
  t88 = t16 * t87;
  t89 = t7 - t88;
  t90 = my_piecewise5(t10, 0, t14, 0, t89);
  t93 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t90);
  t94 = t93 * t26;
  t98 = t26 * t26;
  t99 = 0.1e1 / t98;
  t100 = t25 * t99;
  t103 = t5 * t100 * t52 / 0.8e1;
  t104 = rho[0] * rho[0];
  t106 = 0.1e1 / t36 / t104;
  t111 = params->alphaoAx * t28;
  t112 = t32 * t32;
  t113 = 0.1e1 / t112;
  t114 = t111 * t113;
  t115 = t104 * rho[0];
  t116 = t36 * t36;
  t118 = 0.1e1 / t116 / t115;
  t120 = 0.1e1 / t43;
  t121 = t120 * t47;
  t126 = t111 * t113 * sigma[0];
  t128 = t46 * t46;
  t129 = 0.1e1 / t128;
  t130 = t129 * params->c;
  t131 = t130 * t120;
  t132 = t118 * t44 * t131;
  t135 = t34 * t35 * t106 * t48 / 0.9e1 + t114 * sigma[0] * t118 * t121 / 0.18e2 - t126 * t132 / 0.18e2;
  t140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t52 - t103 - 0.3e1 / 0.8e1 * t5 * t27 * t135);
  t142 = my_piecewise5(t14, 0, t10, 0, -t89);
  t145 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t142);
  t146 = t145 * t26;
  t150 = t63 * t99;
  t153 = t5 * t150 * t81 / 0.8e1;
  t155 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t81 - t153);
  tvrho0 = t56 + t85 + t6 * (t140 + t155);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t158 = -t7 - t88;
  t159 = my_piecewise5(t10, 0, t14, 0, t158);
  t162 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t159);
  t163 = t162 * t26;
  t168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t52 - t103);
  t170 = my_piecewise5(t14, 0, t10, 0, -t158);
  t173 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t170);
  t174 = t173 * t26;
  t178 = rho[1] * rho[1];
  t180 = 0.1e1 / t66 / t178;
  t185 = t178 * rho[1];
  t186 = t66 * t66;
  t188 = 0.1e1 / t186 / t185;
  t190 = 0.1e1 / t72;
  t191 = t190 * t76;
  t196 = t111 * t113 * sigma[2];
  t198 = t75 * t75;
  t199 = 0.1e1 / t198;
  t200 = t199 * params->c;
  t201 = t200 * t190;
  t202 = t188 * t73 * t201;
  t205 = t34 * t65 * t180 * t77 / 0.9e1 + t114 * sigma[2] * t188 * t191 / 0.18e2 - t196 * t202 / 0.18e2;
  t210 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t81 - t153 - 0.3e1 / 0.8e1 * t5 * t64 * t205);
  tvrho1 = t56 + t85 + t6 * (t168 + t210);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t213 = 0.1e1 / t35;
  t219 = 0.1e1 / t116 / t104;
  t226 = t44 * t129;
  t228 = t226 * params->c * t120;
  t231 = -t34 * t213 * t38 * t48 / 0.24e2 - t114 * t219 * t120 * t47 / 0.48e2 + t111 * t113 * t219 * t228 / 0.48e2;
  t235 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t231);
  tvsigma0 = t6 * t235;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t236 = 0.1e1 / t65;
  t242 = 0.1e1 / t186 / t178;
  t249 = t73 * t199;
  t251 = t249 * params->c * t190;
  t254 = -t34 * t236 * t68 * t77 / 0.24e2 - t114 * t242 * t190 * t76 / 0.48e2 + t111 * t113 * t242 * t251 / 0.48e2;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t90 * t90;
  t266 = t86 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t87 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t93 * t99;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t98 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t100 * t135;
  t297 = 0.1e1 / t36 / t115;
  t302 = t104 * t104;
  t304 = 0.1e1 / t116 / t302;
  t310 = t304 * t44 * t131;
  t314 = params->alphaoAx / t31;
  t315 = t35 * sigma[0];
  t316 = t314 * t315;
  t317 = t302 * t104;
  t318 = 0.1e1 / t317;
  t319 = t43 * t43;
  t320 = 0.1e1 / t319;
  t321 = t318 * t320;
  t322 = t321 * t47;
  t325 = t321 * t130;
  t329 = t314 * t315 * t318;
  t331 = 0.1e1 / t128 / t46;
  t333 = params->c * params->c;
  t335 = t44 * t331 * t333 * t320;
  t339 = t226 * params->c * t320;
  t342 = -0.7e1 / 0.27e2 * t34 * t35 * t297 * t48 - 0.5e1 / 0.18e2 * t114 * sigma[0] * t304 * t121 + 0.5e1 / 0.18e2 * t126 * t310 + t316 * t322 / 0.27e2 + 0.2e1 / 0.27e2 * t316 * t325 - 0.2e1 / 0.27e2 * t329 * t335 - t329 * t339 / 0.27e2;
  t347 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t135 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t342);
  t348 = t61 * t61;
  t349 = 0.1e1 / t348;
  t350 = t142 * t142;
  t354 = my_piecewise5(t14, 0, t10, 0, -t270);
  t358 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t350 + 0.4e1 / 0.3e1 * t61 * t354);
  t359 = t358 * t26;
  t363 = t145 * t99;
  t365 = t5 * t363 * t81;
  t367 = t63 * t288;
  t370 = t5 * t367 * t81 / 0.12e2;
  t372 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t81 - t365 / 0.4e1 + t370);
  tv2rho20 = 0.2e1 * t140 + 0.2e1 * t155 + t6 * (t347 + t372);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t375 = t262 * t159;
  t378 = 0.2e1 * t268;
  t379 = my_piecewise5(t10, 0, t14, 0, t378);
  t383 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t375 * t90 + 0.4e1 / 0.3e1 * t23 * t379);
  t384 = t383 * t26;
  t388 = t162 * t99;
  t390 = t5 * t388 * t52;
  t398 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t52 - t390 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t135 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t399 = t349 * t170;
  t402 = my_piecewise5(t14, 0, t10, 0, -t378);
  t406 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t399 * t142 + 0.4e1 / 0.3e1 * t61 * t402);
  t407 = t406 * t26;
  t411 = t173 * t99;
  t413 = t5 * t411 * t81;
  t420 = t5 * t150 * t205;
  t423 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t81 - t413 / 0.8e1 - t365 / 0.8e1 + t370 - 0.3e1 / 0.8e1 * t5 * t146 * t205 - t420 / 0.8e1);
  tv2rho21 = t140 + t155 + t168 + t210 + t6 * (t398 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t428 = t159 * t159;
  t432 = 0.2e1 * t87 + 0.2e1 * t268;
  t433 = my_piecewise5(t10, 0, t14, 0, t432);
  t437 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t428 + 0.4e1 / 0.3e1 * t23 * t433);
  t438 = t437 * t26;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t52 - t390 / 0.4e1 + t292);
  t445 = t170 * t170;
  t449 = my_piecewise5(t14, 0, t10, 0, -t432);
  t453 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t349 * t445 + 0.4e1 / 0.3e1 * t61 * t449);
  t454 = t453 * t26;
  t464 = 0.1e1 / t66 / t185;
  t469 = t178 * t178;
  t471 = 0.1e1 / t186 / t469;
  t477 = t471 * t73 * t201;
  t480 = t65 * sigma[2];
  t481 = t314 * t480;
  t482 = t469 * t178;
  t483 = 0.1e1 / t482;
  t484 = t72 * t72;
  t485 = 0.1e1 / t484;
  t486 = t483 * t485;
  t487 = t486 * t76;
  t490 = t486 * t200;
  t494 = t314 * t480 * t483;
  t496 = 0.1e1 / t198 / t75;
  t499 = t73 * t496 * t333 * t485;
  t503 = t249 * params->c * t485;
  t506 = -0.7e1 / 0.27e2 * t34 * t65 * t464 * t77 - 0.5e1 / 0.18e2 * t114 * sigma[2] * t471 * t191 + 0.5e1 / 0.18e2 * t196 * t477 + t481 * t487 / 0.27e2 + 0.2e1 / 0.27e2 * t481 * t490 - 0.2e1 / 0.27e2 * t494 * t499 - t494 * t503 / 0.27e2;
  t511 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t81 - t413 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t205 + t370 - t420 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t506);
  tv2rho22 = 0.2e1 * t168 + 0.2e1 * t210 + t6 * (t444 + t511);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t519 = t5 * t100 * t231 / 0.8e1;
  t532 = t302 * rho[0];
  t533 = 0.1e1 / t532;
  t534 = t314 * t533;
  t535 = t320 * t47;
  t536 = t535 * t35;
  t539 = t320 * t129;
  t541 = t539 * params->c * t35;
  t545 = t314 * t533 * t44;
  t546 = t331 * t333;
  t548 = t546 * t320 * t35;
  t553 = t34 * t213 * t106 * t48 / 0.18e2 + t114 * t118 * t120 * t47 / 0.12e2 - t111 * t113 * t118 * t228 / 0.12e2 - t534 * t536 / 0.72e2 - t534 * t541 / 0.36e2 + t545 * t548 / 0.36e2 + t545 * t541 / 0.72e2;
  t558 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t231 - t519 - 0.3e1 / 0.8e1 * t5 * t27 * t553);
  tv2rhosigma0 = t6 * t558 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t565 = t5 * t150 * t254 / 0.8e1;
  t567 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t254 - t565);
  tv2rhosigma2 = t6 * t567 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t573 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t231 - t519);
  tv2rhosigma3 = t6 * t573 + t235;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t590 = t469 * rho[1];
  t591 = 0.1e1 / t590;
  t592 = t314 * t591;
  t593 = t485 * t76;
  t594 = t593 * t65;
  t597 = t485 * t199;
  t599 = t597 * params->c * t65;
  t603 = t314 * t591 * t73;
  t604 = t496 * t333;
  t606 = t604 * t485 * t65;
  t611 = t34 * t236 * t180 * t77 / 0.18e2 + t114 * t188 * t190 * t76 / 0.12e2 - t111 * t113 * t188 * t251 / 0.12e2 - t592 * t594 / 0.72e2 - t592 * t599 / 0.36e2 + t603 * t606 / 0.36e2 + t603 * t599 / 0.72e2;
  t616 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t254 - t565 - 0.3e1 / 0.8e1 * t5 * t64 * t611);
  tv2rhosigma5 = t6 * t616 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t618 = 0.1e1 / t315;
  t623 = 0.1e1 / sigma[0];
  t629 = t111 * t113 * t623;
  t631 = t219 * t44 * t131;
  t634 = 0.1e1 / t302;
  t635 = t314 * t634;
  t640 = t539 * params->c * t213;
  t644 = t314 * t634 * t44;
  t651 = t34 * t618 * t38 * t48 / 0.48e2 - t114 * t623 * t219 * t121 / 0.96e2 + t629 * t631 / 0.96e2 + t635 * t535 * t213 / 0.192e3 + t635 * t640 / 0.96e2 - t644 * t546 * t320 * t213 / 0.96e2 - t644 * t640 / 0.192e3;
  t655 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t651);
  tv2sigma20 = t6 * t655;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t656 = 0.1e1 / t480;
  t661 = 0.1e1 / sigma[2];
  t667 = t111 * t113 * t661;
  t669 = t242 * t73 * t201;
  t672 = 0.1e1 / t469;
  t673 = t314 * t672;
  t678 = t597 * params->c * t236;
  t682 = t314 * t672 * t73;
  t689 = t34 * t656 * t68 * t77 / 0.48e2 - t114 * t661 * t242 * t191 / 0.96e2 + t667 * t669 / 0.96e2 + t673 * t593 * t236 / 0.192e3 + t673 * t678 / 0.96e2 - t682 * t604 * t485 * t236 / 0.96e2 - t682 * t678 / 0.192e3;
  t693 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t689);
  tv2sigma25 = t6 * t693;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t697 = 0.1e1 / t261 / t19;
  t698 = t263 * t90;
  t701 = t262 * t90;
  t704 = t86 * t86;
  t705 = 0.1e1 / t704;
  t706 = t16 * t705;
  t708 = 0.6e1 * t267 - 0.6e1 * t706;
  t709 = my_piecewise5(t10, 0, t14, 0, t708);
  t713 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t697 * t698 + 0.4e1 / 0.3e1 * t701 * t271 + 0.4e1 / 0.3e1 * t23 * t709);
  t714 = t713 * t26;
  t718 = t275 * t99;
  t720 = t5 * t718 * t52;
  t725 = t93 * t288;
  t727 = t5 * t725 * t52;
  t730 = t5 * t280 * t135;
  t736 = 0.1e1 / t98 / t86;
  t737 = t25 * t736;
  t740 = 0.5e1 / 0.36e2 * t5 * t737 * t52;
  t742 = t5 * t289 * t135;
  t745 = t5 * t100 * t342;
  t748 = 0.1e1 / t36 / t302;
  t754 = 0.1e1 / t116 / t532;
  t763 = t302 * t115;
  t764 = 0.1e1 / t763;
  t765 = t764 * t320;
  t773 = t314 * t315 * t764;
  t778 = sigma[0] * sigma[0];
  t779 = t302 * t302;
  t781 = 0.1e1 / t36 / t779;
  t782 = t778 * t781;
  t783 = t314 * t782;
  t785 = 0.1e1 / t319 / t43;
  t787 = t785 * t47 * t40;
  t792 = params->c * t29 * t33;
  t793 = t785 * t129 * t792;
  t798 = t333 * t29 * t33;
  t799 = t785 * t331 * t798;
  t803 = t314 * t782 * t44;
  t804 = t128 * t128;
  t805 = 0.1e1 / t804;
  t806 = t333 * params->c;
  t807 = t805 * t806;
  t810 = t807 * t785 * t29 * t33;
  t817 = 0.7e2 / 0.81e2 * t34 * t35 * t748 * t48 + 0.119e3 / 0.81e2 * t114 * sigma[0] * t754 * t121 - 0.119e3 / 0.81e2 * t126 * t754 * t44 * t131 - 0.11e2 / 0.27e2 * t316 * t765 * t47 - 0.22e2 / 0.27e2 * t316 * t765 * t130 + 0.22e2 / 0.27e2 * t773 * t335 + 0.11e2 / 0.27e2 * t773 * t339 + 0.2e1 / 0.243e3 * t783 * t787 + 0.2e1 / 0.81e2 * t783 * t793 + 0.2e1 / 0.81e2 * t783 * t799 - 0.2e1 / 0.81e2 * t803 * t810 - 0.2e1 / 0.81e2 * t803 * t799 - 0.2e1 / 0.243e3 * t803 * t793;
  t822 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t714 * t52 - 0.3e1 / 0.8e1 * t720 - 0.9e1 / 0.8e1 * t5 * t276 * t135 + t727 / 0.4e1 - 0.3e1 / 0.4e1 * t730 - 0.9e1 / 0.8e1 * t5 * t94 * t342 - t740 + t742 / 0.4e1 - 0.3e1 / 0.8e1 * t745 - 0.3e1 / 0.8e1 * t5 * t27 * t817);
  t824 = 0.1e1 / t348 / t59;
  t825 = t350 * t142;
  t828 = t349 * t142;
  t832 = my_piecewise5(t14, 0, t10, 0, -t708);
  t836 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t824 * t825 + 0.4e1 / 0.3e1 * t828 * t354 + 0.4e1 / 0.3e1 * t61 * t832);
  t837 = t836 * t26;
  t841 = t358 * t99;
  t843 = t5 * t841 * t81;
  t845 = t145 * t288;
  t847 = t5 * t845 * t81;
  t849 = t63 * t736;
  t852 = 0.5e1 / 0.36e2 * t5 * t849 * t81;
  t854 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t837 * t81 - 0.3e1 / 0.8e1 * t843 + t847 / 0.4e1 - t852);
  tv3rho30 = 0.3e1 * t347 + 0.3e1 * t372 + t6 * (t822 + t854);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t857 = 0.2e1 * t398;
  t858 = 0.2e1 * t423;
  t859 = t697 * t159;
  t862 = t262 * t379;
  t867 = 0.2e1 * t267;
  t868 = 0.6e1 * t706;
  t869 = t867 - t868;
  t870 = my_piecewise5(t10, 0, t14, 0, t869);
  t874 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t859 * t263 + 0.8e1 / 0.9e1 * t862 * t90 + 0.4e1 / 0.9e1 * t375 * t271 + 0.4e1 / 0.3e1 * t23 * t870);
  t875 = t874 * t26;
  t879 = t383 * t99;
  t882 = t5 * t879 * t52 / 0.4e1;
  t886 = t162 * t288;
  t888 = t5 * t886 * t52;
  t892 = t5 * t388 * t135 / 0.4e1;
  t901 = -0.3e1 / 0.8e1 * t5 * t875 * t52 - t882 - 0.3e1 / 0.4e1 * t5 * t384 * t135 + t888 / 0.12e2 - t892 - 0.3e1 / 0.8e1 * t5 * t163 * t342 - t720 / 0.8e1 + t727 / 0.6e1 - t730 / 0.4e1 - t740 + t742 / 0.6e1 - t745 / 0.8e1;
  t902 = my_piecewise3(t1, 0, t901);
  t903 = t824 * t170;
  t906 = t349 * t402;
  t912 = my_piecewise5(t14, 0, t10, 0, -t869);
  t916 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t903 * t350 + 0.8e1 / 0.9e1 * t906 * t142 + 0.4e1 / 0.9e1 * t399 * t354 + 0.4e1 / 0.3e1 * t61 * t912);
  t917 = t916 * t26;
  t921 = t406 * t99;
  t924 = t5 * t921 * t81 / 0.4e1;
  t925 = t173 * t288;
  t927 = t5 * t925 * t81;
  t936 = t5 * t363 * t205 / 0.4e1;
  t938 = t5 * t367 * t205;
  t941 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t917 * t81 - t924 + t927 / 0.12e2 - t843 / 0.8e1 + t847 / 0.6e1 - t852 - 0.3e1 / 0.8e1 * t5 * t359 * t205 - t936 + t938 / 0.12e2);
  tv3rho31 = t347 + t372 + t857 + t858 + t6 * (t902 + t941);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t944 = t697 * t428;
  t949 = t262 * t433;
  t952 = -t867 - t868;
  t953 = my_piecewise5(t10, 0, t14, 0, t952);
  t957 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t944 * t90 + 0.8e1 / 0.9e1 * t375 * t379 + 0.4e1 / 0.9e1 * t949 * t90 + 0.4e1 / 0.3e1 * t23 * t953);
  t958 = t957 * t26;
  t962 = t437 * t99;
  t964 = t5 * t962 * t52;
  t973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t958 * t52 - t964 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t438 * t135 - t882 + t888 / 0.6e1 - t892 + t727 / 0.12e2 - t740 + t742 / 0.12e2);
  t974 = t824 * t445;
  t979 = t349 * t449;
  t983 = my_piecewise5(t14, 0, t10, 0, -t952);
  t987 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t974 * t142 + 0.8e1 / 0.9e1 * t399 * t402 + 0.4e1 / 0.9e1 * t979 * t142 + 0.4e1 / 0.3e1 * t61 * t983);
  t988 = t987 * t26;
  t992 = t453 * t99;
  t994 = t5 * t992 * t81;
  t1001 = t5 * t411 * t205;
  t1009 = t5 * t150 * t506;
  t1011 = -0.3e1 / 0.8e1 * t5 * t988 * t81 - t994 / 0.8e1 - t924 + t927 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t407 * t205 - t1001 / 0.4e1 + t847 / 0.12e2 - t852 - t936 + t938 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t146 * t506 - t1009 / 0.8e1;
  t1012 = my_piecewise3(t57, 0, t1011);
  tv3rho32 = t857 + t858 + t444 + t511 + t6 * (t973 + t1012);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1017 = t428 * t159;
  t1023 = -0.6e1 * t267 - 0.6e1 * t706;
  t1024 = my_piecewise5(t10, 0, t14, 0, t1023);
  t1028 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t697 * t1017 + 0.4e1 / 0.3e1 * t375 * t433 + 0.4e1 / 0.3e1 * t23 * t1024);
  t1029 = t1028 * t26;
  t1036 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1029 * t52 - 0.3e1 / 0.8e1 * t964 + t888 / 0.4e1 - t740);
  t1037 = t445 * t170;
  t1043 = my_piecewise5(t14, 0, t10, 0, -t1023);
  t1047 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t824 * t1037 + 0.4e1 / 0.3e1 * t399 * t449 + 0.4e1 / 0.3e1 * t61 * t1043);
  t1048 = t1047 * t26;
  t1064 = 0.1e1 / t66 / t469;
  t1070 = 0.1e1 / t186 / t590;
  t1079 = t469 * t185;
  t1080 = 0.1e1 / t1079;
  t1081 = t1080 * t485;
  t1089 = t314 * t480 * t1080;
  t1094 = sigma[2] * sigma[2];
  t1095 = t469 * t469;
  t1097 = 0.1e1 / t66 / t1095;
  t1098 = t1094 * t1097;
  t1099 = t314 * t1098;
  t1101 = 0.1e1 / t484 / t72;
  t1103 = t1101 * t76 * t40;
  t1107 = t1101 * t199 * t792;
  t1111 = t1101 * t496 * t798;
  t1115 = t314 * t1098 * t73;
  t1116 = t198 * t198;
  t1117 = 0.1e1 / t1116;
  t1118 = t1117 * t806;
  t1121 = t1118 * t1101 * t29 * t33;
  t1128 = 0.7e2 / 0.81e2 * t34 * t65 * t1064 * t77 + 0.119e3 / 0.81e2 * t114 * sigma[2] * t1070 * t191 - 0.119e3 / 0.81e2 * t196 * t1070 * t73 * t201 - 0.11e2 / 0.27e2 * t481 * t1081 * t76 - 0.22e2 / 0.27e2 * t481 * t1081 * t200 + 0.22e2 / 0.27e2 * t1089 * t499 + 0.11e2 / 0.27e2 * t1089 * t503 + 0.2e1 / 0.243e3 * t1099 * t1103 + 0.2e1 / 0.81e2 * t1099 * t1107 + 0.2e1 / 0.81e2 * t1099 * t1111 - 0.2e1 / 0.81e2 * t1115 * t1121 - 0.2e1 / 0.81e2 * t1115 * t1111 - 0.2e1 / 0.243e3 * t1115 * t1107;
  t1133 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1048 * t81 - 0.3e1 / 0.8e1 * t994 - 0.9e1 / 0.8e1 * t5 * t454 * t205 + t927 / 0.4e1 - 0.3e1 / 0.4e1 * t1001 - 0.9e1 / 0.8e1 * t5 * t174 * t506 - t852 + t938 / 0.4e1 - 0.3e1 / 0.8e1 * t1009 - 0.3e1 / 0.8e1 * t5 * t64 * t1128);
  tv3rho33 = 0.3e1 * t444 + 0.3e1 * t511 + t6 * (t1036 + t1133);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1141 = t5 * t280 * t231;
  t1148 = t5 * t289 * t231 / 0.12e2;
  t1150 = t5 * t100 * t553;
  t1164 = t314 * t318;
  t1170 = t314 * t318 * t44;
  t1176 = 0.1e1 / t36 / t763;
  t1178 = t314 * t1176 * t785;
  t1180 = t47 * sigma[0] * t40;
  t1184 = t129 * sigma[0] * t792;
  t1188 = sigma[0] * t29 * t33;
  t1189 = t546 * t1188;
  t1192 = t1176 * t44;
  t1195 = t806 * t785;
  t1196 = t1195 * t1188;
  t1201 = t333 * t785;
  t1202 = t1201 * t1188;
  t1207 = params->c * t785;
  t1208 = t1207 * t1188;
  t1211 = -0.7e1 / 0.54e2 * t34 * t213 * t297 * t48 - 0.37e2 / 0.108e3 * t114 * t304 * t120 * t47 + 0.37e2 / 0.108e3 * t111 * t113 * t304 * t228 + t1164 * t536 / 0.8e1 + t1164 * t541 / 0.4e1 - t1170 * t548 / 0.4e1 - t1170 * t541 / 0.8e1 - t1178 * t1180 / 0.324e3 - t1178 * t1184 / 0.108e3 - t1178 * t1189 / 0.108e3 + t314 * t1192 * t805 * t1196 / 0.108e3 + t314 * t1192 * t331 * t1202 / 0.108e3 + t314 * t1192 * t129 * t1208 / 0.324e3;
  t1216 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t231 - t1141 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t553 + t1148 - t1150 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1211);
  tv3rho2sigma0 = t6 * t1216 + 0.2e1 * t558;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1223 = t5 * t363 * t254;
  t1227 = t5 * t367 * t254 / 0.12e2;
  t1229 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t254 - t1223 / 0.4e1 + t1227);
  tv3rho2sigma2 = t6 * t1229 + 0.2e1 * t567;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1235 = t5 * t388 * t231;
  t1243 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t231 - t1235 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t553 - t1141 / 0.8e1 + t1148 - t1150 / 0.8e1);
  tv3rho2sigma3 = t6 * t1243 + t558 + t573;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1249 = t5 * t411 * t254;
  t1256 = t5 * t150 * t611;
  t1259 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t254 - t1249 / 0.8e1 - t1223 / 0.8e1 + t1227 - 0.3e1 / 0.8e1 * t5 * t146 * t611 - t1256 / 0.8e1);
  tv3rho2sigma5 = t6 * t1259 + t567 + t616;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1267 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t231 - t1235 / 0.4e1 + t1148);
  tv3rho2sigma6 = t6 * t1267 + 0.2e1 * t573;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1290 = t314 * t483;
  t1296 = t314 * t483 * t73;
  t1302 = 0.1e1 / t66 / t1079;
  t1304 = t314 * t1302 * t1101;
  t1306 = t76 * sigma[2] * t40;
  t1310 = t199 * sigma[2] * t792;
  t1314 = sigma[2] * t29 * t33;
  t1315 = t604 * t1314;
  t1318 = t1302 * t73;
  t1321 = t806 * t1101;
  t1322 = t1321 * t1314;
  t1327 = t333 * t1101;
  t1328 = t1327 * t1314;
  t1333 = params->c * t1101;
  t1334 = t1333 * t1314;
  t1337 = -0.7e1 / 0.54e2 * t34 * t236 * t464 * t77 - 0.37e2 / 0.108e3 * t114 * t471 * t190 * t76 + 0.37e2 / 0.108e3 * t111 * t113 * t471 * t251 + t1290 * t594 / 0.8e1 + t1290 * t599 / 0.4e1 - t1296 * t606 / 0.4e1 - t1296 * t599 / 0.8e1 - t1304 * t1306 / 0.324e3 - t1304 * t1310 / 0.108e3 - t1304 * t1315 / 0.108e3 + t314 * t1318 * t1117 * t1322 / 0.108e3 + t314 * t1318 * t496 * t1328 / 0.108e3 + t314 * t1318 * t199 * t1334 / 0.324e3;
  t1342 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t254 - t1249 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t611 + t1227 - t1256 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t1337);
  tv3rho2sigma8 = t6 * t1342 + 0.2e1 * t616;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1349 = t5 * t100 * t651 / 0.8e1;
  t1360 = t314 * t213;
  t1361 = t533 * t320;
  t1362 = t1361 * t47;
  t1365 = t1361 * t130;
  t1369 = t314 * t213 * t533;
  t1375 = 0.1e1 / t36 / t317;
  t1380 = t314 * t1375 * t785;
  t1381 = t130 * t40;
  t1384 = t546 * t40;
  t1387 = t1375 * t44;
  t1388 = t314 * t1387;
  t1395 = -t34 * t618 * t106 * t48 / 0.36e2 + t114 * t623 * t118 * t121 / 0.72e2 - t629 * t132 / 0.72e2 - t1360 * t1362 / 0.36e2 - t1360 * t1365 / 0.18e2 + t1369 * t335 / 0.18e2 + t1369 * t339 / 0.36e2 + t314 * t1375 * t787 / 0.864e3 + t1380 * t1381 / 0.288e3 + t1380 * t1384 / 0.288e3 - t1388 * t810 / 0.288e3 - t1388 * t799 / 0.288e3 - t1388 * t793 / 0.864e3;
  t1400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t651 - t1349 - 0.3e1 / 0.8e1 * t5 * t27 * t1395);
  tv3rhosigma20 = t6 * t1400 + t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1407 = t5 * t150 * t689 / 0.8e1;
  t1409 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t689 - t1407);
  tv3rhosigma25 = t6 * t1409 + t693;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1415 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t651 - t1349);
  tv3rhosigma26 = t6 * t1415 + t655;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1430 = t314 * t236;
  t1431 = t591 * t485;
  t1432 = t1431 * t76;
  t1435 = t1431 * t200;
  t1439 = t314 * t236 * t591;
  t1445 = 0.1e1 / t66 / t482;
  t1450 = t314 * t1445 * t1101;
  t1451 = t200 * t40;
  t1454 = t604 * t40;
  t1457 = t1445 * t73;
  t1458 = t314 * t1457;
  t1465 = -t34 * t656 * t180 * t77 / 0.36e2 + t114 * t661 * t188 * t191 / 0.72e2 - t667 * t202 / 0.72e2 - t1430 * t1432 / 0.36e2 - t1430 * t1435 / 0.18e2 + t1439 * t499 / 0.18e2 + t1439 * t503 / 0.36e2 + t314 * t1445 * t1103 / 0.864e3 + t1450 * t1451 / 0.288e3 + t1450 * t1454 / 0.288e3 - t1458 * t1121 / 0.288e3 - t1458 * t1111 / 0.288e3 - t1458 * t1107 / 0.864e3;
  t1470 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t689 - t1407 - 0.3e1 / 0.8e1 * t5 * t64 * t1465);
  tv3rhosigma211 = t6 * t1470 + t693;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1472 = t35 * t778;
  t1473 = 0.1e1 / t1472;
  t1478 = 0.1e1 / t778;
  t1484 = t111 * t113 * t1478;
  t1488 = 0.1e1 / t36 / t532;
  t1490 = t314 * t1488 * t785;
  t1492 = t47 * t623 * t40;
  t1496 = t129 * t623 * t792;
  t1500 = t623 * t29 * t33;
  t1501 = t546 * t1500;
  t1504 = t1488 * t44;
  t1506 = t314 * t1504 * t805;
  t1507 = t1195 * t1500;
  t1511 = t314 * t1504 * t331;
  t1512 = t1201 * t1500;
  t1516 = t314 * t1504 * t129;
  t1517 = t1207 * t1500;
  t1520 = -t34 * t1473 * t38 * t48 / 0.32e2 + t114 * t1478 * t219 * t121 / 0.64e2 - t1484 * t631 / 0.64e2 - t1490 * t1492 / 0.2304e4 - t1490 * t1496 / 0.768e3 - t1490 * t1501 / 0.768e3 + t1506 * t1507 / 0.768e3 + t1511 * t1512 / 0.768e3 + t1516 * t1517 / 0.2304e4;
  t1524 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1520);
  tv3sigma30 = t6 * t1524;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1525 = t65 * t1094;
  t1526 = 0.1e1 / t1525;
  t1531 = 0.1e1 / t1094;
  t1537 = t111 * t113 * t1531;
  t1541 = 0.1e1 / t66 / t590;
  t1543 = t314 * t1541 * t1101;
  t1545 = t76 * t661 * t40;
  t1549 = t199 * t661 * t792;
  t1553 = t661 * t29 * t33;
  t1554 = t604 * t1553;
  t1557 = t1541 * t73;
  t1559 = t314 * t1557 * t1117;
  t1560 = t1321 * t1553;
  t1564 = t314 * t1557 * t496;
  t1565 = t1327 * t1553;
  t1569 = t314 * t1557 * t199;
  t1570 = t1333 * t1553;
  t1573 = -t34 * t1526 * t68 * t77 / 0.32e2 + t114 * t1531 * t242 * t191 / 0.64e2 - t1537 * t669 / 0.64e2 - t1543 * t1545 / 0.2304e4 - t1543 * t1549 / 0.768e3 - t1543 * t1554 / 0.768e3 + t1559 * t1560 / 0.768e3 + t1564 * t1565 / 0.768e3 + t1569 * t1570 / 0.2304e4;
  t1577 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t1573);
  tv3sigma39 = t6 * t1577;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1582 = t5 * t713 * t99 * t52;
  t1586 = t5 * t275 * t288 * t52;
  t1590 = t5 * t93 * t736 * t52;
  t1593 = 0.1e1 / t98 / t266;
  t1597 = 0.1e2 / 0.27e2 * t5 * t25 * t1593 * t52;
  t1602 = t5 * t737 * t135;
  t1605 = t5 * t289 * t342;
  t1608 = t5 * t100 * t817;
  t1610 = 0.1e1 / t779;
  t1611 = t1610 * t320;
  t1618 = t1472 / t116 / t779 / t104;
  t1619 = t314 * t1618;
  t1620 = t319 * t319;
  t1621 = 0.1e1 / t1620;
  t1624 = t333 * t28 * t113;
  t1625 = t1621 * t331 * t1624;
  t1630 = t806 * t28 * t113;
  t1631 = t1621 * t805 * t1630;
  t1634 = t779 * rho[0];
  t1637 = t778 / t36 / t1634;
  t1638 = t314 * t1637;
  t1642 = t28 * t113;
  t1643 = t1642 * params->c;
  t1644 = t1621 * t129 * t1643;
  t1648 = 0.1e1 / t116 / t317;
  t1649 = t1648 * t44;
  t1664 = t314 * t315 * t1610;
  t1673 = t314 * t1618 * t44;
  t1677 = 0.1e1 / t804 / t46;
  t1678 = t333 * t333;
  t1690 = t314 * t1637 * t44;
  t1704 = -0.931e3 / 0.243e3 * t1664 * t339 - 0.116e3 / 0.729e3 * t1638 * t787 - 0.4e1 / 0.243e3 * t1673 * t1644 - 0.16e2 / 0.243e3 * t1673 * t1677 * t1678 * t1621 * t28 * t113 - 0.8e1 / 0.81e2 * t1673 * t1631 - 0.44e2 / 0.729e3 * t1673 * t1625 + 0.116e3 / 0.243e3 * t1690 * t810 + 0.116e3 / 0.243e3 * t1690 * t799 + 0.116e3 / 0.729e3 * t1690 * t793 - 0.721e3 / 0.81e2 * t114 * sigma[0] * t1648 * t121 + 0.1862e4 / 0.243e3 * t316 * t1611 * t130;
  t1709 = t19 * t19;
  t1711 = 0.1e1 / t261 / t1709;
  t1712 = t263 * t263;
  t1718 = t271 * t271;
  t1725 = t16 / t704 / t6;
  t1727 = -0.24e2 * t705 + 0.24e2 * t1725;
  t1728 = my_piecewise5(t10, 0, t14, 0, t1727);
  t1732 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1711 * t1712 - 0.16e2 / 0.9e1 * t697 * t263 * t271 + 0.4e1 / 0.3e1 * t262 * t1718 + 0.16e2 / 0.9e1 * t701 * t709 + 0.4e1 / 0.3e1 * t23 * t1728);
  t1741 = t5 * t718 * t135;
  t1747 = t5 * t725 * t135;
  t1749 = t5 * t280 * t342;
  t1751 = -t1582 / 0.2e1 + t1586 / 0.2e1 - 0.5e1 / 0.9e1 * t1590 + t1597 - 0.3e1 / 0.2e1 * t5 * t94 * t817 - 0.5e1 / 0.9e1 * t1602 + t1605 / 0.2e1 - t1608 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.931e3 / 0.243e3 * t316 * t1611 * t47 + 0.8e1 / 0.81e2 * t1619 * t1625 + 0.16e2 / 0.243e3 * t1619 * t1631 - 0.116e3 / 0.243e3 * t1638 * t799 + 0.44e2 / 0.729e3 * t1619 * t1644 + 0.721e3 / 0.81e2 * t126 * t1649 * t131 - 0.116e3 / 0.243e3 * t1638 * t793 + 0.4e1 / 0.243e3 * t1619 * t1621 * t47 * t1642 - 0.91e3 / 0.243e3 * t34 * t35 * t1488 * t48 - 0.1862e4 / 0.243e3 * t1664 * t335 + t1704) - 0.3e1 / 0.8e1 * t5 * t1732 * t26 * t52 - 0.3e1 / 0.2e1 * t5 * t714 * t135 - 0.3e1 / 0.2e1 * t1741 - 0.9e1 / 0.4e1 * t5 * t276 * t342 + t1747 - 0.3e1 / 0.2e1 * t1749;
  t1752 = my_piecewise3(t1, 0, t1751);
  t1753 = t59 * t59;
  t1755 = 0.1e1 / t348 / t1753;
  t1756 = t350 * t350;
  t1762 = t354 * t354;
  t1768 = my_piecewise5(t14, 0, t10, 0, -t1727);
  t1772 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1755 * t1756 - 0.16e2 / 0.9e1 * t824 * t350 * t354 + 0.4e1 / 0.3e1 * t349 * t1762 + 0.16e2 / 0.9e1 * t828 * t832 + 0.4e1 / 0.3e1 * t61 * t1768);
  t1779 = t5 * t836 * t99 * t81;
  t1783 = t5 * t358 * t288 * t81;
  t1787 = t5 * t145 * t736 * t81;
  t1792 = 0.1e2 / 0.27e2 * t5 * t63 * t1593 * t81;
  t1794 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1772 * t26 * t81 - t1779 / 0.2e1 + t1783 / 0.2e1 - 0.5e1 / 0.9e1 * t1787 + t1792);
  tv4rho40 = 0.4e1 * t822 + 0.4e1 * t854 + t6 * (t1752 + t1794);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1801 = t5 * t162 * t736 * t52;
  t1805 = t5 * t874 * t99 * t52;
  t1809 = t5 * t383 * t288 * t52;
  t1810 = t1809 / 0.4e1;
  t1818 = t5 * t886 * t135;
  t1819 = t1818 / 0.4e1;
  t1821 = t5 * t388 * t342;
  t1845 = 0.12e2 * t705;
  t1846 = 0.24e2 * t1725;
  t1847 = -t1845 + t1846;
  t1848 = my_piecewise5(t10, 0, t14, 0, t1847);
  t1852 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1711 * t159 * t698 - 0.8e1 / 0.9e1 * t697 * t379 * t263 - 0.8e1 / 0.9e1 * t859 * t90 * t271 + 0.4e1 / 0.3e1 * t262 * t870 * t90 + 0.4e1 / 0.3e1 * t862 * t271 + 0.4e1 / 0.9e1 * t375 * t709 + 0.4e1 / 0.3e1 * t23 * t1848);
  t1861 = t5 * t879 * t135;
  t1866 = -0.5e1 / 0.36e2 * t1801 - 0.3e1 / 0.8e1 * t1805 + t1810 - t1582 / 0.8e1 + t1586 / 0.4e1 - 0.5e1 / 0.12e2 * t1590 + t1597 - 0.9e1 / 0.8e1 * t5 * t384 * t342 + t1819 - 0.3e1 / 0.8e1 * t1821 - 0.3e1 / 0.8e1 * t5 * t163 * t817 - 0.5e1 / 0.12e2 * t1602 + t1605 / 0.4e1 - t1608 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1852 * t26 * t52 - 0.9e1 / 0.8e1 * t5 * t875 * t135 - 0.3e1 / 0.4e1 * t1861 - 0.3e1 / 0.8e1 * t1741 + t1747 / 0.2e1 - 0.3e1 / 0.8e1 * t1749;
  t1867 = my_piecewise3(t1, 0, t1866);
  t1885 = my_piecewise5(t14, 0, t10, 0, -t1847);
  t1889 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1755 * t170 * t825 - 0.8e1 / 0.9e1 * t824 * t402 * t350 - 0.8e1 / 0.9e1 * t903 * t142 * t354 + 0.4e1 / 0.3e1 * t349 * t912 * t142 + 0.4e1 / 0.3e1 * t906 * t354 + 0.4e1 / 0.9e1 * t399 * t832 + 0.4e1 / 0.3e1 * t61 * t1885);
  t1896 = t5 * t916 * t99 * t81;
  t1900 = t5 * t406 * t288 * t81;
  t1901 = t1900 / 0.4e1;
  t1904 = t5 * t173 * t736 * t81;
  t1913 = t5 * t841 * t205;
  t1916 = t5 * t845 * t205;
  t1917 = t1916 / 0.4e1;
  t1919 = t5 * t849 * t205;
  t1921 = -0.3e1 / 0.8e1 * t5 * t1889 * t26 * t81 - 0.3e1 / 0.8e1 * t1896 + t1901 - 0.5e1 / 0.36e2 * t1904 - t1779 / 0.8e1 + t1783 / 0.4e1 - 0.5e1 / 0.12e2 * t1787 + t1792 - 0.3e1 / 0.8e1 * t5 * t837 * t205 - 0.3e1 / 0.8e1 * t1913 + t1917 - 0.5e1 / 0.36e2 * t1919;
  t1922 = my_piecewise3(t57, 0, t1921);
  tv4rho41 = t822 + t854 + 0.3e1 * t902 + 0.3e1 * t941 + t6 * (t1867 + t1922);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1931 = t5 * t957 * t99 * t52;
  t1935 = t5 * t437 * t288 * t52;
  t1943 = t5 * t962 * t135;
  t1958 = t379 * t379;
  t1971 = my_piecewise5(t10, 0, t14, 0, t1846);
  t1975 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1711 * t428 * t263 - 0.32e2 / 0.27e2 * t859 * t90 * t379 - 0.8e1 / 0.27e2 * t944 * t271 + 0.8e1 / 0.9e1 * t262 * t1958 + 0.8e1 / 0.9e1 * t375 * t870 - 0.8e1 / 0.27e2 * t697 * t433 * t263 + 0.8e1 / 0.9e1 * t262 * t953 * t90 + 0.4e1 / 0.9e1 * t949 * t271 + 0.4e1 / 0.3e1 * t23 * t1971);
  t1987 = -t1931 / 0.4e1 + t1935 / 0.12e2 - 0.5e1 / 0.18e2 * t1801 - t1805 / 0.4e1 + t1809 / 0.3e1 + t1586 / 0.12e2 - 0.5e1 / 0.18e2 * t1590 + t1597 - t1943 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t438 * t342 + t1818 / 0.3e1 - t1821 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t1975 * t26 * t52 - 0.3e1 / 0.4e1 * t5 * t958 * t135 - 0.5e1 / 0.18e2 * t1602 + t1605 / 0.12e2 - t1861 / 0.2e1 + t1747 / 0.6e1;
  t1988 = my_piecewise3(t1, 0, t1987);
  t1997 = t402 * t402;
  t2010 = my_piecewise5(t14, 0, t10, 0, -t1846);
  t2014 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1755 * t445 * t350 - 0.32e2 / 0.27e2 * t903 * t142 * t402 - 0.8e1 / 0.27e2 * t974 * t354 + 0.8e1 / 0.9e1 * t349 * t1997 + 0.8e1 / 0.9e1 * t399 * t912 - 0.8e1 / 0.27e2 * t824 * t449 * t350 + 0.8e1 / 0.9e1 * t349 * t983 * t142 + 0.4e1 / 0.9e1 * t979 * t354 + 0.4e1 / 0.3e1 * t61 * t2010);
  t2021 = t5 * t987 * t99 * t81;
  t2025 = t5 * t453 * t288 * t81;
  t2034 = t5 * t921 * t205;
  t2037 = t5 * t925 * t205;
  t2048 = t5 * t363 * t506;
  t2051 = t5 * t367 * t506;
  t2053 = -0.3e1 / 0.8e1 * t5 * t2014 * t26 * t81 - t2021 / 0.4e1 + t2025 / 0.12e2 - t1896 / 0.4e1 + t1900 / 0.3e1 - 0.5e1 / 0.18e2 * t1904 - 0.3e1 / 0.4e1 * t5 * t917 * t205 - t2034 / 0.2e1 + t2037 / 0.6e1 + t1783 / 0.12e2 - 0.5e1 / 0.18e2 * t1787 + t1792 - t1913 / 0.4e1 + t1916 / 0.3e1 - 0.5e1 / 0.18e2 * t1919 - 0.3e1 / 0.8e1 * t5 * t359 * t506 - t2048 / 0.4e1 + t2051 / 0.12e2;
  t2054 = my_piecewise3(t57, 0, t2053);
  tv4rho42 = 0.2e1 * t902 + 0.2e1 * t941 + 0.2e1 * t973 + 0.2e1 * t1012 + t6 * (t1988 + t2054);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2074 = t1845 + t1846;
  t2075 = my_piecewise5(t10, 0, t14, 0, t2074);
  t2079 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1711 * t1017 * t90 - 0.8e1 / 0.9e1 * t944 * t379 - 0.8e1 / 0.9e1 * t859 * t433 * t90 + 0.4e1 / 0.3e1 * t862 * t433 + 0.4e1 / 0.3e1 * t375 * t953 + 0.4e1 / 0.9e1 * t262 * t1024 * t90 + 0.4e1 / 0.3e1 * t23 * t2075);
  t2086 = t5 * t1028 * t99 * t52;
  t2097 = -0.3e1 / 0.8e1 * t5 * t2079 * t26 * t52 - t2086 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1029 * t135 - 0.3e1 / 0.8e1 * t1931 + t1935 / 0.4e1 - 0.3e1 / 0.8e1 * t1943 + t1810 - 0.5e1 / 0.12e2 * t1801 + t1819 - 0.5e1 / 0.36e2 * t1590 + t1597 - 0.5e1 / 0.36e2 * t1602;
  t2098 = my_piecewise3(t1, 0, t2097);
  t2115 = my_piecewise5(t14, 0, t10, 0, -t2074);
  t2119 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1755 * t1037 * t142 - 0.8e1 / 0.9e1 * t974 * t402 - 0.8e1 / 0.9e1 * t903 * t449 * t142 + 0.4e1 / 0.3e1 * t906 * t449 + 0.4e1 / 0.3e1 * t399 * t983 + 0.4e1 / 0.9e1 * t349 * t1043 * t142 + 0.4e1 / 0.3e1 * t61 * t2115);
  t2126 = t5 * t1047 * t99 * t81;
  t2134 = t5 * t992 * t205;
  t2143 = t5 * t411 * t506;
  t2153 = t5 * t150 * t1128;
  t2155 = -0.3e1 / 0.8e1 * t5 * t2119 * t26 * t81 - t2126 / 0.8e1 - 0.3e1 / 0.8e1 * t2021 + t2025 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t988 * t205 - 0.3e1 / 0.8e1 * t2134 + t1901 - 0.5e1 / 0.12e2 * t1904 - 0.3e1 / 0.4e1 * t2034 + t2037 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t407 * t506 - 0.3e1 / 0.8e1 * t2143 - 0.5e1 / 0.36e2 * t1787 + t1792 + t1917 - 0.5e1 / 0.12e2 * t1919 - 0.3e1 / 0.8e1 * t2048 + t2051 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t146 * t1128 - t2153 / 0.8e1;
  t2156 = my_piecewise3(t57, 0, t2155);
  tv4rho43 = 0.3e1 * t973 + 0.3e1 * t1012 + t1036 + t1133 + t6 * (t2098 + t2156);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2161 = t428 * t428;
  t2166 = t433 * t433;
  t2172 = 0.24e2 * t705 + 0.24e2 * t1725;
  t2173 = my_piecewise5(t10, 0, t14, 0, t2172);
  t2177 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1711 * t2161 - 0.16e2 / 0.9e1 * t944 * t433 + 0.4e1 / 0.3e1 * t262 * t2166 + 0.16e2 / 0.9e1 * t375 * t1024 + 0.4e1 / 0.3e1 * t23 * t2173);
  t2186 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2177 * t26 * t52 - t2086 / 0.2e1 + t1935 / 0.2e1 - 0.5e1 / 0.9e1 * t1801 + t1597);
  t2195 = 0.1e1 / t1095;
  t2196 = t2195 * t485;
  t2203 = t1525 / t186 / t1095 / t178;
  t2204 = t314 * t2203;
  t2205 = t484 * t484;
  t2206 = 0.1e1 / t2205;
  t2208 = t2206 * t1117 * t1630;
  t2212 = t2206 * t199 * t1643;
  t2216 = t2206 * t496 * t1624;
  t2220 = 0.1e1 / t186 / t482;
  t2221 = t2220 * t73;
  t2225 = t1095 * rho[1];
  t2228 = t1094 / t66 / t2225;
  t2229 = t314 * t2228;
  t2235 = t314 * t480 * t2195;
  t2252 = t314 * t2203 * t73;
  t2254 = 0.1e1 / t1116 / t75;
  t2268 = t314 * t2228 * t73;
  t2282 = 0.4e1 / 0.243e3 * t2204 * t2206 * t76 * t1642 - 0.91e3 / 0.243e3 * t34 * t65 * t1541 * t77 - 0.16e2 / 0.243e3 * t2252 * t2254 * t1678 * t2206 * t28 * t113 - 0.8e1 / 0.81e2 * t2252 * t2208 - 0.44e2 / 0.729e3 * t2252 * t2216 - 0.4e1 / 0.243e3 * t2252 * t2212 + 0.116e3 / 0.729e3 * t2268 * t1107 + 0.116e3 / 0.243e3 * t2268 * t1121 + 0.116e3 / 0.243e3 * t2268 * t1111 + 0.1862e4 / 0.243e3 * t481 * t2196 * t200 - 0.721e3 / 0.81e2 * t114 * sigma[2] * t2220 * t191;
  t2287 = t445 * t445;
  t2292 = t449 * t449;
  t2298 = my_piecewise5(t14, 0, t10, 0, -t2172);
  t2302 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1755 * t2287 - 0.16e2 / 0.9e1 * t974 * t449 + 0.4e1 / 0.3e1 * t349 * t2292 + 0.16e2 / 0.9e1 * t399 * t1043 + 0.4e1 / 0.3e1 * t61 * t2298);
  t2316 = -t2126 / 0.2e1 - 0.3e1 / 0.2e1 * t2134 - 0.3e1 / 0.2e1 * t2143 - t2153 / 0.2e1 + t2025 / 0.2e1 + t2037 + t2051 / 0.2e1 - 0.5e1 / 0.9e1 * t1904 - 0.5e1 / 0.9e1 * t1919 + t1792 - 0.3e1 / 0.8e1 * t5 * t64 * (0.931e3 / 0.243e3 * t481 * t2196 * t76 + 0.16e2 / 0.243e3 * t2204 * t2208 + 0.44e2 / 0.729e3 * t2204 * t2212 + 0.8e1 / 0.81e2 * t2204 * t2216 + 0.721e3 / 0.81e2 * t196 * t2221 * t201 - 0.116e3 / 0.243e3 * t2229 * t1107 - 0.116e3 / 0.243e3 * t2229 * t1111 - 0.1862e4 / 0.243e3 * t2235 * t499 - 0.931e3 / 0.243e3 * t2235 * t503 - 0.116e3 / 0.729e3 * t2229 * t1103 + t2282) - 0.3e1 / 0.8e1 * t5 * t2302 * t26 * t81 - 0.3e1 / 0.2e1 * t5 * t1048 * t205 - 0.9e1 / 0.4e1 * t5 * t454 * t506 - 0.3e1 / 0.2e1 * t5 * t174 * t1128;
  t2317 = my_piecewise3(t57, 0, t2316);
  tv4rho44 = 0.4e1 * t1036 + 0.4e1 * t1133 + t6 * (t2186 + t2317);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2325 = t5 * t718 * t231;
  t2331 = t5 * t725 * t231;
  t2334 = t5 * t280 * t553;
  t2341 = 0.5e1 / 0.36e2 * t5 * t737 * t231;
  t2343 = t5 * t289 * t553;
  t2346 = t5 * t100 * t1211;
  t2352 = t314 * t764;
  t2356 = 0.1e1 / t116 / t1634;
  t2358 = t314 * t2356 * t1621;
  t2360 = t315 * t28 * t113;
  t2373 = t314 * t781 * t785;
  t2392 = t314 * t764 * t44;
  t2399 = t2356 * t44;
  t2402 = t1678 * t1621;
  t2408 = t806 * t1621;
  t2414 = t333 * t1621;
  t2420 = params->c * t1621;
  t2424 = t781 * t44;
  t2439 = 0.317e3 / 0.162e3 * t2392 * t548 + 0.317e3 / 0.324e3 * t2392 * t541 + 0.49e2 / 0.972e3 * t2373 * t1180 + 0.2e1 / 0.81e2 * t314 * t2399 * t1677 * t2402 * t2360 + t314 * t2399 * t805 * t2408 * t2360 / 0.27e2 + 0.11e2 / 0.486e3 * t314 * t2399 * t331 * t2414 * t2360 + t314 * t2399 * t129 * t2420 * t2360 / 0.162e3 - 0.49e2 / 0.972e3 * t314 * t2424 * t129 * t1208 - 0.49e2 / 0.324e3 * t314 * t2424 * t805 * t1196 - 0.49e2 / 0.324e3 * t314 * t2424 * t331 * t1202 - 0.317e3 / 0.162e3 * t2352 * t541;
  t2445 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t714 * t231 - 0.3e1 / 0.8e1 * t2325 - 0.9e1 / 0.8e1 * t5 * t276 * t553 + t2331 / 0.4e1 - 0.3e1 / 0.4e1 * t2334 - 0.9e1 / 0.8e1 * t5 * t94 * t1211 - t2341 + t2343 / 0.4e1 - 0.3e1 / 0.8e1 * t2346 - 0.3e1 / 0.8e1 * t5 * t27 * (0.91e2 / 0.54e2 * t114 * t754 * t120 * t47 - 0.317e3 / 0.324e3 * t2352 * t536 - 0.2e1 / 0.81e2 * t2358 * t807 * t2360 - 0.11e2 / 0.486e3 * t2358 * t129 * t315 * t1643 - t2358 * t331 * t315 * t1624 / 0.27e2 + 0.49e2 / 0.324e3 * t2373 * t1184 + 0.49e2 / 0.324e3 * t2373 * t1189 - t2358 * t47 * t315 * t1642 / 0.162e3 + 0.35e2 / 0.81e2 * t34 * t213 * t748 * t48 - 0.91e2 / 0.54e2 * t111 * t113 * t754 * t228 + t2439));
  tv4rho3sigma0 = t6 * t2445 + 0.3e1 * t1216;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2452 = t5 * t841 * t254;
  t2455 = t5 * t845 * t254;
  t2459 = 0.5e1 / 0.36e2 * t5 * t849 * t254;
  t2461 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t837 * t254 - 0.3e1 / 0.8e1 * t2452 + t2455 / 0.4e1 - t2459);
  tv4rho3sigma2 = t6 * t2461 + 0.3e1 * t1229;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2463 = 0.2e1 * t1243;
  t2469 = t5 * t879 * t231 / 0.4e1;
  t2474 = t5 * t886 * t231;
  t2478 = t5 * t388 * t553 / 0.4e1;
  t2487 = -0.3e1 / 0.8e1 * t5 * t875 * t231 - t2469 - 0.3e1 / 0.4e1 * t5 * t384 * t553 + t2474 / 0.12e2 - t2478 - 0.3e1 / 0.8e1 * t5 * t163 * t1211 - t2325 / 0.8e1 + t2331 / 0.6e1 - t2334 / 0.4e1 - t2341 + t2343 / 0.6e1 - t2346 / 0.8e1;
  t2488 = my_piecewise3(t1, 0, t2487);
  tv4rho3sigma3 = t6 * t2488 + t1216 + t2463;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2490 = 0.2e1 * t1259;
  t2496 = t5 * t921 * t254 / 0.4e1;
  t2498 = t5 * t925 * t254;
  t2507 = t5 * t363 * t611 / 0.4e1;
  t2509 = t5 * t367 * t611;
  t2512 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t917 * t254 - t2496 + t2498 / 0.12e2 - t2452 / 0.8e1 + t2455 / 0.6e1 - t2459 - 0.3e1 / 0.8e1 * t5 * t359 * t611 - t2507 + t2509 / 0.12e2);
  tv4rho3sigma5 = t6 * t2512 + t1229 + t2490;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2518 = t5 * t962 * t231;
  t2527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t958 * t231 - t2518 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t438 * t553 - t2469 + t2474 / 0.6e1 - t2478 + t2331 / 0.12e2 - t2341 + t2343 / 0.12e2);
  tv4rho3sigma6 = t6 * t2527 + t1267 + t2463;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2533 = t5 * t992 * t254;
  t2540 = t5 * t411 * t611;
  t2548 = t5 * t150 * t1337;
  t2550 = -0.3e1 / 0.8e1 * t5 * t988 * t254 - t2533 / 0.8e1 - t2496 + t2498 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t407 * t611 - t2540 / 0.4e1 + t2455 / 0.12e2 - t2459 - t2507 + t2509 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t146 * t1337 - t2548 / 0.8e1;
  t2551 = my_piecewise3(t57, 0, t2550);
  tv4rho3sigma8 = t6 * t2551 + t1342 + t2490;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2560 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1029 * t231 - 0.3e1 / 0.8e1 * t2518 + t2474 / 0.4e1 - t2341);
  tv4rho3sigma9 = t6 * t2560 + 0.3e1 * t1267;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2578 = 0.1e1 / t186 / t2225;
  t2580 = t314 * t2578 * t2206;
  t2585 = t314 * t1080;
  t2603 = t480 * t28 * t113;
  t2608 = t314 * t1097 * t1101;
  t2623 = t314 * t1080 * t73;
  t2630 = t2578 * t73;
  t2633 = t333 * t2206;
  t2639 = params->c * t2206;
  t2643 = t1097 * t73;
  t2650 = t1678 * t2206;
  t2656 = t806 * t2206;
  t2668 = -0.91e2 / 0.54e2 * t111 * t113 * t1070 * t251 + 0.317e3 / 0.162e3 * t2623 * t606 + 0.317e3 / 0.324e3 * t2623 * t599 + 0.49e2 / 0.972e3 * t2608 * t1306 + 0.11e2 / 0.486e3 * t314 * t2630 * t496 * t2633 * t2603 + t314 * t2630 * t199 * t2639 * t2603 / 0.162e3 - 0.49e2 / 0.972e3 * t314 * t2643 * t199 * t1334 + 0.2e1 / 0.81e2 * t314 * t2630 * t2254 * t2650 * t2603 + t314 * t2630 * t1117 * t2656 * t2603 / 0.27e2 - 0.49e2 / 0.324e3 * t314 * t2643 * t1117 * t1322 - 0.49e2 / 0.324e3 * t314 * t2643 * t496 * t1328;
  t2674 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1048 * t254 - 0.3e1 / 0.8e1 * t2533 - 0.9e1 / 0.8e1 * t5 * t454 * t611 + t2498 / 0.4e1 - 0.3e1 / 0.4e1 * t2540 - 0.9e1 / 0.8e1 * t5 * t174 * t1337 - t2459 + t2509 / 0.4e1 - 0.3e1 / 0.8e1 * t2548 - 0.3e1 / 0.8e1 * t5 * t64 * (-t2580 * t76 * t480 * t1642 / 0.162e3 - 0.317e3 / 0.162e3 * t2585 * t599 + 0.91e2 / 0.54e2 * t114 * t1070 * t190 * t76 - 0.317e3 / 0.324e3 * t2585 * t594 - 0.11e2 / 0.486e3 * t2580 * t199 * t480 * t1643 - t2580 * t496 * t480 * t1624 / 0.27e2 - 0.2e1 / 0.81e2 * t2580 * t1118 * t2603 + 0.49e2 / 0.324e3 * t2608 * t1310 + 0.49e2 / 0.324e3 * t2608 * t1315 + 0.35e2 / 0.81e2 * t34 * t236 * t1064 * t77 + t2668));
  tv4rho3sigma11 = t6 * t2674 + 0.3e1 * t1342;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2681 = t5 * t280 * t651;
  t2688 = t5 * t289 * t651 / 0.12e2;
  t2690 = t5 * t100 * t1395;
  t2693 = 0.1e1 / t116 / t779;
  t2694 = t2693 * t44;
  t2697 = t1642 * t35;
  t2707 = t314 * t2693 * t1621;
  t2714 = t314 * t213 * t318;
  t2739 = t314 * t1192;
  t2743 = t113 * params->c;
  t2770 = -0.35e2 / 0.2592e4 * t314 * t1176 * t787 + 0.4e1 / 0.27e2 * t1360 * t322 + 0.35e2 / 0.2592e4 * t2739 * t793 + 0.11e2 / 0.1296e4 * t2707 * t129 * t28 * t2743 * t35 + t2707 * t546 * t2697 / 0.72e2 + t2707 * t807 * t2697 / 0.108e3 + 0.7e1 / 0.216e3 * t629 * t310 + 0.35e2 / 0.864e3 * t2739 * t810 + 0.35e2 / 0.864e3 * t2739 * t799 - t314 * t2694 * t1677 * t2402 * t2697 / 0.108e3 - t314 * t2694 * t805 * t2408 * t2697 / 0.72e2;
  t2776 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t651 - t2681 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t94 * t1395 + t2688 - t2690 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.11e2 / 0.1296e4 * t314 * t2694 * t331 * t2414 * t2697 - t314 * t2694 * t129 * t2420 * t2697 / 0.432e3 + t2707 * t47 * t28 * t113 * t35 / 0.432e3 - 0.8e1 / 0.27e2 * t2714 * t335 - 0.4e1 / 0.27e2 * t2714 * t339 - 0.35e2 / 0.864e3 * t1178 * t1381 - 0.35e2 / 0.864e3 * t1178 * t1384 + 0.7e1 / 0.108e3 * t34 * t618 * t297 * t48 - 0.7e1 / 0.216e3 * t114 * t623 * t304 * t121 + 0.8e1 / 0.27e2 * t1360 * t325 + t2770));
  tv4rho2sigma20 = t6 * t2776 + 0.2e1 * t1400;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2783 = t5 * t363 * t689;
  t2787 = t5 * t367 * t689 / 0.12e2;
  t2789 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t359 * t689 - t2783 / 0.4e1 + t2787);
  tv4rho2sigma25 = t6 * t2789 + 0.2e1 * t1409;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2795 = t5 * t388 * t651;
  t2803 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t384 * t651 - t2795 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t163 * t1395 - t2681 / 0.8e1 + t2688 - t2690 / 0.8e1);
  tv4rho2sigma26 = t6 * t2803 + t1400 + t1415;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2809 = t5 * t411 * t689;
  t2816 = t5 * t150 * t1465;
  t2819 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t407 * t689 - t2809 / 0.8e1 - t2783 / 0.8e1 + t2787 - 0.3e1 / 0.8e1 * t5 * t146 * t1465 - t2816 / 0.8e1);
  tv4rho2sigma211 = t6 * t2819 + t1409 + t1470;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2827 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t438 * t651 - t2795 / 0.4e1 + t2688);
  tv4rho2sigma212 = t6 * t2827 + 0.2e1 * t1415;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2839 = 0.1e1 / t186 / t1095;
  t2841 = t314 * t2839 * t2206;
  t2842 = t1642 * t65;
  t2846 = t314 * t1318;
  t2859 = t2839 * t73;
  t2887 = t314 * t236 * t483;
  t2915 = -0.8e1 / 0.27e2 * t2887 * t499 - 0.4e1 / 0.27e2 * t2887 * t503 - 0.35e2 / 0.864e3 * t1304 * t1451 - 0.35e2 / 0.864e3 * t1304 * t1454 + 0.7e1 / 0.108e3 * t34 * t656 * t464 * t77 - 0.7e1 / 0.216e3 * t114 * t661 * t471 * t191 + 0.8e1 / 0.27e2 * t1430 * t490 - 0.35e2 / 0.2592e4 * t314 * t1302 * t1103 + 0.7e1 / 0.216e3 * t667 * t477 + 0.35e2 / 0.864e3 * t2846 * t1121 + 0.35e2 / 0.864e3 * t2846 * t1111;
  t2921 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t454 * t689 - t2809 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t174 * t1465 + t2787 - t2816 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * (t2841 * t1118 * t2842 / 0.108e3 + 0.35e2 / 0.2592e4 * t2846 * t1107 + 0.11e2 / 0.1296e4 * t2841 * t199 * t28 * t2743 * t65 + t2841 * t604 * t2842 / 0.72e2 + 0.4e1 / 0.27e2 * t1430 * t487 - t314 * t2859 * t2254 * t2650 * t2842 / 0.108e3 - t314 * t2859 * t1117 * t2656 * t2842 / 0.72e2 - 0.11e2 / 0.1296e4 * t314 * t2859 * t496 * t2633 * t2842 - t314 * t2859 * t199 * t2639 * t2842 / 0.432e3 + t2841 * t76 * t28 * t113 * t65 / 0.432e3 + t2915));
  tv4rho2sigma217 = t6 * t2921 + 0.2e1 * t1470;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2928 = t5 * t100 * t1520 / 0.8e1;
  t2932 = 0.1e1 / t116 / t763;
  t2934 = t314 * t2932 * t1621;
  t2944 = t213 * t28 * t113;
  t2950 = t314 * t618;
  t2953 = t2932 * t44;
  t2988 = t314 * t618 * t533;
  t3011 = t1380 * t1496 / 0.144e3 + t1380 * t1501 / 0.144e3 - t2934 * t47 * t213 * t1642 / 0.1152e4 + t34 * t1473 * t106 * t48 / 0.24e2 - t2988 * t335 / 0.48e2 - t2988 * t339 / 0.96e2 - t114 * t1478 * t118 * t121 / 0.48e2 + t2950 * t1365 / 0.48e2 - t314 * t1387 * t129 * t1517 / 0.432e3 - t314 * t1387 * t805 * t1507 / 0.144e3 - t314 * t1387 * t331 * t1512 / 0.144e3;
  t3017 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t94 * t1520 - t2928 - 0.3e1 / 0.8e1 * t5 * t27 * (t1380 * t1492 / 0.432e3 - 0.11e2 / 0.3456e4 * t2934 * t129 * t213 * t1643 - t2934 * t331 * t213 * t1624 / 0.192e3 - t2934 * t807 * t2944 / 0.288e3 + t1484 * t132 / 0.48e2 + t2950 * t1362 / 0.96e2 + t314 * t2953 * t1677 * t2402 * t2944 / 0.288e3 + t314 * t2953 * t805 * t2408 * t2944 / 0.192e3 + 0.11e2 / 0.3456e4 * t314 * t2953 * t331 * t2414 * t2944 + t314 * t2953 * t129 * t2420 * t2944 / 0.1152e4 + t3011));
  tv4rhosigma30 = t6 * t3017 + t1524;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t3024 = t5 * t150 * t1573 / 0.8e1;
  t3026 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t146 * t1573 - t3024);
  tv4rhosigma39 = t6 * t3026 + t1577;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3032 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t163 * t1520 - t2928);
  tv4rhosigma310 = t6 * t3032 + t1524;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t3050 = 0.1e1 / t186 / t1079;
  t3052 = t314 * t3050 * t2206;
  t3054 = t236 * t28 * t113;
  t3070 = t314 * t656;
  t3073 = t3050 * t73;
  t3104 = t314 * t656 * t591;
  t3119 = t1450 * t1554 / 0.144e3 + t314 * t3073 * t2254 * t2650 * t3054 / 0.288e3 + t314 * t3073 * t1117 * t2656 * t3054 / 0.192e3 + 0.11e2 / 0.3456e4 * t314 * t3073 * t496 * t2633 * t3054 + t1450 * t1549 / 0.144e3 + t34 * t1526 * t180 * t77 / 0.24e2 - t3104 * t499 / 0.48e2 - t3104 * t503 / 0.96e2 - t3052 * t76 * t236 * t1642 / 0.1152e4 - t114 * t1531 * t188 * t191 / 0.48e2 + t3070 * t1435 / 0.48e2;
  t3125 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t174 * t1573 - t3024 - 0.3e1 / 0.8e1 * t5 * t64 * (-t314 * t1457 * t496 * t1565 / 0.144e3 - t314 * t1457 * t199 * t1570 / 0.432e3 - t314 * t1457 * t1117 * t1560 / 0.144e3 - t3052 * t1118 * t3054 / 0.288e3 + t1537 * t202 / 0.48e2 + t1450 * t1545 / 0.432e3 - 0.11e2 / 0.3456e4 * t3052 * t199 * t236 * t1643 - t3052 * t496 * t236 * t1624 / 0.192e3 + t3070 * t1432 / 0.96e2 + t314 * t3073 * t199 * t2639 * t3054 / 0.1152e4 + t3119));
  tv4rhosigma319 = t6 * t3125 + t1577;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t3128 = t1478 * t29 * t33;
  t3139 = t314 * t1648 * t1621;
  t3149 = t618 * t28 * t113;
  t3153 = t778 * sigma[0];
  t3154 = 0.1e1 / t3153;
  t3163 = t314 * t1473;
  t3164 = t634 * t320;
  t3197 = t314 * t1473 * t634;
  t3219 = -t314 * t1649 * t1677 * t2402 * t3149 / 0.768e3 - t314 * t1649 * t805 * t2408 * t3149 / 0.512e3 - 0.11e2 / 0.9216e4 * t314 * t1649 * t331 * t2414 * t3149 - t314 * t1649 * t129 * t2420 * t3149 / 0.3072e4 + t1490 * t129 * t1478 * t792 / 0.768e3 + t3197 * t335 / 0.128e3 + t3197 * t339 / 0.256e3 + t3139 * t47 * t618 * t1642 / 0.3072e4 + 0.5e1 / 0.64e2 * t34 / t35 / t3153 * t38 * t48 - 0.5e1 / 0.128e3 * t114 * t3154 * t219 * t121 - t3163 * t3164 * t130 / 0.128e3;
  t3224 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-t1511 * t1201 * t3128 / 0.768e3 - t1516 * t1207 * t3128 / 0.2304e4 - t1506 * t1195 * t3128 / 0.768e3 + 0.11e2 / 0.9216e4 * t3139 * t129 * t618 * t1643 + t3139 * t331 * t618 * t1624 / 0.512e3 + t3139 * t807 * t3149 / 0.768e3 + 0.5e1 / 0.128e3 * t111 * t113 * t3154 * t631 + t1490 * t47 * t1478 * t40 / 0.2304e4 - t3163 * t3164 * t47 / 0.256e3 + t1490 * t546 * t3128 / 0.768e3 + t3219));
  tv4sigma40 = t6 * t3224;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t3225 = t314 * t1526;
  t3226 = t672 * t485;
  t3231 = t1531 * t29 * t33;
  t3246 = t314 * t2220 * t2206;
  t3256 = t656 * t28 * t113;
  t3260 = t1094 * sigma[2];
  t3261 = 0.1e1 / t3260;
  t3301 = t314 * t1526 * t672;
  t3317 = -t314 * t2221 * t2254 * t2650 * t3256 / 0.768e3 - t314 * t2221 * t1117 * t2656 * t3256 / 0.512e3 - 0.11e2 / 0.9216e4 * t314 * t2221 * t496 * t2633 * t3256 - t314 * t2221 * t199 * t2639 * t3256 / 0.3072e4 + t1543 * t199 * t1531 * t792 / 0.768e3 + 0.5e1 / 0.64e2 * t34 / t65 / t3260 * t68 * t77 + t3301 * t499 / 0.128e3 + t3301 * t503 / 0.256e3 + t3246 * t76 * t656 * t1642 / 0.3072e4 - 0.5e1 / 0.128e3 * t114 * t3261 * t242 * t191 - t3225 * t3226 * t200 / 0.128e3;
  t3322 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * (-t3225 * t3226 * t76 / 0.256e3 - t1559 * t1321 * t3231 / 0.768e3 - t1564 * t1327 * t3231 / 0.768e3 - t1569 * t1333 * t3231 / 0.2304e4 + t1543 * t76 * t1531 * t40 / 0.2304e4 + 0.11e2 / 0.9216e4 * t3246 * t199 * t656 * t1643 + t3246 * t496 * t656 * t1624 / 0.512e3 + t3246 * t1118 * t3256 / 0.768e3 + 0.5e1 / 0.128e3 * t111 * t113 * t3261 * t669 + t1543 * t604 * t3231 / 0.768e3 + t3317));
  tv4sigma414 = t6 * t3322;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t31, t33;
  double t38, t39, t41, t42, t43, t44, t47, t51;
  double tzk0;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = params->alphaoAx * t21;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = 0.1e1 / t24;
  t26 = sqrt(sigma[0]);
  t28 = t22 * t25 * t26;
  t29 = M_CBRT2;
  t31 = 0.1e1 / t18 / rho[0];
  t33 = t21 * t25;
  t38 = 0.1e1 + t33 * t26 * t29 * t31 / 0.12e2;
  t39 = log(t38);
  t41 = params->c * t39 + 0.1e1;
  t42 = 0.1e1 / t41;
  t43 = t39 * t42;
  t44 = t29 * t31 * t43;
  t47 = 0.1e1 - t28 * t44 / 0.12e2;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t31, t33;
  double t38, t39, t41, t42, t43, t44, t47, t51;
  double tzk0;

  double t52, t54, t58, t62, t65, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t77, t81;
  double t83, t84, t85, t86, t87, t90, t95, tvrho0;
  double t98, t100, t103, t105, t107, t110, t111, t113;
  double t116, t120, tvsigma0;

  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = params->alphaoAx * t21;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = 0.1e1 / t24;
  t26 = sqrt(sigma[0]);
  t28 = t22 * t25 * t26;
  t29 = M_CBRT2;
  t31 = 0.1e1 / t18 / rho[0];
  t33 = t21 * t25;
  t38 = 0.1e1 + t33 * t26 * t29 * t31 / 0.12e2;
  t39 = log(t38);
  t41 = params->c * t39 + 0.1e1;
  t42 = 0.1e1 / t41;
  t43 = t39 * t42;
  t44 = t29 * t31 * t43;
  t47 = 0.1e1 - t28 * t44 / 0.12e2;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = t18 * t18;
  t54 = t17 / t52;
  t58 = rho[0] * rho[0];
  t62 = t29 / t18 / t58 * t43;
  t65 = params->alphaoAx * t20;
  t66 = t24 * t24;
  t67 = 0.1e1 / t66;
  t68 = t67 * sigma[0];
  t69 = t65 * t68;
  t70 = t29 * t29;
  t71 = t58 * rho[0];
  t73 = 0.1e1 / t52 / t71;
  t75 = 0.1e1 / t38;
  t76 = t75 * t42;
  t77 = t70 * t73 * t76;
  t81 = t65 * t68 * t70;
  t83 = t41 * t41;
  t84 = 0.1e1 / t83;
  t85 = t84 * params->c;
  t86 = t85 * t75;
  t87 = t73 * t39 * t86;
  t90 = t28 * t62 / 0.9e1 + t69 * t77 / 0.18e2 - t81 * t87 / 0.18e2;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  tvrho0 = 0.2e1 * rho[0] * t95 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t98 = 0.1e1 / t26;
  t100 = t22 * t25 * t98;
  t103 = t65 * t67;
  t105 = 0.1e1 / t52 / t58;
  t107 = t70 * t105 * t76;
  t110 = t67 * t70;
  t111 = t65 * t110;
  t113 = t105 * t39 * t86;
  t116 = -t100 * t44 / 0.24e2 - t103 * t107 / 0.48e2 + t111 * t113 / 0.48e2;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t116);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t31, t33;
  double t38, t39, t41, t42, t43, t44, t47, t51;
  double tzk0;

  double t52, t54, t58, t62, t65, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t77, t81;
  double t83, t84, t85, t86, t87, t90, t95, tvrho0;
  double t98, t100, t103, t105, t107, t110, t111, t113;
  double t116, t120, tvsigma0;

  double t125, t135, t138, t140, t142, t146, t150, t151;
  double t152, t153, t154, t155, t156, t157, t158, t161;
  double t165, t167, t169, t171, t176, t179, t184, t196;
  double t197, t198, t199, t200, t203, t205, t209, t210;
  double t212, t217, t222, t225, t227, t230, t231, t232;
  double t236, t239, t240, t245, t249, t256, t260;

#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t31, t33;
  double t38, t39, t41, t42, t43, t44, t47, t51;
  double tzk0;

  double t52, t54, t58, t62, t65, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t77, t81;
  double t83, t84, t85, t86, t87, t90, t95, tvrho0;
  double t98, t100, t103, t105, t107, t110, t111, t113;
  double t116, t120, tvsigma0;

  double t125, t135, t138, t140, t142, t146, t150, t151;
  double t152, t153, t154, t155, t156, t157, t158, t161;
  double t165, t167, t169, t171, t176, t179, t184, tv2rho20;
  double t196, t197, t198, t199, t200, t203, t205, t209;
  double t210, t212, t217, t222, tv2rhosigma0, t225, t227, t230;
  double t231, t232, t236, t239, t240, t245, t249, t256;
  double t260, tv2sigma20;

  double t263, t276, t280, t282, t286, t289, t290, t291;
  double t299, t304, t305, t307, t308, t311, t313, t314;
  double t318, t319, t322, t326, t327, t328, t329, t330;
  double t332, t336, t340, t343, t348, t364, t370, t376;
  double t377, t378, t380, t386, t392, t395, t397, t398;
  double t400, t404, t405, t407, t411, t412, t414, t417;
  double t422, t434, t435, t436, t439, t443, t449, t450;
  double t451, t454, t461, t463, t464, t468, t469, t473;
  double t474, t477, t482, t485, t486, t488, t491, t492;
  double t493, t497, t501, t502, t503, t505, t509, t511;
  double t515, t517, t520, t522, t524, t528, t530, t534;
  double t536, t539, t543;

#ifndef XC_DONT_COMPILE_LXC
  double t559, t562, t569, t571, t572, t574, t575, t583;
  double t584, t589, t595, t601, t603, t614, t619, t628;
  double t630, t631, t650, t657, t663, t677, t678, t688;
  double t692, t696, t732, t735, t742, t749, t756, t761;
  double t774, t780, t791, t792, t795, t810, t847, t872;
  double t878, t885, t892, t898, t899, t936, t969, t975;
  double t1006, t1024, t1026, t1046, t1051, t1052, t1081, t1086;
#endif

#endif

#endif

#endif

#endif


  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = params->alphaoAx * t21;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = 0.1e1 / t24;
  t26 = sqrt(sigma[0]);
  t28 = t22 * t25 * t26;
  t29 = M_CBRT2;
  t31 = 0.1e1 / t18 / rho[0];
  t33 = t21 * t25;
  t38 = 0.1e1 + t33 * t26 * t29 * t31 / 0.12e2;
  t39 = log(t38);
  t41 = params->c * t39 + 0.1e1;
  t42 = 0.1e1 / t41;
  t43 = t39 * t42;
  t44 = t29 * t31 * t43;
  t47 = 0.1e1 - t28 * t44 / 0.12e2;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t51;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t52 = t18 * t18;
  t54 = t17 / t52;
  t58 = rho[0] * rho[0];
  t62 = t29 / t18 / t58 * t43;
  t65 = params->alphaoAx * t20;
  t66 = t24 * t24;
  t67 = 0.1e1 / t66;
  t68 = t67 * sigma[0];
  t69 = t65 * t68;
  t70 = t29 * t29;
  t71 = t58 * rho[0];
  t73 = 0.1e1 / t52 / t71;
  t75 = 0.1e1 / t38;
  t76 = t75 * t42;
  t77 = t70 * t73 * t76;
  t81 = t65 * t68 * t70;
  t83 = t41 * t41;
  t84 = 0.1e1 / t83;
  t85 = t84 * params->c;
  t86 = t85 * t75;
  t87 = t73 * t39 * t86;
  t90 = t28 * t62 / 0.9e1 + t69 * t77 / 0.18e2 - t81 * t87 / 0.18e2;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t95 + 0.2e1 * t51;

  t98 = 0.1e1 / t26;
  t100 = t22 * t25 * t98;
  t103 = t65 * t67;
  t105 = 0.1e1 / t52 / t58;
  t107 = t70 * t105 * t76;
  t110 = t67 * t70;
  t111 = t65 * t110;
  t113 = t105 * t39 * t86;
  t116 = -t100 * t44 / 0.24e2 - t103 * t107 / 0.48e2 + t111 * t113 / 0.48e2;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t116);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t120;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t125 = t17 / t52 / rho[0];
  t135 = t29 / t18 / t71 * t43;
  t138 = t58 * t58;
  t140 = 0.1e1 / t52 / t138;
  t142 = t70 * t140 * t76;
  t146 = t140 * t39 * t86;
  t150 = params->alphaoAx / t23;
  t151 = t26 * sigma[0];
  t152 = t150 * t151;
  t153 = t138 * t58;
  t154 = 0.1e1 / t153;
  t155 = t38 * t38;
  t156 = 0.1e1 / t155;
  t157 = t154 * t156;
  t158 = t157 * t42;
  t161 = t157 * t85;
  t165 = t150 * t151 * t154;
  t167 = 0.1e1 / t83 / t41;
  t169 = params->c * params->c;
  t171 = t39 * t167 * t169 * t156;
  t176 = t39 * t84 * params->c * t156;
  t179 = -0.7e1 / 0.27e2 * t28 * t135 - 0.5e1 / 0.18e2 * t69 * t142 + 0.5e1 / 0.18e2 * t81 * t146 + 0.2e1 / 0.27e2 * t152 * t158 + 0.4e1 / 0.27e2 * t152 * t161 - 0.4e1 / 0.27e2 * t165 * t171 - 0.2e1 / 0.27e2 * t165 * t176;
  t184 = my_piecewise3(t2, 0, t6 * t125 * t47 / 0.12e2 - t6 * t54 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t179);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t184 + 0.4e1 * t95;

  t196 = t138 * rho[0];
  t197 = 0.1e1 / t196;
  t198 = t150 * t197;
  t199 = t156 * t42;
  t200 = t199 * t26;
  t203 = t156 * t84;
  t205 = t203 * params->c * t26;
  t209 = t150 * t197 * t39;
  t210 = t167 * t169;
  t212 = t210 * t156 * t26;
  t217 = t100 * t62 / 0.18e2 + t103 * t77 / 0.12e2 - t111 * t87 / 0.12e2 - t198 * t200 / 0.36e2 - t198 * t205 / 0.18e2 + t209 * t212 / 0.18e2 + t209 * t205 / 0.36e2;
  t222 = my_piecewise3(t2, 0, -t6 * t54 * t116 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t217);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t222 + 0.2e1 * t120;

  t225 = 0.1e1 / t151;
  t227 = t22 * t25 * t225;
  t230 = 0.1e1 / sigma[0];
  t231 = t67 * t230;
  t232 = t65 * t231;
  t236 = t65 * t231 * t70;
  t239 = 0.1e1 / t138;
  t240 = t150 * t239;
  t245 = t203 * params->c * t98;
  t249 = t150 * t239 * t39;
  t256 = t227 * t44 / 0.48e2 - t232 * t107 / 0.96e2 + t236 * t113 / 0.96e2 + t240 * t199 * t98 / 0.96e2 + t240 * t245 / 0.48e2 - t249 * t210 * t156 * t98 / 0.48e2 - t249 * t245 / 0.96e2;
  t260 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t256);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t260;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t263 = t17 * t105;
  t276 = t29 / t18 / t138 * t43;
  t280 = 0.1e1 / t52 / t196;
  t282 = t70 * t280 * t76;
  t286 = t280 * t39 * t86;
  t289 = t138 * t71;
  t290 = 0.1e1 / t289;
  t291 = t290 * t156;
  t299 = t150 * t151 * t290;
  t304 = sigma[0] * sigma[0];
  t305 = t138 * t138;
  t307 = 0.1e1 / t18 / t305;
  t308 = t304 * t307;
  t311 = 0.1e1 / t155 / t38;
  t313 = t33 * t29;
  t314 = t311 * t42 * t313;
  t318 = t150 * t308 * t311;
  t319 = t85 * t313;
  t322 = t210 * t313;
  t326 = t150 * t308 * t39;
  t327 = t83 * t83;
  t328 = 0.1e1 / t327;
  t329 = t169 * params->c;
  t330 = t328 * t329;
  t332 = t330 * t311 * t313;
  t336 = t210 * t311 * t313;
  t340 = t85 * t311 * t313;
  t343 = 0.70e2 / 0.81e2 * t28 * t276 + 0.119e3 / 0.81e2 * t69 * t282 - 0.119e3 / 0.81e2 * t81 * t286 - 0.22e2 / 0.27e2 * t152 * t291 * t42 - 0.44e2 / 0.27e2 * t152 * t291 * t85 + 0.44e2 / 0.27e2 * t299 * t171 + 0.22e2 / 0.27e2 * t299 * t176 + 0.4e1 / 0.243e3 * t150 * t308 * t314 + 0.4e1 / 0.81e2 * t318 * t319 + 0.4e1 / 0.81e2 * t318 * t322 - 0.4e1 / 0.81e2 * t326 * t332 - 0.4e1 / 0.81e2 * t326 * t336 - 0.4e1 / 0.243e3 * t326 * t340;
  t348 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t263 * t47 + t6 * t125 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t54 * t179 - 0.3e1 / 0.8e1 * t6 * t19 * t343);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t348 + 0.6e1 * t184;

  t364 = t150 * t154;
  t370 = t150 * t154 * t39;
  t376 = 0.1e1 / t18 / t289;
  t377 = t376 * t311;
  t378 = t150 * t377;
  t380 = t42 * sigma[0] * t313;
  t386 = sigma[0] * params->c * t313;
  t392 = t169 * sigma[0] * t313;
  t395 = t376 * t39;
  t397 = t150 * t395 * t328;
  t398 = t329 * t311;
  t400 = t398 * sigma[0] * t313;
  t404 = t150 * t395 * t167;
  t405 = t169 * t311;
  t407 = t405 * sigma[0] * t313;
  t411 = t150 * t395 * t84;
  t412 = params->c * t311;
  t414 = t412 * sigma[0] * t313;
  t417 = -0.7e1 / 0.54e2 * t100 * t135 - 0.37e2 / 0.108e3 * t103 * t142 + 0.37e2 / 0.108e3 * t111 * t146 + t364 * t200 / 0.4e1 + t364 * t205 / 0.2e1 - t370 * t212 / 0.2e1 - t370 * t205 / 0.4e1 - t378 * t380 / 0.162e3 - t150 * t377 * t84 * t386 / 0.54e2 - t150 * t377 * t167 * t392 / 0.54e2 + t397 * t400 / 0.54e2 + t404 * t407 / 0.54e2 + t411 * t414 / 0.162e3;
  t422 = my_piecewise3(t2, 0, t6 * t125 * t116 / 0.12e2 - t6 * t54 * t217 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t417);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t422 + 0.4e1 * t222;

  t434 = t150 * t98;
  t435 = t197 * t156;
  t436 = t435 * t42;
  t439 = t435 * t85;
  t443 = t150 * t98 * t197;
  t449 = 0.1e1 / t18 / t153;
  t450 = t449 * t311;
  t451 = t150 * t450;
  t454 = t42 * t21 * t25 * t29;
  t461 = t449 * t39;
  t463 = t150 * t461 * t328;
  t464 = t398 * t313;
  t468 = t150 * t461 * t167;
  t469 = t405 * t313;
  t473 = t150 * t461 * t84;
  t474 = t412 * t313;
  t477 = -t227 * t62 / 0.36e2 + t232 * t77 / 0.72e2 - t236 * t87 / 0.72e2 - t434 * t436 / 0.18e2 - t434 * t439 / 0.9e1 + t443 * t171 / 0.9e1 + t443 * t176 / 0.18e2 + t451 * t454 / 0.432e3 + t451 * t319 / 0.144e3 + t451 * t322 / 0.144e3 - t463 * t464 / 0.144e3 - t468 * t469 / 0.144e3 - t473 * t474 / 0.432e3;
  t482 = my_piecewise3(t2, 0, -t6 * t54 * t256 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t477);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t482 + 0.2e1 * t260;

  t485 = t26 * t304;
  t486 = 0.1e1 / t485;
  t488 = t22 * t25 * t486;
  t491 = 0.1e1 / t304;
  t492 = t67 * t491;
  t493 = t65 * t492;
  t497 = t65 * t492 * t70;
  t501 = 0.1e1 / t18 / t196;
  t502 = t501 * t311;
  t503 = t150 * t502;
  t505 = t42 * t230 * t313;
  t509 = t150 * t502 * t84;
  t511 = t230 * params->c * t313;
  t515 = t150 * t502 * t167;
  t517 = t169 * t230 * t313;
  t520 = t501 * t39;
  t522 = t150 * t520 * t328;
  t524 = t398 * t230 * t313;
  t528 = t150 * t520 * t167;
  t530 = t405 * t230 * t313;
  t534 = t150 * t520 * t84;
  t536 = t412 * t230 * t313;
  t539 = -t488 * t44 / 0.32e2 + t493 * t107 / 0.64e2 - t497 * t113 / 0.64e2 - t503 * t505 / 0.1152e4 - t509 * t511 / 0.384e3 - t515 * t517 / 0.384e3 + t522 * t524 / 0.384e3 + t528 * t530 / 0.384e3 + t534 * t536 / 0.1152e4;
  t543 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t539);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t543;

#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t28, t29, t31, t33;
  double t38, t39, t41, t42, t43, t44, t47, t51;
  double tzk0;

  if(order < 4) return;


  t559 = t305 * rho[0];
  t562 = t304 / t18 / t559;
  t569 = t485 / t52 / t305 / t58;
  t571 = t155 * t155;
  t572 = 0.1e1 / t571;
  t574 = t20 * t67;
  t575 = t574 * t70;
  t583 = 0.1e1 / t305;
  t584 = t583 * t156;
  t589 = t150 * t151 * t583;
  t595 = 0.1e1 / t52 / t153;
  t601 = t150 * t569 * t572;
  t603 = t110 * params->c;
  t614 = t595 * t39;
  t619 = t150 * t562 * t311;
  t628 = t150 * t569 * t39;
  t630 = 0.1e1 / t327 / t41;
  t631 = t169 * t169;
  t650 = t150 * t562 * t39;
  t657 = 0.721e3 / 0.81e2 * t81 * t614 * t86 - 0.232e3 / 0.243e3 * t619 * t319 - 0.232e3 / 0.243e3 * t619 * t322 + 0.3724e4 / 0.243e3 * t152 * t584 * t85 - 0.32e2 / 0.243e3 * t628 * t630 * t631 * t572 * t575 - 0.16e2 / 0.81e2 * t628 * t330 * t572 * t575 - 0.88e2 / 0.729e3 * t628 * t210 * t572 * t575 - 0.8e1 / 0.243e3 * t628 * t85 * t572 * t575 + 0.232e3 / 0.243e3 * t650 * t332 + 0.232e3 / 0.243e3 * t650 * t336 + 0.232e3 / 0.729e3 * t650 * t340;
  t663 = my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t17 * t73 * t47 - 0.5e1 / 0.9e1 * t6 * t263 * t90 + t6 * t125 * t179 / 0.2e1 - t6 * t54 * t343 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.232e3 / 0.729e3 * t150 * t562 * t314 + 0.8e1 / 0.243e3 * t150 * t569 * t572 * t42 * t575 - 0.910e3 / 0.243e3 * t28 * t29 * t501 * t43 + 0.1862e4 / 0.243e3 * t152 * t584 * t42 - 0.3724e4 / 0.243e3 * t589 * t171 - 0.1862e4 / 0.243e3 * t589 * t176 - 0.721e3 / 0.81e2 * t69 * t70 * t595 * t76 + 0.88e2 / 0.729e3 * t601 * t84 * t20 * t603 + 0.16e2 / 0.81e2 * t601 * t210 * t575 + 0.32e2 / 0.243e3 * t601 * t330 * t575 + t657));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.2e1 * rho[0] * t663 + 0.8e1 * t348;

  t677 = 0.1e1 / t52 / t559;
  t678 = t677 * t572;
  t688 = t307 * t311;
  t692 = t150 * t290;
  t696 = t150 * t290 * t39;
  t732 = t677 * t39;
  t735 = params->c * t572;
  t742 = t631 * t572;
  t749 = t329 * t572;
  t756 = t169 * t572;
  t761 = t307 * t39;
  t774 = 0.49e2 / 0.162e3 * t150 * t688 * t84 * t386 + 0.49e2 / 0.162e3 * t150 * t688 * t167 * t392 + 0.91e2 / 0.54e2 * t103 * t282 - 0.317e3 / 0.81e2 * t692 * t205 + t150 * t732 * t84 * t735 * t151 * t575 / 0.81e2 + 0.4e1 / 0.81e2 * t150 * t732 * t630 * t742 * t151 * t575 + 0.2e1 / 0.27e2 * t150 * t732 * t328 * t749 * t151 * t575 + 0.11e2 / 0.243e3 * t150 * t732 * t167 * t756 * t151 * t575 - 0.49e2 / 0.162e3 * t150 * t761 * t328 * t400 - 0.49e2 / 0.162e3 * t150 * t761 * t167 * t407 - 0.49e2 / 0.486e3 * t150 * t761 * t84 * t414;
  t780 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t263 * t116 + t6 * t125 * t217 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t54 * t417 - 0.3e1 / 0.8e1 * t6 * t19 * (-t150 * t678 * t42 * t151 * t575 / 0.81e2 + 0.35e2 / 0.81e2 * t100 * t276 - 0.91e2 / 0.54e2 * t111 * t286 + 0.49e2 / 0.486e3 * t150 * t688 * t380 - 0.317e3 / 0.162e3 * t692 * t200 + 0.317e3 / 0.81e2 * t696 * t212 + 0.317e3 / 0.162e3 * t696 * t205 - 0.11e2 / 0.243e3 * t150 * t678 * t84 * t151 * t20 * t603 - 0.2e1 / 0.27e2 * t150 * t678 * t167 * t151 * t169 * t575 - 0.4e1 / 0.81e2 * t150 * t678 * t328 * t329 * t151 * t575 + t774));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t780 + 0.6e1 * t422;

  t791 = 0.1e1 / t52 / t305;
  t792 = t791 * t572;
  t795 = t110 * t26;
  t810 = t150 * t98 * t154;
  t847 = t791 * t39;
  t872 = t150 * t792 * t328 * t329 * t20 * t795 / 0.54e2 + 0.7e1 / 0.216e3 * t236 * t146 + 0.35e2 / 0.432e3 * t397 * t464 + 0.35e2 / 0.432e3 * t404 * t469 + 0.35e2 / 0.1296e4 * t411 * t474 + 0.11e2 / 0.648e3 * t150 * t792 * t84 * t574 * t70 * params->c * t26 + 0.16e2 / 0.27e2 * t434 * t161 - 0.11e2 / 0.648e3 * t150 * t847 * t167 * t756 * t20 * t795 - t150 * t847 * t84 * t735 * t20 * t795 / 0.216e3 - t150 * t847 * t630 * t742 * t20 * t795 / 0.54e2 - t150 * t847 * t328 * t749 * t20 * t795 / 0.36e2;
  t878 = my_piecewise3(t2, 0, t6 * t125 * t256 / 0.12e2 - t6 * t54 * t477 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t150 * t792 * t42 * t20 * t795 / 0.216e3 + 0.7e1 / 0.108e3 * t227 * t135 - 0.35e2 / 0.432e3 * t378 * t319 - 0.35e2 / 0.432e3 * t378 * t322 + 0.8e1 / 0.27e2 * t434 * t158 - 0.7e1 / 0.216e3 * t232 * t142 - 0.16e2 / 0.27e2 * t810 * t171 - 0.8e1 / 0.27e2 * t810 * t176 - 0.35e2 / 0.1296e4 * t378 * t454 + t150 * t792 * t167 * t169 * t20 * t795 / 0.36e2 + t872));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t878 + 0.4e1 * t482;

  t885 = t150 * t225 * t197;
  t892 = t150 * t225;
  t898 = 0.1e1 / t52 / t289;
  t899 = t898 * t572;
  t936 = t898 * t39;
  t969 = t497 * t87 / 0.48e2 + t451 * t505 / 0.216e3 - 0.11e2 / 0.1728e4 * t150 * t899 * t84 * t98 * t20 * t603 - t150 * t899 * t167 * t98 * t169 * t575 / 0.96e2 + t892 * t439 / 0.24e2 + 0.11e2 / 0.1728e4 * t150 * t936 * t167 * t756 * t98 * t575 + t150 * t936 * t84 * t735 * t98 * t575 / 0.576e3 + t150 * t450 * t167 * t517 / 0.72e2 + t150 * t936 * t630 * t742 * t98 * t575 / 0.144e3 + t150 * t936 * t328 * t749 * t98 * t575 / 0.96e2 + t150 * t450 * t84 * t511 / 0.72e2;
  t975 = my_piecewise3(t2, 0, -t6 * t54 * t539 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-t885 * t171 / 0.24e2 - t885 * t176 / 0.48e2 - t493 * t77 / 0.48e2 + t892 * t436 / 0.48e2 + t488 * t62 / 0.24e2 - t150 * t899 * t42 * t98 * t575 / 0.576e3 - t473 * t536 / 0.216e3 - t463 * t524 / 0.72e2 - t468 * t530 / 0.72e2 - t150 * t899 * t328 * t329 * t98 * t575 / 0.144e3 + t969));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t975 + 0.2e1 * t543;

  t1006 = t595 * t572;
  t1024 = t304 * sigma[0];
  t1026 = t67 / t1024;
  t1046 = t150 * t486 * t239;
  t1051 = t150 * t486;
  t1052 = t239 * t156;
  t1081 = 0.11e2 / 0.4608e4 * t150 * t1006 * t84 * t225 * t20 * t603 - 0.5e1 / 0.128e3 * t65 * t1026 * t107 + t1046 * t171 / 0.64e2 + t1046 * t176 / 0.128e3 - t1051 * t1052 * t42 / 0.128e3 + 0.5e1 / 0.64e2 * t22 * t25 / t26 / t1024 * t44 - t528 * t405 * t491 * t313 / 0.384e3 - t534 * t412 * t491 * t313 / 0.1152e4 - t522 * t398 * t491 * t313 / 0.384e3 - t1051 * t1052 * t85 / 0.64e2 + t509 * t491 * params->c * t313 / 0.384e3;
  t1086 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-t150 * t614 * t84 * t735 * t225 * t575 / 0.1536e4 + t515 * t169 * t491 * t313 / 0.384e3 - t150 * t614 * t630 * t742 * t225 * t575 / 0.384e3 - t150 * t614 * t328 * t749 * t225 * t575 / 0.256e3 - 0.11e2 / 0.4608e4 * t150 * t614 * t167 * t756 * t225 * t575 + t150 * t1006 * t42 * t225 * t575 / 0.1536e4 + t150 * t1006 * t167 * t225 * t169 * t575 / 0.256e3 + t150 * t1006 * t328 * t329 * t225 * t575 / 0.384e3 + 0.5e1 / 0.128e3 * t65 * t1026 * t70 * t113 + t503 * t42 * t491 * t313 / 0.1152e4 + t1081));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t1086;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t38, t39, t40, t43;
  double t44, t46, t47, t48, t52, t56, t57, t58;
  double t60, t61, t62, t63, t65, t66, t67, t68;
  double t70, t71, t74, t75, t77, t78, t79, t83;
  double t87;

#ifndef XC_DONT_COMPILE_VXC
  double t88, t89, t90, t92, t95, t96, t100, t101;
  double t102, t105, t106, t108, t113, t114, t115, t116;
  double t117, t118, t120, t122, t123, t128, t130, t131;
  double t132, t133, t134, t137, t142, t143, t145, t148;
  double t149, t153, t156, t158, t162, t165, t166, t171;
  double t173, t176, t177, t181, t183, t188, t189, t191;
  double t193, t194, t199, t201, t202, t203, t204, t205;
  double t208, t213, t216, t222, t229, t231, t234, t238;
  double t239, t245, t252, t254, t257, t261;

#ifndef XC_DONT_COMPILE_FXC
  double t264, t265, t266, t269, t270, t271, t274, t278;
  double t279, t283, t285, t291, t292, t295, t297, t300;
  double t305, t307, t313, t317, t318, t319, t320, t321;
  double t322, t323, t324, t325, t328, t332, t334, t336;
  double t338, t342, t345, t350, t351, t352, t353, t356;
  double t359, t363, t364, t368, t370, t372, t375, t377;
  double t380, t384, t388, t389, t393, t395, t403, t404;
  double t408, t412, t413, t417, t419, t426, t429, t434;
  double t439, t443, t444, t450, t451, t456, t460, t461;
  double t471, t476, t478, t484, t487, t488, t489, t490;
  double t491, t492, t493, t494, t497, t501, t503, t506;
  double t510, t513, t518, t526, t539, t540, t541, t542;
  double t543, t546, t548, t552, t553, t555, t560, t565;
  double t572, t574, t580, t597, t598, t599, t600, t601;
  double t604, t606, t610, t611, t613, t618, t623, t625;
  double t630, t636, t638, t641, t642, t647, t651, t658;
  double t662, t663, t668, t674, t676, t679, t680, t685;
  double t689, t696, t700;

#ifndef XC_DONT_COMPILE_KXC
  double t704, t705, t708, t711, t712, t713, t716, t720;
  double t721, t725, t727, t732, t734, t737, t743, t744;
  double t747, t749, t752, t755, t761, t770, t771, t772;
  double t780, t785, t786, t788, t789, t790, t792, t794;
  double t799, t800, t805, t806, t810, t811, t812, t813;
  double t814, t817, t824, t829, t831, t832, t835, t838;
  double t841, t845, t846, t850, t852, t854, t856, t858;
  double t861, t863, t866, t867, t868, t871, t876, t877;
  double t879, t883, t884, t888, t891, t895, t897, t901;
  double t910, t911, t912, t915, t920, t922, t926, t927;
  double t931, t934, t935, t937, t946, t948, t951, t954;
  double t959, t963, t967, t968, t972, t974, t983, t984;
  double t989, t993, t997, t998, t1002, t1004, t1011, t1019;
  double t1021, t1022, t1027, t1034, t1038, t1039, t1046, t1047;
  double t1054, t1058, t1059, t1075, t1081, t1090, t1091, t1092;
  double t1100, t1105, t1106, t1108, t1109, t1110, t1112, t1114;
  double t1118, t1122, t1126, t1127, t1128, t1129, t1132, t1139;
  double t1144, t1152, t1159, t1161, t1175, t1181, t1187, t1189;
  double t1191, t1195, t1199, t1200, t1203, t1206, t1207, t1212;
  double t1213, t1218, t1219, t1222, t1227, t1234, t1238, t1240;
  double t1246, t1254, t1260, t1267, t1270, t1278, t1301, t1307;
  double t1313, t1315, t1317, t1321, t1325, t1326, t1329, t1332;
  double t1333, t1338, t1339, t1344, t1345, t1348, t1353, t1360;
  double t1371, t1372, t1373, t1376, t1380, t1386, t1391, t1392;
  double t1395, t1398, t1399, t1406, t1411, t1418, t1420, t1426;
  double t1441, t1442, t1443, t1446, t1450, t1456, t1461, t1462;
  double t1465, t1468, t1469, t1476, t1481, t1483, t1484, t1489;
  double t1495, t1499, t1501, t1503, t1507, t1511, t1512, t1515;
  double t1517, t1518, t1522, t1523, t1527, t1528, t1531, t1535;
  double t1536, t1537, t1542, t1548, t1552, t1554, t1556, t1560;
  double t1564, t1565, t1568, t1570, t1571, t1575, t1576, t1580;
  double t1581, t1584, t1588;

#ifndef XC_DONT_COMPILE_LXC
  double t1592, t1596, t1599, t1603, t1607, t1609, t1611, t1612;
  double t1618, t1624, t1625, t1628, t1632, t1641, t1647, t1649;
  double t1655, t1658, t1661, t1666, t1667, t1668, t1669, t1672;
  double t1673, t1677, t1678, t1679, t1684, t1685, t1689, t1690;
  double t1694, t1697, t1698, t1711, t1713, t1721, t1726, t1730;
  double t1731, t1743, t1757, t1762, t1763, t1764, t1766, t1767;
  double t1773, t1778, t1781, t1785, t1792, t1796, t1800, t1805;
  double t1807, t1814, t1818, t1819, t1822, t1843, t1844, t1846;
  double t1850, t1859, t1865, t1866, t1868, t1879, t1880, t1897;
  double t1899, t1903, t1910, t1914, t1915, t1918, t1927, t1930;
  double t1931, t1933, t1935, t1936, t1945, t1949, t1964, t1977;
  double t1981, t1990, t2001, t2002, t2011, t2024, t2028, t2035;
  double t2039, t2048, t2051, t2062, t2065, t2067, t2068, t2089;
  double t2093, t2100, t2111, t2112, t2129, t2133, t2140, t2148;
  double t2157, t2167, t2169, t2170, t2175, t2180, t2187, t2191;
  double t2200, t2201, t2206, t2213, t2217, t2232, t2237, t2238;
  double t2245, t2246, t2247, t2248, t2250, t2254, t2258, t2261;
  double t2265, t2268, t2269, t2275, t2295, t2297, t2311, t2318;
  double t2331, t2332, t2340, t2346, t2349, t2356, t2358, t2361;
  double t2363, t2367, t2369, t2379, t2384, t2402, t2416, t2419;
  double t2425, t2431, t2437, t2441, t2454, t2460, t2467, t2470;
  double t2474, t2476, t2478, t2484, t2489, t2493, t2502, t2503;
  double t2505, t2511, t2513, t2522, t2524, t2527, t2533, t2542;
  double t2548, t2555, t2563, t2565, t2566, t2575, t2596, t2602;
  double t2604, t2614, t2619, t2625, t2645, t2648, t2654, t2660;
  double t2666, t2670, t2683, t2689, t2696, t2703, t2705, t2708;
  double t2709, t2712, t2733, t2735, t2746, t2766, t2785, t2791;
  double t2798, t2802, t2804, t2810, t2818, t2824, t2831, t2834;
  double t2842, t2853, t2857, t2859, t2865, t2888, t2898, t2930;
  double t2936, t2943, t2947, t2949, t2959, t2966, t2979, t3005;
  double t3026, t3032, t3039, t3041, t3047, t3052, t3070, t3072;
  double t3082, t3094, t3103, t3134, t3140, t3142, t3143, t3148;
  double t3159, t3165, t3169, t3170, t3184, t3234, t3239, t3240;
  double t3241, t3246, t3261, t3271, t3275, t3276, t3289, t3332;
  double t3337;
#endif

#endif

#endif

#endif

#endif


  gga_x_cap_params *params;

  assert(p->params != NULL);
  params = (gga_x_cap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = 0.1e1 / t32;
  t34 = params->alphaoAx * t29 * t33;
  t35 = sqrt(sigma[0]);
  t36 = POW_1_3(rho[0]);
  t38 = 0.1e1 / t36 / rho[0];
  t39 = t35 * t38;
  t40 = t29 * t33;
  t43 = 0.1e1 + t40 * t39 / 0.12e2;
  t44 = log(t43);
  t46 = params->c * t44 + 0.1e1;
  t47 = 0.1e1 / t46;
  t48 = t44 * t47;
  t52 = 0.1e1 - t34 * t39 * t48 / 0.12e2;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = -t16;
  t60 = my_piecewise5(t14, t11, t10, t15, t58 * t7);
  t61 = 0.1e1 + t60;
  t62 = t61 <= p->zeta_threshold;
  t63 = POW_1_3(t61);
  t65 = my_piecewise3(t62, t22, t63 * t61);
  t66 = t65 * t26;
  t67 = sqrt(sigma[2]);
  t68 = POW_1_3(rho[1]);
  t70 = 0.1e1 / t68 / rho[1];
  t71 = t67 * t70;
  t74 = 0.1e1 + t40 * t71 / 0.12e2;
  t75 = log(t74);
  t77 = params->c * t75 + 0.1e1;
  t78 = 0.1e1 / t77;
  t79 = t75 * t78;
  t83 = 0.1e1 - t34 * t71 * t79 / 0.12e2;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t66 * t83);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t56 + t87;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t88 = t6 * t6;
  t89 = 0.1e1 / t88;
  t90 = t16 * t89;
  t92 = my_piecewise5(t10, 0, t14, 0, t7 - t90);
  t95 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t92);
  t96 = t95 * t26;
  t100 = t26 * t26;
  t101 = 0.1e1 / t100;
  t102 = t25 * t101;
  t105 = t5 * t102 * t52 / 0.8e1;
  t106 = rho[0] * rho[0];
  t108 = 0.1e1 / t36 / t106;
  t113 = params->alphaoAx * t28;
  t114 = t32 * t32;
  t115 = 0.1e1 / t114;
  t116 = t113 * t115;
  t117 = t106 * rho[0];
  t118 = t36 * t36;
  t120 = 0.1e1 / t118 / t117;
  t122 = 0.1e1 / t43;
  t123 = t122 * t47;
  t128 = t113 * t115 * sigma[0];
  t130 = t46 * t46;
  t131 = 0.1e1 / t130;
  t132 = t131 * params->c;
  t133 = t132 * t122;
  t134 = t120 * t44 * t133;
  t137 = t34 * t35 * t108 * t48 / 0.9e1 + t116 * sigma[0] * t120 * t123 / 0.18e2 - t128 * t134 / 0.18e2;
  t142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t52 - t105 - 0.3e1 / 0.8e1 * t5 * t27 * t137);
  t143 = t58 * t89;
  t145 = my_piecewise5(t14, 0, t10, 0, -t7 - t143);
  t148 = my_piecewise3(t62, 0, 0.4e1 / 0.3e1 * t63 * t145);
  t149 = t148 * t26;
  t153 = t65 * t101;
  t156 = t5 * t153 * t83 / 0.8e1;
  t158 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t83 - t156);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t56 + t87 + t6 * (t142 + t158);

  t162 = my_piecewise5(t10, 0, t14, 0, -t7 - t90);
  t165 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t162);
  t166 = t165 * t26;
  t171 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t52 - t105);
  t173 = my_piecewise5(t14, 0, t10, 0, t7 - t143);
  t176 = my_piecewise3(t62, 0, 0.4e1 / 0.3e1 * t63 * t173);
  t177 = t176 * t26;
  t181 = rho[1] * rho[1];
  t183 = 0.1e1 / t68 / t181;
  t188 = t181 * rho[1];
  t189 = t68 * t68;
  t191 = 0.1e1 / t189 / t188;
  t193 = 0.1e1 / t74;
  t194 = t193 * t78;
  t199 = t113 * t115 * sigma[2];
  t201 = t77 * t77;
  t202 = 0.1e1 / t201;
  t203 = t202 * params->c;
  t204 = t203 * t193;
  t205 = t191 * t75 * t204;
  t208 = t34 * t67 * t183 * t79 / 0.9e1 + t116 * sigma[2] * t191 * t194 / 0.18e2 - t199 * t205 / 0.18e2;
  t213 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t83 - t156 - 0.3e1 / 0.8e1 * t5 * t66 * t208);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t56 + t87 + t6 * (t171 + t213);

  t216 = 0.1e1 / t35;
  t222 = 0.1e1 / t118 / t106;
  t229 = t44 * t131;
  t231 = t229 * params->c * t122;
  t234 = -t34 * t216 * t38 * t48 / 0.24e2 - t116 * t222 * t122 * t47 / 0.48e2 + t113 * t115 * t222 * t231 / 0.48e2;
  t238 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t234);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t6 * t238;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t239 = 0.1e1 / t67;
  t245 = 0.1e1 / t189 / t181;
  t252 = t75 * t202;
  t254 = t252 * params->c * t193;
  t257 = -t34 * t239 * t70 * t79 / 0.24e2 - t116 * t245 * t193 * t78 / 0.48e2 + t113 * t115 * t245 * t254 / 0.48e2;
  t261 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t66 * t257);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t261;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t92 * t92;
  t269 = t88 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t274 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t89 + 0.2e1 * t271);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t279 = t278 * t26;
  t283 = t95 * t101;
  t285 = t5 * t283 * t52;
  t291 = 0.1e1 / t100 / t6;
  t292 = t25 * t291;
  t295 = t5 * t292 * t52 / 0.12e2;
  t297 = t5 * t102 * t137;
  t300 = 0.1e1 / t36 / t117;
  t305 = t106 * t106;
  t307 = 0.1e1 / t118 / t305;
  t313 = t307 * t44 * t133;
  t317 = params->alphaoAx / t31;
  t318 = t35 * sigma[0];
  t319 = t317 * t318;
  t320 = t305 * t106;
  t321 = 0.1e1 / t320;
  t322 = t43 * t43;
  t323 = 0.1e1 / t322;
  t324 = t321 * t323;
  t325 = t324 * t47;
  t328 = t324 * t132;
  t332 = t317 * t318 * t321;
  t334 = 0.1e1 / t130 / t46;
  t336 = params->c * params->c;
  t338 = t44 * t334 * t336 * t323;
  t342 = t229 * params->c * t323;
  t345 = -0.7e1 / 0.27e2 * t34 * t35 * t300 * t48 - 0.5e1 / 0.18e2 * t116 * sigma[0] * t307 * t123 + 0.5e1 / 0.18e2 * t128 * t313 + t319 * t325 / 0.27e2 + 0.2e1 / 0.27e2 * t319 * t328 - 0.2e1 / 0.27e2 * t332 * t338 - t332 * t342 / 0.27e2;
  t350 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t52 - t285 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t137 + t295 - t297 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t345);
  t351 = t63 * t63;
  t352 = 0.1e1 / t351;
  t353 = t145 * t145;
  t356 = t58 * t270;
  t359 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t89 + 0.2e1 * t356);
  t363 = my_piecewise3(t62, 0, 0.4e1 / 0.9e1 * t352 * t353 + 0.4e1 / 0.3e1 * t63 * t359);
  t364 = t363 * t26;
  t368 = t148 * t101;
  t370 = t5 * t368 * t83;
  t372 = t65 * t291;
  t375 = t5 * t372 * t83 / 0.12e2;
  t377 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t364 * t83 - t370 / 0.4e1 + t375);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t142 + 0.2e1 * t158 + t6 * (t350 + t377);

  t380 = t265 * t162;
  t384 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t271);
  t388 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t380 * t92 + 0.4e1 / 0.3e1 * t23 * t384);
  t389 = t388 * t26;
  t393 = t165 * t101;
  t395 = t5 * t393 * t52;
  t403 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t389 * t52 - t395 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t137 - t285 / 0.8e1 + t295 - t297 / 0.8e1);
  t404 = t352 * t173;
  t408 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t356);
  t412 = my_piecewise3(t62, 0, 0.4e1 / 0.9e1 * t404 * t145 + 0.4e1 / 0.3e1 * t63 * t408);
  t413 = t412 * t26;
  t417 = t176 * t101;
  t419 = t5 * t417 * t83;
  t426 = t5 * t153 * t208;
  t429 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t413 * t83 - t419 / 0.8e1 - t370 / 0.8e1 + t375 - 0.3e1 / 0.8e1 * t5 * t149 * t208 - t426 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t142 + t158 + t171 + t213 + t6 * (t403 + t429);

  t434 = t162 * t162;
  t439 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t89 + 0.2e1 * t271);
  t443 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t434 + 0.4e1 / 0.3e1 * t23 * t439);
  t444 = t443 * t26;
  t450 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t444 * t52 - t395 / 0.4e1 + t295);
  t451 = t173 * t173;
  t456 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t89 + 0.2e1 * t356);
  t460 = my_piecewise3(t62, 0, 0.4e1 / 0.9e1 * t352 * t451 + 0.4e1 / 0.3e1 * t63 * t456);
  t461 = t460 * t26;
  t471 = 0.1e1 / t68 / t188;
  t476 = t181 * t181;
  t478 = 0.1e1 / t189 / t476;
  t484 = t478 * t75 * t204;
  t487 = t67 * sigma[2];
  t488 = t317 * t487;
  t489 = t476 * t181;
  t490 = 0.1e1 / t489;
  t491 = t74 * t74;
  t492 = 0.1e1 / t491;
  t493 = t490 * t492;
  t494 = t493 * t78;
  t497 = t493 * t203;
  t501 = t317 * t487 * t490;
  t503 = 0.1e1 / t201 / t77;
  t506 = t75 * t503 * t336 * t492;
  t510 = t252 * params->c * t492;
  t513 = -0.7e1 / 0.27e2 * t34 * t67 * t471 * t79 - 0.5e1 / 0.18e2 * t116 * sigma[2] * t478 * t194 + 0.5e1 / 0.18e2 * t199 * t484 + t488 * t494 / 0.27e2 + 0.2e1 / 0.27e2 * t488 * t497 - 0.2e1 / 0.27e2 * t501 * t506 - t501 * t510 / 0.27e2;
  t518 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t461 * t83 - t419 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t208 + t375 - t426 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t66 * t513);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t171 + 0.2e1 * t213 + t6 * (t450 + t518);

  t526 = t5 * t102 * t234 / 0.8e1;
  t539 = t305 * rho[0];
  t540 = 0.1e1 / t539;
  t541 = t317 * t540;
  t542 = t323 * t47;
  t543 = t542 * t35;
  t546 = t323 * t131;
  t548 = t546 * params->c * t35;
  t552 = t317 * t540 * t44;
  t553 = t334 * t336;
  t555 = t553 * t323 * t35;
  t560 = t34 * t216 * t108 * t48 / 0.18e2 + t116 * t120 * t122 * t47 / 0.12e2 - t113 * t115 * t120 * t231 / 0.12e2 - t541 * t543 / 0.72e2 - t541 * t548 / 0.36e2 + t552 * t555 / 0.36e2 + t552 * t548 / 0.72e2;
  t565 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t234 - t526 - 0.3e1 / 0.8e1 * t5 * t27 * t560);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t6 * t565 + t238;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t572 = t5 * t153 * t257 / 0.8e1;
  t574 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t257 - t572);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t6 * t574 + t261;

  t580 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t234 - t526);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t6 * t580 + t238;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t597 = t476 * rho[1];
  t598 = 0.1e1 / t597;
  t599 = t317 * t598;
  t600 = t492 * t78;
  t601 = t600 * t67;
  t604 = t492 * t202;
  t606 = t604 * params->c * t67;
  t610 = t317 * t598 * t75;
  t611 = t503 * t336;
  t613 = t611 * t492 * t67;
  t618 = t34 * t239 * t183 * t79 / 0.18e2 + t116 * t191 * t193 * t78 / 0.12e2 - t113 * t115 * t191 * t254 / 0.12e2 - t599 * t601 / 0.72e2 - t599 * t606 / 0.36e2 + t610 * t613 / 0.36e2 + t610 * t606 / 0.72e2;
  t623 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t257 - t572 - 0.3e1 / 0.8e1 * t5 * t66 * t618);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t6 * t623 + t261;

  t625 = 0.1e1 / t318;
  t630 = 0.1e1 / sigma[0];
  t636 = t113 * t115 * t630;
  t638 = t222 * t44 * t133;
  t641 = 0.1e1 / t305;
  t642 = t317 * t641;
  t647 = t546 * params->c * t216;
  t651 = t317 * t641 * t44;
  t658 = t34 * t625 * t38 * t48 / 0.48e2 - t116 * t630 * t222 * t123 / 0.96e2 + t636 * t638 / 0.96e2 + t642 * t542 * t216 / 0.192e3 + t642 * t647 / 0.96e2 - t651 * t553 * t323 * t216 / 0.96e2 - t651 * t647 / 0.192e3;
  t662 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t658);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t662;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t663 = 0.1e1 / t487;
  t668 = 0.1e1 / sigma[2];
  t674 = t113 * t115 * t668;
  t676 = t245 * t75 * t204;
  t679 = 0.1e1 / t476;
  t680 = t317 * t679;
  t685 = t604 * params->c * t239;
  t689 = t317 * t679 * t75;
  t696 = t34 * t663 * t70 * t79 / 0.48e2 - t116 * t668 * t245 * t194 / 0.96e2 + t674 * t676 / 0.96e2 + t680 * t600 * t239 / 0.192e3 + t680 * t685 / 0.96e2 - t689 * t611 * t492 * t239 / 0.96e2 - t689 * t685 / 0.192e3;
  t700 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t66 * t696);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t700;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t704 = 0.1e1 / t264 / t19;
  t705 = t266 * t92;
  t708 = t265 * t92;
  t711 = t88 * t88;
  t712 = 0.1e1 / t711;
  t713 = t16 * t712;
  t716 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t270 - 0.6e1 * t713);
  t720 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t704 * t705 + 0.4e1 / 0.3e1 * t708 * t274 + 0.4e1 / 0.3e1 * t23 * t716);
  t721 = t720 * t26;
  t725 = t278 * t101;
  t727 = t5 * t725 * t52;
  t732 = t95 * t291;
  t734 = t5 * t732 * t52;
  t737 = t5 * t283 * t137;
  t743 = 0.1e1 / t100 / t88;
  t744 = t25 * t743;
  t747 = 0.5e1 / 0.36e2 * t5 * t744 * t52;
  t749 = t5 * t292 * t137;
  t752 = t5 * t102 * t345;
  t755 = 0.1e1 / t36 / t305;
  t761 = 0.1e1 / t118 / t539;
  t770 = t305 * t117;
  t771 = 0.1e1 / t770;
  t772 = t771 * t323;
  t780 = t317 * t318 * t771;
  t785 = sigma[0] * sigma[0];
  t786 = t305 * t305;
  t788 = 0.1e1 / t36 / t786;
  t789 = t785 * t788;
  t790 = t317 * t789;
  t792 = 0.1e1 / t322 / t43;
  t794 = t792 * t47 * t40;
  t799 = params->c * t29 * t33;
  t800 = t792 * t131 * t799;
  t805 = t336 * t29 * t33;
  t806 = t792 * t334 * t805;
  t810 = t317 * t789 * t44;
  t811 = t130 * t130;
  t812 = 0.1e1 / t811;
  t813 = t336 * params->c;
  t814 = t812 * t813;
  t817 = t814 * t792 * t29 * t33;
  t824 = 0.70e2 / 0.81e2 * t34 * t35 * t755 * t48 + 0.119e3 / 0.81e2 * t116 * sigma[0] * t761 * t123 - 0.119e3 / 0.81e2 * t128 * t761 * t44 * t133 - 0.11e2 / 0.27e2 * t319 * t772 * t47 - 0.22e2 / 0.27e2 * t319 * t772 * t132 + 0.22e2 / 0.27e2 * t780 * t338 + 0.11e2 / 0.27e2 * t780 * t342 + 0.2e1 / 0.243e3 * t790 * t794 + 0.2e1 / 0.81e2 * t790 * t800 + 0.2e1 / 0.81e2 * t790 * t806 - 0.2e1 / 0.81e2 * t810 * t817 - 0.2e1 / 0.81e2 * t810 * t806 - 0.2e1 / 0.243e3 * t810 * t800;
  t829 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t721 * t52 - 0.3e1 / 0.8e1 * t727 - 0.9e1 / 0.8e1 * t5 * t279 * t137 + t734 / 0.4e1 - 0.3e1 / 0.4e1 * t737 - 0.9e1 / 0.8e1 * t5 * t96 * t345 - t747 + t749 / 0.4e1 - 0.3e1 / 0.8e1 * t752 - 0.3e1 / 0.8e1 * t5 * t27 * t824);
  t831 = 0.1e1 / t351 / t61;
  t832 = t353 * t145;
  t835 = t352 * t145;
  t838 = t58 * t712;
  t841 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t270 - 0.6e1 * t838);
  t845 = my_piecewise3(t62, 0, -0.8e1 / 0.27e2 * t831 * t832 + 0.4e1 / 0.3e1 * t835 * t359 + 0.4e1 / 0.3e1 * t63 * t841);
  t846 = t845 * t26;
  t850 = t363 * t101;
  t852 = t5 * t850 * t83;
  t854 = t148 * t291;
  t856 = t5 * t854 * t83;
  t858 = t65 * t743;
  t861 = 0.5e1 / 0.36e2 * t5 * t858 * t83;
  t863 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t846 * t83 - 0.3e1 / 0.8e1 * t852 + t856 / 0.4e1 - t861);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.3e1 * t350 + 0.3e1 * t377 + t6 * (t829 + t863);

  t866 = 0.2e1 * t403;
  t867 = 0.2e1 * t429;
  t868 = t704 * t162;
  t871 = t265 * t384;
  t876 = 0.2e1 * t270;
  t877 = 0.6e1 * t713;
  t879 = my_piecewise5(t10, 0, t14, 0, t876 - t877);
  t883 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t868 * t266 + 0.8e1 / 0.9e1 * t871 * t92 + 0.4e1 / 0.9e1 * t380 * t274 + 0.4e1 / 0.3e1 * t23 * t879);
  t884 = t883 * t26;
  t888 = t388 * t101;
  t891 = t5 * t888 * t52 / 0.4e1;
  t895 = t165 * t291;
  t897 = t5 * t895 * t52;
  t901 = t5 * t393 * t137 / 0.4e1;
  t910 = -0.3e1 / 0.8e1 * t5 * t884 * t52 - t891 - 0.3e1 / 0.4e1 * t5 * t389 * t137 + t897 / 0.12e2 - t901 - 0.3e1 / 0.8e1 * t5 * t166 * t345 - t727 / 0.8e1 + t734 / 0.6e1 - t737 / 0.4e1 - t747 + t749 / 0.6e1 - t752 / 0.8e1;
  t911 = my_piecewise3(t1, 0, t910);
  t912 = t831 * t173;
  t915 = t352 * t408;
  t920 = 0.6e1 * t838;
  t922 = my_piecewise5(t14, 0, t10, 0, -t876 - t920);
  t926 = my_piecewise3(t62, 0, -0.8e1 / 0.27e2 * t912 * t353 + 0.8e1 / 0.9e1 * t915 * t145 + 0.4e1 / 0.9e1 * t404 * t359 + 0.4e1 / 0.3e1 * t63 * t922);
  t927 = t926 * t26;
  t931 = t412 * t101;
  t934 = t5 * t931 * t83 / 0.4e1;
  t935 = t176 * t291;
  t937 = t5 * t935 * t83;
  t946 = t5 * t368 * t208 / 0.4e1;
  t948 = t5 * t372 * t208;
  t951 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t927 * t83 - t934 + t937 / 0.12e2 - t852 / 0.8e1 + t856 / 0.6e1 - t861 - 0.3e1 / 0.8e1 * t5 * t364 * t208 - t946 + t948 / 0.12e2);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = t350 + t377 + t866 + t867 + t6 * (t911 + t951);

  t954 = t704 * t434;
  t959 = t265 * t439;
  t963 = my_piecewise5(t10, 0, t14, 0, -t876 - t877);
  t967 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t954 * t92 + 0.8e1 / 0.9e1 * t380 * t384 + 0.4e1 / 0.9e1 * t959 * t92 + 0.4e1 / 0.3e1 * t23 * t963);
  t968 = t967 * t26;
  t972 = t443 * t101;
  t974 = t5 * t972 * t52;
  t983 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t968 * t52 - t974 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t444 * t137 - t891 + t897 / 0.6e1 - t901 + t734 / 0.12e2 - t747 + t749 / 0.12e2);
  t984 = t831 * t451;
  t989 = t352 * t456;
  t993 = my_piecewise5(t14, 0, t10, 0, t876 - t920);
  t997 = my_piecewise3(t62, 0, -0.8e1 / 0.27e2 * t984 * t145 + 0.8e1 / 0.9e1 * t404 * t408 + 0.4e1 / 0.9e1 * t989 * t145 + 0.4e1 / 0.3e1 * t63 * t993);
  t998 = t997 * t26;
  t1002 = t460 * t101;
  t1004 = t5 * t1002 * t83;
  t1011 = t5 * t417 * t208;
  t1019 = t5 * t153 * t513;
  t1021 = -0.3e1 / 0.8e1 * t5 * t998 * t83 - t1004 / 0.8e1 - t934 + t937 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t413 * t208 - t1011 / 0.4e1 + t856 / 0.12e2 - t861 - t946 + t948 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t149 * t513 - t1019 / 0.8e1;
  t1022 = my_piecewise3(t57, 0, t1021);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = t866 + t867 + t450 + t518 + t6 * (t983 + t1022);

  t1027 = t434 * t162;
  t1034 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t270 - 0.6e1 * t713);
  t1038 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t704 * t1027 + 0.4e1 / 0.3e1 * t380 * t439 + 0.4e1 / 0.3e1 * t23 * t1034);
  t1039 = t1038 * t26;
  t1046 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1039 * t52 - 0.3e1 / 0.8e1 * t974 + t897 / 0.4e1 - t747);
  t1047 = t451 * t173;
  t1054 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t270 - 0.6e1 * t838);
  t1058 = my_piecewise3(t62, 0, -0.8e1 / 0.27e2 * t831 * t1047 + 0.4e1 / 0.3e1 * t404 * t456 + 0.4e1 / 0.3e1 * t63 * t1054);
  t1059 = t1058 * t26;
  t1075 = 0.1e1 / t68 / t476;
  t1081 = 0.1e1 / t189 / t597;
  t1090 = t476 * t188;
  t1091 = 0.1e1 / t1090;
  t1092 = t1091 * t492;
  t1100 = t317 * t487 * t1091;
  t1105 = sigma[2] * sigma[2];
  t1106 = t476 * t476;
  t1108 = 0.1e1 / t68 / t1106;
  t1109 = t1105 * t1108;
  t1110 = t317 * t1109;
  t1112 = 0.1e1 / t491 / t74;
  t1114 = t1112 * t78 * t40;
  t1118 = t1112 * t202 * t799;
  t1122 = t1112 * t503 * t805;
  t1126 = t317 * t1109 * t75;
  t1127 = t201 * t201;
  t1128 = 0.1e1 / t1127;
  t1129 = t1128 * t813;
  t1132 = t1129 * t1112 * t29 * t33;
  t1139 = 0.70e2 / 0.81e2 * t34 * t67 * t1075 * t79 + 0.119e3 / 0.81e2 * t116 * sigma[2] * t1081 * t194 - 0.119e3 / 0.81e2 * t199 * t1081 * t75 * t204 - 0.11e2 / 0.27e2 * t488 * t1092 * t78 - 0.22e2 / 0.27e2 * t488 * t1092 * t203 + 0.22e2 / 0.27e2 * t1100 * t506 + 0.11e2 / 0.27e2 * t1100 * t510 + 0.2e1 / 0.243e3 * t1110 * t1114 + 0.2e1 / 0.81e2 * t1110 * t1118 + 0.2e1 / 0.81e2 * t1110 * t1122 - 0.2e1 / 0.81e2 * t1126 * t1132 - 0.2e1 / 0.81e2 * t1126 * t1122 - 0.2e1 / 0.243e3 * t1126 * t1118;
  t1144 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1059 * t83 - 0.3e1 / 0.8e1 * t1004 - 0.9e1 / 0.8e1 * t5 * t461 * t208 + t937 / 0.4e1 - 0.3e1 / 0.4e1 * t1011 - 0.9e1 / 0.8e1 * t5 * t177 * t513 - t861 + t948 / 0.4e1 - 0.3e1 / 0.8e1 * t1019 - 0.3e1 / 0.8e1 * t5 * t66 * t1139);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = 0.3e1 * t450 + 0.3e1 * t518 + t6 * (t1046 + t1144);

  t1152 = t5 * t283 * t234;
  t1159 = t5 * t292 * t234 / 0.12e2;
  t1161 = t5 * t102 * t560;
  t1175 = t317 * t321;
  t1181 = t317 * t321 * t44;
  t1187 = 0.1e1 / t36 / t770;
  t1189 = t317 * t1187 * t792;
  t1191 = t47 * sigma[0] * t40;
  t1195 = t131 * sigma[0] * t799;
  t1199 = sigma[0] * t29 * t33;
  t1200 = t553 * t1199;
  t1203 = t1187 * t44;
  t1206 = t813 * t792;
  t1207 = t1206 * t1199;
  t1212 = t336 * t792;
  t1213 = t1212 * t1199;
  t1218 = params->c * t792;
  t1219 = t1218 * t1199;
  t1222 = -0.7e1 / 0.54e2 * t34 * t216 * t300 * t48 - 0.37e2 / 0.108e3 * t116 * t307 * t122 * t47 + 0.37e2 / 0.108e3 * t113 * t115 * t307 * t231 + t1175 * t543 / 0.8e1 + t1175 * t548 / 0.4e1 - t1181 * t555 / 0.4e1 - t1181 * t548 / 0.8e1 - t1189 * t1191 / 0.324e3 - t1189 * t1195 / 0.108e3 - t1189 * t1200 / 0.108e3 + t317 * t1203 * t812 * t1207 / 0.108e3 + t317 * t1203 * t334 * t1213 / 0.108e3 + t317 * t1203 * t131 * t1219 / 0.324e3;
  t1227 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t234 - t1152 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t560 + t1159 - t1161 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1222);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = t6 * t1227 + 0.2e1 * t565;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t1234 = t5 * t368 * t257;
  t1238 = t5 * t372 * t257 / 0.12e2;
  t1240 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t364 * t257 - t1234 / 0.4e1 + t1238);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = t6 * t1240 + 0.2e1 * t574;

  t1246 = t5 * t393 * t234;
  t1254 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t389 * t234 - t1246 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t560 - t1152 / 0.8e1 + t1159 - t1161 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = t6 * t1254 + t565 + t580;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1260 = t5 * t417 * t257;
  t1267 = t5 * t153 * t618;
  t1270 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t413 * t257 - t1260 / 0.8e1 - t1234 / 0.8e1 + t1238 - 0.3e1 / 0.8e1 * t5 * t149 * t618 - t1267 / 0.8e1);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = t6 * t1270 + t574 + t623;

  t1278 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t444 * t234 - t1246 / 0.4e1 + t1159);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = t6 * t1278 + 0.2e1 * t580;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1301 = t317 * t490;
  t1307 = t317 * t490 * t75;
  t1313 = 0.1e1 / t68 / t1090;
  t1315 = t317 * t1313 * t1112;
  t1317 = t78 * sigma[2] * t40;
  t1321 = t202 * sigma[2] * t799;
  t1325 = sigma[2] * t29 * t33;
  t1326 = t611 * t1325;
  t1329 = t1313 * t75;
  t1332 = t813 * t1112;
  t1333 = t1332 * t1325;
  t1338 = t336 * t1112;
  t1339 = t1338 * t1325;
  t1344 = params->c * t1112;
  t1345 = t1344 * t1325;
  t1348 = -0.7e1 / 0.54e2 * t34 * t239 * t471 * t79 - 0.37e2 / 0.108e3 * t116 * t478 * t193 * t78 + 0.37e2 / 0.108e3 * t113 * t115 * t478 * t254 + t1301 * t601 / 0.8e1 + t1301 * t606 / 0.4e1 - t1307 * t613 / 0.4e1 - t1307 * t606 / 0.8e1 - t1315 * t1317 / 0.324e3 - t1315 * t1321 / 0.108e3 - t1315 * t1326 / 0.108e3 + t317 * t1329 * t1128 * t1333 / 0.108e3 + t317 * t1329 * t503 * t1339 / 0.108e3 + t317 * t1329 * t202 * t1345 / 0.324e3;
  t1353 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t461 * t257 - t1260 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t618 + t1238 - t1267 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t66 * t1348);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = t6 * t1353 + 0.2e1 * t623;

  t1360 = t5 * t102 * t658 / 0.8e1;
  t1371 = t317 * t216;
  t1372 = t540 * t323;
  t1373 = t1372 * t47;
  t1376 = t1372 * t132;
  t1380 = t317 * t216 * t540;
  t1386 = 0.1e1 / t36 / t320;
  t1391 = t317 * t1386 * t792;
  t1392 = t132 * t40;
  t1395 = t553 * t40;
  t1398 = t1386 * t44;
  t1399 = t317 * t1398;
  t1406 = -t34 * t625 * t108 * t48 / 0.36e2 + t116 * t630 * t120 * t123 / 0.72e2 - t636 * t134 / 0.72e2 - t1371 * t1373 / 0.36e2 - t1371 * t1376 / 0.18e2 + t1380 * t338 / 0.18e2 + t1380 * t342 / 0.36e2 + t317 * t1386 * t794 / 0.864e3 + t1391 * t1392 / 0.288e3 + t1391 * t1395 / 0.288e3 - t1399 * t817 / 0.288e3 - t1399 * t806 / 0.288e3 - t1399 * t800 / 0.864e3;
  t1411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t658 - t1360 - 0.3e1 / 0.8e1 * t5 * t27 * t1406);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = t6 * t1411 + t662;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1418 = t5 * t153 * t696 / 0.8e1;
  t1420 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t696 - t1418);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = t6 * t1420 + t700;

  t1426 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t658 - t1360);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = t6 * t1426 + t662;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1441 = t317 * t239;
  t1442 = t598 * t492;
  t1443 = t1442 * t78;
  t1446 = t1442 * t203;
  t1450 = t317 * t239 * t598;
  t1456 = 0.1e1 / t68 / t489;
  t1461 = t317 * t1456 * t1112;
  t1462 = t203 * t40;
  t1465 = t611 * t40;
  t1468 = t1456 * t75;
  t1469 = t317 * t1468;
  t1476 = -t34 * t663 * t183 * t79 / 0.36e2 + t116 * t668 * t191 * t194 / 0.72e2 - t674 * t205 / 0.72e2 - t1441 * t1443 / 0.36e2 - t1441 * t1446 / 0.18e2 + t1450 * t506 / 0.18e2 + t1450 * t510 / 0.36e2 + t317 * t1456 * t1114 / 0.864e3 + t1461 * t1462 / 0.288e3 + t1461 * t1465 / 0.288e3 - t1469 * t1132 / 0.288e3 - t1469 * t1122 / 0.288e3 - t1469 * t1118 / 0.864e3;
  t1481 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t696 - t1418 - 0.3e1 / 0.8e1 * t5 * t66 * t1476);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = t6 * t1481 + t700;

  t1483 = t35 * t785;
  t1484 = 0.1e1 / t1483;
  t1489 = 0.1e1 / t785;
  t1495 = t113 * t115 * t1489;
  t1499 = 0.1e1 / t36 / t539;
  t1501 = t317 * t1499 * t792;
  t1503 = t47 * t630 * t40;
  t1507 = t131 * t630 * t799;
  t1511 = t630 * t29 * t33;
  t1512 = t553 * t1511;
  t1515 = t1499 * t44;
  t1517 = t317 * t1515 * t812;
  t1518 = t1206 * t1511;
  t1522 = t317 * t1515 * t334;
  t1523 = t1212 * t1511;
  t1527 = t317 * t1515 * t131;
  t1528 = t1218 * t1511;
  t1531 = -t34 * t1484 * t38 * t48 / 0.32e2 + t116 * t1489 * t222 * t123 / 0.64e2 - t1495 * t638 / 0.64e2 - t1501 * t1503 / 0.2304e4 - t1501 * t1507 / 0.768e3 - t1501 * t1512 / 0.768e3 + t1517 * t1518 / 0.768e3 + t1522 * t1523 / 0.768e3 + t1527 * t1528 / 0.2304e4;
  t1535 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1531);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = t6 * t1535;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1536 = t67 * t1105;
  t1537 = 0.1e1 / t1536;
  t1542 = 0.1e1 / t1105;
  t1548 = t113 * t115 * t1542;
  t1552 = 0.1e1 / t68 / t597;
  t1554 = t317 * t1552 * t1112;
  t1556 = t78 * t668 * t40;
  t1560 = t202 * t668 * t799;
  t1564 = t668 * t29 * t33;
  t1565 = t611 * t1564;
  t1568 = t1552 * t75;
  t1570 = t317 * t1568 * t1128;
  t1571 = t1332 * t1564;
  t1575 = t317 * t1568 * t503;
  t1576 = t1338 * t1564;
  t1580 = t317 * t1568 * t202;
  t1581 = t1344 * t1564;
  t1584 = -t34 * t1537 * t70 * t79 / 0.32e2 + t116 * t1542 * t245 * t194 / 0.64e2 - t1548 * t676 / 0.64e2 - t1554 * t1556 / 0.2304e4 - t1554 * t1560 / 0.768e3 - t1554 * t1565 / 0.768e3 + t1570 * t1571 / 0.768e3 + t1575 * t1576 / 0.768e3 + t1580 * t1581 / 0.2304e4;
  t1588 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t66 * t1584);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = t6 * t1588;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t1592 = 0.1e1 / t100 / t269;
  t1596 = 0.10e2 / 0.27e2 * t5 * t25 * t1592 * t52;
  t1599 = t5 * t720 * t101 * t52;
  t1603 = t5 * t278 * t291 * t52;
  t1607 = t5 * t95 * t743 * t52;
  t1609 = t19 * t19;
  t1611 = 0.1e1 / t264 / t1609;
  t1612 = t266 * t266;
  t1618 = t274 * t274;
  t1624 = 0.1e1 / t711 / t6;
  t1625 = t16 * t1624;
  t1628 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t712 + 0.24e2 * t1625);
  t1632 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1611 * t1612 - 0.16e2 / 0.9e1 * t704 * t266 * t274 + 0.4e1 / 0.3e1 * t265 * t1618 + 0.16e2 / 0.9e1 * t708 * t716 + 0.4e1 / 0.3e1 * t23 * t1628);
  t1641 = t5 * t725 * t137;
  t1647 = t5 * t732 * t137;
  t1649 = t5 * t283 * t345;
  t1655 = t5 * t744 * t137;
  t1658 = t5 * t292 * t345;
  t1661 = t5 * t102 * t824;
  t1666 = t1483 / t118 / t786 / t106;
  t1667 = t317 * t1666;
  t1668 = t322 * t322;
  t1669 = 0.1e1 / t1668;
  t1672 = t813 * t28 * t115;
  t1673 = t1669 * t812 * t1672;
  t1677 = t28 * t115;
  t1678 = t1677 * params->c;
  t1679 = t1669 * t131 * t1678;
  t1684 = t336 * t28 * t115;
  t1685 = t1669 * t334 * t1684;
  t1689 = 0.1e1 / t118 / t320;
  t1690 = t1689 * t44;
  t1694 = t786 * rho[0];
  t1697 = t785 / t36 / t1694;
  t1698 = t317 * t1697;
  t1711 = 0.1e1 / t786;
  t1713 = t317 * t318 * t1711;
  t1721 = t1711 * t323;
  t1726 = t317 * t1666 * t44;
  t1730 = 0.1e1 / t811 / t46;
  t1731 = t336 * t336;
  t1743 = t317 * t1697 * t44;
  t1757 = -0.116e3 / 0.729e3 * t1698 * t794 + 0.931e3 / 0.243e3 * t319 * t1721 * t47 - 0.4e1 / 0.243e3 * t1726 * t1679 - 0.16e2 / 0.243e3 * t1726 * t1730 * t1731 * t1669 * t28 * t115 - 0.8e1 / 0.81e2 * t1726 * t1673 - 0.44e2 / 0.729e3 * t1726 * t1685 + 0.116e3 / 0.243e3 * t1743 * t817 + 0.116e3 / 0.243e3 * t1743 * t806 + 0.116e3 / 0.729e3 * t1743 * t800 - 0.721e3 / 0.81e2 * t116 * sigma[0] * t1689 * t123 + 0.1862e4 / 0.243e3 * t319 * t1721 * t132;
  t1762 = t1596 - t1599 / 0.2e1 + t1603 / 0.2e1 - 0.5e1 / 0.9e1 * t1607 - 0.3e1 / 0.8e1 * t5 * t1632 * t26 * t52 - 0.3e1 / 0.2e1 * t5 * t721 * t137 - 0.3e1 / 0.2e1 * t1641 - 0.9e1 / 0.4e1 * t5 * t279 * t345 + t1647 - 0.3e1 / 0.2e1 * t1649 - 0.3e1 / 0.2e1 * t5 * t96 * t824 - 0.5e1 / 0.9e1 * t1655 + t1658 / 0.2e1 - t1661 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.16e2 / 0.243e3 * t1667 * t1673 + 0.44e2 / 0.729e3 * t1667 * t1679 + 0.8e1 / 0.81e2 * t1667 * t1685 + 0.721e3 / 0.81e2 * t128 * t1690 * t133 - 0.116e3 / 0.243e3 * t1698 * t800 - 0.116e3 / 0.243e3 * t1698 * t806 + 0.4e1 / 0.243e3 * t1667 * t1669 * t47 * t1677 - 0.910e3 / 0.243e3 * t34 * t35 * t1499 * t48 - 0.1862e4 / 0.243e3 * t1713 * t338 - 0.931e3 / 0.243e3 * t1713 * t342 + t1757);
  t1763 = my_piecewise3(t1, 0, t1762);
  t1764 = t61 * t61;
  t1766 = 0.1e1 / t351 / t1764;
  t1767 = t353 * t353;
  t1773 = t359 * t359;
  t1778 = t58 * t1624;
  t1781 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t712 + 0.24e2 * t1778);
  t1785 = my_piecewise3(t62, 0, 0.40e2 / 0.81e2 * t1766 * t1767 - 0.16e2 / 0.9e1 * t831 * t353 * t359 + 0.4e1 / 0.3e1 * t352 * t1773 + 0.16e2 / 0.9e1 * t835 * t841 + 0.4e1 / 0.3e1 * t63 * t1781);
  t1792 = t5 * t845 * t101 * t83;
  t1796 = t5 * t363 * t291 * t83;
  t1800 = t5 * t148 * t743 * t83;
  t1805 = 0.10e2 / 0.27e2 * t5 * t65 * t1592 * t83;
  t1807 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1785 * t26 * t83 - t1792 / 0.2e1 + t1796 / 0.2e1 - 0.5e1 / 0.9e1 * t1800 + t1805);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[0] = 0.4e1 * t829 + 0.4e1 * t863 + t6 * (t1763 + t1807);

  t1814 = t5 * t883 * t101 * t52;
  t1818 = t5 * t388 * t291 * t52;
  t1819 = t1818 / 0.4e1;
  t1822 = t5 * t165 * t743 * t52;
  t1843 = 0.12e2 * t712;
  t1844 = 0.24e2 * t1625;
  t1846 = my_piecewise5(t10, 0, t14, 0, -t1843 + t1844);
  t1850 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1611 * t162 * t705 - 0.8e1 / 0.9e1 * t704 * t384 * t266 - 0.8e1 / 0.9e1 * t868 * t92 * t274 + 0.4e1 / 0.3e1 * t265 * t879 * t92 + 0.4e1 / 0.3e1 * t871 * t274 + 0.4e1 / 0.9e1 * t380 * t716 + 0.4e1 / 0.3e1 * t23 * t1846);
  t1859 = t5 * t888 * t137;
  t1865 = t5 * t895 * t137;
  t1866 = t1865 / 0.4e1;
  t1868 = t5 * t393 * t345;
  t1879 = -0.3e1 / 0.8e1 * t1814 + t1819 - 0.5e1 / 0.36e2 * t1822 + t1596 - t1599 / 0.8e1 + t1603 / 0.4e1 - 0.5e1 / 0.12e2 * t1607 - 0.3e1 / 0.8e1 * t5 * t1850 * t26 * t52 - 0.9e1 / 0.8e1 * t5 * t884 * t137 - 0.3e1 / 0.4e1 * t1859 - 0.9e1 / 0.8e1 * t5 * t389 * t345 + t1866 - 0.3e1 / 0.8e1 * t1868 - 0.3e1 / 0.8e1 * t5 * t166 * t824 - 0.3e1 / 0.8e1 * t1641 + t1647 / 0.2e1 - 0.3e1 / 0.8e1 * t1649 - 0.5e1 / 0.12e2 * t1655 + t1658 / 0.4e1 - t1661 / 0.8e1;
  t1880 = my_piecewise3(t1, 0, t1879);
  t1897 = 0.24e2 * t1778;
  t1899 = my_piecewise5(t14, 0, t10, 0, t1843 + t1897);
  t1903 = my_piecewise3(t62, 0, 0.40e2 / 0.81e2 * t1766 * t173 * t832 - 0.8e1 / 0.9e1 * t831 * t408 * t353 - 0.8e1 / 0.9e1 * t912 * t145 * t359 + 0.4e1 / 0.3e1 * t352 * t922 * t145 + 0.4e1 / 0.3e1 * t915 * t359 + 0.4e1 / 0.9e1 * t404 * t841 + 0.4e1 / 0.3e1 * t63 * t1899);
  t1910 = t5 * t926 * t101 * t83;
  t1914 = t5 * t412 * t291 * t83;
  t1915 = t1914 / 0.4e1;
  t1918 = t5 * t176 * t743 * t83;
  t1927 = t5 * t850 * t208;
  t1930 = t5 * t854 * t208;
  t1931 = t1930 / 0.4e1;
  t1933 = t5 * t858 * t208;
  t1935 = -0.3e1 / 0.8e1 * t5 * t1903 * t26 * t83 - 0.3e1 / 0.8e1 * t1910 + t1915 - 0.5e1 / 0.36e2 * t1918 - t1792 / 0.8e1 + t1796 / 0.4e1 - 0.5e1 / 0.12e2 * t1800 + t1805 - 0.3e1 / 0.8e1 * t5 * t846 * t208 - 0.3e1 / 0.8e1 * t1927 + t1931 - 0.5e1 / 0.36e2 * t1933;
  t1936 = my_piecewise3(t57, 0, t1935);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[1] = t829 + t863 + 0.3e1 * t911 + 0.3e1 * t951 + t6 * (t1880 + t1936);

  t1945 = t5 * t967 * t101 * t52;
  t1949 = t5 * t443 * t291 * t52;
  t1964 = t384 * t384;
  t1977 = my_piecewise5(t10, 0, t14, 0, t1844);
  t1981 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1611 * t434 * t266 - 0.32e2 / 0.27e2 * t868 * t92 * t384 - 0.8e1 / 0.27e2 * t954 * t274 + 0.8e1 / 0.9e1 * t265 * t1964 + 0.8e1 / 0.9e1 * t380 * t879 - 0.8e1 / 0.27e2 * t704 * t439 * t266 + 0.8e1 / 0.9e1 * t265 * t963 * t92 + 0.4e1 / 0.9e1 * t959 * t274 + 0.4e1 / 0.3e1 * t23 * t1977);
  t1990 = t5 * t972 * t137;
  t2001 = -t1945 / 0.4e1 + t1949 / 0.12e2 - t1814 / 0.4e1 + t1818 / 0.3e1 - 0.5e1 / 0.18e2 * t1822 + t1596 + t1603 / 0.12e2 - 0.5e1 / 0.18e2 * t1607 - 0.3e1 / 0.8e1 * t5 * t1981 * t26 * t52 - 0.3e1 / 0.4e1 * t5 * t968 * t137 - t1990 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t444 * t345 - t1859 / 0.2e1 + t1865 / 0.3e1 - t1868 / 0.4e1 + t1647 / 0.6e1 - 0.5e1 / 0.18e2 * t1655 + t1658 / 0.12e2;
  t2002 = my_piecewise3(t1, 0, t2001);
  t2011 = t408 * t408;
  t2024 = my_piecewise5(t14, 0, t10, 0, t1897);
  t2028 = my_piecewise3(t62, 0, 0.40e2 / 0.81e2 * t1766 * t451 * t353 - 0.32e2 / 0.27e2 * t912 * t145 * t408 - 0.8e1 / 0.27e2 * t984 * t359 + 0.8e1 / 0.9e1 * t352 * t2011 + 0.8e1 / 0.9e1 * t404 * t922 - 0.8e1 / 0.27e2 * t831 * t456 * t353 + 0.8e1 / 0.9e1 * t352 * t993 * t145 + 0.4e1 / 0.9e1 * t989 * t359 + 0.4e1 / 0.3e1 * t63 * t2024);
  t2035 = t5 * t997 * t101 * t83;
  t2039 = t5 * t460 * t291 * t83;
  t2048 = t5 * t931 * t208;
  t2051 = t5 * t935 * t208;
  t2062 = t5 * t368 * t513;
  t2065 = t5 * t372 * t513;
  t2067 = -0.3e1 / 0.8e1 * t5 * t2028 * t26 * t83 - t2035 / 0.4e1 + t2039 / 0.12e2 - t1910 / 0.4e1 + t1914 / 0.3e1 - 0.5e1 / 0.18e2 * t1918 - 0.3e1 / 0.4e1 * t5 * t927 * t208 - t2048 / 0.2e1 + t2051 / 0.6e1 + t1796 / 0.12e2 - 0.5e1 / 0.18e2 * t1800 + t1805 - t1927 / 0.4e1 + t1930 / 0.3e1 - 0.5e1 / 0.18e2 * t1933 - 0.3e1 / 0.8e1 * t5 * t364 * t513 - t2062 / 0.4e1 + t2065 / 0.12e2;
  t2068 = my_piecewise3(t57, 0, t2067);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[2] = 0.2e1 * t911 + 0.2e1 * t951 + 0.2e1 * t983 + 0.2e1 * t1022 + t6 * (t2002 + t2068);

  t2089 = my_piecewise5(t10, 0, t14, 0, t1843 + t1844);
  t2093 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1611 * t1027 * t92 - 0.8e1 / 0.9e1 * t954 * t384 - 0.8e1 / 0.9e1 * t868 * t439 * t92 + 0.4e1 / 0.3e1 * t871 * t439 + 0.4e1 / 0.3e1 * t380 * t963 + 0.4e1 / 0.9e1 * t265 * t1034 * t92 + 0.4e1 / 0.3e1 * t23 * t2089);
  t2100 = t5 * t1038 * t101 * t52;
  t2111 = -0.3e1 / 0.8e1 * t5 * t2093 * t26 * t52 - t2100 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1039 * t137 - 0.3e1 / 0.8e1 * t1945 + t1949 / 0.4e1 - 0.3e1 / 0.8e1 * t1990 + t1819 - 0.5e1 / 0.12e2 * t1822 + t1866 - 0.5e1 / 0.36e2 * t1607 + t1596 - 0.5e1 / 0.36e2 * t1655;
  t2112 = my_piecewise3(t1, 0, t2111);
  t2129 = my_piecewise5(t14, 0, t10, 0, -t1843 + t1897);
  t2133 = my_piecewise3(t62, 0, 0.40e2 / 0.81e2 * t1766 * t1047 * t145 - 0.8e1 / 0.9e1 * t984 * t408 - 0.8e1 / 0.9e1 * t912 * t456 * t145 + 0.4e1 / 0.3e1 * t915 * t456 + 0.4e1 / 0.3e1 * t404 * t993 + 0.4e1 / 0.9e1 * t352 * t1054 * t145 + 0.4e1 / 0.3e1 * t63 * t2129);
  t2140 = t5 * t1058 * t101 * t83;
  t2148 = t5 * t1002 * t208;
  t2157 = t5 * t417 * t513;
  t2167 = t5 * t153 * t1139;
  t2169 = -0.3e1 / 0.8e1 * t5 * t2133 * t26 * t83 - t2140 / 0.8e1 - 0.3e1 / 0.8e1 * t2035 + t2039 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t998 * t208 - 0.3e1 / 0.8e1 * t2148 + t1915 - 0.5e1 / 0.12e2 * t1918 - 0.3e1 / 0.4e1 * t2048 + t2051 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t413 * t513 - 0.3e1 / 0.8e1 * t2157 - 0.5e1 / 0.36e2 * t1800 + t1805 + t1931 - 0.5e1 / 0.12e2 * t1933 - 0.3e1 / 0.8e1 * t2062 + t2065 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t149 * t1139 - t2167 / 0.8e1;
  t2170 = my_piecewise3(t57, 0, t2169);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[3] = 0.3e1 * t983 + 0.3e1 * t1022 + t1046 + t1144 + t6 * (t2112 + t2170);

  t2175 = t434 * t434;
  t2180 = t439 * t439;
  t2187 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t712 + 0.24e2 * t1625);
  t2191 = my_piecewise3(t20, 0, 0.40e2 / 0.81e2 * t1611 * t2175 - 0.16e2 / 0.9e1 * t954 * t439 + 0.4e1 / 0.3e1 * t265 * t2180 + 0.16e2 / 0.9e1 * t380 * t1034 + 0.4e1 / 0.3e1 * t23 * t2187);
  t2200 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2191 * t26 * t52 - t2100 / 0.2e1 + t1949 / 0.2e1 - 0.5e1 / 0.9e1 * t1822 + t1596);
  t2201 = t451 * t451;
  t2206 = t456 * t456;
  t2213 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t712 + 0.24e2 * t1778);
  t2217 = my_piecewise3(t62, 0, 0.40e2 / 0.81e2 * t1766 * t2201 - 0.16e2 / 0.9e1 * t984 * t456 + 0.4e1 / 0.3e1 * t352 * t2206 + 0.16e2 / 0.9e1 * t404 * t1054 + 0.4e1 / 0.3e1 * t63 * t2213);
  t2232 = 0.1e1 / t189 / t489;
  t2237 = 0.1e1 / t1106;
  t2238 = t2237 * t492;
  t2245 = t1536 / t189 / t1106 / t181;
  t2246 = t317 * t2245;
  t2247 = t491 * t491;
  t2248 = 0.1e1 / t2247;
  t2250 = t2248 * t202 * t1678;
  t2254 = t2248 * t503 * t1684;
  t2258 = t2248 * t1128 * t1672;
  t2261 = t2232 * t75;
  t2265 = t1106 * rho[1];
  t2268 = t1105 / t68 / t2265;
  t2269 = t317 * t2268;
  t2275 = t317 * t487 * t2237;
  t2295 = t317 * t2245 * t75;
  t2297 = 0.1e1 / t1127 / t77;
  t2311 = t317 * t2268 * t75;
  t2318 = -0.116e3 / 0.729e3 * t2269 * t1114 + 0.4e1 / 0.243e3 * t2246 * t2248 * t78 * t1677 - 0.910e3 / 0.243e3 * t34 * t67 * t1552 * t79 + 0.931e3 / 0.243e3 * t488 * t2238 * t78 - 0.16e2 / 0.243e3 * t2295 * t2297 * t1731 * t2248 * t28 * t115 - 0.8e1 / 0.81e2 * t2295 * t2258 - 0.44e2 / 0.729e3 * t2295 * t2254 - 0.4e1 / 0.243e3 * t2295 * t2250 + 0.116e3 / 0.243e3 * t2311 * t1122 + 0.116e3 / 0.729e3 * t2311 * t1118 + 0.116e3 / 0.243e3 * t2311 * t1132;
  t2331 = -0.3e1 / 0.8e1 * t5 * t2217 * t26 * t83 - 0.3e1 / 0.2e1 * t5 * t1059 * t208 - 0.9e1 / 0.4e1 * t5 * t461 * t513 - 0.3e1 / 0.2e1 * t5 * t177 * t1139 - 0.3e1 / 0.8e1 * t5 * t66 * (-0.721e3 / 0.81e2 * t116 * sigma[2] * t2232 * t194 + 0.1862e4 / 0.243e3 * t488 * t2238 * t203 + 0.44e2 / 0.729e3 * t2246 * t2250 + 0.8e1 / 0.81e2 * t2246 * t2254 + 0.16e2 / 0.243e3 * t2246 * t2258 + 0.721e3 / 0.81e2 * t199 * t2261 * t204 - 0.116e3 / 0.243e3 * t2269 * t1118 - 0.116e3 / 0.243e3 * t2269 * t1122 - 0.1862e4 / 0.243e3 * t2275 * t506 - 0.931e3 / 0.243e3 * t2275 * t510 + t2318) - t2140 / 0.2e1 - 0.3e1 / 0.2e1 * t2148 - 0.3e1 / 0.2e1 * t2157 - t2167 / 0.2e1 + t2039 / 0.2e1 + t2051 + t2065 / 0.2e1 - 0.5e1 / 0.9e1 * t1918 - 0.5e1 / 0.9e1 * t1933 + t1805;
  t2332 = my_piecewise3(t57, 0, t2331);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho4[4] = 0.4e1 * t1046 + 0.4e1 * t1144 + t6 * (t2200 + t2332);

  t2340 = t5 * t725 * t234;
  t2346 = t5 * t732 * t234;
  t2349 = t5 * t283 * t560;
  t2356 = 0.5e1 / 0.36e2 * t5 * t744 * t234;
  t2358 = t5 * t292 * t560;
  t2361 = t5 * t102 * t1222;
  t2363 = t317 * t771;
  t2367 = 0.1e1 / t118 / t1694;
  t2369 = t317 * t2367 * t1669;
  t2379 = t318 * t28 * t115;
  t2384 = t317 * t788 * t792;
  t2402 = t317 * t771 * t44;
  t2416 = t2367 * t44;
  t2419 = t1731 * t1669;
  t2425 = t813 * t1669;
  t2431 = t336 * t1669;
  t2437 = params->c * t1669;
  t2441 = t788 * t44;
  t2454 = 0.317e3 / 0.324e3 * t2402 * t548 + 0.49e2 / 0.972e3 * t2384 * t1191 + 0.91e2 / 0.54e2 * t116 * t761 * t122 * t47 - 0.317e3 / 0.324e3 * t2363 * t543 + 0.2e1 / 0.81e2 * t317 * t2416 * t1730 * t2419 * t2379 + t317 * t2416 * t812 * t2425 * t2379 / 0.27e2 + 0.11e2 / 0.486e3 * t317 * t2416 * t334 * t2431 * t2379 + t317 * t2416 * t131 * t2437 * t2379 / 0.162e3 - 0.49e2 / 0.324e3 * t317 * t2441 * t334 * t1213 - 0.49e2 / 0.972e3 * t317 * t2441 * t131 * t1219 - 0.49e2 / 0.324e3 * t317 * t2441 * t812 * t1207;
  t2460 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t721 * t234 - 0.3e1 / 0.8e1 * t2340 - 0.9e1 / 0.8e1 * t5 * t279 * t560 + t2346 / 0.4e1 - 0.3e1 / 0.4e1 * t2349 - 0.9e1 / 0.8e1 * t5 * t96 * t1222 - t2356 + t2358 / 0.4e1 - 0.3e1 / 0.8e1 * t2361 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.317e3 / 0.162e3 * t2363 * t548 - 0.11e2 / 0.486e3 * t2369 * t131 * t318 * t1678 - t2369 * t334 * t318 * t1684 / 0.27e2 - 0.2e1 / 0.81e2 * t2369 * t814 * t2379 + 0.49e2 / 0.324e3 * t2384 * t1195 + 0.49e2 / 0.324e3 * t2384 * t1200 - t2369 * t47 * t318 * t1677 / 0.162e3 + 0.35e2 / 0.81e2 * t34 * t216 * t755 * t48 - 0.91e2 / 0.54e2 * t113 * t115 * t761 * t231 + 0.317e3 / 0.162e3 * t2402 * t555 + t2454));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = t6 * t2460 + 0.3e1 * t1227;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[1] = 0.0e0;

  t2467 = t5 * t850 * t257;
  t2470 = t5 * t854 * t257;
  t2474 = 0.5e1 / 0.36e2 * t5 * t858 * t257;
  t2476 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t846 * t257 - 0.3e1 / 0.8e1 * t2467 + t2470 / 0.4e1 - t2474);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[2] = t6 * t2476 + 0.3e1 * t1240;

  t2478 = 0.2e1 * t1254;
  t2484 = t5 * t888 * t234 / 0.4e1;
  t2489 = t5 * t895 * t234;
  t2493 = t5 * t393 * t560 / 0.4e1;
  t2502 = -0.3e1 / 0.8e1 * t5 * t884 * t234 - t2484 - 0.3e1 / 0.4e1 * t5 * t389 * t560 + t2489 / 0.12e2 - t2493 - 0.3e1 / 0.8e1 * t5 * t166 * t1222 - t2340 / 0.8e1 + t2346 / 0.6e1 - t2349 / 0.4e1 - t2356 + t2358 / 0.6e1 - t2361 / 0.8e1;
  t2503 = my_piecewise3(t1, 0, t2502);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[3] = t6 * t2503 + t1227 + t2478;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[4] = 0.0e0;

  t2505 = 0.2e1 * t1270;
  t2511 = t5 * t931 * t257 / 0.4e1;
  t2513 = t5 * t935 * t257;
  t2522 = t5 * t368 * t618 / 0.4e1;
  t2524 = t5 * t372 * t618;
  t2527 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t927 * t257 - t2511 + t2513 / 0.12e2 - t2467 / 0.8e1 + t2470 / 0.6e1 - t2474 - 0.3e1 / 0.8e1 * t5 * t364 * t618 - t2522 + t2524 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[5] = t6 * t2527 + t1240 + t2505;

  t2533 = t5 * t972 * t234;
  t2542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t968 * t234 - t2533 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t444 * t560 - t2484 + t2489 / 0.6e1 - t2493 + t2346 / 0.12e2 - t2356 + t2358 / 0.12e2);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[6] = t6 * t2542 + t1278 + t2478;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[7] = 0.0e0;

  t2548 = t5 * t1002 * t257;
  t2555 = t5 * t417 * t618;
  t2563 = t5 * t153 * t1348;
  t2565 = -0.3e1 / 0.8e1 * t5 * t998 * t257 - t2548 / 0.8e1 - t2511 + t2513 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t413 * t618 - t2555 / 0.4e1 + t2470 / 0.12e2 - t2474 - t2522 + t2524 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t149 * t1348 - t2563 / 0.8e1;
  t2566 = my_piecewise3(t57, 0, t2565);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[8] = t6 * t2566 + t1353 + t2505;

  t2575 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1039 * t234 - 0.3e1 / 0.8e1 * t2533 + t2489 / 0.4e1 - t2356);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[9] = t6 * t2575 + 0.3e1 * t1278;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[10] = 0.0e0;

  t2596 = t317 * t1091;
  t2602 = 0.1e1 / t189 / t2265;
  t2604 = t317 * t2602 * t2248;
  t2614 = t487 * t28 * t115;
  t2619 = t317 * t1108 * t1112;
  t2625 = t317 * t1091 * t75;
  t2645 = t2602 * t75;
  t2648 = t1731 * t2248;
  t2654 = t813 * t2248;
  t2660 = t336 * t2248;
  t2666 = params->c * t2248;
  t2670 = t1108 * t75;
  t2683 = 0.49e2 / 0.972e3 * t2619 * t1317 - t2604 * t78 * t487 * t1677 / 0.162e3 + 0.35e2 / 0.81e2 * t34 * t239 * t1075 * t79 - 0.91e2 / 0.54e2 * t113 * t115 * t1081 * t254 + 0.2e1 / 0.81e2 * t317 * t2645 * t2297 * t2648 * t2614 + t317 * t2645 * t1128 * t2654 * t2614 / 0.27e2 + 0.11e2 / 0.486e3 * t317 * t2645 * t503 * t2660 * t2614 + t317 * t2645 * t202 * t2666 * t2614 / 0.162e3 - 0.49e2 / 0.972e3 * t317 * t2670 * t202 * t1345 - 0.49e2 / 0.324e3 * t317 * t2670 * t1128 * t1333 - 0.49e2 / 0.324e3 * t317 * t2670 * t503 * t1339;
  t2689 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1059 * t257 - 0.3e1 / 0.8e1 * t2548 - 0.9e1 / 0.8e1 * t5 * t461 * t618 + t2513 / 0.4e1 - 0.3e1 / 0.4e1 * t2555 - 0.9e1 / 0.8e1 * t5 * t177 * t1348 - t2474 + t2524 / 0.4e1 - 0.3e1 / 0.8e1 * t2563 - 0.3e1 / 0.8e1 * t5 * t66 * (0.91e2 / 0.54e2 * t116 * t1081 * t193 * t78 - 0.317e3 / 0.324e3 * t2596 * t601 - 0.317e3 / 0.162e3 * t2596 * t606 - 0.11e2 / 0.486e3 * t2604 * t202 * t487 * t1678 - t2604 * t503 * t487 * t1684 / 0.27e2 - 0.2e1 / 0.81e2 * t2604 * t1129 * t2614 + 0.49e2 / 0.324e3 * t2619 * t1321 + 0.49e2 / 0.324e3 * t2619 * t1326 + 0.317e3 / 0.162e3 * t2625 * t613 + 0.317e3 / 0.324e3 * t2625 * t606 + t2683));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[11] = t6 * t2689 + 0.3e1 * t1353;

  t2696 = t5 * t283 * t658;
  t2703 = t5 * t292 * t658 / 0.12e2;
  t2705 = t5 * t102 * t1406;
  t2708 = 0.1e1 / t118 / t786;
  t2709 = t2708 * t44;
  t2712 = t1677 * t35;
  t2733 = t317 * t2708 * t1669;
  t2735 = t115 * params->c;
  t2746 = t317 * t1203;
  t2766 = t317 * t216 * t321;
  t2785 = 0.35e2 / 0.864e3 * t2746 * t806 + 0.35e2 / 0.2592e4 * t2746 * t800 + 0.7e1 / 0.216e3 * t636 * t313 + t2733 * t47 * t28 * t115 * t35 / 0.432e3 + 0.7e1 / 0.108e3 * t34 * t625 * t300 * t48 - 0.8e1 / 0.27e2 * t2766 * t338 - 0.4e1 / 0.27e2 * t2766 * t342 - 0.35e2 / 0.864e3 * t1189 * t1392 - 0.35e2 / 0.864e3 * t1189 * t1395 - t317 * t2709 * t1730 * t2419 * t2712 / 0.108e3 - t317 * t2709 * t812 * t2425 * t2712 / 0.72e2;
  t2791 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t658 - t2696 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t1406 + t2703 - t2705 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.11e2 / 0.1296e4 * t317 * t2709 * t334 * t2431 * t2712 - t317 * t2709 * t131 * t2437 * t2712 / 0.432e3 + 0.4e1 / 0.27e2 * t1371 * t325 + 0.8e1 / 0.27e2 * t1371 * t328 - 0.35e2 / 0.2592e4 * t317 * t1187 * t794 - 0.7e1 / 0.216e3 * t116 * t630 * t307 * t123 + 0.11e2 / 0.1296e4 * t2733 * t131 * t28 * t2735 * t35 + t2733 * t553 * t2712 / 0.72e2 + t2733 * t814 * t2712 / 0.108e3 + 0.35e2 / 0.864e3 * t2746 * t817 + t2785));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = t6 * t2791 + 0.2e1 * t1411;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[4] = 0.0e0;

  t2798 = t5 * t368 * t696;
  t2802 = t5 * t372 * t696 / 0.12e2;
  t2804 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t364 * t696 - t2798 / 0.4e1 + t2802);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[5] = t6 * t2804 + 0.2e1 * t1420;

  t2810 = t5 * t393 * t658;
  t2818 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t389 * t658 - t2810 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t1406 - t2696 / 0.8e1 + t2703 - t2705 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[6] = t6 * t2818 + t1411 + t1426;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[10] = 0.0e0;

  t2824 = t5 * t417 * t696;
  t2831 = t5 * t153 * t1476;
  t2834 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t413 * t696 - t2824 / 0.8e1 - t2798 / 0.8e1 + t2802 - 0.3e1 / 0.8e1 * t5 * t149 * t1476 - t2831 / 0.8e1);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[11] = t6 * t2834 + t1420 + t1481;

  t2842 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t444 * t658 - t2810 / 0.4e1 + t2703);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[12] = t6 * t2842 + 0.2e1 * t1426;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[16] = 0.0e0;

  t2853 = t317 * t1329;
  t2857 = 0.1e1 / t189 / t1106;
  t2859 = t317 * t2857 * t2248;
  t2865 = t1677 * t67;
  t2888 = t317 * t239 * t490;
  t2898 = t2857 * t75;
  t2930 = -0.4e1 / 0.27e2 * t2888 * t510 - 0.35e2 / 0.864e3 * t1315 * t1462 - 0.35e2 / 0.864e3 * t1315 * t1465 - t317 * t2898 * t202 * t2666 * t2865 / 0.432e3 - t317 * t2898 * t2297 * t2648 * t2865 / 0.108e3 - t317 * t2898 * t1128 * t2654 * t2865 / 0.72e2 - 0.11e2 / 0.1296e4 * t317 * t2898 * t503 * t2660 * t2865 + 0.4e1 / 0.27e2 * t1441 * t494 - 0.35e2 / 0.2592e4 * t317 * t1313 * t1114 - 0.7e1 / 0.216e3 * t116 * t668 * t478 * t194 + 0.8e1 / 0.27e2 * t1441 * t497;
  t2936 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t461 * t696 - t2824 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t1476 + t2802 - t2831 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t66 * (0.35e2 / 0.2592e4 * t2853 * t1118 + 0.11e2 / 0.1296e4 * t2859 * t202 * t28 * t2735 * t67 + t2859 * t611 * t2865 / 0.72e2 + t2859 * t1129 * t2865 / 0.108e3 + 0.7e1 / 0.216e3 * t674 * t484 + 0.35e2 / 0.864e3 * t2853 * t1132 + 0.35e2 / 0.864e3 * t2853 * t1122 + t2859 * t78 * t28 * t115 * t67 / 0.432e3 + 0.7e1 / 0.108e3 * t34 * t663 * t471 * t79 - 0.8e1 / 0.27e2 * t2888 * t506 + t2930));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[17] = t6 * t2936 + 0.2e1 * t1481;

  t2943 = t5 * t102 * t1531 / 0.8e1;
  t2947 = 0.1e1 / t118 / t770;
  t2949 = t317 * t2947 * t1669;
  t2959 = t216 * t28 * t115;
  t2966 = t317 * t625 * t540;
  t2979 = t2947 * t44;
  t3005 = t317 * t625;
  t3026 = t317 * t2979 * t812 * t2425 * t2959 / 0.192e3 + 0.11e2 / 0.3456e4 * t317 * t2979 * t334 * t2431 * t2959 + t317 * t2979 * t131 * t2437 * t2959 / 0.1152e4 + t1391 * t1507 / 0.144e3 + t1391 * t1512 / 0.144e3 + t3005 * t1373 / 0.96e2 - t116 * t1489 * t120 * t123 / 0.48e2 + t3005 * t1376 / 0.48e2 - t317 * t1398 * t334 * t1523 / 0.144e3 - t317 * t1398 * t131 * t1528 / 0.432e3 - t317 * t1398 * t812 * t1518 / 0.144e3;
  t3032 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t1531 - t2943 - 0.3e1 / 0.8e1 * t5 * t27 * (t1391 * t1503 / 0.432e3 - 0.11e2 / 0.3456e4 * t2949 * t131 * t216 * t1678 - t2949 * t334 * t216 * t1684 / 0.192e3 - t2949 * t814 * t2959 / 0.288e3 + t1495 * t134 / 0.48e2 - t2966 * t338 / 0.48e2 - t2966 * t342 / 0.96e2 - t2949 * t47 * t216 * t1677 / 0.1152e4 + t34 * t1484 * t108 * t48 / 0.24e2 + t317 * t2979 * t1730 * t2419 * t2959 / 0.288e3 + t3026));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = t6 * t3032 + t1535;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[8] = 0.0e0;

  t3039 = t5 * t153 * t1584 / 0.8e1;
  t3041 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t1584 - t3039);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[9] = t6 * t3041 + t1588;

  t3047 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t1531 - t2943);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[10] = t6 * t3047 + t1535;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[13] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[14] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[15] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[16] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[17] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[18] = 0.0e0;

  t3052 = t317 * t663;
  t3070 = 0.1e1 / t189 / t1090;
  t3072 = t317 * t3070 * t2248;
  t3082 = t239 * t28 * t115;
  t3094 = t317 * t663 * t598;
  t3103 = t3070 * t75;
  t3134 = -t3094 * t506 / 0.48e2 - t3094 * t510 / 0.96e2 - t3072 * t78 * t239 * t1677 / 0.1152e4 + t317 * t3103 * t202 * t2666 * t3082 / 0.1152e4 + t1461 * t1565 / 0.144e3 + t317 * t3103 * t2297 * t2648 * t3082 / 0.288e3 + t317 * t3103 * t1128 * t2654 * t3082 / 0.192e3 + 0.11e2 / 0.3456e4 * t317 * t3103 * t503 * t2660 * t3082 + t1461 * t1560 / 0.144e3 - t116 * t1542 * t191 * t194 / 0.48e2 + t3052 * t1446 / 0.48e2;
  t3140 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t1584 - t3039 - 0.3e1 / 0.8e1 * t5 * t66 * (t3052 * t1443 / 0.96e2 - t317 * t1468 * t202 * t1581 / 0.432e3 - t317 * t1468 * t1128 * t1571 / 0.144e3 - t317 * t1468 * t503 * t1576 / 0.144e3 + t1461 * t1556 / 0.432e3 - 0.11e2 / 0.3456e4 * t3072 * t202 * t239 * t1678 - t3072 * t503 * t239 * t1684 / 0.192e3 - t3072 * t1129 * t3082 / 0.288e3 + t1548 * t205 / 0.48e2 + t34 * t1537 * t183 * t79 / 0.24e2 + t3134));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[19] = t6 * t3140 + t1588;

  t3142 = t317 * t1484;
  t3143 = t641 * t323;
  t3148 = t1489 * t29 * t33;
  t3159 = t317 * t1689 * t1669;
  t3165 = t625 * t28 * t115;
  t3169 = t785 * sigma[0];
  t3170 = 0.1e1 / t3169;
  t3184 = t317 * t1484 * t641;
  t3234 = t3184 * t342 / 0.256e3 + t3159 * t47 * t625 * t1677 / 0.3072e4 + 0.5e1 / 0.64e2 * t34 / t35 / t3169 * t38 * t48 - t317 * t1690 * t131 * t2437 * t3165 / 0.3072e4 + t1501 * t553 * t3148 / 0.768e3 - t317 * t1690 * t1730 * t2419 * t3165 / 0.768e3 - t317 * t1690 * t812 * t2425 * t3165 / 0.512e3 - 0.11e2 / 0.9216e4 * t317 * t1690 * t334 * t2431 * t3165 + t1501 * t131 * t1489 * t799 / 0.768e3 - 0.5e1 / 0.128e3 * t116 * t3170 * t222 * t123 - t3142 * t3143 * t132 / 0.128e3;
  t3239 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-t3142 * t3143 * t47 / 0.256e3 - t1522 * t1212 * t3148 / 0.768e3 - t1527 * t1218 * t3148 / 0.2304e4 - t1517 * t1206 * t3148 / 0.768e3 + t3159 * t334 * t625 * t1684 / 0.512e3 + t3159 * t814 * t3165 / 0.768e3 + 0.5e1 / 0.128e3 * t113 * t115 * t3170 * t638 + t1501 * t47 * t1489 * t40 / 0.2304e4 + 0.11e2 / 0.9216e4 * t3159 * t131 * t625 * t1678 + t3184 * t338 / 0.128e3 + t3234));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = t6 * t3239;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[2] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[12] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t3240 = t317 * t1537;
  t3241 = t679 * t492;
  t3246 = t1542 * t29 * t33;
  t3261 = t317 * t2232 * t2248;
  t3271 = t663 * t28 * t115;
  t3275 = t1105 * sigma[2];
  t3276 = 0.1e1 / t3275;
  t3289 = t317 * t1537 * t679;
  t3332 = t3289 * t506 / 0.128e3 + t3289 * t510 / 0.256e3 + t3261 * t78 * t663 * t1677 / 0.3072e4 + t1554 * t611 * t3246 / 0.768e3 - t317 * t2261 * t2297 * t2648 * t3271 / 0.768e3 - t317 * t2261 * t1128 * t2654 * t3271 / 0.512e3 - 0.11e2 / 0.9216e4 * t317 * t2261 * t503 * t2660 * t3271 - t317 * t2261 * t202 * t2666 * t3271 / 0.3072e4 + t1554 * t202 * t1542 * t799 / 0.768e3 - 0.5e1 / 0.128e3 * t116 * t3276 * t245 * t194 - t3240 * t3241 * t203 / 0.128e3;
  t3337 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t66 * (-t3240 * t3241 * t78 / 0.256e3 - t1575 * t1338 * t3246 / 0.768e3 - t1580 * t1344 * t3246 / 0.2304e4 - t1570 * t1332 * t3246 / 0.768e3 + t1554 * t78 * t1542 * t40 / 0.2304e4 + 0.11e2 / 0.9216e4 * t3261 * t202 * t663 * t1678 + t3261 * t503 * t663 * t1684 / 0.512e3 + t3261 * t1129 * t3271 / 0.768e3 + 0.5e1 / 0.128e3 * t113 * t115 * t3276 * t676 + 0.5e1 / 0.64e2 * t34 / t67 / t3275 * t70 * t79 + t3332));
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[14] = t6 * t3337;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

