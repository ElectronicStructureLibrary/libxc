/*
  This file was generated automatically with ./scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/hyb_mgga_xc_gas22.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 1
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t4, t5, t6, t8, t9, t10, t11, t12;
  double t14, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t26, t27, t29, t31, t34, t35;
  double t36, t37, t38, t41, t44, t47, t59, t63;
  double t64, t65, t67, t69, t70, t72, t73, t76;
  double t79, t83, t85, t86, t87, t88, t89, t91;
  double t92, t94, t96, t97, t101, t102, t103, t104;
  double t105, t106, t108, t109, t111, t112, t113, t114;
  double t115, t116, t118, t119, t123, t124, t125, t128;
  double t130, t132, t133, t136, t138, t140, t141, t143;
  double t145, t147, t150, t151, t153, t155, t160, t162;
  double t167, t170, t171, t175, t180, t183, t184, t185;
  double t194, t196, t197, t198, t199, t200, t201, t204;
  double t207, t208, t209, t210, t211, t214, t215, t217;
  double t218, t219, t220, t221, t223, t224, t225, t226;
  double t227, t228, t229, t230, t233, t237, t238, tzk0;

  hyb_mgga_xc_gas22_params *params;

  assert(p->params != NULL);
  params = (hyb_mgga_xc_gas22_params * )(p->params);

  t4 = 0.1e1 <= p->zeta_threshold;
  t5 = rho[0] / 0.2e1 <= p->dens_threshold || t4;
  t6 = M_CBRT3;
  t8 = POW_1_3(0.1e1 / M_PI);
  t9 = t6 * t8;
  t10 = M_CBRT4;
  t11 = t10 * t10;
  t12 = M_CBRT2;
  t14 = t9 * t11 * t12;
  t15 = 0.2e1 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t19 = my_piecewise3(t15, t17, 0.2e1 * t12);
  t20 = POW_1_3(rho[0]);
  t21 = t19 * t20;
  t22 = POW_1_3(0.9e1);
  t23 = t22 * t22;
  t24 = t8 * t8;
  t26 = t23 * t24 * p->hyb_omega[0];
  t27 = 0.1e1 / t20;
  t29 = my_piecewise3(t15, t16, t12);
  t31 = t12 / t29;
  t34 = t26 * t6 * t27 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t44 = t41 * t38;
  t47 = t41 * t41;
  t59 = t47 * t47;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - 0.1e1 / t41 / 0.96e3 + 0.1e1 / t44 / 0.2688e5 - 0.1e1 / t47 / 0.82944e6 + 0.1e1 / t47 / t38 / 0.2838528e8 - 0.1e1 / t47 / t41 / 0.107347968e10 + 0.1e1 / t47 / t44 / 0.445906944e11 - 0.1e1 / t59 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t85 = params->c_x[1];
  t86 = t85 * sigma[0];
  t87 = t12 * t12;
  t88 = rho[0] * rho[0];
  t89 = t20 * t20;
  t91 = 0.1e1 / t89 / t88;
  t92 = t87 * t91;
  t94 = sigma[0] * t87 * t91;
  t96 = 0.1e1 + 0.4e-2 * t94;
  t97 = 0.1e1 / t96;
  t101 = params->c_x[2];
  t102 = M_CBRT6;
  t103 = t102 * t102;
  t104 = M_PI * M_PI;
  t105 = POW_1_3(t104);
  t106 = t105 * t105;
  t108 = 0.3e1 / 0.1e2 * t103 * t106;
  t109 = tau[0] * t87;
  t111 = 0.1e1 / t89 / rho[0];
  t112 = t109 * t111;
  t113 = t108 - t112;
  t114 = t101 * t113;
  t115 = t108 + t112;
  t116 = 0.1e1 / t115;
  t118 = params->c_x[0] + 0.4e-2 * t86 * t92 * t97 + t114 * t116;
  t119 = t83 * t118;
  t123 = my_piecewise3(t5, 0, -0.3e1 / 0.64e2 * t14 * t21 * t119);
  t124 = my_piecewise3(t4, p->zeta_threshold, 1);
  t125 = t9 * t11;
  t128 = my_piecewise3(t4, 0.1e1 / t16, 1);
  t130 = t125 * t27 * t12 * t128;
  t132 = 0.1e1 + 0.53425e-1 * t130;
  t133 = sqrt(t130);
  t136 = POW_3_2(t130);
  t138 = t6 * t6;
  t140 = t138 * t24 * t10;
  t141 = 0.1e1 / t89;
  t143 = t128 * t128;
  t145 = t140 * t141 * t87 * t143;
  t147 = 0.379785e1 * t133 + 0.8969e0 * t130 + 0.204775e0 * t136 + 0.123235e0 * t145;
  t150 = 0.1e1 + 0.16081979498692535067e2 / t147;
  t151 = log(t150);
  t153 = 0.621814e-1 * t132 * t151;
  t155 = my_piecewise3(0.e0 <= p->zeta_threshold, t17, 0);
  t160 = (t19 + t155 - 0.2e1) / (0.2e1 * t12 - 0.2e1);
  t162 = 0.1e1 + 0.5137e-1 * t130;
  t167 = 0.705945e1 * t133 + 0.1549425e1 * t130 + 0.420775e0 * t136 + 0.1562925e0 * t145;
  t170 = 0.1e1 + 0.32163958997385070134e2 / t167;
  t171 = log(t170);
  t175 = 0.1e1 + 0.278125e-1 * t130;
  t180 = 0.51785e1 * t133 + 0.905775e0 * t130 + 0.1100325e0 * t136 + 0.1241775e0 * t145;
  t183 = 0.1e1 + 0.29608749977793437516e2 / t180;
  t184 = log(t183);
  t185 = t175 * t184;
  t194 = my_piecewise3(t5, 0, t124 * (-t153 + t160 * (-0.310907e-1 * t162 * t171 + t153 - 0.19751673498613801407e-1 * t185) + 0.19751673498613801407e-1 * t160 * t185) / 0.2e1);
  t196 = params->c_ss[1];
  t197 = sigma[0] * sigma[0];
  t198 = t197 * t197;
  t199 = t196 * t198;
  t200 = t88 * t88;
  t201 = t200 * t200;
  t204 = 0.1e1 / t89 / t201 / t88;
  t207 = 0.1e1 + 0.2e0 * t94;
  t208 = t207 * t207;
  t209 = t208 * t208;
  t210 = 0.1e1 / t209;
  t211 = t87 * t204 * t210;
  t214 = params->c_ss[2];
  t215 = t214 * t113;
  t217 = params->c_ss[3];
  t218 = t113 * t113;
  t219 = t217 * t218;
  t220 = t115 * t115;
  t221 = 0.1e1 / t220;
  t223 = params->c_ss[4];
  t224 = t218 * t218;
  t225 = t223 * t224;
  t226 = t220 * t220;
  t227 = 0.1e1 / t226;
  t228 = t225 * t227;
  t229 = t197 * sigma[0];
  t230 = 0.1e1 / t201;
  t233 = 0.1e1 / t208 / t207;
  t237 = params->c_ss[0] + 0.64e-2 * t199 * t211 + t215 * t116 + t219 * t221 + 0.32e-1 * t228 * t229 * t230 * t233;
  t238 = t194 * t237;
  tzk0 = 0.2e1 * t123 + 0.2e1 * t238;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t4, t5, t6, t8, t9, t10, t11, t12;
  double t14, t15, t16, t17, t19, t20, t21, t22;
  double t23, t24, t26, t27, t29, t31, t34, t35;
  double t36, t37, t38, t41, t44, t47, t59, t63;
  double t64, t65, t67, t69, t70, t72, t73, t76;
  double t79, t83, t85, t86, t87, t88, t89, t91;
  double t92, t94, t96, t97, t101, t102, t103, t104;
  double t105, t106, t108, t109, t111, t112, t113, t114;
  double t115, t116, t118, t119, t123, t124, t125, t128;
  double t130, t132, t133, t136, t138, t140, t141, t143;
  double t145, t147, t150, t151, t153, t155, t160, t162;
  double t167, t170, t171, t175, t180, t183, t184, t185;
  double t194, t196, t197, t198, t199, t200, t201, t204;
  double t207, t208, t209, t210, t211, t214, t215, t217;
  double t218, t219, t220, t221, t223, t224, t225, t226;
  double t227, t228, t229, t230, t233, t237, t238, tzk0;

  double t246, t249, t253, t254, t257, t261, t286, t309;
  double t314, t322, t326, t327, t332, t336, t345, t346;
  double t350, t351, t357, t358, t359, t360, t363, t365;
  double t368, t372, t378, t383, t399, t400, t406, t407;
  double t426, t430, t442, t452, t457, t462, t466, t470;
  double t475, t482, tvrho0, t495, t507, tvsigma0, tvlapl0, t531;
  double t534, t541, t556, tvtau0;

  hyb_mgga_xc_gas22_params *params;

  assert(p->params != NULL);
  params = (hyb_mgga_xc_gas22_params * )(p->params);

  t4 = 0.1e1 <= p->zeta_threshold;
  t5 = rho[0] / 0.2e1 <= p->dens_threshold || t4;
  t6 = M_CBRT3;
  t8 = POW_1_3(0.1e1 / M_PI);
  t9 = t6 * t8;
  t10 = M_CBRT4;
  t11 = t10 * t10;
  t12 = M_CBRT2;
  t14 = t9 * t11 * t12;
  t15 = 0.2e1 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t19 = my_piecewise3(t15, t17, 0.2e1 * t12);
  t20 = POW_1_3(rho[0]);
  t21 = t19 * t20;
  t22 = POW_1_3(0.9e1);
  t23 = t22 * t22;
  t24 = t8 * t8;
  t26 = t23 * t24 * p->hyb_omega[0];
  t27 = 0.1e1 / t20;
  t29 = my_piecewise3(t15, t16, t12);
  t31 = t12 / t29;
  t34 = t26 * t6 * t27 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t44 = t41 * t38;
  t47 = t41 * t41;
  t59 = t47 * t47;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - 0.1e1 / t41 / 0.96e3 + 0.1e1 / t44 / 0.2688e5 - 0.1e1 / t47 / 0.82944e6 + 0.1e1 / t47 / t38 / 0.2838528e8 - 0.1e1 / t47 / t41 / 0.107347968e10 + 0.1e1 / t47 / t44 / 0.445906944e11 - 0.1e1 / t59 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t85 = params->c_x[1];
  t86 = t85 * sigma[0];
  t87 = t12 * t12;
  t88 = rho[0] * rho[0];
  t89 = t20 * t20;
  t91 = 0.1e1 / t89 / t88;
  t92 = t87 * t91;
  t94 = sigma[0] * t87 * t91;
  t96 = 0.1e1 + 0.4e-2 * t94;
  t97 = 0.1e1 / t96;
  t101 = params->c_x[2];
  t102 = M_CBRT6;
  t103 = t102 * t102;
  t104 = M_PI * M_PI;
  t105 = POW_1_3(t104);
  t106 = t105 * t105;
  t108 = 0.3e1 / 0.1e2 * t103 * t106;
  t109 = tau[0] * t87;
  t111 = 0.1e1 / t89 / rho[0];
  t112 = t109 * t111;
  t113 = t108 - t112;
  t114 = t101 * t113;
  t115 = t108 + t112;
  t116 = 0.1e1 / t115;
  t118 = params->c_x[0] + 0.4e-2 * t86 * t92 * t97 + t114 * t116;
  t119 = t83 * t118;
  t123 = my_piecewise3(t5, 0, -0.3e1 / 0.64e2 * t14 * t21 * t119);
  t124 = my_piecewise3(t4, p->zeta_threshold, 1);
  t125 = t9 * t11;
  t128 = my_piecewise3(t4, 0.1e1 / t16, 1);
  t130 = t125 * t27 * t12 * t128;
  t132 = 0.1e1 + 0.53425e-1 * t130;
  t133 = sqrt(t130);
  t136 = POW_3_2(t130);
  t138 = t6 * t6;
  t140 = t138 * t24 * t10;
  t141 = 0.1e1 / t89;
  t143 = t128 * t128;
  t145 = t140 * t141 * t87 * t143;
  t147 = 0.379785e1 * t133 + 0.8969e0 * t130 + 0.204775e0 * t136 + 0.123235e0 * t145;
  t150 = 0.1e1 + 0.16081979498692535067e2 / t147;
  t151 = log(t150);
  t153 = 0.621814e-1 * t132 * t151;
  t155 = my_piecewise3(0.e0 <= p->zeta_threshold, t17, 0);
  t160 = (t19 + t155 - 0.2e1) / (0.2e1 * t12 - 0.2e1);
  t162 = 0.1e1 + 0.5137e-1 * t130;
  t167 = 0.705945e1 * t133 + 0.1549425e1 * t130 + 0.420775e0 * t136 + 0.1562925e0 * t145;
  t170 = 0.1e1 + 0.32163958997385070134e2 / t167;
  t171 = log(t170);
  t175 = 0.1e1 + 0.278125e-1 * t130;
  t180 = 0.51785e1 * t133 + 0.905775e0 * t130 + 0.1100325e0 * t136 + 0.1241775e0 * t145;
  t183 = 0.1e1 + 0.29608749977793437516e2 / t180;
  t184 = log(t183);
  t185 = t175 * t184;
  t194 = my_piecewise3(t5, 0, t124 * (-t153 + t160 * (-0.310907e-1 * t162 * t171 + t153 - 0.19751673498613801407e-1 * t185) + 0.19751673498613801407e-1 * t160 * t185) / 0.2e1);
  t196 = params->c_ss[1];
  t197 = sigma[0] * sigma[0];
  t198 = t197 * t197;
  t199 = t196 * t198;
  t200 = t88 * t88;
  t201 = t200 * t200;
  t204 = 0.1e1 / t89 / t201 / t88;
  t207 = 0.1e1 + 0.2e0 * t94;
  t208 = t207 * t207;
  t209 = t208 * t208;
  t210 = 0.1e1 / t209;
  t211 = t87 * t204 * t210;
  t214 = params->c_ss[2];
  t215 = t214 * t113;
  t217 = params->c_ss[3];
  t218 = t113 * t113;
  t219 = t217 * t218;
  t220 = t115 * t115;
  t221 = 0.1e1 / t220;
  t223 = params->c_ss[4];
  t224 = t218 * t218;
  t225 = t223 * t224;
  t226 = t220 * t220;
  t227 = 0.1e1 / t226;
  t228 = t225 * t227;
  t229 = t197 * sigma[0];
  t230 = 0.1e1 / t201;
  t233 = 0.1e1 / t208 / t207;
  t237 = params->c_ss[0] + 0.64e-2 * t199 * t211 + t215 * t116 + t219 * t221 + 0.32e-1 * t228 * t229 * t230 * t233;
  t238 = t194 * t237;
  tzk0 = 0.2e1 * t123 + 0.2e1 * t238;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t246 = t38 * t37;
  t249 = 0.1e1 / t20 / rho[0];
  t253 = t26 * t6 * t249 * t31 / 0.54e2;
  t254 = my_piecewise3(t36, -t253, 0);
  t257 = t41 * t37;
  t261 = t41 * t246;
  t286 = my_piecewise3(t36, 0, -t253);
  t309 = my_piecewise3(t35, -0.1e1 / t246 * t254 / 0.18e2 + 0.1e1 / t257 * t254 / 0.24e3 - 0.1e1 / t261 * t254 / 0.448e4 + 0.1e1 / t47 / t37 * t254 / 0.10368e6 - 0.1e1 / t47 / t246 * t254 / 0.2838528e7 + 0.1e1 / t47 / t257 * t254 / 0.8945664e8 - 0.1e1 / t47 / t261 * t254 / 0.31850496e10 + 0.1e1 / t59 / t37 * t254 / 0.1263403008e12, -0.8e1 / 0.3e1 * t286 * t79 - 0.8e1 / 0.3e1 * t63 * (-t72 * t70 * t286 + 0.2e1 * t286 * t76 + 0.2e1 * t63 * (0.1e1 / t69 / t63 * t286 * t72 / 0.2e1 - 0.4e1 * t63 * t73 * t286 - t65 * t286 * t72)));
  t314 = t88 * rho[0];
  t322 = t200 * t88;
  t326 = t96 * t96;
  t327 = 0.1e1 / t326;
  t332 = t92 * t116;
  t336 = t109 * t91;
  t345 = my_piecewise3(t5, 0, -t14 * t19 * t141 * t119 / 0.64e2 - 0.3e1 / 0.64e2 * t14 * t21 * t309 * t118 - 0.3e1 / 0.64e2 * t14 * t21 * t83 * (-0.10666666666666666667e-1 * t86 * t87 / t89 / t314 * t97 + 0.85333333333333333336e-4 * t85 * t197 * t12 / t20 / t322 * t327 + 0.5e1 / 0.3e1 * t101 * tau[0] * t332 + 0.5e1 / 0.3e1 * t114 * t221 * t336));
  t346 = t249 * t12;
  t350 = 0.11073470983333333333e-2 * t125 * t346 * t128 * t151;
  t351 = t147 * t147;
  t357 = t11 * t249;
  t358 = t12 * t128;
  t359 = t357 * t358;
  t360 = 0.1e1 / t133 * t6 * t8 * t359;
  t363 = t125 * t346 * t128;
  t365 = sqrt(t130);
  t368 = t365 * t6 * t8 * t359;
  t372 = t140 * t111 * t87 * t143;
  t378 = 0.1e1 * t132 / t351 * (-0.632975e0 * t360 - 0.29896666666666666667e0 * t363 - 0.1023875e0 * t368 - 0.82156666666666666667e-1 * t372) / t150;
  t383 = t167 * t167;
  t399 = t180 * t180;
  t400 = 0.1e1 / t399;
  t406 = -0.86308333333333333334e0 * t360 - 0.301925e0 * t363 - 0.5501625e-1 * t368 - 0.82785e-1 * t372;
  t407 = 0.1e1 / t183;
  t426 = my_piecewise3(t5, 0, t124 * (t350 + t378 + t160 * (0.53237641966666666666e-3 * t125 * t346 * t128 * t171 + 0.1e1 * t162 / t383 * (-0.1176575e1 * t360 - 0.516475e0 * t363 - 0.2103875e0 * t368 - 0.104195e0 * t372) / t170 - t350 - t378 + 0.18311447306006545054e-3 * t125 * t346 * t128 * t184 + 0.5848223622634646207e0 * t175 * t400 * t406 * t407) - 0.18311447306006545054e-3 * t160 * t9 * t357 * t358 * t184 - 0.5848223622634646207e0 * t160 * t175 * t400 * t406 * t407) / 0.2e1);
  t430 = 0.1e1 / t89 / t201 / t314;
  t442 = 0.1e1 / t209 / t207;
  t452 = t217 * t113;
  t457 = 0.1e1 / t220 / t115;
  t462 = t223 * t218 * t113;
  t466 = t204 * t233 * t109;
  t470 = 0.1e1 / t226 / t115;
  t475 = t201 * rho[0];
  t482 = t210 * t87;
  tvrho0 = 0.2e1 * t123 + 0.2e1 * t238 + rho[0] * (0.2e1 * t345 + 0.2e1 * t426 * t237 + 0.2e1 * t194 * (-0.68266666666666666667e-1 * t199 * t87 * t430 * t210 + 0.27306666666666666668e-1 * t196 * t198 * sigma[0] * t12 / t20 / t201 / t322 * t442 + 0.5e1 / 0.3e1 * t214 * tau[0] * t332 + 0.5e1 / 0.3e1 * t215 * t221 * t336 + 0.1e2 / 0.3e1 * t452 * t221 * t336 + 0.1e2 / 0.3e1 * t219 * t457 * t336 + 0.21333333333333333333e0 * t462 * t227 * t229 * t466 + 0.21333333333333333333e0 * t225 * t470 * t229 * t466 - 0.256e0 * t228 * t229 / t475 * t233 + 0.512e-1 * t228 * t198 * t430 * t482));

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t495 = t200 * rho[0];
  t507 = my_piecewise3(t5, 0, -0.3e1 / 0.64e2 * t14 * t21 * t83 * (0.4e-2 * t85 * t87 * t91 * t97 - 0.32e-4 * t86 * t12 / t20 / t495 * t327));
  tvsigma0 = rho[0] * (0.2e1 * t507 + 0.2e1 * t194 * (0.256e-1 * t196 * t229 * t211 - 0.1024e-1 * t199 * t12 / t20 / t201 / t495 * t442 + 0.96e-1 * t228 * t197 * t230 * t233 - 0.192e-1 * t228 * t229 * t204 * t482));

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t531 = t111 * t116;
  t534 = t221 * t87 * t111;
  t541 = my_piecewise3(t5, 0, -0.3e1 / 0.64e2 * t14 * t21 * t83 * (-t101 * t87 * t531 - t114 * t534));
  t556 = t229 / t89 / t475 * t233 * t87;
  tvtau0 = rho[0] * (0.2e1 * t541 + 0.2e1 * t194 * (-t214 * t87 * t531 - t215 * t534 - 0.2e1 * t452 * t534 - 0.2e1 * t219 * t457 * t87 * t111 - 0.128e0 * t462 * t227 * t556 - 0.128e0 * t225 * t470 * t556));

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t10;
  double t13, t14, t15, t17, t18, t19, t20, t21;
  double t22, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t43, t44, t45, t46, t47, t50;
  double t53, t56, t68, t72, t73, t74, t76, t78;
  double t79, t81, t82, t85, t88, t92, t93, t94;
  double t95, t96, t97, t98, t99, t101, t102, t104;
  double t105, t109, t110, t111, t112, t113, t114, t116;
  double t118, t119, t120, t121, t122, t123, t125, t126;
  double t127, t130, t132, t133, t134, t136, t137, t138;
  double t139, t140, t143, t144, t145, t146, t147, t150;
  double t153, t156, t168, t172, t173, t175, t177, t178;
  double t180, t181, t184, t187, t191, t192, t193, t194;
  double t195, t196, t198, t199, t201, t202, t207, t208;
  double t209, t210, t211, t212, t214, t215, t216, t219;
  double t220, t222, t223, t224, t226, t228, t230, t231;
  double t234, t236, t238, t239, t240, t241, t242, t243;
  double t245, t247, t250, t251, t253, t255, t260, t262;
  double t267, t270, t271, t275, t280, t283, t284, t285;
  double t291, t294, t295, t296, t297, t298, t299, t300;
  double t301, t304, t306, t307, t308, t309, t310, t313;
  double t314, t316, t317, t318, t319, t320, t322, t323;
  double t324, t325, t326, t327, t328, t329, t332, t336;
  double t337, t338, t339, t341, t343, t345, t346, t349;
  double t351, t353, t355, t358, t359, t361, t363, t368;
  double t371, t372, t376, t381, t384, t385, t386, t392;
  double t395, t396, t397, t398, t399, t400, t403, t405;
  double t406, t407, t408, t409, t412, t414, t415, t416;
  double t417, t419, t420, t421, t422, t423, t424, t425;
  double t428, t432, t433, tzk0;

  hyb_mgga_xc_gas22_params *params;

  assert(p->params != NULL);
  params = (hyb_mgga_xc_gas22_params * )(p->params);

  t3 = rho[0] - rho[1];
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 + t6;
  t8 = t7 <= p->zeta_threshold;
  t9 = rho[0] <= p->dens_threshold || t8;
  t10 = M_CBRT3;
  t13 = POW_1_3(0.1e1 / M_PI);
  t14 = M_CBRT4;
  t15 = t14 * t14;
  t17 = M_CBRT2;
  t18 = t13 * t15 * t17;
  t19 = t7 * t10 * t18;
  t20 = 0.2e1 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t24 = my_piecewise3(t20, t22, 0.2e1 * t17);
  t25 = POW_1_3(t4);
  t26 = t24 * t25;
  t27 = 0.1e1 / t7;
  t28 = POW_1_3(t27);
  t29 = 0.1e1 / t28;
  t30 = POW_1_3(0.9e1);
  t31 = t30 * t30;
  t32 = t13 * t13;
  t33 = t31 * t32;
  t34 = p->hyb_omega[0] * t10;
  t35 = t33 * t34;
  t36 = 0.1e1 / t25;
  t37 = t36 * t17;
  t38 = my_piecewise3(t20, t21, t17);
  t39 = 0.1e1 / t38;
  t40 = t28 * t39;
  t43 = t35 * t37 * t40 / 0.18e2;
  t44 = 0.135e1 <= t43;
  t45 = 0.135e1 < t43;
  t46 = my_piecewise3(t45, t43, 0.135e1);
  t47 = t46 * t46;
  t50 = t47 * t47;
  t53 = t50 * t47;
  t56 = t50 * t50;
  t68 = t56 * t56;
  t72 = my_piecewise3(t45, 0.135e1, t43);
  t73 = sqrt(M_PI);
  t74 = 0.1e1 / t72;
  t76 = erf(t74 / 0.2e1);
  t78 = t72 * t72;
  t79 = 0.1e1 / t78;
  t81 = exp(-t79 / 0.4e1);
  t82 = t81 - 0.1e1;
  t85 = t81 - 0.3e1 / 0.2e1 - 0.2e1 * t78 * t82;
  t88 = 0.2e1 * t72 * t85 + t73 * t76;
  t92 = my_piecewise3(t44, 0.1e1 / t47 / 0.36e2 - 0.1e1 / t50 / 0.96e3 + 0.1e1 / t53 / 0.2688e5 - 0.1e1 / t56 / 0.82944e6 + 0.1e1 / t56 / t47 / 0.2838528e8 - 0.1e1 / t56 / t50 / 0.107347968e10 + 0.1e1 / t56 / t53 / 0.445906944e11 - 0.1e1 / t68 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t72 * t88);
  t93 = t29 * t92;
  t94 = params->c_x[0];
  t95 = params->c_x[1];
  t96 = t95 * sigma[0];
  t97 = rho[0] * rho[0];
  t98 = POW_1_3(rho[0]);
  t99 = t98 * t98;
  t101 = 0.1e1 / t99 / t97;
  t102 = sigma[0] * t101;
  t104 = 0.1e1 + 0.4e-2 * t102;
  t105 = 0.1e1 / t104;
  t109 = params->c_x[2];
  t110 = M_CBRT6;
  t111 = t110 * t110;
  t112 = M_PI * M_PI;
  t113 = POW_1_3(t112);
  t114 = t113 * t113;
  t116 = 0.3e1 / 0.1e2 * t111 * t114;
  t118 = 0.1e1 / t99 / rho[0];
  t119 = tau[0] * t118;
  t120 = t116 - t119;
  t121 = t109 * t120;
  t122 = t116 + t119;
  t123 = 0.1e1 / t122;
  t125 = t94 + 0.4e-2 * t96 * t101 * t105 + t121 * t123;
  t126 = t93 * t125;
  t127 = t26 * t126;
  t130 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t19 * t127);
  t132 = 0.1e1 - t6;
  t133 = t132 <= p->zeta_threshold;
  t134 = rho[1] <= p->dens_threshold || t133;
  t136 = t132 * t10 * t18;
  t137 = 0.1e1 / t132;
  t138 = POW_1_3(t137);
  t139 = 0.1e1 / t138;
  t140 = t138 * t39;
  t143 = t35 * t37 * t140 / 0.18e2;
  t144 = 0.135e1 <= t143;
  t145 = 0.135e1 < t143;
  t146 = my_piecewise3(t145, t143, 0.135e1);
  t147 = t146 * t146;
  t150 = t147 * t147;
  t153 = t150 * t147;
  t156 = t150 * t150;
  t168 = t156 * t156;
  t172 = my_piecewise3(t145, 0.135e1, t143);
  t173 = 0.1e1 / t172;
  t175 = erf(t173 / 0.2e1);
  t177 = t172 * t172;
  t178 = 0.1e1 / t177;
  t180 = exp(-t178 / 0.4e1);
  t181 = t180 - 0.1e1;
  t184 = t180 - 0.3e1 / 0.2e1 - 0.2e1 * t177 * t181;
  t187 = 0.2e1 * t172 * t184 + t73 * t175;
  t191 = my_piecewise3(t144, 0.1e1 / t147 / 0.36e2 - 0.1e1 / t150 / 0.96e3 + 0.1e1 / t153 / 0.2688e5 - 0.1e1 / t156 / 0.82944e6 + 0.1e1 / t156 / t147 / 0.2838528e8 - 0.1e1 / t156 / t150 / 0.107347968e10 + 0.1e1 / t156 / t153 / 0.445906944e11 - 0.1e1 / t168 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t172 * t187);
  t192 = t139 * t191;
  t193 = t95 * sigma[2];
  t194 = rho[1] * rho[1];
  t195 = POW_1_3(rho[1]);
  t196 = t195 * t195;
  t198 = 0.1e1 / t196 / t194;
  t199 = sigma[2] * t198;
  t201 = 0.1e1 + 0.4e-2 * t199;
  t202 = 0.1e1 / t201;
  t207 = 0.1e1 / t196 / rho[1];
  t208 = tau[1] * t207;
  t209 = t116 - t208;
  t210 = t109 * t209;
  t211 = t116 + t208;
  t212 = 0.1e1 / t211;
  t214 = t94 + 0.4e-2 * t193 * t198 * t202 + t210 * t212;
  t215 = t192 * t214;
  t216 = t26 * t215;
  t219 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t136 * t216);
  t220 = my_piecewise3(t8, p->zeta_threshold, t7);
  t222 = t10 * t13 * t15;
  t223 = 0.1e1 / t21;
  t224 = POW_1_3(t7);
  t226 = my_piecewise3(t8, t223, 0.1e1 / t224);
  t228 = t222 * t37 * t226;
  t230 = 0.1e1 + 0.53425e-1 * t228;
  t231 = sqrt(t228);
  t234 = POW_3_2(t228);
  t236 = t10 * t10;
  t238 = t236 * t32 * t14;
  t239 = t25 * t25;
  t240 = 0.1e1 / t239;
  t241 = t17 * t17;
  t242 = t240 * t241;
  t243 = t226 * t226;
  t245 = t238 * t242 * t243;
  t247 = 0.379785e1 * t231 + 0.8969e0 * t228 + 0.204775e0 * t234 + 0.123235e0 * t245;
  t250 = 0.1e1 + 0.16081979498692535067e2 / t247;
  t251 = log(t250);
  t253 = 0.621814e-1 * t230 * t251;
  t255 = my_piecewise3(0.e0 <= p->zeta_threshold, t22, 0);
  t260 = (t24 + t255 - 0.2e1) / (0.2e1 * t17 - 0.2e1);
  t262 = 0.1e1 + 0.5137e-1 * t228;
  t267 = 0.705945e1 * t231 + 0.1549425e1 * t228 + 0.420775e0 * t234 + 0.1562925e0 * t245;
  t270 = 0.1e1 + 0.32163958997385070134e2 / t267;
  t271 = log(t270);
  t275 = 0.1e1 + 0.278125e-1 * t228;
  t280 = 0.51785e1 * t231 + 0.905775e0 * t228 + 0.1100325e0 * t234 + 0.1241775e0 * t245;
  t283 = 0.1e1 + 0.29608749977793437516e2 / t280;
  t284 = log(t283);
  t285 = t275 * t284;
  t291 = -t253 + t260 * (-0.310907e-1 * t262 * t271 + t253 - 0.19751673498613801407e-1 * t285) + 0.19751673498613801407e-1 * t260 * t285;
  t294 = my_piecewise3(t9, 0, t220 * t291 / 0.2e1);
  t295 = params->c_ss[0];
  t296 = params->c_ss[1];
  t297 = sigma[0] * sigma[0];
  t298 = t297 * t297;
  t299 = t296 * t298;
  t300 = t97 * t97;
  t301 = t300 * t300;
  t304 = 0.1e1 / t99 / t301 / t97;
  t306 = 0.1e1 + 0.2e0 * t102;
  t307 = t306 * t306;
  t308 = t307 * t307;
  t309 = 0.1e1 / t308;
  t310 = t304 * t309;
  t313 = params->c_ss[2];
  t314 = t313 * t120;
  t316 = params->c_ss[3];
  t317 = t120 * t120;
  t318 = t316 * t317;
  t319 = t122 * t122;
  t320 = 0.1e1 / t319;
  t322 = params->c_ss[4];
  t323 = t317 * t317;
  t324 = t322 * t323;
  t325 = t319 * t319;
  t326 = 0.1e1 / t325;
  t327 = t324 * t326;
  t328 = t297 * sigma[0];
  t329 = 0.1e1 / t301;
  t332 = 0.1e1 / t307 / t306;
  t336 = t295 + 0.16e-2 * t299 * t310 + t314 * t123 + t318 * t320 + 0.8e-2 * t327 * t328 * t329 * t332;
  t337 = t294 * t336;
  t338 = my_piecewise3(t133, p->zeta_threshold, t132);
  t339 = POW_1_3(t132);
  t341 = my_piecewise3(t133, t223, 0.1e1 / t339);
  t343 = t222 * t37 * t341;
  t345 = 0.1e1 + 0.53425e-1 * t343;
  t346 = sqrt(t343);
  t349 = POW_3_2(t343);
  t351 = t341 * t341;
  t353 = t238 * t242 * t351;
  t355 = 0.379785e1 * t346 + 0.8969e0 * t343 + 0.204775e0 * t349 + 0.123235e0 * t353;
  t358 = 0.1e1 + 0.16081979498692535067e2 / t355;
  t359 = log(t358);
  t361 = 0.621814e-1 * t345 * t359;
  t363 = 0.1e1 + 0.5137e-1 * t343;
  t368 = 0.705945e1 * t346 + 0.1549425e1 * t343 + 0.420775e0 * t349 + 0.1562925e0 * t353;
  t371 = 0.1e1 + 0.32163958997385070134e2 / t368;
  t372 = log(t371);
  t376 = 0.1e1 + 0.278125e-1 * t343;
  t381 = 0.51785e1 * t346 + 0.905775e0 * t343 + 0.1100325e0 * t349 + 0.1241775e0 * t353;
  t384 = 0.1e1 + 0.29608749977793437516e2 / t381;
  t385 = log(t384);
  t386 = t376 * t385;
  t392 = -t361 + t260 * (-0.310907e-1 * t363 * t372 + t361 - 0.19751673498613801407e-1 * t386) + 0.19751673498613801407e-1 * t260 * t386;
  t395 = my_piecewise3(t134, 0, t338 * t392 / 0.2e1);
  t396 = sigma[2] * sigma[2];
  t397 = t396 * t396;
  t398 = t296 * t397;
  t399 = t194 * t194;
  t400 = t399 * t399;
  t403 = 0.1e1 / t196 / t400 / t194;
  t405 = 0.1e1 + 0.2e0 * t199;
  t406 = t405 * t405;
  t407 = t406 * t406;
  t408 = 0.1e1 / t407;
  t409 = t403 * t408;
  t412 = t313 * t209;
  t414 = t209 * t209;
  t415 = t316 * t414;
  t416 = t211 * t211;
  t417 = 0.1e1 / t416;
  t419 = t414 * t414;
  t420 = t322 * t419;
  t421 = t416 * t416;
  t422 = 0.1e1 / t421;
  t423 = t420 * t422;
  t424 = t396 * sigma[2];
  t425 = 0.1e1 / t400;
  t428 = 0.1e1 / t406 / t405;
  t432 = t295 + 0.16e-2 * t398 * t409 + t412 * t212 + t415 * t417 + 0.8e-2 * t423 * t424 * t425 * t428;
  t433 = t395 * t432;
  tzk0 = t130 + t219 + t337 + t433;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t10;
  double t13, t14, t15, t17, t18, t19, t20, t21;
  double t22, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t43, t44, t45, t46, t47, t50;
  double t53, t56, t68, t72, t73, t74, t76, t78;
  double t79, t81, t82, t85, t88, t92, t93, t94;
  double t95, t96, t97, t98, t99, t101, t102, t104;
  double t105, t109, t110, t111, t112, t113, t114, t116;
  double t118, t119, t120, t121, t122, t123, t125, t126;
  double t127, t130, t132, t133, t134, t136, t137, t138;
  double t139, t140, t143, t144, t145, t146, t147, t150;
  double t153, t156, t168, t172, t173, t175, t177, t178;
  double t180, t181, t184, t187, t191, t192, t193, t194;
  double t195, t196, t198, t199, t201, t202, t207, t208;
  double t209, t210, t211, t212, t214, t215, t216, t219;
  double t220, t222, t223, t224, t226, t228, t230, t231;
  double t234, t236, t238, t239, t240, t241, t242, t243;
  double t245, t247, t250, t251, t253, t255, t260, t262;
  double t267, t270, t271, t275, t280, t283, t284, t285;
  double t291, t294, t295, t296, t297, t298, t299, t300;
  double t301, t304, t306, t307, t308, t309, t310, t313;
  double t314, t316, t317, t318, t319, t320, t322, t323;
  double t324, t325, t326, t327, t328, t329, t332, t336;
  double t337, t338, t339, t341, t343, t345, t346, t349;
  double t351, t353, t355, t358, t359, t361, t363, t368;
  double t371, t372, t376, t381, t384, t385, t386, t392;
  double t395, t396, t397, t398, t399, t400, t403, t405;
  double t406, t407, t408, t409, t412, t414, t415, t416;
  double t417, t419, t420, t421, t422, t423, t424, t425;
  double t428, t432, t433, tzk0;

  double t434, t436, t437, t442, t445, t447, t450, t451;
  double t456, t457, t460, t462, t464, t465, t467, t468;
  double t470, t475, t476, t479, t480, t483, t484, t488;
  double t492, t496, t500, t504, t508, t510, t515, t519;
  double t531, t537, t544, t547, t548, t553, t557, t566;
  double t567, t574, t576, t579, t580, t585, t586, t588;
  double t589, t591, t592, t594, t599, t600, t603, t604;
  double t607, t608, t612, t616, t620, t624, t628, t632;
  double t634, t639, t643, t655, t662, t663, t666, t667;
  double t669, t672, t674, t678, t679, t681, t682, t683;
  double t684, t685, t687, t689, t690, t694, t696, t697;
  double t700, t703, t706, t707, t712, t714, t716, t719;
  double t722, t726, t729, t731, t732, t733, t735, t738;
  double t740, t741, t749, t758, t762, t772, t781, t785;
  double t792, t793, t795, t800, t803, t815, t818, t819;
  double t821, t824, t826, t830, t831, t833, t834, t835;
  double t836, t837, t839, t841, t842, t845, t846, t849;
  double t852, t855, t856, t861, t863, t865, t868, t871;
  double t875, t878, t880, t881, t882, t884, t887, t889;
  double t890, t898, t907, tvrho0, t911, t924, t925, t943;
  double t962, t969, t970, t983, t984, t1002, t1021, t1027;
  double t1034, t1037, t1038, t1043, t1047, t1056, t1057, t1061;
  double t1063, t1067, t1068, t1069, t1072, t1076, t1081, t1096;
  double t1102, t1118, t1120, t1124, t1126, t1130, t1131, t1132;
  double t1135, t1139, t1144, t1159, t1165, t1181, t1185, t1195;
  double t1204, t1208, t1215, t1216, t1218, t1223, t1226, tvrho1;
  double t1243, t1254, tvsigma0, tvsigma1, t1277, t1288, tvsigma2, tvlapl0;
  double tvlapl1, t1310, t1317, t1329, tvtau0, t1339, t1346, t1358;
  double tvtau1;

  hyb_mgga_xc_gas22_params *params;

  assert(p->params != NULL);
  params = (hyb_mgga_xc_gas22_params * )(p->params);

  t3 = rho[0] - rho[1];
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 + t6;
  t8 = t7 <= p->zeta_threshold;
  t9 = rho[0] <= p->dens_threshold || t8;
  t10 = M_CBRT3;
  t13 = POW_1_3(0.1e1 / M_PI);
  t14 = M_CBRT4;
  t15 = t14 * t14;
  t17 = M_CBRT2;
  t18 = t13 * t15 * t17;
  t19 = t7 * t10 * t18;
  t20 = 0.2e1 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t24 = my_piecewise3(t20, t22, 0.2e1 * t17);
  t25 = POW_1_3(t4);
  t26 = t24 * t25;
  t27 = 0.1e1 / t7;
  t28 = POW_1_3(t27);
  t29 = 0.1e1 / t28;
  t30 = POW_1_3(0.9e1);
  t31 = t30 * t30;
  t32 = t13 * t13;
  t33 = t31 * t32;
  t34 = p->hyb_omega[0] * t10;
  t35 = t33 * t34;
  t36 = 0.1e1 / t25;
  t37 = t36 * t17;
  t38 = my_piecewise3(t20, t21, t17);
  t39 = 0.1e1 / t38;
  t40 = t28 * t39;
  t43 = t35 * t37 * t40 / 0.18e2;
  t44 = 0.135e1 <= t43;
  t45 = 0.135e1 < t43;
  t46 = my_piecewise3(t45, t43, 0.135e1);
  t47 = t46 * t46;
  t50 = t47 * t47;
  t53 = t50 * t47;
  t56 = t50 * t50;
  t68 = t56 * t56;
  t72 = my_piecewise3(t45, 0.135e1, t43);
  t73 = sqrt(M_PI);
  t74 = 0.1e1 / t72;
  t76 = erf(t74 / 0.2e1);
  t78 = t72 * t72;
  t79 = 0.1e1 / t78;
  t81 = exp(-t79 / 0.4e1);
  t82 = t81 - 0.1e1;
  t85 = t81 - 0.3e1 / 0.2e1 - 0.2e1 * t78 * t82;
  t88 = 0.2e1 * t72 * t85 + t73 * t76;
  t92 = my_piecewise3(t44, 0.1e1 / t47 / 0.36e2 - 0.1e1 / t50 / 0.96e3 + 0.1e1 / t53 / 0.2688e5 - 0.1e1 / t56 / 0.82944e6 + 0.1e1 / t56 / t47 / 0.2838528e8 - 0.1e1 / t56 / t50 / 0.107347968e10 + 0.1e1 / t56 / t53 / 0.445906944e11 - 0.1e1 / t68 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t72 * t88);
  t93 = t29 * t92;
  t94 = params->c_x[0];
  t95 = params->c_x[1];
  t96 = t95 * sigma[0];
  t97 = rho[0] * rho[0];
  t98 = POW_1_3(rho[0]);
  t99 = t98 * t98;
  t101 = 0.1e1 / t99 / t97;
  t102 = sigma[0] * t101;
  t104 = 0.1e1 + 0.4e-2 * t102;
  t105 = 0.1e1 / t104;
  t109 = params->c_x[2];
  t110 = M_CBRT6;
  t111 = t110 * t110;
  t112 = M_PI * M_PI;
  t113 = POW_1_3(t112);
  t114 = t113 * t113;
  t116 = 0.3e1 / 0.1e2 * t111 * t114;
  t118 = 0.1e1 / t99 / rho[0];
  t119 = tau[0] * t118;
  t120 = t116 - t119;
  t121 = t109 * t120;
  t122 = t116 + t119;
  t123 = 0.1e1 / t122;
  t125 = t94 + 0.4e-2 * t96 * t101 * t105 + t121 * t123;
  t126 = t93 * t125;
  t127 = t26 * t126;
  t130 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t19 * t127);
  t132 = 0.1e1 - t6;
  t133 = t132 <= p->zeta_threshold;
  t134 = rho[1] <= p->dens_threshold || t133;
  t136 = t132 * t10 * t18;
  t137 = 0.1e1 / t132;
  t138 = POW_1_3(t137);
  t139 = 0.1e1 / t138;
  t140 = t138 * t39;
  t143 = t35 * t37 * t140 / 0.18e2;
  t144 = 0.135e1 <= t143;
  t145 = 0.135e1 < t143;
  t146 = my_piecewise3(t145, t143, 0.135e1);
  t147 = t146 * t146;
  t150 = t147 * t147;
  t153 = t150 * t147;
  t156 = t150 * t150;
  t168 = t156 * t156;
  t172 = my_piecewise3(t145, 0.135e1, t143);
  t173 = 0.1e1 / t172;
  t175 = erf(t173 / 0.2e1);
  t177 = t172 * t172;
  t178 = 0.1e1 / t177;
  t180 = exp(-t178 / 0.4e1);
  t181 = t180 - 0.1e1;
  t184 = t180 - 0.3e1 / 0.2e1 - 0.2e1 * t177 * t181;
  t187 = 0.2e1 * t172 * t184 + t73 * t175;
  t191 = my_piecewise3(t144, 0.1e1 / t147 / 0.36e2 - 0.1e1 / t150 / 0.96e3 + 0.1e1 / t153 / 0.2688e5 - 0.1e1 / t156 / 0.82944e6 + 0.1e1 / t156 / t147 / 0.2838528e8 - 0.1e1 / t156 / t150 / 0.107347968e10 + 0.1e1 / t156 / t153 / 0.445906944e11 - 0.1e1 / t168 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t172 * t187);
  t192 = t139 * t191;
  t193 = t95 * sigma[2];
  t194 = rho[1] * rho[1];
  t195 = POW_1_3(rho[1]);
  t196 = t195 * t195;
  t198 = 0.1e1 / t196 / t194;
  t199 = sigma[2] * t198;
  t201 = 0.1e1 + 0.4e-2 * t199;
  t202 = 0.1e1 / t201;
  t207 = 0.1e1 / t196 / rho[1];
  t208 = tau[1] * t207;
  t209 = t116 - t208;
  t210 = t109 * t209;
  t211 = t116 + t208;
  t212 = 0.1e1 / t211;
  t214 = t94 + 0.4e-2 * t193 * t198 * t202 + t210 * t212;
  t215 = t192 * t214;
  t216 = t26 * t215;
  t219 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t136 * t216);
  t220 = my_piecewise3(t8, p->zeta_threshold, t7);
  t222 = t10 * t13 * t15;
  t223 = 0.1e1 / t21;
  t224 = POW_1_3(t7);
  t226 = my_piecewise3(t8, t223, 0.1e1 / t224);
  t228 = t222 * t37 * t226;
  t230 = 0.1e1 + 0.53425e-1 * t228;
  t231 = sqrt(t228);
  t234 = POW_3_2(t228);
  t236 = t10 * t10;
  t238 = t236 * t32 * t14;
  t239 = t25 * t25;
  t240 = 0.1e1 / t239;
  t241 = t17 * t17;
  t242 = t240 * t241;
  t243 = t226 * t226;
  t245 = t238 * t242 * t243;
  t247 = 0.379785e1 * t231 + 0.8969e0 * t228 + 0.204775e0 * t234 + 0.123235e0 * t245;
  t250 = 0.1e1 + 0.16081979498692535067e2 / t247;
  t251 = log(t250);
  t253 = 0.621814e-1 * t230 * t251;
  t255 = my_piecewise3(0.e0 <= p->zeta_threshold, t22, 0);
  t260 = (t24 + t255 - 0.2e1) / (0.2e1 * t17 - 0.2e1);
  t262 = 0.1e1 + 0.5137e-1 * t228;
  t267 = 0.705945e1 * t231 + 0.1549425e1 * t228 + 0.420775e0 * t234 + 0.1562925e0 * t245;
  t270 = 0.1e1 + 0.32163958997385070134e2 / t267;
  t271 = log(t270);
  t275 = 0.1e1 + 0.278125e-1 * t228;
  t280 = 0.51785e1 * t231 + 0.905775e0 * t228 + 0.1100325e0 * t234 + 0.1241775e0 * t245;
  t283 = 0.1e1 + 0.29608749977793437516e2 / t280;
  t284 = log(t283);
  t285 = t275 * t284;
  t291 = -t253 + t260 * (-0.310907e-1 * t262 * t271 + t253 - 0.19751673498613801407e-1 * t285) + 0.19751673498613801407e-1 * t260 * t285;
  t294 = my_piecewise3(t9, 0, t220 * t291 / 0.2e1);
  t295 = params->c_ss[0];
  t296 = params->c_ss[1];
  t297 = sigma[0] * sigma[0];
  t298 = t297 * t297;
  t299 = t296 * t298;
  t300 = t97 * t97;
  t301 = t300 * t300;
  t304 = 0.1e1 / t99 / t301 / t97;
  t306 = 0.1e1 + 0.2e0 * t102;
  t307 = t306 * t306;
  t308 = t307 * t307;
  t309 = 0.1e1 / t308;
  t310 = t304 * t309;
  t313 = params->c_ss[2];
  t314 = t313 * t120;
  t316 = params->c_ss[3];
  t317 = t120 * t120;
  t318 = t316 * t317;
  t319 = t122 * t122;
  t320 = 0.1e1 / t319;
  t322 = params->c_ss[4];
  t323 = t317 * t317;
  t324 = t322 * t323;
  t325 = t319 * t319;
  t326 = 0.1e1 / t325;
  t327 = t324 * t326;
  t328 = t297 * sigma[0];
  t329 = 0.1e1 / t301;
  t332 = 0.1e1 / t307 / t306;
  t336 = t295 + 0.16e-2 * t299 * t310 + t314 * t123 + t318 * t320 + 0.8e-2 * t327 * t328 * t329 * t332;
  t337 = t294 * t336;
  t338 = my_piecewise3(t133, p->zeta_threshold, t132);
  t339 = POW_1_3(t132);
  t341 = my_piecewise3(t133, t223, 0.1e1 / t339);
  t343 = t222 * t37 * t341;
  t345 = 0.1e1 + 0.53425e-1 * t343;
  t346 = sqrt(t343);
  t349 = POW_3_2(t343);
  t351 = t341 * t341;
  t353 = t238 * t242 * t351;
  t355 = 0.379785e1 * t346 + 0.8969e0 * t343 + 0.204775e0 * t349 + 0.123235e0 * t353;
  t358 = 0.1e1 + 0.16081979498692535067e2 / t355;
  t359 = log(t358);
  t361 = 0.621814e-1 * t345 * t359;
  t363 = 0.1e1 + 0.5137e-1 * t343;
  t368 = 0.705945e1 * t346 + 0.1549425e1 * t343 + 0.420775e0 * t349 + 0.1562925e0 * t353;
  t371 = 0.1e1 + 0.32163958997385070134e2 / t368;
  t372 = log(t371);
  t376 = 0.1e1 + 0.278125e-1 * t343;
  t381 = 0.51785e1 * t346 + 0.905775e0 * t343 + 0.1100325e0 * t349 + 0.1241775e0 * t353;
  t384 = 0.1e1 + 0.29608749977793437516e2 / t381;
  t385 = log(t384);
  t386 = t376 * t385;
  t392 = -t361 + t260 * (-0.310907e-1 * t363 * t372 + t361 - 0.19751673498613801407e-1 * t386) + 0.19751673498613801407e-1 * t260 * t386;
  t395 = my_piecewise3(t134, 0, t338 * t392 / 0.2e1);
  t396 = sigma[2] * sigma[2];
  t397 = t396 * t396;
  t398 = t296 * t397;
  t399 = t194 * t194;
  t400 = t399 * t399;
  t403 = 0.1e1 / t196 / t400 / t194;
  t405 = 0.1e1 + 0.2e0 * t199;
  t406 = t405 * t405;
  t407 = t406 * t406;
  t408 = 0.1e1 / t407;
  t409 = t403 * t408;
  t412 = t313 * t209;
  t414 = t209 * t209;
  t415 = t316 * t414;
  t416 = t211 * t211;
  t417 = 0.1e1 / t416;
  t419 = t414 * t414;
  t420 = t322 * t419;
  t421 = t416 * t416;
  t422 = 0.1e1 / t421;
  t423 = t420 * t422;
  t424 = t396 * sigma[2];
  t425 = 0.1e1 / t400;
  t428 = 0.1e1 / t406 / t405;
  t432 = t295 + 0.16e-2 * t398 * t409 + t412 * t212 + t415 * t417 + 0.8e-2 * t423 * t424 * t425 * t428;
  t433 = t395 * t432;
  tzk0 = t130 + t219 + t337 + t433;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t434 = t4 * t4;
  t436 = t3 / t434;
  t437 = t5 - t436;
  t442 = t24 * t240;
  t445 = t19 * t442 * t126 / 0.64e2;
  t447 = t27 * t10 * t18;
  t450 = t26 / t28 / t27;
  t451 = t92 * t125;
  t456 = t47 * t46;
  t457 = 0.1e1 / t456;
  t460 = 0.1e1 / t25 / t4 * t17;
  t462 = t35 * t460 * t40;
  t464 = t33 * t34 * t36;
  t465 = t28 * t28;
  t467 = t17 / t465;
  t468 = t7 * t7;
  t470 = t39 / t468;
  t475 = -t464 * t467 * t470 * t437 / 0.54e2 - t462 / 0.54e2;
  t476 = my_piecewise3(t45, t475, 0);
  t479 = t50 * t46;
  t480 = 0.1e1 / t479;
  t483 = t50 * t456;
  t484 = 0.1e1 / t483;
  t488 = 0.1e1 / t56 / t46;
  t492 = 0.1e1 / t56 / t456;
  t496 = 0.1e1 / t56 / t479;
  t500 = 0.1e1 / t56 / t483;
  t504 = 0.1e1 / t68 / t46;
  t508 = my_piecewise3(t45, 0, t475);
  t510 = t81 * t79;
  t515 = 0.1e1 / t78 / t72;
  t519 = t72 * t82;
  t531 = my_piecewise3(t44, -t457 * t476 / 0.18e2 + t480 * t476 / 0.24e3 - t484 * t476 / 0.448e4 + t488 * t476 / 0.10368e6 - t492 * t476 / 0.2838528e7 + t496 * t476 / 0.8945664e8 - t500 * t476 / 0.31850496e10 + t504 * t476 / 0.1263403008e12, -0.8e1 / 0.3e1 * t508 * t88 - 0.8e1 / 0.3e1 * t72 * (-t510 * t508 + 0.2e1 * t508 * t85 + 0.2e1 * t72 * (t515 * t508 * t81 / 0.2e1 - 0.4e1 * t519 * t508 - t74 * t508 * t81)));
  t537 = t97 * rho[0];
  t544 = t300 * t97;
  t547 = t104 * t104;
  t548 = 0.1e1 / t547;
  t553 = t101 * t123;
  t557 = t320 * tau[0] * t101;
  t566 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t437 * t10 * t18 * t127 - t445 - t447 * t450 * t451 * t437 / 0.64e2 - 0.3e1 / 0.64e2 * t19 * t26 * t29 * t531 * t125 - 0.3e1 / 0.64e2 * t19 * t26 * t93 * (-0.10666666666666666667e-1 * t96 / t99 / t537 * t105 + 0.42666666666666666668e-4 * t95 * t297 / t98 / t544 * t548 + 0.5e1 / 0.3e1 * t109 * tau[0] * t553 + 0.5e1 / 0.3e1 * t121 * t557));
  t567 = -t437;
  t574 = t136 * t442 * t215 / 0.64e2;
  t576 = t137 * t10 * t18;
  t579 = t26 / t138 / t137;
  t580 = t191 * t214;
  t585 = t147 * t146;
  t586 = 0.1e1 / t585;
  t588 = t35 * t460 * t140;
  t589 = t138 * t138;
  t591 = t17 / t589;
  t592 = t132 * t132;
  t594 = t39 / t592;
  t599 = -t464 * t591 * t594 * t567 / 0.54e2 - t588 / 0.54e2;
  t600 = my_piecewise3(t145, t599, 0);
  t603 = t150 * t146;
  t604 = 0.1e1 / t603;
  t607 = t150 * t585;
  t608 = 0.1e1 / t607;
  t612 = 0.1e1 / t156 / t146;
  t616 = 0.1e1 / t156 / t585;
  t620 = 0.1e1 / t156 / t603;
  t624 = 0.1e1 / t156 / t607;
  t628 = 0.1e1 / t168 / t146;
  t632 = my_piecewise3(t145, 0, t599);
  t634 = t180 * t178;
  t639 = 0.1e1 / t177 / t172;
  t643 = t172 * t181;
  t655 = my_piecewise3(t144, -t586 * t600 / 0.18e2 + t604 * t600 / 0.24e3 - t608 * t600 / 0.448e4 + t612 * t600 / 0.10368e6 - t616 * t600 / 0.2838528e7 + t620 * t600 / 0.8945664e8 - t624 * t600 / 0.31850496e10 + t628 * t600 / 0.1263403008e12, -0.8e1 / 0.3e1 * t632 * t187 - 0.8e1 / 0.3e1 * t172 * (-t634 * t632 + 0.2e1 * t632 * t184 + 0.2e1 * t172 * (t639 * t632 * t180 / 0.2e1 - 0.4e1 * t643 * t632 - t173 * t632 * t180)));
  t662 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t567 * t10 * t18 * t216 - t574 - t576 * t579 * t580 * t567 / 0.64e2 - 0.3e1 / 0.64e2 * t136 * t26 * t139 * t655 * t214);
  t663 = my_piecewise3(t8, 0, t437);
  t666 = t222 * t460 * t226;
  t667 = 0.17808333333333333333e-1 * t666;
  t669 = 0.1e1 / t224 / t7;
  t672 = my_piecewise3(t8, 0, -t669 * t437 / 0.3e1);
  t674 = t222 * t37 * t672;
  t678 = 0.621814e-1 * (-t667 + 0.53425e-1 * t674) * t251;
  t679 = t247 * t247;
  t681 = t230 / t679;
  t682 = 0.1e1 / t231;
  t683 = t666 / 0.3e1;
  t684 = -t683 + t674;
  t685 = t682 * t684;
  t687 = 0.29896666666666666667e0 * t666;
  t689 = sqrt(t228);
  t690 = t689 * t684;
  t694 = 0.1e1 / t239 / t4 * t241;
  t696 = t238 * t694 * t243;
  t697 = 0.82156666666666666667e-1 * t696;
  t700 = t238 * t242 * t226 * t672;
  t703 = 0.1e1 / t250;
  t706 = 0.1e1 * t681 * (0.1898925e1 * t685 - t687 + 0.8969e0 * t674 + 0.3071625e0 * t690 - t697 + 0.24647e0 * t700) * t703;
  t707 = 0.17123333333333333333e-1 * t666;
  t712 = t267 * t267;
  t714 = t262 / t712;
  t716 = 0.516475e0 * t666;
  t719 = 0.104195e0 * t696;
  t722 = 0.1e1 / t270;
  t726 = 0.92708333333333333333e-2 * t666;
  t729 = (-t726 + 0.278125e-1 * t674) * t284;
  t731 = t280 * t280;
  t732 = 0.1e1 / t731;
  t733 = t275 * t732;
  t735 = 0.301925e0 * t666;
  t738 = 0.82785e-1 * t696;
  t740 = 0.258925e1 * t685 - t735 + 0.905775e0 * t674 + 0.16504875e0 * t690 - t738 + 0.248355e0 * t700;
  t741 = 0.1e1 / t283;
  t749 = t260 * t275;
  t758 = my_piecewise3(t9, 0, t663 * t291 / 0.2e1 + t220 * (-t678 + t706 + t260 * (-0.310907e-1 * (-t707 + 0.5137e-1 * t674) * t271 + 0.1e1 * t714 * (0.3529725e1 * t685 - t716 + 0.1549425e1 * t674 + 0.6311625e0 * t690 - t719 + 0.312585e0 * t700) * t722 + t678 - t706 - 0.19751673498613801407e-1 * t729 + 0.5848223622634646207e0 * t733 * t740 * t741) + 0.19751673498613801407e-1 * t260 * t729 - 0.5848223622634646207e0 * t749 * t732 * t740 * t741) / 0.2e1);
  t762 = 0.1e1 / t99 / t301 / t537;
  t772 = 0.1e1 / t308 / t306;
  t781 = t316 * t120;
  t785 = 0.1e1 / t319 / t122;
  t792 = t322 * t317 * t120 * t326;
  t793 = t328 * t304;
  t795 = t793 * t332 * tau[0];
  t800 = t324 / t325 / t122;
  t803 = t301 * rho[0];
  t815 = my_piecewise3(t133, 0, t567);
  t818 = t222 * t460 * t341;
  t819 = 0.17808333333333333333e-1 * t818;
  t821 = 0.1e1 / t339 / t132;
  t824 = my_piecewise3(t133, 0, -t821 * t567 / 0.3e1);
  t826 = t222 * t37 * t824;
  t830 = 0.621814e-1 * (-t819 + 0.53425e-1 * t826) * t359;
  t831 = t355 * t355;
  t833 = t345 / t831;
  t834 = 0.1e1 / t346;
  t835 = t818 / 0.3e1;
  t836 = -t835 + t826;
  t837 = t834 * t836;
  t839 = 0.29896666666666666667e0 * t818;
  t841 = sqrt(t343);
  t842 = t841 * t836;
  t845 = t238 * t694 * t351;
  t846 = 0.82156666666666666667e-1 * t845;
  t849 = t238 * t242 * t341 * t824;
  t852 = 0.1e1 / t358;
  t855 = 0.1e1 * t833 * (0.1898925e1 * t837 - t839 + 0.8969e0 * t826 + 0.3071625e0 * t842 - t846 + 0.24647e0 * t849) * t852;
  t856 = 0.17123333333333333333e-1 * t818;
  t861 = t368 * t368;
  t863 = t363 / t861;
  t865 = 0.516475e0 * t818;
  t868 = 0.104195e0 * t845;
  t871 = 0.1e1 / t371;
  t875 = 0.92708333333333333333e-2 * t818;
  t878 = (-t875 + 0.278125e-1 * t826) * t385;
  t880 = t381 * t381;
  t881 = 0.1e1 / t880;
  t882 = t376 * t881;
  t884 = 0.301925e0 * t818;
  t887 = 0.82785e-1 * t845;
  t889 = 0.258925e1 * t837 - t884 + 0.905775e0 * t826 + 0.16504875e0 * t842 - t887 + 0.248355e0 * t849;
  t890 = 0.1e1 / t384;
  t898 = t260 * t376;
  t907 = my_piecewise3(t134, 0, t815 * t392 / 0.2e1 + t338 * (-t830 + t855 + t260 * (-0.310907e-1 * (-t856 + 0.5137e-1 * t826) * t372 + 0.1e1 * t863 * (0.3529725e1 * t837 - t865 + 0.1549425e1 * t826 + 0.6311625e0 * t842 - t868 + 0.312585e0 * t849) * t871 + t830 - t855 - 0.19751673498613801407e-1 * t878 + 0.5848223622634646207e0 * t882 * t889 * t890) + 0.19751673498613801407e-1 * t260 * t878 - 0.5848223622634646207e0 * t898 * t881 * t889 * t890) / 0.2e1);
  tvrho0 = t130 + t219 + t337 + t433 + t4 * (t566 + t662 + t758 * t336 + t294 * (-0.17066666666666666667e-1 * t299 * t762 * t309 + 0.34133333333333333333e-2 * t296 * t298 * sigma[0] / t98 / t301 / t544 * t772 + 0.5e1 / 0.3e1 * t313 * tau[0] * t553 + 0.5e1 / 0.3e1 * t314 * t557 + 0.1e2 / 0.3e1 * t781 * t557 + 0.1e2 / 0.3e1 * t318 * t785 * tau[0] * t101 + 0.53333333333333333333e-1 * t792 * t795 + 0.53333333333333333333e-1 * t800 * t795 - 0.64e-1 * t327 * t328 / t803 * t332 + 0.128e-1 * t327 * t298 * t762 * t309) + t907 * t432);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t911 = -t5 - t436;
  t924 = -t464 * t467 * t470 * t911 / 0.54e2 - t462 / 0.54e2;
  t925 = my_piecewise3(t45, t924, 0);
  t943 = my_piecewise3(t45, 0, t924);
  t962 = my_piecewise3(t44, -t457 * t925 / 0.18e2 + t480 * t925 / 0.24e3 - t484 * t925 / 0.448e4 + t488 * t925 / 0.10368e6 - t492 * t925 / 0.2838528e7 + t496 * t925 / 0.8945664e8 - t500 * t925 / 0.31850496e10 + t504 * t925 / 0.1263403008e12, -0.8e1 / 0.3e1 * t943 * t88 - 0.8e1 / 0.3e1 * t72 * (-t510 * t943 + 0.2e1 * t943 * t85 + 0.2e1 * t72 * (t515 * t943 * t81 / 0.2e1 - 0.4e1 * t519 * t943 - t74 * t943 * t81)));
  t969 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t911 * t10 * t18 * t127 - t445 - t447 * t450 * t451 * t911 / 0.64e2 - 0.3e1 / 0.64e2 * t19 * t26 * t29 * t962 * t125);
  t970 = -t911;
  t983 = -t464 * t591 * t594 * t970 / 0.54e2 - t588 / 0.54e2;
  t984 = my_piecewise3(t145, t983, 0);
  t1002 = my_piecewise3(t145, 0, t983);
  t1021 = my_piecewise3(t144, -t586 * t984 / 0.18e2 + t604 * t984 / 0.24e3 - t608 * t984 / 0.448e4 + t612 * t984 / 0.10368e6 - t616 * t984 / 0.2838528e7 + t620 * t984 / 0.8945664e8 - t624 * t984 / 0.31850496e10 + t628 * t984 / 0.1263403008e12, -0.8e1 / 0.3e1 * t1002 * t187 - 0.8e1 / 0.3e1 * t172 * (-t634 * t1002 + 0.2e1 * t1002 * t184 + 0.2e1 * t172 * (t639 * t1002 * t180 / 0.2e1 - 0.4e1 * t643 * t1002 - t173 * t1002 * t180)));
  t1027 = t194 * rho[1];
  t1034 = t399 * t194;
  t1037 = t201 * t201;
  t1038 = 0.1e1 / t1037;
  t1043 = t198 * t212;
  t1047 = t417 * tau[1] * t198;
  t1056 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t970 * t10 * t18 * t216 - t574 - t576 * t579 * t580 * t970 / 0.64e2 - 0.3e1 / 0.64e2 * t136 * t26 * t139 * t1021 * t214 - 0.3e1 / 0.64e2 * t136 * t26 * t192 * (-0.10666666666666666667e-1 * t193 / t196 / t1027 * t202 + 0.42666666666666666668e-4 * t95 * t396 / t195 / t1034 * t1038 + 0.5e1 / 0.3e1 * t109 * tau[1] * t1043 + 0.5e1 / 0.3e1 * t210 * t1047));
  t1057 = my_piecewise3(t8, 0, t911);
  t1061 = my_piecewise3(t8, 0, -t669 * t911 / 0.3e1);
  t1063 = t222 * t37 * t1061;
  t1067 = 0.621814e-1 * (-t667 + 0.53425e-1 * t1063) * t251;
  t1068 = -t683 + t1063;
  t1069 = t682 * t1068;
  t1072 = t689 * t1068;
  t1076 = t238 * t242 * t226 * t1061;
  t1081 = 0.1e1 * t681 * (0.1898925e1 * t1069 - t687 + 0.8969e0 * t1063 + 0.3071625e0 * t1072 - t697 + 0.24647e0 * t1076) * t703;
  t1096 = (-t726 + 0.278125e-1 * t1063) * t284;
  t1102 = 0.258925e1 * t1069 - t735 + 0.905775e0 * t1063 + 0.16504875e0 * t1072 - t738 + 0.248355e0 * t1076;
  t1118 = my_piecewise3(t9, 0, t1057 * t291 / 0.2e1 + t220 * (-t1067 + t1081 + t260 * (-0.310907e-1 * (-t707 + 0.5137e-1 * t1063) * t271 + 0.1e1 * t714 * (0.3529725e1 * t1069 - t716 + 0.1549425e1 * t1063 + 0.6311625e0 * t1072 - t719 + 0.312585e0 * t1076) * t722 + t1067 - t1081 - 0.19751673498613801407e-1 * t1096 + 0.5848223622634646207e0 * t733 * t1102 * t741) + 0.19751673498613801407e-1 * t260 * t1096 - 0.5848223622634646207e0 * t749 * t732 * t1102 * t741) / 0.2e1);
  t1120 = my_piecewise3(t133, 0, t970);
  t1124 = my_piecewise3(t133, 0, -t821 * t970 / 0.3e1);
  t1126 = t222 * t37 * t1124;
  t1130 = 0.621814e-1 * (-t819 + 0.53425e-1 * t1126) * t359;
  t1131 = -t835 + t1126;
  t1132 = t834 * t1131;
  t1135 = t841 * t1131;
  t1139 = t238 * t242 * t341 * t1124;
  t1144 = 0.1e1 * t833 * (0.1898925e1 * t1132 - t839 + 0.8969e0 * t1126 + 0.3071625e0 * t1135 - t846 + 0.24647e0 * t1139) * t852;
  t1159 = (-t875 + 0.278125e-1 * t1126) * t385;
  t1165 = 0.258925e1 * t1132 - t884 + 0.905775e0 * t1126 + 0.16504875e0 * t1135 - t887 + 0.248355e0 * t1139;
  t1181 = my_piecewise3(t134, 0, t1120 * t392 / 0.2e1 + t338 * (-t1130 + t1144 + t260 * (-0.310907e-1 * (-t856 + 0.5137e-1 * t1126) * t372 + 0.1e1 * t863 * (0.3529725e1 * t1132 - t865 + 0.1549425e1 * t1126 + 0.6311625e0 * t1135 - t868 + 0.312585e0 * t1139) * t871 + t1130 - t1144 - 0.19751673498613801407e-1 * t1159 + 0.5848223622634646207e0 * t882 * t1165 * t890) + 0.19751673498613801407e-1 * t260 * t1159 - 0.5848223622634646207e0 * t898 * t881 * t1165 * t890) / 0.2e1);
  t1185 = 0.1e1 / t196 / t400 / t1027;
  t1195 = 0.1e1 / t407 / t405;
  t1204 = t316 * t209;
  t1208 = 0.1e1 / t416 / t211;
  t1215 = t322 * t414 * t209 * t422;
  t1216 = t424 * t403;
  t1218 = t1216 * t428 * tau[1];
  t1223 = t420 / t421 / t211;
  t1226 = t400 * rho[1];
  tvrho1 = t130 + t219 + t337 + t433 + t4 * (t969 + t1056 + t1118 * t336 + t1181 * t432 + t395 * (-0.17066666666666666667e-1 * t398 * t1185 * t408 + 0.34133333333333333333e-2 * t296 * t397 * sigma[2] / t195 / t400 / t1034 * t1195 + 0.5e1 / 0.3e1 * t313 * tau[1] * t1043 + 0.5e1 / 0.3e1 * t412 * t1047 + 0.1e2 / 0.3e1 * t1204 * t1047 + 0.1e2 / 0.3e1 * t415 * t1208 * tau[1] * t198 + 0.53333333333333333333e-1 * t1215 * t1218 + 0.53333333333333333333e-1 * t1223 * t1218 - 0.64e-1 * t423 * t424 / t1226 * t428 + 0.128e-1 * t423 * t397 * t1185 * t408));

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t1243 = t300 * rho[0];
  t1254 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t19 * t26 * t93 * (0.4e-2 * t95 * t101 * t105 - 0.16e-4 * t96 / t98 / t1243 * t548));
  tvsigma0 = t4 * (t1254 + t294 * (0.64e-2 * t296 * t328 * t310 - 0.128e-2 * t299 / t98 / t301 / t1243 * t772 + 0.24e-1 * t327 * t297 * t329 * t332 - 0.48e-2 * t327 * t793 * t309));

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t1277 = t399 * rho[1];
  t1288 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t136 * t26 * t192 * (0.4e-2 * t95 * t198 * t202 - 0.16e-4 * t193 / t195 / t1277 * t1038));
  tvsigma2 = t4 * (t1288 + t395 * (0.64e-2 * t296 * t424 * t409 - 0.128e-2 * t398 / t195 / t400 / t1277 * t1195 + 0.24e-1 * t423 * t396 * t425 * t428 - 0.48e-2 * t423 * t1216 * t408));

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  t1310 = t320 * t118;
  t1317 = my_piecewise3(t9, 0, -0.3e1 / 0.64e2 * t19 * t26 * t93 * (-t109 * t118 * t123 - t121 * t1310));
  t1329 = t328 / t99 / t803 * t332;
  tvtau0 = t4 * (t1317 + t294 * (-t313 * t118 * t123 - t314 * t1310 - 0.2e1 * t781 * t1310 - 0.2e1 * t318 * t785 * t118 - 0.32e-1 * t792 * t1329 - 0.32e-1 * t800 * t1329));

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t1339 = t417 * t207;
  t1346 = my_piecewise3(t134, 0, -0.3e1 / 0.64e2 * t136 * t26 * t192 * (-t109 * t207 * t212 - t210 * t1339));
  t1358 = t424 / t196 / t1226 * t428;
  tvtau1 = t4 * (t1346 + t395 * (-t313 * t207 * t212 - t412 * t1339 - 0.2e1 * t1204 * t1339 - 0.2e1 * t415 * t1208 * t207 - 0.32e-1 * t1215 * t1358 - 0.32e-1 * t1223 * t1358));

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

}

#endif

