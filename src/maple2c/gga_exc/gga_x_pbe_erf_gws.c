/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_pbe_erf_gws.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t35, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t49, t50, t52;
  double t53, t55, t56, t57, t64, t66, t67, t68;
  double t69, t75, t76, t78, t79, t80, t82, t83;
  double t84, t86, t90, t96, t102, t103, t107, t108;
  double t113, t114, t115, t118, t119, t123, t127, t128;
  double t129, t130, t131, t132, t136, t143, t148, t153;
  double t156, t159, t163, t165, t166, t167, t170, t171;
  double t172, t173, t174, t175, t176, t177, t178, t179;
  double t182, t184, t190, t191, t192, t195, t196, t197;
  double t200, t203, t207, t209, t210, t215, t216, t217;
  double t218, t220, t224, t225, t226, t227, t230, t231;
  double tzk0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = p->hyb_omega[0] * p->hyb_omega[0];
  t4 = params->ax * t3;
  t5 = M_CBRT3;
  t7 = M_CBRTPI;
  t8 = t7 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = t12 * t12;
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t20 = 0.1e1 / t19;
  t25 = exp(-t4 * t5 * t16 * t17 * t20 / 0.12e2);
  t26 = params->b_PBE * t25;
  t27 = t26 * sigma[0];
  t28 = params->kappa + 0.1e1;
  t29 = t5 * t28;
  t30 = t5 * t5;
  t31 = t12 * t30;
  t32 = t7 * t7;
  t34 = t31 / t32;
  t35 = 0.1e1 / t18;
  t37 = 0.1e1 / t13;
  t40 = t34 * p->hyb_omega[0] * t35 * t37 / 0.6e1;
  t41 = t40 < 0.5e-1;
  t42 = t14 * t14;
  t43 = M_PI * M_PI;
  t44 = t32 * t43;
  t45 = t42 * t44;
  t46 = t18 * rho[0];
  t47 = t45 * t46;
  t49 = t14 * t8;
  t50 = t49 * t17;
  t52 = t5 * t19 * t3;
  t53 = t50 * t52;
  t55 = 0.7e1 * t47 - 0.6e1 * t53;
  t56 = t14 * t13;
  t57 = 0.1e1 / p->hyb_omega[0];
  t64 = erf(t57 * t5 * t32 * t13 * t17 * t18 / 0.2e1);
  t66 = sqrt(M_PI);
  t67 = t66 * t43;
  t68 = t56 * t64 * t67;
  t69 = rho[0] * p->hyb_omega[0];
  t75 = t3 * t3;
  t76 = t75 * t30;
  t78 = 0.12e2 * t76 * t12;
  t79 = -0.36e2 * t68 * t31 * t69 + 0.81e2 * t47 + 0.54e2 * t53 - t78;
  t80 = 0.1e1 / t79;
  t82 = 0.1e11 < t40;
  t83 = t43 * t43;
  t84 = rho[0] * rho[0];
  t86 = t42 * t14;
  t90 = t44 * t17 * t5;
  t96 = t8 * t12 * t30;
  t102 = t75 * t3;
  t103 = 0.1e1 / t102;
  t107 = 0.1e1 / t3;
  t108 = t107 * t30;
  t113 = t108 * t8 * t14 * t12 * t19 / 0.2e1;
  t114 = exp(t113);
  t115 = t114 * t8;
  t118 = t5 * t3;
  t119 = t14 * t17 * t118;
  t123 = t114 * t12;
  t127 = (0.7e1 * t115 * t19 * t119 - 0.12e2 * t123 * t76 + 0.6e1 * t47 + 0.11e2 * t53 + t78) * t8;
  t128 = t19 * t14;
  t129 = t127 * t128;
  t130 = t17 * t30;
  t131 = t42 * t114;
  t132 = t44 * t12;
  t136 = t56 * t114;
  t143 = t14 * t114 * t8;
  t148 = t114 * t17;
  t153 = 0.12e2 * t136 * t64 * t67 * t130 * t69 - 0.27e2 * t131 * t132 * t46 - 0.4e1 * t130 * t75 - 0.36e2 * t143 * t52 + 0.4e1 * t148 * t76 + 0.24e2 * t49 * t52;
  t156 = t130 * t107 / t153;
  t159 = my_piecewise5(t41, t55 * t80, t82, (0.56e4 * t96 * t19 * t75 * t14 - 0.14e3 * t90 * t46 * t3 * t42 - 0.1863e4 * t83 * t84 * t86) * t103 / 0.2016e6, -t129 * t156 / 0.18e2);
  t163 = t19 * t84;
  t165 = params->kappa * t163 * t8;
  t166 = 0.27e2 / 0.28e2 * t27 * t29 * t159 + t165;
  t167 = t166 * t46;
  t170 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t171 = t170 * t17;
  t172 = t167 * t171;
  t173 = 0.135e1 <= t40;
  t174 = 0.135e1 < t40;
  t175 = my_piecewise3(t174, t40, 0.135e1);
  t176 = t175 * t175;
  t177 = t176 * t176;
  t178 = t177 * t176;
  t179 = t177 * t177;
  t182 = t179 * t177;
  t184 = t179 * t176;
  t190 = 0.240888840192e14 * t179 * t178 + 0.19448e5 * t176 - 0.80784e6 * t177 + 0.3055104e8 * t178 - 0.104552448e10 * t179 - 0.90333315072e12 * t182 + 0.3226189824e11 * t184 - 0.429e3;
  t191 = t179 * t179;
  t192 = 0.1e1 / t191;
  t195 = my_piecewise3(t174, 0.135e1, t40);
  t196 = t195 * t195;
  t197 = t196 * t196;
  t200 = 0.32e2 * t197 - 0.16e2 * t196;
  t203 = exp(-0.1e1 / t196 / 0.4e1);
  t207 = 0.1e1 / t195;
  t209 = erf(t207 / 0.2e1);
  t210 = t66 * t209;
  t215 = my_piecewise3(t173, t190 * t192 / 0.8671998246912e15, t200 * t203 / 0.3e1 - 0.32e2 / 0.3e1 * t197 - 0.8e1 / 0.3e1 * t210 * t195 + 0.8e1 * t196 + 0.1e1);
  t216 = 0.1e1 / t7;
  t217 = t215 * t216;
  t218 = params->b_PBE * t159;
  t220 = t25 * sigma[0] * t5;
  t224 = 0.864e3 * t218 * t220 + 0.896e3 * t165;
  t225 = 0.1e1 / t224;
  t226 = t5 * t225;
  t227 = t217 * t226;
  t230 = my_piecewise3(t2, 0, -0.84e2 * t172 * t227);
  t231 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t230 * t231;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t35, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t49, t50, t52;
  double t53, t55, t56, t57, t64, t66, t67, t68;
  double t69, t75, t76, t78, t79, t80, t82, t83;
  double t84, t86, t90, t96, t102, t103, t107, t108;
  double t113, t114, t115, t118, t119, t123, t127, t128;
  double t129, t130, t131, t132, t136, t143, t148, t153;
  double t156, t159, t163, t165, t166, t167, t170, t171;
  double t172, t173, t174, t175, t176, t177, t178, t179;
  double t182, t184, t190, t191, t192, t195, t196, t197;
  double t200, t203, t207, t209, t210, t215, t216, t217;
  double t218, t220, t224, t225, t226, t227, t230, t231;
  double tzk0;

  double t234, t237, t238, t239, t241, t242, t243, t247;
  double t249, t250, t251, t253, t255, t256, t257, t258;
  double t267, t293, t294, t297, t298, t301, t303, t304;
  double t305, t306, t316, t317, t318, t319, t320, t321;
  double t322, t324, t328, t329, t343, t345, t349, t354;
  double t356, t357, t358, t361, t362, t365, t366, t367;
  double t371, t372, t375, t376, t379, t382, t391, t395;
  double t396, t400, t401, t402, t404, t406, t409, t410;
  double t411, t415, t422, t423, t424, t427, t428, t429;
  double t430, t433, t434, t435, t438, t442, t443, t444;
  double t448, tvrho0, t449, t451, t453, t454, t455, t458;
  double t459, t461, t463, t467, tvsigma0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = p->hyb_omega[0] * p->hyb_omega[0];
  t4 = params->ax * t3;
  t5 = M_CBRT3;
  t7 = M_CBRTPI;
  t8 = t7 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = t12 * t12;
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t20 = 0.1e1 / t19;
  t25 = exp(-t4 * t5 * t16 * t17 * t20 / 0.12e2);
  t26 = params->b_PBE * t25;
  t27 = t26 * sigma[0];
  t28 = params->kappa + 0.1e1;
  t29 = t5 * t28;
  t30 = t5 * t5;
  t31 = t12 * t30;
  t32 = t7 * t7;
  t34 = t31 / t32;
  t35 = 0.1e1 / t18;
  t37 = 0.1e1 / t13;
  t40 = t34 * p->hyb_omega[0] * t35 * t37 / 0.6e1;
  t41 = t40 < 0.5e-1;
  t42 = t14 * t14;
  t43 = M_PI * M_PI;
  t44 = t32 * t43;
  t45 = t42 * t44;
  t46 = t18 * rho[0];
  t47 = t45 * t46;
  t49 = t14 * t8;
  t50 = t49 * t17;
  t52 = t5 * t19 * t3;
  t53 = t50 * t52;
  t55 = 0.7e1 * t47 - 0.6e1 * t53;
  t56 = t14 * t13;
  t57 = 0.1e1 / p->hyb_omega[0];
  t64 = erf(t57 * t5 * t32 * t13 * t17 * t18 / 0.2e1);
  t66 = sqrt(M_PI);
  t67 = t66 * t43;
  t68 = t56 * t64 * t67;
  t69 = rho[0] * p->hyb_omega[0];
  t75 = t3 * t3;
  t76 = t75 * t30;
  t78 = 0.12e2 * t76 * t12;
  t79 = -0.36e2 * t68 * t31 * t69 + 0.81e2 * t47 + 0.54e2 * t53 - t78;
  t80 = 0.1e1 / t79;
  t82 = 0.1e11 < t40;
  t83 = t43 * t43;
  t84 = rho[0] * rho[0];
  t86 = t42 * t14;
  t90 = t44 * t17 * t5;
  t96 = t8 * t12 * t30;
  t102 = t75 * t3;
  t103 = 0.1e1 / t102;
  t107 = 0.1e1 / t3;
  t108 = t107 * t30;
  t113 = t108 * t8 * t14 * t12 * t19 / 0.2e1;
  t114 = exp(t113);
  t115 = t114 * t8;
  t118 = t5 * t3;
  t119 = t14 * t17 * t118;
  t123 = t114 * t12;
  t127 = (0.7e1 * t115 * t19 * t119 - 0.12e2 * t123 * t76 + 0.6e1 * t47 + 0.11e2 * t53 + t78) * t8;
  t128 = t19 * t14;
  t129 = t127 * t128;
  t130 = t17 * t30;
  t131 = t42 * t114;
  t132 = t44 * t12;
  t136 = t56 * t114;
  t143 = t14 * t114 * t8;
  t148 = t114 * t17;
  t153 = 0.12e2 * t136 * t64 * t67 * t130 * t69 - 0.27e2 * t131 * t132 * t46 - 0.4e1 * t130 * t75 - 0.36e2 * t143 * t52 + 0.4e1 * t148 * t76 + 0.24e2 * t49 * t52;
  t156 = t130 * t107 / t153;
  t159 = my_piecewise5(t41, t55 * t80, t82, (0.56e4 * t96 * t19 * t75 * t14 - 0.14e3 * t90 * t46 * t3 * t42 - 0.1863e4 * t83 * t84 * t86) * t103 / 0.2016e6, -t129 * t156 / 0.18e2);
  t163 = t19 * t84;
  t165 = params->kappa * t163 * t8;
  t166 = 0.27e2 / 0.28e2 * t27 * t29 * t159 + t165;
  t167 = t166 * t46;
  t170 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t171 = t170 * t17;
  t172 = t167 * t171;
  t173 = 0.135e1 <= t40;
  t174 = 0.135e1 < t40;
  t175 = my_piecewise3(t174, t40, 0.135e1);
  t176 = t175 * t175;
  t177 = t176 * t176;
  t178 = t177 * t176;
  t179 = t177 * t177;
  t182 = t179 * t177;
  t184 = t179 * t176;
  t190 = 0.240888840192e14 * t179 * t178 + 0.19448e5 * t176 - 0.80784e6 * t177 + 0.3055104e8 * t178 - 0.104552448e10 * t179 - 0.90333315072e12 * t182 + 0.3226189824e11 * t184 - 0.429e3;
  t191 = t179 * t179;
  t192 = 0.1e1 / t191;
  t195 = my_piecewise3(t174, 0.135e1, t40);
  t196 = t195 * t195;
  t197 = t196 * t196;
  t200 = 0.32e2 * t197 - 0.16e2 * t196;
  t203 = exp(-0.1e1 / t196 / 0.4e1);
  t207 = 0.1e1 / t195;
  t209 = erf(t207 / 0.2e1);
  t210 = t66 * t209;
  t215 = my_piecewise3(t173, t190 * t192 / 0.8671998246912e15, t200 * t203 / 0.3e1 - 0.32e2 / 0.3e1 * t197 - 0.8e1 / 0.3e1 * t210 * t195 + 0.8e1 * t196 + 0.1e1);
  t216 = 0.1e1 / t7;
  t217 = t215 * t216;
  t218 = params->b_PBE * t159;
  t220 = t25 * sigma[0] * t5;
  t224 = 0.864e3 * t218 * t220 + 0.896e3 * t165;
  t225 = 0.1e1 / t224;
  t226 = t5 * t225;
  t227 = t217 * t226;
  t230 = my_piecewise3(t2, 0, -0.84e2 * t172 * t227);
  t231 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t230 * t231;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t234 = params->b_PBE * params->ax * t3;
  t237 = t234 * t30 * t9 * t15;
  t238 = t19 * rho[0];
  t239 = 0.1e1 / t238;
  t241 = t17 * t239 * t25;
  t242 = sigma[0] * t28;
  t243 = t242 * t159;
  t247 = t45 * t18;
  t249 = t5 * t35;
  t250 = t249 * t3;
  t251 = t50 * t250;
  t253 = 0.28e2 / 0.3e1 * t247 - 0.4e1 * t251;
  t255 = t79 * t79;
  t256 = 0.1e1 / t255;
  t257 = t55 * t256;
  t258 = exp(-t113);
  t267 = -0.72e2 * t45 * t258 * t18 - 0.36e2 * t68 * t31 * p->hyb_omega[0] + 0.108e3 * t247 + 0.36e2 * t251;
  t293 = (0.8e1 * t247 + 0.14e2 * t45 * t18 * t114 - 0.22e2 / 0.3e1 * t115 * t35 * t119 + 0.22e2 / 0.3e1 * t251) * t8;
  t294 = t293 * t128;
  t297 = t35 * t14;
  t298 = t127 * t297;
  t301 = t153 * t153;
  t303 = t107 / t301;
  t304 = t86 * t107;
  t305 = t304 * t30;
  t306 = t83 * t17;
  t316 = t42 * t13 * t57 * t5;
  t317 = t43 * M_PI;
  t318 = pow(M_PI, 0.1e1 / 0.6e1);
  t319 = t318 * t318;
  t320 = t319 * t319;
  t321 = t320 * t318;
  t322 = t321 * t317;
  t324 = t114 * t64;
  t328 = t131 * t44;
  t329 = t258 * t12;
  t343 = 0.12e2 * t136 * t64 * t67 * t17 * t30 * p->hyb_omega[0] - 0.9e1 * t305 * t306 * rho[0] * t114 + 0.24e2 * t316 * t322 * t19 * t324 - 0.72e2 * t131 * t132 * t18 + 0.24e2 * t328 * t329 * t18 - 0.16e2 * t143 * t250 + 0.16e2 * t49 * t250;
  t345 = t130 * t303 * t343;
  t349 = my_piecewise5(t41, t253 * t80 - t257 * t267, t82, (-0.3726e4 * t83 * rho[0] * t86 - 0.56e3 / 0.3e1 * t90 * t18 * t3 * t42 + 0.112e5 / 0.3e1 * t96 * t35 * t75 * t14) * t103 / 0.2016e6, -t294 * t156 / 0.18e2 - t298 * t156 / 0.27e2 + t129 * t345 / 0.18e2);
  t354 = params->kappa * t238 * t8;
  t356 = 0.3e1 / 0.56e2 * t237 * t241 * t243 + 0.27e2 / 0.28e2 * t27 * t29 * t349 + 0.8e1 / 0.3e1 * t354;
  t357 = t356 * t46;
  t358 = t357 * t171;
  t361 = t166 * t18;
  t362 = t361 * t171;
  t365 = t177 * t175;
  t366 = t179 * t365;
  t367 = 0.1e1 / t46;
  t371 = t34 * p->hyb_omega[0] * t367 * t37 / 0.18e2;
  t372 = my_piecewise3(t174, -t371, 0);
  t375 = t176 * t175;
  t376 = t179 * t375;
  t379 = t179 * t175;
  t382 = t177 * t375;
  t391 = 0.38896e5 * t175 * t372 + 0.18330624e9 * t365 * t372 + 0.3372443762688e15 * t366 * t372 - 0.323136e7 * t375 * t372 - 0.1083999780864e14 * t376 * t372 + 0.3226189824e12 * t379 * t372 - 0.836419584e10 * t382 * t372;
  t395 = 0.1e1 / t191 / t175;
  t396 = t190 * t395;
  t400 = t196 * t195;
  t401 = my_piecewise3(t174, 0, -t371);
  t402 = t400 * t401;
  t404 = t195 * t401;
  t406 = 0.128e3 * t402 - 0.32e2 * t404;
  t409 = 0.1e1 / t400;
  t410 = t200 * t409;
  t411 = t401 * t203;
  t415 = t203 * t207;
  t422 = my_piecewise3(t173, t391 * t192 / 0.8671998246912e15 - t396 * t372 / 0.541999890432e14, t406 * t203 / 0.3e1 + t410 * t411 / 0.6e1 - 0.128e3 / 0.3e1 * t402 + 0.8e1 / 0.3e1 * t415 * t401 - 0.8e1 / 0.3e1 * t210 * t401 + 0.16e2 * t404);
  t423 = t422 * t216;
  t424 = t423 * t226;
  t427 = t224 * t224;
  t428 = 0.1e1 / t427;
  t429 = t5 * t428;
  t430 = params->b_PBE * t349;
  t433 = t4 * t30;
  t434 = t218 * t433;
  t435 = t16 * t17;
  t438 = t435 * t239 * t25 * sigma[0];
  t442 = 0.864e3 * t430 * t220 + 0.48e2 * t434 * t438 + 0.7168e4 / 0.3e1 * t354;
  t443 = t429 * t442;
  t444 = t217 * t443;
  t448 = my_piecewise3(t2, 0, -0.84e2 * t172 * t424 + 0.84e2 * t172 * t444 - 0.84e2 * t358 * t227 - 0.112e3 * t362 * t227);
  tvrho0 = 0.2e1 * t448;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t449 = t30 * t28;
  t451 = t26 * t449 * t159;
  t453 = t46 * t170 * t17;
  t454 = t217 * t225;
  t455 = t453 * t454;
  t458 = t171 * t215;
  t459 = t167 * t458;
  t461 = t216 * t30 * t428;
  t463 = t461 * t218 * t25;
  t467 = my_piecewise3(t2, 0, -0.81e2 * t451 * t455 + 0.72576e5 * t459 * t463);
  tvsigma0 = 0.2e1 * t467;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t35, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t49, t50, t52;
  double t53, t55, t56, t57, t64, t66, t67, t68;
  double t69, t75, t76, t78, t79, t80, t82, t83;
  double t84, t86, t90, t96, t102, t103, t107, t108;
  double t113, t114, t115, t118, t119, t123, t127, t128;
  double t129, t130, t131, t132, t136, t143, t148, t153;
  double t156, t159, t163, t165, t166, t167, t170, t171;
  double t172, t173, t174, t175, t176, t177, t178, t179;
  double t182, t184, t190, t191, t192, t195, t196, t197;
  double t200, t203, t207, t209, t210, t215, t216, t217;
  double t218, t220, t224, t225, t226, t227, t230, t231;
  double tzk0;

  double t234, t237, t238, t239, t241, t242, t243, t247;
  double t249, t250, t251, t253, t255, t256, t257, t258;
  double t267, t293, t294, t297, t298, t301, t303, t304;
  double t305, t306, t316, t317, t318, t319, t320, t321;
  double t322, t324, t328, t329, t343, t345, t349, t354;
  double t356, t357, t358, t361, t362, t365, t366, t367;
  double t371, t372, t375, t376, t379, t382, t391, t395;
  double t396, t400, t401, t402, t404, t406, t409, t410;
  double t411, t415, t422, t423, t424, t427, t428, t429;
  double t430, t433, t434, t435, t438, t442, t443, t444;
  double t448, tvrho0, t449, t451, t453, t454, t455, t458;
  double t459, t461, t463, t467, tvsigma0;

  double t468, t470, t474, t475, t476, t478, t480, t481;
  double t483, t485, t489, t493, t496, t497, t499, t501;
  double t505, t506, t507, t510, t511, t515, t520, t547;
  double t548, t551, t556, t557, t563, t564, t565, t567;
  double t573, t574, t576, t577, t578, t591, t595, t596;
  double t601, t612, t614, t618, t623, t625, t626, t627;
  double t630, t631, t638, t639, t646, t650, t654, t655;
  double t681, t684, t688, t689, t695, t696, t698, t699;
  double t702, t704, t707, t710, t711, t712, t715, t719;
  double t720, t734, t735, t736, t737, t740, t744, t745;
  double t746, t747, t748, t751, t754, t759, t762, t763;
  double t764, t765, t768, t772, t773, t774, t777, t778;
  double tv2rho20, t780, t781, t783, t785, t786, t787, t788;
  double t793, t797, t798, t801, t802, t805, t806, t807;
  double t808, t809, t810, t811, t814, t817, t820, t821;
  double t824, t826, t827, t829, t830, t832, t836, t840;
  double t841, t842, t843, t844, t847, t848, t851, t852;
  double tv2rhosigma0, t853, t854, t855, t856, t857, t859, t861;
  double t864, t865, t866, t867, t871, tv2sigma20;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = p->hyb_omega[0] * p->hyb_omega[0];
  t4 = params->ax * t3;
  t5 = M_CBRT3;
  t7 = M_CBRTPI;
  t8 = t7 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = t12 * t12;
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t20 = 0.1e1 / t19;
  t25 = exp(-t4 * t5 * t16 * t17 * t20 / 0.12e2);
  t26 = params->b_PBE * t25;
  t27 = t26 * sigma[0];
  t28 = params->kappa + 0.1e1;
  t29 = t5 * t28;
  t30 = t5 * t5;
  t31 = t12 * t30;
  t32 = t7 * t7;
  t34 = t31 / t32;
  t35 = 0.1e1 / t18;
  t37 = 0.1e1 / t13;
  t40 = t34 * p->hyb_omega[0] * t35 * t37 / 0.6e1;
  t41 = t40 < 0.5e-1;
  t42 = t14 * t14;
  t43 = M_PI * M_PI;
  t44 = t32 * t43;
  t45 = t42 * t44;
  t46 = t18 * rho[0];
  t47 = t45 * t46;
  t49 = t14 * t8;
  t50 = t49 * t17;
  t52 = t5 * t19 * t3;
  t53 = t50 * t52;
  t55 = 0.7e1 * t47 - 0.6e1 * t53;
  t56 = t14 * t13;
  t57 = 0.1e1 / p->hyb_omega[0];
  t64 = erf(t57 * t5 * t32 * t13 * t17 * t18 / 0.2e1);
  t66 = sqrt(M_PI);
  t67 = t66 * t43;
  t68 = t56 * t64 * t67;
  t69 = rho[0] * p->hyb_omega[0];
  t75 = t3 * t3;
  t76 = t75 * t30;
  t78 = 0.12e2 * t76 * t12;
  t79 = -0.36e2 * t68 * t31 * t69 + 0.81e2 * t47 + 0.54e2 * t53 - t78;
  t80 = 0.1e1 / t79;
  t82 = 0.1e11 < t40;
  t83 = t43 * t43;
  t84 = rho[0] * rho[0];
  t86 = t42 * t14;
  t90 = t44 * t17 * t5;
  t96 = t8 * t12 * t30;
  t102 = t75 * t3;
  t103 = 0.1e1 / t102;
  t107 = 0.1e1 / t3;
  t108 = t107 * t30;
  t113 = t108 * t8 * t14 * t12 * t19 / 0.2e1;
  t114 = exp(t113);
  t115 = t114 * t8;
  t118 = t5 * t3;
  t119 = t14 * t17 * t118;
  t123 = t114 * t12;
  t127 = (0.7e1 * t115 * t19 * t119 - 0.12e2 * t123 * t76 + 0.6e1 * t47 + 0.11e2 * t53 + t78) * t8;
  t128 = t19 * t14;
  t129 = t127 * t128;
  t130 = t17 * t30;
  t131 = t42 * t114;
  t132 = t44 * t12;
  t136 = t56 * t114;
  t143 = t14 * t114 * t8;
  t148 = t114 * t17;
  t153 = 0.12e2 * t136 * t64 * t67 * t130 * t69 - 0.27e2 * t131 * t132 * t46 - 0.4e1 * t130 * t75 - 0.36e2 * t143 * t52 + 0.4e1 * t148 * t76 + 0.24e2 * t49 * t52;
  t156 = t130 * t107 / t153;
  t159 = my_piecewise5(t41, t55 * t80, t82, (0.56e4 * t96 * t19 * t75 * t14 - 0.14e3 * t90 * t46 * t3 * t42 - 0.1863e4 * t83 * t84 * t86) * t103 / 0.2016e6, -t129 * t156 / 0.18e2);
  t163 = t19 * t84;
  t165 = params->kappa * t163 * t8;
  t166 = 0.27e2 / 0.28e2 * t27 * t29 * t159 + t165;
  t167 = t166 * t46;
  t170 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t171 = t170 * t17;
  t172 = t167 * t171;
  t173 = 0.135e1 <= t40;
  t174 = 0.135e1 < t40;
  t175 = my_piecewise3(t174, t40, 0.135e1);
  t176 = t175 * t175;
  t177 = t176 * t176;
  t178 = t177 * t176;
  t179 = t177 * t177;
  t182 = t179 * t177;
  t184 = t179 * t176;
  t190 = 0.240888840192e14 * t179 * t178 + 0.19448e5 * t176 - 0.80784e6 * t177 + 0.3055104e8 * t178 - 0.104552448e10 * t179 - 0.90333315072e12 * t182 + 0.3226189824e11 * t184 - 0.429e3;
  t191 = t179 * t179;
  t192 = 0.1e1 / t191;
  t195 = my_piecewise3(t174, 0.135e1, t40);
  t196 = t195 * t195;
  t197 = t196 * t196;
  t200 = 0.32e2 * t197 - 0.16e2 * t196;
  t203 = exp(-0.1e1 / t196 / 0.4e1);
  t207 = 0.1e1 / t195;
  t209 = erf(t207 / 0.2e1);
  t210 = t66 * t209;
  t215 = my_piecewise3(t173, t190 * t192 / 0.8671998246912e15, t200 * t203 / 0.3e1 - 0.32e2 / 0.3e1 * t197 - 0.8e1 / 0.3e1 * t210 * t195 + 0.8e1 * t196 + 0.1e1);
  t216 = 0.1e1 / t7;
  t217 = t215 * t216;
  t218 = params->b_PBE * t159;
  t220 = t25 * sigma[0] * t5;
  t224 = 0.864e3 * t218 * t220 + 0.896e3 * t165;
  t225 = 0.1e1 / t224;
  t226 = t5 * t225;
  t227 = t217 * t226;
  t230 = my_piecewise3(t2, 0, -0.84e2 * t172 * t227);
  t231 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t230 * t231;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t234 = params->b_PBE * params->ax * t3;
  t237 = t234 * t30 * t9 * t15;
  t238 = t19 * rho[0];
  t239 = 0.1e1 / t238;
  t241 = t17 * t239 * t25;
  t242 = sigma[0] * t28;
  t243 = t242 * t159;
  t247 = t45 * t18;
  t249 = t5 * t35;
  t250 = t249 * t3;
  t251 = t50 * t250;
  t253 = 0.28e2 / 0.3e1 * t247 - 0.4e1 * t251;
  t255 = t79 * t79;
  t256 = 0.1e1 / t255;
  t257 = t55 * t256;
  t258 = exp(-t113);
  t267 = -0.72e2 * t45 * t258 * t18 - 0.36e2 * t68 * t31 * p->hyb_omega[0] + 0.108e3 * t247 + 0.36e2 * t251;
  t293 = (0.8e1 * t247 + 0.14e2 * t45 * t18 * t114 - 0.22e2 / 0.3e1 * t115 * t35 * t119 + 0.22e2 / 0.3e1 * t251) * t8;
  t294 = t293 * t128;
  t297 = t35 * t14;
  t298 = t127 * t297;
  t301 = t153 * t153;
  t303 = t107 / t301;
  t304 = t86 * t107;
  t305 = t304 * t30;
  t306 = t83 * t17;
  t316 = t42 * t13 * t57 * t5;
  t317 = t43 * M_PI;
  t318 = pow(M_PI, 0.1e1 / 0.6e1);
  t319 = t318 * t318;
  t320 = t319 * t319;
  t321 = t320 * t318;
  t322 = t321 * t317;
  t324 = t114 * t64;
  t328 = t131 * t44;
  t329 = t258 * t12;
  t343 = 0.12e2 * t136 * t64 * t67 * t17 * t30 * p->hyb_omega[0] - 0.9e1 * t305 * t306 * rho[0] * t114 + 0.24e2 * t316 * t322 * t19 * t324 - 0.72e2 * t131 * t132 * t18 + 0.24e2 * t328 * t329 * t18 - 0.16e2 * t143 * t250 + 0.16e2 * t49 * t250;
  t345 = t130 * t303 * t343;
  t349 = my_piecewise5(t41, t253 * t80 - t257 * t267, t82, (-0.3726e4 * t83 * rho[0] * t86 - 0.56e3 / 0.3e1 * t90 * t18 * t3 * t42 + 0.112e5 / 0.3e1 * t96 * t35 * t75 * t14) * t103 / 0.2016e6, -t294 * t156 / 0.18e2 - t298 * t156 / 0.27e2 + t129 * t345 / 0.18e2);
  t354 = params->kappa * t238 * t8;
  t356 = 0.3e1 / 0.56e2 * t237 * t241 * t243 + 0.27e2 / 0.28e2 * t27 * t29 * t349 + 0.8e1 / 0.3e1 * t354;
  t357 = t356 * t46;
  t358 = t357 * t171;
  t361 = t166 * t18;
  t362 = t361 * t171;
  t365 = t177 * t175;
  t366 = t179 * t365;
  t367 = 0.1e1 / t46;
  t371 = t34 * p->hyb_omega[0] * t367 * t37 / 0.18e2;
  t372 = my_piecewise3(t174, -t371, 0);
  t375 = t176 * t175;
  t376 = t179 * t375;
  t379 = t179 * t175;
  t382 = t177 * t375;
  t391 = 0.38896e5 * t175 * t372 + 0.18330624e9 * t365 * t372 + 0.3372443762688e15 * t366 * t372 - 0.323136e7 * t375 * t372 - 0.1083999780864e14 * t376 * t372 + 0.3226189824e12 * t379 * t372 - 0.836419584e10 * t382 * t372;
  t395 = 0.1e1 / t191 / t175;
  t396 = t190 * t395;
  t400 = t196 * t195;
  t401 = my_piecewise3(t174, 0, -t371);
  t402 = t400 * t401;
  t404 = t195 * t401;
  t406 = 0.128e3 * t402 - 0.32e2 * t404;
  t409 = 0.1e1 / t400;
  t410 = t200 * t409;
  t411 = t401 * t203;
  t415 = t203 * t207;
  t422 = my_piecewise3(t173, t391 * t192 / 0.8671998246912e15 - t396 * t372 / 0.541999890432e14, t406 * t203 / 0.3e1 + t410 * t411 / 0.6e1 - 0.128e3 / 0.3e1 * t402 + 0.8e1 / 0.3e1 * t415 * t401 - 0.8e1 / 0.3e1 * t210 * t401 + 0.16e2 * t404);
  t423 = t422 * t216;
  t424 = t423 * t226;
  t427 = t224 * t224;
  t428 = 0.1e1 / t427;
  t429 = t5 * t428;
  t430 = params->b_PBE * t349;
  t433 = t4 * t30;
  t434 = t218 * t433;
  t435 = t16 * t17;
  t438 = t435 * t239 * t25 * sigma[0];
  t442 = 0.864e3 * t430 * t220 + 0.48e2 * t434 * t438 + 0.7168e4 / 0.3e1 * t354;
  t443 = t429 * t442;
  t444 = t217 * t443;
  t448 = my_piecewise3(t2, 0, -0.84e2 * t172 * t424 + 0.84e2 * t172 * t444 - 0.84e2 * t358 * t227 - 0.112e3 * t362 * t227);
  tvrho0 = 0.2e1 * t448;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t449 = t30 * t28;
  t451 = t26 * t449 * t159;
  t453 = t46 * t170 * t17;
  t454 = t217 * t225;
  t455 = t453 * t454;
  t458 = t171 * t215;
  t459 = t167 * t458;
  t461 = t216 * t30 * t428;
  t463 = t461 * t218 * t25;
  t467 = my_piecewise3(t2, 0, -0.81e2 * t451 * t455 + 0.72576e5 * t459 * t463);
  tvsigma0 = 0.2e1 * t467;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t468 = 0.1e1 / t163;
  t470 = t17 * t468 * t25;
  t474 = params->ax * params->ax;
  t475 = params->b_PBE * t474;
  t476 = 0.1e1 / t44;
  t478 = 0.1e1 / t42;
  t480 = t475 * t75 * t476 * t478;
  t481 = t84 * rho[0];
  t483 = 0.1e1 / t18 / t481;
  t485 = t12 * t483 * t25;
  t489 = t242 * t349;
  t493 = t45 * t20;
  t496 = t5 * t367 * t3;
  t497 = t50 * t496;
  t499 = 0.28e2 / 0.9e1 * t493 + 0.4e1 / 0.3e1 * t497;
  t501 = t253 * t256;
  t505 = 0.1e1 / t255 / t79;
  t506 = t55 * t505;
  t507 = t267 * t267;
  t510 = t86 * t83;
  t511 = t510 * t107;
  t515 = t258 * t20;
  t520 = 0.24e2 * t511 * t31 * t258 - 0.96e2 * t45 * t515 + 0.36e2 * t493 - 0.12e2 * t497;
  t547 = (0.8e1 / 0.3e1 * t493 - 0.1e2 * t45 * t20 * t114 + 0.14e2 / 0.3e1 * t511 * t31 * t114 + 0.22e2 / 0.9e1 * t115 * t367 * t119 - 0.22e2 / 0.9e1 * t497) * t8;
  t548 = t547 * t128;
  t551 = t293 * t297;
  t556 = t367 * t14;
  t557 = t127 * t556;
  t563 = 0.1e1 / t301 / t153;
  t564 = t107 * t563;
  t565 = t343 * t343;
  t567 = t130 * t564 * t565;
  t573 = t42 * t42;
  t574 = 0.1e1 / t75;
  t576 = t573 * t574 * t5;
  t577 = t83 * M_PI;
  t578 = t7 * t577;
  t591 = t3 * p->hyb_omega[0];
  t595 = t42 * t56 / t591 * t318 * t577;
  t596 = t18 * t12;
  t601 = t258 * t17;
  t612 = -0.33e2 * t305 * t306 * t114 - 0.18e2 * t576 * t578 * t19 * t114 - 0.4e2 * t131 * t132 * t20 + 0.4e2 * t316 * t322 * t35 * t324 + 0.24e2 * t595 * t596 * t324 + 0.8e1 * t305 * t83 * t114 * t601 + 0.32e2 * t328 * t329 * t20 + 0.16e2 / 0.3e1 * t143 * t496 - 0.16e2 / 0.3e1 * t49 * t496;
  t614 = t130 * t303 * t612;
  t618 = my_piecewise5(t41, -t257 * t520 - 0.2e1 * t501 * t267 + t499 * t80 + 0.2e1 * t506 * t507, t82, (-0.3726e4 * t510 - 0.56e3 / 0.9e1 * t90 * t20 * t3 * t42 - 0.112e5 / 0.9e1 * t96 * t367 * t75 * t14) * t103 / 0.2016e6, -t548 * t156 / 0.18e2 - 0.2e1 / 0.27e2 * t551 * t156 + t294 * t345 / 0.9e1 + t557 * t156 / 0.81e2 + 0.2e1 / 0.27e2 * t298 * t345 - t129 * t567 / 0.9e1 + t129 * t614 / 0.18e2);
  t623 = params->kappa * t19 * t8;
  t625 = -0.5e1 / 0.56e2 * t237 * t470 * t243 + t480 * t485 * t243 / 0.56e2 + 0.3e1 / 0.28e2 * t237 * t241 * t489 + 0.27e2 / 0.28e2 * t27 * t29 * t618 + 0.4e2 / 0.9e1 * t623;
  t626 = t625 * t46;
  t627 = t626 * t171;
  t630 = t356 * t18;
  t631 = t630 * t171;
  t638 = t166 * t20;
  t639 = t638 * t171;
  t646 = t372 * t372;
  t650 = 0.1e1 / t18 / t84;
  t654 = 0.2e1 / 0.27e2 * t34 * p->hyb_omega[0] * t650 * t37;
  t655 = my_piecewise3(t174, t654, 0);
  t681 = 0.38896e5 * t175 * t655 - 0.969408e7 * t176 * t646 + 0.9165312e9 * t177 * t646 - 0.5854937088e11 * t178 * t646 + 0.29035708416e13 * t179 * t646 + 0.43841768914944e16 * t182 * t646 - 0.11923997589504e15 * t184 * t646 + 0.18330624e9 * t365 * t655 + 0.3372443762688e15 * t366 * t655 - 0.323136e7 * t375 * t655 - 0.1083999780864e14 * t376 * t655 + 0.3226189824e12 * t379 * t655 - 0.836419584e10 * t382 * t655 + 0.38896e5 * t646;
  t684 = t391 * t395;
  t688 = 0.1e1 / t191 / t176;
  t689 = t190 * t688;
  t695 = t401 * t401;
  t696 = t196 * t695;
  t698 = my_piecewise3(t174, 0, t654);
  t699 = t400 * t698;
  t702 = t195 * t698;
  t704 = 0.384e3 * t696 + 0.128e3 * t699 - 0.32e2 * t695 - 0.32e2 * t702;
  t707 = t406 * t409;
  t710 = 0.1e1 / t197;
  t711 = t200 * t710;
  t712 = t695 * t203;
  t715 = t698 * t203;
  t719 = 0.1e1 / t197 / t196;
  t720 = t200 * t719;
  t734 = t704 * t203 / 0.3e1 + t707 * t411 / 0.3e1 - t711 * t712 / 0.2e1 + t410 * t715 / 0.6e1 + t720 * t712 / 0.12e2 - 0.128e3 * t696 - 0.128e3 / 0.3e1 * t699 + 0.4e1 / 0.3e1 * t710 * t695 * t203 + 0.8e1 / 0.3e1 * t415 * t698 - 0.8e1 / 0.3e1 * t210 * t698 + 0.16e2 * t695 + 0.16e2 * t702;
  t735 = my_piecewise3(t173, t681 * t192 / 0.8671998246912e15 - t684 * t372 / 0.270999945216e14 + t689 * t646 / 0.31882346496e13 - t396 * t655 / 0.541999890432e14, t734);
  t736 = t735 * t216;
  t737 = t736 * t226;
  t740 = t423 * t443;
  t744 = 0.1e1 / t427 / t224;
  t745 = t5 * t744;
  t746 = t442 * t442;
  t747 = t745 * t746;
  t748 = t217 * t747;
  t751 = params->b_PBE * t618;
  t754 = t430 * t433;
  t759 = t435 * t468 * t25 * sigma[0];
  t762 = t474 * t75;
  t763 = t762 * t476;
  t764 = t218 * t763;
  t765 = t478 * t12;
  t768 = t765 * t483 * t25 * sigma[0];
  t772 = 0.864e3 * t751 * t220 + 0.96e2 * t754 * t438 - 0.8e2 * t434 * t759 + 0.16e2 * t764 * t768 + 0.3584e5 / 0.9e1 * t623;
  t773 = t429 * t772;
  t774 = t217 * t773;
  t777 = -0.84e2 * t627 * t227 - 0.224e3 * t631 * t227 - 0.168e3 * t358 * t424 + 0.168e3 * t358 * t444 - 0.112e3 / 0.3e1 * t639 * t227 - 0.224e3 * t362 * t424 + 0.224e3 * t362 * t444 - 0.84e2 * t172 * t737 + 0.168e3 * t172 * t740 - 0.168e3 * t172 * t748 + 0.84e2 * t172 * t774;
  t778 = my_piecewise3(t2, 0, t777);
  tv2rho20 = 0.2e1 * t778;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t780 = 0.1e1 / t32 / M_PI;
  t781 = t780 * t15;
  t783 = t234 * t781 * t12;
  t785 = t35 * t25 * t28;
  t786 = t159 * t170;
  t787 = t215 * t225;
  t788 = t786 * t787;
  t793 = t26 * t449 * t349;
  t797 = t18 * t170 * t17;
  t798 = t797 * t454;
  t801 = t423 * t225;
  t802 = t453 * t801;
  t805 = t26 * t30;
  t806 = t28 * t159;
  t807 = t806 * t46;
  t808 = t805 * t807;
  t809 = t216 * t428;
  t810 = t809 * t442;
  t811 = t458 * t810;
  t814 = t357 * t458;
  t817 = t361 * t458;
  t820 = t171 * t422;
  t821 = t167 * t820;
  t824 = t167 * t170;
  t826 = t17 * t215 * t216;
  t827 = t824 * t826;
  t829 = t30 * t744 * params->b_PBE;
  t830 = t159 * t25;
  t832 = t829 * t830 * t442;
  t836 = t461 * t430 * t25;
  t840 = t166 * t35 * t170;
  t841 = t12 * t215;
  t842 = t841 * t780;
  t843 = t840 * t842;
  t844 = t428 * params->b_PBE;
  t847 = t4 * t15 * t25;
  t848 = t844 * t159 * t847;
  t851 = -0.27e2 * t783 * t785 * t788 - 0.108e3 * t451 * t798 - 0.81e2 * t451 * t802 - 0.81e2 * t793 * t455 + 0.72576e5 * t459 * t836 + 0.72576e5 * t814 * t463 + 0.96768e5 * t817 * t463 + 0.72576e5 * t821 * t463 + 0.81e2 * t808 * t811 - 0.145152e6 * t827 * t832 + 0.24192e5 * t843 * t848;
  t852 = my_piecewise3(t2, 0, t851);
  tv2rhosigma0 = 0.2e1 * t852;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t853 = params->b_PBE * params->b_PBE;
  t854 = t25 * t25;
  t855 = t853 * t854;
  t856 = t159 * t159;
  t857 = t28 * t856;
  t859 = t855 * t857 * t46;
  t861 = t171 * t217 * t428;
  t864 = t216 * t744;
  t865 = t853 * t856;
  t866 = t865 * t854;
  t867 = t864 * t866;
  t871 = my_piecewise3(t2, 0, -0.376233984e9 * t459 * t867 + 0.419904e6 * t859 * t861);
  tv2sigma20 = 0.2e1 * t871;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t35, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t49, t50, t52;
  double t53, t55, t56, t57, t64, t66, t67, t68;
  double t69, t75, t76, t78, t79, t80, t82, t83;
  double t84, t86, t90, t96, t102, t103, t107, t108;
  double t113, t114, t115, t118, t119, t123, t127, t128;
  double t129, t130, t131, t132, t136, t143, t148, t153;
  double t156, t159, t163, t165, t166, t167, t170, t171;
  double t172, t173, t174, t175, t176, t177, t178, t179;
  double t182, t184, t190, t191, t192, t195, t196, t197;
  double t200, t203, t207, t209, t210, t215, t216, t217;
  double t218, t220, t224, t225, t226, t227, t230, t231;
  double tzk0;

  double t234, t237, t238, t239, t241, t242, t243, t247;
  double t249, t250, t251, t253, t255, t256, t257, t258;
  double t267, t293, t294, t297, t298, t301, t303, t304;
  double t305, t306, t316, t317, t318, t319, t320, t321;
  double t322, t324, t328, t329, t343, t345, t349, t354;
  double t356, t357, t358, t361, t362, t365, t366, t367;
  double t371, t372, t375, t376, t379, t382, t391, t395;
  double t396, t400, t401, t402, t404, t406, t409, t410;
  double t411, t415, t422, t423, t424, t427, t428, t429;
  double t430, t433, t434, t435, t438, t442, t443, t444;
  double t448, tvrho0, t449, t451, t453, t454, t455, t458;
  double t459, t461, t463, t467, tvsigma0;

  double t468, t470, t474, t475, t476, t478, t480, t481;
  double t483, t485, t489, t493, t496, t497, t499, t501;
  double t505, t506, t507, t510, t511, t515, t520, t547;
  double t548, t551, t556, t557, t563, t564, t565, t567;
  double t573, t574, t576, t577, t578, t591, t595, t596;
  double t601, t612, t614, t618, t623, t625, t626, t627;
  double t630, t631, t638, t639, t646, t650, t654, t655;
  double t681, t684, t688, t689, t695, t696, t698, t699;
  double t702, t704, t707, t710, t711, t712, t715, t719;
  double t720, t734, t735, t736, t737, t740, t744, t745;
  double t746, t747, t748, t751, t754, t759, t762, t763;
  double t764, t765, t768, t772, t773, t774, t777, t778;
  double tv2rho20, t780, t781, t783, t785, t786, t787, t788;
  double t793, t797, t798, t801, t802, t805, t806, t807;
  double t808, t809, t810, t811, t814, t817, t820, t821;
  double t824, t826, t827, t829, t830, t832, t836, t840;
  double t841, t842, t843, t844, t847, t848, t851, t852;
  double tv2rhosigma0, t853, t854, t855, t856, t857, t859, t861;
  double t864, t865, t866, t867, t871, tv2sigma20;

  double t872, t891, t894, t895, t896, t897, t898, t899;
  double t904, t905, t908, t909, t911, t913, t916, t921;
  double t922, t923, t924, t927, t930, t931, t932, t946;
  double t964, t965, t976, t978, t979, t980, t984, t995;
  double t1000, t1007, t1008, t1010, t1013, t1014, t1025, t1027;
  double t1030, t1031, t1032, t1035, t1042, t1043, t1047, t1050;
  double t1055, t1063, t1074, t1075, t1078, t1079, t1080, t1083;
  double t1088, t1092, t1095, t1098, t1100, t1103, t1106, t1108;
  double t1109, t1110, t1111, t1112, t1113, t1115, t1119, t1121;
  double t1122, t1123, t1126, t1129, t1132, t1138, t1143, t1150;
  double t1153, t1155, t1162, t1170, t1171, t1172, t1175, t1176;
  double t1179, t1180, t1183, t1184, t1192, t1193, t1206, t1210;
  double t1241, t1244, t1247, t1253, t1254, t1262, t1266, t1267;
  double t1268, t1269, t1272, t1278, t1279, t1282, t1283, t1286;
  double t1288, t1289, t1295, t1298, t1304, t1307, t1309, t1310;
  double t1312, t1314, t1316, t1318, t1333, t1335, t1336, t1337;
  double t1346, t1348, tv3rho30, t1349, t1351, t1352, t1353, t1354;
  double t1355, t1358, t1359, t1360, t1364, t1368, t1369, t1373;
  double t1374, t1377, t1378, t1379, t1382, t1383, t1387, t1388;
  double t1392, t1393, t1395, t1396, t1397, t1401, t1405, t1406;
  double t1407, t1408, t1409, t1410, t1411, t1412, t1415, t1416;
  double t1419, t1420, t1424, t1425, t1428, t1429, t1432, t1434;
  double t1440, t1441, t1444, t1445, t1450, t1452, t1455, t1458;
  double t1463, t1470, t1473, t1474, t1478, t1481, t1484, t1487;
  double t1488, t1491, t1495, t1497, t1500, t1501, t1504, t1506;
  double t1510, t1515, t1516, t1517, t1518, t1519, t1520, t1521;
  double t1524, t1526, tv3rho2sigma0, t1527, t1529, t1531, t1532, t1535;
  double t1536, t1539, t1540, t1541, t1545, t1549, t1552, t1553;
  double t1562, t1563, t1564, t1566, t1569, t1570, t1572, t1575;
  double t1578, t1579, tv3rhosigma20, t1580, t1581, t1582, t1583, t1584;
  double t1586, t1587, t1588, t1594, t1598, tv3sigma30;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = p->hyb_omega[0] * p->hyb_omega[0];
  t4 = params->ax * t3;
  t5 = M_CBRT3;
  t7 = M_CBRTPI;
  t8 = t7 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = t12 * t12;
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t20 = 0.1e1 / t19;
  t25 = exp(-t4 * t5 * t16 * t17 * t20 / 0.12e2);
  t26 = params->b_PBE * t25;
  t27 = t26 * sigma[0];
  t28 = params->kappa + 0.1e1;
  t29 = t5 * t28;
  t30 = t5 * t5;
  t31 = t12 * t30;
  t32 = t7 * t7;
  t34 = t31 / t32;
  t35 = 0.1e1 / t18;
  t37 = 0.1e1 / t13;
  t40 = t34 * p->hyb_omega[0] * t35 * t37 / 0.6e1;
  t41 = t40 < 0.5e-1;
  t42 = t14 * t14;
  t43 = M_PI * M_PI;
  t44 = t32 * t43;
  t45 = t42 * t44;
  t46 = t18 * rho[0];
  t47 = t45 * t46;
  t49 = t14 * t8;
  t50 = t49 * t17;
  t52 = t5 * t19 * t3;
  t53 = t50 * t52;
  t55 = 0.7e1 * t47 - 0.6e1 * t53;
  t56 = t14 * t13;
  t57 = 0.1e1 / p->hyb_omega[0];
  t64 = erf(t57 * t5 * t32 * t13 * t17 * t18 / 0.2e1);
  t66 = sqrt(M_PI);
  t67 = t66 * t43;
  t68 = t56 * t64 * t67;
  t69 = rho[0] * p->hyb_omega[0];
  t75 = t3 * t3;
  t76 = t75 * t30;
  t78 = 0.12e2 * t76 * t12;
  t79 = -0.36e2 * t68 * t31 * t69 + 0.81e2 * t47 + 0.54e2 * t53 - t78;
  t80 = 0.1e1 / t79;
  t82 = 0.1e11 < t40;
  t83 = t43 * t43;
  t84 = rho[0] * rho[0];
  t86 = t42 * t14;
  t90 = t44 * t17 * t5;
  t96 = t8 * t12 * t30;
  t102 = t75 * t3;
  t103 = 0.1e1 / t102;
  t107 = 0.1e1 / t3;
  t108 = t107 * t30;
  t113 = t108 * t8 * t14 * t12 * t19 / 0.2e1;
  t114 = exp(t113);
  t115 = t114 * t8;
  t118 = t5 * t3;
  t119 = t14 * t17 * t118;
  t123 = t114 * t12;
  t127 = (0.7e1 * t115 * t19 * t119 - 0.12e2 * t123 * t76 + 0.6e1 * t47 + 0.11e2 * t53 + t78) * t8;
  t128 = t19 * t14;
  t129 = t127 * t128;
  t130 = t17 * t30;
  t131 = t42 * t114;
  t132 = t44 * t12;
  t136 = t56 * t114;
  t143 = t14 * t114 * t8;
  t148 = t114 * t17;
  t153 = 0.12e2 * t136 * t64 * t67 * t130 * t69 - 0.27e2 * t131 * t132 * t46 - 0.4e1 * t130 * t75 - 0.36e2 * t143 * t52 + 0.4e1 * t148 * t76 + 0.24e2 * t49 * t52;
  t156 = t130 * t107 / t153;
  t159 = my_piecewise5(t41, t55 * t80, t82, (0.56e4 * t96 * t19 * t75 * t14 - 0.14e3 * t90 * t46 * t3 * t42 - 0.1863e4 * t83 * t84 * t86) * t103 / 0.2016e6, -t129 * t156 / 0.18e2);
  t163 = t19 * t84;
  t165 = params->kappa * t163 * t8;
  t166 = 0.27e2 / 0.28e2 * t27 * t29 * t159 + t165;
  t167 = t166 * t46;
  t170 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t171 = t170 * t17;
  t172 = t167 * t171;
  t173 = 0.135e1 <= t40;
  t174 = 0.135e1 < t40;
  t175 = my_piecewise3(t174, t40, 0.135e1);
  t176 = t175 * t175;
  t177 = t176 * t176;
  t178 = t177 * t176;
  t179 = t177 * t177;
  t182 = t179 * t177;
  t184 = t179 * t176;
  t190 = 0.240888840192e14 * t179 * t178 + 0.19448e5 * t176 - 0.80784e6 * t177 + 0.3055104e8 * t178 - 0.104552448e10 * t179 - 0.90333315072e12 * t182 + 0.3226189824e11 * t184 - 0.429e3;
  t191 = t179 * t179;
  t192 = 0.1e1 / t191;
  t195 = my_piecewise3(t174, 0.135e1, t40);
  t196 = t195 * t195;
  t197 = t196 * t196;
  t200 = 0.32e2 * t197 - 0.16e2 * t196;
  t203 = exp(-0.1e1 / t196 / 0.4e1);
  t207 = 0.1e1 / t195;
  t209 = erf(t207 / 0.2e1);
  t210 = t66 * t209;
  t215 = my_piecewise3(t173, t190 * t192 / 0.8671998246912e15, t200 * t203 / 0.3e1 - 0.32e2 / 0.3e1 * t197 - 0.8e1 / 0.3e1 * t210 * t195 + 0.8e1 * t196 + 0.1e1);
  t216 = 0.1e1 / t7;
  t217 = t215 * t216;
  t218 = params->b_PBE * t159;
  t220 = t25 * sigma[0] * t5;
  t224 = 0.864e3 * t218 * t220 + 0.896e3 * t165;
  t225 = 0.1e1 / t224;
  t226 = t5 * t225;
  t227 = t217 * t226;
  t230 = my_piecewise3(t2, 0, -0.84e2 * t172 * t227);
  t231 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t230 * t231;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t234 = params->b_PBE * params->ax * t3;
  t237 = t234 * t30 * t9 * t15;
  t238 = t19 * rho[0];
  t239 = 0.1e1 / t238;
  t241 = t17 * t239 * t25;
  t242 = sigma[0] * t28;
  t243 = t242 * t159;
  t247 = t45 * t18;
  t249 = t5 * t35;
  t250 = t249 * t3;
  t251 = t50 * t250;
  t253 = 0.28e2 / 0.3e1 * t247 - 0.4e1 * t251;
  t255 = t79 * t79;
  t256 = 0.1e1 / t255;
  t257 = t55 * t256;
  t258 = exp(-t113);
  t267 = -0.72e2 * t45 * t258 * t18 - 0.36e2 * t68 * t31 * p->hyb_omega[0] + 0.108e3 * t247 + 0.36e2 * t251;
  t293 = (0.8e1 * t247 + 0.14e2 * t45 * t18 * t114 - 0.22e2 / 0.3e1 * t115 * t35 * t119 + 0.22e2 / 0.3e1 * t251) * t8;
  t294 = t293 * t128;
  t297 = t35 * t14;
  t298 = t127 * t297;
  t301 = t153 * t153;
  t303 = t107 / t301;
  t304 = t86 * t107;
  t305 = t304 * t30;
  t306 = t83 * t17;
  t316 = t42 * t13 * t57 * t5;
  t317 = t43 * M_PI;
  t318 = pow(M_PI, 0.1e1 / 0.6e1);
  t319 = t318 * t318;
  t320 = t319 * t319;
  t321 = t320 * t318;
  t322 = t321 * t317;
  t324 = t114 * t64;
  t328 = t131 * t44;
  t329 = t258 * t12;
  t343 = 0.12e2 * t136 * t64 * t67 * t17 * t30 * p->hyb_omega[0] - 0.9e1 * t305 * t306 * rho[0] * t114 + 0.24e2 * t316 * t322 * t19 * t324 - 0.72e2 * t131 * t132 * t18 + 0.24e2 * t328 * t329 * t18 - 0.16e2 * t143 * t250 + 0.16e2 * t49 * t250;
  t345 = t130 * t303 * t343;
  t349 = my_piecewise5(t41, t253 * t80 - t257 * t267, t82, (-0.3726e4 * t83 * rho[0] * t86 - 0.56e3 / 0.3e1 * t90 * t18 * t3 * t42 + 0.112e5 / 0.3e1 * t96 * t35 * t75 * t14) * t103 / 0.2016e6, -t294 * t156 / 0.18e2 - t298 * t156 / 0.27e2 + t129 * t345 / 0.18e2);
  t354 = params->kappa * t238 * t8;
  t356 = 0.3e1 / 0.56e2 * t237 * t241 * t243 + 0.27e2 / 0.28e2 * t27 * t29 * t349 + 0.8e1 / 0.3e1 * t354;
  t357 = t356 * t46;
  t358 = t357 * t171;
  t361 = t166 * t18;
  t362 = t361 * t171;
  t365 = t177 * t175;
  t366 = t179 * t365;
  t367 = 0.1e1 / t46;
  t371 = t34 * p->hyb_omega[0] * t367 * t37 / 0.18e2;
  t372 = my_piecewise3(t174, -t371, 0);
  t375 = t176 * t175;
  t376 = t179 * t375;
  t379 = t179 * t175;
  t382 = t177 * t375;
  t391 = 0.38896e5 * t175 * t372 + 0.18330624e9 * t365 * t372 + 0.3372443762688e15 * t366 * t372 - 0.323136e7 * t375 * t372 - 0.1083999780864e14 * t376 * t372 + 0.3226189824e12 * t379 * t372 - 0.836419584e10 * t382 * t372;
  t395 = 0.1e1 / t191 / t175;
  t396 = t190 * t395;
  t400 = t196 * t195;
  t401 = my_piecewise3(t174, 0, -t371);
  t402 = t400 * t401;
  t404 = t195 * t401;
  t406 = 0.128e3 * t402 - 0.32e2 * t404;
  t409 = 0.1e1 / t400;
  t410 = t200 * t409;
  t411 = t401 * t203;
  t415 = t203 * t207;
  t422 = my_piecewise3(t173, t391 * t192 / 0.8671998246912e15 - t396 * t372 / 0.541999890432e14, t406 * t203 / 0.3e1 + t410 * t411 / 0.6e1 - 0.128e3 / 0.3e1 * t402 + 0.8e1 / 0.3e1 * t415 * t401 - 0.8e1 / 0.3e1 * t210 * t401 + 0.16e2 * t404);
  t423 = t422 * t216;
  t424 = t423 * t226;
  t427 = t224 * t224;
  t428 = 0.1e1 / t427;
  t429 = t5 * t428;
  t430 = params->b_PBE * t349;
  t433 = t4 * t30;
  t434 = t218 * t433;
  t435 = t16 * t17;
  t438 = t435 * t239 * t25 * sigma[0];
  t442 = 0.864e3 * t430 * t220 + 0.48e2 * t434 * t438 + 0.7168e4 / 0.3e1 * t354;
  t443 = t429 * t442;
  t444 = t217 * t443;
  t448 = my_piecewise3(t2, 0, -0.84e2 * t172 * t424 + 0.84e2 * t172 * t444 - 0.84e2 * t358 * t227 - 0.112e3 * t362 * t227);
  tvrho0 = 0.2e1 * t448;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t449 = t30 * t28;
  t451 = t26 * t449 * t159;
  t453 = t46 * t170 * t17;
  t454 = t217 * t225;
  t455 = t453 * t454;
  t458 = t171 * t215;
  t459 = t167 * t458;
  t461 = t216 * t30 * t428;
  t463 = t461 * t218 * t25;
  t467 = my_piecewise3(t2, 0, -0.81e2 * t451 * t455 + 0.72576e5 * t459 * t463);
  tvsigma0 = 0.2e1 * t467;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t468 = 0.1e1 / t163;
  t470 = t17 * t468 * t25;
  t474 = params->ax * params->ax;
  t475 = params->b_PBE * t474;
  t476 = 0.1e1 / t44;
  t478 = 0.1e1 / t42;
  t480 = t475 * t75 * t476 * t478;
  t481 = t84 * rho[0];
  t483 = 0.1e1 / t18 / t481;
  t485 = t12 * t483 * t25;
  t489 = t242 * t349;
  t493 = t45 * t20;
  t496 = t5 * t367 * t3;
  t497 = t50 * t496;
  t499 = 0.28e2 / 0.9e1 * t493 + 0.4e1 / 0.3e1 * t497;
  t501 = t253 * t256;
  t505 = 0.1e1 / t255 / t79;
  t506 = t55 * t505;
  t507 = t267 * t267;
  t510 = t86 * t83;
  t511 = t510 * t107;
  t515 = t258 * t20;
  t520 = 0.24e2 * t511 * t31 * t258 - 0.96e2 * t45 * t515 + 0.36e2 * t493 - 0.12e2 * t497;
  t547 = (0.8e1 / 0.3e1 * t493 - 0.1e2 * t45 * t20 * t114 + 0.14e2 / 0.3e1 * t511 * t31 * t114 + 0.22e2 / 0.9e1 * t115 * t367 * t119 - 0.22e2 / 0.9e1 * t497) * t8;
  t548 = t547 * t128;
  t551 = t293 * t297;
  t556 = t367 * t14;
  t557 = t127 * t556;
  t563 = 0.1e1 / t301 / t153;
  t564 = t107 * t563;
  t565 = t343 * t343;
  t567 = t130 * t564 * t565;
  t573 = t42 * t42;
  t574 = 0.1e1 / t75;
  t576 = t573 * t574 * t5;
  t577 = t83 * M_PI;
  t578 = t7 * t577;
  t591 = t3 * p->hyb_omega[0];
  t595 = t42 * t56 / t591 * t318 * t577;
  t596 = t18 * t12;
  t601 = t258 * t17;
  t612 = -0.33e2 * t305 * t306 * t114 - 0.18e2 * t576 * t578 * t19 * t114 - 0.4e2 * t131 * t132 * t20 + 0.4e2 * t316 * t322 * t35 * t324 + 0.24e2 * t595 * t596 * t324 + 0.8e1 * t305 * t83 * t114 * t601 + 0.32e2 * t328 * t329 * t20 + 0.16e2 / 0.3e1 * t143 * t496 - 0.16e2 / 0.3e1 * t49 * t496;
  t614 = t130 * t303 * t612;
  t618 = my_piecewise5(t41, -t257 * t520 - 0.2e1 * t501 * t267 + t499 * t80 + 0.2e1 * t506 * t507, t82, (-0.3726e4 * t510 - 0.56e3 / 0.9e1 * t90 * t20 * t3 * t42 - 0.112e5 / 0.9e1 * t96 * t367 * t75 * t14) * t103 / 0.2016e6, -t548 * t156 / 0.18e2 - 0.2e1 / 0.27e2 * t551 * t156 + t294 * t345 / 0.9e1 + t557 * t156 / 0.81e2 + 0.2e1 / 0.27e2 * t298 * t345 - t129 * t567 / 0.9e1 + t129 * t614 / 0.18e2);
  t623 = params->kappa * t19 * t8;
  t625 = -0.5e1 / 0.56e2 * t237 * t470 * t243 + t480 * t485 * t243 / 0.56e2 + 0.3e1 / 0.28e2 * t237 * t241 * t489 + 0.27e2 / 0.28e2 * t27 * t29 * t618 + 0.4e2 / 0.9e1 * t623;
  t626 = t625 * t46;
  t627 = t626 * t171;
  t630 = t356 * t18;
  t631 = t630 * t171;
  t638 = t166 * t20;
  t639 = t638 * t171;
  t646 = t372 * t372;
  t650 = 0.1e1 / t18 / t84;
  t654 = 0.2e1 / 0.27e2 * t34 * p->hyb_omega[0] * t650 * t37;
  t655 = my_piecewise3(t174, t654, 0);
  t681 = 0.38896e5 * t175 * t655 - 0.969408e7 * t176 * t646 + 0.9165312e9 * t177 * t646 - 0.5854937088e11 * t178 * t646 + 0.29035708416e13 * t179 * t646 + 0.43841768914944e16 * t182 * t646 - 0.11923997589504e15 * t184 * t646 + 0.18330624e9 * t365 * t655 + 0.3372443762688e15 * t366 * t655 - 0.323136e7 * t375 * t655 - 0.1083999780864e14 * t376 * t655 + 0.3226189824e12 * t379 * t655 - 0.836419584e10 * t382 * t655 + 0.38896e5 * t646;
  t684 = t391 * t395;
  t688 = 0.1e1 / t191 / t176;
  t689 = t190 * t688;
  t695 = t401 * t401;
  t696 = t196 * t695;
  t698 = my_piecewise3(t174, 0, t654);
  t699 = t400 * t698;
  t702 = t195 * t698;
  t704 = 0.384e3 * t696 + 0.128e3 * t699 - 0.32e2 * t695 - 0.32e2 * t702;
  t707 = t406 * t409;
  t710 = 0.1e1 / t197;
  t711 = t200 * t710;
  t712 = t695 * t203;
  t715 = t698 * t203;
  t719 = 0.1e1 / t197 / t196;
  t720 = t200 * t719;
  t734 = t704 * t203 / 0.3e1 + t707 * t411 / 0.3e1 - t711 * t712 / 0.2e1 + t410 * t715 / 0.6e1 + t720 * t712 / 0.12e2 - 0.128e3 * t696 - 0.128e3 / 0.3e1 * t699 + 0.4e1 / 0.3e1 * t710 * t695 * t203 + 0.8e1 / 0.3e1 * t415 * t698 - 0.8e1 / 0.3e1 * t210 * t698 + 0.16e2 * t695 + 0.16e2 * t702;
  t735 = my_piecewise3(t173, t681 * t192 / 0.8671998246912e15 - t684 * t372 / 0.270999945216e14 + t689 * t646 / 0.31882346496e13 - t396 * t655 / 0.541999890432e14, t734);
  t736 = t735 * t216;
  t737 = t736 * t226;
  t740 = t423 * t443;
  t744 = 0.1e1 / t427 / t224;
  t745 = t5 * t744;
  t746 = t442 * t442;
  t747 = t745 * t746;
  t748 = t217 * t747;
  t751 = params->b_PBE * t618;
  t754 = t430 * t433;
  t759 = t435 * t468 * t25 * sigma[0];
  t762 = t474 * t75;
  t763 = t762 * t476;
  t764 = t218 * t763;
  t765 = t478 * t12;
  t768 = t765 * t483 * t25 * sigma[0];
  t772 = 0.864e3 * t751 * t220 + 0.96e2 * t754 * t438 - 0.8e2 * t434 * t759 + 0.16e2 * t764 * t768 + 0.3584e5 / 0.9e1 * t623;
  t773 = t429 * t772;
  t774 = t217 * t773;
  t777 = -0.84e2 * t627 * t227 - 0.224e3 * t631 * t227 - 0.168e3 * t358 * t424 + 0.168e3 * t358 * t444 - 0.112e3 / 0.3e1 * t639 * t227 - 0.224e3 * t362 * t424 + 0.224e3 * t362 * t444 - 0.84e2 * t172 * t737 + 0.168e3 * t172 * t740 - 0.168e3 * t172 * t748 + 0.84e2 * t172 * t774;
  t778 = my_piecewise3(t2, 0, t777);
  tv2rho20 = 0.2e1 * t778;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t780 = 0.1e1 / t32 / M_PI;
  t781 = t780 * t15;
  t783 = t234 * t781 * t12;
  t785 = t35 * t25 * t28;
  t786 = t159 * t170;
  t787 = t215 * t225;
  t788 = t786 * t787;
  t793 = t26 * t449 * t349;
  t797 = t18 * t170 * t17;
  t798 = t797 * t454;
  t801 = t423 * t225;
  t802 = t453 * t801;
  t805 = t26 * t30;
  t806 = t28 * t159;
  t807 = t806 * t46;
  t808 = t805 * t807;
  t809 = t216 * t428;
  t810 = t809 * t442;
  t811 = t458 * t810;
  t814 = t357 * t458;
  t817 = t361 * t458;
  t820 = t171 * t422;
  t821 = t167 * t820;
  t824 = t167 * t170;
  t826 = t17 * t215 * t216;
  t827 = t824 * t826;
  t829 = t30 * t744 * params->b_PBE;
  t830 = t159 * t25;
  t832 = t829 * t830 * t442;
  t836 = t461 * t430 * t25;
  t840 = t166 * t35 * t170;
  t841 = t12 * t215;
  t842 = t841 * t780;
  t843 = t840 * t842;
  t844 = t428 * params->b_PBE;
  t847 = t4 * t15 * t25;
  t848 = t844 * t159 * t847;
  t851 = -0.27e2 * t783 * t785 * t788 - 0.108e3 * t451 * t798 - 0.81e2 * t451 * t802 - 0.81e2 * t793 * t455 + 0.72576e5 * t459 * t836 + 0.72576e5 * t814 * t463 + 0.96768e5 * t817 * t463 + 0.72576e5 * t821 * t463 + 0.81e2 * t808 * t811 - 0.145152e6 * t827 * t832 + 0.24192e5 * t843 * t848;
  t852 = my_piecewise3(t2, 0, t851);
  tv2rhosigma0 = 0.2e1 * t852;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t853 = params->b_PBE * params->b_PBE;
  t854 = t25 * t25;
  t855 = t853 * t854;
  t856 = t159 * t159;
  t857 = t28 * t856;
  t859 = t855 * t857 * t46;
  t861 = t171 * t217 * t428;
  t864 = t216 * t744;
  t865 = t853 * t856;
  t866 = t865 * t854;
  t867 = t864 * t866;
  t871 = my_piecewise3(t2, 0, -0.376233984e9 * t459 * t867 + 0.419904e6 * t859 * t861);
  tv2sigma20 = 0.2e1 * t871;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t872 = t423 * t773;
  t891 = t423 * t747;
  t894 = t427 * t427;
  t895 = 0.1e1 / t894;
  t896 = t5 * t895;
  t897 = t746 * t442;
  t898 = t896 * t897;
  t899 = t217 * t898;
  t904 = 0.252e3 * t172 * t872 - 0.504e3 * t172 * t891 + 0.504e3 * t172 * t899 + 0.504e3 * t358 * t740 - 0.504e3 * t358 * t748 + 0.252e3 * t358 * t774 + 0.672e3 * t362 * t740 - 0.672e3 * t362 * t748 + 0.336e3 * t362 * t774 + 0.252e3 * t627 * t444 + 0.672e3 * t631 * t444 + 0.112e3 * t639 * t444;
  t905 = t45 * t239;
  t908 = t5 * t650 * t3;
  t909 = t50 * t908;
  t911 = -0.56e2 / 0.27e2 * t905 - 0.16e2 / 0.9e1 * t909;
  t913 = t499 * t256;
  t916 = t253 * t505;
  t921 = t255 * t255;
  t922 = 0.1e1 / t921;
  t923 = t55 * t922;
  t924 = t507 * t267;
  t927 = t267 * t520;
  t930 = t573 * t578;
  t931 = t930 * t574;
  t932 = t5 * t17;
  t946 = 0.32e2 * t511 * t31 * t231 * t258 - 0.24e2 * t931 * t932 * t35 * t258 + 0.64e2 * t45 * t258 * t239 - 0.24e2 * t905 + 0.16e2 * t909;
  t964 = t650 * t14;
  t965 = t127 * t964;
  t976 = t573 * t14;
  t978 = t83 * t43;
  t979 = t32 * t978;
  t980 = t976 * t103 * t979;
  t984 = t231 * t114;
  t995 = t20 * t12;
  t1000 = t304 * t30 * t83;
  t1007 = t573 * t13 / t75 / p->hyb_omega[0];
  t1008 = t66 * t978;
  t1010 = t130 * t324;
  t1013 = t35 * t114;
  t1014 = t258 * t5;
  t1025 = -0.78e2 * t576 * t578 * t35 * t114 - 0.18e2 * t980 * t596 * t114 - 0.4e2 / 0.3e1 * t305 * t306 * t984 + 0.32e2 * t131 * t132 * t239 - 0.4e2 / 0.3e1 * t316 * t322 * t367 * t324 + 0.48e2 * t595 * t995 * t324 + 0.4e2 / 0.3e1 * t1000 * t984 * t601 + 0.8e1 * t1007 * t1008 * t1010 + 0.16e2 * t931 * t1013 * t1014 - 0.64e2 / 0.3e1 * t328 * t329 * t239 - 0.64e2 / 0.9e1 * t143 * t908 + 0.64e2 / 0.9e1 * t49 * t908;
  t1027 = t130 * t303 * t1025;
  t1030 = t128 * t30;
  t1031 = t127 * t1030;
  t1032 = t17 * t107;
  t1035 = t1032 * t563 * t343 * t612;
  t1042 = t301 * t301;
  t1043 = 0.1e1 / t1042;
  t1047 = t130 * t107 * t1043 * t565 * t343;
  t1050 = t547 * t297;
  t1055 = t293 * t556;
  t1063 = t108 * t123;
  t1074 = (-0.16e2 / 0.9e1 * t905 + 0.104e3 / 0.9e1 * t45 * t239 * t114 - 0.1e2 / 0.3e1 * t510 * t231 * t1063 + 0.14e2 / 0.3e1 * t931 * t932 * t1013 - 0.88e2 / 0.27e2 * t115 * t650 * t119 + 0.88e2 / 0.27e2 * t909) * t8;
  t1075 = t1074 * t128;
  t1078 = 0.2e1 / 0.9e1 * t551 * t345 + t294 * t614 / 0.6e1 - 0.4e1 / 0.243e3 * t965 * t156 - t557 * t345 / 0.27e2 + t298 * t614 / 0.9e1 + t129 * t1027 / 0.18e2 - t1031 * t1035 / 0.3e1 - t294 * t567 / 0.3e1 - 0.2e1 / 0.9e1 * t298 * t567 + t129 * t1047 / 0.3e1 - t1050 * t156 / 0.9e1 + t548 * t345 / 0.6e1 + t1055 * t156 / 0.27e2 - t1075 * t156 / 0.18e2;
  t1079 = my_piecewise5(t41, -t257 * t946 - 0.3e1 * t913 * t267 - 0.3e1 * t501 * t520 + 0.6e1 * t506 * t927 + 0.6e1 * t916 * t507 + t911 * t80 - 0.6e1 * t923 * t924, t82, (0.112e4 / 0.27e2 * t90 * t239 * t3 * t42 + 0.448e5 / 0.27e2 * t96 * t650 * t75 * t14) * t103 / 0.2016e6, t1078);
  t1080 = params->b_PBE * t1079;
  t1083 = t751 * t433;
  t1088 = t430 * t763;
  t1092 = 0.1e1 / t19 / t481;
  t1095 = t435 * t1092 * t25 * sigma[0];
  t1098 = t84 * t84;
  t1100 = 0.1e1 / t18 / t1098;
  t1103 = t765 * t1100 * t25 * sigma[0];
  t1106 = t474 * params->ax;
  t1108 = 0.1e1 / t83;
  t1109 = t1106 * t102 * t1108;
  t1110 = t218 * t1109;
  t1111 = 0.1e1 / t86;
  t1112 = t1098 * rho[0];
  t1113 = 0.1e1 / t1112;
  t1115 = t1111 * t1113 * t220;
  t1119 = params->kappa * t35 * t8;
  t1121 = 0.864e3 * t1080 * t220 + 0.144e3 * t1083 * t438 - 0.24e3 * t754 * t759 + 0.48e2 * t1088 * t768 + 0.64e3 / 0.3e1 * t434 * t1095 - 0.8e2 * t764 * t1103 + 0.16e2 / 0.9e1 * t1110 * t1115 + 0.7168e5 / 0.27e2 * t1119;
  t1122 = t429 * t1121;
  t1123 = t217 * t1122;
  t1126 = t736 * t443;
  t1129 = t216 * t5;
  t1132 = t1129 * t744 * t442 * t772;
  t1138 = t17 * t1092 * t25;
  t1143 = t12 * t1100 * t25;
  t1150 = params->b_PBE * t1106;
  t1153 = t1150 * t102 * t1108 * t1111;
  t1155 = t1113 * t5 * t25;
  t1162 = t242 * t618;
  t1170 = 0.5e1 / 0.21e2 * t237 * t1138 * t243 - 0.5e1 / 0.56e2 * t480 * t1143 * t243 - 0.15e2 / 0.56e2 * t237 * t470 * t489 + t1153 * t1155 * t243 / 0.504e3 + 0.3e1 / 0.56e2 * t480 * t485 * t489 + 0.9e1 / 0.56e2 * t237 * t241 * t1162 + 0.27e2 / 0.28e2 * t27 * t29 * t1079 + 0.8e2 / 0.27e2 * t1119;
  t1171 = t1170 * t46;
  t1172 = t1171 * t171;
  t1175 = t166 * t239;
  t1176 = t1175 * t171;
  t1179 = t356 * t20;
  t1180 = t1179 * t171;
  t1183 = t625 * t18;
  t1184 = t1183 * t171;
  t1192 = 0.14e2 / 0.81e2 * t34 * p->hyb_omega[0] * t483 * t37;
  t1193 = my_piecewise3(t174, -t1192, 0);
  t1206 = t372 * t655;
  t1210 = t646 * t372;
  t1241 = -0.2908224e8 * t176 * t372 * t655 + 0.27495936e10 * t177 * t372 * t655 - 0.17564811264e12 * t178 * t372 * t655 + 0.87107125248e13 * t179 * t372 * t655 + 0.131525306744832e17 * t182 * t372 * t655 - 0.35771992768512e15 * t184 * t372 * t655 + 0.38896e5 * t175 * t1193 + 0.18330624e9 * t365 * t1193 + 0.3372443762688e15 * t366 * t1193 - 0.323136e7 * t375 * t1193 - 0.1083999780864e14 * t376 * t1193 + 0.3226189824e12 * t379 * t1193 - 0.836419584e10 * t382 * t1193 - 0.1938816e8 * t175 * t1210 - 0.35129622528e12 * t365 * t1210 + 0.36661248e10 * t375 * t1210 + 0.526101226979328e17 * t376 * t1210 - 0.11923997589504e16 * t379 * t1210 + 0.232285667328e14 * t382 * t1210 + 0.116688e6 * t1206;
  t1244 = t681 * t395;
  t1247 = t391 * t688;
  t1253 = 0.1e1 / t191 / t375;
  t1254 = t190 * t1253;
  t1262 = t406 * t710;
  t1266 = 0.1e1 / t197 / t195;
  t1267 = t200 * t1266;
  t1268 = t695 * t401;
  t1269 = t1268 * t203;
  t1272 = t411 * t698;
  t1278 = 0.1e1 / t197 / t400;
  t1279 = t200 * t1278;
  t1282 = my_piecewise3(t174, 0, -t1192);
  t1283 = t1282 * t203;
  t1286 = t197 * t197;
  t1288 = 0.1e1 / t1286 / t195;
  t1289 = t200 * t1288;
  t1295 = t710 * t401;
  t1298 = t704 * t409;
  t1304 = t406 * t719;
  t1307 = t195 * t1268;
  t1309 = t196 * t401;
  t1310 = t1309 * t698;
  t1312 = t400 * t1282;
  t1314 = t401 * t698;
  t1316 = t195 * t1282;
  t1318 = 0.768e3 * t1307 + 0.1152e4 * t1310 + 0.128e3 * t1312 - 0.96e2 * t1314 - 0.32e2 * t1316;
  t1333 = t707 * t715 / 0.2e1 + t1304 * t712 / 0.4e1 + t1318 * t203 / 0.3e1 - 0.128e3 / 0.3e1 * t1312 + 0.48e2 * t1314 + 0.16e2 * t1316 + 0.8e1 / 0.3e1 * t415 * t1282 - 0.8e1 / 0.3e1 * t210 * t1282 - 0.256e3 * t1307 - 0.384e3 * t1310 + 0.2e1 / 0.3e1 * t1278 * t1268 * t203;
  t1335 = my_piecewise3(t173, t1241 * t192 / 0.8671998246912e15 - t1244 * t372 / 0.180666630144e14 + t1247 * t646 / 0.10627448832e13 - t684 * t655 / 0.180666630144e14 - t1254 * t1210 / 0.1771241472e12 + t689 * t1206 / 0.10627448832e13 - t396 * t1193 / 0.541999890432e14, -0.3e1 / 0.2e1 * t1262 * t712 + 0.2e1 * t1267 * t1269 - 0.3e1 / 0.2e1 * t711 * t1272 + t720 * t1272 / 0.4e1 - 0.3e1 / 0.4e1 * t1279 * t1269 + t410 * t1283 / 0.6e1 + t1289 * t1269 / 0.24e2 - 0.16e2 / 0.3e1 * t1266 * t1268 * t203 + 0.4e1 * t1295 * t715 + t1298 * t411 / 0.2e1 + t1333);
  t1336 = t1335 * t216;
  t1337 = t1336 * t226;
  t1346 = 0.84e2 * t172 * t1123 + 0.252e3 * t172 * t1126 - 0.504e3 * t459 * t1132 - 0.252e3 * t627 * t424 - 0.84e2 * t1172 * t227 + 0.224e3 / 0.9e1 * t1176 * t227 - 0.112e3 * t1180 * t227 - 0.336e3 * t1184 * t227 - 0.336e3 * t362 * t737 - 0.84e2 * t172 * t1337 - 0.672e3 * t631 * t424 - 0.252e3 * t358 * t737 - 0.112e3 * t639 * t424;
  t1348 = my_piecewise3(t2, 0, t904 + t1346);
  tv3rho30 = 0.2e1 * t1348;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1349 = 0.1e1 / t84;
  t1351 = t166 * t1349 * t170;
  t1352 = 0.1e1 / t317;
  t1353 = t215 * t1352;
  t1354 = t1353 * t428;
  t1355 = t1351 * t1354;
  t1358 = t5 * t25;
  t1359 = t75 * t478 * t1358;
  t1360 = t218 * t474 * t1359;
  t1364 = t844 * t349 * t847;
  t1368 = t356 * t35 * t170;
  t1369 = t1368 * t842;
  t1373 = t166 * t367 * t170;
  t1374 = t1373 * t842;
  t1377 = t12 * t422;
  t1378 = t1377 * t780;
  t1379 = t840 * t1378;
  t1382 = t349 * t170;
  t1383 = t1382 * t787;
  t1387 = t422 * t225;
  t1388 = t786 * t1387;
  t1392 = t475 * t75;
  t1393 = t1352 * t478;
  t1395 = t1392 * t1393 * t1349;
  t1396 = t1358 * t28;
  t1397 = t1396 * t788;
  t1401 = t367 * t25 * t28;
  t1405 = t780 * t744;
  t1406 = t841 * t1405;
  t1407 = t840 * t1406;
  t1408 = t218 * params->ax;
  t1409 = t3 * t15;
  t1410 = t25 * t442;
  t1411 = t1409 * t1410;
  t1412 = t1408 * t1411;
  t1415 = t357 * t170;
  t1416 = t1415 * t826;
  t1419 = t361 * t170;
  t1420 = t1419 * t826;
  t1424 = t17 * t422 * t216;
  t1425 = t824 * t1424;
  t1428 = t809 * t772;
  t1429 = t458 * t1428;
  t1432 = t28 * t349;
  t1434 = t805 * t1432 * t46;
  t1440 = t20 * t170 * t17;
  t1441 = t1440 * t454;
  t1444 = t171 * t735;
  t1445 = t167 * t1444;
  t1450 = 0.2688e4 * t1355 * t1360 + 0.48384e5 * t843 * t1364 + 0.48384e5 * t1369 * t848 + 0.24192e5 * t1374 * t848 + 0.48384e5 * t1379 * t848 - 0.54e2 * t783 * t785 * t1383 - 0.54e2 * t783 * t785 * t1388 - 0.3e1 * t1395 * t1397 - 0.27e2 * t783 * t1401 * t788 - 0.96768e5 * t1407 * t1412 - 0.290304e6 * t1416 * t832 - 0.387072e6 * t1420 * t832 - 0.290304e6 * t1425 * t832 + 0.81e2 * t808 * t1429 + 0.162e3 * t1434 * t811 - 0.216e3 * t793 * t798 - 0.36e2 * t451 * t1441 + 0.72576e5 * t1445 * t463 + 0.145152e6 * t821 * t836;
  t1452 = t461 * t751 * t25;
  t1455 = t626 * t458;
  t1458 = t357 * t820;
  t1463 = t361 * t820;
  t1470 = t797 * t801;
  t1473 = t736 * t225;
  t1474 = t453 * t1473;
  t1478 = t26 * t449 * t618;
  t1481 = t630 * t458;
  t1484 = t638 * t458;
  t1487 = t806 * t18;
  t1488 = t805 * t1487;
  t1491 = t820 * t810;
  t1495 = t30 * t895 * params->b_PBE;
  t1497 = t1495 * t830 * t746;
  t1500 = t864 * t746;
  t1501 = t458 * t1500;
  t1504 = t349 * t25;
  t1506 = t829 * t1504 * t442;
  t1510 = t829 * t830 * t772;
  t1515 = t234 * t781 * t12 * t35;
  t1516 = t25 * t28;
  t1517 = t1516 * t159;
  t1518 = t170 * t215;
  t1519 = t428 * t442;
  t1520 = t1518 * t1519;
  t1521 = t1517 * t1520;
  t1524 = 0.72576e5 * t459 * t1452 + 0.72576e5 * t1455 * t463 + 0.145152e6 * t1458 * t463 + 0.193536e6 * t1463 * t463 - 0.216e3 * t451 * t1470 - 0.81e2 * t451 * t1474 - 0.81e2 * t1478 * t455 + 0.193536e6 * t1481 * t463 + 0.32256e5 * t1484 * t463 + 0.216e3 * t1488 * t811 + 0.162e3 * t808 * t1491 + 0.435456e6 * t827 * t1497 - 0.162e3 * t808 * t1501 - 0.290304e6 * t827 * t1506 - 0.145152e6 * t827 * t1510 + 0.54e2 * t1515 * t1521 - 0.162e3 * t793 * t802 + 0.145152e6 * t814 * t836 + 0.193536e6 * t817 * t836;
  t1526 = my_piecewise3(t2, 0, t1450 + t1524);
  tv3rho2sigma0 = 0.2e1 * t1526;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t1527 = t855 * t28;
  t1529 = t170 * t12;
  t1531 = t1527 * t856 * t35 * t1529;
  t1532 = t215 * t780;
  t1535 = t4 * t5 * t15;
  t1536 = t1532 * t428 * t1535;
  t1539 = t855 * t807;
  t1540 = t809 * t349;
  t1541 = t458 * t1540;
  t1545 = t855 * t857 * t18;
  t1549 = t171 * t423 * t428;
  t1552 = t864 * t442;
  t1553 = t458 * t1552;
  t1562 = t216 * t895;
  t1563 = t1562 * t853;
  t1564 = t856 * t854;
  t1566 = t1563 * t1564 * t442;
  t1569 = t864 * t853;
  t1570 = t159 * t854;
  t1572 = t1569 * t1570 * t349;
  t1575 = t866 * t1535;
  t1578 = -0.83607552e8 * t1407 * t1575 + 0.93312e5 * t1531 * t1536 + 0.839808e6 * t1539 * t1541 + 0.559872e6 * t1545 * t861 + 0.419904e6 * t859 * t1549 - 0.839808e6 * t859 * t1553 + 0.1128701952e10 * t459 * t1566 - 0.752467968e9 * t459 * t1572 - 0.376233984e9 * t814 * t867 - 0.501645312e9 * t817 * t867 - 0.376233984e9 * t821 * t867;
  t1579 = my_piecewise3(t2, 0, t1578);
  tv3rhosigma20 = 0.2e1 * t1579;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t1580 = t853 * params->b_PBE;
  t1581 = t854 * t25;
  t1582 = t1580 * t1581;
  t1583 = t856 * t159;
  t1584 = t28 * t1583;
  t1586 = t1582 * t1584 * t46;
  t1587 = t864 * t5;
  t1588 = t458 * t1587;
  t1594 = t1562 * t1580 * t1583 * t1581 * t5;
  t1598 = my_piecewise3(t2, 0, -0.1088391168e10 * t1586 * t1588 + 0.975198486528e12 * t459 * t1594);
  tv3sigma30 = 0.2e1 * t1598;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t35, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t49, t50, t52;
  double t53, t55, t56, t57, t64, t66, t67, t68;
  double t69, t75, t76, t78, t79, t80, t82, t83;
  double t84, t86, t90, t96, t102, t103, t107, t108;
  double t113, t114, t115, t118, t119, t123, t127, t128;
  double t129, t130, t131, t132, t136, t143, t148, t153;
  double t156, t159, t163, t165, t166, t167, t170, t171;
  double t172, t173, t174, t175, t176, t177, t178, t179;
  double t182, t184, t190, t191, t192, t195, t196, t197;
  double t200, t203, t207, t209, t210, t215, t216, t217;
  double t218, t220, t224, t225, t226, t227, t230, t231;
  double tzk0;

  double t234, t237, t238, t239, t241, t242, t243, t247;
  double t249, t250, t251, t253, t255, t256, t257, t258;
  double t267, t293, t294, t297, t298, t301, t303, t304;
  double t305, t306, t316, t317, t318, t319, t320, t321;
  double t322, t324, t328, t329, t343, t345, t349, t354;
  double t356, t357, t358, t361, t362, t365, t366, t367;
  double t371, t372, t375, t376, t379, t382, t391, t395;
  double t396, t400, t401, t402, t404, t406, t409, t410;
  double t411, t415, t422, t423, t424, t427, t428, t429;
  double t430, t433, t434, t435, t438, t442, t443, t444;
  double t448, tvrho0, t449, t451, t453, t454, t455, t458;
  double t459, t461, t463, t467, tvsigma0;

  double t468, t470, t474, t475, t476, t478, t480, t481;
  double t483, t485, t489, t493, t496, t497, t499, t501;
  double t505, t506, t507, t510, t511, t515, t520, t547;
  double t548, t551, t556, t557, t563, t564, t565, t567;
  double t573, t574, t576, t577, t578, t591, t595, t596;
  double t601, t612, t614, t618, t623, t625, t626, t627;
  double t630, t631, t638, t639, t646, t650, t654, t655;
  double t681, t684, t688, t689, t695, t696, t698, t699;
  double t702, t704, t707, t710, t711, t712, t715, t719;
  double t720, t734, t735, t736, t737, t740, t744, t745;
  double t746, t747, t748, t751, t754, t759, t762, t763;
  double t764, t765, t768, t772, t773, t774, t777, t778;
  double tv2rho20, t780, t781, t783, t785, t786, t787, t788;
  double t793, t797, t798, t801, t802, t805, t806, t807;
  double t808, t809, t810, t811, t814, t817, t820, t821;
  double t824, t826, t827, t829, t830, t832, t836, t840;
  double t841, t842, t843, t844, t847, t848, t851, t852;
  double tv2rhosigma0, t853, t854, t855, t856, t857, t859, t861;
  double t864, t865, t866, t867, t871, tv2sigma20;

  double t872, t891, t894, t895, t896, t897, t898, t899;
  double t904, t905, t908, t909, t911, t913, t916, t921;
  double t922, t923, t924, t927, t930, t931, t932, t946;
  double t964, t965, t976, t978, t979, t980, t984, t995;
  double t1000, t1007, t1008, t1010, t1013, t1014, t1025, t1027;
  double t1030, t1031, t1032, t1035, t1042, t1043, t1047, t1050;
  double t1055, t1063, t1074, t1075, t1078, t1079, t1080, t1083;
  double t1088, t1092, t1095, t1098, t1100, t1103, t1106, t1108;
  double t1109, t1110, t1111, t1112, t1113, t1115, t1119, t1121;
  double t1122, t1123, t1126, t1129, t1132, t1138, t1143, t1150;
  double t1153, t1155, t1162, t1170, t1171, t1172, t1175, t1176;
  double t1179, t1180, t1183, t1184, t1192, t1193, t1206, t1210;
  double t1241, t1244, t1247, t1253, t1254, t1262, t1266, t1267;
  double t1268, t1269, t1272, t1278, t1279, t1282, t1283, t1286;
  double t1288, t1289, t1295, t1298, t1304, t1307, t1309, t1310;
  double t1312, t1314, t1316, t1318, t1333, t1335, t1336, t1337;
  double t1346, t1348, tv3rho30, t1349, t1351, t1352, t1353, t1354;
  double t1355, t1358, t1359, t1360, t1364, t1368, t1369, t1373;
  double t1374, t1377, t1378, t1379, t1382, t1383, t1387, t1388;
  double t1392, t1393, t1395, t1396, t1397, t1401, t1405, t1406;
  double t1407, t1408, t1409, t1410, t1411, t1412, t1415, t1416;
  double t1419, t1420, t1424, t1425, t1428, t1429, t1432, t1434;
  double t1440, t1441, t1444, t1445, t1450, t1452, t1455, t1458;
  double t1463, t1470, t1473, t1474, t1478, t1481, t1484, t1487;
  double t1488, t1491, t1495, t1497, t1500, t1501, t1504, t1506;
  double t1510, t1515, t1516, t1517, t1518, t1519, t1520, t1521;
  double t1524, t1526, tv3rho2sigma0, t1527, t1529, t1531, t1532, t1535;
  double t1536, t1539, t1540, t1541, t1545, t1549, t1552, t1553;
  double t1562, t1563, t1564, t1566, t1569, t1570, t1572, t1575;
  double t1578, t1579, tv3rhosigma20, t1580, t1581, t1582, t1583, t1584;
  double t1586, t1587, t1588, t1594, t1598, tv3sigma30;

  double t1599, t1602, t1603, t1625, t1631, t1641, t1642, t1657;
  double t1683, t1686, t1691, t1737, t1757, t1762, t1769, t1832;
  double t1834, t1854, t1861, t1867, t1868, t1873, t1875, t1878;
  double t1880, t1883, t1889, t1891, t1910, t1912, t1917, t1929;
  double t1958, t2031, t2042, t2063, t2066, t2090, t2091, t2102;
  double t2105, t2147, t2180, t2181, t2182, t2184, t2185, t2187;
  double t2189, t2191, t2194, t2197, t2208, t2219, t2231, t2234;
  double t2240, t2254, t2277, t2296, t2298, t2316, t2319, tv4rho40;
  double t2345, t2365, t2370, t2424, t2459, t2497, t2539, t2571;
  double t2607, t2612, t2620, t2645, t2678, t2705, t2708, t2712;
  double tv4rho3sigma0, t2713, t2744, t2756, t2797, t2831, t2867, t2869;
  double tv4rho2sigma20, t2870, t2876, t2909, t2925, t2926, tv4rhosigma30, t2927;
  double t2928, t2930, t2945, tv4sigma40;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = p->hyb_omega[0] * p->hyb_omega[0];
  t4 = params->ax * t3;
  t5 = M_CBRT3;
  t7 = M_CBRTPI;
  t8 = t7 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = t12 * t12;
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t20 = 0.1e1 / t19;
  t25 = exp(-t4 * t5 * t16 * t17 * t20 / 0.12e2);
  t26 = params->b_PBE * t25;
  t27 = t26 * sigma[0];
  t28 = params->kappa + 0.1e1;
  t29 = t5 * t28;
  t30 = t5 * t5;
  t31 = t12 * t30;
  t32 = t7 * t7;
  t34 = t31 / t32;
  t35 = 0.1e1 / t18;
  t37 = 0.1e1 / t13;
  t40 = t34 * p->hyb_omega[0] * t35 * t37 / 0.6e1;
  t41 = t40 < 0.5e-1;
  t42 = t14 * t14;
  t43 = M_PI * M_PI;
  t44 = t32 * t43;
  t45 = t42 * t44;
  t46 = t18 * rho[0];
  t47 = t45 * t46;
  t49 = t14 * t8;
  t50 = t49 * t17;
  t52 = t5 * t19 * t3;
  t53 = t50 * t52;
  t55 = 0.7e1 * t47 - 0.6e1 * t53;
  t56 = t14 * t13;
  t57 = 0.1e1 / p->hyb_omega[0];
  t64 = erf(t57 * t5 * t32 * t13 * t17 * t18 / 0.2e1);
  t66 = sqrt(M_PI);
  t67 = t66 * t43;
  t68 = t56 * t64 * t67;
  t69 = rho[0] * p->hyb_omega[0];
  t75 = t3 * t3;
  t76 = t75 * t30;
  t78 = 0.12e2 * t76 * t12;
  t79 = -0.36e2 * t68 * t31 * t69 + 0.81e2 * t47 + 0.54e2 * t53 - t78;
  t80 = 0.1e1 / t79;
  t82 = 0.1e11 < t40;
  t83 = t43 * t43;
  t84 = rho[0] * rho[0];
  t86 = t42 * t14;
  t90 = t44 * t17 * t5;
  t96 = t8 * t12 * t30;
  t102 = t75 * t3;
  t103 = 0.1e1 / t102;
  t107 = 0.1e1 / t3;
  t108 = t107 * t30;
  t113 = t108 * t8 * t14 * t12 * t19 / 0.2e1;
  t114 = exp(t113);
  t115 = t114 * t8;
  t118 = t5 * t3;
  t119 = t14 * t17 * t118;
  t123 = t114 * t12;
  t127 = (0.7e1 * t115 * t19 * t119 - 0.12e2 * t123 * t76 + 0.6e1 * t47 + 0.11e2 * t53 + t78) * t8;
  t128 = t19 * t14;
  t129 = t127 * t128;
  t130 = t17 * t30;
  t131 = t42 * t114;
  t132 = t44 * t12;
  t136 = t56 * t114;
  t143 = t14 * t114 * t8;
  t148 = t114 * t17;
  t153 = 0.12e2 * t136 * t64 * t67 * t130 * t69 - 0.27e2 * t131 * t132 * t46 - 0.4e1 * t130 * t75 - 0.36e2 * t143 * t52 + 0.4e1 * t148 * t76 + 0.24e2 * t49 * t52;
  t156 = t130 * t107 / t153;
  t159 = my_piecewise5(t41, t55 * t80, t82, (0.56e4 * t96 * t19 * t75 * t14 - 0.14e3 * t90 * t46 * t3 * t42 - 0.1863e4 * t83 * t84 * t86) * t103 / 0.2016e6, -t129 * t156 / 0.18e2);
  t163 = t19 * t84;
  t165 = params->kappa * t163 * t8;
  t166 = 0.27e2 / 0.28e2 * t27 * t29 * t159 + t165;
  t167 = t166 * t46;
  t170 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t171 = t170 * t17;
  t172 = t167 * t171;
  t173 = 0.135e1 <= t40;
  t174 = 0.135e1 < t40;
  t175 = my_piecewise3(t174, t40, 0.135e1);
  t176 = t175 * t175;
  t177 = t176 * t176;
  t178 = t177 * t176;
  t179 = t177 * t177;
  t182 = t179 * t177;
  t184 = t179 * t176;
  t190 = 0.240888840192e14 * t179 * t178 + 0.19448e5 * t176 - 0.80784e6 * t177 + 0.3055104e8 * t178 - 0.104552448e10 * t179 - 0.90333315072e12 * t182 + 0.3226189824e11 * t184 - 0.429e3;
  t191 = t179 * t179;
  t192 = 0.1e1 / t191;
  t195 = my_piecewise3(t174, 0.135e1, t40);
  t196 = t195 * t195;
  t197 = t196 * t196;
  t200 = 0.32e2 * t197 - 0.16e2 * t196;
  t203 = exp(-0.1e1 / t196 / 0.4e1);
  t207 = 0.1e1 / t195;
  t209 = erf(t207 / 0.2e1);
  t210 = t66 * t209;
  t215 = my_piecewise3(t173, t190 * t192 / 0.8671998246912e15, t200 * t203 / 0.3e1 - 0.32e2 / 0.3e1 * t197 - 0.8e1 / 0.3e1 * t210 * t195 + 0.8e1 * t196 + 0.1e1);
  t216 = 0.1e1 / t7;
  t217 = t215 * t216;
  t218 = params->b_PBE * t159;
  t220 = t25 * sigma[0] * t5;
  t224 = 0.864e3 * t218 * t220 + 0.896e3 * t165;
  t225 = 0.1e1 / t224;
  t226 = t5 * t225;
  t227 = t217 * t226;
  t230 = my_piecewise3(t2, 0, -0.84e2 * t172 * t227);
  t231 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t230 * t231;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t234 = params->b_PBE * params->ax * t3;
  t237 = t234 * t30 * t9 * t15;
  t238 = t19 * rho[0];
  t239 = 0.1e1 / t238;
  t241 = t17 * t239 * t25;
  t242 = sigma[0] * t28;
  t243 = t242 * t159;
  t247 = t45 * t18;
  t249 = t5 * t35;
  t250 = t249 * t3;
  t251 = t50 * t250;
  t253 = 0.28e2 / 0.3e1 * t247 - 0.4e1 * t251;
  t255 = t79 * t79;
  t256 = 0.1e1 / t255;
  t257 = t55 * t256;
  t258 = exp(-t113);
  t267 = -0.72e2 * t45 * t258 * t18 - 0.36e2 * t68 * t31 * p->hyb_omega[0] + 0.108e3 * t247 + 0.36e2 * t251;
  t293 = (0.8e1 * t247 + 0.14e2 * t45 * t18 * t114 - 0.22e2 / 0.3e1 * t115 * t35 * t119 + 0.22e2 / 0.3e1 * t251) * t8;
  t294 = t293 * t128;
  t297 = t35 * t14;
  t298 = t127 * t297;
  t301 = t153 * t153;
  t303 = t107 / t301;
  t304 = t86 * t107;
  t305 = t304 * t30;
  t306 = t83 * t17;
  t316 = t42 * t13 * t57 * t5;
  t317 = t43 * M_PI;
  t318 = pow(M_PI, 0.1e1 / 0.6e1);
  t319 = t318 * t318;
  t320 = t319 * t319;
  t321 = t320 * t318;
  t322 = t321 * t317;
  t324 = t114 * t64;
  t328 = t131 * t44;
  t329 = t258 * t12;
  t343 = 0.12e2 * t136 * t64 * t67 * t17 * t30 * p->hyb_omega[0] - 0.9e1 * t305 * t306 * rho[0] * t114 + 0.24e2 * t316 * t322 * t19 * t324 - 0.72e2 * t131 * t132 * t18 + 0.24e2 * t328 * t329 * t18 - 0.16e2 * t143 * t250 + 0.16e2 * t49 * t250;
  t345 = t130 * t303 * t343;
  t349 = my_piecewise5(t41, t253 * t80 - t257 * t267, t82, (-0.3726e4 * t83 * rho[0] * t86 - 0.56e3 / 0.3e1 * t90 * t18 * t3 * t42 + 0.112e5 / 0.3e1 * t96 * t35 * t75 * t14) * t103 / 0.2016e6, -t294 * t156 / 0.18e2 - t298 * t156 / 0.27e2 + t129 * t345 / 0.18e2);
  t354 = params->kappa * t238 * t8;
  t356 = 0.3e1 / 0.56e2 * t237 * t241 * t243 + 0.27e2 / 0.28e2 * t27 * t29 * t349 + 0.8e1 / 0.3e1 * t354;
  t357 = t356 * t46;
  t358 = t357 * t171;
  t361 = t166 * t18;
  t362 = t361 * t171;
  t365 = t177 * t175;
  t366 = t179 * t365;
  t367 = 0.1e1 / t46;
  t371 = t34 * p->hyb_omega[0] * t367 * t37 / 0.18e2;
  t372 = my_piecewise3(t174, -t371, 0);
  t375 = t176 * t175;
  t376 = t179 * t375;
  t379 = t179 * t175;
  t382 = t177 * t375;
  t391 = 0.38896e5 * t175 * t372 + 0.18330624e9 * t365 * t372 + 0.3372443762688e15 * t366 * t372 - 0.323136e7 * t375 * t372 - 0.1083999780864e14 * t376 * t372 + 0.3226189824e12 * t379 * t372 - 0.836419584e10 * t382 * t372;
  t395 = 0.1e1 / t191 / t175;
  t396 = t190 * t395;
  t400 = t196 * t195;
  t401 = my_piecewise3(t174, 0, -t371);
  t402 = t400 * t401;
  t404 = t195 * t401;
  t406 = 0.128e3 * t402 - 0.32e2 * t404;
  t409 = 0.1e1 / t400;
  t410 = t200 * t409;
  t411 = t401 * t203;
  t415 = t203 * t207;
  t422 = my_piecewise3(t173, t391 * t192 / 0.8671998246912e15 - t396 * t372 / 0.541999890432e14, t406 * t203 / 0.3e1 + t410 * t411 / 0.6e1 - 0.128e3 / 0.3e1 * t402 + 0.8e1 / 0.3e1 * t415 * t401 - 0.8e1 / 0.3e1 * t210 * t401 + 0.16e2 * t404);
  t423 = t422 * t216;
  t424 = t423 * t226;
  t427 = t224 * t224;
  t428 = 0.1e1 / t427;
  t429 = t5 * t428;
  t430 = params->b_PBE * t349;
  t433 = t4 * t30;
  t434 = t218 * t433;
  t435 = t16 * t17;
  t438 = t435 * t239 * t25 * sigma[0];
  t442 = 0.864e3 * t430 * t220 + 0.48e2 * t434 * t438 + 0.7168e4 / 0.3e1 * t354;
  t443 = t429 * t442;
  t444 = t217 * t443;
  t448 = my_piecewise3(t2, 0, -0.84e2 * t172 * t424 + 0.84e2 * t172 * t444 - 0.84e2 * t358 * t227 - 0.112e3 * t362 * t227);
  tvrho0 = 0.2e1 * t448;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t449 = t30 * t28;
  t451 = t26 * t449 * t159;
  t453 = t46 * t170 * t17;
  t454 = t217 * t225;
  t455 = t453 * t454;
  t458 = t171 * t215;
  t459 = t167 * t458;
  t461 = t216 * t30 * t428;
  t463 = t461 * t218 * t25;
  t467 = my_piecewise3(t2, 0, -0.81e2 * t451 * t455 + 0.72576e5 * t459 * t463);
  tvsigma0 = 0.2e1 * t467;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t468 = 0.1e1 / t163;
  t470 = t17 * t468 * t25;
  t474 = params->ax * params->ax;
  t475 = params->b_PBE * t474;
  t476 = 0.1e1 / t44;
  t478 = 0.1e1 / t42;
  t480 = t475 * t75 * t476 * t478;
  t481 = t84 * rho[0];
  t483 = 0.1e1 / t18 / t481;
  t485 = t12 * t483 * t25;
  t489 = t242 * t349;
  t493 = t45 * t20;
  t496 = t5 * t367 * t3;
  t497 = t50 * t496;
  t499 = 0.28e2 / 0.9e1 * t493 + 0.4e1 / 0.3e1 * t497;
  t501 = t253 * t256;
  t505 = 0.1e1 / t255 / t79;
  t506 = t55 * t505;
  t507 = t267 * t267;
  t510 = t86 * t83;
  t511 = t510 * t107;
  t515 = t258 * t20;
  t520 = 0.24e2 * t511 * t31 * t258 - 0.96e2 * t45 * t515 + 0.36e2 * t493 - 0.12e2 * t497;
  t547 = (0.8e1 / 0.3e1 * t493 - 0.1e2 * t45 * t20 * t114 + 0.14e2 / 0.3e1 * t511 * t31 * t114 + 0.22e2 / 0.9e1 * t115 * t367 * t119 - 0.22e2 / 0.9e1 * t497) * t8;
  t548 = t547 * t128;
  t551 = t293 * t297;
  t556 = t367 * t14;
  t557 = t127 * t556;
  t563 = 0.1e1 / t301 / t153;
  t564 = t107 * t563;
  t565 = t343 * t343;
  t567 = t130 * t564 * t565;
  t573 = t42 * t42;
  t574 = 0.1e1 / t75;
  t576 = t573 * t574 * t5;
  t577 = t83 * M_PI;
  t578 = t7 * t577;
  t591 = t3 * p->hyb_omega[0];
  t595 = t42 * t56 / t591 * t318 * t577;
  t596 = t18 * t12;
  t601 = t258 * t17;
  t612 = -0.33e2 * t305 * t306 * t114 - 0.18e2 * t576 * t578 * t19 * t114 - 0.4e2 * t131 * t132 * t20 + 0.4e2 * t316 * t322 * t35 * t324 + 0.24e2 * t595 * t596 * t324 + 0.8e1 * t305 * t83 * t114 * t601 + 0.32e2 * t328 * t329 * t20 + 0.16e2 / 0.3e1 * t143 * t496 - 0.16e2 / 0.3e1 * t49 * t496;
  t614 = t130 * t303 * t612;
  t618 = my_piecewise5(t41, -t257 * t520 - 0.2e1 * t501 * t267 + t499 * t80 + 0.2e1 * t506 * t507, t82, (-0.3726e4 * t510 - 0.56e3 / 0.9e1 * t90 * t20 * t3 * t42 - 0.112e5 / 0.9e1 * t96 * t367 * t75 * t14) * t103 / 0.2016e6, -t548 * t156 / 0.18e2 - 0.2e1 / 0.27e2 * t551 * t156 + t294 * t345 / 0.9e1 + t557 * t156 / 0.81e2 + 0.2e1 / 0.27e2 * t298 * t345 - t129 * t567 / 0.9e1 + t129 * t614 / 0.18e2);
  t623 = params->kappa * t19 * t8;
  t625 = -0.5e1 / 0.56e2 * t237 * t470 * t243 + t480 * t485 * t243 / 0.56e2 + 0.3e1 / 0.28e2 * t237 * t241 * t489 + 0.27e2 / 0.28e2 * t27 * t29 * t618 + 0.4e2 / 0.9e1 * t623;
  t626 = t625 * t46;
  t627 = t626 * t171;
  t630 = t356 * t18;
  t631 = t630 * t171;
  t638 = t166 * t20;
  t639 = t638 * t171;
  t646 = t372 * t372;
  t650 = 0.1e1 / t18 / t84;
  t654 = 0.2e1 / 0.27e2 * t34 * p->hyb_omega[0] * t650 * t37;
  t655 = my_piecewise3(t174, t654, 0);
  t681 = 0.38896e5 * t175 * t655 - 0.969408e7 * t176 * t646 + 0.9165312e9 * t177 * t646 - 0.5854937088e11 * t178 * t646 + 0.29035708416e13 * t179 * t646 + 0.43841768914944e16 * t182 * t646 - 0.11923997589504e15 * t184 * t646 + 0.18330624e9 * t365 * t655 + 0.3372443762688e15 * t366 * t655 - 0.323136e7 * t375 * t655 - 0.1083999780864e14 * t376 * t655 + 0.3226189824e12 * t379 * t655 - 0.836419584e10 * t382 * t655 + 0.38896e5 * t646;
  t684 = t391 * t395;
  t688 = 0.1e1 / t191 / t176;
  t689 = t190 * t688;
  t695 = t401 * t401;
  t696 = t196 * t695;
  t698 = my_piecewise3(t174, 0, t654);
  t699 = t400 * t698;
  t702 = t195 * t698;
  t704 = 0.384e3 * t696 + 0.128e3 * t699 - 0.32e2 * t695 - 0.32e2 * t702;
  t707 = t406 * t409;
  t710 = 0.1e1 / t197;
  t711 = t200 * t710;
  t712 = t695 * t203;
  t715 = t698 * t203;
  t719 = 0.1e1 / t197 / t196;
  t720 = t200 * t719;
  t734 = t704 * t203 / 0.3e1 + t707 * t411 / 0.3e1 - t711 * t712 / 0.2e1 + t410 * t715 / 0.6e1 + t720 * t712 / 0.12e2 - 0.128e3 * t696 - 0.128e3 / 0.3e1 * t699 + 0.4e1 / 0.3e1 * t710 * t695 * t203 + 0.8e1 / 0.3e1 * t415 * t698 - 0.8e1 / 0.3e1 * t210 * t698 + 0.16e2 * t695 + 0.16e2 * t702;
  t735 = my_piecewise3(t173, t681 * t192 / 0.8671998246912e15 - t684 * t372 / 0.270999945216e14 + t689 * t646 / 0.31882346496e13 - t396 * t655 / 0.541999890432e14, t734);
  t736 = t735 * t216;
  t737 = t736 * t226;
  t740 = t423 * t443;
  t744 = 0.1e1 / t427 / t224;
  t745 = t5 * t744;
  t746 = t442 * t442;
  t747 = t745 * t746;
  t748 = t217 * t747;
  t751 = params->b_PBE * t618;
  t754 = t430 * t433;
  t759 = t435 * t468 * t25 * sigma[0];
  t762 = t474 * t75;
  t763 = t762 * t476;
  t764 = t218 * t763;
  t765 = t478 * t12;
  t768 = t765 * t483 * t25 * sigma[0];
  t772 = 0.864e3 * t751 * t220 + 0.96e2 * t754 * t438 - 0.8e2 * t434 * t759 + 0.16e2 * t764 * t768 + 0.3584e5 / 0.9e1 * t623;
  t773 = t429 * t772;
  t774 = t217 * t773;
  t777 = -0.84e2 * t627 * t227 - 0.224e3 * t631 * t227 - 0.168e3 * t358 * t424 + 0.168e3 * t358 * t444 - 0.112e3 / 0.3e1 * t639 * t227 - 0.224e3 * t362 * t424 + 0.224e3 * t362 * t444 - 0.84e2 * t172 * t737 + 0.168e3 * t172 * t740 - 0.168e3 * t172 * t748 + 0.84e2 * t172 * t774;
  t778 = my_piecewise3(t2, 0, t777);
  tv2rho20 = 0.2e1 * t778;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t780 = 0.1e1 / t32 / M_PI;
  t781 = t780 * t15;
  t783 = t234 * t781 * t12;
  t785 = t35 * t25 * t28;
  t786 = t159 * t170;
  t787 = t215 * t225;
  t788 = t786 * t787;
  t793 = t26 * t449 * t349;
  t797 = t18 * t170 * t17;
  t798 = t797 * t454;
  t801 = t423 * t225;
  t802 = t453 * t801;
  t805 = t26 * t30;
  t806 = t28 * t159;
  t807 = t806 * t46;
  t808 = t805 * t807;
  t809 = t216 * t428;
  t810 = t809 * t442;
  t811 = t458 * t810;
  t814 = t357 * t458;
  t817 = t361 * t458;
  t820 = t171 * t422;
  t821 = t167 * t820;
  t824 = t167 * t170;
  t826 = t17 * t215 * t216;
  t827 = t824 * t826;
  t829 = t30 * t744 * params->b_PBE;
  t830 = t159 * t25;
  t832 = t829 * t830 * t442;
  t836 = t461 * t430 * t25;
  t840 = t166 * t35 * t170;
  t841 = t12 * t215;
  t842 = t841 * t780;
  t843 = t840 * t842;
  t844 = t428 * params->b_PBE;
  t847 = t4 * t15 * t25;
  t848 = t844 * t159 * t847;
  t851 = -0.27e2 * t783 * t785 * t788 - 0.108e3 * t451 * t798 - 0.81e2 * t451 * t802 - 0.81e2 * t793 * t455 + 0.72576e5 * t459 * t836 + 0.72576e5 * t814 * t463 + 0.96768e5 * t817 * t463 + 0.72576e5 * t821 * t463 + 0.81e2 * t808 * t811 - 0.145152e6 * t827 * t832 + 0.24192e5 * t843 * t848;
  t852 = my_piecewise3(t2, 0, t851);
  tv2rhosigma0 = 0.2e1 * t852;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  t853 = params->b_PBE * params->b_PBE;
  t854 = t25 * t25;
  t855 = t853 * t854;
  t856 = t159 * t159;
  t857 = t28 * t856;
  t859 = t855 * t857 * t46;
  t861 = t171 * t217 * t428;
  t864 = t216 * t744;
  t865 = t853 * t856;
  t866 = t865 * t854;
  t867 = t864 * t866;
  t871 = my_piecewise3(t2, 0, -0.376233984e9 * t459 * t867 + 0.419904e6 * t859 * t861);
  tv2sigma20 = 0.2e1 * t871;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t872 = t423 * t773;
  t891 = t423 * t747;
  t894 = t427 * t427;
  t895 = 0.1e1 / t894;
  t896 = t5 * t895;
  t897 = t746 * t442;
  t898 = t896 * t897;
  t899 = t217 * t898;
  t904 = 0.252e3 * t172 * t872 - 0.504e3 * t172 * t891 + 0.504e3 * t172 * t899 + 0.504e3 * t358 * t740 - 0.504e3 * t358 * t748 + 0.252e3 * t358 * t774 + 0.672e3 * t362 * t740 - 0.672e3 * t362 * t748 + 0.336e3 * t362 * t774 + 0.252e3 * t627 * t444 + 0.672e3 * t631 * t444 + 0.112e3 * t639 * t444;
  t905 = t45 * t239;
  t908 = t5 * t650 * t3;
  t909 = t50 * t908;
  t911 = -0.56e2 / 0.27e2 * t905 - 0.16e2 / 0.9e1 * t909;
  t913 = t499 * t256;
  t916 = t253 * t505;
  t921 = t255 * t255;
  t922 = 0.1e1 / t921;
  t923 = t55 * t922;
  t924 = t507 * t267;
  t927 = t267 * t520;
  t930 = t573 * t578;
  t931 = t930 * t574;
  t932 = t5 * t17;
  t946 = 0.32e2 * t511 * t31 * t231 * t258 - 0.24e2 * t931 * t932 * t35 * t258 + 0.64e2 * t45 * t258 * t239 - 0.24e2 * t905 + 0.16e2 * t909;
  t964 = t650 * t14;
  t965 = t127 * t964;
  t976 = t573 * t14;
  t978 = t83 * t43;
  t979 = t32 * t978;
  t980 = t976 * t103 * t979;
  t984 = t231 * t114;
  t995 = t20 * t12;
  t1000 = t304 * t30 * t83;
  t1007 = t573 * t13 / t75 / p->hyb_omega[0];
  t1008 = t66 * t978;
  t1010 = t130 * t324;
  t1013 = t35 * t114;
  t1014 = t258 * t5;
  t1025 = -0.78e2 * t576 * t578 * t35 * t114 - 0.18e2 * t980 * t596 * t114 - 0.4e2 / 0.3e1 * t305 * t306 * t984 + 0.32e2 * t131 * t132 * t239 - 0.4e2 / 0.3e1 * t316 * t322 * t367 * t324 + 0.48e2 * t595 * t995 * t324 + 0.4e2 / 0.3e1 * t1000 * t984 * t601 + 0.8e1 * t1007 * t1008 * t1010 + 0.16e2 * t931 * t1013 * t1014 - 0.64e2 / 0.3e1 * t328 * t329 * t239 - 0.64e2 / 0.9e1 * t143 * t908 + 0.64e2 / 0.9e1 * t49 * t908;
  t1027 = t130 * t303 * t1025;
  t1030 = t128 * t30;
  t1031 = t127 * t1030;
  t1032 = t17 * t107;
  t1035 = t1032 * t563 * t343 * t612;
  t1042 = t301 * t301;
  t1043 = 0.1e1 / t1042;
  t1047 = t130 * t107 * t1043 * t565 * t343;
  t1050 = t547 * t297;
  t1055 = t293 * t556;
  t1063 = t108 * t123;
  t1074 = (-0.16e2 / 0.9e1 * t905 + 0.104e3 / 0.9e1 * t45 * t239 * t114 - 0.1e2 / 0.3e1 * t510 * t231 * t1063 + 0.14e2 / 0.3e1 * t931 * t932 * t1013 - 0.88e2 / 0.27e2 * t115 * t650 * t119 + 0.88e2 / 0.27e2 * t909) * t8;
  t1075 = t1074 * t128;
  t1078 = 0.2e1 / 0.9e1 * t551 * t345 + t294 * t614 / 0.6e1 - 0.4e1 / 0.243e3 * t965 * t156 - t557 * t345 / 0.27e2 + t298 * t614 / 0.9e1 + t129 * t1027 / 0.18e2 - t1031 * t1035 / 0.3e1 - t294 * t567 / 0.3e1 - 0.2e1 / 0.9e1 * t298 * t567 + t129 * t1047 / 0.3e1 - t1050 * t156 / 0.9e1 + t548 * t345 / 0.6e1 + t1055 * t156 / 0.27e2 - t1075 * t156 / 0.18e2;
  t1079 = my_piecewise5(t41, -t257 * t946 - 0.3e1 * t913 * t267 - 0.3e1 * t501 * t520 + 0.6e1 * t506 * t927 + 0.6e1 * t916 * t507 + t911 * t80 - 0.6e1 * t923 * t924, t82, (0.112e4 / 0.27e2 * t90 * t239 * t3 * t42 + 0.448e5 / 0.27e2 * t96 * t650 * t75 * t14) * t103 / 0.2016e6, t1078);
  t1080 = params->b_PBE * t1079;
  t1083 = t751 * t433;
  t1088 = t430 * t763;
  t1092 = 0.1e1 / t19 / t481;
  t1095 = t435 * t1092 * t25 * sigma[0];
  t1098 = t84 * t84;
  t1100 = 0.1e1 / t18 / t1098;
  t1103 = t765 * t1100 * t25 * sigma[0];
  t1106 = t474 * params->ax;
  t1108 = 0.1e1 / t83;
  t1109 = t1106 * t102 * t1108;
  t1110 = t218 * t1109;
  t1111 = 0.1e1 / t86;
  t1112 = t1098 * rho[0];
  t1113 = 0.1e1 / t1112;
  t1115 = t1111 * t1113 * t220;
  t1119 = params->kappa * t35 * t8;
  t1121 = 0.864e3 * t1080 * t220 + 0.144e3 * t1083 * t438 - 0.24e3 * t754 * t759 + 0.48e2 * t1088 * t768 + 0.64e3 / 0.3e1 * t434 * t1095 - 0.8e2 * t764 * t1103 + 0.16e2 / 0.9e1 * t1110 * t1115 + 0.7168e5 / 0.27e2 * t1119;
  t1122 = t429 * t1121;
  t1123 = t217 * t1122;
  t1126 = t736 * t443;
  t1129 = t216 * t5;
  t1132 = t1129 * t744 * t442 * t772;
  t1138 = t17 * t1092 * t25;
  t1143 = t12 * t1100 * t25;
  t1150 = params->b_PBE * t1106;
  t1153 = t1150 * t102 * t1108 * t1111;
  t1155 = t1113 * t5 * t25;
  t1162 = t242 * t618;
  t1170 = 0.5e1 / 0.21e2 * t237 * t1138 * t243 - 0.5e1 / 0.56e2 * t480 * t1143 * t243 - 0.15e2 / 0.56e2 * t237 * t470 * t489 + t1153 * t1155 * t243 / 0.504e3 + 0.3e1 / 0.56e2 * t480 * t485 * t489 + 0.9e1 / 0.56e2 * t237 * t241 * t1162 + 0.27e2 / 0.28e2 * t27 * t29 * t1079 + 0.8e2 / 0.27e2 * t1119;
  t1171 = t1170 * t46;
  t1172 = t1171 * t171;
  t1175 = t166 * t239;
  t1176 = t1175 * t171;
  t1179 = t356 * t20;
  t1180 = t1179 * t171;
  t1183 = t625 * t18;
  t1184 = t1183 * t171;
  t1192 = 0.14e2 / 0.81e2 * t34 * p->hyb_omega[0] * t483 * t37;
  t1193 = my_piecewise3(t174, -t1192, 0);
  t1206 = t372 * t655;
  t1210 = t646 * t372;
  t1241 = -0.2908224e8 * t176 * t372 * t655 + 0.27495936e10 * t177 * t372 * t655 - 0.17564811264e12 * t178 * t372 * t655 + 0.87107125248e13 * t179 * t372 * t655 + 0.131525306744832e17 * t182 * t372 * t655 - 0.35771992768512e15 * t184 * t372 * t655 + 0.38896e5 * t175 * t1193 + 0.18330624e9 * t365 * t1193 + 0.3372443762688e15 * t366 * t1193 - 0.323136e7 * t375 * t1193 - 0.1083999780864e14 * t376 * t1193 + 0.3226189824e12 * t379 * t1193 - 0.836419584e10 * t382 * t1193 - 0.1938816e8 * t175 * t1210 - 0.35129622528e12 * t365 * t1210 + 0.36661248e10 * t375 * t1210 + 0.526101226979328e17 * t376 * t1210 - 0.11923997589504e16 * t379 * t1210 + 0.232285667328e14 * t382 * t1210 + 0.116688e6 * t1206;
  t1244 = t681 * t395;
  t1247 = t391 * t688;
  t1253 = 0.1e1 / t191 / t375;
  t1254 = t190 * t1253;
  t1262 = t406 * t710;
  t1266 = 0.1e1 / t197 / t195;
  t1267 = t200 * t1266;
  t1268 = t695 * t401;
  t1269 = t1268 * t203;
  t1272 = t411 * t698;
  t1278 = 0.1e1 / t197 / t400;
  t1279 = t200 * t1278;
  t1282 = my_piecewise3(t174, 0, -t1192);
  t1283 = t1282 * t203;
  t1286 = t197 * t197;
  t1288 = 0.1e1 / t1286 / t195;
  t1289 = t200 * t1288;
  t1295 = t710 * t401;
  t1298 = t704 * t409;
  t1304 = t406 * t719;
  t1307 = t195 * t1268;
  t1309 = t196 * t401;
  t1310 = t1309 * t698;
  t1312 = t400 * t1282;
  t1314 = t401 * t698;
  t1316 = t195 * t1282;
  t1318 = 0.768e3 * t1307 + 0.1152e4 * t1310 + 0.128e3 * t1312 - 0.96e2 * t1314 - 0.32e2 * t1316;
  t1333 = t707 * t715 / 0.2e1 + t1304 * t712 / 0.4e1 + t1318 * t203 / 0.3e1 - 0.128e3 / 0.3e1 * t1312 + 0.48e2 * t1314 + 0.16e2 * t1316 + 0.8e1 / 0.3e1 * t415 * t1282 - 0.8e1 / 0.3e1 * t210 * t1282 - 0.256e3 * t1307 - 0.384e3 * t1310 + 0.2e1 / 0.3e1 * t1278 * t1268 * t203;
  t1335 = my_piecewise3(t173, t1241 * t192 / 0.8671998246912e15 - t1244 * t372 / 0.180666630144e14 + t1247 * t646 / 0.10627448832e13 - t684 * t655 / 0.180666630144e14 - t1254 * t1210 / 0.1771241472e12 + t689 * t1206 / 0.10627448832e13 - t396 * t1193 / 0.541999890432e14, -0.3e1 / 0.2e1 * t1262 * t712 + 0.2e1 * t1267 * t1269 - 0.3e1 / 0.2e1 * t711 * t1272 + t720 * t1272 / 0.4e1 - 0.3e1 / 0.4e1 * t1279 * t1269 + t410 * t1283 / 0.6e1 + t1289 * t1269 / 0.24e2 - 0.16e2 / 0.3e1 * t1266 * t1268 * t203 + 0.4e1 * t1295 * t715 + t1298 * t411 / 0.2e1 + t1333);
  t1336 = t1335 * t216;
  t1337 = t1336 * t226;
  t1346 = 0.84e2 * t172 * t1123 + 0.252e3 * t172 * t1126 - 0.504e3 * t459 * t1132 - 0.252e3 * t627 * t424 - 0.84e2 * t1172 * t227 + 0.224e3 / 0.9e1 * t1176 * t227 - 0.112e3 * t1180 * t227 - 0.336e3 * t1184 * t227 - 0.336e3 * t362 * t737 - 0.84e2 * t172 * t1337 - 0.672e3 * t631 * t424 - 0.252e3 * t358 * t737 - 0.112e3 * t639 * t424;
  t1348 = my_piecewise3(t2, 0, t904 + t1346);
  tv3rho30 = 0.2e1 * t1348;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1349 = 0.1e1 / t84;
  t1351 = t166 * t1349 * t170;
  t1352 = 0.1e1 / t317;
  t1353 = t215 * t1352;
  t1354 = t1353 * t428;
  t1355 = t1351 * t1354;
  t1358 = t5 * t25;
  t1359 = t75 * t478 * t1358;
  t1360 = t218 * t474 * t1359;
  t1364 = t844 * t349 * t847;
  t1368 = t356 * t35 * t170;
  t1369 = t1368 * t842;
  t1373 = t166 * t367 * t170;
  t1374 = t1373 * t842;
  t1377 = t12 * t422;
  t1378 = t1377 * t780;
  t1379 = t840 * t1378;
  t1382 = t349 * t170;
  t1383 = t1382 * t787;
  t1387 = t422 * t225;
  t1388 = t786 * t1387;
  t1392 = t475 * t75;
  t1393 = t1352 * t478;
  t1395 = t1392 * t1393 * t1349;
  t1396 = t1358 * t28;
  t1397 = t1396 * t788;
  t1401 = t367 * t25 * t28;
  t1405 = t780 * t744;
  t1406 = t841 * t1405;
  t1407 = t840 * t1406;
  t1408 = t218 * params->ax;
  t1409 = t3 * t15;
  t1410 = t25 * t442;
  t1411 = t1409 * t1410;
  t1412 = t1408 * t1411;
  t1415 = t357 * t170;
  t1416 = t1415 * t826;
  t1419 = t361 * t170;
  t1420 = t1419 * t826;
  t1424 = t17 * t422 * t216;
  t1425 = t824 * t1424;
  t1428 = t809 * t772;
  t1429 = t458 * t1428;
  t1432 = t28 * t349;
  t1434 = t805 * t1432 * t46;
  t1440 = t20 * t170 * t17;
  t1441 = t1440 * t454;
  t1444 = t171 * t735;
  t1445 = t167 * t1444;
  t1450 = 0.2688e4 * t1355 * t1360 + 0.48384e5 * t843 * t1364 + 0.48384e5 * t1369 * t848 + 0.24192e5 * t1374 * t848 + 0.48384e5 * t1379 * t848 - 0.54e2 * t783 * t785 * t1383 - 0.54e2 * t783 * t785 * t1388 - 0.3e1 * t1395 * t1397 - 0.27e2 * t783 * t1401 * t788 - 0.96768e5 * t1407 * t1412 - 0.290304e6 * t1416 * t832 - 0.387072e6 * t1420 * t832 - 0.290304e6 * t1425 * t832 + 0.81e2 * t808 * t1429 + 0.162e3 * t1434 * t811 - 0.216e3 * t793 * t798 - 0.36e2 * t451 * t1441 + 0.72576e5 * t1445 * t463 + 0.145152e6 * t821 * t836;
  t1452 = t461 * t751 * t25;
  t1455 = t626 * t458;
  t1458 = t357 * t820;
  t1463 = t361 * t820;
  t1470 = t797 * t801;
  t1473 = t736 * t225;
  t1474 = t453 * t1473;
  t1478 = t26 * t449 * t618;
  t1481 = t630 * t458;
  t1484 = t638 * t458;
  t1487 = t806 * t18;
  t1488 = t805 * t1487;
  t1491 = t820 * t810;
  t1495 = t30 * t895 * params->b_PBE;
  t1497 = t1495 * t830 * t746;
  t1500 = t864 * t746;
  t1501 = t458 * t1500;
  t1504 = t349 * t25;
  t1506 = t829 * t1504 * t442;
  t1510 = t829 * t830 * t772;
  t1515 = t234 * t781 * t12 * t35;
  t1516 = t25 * t28;
  t1517 = t1516 * t159;
  t1518 = t170 * t215;
  t1519 = t428 * t442;
  t1520 = t1518 * t1519;
  t1521 = t1517 * t1520;
  t1524 = 0.72576e5 * t459 * t1452 + 0.72576e5 * t1455 * t463 + 0.145152e6 * t1458 * t463 + 0.193536e6 * t1463 * t463 - 0.216e3 * t451 * t1470 - 0.81e2 * t451 * t1474 - 0.81e2 * t1478 * t455 + 0.193536e6 * t1481 * t463 + 0.32256e5 * t1484 * t463 + 0.216e3 * t1488 * t811 + 0.162e3 * t808 * t1491 + 0.435456e6 * t827 * t1497 - 0.162e3 * t808 * t1501 - 0.290304e6 * t827 * t1506 - 0.145152e6 * t827 * t1510 + 0.54e2 * t1515 * t1521 - 0.162e3 * t793 * t802 + 0.145152e6 * t814 * t836 + 0.193536e6 * t817 * t836;
  t1526 = my_piecewise3(t2, 0, t1450 + t1524);
  tv3rho2sigma0 = 0.2e1 * t1526;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  t1527 = t855 * t28;
  t1529 = t170 * t12;
  t1531 = t1527 * t856 * t35 * t1529;
  t1532 = t215 * t780;
  t1535 = t4 * t5 * t15;
  t1536 = t1532 * t428 * t1535;
  t1539 = t855 * t807;
  t1540 = t809 * t349;
  t1541 = t458 * t1540;
  t1545 = t855 * t857 * t18;
  t1549 = t171 * t423 * t428;
  t1552 = t864 * t442;
  t1553 = t458 * t1552;
  t1562 = t216 * t895;
  t1563 = t1562 * t853;
  t1564 = t856 * t854;
  t1566 = t1563 * t1564 * t442;
  t1569 = t864 * t853;
  t1570 = t159 * t854;
  t1572 = t1569 * t1570 * t349;
  t1575 = t866 * t1535;
  t1578 = -0.83607552e8 * t1407 * t1575 + 0.93312e5 * t1531 * t1536 + 0.839808e6 * t1539 * t1541 + 0.559872e6 * t1545 * t861 + 0.419904e6 * t859 * t1549 - 0.839808e6 * t859 * t1553 + 0.1128701952e10 * t459 * t1566 - 0.752467968e9 * t459 * t1572 - 0.376233984e9 * t814 * t867 - 0.501645312e9 * t817 * t867 - 0.376233984e9 * t821 * t867;
  t1579 = my_piecewise3(t2, 0, t1578);
  tv3rhosigma20 = 0.2e1 * t1579;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  t1580 = t853 * params->b_PBE;
  t1581 = t854 * t25;
  t1582 = t1580 * t1581;
  t1583 = t856 * t159;
  t1584 = t28 * t1583;
  t1586 = t1582 * t1584 * t46;
  t1587 = t864 * t5;
  t1588 = t458 * t1587;
  t1594 = t1562 * t1580 * t1583 * t1581 * t5;
  t1598 = my_piecewise3(t2, 0, -0.1088391168e10 * t1586 * t1588 + 0.975198486528e12 * t459 * t1594);
  tv3sigma30 = 0.2e1 * t1598;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  t1599 = t45 * t468;
  t1602 = t5 * t483 * t3;
  t1603 = t50 * t1602;
  t1625 = t507 * t507;
  t1631 = t520 * t520;
  t1641 = t976 * t979;
  t1642 = t103 * t20;
  t1657 = (0.28e3 / 0.81e2 * t1599 + 0.112e3 / 0.27e2 * t1603) * t80 - 0.4e1 * t911 * t256 * t267 + 0.12e2 * t499 * t505 * t507 - 0.6e1 * t913 * t520 - 0.24e2 * t253 * t922 * t924 + 0.24e2 * t916 * t927 - 0.4e1 * t501 * t946 + 0.24e2 * t55 / t921 / t79 * t1625 - 0.36e2 * t923 * t507 * t520 + 0.6e1 * t506 * t1631 + 0.8e1 * t506 * t267 * t946 - t257 * (-0.24e2 * t931 * t932 * t367 * t258 + 0.48e2 * t1641 * t1642 * t258 - 0.16e3 / 0.3e1 * t511 * t31 * t1349 * t258 - 0.32e3 / 0.3e1 * t45 * t258 * t468 - 0.112e3 / 0.3e1 * t1603 + 0.4e2 * t1599);
  t1683 = t75 * t75;
  t1686 = t83 * t83;
  t1691 = t1349 * t114;
  t1737 = -0.2e1 / 0.3e1 * t576 * t578 * t367 * t114 - 0.84e2 * t980 * t995 * t114 - 0.6e1 * t573 * t42 / t1683 * t1686 * t130 * t114 + 0.24e2 * t305 * t306 * t1691 - 0.544e3 / 0.9e1 * t131 * t132 * t468 + 0.16e3 / 0.9e1 * t316 * t322 * t650 * t324 - 0.136e3 / 0.3e1 * t595 * t239 * t12 * t324 - 0.16e3 / 0.9e1 * t1000 * t1691 * t601 + 0.16e2 * t1007 * t1008 * t231 * t1010 + 0.8e2 / 0.3e1 * t931 * t367 * t114 * t1014 + 0.16e2 * t573 * t56 / t75 / t591 * t321 * t83 * t317 * t249 * t324 + 0.16e2 * t980 * t123 * t515 + 0.32e3 / 0.9e1 * t328 * t329 * t468 + 0.448e3 / 0.27e2 * t143 * t1602 - 0.448e3 / 0.27e2 * t49 * t1602;
  t1757 = t565 * t565;
  t1762 = t612 * t612;
  t1769 = -0.4e1 / 0.27e2 * t1055 * t345 - 0.8e1 / 0.9e1 * t551 * t567 + 0.4e1 / 0.27e2 * t298 * t1027 + t129 * t130 * t303 * t1737 / 0.18e2 + 0.4e1 / 0.9e1 * t1050 * t345 + 0.4e1 / 0.9e1 * t551 * t614 + t548 * t614 / 0.3e1 + 0.2e1 / 0.9e1 * t294 * t1027 + 0.4e1 / 0.27e2 * t557 * t567 + 0.8e1 / 0.9e1 * t298 * t1047 - 0.4e1 / 0.3e1 * t129 * t130 * t107 / t1042 / t153 * t1757 - t129 * t130 * t564 * t1762 / 0.3e1 + 0.4e1 / 0.3e1 * t294 * t1047;
  t1832 = 0.2e1 / 0.9e1 * t1075 * t345 - 0.2e1 / 0.3e1 * t548 * t567 + 0.16e2 / 0.243e3 * t965 * t345 - 0.2e1 / 0.27e2 * t557 * t614 - (0.8e2 / 0.27e2 * t1599 - 0.232e3 / 0.9e1 * t45 * t468 * t114 + 0.194e3 / 0.27e2 * t510 * t1349 * t1063 - 0.44e2 / 0.9e1 * t930 * t367 * t574 * t5 * t148 + 0.28e2 / 0.3e1 * t1641 * t1642 * t114 + 0.616e3 / 0.81e2 * t115 * t483 * t119 - 0.616e3 / 0.81e2 * t1603) * t8 * t128 * t156 / 0.18e2 - 0.16e2 / 0.243e3 * t293 * t964 * t156 - 0.4e1 / 0.27e2 * t1074 * t297 * t156 + 0.2e1 / 0.27e2 * t547 * t556 * t156 + 0.28e2 / 0.729e3 * t127 * t483 * t14 * t156 + 0.2e1 * t1031 * t1032 * t1043 * t565 * t612 - 0.4e1 / 0.3e1 * t293 * t1030 * t1035 - 0.8e1 / 0.9e1 * t127 * t297 * t30 * t1035 - 0.4e1 / 0.9e1 * t1031 * t1032 * t563 * t1025 * t343;
  t1834 = my_piecewise5(t41, t1657, t82, (-0.56e4 / 0.81e2 * t90 * t468 * t3 * t42 - 0.3136e6 / 0.81e2 * t96 * t483 * t75 * t14) * t103 / 0.2016e6, t1769 + t1832);
  t1854 = 0.1e1 / t19 / t1098;
  t1861 = 0.1e1 / t18 / t1112;
  t1867 = t1098 * t84;
  t1868 = 0.1e1 / t1867;
  t1873 = t474 * t474;
  t1875 = 0.1e1 / t578;
  t1878 = 0.1e1 / t573;
  t1880 = 0.1e1 / t19 / t1867;
  t1883 = t17 * t25;
  t1889 = params->kappa * t367 * t8;
  t1891 = 0.864e3 * params->b_PBE * t1834 * t220 + 0.192e3 * t1080 * t433 * t438 - 0.48e3 * t1083 * t759 + 0.96e2 * t751 * t763 * t768 + 0.256e4 / 0.3e1 * t754 * t1095 - 0.32e3 * t1088 * t1103 + 0.64e2 / 0.9e1 * t430 * t1109 * t1115 - 0.704e4 / 0.9e1 * t434 * t435 * t1854 * t25 * sigma[0] + 0.376e4 / 0.9e1 * t764 * t765 * t1861 * t25 * sigma[0] - 0.16e3 / 0.9e1 * t1110 * t1111 * t1868 * t220 + 0.8e1 / 0.81e2 * t218 * t1873 * t1683 * t1875 * t1878 * t1880 * t30 * t1883 * sigma[0] - 0.7168e5 / 0.81e2 * t1889;
  t1910 = 0.1e1 / t894 / t224;
  t1912 = t746 * t746;
  t1917 = t772 * t772;
  t1929 = -0.2016e4 * t172 * t217 * t5 * t1910 * t1912 + 0.84e2 * t172 * t217 * t429 * t1891 - 0.504e3 * t172 * t217 * t745 * t1917 + 0.336e3 * t172 * t423 * t1122 + 0.2016e4 * t172 * t423 * t898 + 0.448e3 * t362 * t1123 + 0.336e3 * t1172 * t444 - 0.2016e4 * t358 * t891 + 0.2016e4 * t358 * t899 + 0.2688e4 * t362 * t899 + 0.1008e4 * t627 * t740 + 0.2688e4 * t631 * t740;
  t1958 = 0.336e3 * t172 * t1336 * t443 - 0.1008e4 * t172 * t736 * t747 + 0.1008e4 * t358 * t1126 + 0.1344e4 * t362 * t1126 + 0.1344e4 * t1184 * t444 + 0.1008e4 * t358 * t872 + 0.1344e4 * t362 * t872 - 0.2688e4 * t362 * t891 - 0.1008e4 * t627 * t748 + 0.504e3 * t627 * t774 - 0.2688e4 * t631 * t748 + 0.1344e4 * t631 * t774 - 0.448e3 * t639 * t748;
  t2031 = -0.55e2 / 0.63e2 * t237 * t17 * t1854 * t25 * t243 + 0.235e3 / 0.504e3 * t480 * t12 * t1861 * t25 * t243 + 0.2e2 / 0.21e2 * t237 * t1138 * t489 - 0.5e1 / 0.252e3 * t1153 * t1868 * t5 * t25 * t243 - 0.5e1 / 0.14e2 * t480 * t1143 * t489 - 0.15e2 / 0.28e2 * t237 * t470 * t1162 + params->b_PBE * t1873 * t1683 * t1875 * t1878 * t1880 * t130 * t25 * t243 / 0.9072e4 + t1153 * t1155 * t489 / 0.126e3 + 0.3e1 / 0.28e2 * t480 * t485 * t1162 + 0.3e1 / 0.14e2 * t237 * t241 * t242 * t1079 + 0.27e2 / 0.28e2 * t27 * t29 * t1834 - 0.8e2 / 0.81e2 * t1889;
  t2042 = 0.504e3 * t172 * t736 * t773 + 0.336e3 * t358 * t1123 - 0.896e3 / 0.9e1 * t1176 * t444 + 0.448e3 * t1180 * t444 + 0.448e3 * t639 * t740 + 0.224e3 * t639 * t774 + 0.3024e4 * t459 * t1129 * t895 * t746 * t772 - 0.2688e4 * t817 * t1132 - 0.2016e4 * t821 * t1132 - 0.2016e4 * t814 * t1132 - 0.84e2 * t2031 * t46 * t171 * t227 - 0.336e3 * t1172 * t424 + 0.896e3 / 0.9e1 * t356 * t239 * t171 * t227;
  t2063 = t655 * t655;
  t2066 = t646 * t646;
  t2090 = 0.14e3 / 0.243e3 * t34 * p->hyb_omega[0] * t1100 * t37;
  t2091 = my_piecewise3(t174, t2090, 0);
  t2102 = -0.2908224e8 * t176 * t2063 + 0.109983744e11 * t176 * t2066 + 0.27495936e10 * t177 * t2063 - 0.17564811264e13 * t177 * t2066 - 0.17564811264e12 * t178 * t2063 + 0.1625999671296e15 * t178 * t2066 + 0.87107125248e13 * t179 * t2063 - 0.107315978305536e17 * t179 * t2066 + 0.131525306744832e17 * t182 * t2063 - 0.35771992768512e15 * t184 * t2063 + 0.5787113496772608e18 * t184 * t2066 + 0.18330624e9 * t365 * t2091 + 0.3372443762688e15 * t366 * t2091 - 0.1083999780864e14 * t376 * t2091 + 0.3226189824e12 * t379 * t2091 - 0.836419584e10 * t382 * t2091;
  t2105 = t372 * t1193;
  t2147 = -0.3877632e8 * t176 * t1193 * t372 + 0.36661248e10 * t177 * t1193 * t372 - 0.23419748352e12 * t178 * t1193 * t372 + 0.116142833664e14 * t179 * t1193 * t372 + 0.175367075659776e17 * t182 * t1193 * t372 - 0.47695990358016e15 * t184 * t1193 * t372 - 0.11632896e9 * t175 * t646 * t655 - 0.210777735168e13 * t365 * t646 * t655 + 0.219967488e11 * t375 * t646 * t655 + 0.3156607361875968e18 * t376 * t646 * t655 - 0.71543985537024e16 * t379 * t646 * t655 + 0.1393714003968e15 * t382 * t646 * t655 + 0.38896e5 * t175 * t2091 - 0.323136e7 * t375 * t2091 + 0.116688e6 * t2063 - 0.1938816e8 * t2066 + 0.155584e6 * t2105;
  t2180 = (t2102 + t2147) * t192 / 0.8671998246912e15 - t1241 * t395 * t372 / 0.135499972608e14 + t681 * t688 * t646 / 0.5313724416e12 - t1244 * t655 / 0.90333315072e13 - t391 * t1253 * t1210 / 0.442810368e11 + t1247 * t1206 / 0.2656862208e12 - t684 * t1193 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t190 / t191 / t177 * t2066 - t1254 * t646 * t655 / 0.295206912e11 + t689 * t2063 / 0.10627448832e13 + t689 * t2105 / 0.7970586624e12 - t396 * t2091 / 0.541999890432e14;
  t2181 = t698 * t698;
  t2182 = t196 * t2181;
  t2184 = my_piecewise3(t174, 0, t2090);
  t2185 = t195 * t2184;
  t2187 = t400 * t2184;
  t2189 = t401 * t1282;
  t2191 = t695 * t695;
  t2194 = t195 * t695 * t698;
  t2197 = t1309 * t1282;
  t2208 = 0.1e1 / t1286;
  t2219 = 0.1e1 / t1286 / t196;
  t2231 = t712 * t698;
  t2234 = t411 * t1282;
  t2240 = -0.384e3 * t2182 + 0.16e2 * t2185 - 0.128e3 / 0.3e1 * t2187 + 0.64e2 * t2189 + (0.768e3 * t2191 + 0.4608e4 * t2194 + 0.1152e4 * t2182 + 0.1536e4 * t2197 + 0.128e3 * t2187 - 0.96e2 * t2181 - 0.128e3 * t2189 - 0.32e2 * t2185) * t203 / 0.3e1 - 0.256e3 * t2191 + 0.48e2 * t2181 - 0.22e2 / 0.3e1 * t2208 * t2191 * t203 - 0.1536e4 * t2194 - 0.512e3 * t2197 + 0.8e1 / 0.3e1 * t415 * t2184 - 0.8e1 / 0.3e1 * t210 * t2184 + t2219 * t2191 * t203 / 0.3e1 + 0.8e2 / 0.3e1 * t719 * t2191 * t203 + 0.4e1 * t710 * t2181 * t203 - 0.6e1 * t1262 * t1272 + 0.12e2 * t1267 * t2231 - 0.2e1 * t711 * t2234 - 0.9e1 / 0.2e1 * t1279 * t2231 + t1304 * t1272;
  t2254 = t2191 * t203;
  t2277 = t2181 * t203;
  t2296 = t720 * t2234 / 0.3e1 + t1289 * t2231 / 0.4e1 + t410 * t2184 * t203 / 0.6e1 + t406 * t1288 * t1269 / 0.6e1 + t200 / t1286 / t197 * t2254 / 0.48e2 - 0.32e2 * t1266 * t695 * t715 + 0.16e2 / 0.3e1 * t1295 * t1283 + 0.4e1 * t1278 * t695 * t715 + 0.2e1 / 0.3e1 * t1318 * t409 * t411 + t1298 * t715 + t704 * t719 * t712 / 0.2e1 + 0.8e1 * t406 * t1266 * t1269 - 0.1e2 * t720 * t2254 - 0.3e1 / 0.2e1 * t711 * t2277 + t720 * t2277 / 0.4e1 - 0.3e1 * t704 * t710 * t712 - 0.3e1 * t406 * t1278 * t1269 + 0.25e2 / 0.4e1 * t200 * t2208 * t2254 - 0.3e1 / 0.4e1 * t200 * t2219 * t2254 + 0.2e1 / 0.3e1 * t707 * t1283;
  t2298 = my_piecewise3(t173, t2180, t2240 + t2296);
  t2316 = 0.896e3 / 0.9e1 * t1176 * t424 - 0.224e3 * t625 * t20 * t171 * t227 - 0.448e3 * t1180 * t424 - 0.448e3 * t1170 * t18 * t171 * t227 - 0.1344e4 * t1184 * t424 - 0.1344e4 * t631 * t737 - 0.448e3 * t362 * t1337 - 0.336e3 * t358 * t1337 - 0.84e2 * t172 * t2298 * t216 * t226 - 0.504e3 * t627 * t737 - 0.224e3 * t639 * t737 - 0.112e4 / 0.27e2 * t166 * t468 * t171 * t227 - 0.672e3 * t459 * t1129 * t744 * t1121 * t442;
  t2319 = my_piecewise3(t2, 0, t1929 + t1958 + t2042 + t2316);
  tv4rho40 = 0.2e1 * t2319;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t2345 = 0.1e1 / t481;
  t2365 = t772 * t442;
  t2370 = 0.145152e6 * t1368 * t1378 * t848 + 0.145152e6 * t1369 * t1364 + 0.72576e5 * t1373 * t1378 * t848 + 0.72576e5 * t625 * t35 * t170 * t842 * t848 + 0.145152e6 * t1379 * t1364 + 0.72576e5 * t843 * t844 * t618 * t847 - 0.81e2 * t783 * t1401 * t1383 - 0.81e2 * t783 * t1401 * t1388 + 0.3e1 * t1392 * t1393 * t2345 * t1397 + 0.72576e5 * t840 * t12 * t735 * t780 * t848 + 0.8064e4 * t356 * t1349 * t170 * t1354 * t1360 + 0.8064e4 * t1351 * t422 * t1352 * t428 * t1360 - 0.486e3 * t808 * t458 * t864 * t2365;
  t2424 = -0.21504e5 * t166 * t650 * t170 * t842 * t848 + 0.72576e5 * t356 * t367 * t170 * t842 * t848 + 0.72576e5 * t1374 * t1364 - 0.162e3 * t783 * t785 * t1382 * t1387 - 0.81e2 * t783 * t785 * t786 * t735 * t225 - 0.81e2 * t783 * t785 * t618 * t170 * t787 - 0.2688e4 * t166 * t2345 * t170 * t1354 * t1360 + 0.24e2 * t783 * t650 * t25 * t28 * t788 - 0.9e1 * t1395 * t1396 * t1388 - 0.9e1 * t1395 * t1396 * t1383 + 0.8064e4 * t1355 * t430 * t474 * t1359 + 0.1306368e7 * t827 * t1495 * t830 * t2365 + 0.72576e5 * t1171 * t458 * t463;
  t2459 = 0.72576e5 * t167 * t171 * t1335 * t463 + 0.290304e6 * t1183 * t458 * t463 + 0.217728e6 * t357 * t1444 * t463 + 0.290304e6 * t361 * t1444 * t463 + 0.217728e6 * t626 * t820 * t463 + 0.580608e6 * t630 * t820 * t463 + 0.217728e6 * t1445 * t836 + 0.290304e6 * t817 * t1452 + 0.217728e6 * t1455 * t836 + 0.435456e6 * t1458 * t836 + 0.580608e6 * t1463 * t836 - 0.648e3 * t793 * t1470 + 0.580608e6 * t1481 * t836;
  t2497 = 0.217728e6 * t821 * t1452 + 0.217728e6 * t814 * t1452 + 0.72576e5 * t459 * t461 * t1080 * t25 - 0.21504e5 * t1175 * t458 * t463 + 0.96768e5 * t1179 * t458 * t463 - 0.108e3 * t451 * t1440 * t801 - 0.324e3 * t1478 * t798 + 0.96768e5 * t638 * t820 * t463 + 0.96768e5 * t1484 * t836 - 0.108e3 * t793 * t1441 + 0.24e2 * t451 * t239 * t170 * t17 * t454 - 0.81e2 * t26 * t449 * t1079 * t455 - 0.243e3 * t1478 * t802;
  t2539 = 0.243e3 * t805 * t28 * t618 * t46 * t811 - 0.81e2 * t451 * t453 * t1336 * t225 - 0.1161216e7 * t630 * t170 * t826 * t832 - 0.193536e6 * t638 * t170 * t826 * t832 - 0.870912e6 * t1415 * t1424 * t832 - 0.1161216e7 * t1419 * t1424 * t832 + 0.243e3 * t808 * t1444 * t810 - 0.324e3 * t451 * t797 * t1473 - 0.870912e6 * t1416 * t1506 - 0.435456e6 * t1416 * t1510 - 0.1161216e7 * t1420 * t1506 - 0.580608e6 * t1420 * t1510 - 0.243e3 * t793 * t1474;
  t2571 = 0.81e2 * t808 * t458 * t809 * t1121 + 0.648e3 * t805 * t1432 * t18 * t811 + 0.243e3 * t808 * t820 * t1428 + 0.1306368e7 * t1416 * t1497 + 0.1741824e7 * t1420 * t1497 + 0.1306368e7 * t1425 * t1497 - 0.435456e6 * t1425 * t1510 + 0.243e3 * t1434 * t1429 + 0.324e3 * t1488 * t1429 + 0.486e3 * t1434 * t1491 - 0.486e3 * t1434 * t1501 + 0.648e3 * t1488 * t1491 - 0.648e3 * t1488 * t1501;
  t2607 = t1373 * t1406;
  t2612 = t840 * t841 * t780 * t895;
  t2620 = 0.1e1 / t7 / t83;
  t2645 = -0.435456e6 * t827 * t829 * t1504 * t772 + 0.1306368e7 * t827 * t1495 * t1504 * t746 + 0.108e3 * t805 * t806 * t20 * t811 + 0.486e3 * t808 * t458 * t1562 * t897 - 0.1741824e7 * t827 * t30 * t1910 * params->b_PBE * t830 * t897 - 0.486e3 * t808 * t820 * t1500 - 0.145152e6 * t827 * t829 * t830 * t1121 - 0.162e3 * t1515 * t1517 * t1518 * t744 * t746 - 0.145152e6 * t2607 * t1412 + 0.435456e6 * t2612 * t1408 * t1409 * t25 * t746 - t1150 * t102 * t2620 * t1111 * t1092 * t30 * t1883 * t28 * t788 / 0.6e1 + 0.448e3 / 0.3e1 * t166 * t1092 * t170 * t215 * t2620 * t844 * t159 * t1106 * t102 * t1111 * t30 * t1883 - 0.435456e6 * t626 * t170 * t826 * t832;
  t2678 = t840 * t1377 * t1405;
  t2705 = t1368 * t1406;
  t2708 = -0.435456e6 * t827 * t829 * t618 * t25 * t442 - 0.435456e6 * t824 * t17 * t735 * t216 * t832 - 0.870912e6 * t1425 * t1506 + 0.162e3 * t1515 * t1516 * t349 * t1520 + 0.162e3 * t1515 * t1517 * t170 * t422 * t1519 + 0.81e2 * t1515 * t1517 * t1518 * t428 * t772 + 0.9e1 * t1392 * t1393 * t1349 * t5 * t1521 - 0.290304e6 * t2678 * t1412 - 0.290304e6 * t1407 * t430 * params->ax * t1411 - 0.145152e6 * t1407 * t1408 * t1409 * t25 * t772 - 0.16128e5 * t1351 * t1353 * t744 * params->b_PBE * t159 * t474 * t75 * t478 * t5 * t1410 + 0.81e2 * t234 * t781 * t12 * t367 * t1521 - 0.290304e6 * t2705 * t1412;
  t2712 = my_piecewise3(t2, 0, t2370 + t2424 + t2459 + t2497 + t2539 + t2571 + t2645 + t2708);
  tv4rho3sigma0 = 0.2e1 * t2712;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  t2713 = t854 * t442;
  t2744 = t762 * t30 * t478;
  t2756 = t349 * t349;
  t2797 = 0.501645312e9 * t2612 * t865 * t2713 * t1535 - 0.334430208e9 * t1407 * t853 * t159 * t854 * t349 * t1535 + 0.373248e6 * t1527 * t159 * t35 * t1529 * t1532 * t428 * params->ax * t118 * t15 * t349 - 0.373248e6 * t1531 * t1532 * t744 * params->ax * t118 * t15 * t442 - 0.18579456e8 * t1351 * t1353 * t744 * t866 * t2744 + 0.20736e5 * t1527 * t856 * t1349 * t170 * t1354 * t2744 + 0.1119744e7 * t1545 * t1549 - 0.752467968e9 * t459 * t864 * t853 * t2756 * t854 - 0.1003290624e10 * t1481 * t867 - 0.167215104e9 * t1484 * t867 + 0.839808e6 * t855 * t28 * t2756 * t46 * t861 + 0.186624e6 * t855 * t857 * t20 * t861 + 0.419904e6 * t859 * t171 * t736 * t428 - 0.376233984e9 * t1455 * t867 - 0.752467968e9 * t1458 * t867 - 0.1003290624e10 * t1463 * t867 - 0.376233984e9 * t1445 * t867 - 0.1679616e7 * t859 * t820 * t1552 - 0.839808e6 * t859 * t458 * t864 * t772 + 0.1679616e7 * t1539 * t820 * t1540;
  t2831 = t216 * t1910;
  t2867 = 0.839808e6 * t1539 * t458 * t809 * t618 + 0.2519424e7 * t859 * t458 * t1562 * t746 + 0.2239488e7 * t855 * t1487 * t1541 - 0.752467968e9 * t459 * t1569 * t1570 * t618 + 0.2257403904e10 * t821 * t1566 - 0.1504935936e10 * t821 * t1572 + 0.1128701952e10 * t459 * t1563 * t1564 * t772 + 0.2257403904e10 * t814 * t1566 - 0.1504935936e10 * t814 * t1572 + 0.3009871872e10 * t817 * t1566 - 0.2006581248e10 * t817 * t1572 - 0.2239488e7 * t1545 * t1553 - 0.4514807808e10 * t459 * t2831 * t853 * t1564 * t746 + 0.4514807808e10 * t827 * t895 * t853 * t159 * t2713 * t349 - 0.3359232e7 * t1527 * t159 * t46 * t170 * t826 * t744 * t349 * t442 + 0.93312e5 * t1527 * t856 * t367 * t1529 * t1536 + 0.186624e6 * t1531 * t422 * t780 * t428 * t1535 - 0.167215104e9 * t2705 * t1575 - 0.83607552e8 * t2607 * t1575 - 0.167215104e9 * t2678 * t1575;
  t2869 = my_piecewise3(t2, 0, t2797 + t2867);
  tv4rho2sigma20 = 0.2e1 * t2869;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2870 = t1582 * t28;
  t2876 = t30 * params->ax * t1409;
  t2909 = t1581 * t5;
  t2925 = -0.362797056e9 * t2870 * t1583 * t35 * t1529 * t1532 * t744 * t2876 - 0.3265173504e10 * t2870 * t856 * t46 * t170 * t826 * t745 * t349 - 0.1451188224e10 * t1582 * t1584 * t18 * t1588 - 0.1088391168e10 * t1586 * t820 * t1587 + 0.3265173504e10 * t2870 * t1583 * t46 * t170 * t826 * t896 * t442 + 0.975198486528e12 * t814 * t1594 + 0.1300264648704e13 * t817 * t1594 + 0.975198486528e12 * t821 * t1594 - 0.3900793946112e13 * t827 * t1910 * t1580 * t1583 * t2909 * t442 + 0.2925595459584e13 * t827 * t895 * t1580 * t856 * t2909 * t349 + 0.325066162176e12 * t2612 * t1580 * t1583 * t1581 * t2876;
  t2926 = my_piecewise3(t2, 0, t2925);
  tv4rhosigma30 = 0.2e1 * t2926;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  t2927 = t853 * t853;
  t2928 = t854 * t854;
  t2930 = t856 * t856;
  t2945 = my_piecewise3(t2, 0, 0.3761479876608e13 * t2927 * t2928 * t28 * t2930 * t46 * t458 * t1562 * t30 - 0.3370285969440768e16 * t459 * t2831 * t2927 * t2930 * t2928 * t30);
  tv4sigma40 = 0.2e1 * t2945;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t18, t19, t23, t25, t26, t27, t28;
  double t29, t31, t32, t34, t37, t38, t39, t40;
  double t41, t42, t43, t44, t46, t49, t51, t52;
  double t53, t54, t55, t58, t59, t60, t61, t69;
  double t71, t72, t73, t75, t76, t77, t79, t82;
  double t87, t93, t94, t98, t99, t101, t102, t103;
  double t104, t106, t110, t114, t116, t117, t118, t123;
  double t124, t129, t138, t139, t142, t145, t146, t150;
  double t152, t153, t154, t155, t158, t159, t160, t161;
  double t162, t163, t164, t165, t166, t169, t171, t177;
  double t178, t179, t182, t183, t184, t187, t190, t194;
  double t196, t197, t202, t203, t206, t210, t211, t212;
  double t213, t216, t217, t218, t219, t220, t224, t226;
  double t227, t231, t232, t233, t234, t238, t240, t243;
  double t244, t252, t253, t255, t256, t273, t274, t275;
  double t277, t281, t285, t287, t292, t297, t305, t308;
  double t311, t314, t315, t319, t321, t322, t323, t324;
  double t325, t326, t327, t328, t329, t330, t331, t332;
  double t335, t337, t343, t344, t345, t348, t349, t350;
  double t353, t356, t360, t362, t368, t369, t372, t376;
  double t377, t378, t379, t382, tzk0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRTPI;
  t3 = 0.1e1 / t2;
  t4 = p->hyb_omega[0] * p->hyb_omega[0];
  t5 = params->ax * t4;
  t6 = M_CBRT3;
  t7 = t5 * t6;
  t8 = t2 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = POW_1_3(rho[0]);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t23 = exp(-t7 * t16 * t19 / 0.12e2);
  t25 = params->b_PBE * t23 * sigma[0];
  t26 = t6 * t12;
  t27 = params->kappa + 0.1e1;
  t28 = t6 * t6;
  t29 = t2 * t2;
  t31 = t28 / t29;
  t32 = 0.1e1 / t17;
  t34 = 0.1e1 / t13;
  t37 = t31 * p->hyb_omega[0] * t32 * t34 / 0.6e1;
  t38 = t37 < 0.5e-1;
  t39 = t14 * t14;
  t40 = M_PI * M_PI;
  t41 = t29 * t40;
  t42 = t39 * t41;
  t43 = t17 * rho[0];
  t44 = t42 * t43;
  t46 = t14 * t8;
  t49 = t46 * t6 * t18 * t4;
  t51 = 0.7e1 * t44 - 0.6e1 * t49;
  t52 = t14 * t13;
  t53 = 0.1e1 / p->hyb_omega[0];
  t54 = t53 * t6;
  t55 = t29 * t13;
  t58 = erf(t54 * t55 * t17);
  t59 = t52 * t58;
  t60 = sqrt(M_PI);
  t61 = t60 * t40;
  t69 = t4 * t4;
  t71 = 0.6e1 * t28 * t69;
  t72 = -0.36e2 * t59 * t61 * t28 * rho[0] * p->hyb_omega[0] + 0.81e2 * t44 + 0.54e2 * t49 - t71;
  t73 = 0.1e1 / t72;
  t75 = 0.1e11 < t37;
  t76 = t40 * t40;
  t77 = rho[0] * rho[0];
  t79 = t39 * t14;
  t82 = t8 * t28;
  t87 = t41 * t6;
  t93 = t69 * t4;
  t94 = 0.1e1 / t93;
  t98 = 0.1e1 / t4;
  t99 = t98 * t28;
  t101 = t99 * t46 * t18;
  t102 = exp(t101);
  t103 = t102 * t6;
  t104 = t103 * t14;
  t106 = t8 * t18 * t4;
  t110 = t102 * t28;
  t114 = (0.7e1 * t104 * t106 - 0.6e1 * t110 * t69 + 0.6e1 * t44 + 0.11e2 * t49 + t71) * t8;
  t116 = t14 * t6;
  t117 = t39 * t102;
  t118 = t41 * t28;
  t123 = t52 * t102 * t58;
  t124 = t61 * t6;
  t129 = t14 * t102;
  t138 = 0.2e1 * t69 * t6;
  t139 = 0.12e2 * t123 * t124 * rho[0] * p->hyb_omega[0] - 0.9e1 * t117 * t118 * t43 + 0.12e2 * t46 * t18 * t4 + 0.2e1 * t103 * t69 - 0.18e2 * t129 * t106 - t138;
  t142 = t116 * t98 / t139;
  t145 = my_piecewise5(t38, t51 * t73, t75, (0.28e4 * t82 * t18 * t69 * t14 - 0.14e3 * t87 * t43 * t4 * t39 - 0.1863e4 * t76 * t77 * t79) * t94 / 0.504e5, -t114 * t18 * t142 / 0.9e1);
  t146 = t27 * t145;
  t150 = t18 * t77;
  t152 = params->kappa * t150 * t8;
  t153 = 0.27e2 / 0.56e2 * t25 * t26 * t146 + t152;
  t154 = t3 * t153;
  t155 = t154 * t6;
  t158 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t159 = t158 * t43;
  t160 = 0.135e1 <= t37;
  t161 = 0.135e1 < t37;
  t162 = my_piecewise3(t161, t37, 0.135e1);
  t163 = t162 * t162;
  t164 = t163 * t163;
  t165 = t164 * t163;
  t166 = t164 * t164;
  t169 = t166 * t164;
  t171 = t166 * t163;
  t177 = 0.240888840192e14 * t166 * t165 + 0.19448e5 * t163 - 0.80784e6 * t164 + 0.3055104e8 * t165 - 0.104552448e10 * t166 - 0.90333315072e12 * t169 + 0.3226189824e11 * t171 - 0.429e3;
  t178 = t166 * t166;
  t179 = 0.1e1 / t178;
  t182 = my_piecewise3(t161, 0.135e1, t37);
  t183 = t182 * t182;
  t184 = t183 * t183;
  t187 = 0.32e2 * t184 - 0.16e2 * t183;
  t190 = exp(-0.1e1 / t183 / 0.4e1);
  t194 = 0.1e1 / t182;
  t196 = erf(t194 / 0.2e1);
  t197 = t60 * t196;
  t202 = my_piecewise3(t160, t177 * t179 / 0.8671998246912e15, t187 * t190 / 0.3e1 - 0.32e2 / 0.3e1 * t184 - 0.8e1 / 0.3e1 * t197 * t182 + 0.8e1 * t183 + 0.1e1);
  t203 = params->b_PBE * t145;
  t206 = sigma[0] * t12 * t6;
  t210 = 0.216e3 * t203 * t23 * t206 + 0.448e3 * t152;
  t211 = 0.1e1 / t210;
  t212 = t202 * t211;
  t213 = t159 * t212;
  t216 = my_piecewise3(t1, 0, -0.168e3 * t155 * t213);
  t217 = rho[1] <= p->dens_threshold;
  t218 = POW_1_3(rho[1]);
  t219 = t218 * t218;
  t220 = 0.1e1 / t219;
  t224 = exp(-t7 * t16 * t220 / 0.12e2);
  t226 = params->b_PBE * t224 * sigma[2];
  t227 = 0.1e1 / t218;
  t231 = t31 * p->hyb_omega[0] * t227 * t34 / 0.6e1;
  t232 = t231 < 0.5e-1;
  t233 = t218 * rho[1];
  t234 = t42 * t233;
  t238 = t46 * t6 * t219 * t4;
  t240 = 0.7e1 * t234 - 0.6e1 * t238;
  t243 = erf(t54 * t55 * t218);
  t244 = t52 * t243;
  t252 = -0.36e2 * t244 * t61 * t28 * rho[1] * p->hyb_omega[0] + 0.81e2 * t234 + 0.54e2 * t238 - t71;
  t253 = 0.1e1 / t252;
  t255 = 0.1e11 < t231;
  t256 = rho[1] * rho[1];
  t273 = t99 * t46 * t219;
  t274 = exp(t273);
  t275 = t274 * t219;
  t277 = t46 * t4;
  t281 = t274 * t28;
  t285 = (0.7e1 * t275 * t6 * t277 - 0.6e1 * t281 * t69 + 0.6e1 * t234 + 0.11e2 * t238 + t71) * t8;
  t287 = t39 * t274;
  t292 = t52 * t274 * t243;
  t297 = t14 * t274;
  t305 = t274 * t6;
  t308 = 0.12e2 * t292 * t124 * rho[1] * p->hyb_omega[0] - 0.18e2 * t297 * t8 * t219 * t4 - 0.9e1 * t287 * t118 * t233 + 0.12e2 * t46 * t219 * t4 + 0.2e1 * t305 * t69 - t138;
  t311 = t116 * t98 / t308;
  t314 = my_piecewise5(t232, t240 * t253, t255, (0.28e4 * t82 * t219 * t69 * t14 - 0.14e3 * t87 * t233 * t4 * t39 - 0.1863e4 * t76 * t256 * t79) * t94 / 0.504e5, -t285 * t219 * t311 / 0.9e1);
  t315 = t27 * t314;
  t319 = t219 * t256;
  t321 = params->kappa * t319 * t8;
  t322 = 0.27e2 / 0.56e2 * t226 * t26 * t315 + t321;
  t323 = t3 * t322;
  t324 = t323 * t6;
  t325 = t158 * t233;
  t326 = 0.135e1 <= t231;
  t327 = 0.135e1 < t231;
  t328 = my_piecewise3(t327, t231, 0.135e1);
  t329 = t328 * t328;
  t330 = t329 * t329;
  t331 = t330 * t329;
  t332 = t330 * t330;
  t335 = t332 * t330;
  t337 = t332 * t329;
  t343 = 0.240888840192e14 * t332 * t331 + 0.19448e5 * t329 - 0.80784e6 * t330 + 0.3055104e8 * t331 - 0.104552448e10 * t332 - 0.90333315072e12 * t335 + 0.3226189824e11 * t337 - 0.429e3;
  t344 = t332 * t332;
  t345 = 0.1e1 / t344;
  t348 = my_piecewise3(t327, 0.135e1, t231);
  t349 = t348 * t348;
  t350 = t349 * t349;
  t353 = 0.32e2 * t350 - 0.16e2 * t349;
  t356 = exp(-0.1e1 / t349 / 0.4e1);
  t360 = 0.1e1 / t348;
  t362 = erf(t360 / 0.2e1);
  t368 = my_piecewise3(t326, t343 * t345 / 0.8671998246912e15, t353 * t356 / 0.3e1 - 0.32e2 / 0.3e1 * t350 - 0.8e1 / 0.3e1 * t362 * t348 * t60 + 0.8e1 * t349 + 0.1e1);
  t369 = params->b_PBE * t314;
  t372 = sigma[2] * t12 * t6;
  t376 = 0.216e3 * t369 * t224 * t372 + 0.448e3 * t321;
  t377 = 0.1e1 / t376;
  t378 = t368 * t377;
  t379 = t325 * t378;
  t382 = my_piecewise3(t217, 0, -0.168e3 * t324 * t379);
  tzk0 = (t216 + t382) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t18, t19, t23, t25, t26, t27, t28;
  double t29, t31, t32, t34, t37, t38, t39, t40;
  double t41, t42, t43, t44, t46, t49, t51, t52;
  double t53, t54, t55, t58, t59, t60, t61, t69;
  double t71, t72, t73, t75, t76, t77, t79, t82;
  double t87, t93, t94, t98, t99, t101, t102, t103;
  double t104, t106, t110, t114, t116, t117, t118, t123;
  double t124, t129, t138, t139, t142, t145, t146, t150;
  double t152, t153, t154, t155, t158, t159, t160, t161;
  double t162, t163, t164, t165, t166, t169, t171, t177;
  double t178, t179, t182, t183, t184, t187, t190, t194;
  double t196, t197, t202, t203, t206, t210, t211, t212;
  double t213, t216, t217, t218, t219, t220, t224, t226;
  double t227, t231, t232, t233, t234, t238, t240, t243;
  double t244, t252, t253, t255, t256, t273, t274, t275;
  double t277, t281, t285, t287, t292, t297, t305, t308;
  double t311, t314, t315, t319, t321, t322, t323, t324;
  double t325, t326, t327, t328, t329, t330, t331, t332;
  double t335, t337, t343, t344, t345, t348, t349, t350;
  double t353, t356, t360, t362, t368, t369, t372, t376;
  double t377, t378, t379, t382, tzk0;

  double t390, t391, t392, t394, t395, t396, t400, t402;
  double t404, t406, t408, t409, t410, t411, t416, t421;
  double t424, t443, t448, t455, t456, t457, t458, t459;
  double t460, t461, t470, t471, t472, t473, t474, t476;
  double t481, t482, t486, t494, t496, t500, t501, t506;
  double t508, t509, t510, t513, t514, t517, t518, t519;
  double t523, t524, t527, t528, t531, t534, t543, t547;
  double t548, t552, t553, t554, t556, t558, t561, t562;
  double t563, t567, t574, t575, t576, t579, t580, t581;
  double t582, t583, t584, t588, t589, t592, t593, t597;
  double t598, t599, tvrho0, t603, t604, t606, t607, t611;
  double t613, t615, t617, t619, t620, t621, t622, t630;
  double t633, t651, t652, t657, t664, t665, t666, t667;
  double t677, t678, t691, t693, t697, t698, t703, t705;
  double t706, t707, t710, t711, t714, t715, t716, t720;
  double t721, t724, t725, t728, t731, t740, t744, t745;
  double t749, t750, t751, t753, t755, t758, t759, t760;
  double t764, t772, t773, t774, t777, t778, t779, t780;
  double t781, t785, t788, t789, t793, t794, t795, tvrho1;
  double t799, t800, t802, t803, t804, t808, t809, t810;
  double t811, t812, t814, t815, tvsigma0, tvsigma1, t819, t821;
  double t822, t823, t827, t828, t829, t830, t832, t833;
  double tvsigma2;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRTPI;
  t3 = 0.1e1 / t2;
  t4 = p->hyb_omega[0] * p->hyb_omega[0];
  t5 = params->ax * t4;
  t6 = M_CBRT3;
  t7 = t5 * t6;
  t8 = t2 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = POW_1_3(rho[0]);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t23 = exp(-t7 * t16 * t19 / 0.12e2);
  t25 = params->b_PBE * t23 * sigma[0];
  t26 = t6 * t12;
  t27 = params->kappa + 0.1e1;
  t28 = t6 * t6;
  t29 = t2 * t2;
  t31 = t28 / t29;
  t32 = 0.1e1 / t17;
  t34 = 0.1e1 / t13;
  t37 = t31 * p->hyb_omega[0] * t32 * t34 / 0.6e1;
  t38 = t37 < 0.5e-1;
  t39 = t14 * t14;
  t40 = M_PI * M_PI;
  t41 = t29 * t40;
  t42 = t39 * t41;
  t43 = t17 * rho[0];
  t44 = t42 * t43;
  t46 = t14 * t8;
  t49 = t46 * t6 * t18 * t4;
  t51 = 0.7e1 * t44 - 0.6e1 * t49;
  t52 = t14 * t13;
  t53 = 0.1e1 / p->hyb_omega[0];
  t54 = t53 * t6;
  t55 = t29 * t13;
  t58 = erf(t54 * t55 * t17);
  t59 = t52 * t58;
  t60 = sqrt(M_PI);
  t61 = t60 * t40;
  t69 = t4 * t4;
  t71 = 0.6e1 * t28 * t69;
  t72 = -0.36e2 * t59 * t61 * t28 * rho[0] * p->hyb_omega[0] + 0.81e2 * t44 + 0.54e2 * t49 - t71;
  t73 = 0.1e1 / t72;
  t75 = 0.1e11 < t37;
  t76 = t40 * t40;
  t77 = rho[0] * rho[0];
  t79 = t39 * t14;
  t82 = t8 * t28;
  t87 = t41 * t6;
  t93 = t69 * t4;
  t94 = 0.1e1 / t93;
  t98 = 0.1e1 / t4;
  t99 = t98 * t28;
  t101 = t99 * t46 * t18;
  t102 = exp(t101);
  t103 = t102 * t6;
  t104 = t103 * t14;
  t106 = t8 * t18 * t4;
  t110 = t102 * t28;
  t114 = (0.7e1 * t104 * t106 - 0.6e1 * t110 * t69 + 0.6e1 * t44 + 0.11e2 * t49 + t71) * t8;
  t116 = t14 * t6;
  t117 = t39 * t102;
  t118 = t41 * t28;
  t123 = t52 * t102 * t58;
  t124 = t61 * t6;
  t129 = t14 * t102;
  t138 = 0.2e1 * t69 * t6;
  t139 = 0.12e2 * t123 * t124 * rho[0] * p->hyb_omega[0] - 0.9e1 * t117 * t118 * t43 + 0.12e2 * t46 * t18 * t4 + 0.2e1 * t103 * t69 - 0.18e2 * t129 * t106 - t138;
  t142 = t116 * t98 / t139;
  t145 = my_piecewise5(t38, t51 * t73, t75, (0.28e4 * t82 * t18 * t69 * t14 - 0.14e3 * t87 * t43 * t4 * t39 - 0.1863e4 * t76 * t77 * t79) * t94 / 0.504e5, -t114 * t18 * t142 / 0.9e1);
  t146 = t27 * t145;
  t150 = t18 * t77;
  t152 = params->kappa * t150 * t8;
  t153 = 0.27e2 / 0.56e2 * t25 * t26 * t146 + t152;
  t154 = t3 * t153;
  t155 = t154 * t6;
  t158 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t159 = t158 * t43;
  t160 = 0.135e1 <= t37;
  t161 = 0.135e1 < t37;
  t162 = my_piecewise3(t161, t37, 0.135e1);
  t163 = t162 * t162;
  t164 = t163 * t163;
  t165 = t164 * t163;
  t166 = t164 * t164;
  t169 = t166 * t164;
  t171 = t166 * t163;
  t177 = 0.240888840192e14 * t166 * t165 + 0.19448e5 * t163 - 0.80784e6 * t164 + 0.3055104e8 * t165 - 0.104552448e10 * t166 - 0.90333315072e12 * t169 + 0.3226189824e11 * t171 - 0.429e3;
  t178 = t166 * t166;
  t179 = 0.1e1 / t178;
  t182 = my_piecewise3(t161, 0.135e1, t37);
  t183 = t182 * t182;
  t184 = t183 * t183;
  t187 = 0.32e2 * t184 - 0.16e2 * t183;
  t190 = exp(-0.1e1 / t183 / 0.4e1);
  t194 = 0.1e1 / t182;
  t196 = erf(t194 / 0.2e1);
  t197 = t60 * t196;
  t202 = my_piecewise3(t160, t177 * t179 / 0.8671998246912e15, t187 * t190 / 0.3e1 - 0.32e2 / 0.3e1 * t184 - 0.8e1 / 0.3e1 * t197 * t182 + 0.8e1 * t183 + 0.1e1);
  t203 = params->b_PBE * t145;
  t206 = sigma[0] * t12 * t6;
  t210 = 0.216e3 * t203 * t23 * t206 + 0.448e3 * t152;
  t211 = 0.1e1 / t210;
  t212 = t202 * t211;
  t213 = t159 * t212;
  t216 = my_piecewise3(t1, 0, -0.168e3 * t155 * t213);
  t217 = rho[1] <= p->dens_threshold;
  t218 = POW_1_3(rho[1]);
  t219 = t218 * t218;
  t220 = 0.1e1 / t219;
  t224 = exp(-t7 * t16 * t220 / 0.12e2);
  t226 = params->b_PBE * t224 * sigma[2];
  t227 = 0.1e1 / t218;
  t231 = t31 * p->hyb_omega[0] * t227 * t34 / 0.6e1;
  t232 = t231 < 0.5e-1;
  t233 = t218 * rho[1];
  t234 = t42 * t233;
  t238 = t46 * t6 * t219 * t4;
  t240 = 0.7e1 * t234 - 0.6e1 * t238;
  t243 = erf(t54 * t55 * t218);
  t244 = t52 * t243;
  t252 = -0.36e2 * t244 * t61 * t28 * rho[1] * p->hyb_omega[0] + 0.81e2 * t234 + 0.54e2 * t238 - t71;
  t253 = 0.1e1 / t252;
  t255 = 0.1e11 < t231;
  t256 = rho[1] * rho[1];
  t273 = t99 * t46 * t219;
  t274 = exp(t273);
  t275 = t274 * t219;
  t277 = t46 * t4;
  t281 = t274 * t28;
  t285 = (0.7e1 * t275 * t6 * t277 - 0.6e1 * t281 * t69 + 0.6e1 * t234 + 0.11e2 * t238 + t71) * t8;
  t287 = t39 * t274;
  t292 = t52 * t274 * t243;
  t297 = t14 * t274;
  t305 = t274 * t6;
  t308 = 0.12e2 * t292 * t124 * rho[1] * p->hyb_omega[0] - 0.18e2 * t297 * t8 * t219 * t4 - 0.9e1 * t287 * t118 * t233 + 0.12e2 * t46 * t219 * t4 + 0.2e1 * t305 * t69 - t138;
  t311 = t116 * t98 / t308;
  t314 = my_piecewise5(t232, t240 * t253, t255, (0.28e4 * t82 * t219 * t69 * t14 - 0.14e3 * t87 * t233 * t4 * t39 - 0.1863e4 * t76 * t256 * t79) * t94 / 0.504e5, -t285 * t219 * t311 / 0.9e1);
  t315 = t27 * t314;
  t319 = t219 * t256;
  t321 = params->kappa * t319 * t8;
  t322 = 0.27e2 / 0.56e2 * t226 * t26 * t315 + t321;
  t323 = t3 * t322;
  t324 = t323 * t6;
  t325 = t158 * t233;
  t326 = 0.135e1 <= t231;
  t327 = 0.135e1 < t231;
  t328 = my_piecewise3(t327, t231, 0.135e1);
  t329 = t328 * t328;
  t330 = t329 * t329;
  t331 = t330 * t329;
  t332 = t330 * t330;
  t335 = t332 * t330;
  t337 = t332 * t329;
  t343 = 0.240888840192e14 * t332 * t331 + 0.19448e5 * t329 - 0.80784e6 * t330 + 0.3055104e8 * t331 - 0.104552448e10 * t332 - 0.90333315072e12 * t335 + 0.3226189824e11 * t337 - 0.429e3;
  t344 = t332 * t332;
  t345 = 0.1e1 / t344;
  t348 = my_piecewise3(t327, 0.135e1, t231);
  t349 = t348 * t348;
  t350 = t349 * t349;
  t353 = 0.32e2 * t350 - 0.16e2 * t349;
  t356 = exp(-0.1e1 / t349 / 0.4e1);
  t360 = 0.1e1 / t348;
  t362 = erf(t360 / 0.2e1);
  t368 = my_piecewise3(t326, t343 * t345 / 0.8671998246912e15, t353 * t356 / 0.3e1 - 0.32e2 / 0.3e1 * t350 - 0.8e1 / 0.3e1 * t362 * t348 * t60 + 0.8e1 * t349 + 0.1e1);
  t369 = params->b_PBE * t314;
  t372 = sigma[2] * t12 * t6;
  t376 = 0.216e3 * t369 * t224 * t372 + 0.448e3 * t321;
  t377 = 0.1e1 / t376;
  t378 = t368 * t377;
  t379 = t325 * t378;
  t382 = my_piecewise3(t217, 0, -0.168e3 * t324 * t379);
  tzk0 = (t216 + t382) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t390 = params->b_PBE * params->ax * t4 * t28 * t9 * t15;
  t391 = t18 * rho[0];
  t392 = 0.1e1 / t391;
  t394 = t392 * t23 * sigma[0];
  t395 = t12 * t27;
  t396 = t395 * t145;
  t400 = t42 * t17;
  t402 = t6 * t32;
  t404 = t46 * t402 * t4;
  t406 = 0.28e2 / 0.3e1 * t400 - 0.4e1 * t404;
  t408 = t72 * t72;
  t409 = 0.1e1 / t408;
  t410 = t51 * t409;
  t411 = exp(-t101);
  t416 = t61 * t28 * p->hyb_omega[0];
  t421 = -0.72e2 * t42 * t411 * t17 - 0.36e2 * t59 * t416 + 0.108e3 * t400 + 0.36e2 * t404;
  t424 = t76 * rho[0];
  t443 = t8 * t32 * t4;
  t448 = (0.8e1 * t400 + 0.14e2 * t42 * t17 * t102 - 0.22e2 / 0.3e1 * t104 * t443 + 0.22e2 / 0.3e1 * t404) * t8;
  t455 = t18 * t14;
  t456 = t114 * t455;
  t457 = t6 * t98;
  t458 = t139 * t139;
  t459 = 0.1e1 / t458;
  t460 = t79 * t98;
  t461 = t460 * t6;
  t470 = t40 * M_PI;
  t471 = pow(M_PI, 0.1e1 / 0.6e1);
  t472 = t471 * t471;
  t473 = t472 * t472;
  t474 = t473 * t471;
  t476 = t39 * t13 * t53 * t474 * t470;
  t481 = t117 * t41;
  t482 = t411 * t28;
  t486 = t124 * p->hyb_omega[0];
  t494 = 0.24e2 * t476 * t18 * t102 * t58 - 0.18e2 * t461 * t424 * t102 - 0.24e2 * t117 * t118 * t17 + 0.8e1 * t481 * t482 * t17 + 0.8e1 * t46 * t32 * t4 + 0.12e2 * t123 * t486 - 0.8e1 * t129 * t443;
  t496 = t457 * t459 * t494;
  t500 = my_piecewise5(t38, t406 * t73 - t410 * t421, t75, (-0.3726e4 * t424 * t79 + 0.56e4 / 0.3e1 * t82 * t32 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t17 * t4 * t39) * t94 / 0.504e5, -t448 * t18 * t142 / 0.9e1 - 0.2e1 / 0.27e2 * t114 * t32 * t142 + t456 * t496 / 0.9e1);
  t501 = t27 * t500;
  t506 = params->kappa * t391 * t8;
  t508 = 0.3e1 / 0.112e3 * t390 * t394 * t396 + 0.27e2 / 0.56e2 * t25 * t26 * t501 + 0.8e1 / 0.3e1 * t506;
  t509 = t3 * t508;
  t510 = t509 * t6;
  t513 = t158 * t17;
  t514 = t513 * t212;
  t517 = t164 * t162;
  t518 = t166 * t517;
  t519 = 0.1e1 / t43;
  t523 = t31 * p->hyb_omega[0] * t519 * t34 / 0.18e2;
  t524 = my_piecewise3(t161, -t523, 0);
  t527 = t163 * t162;
  t528 = t166 * t527;
  t531 = t166 * t162;
  t534 = t164 * t527;
  t543 = 0.38896e5 * t162 * t524 + 0.18330624e9 * t517 * t524 + 0.3372443762688e15 * t518 * t524 - 0.323136e7 * t527 * t524 - 0.1083999780864e14 * t528 * t524 + 0.3226189824e12 * t531 * t524 - 0.836419584e10 * t534 * t524;
  t547 = 0.1e1 / t178 / t162;
  t548 = t177 * t547;
  t552 = t183 * t182;
  t553 = my_piecewise3(t161, 0, -t523);
  t554 = t552 * t553;
  t556 = t182 * t553;
  t558 = 0.128e3 * t554 - 0.32e2 * t556;
  t561 = 0.1e1 / t552;
  t562 = t187 * t561;
  t563 = t553 * t190;
  t567 = t190 * t194;
  t574 = my_piecewise3(t160, t543 * t179 / 0.8671998246912e15 - t548 * t524 / 0.541999890432e14, t558 * t190 / 0.3e1 + t562 * t563 / 0.6e1 - 0.128e3 / 0.3e1 * t554 + 0.8e1 / 0.3e1 * t567 * t553 - 0.8e1 / 0.3e1 * t197 * t553 + 0.16e2 * t556);
  t575 = t574 * t211;
  t576 = t159 * t575;
  t579 = t6 * t158;
  t580 = t154 * t579;
  t581 = t43 * t202;
  t582 = t210 * t210;
  t583 = 0.1e1 / t582;
  t584 = params->b_PBE * t500;
  t588 = t5 * t28;
  t589 = t203 * t588;
  t592 = t23 * sigma[0] * t12;
  t593 = t16 * t392 * t592;
  t597 = 0.216e3 * t584 * t23 * t206 + 0.12e2 * t589 * t593 + 0.3584e4 / 0.3e1 * t506;
  t598 = t583 * t597;
  t599 = t581 * t598;
  tvrho0 = my_piecewise3(t1, 0, -0.224e3 * t155 * t514 - 0.168e3 * t155 * t576 - 0.168e3 * t510 * t213 + 0.168e3 * t580 * t599);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t603 = t219 * rho[1];
  t604 = 0.1e1 / t603;
  t606 = t604 * t224 * sigma[2];
  t607 = t395 * t314;
  t611 = t42 * t218;
  t613 = t6 * t227;
  t615 = t46 * t613 * t4;
  t617 = 0.28e2 / 0.3e1 * t611 - 0.4e1 * t615;
  t619 = t252 * t252;
  t620 = 0.1e1 / t619;
  t621 = t240 * t620;
  t622 = exp(-t273);
  t630 = -0.72e2 * t42 * t622 * t218 - 0.36e2 * t244 * t416 + 0.108e3 * t611 + 0.36e2 * t615;
  t633 = t76 * rho[1];
  t651 = t274 * t227;
  t652 = t651 * t6;
  t657 = (0.8e1 * t611 + 0.14e2 * t42 * t218 * t274 - 0.22e2 / 0.3e1 * t652 * t277 + 0.22e2 / 0.3e1 * t615) * t8;
  t664 = t219 * t14;
  t665 = t285 * t664;
  t666 = t308 * t308;
  t667 = 0.1e1 / t666;
  t677 = t287 * t41;
  t678 = t622 * t28;
  t691 = -0.8e1 * t297 * t8 * t227 * t4 - 0.24e2 * t287 * t118 * t218 + 0.8e1 * t677 * t678 * t218 + 0.8e1 * t46 * t227 * t4 + 0.24e2 * t476 * t275 * t243 - 0.18e2 * t461 * t633 * t274 + 0.12e2 * t292 * t486;
  t693 = t457 * t667 * t691;
  t697 = my_piecewise5(t232, t617 * t253 - t621 * t630, t255, (-0.3726e4 * t633 * t79 + 0.56e4 / 0.3e1 * t82 * t227 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t218 * t4 * t39) * t94 / 0.504e5, -t657 * t219 * t311 / 0.9e1 - 0.2e1 / 0.27e2 * t285 * t227 * t311 + t665 * t693 / 0.9e1);
  t698 = t27 * t697;
  t703 = params->kappa * t603 * t8;
  t705 = 0.3e1 / 0.112e3 * t390 * t606 * t607 + 0.27e2 / 0.56e2 * t226 * t26 * t698 + 0.8e1 / 0.3e1 * t703;
  t706 = t3 * t705;
  t707 = t706 * t6;
  t710 = t158 * t218;
  t711 = t710 * t378;
  t714 = t330 * t328;
  t715 = t332 * t714;
  t716 = 0.1e1 / t233;
  t720 = t31 * p->hyb_omega[0] * t716 * t34 / 0.18e2;
  t721 = my_piecewise3(t327, -t720, 0);
  t724 = t329 * t328;
  t725 = t332 * t724;
  t728 = t332 * t328;
  t731 = t330 * t724;
  t740 = 0.38896e5 * t328 * t721 + 0.18330624e9 * t714 * t721 + 0.3372443762688e15 * t715 * t721 - 0.323136e7 * t724 * t721 - 0.1083999780864e14 * t725 * t721 + 0.3226189824e12 * t728 * t721 - 0.836419584e10 * t731 * t721;
  t744 = 0.1e1 / t344 / t328;
  t745 = t343 * t744;
  t749 = t349 * t348;
  t750 = my_piecewise3(t327, 0, -t720);
  t751 = t749 * t750;
  t753 = t348 * t750;
  t755 = 0.128e3 * t751 - 0.32e2 * t753;
  t758 = 0.1e1 / t749;
  t759 = t353 * t758;
  t760 = t750 * t356;
  t764 = t356 * t360;
  t772 = my_piecewise3(t326, t740 * t345 / 0.8671998246912e15 - t745 * t721 / 0.541999890432e14, t755 * t356 / 0.3e1 + t759 * t760 / 0.6e1 - 0.128e3 / 0.3e1 * t751 + 0.8e1 / 0.3e1 * t764 * t750 - 0.8e1 / 0.3e1 * t362 * t750 * t60 + 0.16e2 * t753);
  t773 = t772 * t377;
  t774 = t325 * t773;
  t777 = t323 * t579;
  t778 = t233 * t368;
  t779 = t376 * t376;
  t780 = 0.1e1 / t779;
  t781 = params->b_PBE * t697;
  t785 = t369 * t588;
  t788 = t224 * sigma[2] * t12;
  t789 = t16 * t604 * t788;
  t793 = 0.216e3 * t781 * t224 * t372 + 0.12e2 * t785 * t789 + 0.3584e4 / 0.3e1 * t703;
  t794 = t780 * t793;
  t795 = t778 * t794;
  tvrho1 = my_piecewise3(t217, 0, -0.224e3 * t324 * t711 - 0.168e3 * t324 * t774 - 0.168e3 * t707 * t379 + 0.168e3 * t777 * t795);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t799 = t3 * params->b_PBE;
  t800 = t23 * t12;
  t802 = t799 * t800 * t28;
  t803 = t146 * t158;
  t804 = t581 * t211;
  t808 = t28 * t158;
  t809 = t808 * t43;
  t810 = t154 * t809;
  t811 = t202 * t583;
  t812 = t811 * params->b_PBE;
  t814 = t145 * t23 * t12;
  t815 = t812 * t814;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t802 * t803 * t804 + 0.36288e5 * t810 * t815);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t819 = t224 * t12;
  t821 = t799 * t819 * t28;
  t822 = t315 * t158;
  t823 = t778 * t377;
  t827 = t808 * t233;
  t828 = t323 * t827;
  t829 = t368 * t780;
  t830 = t829 * params->b_PBE;
  t832 = t314 * t224 * t12;
  t833 = t830 * t832;
  tvsigma2 = my_piecewise3(t217, 0, -0.81e2 * t821 * t822 * t823 + 0.36288e5 * t828 * t833);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t18, t19, t23, t25, t26, t27, t28;
  double t29, t31, t32, t34, t37, t38, t39, t40;
  double t41, t42, t43, t44, t46, t49, t51, t52;
  double t53, t54, t55, t58, t59, t60, t61, t69;
  double t71, t72, t73, t75, t76, t77, t79, t82;
  double t87, t93, t94, t98, t99, t101, t102, t103;
  double t104, t106, t110, t114, t116, t117, t118, t123;
  double t124, t129, t138, t139, t142, t145, t146, t150;
  double t152, t153, t154, t155, t158, t159, t160, t161;
  double t162, t163, t164, t165, t166, t169, t171, t177;
  double t178, t179, t182, t183, t184, t187, t190, t194;
  double t196, t197, t202, t203, t206, t210, t211, t212;
  double t213, t216, t217, t218, t219, t220, t224, t226;
  double t227, t231, t232, t233, t234, t238, t240, t243;
  double t244, t252, t253, t255, t256, t273, t274, t275;
  double t277, t281, t285, t287, t292, t297, t305, t308;
  double t311, t314, t315, t319, t321, t322, t323, t324;
  double t325, t326, t327, t328, t329, t330, t331, t332;
  double t335, t337, t343, t344, t345, t348, t349, t350;
  double t353, t356, t360, t362, t368, t369, t372, t376;
  double t377, t378, t379, t382, tzk0;

  double t390, t391, t392, t394, t395, t396, t400, t402;
  double t404, t406, t408, t409, t410, t411, t416, t421;
  double t424, t443, t448, t455, t456, t457, t458, t459;
  double t460, t461, t470, t471, t472, t473, t474, t476;
  double t481, t482, t486, t494, t496, t500, t501, t506;
  double t508, t509, t510, t513, t514, t517, t518, t519;
  double t523, t524, t527, t528, t531, t534, t543, t547;
  double t548, t552, t553, t554, t556, t558, t561, t562;
  double t563, t567, t574, t575, t576, t579, t580, t581;
  double t582, t583, t584, t588, t589, t592, t593, t597;
  double t598, t599, tvrho0, t603, t604, t606, t607, t611;
  double t613, t615, t617, t619, t620, t621, t622, t630;
  double t633, t651, t652, t657, t664, t665, t666, t667;
  double t677, t678, t691, t693, t697, t698, t703, t705;
  double t706, t707, t710, t711, t714, t715, t716, t720;
  double t721, t724, t725, t728, t731, t740, t744, t745;
  double t749, t750, t751, t753, t755, t758, t759, t760;
  double t764, t772, t773, t774, t777, t778, t779, t780;
  double t781, t785, t788, t789, t793, t794, t795, tvrho1;
  double t799, t800, t802, t803, t804, t808, t809, t810;
  double t811, t812, t814, t815, tvsigma0, tvsigma1, t819, t821;
  double t822, t823, t827, t828, t829, t830, t832, t833;
  double tvsigma2;

  double t837, t839, t843, t845, t847, t849, t850, t852;
  double t854, t858, t862, t864, t866, t868, t870, t874;
  double t875, t876, t879, t883, t888, t891, t907, t911;
  double t916, t923, t929, t930, t934, t935, t937, t940;
  double t944, t945, t946, t947, t948, t956, t957, t961;
  double t965, t966, t967, t971, t984, t986, t990, t991;
  double t996, t998, t999, t1000, t1007, t1010, t1011, t1014;
  double t1017, t1018, t1021, t1025, t1029, t1030, t1056, t1059;
  double t1063, t1064, t1070, t1071, t1073, t1074, t1077, t1079;
  double t1082, t1085, t1086, t1087, t1090, t1094, t1095, t1109;
  double t1110, t1111, t1112, t1115, t1116, t1120, t1121, t1122;
  double t1123, t1126, t1130, t1134, t1137, t1138, t1139, t1141;
  double t1145, t1146, t1147, t1150, tv2rho20, tv2rho21, t1151, t1153;
  double t1157, t1159, t1161, t1165, t1169, t1171, t1173, t1175;
  double t1177, t1181, t1182, t1183, t1189, t1194, t1212, t1215;
  double t1221, t1228, t1234, t1235, t1239, t1240, t1242, t1255;
  double t1258, t1259, t1277, t1279, t1283, t1284, t1289, t1291;
  double t1292, t1293, t1300, t1303, t1304, t1307, t1310, t1311;
  double t1314, t1318, t1322, t1323, t1349, t1352, t1356, t1357;
  double t1363, t1364, t1366, t1367, t1370, t1372, t1375, t1378;
  double t1379, t1380, t1383, t1387, t1388, t1403, t1404, t1405;
  double t1406, t1409, t1410, t1414, t1415, t1416, t1417, t1420;
  double t1424, t1428, t1431, t1433, t1437, t1438, t1439, t1442;
  double tv2rho22, t1444, t1446, t1447, t1449, t1450, t1451, t1453;
  double t1456, t1460, t1464, t1470, t1471, t1472, t1473, t1477;
  double t1480, t1481, t1484, t1485, t1486, t1489, t1490, t1491;
  double t1492, t1493, t1494, t1495, t1499, t1500, t1504, t1505;
  double t1506, t1507, t1509, t1510, t1513, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2;
  double tv2rhosigma3, tv2rhosigma4, t1515, t1516, t1517, t1519, t1522, t1526;
  double t1530, t1535, t1536, t1537, t1541, t1544, t1545, t1548;
  double t1549, t1550, t1553, t1554, t1555, t1556, t1557, t1558;
  double t1559, t1563, t1564, t1568, t1569, t1570, t1571, t1573;
  double t1574, t1577, tv2rhosigma5, t1578, t1579, t1580, t1581, t1582;
  double t1584, t1585, t1586, t1587, t1591, t1592, t1593, t1594;
  double t1595, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1599, t1600;
  double t1602, t1603, t1604, t1605, t1609, t1610, t1611, t1612;
  double t1613, tv2sigma25;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRTPI;
  t3 = 0.1e1 / t2;
  t4 = p->hyb_omega[0] * p->hyb_omega[0];
  t5 = params->ax * t4;
  t6 = M_CBRT3;
  t7 = t5 * t6;
  t8 = t2 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = POW_1_3(rho[0]);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t23 = exp(-t7 * t16 * t19 / 0.12e2);
  t25 = params->b_PBE * t23 * sigma[0];
  t26 = t6 * t12;
  t27 = params->kappa + 0.1e1;
  t28 = t6 * t6;
  t29 = t2 * t2;
  t31 = t28 / t29;
  t32 = 0.1e1 / t17;
  t34 = 0.1e1 / t13;
  t37 = t31 * p->hyb_omega[0] * t32 * t34 / 0.6e1;
  t38 = t37 < 0.5e-1;
  t39 = t14 * t14;
  t40 = M_PI * M_PI;
  t41 = t29 * t40;
  t42 = t39 * t41;
  t43 = t17 * rho[0];
  t44 = t42 * t43;
  t46 = t14 * t8;
  t49 = t46 * t6 * t18 * t4;
  t51 = 0.7e1 * t44 - 0.6e1 * t49;
  t52 = t14 * t13;
  t53 = 0.1e1 / p->hyb_omega[0];
  t54 = t53 * t6;
  t55 = t29 * t13;
  t58 = erf(t54 * t55 * t17);
  t59 = t52 * t58;
  t60 = sqrt(M_PI);
  t61 = t60 * t40;
  t69 = t4 * t4;
  t71 = 0.6e1 * t28 * t69;
  t72 = -0.36e2 * t59 * t61 * t28 * rho[0] * p->hyb_omega[0] + 0.81e2 * t44 + 0.54e2 * t49 - t71;
  t73 = 0.1e1 / t72;
  t75 = 0.1e11 < t37;
  t76 = t40 * t40;
  t77 = rho[0] * rho[0];
  t79 = t39 * t14;
  t82 = t8 * t28;
  t87 = t41 * t6;
  t93 = t69 * t4;
  t94 = 0.1e1 / t93;
  t98 = 0.1e1 / t4;
  t99 = t98 * t28;
  t101 = t99 * t46 * t18;
  t102 = exp(t101);
  t103 = t102 * t6;
  t104 = t103 * t14;
  t106 = t8 * t18 * t4;
  t110 = t102 * t28;
  t114 = (0.7e1 * t104 * t106 - 0.6e1 * t110 * t69 + 0.6e1 * t44 + 0.11e2 * t49 + t71) * t8;
  t116 = t14 * t6;
  t117 = t39 * t102;
  t118 = t41 * t28;
  t123 = t52 * t102 * t58;
  t124 = t61 * t6;
  t129 = t14 * t102;
  t138 = 0.2e1 * t69 * t6;
  t139 = 0.12e2 * t123 * t124 * rho[0] * p->hyb_omega[0] - 0.9e1 * t117 * t118 * t43 + 0.12e2 * t46 * t18 * t4 + 0.2e1 * t103 * t69 - 0.18e2 * t129 * t106 - t138;
  t142 = t116 * t98 / t139;
  t145 = my_piecewise5(t38, t51 * t73, t75, (0.28e4 * t82 * t18 * t69 * t14 - 0.14e3 * t87 * t43 * t4 * t39 - 0.1863e4 * t76 * t77 * t79) * t94 / 0.504e5, -t114 * t18 * t142 / 0.9e1);
  t146 = t27 * t145;
  t150 = t18 * t77;
  t152 = params->kappa * t150 * t8;
  t153 = 0.27e2 / 0.56e2 * t25 * t26 * t146 + t152;
  t154 = t3 * t153;
  t155 = t154 * t6;
  t158 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t159 = t158 * t43;
  t160 = 0.135e1 <= t37;
  t161 = 0.135e1 < t37;
  t162 = my_piecewise3(t161, t37, 0.135e1);
  t163 = t162 * t162;
  t164 = t163 * t163;
  t165 = t164 * t163;
  t166 = t164 * t164;
  t169 = t166 * t164;
  t171 = t166 * t163;
  t177 = 0.240888840192e14 * t166 * t165 + 0.19448e5 * t163 - 0.80784e6 * t164 + 0.3055104e8 * t165 - 0.104552448e10 * t166 - 0.90333315072e12 * t169 + 0.3226189824e11 * t171 - 0.429e3;
  t178 = t166 * t166;
  t179 = 0.1e1 / t178;
  t182 = my_piecewise3(t161, 0.135e1, t37);
  t183 = t182 * t182;
  t184 = t183 * t183;
  t187 = 0.32e2 * t184 - 0.16e2 * t183;
  t190 = exp(-0.1e1 / t183 / 0.4e1);
  t194 = 0.1e1 / t182;
  t196 = erf(t194 / 0.2e1);
  t197 = t60 * t196;
  t202 = my_piecewise3(t160, t177 * t179 / 0.8671998246912e15, t187 * t190 / 0.3e1 - 0.32e2 / 0.3e1 * t184 - 0.8e1 / 0.3e1 * t197 * t182 + 0.8e1 * t183 + 0.1e1);
  t203 = params->b_PBE * t145;
  t206 = sigma[0] * t12 * t6;
  t210 = 0.216e3 * t203 * t23 * t206 + 0.448e3 * t152;
  t211 = 0.1e1 / t210;
  t212 = t202 * t211;
  t213 = t159 * t212;
  t216 = my_piecewise3(t1, 0, -0.168e3 * t155 * t213);
  t217 = rho[1] <= p->dens_threshold;
  t218 = POW_1_3(rho[1]);
  t219 = t218 * t218;
  t220 = 0.1e1 / t219;
  t224 = exp(-t7 * t16 * t220 / 0.12e2);
  t226 = params->b_PBE * t224 * sigma[2];
  t227 = 0.1e1 / t218;
  t231 = t31 * p->hyb_omega[0] * t227 * t34 / 0.6e1;
  t232 = t231 < 0.5e-1;
  t233 = t218 * rho[1];
  t234 = t42 * t233;
  t238 = t46 * t6 * t219 * t4;
  t240 = 0.7e1 * t234 - 0.6e1 * t238;
  t243 = erf(t54 * t55 * t218);
  t244 = t52 * t243;
  t252 = -0.36e2 * t244 * t61 * t28 * rho[1] * p->hyb_omega[0] + 0.81e2 * t234 + 0.54e2 * t238 - t71;
  t253 = 0.1e1 / t252;
  t255 = 0.1e11 < t231;
  t256 = rho[1] * rho[1];
  t273 = t99 * t46 * t219;
  t274 = exp(t273);
  t275 = t274 * t219;
  t277 = t46 * t4;
  t281 = t274 * t28;
  t285 = (0.7e1 * t275 * t6 * t277 - 0.6e1 * t281 * t69 + 0.6e1 * t234 + 0.11e2 * t238 + t71) * t8;
  t287 = t39 * t274;
  t292 = t52 * t274 * t243;
  t297 = t14 * t274;
  t305 = t274 * t6;
  t308 = 0.12e2 * t292 * t124 * rho[1] * p->hyb_omega[0] - 0.18e2 * t297 * t8 * t219 * t4 - 0.9e1 * t287 * t118 * t233 + 0.12e2 * t46 * t219 * t4 + 0.2e1 * t305 * t69 - t138;
  t311 = t116 * t98 / t308;
  t314 = my_piecewise5(t232, t240 * t253, t255, (0.28e4 * t82 * t219 * t69 * t14 - 0.14e3 * t87 * t233 * t4 * t39 - 0.1863e4 * t76 * t256 * t79) * t94 / 0.504e5, -t285 * t219 * t311 / 0.9e1);
  t315 = t27 * t314;
  t319 = t219 * t256;
  t321 = params->kappa * t319 * t8;
  t322 = 0.27e2 / 0.56e2 * t226 * t26 * t315 + t321;
  t323 = t3 * t322;
  t324 = t323 * t6;
  t325 = t158 * t233;
  t326 = 0.135e1 <= t231;
  t327 = 0.135e1 < t231;
  t328 = my_piecewise3(t327, t231, 0.135e1);
  t329 = t328 * t328;
  t330 = t329 * t329;
  t331 = t330 * t329;
  t332 = t330 * t330;
  t335 = t332 * t330;
  t337 = t332 * t329;
  t343 = 0.240888840192e14 * t332 * t331 + 0.19448e5 * t329 - 0.80784e6 * t330 + 0.3055104e8 * t331 - 0.104552448e10 * t332 - 0.90333315072e12 * t335 + 0.3226189824e11 * t337 - 0.429e3;
  t344 = t332 * t332;
  t345 = 0.1e1 / t344;
  t348 = my_piecewise3(t327, 0.135e1, t231);
  t349 = t348 * t348;
  t350 = t349 * t349;
  t353 = 0.32e2 * t350 - 0.16e2 * t349;
  t356 = exp(-0.1e1 / t349 / 0.4e1);
  t360 = 0.1e1 / t348;
  t362 = erf(t360 / 0.2e1);
  t368 = my_piecewise3(t326, t343 * t345 / 0.8671998246912e15, t353 * t356 / 0.3e1 - 0.32e2 / 0.3e1 * t350 - 0.8e1 / 0.3e1 * t362 * t348 * t60 + 0.8e1 * t349 + 0.1e1);
  t369 = params->b_PBE * t314;
  t372 = sigma[2] * t12 * t6;
  t376 = 0.216e3 * t369 * t224 * t372 + 0.448e3 * t321;
  t377 = 0.1e1 / t376;
  t378 = t368 * t377;
  t379 = t325 * t378;
  t382 = my_piecewise3(t217, 0, -0.168e3 * t324 * t379);
  tzk0 = (t216 + t382) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t390 = params->b_PBE * params->ax * t4 * t28 * t9 * t15;
  t391 = t18 * rho[0];
  t392 = 0.1e1 / t391;
  t394 = t392 * t23 * sigma[0];
  t395 = t12 * t27;
  t396 = t395 * t145;
  t400 = t42 * t17;
  t402 = t6 * t32;
  t404 = t46 * t402 * t4;
  t406 = 0.28e2 / 0.3e1 * t400 - 0.4e1 * t404;
  t408 = t72 * t72;
  t409 = 0.1e1 / t408;
  t410 = t51 * t409;
  t411 = exp(-t101);
  t416 = t61 * t28 * p->hyb_omega[0];
  t421 = -0.72e2 * t42 * t411 * t17 - 0.36e2 * t59 * t416 + 0.108e3 * t400 + 0.36e2 * t404;
  t424 = t76 * rho[0];
  t443 = t8 * t32 * t4;
  t448 = (0.8e1 * t400 + 0.14e2 * t42 * t17 * t102 - 0.22e2 / 0.3e1 * t104 * t443 + 0.22e2 / 0.3e1 * t404) * t8;
  t455 = t18 * t14;
  t456 = t114 * t455;
  t457 = t6 * t98;
  t458 = t139 * t139;
  t459 = 0.1e1 / t458;
  t460 = t79 * t98;
  t461 = t460 * t6;
  t470 = t40 * M_PI;
  t471 = pow(M_PI, 0.1e1 / 0.6e1);
  t472 = t471 * t471;
  t473 = t472 * t472;
  t474 = t473 * t471;
  t476 = t39 * t13 * t53 * t474 * t470;
  t481 = t117 * t41;
  t482 = t411 * t28;
  t486 = t124 * p->hyb_omega[0];
  t494 = 0.24e2 * t476 * t18 * t102 * t58 - 0.18e2 * t461 * t424 * t102 - 0.24e2 * t117 * t118 * t17 + 0.8e1 * t481 * t482 * t17 + 0.8e1 * t46 * t32 * t4 + 0.12e2 * t123 * t486 - 0.8e1 * t129 * t443;
  t496 = t457 * t459 * t494;
  t500 = my_piecewise5(t38, t406 * t73 - t410 * t421, t75, (-0.3726e4 * t424 * t79 + 0.56e4 / 0.3e1 * t82 * t32 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t17 * t4 * t39) * t94 / 0.504e5, -t448 * t18 * t142 / 0.9e1 - 0.2e1 / 0.27e2 * t114 * t32 * t142 + t456 * t496 / 0.9e1);
  t501 = t27 * t500;
  t506 = params->kappa * t391 * t8;
  t508 = 0.3e1 / 0.112e3 * t390 * t394 * t396 + 0.27e2 / 0.56e2 * t25 * t26 * t501 + 0.8e1 / 0.3e1 * t506;
  t509 = t3 * t508;
  t510 = t509 * t6;
  t513 = t158 * t17;
  t514 = t513 * t212;
  t517 = t164 * t162;
  t518 = t166 * t517;
  t519 = 0.1e1 / t43;
  t523 = t31 * p->hyb_omega[0] * t519 * t34 / 0.18e2;
  t524 = my_piecewise3(t161, -t523, 0);
  t527 = t163 * t162;
  t528 = t166 * t527;
  t531 = t166 * t162;
  t534 = t164 * t527;
  t543 = 0.38896e5 * t162 * t524 + 0.18330624e9 * t517 * t524 + 0.3372443762688e15 * t518 * t524 - 0.323136e7 * t527 * t524 - 0.1083999780864e14 * t528 * t524 + 0.3226189824e12 * t531 * t524 - 0.836419584e10 * t534 * t524;
  t547 = 0.1e1 / t178 / t162;
  t548 = t177 * t547;
  t552 = t183 * t182;
  t553 = my_piecewise3(t161, 0, -t523);
  t554 = t552 * t553;
  t556 = t182 * t553;
  t558 = 0.128e3 * t554 - 0.32e2 * t556;
  t561 = 0.1e1 / t552;
  t562 = t187 * t561;
  t563 = t553 * t190;
  t567 = t190 * t194;
  t574 = my_piecewise3(t160, t543 * t179 / 0.8671998246912e15 - t548 * t524 / 0.541999890432e14, t558 * t190 / 0.3e1 + t562 * t563 / 0.6e1 - 0.128e3 / 0.3e1 * t554 + 0.8e1 / 0.3e1 * t567 * t553 - 0.8e1 / 0.3e1 * t197 * t553 + 0.16e2 * t556);
  t575 = t574 * t211;
  t576 = t159 * t575;
  t579 = t6 * t158;
  t580 = t154 * t579;
  t581 = t43 * t202;
  t582 = t210 * t210;
  t583 = 0.1e1 / t582;
  t584 = params->b_PBE * t500;
  t588 = t5 * t28;
  t589 = t203 * t588;
  t592 = t23 * sigma[0] * t12;
  t593 = t16 * t392 * t592;
  t597 = 0.216e3 * t584 * t23 * t206 + 0.12e2 * t589 * t593 + 0.3584e4 / 0.3e1 * t506;
  t598 = t583 * t597;
  t599 = t581 * t598;
  tvrho0 = my_piecewise3(t1, 0, -0.224e3 * t155 * t514 - 0.168e3 * t155 * t576 - 0.168e3 * t510 * t213 + 0.168e3 * t580 * t599);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t603 = t219 * rho[1];
  t604 = 0.1e1 / t603;
  t606 = t604 * t224 * sigma[2];
  t607 = t395 * t314;
  t611 = t42 * t218;
  t613 = t6 * t227;
  t615 = t46 * t613 * t4;
  t617 = 0.28e2 / 0.3e1 * t611 - 0.4e1 * t615;
  t619 = t252 * t252;
  t620 = 0.1e1 / t619;
  t621 = t240 * t620;
  t622 = exp(-t273);
  t630 = -0.72e2 * t42 * t622 * t218 - 0.36e2 * t244 * t416 + 0.108e3 * t611 + 0.36e2 * t615;
  t633 = t76 * rho[1];
  t651 = t274 * t227;
  t652 = t651 * t6;
  t657 = (0.8e1 * t611 + 0.14e2 * t42 * t218 * t274 - 0.22e2 / 0.3e1 * t652 * t277 + 0.22e2 / 0.3e1 * t615) * t8;
  t664 = t219 * t14;
  t665 = t285 * t664;
  t666 = t308 * t308;
  t667 = 0.1e1 / t666;
  t677 = t287 * t41;
  t678 = t622 * t28;
  t691 = -0.8e1 * t297 * t8 * t227 * t4 - 0.24e2 * t287 * t118 * t218 + 0.8e1 * t677 * t678 * t218 + 0.8e1 * t46 * t227 * t4 + 0.24e2 * t476 * t275 * t243 - 0.18e2 * t461 * t633 * t274 + 0.12e2 * t292 * t486;
  t693 = t457 * t667 * t691;
  t697 = my_piecewise5(t232, t617 * t253 - t621 * t630, t255, (-0.3726e4 * t633 * t79 + 0.56e4 / 0.3e1 * t82 * t227 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t218 * t4 * t39) * t94 / 0.504e5, -t657 * t219 * t311 / 0.9e1 - 0.2e1 / 0.27e2 * t285 * t227 * t311 + t665 * t693 / 0.9e1);
  t698 = t27 * t697;
  t703 = params->kappa * t603 * t8;
  t705 = 0.3e1 / 0.112e3 * t390 * t606 * t607 + 0.27e2 / 0.56e2 * t226 * t26 * t698 + 0.8e1 / 0.3e1 * t703;
  t706 = t3 * t705;
  t707 = t706 * t6;
  t710 = t158 * t218;
  t711 = t710 * t378;
  t714 = t330 * t328;
  t715 = t332 * t714;
  t716 = 0.1e1 / t233;
  t720 = t31 * p->hyb_omega[0] * t716 * t34 / 0.18e2;
  t721 = my_piecewise3(t327, -t720, 0);
  t724 = t329 * t328;
  t725 = t332 * t724;
  t728 = t332 * t328;
  t731 = t330 * t724;
  t740 = 0.38896e5 * t328 * t721 + 0.18330624e9 * t714 * t721 + 0.3372443762688e15 * t715 * t721 - 0.323136e7 * t724 * t721 - 0.1083999780864e14 * t725 * t721 + 0.3226189824e12 * t728 * t721 - 0.836419584e10 * t731 * t721;
  t744 = 0.1e1 / t344 / t328;
  t745 = t343 * t744;
  t749 = t349 * t348;
  t750 = my_piecewise3(t327, 0, -t720);
  t751 = t749 * t750;
  t753 = t348 * t750;
  t755 = 0.128e3 * t751 - 0.32e2 * t753;
  t758 = 0.1e1 / t749;
  t759 = t353 * t758;
  t760 = t750 * t356;
  t764 = t356 * t360;
  t772 = my_piecewise3(t326, t740 * t345 / 0.8671998246912e15 - t745 * t721 / 0.541999890432e14, t755 * t356 / 0.3e1 + t759 * t760 / 0.6e1 - 0.128e3 / 0.3e1 * t751 + 0.8e1 / 0.3e1 * t764 * t750 - 0.8e1 / 0.3e1 * t362 * t750 * t60 + 0.16e2 * t753);
  t773 = t772 * t377;
  t774 = t325 * t773;
  t777 = t323 * t579;
  t778 = t233 * t368;
  t779 = t376 * t376;
  t780 = 0.1e1 / t779;
  t781 = params->b_PBE * t697;
  t785 = t369 * t588;
  t788 = t224 * sigma[2] * t12;
  t789 = t16 * t604 * t788;
  t793 = 0.216e3 * t781 * t224 * t372 + 0.12e2 * t785 * t789 + 0.3584e4 / 0.3e1 * t703;
  t794 = t780 * t793;
  t795 = t778 * t794;
  tvrho1 = my_piecewise3(t217, 0, -0.224e3 * t324 * t711 - 0.168e3 * t324 * t774 - 0.168e3 * t707 * t379 + 0.168e3 * t777 * t795);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t799 = t3 * params->b_PBE;
  t800 = t23 * t12;
  t802 = t799 * t800 * t28;
  t803 = t146 * t158;
  t804 = t581 * t211;
  t808 = t28 * t158;
  t809 = t808 * t43;
  t810 = t154 * t809;
  t811 = t202 * t583;
  t812 = t811 * params->b_PBE;
  t814 = t145 * t23 * t12;
  t815 = t812 * t814;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t802 * t803 * t804 + 0.36288e5 * t810 * t815);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t819 = t224 * t12;
  t821 = t799 * t819 * t28;
  t822 = t315 * t158;
  t823 = t778 * t377;
  t827 = t808 * t233;
  t828 = t323 * t827;
  t829 = t368 * t780;
  t830 = t829 * params->b_PBE;
  t832 = t314 * t224 * t12;
  t833 = t830 * t832;
  tvsigma2 = my_piecewise3(t217, 0, -0.81e2 * t821 * t822 * t823 + 0.36288e5 * t828 * t833);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t837 = 0.1e1 / t150;
  t839 = t837 * t23 * sigma[0];
  t843 = params->ax * params->ax;
  t845 = 0.1e1 / t41;
  t847 = 0.1e1 / t39;
  t849 = params->b_PBE * t843 * t69 * t845 * t847;
  t850 = t77 * rho[0];
  t852 = 0.1e1 / t17 / t850;
  t854 = t852 * t23 * sigma[0];
  t858 = t395 * t500;
  t862 = t42 * t19;
  t864 = t6 * t519;
  t866 = t46 * t864 * t4;
  t868 = 0.28e2 / 0.9e1 * t862 + 0.4e1 / 0.3e1 * t866;
  t870 = t406 * t409;
  t874 = 0.1e1 / t408 / t72;
  t875 = t51 * t874;
  t876 = t421 * t421;
  t879 = t76 * t79;
  t883 = t411 * t19;
  t888 = 0.48e2 * t879 * t99 * t411 - 0.96e2 * t42 * t883 + 0.36e2 * t862 - 0.12e2 * t866;
  t891 = 0.3726e4 * t879;
  t907 = t99 * t102;
  t911 = t8 * t519 * t4;
  t916 = (0.8e1 / 0.3e1 * t862 - 0.1e2 * t42 * t19 * t102 + 0.28e2 / 0.3e1 * t879 * t907 + 0.22e2 / 0.9e1 * t104 * t911 - 0.22e2 / 0.9e1 * t866) * t8;
  t923 = t448 * t455;
  t929 = t32 * t14;
  t930 = t114 * t929;
  t934 = 0.1e1 / t458 / t139;
  t935 = t494 * t494;
  t937 = t457 * t934 * t935;
  t940 = t6 * t76;
  t944 = t39 * t39;
  t945 = 0.1e1 / t69;
  t946 = t944 * t945;
  t947 = t76 * M_PI;
  t948 = t2 * t947;
  t956 = t32 * t102;
  t957 = t956 * t58;
  t961 = t4 * p->hyb_omega[0];
  t965 = t39 * t52 / t961 * t471 * t947;
  t966 = t17 * t28;
  t967 = t102 * t58;
  t971 = t460 * t76;
  t984 = -0.66e2 * t460 * t940 * t102 - 0.36e2 * t946 * t948 * t18 * t102 - 0.4e2 / 0.3e1 * t117 * t118 * t19 + 0.4e2 * t476 * t957 + 0.16e2 * t965 * t966 * t967 + 0.16e2 * t971 * t102 * t411 * t6 + 0.32e2 / 0.3e1 * t481 * t482 * t19 + 0.8e1 / 0.3e1 * t129 * t911 - 0.8e1 / 0.3e1 * t46 * t519 * t4;
  t986 = t457 * t459 * t984;
  t990 = my_piecewise5(t38, -t410 * t888 - 0.2e1 * t870 * t421 + t868 * t73 + 0.2e1 * t875 * t876, t75, (-t891 - 0.56e4 / 0.9e1 * t82 * t519 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t19 * t4 * t39) * t94 / 0.504e5, -t916 * t18 * t142 / 0.9e1 - 0.4e1 / 0.27e2 * t448 * t32 * t142 + 0.2e1 / 0.9e1 * t923 * t496 + 0.2e1 / 0.81e2 * t114 * t519 * t142 + 0.4e1 / 0.27e2 * t930 * t496 - 0.2e1 / 0.9e1 * t456 * t937 + t456 * t986 / 0.9e1);
  t991 = t27 * t990;
  t996 = params->kappa * t18 * t8;
  t998 = -0.5e1 / 0.112e3 * t390 * t839 * t396 + t849 * t854 * t396 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t394 * t858 + 0.27e2 / 0.56e2 * t25 * t26 * t991 + 0.4e2 / 0.9e1 * t996;
  t999 = t3 * t998;
  t1000 = t999 * t6;
  t1007 = t509 * t579;
  t1010 = t158 * t19;
  t1011 = t1010 * t212;
  t1014 = t513 * t575;
  t1017 = t17 * t202;
  t1018 = t1017 * t598;
  t1021 = t524 * t524;
  t1025 = 0.1e1 / t17 / t77;
  t1029 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1025 * t34;
  t1030 = my_piecewise3(t161, t1029, 0);
  t1056 = -0.969408e7 * t163 * t1021 + 0.9165312e9 * t164 * t1021 - 0.5854937088e11 * t165 * t1021 + 0.29035708416e13 * t166 * t1021 + 0.43841768914944e16 * t169 * t1021 - 0.11923997589504e15 * t171 * t1021 + 0.38896e5 * t162 * t1030 + 0.18330624e9 * t517 * t1030 + 0.3372443762688e15 * t518 * t1030 - 0.323136e7 * t527 * t1030 - 0.1083999780864e14 * t528 * t1030 + 0.3226189824e12 * t531 * t1030 - 0.836419584e10 * t534 * t1030 + 0.38896e5 * t1021;
  t1059 = t543 * t547;
  t1063 = 0.1e1 / t178 / t163;
  t1064 = t177 * t1063;
  t1070 = t553 * t553;
  t1071 = t183 * t1070;
  t1073 = my_piecewise3(t161, 0, t1029);
  t1074 = t552 * t1073;
  t1077 = t182 * t1073;
  t1079 = 0.384e3 * t1071 + 0.128e3 * t1074 - 0.32e2 * t1070 - 0.32e2 * t1077;
  t1082 = t558 * t561;
  t1085 = 0.1e1 / t184;
  t1086 = t187 * t1085;
  t1087 = t1070 * t190;
  t1090 = t1073 * t190;
  t1094 = 0.1e1 / t184 / t183;
  t1095 = t187 * t1094;
  t1109 = t1079 * t190 / 0.3e1 + t1082 * t563 / 0.3e1 - t1086 * t1087 / 0.2e1 + t562 * t1090 / 0.6e1 + t1095 * t1087 / 0.12e2 - 0.128e3 * t1071 - 0.128e3 / 0.3e1 * t1074 + 0.4e1 / 0.3e1 * t1085 * t1070 * t190 + 0.8e1 / 0.3e1 * t567 * t1073 - 0.8e1 / 0.3e1 * t197 * t1073 + 0.16e2 * t1070 + 0.16e2 * t1077;
  t1110 = my_piecewise3(t160, t1056 * t179 / 0.8671998246912e15 - t1059 * t524 / 0.270999945216e14 + t1064 * t1021 / 0.31882346496e13 - t548 * t1030 / 0.541999890432e14, t1109);
  t1111 = t1110 * t211;
  t1112 = t159 * t1111;
  t1115 = t43 * t574;
  t1116 = t1115 * t598;
  t1120 = 0.1e1 / t582 / t210;
  t1121 = t597 * t597;
  t1122 = t1120 * t1121;
  t1123 = t581 * t1122;
  t1126 = params->b_PBE * t990;
  t1130 = t584 * t588;
  t1134 = t16 * t837 * t592;
  t1137 = t843 * t69;
  t1138 = t1137 * t845;
  t1139 = t203 * t1138;
  t1141 = t847 * t852 * t592;
  t1145 = 0.216e3 * t1126 * t23 * t206 + 0.24e2 * t1130 * t593 - 0.2e2 * t589 * t1134 + 0.2e1 * t1139 * t1141 + 0.1792e5 / 0.9e1 * t996;
  t1146 = t583 * t1145;
  t1147 = t581 * t1146;
  t1150 = -0.168e3 * t1000 * t213 - 0.448e3 * t510 * t514 - 0.336e3 * t510 * t576 + 0.336e3 * t1007 * t599 - 0.224e3 / 0.3e1 * t155 * t1011 - 0.448e3 * t155 * t1014 + 0.448e3 * t580 * t1018 - 0.168e3 * t155 * t1112 + 0.336e3 * t580 * t1116 - 0.336e3 * t580 * t1123 + 0.168e3 * t580 * t1147;
  tv2rho20 = my_piecewise3(t1, 0, t1150);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t1151 = 0.1e1 / t319;
  t1153 = t1151 * t224 * sigma[2];
  t1157 = t256 * rho[1];
  t1159 = 0.1e1 / t218 / t1157;
  t1161 = t1159 * t224 * sigma[2];
  t1165 = t395 * t697;
  t1169 = t42 * t220;
  t1171 = t6 * t716;
  t1173 = t46 * t1171 * t4;
  t1175 = 0.28e2 / 0.9e1 * t1169 + 0.4e1 / 0.3e1 * t1173;
  t1177 = t617 * t620;
  t1181 = 0.1e1 / t619 / t252;
  t1182 = t240 * t1181;
  t1183 = t630 * t630;
  t1189 = t622 * t220;
  t1194 = 0.48e2 * t879 * t99 * t622 - 0.96e2 * t42 * t1189 + 0.36e2 * t1169 - 0.12e2 * t1173;
  t1212 = t99 * t274;
  t1215 = t274 * t716;
  t1221 = (0.8e1 / 0.3e1 * t1169 - 0.1e2 * t42 * t220 * t274 + 0.28e2 / 0.3e1 * t879 * t1212 + 0.22e2 / 0.9e1 * t1215 * t6 * t277 - 0.22e2 / 0.9e1 * t1173) * t8;
  t1228 = t657 * t664;
  t1234 = t227 * t14;
  t1235 = t285 * t1234;
  t1239 = 0.1e1 / t666 / t308;
  t1240 = t691 * t691;
  t1242 = t457 * t1239 * t1240;
  t1255 = t651 * t243;
  t1258 = t218 * t28;
  t1259 = t274 * t243;
  t1277 = -0.66e2 * t460 * t940 * t274 - 0.36e2 * t946 * t948 * t219 * t274 - 0.4e2 / 0.3e1 * t287 * t118 * t220 + 0.4e2 * t476 * t1255 + 0.16e2 * t965 * t1258 * t1259 + 0.16e2 * t971 * t274 * t622 * t6 + 0.32e2 / 0.3e1 * t677 * t678 * t220 + 0.8e1 / 0.3e1 * t297 * t8 * t716 * t4 - 0.8e1 / 0.3e1 * t46 * t716 * t4;
  t1279 = t457 * t667 * t1277;
  t1283 = my_piecewise5(t232, t1175 * t253 - 0.2e1 * t1177 * t630 + 0.2e1 * t1182 * t1183 - t621 * t1194, t255, (-t891 - 0.56e4 / 0.9e1 * t82 * t716 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t220 * t4 * t39) * t94 / 0.504e5, -t1221 * t219 * t311 / 0.9e1 - 0.4e1 / 0.27e2 * t657 * t227 * t311 + 0.2e1 / 0.9e1 * t1228 * t693 + 0.2e1 / 0.81e2 * t285 * t716 * t311 + 0.4e1 / 0.27e2 * t1235 * t693 - 0.2e1 / 0.9e1 * t665 * t1242 + t665 * t1279 / 0.9e1);
  t1284 = t27 * t1283;
  t1289 = params->kappa * t219 * t8;
  t1291 = -0.5e1 / 0.112e3 * t390 * t1153 * t607 + t849 * t1161 * t607 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t606 * t1165 + 0.27e2 / 0.56e2 * t226 * t26 * t1284 + 0.4e2 / 0.9e1 * t1289;
  t1292 = t3 * t1291;
  t1293 = t1292 * t6;
  t1300 = t706 * t579;
  t1303 = t158 * t220;
  t1304 = t1303 * t378;
  t1307 = t710 * t773;
  t1310 = t218 * t368;
  t1311 = t1310 * t794;
  t1314 = t721 * t721;
  t1318 = 0.1e1 / t218 / t256;
  t1322 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1318 * t34;
  t1323 = my_piecewise3(t327, t1322, 0);
  t1349 = -0.969408e7 * t329 * t1314 + 0.9165312e9 * t330 * t1314 - 0.5854937088e11 * t331 * t1314 + 0.29035708416e13 * t332 * t1314 + 0.43841768914944e16 * t335 * t1314 - 0.11923997589504e15 * t337 * t1314 + 0.38896e5 * t328 * t1323 + 0.18330624e9 * t714 * t1323 + 0.3372443762688e15 * t715 * t1323 - 0.323136e7 * t724 * t1323 - 0.1083999780864e14 * t725 * t1323 + 0.3226189824e12 * t728 * t1323 - 0.836419584e10 * t731 * t1323 + 0.38896e5 * t1314;
  t1352 = t740 * t744;
  t1356 = 0.1e1 / t344 / t329;
  t1357 = t343 * t1356;
  t1363 = t750 * t750;
  t1364 = t349 * t1363;
  t1366 = my_piecewise3(t327, 0, t1322);
  t1367 = t749 * t1366;
  t1370 = t348 * t1366;
  t1372 = 0.384e3 * t1364 + 0.128e3 * t1367 - 0.32e2 * t1363 - 0.32e2 * t1370;
  t1375 = t755 * t758;
  t1378 = 0.1e1 / t350;
  t1379 = t353 * t1378;
  t1380 = t1363 * t356;
  t1383 = t1366 * t356;
  t1387 = 0.1e1 / t350 / t349;
  t1388 = t353 * t1387;
  t1403 = t1372 * t356 / 0.3e1 + t1375 * t760 / 0.3e1 - t1379 * t1380 / 0.2e1 + t759 * t1383 / 0.6e1 + t1388 * t1380 / 0.12e2 - 0.128e3 * t1364 - 0.128e3 / 0.3e1 * t1367 + 0.4e1 / 0.3e1 * t1378 * t1363 * t356 + 0.8e1 / 0.3e1 * t764 * t1366 - 0.8e1 / 0.3e1 * t362 * t1366 * t60 + 0.16e2 * t1363 + 0.16e2 * t1370;
  t1404 = my_piecewise3(t326, t1349 * t345 / 0.8671998246912e15 - t1352 * t721 / 0.270999945216e14 + t1357 * t1314 / 0.31882346496e13 - t745 * t1323 / 0.541999890432e14, t1403);
  t1405 = t1404 * t377;
  t1406 = t325 * t1405;
  t1409 = t233 * t772;
  t1410 = t1409 * t794;
  t1414 = 0.1e1 / t779 / t376;
  t1415 = t793 * t793;
  t1416 = t1414 * t1415;
  t1417 = t778 * t1416;
  t1420 = params->b_PBE * t1283;
  t1424 = t781 * t588;
  t1428 = t16 * t1151 * t788;
  t1431 = t369 * t1138;
  t1433 = t847 * t1159 * t788;
  t1437 = 0.216e3 * t1420 * t224 * t372 + 0.24e2 * t1424 * t789 - 0.2e2 * t785 * t1428 + 0.2e1 * t1431 * t1433 + 0.1792e5 / 0.9e1 * t1289;
  t1438 = t780 * t1437;
  t1439 = t778 * t1438;
  t1442 = -0.168e3 * t1293 * t379 - 0.448e3 * t707 * t711 - 0.336e3 * t707 * t774 + 0.336e3 * t1300 * t795 - 0.224e3 / 0.3e1 * t324 * t1304 - 0.448e3 * t324 * t1307 + 0.448e3 * t777 * t1311 - 0.168e3 * t324 * t1406 + 0.336e3 * t777 * t1410 - 0.336e3 * t777 * t1417 + 0.168e3 * t777 * t1439;
  tv2rho22 = my_piecewise3(t217, 0, t1442);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t1444 = 0.1e1 / t29 / M_PI;
  t1446 = t1444 * params->b_PBE * params->ax;
  t1447 = t4 * t15;
  t1449 = t1446 * t1447 * t32;
  t1450 = t800 * t27;
  t1451 = t145 * t158;
  t1453 = t1450 * t1451 * t212;
  t1456 = t501 * t158;
  t1460 = t1017 * t211;
  t1464 = t1115 * t211;
  t1470 = t12 * t28 * t27;
  t1471 = t799 * t23 * t1470;
  t1472 = t1451 * t43;
  t1473 = t811 * t597;
  t1477 = t509 * t809;
  t1480 = t808 * t17;
  t1481 = t154 * t1480;
  t1484 = t574 * t583;
  t1485 = t1484 * params->b_PBE;
  t1486 = t1485 * t814;
  t1489 = t154 * t28;
  t1490 = t159 * t202;
  t1491 = t1489 * t1490;
  t1492 = t1120 * params->b_PBE;
  t1493 = t1492 * t145;
  t1494 = t800 * t597;
  t1495 = t1493 * t1494;
  t1499 = t500 * t23 * t12;
  t1500 = t812 * t1499;
  t1504 = t1444 * t153 * t158;
  t1505 = t32 * t202;
  t1506 = t1505 * t583;
  t1507 = t1504 * t1506;
  t1509 = t1447 * t800;
  t1510 = t203 * params->ax * t1509;
  t1513 = -0.27e2 / 0.2e1 * t1449 * t1453 - 0.81e2 * t802 * t1456 * t804 - 0.108e3 * t802 * t803 * t1460 - 0.81e2 * t802 * t803 * t1464 + 0.81e2 * t1471 * t1472 * t1473 + 0.36288e5 * t1477 * t815 + 0.48384e5 * t1481 * t815 + 0.36288e5 * t810 * t1486 - 0.72576e5 * t1491 * t1495 + 0.36288e5 * t810 * t1500 + 0.6048e4 * t1507 * t1510;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1513);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t1515 = t1446 * t1447 * t227;
  t1516 = t819 * t27;
  t1517 = t314 * t158;
  t1519 = t1516 * t1517 * t378;
  t1522 = t698 * t158;
  t1526 = t1310 * t377;
  t1530 = t1409 * t377;
  t1535 = t799 * t224 * t1470;
  t1536 = t1517 * t233;
  t1537 = t829 * t793;
  t1541 = t706 * t827;
  t1544 = t808 * t218;
  t1545 = t323 * t1544;
  t1548 = t772 * t780;
  t1549 = t1548 * params->b_PBE;
  t1550 = t1549 * t832;
  t1553 = t323 * t28;
  t1554 = t325 * t368;
  t1555 = t1553 * t1554;
  t1556 = t1414 * params->b_PBE;
  t1557 = t1556 * t314;
  t1558 = t819 * t793;
  t1559 = t1557 * t1558;
  t1563 = t697 * t224 * t12;
  t1564 = t830 * t1563;
  t1568 = t1444 * t322 * t158;
  t1569 = t227 * t368;
  t1570 = t1569 * t780;
  t1571 = t1568 * t1570;
  t1573 = t1447 * t819;
  t1574 = t369 * params->ax * t1573;
  t1577 = -0.27e2 / 0.2e1 * t1515 * t1519 - 0.81e2 * t821 * t1522 * t823 - 0.108e3 * t821 * t822 * t1526 - 0.81e2 * t821 * t822 * t1530 + 0.81e2 * t1535 * t1536 * t1537 + 0.36288e5 * t1541 * t833 + 0.48384e5 * t1545 * t833 + 0.36288e5 * t828 * t1550 - 0.72576e5 * t1555 * t1559 + 0.36288e5 * t828 * t1564 + 0.6048e4 * t1571 * t1574;
  tv2rhosigma5 = my_piecewise3(t217, 0, t1577);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t1578 = params->b_PBE * params->b_PBE;
  t1579 = t3 * t1578;
  t1580 = t23 * t23;
  t1581 = t12 * t12;
  t1582 = t1580 * t1581;
  t1584 = t1579 * t1582 * t27;
  t1585 = t145 * t145;
  t1586 = t1585 * t158;
  t1587 = t581 * t583;
  t1591 = t154 * t1490;
  t1592 = t1120 * t1578;
  t1593 = t1585 * t1580;
  t1594 = t1593 * t1581;
  t1595 = t1592 * t1594;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1584 * t1586 * t1587 - 0.47029248e8 * t1591 * t1595);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t1599 = t224 * t224;
  t1600 = t1599 * t1581;
  t1602 = t1579 * t1600 * t27;
  t1603 = t314 * t314;
  t1604 = t1603 * t158;
  t1605 = t778 * t780;
  t1609 = t323 * t1554;
  t1610 = t1414 * t1578;
  t1611 = t1603 * t1599;
  t1612 = t1611 * t1581;
  t1613 = t1610 * t1612;
  tv2sigma25 = my_piecewise3(t217, 0, 0.104976e6 * t1602 * t1604 * t1605 - 0.47029248e8 * t1609 * t1613);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t18, t19, t23, t25, t26, t27, t28;
  double t29, t31, t32, t34, t37, t38, t39, t40;
  double t41, t42, t43, t44, t46, t49, t51, t52;
  double t53, t54, t55, t58, t59, t60, t61, t69;
  double t71, t72, t73, t75, t76, t77, t79, t82;
  double t87, t93, t94, t98, t99, t101, t102, t103;
  double t104, t106, t110, t114, t116, t117, t118, t123;
  double t124, t129, t138, t139, t142, t145, t146, t150;
  double t152, t153, t154, t155, t158, t159, t160, t161;
  double t162, t163, t164, t165, t166, t169, t171, t177;
  double t178, t179, t182, t183, t184, t187, t190, t194;
  double t196, t197, t202, t203, t206, t210, t211, t212;
  double t213, t216, t217, t218, t219, t220, t224, t226;
  double t227, t231, t232, t233, t234, t238, t240, t243;
  double t244, t252, t253, t255, t256, t273, t274, t275;
  double t277, t281, t285, t287, t292, t297, t305, t308;
  double t311, t314, t315, t319, t321, t322, t323, t324;
  double t325, t326, t327, t328, t329, t330, t331, t332;
  double t335, t337, t343, t344, t345, t348, t349, t350;
  double t353, t356, t360, t362, t368, t369, t372, t376;
  double t377, t378, t379, t382, tzk0;

  double t390, t391, t392, t394, t395, t396, t400, t402;
  double t404, t406, t408, t409, t410, t411, t416, t421;
  double t424, t443, t448, t455, t456, t457, t458, t459;
  double t460, t461, t470, t471, t472, t473, t474, t476;
  double t481, t482, t486, t494, t496, t500, t501, t506;
  double t508, t509, t510, t513, t514, t517, t518, t519;
  double t523, t524, t527, t528, t531, t534, t543, t547;
  double t548, t552, t553, t554, t556, t558, t561, t562;
  double t563, t567, t574, t575, t576, t579, t580, t581;
  double t582, t583, t584, t588, t589, t592, t593, t597;
  double t598, t599, tvrho0, t603, t604, t606, t607, t611;
  double t613, t615, t617, t619, t620, t621, t622, t630;
  double t633, t651, t652, t657, t664, t665, t666, t667;
  double t677, t678, t691, t693, t697, t698, t703, t705;
  double t706, t707, t710, t711, t714, t715, t716, t720;
  double t721, t724, t725, t728, t731, t740, t744, t745;
  double t749, t750, t751, t753, t755, t758, t759, t760;
  double t764, t772, t773, t774, t777, t778, t779, t780;
  double t781, t785, t788, t789, t793, t794, t795, tvrho1;
  double t799, t800, t802, t803, t804, t808, t809, t810;
  double t811, t812, t814, t815, tvsigma0, tvsigma1, t819, t821;
  double t822, t823, t827, t828, t829, t830, t832, t833;
  double tvsigma2;

  double t837, t839, t843, t845, t847, t849, t850, t852;
  double t854, t858, t862, t864, t866, t868, t870, t874;
  double t875, t876, t879, t883, t888, t891, t907, t911;
  double t916, t923, t929, t930, t934, t935, t937, t940;
  double t944, t945, t946, t947, t948, t956, t957, t961;
  double t965, t966, t967, t971, t984, t986, t990, t991;
  double t996, t998, t999, t1000, t1007, t1010, t1011, t1014;
  double t1017, t1018, t1021, t1025, t1029, t1030, t1056, t1059;
  double t1063, t1064, t1070, t1071, t1073, t1074, t1077, t1079;
  double t1082, t1085, t1086, t1087, t1090, t1094, t1095, t1109;
  double t1110, t1111, t1112, t1115, t1116, t1120, t1121, t1122;
  double t1123, t1126, t1130, t1134, t1137, t1138, t1139, t1141;
  double t1145, t1146, t1147, t1150, tv2rho20, tv2rho21, t1151, t1153;
  double t1157, t1159, t1161, t1165, t1169, t1171, t1173, t1175;
  double t1177, t1181, t1182, t1183, t1189, t1194, t1212, t1215;
  double t1221, t1228, t1234, t1235, t1239, t1240, t1242, t1255;
  double t1258, t1259, t1277, t1279, t1283, t1284, t1289, t1291;
  double t1292, t1293, t1300, t1303, t1304, t1307, t1310, t1311;
  double t1314, t1318, t1322, t1323, t1349, t1352, t1356, t1357;
  double t1363, t1364, t1366, t1367, t1370, t1372, t1375, t1378;
  double t1379, t1380, t1383, t1387, t1388, t1403, t1404, t1405;
  double t1406, t1409, t1410, t1414, t1415, t1416, t1417, t1420;
  double t1424, t1428, t1431, t1433, t1437, t1438, t1439, t1442;
  double tv2rho22, t1444, t1446, t1447, t1449, t1450, t1451, t1453;
  double t1456, t1460, t1464, t1470, t1471, t1472, t1473, t1477;
  double t1480, t1481, t1484, t1485, t1486, t1489, t1490, t1491;
  double t1492, t1493, t1494, t1495, t1499, t1500, t1504, t1505;
  double t1506, t1507, t1509, t1510, t1513, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2;
  double tv2rhosigma3, tv2rhosigma4, t1515, t1516, t1517, t1519, t1522, t1526;
  double t1530, t1535, t1536, t1537, t1541, t1544, t1545, t1548;
  double t1549, t1550, t1553, t1554, t1555, t1556, t1557, t1558;
  double t1559, t1563, t1564, t1568, t1569, t1570, t1571, t1573;
  double t1574, t1577, tv2rhosigma5, t1578, t1579, t1580, t1581, t1582;
  double t1584, t1585, t1586, t1587, t1591, t1592, t1593, t1594;
  double t1595, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1599, t1600;
  double t1602, t1603, t1604, t1605, t1609, t1610, t1611, t1612;
  double t1613, tv2sigma25;

  double t1617, t1618, t1619, t1625, t1626, t1639, t1643, t1674;
  double t1677, t1680, t1686, t1687, t1695, t1699, t1700, t1701;
  double t1702, t1705, t1710, t1712, t1713, t1715, t1716, t1718;
  double t1720, t1722, t1732, t1740, t1742, t1743, t1749, t1752;
  double t1757, t1760, t1763, t1766, t1768, t1769, t1770, t1773;
  double t1776, t1785, t1786, t1794, t1796, t1800, t1802, t1804;
  double t1811, t1813, t1814, t1815, t1816, t1817, t1818, t1820;
  double t1821, t1822, t1823, t1829, t1833, t1837, t1839, t1841;
  double t1844, t1849, t1850, t1851, t1852, t1855, t1858, t1859;
  double t1863, t1873, t1887, t1888, t1891, t1894, t1896, t1914;
  double t1919, t1926, t1934, t1935, t1944, t1946, t1947, t1948;
  double t1959, t1963, t1968, t1977, t1992, t1994, t2000, t2003;
  double t2004, t2005, t2010, t2013, t2014, t2017, t2018, t2019;
  double t2020, t2021, t2024, t2027, t2030, t2033, t2037, t2042;
  double t2046, t2050, t2054, t2055, t2058, t2062, t2063, t2064;
  double t2067, t2068, t2071, t2074, t2077, t2078, t2081, t2082;
  double t2089, t2094, tv3rho30, tv3rho31, tv3rho32, t2096, t2097, t2098;
  double t2105, t2108, t2116, t2118, t2122, t2124, t2126, t2133;
  double t2134, t2136, t2137, t2138, t2139, t2145, t2149, t2153;
  double t2155, t2157, t2160, t2165, t2166, t2167, t2168, t2171;
  double t2177, t2187, t2205, t2206, t2209, t2212, t2214, t2220;
  double t2221, t2243, t2248, t2268, t2270, t2276, t2282, t2296;
  double t2302, t2306, t2307, t2308, t2313, t2316, t2317, t2322;
  double t2323, t2329, t2330, t2337, t2347, t2378, t2381, t2384;
  double t2390, t2391, t2399, t2403, t2404, t2405, t2406, t2409;
  double t2414, t2416, t2417, t2419, t2421, t2422, t2424, t2428;
  double t2433, t2448, t2451, t2456, t2459, t2462, t2465, t2467;
  double t2468, t2471, t2473, t2474, t2475, t2478, t2481, t2482;
  double t2483, t2484, t2485, t2486, t2491, t2494, t2498, t2503;
  double t2507, t2511, t2514, t2517, t2521, t2522, t2523, t2526;
  double t2529, t2530, t2533, t2536, t2537, t2540, t2541, t2548;
  double t2553, tv3rho33, t2555, t2556, t2557, t2558, t2561, t2562;
  double t2565, t2566, t2569, t2570, t2573, t2574, t2577, t2580;
  double t2588, t2589, t2598, t2599, t2600, t2603, t2606, t2610;
  double t2615, t2622, t2623, t2628, t2631, t2633, t2637, t2641;
  double t2642, t2646, t2649, t2650, t2651, t2654, t2655, t2656;
  double t2659, t2661, t2662, t2663, t2664, t2665, t2666, t2667;
  double t2669, t2670, t2671, t2674, t2675, t2677, t2678, t2679;
  double t2680, t2681, t2686, t2687, t2688, t2689, t2693, t2694;
  double t2697, t2700, t2701, t2705, t2706, t2709, t2710, t2713;
  double t2717, t2721, t2725, t2729, tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2, tv3rho2sigma3;
  double tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7, t2731, t2734, t2735, t2741;
  double t2746, t2747, t2754, t2755, t2756, t2759, t2762, t2766;
  double t2773, t2780, t2785, t2789, t2793, t2794, t2797, t2798;
  double t2799, t2800, t2803, t2804, t2805, t2808, t2810, t2814;
  double t2818, t2819, t2820, t2821, t2822, t2823, t2824, t2826;
  double t2827, t2830, t2831, t2833, t2834, t2835, t2836, t2837;
  double t2842, t2843, t2844, t2845, t2850, t2853, t2854, t2857;
  double t2861, t2865, t2869, t2873, t2874, t2875, t2876, t2879;
  double t2880, t2884, t2885, t2888, t2889, t2892, t2893, t2896;
  double t2897, t2900, tv3rho2sigma8, t2902, t2903, t2904, t2905, t2906;
  double t2908, t2912, t2924, t2925, t2929, t2932, t2935, t2938;
  double t2939, t2941, t2944, t2946, t2949, t2950, t2951, t2954;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2955, t2956, t2957, t2961, t2973;
  double t2974, t2978, t2981, t2984, t2987, t2988, t2990, t2993;
  double t2995, t2998, t2999, t3000, t3003, tv3rhosigma211, t3004, t3005;
  double t3006, t3007, t3008, t3010, t3011, t3015, t3018, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t3022, t3023, t3024, t3026, t3027, t3031, t3034, tv3sigma39;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRTPI;
  t3 = 0.1e1 / t2;
  t4 = p->hyb_omega[0] * p->hyb_omega[0];
  t5 = params->ax * t4;
  t6 = M_CBRT3;
  t7 = t5 * t6;
  t8 = t2 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = POW_1_3(rho[0]);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t23 = exp(-t7 * t16 * t19 / 0.12e2);
  t25 = params->b_PBE * t23 * sigma[0];
  t26 = t6 * t12;
  t27 = params->kappa + 0.1e1;
  t28 = t6 * t6;
  t29 = t2 * t2;
  t31 = t28 / t29;
  t32 = 0.1e1 / t17;
  t34 = 0.1e1 / t13;
  t37 = t31 * p->hyb_omega[0] * t32 * t34 / 0.6e1;
  t38 = t37 < 0.5e-1;
  t39 = t14 * t14;
  t40 = M_PI * M_PI;
  t41 = t29 * t40;
  t42 = t39 * t41;
  t43 = t17 * rho[0];
  t44 = t42 * t43;
  t46 = t14 * t8;
  t49 = t46 * t6 * t18 * t4;
  t51 = 0.7e1 * t44 - 0.6e1 * t49;
  t52 = t14 * t13;
  t53 = 0.1e1 / p->hyb_omega[0];
  t54 = t53 * t6;
  t55 = t29 * t13;
  t58 = erf(t54 * t55 * t17);
  t59 = t52 * t58;
  t60 = sqrt(M_PI);
  t61 = t60 * t40;
  t69 = t4 * t4;
  t71 = 0.6e1 * t28 * t69;
  t72 = -0.36e2 * t59 * t61 * t28 * rho[0] * p->hyb_omega[0] + 0.81e2 * t44 + 0.54e2 * t49 - t71;
  t73 = 0.1e1 / t72;
  t75 = 0.1e11 < t37;
  t76 = t40 * t40;
  t77 = rho[0] * rho[0];
  t79 = t39 * t14;
  t82 = t8 * t28;
  t87 = t41 * t6;
  t93 = t69 * t4;
  t94 = 0.1e1 / t93;
  t98 = 0.1e1 / t4;
  t99 = t98 * t28;
  t101 = t99 * t46 * t18;
  t102 = exp(t101);
  t103 = t102 * t6;
  t104 = t103 * t14;
  t106 = t8 * t18 * t4;
  t110 = t102 * t28;
  t114 = (0.7e1 * t104 * t106 - 0.6e1 * t110 * t69 + 0.6e1 * t44 + 0.11e2 * t49 + t71) * t8;
  t116 = t14 * t6;
  t117 = t39 * t102;
  t118 = t41 * t28;
  t123 = t52 * t102 * t58;
  t124 = t61 * t6;
  t129 = t14 * t102;
  t138 = 0.2e1 * t69 * t6;
  t139 = 0.12e2 * t123 * t124 * rho[0] * p->hyb_omega[0] - 0.9e1 * t117 * t118 * t43 + 0.12e2 * t46 * t18 * t4 + 0.2e1 * t103 * t69 - 0.18e2 * t129 * t106 - t138;
  t142 = t116 * t98 / t139;
  t145 = my_piecewise5(t38, t51 * t73, t75, (0.28e4 * t82 * t18 * t69 * t14 - 0.14e3 * t87 * t43 * t4 * t39 - 0.1863e4 * t76 * t77 * t79) * t94 / 0.504e5, -t114 * t18 * t142 / 0.9e1);
  t146 = t27 * t145;
  t150 = t18 * t77;
  t152 = params->kappa * t150 * t8;
  t153 = 0.27e2 / 0.56e2 * t25 * t26 * t146 + t152;
  t154 = t3 * t153;
  t155 = t154 * t6;
  t158 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t159 = t158 * t43;
  t160 = 0.135e1 <= t37;
  t161 = 0.135e1 < t37;
  t162 = my_piecewise3(t161, t37, 0.135e1);
  t163 = t162 * t162;
  t164 = t163 * t163;
  t165 = t164 * t163;
  t166 = t164 * t164;
  t169 = t166 * t164;
  t171 = t166 * t163;
  t177 = 0.240888840192e14 * t166 * t165 + 0.19448e5 * t163 - 0.80784e6 * t164 + 0.3055104e8 * t165 - 0.104552448e10 * t166 - 0.90333315072e12 * t169 + 0.3226189824e11 * t171 - 0.429e3;
  t178 = t166 * t166;
  t179 = 0.1e1 / t178;
  t182 = my_piecewise3(t161, 0.135e1, t37);
  t183 = t182 * t182;
  t184 = t183 * t183;
  t187 = 0.32e2 * t184 - 0.16e2 * t183;
  t190 = exp(-0.1e1 / t183 / 0.4e1);
  t194 = 0.1e1 / t182;
  t196 = erf(t194 / 0.2e1);
  t197 = t60 * t196;
  t202 = my_piecewise3(t160, t177 * t179 / 0.8671998246912e15, t187 * t190 / 0.3e1 - 0.32e2 / 0.3e1 * t184 - 0.8e1 / 0.3e1 * t197 * t182 + 0.8e1 * t183 + 0.1e1);
  t203 = params->b_PBE * t145;
  t206 = sigma[0] * t12 * t6;
  t210 = 0.216e3 * t203 * t23 * t206 + 0.448e3 * t152;
  t211 = 0.1e1 / t210;
  t212 = t202 * t211;
  t213 = t159 * t212;
  t216 = my_piecewise3(t1, 0, -0.168e3 * t155 * t213);
  t217 = rho[1] <= p->dens_threshold;
  t218 = POW_1_3(rho[1]);
  t219 = t218 * t218;
  t220 = 0.1e1 / t219;
  t224 = exp(-t7 * t16 * t220 / 0.12e2);
  t226 = params->b_PBE * t224 * sigma[2];
  t227 = 0.1e1 / t218;
  t231 = t31 * p->hyb_omega[0] * t227 * t34 / 0.6e1;
  t232 = t231 < 0.5e-1;
  t233 = t218 * rho[1];
  t234 = t42 * t233;
  t238 = t46 * t6 * t219 * t4;
  t240 = 0.7e1 * t234 - 0.6e1 * t238;
  t243 = erf(t54 * t55 * t218);
  t244 = t52 * t243;
  t252 = -0.36e2 * t244 * t61 * t28 * rho[1] * p->hyb_omega[0] + 0.81e2 * t234 + 0.54e2 * t238 - t71;
  t253 = 0.1e1 / t252;
  t255 = 0.1e11 < t231;
  t256 = rho[1] * rho[1];
  t273 = t99 * t46 * t219;
  t274 = exp(t273);
  t275 = t274 * t219;
  t277 = t46 * t4;
  t281 = t274 * t28;
  t285 = (0.7e1 * t275 * t6 * t277 - 0.6e1 * t281 * t69 + 0.6e1 * t234 + 0.11e2 * t238 + t71) * t8;
  t287 = t39 * t274;
  t292 = t52 * t274 * t243;
  t297 = t14 * t274;
  t305 = t274 * t6;
  t308 = 0.12e2 * t292 * t124 * rho[1] * p->hyb_omega[0] - 0.18e2 * t297 * t8 * t219 * t4 - 0.9e1 * t287 * t118 * t233 + 0.12e2 * t46 * t219 * t4 + 0.2e1 * t305 * t69 - t138;
  t311 = t116 * t98 / t308;
  t314 = my_piecewise5(t232, t240 * t253, t255, (0.28e4 * t82 * t219 * t69 * t14 - 0.14e3 * t87 * t233 * t4 * t39 - 0.1863e4 * t76 * t256 * t79) * t94 / 0.504e5, -t285 * t219 * t311 / 0.9e1);
  t315 = t27 * t314;
  t319 = t219 * t256;
  t321 = params->kappa * t319 * t8;
  t322 = 0.27e2 / 0.56e2 * t226 * t26 * t315 + t321;
  t323 = t3 * t322;
  t324 = t323 * t6;
  t325 = t158 * t233;
  t326 = 0.135e1 <= t231;
  t327 = 0.135e1 < t231;
  t328 = my_piecewise3(t327, t231, 0.135e1);
  t329 = t328 * t328;
  t330 = t329 * t329;
  t331 = t330 * t329;
  t332 = t330 * t330;
  t335 = t332 * t330;
  t337 = t332 * t329;
  t343 = 0.240888840192e14 * t332 * t331 + 0.19448e5 * t329 - 0.80784e6 * t330 + 0.3055104e8 * t331 - 0.104552448e10 * t332 - 0.90333315072e12 * t335 + 0.3226189824e11 * t337 - 0.429e3;
  t344 = t332 * t332;
  t345 = 0.1e1 / t344;
  t348 = my_piecewise3(t327, 0.135e1, t231);
  t349 = t348 * t348;
  t350 = t349 * t349;
  t353 = 0.32e2 * t350 - 0.16e2 * t349;
  t356 = exp(-0.1e1 / t349 / 0.4e1);
  t360 = 0.1e1 / t348;
  t362 = erf(t360 / 0.2e1);
  t368 = my_piecewise3(t326, t343 * t345 / 0.8671998246912e15, t353 * t356 / 0.3e1 - 0.32e2 / 0.3e1 * t350 - 0.8e1 / 0.3e1 * t362 * t348 * t60 + 0.8e1 * t349 + 0.1e1);
  t369 = params->b_PBE * t314;
  t372 = sigma[2] * t12 * t6;
  t376 = 0.216e3 * t369 * t224 * t372 + 0.448e3 * t321;
  t377 = 0.1e1 / t376;
  t378 = t368 * t377;
  t379 = t325 * t378;
  t382 = my_piecewise3(t217, 0, -0.168e3 * t324 * t379);
  tzk0 = (t216 + t382) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t390 = params->b_PBE * params->ax * t4 * t28 * t9 * t15;
  t391 = t18 * rho[0];
  t392 = 0.1e1 / t391;
  t394 = t392 * t23 * sigma[0];
  t395 = t12 * t27;
  t396 = t395 * t145;
  t400 = t42 * t17;
  t402 = t6 * t32;
  t404 = t46 * t402 * t4;
  t406 = 0.28e2 / 0.3e1 * t400 - 0.4e1 * t404;
  t408 = t72 * t72;
  t409 = 0.1e1 / t408;
  t410 = t51 * t409;
  t411 = exp(-t101);
  t416 = t61 * t28 * p->hyb_omega[0];
  t421 = -0.72e2 * t42 * t411 * t17 - 0.36e2 * t59 * t416 + 0.108e3 * t400 + 0.36e2 * t404;
  t424 = t76 * rho[0];
  t443 = t8 * t32 * t4;
  t448 = (0.8e1 * t400 + 0.14e2 * t42 * t17 * t102 - 0.22e2 / 0.3e1 * t104 * t443 + 0.22e2 / 0.3e1 * t404) * t8;
  t455 = t18 * t14;
  t456 = t114 * t455;
  t457 = t6 * t98;
  t458 = t139 * t139;
  t459 = 0.1e1 / t458;
  t460 = t79 * t98;
  t461 = t460 * t6;
  t470 = t40 * M_PI;
  t471 = pow(M_PI, 0.1e1 / 0.6e1);
  t472 = t471 * t471;
  t473 = t472 * t472;
  t474 = t473 * t471;
  t476 = t39 * t13 * t53 * t474 * t470;
  t481 = t117 * t41;
  t482 = t411 * t28;
  t486 = t124 * p->hyb_omega[0];
  t494 = 0.24e2 * t476 * t18 * t102 * t58 - 0.18e2 * t461 * t424 * t102 - 0.24e2 * t117 * t118 * t17 + 0.8e1 * t481 * t482 * t17 + 0.8e1 * t46 * t32 * t4 + 0.12e2 * t123 * t486 - 0.8e1 * t129 * t443;
  t496 = t457 * t459 * t494;
  t500 = my_piecewise5(t38, t406 * t73 - t410 * t421, t75, (-0.3726e4 * t424 * t79 + 0.56e4 / 0.3e1 * t82 * t32 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t17 * t4 * t39) * t94 / 0.504e5, -t448 * t18 * t142 / 0.9e1 - 0.2e1 / 0.27e2 * t114 * t32 * t142 + t456 * t496 / 0.9e1);
  t501 = t27 * t500;
  t506 = params->kappa * t391 * t8;
  t508 = 0.3e1 / 0.112e3 * t390 * t394 * t396 + 0.27e2 / 0.56e2 * t25 * t26 * t501 + 0.8e1 / 0.3e1 * t506;
  t509 = t3 * t508;
  t510 = t509 * t6;
  t513 = t158 * t17;
  t514 = t513 * t212;
  t517 = t164 * t162;
  t518 = t166 * t517;
  t519 = 0.1e1 / t43;
  t523 = t31 * p->hyb_omega[0] * t519 * t34 / 0.18e2;
  t524 = my_piecewise3(t161, -t523, 0);
  t527 = t163 * t162;
  t528 = t166 * t527;
  t531 = t166 * t162;
  t534 = t164 * t527;
  t543 = 0.38896e5 * t162 * t524 + 0.18330624e9 * t517 * t524 + 0.3372443762688e15 * t518 * t524 - 0.323136e7 * t527 * t524 - 0.1083999780864e14 * t528 * t524 + 0.3226189824e12 * t531 * t524 - 0.836419584e10 * t534 * t524;
  t547 = 0.1e1 / t178 / t162;
  t548 = t177 * t547;
  t552 = t183 * t182;
  t553 = my_piecewise3(t161, 0, -t523);
  t554 = t552 * t553;
  t556 = t182 * t553;
  t558 = 0.128e3 * t554 - 0.32e2 * t556;
  t561 = 0.1e1 / t552;
  t562 = t187 * t561;
  t563 = t553 * t190;
  t567 = t190 * t194;
  t574 = my_piecewise3(t160, t543 * t179 / 0.8671998246912e15 - t548 * t524 / 0.541999890432e14, t558 * t190 / 0.3e1 + t562 * t563 / 0.6e1 - 0.128e3 / 0.3e1 * t554 + 0.8e1 / 0.3e1 * t567 * t553 - 0.8e1 / 0.3e1 * t197 * t553 + 0.16e2 * t556);
  t575 = t574 * t211;
  t576 = t159 * t575;
  t579 = t6 * t158;
  t580 = t154 * t579;
  t581 = t43 * t202;
  t582 = t210 * t210;
  t583 = 0.1e1 / t582;
  t584 = params->b_PBE * t500;
  t588 = t5 * t28;
  t589 = t203 * t588;
  t592 = t23 * sigma[0] * t12;
  t593 = t16 * t392 * t592;
  t597 = 0.216e3 * t584 * t23 * t206 + 0.12e2 * t589 * t593 + 0.3584e4 / 0.3e1 * t506;
  t598 = t583 * t597;
  t599 = t581 * t598;
  tvrho0 = my_piecewise3(t1, 0, -0.224e3 * t155 * t514 - 0.168e3 * t155 * t576 - 0.168e3 * t510 * t213 + 0.168e3 * t580 * t599);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t603 = t219 * rho[1];
  t604 = 0.1e1 / t603;
  t606 = t604 * t224 * sigma[2];
  t607 = t395 * t314;
  t611 = t42 * t218;
  t613 = t6 * t227;
  t615 = t46 * t613 * t4;
  t617 = 0.28e2 / 0.3e1 * t611 - 0.4e1 * t615;
  t619 = t252 * t252;
  t620 = 0.1e1 / t619;
  t621 = t240 * t620;
  t622 = exp(-t273);
  t630 = -0.72e2 * t42 * t622 * t218 - 0.36e2 * t244 * t416 + 0.108e3 * t611 + 0.36e2 * t615;
  t633 = t76 * rho[1];
  t651 = t274 * t227;
  t652 = t651 * t6;
  t657 = (0.8e1 * t611 + 0.14e2 * t42 * t218 * t274 - 0.22e2 / 0.3e1 * t652 * t277 + 0.22e2 / 0.3e1 * t615) * t8;
  t664 = t219 * t14;
  t665 = t285 * t664;
  t666 = t308 * t308;
  t667 = 0.1e1 / t666;
  t677 = t287 * t41;
  t678 = t622 * t28;
  t691 = -0.8e1 * t297 * t8 * t227 * t4 - 0.24e2 * t287 * t118 * t218 + 0.8e1 * t677 * t678 * t218 + 0.8e1 * t46 * t227 * t4 + 0.24e2 * t476 * t275 * t243 - 0.18e2 * t461 * t633 * t274 + 0.12e2 * t292 * t486;
  t693 = t457 * t667 * t691;
  t697 = my_piecewise5(t232, t617 * t253 - t621 * t630, t255, (-0.3726e4 * t633 * t79 + 0.56e4 / 0.3e1 * t82 * t227 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t218 * t4 * t39) * t94 / 0.504e5, -t657 * t219 * t311 / 0.9e1 - 0.2e1 / 0.27e2 * t285 * t227 * t311 + t665 * t693 / 0.9e1);
  t698 = t27 * t697;
  t703 = params->kappa * t603 * t8;
  t705 = 0.3e1 / 0.112e3 * t390 * t606 * t607 + 0.27e2 / 0.56e2 * t226 * t26 * t698 + 0.8e1 / 0.3e1 * t703;
  t706 = t3 * t705;
  t707 = t706 * t6;
  t710 = t158 * t218;
  t711 = t710 * t378;
  t714 = t330 * t328;
  t715 = t332 * t714;
  t716 = 0.1e1 / t233;
  t720 = t31 * p->hyb_omega[0] * t716 * t34 / 0.18e2;
  t721 = my_piecewise3(t327, -t720, 0);
  t724 = t329 * t328;
  t725 = t332 * t724;
  t728 = t332 * t328;
  t731 = t330 * t724;
  t740 = 0.38896e5 * t328 * t721 + 0.18330624e9 * t714 * t721 + 0.3372443762688e15 * t715 * t721 - 0.323136e7 * t724 * t721 - 0.1083999780864e14 * t725 * t721 + 0.3226189824e12 * t728 * t721 - 0.836419584e10 * t731 * t721;
  t744 = 0.1e1 / t344 / t328;
  t745 = t343 * t744;
  t749 = t349 * t348;
  t750 = my_piecewise3(t327, 0, -t720);
  t751 = t749 * t750;
  t753 = t348 * t750;
  t755 = 0.128e3 * t751 - 0.32e2 * t753;
  t758 = 0.1e1 / t749;
  t759 = t353 * t758;
  t760 = t750 * t356;
  t764 = t356 * t360;
  t772 = my_piecewise3(t326, t740 * t345 / 0.8671998246912e15 - t745 * t721 / 0.541999890432e14, t755 * t356 / 0.3e1 + t759 * t760 / 0.6e1 - 0.128e3 / 0.3e1 * t751 + 0.8e1 / 0.3e1 * t764 * t750 - 0.8e1 / 0.3e1 * t362 * t750 * t60 + 0.16e2 * t753);
  t773 = t772 * t377;
  t774 = t325 * t773;
  t777 = t323 * t579;
  t778 = t233 * t368;
  t779 = t376 * t376;
  t780 = 0.1e1 / t779;
  t781 = params->b_PBE * t697;
  t785 = t369 * t588;
  t788 = t224 * sigma[2] * t12;
  t789 = t16 * t604 * t788;
  t793 = 0.216e3 * t781 * t224 * t372 + 0.12e2 * t785 * t789 + 0.3584e4 / 0.3e1 * t703;
  t794 = t780 * t793;
  t795 = t778 * t794;
  tvrho1 = my_piecewise3(t217, 0, -0.224e3 * t324 * t711 - 0.168e3 * t324 * t774 - 0.168e3 * t707 * t379 + 0.168e3 * t777 * t795);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t799 = t3 * params->b_PBE;
  t800 = t23 * t12;
  t802 = t799 * t800 * t28;
  t803 = t146 * t158;
  t804 = t581 * t211;
  t808 = t28 * t158;
  t809 = t808 * t43;
  t810 = t154 * t809;
  t811 = t202 * t583;
  t812 = t811 * params->b_PBE;
  t814 = t145 * t23 * t12;
  t815 = t812 * t814;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t802 * t803 * t804 + 0.36288e5 * t810 * t815);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t819 = t224 * t12;
  t821 = t799 * t819 * t28;
  t822 = t315 * t158;
  t823 = t778 * t377;
  t827 = t808 * t233;
  t828 = t323 * t827;
  t829 = t368 * t780;
  t830 = t829 * params->b_PBE;
  t832 = t314 * t224 * t12;
  t833 = t830 * t832;
  tvsigma2 = my_piecewise3(t217, 0, -0.81e2 * t821 * t822 * t823 + 0.36288e5 * t828 * t833);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t837 = 0.1e1 / t150;
  t839 = t837 * t23 * sigma[0];
  t843 = params->ax * params->ax;
  t845 = 0.1e1 / t41;
  t847 = 0.1e1 / t39;
  t849 = params->b_PBE * t843 * t69 * t845 * t847;
  t850 = t77 * rho[0];
  t852 = 0.1e1 / t17 / t850;
  t854 = t852 * t23 * sigma[0];
  t858 = t395 * t500;
  t862 = t42 * t19;
  t864 = t6 * t519;
  t866 = t46 * t864 * t4;
  t868 = 0.28e2 / 0.9e1 * t862 + 0.4e1 / 0.3e1 * t866;
  t870 = t406 * t409;
  t874 = 0.1e1 / t408 / t72;
  t875 = t51 * t874;
  t876 = t421 * t421;
  t879 = t76 * t79;
  t883 = t411 * t19;
  t888 = 0.48e2 * t879 * t99 * t411 - 0.96e2 * t42 * t883 + 0.36e2 * t862 - 0.12e2 * t866;
  t891 = 0.3726e4 * t879;
  t907 = t99 * t102;
  t911 = t8 * t519 * t4;
  t916 = (0.8e1 / 0.3e1 * t862 - 0.1e2 * t42 * t19 * t102 + 0.28e2 / 0.3e1 * t879 * t907 + 0.22e2 / 0.9e1 * t104 * t911 - 0.22e2 / 0.9e1 * t866) * t8;
  t923 = t448 * t455;
  t929 = t32 * t14;
  t930 = t114 * t929;
  t934 = 0.1e1 / t458 / t139;
  t935 = t494 * t494;
  t937 = t457 * t934 * t935;
  t940 = t6 * t76;
  t944 = t39 * t39;
  t945 = 0.1e1 / t69;
  t946 = t944 * t945;
  t947 = t76 * M_PI;
  t948 = t2 * t947;
  t956 = t32 * t102;
  t957 = t956 * t58;
  t961 = t4 * p->hyb_omega[0];
  t965 = t39 * t52 / t961 * t471 * t947;
  t966 = t17 * t28;
  t967 = t102 * t58;
  t971 = t460 * t76;
  t984 = -0.66e2 * t460 * t940 * t102 - 0.36e2 * t946 * t948 * t18 * t102 - 0.4e2 / 0.3e1 * t117 * t118 * t19 + 0.4e2 * t476 * t957 + 0.16e2 * t965 * t966 * t967 + 0.16e2 * t971 * t102 * t411 * t6 + 0.32e2 / 0.3e1 * t481 * t482 * t19 + 0.8e1 / 0.3e1 * t129 * t911 - 0.8e1 / 0.3e1 * t46 * t519 * t4;
  t986 = t457 * t459 * t984;
  t990 = my_piecewise5(t38, -t410 * t888 - 0.2e1 * t870 * t421 + t868 * t73 + 0.2e1 * t875 * t876, t75, (-t891 - 0.56e4 / 0.9e1 * t82 * t519 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t19 * t4 * t39) * t94 / 0.504e5, -t916 * t18 * t142 / 0.9e1 - 0.4e1 / 0.27e2 * t448 * t32 * t142 + 0.2e1 / 0.9e1 * t923 * t496 + 0.2e1 / 0.81e2 * t114 * t519 * t142 + 0.4e1 / 0.27e2 * t930 * t496 - 0.2e1 / 0.9e1 * t456 * t937 + t456 * t986 / 0.9e1);
  t991 = t27 * t990;
  t996 = params->kappa * t18 * t8;
  t998 = -0.5e1 / 0.112e3 * t390 * t839 * t396 + t849 * t854 * t396 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t394 * t858 + 0.27e2 / 0.56e2 * t25 * t26 * t991 + 0.4e2 / 0.9e1 * t996;
  t999 = t3 * t998;
  t1000 = t999 * t6;
  t1007 = t509 * t579;
  t1010 = t158 * t19;
  t1011 = t1010 * t212;
  t1014 = t513 * t575;
  t1017 = t17 * t202;
  t1018 = t1017 * t598;
  t1021 = t524 * t524;
  t1025 = 0.1e1 / t17 / t77;
  t1029 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1025 * t34;
  t1030 = my_piecewise3(t161, t1029, 0);
  t1056 = -0.969408e7 * t163 * t1021 + 0.9165312e9 * t164 * t1021 - 0.5854937088e11 * t165 * t1021 + 0.29035708416e13 * t166 * t1021 + 0.43841768914944e16 * t169 * t1021 - 0.11923997589504e15 * t171 * t1021 + 0.38896e5 * t162 * t1030 + 0.18330624e9 * t517 * t1030 + 0.3372443762688e15 * t518 * t1030 - 0.323136e7 * t527 * t1030 - 0.1083999780864e14 * t528 * t1030 + 0.3226189824e12 * t531 * t1030 - 0.836419584e10 * t534 * t1030 + 0.38896e5 * t1021;
  t1059 = t543 * t547;
  t1063 = 0.1e1 / t178 / t163;
  t1064 = t177 * t1063;
  t1070 = t553 * t553;
  t1071 = t183 * t1070;
  t1073 = my_piecewise3(t161, 0, t1029);
  t1074 = t552 * t1073;
  t1077 = t182 * t1073;
  t1079 = 0.384e3 * t1071 + 0.128e3 * t1074 - 0.32e2 * t1070 - 0.32e2 * t1077;
  t1082 = t558 * t561;
  t1085 = 0.1e1 / t184;
  t1086 = t187 * t1085;
  t1087 = t1070 * t190;
  t1090 = t1073 * t190;
  t1094 = 0.1e1 / t184 / t183;
  t1095 = t187 * t1094;
  t1109 = t1079 * t190 / 0.3e1 + t1082 * t563 / 0.3e1 - t1086 * t1087 / 0.2e1 + t562 * t1090 / 0.6e1 + t1095 * t1087 / 0.12e2 - 0.128e3 * t1071 - 0.128e3 / 0.3e1 * t1074 + 0.4e1 / 0.3e1 * t1085 * t1070 * t190 + 0.8e1 / 0.3e1 * t567 * t1073 - 0.8e1 / 0.3e1 * t197 * t1073 + 0.16e2 * t1070 + 0.16e2 * t1077;
  t1110 = my_piecewise3(t160, t1056 * t179 / 0.8671998246912e15 - t1059 * t524 / 0.270999945216e14 + t1064 * t1021 / 0.31882346496e13 - t548 * t1030 / 0.541999890432e14, t1109);
  t1111 = t1110 * t211;
  t1112 = t159 * t1111;
  t1115 = t43 * t574;
  t1116 = t1115 * t598;
  t1120 = 0.1e1 / t582 / t210;
  t1121 = t597 * t597;
  t1122 = t1120 * t1121;
  t1123 = t581 * t1122;
  t1126 = params->b_PBE * t990;
  t1130 = t584 * t588;
  t1134 = t16 * t837 * t592;
  t1137 = t843 * t69;
  t1138 = t1137 * t845;
  t1139 = t203 * t1138;
  t1141 = t847 * t852 * t592;
  t1145 = 0.216e3 * t1126 * t23 * t206 + 0.24e2 * t1130 * t593 - 0.2e2 * t589 * t1134 + 0.2e1 * t1139 * t1141 + 0.1792e5 / 0.9e1 * t996;
  t1146 = t583 * t1145;
  t1147 = t581 * t1146;
  t1150 = -0.168e3 * t1000 * t213 - 0.448e3 * t510 * t514 - 0.336e3 * t510 * t576 + 0.336e3 * t1007 * t599 - 0.224e3 / 0.3e1 * t155 * t1011 - 0.448e3 * t155 * t1014 + 0.448e3 * t580 * t1018 - 0.168e3 * t155 * t1112 + 0.336e3 * t580 * t1116 - 0.336e3 * t580 * t1123 + 0.168e3 * t580 * t1147;
  tv2rho20 = my_piecewise3(t1, 0, t1150);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t1151 = 0.1e1 / t319;
  t1153 = t1151 * t224 * sigma[2];
  t1157 = t256 * rho[1];
  t1159 = 0.1e1 / t218 / t1157;
  t1161 = t1159 * t224 * sigma[2];
  t1165 = t395 * t697;
  t1169 = t42 * t220;
  t1171 = t6 * t716;
  t1173 = t46 * t1171 * t4;
  t1175 = 0.28e2 / 0.9e1 * t1169 + 0.4e1 / 0.3e1 * t1173;
  t1177 = t617 * t620;
  t1181 = 0.1e1 / t619 / t252;
  t1182 = t240 * t1181;
  t1183 = t630 * t630;
  t1189 = t622 * t220;
  t1194 = 0.48e2 * t879 * t99 * t622 - 0.96e2 * t42 * t1189 + 0.36e2 * t1169 - 0.12e2 * t1173;
  t1212 = t99 * t274;
  t1215 = t274 * t716;
  t1221 = (0.8e1 / 0.3e1 * t1169 - 0.1e2 * t42 * t220 * t274 + 0.28e2 / 0.3e1 * t879 * t1212 + 0.22e2 / 0.9e1 * t1215 * t6 * t277 - 0.22e2 / 0.9e1 * t1173) * t8;
  t1228 = t657 * t664;
  t1234 = t227 * t14;
  t1235 = t285 * t1234;
  t1239 = 0.1e1 / t666 / t308;
  t1240 = t691 * t691;
  t1242 = t457 * t1239 * t1240;
  t1255 = t651 * t243;
  t1258 = t218 * t28;
  t1259 = t274 * t243;
  t1277 = -0.66e2 * t460 * t940 * t274 - 0.36e2 * t946 * t948 * t219 * t274 - 0.4e2 / 0.3e1 * t287 * t118 * t220 + 0.4e2 * t476 * t1255 + 0.16e2 * t965 * t1258 * t1259 + 0.16e2 * t971 * t274 * t622 * t6 + 0.32e2 / 0.3e1 * t677 * t678 * t220 + 0.8e1 / 0.3e1 * t297 * t8 * t716 * t4 - 0.8e1 / 0.3e1 * t46 * t716 * t4;
  t1279 = t457 * t667 * t1277;
  t1283 = my_piecewise5(t232, t1175 * t253 - 0.2e1 * t1177 * t630 + 0.2e1 * t1182 * t1183 - t621 * t1194, t255, (-t891 - 0.56e4 / 0.9e1 * t82 * t716 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t220 * t4 * t39) * t94 / 0.504e5, -t1221 * t219 * t311 / 0.9e1 - 0.4e1 / 0.27e2 * t657 * t227 * t311 + 0.2e1 / 0.9e1 * t1228 * t693 + 0.2e1 / 0.81e2 * t285 * t716 * t311 + 0.4e1 / 0.27e2 * t1235 * t693 - 0.2e1 / 0.9e1 * t665 * t1242 + t665 * t1279 / 0.9e1);
  t1284 = t27 * t1283;
  t1289 = params->kappa * t219 * t8;
  t1291 = -0.5e1 / 0.112e3 * t390 * t1153 * t607 + t849 * t1161 * t607 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t606 * t1165 + 0.27e2 / 0.56e2 * t226 * t26 * t1284 + 0.4e2 / 0.9e1 * t1289;
  t1292 = t3 * t1291;
  t1293 = t1292 * t6;
  t1300 = t706 * t579;
  t1303 = t158 * t220;
  t1304 = t1303 * t378;
  t1307 = t710 * t773;
  t1310 = t218 * t368;
  t1311 = t1310 * t794;
  t1314 = t721 * t721;
  t1318 = 0.1e1 / t218 / t256;
  t1322 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1318 * t34;
  t1323 = my_piecewise3(t327, t1322, 0);
  t1349 = -0.969408e7 * t329 * t1314 + 0.9165312e9 * t330 * t1314 - 0.5854937088e11 * t331 * t1314 + 0.29035708416e13 * t332 * t1314 + 0.43841768914944e16 * t335 * t1314 - 0.11923997589504e15 * t337 * t1314 + 0.38896e5 * t328 * t1323 + 0.18330624e9 * t714 * t1323 + 0.3372443762688e15 * t715 * t1323 - 0.323136e7 * t724 * t1323 - 0.1083999780864e14 * t725 * t1323 + 0.3226189824e12 * t728 * t1323 - 0.836419584e10 * t731 * t1323 + 0.38896e5 * t1314;
  t1352 = t740 * t744;
  t1356 = 0.1e1 / t344 / t329;
  t1357 = t343 * t1356;
  t1363 = t750 * t750;
  t1364 = t349 * t1363;
  t1366 = my_piecewise3(t327, 0, t1322);
  t1367 = t749 * t1366;
  t1370 = t348 * t1366;
  t1372 = 0.384e3 * t1364 + 0.128e3 * t1367 - 0.32e2 * t1363 - 0.32e2 * t1370;
  t1375 = t755 * t758;
  t1378 = 0.1e1 / t350;
  t1379 = t353 * t1378;
  t1380 = t1363 * t356;
  t1383 = t1366 * t356;
  t1387 = 0.1e1 / t350 / t349;
  t1388 = t353 * t1387;
  t1403 = t1372 * t356 / 0.3e1 + t1375 * t760 / 0.3e1 - t1379 * t1380 / 0.2e1 + t759 * t1383 / 0.6e1 + t1388 * t1380 / 0.12e2 - 0.128e3 * t1364 - 0.128e3 / 0.3e1 * t1367 + 0.4e1 / 0.3e1 * t1378 * t1363 * t356 + 0.8e1 / 0.3e1 * t764 * t1366 - 0.8e1 / 0.3e1 * t362 * t1366 * t60 + 0.16e2 * t1363 + 0.16e2 * t1370;
  t1404 = my_piecewise3(t326, t1349 * t345 / 0.8671998246912e15 - t1352 * t721 / 0.270999945216e14 + t1357 * t1314 / 0.31882346496e13 - t745 * t1323 / 0.541999890432e14, t1403);
  t1405 = t1404 * t377;
  t1406 = t325 * t1405;
  t1409 = t233 * t772;
  t1410 = t1409 * t794;
  t1414 = 0.1e1 / t779 / t376;
  t1415 = t793 * t793;
  t1416 = t1414 * t1415;
  t1417 = t778 * t1416;
  t1420 = params->b_PBE * t1283;
  t1424 = t781 * t588;
  t1428 = t16 * t1151 * t788;
  t1431 = t369 * t1138;
  t1433 = t847 * t1159 * t788;
  t1437 = 0.216e3 * t1420 * t224 * t372 + 0.24e2 * t1424 * t789 - 0.2e2 * t785 * t1428 + 0.2e1 * t1431 * t1433 + 0.1792e5 / 0.9e1 * t1289;
  t1438 = t780 * t1437;
  t1439 = t778 * t1438;
  t1442 = -0.168e3 * t1293 * t379 - 0.448e3 * t707 * t711 - 0.336e3 * t707 * t774 + 0.336e3 * t1300 * t795 - 0.224e3 / 0.3e1 * t324 * t1304 - 0.448e3 * t324 * t1307 + 0.448e3 * t777 * t1311 - 0.168e3 * t324 * t1406 + 0.336e3 * t777 * t1410 - 0.336e3 * t777 * t1417 + 0.168e3 * t777 * t1439;
  tv2rho22 = my_piecewise3(t217, 0, t1442);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t1444 = 0.1e1 / t29 / M_PI;
  t1446 = t1444 * params->b_PBE * params->ax;
  t1447 = t4 * t15;
  t1449 = t1446 * t1447 * t32;
  t1450 = t800 * t27;
  t1451 = t145 * t158;
  t1453 = t1450 * t1451 * t212;
  t1456 = t501 * t158;
  t1460 = t1017 * t211;
  t1464 = t1115 * t211;
  t1470 = t12 * t28 * t27;
  t1471 = t799 * t23 * t1470;
  t1472 = t1451 * t43;
  t1473 = t811 * t597;
  t1477 = t509 * t809;
  t1480 = t808 * t17;
  t1481 = t154 * t1480;
  t1484 = t574 * t583;
  t1485 = t1484 * params->b_PBE;
  t1486 = t1485 * t814;
  t1489 = t154 * t28;
  t1490 = t159 * t202;
  t1491 = t1489 * t1490;
  t1492 = t1120 * params->b_PBE;
  t1493 = t1492 * t145;
  t1494 = t800 * t597;
  t1495 = t1493 * t1494;
  t1499 = t500 * t23 * t12;
  t1500 = t812 * t1499;
  t1504 = t1444 * t153 * t158;
  t1505 = t32 * t202;
  t1506 = t1505 * t583;
  t1507 = t1504 * t1506;
  t1509 = t1447 * t800;
  t1510 = t203 * params->ax * t1509;
  t1513 = -0.27e2 / 0.2e1 * t1449 * t1453 - 0.81e2 * t802 * t1456 * t804 - 0.108e3 * t802 * t803 * t1460 - 0.81e2 * t802 * t803 * t1464 + 0.81e2 * t1471 * t1472 * t1473 + 0.36288e5 * t1477 * t815 + 0.48384e5 * t1481 * t815 + 0.36288e5 * t810 * t1486 - 0.72576e5 * t1491 * t1495 + 0.36288e5 * t810 * t1500 + 0.6048e4 * t1507 * t1510;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1513);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t1515 = t1446 * t1447 * t227;
  t1516 = t819 * t27;
  t1517 = t314 * t158;
  t1519 = t1516 * t1517 * t378;
  t1522 = t698 * t158;
  t1526 = t1310 * t377;
  t1530 = t1409 * t377;
  t1535 = t799 * t224 * t1470;
  t1536 = t1517 * t233;
  t1537 = t829 * t793;
  t1541 = t706 * t827;
  t1544 = t808 * t218;
  t1545 = t323 * t1544;
  t1548 = t772 * t780;
  t1549 = t1548 * params->b_PBE;
  t1550 = t1549 * t832;
  t1553 = t323 * t28;
  t1554 = t325 * t368;
  t1555 = t1553 * t1554;
  t1556 = t1414 * params->b_PBE;
  t1557 = t1556 * t314;
  t1558 = t819 * t793;
  t1559 = t1557 * t1558;
  t1563 = t697 * t224 * t12;
  t1564 = t830 * t1563;
  t1568 = t1444 * t322 * t158;
  t1569 = t227 * t368;
  t1570 = t1569 * t780;
  t1571 = t1568 * t1570;
  t1573 = t1447 * t819;
  t1574 = t369 * params->ax * t1573;
  t1577 = -0.27e2 / 0.2e1 * t1515 * t1519 - 0.81e2 * t821 * t1522 * t823 - 0.108e3 * t821 * t822 * t1526 - 0.81e2 * t821 * t822 * t1530 + 0.81e2 * t1535 * t1536 * t1537 + 0.36288e5 * t1541 * t833 + 0.48384e5 * t1545 * t833 + 0.36288e5 * t828 * t1550 - 0.72576e5 * t1555 * t1559 + 0.36288e5 * t828 * t1564 + 0.6048e4 * t1571 * t1574;
  tv2rhosigma5 = my_piecewise3(t217, 0, t1577);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t1578 = params->b_PBE * params->b_PBE;
  t1579 = t3 * t1578;
  t1580 = t23 * t23;
  t1581 = t12 * t12;
  t1582 = t1580 * t1581;
  t1584 = t1579 * t1582 * t27;
  t1585 = t145 * t145;
  t1586 = t1585 * t158;
  t1587 = t581 * t583;
  t1591 = t154 * t1490;
  t1592 = t1120 * t1578;
  t1593 = t1585 * t1580;
  t1594 = t1593 * t1581;
  t1595 = t1592 * t1594;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1584 * t1586 * t1587 - 0.47029248e8 * t1591 * t1595);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t1599 = t224 * t224;
  t1600 = t1599 * t1581;
  t1602 = t1579 * t1600 * t27;
  t1603 = t314 * t314;
  t1604 = t1603 * t158;
  t1605 = t778 * t780;
  t1609 = t323 * t1554;
  t1610 = t1414 * t1578;
  t1611 = t1603 * t1599;
  t1612 = t1611 * t1581;
  t1613 = t1610 * t1612;
  tv2sigma25 = my_piecewise3(t217, 0, 0.104976e6 * t1602 * t1604 * t1605 - 0.47029248e8 * t1609 * t1613);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t1617 = t1120 * t597;
  t1618 = t1617 * t1145;
  t1619 = t581 * t1618;
  t1625 = 0.14e2 / 0.81e2 * t31 * p->hyb_omega[0] * t852 * t34;
  t1626 = my_piecewise3(t161, -t1625, 0);
  t1639 = t524 * t1030;
  t1643 = t1021 * t524;
  t1674 = -0.2908224e8 * t163 * t524 * t1030 + 0.27495936e10 * t164 * t524 * t1030 - 0.17564811264e12 * t165 * t524 * t1030 + 0.87107125248e13 * t166 * t524 * t1030 + 0.131525306744832e17 * t169 * t524 * t1030 - 0.35771992768512e15 * t171 * t524 * t1030 + 0.38896e5 * t162 * t1626 - 0.1938816e8 * t162 * t1643 + 0.18330624e9 * t517 * t1626 + 0.3372443762688e15 * t518 * t1626 - 0.323136e7 * t527 * t1626 - 0.1083999780864e14 * t528 * t1626 + 0.3226189824e12 * t531 * t1626 - 0.836419584e10 * t534 * t1626 - 0.35129622528e12 * t517 * t1643 + 0.36661248e10 * t527 * t1643 + 0.526101226979328e17 * t528 * t1643 - 0.11923997589504e16 * t531 * t1643 + 0.232285667328e14 * t534 * t1643 + 0.116688e6 * t1639;
  t1677 = t1056 * t547;
  t1680 = t543 * t1063;
  t1686 = 0.1e1 / t178 / t527;
  t1687 = t177 * t1686;
  t1695 = t558 * t1085;
  t1699 = 0.1e1 / t184 / t182;
  t1700 = t187 * t1699;
  t1701 = t1070 * t553;
  t1702 = t1701 * t190;
  t1705 = t563 * t1073;
  t1710 = t182 * t1701;
  t1712 = t183 * t553;
  t1713 = t1712 * t1073;
  t1715 = my_piecewise3(t161, 0, -t1625);
  t1716 = t552 * t1715;
  t1718 = t553 * t1073;
  t1720 = t182 * t1715;
  t1722 = 0.768e3 * t1710 + 0.1152e4 * t1713 + 0.128e3 * t1716 - 0.96e2 * t1718 - 0.32e2 * t1720;
  t1732 = 0.1e1 / t184 / t552;
  t1740 = t184 * t184;
  t1742 = 0.1e1 / t1740 / t182;
  t1743 = t187 * t1742;
  t1749 = t1085 * t553;
  t1752 = t1079 * t561;
  t1757 = t558 * t1094;
  t1760 = t187 * t1732;
  t1763 = t1715 * t190;
  t1766 = 0.2e1 / 0.3e1 * t1732 * t1701 * t190 + 0.8e1 / 0.3e1 * t567 * t1715 - 0.8e1 / 0.3e1 * t197 * t1715 + t1743 * t1702 / 0.24e2 - 0.16e2 / 0.3e1 * t1699 * t1701 * t190 + 0.4e1 * t1749 * t1090 + t1752 * t563 / 0.2e1 + t1082 * t1090 / 0.2e1 + t1757 * t1087 / 0.4e1 - 0.3e1 / 0.4e1 * t1760 * t1702 + t562 * t1763 / 0.6e1;
  t1768 = my_piecewise3(t160, t1674 * t179 / 0.8671998246912e15 - t1677 * t524 / 0.180666630144e14 + t1680 * t1021 / 0.10627448832e13 - t1059 * t1030 / 0.180666630144e14 - t1687 * t1643 / 0.1771241472e12 + t1064 * t1639 / 0.10627448832e13 - t548 * t1626 / 0.541999890432e14, -0.3e1 / 0.2e1 * t1695 * t1087 + 0.2e1 * t1700 * t1702 - 0.3e1 / 0.2e1 * t1086 * t1705 + t1095 * t1705 / 0.4e1 + t1722 * t190 / 0.3e1 - 0.128e3 / 0.3e1 * t1716 + 0.48e2 * t1718 + 0.16e2 * t1720 - 0.256e3 * t1710 - 0.384e3 * t1713 + t1766);
  t1769 = t1768 * t211;
  t1770 = t159 * t1769;
  t1773 = t1010 * t575;
  t1776 = t513 * t1111;
  t1785 = t158 * t392;
  t1786 = t1785 * t212;
  t1794 = 0.1e1 / t18 / t850;
  t1796 = t1794 * t23 * sigma[0];
  t1800 = t77 * t77;
  t1802 = 0.1e1 / t17 / t1800;
  t1804 = t1802 * t23 * sigma[0];
  t1811 = t843 * params->ax;
  t1813 = params->b_PBE * t1811 * t93;
  t1814 = 0.1e1 / t76;
  t1815 = 0.1e1 / t79;
  t1816 = t1814 * t1815;
  t1817 = t1800 * rho[0];
  t1818 = 0.1e1 / t1817;
  t1820 = t1813 * t1816 * t1818;
  t1821 = t6 * t23;
  t1822 = t1821 * sigma[0];
  t1823 = t1822 * t396;
  t1829 = t395 * t990;
  t1833 = t42 * t392;
  t1837 = t46 * t6 * t1025 * t4;
  t1839 = -0.56e2 / 0.27e2 * t1833 - 0.16e2 / 0.9e1 * t1837;
  t1841 = t868 * t409;
  t1844 = t406 * t874;
  t1849 = t408 * t408;
  t1850 = 0.1e1 / t1849;
  t1851 = t51 * t1850;
  t1852 = t876 * t421;
  t1855 = t421 * t888;
  t1858 = t944 * t948;
  t1859 = t1858 * t945;
  t1863 = 0.1e1 / rho[0];
  t1873 = 0.64e2 * t971 * t28 * t1863 * t411 - 0.96e2 * t1859 * t402 * t411 + 0.64e2 * t42 * t411 * t392 - 0.24e2 * t1833 + 0.16e2 * t1837;
  t1887 = t458 * t458;
  t1888 = 0.1e1 / t1887;
  t1891 = t457 * t1888 * t935 * t494;
  t1894 = t934 * t494;
  t1896 = t457 * t1894 * t984;
  t1914 = t8 * t1025 * t4;
  t1919 = (-0.16e2 / 0.9e1 * t1833 + 0.104e3 / 0.9e1 * t42 * t392 * t102 - 0.2e2 / 0.3e1 * t879 * t1863 * t907 + 0.56e2 / 0.3e1 * t1859 * t402 * t102 - 0.88e2 / 0.27e2 * t104 * t1914 + 0.88e2 / 0.27e2 * t1837) * t8;
  t1926 = t448 * t929;
  t1934 = t519 * t14;
  t1935 = t114 * t1934;
  t1944 = t944 * t14;
  t1946 = t76 * t40;
  t1947 = t29 * t1946;
  t1948 = t1944 * t94 * t1947;
  t1959 = t519 * t102;
  t1963 = t19 * t28;
  t1968 = t411 * t6;
  t1977 = t944 * t13 / t69 / p->hyb_omega[0] * t60 * t1946;
  t1992 = -0.156e3 * t946 * t948 * t32 * t102 - 0.24e2 * t1948 * t966 * t102 - 0.8e2 / 0.3e1 * t461 * t76 * t1863 * t102 + 0.32e2 / 0.3e1 * t117 * t118 * t392 - 0.4e2 / 0.3e1 * t476 * t1959 * t58 + 0.32e2 * t965 * t1963 * t967 + 0.8e2 / 0.3e1 * t971 * t1863 * t102 * t1968 + 0.32e2 * t1977 * t103 * t58 + 0.32e2 * t1859 * t956 * t411 - 0.64e2 / 0.9e1 * t481 * t482 * t392 - 0.32e2 / 0.9e1 * t129 * t1914 + 0.32e2 / 0.9e1 * t46 * t1025 * t4;
  t1994 = t457 * t459 * t1992;
  t2000 = t916 * t455;
  t2003 = 0.2e1 / 0.3e1 * t456 * t1891 - 0.2e1 / 0.3e1 * t456 * t1896 - 0.2e1 / 0.3e1 * t923 * t937 - 0.4e1 / 0.9e1 * t930 * t937 - t1919 * t18 * t142 / 0.9e1 + 0.2e1 / 0.27e2 * t448 * t519 * t142 + 0.4e1 / 0.9e1 * t1926 * t496 + t923 * t986 / 0.3e1 - 0.8e1 / 0.243e3 * t114 * t1025 * t142 - 0.2e1 / 0.27e2 * t1935 * t496 + 0.2e1 / 0.9e1 * t930 * t986 + t456 * t1994 / 0.9e1 - 0.2e1 / 0.9e1 * t916 * t32 * t142 + t2000 * t496 / 0.3e1;
  t2004 = my_piecewise5(t38, t1839 * t73 - 0.3e1 * t1841 * t421 + 0.6e1 * t1844 * t876 - 0.6e1 * t1851 * t1852 + 0.6e1 * t875 * t1855 - t410 * t1873 - 0.3e1 * t870 * t888, t75, (0.224e5 / 0.27e2 * t82 * t1025 * t69 * t14 + 0.112e4 / 0.27e2 * t87 * t392 * t4 * t39) * t94 / 0.504e5, t2003);
  t2005 = t27 * t2004;
  t2010 = params->kappa * t32 * t8;
  t2013 = t3 * (0.5e1 / 0.42e2 * t390 * t1796 * t396 - 0.5e1 / 0.224e3 * t849 * t1804 * t396 - 0.15e2 / 0.112e3 * t390 * t839 * t858 + t1820 * t1823 / 0.4032e4 + 0.3e1 / 0.224e3 * t849 * t854 * t858 + 0.9e1 / 0.112e3 * t390 * t394 * t1829 + 0.27e2 / 0.56e2 * t25 * t26 * t2005 + 0.8e2 / 0.27e2 * t2010);
  t2014 = t2013 * t6;
  t2017 = t582 * t582;
  t2018 = 0.1e1 / t2017;
  t2019 = t1121 * t597;
  t2020 = t2018 * t2019;
  t2021 = t581 * t2020;
  t2024 = -0.1008e4 * t580 * t1619 - 0.168e3 * t155 * t1770 - 0.224e3 * t155 * t1773 - 0.672e3 * t155 * t1776 - 0.504e3 * t510 * t1112 - 0.1344e4 * t510 * t1014 - 0.504e3 * t1000 * t576 + 0.448e3 / 0.9e1 * t155 * t1786 - 0.672e3 * t1000 * t514 - 0.224e3 * t510 * t1011 - 0.168e3 * t2014 * t213 + 0.1008e4 * t580 * t2021;
  t2027 = t1017 * t1122;
  t2030 = t1115 * t1122;
  t2033 = params->b_PBE * t2004;
  t2037 = t1126 * t588;
  t2042 = t584 * t1138;
  t2046 = t16 * t1794 * t592;
  t2050 = t847 * t1802 * t592;
  t2054 = t1811 * t93 * t1814;
  t2055 = t203 * t2054;
  t2058 = t1815 * t1818 * t6 * t592;
  t2062 = 0.216e3 * t2033 * t23 * t206 + 0.36e2 * t2037 * t593 - 0.6e2 * t1130 * t1134 + 0.6e1 * t2042 * t1141 + 0.16e3 / 0.3e1 * t589 * t2046 - 0.1e2 * t1139 * t2050 + t2055 * t2058 / 0.9e1 + 0.3584e5 / 0.27e2 * t2010;
  t2063 = t583 * t2062;
  t2064 = t581 * t2063;
  t2067 = t43 * t1110;
  t2068 = t2067 * t598;
  t2071 = t1115 * t1146;
  t2074 = t1017 * t1146;
  t2077 = t19 * t202;
  t2078 = t2077 * t598;
  t2081 = t17 * t574;
  t2082 = t2081 * t598;
  t2089 = t999 * t579;
  t2094 = 0.1344e4 * t1007 * t1018 + 0.1008e4 * t1007 * t1116 - 0.1008e4 * t1007 * t1123 + 0.504e3 * t1007 * t1147 - 0.1344e4 * t580 * t2027 - 0.1008e4 * t580 * t2030 + 0.168e3 * t580 * t2064 + 0.504e3 * t580 * t2068 + 0.504e3 * t580 * t2071 + 0.672e3 * t580 * t2074 + 0.224e3 * t580 * t2078 + 0.1344e4 * t580 * t2082 + 0.504e3 * t2089 * t599;
  tv3rho30 = my_piecewise3(t1, 0, t2024 + t2094);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  tv3rho31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  tv3rho32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t2096 = t1414 * t793;
  t2097 = t2096 * t1437;
  t2098 = t778 * t2097;
  t2105 = t1303 * t773;
  t2108 = t710 * t1405;
  t2116 = 0.1e1 / t219 / t1157;
  t2118 = t2116 * t224 * sigma[2];
  t2122 = t256 * t256;
  t2124 = 0.1e1 / t218 / t2122;
  t2126 = t2124 * t224 * sigma[2];
  t2133 = t2122 * rho[1];
  t2134 = 0.1e1 / t2133;
  t2136 = t1813 * t1816 * t2134;
  t2137 = t6 * t224;
  t2138 = t2137 * sigma[2];
  t2139 = t2138 * t607;
  t2145 = t395 * t1283;
  t2149 = t42 * t604;
  t2153 = t46 * t6 * t1318 * t4;
  t2155 = -0.56e2 / 0.27e2 * t2149 - 0.16e2 / 0.9e1 * t2153;
  t2157 = t1175 * t620;
  t2160 = t617 * t1181;
  t2165 = t619 * t619;
  t2166 = 0.1e1 / t2165;
  t2167 = t240 * t2166;
  t2168 = t1183 * t630;
  t2171 = t630 * t1194;
  t2177 = 0.1e1 / rho[1];
  t2187 = 0.64e2 * t971 * t28 * t2177 * t622 - 0.96e2 * t1859 * t613 * t622 + 0.64e2 * t42 * t622 * t604 - 0.24e2 * t2149 + 0.16e2 * t2153;
  t2205 = t666 * t666;
  t2206 = 0.1e1 / t2205;
  t2209 = t457 * t2206 * t1240 * t691;
  t2212 = t1239 * t691;
  t2214 = t457 * t2212 * t1277;
  t2220 = t716 * t14;
  t2221 = t285 * t2220;
  t2243 = t220 * t28;
  t2248 = t622 * t6;
  t2268 = -0.156e3 * t946 * t948 * t227 * t274 - 0.24e2 * t1948 * t1258 * t274 - 0.8e2 / 0.3e1 * t461 * t76 * t2177 * t274 + 0.32e2 / 0.3e1 * t287 * t118 * t604 - 0.4e2 / 0.3e1 * t476 * t1215 * t243 + 0.32e2 * t965 * t2243 * t1259 + 0.8e2 / 0.3e1 * t971 * t2177 * t274 * t2248 + 0.32e2 * t1977 * t305 * t243 + 0.32e2 * t1859 * t651 * t622 - 0.64e2 / 0.9e1 * t677 * t678 * t604 - 0.32e2 / 0.9e1 * t297 * t8 * t1318 * t4 + 0.32e2 / 0.9e1 * t46 * t1318 * t4;
  t2270 = t457 * t667 * t2268;
  t2276 = t1221 * t664;
  t2282 = t657 * t1234;
  t2296 = t274 * t1318;
  t2302 = (-0.16e2 / 0.9e1 * t2149 + 0.104e3 / 0.9e1 * t42 * t604 * t274 - 0.2e2 / 0.3e1 * t879 * t2177 * t1212 + 0.56e2 / 0.3e1 * t1859 * t652 - 0.88e2 / 0.27e2 * t2296 * t6 * t277 + 0.88e2 / 0.27e2 * t2153) * t8;
  t2306 = -0.2e1 / 0.3e1 * t1228 * t1242 - 0.4e1 / 0.9e1 * t1235 * t1242 + 0.2e1 / 0.3e1 * t665 * t2209 - 0.2e1 / 0.3e1 * t665 * t2214 - 0.8e1 / 0.243e3 * t285 * t1318 * t311 - 0.2e1 / 0.27e2 * t2221 * t693 + 0.2e1 / 0.9e1 * t1235 * t1279 + t665 * t2270 / 0.9e1 - 0.2e1 / 0.9e1 * t1221 * t227 * t311 + t2276 * t693 / 0.3e1 + 0.2e1 / 0.27e2 * t657 * t716 * t311 + 0.4e1 / 0.9e1 * t2282 * t693 + t1228 * t1279 / 0.3e1 - t2302 * t219 * t311 / 0.9e1;
  t2307 = my_piecewise5(t232, -0.3e1 * t1177 * t1194 + 0.6e1 * t1182 * t2171 + 0.6e1 * t2160 * t1183 + t2155 * t253 - 0.3e1 * t2157 * t630 - 0.6e1 * t2167 * t2168 - t621 * t2187, t255, (0.224e5 / 0.27e2 * t82 * t1318 * t69 * t14 + 0.112e4 / 0.27e2 * t87 * t604 * t4 * t39) * t94 / 0.504e5, t2306);
  t2308 = t27 * t2307;
  t2313 = params->kappa * t227 * t8;
  t2316 = t3 * (0.5e1 / 0.42e2 * t390 * t2118 * t607 - 0.5e1 / 0.224e3 * t849 * t2126 * t607 - 0.15e2 / 0.112e3 * t390 * t1153 * t1165 + t2136 * t2139 / 0.4032e4 + 0.3e1 / 0.224e3 * t849 * t1161 * t1165 + 0.9e1 / 0.112e3 * t390 * t606 * t2145 + 0.27e2 / 0.56e2 * t226 * t26 * t2308 + 0.8e2 / 0.27e2 * t2313);
  t2317 = t2316 * t6;
  t2322 = t158 * t604;
  t2323 = t2322 * t378;
  t2329 = 0.14e2 / 0.81e2 * t31 * p->hyb_omega[0] * t1159 * t34;
  t2330 = my_piecewise3(t327, -t2329, 0);
  t2337 = t721 * t1323;
  t2347 = t1314 * t721;
  t2378 = -0.2908224e8 * t329 * t721 * t1323 + 0.27495936e10 * t330 * t721 * t1323 - 0.17564811264e12 * t331 * t721 * t1323 + 0.87107125248e13 * t332 * t721 * t1323 + 0.131525306744832e17 * t335 * t721 * t1323 - 0.35771992768512e15 * t337 * t721 * t1323 + 0.38896e5 * t328 * t2330 + 0.18330624e9 * t714 * t2330 + 0.3372443762688e15 * t715 * t2330 - 0.323136e7 * t724 * t2330 - 0.1083999780864e14 * t725 * t2330 + 0.3226189824e12 * t728 * t2330 - 0.836419584e10 * t731 * t2330 - 0.1938816e8 * t328 * t2347 - 0.35129622528e12 * t714 * t2347 + 0.36661248e10 * t724 * t2347 + 0.526101226979328e17 * t725 * t2347 - 0.11923997589504e16 * t728 * t2347 + 0.232285667328e14 * t731 * t2347 + 0.116688e6 * t2337;
  t2381 = t1349 * t744;
  t2384 = t740 * t1356;
  t2390 = 0.1e1 / t344 / t724;
  t2391 = t343 * t2390;
  t2399 = t755 * t1378;
  t2403 = 0.1e1 / t350 / t348;
  t2404 = t353 * t2403;
  t2405 = t1363 * t750;
  t2406 = t2405 * t356;
  t2409 = t760 * t1366;
  t2414 = t750 * t1366;
  t2416 = my_piecewise3(t327, 0, -t2329);
  t2417 = t348 * t2416;
  t2419 = t348 * t2405;
  t2421 = t349 * t750;
  t2422 = t2421 * t1366;
  t2424 = t749 * t2416;
  t2428 = 0.768e3 * t2419 + 0.1152e4 * t2422 + 0.128e3 * t2424 - 0.96e2 * t2414 - 0.32e2 * t2417;
  t2433 = 0.1e1 / t350 / t749;
  t2448 = t1378 * t750;
  t2451 = t1372 * t758;
  t2456 = t755 * t1387;
  t2459 = t353 * t2433;
  t2462 = t2416 * t356;
  t2465 = t350 * t350;
  t2467 = 0.1e1 / t2465 / t348;
  t2468 = t353 * t2467;
  t2471 = -0.8e1 / 0.3e1 * t362 * t2416 * t60 - 0.256e3 * t2419 - 0.384e3 * t2422 - 0.16e2 / 0.3e1 * t2403 * t2405 * t356 + 0.4e1 * t2448 * t1383 + t2451 * t760 / 0.2e1 + t1375 * t1383 / 0.2e1 + t2456 * t1380 / 0.4e1 - 0.3e1 / 0.4e1 * t2459 * t2406 + t759 * t2462 / 0.6e1 + t2468 * t2406 / 0.24e2;
  t2473 = my_piecewise3(t326, t2378 * t345 / 0.8671998246912e15 - t2381 * t721 / 0.180666630144e14 + t2384 * t1314 / 0.10627448832e13 - t1352 * t1323 / 0.180666630144e14 - t2391 * t2347 / 0.1771241472e12 + t1357 * t2337 / 0.10627448832e13 - t745 * t2330 / 0.541999890432e14, -0.3e1 / 0.2e1 * t2399 * t1380 + 0.2e1 * t2404 * t2406 - 0.3e1 / 0.2e1 * t1379 * t2409 + t1388 * t2409 / 0.4e1 + 0.48e2 * t2414 + 0.16e2 * t2417 + t2428 * t356 / 0.3e1 - 0.128e3 / 0.3e1 * t2424 + 0.2e1 / 0.3e1 * t2433 * t2405 * t356 + 0.8e1 / 0.3e1 * t764 * t2416 + t2471);
  t2474 = t2473 * t377;
  t2475 = t325 * t2474;
  t2478 = t1409 * t1416;
  t2481 = -0.1008e4 * t777 * t2098 - 0.1344e4 * t707 * t1307 - 0.504e3 * t707 * t1406 - 0.224e3 * t324 * t2105 - 0.672e3 * t324 * t2108 - 0.672e3 * t1293 * t711 - 0.224e3 * t707 * t1304 - 0.168e3 * t2317 * t379 - 0.504e3 * t1293 * t774 + 0.448e3 / 0.9e1 * t324 * t2323 - 0.168e3 * t324 * t2475 - 0.1008e4 * t777 * t2478;
  t2482 = t779 * t779;
  t2483 = 0.1e1 / t2482;
  t2484 = t1415 * t793;
  t2485 = t2483 * t2484;
  t2486 = t778 * t2485;
  t2491 = t1310 * t1416;
  t2494 = params->b_PBE * t2307;
  t2498 = t1420 * t588;
  t2503 = t781 * t1138;
  t2507 = t16 * t2116 * t788;
  t2511 = t847 * t2124 * t788;
  t2514 = t369 * t2054;
  t2517 = t1815 * t2134 * t6 * t788;
  t2521 = 0.216e3 * t2494 * t224 * t372 + 0.36e2 * t2498 * t789 - 0.6e2 * t1424 * t1428 + 0.6e1 * t2503 * t1433 + 0.16e3 / 0.3e1 * t785 * t2507 - 0.1e2 * t1431 * t2511 + t2514 * t2517 / 0.9e1 + 0.3584e5 / 0.27e2 * t2313;
  t2522 = t780 * t2521;
  t2523 = t778 * t2522;
  t2526 = t1409 * t1438;
  t2529 = t233 * t1404;
  t2530 = t2529 * t794;
  t2533 = t1310 * t1438;
  t2536 = t220 * t368;
  t2537 = t2536 * t794;
  t2540 = t218 * t772;
  t2541 = t2540 * t794;
  t2548 = t1292 * t579;
  t2553 = 0.1344e4 * t1300 * t1311 + 0.1008e4 * t1300 * t1410 - 0.1008e4 * t1300 * t1417 + 0.504e3 * t1300 * t1439 + 0.1008e4 * t777 * t2486 - 0.1344e4 * t777 * t2491 + 0.168e3 * t777 * t2523 + 0.504e3 * t777 * t2526 + 0.504e3 * t777 * t2530 + 0.672e3 * t777 * t2533 + 0.224e3 * t777 * t2537 + 0.1344e4 * t777 * t2541 + 0.504e3 * t2548 * t795;
  tv3rho33 = my_piecewise3(t217, 0, t2481 + t2553);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t2555 = t2018 * params->b_PBE;
  t2556 = t2555 * t145;
  t2557 = t800 * t1121;
  t2558 = t2556 * t2557;
  t2561 = t1492 * t500;
  t2562 = t2561 * t1494;
  t2565 = t800 * t1145;
  t2566 = t1493 * t2565;
  t2569 = t509 * t28;
  t2570 = t2569 * t1490;
  t2573 = t808 * t19;
  t2574 = t154 * t2573;
  t2577 = t509 * t1480;
  t2580 = t2077 * t211;
  t2588 = t990 * t23 * t12;
  t2589 = t812 * t2588;
  t2598 = t1110 * t583;
  t2599 = t2598 * params->b_PBE;
  t2600 = t2599 * t814;
  t2603 = t1485 * t1499;
  t2606 = t2067 * t211;
  t2610 = t999 * t809;
  t2615 = t991 * t158;
  t2622 = -0.216e3 * t802 * t1456 * t1460 - 0.162e3 * t802 * t1456 * t1464 - 0.36e2 * t802 * t803 * t2580 - 0.81e2 * t802 * t803 * t2606 - 0.81e2 * t802 * t2615 * t804 + 0.72576e5 * t1477 * t1486 + 0.72576e5 * t1477 * t1500 + 0.96768e5 * t1481 * t1486 + 0.96768e5 * t1481 * t1500 + 0.217728e6 * t1491 * t2558 - 0.145152e6 * t1491 * t2562 - 0.72576e5 * t1491 * t2566 - 0.145152e6 * t2570 * t1495 + 0.16128e5 * t2574 * t815 + 0.96768e5 * t2577 * t815 + 0.36288e5 * t810 * t2589 + 0.36288e5 * t810 * t2600 + 0.72576e5 * t810 * t2603 + 0.36288e5 * t2610 * t815;
  t2623 = t2081 * t211;
  t2628 = t1446 * t1447 * t519;
  t2631 = t500 * t158;
  t2633 = t1450 * t2631 * t212;
  t2637 = t1450 * t1451 * t575;
  t2641 = t1444 * t508 * t158;
  t2642 = t2641 * t1506;
  t2646 = t584 * params->ax * t1509;
  t2649 = t519 * t202;
  t2650 = t2649 * t583;
  t2651 = t1504 * t2650;
  t2654 = t32 * t574;
  t2655 = t2654 * t583;
  t2656 = t1504 * t2655;
  t2659 = 0.1e1 / t470;
  t2661 = t2659 * t153 * t158;
  t2662 = 0.1e1 / t77;
  t2663 = t2662 * t202;
  t2664 = t583 * params->b_PBE;
  t2665 = t2663 * t2664;
  t2666 = t2661 * t2665;
  t2667 = t145 * t843;
  t2669 = t847 * t6;
  t2670 = t2669 * t800;
  t2671 = t2667 * t69 * t2670;
  t2674 = t1505 * t1492;
  t2675 = t1504 * t2674;
  t2677 = t145 * params->ax * t4;
  t2678 = t15 * t23;
  t2679 = t12 * t597;
  t2680 = t2678 * t2679;
  t2681 = t2677 * t2680;
  t2686 = t1446 * t1447 * t32 * t23;
  t2687 = t158 * t202;
  t2688 = t2687 * t598;
  t2689 = t396 * t2688;
  t2693 = t2659 * params->b_PBE * t843;
  t2694 = t69 * t847;
  t2697 = t2693 * t2694 * t2662 * t6;
  t2700 = t202 * t1120;
  t2701 = t2700 * t1121;
  t2705 = t513 * t202;
  t2706 = t1489 * t2705;
  t2709 = t159 * t574;
  t2710 = t1489 * t2709;
  t2713 = t811 * t1145;
  t2717 = t2631 * t43;
  t2721 = t1451 * t17;
  t2725 = t1484 * t597;
  t2729 = -0.216e3 * t802 * t803 * t2623 - 0.27e2 / 0.2e1 * t2628 * t1453 - 0.27e2 * t1449 * t2633 - 0.27e2 * t1449 * t2637 + 0.12096e5 * t2642 * t1510 + 0.12096e5 * t1507 * t2646 + 0.6048e4 * t2651 * t1510 + 0.12096e5 * t2656 * t1510 + 0.336e3 * t2666 * t2671 - 0.24192e5 * t2675 * t2681 + 0.27e2 * t2686 * t2689 - 0.3e1 / 0.4e1 * t2697 * t1453 - 0.162e3 * t1471 * t1472 * t2701 - 0.193536e6 * t2706 * t1495 - 0.145152e6 * t2710 * t1495 + 0.81e2 * t1471 * t1472 * t2713 + 0.162e3 * t1471 * t2717 * t1473 + 0.216e3 * t1471 * t2721 * t1473 + 0.162e3 * t1471 * t1472 * t2725;
  tv3rho2sigma0 = my_piecewise3(t1, 0, t2622 + t2729);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2731 = t706 * t1544;
  t2734 = t808 * t220;
  t2735 = t323 * t2734;
  t2741 = t2536 * t377;
  t2746 = t1283 * t224 * t12;
  t2747 = t830 * t2746;
  t2754 = t1404 * t780;
  t2755 = t2754 * params->b_PBE;
  t2756 = t2755 * t832;
  t2759 = t1549 * t1563;
  t2762 = t2529 * t377;
  t2766 = t1292 * t827;
  t2773 = t1284 * t158;
  t2780 = t2540 * t377;
  t2785 = t1446 * t1447 * t716;
  t2789 = t781 * params->ax * t1573;
  t2793 = t1444 * t705 * t158;
  t2794 = t2793 * t1570;
  t2797 = 0.96768e5 * t2731 * t833 + 0.16128e5 * t2735 * t833 - 0.216e3 * t821 * t1522 * t1526 - 0.36e2 * t821 * t822 * t2741 + 0.36288e5 * t828 * t2747 + 0.96768e5 * t1545 * t1550 + 0.96768e5 * t1545 * t1564 + 0.36288e5 * t828 * t2756 + 0.72576e5 * t828 * t2759 - 0.81e2 * t821 * t822 * t2762 + 0.36288e5 * t2766 * t833 + 0.72576e5 * t1541 * t1550 + 0.72576e5 * t1541 * t1564 - 0.81e2 * t821 * t2773 * t823 - 0.162e3 * t821 * t1522 * t1530 - 0.216e3 * t821 * t822 * t2780 - 0.27e2 / 0.2e1 * t2785 * t1519 + 0.12096e5 * t1571 * t2789 + 0.12096e5 * t2794 * t1574;
  t2798 = t716 * t368;
  t2799 = t2798 * t780;
  t2800 = t1568 * t2799;
  t2803 = t227 * t772;
  t2804 = t2803 * t780;
  t2805 = t1568 * t2804;
  t2808 = t697 * t158;
  t2810 = t1516 * t2808 * t378;
  t2814 = t1516 * t1517 * t773;
  t2818 = t2659 * t322 * t158;
  t2819 = 0.1e1 / t256;
  t2820 = t2819 * t368;
  t2821 = t780 * params->b_PBE;
  t2822 = t2820 * t2821;
  t2823 = t2818 * t2822;
  t2824 = t314 * t843;
  t2826 = t2669 * t819;
  t2827 = t2824 * t69 * t2826;
  t2830 = t1569 * t1556;
  t2831 = t1568 * t2830;
  t2833 = t314 * params->ax * t4;
  t2834 = t15 * t224;
  t2835 = t12 * t793;
  t2836 = t2834 * t2835;
  t2837 = t2833 * t2836;
  t2842 = t1446 * t1447 * t227 * t224;
  t2843 = t158 * t368;
  t2844 = t2843 * t794;
  t2845 = t607 * t2844;
  t2850 = t2693 * t2694 * t2819 * t6;
  t2853 = t710 * t368;
  t2854 = t1553 * t2853;
  t2857 = t829 * t1437;
  t2861 = t2808 * t233;
  t2865 = t1517 * t218;
  t2869 = t1548 * t793;
  t2873 = t2483 * params->b_PBE;
  t2874 = t2873 * t314;
  t2875 = t819 * t1415;
  t2876 = t2874 * t2875;
  t2879 = t368 * t1414;
  t2880 = t2879 * t1415;
  t2884 = t325 * t772;
  t2885 = t1553 * t2884;
  t2888 = t1556 * t697;
  t2889 = t2888 * t1558;
  t2892 = t819 * t1437;
  t2893 = t1557 * t2892;
  t2896 = t706 * t28;
  t2897 = t2896 * t1554;
  t2900 = 0.6048e4 * t2800 * t1574 + 0.12096e5 * t2805 * t1574 - 0.27e2 * t1515 * t2810 - 0.27e2 * t1515 * t2814 + 0.336e3 * t2823 * t2827 - 0.24192e5 * t2831 * t2837 + 0.27e2 * t2842 * t2845 - 0.3e1 / 0.4e1 * t2850 * t1519 - 0.193536e6 * t2854 * t1559 + 0.81e2 * t1535 * t1536 * t2857 + 0.162e3 * t1535 * t2861 * t1537 + 0.216e3 * t1535 * t2865 * t1537 + 0.162e3 * t1535 * t1536 * t2869 + 0.217728e6 * t1555 * t2876 - 0.162e3 * t1535 * t1536 * t2880 - 0.145152e6 * t2885 * t1559 - 0.145152e6 * t1555 * t2889 - 0.72576e5 * t1555 * t2893 - 0.145152e6 * t2897 * t1559;
  tv3rho2sigma8 = my_piecewise3(t217, 0, t2797 + t2900);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t2902 = t1444 * t1578;
  t2903 = t2902 * t1580;
  t2904 = t1581 * t27;
  t2905 = t2904 * t1586;
  t2906 = t2903 * t2905;
  t2908 = t5 * t6 * t15;
  t2912 = t811 * t500;
  t2924 = t1586 * t43;
  t2925 = t2700 * t597;
  t2929 = t509 * t1490;
  t2932 = t154 * t2705;
  t2935 = t154 * t2709;
  t2938 = t2018 * t1578;
  t2939 = t2938 * t1585;
  t2941 = t2939 * t1582 * t597;
  t2944 = t1592 * t145;
  t2946 = t2944 * t1582 * t500;
  t2949 = t1505 * t1592;
  t2950 = t1504 * t2949;
  t2951 = t1594 * t2908;
  t2954 = 0.139968e6 * t1584 * t1586 * t1017 * t583 + 0.104976e6 * t1584 * t1586 * t1115 * t583 + 0.209952e6 * t1584 * t1472 * t2912 + 0.11664e5 * t2906 * t1506 * t2908 - 0.209952e6 * t1584 * t2924 * t2925 + 0.141087744e9 * t1591 * t2941 - 0.94058496e8 * t1591 * t2946 - 0.47029248e8 * t2929 * t1595 - 0.62705664e8 * t2932 * t1595 - 0.47029248e8 * t2935 * t1595 - 0.5225472e7 * t2950 * t2951;
  tv3rhosigma20 = my_piecewise3(t1, 0, t2954);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t2955 = t2902 * t1599;
  t2956 = t2904 * t1604;
  t2957 = t2955 * t2956;
  t2961 = t829 * t697;
  t2973 = t1604 * t233;
  t2974 = t2879 * t793;
  t2978 = t706 * t1554;
  t2981 = t323 * t2853;
  t2984 = t323 * t2884;
  t2987 = t2483 * t1578;
  t2988 = t2987 * t1603;
  t2990 = t2988 * t1600 * t793;
  t2993 = t1610 * t314;
  t2995 = t2993 * t1600 * t697;
  t2998 = t1569 * t1610;
  t2999 = t1568 * t2998;
  t3000 = t1612 * t2908;
  t3003 = 0.139968e6 * t1602 * t1604 * t1310 * t780 + 0.104976e6 * t1602 * t1604 * t1409 * t780 + 0.209952e6 * t1602 * t1536 * t2961 + 0.11664e5 * t2957 * t1570 * t2908 - 0.209952e6 * t1602 * t2973 * t2974 + 0.141087744e9 * t1609 * t2990 - 0.94058496e8 * t1609 * t2995 - 0.47029248e8 * t2978 * t1613 - 0.62705664e8 * t2981 * t1613 - 0.47029248e8 * t2984 * t1613 - 0.5225472e7 * t2999 * t3000;
  tv3rhosigma211 = my_piecewise3(t217, 0, t3003);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t3004 = t1578 * params->b_PBE;
  t3005 = t3 * t3004;
  t3006 = t1580 * t23;
  t3007 = t3006 * t27;
  t3008 = t1585 * t145;
  t3010 = t3005 * t3007 * t3008;
  t3011 = t2700 * t6;
  t3015 = t2018 * t3004;
  t3018 = t3015 * t3008 * t3006 * t6;
  tv3sigma30 = my_piecewise3(t1, 0, -0.136048896e9 * t3010 * t159 * t3011 + 0.60949905408e11 * t1591 * t3018);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t3022 = t1599 * t224;
  t3023 = t3022 * t27;
  t3024 = t1603 * t314;
  t3026 = t3005 * t3023 * t3024;
  t3027 = t2879 * t6;
  t3031 = t2483 * t3004;
  t3034 = t3031 * t3024 * t3022 * t6;
  tv3sigma39 = my_piecewise3(t217, 0, -0.136048896e9 * t3026 * t325 * t3027 + 0.60949905408e11 * t1609 * t3034);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t18, t19, t23, t25, t26, t27, t28;
  double t29, t31, t32, t34, t37, t38, t39, t40;
  double t41, t42, t43, t44, t46, t49, t51, t52;
  double t53, t54, t55, t58, t59, t60, t61, t69;
  double t71, t72, t73, t75, t76, t77, t79, t82;
  double t87, t93, t94, t98, t99, t101, t102, t103;
  double t104, t106, t110, t114, t116, t117, t118, t123;
  double t124, t129, t138, t139, t142, t145, t146, t150;
  double t152, t153, t154, t155, t158, t159, t160, t161;
  double t162, t163, t164, t165, t166, t169, t171, t177;
  double t178, t179, t182, t183, t184, t187, t190, t194;
  double t196, t197, t202, t203, t206, t210, t211, t212;
  double t213, t216, t217, t218, t219, t220, t224, t226;
  double t227, t231, t232, t233, t234, t238, t240, t243;
  double t244, t252, t253, t255, t256, t273, t274, t275;
  double t277, t281, t285, t287, t292, t297, t305, t308;
  double t311, t314, t315, t319, t321, t322, t323, t324;
  double t325, t326, t327, t328, t329, t330, t331, t332;
  double t335, t337, t343, t344, t345, t348, t349, t350;
  double t353, t356, t360, t362, t368, t369, t372, t376;
  double t377, t378, t379, t382, tzk0;

  double t390, t391, t392, t394, t395, t396, t400, t402;
  double t404, t406, t408, t409, t410, t411, t416, t421;
  double t424, t443, t448, t455, t456, t457, t458, t459;
  double t460, t461, t470, t471, t472, t473, t474, t476;
  double t481, t482, t486, t494, t496, t500, t501, t506;
  double t508, t509, t510, t513, t514, t517, t518, t519;
  double t523, t524, t527, t528, t531, t534, t543, t547;
  double t548, t552, t553, t554, t556, t558, t561, t562;
  double t563, t567, t574, t575, t576, t579, t580, t581;
  double t582, t583, t584, t588, t589, t592, t593, t597;
  double t598, t599, tvrho0, t603, t604, t606, t607, t611;
  double t613, t615, t617, t619, t620, t621, t622, t630;
  double t633, t651, t652, t657, t664, t665, t666, t667;
  double t677, t678, t691, t693, t697, t698, t703, t705;
  double t706, t707, t710, t711, t714, t715, t716, t720;
  double t721, t724, t725, t728, t731, t740, t744, t745;
  double t749, t750, t751, t753, t755, t758, t759, t760;
  double t764, t772, t773, t774, t777, t778, t779, t780;
  double t781, t785, t788, t789, t793, t794, t795, tvrho1;
  double t799, t800, t802, t803, t804, t808, t809, t810;
  double t811, t812, t814, t815, tvsigma0, tvsigma1, t819, t821;
  double t822, t823, t827, t828, t829, t830, t832, t833;
  double tvsigma2;

  double t837, t839, t843, t845, t847, t849, t850, t852;
  double t854, t858, t862, t864, t866, t868, t870, t874;
  double t875, t876, t879, t883, t888, t891, t907, t911;
  double t916, t923, t929, t930, t934, t935, t937, t940;
  double t944, t945, t946, t947, t948, t956, t957, t961;
  double t965, t966, t967, t971, t984, t986, t990, t991;
  double t996, t998, t999, t1000, t1007, t1010, t1011, t1014;
  double t1017, t1018, t1021, t1025, t1029, t1030, t1056, t1059;
  double t1063, t1064, t1070, t1071, t1073, t1074, t1077, t1079;
  double t1082, t1085, t1086, t1087, t1090, t1094, t1095, t1109;
  double t1110, t1111, t1112, t1115, t1116, t1120, t1121, t1122;
  double t1123, t1126, t1130, t1134, t1137, t1138, t1139, t1141;
  double t1145, t1146, t1147, t1150, tv2rho20, tv2rho21, t1151, t1153;
  double t1157, t1159, t1161, t1165, t1169, t1171, t1173, t1175;
  double t1177, t1181, t1182, t1183, t1189, t1194, t1212, t1215;
  double t1221, t1228, t1234, t1235, t1239, t1240, t1242, t1255;
  double t1258, t1259, t1277, t1279, t1283, t1284, t1289, t1291;
  double t1292, t1293, t1300, t1303, t1304, t1307, t1310, t1311;
  double t1314, t1318, t1322, t1323, t1349, t1352, t1356, t1357;
  double t1363, t1364, t1366, t1367, t1370, t1372, t1375, t1378;
  double t1379, t1380, t1383, t1387, t1388, t1403, t1404, t1405;
  double t1406, t1409, t1410, t1414, t1415, t1416, t1417, t1420;
  double t1424, t1428, t1431, t1433, t1437, t1438, t1439, t1442;
  double tv2rho22, t1444, t1446, t1447, t1449, t1450, t1451, t1453;
  double t1456, t1460, t1464, t1470, t1471, t1472, t1473, t1477;
  double t1480, t1481, t1484, t1485, t1486, t1489, t1490, t1491;
  double t1492, t1493, t1494, t1495, t1499, t1500, t1504, t1505;
  double t1506, t1507, t1509, t1510, t1513, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2;
  double tv2rhosigma3, tv2rhosigma4, t1515, t1516, t1517, t1519, t1522, t1526;
  double t1530, t1535, t1536, t1537, t1541, t1544, t1545, t1548;
  double t1549, t1550, t1553, t1554, t1555, t1556, t1557, t1558;
  double t1559, t1563, t1564, t1568, t1569, t1570, t1571, t1573;
  double t1574, t1577, tv2rhosigma5, t1578, t1579, t1580, t1581, t1582;
  double t1584, t1585, t1586, t1587, t1591, t1592, t1593, t1594;
  double t1595, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1599, t1600;
  double t1602, t1603, t1604, t1605, t1609, t1610, t1611, t1612;
  double t1613, tv2sigma25;

  double t1617, t1618, t1619, t1625, t1626, t1639, t1643, t1674;
  double t1677, t1680, t1686, t1687, t1695, t1699, t1700, t1701;
  double t1702, t1705, t1710, t1712, t1713, t1715, t1716, t1718;
  double t1720, t1722, t1732, t1740, t1742, t1743, t1749, t1752;
  double t1757, t1760, t1763, t1766, t1768, t1769, t1770, t1773;
  double t1776, t1785, t1786, t1794, t1796, t1800, t1802, t1804;
  double t1811, t1813, t1814, t1815, t1816, t1817, t1818, t1820;
  double t1821, t1822, t1823, t1829, t1833, t1837, t1839, t1841;
  double t1844, t1849, t1850, t1851, t1852, t1855, t1858, t1859;
  double t1863, t1873, t1887, t1888, t1891, t1894, t1896, t1914;
  double t1919, t1926, t1934, t1935, t1944, t1946, t1947, t1948;
  double t1959, t1963, t1968, t1977, t1992, t1994, t2000, t2003;
  double t2004, t2005, t2010, t2013, t2014, t2017, t2018, t2019;
  double t2020, t2021, t2024, t2027, t2030, t2033, t2037, t2042;
  double t2046, t2050, t2054, t2055, t2058, t2062, t2063, t2064;
  double t2067, t2068, t2071, t2074, t2077, t2078, t2081, t2082;
  double t2089, t2094, tv3rho30, tv3rho31, tv3rho32, t2096, t2097, t2098;
  double t2105, t2108, t2116, t2118, t2122, t2124, t2126, t2133;
  double t2134, t2136, t2137, t2138, t2139, t2145, t2149, t2153;
  double t2155, t2157, t2160, t2165, t2166, t2167, t2168, t2171;
  double t2177, t2187, t2205, t2206, t2209, t2212, t2214, t2220;
  double t2221, t2243, t2248, t2268, t2270, t2276, t2282, t2296;
  double t2302, t2306, t2307, t2308, t2313, t2316, t2317, t2322;
  double t2323, t2329, t2330, t2337, t2347, t2378, t2381, t2384;
  double t2390, t2391, t2399, t2403, t2404, t2405, t2406, t2409;
  double t2414, t2416, t2417, t2419, t2421, t2422, t2424, t2428;
  double t2433, t2448, t2451, t2456, t2459, t2462, t2465, t2467;
  double t2468, t2471, t2473, t2474, t2475, t2478, t2481, t2482;
  double t2483, t2484, t2485, t2486, t2491, t2494, t2498, t2503;
  double t2507, t2511, t2514, t2517, t2521, t2522, t2523, t2526;
  double t2529, t2530, t2533, t2536, t2537, t2540, t2541, t2548;
  double t2553, tv3rho33, t2555, t2556, t2557, t2558, t2561, t2562;
  double t2565, t2566, t2569, t2570, t2573, t2574, t2577, t2580;
  double t2588, t2589, t2598, t2599, t2600, t2603, t2606, t2610;
  double t2615, t2622, t2623, t2628, t2631, t2633, t2637, t2641;
  double t2642, t2646, t2649, t2650, t2651, t2654, t2655, t2656;
  double t2659, t2661, t2662, t2663, t2664, t2665, t2666, t2667;
  double t2669, t2670, t2671, t2674, t2675, t2677, t2678, t2679;
  double t2680, t2681, t2686, t2687, t2688, t2689, t2693, t2694;
  double t2697, t2700, t2701, t2705, t2706, t2709, t2710, t2713;
  double t2717, t2721, t2725, t2729, tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2, tv3rho2sigma3;
  double tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7, t2731, t2734, t2735, t2741;
  double t2746, t2747, t2754, t2755, t2756, t2759, t2762, t2766;
  double t2773, t2780, t2785, t2789, t2793, t2794, t2797, t2798;
  double t2799, t2800, t2803, t2804, t2805, t2808, t2810, t2814;
  double t2818, t2819, t2820, t2821, t2822, t2823, t2824, t2826;
  double t2827, t2830, t2831, t2833, t2834, t2835, t2836, t2837;
  double t2842, t2843, t2844, t2845, t2850, t2853, t2854, t2857;
  double t2861, t2865, t2869, t2873, t2874, t2875, t2876, t2879;
  double t2880, t2884, t2885, t2888, t2889, t2892, t2893, t2896;
  double t2897, t2900, tv3rho2sigma8, t2902, t2903, t2904, t2905, t2906;
  double t2908, t2912, t2924, t2925, t2929, t2932, t2935, t2938;
  double t2939, t2941, t2944, t2946, t2949, t2950, t2951, t2954;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2955, t2956, t2957, t2961, t2973;
  double t2974, t2978, t2981, t2984, t2987, t2988, t2990, t2993;
  double t2995, t2998, t2999, t3000, t3003, tv3rhosigma211, t3004, t3005;
  double t3006, t3007, t3008, t3010, t3011, t3015, t3018, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t3022, t3023, t3024, t3026, t3027, t3031, t3034, tv3sigma39;

  double t3055, t3057, t3081, t3086, t3087, t3092, t3139, t3172;
  double t3173, t3175, t3179, t3182, t3192, t3194, t3195, t3197;
  double t3199, t3203, t3206, t3218, t3233, t3240, t3260, t3266;
  double t3288, t3290, t3296, t3303, t3312, t3313, t3324, t3326;
  double t3327, t3328, t3329, t3330, t3332, t3350, t3354, t3376;
  double t3382, t3391, t3392, t3407, t3443, t3451, t3473, t3478;
  double t3485, t3514, t3515, t3516, t3552, t3566, t3581, t3583;
  double t3589, t3591, t3606, t3641, t3642, t3647, t3649, t3683;
  double t3684, t3688, t3692, t3729, t3737, t3750, t3764, tv4rho40;
  double tv4rho41, tv4rho42, tv4rho43, t3796, t3803, t3812, t3813, t3825;
  double t3843, t3847, t3869, t3875, t3884, t3899, t3960, t4019;
  double t4024, t4035, t4061, t4063, t4069, t4071, t4078, t4088;
  double t4090, t4095, t4096, t4103, t4125, t4172, t4205, t4206;
  double t4208, t4210, t4213, t4231, t4233, t4256, t4258, t4262;
  double t4276, t4281, t4283, t4285, t4287, t4291, t4294, t4322;
  double t4324, t4342, t4343, t4348, t4358, t4405, t4414, t4433;
  double t4437, t4440, t4465, t4472, tv4rho44, t4510, t4554, t4577;
  double t4594, t4606, t4610, t4627, t4640, t4651, t4659, t4677;
  double t4679, t4680, t4686, t4701, t4706, t4767, t4785, t4818;
  double t4865, tv4rho3sigma0, tv4rho3sigma1, tv4rho3sigma2, tv4rho3sigma3, tv4rho3sigma4, tv4rho3sigma5, tv4rho3sigma6;
  double tv4rho3sigma7, tv4rho3sigma8, tv4rho3sigma9, tv4rho3sigma10, t4869, t4884, t4914, t4918;
  double t4932, t4963, t5003, t5040, t5044, t5060, t5081, t5098;
  double t5155, t5201, t5225, t5253, tv4rho3sigma11, t5270, t5291, t5348;
  double t5358, t5409, t5416, t5429, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, tv4rho2sigma25, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t5436, t5526, t5551;
  double t5599, tv4rho2sigma217, t5601, t5608, t5639, t5656, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t5692, t5709, tv4rhosigma319, t5710, t5711, t5712, t5714;
  double tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47;
  double tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t5730, t5732;
  double tv4sigma414;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRTPI;
  t3 = 0.1e1 / t2;
  t4 = p->hyb_omega[0] * p->hyb_omega[0];
  t5 = params->ax * t4;
  t6 = M_CBRT3;
  t7 = t5 * t6;
  t8 = t2 * M_PI;
  t9 = 0.1e1 / t8;
  t10 = 0.2e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = M_CBRT2;
  t13 = my_piecewise3(t10, t11, t12);
  t14 = t13 * t13;
  t15 = 0.1e1 / t14;
  t16 = t9 * t15;
  t17 = POW_1_3(rho[0]);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t23 = exp(-t7 * t16 * t19 / 0.12e2);
  t25 = params->b_PBE * t23 * sigma[0];
  t26 = t6 * t12;
  t27 = params->kappa + 0.1e1;
  t28 = t6 * t6;
  t29 = t2 * t2;
  t31 = t28 / t29;
  t32 = 0.1e1 / t17;
  t34 = 0.1e1 / t13;
  t37 = t31 * p->hyb_omega[0] * t32 * t34 / 0.6e1;
  t38 = t37 < 0.5e-1;
  t39 = t14 * t14;
  t40 = M_PI * M_PI;
  t41 = t29 * t40;
  t42 = t39 * t41;
  t43 = t17 * rho[0];
  t44 = t42 * t43;
  t46 = t14 * t8;
  t49 = t46 * t6 * t18 * t4;
  t51 = 0.7e1 * t44 - 0.6e1 * t49;
  t52 = t14 * t13;
  t53 = 0.1e1 / p->hyb_omega[0];
  t54 = t53 * t6;
  t55 = t29 * t13;
  t58 = erf(t54 * t55 * t17);
  t59 = t52 * t58;
  t60 = sqrt(M_PI);
  t61 = t60 * t40;
  t69 = t4 * t4;
  t71 = 0.6e1 * t28 * t69;
  t72 = -0.36e2 * t59 * t61 * t28 * rho[0] * p->hyb_omega[0] + 0.81e2 * t44 + 0.54e2 * t49 - t71;
  t73 = 0.1e1 / t72;
  t75 = 0.1e11 < t37;
  t76 = t40 * t40;
  t77 = rho[0] * rho[0];
  t79 = t39 * t14;
  t82 = t8 * t28;
  t87 = t41 * t6;
  t93 = t69 * t4;
  t94 = 0.1e1 / t93;
  t98 = 0.1e1 / t4;
  t99 = t98 * t28;
  t101 = t99 * t46 * t18;
  t102 = exp(t101);
  t103 = t102 * t6;
  t104 = t103 * t14;
  t106 = t8 * t18 * t4;
  t110 = t102 * t28;
  t114 = (0.7e1 * t104 * t106 - 0.6e1 * t110 * t69 + 0.6e1 * t44 + 0.11e2 * t49 + t71) * t8;
  t116 = t14 * t6;
  t117 = t39 * t102;
  t118 = t41 * t28;
  t123 = t52 * t102 * t58;
  t124 = t61 * t6;
  t129 = t14 * t102;
  t138 = 0.2e1 * t69 * t6;
  t139 = 0.12e2 * t123 * t124 * rho[0] * p->hyb_omega[0] - 0.9e1 * t117 * t118 * t43 + 0.12e2 * t46 * t18 * t4 + 0.2e1 * t103 * t69 - 0.18e2 * t129 * t106 - t138;
  t142 = t116 * t98 / t139;
  t145 = my_piecewise5(t38, t51 * t73, t75, (0.28e4 * t82 * t18 * t69 * t14 - 0.14e3 * t87 * t43 * t4 * t39 - 0.1863e4 * t76 * t77 * t79) * t94 / 0.504e5, -t114 * t18 * t142 / 0.9e1);
  t146 = t27 * t145;
  t150 = t18 * t77;
  t152 = params->kappa * t150 * t8;
  t153 = 0.27e2 / 0.56e2 * t25 * t26 * t146 + t152;
  t154 = t3 * t153;
  t155 = t154 * t6;
  t158 = my_piecewise3(t10, t11 * p->zeta_threshold, 0.2e1 * t12);
  t159 = t158 * t43;
  t160 = 0.135e1 <= t37;
  t161 = 0.135e1 < t37;
  t162 = my_piecewise3(t161, t37, 0.135e1);
  t163 = t162 * t162;
  t164 = t163 * t163;
  t165 = t164 * t163;
  t166 = t164 * t164;
  t169 = t166 * t164;
  t171 = t166 * t163;
  t177 = 0.240888840192e14 * t166 * t165 + 0.19448e5 * t163 - 0.80784e6 * t164 + 0.3055104e8 * t165 - 0.104552448e10 * t166 - 0.90333315072e12 * t169 + 0.3226189824e11 * t171 - 0.429e3;
  t178 = t166 * t166;
  t179 = 0.1e1 / t178;
  t182 = my_piecewise3(t161, 0.135e1, t37);
  t183 = t182 * t182;
  t184 = t183 * t183;
  t187 = 0.32e2 * t184 - 0.16e2 * t183;
  t190 = exp(-0.1e1 / t183 / 0.4e1);
  t194 = 0.1e1 / t182;
  t196 = erf(t194 / 0.2e1);
  t197 = t60 * t196;
  t202 = my_piecewise3(t160, t177 * t179 / 0.8671998246912e15, t187 * t190 / 0.3e1 - 0.32e2 / 0.3e1 * t184 - 0.8e1 / 0.3e1 * t197 * t182 + 0.8e1 * t183 + 0.1e1);
  t203 = params->b_PBE * t145;
  t206 = sigma[0] * t12 * t6;
  t210 = 0.216e3 * t203 * t23 * t206 + 0.448e3 * t152;
  t211 = 0.1e1 / t210;
  t212 = t202 * t211;
  t213 = t159 * t212;
  t216 = my_piecewise3(t1, 0, -0.168e3 * t155 * t213);
  t217 = rho[1] <= p->dens_threshold;
  t218 = POW_1_3(rho[1]);
  t219 = t218 * t218;
  t220 = 0.1e1 / t219;
  t224 = exp(-t7 * t16 * t220 / 0.12e2);
  t226 = params->b_PBE * t224 * sigma[2];
  t227 = 0.1e1 / t218;
  t231 = t31 * p->hyb_omega[0] * t227 * t34 / 0.6e1;
  t232 = t231 < 0.5e-1;
  t233 = t218 * rho[1];
  t234 = t42 * t233;
  t238 = t46 * t6 * t219 * t4;
  t240 = 0.7e1 * t234 - 0.6e1 * t238;
  t243 = erf(t54 * t55 * t218);
  t244 = t52 * t243;
  t252 = -0.36e2 * t244 * t61 * t28 * rho[1] * p->hyb_omega[0] + 0.81e2 * t234 + 0.54e2 * t238 - t71;
  t253 = 0.1e1 / t252;
  t255 = 0.1e11 < t231;
  t256 = rho[1] * rho[1];
  t273 = t99 * t46 * t219;
  t274 = exp(t273);
  t275 = t274 * t219;
  t277 = t46 * t4;
  t281 = t274 * t28;
  t285 = (0.7e1 * t275 * t6 * t277 - 0.6e1 * t281 * t69 + 0.6e1 * t234 + 0.11e2 * t238 + t71) * t8;
  t287 = t39 * t274;
  t292 = t52 * t274 * t243;
  t297 = t14 * t274;
  t305 = t274 * t6;
  t308 = 0.12e2 * t292 * t124 * rho[1] * p->hyb_omega[0] - 0.18e2 * t297 * t8 * t219 * t4 - 0.9e1 * t287 * t118 * t233 + 0.12e2 * t46 * t219 * t4 + 0.2e1 * t305 * t69 - t138;
  t311 = t116 * t98 / t308;
  t314 = my_piecewise5(t232, t240 * t253, t255, (0.28e4 * t82 * t219 * t69 * t14 - 0.14e3 * t87 * t233 * t4 * t39 - 0.1863e4 * t76 * t256 * t79) * t94 / 0.504e5, -t285 * t219 * t311 / 0.9e1);
  t315 = t27 * t314;
  t319 = t219 * t256;
  t321 = params->kappa * t319 * t8;
  t322 = 0.27e2 / 0.56e2 * t226 * t26 * t315 + t321;
  t323 = t3 * t322;
  t324 = t323 * t6;
  t325 = t158 * t233;
  t326 = 0.135e1 <= t231;
  t327 = 0.135e1 < t231;
  t328 = my_piecewise3(t327, t231, 0.135e1);
  t329 = t328 * t328;
  t330 = t329 * t329;
  t331 = t330 * t329;
  t332 = t330 * t330;
  t335 = t332 * t330;
  t337 = t332 * t329;
  t343 = 0.240888840192e14 * t332 * t331 + 0.19448e5 * t329 - 0.80784e6 * t330 + 0.3055104e8 * t331 - 0.104552448e10 * t332 - 0.90333315072e12 * t335 + 0.3226189824e11 * t337 - 0.429e3;
  t344 = t332 * t332;
  t345 = 0.1e1 / t344;
  t348 = my_piecewise3(t327, 0.135e1, t231);
  t349 = t348 * t348;
  t350 = t349 * t349;
  t353 = 0.32e2 * t350 - 0.16e2 * t349;
  t356 = exp(-0.1e1 / t349 / 0.4e1);
  t360 = 0.1e1 / t348;
  t362 = erf(t360 / 0.2e1);
  t368 = my_piecewise3(t326, t343 * t345 / 0.8671998246912e15, t353 * t356 / 0.3e1 - 0.32e2 / 0.3e1 * t350 - 0.8e1 / 0.3e1 * t362 * t348 * t60 + 0.8e1 * t349 + 0.1e1);
  t369 = params->b_PBE * t314;
  t372 = sigma[2] * t12 * t6;
  t376 = 0.216e3 * t369 * t224 * t372 + 0.448e3 * t321;
  t377 = 0.1e1 / t376;
  t378 = t368 * t377;
  t379 = t325 * t378;
  t382 = my_piecewise3(t217, 0, -0.168e3 * t324 * t379);
  tzk0 = (t216 + t382) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t390 = params->b_PBE * params->ax * t4 * t28 * t9 * t15;
  t391 = t18 * rho[0];
  t392 = 0.1e1 / t391;
  t394 = t392 * t23 * sigma[0];
  t395 = t12 * t27;
  t396 = t395 * t145;
  t400 = t42 * t17;
  t402 = t6 * t32;
  t404 = t46 * t402 * t4;
  t406 = 0.28e2 / 0.3e1 * t400 - 0.4e1 * t404;
  t408 = t72 * t72;
  t409 = 0.1e1 / t408;
  t410 = t51 * t409;
  t411 = exp(-t101);
  t416 = t61 * t28 * p->hyb_omega[0];
  t421 = -0.72e2 * t42 * t411 * t17 - 0.36e2 * t59 * t416 + 0.108e3 * t400 + 0.36e2 * t404;
  t424 = t76 * rho[0];
  t443 = t8 * t32 * t4;
  t448 = (0.8e1 * t400 + 0.14e2 * t42 * t17 * t102 - 0.22e2 / 0.3e1 * t104 * t443 + 0.22e2 / 0.3e1 * t404) * t8;
  t455 = t18 * t14;
  t456 = t114 * t455;
  t457 = t6 * t98;
  t458 = t139 * t139;
  t459 = 0.1e1 / t458;
  t460 = t79 * t98;
  t461 = t460 * t6;
  t470 = t40 * M_PI;
  t471 = pow(M_PI, 0.1e1 / 0.6e1);
  t472 = t471 * t471;
  t473 = t472 * t472;
  t474 = t473 * t471;
  t476 = t39 * t13 * t53 * t474 * t470;
  t481 = t117 * t41;
  t482 = t411 * t28;
  t486 = t124 * p->hyb_omega[0];
  t494 = 0.24e2 * t476 * t18 * t102 * t58 - 0.18e2 * t461 * t424 * t102 - 0.24e2 * t117 * t118 * t17 + 0.8e1 * t481 * t482 * t17 + 0.8e1 * t46 * t32 * t4 + 0.12e2 * t123 * t486 - 0.8e1 * t129 * t443;
  t496 = t457 * t459 * t494;
  t500 = my_piecewise5(t38, t406 * t73 - t410 * t421, t75, (-0.3726e4 * t424 * t79 + 0.56e4 / 0.3e1 * t82 * t32 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t17 * t4 * t39) * t94 / 0.504e5, -t448 * t18 * t142 / 0.9e1 - 0.2e1 / 0.27e2 * t114 * t32 * t142 + t456 * t496 / 0.9e1);
  t501 = t27 * t500;
  t506 = params->kappa * t391 * t8;
  t508 = 0.3e1 / 0.112e3 * t390 * t394 * t396 + 0.27e2 / 0.56e2 * t25 * t26 * t501 + 0.8e1 / 0.3e1 * t506;
  t509 = t3 * t508;
  t510 = t509 * t6;
  t513 = t158 * t17;
  t514 = t513 * t212;
  t517 = t164 * t162;
  t518 = t166 * t517;
  t519 = 0.1e1 / t43;
  t523 = t31 * p->hyb_omega[0] * t519 * t34 / 0.18e2;
  t524 = my_piecewise3(t161, -t523, 0);
  t527 = t163 * t162;
  t528 = t166 * t527;
  t531 = t166 * t162;
  t534 = t164 * t527;
  t543 = 0.38896e5 * t162 * t524 + 0.18330624e9 * t517 * t524 + 0.3372443762688e15 * t518 * t524 - 0.323136e7 * t527 * t524 - 0.1083999780864e14 * t528 * t524 + 0.3226189824e12 * t531 * t524 - 0.836419584e10 * t534 * t524;
  t547 = 0.1e1 / t178 / t162;
  t548 = t177 * t547;
  t552 = t183 * t182;
  t553 = my_piecewise3(t161, 0, -t523);
  t554 = t552 * t553;
  t556 = t182 * t553;
  t558 = 0.128e3 * t554 - 0.32e2 * t556;
  t561 = 0.1e1 / t552;
  t562 = t187 * t561;
  t563 = t553 * t190;
  t567 = t190 * t194;
  t574 = my_piecewise3(t160, t543 * t179 / 0.8671998246912e15 - t548 * t524 / 0.541999890432e14, t558 * t190 / 0.3e1 + t562 * t563 / 0.6e1 - 0.128e3 / 0.3e1 * t554 + 0.8e1 / 0.3e1 * t567 * t553 - 0.8e1 / 0.3e1 * t197 * t553 + 0.16e2 * t556);
  t575 = t574 * t211;
  t576 = t159 * t575;
  t579 = t6 * t158;
  t580 = t154 * t579;
  t581 = t43 * t202;
  t582 = t210 * t210;
  t583 = 0.1e1 / t582;
  t584 = params->b_PBE * t500;
  t588 = t5 * t28;
  t589 = t203 * t588;
  t592 = t23 * sigma[0] * t12;
  t593 = t16 * t392 * t592;
  t597 = 0.216e3 * t584 * t23 * t206 + 0.12e2 * t589 * t593 + 0.3584e4 / 0.3e1 * t506;
  t598 = t583 * t597;
  t599 = t581 * t598;
  tvrho0 = my_piecewise3(t1, 0, -0.224e3 * t155 * t514 - 0.168e3 * t155 * t576 - 0.168e3 * t510 * t213 + 0.168e3 * t580 * t599);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t603 = t219 * rho[1];
  t604 = 0.1e1 / t603;
  t606 = t604 * t224 * sigma[2];
  t607 = t395 * t314;
  t611 = t42 * t218;
  t613 = t6 * t227;
  t615 = t46 * t613 * t4;
  t617 = 0.28e2 / 0.3e1 * t611 - 0.4e1 * t615;
  t619 = t252 * t252;
  t620 = 0.1e1 / t619;
  t621 = t240 * t620;
  t622 = exp(-t273);
  t630 = -0.72e2 * t42 * t622 * t218 - 0.36e2 * t244 * t416 + 0.108e3 * t611 + 0.36e2 * t615;
  t633 = t76 * rho[1];
  t651 = t274 * t227;
  t652 = t651 * t6;
  t657 = (0.8e1 * t611 + 0.14e2 * t42 * t218 * t274 - 0.22e2 / 0.3e1 * t652 * t277 + 0.22e2 / 0.3e1 * t615) * t8;
  t664 = t219 * t14;
  t665 = t285 * t664;
  t666 = t308 * t308;
  t667 = 0.1e1 / t666;
  t677 = t287 * t41;
  t678 = t622 * t28;
  t691 = -0.8e1 * t297 * t8 * t227 * t4 - 0.24e2 * t287 * t118 * t218 + 0.8e1 * t677 * t678 * t218 + 0.8e1 * t46 * t227 * t4 + 0.24e2 * t476 * t275 * t243 - 0.18e2 * t461 * t633 * t274 + 0.12e2 * t292 * t486;
  t693 = t457 * t667 * t691;
  t697 = my_piecewise5(t232, t617 * t253 - t621 * t630, t255, (-0.3726e4 * t633 * t79 + 0.56e4 / 0.3e1 * t82 * t227 * t69 * t14 - 0.56e3 / 0.3e1 * t87 * t218 * t4 * t39) * t94 / 0.504e5, -t657 * t219 * t311 / 0.9e1 - 0.2e1 / 0.27e2 * t285 * t227 * t311 + t665 * t693 / 0.9e1);
  t698 = t27 * t697;
  t703 = params->kappa * t603 * t8;
  t705 = 0.3e1 / 0.112e3 * t390 * t606 * t607 + 0.27e2 / 0.56e2 * t226 * t26 * t698 + 0.8e1 / 0.3e1 * t703;
  t706 = t3 * t705;
  t707 = t706 * t6;
  t710 = t158 * t218;
  t711 = t710 * t378;
  t714 = t330 * t328;
  t715 = t332 * t714;
  t716 = 0.1e1 / t233;
  t720 = t31 * p->hyb_omega[0] * t716 * t34 / 0.18e2;
  t721 = my_piecewise3(t327, -t720, 0);
  t724 = t329 * t328;
  t725 = t332 * t724;
  t728 = t332 * t328;
  t731 = t330 * t724;
  t740 = 0.38896e5 * t328 * t721 + 0.18330624e9 * t714 * t721 + 0.3372443762688e15 * t715 * t721 - 0.323136e7 * t724 * t721 - 0.1083999780864e14 * t725 * t721 + 0.3226189824e12 * t728 * t721 - 0.836419584e10 * t731 * t721;
  t744 = 0.1e1 / t344 / t328;
  t745 = t343 * t744;
  t749 = t349 * t348;
  t750 = my_piecewise3(t327, 0, -t720);
  t751 = t749 * t750;
  t753 = t348 * t750;
  t755 = 0.128e3 * t751 - 0.32e2 * t753;
  t758 = 0.1e1 / t749;
  t759 = t353 * t758;
  t760 = t750 * t356;
  t764 = t356 * t360;
  t772 = my_piecewise3(t326, t740 * t345 / 0.8671998246912e15 - t745 * t721 / 0.541999890432e14, t755 * t356 / 0.3e1 + t759 * t760 / 0.6e1 - 0.128e3 / 0.3e1 * t751 + 0.8e1 / 0.3e1 * t764 * t750 - 0.8e1 / 0.3e1 * t362 * t750 * t60 + 0.16e2 * t753);
  t773 = t772 * t377;
  t774 = t325 * t773;
  t777 = t323 * t579;
  t778 = t233 * t368;
  t779 = t376 * t376;
  t780 = 0.1e1 / t779;
  t781 = params->b_PBE * t697;
  t785 = t369 * t588;
  t788 = t224 * sigma[2] * t12;
  t789 = t16 * t604 * t788;
  t793 = 0.216e3 * t781 * t224 * t372 + 0.12e2 * t785 * t789 + 0.3584e4 / 0.3e1 * t703;
  t794 = t780 * t793;
  t795 = t778 * t794;
  tvrho1 = my_piecewise3(t217, 0, -0.224e3 * t324 * t711 - 0.168e3 * t324 * t774 - 0.168e3 * t707 * t379 + 0.168e3 * t777 * t795);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t799 = t3 * params->b_PBE;
  t800 = t23 * t12;
  t802 = t799 * t800 * t28;
  t803 = t146 * t158;
  t804 = t581 * t211;
  t808 = t28 * t158;
  t809 = t808 * t43;
  t810 = t154 * t809;
  t811 = t202 * t583;
  t812 = t811 * params->b_PBE;
  t814 = t145 * t23 * t12;
  t815 = t812 * t814;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t802 * t803 * t804 + 0.36288e5 * t810 * t815);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t819 = t224 * t12;
  t821 = t799 * t819 * t28;
  t822 = t315 * t158;
  t823 = t778 * t377;
  t827 = t808 * t233;
  t828 = t323 * t827;
  t829 = t368 * t780;
  t830 = t829 * params->b_PBE;
  t832 = t314 * t224 * t12;
  t833 = t830 * t832;
  tvsigma2 = my_piecewise3(t217, 0, -0.81e2 * t821 * t822 * t823 + 0.36288e5 * t828 * t833);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t837 = 0.1e1 / t150;
  t839 = t837 * t23 * sigma[0];
  t843 = params->ax * params->ax;
  t845 = 0.1e1 / t41;
  t847 = 0.1e1 / t39;
  t849 = params->b_PBE * t843 * t69 * t845 * t847;
  t850 = t77 * rho[0];
  t852 = 0.1e1 / t17 / t850;
  t854 = t852 * t23 * sigma[0];
  t858 = t395 * t500;
  t862 = t42 * t19;
  t864 = t6 * t519;
  t866 = t46 * t864 * t4;
  t868 = 0.28e2 / 0.9e1 * t862 + 0.4e1 / 0.3e1 * t866;
  t870 = t406 * t409;
  t874 = 0.1e1 / t408 / t72;
  t875 = t51 * t874;
  t876 = t421 * t421;
  t879 = t76 * t79;
  t883 = t411 * t19;
  t888 = 0.48e2 * t879 * t99 * t411 - 0.96e2 * t42 * t883 + 0.36e2 * t862 - 0.12e2 * t866;
  t891 = 0.3726e4 * t879;
  t907 = t99 * t102;
  t911 = t8 * t519 * t4;
  t916 = (0.8e1 / 0.3e1 * t862 - 0.1e2 * t42 * t19 * t102 + 0.28e2 / 0.3e1 * t879 * t907 + 0.22e2 / 0.9e1 * t104 * t911 - 0.22e2 / 0.9e1 * t866) * t8;
  t923 = t448 * t455;
  t929 = t32 * t14;
  t930 = t114 * t929;
  t934 = 0.1e1 / t458 / t139;
  t935 = t494 * t494;
  t937 = t457 * t934 * t935;
  t940 = t6 * t76;
  t944 = t39 * t39;
  t945 = 0.1e1 / t69;
  t946 = t944 * t945;
  t947 = t76 * M_PI;
  t948 = t2 * t947;
  t956 = t32 * t102;
  t957 = t956 * t58;
  t961 = t4 * p->hyb_omega[0];
  t965 = t39 * t52 / t961 * t471 * t947;
  t966 = t17 * t28;
  t967 = t102 * t58;
  t971 = t460 * t76;
  t984 = -0.66e2 * t460 * t940 * t102 - 0.36e2 * t946 * t948 * t18 * t102 - 0.4e2 / 0.3e1 * t117 * t118 * t19 + 0.4e2 * t476 * t957 + 0.16e2 * t965 * t966 * t967 + 0.16e2 * t971 * t102 * t411 * t6 + 0.32e2 / 0.3e1 * t481 * t482 * t19 + 0.8e1 / 0.3e1 * t129 * t911 - 0.8e1 / 0.3e1 * t46 * t519 * t4;
  t986 = t457 * t459 * t984;
  t990 = my_piecewise5(t38, -t410 * t888 - 0.2e1 * t870 * t421 + t868 * t73 + 0.2e1 * t875 * t876, t75, (-t891 - 0.56e4 / 0.9e1 * t82 * t519 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t19 * t4 * t39) * t94 / 0.504e5, -t916 * t18 * t142 / 0.9e1 - 0.4e1 / 0.27e2 * t448 * t32 * t142 + 0.2e1 / 0.9e1 * t923 * t496 + 0.2e1 / 0.81e2 * t114 * t519 * t142 + 0.4e1 / 0.27e2 * t930 * t496 - 0.2e1 / 0.9e1 * t456 * t937 + t456 * t986 / 0.9e1);
  t991 = t27 * t990;
  t996 = params->kappa * t18 * t8;
  t998 = -0.5e1 / 0.112e3 * t390 * t839 * t396 + t849 * t854 * t396 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t394 * t858 + 0.27e2 / 0.56e2 * t25 * t26 * t991 + 0.4e2 / 0.9e1 * t996;
  t999 = t3 * t998;
  t1000 = t999 * t6;
  t1007 = t509 * t579;
  t1010 = t158 * t19;
  t1011 = t1010 * t212;
  t1014 = t513 * t575;
  t1017 = t17 * t202;
  t1018 = t1017 * t598;
  t1021 = t524 * t524;
  t1025 = 0.1e1 / t17 / t77;
  t1029 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1025 * t34;
  t1030 = my_piecewise3(t161, t1029, 0);
  t1056 = -0.969408e7 * t163 * t1021 + 0.9165312e9 * t164 * t1021 - 0.5854937088e11 * t165 * t1021 + 0.29035708416e13 * t166 * t1021 + 0.43841768914944e16 * t169 * t1021 - 0.11923997589504e15 * t171 * t1021 + 0.38896e5 * t162 * t1030 + 0.18330624e9 * t517 * t1030 + 0.3372443762688e15 * t518 * t1030 - 0.323136e7 * t527 * t1030 - 0.1083999780864e14 * t528 * t1030 + 0.3226189824e12 * t531 * t1030 - 0.836419584e10 * t534 * t1030 + 0.38896e5 * t1021;
  t1059 = t543 * t547;
  t1063 = 0.1e1 / t178 / t163;
  t1064 = t177 * t1063;
  t1070 = t553 * t553;
  t1071 = t183 * t1070;
  t1073 = my_piecewise3(t161, 0, t1029);
  t1074 = t552 * t1073;
  t1077 = t182 * t1073;
  t1079 = 0.384e3 * t1071 + 0.128e3 * t1074 - 0.32e2 * t1070 - 0.32e2 * t1077;
  t1082 = t558 * t561;
  t1085 = 0.1e1 / t184;
  t1086 = t187 * t1085;
  t1087 = t1070 * t190;
  t1090 = t1073 * t190;
  t1094 = 0.1e1 / t184 / t183;
  t1095 = t187 * t1094;
  t1109 = t1079 * t190 / 0.3e1 + t1082 * t563 / 0.3e1 - t1086 * t1087 / 0.2e1 + t562 * t1090 / 0.6e1 + t1095 * t1087 / 0.12e2 - 0.128e3 * t1071 - 0.128e3 / 0.3e1 * t1074 + 0.4e1 / 0.3e1 * t1085 * t1070 * t190 + 0.8e1 / 0.3e1 * t567 * t1073 - 0.8e1 / 0.3e1 * t197 * t1073 + 0.16e2 * t1070 + 0.16e2 * t1077;
  t1110 = my_piecewise3(t160, t1056 * t179 / 0.8671998246912e15 - t1059 * t524 / 0.270999945216e14 + t1064 * t1021 / 0.31882346496e13 - t548 * t1030 / 0.541999890432e14, t1109);
  t1111 = t1110 * t211;
  t1112 = t159 * t1111;
  t1115 = t43 * t574;
  t1116 = t1115 * t598;
  t1120 = 0.1e1 / t582 / t210;
  t1121 = t597 * t597;
  t1122 = t1120 * t1121;
  t1123 = t581 * t1122;
  t1126 = params->b_PBE * t990;
  t1130 = t584 * t588;
  t1134 = t16 * t837 * t592;
  t1137 = t843 * t69;
  t1138 = t1137 * t845;
  t1139 = t203 * t1138;
  t1141 = t847 * t852 * t592;
  t1145 = 0.216e3 * t1126 * t23 * t206 + 0.24e2 * t1130 * t593 - 0.2e2 * t589 * t1134 + 0.2e1 * t1139 * t1141 + 0.1792e5 / 0.9e1 * t996;
  t1146 = t583 * t1145;
  t1147 = t581 * t1146;
  t1150 = -0.168e3 * t1000 * t213 - 0.448e3 * t510 * t514 - 0.336e3 * t510 * t576 + 0.336e3 * t1007 * t599 - 0.224e3 / 0.3e1 * t155 * t1011 - 0.448e3 * t155 * t1014 + 0.448e3 * t580 * t1018 - 0.168e3 * t155 * t1112 + 0.336e3 * t580 * t1116 - 0.336e3 * t580 * t1123 + 0.168e3 * t580 * t1147;
  tv2rho20 = my_piecewise3(t1, 0, t1150);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t1151 = 0.1e1 / t319;
  t1153 = t1151 * t224 * sigma[2];
  t1157 = t256 * rho[1];
  t1159 = 0.1e1 / t218 / t1157;
  t1161 = t1159 * t224 * sigma[2];
  t1165 = t395 * t697;
  t1169 = t42 * t220;
  t1171 = t6 * t716;
  t1173 = t46 * t1171 * t4;
  t1175 = 0.28e2 / 0.9e1 * t1169 + 0.4e1 / 0.3e1 * t1173;
  t1177 = t617 * t620;
  t1181 = 0.1e1 / t619 / t252;
  t1182 = t240 * t1181;
  t1183 = t630 * t630;
  t1189 = t622 * t220;
  t1194 = 0.48e2 * t879 * t99 * t622 - 0.96e2 * t42 * t1189 + 0.36e2 * t1169 - 0.12e2 * t1173;
  t1212 = t99 * t274;
  t1215 = t274 * t716;
  t1221 = (0.8e1 / 0.3e1 * t1169 - 0.1e2 * t42 * t220 * t274 + 0.28e2 / 0.3e1 * t879 * t1212 + 0.22e2 / 0.9e1 * t1215 * t6 * t277 - 0.22e2 / 0.9e1 * t1173) * t8;
  t1228 = t657 * t664;
  t1234 = t227 * t14;
  t1235 = t285 * t1234;
  t1239 = 0.1e1 / t666 / t308;
  t1240 = t691 * t691;
  t1242 = t457 * t1239 * t1240;
  t1255 = t651 * t243;
  t1258 = t218 * t28;
  t1259 = t274 * t243;
  t1277 = -0.66e2 * t460 * t940 * t274 - 0.36e2 * t946 * t948 * t219 * t274 - 0.4e2 / 0.3e1 * t287 * t118 * t220 + 0.4e2 * t476 * t1255 + 0.16e2 * t965 * t1258 * t1259 + 0.16e2 * t971 * t274 * t622 * t6 + 0.32e2 / 0.3e1 * t677 * t678 * t220 + 0.8e1 / 0.3e1 * t297 * t8 * t716 * t4 - 0.8e1 / 0.3e1 * t46 * t716 * t4;
  t1279 = t457 * t667 * t1277;
  t1283 = my_piecewise5(t232, t1175 * t253 - 0.2e1 * t1177 * t630 + 0.2e1 * t1182 * t1183 - t621 * t1194, t255, (-t891 - 0.56e4 / 0.9e1 * t82 * t716 * t69 * t14 - 0.56e3 / 0.9e1 * t87 * t220 * t4 * t39) * t94 / 0.504e5, -t1221 * t219 * t311 / 0.9e1 - 0.4e1 / 0.27e2 * t657 * t227 * t311 + 0.2e1 / 0.9e1 * t1228 * t693 + 0.2e1 / 0.81e2 * t285 * t716 * t311 + 0.4e1 / 0.27e2 * t1235 * t693 - 0.2e1 / 0.9e1 * t665 * t1242 + t665 * t1279 / 0.9e1);
  t1284 = t27 * t1283;
  t1289 = params->kappa * t219 * t8;
  t1291 = -0.5e1 / 0.112e3 * t390 * t1153 * t607 + t849 * t1161 * t607 / 0.224e3 + 0.3e1 / 0.56e2 * t390 * t606 * t1165 + 0.27e2 / 0.56e2 * t226 * t26 * t1284 + 0.4e2 / 0.9e1 * t1289;
  t1292 = t3 * t1291;
  t1293 = t1292 * t6;
  t1300 = t706 * t579;
  t1303 = t158 * t220;
  t1304 = t1303 * t378;
  t1307 = t710 * t773;
  t1310 = t218 * t368;
  t1311 = t1310 * t794;
  t1314 = t721 * t721;
  t1318 = 0.1e1 / t218 / t256;
  t1322 = 0.2e1 / 0.27e2 * t31 * p->hyb_omega[0] * t1318 * t34;
  t1323 = my_piecewise3(t327, t1322, 0);
  t1349 = -0.969408e7 * t329 * t1314 + 0.9165312e9 * t330 * t1314 - 0.5854937088e11 * t331 * t1314 + 0.29035708416e13 * t332 * t1314 + 0.43841768914944e16 * t335 * t1314 - 0.11923997589504e15 * t337 * t1314 + 0.38896e5 * t328 * t1323 + 0.18330624e9 * t714 * t1323 + 0.3372443762688e15 * t715 * t1323 - 0.323136e7 * t724 * t1323 - 0.1083999780864e14 * t725 * t1323 + 0.3226189824e12 * t728 * t1323 - 0.836419584e10 * t731 * t1323 + 0.38896e5 * t1314;
  t1352 = t740 * t744;
  t1356 = 0.1e1 / t344 / t329;
  t1357 = t343 * t1356;
  t1363 = t750 * t750;
  t1364 = t349 * t1363;
  t1366 = my_piecewise3(t327, 0, t1322);
  t1367 = t749 * t1366;
  t1370 = t348 * t1366;
  t1372 = 0.384e3 * t1364 + 0.128e3 * t1367 - 0.32e2 * t1363 - 0.32e2 * t1370;
  t1375 = t755 * t758;
  t1378 = 0.1e1 / t350;
  t1379 = t353 * t1378;
  t1380 = t1363 * t356;
  t1383 = t1366 * t356;
  t1387 = 0.1e1 / t350 / t349;
  t1388 = t353 * t1387;
  t1403 = t1372 * t356 / 0.3e1 + t1375 * t760 / 0.3e1 - t1379 * t1380 / 0.2e1 + t759 * t1383 / 0.6e1 + t1388 * t1380 / 0.12e2 - 0.128e3 * t1364 - 0.128e3 / 0.3e1 * t1367 + 0.4e1 / 0.3e1 * t1378 * t1363 * t356 + 0.8e1 / 0.3e1 * t764 * t1366 - 0.8e1 / 0.3e1 * t362 * t1366 * t60 + 0.16e2 * t1363 + 0.16e2 * t1370;
  t1404 = my_piecewise3(t326, t1349 * t345 / 0.8671998246912e15 - t1352 * t721 / 0.270999945216e14 + t1357 * t1314 / 0.31882346496e13 - t745 * t1323 / 0.541999890432e14, t1403);
  t1405 = t1404 * t377;
  t1406 = t325 * t1405;
  t1409 = t233 * t772;
  t1410 = t1409 * t794;
  t1414 = 0.1e1 / t779 / t376;
  t1415 = t793 * t793;
  t1416 = t1414 * t1415;
  t1417 = t778 * t1416;
  t1420 = params->b_PBE * t1283;
  t1424 = t781 * t588;
  t1428 = t16 * t1151 * t788;
  t1431 = t369 * t1138;
  t1433 = t847 * t1159 * t788;
  t1437 = 0.216e3 * t1420 * t224 * t372 + 0.24e2 * t1424 * t789 - 0.2e2 * t785 * t1428 + 0.2e1 * t1431 * t1433 + 0.1792e5 / 0.9e1 * t1289;
  t1438 = t780 * t1437;
  t1439 = t778 * t1438;
  t1442 = -0.168e3 * t1293 * t379 - 0.448e3 * t707 * t711 - 0.336e3 * t707 * t774 + 0.336e3 * t1300 * t795 - 0.224e3 / 0.3e1 * t324 * t1304 - 0.448e3 * t324 * t1307 + 0.448e3 * t777 * t1311 - 0.168e3 * t324 * t1406 + 0.336e3 * t777 * t1410 - 0.336e3 * t777 * t1417 + 0.168e3 * t777 * t1439;
  tv2rho22 = my_piecewise3(t217, 0, t1442);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t1444 = 0.1e1 / t29 / M_PI;
  t1446 = t1444 * params->b_PBE * params->ax;
  t1447 = t4 * t15;
  t1449 = t1446 * t1447 * t32;
  t1450 = t800 * t27;
  t1451 = t145 * t158;
  t1453 = t1450 * t1451 * t212;
  t1456 = t501 * t158;
  t1460 = t1017 * t211;
  t1464 = t1115 * t211;
  t1470 = t12 * t28 * t27;
  t1471 = t799 * t23 * t1470;
  t1472 = t1451 * t43;
  t1473 = t811 * t597;
  t1477 = t509 * t809;
  t1480 = t808 * t17;
  t1481 = t154 * t1480;
  t1484 = t574 * t583;
  t1485 = t1484 * params->b_PBE;
  t1486 = t1485 * t814;
  t1489 = t154 * t28;
  t1490 = t159 * t202;
  t1491 = t1489 * t1490;
  t1492 = t1120 * params->b_PBE;
  t1493 = t1492 * t145;
  t1494 = t800 * t597;
  t1495 = t1493 * t1494;
  t1499 = t500 * t23 * t12;
  t1500 = t812 * t1499;
  t1504 = t1444 * t153 * t158;
  t1505 = t32 * t202;
  t1506 = t1505 * t583;
  t1507 = t1504 * t1506;
  t1509 = t1447 * t800;
  t1510 = t203 * params->ax * t1509;
  t1513 = -0.27e2 / 0.2e1 * t1449 * t1453 - 0.81e2 * t802 * t1456 * t804 - 0.108e3 * t802 * t803 * t1460 - 0.81e2 * t802 * t803 * t1464 + 0.81e2 * t1471 * t1472 * t1473 + 0.36288e5 * t1477 * t815 + 0.48384e5 * t1481 * t815 + 0.36288e5 * t810 * t1486 - 0.72576e5 * t1491 * t1495 + 0.36288e5 * t810 * t1500 + 0.6048e4 * t1507 * t1510;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1513);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t1515 = t1446 * t1447 * t227;
  t1516 = t819 * t27;
  t1517 = t314 * t158;
  t1519 = t1516 * t1517 * t378;
  t1522 = t698 * t158;
  t1526 = t1310 * t377;
  t1530 = t1409 * t377;
  t1535 = t799 * t224 * t1470;
  t1536 = t1517 * t233;
  t1537 = t829 * t793;
  t1541 = t706 * t827;
  t1544 = t808 * t218;
  t1545 = t323 * t1544;
  t1548 = t772 * t780;
  t1549 = t1548 * params->b_PBE;
  t1550 = t1549 * t832;
  t1553 = t323 * t28;
  t1554 = t325 * t368;
  t1555 = t1553 * t1554;
  t1556 = t1414 * params->b_PBE;
  t1557 = t1556 * t314;
  t1558 = t819 * t793;
  t1559 = t1557 * t1558;
  t1563 = t697 * t224 * t12;
  t1564 = t830 * t1563;
  t1568 = t1444 * t322 * t158;
  t1569 = t227 * t368;
  t1570 = t1569 * t780;
  t1571 = t1568 * t1570;
  t1573 = t1447 * t819;
  t1574 = t369 * params->ax * t1573;
  t1577 = -0.27e2 / 0.2e1 * t1515 * t1519 - 0.81e2 * t821 * t1522 * t823 - 0.108e3 * t821 * t822 * t1526 - 0.81e2 * t821 * t822 * t1530 + 0.81e2 * t1535 * t1536 * t1537 + 0.36288e5 * t1541 * t833 + 0.48384e5 * t1545 * t833 + 0.36288e5 * t828 * t1550 - 0.72576e5 * t1555 * t1559 + 0.36288e5 * t828 * t1564 + 0.6048e4 * t1571 * t1574;
  tv2rhosigma5 = my_piecewise3(t217, 0, t1577);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  t1578 = params->b_PBE * params->b_PBE;
  t1579 = t3 * t1578;
  t1580 = t23 * t23;
  t1581 = t12 * t12;
  t1582 = t1580 * t1581;
  t1584 = t1579 * t1582 * t27;
  t1585 = t145 * t145;
  t1586 = t1585 * t158;
  t1587 = t581 * t583;
  t1591 = t154 * t1490;
  t1592 = t1120 * t1578;
  t1593 = t1585 * t1580;
  t1594 = t1593 * t1581;
  t1595 = t1592 * t1594;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1584 * t1586 * t1587 - 0.47029248e8 * t1591 * t1595);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t1599 = t224 * t224;
  t1600 = t1599 * t1581;
  t1602 = t1579 * t1600 * t27;
  t1603 = t314 * t314;
  t1604 = t1603 * t158;
  t1605 = t778 * t780;
  t1609 = t323 * t1554;
  t1610 = t1414 * t1578;
  t1611 = t1603 * t1599;
  t1612 = t1611 * t1581;
  t1613 = t1610 * t1612;
  tv2sigma25 = my_piecewise3(t217, 0, 0.104976e6 * t1602 * t1604 * t1605 - 0.47029248e8 * t1609 * t1613);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t1617 = t1120 * t597;
  t1618 = t1617 * t1145;
  t1619 = t581 * t1618;
  t1625 = 0.14e2 / 0.81e2 * t31 * p->hyb_omega[0] * t852 * t34;
  t1626 = my_piecewise3(t161, -t1625, 0);
  t1639 = t524 * t1030;
  t1643 = t1021 * t524;
  t1674 = -0.2908224e8 * t163 * t524 * t1030 + 0.27495936e10 * t164 * t524 * t1030 - 0.17564811264e12 * t165 * t524 * t1030 + 0.87107125248e13 * t166 * t524 * t1030 + 0.131525306744832e17 * t169 * t524 * t1030 - 0.35771992768512e15 * t171 * t524 * t1030 + 0.38896e5 * t162 * t1626 - 0.1938816e8 * t162 * t1643 + 0.18330624e9 * t517 * t1626 + 0.3372443762688e15 * t518 * t1626 - 0.323136e7 * t527 * t1626 - 0.1083999780864e14 * t528 * t1626 + 0.3226189824e12 * t531 * t1626 - 0.836419584e10 * t534 * t1626 - 0.35129622528e12 * t517 * t1643 + 0.36661248e10 * t527 * t1643 + 0.526101226979328e17 * t528 * t1643 - 0.11923997589504e16 * t531 * t1643 + 0.232285667328e14 * t534 * t1643 + 0.116688e6 * t1639;
  t1677 = t1056 * t547;
  t1680 = t543 * t1063;
  t1686 = 0.1e1 / t178 / t527;
  t1687 = t177 * t1686;
  t1695 = t558 * t1085;
  t1699 = 0.1e1 / t184 / t182;
  t1700 = t187 * t1699;
  t1701 = t1070 * t553;
  t1702 = t1701 * t190;
  t1705 = t563 * t1073;
  t1710 = t182 * t1701;
  t1712 = t183 * t553;
  t1713 = t1712 * t1073;
  t1715 = my_piecewise3(t161, 0, -t1625);
  t1716 = t552 * t1715;
  t1718 = t553 * t1073;
  t1720 = t182 * t1715;
  t1722 = 0.768e3 * t1710 + 0.1152e4 * t1713 + 0.128e3 * t1716 - 0.96e2 * t1718 - 0.32e2 * t1720;
  t1732 = 0.1e1 / t184 / t552;
  t1740 = t184 * t184;
  t1742 = 0.1e1 / t1740 / t182;
  t1743 = t187 * t1742;
  t1749 = t1085 * t553;
  t1752 = t1079 * t561;
  t1757 = t558 * t1094;
  t1760 = t187 * t1732;
  t1763 = t1715 * t190;
  t1766 = 0.2e1 / 0.3e1 * t1732 * t1701 * t190 + 0.8e1 / 0.3e1 * t567 * t1715 - 0.8e1 / 0.3e1 * t197 * t1715 + t1743 * t1702 / 0.24e2 - 0.16e2 / 0.3e1 * t1699 * t1701 * t190 + 0.4e1 * t1749 * t1090 + t1752 * t563 / 0.2e1 + t1082 * t1090 / 0.2e1 + t1757 * t1087 / 0.4e1 - 0.3e1 / 0.4e1 * t1760 * t1702 + t562 * t1763 / 0.6e1;
  t1768 = my_piecewise3(t160, t1674 * t179 / 0.8671998246912e15 - t1677 * t524 / 0.180666630144e14 + t1680 * t1021 / 0.10627448832e13 - t1059 * t1030 / 0.180666630144e14 - t1687 * t1643 / 0.1771241472e12 + t1064 * t1639 / 0.10627448832e13 - t548 * t1626 / 0.541999890432e14, -0.3e1 / 0.2e1 * t1695 * t1087 + 0.2e1 * t1700 * t1702 - 0.3e1 / 0.2e1 * t1086 * t1705 + t1095 * t1705 / 0.4e1 + t1722 * t190 / 0.3e1 - 0.128e3 / 0.3e1 * t1716 + 0.48e2 * t1718 + 0.16e2 * t1720 - 0.256e3 * t1710 - 0.384e3 * t1713 + t1766);
  t1769 = t1768 * t211;
  t1770 = t159 * t1769;
  t1773 = t1010 * t575;
  t1776 = t513 * t1111;
  t1785 = t158 * t392;
  t1786 = t1785 * t212;
  t1794 = 0.1e1 / t18 / t850;
  t1796 = t1794 * t23 * sigma[0];
  t1800 = t77 * t77;
  t1802 = 0.1e1 / t17 / t1800;
  t1804 = t1802 * t23 * sigma[0];
  t1811 = t843 * params->ax;
  t1813 = params->b_PBE * t1811 * t93;
  t1814 = 0.1e1 / t76;
  t1815 = 0.1e1 / t79;
  t1816 = t1814 * t1815;
  t1817 = t1800 * rho[0];
  t1818 = 0.1e1 / t1817;
  t1820 = t1813 * t1816 * t1818;
  t1821 = t6 * t23;
  t1822 = t1821 * sigma[0];
  t1823 = t1822 * t396;
  t1829 = t395 * t990;
  t1833 = t42 * t392;
  t1837 = t46 * t6 * t1025 * t4;
  t1839 = -0.56e2 / 0.27e2 * t1833 - 0.16e2 / 0.9e1 * t1837;
  t1841 = t868 * t409;
  t1844 = t406 * t874;
  t1849 = t408 * t408;
  t1850 = 0.1e1 / t1849;
  t1851 = t51 * t1850;
  t1852 = t876 * t421;
  t1855 = t421 * t888;
  t1858 = t944 * t948;
  t1859 = t1858 * t945;
  t1863 = 0.1e1 / rho[0];
  t1873 = 0.64e2 * t971 * t28 * t1863 * t411 - 0.96e2 * t1859 * t402 * t411 + 0.64e2 * t42 * t411 * t392 - 0.24e2 * t1833 + 0.16e2 * t1837;
  t1887 = t458 * t458;
  t1888 = 0.1e1 / t1887;
  t1891 = t457 * t1888 * t935 * t494;
  t1894 = t934 * t494;
  t1896 = t457 * t1894 * t984;
  t1914 = t8 * t1025 * t4;
  t1919 = (-0.16e2 / 0.9e1 * t1833 + 0.104e3 / 0.9e1 * t42 * t392 * t102 - 0.2e2 / 0.3e1 * t879 * t1863 * t907 + 0.56e2 / 0.3e1 * t1859 * t402 * t102 - 0.88e2 / 0.27e2 * t104 * t1914 + 0.88e2 / 0.27e2 * t1837) * t8;
  t1926 = t448 * t929;
  t1934 = t519 * t14;
  t1935 = t114 * t1934;
  t1944 = t944 * t14;
  t1946 = t76 * t40;
  t1947 = t29 * t1946;
  t1948 = t1944 * t94 * t1947;
  t1959 = t519 * t102;
  t1963 = t19 * t28;
  t1968 = t411 * t6;
  t1977 = t944 * t13 / t69 / p->hyb_omega[0] * t60 * t1946;
  t1992 = -0.156e3 * t946 * t948 * t32 * t102 - 0.24e2 * t1948 * t966 * t102 - 0.8e2 / 0.3e1 * t461 * t76 * t1863 * t102 + 0.32e2 / 0.3e1 * t117 * t118 * t392 - 0.4e2 / 0.3e1 * t476 * t1959 * t58 + 0.32e2 * t965 * t1963 * t967 + 0.8e2 / 0.3e1 * t971 * t1863 * t102 * t1968 + 0.32e2 * t1977 * t103 * t58 + 0.32e2 * t1859 * t956 * t411 - 0.64e2 / 0.9e1 * t481 * t482 * t392 - 0.32e2 / 0.9e1 * t129 * t1914 + 0.32e2 / 0.9e1 * t46 * t1025 * t4;
  t1994 = t457 * t459 * t1992;
  t2000 = t916 * t455;
  t2003 = 0.2e1 / 0.3e1 * t456 * t1891 - 0.2e1 / 0.3e1 * t456 * t1896 - 0.2e1 / 0.3e1 * t923 * t937 - 0.4e1 / 0.9e1 * t930 * t937 - t1919 * t18 * t142 / 0.9e1 + 0.2e1 / 0.27e2 * t448 * t519 * t142 + 0.4e1 / 0.9e1 * t1926 * t496 + t923 * t986 / 0.3e1 - 0.8e1 / 0.243e3 * t114 * t1025 * t142 - 0.2e1 / 0.27e2 * t1935 * t496 + 0.2e1 / 0.9e1 * t930 * t986 + t456 * t1994 / 0.9e1 - 0.2e1 / 0.9e1 * t916 * t32 * t142 + t2000 * t496 / 0.3e1;
  t2004 = my_piecewise5(t38, t1839 * t73 - 0.3e1 * t1841 * t421 + 0.6e1 * t1844 * t876 - 0.6e1 * t1851 * t1852 + 0.6e1 * t875 * t1855 - t410 * t1873 - 0.3e1 * t870 * t888, t75, (0.224e5 / 0.27e2 * t82 * t1025 * t69 * t14 + 0.112e4 / 0.27e2 * t87 * t392 * t4 * t39) * t94 / 0.504e5, t2003);
  t2005 = t27 * t2004;
  t2010 = params->kappa * t32 * t8;
  t2013 = t3 * (0.5e1 / 0.42e2 * t390 * t1796 * t396 - 0.5e1 / 0.224e3 * t849 * t1804 * t396 - 0.15e2 / 0.112e3 * t390 * t839 * t858 + t1820 * t1823 / 0.4032e4 + 0.3e1 / 0.224e3 * t849 * t854 * t858 + 0.9e1 / 0.112e3 * t390 * t394 * t1829 + 0.27e2 / 0.56e2 * t25 * t26 * t2005 + 0.8e2 / 0.27e2 * t2010);
  t2014 = t2013 * t6;
  t2017 = t582 * t582;
  t2018 = 0.1e1 / t2017;
  t2019 = t1121 * t597;
  t2020 = t2018 * t2019;
  t2021 = t581 * t2020;
  t2024 = -0.1008e4 * t580 * t1619 - 0.168e3 * t155 * t1770 - 0.224e3 * t155 * t1773 - 0.672e3 * t155 * t1776 - 0.504e3 * t510 * t1112 - 0.1344e4 * t510 * t1014 - 0.504e3 * t1000 * t576 + 0.448e3 / 0.9e1 * t155 * t1786 - 0.672e3 * t1000 * t514 - 0.224e3 * t510 * t1011 - 0.168e3 * t2014 * t213 + 0.1008e4 * t580 * t2021;
  t2027 = t1017 * t1122;
  t2030 = t1115 * t1122;
  t2033 = params->b_PBE * t2004;
  t2037 = t1126 * t588;
  t2042 = t584 * t1138;
  t2046 = t16 * t1794 * t592;
  t2050 = t847 * t1802 * t592;
  t2054 = t1811 * t93 * t1814;
  t2055 = t203 * t2054;
  t2058 = t1815 * t1818 * t6 * t592;
  t2062 = 0.216e3 * t2033 * t23 * t206 + 0.36e2 * t2037 * t593 - 0.6e2 * t1130 * t1134 + 0.6e1 * t2042 * t1141 + 0.16e3 / 0.3e1 * t589 * t2046 - 0.1e2 * t1139 * t2050 + t2055 * t2058 / 0.9e1 + 0.3584e5 / 0.27e2 * t2010;
  t2063 = t583 * t2062;
  t2064 = t581 * t2063;
  t2067 = t43 * t1110;
  t2068 = t2067 * t598;
  t2071 = t1115 * t1146;
  t2074 = t1017 * t1146;
  t2077 = t19 * t202;
  t2078 = t2077 * t598;
  t2081 = t17 * t574;
  t2082 = t2081 * t598;
  t2089 = t999 * t579;
  t2094 = 0.1344e4 * t1007 * t1018 + 0.1008e4 * t1007 * t1116 - 0.1008e4 * t1007 * t1123 + 0.504e3 * t1007 * t1147 - 0.1344e4 * t580 * t2027 - 0.1008e4 * t580 * t2030 + 0.168e3 * t580 * t2064 + 0.504e3 * t580 * t2068 + 0.504e3 * t580 * t2071 + 0.672e3 * t580 * t2074 + 0.224e3 * t580 * t2078 + 0.1344e4 * t580 * t2082 + 0.504e3 * t2089 * t599;
  tv3rho30 = my_piecewise3(t1, 0, t2024 + t2094);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  tv3rho31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  tv3rho32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t2096 = t1414 * t793;
  t2097 = t2096 * t1437;
  t2098 = t778 * t2097;
  t2105 = t1303 * t773;
  t2108 = t710 * t1405;
  t2116 = 0.1e1 / t219 / t1157;
  t2118 = t2116 * t224 * sigma[2];
  t2122 = t256 * t256;
  t2124 = 0.1e1 / t218 / t2122;
  t2126 = t2124 * t224 * sigma[2];
  t2133 = t2122 * rho[1];
  t2134 = 0.1e1 / t2133;
  t2136 = t1813 * t1816 * t2134;
  t2137 = t6 * t224;
  t2138 = t2137 * sigma[2];
  t2139 = t2138 * t607;
  t2145 = t395 * t1283;
  t2149 = t42 * t604;
  t2153 = t46 * t6 * t1318 * t4;
  t2155 = -0.56e2 / 0.27e2 * t2149 - 0.16e2 / 0.9e1 * t2153;
  t2157 = t1175 * t620;
  t2160 = t617 * t1181;
  t2165 = t619 * t619;
  t2166 = 0.1e1 / t2165;
  t2167 = t240 * t2166;
  t2168 = t1183 * t630;
  t2171 = t630 * t1194;
  t2177 = 0.1e1 / rho[1];
  t2187 = 0.64e2 * t971 * t28 * t2177 * t622 - 0.96e2 * t1859 * t613 * t622 + 0.64e2 * t42 * t622 * t604 - 0.24e2 * t2149 + 0.16e2 * t2153;
  t2205 = t666 * t666;
  t2206 = 0.1e1 / t2205;
  t2209 = t457 * t2206 * t1240 * t691;
  t2212 = t1239 * t691;
  t2214 = t457 * t2212 * t1277;
  t2220 = t716 * t14;
  t2221 = t285 * t2220;
  t2243 = t220 * t28;
  t2248 = t622 * t6;
  t2268 = -0.156e3 * t946 * t948 * t227 * t274 - 0.24e2 * t1948 * t1258 * t274 - 0.8e2 / 0.3e1 * t461 * t76 * t2177 * t274 + 0.32e2 / 0.3e1 * t287 * t118 * t604 - 0.4e2 / 0.3e1 * t476 * t1215 * t243 + 0.32e2 * t965 * t2243 * t1259 + 0.8e2 / 0.3e1 * t971 * t2177 * t274 * t2248 + 0.32e2 * t1977 * t305 * t243 + 0.32e2 * t1859 * t651 * t622 - 0.64e2 / 0.9e1 * t677 * t678 * t604 - 0.32e2 / 0.9e1 * t297 * t8 * t1318 * t4 + 0.32e2 / 0.9e1 * t46 * t1318 * t4;
  t2270 = t457 * t667 * t2268;
  t2276 = t1221 * t664;
  t2282 = t657 * t1234;
  t2296 = t274 * t1318;
  t2302 = (-0.16e2 / 0.9e1 * t2149 + 0.104e3 / 0.9e1 * t42 * t604 * t274 - 0.2e2 / 0.3e1 * t879 * t2177 * t1212 + 0.56e2 / 0.3e1 * t1859 * t652 - 0.88e2 / 0.27e2 * t2296 * t6 * t277 + 0.88e2 / 0.27e2 * t2153) * t8;
  t2306 = -0.2e1 / 0.3e1 * t1228 * t1242 - 0.4e1 / 0.9e1 * t1235 * t1242 + 0.2e1 / 0.3e1 * t665 * t2209 - 0.2e1 / 0.3e1 * t665 * t2214 - 0.8e1 / 0.243e3 * t285 * t1318 * t311 - 0.2e1 / 0.27e2 * t2221 * t693 + 0.2e1 / 0.9e1 * t1235 * t1279 + t665 * t2270 / 0.9e1 - 0.2e1 / 0.9e1 * t1221 * t227 * t311 + t2276 * t693 / 0.3e1 + 0.2e1 / 0.27e2 * t657 * t716 * t311 + 0.4e1 / 0.9e1 * t2282 * t693 + t1228 * t1279 / 0.3e1 - t2302 * t219 * t311 / 0.9e1;
  t2307 = my_piecewise5(t232, -0.3e1 * t1177 * t1194 + 0.6e1 * t1182 * t2171 + 0.6e1 * t2160 * t1183 + t2155 * t253 - 0.3e1 * t2157 * t630 - 0.6e1 * t2167 * t2168 - t621 * t2187, t255, (0.224e5 / 0.27e2 * t82 * t1318 * t69 * t14 + 0.112e4 / 0.27e2 * t87 * t604 * t4 * t39) * t94 / 0.504e5, t2306);
  t2308 = t27 * t2307;
  t2313 = params->kappa * t227 * t8;
  t2316 = t3 * (0.5e1 / 0.42e2 * t390 * t2118 * t607 - 0.5e1 / 0.224e3 * t849 * t2126 * t607 - 0.15e2 / 0.112e3 * t390 * t1153 * t1165 + t2136 * t2139 / 0.4032e4 + 0.3e1 / 0.224e3 * t849 * t1161 * t1165 + 0.9e1 / 0.112e3 * t390 * t606 * t2145 + 0.27e2 / 0.56e2 * t226 * t26 * t2308 + 0.8e2 / 0.27e2 * t2313);
  t2317 = t2316 * t6;
  t2322 = t158 * t604;
  t2323 = t2322 * t378;
  t2329 = 0.14e2 / 0.81e2 * t31 * p->hyb_omega[0] * t1159 * t34;
  t2330 = my_piecewise3(t327, -t2329, 0);
  t2337 = t721 * t1323;
  t2347 = t1314 * t721;
  t2378 = -0.2908224e8 * t329 * t721 * t1323 + 0.27495936e10 * t330 * t721 * t1323 - 0.17564811264e12 * t331 * t721 * t1323 + 0.87107125248e13 * t332 * t721 * t1323 + 0.131525306744832e17 * t335 * t721 * t1323 - 0.35771992768512e15 * t337 * t721 * t1323 + 0.38896e5 * t328 * t2330 + 0.18330624e9 * t714 * t2330 + 0.3372443762688e15 * t715 * t2330 - 0.323136e7 * t724 * t2330 - 0.1083999780864e14 * t725 * t2330 + 0.3226189824e12 * t728 * t2330 - 0.836419584e10 * t731 * t2330 - 0.1938816e8 * t328 * t2347 - 0.35129622528e12 * t714 * t2347 + 0.36661248e10 * t724 * t2347 + 0.526101226979328e17 * t725 * t2347 - 0.11923997589504e16 * t728 * t2347 + 0.232285667328e14 * t731 * t2347 + 0.116688e6 * t2337;
  t2381 = t1349 * t744;
  t2384 = t740 * t1356;
  t2390 = 0.1e1 / t344 / t724;
  t2391 = t343 * t2390;
  t2399 = t755 * t1378;
  t2403 = 0.1e1 / t350 / t348;
  t2404 = t353 * t2403;
  t2405 = t1363 * t750;
  t2406 = t2405 * t356;
  t2409 = t760 * t1366;
  t2414 = t750 * t1366;
  t2416 = my_piecewise3(t327, 0, -t2329);
  t2417 = t348 * t2416;
  t2419 = t348 * t2405;
  t2421 = t349 * t750;
  t2422 = t2421 * t1366;
  t2424 = t749 * t2416;
  t2428 = 0.768e3 * t2419 + 0.1152e4 * t2422 + 0.128e3 * t2424 - 0.96e2 * t2414 - 0.32e2 * t2417;
  t2433 = 0.1e1 / t350 / t749;
  t2448 = t1378 * t750;
  t2451 = t1372 * t758;
  t2456 = t755 * t1387;
  t2459 = t353 * t2433;
  t2462 = t2416 * t356;
  t2465 = t350 * t350;
  t2467 = 0.1e1 / t2465 / t348;
  t2468 = t353 * t2467;
  t2471 = -0.8e1 / 0.3e1 * t362 * t2416 * t60 - 0.256e3 * t2419 - 0.384e3 * t2422 - 0.16e2 / 0.3e1 * t2403 * t2405 * t356 + 0.4e1 * t2448 * t1383 + t2451 * t760 / 0.2e1 + t1375 * t1383 / 0.2e1 + t2456 * t1380 / 0.4e1 - 0.3e1 / 0.4e1 * t2459 * t2406 + t759 * t2462 / 0.6e1 + t2468 * t2406 / 0.24e2;
  t2473 = my_piecewise3(t326, t2378 * t345 / 0.8671998246912e15 - t2381 * t721 / 0.180666630144e14 + t2384 * t1314 / 0.10627448832e13 - t1352 * t1323 / 0.180666630144e14 - t2391 * t2347 / 0.1771241472e12 + t1357 * t2337 / 0.10627448832e13 - t745 * t2330 / 0.541999890432e14, -0.3e1 / 0.2e1 * t2399 * t1380 + 0.2e1 * t2404 * t2406 - 0.3e1 / 0.2e1 * t1379 * t2409 + t1388 * t2409 / 0.4e1 + 0.48e2 * t2414 + 0.16e2 * t2417 + t2428 * t356 / 0.3e1 - 0.128e3 / 0.3e1 * t2424 + 0.2e1 / 0.3e1 * t2433 * t2405 * t356 + 0.8e1 / 0.3e1 * t764 * t2416 + t2471);
  t2474 = t2473 * t377;
  t2475 = t325 * t2474;
  t2478 = t1409 * t1416;
  t2481 = -0.1008e4 * t777 * t2098 - 0.1344e4 * t707 * t1307 - 0.504e3 * t707 * t1406 - 0.224e3 * t324 * t2105 - 0.672e3 * t324 * t2108 - 0.672e3 * t1293 * t711 - 0.224e3 * t707 * t1304 - 0.168e3 * t2317 * t379 - 0.504e3 * t1293 * t774 + 0.448e3 / 0.9e1 * t324 * t2323 - 0.168e3 * t324 * t2475 - 0.1008e4 * t777 * t2478;
  t2482 = t779 * t779;
  t2483 = 0.1e1 / t2482;
  t2484 = t1415 * t793;
  t2485 = t2483 * t2484;
  t2486 = t778 * t2485;
  t2491 = t1310 * t1416;
  t2494 = params->b_PBE * t2307;
  t2498 = t1420 * t588;
  t2503 = t781 * t1138;
  t2507 = t16 * t2116 * t788;
  t2511 = t847 * t2124 * t788;
  t2514 = t369 * t2054;
  t2517 = t1815 * t2134 * t6 * t788;
  t2521 = 0.216e3 * t2494 * t224 * t372 + 0.36e2 * t2498 * t789 - 0.6e2 * t1424 * t1428 + 0.6e1 * t2503 * t1433 + 0.16e3 / 0.3e1 * t785 * t2507 - 0.1e2 * t1431 * t2511 + t2514 * t2517 / 0.9e1 + 0.3584e5 / 0.27e2 * t2313;
  t2522 = t780 * t2521;
  t2523 = t778 * t2522;
  t2526 = t1409 * t1438;
  t2529 = t233 * t1404;
  t2530 = t2529 * t794;
  t2533 = t1310 * t1438;
  t2536 = t220 * t368;
  t2537 = t2536 * t794;
  t2540 = t218 * t772;
  t2541 = t2540 * t794;
  t2548 = t1292 * t579;
  t2553 = 0.1344e4 * t1300 * t1311 + 0.1008e4 * t1300 * t1410 - 0.1008e4 * t1300 * t1417 + 0.504e3 * t1300 * t1439 + 0.1008e4 * t777 * t2486 - 0.1344e4 * t777 * t2491 + 0.168e3 * t777 * t2523 + 0.504e3 * t777 * t2526 + 0.504e3 * t777 * t2530 + 0.672e3 * t777 * t2533 + 0.224e3 * t777 * t2537 + 0.1344e4 * t777 * t2541 + 0.504e3 * t2548 * t795;
  tv3rho33 = my_piecewise3(t217, 0, t2481 + t2553);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t2555 = t2018 * params->b_PBE;
  t2556 = t2555 * t145;
  t2557 = t800 * t1121;
  t2558 = t2556 * t2557;
  t2561 = t1492 * t500;
  t2562 = t2561 * t1494;
  t2565 = t800 * t1145;
  t2566 = t1493 * t2565;
  t2569 = t509 * t28;
  t2570 = t2569 * t1490;
  t2573 = t808 * t19;
  t2574 = t154 * t2573;
  t2577 = t509 * t1480;
  t2580 = t2077 * t211;
  t2588 = t990 * t23 * t12;
  t2589 = t812 * t2588;
  t2598 = t1110 * t583;
  t2599 = t2598 * params->b_PBE;
  t2600 = t2599 * t814;
  t2603 = t1485 * t1499;
  t2606 = t2067 * t211;
  t2610 = t999 * t809;
  t2615 = t991 * t158;
  t2622 = -0.216e3 * t802 * t1456 * t1460 - 0.162e3 * t802 * t1456 * t1464 - 0.36e2 * t802 * t803 * t2580 - 0.81e2 * t802 * t803 * t2606 - 0.81e2 * t802 * t2615 * t804 + 0.72576e5 * t1477 * t1486 + 0.72576e5 * t1477 * t1500 + 0.96768e5 * t1481 * t1486 + 0.96768e5 * t1481 * t1500 + 0.217728e6 * t1491 * t2558 - 0.145152e6 * t1491 * t2562 - 0.72576e5 * t1491 * t2566 - 0.145152e6 * t2570 * t1495 + 0.16128e5 * t2574 * t815 + 0.96768e5 * t2577 * t815 + 0.36288e5 * t810 * t2589 + 0.36288e5 * t810 * t2600 + 0.72576e5 * t810 * t2603 + 0.36288e5 * t2610 * t815;
  t2623 = t2081 * t211;
  t2628 = t1446 * t1447 * t519;
  t2631 = t500 * t158;
  t2633 = t1450 * t2631 * t212;
  t2637 = t1450 * t1451 * t575;
  t2641 = t1444 * t508 * t158;
  t2642 = t2641 * t1506;
  t2646 = t584 * params->ax * t1509;
  t2649 = t519 * t202;
  t2650 = t2649 * t583;
  t2651 = t1504 * t2650;
  t2654 = t32 * t574;
  t2655 = t2654 * t583;
  t2656 = t1504 * t2655;
  t2659 = 0.1e1 / t470;
  t2661 = t2659 * t153 * t158;
  t2662 = 0.1e1 / t77;
  t2663 = t2662 * t202;
  t2664 = t583 * params->b_PBE;
  t2665 = t2663 * t2664;
  t2666 = t2661 * t2665;
  t2667 = t145 * t843;
  t2669 = t847 * t6;
  t2670 = t2669 * t800;
  t2671 = t2667 * t69 * t2670;
  t2674 = t1505 * t1492;
  t2675 = t1504 * t2674;
  t2677 = t145 * params->ax * t4;
  t2678 = t15 * t23;
  t2679 = t12 * t597;
  t2680 = t2678 * t2679;
  t2681 = t2677 * t2680;
  t2686 = t1446 * t1447 * t32 * t23;
  t2687 = t158 * t202;
  t2688 = t2687 * t598;
  t2689 = t396 * t2688;
  t2693 = t2659 * params->b_PBE * t843;
  t2694 = t69 * t847;
  t2697 = t2693 * t2694 * t2662 * t6;
  t2700 = t202 * t1120;
  t2701 = t2700 * t1121;
  t2705 = t513 * t202;
  t2706 = t1489 * t2705;
  t2709 = t159 * t574;
  t2710 = t1489 * t2709;
  t2713 = t811 * t1145;
  t2717 = t2631 * t43;
  t2721 = t1451 * t17;
  t2725 = t1484 * t597;
  t2729 = -0.216e3 * t802 * t803 * t2623 - 0.27e2 / 0.2e1 * t2628 * t1453 - 0.27e2 * t1449 * t2633 - 0.27e2 * t1449 * t2637 + 0.12096e5 * t2642 * t1510 + 0.12096e5 * t1507 * t2646 + 0.6048e4 * t2651 * t1510 + 0.12096e5 * t2656 * t1510 + 0.336e3 * t2666 * t2671 - 0.24192e5 * t2675 * t2681 + 0.27e2 * t2686 * t2689 - 0.3e1 / 0.4e1 * t2697 * t1453 - 0.162e3 * t1471 * t1472 * t2701 - 0.193536e6 * t2706 * t1495 - 0.145152e6 * t2710 * t1495 + 0.81e2 * t1471 * t1472 * t2713 + 0.162e3 * t1471 * t2717 * t1473 + 0.216e3 * t1471 * t2721 * t1473 + 0.162e3 * t1471 * t1472 * t2725;
  tv3rho2sigma0 = my_piecewise3(t1, 0, t2622 + t2729);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2731 = t706 * t1544;
  t2734 = t808 * t220;
  t2735 = t323 * t2734;
  t2741 = t2536 * t377;
  t2746 = t1283 * t224 * t12;
  t2747 = t830 * t2746;
  t2754 = t1404 * t780;
  t2755 = t2754 * params->b_PBE;
  t2756 = t2755 * t832;
  t2759 = t1549 * t1563;
  t2762 = t2529 * t377;
  t2766 = t1292 * t827;
  t2773 = t1284 * t158;
  t2780 = t2540 * t377;
  t2785 = t1446 * t1447 * t716;
  t2789 = t781 * params->ax * t1573;
  t2793 = t1444 * t705 * t158;
  t2794 = t2793 * t1570;
  t2797 = 0.96768e5 * t2731 * t833 + 0.16128e5 * t2735 * t833 - 0.216e3 * t821 * t1522 * t1526 - 0.36e2 * t821 * t822 * t2741 + 0.36288e5 * t828 * t2747 + 0.96768e5 * t1545 * t1550 + 0.96768e5 * t1545 * t1564 + 0.36288e5 * t828 * t2756 + 0.72576e5 * t828 * t2759 - 0.81e2 * t821 * t822 * t2762 + 0.36288e5 * t2766 * t833 + 0.72576e5 * t1541 * t1550 + 0.72576e5 * t1541 * t1564 - 0.81e2 * t821 * t2773 * t823 - 0.162e3 * t821 * t1522 * t1530 - 0.216e3 * t821 * t822 * t2780 - 0.27e2 / 0.2e1 * t2785 * t1519 + 0.12096e5 * t1571 * t2789 + 0.12096e5 * t2794 * t1574;
  t2798 = t716 * t368;
  t2799 = t2798 * t780;
  t2800 = t1568 * t2799;
  t2803 = t227 * t772;
  t2804 = t2803 * t780;
  t2805 = t1568 * t2804;
  t2808 = t697 * t158;
  t2810 = t1516 * t2808 * t378;
  t2814 = t1516 * t1517 * t773;
  t2818 = t2659 * t322 * t158;
  t2819 = 0.1e1 / t256;
  t2820 = t2819 * t368;
  t2821 = t780 * params->b_PBE;
  t2822 = t2820 * t2821;
  t2823 = t2818 * t2822;
  t2824 = t314 * t843;
  t2826 = t2669 * t819;
  t2827 = t2824 * t69 * t2826;
  t2830 = t1569 * t1556;
  t2831 = t1568 * t2830;
  t2833 = t314 * params->ax * t4;
  t2834 = t15 * t224;
  t2835 = t12 * t793;
  t2836 = t2834 * t2835;
  t2837 = t2833 * t2836;
  t2842 = t1446 * t1447 * t227 * t224;
  t2843 = t158 * t368;
  t2844 = t2843 * t794;
  t2845 = t607 * t2844;
  t2850 = t2693 * t2694 * t2819 * t6;
  t2853 = t710 * t368;
  t2854 = t1553 * t2853;
  t2857 = t829 * t1437;
  t2861 = t2808 * t233;
  t2865 = t1517 * t218;
  t2869 = t1548 * t793;
  t2873 = t2483 * params->b_PBE;
  t2874 = t2873 * t314;
  t2875 = t819 * t1415;
  t2876 = t2874 * t2875;
  t2879 = t368 * t1414;
  t2880 = t2879 * t1415;
  t2884 = t325 * t772;
  t2885 = t1553 * t2884;
  t2888 = t1556 * t697;
  t2889 = t2888 * t1558;
  t2892 = t819 * t1437;
  t2893 = t1557 * t2892;
  t2896 = t706 * t28;
  t2897 = t2896 * t1554;
  t2900 = 0.6048e4 * t2800 * t1574 + 0.12096e5 * t2805 * t1574 - 0.27e2 * t1515 * t2810 - 0.27e2 * t1515 * t2814 + 0.336e3 * t2823 * t2827 - 0.24192e5 * t2831 * t2837 + 0.27e2 * t2842 * t2845 - 0.3e1 / 0.4e1 * t2850 * t1519 - 0.193536e6 * t2854 * t1559 + 0.81e2 * t1535 * t1536 * t2857 + 0.162e3 * t1535 * t2861 * t1537 + 0.216e3 * t1535 * t2865 * t1537 + 0.162e3 * t1535 * t1536 * t2869 + 0.217728e6 * t1555 * t2876 - 0.162e3 * t1535 * t1536 * t2880 - 0.145152e6 * t2885 * t1559 - 0.145152e6 * t1555 * t2889 - 0.72576e5 * t1555 * t2893 - 0.145152e6 * t2897 * t1559;
  tv3rho2sigma8 = my_piecewise3(t217, 0, t2797 + t2900);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  t2902 = t1444 * t1578;
  t2903 = t2902 * t1580;
  t2904 = t1581 * t27;
  t2905 = t2904 * t1586;
  t2906 = t2903 * t2905;
  t2908 = t5 * t6 * t15;
  t2912 = t811 * t500;
  t2924 = t1586 * t43;
  t2925 = t2700 * t597;
  t2929 = t509 * t1490;
  t2932 = t154 * t2705;
  t2935 = t154 * t2709;
  t2938 = t2018 * t1578;
  t2939 = t2938 * t1585;
  t2941 = t2939 * t1582 * t597;
  t2944 = t1592 * t145;
  t2946 = t2944 * t1582 * t500;
  t2949 = t1505 * t1592;
  t2950 = t1504 * t2949;
  t2951 = t1594 * t2908;
  t2954 = 0.139968e6 * t1584 * t1586 * t1017 * t583 + 0.104976e6 * t1584 * t1586 * t1115 * t583 + 0.209952e6 * t1584 * t1472 * t2912 + 0.11664e5 * t2906 * t1506 * t2908 - 0.209952e6 * t1584 * t2924 * t2925 + 0.141087744e9 * t1591 * t2941 - 0.94058496e8 * t1591 * t2946 - 0.47029248e8 * t2929 * t1595 - 0.62705664e8 * t2932 * t1595 - 0.47029248e8 * t2935 * t1595 - 0.5225472e7 * t2950 * t2951;
  tv3rhosigma20 = my_piecewise3(t1, 0, t2954);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t2955 = t2902 * t1599;
  t2956 = t2904 * t1604;
  t2957 = t2955 * t2956;
  t2961 = t829 * t697;
  t2973 = t1604 * t233;
  t2974 = t2879 * t793;
  t2978 = t706 * t1554;
  t2981 = t323 * t2853;
  t2984 = t323 * t2884;
  t2987 = t2483 * t1578;
  t2988 = t2987 * t1603;
  t2990 = t2988 * t1600 * t793;
  t2993 = t1610 * t314;
  t2995 = t2993 * t1600 * t697;
  t2998 = t1569 * t1610;
  t2999 = t1568 * t2998;
  t3000 = t1612 * t2908;
  t3003 = 0.139968e6 * t1602 * t1604 * t1310 * t780 + 0.104976e6 * t1602 * t1604 * t1409 * t780 + 0.209952e6 * t1602 * t1536 * t2961 + 0.11664e5 * t2957 * t1570 * t2908 - 0.209952e6 * t1602 * t2973 * t2974 + 0.141087744e9 * t1609 * t2990 - 0.94058496e8 * t1609 * t2995 - 0.47029248e8 * t2978 * t1613 - 0.62705664e8 * t2981 * t1613 - 0.47029248e8 * t2984 * t1613 - 0.5225472e7 * t2999 * t3000;
  tv3rhosigma211 = my_piecewise3(t217, 0, t3003);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  t3004 = t1578 * params->b_PBE;
  t3005 = t3 * t3004;
  t3006 = t1580 * t23;
  t3007 = t3006 * t27;
  t3008 = t1585 * t145;
  t3010 = t3005 * t3007 * t3008;
  t3011 = t2700 * t6;
  t3015 = t2018 * t3004;
  t3018 = t3015 * t3008 * t3006 * t6;
  tv3sigma30 = my_piecewise3(t1, 0, -0.136048896e9 * t3010 * t159 * t3011 + 0.60949905408e11 * t1591 * t3018);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t3022 = t1599 * t224;
  t3023 = t3022 * t27;
  t3024 = t1603 * t314;
  t3026 = t3005 * t3023 * t3024;
  t3027 = t2879 * t6;
  t3031 = t2483 * t3004;
  t3034 = t3031 * t3024 * t3022 * t6;
  tv3sigma39 = my_piecewise3(t217, 0, -0.136048896e9 * t3026 * t325 * t3027 + 0.60949905408e11 * t1609 * t3034);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  t3055 = t1021 * t1021;
  t3057 = t1030 * t1030;
  t3081 = t524 * t1626;
  t3086 = 0.14e3 / 0.243e3 * t31 * p->hyb_omega[0] * t1802 * t34;
  t3087 = my_piecewise3(t161, t3086, 0);
  t3092 = 0.38896e5 * t162 * t3087 + 0.109983744e11 * t163 * t3055 - 0.2908224e8 * t163 * t3057 - 0.17564811264e13 * t164 * t3055 + 0.27495936e10 * t164 * t3057 + 0.1625999671296e15 * t165 * t3055 - 0.17564811264e12 * t165 * t3057 - 0.107315978305536e17 * t166 * t3055 + 0.87107125248e13 * t166 * t3057 + 0.131525306744832e17 * t169 * t3057 + 0.5787113496772608e18 * t171 * t3055 - 0.35771992768512e15 * t171 * t3057 + 0.3372443762688e15 * t518 * t3087 - 0.1938816e8 * t3055 + 0.116688e6 * t3057 + 0.155584e6 * t3081;
  t3139 = -0.11632896e9 * t162 * t1021 * t1030 - 0.210777735168e13 * t517 * t1021 * t1030 + 0.219967488e11 * t527 * t1021 * t1030 + 0.3156607361875968e18 * t528 * t1021 * t1030 - 0.71543985537024e16 * t531 * t1021 * t1030 + 0.1393714003968e15 * t534 * t1021 * t1030 - 0.3877632e8 * t163 * t1626 * t524 + 0.36661248e10 * t164 * t1626 * t524 - 0.23419748352e12 * t165 * t1626 * t524 + 0.116142833664e14 * t166 * t1626 * t524 + 0.175367075659776e17 * t169 * t1626 * t524 - 0.47695990358016e15 * t171 * t1626 * t524 + 0.18330624e9 * t517 * t3087 - 0.323136e7 * t527 * t3087 - 0.1083999780864e14 * t528 * t3087 + 0.3226189824e12 * t531 * t3087 - 0.836419584e10 * t534 * t3087;
  t3172 = (t3092 + t3139) * t179 / 0.8671998246912e15 - t1674 * t547 * t524 / 0.135499972608e14 + t1056 * t1063 * t1021 / 0.5313724416e12 - t1677 * t1030 / 0.90333315072e13 - t543 * t1686 * t1643 / 0.442810368e11 + t1680 * t1639 / 0.2656862208e12 - t1059 * t1626 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t177 / t178 / t164 * t3055 - t1687 * t1021 * t1030 / 0.295206912e11 + t1064 * t3057 / 0.10627448832e13 + t1064 * t3081 / 0.7970586624e12 - t548 * t3087 / 0.541999890432e14;
  t3173 = t1070 * t1070;
  t3175 = t1073 * t1073;
  t3179 = t1087 * t1073;
  t3182 = t563 * t1715;
  t3192 = t183 * t3175;
  t3194 = my_piecewise3(t161, 0, t3086);
  t3195 = t552 * t3194;
  t3197 = t553 * t1715;
  t3199 = t182 * t3194;
  t3203 = t182 * t1070 * t1073;
  t3206 = t1712 * t1715;
  t3218 = t3173 * t190;
  t3233 = -0.256e3 * t3173 + 0.48e2 * t3175 - 0.6e1 * t1695 * t1705 + 0.12e2 * t1700 * t3179 - 0.2e1 * t1086 * t3182 - 0.9e1 / 0.2e1 * t1760 * t3179 + t1757 * t1705 + t1095 * t3182 / 0.3e1 + t1743 * t3179 / 0.4e1 - 0.384e3 * t3192 - 0.128e3 / 0.3e1 * t3195 + 0.64e2 * t3197 + 0.16e2 * t3199 + (0.768e3 * t3173 + 0.4608e4 * t3203 + 0.1152e4 * t3192 + 0.1536e4 * t3206 + 0.128e3 * t3195 - 0.96e2 * t3175 - 0.128e3 * t3197 - 0.32e2 * t3199) * t190 / 0.3e1 + t187 / t1740 / t184 * t3218 / 0.48e2 - 0.32e2 * t1699 * t1070 * t1090 + t1752 * t1090 + t1079 * t1094 * t1087 / 0.2e1 + 0.2e1 / 0.3e1 * t1082 * t1763 + t562 * t3194 * t190 / 0.6e1;
  t3240 = 0.1e1 / t1740;
  t3260 = t3175 * t190;
  t3266 = 0.1e1 / t1740 / t183;
  t3288 = -0.3e1 * t1079 * t1085 * t1087 - 0.3e1 * t558 * t1732 * t1702 + 0.25e2 / 0.4e1 * t187 * t3240 * t3218 + 0.2e1 / 0.3e1 * t1722 * t561 * t563 + 0.4e1 * t1732 * t1070 * t1090 + 0.16e2 / 0.3e1 * t1749 * t1763 + t558 * t1742 * t1702 / 0.6e1 + 0.8e1 * t558 * t1699 * t1702 - 0.1e2 * t1095 * t3218 - 0.3e1 / 0.2e1 * t1086 * t3260 + t1095 * t3260 / 0.4e1 - 0.3e1 / 0.4e1 * t187 * t3266 * t3218 + 0.8e2 / 0.3e1 * t1094 * t3173 * t190 + 0.4e1 * t1085 * t3175 * t190 - 0.22e2 / 0.3e1 * t3240 * t3173 * t190 - 0.1536e4 * t3203 - 0.512e3 * t3206 + t3266 * t3173 * t190 / 0.3e1 + 0.8e1 / 0.3e1 * t567 * t3194 - 0.8e1 / 0.3e1 * t197 * t3194;
  t3290 = my_piecewise3(t160, t3172, t3233 + t3288);
  t3296 = 0.1e1 / t18 / t1800;
  t3303 = 0.1e1 / t17 / t1817;
  t3312 = t1800 * t77;
  t3313 = 0.1e1 / t3312;
  t3324 = t843 * t843;
  t3326 = t69 * t69;
  t3327 = params->b_PBE * t3324 * t3326;
  t3328 = 0.1e1 / t948;
  t3329 = 0.1e1 / t944;
  t3330 = t3328 * t3329;
  t3332 = 0.1e1 / t18 / t3312;
  t3350 = t42 * t837;
  t3354 = t46 * t6 * t852 * t4;
  t3376 = t876 * t876;
  t3382 = t888 * t888;
  t3391 = t1944 * t1947;
  t3392 = t94 * t19;
  t3407 = (0.28e3 / 0.81e2 * t3350 + 0.112e3 / 0.27e2 * t3354) * t73 - 0.4e1 * t1839 * t409 * t421 + 0.12e2 * t868 * t874 * t876 - 0.6e1 * t1841 * t888 - 0.24e2 * t406 * t1850 * t1852 + 0.24e2 * t1844 * t1855 - 0.4e1 * t870 * t1873 + 0.24e2 * t51 / t1849 / t72 * t3376 - 0.36e2 * t1851 * t876 * t888 + 0.6e1 * t875 * t3382 + 0.8e1 * t875 * t421 * t1873 - t410 * (-0.96e2 * t1859 * t864 * t411 + 0.192e3 * t3391 * t3392 * t411 - 0.32e3 / 0.3e1 * t971 * t28 * t2662 * t411 - 0.32e3 / 0.3e1 * t42 * t411 * t837 - 0.112e3 / 0.3e1 * t3354 + 0.4e2 * t3350);
  t3443 = t945 * t6;
  t3451 = t8 * t852 * t4;
  t3473 = t935 * t935;
  t3478 = t984 * t984;
  t3485 = -0.16e2 / 0.9e1 * t930 * t1896 + 0.4e1 * t456 * t457 * t1888 * t935 * t984 - 0.8e1 / 0.3e1 * t923 * t1896 - 0.8e1 / 0.9e1 * t456 * t457 * t1894 * t1992 - 0.32e2 / 0.243e3 * t448 * t1025 * t142 - (0.8e2 / 0.27e2 * t3350 - 0.232e3 / 0.9e1 * t42 * t837 * t102 + 0.388e3 / 0.27e2 * t879 * t2662 * t907 - 0.176e3 / 0.9e1 * t1858 * t519 * t3443 * t102 + 0.112e3 / 0.3e1 * t3391 * t3392 * t102 + 0.616e3 / 0.81e2 * t104 * t3451 - 0.616e3 / 0.81e2 * t3354) * t8 * t18 * t142 / 0.9e1 + 0.4e1 / 0.27e2 * t916 * t519 * t142 - 0.8e1 / 0.27e2 * t1919 * t32 * t142 + 0.56e2 / 0.729e3 * t114 * t852 * t142 + 0.16e2 / 0.9e1 * t930 * t1891 - 0.8e1 / 0.3e1 * t456 * t457 / t1887 / t139 * t3473 - 0.2e1 / 0.3e1 * t456 * t457 * t934 * t3478 - 0.16e2 / 0.9e1 * t1926 * t937;
  t3514 = t944 * t39 / t3326;
  t3515 = t76 * t76;
  t3516 = t3515 * t6;
  t3552 = t944 * t52 / t69 / t961 * t474 * t76 * t470;
  t3566 = -0.4e1 / 0.3e1 * t946 * t948 * t519 * t102 - 0.112e3 * t1948 * t1963 * t102 - 0.48e2 * t3514 * t3516 * t102 + 0.48e2 * t461 * t76 * t2662 * t102 - 0.544e3 / 0.27e2 * t117 * t118 * t837 + 0.16e3 / 0.9e1 * t476 * t1025 * t102 * t58 - 0.272e3 / 0.9e1 * t965 * t392 * t28 * t967 - 0.32e3 / 0.9e1 * t971 * t2662 * t102 * t1968 + 0.64e2 * t1977 * t1863 * t6 * t967 + 0.16e3 / 0.3e1 * t1859 * t1959 * t411 + 0.64e2 * t3552 * t957 + 0.64e2 / 0.3e1 * t1948 * t110 * t883 + 0.32e3 / 0.27e2 * t481 * t482 * t837 + 0.224e3 / 0.27e2 * t129 * t3451 - 0.224e3 / 0.27e2 * t46 * t852 * t4;
  t3581 = 0.8e1 / 0.27e2 * t1935 * t937 + 0.8e1 / 0.9e1 * t916 * t929 * t496 + 0.8e1 / 0.9e1 * t1926 * t986 + 0.2e1 / 0.3e1 * t2000 * t986 + 0.4e1 / 0.9e1 * t923 * t1994 + 0.32e2 / 0.243e3 * t114 * t1025 * t14 * t496 - 0.4e1 / 0.27e2 * t1935 * t986 + 0.8e1 / 0.27e2 * t930 * t1994 + t456 * t457 * t459 * t3566 / 0.9e1 + 0.8e1 / 0.3e1 * t923 * t1891 - 0.4e1 / 0.3e1 * t2000 * t937 + 0.4e1 / 0.9e1 * t1919 * t455 * t496 - 0.8e1 / 0.27e2 * t448 * t1934 * t496;
  t3583 = my_piecewise5(t38, t3407, t75, (-0.1568e6 / 0.81e2 * t82 * t852 * t69 * t14 - 0.56e4 / 0.81e2 * t87 * t837 * t4 * t39) * t94 / 0.504e5, t3485 + t3581);
  t3589 = params->kappa * t519 * t8;
  t3591 = -0.55e2 / 0.126e3 * t390 * t3296 * t23 * sigma[0] * t396 + 0.235e3 / 0.2016e4 * t849 * t3303 * t23 * sigma[0] * t396 + 0.1e2 / 0.21e2 * t390 * t1796 * t858 - 0.5e1 / 0.2016e4 * t1813 * t1816 * t3313 * t1823 - 0.5e1 / 0.56e2 * t849 * t1804 * t858 - 0.15e2 / 0.56e2 * t390 * t839 * t1829 + t3327 * t3330 * t3332 * t28 * t23 * sigma[0] * t396 / 0.72576e5 + t1820 * t1822 * t858 / 0.1008e4 + 0.3e1 / 0.112e3 * t849 * t854 * t1829 + 0.3e1 / 0.28e2 * t390 * t394 * t395 * t2004 + 0.27e2 / 0.56e2 * t25 * t26 * t27 * t3583 - 0.8e2 / 0.81e2 * t3589;
  t3606 = 0.6048e4 * t580 * t581 * t2018 * t1121 * t1145 - 0.4032e4 * t1007 * t1619 - 0.4032e4 * t580 * t1115 * t1618 - 0.1344e4 * t580 * t581 * t1617 * t2062 - 0.5376e4 * t580 * t1017 * t1618 - 0.168e3 * t155 * t159 * t3290 * t211 - 0.168e3 * t3 * t3591 * t6 * t213 + 0.1792e4 / 0.9e1 * t510 * t1786 - 0.672e3 * t2014 * t576 - 0.1008e4 * t1000 * t1112 - 0.2688e4 * t1000 * t1014 - 0.896e3 * t510 * t1773;
  t3641 = 0.1e1 / t2017 / t210;
  t3642 = t1121 * t1121;
  t3647 = -0.448e3 * t155 * t1010 * t1111 - 0.2688e4 * t510 * t1776 - 0.672e3 * t510 * t1770 + 0.1792e4 / 0.9e1 * t155 * t1785 * t575 - 0.896e3 * t155 * t513 * t1769 - 0.896e3 * t2014 * t514 - 0.448e3 * t1000 * t1011 - 0.224e4 / 0.27e2 * t155 * t158 * t837 * t212 + 0.2688e4 * t580 * t2081 * t1146 + 0.448e3 * t580 * t2077 * t1146 - 0.896e3 * t580 * t2077 * t1122 + 0.5376e4 * t580 * t1017 * t2020 - 0.4032e4 * t580 * t581 * t3641 * t3642;
  t3649 = t1145 * t1145;
  t3683 = -0.1008e4 * t580 * t581 * t1120 * t3649 + 0.896e3 * t580 * t1017 * t2063 + 0.4032e4 * t580 * t1115 * t2020 - 0.2016e4 * t580 * t2067 * t1122 - 0.5376e4 * t580 * t2081 * t1122 + 0.672e3 * t2013 * t579 * t599 + 0.4032e4 * t1007 * t2021 - 0.5376e4 * t1007 * t2027 - 0.4032e4 * t1007 * t2030 + 0.2016e4 * t1007 * t2068 + 0.5376e4 * t1007 * t2082 + 0.2016e4 * t2089 * t1116 - 0.2016e4 * t2089 * t1123;
  t3684 = t43 * t1768;
  t3688 = t19 * t574;
  t3692 = t17 * t1110;
  t3729 = t3324 * t3326 * t3328;
  t3737 = 0.216e3 * params->b_PBE * t3583 * t23 * t206 + 0.48e2 * t2033 * t588 * t593 - 0.12e3 * t2037 * t1134 + 0.12e2 * t1126 * t1138 * t1141 + 0.64e3 / 0.3e1 * t1130 * t2046 - 0.4e2 * t2042 * t2050 + 0.4e1 / 0.9e1 * t584 * t2054 * t2058 - 0.176e4 / 0.9e1 * t589 * t16 * t3296 * t592 + 0.47e3 / 0.9e1 * t1139 * t847 * t3303 * t592 - 0.1e2 / 0.9e1 * t2055 * t1815 * t3313 * t6 * t592 + t203 * t3729 * t3329 * t3332 * t28 * t592 / 0.162e3 - 0.3584e5 / 0.81e2 * t3589;
  t3750 = t392 * t202;
  t3764 = 0.672e3 * t580 * t3684 * t598 + 0.896e3 * t580 * t3688 * t598 + 0.2688e4 * t580 * t3692 * t598 + 0.168e3 * t580 * t581 * t583 * t3737 + 0.2688e4 * t2089 * t1018 + 0.1008e4 * t2089 * t1147 + 0.896e3 * t1007 * t2078 + 0.2688e4 * t1007 * t2074 - 0.1792e4 / 0.9e1 * t580 * t3750 * t598 + 0.1008e4 * t580 * t2067 * t1146 + 0.2016e4 * t1007 * t2071 + 0.672e3 * t1007 * t2064 + 0.672e3 * t580 * t1115 * t2063;
  tv4rho40 = my_piecewise3(t1, 0, t3606 + t3647 + t3683 + t3764);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  tv4rho41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 1] += tv4rho41;

  tv4rho42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 2] += tv4rho42;

  tv4rho43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 3] += tv4rho43;

  t3796 = 0.1e1 / t219 / t2122;
  t3803 = 0.1e1 / t218 / t2133;
  t3812 = t2122 * t256;
  t3813 = 0.1e1 / t3812;
  t3825 = 0.1e1 / t219 / t3812;
  t3843 = t42 * t1151;
  t3847 = t46 * t6 * t1159 * t4;
  t3869 = t1183 * t1183;
  t3875 = t1194 * t1194;
  t3884 = t94 * t220;
  t3899 = (0.28e3 / 0.81e2 * t3843 + 0.112e3 / 0.27e2 * t3847) * t253 - 0.4e1 * t2155 * t620 * t630 + 0.12e2 * t1175 * t1181 * t1183 - 0.6e1 * t2157 * t1194 - 0.24e2 * t617 * t2166 * t2168 + 0.24e2 * t2160 * t2171 - 0.4e1 * t1177 * t2187 + 0.24e2 * t240 / t2165 / t252 * t3869 - 0.36e2 * t2167 * t1183 * t1194 + 0.6e1 * t1182 * t3875 + 0.8e1 * t1182 * t630 * t2187 - t621 * (-0.96e2 * t1859 * t1171 * t622 + 0.192e3 * t3391 * t3884 * t622 - 0.32e3 / 0.3e1 * t971 * t28 * t2819 * t622 - 0.32e3 / 0.3e1 * t42 * t622 * t1151 - 0.112e3 / 0.3e1 * t3847 + 0.4e2 * t3843);
  t3960 = t1277 * t1277;
  t4019 = -0.4e1 / 0.3e1 * t946 * t948 * t716 * t274 - 0.112e3 * t1948 * t2243 * t274 - 0.48e2 * t3514 * t3516 * t274 + 0.48e2 * t461 * t76 * t2819 * t274 - 0.544e3 / 0.27e2 * t287 * t118 * t1151 + 0.16e3 / 0.9e1 * t476 * t2296 * t243 - 0.272e3 / 0.9e1 * t965 * t604 * t28 * t1259 - 0.32e3 / 0.9e1 * t971 * t2819 * t274 * t2248 + 0.64e2 * t1977 * t2177 * t6 * t1259 + 0.16e3 / 0.3e1 * t1859 * t1215 * t622 + 0.64e2 * t3552 * t1255 + 0.64e2 / 0.3e1 * t1948 * t281 * t1189 + 0.32e3 / 0.27e2 * t677 * t678 * t1151 + 0.224e3 / 0.27e2 * t297 * t8 * t1159 * t4 - 0.224e3 / 0.27e2 * t46 * t1159 * t4;
  t4024 = -0.8e1 / 0.3e1 * t1228 * t2214 - 0.16e2 / 0.9e1 * t1235 * t2214 + 0.4e1 * t665 * t457 * t2206 * t1240 * t1277 - 0.8e1 / 0.9e1 * t665 * t457 * t2212 * t2268 + 0.4e1 / 0.27e2 * t1221 * t716 * t311 + 0.56e2 / 0.729e3 * t285 * t1159 * t311 - 0.8e1 / 0.27e2 * t2302 * t227 * t311 - (0.8e2 / 0.27e2 * t3843 - 0.232e3 / 0.9e1 * t42 * t1151 * t274 + 0.388e3 / 0.27e2 * t879 * t2819 * t1212 - 0.176e3 / 0.9e1 * t1858 * t716 * t3443 * t274 + 0.112e3 / 0.3e1 * t3391 * t3884 * t274 + 0.616e3 / 0.81e2 * t274 * t1159 * t6 * t277 - 0.616e3 / 0.81e2 * t3847) * t8 * t219 * t311 / 0.9e1 - 0.32e2 / 0.243e3 * t657 * t1318 * t311 - 0.2e1 / 0.3e1 * t665 * t457 * t1239 * t3960 + 0.8e1 / 0.27e2 * t1235 * t2270 + 0.4e1 / 0.9e1 * t1228 * t2270 + t665 * t457 * t667 * t4019 / 0.9e1;
  t4035 = t1240 * t1240;
  t4061 = -0.16e2 / 0.9e1 * t2282 * t1242 + 0.8e1 / 0.3e1 * t1228 * t2209 + 0.8e1 / 0.27e2 * t2221 * t1242 + 0.16e2 / 0.9e1 * t1235 * t2209 - 0.8e1 / 0.3e1 * t665 * t457 / t2205 / t308 * t4035 + 0.8e1 / 0.9e1 * t1221 * t1234 * t693 - 0.4e1 / 0.3e1 * t2276 * t1242 + 0.32e2 / 0.243e3 * t285 * t1318 * t14 * t693 - 0.8e1 / 0.27e2 * t657 * t2220 * t693 - 0.4e1 / 0.27e2 * t2221 * t1279 + 0.8e1 / 0.9e1 * t2282 * t1279 + 0.4e1 / 0.9e1 * t2302 * t664 * t693 + 0.2e1 / 0.3e1 * t2276 * t1279;
  t4063 = my_piecewise5(t232, t3899, t255, (-0.1568e6 / 0.81e2 * t82 * t1159 * t69 * t14 - 0.56e4 / 0.81e2 * t87 * t1151 * t4 * t39) * t94 / 0.504e5, t4024 + t4061);
  t4069 = params->kappa * t716 * t8;
  t4071 = -0.55e2 / 0.126e3 * t390 * t3796 * t224 * sigma[2] * t607 + 0.235e3 / 0.2016e4 * t849 * t3803 * t224 * sigma[2] * t607 + 0.1e2 / 0.21e2 * t390 * t2118 * t1165 - 0.5e1 / 0.2016e4 * t1813 * t1816 * t3813 * t2139 - 0.5e1 / 0.56e2 * t849 * t2126 * t1165 - 0.15e2 / 0.56e2 * t390 * t1153 * t2145 + t3327 * t3330 * t3825 * t28 * t224 * sigma[2] * t607 / 0.72576e5 + t2136 * t2138 * t1165 / 0.1008e4 + 0.3e1 / 0.112e3 * t849 * t1161 * t2145 + 0.3e1 / 0.28e2 * t390 * t606 * t395 * t2307 + 0.27e2 / 0.56e2 * t226 * t26 * t27 * t4063 - 0.8e2 / 0.81e2 * t4069;
  t4078 = 0.6048e4 * t777 * t778 * t2483 * t1415 * t1437 - 0.1344e4 * t777 * t778 * t2096 * t2521 - 0.168e3 * t3 * t4071 * t6 * t379 - 0.448e3 * t324 * t1303 * t1405 - 0.5376e4 * t777 * t1310 * t2097 - 0.4032e4 * t777 * t1409 * t2097 - 0.448e3 * t1293 * t1304 - 0.1008e4 * t1293 * t1406 - 0.4032e4 * t1300 * t2098 - 0.896e3 * t707 * t2105 - 0.2688e4 * t707 * t2108 - 0.672e3 * t2317 * t774;
  t4088 = t1314 * t1314;
  t4090 = t1323 * t1323;
  t4095 = 0.14e3 / 0.243e3 * t31 * p->hyb_omega[0] * t2124 * t34;
  t4096 = my_piecewise3(t327, t4095, 0);
  t4103 = t721 * t2330;
  t4125 = 0.38896e5 * t328 * t4096 + 0.1625999671296e15 * t331 * t4088 - 0.107315978305536e17 * t332 * t4088 + 0.87107125248e13 * t332 * t4090 + 0.131525306744832e17 * t335 * t4090 + 0.5787113496772608e18 * t337 * t4088 - 0.35771992768512e15 * t337 * t4090 + 0.18330624e9 * t714 * t4096 + 0.3372443762688e15 * t715 * t4096 - 0.323136e7 * t724 * t4096 - 0.1083999780864e14 * t725 * t4096 + 0.3226189824e12 * t728 * t4096 - 0.836419584e10 * t731 * t4096 - 0.1938816e8 * t4088 + 0.116688e6 * t4090 + 0.155584e6 * t4103;
  t4172 = -0.11632896e9 * t328 * t1314 * t1323 - 0.210777735168e13 * t714 * t1314 * t1323 + 0.219967488e11 * t724 * t1314 * t1323 + 0.3156607361875968e18 * t725 * t1314 * t1323 - 0.71543985537024e16 * t728 * t1314 * t1323 + 0.1393714003968e15 * t731 * t1314 * t1323 - 0.3877632e8 * t329 * t2330 * t721 + 0.36661248e10 * t330 * t2330 * t721 - 0.23419748352e12 * t331 * t2330 * t721 + 0.116142833664e14 * t332 * t2330 * t721 + 0.175367075659776e17 * t335 * t2330 * t721 - 0.47695990358016e15 * t337 * t2330 * t721 + 0.109983744e11 * t329 * t4088 - 0.2908224e8 * t329 * t4090 - 0.17564811264e13 * t330 * t4088 + 0.27495936e10 * t330 * t4090 - 0.17564811264e12 * t331 * t4090;
  t4205 = (t4125 + t4172) * t345 / 0.8671998246912e15 - t2378 * t744 * t721 / 0.135499972608e14 + t1349 * t1356 * t1314 / 0.5313724416e12 - t2381 * t1323 / 0.90333315072e13 - t740 * t2390 * t2347 / 0.442810368e11 + t2384 * t2337 / 0.2656862208e12 - t1352 * t2330 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t343 / t344 / t330 * t4088 - t2391 * t1314 * t1323 / 0.295206912e11 + t1357 * t4090 / 0.10627448832e13 + t1357 * t4103 / 0.7970586624e12 - t745 * t4096 / 0.541999890432e14;
  t4206 = t1366 * t1366;
  t4208 = t1363 * t1363;
  t4210 = t1380 * t1366;
  t4213 = t760 * t2416;
  t4231 = 0.1e1 / t2465;
  t4233 = t4208 * t356;
  t4256 = 0.48e2 * t4206 - 0.256e3 * t4208 + 0.12e2 * t2404 * t4210 - 0.2e1 * t1379 * t4213 - 0.9e1 / 0.2e1 * t2459 * t4210 + t2456 * t2409 + t1388 * t4213 / 0.3e1 + t2468 * t4210 / 0.4e1 - 0.6e1 * t2399 * t2409 - 0.3e1 * t1372 * t1378 * t1380 - 0.3e1 * t755 * t2433 * t2406 + 0.25e2 / 0.4e1 * t353 * t4231 * t4233 + 0.2e1 / 0.3e1 * t2428 * t758 * t760 + 0.4e1 * t2433 * t1363 * t1383 + 0.16e2 / 0.3e1 * t2448 * t2462 - 0.32e2 * t2403 * t1363 * t1383 + t2451 * t1383 + t1372 * t1387 * t1380 / 0.2e1 + 0.2e1 / 0.3e1 * t1375 * t2462 + t755 * t2467 * t2406 / 0.6e1;
  t4258 = 0.1e1 / t2465 / t349;
  t4262 = my_piecewise3(t327, 0, t4095);
  t4276 = t4206 * t356;
  t4281 = t749 * t4262;
  t4283 = t750 * t2416;
  t4285 = t348 * t4262;
  t4287 = t349 * t4206;
  t4291 = t348 * t1363 * t1366;
  t4294 = t2421 * t2416;
  t4322 = -0.3e1 / 0.4e1 * t353 * t4258 * t4233 + t759 * t4262 * t356 / 0.6e1 + t353 / t2465 / t350 * t4233 / 0.48e2 + 0.8e1 * t755 * t2403 * t2406 - 0.1e2 * t1388 * t4233 - 0.3e1 / 0.2e1 * t1379 * t4276 + t1388 * t4276 / 0.4e1 - 0.128e3 / 0.3e1 * t4281 + 0.64e2 * t4283 + 0.16e2 * t4285 - 0.384e3 * t4287 + (0.768e3 * t4208 + 0.4608e4 * t4291 + 0.1152e4 * t4287 + 0.1536e4 * t4294 + 0.128e3 * t4281 - 0.96e2 * t4206 - 0.128e3 * t4283 - 0.32e2 * t4285) * t356 / 0.3e1 - 0.1536e4 * t4291 - 0.512e3 * t4294 + t4258 * t4208 * t356 / 0.3e1 + 0.8e1 / 0.3e1 * t764 * t4262 - 0.8e1 / 0.3e1 * t362 * t4262 * t60 - 0.22e2 / 0.3e1 * t4231 * t4208 * t356 + 0.8e2 / 0.3e1 * t1387 * t4208 * t356 + 0.4e1 * t1378 * t4206 * t356;
  t4324 = my_piecewise3(t326, t4205, t4256 + t4322);
  t4342 = 0.1e1 / t2482 / t376;
  t4343 = t1415 * t1415;
  t4348 = t1437 * t1437;
  t4358 = -0.896e3 * t2317 * t711 - 0.2688e4 * t1293 * t1307 + 0.1792e4 / 0.9e1 * t707 * t2323 + 0.1792e4 / 0.9e1 * t324 * t2322 * t773 - 0.168e3 * t324 * t325 * t4324 * t377 - 0.224e4 / 0.27e2 * t324 * t158 * t1151 * t378 - 0.896e3 * t324 * t710 * t2474 - 0.672e3 * t707 * t2475 + 0.5376e4 * t777 * t1310 * t2485 - 0.4032e4 * t777 * t778 * t4342 * t4343 - 0.1008e4 * t777 * t778 * t1414 * t4348 - 0.5376e4 * t1300 * t2491 - 0.896e3 * t777 * t2536 * t1416;
  t4405 = 0.216e3 * params->b_PBE * t4063 * t224 * t372 + 0.48e2 * t2494 * t588 * t789 - 0.12e3 * t2498 * t1428 + 0.12e2 * t1420 * t1138 * t1433 + 0.64e3 / 0.3e1 * t1424 * t2507 - 0.4e2 * t2503 * t2511 + 0.4e1 / 0.9e1 * t781 * t2054 * t2517 - 0.176e4 / 0.9e1 * t785 * t16 * t3796 * t788 + 0.47e3 / 0.9e1 * t1431 * t847 * t3803 * t788 - 0.1e2 / 0.9e1 * t2514 * t1815 * t3813 * t6 * t788 + t369 * t3729 * t3329 * t3825 * t28 * t788 / 0.162e3 - 0.3584e5 / 0.81e2 * t4069;
  t4414 = t233 * t2473;
  t4433 = t604 * t368;
  t4437 = 0.896e3 * t777 * t1310 * t2522 + 0.672e3 * t777 * t1409 * t2522 + 0.168e3 * t777 * t778 * t780 * t4405 - 0.2016e4 * t2548 * t1417 + 0.4032e4 * t1300 * t2486 + 0.672e3 * t777 * t4414 * t794 - 0.4032e4 * t1300 * t2478 - 0.2016e4 * t777 * t2529 * t1416 - 0.5376e4 * t777 * t2540 * t1416 + 0.4032e4 * t777 * t1409 * t2485 + 0.5376e4 * t1300 * t2541 + 0.2016e4 * t2548 * t1410 - 0.1792e4 / 0.9e1 * t777 * t4433 * t794;
  t4440 = t220 * t772;
  t4465 = t218 * t1404;
  t4472 = 0.1008e4 * t777 * t2529 * t1438 + 0.448e3 * t777 * t2536 * t1438 + 0.2688e4 * t777 * t2540 * t1438 + 0.672e3 * t2316 * t579 * t795 + 0.896e3 * t777 * t4440 * t794 + 0.2688e4 * t777 * t4465 * t794 + 0.672e3 * t1300 * t2523 + 0.2016e4 * t1300 * t2526 + 0.2016e4 * t1300 * t2530 + 0.2688e4 * t1300 * t2533 + 0.896e3 * t1300 * t2537 + 0.2688e4 * t2548 * t1311 + 0.1008e4 * t2548 * t1439;
  tv4rho44 = my_piecewise3(t217, 0, t4078 + t4358 + t4437 + t4472);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 4] += tv4rho44;

  t4510 = 0.36288e5 * t810 * t1768 * t583 * params->b_PBE * t814 - 0.648e3 * t802 * t1456 * t2623 + 0.145152e6 * t999 * t1480 * t815 + 0.108864e6 * t810 * t1485 * t2588 + 0.108864e6 * t810 * t2599 * t1499 + 0.36288e5 * t2013 * t809 * t815 + 0.48384e5 * t509 * t2573 * t815 + 0.108864e6 * t1477 * t2589 + 0.108864e6 * t1477 * t2600 + 0.145152e6 * t1481 * t2600 + 0.290304e6 * t1481 * t2603 + 0.48384e5 * t2574 * t1486 + 0.48384e5 * t2574 * t1500;
  t4554 = 0.36288e5 * t810 * t812 * t2004 * t23 * t12 + 0.108864e6 * t2610 * t1500 + 0.217728e6 * t1477 * t2603 - 0.324e3 * t802 * t2615 * t1460 + 0.290304e6 * t2577 * t1486 + 0.290304e6 * t2577 * t1500 - 0.108e3 * t802 * t1456 * t2580 - 0.108e3 * t802 * t803 * t3688 * t211 + 0.108864e6 * t2610 * t1486 - 0.243e3 * t802 * t1456 * t2606 - 0.81e2 * t802 * t803 * t3684 * t211 + 0.9e1 / 0.4e1 * t2697 * t800 * t146 * t2688 - 0.2016e4 * t2661 * t2663 * t1492 * t2667 * t2694 * t1821 * t2679;
  t4577 = t513 * t574;
  t4594 = -0.217728e6 * t999 * t28 * t1490 * t1495 - 0.217728e6 * t1491 * t1492 * t990 * t1494 - 0.72576e5 * t1491 * t1493 * t800 * t2062 + 0.653184e6 * t1491 * t2555 * t500 * t2557 - 0.580608e6 * t1489 * t4577 * t1495 - 0.217728e6 * t1491 * t2561 * t2565 - 0.435456e6 * t2569 * t2709 * t1495 + 0.653184e6 * t2570 * t2558 + 0.653184e6 * t2710 * t2558 - 0.435456e6 * t2570 * t2562 - 0.435456e6 * t2710 * t2562 - 0.217728e6 * t2570 * t2566 - 0.217728e6 * t2710 * t2566;
  t4606 = t159 * t1110;
  t4610 = t1010 * t202;
  t4627 = t990 * t158;
  t4640 = 0.243e3 * t1471 * t1472 * t1484 * t1145 + 0.108e3 * t1471 * t1451 * t19 * t1473 + 0.81e2 * t1471 * t1472 * t811 * t2062 + 0.243e3 * t1471 * t1472 * t2598 * t597 + 0.243e3 * t1471 * t4627 * t43 * t1473 + 0.243e3 * t1471 * t2717 * t2713 + 0.486e3 * t1471 * t2717 * t2725 + 0.648e3 * t1471 * t2721 * t2725 - 0.217728e6 * t1489 * t4606 * t1495 - 0.96768e5 * t1489 * t4610 * t1495 - 0.580608e6 * t2569 * t2705 * t1495 + 0.870912e6 * t2706 * t2558 - 0.290304e6 * t2706 * t2566;
  t4651 = t202 * t2018;
  t4659 = t574 * t1120;
  t4677 = 0.1e1 / t2 / t76;
  t4679 = t4677 * params->b_PBE * t1811;
  t4680 = t93 * t1815;
  t4686 = 0.1e1 / t850;
  t4701 = t1815 * t28;
  t4706 = -0.870912e6 * t1491 * t3641 * params->b_PBE * t145 * t800 * t2019 - 0.580608e6 * t2706 * t2562 + 0.486e3 * t1471 * t1472 * t4651 * t2019 - 0.648e3 * t1471 * t2721 * t2701 - 0.486e3 * t1471 * t1472 * t4659 * t1121 + 0.648e3 * t1471 * t2631 * t17 * t1473 - 0.486e3 * t1471 * t2717 * t2701 + 0.324e3 * t1471 * t2721 * t2713 - 0.9e1 / 0.4e1 * t2697 * t2637 - t4679 * t4680 * t1794 * t28 * t1453 / 0.24e2 + 0.3e1 / 0.4e1 * t2693 * t2694 * t4686 * t6 * t1453 - 0.9e1 / 0.4e1 * t2697 * t2633 + 0.56e2 / 0.3e1 * t4677 * t153 * t158 * t1794 * t202 * t2664 * t145 * t1811 * t93 * t4701 * t800;
  t4767 = 0.1008e4 * t2659 * t508 * t158 * t2665 * t2671 - 0.81e2 * t2686 * t396 * t2687 * t1122 + 0.81e2 / 0.2e1 * t2686 * t396 * t2687 * t1146 + 0.81e2 * t2686 * t858 * t2688 + 0.81e2 / 0.2e1 * t1446 * t1447 * t519 * t23 * t2689 + 0.81e2 * t2686 * t396 * t158 * t574 * t598 - 0.36288e5 * t2675 * t2677 * t2678 * t12 * t1145 - 0.72576e5 * t2641 * t2674 * t2681 - 0.72576e5 * t1504 * t2654 * t1492 * t2681 + 0.1008e4 * t2661 * t2662 * t574 * t2664 * t2671 + 0.108864e6 * t1504 * t1505 * t2555 * t2677 * t2678 * t12 * t1121 - 0.72576e5 * t2675 * t500 * params->ax * t4 * t2680 + 0.1008e4 * t2666 * t500 * t843 * t69 * t2670;
  t4785 = t597 * t1145;
  t4818 = -0.36288e5 * t1504 * t2649 * t1492 * t2681 - 0.336e3 * t2661 * t4686 * t202 * t2664 * t2671 - 0.5376e4 * t1504 * t1025 * t202 * t583 * t1510 + 0.18144e5 * t2651 * t2646 + 0.653184e6 * t1491 * t2556 * t800 * t4785 + 0.18144e5 * t1504 * t519 * t574 * t583 * t1510 + 0.36288e5 * t2641 * t2655 * t1510 + 0.18144e5 * t1504 * t32 * t1110 * t583 * t1510 + 0.36288e5 * t2642 * t2646 + 0.36288e5 * t2656 * t2646 + 0.18144e5 * t1507 * t1126 * params->ax * t1509 + 0.18144e5 * t2641 * t2650 * t1510 - 0.81e2 * t1449 * t1450 * t2631 * t575;
  t4865 = -0.81e2 / 0.2e1 * t2628 * t2637 + 0.18144e5 * t1444 * t998 * t158 * t1506 * t1510 - 0.81e2 / 0.2e1 * t1449 * t1450 * t1451 * t1111 - 0.81e2 / 0.2e1 * t2628 * t2633 + 0.12e2 * t1446 * t1447 * t1025 * t1453 - 0.486e3 * t1471 * t1472 * t2700 * t4785 - 0.81e2 / 0.2e1 * t1449 * t1450 * t4627 * t212 - 0.10752e5 * t154 * t808 * t392 * t815 - 0.324e3 * t802 * t803 * t3692 * t211 + 0.145152e6 * t1481 * t2589 + 0.24e2 * t802 * t803 * t3750 * t211 - 0.81e2 * t802 * t2005 * t158 * t804 - 0.243e3 * t802 * t2615 * t1464;
  tv4rho3sigma0 = my_piecewise3(t1, 0, t4510 + t4554 + t4594 + t4640 + t4706 + t4767 + t4818 + t4865);

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 1] += tv4rho3sigma1;

  tv4rho3sigma2 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 2] += tv4rho3sigma2;

  tv4rho3sigma3 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 4] += tv4rho3sigma4;

  tv4rho3sigma5 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 5] += tv4rho3sigma5;

  tv4rho3sigma6 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 7] += tv4rho3sigma7;

  tv4rho3sigma8 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 8] += tv4rho3sigma8;

  tv4rho3sigma9 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 10] += tv4rho3sigma10;

  t4869 = t1303 * t368;
  t4884 = t1283 * t158;
  t4914 = t710 * t772;
  t4918 = -0.217728e6 * t1292 * t28 * t1554 * t1559 + 0.243e3 * t1535 * t1536 * t1548 * t1437 + 0.108e3 * t1535 * t1517 * t220 * t1537 + 0.81e2 * t1535 * t1536 * t829 * t2521 + 0.243e3 * t1535 * t1536 * t2754 * t793 + 0.648e3 * t1535 * t2808 * t218 * t1537 + 0.243e3 * t1535 * t4884 * t233 * t1537 + 0.243e3 * t1535 * t2861 * t2857 + 0.486e3 * t1535 * t2861 * t2869 + 0.648e3 * t1535 * t2865 * t2869 - 0.96768e5 * t1553 * t4869 * t1559 - 0.580608e6 * t1553 * t4914 * t1559 - 0.580608e6 * t2896 * t2853 * t1559;
  t4932 = t368 * t2483;
  t4963 = -0.580608e6 * t2854 * t2889 + 0.870912e6 * t2854 * t2876 - 0.870912e6 * t1555 * t4342 * params->b_PBE * t314 * t819 * t2484 - 0.648e3 * t1535 * t2865 * t2880 + 0.486e3 * t1535 * t1536 * t4932 * t2484 + 0.324e3 * t1535 * t2865 * t2857 - 0.290304e6 * t2854 * t2893 - 0.2016e4 * t2818 * t2820 * t1556 * t2824 * t2694 * t2137 * t2835 + 0.9e1 / 0.4e1 * t2850 * t819 * t315 * t2844 - 0.324e3 * t821 * t2773 * t1526 - 0.648e3 * t821 * t1522 * t2780 + 0.48384e5 * t2735 * t1550 + 0.48384e5 * t2735 * t1564;
  t5003 = 0.36288e5 * t828 * t2473 * t780 * params->b_PBE * t832 - 0.81e2 * t821 * t2308 * t158 * t823 - 0.81e2 * t821 * t822 * t4414 * t377 + 0.145152e6 * t1292 * t1544 * t833 - 0.243e3 * t821 * t1522 * t2762 - 0.243e3 * t821 * t2773 * t1530 + 0.108864e6 * t828 * t2755 * t1563 + 0.36288e5 * t2316 * t827 * t833 + 0.108864e6 * t1541 * t2756 + 0.290304e6 * t2731 * t1550 + 0.108864e6 * t2766 * t1550 + 0.290304e6 * t2731 * t1564 + 0.108864e6 * t2766 * t1564;
  t5040 = t325 * t1404;
  t5044 = 0.217728e6 * t1541 * t2759 + 0.145152e6 * t1545 * t2756 + 0.290304e6 * t1545 * t2759 + 0.108864e6 * t1541 * t2747 + 0.108864e6 * t828 * t1549 * t2746 + 0.36288e5 * t828 * t830 * t2307 * t224 * t12 - 0.108e3 * t821 * t822 * t4440 * t377 - 0.10752e5 * t323 * t808 * t604 * t833 + 0.48384e5 * t706 * t2734 * t833 - 0.217728e6 * t1555 * t2888 * t2892 - 0.217728e6 * t2897 * t2893 - 0.72576e5 * t1555 * t1557 * t819 * t2521 - 0.217728e6 * t1553 * t5040 * t1559;
  t5060 = t772 * t1414;
  t5081 = 0.1e1 / t1157;
  t5098 = -0.435456e6 * t2885 * t2889 - 0.217728e6 * t2885 * t2893 - 0.435456e6 * t2897 * t2889 - 0.217728e6 * t1555 * t1556 * t1283 * t1558 - 0.486e3 * t1535 * t2861 * t2880 - 0.486e3 * t1535 * t1536 * t5060 * t1415 - 0.435456e6 * t2896 * t2884 * t1559 + 0.653184e6 * t2897 * t2876 + 0.653184e6 * t2885 * t2876 + 0.653184e6 * t1555 * t2873 * t697 * t2875 - t4679 * t4680 * t2116 * t28 * t1519 / 0.24e2 + 0.3e1 / 0.4e1 * t2693 * t2694 * t5081 * t6 * t1519 + 0.56e2 / 0.3e1 * t4677 * t322 * t158 * t2116 * t368 * t2821 * t314 * t1811 * t93 * t4701 * t819;
  t5155 = 0.81e2 / 0.2e1 * t2842 * t607 * t2843 * t1438 + 0.81e2 / 0.2e1 * t1446 * t1447 * t716 * t224 * t2845 - 0.36288e5 * t2831 * t2833 * t2834 * t12 * t1437 - 0.9e1 / 0.4e1 * t2850 * t2810 + 0.81e2 * t2842 * t607 * t158 * t772 * t794 - 0.9e1 / 0.4e1 * t2850 * t2814 + 0.1008e4 * t2818 * t2819 * t772 * t2821 * t2827 + 0.108864e6 * t1568 * t1569 * t2873 * t2833 * t2834 * t12 * t1415 - 0.81e2 * t2842 * t607 * t2843 * t1416 + 0.81e2 * t2842 * t1165 * t2844 + 0.1008e4 * t2659 * t705 * t158 * t2822 * t2827 - 0.36288e5 * t1568 * t2798 * t1556 * t2837 - 0.336e3 * t2818 * t5081 * t368 * t2821 * t2827;
  t5201 = -0.72576e5 * t1568 * t2803 * t1556 * t2837 - 0.72576e5 * t2831 * t697 * params->ax * t4 * t2836 + 0.1008e4 * t2823 * t697 * t843 * t69 * t2826 - 0.72576e5 * t2793 * t2830 * t2837 - 0.324e3 * t821 * t822 * t4465 * t377 + 0.145152e6 * t1545 * t2747 + 0.24e2 * t821 * t822 * t4433 * t377 - 0.108e3 * t821 * t1522 * t2741 - 0.81e2 / 0.2e1 * t2785 * t2814 - 0.81e2 / 0.2e1 * t2785 * t2810 - 0.5376e4 * t1568 * t1318 * t368 * t780 * t1574 + 0.18144e5 * t2800 * t2789 + 0.18144e5 * t2793 * t2799 * t1574;
  t5225 = t793 * t1437;
  t5253 = 0.36288e5 * t2793 * t2804 * t1574 + 0.36288e5 * t2794 * t2789 + 0.36288e5 * t2805 * t2789 + 0.18144e5 * t1571 * t1420 * params->ax * t1573 - 0.81e2 / 0.2e1 * t1515 * t1516 * t1517 * t1405 - 0.81e2 / 0.2e1 * t1515 * t1516 * t4884 * t378 - 0.81e2 * t1515 * t1516 * t2808 * t773 + 0.653184e6 * t1555 * t2874 * t819 * t5225 - 0.486e3 * t1535 * t1536 * t2879 * t5225 + 0.18144e5 * t1568 * t716 * t772 * t780 * t1574 + 0.18144e5 * t1568 * t227 * t1404 * t780 * t1574 + 0.18144e5 * t1444 * t1291 * t158 * t1570 * t1574 + 0.12e2 * t1446 * t1447 * t1318 * t1519;
  tv4rho3sigma11 = my_piecewise3(t217, 0, t4918 + t4963 + t5003 + t5044 + t5098 + t5155 + t5201 + t5253);

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 11] += tv4rho3sigma11;

  t5270 = t1581 * t597;
  t5291 = t4 * t6;
  t5348 = -0.839808e6 * t1579 * t1580 * t2904 * t145 * t1490 * t1120 * t500 * t597 + 0.564350976e9 * t154 * t158 * t581 * t2018 * t1578 * t145 * t1580 * t5270 * t500 + 0.31352832e8 * t1504 * t1505 * t2938 * t1593 * t5270 * t2908 - 0.20901888e8 * t2950 * t145 * t1580 * t1581 * t500 * t2908 + 0.46656e5 * t2903 * t2904 * t1451 * t1505 * t583 * params->ax * t5291 * t15 * t500 - 0.46656e5 * t2906 * t1505 * t1120 * params->ax * t5291 * t15 * t597 - 0.559872e6 * t1584 * t1586 * t17 * t2925 - 0.419904e6 * t1584 * t2924 * t4659 * t597 - 0.209952e6 * t1584 * t2924 * t2700 * t1145 + 0.419904e6 * t1584 * t1472 * t1484 * t500 + 0.209952e6 * t1584 * t1472 * t811 * t990 + 0.629856e6 * t1584 * t2924 * t4651 * t1121 - 0.94058496e8 * t1591 * t2944 * t1582 * t990 + 0.282175488e9 * t2935 * t2941 - 0.188116992e9 * t2935 * t2946 + 0.141087744e9 * t1591 * t2939 * t1582 * t1145 + 0.282175488e9 * t2929 * t2941 - 0.188116992e9 * t2929 * t2946 + 0.376233984e9 * t2932 * t2941 - 0.250822656e9 * t2932 * t2946;
  t5358 = t500 * t500;
  t5409 = t1137 * t28 * t847;
  t5416 = t2659 * t1578;
  t5429 = -0.564350976e9 * t1591 * t3641 * t1578 * t1585 * t1582 * t1121 + 0.559872e6 * t1584 * t2721 * t2912 + 0.209952e6 * t1584 * t5358 * t158 * t1587 - 0.47029248e8 * t154 * t4606 * t1595 + 0.279936e6 * t1584 * t1586 * t2081 * t583 + 0.104976e6 * t1584 * t1586 * t2067 * t583 - 0.47029248e8 * t999 * t1490 * t1595 - 0.94058496e8 * t509 * t2709 * t1595 - 0.125411328e9 * t154 * t4577 * t1595 - 0.94058496e8 * t1591 * t1592 * t5358 * t1580 * t1581 - 0.125411328e9 * t509 * t2705 * t1595 - 0.20901888e8 * t154 * t4610 * t1595 + 0.46656e5 * t1584 * t1586 * t2077 * t583 - 0.5225472e7 * t1504 * t2649 * t1592 * t2951 - 0.10450944e8 * t1504 * t2654 * t1592 * t2951 - 0.580608e6 * t2661 * t2663 * t1592 * t1594 * t5409 + 0.23328e5 * t2906 * t2655 * t2908 + 0.1296e4 * t5416 * t1580 * t2905 * t2663 * t583 * t5409 - 0.10450944e8 * t2641 * t2949 * t2951 + 0.11664e5 * t2906 * t2650 * t2908;
  tv4rho2sigma20 = my_piecewise3(t1, 0, t5348 + t5429);

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 5] += tv4rho2sigma25;

  tv4rho2sigma26 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 16] += tv4rho2sigma216;

  t5436 = t1581 * t793;
  t5526 = 0.564350976e9 * t323 * t158 * t778 * t2483 * t1578 * t314 * t1599 * t5436 * t697 - 0.839808e6 * t1579 * t1599 * t2904 * t314 * t1554 * t1414 * t697 * t793 + 0.46656e5 * t2955 * t2904 * t1517 * t1569 * t780 * params->ax * t5291 * t15 * t697 - 0.46656e5 * t2957 * t1569 * t1414 * params->ax * t5291 * t15 * t793 + 0.31352832e8 * t1568 * t1569 * t2987 * t1611 * t5436 * t2908 - 0.20901888e8 * t2999 * t314 * t1599 * t1581 * t697 * t2908 + 0.376233984e9 * t2981 * t2990 - 0.250822656e9 * t2981 * t2995 - 0.559872e6 * t1602 * t1604 * t218 * t2974 - 0.419904e6 * t1602 * t2973 * t5060 * t793 - 0.209952e6 * t1602 * t2973 * t2879 * t1437 + 0.419904e6 * t1602 * t1536 * t1548 * t697 + 0.209952e6 * t1602 * t1536 * t829 * t1283 - 0.564350976e9 * t1609 * t4342 * t1578 * t1603 * t1600 * t1415 + 0.629856e6 * t1602 * t2973 * t4932 * t1415 + 0.559872e6 * t1602 * t2865 * t2961 - 0.94058496e8 * t1609 * t2993 * t1600 * t1283 + 0.282175488e9 * t2984 * t2990 - 0.188116992e9 * t2984 * t2995 + 0.141087744e9 * t1609 * t2988 * t1600 * t1437;
  t5551 = t697 * t697;
  t5599 = 0.282175488e9 * t2978 * t2990 - 0.188116992e9 * t2978 * t2995 - 0.47029248e8 * t1292 * t1554 * t1613 - 0.94058496e8 * t706 * t2884 * t1613 - 0.125411328e9 * t323 * t4914 * t1613 - 0.47029248e8 * t323 * t5040 * t1613 + 0.279936e6 * t1602 * t1604 * t2540 * t780 + 0.104976e6 * t1602 * t1604 * t2529 * t780 - 0.94058496e8 * t1609 * t1610 * t5551 * t1599 * t1581 - 0.125411328e9 * t706 * t2853 * t1613 - 0.20901888e8 * t323 * t4869 * t1613 + 0.46656e5 * t1602 * t1604 * t2536 * t780 + 0.209952e6 * t1602 * t5551 * t158 * t1605 - 0.10450944e8 * t1568 * t2803 * t1610 * t3000 - 0.580608e6 * t2818 * t2820 * t1610 * t1612 * t5409 + 0.23328e5 * t2957 * t2804 * t2908 + 0.1296e4 * t5416 * t1599 * t2956 * t2820 * t780 * t5409 - 0.10450944e8 * t2793 * t2998 * t3000 - 0.5225472e7 * t1568 * t2798 * t1610 * t3000 + 0.11664e5 * t2957 * t2799 * t2908;
  tv4rho2sigma217 = my_piecewise3(t217, 0, t5526 + t5599);

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 17] += tv4rho2sigma217;

  t5601 = t1444 * t3004;
  t5608 = t28 * params->ax * t1447;
  t5639 = t3006 * t6;
  t5656 = -0.22674816e8 * t5601 * t3006 * t27 * t3008 * t158 * t1505 * t1120 * t5608 - 0.408146688e9 * t3005 * t3007 * t1585 * t1490 * t1120 * t6 * t500 - 0.181398528e9 * t3010 * t513 * t3011 - 0.136048896e9 * t3010 * t159 * t4659 * t6 + 0.408146688e9 * t3010 * t1490 * t2018 * t6 * t597 + 0.60949905408e11 * t2929 * t3018 + 0.81266540544e11 * t2932 * t3018 + 0.60949905408e11 * t2935 * t3018 - 0.243799621632e12 * t1591 * t3641 * t3004 * t3008 * t5639 * t597 + 0.182849716224e12 * t1591 * t3015 * t1585 * t5639 * t500 + 0.10158317568e11 * t1504 * t1505 * t2018 * t3004 * t3008 * t3006 * t5608;
  tv4rhosigma30 = my_piecewise3(t1, 0, t5656);

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 18] += tv4rhosigma318;

  t5692 = t3022 * t6;
  t5709 = -0.22674816e8 * t5601 * t3022 * t27 * t3024 * t158 * t1569 * t1414 * t5608 - 0.408146688e9 * t3005 * t3023 * t1603 * t1554 * t1414 * t6 * t697 - 0.181398528e9 * t3026 * t710 * t3027 - 0.136048896e9 * t3026 * t325 * t5060 * t6 + 0.408146688e9 * t3026 * t1554 * t2483 * t6 * t793 + 0.60949905408e11 * t2978 * t3034 + 0.81266540544e11 * t2981 * t3034 + 0.60949905408e11 * t2984 * t3034 - 0.243799621632e12 * t1609 * t4342 * t3004 * t3024 * t5692 * t793 + 0.182849716224e12 * t1609 * t3031 * t1603 * t5692 * t697 + 0.10158317568e11 * t1568 * t1569 * t2483 * t3004 * t3024 * t3022 * t5608;
  tv4rhosigma319 = my_piecewise3(t217, 0, t5709);

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 19] += tv4rhosigma319;

  t5710 = t1578 * t1578;
  t5711 = t3 * t5710;
  t5712 = t1580 * t1580;
  t5714 = t1585 * t1585;
  tv4sigma40 = my_piecewise3(t1, 0, 0.117546246144e12 * t5711 * t5712 * t27 * t5714 * t1490 * t2018 * t28 * t12 - 0.52660718272512e14 * t1591 * t3641 * t5710 * t5714 * t5712 * t28 * t12);

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 13] += tv4sigma413;

  t5730 = t1599 * t1599;
  t5732 = t1603 * t1603;
  tv4sigma414 = my_piecewise3(t217, 0, 0.117546246144e12 * t5711 * t5730 * t27 * t5732 * t1554 * t2483 * t28 * t12 - 0.52660718272512e14 * t1609 * t4342 * t5710 * t5732 * t5730 * t28 * t12);

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 14] += tv4sigma414;

}

#endif

