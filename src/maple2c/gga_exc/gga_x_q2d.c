/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_q2d.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;

  double t405, t406, t414, t420, t421, t425, t426, t427;
  double t428, t429, t430, t435, t440, t442, t443, t444;
  double t445, t447, t452, t459, t460, t465, t467, t472;
  double t475, t476, t477, t478, t482, t483, t486, t490;
  double t491, t493, t494, t502, t509, t514, t518, t526;
  double t529, t530, t531, t532, t533, t534, t535, t540;
  double tv3rho30, t552, t556, t560, t564, t566, t567, t577;
  double t579, t582, t588, t597, t600, t602, t613, t618;
  double t622, t635, t639, t645, t646, t647, t651, t652;
  double tv3rho2sigma0, t659, t667, t668, t672, t674, t680, t684;
  double t687, t690, t699, t700, t709, t714, t721, t725;
  double t732, t738, t739, t741, t751, t752, tv3rhosigma20, t762;
  double t764, t769, t774, t781, t782, t786, t788, t794;
  double t795, t796, t800, t805, t809, t818, t819, t820;
  double t824, t832, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t405 = 0.1e1 / t30 / t214;
  t406 = t405 * t68;
  t414 = t192 * t123;
  t420 = 0.1e1 / t30 / t263 / t29;
  t421 = t420 * t68;
  t425 = t89 * t89;
  t426 = 0.1e1 / t425;
  t427 = t426 * t71;
  t428 = t74 * t93;
  t429 = 0.1e1 / t428;
  t430 = t72 * t429;
  t435 = 0.1e1 / t19 / t74;
  t440 = t198 * t20;
  t442 = 0.1e1 / t23 / t70;
  t443 = t440 * t442;
  t444 = t270 * t27;
  t445 = t74 * t47;
  t447 = 0.1e1 / t30 / t445;
  t452 = 0.1e1 / t30 / t47;
  t459 = t198 * t71;
  t460 = t459 * t270;
  t465 = t198 * t270;
  t467 = t25 * t27;
  t472 = t45 * t435;
  t475 = sqrt(t62);
  t476 = t475 * t65;
  t477 = t233 * t235;
  t478 = 0.1e1 / t168;
  t482 = t225 * t40;
  t483 = t482 * t42;
  t486 = t27 * t452;
  t490 = t225 * t233;
  t491 = t490 * t44;
  t493 = t55 * t26;
  t494 = t435 * t40 * t493;
  t502 = t26 / t19 / t46;
  t509 = -0.24026582651905124202e-3 * t427 * t430 * t53 + 0.5351921285711866416e-2 * t200 * t45 * t435 * t53 - 0.54059810966786529454e-4 * t443 * t444 * t447 - 0.15172696844993141289e0 * t92 * t28 * t452 * t53 + 0.26929894833104709648e-1 * t213 * t430 - 0.54059810966786529454e-4 * t460 * t447 * t20 * t159 - 0.55497706007662012573e-6 * t465 * t447 * t467 + 0.33040559271661579186e-3 * t219 * t429 + 0.209e3 / 0.243e3 * t101 * t472 - 0.19522457852348095642e0 * t476 * t477 * t478 - 0.18076349863285273743e-2 * t483 * t472 - 0.5694050206934861229e-1 * t227 * t228 * t486 - 0.36152699726570547486e-2 * t491 * t494 - 0.97612289261740478213e-2 * t234 * t235 * t478 - 0.3163361226074922905e-2 * t110 * t111 * t502 - 0.16569987374678167598e-3 * t119 * t28 * t452;
  t514 = t133 * t249;
  t518 = t266 * t123;
  t526 = t3 / t4 / t258 / t70 * t17;
  t529 = 0.1e1 / t30 / t263 / t214;
  t530 = t529 * t68;
  t531 = t135 * t135;
  t532 = 0.1e1 / t531;
  t533 = t270 * t270;
  t534 = t533 * sigma[0];
  t535 = t532 * t534;
  t540 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t32 * t68 * t79 + t18 * t181 * t123 * t79 / 0.4e1 - 0.241e3 / 0.576e3 * t131 * t406 * t137 - 0.3e1 / 0.8e1 * t18 * t84 * t249 * t79 + 0.25e2 / 0.192e3 * t131 * t414 * t137 + 0.13e2 / 0.3456e4 * t262 * t421 * t272 - 0.3e1 / 0.8e1 * t18 * t19 * t509 * t79 - t131 * t514 * t137 / 0.64e2 - t262 * t518 * t272 / 0.2304e4 - t526 * t530 * t535 / 0.165888e6);
  tv3rho30 = 0.2e1 * rho[0] * t540 + 0.6e1 * t277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t552 = t192 * t163;
  t556 = t215 * t53;
  t560 = t26 * t202;
  t564 = t74 * t46;
  t566 = 0.1e1 / t30 / t564;
  t567 = t27 * t566;
  t577 = t459 * t566;
  t579 = t72 * t20 * t159;
  t582 = t198 * t72;
  t588 = t149 * t202;
  t597 = t159 * t208;
  t600 = t490 * sigma[0];
  t602 = t202 * t40 * t493;
  t613 = 0.90099684944644215758e-4 * t427 * t556 * t44 - 0.16420667581161408322e-2 * t200 * t560 * t285 + 0.20272429112544948546e-4 * t443 * t567 * t72 + 0.32512921810699588478e-1 * t92 * t229 * t53 - 0.8620850480109739369e-2 * t213 * t215 * t44 + 0.20272429112544948546e-4 * t577 * t579 + 0.20811639752873254715e-6 * t582 * t566 * t467 - 0.10873041188888631926e-3 * t297 * t215 - 0.19e2 / 0.81e2 * t101 * t588 + 0.73209216946305358656e-1 * t476 * t233 * t236 * t57 + 0.67786311987319776533e-3 * t483 * t588 + 0.1525192019714694972e-1 * t227 * t597 + 0.13557262397463955307e-2 * t600 * t602 + 0.28470251034674306144e-2 * t234 * t57 * t236 + 0.47450418391123843573e-3 * t110 * t154 * t242 + 0.35507115802881787709e-4 * t118 * t597;
  t618 = t133 * t315;
  t622 = t266 * t163;
  t635 = t170 * t249;
  t639 = t332 * t123;
  t645 = 0.1e1 / t30 / t263 / t190;
  t646 = t645 * t68;
  t647 = t532 * t533;
  t651 = t18 * t181 * t163 * t79 / 0.12e2 - t18 * t84 * t315 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t552 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t613 * t79 - t131 * t618 * t137 / 0.96e2 - t262 * t622 * t272 / 0.6912e4 + 0.299e3 / 0.2304e4 * t131 * t193 * t172 - 0.23e2 / 0.768e3 * t131 * t254 * t172 - 0.73e2 / 0.55296e5 * t262 * t267 * t335 + t131 * t635 * t172 / 0.512e3 + t262 * t639 * t335 / 0.9216e4 + t526 * t646 * t647 / 0.442368e6;
  t652 = my_piecewise3(t2, 0, t651);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t652 + 0.4e1 * t340;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t659 = t293 * t53;
  t667 = 0.1e1 / t30 / t428;
  t668 = t27 * t667;
  t672 = t459 * t667;
  t674 = t44 * t20 * t159;
  t680 = t198 * t667;
  t684 = t90 * t293;
  t687 = t353 * t104;
  t690 = t233 * t153;
  t699 = t490 * t104;
  t700 = t56 * t26;
  t709 = -0.3378738185424158091e-4 * t427 * t659 * sigma[0] + 0.36490372402580907382e-3 * t200 * t284 * t53 - 0.76021609172043557047e-5 * t443 * t668 * t44 - 0.76021609172043557045e-5 * t672 * t674 + 0.22167901234567901234e-2 * t213 * t293 * sigma[0] - 0.78043649073274705177e-7 * t680 * t44 * t467 + 0.30343370759689205374e-4 * t684 * sigma[0] + t100 * t687 / 0.27e2 - 0.27453456354864509496e-1 * t476 * t690 * t306 - 0.254198669952449162e-3 * t482 * t687 - 0.1525192019714694972e-2 * t227 * t358 * t289 - 0.50839733990489832399e-3 * t699 * t700 - 0.508397339904898324e-3 * t234 * t306 * t153 + 0.1016794679809796648e-3 * t110 * t367 * t114;
  t714 = t133 * t371;
  t721 = t170 * t315;
  t725 = t332 * t163;
  t732 = t382 * t123;
  t738 = 0.1e1 / t30 / t263 / t74;
  t739 = t738 * t68;
  t741 = t532 * t270 * t72;
  t751 = -t18 * t84 * t371 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t709 * t79 - t131 * t714 * t137 / 0.192e3 - 0.23e2 / 0.768e3 * t131 * t320 * t172 + t131 * t721 * t172 / 0.256e3 + t262 * t725 * t335 / 0.9216e4 + 0.7e1 / 0.16384e5 * t262 * t333 * t384 - t262 * t732 * t384 / 0.49152e5 - t526 * t739 * t741 / 0.1179648e7 - 0.23e2 / 0.768e3 * t131 * t134 * t388 + t131 * t327 * t388 / 0.256e3;
  t752 = my_piecewise3(t2, 0, t751);
  tv3rhosigma20 = 0.2e1 * rho[0] * t752 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t762 = t459 * t405;
  t764 = sigma[0] * t20 * t159;
  t769 = t198 * t405;
  t774 = t233 * t366;
  t781 = 0.1e1 / t44;
  t782 = t24 * t781;
  t786 = t490 * t49;
  t788 = t357 * t40 * t493;
  t794 = t57 * t44;
  t795 = 0.1e1 / t794;
  t796 = t55 * t795;
  t800 = 0.12670268195340592841e-4 * t427 * t75 * t53 + 0.28508103439516333893e-5 * t443 * t27 * t405 * sigma[0] + 0.28508103439516333892e-5 * t762 * t764 - 0.27709876543209876543e-3 * t213 * t75 + 0.29266368402478014441e-7 * t769 * sigma[0] * t467 - 0.56893820174417260074e-5 * t350 + 0.10295046133074191061e-1 * t476 * t774 * t362 + 0.9532450123216843575e-4 * t483 * t343 * t357 - 0.17158410221790318435e-2 * t227 * t782 * t145 + 0.1906490024643368715e-3 * t786 * t788 - 0.1143894014786021229e-3 * t234 * t362 * t366 + 0.1143894014786021229e-3 * t110 * t796 * t155;
  t805 = t170 * t371;
  t809 = t382 * t163;
  t818 = 0.1e1 / t30 / t263 / t168;
  t819 = t818 * t68;
  t820 = t532 * t271;
  t824 = t269 * t72;
  t832 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t800 * t79 + 0.3e1 / 0.512e3 * t131 * t805 * t172 - t262 * t809 * t384 / 0.16384e5 + 0.3e1 / 0.256e3 * t131 * t376 * t388 + t526 * t819 * t820 / 0.3145728e7 - t262 * t383 * t824 / 0.8192e4 + t131 * t171 * t136 / 0.256e3);
  tv3sigma30 = 0.2e1 * rho[0] * t832;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;

  double t405, t406, t414, t420, t421, t425, t426, t427;
  double t428, t429, t430, t435, t440, t442, t443, t444;
  double t445, t447, t452, t459, t460, t465, t467, t472;
  double t475, t476, t477, t478, t482, t483, t486, t490;
  double t491, t493, t494, t502, t509, t514, t518, t526;
  double t529, t530, t531, t532, t533, t534, t535, t540;
  double tv3rho30, t552, t556, t560, t564, t566, t567, t577;
  double t579, t582, t588, t597, t600, t602, t613, t618;
  double t622, t635, t639, t645, t646, t647, t651, t652;
  double tv3rho2sigma0, t659, t667, t668, t672, t674, t680, t684;
  double t687, t690, t699, t700, t709, t714, t721, t725;
  double t732, t738, t739, t741, t751, t752, tv3rhosigma20, t762;
  double t764, t769, t774, t781, t782, t786, t788, t794;
  double t795, t796, t800, t805, t809, t818, t819, t820;
  double t824, t832, tv3sigma30;

  double t839, t843, t844, t850, t865, t869, t871, t880;
  double t881, t884, t885, t886, t893, t894, t901, t911;
  double t916, t919, t925, t939, t940, t944, t947, t966;
  double t970, t973, t1025, t1026, tv4rho40, t1086, t1089, t1096;
  double t1100, t1125, t1168, t1193, t1194, tv4rho3sigma0, t1266, t1290;
  double t1335, t1354, t1356, tv4rho2sigma20, t1364, t1423, t1486, t1487;
  double tv4rhosigma30, t1508, t1552, t1595, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t405 = 0.1e1 / t30 / t214;
  t406 = t405 * t68;
  t414 = t192 * t123;
  t420 = 0.1e1 / t30 / t263 / t29;
  t421 = t420 * t68;
  t425 = t89 * t89;
  t426 = 0.1e1 / t425;
  t427 = t426 * t71;
  t428 = t74 * t93;
  t429 = 0.1e1 / t428;
  t430 = t72 * t429;
  t435 = 0.1e1 / t19 / t74;
  t440 = t198 * t20;
  t442 = 0.1e1 / t23 / t70;
  t443 = t440 * t442;
  t444 = t270 * t27;
  t445 = t74 * t47;
  t447 = 0.1e1 / t30 / t445;
  t452 = 0.1e1 / t30 / t47;
  t459 = t198 * t71;
  t460 = t459 * t270;
  t465 = t198 * t270;
  t467 = t25 * t27;
  t472 = t45 * t435;
  t475 = sqrt(t62);
  t476 = t475 * t65;
  t477 = t233 * t235;
  t478 = 0.1e1 / t168;
  t482 = t225 * t40;
  t483 = t482 * t42;
  t486 = t27 * t452;
  t490 = t225 * t233;
  t491 = t490 * t44;
  t493 = t55 * t26;
  t494 = t435 * t40 * t493;
  t502 = t26 / t19 / t46;
  t509 = -0.24026582651905124202e-3 * t427 * t430 * t53 + 0.5351921285711866416e-2 * t200 * t45 * t435 * t53 - 0.54059810966786529454e-4 * t443 * t444 * t447 - 0.15172696844993141289e0 * t92 * t28 * t452 * t53 + 0.26929894833104709648e-1 * t213 * t430 - 0.54059810966786529454e-4 * t460 * t447 * t20 * t159 - 0.55497706007662012573e-6 * t465 * t447 * t467 + 0.33040559271661579186e-3 * t219 * t429 + 0.209e3 / 0.243e3 * t101 * t472 - 0.19522457852348095642e0 * t476 * t477 * t478 - 0.18076349863285273743e-2 * t483 * t472 - 0.5694050206934861229e-1 * t227 * t228 * t486 - 0.36152699726570547486e-2 * t491 * t494 - 0.97612289261740478213e-2 * t234 * t235 * t478 - 0.3163361226074922905e-2 * t110 * t111 * t502 - 0.16569987374678167598e-3 * t119 * t28 * t452;
  t514 = t133 * t249;
  t518 = t266 * t123;
  t526 = t3 / t4 / t258 / t70 * t17;
  t529 = 0.1e1 / t30 / t263 / t214;
  t530 = t529 * t68;
  t531 = t135 * t135;
  t532 = 0.1e1 / t531;
  t533 = t270 * t270;
  t534 = t533 * sigma[0];
  t535 = t532 * t534;
  t540 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t32 * t68 * t79 + t18 * t181 * t123 * t79 / 0.4e1 - 0.241e3 / 0.576e3 * t131 * t406 * t137 - 0.3e1 / 0.8e1 * t18 * t84 * t249 * t79 + 0.25e2 / 0.192e3 * t131 * t414 * t137 + 0.13e2 / 0.3456e4 * t262 * t421 * t272 - 0.3e1 / 0.8e1 * t18 * t19 * t509 * t79 - t131 * t514 * t137 / 0.64e2 - t262 * t518 * t272 / 0.2304e4 - t526 * t530 * t535 / 0.165888e6);
  tv3rho30 = 0.2e1 * rho[0] * t540 + 0.6e1 * t277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t552 = t192 * t163;
  t556 = t215 * t53;
  t560 = t26 * t202;
  t564 = t74 * t46;
  t566 = 0.1e1 / t30 / t564;
  t567 = t27 * t566;
  t577 = t459 * t566;
  t579 = t72 * t20 * t159;
  t582 = t198 * t72;
  t588 = t149 * t202;
  t597 = t159 * t208;
  t600 = t490 * sigma[0];
  t602 = t202 * t40 * t493;
  t613 = 0.90099684944644215758e-4 * t427 * t556 * t44 - 0.16420667581161408322e-2 * t200 * t560 * t285 + 0.20272429112544948546e-4 * t443 * t567 * t72 + 0.32512921810699588478e-1 * t92 * t229 * t53 - 0.8620850480109739369e-2 * t213 * t215 * t44 + 0.20272429112544948546e-4 * t577 * t579 + 0.20811639752873254715e-6 * t582 * t566 * t467 - 0.10873041188888631926e-3 * t297 * t215 - 0.19e2 / 0.81e2 * t101 * t588 + 0.73209216946305358656e-1 * t476 * t233 * t236 * t57 + 0.67786311987319776533e-3 * t483 * t588 + 0.1525192019714694972e-1 * t227 * t597 + 0.13557262397463955307e-2 * t600 * t602 + 0.28470251034674306144e-2 * t234 * t57 * t236 + 0.47450418391123843573e-3 * t110 * t154 * t242 + 0.35507115802881787709e-4 * t118 * t597;
  t618 = t133 * t315;
  t622 = t266 * t163;
  t635 = t170 * t249;
  t639 = t332 * t123;
  t645 = 0.1e1 / t30 / t263 / t190;
  t646 = t645 * t68;
  t647 = t532 * t533;
  t651 = t18 * t181 * t163 * t79 / 0.12e2 - t18 * t84 * t315 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t552 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t613 * t79 - t131 * t618 * t137 / 0.96e2 - t262 * t622 * t272 / 0.6912e4 + 0.299e3 / 0.2304e4 * t131 * t193 * t172 - 0.23e2 / 0.768e3 * t131 * t254 * t172 - 0.73e2 / 0.55296e5 * t262 * t267 * t335 + t131 * t635 * t172 / 0.512e3 + t262 * t639 * t335 / 0.9216e4 + t526 * t646 * t647 / 0.442368e6;
  t652 = my_piecewise3(t2, 0, t651);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t652 + 0.4e1 * t340;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t659 = t293 * t53;
  t667 = 0.1e1 / t30 / t428;
  t668 = t27 * t667;
  t672 = t459 * t667;
  t674 = t44 * t20 * t159;
  t680 = t198 * t667;
  t684 = t90 * t293;
  t687 = t353 * t104;
  t690 = t233 * t153;
  t699 = t490 * t104;
  t700 = t56 * t26;
  t709 = -0.3378738185424158091e-4 * t427 * t659 * sigma[0] + 0.36490372402580907382e-3 * t200 * t284 * t53 - 0.76021609172043557047e-5 * t443 * t668 * t44 - 0.76021609172043557045e-5 * t672 * t674 + 0.22167901234567901234e-2 * t213 * t293 * sigma[0] - 0.78043649073274705177e-7 * t680 * t44 * t467 + 0.30343370759689205374e-4 * t684 * sigma[0] + t100 * t687 / 0.27e2 - 0.27453456354864509496e-1 * t476 * t690 * t306 - 0.254198669952449162e-3 * t482 * t687 - 0.1525192019714694972e-2 * t227 * t358 * t289 - 0.50839733990489832399e-3 * t699 * t700 - 0.508397339904898324e-3 * t234 * t306 * t153 + 0.1016794679809796648e-3 * t110 * t367 * t114;
  t714 = t133 * t371;
  t721 = t170 * t315;
  t725 = t332 * t163;
  t732 = t382 * t123;
  t738 = 0.1e1 / t30 / t263 / t74;
  t739 = t738 * t68;
  t741 = t532 * t270 * t72;
  t751 = -t18 * t84 * t371 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t709 * t79 - t131 * t714 * t137 / 0.192e3 - 0.23e2 / 0.768e3 * t131 * t320 * t172 + t131 * t721 * t172 / 0.256e3 + t262 * t725 * t335 / 0.9216e4 + 0.7e1 / 0.16384e5 * t262 * t333 * t384 - t262 * t732 * t384 / 0.49152e5 - t526 * t739 * t741 / 0.1179648e7 - 0.23e2 / 0.768e3 * t131 * t134 * t388 + t131 * t327 * t388 / 0.256e3;
  t752 = my_piecewise3(t2, 0, t751);
  tv3rhosigma20 = 0.2e1 * rho[0] * t752 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t762 = t459 * t405;
  t764 = sigma[0] * t20 * t159;
  t769 = t198 * t405;
  t774 = t233 * t366;
  t781 = 0.1e1 / t44;
  t782 = t24 * t781;
  t786 = t490 * t49;
  t788 = t357 * t40 * t493;
  t794 = t57 * t44;
  t795 = 0.1e1 / t794;
  t796 = t55 * t795;
  t800 = 0.12670268195340592841e-4 * t427 * t75 * t53 + 0.28508103439516333893e-5 * t443 * t27 * t405 * sigma[0] + 0.28508103439516333892e-5 * t762 * t764 - 0.27709876543209876543e-3 * t213 * t75 + 0.29266368402478014441e-7 * t769 * sigma[0] * t467 - 0.56893820174417260074e-5 * t350 + 0.10295046133074191061e-1 * t476 * t774 * t362 + 0.9532450123216843575e-4 * t483 * t343 * t357 - 0.17158410221790318435e-2 * t227 * t782 * t145 + 0.1906490024643368715e-3 * t786 * t788 - 0.1143894014786021229e-3 * t234 * t362 * t366 + 0.1143894014786021229e-3 * t110 * t796 * t155;
  t805 = t170 * t371;
  t809 = t382 * t163;
  t818 = 0.1e1 / t30 / t263 / t168;
  t819 = t818 * t68;
  t820 = t532 * t271;
  t824 = t269 * t72;
  t832 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t800 * t79 + 0.3e1 / 0.512e3 * t131 * t805 * t172 - t262 * t809 * t384 / 0.16384e5 + 0.3e1 / 0.256e3 * t131 * t376 * t388 + t526 * t819 * t820 / 0.3145728e7 - t262 * t383 * t824 / 0.8192e4 + t131 * t171 * t136 / 0.256e3);
  tv3sigma30 = 0.2e1 * rho[0] * t832;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t839 = t258 * t258;
  t843 = t3 / t4 / t839 * t17;
  t844 = t263 * t263;
  t850 = 0.1e1 / t531 / t78;
  t865 = 0.1e1 / t30 / t102;
  t869 = t74 * t102;
  t871 = 0.1e1 / t30 / t869;
  t880 = 0.1e1 / t19 / t190;
  t881 = t45 * t880;
  t884 = t475 * t20;
  t885 = t884 * t24;
  t886 = t794 * t27;
  t893 = 0.1e1 / t564;
  t894 = t72 * t893;
  t901 = t884 / t23 / t21;
  t911 = 0.93896595123176283055e-3 * t119 * t28 * t865 + 0.14776348330921651384e-2 * t460 * t871 * t20 * t159 + 0.16649311802298603772e-4 * t465 * t871 * t467 - 0.5225e4 / 0.729e3 * t101 * t881 + 0.65074859507826985474e-1 * t885 * t886 * t405 * t233 + 0.27717069790370753072e-1 * t483 * t881 - 0.32994594726413656455e0 * t213 * t894 - 0.45739821848864839214e-2 * t219 * t893 + 0.21691619835942328492e-1 * t901 * t886 * t405 + 0.52858481834191273244e-2 * t427 * t894 * t53 + 0.13334753371807343932e-2 * t443 * t444 * t871;
  t916 = t426 * t40 / t22 / t70 / t21;
  t919 = 0.1e1 / t19 / t264;
  t925 = t43 * t26;
  t939 = 0.1e1/sqrt(t62);
  t940 = t939 * t65;
  t944 = t880 * t40 * t493;
  t947 = t27 * t865;
  t966 = 0.1e1 / t425 / t36 * t71;
  t970 = t53 * t20 * t159;
  t973 = -0.44493671577602081855e-5 * t916 * t334 * t26 * t919 - 0.45677124286141574134e-7 * t426 * t334 * t919 * t925 + 0.27331440993287333899e1 * t476 * t477 * t75 + 0.81825610381138005811e-1 * t234 * t235 * t75 - 0.88987343155204163711e-5 * t427 * t334 * t919 * t40 * t353 + 0.13014971901565397095e0 * t940 * t233 * t44 * t944 + 0.38593006958114059441e0 * t227 * t228 * t947 + 0.62664679526055615642e-1 * t491 * t944 + 0.13707898646324665922e-1 * t110 * t111 * t343 - 0.52924554936484012336e-1 * t200 * t45 * t880 * t53 + 0.85978615454961133971e0 * t92 * t28 * t865 * t53 - 0.13183310097067283513e-4 * t966 * t270 * t871 * t970;
  t1025 = -t526 * t529 * t123 * t535 / 0.41472e5 - t843 / t30 / t844 / t93 * t68 * t850 * t533 * t270 / 0.2985984e7 - t262 * t266 * t249 * t272 / 0.1152e4 - t131 * t133 * t509 * t137 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * (t911 + t973) * t79 + t18 * t181 * t249 * t79 / 0.2e1 - t18 * t84 * t509 * t79 / 0.2e1 - 0.5e1 / 0.9e1 * t18 * t32 * t123 * t79 + 0.13e2 / 0.864e3 * t262 * t420 * t123 * t272 + 0.79e2 / 0.248832e6 * t526 / t30 / t263 / t428 * t68 * t535 + 0.25e2 / 0.96e2 * t131 * t192 * t249 * t137 - 0.1697e4 / 0.20736e5 * t262 / t30 / t263 / t93 * t68 * t272 + 0.11563e5 / 0.2592e4 * t131 * t667 * t68 * t137 - 0.241e3 / 0.144e3 * t131 * t405 * t123 * t137 + 0.1e2 / 0.27e2 * t18 * t95 * t68 * t79;
  t1026 = my_piecewise3(t2, 0, t1025);
  tv4rho40 = 0.2e1 * rho[0] * t1026 + 0.8e1 * t540;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1086 = t149 * t435;
  t1089 = t235 * t27;
  t1096 = t159 * t452;
  t1100 = 0.1e1 / t19 / t263;
  t1125 = 0.418e3 / 0.243e3 * t101 * t1086 - 0.24403072315435119552e-1 * t885 * t1089 * t192 * t233 - 0.83603118117694391058e-2 * t483 * t1086 - 0.80665711264910534075e-1 * t227 * t1096 + 0.33370253683201561392e-5 * t427 * t1100 * t43 * t270 * t26 - 0.1517269684499314129e0 * t92 * t486 * t53 - 0.49329577507192708129e-3 * t459 * t447 * t579 - 0.56191427332757787731e-5 * t582 * t447 * t467 - 0.16569987374678167598e-3 * t118 * t1096 - 0.17118940139482400994e-2 * t427 * t429 * t53 * t44 - 0.43923596410514055183e-3 * t443 * t27 * t447 * t72;
  t1168 = 0.16685126841600780696e-5 * t916 * t26 * t1100 * t270 + 0.171289216073030903e-7 * t426 * t270 * t1100 * t925 - 0.80530138640935894522e0 * t476 * t233 * t478 * t57 - 0.8134357438478373184e-2 * t901 * t1089 * t192 - 0.48806144630870239104e-1 * t940 * t233 * t435 * sigma[0] * t40 * t493 - 0.19432076103031669273e-1 * t600 * t494 - 0.15816806130374614524e-2 * t110 * t154 * t502 + 0.49437412864002313173e-5 * t966 * t447 * t53 * t579 + 0.13825796654755654908e-1 * t200 * t26 * t435 * t285 + 0.93433598536808413352e-1 * t213 * t429 * t44 + 0.13435370275262387047e-2 * t297 * t429 - 0.19703221350980948379e-1 * t234 * t57 * t478;
  t1193 = t526 * t645 * t123 * t647 / 0.147456e6 + t843 / t30 / t844 / t29 * t68 * t850 * t533 * t72 / 0.7962624e7 + t262 * t332 * t249 * t335 / 0.6144e4 - 0.73e2 / 0.18432e5 * t262 * t518 * t335 - 0.25e2 / 0.221184e6 * t526 * t530 * t647 + t131 * t170 * t509 * t172 / 0.512e3 - t526 * t529 * t163 * t535 / 0.165888e6 + 0.299e3 / 0.768e3 * t131 * t414 * t172 + 0.1489e4 / 0.55296e5 * t262 * t421 * t335 - 0.23e2 / 0.512e3 * t131 * t514 * t172 - t262 * t266 * t315 * t272 / 0.2304e4 - t131 * t133 * t613 * t137 / 0.64e2 + 0.25e2 / 0.192e3 * t131 * t192 * t315 * t137 + 0.13e2 / 0.3456e4 * t262 * t420 * t163 * t272 - 0.3e1 / 0.8e1 * t18 * t19 * (t1125 + t1168) * t79 - 0.3e1 / 0.8e1 * t18 * t84 * t613 * t79 + t18 * t181 * t315 * t79 / 0.4e1 - 0.8671e4 / 0.6912e4 * t131 * t406 * t172 - 0.5e1 / 0.36e2 * t18 * t32 * t163 * t79 - 0.241e3 / 0.576e3 * t131 * t405 * t163 * t137;
  t1194 = my_piecewise3(t2, 0, t1193);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1194 + 0.6e1 * t652;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1266 = 0.1e1 / t19 / t380;
  t1290 = t353 * t202;
  t1335 = 0.12923673559247404698e-3 * t443 * t567 * t44 - 0.62569225656002927611e-6 * t916 * t26 * t1266 * t72 - 0.64233456027386588623e-8 * t426 * t1266 * t72 * t925 - 0.19e2 / 0.81e2 * t100 * t1290 - 0.19951111111111111111e-1 * t213 * t215 * sigma[0] + 0.24064140755498520669e-2 * t234 * t236 * t153 + 0.14950916470501899552e-3 * t577 * t674 + 0.3558781379334288268e-2 * t227 * t358 * t229 - 0.23725209195561921787e-3 * t110 * t367 * t242 - 0.1853902982400086744e-5 * t966 * t566 * t53 * t674 - 0.31354816451678845554e-3 * t90 * t215 * sigma[0];
  t1354 = t131 * t170 * t613 * t172 / 0.256e3 - t262 * t266 * t371 * t272 / 0.6912e4 - 0.23e2 / 0.384e3 * t131 * t618 * t172 - t131 * t133 * t709 * t137 / 0.96e2 + t18 * t181 * t371 * t79 / 0.12e2 + 0.25e2 / 0.576e3 * t131 * t192 * t371 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * (0.49145076190806837986e-2 * t490 * t202 * t700 - 0.12513845131200585522e-5 * t427 * t1266 * t43 * t72 * t26 - 0.23110569188301241342e-2 * t200 * t560 * t53 + 0.17429748293031350823e-5 * t198 * t566 * t44 * t467 + 0.18302304236576339664e-1 * t940 * t233 * t602 + 0.91511521182881698319e-2 * t885 * t57 * t27 * t133 * t233 + 0.17387189024747522681e0 * t476 * t690 * t236 + 0.19488564696354435754e-2 * t482 * t1290 + 0.3050384039429389944e-2 * t901 * t27 * t133 * t57 + 0.48428580657746265971e-3 * t427 * t556 * sigma[0] + t1335) * t79 - t18 * t84 * t709 * t79 / 0.4e1 + 0.299e3 / 0.1152e4 * t131 * t193 * t388 - 0.1759e4 / 0.221184e6 * t262 * t267 * t384 + 0.299e3 / 0.1152e4 * t131 * t552 * t172;
  t1356 = my_piecewise3(t2, 0, t131 * t635 * t388 / 0.256e3 - t526 * t738 * t123 * t741 / 0.589824e6 - t843 / t30 / t844 / rho[0] * t68 * t850 * t533 * t44 / 0.21233664e8 - 0.23e2 / 0.384e3 * t131 * t254 * t388 + t526 * t645 * t163 * t647 / 0.221184e6 + 0.7e1 / 0.8192e4 * t262 * t639 * t384 + 0.137e3 / 0.3538944e7 * t526 * t646 * t741 - t262 * t382 * t249 * t384 / 0.49152e5 + t262 * t332 * t315 * t335 / 0.4608e4 - 0.73e2 / 0.27648e5 * t262 * t622 * t335 + t1354);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1356 + 0.4e1 * t752;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1364 = 0.1e1 / t19 / t869;
  t1423 = 0.46926919242002195707e-6 * t427 * t1364 * t43 * t45 - 0.30408643668817422819e-4 * t443 * t668 * sigma[0] - 0.46826189443964823105e-6 * t680 * sigma[0] * t467 - 0.3431682044358063687e-2 * t885 * t153 * t27 * t170 * t233 - 0.127099334976224581e-3 * t483 * t284 * t357 + 0.45515056139533808059e-4 * t684 + 0.3050384039429389944e-3 * t234 * t306 * t366 - 0.10136214556272474273e-3 * t427 * t659 - 0.1525192019714694972e-3 * t110 * t796 * t114 - 0.68633640887161273739e-2 * t940 * t233 * t357 * t104 * t40 * t493 + 0.2287788029572042458e-2 * t227 * t782 * t289 - 0.635496674881122905e-3 * t699 * t788 + 0.695213618400032529e-6 * t966 * t667 * t53 * t764 - 0.38010804586021778522e-4 * t672 * t764 - 0.1143894014786021229e-2 * t901 * t27 * t170 * t153 + 0.23463459621001097854e-6 * t916 * t26 * t1364 * t44 + 0.24087546010269970733e-8 * t426 * t1364 * t44 * t925 + 0.22167901234567901234e-2 * t213 * t293;
  t1486 = -t18 * t84 * t800 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t1423 * t79 - t131 * t133 * t800 * t137 / 0.192e3 - 0.23e2 / 0.512e3 * t131 * t714 * t172 + 0.3e1 / 0.512e3 * t131 * t170 * t709 * t172 + t262 * t332 * t371 * t335 / 0.6144e4 + 0.21e2 / 0.16384e5 * t262 * t725 * t384 - t262 * t382 * t315 * t384 / 0.16384e5 - t526 * t738 * t163 * t741 / 0.393216e6 - 0.23e2 / 0.256e3 * t131 * t320 * t388 + 0.3e1 / 0.256e3 * t131 * t721 * t388 - 0.119e3 / 0.9437184e7 * t526 * t739 * t820 + t526 * t818 * t123 * t820 / 0.3145728e7 + t843 / t30 / t844 * t68 * t850 * t534 / 0.56623104e8 + 0.149e3 / 0.73728e5 * t262 * t333 * t824 - t262 * t732 * t824 / 0.8192e4 - 0.23e2 / 0.768e3 * t131 * t134 * t136 + t131 * t327 * t136 / 0.256e3;
  t1487 = my_piecewise3(t2, 0, t1486);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1487 + 0.2e1 * t832;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1508 = 0.1e1 / t19 / t445;
  t1552 = 0.42896025554475796088e-2 * t227 * t24 / t72 * t145 - 0.33363575431258952512e-3 * t786 * t781 * t40 * t493 - 0.28597350369650530725e-3 * t110 * t55 / t57 / t72 * t155 + 0.87799105207434043324e-7 * t769 * t467 - 0.9032829753851239025e-9 * t426 * t1508 * sigma[0] * t925 - 0.30885138399222573184e-1 * t476 * t233 * t795 * t362 + 0.42896025554475796088e-3 * t901 * t947 * t366 + 0.28508103439516333893e-5 * t440 * t442 * t27 * t405 - 0.87987973578754116954e-7 * t916 * t26 * t1508 * sigma[0] + 0.57016206879032667784e-5 * t762 * t467 + 0.12868807666342738826e-2 * t885 * t947 * t774 - 0.23831125308042108937e-3 * t483 * t343 * t781 - 0.26070510690001219837e-6 * t966 * t405 * t970 - 0.1759759471575082339e-6 * t427 * t1508 * t43 * t149 + 0.2287788029572042458e-3 * t234 * t362 * t795 + 0.25737615332685477652e-2 * t940 * t233 * t781 * t49 * t40 * t493;
  t1595 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t1552 * t79 + t131 * t170 * t800 * t172 / 0.128e3 - t262 * t382 * t371 * t384 / 0.8192e4 + 0.3e1 / 0.128e3 * t131 * t805 * t388 + t526 * t818 * t163 * t820 / 0.786432e6 - t262 * t809 * t824 / 0.2048e4 + t131 * t376 * t136 / 0.64e2 - t843 / t30 / t263 / t380 * t68 * t850 * t533 / 0.150994944e9 + t526 * t819 * t532 * t334 / 0.262144e6 - 0.5e1 / 0.12288e5 * t262 * t383 * t269 * t44);
  tv4sigma40 = 0.2e1 * rho[0] * t1595;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t45, t46, t48, t49, t50, t51, t52, t54;
  double t58, t60, t61, t62, t64, t66, t67, t69;
  double t72, t73, t74, t75, t76, t78, t79, t82;
  double t83, t84, t87, t88, t89, t91, t92, t93;
  double t94, t96, t97, t98, t99, t100, t102, t104;
  double t106, t109, t110, t111, t112, t114, t118, t120;
  double t122, t124, t125, t127, t130, t131, t132, t134;
  double t135, t138, t139, t140, t143, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = -t16;
  t91 = my_piecewise5(t14, t11, t10, t15, t89 * t7);
  t92 = 0.1e1 + t91;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t96 = my_piecewise3(t93, t22, t94 * t92);
  t97 = t5 * t96;
  t98 = rho[1] * rho[1];
  t99 = POW_1_3(rho[1]);
  t100 = t99 * t99;
  t102 = 0.1e1 / t100 / t98;
  t104 = t33 * sigma[2] * t102;
  t106 = 0.804e0 + 0.5e1 / 0.972e3 * t104;
  t109 = 0.1804e1 - 0.646416e0 / t106;
  t110 = sigma[2] * sigma[2];
  t111 = t98 * t98;
  t112 = t111 * rho[1];
  t114 = 0.1e1 / t99 / t112;
  t118 = 0.1e3 - t49 * t110 * t114 / 0.576e3;
  t120 = sqrt(sigma[2]);
  t122 = 0.1e1 / t99 / rho[1];
  t124 = t61 * t120 * t122;
  t125 = pow(t124, 0.35e1);
  t127 = 0.1e1 + t104 / 0.24e2;
  t130 = t109 * t118 + 0.87153829697982569831e-4 * t125 * t127;
  t131 = t27 * t130;
  t132 = t110 * sigma[2];
  t134 = t111 * t111;
  t135 = 0.1e1 / t134;
  t138 = 0.1e3 + t75 * t132 * t135 / 0.2304e4;
  t139 = 0.1e1 / t138;
  t140 = t131 * t139;
  t143 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t140);
  tzk0 = t87 + t143;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t45, t46, t48, t49, t50, t51, t52, t54;
  double t58, t60, t61, t62, t64, t66, t67, t69;
  double t72, t73, t74, t75, t76, t78, t79, t82;
  double t83, t84, t87, t88, t89, t91, t92, t93;
  double t94, t96, t97, t98, t99, t100, t102, t104;
  double t106, t109, t110, t111, t112, t114, t118, t120;
  double t122, t124, t125, t127, t130, t131, t132, t134;
  double t135, t138, t139, t140, t143, tzk0;

  double t144, t145, t146, t148, t151, t152, t155, t156;
  double t157, t158, t160, t161, t162, t163, t164, t165;
  double t167, t172, t173, t174, t176, t180, t182, t183;
  double t185, t189, t190, t194, t195, t196, t201, t202;
  double t203, t204, t205, t206, t207, t208, t209, t210;
  double t214, t215, t217, t220, t221, t224, t225, t227;
  double t229, tvrho0, t233, t236, t237, t241, t243, t246;
  double t247, t250, t251, t252, t253, t254, t256, t261;
  double t262, t263, t265, t269, t271, t272, t274, t278;
  double t279, t283, t284, t285, t288, t289, t290, t291;
  double t292, t293, t294, t295, t296, t300, tvrho1, t303;
  double t307, t311, t312, t318, t319, t320, t323, t324;
  double t328, tvsigma0, tvsigma1, t329, t333, t337, t338, t344;
  double t345, t346, t349, t350, t354, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = -t16;
  t91 = my_piecewise5(t14, t11, t10, t15, t89 * t7);
  t92 = 0.1e1 + t91;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t96 = my_piecewise3(t93, t22, t94 * t92);
  t97 = t5 * t96;
  t98 = rho[1] * rho[1];
  t99 = POW_1_3(rho[1]);
  t100 = t99 * t99;
  t102 = 0.1e1 / t100 / t98;
  t104 = t33 * sigma[2] * t102;
  t106 = 0.804e0 + 0.5e1 / 0.972e3 * t104;
  t109 = 0.1804e1 - 0.646416e0 / t106;
  t110 = sigma[2] * sigma[2];
  t111 = t98 * t98;
  t112 = t111 * rho[1];
  t114 = 0.1e1 / t99 / t112;
  t118 = 0.1e3 - t49 * t110 * t114 / 0.576e3;
  t120 = sqrt(sigma[2]);
  t122 = 0.1e1 / t99 / rho[1];
  t124 = t61 * t120 * t122;
  t125 = pow(t124, 0.35e1);
  t127 = 0.1e1 + t104 / 0.24e2;
  t130 = t109 * t118 + 0.87153829697982569831e-4 * t125 * t127;
  t131 = t27 * t130;
  t132 = t110 * sigma[2];
  t134 = t111 * t111;
  t135 = 0.1e1 / t134;
  t138 = 0.1e3 + t75 * t132 * t135 / 0.2304e4;
  t139 = 0.1e1 / t138;
  t140 = t131 * t139;
  t143 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t140);
  tzk0 = t87 + t143;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t144 = t6 * t6;
  t145 = 0.1e1 / t144;
  t146 = t16 * t145;
  t148 = my_piecewise5(t10, 0, t14, 0, t7 - t146);
  t151 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t148);
  t152 = t5 * t151;
  t155 = t27 * t27;
  t156 = 0.1e1 / t155;
  t157 = t156 * t72;
  t158 = t157 * t83;
  t160 = t26 * t158 / 0.8e1;
  t161 = t42 * t42;
  t162 = 0.1e1 / t161;
  t163 = t162 * t28;
  t164 = t163 * t32;
  t165 = t34 * rho[0];
  t167 = 0.1e1 / t36 / t165;
  t172 = t45 * t46;
  t173 = t48 * t50;
  t174 = t51 * t34;
  t176 = 0.1e1 / t35 / t174;
  t180 = pow(t66, 0.25e1);
  t182 = t180 * t69 * t46;
  t183 = t60 * t62;
  t185 = 0.1e1 / t35 / t34;
  t189 = t67 * t28;
  t190 = t32 * sigma[0];
  t194 = -0.88671604938271604938e-2 * t164 * sigma[0] * t167 * t58 + t172 * t173 * t176 / 0.108e3 - 0.40671787192391865921e-3 * t182 * t183 * t185 - 0.96837588553313966479e-5 * t189 * t190 * t167;
  t195 = t27 * t194;
  t196 = t195 * t83;
  t201 = t2 / t3 / t74;
  t202 = t25 * t27;
  t203 = t201 * t202;
  t204 = t82 * t82;
  t205 = 0.1e1 / t204;
  t206 = t72 * t205;
  t207 = t78 * rho[0];
  t208 = 0.1e1 / t207;
  t209 = t76 * t208;
  t210 = t206 * t209;
  t214 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t84 - t160 - 0.3e1 / 0.8e1 * t26 * t196 - t203 * t210 / 0.768e3);
  t215 = t89 * t145;
  t217 = my_piecewise5(t14, 0, t10, 0, -t7 - t215);
  t220 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t217);
  t221 = t5 * t220;
  t224 = t156 * t130;
  t225 = t224 * t139;
  t227 = t97 * t225 / 0.8e1;
  t229 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t140 - t227);
  tvrho0 = t87 + t143 + t6 * (t214 + t229);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t233 = my_piecewise5(t10, 0, t14, 0, -t7 - t146);
  t236 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t233);
  t237 = t5 * t236;
  t241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t84 - t160);
  t243 = my_piecewise5(t14, 0, t10, 0, t7 - t215);
  t246 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t243);
  t247 = t5 * t246;
  t250 = t106 * t106;
  t251 = 0.1e1 / t250;
  t252 = t251 * t28;
  t253 = t252 * t32;
  t254 = t98 * rho[1];
  t256 = 0.1e1 / t100 / t254;
  t261 = t109 * t46;
  t262 = t48 * t110;
  t263 = t111 * t98;
  t265 = 0.1e1 / t99 / t263;
  t269 = pow(t124, 0.25e1);
  t271 = t269 * t127 * t46;
  t272 = t60 * t120;
  t274 = 0.1e1 / t99 / t98;
  t278 = t125 * t28;
  t279 = t32 * sigma[2];
  t283 = -0.88671604938271604938e-2 * t253 * sigma[2] * t256 * t118 + t261 * t262 * t265 / 0.108e3 - 0.40671787192391865921e-3 * t271 * t272 * t274 - 0.96837588553313966479e-5 * t278 * t279 * t256;
  t284 = t27 * t283;
  t285 = t284 * t139;
  t288 = t96 * t27;
  t289 = t201 * t288;
  t290 = t138 * t138;
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t134 * rho[1];
  t294 = 0.1e1 / t293;
  t295 = t132 * t294;
  t296 = t292 * t295;
  t300 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t140 - t227 - 0.3e1 / 0.8e1 * t97 * t285 - t289 * t296 / 0.768e3);
  tvrho1 = t87 + t143 + t6 * (t241 + t300);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t303 = t32 * t38;
  t307 = t48 * sigma[0];
  t311 = 0.1e1 / t62;
  t312 = t60 * t311;
  t318 = 0.33251851851851851852e-2 * t163 * t303 * t58 - t172 * t307 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t182 * t312 * t64 + 0.3631409570749273743e-5 * t189 * t303;
  t319 = t27 * t318;
  t320 = t319 * t83;
  t323 = t50 * t79;
  t324 = t206 * t323;
  t328 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t320 + t203 * t324 / 0.2048e4);
  tvsigma0 = t6 * t328;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t329 = t32 * t102;
  t333 = t48 * sigma[2];
  t337 = 0.1e1 / t120;
  t338 = t60 * t337;
  t344 = 0.33251851851851851852e-2 * t252 * t329 * t118 - t261 * t333 * t114 / 0.288e3 + 0.1525192019714694972e-3 * t271 * t338 * t122 + 0.3631409570749273743e-5 * t278 * t329;
  t345 = t27 * t344;
  t346 = t345 * t139;
  t349 = t110 * t135;
  t350 = t292 * t349;
  t354 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t346 + t289 * t350 / 0.2048e4);
  tvsigma2 = t6 * t354;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t45, t46, t48, t49, t50, t51, t52, t54;
  double t58, t60, t61, t62, t64, t66, t67, t69;
  double t72, t73, t74, t75, t76, t78, t79, t82;
  double t83, t84, t87, t88, t89, t91, t92, t93;
  double t94, t96, t97, t98, t99, t100, t102, t104;
  double t106, t109, t110, t111, t112, t114, t118, t120;
  double t122, t124, t125, t127, t130, t131, t132, t134;
  double t135, t138, t139, t140, t143, tzk0;

  double t144, t145, t146, t148, t151, t152, t155, t156;
  double t157, t158, t160, t161, t162, t163, t164, t165;
  double t167, t172, t173, t174, t176, t180, t182, t183;
  double t185, t189, t190, t194, t195, t196, t201, t202;
  double t203, t204, t205, t206, t207, t208, t209, t210;
  double t214, t215, t217, t220, t221, t224, t225, t227;
  double t229, tvrho0, t233, t236, t237, t241, t243, t246;
  double t247, t250, t251, t252, t253, t254, t256, t261;
  double t262, t263, t265, t269, t271, t272, t274, t278;
  double t279, t283, t284, t285, t288, t289, t290, t291;
  double t292, t293, t294, t295, t296, t300, tvrho1, t303;
  double t307, t311, t312, t318, t319, t320, t323, t324;
  double t328, tvsigma0, tvsigma1, t329, t333, t337, t338, t344;
  double t345, t346, t349, t350, t354, tvsigma2;

  double t357, t358, t359, t362, t363, t364, t367, t371;
  double t372, t375, t379, t380, t384, t386, t388, t390;
  double t391, t393, t394, t395, t398, t399, t400, t401;
  double t403, t409, t414, t415, t416, t417, t420, t426;
  double t427, t428, t429, t432, t433, t434, t435, t440;
  double t446, t448, t451, t452, t455, t458, t459, t461;
  double t462, t463, t464, t465, t467, t468, t469, t472;
  double t475, t476, t477, t478, t479, t482, t485, t489;
  double t490, t493, t496, t498, t500, tv2rho20, t503, t507;
  double t511, t512, t515, t519, t520, t527, t528, t532;
  double t536, t537, t540, t546, t547, t549, t550, t553;
  double t554, t555, t558, tv2rho21, t563, t568, t572, t573;
  double t578, t579, t584, t588, t589, t595, t596, t602;
  double t603, t604, t605, t607, t613, t618, t619, t620;
  double t621, t624, t630, t631, t632, t633, t636, t637;
  double t638, t643, t649, t651, t654, t655, t658, t660;
  double t661, t662, t663, t664, t666, t667, t668, t671;
  double t674, t675, tv2rho22, t681, t683, t688, t692, t695;
  double t704, t713, t715, t718, t719, t725, t726, t729;
  double t730, t731, t732, t733, t736, t740, tv2rhosigma0, tv2rhosigma1;
  double t745, t747, t751, t753, tv2rhosigma2, t760, tv2rhosigma3, tv2rhosigma4;
  double t768, t772, t775, t784, t793, t795, t798, t799;
  double t804, t807, t808, t809, t810, t811, t814, t818;
  double tv2rhosigma5, t820, t824, t827, t832, t833, t837, t841;
  double t842, t846, t848, t851, t854, t855, t856, t859;
  double t863, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t864, t868;
  double t871, t876, t877, t881, t885, t886, t890, t892;
  double t895, t898, t899, t900, t903, t907, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = -t16;
  t91 = my_piecewise5(t14, t11, t10, t15, t89 * t7);
  t92 = 0.1e1 + t91;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t96 = my_piecewise3(t93, t22, t94 * t92);
  t97 = t5 * t96;
  t98 = rho[1] * rho[1];
  t99 = POW_1_3(rho[1]);
  t100 = t99 * t99;
  t102 = 0.1e1 / t100 / t98;
  t104 = t33 * sigma[2] * t102;
  t106 = 0.804e0 + 0.5e1 / 0.972e3 * t104;
  t109 = 0.1804e1 - 0.646416e0 / t106;
  t110 = sigma[2] * sigma[2];
  t111 = t98 * t98;
  t112 = t111 * rho[1];
  t114 = 0.1e1 / t99 / t112;
  t118 = 0.1e3 - t49 * t110 * t114 / 0.576e3;
  t120 = sqrt(sigma[2]);
  t122 = 0.1e1 / t99 / rho[1];
  t124 = t61 * t120 * t122;
  t125 = pow(t124, 0.35e1);
  t127 = 0.1e1 + t104 / 0.24e2;
  t130 = t109 * t118 + 0.87153829697982569831e-4 * t125 * t127;
  t131 = t27 * t130;
  t132 = t110 * sigma[2];
  t134 = t111 * t111;
  t135 = 0.1e1 / t134;
  t138 = 0.1e3 + t75 * t132 * t135 / 0.2304e4;
  t139 = 0.1e1 / t138;
  t140 = t131 * t139;
  t143 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t140);
  tzk0 = t87 + t143;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t144 = t6 * t6;
  t145 = 0.1e1 / t144;
  t146 = t16 * t145;
  t148 = my_piecewise5(t10, 0, t14, 0, t7 - t146);
  t151 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t148);
  t152 = t5 * t151;
  t155 = t27 * t27;
  t156 = 0.1e1 / t155;
  t157 = t156 * t72;
  t158 = t157 * t83;
  t160 = t26 * t158 / 0.8e1;
  t161 = t42 * t42;
  t162 = 0.1e1 / t161;
  t163 = t162 * t28;
  t164 = t163 * t32;
  t165 = t34 * rho[0];
  t167 = 0.1e1 / t36 / t165;
  t172 = t45 * t46;
  t173 = t48 * t50;
  t174 = t51 * t34;
  t176 = 0.1e1 / t35 / t174;
  t180 = pow(t66, 0.25e1);
  t182 = t180 * t69 * t46;
  t183 = t60 * t62;
  t185 = 0.1e1 / t35 / t34;
  t189 = t67 * t28;
  t190 = t32 * sigma[0];
  t194 = -0.88671604938271604938e-2 * t164 * sigma[0] * t167 * t58 + t172 * t173 * t176 / 0.108e3 - 0.40671787192391865921e-3 * t182 * t183 * t185 - 0.96837588553313966479e-5 * t189 * t190 * t167;
  t195 = t27 * t194;
  t196 = t195 * t83;
  t201 = t2 / t3 / t74;
  t202 = t25 * t27;
  t203 = t201 * t202;
  t204 = t82 * t82;
  t205 = 0.1e1 / t204;
  t206 = t72 * t205;
  t207 = t78 * rho[0];
  t208 = 0.1e1 / t207;
  t209 = t76 * t208;
  t210 = t206 * t209;
  t214 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t84 - t160 - 0.3e1 / 0.8e1 * t26 * t196 - t203 * t210 / 0.768e3);
  t215 = t89 * t145;
  t217 = my_piecewise5(t14, 0, t10, 0, -t7 - t215);
  t220 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t217);
  t221 = t5 * t220;
  t224 = t156 * t130;
  t225 = t224 * t139;
  t227 = t97 * t225 / 0.8e1;
  t229 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t140 - t227);
  tvrho0 = t87 + t143 + t6 * (t214 + t229);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t233 = my_piecewise5(t10, 0, t14, 0, -t7 - t146);
  t236 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t233);
  t237 = t5 * t236;
  t241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t84 - t160);
  t243 = my_piecewise5(t14, 0, t10, 0, t7 - t215);
  t246 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t243);
  t247 = t5 * t246;
  t250 = t106 * t106;
  t251 = 0.1e1 / t250;
  t252 = t251 * t28;
  t253 = t252 * t32;
  t254 = t98 * rho[1];
  t256 = 0.1e1 / t100 / t254;
  t261 = t109 * t46;
  t262 = t48 * t110;
  t263 = t111 * t98;
  t265 = 0.1e1 / t99 / t263;
  t269 = pow(t124, 0.25e1);
  t271 = t269 * t127 * t46;
  t272 = t60 * t120;
  t274 = 0.1e1 / t99 / t98;
  t278 = t125 * t28;
  t279 = t32 * sigma[2];
  t283 = -0.88671604938271604938e-2 * t253 * sigma[2] * t256 * t118 + t261 * t262 * t265 / 0.108e3 - 0.40671787192391865921e-3 * t271 * t272 * t274 - 0.96837588553313966479e-5 * t278 * t279 * t256;
  t284 = t27 * t283;
  t285 = t284 * t139;
  t288 = t96 * t27;
  t289 = t201 * t288;
  t290 = t138 * t138;
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t134 * rho[1];
  t294 = 0.1e1 / t293;
  t295 = t132 * t294;
  t296 = t292 * t295;
  t300 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t140 - t227 - 0.3e1 / 0.8e1 * t97 * t285 - t289 * t296 / 0.768e3);
  tvrho1 = t87 + t143 + t6 * (t241 + t300);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t303 = t32 * t38;
  t307 = t48 * sigma[0];
  t311 = 0.1e1 / t62;
  t312 = t60 * t311;
  t318 = 0.33251851851851851852e-2 * t163 * t303 * t58 - t172 * t307 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t182 * t312 * t64 + 0.3631409570749273743e-5 * t189 * t303;
  t319 = t27 * t318;
  t320 = t319 * t83;
  t323 = t50 * t79;
  t324 = t206 * t323;
  t328 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t320 + t203 * t324 / 0.2048e4);
  tvsigma0 = t6 * t328;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t329 = t32 * t102;
  t333 = t48 * sigma[2];
  t337 = 0.1e1 / t120;
  t338 = t60 * t337;
  t344 = 0.33251851851851851852e-2 * t252 * t329 * t118 - t261 * t333 * t114 / 0.288e3 + 0.1525192019714694972e-3 * t271 * t338 * t122 + 0.3631409570749273743e-5 * t278 * t329;
  t345 = t27 * t344;
  t346 = t345 * t139;
  t349 = t110 * t135;
  t350 = t292 * t349;
  t354 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t346 + t289 * t350 / 0.2048e4);
  tvsigma2 = t6 * t354;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t357 = t23 * t23;
  t358 = 0.1e1 / t357;
  t359 = t148 * t148;
  t362 = t144 * t6;
  t363 = 0.1e1 / t362;
  t364 = t16 * t363;
  t367 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t145 + 0.2e1 * t364);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t359 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t5 * t371;
  t375 = t152 * t158;
  t379 = t151 * t27;
  t380 = t201 * t379;
  t384 = 0.1e1 / t155 / t6;
  t386 = t384 * t72 * t83;
  t388 = t26 * t386 / 0.12e2;
  t390 = t156 * t194 * t83;
  t391 = t26 * t390;
  t393 = t25 * t156;
  t394 = t201 * t393;
  t395 = t394 * t210;
  t398 = 0.1e1 / t161 / t42;
  t399 = t398 * t46;
  t400 = t399 * t48;
  t401 = t51 * t165;
  t403 = 0.1e1 / t35 / t401;
  t409 = 0.1e1 / t36 / t51;
  t414 = t162 * t75;
  t415 = t78 * t34;
  t416 = 0.1e1 / t415;
  t417 = t76 * t416;
  t420 = t162 * t76;
  t426 = POW_3_2(t66);
  t427 = t426 * t69;
  t428 = t427 * t28;
  t429 = t190 * t409;
  t432 = 0.1e1 / t29;
  t433 = t180 * t432;
  t434 = t62 * sigma[0];
  t435 = 0.1e1 / t174;
  t440 = 0.1e1 / t35 / t165;
  t446 = -0.24326914935053938255e-3 * t400 * t50 * t403 * t58 + 0.32512921810699588477e-1 * t164 * sigma[0] * t409 * t58 - 0.49262002743484224966e-3 * t414 * t417 - 0.50572284599482008956e-5 * t420 * t416 - 0.19e2 / 0.324e3 * t172 * t173 * t403 + 0.81343574384783731842e-2 * t428 * t429 + 0.54229049589855821228e-3 * t433 * t434 * t435 + 0.94900836782247687149e-3 * t182 * t183 * t440 + 0.35507115802881787709e-4 * t189 * t429;
  t448 = t27 * t446 * t83;
  t451 = t194 * t205;
  t452 = t451 * t209;
  t455 = t74 * t74;
  t458 = t2 / t3 / t455;
  t459 = t458 * t202;
  t461 = 0.1e1 / t204 / t82;
  t462 = t72 * t461;
  t463 = t50 * t50;
  t464 = t463 * t50;
  t465 = t78 * t78;
  t467 = 0.1e1 / t465 / t34;
  t468 = t464 * t467;
  t469 = t462 * t468;
  t472 = t206 * t417;
  t475 = -0.3e1 / 0.8e1 * t372 * t84 - t375 / 0.4e1 - 0.3e1 / 0.4e1 * t152 * t196 - t380 * t210 / 0.384e3 + t388 - t391 / 0.4e1 - t395 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t448 - t203 * t452 / 0.384e3 - t459 * t469 / 0.110592e6 + 0.3e1 / 0.256e3 * t203 * t472;
  t476 = my_piecewise3(t1, 0, t475);
  t477 = t94 * t94;
  t478 = 0.1e1 / t477;
  t479 = t217 * t217;
  t482 = t89 * t363;
  t485 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t145 + 0.2e1 * t482);
  t489 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t94 * t485);
  t490 = t5 * t489;
  t493 = t221 * t225;
  t496 = t384 * t130 * t139;
  t498 = t97 * t496 / 0.12e2;
  t500 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t490 * t140 - t493 / 0.4e1 + t498);
  tv2rho20 = 0.2e1 * t214 + 0.2e1 * t229 + t6 * (t476 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t503 = t358 * t233;
  t507 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t364);
  t511 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t23 * t507);
  t512 = t5 * t511;
  t515 = t237 * t158;
  t519 = t236 * t27;
  t520 = t201 * t519;
  t527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t512 * t84 - t515 / 0.8e1 - 0.3e1 / 0.8e1 * t237 * t196 - t520 * t210 / 0.768e3 - t375 / 0.8e1 + t388 - t391 / 0.8e1 - t395 / 0.2304e4);
  t528 = t478 * t243;
  t532 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t482);
  t536 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t528 * t217 + 0.4e1 / 0.3e1 * t94 * t532);
  t537 = t5 * t536;
  t540 = t247 * t225;
  t546 = t156 * t283 * t139;
  t547 = t97 * t546;
  t549 = t220 * t27;
  t550 = t201 * t549;
  t553 = t96 * t156;
  t554 = t201 * t553;
  t555 = t554 * t296;
  t558 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t537 * t140 - t540 / 0.8e1 - t493 / 0.8e1 + t498 - 0.3e1 / 0.8e1 * t221 * t285 - t547 / 0.8e1 - t550 * t296 / 0.768e3 - t555 / 0.2304e4);
  tv2rho21 = t214 + t229 + t241 + t300 + t6 * (t527 + t558);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t563 = t233 * t233;
  t568 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t145 + 0.2e1 * t364);
  t572 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t563 + 0.4e1 / 0.3e1 * t23 * t568);
  t573 = t5 * t572;
  t578 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t573 * t84 - t515 / 0.4e1 + t388);
  t579 = t243 * t243;
  t584 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t145 + 0.2e1 * t482);
  t588 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t579 + 0.4e1 / 0.3e1 * t94 * t584);
  t589 = t5 * t588;
  t595 = t246 * t27;
  t596 = t201 * t595;
  t602 = 0.1e1 / t250 / t106;
  t603 = t602 * t46;
  t604 = t603 * t48;
  t605 = t111 * t254;
  t607 = 0.1e1 / t99 / t605;
  t613 = 0.1e1 / t100 / t111;
  t618 = t251 * t75;
  t619 = t134 * t98;
  t620 = 0.1e1 / t619;
  t621 = t132 * t620;
  t624 = t251 * t132;
  t630 = POW_3_2(t124);
  t631 = t630 * t127;
  t632 = t631 * t28;
  t633 = t279 * t613;
  t636 = t269 * t432;
  t637 = t120 * sigma[2];
  t638 = 0.1e1 / t263;
  t643 = 0.1e1 / t99 / t254;
  t649 = -0.24326914935053938255e-3 * t604 * t110 * t607 * t118 + 0.32512921810699588477e-1 * t253 * sigma[2] * t613 * t118 - 0.49262002743484224966e-3 * t618 * t621 - 0.50572284599482008956e-5 * t624 * t620 - 0.19e2 / 0.324e3 * t261 * t262 * t607 + 0.81343574384783731842e-2 * t632 * t633 + 0.54229049589855821228e-3 * t636 * t637 * t638 + 0.94900836782247687149e-3 * t271 * t272 * t643 + 0.35507115802881787709e-4 * t278 * t633;
  t651 = t27 * t649 * t139;
  t654 = t283 * t291;
  t655 = t654 * t295;
  t658 = t458 * t288;
  t660 = 0.1e1 / t290 / t138;
  t661 = t130 * t660;
  t662 = t110 * t110;
  t663 = t662 * t110;
  t664 = t134 * t134;
  t666 = 0.1e1 / t664 / t98;
  t667 = t663 * t666;
  t668 = t661 * t667;
  t671 = t292 * t621;
  t674 = -0.3e1 / 0.8e1 * t589 * t140 - t540 / 0.4e1 - 0.3e1 / 0.4e1 * t247 * t285 - t596 * t296 / 0.384e3 + t498 - t547 / 0.4e1 - t555 / 0.1152e4 - 0.3e1 / 0.8e1 * t97 * t651 - t289 * t655 / 0.384e3 - t658 * t668 / 0.110592e6 + 0.3e1 / 0.256e3 * t289 * t671;
  t675 = my_piecewise3(t88, 0, t674);
  tv2rho22 = 0.2e1 * t241 + 0.2e1 * t300 + t6 * (t578 + t675);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t681 = t156 * t318 * t83;
  t683 = t26 * t681 / 0.8e1;
  t688 = t32 * t167;
  t692 = t208 * t50;
  t695 = t162 * t50;
  t704 = 0.1e1 / t52;
  t713 = 0.91225931006452268455e-4 * t400 * t176 * t58 * sigma[0] - 0.88671604938271604939e-2 * t163 * t688 * t58 + 0.18473251028806584362e-3 * t414 * t692 + 0.18964606724805753359e-5 * t695 * t208 + t172 * t307 * t176 / 0.54e2 - 0.3050384039429389944e-2 * t427 * t33 * t167 - 0.2033589359619593296e-3 * t433 * t62 * t704 - 0.2033589359619593296e-3 * t182 * t312 * t185 - 0.9683758855331396648e-5 * t189 * t688;
  t715 = t27 * t713 * t83;
  t718 = t318 * t205;
  t719 = t718 * t209;
  t725 = t394 * t324 / 0.6144e4;
  t726 = t451 * t323;
  t729 = t463 * sigma[0];
  t730 = t465 * rho[0];
  t731 = 0.1e1 / t730;
  t732 = t729 * t731;
  t733 = t462 * t732;
  t736 = t206 * t692;
  t740 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t320 - t683 - 0.3e1 / 0.8e1 * t26 * t715 - t203 * t719 / 0.768e3 + t380 * t324 / 0.2048e4 + t725 + t203 * t726 / 0.2048e4 + t459 * t733 / 0.294912e6 - t203 * t736 / 0.256e3);
  tv2rhosigma0 = t6 * t740 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t745 = t156 * t344 * t139;
  t747 = t97 * t745 / 0.8e1;
  t751 = t554 * t350 / 0.6144e4;
  t753 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t346 - t747 + t550 * t350 / 0.2048e4 + t751);
  tv2rhosigma2 = t6 * t753 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t760 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t320 - t683 + t520 * t324 / 0.2048e4 + t725);
  tv2rhosigma3 = t6 * t760 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t768 = t32 * t256;
  t772 = t294 * t110;
  t775 = t251 * t110;
  t784 = 0.1e1 / t112;
  t793 = 0.91225931006452268455e-4 * t604 * t265 * t118 * sigma[2] - 0.88671604938271604939e-2 * t252 * t768 * t118 + 0.18473251028806584362e-3 * t618 * t772 + 0.18964606724805753359e-5 * t775 * t294 + t261 * t333 * t265 / 0.54e2 - 0.3050384039429389944e-2 * t631 * t33 * t256 - 0.2033589359619593296e-3 * t636 * t120 * t784 - 0.2033589359619593296e-3 * t271 * t338 * t274 - 0.9683758855331396648e-5 * t278 * t768;
  t795 = t27 * t793 * t139;
  t798 = t344 * t291;
  t799 = t798 * t295;
  t804 = t654 * t349;
  t807 = t662 * sigma[2];
  t808 = t664 * rho[1];
  t809 = 0.1e1 / t808;
  t810 = t807 * t809;
  t811 = t661 * t810;
  t814 = t292 * t772;
  t818 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t346 - t747 - 0.3e1 / 0.8e1 * t97 * t795 - t289 * t799 / 0.768e3 + t596 * t350 / 0.2048e4 + t751 + t289 * t804 / 0.2048e4 + t658 * t811 / 0.294912e6 - t289 * t814 / 0.256e3);
  tv2rhosigma5 = t6 * t818 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t820 = t48 * t54;
  t824 = t79 * sigma[0];
  t827 = t162 * t79;
  t832 = 0.1e1 / sigma[0];
  t833 = t32 * t832;
  t837 = 0.1e1 / t51;
  t841 = 0.1e1 / t434;
  t842 = t60 * t841;
  t846 = -0.34209724127419600671e-4 * t399 * t820 * t58 - 0.69274691358024691358e-4 * t414 * t824 - 0.71117275218021575094e-6 * t827 * sigma[0] - t172 * t820 / 0.288e3 + 0.1143894014786021229e-2 * t428 * t833 * t38 + 0.76259600985734748602e-4 * t433 * t837 * t311 - 0.762596009857347486e-4 * t182 * t842 * t64;
  t848 = t27 * t846 * t83;
  t851 = t718 * t323;
  t854 = 0.1e1 / t465;
  t855 = t463 * t854;
  t856 = t462 * t855;
  t859 = t206 * t824;
  t863 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t848 + t203 * t851 / 0.1024e4 - t459 * t856 / 0.786432e6 + t203 * t859 / 0.1024e4);
  tv2sigma20 = t6 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t864 = t48 * t114;
  t868 = t135 * sigma[2];
  t871 = t251 * t135;
  t876 = 0.1e1 / sigma[2];
  t877 = t32 * t876;
  t881 = 0.1e1 / t111;
  t885 = 0.1e1 / t637;
  t886 = t60 * t885;
  t890 = -0.34209724127419600671e-4 * t603 * t864 * t118 - 0.69274691358024691358e-4 * t618 * t868 - 0.71117275218021575094e-6 * t871 * sigma[2] - t261 * t864 / 0.288e3 + 0.1143894014786021229e-2 * t632 * t877 * t102 + 0.76259600985734748602e-4 * t636 * t881 * t337 - 0.762596009857347486e-4 * t271 * t886 * t122;
  t892 = t27 * t890 * t139;
  t895 = t798 * t349;
  t898 = 0.1e1 / t664;
  t899 = t662 * t898;
  t900 = t661 * t899;
  t903 = t292 * t868;
  t907 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t892 + t289 * t895 / 0.1024e4 - t658 * t900 / 0.786432e6 + t289 * t903 / 0.1024e4);
  tv2sigma25 = t6 * t907;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t45, t46, t48, t49, t50, t51, t52, t54;
  double t58, t60, t61, t62, t64, t66, t67, t69;
  double t72, t73, t74, t75, t76, t78, t79, t82;
  double t83, t84, t87, t88, t89, t91, t92, t93;
  double t94, t96, t97, t98, t99, t100, t102, t104;
  double t106, t109, t110, t111, t112, t114, t118, t120;
  double t122, t124, t125, t127, t130, t131, t132, t134;
  double t135, t138, t139, t140, t143, tzk0;

  double t144, t145, t146, t148, t151, t152, t155, t156;
  double t157, t158, t160, t161, t162, t163, t164, t165;
  double t167, t172, t173, t174, t176, t180, t182, t183;
  double t185, t189, t190, t194, t195, t196, t201, t202;
  double t203, t204, t205, t206, t207, t208, t209, t210;
  double t214, t215, t217, t220, t221, t224, t225, t227;
  double t229, tvrho0, t233, t236, t237, t241, t243, t246;
  double t247, t250, t251, t252, t253, t254, t256, t261;
  double t262, t263, t265, t269, t271, t272, t274, t278;
  double t279, t283, t284, t285, t288, t289, t290, t291;
  double t292, t293, t294, t295, t296, t300, tvrho1, t303;
  double t307, t311, t312, t318, t319, t320, t323, t324;
  double t328, tvsigma0, tvsigma1, t329, t333, t337, t338, t344;
  double t345, t346, t349, t350, t354, tvsigma2;

  double t357, t358, t359, t362, t363, t364, t367, t371;
  double t372, t375, t379, t380, t384, t386, t388, t390;
  double t391, t393, t394, t395, t398, t399, t400, t401;
  double t403, t409, t414, t415, t416, t417, t420, t426;
  double t427, t428, t429, t432, t433, t434, t435, t440;
  double t446, t448, t451, t452, t455, t458, t459, t461;
  double t462, t463, t464, t465, t467, t468, t469, t472;
  double t475, t476, t477, t478, t479, t482, t485, t489;
  double t490, t493, t496, t498, t500, tv2rho20, t503, t507;
  double t511, t512, t515, t519, t520, t527, t528, t532;
  double t536, t537, t540, t546, t547, t549, t550, t553;
  double t554, t555, t558, tv2rho21, t563, t568, t572, t573;
  double t578, t579, t584, t588, t589, t595, t596, t602;
  double t603, t604, t605, t607, t613, t618, t619, t620;
  double t621, t624, t630, t631, t632, t633, t636, t637;
  double t638, t643, t649, t651, t654, t655, t658, t660;
  double t661, t662, t663, t664, t666, t667, t668, t671;
  double t674, t675, tv2rho22, t681, t683, t688, t692, t695;
  double t704, t713, t715, t718, t719, t725, t726, t729;
  double t730, t731, t732, t733, t736, t740, tv2rhosigma0, tv2rhosigma1;
  double t745, t747, t751, t753, tv2rhosigma2, t760, tv2rhosigma3, tv2rhosigma4;
  double t768, t772, t775, t784, t793, t795, t798, t799;
  double t804, t807, t808, t809, t810, t811, t814, t818;
  double tv2rhosigma5, t820, t824, t827, t832, t833, t837, t841;
  double t842, t846, t848, t851, t854, t855, t856, t859;
  double t863, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t864, t868;
  double t871, t876, t877, t881, t885, t886, t890, t892;
  double t895, t898, t899, t900, t903, t907, tv2sigma25;

  double t912, t916, t918, t921, t923, t925, t926, t927;
  double t928, t929, t930, t931, t936, t941, t943, t944;
  double t945, t947, t952, t959, t960, t962, t965, t970;
  double t973, t974, t975, t976, t980, t983, t986, t987;
  double t989, t996, t1002, t1004, t1008, t1009, t1012, t1013;
  double t1016, t1017, t1020, t1023, t1024, t1025, t1028, t1032;
  double t1033, t1039, t1040, t1041, t1042, t1043, t1044, t1045;
  double t1047, t1048, t1049, t1052, t1054, t1055, t1056, t1058;
  double t1059, t1062, t1063, t1066, t1067, t1070, t1071, t1072;
  double t1076, t1079, t1080, t1081, t1085, t1087, t1091, t1092;
  double t1093, t1096, t1099, t1101, t1103, t1104, t1107, t1110;
  double t1113, t1117, t1118, t1121, t1123, t1126, t1128, t1130;
  double tv3rho30, t1133, t1134, t1135, t1138, t1141, t1144, t1149;
  double t1150, t1152, t1156, t1157, t1163, t1167, t1168, t1171;
  double t1172, t1173, t1175, t1178, t1190, t1192, t1193, t1196;
  double t1201, t1203, t1207, t1208, t1212, t1213, t1220, t1222;
  double t1223, t1225, t1226, t1229, t1230, t1232, t1233, t1234;
  double t1235, t1237, t1238, tv3rho31, t1241, t1246, t1250, t1254;
  double t1255, t1258, t1262, t1263, t1270, t1271, t1272, t1277;
  double t1281, t1285, t1286, t1289, t1294, t1296, t1297, t1300;
  double t1301, t1302, t1305, t1311, t1312, t1316, t1318, t1321;
  double t1322, t1326, t1328, t1330, tv3rho32, t1335, t1342, t1346;
  double t1347, t1353, t1354, t1355, t1356, t1357, t1358, t1359;
  double t1364, t1369, t1370, t1371, t1373, t1378, t1385, t1386;
  double t1388, t1391, t1396, t1399, t1400, t1401, t1402, t1406;
  double t1409, t1412, t1413, t1415, t1422, t1428, t1430, t1433;
  double t1440, t1444, t1445, t1459, t1462, t1464, t1465, t1466;
  double t1469, t1477, t1478, t1481, t1482, t1483, t1484, t1485;
  double t1486, t1488, t1489, t1490, t1493, t1494, t1497, t1498;
  double t1503, t1506, t1508, tv3rho33, t1515, t1516, t1519, t1521;
  double t1522, t1524, t1532, t1534, t1535, t1539, t1543, t1546;
  double t1548, t1551, t1558, t1570, t1572, t1583, t1585, t1591;
  double t1592, t1593, t1596, t1597, t1600, t1601, t1610, t1612;
  double t1613, t1615, t1618, t1623, t1625, t1628, t1633, t1634;
  double t1636, t1639, t1640, t1643, t1646, t1648, tv3rho2sigma0, tv3rho2sigma1;
  double t1653, t1656, t1658, t1661, t1664, t1666, tv3rho2sigma2, t1670;
  double t1681, t1693, t1694, tv3rho2sigma3, tv3rho2sigma4, t1698, t1704, t1705;
  double t1709, t1713, t1718, t1722, t1726, t1728, t1729, tv3rho2sigma5;
  double t1739, tv3rho2sigma6, tv3rho2sigma7, t1742, t1750, t1752, t1753, t1757;
  double t1761, t1764, t1766, t1769, t1776, t1788, t1790, t1801;
  double t1803, t1812, t1815, t1820, t1823, t1827, t1828, t1829;
  double t1834, t1835, t1836, t1839, t1840, t1854, t1857, t1858;
  double t1861, t1863, tv3rho2sigma8, t1868, t1870, t1871, t1875, t1880;
  double t1881, t1885, t1887, t1890, t1893, t1896, t1901, t1920;
  double t1922, t1925, t1926, t1932, t1933, t1936, t1939, t1945;
  double t1946, t1949, t1951, t1952, t1953, t1956, t1957, t1963;
  double t1964, t1967, t1970, t1971, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1976, t1978, t1982, t1986, t1990, t1992, tv3rhosigma25;
  double t2003, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2007, t2011;
  double t2016, t2017, t2021, t2023, t2026, t2029, t2032, t2037;
  double t2056, t2058, t2061, t2062, t2067, t2070, t2073, t2078;
  double t2081, t2083, t2084, t2085, t2088, t2089, t2094, t2097;
  double t2100, t2101, tv3rhosigma211, t2107, t2108, t2114, t2119, t2130;
  double t2131, t2135, t2137, t2143, t2144, t2145, t2149, t2151;
  double t2154, t2157, t2160, t2164, t2165, t2166, t2169, t2170;
  double t2173, t2174, t2175, t2179, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2184, t2185, t2191;
  double t2196, t2207, t2208, t2212, t2214, t2220, t2221, t2222;
  double t2226, t2228, t2231, t2234, t2237, t2241, t2242, t2243;
  double t2246, t2247, t2250, t2251, t2252, t2256, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = -t16;
  t91 = my_piecewise5(t14, t11, t10, t15, t89 * t7);
  t92 = 0.1e1 + t91;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t96 = my_piecewise3(t93, t22, t94 * t92);
  t97 = t5 * t96;
  t98 = rho[1] * rho[1];
  t99 = POW_1_3(rho[1]);
  t100 = t99 * t99;
  t102 = 0.1e1 / t100 / t98;
  t104 = t33 * sigma[2] * t102;
  t106 = 0.804e0 + 0.5e1 / 0.972e3 * t104;
  t109 = 0.1804e1 - 0.646416e0 / t106;
  t110 = sigma[2] * sigma[2];
  t111 = t98 * t98;
  t112 = t111 * rho[1];
  t114 = 0.1e1 / t99 / t112;
  t118 = 0.1e3 - t49 * t110 * t114 / 0.576e3;
  t120 = sqrt(sigma[2]);
  t122 = 0.1e1 / t99 / rho[1];
  t124 = t61 * t120 * t122;
  t125 = pow(t124, 0.35e1);
  t127 = 0.1e1 + t104 / 0.24e2;
  t130 = t109 * t118 + 0.87153829697982569831e-4 * t125 * t127;
  t131 = t27 * t130;
  t132 = t110 * sigma[2];
  t134 = t111 * t111;
  t135 = 0.1e1 / t134;
  t138 = 0.1e3 + t75 * t132 * t135 / 0.2304e4;
  t139 = 0.1e1 / t138;
  t140 = t131 * t139;
  t143 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t140);
  tzk0 = t87 + t143;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t144 = t6 * t6;
  t145 = 0.1e1 / t144;
  t146 = t16 * t145;
  t148 = my_piecewise5(t10, 0, t14, 0, t7 - t146);
  t151 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t148);
  t152 = t5 * t151;
  t155 = t27 * t27;
  t156 = 0.1e1 / t155;
  t157 = t156 * t72;
  t158 = t157 * t83;
  t160 = t26 * t158 / 0.8e1;
  t161 = t42 * t42;
  t162 = 0.1e1 / t161;
  t163 = t162 * t28;
  t164 = t163 * t32;
  t165 = t34 * rho[0];
  t167 = 0.1e1 / t36 / t165;
  t172 = t45 * t46;
  t173 = t48 * t50;
  t174 = t51 * t34;
  t176 = 0.1e1 / t35 / t174;
  t180 = pow(t66, 0.25e1);
  t182 = t180 * t69 * t46;
  t183 = t60 * t62;
  t185 = 0.1e1 / t35 / t34;
  t189 = t67 * t28;
  t190 = t32 * sigma[0];
  t194 = -0.88671604938271604938e-2 * t164 * sigma[0] * t167 * t58 + t172 * t173 * t176 / 0.108e3 - 0.40671787192391865921e-3 * t182 * t183 * t185 - 0.96837588553313966479e-5 * t189 * t190 * t167;
  t195 = t27 * t194;
  t196 = t195 * t83;
  t201 = t2 / t3 / t74;
  t202 = t25 * t27;
  t203 = t201 * t202;
  t204 = t82 * t82;
  t205 = 0.1e1 / t204;
  t206 = t72 * t205;
  t207 = t78 * rho[0];
  t208 = 0.1e1 / t207;
  t209 = t76 * t208;
  t210 = t206 * t209;
  t214 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t84 - t160 - 0.3e1 / 0.8e1 * t26 * t196 - t203 * t210 / 0.768e3);
  t215 = t89 * t145;
  t217 = my_piecewise5(t14, 0, t10, 0, -t7 - t215);
  t220 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t217);
  t221 = t5 * t220;
  t224 = t156 * t130;
  t225 = t224 * t139;
  t227 = t97 * t225 / 0.8e1;
  t229 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t140 - t227);
  tvrho0 = t87 + t143 + t6 * (t214 + t229);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t233 = my_piecewise5(t10, 0, t14, 0, -t7 - t146);
  t236 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t233);
  t237 = t5 * t236;
  t241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t84 - t160);
  t243 = my_piecewise5(t14, 0, t10, 0, t7 - t215);
  t246 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t243);
  t247 = t5 * t246;
  t250 = t106 * t106;
  t251 = 0.1e1 / t250;
  t252 = t251 * t28;
  t253 = t252 * t32;
  t254 = t98 * rho[1];
  t256 = 0.1e1 / t100 / t254;
  t261 = t109 * t46;
  t262 = t48 * t110;
  t263 = t111 * t98;
  t265 = 0.1e1 / t99 / t263;
  t269 = pow(t124, 0.25e1);
  t271 = t269 * t127 * t46;
  t272 = t60 * t120;
  t274 = 0.1e1 / t99 / t98;
  t278 = t125 * t28;
  t279 = t32 * sigma[2];
  t283 = -0.88671604938271604938e-2 * t253 * sigma[2] * t256 * t118 + t261 * t262 * t265 / 0.108e3 - 0.40671787192391865921e-3 * t271 * t272 * t274 - 0.96837588553313966479e-5 * t278 * t279 * t256;
  t284 = t27 * t283;
  t285 = t284 * t139;
  t288 = t96 * t27;
  t289 = t201 * t288;
  t290 = t138 * t138;
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t134 * rho[1];
  t294 = 0.1e1 / t293;
  t295 = t132 * t294;
  t296 = t292 * t295;
  t300 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t140 - t227 - 0.3e1 / 0.8e1 * t97 * t285 - t289 * t296 / 0.768e3);
  tvrho1 = t87 + t143 + t6 * (t241 + t300);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t303 = t32 * t38;
  t307 = t48 * sigma[0];
  t311 = 0.1e1 / t62;
  t312 = t60 * t311;
  t318 = 0.33251851851851851852e-2 * t163 * t303 * t58 - t172 * t307 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t182 * t312 * t64 + 0.3631409570749273743e-5 * t189 * t303;
  t319 = t27 * t318;
  t320 = t319 * t83;
  t323 = t50 * t79;
  t324 = t206 * t323;
  t328 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t320 + t203 * t324 / 0.2048e4);
  tvsigma0 = t6 * t328;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t329 = t32 * t102;
  t333 = t48 * sigma[2];
  t337 = 0.1e1 / t120;
  t338 = t60 * t337;
  t344 = 0.33251851851851851852e-2 * t252 * t329 * t118 - t261 * t333 * t114 / 0.288e3 + 0.1525192019714694972e-3 * t271 * t338 * t122 + 0.3631409570749273743e-5 * t278 * t329;
  t345 = t27 * t344;
  t346 = t345 * t139;
  t349 = t110 * t135;
  t350 = t292 * t349;
  t354 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t346 + t289 * t350 / 0.2048e4);
  tvsigma2 = t6 * t354;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t357 = t23 * t23;
  t358 = 0.1e1 / t357;
  t359 = t148 * t148;
  t362 = t144 * t6;
  t363 = 0.1e1 / t362;
  t364 = t16 * t363;
  t367 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t145 + 0.2e1 * t364);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t359 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t5 * t371;
  t375 = t152 * t158;
  t379 = t151 * t27;
  t380 = t201 * t379;
  t384 = 0.1e1 / t155 / t6;
  t386 = t384 * t72 * t83;
  t388 = t26 * t386 / 0.12e2;
  t390 = t156 * t194 * t83;
  t391 = t26 * t390;
  t393 = t25 * t156;
  t394 = t201 * t393;
  t395 = t394 * t210;
  t398 = 0.1e1 / t161 / t42;
  t399 = t398 * t46;
  t400 = t399 * t48;
  t401 = t51 * t165;
  t403 = 0.1e1 / t35 / t401;
  t409 = 0.1e1 / t36 / t51;
  t414 = t162 * t75;
  t415 = t78 * t34;
  t416 = 0.1e1 / t415;
  t417 = t76 * t416;
  t420 = t162 * t76;
  t426 = POW_3_2(t66);
  t427 = t426 * t69;
  t428 = t427 * t28;
  t429 = t190 * t409;
  t432 = 0.1e1 / t29;
  t433 = t180 * t432;
  t434 = t62 * sigma[0];
  t435 = 0.1e1 / t174;
  t440 = 0.1e1 / t35 / t165;
  t446 = -0.24326914935053938255e-3 * t400 * t50 * t403 * t58 + 0.32512921810699588477e-1 * t164 * sigma[0] * t409 * t58 - 0.49262002743484224966e-3 * t414 * t417 - 0.50572284599482008956e-5 * t420 * t416 - 0.19e2 / 0.324e3 * t172 * t173 * t403 + 0.81343574384783731842e-2 * t428 * t429 + 0.54229049589855821228e-3 * t433 * t434 * t435 + 0.94900836782247687149e-3 * t182 * t183 * t440 + 0.35507115802881787709e-4 * t189 * t429;
  t448 = t27 * t446 * t83;
  t451 = t194 * t205;
  t452 = t451 * t209;
  t455 = t74 * t74;
  t458 = t2 / t3 / t455;
  t459 = t458 * t202;
  t461 = 0.1e1 / t204 / t82;
  t462 = t72 * t461;
  t463 = t50 * t50;
  t464 = t463 * t50;
  t465 = t78 * t78;
  t467 = 0.1e1 / t465 / t34;
  t468 = t464 * t467;
  t469 = t462 * t468;
  t472 = t206 * t417;
  t475 = -0.3e1 / 0.8e1 * t372 * t84 - t375 / 0.4e1 - 0.3e1 / 0.4e1 * t152 * t196 - t380 * t210 / 0.384e3 + t388 - t391 / 0.4e1 - t395 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t448 - t203 * t452 / 0.384e3 - t459 * t469 / 0.110592e6 + 0.3e1 / 0.256e3 * t203 * t472;
  t476 = my_piecewise3(t1, 0, t475);
  t477 = t94 * t94;
  t478 = 0.1e1 / t477;
  t479 = t217 * t217;
  t482 = t89 * t363;
  t485 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t145 + 0.2e1 * t482);
  t489 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t94 * t485);
  t490 = t5 * t489;
  t493 = t221 * t225;
  t496 = t384 * t130 * t139;
  t498 = t97 * t496 / 0.12e2;
  t500 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t490 * t140 - t493 / 0.4e1 + t498);
  tv2rho20 = 0.2e1 * t214 + 0.2e1 * t229 + t6 * (t476 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t503 = t358 * t233;
  t507 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t364);
  t511 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t23 * t507);
  t512 = t5 * t511;
  t515 = t237 * t158;
  t519 = t236 * t27;
  t520 = t201 * t519;
  t527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t512 * t84 - t515 / 0.8e1 - 0.3e1 / 0.8e1 * t237 * t196 - t520 * t210 / 0.768e3 - t375 / 0.8e1 + t388 - t391 / 0.8e1 - t395 / 0.2304e4);
  t528 = t478 * t243;
  t532 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t482);
  t536 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t528 * t217 + 0.4e1 / 0.3e1 * t94 * t532);
  t537 = t5 * t536;
  t540 = t247 * t225;
  t546 = t156 * t283 * t139;
  t547 = t97 * t546;
  t549 = t220 * t27;
  t550 = t201 * t549;
  t553 = t96 * t156;
  t554 = t201 * t553;
  t555 = t554 * t296;
  t558 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t537 * t140 - t540 / 0.8e1 - t493 / 0.8e1 + t498 - 0.3e1 / 0.8e1 * t221 * t285 - t547 / 0.8e1 - t550 * t296 / 0.768e3 - t555 / 0.2304e4);
  tv2rho21 = t214 + t229 + t241 + t300 + t6 * (t527 + t558);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t563 = t233 * t233;
  t568 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t145 + 0.2e1 * t364);
  t572 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t563 + 0.4e1 / 0.3e1 * t23 * t568);
  t573 = t5 * t572;
  t578 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t573 * t84 - t515 / 0.4e1 + t388);
  t579 = t243 * t243;
  t584 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t145 + 0.2e1 * t482);
  t588 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t579 + 0.4e1 / 0.3e1 * t94 * t584);
  t589 = t5 * t588;
  t595 = t246 * t27;
  t596 = t201 * t595;
  t602 = 0.1e1 / t250 / t106;
  t603 = t602 * t46;
  t604 = t603 * t48;
  t605 = t111 * t254;
  t607 = 0.1e1 / t99 / t605;
  t613 = 0.1e1 / t100 / t111;
  t618 = t251 * t75;
  t619 = t134 * t98;
  t620 = 0.1e1 / t619;
  t621 = t132 * t620;
  t624 = t251 * t132;
  t630 = POW_3_2(t124);
  t631 = t630 * t127;
  t632 = t631 * t28;
  t633 = t279 * t613;
  t636 = t269 * t432;
  t637 = t120 * sigma[2];
  t638 = 0.1e1 / t263;
  t643 = 0.1e1 / t99 / t254;
  t649 = -0.24326914935053938255e-3 * t604 * t110 * t607 * t118 + 0.32512921810699588477e-1 * t253 * sigma[2] * t613 * t118 - 0.49262002743484224966e-3 * t618 * t621 - 0.50572284599482008956e-5 * t624 * t620 - 0.19e2 / 0.324e3 * t261 * t262 * t607 + 0.81343574384783731842e-2 * t632 * t633 + 0.54229049589855821228e-3 * t636 * t637 * t638 + 0.94900836782247687149e-3 * t271 * t272 * t643 + 0.35507115802881787709e-4 * t278 * t633;
  t651 = t27 * t649 * t139;
  t654 = t283 * t291;
  t655 = t654 * t295;
  t658 = t458 * t288;
  t660 = 0.1e1 / t290 / t138;
  t661 = t130 * t660;
  t662 = t110 * t110;
  t663 = t662 * t110;
  t664 = t134 * t134;
  t666 = 0.1e1 / t664 / t98;
  t667 = t663 * t666;
  t668 = t661 * t667;
  t671 = t292 * t621;
  t674 = -0.3e1 / 0.8e1 * t589 * t140 - t540 / 0.4e1 - 0.3e1 / 0.4e1 * t247 * t285 - t596 * t296 / 0.384e3 + t498 - t547 / 0.4e1 - t555 / 0.1152e4 - 0.3e1 / 0.8e1 * t97 * t651 - t289 * t655 / 0.384e3 - t658 * t668 / 0.110592e6 + 0.3e1 / 0.256e3 * t289 * t671;
  t675 = my_piecewise3(t88, 0, t674);
  tv2rho22 = 0.2e1 * t241 + 0.2e1 * t300 + t6 * (t578 + t675);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t681 = t156 * t318 * t83;
  t683 = t26 * t681 / 0.8e1;
  t688 = t32 * t167;
  t692 = t208 * t50;
  t695 = t162 * t50;
  t704 = 0.1e1 / t52;
  t713 = 0.91225931006452268455e-4 * t400 * t176 * t58 * sigma[0] - 0.88671604938271604939e-2 * t163 * t688 * t58 + 0.18473251028806584362e-3 * t414 * t692 + 0.18964606724805753359e-5 * t695 * t208 + t172 * t307 * t176 / 0.54e2 - 0.3050384039429389944e-2 * t427 * t33 * t167 - 0.2033589359619593296e-3 * t433 * t62 * t704 - 0.2033589359619593296e-3 * t182 * t312 * t185 - 0.9683758855331396648e-5 * t189 * t688;
  t715 = t27 * t713 * t83;
  t718 = t318 * t205;
  t719 = t718 * t209;
  t725 = t394 * t324 / 0.6144e4;
  t726 = t451 * t323;
  t729 = t463 * sigma[0];
  t730 = t465 * rho[0];
  t731 = 0.1e1 / t730;
  t732 = t729 * t731;
  t733 = t462 * t732;
  t736 = t206 * t692;
  t740 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t320 - t683 - 0.3e1 / 0.8e1 * t26 * t715 - t203 * t719 / 0.768e3 + t380 * t324 / 0.2048e4 + t725 + t203 * t726 / 0.2048e4 + t459 * t733 / 0.294912e6 - t203 * t736 / 0.256e3);
  tv2rhosigma0 = t6 * t740 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t745 = t156 * t344 * t139;
  t747 = t97 * t745 / 0.8e1;
  t751 = t554 * t350 / 0.6144e4;
  t753 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t346 - t747 + t550 * t350 / 0.2048e4 + t751);
  tv2rhosigma2 = t6 * t753 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t760 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t320 - t683 + t520 * t324 / 0.2048e4 + t725);
  tv2rhosigma3 = t6 * t760 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t768 = t32 * t256;
  t772 = t294 * t110;
  t775 = t251 * t110;
  t784 = 0.1e1 / t112;
  t793 = 0.91225931006452268455e-4 * t604 * t265 * t118 * sigma[2] - 0.88671604938271604939e-2 * t252 * t768 * t118 + 0.18473251028806584362e-3 * t618 * t772 + 0.18964606724805753359e-5 * t775 * t294 + t261 * t333 * t265 / 0.54e2 - 0.3050384039429389944e-2 * t631 * t33 * t256 - 0.2033589359619593296e-3 * t636 * t120 * t784 - 0.2033589359619593296e-3 * t271 * t338 * t274 - 0.9683758855331396648e-5 * t278 * t768;
  t795 = t27 * t793 * t139;
  t798 = t344 * t291;
  t799 = t798 * t295;
  t804 = t654 * t349;
  t807 = t662 * sigma[2];
  t808 = t664 * rho[1];
  t809 = 0.1e1 / t808;
  t810 = t807 * t809;
  t811 = t661 * t810;
  t814 = t292 * t772;
  t818 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t346 - t747 - 0.3e1 / 0.8e1 * t97 * t795 - t289 * t799 / 0.768e3 + t596 * t350 / 0.2048e4 + t751 + t289 * t804 / 0.2048e4 + t658 * t811 / 0.294912e6 - t289 * t814 / 0.256e3);
  tv2rhosigma5 = t6 * t818 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t820 = t48 * t54;
  t824 = t79 * sigma[0];
  t827 = t162 * t79;
  t832 = 0.1e1 / sigma[0];
  t833 = t32 * t832;
  t837 = 0.1e1 / t51;
  t841 = 0.1e1 / t434;
  t842 = t60 * t841;
  t846 = -0.34209724127419600671e-4 * t399 * t820 * t58 - 0.69274691358024691358e-4 * t414 * t824 - 0.71117275218021575094e-6 * t827 * sigma[0] - t172 * t820 / 0.288e3 + 0.1143894014786021229e-2 * t428 * t833 * t38 + 0.76259600985734748602e-4 * t433 * t837 * t311 - 0.762596009857347486e-4 * t182 * t842 * t64;
  t848 = t27 * t846 * t83;
  t851 = t718 * t323;
  t854 = 0.1e1 / t465;
  t855 = t463 * t854;
  t856 = t462 * t855;
  t859 = t206 * t824;
  t863 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t848 + t203 * t851 / 0.1024e4 - t459 * t856 / 0.786432e6 + t203 * t859 / 0.1024e4);
  tv2sigma20 = t6 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t864 = t48 * t114;
  t868 = t135 * sigma[2];
  t871 = t251 * t135;
  t876 = 0.1e1 / sigma[2];
  t877 = t32 * t876;
  t881 = 0.1e1 / t111;
  t885 = 0.1e1 / t637;
  t886 = t60 * t885;
  t890 = -0.34209724127419600671e-4 * t603 * t864 * t118 - 0.69274691358024691358e-4 * t618 * t868 - 0.71117275218021575094e-6 * t871 * sigma[2] - t261 * t864 / 0.288e3 + 0.1143894014786021229e-2 * t632 * t877 * t102 + 0.76259600985734748602e-4 * t636 * t881 * t337 - 0.762596009857347486e-4 * t271 * t886 * t122;
  t892 = t27 * t890 * t139;
  t895 = t798 * t349;
  t898 = 0.1e1 / t664;
  t899 = t662 * t898;
  t900 = t661 * t899;
  t903 = t292 * t868;
  t907 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t892 + t289 * t895 / 0.1024e4 - t658 * t900 / 0.786432e6 + t289 * t903 / 0.1024e4);
  tv2sigma25 = t6 * t907;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t912 = t152 * t390;
  t916 = t372 * t158;
  t918 = t152 * t386;
  t921 = 0.1e1 / t155 / t144;
  t923 = t921 * t72 * t83;
  t925 = 0.5e1 / 0.36e2 * t26 * t923;
  t926 = t161 * t161;
  t927 = 0.1e1 / t926;
  t928 = t927 * t75;
  t929 = t78 * t165;
  t930 = 0.1e1 / t929;
  t931 = t76 * t930;
  t936 = 0.1e1 / t35 / t78;
  t941 = t398 * t28;
  t943 = 0.1e1 / t31 / t74;
  t944 = t943 * t463;
  t945 = t78 * t52;
  t947 = 0.1e1 / t36 / t945;
  t952 = 0.1e1 / t36 / t52;
  t959 = t398 * t75;
  t960 = t959 * t463;
  t962 = t947 * t28 * t32;
  t965 = t398 * t463;
  t970 = t173 * t936;
  t973 = sqrt(t66);
  t974 = t973 * t69;
  t975 = t432 * t434;
  t976 = 0.1e1 / t401;
  t980 = t426 * t46;
  t983 = t190 * t952;
  t986 = t426 * t432;
  t987 = t986 * t50;
  t989 = t936 * t46 * t60;
  t996 = 0.1e1 / t35 / t51;
  t1002 = -0.60066456629762810506e-4 * t928 * t931 * t58 + 0.2675960642855933208e-2 * t400 * t50 * t936 * t58 - 0.13514952741696632364e-4 * t941 * t944 * t947 - 0.15172696844993141289e0 * t164 * sigma[0] * t952 * t58 + 0.6732473708276177412e-2 * t414 * t931 - 0.13514952741696632364e-4 * t960 * t962 - 0.13874426501915503143e-6 * t965 * t962 + 0.82601398179153947962e-4 * t420 * t930 + 0.209e3 / 0.486e3 * t172 * t970 - 0.9761228926174047821e-1 * t974 * t975 * t976 - 0.90381749316426368713e-3 * t980 * t970 - 0.5694050206934861229e-1 * t428 * t983 - 0.18076349863285273742e-2 * t987 * t989 - 0.48806144630870239106e-2 * t433 * t434 * t976 - 0.3163361226074922905e-2 * t182 * t183 * t996 - 0.16569987374678167598e-3 * t189 * t983;
  t1004 = t27 * t1002 * t83;
  t1008 = t384 * t194 * t83;
  t1009 = t26 * t1008;
  t1012 = t156 * t446 * t83;
  t1013 = t26 * t1012;
  t1016 = 0.1e1 / t357 / t19;
  t1017 = t359 * t148;
  t1020 = t358 * t148;
  t1023 = t144 * t144;
  t1024 = 0.1e1 / t1023;
  t1025 = t16 * t1024;
  t1028 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t363 - 0.6e1 * t1025);
  t1032 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1016 * t1017 + 0.4e1 / 0.3e1 * t1020 * t367 + 0.4e1 / 0.3e1 * t23 * t1028);
  t1033 = t5 * t1032;
  t1039 = t2 / t3 / t455 / t74;
  t1040 = t1039 * t202;
  t1041 = t204 * t204;
  t1042 = 0.1e1 / t1041;
  t1043 = t72 * t1042;
  t1044 = t463 * t463;
  t1045 = t1044 * sigma[0];
  t1047 = 0.1e1 / t465 / t929;
  t1048 = t1045 * t1047;
  t1049 = t1043 * t1048;
  t1052 = t394 * t452;
  t1054 = -0.9e1 / 0.8e1 * t372 * t196 - 0.3e1 / 0.4e1 * t912 - 0.9e1 / 0.8e1 * t152 * t448 - 0.3e1 / 0.8e1 * t916 + t918 / 0.4e1 - t925 - 0.3e1 / 0.8e1 * t26 * t1004 + t1009 / 0.4e1 - 0.3e1 / 0.8e1 * t1013 - 0.3e1 / 0.8e1 * t1033 * t84 - t1040 * t1049 / 0.10616832e8 - t1052 / 0.384e3;
  t1055 = t458 * t393;
  t1056 = t1055 * t469;
  t1058 = t446 * t205;
  t1059 = t1058 * t209;
  t1062 = t194 * t461;
  t1063 = t1062 * t468;
  t1066 = t371 * t27;
  t1067 = t201 * t1066;
  t1070 = t151 * t156;
  t1071 = t201 * t1070;
  t1072 = t1071 * t210;
  t1076 = t458 * t379;
  t1079 = t25 * t384;
  t1080 = t201 * t1079;
  t1081 = t1080 * t210;
  t1085 = t394 * t472;
  t1087 = t451 * t417;
  t1091 = 0.1e1 / t465 / t165;
  t1092 = t464 * t1091;
  t1093 = t462 * t1092;
  t1096 = t206 * t931;
  t1099 = -t1056 / 0.110592e6 - t203 * t1059 / 0.256e3 - t459 * t1063 / 0.36864e5 - t1067 * t210 / 0.256e3 - t1072 / 0.384e3 - t380 * t452 / 0.128e3 - t1076 * t469 / 0.36864e5 + t1081 / 0.1152e4 + 0.9e1 / 0.256e3 * t380 * t472 + 0.3e1 / 0.256e3 * t1085 + 0.9e1 / 0.256e3 * t203 * t1087 + t459 * t1093 / 0.4096e4 - 0.15e2 / 0.128e3 * t203 * t1096;
  t1101 = my_piecewise3(t1, 0, t1054 + t1099);
  t1103 = 0.1e1 / t477 / t92;
  t1104 = t479 * t217;
  t1107 = t478 * t217;
  t1110 = t89 * t1024;
  t1113 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t363 - 0.6e1 * t1110);
  t1117 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1103 * t1104 + 0.4e1 / 0.3e1 * t1107 * t485 + 0.4e1 / 0.3e1 * t94 * t1113);
  t1118 = t5 * t1117;
  t1121 = t490 * t225;
  t1123 = t221 * t496;
  t1126 = t921 * t130 * t139;
  t1128 = 0.5e1 / 0.36e2 * t97 * t1126;
  t1130 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1118 * t140 - 0.3e1 / 0.8e1 * t1121 + t1123 / 0.4e1 - t1128);
  tv3rho30 = 0.3e1 * t476 + 0.3e1 * t500 + t6 * (t1101 + t1130);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1133 = 0.2e1 * t527;
  t1134 = 0.2e1 * t558;
  t1135 = t237 * t386;
  t1138 = t512 * t158 / 0.4e1;
  t1141 = t1016 * t233;
  t1144 = t358 * t507;
  t1149 = 0.2e1 * t363;
  t1150 = 0.6e1 * t1025;
  t1152 = my_piecewise5(t10, 0, t14, 0, t1149 - t1150);
  t1156 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1141 * t359 + 0.8e1 / 0.9e1 * t1144 * t148 + 0.4e1 / 0.9e1 * t503 * t367 + 0.4e1 / 0.3e1 * t23 * t1152);
  t1157 = t5 * t1156;
  t1163 = t237 * t390 / 0.4e1;
  t1167 = t511 * t27;
  t1168 = t201 * t1167;
  t1171 = t1135 / 0.12e2 - t1138 - t925 - 0.3e1 / 0.8e1 * t237 * t448 - 0.3e1 / 0.8e1 * t1157 * t84 - 0.3e1 / 0.4e1 * t512 * t196 - t1163 + t1009 / 0.6e1 - t1013 / 0.8e1 - t912 / 0.4e1 - t1168 * t210 / 0.384e3;
  t1172 = t236 * t156;
  t1173 = t201 * t1172;
  t1175 = t1173 * t210 / 0.1152e4;
  t1178 = t458 * t519;
  t1190 = -t1175 - t520 * t452 / 0.384e3 - t1178 * t469 / 0.110592e6 - t1052 / 0.1152e4 - t1056 / 0.331776e6 - t1072 / 0.1152e4 + t1081 / 0.1728e4 - t916 / 0.8e1 + t918 / 0.6e1 + t1085 / 0.256e3 + 0.3e1 / 0.256e3 * t520 * t472;
  t1192 = my_piecewise3(t1, 0, t1171 + t1190);
  t1193 = t1103 * t243;
  t1196 = t478 * t532;
  t1201 = 0.6e1 * t1110;
  t1203 = my_piecewise5(t14, 0, t10, 0, -t1149 - t1201);
  t1207 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1193 * t479 + 0.8e1 / 0.9e1 * t1196 * t217 + 0.4e1 / 0.9e1 * t528 * t485 + 0.4e1 / 0.3e1 * t94 * t1203);
  t1208 = t5 * t1207;
  t1212 = t537 * t225 / 0.4e1;
  t1213 = t247 * t496;
  t1220 = t221 * t546 / 0.4e1;
  t1222 = t384 * t283 * t139;
  t1223 = t97 * t1222;
  t1225 = t489 * t27;
  t1226 = t201 * t1225;
  t1229 = t220 * t156;
  t1230 = t201 * t1229;
  t1232 = t1230 * t296 / 0.1152e4;
  t1233 = t96 * t384;
  t1234 = t201 * t1233;
  t1235 = t1234 * t296;
  t1237 = -0.3e1 / 0.8e1 * t1208 * t140 - t1212 + t1213 / 0.12e2 - t1121 / 0.8e1 + t1123 / 0.6e1 - t1128 - 0.3e1 / 0.8e1 * t490 * t285 - t1220 + t1223 / 0.12e2 - t1226 * t296 / 0.768e3 - t1232 + t1235 / 0.3456e4;
  t1238 = my_piecewise3(t88, 0, t1237);
  tv3rho31 = t476 + t500 + t1133 + t1134 + t6 * (t1192 + t1238);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1241 = t1016 * t563;
  t1246 = t358 * t568;
  t1250 = my_piecewise5(t10, 0, t14, 0, -t1149 - t1150);
  t1254 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1241 * t148 + 0.8e1 / 0.9e1 * t503 * t507 + 0.4e1 / 0.9e1 * t1246 * t148 + 0.4e1 / 0.3e1 * t23 * t1250);
  t1255 = t5 * t1254;
  t1258 = t573 * t158;
  t1262 = t572 * t27;
  t1263 = t201 * t1262;
  t1270 = -0.3e1 / 0.8e1 * t1255 * t84 - t1258 / 0.8e1 - 0.3e1 / 0.8e1 * t573 * t196 - t1263 * t210 / 0.768e3 - t1138 + t1135 / 0.6e1 - t1163 - t1175 + t918 / 0.12e2 - t925 + t1009 / 0.12e2 + t1081 / 0.3456e4;
  t1271 = my_piecewise3(t1, 0, t1270);
  t1272 = t1103 * t579;
  t1277 = t478 * t584;
  t1281 = my_piecewise5(t14, 0, t10, 0, t1149 - t1201);
  t1285 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1272 * t217 + 0.8e1 / 0.9e1 * t528 * t532 + 0.4e1 / 0.9e1 * t1277 * t217 + 0.4e1 / 0.3e1 * t94 * t1281);
  t1286 = t5 * t1285;
  t1289 = t589 * t225;
  t1294 = t247 * t546;
  t1296 = t536 * t27;
  t1297 = t201 * t1296;
  t1300 = t246 * t156;
  t1301 = t201 * t1300;
  t1302 = t1301 * t296;
  t1305 = -0.3e1 / 0.8e1 * t1286 * t140 - t1289 / 0.8e1 - t1212 + t1213 / 0.6e1 - 0.3e1 / 0.4e1 * t537 * t285 - t1294 / 0.4e1 - t1297 * t296 / 0.384e3 - t1302 / 0.1152e4 + t1123 / 0.12e2 - t1128 - t1220;
  t1311 = t156 * t649 * t139;
  t1312 = t97 * t1311;
  t1316 = t554 * t655;
  t1318 = t458 * t549;
  t1321 = t458 * t553;
  t1322 = t1321 * t668;
  t1326 = t554 * t671;
  t1328 = t1223 / 0.6e1 - t1232 + t1235 / 0.1728e4 - 0.3e1 / 0.8e1 * t221 * t651 - t1312 / 0.8e1 - t550 * t655 / 0.384e3 - t1316 / 0.1152e4 - t1318 * t668 / 0.110592e6 - t1322 / 0.331776e6 + 0.3e1 / 0.256e3 * t550 * t671 + t1326 / 0.256e3;
  t1330 = my_piecewise3(t88, 0, t1305 + t1328);
  tv3rho32 = t1133 + t1134 + t578 + t675 + t6 * (t1271 + t1330);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1335 = t563 * t233;
  t1342 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t363 - 0.6e1 * t1025);
  t1346 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1016 * t1335 + 0.4e1 / 0.3e1 * t503 * t568 + 0.4e1 / 0.3e1 * t23 * t1342);
  t1347 = t5 * t1346;
  t1353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1347 * t84 - 0.3e1 / 0.8e1 * t1258 + t1135 / 0.4e1 - t925);
  t1354 = t250 * t250;
  t1355 = 0.1e1 / t1354;
  t1356 = t1355 * t75;
  t1357 = t134 * t254;
  t1358 = 0.1e1 / t1357;
  t1359 = t132 * t1358;
  t1364 = 0.1e1 / t99 / t134;
  t1369 = t602 * t28;
  t1370 = t943 * t662;
  t1371 = t134 * t112;
  t1373 = 0.1e1 / t100 / t1371;
  t1378 = 0.1e1 / t100 / t112;
  t1385 = t602 * t75;
  t1386 = t1385 * t662;
  t1388 = t1373 * t28 * t32;
  t1391 = t602 * t662;
  t1396 = t262 * t1364;
  t1399 = sqrt(t124);
  t1400 = t1399 * t127;
  t1401 = t432 * t637;
  t1402 = 0.1e1 / t605;
  t1406 = t630 * t46;
  t1409 = t279 * t1378;
  t1412 = t630 * t432;
  t1413 = t1412 * t110;
  t1415 = t1364 * t46 * t60;
  t1422 = 0.1e1 / t99 / t111;
  t1428 = -0.60066456629762810506e-4 * t1356 * t1359 * t118 + 0.2675960642855933208e-2 * t604 * t110 * t1364 * t118 - 0.13514952741696632364e-4 * t1369 * t1370 * t1373 - 0.15172696844993141289e0 * t253 * sigma[2] * t1378 * t118 + 0.6732473708276177412e-2 * t618 * t1359 - 0.13514952741696632364e-4 * t1386 * t1388 - 0.13874426501915503143e-6 * t1391 * t1388 + 0.82601398179153947962e-4 * t624 * t1358 + 0.209e3 / 0.486e3 * t261 * t1396 - 0.9761228926174047821e-1 * t1400 * t1401 * t1402 - 0.90381749316426368713e-3 * t1406 * t1396 - 0.5694050206934861229e-1 * t632 * t1409 - 0.18076349863285273742e-2 * t1413 * t1415 - 0.48806144630870239106e-2 * t636 * t637 * t1402 - 0.3163361226074922905e-2 * t271 * t272 * t1422 - 0.16569987374678167598e-3 * t278 * t1409;
  t1430 = t27 * t1428 * t139;
  t1433 = t579 * t243;
  t1440 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t363 - 0.6e1 * t1110);
  t1444 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1103 * t1433 + 0.4e1 / 0.3e1 * t528 * t584 + 0.4e1 / 0.3e1 * t94 * t1440);
  t1445 = t5 * t1444;
  t1459 = t654 * t621;
  t1462 = -0.3e1 / 0.8e1 * t97 * t1430 - 0.3e1 / 0.8e1 * t1445 * t140 - 0.9e1 / 0.8e1 * t589 * t285 - 0.9e1 / 0.8e1 * t247 * t651 - 0.3e1 / 0.8e1 * t1312 - 0.3e1 / 0.8e1 * t1289 - 0.3e1 / 0.4e1 * t1294 + t1213 / 0.4e1 + t1223 / 0.4e1 - t1128 + 0.9e1 / 0.256e3 * t596 * t671 + 0.9e1 / 0.256e3 * t289 * t1459;
  t1464 = 0.1e1 / t664 / t254;
  t1465 = t663 * t1464;
  t1466 = t661 * t1465;
  t1469 = t292 * t1359;
  t1477 = t283 * t660;
  t1478 = t1477 * t667;
  t1481 = t1039 * t288;
  t1482 = t290 * t290;
  t1483 = 0.1e1 / t1482;
  t1484 = t130 * t1483;
  t1485 = t662 * t662;
  t1486 = t1485 * sigma[2];
  t1488 = 0.1e1 / t664 / t1357;
  t1489 = t1486 * t1488;
  t1490 = t1484 * t1489;
  t1493 = t649 * t291;
  t1494 = t1493 * t295;
  t1497 = t588 * t27;
  t1498 = t201 * t1497;
  t1503 = t458 * t595;
  t1506 = t658 * t1466 / 0.4096e4 - 0.15e2 / 0.128e3 * t289 * t1469 + t1235 / 0.1152e4 - t1302 / 0.384e3 - t1316 / 0.384e3 - t1322 / 0.110592e6 + 0.3e1 / 0.256e3 * t1326 - t658 * t1478 / 0.36864e5 - t1481 * t1490 / 0.10616832e8 - t289 * t1494 / 0.256e3 - t1498 * t296 / 0.256e3 - t596 * t655 / 0.128e3 - t1503 * t668 / 0.36864e5;
  t1508 = my_piecewise3(t88, 0, t1462 + t1506);
  tv3rho33 = 0.3e1 * t578 + 0.3e1 * t675 + t6 * (t1353 + t1508);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1515 = t156 * t713 * t83;
  t1516 = t26 * t1515;
  t1519 = t384 * t318 * t83;
  t1521 = t26 * t1519 / 0.12e2;
  t1522 = t152 * t681;
  t1524 = t416 * t58;
  t1532 = t78 * t51;
  t1534 = 0.1e1 / t36 / t1532;
  t1535 = t943 * t1534;
  t1539 = t32 * t409;
  t1543 = t416 * t50;
  t1546 = t959 * t1534;
  t1548 = t76 * t28 * t32;
  t1551 = t398 * t76;
  t1558 = t307 * t403;
  t1570 = t986 * sigma[0];
  t1572 = t403 * t46 * t60;
  t1583 = 0.2252492123616105394e-4 * t928 * t1524 * t50 - 0.8210333790580704161e-3 * t400 * t403 * t58 * sigma[0] + 0.50681072781362371364e-5 * t941 * t1535 * t76 + 0.32512921810699588478e-1 * t163 * t1539 * t58 - 0.21552126200274348423e-2 * t414 * t1543 + 0.50681072781362371364e-5 * t1546 * t1548 + 0.52029099382183136787e-7 * t1551 * t1534 * t28 * t32 - 0.27182602972221579814e-4 * t695 * t416 - 0.19e2 / 0.162e3 * t172 * t1558 + 0.36604608473152679328e-1 * t974 * t432 * t435 * t62 + 0.33893155993659888267e-3 * t980 * t1558 + 0.1525192019714694972e-1 * t427 * t33 * t409 + 0.67786311987319776533e-3 * t1570 * t1572 + 0.14235125517337153072e-2 * t433 * t62 * t435 + 0.47450418391123843573e-3 * t182 * t312 * t440 + 0.35507115802881787709e-4 * t189 * t1539;
  t1585 = t27 * t1583 * t83;
  t1591 = 0.1e1 / t465 / t415;
  t1592 = t1044 * t1591;
  t1593 = t1043 * t1592;
  t1596 = t713 * t205;
  t1597 = t1596 * t209;
  t1600 = t318 * t461;
  t1601 = t1600 * t468;
  t1610 = t394 * t726;
  t1612 = -0.3e1 / 0.4e1 * t152 * t715 - t1516 / 0.4e1 + t1521 - t1522 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1585 - 0.3e1 / 0.8e1 * t372 * t320 + t1040 * t1593 / 0.28311552e8 - t203 * t1597 / 0.384e3 - t459 * t1601 / 0.110592e6 + t1067 * t324 / 0.2048e4 + t380 * t726 / 0.1024e4 + t1076 * t733 / 0.147456e6 + t1610 / 0.3072e4;
  t1613 = t1055 * t733;
  t1615 = t1058 * t323;
  t1618 = t1062 * t732;
  t1623 = t394 * t719;
  t1625 = t718 * t417;
  t1628 = t1071 * t324;
  t1633 = t1080 * t324 / 0.9216e4;
  t1634 = t394 * t736;
  t1636 = t451 * t692;
  t1639 = t729 * t467;
  t1640 = t462 * t1639;
  t1643 = t206 * t1543;
  t1646 = t1613 / 0.442368e6 + t203 * t1615 / 0.2048e4 + t459 * t1618 / 0.147456e6 - t380 * t719 / 0.384e3 - t1623 / 0.1152e4 + 0.3e1 / 0.256e3 * t203 * t1625 + t1628 / 0.3072e4 - t380 * t736 / 0.128e3 - t1633 - t1634 / 0.384e3 - t203 * t1636 / 0.128e3 - 0.25e2 / 0.294912e6 * t459 * t1640 + 0.9e1 / 0.256e3 * t203 * t1643;
  t1648 = my_piecewise3(t1, 0, t1612 + t1646);
  tv3rho2sigma0 = t6 * t1648 + 0.2e1 * t740;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1653 = t221 * t745;
  t1656 = t384 * t344 * t139;
  t1658 = t97 * t1656 / 0.12e2;
  t1661 = t1230 * t350;
  t1664 = t1234 * t350 / 0.9216e4;
  t1666 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t490 * t346 - t1653 / 0.4e1 + t1658 + t1226 * t350 / 0.2048e4 + t1661 / 0.3072e4 - t1664);
  tv3rho2sigma2 = t6 * t1666 + 0.2e1 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1670 = t237 * t681;
  t1681 = t1173 * t324;
  t1693 = -0.3e1 / 0.8e1 * t512 * t320 - t1670 / 0.8e1 - 0.3e1 / 0.8e1 * t237 * t715 - t520 * t719 / 0.768e3 - t1522 / 0.8e1 + t1521 - t1516 / 0.8e1 - t1623 / 0.2304e4 + t1168 * t324 / 0.2048e4 + t1681 / 0.6144e4 + t520 * t726 / 0.2048e4 + t1178 * t733 / 0.294912e6 - t520 * t736 / 0.256e3 + t1628 / 0.6144e4 - t1633 + t1610 / 0.6144e4 + t1613 / 0.884736e6 - t1634 / 0.768e3;
  t1694 = my_piecewise3(t1, 0, t1693);
  tv3rho2sigma3 = t6 * t1694 + t740 + t760;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1698 = t247 * t745;
  t1704 = t156 * t793 * t139;
  t1705 = t97 * t1704;
  t1709 = t554 * t799;
  t1713 = t1301 * t350;
  t1718 = t554 * t804;
  t1722 = t1321 * t811;
  t1726 = t554 * t814;
  t1728 = -0.3e1 / 0.8e1 * t537 * t346 - t1698 / 0.8e1 - t1653 / 0.8e1 + t1658 - 0.3e1 / 0.8e1 * t221 * t795 - t1705 / 0.8e1 - t550 * t799 / 0.768e3 - t1709 / 0.2304e4 + t1297 * t350 / 0.2048e4 + t1713 / 0.6144e4 + t1661 / 0.6144e4 - t1664 + t550 * t804 / 0.2048e4 + t1718 / 0.6144e4 + t1318 * t811 / 0.294912e6 + t1722 / 0.884736e6 - t550 * t814 / 0.256e3 - t1726 / 0.768e3;
  t1729 = my_piecewise3(t88, 0, t1728);
  tv3rho2sigma5 = t6 * t1729 + t753 + t818;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t573 * t320 - t1670 / 0.4e1 + t1521 + t1263 * t324 / 0.2048e4 + t1681 / 0.3072e4 - t1633);
  tv3rho2sigma6 = t6 * t1739 + 0.2e1 * t760;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1742 = t620 * t118;
  t1750 = t134 * t111;
  t1752 = 0.1e1 / t100 / t1750;
  t1753 = t943 * t1752;
  t1757 = t32 * t613;
  t1761 = t620 * t110;
  t1764 = t1385 * t1752;
  t1766 = t132 * t28 * t32;
  t1769 = t602 * t132;
  t1776 = t333 * t607;
  t1788 = t1412 * sigma[2];
  t1790 = t607 * t46 * t60;
  t1801 = 0.2252492123616105394e-4 * t1356 * t1742 * t110 - 0.8210333790580704161e-3 * t604 * t607 * t118 * sigma[2] + 0.50681072781362371364e-5 * t1369 * t1753 * t132 + 0.32512921810699588478e-1 * t252 * t1757 * t118 - 0.21552126200274348423e-2 * t618 * t1761 + 0.50681072781362371364e-5 * t1764 * t1766 + 0.52029099382183136787e-7 * t1769 * t1752 * t28 * t32 - 0.27182602972221579814e-4 * t775 * t620 - 0.19e2 / 0.162e3 * t261 * t1776 + 0.36604608473152679328e-1 * t1400 * t432 * t638 * t120 + 0.33893155993659888267e-3 * t1406 * t1776 + 0.1525192019714694972e-1 * t631 * t33 * t613 + 0.67786311987319776533e-3 * t1788 * t1790 + 0.14235125517337153072e-2 * t636 * t120 * t638 + 0.47450418391123843573e-3 * t271 * t338 * t643 + 0.35507115802881787709e-4 * t278 * t1757;
  t1803 = t27 * t1801 * t139;
  t1812 = t292 * t1761;
  t1815 = t798 * t621;
  t1820 = t1493 * t349;
  t1823 = t1477 * t810;
  t1827 = 0.1e1 / t664 / t619;
  t1828 = t1485 * t1827;
  t1829 = t1484 * t1828;
  t1834 = -0.3e1 / 0.8e1 * t97 * t1803 - 0.3e1 / 0.8e1 * t589 * t346 - 0.3e1 / 0.4e1 * t247 * t795 - t1698 / 0.4e1 - t1705 / 0.4e1 + t1658 + 0.9e1 / 0.256e3 * t289 * t1812 + 0.3e1 / 0.256e3 * t289 * t1815 - t596 * t814 / 0.128e3 + t289 * t1820 / 0.2048e4 + t658 * t1823 / 0.147456e6 + t1481 * t1829 / 0.28311552e8 - t596 * t799 / 0.384e3;
  t1835 = t793 * t291;
  t1836 = t1835 * t295;
  t1839 = t344 * t660;
  t1840 = t1839 * t667;
  t1854 = t654 * t772;
  t1857 = t807 * t666;
  t1858 = t661 * t1857;
  t1861 = -t289 * t1836 / 0.384e3 - t658 * t1840 / 0.110592e6 + t1498 * t350 / 0.2048e4 + t596 * t804 / 0.1024e4 + t1503 * t811 / 0.147456e6 - t1709 / 0.1152e4 + t1713 / 0.3072e4 + t1718 / 0.3072e4 + t1722 / 0.442368e6 - t1726 / 0.384e3 - t289 * t1854 / 0.128e3 - 0.25e2 / 0.294912e6 * t658 * t1858 - t1664;
  t1863 = my_piecewise3(t88, 0, t1834 + t1861);
  tv3rho2sigma8 = t6 * t1863 + 0.2e1 * t818;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1868 = t156 * t846 * t83;
  t1870 = t26 * t1868 / 0.8e1;
  t1871 = t208 * t58;
  t1875 = t48 * t176;
  t1880 = 0.1e1 / t36 / t929;
  t1881 = t943 * t1880;
  t1885 = t959 * t1880;
  t1887 = t50 * t28 * t32;
  t1890 = t208 * sigma[0];
  t1893 = t398 * t1880;
  t1896 = t162 * t208;
  t1901 = t432 * t311;
  t1920 = -0.84468454635603952274e-5 * t928 * t1871 * sigma[0] + 0.18245186201290453691e-3 * t399 * t1875 * t58 - 0.19005402293010889262e-5 * t941 * t1881 * t50 - 0.19005402293010889261e-5 * t1885 * t1887 + 0.55419753086419753086e-3 * t414 * t1890 - 0.19510912268318676295e-7 * t1893 * t1887 + 0.75858426899223013434e-5 * t1896 * sigma[0] + t172 * t1875 / 0.54e2 - 0.13726728177432254748e-1 * t974 * t1901 * t704 - 0.127099334976224581e-3 * t980 * t1875 - 0.1525192019714694972e-2 * t428 * t833 * t167 - 0.254198669952449162e-3 * t986 * t176 * t46 * t60 - 0.25419866995244916201e-3 * t433 * t704 * t311 + 0.1016794679809796648e-3 * t182 * t842 * t185;
  t1922 = t27 * t1920 * t83;
  t1925 = t846 * t205;
  t1926 = t1925 * t209;
  t1932 = t394 * t851 / 0.3072e4;
  t1933 = t1596 * t323;
  t1936 = t1600 * t732;
  t1939 = t718 * t692;
  t1945 = t1055 * t856 / 0.2359296e7;
  t1946 = t1062 * t855;
  t1949 = t463 * t76;
  t1951 = 0.1e1 / t465 / t207;
  t1952 = t1949 * t1951;
  t1953 = t1043 * t1952;
  t1956 = t463 * t731;
  t1957 = t462 * t1956;
  t1963 = t394 * t859 / 0.3072e4;
  t1964 = t451 * t824;
  t1967 = t206 * t1890;
  t1970 = -0.3e1 / 0.8e1 * t152 * t848 - t1870 - 0.3e1 / 0.8e1 * t26 * t1922 - t203 * t1926 / 0.768e3 + t380 * t851 / 0.1024e4 + t1932 + t203 * t1933 / 0.1024e4 + t459 * t1936 / 0.147456e6 - t203 * t1939 / 0.128e3 - t1076 * t856 / 0.786432e6 - t1945 - t459 * t1946 / 0.786432e6 - t1040 * t1953 / 0.75497472e8 + t459 * t1957 / 0.36864e5 + t380 * t859 / 0.1024e4 + t1963 + t203 * t1964 / 0.1024e4 - t203 * t1967 / 0.128e3;
  t1971 = my_piecewise3(t1, 0, t1970);
  tv3rhosigma20 = t6 * t1971 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1976 = t156 * t890 * t139;
  t1978 = t97 * t1976 / 0.8e1;
  t1982 = t554 * t895 / 0.3072e4;
  t1986 = t1321 * t900 / 0.2359296e7;
  t1990 = t554 * t903 / 0.3072e4;
  t1992 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t892 - t1978 + t550 * t895 / 0.1024e4 + t1982 - t1318 * t900 / 0.786432e6 - t1986 + t550 * t903 / 0.1024e4 + t1990);
  tv3rhosigma25 = t6 * t1992 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2003 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t848 - t1870 + t520 * t851 / 0.1024e4 + t1932 - t1178 * t856 / 0.786432e6 - t1945 + t520 * t859 / 0.1024e4 + t1963);
  tv3rhosigma26 = t6 * t2003 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2007 = t294 * t118;
  t2011 = t48 * t265;
  t2016 = 0.1e1 / t100 / t1357;
  t2017 = t943 * t2016;
  t2021 = t1385 * t2016;
  t2023 = t110 * t28 * t32;
  t2026 = t294 * sigma[2];
  t2029 = t602 * t2016;
  t2032 = t251 * t294;
  t2037 = t432 * t337;
  t2056 = -0.84468454635603952274e-5 * t1356 * t2007 * sigma[2] + 0.18245186201290453691e-3 * t603 * t2011 * t118 - 0.19005402293010889262e-5 * t1369 * t2017 * t110 - 0.19005402293010889261e-5 * t2021 * t2023 + 0.55419753086419753086e-3 * t618 * t2026 - 0.19510912268318676295e-7 * t2029 * t2023 + 0.75858426899223013434e-5 * t2032 * sigma[2] + t261 * t2011 / 0.54e2 - 0.13726728177432254748e-1 * t1400 * t2037 * t784 - 0.127099334976224581e-3 * t1406 * t2011 - 0.1525192019714694972e-2 * t632 * t877 * t256 - 0.254198669952449162e-3 * t1412 * t265 * t46 * t60 - 0.25419866995244916201e-3 * t636 * t784 * t337 + 0.1016794679809796648e-3 * t271 * t886 * t274;
  t2058 = t27 * t2056 * t139;
  t2061 = t890 * t291;
  t2062 = t2061 * t295;
  t2067 = t1835 * t349;
  t2070 = t1839 * t810;
  t2073 = t798 * t772;
  t2078 = t1477 * t899;
  t2081 = t662 * t132;
  t2083 = 0.1e1 / t664 / t293;
  t2084 = t2081 * t2083;
  t2085 = t1484 * t2084;
  t2088 = t662 * t809;
  t2089 = t661 * t2088;
  t2094 = t654 * t868;
  t2097 = t292 * t2026;
  t2100 = -0.3e1 / 0.8e1 * t247 * t892 - t1978 - 0.3e1 / 0.8e1 * t97 * t2058 - t289 * t2062 / 0.768e3 + t596 * t895 / 0.1024e4 + t1982 + t289 * t2067 / 0.1024e4 + t658 * t2070 / 0.147456e6 - t289 * t2073 / 0.128e3 - t1503 * t900 / 0.786432e6 - t1986 - t658 * t2078 / 0.786432e6 - t1481 * t2085 / 0.75497472e8 + t658 * t2089 / 0.36864e5 + t596 * t903 / 0.1024e4 + t1990 + t289 * t2094 / 0.1024e4 - t289 * t2097 / 0.128e3;
  t2101 = my_piecewise3(t88, 0, t2100);
  tv3rhosigma211 = t6 * t2101 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2107 = 0.1e1 / t36 / t415;
  t2108 = t943 * t2107;
  t2114 = sigma[0] * t28 * t32;
  t2119 = t398 * t2107;
  t2130 = 0.1e1 / t50;
  t2131 = t32 * t2130;
  t2135 = t986 * t54;
  t2137 = t832 * t46 * t60;
  t2143 = t62 * t50;
  t2144 = 0.1e1 / t2143;
  t2145 = t60 * t2144;
  t2149 = 0.31675670488351482103e-5 * t928 * t79 * t58 + 0.71270258598790834731e-6 * t941 * t2108 * sigma[0] + 0.71270258598790834731e-6 * t959 * t2107 * t2114 - 0.69274691358024691358e-4 * t414 * t79 + 0.73165921006195036105e-8 * t2119 * t2114 - 0.14223455043604315019e-5 * t827 + 0.51475230665370955305e-2 * t974 * t432 * t841 * t837 + 0.47662250616084217875e-4 * t980 * t820 * t832 - 0.17158410221790318435e-2 * t428 * t2131 * t38 + 0.95324501232168435752e-4 * t2135 * t2137 - 0.57194700739301061451e-4 * t433 * t837 * t841 + 0.1143894014786021229e-3 * t182 * t2145 * t64;
  t2151 = t27 * t2149 * t83;
  t2154 = t1925 * t323;
  t2157 = t1600 * t855;
  t2160 = t718 * t824;
  t2164 = 0.1e1 / t465 / t78;
  t2165 = t464 * t2164;
  t2166 = t1043 * t2165;
  t2169 = t76 * t854;
  t2170 = t462 * t2169;
  t2173 = t201 * t25;
  t2174 = t205 * t79;
  t2175 = t73 * t2174;
  t2179 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t2151 + 0.3e1 / 0.2048e4 * t203 * t2154 - t459 * t2157 / 0.262144e6 + 0.3e1 / 0.1024e4 * t203 * t2160 + t1040 * t2166 / 0.201326592e9 - t459 * t2170 / 0.131072e6 + t2173 * t2175 / 0.1024e4);
  tv3sigma30 = t6 * t2179;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2184 = 0.1e1 / t100 / t619;
  t2185 = t943 * t2184;
  t2191 = sigma[2] * t28 * t32;
  t2196 = t602 * t2184;
  t2207 = 0.1e1 / t110;
  t2208 = t32 * t2207;
  t2212 = t1412 * t114;
  t2214 = t876 * t46 * t60;
  t2220 = t120 * t110;
  t2221 = 0.1e1 / t2220;
  t2222 = t60 * t2221;
  t2226 = 0.31675670488351482103e-5 * t1356 * t135 * t118 + 0.71270258598790834731e-6 * t1369 * t2185 * sigma[2] + 0.71270258598790834731e-6 * t1385 * t2184 * t2191 - 0.69274691358024691358e-4 * t618 * t135 + 0.73165921006195036105e-8 * t2196 * t2191 - 0.14223455043604315019e-5 * t871 + 0.51475230665370955305e-2 * t1400 * t432 * t885 * t881 + 0.47662250616084217875e-4 * t1406 * t864 * t876 - 0.17158410221790318435e-2 * t632 * t2208 * t102 + 0.95324501232168435752e-4 * t2212 * t2214 - 0.57194700739301061451e-4 * t636 * t881 * t885 + 0.1143894014786021229e-3 * t271 * t2222 * t122;
  t2228 = t27 * t2226 * t139;
  t2231 = t2061 * t349;
  t2234 = t1839 * t899;
  t2237 = t798 * t868;
  t2241 = 0.1e1 / t664 / t134;
  t2242 = t663 * t2241;
  t2243 = t1484 * t2242;
  t2246 = t132 * t898;
  t2247 = t661 * t2246;
  t2250 = t201 * t96;
  t2251 = t291 * t135;
  t2252 = t131 * t2251;
  t2256 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t2228 + 0.3e1 / 0.2048e4 * t289 * t2231 - t658 * t2234 / 0.262144e6 + 0.3e1 / 0.1024e4 * t289 * t2237 + t1481 * t2243 / 0.201326592e9 - t658 * t2247 / 0.131072e6 + t2250 * t2252 / 0.1024e4);
  tv3sigma39 = t6 * t2256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t40, t42;
  double t45, t46, t48, t49, t50, t51, t52, t54;
  double t58, t60, t61, t62, t64, t66, t67, t69;
  double t72, t73, t74, t75, t76, t78, t79, t82;
  double t83, t84, t87, t88, t89, t91, t92, t93;
  double t94, t96, t97, t98, t99, t100, t102, t104;
  double t106, t109, t110, t111, t112, t114, t118, t120;
  double t122, t124, t125, t127, t130, t131, t132, t134;
  double t135, t138, t139, t140, t143, tzk0;

  double t144, t145, t146, t148, t151, t152, t155, t156;
  double t157, t158, t160, t161, t162, t163, t164, t165;
  double t167, t172, t173, t174, t176, t180, t182, t183;
  double t185, t189, t190, t194, t195, t196, t201, t202;
  double t203, t204, t205, t206, t207, t208, t209, t210;
  double t214, t215, t217, t220, t221, t224, t225, t227;
  double t229, tvrho0, t233, t236, t237, t241, t243, t246;
  double t247, t250, t251, t252, t253, t254, t256, t261;
  double t262, t263, t265, t269, t271, t272, t274, t278;
  double t279, t283, t284, t285, t288, t289, t290, t291;
  double t292, t293, t294, t295, t296, t300, tvrho1, t303;
  double t307, t311, t312, t318, t319, t320, t323, t324;
  double t328, tvsigma0, tvsigma1, t329, t333, t337, t338, t344;
  double t345, t346, t349, t350, t354, tvsigma2;

  double t357, t358, t359, t362, t363, t364, t367, t371;
  double t372, t375, t379, t380, t384, t386, t388, t390;
  double t391, t393, t394, t395, t398, t399, t400, t401;
  double t403, t409, t414, t415, t416, t417, t420, t426;
  double t427, t428, t429, t432, t433, t434, t435, t440;
  double t446, t448, t451, t452, t455, t458, t459, t461;
  double t462, t463, t464, t465, t467, t468, t469, t472;
  double t475, t476, t477, t478, t479, t482, t485, t489;
  double t490, t493, t496, t498, t500, tv2rho20, t503, t507;
  double t511, t512, t515, t519, t520, t527, t528, t532;
  double t536, t537, t540, t546, t547, t549, t550, t553;
  double t554, t555, t558, tv2rho21, t563, t568, t572, t573;
  double t578, t579, t584, t588, t589, t595, t596, t602;
  double t603, t604, t605, t607, t613, t618, t619, t620;
  double t621, t624, t630, t631, t632, t633, t636, t637;
  double t638, t643, t649, t651, t654, t655, t658, t660;
  double t661, t662, t663, t664, t666, t667, t668, t671;
  double t674, t675, tv2rho22, t681, t683, t688, t692, t695;
  double t704, t713, t715, t718, t719, t725, t726, t729;
  double t730, t731, t732, t733, t736, t740, tv2rhosigma0, tv2rhosigma1;
  double t745, t747, t751, t753, tv2rhosigma2, t760, tv2rhosigma3, tv2rhosigma4;
  double t768, t772, t775, t784, t793, t795, t798, t799;
  double t804, t807, t808, t809, t810, t811, t814, t818;
  double tv2rhosigma5, t820, t824, t827, t832, t833, t837, t841;
  double t842, t846, t848, t851, t854, t855, t856, t859;
  double t863, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t864, t868;
  double t871, t876, t877, t881, t885, t886, t890, t892;
  double t895, t898, t899, t900, t903, t907, tv2sigma25;

  double t912, t916, t918, t921, t923, t925, t926, t927;
  double t928, t929, t930, t931, t936, t941, t943, t944;
  double t945, t947, t952, t959, t960, t962, t965, t970;
  double t973, t974, t975, t976, t980, t983, t986, t987;
  double t989, t996, t1002, t1004, t1008, t1009, t1012, t1013;
  double t1016, t1017, t1020, t1023, t1024, t1025, t1028, t1032;
  double t1033, t1039, t1040, t1041, t1042, t1043, t1044, t1045;
  double t1047, t1048, t1049, t1052, t1054, t1055, t1056, t1058;
  double t1059, t1062, t1063, t1066, t1067, t1070, t1071, t1072;
  double t1076, t1079, t1080, t1081, t1085, t1087, t1091, t1092;
  double t1093, t1096, t1099, t1101, t1103, t1104, t1107, t1110;
  double t1113, t1117, t1118, t1121, t1123, t1126, t1128, t1130;
  double tv3rho30, t1133, t1134, t1135, t1138, t1141, t1144, t1149;
  double t1150, t1152, t1156, t1157, t1163, t1167, t1168, t1171;
  double t1172, t1173, t1175, t1178, t1190, t1192, t1193, t1196;
  double t1201, t1203, t1207, t1208, t1212, t1213, t1220, t1222;
  double t1223, t1225, t1226, t1229, t1230, t1232, t1233, t1234;
  double t1235, t1237, t1238, tv3rho31, t1241, t1246, t1250, t1254;
  double t1255, t1258, t1262, t1263, t1270, t1271, t1272, t1277;
  double t1281, t1285, t1286, t1289, t1294, t1296, t1297, t1300;
  double t1301, t1302, t1305, t1311, t1312, t1316, t1318, t1321;
  double t1322, t1326, t1328, t1330, tv3rho32, t1335, t1342, t1346;
  double t1347, t1353, t1354, t1355, t1356, t1357, t1358, t1359;
  double t1364, t1369, t1370, t1371, t1373, t1378, t1385, t1386;
  double t1388, t1391, t1396, t1399, t1400, t1401, t1402, t1406;
  double t1409, t1412, t1413, t1415, t1422, t1428, t1430, t1433;
  double t1440, t1444, t1445, t1459, t1462, t1464, t1465, t1466;
  double t1469, t1477, t1478, t1481, t1482, t1483, t1484, t1485;
  double t1486, t1488, t1489, t1490, t1493, t1494, t1497, t1498;
  double t1503, t1506, t1508, tv3rho33, t1515, t1516, t1519, t1521;
  double t1522, t1524, t1532, t1534, t1535, t1539, t1543, t1546;
  double t1548, t1551, t1558, t1570, t1572, t1583, t1585, t1591;
  double t1592, t1593, t1596, t1597, t1600, t1601, t1610, t1612;
  double t1613, t1615, t1618, t1623, t1625, t1628, t1633, t1634;
  double t1636, t1639, t1640, t1643, t1646, t1648, tv3rho2sigma0, tv3rho2sigma1;
  double t1653, t1656, t1658, t1661, t1664, t1666, tv3rho2sigma2, t1670;
  double t1681, t1693, t1694, tv3rho2sigma3, tv3rho2sigma4, t1698, t1704, t1705;
  double t1709, t1713, t1718, t1722, t1726, t1728, t1729, tv3rho2sigma5;
  double t1739, tv3rho2sigma6, tv3rho2sigma7, t1742, t1750, t1752, t1753, t1757;
  double t1761, t1764, t1766, t1769, t1776, t1788, t1790, t1801;
  double t1803, t1812, t1815, t1820, t1823, t1827, t1828, t1829;
  double t1834, t1835, t1836, t1839, t1840, t1854, t1857, t1858;
  double t1861, t1863, tv3rho2sigma8, t1868, t1870, t1871, t1875, t1880;
  double t1881, t1885, t1887, t1890, t1893, t1896, t1901, t1920;
  double t1922, t1925, t1926, t1932, t1933, t1936, t1939, t1945;
  double t1946, t1949, t1951, t1952, t1953, t1956, t1957, t1963;
  double t1964, t1967, t1970, t1971, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1976, t1978, t1982, t1986, t1990, t1992, tv3rhosigma25;
  double t2003, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2007, t2011;
  double t2016, t2017, t2021, t2023, t2026, t2029, t2032, t2037;
  double t2056, t2058, t2061, t2062, t2067, t2070, t2073, t2078;
  double t2081, t2083, t2084, t2085, t2088, t2089, t2094, t2097;
  double t2100, t2101, tv3rhosigma211, t2107, t2108, t2114, t2119, t2130;
  double t2131, t2135, t2137, t2143, t2144, t2145, t2149, t2151;
  double t2154, t2157, t2160, t2164, t2165, t2166, t2169, t2170;
  double t2173, t2174, t2175, t2179, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2184, t2185, t2191;
  double t2196, t2207, t2208, t2212, t2214, t2220, t2221, t2222;
  double t2226, t2228, t2231, t2234, t2237, t2241, t2242, t2243;
  double t2246, t2247, t2250, t2251, t2252, t2256, tv3sigma39;

  double t2263, t2268, t2270, t2272, t2273, t2277, t2286, t2288;
  double t2290, t2304, t2307, t2310, t2316, t2319, t2320, t2322;
  double t2330, t2333, t2339, t2346, t2347, t2360, t2366, t2368;
  double t2372, t2376, t2378, t2379, t2385, t2391, t2392, t2395;
  double t2399, t2407, t2410, t2412, t2414, t2416, t2417, t2420;
  double t2424, t2427, t2430, t2431, t2433, t2435, t2436, t2444;
  double t2446, t2447, t2449, t2451, t2454, t2456, t2457, t2459;
  double t2461, t2469, t2473, t2476, t2480, t2483, t2484, t2487;
  double t2489, t2496, t2500, t2502, t2505, t2508, t2510, t2511;
  double t2513, t2531, t2542, t2543, t2547, t2550, t2551, t2553;
  double t2554, t2560, t2565, t2568, t2572, t2576, t2578, t2580;
  double t2585, t2587, tv4rho40, t2592, t2594, t2598, t2599, t2600;
  double t2601, t2602, t2604, t2626, t2627, t2629, t2633, t2639;
  double t2649, t2652, t2657, t2660, t2665, t2666, t2667, t2669;
  double t2670, t2676, t2686, t2695, t2698, t2699, t2704, t2707;
  double t2724, t2726, t2730, t2734, t2736, t2737, t2738, t2745;
  double t2747, t2748, t2751, t2754, t2758, t2759, t2762, t2763;
  double t2764, t2766, t2767, t2769, t2770, tv4rho41, t2779, t2781;
  double t2791, t2804, t2808, t2814, t2826, t2830, t2834, t2838;
  double t2839, t2853, t2855, t2866, t2879, t2883, t2887, t2891;
  double t2893, t2895, t2897, t2899, t2910, t2914, t2915, t2917;
  double t2918, t2920, t2922, t2924, t2926, t2930, t2936, t2940;
  double t2941, t2944, t2945, t2948, t2950, tv4rho42, t2971, t2975;
  double t2979, t2984, t2995, t2996, t2999, t3001, t3003, t3005;
  double t3025, t3029, t3041, t3047, t3049, t3051, t3053, t3055;
  double t3056, t3058, t3060, t3061, t3063, t3066, t3067, t3069;
  double t3071, t3082, t3087, t3090, t3093, t3107, t3110, tv4rho43;
  double t3115, t3120, t3127, t3131, t3139, t3144, t3145, t3148;
  double t3150, t3152, t3158, t3159, t3165, t3166, t3182, t3185;
  double t3191, t3199, t3201, t3205, t3206, t3216, t3218, t3224;
  double t3236, t3244, t3249, t3256, t3260, t3274, t3287, t3289;
  double t3293, t3298, t3302, t3305, t3308, t3310, t3319, t3325;
  double t3338, t3367, t3370, tv4rho44, t3374, t3378, t3380, t3382;
  double t3406, t3411, t3418, t3433, t3434, t3468, t3471, t3481;
  double t3486, t3497, t3498, t3500, t3501, t3509, t3511, t3515;
  double t3517, t3519, t3521, t3529, t3534, t3536, t3540, t3544;
  double t3548, t3550, t3552, t3558, t3563, t3572, t3573, t3575;
  double t3594, t3598, t3604, t3616, t3619, tv4rho3sigma0, tv4rho3sigma1, t3624;
  double t3626, t3631, t3634, t3636, t3639, t3641, tv4rho3sigma2, t3643;
  double t3645, t3646, t3649, t3661, t3675, t3690, t3692, t3697;
  double t3707, t3711, t3714, t3717, t3724, t3727, tv4rho3sigma3, tv4rho3sigma4;
  double t3729, t3732, t3735, t3740, t3743, t3748, t3750, t3751;
  double t3754, t3755, t3758, t3759, t3762, t3764, t3765, t3768;
  double t3779, t3781, tv4rho3sigma5, t3787, t3795, t3799, t3811, t3813;
  double tv4rho3sigma6, tv4rho3sigma7, t3817, t3819, t3821, t3833, t3843, t3869;
  double t3871, t3872, t3874, t3876, t3878, t3880, t3882, t3884;
  double t3886, t3888, t3890, t3892, t3894, t3896, t3898, t3901;
  double tv4rho3sigma8, t3913, tv4rho3sigma9, tv4rho3sigma10, t3938, t3944, t3953, t3954;
  double t3962, t3974, t4001, t4020, t4036, t4051, t4055, t4084;
  double t4085, t4124, t4127, tv4rho3sigma11, t4133, t4134, t4142, t4153;
  double t4165, t4167, t4170, t4193, t4215, t4224, t4226, t4241;
  double t4246, t4248, t4265, t4269, t4275, t4281, t4285, t4291;
  double t4296, t4297, t4305, t4307, t4311, t4312, t4333, t4338;
  double t4339, t4341, t4344, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24;
  double t4349, t4354, t4357, t4360, t4363, t4366, t4369, t4372;
  double t4373, t4374, tv4rho2sigma25, t4380, t4394, t4397, t4401, t4405;
  double t4427, t4429, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t4433;
  double t4435, t4463, t4470, t4472, t4474, t4476, t4478, t4480;
  double t4482, t4484, t4486, t4488, t4490, t4492, t4494, t4496;
  double tv4rho2sigma211, t4511, t4512, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216;
  double t4527, t4532, t4537, t4540, t4546, t4589, t4615, t4654;
  double t4659, t4663, t4688, t4701, t4704, tv4rho2sigma217, t4713, t4728;
  double t4737, t4739, t4765, t4773, t4778, t4794, t4799, t4804;
  double t4810, t4835, t4851, t4857, t4858, t4860, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t4867;
  double t4871, t4875, t4879, t4883, t4887, t4893, t4894, t4895;
  double tv4rhosigma39, t4912, t4913, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t4918, t4940, t4947, t4951;
  double t4977, t5014, t5018, t5051, t5053, tv4rhosigma319, t5095, t5104;
  double t5118, t5155, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t5162, t5165, t5219, t5256, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = -t16;
  t91 = my_piecewise5(t14, t11, t10, t15, t89 * t7);
  t92 = 0.1e1 + t91;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t96 = my_piecewise3(t93, t22, t94 * t92);
  t97 = t5 * t96;
  t98 = rho[1] * rho[1];
  t99 = POW_1_3(rho[1]);
  t100 = t99 * t99;
  t102 = 0.1e1 / t100 / t98;
  t104 = t33 * sigma[2] * t102;
  t106 = 0.804e0 + 0.5e1 / 0.972e3 * t104;
  t109 = 0.1804e1 - 0.646416e0 / t106;
  t110 = sigma[2] * sigma[2];
  t111 = t98 * t98;
  t112 = t111 * rho[1];
  t114 = 0.1e1 / t99 / t112;
  t118 = 0.1e3 - t49 * t110 * t114 / 0.576e3;
  t120 = sqrt(sigma[2]);
  t122 = 0.1e1 / t99 / rho[1];
  t124 = t61 * t120 * t122;
  t125 = pow(t124, 0.35e1);
  t127 = 0.1e1 + t104 / 0.24e2;
  t130 = t109 * t118 + 0.87153829697982569831e-4 * t125 * t127;
  t131 = t27 * t130;
  t132 = t110 * sigma[2];
  t134 = t111 * t111;
  t135 = 0.1e1 / t134;
  t138 = 0.1e3 + t75 * t132 * t135 / 0.2304e4;
  t139 = 0.1e1 / t138;
  t140 = t131 * t139;
  t143 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t140);
  tzk0 = t87 + t143;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t144 = t6 * t6;
  t145 = 0.1e1 / t144;
  t146 = t16 * t145;
  t148 = my_piecewise5(t10, 0, t14, 0, t7 - t146);
  t151 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t148);
  t152 = t5 * t151;
  t155 = t27 * t27;
  t156 = 0.1e1 / t155;
  t157 = t156 * t72;
  t158 = t157 * t83;
  t160 = t26 * t158 / 0.8e1;
  t161 = t42 * t42;
  t162 = 0.1e1 / t161;
  t163 = t162 * t28;
  t164 = t163 * t32;
  t165 = t34 * rho[0];
  t167 = 0.1e1 / t36 / t165;
  t172 = t45 * t46;
  t173 = t48 * t50;
  t174 = t51 * t34;
  t176 = 0.1e1 / t35 / t174;
  t180 = pow(t66, 0.25e1);
  t182 = t180 * t69 * t46;
  t183 = t60 * t62;
  t185 = 0.1e1 / t35 / t34;
  t189 = t67 * t28;
  t190 = t32 * sigma[0];
  t194 = -0.88671604938271604938e-2 * t164 * sigma[0] * t167 * t58 + t172 * t173 * t176 / 0.108e3 - 0.40671787192391865921e-3 * t182 * t183 * t185 - 0.96837588553313966479e-5 * t189 * t190 * t167;
  t195 = t27 * t194;
  t196 = t195 * t83;
  t201 = t2 / t3 / t74;
  t202 = t25 * t27;
  t203 = t201 * t202;
  t204 = t82 * t82;
  t205 = 0.1e1 / t204;
  t206 = t72 * t205;
  t207 = t78 * rho[0];
  t208 = 0.1e1 / t207;
  t209 = t76 * t208;
  t210 = t206 * t209;
  t214 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t84 - t160 - 0.3e1 / 0.8e1 * t26 * t196 - t203 * t210 / 0.768e3);
  t215 = t89 * t145;
  t217 = my_piecewise5(t14, 0, t10, 0, -t7 - t215);
  t220 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t217);
  t221 = t5 * t220;
  t224 = t156 * t130;
  t225 = t224 * t139;
  t227 = t97 * t225 / 0.8e1;
  t229 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t140 - t227);
  tvrho0 = t87 + t143 + t6 * (t214 + t229);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t233 = my_piecewise5(t10, 0, t14, 0, -t7 - t146);
  t236 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t233);
  t237 = t5 * t236;
  t241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t84 - t160);
  t243 = my_piecewise5(t14, 0, t10, 0, t7 - t215);
  t246 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t243);
  t247 = t5 * t246;
  t250 = t106 * t106;
  t251 = 0.1e1 / t250;
  t252 = t251 * t28;
  t253 = t252 * t32;
  t254 = t98 * rho[1];
  t256 = 0.1e1 / t100 / t254;
  t261 = t109 * t46;
  t262 = t48 * t110;
  t263 = t111 * t98;
  t265 = 0.1e1 / t99 / t263;
  t269 = pow(t124, 0.25e1);
  t271 = t269 * t127 * t46;
  t272 = t60 * t120;
  t274 = 0.1e1 / t99 / t98;
  t278 = t125 * t28;
  t279 = t32 * sigma[2];
  t283 = -0.88671604938271604938e-2 * t253 * sigma[2] * t256 * t118 + t261 * t262 * t265 / 0.108e3 - 0.40671787192391865921e-3 * t271 * t272 * t274 - 0.96837588553313966479e-5 * t278 * t279 * t256;
  t284 = t27 * t283;
  t285 = t284 * t139;
  t288 = t96 * t27;
  t289 = t201 * t288;
  t290 = t138 * t138;
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t134 * rho[1];
  t294 = 0.1e1 / t293;
  t295 = t132 * t294;
  t296 = t292 * t295;
  t300 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t140 - t227 - 0.3e1 / 0.8e1 * t97 * t285 - t289 * t296 / 0.768e3);
  tvrho1 = t87 + t143 + t6 * (t241 + t300);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t303 = t32 * t38;
  t307 = t48 * sigma[0];
  t311 = 0.1e1 / t62;
  t312 = t60 * t311;
  t318 = 0.33251851851851851852e-2 * t163 * t303 * t58 - t172 * t307 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t182 * t312 * t64 + 0.3631409570749273743e-5 * t189 * t303;
  t319 = t27 * t318;
  t320 = t319 * t83;
  t323 = t50 * t79;
  t324 = t206 * t323;
  t328 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t320 + t203 * t324 / 0.2048e4);
  tvsigma0 = t6 * t328;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t329 = t32 * t102;
  t333 = t48 * sigma[2];
  t337 = 0.1e1 / t120;
  t338 = t60 * t337;
  t344 = 0.33251851851851851852e-2 * t252 * t329 * t118 - t261 * t333 * t114 / 0.288e3 + 0.1525192019714694972e-3 * t271 * t338 * t122 + 0.3631409570749273743e-5 * t278 * t329;
  t345 = t27 * t344;
  t346 = t345 * t139;
  t349 = t110 * t135;
  t350 = t292 * t349;
  t354 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t346 + t289 * t350 / 0.2048e4);
  tvsigma2 = t6 * t354;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t357 = t23 * t23;
  t358 = 0.1e1 / t357;
  t359 = t148 * t148;
  t362 = t144 * t6;
  t363 = 0.1e1 / t362;
  t364 = t16 * t363;
  t367 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t145 + 0.2e1 * t364);
  t371 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t359 + 0.4e1 / 0.3e1 * t23 * t367);
  t372 = t5 * t371;
  t375 = t152 * t158;
  t379 = t151 * t27;
  t380 = t201 * t379;
  t384 = 0.1e1 / t155 / t6;
  t386 = t384 * t72 * t83;
  t388 = t26 * t386 / 0.12e2;
  t390 = t156 * t194 * t83;
  t391 = t26 * t390;
  t393 = t25 * t156;
  t394 = t201 * t393;
  t395 = t394 * t210;
  t398 = 0.1e1 / t161 / t42;
  t399 = t398 * t46;
  t400 = t399 * t48;
  t401 = t51 * t165;
  t403 = 0.1e1 / t35 / t401;
  t409 = 0.1e1 / t36 / t51;
  t414 = t162 * t75;
  t415 = t78 * t34;
  t416 = 0.1e1 / t415;
  t417 = t76 * t416;
  t420 = t162 * t76;
  t426 = POW_3_2(t66);
  t427 = t426 * t69;
  t428 = t427 * t28;
  t429 = t190 * t409;
  t432 = 0.1e1 / t29;
  t433 = t180 * t432;
  t434 = t62 * sigma[0];
  t435 = 0.1e1 / t174;
  t440 = 0.1e1 / t35 / t165;
  t446 = -0.24326914935053938255e-3 * t400 * t50 * t403 * t58 + 0.32512921810699588477e-1 * t164 * sigma[0] * t409 * t58 - 0.49262002743484224966e-3 * t414 * t417 - 0.50572284599482008956e-5 * t420 * t416 - 0.19e2 / 0.324e3 * t172 * t173 * t403 + 0.81343574384783731842e-2 * t428 * t429 + 0.54229049589855821228e-3 * t433 * t434 * t435 + 0.94900836782247687149e-3 * t182 * t183 * t440 + 0.35507115802881787709e-4 * t189 * t429;
  t448 = t27 * t446 * t83;
  t451 = t194 * t205;
  t452 = t451 * t209;
  t455 = t74 * t74;
  t458 = t2 / t3 / t455;
  t459 = t458 * t202;
  t461 = 0.1e1 / t204 / t82;
  t462 = t72 * t461;
  t463 = t50 * t50;
  t464 = t463 * t50;
  t465 = t78 * t78;
  t467 = 0.1e1 / t465 / t34;
  t468 = t464 * t467;
  t469 = t462 * t468;
  t472 = t206 * t417;
  t475 = -0.3e1 / 0.8e1 * t372 * t84 - t375 / 0.4e1 - 0.3e1 / 0.4e1 * t152 * t196 - t380 * t210 / 0.384e3 + t388 - t391 / 0.4e1 - t395 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t448 - t203 * t452 / 0.384e3 - t459 * t469 / 0.110592e6 + 0.3e1 / 0.256e3 * t203 * t472;
  t476 = my_piecewise3(t1, 0, t475);
  t477 = t94 * t94;
  t478 = 0.1e1 / t477;
  t479 = t217 * t217;
  t482 = t89 * t363;
  t485 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t145 + 0.2e1 * t482);
  t489 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t94 * t485);
  t490 = t5 * t489;
  t493 = t221 * t225;
  t496 = t384 * t130 * t139;
  t498 = t97 * t496 / 0.12e2;
  t500 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t490 * t140 - t493 / 0.4e1 + t498);
  tv2rho20 = 0.2e1 * t214 + 0.2e1 * t229 + t6 * (t476 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t503 = t358 * t233;
  t507 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t364);
  t511 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t23 * t507);
  t512 = t5 * t511;
  t515 = t237 * t158;
  t519 = t236 * t27;
  t520 = t201 * t519;
  t527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t512 * t84 - t515 / 0.8e1 - 0.3e1 / 0.8e1 * t237 * t196 - t520 * t210 / 0.768e3 - t375 / 0.8e1 + t388 - t391 / 0.8e1 - t395 / 0.2304e4);
  t528 = t478 * t243;
  t532 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t482);
  t536 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t528 * t217 + 0.4e1 / 0.3e1 * t94 * t532);
  t537 = t5 * t536;
  t540 = t247 * t225;
  t546 = t156 * t283 * t139;
  t547 = t97 * t546;
  t549 = t220 * t27;
  t550 = t201 * t549;
  t553 = t96 * t156;
  t554 = t201 * t553;
  t555 = t554 * t296;
  t558 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t537 * t140 - t540 / 0.8e1 - t493 / 0.8e1 + t498 - 0.3e1 / 0.8e1 * t221 * t285 - t547 / 0.8e1 - t550 * t296 / 0.768e3 - t555 / 0.2304e4);
  tv2rho21 = t214 + t229 + t241 + t300 + t6 * (t527 + t558);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t563 = t233 * t233;
  t568 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t145 + 0.2e1 * t364);
  t572 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t358 * t563 + 0.4e1 / 0.3e1 * t23 * t568);
  t573 = t5 * t572;
  t578 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t573 * t84 - t515 / 0.4e1 + t388);
  t579 = t243 * t243;
  t584 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t145 + 0.2e1 * t482);
  t588 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t478 * t579 + 0.4e1 / 0.3e1 * t94 * t584);
  t589 = t5 * t588;
  t595 = t246 * t27;
  t596 = t201 * t595;
  t602 = 0.1e1 / t250 / t106;
  t603 = t602 * t46;
  t604 = t603 * t48;
  t605 = t111 * t254;
  t607 = 0.1e1 / t99 / t605;
  t613 = 0.1e1 / t100 / t111;
  t618 = t251 * t75;
  t619 = t134 * t98;
  t620 = 0.1e1 / t619;
  t621 = t132 * t620;
  t624 = t251 * t132;
  t630 = POW_3_2(t124);
  t631 = t630 * t127;
  t632 = t631 * t28;
  t633 = t279 * t613;
  t636 = t269 * t432;
  t637 = t120 * sigma[2];
  t638 = 0.1e1 / t263;
  t643 = 0.1e1 / t99 / t254;
  t649 = -0.24326914935053938255e-3 * t604 * t110 * t607 * t118 + 0.32512921810699588477e-1 * t253 * sigma[2] * t613 * t118 - 0.49262002743484224966e-3 * t618 * t621 - 0.50572284599482008956e-5 * t624 * t620 - 0.19e2 / 0.324e3 * t261 * t262 * t607 + 0.81343574384783731842e-2 * t632 * t633 + 0.54229049589855821228e-3 * t636 * t637 * t638 + 0.94900836782247687149e-3 * t271 * t272 * t643 + 0.35507115802881787709e-4 * t278 * t633;
  t651 = t27 * t649 * t139;
  t654 = t283 * t291;
  t655 = t654 * t295;
  t658 = t458 * t288;
  t660 = 0.1e1 / t290 / t138;
  t661 = t130 * t660;
  t662 = t110 * t110;
  t663 = t662 * t110;
  t664 = t134 * t134;
  t666 = 0.1e1 / t664 / t98;
  t667 = t663 * t666;
  t668 = t661 * t667;
  t671 = t292 * t621;
  t674 = -0.3e1 / 0.8e1 * t589 * t140 - t540 / 0.4e1 - 0.3e1 / 0.4e1 * t247 * t285 - t596 * t296 / 0.384e3 + t498 - t547 / 0.4e1 - t555 / 0.1152e4 - 0.3e1 / 0.8e1 * t97 * t651 - t289 * t655 / 0.384e3 - t658 * t668 / 0.110592e6 + 0.3e1 / 0.256e3 * t289 * t671;
  t675 = my_piecewise3(t88, 0, t674);
  tv2rho22 = 0.2e1 * t241 + 0.2e1 * t300 + t6 * (t578 + t675);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t681 = t156 * t318 * t83;
  t683 = t26 * t681 / 0.8e1;
  t688 = t32 * t167;
  t692 = t208 * t50;
  t695 = t162 * t50;
  t704 = 0.1e1 / t52;
  t713 = 0.91225931006452268455e-4 * t400 * t176 * t58 * sigma[0] - 0.88671604938271604939e-2 * t163 * t688 * t58 + 0.18473251028806584362e-3 * t414 * t692 + 0.18964606724805753359e-5 * t695 * t208 + t172 * t307 * t176 / 0.54e2 - 0.3050384039429389944e-2 * t427 * t33 * t167 - 0.2033589359619593296e-3 * t433 * t62 * t704 - 0.2033589359619593296e-3 * t182 * t312 * t185 - 0.9683758855331396648e-5 * t189 * t688;
  t715 = t27 * t713 * t83;
  t718 = t318 * t205;
  t719 = t718 * t209;
  t725 = t394 * t324 / 0.6144e4;
  t726 = t451 * t323;
  t729 = t463 * sigma[0];
  t730 = t465 * rho[0];
  t731 = 0.1e1 / t730;
  t732 = t729 * t731;
  t733 = t462 * t732;
  t736 = t206 * t692;
  t740 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t152 * t320 - t683 - 0.3e1 / 0.8e1 * t26 * t715 - t203 * t719 / 0.768e3 + t380 * t324 / 0.2048e4 + t725 + t203 * t726 / 0.2048e4 + t459 * t733 / 0.294912e6 - t203 * t736 / 0.256e3);
  tv2rhosigma0 = t6 * t740 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t745 = t156 * t344 * t139;
  t747 = t97 * t745 / 0.8e1;
  t751 = t554 * t350 / 0.6144e4;
  t753 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t346 - t747 + t550 * t350 / 0.2048e4 + t751);
  tv2rhosigma2 = t6 * t753 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t760 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t320 - t683 + t520 * t324 / 0.2048e4 + t725);
  tv2rhosigma3 = t6 * t760 + t328;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t768 = t32 * t256;
  t772 = t294 * t110;
  t775 = t251 * t110;
  t784 = 0.1e1 / t112;
  t793 = 0.91225931006452268455e-4 * t604 * t265 * t118 * sigma[2] - 0.88671604938271604939e-2 * t252 * t768 * t118 + 0.18473251028806584362e-3 * t618 * t772 + 0.18964606724805753359e-5 * t775 * t294 + t261 * t333 * t265 / 0.54e2 - 0.3050384039429389944e-2 * t631 * t33 * t256 - 0.2033589359619593296e-3 * t636 * t120 * t784 - 0.2033589359619593296e-3 * t271 * t338 * t274 - 0.9683758855331396648e-5 * t278 * t768;
  t795 = t27 * t793 * t139;
  t798 = t344 * t291;
  t799 = t798 * t295;
  t804 = t654 * t349;
  t807 = t662 * sigma[2];
  t808 = t664 * rho[1];
  t809 = 0.1e1 / t808;
  t810 = t807 * t809;
  t811 = t661 * t810;
  t814 = t292 * t772;
  t818 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t247 * t346 - t747 - 0.3e1 / 0.8e1 * t97 * t795 - t289 * t799 / 0.768e3 + t596 * t350 / 0.2048e4 + t751 + t289 * t804 / 0.2048e4 + t658 * t811 / 0.294912e6 - t289 * t814 / 0.256e3);
  tv2rhosigma5 = t6 * t818 + t354;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t820 = t48 * t54;
  t824 = t79 * sigma[0];
  t827 = t162 * t79;
  t832 = 0.1e1 / sigma[0];
  t833 = t32 * t832;
  t837 = 0.1e1 / t51;
  t841 = 0.1e1 / t434;
  t842 = t60 * t841;
  t846 = -0.34209724127419600671e-4 * t399 * t820 * t58 - 0.69274691358024691358e-4 * t414 * t824 - 0.71117275218021575094e-6 * t827 * sigma[0] - t172 * t820 / 0.288e3 + 0.1143894014786021229e-2 * t428 * t833 * t38 + 0.76259600985734748602e-4 * t433 * t837 * t311 - 0.762596009857347486e-4 * t182 * t842 * t64;
  t848 = t27 * t846 * t83;
  t851 = t718 * t323;
  t854 = 0.1e1 / t465;
  t855 = t463 * t854;
  t856 = t462 * t855;
  t859 = t206 * t824;
  t863 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t848 + t203 * t851 / 0.1024e4 - t459 * t856 / 0.786432e6 + t203 * t859 / 0.1024e4);
  tv2sigma20 = t6 * t863;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t864 = t48 * t114;
  t868 = t135 * sigma[2];
  t871 = t251 * t135;
  t876 = 0.1e1 / sigma[2];
  t877 = t32 * t876;
  t881 = 0.1e1 / t111;
  t885 = 0.1e1 / t637;
  t886 = t60 * t885;
  t890 = -0.34209724127419600671e-4 * t603 * t864 * t118 - 0.69274691358024691358e-4 * t618 * t868 - 0.71117275218021575094e-6 * t871 * sigma[2] - t261 * t864 / 0.288e3 + 0.1143894014786021229e-2 * t632 * t877 * t102 + 0.76259600985734748602e-4 * t636 * t881 * t337 - 0.762596009857347486e-4 * t271 * t886 * t122;
  t892 = t27 * t890 * t139;
  t895 = t798 * t349;
  t898 = 0.1e1 / t664;
  t899 = t662 * t898;
  t900 = t661 * t899;
  t903 = t292 * t868;
  t907 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t892 + t289 * t895 / 0.1024e4 - t658 * t900 / 0.786432e6 + t289 * t903 / 0.1024e4);
  tv2sigma25 = t6 * t907;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t912 = t152 * t390;
  t916 = t372 * t158;
  t918 = t152 * t386;
  t921 = 0.1e1 / t155 / t144;
  t923 = t921 * t72 * t83;
  t925 = 0.5e1 / 0.36e2 * t26 * t923;
  t926 = t161 * t161;
  t927 = 0.1e1 / t926;
  t928 = t927 * t75;
  t929 = t78 * t165;
  t930 = 0.1e1 / t929;
  t931 = t76 * t930;
  t936 = 0.1e1 / t35 / t78;
  t941 = t398 * t28;
  t943 = 0.1e1 / t31 / t74;
  t944 = t943 * t463;
  t945 = t78 * t52;
  t947 = 0.1e1 / t36 / t945;
  t952 = 0.1e1 / t36 / t52;
  t959 = t398 * t75;
  t960 = t959 * t463;
  t962 = t947 * t28 * t32;
  t965 = t398 * t463;
  t970 = t173 * t936;
  t973 = sqrt(t66);
  t974 = t973 * t69;
  t975 = t432 * t434;
  t976 = 0.1e1 / t401;
  t980 = t426 * t46;
  t983 = t190 * t952;
  t986 = t426 * t432;
  t987 = t986 * t50;
  t989 = t936 * t46 * t60;
  t996 = 0.1e1 / t35 / t51;
  t1002 = -0.60066456629762810506e-4 * t928 * t931 * t58 + 0.2675960642855933208e-2 * t400 * t50 * t936 * t58 - 0.13514952741696632364e-4 * t941 * t944 * t947 - 0.15172696844993141289e0 * t164 * sigma[0] * t952 * t58 + 0.6732473708276177412e-2 * t414 * t931 - 0.13514952741696632364e-4 * t960 * t962 - 0.13874426501915503143e-6 * t965 * t962 + 0.82601398179153947962e-4 * t420 * t930 + 0.209e3 / 0.486e3 * t172 * t970 - 0.9761228926174047821e-1 * t974 * t975 * t976 - 0.90381749316426368713e-3 * t980 * t970 - 0.5694050206934861229e-1 * t428 * t983 - 0.18076349863285273742e-2 * t987 * t989 - 0.48806144630870239106e-2 * t433 * t434 * t976 - 0.3163361226074922905e-2 * t182 * t183 * t996 - 0.16569987374678167598e-3 * t189 * t983;
  t1004 = t27 * t1002 * t83;
  t1008 = t384 * t194 * t83;
  t1009 = t26 * t1008;
  t1012 = t156 * t446 * t83;
  t1013 = t26 * t1012;
  t1016 = 0.1e1 / t357 / t19;
  t1017 = t359 * t148;
  t1020 = t358 * t148;
  t1023 = t144 * t144;
  t1024 = 0.1e1 / t1023;
  t1025 = t16 * t1024;
  t1028 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t363 - 0.6e1 * t1025);
  t1032 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1016 * t1017 + 0.4e1 / 0.3e1 * t1020 * t367 + 0.4e1 / 0.3e1 * t23 * t1028);
  t1033 = t5 * t1032;
  t1039 = t2 / t3 / t455 / t74;
  t1040 = t1039 * t202;
  t1041 = t204 * t204;
  t1042 = 0.1e1 / t1041;
  t1043 = t72 * t1042;
  t1044 = t463 * t463;
  t1045 = t1044 * sigma[0];
  t1047 = 0.1e1 / t465 / t929;
  t1048 = t1045 * t1047;
  t1049 = t1043 * t1048;
  t1052 = t394 * t452;
  t1054 = -0.9e1 / 0.8e1 * t372 * t196 - 0.3e1 / 0.4e1 * t912 - 0.9e1 / 0.8e1 * t152 * t448 - 0.3e1 / 0.8e1 * t916 + t918 / 0.4e1 - t925 - 0.3e1 / 0.8e1 * t26 * t1004 + t1009 / 0.4e1 - 0.3e1 / 0.8e1 * t1013 - 0.3e1 / 0.8e1 * t1033 * t84 - t1040 * t1049 / 0.10616832e8 - t1052 / 0.384e3;
  t1055 = t458 * t393;
  t1056 = t1055 * t469;
  t1058 = t446 * t205;
  t1059 = t1058 * t209;
  t1062 = t194 * t461;
  t1063 = t1062 * t468;
  t1066 = t371 * t27;
  t1067 = t201 * t1066;
  t1070 = t151 * t156;
  t1071 = t201 * t1070;
  t1072 = t1071 * t210;
  t1076 = t458 * t379;
  t1079 = t25 * t384;
  t1080 = t201 * t1079;
  t1081 = t1080 * t210;
  t1085 = t394 * t472;
  t1087 = t451 * t417;
  t1091 = 0.1e1 / t465 / t165;
  t1092 = t464 * t1091;
  t1093 = t462 * t1092;
  t1096 = t206 * t931;
  t1099 = -t1056 / 0.110592e6 - t203 * t1059 / 0.256e3 - t459 * t1063 / 0.36864e5 - t1067 * t210 / 0.256e3 - t1072 / 0.384e3 - t380 * t452 / 0.128e3 - t1076 * t469 / 0.36864e5 + t1081 / 0.1152e4 + 0.9e1 / 0.256e3 * t380 * t472 + 0.3e1 / 0.256e3 * t1085 + 0.9e1 / 0.256e3 * t203 * t1087 + t459 * t1093 / 0.4096e4 - 0.15e2 / 0.128e3 * t203 * t1096;
  t1101 = my_piecewise3(t1, 0, t1054 + t1099);
  t1103 = 0.1e1 / t477 / t92;
  t1104 = t479 * t217;
  t1107 = t478 * t217;
  t1110 = t89 * t1024;
  t1113 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t363 - 0.6e1 * t1110);
  t1117 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1103 * t1104 + 0.4e1 / 0.3e1 * t1107 * t485 + 0.4e1 / 0.3e1 * t94 * t1113);
  t1118 = t5 * t1117;
  t1121 = t490 * t225;
  t1123 = t221 * t496;
  t1126 = t921 * t130 * t139;
  t1128 = 0.5e1 / 0.36e2 * t97 * t1126;
  t1130 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1118 * t140 - 0.3e1 / 0.8e1 * t1121 + t1123 / 0.4e1 - t1128);
  tv3rho30 = 0.3e1 * t476 + 0.3e1 * t500 + t6 * (t1101 + t1130);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1133 = 0.2e1 * t527;
  t1134 = 0.2e1 * t558;
  t1135 = t237 * t386;
  t1138 = t512 * t158 / 0.4e1;
  t1141 = t1016 * t233;
  t1144 = t358 * t507;
  t1149 = 0.2e1 * t363;
  t1150 = 0.6e1 * t1025;
  t1152 = my_piecewise5(t10, 0, t14, 0, t1149 - t1150);
  t1156 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1141 * t359 + 0.8e1 / 0.9e1 * t1144 * t148 + 0.4e1 / 0.9e1 * t503 * t367 + 0.4e1 / 0.3e1 * t23 * t1152);
  t1157 = t5 * t1156;
  t1163 = t237 * t390 / 0.4e1;
  t1167 = t511 * t27;
  t1168 = t201 * t1167;
  t1171 = t1135 / 0.12e2 - t1138 - t925 - 0.3e1 / 0.8e1 * t237 * t448 - 0.3e1 / 0.8e1 * t1157 * t84 - 0.3e1 / 0.4e1 * t512 * t196 - t1163 + t1009 / 0.6e1 - t1013 / 0.8e1 - t912 / 0.4e1 - t1168 * t210 / 0.384e3;
  t1172 = t236 * t156;
  t1173 = t201 * t1172;
  t1175 = t1173 * t210 / 0.1152e4;
  t1178 = t458 * t519;
  t1190 = -t1175 - t520 * t452 / 0.384e3 - t1178 * t469 / 0.110592e6 - t1052 / 0.1152e4 - t1056 / 0.331776e6 - t1072 / 0.1152e4 + t1081 / 0.1728e4 - t916 / 0.8e1 + t918 / 0.6e1 + t1085 / 0.256e3 + 0.3e1 / 0.256e3 * t520 * t472;
  t1192 = my_piecewise3(t1, 0, t1171 + t1190);
  t1193 = t1103 * t243;
  t1196 = t478 * t532;
  t1201 = 0.6e1 * t1110;
  t1203 = my_piecewise5(t14, 0, t10, 0, -t1149 - t1201);
  t1207 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1193 * t479 + 0.8e1 / 0.9e1 * t1196 * t217 + 0.4e1 / 0.9e1 * t528 * t485 + 0.4e1 / 0.3e1 * t94 * t1203);
  t1208 = t5 * t1207;
  t1212 = t537 * t225 / 0.4e1;
  t1213 = t247 * t496;
  t1220 = t221 * t546 / 0.4e1;
  t1222 = t384 * t283 * t139;
  t1223 = t97 * t1222;
  t1225 = t489 * t27;
  t1226 = t201 * t1225;
  t1229 = t220 * t156;
  t1230 = t201 * t1229;
  t1232 = t1230 * t296 / 0.1152e4;
  t1233 = t96 * t384;
  t1234 = t201 * t1233;
  t1235 = t1234 * t296;
  t1237 = -0.3e1 / 0.8e1 * t1208 * t140 - t1212 + t1213 / 0.12e2 - t1121 / 0.8e1 + t1123 / 0.6e1 - t1128 - 0.3e1 / 0.8e1 * t490 * t285 - t1220 + t1223 / 0.12e2 - t1226 * t296 / 0.768e3 - t1232 + t1235 / 0.3456e4;
  t1238 = my_piecewise3(t88, 0, t1237);
  tv3rho31 = t476 + t500 + t1133 + t1134 + t6 * (t1192 + t1238);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1241 = t1016 * t563;
  t1246 = t358 * t568;
  t1250 = my_piecewise5(t10, 0, t14, 0, -t1149 - t1150);
  t1254 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1241 * t148 + 0.8e1 / 0.9e1 * t503 * t507 + 0.4e1 / 0.9e1 * t1246 * t148 + 0.4e1 / 0.3e1 * t23 * t1250);
  t1255 = t5 * t1254;
  t1258 = t573 * t158;
  t1262 = t572 * t27;
  t1263 = t201 * t1262;
  t1270 = -0.3e1 / 0.8e1 * t1255 * t84 - t1258 / 0.8e1 - 0.3e1 / 0.8e1 * t573 * t196 - t1263 * t210 / 0.768e3 - t1138 + t1135 / 0.6e1 - t1163 - t1175 + t918 / 0.12e2 - t925 + t1009 / 0.12e2 + t1081 / 0.3456e4;
  t1271 = my_piecewise3(t1, 0, t1270);
  t1272 = t1103 * t579;
  t1277 = t478 * t584;
  t1281 = my_piecewise5(t14, 0, t10, 0, t1149 - t1201);
  t1285 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1272 * t217 + 0.8e1 / 0.9e1 * t528 * t532 + 0.4e1 / 0.9e1 * t1277 * t217 + 0.4e1 / 0.3e1 * t94 * t1281);
  t1286 = t5 * t1285;
  t1289 = t589 * t225;
  t1294 = t247 * t546;
  t1296 = t536 * t27;
  t1297 = t201 * t1296;
  t1300 = t246 * t156;
  t1301 = t201 * t1300;
  t1302 = t1301 * t296;
  t1305 = -0.3e1 / 0.8e1 * t1286 * t140 - t1289 / 0.8e1 - t1212 + t1213 / 0.6e1 - 0.3e1 / 0.4e1 * t537 * t285 - t1294 / 0.4e1 - t1297 * t296 / 0.384e3 - t1302 / 0.1152e4 + t1123 / 0.12e2 - t1128 - t1220;
  t1311 = t156 * t649 * t139;
  t1312 = t97 * t1311;
  t1316 = t554 * t655;
  t1318 = t458 * t549;
  t1321 = t458 * t553;
  t1322 = t1321 * t668;
  t1326 = t554 * t671;
  t1328 = t1223 / 0.6e1 - t1232 + t1235 / 0.1728e4 - 0.3e1 / 0.8e1 * t221 * t651 - t1312 / 0.8e1 - t550 * t655 / 0.384e3 - t1316 / 0.1152e4 - t1318 * t668 / 0.110592e6 - t1322 / 0.331776e6 + 0.3e1 / 0.256e3 * t550 * t671 + t1326 / 0.256e3;
  t1330 = my_piecewise3(t88, 0, t1305 + t1328);
  tv3rho32 = t1133 + t1134 + t578 + t675 + t6 * (t1271 + t1330);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1335 = t563 * t233;
  t1342 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t363 - 0.6e1 * t1025);
  t1346 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1016 * t1335 + 0.4e1 / 0.3e1 * t503 * t568 + 0.4e1 / 0.3e1 * t23 * t1342);
  t1347 = t5 * t1346;
  t1353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1347 * t84 - 0.3e1 / 0.8e1 * t1258 + t1135 / 0.4e1 - t925);
  t1354 = t250 * t250;
  t1355 = 0.1e1 / t1354;
  t1356 = t1355 * t75;
  t1357 = t134 * t254;
  t1358 = 0.1e1 / t1357;
  t1359 = t132 * t1358;
  t1364 = 0.1e1 / t99 / t134;
  t1369 = t602 * t28;
  t1370 = t943 * t662;
  t1371 = t134 * t112;
  t1373 = 0.1e1 / t100 / t1371;
  t1378 = 0.1e1 / t100 / t112;
  t1385 = t602 * t75;
  t1386 = t1385 * t662;
  t1388 = t1373 * t28 * t32;
  t1391 = t602 * t662;
  t1396 = t262 * t1364;
  t1399 = sqrt(t124);
  t1400 = t1399 * t127;
  t1401 = t432 * t637;
  t1402 = 0.1e1 / t605;
  t1406 = t630 * t46;
  t1409 = t279 * t1378;
  t1412 = t630 * t432;
  t1413 = t1412 * t110;
  t1415 = t1364 * t46 * t60;
  t1422 = 0.1e1 / t99 / t111;
  t1428 = -0.60066456629762810506e-4 * t1356 * t1359 * t118 + 0.2675960642855933208e-2 * t604 * t110 * t1364 * t118 - 0.13514952741696632364e-4 * t1369 * t1370 * t1373 - 0.15172696844993141289e0 * t253 * sigma[2] * t1378 * t118 + 0.6732473708276177412e-2 * t618 * t1359 - 0.13514952741696632364e-4 * t1386 * t1388 - 0.13874426501915503143e-6 * t1391 * t1388 + 0.82601398179153947962e-4 * t624 * t1358 + 0.209e3 / 0.486e3 * t261 * t1396 - 0.9761228926174047821e-1 * t1400 * t1401 * t1402 - 0.90381749316426368713e-3 * t1406 * t1396 - 0.5694050206934861229e-1 * t632 * t1409 - 0.18076349863285273742e-2 * t1413 * t1415 - 0.48806144630870239106e-2 * t636 * t637 * t1402 - 0.3163361226074922905e-2 * t271 * t272 * t1422 - 0.16569987374678167598e-3 * t278 * t1409;
  t1430 = t27 * t1428 * t139;
  t1433 = t579 * t243;
  t1440 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t363 - 0.6e1 * t1110);
  t1444 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1103 * t1433 + 0.4e1 / 0.3e1 * t528 * t584 + 0.4e1 / 0.3e1 * t94 * t1440);
  t1445 = t5 * t1444;
  t1459 = t654 * t621;
  t1462 = -0.3e1 / 0.8e1 * t97 * t1430 - 0.3e1 / 0.8e1 * t1445 * t140 - 0.9e1 / 0.8e1 * t589 * t285 - 0.9e1 / 0.8e1 * t247 * t651 - 0.3e1 / 0.8e1 * t1312 - 0.3e1 / 0.8e1 * t1289 - 0.3e1 / 0.4e1 * t1294 + t1213 / 0.4e1 + t1223 / 0.4e1 - t1128 + 0.9e1 / 0.256e3 * t596 * t671 + 0.9e1 / 0.256e3 * t289 * t1459;
  t1464 = 0.1e1 / t664 / t254;
  t1465 = t663 * t1464;
  t1466 = t661 * t1465;
  t1469 = t292 * t1359;
  t1477 = t283 * t660;
  t1478 = t1477 * t667;
  t1481 = t1039 * t288;
  t1482 = t290 * t290;
  t1483 = 0.1e1 / t1482;
  t1484 = t130 * t1483;
  t1485 = t662 * t662;
  t1486 = t1485 * sigma[2];
  t1488 = 0.1e1 / t664 / t1357;
  t1489 = t1486 * t1488;
  t1490 = t1484 * t1489;
  t1493 = t649 * t291;
  t1494 = t1493 * t295;
  t1497 = t588 * t27;
  t1498 = t201 * t1497;
  t1503 = t458 * t595;
  t1506 = t658 * t1466 / 0.4096e4 - 0.15e2 / 0.128e3 * t289 * t1469 + t1235 / 0.1152e4 - t1302 / 0.384e3 - t1316 / 0.384e3 - t1322 / 0.110592e6 + 0.3e1 / 0.256e3 * t1326 - t658 * t1478 / 0.36864e5 - t1481 * t1490 / 0.10616832e8 - t289 * t1494 / 0.256e3 - t1498 * t296 / 0.256e3 - t596 * t655 / 0.128e3 - t1503 * t668 / 0.36864e5;
  t1508 = my_piecewise3(t88, 0, t1462 + t1506);
  tv3rho33 = 0.3e1 * t578 + 0.3e1 * t675 + t6 * (t1353 + t1508);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1515 = t156 * t713 * t83;
  t1516 = t26 * t1515;
  t1519 = t384 * t318 * t83;
  t1521 = t26 * t1519 / 0.12e2;
  t1522 = t152 * t681;
  t1524 = t416 * t58;
  t1532 = t78 * t51;
  t1534 = 0.1e1 / t36 / t1532;
  t1535 = t943 * t1534;
  t1539 = t32 * t409;
  t1543 = t416 * t50;
  t1546 = t959 * t1534;
  t1548 = t76 * t28 * t32;
  t1551 = t398 * t76;
  t1558 = t307 * t403;
  t1570 = t986 * sigma[0];
  t1572 = t403 * t46 * t60;
  t1583 = 0.2252492123616105394e-4 * t928 * t1524 * t50 - 0.8210333790580704161e-3 * t400 * t403 * t58 * sigma[0] + 0.50681072781362371364e-5 * t941 * t1535 * t76 + 0.32512921810699588478e-1 * t163 * t1539 * t58 - 0.21552126200274348423e-2 * t414 * t1543 + 0.50681072781362371364e-5 * t1546 * t1548 + 0.52029099382183136787e-7 * t1551 * t1534 * t28 * t32 - 0.27182602972221579814e-4 * t695 * t416 - 0.19e2 / 0.162e3 * t172 * t1558 + 0.36604608473152679328e-1 * t974 * t432 * t435 * t62 + 0.33893155993659888267e-3 * t980 * t1558 + 0.1525192019714694972e-1 * t427 * t33 * t409 + 0.67786311987319776533e-3 * t1570 * t1572 + 0.14235125517337153072e-2 * t433 * t62 * t435 + 0.47450418391123843573e-3 * t182 * t312 * t440 + 0.35507115802881787709e-4 * t189 * t1539;
  t1585 = t27 * t1583 * t83;
  t1591 = 0.1e1 / t465 / t415;
  t1592 = t1044 * t1591;
  t1593 = t1043 * t1592;
  t1596 = t713 * t205;
  t1597 = t1596 * t209;
  t1600 = t318 * t461;
  t1601 = t1600 * t468;
  t1610 = t394 * t726;
  t1612 = -0.3e1 / 0.4e1 * t152 * t715 - t1516 / 0.4e1 + t1521 - t1522 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1585 - 0.3e1 / 0.8e1 * t372 * t320 + t1040 * t1593 / 0.28311552e8 - t203 * t1597 / 0.384e3 - t459 * t1601 / 0.110592e6 + t1067 * t324 / 0.2048e4 + t380 * t726 / 0.1024e4 + t1076 * t733 / 0.147456e6 + t1610 / 0.3072e4;
  t1613 = t1055 * t733;
  t1615 = t1058 * t323;
  t1618 = t1062 * t732;
  t1623 = t394 * t719;
  t1625 = t718 * t417;
  t1628 = t1071 * t324;
  t1633 = t1080 * t324 / 0.9216e4;
  t1634 = t394 * t736;
  t1636 = t451 * t692;
  t1639 = t729 * t467;
  t1640 = t462 * t1639;
  t1643 = t206 * t1543;
  t1646 = t1613 / 0.442368e6 + t203 * t1615 / 0.2048e4 + t459 * t1618 / 0.147456e6 - t380 * t719 / 0.384e3 - t1623 / 0.1152e4 + 0.3e1 / 0.256e3 * t203 * t1625 + t1628 / 0.3072e4 - t380 * t736 / 0.128e3 - t1633 - t1634 / 0.384e3 - t203 * t1636 / 0.128e3 - 0.25e2 / 0.294912e6 * t459 * t1640 + 0.9e1 / 0.256e3 * t203 * t1643;
  t1648 = my_piecewise3(t1, 0, t1612 + t1646);
  tv3rho2sigma0 = t6 * t1648 + 0.2e1 * t740;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1653 = t221 * t745;
  t1656 = t384 * t344 * t139;
  t1658 = t97 * t1656 / 0.12e2;
  t1661 = t1230 * t350;
  t1664 = t1234 * t350 / 0.9216e4;
  t1666 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t490 * t346 - t1653 / 0.4e1 + t1658 + t1226 * t350 / 0.2048e4 + t1661 / 0.3072e4 - t1664);
  tv3rho2sigma2 = t6 * t1666 + 0.2e1 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1670 = t237 * t681;
  t1681 = t1173 * t324;
  t1693 = -0.3e1 / 0.8e1 * t512 * t320 - t1670 / 0.8e1 - 0.3e1 / 0.8e1 * t237 * t715 - t520 * t719 / 0.768e3 - t1522 / 0.8e1 + t1521 - t1516 / 0.8e1 - t1623 / 0.2304e4 + t1168 * t324 / 0.2048e4 + t1681 / 0.6144e4 + t520 * t726 / 0.2048e4 + t1178 * t733 / 0.294912e6 - t520 * t736 / 0.256e3 + t1628 / 0.6144e4 - t1633 + t1610 / 0.6144e4 + t1613 / 0.884736e6 - t1634 / 0.768e3;
  t1694 = my_piecewise3(t1, 0, t1693);
  tv3rho2sigma3 = t6 * t1694 + t740 + t760;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1698 = t247 * t745;
  t1704 = t156 * t793 * t139;
  t1705 = t97 * t1704;
  t1709 = t554 * t799;
  t1713 = t1301 * t350;
  t1718 = t554 * t804;
  t1722 = t1321 * t811;
  t1726 = t554 * t814;
  t1728 = -0.3e1 / 0.8e1 * t537 * t346 - t1698 / 0.8e1 - t1653 / 0.8e1 + t1658 - 0.3e1 / 0.8e1 * t221 * t795 - t1705 / 0.8e1 - t550 * t799 / 0.768e3 - t1709 / 0.2304e4 + t1297 * t350 / 0.2048e4 + t1713 / 0.6144e4 + t1661 / 0.6144e4 - t1664 + t550 * t804 / 0.2048e4 + t1718 / 0.6144e4 + t1318 * t811 / 0.294912e6 + t1722 / 0.884736e6 - t550 * t814 / 0.256e3 - t1726 / 0.768e3;
  t1729 = my_piecewise3(t88, 0, t1728);
  tv3rho2sigma5 = t6 * t1729 + t753 + t818;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t573 * t320 - t1670 / 0.4e1 + t1521 + t1263 * t324 / 0.2048e4 + t1681 / 0.3072e4 - t1633);
  tv3rho2sigma6 = t6 * t1739 + 0.2e1 * t760;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1742 = t620 * t118;
  t1750 = t134 * t111;
  t1752 = 0.1e1 / t100 / t1750;
  t1753 = t943 * t1752;
  t1757 = t32 * t613;
  t1761 = t620 * t110;
  t1764 = t1385 * t1752;
  t1766 = t132 * t28 * t32;
  t1769 = t602 * t132;
  t1776 = t333 * t607;
  t1788 = t1412 * sigma[2];
  t1790 = t607 * t46 * t60;
  t1801 = 0.2252492123616105394e-4 * t1356 * t1742 * t110 - 0.8210333790580704161e-3 * t604 * t607 * t118 * sigma[2] + 0.50681072781362371364e-5 * t1369 * t1753 * t132 + 0.32512921810699588478e-1 * t252 * t1757 * t118 - 0.21552126200274348423e-2 * t618 * t1761 + 0.50681072781362371364e-5 * t1764 * t1766 + 0.52029099382183136787e-7 * t1769 * t1752 * t28 * t32 - 0.27182602972221579814e-4 * t775 * t620 - 0.19e2 / 0.162e3 * t261 * t1776 + 0.36604608473152679328e-1 * t1400 * t432 * t638 * t120 + 0.33893155993659888267e-3 * t1406 * t1776 + 0.1525192019714694972e-1 * t631 * t33 * t613 + 0.67786311987319776533e-3 * t1788 * t1790 + 0.14235125517337153072e-2 * t636 * t120 * t638 + 0.47450418391123843573e-3 * t271 * t338 * t643 + 0.35507115802881787709e-4 * t278 * t1757;
  t1803 = t27 * t1801 * t139;
  t1812 = t292 * t1761;
  t1815 = t798 * t621;
  t1820 = t1493 * t349;
  t1823 = t1477 * t810;
  t1827 = 0.1e1 / t664 / t619;
  t1828 = t1485 * t1827;
  t1829 = t1484 * t1828;
  t1834 = -0.3e1 / 0.8e1 * t97 * t1803 - 0.3e1 / 0.8e1 * t589 * t346 - 0.3e1 / 0.4e1 * t247 * t795 - t1698 / 0.4e1 - t1705 / 0.4e1 + t1658 + 0.9e1 / 0.256e3 * t289 * t1812 + 0.3e1 / 0.256e3 * t289 * t1815 - t596 * t814 / 0.128e3 + t289 * t1820 / 0.2048e4 + t658 * t1823 / 0.147456e6 + t1481 * t1829 / 0.28311552e8 - t596 * t799 / 0.384e3;
  t1835 = t793 * t291;
  t1836 = t1835 * t295;
  t1839 = t344 * t660;
  t1840 = t1839 * t667;
  t1854 = t654 * t772;
  t1857 = t807 * t666;
  t1858 = t661 * t1857;
  t1861 = -t289 * t1836 / 0.384e3 - t658 * t1840 / 0.110592e6 + t1498 * t350 / 0.2048e4 + t596 * t804 / 0.1024e4 + t1503 * t811 / 0.147456e6 - t1709 / 0.1152e4 + t1713 / 0.3072e4 + t1718 / 0.3072e4 + t1722 / 0.442368e6 - t1726 / 0.384e3 - t289 * t1854 / 0.128e3 - 0.25e2 / 0.294912e6 * t658 * t1858 - t1664;
  t1863 = my_piecewise3(t88, 0, t1834 + t1861);
  tv3rho2sigma8 = t6 * t1863 + 0.2e1 * t818;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1868 = t156 * t846 * t83;
  t1870 = t26 * t1868 / 0.8e1;
  t1871 = t208 * t58;
  t1875 = t48 * t176;
  t1880 = 0.1e1 / t36 / t929;
  t1881 = t943 * t1880;
  t1885 = t959 * t1880;
  t1887 = t50 * t28 * t32;
  t1890 = t208 * sigma[0];
  t1893 = t398 * t1880;
  t1896 = t162 * t208;
  t1901 = t432 * t311;
  t1920 = -0.84468454635603952274e-5 * t928 * t1871 * sigma[0] + 0.18245186201290453691e-3 * t399 * t1875 * t58 - 0.19005402293010889262e-5 * t941 * t1881 * t50 - 0.19005402293010889261e-5 * t1885 * t1887 + 0.55419753086419753086e-3 * t414 * t1890 - 0.19510912268318676295e-7 * t1893 * t1887 + 0.75858426899223013434e-5 * t1896 * sigma[0] + t172 * t1875 / 0.54e2 - 0.13726728177432254748e-1 * t974 * t1901 * t704 - 0.127099334976224581e-3 * t980 * t1875 - 0.1525192019714694972e-2 * t428 * t833 * t167 - 0.254198669952449162e-3 * t986 * t176 * t46 * t60 - 0.25419866995244916201e-3 * t433 * t704 * t311 + 0.1016794679809796648e-3 * t182 * t842 * t185;
  t1922 = t27 * t1920 * t83;
  t1925 = t846 * t205;
  t1926 = t1925 * t209;
  t1932 = t394 * t851 / 0.3072e4;
  t1933 = t1596 * t323;
  t1936 = t1600 * t732;
  t1939 = t718 * t692;
  t1945 = t1055 * t856 / 0.2359296e7;
  t1946 = t1062 * t855;
  t1949 = t463 * t76;
  t1951 = 0.1e1 / t465 / t207;
  t1952 = t1949 * t1951;
  t1953 = t1043 * t1952;
  t1956 = t463 * t731;
  t1957 = t462 * t1956;
  t1963 = t394 * t859 / 0.3072e4;
  t1964 = t451 * t824;
  t1967 = t206 * t1890;
  t1970 = -0.3e1 / 0.8e1 * t152 * t848 - t1870 - 0.3e1 / 0.8e1 * t26 * t1922 - t203 * t1926 / 0.768e3 + t380 * t851 / 0.1024e4 + t1932 + t203 * t1933 / 0.1024e4 + t459 * t1936 / 0.147456e6 - t203 * t1939 / 0.128e3 - t1076 * t856 / 0.786432e6 - t1945 - t459 * t1946 / 0.786432e6 - t1040 * t1953 / 0.75497472e8 + t459 * t1957 / 0.36864e5 + t380 * t859 / 0.1024e4 + t1963 + t203 * t1964 / 0.1024e4 - t203 * t1967 / 0.128e3;
  t1971 = my_piecewise3(t1, 0, t1970);
  tv3rhosigma20 = t6 * t1971 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1976 = t156 * t890 * t139;
  t1978 = t97 * t1976 / 0.8e1;
  t1982 = t554 * t895 / 0.3072e4;
  t1986 = t1321 * t900 / 0.2359296e7;
  t1990 = t554 * t903 / 0.3072e4;
  t1992 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t221 * t892 - t1978 + t550 * t895 / 0.1024e4 + t1982 - t1318 * t900 / 0.786432e6 - t1986 + t550 * t903 / 0.1024e4 + t1990);
  tv3rhosigma25 = t6 * t1992 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2003 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t237 * t848 - t1870 + t520 * t851 / 0.1024e4 + t1932 - t1178 * t856 / 0.786432e6 - t1945 + t520 * t859 / 0.1024e4 + t1963);
  tv3rhosigma26 = t6 * t2003 + t863;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2007 = t294 * t118;
  t2011 = t48 * t265;
  t2016 = 0.1e1 / t100 / t1357;
  t2017 = t943 * t2016;
  t2021 = t1385 * t2016;
  t2023 = t110 * t28 * t32;
  t2026 = t294 * sigma[2];
  t2029 = t602 * t2016;
  t2032 = t251 * t294;
  t2037 = t432 * t337;
  t2056 = -0.84468454635603952274e-5 * t1356 * t2007 * sigma[2] + 0.18245186201290453691e-3 * t603 * t2011 * t118 - 0.19005402293010889262e-5 * t1369 * t2017 * t110 - 0.19005402293010889261e-5 * t2021 * t2023 + 0.55419753086419753086e-3 * t618 * t2026 - 0.19510912268318676295e-7 * t2029 * t2023 + 0.75858426899223013434e-5 * t2032 * sigma[2] + t261 * t2011 / 0.54e2 - 0.13726728177432254748e-1 * t1400 * t2037 * t784 - 0.127099334976224581e-3 * t1406 * t2011 - 0.1525192019714694972e-2 * t632 * t877 * t256 - 0.254198669952449162e-3 * t1412 * t265 * t46 * t60 - 0.25419866995244916201e-3 * t636 * t784 * t337 + 0.1016794679809796648e-3 * t271 * t886 * t274;
  t2058 = t27 * t2056 * t139;
  t2061 = t890 * t291;
  t2062 = t2061 * t295;
  t2067 = t1835 * t349;
  t2070 = t1839 * t810;
  t2073 = t798 * t772;
  t2078 = t1477 * t899;
  t2081 = t662 * t132;
  t2083 = 0.1e1 / t664 / t293;
  t2084 = t2081 * t2083;
  t2085 = t1484 * t2084;
  t2088 = t662 * t809;
  t2089 = t661 * t2088;
  t2094 = t654 * t868;
  t2097 = t292 * t2026;
  t2100 = -0.3e1 / 0.8e1 * t247 * t892 - t1978 - 0.3e1 / 0.8e1 * t97 * t2058 - t289 * t2062 / 0.768e3 + t596 * t895 / 0.1024e4 + t1982 + t289 * t2067 / 0.1024e4 + t658 * t2070 / 0.147456e6 - t289 * t2073 / 0.128e3 - t1503 * t900 / 0.786432e6 - t1986 - t658 * t2078 / 0.786432e6 - t1481 * t2085 / 0.75497472e8 + t658 * t2089 / 0.36864e5 + t596 * t903 / 0.1024e4 + t1990 + t289 * t2094 / 0.1024e4 - t289 * t2097 / 0.128e3;
  t2101 = my_piecewise3(t88, 0, t2100);
  tv3rhosigma211 = t6 * t2101 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2107 = 0.1e1 / t36 / t415;
  t2108 = t943 * t2107;
  t2114 = sigma[0] * t28 * t32;
  t2119 = t398 * t2107;
  t2130 = 0.1e1 / t50;
  t2131 = t32 * t2130;
  t2135 = t986 * t54;
  t2137 = t832 * t46 * t60;
  t2143 = t62 * t50;
  t2144 = 0.1e1 / t2143;
  t2145 = t60 * t2144;
  t2149 = 0.31675670488351482103e-5 * t928 * t79 * t58 + 0.71270258598790834731e-6 * t941 * t2108 * sigma[0] + 0.71270258598790834731e-6 * t959 * t2107 * t2114 - 0.69274691358024691358e-4 * t414 * t79 + 0.73165921006195036105e-8 * t2119 * t2114 - 0.14223455043604315019e-5 * t827 + 0.51475230665370955305e-2 * t974 * t432 * t841 * t837 + 0.47662250616084217875e-4 * t980 * t820 * t832 - 0.17158410221790318435e-2 * t428 * t2131 * t38 + 0.95324501232168435752e-4 * t2135 * t2137 - 0.57194700739301061451e-4 * t433 * t837 * t841 + 0.1143894014786021229e-3 * t182 * t2145 * t64;
  t2151 = t27 * t2149 * t83;
  t2154 = t1925 * t323;
  t2157 = t1600 * t855;
  t2160 = t718 * t824;
  t2164 = 0.1e1 / t465 / t78;
  t2165 = t464 * t2164;
  t2166 = t1043 * t2165;
  t2169 = t76 * t854;
  t2170 = t462 * t2169;
  t2173 = t201 * t25;
  t2174 = t205 * t79;
  t2175 = t73 * t2174;
  t2179 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t2151 + 0.3e1 / 0.2048e4 * t203 * t2154 - t459 * t2157 / 0.262144e6 + 0.3e1 / 0.1024e4 * t203 * t2160 + t1040 * t2166 / 0.201326592e9 - t459 * t2170 / 0.131072e6 + t2173 * t2175 / 0.1024e4);
  tv3sigma30 = t6 * t2179;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2184 = 0.1e1 / t100 / t619;
  t2185 = t943 * t2184;
  t2191 = sigma[2] * t28 * t32;
  t2196 = t602 * t2184;
  t2207 = 0.1e1 / t110;
  t2208 = t32 * t2207;
  t2212 = t1412 * t114;
  t2214 = t876 * t46 * t60;
  t2220 = t120 * t110;
  t2221 = 0.1e1 / t2220;
  t2222 = t60 * t2221;
  t2226 = 0.31675670488351482103e-5 * t1356 * t135 * t118 + 0.71270258598790834731e-6 * t1369 * t2185 * sigma[2] + 0.71270258598790834731e-6 * t1385 * t2184 * t2191 - 0.69274691358024691358e-4 * t618 * t135 + 0.73165921006195036105e-8 * t2196 * t2191 - 0.14223455043604315019e-5 * t871 + 0.51475230665370955305e-2 * t1400 * t432 * t885 * t881 + 0.47662250616084217875e-4 * t1406 * t864 * t876 - 0.17158410221790318435e-2 * t632 * t2208 * t102 + 0.95324501232168435752e-4 * t2212 * t2214 - 0.57194700739301061451e-4 * t636 * t881 * t885 + 0.1143894014786021229e-3 * t271 * t2222 * t122;
  t2228 = t27 * t2226 * t139;
  t2231 = t2061 * t349;
  t2234 = t1839 * t899;
  t2237 = t798 * t868;
  t2241 = 0.1e1 / t664 / t134;
  t2242 = t663 * t2241;
  t2243 = t1484 * t2242;
  t2246 = t132 * t898;
  t2247 = t661 * t2246;
  t2250 = t201 * t96;
  t2251 = t291 * t135;
  t2252 = t131 * t2251;
  t2256 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t2228 + 0.3e1 / 0.2048e4 * t289 * t2231 - t658 * t2234 / 0.262144e6 + 0.3e1 / 0.1024e4 * t289 * t2237 + t1481 * t2243 / 0.201326592e9 - t658 * t2247 / 0.131072e6 + t2250 * t2252 / 0.1024e4);
  tv3sigma39 = t6 * t2256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2263 = 0.1e1 / t36 / t174;
  t2268 = 0.1e1/sqrt(t66);
  t2270 = t2268 * t69 * t432;
  t2272 = 0.1e1 / t35 / t207;
  t2273 = t50 * t2272;
  t2277 = t190 * t2263;
  t2286 = 0.1e1 / t926 / t42 * t75;
  t2288 = t78 * t174;
  t2290 = 0.1e1 / t36 / t2288;
  t2304 = t927 * t46;
  t2307 = 0.1e1 / t30 / t74 / t29;
  t2310 = 0.1e1 / t35 / t730;
  t2316 = t2310 * t46 * t48;
  t2319 = 0.13707898646324665922e-1 * t182 * t183 * t54 + 0.85978615454961133971e0 * t164 * sigma[0] * t2263 * t58 + 0.65074859507826985473e-1 * t2270 * t2273 * t61 + 0.38593006958114059441e0 * t428 * t2277 + 0.31332339763027807821e-1 * t987 * t2272 * t46 * t60 - 0.32958275242668208782e-5 * t2286 * t463 * t2290 * t58 * t33 - 0.26462277468242006168e-1 * t400 * t2273 * t58 + 0.40912805190569002904e-1 * t433 * t434 * t79 + 0.33336883429518359831e-3 * t941 * t944 * t2290 - 0.55617089472002602321e-6 * t2304 * t2307 * t729 * t2310 - 0.57096405357676967667e-8 * t927 * t729 * t2316;
  t2320 = t973 * t28;
  t2322 = 0.1e1 / t31 / t29;
  t2330 = t2290 * t28 * t32;
  t2333 = t173 * t2272;
  t2339 = t2320 * t32;
  t2346 = 0.1e1 / t1532;
  t2347 = t76 * t2346;
  t2360 = 0.10845809917971164246e-1 * t2320 * t2322 * t2143 * t2107 + 0.93896595123176283055e-3 * t189 * t2277 + 0.41623279505746509429e-5 * t965 * t2330 - 0.5225e4 / 0.1458e4 * t172 * t2333 + 0.1366572049664366695e1 * t974 * t975 * t79 + 0.32537429753913492736e-1 * t2339 * t2143 * t2107 * t432 + 0.13858534895185376536e-1 * t980 * t2333 + 0.13214620458547818311e-2 * t928 * t2347 * t58 - 0.11123417894400520464e-5 * t928 * t729 * t2316 + 0.36940870827304128461e-3 * t960 * t2330 - 0.82486486816034141137e-1 * t414 * t2347 - 0.11434955462216209803e-2 * t420 * t2346;
  t2366 = t152 * t1012;
  t2368 = t152 * t923;
  t2372 = t26 * t921 * t194 * t83;
  t2376 = t19 * t19;
  t2378 = 0.1e1 / t357 / t2376;
  t2379 = t359 * t359;
  t2385 = t367 * t367;
  t2391 = 0.1e1 / t1023 / t6;
  t2392 = t16 * t2391;
  t2395 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1024 + 0.24e2 * t2392);
  t2399 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2378 * t2379 - 0.16e2 / 0.9e1 * t1016 * t359 * t367 + 0.4e1 / 0.3e1 * t358 * t2385 + 0.16e2 / 0.9e1 * t1020 * t1028 + 0.4e1 / 0.3e1 * t23 * t2395);
  t2407 = t152 * t1008;
  t2410 = t26 * t384 * t446 * t83;
  t2412 = t372 * t386;
  t2414 = t1033 * t158;
  t2416 = -0.3e1 / 0.8e1 * t26 * t27 * (t2319 + t2360) * t83 - 0.3e1 / 0.2e1 * t2366 - 0.5e1 / 0.9e1 * t2368 - 0.5e1 / 0.9e1 * t2372 - 0.3e1 / 0.2e1 * t152 * t1004 - 0.3e1 / 0.8e1 * t5 * t2399 * t84 - 0.3e1 / 0.2e1 * t1033 * t196 - 0.9e1 / 0.4e1 * t372 * t448 + t2407 + t2410 / 0.2e1 + t2412 / 0.2e1 - t2414 / 0.2e1;
  t2417 = t372 * t390;
  t2420 = 0.1e1 / t155 / t362;
  t2424 = 0.1e2 / 0.27e2 * t26 * t2420 * t72 * t83;
  t2427 = t26 * t156 * t1002 * t83;
  t2430 = t201 * t151 * t384;
  t2431 = t2430 * t210;
  t2433 = t1071 * t472;
  t2435 = t1039 * t393;
  t2436 = t2435 * t1049;
  t2444 = t394 * t1087;
  t2446 = t458 * t1079;
  t2447 = t2446 * t469;
  t2449 = t1055 * t1093;
  t2451 = t458 * t1066;
  t2454 = t1055 * t1063;
  t2456 = t458 * t1070;
  t2457 = t2456 * t469;
  t2459 = -0.3e1 / 0.2e1 * t2417 + t2424 - t2427 / 0.2e1 + t2431 / 0.288e3 + 0.3e1 / 0.64e2 * t2433 - t2436 / 0.7962624e7 + t1040 * t1043 * t1045 / t465 / t1532 / 0.196608e6 + 0.3e1 / 0.64e2 * t2444 + t2447 / 0.82944e5 + t2449 / 0.3072e4 - t2451 * t469 / 0.18432e5 - t2454 / 0.27648e5 - t2457 / 0.27648e5;
  t2461 = t446 * t461;
  t2469 = t1071 * t452;
  t2473 = t1039 * t379;
  t2476 = t194 * t1042;
  t2480 = t455 * t455;
  t2483 = t2 / t3 / t2480;
  t2484 = t2483 * t202;
  t2487 = t72 / t1041 / t82;
  t2489 = t465 * t465;
  t2496 = t1002 * t205;
  t2500 = t1080 * t452;
  t2502 = t394 * t1059;
  t2505 = t201 * t1032 * t27;
  t2508 = -t459 * t2461 * t468 / 0.18432e5 - t1076 * t1063 / 0.9216e4 - t1067 * t452 / 0.64e2 - t2469 / 0.96e2 - t380 * t1059 / 0.64e2 - t2473 * t1049 / 0.2654208e7 - t1040 * t2476 * t1048 / 0.2654208e7 - t2484 * t2487 * t1044 * t463 / t2489 / t51 / 0.764411904e9 - t203 * t2496 * t209 / 0.192e3 + t2500 / 0.288e3 - t2502 / 0.192e3 - t2505 * t210 / 0.192e3;
  t2510 = t201 * t25 * t921;
  t2511 = t2510 * t210;
  t2513 = t394 * t1096;
  t2531 = t1080 * t472;
  t2542 = t201 * t371 * t156;
  t2543 = t2542 * t210;
  t2547 = -0.5e1 / 0.2592e4 * t2511 - 0.5e1 / 0.32e2 * t2513 - 0.15e2 / 0.32e2 * t203 * t451 * t931 - 0.67e2 / 0.12288e5 * t459 * t462 * t464 / t465 / t51 + 0.165e3 / 0.128e3 * t203 * t206 * t2347 + 0.9e1 / 0.64e2 * t380 * t1087 + t1076 * t1093 / 0.1024e4 - t2531 / 0.64e2 - 0.15e2 / 0.32e2 * t380 * t1096 + 0.9e1 / 0.128e3 * t203 * t1058 * t417 + t459 * t1062 * t1092 / 0.1024e4 - t2543 / 0.192e3 + 0.9e1 / 0.128e3 * t1067 * t472;
  t2550 = my_piecewise3(t1, 0, t2416 + t2459 + t2508 + t2547);
  t2551 = t92 * t92;
  t2553 = 0.1e1 / t477 / t2551;
  t2554 = t479 * t479;
  t2560 = t485 * t485;
  t2565 = t89 * t2391;
  t2568 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1024 + 0.24e2 * t2565);
  t2572 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t2553 * t2554 - 0.16e2 / 0.9e1 * t1103 * t479 * t485 + 0.4e1 / 0.3e1 * t478 * t2560 + 0.16e2 / 0.9e1 * t1107 * t1113 + 0.4e1 / 0.3e1 * t94 * t2568);
  t2576 = t1118 * t225;
  t2578 = t490 * t496;
  t2580 = t221 * t1126;
  t2585 = 0.1e2 / 0.27e2 * t97 * t2420 * t130 * t139;
  t2587 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t5 * t2572 * t140 - t2576 / 0.2e1 + t2578 / 0.2e1 - 0.5e1 / 0.9e1 * t2580 + t2585);
  tv4rho40 = 0.4e1 * t1101 + 0.4e1 * t1130 + t6 * (t2550 + t2587);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2592 = t237 * t1012;
  t2594 = t237 * t923;
  t2598 = t512 * t386;
  t2599 = t2598 / 0.4e1;
  t2600 = t237 * t1008;
  t2601 = t2600 / 0.4e1;
  t2602 = t1157 * t158;
  t2604 = t512 * t390;
  t2626 = 0.12e2 * t1024;
  t2627 = 0.24e2 * t2392;
  t2629 = my_piecewise5(t10, 0, t14, 0, -t2626 + t2627);
  t2633 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2378 * t233 * t1017 - 0.8e1 / 0.9e1 * t1016 * t507 * t359 - 0.8e1 / 0.9e1 * t1141 * t148 * t367 + 0.4e1 / 0.3e1 * t358 * t1152 * t148 + 0.4e1 / 0.3e1 * t1144 * t367 + 0.4e1 / 0.9e1 * t503 * t1028 + 0.4e1 / 0.3e1 * t23 * t2629);
  t2639 = -0.3e1 / 0.8e1 * t2592 - 0.5e1 / 0.36e2 * t2594 - 0.9e1 / 0.8e1 * t1157 * t196 + t2599 + t2601 - 0.3e1 / 0.8e1 * t2602 - 0.3e1 / 0.4e1 * t2604 - 0.9e1 / 0.8e1 * t512 * t448 - 0.3e1 / 0.8e1 * t237 * t1004 - 0.3e1 / 0.8e1 * t5 * t2633 * t84 - 0.3e1 / 0.8e1 * t2366 - 0.5e1 / 0.12e2 * t2368;
  t2649 = t1039 * t519;
  t2652 = t1173 * t452;
  t2657 = t201 * t1156 * t27;
  t2660 = -0.5e1 / 0.12e2 * t2372 + t2407 / 0.2e1 + t2410 / 0.4e1 + t2412 / 0.4e1 - t2414 / 0.8e1 - 0.3e1 / 0.8e1 * t2417 + t2424 - t2427 / 0.8e1 - t1178 * t1063 / 0.36864e5 - t2649 * t1049 / 0.10616832e8 - t2652 / 0.384e3 - t520 * t1059 / 0.256e3 - t2657 * t210 / 0.256e3;
  t2665 = t201 * t236 * t384;
  t2666 = t2665 * t210;
  t2667 = t2666 / 0.1152e4;
  t2669 = t201 * t511 * t156;
  t2670 = t2669 * t210;
  t2676 = t1173 * t472;
  t2686 = -t1168 * t452 / 0.128e3 + t2667 - t2670 / 0.384e3 - 0.15e2 / 0.128e3 * t520 * t1096 + 0.9e1 / 0.256e3 * t1168 * t472 + 0.3e1 / 0.256e3 * t2676 + 0.9e1 / 0.256e3 * t520 * t1087 + t1178 * t1093 / 0.4096e4 + t2431 / 0.576e3 + 0.3e1 / 0.256e3 * t2433 - t2436 / 0.31850496e8 + 0.3e1 / 0.256e3 * t2444;
  t2695 = t458 * t1167;
  t2698 = t458 * t1172;
  t2699 = t2698 * t469;
  t2704 = t2447 / 0.165888e6 + t2449 / 0.12288e5 - t2454 / 0.110592e6 - t2457 / 0.110592e6 - t2469 / 0.384e3 + t2500 / 0.576e3 - t2502 / 0.768e3 - 0.5e1 / 0.3456e4 * t2511 - t2695 * t469 / 0.36864e5 - t2699 / 0.110592e6 - 0.5e1 / 0.128e3 * t2513 - t2531 / 0.128e3 - t2543 / 0.768e3;
  t2707 = my_piecewise3(t1, 0, t2639 + t2660 + t2686 + t2704);
  t2724 = 0.24e2 * t2565;
  t2726 = my_piecewise5(t14, 0, t10, 0, t2626 + t2724);
  t2730 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t2553 * t243 * t1104 - 0.8e1 / 0.9e1 * t1103 * t532 * t479 - 0.8e1 / 0.9e1 * t1193 * t217 * t485 + 0.4e1 / 0.3e1 * t478 * t1203 * t217 + 0.4e1 / 0.3e1 * t1196 * t485 + 0.4e1 / 0.9e1 * t528 * t1113 + 0.4e1 / 0.3e1 * t94 * t2726);
  t2734 = t1208 * t225;
  t2736 = t537 * t496;
  t2737 = t2736 / 0.4e1;
  t2738 = t247 * t1126;
  t2745 = t490 * t546;
  t2747 = t221 * t1222;
  t2748 = t2747 / 0.4e1;
  t2751 = t97 * t921 * t283 * t139;
  t2754 = t201 * t1117 * t27;
  t2758 = t201 * t489 * t156;
  t2759 = t2758 * t296;
  t2762 = t201 * t220 * t384;
  t2763 = t2762 * t296;
  t2764 = t2763 / 0.1152e4;
  t2766 = t201 * t96 * t921;
  t2767 = t2766 * t296;
  t2769 = -0.3e1 / 0.8e1 * t5 * t2730 * t140 - 0.3e1 / 0.8e1 * t2734 + t2737 - 0.5e1 / 0.36e2 * t2738 - t2576 / 0.8e1 + t2578 / 0.4e1 - 0.5e1 / 0.12e2 * t2580 + t2585 - 0.3e1 / 0.8e1 * t1118 * t285 - 0.3e1 / 0.8e1 * t2745 + t2748 - 0.5e1 / 0.36e2 * t2751 - t2754 * t296 / 0.768e3 - t2759 / 0.768e3 + t2764 - 0.5e1 / 0.10368e5 * t2767;
  t2770 = my_piecewise3(t88, 0, t2769);
  tv4rho41 = t1101 + t1130 + 0.3e1 * t1192 + 0.3e1 * t1238 + t6 * (t2707 + t2770);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2779 = t1255 * t158;
  t2781 = t573 * t386;
  t2791 = t507 * t507;
  t2804 = my_piecewise5(t10, 0, t14, 0, t2627);
  t2808 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2378 * t563 * t359 - 0.32e2 / 0.27e2 * t1141 * t148 * t507 - 0.8e1 / 0.27e2 * t1241 * t367 + 0.8e1 / 0.9e1 * t358 * t2791 + 0.8e1 / 0.9e1 * t503 * t1152 - 0.8e1 / 0.27e2 * t1016 * t568 * t359 + 0.8e1 / 0.9e1 * t358 * t1250 * t148 + 0.4e1 / 0.9e1 * t1246 * t367 + 0.4e1 / 0.3e1 * t23 * t2804);
  t2814 = t573 * t390;
  t2826 = -0.3e1 / 0.8e1 * t573 * t448 - t2779 / 0.4e1 + t2781 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t2808 * t84 - 0.3e1 / 0.4e1 * t1255 * t196 - t2814 / 0.4e1 - t2592 / 0.4e1 - 0.5e1 / 0.18e2 * t2594 + t2598 / 0.3e1 + t2600 / 0.3e1 - t2602 / 0.4e1 - t2604 / 0.2e1 - 0.5e1 / 0.18e2 * t2368 - 0.5e1 / 0.18e2 * t2372 + t2407 / 0.6e1 + t2410 / 0.12e2;
  t2830 = t458 * t1262;
  t2834 = t201 * t1254 * t27;
  t2838 = t201 * t572 * t156;
  t2839 = t2838 * t210;
  t2853 = t2412 / 0.12e2 + t2424 - t1263 * t452 / 0.384e3 - t2830 * t469 / 0.110592e6 - t2834 * t210 / 0.384e3 - t2839 / 0.1152e4 + 0.3e1 / 0.256e3 * t1263 * t472 - t2652 / 0.576e3 + t2666 / 0.864e3 - t2670 / 0.576e3 + t2676 / 0.128e3 + t2431 / 0.1728e4 + t2447 / 0.497664e6 + t2500 / 0.1728e4 - 0.5e1 / 0.5184e4 * t2511 - t2699 / 0.165888e6 - t2531 / 0.384e3;
  t2855 = my_piecewise3(t1, 0, t2826 + t2853);
  t2866 = t532 * t532;
  t2879 = my_piecewise5(t14, 0, t10, 0, t2724);
  t2883 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t2553 * t579 * t479 - 0.32e2 / 0.27e2 * t1193 * t217 * t532 - 0.8e1 / 0.27e2 * t1272 * t485 + 0.8e1 / 0.9e1 * t478 * t2866 + 0.8e1 / 0.9e1 * t528 * t1203 - 0.8e1 / 0.27e2 * t1103 * t584 * t479 + 0.8e1 / 0.9e1 * t478 * t1281 * t217 + 0.4e1 / 0.9e1 * t1277 * t485 + 0.4e1 / 0.3e1 * t94 * t2879);
  t2887 = t221 * t1311;
  t2891 = t97 * t384 * t649 * t139;
  t2893 = t1286 * t225;
  t2895 = t589 * t496;
  t2897 = t537 * t546;
  t2899 = t247 * t1222;
  t2910 = -0.3e1 / 0.8e1 * t490 * t651 - 0.3e1 / 0.8e1 * t5 * t2883 * t140 - t2887 / 0.4e1 + t2891 / 0.12e2 - t2893 / 0.4e1 + t2895 / 0.12e2 - t2897 / 0.2e1 + t2899 / 0.6e1 - 0.3e1 / 0.4e1 * t1208 * t285 - t2745 / 0.4e1 + t2747 / 0.3e1 - 0.5e1 / 0.18e2 * t2751 - t2734 / 0.4e1 + t2736 / 0.3e1 - 0.5e1 / 0.18e2 * t2738 + t2578 / 0.12e2;
  t2914 = t458 * t1229;
  t2915 = t2914 * t668;
  t2917 = t458 * t1233;
  t2918 = t2917 * t668;
  t2920 = t1230 * t671;
  t2922 = t1234 * t671;
  t2924 = t1230 * t655;
  t2926 = t1234 * t655;
  t2930 = t458 * t1225;
  t2936 = t201 * t1207 * t27;
  t2940 = t201 * t536 * t156;
  t2941 = t2940 * t296;
  t2944 = t201 * t246 * t384;
  t2945 = t2944 * t296;
  t2948 = -0.5e1 / 0.18e2 * t2580 + t2585 + t2763 / 0.864e3 - 0.5e1 / 0.5184e4 * t2767 - t2915 / 0.165888e6 + t2918 / 0.497664e6 + t2920 / 0.128e3 - t2922 / 0.384e3 - t2924 / 0.576e3 + t2926 / 0.1728e4 - t1226 * t655 / 0.384e3 - t2930 * t668 / 0.110592e6 + 0.3e1 / 0.256e3 * t1226 * t671 - t2936 * t296 / 0.384e3 - t2941 / 0.576e3 + t2945 / 0.1728e4 - t2759 / 0.1152e4;
  t2950 = my_piecewise3(t88, 0, t2910 + t2948);
  tv4rho42 = 0.2e1 * t1192 + 0.2e1 * t1238 + 0.2e1 * t1271 + 0.2e1 * t1330 + t6 * (t2855 + t2950);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2971 = my_piecewise5(t10, 0, t14, 0, t2626 + t2627);
  t2975 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2378 * t1335 * t148 - 0.8e1 / 0.9e1 * t1241 * t507 - 0.8e1 / 0.9e1 * t1141 * t568 * t148 + 0.4e1 / 0.3e1 * t1144 * t568 + 0.4e1 / 0.3e1 * t503 * t1250 + 0.4e1 / 0.9e1 * t358 * t1342 * t148 + 0.4e1 / 0.3e1 * t23 * t2971);
  t2979 = t1347 * t158;
  t2984 = t201 * t1346 * t27;
  t2995 = -0.3e1 / 0.8e1 * t5 * t2975 * t84 - t2979 / 0.8e1 - 0.3e1 / 0.8e1 * t1347 * t196 - t2984 * t210 / 0.768e3 - 0.3e1 / 0.8e1 * t2779 + t2781 / 0.4e1 - 0.3e1 / 0.8e1 * t2814 - t2839 / 0.768e3 + t2599 - 0.5e1 / 0.12e2 * t2594 + t2601 + t2667 - 0.5e1 / 0.36e2 * t2368 + t2424 - 0.5e1 / 0.36e2 * t2372 - 0.5e1 / 0.10368e5 * t2511;
  t2996 = my_piecewise3(t1, 0, t2995);
  t2999 = t97 * t156 * t1428 * t139;
  t3001 = t1445 * t225;
  t3003 = t589 * t546;
  t3005 = t247 * t1311;
  t3025 = my_piecewise5(t14, 0, t10, 0, -t2626 + t2724);
  t3029 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t2553 * t1433 * t217 - 0.8e1 / 0.9e1 * t1272 * t532 - 0.8e1 / 0.9e1 * t1193 * t584 * t217 + 0.4e1 / 0.3e1 * t1196 * t584 + 0.4e1 / 0.3e1 * t528 * t1281 + 0.4e1 / 0.9e1 * t478 * t1440 * t217 + 0.4e1 / 0.3e1 * t94 * t3025);
  t3041 = -t2999 / 0.8e1 - t3001 / 0.8e1 - 0.3e1 / 0.8e1 * t3003 - 0.3e1 / 0.8e1 * t3005 - 0.3e1 / 0.8e1 * t221 * t1430 - 0.3e1 / 0.8e1 * t5 * t3029 * t140 - 0.9e1 / 0.8e1 * t1286 * t285 - 0.9e1 / 0.8e1 * t537 * t651 - 0.3e1 / 0.8e1 * t2887 + t2891 / 0.4e1 - 0.3e1 / 0.8e1 * t2893 + t2895 / 0.4e1;
  t3047 = t554 * t1469;
  t3049 = t1301 * t671;
  t3051 = t554 * t1459;
  t3053 = t1321 * t1466;
  t3055 = t458 * t1300;
  t3056 = t3055 * t668;
  t3058 = -0.3e1 / 0.4e1 * t2897 + t2899 / 0.2e1 + t2748 - 0.5e1 / 0.12e2 * t2751 + t2737 - 0.5e1 / 0.12e2 * t2738 - 0.5e1 / 0.36e2 * t2580 + t2585 - 0.5e1 / 0.128e3 * t3047 + 0.3e1 / 0.256e3 * t3049 + 0.3e1 / 0.256e3 * t3051 + t3053 / 0.12288e5 - t3056 / 0.110592e6;
  t3060 = t1039 * t553;
  t3061 = t3060 * t1490;
  t3063 = t554 * t1494;
  t3066 = t201 * t588 * t156;
  t3067 = t3066 * t296;
  t3069 = t1301 * t655;
  t3071 = t1321 * t1478;
  t3082 = t201 * t1285 * t27;
  t3087 = t458 * t1296;
  t3090 = -t3061 / 0.31850496e8 - t3063 / 0.768e3 - t3067 / 0.768e3 - t3069 / 0.384e3 - t3071 / 0.110592e6 + 0.9e1 / 0.256e3 * t1297 * t671 + 0.9e1 / 0.256e3 * t550 * t1459 + t1318 * t1466 / 0.4096e4 - 0.15e2 / 0.128e3 * t550 * t1469 - t3082 * t296 / 0.256e3 - t1297 * t655 / 0.128e3 - t3087 * t668 / 0.36864e5;
  t3093 = t1039 * t549;
  t3107 = -t1318 * t1478 / 0.36864e5 - t3093 * t1490 / 0.10616832e8 - t550 * t1494 / 0.256e3 + t2764 - 0.5e1 / 0.3456e4 * t2767 - t2915 / 0.110592e6 + t2918 / 0.165888e6 + 0.3e1 / 0.256e3 * t2920 - t2922 / 0.128e3 - t2924 / 0.384e3 + t2926 / 0.576e3 - t2941 / 0.384e3 + t2945 / 0.576e3;
  t3110 = my_piecewise3(t88, 0, t3041 + t3058 + t3090 + t3107);
  tv4rho43 = 0.3e1 * t1271 + 0.3e1 * t1330 + t1353 + t1508 + t6 * (t2996 + t3110);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3115 = t563 * t563;
  t3120 = t568 * t568;
  t3127 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1024 + 0.24e2 * t2392);
  t3131 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2378 * t3115 - 0.16e2 / 0.9e1 * t1241 * t568 + 0.4e1 / 0.3e1 * t358 * t3120 + 0.16e2 / 0.9e1 * t503 * t1342 + 0.4e1 / 0.3e1 * t23 * t3127);
  t3139 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3131 * t84 - t2979 / 0.2e1 + t2781 / 0.2e1 - 0.5e1 / 0.9e1 * t2594 + t2424);
  t3144 = 0.1e1 / t100 / t263;
  t3145 = t279 * t3144;
  t3148 = t134 * t263;
  t3150 = 0.1e1 / t100 / t3148;
  t3152 = t3150 * t28 * t32;
  t3158 = 0.1e1 / t99 / t293;
  t3159 = t262 * t3158;
  t3165 = t1399 * t28;
  t3166 = t3165 * t32;
  t3182 = 0.40912805190569002904e-1 * t636 * t637 * t135 + 0.93896595123176283055e-3 * t278 * t3145 + 0.36940870827304128461e-3 * t1386 * t3152 + 0.41623279505746509429e-5 * t1391 * t3152 - 0.5225e4 / 0.1458e4 * t261 * t3159 + 0.1366572049664366695e1 * t1400 * t1401 * t135 + 0.32537429753913492736e-1 * t3166 * t2220 * t2184 * t432 + 0.13858534895185376536e-1 * t1406 * t3159 + 0.38593006958114059441e0 * t632 * t3145 + 0.31332339763027807821e-1 * t1413 * t3158 * t46 * t60 + 0.13707898646324665922e-1 * t271 * t272 * t114;
  t3185 = 0.1e1 / t1354 / t106 * t75;
  t3191 = t110 * t3158;
  t3199 = 0.1e1/sqrt(t124);
  t3201 = t3199 * t127 * t432;
  t3205 = 0.1e1 / t1750;
  t3206 = t132 * t3205;
  t3216 = 0.1e1 / t99 / t808;
  t3218 = t3216 * t46 * t48;
  t3224 = t1355 * t46;
  t3236 = -0.32958275242668208782e-5 * t3185 * t662 * t3150 * t118 * t33 - 0.26462277468242006168e-1 * t604 * t3191 * t118 + 0.85978615454961133971e0 * t253 * sigma[2] * t3144 * t118 + 0.65074859507826985473e-1 * t3201 * t3191 * t61 - 0.82486486816034141137e-1 * t618 * t3206 - 0.11434955462216209803e-2 * t624 * t3205 + 0.13214620458547818311e-2 * t1356 * t3206 * t118 - 0.11123417894400520464e-5 * t1356 * t807 * t3218 + 0.33336883429518359831e-3 * t1369 * t1370 * t3150 - 0.55617089472002602321e-6 * t3224 * t2307 * t807 * t3216 - 0.57096405357676967667e-8 * t1355 * t807 * t3218 + 0.10845809917971164246e-1 * t3165 * t2322 * t2220 * t2184;
  t3244 = t579 * t579;
  t3249 = t584 * t584;
  t3256 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1024 + 0.24e2 * t2565);
  t3260 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t2553 * t3244 - 0.16e2 / 0.9e1 * t1272 * t584 + 0.4e1 / 0.3e1 * t478 * t3249 + 0.16e2 / 0.9e1 * t528 * t1440 + 0.4e1 / 0.3e1 * t94 * t3256);
  t3274 = -0.3e1 / 0.8e1 * t97 * t27 * (t3182 + t3236) * t139 - 0.3e1 / 0.2e1 * t247 * t1430 - 0.3e1 / 0.8e1 * t5 * t3260 * t140 - 0.3e1 / 0.2e1 * t1445 * t285 - 0.9e1 / 0.4e1 * t589 * t651 - t2999 / 0.2e1 - t3001 / 0.2e1 - 0.3e1 / 0.2e1 * t3003 - 0.3e1 / 0.2e1 * t3005 + t2891 / 0.2e1 + t2895 / 0.2e1 + t2899;
  t3287 = -0.5e1 / 0.9e1 * t2751 - 0.5e1 / 0.9e1 * t2738 + t2585 - 0.5e1 / 0.32e2 * t3047 + 0.3e1 / 0.64e2 * t3049 + 0.3e1 / 0.64e2 * t3051 + t3053 / 0.3072e4 - t3056 / 0.27648e5 - t3061 / 0.7962624e7 - t3063 / 0.192e3 - t3067 / 0.192e3 - t3069 / 0.96e2 - t3071 / 0.27648e5;
  t3289 = t458 * t1497;
  t3293 = t201 * t1444 * t27;
  t3298 = t283 * t1483;
  t3302 = t1039 * t595;
  t3305 = t2483 * t288;
  t3308 = t130 / t1482 / t138;
  t3310 = t664 * t664;
  t3319 = t1428 * t291;
  t3325 = t649 * t660;
  t3338 = -t3289 * t668 / 0.18432e5 - t3293 * t296 / 0.192e3 - t1498 * t655 / 0.64e2 - t1481 * t3298 * t1489 / 0.2654208e7 - t3302 * t1490 / 0.2654208e7 - t3305 * t3308 * t1485 * t662 / t3310 / t111 / 0.764411904e9 - t596 * t1494 / 0.64e2 - t289 * t3319 * t295 / 0.192e3 - t1503 * t1478 / 0.9216e4 - t658 * t3325 * t667 / 0.18432e5 - 0.67e2 / 0.12288e5 * t658 * t661 * t663 / t664 / t111 + 0.165e3 / 0.128e3 * t289 * t292 * t3206;
  t3367 = -0.15e2 / 0.32e2 * t596 * t1469 - 0.15e2 / 0.32e2 * t289 * t654 * t1359 + 0.9e1 / 0.64e2 * t596 * t1459 + t1503 * t1466 / 0.1024e4 + 0.9e1 / 0.128e3 * t289 * t1493 * t621 + 0.9e1 / 0.128e3 * t1498 * t671 + t658 * t1477 * t1465 / 0.1024e4 + t1481 * t1484 * t1486 / t664 / t1750 / 0.196608e6 - 0.5e1 / 0.2592e4 * t2767 + t2918 / 0.82944e5 - t2922 / 0.64e2 + t2926 / 0.288e3 + t2945 / 0.288e3;
  t3370 = my_piecewise3(t88, 0, t3274 + t3287 + t3338 + t3367);
  tv4rho44 = 0.4e1 * t1353 + 0.4e1 * t1508 + t6 * (t3139 + t3370);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3374 = t152 * t1519;
  t3378 = t26 * t384 * t713 * t83;
  t3380 = t372 * t681;
  t3382 = t152 * t1515;
  t3406 = t32 * t952;
  t3411 = 0.1e1 / t35 / t465;
  t3418 = 0.1e1 / t36 / t207;
  t3433 = -0.24403072315435119552e-1 * t2270 * t936 * sigma[0] * t61 - 0.97160380515158346364e-2 * t1570 * t989 - 0.15816806130374614524e-2 * t182 * t312 * t996 + 0.12359353216000578294e-5 * t2286 * t947 * t58 * t76 * t33 + 0.69128983273778274541e-2 * t400 * t936 * t58 * sigma[0] - 0.16569987374678167598e-3 * t189 * t3406 + 0.21411152009128862875e-8 * t927 * t463 * t3411 * t46 * t48 - 0.4067178719239186592e-2 * t2320 * t2322 * t434 * t3418 - 0.98516106754904741896e-2 * t433 * t62 * t976 - 0.10980899102628513796e-3 * t941 * t943 * t947 * t76 + 0.2085640855200097587e-6 * t2304 * t2307 * t3411 * t463;
  t3434 = t307 * t936;
  t3468 = t930 * t50;
  t3471 = 0.209e3 / 0.243e3 * t172 * t3434 - 0.40265069320467947261e0 * t974 * t432 * t976 * t62 - 0.12201536157717559776e-1 * t2339 * t434 * t3418 * t432 - 0.41801559058847195529e-2 * t980 * t3434 - 0.80665711264910534075e-1 * t427 * t33 * t952 - 0.42797350348706002486e-3 * t928 * t930 * t58 * t50 + 0.4171281710400195174e-6 * t928 * t3411 * t49 * t463 - 0.1517269684499314129e0 * t163 * t3406 * t58 - 0.12332394376798177032e-3 * t959 * t947 * t1548 - 0.14047856833189446932e-5 * t1551 * t962 + 0.33588425688155967615e-3 * t695 * t930 + 0.23358399634202103338e-1 * t414 * t3468;
  t3481 = t26 * t156 * t1583 * t83;
  t3486 = 0.5e1 / 0.36e2 * t26 * t921 * t318 * t83;
  t3497 = 0.5e1 / 0.27648e5 * t2510 * t324;
  t3498 = t1080 * t736;
  t3500 = t3374 / 0.4e1 + t3378 / 0.4e1 - 0.3e1 / 0.8e1 * t3380 - 0.3e1 / 0.4e1 * t3382 - 0.9e1 / 0.8e1 * t372 * t715 - 0.9e1 / 0.8e1 * t152 * t1585 - 0.3e1 / 0.8e1 * t26 * t27 * (t3433 + t3471) * t83 - 0.3e1 / 0.8e1 * t1033 * t320 - 0.3e1 / 0.8e1 * t3481 - t3486 + 0.29e2 / 0.16384e5 * t459 * t462 * t729 * t1091 - 0.45e2 / 0.128e3 * t203 * t206 * t3468 + 0.27e2 / 0.256e3 * t380 * t1643 + t3497 + t3498 / 0.384e3;
  t3501 = t394 * t1643;
  t3509 = t2430 * t324;
  t3511 = t1071 * t736;
  t3515 = t1080 * t719;
  t3517 = t394 * t1625;
  t3519 = t2446 * t733;
  t3521 = t1055 * t1640;
  t3529 = t1071 * t719;
  t3534 = t2542 * t324;
  t3536 = 0.9e1 / 0.256e3 * t3501 + 0.27e2 / 0.256e3 * t203 * t451 * t1543 - 0.15e2 / 0.128e3 * t203 * t718 * t931 - t3509 / 0.3072e4 - t3511 / 0.128e3 + 0.9e1 / 0.256e3 * t380 * t1625 + t3515 / 0.1152e4 + 0.3e1 / 0.256e3 * t3517 - t3519 / 0.442368e6 - 0.25e2 / 0.294912e6 * t3521 - 0.3e1 / 0.256e3 * t203 * t1058 * t692 - 0.25e2 / 0.98304e5 * t459 * t1062 * t1639 - t3529 / 0.384e3 + t459 * t1600 * t1092 / 0.4096e4 + t3534 / 0.2048e4;
  t3540 = t1071 * t726;
  t3544 = t2456 * t733;
  t3548 = t1080 * t726;
  t3550 = t394 * t1636;
  t3552 = t2435 * t1593;
  t3558 = t394 * t1597;
  t3563 = t1055 * t1601;
  t3572 = -0.3e1 / 0.256e3 * t1067 * t736 + t3540 / 0.1024e4 - 0.3e1 / 0.128e3 * t380 * t1636 + t3544 / 0.147456e6 - 0.25e2 / 0.98304e5 * t1076 * t1640 - t3548 / 0.3072e4 - t3550 / 0.128e3 + t3552 / 0.28311552e8 - 0.17e2 / 0.9437184e7 * t1040 * t1043 * t1044 * t1047 - t3558 / 0.384e3 + 0.9e1 / 0.256e3 * t203 * t1596 * t417 - t3563 / 0.110592e6 + t459 * t2461 * t732 / 0.98304e5 - t1067 * t719 / 0.256e3 + t1076 * t1618 / 0.49152e5;
  t3573 = t394 * t1615;
  t3575 = t1055 * t1618;
  t3594 = t1583 * t205;
  t3598 = t713 * t461;
  t3604 = t318 * t1042;
  t3616 = t3573 / 0.2048e4 + t3575 / 0.147456e6 + t203 * t2496 * t323 / 0.2048e4 + t2473 * t1593 / 0.9437184e7 + t1040 * t2476 * t1592 / 0.9437184e7 + t2484 * t2487 * t1044 * t76 / t2489 / t165 / 0.2038431744e10 - t380 * t1597 / 0.128e3 - t203 * t3594 * t209 / 0.256e3 - t459 * t3598 * t468 / 0.36864e5 - t1076 * t1601 / 0.36864e5 - t1040 * t3604 * t1048 / 0.10616832e8 + t2505 * t324 / 0.2048e4 + 0.3e1 / 0.2048e4 * t1067 * t726 + t2451 * t733 / 0.98304e5 + 0.3e1 / 0.2048e4 * t380 * t1615;
  t3619 = my_piecewise3(t1, 0, t3500 + t3536 + t3572 + t3616);
  tv4rho3sigma0 = t6 * t3619 + 0.3e1 * t1648;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3624 = t490 * t745;
  t3626 = t221 * t1656;
  t3631 = 0.5e1 / 0.36e2 * t97 * t921 * t344 * t139;
  t3634 = t2758 * t350;
  t3636 = t2762 * t350;
  t3639 = 0.5e1 / 0.27648e5 * t2766 * t350;
  t3641 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1118 * t346 - 0.3e1 / 0.8e1 * t3624 + t3626 / 0.4e1 - t3631 + t2754 * t350 / 0.2048e4 + t3634 / 0.2048e4 - t3636 / 0.3072e4 + t3639);
  tv4rho3sigma2 = t6 * t3641 + 0.3e1 * t1666;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3643 = 0.2e1 * t1694;
  t3645 = t512 * t681 / 0.4e1;
  t3646 = t237 * t1519;
  t3649 = t237 * t1515 / 0.4e1;
  t3661 = -t3645 + t3646 / 0.12e2 - t3649 - 0.3e1 / 0.8e1 * t237 * t1585 - 0.3e1 / 0.8e1 * t1157 * t320 - 0.3e1 / 0.4e1 * t512 * t715 + t3374 / 0.6e1 + t3378 / 0.6e1 - t3380 / 0.8e1 - t3382 / 0.4e1 - t3481 / 0.8e1 - t3486 + t3497;
  t3675 = t3498 / 0.576e3 + 0.3e1 / 0.256e3 * t3501 - t3509 / 0.4608e4 - t3511 / 0.384e3 + t3515 / 0.1728e4 + t3517 / 0.256e3 - t3519 / 0.663552e6 - 0.25e2 / 0.884736e6 * t3521 - t3529 / 0.1152e4 + t3534 / 0.6144e4 + t3540 / 0.3072e4 + t3544 / 0.442368e6 - t3548 / 0.4608e4;
  t3690 = t1173 * t726 / 0.3072e4;
  t3692 = t2698 * t733 / 0.442368e6;
  t3697 = -t3550 / 0.384e3 + t3552 / 0.84934656e8 - t3558 / 0.1152e4 - t3563 / 0.331776e6 + t3573 / 0.6144e4 + t3575 / 0.442368e6 + t2657 * t324 / 0.2048e4 + t1168 * t726 / 0.1024e4 + t2695 * t733 / 0.147456e6 + t3690 + t3692 + t520 * t1615 / 0.2048e4 + t1178 * t1618 / 0.147456e6;
  t3707 = t1173 * t719 / 0.1152e4;
  t3711 = t2669 * t324 / 0.3072e4;
  t3714 = t2665 * t324;
  t3717 = t1173 * t736 / 0.384e3;
  t3724 = t2649 * t1593 / 0.28311552e8 - t520 * t1597 / 0.384e3 - t1178 * t1601 / 0.110592e6 - t1168 * t719 / 0.384e3 - t3707 + 0.9e1 / 0.256e3 * t520 * t1643 + t3711 - t1168 * t736 / 0.128e3 - t3714 / 0.9216e4 - t3717 - t520 * t1636 / 0.128e3 - 0.25e2 / 0.294912e6 * t1178 * t1640 + 0.3e1 / 0.256e3 * t520 * t1625;
  t3727 = my_piecewise3(t1, 0, t3661 + t3675 + t3697 + t3724);
  tv4rho3sigma3 = t6 * t3727 + t1648 + t3643;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3729 = 0.2e1 * t1729;
  t3732 = t97 * t384 * t793 * t139;
  t3735 = t537 * t745 / 0.4e1;
  t3740 = t247 * t1656;
  t3743 = t221 * t1704 / 0.4e1;
  t3748 = t1234 * t814;
  t3750 = t3732 / 0.12e2 - t3735 - 0.3e1 / 0.8e1 * t490 * t795 - 0.3e1 / 0.8e1 * t1208 * t346 + t3740 / 0.12e2 - t3743 + t3626 / 0.6e1 - t3631 - t3624 / 0.8e1 + t3634 / 0.6144e4 - t3636 / 0.4608e4 + t3639 + t3748 / 0.1152e4;
  t3751 = t1234 * t804;
  t3754 = t2914 * t811 / 0.442368e6;
  t3755 = t2917 * t811;
  t3758 = t1230 * t814 / 0.384e3;
  t3759 = t2944 * t350;
  t3762 = t1230 * t804 / 0.3072e4;
  t3764 = t1230 * t799 / 0.1152e4;
  t3765 = t1234 * t799;
  t3768 = t2940 * t350 / 0.3072e4;
  t3779 = -t3751 / 0.9216e4 + t3754 - t3755 / 0.1327104e7 - t3758 - t3759 / 0.9216e4 + t3762 - t3764 + t3765 / 0.3456e4 + t3768 + t1226 * t804 / 0.2048e4 + t2930 * t811 / 0.294912e6 - t1226 * t814 / 0.256e3 - t1226 * t799 / 0.768e3 + t2936 * t350 / 0.2048e4;
  t3781 = my_piecewise3(t88, 0, t3750 + t3779);
  tv4rho3sigma5 = t6 * t3781 + t1666 + t3729;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3787 = t573 * t681;
  t3795 = -0.3e1 / 0.8e1 * t1255 * t320 - 0.3e1 / 0.8e1 * t573 * t715 - t3787 / 0.8e1 - t3645 + t3646 / 0.6e1 - t3649 + t3374 / 0.12e2 + t3378 / 0.12e2 - t3486 + t3497 + t3498 / 0.1152e4 - t3509 / 0.9216e4 + t3515 / 0.3456e4;
  t3799 = t2838 * t324;
  t3811 = -t3519 / 0.1327104e7 - t3548 / 0.9216e4 + t3690 + t3692 - t3707 + t3711 - t3714 / 0.4608e4 - t3717 + t3799 / 0.6144e4 - t1263 * t736 / 0.256e3 - t1263 * t719 / 0.768e3 + t2834 * t324 / 0.2048e4 + t1263 * t726 / 0.2048e4 + t2830 * t733 / 0.294912e6;
  t3813 = my_piecewise3(t1, 0, t3795 + t3811);
  tv4rho3sigma6 = t6 * t3813 + t1739 + t3643;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3817 = t97 * t156 * t1801 * t139;
  t3819 = t589 * t745;
  t3821 = t247 * t1704;
  t3833 = -t3817 / 0.8e1 - t3819 / 0.8e1 - t3821 / 0.4e1 - 0.3e1 / 0.8e1 * t221 * t1803 - 0.3e1 / 0.8e1 * t1286 * t346 - 0.3e1 / 0.4e1 * t537 * t795 + t3732 / 0.6e1 - t3735 + t3740 / 0.6e1 - t3743 + t3626 / 0.12e2 - t3631 - t3636 / 0.9216e4;
  t3843 = t3639 + t3748 / 0.576e3 - t3751 / 0.4608e4 + t3754 - t3755 / 0.663552e6 - t3758 - t3759 / 0.4608e4 + t3762 - t3764 + t3765 / 0.1728e4 + t3768 + t1318 * t1823 / 0.147456e6 + t3093 * t1829 / 0.28311552e8;
  t3869 = t1301 * t804;
  t3871 = -t1297 * t799 / 0.384e3 - t550 * t1836 / 0.384e3 - t1318 * t1840 / 0.110592e6 + t3082 * t350 / 0.2048e4 + t1297 * t804 / 0.1024e4 + t3087 * t811 / 0.147456e6 + 0.9e1 / 0.256e3 * t550 * t1812 + 0.3e1 / 0.256e3 * t550 * t1815 - t1297 * t814 / 0.128e3 + t550 * t1820 / 0.2048e4 - t550 * t1854 / 0.128e3 - 0.25e2 / 0.294912e6 * t1318 * t1858 + t3869 / 0.3072e4;
  t3872 = t3055 * t811;
  t3874 = t1301 * t799;
  t3876 = t554 * t1836;
  t3878 = t1321 * t1840;
  t3880 = t3066 * t350;
  t3882 = t554 * t1820;
  t3884 = t1321 * t1823;
  t3886 = t3060 * t1829;
  t3888 = t1301 * t814;
  t3890 = t554 * t1854;
  t3892 = t1321 * t1858;
  t3894 = t554 * t1812;
  t3896 = t554 * t1815;
  t3898 = t3872 / 0.442368e6 - t3874 / 0.1152e4 - t3876 / 0.1152e4 - t3878 / 0.331776e6 + t3880 / 0.6144e4 + t3882 / 0.6144e4 + t3884 / 0.442368e6 + t3886 / 0.84934656e8 - t3888 / 0.384e3 - t3890 / 0.384e3 - 0.25e2 / 0.884736e6 * t3892 + 0.3e1 / 0.256e3 * t3894 + t3896 / 0.256e3;
  t3901 = my_piecewise3(t88, 0, t3833 + t3843 + t3871 + t3898);
  tv4rho3sigma8 = t6 * t3901 + t1863 + t3729;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3913 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1347 * t320 - 0.3e1 / 0.8e1 * t3787 + t3646 / 0.4e1 - t3486 + t2984 * t324 / 0.2048e4 + t3799 / 0.2048e4 - t3714 / 0.3072e4 + t3497);
  tv4rho3sigma9 = t6 * t3913 + 0.3e1 * t1739;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3938 = t1358 * t110;
  t3944 = t32 * t1378;
  t3953 = -0.24403072315435119552e-1 * t3201 * t1364 * sigma[2] * t61 - 0.97160380515158346364e-2 * t1788 * t1415 - 0.15816806130374614524e-2 * t271 * t338 * t1422 + 0.12359353216000578294e-5 * t3185 * t1373 * t118 * t132 * t33 + 0.69128983273778274541e-2 * t604 * t1364 * t118 * sigma[2] + 0.33588425688155967615e-3 * t775 * t1358 + 0.23358399634202103338e-1 * t618 * t3938 - 0.80665711264910534075e-1 * t631 * t33 * t1378 - 0.1517269684499314129e0 * t252 * t3944 * t118 - 0.12332394376798177032e-3 * t1385 * t1373 * t1766 - 0.14047856833189446932e-5 * t1769 * t1388;
  t3954 = t333 * t1364;
  t3962 = 0.1e1 / t100 / t293;
  t3974 = 0.1e1 / t99 / t664;
  t4001 = 0.209e3 / 0.243e3 * t261 * t3954 - 0.40265069320467947261e0 * t1400 * t432 * t1402 * t120 - 0.12201536157717559776e-1 * t3166 * t637 * t3962 * t432 - 0.41801559058847195529e-2 * t1406 * t3954 - 0.42797350348706002486e-3 * t1356 * t1358 * t118 * t110 + 0.4171281710400195174e-6 * t1356 * t3974 * t49 * t662 - 0.98516106754904741896e-2 * t636 * t120 * t1402 - 0.16569987374678167598e-3 * t278 * t3944 - 0.10980899102628513796e-3 * t1369 * t943 * t1373 * t132 + 0.2085640855200097587e-6 * t3224 * t2307 * t3974 * t662 + 0.21411152009128862875e-8 * t1355 * t662 * t3974 * t46 * t48 - 0.4067178719239186592e-2 * t3165 * t2322 * t637 * t3962;
  t4020 = -0.9e1 / 0.8e1 * t247 * t1803 - 0.3e1 / 0.8e1 * t97 * t27 * (t3953 + t4001) * t139 - 0.3e1 / 0.8e1 * t1445 * t346 - 0.9e1 / 0.8e1 * t589 * t795 - 0.3e1 / 0.8e1 * t3817 - 0.3e1 / 0.8e1 * t3819 - 0.3e1 / 0.4e1 * t3821 + t3732 / 0.4e1 + t3740 / 0.4e1 - t3631 + t3639 + t3748 / 0.384e3 - t3751 / 0.3072e4 - t3755 / 0.442368e6 - t3759 / 0.3072e4;
  t4036 = t3765 / 0.1152e4 + t3869 / 0.1024e4 + t3872 / 0.147456e6 - t3874 / 0.384e3 - t3876 / 0.384e3 - t3878 / 0.110592e6 + t3880 / 0.2048e4 + t3882 / 0.2048e4 + t3884 / 0.147456e6 + t3886 / 0.28311552e8 - t3888 / 0.128e3 - t3890 / 0.128e3 - 0.25e2 / 0.294912e6 * t3892 + 0.9e1 / 0.256e3 * t3894 + 0.3e1 / 0.256e3 * t3896;
  t4051 = t793 * t660;
  t4055 = t344 * t1483;
  t4084 = 0.29e2 / 0.16384e5 * t658 * t661 * t807 * t1464 - 0.45e2 / 0.128e3 * t289 * t292 * t3938 - 0.15e2 / 0.128e3 * t289 * t798 * t1359 + 0.27e2 / 0.256e3 * t289 * t654 * t1761 - t658 * t4051 * t667 / 0.36864e5 - t1481 * t4055 * t1489 / 0.10616832e8 + t3293 * t350 / 0.2048e4 + 0.3e1 / 0.2048e4 * t1498 * t804 + t3289 * t811 / 0.98304e5 + t658 * t3325 * t810 / 0.98304e5 + t1503 * t1823 / 0.49152e5 + t1481 * t3298 * t1828 / 0.9437184e7 + t3302 * t1829 / 0.9437184e7 + t3305 * t3308 * t1485 * t132 / t3310 / t254 / 0.2038431744e10 - t1503 * t1840 / 0.36864e5;
  t4085 = t1801 * t291;
  t4124 = -t289 * t4085 * t295 / 0.256e3 - t1498 * t799 / 0.256e3 - t596 * t1836 / 0.128e3 + 0.3e1 / 0.2048e4 * t596 * t1820 + t289 * t3319 * t349 / 0.2048e4 - 0.3e1 / 0.128e3 * t596 * t1854 - 0.3e1 / 0.256e3 * t289 * t1493 * t772 - 0.25e2 / 0.98304e5 * t658 * t1477 * t1857 - 0.25e2 / 0.98304e5 * t1503 * t1858 - 0.17e2 / 0.9437184e7 * t1481 * t1484 * t1485 * t1488 + 0.27e2 / 0.256e3 * t596 * t1812 + 0.9e1 / 0.256e3 * t596 * t1815 + 0.9e1 / 0.256e3 * t289 * t1835 * t621 + t658 * t1839 * t1465 / 0.4096e4 - 0.3e1 / 0.256e3 * t1498 * t814;
  t4127 = my_piecewise3(t88, 0, t4020 + t4036 + t4084 + t4124);
  tv4rho3sigma11 = t6 * t4127 + 0.3e1 * t1863;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t4133 = t26 * t384 * t846 * t83 / 0.12e2;
  t4134 = t152 * t1868;
  t4142 = t26 * t156 * t1920 * t83;
  t4153 = 0.1e1 / t36 / t78;
  t4165 = 0.1e1 / t35 / t78 / t401;
  t4167 = t49 * t76;
  t4170 = t48 * t403;
  t4193 = t416 * sigma[0];
  t4215 = 0.1525192019714694972e-2 * t2320 * t2322 * t4153 * t62 + 0.12032070377749260335e-2 * t433 * t435 * t311 + 0.32309183898118511745e-4 * t941 * t1535 * t50 - 0.78211532070003659514e-7 * t2304 * t2307 * t4165 * t76 - 0.49877777777777777777e-2 * t414 * t4193 - 0.80291820034233235782e-9 * t927 * t4165 * t4167 - 0.463475745600021686e-6 * t2286 * t1534 * t58 * t50 * t33 + 0.3737729117625474888e-4 * t1546 * t1887 + 0.3558781379334288268e-2 * t428 * t833 * t409 - 0.23725209195561921787e-3 * t182 * t842 * t440 - 0.78387041129197113882e-4 * t162 * t416 * sigma[0];
  t4224 = t1055 * t1946;
  t4226 = t2435 * t1953;
  t4241 = t4133 - t4134 / 0.4e1 - 0.3e1 / 0.8e1 * t372 * t848 - 0.3e1 / 0.4e1 * t152 * t1922 - t4142 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t27 * (0.43574370732578377058e-6 * t398 * t1534 * t1887 + 0.86935945123737613404e-1 * t974 * t1901 * t435 + 0.91511521182881698319e-2 * t2270 * t1572 + 0.4575576059144084916e-2 * t2339 * t62 * t4153 * t432 + 0.24572538095403418994e-2 * t986 * t1572 + 0.12107145164436566493e-3 * t928 * t1524 * sigma[0] - 0.15642306414000731902e-6 * t928 * t4165 * t4167 - 0.11555284594150620671e-2 * t399 * t4170 * t58 - 0.19e2 / 0.162e3 * t172 * t4170 + 0.97442823481772178766e-3 * t980 * t4170 + t4215) * t83 + t203 * t1058 * t824 / 0.1024e4 - t4224 / 0.1179648e7 - t4226 / 0.113246208e9 - t459 * t2461 * t855 / 0.786432e6 - t1040 * t2476 * t1952 / 0.37748736e8 - t2484 * t2487 * t1044 * t50 / t2489 / t34 / 0.5435817984e10;
  t4246 = t394 * t1964;
  t4248 = t1055 * t1936;
  t4265 = t1920 * t205;
  t4269 = t846 * t461;
  t4275 = t1067 * t859 / 0.1024e4 + t380 * t1964 / 0.512e3 + t4246 / 0.1536e4 + t4248 / 0.221184e6 + t203 * t3594 * t323 / 0.1024e4 + t459 * t3598 * t732 / 0.73728e5 + t1040 * t3604 * t1592 / 0.14155776e8 - t2451 * t856 / 0.786432e6 - t1076 * t1946 / 0.393216e6 - t2473 * t1953 / 0.37748736e8 - t203 * t4265 * t209 / 0.384e3 - t459 * t4269 * t468 / 0.110592e6 + t1067 * t851 / 0.1024e4;
  t4281 = t394 * t1933;
  t4285 = t394 * t1926;
  t4291 = t1071 * t859;
  t4296 = t1080 * t859 / 0.4608e4;
  t4297 = t394 * t1967;
  t4305 = t2456 * t856;
  t4307 = t380 * t1933 / 0.512e3 + t1076 * t1936 / 0.73728e5 + t4281 / 0.1536e4 - t380 * t1926 / 0.384e3 - t4285 / 0.1152e4 - 0.19e2 / 0.36864e5 * t459 * t462 * t463 * t467 + t4291 / 0.1536e4 - t380 * t1967 / 0.64e2 - t4296 - t4297 / 0.192e3 - t203 * t451 * t1890 / 0.64e2 + 0.9e1 / 0.128e3 * t203 * t206 * t4193 - t4305 / 0.1179648e7;
  t4311 = t2446 * t856 / 0.3538944e7;
  t4312 = t1055 * t1957;
  t4333 = t1071 * t851;
  t4338 = t1080 * t851 / 0.4608e4;
  t4339 = t394 * t1939;
  t4341 = t1076 * t1957 / 0.18432e5 + t4311 + t4312 / 0.55296e5 + t459 * t1062 * t1956 / 0.18432e5 + 0.139e3 / 0.226492416e9 * t1040 * t1043 * t1949 * t1591 - t203 * t1596 * t692 / 0.64e2 - 0.25e2 / 0.147456e6 * t459 * t1600 * t1639 + 0.9e1 / 0.128e3 * t203 * t718 * t1543 + 0.3e1 / 0.256e3 * t203 * t1925 * t417 + t4333 / 0.1536e4 - t380 * t1939 / 0.64e2 - t4338 - t4339 / 0.192e3;
  t4344 = my_piecewise3(t1, 0, t4241 + t4275 + t4307 + t4341);
  tv4rho2sigma20 = t6 * t4344 + 0.2e1 * t1971;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4349 = t221 * t1976;
  t4354 = t97 * t384 * t890 * t139 / 0.12e2;
  t4357 = t1230 * t895;
  t4360 = t1234 * t895 / 0.4608e4;
  t4363 = t2914 * t900;
  t4366 = t2917 * t900 / 0.3538944e7;
  t4369 = t1230 * t903;
  t4372 = t1234 * t903 / 0.4608e4;
  t4373 = -0.3e1 / 0.8e1 * t490 * t892 - t4349 / 0.4e1 + t4354 + t1226 * t895 / 0.1024e4 + t4357 / 0.1536e4 - t4360 - t2930 * t900 / 0.786432e6 - t4363 / 0.1179648e7 + t4366 + t1226 * t903 / 0.1024e4 + t4369 / 0.1536e4 - t4372;
  t4374 = my_piecewise3(t88, 0, t4373);
  tv4rho2sigma25 = t6 * t4374 + 0.2e1 * t1992;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4380 = t237 * t1868;
  t4394 = -0.3e1 / 0.8e1 * t512 * t848 - 0.3e1 / 0.8e1 * t237 * t1922 - t4380 / 0.8e1 + t4133 - t4134 / 0.8e1 - t4142 / 0.8e1 - t4224 / 0.2359296e7 - t4226 / 0.226492416e9 + t4246 / 0.3072e4 + t4248 / 0.442368e6 + t4281 / 0.3072e4 - t4285 / 0.2304e4 + t4291 / 0.3072e4 - t4296 - t4297 / 0.384e3 - t4305 / 0.2359296e7 + t4311 + t4312 / 0.110592e6;
  t4397 = t1173 * t859;
  t4401 = t1173 * t851;
  t4405 = t2698 * t856;
  t4427 = t4333 / 0.3072e4 - t4338 - t4339 / 0.384e3 + t4397 / 0.3072e4 - t520 * t1967 / 0.128e3 + t4401 / 0.3072e4 - t520 * t1939 / 0.128e3 - t4405 / 0.2359296e7 + t1178 * t1957 / 0.36864e5 + t1178 * t1936 / 0.147456e6 - t2695 * t856 / 0.786432e6 - t1178 * t1946 / 0.786432e6 - t2649 * t1953 / 0.75497472e8 + t1168 * t859 / 0.1024e4 + t520 * t1964 / 0.1024e4 - t520 * t1926 / 0.768e3 + t1168 * t851 / 0.1024e4 + t520 * t1933 / 0.1024e4;
  t4429 = my_piecewise3(t1, 0, t4394 + t4427);
  tv4rho2sigma26 = t6 * t4429 + t1971 + t2003;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4433 = t97 * t156 * t2056 * t139;
  t4435 = t247 * t1976;
  t4463 = -t4433 / 0.8e1 - t4435 / 0.8e1 - 0.3e1 / 0.8e1 * t221 * t2058 - 0.3e1 / 0.8e1 * t537 * t892 - t4349 / 0.8e1 + t4354 + t1318 * t2070 / 0.147456e6 - t550 * t2073 / 0.128e3 - t3087 * t900 / 0.786432e6 - t1318 * t2078 / 0.786432e6 - t3093 * t2085 / 0.75497472e8 + t1318 * t2089 / 0.36864e5 + t1297 * t903 / 0.1024e4 - t550 * t2062 / 0.768e3 + t1297 * t895 / 0.1024e4 + t550 * t2067 / 0.1024e4 + t4357 / 0.3072e4 - t4360;
  t4470 = t554 * t2094;
  t4472 = t554 * t2097;
  t4474 = t1321 * t2078;
  t4476 = t3060 * t2085;
  t4478 = t1321 * t2089;
  t4480 = t1301 * t903;
  t4482 = t554 * t2067;
  t4484 = t1321 * t2070;
  t4486 = t554 * t2073;
  t4488 = t3055 * t900;
  t4490 = t554 * t2062;
  t4492 = t1301 * t895;
  t4494 = -t4363 / 0.2359296e7 + t4366 + t4369 / 0.3072e4 - t4372 + t550 * t2094 / 0.1024e4 - t550 * t2097 / 0.128e3 + t4470 / 0.3072e4 - t4472 / 0.384e3 - t4474 / 0.2359296e7 - t4476 / 0.226492416e9 + t4478 / 0.110592e6 + t4480 / 0.3072e4 + t4482 / 0.3072e4 + t4484 / 0.442368e6 - t4486 / 0.384e3 - t4488 / 0.2359296e7 - t4490 / 0.2304e4 + t4492 / 0.3072e4;
  t4496 = my_piecewise3(t88, 0, t4463 + t4494);
  tv4rho2sigma211 = t6 * t4496 + t1992 + t2101;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4511 = -0.3e1 / 0.8e1 * t573 * t848 - t4380 / 0.4e1 + t4133 + t1263 * t851 / 0.1024e4 + t4401 / 0.1536e4 - t4338 - t2830 * t856 / 0.786432e6 - t4405 / 0.1179648e7 + t4311 + t1263 * t859 / 0.1024e4 + t4397 / 0.1536e4 - t4296;
  t4512 = my_piecewise3(t1, 0, t4511);
  tv4rho2sigma212 = t6 * t4512 + 0.2e1 * t2003;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4527 = 0.1e1 / t99 / t134 / t605;
  t4532 = t620 * sigma[2];
  t4537 = t132 * t46 * t48;
  t4540 = t48 * t607;
  t4546 = 0.1e1 / t100 / t134;
  t4589 = 0.12107145164436566493e-3 * t1356 * t1742 * sigma[2] - 0.15642306414000731902e-6 * t1356 * t4527 * t4537 - 0.11555284594150620671e-2 * t603 * t4540 * t118 + 0.43574370732578377058e-6 * t602 * t1752 * t2023 + 0.86935945123737613404e-1 * t1400 * t2037 * t638 + 0.91511521182881698319e-2 * t3201 * t1790 + 0.4575576059144084916e-2 * t3166 * t120 * t4546 * t432 + 0.3558781379334288268e-2 * t632 * t877 * t613 - 0.23725209195561921787e-3 * t271 * t886 * t643 - 0.463475745600021686e-6 * t3185 * t1752 * t118 * t110 * t33 + 0.3737729117625474888e-4 * t1764 * t2023;
  t4615 = -0.3e1 / 0.4e1 * t247 * t2058 - 0.3e1 / 0.8e1 * t97 * t27 * (0.24572538095403418994e-2 * t1412 * t1790 + 0.12032070377749260335e-2 * t636 * t638 * t337 + 0.32309183898118511745e-4 * t1369 * t1753 * t110 - 0.78211532070003659514e-7 * t3224 * t2307 * t4527 * t132 - 0.49877777777777777777e-2 * t618 * t4532 - 0.80291820034233235782e-9 * t1355 * t4527 * t4537 - 0.19e2 / 0.162e3 * t261 * t4540 + 0.97442823481772178766e-3 * t1406 * t4540 + 0.1525192019714694972e-2 * t3165 * t2322 * t4546 * t120 - 0.78387041129197113882e-4 * t251 * t620 * sigma[2] + t4589) * t139 - 0.3e1 / 0.8e1 * t589 * t892 - t4433 / 0.4e1 - t4435 / 0.4e1 + t4354 - 0.19e2 / 0.36864e5 * t658 * t661 * t662 * t666 - t596 * t2097 / 0.64e2 - 0.25e2 / 0.147456e6 * t658 * t1839 * t1857 + 0.9e1 / 0.128e3 * t289 * t798 * t1761 + t1503 * t2089 / 0.18432e5 - t596 * t2073 / 0.64e2;
  t4654 = -t289 * t1835 * t772 / 0.64e2 + 0.3e1 / 0.256e3 * t289 * t2061 * t621 + t289 * t1493 * t868 / 0.1024e4 - t3289 * t900 / 0.786432e6 - t1503 * t2078 / 0.393216e6 - t3302 * t2085 / 0.37748736e8 - t658 * t3325 * t899 / 0.786432e6 - t1481 * t3298 * t2084 / 0.37748736e8 - t3305 * t3308 * t1485 * t110 / t3310 / t98 / 0.5435817984e10 + t1498 * t903 / 0.1024e4 + t596 * t2094 / 0.512e3 + t289 * t4085 * t349 / 0.1024e4 + t658 * t4051 * t810 / 0.73728e5;
  t4659 = t2056 * t291;
  t4663 = t890 * t660;
  t4688 = t1481 * t4055 * t1828 / 0.14155776e8 - t289 * t4659 * t295 / 0.384e3 - t658 * t4663 * t667 / 0.110592e6 + t1498 * t895 / 0.1024e4 + t596 * t2067 / 0.512e3 + t1503 * t2070 / 0.73728e5 - t596 * t2062 / 0.384e3 - t289 * t654 * t2026 / 0.64e2 + 0.9e1 / 0.128e3 * t289 * t292 * t4532 + t658 * t1477 * t2088 / 0.18432e5 + 0.139e3 / 0.226492416e9 * t1481 * t1484 * t2081 * t1827 - t4360 + t4366;
  t4701 = -t4372 + t4470 / 0.1536e4 - t4472 / 0.192e3 - t4474 / 0.1179648e7 - t4476 / 0.113246208e9 + t4478 / 0.55296e5 + t4480 / 0.1536e4 + t4482 / 0.1536e4 + t4484 / 0.221184e6 - t4486 / 0.192e3 - t4488 / 0.1179648e7 - t4490 / 0.1152e4 + t4492 / 0.1536e4;
  t4704 = my_piecewise3(t88, 0, t4615 + t4654 + t4688 + t4701);
  tv4rho2sigma217 = t6 * t4704 + 0.2e1 * t2101;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4713 = t58 * t28;
  t4728 = 0.1e1 / t36 / t401;
  t4737 = 0.1e1 / t35 / t2288;
  t4739 = t49 * t50;
  t4765 = -0.31774833744056145251e-3 * t986 * t176 * t2137 - 0.1525192019714694972e-3 * t182 * t2145 * t185 + 0.17380340460000813225e-6 * t2286 * t1880 * t4713 * t190 - 0.95027011465054446308e-5 * t1885 * t2114 - 0.3431682044358063687e-2 * t2270 * t832 * t176 * t61 + 0.2287788029572042458e-2 * t428 * t2131 * t167 + 0.11378764034883452015e-4 * t1896 - 0.17158410221790318435e-2 * t2339 * t311 * t4728 * t432 - 0.635496674881122905e-4 * t980 * t1875 * t832 + 0.58658649052502744635e-7 * t928 * t4737 * t4739 - 0.76021609172043557047e-5 * t941 * t1881 * sigma[0] - 0.11706547360991205777e-6 * t1893 * t2114 - 0.25340536390681185682e-4 * t928 * t1871 + 0.29329324526251372317e-7 * t2304 * t2307 * t4737 * t50 + 0.30109432512837463418e-9 * t927 * t4737 * t4739 - 0.5719470073930106145e-3 * t2320 * t2322 * t4728 * t311 + 0.1525192019714694972e-3 * t433 * t704 * t841 + 0.55419753086419753086e-3 * t414 * t208;
  t4773 = t26 * t156 * t2149 * t83 / 0.8e1;
  t4778 = t2173 * t157 * t2174 / 0.3072e4;
  t4794 = t394 * t2154 / 0.2048e4;
  t4799 = t1055 * t2157 / 0.786432e6;
  t4804 = t394 * t2160 / 0.1024e4;
  t4810 = -0.3e1 / 0.8e1 * t26 * t27 * t4765 * t83 - t4773 - 0.3e1 / 0.8e1 * t152 * t2151 + t4778 - t2173 * t73 * t205 * t208 / 0.128e3 + t201 * t151 * t2175 / 0.1024e4 + t2173 * t195 * t2174 / 0.1024e4 + 0.19e2 / 0.147456e6 * t459 * t462 * t76 * t731 + t4794 - 0.3e1 / 0.256e3 * t203 * t1925 * t692 - t4799 + t459 * t1600 * t1956 / 0.12288e5 + t4804 - t1076 * t2157 / 0.262144e6 - t459 * t3598 * t855 / 0.262144e6;
  t4835 = t2149 * t205;
  t4851 = t2435 * t2166 / 0.603979776e9;
  t4857 = t1055 * t2170 / 0.393216e6;
  t4858 = -t1040 * t3604 * t1952 / 0.25165824e8 + 0.3e1 / 0.1024e4 * t380 * t2160 + 0.3e1 / 0.1024e4 * t203 * t1596 * t824 + t2473 * t2166 / 0.201326592e9 + t1040 * t2476 * t2165 / 0.201326592e9 + t2484 * t2487 * t1045 / t2489 / rho[0] / 0.14495514624e11 - t1076 * t2170 / 0.131072e6 - t459 * t1062 * t2169 / 0.131072e6 - t203 * t4835 * t209 / 0.768e3 + 0.3e1 / 0.2048e4 * t380 * t2154 + 0.3e1 / 0.2048e4 * t203 * t4265 * t323 + t459 * t4269 * t732 / 0.98304e5 - 0.3e1 / 0.128e3 * t203 * t718 * t1890 + t4851 - 0.5e1 / 0.25165824e8 * t1040 * t1043 * t464 * t1951 - t4857;
  t4860 = my_piecewise3(t1, 0, t4810 + t4858);
  tv4rhosigma30 = t6 * t4860 + t2179;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t4867 = t97 * t156 * t2226 * t139 / 0.8e1;
  t4871 = t554 * t2231 / 0.2048e4;
  t4875 = t1321 * t2234 / 0.786432e6;
  t4879 = t554 * t2237 / 0.1024e4;
  t4883 = t3060 * t2243 / 0.603979776e9;
  t4887 = t1321 * t2247 / 0.393216e6;
  t4893 = t2250 * t224 * t2251 / 0.3072e4;
  t4894 = -0.3e1 / 0.8e1 * t221 * t2228 - t4867 + 0.3e1 / 0.2048e4 * t550 * t2231 + t4871 - t1318 * t2234 / 0.262144e6 - t4875 + 0.3e1 / 0.1024e4 * t550 * t2237 + t4879 + t3093 * t2243 / 0.201326592e9 + t4883 - t1318 * t2247 / 0.131072e6 - t4887 + t201 * t220 * t2252 / 0.1024e4 + t4893;
  t4895 = my_piecewise3(t88, 0, t4894);
  tv4rhosigma39 = t6 * t4895 + t2256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t4912 = -0.3e1 / 0.8e1 * t237 * t2151 - t4773 + 0.3e1 / 0.2048e4 * t520 * t2154 + t4794 - t1178 * t2157 / 0.262144e6 - t4799 + 0.3e1 / 0.1024e4 * t520 * t2160 + t4804 + t2649 * t2166 / 0.201326592e9 + t4851 - t1178 * t2170 / 0.131072e6 - t4857 + t201 * t236 * t2175 / 0.1024e4 + t4778;
  t4913 = my_piecewise3(t1, 0, t4912);
  tv4rhosigma310 = t6 * t4913 + t2179;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t4918 = t118 * t28;
  t4940 = 0.1e1 / t99 / t3148;
  t4947 = t110 * t46 * t48;
  t4951 = 0.1e1 / t100 / t605;
  t4977 = 0.17380340460000813225e-6 * t3185 * t2016 * t4918 * t279 - 0.95027011465054446308e-5 * t2021 * t2191 - 0.3431682044358063687e-2 * t3201 * t876 * t265 * t61 + 0.2287788029572042458e-2 * t632 * t2208 * t256 - 0.31774833744056145251e-3 * t1412 * t265 * t2214 - 0.1525192019714694972e-3 * t271 * t2222 * t274 - 0.25340536390681185682e-4 * t1356 * t2007 + 0.29329324526251372317e-7 * t3224 * t2307 * t4940 * t110 + 0.30109432512837463418e-9 * t1355 * t4940 * t4947 - 0.5719470073930106145e-3 * t3165 * t2322 * t4951 * t337 + 0.1525192019714694972e-3 * t636 * t784 * t885 - 0.17158410221790318435e-2 * t3166 * t337 * t4951 * t432 - 0.635496674881122905e-4 * t1406 * t2011 * t876 + 0.58658649052502744635e-7 * t1356 * t4940 * t4947 - 0.76021609172043557047e-5 * t1369 * t2017 * sigma[2] - 0.11706547360991205777e-6 * t2029 * t2191 + 0.55419753086419753086e-3 * t618 * t294 + 0.11378764034883452015e-4 * t2032;
  t5014 = t2226 * t291;
  t5018 = -0.3e1 / 0.8e1 * t247 * t2228 - 0.3e1 / 0.8e1 * t97 * t27 * t4977 * t139 - t4867 + t201 * t246 * t2252 / 0.1024e4 + t2250 * t284 * t2251 / 0.1024e4 - t2250 * t131 * t291 * t294 / 0.128e3 + t4893 - 0.5e1 / 0.25165824e8 * t1481 * t1484 * t663 * t2083 + 0.19e2 / 0.147456e6 * t658 * t661 * t132 * t809 - 0.3e1 / 0.256e3 * t289 * t2061 * t772 + t658 * t1839 * t2088 / 0.12288e5 - 0.3e1 / 0.128e3 * t289 * t798 * t2026 - t1503 * t2247 / 0.131072e6 - t658 * t1477 * t2246 / 0.131072e6 - t289 * t5014 * t295 / 0.768e3;
  t5051 = 0.3e1 / 0.2048e4 * t596 * t2231 + 0.3e1 / 0.2048e4 * t289 * t4659 * t349 + t658 * t4663 * t810 / 0.98304e5 - t1503 * t2234 / 0.262144e6 - t658 * t4051 * t899 / 0.262144e6 - t1481 * t4055 * t2084 / 0.25165824e8 + 0.3e1 / 0.1024e4 * t596 * t2237 + 0.3e1 / 0.1024e4 * t289 * t1835 * t868 + t3302 * t2243 / 0.201326592e9 + t1481 * t3298 * t2242 / 0.201326592e9 + t3305 * t3308 * t1486 / t3310 / rho[1] / 0.14495514624e11 - t4875 + t4879 + t4883 - t4887 + t4871;
  t5053 = my_piecewise3(t88, 0, t5018 + t5051);
  tv4rhosigma319 = t6 * t5053 + t2256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5095 = 0.1e1 / t35 / t945;
  t5104 = sigma[0] * t46 * t48;
  t5118 = -0.15442569199611286592e-1 * t974 * t432 * t2144 * t837 + 0.64344038331713694132e-3 * t2339 * t2263 * t432 * t841 - 0.11915562654021054469e-3 * t980 * t820 * t2130 + 0.12868807666342738826e-2 * t2270 * t2130 * t54 * t61 + 0.42896025554475796088e-2 * t428 * t32 / t76 * t38 - 0.16681787715629476257e-3 * t2135 * t2130 * t46 * t60 - 0.28597350369650530725e-3 * t182 * t60 / t62 / t76 * t64 + 0.21448012777237898044e-3 * t2320 * t2322 * t2263 * t841 + 0.1143894014786021229e-3 * t433 * t837 * t2144 + 0.71270258598790834731e-6 * t941 * t2108 - 0.10998496697344264619e-7 * t2304 * t2307 * t5095 * sigma[0] + 0.21949776301858510832e-7 * t2119 * t33 - 0.11291037192314048782e-9 * t927 * t5095 * t5104 - 0.65176276725003049595e-7 * t2286 * t2107 * t4713 * t32 - 0.21996993394688529238e-7 * t928 * t5095 * t5104 + 0.14254051719758166946e-5 * t959 * t2107 * t28 * t32;
  t5155 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t27 * t5118 * t83 + t203 * t4835 * t323 / 0.512e3 - t459 * t4269 * t855 / 0.131072e6 + 0.3e1 / 0.512e3 * t203 * t1925 * t824 + t1040 * t3604 * t2165 / 0.50331648e8 - t459 * t1600 * t2169 / 0.32768e5 + t2173 * t319 * t2174 / 0.256e3 - t2484 * t2487 * t1044 / t2489 / 0.38654705664e11 + t1040 * t1043 * t729 * t2164 / 0.16777216e8 - 0.5e1 / 0.196608e6 * t459 * t462 * t50 * t854);
  tv4sigma40 = t6 * t5155;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5162 = 0.1e1 / t99 / t1371;
  t5165 = sigma[2] * t46 * t48;
  t5219 = -0.11915562654021054469e-3 * t1406 * t864 * t2207 + 0.21949776301858510832e-7 * t2196 * t33 - 0.11291037192314048782e-9 * t1355 * t5162 * t5165 + 0.21448012777237898044e-3 * t3165 * t2322 * t3144 * t885 + 0.1143894014786021229e-3 * t636 * t881 * t2221 + 0.71270258598790834731e-6 * t1369 * t2185 - 0.10998496697344264619e-7 * t3224 * t2307 * t5162 * sigma[2] - 0.65176276725003049595e-7 * t3185 * t2184 * t4918 * t32 - 0.21996993394688529238e-7 * t1356 * t5162 * t5165 + 0.14254051719758166946e-5 * t1385 * t2184 * t28 * t32 - 0.15442569199611286592e-1 * t1400 * t432 * t2221 * t881 + 0.64344038331713694132e-3 * t3166 * t3144 * t432 * t885 + 0.12868807666342738826e-2 * t3201 * t2207 * t114 * t61 + 0.42896025554475796088e-2 * t632 * t32 / t132 * t102 - 0.16681787715629476257e-3 * t2212 * t2207 * t46 * t60 - 0.28597350369650530725e-3 * t271 * t60 / t120 / t132 * t122;
  t5256 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t97 * t27 * t5219 * t139 + t289 * t5014 * t349 / 0.512e3 - t658 * t4663 * t899 / 0.131072e6 + 0.3e1 / 0.512e3 * t289 * t2061 * t868 + t1481 * t4055 * t2242 / 0.50331648e8 - t658 * t1839 * t2246 / 0.32768e5 + t2250 * t345 * t2251 / 0.256e3 - t3305 * t3308 * t1485 / t3310 / 0.38654705664e11 + t1481 * t1484 * t807 * t2241 / 0.16777216e8 - 0.5e1 / 0.196608e6 * t658 * t661 * t110 * t898);
  tv4sigma414 = t6 * t5256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

