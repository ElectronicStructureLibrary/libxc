/* 
  This file was generated automatically with scripts/maple2c_new.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_x_lspbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 3

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t19;
  double t20, t21, t23, t24, t27, t32, t37, t40;
  double t42, t47, t48, t49, t50, t52, t53, t54;
  double t55, t57, t58, t61, t62, t63, t64, t68;
  double t72, t76, t77, t83, t86, t87, t96, t97;
  double t98, t100, t102, t103, t104, t105, t108, t109;
  double t114, t115, t119, t123, t124, t125, t126, t127;
  double t132, t137, t140, t143, t154, t155, t160, t163;
  double t164, t166, t171, t177, t192, t194, t195, t196;
  double t197, t198, t199, t201, t203, t208, t214, t228;
  double t229, t245, t274, t295;

  gga_x_lspbe_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_lspbe_params * )(p->params);

  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = t9 * t10;
  t12 = M_CBRT6;
  t13 = params->mu * t12;
  t14 = M_PI * M_PI;
  t15 = POW_1_3(t14);
  t16 = t15 * t15;
  t17 = 0.1e1 / t16;
  t19 = sigma[0] * t9;
  t20 = rho[0] * rho[0];
  t21 = t10 * t10;
  t23 = 0.1e1 / t21 / t20;
  t24 = t19 * t23;
  t27 = params->kappa + t13 * t17 * t24 / 0.24e2;
  t32 = params->kappa + 0.1e1;
  t37 = exp(-params->alpha * t12 * t17 * t24 / 0.24e2);
  t40 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t27) - t32 * (0.1e1 - t37);
  t42 = t7 * t11 * t40;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = -0.3e1 / 0.16e2 * t42;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t47 = t10 * rho[0] * t1 * t3;
  t48 = t6 * t9;
  t49 = params->kappa * params->kappa;
  t50 = t27 * t27;
  t52 = t49 / t50;
  t53 = t52 * t13;
  t54 = t17 * sigma[0];
  t55 = t20 * rho[0];
  t57 = 0.1e1 / t21 / t55;
  t58 = t9 * t57;
  t61 = t32 * params->alpha;
  t62 = t12 * t17;
  t63 = t61 * t62;
  t64 = t57 * t37;
  t68 = t63 * t19 * t64 / 0.9e1 - t53 * t54 * t58 / 0.9e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = -t42 / 0.4e1 - 0.3e1 / 0.16e2 * t47 * t48 * t68;

  t72 = t52 * params->mu;
  t76 = t61 * t12;
  t77 = t17 * t9;
  t83 = t48 * (-t76 * t77 * t23 * t37 / 0.24e2 + t72 * t62 * t9 * t23 / 0.24e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = -0.3e1 / 0.16e2 * t47 * t83;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t86 = 0.1e1 / t21;
  t87 = t9 * t86;
  t96 = t49 / t50 / t27;
  t97 = params->mu * params->mu;
  t98 = t12 * t12;
  t100 = t96 * t97 * t98;
  t102 = 0.1e1 / t15 / t14;
  t103 = sigma[0] * sigma[0];
  t104 = t102 * t103;
  t105 = t20 * t20;
  t108 = 0.1e1 / t10 / t105 / t55;
  t109 = t8 * t108;
  t114 = 0.1e1 / t21 / t105;
  t115 = t9 * t114;
  t119 = t114 * t37;
  t123 = params->alpha * params->alpha;
  t124 = t32 * t123;
  t125 = t98 * t102;
  t126 = t124 * t125;
  t127 = t103 * t8;
  t132 = -0.4e1 / 0.81e2 * t100 * t104 * t109 + 0.11e2 / 0.27e2 * t53 * t54 * t115 - 0.11e2 / 0.27e2 * t63 * t19 * t119 + 0.2e1 / 0.81e2 * t126 * t127 * t108 * t37;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = -t7 * t87 * t40 / 0.12e2 - t7 * t11 * t68 / 0.2e1 - 0.3e1 / 0.16e2 * t47 * t48 * t132;

  t137 = t10 * t1 * t3;
  t140 = t102 * t8;
  t143 = 0.1e1 / t10 / t105 / t20;
  t154 = t8 * t143;
  t155 = sigma[0] * t37;
  t160 = t48 * (t100 * t140 * t143 * sigma[0] / 0.54e2 - t72 * t62 * t58 / 0.9e1 + t76 * t77 * t64 / 0.9e1 - t126 * t154 * t155 / 0.108e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = -t137 * t83 / 0.4e1 - 0.3e1 / 0.16e2 * t47 * t160;

  t163 = t96 * t97;
  t164 = t105 * rho[0];
  t166 = 0.1e1 / t10 / t164;
  t171 = t124 * t98;
  t177 = t48 * (-t163 * t125 * t8 * t166 / 0.144e3 + t171 * t140 * t166 * t37 / 0.288e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.16e2 * t47 * t177;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t192 = t50 * t50;
  t194 = t49 / t192;
  t195 = t97 * params->mu;
  t196 = t194 * t195;
  t197 = t14 * t14;
  t198 = 0.1e1 / t197;
  t199 = t103 * sigma[0];
  t201 = t105 * t105;
  t203 = 0.1e1 / t201 / t55;
  t208 = 0.1e1 / t10 / t201;
  t214 = 0.1e1 / t21 / t164;
  t228 = t32 * t123 * params->alpha;
  t229 = t228 * t198;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t7 * t9 / t21 / rho[0] * t40 / 0.18e2 - t7 * t87 * t68 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t11 * t132 - 0.3e1 / 0.16e2 * t47 * t48 * (-0.16e2 / 0.81e2 * t196 * t198 * t199 * t203 + 0.44e2 / 0.81e2 * t100 * t104 * t8 * t208 - 0.154e3 / 0.81e2 * t53 * t54 * t9 * t214 + 0.154e3 / 0.81e2 * t63 * t19 * t214 * t37 - 0.22e2 / 0.81e2 * t126 * t127 * t208 * t37 + 0.8e1 / 0.243e3 * t229 * t199 * t203 * t37);

  t245 = 0.1e1 / t201 / t20;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = -t86 * t1 * t3 * t83 / 0.12e2 - t137 * t160 / 0.2e1 - 0.3e1 / 0.16e2 * t47 * t48 * (0.2e1 / 0.27e2 * t196 * t198 * t245 * t103 - t100 * t140 * t108 * sigma[0] / 0.6e1 + 0.11e2 / 0.27e2 * t72 * t62 * t115 - 0.11e2 / 0.27e2 * t76 * t77 * t119 + t126 * t109 * t155 / 0.12e2 - t229 * t245 * t103 * t37 / 0.81e2);

  t274 = 0.1e1 / t201 / rho[0];
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t137 * t177 / 0.4e1 - 0.3e1 / 0.16e2 * t47 * t48 * (-t196 * t198 * t274 * sigma[0] / 0.36e2 + t163 * t125 * t154 / 0.27e2 - t171 * t140 * t143 * t37 / 0.54e2 + t229 * t274 * sigma[0] * t37 / 0.216e3);

  t295 = 0.1e1 / t201;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = -0.3e1 / 0.16e2 * t47 * t48 * (t194 * t195 * t198 * t295 / 0.96e2 - t228 * t198 * t295 * t37 / 0.576e3);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}


static inline void
func_ferr(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t3, t4, t5, t6, t7, t8, t9;
  double t11, t12, t13, t14, t15, t16, t17, t19;
  double t20, t23, t28, t32, t35, t37, t41, t42;
  double t43, t44, t47, t48, t49, t51, t56, t61;
  double t72, t75, t76, t85, t86, t87, t89, t90;
  double t91, t92, t95, t101, t110, t112, t113, t118;
  double t122, t127, t139, t140, t145, t148, t150, t159;
  double t174, t176, t177, t178, t179, t180, t181, t183;
  double t185, t190, t196, t210, t211, t225, t256, t276;

  gga_x_lspbe_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_lspbe_params * )(p->params);

  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = POW_1_3(rho[0]);
  t8 = t6 * t7;
  t9 = M_CBRT6;
  t11 = M_PI * M_PI;
  t12 = POW_1_3(t11);
  t13 = t12 * t12;
  t14 = 0.1e1 / t13;
  t15 = t14 * sigma[0];
  t16 = rho[0] * rho[0];
  t17 = t7 * t7;
  t19 = 0.1e1 / t17 / t16;
  t20 = t15 * t19;
  t23 = params->kappa + params->mu * t9 * t20 / 0.24e2;
  t28 = params->kappa + 0.1e1;
  t32 = exp(-params->alpha * t9 * t20 / 0.24e2);
  t35 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t23) - t28 * (0.1e1 - t32);
  t37 = t4 * t8 * t35;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = -0.3e1 / 0.8e1 * t37;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t41 = t7 * rho[0] * t1;
  t42 = t3 * t6;
  t43 = params->kappa * params->kappa;
  t44 = t23 * t23;
  t47 = t43 / t44 * params->mu;
  t48 = t9 * t14;
  t49 = t16 * rho[0];
  t51 = 0.1e1 / t17 / t49;
  t56 = t28 * params->alpha * t9;
  t61 = t56 * t15 * t51 * t32 / 0.9e1 - t47 * t48 * sigma[0] * t51 / 0.9e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = -t37 / 0.2e1 - 0.3e1 / 0.8e1 * t41 * t42 * t61;

  t72 = t42 * (-t56 * t14 * t19 * t32 / 0.24e2 + t47 * t48 * t19 / 0.24e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = -0.3e1 / 0.8e1 * t41 * t72;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t75 = 0.1e1 / t17;
  t76 = t6 * t75;
  t85 = params->mu * params->mu;
  t86 = t43 / t44 / t23 * t85;
  t87 = t9 * t9;
  t89 = 0.1e1 / t12 / t11;
  t90 = t87 * t89;
  t91 = sigma[0] * sigma[0];
  t92 = t16 * t16;
  t95 = 0.1e1 / t7 / t92 / t49;
  t101 = 0.1e1 / t17 / t92;
  t110 = params->alpha * params->alpha;
  t112 = t28 * t110 * t87;
  t113 = t89 * t91;
  t118 = -0.2e1 / 0.81e2 * t86 * t90 * t91 * t95 + 0.11e2 / 0.27e2 * t47 * t48 * sigma[0] * t101 - 0.11e2 / 0.27e2 * t56 * t15 * t101 * t32 + t112 * t113 * t95 * t32 / 0.81e2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = -t4 * t76 * t35 / 0.6e1 - t4 * t8 * t61 - 0.3e1 / 0.8e1 * t41 * t42 * t118;

  t122 = t7 * t1;
  t127 = 0.1e1 / t7 / t92 / t16;
  t139 = t89 * t127;
  t140 = sigma[0] * t32;
  t145 = t42 * (t86 * t90 * t127 * sigma[0] / 0.108e3 - t47 * t48 * t51 / 0.9e1 + t56 * t14 * t51 * t32 / 0.9e1 - t112 * t139 * t140 / 0.216e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = -t122 * t72 / 0.2e1 - 0.3e1 / 0.8e1 * t41 * t145;

  t148 = t92 * rho[0];
  t150 = 0.1e1 / t7 / t148;
  t159 = t42 * (-t86 * t90 * t150 / 0.288e3 + t112 * t89 * t150 * t32 / 0.576e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.8e1 * t41 * t159;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t174 = t44 * t44;
  t176 = t43 / t174;
  t177 = t85 * params->mu;
  t178 = t176 * t177;
  t179 = t11 * t11;
  t180 = 0.1e1 / t179;
  t181 = t91 * sigma[0];
  t183 = t92 * t92;
  t185 = 0.1e1 / t183 / t49;
  t190 = 0.1e1 / t7 / t183;
  t196 = 0.1e1 / t17 / t148;
  t210 = t28 * t110 * params->alpha;
  t211 = t210 * t180;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = t4 * t6 / t17 / rho[0] * t35 / 0.9e1 - t4 * t76 * t61 / 0.2e1 - 0.3e1 / 0.2e1 * t4 * t8 * t118 - 0.3e1 / 0.8e1 * t41 * t42 * (-0.4e1 / 0.81e2 * t178 * t180 * t181 * t185 + 0.22e2 / 0.81e2 * t86 * t90 * t91 * t190 - 0.154e3 / 0.81e2 * t47 * t48 * sigma[0] * t196 + 0.154e3 / 0.81e2 * t56 * t15 * t196 * t32 - 0.11e2 / 0.81e2 * t112 * t113 * t190 * t32 + 0.2e1 / 0.243e3 * t211 * t181 * t185 * t32);

  t225 = 0.1e1 / t183 / t16;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = -t75 * t1 * t72 / 0.6e1 - t122 * t145 - 0.3e1 / 0.8e1 * t41 * t42 * (t178 * t180 * t225 * t91 / 0.54e2 - t86 * t90 * t95 * sigma[0] / 0.12e2 + 0.11e2 / 0.27e2 * t47 * t48 * t101 - 0.11e2 / 0.27e2 * t56 * t14 * t101 * t32 + t112 * t89 * t95 * t140 / 0.24e2 - t211 * t225 * t91 * t32 / 0.324e3);

  t256 = 0.1e1 / t183 / rho[0];
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t122 * t159 / 0.2e1 - 0.3e1 / 0.8e1 * t41 * t42 * (-t178 * t180 * t256 * sigma[0] / 0.144e3 + t86 * t90 * t127 / 0.54e2 - t112 * t139 * t32 / 0.108e3 + t211 * t256 * sigma[0] * t32 / 0.864e3);

  t276 = 0.1e1 / t183;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = -0.3e1 / 0.8e1 * t41 * t42 * (t176 * t177 * t180 * t276 / 0.384e3 - t210 * t180 * t276 * t32 / 0.2304e4);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, double *zk, double *vrho, double *vsigma, double *v2rho2, double *v2rhosigma, double *v2sigma2, double *v3rho3, double *v3rho2sigma, double *v3rhosigma2, double *v3sigma3)
{
  double t1, t3, t4, t5, t6, t7, t8, t9;
  double t10, t11, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t24, t25, t26;
  double t27, t29, t30, t33, t38, t39, t42, t45;
  double t47, t49, t50, t51, t52, t53, t54, t55;
  double t56, t58, t59, t62, t69, t72, t74, t76;
  double t77, t78, t79, t80, t81, t83, t84, t86;
  double t87, t88, t89, t90, t92, t93, t94, t95;
  double t98, t99, t100, t102, t107, t112, t114, t115;
  double t116, t117, t118, t120, t121, t122, t124, t125;
  double t129, t130, t132, t133, t134, t135, t137, t138;
  double t139, t142, t143, t145, t153, t155, t156, t160;
  double t161, t162, t169, t173, t180, t184, t186, t187;
  double t188, t189, t190, t191, t193, t194, t195, t197;
  double t198, t199, t201, t202, t203, t204, t205, t206;
  double t208, t209, t211, t212, t214, t215, t217, t218;
  double t222, t223, t224, t226, t227, t228, t229, t232;
  double t238, t247, t249, t250, t255, t257, t258, t259;
  double t260, t261, t262, t263, t265, t266, t267, t269;
  double t270, t271, t272, t274, t275, t276, t278, t279;
  double t280, t282, t283, t284, t285, t287, t290, t292;
  double t294, t297, t298, t299, t301, t305, t306, t307;
  double t308, t310, t313, t315, t316, t318, t321, t323;
  double t326, t328, t331, t332, t334, t335, t336, t337;
  double t338, t340, t341, t342, t343, t345, t346, t347;
  double t348, t350, t351, t352, t354, t355, t356, t360;
  double t361, t362, t365, t371, t380, t385, t387, t388;
  double t389, t392, t394, t395, t401, t413, t414, t418;
  double t423, t424, t425, t430, t435, t440, t452, t453;
  double t457, t458, t461, t463, t471, t472, t475, t477;
  double t485, t486, t492, t494, t503, t505, t515, t517;
  double t519, t527, t529, t539, t542, t545, t547, t549;
  double t550, t551, t552, t553, t554, t556, t558, t563;
  double t569, t583, t584, t594, t595, t601, t603, t609;
  double t611, t614, t615, t621, t623, t629, t631, t633;
  double t640, t641, t654, t660, t668, t669, t675, t683;
  double t693, t695, t705, t711, t714, t721, t725, t731;
  double t739, t740, t743, t749, t752, t755, t758, t761;
  double t791, t795, t812, t829, t832, t843, t865, t867;
  double t868, t869, t871, t873, t878, t884, t930, t934;
  double t938, t940, t953, t982, t986, t998, t999, t1002;
  double t1012, t1018, t1028, t1056, t1084, t1091, t1110, t1125;
  double t1144, t1145, t1157;

  gga_x_lspbe_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_lspbe_params * )(p->params);

  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t4 = t1 * t3;
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t4 * t6;
  t8 = rho[0] - rho[1];
  t9 = rho[0] + rho[1];
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t13 = 0.1e1 / 0.2e1 + t11 / 0.2e1;
  t14 = POW_1_3(t13);
  t15 = t14 * t13;
  t16 = POW_1_3(t9);
  t17 = t15 * t16;
  t18 = M_CBRT6;
  t19 = params->mu * t18;
  t20 = M_PI * M_PI;
  t21 = POW_1_3(t20);
  t22 = t21 * t21;
  t23 = 0.1e1 / t22;
  t24 = t23 * sigma[0];
  t25 = rho[0] * rho[0];
  t26 = POW_1_3(rho[0]);
  t27 = t26 * t26;
  t29 = 0.1e1 / t27 / t25;
  t30 = t24 * t29;
  t33 = params->kappa + t19 * t30 / 0.24e2;
  t38 = params->kappa + 0.1e1;
  t39 = params->alpha * t18;
  t42 = exp(-t39 * t30 / 0.24e2);
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t33) - t38 * (0.1e1 - t42);
  t47 = t7 * t17 * t45;
  t49 = 0.1e1 / 0.2e1 - t11 / 0.2e1;
  t50 = POW_1_3(t49);
  t51 = t50 * t49;
  t52 = t51 * t16;
  t53 = t23 * sigma[2];
  t54 = rho[1] * rho[1];
  t55 = POW_1_3(rho[1]);
  t56 = t55 * t55;
  t58 = 0.1e1 / t56 / t54;
  t59 = t53 * t58;
  t62 = params->kappa + t19 * t59 / 0.24e2;
  t69 = exp(-t39 * t59 / 0.24e2);
  t72 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t62) - t38 * (0.1e1 - t69);
  t74 = t7 * t52 * t72;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    *zk = -0.3e1 / 0.8e1 * t47 - 0.3e1 / 0.8e1 * t74;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t76 = 0.3e1 / 0.8e1 * t47;
  t77 = 0.3e1 / 0.8e1 * t74;
  t78 = t14 * t16;
  t79 = t9 * t9;
  t80 = 0.1e1 / t79;
  t81 = t8 * t80;
  t83 = t10 / 0.2e1 - t81 / 0.2e1;
  t84 = t45 * t83;
  t86 = t7 * t78 * t84;
  t87 = t86 / 0.2e1;
  t88 = t16 * t16;
  t89 = 0.1e1 / t88;
  t90 = t15 * t89;
  t92 = t7 * t90 * t45;
  t93 = t92 / 0.8e1;
  t94 = params->kappa * params->kappa;
  t95 = t33 * t33;
  t98 = t94 / t95 * params->mu;
  t99 = t18 * t23;
  t100 = t25 * rho[0];
  t102 = 0.1e1 / t27 / t100;
  t107 = t38 * params->alpha * t18;
  t112 = t107 * t24 * t102 * t42 / 0.9e1 - t98 * t99 * sigma[0] * t102 / 0.9e1;
  t114 = t7 * t17 * t112;
  t115 = 0.3e1 / 0.8e1 * t114;
  t116 = t50 * t16;
  t117 = -t83;
  t118 = t72 * t117;
  t120 = t7 * t116 * t118;
  t121 = t120 / 0.2e1;
  t122 = t51 * t89;
  t124 = t7 * t122 * t72;
  t125 = t124 / 0.8e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = -t76 - t77 + t9 * (-t87 - t93 - t115 - t121 - t125);

  t129 = -t10 / 0.2e1 - t81 / 0.2e1;
  t130 = t45 * t129;
  t132 = t7 * t78 * t130;
  t133 = t132 / 0.2e1;
  t134 = -t129;
  t135 = t72 * t134;
  t137 = t7 * t116 * t135;
  t138 = t137 / 0.2e1;
  t139 = t62 * t62;
  t142 = t94 / t139 * params->mu;
  t143 = t54 * rho[1];
  t145 = 0.1e1 / t56 / t143;
  t153 = t107 * t53 * t145 * t69 / 0.9e1 - t142 * t99 * sigma[2] * t145 / 0.9e1;
  t155 = t7 * t52 * t153;
  t156 = 0.3e1 / 0.8e1 * t155;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = -t76 - t77 + t9 * (-t133 - t93 - t138 - t125 - t156);

  t160 = t16 * t9 * t1;
  t161 = t160 * t3;
  t162 = t6 * t15;
  t169 = -t107 * t23 * t29 * t42 / 0.24e2 + t98 * t99 * t29 / 0.24e2;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = -0.3e1 / 0.8e1 * t161 * t162 * t169;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t173 = t6 * t51;
  t180 = -t107 * t23 * t58 * t69 / 0.24e2 + t142 * t99 * t58 / 0.24e2;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = -0.3e1 / 0.8e1 * t161 * t173 * t180;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t184 = t92 / 0.4e1;
  t186 = t124 / 0.4e1;
  t187 = t14 * t14;
  t188 = 0.1e1 / t187;
  t189 = t188 * t16;
  t190 = t83 * t83;
  t191 = t45 * t190;
  t193 = t7 * t189 * t191;
  t194 = t193 / 0.6e1;
  t195 = t14 * t89;
  t197 = t7 * t195 * t84;
  t198 = t197 / 0.3e1;
  t199 = t112 * t83;
  t201 = t7 * t78 * t199;
  t202 = t79 * t9;
  t203 = 0.1e1 / t202;
  t204 = t8 * t203;
  t205 = -t80 + t204;
  t206 = t45 * t205;
  t208 = t7 * t78 * t206;
  t209 = t208 / 0.2e1;
  t211 = 0.1e1 / t88 / t9;
  t212 = t15 * t211;
  t214 = t7 * t212 * t45;
  t215 = t214 / 0.12e2;
  t217 = t7 * t90 * t112;
  t218 = t217 / 0.4e1;
  t222 = params->mu * params->mu;
  t223 = t94 / t95 / t33 * t222;
  t224 = t18 * t18;
  t226 = 0.1e1 / t21 / t20;
  t227 = t224 * t226;
  t228 = sigma[0] * sigma[0];
  t229 = t25 * t25;
  t232 = 0.1e1 / t26 / t229 / t100;
  t238 = 0.1e1 / t27 / t229;
  t247 = params->alpha * params->alpha;
  t249 = t38 * t247 * t224;
  t250 = t226 * t228;
  t255 = -0.2e1 / 0.81e2 * t223 * t227 * t228 * t232 + 0.11e2 / 0.27e2 * t98 * t99 * sigma[0] * t238 - 0.11e2 / 0.27e2 * t107 * t24 * t238 * t42 + t249 * t250 * t232 * t42 / 0.81e2;
  t257 = t7 * t17 * t255;
  t258 = 0.3e1 / 0.8e1 * t257;
  t259 = t50 * t50;
  t260 = 0.1e1 / t259;
  t261 = t260 * t16;
  t262 = t117 * t117;
  t263 = t72 * t262;
  t265 = t7 * t261 * t263;
  t266 = t265 / 0.6e1;
  t267 = t50 * t89;
  t269 = t7 * t267 * t118;
  t270 = t269 / 0.3e1;
  t271 = -t205;
  t272 = t72 * t271;
  t274 = t7 * t116 * t272;
  t275 = t274 / 0.2e1;
  t276 = t51 * t211;
  t278 = t7 * t276 * t72;
  t279 = t278 / 0.12e2;
  t280 = -t194 - t198 - t201 - t209 + t215 - t218 - t258 - t266 - t270 - t275 + t279;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = -t86 - t184 - 0.3e1 / 0.4e1 * t114 - t120 - t186 + t9 * t280;

  t282 = t6 * t188;
  t283 = t4 * t282;
  t284 = t16 * t45;
  t285 = t129 * t83;
  t287 = t283 * t284 * t285;
  t290 = t7 * t195 * t130;
  t292 = t112 * t129;
  t294 = t7 * t78 * t292;
  t297 = 0.1e1 / t88 / t79;
  t298 = t14 * t297;
  t299 = t45 * t8;
  t301 = t7 * t298 * t299;
  t305 = t6 * t260;
  t306 = t4 * t305;
  t307 = t16 * t72;
  t308 = t134 * t117;
  t310 = t306 * t307 * t308;
  t313 = t7 * t267 * t135;
  t315 = t50 * t297;
  t316 = t72 * t8;
  t318 = t7 * t315 * t316;
  t321 = t153 * t117;
  t323 = t7 * t116 * t321;
  t326 = t7 * t122 * t153;
  t328 = -t287 / 0.6e1 - t290 / 0.6e1 - t294 / 0.2e1 - t301 / 0.2e1 - t197 / 0.6e1 + t215 - t217 / 0.8e1 - t310 / 0.6e1 - t313 / 0.6e1 + t318 / 0.2e1 - t269 / 0.6e1 + t279 - t323 / 0.2e1 - t326 / 0.8e1;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t9 * t328 - t115 - t121 - t133 - t138 - t156 - t184 - t186 - t87;

  t331 = t129 * t129;
  t332 = t45 * t331;
  t334 = t7 * t189 * t332;
  t335 = t334 / 0.6e1;
  t336 = t290 / 0.3e1;
  t337 = t80 + t204;
  t338 = t45 * t337;
  t340 = t7 * t78 * t338;
  t341 = t340 / 0.2e1;
  t342 = t134 * t134;
  t343 = t72 * t342;
  t345 = t7 * t261 * t343;
  t346 = t345 / 0.6e1;
  t347 = t313 / 0.3e1;
  t348 = t153 * t134;
  t350 = t7 * t116 * t348;
  t351 = -t337;
  t352 = t72 * t351;
  t354 = t7 * t116 * t352;
  t355 = t354 / 0.2e1;
  t356 = t326 / 0.4e1;
  t360 = t94 / t139 / t62 * t222;
  t361 = sigma[2] * sigma[2];
  t362 = t54 * t54;
  t365 = 0.1e1 / t55 / t362 / t143;
  t371 = 0.1e1 / t56 / t362;
  t380 = t226 * t361;
  t385 = -0.2e1 / 0.81e2 * t360 * t227 * t361 * t365 + 0.11e2 / 0.27e2 * t142 * t99 * sigma[2] * t371 - 0.11e2 / 0.27e2 * t107 * t53 * t371 * t69 + t249 * t380 * t365 * t69 / 0.81e2;
  t387 = t7 * t52 * t385;
  t388 = 0.3e1 / 0.8e1 * t387;
  t389 = -t335 - t336 - t341 + t215 - t346 - t347 - t350 - t355 + t279 - t356 - t388;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = -t132 - t184 - t137 - t186 - 0.3e1 / 0.4e1 * t155 + t9 * t389;

  t392 = t7 * t17 * t169;
  t394 = t6 * t14;
  t395 = t169 * t83;
  t401 = 0.1e1 / t26 / t229 / t25;
  t413 = t226 * t401;
  t414 = sigma[0] * t42;
  t418 = t223 * t227 * t401 * sigma[0] / 0.108e3 - t98 * t99 * t102 / 0.9e1 + t107 * t23 * t102 * t42 / 0.9e1 - t249 * t413 * t414 / 0.216e3;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = -t392 / 0.2e1 - t161 * t394 * t395 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t162 * t418;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t423 = t7 * t52 * t180;
  t424 = t6 * t50;
  t425 = t180 * t117;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = -t161 * t424 * t425 / 0.2e1 - t423 / 0.2e1;

  t430 = t394 * t169 * t129;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = -t161 * t430 / 0.2e1 - t392 / 0.2e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t435 = t424 * t180 * t134;
  t440 = 0.1e1 / t55 / t362 / t54;
  t452 = t226 * t440;
  t453 = sigma[2] * t69;
  t457 = t360 * t227 * t440 * sigma[2] / 0.108e3 - t142 * t99 * t145 / 0.9e1 + t107 * t23 * t145 * t69 / 0.9e1 - t249 * t452 * t453 / 0.216e3;
  t458 = t173 * t457;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = -t423 / 0.2e1 - t161 * t435 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t458;

  t461 = t229 * rho[0];
  t463 = 0.1e1 / t26 / t461;
  t471 = -t223 * t227 * t463 / 0.288e3 + t249 * t226 * t463 * t42 / 0.576e3;
  t472 = t162 * t471;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = -0.3e1 / 0.8e1 * t161 * t472;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t475 = t362 * rho[1];
  t477 = 0.1e1 / t55 / t475;
  t485 = -t360 * t227 * t477 / 0.288e3 + t249 * t226 * t477 * t69 / 0.576e3;
  t486 = t173 * t485;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = -0.3e1 / 0.8e1 * t161 * t486;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t492 = t214 / 0.4e1;
  t494 = t278 / 0.4e1;
  t503 = t7 * t195 * t199;
  t505 = t7 * t195 * t206;
  t515 = t79 * t79;
  t517 = t8 / t515;
  t519 = 0.3e1 * t203 - 0.3e1 * t517;
  t527 = 0.5e1 / 0.36e2 * t7 * t15 * t297 * t45;
  t529 = t7 * t267 * t272;
  t539 = 0.5e1 / 0.36e2 * t7 * t51 * t297 * t72;
  t542 = t7 * t212 * t112;
  t545 = t7 * t90 * t255;
  t547 = t95 * t95;
  t549 = t94 / t547;
  t550 = t222 * params->mu;
  t551 = t549 * t550;
  t552 = t20 * t20;
  t553 = 0.1e1 / t552;
  t554 = t228 * sigma[0];
  t556 = t229 * t229;
  t558 = 0.1e1 / t556 / t100;
  t563 = 0.1e1 / t26 / t556;
  t569 = 0.1e1 / t27 / t461;
  t583 = t38 * t247 * params->alpha;
  t584 = t583 * t553;
  t594 = 0.1e1 / t187 / t13;
  t595 = t594 * t16;
  t601 = t188 * t89;
  t603 = t7 * t601 * t191;
  t609 = t14 * t211;
  t611 = t7 * t609 * t84;
  t614 = 0.1e1 / t259 / t49;
  t615 = t614 * t16;
  t621 = t260 * t89;
  t623 = t7 * t621 * t263;
  t629 = t50 * t211;
  t631 = t7 * t629 * t118;
  t633 = t542 / 0.4e1 - 0.3e1 / 0.8e1 * t545 - 0.3e1 / 0.8e1 * t7 * t17 * (-0.4e1 / 0.81e2 * t551 * t553 * t554 * t558 + 0.22e2 / 0.81e2 * t223 * t227 * t228 * t563 - 0.154e3 / 0.81e2 * t98 * t99 * sigma[0] * t569 + 0.154e3 / 0.81e2 * t107 * t24 * t569 * t42 - 0.11e2 / 0.81e2 * t249 * t250 * t563 * t42 + 0.2e1 / 0.243e3 * t584 * t554 * t558 * t42) + t7 * t595 * t45 * t190 * t83 / 0.9e1 - t603 / 0.6e1 - t283 * t284 * t83 * t205 / 0.2e1 + t611 / 0.3e1 + t7 * t615 * t72 * t262 * t117 / 0.9e1 - t623 / 0.6e1 - t306 * t307 * t117 * t271 / 0.2e1 + t631 / 0.3e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = -t193 / 0.2e1 - t197 - 0.3e1 * t201 - 0.3e1 / 0.2e1 * t208 + t492 - 0.3e1 / 0.2e1 * t274 + t494 - 0.3e1 / 0.4e1 * t217 - 0.9e1 / 0.8e1 * t257 - t265 / 0.2e1 - t269 + t9 * (-t7 * t189 * t112 * t190 / 0.2e1 - t503 - t505 / 0.2e1 - 0.3e1 / 0.2e1 * t7 * t78 * t255 * t83 - 0.3e1 / 0.2e1 * t7 * t78 * t112 * t205 - t7 * t78 * t45 * t519 / 0.2e1 - t527 - t529 / 0.2e1 + t7 * t116 * t72 * t519 / 0.2e1 - t539 + t633);

  t640 = t287 / 0.3e1;
  t641 = t310 / 0.3e1;
  t654 = t297 * t72;
  t660 = t4 * t6 * t594;
  t668 = t283 * t89 * t45 * t285 / 0.9e1;
  t669 = t297 * t45;
  t675 = t4 * t6 * t614;
  t683 = t306 * t89 * t72 * t308 / 0.9e1;
  t693 = t7 * t276 * t153;
  t695 = -t283 * t16 * t112 * t285 / 0.3e1 - t283 * t284 * t129 * t205 / 0.6e1 - t306 * t307 * t134 * t271 / 0.6e1 + t306 * t654 * t8 * t117 / 0.3e1 + t660 * t284 * t129 * t190 / 0.9e1 - t668 - t283 * t669 * t8 * t83 / 0.3e1 + t675 * t307 * t134 * t262 / 0.9e1 - t683 - t527 - t539 + t542 / 0.6e1 - t545 / 0.8e1 - t7 * t298 * t45 / 0.2e1 + t7 * t315 * t72 / 0.2e1 + t693 / 0.12e2;
  t705 = t7 * t195 * t292 / 0.3e1;
  t711 = 0.1e1 / t88 / t202;
  t714 = t7 * t50 * t711 * t316;
  t721 = t7 * t609 * t130;
  t725 = t7 * t14 * t711 * t299;
  t731 = t7 * t629 * t135;
  t739 = t7 * t267 * t321 / 0.3e1;
  t740 = -t503 / 0.3e1 - t505 / 0.6e1 - t529 / 0.6e1 - t603 / 0.18e2 + 0.2e1 / 0.9e1 * t611 - t623 / 0.18e2 + 0.2e1 / 0.9e1 * t631 - t705 - t7 * t78 * t255 * t129 / 0.2e1 - 0.7e1 / 0.6e1 * t714 - t7 * t116 * t153 * t271 / 0.2e1 + t721 / 0.9e1 + 0.7e1 / 0.6e1 * t725 - t7 * t298 * t112 * t8 + t731 / 0.9e1 - t7 * t261 * t153 * t262 / 0.6e1 - t739;
  t743 = -t356 - t217 / 0.2e1 - t258 - t266 - 0.2e1 / 0.3e1 * t269 - t640 - t336 - t301 - t641 - t347 + t9 * (t695 + t740);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[1] = -t194 - 0.2e1 / 0.3e1 * t197 - t201 - t209 + t492 - t275 + t494 - t294 + t318 - t323 + t743;

  t749 = t7 * t601 * t332;
  t752 = t7 * t195 * t338;
  t755 = t7 * t621 * t343;
  t758 = t7 * t267 * t348;
  t761 = t7 * t267 * t352;
  t791 = -t749 / 0.18e2 - t752 / 0.6e1 - t755 / 0.18e2 - t758 / 0.3e1 - t761 / 0.6e1 - t668 - t683 + t660 * t284 * t331 * t83 / 0.9e1 - t283 * t284 * t337 * t83 / 0.6e1 + t675 * t307 * t342 * t117 / 0.9e1 + t306 * t654 * t134 * t8 / 0.3e1 - t306 * t16 * t153 * t308 / 0.3e1 - t306 * t307 * t351 * t117 / 0.6e1 - t283 * t669 * t129 * t8 / 0.3e1 - t527 - t539;
  t795 = t7 * t122 * t385;
  t812 = -t203 - 0.3e1 * t517;
  t829 = t542 / 0.12e2 + t693 / 0.6e1 - t795 / 0.8e1 + t611 / 0.9e1 + t631 / 0.9e1 - t705 + t714 / 0.3e1 + 0.2e1 / 0.9e1 * t721 - t725 / 0.3e1 + 0.2e1 / 0.9e1 * t731 - t739 - t7 * t189 * t112 * t331 / 0.6e1 - t7 * t78 * t112 * t337 / 0.2e1 - t7 * t78 * t45 * t812 / 0.2e1 + t7 * t315 * t153 * t8 + t7 * t116 * t72 * t812 / 0.2e1 - t7 * t116 * t385 * t117 / 0.2e1;
  t832 = -t218 - t388 - t270 - t640 - 0.2e1 / 0.3e1 * t290 - t301 - t641 - 0.2e1 / 0.3e1 * t313 - t335 - t346 + t9 * (t791 + t829);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[2] = -t198 + t492 + t494 - t294 + t318 - t323 - t326 / 0.2e1 - t341 - t350 - t355 + t832;

  t843 = -0.3e1 * t203 - 0.3e1 * t517;
  t865 = t139 * t139;
  t867 = t94 / t865;
  t868 = t867 * t550;
  t869 = t361 * sigma[2];
  t871 = t362 * t362;
  t873 = 0.1e1 / t871 / t143;
  t878 = 0.1e1 / t55 / t871;
  t884 = 0.1e1 / t56 / t475;
  t930 = t721 / 0.3e1 + t731 / 0.3e1 - t749 / 0.6e1 - t752 / 0.2e1 - t755 / 0.6e1 - t758 - t761 / 0.2e1 + t7 * t595 * t45 * t331 * t129 / 0.9e1 - t283 * t284 * t129 * t337 / 0.2e1 + t7 * t615 * t72 * t342 * t134 / 0.9e1 - t306 * t307 * t134 * t351 / 0.2e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[3] = t492 + t494 - 0.3e1 / 0.4e1 * t326 - 0.3e1 / 0.2e1 * t340 - 0.3e1 * t350 - 0.3e1 / 0.2e1 * t354 - 0.9e1 / 0.8e1 * t387 - t290 - t313 - t334 / 0.2e1 - t345 / 0.2e1 + t9 * (-t527 - t539 + t693 / 0.4e1 - 0.3e1 / 0.8e1 * t795 - t7 * t78 * t45 * t843 / 0.2e1 - t7 * t261 * t153 * t342 / 0.2e1 - 0.3e1 / 0.2e1 * t7 * t116 * t385 * t134 - 0.3e1 / 0.2e1 * t7 * t116 * t153 * t351 + t7 * t116 * t72 * t843 / 0.2e1 - 0.3e1 / 0.8e1 * t7 * t52 * (-0.4e1 / 0.81e2 * t868 * t553 * t869 * t873 + 0.22e2 / 0.81e2 * t360 * t227 * t361 * t878 - 0.154e3 / 0.81e2 * t142 * t99 * sigma[2] * t884 + 0.154e3 / 0.81e2 * t107 * t53 * t884 * t69 - 0.11e2 / 0.81e2 * t249 * t380 * t878 * t69 + 0.2e1 / 0.243e3 * t584 * t869 * t873 * t69) + t930);

  t934 = t7 * t78 * t395;
  t938 = t7 * t90 * t169 / 0.6e1;
  t940 = t7 * t17 * t418;
  t953 = 0.1e1 / t556 / t25;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = -0.4e1 / 0.3e1 * t934 - t938 - t940 - t161 * t282 * t169 * t190 / 0.6e1 - t161 * t394 * t418 * t83 - t161 * t394 * t169 * t205 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t162 * (t551 * t553 * t953 * t228 / 0.54e2 - t223 * t227 * t232 * sigma[0] / 0.12e2 + 0.11e2 / 0.27e2 * t98 * t99 * t238 - 0.11e2 / 0.27e2 * t107 * t23 * t238 * t42 + t249 * t226 * t232 * t414 / 0.24e2 - t584 * t953 * t228 * t42 / 0.324e3);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[1] = 0.0e0;

  t982 = t7 * t116 * t425;
  t986 = t7 * t122 * t180 / 0.6e1;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[2] = -0.4e1 / 0.3e1 * t982 - t986 - t161 * t305 * t180 * t262 / 0.6e1 - t161 * t424 * t180 * t271 / 0.2e1;

  t998 = t16 * t1 * t3;
  t999 = t998 * t430;
  t1002 = t160 * t3 * t6;
  t1012 = t211 * t1 * t3;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[3] = -0.2e1 / 0.3e1 * t934 - t938 - t940 / 0.2e1 - 0.2e1 / 0.3e1 * t999 - t1002 * t188 * t169 * t285 / 0.6e1 - t161 * t394 * t418 * t129 / 0.2e1 - t1012 * t394 * t169 * t8 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[4] = 0.0e0;

  t1018 = t998 * t435;
  t1028 = t998 * t458;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[5] = -0.2e1 / 0.3e1 * t982 - t986 - 0.2e1 / 0.3e1 * t1018 - t1002 * t260 * t180 * t308 / 0.6e1 + t1012 * t424 * t180 * t8 / 0.2e1 - t1028 / 0.2e1 - t161 * t424 * t457 * t117 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[6] = -0.4e1 / 0.3e1 * t999 - t938 - t161 * t282 * t169 * t331 / 0.6e1 - t161 * t394 * t169 * t337 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[7] = 0.0e0;

  t1056 = 0.1e1 / t871 / t54;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[8] = -0.4e1 / 0.3e1 * t1018 - t986 - t1028 - t161 * t305 * t180 * t342 / 0.6e1 - t161 * t424 * t457 * t134 - t161 * t424 * t180 * t351 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t173 * (t868 * t553 * t1056 * t361 / 0.54e2 - t360 * t227 * t365 * sigma[2] / 0.12e2 + 0.11e2 / 0.27e2 * t142 * t99 * t371 - 0.11e2 / 0.27e2 * t107 * t23 * t371 * t69 + t249 * t226 * t365 * t453 / 0.24e2 - t584 * t1056 * t361 * t69 / 0.324e3);

  t1084 = t998 * t472;
  t1091 = 0.1e1 / t556 / rho[0];
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = -t1084 / 0.2e1 - t161 * t394 * t471 * t83 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t162 * (-t551 * t553 * t1091 * sigma[0] / 0.144e3 + t223 * t227 * t401 / 0.54e2 - t249 * t413 * t42 / 0.108e3 + t584 * t1091 * sigma[0] * t42 / 0.864e3);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[4] = 0.0e0;

  t1110 = t998 * t486;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[5] = -t161 * t424 * t485 * t117 / 0.2e1 - t1110 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[6] = -t161 * t394 * t471 * t129 / 0.2e1 - t1084 / 0.2e1;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[8] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[9] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[10] = 0.0e0;

  t1125 = 0.1e1 / t871 / rho[1];
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[11] = -t1110 / 0.2e1 - t161 * t424 * t485 * t134 / 0.2e1 - 0.3e1 / 0.8e1 * t161 * t173 * (-t868 * t553 * t1125 * sigma[2] / 0.144e3 + t360 * t227 * t440 / 0.54e2 - t249 * t452 * t69 / 0.108e3 + t584 * t1125 * sigma[2] * t69 / 0.864e3);

  t1144 = t550 * t553;
  t1145 = 0.1e1 / t556;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = -0.3e1 / 0.8e1 * t161 * t162 * (t549 * t1144 * t1145 / 0.384e3 - t583 * t553 * t1145 * t42 / 0.2304e4);

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[1] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[2] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[3] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[4] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[5] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[6] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[7] = 0.0e0;

  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[8] = 0.0e0;

  t1157 = 0.1e1 / t871;
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[9] = -0.3e1 / 0.8e1 * t161 * t173 * (t867 * t1144 * t1157 / 0.384e3 - t583 * t553 * t1157 * t69 / 0.2304e4);

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


#endif

#endif

#endif

#endif


}

