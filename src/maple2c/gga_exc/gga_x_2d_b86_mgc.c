/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_2d_b86_mgc.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;

  double t150, t165, t169, t171, t175, t178, t183, tv3rho30;
  double t195, t198, t202, t206, t211, tv3rho2sigma0, t218, t222;
  double t226, t231, tv3rhosigma20, t239, t243, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t150 = t17 / t18 / t20;
  t165 = 0.1e1 / t91 / t42;
  t169 = t47 * t47;
  t171 = 0.1e1 / t91 / t48;
  t175 = 0.1e1 / t28 / t100 / t25;
  t178 = -0.26456532405541184982e0 * t67 * t29 + 0.15193642625581030499e-1 * t47 * t137 * t52 - 0.30308369141068214309e-3 * t96 * t165 * t102 + 0.19820157999801558748e-5 * t169 * t171 * t175;
  t183 = my_piecewise3(t2, 0, -t16 * t150 * t32 / 0.4e1 + t16 * t79 * t55 / 0.2e1 - t16 * t38 * t105 - 0.2e1 / 0.3e1 * t16 * t19 * t178);
  tv3rho30 = 0.2e1 * rho[0] * t183 + 0.6e1 * t110;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t195 = t92 * t52;
  t198 = t98 * t102;
  t202 = 0.1e1 / t91 / t65;
  t206 = 0.52913064811082369964e-1 * t87 * t29 - 0.39635589458037470869e-2 * t195 * sigma[0] + 0.91406192647666043157e-4 * t198 * t47 - 0.66067193332671862493e-6 * t96 * t202 * t175;
  t211 = my_piecewise3(t2, 0, t16 * t79 * t70 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t126 - 0.2e1 / 0.3e1 * t16 * t19 * t206);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t218 = t122 * t102;
  t222 = 0.1e1 / t91 / t86;
  t226 = 0.6605931576339578478e-3 * t118 - 0.24054261223070011357e-4 * t218 * sigma[0] + 0.22022397777557287498e-6 * t47 * t222 * t175;
  t231 = my_piecewise3(t2, 0, -t16 * t38 * t141 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t226);
  tv3rhosigma20 = 0.2e1 * rho[0] * t231 + 0.2e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t239 = 0.48108522446140022714e-5 * t137 * t102 - 0.73407992591857624994e-7 * sigma[0] * t165 * t175;
  t243 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t239);
  tv3sigma30 = 0.2e1 * rho[0] * t243;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;

  double t150, t165, t169, t171, t175, t178, t183, tv3rho30;
  double t195, t198, t202, t206, t211, tv3rho2sigma0, t218, t222;
  double t226, t231, tv3rhosigma20, t239, t243, tv3sigma30;

  double t267, t268, t276, t278, t286, tv4rho40, t319, tv4rho3sigma0;
  double t345, tv4rho2sigma20, t363, tv4rhosigma30, t375, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t150 = t17 / t18 / t20;
  t165 = 0.1e1 / t91 / t42;
  t169 = t47 * t47;
  t171 = 0.1e1 / t91 / t48;
  t175 = 0.1e1 / t28 / t100 / t25;
  t178 = -0.26456532405541184982e0 * t67 * t29 + 0.15193642625581030499e-1 * t47 * t137 * t52 - 0.30308369141068214309e-3 * t96 * t165 * t102 + 0.19820157999801558748e-5 * t169 * t171 * t175;
  t183 = my_piecewise3(t2, 0, -t16 * t150 * t32 / 0.4e1 + t16 * t79 * t55 / 0.2e1 - t16 * t38 * t105 - 0.2e1 / 0.3e1 * t16 * t19 * t178);
  tv3rho30 = 0.2e1 * rho[0] * t183 + 0.6e1 * t110;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t195 = t92 * t52;
  t198 = t98 * t102;
  t202 = 0.1e1 / t91 / t65;
  t206 = 0.52913064811082369964e-1 * t87 * t29 - 0.39635589458037470869e-2 * t195 * sigma[0] + 0.91406192647666043157e-4 * t198 * t47 - 0.66067193332671862493e-6 * t96 * t202 * t175;
  t211 = my_piecewise3(t2, 0, t16 * t79 * t70 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t126 - 0.2e1 / 0.3e1 * t16 * t19 * t206);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t218 = t122 * t102;
  t222 = 0.1e1 / t91 / t86;
  t226 = 0.6605931576339578478e-3 * t118 - 0.24054261223070011357e-4 * t218 * sigma[0] + 0.22022397777557287498e-6 * t47 * t222 * t175;
  t231 = my_piecewise3(t2, 0, -t16 * t38 * t141 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t226);
  tv3rhosigma20 = 0.2e1 * rho[0] * t231 + 0.2e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t239 = 0.48108522446140022714e-5 * t137 * t102 - 0.73407992591857624994e-7 * sigma[0] * t165 * t175;
  t243 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t239);
  tv3sigma30 = 0.2e1 * rho[0] * t243;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t267 = t91 * t91;
  t268 = 0.1e1 / t267;
  t276 = t100 * t100;
  t278 = 0.1e1 / t28 / t276;
  t286 = my_piecewise3(t2, 0, 0.5e1 / 0.8e1 * t16 * t17 / t18 / t21 * t32 - t16 * t150 * t55 + t16 * t79 * t105 - 0.4e1 / 0.3e1 * t16 * t38 * t178 - 0.2e1 / 0.3e1 * t16 * t19 * (0.15873919443324710989e1 * sigma[0] * t49 * t29 - 0.14665168099473864221e0 * t123 * t52 + 0.4964799516441650344e-2 * t96 * t222 * t102 - 0.71352568799285611491e-4 * t169 * t268 * t175 + 0.37116714382278384028e-6 * t169 * sigma[0] / t267 / t21 * t278));
  tv4rho40 = 0.2e1 * rho[0] * t286 + 0.8e1 * t183;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t319 = my_piecewise3(t2, 0, -t16 * t150 * t70 / 0.4e1 + t16 * t79 * t126 / 0.2e1 - t16 * t38 * t206 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.26456532405541184982e0 * t66 * t29 + 0.33690251039331850238e-1 * t137 * t52 * sigma[0] - 0.13518494807365346382e-2 * t165 * t102 * t47 + 0.21802173799781714623e-4 * t171 * t175 * t96 - 0.12372238127426128009e-6 * t169 / t267 / t20 * t278));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t319 + 0.6e1 * t211;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t345 = my_piecewise3(t2, 0, t16 * t79 * t141 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t226 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.46241521034377049346e-2 * t195 + 0.29827283916606814083e-3 * t198 * sigma[0] - 0.61662713777160404994e-5 * t202 * t175 * t47 + 0.41240793758087093365e-7 * t96 / t267 / rho[0] * t278));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t345 + 0.4e1 * t231;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t363 = my_piecewise3(t2, 0, -t16 * t38 * t239 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.43297670201526020443e-4 * t218 + 0.15415678444290101249e-5 * t222 * t175 * sigma[0] - 0.13746931252695697789e-7 * t47 * t268 * t278));
  tv4rhosigma30 = 0.2e1 * rho[0] * t363 + 0.2e1 * t243;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t375 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * (-0.29363197036743049997e-6 * t165 * t175 + 0.45823104175652325962e-8 * sigma[0] * t171 * t278));
  tv4sigma40 = 0.2e1 * rho[0] * t375;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t31, t33, t34, t35, t36, t37, t40;
  double t41, t44, t45, t46, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t60;
  double t61, t62, t63, t64, t67, t68, t71, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t16 = my_piecewise5(t8, t9, t12, t13, t14 * t5);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = -t14;
  t48 = my_piecewise5(t12, t9, t8, t13, t46 * t5);
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = sqrt(t49);
  t52 = t51 * t49;
  t53 = my_piecewise3(t50, t20, t52);
  t54 = t3 * t53;
  t55 = rho[1] * rho[1];
  t56 = t55 * rho[1];
  t57 = 0.1e1 / t56;
  t58 = sigma[2] * t57;
  t60 = 0.1e1 + 0.8323e-2 * t58;
  t61 = POW_1_4(t60);
  t62 = t61 * t61;
  t63 = t62 * t61;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + 0.22047110337950987485e-2 * t58 * t64;
  t68 = t27 * t67;
  t71 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t68);
  tzk0 = t44 + t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t31, t33, t34, t35, t36, t37, t40;
  double t41, t44, t45, t46, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t60;
  double t61, t62, t63, t64, t67, t68, t71, tzk0;

  double t72, t73, t74, t76, t79, t80, t84, t85;
  double t87, t88, t89, t93, t94, t95, t98, t101;
  double t102, t106, t107, t109, t112, t113, t116, t118;
  double t120, tvrho0, t124, t127, t128, t132, t134, t137;
  double t138, t141, t142, t146, t147, t148, t151, t154;
  double t155, t159, tvrho1, t164, t165, t166, t169, t170;
  double t173, tvsigma0, tvsigma1, t176, t177, t178, t181, t182;
  double t185, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t16 = my_piecewise5(t8, t9, t12, t13, t14 * t5);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = -t14;
  t48 = my_piecewise5(t12, t9, t8, t13, t46 * t5);
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = sqrt(t49);
  t52 = t51 * t49;
  t53 = my_piecewise3(t50, t20, t52);
  t54 = t3 * t53;
  t55 = rho[1] * rho[1];
  t56 = t55 * rho[1];
  t57 = 0.1e1 / t56;
  t58 = sigma[2] * t57;
  t60 = 0.1e1 + 0.8323e-2 * t58;
  t61 = POW_1_4(t60);
  t62 = t61 * t61;
  t63 = t62 * t61;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + 0.22047110337950987485e-2 * t58 * t64;
  t68 = t27 * t67;
  t71 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t68);
  tzk0 = t44 + t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t72 = t4 * t4;
  t73 = 0.1e1 / t72;
  t74 = t14 * t73;
  t76 = my_piecewise5(t8, 0, t12, 0, t5 - t74);
  t79 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t76);
  t80 = t3 * t79;
  t84 = t25 / t26;
  t85 = t84 * t40;
  t87 = t24 * t85 / 0.3e1;
  t88 = t28 * t28;
  t89 = 0.1e1 / t88;
  t93 = sigma[0] * sigma[0];
  t94 = t88 * t29;
  t95 = 0.1e1 / t94;
  t98 = 0.1e1 / t36 / t33;
  t101 = -0.66141331013852962455e-2 * sigma[0] * t89 * t37 + 0.41287072352122365488e-4 * t93 * t95 * t98;
  t102 = t27 * t101;
  t106 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t41 - t87 - 0.2e1 / 0.3e1 * t24 * t102);
  t107 = t46 * t73;
  t109 = my_piecewise5(t12, 0, t8, 0, -t5 - t107);
  t112 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t109);
  t113 = t3 * t112;
  t116 = t84 * t67;
  t118 = t54 * t116 / 0.3e1;
  t120 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t68 - t118);
  tvrho0 = t44 + t71 + t4 * (t106 + t120);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t124 = my_piecewise5(t8, 0, t12, 0, -t5 - t74);
  t127 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t124);
  t128 = t3 * t127;
  t132 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t41 - t87);
  t134 = my_piecewise5(t12, 0, t8, 0, t5 - t107);
  t137 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t134);
  t138 = t3 * t137;
  t141 = t55 * t55;
  t142 = 0.1e1 / t141;
  t146 = sigma[2] * sigma[2];
  t147 = t141 * t56;
  t148 = 0.1e1 / t147;
  t151 = 0.1e1 / t63 / t60;
  t154 = -0.66141331013852962455e-2 * sigma[2] * t142 * t64 + 0.41287072352122365488e-4 * t146 * t148 * t151;
  t155 = t27 * t154;
  t159 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t68 - t118 - 0.2e1 / 0.3e1 * t54 * t155);
  tvrho1 = t44 + t71 + t4 * (t132 + t159);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t164 = t88 * t28;
  t165 = 0.1e1 / t164;
  t166 = sigma[0] * t165;
  t169 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t166 * t98;
  t170 = t27 * t169;
  t173 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t170);
  tvsigma0 = t4 * t173;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t176 = t141 * t55;
  t177 = 0.1e1 / t176;
  t178 = sigma[2] * t177;
  t181 = 0.22047110337950987485e-2 * t57 * t64 - 0.13762357450707455163e-4 * t178 * t151;
  t182 = t27 * t181;
  t185 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t182);
  tvsigma2 = t4 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t31, t33, t34, t35, t36, t37, t40;
  double t41, t44, t45, t46, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t60;
  double t61, t62, t63, t64, t67, t68, t71, tzk0;

  double t72, t73, t74, t76, t79, t80, t84, t85;
  double t87, t88, t89, t93, t94, t95, t98, t101;
  double t102, t106, t107, t109, t112, t113, t116, t118;
  double t120, tvrho0, t124, t127, t128, t132, t134, t137;
  double t138, t141, t142, t146, t147, t148, t151, t154;
  double t155, t159, tvrho1, t164, t165, t166, t169, t170;
  double t173, tvsigma0, tvsigma1, t176, t177, t178, t181, t182;
  double t185, tvsigma2;

  double t188, t189, t192, t193, t194, t197, t201, t202;
  double t205, t211, t212, t214, t215, t216, t218, t219;
  double t223, t224, t228, t230, t232, t234, t237, t238;
  double t242, t243, t244, t247, t250, t254, t255, t258;
  double t260, t262, t264, tv2rho20, t267, t271, t275, t276;
  double t279, t286, t287, t291, t295, t296, t299, t304;
  double t305, t308, tv2rho21, t313, t318, t322, t323, t328;
  double t329, t334, t338, t339, t346, t347, t351, t352;
  double t356, t358, t360, t362, t365, t366, t370, tv2rho22;
  double t375, t377, t380, t384, t385, t388, t389, t393;
  double tv2rhosigma0, tv2rhosigma1, t397, t399, t401, tv2rhosigma2, t406, tv2rhosigma3;
  double tv2rhosigma4, t412, t416, t417, t420, t421, t425, tv2rhosigma5;
  double t430, t434, t435, t438, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t442, t446, t447, t450, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t16 = my_piecewise5(t8, t9, t12, t13, t14 * t5);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = -t14;
  t48 = my_piecewise5(t12, t9, t8, t13, t46 * t5);
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = sqrt(t49);
  t52 = t51 * t49;
  t53 = my_piecewise3(t50, t20, t52);
  t54 = t3 * t53;
  t55 = rho[1] * rho[1];
  t56 = t55 * rho[1];
  t57 = 0.1e1 / t56;
  t58 = sigma[2] * t57;
  t60 = 0.1e1 + 0.8323e-2 * t58;
  t61 = POW_1_4(t60);
  t62 = t61 * t61;
  t63 = t62 * t61;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + 0.22047110337950987485e-2 * t58 * t64;
  t68 = t27 * t67;
  t71 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t68);
  tzk0 = t44 + t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t72 = t4 * t4;
  t73 = 0.1e1 / t72;
  t74 = t14 * t73;
  t76 = my_piecewise5(t8, 0, t12, 0, t5 - t74);
  t79 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t76);
  t80 = t3 * t79;
  t84 = t25 / t26;
  t85 = t84 * t40;
  t87 = t24 * t85 / 0.3e1;
  t88 = t28 * t28;
  t89 = 0.1e1 / t88;
  t93 = sigma[0] * sigma[0];
  t94 = t88 * t29;
  t95 = 0.1e1 / t94;
  t98 = 0.1e1 / t36 / t33;
  t101 = -0.66141331013852962455e-2 * sigma[0] * t89 * t37 + 0.41287072352122365488e-4 * t93 * t95 * t98;
  t102 = t27 * t101;
  t106 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t41 - t87 - 0.2e1 / 0.3e1 * t24 * t102);
  t107 = t46 * t73;
  t109 = my_piecewise5(t12, 0, t8, 0, -t5 - t107);
  t112 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t109);
  t113 = t3 * t112;
  t116 = t84 * t67;
  t118 = t54 * t116 / 0.3e1;
  t120 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t68 - t118);
  tvrho0 = t44 + t71 + t4 * (t106 + t120);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t124 = my_piecewise5(t8, 0, t12, 0, -t5 - t74);
  t127 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t124);
  t128 = t3 * t127;
  t132 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t41 - t87);
  t134 = my_piecewise5(t12, 0, t8, 0, t5 - t107);
  t137 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t134);
  t138 = t3 * t137;
  t141 = t55 * t55;
  t142 = 0.1e1 / t141;
  t146 = sigma[2] * sigma[2];
  t147 = t141 * t56;
  t148 = 0.1e1 / t147;
  t151 = 0.1e1 / t63 / t60;
  t154 = -0.66141331013852962455e-2 * sigma[2] * t142 * t64 + 0.41287072352122365488e-4 * t146 * t148 * t151;
  t155 = t27 * t154;
  t159 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t68 - t118 - 0.2e1 / 0.3e1 * t54 * t155);
  tvrho1 = t44 + t71 + t4 * (t132 + t159);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t164 = t88 * t28;
  t165 = 0.1e1 / t164;
  t166 = sigma[0] * t165;
  t169 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t166 * t98;
  t170 = t27 * t169;
  t173 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t170);
  tvsigma0 = t4 * t173;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t176 = t141 * t55;
  t177 = 0.1e1 / t176;
  t178 = sigma[2] * t177;
  t181 = 0.22047110337950987485e-2 * t57 * t64 - 0.13762357450707455163e-4 * t178 * t151;
  t182 = t27 * t181;
  t185 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t182);
  tvsigma2 = t4 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t188 = 0.1e1 / t21;
  t189 = t76 * t76;
  t192 = t72 * t4;
  t193 = 0.1e1 / t192;
  t194 = t14 * t193;
  t197 = my_piecewise5(t8, 0, t12, 0, -0.2e1 * t73 + 0.2e1 * t194);
  t201 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t189 + 0.3e1 / 0.2e1 * t21 * t197);
  t202 = t3 * t201;
  t205 = t80 * t85;
  t211 = t25 / t26 / t4;
  t212 = t211 * t40;
  t214 = t24 * t212 / 0.6e1;
  t215 = t84 * t101;
  t216 = t24 * t215;
  t218 = t88 * rho[0];
  t219 = 0.1e1 / t218;
  t223 = t88 * t88;
  t224 = 0.1e1 / t223;
  t228 = t93 * sigma[0];
  t230 = 0.1e1 / t223 / t29;
  t232 = t33 * t33;
  t234 = 0.1e1 / t36 / t232;
  t237 = 0.26456532405541184982e-1 * sigma[0] * t219 * t37 - 0.41287072352122365489e-3 * t93 * t224 * t98 + 0.18040695917302508518e-5 * t228 * t230 * t234;
  t238 = t27 * t237;
  t242 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t41 - 0.2e1 / 0.3e1 * t205 - 0.4e1 / 0.3e1 * t80 * t102 + t214 - 0.2e1 / 0.3e1 * t216 - 0.2e1 / 0.3e1 * t24 * t238);
  t243 = 0.1e1 / t51;
  t244 = t109 * t109;
  t247 = t46 * t193;
  t250 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t73 + 0.2e1 * t247);
  t254 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t244 + 0.3e1 / 0.2e1 * t51 * t250);
  t255 = t3 * t254;
  t258 = t113 * t116;
  t260 = t211 * t67;
  t262 = t54 * t260 / 0.6e1;
  t264 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t68 - 0.2e1 / 0.3e1 * t258 + t262);
  tv2rho20 = 0.2e1 * t106 + 0.2e1 * t120 + t4 * (t242 + t264);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t267 = t188 * t124;
  t271 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t194);
  t275 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t267 * t76 + 0.3e1 / 0.2e1 * t21 * t271);
  t276 = t3 * t275;
  t279 = t128 * t85;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t41 - t279 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t102 - t205 / 0.3e1 + t214 - t216 / 0.3e1);
  t287 = t243 * t134;
  t291 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t247);
  t295 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t287 * t109 + 0.3e1 / 0.2e1 * t51 * t291);
  t296 = t3 * t295;
  t299 = t138 * t116;
  t304 = t84 * t154;
  t305 = t54 * t304;
  t308 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t68 - t299 / 0.3e1 - t258 / 0.3e1 + t262 - 0.2e1 / 0.3e1 * t113 * t155 - t305 / 0.3e1);
  tv2rho21 = t106 + t120 + t132 + t159 + t4 * (t286 + t308);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t313 = t124 * t124;
  t318 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t73 + 0.2e1 * t194);
  t322 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t313 + 0.3e1 / 0.2e1 * t21 * t318);
  t323 = t3 * t322;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t41 - 0.2e1 / 0.3e1 * t279 + t214);
  t329 = t134 * t134;
  t334 = my_piecewise5(t12, 0, t8, 0, -0.2e1 * t73 + 0.2e1 * t247);
  t338 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t329 + 0.3e1 / 0.2e1 * t51 * t334);
  t339 = t3 * t338;
  t346 = t141 * rho[1];
  t347 = 0.1e1 / t346;
  t351 = t141 * t141;
  t352 = 0.1e1 / t351;
  t356 = t146 * sigma[2];
  t358 = 0.1e1 / t351 / t56;
  t360 = t60 * t60;
  t362 = 0.1e1 / t63 / t360;
  t365 = 0.26456532405541184982e-1 * sigma[2] * t347 * t64 - 0.41287072352122365489e-3 * t146 * t352 * t151 + 0.18040695917302508518e-5 * t356 * t358 * t362;
  t366 = t27 * t365;
  t370 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t68 - 0.2e1 / 0.3e1 * t299 - 0.4e1 / 0.3e1 * t138 * t155 + t262 - 0.2e1 / 0.3e1 * t305 - 0.2e1 / 0.3e1 * t54 * t366);
  tv2rho22 = 0.2e1 * t132 + 0.2e1 * t159 + t4 * (t328 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t375 = t84 * t169;
  t377 = t24 * t375 / 0.3e1;
  t380 = t95 * t98;
  t384 = 0.1e1 / t223 / t28;
  t385 = t93 * t384;
  t388 = -0.66141331013852962455e-2 * t89 * t37 + 0.12386121705636709647e-3 * t380 * sigma[0] - 0.60135653057675028394e-6 * t385 * t234;
  t389 = t27 * t388;
  t393 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t170 - t377 - 0.2e1 / 0.3e1 * t24 * t389);
  tv2rhosigma0 = t4 * t393 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t397 = t84 * t181;
  t399 = t54 * t397 / 0.3e1;
  t401 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t182 - t399);
  tv2rhosigma2 = t4 * t401 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t406 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t170 - t377);
  tv2rhosigma3 = t4 * t406 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t412 = t148 * t151;
  t416 = 0.1e1 / t351 / t55;
  t417 = t146 * t416;
  t420 = -0.66141331013852962455e-2 * t142 * t64 + 0.12386121705636709647e-3 * t412 * sigma[2] - 0.60135653057675028394e-6 * t417 * t362;
  t421 = t27 * t420;
  t425 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t182 - t399 - 0.2e1 / 0.3e1 * t54 * t421);
  tv2rhosigma5 = t4 * t425 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t430 = 0.1e1 / t223 / rho[0];
  t434 = -0.27524714901414910326e-4 * t165 * t98 + 0.20045217685891676131e-6 * sigma[0] * t430 * t234;
  t435 = t27 * t434;
  t438 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t435);
  tv2sigma20 = t4 * t438;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t442 = 0.1e1 / t351 / rho[1];
  t446 = -0.27524714901414910326e-4 * t177 * t151 + 0.20045217685891676131e-6 * sigma[2] * t442 * t362;
  t447 = t27 * t446;
  t450 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t447);
  tv2sigma25 = t4 * t450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t31, t33, t34, t35, t36, t37, t40;
  double t41, t44, t45, t46, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t60;
  double t61, t62, t63, t64, t67, t68, t71, tzk0;

  double t72, t73, t74, t76, t79, t80, t84, t85;
  double t87, t88, t89, t93, t94, t95, t98, t101;
  double t102, t106, t107, t109, t112, t113, t116, t118;
  double t120, tvrho0, t124, t127, t128, t132, t134, t137;
  double t138, t141, t142, t146, t147, t148, t151, t154;
  double t155, t159, tvrho1, t164, t165, t166, t169, t170;
  double t173, tvsigma0, tvsigma1, t176, t177, t178, t181, t182;
  double t185, tvsigma2;

  double t188, t189, t192, t193, t194, t197, t201, t202;
  double t205, t211, t212, t214, t215, t216, t218, t219;
  double t223, t224, t228, t230, t232, t234, t237, t238;
  double t242, t243, t244, t247, t250, t254, t255, t258;
  double t260, t262, t264, tv2rho20, t267, t271, t275, t276;
  double t279, t286, t287, t291, t295, t296, t299, t304;
  double t305, t308, tv2rho21, t313, t318, t322, t323, t328;
  double t329, t334, t338, t339, t346, t347, t351, t352;
  double t356, t358, t360, t362, t365, t366, t370, tv2rho22;
  double t375, t377, t380, t384, t385, t388, t389, t393;
  double tv2rhosigma0, tv2rhosigma1, t397, t399, t401, tv2rhosigma2, t406, tv2rhosigma3;
  double tv2rhosigma4, t412, t416, t417, t420, t421, t425, tv2rhosigma5;
  double t430, t434, t435, t438, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t442, t446, t447, t450, tv2sigma25;

  double t453, t454, t457, t460, t461, t462, t465, t469;
  double t470, t473, t476, t478, t484, t485, t487, t488;
  double t489, t491, t492, t499, t503, t505, t509, t512;
  double t513, t517, t518, t519, t522, t525, t528, t532;
  double t533, t536, t537, t539, t541, t543, tv3rho30, t546;
  double t547, t548, t551, t556, t557, t559, t563, t564;
  double t568, t571, t574, t582, t583, t584, t587, t592;
  double t594, t598, t599, t603, t604, t611, t612, t613;
  double t616, tv3rho31, t619, t624, t628, t632, t633, t636;
  double t644, t645, t650, t654, t658, t659, t662, t667;
  double t673, t674, t676, t677, tv3rho32, t682, t689, t693;
  double t694, t699, t700, t707, t711, t712, t728, t732;
  double t734, t738, t741, t742, t746, tv3rho33, t752, t756;
  double t758, t759, t760, t764, t767, t771, t775, t776;
  double t780, tv3rho2sigma0, tv3rho2sigma1, t785, t787, t789, t791, tv3rho2sigma2;
  double t795, t802, tv3rho2sigma3, tv3rho2sigma4, t806, t811, t812, t815;
  double tv3rho2sigma5, t822, tv3rho2sigma6, tv3rho2sigma7, t833, t836, t840, t844;
  double t845, t849, tv3rho2sigma8, t853, t855, t857, t861, t865;
  double t866, t870, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t874;
  double t876, t878, tv3rhosigma25, t883, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t888, t892, t896, t897, t901, tv3rhosigma211, t908;
  double t909, t912, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, t918, t919, t922, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t16 = my_piecewise5(t8, t9, t12, t13, t14 * t5);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = -t14;
  t48 = my_piecewise5(t12, t9, t8, t13, t46 * t5);
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = sqrt(t49);
  t52 = t51 * t49;
  t53 = my_piecewise3(t50, t20, t52);
  t54 = t3 * t53;
  t55 = rho[1] * rho[1];
  t56 = t55 * rho[1];
  t57 = 0.1e1 / t56;
  t58 = sigma[2] * t57;
  t60 = 0.1e1 + 0.8323e-2 * t58;
  t61 = POW_1_4(t60);
  t62 = t61 * t61;
  t63 = t62 * t61;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + 0.22047110337950987485e-2 * t58 * t64;
  t68 = t27 * t67;
  t71 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t68);
  tzk0 = t44 + t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t72 = t4 * t4;
  t73 = 0.1e1 / t72;
  t74 = t14 * t73;
  t76 = my_piecewise5(t8, 0, t12, 0, t5 - t74);
  t79 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t76);
  t80 = t3 * t79;
  t84 = t25 / t26;
  t85 = t84 * t40;
  t87 = t24 * t85 / 0.3e1;
  t88 = t28 * t28;
  t89 = 0.1e1 / t88;
  t93 = sigma[0] * sigma[0];
  t94 = t88 * t29;
  t95 = 0.1e1 / t94;
  t98 = 0.1e1 / t36 / t33;
  t101 = -0.66141331013852962455e-2 * sigma[0] * t89 * t37 + 0.41287072352122365488e-4 * t93 * t95 * t98;
  t102 = t27 * t101;
  t106 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t41 - t87 - 0.2e1 / 0.3e1 * t24 * t102);
  t107 = t46 * t73;
  t109 = my_piecewise5(t12, 0, t8, 0, -t5 - t107);
  t112 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t109);
  t113 = t3 * t112;
  t116 = t84 * t67;
  t118 = t54 * t116 / 0.3e1;
  t120 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t68 - t118);
  tvrho0 = t44 + t71 + t4 * (t106 + t120);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t124 = my_piecewise5(t8, 0, t12, 0, -t5 - t74);
  t127 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t124);
  t128 = t3 * t127;
  t132 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t41 - t87);
  t134 = my_piecewise5(t12, 0, t8, 0, t5 - t107);
  t137 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t134);
  t138 = t3 * t137;
  t141 = t55 * t55;
  t142 = 0.1e1 / t141;
  t146 = sigma[2] * sigma[2];
  t147 = t141 * t56;
  t148 = 0.1e1 / t147;
  t151 = 0.1e1 / t63 / t60;
  t154 = -0.66141331013852962455e-2 * sigma[2] * t142 * t64 + 0.41287072352122365488e-4 * t146 * t148 * t151;
  t155 = t27 * t154;
  t159 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t68 - t118 - 0.2e1 / 0.3e1 * t54 * t155);
  tvrho1 = t44 + t71 + t4 * (t132 + t159);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t164 = t88 * t28;
  t165 = 0.1e1 / t164;
  t166 = sigma[0] * t165;
  t169 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t166 * t98;
  t170 = t27 * t169;
  t173 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t170);
  tvsigma0 = t4 * t173;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t176 = t141 * t55;
  t177 = 0.1e1 / t176;
  t178 = sigma[2] * t177;
  t181 = 0.22047110337950987485e-2 * t57 * t64 - 0.13762357450707455163e-4 * t178 * t151;
  t182 = t27 * t181;
  t185 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t182);
  tvsigma2 = t4 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t188 = 0.1e1 / t21;
  t189 = t76 * t76;
  t192 = t72 * t4;
  t193 = 0.1e1 / t192;
  t194 = t14 * t193;
  t197 = my_piecewise5(t8, 0, t12, 0, -0.2e1 * t73 + 0.2e1 * t194);
  t201 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t189 + 0.3e1 / 0.2e1 * t21 * t197);
  t202 = t3 * t201;
  t205 = t80 * t85;
  t211 = t25 / t26 / t4;
  t212 = t211 * t40;
  t214 = t24 * t212 / 0.6e1;
  t215 = t84 * t101;
  t216 = t24 * t215;
  t218 = t88 * rho[0];
  t219 = 0.1e1 / t218;
  t223 = t88 * t88;
  t224 = 0.1e1 / t223;
  t228 = t93 * sigma[0];
  t230 = 0.1e1 / t223 / t29;
  t232 = t33 * t33;
  t234 = 0.1e1 / t36 / t232;
  t237 = 0.26456532405541184982e-1 * sigma[0] * t219 * t37 - 0.41287072352122365489e-3 * t93 * t224 * t98 + 0.18040695917302508518e-5 * t228 * t230 * t234;
  t238 = t27 * t237;
  t242 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t41 - 0.2e1 / 0.3e1 * t205 - 0.4e1 / 0.3e1 * t80 * t102 + t214 - 0.2e1 / 0.3e1 * t216 - 0.2e1 / 0.3e1 * t24 * t238);
  t243 = 0.1e1 / t51;
  t244 = t109 * t109;
  t247 = t46 * t193;
  t250 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t73 + 0.2e1 * t247);
  t254 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t244 + 0.3e1 / 0.2e1 * t51 * t250);
  t255 = t3 * t254;
  t258 = t113 * t116;
  t260 = t211 * t67;
  t262 = t54 * t260 / 0.6e1;
  t264 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t68 - 0.2e1 / 0.3e1 * t258 + t262);
  tv2rho20 = 0.2e1 * t106 + 0.2e1 * t120 + t4 * (t242 + t264);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t267 = t188 * t124;
  t271 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t194);
  t275 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t267 * t76 + 0.3e1 / 0.2e1 * t21 * t271);
  t276 = t3 * t275;
  t279 = t128 * t85;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t41 - t279 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t102 - t205 / 0.3e1 + t214 - t216 / 0.3e1);
  t287 = t243 * t134;
  t291 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t247);
  t295 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t287 * t109 + 0.3e1 / 0.2e1 * t51 * t291);
  t296 = t3 * t295;
  t299 = t138 * t116;
  t304 = t84 * t154;
  t305 = t54 * t304;
  t308 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t68 - t299 / 0.3e1 - t258 / 0.3e1 + t262 - 0.2e1 / 0.3e1 * t113 * t155 - t305 / 0.3e1);
  tv2rho21 = t106 + t120 + t132 + t159 + t4 * (t286 + t308);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t313 = t124 * t124;
  t318 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t73 + 0.2e1 * t194);
  t322 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t313 + 0.3e1 / 0.2e1 * t21 * t318);
  t323 = t3 * t322;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t41 - 0.2e1 / 0.3e1 * t279 + t214);
  t329 = t134 * t134;
  t334 = my_piecewise5(t12, 0, t8, 0, -0.2e1 * t73 + 0.2e1 * t247);
  t338 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t329 + 0.3e1 / 0.2e1 * t51 * t334);
  t339 = t3 * t338;
  t346 = t141 * rho[1];
  t347 = 0.1e1 / t346;
  t351 = t141 * t141;
  t352 = 0.1e1 / t351;
  t356 = t146 * sigma[2];
  t358 = 0.1e1 / t351 / t56;
  t360 = t60 * t60;
  t362 = 0.1e1 / t63 / t360;
  t365 = 0.26456532405541184982e-1 * sigma[2] * t347 * t64 - 0.41287072352122365489e-3 * t146 * t352 * t151 + 0.18040695917302508518e-5 * t356 * t358 * t362;
  t366 = t27 * t365;
  t370 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t68 - 0.2e1 / 0.3e1 * t299 - 0.4e1 / 0.3e1 * t138 * t155 + t262 - 0.2e1 / 0.3e1 * t305 - 0.2e1 / 0.3e1 * t54 * t366);
  tv2rho22 = 0.2e1 * t132 + 0.2e1 * t159 + t4 * (t328 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t375 = t84 * t169;
  t377 = t24 * t375 / 0.3e1;
  t380 = t95 * t98;
  t384 = 0.1e1 / t223 / t28;
  t385 = t93 * t384;
  t388 = -0.66141331013852962455e-2 * t89 * t37 + 0.12386121705636709647e-3 * t380 * sigma[0] - 0.60135653057675028394e-6 * t385 * t234;
  t389 = t27 * t388;
  t393 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t170 - t377 - 0.2e1 / 0.3e1 * t24 * t389);
  tv2rhosigma0 = t4 * t393 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t397 = t84 * t181;
  t399 = t54 * t397 / 0.3e1;
  t401 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t182 - t399);
  tv2rhosigma2 = t4 * t401 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t406 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t170 - t377);
  tv2rhosigma3 = t4 * t406 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t412 = t148 * t151;
  t416 = 0.1e1 / t351 / t55;
  t417 = t146 * t416;
  t420 = -0.66141331013852962455e-2 * t142 * t64 + 0.12386121705636709647e-3 * t412 * sigma[2] - 0.60135653057675028394e-6 * t417 * t362;
  t421 = t27 * t420;
  t425 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t182 - t399 - 0.2e1 / 0.3e1 * t54 * t421);
  tv2rhosigma5 = t4 * t425 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t430 = 0.1e1 / t223 / rho[0];
  t434 = -0.27524714901414910326e-4 * t165 * t98 + 0.20045217685891676131e-6 * sigma[0] * t430 * t234;
  t435 = t27 * t434;
  t438 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t435);
  tv2sigma20 = t4 * t438;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t442 = 0.1e1 / t351 / rho[1];
  t446 = -0.27524714901414910326e-4 * t177 * t151 + 0.20045217685891676131e-6 * sigma[2] * t442 * t362;
  t447 = t27 * t446;
  t450 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t447);
  tv2sigma25 = t4 * t450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t453 = 0.1e1 / t22;
  t454 = t189 * t76;
  t457 = t188 * t76;
  t460 = t72 * t72;
  t461 = 0.1e1 / t460;
  t462 = t14 * t461;
  t465 = my_piecewise5(t8, 0, t12, 0, 0.6e1 * t193 - 0.6e1 * t462);
  t469 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t453 * t454 + 0.9e1 / 0.4e1 * t457 * t197 + 0.3e1 / 0.2e1 * t21 * t465);
  t470 = t3 * t469;
  t473 = t202 * t85;
  t476 = t80 * t212;
  t478 = t80 * t215;
  t484 = t25 / t26 / t72;
  t485 = t484 * t40;
  t487 = t24 * t485 / 0.4e1;
  t488 = t211 * t101;
  t489 = t24 * t488;
  t491 = t84 * t237;
  t492 = t24 * t491;
  t499 = 0.1e1 / t223 / t88;
  t503 = t93 * t93;
  t505 = 0.1e1 / t223 / t94;
  t509 = 0.1e1 / t36 / t232 / t33;
  t512 = -0.13228266202770592491e0 * t166 * t37 + 0.3798410656395257625e-2 * t93 * t430 * t98 - 0.37885461426335267888e-4 * t228 * t499 * t234 + 0.12387598749875974218e-6 * t503 * t505 * t509;
  t513 = t27 * t512;
  t517 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t470 * t41 - t473 - 0.2e1 * t202 * t102 + t476 / 0.2e1 - 0.2e1 * t478 - 0.2e1 * t80 * t238 - t487 + t489 / 0.2e1 - t492 - 0.2e1 / 0.3e1 * t24 * t513);
  t518 = 0.1e1 / t52;
  t519 = t244 * t109;
  t522 = t243 * t109;
  t525 = t46 * t461;
  t528 = my_piecewise5(t12, 0, t8, 0, -0.6e1 * t193 - 0.6e1 * t525);
  t532 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t518 * t519 + 0.9e1 / 0.4e1 * t522 * t250 + 0.3e1 / 0.2e1 * t51 * t528);
  t533 = t3 * t532;
  t536 = t255 * t116;
  t537 = t113 * t260;
  t539 = t484 * t67;
  t541 = t54 * t539 / 0.4e1;
  t543 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t533 * t68 - t536 + t537 / 0.2e1 - t541);
  tv3rho30 = 0.3e1 * t242 + 0.3e1 * t264 + t4 * (t517 + t543);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t546 = 0.2e1 * t286;
  t547 = 0.2e1 * t308;
  t548 = t453 * t124;
  t551 = t188 * t271;
  t556 = 0.2e1 * t193;
  t557 = 0.6e1 * t462;
  t559 = my_piecewise5(t8, 0, t12, 0, t556 - t557);
  t563 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t548 * t189 + 0.3e1 / 0.2e1 * t551 * t76 + 0.3e1 / 0.4e1 * t267 * t197 + 0.3e1 / 0.2e1 * t21 * t559);
  t564 = t3 * t563;
  t568 = 0.2e1 / 0.3e1 * t276 * t85;
  t571 = t128 * t212;
  t574 = 0.2e1 / 0.3e1 * t128 * t215;
  t582 = -0.2e1 / 0.3e1 * t564 * t41 - t568 - 0.4e1 / 0.3e1 * t276 * t102 + t571 / 0.6e1 - t574 - 0.2e1 / 0.3e1 * t128 * t238 - t473 / 0.3e1 + t476 / 0.3e1 - 0.2e1 / 0.3e1 * t478 - t487 + t489 / 0.3e1 - t492 / 0.3e1;
  t583 = my_piecewise3(t1, 0, t582);
  t584 = t518 * t134;
  t587 = t243 * t291;
  t592 = 0.6e1 * t525;
  t594 = my_piecewise5(t12, 0, t8, 0, -t556 - t592);
  t598 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t584 * t244 + 0.3e1 / 0.2e1 * t587 * t109 + 0.3e1 / 0.4e1 * t287 * t250 + 0.3e1 / 0.2e1 * t51 * t594);
  t599 = t3 * t598;
  t603 = 0.2e1 / 0.3e1 * t296 * t116;
  t604 = t138 * t260;
  t611 = 0.2e1 / 0.3e1 * t113 * t304;
  t612 = t211 * t154;
  t613 = t54 * t612;
  t616 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t599 * t68 - t603 + t604 / 0.6e1 - t536 / 0.3e1 + t537 / 0.3e1 - t541 - 0.2e1 / 0.3e1 * t255 * t155 - t611 + t613 / 0.6e1);
  tv3rho31 = t242 + t264 + t546 + t547 + t4 * (t583 + t616);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t619 = t453 * t313;
  t624 = t188 * t318;
  t628 = my_piecewise5(t8, 0, t12, 0, -t556 - t557);
  t632 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t619 * t76 + 0.3e1 / 0.2e1 * t267 * t271 + 0.3e1 / 0.4e1 * t624 * t76 + 0.3e1 / 0.2e1 * t21 * t628);
  t633 = t3 * t632;
  t636 = t323 * t85;
  t644 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t633 * t41 - t636 / 0.3e1 - 0.2e1 / 0.3e1 * t323 * t102 - t568 + t571 / 0.3e1 - t574 + t476 / 0.6e1 - t487 + t489 / 0.6e1);
  t645 = t518 * t329;
  t650 = t243 * t334;
  t654 = my_piecewise5(t12, 0, t8, 0, t556 - t592);
  t658 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t645 * t109 + 0.3e1 / 0.2e1 * t287 * t291 + 0.3e1 / 0.4e1 * t650 * t109 + 0.3e1 / 0.2e1 * t51 * t654);
  t659 = t3 * t658;
  t662 = t339 * t116;
  t667 = t138 * t304;
  t673 = t84 * t365;
  t674 = t54 * t673;
  t676 = -0.2e1 / 0.3e1 * t659 * t68 - t662 / 0.3e1 - t603 + t604 / 0.3e1 - 0.4e1 / 0.3e1 * t296 * t155 - 0.2e1 / 0.3e1 * t667 + t537 / 0.6e1 - t541 - t611 + t613 / 0.3e1 - 0.2e1 / 0.3e1 * t113 * t366 - t674 / 0.3e1;
  t677 = my_piecewise3(t45, 0, t676);
  tv3rho32 = t546 + t547 + t328 + t370 + t4 * (t644 + t677);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t682 = t313 * t124;
  t689 = my_piecewise5(t8, 0, t12, 0, -0.6e1 * t193 - 0.6e1 * t462);
  t693 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t453 * t682 + 0.9e1 / 0.4e1 * t267 * t318 + 0.3e1 / 0.2e1 * t21 * t689);
  t694 = t3 * t693;
  t699 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t694 * t41 - t636 + t571 / 0.2e1 - t487);
  t700 = t329 * t134;
  t707 = my_piecewise5(t12, 0, t8, 0, 0.6e1 * t193 - 0.6e1 * t525);
  t711 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t518 * t700 + 0.9e1 / 0.4e1 * t287 * t334 + 0.3e1 / 0.2e1 * t51 * t707);
  t712 = t3 * t711;
  t728 = 0.1e1 / t351 / t141;
  t732 = t146 * t146;
  t734 = 0.1e1 / t351 / t147;
  t738 = 0.1e1 / t63 / t360 / t60;
  t741 = -0.13228266202770592491e0 * t178 * t64 + 0.3798410656395257625e-2 * t146 * t442 * t151 - 0.37885461426335267888e-4 * t356 * t728 * t362 + 0.12387598749875974218e-6 * t732 * t734 * t738;
  t742 = t27 * t741;
  t746 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t712 * t68 - t662 - 0.2e1 * t339 * t155 + t604 / 0.2e1 - 0.2e1 * t667 - 0.2e1 * t138 * t366 - t541 + t613 / 0.2e1 - t674 - 0.2e1 / 0.3e1 * t54 * t742);
  tv3rho33 = 0.3e1 * t328 + 0.3e1 * t370 + t4 * (t699 + t746);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t752 = t80 * t375;
  t756 = t211 * t169;
  t758 = t24 * t756 / 0.6e1;
  t759 = t84 * t388;
  t760 = t24 * t759;
  t764 = t224 * t98;
  t767 = t230 * t234;
  t771 = 0.1e1 / t223 / t164;
  t775 = 0.26456532405541184982e-1 * t219 * t37 - 0.99088973645093677176e-3 * t764 * sigma[0] + 0.11425774080958255395e-4 * t767 * t93 - 0.41291995832919914059e-7 * t228 * t771 * t509;
  t776 = t27 * t775;
  t780 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t170 - 0.2e1 / 0.3e1 * t752 - 0.4e1 / 0.3e1 * t80 * t389 + t758 - 0.2e1 / 0.3e1 * t760 - 0.2e1 / 0.3e1 * t24 * t776);
  tv3rho2sigma0 = t4 * t780 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t785 = t113 * t397;
  t787 = t211 * t181;
  t789 = t54 * t787 / 0.6e1;
  t791 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t182 - 0.2e1 / 0.3e1 * t785 + t789);
  tv3rho2sigma2 = t4 * t791 + 0.2e1 * t401;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t795 = t128 * t375;
  t802 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t170 - t795 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t389 - t752 / 0.3e1 + t758 - t760 / 0.3e1);
  tv3rho2sigma3 = t4 * t802 + t393 + t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t806 = t138 * t397;
  t811 = t84 * t420;
  t812 = t54 * t811;
  t815 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t182 - t806 / 0.3e1 - t785 / 0.3e1 + t789 - 0.2e1 / 0.3e1 * t113 * t421 - t812 / 0.3e1);
  tv3rho2sigma5 = t4 * t815 + t401 + t425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t822 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t170 - 0.2e1 / 0.3e1 * t795 + t758);
  tv3rho2sigma6 = t4 * t822 + 0.2e1 * t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t833 = t352 * t151;
  t836 = t358 * t362;
  t840 = 0.1e1 / t351 / t176;
  t844 = 0.26456532405541184982e-1 * t347 * t64 - 0.99088973645093677176e-3 * t833 * sigma[2] + 0.11425774080958255395e-4 * t836 * t146 - 0.41291995832919914059e-7 * t356 * t840 * t738;
  t845 = t27 * t844;
  t849 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t182 - 0.2e1 / 0.3e1 * t806 - 0.4e1 / 0.3e1 * t138 * t421 + t789 - 0.2e1 / 0.3e1 * t812 - 0.2e1 / 0.3e1 * t54 * t845);
  tv3rho2sigma8 = t4 * t849 + 0.2e1 * t425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t853 = t84 * t434;
  t855 = t24 * t853 / 0.3e1;
  t857 = t384 * t234;
  t861 = 0.1e1 / t223 / t218;
  t865 = 0.16514828940848946196e-3 * t380 - 0.30067826528837514197e-5 * t857 * sigma[0] + 0.13763998610973304686e-7 * t93 * t861 * t509;
  t866 = t27 * t865;
  t870 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t435 - t855 - 0.2e1 / 0.3e1 * t24 * t866);
  tv3rhosigma20 = t4 * t870 + t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t874 = t84 * t446;
  t876 = t54 * t874 / 0.3e1;
  t878 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t447 - t876);
  tv3rhosigma25 = t4 * t878 + t450;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t883 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t435 - t855);
  tv3rhosigma26 = t4 * t883 + t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t888 = t416 * t362;
  t892 = 0.1e1 / t351 / t346;
  t896 = 0.16514828940848946196e-3 * t412 - 0.30067826528837514197e-5 * t888 * sigma[2] + 0.13763998610973304686e-7 * t146 * t892 * t738;
  t897 = t27 * t896;
  t901 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t447 - t876 - 0.2e1 / 0.3e1 * t54 * t897);
  tv3rhosigma211 = t4 * t901 + t450;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t908 = 0.60135653057675028394e-6 * t430 * t234 - 0.45879995369911015621e-8 * sigma[0] * t499 * t509;
  t909 = t27 * t908;
  t912 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t909);
  tv3sigma30 = t4 * t912;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t918 = 0.60135653057675028394e-6 * t442 * t362 - 0.45879995369911015621e-8 * sigma[2] * t728 * t738;
  t919 = t27 * t918;
  t922 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t919);
  tv3sigma39 = t4 * t922;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t30, t31, t33, t34, t35, t36, t37, t40;
  double t41, t44, t45, t46, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t60;
  double t61, t62, t63, t64, t67, t68, t71, tzk0;

  double t72, t73, t74, t76, t79, t80, t84, t85;
  double t87, t88, t89, t93, t94, t95, t98, t101;
  double t102, t106, t107, t109, t112, t113, t116, t118;
  double t120, tvrho0, t124, t127, t128, t132, t134, t137;
  double t138, t141, t142, t146, t147, t148, t151, t154;
  double t155, t159, tvrho1, t164, t165, t166, t169, t170;
  double t173, tvsigma0, tvsigma1, t176, t177, t178, t181, t182;
  double t185, tvsigma2;

  double t188, t189, t192, t193, t194, t197, t201, t202;
  double t205, t211, t212, t214, t215, t216, t218, t219;
  double t223, t224, t228, t230, t232, t234, t237, t238;
  double t242, t243, t244, t247, t250, t254, t255, t258;
  double t260, t262, t264, tv2rho20, t267, t271, t275, t276;
  double t279, t286, t287, t291, t295, t296, t299, t304;
  double t305, t308, tv2rho21, t313, t318, t322, t323, t328;
  double t329, t334, t338, t339, t346, t347, t351, t352;
  double t356, t358, t360, t362, t365, t366, t370, tv2rho22;
  double t375, t377, t380, t384, t385, t388, t389, t393;
  double tv2rhosigma0, tv2rhosigma1, t397, t399, t401, tv2rhosigma2, t406, tv2rhosigma3;
  double tv2rhosigma4, t412, t416, t417, t420, t421, t425, tv2rhosigma5;
  double t430, t434, t435, t438, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t442, t446, t447, t450, tv2sigma25;

  double t453, t454, t457, t460, t461, t462, t465, t469;
  double t470, t473, t476, t478, t484, t485, t487, t488;
  double t489, t491, t492, t499, t503, t505, t509, t512;
  double t513, t517, t518, t519, t522, t525, t528, t532;
  double t533, t536, t537, t539, t541, t543, tv3rho30, t546;
  double t547, t548, t551, t556, t557, t559, t563, t564;
  double t568, t571, t574, t582, t583, t584, t587, t592;
  double t594, t598, t599, t603, t604, t611, t612, t613;
  double t616, tv3rho31, t619, t624, t628, t632, t633, t636;
  double t644, t645, t650, t654, t658, t659, t662, t667;
  double t673, t674, t676, t677, tv3rho32, t682, t689, t693;
  double t694, t699, t700, t707, t711, t712, t728, t732;
  double t734, t738, t741, t742, t746, tv3rho33, t752, t756;
  double t758, t759, t760, t764, t767, t771, t775, t776;
  double t780, tv3rho2sigma0, tv3rho2sigma1, t785, t787, t789, t791, tv3rho2sigma2;
  double t795, t802, tv3rho2sigma3, tv3rho2sigma4, t806, t811, t812, t815;
  double tv3rho2sigma5, t822, tv3rho2sigma6, tv3rho2sigma7, t833, t836, t840, t844;
  double t845, t849, tv3rho2sigma8, t853, t855, t857, t861, t865;
  double t866, t870, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t874;
  double t876, t878, tv3rhosigma25, t883, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t888, t892, t896, t897, t901, tv3rhosigma211, t908;
  double t909, t912, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, t918, t919, t922, tv3sigma39;

  double t927, t930, t931, t933, t934, t936, t946, t947;
  double t955, t957, t964, t966, t967, t973, t979, t980;
  double t983, t987, t993, t997, t999, t1004, t1006, t1007;
  double t1008, t1009, t1011, t1012, t1018, t1023, t1026, t1030;
  double t1034, t1036, t1037, t1040, t1042, tv4rho40, t1047, t1048;
  double t1049, t1050, t1071, t1072, t1074, t1078, t1084, t1088;
  double t1089, t1090, t1096, t1097, t1114, t1116, t1120, t1124;
  double t1125, t1126, t1127, t1134, t1135, t1136, t1138, t1140;
  double t1141, tv4rho41, t1156, t1169, t1173, t1179, t1183, t1185;
  double t1198, t1199, t1208, t1221, t1225, t1229, t1231, t1238;
  double t1240, t1249, t1252, t1254, t1255, tv4rho42, t1276, t1280;
  double t1284, t1292, t1293, t1310, t1314, t1318, t1323, t1328;
  double t1335, t1337, t1338, tv4rho43, t1343, t1348, t1355, t1359;
  double t1365, t1379, t1380, t1388, t1390, t1397, t1402, t1409;
  double t1413, t1423, t1424, tv4rho44, t1430, t1433, t1435, t1441;
  double t1443, t1446, t1468, tv4rho3sigma0, tv4rho3sigma1, t1473, t1474, t1478;
  double t1480, tv4rho3sigma2, t1482, t1486, t1489, t1492, t1500, t1501;
  double tv4rho3sigma3, tv4rho3sigma4, t1503, t1507, t1508, t1515, t1517, t1520;
  double tv4rho3sigma5, t1524, t1532, tv4rho3sigma6, tv4rho3sigma7, t1536, t1541, t1548;
  double t1550, t1551, tv4rho3sigma8, t1558, tv4rho3sigma9, tv4rho3sigma10, t1591, tv4rho3sigma11;
  double t1596, t1602, t1604, t1622, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t1627, t1631, t1633, tv4rho2sigma25, t1637, t1644, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t1648, t1654, t1657, tv4rho2sigma211;
  double t1664, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t1689, tv4rho2sigma217;
  double t1695, t1708, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t1714, t1716, tv4rhosigma39, t1721, tv4rhosigma310;
  double tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318;
  double t1737, tv4rhosigma319, t1748, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t1758, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t16 = my_piecewise5(t8, t9, t12, t13, t14 * t5);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = -t14;
  t48 = my_piecewise5(t12, t9, t8, t13, t46 * t5);
  t49 = 0.1e1 + t48;
  t50 = t49 <= p->zeta_threshold;
  t51 = sqrt(t49);
  t52 = t51 * t49;
  t53 = my_piecewise3(t50, t20, t52);
  t54 = t3 * t53;
  t55 = rho[1] * rho[1];
  t56 = t55 * rho[1];
  t57 = 0.1e1 / t56;
  t58 = sigma[2] * t57;
  t60 = 0.1e1 + 0.8323e-2 * t58;
  t61 = POW_1_4(t60);
  t62 = t61 * t61;
  t63 = t62 * t61;
  t64 = 0.1e1 / t63;
  t67 = 0.1e1 + 0.22047110337950987485e-2 * t58 * t64;
  t68 = t27 * t67;
  t71 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t68);
  tzk0 = t44 + t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t72 = t4 * t4;
  t73 = 0.1e1 / t72;
  t74 = t14 * t73;
  t76 = my_piecewise5(t8, 0, t12, 0, t5 - t74);
  t79 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t76);
  t80 = t3 * t79;
  t84 = t25 / t26;
  t85 = t84 * t40;
  t87 = t24 * t85 / 0.3e1;
  t88 = t28 * t28;
  t89 = 0.1e1 / t88;
  t93 = sigma[0] * sigma[0];
  t94 = t88 * t29;
  t95 = 0.1e1 / t94;
  t98 = 0.1e1 / t36 / t33;
  t101 = -0.66141331013852962455e-2 * sigma[0] * t89 * t37 + 0.41287072352122365488e-4 * t93 * t95 * t98;
  t102 = t27 * t101;
  t106 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t41 - t87 - 0.2e1 / 0.3e1 * t24 * t102);
  t107 = t46 * t73;
  t109 = my_piecewise5(t12, 0, t8, 0, -t5 - t107);
  t112 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t109);
  t113 = t3 * t112;
  t116 = t84 * t67;
  t118 = t54 * t116 / 0.3e1;
  t120 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t68 - t118);
  tvrho0 = t44 + t71 + t4 * (t106 + t120);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t124 = my_piecewise5(t8, 0, t12, 0, -t5 - t74);
  t127 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t124);
  t128 = t3 * t127;
  t132 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t41 - t87);
  t134 = my_piecewise5(t12, 0, t8, 0, t5 - t107);
  t137 = my_piecewise3(t50, 0, 0.3e1 / 0.2e1 * t51 * t134);
  t138 = t3 * t137;
  t141 = t55 * t55;
  t142 = 0.1e1 / t141;
  t146 = sigma[2] * sigma[2];
  t147 = t141 * t56;
  t148 = 0.1e1 / t147;
  t151 = 0.1e1 / t63 / t60;
  t154 = -0.66141331013852962455e-2 * sigma[2] * t142 * t64 + 0.41287072352122365488e-4 * t146 * t148 * t151;
  t155 = t27 * t154;
  t159 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t68 - t118 - 0.2e1 / 0.3e1 * t54 * t155);
  tvrho1 = t44 + t71 + t4 * (t132 + t159);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t164 = t88 * t28;
  t165 = 0.1e1 / t164;
  t166 = sigma[0] * t165;
  t169 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t166 * t98;
  t170 = t27 * t169;
  t173 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t170);
  tvsigma0 = t4 * t173;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t176 = t141 * t55;
  t177 = 0.1e1 / t176;
  t178 = sigma[2] * t177;
  t181 = 0.22047110337950987485e-2 * t57 * t64 - 0.13762357450707455163e-4 * t178 * t151;
  t182 = t27 * t181;
  t185 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t182);
  tvsigma2 = t4 * t185;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t188 = 0.1e1 / t21;
  t189 = t76 * t76;
  t192 = t72 * t4;
  t193 = 0.1e1 / t192;
  t194 = t14 * t193;
  t197 = my_piecewise5(t8, 0, t12, 0, -0.2e1 * t73 + 0.2e1 * t194);
  t201 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t189 + 0.3e1 / 0.2e1 * t21 * t197);
  t202 = t3 * t201;
  t205 = t80 * t85;
  t211 = t25 / t26 / t4;
  t212 = t211 * t40;
  t214 = t24 * t212 / 0.6e1;
  t215 = t84 * t101;
  t216 = t24 * t215;
  t218 = t88 * rho[0];
  t219 = 0.1e1 / t218;
  t223 = t88 * t88;
  t224 = 0.1e1 / t223;
  t228 = t93 * sigma[0];
  t230 = 0.1e1 / t223 / t29;
  t232 = t33 * t33;
  t234 = 0.1e1 / t36 / t232;
  t237 = 0.26456532405541184982e-1 * sigma[0] * t219 * t37 - 0.41287072352122365489e-3 * t93 * t224 * t98 + 0.18040695917302508518e-5 * t228 * t230 * t234;
  t238 = t27 * t237;
  t242 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t41 - 0.2e1 / 0.3e1 * t205 - 0.4e1 / 0.3e1 * t80 * t102 + t214 - 0.2e1 / 0.3e1 * t216 - 0.2e1 / 0.3e1 * t24 * t238);
  t243 = 0.1e1 / t51;
  t244 = t109 * t109;
  t247 = t46 * t193;
  t250 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t73 + 0.2e1 * t247);
  t254 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t244 + 0.3e1 / 0.2e1 * t51 * t250);
  t255 = t3 * t254;
  t258 = t113 * t116;
  t260 = t211 * t67;
  t262 = t54 * t260 / 0.6e1;
  t264 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t68 - 0.2e1 / 0.3e1 * t258 + t262);
  tv2rho20 = 0.2e1 * t106 + 0.2e1 * t120 + t4 * (t242 + t264);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t267 = t188 * t124;
  t271 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t194);
  t275 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t267 * t76 + 0.3e1 / 0.2e1 * t21 * t271);
  t276 = t3 * t275;
  t279 = t128 * t85;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t41 - t279 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t102 - t205 / 0.3e1 + t214 - t216 / 0.3e1);
  t287 = t243 * t134;
  t291 = my_piecewise5(t12, 0, t8, 0, 0.2e1 * t247);
  t295 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t287 * t109 + 0.3e1 / 0.2e1 * t51 * t291);
  t296 = t3 * t295;
  t299 = t138 * t116;
  t304 = t84 * t154;
  t305 = t54 * t304;
  t308 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t68 - t299 / 0.3e1 - t258 / 0.3e1 + t262 - 0.2e1 / 0.3e1 * t113 * t155 - t305 / 0.3e1);
  tv2rho21 = t106 + t120 + t132 + t159 + t4 * (t286 + t308);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t313 = t124 * t124;
  t318 = my_piecewise5(t8, 0, t12, 0, 0.2e1 * t73 + 0.2e1 * t194);
  t322 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t188 * t313 + 0.3e1 / 0.2e1 * t21 * t318);
  t323 = t3 * t322;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t41 - 0.2e1 / 0.3e1 * t279 + t214);
  t329 = t134 * t134;
  t334 = my_piecewise5(t12, 0, t8, 0, -0.2e1 * t73 + 0.2e1 * t247);
  t338 = my_piecewise3(t50, 0, 0.3e1 / 0.4e1 * t243 * t329 + 0.3e1 / 0.2e1 * t51 * t334);
  t339 = t3 * t338;
  t346 = t141 * rho[1];
  t347 = 0.1e1 / t346;
  t351 = t141 * t141;
  t352 = 0.1e1 / t351;
  t356 = t146 * sigma[2];
  t358 = 0.1e1 / t351 / t56;
  t360 = t60 * t60;
  t362 = 0.1e1 / t63 / t360;
  t365 = 0.26456532405541184982e-1 * sigma[2] * t347 * t64 - 0.41287072352122365489e-3 * t146 * t352 * t151 + 0.18040695917302508518e-5 * t356 * t358 * t362;
  t366 = t27 * t365;
  t370 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t68 - 0.2e1 / 0.3e1 * t299 - 0.4e1 / 0.3e1 * t138 * t155 + t262 - 0.2e1 / 0.3e1 * t305 - 0.2e1 / 0.3e1 * t54 * t366);
  tv2rho22 = 0.2e1 * t132 + 0.2e1 * t159 + t4 * (t328 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t375 = t84 * t169;
  t377 = t24 * t375 / 0.3e1;
  t380 = t95 * t98;
  t384 = 0.1e1 / t223 / t28;
  t385 = t93 * t384;
  t388 = -0.66141331013852962455e-2 * t89 * t37 + 0.12386121705636709647e-3 * t380 * sigma[0] - 0.60135653057675028394e-6 * t385 * t234;
  t389 = t27 * t388;
  t393 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t170 - t377 - 0.2e1 / 0.3e1 * t24 * t389);
  tv2rhosigma0 = t4 * t393 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t397 = t84 * t181;
  t399 = t54 * t397 / 0.3e1;
  t401 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t182 - t399);
  tv2rhosigma2 = t4 * t401 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t406 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t170 - t377);
  tv2rhosigma3 = t4 * t406 + t173;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t412 = t148 * t151;
  t416 = 0.1e1 / t351 / t55;
  t417 = t146 * t416;
  t420 = -0.66141331013852962455e-2 * t142 * t64 + 0.12386121705636709647e-3 * t412 * sigma[2] - 0.60135653057675028394e-6 * t417 * t362;
  t421 = t27 * t420;
  t425 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t182 - t399 - 0.2e1 / 0.3e1 * t54 * t421);
  tv2rhosigma5 = t4 * t425 + t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t430 = 0.1e1 / t223 / rho[0];
  t434 = -0.27524714901414910326e-4 * t165 * t98 + 0.20045217685891676131e-6 * sigma[0] * t430 * t234;
  t435 = t27 * t434;
  t438 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t435);
  tv2sigma20 = t4 * t438;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t442 = 0.1e1 / t351 / rho[1];
  t446 = -0.27524714901414910326e-4 * t177 * t151 + 0.20045217685891676131e-6 * sigma[2] * t442 * t362;
  t447 = t27 * t446;
  t450 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t447);
  tv2sigma25 = t4 * t450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t453 = 0.1e1 / t22;
  t454 = t189 * t76;
  t457 = t188 * t76;
  t460 = t72 * t72;
  t461 = 0.1e1 / t460;
  t462 = t14 * t461;
  t465 = my_piecewise5(t8, 0, t12, 0, 0.6e1 * t193 - 0.6e1 * t462);
  t469 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t453 * t454 + 0.9e1 / 0.4e1 * t457 * t197 + 0.3e1 / 0.2e1 * t21 * t465);
  t470 = t3 * t469;
  t473 = t202 * t85;
  t476 = t80 * t212;
  t478 = t80 * t215;
  t484 = t25 / t26 / t72;
  t485 = t484 * t40;
  t487 = t24 * t485 / 0.4e1;
  t488 = t211 * t101;
  t489 = t24 * t488;
  t491 = t84 * t237;
  t492 = t24 * t491;
  t499 = 0.1e1 / t223 / t88;
  t503 = t93 * t93;
  t505 = 0.1e1 / t223 / t94;
  t509 = 0.1e1 / t36 / t232 / t33;
  t512 = -0.13228266202770592491e0 * t166 * t37 + 0.3798410656395257625e-2 * t93 * t430 * t98 - 0.37885461426335267888e-4 * t228 * t499 * t234 + 0.12387598749875974218e-6 * t503 * t505 * t509;
  t513 = t27 * t512;
  t517 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t470 * t41 - t473 - 0.2e1 * t202 * t102 + t476 / 0.2e1 - 0.2e1 * t478 - 0.2e1 * t80 * t238 - t487 + t489 / 0.2e1 - t492 - 0.2e1 / 0.3e1 * t24 * t513);
  t518 = 0.1e1 / t52;
  t519 = t244 * t109;
  t522 = t243 * t109;
  t525 = t46 * t461;
  t528 = my_piecewise5(t12, 0, t8, 0, -0.6e1 * t193 - 0.6e1 * t525);
  t532 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t518 * t519 + 0.9e1 / 0.4e1 * t522 * t250 + 0.3e1 / 0.2e1 * t51 * t528);
  t533 = t3 * t532;
  t536 = t255 * t116;
  t537 = t113 * t260;
  t539 = t484 * t67;
  t541 = t54 * t539 / 0.4e1;
  t543 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t533 * t68 - t536 + t537 / 0.2e1 - t541);
  tv3rho30 = 0.3e1 * t242 + 0.3e1 * t264 + t4 * (t517 + t543);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t546 = 0.2e1 * t286;
  t547 = 0.2e1 * t308;
  t548 = t453 * t124;
  t551 = t188 * t271;
  t556 = 0.2e1 * t193;
  t557 = 0.6e1 * t462;
  t559 = my_piecewise5(t8, 0, t12, 0, t556 - t557);
  t563 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t548 * t189 + 0.3e1 / 0.2e1 * t551 * t76 + 0.3e1 / 0.4e1 * t267 * t197 + 0.3e1 / 0.2e1 * t21 * t559);
  t564 = t3 * t563;
  t568 = 0.2e1 / 0.3e1 * t276 * t85;
  t571 = t128 * t212;
  t574 = 0.2e1 / 0.3e1 * t128 * t215;
  t582 = -0.2e1 / 0.3e1 * t564 * t41 - t568 - 0.4e1 / 0.3e1 * t276 * t102 + t571 / 0.6e1 - t574 - 0.2e1 / 0.3e1 * t128 * t238 - t473 / 0.3e1 + t476 / 0.3e1 - 0.2e1 / 0.3e1 * t478 - t487 + t489 / 0.3e1 - t492 / 0.3e1;
  t583 = my_piecewise3(t1, 0, t582);
  t584 = t518 * t134;
  t587 = t243 * t291;
  t592 = 0.6e1 * t525;
  t594 = my_piecewise5(t12, 0, t8, 0, -t556 - t592);
  t598 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t584 * t244 + 0.3e1 / 0.2e1 * t587 * t109 + 0.3e1 / 0.4e1 * t287 * t250 + 0.3e1 / 0.2e1 * t51 * t594);
  t599 = t3 * t598;
  t603 = 0.2e1 / 0.3e1 * t296 * t116;
  t604 = t138 * t260;
  t611 = 0.2e1 / 0.3e1 * t113 * t304;
  t612 = t211 * t154;
  t613 = t54 * t612;
  t616 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t599 * t68 - t603 + t604 / 0.6e1 - t536 / 0.3e1 + t537 / 0.3e1 - t541 - 0.2e1 / 0.3e1 * t255 * t155 - t611 + t613 / 0.6e1);
  tv3rho31 = t242 + t264 + t546 + t547 + t4 * (t583 + t616);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t619 = t453 * t313;
  t624 = t188 * t318;
  t628 = my_piecewise5(t8, 0, t12, 0, -t556 - t557);
  t632 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t619 * t76 + 0.3e1 / 0.2e1 * t267 * t271 + 0.3e1 / 0.4e1 * t624 * t76 + 0.3e1 / 0.2e1 * t21 * t628);
  t633 = t3 * t632;
  t636 = t323 * t85;
  t644 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t633 * t41 - t636 / 0.3e1 - 0.2e1 / 0.3e1 * t323 * t102 - t568 + t571 / 0.3e1 - t574 + t476 / 0.6e1 - t487 + t489 / 0.6e1);
  t645 = t518 * t329;
  t650 = t243 * t334;
  t654 = my_piecewise5(t12, 0, t8, 0, t556 - t592);
  t658 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t645 * t109 + 0.3e1 / 0.2e1 * t287 * t291 + 0.3e1 / 0.4e1 * t650 * t109 + 0.3e1 / 0.2e1 * t51 * t654);
  t659 = t3 * t658;
  t662 = t339 * t116;
  t667 = t138 * t304;
  t673 = t84 * t365;
  t674 = t54 * t673;
  t676 = -0.2e1 / 0.3e1 * t659 * t68 - t662 / 0.3e1 - t603 + t604 / 0.3e1 - 0.4e1 / 0.3e1 * t296 * t155 - 0.2e1 / 0.3e1 * t667 + t537 / 0.6e1 - t541 - t611 + t613 / 0.3e1 - 0.2e1 / 0.3e1 * t113 * t366 - t674 / 0.3e1;
  t677 = my_piecewise3(t45, 0, t676);
  tv3rho32 = t546 + t547 + t328 + t370 + t4 * (t644 + t677);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t682 = t313 * t124;
  t689 = my_piecewise5(t8, 0, t12, 0, -0.6e1 * t193 - 0.6e1 * t462);
  t693 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t453 * t682 + 0.9e1 / 0.4e1 * t267 * t318 + 0.3e1 / 0.2e1 * t21 * t689);
  t694 = t3 * t693;
  t699 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t694 * t41 - t636 + t571 / 0.2e1 - t487);
  t700 = t329 * t134;
  t707 = my_piecewise5(t12, 0, t8, 0, 0.6e1 * t193 - 0.6e1 * t525);
  t711 = my_piecewise3(t50, 0, -0.3e1 / 0.8e1 * t518 * t700 + 0.9e1 / 0.4e1 * t287 * t334 + 0.3e1 / 0.2e1 * t51 * t707);
  t712 = t3 * t711;
  t728 = 0.1e1 / t351 / t141;
  t732 = t146 * t146;
  t734 = 0.1e1 / t351 / t147;
  t738 = 0.1e1 / t63 / t360 / t60;
  t741 = -0.13228266202770592491e0 * t178 * t64 + 0.3798410656395257625e-2 * t146 * t442 * t151 - 0.37885461426335267888e-4 * t356 * t728 * t362 + 0.12387598749875974218e-6 * t732 * t734 * t738;
  t742 = t27 * t741;
  t746 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t712 * t68 - t662 - 0.2e1 * t339 * t155 + t604 / 0.2e1 - 0.2e1 * t667 - 0.2e1 * t138 * t366 - t541 + t613 / 0.2e1 - t674 - 0.2e1 / 0.3e1 * t54 * t742);
  tv3rho33 = 0.3e1 * t328 + 0.3e1 * t370 + t4 * (t699 + t746);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t752 = t80 * t375;
  t756 = t211 * t169;
  t758 = t24 * t756 / 0.6e1;
  t759 = t84 * t388;
  t760 = t24 * t759;
  t764 = t224 * t98;
  t767 = t230 * t234;
  t771 = 0.1e1 / t223 / t164;
  t775 = 0.26456532405541184982e-1 * t219 * t37 - 0.99088973645093677176e-3 * t764 * sigma[0] + 0.11425774080958255395e-4 * t767 * t93 - 0.41291995832919914059e-7 * t228 * t771 * t509;
  t776 = t27 * t775;
  t780 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t170 - 0.2e1 / 0.3e1 * t752 - 0.4e1 / 0.3e1 * t80 * t389 + t758 - 0.2e1 / 0.3e1 * t760 - 0.2e1 / 0.3e1 * t24 * t776);
  tv3rho2sigma0 = t4 * t780 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t785 = t113 * t397;
  t787 = t211 * t181;
  t789 = t54 * t787 / 0.6e1;
  t791 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t182 - 0.2e1 / 0.3e1 * t785 + t789);
  tv3rho2sigma2 = t4 * t791 + 0.2e1 * t401;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t795 = t128 * t375;
  t802 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t170 - t795 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t389 - t752 / 0.3e1 + t758 - t760 / 0.3e1);
  tv3rho2sigma3 = t4 * t802 + t393 + t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t806 = t138 * t397;
  t811 = t84 * t420;
  t812 = t54 * t811;
  t815 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t182 - t806 / 0.3e1 - t785 / 0.3e1 + t789 - 0.2e1 / 0.3e1 * t113 * t421 - t812 / 0.3e1);
  tv3rho2sigma5 = t4 * t815 + t401 + t425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t822 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t170 - 0.2e1 / 0.3e1 * t795 + t758);
  tv3rho2sigma6 = t4 * t822 + 0.2e1 * t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t833 = t352 * t151;
  t836 = t358 * t362;
  t840 = 0.1e1 / t351 / t176;
  t844 = 0.26456532405541184982e-1 * t347 * t64 - 0.99088973645093677176e-3 * t833 * sigma[2] + 0.11425774080958255395e-4 * t836 * t146 - 0.41291995832919914059e-7 * t356 * t840 * t738;
  t845 = t27 * t844;
  t849 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t182 - 0.2e1 / 0.3e1 * t806 - 0.4e1 / 0.3e1 * t138 * t421 + t789 - 0.2e1 / 0.3e1 * t812 - 0.2e1 / 0.3e1 * t54 * t845);
  tv3rho2sigma8 = t4 * t849 + 0.2e1 * t425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t853 = t84 * t434;
  t855 = t24 * t853 / 0.3e1;
  t857 = t384 * t234;
  t861 = 0.1e1 / t223 / t218;
  t865 = 0.16514828940848946196e-3 * t380 - 0.30067826528837514197e-5 * t857 * sigma[0] + 0.13763998610973304686e-7 * t93 * t861 * t509;
  t866 = t27 * t865;
  t870 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t435 - t855 - 0.2e1 / 0.3e1 * t24 * t866);
  tv3rhosigma20 = t4 * t870 + t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t874 = t84 * t446;
  t876 = t54 * t874 / 0.3e1;
  t878 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t447 - t876);
  tv3rhosigma25 = t4 * t878 + t450;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t883 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t435 - t855);
  tv3rhosigma26 = t4 * t883 + t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t888 = t416 * t362;
  t892 = 0.1e1 / t351 / t346;
  t896 = 0.16514828940848946196e-3 * t412 - 0.30067826528837514197e-5 * t888 * sigma[2] + 0.13763998610973304686e-7 * t146 * t892 * t738;
  t897 = t27 * t896;
  t901 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t447 - t876 - 0.2e1 / 0.3e1 * t54 * t897);
  tv3rhosigma211 = t4 * t901 + t450;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t908 = 0.60135653057675028394e-6 * t430 * t234 - 0.45879995369911015621e-8 * sigma[0] * t499 * t509;
  t909 = t27 * t908;
  t912 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t909);
  tv3sigma30 = t4 * t912;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t918 = 0.60135653057675028394e-6 * t442 * t362 - 0.45879995369911015621e-8 * sigma[2] * t728 * t738;
  t919 = t27 * t918;
  t922 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t919);
  tv3sigma39 = t4 * t922;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t927 = t25 / t26 / t192;
  t930 = 0.5e1 / 0.8e1 * t24 * t927 * t40;
  t931 = t470 * t85;
  t933 = t202 * t212;
  t934 = t80 * t485;
  t936 = t24 * t84 * t512;
  t946 = t223 * t223;
  t947 = 0.1e1 / t946;
  t955 = t232 * t232;
  t957 = 0.1e1 / t36 / t955;
  t964 = t17 * t17;
  t966 = 0.1e1 / t21 / t964;
  t967 = t189 * t189;
  t973 = t197 * t197;
  t979 = 0.1e1 / t460 / t4;
  t980 = t14 * t979;
  t983 = my_piecewise5(t8, 0, t12, 0, -0.24e2 * t461 + 0.24e2 * t980);
  t987 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t966 * t967 - 0.9e1 / 0.4e1 * t453 * t189 * t197 + 0.9e1 / 0.4e1 * t188 * t973 + 0.3e1 * t457 * t465 + 0.3e1 / 0.2e1 * t21 * t983);
  t993 = t202 * t215;
  t997 = t80 * t488;
  t999 = t80 * t491;
  t1004 = t24 * t484 * t101;
  t1006 = t24 * t211 * t237;
  t1007 = t930 - 0.4e1 / 0.3e1 * t931 + t933 - t934 - 0.4e1 / 0.3e1 * t936 - 0.2e1 / 0.3e1 * t24 * t27 * (0.79369597216623554946e0 * sigma[0] * t95 * t37 - 0.36662920248684660554e-1 * t385 * t98 + 0.62059993955520629303e-3 * t228 * t861 * t234 - 0.44595355499553507184e-5 * t503 * t947 * t509 + 0.11598973244461995009e-7 * t503 * sigma[0] / t946 / t29 * t957) - 0.2e1 / 0.3e1 * t3 * t987 * t41 - 0.8e1 / 0.3e1 * t470 * t102 - 0.4e1 * t993 - 0.4e1 * t202 * t238 + 0.2e1 * t997 - 0.4e1 * t999 - 0.8e1 / 0.3e1 * t80 * t513 - t1004 + t1006;
  t1008 = my_piecewise3(t1, 0, t1007);
  t1009 = t49 * t49;
  t1011 = 0.1e1 / t51 / t1009;
  t1012 = t244 * t244;
  t1018 = t250 * t250;
  t1023 = t46 * t979;
  t1026 = my_piecewise5(t12, 0, t8, 0, 0.24e2 * t461 + 0.24e2 * t1023);
  t1030 = my_piecewise3(t50, 0, 0.9e1 / 0.16e2 * t1011 * t1012 - 0.9e1 / 0.4e1 * t518 * t244 * t250 + 0.9e1 / 0.4e1 * t243 * t1018 + 0.3e1 * t522 * t528 + 0.3e1 / 0.2e1 * t51 * t1026);
  t1034 = t533 * t116;
  t1036 = t255 * t260;
  t1037 = t113 * t539;
  t1040 = 0.5e1 / 0.8e1 * t54 * t927 * t67;
  t1042 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t3 * t1030 * t68 - 0.4e1 / 0.3e1 * t1034 + t1036 - t1037 + t1040);
  tv4rho40 = 0.4e1 * t517 + 0.4e1 * t543 + t4 * (t1008 + t1042);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1047 = t564 * t85;
  t1048 = t276 * t212;
  t1049 = t1048 / 0.2e1;
  t1050 = t128 * t485;
  t1071 = 0.12e2 * t461;
  t1072 = 0.24e2 * t980;
  t1074 = my_piecewise5(t8, 0, t12, 0, -t1071 + t1072);
  t1078 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t966 * t124 * t454 - 0.9e1 / 0.8e1 * t453 * t271 * t189 - 0.9e1 / 0.8e1 * t548 * t76 * t197 + 0.9e1 / 0.4e1 * t188 * t559 * t76 + 0.9e1 / 0.4e1 * t551 * t197 + 0.3e1 / 0.4e1 * t267 * t465 + 0.3e1 / 0.2e1 * t21 * t1074);
  t1084 = t276 * t215;
  t1088 = t128 * t488;
  t1089 = t1088 / 0.2e1;
  t1090 = t128 * t491;
  t1096 = -t1047 + t1049 - t1050 / 0.4e1 + t930 - t931 / 0.3e1 + t933 / 0.2e1 - 0.3e1 / 0.4e1 * t934 - 0.2e1 / 0.3e1 * t3 * t1078 * t41 - 0.2e1 * t564 * t102 - 0.2e1 * t1084 - 0.2e1 * t276 * t238 + t1089 - t1090 - 0.2e1 / 0.3e1 * t128 * t513 - t936 / 0.3e1 - t993 + t997 - t999 - 0.3e1 / 0.4e1 * t1004 + t1006 / 0.2e1;
  t1097 = my_piecewise3(t1, 0, t1096);
  t1114 = 0.24e2 * t1023;
  t1116 = my_piecewise5(t12, 0, t8, 0, t1071 + t1114);
  t1120 = my_piecewise3(t50, 0, 0.9e1 / 0.16e2 * t1011 * t134 * t519 - 0.9e1 / 0.8e1 * t518 * t291 * t244 - 0.9e1 / 0.8e1 * t584 * t109 * t250 + 0.9e1 / 0.4e1 * t243 * t594 * t109 + 0.9e1 / 0.4e1 * t587 * t250 + 0.3e1 / 0.4e1 * t287 * t528 + 0.3e1 / 0.2e1 * t51 * t1116);
  t1124 = t599 * t116;
  t1125 = t296 * t260;
  t1126 = t1125 / 0.2e1;
  t1127 = t138 * t539;
  t1134 = t255 * t304;
  t1135 = t113 * t612;
  t1136 = t1135 / 0.2e1;
  t1138 = t54 * t484 * t154;
  t1140 = -0.2e1 / 0.3e1 * t3 * t1120 * t68 - t1124 + t1126 - t1127 / 0.4e1 - t1034 / 0.3e1 + t1036 / 0.2e1 - 0.3e1 / 0.4e1 * t1037 + t1040 - 0.2e1 / 0.3e1 * t533 * t155 - t1134 + t1136 - t1138 / 0.4e1;
  t1141 = my_piecewise3(t45, 0, t1140);
  tv4rho41 = t517 + t543 + 0.3e1 * t583 + 0.3e1 * t616 + t4 * (t1097 + t1141);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1156 = t271 * t271;
  t1169 = my_piecewise5(t8, 0, t12, 0, t1072);
  t1173 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t966 * t313 * t189 - 0.3e1 / 0.2e1 * t548 * t76 * t271 - 0.3e1 / 0.8e1 * t619 * t197 + 0.3e1 / 0.2e1 * t188 * t1156 + 0.3e1 / 0.2e1 * t267 * t559 - 0.3e1 / 0.8e1 * t453 * t318 * t189 + 0.3e1 / 0.2e1 * t188 * t628 * t76 + 0.3e1 / 0.4e1 * t624 * t197 + 0.3e1 / 0.2e1 * t21 * t1169);
  t1179 = t323 * t215;
  t1183 = t633 * t85;
  t1185 = t323 * t212;
  t1198 = -0.2e1 / 0.3e1 * t3 * t1173 * t41 - 0.4e1 / 0.3e1 * t633 * t102 - 0.2e1 / 0.3e1 * t1179 - 0.2e1 / 0.3e1 * t323 * t238 - 0.2e1 / 0.3e1 * t1183 + t1185 / 0.6e1 - 0.2e1 / 0.3e1 * t1047 + 0.2e1 / 0.3e1 * t1048 - t1050 / 0.2e1 + t930 + t933 / 0.6e1 - t934 / 0.2e1 - 0.4e1 / 0.3e1 * t1084 + 0.2e1 / 0.3e1 * t1088 - 0.2e1 / 0.3e1 * t1090 + t997 / 0.3e1 - t1004 / 0.2e1 + t1006 / 0.6e1;
  t1199 = my_piecewise3(t1, 0, t1198);
  t1208 = t291 * t291;
  t1221 = my_piecewise5(t12, 0, t8, 0, t1114);
  t1225 = my_piecewise3(t50, 0, 0.9e1 / 0.16e2 * t1011 * t329 * t244 - 0.3e1 / 0.2e1 * t584 * t109 * t291 - 0.3e1 / 0.8e1 * t645 * t250 + 0.3e1 / 0.2e1 * t243 * t1208 + 0.3e1 / 0.2e1 * t287 * t594 - 0.3e1 / 0.8e1 * t518 * t334 * t244 + 0.3e1 / 0.2e1 * t243 * t654 * t109 + 0.3e1 / 0.4e1 * t650 * t250 + 0.3e1 / 0.2e1 * t51 * t1221);
  t1229 = t659 * t116;
  t1231 = t339 * t260;
  t1238 = t296 * t304;
  t1240 = t138 * t612;
  t1249 = t113 * t673;
  t1252 = t54 * t211 * t365;
  t1254 = -0.2e1 / 0.3e1 * t3 * t1225 * t68 - 0.2e1 / 0.3e1 * t1229 + t1231 / 0.6e1 - 0.2e1 / 0.3e1 * t1124 + 0.2e1 / 0.3e1 * t1125 - t1127 / 0.2e1 - 0.4e1 / 0.3e1 * t599 * t155 - 0.4e1 / 0.3e1 * t1238 + t1240 / 0.3e1 + t1036 / 0.6e1 - t1037 / 0.2e1 + t1040 - 0.2e1 / 0.3e1 * t1134 + 0.2e1 / 0.3e1 * t1135 - t1138 / 0.2e1 - 0.2e1 / 0.3e1 * t255 * t366 - 0.2e1 / 0.3e1 * t1249 + t1252 / 0.6e1;
  t1255 = my_piecewise3(t45, 0, t1254);
  tv4rho42 = 0.2e1 * t583 + 0.2e1 * t616 + 0.2e1 * t644 + 0.2e1 * t677 + t4 * (t1199 + t1255);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1276 = my_piecewise5(t8, 0, t12, 0, t1071 + t1072);
  t1280 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t966 * t682 * t76 - 0.9e1 / 0.8e1 * t619 * t271 - 0.9e1 / 0.8e1 * t548 * t318 * t76 + 0.9e1 / 0.4e1 * t551 * t318 + 0.9e1 / 0.4e1 * t267 * t628 + 0.3e1 / 0.4e1 * t188 * t689 * t76 + 0.3e1 / 0.2e1 * t21 * t1276);
  t1284 = t694 * t85;
  t1292 = -0.2e1 / 0.3e1 * t3 * t1280 * t41 - t1284 / 0.3e1 - 0.2e1 / 0.3e1 * t694 * t102 - t1183 + t1185 / 0.2e1 - t1179 + t1049 - 0.3e1 / 0.4e1 * t1050 + t1089 - t934 / 0.4e1 + t930 - t1004 / 0.4e1;
  t1293 = my_piecewise3(t1, 0, t1292);
  t1310 = my_piecewise5(t12, 0, t8, 0, -t1071 + t1114);
  t1314 = my_piecewise3(t50, 0, 0.9e1 / 0.16e2 * t1011 * t700 * t109 - 0.9e1 / 0.8e1 * t645 * t291 - 0.9e1 / 0.8e1 * t584 * t334 * t109 + 0.9e1 / 0.4e1 * t587 * t334 + 0.9e1 / 0.4e1 * t287 * t654 + 0.3e1 / 0.4e1 * t243 * t707 * t109 + 0.3e1 / 0.2e1 * t51 * t1310);
  t1318 = t712 * t116;
  t1323 = t339 * t304;
  t1328 = t138 * t673;
  t1335 = t54 * t84 * t741;
  t1337 = -0.2e1 / 0.3e1 * t3 * t1314 * t68 - t1318 / 0.3e1 - t1229 + t1231 / 0.2e1 - 0.2e1 * t659 * t155 - t1323 + t1126 - 0.3e1 / 0.4e1 * t1127 - 0.2e1 * t1238 + t1240 - 0.2e1 * t296 * t366 - t1328 - t1037 / 0.4e1 + t1040 + t1136 - 0.3e1 / 0.4e1 * t1138 - t1249 + t1252 / 0.2e1 - 0.2e1 / 0.3e1 * t113 * t742 - t1335 / 0.3e1;
  t1338 = my_piecewise3(t45, 0, t1337);
  tv4rho43 = 0.3e1 * t644 + 0.3e1 * t677 + t699 + t746 + t4 * (t1293 + t1338);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1343 = t313 * t313;
  t1348 = t318 * t318;
  t1355 = my_piecewise5(t8, 0, t12, 0, 0.24e2 * t461 + 0.24e2 * t980);
  t1359 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t966 * t1343 - 0.9e1 / 0.4e1 * t619 * t318 + 0.9e1 / 0.4e1 * t188 * t1348 + 0.3e1 * t267 * t689 + 0.3e1 / 0.2e1 * t21 * t1355);
  t1365 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t3 * t1359 * t41 - 0.4e1 / 0.3e1 * t1284 + t1185 - t1050 + t930);
  t1379 = t351 * t351;
  t1380 = 0.1e1 / t1379;
  t1388 = t360 * t360;
  t1390 = 0.1e1 / t63 / t1388;
  t1397 = t329 * t329;
  t1402 = t334 * t334;
  t1409 = my_piecewise5(t12, 0, t8, 0, -0.24e2 * t461 + 0.24e2 * t1023);
  t1413 = my_piecewise3(t50, 0, 0.9e1 / 0.16e2 * t1011 * t1397 - 0.9e1 / 0.4e1 * t645 * t334 + 0.9e1 / 0.4e1 * t243 * t1402 + 0.3e1 * t287 * t707 + 0.3e1 / 0.2e1 * t51 * t1409);
  t1423 = -0.4e1 / 0.3e1 * t1335 - 0.4e1 / 0.3e1 * t1318 - 0.4e1 * t1323 - 0.4e1 * t1328 + 0.2e1 * t1240 + t1252 + t1231 - 0.2e1 / 0.3e1 * t54 * t27 * (0.79369597216623554946e0 * sigma[2] * t148 * t64 - 0.36662920248684660554e-1 * t417 * t151 + 0.62059993955520629303e-3 * t356 * t892 * t362 - 0.44595355499553507184e-5 * t732 * t1380 * t738 + 0.11598973244461995009e-7 * t732 * sigma[2] / t1379 / t56 * t1390) - 0.2e1 / 0.3e1 * t3 * t1413 * t68 - 0.8e1 / 0.3e1 * t712 * t155 - 0.4e1 * t339 * t366 - 0.8e1 / 0.3e1 * t138 * t742 - t1138 - t1127 + t1040;
  t1424 = my_piecewise3(t45, 0, t1423);
  tv4rho44 = 0.4e1 * t699 + 0.4e1 * t746 + t4 * (t1365 + t1424);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1430 = t202 * t375;
  t1433 = t80 * t756;
  t1435 = t80 * t759;
  t1441 = t24 * t484 * t169 / 0.4e1;
  t1443 = t24 * t211 * t388;
  t1446 = t24 * t84 * t775;
  t1468 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t470 * t170 - t1430 - 0.2e1 * t202 * t389 + t1433 / 0.2e1 - 0.2e1 * t1435 - 0.2e1 * t80 * t776 - t1441 + t1443 / 0.2e1 - t1446 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.13228266202770592491e0 * t165 * t37 + 0.842256275983296256e-2 * t430 * t98 * sigma[0] - 0.16898118509206682978e-3 * t499 * t234 * t93 + 0.1362635862486357164e-5 * t505 * t509 * t228 - 0.3866324414820665003e-8 * t503 / t946 / t28 * t957));
  tv4rho3sigma0 = t4 * t1468 + 0.3e1 * t780;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1473 = t255 * t397;
  t1474 = t113 * t787;
  t1478 = t54 * t484 * t181 / 0.4e1;
  t1480 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t533 * t182 - t1473 + t1474 / 0.2e1 - t1478);
  tv4rho3sigma2 = t4 * t1480 + 0.3e1 * t791;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1482 = 0.2e1 * t802;
  t1486 = 0.2e1 / 0.3e1 * t276 * t375;
  t1489 = t128 * t756;
  t1492 = 0.2e1 / 0.3e1 * t128 * t759;
  t1500 = -0.2e1 / 0.3e1 * t564 * t170 - t1486 - 0.4e1 / 0.3e1 * t276 * t389 + t1489 / 0.6e1 - t1492 - 0.2e1 / 0.3e1 * t128 * t776 - t1430 / 0.3e1 + t1433 / 0.3e1 - 0.2e1 / 0.3e1 * t1435 - t1441 + t1443 / 0.3e1 - t1446 / 0.3e1;
  t1501 = my_piecewise3(t1, 0, t1500);
  tv4rho3sigma3 = t4 * t1501 + t1482 + t780;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1503 = 0.2e1 * t815;
  t1507 = 0.2e1 / 0.3e1 * t296 * t397;
  t1508 = t138 * t787;
  t1515 = 0.2e1 / 0.3e1 * t113 * t811;
  t1517 = t54 * t211 * t420;
  t1520 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t599 * t182 - t1507 + t1508 / 0.6e1 - t1473 / 0.3e1 + t1474 / 0.3e1 - t1478 - 0.2e1 / 0.3e1 * t255 * t421 - t1515 + t1517 / 0.6e1);
  tv4rho3sigma5 = t4 * t1520 + t1503 + t791;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1524 = t323 * t375;
  t1532 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t633 * t170 - t1524 / 0.3e1 - 0.2e1 / 0.3e1 * t323 * t389 - t1486 + t1489 / 0.3e1 - t1492 + t1433 / 0.6e1 - t1441 + t1443 / 0.6e1);
  tv4rho3sigma6 = t4 * t1532 + t1482 + t822;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1536 = t339 * t397;
  t1541 = t138 * t811;
  t1548 = t54 * t84 * t844;
  t1550 = -0.2e1 / 0.3e1 * t659 * t182 - t1536 / 0.3e1 - t1507 + t1508 / 0.3e1 - 0.4e1 / 0.3e1 * t296 * t421 - 0.2e1 / 0.3e1 * t1541 + t1474 / 0.6e1 - t1478 - t1515 + t1517 / 0.3e1 - 0.2e1 / 0.3e1 * t113 * t845 - t1548 / 0.3e1;
  t1551 = my_piecewise3(t45, 0, t1550);
  tv4rho3sigma8 = t4 * t1551 + t1503 + t849;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1558 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t694 * t170 - t1524 + t1489 / 0.2e1 - t1441);
  tv4rho3sigma9 = t4 * t1558 + 0.3e1 * t822;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1591 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t712 * t182 - t1536 - 0.2e1 * t339 * t421 + t1508 / 0.2e1 - 0.2e1 * t1541 - 0.2e1 * t138 * t845 - t1478 + t1517 / 0.2e1 - t1548 - 0.2e1 / 0.3e1 * t54 * t27 * (-0.13228266202770592491e0 * t177 * t64 + 0.842256275983296256e-2 * t442 * t151 * sigma[2] - 0.16898118509206682978e-3 * t728 * t362 * t146 + 0.1362635862486357164e-5 * t734 * t738 * t356 - 0.3866324414820665003e-8 * t732 / t1379 / t55 * t1390));
  tv4rho3sigma11 = t4 * t1591 + 0.3e1 * t849;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1596 = t80 * t853;
  t1602 = t24 * t211 * t434 / 0.6e1;
  t1604 = t24 * t84 * t865;
  t1622 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t202 * t435 - 0.2e1 / 0.3e1 * t1596 - 0.4e1 / 0.3e1 * t80 * t866 + t1602 - 0.2e1 / 0.3e1 * t1604 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.11560380258594262337e-2 * t764 + 0.37284104895758517604e-4 * t767 * sigma[0] - 0.38539196110725253122e-6 * t771 * t509 * t93 + 0.12887748049402216676e-8 * t228 / t946 / rho[0] * t957));
  tv4rho2sigma20 = t4 * t1622 + 0.2e1 * t870;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1627 = t113 * t874;
  t1631 = t54 * t211 * t446 / 0.6e1;
  t1633 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t255 * t447 - 0.2e1 / 0.3e1 * t1627 + t1631);
  tv4rho2sigma25 = t4 * t1633 + 0.2e1 * t878;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1637 = t128 * t853;
  t1644 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t276 * t435 - t1637 / 0.3e1 - 0.2e1 / 0.3e1 * t128 * t866 - t1596 / 0.3e1 + t1602 - t1604 / 0.3e1);
  tv4rho2sigma26 = t4 * t1644 + t870 + t883;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t1648 = t138 * t874;
  t1654 = t54 * t84 * t896;
  t1657 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t296 * t447 - t1648 / 0.3e1 - t1627 / 0.3e1 + t1631 - 0.2e1 / 0.3e1 * t113 * t897 - t1654 / 0.3e1);
  tv4rho2sigma211 = t4 * t1657 + t878 + t901;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t1664 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t323 * t435 - 0.2e1 / 0.3e1 * t1637 + t1602);
  tv4rho2sigma212 = t4 * t1664 + 0.2e1 * t883;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t1689 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t339 * t447 - 0.2e1 / 0.3e1 * t1648 - 0.4e1 / 0.3e1 * t138 * t897 + t1631 - 0.2e1 / 0.3e1 * t1654 - 0.2e1 / 0.3e1 * t54 * t27 * (-0.11560380258594262337e-2 * t833 + 0.37284104895758517604e-4 * t836 * sigma[2] - 0.38539196110725253122e-6 * t840 * t738 * t146 + 0.12887748049402216676e-8 * t356 / t1379 / rho[1] * t1390));
  tv4rho2sigma217 = t4 * t1689 + 0.2e1 * t901;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t1695 = t24 * t84 * t908 / 0.3e1;
  t1708 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t80 * t909 - t1695 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.54122087751907525555e-5 * t857 + 0.96347990276813132804e-7 * t861 * t509 * sigma[0] - 0.42959160164674055589e-9 * t93 * t947 * t957));
  tv4rhosigma30 = t4 * t1708 + t912;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t1714 = t54 * t84 * t918 / 0.3e1;
  t1716 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t113 * t919 - t1714);
  tv4rhosigma39 = t4 * t1716 + t922;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t1721 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t128 * t909 - t1695);
  tv4rhosigma310 = t4 * t1721 + t912;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t1737 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t138 * t919 - t1714 - 0.2e1 / 0.3e1 * t54 * t27 * (-0.54122087751907525555e-5 * t888 + 0.96347990276813132804e-7 * t892 * t738 * sigma[2] - 0.42959160164674055589e-9 * t146 * t1380 * t1390));
  tv4rhosigma319 = t4 * t1737 + t922;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t1748 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t27 * (-0.18351998147964406248e-7 * t499 * t509 + 0.14319720054891351863e-9 * sigma[0] * t505 * t957));
  tv4sigma40 = t4 * t1748;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t1758 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t54 * t27 * (-0.18351998147964406248e-7 * t728 * t738 + 0.14319720054891351863e-9 * sigma[2] * t734 * t1390));
  tv4sigma414 = t4 * t1758;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

