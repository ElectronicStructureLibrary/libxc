/* 
  This file was generated automatically with ../scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Maple source      : ../maple/mgga_x_ms.mpl
  Type of functional: work_mgga_x
*/

static void 
XC(mgga_x_ms_enhance)(const XC(func_type) *pt, XC(mgga_work_x_t) *r)
{
  double t1, t2, t3, t4, t5, t9, t11, t12;
  double t13, t14, t16, t17, t18, t21, t23, t26;
  double t28, t30, t31, t32, t33, t38, t40, t41;
  double t43, t44, t45, t47, t49, t50, t53, t54;
  double t55, t56, t60, t61, t64, t65, t67, t69;
  double t72, t76, t79, t81, t87, t88, t90, t92;
  double t94, t95, t96, t97, t98, t103, t118, t119;
  double t126, t130, t154, t157;

  mgga_x_ms_params *params;
 
  assert(pt->params != NULL);
  params = (mgga_x_ms_params * ) (pt->params);

  t1 = X2S * X2S;
  t2 = MU_GE * t1;
  t3 = r->x * r->x;
  t4 = t2 * t3;
  t5 = t4 + params->kappa;
  t9 = params->kappa * (0.10e1 - params->kappa / t5);
  t11 = r->t - 0.12500000000000000000e0 * t3;
  t12 = t11 * t11;
  t13 = K_FACTOR_C * K_FACTOR_C;
  t14 = 0.1e1 / t13;
  t16 = 0.10e1 - t12 * t14;
  t17 = t16 * t16;
  t18 = t17 * t16;
  t21 = 0.1e1 / t13 / K_FACTOR_C;
  t23 = t12 * t12;
  t26 = t13 * t13;
  t28 = 0.1e1 / t26 / t13;
  t30 = 0.10e1 + t12 * t11 * t21 + params->b * t23 * t12 * t28;
  t31 = 0.1e1 / t30;
  t32 = t18 * t31;
  t33 = t4 + params->c + params->kappa;
  t38 = params->kappa * (0.10e1 - params->kappa / t33) - t9;
  r->f = 0.10e1 + t9 + t32 * t38;

  if(r->order < 1) return;

  r->dfdrs = 0;
  t40 = params->kappa * params->kappa;
  t41 = t5 * t5;
  t43 = t40 / t41;
  t44 = t2 * r->x;
  t45 = t43 * t44;
  t47 = t17 * t31;
  t49 = t11 * t14;
  t50 = t49 * r->x;
  t53 = t30 * t30;
  t54 = 0.1e1 / t53;
  t55 = t18 * t54;
  t56 = t12 * t21;
  t60 = params->b * t23 * t11;
  t61 = t28 * r->x;
  t64 = -0.75000000000000000000e0 * t56 * r->x - 0.15000000000000000000e1 * t60 * t61;
  t65 = t38 * t64;
  t67 = t33 * t33;
  t69 = t40 / t67;
  t72 = 0.2e1 * t69 * t44 - 0.2e1 * t45;
  r->dfdx = 0.2e1 * t45 + 0.15000000000000000000e1 * t47 * t38 * t50 - t55 * t65 + t32 * t72;
  t76 = t47 * t38 * t11 * t14;
  t79 = t60 * t28;
  t81 = 0.3e1 * t56 + 0.6e1 * t79;
  r->dfdt = -t55 * t38 * t81 - 0.6e1 * t76;
  r->dfdu = 0;

  if(r->order < 2) return;

  r->d2fdrs2 = 0;
  t87 = MU_GE * MU_GE;
  t88 = t1 * t1;
  t90 = t87 * t88 * t3;
  t92 = 0.8e1 * t40 / t41 / t5 * t90;
  t94 = 0.2e1 * t43 * t2;
  t95 = t16 * t31;
  t96 = t95 * t38;
  t97 = 0.1e1 / t26;
  t98 = t12 * t97;
  t103 = t17 * t54 * t38;
  t118 = t18 / t53 / t30;
  t119 = t64 * t64;
  t126 = t11 * t21;
  t130 = params->b * t23;
  r->d2fdx2 = -t92 + t94 + 0.15000000000000000000e1 * t96 * t98 * t3 - 0.30000000000000000000e1 * t103 * t49 * r->x * t64 + 0.30000000000000000000e1 * t47 * t72 * t50 - 0.37500000000000000000e0 * t47 * t38 * t3 * t14 + 0.15000000000000000000e1 * t76 + 0.2e1 * t118 * t38 * t119 - 0.2e1 * t55 * t72 * t64 - t55 * t38 * (0.37500000000000000000e0 * t126 * t3 - 0.75000000000000000000e0 * t56 + 0.18750000000000000000e1 * t130 * t28 * t3 - 0.15000000000000000000e1 * t79) + t32 * (-0.8e1 * t40 / t67 / t33 * t90 + 0.2e1 * t69 * t2 + t92 - t94);
  t154 = t38 * t14;
  t157 = t81 * t81;
  r->d2fdt2 = 0.24e2 * t95 * t38 * t12 * t97 + 0.12e2 * t103 * t49 * t81 - 0.6e1 * t47 * t154 + 0.2e1 * t118 * t38 * t157 - t55 * t38 * (0.30e2 * t130 * t28 + 0.6e1 * t126);
  r->d2fdu2 = 0;
  r->d2fdrsx = 0;
  r->d2fdrst = 0;
  r->d2fdrsu = 0;
  r->d2fdxt = -0.60000000000000000000e1 * t96 * t98 * r->x - 0.15000000000000000000e1 * t103 * t49 * r->x * t81 + 0.15000000000000000000e1 * t47 * t154 * r->x + 0.6e1 * t103 * t64 * t11 * t14 + 0.2e1 * t118 * t65 * t81 - t55 * t38 * (-0.15000000000000000000e1 * t126 * r->x - 0.75000000000000000000e1 * t130 * t61) - 0.6e1 * t47 * t72 * t11 * t14 - t55 * t72 * t81;
  r->d2fdxu = 0;
  r->d2fdtu = 0;

  if(r->order < 3) return;


}

#define maple2c_order 3
#define maple2c_func  XC(mgga_x_ms_enhance)
