/*
  This file was generated automatically with ./scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/hgga_exc/hgga_x_jse_b88.mpl
  Type of functional: hgga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t34, t35, t37, t38, t39, t40, t41;
  double t42, t43, t44, t46, t47, t48, t50, t51;
  double t52, t55, t56, t60, t63, t64, t65, t67;
  double t68, t69, t72, t76, t77, t78, t79, t80;
  double t81, t83, t84, t85, t86, t87, t90, t91;
  double t92, t93, t95, t96, t97, t99, t100, t101;
  double t104, t105, t109, t112, t113, t114, t118, t122;
  double tzk0;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = 0.1e1 / rho[0];
  t30 = sigma[0] * t29;
  t31 = 0.1e1 / tau[0];
  t34 = 0.1e1 - t30 * t31 / 0.8e1;
  t35 = t3 * t3;
  t37 = POW_1_3(0.1e1 / M_PI);
  t38 = 0.1e1 / t37;
  t39 = t35 * t38;
  t40 = M_CBRT4;
  t41 = t39 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t48 = sqrt(sigma[0]);
  t50 = 0.1e1 / t43 / rho[0];
  t51 = t48 * t50;
  t52 = log(t51 + sqrt(t51 * t51 + 0.1e1));
  t55 = 0.1e1 + 0.252e-1 * t51 * t52;
  t56 = 0.1e1 / t55;
  t60 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t47 * t56;
  t63 = 0.1e1 / t43 / t42;
  t64 = sigma[0] * t63;
  t65 = t31 * exx[0];
  t67 = M_CBRT2;
  t68 = t40 * t67;
  t69 = t39 * t68;
  t72 = t34 * t60 - t64 * t65 * t69 / 0.18e2;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t72);
  t77 = rho[1] <= p->dens_threshold;
  t78 = my_piecewise5(t15, t12, t11, t16, -t18);
  t79 = 0.1e1 + t78;
  t80 = t79 <= p->zeta_threshold;
  t81 = POW_1_3(t79);
  t83 = my_piecewise3(t80, t23, t81 * t79);
  t84 = t83 * t27;
  t85 = 0.1e1 / rho[1];
  t86 = sigma[2] * t85;
  t87 = 0.1e1 / tau[1];
  t90 = 0.1e1 - t86 * t87 / 0.8e1;
  t91 = rho[1] * rho[1];
  t92 = POW_1_3(rho[1]);
  t93 = t92 * t92;
  t95 = 0.1e1 / t93 / t91;
  t96 = sigma[2] * t95;
  t97 = sqrt(sigma[2]);
  t99 = 0.1e1 / t92 / rho[1];
  t100 = t97 * t99;
  t101 = log(t100 + sqrt(t100 * t100 + 0.1e1));
  t104 = 0.1e1 + 0.252e-1 * t100 * t101;
  t105 = 0.1e1 / t104;
  t109 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t96 * t105;
  t112 = 0.1e1 / t92 / t91;
  t113 = sigma[2] * t112;
  t114 = t87 * exx[1];
  t118 = t90 * t109 - t113 * t114 * t69 / 0.18e2;
  t122 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t118);
  tzk0 = t76 + t122;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t34, t35, t37, t38, t39, t40, t41;
  double t42, t43, t44, t46, t47, t48, t50, t51;
  double t52, t55, t56, t60, t63, t64, t65, t67;
  double t68, t69, t72, t76, t77, t78, t79, t80;
  double t81, t83, t84, t85, t86, t87, t90, t91;
  double t92, t93, t95, t96, t97, t99, t100, t101;
  double t104, t105, t109, t112, t113, t114, t118, t122;
  double tzk0;

  double t123, t124, t125, t126, t127, t130, t131, t135;
  double t136, t137, t140, t141, t142, t143, t146, t148;
  double t149, t153, t154, t158, t159, t160, t163, t164;
  double t168, t171, t172, t176, t181, t183, t186, t187;
  double t191, t194, t196, tvrho0, t199, t200, t203, t204;
  double t209, t211, t214, t215, t219, t220, t221, t224;
  double t226, t227, t231, t232, t236, t237, t238, t241;
  double t242, t246, t249, t250, t254, t259, tvrho1, t262;
  double t269, t275, t276, t280, t282, t286, t290, tvsigma0;
  double tvsigma1, t291, t298, t304, t305, t309, t311, t315;
  double t319, tvsigma2, tvlapl0, tvlapl1, t320, t321, t322, t325;
  double t329, t333, tvtau0, t334, t335, t336, t339, t343;
  double t347, tvtau1, t348, t349, t350, t352, t353, t356;
  double tvexx0, t357, t358, t359, t360, t363, tvexx1;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = 0.1e1 / rho[0];
  t30 = sigma[0] * t29;
  t31 = 0.1e1 / tau[0];
  t34 = 0.1e1 - t30 * t31 / 0.8e1;
  t35 = t3 * t3;
  t37 = POW_1_3(0.1e1 / M_PI);
  t38 = 0.1e1 / t37;
  t39 = t35 * t38;
  t40 = M_CBRT4;
  t41 = t39 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t48 = sqrt(sigma[0]);
  t50 = 0.1e1 / t43 / rho[0];
  t51 = t48 * t50;
  t52 = log(t51 + sqrt(t51 * t51 + 0.1e1));
  t55 = 0.1e1 + 0.252e-1 * t51 * t52;
  t56 = 0.1e1 / t55;
  t60 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t47 * t56;
  t63 = 0.1e1 / t43 / t42;
  t64 = sigma[0] * t63;
  t65 = t31 * exx[0];
  t67 = M_CBRT2;
  t68 = t40 * t67;
  t69 = t39 * t68;
  t72 = t34 * t60 - t64 * t65 * t69 / 0.18e2;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t72);
  t77 = rho[1] <= p->dens_threshold;
  t78 = my_piecewise5(t15, t12, t11, t16, -t18);
  t79 = 0.1e1 + t78;
  t80 = t79 <= p->zeta_threshold;
  t81 = POW_1_3(t79);
  t83 = my_piecewise3(t80, t23, t81 * t79);
  t84 = t83 * t27;
  t85 = 0.1e1 / rho[1];
  t86 = sigma[2] * t85;
  t87 = 0.1e1 / tau[1];
  t90 = 0.1e1 - t86 * t87 / 0.8e1;
  t91 = rho[1] * rho[1];
  t92 = POW_1_3(rho[1]);
  t93 = t92 * t92;
  t95 = 0.1e1 / t93 / t91;
  t96 = sigma[2] * t95;
  t97 = sqrt(sigma[2]);
  t99 = 0.1e1 / t92 / rho[1];
  t100 = t97 * t99;
  t101 = log(t100 + sqrt(t100 * t100 + 0.1e1));
  t104 = 0.1e1 + 0.252e-1 * t100 * t101;
  t105 = 0.1e1 / t104;
  t109 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t96 * t105;
  t112 = 0.1e1 / t92 / t91;
  t113 = sigma[2] * t112;
  t114 = t87 * exx[1];
  t118 = t90 * t109 - t113 * t114 * t69 / 0.18e2;
  t122 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t118);
  tzk0 = t76 + t122;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t123 = t7 * t7;
  t124 = 0.1e1 / t123;
  t125 = t17 * t124;
  t126 = t8 - t125;
  t127 = my_piecewise5(t11, 0, t15, 0, t126);
  t130 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t127);
  t131 = t130 * t27;
  t135 = t27 * t27;
  t136 = 0.1e1 / t135;
  t137 = t26 * t136;
  t140 = t6 * t137 * t72 / 0.8e1;
  t141 = 0.1e1 / t42;
  t142 = sigma[0] * t141;
  t143 = t31 * t60;
  t146 = t42 * rho[0];
  t148 = 0.1e1 / t44 / t146;
  t149 = sigma[0] * t148;
  t153 = t55 * t55;
  t154 = 0.1e1 / t153;
  t158 = t47 + 0.1e1;
  t159 = sqrt(t158);
  t160 = 0.1e1 / t159;
  t163 = -0.336e-1 * t48 * t63 * t52 - 0.336e-1 * t149 * t160;
  t164 = t154 * t163;
  t168 = -0.24888888888888888889e-2 * t41 * t149 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t164;
  t171 = 0.1e1 / t43 / t146;
  t172 = sigma[0] * t171;
  t176 = t142 * t143 / 0.8e1 + t34 * t168 + 0.7e1 / 0.54e2 * t172 * t65 * t69;
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t72 - t140 - 0.3e1 / 0.8e1 * t6 * t28 * t176);
  t183 = my_piecewise5(t15, 0, t11, 0, -t126);
  t186 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t183);
  t187 = t186 * t27;
  t191 = t83 * t136;
  t194 = t6 * t191 * t118 / 0.8e1;
  t196 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t118 - t194);
  tvrho0 = t76 + t122 + t7 * (t181 + t196);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t199 = -t8 - t125;
  t200 = my_piecewise5(t11, 0, t15, 0, t199);
  t203 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t200);
  t204 = t203 * t27;
  t209 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t72 - t140);
  t211 = my_piecewise5(t15, 0, t11, 0, -t199);
  t214 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t211);
  t215 = t214 * t27;
  t219 = 0.1e1 / t91;
  t220 = sigma[2] * t219;
  t221 = t87 * t109;
  t224 = t91 * rho[1];
  t226 = 0.1e1 / t93 / t224;
  t227 = sigma[2] * t226;
  t231 = t104 * t104;
  t232 = 0.1e1 / t231;
  t236 = t96 + 0.1e1;
  t237 = sqrt(t236);
  t238 = 0.1e1 / t237;
  t241 = -0.336e-1 * t97 * t112 * t101 - 0.336e-1 * t227 * t238;
  t242 = t232 * t241;
  t246 = -0.24888888888888888889e-2 * t41 * t227 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t242;
  t249 = 0.1e1 / t92 / t224;
  t250 = sigma[2] * t249;
  t254 = t220 * t221 / 0.8e1 + t90 * t246 + 0.7e1 / 0.54e2 * t250 * t114 * t69;
  t259 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t118 - t194 - 0.3e1 / 0.8e1 * t6 * t84 * t254);
  tvrho1 = t76 + t122 + t7 * (t209 + t259);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t262 = t29 * t31;
  t269 = 0.1e1 / t48;
  t275 = 0.126e-1 * t269 * t50 * t52 + 0.126e-1 * t46 * t160;
  t276 = t154 * t275;
  t280 = 0.93333333333333333332e-3 * t39 * t40 * t46 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t276;
  t282 = t63 * t31;
  t286 = -t262 * t60 / 0.8e1 + t34 * t280 - t282 * exx[0] * t69 / 0.18e2;
  t290 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t286);
  tvsigma0 = t7 * t290;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t291 = t85 * t87;
  t298 = 0.1e1 / t97;
  t304 = 0.126e-1 * t298 * t99 * t101 + 0.126e-1 * t95 * t238;
  t305 = t232 * t304;
  t309 = 0.93333333333333333332e-3 * t39 * t40 * t95 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t305;
  t311 = t112 * t87;
  t315 = -t291 * t109 / 0.8e1 + t90 * t309 - t311 * exx[1] * t69 / 0.18e2;
  t319 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t315);
  tvsigma2 = t7 * t319;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  t320 = tau[0] * tau[0];
  t321 = 0.1e1 / t320;
  t322 = t321 * t60;
  t325 = t321 * exx[0];
  t329 = t30 * t322 / 0.8e1 + t64 * t325 * t69 / 0.18e2;
  t333 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t329);
  tvtau0 = t7 * t333;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t334 = tau[1] * tau[1];
  t335 = 0.1e1 / t334;
  t336 = t335 * t109;
  t339 = t335 * exx[1];
  t343 = t86 * t336 / 0.8e1 + t113 * t339 * t69 / 0.18e2;
  t347 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t343);
  tvtau1 = t7 * t347;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t348 = t5 * t26;
  t349 = t27 * sigma[0];
  t350 = t348 * t349;
  t352 = t38 * t40 * t67;
  t353 = t282 * t352;
  t356 = my_piecewise3(t2, 0, t350 * t353 / 0.16e2);
  tvexx0 = t7 * t356;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t357 = t5 * t83;
  t358 = t27 * sigma[2];
  t359 = t357 * t358;
  t360 = t311 * t352;
  t363 = my_piecewise3(t77, 0, t359 * t360 / 0.16e2);
  tvexx1 = t7 * t363;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 1] += tvexx1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t34, t35, t37, t38, t39, t40, t41;
  double t42, t43, t44, t46, t47, t48, t50, t51;
  double t52, t55, t56, t60, t63, t64, t65, t67;
  double t68, t69, t72, t76, t77, t78, t79, t80;
  double t81, t83, t84, t85, t86, t87, t90, t91;
  double t92, t93, t95, t96, t97, t99, t100, t101;
  double t104, t105, t109, t112, t113, t114, t118, t122;
  double tzk0;

  double t123, t124, t125, t126, t127, t130, t131, t135;
  double t136, t137, t140, t141, t142, t143, t146, t148;
  double t149, t153, t154, t158, t159, t160, t163, t164;
  double t168, t171, t172, t176, t181, t183, t186, t187;
  double t191, t194, t196, tvrho0, t199, t200, t203, t204;
  double t209, t211, t214, t215, t219, t220, t221, t224;
  double t226, t227, t231, t232, t236, t237, t238, t241;
  double t242, t246, t249, t250, t254, t259, tvrho1, t262;
  double t269, t275, t276, t280, t282, t286, t290, tvsigma0;
  double tvsigma1, t291, t298, t304, t305, t309, t311, t315;
  double t319, tvsigma2, tvlapl0, tvlapl1, t320, t321, t322, t325;
  double t329, t333, tvtau0, t334, t335, t336, t339, t343;
  double t347, tvtau1, t348, t349, t350, t352, t353, t356;
  double tvexx0, t357, t358, t359, t360, t363, tvexx1;

  double t366, t367, t368, t371, t372, t373, t375, t376;
  double t380, t381, t385, t387, t393, t394, t397, t399;
  double t401, t402, t405, t408, t410, t411, t419, t420;
  double t421, t430, t433, t436, t439, t440, t444, t447;
  double t448, t452, t457, t458, t459, t460, t464, t468;
  double t469, t473, t475, t477, t480, t482, tv2rho20, t485;
  double t488, t489, t493, t494, t498, t500, t508, t509;
  double t512, t516, t517, t521, t523, t530, t533, tv2rho21;
  double t538, t542, t543, t547, t548, t554, t555, t559;
  double t563, t564, t573, t574, t577, t580, t582, t583;
  double t591, t592, t593, t602, t605, t608, t611, t612;
  double t616, t619, t620, t624, t629, tv2rho22, t637, t638;
  double t643, t650, t658, t659, t660, t661, t669, t671;
  double t672, t675, t676, t680, t682, t686, t691, tv2rhosigma0;
  double tv2rhosigma1, t698, t700, tv2rhosigma2, t706, tv2rhosigma3, tv2rhosigma4, t711;
  double t716, t723, t731, t732, t733, t734, t742, t744;
  double t745, t748, t749, t753, t755, t759, t764, tv2rhosigma5;
  double tv2rholapl0, tv2rholapl1, tv2rholapl2, tv2rholapl3, t771, t774, t780, t785;
  double tv2rhotau0, t792, t794, tv2rhotau1, t800, tv2rhotau2, t807, t813;
  double t818, tv2rhotau3, t820, t821, t824, t825, t827, t828;
  double t832, tv2rhoexx0, t834, t835, t838, t839, t841, t843;
  double tv2rhoexx1, t845, t846, t850, tv2rhoexx2, t852, t853, t856;
  double t860, tv2rhoexx3, t867, t868, t873, t877, t881, t883;
  double t886, t887, t891, t893, t897, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t903, t904, t909, t913, t917, t919;
  double t922, t923, t927, t929, t933, tv2sigma25, tv2sigmalapl0, tv2sigmalapl1;
  double tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t934, t937, t940, t944;
  double t948, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t949, t952;
  double t955, t959, t963, tv2sigmatau5, t964, t965, t967, t970;
  double tv2sigmaexx0, tv2sigmaexx1, tv2sigmaexx2, tv2sigmaexx3, tv2sigmaexx4, t971, t972, t974;
  double t977, tv2sigmaexx5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2;
  double tv2lapltau3, tv2laplexx0, tv2laplexx1, tv2laplexx2, tv2laplexx3, t979, t980, t983;
  double t987, t991, tv2tau20, tv2tau21, t993, t994, t997, t1001;
  double t1005, tv2tau22, t1006, t1009, tv2tauexx0, tv2tauexx1, tv2tauexx2, t1010;
  double t1013, tv2tauexx3, tv2exx20, tv2exx21, tv2exx22;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = 0.1e1 / rho[0];
  t30 = sigma[0] * t29;
  t31 = 0.1e1 / tau[0];
  t34 = 0.1e1 - t30 * t31 / 0.8e1;
  t35 = t3 * t3;
  t37 = POW_1_3(0.1e1 / M_PI);
  t38 = 0.1e1 / t37;
  t39 = t35 * t38;
  t40 = M_CBRT4;
  t41 = t39 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t48 = sqrt(sigma[0]);
  t50 = 0.1e1 / t43 / rho[0];
  t51 = t48 * t50;
  t52 = log(t51 + sqrt(t51 * t51 + 0.1e1));
  t55 = 0.1e1 + 0.252e-1 * t51 * t52;
  t56 = 0.1e1 / t55;
  t60 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t47 * t56;
  t63 = 0.1e1 / t43 / t42;
  t64 = sigma[0] * t63;
  t65 = t31 * exx[0];
  t67 = M_CBRT2;
  t68 = t40 * t67;
  t69 = t39 * t68;
  t72 = t34 * t60 - t64 * t65 * t69 / 0.18e2;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t72);
  t77 = rho[1] <= p->dens_threshold;
  t78 = my_piecewise5(t15, t12, t11, t16, -t18);
  t79 = 0.1e1 + t78;
  t80 = t79 <= p->zeta_threshold;
  t81 = POW_1_3(t79);
  t83 = my_piecewise3(t80, t23, t81 * t79);
  t84 = t83 * t27;
  t85 = 0.1e1 / rho[1];
  t86 = sigma[2] * t85;
  t87 = 0.1e1 / tau[1];
  t90 = 0.1e1 - t86 * t87 / 0.8e1;
  t91 = rho[1] * rho[1];
  t92 = POW_1_3(rho[1]);
  t93 = t92 * t92;
  t95 = 0.1e1 / t93 / t91;
  t96 = sigma[2] * t95;
  t97 = sqrt(sigma[2]);
  t99 = 0.1e1 / t92 / rho[1];
  t100 = t97 * t99;
  t101 = log(t100 + sqrt(t100 * t100 + 0.1e1));
  t104 = 0.1e1 + 0.252e-1 * t100 * t101;
  t105 = 0.1e1 / t104;
  t109 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t96 * t105;
  t112 = 0.1e1 / t92 / t91;
  t113 = sigma[2] * t112;
  t114 = t87 * exx[1];
  t118 = t90 * t109 - t113 * t114 * t69 / 0.18e2;
  t122 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t118);
  tzk0 = t76 + t122;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t123 = t7 * t7;
  t124 = 0.1e1 / t123;
  t125 = t17 * t124;
  t126 = t8 - t125;
  t127 = my_piecewise5(t11, 0, t15, 0, t126);
  t130 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t127);
  t131 = t130 * t27;
  t135 = t27 * t27;
  t136 = 0.1e1 / t135;
  t137 = t26 * t136;
  t140 = t6 * t137 * t72 / 0.8e1;
  t141 = 0.1e1 / t42;
  t142 = sigma[0] * t141;
  t143 = t31 * t60;
  t146 = t42 * rho[0];
  t148 = 0.1e1 / t44 / t146;
  t149 = sigma[0] * t148;
  t153 = t55 * t55;
  t154 = 0.1e1 / t153;
  t158 = t47 + 0.1e1;
  t159 = sqrt(t158);
  t160 = 0.1e1 / t159;
  t163 = -0.336e-1 * t48 * t63 * t52 - 0.336e-1 * t149 * t160;
  t164 = t154 * t163;
  t168 = -0.24888888888888888889e-2 * t41 * t149 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t164;
  t171 = 0.1e1 / t43 / t146;
  t172 = sigma[0] * t171;
  t176 = t142 * t143 / 0.8e1 + t34 * t168 + 0.7e1 / 0.54e2 * t172 * t65 * t69;
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t72 - t140 - 0.3e1 / 0.8e1 * t6 * t28 * t176);
  t183 = my_piecewise5(t15, 0, t11, 0, -t126);
  t186 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t183);
  t187 = t186 * t27;
  t191 = t83 * t136;
  t194 = t6 * t191 * t118 / 0.8e1;
  t196 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t118 - t194);
  tvrho0 = t76 + t122 + t7 * (t181 + t196);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t199 = -t8 - t125;
  t200 = my_piecewise5(t11, 0, t15, 0, t199);
  t203 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t200);
  t204 = t203 * t27;
  t209 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t72 - t140);
  t211 = my_piecewise5(t15, 0, t11, 0, -t199);
  t214 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t211);
  t215 = t214 * t27;
  t219 = 0.1e1 / t91;
  t220 = sigma[2] * t219;
  t221 = t87 * t109;
  t224 = t91 * rho[1];
  t226 = 0.1e1 / t93 / t224;
  t227 = sigma[2] * t226;
  t231 = t104 * t104;
  t232 = 0.1e1 / t231;
  t236 = t96 + 0.1e1;
  t237 = sqrt(t236);
  t238 = 0.1e1 / t237;
  t241 = -0.336e-1 * t97 * t112 * t101 - 0.336e-1 * t227 * t238;
  t242 = t232 * t241;
  t246 = -0.24888888888888888889e-2 * t41 * t227 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t242;
  t249 = 0.1e1 / t92 / t224;
  t250 = sigma[2] * t249;
  t254 = t220 * t221 / 0.8e1 + t90 * t246 + 0.7e1 / 0.54e2 * t250 * t114 * t69;
  t259 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t118 - t194 - 0.3e1 / 0.8e1 * t6 * t84 * t254);
  tvrho1 = t76 + t122 + t7 * (t209 + t259);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t262 = t29 * t31;
  t269 = 0.1e1 / t48;
  t275 = 0.126e-1 * t269 * t50 * t52 + 0.126e-1 * t46 * t160;
  t276 = t154 * t275;
  t280 = 0.93333333333333333332e-3 * t39 * t40 * t46 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t276;
  t282 = t63 * t31;
  t286 = -t262 * t60 / 0.8e1 + t34 * t280 - t282 * exx[0] * t69 / 0.18e2;
  t290 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t286);
  tvsigma0 = t7 * t290;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t291 = t85 * t87;
  t298 = 0.1e1 / t97;
  t304 = 0.126e-1 * t298 * t99 * t101 + 0.126e-1 * t95 * t238;
  t305 = t232 * t304;
  t309 = 0.93333333333333333332e-3 * t39 * t40 * t95 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t305;
  t311 = t112 * t87;
  t315 = -t291 * t109 / 0.8e1 + t90 * t309 - t311 * exx[1] * t69 / 0.18e2;
  t319 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t315);
  tvsigma2 = t7 * t319;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  t320 = tau[0] * tau[0];
  t321 = 0.1e1 / t320;
  t322 = t321 * t60;
  t325 = t321 * exx[0];
  t329 = t30 * t322 / 0.8e1 + t64 * t325 * t69 / 0.18e2;
  t333 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t329);
  tvtau0 = t7 * t333;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t334 = tau[1] * tau[1];
  t335 = 0.1e1 / t334;
  t336 = t335 * t109;
  t339 = t335 * exx[1];
  t343 = t86 * t336 / 0.8e1 + t113 * t339 * t69 / 0.18e2;
  t347 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t343);
  tvtau1 = t7 * t347;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t348 = t5 * t26;
  t349 = t27 * sigma[0];
  t350 = t348 * t349;
  t352 = t38 * t40 * t67;
  t353 = t282 * t352;
  t356 = my_piecewise3(t2, 0, t350 * t353 / 0.16e2);
  tvexx0 = t7 * t356;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t357 = t5 * t83;
  t358 = t27 * sigma[2];
  t359 = t357 * t358;
  t360 = t311 * t352;
  t363 = my_piecewise3(t77, 0, t359 * t360 / 0.16e2);
  tvexx1 = t7 * t363;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 1] += tvexx1;

  t366 = t24 * t24;
  t367 = 0.1e1 / t366;
  t368 = t127 * t127;
  t371 = t123 * t7;
  t372 = 0.1e1 / t371;
  t373 = t17 * t372;
  t375 = -0.2e1 * t124 + 0.2e1 * t373;
  t376 = my_piecewise5(t11, 0, t15, 0, t375);
  t380 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t368 + 0.4e1 / 0.3e1 * t24 * t376);
  t381 = t380 * t27;
  t385 = t130 * t136;
  t387 = t6 * t385 * t72;
  t393 = 0.1e1 / t135 / t7;
  t394 = t26 * t393;
  t397 = t6 * t394 * t72 / 0.12e2;
  t399 = t6 * t137 * t176;
  t401 = 0.1e1 / t146;
  t402 = sigma[0] * t401;
  t405 = t31 * t168;
  t408 = t42 * t42;
  t410 = 0.1e1 / t44 / t408;
  t411 = sigma[0] * t410;
  t419 = 0.1e1 / t153 / t55;
  t420 = t163 * t163;
  t421 = t419 * t420;
  t430 = sigma[0] * sigma[0];
  t433 = 0.1e1 / t43 / t408 / t146;
  t436 = 0.1e1 / t159 / t158;
  t439 = 0.784e-1 * t48 * t171 * t52 + 0.168e0 * t411 * t160 - 0.448e-1 * t430 * t433 * t436;
  t440 = t154 * t439;
  t444 = 0.9125925925925925926e-2 * t41 * t411 * t56 + 0.49777777777777777778e-2 * t41 * t149 * t164 + 0.18666666666666666666e-2 * t41 * t47 * t421 - 0.93333333333333333332e-3 * t41 * t47 * t440;
  t447 = 0.1e1 / t43 / t408;
  t448 = sigma[0] * t447;
  t452 = -t402 * t143 / 0.4e1 + t142 * t405 / 0.4e1 + t34 * t444 - 0.35e2 / 0.81e2 * t448 * t65 * t69;
  t457 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t72 - t387 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t176 + t397 - t399 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t452);
  t458 = t81 * t81;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t464 = my_piecewise5(t15, 0, t11, 0, -t375);
  t468 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t81 * t464);
  t469 = t468 * t27;
  t473 = t186 * t136;
  t475 = t6 * t473 * t118;
  t477 = t83 * t393;
  t480 = t6 * t477 * t118 / 0.12e2;
  t482 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t118 - t475 / 0.4e1 + t480);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t196 + t7 * (t457 + t482);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t485 = t367 * t200;
  t488 = 0.2e1 * t373;
  t489 = my_piecewise5(t11, 0, t15, 0, t488);
  t493 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t485 * t127 + 0.4e1 / 0.3e1 * t24 * t489);
  t494 = t493 * t27;
  t498 = t203 * t136;
  t500 = t6 * t498 * t72;
  t508 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t72 - t500 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t176 - t387 / 0.8e1 + t397 - t399 / 0.8e1);
  t509 = t459 * t211;
  t512 = my_piecewise5(t15, 0, t11, 0, -t488);
  t516 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t509 * t183 + 0.4e1 / 0.3e1 * t81 * t512);
  t517 = t516 * t27;
  t521 = t214 * t136;
  t523 = t6 * t521 * t118;
  t530 = t6 * t191 * t254;
  t533 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t118 - t523 / 0.8e1 - t475 / 0.8e1 + t480 - 0.3e1 / 0.8e1 * t6 * t187 * t254 - t530 / 0.8e1);
  tv2rho21 = t181 + t196 + t209 + t259 + t7 * (t508 + t533);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t538 = t200 * t200;
  t542 = 0.2e1 * t124 + 0.2e1 * t373;
  t543 = my_piecewise5(t11, 0, t15, 0, t542);
  t547 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t538 + 0.4e1 / 0.3e1 * t24 * t543);
  t548 = t547 * t27;
  t554 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t72 - t500 / 0.4e1 + t397);
  t555 = t211 * t211;
  t559 = my_piecewise5(t15, 0, t11, 0, -t542);
  t563 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t555 + 0.4e1 / 0.3e1 * t81 * t559);
  t564 = t563 * t27;
  t573 = 0.1e1 / t224;
  t574 = sigma[2] * t573;
  t577 = t87 * t246;
  t580 = t91 * t91;
  t582 = 0.1e1 / t93 / t580;
  t583 = sigma[2] * t582;
  t591 = 0.1e1 / t231 / t104;
  t592 = t241 * t241;
  t593 = t591 * t592;
  t602 = sigma[2] * sigma[2];
  t605 = 0.1e1 / t92 / t580 / t224;
  t608 = 0.1e1 / t237 / t236;
  t611 = 0.784e-1 * t97 * t249 * t101 + 0.168e0 * t583 * t238 - 0.448e-1 * t602 * t605 * t608;
  t612 = t232 * t611;
  t616 = 0.9125925925925925926e-2 * t41 * t583 * t105 + 0.49777777777777777778e-2 * t41 * t227 * t242 + 0.18666666666666666666e-2 * t41 * t96 * t593 - 0.93333333333333333332e-3 * t41 * t96 * t612;
  t619 = 0.1e1 / t92 / t580;
  t620 = sigma[2] * t619;
  t624 = -t574 * t221 / 0.4e1 + t220 * t577 / 0.4e1 + t90 * t616 - 0.35e2 / 0.81e2 * t620 * t114 * t69;
  t629 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t118 - t523 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t254 + t480 - t530 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t624);
  tv2rho22 = 0.2e1 * t209 + 0.2e1 * t259 + t7 * (t554 + t629);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t637 = t6 * t137 * t286 / 0.8e1;
  t638 = t141 * t31;
  t643 = t31 * t280;
  t650 = t46 * t154;
  t658 = t39 * t40 * sigma[0];
  t659 = t46 * t419;
  t660 = t275 * t163;
  t661 = t659 * t660;
  t669 = t408 * t42;
  t671 = 0.1e1 / t43 / t669;
  t672 = t671 * t436;
  t675 = -0.168e-1 * t269 * t63 * t52 - 0.504e-1 * t148 * t160 + 0.168e-1 * t672 * sigma[0];
  t676 = t154 * t675;
  t680 = -0.24888888888888888889e-2 * t39 * t40 * t148 * t56 - 0.93333333333333333332e-3 * t41 * t650 * t163 + 0.24888888888888888889e-2 * t41 * t149 * t276 + 0.18666666666666666666e-2 * t658 * t661 - 0.93333333333333333332e-3 * t41 * t47 * t676;
  t682 = t171 * t31;
  t686 = t638 * t60 / 0.8e1 - t262 * t168 / 0.8e1 + t142 * t643 / 0.8e1 + t34 * t680 + 0.7e1 / 0.54e2 * t682 * exx[0] * t69;
  t691 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t286 - t637 - 0.3e1 / 0.8e1 * t6 * t28 * t686);
  tv2rhosigma0 = t691 * t7 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t698 = t6 * t191 * t315 / 0.8e1;
  t700 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t315 - t698);
  tv2rhosigma2 = t7 * t700 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t706 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t286 - t637);
  tv2rhosigma3 = t7 * t706 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t711 = t219 * t87;
  t716 = t87 * t309;
  t723 = t95 * t232;
  t731 = t39 * t40 * sigma[2];
  t732 = t95 * t591;
  t733 = t304 * t241;
  t734 = t732 * t733;
  t742 = t580 * t91;
  t744 = 0.1e1 / t92 / t742;
  t745 = t744 * t608;
  t748 = -0.168e-1 * t298 * t112 * t101 - 0.504e-1 * t226 * t238 + 0.168e-1 * t745 * sigma[2];
  t749 = t232 * t748;
  t753 = -0.24888888888888888889e-2 * t39 * t40 * t226 * t105 - 0.93333333333333333332e-3 * t41 * t723 * t241 + 0.24888888888888888889e-2 * t41 * t227 * t305 + 0.18666666666666666666e-2 * t731 * t734 - 0.93333333333333333332e-3 * t41 * t96 * t749;
  t755 = t249 * t87;
  t759 = t711 * t109 / 0.8e1 - t291 * t246 / 0.8e1 + t220 * t716 / 0.8e1 + t90 * t753 + 0.7e1 / 0.54e2 * t755 * exx[1] * t69;
  t764 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t315 - t698 - 0.3e1 / 0.8e1 * t6 * t84 * t759);
  tv2rhosigma5 = t7 * t764 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  t771 = t6 * t137 * t329 / 0.8e1;
  t774 = t321 * t168;
  t780 = -t142 * t322 / 0.8e1 + t30 * t774 / 0.8e1 - 0.7e1 / 0.54e2 * t172 * t325 * t69;
  t785 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t329 - t771 - 0.3e1 / 0.8e1 * t6 * t28 * t780);
  tv2rhotau0 = t7 * t785 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t792 = t6 * t191 * t343 / 0.8e1;
  t794 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t343 - t792);
  tv2rhotau1 = t7 * t794 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  t800 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t329 - t771);
  tv2rhotau2 = t7 * t800 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  t807 = t335 * t246;
  t813 = -t220 * t336 / 0.8e1 + t86 * t807 / 0.8e1 - 0.7e1 / 0.54e2 * t250 * t339 * t69;
  t818 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t343 - t792 - 0.3e1 / 0.8e1 * t6 * t84 * t813);
  tv2rhotau3 = t7 * t818 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t820 = t5 * t130;
  t821 = t820 * t349;
  t824 = t136 * sigma[0];
  t825 = t348 * t824;
  t827 = t825 * t353 / 0.48e2;
  t828 = t682 * t352;
  t832 = my_piecewise3(t2, 0, t821 * t353 / 0.16e2 + t827 - 0.7e1 / 0.48e2 * t350 * t828);
  tv2rhoexx0 = t7 * t832 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t834 = t5 * t186;
  t835 = t834 * t358;
  t838 = t136 * sigma[2];
  t839 = t357 * t838;
  t841 = t839 * t360 / 0.48e2;
  t843 = my_piecewise3(t77, 0, t835 * t360 / 0.16e2 + t841);
  tv2rhoexx1 = t7 * t843 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 1] += tv2rhoexx1;

  t845 = t5 * t203;
  t846 = t845 * t349;
  t850 = my_piecewise3(t2, 0, t846 * t353 / 0.16e2 + t827);
  tv2rhoexx2 = t7 * t850 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 2] += tv2rhoexx2;

  t852 = t5 * t214;
  t853 = t852 * t358;
  t856 = t755 * t352;
  t860 = my_piecewise3(t77, 0, t853 * t360 / 0.16e2 + t841 - 0.7e1 / 0.48e2 * t359 * t856);
  tv2rhoexx3 = t7 * t860 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 3] += tv2rhoexx3;

  t867 = t275 * t275;
  t868 = t419 * t867;
  t873 = 0.1e1 / t48 / sigma[0];
  t877 = 0.1e1 / sigma[0];
  t881 = t408 * rho[0];
  t883 = 0.1e1 / t43 / t881;
  t886 = -0.63e-2 * t873 * t50 * t52 + 0.63e-2 * t877 * t46 * t160 - 0.63e-2 * t883 * t436;
  t887 = t154 * t886;
  t891 = -0.18666666666666666666e-2 * t41 * t650 * t275 + 0.18666666666666666666e-2 * t41 * t47 * t868 - 0.93333333333333333332e-3 * t41 * t47 * t887;
  t893 = -t262 * t280 / 0.4e1 + t34 * t891;
  t897 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t893);
  tv2sigma20 = t7 * t897;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t903 = t304 * t304;
  t904 = t591 * t903;
  t909 = 0.1e1 / t97 / sigma[2];
  t913 = 0.1e1 / sigma[2];
  t917 = t580 * rho[1];
  t919 = 0.1e1 / t92 / t917;
  t922 = -0.63e-2 * t909 * t99 * t101 + 0.63e-2 * t913 * t95 * t238 - 0.63e-2 * t919 * t608;
  t923 = t232 * t922;
  t927 = -0.18666666666666666666e-2 * t41 * t723 * t304 + 0.18666666666666666666e-2 * t41 * t96 * t904 - 0.93333333333333333332e-3 * t41 * t96 * t923;
  t929 = -t291 * t309 / 0.4e1 + t90 * t927;
  t933 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t929);
  tv2sigma25 = t7 * t933;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  t934 = t29 * t321;
  t937 = t321 * t280;
  t940 = t63 * t321;
  t944 = t934 * t60 / 0.8e1 + t30 * t937 / 0.8e1 + t940 * exx[0] * t69 / 0.18e2;
  t948 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t944);
  tv2sigmatau0 = t7 * t948;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  t949 = t85 * t335;
  t952 = t335 * t309;
  t955 = t112 * t335;
  t959 = t949 * t109 / 0.8e1 + t86 * t952 / 0.8e1 + t955 * exx[1] * t69 / 0.18e2;
  t963 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t959);
  tv2sigmatau5 = t7 * t963;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t964 = t27 * t63;
  t965 = t348 * t964;
  t967 = t31 * t38 * t68;
  t970 = my_piecewise3(t2, 0, t965 * t967 / 0.16e2);
  tv2sigmaexx0 = t7 * t970;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2sigmaexx1 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 1] += tv2sigmaexx1;

  tv2sigmaexx2 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 2] += tv2sigmaexx2;

  tv2sigmaexx3 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 3] += tv2sigmaexx3;

  tv2sigmaexx4 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 4] += tv2sigmaexx4;

  t971 = t27 * t112;
  t972 = t357 * t971;
  t974 = t87 * t38 * t68;
  t977 = my_piecewise3(t77, 0, t972 * t974 / 0.16e2);
  tv2sigmaexx5 = t7 * t977;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 5] += tv2sigmaexx5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  tv2laplexx1 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 1] += tv2laplexx1;

  tv2laplexx2 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 2] += tv2laplexx2;

  tv2laplexx3 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 3] += tv2laplexx3;

  t979 = 0.1e1 / t320 / tau[0];
  t980 = t979 * t60;
  t983 = t979 * exx[0];
  t987 = -t30 * t980 / 0.4e1 - t64 * t983 * t69 / 0.9e1;
  t991 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t987);
  tv2tau20 = t7 * t991;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  t993 = 0.1e1 / t334 / tau[1];
  t994 = t993 * t109;
  t997 = t993 * exx[1];
  t1001 = -t86 * t994 / 0.4e1 - t113 * t997 * t69 / 0.9e1;
  t1005 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t1001);
  tv2tau22 = t7 * t1005;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

  t1006 = t940 * t352;
  t1009 = my_piecewise3(t2, 0, -t350 * t1006 / 0.16e2);
  tv2tauexx0 = t7 * t1009;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2tauexx1 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 1] += tv2tauexx1;

  tv2tauexx2 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 2] += tv2tauexx2;

  t1010 = t955 * t352;
  t1013 = my_piecewise3(t77, 0, -t359 * t1010 / 0.16e2);
  tv2tauexx3 = t7 * t1013;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 3] += tv2tauexx3;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

  tv2exx21 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 1] += tv2exx21;

  tv2exx22 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 2] += tv2exx22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t34, t35, t37, t38, t39, t40, t41;
  double t42, t43, t44, t46, t47, t48, t50, t51;
  double t52, t55, t56, t60, t63, t64, t65, t67;
  double t68, t69, t72, t76, t77, t78, t79, t80;
  double t81, t83, t84, t85, t86, t87, t90, t91;
  double t92, t93, t95, t96, t97, t99, t100, t101;
  double t104, t105, t109, t112, t113, t114, t118, t122;
  double tzk0;

  double t123, t124, t125, t126, t127, t130, t131, t135;
  double t136, t137, t140, t141, t142, t143, t146, t148;
  double t149, t153, t154, t158, t159, t160, t163, t164;
  double t168, t171, t172, t176, t181, t183, t186, t187;
  double t191, t194, t196, tvrho0, t199, t200, t203, t204;
  double t209, t211, t214, t215, t219, t220, t221, t224;
  double t226, t227, t231, t232, t236, t237, t238, t241;
  double t242, t246, t249, t250, t254, t259, tvrho1, t262;
  double t269, t275, t276, t280, t282, t286, t290, tvsigma0;
  double tvsigma1, t291, t298, t304, t305, t309, t311, t315;
  double t319, tvsigma2, tvlapl0, tvlapl1, t320, t321, t322, t325;
  double t329, t333, tvtau0, t334, t335, t336, t339, t343;
  double t347, tvtau1, t348, t349, t350, t352, t353, t356;
  double tvexx0, t357, t358, t359, t360, t363, tvexx1;

  double t366, t367, t368, t371, t372, t373, t375, t376;
  double t380, t381, t385, t387, t393, t394, t397, t399;
  double t401, t402, t405, t408, t410, t411, t419, t420;
  double t421, t430, t433, t436, t439, t440, t444, t447;
  double t448, t452, t457, t458, t459, t460, t464, t468;
  double t469, t473, t475, t477, t480, t482, tv2rho20, t485;
  double t488, t489, t493, t494, t498, t500, t508, t509;
  double t512, t516, t517, t521, t523, t530, t533, tv2rho21;
  double t538, t542, t543, t547, t548, t554, t555, t559;
  double t563, t564, t573, t574, t577, t580, t582, t583;
  double t591, t592, t593, t602, t605, t608, t611, t612;
  double t616, t619, t620, t624, t629, tv2rho22, t637, t638;
  double t643, t650, t658, t659, t660, t661, t669, t671;
  double t672, t675, t676, t680, t682, t686, t691, tv2rhosigma0;
  double tv2rhosigma1, t698, t700, tv2rhosigma2, t706, tv2rhosigma3, tv2rhosigma4, t711;
  double t716, t723, t731, t732, t733, t734, t742, t744;
  double t745, t748, t749, t753, t755, t759, t764, tv2rhosigma5;
  double tv2rholapl0, tv2rholapl1, tv2rholapl2, tv2rholapl3, t771, t774, t780, t785;
  double tv2rhotau0, t792, t794, tv2rhotau1, t800, tv2rhotau2, t807, t813;
  double t818, tv2rhotau3, t820, t821, t824, t825, t827, t828;
  double t832, tv2rhoexx0, t834, t835, t838, t839, t841, t843;
  double tv2rhoexx1, t845, t846, t850, tv2rhoexx2, t852, t853, t856;
  double t860, tv2rhoexx3, t867, t868, t873, t877, t881, t883;
  double t886, t887, t891, t893, t897, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t903, t904, t909, t913, t917, t919;
  double t922, t923, t927, t929, t933, tv2sigma25, tv2sigmalapl0, tv2sigmalapl1;
  double tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t934, t937, t940, t944;
  double t948, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t949, t952;
  double t955, t959, t963, tv2sigmatau5, t964, t965, t967, t970;
  double tv2sigmaexx0, tv2sigmaexx1, tv2sigmaexx2, tv2sigmaexx3, tv2sigmaexx4, t971, t972, t974;
  double t977, tv2sigmaexx5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2;
  double tv2lapltau3, tv2laplexx0, tv2laplexx1, tv2laplexx2, tv2laplexx3, t979, t980, t983;
  double t987, t991, tv2tau20, tv2tau21, t993, t994, t997, t1001;
  double t1005, tv2tau22, t1006, t1009, tv2tauexx0, tv2tauexx1, tv2tauexx2, t1010;
  double t1013, tv2tauexx3, tv2exx20, tv2exx21, tv2exx22;

  double t1017, t1018, t1021, t1024, t1025, t1026, t1028, t1029;
  double t1033, t1034, t1038, t1040, t1045, t1047, t1050, t1056;
  double t1057, t1060, t1062, t1065, t1067, t1068, t1073, t1077;
  double t1078, t1091, t1092, t1093, t1094, t1098, t1099, t1107;
  double t1109, t1113, t1114, t1115, t1117, t1119, t1122, t1123;
  double t1127, t1129, t1133, t1138, t1140, t1141, t1144, t1148;
  double t1152, t1153, t1157, t1159, t1161, t1163, t1165, t1168;
  double t1170, tv3rho30, t1173, t1174, t1175, t1178, t1183, t1184;
  double t1185, t1186, t1190, t1191, t1195, t1198, t1202, t1204;
  double t1208, t1217, t1218, t1219, t1222, t1228, t1232, t1233;
  double t1237, t1240, t1241, t1243, t1252, t1254, t1257, tv3rho31;
  double t1260, t1265, t1268, t1269, t1273, t1274, t1278, t1280;
  double t1289, t1290, t1295, t1299, t1303, t1304, t1308, t1310;
  double t1317, t1325, t1327, t1328, tv3rho32, t1333, t1339, t1340;
  double t1344, t1345, t1352, t1353, t1359, t1363, t1364, t1379;
  double t1380, t1385, t1389, t1390, t1403, t1404, t1405, t1406;
  double t1410, t1411, t1419, t1421, t1425, t1426, t1427, t1429;
  double t1431, t1434, t1435, t1439, t1441, t1445, t1450, tv3rho33;
  double t1458, t1465, t1467, t1469, t1478, t1485, t1498, t1499;
  double t1505, t1506, t1507, t1510, t1511, t1514, t1515, t1523;
  double t1528, t1531, t1532, t1536, t1538, t1542, t1547, tv3rho2sigma0;
  double tv3rho2sigma1, t1554, t1558, t1560, tv3rho2sigma2, t1566, t1574, tv3rho2sigma3;
  double tv3rho2sigma4, t1580, t1587, t1590, tv3rho2sigma5, t1598, tv3rho2sigma6, tv3rho2sigma7;
  double t1609, t1618, t1625, t1638, t1639, t1645, t1646, t1647;
  double t1650, t1651, t1654, t1655, t1663, t1668, t1671, t1672;
  double t1676, t1678, t1682, t1687, tv3rho2sigma8, tv3rho2lapl0, tv3rho2lapl1, tv3rho2lapl2;
  double tv3rho2lapl3, tv3rho2lapl4, tv3rho2lapl5, t1694, t1701, t1703, t1709, t1715;
  double t1720, tv3rho2tau0, t1727, t1731, t1733, tv3rho2tau1, t1739, t1747;
  double tv3rho2tau2, t1753, t1760, t1763, tv3rho2tau3, t1771, tv3rho2tau4, t1786;
  double t1792, t1797, tv3rho2tau5, t1800, t1801, t1804, t1805, t1809;
  double t1810, t1812, t1813, t1815, t1819, tv3rho2exx0, t1822, t1823;
  double t1826, t1827, t1829, t1830, t1832, t1834, tv3rho2exx1, t1836;
  double t1837, t1840, t1841, t1848, tv3rho2exx2, t1850, t1851, t1854;
  double t1855, t1860, t1863, tv3rho2exx3, t1866, t1867, t1872, tv3rho2exx4;
  double t1875, t1876, t1883, t1887, tv3rho2exx5, t1894, t1899, t1913;
  double t1914, t1917, t1918, t1924, t1925, t1935, t1937, t1940;
  double t1941, t1945, t1947, t1952, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1959, t1961, tv3rhosigma25, t1967, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1976, t1990, t1991, t1994, t1995, t2001;
  double t2002, t2012, t2014, t2017, t2018, t2022, t2024, t2029;
  double tv3rhosigma211, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4, tv3rhosigmalapl5, tv3rhosigmalapl6;
  double tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, tv3rhosigmalapl11, t2036, t2037, t2044;
  double t2047, t2051, t2056, tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4;
  double t2063, t2065, tv3rhosigmatau5, t2071, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9;
  double tv3rhosigmatau10, t2076, t2083, t2086, t2090, t2095, tv3rhosigmatau11, t2097;
  double t2100, t2101, t2103, t2104, t2105, t2109, tv3rhosigmaexx0, tv3rhosigmaexx1;
  double tv3rhosigmaexx2, tv3rhosigmaexx3, tv3rhosigmaexx4, t2111, t2114, t2115, t2117, t2119;
  double tv3rhosigmaexx5, t2121, t2125, tv3rhosigmaexx6, tv3rhosigmaexx7, tv3rhosigmaexx8, tv3rhosigmaexx9, tv3rhosigmaexx10;
  double t2127, t2130, t2131, t2135, tv3rhosigmaexx11, tv3rholapl20, tv3rholapl21, tv3rholapl22;
  double tv3rholapl23, tv3rholapl24, tv3rholapl25, tv3rholapltau0, tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4;
  double tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rholaplexx0, tv3rholaplexx1, tv3rholaplexx2, tv3rholaplexx3, tv3rholaplexx4;
  double tv3rholaplexx5, tv3rholaplexx6, tv3rholaplexx7, t2142, t2145, t2151, t2156, tv3rhotau20;
  double tv3rhotau21, t2163, t2165, tv3rhotau22, t2171, tv3rhotau23, tv3rhotau24, t2178;
  double t2184, t2189, tv3rhotau25, t2194, t2195, t2199, tv3rhotauexx0, tv3rhotauexx1;
  double tv3rhotauexx2, t2204, t2206, tv3rhotauexx3, t2211, tv3rhotauexx4, tv3rhotauexx5, tv3rhotauexx6;
  double t2215, t2219, tv3rhotauexx7, tv3rhoexx20, tv3rhoexx21, tv3rhoexx22, tv3rhoexx23, tv3rhoexx24;
  double tv3rhoexx25, t2229, t2230, t2234, t2239, t2243, t2253, t2254;
  double t2258, t2260, t2264, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2273, t2274, t2278, t2283;
  double t2287, t2297, t2298, t2302, t2304, t2308, tv3sigma39, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, tv3sigma2lapl11, t2311, t2314, t2318, tv3sigma2tau0, tv3sigma2tau1;
  double tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9;
  double tv3sigma2tau10, t2321, t2324, t2328, tv3sigma2tau11, tv3sigma2exx0, tv3sigma2exx1, tv3sigma2exx2;
  double tv3sigma2exx3, tv3sigma2exx4, tv3sigma2exx5, tv3sigma2exx6, tv3sigma2exx7, tv3sigma2exx8, tv3sigma2exx9, tv3sigma2exx10;
  double tv3sigma2exx11, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26;
  double tv3sigmalapl27, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5;
  double tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmalaplexx0, tv3sigmalaplexx1;
  double tv3sigmalaplexx2, tv3sigmalaplexx3, tv3sigmalaplexx4, tv3sigmalaplexx5, tv3sigmalaplexx6, tv3sigmalaplexx7, tv3sigmalaplexx8, tv3sigmalaplexx9;
  double tv3sigmalaplexx10, tv3sigmalaplexx11, t2329, t2332, t2335, t2339, t2343, tv3sigmatau20;
  double tv3sigmatau21, tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, t2344;
  double t2347, t2350, t2354, t2358, tv3sigmatau28, t2360, t2363, tv3sigmatauexx0;
  double tv3sigmatauexx1, tv3sigmatauexx2, tv3sigmatauexx3, tv3sigmatauexx4, tv3sigmatauexx5, tv3sigmatauexx6, tv3sigmatauexx7, tv3sigmatauexx8;
  double tv3sigmatauexx9, tv3sigmatauexx10, t2365, t2368, tv3sigmatauexx11, tv3sigmaexx20, tv3sigmaexx21, tv3sigmaexx22;
  double tv3sigmaexx23, tv3sigmaexx24, tv3sigmaexx25, tv3sigmaexx26, tv3sigmaexx27, tv3sigmaexx28, tv3lapl30, tv3lapl31;
  double tv3lapl32, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5;
  double tv3lapl2exx0, tv3lapl2exx1, tv3lapl2exx2, tv3lapl2exx3, tv3lapl2exx4, tv3lapl2exx5, tv3lapltau20, tv3lapltau21;
  double tv3lapltau22, tv3lapltau23, tv3lapltau24, tv3lapltau25, tv3lapltauexx0, tv3lapltauexx1, tv3lapltauexx2, tv3lapltauexx3;
  double tv3lapltauexx4, tv3lapltauexx5, tv3lapltauexx6, tv3lapltauexx7, tv3laplexx20, tv3laplexx21, tv3laplexx22, tv3laplexx23;
  double tv3laplexx24, tv3laplexx25, t2369, t2370, t2382, tv3tau30, tv3tau31, tv3tau32;
  double t2383, t2384, t2396, tv3tau33, t2397, t2400, tv3tau2exx0, tv3tau2exx1;
  double tv3tau2exx2, tv3tau2exx3, tv3tau2exx4, t2401, t2404, tv3tau2exx5, tv3tauexx20, tv3tauexx21;
  double tv3tauexx22, tv3tauexx23, tv3tauexx24, tv3tauexx25, tv3exx30, tv3exx31, tv3exx32, tv3exx33;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = 0.1e1 / rho[0];
  t30 = sigma[0] * t29;
  t31 = 0.1e1 / tau[0];
  t34 = 0.1e1 - t30 * t31 / 0.8e1;
  t35 = t3 * t3;
  t37 = POW_1_3(0.1e1 / M_PI);
  t38 = 0.1e1 / t37;
  t39 = t35 * t38;
  t40 = M_CBRT4;
  t41 = t39 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t48 = sqrt(sigma[0]);
  t50 = 0.1e1 / t43 / rho[0];
  t51 = t48 * t50;
  t52 = log(t51 + sqrt(t51 * t51 + 0.1e1));
  t55 = 0.1e1 + 0.252e-1 * t51 * t52;
  t56 = 0.1e1 / t55;
  t60 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t47 * t56;
  t63 = 0.1e1 / t43 / t42;
  t64 = sigma[0] * t63;
  t65 = t31 * exx[0];
  t67 = M_CBRT2;
  t68 = t40 * t67;
  t69 = t39 * t68;
  t72 = t34 * t60 - t64 * t65 * t69 / 0.18e2;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t72);
  t77 = rho[1] <= p->dens_threshold;
  t78 = my_piecewise5(t15, t12, t11, t16, -t18);
  t79 = 0.1e1 + t78;
  t80 = t79 <= p->zeta_threshold;
  t81 = POW_1_3(t79);
  t83 = my_piecewise3(t80, t23, t81 * t79);
  t84 = t83 * t27;
  t85 = 0.1e1 / rho[1];
  t86 = sigma[2] * t85;
  t87 = 0.1e1 / tau[1];
  t90 = 0.1e1 - t86 * t87 / 0.8e1;
  t91 = rho[1] * rho[1];
  t92 = POW_1_3(rho[1]);
  t93 = t92 * t92;
  t95 = 0.1e1 / t93 / t91;
  t96 = sigma[2] * t95;
  t97 = sqrt(sigma[2]);
  t99 = 0.1e1 / t92 / rho[1];
  t100 = t97 * t99;
  t101 = log(t100 + sqrt(t100 * t100 + 0.1e1));
  t104 = 0.1e1 + 0.252e-1 * t100 * t101;
  t105 = 0.1e1 / t104;
  t109 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t96 * t105;
  t112 = 0.1e1 / t92 / t91;
  t113 = sigma[2] * t112;
  t114 = t87 * exx[1];
  t118 = t90 * t109 - t113 * t114 * t69 / 0.18e2;
  t122 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t118);
  tzk0 = t76 + t122;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t123 = t7 * t7;
  t124 = 0.1e1 / t123;
  t125 = t17 * t124;
  t126 = t8 - t125;
  t127 = my_piecewise5(t11, 0, t15, 0, t126);
  t130 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t127);
  t131 = t130 * t27;
  t135 = t27 * t27;
  t136 = 0.1e1 / t135;
  t137 = t26 * t136;
  t140 = t6 * t137 * t72 / 0.8e1;
  t141 = 0.1e1 / t42;
  t142 = sigma[0] * t141;
  t143 = t31 * t60;
  t146 = t42 * rho[0];
  t148 = 0.1e1 / t44 / t146;
  t149 = sigma[0] * t148;
  t153 = t55 * t55;
  t154 = 0.1e1 / t153;
  t158 = t47 + 0.1e1;
  t159 = sqrt(t158);
  t160 = 0.1e1 / t159;
  t163 = -0.336e-1 * t48 * t63 * t52 - 0.336e-1 * t149 * t160;
  t164 = t154 * t163;
  t168 = -0.24888888888888888889e-2 * t41 * t149 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t164;
  t171 = 0.1e1 / t43 / t146;
  t172 = sigma[0] * t171;
  t176 = t142 * t143 / 0.8e1 + t34 * t168 + 0.7e1 / 0.54e2 * t172 * t65 * t69;
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t72 - t140 - 0.3e1 / 0.8e1 * t6 * t28 * t176);
  t183 = my_piecewise5(t15, 0, t11, 0, -t126);
  t186 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t183);
  t187 = t186 * t27;
  t191 = t83 * t136;
  t194 = t6 * t191 * t118 / 0.8e1;
  t196 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t118 - t194);
  tvrho0 = t76 + t122 + t7 * (t181 + t196);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t199 = -t8 - t125;
  t200 = my_piecewise5(t11, 0, t15, 0, t199);
  t203 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t200);
  t204 = t203 * t27;
  t209 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t72 - t140);
  t211 = my_piecewise5(t15, 0, t11, 0, -t199);
  t214 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t211);
  t215 = t214 * t27;
  t219 = 0.1e1 / t91;
  t220 = sigma[2] * t219;
  t221 = t87 * t109;
  t224 = t91 * rho[1];
  t226 = 0.1e1 / t93 / t224;
  t227 = sigma[2] * t226;
  t231 = t104 * t104;
  t232 = 0.1e1 / t231;
  t236 = t96 + 0.1e1;
  t237 = sqrt(t236);
  t238 = 0.1e1 / t237;
  t241 = -0.336e-1 * t97 * t112 * t101 - 0.336e-1 * t227 * t238;
  t242 = t232 * t241;
  t246 = -0.24888888888888888889e-2 * t41 * t227 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t242;
  t249 = 0.1e1 / t92 / t224;
  t250 = sigma[2] * t249;
  t254 = t220 * t221 / 0.8e1 + t90 * t246 + 0.7e1 / 0.54e2 * t250 * t114 * t69;
  t259 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t118 - t194 - 0.3e1 / 0.8e1 * t6 * t84 * t254);
  tvrho1 = t76 + t122 + t7 * (t209 + t259);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t262 = t29 * t31;
  t269 = 0.1e1 / t48;
  t275 = 0.126e-1 * t269 * t50 * t52 + 0.126e-1 * t46 * t160;
  t276 = t154 * t275;
  t280 = 0.93333333333333333332e-3 * t39 * t40 * t46 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t276;
  t282 = t63 * t31;
  t286 = -t262 * t60 / 0.8e1 + t34 * t280 - t282 * exx[0] * t69 / 0.18e2;
  t290 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t286);
  tvsigma0 = t7 * t290;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t291 = t85 * t87;
  t298 = 0.1e1 / t97;
  t304 = 0.126e-1 * t298 * t99 * t101 + 0.126e-1 * t95 * t238;
  t305 = t232 * t304;
  t309 = 0.93333333333333333332e-3 * t39 * t40 * t95 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t305;
  t311 = t112 * t87;
  t315 = -t291 * t109 / 0.8e1 + t90 * t309 - t311 * exx[1] * t69 / 0.18e2;
  t319 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t315);
  tvsigma2 = t7 * t319;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  t320 = tau[0] * tau[0];
  t321 = 0.1e1 / t320;
  t322 = t321 * t60;
  t325 = t321 * exx[0];
  t329 = t30 * t322 / 0.8e1 + t64 * t325 * t69 / 0.18e2;
  t333 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t329);
  tvtau0 = t7 * t333;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t334 = tau[1] * tau[1];
  t335 = 0.1e1 / t334;
  t336 = t335 * t109;
  t339 = t335 * exx[1];
  t343 = t86 * t336 / 0.8e1 + t113 * t339 * t69 / 0.18e2;
  t347 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t343);
  tvtau1 = t7 * t347;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t348 = t5 * t26;
  t349 = t27 * sigma[0];
  t350 = t348 * t349;
  t352 = t38 * t40 * t67;
  t353 = t282 * t352;
  t356 = my_piecewise3(t2, 0, t350 * t353 / 0.16e2);
  tvexx0 = t7 * t356;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t357 = t5 * t83;
  t358 = t27 * sigma[2];
  t359 = t357 * t358;
  t360 = t311 * t352;
  t363 = my_piecewise3(t77, 0, t359 * t360 / 0.16e2);
  tvexx1 = t7 * t363;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 1] += tvexx1;

  t366 = t24 * t24;
  t367 = 0.1e1 / t366;
  t368 = t127 * t127;
  t371 = t123 * t7;
  t372 = 0.1e1 / t371;
  t373 = t17 * t372;
  t375 = -0.2e1 * t124 + 0.2e1 * t373;
  t376 = my_piecewise5(t11, 0, t15, 0, t375);
  t380 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t368 + 0.4e1 / 0.3e1 * t24 * t376);
  t381 = t380 * t27;
  t385 = t130 * t136;
  t387 = t6 * t385 * t72;
  t393 = 0.1e1 / t135 / t7;
  t394 = t26 * t393;
  t397 = t6 * t394 * t72 / 0.12e2;
  t399 = t6 * t137 * t176;
  t401 = 0.1e1 / t146;
  t402 = sigma[0] * t401;
  t405 = t31 * t168;
  t408 = t42 * t42;
  t410 = 0.1e1 / t44 / t408;
  t411 = sigma[0] * t410;
  t419 = 0.1e1 / t153 / t55;
  t420 = t163 * t163;
  t421 = t419 * t420;
  t430 = sigma[0] * sigma[0];
  t433 = 0.1e1 / t43 / t408 / t146;
  t436 = 0.1e1 / t159 / t158;
  t439 = 0.784e-1 * t48 * t171 * t52 + 0.168e0 * t411 * t160 - 0.448e-1 * t430 * t433 * t436;
  t440 = t154 * t439;
  t444 = 0.9125925925925925926e-2 * t41 * t411 * t56 + 0.49777777777777777778e-2 * t41 * t149 * t164 + 0.18666666666666666666e-2 * t41 * t47 * t421 - 0.93333333333333333332e-3 * t41 * t47 * t440;
  t447 = 0.1e1 / t43 / t408;
  t448 = sigma[0] * t447;
  t452 = -t402 * t143 / 0.4e1 + t142 * t405 / 0.4e1 + t34 * t444 - 0.35e2 / 0.81e2 * t448 * t65 * t69;
  t457 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t72 - t387 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t176 + t397 - t399 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t452);
  t458 = t81 * t81;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t464 = my_piecewise5(t15, 0, t11, 0, -t375);
  t468 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t81 * t464);
  t469 = t468 * t27;
  t473 = t186 * t136;
  t475 = t6 * t473 * t118;
  t477 = t83 * t393;
  t480 = t6 * t477 * t118 / 0.12e2;
  t482 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t118 - t475 / 0.4e1 + t480);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t196 + t7 * (t457 + t482);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t485 = t367 * t200;
  t488 = 0.2e1 * t373;
  t489 = my_piecewise5(t11, 0, t15, 0, t488);
  t493 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t485 * t127 + 0.4e1 / 0.3e1 * t24 * t489);
  t494 = t493 * t27;
  t498 = t203 * t136;
  t500 = t6 * t498 * t72;
  t508 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t72 - t500 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t176 - t387 / 0.8e1 + t397 - t399 / 0.8e1);
  t509 = t459 * t211;
  t512 = my_piecewise5(t15, 0, t11, 0, -t488);
  t516 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t509 * t183 + 0.4e1 / 0.3e1 * t81 * t512);
  t517 = t516 * t27;
  t521 = t214 * t136;
  t523 = t6 * t521 * t118;
  t530 = t6 * t191 * t254;
  t533 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t118 - t523 / 0.8e1 - t475 / 0.8e1 + t480 - 0.3e1 / 0.8e1 * t6 * t187 * t254 - t530 / 0.8e1);
  tv2rho21 = t181 + t196 + t209 + t259 + t7 * (t508 + t533);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t538 = t200 * t200;
  t542 = 0.2e1 * t124 + 0.2e1 * t373;
  t543 = my_piecewise5(t11, 0, t15, 0, t542);
  t547 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t538 + 0.4e1 / 0.3e1 * t24 * t543);
  t548 = t547 * t27;
  t554 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t72 - t500 / 0.4e1 + t397);
  t555 = t211 * t211;
  t559 = my_piecewise5(t15, 0, t11, 0, -t542);
  t563 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t555 + 0.4e1 / 0.3e1 * t81 * t559);
  t564 = t563 * t27;
  t573 = 0.1e1 / t224;
  t574 = sigma[2] * t573;
  t577 = t87 * t246;
  t580 = t91 * t91;
  t582 = 0.1e1 / t93 / t580;
  t583 = sigma[2] * t582;
  t591 = 0.1e1 / t231 / t104;
  t592 = t241 * t241;
  t593 = t591 * t592;
  t602 = sigma[2] * sigma[2];
  t605 = 0.1e1 / t92 / t580 / t224;
  t608 = 0.1e1 / t237 / t236;
  t611 = 0.784e-1 * t97 * t249 * t101 + 0.168e0 * t583 * t238 - 0.448e-1 * t602 * t605 * t608;
  t612 = t232 * t611;
  t616 = 0.9125925925925925926e-2 * t41 * t583 * t105 + 0.49777777777777777778e-2 * t41 * t227 * t242 + 0.18666666666666666666e-2 * t41 * t96 * t593 - 0.93333333333333333332e-3 * t41 * t96 * t612;
  t619 = 0.1e1 / t92 / t580;
  t620 = sigma[2] * t619;
  t624 = -t574 * t221 / 0.4e1 + t220 * t577 / 0.4e1 + t90 * t616 - 0.35e2 / 0.81e2 * t620 * t114 * t69;
  t629 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t118 - t523 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t254 + t480 - t530 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t624);
  tv2rho22 = 0.2e1 * t209 + 0.2e1 * t259 + t7 * (t554 + t629);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t637 = t6 * t137 * t286 / 0.8e1;
  t638 = t141 * t31;
  t643 = t31 * t280;
  t650 = t46 * t154;
  t658 = t39 * t40 * sigma[0];
  t659 = t46 * t419;
  t660 = t275 * t163;
  t661 = t659 * t660;
  t669 = t408 * t42;
  t671 = 0.1e1 / t43 / t669;
  t672 = t671 * t436;
  t675 = -0.168e-1 * t269 * t63 * t52 - 0.504e-1 * t148 * t160 + 0.168e-1 * t672 * sigma[0];
  t676 = t154 * t675;
  t680 = -0.24888888888888888889e-2 * t39 * t40 * t148 * t56 - 0.93333333333333333332e-3 * t41 * t650 * t163 + 0.24888888888888888889e-2 * t41 * t149 * t276 + 0.18666666666666666666e-2 * t658 * t661 - 0.93333333333333333332e-3 * t41 * t47 * t676;
  t682 = t171 * t31;
  t686 = t638 * t60 / 0.8e1 - t262 * t168 / 0.8e1 + t142 * t643 / 0.8e1 + t34 * t680 + 0.7e1 / 0.54e2 * t682 * exx[0] * t69;
  t691 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t286 - t637 - 0.3e1 / 0.8e1 * t6 * t28 * t686);
  tv2rhosigma0 = t691 * t7 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t698 = t6 * t191 * t315 / 0.8e1;
  t700 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t315 - t698);
  tv2rhosigma2 = t7 * t700 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t706 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t286 - t637);
  tv2rhosigma3 = t7 * t706 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t711 = t219 * t87;
  t716 = t87 * t309;
  t723 = t95 * t232;
  t731 = t39 * t40 * sigma[2];
  t732 = t95 * t591;
  t733 = t304 * t241;
  t734 = t732 * t733;
  t742 = t580 * t91;
  t744 = 0.1e1 / t92 / t742;
  t745 = t744 * t608;
  t748 = -0.168e-1 * t298 * t112 * t101 - 0.504e-1 * t226 * t238 + 0.168e-1 * t745 * sigma[2];
  t749 = t232 * t748;
  t753 = -0.24888888888888888889e-2 * t39 * t40 * t226 * t105 - 0.93333333333333333332e-3 * t41 * t723 * t241 + 0.24888888888888888889e-2 * t41 * t227 * t305 + 0.18666666666666666666e-2 * t731 * t734 - 0.93333333333333333332e-3 * t41 * t96 * t749;
  t755 = t249 * t87;
  t759 = t711 * t109 / 0.8e1 - t291 * t246 / 0.8e1 + t220 * t716 / 0.8e1 + t90 * t753 + 0.7e1 / 0.54e2 * t755 * exx[1] * t69;
  t764 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t315 - t698 - 0.3e1 / 0.8e1 * t6 * t84 * t759);
  tv2rhosigma5 = t7 * t764 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  t771 = t6 * t137 * t329 / 0.8e1;
  t774 = t321 * t168;
  t780 = -t142 * t322 / 0.8e1 + t30 * t774 / 0.8e1 - 0.7e1 / 0.54e2 * t172 * t325 * t69;
  t785 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t329 - t771 - 0.3e1 / 0.8e1 * t6 * t28 * t780);
  tv2rhotau0 = t7 * t785 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t792 = t6 * t191 * t343 / 0.8e1;
  t794 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t343 - t792);
  tv2rhotau1 = t7 * t794 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  t800 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t329 - t771);
  tv2rhotau2 = t7 * t800 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  t807 = t335 * t246;
  t813 = -t220 * t336 / 0.8e1 + t86 * t807 / 0.8e1 - 0.7e1 / 0.54e2 * t250 * t339 * t69;
  t818 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t343 - t792 - 0.3e1 / 0.8e1 * t6 * t84 * t813);
  tv2rhotau3 = t7 * t818 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t820 = t5 * t130;
  t821 = t820 * t349;
  t824 = t136 * sigma[0];
  t825 = t348 * t824;
  t827 = t825 * t353 / 0.48e2;
  t828 = t682 * t352;
  t832 = my_piecewise3(t2, 0, t821 * t353 / 0.16e2 + t827 - 0.7e1 / 0.48e2 * t350 * t828);
  tv2rhoexx0 = t7 * t832 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t834 = t5 * t186;
  t835 = t834 * t358;
  t838 = t136 * sigma[2];
  t839 = t357 * t838;
  t841 = t839 * t360 / 0.48e2;
  t843 = my_piecewise3(t77, 0, t835 * t360 / 0.16e2 + t841);
  tv2rhoexx1 = t7 * t843 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 1] += tv2rhoexx1;

  t845 = t5 * t203;
  t846 = t845 * t349;
  t850 = my_piecewise3(t2, 0, t846 * t353 / 0.16e2 + t827);
  tv2rhoexx2 = t7 * t850 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 2] += tv2rhoexx2;

  t852 = t5 * t214;
  t853 = t852 * t358;
  t856 = t755 * t352;
  t860 = my_piecewise3(t77, 0, t853 * t360 / 0.16e2 + t841 - 0.7e1 / 0.48e2 * t359 * t856);
  tv2rhoexx3 = t7 * t860 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 3] += tv2rhoexx3;

  t867 = t275 * t275;
  t868 = t419 * t867;
  t873 = 0.1e1 / t48 / sigma[0];
  t877 = 0.1e1 / sigma[0];
  t881 = t408 * rho[0];
  t883 = 0.1e1 / t43 / t881;
  t886 = -0.63e-2 * t873 * t50 * t52 + 0.63e-2 * t877 * t46 * t160 - 0.63e-2 * t883 * t436;
  t887 = t154 * t886;
  t891 = -0.18666666666666666666e-2 * t41 * t650 * t275 + 0.18666666666666666666e-2 * t41 * t47 * t868 - 0.93333333333333333332e-3 * t41 * t47 * t887;
  t893 = -t262 * t280 / 0.4e1 + t34 * t891;
  t897 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t893);
  tv2sigma20 = t7 * t897;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t903 = t304 * t304;
  t904 = t591 * t903;
  t909 = 0.1e1 / t97 / sigma[2];
  t913 = 0.1e1 / sigma[2];
  t917 = t580 * rho[1];
  t919 = 0.1e1 / t92 / t917;
  t922 = -0.63e-2 * t909 * t99 * t101 + 0.63e-2 * t913 * t95 * t238 - 0.63e-2 * t919 * t608;
  t923 = t232 * t922;
  t927 = -0.18666666666666666666e-2 * t41 * t723 * t304 + 0.18666666666666666666e-2 * t41 * t96 * t904 - 0.93333333333333333332e-3 * t41 * t96 * t923;
  t929 = -t291 * t309 / 0.4e1 + t90 * t927;
  t933 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t929);
  tv2sigma25 = t7 * t933;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  t934 = t29 * t321;
  t937 = t321 * t280;
  t940 = t63 * t321;
  t944 = t934 * t60 / 0.8e1 + t30 * t937 / 0.8e1 + t940 * exx[0] * t69 / 0.18e2;
  t948 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t944);
  tv2sigmatau0 = t7 * t948;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  t949 = t85 * t335;
  t952 = t335 * t309;
  t955 = t112 * t335;
  t959 = t949 * t109 / 0.8e1 + t86 * t952 / 0.8e1 + t955 * exx[1] * t69 / 0.18e2;
  t963 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t959);
  tv2sigmatau5 = t7 * t963;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t964 = t27 * t63;
  t965 = t348 * t964;
  t967 = t31 * t38 * t68;
  t970 = my_piecewise3(t2, 0, t965 * t967 / 0.16e2);
  tv2sigmaexx0 = t7 * t970;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2sigmaexx1 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 1] += tv2sigmaexx1;

  tv2sigmaexx2 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 2] += tv2sigmaexx2;

  tv2sigmaexx3 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 3] += tv2sigmaexx3;

  tv2sigmaexx4 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 4] += tv2sigmaexx4;

  t971 = t27 * t112;
  t972 = t357 * t971;
  t974 = t87 * t38 * t68;
  t977 = my_piecewise3(t77, 0, t972 * t974 / 0.16e2);
  tv2sigmaexx5 = t7 * t977;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 5] += tv2sigmaexx5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  tv2laplexx1 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 1] += tv2laplexx1;

  tv2laplexx2 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 2] += tv2laplexx2;

  tv2laplexx3 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 3] += tv2laplexx3;

  t979 = 0.1e1 / t320 / tau[0];
  t980 = t979 * t60;
  t983 = t979 * exx[0];
  t987 = -t30 * t980 / 0.4e1 - t64 * t983 * t69 / 0.9e1;
  t991 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t987);
  tv2tau20 = t7 * t991;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  t993 = 0.1e1 / t334 / tau[1];
  t994 = t993 * t109;
  t997 = t993 * exx[1];
  t1001 = -t86 * t994 / 0.4e1 - t113 * t997 * t69 / 0.9e1;
  t1005 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t1001);
  tv2tau22 = t7 * t1005;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

  t1006 = t940 * t352;
  t1009 = my_piecewise3(t2, 0, -t350 * t1006 / 0.16e2);
  tv2tauexx0 = t7 * t1009;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2tauexx1 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 1] += tv2tauexx1;

  tv2tauexx2 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 2] += tv2tauexx2;

  t1010 = t955 * t352;
  t1013 = my_piecewise3(t77, 0, -t359 * t1010 / 0.16e2);
  tv2tauexx3 = t7 * t1013;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 3] += tv2tauexx3;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

  tv2exx21 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 1] += tv2exx21;

  tv2exx22 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 2] += tv2exx22;

  t1017 = 0.1e1 / t366 / t20;
  t1018 = t368 * t127;
  t1021 = t367 * t127;
  t1024 = t123 * t123;
  t1025 = 0.1e1 / t1024;
  t1026 = t17 * t1025;
  t1028 = 0.6e1 * t372 - 0.6e1 * t1026;
  t1029 = my_piecewise5(t11, 0, t15, 0, t1028);
  t1033 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1017 * t1018 + 0.4e1 / 0.3e1 * t1021 * t376 + 0.4e1 / 0.3e1 * t24 * t1029);
  t1034 = t1033 * t27;
  t1038 = t380 * t136;
  t1040 = t6 * t1038 * t72;
  t1045 = t130 * t393;
  t1047 = t6 * t1045 * t72;
  t1050 = t6 * t385 * t176;
  t1056 = 0.1e1 / t135 / t123;
  t1057 = t26 * t1056;
  t1060 = 0.5e1 / 0.36e2 * t6 * t1057 * t72;
  t1062 = t6 * t394 * t176;
  t1065 = t6 * t137 * t452;
  t1067 = 0.1e1 / t408;
  t1068 = sigma[0] * t1067;
  t1073 = t31 * t444;
  t1077 = 0.1e1 / t44 / t881;
  t1078 = sigma[0] * t1077;
  t1091 = t153 * t153;
  t1092 = 0.1e1 / t1091;
  t1093 = t420 * t163;
  t1094 = t1092 * t1093;
  t1098 = t163 * t439;
  t1099 = t659 * t1098;
  t1107 = t408 * t408;
  t1109 = 0.1e1 / t43 / t1107;
  t1113 = t430 * sigma[0];
  t1114 = t1107 * t146;
  t1115 = 0.1e1 / t1114;
  t1117 = t158 * t158;
  t1119 = 0.1e1 / t159 / t1117;
  t1122 = -0.26133333333333333333e0 * t48 * t447 * t52 - 0.88853333333333333333e0 * t1078 * t160 + 0.55253333333333333333e0 * t430 * t1109 * t436 - 0.1792e0 * t1113 * t1115 * t1119;
  t1123 = t154 * t1122;
  t1127 = -0.42587654320987654321e-1 * t41 * t1078 * t56 - 0.27377777777777777778e-1 * t41 * t411 * t164 - 0.14933333333333333333e-1 * t41 * t149 * t421 + 0.74666666666666666667e-2 * t41 * t149 * t440 - 0.55999999999999999998e-2 * t41 * t47 * t1094 + 0.55999999999999999998e-2 * t658 * t1099 - 0.93333333333333333332e-3 * t41 * t47 * t1123;
  t1129 = sigma[0] * t883;
  t1133 = 0.3e1 / 0.4e1 * t1068 * t143 - 0.3e1 / 0.4e1 * t402 * t405 + 0.3e1 / 0.8e1 * t142 * t1073 + t34 * t1127 + 0.455e3 / 0.243e3 * t1129 * t65 * t69;
  t1138 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1034 * t72 - 0.3e1 / 0.8e1 * t1040 - 0.9e1 / 0.8e1 * t6 * t381 * t176 + t1047 / 0.4e1 - 0.3e1 / 0.4e1 * t1050 - 0.9e1 / 0.8e1 * t6 * t131 * t452 - t1060 + t1062 / 0.4e1 - 0.3e1 / 0.8e1 * t1065 - 0.3e1 / 0.8e1 * t6 * t28 * t1133);
  t1140 = 0.1e1 / t458 / t79;
  t1141 = t460 * t183;
  t1144 = t459 * t183;
  t1148 = my_piecewise5(t15, 0, t11, 0, -t1028);
  t1152 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1140 * t1141 + 0.4e1 / 0.3e1 * t1144 * t464 + 0.4e1 / 0.3e1 * t81 * t1148);
  t1153 = t1152 * t27;
  t1157 = t468 * t136;
  t1159 = t6 * t1157 * t118;
  t1161 = t186 * t393;
  t1163 = t6 * t1161 * t118;
  t1165 = t83 * t1056;
  t1168 = 0.5e1 / 0.36e2 * t6 * t1165 * t118;
  t1170 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1153 * t118 - 0.3e1 / 0.8e1 * t1159 + t1163 / 0.4e1 - t1168);
  tv3rho30 = 0.3e1 * t457 + 0.3e1 * t482 + t7 * (t1138 + t1170);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1173 = 0.2e1 * t508;
  t1174 = 0.2e1 * t533;
  t1175 = t1017 * t200;
  t1178 = t367 * t489;
  t1183 = 0.2e1 * t372;
  t1184 = 0.6e1 * t1026;
  t1185 = t1183 - t1184;
  t1186 = my_piecewise5(t11, 0, t15, 0, t1185);
  t1190 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1175 * t368 + 0.8e1 / 0.9e1 * t1178 * t127 + 0.4e1 / 0.9e1 * t485 * t376 + 0.4e1 / 0.3e1 * t24 * t1186);
  t1191 = t1190 * t27;
  t1195 = t493 * t136;
  t1198 = t6 * t1195 * t72 / 0.4e1;
  t1202 = t203 * t393;
  t1204 = t6 * t1202 * t72;
  t1208 = t6 * t498 * t176 / 0.4e1;
  t1217 = -0.3e1 / 0.8e1 * t6 * t1191 * t72 - t1198 - 0.3e1 / 0.4e1 * t6 * t494 * t176 + t1204 / 0.12e2 - t1208 - 0.3e1 / 0.8e1 * t6 * t204 * t452 - t1040 / 0.8e1 + t1047 / 0.6e1 - t1050 / 0.4e1 - t1060 + t1062 / 0.6e1 - t1065 / 0.8e1;
  t1218 = my_piecewise3(t2, 0, t1217);
  t1219 = t1140 * t211;
  t1222 = t459 * t512;
  t1228 = my_piecewise5(t15, 0, t11, 0, -t1185);
  t1232 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1219 * t460 + 0.8e1 / 0.9e1 * t1222 * t183 + 0.4e1 / 0.9e1 * t509 * t464 + 0.4e1 / 0.3e1 * t81 * t1228);
  t1233 = t1232 * t27;
  t1237 = t516 * t136;
  t1240 = t6 * t1237 * t118 / 0.4e1;
  t1241 = t214 * t393;
  t1243 = t6 * t1241 * t118;
  t1252 = t6 * t473 * t254 / 0.4e1;
  t1254 = t6 * t477 * t254;
  t1257 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1233 * t118 - t1240 + t1243 / 0.12e2 - t1159 / 0.8e1 + t1163 / 0.6e1 - t1168 - 0.3e1 / 0.8e1 * t6 * t469 * t254 - t1252 + t1254 / 0.12e2);
  tv3rho31 = t457 + t482 + t1173 + t1174 + t7 * (t1218 + t1257);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1260 = t1017 * t538;
  t1265 = t367 * t543;
  t1268 = -t1183 - t1184;
  t1269 = my_piecewise5(t11, 0, t15, 0, t1268);
  t1273 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1260 * t127 + 0.8e1 / 0.9e1 * t485 * t489 + 0.4e1 / 0.9e1 * t1265 * t127 + 0.4e1 / 0.3e1 * t24 * t1269);
  t1274 = t1273 * t27;
  t1278 = t547 * t136;
  t1280 = t6 * t1278 * t72;
  t1289 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1274 * t72 - t1280 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t548 * t176 - t1198 + t1204 / 0.6e1 - t1208 + t1047 / 0.12e2 - t1060 + t1062 / 0.12e2);
  t1290 = t1140 * t555;
  t1295 = t459 * t559;
  t1299 = my_piecewise5(t15, 0, t11, 0, -t1268);
  t1303 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1290 * t183 + 0.8e1 / 0.9e1 * t509 * t512 + 0.4e1 / 0.9e1 * t1295 * t183 + 0.4e1 / 0.3e1 * t81 * t1299);
  t1304 = t1303 * t27;
  t1308 = t563 * t136;
  t1310 = t6 * t1308 * t118;
  t1317 = t6 * t521 * t254;
  t1325 = t6 * t191 * t624;
  t1327 = -0.3e1 / 0.8e1 * t6 * t1304 * t118 - t1310 / 0.8e1 - t1240 + t1243 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t517 * t254 - t1317 / 0.4e1 + t1163 / 0.12e2 - t1168 - t1252 + t1254 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t187 * t624 - t1325 / 0.8e1;
  t1328 = my_piecewise3(t77, 0, t1327);
  tv3rho32 = t1173 + t1174 + t554 + t629 + t7 * (t1289 + t1328);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1333 = t538 * t200;
  t1339 = -0.6e1 * t372 - 0.6e1 * t1026;
  t1340 = my_piecewise5(t11, 0, t15, 0, t1339);
  t1344 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1017 * t1333 + 0.4e1 / 0.3e1 * t485 * t543 + 0.4e1 / 0.3e1 * t24 * t1340);
  t1345 = t1344 * t27;
  t1352 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1345 * t72 - 0.3e1 / 0.8e1 * t1280 + t1204 / 0.4e1 - t1060);
  t1353 = t555 * t211;
  t1359 = my_piecewise5(t15, 0, t11, 0, -t1339);
  t1363 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1140 * t1353 + 0.4e1 / 0.3e1 * t509 * t559 + 0.4e1 / 0.3e1 * t81 * t1359);
  t1364 = t1363 * t27;
  t1379 = 0.1e1 / t580;
  t1380 = sigma[2] * t1379;
  t1385 = t87 * t616;
  t1389 = 0.1e1 / t93 / t917;
  t1390 = sigma[2] * t1389;
  t1403 = t231 * t231;
  t1404 = 0.1e1 / t1403;
  t1405 = t592 * t241;
  t1406 = t1404 * t1405;
  t1410 = t241 * t611;
  t1411 = t732 * t1410;
  t1419 = t580 * t580;
  t1421 = 0.1e1 / t92 / t1419;
  t1425 = t602 * sigma[2];
  t1426 = t1419 * t224;
  t1427 = 0.1e1 / t1426;
  t1429 = t236 * t236;
  t1431 = 0.1e1 / t237 / t1429;
  t1434 = -0.26133333333333333333e0 * t97 * t619 * t101 - 0.88853333333333333333e0 * t1390 * t238 + 0.55253333333333333333e0 * t602 * t1421 * t608 - 0.1792e0 * t1425 * t1427 * t1431;
  t1435 = t232 * t1434;
  t1439 = -0.42587654320987654321e-1 * t41 * t1390 * t105 - 0.27377777777777777778e-1 * t41 * t583 * t242 - 0.14933333333333333333e-1 * t41 * t227 * t593 + 0.74666666666666666667e-2 * t41 * t227 * t612 - 0.55999999999999999998e-2 * t41 * t96 * t1406 + 0.55999999999999999998e-2 * t731 * t1411 - 0.93333333333333333332e-3 * t41 * t96 * t1435;
  t1441 = sigma[2] * t919;
  t1445 = 0.3e1 / 0.4e1 * t1380 * t221 - 0.3e1 / 0.4e1 * t574 * t577 + 0.3e1 / 0.8e1 * t220 * t1385 + t90 * t1439 + 0.455e3 / 0.243e3 * t1441 * t114 * t69;
  t1450 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1364 * t118 - 0.3e1 / 0.8e1 * t1310 - 0.9e1 / 0.8e1 * t6 * t564 * t254 + t1243 / 0.4e1 - 0.3e1 / 0.4e1 * t1317 - 0.9e1 / 0.8e1 * t6 * t215 * t624 - t1168 + t1254 / 0.4e1 - 0.3e1 / 0.8e1 * t1325 - 0.3e1 / 0.8e1 * t6 * t84 * t1445);
  tv3rho33 = 0.3e1 * t554 + 0.3e1 * t629 + t7 * (t1352 + t1450);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1458 = t6 * t385 * t286;
  t1465 = t6 * t394 * t286 / 0.12e2;
  t1467 = t6 * t137 * t686;
  t1469 = t401 * t31;
  t1478 = t31 * t680;
  t1485 = t148 * t154;
  t1498 = t148 * t419;
  t1499 = t1498 * t660;
  t1505 = t46 * t1092;
  t1506 = t275 * t420;
  t1507 = t1505 * t1506;
  t1510 = t675 * t163;
  t1511 = t659 * t1510;
  t1514 = t275 * t439;
  t1515 = t659 * t1514;
  t1523 = t433 * t436;
  t1528 = 0.1e1 / t1107 / t42 * t1119;
  t1531 = 0.392e-1 * t269 * t171 * t52 + 0.2072e0 * t410 * t160 - 0.1736e0 * t1523 * sigma[0] + 0.672e-1 * t1528 * t430;
  t1532 = t154 * t1531;
  t1536 = 0.9125925925925925926e-2 * t39 * t40 * t410 * t56 + 0.49777777777777777778e-2 * t41 * t1485 * t163 + 0.18666666666666666666e-2 * t41 * t659 * t420 - 0.93333333333333333332e-3 * t41 * t650 * t439 - 0.9125925925925925926e-2 * t41 * t411 * t276 - 0.99555555555555555554e-2 * t658 * t1499 + 0.49777777777777777778e-2 * t41 * t149 * t676 - 0.55999999999999999998e-2 * t658 * t1507 + 0.37333333333333333332e-2 * t658 * t1511 + 0.18666666666666666666e-2 * t658 * t1515 - 0.93333333333333333332e-3 * t41 * t47 * t1532;
  t1538 = t447 * t31;
  t1542 = -t1469 * t60 / 0.4e1 + t638 * t168 / 0.4e1 - t262 * t444 / 0.8e1 - t402 * t643 / 0.4e1 + t142 * t1478 / 0.4e1 + t34 * t1536 - 0.35e2 / 0.81e2 * t1538 * exx[0] * t69;
  t1547 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t286 - t1458 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t686 + t1465 - t1467 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t1542);
  tv3rho2sigma0 = t1547 * t7 + 0.2e1 * t691;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1554 = t6 * t473 * t315;
  t1558 = t6 * t477 * t315 / 0.12e2;
  t1560 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t315 - t1554 / 0.4e1 + t1558);
  tv3rho2sigma2 = t1560 * t7 + 0.2e1 * t700;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1566 = t6 * t498 * t286;
  t1574 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t286 - t1566 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t686 - t1458 / 0.8e1 + t1465 - t1467 / 0.8e1);
  tv3rho2sigma3 = t1574 * t7 + t691 + t706;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t1580 = t6 * t521 * t315;
  t1587 = t6 * t191 * t759;
  t1590 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t315 - t1580 / 0.8e1 - t1554 / 0.8e1 + t1558 - 0.3e1 / 0.8e1 * t6 * t187 * t759 - t1587 / 0.8e1);
  tv3rho2sigma5 = t1590 * t7 + t700 + t764;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t1598 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t286 - t1566 / 0.4e1 + t1465);
  tv3rho2sigma6 = t1598 * t7 + 0.2e1 * t706;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t1609 = t573 * t87;
  t1618 = t87 * t753;
  t1625 = t226 * t232;
  t1638 = t226 * t591;
  t1639 = t1638 * t733;
  t1645 = t95 * t1404;
  t1646 = t304 * t592;
  t1647 = t1645 * t1646;
  t1650 = t748 * t241;
  t1651 = t732 * t1650;
  t1654 = t304 * t611;
  t1655 = t732 * t1654;
  t1663 = t605 * t608;
  t1668 = 0.1e1 / t1419 / t91 * t1431;
  t1671 = 0.392e-1 * t298 * t249 * t101 + 0.2072e0 * t582 * t238 - 0.1736e0 * t1663 * sigma[2] + 0.672e-1 * t1668 * t602;
  t1672 = t232 * t1671;
  t1676 = 0.9125925925925925926e-2 * t39 * t40 * t582 * t105 + 0.49777777777777777778e-2 * t41 * t1625 * t241 + 0.18666666666666666666e-2 * t41 * t732 * t592 - 0.93333333333333333332e-3 * t41 * t723 * t611 - 0.9125925925925925926e-2 * t41 * t583 * t305 - 0.99555555555555555554e-2 * t731 * t1639 + 0.49777777777777777778e-2 * t41 * t227 * t749 - 0.55999999999999999998e-2 * t731 * t1647 + 0.37333333333333333332e-2 * t731 * t1651 + 0.18666666666666666666e-2 * t731 * t1655 - 0.93333333333333333332e-3 * t41 * t96 * t1672;
  t1678 = t619 * t87;
  t1682 = -t1609 * t109 / 0.4e1 + t711 * t246 / 0.4e1 - t291 * t616 / 0.8e1 - t574 * t716 / 0.4e1 + t220 * t1618 / 0.4e1 + t90 * t1676 - 0.35e2 / 0.81e2 * t1678 * exx[1] * t69;
  t1687 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t315 - t1580 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t759 + t1558 - t1587 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t1682);
  tv3rho2sigma8 = t1687 * t7 + 0.2e1 * t764;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2lapl1 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 1] += tv3rho2lapl1;

  tv3rho2lapl2 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 2] += tv3rho2lapl2;

  tv3rho2lapl3 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 3] += tv3rho2lapl3;

  tv3rho2lapl4 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 4] += tv3rho2lapl4;

  tv3rho2lapl5 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 5] += tv3rho2lapl5;

  t1694 = t6 * t385 * t329;
  t1701 = t6 * t394 * t329 / 0.12e2;
  t1703 = t6 * t137 * t780;
  t1709 = t321 * t444;
  t1715 = t402 * t322 / 0.4e1 - t142 * t774 / 0.4e1 + t30 * t1709 / 0.8e1 + 0.35e2 / 0.81e2 * t448 * t325 * t69;
  t1720 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t329 - t1694 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t780 + t1701 - t1703 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t1715);
  tv3rho2tau0 = t1720 * t7 + 0.2e1 * t785;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t1727 = t6 * t473 * t343;
  t1731 = t6 * t477 * t343 / 0.12e2;
  t1733 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t343 - t1727 / 0.4e1 + t1731);
  tv3rho2tau1 = t1733 * t7 + 0.2e1 * t794;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 1] += tv3rho2tau1;

  t1739 = t6 * t498 * t329;
  t1747 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t329 - t1739 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t780 - t1694 / 0.8e1 + t1701 - t1703 / 0.8e1);
  tv3rho2tau2 = t1747 * t7 + t785 + t800;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 2] += tv3rho2tau2;

  t1753 = t6 * t521 * t343;
  t1760 = t6 * t191 * t813;
  t1763 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t343 - t1753 / 0.8e1 - t1727 / 0.8e1 + t1731 - 0.3e1 / 0.8e1 * t6 * t187 * t813 - t1760 / 0.8e1);
  tv3rho2tau3 = t1763 * t7 + t794 + t818;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 3] += tv3rho2tau3;

  t1771 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t329 - t1739 / 0.4e1 + t1701);
  tv3rho2tau4 = t1771 * t7 + 0.2e1 * t800;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 4] += tv3rho2tau4;

  t1786 = t335 * t616;
  t1792 = t574 * t336 / 0.4e1 - t220 * t807 / 0.4e1 + t86 * t1786 / 0.8e1 + 0.35e2 / 0.81e2 * t620 * t339 * t69;
  t1797 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t343 - t1753 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t813 + t1731 - t1760 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t1792);
  tv3rho2tau5 = t1797 * t7 + 0.2e1 * t818;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 5] += tv3rho2tau5;

  t1800 = t5 * t380;
  t1801 = t1800 * t349;
  t1804 = t820 * t824;
  t1805 = t1804 * t353;
  t1809 = t393 * sigma[0];
  t1810 = t348 * t1809;
  t1812 = t1810 * t353 / 0.72e2;
  t1813 = t825 * t828;
  t1815 = t1538 * t352;
  t1819 = my_piecewise3(t2, 0, t1801 * t353 / 0.16e2 + t1805 / 0.24e2 - 0.7e1 / 0.24e2 * t821 * t828 - t1812 - 0.7e1 / 0.72e2 * t1813 + 0.35e2 / 0.72e2 * t350 * t1815);
  tv3rho2exx0 = t1819 * t7 + 0.2e1 * t832;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 0] += tv3rho2exx0;

  t1822 = t5 * t468;
  t1823 = t1822 * t358;
  t1826 = t834 * t838;
  t1827 = t1826 * t360;
  t1829 = t393 * sigma[2];
  t1830 = t357 * t1829;
  t1832 = t1830 * t360 / 0.72e2;
  t1834 = my_piecewise3(t77, 0, t1823 * t360 / 0.16e2 + t1827 / 0.24e2 - t1832);
  tv3rho2exx1 = t1834 * t7 + 0.2e1 * t843;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 1] += tv3rho2exx1;

  t1836 = t5 * t493;
  t1837 = t1836 * t349;
  t1840 = t845 * t824;
  t1841 = t1840 * t353;
  t1848 = my_piecewise3(t2, 0, t1837 * t353 / 0.16e2 + t1841 / 0.48e2 - 0.7e1 / 0.48e2 * t846 * t828 + t1805 / 0.48e2 - t1812 - 0.7e1 / 0.144e3 * t1813);
  tv3rho2exx2 = t1848 * t7 + t832 + t850;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 2] += tv3rho2exx2;

  t1850 = t5 * t516;
  t1851 = t1850 * t358;
  t1854 = t852 * t838;
  t1855 = t1854 * t360;
  t1860 = t839 * t856;
  t1863 = my_piecewise3(t77, 0, t1851 * t360 / 0.16e2 + t1855 / 0.48e2 + t1827 / 0.48e2 - t1832 - 0.7e1 / 0.48e2 * t835 * t856 - 0.7e1 / 0.144e3 * t1860);
  tv3rho2exx3 = t1863 * t7 + t843 + t860;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 3] += tv3rho2exx3;

  t1866 = t5 * t547;
  t1867 = t1866 * t349;
  t1872 = my_piecewise3(t2, 0, t1867 * t353 / 0.16e2 + t1841 / 0.24e2 - t1812);
  tv3rho2exx4 = t1872 * t7 + 0.2e1 * t850;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 4] += tv3rho2exx4;

  t1875 = t5 * t563;
  t1876 = t1875 * t358;
  t1883 = t1678 * t352;
  t1887 = my_piecewise3(t77, 0, t1876 * t360 / 0.16e2 + t1855 / 0.24e2 - 0.7e1 / 0.24e2 * t853 * t856 - t1832 - 0.7e1 / 0.72e2 * t1860 + 0.35e2 / 0.72e2 * t359 * t1883);
  tv3rho2exx5 = t1887 * t7 + 0.2e1 * t860;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 5] += tv3rho2exx5;

  t1894 = t6 * t137 * t893 / 0.8e1;
  t1899 = t31 * t891;
  t1913 = t867 * t163;
  t1914 = t1505 * t1913;
  t1917 = t275 * t675;
  t1918 = t659 * t1917;
  t1924 = t886 * t163;
  t1925 = t659 * t1924;
  t1935 = t1107 * rho[0];
  t1937 = 0.1e1 / t1935 * t1119;
  t1940 = 0.84e-2 * t873 * t63 * t52 - 0.84e-2 * t877 * t148 * t160 + 0.42e-1 * t672 - 0.252e-1 * t1937 * sigma[0];
  t1941 = t154 * t1940;
  t1945 = 0.49777777777777777776e-2 * t41 * t1485 * t275 + 0.37333333333333333332e-2 * t41 * t661 - 0.18666666666666666666e-2 * t41 * t650 * t675 - 0.49777777777777777776e-2 * t41 * t149 * t868 - 0.55999999999999999998e-2 * t658 * t1914 + 0.37333333333333333332e-2 * t658 * t1918 + 0.24888888888888888889e-2 * t41 * t149 * t887 + 0.18666666666666666666e-2 * t658 * t1925 - 0.93333333333333333332e-3 * t41 * t47 * t1941;
  t1947 = t638 * t280 / 0.4e1 - t262 * t680 / 0.4e1 + t142 * t1899 / 0.8e1 + t34 * t1945;
  t1952 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t893 - t1894 - 0.3e1 / 0.8e1 * t6 * t28 * t1947);
  tv3rhosigma20 = t1952 * t7 + t897;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t1959 = t6 * t191 * t929 / 0.8e1;
  t1961 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t929 - t1959);
  tv3rhosigma25 = t1961 * t7 + t933;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t1967 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t893 - t1894);
  tv3rhosigma26 = t1967 * t7 + t897;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t1976 = t87 * t927;
  t1990 = t903 * t241;
  t1991 = t1645 * t1990;
  t1994 = t304 * t748;
  t1995 = t732 * t1994;
  t2001 = t922 * t241;
  t2002 = t732 * t2001;
  t2012 = t1419 * rho[1];
  t2014 = 0.1e1 / t2012 * t1431;
  t2017 = 0.84e-2 * t909 * t112 * t101 - 0.84e-2 * t913 * t226 * t238 + 0.42e-1 * t745 - 0.252e-1 * t2014 * sigma[2];
  t2018 = t232 * t2017;
  t2022 = 0.49777777777777777776e-2 * t41 * t1625 * t304 + 0.37333333333333333332e-2 * t41 * t734 - 0.18666666666666666666e-2 * t41 * t723 * t748 - 0.49777777777777777776e-2 * t41 * t227 * t904 - 0.55999999999999999998e-2 * t731 * t1991 + 0.37333333333333333332e-2 * t731 * t1995 + 0.24888888888888888889e-2 * t41 * t227 * t923 + 0.18666666666666666666e-2 * t731 * t2002 - 0.93333333333333333332e-3 * t41 * t96 * t2018;
  t2024 = t711 * t309 / 0.4e1 - t291 * t753 / 0.4e1 + t220 * t1976 / 0.8e1 + t90 * t2022;
  t2029 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t929 - t1959 - 0.3e1 / 0.8e1 * t6 * t84 * t2024);
  tv3rhosigma211 = t2029 * t7 + t933;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  tv3rhosigmalapl5 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  tv3rhosigmalapl6 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  tv3rhosigmalapl11 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  t2036 = t6 * t137 * t944 / 0.8e1;
  t2037 = t141 * t321;
  t2044 = t321 * t680;
  t2047 = t171 * t321;
  t2051 = -t2037 * t60 / 0.8e1 + t934 * t168 / 0.8e1 - t142 * t937 / 0.8e1 + t30 * t2044 / 0.8e1 - 0.7e1 / 0.54e2 * t2047 * exx[0] * t69;
  t2056 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t944 - t2036 - 0.3e1 / 0.8e1 * t6 * t28 * t2051);
  tv3rhosigmatau0 = t2056 * t7 + t948;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 4] += tv3rhosigmatau4;

  t2063 = t6 * t191 * t959 / 0.8e1;
  t2065 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t959 - t2063);
  tv3rhosigmatau5 = t2065 * t7 + t963;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 5] += tv3rhosigmatau5;

  t2071 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t944 - t2036);
  tv3rhosigmatau6 = t2071 * t7 + t948;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 10] += tv3rhosigmatau10;

  t2076 = t219 * t335;
  t2083 = t335 * t753;
  t2086 = t249 * t335;
  t2090 = -t2076 * t109 / 0.8e1 + t949 * t246 / 0.8e1 - t220 * t952 / 0.8e1 + t86 * t2083 / 0.8e1 - 0.7e1 / 0.54e2 * t2086 * exx[1] * t69;
  t2095 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t959 - t2063 - 0.3e1 / 0.8e1 * t6 * t84 * t2090);
  tv3rhosigmatau11 = t2095 * t7 + t963;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2097 = t820 * t964;
  t2100 = t136 * t63;
  t2101 = t348 * t2100;
  t2103 = t2101 * t967 / 0.48e2;
  t2104 = t27 * t171;
  t2105 = t348 * t2104;
  t2109 = my_piecewise3(t2, 0, t2097 * t967 / 0.16e2 + t2103 - 0.7e1 / 0.48e2 * t2105 * t967);
  tv3rhosigmaexx0 = t2109 * t7 + t970;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 0] += tv3rhosigmaexx0;

  tv3rhosigmaexx1 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 1] += tv3rhosigmaexx1;

  tv3rhosigmaexx2 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 2] += tv3rhosigmaexx2;

  tv3rhosigmaexx3 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 3] += tv3rhosigmaexx3;

  tv3rhosigmaexx4 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 4] += tv3rhosigmaexx4;

  t2111 = t834 * t971;
  t2114 = t136 * t112;
  t2115 = t357 * t2114;
  t2117 = t2115 * t974 / 0.48e2;
  t2119 = my_piecewise3(t77, 0, t2111 * t974 / 0.16e2 + t2117);
  tv3rhosigmaexx5 = t2119 * t7 + t977;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 5] += tv3rhosigmaexx5;

  t2121 = t845 * t964;
  t2125 = my_piecewise3(t2, 0, t2121 * t967 / 0.16e2 + t2103);
  tv3rhosigmaexx6 = t2125 * t7 + t970;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 6] += tv3rhosigmaexx6;

  tv3rhosigmaexx7 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 7] += tv3rhosigmaexx7;

  tv3rhosigmaexx8 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 8] += tv3rhosigmaexx8;

  tv3rhosigmaexx9 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 9] += tv3rhosigmaexx9;

  tv3rhosigmaexx10 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 10] += tv3rhosigmaexx10;

  t2127 = t852 * t971;
  t2130 = t27 * t249;
  t2131 = t357 * t2130;
  t2135 = my_piecewise3(t77, 0, t2127 * t974 / 0.16e2 + t2117 - 0.7e1 / 0.48e2 * t2131 * t974);
  tv3rhosigmaexx11 = t2135 * t7 + t977;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 11] += tv3rhosigmaexx11;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 1] += tv3rholapl21;

  tv3rholapl22 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 2] += tv3rholapl22;

  tv3rholapl23 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 4] += tv3rholapl24;

  tv3rholapl25 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 7] += tv3rholapltau7;

  tv3rholaplexx0 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 0] += tv3rholaplexx0;

  tv3rholaplexx1 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 1] += tv3rholaplexx1;

  tv3rholaplexx2 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 2] += tv3rholaplexx2;

  tv3rholaplexx3 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 3] += tv3rholaplexx3;

  tv3rholaplexx4 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 4] += tv3rholaplexx4;

  tv3rholaplexx5 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 5] += tv3rholaplexx5;

  tv3rholaplexx6 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 6] += tv3rholaplexx6;

  tv3rholaplexx7 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 7] += tv3rholaplexx7;

  t2142 = t6 * t137 * t987 / 0.8e1;
  t2145 = t979 * t168;
  t2151 = t142 * t980 / 0.4e1 - t30 * t2145 / 0.4e1 + 0.7e1 / 0.27e2 * t172 * t983 * t69;
  t2156 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t987 - t2142 - 0.3e1 / 0.8e1 * t6 * t28 * t2151);
  tv3rhotau20 = t2156 * t7 + t991;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 1] += tv3rhotau21;

  t2163 = t6 * t191 * t1001 / 0.8e1;
  t2165 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t1001 - t2163);
  tv3rhotau22 = t2165 * t7 + t1005;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 2] += tv3rhotau22;

  t2171 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t987 - t2142);
  tv3rhotau23 = t2171 * t7 + t991;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 4] += tv3rhotau24;

  t2178 = t993 * t246;
  t2184 = t220 * t994 / 0.4e1 - t86 * t2178 / 0.4e1 + 0.7e1 / 0.27e2 * t250 * t997 * t69;
  t2189 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t1001 - t2163 - 0.3e1 / 0.8e1 * t6 * t84 * t2184);
  tv3rhotau25 = t2189 * t7 + t1005;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 5] += tv3rhotau25;

  t2194 = t825 * t1006 / 0.48e2;
  t2195 = t2047 * t352;
  t2199 = my_piecewise3(t2, 0, -t821 * t1006 / 0.16e2 - t2194 + 0.7e1 / 0.48e2 * t350 * t2195);
  tv3rhotauexx0 = t2199 * t7 + t1009;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 0] += tv3rhotauexx0;

  tv3rhotauexx1 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 1] += tv3rhotauexx1;

  tv3rhotauexx2 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 2] += tv3rhotauexx2;

  t2204 = t839 * t1010 / 0.48e2;
  t2206 = my_piecewise3(t77, 0, -t835 * t1010 / 0.16e2 - t2204);
  tv3rhotauexx3 = t2206 * t7 + t1013;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 3] += tv3rhotauexx3;

  t2211 = my_piecewise3(t2, 0, -t846 * t1006 / 0.16e2 - t2194);
  tv3rhotauexx4 = t2211 * t7 + t1009;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 4] += tv3rhotauexx4;

  tv3rhotauexx5 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 5] += tv3rhotauexx5;

  tv3rhotauexx6 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 6] += tv3rhotauexx6;

  t2215 = t2086 * t352;
  t2219 = my_piecewise3(t77, 0, -t853 * t1010 / 0.16e2 - t2204 + 0.7e1 / 0.48e2 * t359 * t2215);
  tv3rhotauexx7 = t2219 * t7 + t1013;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 7] += tv3rhotauexx7;

  tv3rhoexx20 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 0] += tv3rhoexx20;

  tv3rhoexx21 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 1] += tv3rhoexx21;

  tv3rhoexx22 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 2] += tv3rhoexx22;

  tv3rhoexx23 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 3] += tv3rhoexx23;

  tv3rhoexx24 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 4] += tv3rhoexx24;

  tv3rhoexx25 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 5] += tv3rhoexx25;

  t2229 = t867 * t275;
  t2230 = t1092 * t2229;
  t2234 = t275 * t886;
  t2239 = 0.1e1 / t48 / t430;
  t2243 = 0.1e1 / t430;
  t2253 = 0.945e-2 * t2239 * t50 * t52 - 0.945e-2 * t2243 * t46 * t160 - 0.315e-2 * t877 * t883 * t436 + 0.945e-2 / t1107 * t1119;
  t2254 = t154 * t2253;
  t2258 = 0.55999999999999999998e-2 * t41 * t659 * t867 - 0.27999999999999999999e-2 * t41 * t650 * t886 - 0.55999999999999999998e-2 * t41 * t47 * t2230 + 0.55999999999999999998e-2 * t658 * t659 * t2234 - 0.93333333333333333332e-3 * t41 * t47 * t2254;
  t2260 = -0.3e1 / 0.8e1 * t262 * t891 + t34 * t2258;
  t2264 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2260);
  tv3sigma30 = t7 * t2264;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t2273 = t903 * t304;
  t2274 = t1404 * t2273;
  t2278 = t304 * t922;
  t2283 = 0.1e1 / t97 / t602;
  t2287 = 0.1e1 / t602;
  t2297 = 0.945e-2 * t2283 * t99 * t101 - 0.945e-2 * t2287 * t95 * t238 - 0.315e-2 * t913 * t919 * t608 + 0.945e-2 / t1419 * t1431;
  t2298 = t232 * t2297;
  t2302 = 0.55999999999999999998e-2 * t41 * t732 * t903 - 0.27999999999999999999e-2 * t41 * t723 * t922 - 0.55999999999999999998e-2 * t41 * t96 * t2274 + 0.55999999999999999998e-2 * t731 * t732 * t2278 - 0.93333333333333333332e-3 * t41 * t96 * t2298;
  t2304 = -0.3e1 / 0.8e1 * t291 * t927 + t90 * t2302;
  t2308 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2304);
  tv3sigma39 = t7 * t2308;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 10] += tv3sigma2lapl10;

  tv3sigma2lapl11 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 11] += tv3sigma2lapl11;

  t2311 = t321 * t891;
  t2314 = t934 * t280 / 0.4e1 + t30 * t2311 / 0.8e1;
  t2318 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2314);
  tv3sigma2tau0 = t7 * t2318;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 10] += tv3sigma2tau10;

  t2321 = t335 * t927;
  t2324 = t949 * t309 / 0.4e1 + t86 * t2321 / 0.8e1;
  t2328 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2324);
  tv3sigma2tau11 = t7 * t2328;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 11] += tv3sigma2tau11;

  tv3sigma2exx0 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 0] += tv3sigma2exx0;

  tv3sigma2exx1 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 1] += tv3sigma2exx1;

  tv3sigma2exx2 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 2] += tv3sigma2exx2;

  tv3sigma2exx3 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 3] += tv3sigma2exx3;

  tv3sigma2exx4 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 4] += tv3sigma2exx4;

  tv3sigma2exx5 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 5] += tv3sigma2exx5;

  tv3sigma2exx6 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 6] += tv3sigma2exx6;

  tv3sigma2exx7 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 7] += tv3sigma2exx7;

  tv3sigma2exx8 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 8] += tv3sigma2exx8;

  tv3sigma2exx9 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 9] += tv3sigma2exx9;

  tv3sigma2exx10 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 10] += tv3sigma2exx10;

  tv3sigma2exx11 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 11] += tv3sigma2exx11;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 7] += tv3sigmalapl27;

  tv3sigmalapl28 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmalaplexx0 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 0] += tv3sigmalaplexx0;

  tv3sigmalaplexx1 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 1] += tv3sigmalaplexx1;

  tv3sigmalaplexx2 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 2] += tv3sigmalaplexx2;

  tv3sigmalaplexx3 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 3] += tv3sigmalaplexx3;

  tv3sigmalaplexx4 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 4] += tv3sigmalaplexx4;

  tv3sigmalaplexx5 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 5] += tv3sigmalaplexx5;

  tv3sigmalaplexx6 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 6] += tv3sigmalaplexx6;

  tv3sigmalaplexx7 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 7] += tv3sigmalaplexx7;

  tv3sigmalaplexx8 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 8] += tv3sigmalaplexx8;

  tv3sigmalaplexx9 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 9] += tv3sigmalaplexx9;

  tv3sigmalaplexx10 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 10] += tv3sigmalaplexx10;

  tv3sigmalaplexx11 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 11] += tv3sigmalaplexx11;

  t2329 = t29 * t979;
  t2332 = t979 * t280;
  t2335 = t63 * t979;
  t2339 = -t2329 * t60 / 0.4e1 - t30 * t2332 / 0.4e1 - t2335 * exx[0] * t69 / 0.9e1;
  t2343 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2339);
  tv3sigmatau20 = t7 * t2343;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 7] += tv3sigmatau27;

  t2344 = t85 * t993;
  t2347 = t993 * t309;
  t2350 = t112 * t993;
  t2354 = -t2344 * t109 / 0.4e1 - t86 * t2347 / 0.4e1 - t2350 * exx[1] * t69 / 0.9e1;
  t2358 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2354);
  tv3sigmatau28 = t7 * t2358;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 8] += tv3sigmatau28;

  t2360 = t321 * t38 * t68;
  t2363 = my_piecewise3(t2, 0, -t965 * t2360 / 0.16e2);
  tv3sigmatauexx0 = t7 * t2363;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 0] += tv3sigmatauexx0;

  tv3sigmatauexx1 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 1] += tv3sigmatauexx1;

  tv3sigmatauexx2 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 2] += tv3sigmatauexx2;

  tv3sigmatauexx3 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 3] += tv3sigmatauexx3;

  tv3sigmatauexx4 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 4] += tv3sigmatauexx4;

  tv3sigmatauexx5 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 5] += tv3sigmatauexx5;

  tv3sigmatauexx6 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 6] += tv3sigmatauexx6;

  tv3sigmatauexx7 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 7] += tv3sigmatauexx7;

  tv3sigmatauexx8 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 8] += tv3sigmatauexx8;

  tv3sigmatauexx9 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 9] += tv3sigmatauexx9;

  tv3sigmatauexx10 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 10] += tv3sigmatauexx10;

  t2365 = t335 * t38 * t68;
  t2368 = my_piecewise3(t77, 0, -t972 * t2365 / 0.16e2);
  tv3sigmatauexx11 = t7 * t2368;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 11] += tv3sigmatauexx11;

  tv3sigmaexx20 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 0] += tv3sigmaexx20;

  tv3sigmaexx21 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 1] += tv3sigmaexx21;

  tv3sigmaexx22 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 2] += tv3sigmaexx22;

  tv3sigmaexx23 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 3] += tv3sigmaexx23;

  tv3sigmaexx24 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 4] += tv3sigmaexx24;

  tv3sigmaexx25 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 5] += tv3sigmaexx25;

  tv3sigmaexx26 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 6] += tv3sigmaexx26;

  tv3sigmaexx27 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 7] += tv3sigmaexx27;

  tv3sigmaexx28 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 8] += tv3sigmaexx28;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 2] += tv3lapl32;

  tv3lapl33 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapl2exx0 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 0] += tv3lapl2exx0;

  tv3lapl2exx1 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 1] += tv3lapl2exx1;

  tv3lapl2exx2 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 2] += tv3lapl2exx2;

  tv3lapl2exx3 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 3] += tv3lapl2exx3;

  tv3lapl2exx4 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 4] += tv3lapl2exx4;

  tv3lapl2exx5 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 5] += tv3lapl2exx5;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 5] += tv3lapltau25;

  tv3lapltauexx0 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 0] += tv3lapltauexx0;

  tv3lapltauexx1 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 1] += tv3lapltauexx1;

  tv3lapltauexx2 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 2] += tv3lapltauexx2;

  tv3lapltauexx3 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 3] += tv3lapltauexx3;

  tv3lapltauexx4 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 4] += tv3lapltauexx4;

  tv3lapltauexx5 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 5] += tv3lapltauexx5;

  tv3lapltauexx6 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 6] += tv3lapltauexx6;

  tv3lapltauexx7 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 7] += tv3lapltauexx7;

  tv3laplexx20 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 0] += tv3laplexx20;

  tv3laplexx21 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 1] += tv3laplexx21;

  tv3laplexx22 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 2] += tv3laplexx22;

  tv3laplexx23 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 3] += tv3laplexx23;

  tv3laplexx24 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 4] += tv3laplexx24;

  tv3laplexx25 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 5] += tv3laplexx25;

  t2369 = t320 * t320;
  t2370 = 0.1e1 / t2369;
  t2382 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.4e1 * t30 * t2370 * t60 + t64 * t2370 * exx[0] * t69 / 0.3e1));
  tv3tau30 = t7 * t2382;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 2] += tv3tau32;

  t2383 = t334 * t334;
  t2384 = 0.1e1 / t2383;
  t2396 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.4e1 * t86 * t2384 * t109 + t113 * t2384 * exx[1] * t69 / 0.3e1));
  tv3tau33 = t7 * t2396;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 3] += tv3tau33;

  t2397 = t2335 * t352;
  t2400 = my_piecewise3(t2, 0, t350 * t2397 / 0.8e1);
  tv3tau2exx0 = t7 * t2400;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 0] += tv3tau2exx0;

  tv3tau2exx1 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 1] += tv3tau2exx1;

  tv3tau2exx2 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 2] += tv3tau2exx2;

  tv3tau2exx3 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 3] += tv3tau2exx3;

  tv3tau2exx4 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 4] += tv3tau2exx4;

  t2401 = t2350 * t352;
  t2404 = my_piecewise3(t77, 0, t359 * t2401 / 0.8e1);
  tv3tau2exx5 = t7 * t2404;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 5] += tv3tau2exx5;

  tv3tauexx20 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 0] += tv3tauexx20;

  tv3tauexx21 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 1] += tv3tauexx21;

  tv3tauexx22 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 2] += tv3tauexx22;

  tv3tauexx23 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 3] += tv3tauexx23;

  tv3tauexx24 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 4] += tv3tauexx24;

  tv3tauexx25 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 5] += tv3tauexx25;

  tv3exx30 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 0] += tv3exx30;

  tv3exx31 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 1] += tv3exx31;

  tv3exx32 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 2] += tv3exx32;

  tv3exx33 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 3] += tv3exx33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t34, t35, t37, t38, t39, t40, t41;
  double t42, t43, t44, t46, t47, t48, t50, t51;
  double t52, t55, t56, t60, t63, t64, t65, t67;
  double t68, t69, t72, t76, t77, t78, t79, t80;
  double t81, t83, t84, t85, t86, t87, t90, t91;
  double t92, t93, t95, t96, t97, t99, t100, t101;
  double t104, t105, t109, t112, t113, t114, t118, t122;
  double tzk0;

  double t123, t124, t125, t126, t127, t130, t131, t135;
  double t136, t137, t140, t141, t142, t143, t146, t148;
  double t149, t153, t154, t158, t159, t160, t163, t164;
  double t168, t171, t172, t176, t181, t183, t186, t187;
  double t191, t194, t196, tvrho0, t199, t200, t203, t204;
  double t209, t211, t214, t215, t219, t220, t221, t224;
  double t226, t227, t231, t232, t236, t237, t238, t241;
  double t242, t246, t249, t250, t254, t259, tvrho1, t262;
  double t269, t275, t276, t280, t282, t286, t290, tvsigma0;
  double tvsigma1, t291, t298, t304, t305, t309, t311, t315;
  double t319, tvsigma2, tvlapl0, tvlapl1, t320, t321, t322, t325;
  double t329, t333, tvtau0, t334, t335, t336, t339, t343;
  double t347, tvtau1, t348, t349, t350, t352, t353, t356;
  double tvexx0, t357, t358, t359, t360, t363, tvexx1;

  double t366, t367, t368, t371, t372, t373, t375, t376;
  double t380, t381, t385, t387, t393, t394, t397, t399;
  double t401, t402, t405, t408, t410, t411, t419, t420;
  double t421, t430, t433, t436, t439, t440, t444, t447;
  double t448, t452, t457, t458, t459, t460, t464, t468;
  double t469, t473, t475, t477, t480, t482, tv2rho20, t485;
  double t488, t489, t493, t494, t498, t500, t508, t509;
  double t512, t516, t517, t521, t523, t530, t533, tv2rho21;
  double t538, t542, t543, t547, t548, t554, t555, t559;
  double t563, t564, t573, t574, t577, t580, t582, t583;
  double t591, t592, t593, t602, t605, t608, t611, t612;
  double t616, t619, t620, t624, t629, tv2rho22, t637, t638;
  double t643, t650, t658, t659, t660, t661, t669, t671;
  double t672, t675, t676, t680, t682, t686, t691, tv2rhosigma0;
  double tv2rhosigma1, t698, t700, tv2rhosigma2, t706, tv2rhosigma3, tv2rhosigma4, t711;
  double t716, t723, t731, t732, t733, t734, t742, t744;
  double t745, t748, t749, t753, t755, t759, t764, tv2rhosigma5;
  double tv2rholapl0, tv2rholapl1, tv2rholapl2, tv2rholapl3, t771, t774, t780, t785;
  double tv2rhotau0, t792, t794, tv2rhotau1, t800, tv2rhotau2, t807, t813;
  double t818, tv2rhotau3, t820, t821, t824, t825, t827, t828;
  double t832, tv2rhoexx0, t834, t835, t838, t839, t841, t843;
  double tv2rhoexx1, t845, t846, t850, tv2rhoexx2, t852, t853, t856;
  double t860, tv2rhoexx3, t867, t868, t873, t877, t881, t883;
  double t886, t887, t891, t893, t897, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t903, t904, t909, t913, t917, t919;
  double t922, t923, t927, t929, t933, tv2sigma25, tv2sigmalapl0, tv2sigmalapl1;
  double tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t934, t937, t940, t944;
  double t948, tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t949, t952;
  double t955, t959, t963, tv2sigmatau5, t964, t965, t967, t970;
  double tv2sigmaexx0, tv2sigmaexx1, tv2sigmaexx2, tv2sigmaexx3, tv2sigmaexx4, t971, t972, t974;
  double t977, tv2sigmaexx5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2;
  double tv2lapltau3, tv2laplexx0, tv2laplexx1, tv2laplexx2, tv2laplexx3, t979, t980, t983;
  double t987, t991, tv2tau20, tv2tau21, t993, t994, t997, t1001;
  double t1005, tv2tau22, t1006, t1009, tv2tauexx0, tv2tauexx1, tv2tauexx2, t1010;
  double t1013, tv2tauexx3, tv2exx20, tv2exx21, tv2exx22;

  double t1017, t1018, t1021, t1024, t1025, t1026, t1028, t1029;
  double t1033, t1034, t1038, t1040, t1045, t1047, t1050, t1056;
  double t1057, t1060, t1062, t1065, t1067, t1068, t1073, t1077;
  double t1078, t1091, t1092, t1093, t1094, t1098, t1099, t1107;
  double t1109, t1113, t1114, t1115, t1117, t1119, t1122, t1123;
  double t1127, t1129, t1133, t1138, t1140, t1141, t1144, t1148;
  double t1152, t1153, t1157, t1159, t1161, t1163, t1165, t1168;
  double t1170, tv3rho30, t1173, t1174, t1175, t1178, t1183, t1184;
  double t1185, t1186, t1190, t1191, t1195, t1198, t1202, t1204;
  double t1208, t1217, t1218, t1219, t1222, t1228, t1232, t1233;
  double t1237, t1240, t1241, t1243, t1252, t1254, t1257, tv3rho31;
  double t1260, t1265, t1268, t1269, t1273, t1274, t1278, t1280;
  double t1289, t1290, t1295, t1299, t1303, t1304, t1308, t1310;
  double t1317, t1325, t1327, t1328, tv3rho32, t1333, t1339, t1340;
  double t1344, t1345, t1352, t1353, t1359, t1363, t1364, t1379;
  double t1380, t1385, t1389, t1390, t1403, t1404, t1405, t1406;
  double t1410, t1411, t1419, t1421, t1425, t1426, t1427, t1429;
  double t1431, t1434, t1435, t1439, t1441, t1445, t1450, tv3rho33;
  double t1458, t1465, t1467, t1469, t1478, t1485, t1498, t1499;
  double t1505, t1506, t1507, t1510, t1511, t1514, t1515, t1523;
  double t1528, t1531, t1532, t1536, t1538, t1542, t1547, tv3rho2sigma0;
  double tv3rho2sigma1, t1554, t1558, t1560, tv3rho2sigma2, t1566, t1574, tv3rho2sigma3;
  double tv3rho2sigma4, t1580, t1587, t1590, tv3rho2sigma5, t1598, tv3rho2sigma6, tv3rho2sigma7;
  double t1609, t1618, t1625, t1638, t1639, t1645, t1646, t1647;
  double t1650, t1651, t1654, t1655, t1663, t1668, t1671, t1672;
  double t1676, t1678, t1682, t1687, tv3rho2sigma8, tv3rho2lapl0, tv3rho2lapl1, tv3rho2lapl2;
  double tv3rho2lapl3, tv3rho2lapl4, tv3rho2lapl5, t1694, t1701, t1703, t1709, t1715;
  double t1720, tv3rho2tau0, t1727, t1731, t1733, tv3rho2tau1, t1739, t1747;
  double tv3rho2tau2, t1753, t1760, t1763, tv3rho2tau3, t1771, tv3rho2tau4, t1786;
  double t1792, t1797, tv3rho2tau5, t1800, t1801, t1804, t1805, t1809;
  double t1810, t1812, t1813, t1815, t1819, tv3rho2exx0, t1822, t1823;
  double t1826, t1827, t1829, t1830, t1832, t1834, tv3rho2exx1, t1836;
  double t1837, t1840, t1841, t1848, tv3rho2exx2, t1850, t1851, t1854;
  double t1855, t1860, t1863, tv3rho2exx3, t1866, t1867, t1872, tv3rho2exx4;
  double t1875, t1876, t1883, t1887, tv3rho2exx5, t1894, t1899, t1913;
  double t1914, t1917, t1918, t1924, t1925, t1935, t1937, t1940;
  double t1941, t1945, t1947, t1952, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t1959, t1961, tv3rhosigma25, t1967, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t1976, t1990, t1991, t1994, t1995, t2001;
  double t2002, t2012, t2014, t2017, t2018, t2022, t2024, t2029;
  double tv3rhosigma211, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4, tv3rhosigmalapl5, tv3rhosigmalapl6;
  double tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, tv3rhosigmalapl11, t2036, t2037, t2044;
  double t2047, t2051, t2056, tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4;
  double t2063, t2065, tv3rhosigmatau5, t2071, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9;
  double tv3rhosigmatau10, t2076, t2083, t2086, t2090, t2095, tv3rhosigmatau11, t2097;
  double t2100, t2101, t2103, t2104, t2105, t2109, tv3rhosigmaexx0, tv3rhosigmaexx1;
  double tv3rhosigmaexx2, tv3rhosigmaexx3, tv3rhosigmaexx4, t2111, t2114, t2115, t2117, t2119;
  double tv3rhosigmaexx5, t2121, t2125, tv3rhosigmaexx6, tv3rhosigmaexx7, tv3rhosigmaexx8, tv3rhosigmaexx9, tv3rhosigmaexx10;
  double t2127, t2130, t2131, t2135, tv3rhosigmaexx11, tv3rholapl20, tv3rholapl21, tv3rholapl22;
  double tv3rholapl23, tv3rholapl24, tv3rholapl25, tv3rholapltau0, tv3rholapltau1, tv3rholapltau2, tv3rholapltau3, tv3rholapltau4;
  double tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, tv3rholaplexx0, tv3rholaplexx1, tv3rholaplexx2, tv3rholaplexx3, tv3rholaplexx4;
  double tv3rholaplexx5, tv3rholaplexx6, tv3rholaplexx7, t2142, t2145, t2151, t2156, tv3rhotau20;
  double tv3rhotau21, t2163, t2165, tv3rhotau22, t2171, tv3rhotau23, tv3rhotau24, t2178;
  double t2184, t2189, tv3rhotau25, t2194, t2195, t2199, tv3rhotauexx0, tv3rhotauexx1;
  double tv3rhotauexx2, t2204, t2206, tv3rhotauexx3, t2211, tv3rhotauexx4, tv3rhotauexx5, tv3rhotauexx6;
  double t2215, t2219, tv3rhotauexx7, tv3rhoexx20, tv3rhoexx21, tv3rhoexx22, tv3rhoexx23, tv3rhoexx24;
  double tv3rhoexx25, t2229, t2230, t2234, t2239, t2243, t2253, t2254;
  double t2258, t2260, t2264, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2273, t2274, t2278, t2283;
  double t2287, t2297, t2298, t2302, t2304, t2308, tv3sigma39, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, tv3sigma2lapl11, t2311, t2314, t2318, tv3sigma2tau0, tv3sigma2tau1;
  double tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9;
  double tv3sigma2tau10, t2321, t2324, t2328, tv3sigma2tau11, tv3sigma2exx0, tv3sigma2exx1, tv3sigma2exx2;
  double tv3sigma2exx3, tv3sigma2exx4, tv3sigma2exx5, tv3sigma2exx6, tv3sigma2exx7, tv3sigma2exx8, tv3sigma2exx9, tv3sigma2exx10;
  double tv3sigma2exx11, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22, tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26;
  double tv3sigmalapl27, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1, tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5;
  double tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9, tv3sigmalapltau10, tv3sigmalapltau11, tv3sigmalaplexx0, tv3sigmalaplexx1;
  double tv3sigmalaplexx2, tv3sigmalaplexx3, tv3sigmalaplexx4, tv3sigmalaplexx5, tv3sigmalaplexx6, tv3sigmalaplexx7, tv3sigmalaplexx8, tv3sigmalaplexx9;
  double tv3sigmalaplexx10, tv3sigmalaplexx11, t2329, t2332, t2335, t2339, t2343, tv3sigmatau20;
  double tv3sigmatau21, tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, t2344;
  double t2347, t2350, t2354, t2358, tv3sigmatau28, t2360, t2363, tv3sigmatauexx0;
  double tv3sigmatauexx1, tv3sigmatauexx2, tv3sigmatauexx3, tv3sigmatauexx4, tv3sigmatauexx5, tv3sigmatauexx6, tv3sigmatauexx7, tv3sigmatauexx8;
  double tv3sigmatauexx9, tv3sigmatauexx10, t2365, t2368, tv3sigmatauexx11, tv3sigmaexx20, tv3sigmaexx21, tv3sigmaexx22;
  double tv3sigmaexx23, tv3sigmaexx24, tv3sigmaexx25, tv3sigmaexx26, tv3sigmaexx27, tv3sigmaexx28, tv3lapl30, tv3lapl31;
  double tv3lapl32, tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5;
  double tv3lapl2exx0, tv3lapl2exx1, tv3lapl2exx2, tv3lapl2exx3, tv3lapl2exx4, tv3lapl2exx5, tv3lapltau20, tv3lapltau21;
  double tv3lapltau22, tv3lapltau23, tv3lapltau24, tv3lapltau25, tv3lapltauexx0, tv3lapltauexx1, tv3lapltauexx2, tv3lapltauexx3;
  double tv3lapltauexx4, tv3lapltauexx5, tv3lapltauexx6, tv3lapltauexx7, tv3laplexx20, tv3laplexx21, tv3laplexx22, tv3laplexx23;
  double tv3laplexx24, tv3laplexx25, t2369, t2370, t2382, tv3tau30, tv3tau31, tv3tau32;
  double t2383, t2384, t2396, tv3tau33, t2397, t2400, tv3tau2exx0, tv3tau2exx1;
  double tv3tau2exx2, tv3tau2exx3, tv3tau2exx4, t2401, t2404, tv3tau2exx5, tv3tauexx20, tv3tauexx21;
  double tv3tauexx22, tv3tauexx23, tv3tauexx24, tv3tauexx25, tv3exx30, tv3exx31, tv3exx32, tv3exx33;

  double t2408, t2423, t2446, t2447, t2456, t2475, t2480, t2487;
  double t2495, t2509, t2512, t2514, t2516, t2517, t2523, t2530;
  double t2532, t2533, t2537, t2546, t2552, t2554, t2557, t2561;
  double t2564, t2568, t2572, t2574, t2575, t2576, t2578, t2579;
  double t2585, t2591, t2595, t2602, t2606, t2610, t2615, t2617;
  double tv4rho40, t2624, t2628, t2632, t2633, t2635, t2636, t2638;
  double t2659, t2660, t2661, t2662, t2666, t2675, t2689, t2690;
  double t2708, t2712, t2719, t2723, t2724, t2727, t2736, t2739;
  double t2740, t2742, t2744, t2745, tv4rho41, t2760, t2773, t2777;
  double t2786, t2793, t2797, t2810, t2811, t2820, t2833, t2837;
  double t2844, t2848, t2857, t2860, t2871, t2874, t2876, t2877;
  double tv4rho42, t2897, t2898, t2902, t2909, t2920, t2921, t2938;
  double t2942, t2949, t2957, t2966, t2976, t2978, t2979, tv4rho43;
  double t2984, t2989, t2995, t2996, t3000, t3009, t3023, t3046;
  double t3047, t3056, t3075, t3080, t3087, t3095, t3108, t3113;
  double t3119, t3123, t3142, t3143, tv4rho44, t3151, t3157, t3160;
  double t3167, t3169, t3172, t3252, t3270, t3274, t3283, t3286;
  double t3295, tv4rho3sigma0, tv4rho3sigma1, t3302, t3305, t3309, t3311, tv4rho3sigma2;
  double t3313, t3319, t3324, t3328, t3337, t3338, tv4rho3sigma3, tv4rho3sigma4;
  double t3340, t3346, t3348, t3357, t3359, t3362, tv4rho3sigma5, t3368;
  double t3377, tv4rho3sigma6, tv4rho3sigma7, t3383, t3390, t3398, t3400, t3401;
  double tv4rho3sigma8, t3410, tv4rho3sigma9, tv4rho3sigma10, t3443, t3447, t3529, t3536;
  double t3539, t3548, tv4rho3sigma11, tv4rho3lapl0, tv4rho3lapl1, tv4rho3lapl2, tv4rho3lapl3, tv4rho3lapl4;
  double tv4rho3lapl5, tv4rho3lapl6, tv4rho3lapl7, t3555, t3561, t3564, t3571, t3573;
  double t3576, t3595, tv4rho3tau0, t3602, t3605, t3609, t3611, tv4rho3tau1;
  double t3613, t3619, t3624, t3628, t3637, t3638, tv4rho3tau2, t3640;
  double t3646, t3648, t3657, t3659, t3662, tv4rho3tau3, t3668, t3677;
  double tv4rho3tau4, t3683, t3690, t3698, t3700, t3701, tv4rho3tau5, t3710;
  double tv4rho3tau6, t3744, tv4rho3tau7, t3752, t3757, t3759, t3766, t3767;
  double t3769, t3775, tv4rho3exx0, t3783, t3786, t3791, t3793, tv4rho3exx1;
  double t3795, t3802, t3806, t3809, t3817, t3818, tv4rho3exx2, t3820;
  double t3827, t3829, t3836, t3837, t3840, tv4rho3exx3, t3847, t3855;
  double tv4rho3exx4, t3862, t3867, t3873, t3875, t3876, tv4rho3exx5, t3886;
  double tv4rho3exx6, t3906, tv4rho3exx7, t3913, t3920, t3922, t3980, t3988;
  double t4023, t4031, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t4038;
  double t4042, t4044, tv4rho2sigma25, t4050, t4058, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t4064, t4071, t4074, tv4rho2sigma211, t4082, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t4131, t4143, t4192, t4200;
  double tv4rho2sigma217, tv4rho2sigmalapl0, tv4rho2sigmalapl1, tv4rho2sigmalapl2, tv4rho2sigmalapl3, tv4rho2sigmalapl4, tv4rho2sigmalapl5, tv4rho2sigmalapl6;
  double tv4rho2sigmalapl7, tv4rho2sigmalapl8, tv4rho2sigmalapl9, tv4rho2sigmalapl10, tv4rho2sigmalapl11, tv4rho2sigmalapl12, tv4rho2sigmalapl13, tv4rho2sigmalapl14;
  double tv4rho2sigmalapl15, tv4rho2sigmalapl16, tv4rho2sigmalapl17, t4207, t4214, t4216, t4232, t4241;
  double tv4rho2sigmatau0, tv4rho2sigmatau1, tv4rho2sigmatau2, tv4rho2sigmatau3, tv4rho2sigmatau4, t4248, t4252, t4254;
  double tv4rho2sigmatau5, t4260, t4268, tv4rho2sigmatau6, tv4rho2sigmatau7, tv4rho2sigmatau8, tv4rho2sigmatau9, tv4rho2sigmatau10;
  double t4274, t4281, t4284, tv4rho2sigmatau11, t4292, tv4rho2sigmatau12, tv4rho2sigmatau13, tv4rho2sigmatau14;
  double tv4rho2sigmatau15, tv4rho2sigmatau16, t4317, t4326, tv4rho2sigmatau17, t4333, t4341, t4344;
  double t4351, tv4rho2sigmaexx0, tv4rho2sigmaexx1, tv4rho2sigmaexx2, tv4rho2sigmaexx3, tv4rho2sigmaexx4, t4358, t4363;
  double t4365, tv4rho2sigmaexx5, t4371, t4379, tv4rho2sigmaexx6, tv4rho2sigmaexx7, tv4rho2sigmaexx8, tv4rho2sigmaexx9;
  double tv4rho2sigmaexx10, t4385, t4393, t4396, tv4rho2sigmaexx11, t4404, tv4rho2sigmaexx12, tv4rho2sigmaexx13;
  double tv4rho2sigmaexx14, tv4rho2sigmaexx15, tv4rho2sigmaexx16, t4420, tv4rho2sigmaexx17, tv4rho2lapl20, tv4rho2lapl21, tv4rho2lapl22;
  double tv4rho2lapl23, tv4rho2lapl24, tv4rho2lapl25, tv4rho2lapl26, tv4rho2lapl27, tv4rho2lapl28, tv4rho2lapltau0, tv4rho2lapltau1;
  double tv4rho2lapltau2, tv4rho2lapltau3, tv4rho2lapltau4, tv4rho2lapltau5, tv4rho2lapltau6, tv4rho2lapltau7, tv4rho2lapltau8, tv4rho2lapltau9;
  double tv4rho2lapltau10, tv4rho2lapltau11, tv4rho2laplexx0, tv4rho2laplexx1, tv4rho2laplexx2, tv4rho2laplexx3, tv4rho2laplexx4, tv4rho2laplexx5;
  double tv4rho2laplexx6, tv4rho2laplexx7, tv4rho2laplexx8, tv4rho2laplexx9, tv4rho2laplexx10, tv4rho2laplexx11, t4427, t4434;
  double t4436, t4453, tv4rho2tau20, tv4rho2tau21, t4460, t4464, t4466, tv4rho2tau22;
  double t4472, t4480, tv4rho2tau23, tv4rho2tau24, t4486, t4493, t4496, tv4rho2tau25;
  double t4504, tv4rho2tau26, tv4rho2tau27, t4530, tv4rho2tau28, t4535, t4540, t4541;
  double t4547, tv4rho2tauexx0, tv4rho2tauexx1, tv4rho2tauexx2, t4552, t4555, t4557, tv4rho2tauexx3;
  double t4561, t4568, tv4rho2tauexx4, tv4rho2tauexx5, tv4rho2tauexx6, t4572, t4577, t4580;
  double tv4rho2tauexx7, t4587, tv4rho2tauexx8, tv4rho2tauexx9, tv4rho2tauexx10, t4600, tv4rho2tauexx11, tv4rho2exx20;
  double tv4rho2exx21, tv4rho2exx22, tv4rho2exx23, tv4rho2exx24, tv4rho2exx25, tv4rho2exx26, tv4rho2exx27, tv4rho2exx28;
  double t4607, t4683, t4690, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34;
  double tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t4697, t4699, tv4rhosigma39, t4705;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t4785, t4792, tv4rhosigma319, tv4rhosigma2lapl0, tv4rhosigma2lapl1, tv4rhosigma2lapl2, tv4rhosigma2lapl3;
  double tv4rhosigma2lapl4, tv4rhosigma2lapl5, tv4rhosigma2lapl6, tv4rhosigma2lapl7, tv4rhosigma2lapl8, tv4rhosigma2lapl9, tv4rhosigma2lapl10, tv4rhosigma2lapl11;
  double tv4rhosigma2lapl12, tv4rhosigma2lapl13, tv4rhosigma2lapl14, tv4rhosigma2lapl15, tv4rhosigma2lapl16, tv4rhosigma2lapl17, tv4rhosigma2lapl18, tv4rhosigma2lapl19;
  double tv4rhosigma2lapl20, tv4rhosigma2lapl21, tv4rhosigma2lapl22, tv4rhosigma2lapl23, t4799, t4814, tv4rhosigma2tau0, tv4rhosigma2tau1;
  double tv4rhosigma2tau2, tv4rhosigma2tau3, tv4rhosigma2tau4, tv4rhosigma2tau5, tv4rhosigma2tau6, tv4rhosigma2tau7, tv4rhosigma2tau8, tv4rhosigma2tau9;
  double tv4rhosigma2tau10, t4821, t4823, tv4rhosigma2tau11, t4829, tv4rhosigma2tau12, tv4rhosigma2tau13, tv4rhosigma2tau14;
  double tv4rhosigma2tau15, tv4rhosigma2tau16, tv4rhosigma2tau17, tv4rhosigma2tau18, tv4rhosigma2tau19, tv4rhosigma2tau20, tv4rhosigma2tau21, tv4rhosigma2tau22;
  double t4848, tv4rhosigma2tau23, tv4rhosigma2exx0, tv4rhosigma2exx1, tv4rhosigma2exx2, tv4rhosigma2exx3, tv4rhosigma2exx4, tv4rhosigma2exx5;
  double tv4rhosigma2exx6, tv4rhosigma2exx7, tv4rhosigma2exx8, tv4rhosigma2exx9, tv4rhosigma2exx10, tv4rhosigma2exx11, tv4rhosigma2exx12, tv4rhosigma2exx13;
  double tv4rhosigma2exx14, tv4rhosigma2exx15, tv4rhosigma2exx16, tv4rhosigma2exx17, tv4rhosigma2exx18, tv4rhosigma2exx19, tv4rhosigma2exx20, tv4rhosigma2exx21;
  double tv4rhosigma2exx22, tv4rhosigma2exx23, tv4rhosigmalapl20, tv4rhosigmalapl21, tv4rhosigmalapl22, tv4rhosigmalapl23, tv4rhosigmalapl24, tv4rhosigmalapl25;
  double tv4rhosigmalapl26, tv4rhosigmalapl27, tv4rhosigmalapl28, tv4rhosigmalapl29, tv4rhosigmalapl210, tv4rhosigmalapl211, tv4rhosigmalapl212, tv4rhosigmalapl213;
  double tv4rhosigmalapl214, tv4rhosigmalapl215, tv4rhosigmalapl216, tv4rhosigmalapl217, tv4rhosigmalapltau0, tv4rhosigmalapltau1, tv4rhosigmalapltau2, tv4rhosigmalapltau3;
  double tv4rhosigmalapltau4, tv4rhosigmalapltau5, tv4rhosigmalapltau6, tv4rhosigmalapltau7, tv4rhosigmalapltau8, tv4rhosigmalapltau9, tv4rhosigmalapltau10, tv4rhosigmalapltau11;
  double tv4rhosigmalapltau12, tv4rhosigmalapltau13, tv4rhosigmalapltau14, tv4rhosigmalapltau15, tv4rhosigmalapltau16, tv4rhosigmalapltau17, tv4rhosigmalapltau18, tv4rhosigmalapltau19;
  double tv4rhosigmalapltau20, tv4rhosigmalapltau21, tv4rhosigmalapltau22, tv4rhosigmalapltau23, tv4rhosigmalaplexx0, tv4rhosigmalaplexx1, tv4rhosigmalaplexx2, tv4rhosigmalaplexx3;
  double tv4rhosigmalaplexx4, tv4rhosigmalaplexx5, tv4rhosigmalaplexx6, tv4rhosigmalaplexx7, tv4rhosigmalaplexx8, tv4rhosigmalaplexx9, tv4rhosigmalaplexx10, tv4rhosigmalaplexx11;
  double tv4rhosigmalaplexx12, tv4rhosigmalaplexx13, tv4rhosigmalaplexx14, tv4rhosigmalaplexx15, tv4rhosigmalaplexx16, tv4rhosigmalaplexx17, tv4rhosigmalaplexx18, tv4rhosigmalaplexx19;
  double tv4rhosigmalaplexx20, tv4rhosigmalaplexx21, tv4rhosigmalaplexx22, tv4rhosigmalaplexx23, t4855, t4866, t4875, tv4rhosigmatau20;
  double tv4rhosigmatau21, tv4rhosigmatau22, tv4rhosigmatau23, tv4rhosigmatau24, tv4rhosigmatau25, tv4rhosigmatau26, tv4rhosigmatau27, t4882;
  double t4884, tv4rhosigmatau28, t4890, tv4rhosigmatau29, tv4rhosigmatau210, tv4rhosigmatau211, tv4rhosigmatau212, tv4rhosigmatau213;
  double tv4rhosigmatau214, tv4rhosigmatau215, tv4rhosigmatau216, t4905, t4914, tv4rhosigmatau217, t4919, t4923;
  double tv4rhosigmatauexx0, tv4rhosigmatauexx1, tv4rhosigmatauexx2, tv4rhosigmatauexx3, tv4rhosigmatauexx4, tv4rhosigmatauexx5, tv4rhosigmatauexx6, tv4rhosigmatauexx7;
  double tv4rhosigmatauexx8, tv4rhosigmatauexx9, tv4rhosigmatauexx10, t4928, t4930, tv4rhosigmatauexx11, t4935, tv4rhosigmatauexx12;
  double tv4rhosigmatauexx13, tv4rhosigmatauexx14, tv4rhosigmatauexx15, tv4rhosigmatauexx16, tv4rhosigmatauexx17, tv4rhosigmatauexx18, tv4rhosigmatauexx19, tv4rhosigmatauexx20;
  double tv4rhosigmatauexx21, tv4rhosigmatauexx22, t4942, tv4rhosigmatauexx23, tv4rhosigmaexx20, tv4rhosigmaexx21, tv4rhosigmaexx22, tv4rhosigmaexx23;
  double tv4rhosigmaexx24, tv4rhosigmaexx25, tv4rhosigmaexx26, tv4rhosigmaexx27, tv4rhosigmaexx28, tv4rhosigmaexx29, tv4rhosigmaexx210, tv4rhosigmaexx211;
  double tv4rhosigmaexx212, tv4rhosigmaexx213, tv4rhosigmaexx214, tv4rhosigmaexx215, tv4rhosigmaexx216, tv4rhosigmaexx217, tv4rholapl30, tv4rholapl31;
  double tv4rholapl32, tv4rholapl33, tv4rholapl34, tv4rholapl35, tv4rholapl36, tv4rholapl37, tv4rholapl2tau0, tv4rholapl2tau1;
  double tv4rholapl2tau2, tv4rholapl2tau3, tv4rholapl2tau4, tv4rholapl2tau5, tv4rholapl2tau6, tv4rholapl2tau7, tv4rholapl2tau8, tv4rholapl2tau9;
  double tv4rholapl2tau10, tv4rholapl2tau11, tv4rholapl2exx0, tv4rholapl2exx1, tv4rholapl2exx2, tv4rholapl2exx3, tv4rholapl2exx4, tv4rholapl2exx5;
  double tv4rholapl2exx6, tv4rholapl2exx7, tv4rholapl2exx8, tv4rholapl2exx9, tv4rholapl2exx10, tv4rholapl2exx11, tv4rholapltau20, tv4rholapltau21;
  double tv4rholapltau22, tv4rholapltau23, tv4rholapltau24, tv4rholapltau25, tv4rholapltau26, tv4rholapltau27, tv4rholapltau28, tv4rholapltau29;
  double tv4rholapltau210, tv4rholapltau211, tv4rholapltauexx0, tv4rholapltauexx1, tv4rholapltauexx2, tv4rholapltauexx3, tv4rholapltauexx4, tv4rholapltauexx5;
  double tv4rholapltauexx6, tv4rholapltauexx7, tv4rholapltauexx8, tv4rholapltauexx9, tv4rholapltauexx10, tv4rholapltauexx11, tv4rholapltauexx12, tv4rholapltauexx13;
  double tv4rholapltauexx14, tv4rholapltauexx15, tv4rholaplexx2v4rhotau30, tv4rholaplexx2v4rhotau31, tv4rholaplexx2v4rhotau32, tv4rholaplexx2v4rhotau33, tv4rholaplexx2v4rhotau34, tv4rholaplexx2v4rhotau35;
  double tv4rholaplexx2v4rhotau36, tv4rholaplexx2v4rhotau37, tv4rholaplexx2v4rhotau38, tv4rholaplexx2v4rhotau39, tv4rholaplexx2v4rhotau310, tv4rholaplexx2v4rhotau311, tv4rholaplexx2v4rhotau312, tv4rholaplexx2v4rhotau313;
  double tv4rholaplexx2v4rhotau314, tv4rholaplexx2v4rhotau315, tv4rholaplexx2v4rhotau316, tv4rholaplexx2v4rhotau317, tv4rholaplexx2v4rhotau318, tv4rholaplexx2v4rhotau319, tv4rholaplexx2v4rhotau320, tv4rholaplexx2v4rhotau321;
  double tv4rholaplexx2v4rhotau322, tv4rholaplexx2v4rhotau323, tv4rholaplexx2v4rhotau324, tv4rholaplexx2v4rhotau325, tv4rholaplexx2v4rhotau326, tv4rholaplexx2v4rhotau327, tv4rholaplexx2v4rhotau328, tv4rholaplexx2v4rhotau329;
  double tv4rholaplexx2v4rhotau330, tv4rholaplexx2v4rhotau331, tv4rholaplexx2v4rhotau332, tv4rholaplexx2v4rhotau333, tv4rholaplexx2v4rhotau334, tv4rholaplexx2v4rhotau335, tv4rholaplexx2v4rhotau336, tv4rholaplexx2v4rhotau337;
  double tv4rholaplexx2v4rhotau338, tv4rholaplexx2v4rhotau339, tv4rholaplexx2v4rhotau340, tv4rholaplexx2v4rhotau341, tv4rholaplexx2v4rhotau342, tv4rholaplexx2v4rhotau343, tv4rholaplexx2v4rhotau344, tv4rholaplexx2v4rhotau345;
  double tv4rholaplexx2v4rhotau346, tv4rholaplexx2v4rhotau347, t4947, t4952, tv4rhotau2exx0, tv4rhotau2exx1, tv4rhotau2exx2, tv4rhotau2exx3;
  double tv4rhotau2exx4, t4957, t4959, tv4rhotau2exx5, t4964, tv4rhotau2exx6, tv4rhotau2exx7, tv4rhotau2exx8;
  double tv4rhotau2exx9, tv4rhotau2exx10, t4972, tv4rhotau2exx11, tv4rhotauexx20, tv4rhotauexx21, tv4rhotauexx22, tv4rhotauexx23;
  double tv4rhotauexx24, tv4rhotauexx25, tv4rhotauexx26, tv4rhotauexx27, tv4rhotauexx28, tv4rhotauexx29, tv4rhotauexx210, tv4rhotauexx211;
  double tv4rhoexx3v4sigma40, tv4rhoexx3v4sigma41, tv4rhoexx3v4sigma42, tv4rhoexx3v4sigma43, tv4rhoexx3v4sigma44, tv4rhoexx3v4sigma45, tv4rhoexx3v4sigma46, tv4rhoexx3v4sigma47;
  double tv4rhoexx3v4sigma48, tv4rhoexx3v4sigma49, tv4rhoexx3v4sigma410, tv4rhoexx3v4sigma411, tv4rhoexx3v4sigma412, tv4rhoexx3v4sigma413, tv4rhoexx3v4sigma414, tv4rhoexx3v4sigma415;
  double tv4rhoexx3v4sigma416, tv4rhoexx3v4sigma417, tv4rhoexx3v4sigma418, tv4rhoexx3v4sigma419, tv4rhoexx3v4sigma420, tv4rhoexx3v4sigma421, tv4rhoexx3v4sigma422, tv4rhoexx3v4sigma423;
  double tv4rhoexx3v4sigma424, tv4rhoexx3v4sigma425, tv4rhoexx3v4sigma426, tv4rhoexx3v4sigma427, tv4rhoexx3v4sigma428, tv4rhoexx3v4sigma429, tv4rhoexx3v4sigma430, tv4rhoexx3v4sigma431;
  double tv4rhoexx3v4sigma432, tv4rhoexx3v4sigma433, tv4rhoexx3v4sigma434, tv4rhoexx3v4sigma435, tv4rhoexx3v4sigma436, tv4rhoexx3v4sigma437, tv4rhoexx3v4sigma438, tv4rhoexx3v4sigma439;
  double tv4rhoexx3v4sigma440, tv4rhoexx3v4sigma441, tv4rhoexx3v4sigma442, tv4rhoexx3v4sigma443, tv4rhoexx3v4sigma444, tv4rhoexx3v4sigma445, tv4rhoexx3v4sigma446, tv4rhoexx3v4sigma447;
  double tv4rhoexx3v4sigma448, tv4rhoexx3v4sigma449, tv4rhoexx3v4sigma450, tv4rhoexx3v4sigma451, tv4rhoexx3v4sigma452, tv4rhoexx3v4sigma453, tv4rhoexx3v4sigma454, tv4rhoexx3v4sigma455;
  double tv4rhoexx3v4sigma456, tv4rhoexx3v4sigma457, tv4rhoexx3v4sigma458, tv4rhoexx3v4sigma459, tv4rhoexx3v4sigma460, tv4rhoexx3v4sigma461, tv4rhoexx3v4sigma462, tv4rhoexx3v4sigma463;
  double tv4rhoexx3v4sigma464, tv4rhoexx3v4sigma465, tv4rhoexx3v4sigma466, tv4rhoexx3v4sigma467, tv4rhoexx3v4sigma468, tv4rhoexx3v4sigma469, tv4rhoexx3v4sigma470, tv4rhoexx3v4sigma471;
  double tv4rhoexx3v4sigma472, tv4rhoexx3v4sigma473, tv4rhoexx3v4sigma474, tv4rhoexx3v4sigma475, tv4rhoexx3v4sigma476, tv4rhoexx3v4sigma477, tv4rhoexx3v4sigma478, tv4rhoexx3v4sigma479;
  double tv4rhoexx3v4sigma480, tv4rhoexx3v4sigma481, tv4rhoexx3v4sigma482, tv4rhoexx3v4sigma483, tv4rhoexx3v4sigma484, tv4rhoexx3v4sigma485, tv4rhoexx3v4sigma486, tv4rhoexx3v4sigma487;
  double tv4rhoexx3v4sigma488, tv4rhoexx3v4sigma489, tv4rhoexx3v4sigma490, tv4rhoexx3v4sigma491, tv4rhoexx3v4sigma492, tv4rhoexx3v4sigma493, tv4rhoexx3v4sigma494, tv4rhoexx3v4sigma495;
  double tv4rhoexx3v4sigma496, tv4rhoexx3v4sigma497, tv4rhoexx3v4sigma498, tv4rhoexx3v4sigma499, tv4rhoexx3v4sigma4100, tv4rhoexx3v4sigma4101, tv4rhoexx3v4sigma4102, tv4rhoexx3v4sigma4103;
  double tv4rhoexx3v4sigma4104, tv4rhoexx3v4sigma4105, tv4rhoexx3v4sigma4106, tv4rhoexx3v4sigma4107, tv4rhoexx3v4sigma4108, tv4rhoexx3v4sigma4109, tv4rhoexx3v4sigma4110, tv4rhoexx3v4sigma4111;
  double tv4rhoexx3v4sigma4112, tv4rhoexx3v4sigma4113, tv4rhoexx3v4sigma4114, tv4rhoexx3v4sigma4115, tv4rhoexx3v4sigma4116, tv4rhoexx3v4sigma4117, tv4rhoexx3v4sigma4118, tv4rhoexx3v4sigma4119;
  double tv4sigma3lapl0, tv4sigma3lapl1, tv4sigma3lapl2, tv4sigma3lapl3, tv4sigma3lapl4, tv4sigma3lapl5, tv4sigma3lapl6, tv4sigma3lapl7;
  double tv4sigma3lapl8, tv4sigma3lapl9, tv4sigma3lapl10, tv4sigma3lapl11, tv4sigma3lapl12, tv4sigma3lapl13, tv4sigma3lapl14, tv4sigma3lapl15;
  double tv4sigma3lapl16, tv4sigma3lapl17, tv4sigma3lapl18, tv4sigma3lapl19, t4983, tv4sigma3tau0, tv4sigma3tau1, tv4sigma3tau2;
  double tv4sigma3tau3, tv4sigma3tau4, tv4sigma3tau5, tv4sigma3tau6, tv4sigma3tau7, tv4sigma3tau8, tv4sigma3tau9, tv4sigma3tau10;
  double tv4sigma3tau11, tv4sigma3tau12, tv4sigma3tau13, tv4sigma3tau14, tv4sigma3tau15, tv4sigma3tau16, tv4sigma3tau17, tv4sigma3tau18;
  double t4993, tv4sigma3tau19, tv4sigma3exx0, tv4sigma3exx1, tv4sigma3exx2, tv4sigma3exx3, tv4sigma3exx4, tv4sigma3exx5;
  double tv4sigma3exx6, tv4sigma3exx7, tv4sigma3exx8, tv4sigma3exx9, tv4sigma3exx10, tv4sigma3exx11, tv4sigma3exx12, tv4sigma3exx13;
  double tv4sigma3exx14, tv4sigma3exx15, tv4sigma3exx16, tv4sigma3exx17, tv4sigma3exx18, tv4sigma3exx19, tv4sigma2lapl20, tv4sigma2lapl21;
  double tv4sigma2lapl22, tv4sigma2lapl23, tv4sigma2lapl24, tv4sigma2lapl25, tv4sigma2lapl26, tv4sigma2lapl27, tv4sigma2lapl28, tv4sigma2lapl29;
  double tv4sigma2lapl210, tv4sigma2lapl211, tv4sigma2lapl212, tv4sigma2lapl213, tv4sigma2lapl214, tv4sigma2lapl215, tv4sigma2lapl216, tv4sigma2lapl217;
  double tv4sigma2lapltau0, tv4sigma2lapltau1, tv4sigma2lapltau2, tv4sigma2lapltau3, tv4sigma2lapltau4, tv4sigma2lapltau5, tv4sigma2lapltau6, tv4sigma2lapltau7;
  double tv4sigma2lapltau8, tv4sigma2lapltau9, tv4sigma2lapltau10, tv4sigma2lapltau11, tv4sigma2lapltau12, tv4sigma2lapltau13, tv4sigma2lapltau14, tv4sigma2lapltau15;
  double tv4sigma2lapltau16, tv4sigma2lapltau17, tv4sigma2lapltau18, tv4sigma2lapltau19, tv4sigma2lapltau20, tv4sigma2lapltau21, tv4sigma2lapltau22, tv4sigma2lapltau23;
  double tv4sigma2laplexx0, tv4sigma2laplexx1, tv4sigma2laplexx2, tv4sigma2laplexx3, tv4sigma2laplexx4, tv4sigma2laplexx5, tv4sigma2laplexx6, tv4sigma2laplexx7;
  double tv4sigma2laplexx8, tv4sigma2laplexx9, tv4sigma2laplexx10, tv4sigma2laplexx11, tv4sigma2laplexx12, tv4sigma2laplexx13, tv4sigma2laplexx14, tv4sigma2laplexx15;
  double tv4sigma2laplexx16, tv4sigma2laplexx17, tv4sigma2laplexx18, tv4sigma2laplexx19, tv4sigma2laplexx20, tv4sigma2laplexx21, tv4sigma2laplexx22, tv4sigma2laplexx23;
  double t5003, tv4sigma2tau20, tv4sigma2tau21, tv4sigma2tau22, tv4sigma2tau23, tv4sigma2tau24, tv4sigma2tau25, tv4sigma2tau26;
  double tv4sigma2tau27, tv4sigma2tau28, tv4sigma2tau29, tv4sigma2tau210, tv4sigma2tau211, tv4sigma2tau212, tv4sigma2tau213, tv4sigma2tau214;
  double tv4sigma2tau215, tv4sigma2tau216, t5013, tv4sigma2tau217, tv4sigma2tauexx0, tv4sigma2tauexx1, tv4sigma2tauexx2, tv4sigma2tauexx3;
  double tv4sigma2tauexx4, tv4sigma2tauexx5, tv4sigma2tauexx6, tv4sigma2tauexx7, tv4sigma2tauexx8, tv4sigma2tauexx9, tv4sigma2tauexx10, tv4sigma2tauexx11;
  double tv4sigma2tauexx12, tv4sigma2tauexx13, tv4sigma2tauexx14, tv4sigma2tauexx15, tv4sigma2tauexx16, tv4sigma2tauexx17, tv4sigma2tauexx18, tv4sigma2tauexx19;
  double tv4sigma2tauexx20, tv4sigma2tauexx21, tv4sigma2tauexx22, tv4sigma2tauexx23, tv4sigma2exx20, tv4sigma2exx21, tv4sigma2exx22, tv4sigma2exx23;
  double tv4sigma2exx24, tv4sigma2exx25, tv4sigma2exx26, tv4sigma2exx27, tv4sigma2exx28, tv4sigma2exx29, tv4sigma2exx210, tv4sigma2exx211;
  double tv4sigma2exx212, tv4sigma2exx213, tv4sigma2exx214, tv4sigma2exx215, tv4sigma2exx216, tv4sigma2exx217, tv4sigmalapl30, tv4sigmalapl31;
  double tv4sigmalapl32, tv4sigmalapl33, tv4sigmalapl34, tv4sigmalapl35, tv4sigmalapl36, tv4sigmalapl37, tv4sigmalapl38, tv4sigmalapl39;
  double tv4sigmalapl310, tv4sigmalapl311, tv4sigmalapl2tau0, tv4sigmalapl2tau1, tv4sigmalapl2tau2, tv4sigmalapl2tau3, tv4sigmalapl2tau4, tv4sigmalapl2tau5;
  double tv4sigmalapl2tau6, tv4sigmalapl2tau7, tv4sigmalapl2tau8, tv4sigmalapl2tau9, tv4sigmalapl2tau10, tv4sigmalapl2tau11, tv4sigmalapl2tau12, tv4sigmalapl2tau13;
  double tv4sigmalapl2tau14, tv4sigmalapl2tau15, tv4sigmalapl2tau16, tv4sigmalapl2tau17, tv4sigmalapl2exx0, tv4sigmalapl2exx1, tv4sigmalapl2exx2, tv4sigmalapl2exx3;
  double tv4sigmalapl2exx4, tv4sigmalapl2exx5, tv4sigmalapl2exx6, tv4sigmalapl2exx7, tv4sigmalapl2exx8, tv4sigmalapl2exx9, tv4sigmalapl2exx10, tv4sigmalapl2exx11;
  double tv4sigmalapl2exx12, tv4sigmalapl2exx13, tv4sigmalapl2exx14, tv4sigmalapl2exx15, tv4sigmalapl2exx16, tv4sigmalapl2exx17, tv4sigmalapltau20, tv4sigmalapltau21;
  double tv4sigmalapltau22, tv4sigmalapltau23, tv4sigmalapltau24, tv4sigmalapltau25, tv4sigmalapltau26, tv4sigmalapltau27, tv4sigmalapltau28, tv4sigmalapltau29;
  double tv4sigmalapltau210, tv4sigmalapltau211, tv4sigmalapltau212, tv4sigmalapltau213, tv4sigmalapltau214, tv4sigmalapltau215, tv4sigmalapltau216, tv4sigmalapltau217;
  double tv4sigmalapltauexx0, tv4sigmalapltauexx1, tv4sigmalapltauexx2, tv4sigmalapltauexx3, tv4sigmalapltauexx4, tv4sigmalapltauexx5, tv4sigmalapltauexx6, tv4sigmalapltauexx7;
  double tv4sigmalapltauexx8, tv4sigmalapltauexx9, tv4sigmalapltauexx10, tv4sigmalapltauexx11, tv4sigmalapltauexx12, tv4sigmalapltauexx13, tv4sigmalapltauexx14, tv4sigmalapltauexx15;
  double tv4sigmalapltauexx16, tv4sigmalapltauexx17, tv4sigmalapltauexx18, tv4sigmalapltauexx19, tv4sigmalapltauexx20, tv4sigmalapltauexx21, tv4sigmalapltauexx22, tv4sigmalapltauexx23;
  double tv4sigmalaplexx20, tv4sigmalaplexx21, tv4sigmalaplexx22, tv4sigmalaplexx23, tv4sigmalaplexx24, tv4sigmalaplexx25, tv4sigmalaplexx26, tv4sigmalaplexx27;
  double tv4sigmalaplexx28, tv4sigmalaplexx29, tv4sigmalaplexx210, tv4sigmalaplexx211, tv4sigmalaplexx212, tv4sigmalaplexx213, tv4sigmalaplexx214, tv4sigmalaplexx215;
  double tv4sigmalaplexx216, tv4sigmalaplexx217, t5020, t5028, tv4sigmatau30, tv4sigmatau31, tv4sigmatau32, tv4sigmatau33;
  double tv4sigmatau34, tv4sigmatau35, tv4sigmatau36, tv4sigmatau37, tv4sigmatau38, tv4sigmatau39, tv4sigmatau310, t5035;
  double t5043, tv4sigmatau311, t5048, tv4sigmatau2exx0, tv4sigmatau2exx1, tv4sigmatau2exx2, tv4sigmatau2exx3, tv4sigmatau2exx4;
  double tv4sigmatau2exx5, tv4sigmatau2exx6, tv4sigmatau2exx7, tv4sigmatau2exx8, tv4sigmatau2exx9, tv4sigmatau2exx10, tv4sigmatau2exx11, tv4sigmatau2exx12;
  double tv4sigmatau2exx13, tv4sigmatau2exx14, tv4sigmatau2exx15, tv4sigmatau2exx16, t5053, tv4sigmatau2exx17, tv4sigmatauexx20, tv4sigmatauexx21;
  double tv4sigmatauexx22, tv4sigmatauexx23, tv4sigmatauexx24, tv4sigmatauexx25, tv4sigmatauexx26, tv4sigmatauexx27, tv4sigmatauexx28, tv4sigmatauexx29;
  double tv4sigmatauexx210, tv4sigmatauexx211, tv4sigmatauexx212, tv4sigmatauexx213, tv4sigmatauexx214, tv4sigmatauexx215, tv4sigmatauexx216, tv4sigmatauexx217;
  double tv4sigmaexx30, tv4sigmaexx31, tv4sigmaexx32, tv4sigmaexx33, tv4sigmaexx34, tv4sigmaexx35, tv4sigmaexx36, tv4sigmaexx37;
  double tv4sigmaexx38, tv4sigmaexx39, tv4sigmaexx310, tv4sigmaexx311, tv4lapl40, tv4lapl41, tv4lapl42, tv4lapl43;
  double tv4lapl44, tv4lapl3tau0, tv4lapl3tau1, tv4lapl3tau2, tv4lapl3tau3, tv4lapl3tau4, tv4lapl3tau5, tv4lapl3tau6;
  double tv4lapl3tau7, tv4lapl3exx0, tv4lapl3exx1, tv4lapl3exx2, tv4lapl3exx3, tv4lapl3exx4, tv4lapl3exx5, tv4lapl3exx6;
  double tv4lapl3exx7, tv4lapl2tau20, tv4lapl2tau21, tv4lapl2tau22, tv4lapl2tau23, tv4lapl2tau24, tv4lapl2tau25, tv4lapl2tau26;
  double tv4lapl2tau27, tv4lapl2tau28, tv4lapl2tauexx0, tv4lapl2tauexx1, tv4lapl2tauexx2, tv4lapl2tauexx3, tv4lapl2tauexx4, tv4lapl2tauexx5;
  double tv4lapl2tauexx6, tv4lapl2tauexx7, tv4lapl2tauexx8, tv4lapl2tauexx9, tv4lapl2tauexx10, tv4lapl2tauexx11, tv4lapl2exx20, tv4lapl2exx21;
  double tv4lapl2exx22, tv4lapl2exx23, tv4lapl2exx24, tv4lapl2exx25, tv4lapl2exx26, tv4lapl2exx27, tv4lapl2exx28, tv4lapltau30;
  double tv4lapltau31, tv4lapltau32, tv4lapltau33, tv4lapltau34, tv4lapltau35, tv4lapltau36, tv4lapltau37, tv4lapltau2exx0;
  double tv4lapltau2exx1, tv4lapltau2exx2, tv4lapltau2exx3, tv4lapltau2exx4, tv4lapltau2exx5, tv4lapltau2exx6, tv4lapltau2exx7, tv4lapltau2exx8;
  double tv4lapltau2exx9, tv4lapltau2exx10, tv4lapltau2exx11, tv4lapltauexx20, tv4lapltauexx21, tv4lapltauexx22, tv4lapltauexx23, tv4lapltauexx24;
  double tv4lapltauexx25, tv4lapltauexx26, tv4lapltauexx27, tv4lapltauexx28, tv4lapltauexx29, tv4lapltauexx210, tv4lapltauexx211, tv4laplexx30;
  double tv4laplexx31, tv4laplexx32, tv4laplexx33, tv4laplexx34, tv4laplexx35, tv4laplexx36, tv4laplexx37, t5055;
  double t5067, tv4tau40, tv4tau41, tv4tau42, tv4tau43, t5069, t5081, tv4tau44;
  double t5085, tv4tau3exx0, tv4tau3exx1, tv4tau3exx2, tv4tau3exx3, tv4tau3exx4, tv4tau3exx5, tv4tau3exx6;
  double t5089, tv4tau3exx7, tv4tau2exx20, tv4tau2exx21, tv4tau2exx22, tv4tau2exx23, tv4tau2exx24, tv4tau2exx25;
  double tv4tau2exx26, tv4tau2exx27, tv4tau2exx28, tv4tauexx30, tv4tauexx31, tv4tauexx32, tv4tauexx33, tv4tauexx34;
  double tv4tauexx35, tv4tauexx36, tv4tauexx37, tv4exx40, tv4exx41, tv4exx42, tv4exx43, tv4exx44;


  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = 0.1e1 / rho[0];
  t30 = sigma[0] * t29;
  t31 = 0.1e1 / tau[0];
  t34 = 0.1e1 - t30 * t31 / 0.8e1;
  t35 = t3 * t3;
  t37 = POW_1_3(0.1e1 / M_PI);
  t38 = 0.1e1 / t37;
  t39 = t35 * t38;
  t40 = M_CBRT4;
  t41 = t39 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t48 = sqrt(sigma[0]);
  t50 = 0.1e1 / t43 / rho[0];
  t51 = t48 * t50;
  t52 = log(t51 + sqrt(t51 * t51 + 0.1e1));
  t55 = 0.1e1 + 0.252e-1 * t51 * t52;
  t56 = 0.1e1 / t55;
  t60 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t47 * t56;
  t63 = 0.1e1 / t43 / t42;
  t64 = sigma[0] * t63;
  t65 = t31 * exx[0];
  t67 = M_CBRT2;
  t68 = t40 * t67;
  t69 = t39 * t68;
  t72 = t34 * t60 - t64 * t65 * t69 / 0.18e2;
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t72);
  t77 = rho[1] <= p->dens_threshold;
  t78 = my_piecewise5(t15, t12, t11, t16, -t18);
  t79 = 0.1e1 + t78;
  t80 = t79 <= p->zeta_threshold;
  t81 = POW_1_3(t79);
  t83 = my_piecewise3(t80, t23, t81 * t79);
  t84 = t83 * t27;
  t85 = 0.1e1 / rho[1];
  t86 = sigma[2] * t85;
  t87 = 0.1e1 / tau[1];
  t90 = 0.1e1 - t86 * t87 / 0.8e1;
  t91 = rho[1] * rho[1];
  t92 = POW_1_3(rho[1]);
  t93 = t92 * t92;
  t95 = 0.1e1 / t93 / t91;
  t96 = sigma[2] * t95;
  t97 = sqrt(sigma[2]);
  t99 = 0.1e1 / t92 / rho[1];
  t100 = t97 * t99;
  t101 = log(t100 + sqrt(t100 * t100 + 0.1e1));
  t104 = 0.1e1 + 0.252e-1 * t100 * t101;
  t105 = 0.1e1 / t104;
  t109 = 0.1e1 + 0.93333333333333333332e-3 * t41 * t96 * t105;
  t112 = 0.1e1 / t92 / t91;
  t113 = sigma[2] * t112;
  t114 = t87 * exx[1];
  t118 = t90 * t109 - t113 * t114 * t69 / 0.18e2;
  t122 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t118);
  tzk0 = t76 + t122;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t123 = t7 * t7;
  t124 = 0.1e1 / t123;
  t125 = t17 * t124;
  t126 = t8 - t125;
  t127 = my_piecewise5(t11, 0, t15, 0, t126);
  t130 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t127);
  t131 = t130 * t27;
  t135 = t27 * t27;
  t136 = 0.1e1 / t135;
  t137 = t26 * t136;
  t140 = t6 * t137 * t72 / 0.8e1;
  t141 = 0.1e1 / t42;
  t142 = sigma[0] * t141;
  t143 = t31 * t60;
  t146 = t42 * rho[0];
  t148 = 0.1e1 / t44 / t146;
  t149 = sigma[0] * t148;
  t153 = t55 * t55;
  t154 = 0.1e1 / t153;
  t158 = t47 + 0.1e1;
  t159 = sqrt(t158);
  t160 = 0.1e1 / t159;
  t163 = -0.336e-1 * t48 * t63 * t52 - 0.336e-1 * t149 * t160;
  t164 = t154 * t163;
  t168 = -0.24888888888888888889e-2 * t41 * t149 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t164;
  t171 = 0.1e1 / t43 / t146;
  t172 = sigma[0] * t171;
  t176 = t142 * t143 / 0.8e1 + t34 * t168 + 0.7e1 / 0.54e2 * t172 * t65 * t69;
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t72 - t140 - 0.3e1 / 0.8e1 * t6 * t28 * t176);
  t183 = my_piecewise5(t15, 0, t11, 0, -t126);
  t186 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t183);
  t187 = t186 * t27;
  t191 = t83 * t136;
  t194 = t6 * t191 * t118 / 0.8e1;
  t196 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t118 - t194);
  tvrho0 = t76 + t122 + t7 * (t181 + t196);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t199 = -t8 - t125;
  t200 = my_piecewise5(t11, 0, t15, 0, t199);
  t203 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t200);
  t204 = t203 * t27;
  t209 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t72 - t140);
  t211 = my_piecewise5(t15, 0, t11, 0, -t199);
  t214 = my_piecewise3(t80, 0, 0.4e1 / 0.3e1 * t81 * t211);
  t215 = t214 * t27;
  t219 = 0.1e1 / t91;
  t220 = sigma[2] * t219;
  t221 = t87 * t109;
  t224 = t91 * rho[1];
  t226 = 0.1e1 / t93 / t224;
  t227 = sigma[2] * t226;
  t231 = t104 * t104;
  t232 = 0.1e1 / t231;
  t236 = t96 + 0.1e1;
  t237 = sqrt(t236);
  t238 = 0.1e1 / t237;
  t241 = -0.336e-1 * t97 * t112 * t101 - 0.336e-1 * t227 * t238;
  t242 = t232 * t241;
  t246 = -0.24888888888888888889e-2 * t41 * t227 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t242;
  t249 = 0.1e1 / t92 / t224;
  t250 = sigma[2] * t249;
  t254 = t220 * t221 / 0.8e1 + t90 * t246 + 0.7e1 / 0.54e2 * t250 * t114 * t69;
  t259 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t118 - t194 - 0.3e1 / 0.8e1 * t6 * t84 * t254);
  tvrho1 = t76 + t122 + t7 * (t209 + t259);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t262 = t29 * t31;
  t269 = 0.1e1 / t48;
  t275 = 0.126e-1 * t269 * t50 * t52 + 0.126e-1 * t46 * t160;
  t276 = t154 * t275;
  t280 = 0.93333333333333333332e-3 * t39 * t40 * t46 * t56 - 0.93333333333333333332e-3 * t41 * t47 * t276;
  t282 = t63 * t31;
  t286 = -t262 * t60 / 0.8e1 + t34 * t280 - t282 * exx[0] * t69 / 0.18e2;
  t290 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t286);
  tvsigma0 = t7 * t290;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t291 = t85 * t87;
  t298 = 0.1e1 / t97;
  t304 = 0.126e-1 * t298 * t99 * t101 + 0.126e-1 * t95 * t238;
  t305 = t232 * t304;
  t309 = 0.93333333333333333332e-3 * t39 * t40 * t95 * t105 - 0.93333333333333333332e-3 * t41 * t96 * t305;
  t311 = t112 * t87;
  t315 = -t291 * t109 / 0.8e1 + t90 * t309 - t311 * exx[1] * t69 / 0.18e2;
  t319 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t315);
  tvsigma2 = t7 * t319;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 1] += tvlapl1;

  t320 = tau[0] * tau[0];
  t321 = 0.1e1 / t320;
  t322 = t321 * t60;
  t325 = t321 * exx[0];
  t329 = t30 * t322 / 0.8e1 + t64 * t325 * t69 / 0.18e2;
  t333 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t329);
  tvtau0 = t7 * t333;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t334 = tau[1] * tau[1];
  t335 = 0.1e1 / t334;
  t336 = t335 * t109;
  t339 = t335 * exx[1];
  t343 = t86 * t336 / 0.8e1 + t113 * t339 * t69 / 0.18e2;
  t347 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t343);
  tvtau1 = t7 * t347;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 1] += tvtau1;

  t348 = t5 * t26;
  t349 = t27 * sigma[0];
  t350 = t348 * t349;
  t352 = t38 * t40 * t67;
  t353 = t282 * t352;
  t356 = my_piecewise3(t2, 0, t350 * t353 / 0.16e2);
  tvexx0 = t7 * t356;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t357 = t5 * t83;
  t358 = t27 * sigma[2];
  t359 = t357 * t358;
  t360 = t311 * t352;
  t363 = my_piecewise3(t77, 0, t359 * t360 / 0.16e2);
  tvexx1 = t7 * t363;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 1] += tvexx1;

  t366 = t24 * t24;
  t367 = 0.1e1 / t366;
  t368 = t127 * t127;
  t371 = t123 * t7;
  t372 = 0.1e1 / t371;
  t373 = t17 * t372;
  t375 = -0.2e1 * t124 + 0.2e1 * t373;
  t376 = my_piecewise5(t11, 0, t15, 0, t375);
  t380 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t368 + 0.4e1 / 0.3e1 * t24 * t376);
  t381 = t380 * t27;
  t385 = t130 * t136;
  t387 = t6 * t385 * t72;
  t393 = 0.1e1 / t135 / t7;
  t394 = t26 * t393;
  t397 = t6 * t394 * t72 / 0.12e2;
  t399 = t6 * t137 * t176;
  t401 = 0.1e1 / t146;
  t402 = sigma[0] * t401;
  t405 = t31 * t168;
  t408 = t42 * t42;
  t410 = 0.1e1 / t44 / t408;
  t411 = sigma[0] * t410;
  t419 = 0.1e1 / t153 / t55;
  t420 = t163 * t163;
  t421 = t419 * t420;
  t430 = sigma[0] * sigma[0];
  t433 = 0.1e1 / t43 / t408 / t146;
  t436 = 0.1e1 / t159 / t158;
  t439 = 0.784e-1 * t48 * t171 * t52 + 0.168e0 * t411 * t160 - 0.448e-1 * t430 * t433 * t436;
  t440 = t154 * t439;
  t444 = 0.9125925925925925926e-2 * t41 * t411 * t56 + 0.49777777777777777778e-2 * t41 * t149 * t164 + 0.18666666666666666666e-2 * t41 * t47 * t421 - 0.93333333333333333332e-3 * t41 * t47 * t440;
  t447 = 0.1e1 / t43 / t408;
  t448 = sigma[0] * t447;
  t452 = -t402 * t143 / 0.4e1 + t142 * t405 / 0.4e1 + t34 * t444 - 0.35e2 / 0.81e2 * t448 * t65 * t69;
  t457 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t72 - t387 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t176 + t397 - t399 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t452);
  t458 = t81 * t81;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t464 = my_piecewise5(t15, 0, t11, 0, -t375);
  t468 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t81 * t464);
  t469 = t468 * t27;
  t473 = t186 * t136;
  t475 = t6 * t473 * t118;
  t477 = t83 * t393;
  t480 = t6 * t477 * t118 / 0.12e2;
  t482 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t118 - t475 / 0.4e1 + t480);
  tv2rho20 = 0.2e1 * t181 + 0.2e1 * t196 + t7 * (t457 + t482);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t485 = t367 * t200;
  t488 = 0.2e1 * t373;
  t489 = my_piecewise5(t11, 0, t15, 0, t488);
  t493 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t485 * t127 + 0.4e1 / 0.3e1 * t24 * t489);
  t494 = t493 * t27;
  t498 = t203 * t136;
  t500 = t6 * t498 * t72;
  t508 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t72 - t500 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t176 - t387 / 0.8e1 + t397 - t399 / 0.8e1);
  t509 = t459 * t211;
  t512 = my_piecewise5(t15, 0, t11, 0, -t488);
  t516 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t509 * t183 + 0.4e1 / 0.3e1 * t81 * t512);
  t517 = t516 * t27;
  t521 = t214 * t136;
  t523 = t6 * t521 * t118;
  t530 = t6 * t191 * t254;
  t533 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t118 - t523 / 0.8e1 - t475 / 0.8e1 + t480 - 0.3e1 / 0.8e1 * t6 * t187 * t254 - t530 / 0.8e1);
  tv2rho21 = t181 + t196 + t209 + t259 + t7 * (t508 + t533);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t538 = t200 * t200;
  t542 = 0.2e1 * t124 + 0.2e1 * t373;
  t543 = my_piecewise5(t11, 0, t15, 0, t542);
  t547 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t367 * t538 + 0.4e1 / 0.3e1 * t24 * t543);
  t548 = t547 * t27;
  t554 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t72 - t500 / 0.4e1 + t397);
  t555 = t211 * t211;
  t559 = my_piecewise5(t15, 0, t11, 0, -t542);
  t563 = my_piecewise3(t80, 0, 0.4e1 / 0.9e1 * t459 * t555 + 0.4e1 / 0.3e1 * t81 * t559);
  t564 = t563 * t27;
  t573 = 0.1e1 / t224;
  t574 = sigma[2] * t573;
  t577 = t87 * t246;
  t580 = t91 * t91;
  t582 = 0.1e1 / t93 / t580;
  t583 = sigma[2] * t582;
  t591 = 0.1e1 / t231 / t104;
  t592 = t241 * t241;
  t593 = t591 * t592;
  t602 = sigma[2] * sigma[2];
  t605 = 0.1e1 / t92 / t580 / t224;
  t608 = 0.1e1 / t237 / t236;
  t611 = 0.784e-1 * t97 * t249 * t101 + 0.168e0 * t583 * t238 - 0.448e-1 * t602 * t605 * t608;
  t612 = t232 * t611;
  t616 = 0.9125925925925925926e-2 * t41 * t583 * t105 + 0.49777777777777777778e-2 * t41 * t227 * t242 + 0.18666666666666666666e-2 * t41 * t96 * t593 - 0.93333333333333333332e-3 * t41 * t96 * t612;
  t619 = 0.1e1 / t92 / t580;
  t620 = sigma[2] * t619;
  t624 = -t574 * t221 / 0.4e1 + t220 * t577 / 0.4e1 + t90 * t616 - 0.35e2 / 0.81e2 * t620 * t114 * t69;
  t629 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t118 - t523 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t254 + t480 - t530 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t624);
  tv2rho22 = 0.2e1 * t209 + 0.2e1 * t259 + t7 * (t554 + t629);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t637 = t6 * t137 * t286 / 0.8e1;
  t638 = t141 * t31;
  t643 = t31 * t280;
  t650 = t46 * t154;
  t658 = t39 * t40 * sigma[0];
  t659 = t46 * t419;
  t660 = t275 * t163;
  t661 = t659 * t660;
  t669 = t408 * t42;
  t671 = 0.1e1 / t43 / t669;
  t672 = t671 * t436;
  t675 = -0.168e-1 * t269 * t63 * t52 - 0.504e-1 * t148 * t160 + 0.168e-1 * t672 * sigma[0];
  t676 = t154 * t675;
  t680 = -0.24888888888888888889e-2 * t39 * t40 * t148 * t56 - 0.93333333333333333332e-3 * t41 * t650 * t163 + 0.24888888888888888889e-2 * t41 * t149 * t276 + 0.18666666666666666666e-2 * t658 * t661 - 0.93333333333333333332e-3 * t41 * t47 * t676;
  t682 = t171 * t31;
  t686 = t638 * t60 / 0.8e1 - t262 * t168 / 0.8e1 + t142 * t643 / 0.8e1 + t34 * t680 + 0.7e1 / 0.54e2 * t682 * exx[0] * t69;
  t691 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t286 - t637 - 0.3e1 / 0.8e1 * t6 * t28 * t686);
  tv2rhosigma0 = t691 * t7 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t698 = t6 * t191 * t315 / 0.8e1;
  t700 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t315 - t698);
  tv2rhosigma2 = t7 * t700 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t706 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t286 - t637);
  tv2rhosigma3 = t7 * t706 + t290;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t711 = t219 * t87;
  t716 = t87 * t309;
  t723 = t95 * t232;
  t731 = t39 * t40 * sigma[2];
  t732 = t95 * t591;
  t733 = t304 * t241;
  t734 = t732 * t733;
  t742 = t580 * t91;
  t744 = 0.1e1 / t92 / t742;
  t745 = t744 * t608;
  t748 = -0.168e-1 * t298 * t112 * t101 - 0.504e-1 * t226 * t238 + 0.168e-1 * t745 * sigma[2];
  t749 = t232 * t748;
  t753 = -0.24888888888888888889e-2 * t39 * t40 * t226 * t105 - 0.93333333333333333332e-3 * t41 * t723 * t241 + 0.24888888888888888889e-2 * t41 * t227 * t305 + 0.18666666666666666666e-2 * t731 * t734 - 0.93333333333333333332e-3 * t41 * t96 * t749;
  t755 = t249 * t87;
  t759 = t711 * t109 / 0.8e1 - t291 * t246 / 0.8e1 + t220 * t716 / 0.8e1 + t90 * t753 + 0.7e1 / 0.54e2 * t755 * exx[1] * t69;
  t764 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t315 - t698 - 0.3e1 / 0.8e1 * t6 * t84 * t759);
  tv2rhosigma5 = t7 * t764 + t319;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 3] += tv2rholapl3;

  t771 = t6 * t137 * t329 / 0.8e1;
  t774 = t321 * t168;
  t780 = -t142 * t322 / 0.8e1 + t30 * t774 / 0.8e1 - 0.7e1 / 0.54e2 * t172 * t325 * t69;
  t785 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t329 - t771 - 0.3e1 / 0.8e1 * t6 * t28 * t780);
  tv2rhotau0 = t7 * t785 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t792 = t6 * t191 * t343 / 0.8e1;
  t794 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t343 - t792);
  tv2rhotau1 = t7 * t794 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 1] += tv2rhotau1;

  t800 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t329 - t771);
  tv2rhotau2 = t7 * t800 + t333;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 2] += tv2rhotau2;

  t807 = t335 * t246;
  t813 = -t220 * t336 / 0.8e1 + t86 * t807 / 0.8e1 - 0.7e1 / 0.54e2 * t250 * t339 * t69;
  t818 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t343 - t792 - 0.3e1 / 0.8e1 * t6 * t84 * t813);
  tv2rhotau3 = t7 * t818 + t347;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 3] += tv2rhotau3;

  t820 = t5 * t130;
  t821 = t820 * t349;
  t824 = t136 * sigma[0];
  t825 = t348 * t824;
  t827 = t825 * t353 / 0.48e2;
  t828 = t682 * t352;
  t832 = my_piecewise3(t2, 0, t821 * t353 / 0.16e2 + t827 - 0.7e1 / 0.48e2 * t350 * t828);
  tv2rhoexx0 = t7 * t832 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t834 = t5 * t186;
  t835 = t834 * t358;
  t838 = t136 * sigma[2];
  t839 = t357 * t838;
  t841 = t839 * t360 / 0.48e2;
  t843 = my_piecewise3(t77, 0, t835 * t360 / 0.16e2 + t841);
  tv2rhoexx1 = t7 * t843 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 1] += tv2rhoexx1;

  t845 = t5 * t203;
  t846 = t845 * t349;
  t850 = my_piecewise3(t2, 0, t846 * t353 / 0.16e2 + t827);
  tv2rhoexx2 = t7 * t850 + t356;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 2] += tv2rhoexx2;

  t852 = t5 * t214;
  t853 = t852 * t358;
  t856 = t755 * t352;
  t860 = my_piecewise3(t77, 0, t853 * t360 / 0.16e2 + t841 - 0.7e1 / 0.48e2 * t359 * t856);
  tv2rhoexx3 = t7 * t860 + t363;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 3] += tv2rhoexx3;

  t867 = t275 * t275;
  t868 = t419 * t867;
  t873 = 0.1e1 / t48 / sigma[0];
  t877 = 0.1e1 / sigma[0];
  t881 = t408 * rho[0];
  t883 = 0.1e1 / t43 / t881;
  t886 = -0.63e-2 * t873 * t50 * t52 + 0.63e-2 * t877 * t46 * t160 - 0.63e-2 * t883 * t436;
  t887 = t154 * t886;
  t891 = -0.18666666666666666666e-2 * t41 * t650 * t275 + 0.18666666666666666666e-2 * t41 * t47 * t868 - 0.93333333333333333332e-3 * t41 * t47 * t887;
  t893 = -t262 * t280 / 0.4e1 + t34 * t891;
  t897 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t893);
  tv2sigma20 = t7 * t897;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  t903 = t304 * t304;
  t904 = t591 * t903;
  t909 = 0.1e1 / t97 / sigma[2];
  t913 = 0.1e1 / sigma[2];
  t917 = t580 * rho[1];
  t919 = 0.1e1 / t92 / t917;
  t922 = -0.63e-2 * t909 * t99 * t101 + 0.63e-2 * t913 * t95 * t238 - 0.63e-2 * t919 * t608;
  t923 = t232 * t922;
  t927 = -0.18666666666666666666e-2 * t41 * t723 * t304 + 0.18666666666666666666e-2 * t41 * t96 * t904 - 0.93333333333333333332e-3 * t41 * t96 * t923;
  t929 = -t291 * t309 / 0.4e1 + t90 * t927;
  t933 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t929);
  tv2sigma25 = t7 * t933;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 5] += tv2sigmalapl5;

  t934 = t29 * t321;
  t937 = t321 * t280;
  t940 = t63 * t321;
  t944 = t934 * t60 / 0.8e1 + t30 * t937 / 0.8e1 + t940 * exx[0] * t69 / 0.18e2;
  t948 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t944);
  tv2sigmatau0 = t7 * t948;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 4] += tv2sigmatau4;

  t949 = t85 * t335;
  t952 = t335 * t309;
  t955 = t112 * t335;
  t959 = t949 * t109 / 0.8e1 + t86 * t952 / 0.8e1 + t955 * exx[1] * t69 / 0.18e2;
  t963 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t959);
  tv2sigmatau5 = t7 * t963;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 5] += tv2sigmatau5;

  t964 = t27 * t63;
  t965 = t348 * t964;
  t967 = t31 * t38 * t68;
  t970 = my_piecewise3(t2, 0, t965 * t967 / 0.16e2);
  tv2sigmaexx0 = t7 * t970;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2sigmaexx1 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 1] += tv2sigmaexx1;

  tv2sigmaexx2 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 2] += tv2sigmaexx2;

  tv2sigmaexx3 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 3] += tv2sigmaexx3;

  tv2sigmaexx4 = 0.e0;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 4] += tv2sigmaexx4;

  t971 = t27 * t112;
  t972 = t357 * t971;
  t974 = t87 * t38 * t68;
  t977 = my_piecewise3(t77, 0, t972 * t974 / 0.16e2);
  tv2sigmaexx5 = t7 * t977;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 5] += tv2sigmaexx5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 3] += tv2lapltau3;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  tv2laplexx1 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 1] += tv2laplexx1;

  tv2laplexx2 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 2] += tv2laplexx2;

  tv2laplexx3 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 3] += tv2laplexx3;

  t979 = 0.1e1 / t320 / tau[0];
  t980 = t979 * t60;
  t983 = t979 * exx[0];
  t987 = -t30 * t980 / 0.4e1 - t64 * t983 * t69 / 0.9e1;
  t991 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t987);
  tv2tau20 = t7 * t991;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 1] += tv2tau21;

  t993 = 0.1e1 / t334 / tau[1];
  t994 = t993 * t109;
  t997 = t993 * exx[1];
  t1001 = -t86 * t994 / 0.4e1 - t113 * t997 * t69 / 0.9e1;
  t1005 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t1001);
  tv2tau22 = t7 * t1005;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 2] += tv2tau22;

  t1006 = t940 * t352;
  t1009 = my_piecewise3(t2, 0, -t350 * t1006 / 0.16e2);
  tv2tauexx0 = t7 * t1009;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2tauexx1 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 1] += tv2tauexx1;

  tv2tauexx2 = 0.e0;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 2] += tv2tauexx2;

  t1010 = t955 * t352;
  t1013 = my_piecewise3(t77, 0, -t359 * t1010 / 0.16e2);
  tv2tauexx3 = t7 * t1013;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 3] += tv2tauexx3;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

  tv2exx21 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 1] += tv2exx21;

  tv2exx22 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 2] += tv2exx22;

  t1017 = 0.1e1 / t366 / t20;
  t1018 = t368 * t127;
  t1021 = t367 * t127;
  t1024 = t123 * t123;
  t1025 = 0.1e1 / t1024;
  t1026 = t17 * t1025;
  t1028 = 0.6e1 * t372 - 0.6e1 * t1026;
  t1029 = my_piecewise5(t11, 0, t15, 0, t1028);
  t1033 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1017 * t1018 + 0.4e1 / 0.3e1 * t1021 * t376 + 0.4e1 / 0.3e1 * t24 * t1029);
  t1034 = t1033 * t27;
  t1038 = t380 * t136;
  t1040 = t6 * t1038 * t72;
  t1045 = t130 * t393;
  t1047 = t6 * t1045 * t72;
  t1050 = t6 * t385 * t176;
  t1056 = 0.1e1 / t135 / t123;
  t1057 = t26 * t1056;
  t1060 = 0.5e1 / 0.36e2 * t6 * t1057 * t72;
  t1062 = t6 * t394 * t176;
  t1065 = t6 * t137 * t452;
  t1067 = 0.1e1 / t408;
  t1068 = sigma[0] * t1067;
  t1073 = t31 * t444;
  t1077 = 0.1e1 / t44 / t881;
  t1078 = sigma[0] * t1077;
  t1091 = t153 * t153;
  t1092 = 0.1e1 / t1091;
  t1093 = t420 * t163;
  t1094 = t1092 * t1093;
  t1098 = t163 * t439;
  t1099 = t659 * t1098;
  t1107 = t408 * t408;
  t1109 = 0.1e1 / t43 / t1107;
  t1113 = t430 * sigma[0];
  t1114 = t1107 * t146;
  t1115 = 0.1e1 / t1114;
  t1117 = t158 * t158;
  t1119 = 0.1e1 / t159 / t1117;
  t1122 = -0.26133333333333333333e0 * t48 * t447 * t52 - 0.88853333333333333333e0 * t1078 * t160 + 0.55253333333333333333e0 * t430 * t1109 * t436 - 0.1792e0 * t1113 * t1115 * t1119;
  t1123 = t154 * t1122;
  t1127 = -0.42587654320987654321e-1 * t41 * t1078 * t56 - 0.27377777777777777778e-1 * t41 * t411 * t164 - 0.14933333333333333333e-1 * t41 * t149 * t421 + 0.74666666666666666667e-2 * t41 * t149 * t440 - 0.55999999999999999998e-2 * t41 * t47 * t1094 + 0.55999999999999999998e-2 * t658 * t1099 - 0.93333333333333333332e-3 * t41 * t47 * t1123;
  t1129 = sigma[0] * t883;
  t1133 = 0.3e1 / 0.4e1 * t1068 * t143 - 0.3e1 / 0.4e1 * t402 * t405 + 0.3e1 / 0.8e1 * t142 * t1073 + t34 * t1127 + 0.455e3 / 0.243e3 * t1129 * t65 * t69;
  t1138 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1034 * t72 - 0.3e1 / 0.8e1 * t1040 - 0.9e1 / 0.8e1 * t6 * t381 * t176 + t1047 / 0.4e1 - 0.3e1 / 0.4e1 * t1050 - 0.9e1 / 0.8e1 * t6 * t131 * t452 - t1060 + t1062 / 0.4e1 - 0.3e1 / 0.8e1 * t1065 - 0.3e1 / 0.8e1 * t6 * t28 * t1133);
  t1140 = 0.1e1 / t458 / t79;
  t1141 = t460 * t183;
  t1144 = t459 * t183;
  t1148 = my_piecewise5(t15, 0, t11, 0, -t1028);
  t1152 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1140 * t1141 + 0.4e1 / 0.3e1 * t1144 * t464 + 0.4e1 / 0.3e1 * t81 * t1148);
  t1153 = t1152 * t27;
  t1157 = t468 * t136;
  t1159 = t6 * t1157 * t118;
  t1161 = t186 * t393;
  t1163 = t6 * t1161 * t118;
  t1165 = t83 * t1056;
  t1168 = 0.5e1 / 0.36e2 * t6 * t1165 * t118;
  t1170 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1153 * t118 - 0.3e1 / 0.8e1 * t1159 + t1163 / 0.4e1 - t1168);
  tv3rho30 = 0.3e1 * t457 + 0.3e1 * t482 + t7 * (t1138 + t1170);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1173 = 0.2e1 * t508;
  t1174 = 0.2e1 * t533;
  t1175 = t1017 * t200;
  t1178 = t367 * t489;
  t1183 = 0.2e1 * t372;
  t1184 = 0.6e1 * t1026;
  t1185 = t1183 - t1184;
  t1186 = my_piecewise5(t11, 0, t15, 0, t1185);
  t1190 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1175 * t368 + 0.8e1 / 0.9e1 * t1178 * t127 + 0.4e1 / 0.9e1 * t485 * t376 + 0.4e1 / 0.3e1 * t24 * t1186);
  t1191 = t1190 * t27;
  t1195 = t493 * t136;
  t1198 = t6 * t1195 * t72 / 0.4e1;
  t1202 = t203 * t393;
  t1204 = t6 * t1202 * t72;
  t1208 = t6 * t498 * t176 / 0.4e1;
  t1217 = -0.3e1 / 0.8e1 * t6 * t1191 * t72 - t1198 - 0.3e1 / 0.4e1 * t6 * t494 * t176 + t1204 / 0.12e2 - t1208 - 0.3e1 / 0.8e1 * t6 * t204 * t452 - t1040 / 0.8e1 + t1047 / 0.6e1 - t1050 / 0.4e1 - t1060 + t1062 / 0.6e1 - t1065 / 0.8e1;
  t1218 = my_piecewise3(t2, 0, t1217);
  t1219 = t1140 * t211;
  t1222 = t459 * t512;
  t1228 = my_piecewise5(t15, 0, t11, 0, -t1185);
  t1232 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1219 * t460 + 0.8e1 / 0.9e1 * t1222 * t183 + 0.4e1 / 0.9e1 * t509 * t464 + 0.4e1 / 0.3e1 * t81 * t1228);
  t1233 = t1232 * t27;
  t1237 = t516 * t136;
  t1240 = t6 * t1237 * t118 / 0.4e1;
  t1241 = t214 * t393;
  t1243 = t6 * t1241 * t118;
  t1252 = t6 * t473 * t254 / 0.4e1;
  t1254 = t6 * t477 * t254;
  t1257 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1233 * t118 - t1240 + t1243 / 0.12e2 - t1159 / 0.8e1 + t1163 / 0.6e1 - t1168 - 0.3e1 / 0.8e1 * t6 * t469 * t254 - t1252 + t1254 / 0.12e2);
  tv3rho31 = t457 + t482 + t1173 + t1174 + t7 * (t1218 + t1257);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1260 = t1017 * t538;
  t1265 = t367 * t543;
  t1268 = -t1183 - t1184;
  t1269 = my_piecewise5(t11, 0, t15, 0, t1268);
  t1273 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1260 * t127 + 0.8e1 / 0.9e1 * t485 * t489 + 0.4e1 / 0.9e1 * t1265 * t127 + 0.4e1 / 0.3e1 * t24 * t1269);
  t1274 = t1273 * t27;
  t1278 = t547 * t136;
  t1280 = t6 * t1278 * t72;
  t1289 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1274 * t72 - t1280 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t548 * t176 - t1198 + t1204 / 0.6e1 - t1208 + t1047 / 0.12e2 - t1060 + t1062 / 0.12e2);
  t1290 = t1140 * t555;
  t1295 = t459 * t559;
  t1299 = my_piecewise5(t15, 0, t11, 0, -t1268);
  t1303 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1290 * t183 + 0.8e1 / 0.9e1 * t509 * t512 + 0.4e1 / 0.9e1 * t1295 * t183 + 0.4e1 / 0.3e1 * t81 * t1299);
  t1304 = t1303 * t27;
  t1308 = t563 * t136;
  t1310 = t6 * t1308 * t118;
  t1317 = t6 * t521 * t254;
  t1325 = t6 * t191 * t624;
  t1327 = -0.3e1 / 0.8e1 * t6 * t1304 * t118 - t1310 / 0.8e1 - t1240 + t1243 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t517 * t254 - t1317 / 0.4e1 + t1163 / 0.12e2 - t1168 - t1252 + t1254 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t187 * t624 - t1325 / 0.8e1;
  t1328 = my_piecewise3(t77, 0, t1327);
  tv3rho32 = t1173 + t1174 + t554 + t629 + t7 * (t1289 + t1328);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1333 = t538 * t200;
  t1339 = -0.6e1 * t372 - 0.6e1 * t1026;
  t1340 = my_piecewise5(t11, 0, t15, 0, t1339);
  t1344 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1017 * t1333 + 0.4e1 / 0.3e1 * t485 * t543 + 0.4e1 / 0.3e1 * t24 * t1340);
  t1345 = t1344 * t27;
  t1352 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1345 * t72 - 0.3e1 / 0.8e1 * t1280 + t1204 / 0.4e1 - t1060);
  t1353 = t555 * t211;
  t1359 = my_piecewise5(t15, 0, t11, 0, -t1339);
  t1363 = my_piecewise3(t80, 0, -0.8e1 / 0.27e2 * t1140 * t1353 + 0.4e1 / 0.3e1 * t509 * t559 + 0.4e1 / 0.3e1 * t81 * t1359);
  t1364 = t1363 * t27;
  t1379 = 0.1e1 / t580;
  t1380 = sigma[2] * t1379;
  t1385 = t87 * t616;
  t1389 = 0.1e1 / t93 / t917;
  t1390 = sigma[2] * t1389;
  t1403 = t231 * t231;
  t1404 = 0.1e1 / t1403;
  t1405 = t592 * t241;
  t1406 = t1404 * t1405;
  t1410 = t241 * t611;
  t1411 = t732 * t1410;
  t1419 = t580 * t580;
  t1421 = 0.1e1 / t92 / t1419;
  t1425 = t602 * sigma[2];
  t1426 = t1419 * t224;
  t1427 = 0.1e1 / t1426;
  t1429 = t236 * t236;
  t1431 = 0.1e1 / t237 / t1429;
  t1434 = -0.26133333333333333333e0 * t97 * t619 * t101 - 0.88853333333333333333e0 * t1390 * t238 + 0.55253333333333333333e0 * t602 * t1421 * t608 - 0.1792e0 * t1425 * t1427 * t1431;
  t1435 = t232 * t1434;
  t1439 = -0.42587654320987654321e-1 * t41 * t1390 * t105 - 0.27377777777777777778e-1 * t41 * t583 * t242 - 0.14933333333333333333e-1 * t41 * t227 * t593 + 0.74666666666666666667e-2 * t41 * t227 * t612 - 0.55999999999999999998e-2 * t41 * t96 * t1406 + 0.55999999999999999998e-2 * t731 * t1411 - 0.93333333333333333332e-3 * t41 * t96 * t1435;
  t1441 = sigma[2] * t919;
  t1445 = 0.3e1 / 0.4e1 * t1380 * t221 - 0.3e1 / 0.4e1 * t574 * t577 + 0.3e1 / 0.8e1 * t220 * t1385 + t90 * t1439 + 0.455e3 / 0.243e3 * t1441 * t114 * t69;
  t1450 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1364 * t118 - 0.3e1 / 0.8e1 * t1310 - 0.9e1 / 0.8e1 * t6 * t564 * t254 + t1243 / 0.4e1 - 0.3e1 / 0.4e1 * t1317 - 0.9e1 / 0.8e1 * t6 * t215 * t624 - t1168 + t1254 / 0.4e1 - 0.3e1 / 0.8e1 * t1325 - 0.3e1 / 0.8e1 * t6 * t84 * t1445);
  tv3rho33 = 0.3e1 * t554 + 0.3e1 * t629 + t7 * (t1352 + t1450);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1458 = t6 * t385 * t286;
  t1465 = t6 * t394 * t286 / 0.12e2;
  t1467 = t6 * t137 * t686;
  t1469 = t401 * t31;
  t1478 = t31 * t680;
  t1485 = t148 * t154;
  t1498 = t148 * t419;
  t1499 = t1498 * t660;
  t1505 = t46 * t1092;
  t1506 = t275 * t420;
  t1507 = t1505 * t1506;
  t1510 = t675 * t163;
  t1511 = t659 * t1510;
  t1514 = t275 * t439;
  t1515 = t659 * t1514;
  t1523 = t433 * t436;
  t1528 = 0.1e1 / t1107 / t42 * t1119;
  t1531 = 0.392e-1 * t269 * t171 * t52 + 0.2072e0 * t410 * t160 - 0.1736e0 * t1523 * sigma[0] + 0.672e-1 * t1528 * t430;
  t1532 = t154 * t1531;
  t1536 = 0.9125925925925925926e-2 * t39 * t40 * t410 * t56 + 0.49777777777777777778e-2 * t41 * t1485 * t163 + 0.18666666666666666666e-2 * t41 * t659 * t420 - 0.93333333333333333332e-3 * t41 * t650 * t439 - 0.9125925925925925926e-2 * t41 * t411 * t276 - 0.99555555555555555554e-2 * t658 * t1499 + 0.49777777777777777778e-2 * t41 * t149 * t676 - 0.55999999999999999998e-2 * t658 * t1507 + 0.37333333333333333332e-2 * t658 * t1511 + 0.18666666666666666666e-2 * t658 * t1515 - 0.93333333333333333332e-3 * t41 * t47 * t1532;
  t1538 = t447 * t31;
  t1542 = -t1469 * t60 / 0.4e1 + t638 * t168 / 0.4e1 - t262 * t444 / 0.8e1 - t402 * t643 / 0.4e1 + t142 * t1478 / 0.4e1 + t34 * t1536 - 0.35e2 / 0.81e2 * t1538 * exx[0] * t69;
  t1547 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t286 - t1458 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t686 + t1465 - t1467 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t1542);
  tv3rho2sigma0 = t1547 * t7 + 0.2e1 * t691;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1554 = t6 * t473 * t315;
  t1558 = t6 * t477 * t315 / 0.12e2;
  t1560 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t315 - t1554 / 0.4e1 + t1558);
  tv3rho2sigma2 = t1560 * t7 + 0.2e1 * t700;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1566 = t6 * t498 * t286;
  t1574 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t286 - t1566 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t686 - t1458 / 0.8e1 + t1465 - t1467 / 0.8e1);
  tv3rho2sigma3 = t1574 * t7 + t691 + t706;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t1580 = t6 * t521 * t315;
  t1587 = t6 * t191 * t759;
  t1590 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t315 - t1580 / 0.8e1 - t1554 / 0.8e1 + t1558 - 0.3e1 / 0.8e1 * t6 * t187 * t759 - t1587 / 0.8e1);
  tv3rho2sigma5 = t1590 * t7 + t700 + t764;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t1598 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t286 - t1566 / 0.4e1 + t1465);
  tv3rho2sigma6 = t1598 * t7 + 0.2e1 * t706;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t1609 = t573 * t87;
  t1618 = t87 * t753;
  t1625 = t226 * t232;
  t1638 = t226 * t591;
  t1639 = t1638 * t733;
  t1645 = t95 * t1404;
  t1646 = t304 * t592;
  t1647 = t1645 * t1646;
  t1650 = t748 * t241;
  t1651 = t732 * t1650;
  t1654 = t304 * t611;
  t1655 = t732 * t1654;
  t1663 = t605 * t608;
  t1668 = 0.1e1 / t1419 / t91 * t1431;
  t1671 = 0.392e-1 * t298 * t249 * t101 + 0.2072e0 * t582 * t238 - 0.1736e0 * t1663 * sigma[2] + 0.672e-1 * t1668 * t602;
  t1672 = t232 * t1671;
  t1676 = 0.9125925925925925926e-2 * t39 * t40 * t582 * t105 + 0.49777777777777777778e-2 * t41 * t1625 * t241 + 0.18666666666666666666e-2 * t41 * t732 * t592 - 0.93333333333333333332e-3 * t41 * t723 * t611 - 0.9125925925925925926e-2 * t41 * t583 * t305 - 0.99555555555555555554e-2 * t731 * t1639 + 0.49777777777777777778e-2 * t41 * t227 * t749 - 0.55999999999999999998e-2 * t731 * t1647 + 0.37333333333333333332e-2 * t731 * t1651 + 0.18666666666666666666e-2 * t731 * t1655 - 0.93333333333333333332e-3 * t41 * t96 * t1672;
  t1678 = t619 * t87;
  t1682 = -t1609 * t109 / 0.4e1 + t711 * t246 / 0.4e1 - t291 * t616 / 0.8e1 - t574 * t716 / 0.4e1 + t220 * t1618 / 0.4e1 + t90 * t1676 - 0.35e2 / 0.81e2 * t1678 * exx[1] * t69;
  t1687 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t315 - t1580 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t759 + t1558 - t1587 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t1682);
  tv3rho2sigma8 = t1687 * t7 + 0.2e1 * t764;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2lapl1 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 1] += tv3rho2lapl1;

  tv3rho2lapl2 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 2] += tv3rho2lapl2;

  tv3rho2lapl3 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 3] += tv3rho2lapl3;

  tv3rho2lapl4 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 4] += tv3rho2lapl4;

  tv3rho2lapl5 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 5] += tv3rho2lapl5;

  t1694 = t6 * t385 * t329;
  t1701 = t6 * t394 * t329 / 0.12e2;
  t1703 = t6 * t137 * t780;
  t1709 = t321 * t444;
  t1715 = t402 * t322 / 0.4e1 - t142 * t774 / 0.4e1 + t30 * t1709 / 0.8e1 + 0.35e2 / 0.81e2 * t448 * t325 * t69;
  t1720 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t329 - t1694 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t780 + t1701 - t1703 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t1715);
  tv3rho2tau0 = t1720 * t7 + 0.2e1 * t785;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t1727 = t6 * t473 * t343;
  t1731 = t6 * t477 * t343 / 0.12e2;
  t1733 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t343 - t1727 / 0.4e1 + t1731);
  tv3rho2tau1 = t1733 * t7 + 0.2e1 * t794;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 1] += tv3rho2tau1;

  t1739 = t6 * t498 * t329;
  t1747 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t329 - t1739 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t780 - t1694 / 0.8e1 + t1701 - t1703 / 0.8e1);
  tv3rho2tau2 = t1747 * t7 + t785 + t800;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 2] += tv3rho2tau2;

  t1753 = t6 * t521 * t343;
  t1760 = t6 * t191 * t813;
  t1763 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t343 - t1753 / 0.8e1 - t1727 / 0.8e1 + t1731 - 0.3e1 / 0.8e1 * t6 * t187 * t813 - t1760 / 0.8e1);
  tv3rho2tau3 = t1763 * t7 + t794 + t818;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 3] += tv3rho2tau3;

  t1771 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t329 - t1739 / 0.4e1 + t1701);
  tv3rho2tau4 = t1771 * t7 + 0.2e1 * t800;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 4] += tv3rho2tau4;

  t1786 = t335 * t616;
  t1792 = t574 * t336 / 0.4e1 - t220 * t807 / 0.4e1 + t86 * t1786 / 0.8e1 + 0.35e2 / 0.81e2 * t620 * t339 * t69;
  t1797 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t343 - t1753 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t813 + t1731 - t1760 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * t1792);
  tv3rho2tau5 = t1797 * t7 + 0.2e1 * t818;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 5] += tv3rho2tau5;

  t1800 = t5 * t380;
  t1801 = t1800 * t349;
  t1804 = t820 * t824;
  t1805 = t1804 * t353;
  t1809 = t393 * sigma[0];
  t1810 = t348 * t1809;
  t1812 = t1810 * t353 / 0.72e2;
  t1813 = t825 * t828;
  t1815 = t1538 * t352;
  t1819 = my_piecewise3(t2, 0, t1801 * t353 / 0.16e2 + t1805 / 0.24e2 - 0.7e1 / 0.24e2 * t821 * t828 - t1812 - 0.7e1 / 0.72e2 * t1813 + 0.35e2 / 0.72e2 * t350 * t1815);
  tv3rho2exx0 = t1819 * t7 + 0.2e1 * t832;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 0] += tv3rho2exx0;

  t1822 = t5 * t468;
  t1823 = t1822 * t358;
  t1826 = t834 * t838;
  t1827 = t1826 * t360;
  t1829 = t393 * sigma[2];
  t1830 = t357 * t1829;
  t1832 = t1830 * t360 / 0.72e2;
  t1834 = my_piecewise3(t77, 0, t1823 * t360 / 0.16e2 + t1827 / 0.24e2 - t1832);
  tv3rho2exx1 = t1834 * t7 + 0.2e1 * t843;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 1] += tv3rho2exx1;

  t1836 = t5 * t493;
  t1837 = t1836 * t349;
  t1840 = t845 * t824;
  t1841 = t1840 * t353;
  t1848 = my_piecewise3(t2, 0, t1837 * t353 / 0.16e2 + t1841 / 0.48e2 - 0.7e1 / 0.48e2 * t846 * t828 + t1805 / 0.48e2 - t1812 - 0.7e1 / 0.144e3 * t1813);
  tv3rho2exx2 = t1848 * t7 + t832 + t850;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 2] += tv3rho2exx2;

  t1850 = t5 * t516;
  t1851 = t1850 * t358;
  t1854 = t852 * t838;
  t1855 = t1854 * t360;
  t1860 = t839 * t856;
  t1863 = my_piecewise3(t77, 0, t1851 * t360 / 0.16e2 + t1855 / 0.48e2 + t1827 / 0.48e2 - t1832 - 0.7e1 / 0.48e2 * t835 * t856 - 0.7e1 / 0.144e3 * t1860);
  tv3rho2exx3 = t1863 * t7 + t843 + t860;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 3] += tv3rho2exx3;

  t1866 = t5 * t547;
  t1867 = t1866 * t349;
  t1872 = my_piecewise3(t2, 0, t1867 * t353 / 0.16e2 + t1841 / 0.24e2 - t1812);
  tv3rho2exx4 = t1872 * t7 + 0.2e1 * t850;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 4] += tv3rho2exx4;

  t1875 = t5 * t563;
  t1876 = t1875 * t358;
  t1883 = t1678 * t352;
  t1887 = my_piecewise3(t77, 0, t1876 * t360 / 0.16e2 + t1855 / 0.24e2 - 0.7e1 / 0.24e2 * t853 * t856 - t1832 - 0.7e1 / 0.72e2 * t1860 + 0.35e2 / 0.72e2 * t359 * t1883);
  tv3rho2exx5 = t1887 * t7 + 0.2e1 * t860;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 5] += tv3rho2exx5;

  t1894 = t6 * t137 * t893 / 0.8e1;
  t1899 = t31 * t891;
  t1913 = t867 * t163;
  t1914 = t1505 * t1913;
  t1917 = t275 * t675;
  t1918 = t659 * t1917;
  t1924 = t886 * t163;
  t1925 = t659 * t1924;
  t1935 = t1107 * rho[0];
  t1937 = 0.1e1 / t1935 * t1119;
  t1940 = 0.84e-2 * t873 * t63 * t52 - 0.84e-2 * t877 * t148 * t160 + 0.42e-1 * t672 - 0.252e-1 * t1937 * sigma[0];
  t1941 = t154 * t1940;
  t1945 = 0.49777777777777777776e-2 * t41 * t1485 * t275 + 0.37333333333333333332e-2 * t41 * t661 - 0.18666666666666666666e-2 * t41 * t650 * t675 - 0.49777777777777777776e-2 * t41 * t149 * t868 - 0.55999999999999999998e-2 * t658 * t1914 + 0.37333333333333333332e-2 * t658 * t1918 + 0.24888888888888888889e-2 * t41 * t149 * t887 + 0.18666666666666666666e-2 * t658 * t1925 - 0.93333333333333333332e-3 * t41 * t47 * t1941;
  t1947 = t638 * t280 / 0.4e1 - t262 * t680 / 0.4e1 + t142 * t1899 / 0.8e1 + t34 * t1945;
  t1952 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t893 - t1894 - 0.3e1 / 0.8e1 * t6 * t28 * t1947);
  tv3rhosigma20 = t1952 * t7 + t897;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  t1959 = t6 * t191 * t929 / 0.8e1;
  t1961 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t929 - t1959);
  tv3rhosigma25 = t1961 * t7 + t933;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  t1967 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t893 - t1894);
  tv3rhosigma26 = t1967 * t7 + t897;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  t1976 = t87 * t927;
  t1990 = t903 * t241;
  t1991 = t1645 * t1990;
  t1994 = t304 * t748;
  t1995 = t732 * t1994;
  t2001 = t922 * t241;
  t2002 = t732 * t2001;
  t2012 = t1419 * rho[1];
  t2014 = 0.1e1 / t2012 * t1431;
  t2017 = 0.84e-2 * t909 * t112 * t101 - 0.84e-2 * t913 * t226 * t238 + 0.42e-1 * t745 - 0.252e-1 * t2014 * sigma[2];
  t2018 = t232 * t2017;
  t2022 = 0.49777777777777777776e-2 * t41 * t1625 * t304 + 0.37333333333333333332e-2 * t41 * t734 - 0.18666666666666666666e-2 * t41 * t723 * t748 - 0.49777777777777777776e-2 * t41 * t227 * t904 - 0.55999999999999999998e-2 * t731 * t1991 + 0.37333333333333333332e-2 * t731 * t1995 + 0.24888888888888888889e-2 * t41 * t227 * t923 + 0.18666666666666666666e-2 * t731 * t2002 - 0.93333333333333333332e-3 * t41 * t96 * t2018;
  t2024 = t711 * t309 / 0.4e1 - t291 * t753 / 0.4e1 + t220 * t1976 / 0.8e1 + t90 * t2022;
  t2029 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t929 - t1959 - 0.3e1 / 0.8e1 * t6 * t84 * t2024);
  tv3rhosigma211 = t2029 * t7 + t933;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  tv3rhosigmalapl5 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  tv3rhosigmalapl6 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  tv3rhosigmalapl11 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  t2036 = t6 * t137 * t944 / 0.8e1;
  t2037 = t141 * t321;
  t2044 = t321 * t680;
  t2047 = t171 * t321;
  t2051 = -t2037 * t60 / 0.8e1 + t934 * t168 / 0.8e1 - t142 * t937 / 0.8e1 + t30 * t2044 / 0.8e1 - 0.7e1 / 0.54e2 * t2047 * exx[0] * t69;
  t2056 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t944 - t2036 - 0.3e1 / 0.8e1 * t6 * t28 * t2051);
  tv3rhosigmatau0 = t2056 * t7 + t948;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 4] += tv3rhosigmatau4;

  t2063 = t6 * t191 * t959 / 0.8e1;
  t2065 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t959 - t2063);
  tv3rhosigmatau5 = t2065 * t7 + t963;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 5] += tv3rhosigmatau5;

  t2071 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t944 - t2036);
  tv3rhosigmatau6 = t2071 * t7 + t948;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 10] += tv3rhosigmatau10;

  t2076 = t219 * t335;
  t2083 = t335 * t753;
  t2086 = t249 * t335;
  t2090 = -t2076 * t109 / 0.8e1 + t949 * t246 / 0.8e1 - t220 * t952 / 0.8e1 + t86 * t2083 / 0.8e1 - 0.7e1 / 0.54e2 * t2086 * exx[1] * t69;
  t2095 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t959 - t2063 - 0.3e1 / 0.8e1 * t6 * t84 * t2090);
  tv3rhosigmatau11 = t2095 * t7 + t963;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 11] += tv3rhosigmatau11;

  t2097 = t820 * t964;
  t2100 = t136 * t63;
  t2101 = t348 * t2100;
  t2103 = t2101 * t967 / 0.48e2;
  t2104 = t27 * t171;
  t2105 = t348 * t2104;
  t2109 = my_piecewise3(t2, 0, t2097 * t967 / 0.16e2 + t2103 - 0.7e1 / 0.48e2 * t2105 * t967);
  tv3rhosigmaexx0 = t2109 * t7 + t970;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 0] += tv3rhosigmaexx0;

  tv3rhosigmaexx1 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 1] += tv3rhosigmaexx1;

  tv3rhosigmaexx2 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 2] += tv3rhosigmaexx2;

  tv3rhosigmaexx3 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 3] += tv3rhosigmaexx3;

  tv3rhosigmaexx4 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 4] += tv3rhosigmaexx4;

  t2111 = t834 * t971;
  t2114 = t136 * t112;
  t2115 = t357 * t2114;
  t2117 = t2115 * t974 / 0.48e2;
  t2119 = my_piecewise3(t77, 0, t2111 * t974 / 0.16e2 + t2117);
  tv3rhosigmaexx5 = t2119 * t7 + t977;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 5] += tv3rhosigmaexx5;

  t2121 = t845 * t964;
  t2125 = my_piecewise3(t2, 0, t2121 * t967 / 0.16e2 + t2103);
  tv3rhosigmaexx6 = t2125 * t7 + t970;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 6] += tv3rhosigmaexx6;

  tv3rhosigmaexx7 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 7] += tv3rhosigmaexx7;

  tv3rhosigmaexx8 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 8] += tv3rhosigmaexx8;

  tv3rhosigmaexx9 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 9] += tv3rhosigmaexx9;

  tv3rhosigmaexx10 = 0.e0;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 10] += tv3rhosigmaexx10;

  t2127 = t852 * t971;
  t2130 = t27 * t249;
  t2131 = t357 * t2130;
  t2135 = my_piecewise3(t77, 0, t2127 * t974 / 0.16e2 + t2117 - 0.7e1 / 0.48e2 * t2131 * t974);
  tv3rhosigmaexx11 = t2135 * t7 + t977;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 11] += tv3rhosigmaexx11;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 1] += tv3rholapl21;

  tv3rholapl22 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 2] += tv3rholapl22;

  tv3rholapl23 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 4] += tv3rholapl24;

  tv3rholapl25 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 7] += tv3rholapltau7;

  tv3rholaplexx0 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 0] += tv3rholaplexx0;

  tv3rholaplexx1 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 1] += tv3rholaplexx1;

  tv3rholaplexx2 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 2] += tv3rholaplexx2;

  tv3rholaplexx3 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 3] += tv3rholaplexx3;

  tv3rholaplexx4 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 4] += tv3rholaplexx4;

  tv3rholaplexx5 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 5] += tv3rholaplexx5;

  tv3rholaplexx6 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 6] += tv3rholaplexx6;

  tv3rholaplexx7 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 7] += tv3rholaplexx7;

  t2142 = t6 * t137 * t987 / 0.8e1;
  t2145 = t979 * t168;
  t2151 = t142 * t980 / 0.4e1 - t30 * t2145 / 0.4e1 + 0.7e1 / 0.27e2 * t172 * t983 * t69;
  t2156 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t987 - t2142 - 0.3e1 / 0.8e1 * t6 * t28 * t2151);
  tv3rhotau20 = t2156 * t7 + t991;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 1] += tv3rhotau21;

  t2163 = t6 * t191 * t1001 / 0.8e1;
  t2165 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t1001 - t2163);
  tv3rhotau22 = t2165 * t7 + t1005;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 2] += tv3rhotau22;

  t2171 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t987 - t2142);
  tv3rhotau23 = t2171 * t7 + t991;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 4] += tv3rhotau24;

  t2178 = t993 * t246;
  t2184 = t220 * t994 / 0.4e1 - t86 * t2178 / 0.4e1 + 0.7e1 / 0.27e2 * t250 * t997 * t69;
  t2189 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t1001 - t2163 - 0.3e1 / 0.8e1 * t6 * t84 * t2184);
  tv3rhotau25 = t2189 * t7 + t1005;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 5] += tv3rhotau25;

  t2194 = t825 * t1006 / 0.48e2;
  t2195 = t2047 * t352;
  t2199 = my_piecewise3(t2, 0, -t821 * t1006 / 0.16e2 - t2194 + 0.7e1 / 0.48e2 * t350 * t2195);
  tv3rhotauexx0 = t2199 * t7 + t1009;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 0] += tv3rhotauexx0;

  tv3rhotauexx1 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 1] += tv3rhotauexx1;

  tv3rhotauexx2 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 2] += tv3rhotauexx2;

  t2204 = t839 * t1010 / 0.48e2;
  t2206 = my_piecewise3(t77, 0, -t835 * t1010 / 0.16e2 - t2204);
  tv3rhotauexx3 = t2206 * t7 + t1013;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 3] += tv3rhotauexx3;

  t2211 = my_piecewise3(t2, 0, -t846 * t1006 / 0.16e2 - t2194);
  tv3rhotauexx4 = t2211 * t7 + t1009;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 4] += tv3rhotauexx4;

  tv3rhotauexx5 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 5] += tv3rhotauexx5;

  tv3rhotauexx6 = 0.e0;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 6] += tv3rhotauexx6;

  t2215 = t2086 * t352;
  t2219 = my_piecewise3(t77, 0, -t853 * t1010 / 0.16e2 - t2204 + 0.7e1 / 0.48e2 * t359 * t2215);
  tv3rhotauexx7 = t2219 * t7 + t1013;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 7] += tv3rhotauexx7;

  tv3rhoexx20 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 0] += tv3rhoexx20;

  tv3rhoexx21 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 1] += tv3rhoexx21;

  tv3rhoexx22 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 2] += tv3rhoexx22;

  tv3rhoexx23 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 3] += tv3rhoexx23;

  tv3rhoexx24 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 4] += tv3rhoexx24;

  tv3rhoexx25 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 5] += tv3rhoexx25;

  t2229 = t867 * t275;
  t2230 = t1092 * t2229;
  t2234 = t275 * t886;
  t2239 = 0.1e1 / t48 / t430;
  t2243 = 0.1e1 / t430;
  t2253 = 0.945e-2 * t2239 * t50 * t52 - 0.945e-2 * t2243 * t46 * t160 - 0.315e-2 * t877 * t883 * t436 + 0.945e-2 / t1107 * t1119;
  t2254 = t154 * t2253;
  t2258 = 0.55999999999999999998e-2 * t41 * t659 * t867 - 0.27999999999999999999e-2 * t41 * t650 * t886 - 0.55999999999999999998e-2 * t41 * t47 * t2230 + 0.55999999999999999998e-2 * t658 * t659 * t2234 - 0.93333333333333333332e-3 * t41 * t47 * t2254;
  t2260 = -0.3e1 / 0.8e1 * t262 * t891 + t34 * t2258;
  t2264 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2260);
  tv3sigma30 = t7 * t2264;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  t2273 = t903 * t304;
  t2274 = t1404 * t2273;
  t2278 = t304 * t922;
  t2283 = 0.1e1 / t97 / t602;
  t2287 = 0.1e1 / t602;
  t2297 = 0.945e-2 * t2283 * t99 * t101 - 0.945e-2 * t2287 * t95 * t238 - 0.315e-2 * t913 * t919 * t608 + 0.945e-2 / t1419 * t1431;
  t2298 = t232 * t2297;
  t2302 = 0.55999999999999999998e-2 * t41 * t732 * t903 - 0.27999999999999999999e-2 * t41 * t723 * t922 - 0.55999999999999999998e-2 * t41 * t96 * t2274 + 0.55999999999999999998e-2 * t731 * t732 * t2278 - 0.93333333333333333332e-3 * t41 * t96 * t2298;
  t2304 = -0.3e1 / 0.8e1 * t291 * t927 + t90 * t2302;
  t2308 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2304);
  tv3sigma39 = t7 * t2308;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 10] += tv3sigma2lapl10;

  tv3sigma2lapl11 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 11] += tv3sigma2lapl11;

  t2311 = t321 * t891;
  t2314 = t934 * t280 / 0.4e1 + t30 * t2311 / 0.8e1;
  t2318 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2314);
  tv3sigma2tau0 = t7 * t2318;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 10] += tv3sigma2tau10;

  t2321 = t335 * t927;
  t2324 = t949 * t309 / 0.4e1 + t86 * t2321 / 0.8e1;
  t2328 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2324);
  tv3sigma2tau11 = t7 * t2328;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 11] += tv3sigma2tau11;

  tv3sigma2exx0 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 0] += tv3sigma2exx0;

  tv3sigma2exx1 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 1] += tv3sigma2exx1;

  tv3sigma2exx2 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 2] += tv3sigma2exx2;

  tv3sigma2exx3 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 3] += tv3sigma2exx3;

  tv3sigma2exx4 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 4] += tv3sigma2exx4;

  tv3sigma2exx5 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 5] += tv3sigma2exx5;

  tv3sigma2exx6 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 6] += tv3sigma2exx6;

  tv3sigma2exx7 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 7] += tv3sigma2exx7;

  tv3sigma2exx8 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 8] += tv3sigma2exx8;

  tv3sigma2exx9 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 9] += tv3sigma2exx9;

  tv3sigma2exx10 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 10] += tv3sigma2exx10;

  tv3sigma2exx11 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 11] += tv3sigma2exx11;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 7] += tv3sigmalapl27;

  tv3sigmalapl28 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 11] += tv3sigmalapltau11;

  tv3sigmalaplexx0 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 0] += tv3sigmalaplexx0;

  tv3sigmalaplexx1 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 1] += tv3sigmalaplexx1;

  tv3sigmalaplexx2 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 2] += tv3sigmalaplexx2;

  tv3sigmalaplexx3 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 3] += tv3sigmalaplexx3;

  tv3sigmalaplexx4 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 4] += tv3sigmalaplexx4;

  tv3sigmalaplexx5 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 5] += tv3sigmalaplexx5;

  tv3sigmalaplexx6 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 6] += tv3sigmalaplexx6;

  tv3sigmalaplexx7 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 7] += tv3sigmalaplexx7;

  tv3sigmalaplexx8 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 8] += tv3sigmalaplexx8;

  tv3sigmalaplexx9 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 9] += tv3sigmalaplexx9;

  tv3sigmalaplexx10 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 10] += tv3sigmalaplexx10;

  tv3sigmalaplexx11 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 11] += tv3sigmalaplexx11;

  t2329 = t29 * t979;
  t2332 = t979 * t280;
  t2335 = t63 * t979;
  t2339 = -t2329 * t60 / 0.4e1 - t30 * t2332 / 0.4e1 - t2335 * exx[0] * t69 / 0.9e1;
  t2343 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t2339);
  tv3sigmatau20 = t7 * t2343;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 7] += tv3sigmatau27;

  t2344 = t85 * t993;
  t2347 = t993 * t309;
  t2350 = t112 * t993;
  t2354 = -t2344 * t109 / 0.4e1 - t86 * t2347 / 0.4e1 - t2350 * exx[1] * t69 / 0.9e1;
  t2358 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * t2354);
  tv3sigmatau28 = t7 * t2358;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 8] += tv3sigmatau28;

  t2360 = t321 * t38 * t68;
  t2363 = my_piecewise3(t2, 0, -t965 * t2360 / 0.16e2);
  tv3sigmatauexx0 = t7 * t2363;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 0] += tv3sigmatauexx0;

  tv3sigmatauexx1 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 1] += tv3sigmatauexx1;

  tv3sigmatauexx2 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 2] += tv3sigmatauexx2;

  tv3sigmatauexx3 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 3] += tv3sigmatauexx3;

  tv3sigmatauexx4 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 4] += tv3sigmatauexx4;

  tv3sigmatauexx5 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 5] += tv3sigmatauexx5;

  tv3sigmatauexx6 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 6] += tv3sigmatauexx6;

  tv3sigmatauexx7 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 7] += tv3sigmatauexx7;

  tv3sigmatauexx8 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 8] += tv3sigmatauexx8;

  tv3sigmatauexx9 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 9] += tv3sigmatauexx9;

  tv3sigmatauexx10 = 0.e0;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 10] += tv3sigmatauexx10;

  t2365 = t335 * t38 * t68;
  t2368 = my_piecewise3(t77, 0, -t972 * t2365 / 0.16e2);
  tv3sigmatauexx11 = t7 * t2368;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 11] += tv3sigmatauexx11;

  tv3sigmaexx20 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 0] += tv3sigmaexx20;

  tv3sigmaexx21 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 1] += tv3sigmaexx21;

  tv3sigmaexx22 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 2] += tv3sigmaexx22;

  tv3sigmaexx23 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 3] += tv3sigmaexx23;

  tv3sigmaexx24 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 4] += tv3sigmaexx24;

  tv3sigmaexx25 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 5] += tv3sigmaexx25;

  tv3sigmaexx26 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 6] += tv3sigmaexx26;

  tv3sigmaexx27 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 7] += tv3sigmaexx27;

  tv3sigmaexx28 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 8] += tv3sigmaexx28;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 2] += tv3lapl32;

  tv3lapl33 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapl2exx0 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 0] += tv3lapl2exx0;

  tv3lapl2exx1 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 1] += tv3lapl2exx1;

  tv3lapl2exx2 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 2] += tv3lapl2exx2;

  tv3lapl2exx3 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 3] += tv3lapl2exx3;

  tv3lapl2exx4 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 4] += tv3lapl2exx4;

  tv3lapl2exx5 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 5] += tv3lapl2exx5;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 5] += tv3lapltau25;

  tv3lapltauexx0 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 0] += tv3lapltauexx0;

  tv3lapltauexx1 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 1] += tv3lapltauexx1;

  tv3lapltauexx2 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 2] += tv3lapltauexx2;

  tv3lapltauexx3 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 3] += tv3lapltauexx3;

  tv3lapltauexx4 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 4] += tv3lapltauexx4;

  tv3lapltauexx5 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 5] += tv3lapltauexx5;

  tv3lapltauexx6 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 6] += tv3lapltauexx6;

  tv3lapltauexx7 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 7] += tv3lapltauexx7;

  tv3laplexx20 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 0] += tv3laplexx20;

  tv3laplexx21 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 1] += tv3laplexx21;

  tv3laplexx22 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 2] += tv3laplexx22;

  tv3laplexx23 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 3] += tv3laplexx23;

  tv3laplexx24 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 4] += tv3laplexx24;

  tv3laplexx25 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 5] += tv3laplexx25;

  t2369 = t320 * t320;
  t2370 = 0.1e1 / t2369;
  t2382 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.4e1 * t30 * t2370 * t60 + t64 * t2370 * exx[0] * t69 / 0.3e1));
  tv3tau30 = t7 * t2382;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 2] += tv3tau32;

  t2383 = t334 * t334;
  t2384 = 0.1e1 / t2383;
  t2396 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.4e1 * t86 * t2384 * t109 + t113 * t2384 * exx[1] * t69 / 0.3e1));
  tv3tau33 = t7 * t2396;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 3] += tv3tau33;

  t2397 = t2335 * t352;
  t2400 = my_piecewise3(t2, 0, t350 * t2397 / 0.8e1);
  tv3tau2exx0 = t7 * t2400;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 0] += tv3tau2exx0;

  tv3tau2exx1 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 1] += tv3tau2exx1;

  tv3tau2exx2 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 2] += tv3tau2exx2;

  tv3tau2exx3 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 3] += tv3tau2exx3;

  tv3tau2exx4 = 0.e0;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 4] += tv3tau2exx4;

  t2401 = t2350 * t352;
  t2404 = my_piecewise3(t77, 0, t359 * t2401 / 0.8e1);
  tv3tau2exx5 = t7 * t2404;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 5] += tv3tau2exx5;

  tv3tauexx20 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 0] += tv3tauexx20;

  tv3tauexx21 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 1] += tv3tauexx21;

  tv3tauexx22 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 2] += tv3tauexx22;

  tv3tauexx23 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 3] += tv3tauexx23;

  tv3tauexx24 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 4] += tv3tauexx24;

  tv3tauexx25 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 5] += tv3tauexx25;

  tv3exx30 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 0] += tv3exx30;

  tv3exx31 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 1] += tv3exx31;

  tv3exx32 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 2] += tv3exx32;

  tv3exx33 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 3] += tv3exx33;

  t2408 = t6 * t137 * t1133;
  t2423 = sigma[0] / t44 / t669;
  t2446 = 0.1e1 / t1091 / t55;
  t2447 = t420 * t420;
  t2456 = t439 * t439;
  t2475 = t1107 * t408;
  t2480 = t430 * t430;
  t2487 = 0.1e1 / t159 / t1117 / t158;
  t2495 = 0.24133004115226337449e0 * t41 * t2423 * t56 + 0.17035061728395061728e0 * t41 * t1078 * t164 + 0.10951111111111111111e0 * t41 * t411 * t421 - 0.54755555555555555556e-1 * t41 * t411 * t440 + 0.59733333333333333332e-1 * t41 * t149 * t1094 - 0.59733333333333333332e-1 * t658 * t1498 * t1098 + 0.99555555555555555556e-2 * t41 * t149 * t1123 + 0.22399999999999999999e-1 * t41 * t47 * t2446 * t2447 - 0.33599999999999999998e-1 * t658 * t1505 * t420 * t439 + 0.55999999999999999998e-2 * t41 * t47 * t419 * t2456 + 0.74666666666666666664e-2 * t658 * t659 * t163 * t1122 - 0.93333333333333333332e-3 * t41 * t47 * t154 * (0.11324444444444444444e1 * t48 * t883 * t52 + 0.53834666666666666666e1 * t2423 * t160 - 0.57891555555555555555e1 * t430 / t43 / t1935 * t436 + 0.41813333333333333333e1 * t1113 / t2475 * t1119 - 0.11946666666666666667e1 * t2480 / t44 / t1107 / t669 * t2487);
  t2509 = t6 * t1057 * t176;
  t2512 = t6 * t394 * t452;
  t2514 = t20 * t20;
  t2516 = 0.1e1 / t366 / t2514;
  t2517 = t368 * t368;
  t2523 = t376 * t376;
  t2530 = t17 / t1024 / t7;
  t2532 = -0.24e2 * t1025 + 0.24e2 * t2530;
  t2533 = my_piecewise5(t11, 0, t15, 0, t2532);
  t2537 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t2516 * t2517 - 0.16e2 / 0.9e1 * t1017 * t368 * t376 + 0.4e1 / 0.3e1 * t367 * t2523 + 0.16e2 / 0.9e1 * t1021 * t1029 + 0.4e1 / 0.3e1 * t24 * t2533);
  t2546 = t6 * t1038 * t176;
  t2552 = t6 * t1045 * t176;
  t2554 = t6 * t385 * t452;
  t2557 = 0.1e1 / t135 / t371;
  t2561 = 0.1e2 / 0.27e2 * t6 * t26 * t2557 * t72;
  t2564 = t6 * t130 * t1056 * t72;
  t2568 = t6 * t1033 * t136 * t72;
  t2572 = t6 * t380 * t393 * t72;
  t2574 = -t2408 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t28 * (-0.3e1 * sigma[0] / t881 * t143 + 0.3e1 * t1068 * t405 - 0.3e1 / 0.2e1 * t402 * t1073 + t142 * t31 * t1127 / 0.2e1 + t34 * t2495 - 0.728e4 / 0.729e3 * sigma[0] * t671 * t65 * t69) - 0.3e1 / 0.2e1 * t6 * t131 * t1133 - 0.5e1 / 0.9e1 * t2509 + t2512 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t2537 * t27 * t72 - 0.3e1 / 0.2e1 * t6 * t1034 * t176 - 0.3e1 / 0.2e1 * t2546 - 0.9e1 / 0.4e1 * t6 * t381 * t452 + t2552 - 0.3e1 / 0.2e1 * t2554 + t2561 - 0.5e1 / 0.9e1 * t2564 - t2568 / 0.2e1 + t2572 / 0.2e1;
  t2575 = my_piecewise3(t2, 0, t2574);
  t2576 = t79 * t79;
  t2578 = 0.1e1 / t458 / t2576;
  t2579 = t460 * t460;
  t2585 = t464 * t464;
  t2591 = my_piecewise5(t15, 0, t11, 0, -t2532);
  t2595 = my_piecewise3(t80, 0, 0.4e2 / 0.81e2 * t2578 * t2579 - 0.16e2 / 0.9e1 * t1140 * t460 * t464 + 0.4e1 / 0.3e1 * t459 * t2585 + 0.16e2 / 0.9e1 * t1144 * t1148 + 0.4e1 / 0.3e1 * t81 * t2591);
  t2602 = t6 * t1152 * t136 * t118;
  t2606 = t6 * t468 * t393 * t118;
  t2610 = t6 * t186 * t1056 * t118;
  t2615 = 0.1e2 / 0.27e2 * t6 * t83 * t2557 * t118;
  t2617 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t2595 * t27 * t118 - t2602 / 0.2e1 + t2606 / 0.2e1 - 0.5e1 / 0.9e1 * t2610 + t2615);
  tv4rho40 = 0.4e1 * t1138 + 0.4e1 * t1170 + t7 * (t2575 + t2617);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t2624 = t6 * t203 * t1056 * t72;
  t2628 = t6 * t1190 * t136 * t72;
  t2632 = t6 * t493 * t393 * t72;
  t2633 = t2632 / 0.4e1;
  t2635 = t6 * t1202 * t176;
  t2636 = t2635 / 0.4e1;
  t2638 = t6 * t498 * t452;
  t2659 = 0.12e2 * t1025;
  t2660 = 0.24e2 * t2530;
  t2661 = -t2659 + t2660;
  t2662 = my_piecewise5(t11, 0, t15, 0, t2661);
  t2666 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t2516 * t200 * t1018 - 0.8e1 / 0.9e1 * t1017 * t489 * t368 - 0.8e1 / 0.9e1 * t1175 * t127 * t376 + 0.4e1 / 0.3e1 * t367 * t1186 * t127 + 0.4e1 / 0.3e1 * t1178 * t376 + 0.4e1 / 0.9e1 * t485 * t1029 + 0.4e1 / 0.3e1 * t24 * t2662);
  t2675 = t6 * t1195 * t176;
  t2689 = -0.5e1 / 0.36e2 * t2624 - 0.3e1 / 0.8e1 * t2628 + t2633 + t2636 - 0.3e1 / 0.8e1 * t2638 - 0.3e1 / 0.8e1 * t6 * t204 * t1133 - 0.3e1 / 0.8e1 * t6 * t2666 * t27 * t72 - 0.9e1 / 0.8e1 * t6 * t1191 * t176 - 0.3e1 / 0.4e1 * t2675 - 0.9e1 / 0.8e1 * t6 * t494 * t452 - t2408 / 0.8e1 - 0.5e1 / 0.12e2 * t2509 + t2512 / 0.4e1 - 0.3e1 / 0.8e1 * t2546 + t2552 / 0.2e1 - 0.3e1 / 0.8e1 * t2554 + t2561 - 0.5e1 / 0.12e2 * t2564 - t2568 / 0.8e1 + t2572 / 0.4e1;
  t2690 = my_piecewise3(t2, 0, t2689);
  t2708 = my_piecewise5(t15, 0, t11, 0, -t2661);
  t2712 = my_piecewise3(t80, 0, 0.4e2 / 0.81e2 * t2578 * t211 * t1141 - 0.8e1 / 0.9e1 * t1140 * t512 * t460 - 0.8e1 / 0.9e1 * t1219 * t183 * t464 + 0.4e1 / 0.3e1 * t459 * t1228 * t183 + 0.4e1 / 0.3e1 * t1222 * t464 + 0.4e1 / 0.9e1 * t509 * t1148 + 0.4e1 / 0.3e1 * t81 * t2708);
  t2719 = t6 * t1232 * t136 * t118;
  t2723 = t6 * t516 * t393 * t118;
  t2724 = t2723 / 0.4e1;
  t2727 = t6 * t214 * t1056 * t118;
  t2736 = t6 * t1157 * t254;
  t2739 = t6 * t1161 * t254;
  t2740 = t2739 / 0.4e1;
  t2742 = t6 * t1165 * t254;
  t2744 = -0.3e1 / 0.8e1 * t6 * t2712 * t27 * t118 - 0.3e1 / 0.8e1 * t2719 + t2724 - 0.5e1 / 0.36e2 * t2727 - t2602 / 0.8e1 + t2606 / 0.4e1 - 0.5e1 / 0.12e2 * t2610 + t2615 - 0.3e1 / 0.8e1 * t6 * t1153 * t254 - 0.3e1 / 0.8e1 * t2736 + t2740 - 0.5e1 / 0.36e2 * t2742;
  t2745 = my_piecewise3(t77, 0, t2744);
  tv4rho41 = t1138 + t1170 + 0.3e1 * t1218 + 0.3e1 * t1257 + t7 * (t2690 + t2745);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 1] += tv4rho41;

  t2760 = t489 * t489;
  t2773 = my_piecewise5(t11, 0, t15, 0, t2660);
  t2777 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t2516 * t538 * t368 - 0.32e2 / 0.27e2 * t1175 * t127 * t489 - 0.8e1 / 0.27e2 * t1260 * t376 + 0.8e1 / 0.9e1 * t367 * t2760 + 0.8e1 / 0.9e1 * t485 * t1186 - 0.8e1 / 0.27e2 * t1017 * t543 * t368 + 0.8e1 / 0.9e1 * t367 * t1269 * t127 + 0.4e1 / 0.9e1 * t1265 * t376 + 0.4e1 / 0.3e1 * t24 * t2773);
  t2786 = t6 * t1278 * t176;
  t2793 = t6 * t1273 * t136 * t72;
  t2797 = t6 * t547 * t393 * t72;
  t2810 = -0.3e1 / 0.8e1 * t6 * t2777 * t27 * t72 - 0.3e1 / 0.4e1 * t6 * t1274 * t176 - t2786 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t548 * t452 - t2793 / 0.4e1 + t2797 / 0.12e2 - 0.5e1 / 0.18e2 * t2624 - t2628 / 0.4e1 + t2632 / 0.3e1 + t2635 / 0.3e1 - t2638 / 0.4e1 - t2675 / 0.2e1 - 0.5e1 / 0.18e2 * t2509 + t2512 / 0.12e2 + t2552 / 0.6e1 + t2561 - 0.5e1 / 0.18e2 * t2564 + t2572 / 0.12e2;
  t2811 = my_piecewise3(t2, 0, t2810);
  t2820 = t512 * t512;
  t2833 = my_piecewise5(t15, 0, t11, 0, -t2660);
  t2837 = my_piecewise3(t80, 0, 0.4e2 / 0.81e2 * t2578 * t555 * t460 - 0.32e2 / 0.27e2 * t1219 * t183 * t512 - 0.8e1 / 0.27e2 * t1290 * t464 + 0.8e1 / 0.9e1 * t459 * t2820 + 0.8e1 / 0.9e1 * t509 * t1228 - 0.8e1 / 0.27e2 * t1140 * t559 * t460 + 0.8e1 / 0.9e1 * t459 * t1299 * t183 + 0.4e1 / 0.9e1 * t1295 * t464 + 0.4e1 / 0.3e1 * t81 * t2833);
  t2844 = t6 * t1303 * t136 * t118;
  t2848 = t6 * t563 * t393 * t118;
  t2857 = t6 * t1237 * t254;
  t2860 = t6 * t1241 * t254;
  t2871 = t6 * t473 * t624;
  t2874 = t6 * t477 * t624;
  t2876 = -0.3e1 / 0.8e1 * t6 * t2837 * t27 * t118 - t2844 / 0.4e1 + t2848 / 0.12e2 - t2719 / 0.4e1 + t2723 / 0.3e1 - 0.5e1 / 0.18e2 * t2727 - 0.3e1 / 0.4e1 * t6 * t1233 * t254 - t2857 / 0.2e1 + t2860 / 0.6e1 + t2606 / 0.12e2 - 0.5e1 / 0.18e2 * t2610 + t2615 - t2736 / 0.4e1 + t2739 / 0.3e1 - 0.5e1 / 0.18e2 * t2742 - 0.3e1 / 0.8e1 * t6 * t469 * t624 - t2871 / 0.4e1 + t2874 / 0.12e2;
  t2877 = my_piecewise3(t77, 0, t2876);
  tv4rho42 = 0.2e1 * t1218 + 0.2e1 * t1257 + 0.2e1 * t1289 + 0.2e1 * t1328 + t7 * (t2811 + t2877);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 2] += tv4rho42;

  t2897 = t2659 + t2660;
  t2898 = my_piecewise5(t11, 0, t15, 0, t2897);
  t2902 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t2516 * t1333 * t127 - 0.8e1 / 0.9e1 * t1260 * t489 - 0.8e1 / 0.9e1 * t1175 * t543 * t127 + 0.4e1 / 0.3e1 * t1178 * t543 + 0.4e1 / 0.3e1 * t485 * t1269 + 0.4e1 / 0.9e1 * t367 * t1340 * t127 + 0.4e1 / 0.3e1 * t24 * t2898);
  t2909 = t6 * t1344 * t136 * t72;
  t2920 = -0.3e1 / 0.8e1 * t6 * t2902 * t27 * t72 - t2909 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t1345 * t176 - 0.3e1 / 0.8e1 * t2793 + t2797 / 0.4e1 - 0.3e1 / 0.8e1 * t2786 + t2633 - 0.5e1 / 0.12e2 * t2624 + t2636 - 0.5e1 / 0.36e2 * t2564 + t2561 - 0.5e1 / 0.36e2 * t2509;
  t2921 = my_piecewise3(t2, 0, t2920);
  t2938 = my_piecewise5(t15, 0, t11, 0, -t2897);
  t2942 = my_piecewise3(t80, 0, 0.4e2 / 0.81e2 * t2578 * t1353 * t183 - 0.8e1 / 0.9e1 * t1290 * t512 - 0.8e1 / 0.9e1 * t1219 * t559 * t183 + 0.4e1 / 0.3e1 * t1222 * t559 + 0.4e1 / 0.3e1 * t509 * t1299 + 0.4e1 / 0.9e1 * t459 * t1359 * t183 + 0.4e1 / 0.3e1 * t81 * t2938);
  t2949 = t6 * t1363 * t136 * t118;
  t2957 = t6 * t1308 * t254;
  t2966 = t6 * t521 * t624;
  t2976 = t6 * t191 * t1445;
  t2978 = -0.3e1 / 0.8e1 * t6 * t2942 * t27 * t118 - t2949 / 0.8e1 - 0.3e1 / 0.8e1 * t2844 + t2848 / 0.4e1 - 0.9e1 / 0.8e1 * t6 * t1304 * t254 - 0.3e1 / 0.8e1 * t2957 + t2724 - 0.5e1 / 0.12e2 * t2727 - 0.3e1 / 0.4e1 * t2857 + t2860 / 0.2e1 - 0.9e1 / 0.8e1 * t6 * t517 * t624 - 0.3e1 / 0.8e1 * t2966 - 0.5e1 / 0.36e2 * t2610 + t2615 + t2740 - 0.5e1 / 0.12e2 * t2742 - 0.3e1 / 0.8e1 * t2871 + t2874 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t187 * t1445 - t2976 / 0.8e1;
  t2979 = my_piecewise3(t77, 0, t2978);
  tv4rho43 = 0.3e1 * t1289 + 0.3e1 * t1328 + t1352 + t1450 + t7 * (t2921 + t2979);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 3] += tv4rho43;

  t2984 = t538 * t538;
  t2989 = t543 * t543;
  t2995 = 0.24e2 * t1025 + 0.24e2 * t2530;
  t2996 = my_piecewise5(t11, 0, t15, 0, t2995);
  t3000 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t2516 * t2984 - 0.16e2 / 0.9e1 * t1260 * t543 + 0.4e1 / 0.3e1 * t367 * t2989 + 0.16e2 / 0.9e1 * t485 * t1340 + 0.4e1 / 0.3e1 * t24 * t2996);
  t3009 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t3000 * t27 * t72 - t2909 / 0.2e1 + t2797 / 0.2e1 - 0.5e1 / 0.9e1 * t2624 + t2561);
  t3023 = sigma[2] / t93 / t742;
  t3046 = 0.1e1 / t1403 / t104;
  t3047 = t592 * t592;
  t3056 = t611 * t611;
  t3075 = t1419 * t580;
  t3080 = t602 * t602;
  t3087 = 0.1e1 / t237 / t1429 / t236;
  t3095 = 0.24133004115226337449e0 * t41 * t3023 * t105 + 0.17035061728395061728e0 * t41 * t1390 * t242 + 0.10951111111111111111e0 * t41 * t583 * t593 - 0.54755555555555555556e-1 * t41 * t583 * t612 + 0.59733333333333333332e-1 * t41 * t227 * t1406 - 0.59733333333333333332e-1 * t731 * t1638 * t1410 + 0.99555555555555555556e-2 * t41 * t227 * t1435 + 0.22399999999999999999e-1 * t41 * t96 * t3046 * t3047 - 0.33599999999999999998e-1 * t731 * t1645 * t592 * t611 + 0.55999999999999999998e-2 * t41 * t96 * t591 * t3056 + 0.74666666666666666664e-2 * t731 * t732 * t241 * t1434 - 0.93333333333333333332e-3 * t41 * t96 * t232 * (0.11324444444444444444e1 * t97 * t919 * t101 + 0.53834666666666666666e1 * t3023 * t238 - 0.57891555555555555555e1 * t602 / t92 / t2012 * t608 + 0.41813333333333333333e1 * t1425 / t3075 * t1431 - 0.11946666666666666667e1 * t3080 / t93 / t1419 / t742 * t3087);
  t3108 = t555 * t555;
  t3113 = t559 * t559;
  t3119 = my_piecewise5(t15, 0, t11, 0, -t2995);
  t3123 = my_piecewise3(t80, 0, 0.4e2 / 0.81e2 * t2578 * t3108 - 0.16e2 / 0.9e1 * t1290 * t559 + 0.4e1 / 0.3e1 * t459 * t3113 + 0.16e2 / 0.9e1 * t509 * t1359 + 0.4e1 / 0.3e1 * t81 * t3119);
  t3142 = -0.3e1 / 0.8e1 * t6 * t84 * (-0.3e1 * sigma[2] / t917 * t221 + 0.3e1 * t1380 * t577 - 0.3e1 / 0.2e1 * t574 * t1385 + t220 * t87 * t1439 / 0.2e1 + t90 * t3095 - 0.728e4 / 0.729e3 * sigma[2] * t744 * t114 * t69) - 0.3e1 / 0.2e1 * t6 * t215 * t1445 - 0.3e1 / 0.8e1 * t6 * t3123 * t27 * t118 - 0.3e1 / 0.2e1 * t6 * t1364 * t254 - 0.9e1 / 0.4e1 * t6 * t564 * t624 - t2976 / 0.2e1 - t2949 / 0.2e1 - 0.3e1 / 0.2e1 * t2957 - 0.3e1 / 0.2e1 * t2966 + t2874 / 0.2e1 + t2848 / 0.2e1 + t2860 - 0.5e1 / 0.9e1 * t2727 - 0.5e1 / 0.9e1 * t2742 + t2615;
  t3143 = my_piecewise3(t77, 0, t3142);
  tv4rho44 = 0.4e1 * t1352 + 0.4e1 * t1450 + t7 * (t3009 + t3143);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 4] += tv4rho44;

  t3151 = t6 * t1038 * t286;
  t3157 = t6 * t1045 * t286;
  t3160 = t6 * t385 * t686;
  t3167 = 0.5e1 / 0.36e2 * t6 * t1057 * t286;
  t3169 = t6 * t394 * t686;
  t3172 = t6 * t137 * t1542;
  t3252 = t410 * t154;
  t3270 = t148 * t1092;
  t3274 = t46 * t2446;
  t3283 = 0.55999999999999999998e-2 * t658 * t659 * t1531 * t163 - 0.42587654320987654321e-1 * t39 * t40 * t1077 * t56 - 0.27377777777777777778e-1 * t41 * t3252 * t163 + 0.74666666666666666667e-2 * t41 * t1485 * t439 - 0.93333333333333333332e-3 * t41 * t650 * t1122 - 0.14933333333333333333e-1 * t41 * t1498 * t420 - 0.55999999999999999998e-2 * t41 * t1505 * t1093 + 0.55999999999999999998e-2 * t41 * t1099 + 0.44799999999999999999e-1 * t658 * t3270 * t1506 + 0.22399999999999999999e-1 * t658 * t3274 * t275 * t1093 - 0.168e-1 * t658 * t1505 * t660 * t439;
  t3286 = t883 * t31;
  t3295 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1034 * t286 - 0.3e1 / 0.8e1 * t3151 - 0.9e1 / 0.8e1 * t6 * t381 * t686 + t3157 / 0.4e1 - 0.3e1 / 0.4e1 * t3160 - 0.9e1 / 0.8e1 * t6 * t131 * t1542 - t3167 + t3169 / 0.4e1 - 0.3e1 / 0.8e1 * t3172 - 0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.4e1 * t1067 * t31 * t60 - 0.3e1 / 0.4e1 * t1469 * t168 + 0.3e1 / 0.8e1 * t638 * t444 - t262 * t1127 / 0.8e1 + 0.3e1 / 0.4e1 * t1068 * t643 - 0.3e1 / 0.4e1 * t402 * t1478 + 0.3e1 / 0.8e1 * t142 * t31 * t1536 + t34 * (-0.27377777777777777778e-1 * t41 * t411 * t676 + 0.74666666666666666667e-2 * t41 * t149 * t1532 - 0.93333333333333333332e-3 * t41 * t47 * t154 * (-0.13066666666666666667e0 * t269 * t447 * t52 - 0.10192e1 * t1077 * t160 + 0.15493333333333333334e1 * t1109 * t436 * sigma[0] - 0.13664e1 * t1115 * t1119 * t430 + 0.448e0 / t44 / t1107 / t881 * t2487 * t1113) + 0.55999999999999999998e-2 * t658 * t659 * t675 * t439 + 0.18666666666666666666e-2 * t658 * t659 * t275 * t1122 + 0.42587654320987654321e-1 * t41 * t1078 * t276 + 0.54755555555555555555e-1 * t658 * t410 * t419 * t660 - 0.29866666666666666666e-1 * t658 * t1498 * t1510 - 0.14933333333333333333e-1 * t658 * t1498 * t1514 - 0.168e-1 * t658 * t1505 * t675 * t420 + t3283) + 0.455e3 / 0.243e3 * t3286 * exx[0] * t69));
  tv4rho3sigma0 = t3295 * t7 + 0.3e1 * t1547;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 1] += tv4rho3sigma1;

  t3302 = t6 * t1157 * t315;
  t3305 = t6 * t1161 * t315;
  t3309 = 0.5e1 / 0.36e2 * t6 * t1165 * t315;
  t3311 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1153 * t315 - 0.3e1 / 0.8e1 * t3302 + t3305 / 0.4e1 - t3309);
  tv4rho3sigma2 = t3311 * t7 + 0.3e1 * t1560;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 2] += tv4rho3sigma2;

  t3313 = 0.2e1 * t1574;
  t3319 = t6 * t1195 * t286 / 0.4e1;
  t3324 = t6 * t1202 * t286;
  t3328 = t6 * t498 * t686 / 0.4e1;
  t3337 = -0.3e1 / 0.8e1 * t6 * t1191 * t286 - t3319 - 0.3e1 / 0.4e1 * t6 * t494 * t686 + t3324 / 0.12e2 - t3328 - 0.3e1 / 0.8e1 * t6 * t204 * t1542 - t3151 / 0.8e1 + t3157 / 0.6e1 - t3160 / 0.4e1 - t3167 + t3169 / 0.6e1 - t3172 / 0.8e1;
  t3338 = my_piecewise3(t2, 0, t3337);
  tv4rho3sigma3 = t3338 * t7 + t1547 + t3313;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 4] += tv4rho3sigma4;

  t3340 = 0.2e1 * t1590;
  t3346 = t6 * t1237 * t315 / 0.4e1;
  t3348 = t6 * t1241 * t315;
  t3357 = t6 * t473 * t759 / 0.4e1;
  t3359 = t6 * t477 * t759;
  t3362 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1233 * t315 - t3346 + t3348 / 0.12e2 - t3302 / 0.8e1 + t3305 / 0.6e1 - t3309 - 0.3e1 / 0.8e1 * t6 * t469 * t759 - t3357 + t3359 / 0.12e2);
  tv4rho3sigma5 = t3362 * t7 + t1560 + t3340;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 5] += tv4rho3sigma5;

  t3368 = t6 * t1278 * t286;
  t3377 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1274 * t286 - t3368 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t548 * t686 - t3319 + t3324 / 0.6e1 - t3328 + t3157 / 0.12e2 - t3167 + t3169 / 0.12e2);
  tv4rho3sigma6 = t3377 * t7 + t1598 + t3313;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 7] += tv4rho3sigma7;

  t3383 = t6 * t1308 * t315;
  t3390 = t6 * t521 * t759;
  t3398 = t6 * t191 * t1682;
  t3400 = -0.3e1 / 0.8e1 * t6 * t1304 * t315 - t3383 / 0.8e1 - t3346 + t3348 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t517 * t759 - t3390 / 0.4e1 + t3305 / 0.12e2 - t3309 - t3357 + t3359 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t187 * t1682 - t3398 / 0.8e1;
  t3401 = my_piecewise3(t77, 0, t3400);
  tv4rho3sigma8 = t3401 * t7 + t1687 + t3340;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 8] += tv4rho3sigma8;

  t3410 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1345 * t286 - 0.3e1 / 0.8e1 * t3368 + t3324 / 0.4e1 - t3167);
  tv4rho3sigma9 = t3410 * t7 + 0.3e1 * t1598;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 10] += tv4rho3sigma10;

  t3443 = t226 * t1404;
  t3447 = t95 * t3046;
  t3529 = t582 * t232;
  t3536 = 0.18666666666666666666e-2 * t731 * t732 * t304 * t1434 - 0.55999999999999999998e-2 * t41 * t1645 * t1405 + 0.55999999999999999998e-2 * t41 * t1411 - 0.27377777777777777778e-1 * t41 * t583 * t749 + 0.74666666666666666667e-2 * t41 * t227 * t1672 - 0.93333333333333333332e-3 * t41 * t96 * t232 * (-0.13066666666666666667e0 * t298 * t619 * t101 - 0.10192e1 * t1389 * t238 + 0.15493333333333333334e1 * t1421 * t608 * sigma[2] - 0.13664e1 * t1427 * t1431 * t602 + 0.448e0 / t93 / t1419 / t917 * t3087 * t1425) - 0.14933333333333333333e-1 * t41 * t1638 * t592 - 0.93333333333333333332e-3 * t41 * t723 * t1434 - 0.42587654320987654321e-1 * t39 * t40 * t1389 * t105 - 0.27377777777777777778e-1 * t41 * t3529 * t241 + 0.74666666666666666667e-2 * t41 * t1625 * t611;
  t3539 = t919 * t87;
  t3548 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1364 * t315 - 0.3e1 / 0.8e1 * t3383 - 0.9e1 / 0.8e1 * t6 * t564 * t759 + t3348 / 0.4e1 - 0.3e1 / 0.4e1 * t3390 - 0.9e1 / 0.8e1 * t6 * t215 * t1682 - t3309 + t3359 / 0.4e1 - 0.3e1 / 0.8e1 * t3398 - 0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.4e1 * t1379 * t87 * t109 - 0.3e1 / 0.4e1 * t1609 * t246 + 0.3e1 / 0.8e1 * t711 * t616 - t291 * t1439 / 0.8e1 + 0.3e1 / 0.4e1 * t1380 * t716 - 0.3e1 / 0.4e1 * t574 * t1618 + 0.3e1 / 0.8e1 * t220 * t87 * t1676 + t90 * (0.44799999999999999999e-1 * t731 * t3443 * t1646 + 0.22399999999999999999e-1 * t731 * t3447 * t304 * t1405 - 0.168e-1 * t731 * t1645 * t733 * t611 + 0.42587654320987654321e-1 * t41 * t1390 * t305 + 0.54755555555555555555e-1 * t731 * t582 * t591 * t733 - 0.29866666666666666666e-1 * t731 * t1638 * t1650 - 0.14933333333333333333e-1 * t731 * t1638 * t1654 - 0.168e-1 * t731 * t1645 * t748 * t592 + 0.55999999999999999998e-2 * t731 * t732 * t1671 * t241 + 0.55999999999999999998e-2 * t731 * t732 * t748 * t611 + t3536) + 0.455e3 / 0.243e3 * t3539 * exx[1] * t69));
  tv4rho3sigma11 = t3548 * t7 + 0.3e1 * t1687;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 11] += tv4rho3sigma11;

  tv4rho3lapl0 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 0] += tv4rho3lapl0;

  tv4rho3lapl1 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 1] += tv4rho3lapl1;

  tv4rho3lapl2 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 2] += tv4rho3lapl2;

  tv4rho3lapl3 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 3] += tv4rho3lapl3;

  tv4rho3lapl4 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 4] += tv4rho3lapl4;

  tv4rho3lapl5 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 5] += tv4rho3lapl5;

  tv4rho3lapl6 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 6] += tv4rho3lapl6;

  tv4rho3lapl7 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 7] += tv4rho3lapl7;

  t3555 = t6 * t1038 * t329;
  t3561 = t6 * t1045 * t329;
  t3564 = t6 * t385 * t780;
  t3571 = 0.5e1 / 0.36e2 * t6 * t1057 * t329;
  t3573 = t6 * t394 * t780;
  t3576 = t6 * t137 * t1715;
  t3595 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1034 * t329 - 0.3e1 / 0.8e1 * t3555 - 0.9e1 / 0.8e1 * t6 * t381 * t780 + t3561 / 0.4e1 - 0.3e1 / 0.4e1 * t3564 - 0.9e1 / 0.8e1 * t6 * t131 * t1715 - t3571 + t3573 / 0.4e1 - 0.3e1 / 0.8e1 * t3576 - 0.3e1 / 0.8e1 * t6 * t28 * (-0.3e1 / 0.4e1 * t1068 * t322 + 0.3e1 / 0.4e1 * t402 * t774 - 0.3e1 / 0.8e1 * t142 * t1709 + t30 * t321 * t1127 / 0.8e1 - 0.455e3 / 0.243e3 * t1129 * t325 * t69));
  tv4rho3tau0 = t3595 * t7 + 0.3e1 * t1720;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 0] += tv4rho3tau0;

  t3602 = t6 * t1157 * t343;
  t3605 = t6 * t1161 * t343;
  t3609 = 0.5e1 / 0.36e2 * t6 * t1165 * t343;
  t3611 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1153 * t343 - 0.3e1 / 0.8e1 * t3602 + t3605 / 0.4e1 - t3609);
  tv4rho3tau1 = t3611 * t7 + 0.3e1 * t1733;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 1] += tv4rho3tau1;

  t3613 = 0.2e1 * t1747;
  t3619 = t6 * t1195 * t329 / 0.4e1;
  t3624 = t6 * t1202 * t329;
  t3628 = t6 * t498 * t780 / 0.4e1;
  t3637 = -0.3e1 / 0.8e1 * t6 * t1191 * t329 - t3619 - 0.3e1 / 0.4e1 * t6 * t494 * t780 + t3624 / 0.12e2 - t3628 - 0.3e1 / 0.8e1 * t6 * t204 * t1715 - t3555 / 0.8e1 + t3561 / 0.6e1 - t3564 / 0.4e1 - t3571 + t3573 / 0.6e1 - t3576 / 0.8e1;
  t3638 = my_piecewise3(t2, 0, t3637);
  tv4rho3tau2 = t3638 * t7 + t1720 + t3613;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 2] += tv4rho3tau2;

  t3640 = 0.2e1 * t1763;
  t3646 = t6 * t1237 * t343 / 0.4e1;
  t3648 = t6 * t1241 * t343;
  t3657 = t6 * t473 * t813 / 0.4e1;
  t3659 = t6 * t477 * t813;
  t3662 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1233 * t343 - t3646 + t3648 / 0.12e2 - t3602 / 0.8e1 + t3605 / 0.6e1 - t3609 - 0.3e1 / 0.8e1 * t6 * t469 * t813 - t3657 + t3659 / 0.12e2);
  tv4rho3tau3 = t3662 * t7 + t1733 + t3640;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 3] += tv4rho3tau3;

  t3668 = t6 * t1278 * t329;
  t3677 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1274 * t329 - t3668 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t548 * t780 - t3619 + t3624 / 0.6e1 - t3628 + t3561 / 0.12e2 - t3571 + t3573 / 0.12e2);
  tv4rho3tau4 = t3677 * t7 + t1771 + t3613;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 4] += tv4rho3tau4;

  t3683 = t6 * t1308 * t343;
  t3690 = t6 * t521 * t813;
  t3698 = t6 * t191 * t1792;
  t3700 = -0.3e1 / 0.8e1 * t6 * t1304 * t343 - t3683 / 0.8e1 - t3646 + t3648 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t517 * t813 - t3690 / 0.4e1 + t3605 / 0.12e2 - t3609 - t3657 + t3659 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t187 * t1792 - t3698 / 0.8e1;
  t3701 = my_piecewise3(t77, 0, t3700);
  tv4rho3tau5 = t3701 * t7 + t1797 + t3640;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 5] += tv4rho3tau5;

  t3710 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1345 * t329 - 0.3e1 / 0.8e1 * t3668 + t3624 / 0.4e1 - t3571);
  tv4rho3tau6 = t3710 * t7 + 0.3e1 * t1771;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 6] += tv4rho3tau6;

  t3744 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t1364 * t343 - 0.3e1 / 0.8e1 * t3683 - 0.9e1 / 0.8e1 * t6 * t564 * t813 + t3648 / 0.4e1 - 0.3e1 / 0.4e1 * t3690 - 0.9e1 / 0.8e1 * t6 * t215 * t1792 - t3609 + t3659 / 0.4e1 - 0.3e1 / 0.8e1 * t3698 - 0.3e1 / 0.8e1 * t6 * t84 * (-0.3e1 / 0.4e1 * t1380 * t336 + 0.3e1 / 0.4e1 * t574 * t807 - 0.3e1 / 0.8e1 * t220 * t1786 + t86 * t335 * t1439 / 0.8e1 - 0.455e3 / 0.243e3 * t1441 * t339 * t69));
  tv4rho3tau7 = t3744 * t7 + 0.3e1 * t1797;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 7] += tv4rho3tau7;

  t3752 = t1800 * t824 * t353;
  t3757 = t820 * t1809 * t353;
  t3759 = t1804 * t828;
  t3766 = 0.5e1 / 0.216e3 * t348 * t1056 * sigma[0] * t353;
  t3767 = t1810 * t828;
  t3769 = t825 * t1815;
  t3775 = my_piecewise3(t2, 0, t5 * t1033 * t349 * t353 / 0.16e2 + t3752 / 0.16e2 - 0.7e1 / 0.16e2 * t1801 * t828 - t3757 / 0.24e2 - 0.7e1 / 0.24e2 * t3759 + 0.35e2 / 0.24e2 * t821 * t1815 + t3766 + 0.7e1 / 0.72e2 * t3767 + 0.35e2 / 0.72e2 * t3769 - 0.455e3 / 0.216e3 * t350 * t3286 * t352);
  tv4rho3exx0 = t3775 * t7 + 0.3e1 * t1819;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 0] += tv4rho3exx0;

  t3783 = t1822 * t838 * t360;
  t3786 = t834 * t1829 * t360;
  t3791 = 0.5e1 / 0.216e3 * t357 * t1056 * sigma[2] * t360;
  t3793 = my_piecewise3(t77, 0, t5 * t1152 * t358 * t360 / 0.16e2 + t3783 / 0.16e2 - t3786 / 0.24e2 + t3791);
  tv4rho3exx1 = t3793 * t7 + 0.3e1 * t1834;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 1] += tv4rho3exx1;

  t3795 = 0.2e1 * t1848;
  t3802 = t1836 * t824 * t353 / 0.24e2;
  t3806 = t845 * t1809 * t353;
  t3809 = 0.7e1 / 0.72e2 * t1840 * t828;
  t3817 = t5 * t1190 * t349 * t353 / 0.16e2 + t3802 - 0.7e1 / 0.24e2 * t1837 * t828 - t3806 / 0.72e2 - t3809 + 0.35e2 / 0.72e2 * t846 * t1815 + t3752 / 0.48e2 - t3757 / 0.36e2 - 0.7e1 / 0.72e2 * t3759 + t3766 + 0.7e1 / 0.108e3 * t3767 + 0.35e2 / 0.216e3 * t3769;
  t3818 = my_piecewise3(t2, 0, t3817);
  tv4rho3exx2 = t3818 * t7 + t1819 + t3795;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 2] += tv4rho3exx2;

  t3820 = 0.2e1 * t1863;
  t3827 = t1850 * t838 * t360 / 0.24e2;
  t3829 = t852 * t1829 * t360;
  t3836 = 0.7e1 / 0.72e2 * t1826 * t856;
  t3837 = t1830 * t856;
  t3840 = my_piecewise3(t77, 0, t5 * t1232 * t358 * t360 / 0.16e2 + t3827 - t3829 / 0.72e2 + t3783 / 0.48e2 - t3786 / 0.36e2 + t3791 - 0.7e1 / 0.48e2 * t1823 * t856 - t3836 + 0.7e1 / 0.216e3 * t3837);
  tv4rho3exx3 = t3840 * t7 + t1834 + t3820;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 3] += tv4rho3exx3;

  t3847 = t1866 * t824 * t353;
  t3855 = my_piecewise3(t2, 0, t5 * t1273 * t349 * t353 / 0.16e2 + t3847 / 0.48e2 - 0.7e1 / 0.48e2 * t1867 * t828 + t3802 - t3806 / 0.36e2 - t3809 - t3757 / 0.72e2 + t3766 + 0.7e1 / 0.216e3 * t3767);
  tv4rho3exx4 = t3855 * t7 + t1872 + t3795;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 4] += tv4rho3exx4;

  t3862 = t1875 * t838 * t360;
  t3867 = t1854 * t856;
  t3873 = t839 * t1883;
  t3875 = t5 * t1303 * t358 * t360 / 0.16e2 + t3862 / 0.48e2 + t3827 - t3829 / 0.36e2 - 0.7e1 / 0.24e2 * t1851 * t856 - 0.7e1 / 0.72e2 * t3867 - t3786 / 0.72e2 + t3791 - t3836 + 0.7e1 / 0.108e3 * t3837 + 0.35e2 / 0.72e2 * t835 * t1883 + 0.35e2 / 0.216e3 * t3873;
  t3876 = my_piecewise3(t77, 0, t3875);
  tv4rho3exx5 = t3876 * t7 + t1887 + t3820;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 5] += tv4rho3exx5;

  t3886 = my_piecewise3(t2, 0, t5 * t1344 * t349 * t353 / 0.16e2 + t3847 / 0.16e2 - t3806 / 0.24e2 + t3766);
  tv4rho3exx6 = t3886 * t7 + 0.3e1 * t1872;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 6] += tv4rho3exx6;

  t3906 = my_piecewise3(t77, 0, t5 * t1363 * t358 * t360 / 0.16e2 + t3862 / 0.16e2 - 0.7e1 / 0.16e2 * t1876 * t856 - t3829 / 0.24e2 - 0.7e1 / 0.24e2 * t3867 + 0.35e2 / 0.24e2 * t853 * t1883 + t3791 + 0.7e1 / 0.72e2 * t3837 + 0.35e2 / 0.72e2 * t3873 - 0.455e3 / 0.216e3 * t359 * t3539 * t352);
  tv4rho3exx7 = t3906 * t7 + 0.3e1 * t1887;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 7] += tv4rho3exx7;

  t3913 = t6 * t385 * t893;
  t3920 = t6 * t394 * t893 / 0.12e2;
  t3922 = t6 * t137 * t1947;
  t3980 = 0.99555555555555555552e-2 * t41 * t1485 * t675 - 0.18666666666666666666e-2 * t41 * t650 * t1531 - 0.93333333333333333332e-3 * t41 * t47 * t154 * (-0.196e-1 * t873 * t171 * t52 + 0.196e-1 * t877 * t410 * t160 - 0.2772e0 * t1523 + 0.3948e0 * t1528 * sigma[0] - 0.168e0 / t44 / t2475 * t2487 * t430) - 0.18251851851851851851e-1 * t41 * t3252 * t275 - 0.1991111111111111111e-1 * t41 * t1499 + 0.74666666666666666664e-2 * t41 * t1511 + 0.37333333333333333332e-2 * t41 * t1515 + 0.49777777777777777778e-2 * t41 * t149 * t1941 - 0.112e-1 * t41 * t1507 + 0.18251851851851851851e-1 * t41 * t411 * t868 + 0.29866666666666666666e-1 * t658 * t3270 * t1913;
  t3988 = t675 * t675;
  t4023 = -0.1991111111111111111e-1 * t658 * t1498 * t1917 - 0.55999999999999999998e-2 * t658 * t1505 * t867 * t439 + 0.37333333333333333332e-2 * t41 * t47 * t419 * t3988 + 0.37333333333333333332e-2 * t658 * t659 * t275 * t1531 - 0.9125925925925925926e-2 * t41 * t411 * t887 - 0.99555555555555555554e-2 * t658 * t1498 * t1924 + 0.37333333333333333332e-2 * t658 * t659 * t1940 * t163 + 0.18666666666666666666e-2 * t658 * t659 * t886 * t439 - 0.55999999999999999998e-2 * t658 * t1505 * t886 * t420 + 0.22399999999999999999e-1 * t658 * t3274 * t867 * t420 - 0.224e-1 * t658 * t1505 * t660 * t675;
  t4031 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t893 - t3913 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t1947 + t3920 - t3922 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (-t1469 * t280 / 0.2e1 + t638 * t680 / 0.2e1 - t262 * t1536 / 0.4e1 - t402 * t1899 / 0.4e1 + t142 * t31 * t1945 / 0.4e1 + t34 * (t3980 + t4023)));
  tv4rho2sigma20 = t4031 * t7 + 0.2e1 * t1952;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4038 = t6 * t473 * t929;
  t4042 = t6 * t477 * t929 / 0.12e2;
  t4044 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t929 - t4038 / 0.4e1 + t4042);
  tv4rho2sigma25 = t4044 * t7 + 0.2e1 * t1961;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4050 = t6 * t498 * t893;
  t4058 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t893 - t4050 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t1947 - t3913 / 0.8e1 + t3920 - t3922 / 0.8e1);
  tv4rho2sigma26 = t4058 * t7 + t1952 + t1967;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4064 = t6 * t521 * t929;
  t4071 = t6 * t191 * t2024;
  t4074 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t929 - t4064 / 0.8e1 - t4038 / 0.8e1 + t4042 - 0.3e1 / 0.8e1 * t6 * t187 * t2024 - t4071 / 0.8e1);
  tv4rho2sigma211 = t4074 * t7 + t1961 + t2029;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4082 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t893 - t4050 / 0.4e1 + t3920);
  tv4rho2sigma212 = t4082 * t7 + 0.2e1 * t1967;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4131 = t748 * t748;
  t4143 = 0.22399999999999999999e-1 * t731 * t3447 * t903 * t592 - 0.224e-1 * t731 * t1645 * t733 * t748 - 0.55999999999999999998e-2 * t731 * t1645 * t922 * t592 - 0.112e-1 * t41 * t1647 + 0.18251851851851851851e-1 * t41 * t583 * t904 + 0.29866666666666666666e-1 * t731 * t3443 * t1990 - 0.1991111111111111111e-1 * t731 * t1638 * t1994 - 0.55999999999999999998e-2 * t731 * t1645 * t903 * t611 + 0.37333333333333333332e-2 * t41 * t96 * t591 * t4131 + 0.37333333333333333332e-2 * t731 * t732 * t304 * t1671 - 0.9125925925925925926e-2 * t41 * t583 * t923;
  t4192 = -0.99555555555555555554e-2 * t731 * t1638 * t2001 + 0.37333333333333333332e-2 * t731 * t732 * t2017 * t241 + 0.18666666666666666666e-2 * t731 * t732 * t922 * t611 + 0.99555555555555555552e-2 * t41 * t1625 * t748 - 0.18666666666666666666e-2 * t41 * t723 * t1671 + 0.49777777777777777778e-2 * t41 * t227 * t2018 - 0.93333333333333333332e-3 * t41 * t96 * t232 * (-0.196e-1 * t909 * t249 * t101 + 0.196e-1 * t913 * t582 * t238 - 0.2772e0 * t1663 + 0.3948e0 * t1668 * sigma[2] - 0.168e0 / t93 / t3075 * t3087 * t602) - 0.18251851851851851851e-1 * t41 * t3529 * t304 - 0.1991111111111111111e-1 * t41 * t1639 + 0.74666666666666666664e-2 * t41 * t1651 + 0.37333333333333333332e-2 * t41 * t1655;
  t4200 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t929 - t4064 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t2024 + t4042 - t4071 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * (-t1609 * t309 / 0.2e1 + t711 * t753 / 0.2e1 - t291 * t1676 / 0.4e1 - t574 * t1976 / 0.4e1 + t220 * t87 * t2022 / 0.4e1 + t90 * (t4143 + t4192)));
  tv4rho2sigma217 = t4200 * t7 + 0.2e1 * t2029;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 17] += tv4rho2sigma217;

  tv4rho2sigmalapl0 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmalapl1 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 1] += tv4rho2sigmalapl1;

  tv4rho2sigmalapl2 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 2] += tv4rho2sigmalapl2;

  tv4rho2sigmalapl3 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 3] += tv4rho2sigmalapl3;

  tv4rho2sigmalapl4 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 4] += tv4rho2sigmalapl4;

  tv4rho2sigmalapl5 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 5] += tv4rho2sigmalapl5;

  tv4rho2sigmalapl6 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 6] += tv4rho2sigmalapl6;

  tv4rho2sigmalapl7 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 7] += tv4rho2sigmalapl7;

  tv4rho2sigmalapl8 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 8] += tv4rho2sigmalapl8;

  tv4rho2sigmalapl9 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 9] += tv4rho2sigmalapl9;

  tv4rho2sigmalapl10 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 10] += tv4rho2sigmalapl10;

  tv4rho2sigmalapl11 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 11] += tv4rho2sigmalapl11;

  tv4rho2sigmalapl12 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 12] += tv4rho2sigmalapl12;

  tv4rho2sigmalapl13 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 13] += tv4rho2sigmalapl13;

  tv4rho2sigmalapl14 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 14] += tv4rho2sigmalapl14;

  tv4rho2sigmalapl15 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 15] += tv4rho2sigmalapl15;

  tv4rho2sigmalapl16 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 16] += tv4rho2sigmalapl16;

  tv4rho2sigmalapl17 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 17] += tv4rho2sigmalapl17;

  t4207 = t6 * t385 * t944;
  t4214 = t6 * t394 * t944 / 0.12e2;
  t4216 = t6 * t137 * t2051;
  t4232 = t447 * t321;
  t4241 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t944 - t4207 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t2051 + t4214 - t4216 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (t401 * t321 * t60 / 0.4e1 - t2037 * t168 / 0.4e1 + t934 * t444 / 0.8e1 + t402 * t937 / 0.4e1 - t142 * t2044 / 0.4e1 + t30 * t321 * t1536 / 0.8e1 + 0.35e2 / 0.81e2 * t4232 * exx[0] * t69));
  tv4rho2sigmatau0 = t4241 * t7 + 0.2e1 * t2056;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  tv4rho2sigmatau1 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 1] += tv4rho2sigmatau1;

  tv4rho2sigmatau2 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 2] += tv4rho2sigmatau2;

  tv4rho2sigmatau3 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 3] += tv4rho2sigmatau3;

  tv4rho2sigmatau4 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 4] += tv4rho2sigmatau4;

  t4248 = t6 * t473 * t959;
  t4252 = t6 * t477 * t959 / 0.12e2;
  t4254 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t959 - t4248 / 0.4e1 + t4252);
  tv4rho2sigmatau5 = t4254 * t7 + 0.2e1 * t2065;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 5] += tv4rho2sigmatau5;

  t4260 = t6 * t498 * t944;
  t4268 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t944 - t4260 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t2051 - t4207 / 0.8e1 + t4214 - t4216 / 0.8e1);
  tv4rho2sigmatau6 = t4268 * t7 + t2056 + t2071;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 6] += tv4rho2sigmatau6;

  tv4rho2sigmatau7 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 7] += tv4rho2sigmatau7;

  tv4rho2sigmatau8 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 8] += tv4rho2sigmatau8;

  tv4rho2sigmatau9 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 9] += tv4rho2sigmatau9;

  tv4rho2sigmatau10 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 10] += tv4rho2sigmatau10;

  t4274 = t6 * t521 * t959;
  t4281 = t6 * t191 * t2090;
  t4284 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t959 - t4274 / 0.8e1 - t4248 / 0.8e1 + t4252 - 0.3e1 / 0.8e1 * t6 * t187 * t2090 - t4281 / 0.8e1);
  tv4rho2sigmatau11 = t4284 * t7 + t2065 + t2095;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 11] += tv4rho2sigmatau11;

  t4292 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t944 - t4260 / 0.4e1 + t4214);
  tv4rho2sigmatau12 = t4292 * t7 + 0.2e1 * t2071;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 12] += tv4rho2sigmatau12;

  tv4rho2sigmatau13 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 13] += tv4rho2sigmatau13;

  tv4rho2sigmatau14 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 14] += tv4rho2sigmatau14;

  tv4rho2sigmatau15 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 15] += tv4rho2sigmatau15;

  tv4rho2sigmatau16 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 16] += tv4rho2sigmatau16;

  t4317 = t619 * t335;
  t4326 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t959 - t4274 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t2090 + t4252 - t4281 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * (t573 * t335 * t109 / 0.4e1 - t2076 * t246 / 0.4e1 + t949 * t616 / 0.8e1 + t574 * t952 / 0.4e1 - t220 * t2083 / 0.4e1 + t86 * t335 * t1676 / 0.8e1 + 0.35e2 / 0.81e2 * t4317 * exx[1] * t69));
  tv4rho2sigmatau17 = t4326 * t7 + 0.2e1 * t2095;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 17] += tv4rho2sigmatau17;

  t4333 = t820 * t2100 * t967;
  t4341 = t348 * t393 * t63 * t967 / 0.72e2;
  t4344 = t348 * t136 * t171 * t967;
  t4351 = my_piecewise3(t2, 0, t1800 * t964 * t967 / 0.16e2 + t4333 / 0.24e2 - 0.7e1 / 0.24e2 * t820 * t2104 * t967 - t4341 - 0.7e1 / 0.72e2 * t4344 + 0.35e2 / 0.72e2 * t348 * t27 * t447 * t967);
  tv4rho2sigmaexx0 = t4351 * t7 + 0.2e1 * t2109;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 0] += tv4rho2sigmaexx0;

  tv4rho2sigmaexx1 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 1] += tv4rho2sigmaexx1;

  tv4rho2sigmaexx2 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 2] += tv4rho2sigmaexx2;

  tv4rho2sigmaexx3 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 3] += tv4rho2sigmaexx3;

  tv4rho2sigmaexx4 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 4] += tv4rho2sigmaexx4;

  t4358 = t834 * t2114 * t974;
  t4363 = t357 * t393 * t112 * t974 / 0.72e2;
  t4365 = my_piecewise3(t77, 0, t1822 * t971 * t974 / 0.16e2 + t4358 / 0.24e2 - t4363);
  tv4rho2sigmaexx5 = t4365 * t7 + 0.2e1 * t2119;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 5] += tv4rho2sigmaexx5;

  t4371 = t845 * t2100 * t967;
  t4379 = my_piecewise3(t2, 0, t1836 * t964 * t967 / 0.16e2 + t4371 / 0.48e2 - 0.7e1 / 0.48e2 * t845 * t2104 * t967 + t4333 / 0.48e2 - t4341 - 0.7e1 / 0.144e3 * t4344);
  tv4rho2sigmaexx6 = t4379 * t7 + t2109 + t2125;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 6] += tv4rho2sigmaexx6;

  tv4rho2sigmaexx7 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 7] += tv4rho2sigmaexx7;

  tv4rho2sigmaexx8 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 8] += tv4rho2sigmaexx8;

  tv4rho2sigmaexx9 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 9] += tv4rho2sigmaexx9;

  tv4rho2sigmaexx10 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 10] += tv4rho2sigmaexx10;

  t4385 = t852 * t2114 * t974;
  t4393 = t357 * t136 * t249 * t974;
  t4396 = my_piecewise3(t77, 0, t1850 * t971 * t974 / 0.16e2 + t4385 / 0.48e2 + t4358 / 0.48e2 - t4363 - 0.7e1 / 0.48e2 * t834 * t2130 * t974 - 0.7e1 / 0.144e3 * t4393);
  tv4rho2sigmaexx11 = t4396 * t7 + t2119 + t2135;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 11] += tv4rho2sigmaexx11;

  t4404 = my_piecewise3(t2, 0, t1866 * t964 * t967 / 0.16e2 + t4371 / 0.24e2 - t4341);
  tv4rho2sigmaexx12 = t4404 * t7 + 0.2e1 * t2125;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 12] += tv4rho2sigmaexx12;

  tv4rho2sigmaexx13 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 13] += tv4rho2sigmaexx13;

  tv4rho2sigmaexx14 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 14] += tv4rho2sigmaexx14;

  tv4rho2sigmaexx15 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 15] += tv4rho2sigmaexx15;

  tv4rho2sigmaexx16 = 0.e0;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 16] += tv4rho2sigmaexx16;

  t4420 = my_piecewise3(t77, 0, t1875 * t971 * t974 / 0.16e2 + t4385 / 0.24e2 - 0.7e1 / 0.24e2 * t852 * t2130 * t974 - t4363 - 0.7e1 / 0.72e2 * t4393 + 0.35e2 / 0.72e2 * t357 * t27 * t619 * t974);
  tv4rho2sigmaexx17 = t4420 * t7 + 0.2e1 * t2135;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 17] += tv4rho2sigmaexx17;

  tv4rho2lapl20 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapl21 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 1] += tv4rho2lapl21;

  tv4rho2lapl22 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 2] += tv4rho2lapl22;

  tv4rho2lapl23 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 3] += tv4rho2lapl23;

  tv4rho2lapl24 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 4] += tv4rho2lapl24;

  tv4rho2lapl25 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 5] += tv4rho2lapl25;

  tv4rho2lapl26 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 6] += tv4rho2lapl26;

  tv4rho2lapl27 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 7] += tv4rho2lapl27;

  tv4rho2lapl28 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 8] += tv4rho2lapl28;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2lapltau1 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 1] += tv4rho2lapltau1;

  tv4rho2lapltau2 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 2] += tv4rho2lapltau2;

  tv4rho2lapltau3 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 3] += tv4rho2lapltau3;

  tv4rho2lapltau4 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 4] += tv4rho2lapltau4;

  tv4rho2lapltau5 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 5] += tv4rho2lapltau5;

  tv4rho2lapltau6 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 6] += tv4rho2lapltau6;

  tv4rho2lapltau7 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 7] += tv4rho2lapltau7;

  tv4rho2lapltau8 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 8] += tv4rho2lapltau8;

  tv4rho2lapltau9 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 9] += tv4rho2lapltau9;

  tv4rho2lapltau10 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 10] += tv4rho2lapltau10;

  tv4rho2lapltau11 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 11] += tv4rho2lapltau11;

  tv4rho2laplexx0 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 0] += tv4rho2laplexx0;

  tv4rho2laplexx1 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 1] += tv4rho2laplexx1;

  tv4rho2laplexx2 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 2] += tv4rho2laplexx2;

  tv4rho2laplexx3 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 3] += tv4rho2laplexx3;

  tv4rho2laplexx4 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 4] += tv4rho2laplexx4;

  tv4rho2laplexx5 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 5] += tv4rho2laplexx5;

  tv4rho2laplexx6 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 6] += tv4rho2laplexx6;

  tv4rho2laplexx7 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 7] += tv4rho2laplexx7;

  tv4rho2laplexx8 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 8] += tv4rho2laplexx8;

  tv4rho2laplexx9 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 9] += tv4rho2laplexx9;

  tv4rho2laplexx10 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 10] += tv4rho2laplexx10;

  tv4rho2laplexx11 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 11] += tv4rho2laplexx11;

  t4427 = t6 * t385 * t987;
  t4434 = t6 * t394 * t987 / 0.12e2;
  t4436 = t6 * t137 * t2151;
  t4453 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t381 * t987 - t4427 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t131 * t2151 + t4434 - t4436 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (-t402 * t980 / 0.2e1 + t142 * t2145 / 0.2e1 - t30 * t979 * t444 / 0.4e1 - 0.7e2 / 0.81e2 * t448 * t983 * t69));
  tv4rho2tau20 = t4453 * t7 + 0.2e1 * t2156;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 0] += tv4rho2tau20;

  tv4rho2tau21 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 1] += tv4rho2tau21;

  t4460 = t6 * t473 * t1001;
  t4464 = t6 * t477 * t1001 / 0.12e2;
  t4466 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t469 * t1001 - t4460 / 0.4e1 + t4464);
  tv4rho2tau22 = t4466 * t7 + 0.2e1 * t2165;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 2] += tv4rho2tau22;

  t4472 = t6 * t498 * t987;
  t4480 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t494 * t987 - t4472 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t204 * t2151 - t4427 / 0.8e1 + t4434 - t4436 / 0.8e1);
  tv4rho2tau23 = t4480 * t7 + t2156 + t2171;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 3] += tv4rho2tau23;

  tv4rho2tau24 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 4] += tv4rho2tau24;

  t4486 = t6 * t521 * t1001;
  t4493 = t6 * t191 * t2184;
  t4496 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t517 * t1001 - t4486 / 0.8e1 - t4460 / 0.8e1 + t4464 - 0.3e1 / 0.8e1 * t6 * t187 * t2184 - t4493 / 0.8e1);
  tv4rho2tau25 = t4496 * t7 + t2165 + t2189;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 5] += tv4rho2tau25;

  t4504 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t548 * t987 - t4472 / 0.4e1 + t4434);
  tv4rho2tau26 = t4504 * t7 + 0.2e1 * t2171;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 6] += tv4rho2tau26;

  tv4rho2tau27 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 7] += tv4rho2tau27;

  t4530 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t564 * t1001 - t4486 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t215 * t2184 + t4464 - t4493 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t84 * (-t574 * t994 / 0.2e1 + t220 * t2178 / 0.2e1 - t86 * t993 * t616 / 0.4e1 - 0.7e2 / 0.81e2 * t620 * t997 * t69));
  tv4rho2tau28 = t4530 * t7 + 0.2e1 * t2189;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 8] += tv4rho2tau28;

  t4535 = t1804 * t1006;
  t4540 = t1810 * t1006 / 0.72e2;
  t4541 = t825 * t2195;
  t4547 = my_piecewise3(t2, 0, -t1801 * t1006 / 0.16e2 - t4535 / 0.24e2 + 0.7e1 / 0.24e2 * t821 * t2195 + t4540 + 0.7e1 / 0.72e2 * t4541 - 0.35e2 / 0.72e2 * t350 * t4232 * t352);
  tv4rho2tauexx0 = t4547 * t7 + 0.2e1 * t2199;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 0] += tv4rho2tauexx0;

  tv4rho2tauexx1 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 1] += tv4rho2tauexx1;

  tv4rho2tauexx2 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 2] += tv4rho2tauexx2;

  t4552 = t1826 * t1010;
  t4555 = t1830 * t1010 / 0.72e2;
  t4557 = my_piecewise3(t77, 0, -t1823 * t1010 / 0.16e2 - t4552 / 0.24e2 + t4555);
  tv4rho2tauexx3 = t4557 * t7 + 0.2e1 * t2206;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 3] += tv4rho2tauexx3;

  t4561 = t1840 * t1006;
  t4568 = my_piecewise3(t2, 0, -t1837 * t1006 / 0.16e2 - t4561 / 0.48e2 + 0.7e1 / 0.48e2 * t846 * t2195 - t4535 / 0.48e2 + t4540 + 0.7e1 / 0.144e3 * t4541);
  tv4rho2tauexx4 = t4568 * t7 + t2199 + t2211;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 4] += tv4rho2tauexx4;

  tv4rho2tauexx5 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 5] += tv4rho2tauexx5;

  tv4rho2tauexx6 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 6] += tv4rho2tauexx6;

  t4572 = t1854 * t1010;
  t4577 = t839 * t2215;
  t4580 = my_piecewise3(t77, 0, -t1851 * t1010 / 0.16e2 - t4572 / 0.48e2 - t4552 / 0.48e2 + t4555 + 0.7e1 / 0.48e2 * t835 * t2215 + 0.7e1 / 0.144e3 * t4577);
  tv4rho2tauexx7 = t4580 * t7 + t2206 + t2219;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 7] += tv4rho2tauexx7;

  t4587 = my_piecewise3(t2, 0, -t1867 * t1006 / 0.16e2 - t4561 / 0.24e2 + t4540);
  tv4rho2tauexx8 = t4587 * t7 + 0.2e1 * t2211;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 8] += tv4rho2tauexx8;

  tv4rho2tauexx9 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 9] += tv4rho2tauexx9;

  tv4rho2tauexx10 = 0.e0;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 10] += tv4rho2tauexx10;

  t4600 = my_piecewise3(t77, 0, -t1876 * t1010 / 0.16e2 - t4572 / 0.24e2 + 0.7e1 / 0.24e2 * t853 * t2215 + t4555 + 0.7e1 / 0.72e2 * t4577 - 0.35e2 / 0.72e2 * t359 * t4317 * t352);
  tv4rho2tauexx11 = t4600 * t7 + 0.2e1 * t2219;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 11] += tv4rho2tauexx11;

  tv4rho2exx20 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 0] += tv4rho2exx20;

  tv4rho2exx21 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 1] += tv4rho2exx21;

  tv4rho2exx22 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 2] += tv4rho2exx22;

  tv4rho2exx23 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 3] += tv4rho2exx23;

  tv4rho2exx24 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 4] += tv4rho2exx24;

  tv4rho2exx25 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 5] += tv4rho2exx25;

  tv4rho2exx26 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 6] += tv4rho2exx26;

  tv4rho2exx27 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 7] += tv4rho2exx27;

  tv4rho2exx28 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 8] += tv4rho2exx28;

  t4607 = t6 * t137 * t2260 / 0.8e1;
  t4683 = -0.14933333333333333333e-1 * t41 * t1498 * t867 - 0.16799999999999999999e-1 * t41 * t1914 + 0.112e-1 * t41 * t1918 + 0.74666666666666666664e-2 * t41 * t1485 * t886 + 0.55999999999999999998e-2 * t41 * t1925 - 0.27999999999999999999e-2 * t41 * t650 * t1940 + 0.14933333333333333333e-1 * t41 * t149 * t2230 + 0.22399999999999999999e-1 * t658 * t3274 * t2229 * t163 - 0.16799999999999999999e-1 * t658 * t1505 * t867 * t675 - 0.14933333333333333333e-1 * t658 * t1498 * t2234 - 0.16799999999999999999e-1 * t658 * t1505 * t2234 * t163 + 0.55999999999999999998e-2 * t658 * t659 * t675 * t886 + 0.55999999999999999998e-2 * t658 * t659 * t275 * t1940 + 0.24888888888888888889e-2 * t41 * t149 * t2254 + 0.18666666666666666666e-2 * t658 * t659 * t2253 * t163 - 0.93333333333333333332e-3 * t41 * t47 * t154 * (-0.126e-1 * t2239 * t63 * t52 + 0.126e-1 * t2243 * t148 * t160 + 0.42e-2 * t877 * t671 * t436 - 0.882e-1 * t1937 + 0.63e-1 / t44 / t1114 * t2487 * sigma[0]);
  t4690 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t2260 - t4607 - 0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.8e1 * t638 * t891 - 0.3e1 / 0.8e1 * t262 * t1945 + t142 * t31 * t2258 / 0.8e1 + t34 * t4683));
  tv4rhosigma30 = t4690 * t7 + t2264;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 8] += tv4rhosigma38;

  t4697 = t6 * t191 * t2304 / 0.8e1;
  t4699 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t2304 - t4697);
  tv4rhosigma39 = t4699 * t7 + t2308;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 9] += tv4rhosigma39;

  t4705 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t2260 - t4607);
  tv4rhosigma310 = t4705 * t7 + t2264;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 18] += tv4rhosigma318;

  t4785 = -0.14933333333333333333e-1 * t41 * t1638 * t903 - 0.16799999999999999999e-1 * t41 * t1991 + 0.112e-1 * t41 * t1995 + 0.74666666666666666664e-2 * t41 * t1625 * t922 + 0.55999999999999999998e-2 * t41 * t2002 - 0.27999999999999999999e-2 * t41 * t723 * t2017 + 0.14933333333333333333e-1 * t41 * t227 * t2274 + 0.22399999999999999999e-1 * t731 * t3447 * t2273 * t241 - 0.16799999999999999999e-1 * t731 * t1645 * t903 * t748 - 0.14933333333333333333e-1 * t731 * t1638 * t2278 - 0.16799999999999999999e-1 * t731 * t1645 * t2278 * t241 + 0.55999999999999999998e-2 * t731 * t732 * t748 * t922 + 0.55999999999999999998e-2 * t731 * t732 * t304 * t2017 + 0.24888888888888888889e-2 * t41 * t227 * t2298 + 0.18666666666666666666e-2 * t731 * t732 * t2297 * t241 - 0.93333333333333333332e-3 * t41 * t96 * t232 * (-0.126e-1 * t2283 * t112 * t101 + 0.126e-1 * t2287 * t226 * t238 + 0.42e-2 * t913 * t744 * t608 - 0.882e-1 * t2014 + 0.63e-1 / t93 / t1426 * t3087 * sigma[2]);
  t4792 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t2304 - t4697 - 0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.8e1 * t711 * t927 - 0.3e1 / 0.8e1 * t291 * t2022 + t220 * t87 * t2302 / 0.8e1 + t90 * t4785));
  tv4rhosigma319 = t4792 * t7 + t2308;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 19] += tv4rhosigma319;

  tv4rhosigma2lapl0 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2lapl1 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 1] += tv4rhosigma2lapl1;

  tv4rhosigma2lapl2 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 2] += tv4rhosigma2lapl2;

  tv4rhosigma2lapl3 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 3] += tv4rhosigma2lapl3;

  tv4rhosigma2lapl4 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 4] += tv4rhosigma2lapl4;

  tv4rhosigma2lapl5 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 5] += tv4rhosigma2lapl5;

  tv4rhosigma2lapl6 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 6] += tv4rhosigma2lapl6;

  tv4rhosigma2lapl7 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 7] += tv4rhosigma2lapl7;

  tv4rhosigma2lapl8 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 8] += tv4rhosigma2lapl8;

  tv4rhosigma2lapl9 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 9] += tv4rhosigma2lapl9;

  tv4rhosigma2lapl10 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 10] += tv4rhosigma2lapl10;

  tv4rhosigma2lapl11 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 11] += tv4rhosigma2lapl11;

  tv4rhosigma2lapl12 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 12] += tv4rhosigma2lapl12;

  tv4rhosigma2lapl13 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 13] += tv4rhosigma2lapl13;

  tv4rhosigma2lapl14 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 14] += tv4rhosigma2lapl14;

  tv4rhosigma2lapl15 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 15] += tv4rhosigma2lapl15;

  tv4rhosigma2lapl16 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 16] += tv4rhosigma2lapl16;

  tv4rhosigma2lapl17 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 17] += tv4rhosigma2lapl17;

  tv4rhosigma2lapl18 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 18] += tv4rhosigma2lapl18;

  tv4rhosigma2lapl19 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 19] += tv4rhosigma2lapl19;

  tv4rhosigma2lapl20 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 20] += tv4rhosigma2lapl20;

  tv4rhosigma2lapl21 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 21] += tv4rhosigma2lapl21;

  tv4rhosigma2lapl22 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 22] += tv4rhosigma2lapl22;

  tv4rhosigma2lapl23 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 23] += tv4rhosigma2lapl23;

  t4799 = t6 * t137 * t2314 / 0.8e1;
  t4814 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t2314 - t4799 - 0.3e1 / 0.8e1 * t6 * t28 * (-t2037 * t280 / 0.4e1 + t934 * t680 / 0.4e1 - t142 * t2311 / 0.8e1 + t30 * t321 * t1945 / 0.8e1));
  tv4rhosigma2tau0 = t4814 * t7 + t2318;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigma2tau1 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 1] += tv4rhosigma2tau1;

  tv4rhosigma2tau2 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 2] += tv4rhosigma2tau2;

  tv4rhosigma2tau3 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 3] += tv4rhosigma2tau3;

  tv4rhosigma2tau4 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 4] += tv4rhosigma2tau4;

  tv4rhosigma2tau5 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 5] += tv4rhosigma2tau5;

  tv4rhosigma2tau6 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 6] += tv4rhosigma2tau6;

  tv4rhosigma2tau7 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 7] += tv4rhosigma2tau7;

  tv4rhosigma2tau8 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 8] += tv4rhosigma2tau8;

  tv4rhosigma2tau9 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 9] += tv4rhosigma2tau9;

  tv4rhosigma2tau10 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 10] += tv4rhosigma2tau10;

  t4821 = t6 * t191 * t2324 / 0.8e1;
  t4823 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t2324 - t4821);
  tv4rhosigma2tau11 = t4823 * t7 + t2328;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 11] += tv4rhosigma2tau11;

  t4829 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t2314 - t4799);
  tv4rhosigma2tau12 = t4829 * t7 + t2318;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 12] += tv4rhosigma2tau12;

  tv4rhosigma2tau13 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 13] += tv4rhosigma2tau13;

  tv4rhosigma2tau14 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 14] += tv4rhosigma2tau14;

  tv4rhosigma2tau15 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 15] += tv4rhosigma2tau15;

  tv4rhosigma2tau16 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 16] += tv4rhosigma2tau16;

  tv4rhosigma2tau17 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 17] += tv4rhosigma2tau17;

  tv4rhosigma2tau18 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 18] += tv4rhosigma2tau18;

  tv4rhosigma2tau19 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 19] += tv4rhosigma2tau19;

  tv4rhosigma2tau20 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 20] += tv4rhosigma2tau20;

  tv4rhosigma2tau21 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 21] += tv4rhosigma2tau21;

  tv4rhosigma2tau22 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 22] += tv4rhosigma2tau22;

  t4848 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t2324 - t4821 - 0.3e1 / 0.8e1 * t6 * t84 * (-t2076 * t309 / 0.4e1 + t949 * t753 / 0.4e1 - t220 * t2321 / 0.8e1 + t86 * t335 * t2022 / 0.8e1));
  tv4rhosigma2tau23 = t4848 * t7 + t2328;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 23] += tv4rhosigma2tau23;

  tv4rhosigma2exx0 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 0] += tv4rhosigma2exx0;

  tv4rhosigma2exx1 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 1] += tv4rhosigma2exx1;

  tv4rhosigma2exx2 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 2] += tv4rhosigma2exx2;

  tv4rhosigma2exx3 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 3] += tv4rhosigma2exx3;

  tv4rhosigma2exx4 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 4] += tv4rhosigma2exx4;

  tv4rhosigma2exx5 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 5] += tv4rhosigma2exx5;

  tv4rhosigma2exx6 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 6] += tv4rhosigma2exx6;

  tv4rhosigma2exx7 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 7] += tv4rhosigma2exx7;

  tv4rhosigma2exx8 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 8] += tv4rhosigma2exx8;

  tv4rhosigma2exx9 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 9] += tv4rhosigma2exx9;

  tv4rhosigma2exx10 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 10] += tv4rhosigma2exx10;

  tv4rhosigma2exx11 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 11] += tv4rhosigma2exx11;

  tv4rhosigma2exx12 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 12] += tv4rhosigma2exx12;

  tv4rhosigma2exx13 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 13] += tv4rhosigma2exx13;

  tv4rhosigma2exx14 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 14] += tv4rhosigma2exx14;

  tv4rhosigma2exx15 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 15] += tv4rhosigma2exx15;

  tv4rhosigma2exx16 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 16] += tv4rhosigma2exx16;

  tv4rhosigma2exx17 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 17] += tv4rhosigma2exx17;

  tv4rhosigma2exx18 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 18] += tv4rhosigma2exx18;

  tv4rhosigma2exx19 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 19] += tv4rhosigma2exx19;

  tv4rhosigma2exx20 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 20] += tv4rhosigma2exx20;

  tv4rhosigma2exx21 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 21] += tv4rhosigma2exx21;

  tv4rhosigma2exx22 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 22] += tv4rhosigma2exx22;

  tv4rhosigma2exx23 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 23] += tv4rhosigma2exx23;

  tv4rhosigmalapl20 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapl21 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 1] += tv4rhosigmalapl21;

  tv4rhosigmalapl22 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 2] += tv4rhosigmalapl22;

  tv4rhosigmalapl23 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 3] += tv4rhosigmalapl23;

  tv4rhosigmalapl24 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 4] += tv4rhosigmalapl24;

  tv4rhosigmalapl25 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 5] += tv4rhosigmalapl25;

  tv4rhosigmalapl26 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 6] += tv4rhosigmalapl26;

  tv4rhosigmalapl27 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 7] += tv4rhosigmalapl27;

  tv4rhosigmalapl28 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 8] += tv4rhosigmalapl28;

  tv4rhosigmalapl29 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 9] += tv4rhosigmalapl29;

  tv4rhosigmalapl210 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 10] += tv4rhosigmalapl210;

  tv4rhosigmalapl211 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 11] += tv4rhosigmalapl211;

  tv4rhosigmalapl212 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 12] += tv4rhosigmalapl212;

  tv4rhosigmalapl213 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 13] += tv4rhosigmalapl213;

  tv4rhosigmalapl214 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 14] += tv4rhosigmalapl214;

  tv4rhosigmalapl215 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 15] += tv4rhosigmalapl215;

  tv4rhosigmalapl216 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 16] += tv4rhosigmalapl216;

  tv4rhosigmalapl217 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 17] += tv4rhosigmalapl217;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmalapltau1 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 1] += tv4rhosigmalapltau1;

  tv4rhosigmalapltau2 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 2] += tv4rhosigmalapltau2;

  tv4rhosigmalapltau3 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 3] += tv4rhosigmalapltau3;

  tv4rhosigmalapltau4 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 4] += tv4rhosigmalapltau4;

  tv4rhosigmalapltau5 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 5] += tv4rhosigmalapltau5;

  tv4rhosigmalapltau6 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 6] += tv4rhosigmalapltau6;

  tv4rhosigmalapltau7 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 7] += tv4rhosigmalapltau7;

  tv4rhosigmalapltau8 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 8] += tv4rhosigmalapltau8;

  tv4rhosigmalapltau9 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 9] += tv4rhosigmalapltau9;

  tv4rhosigmalapltau10 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 10] += tv4rhosigmalapltau10;

  tv4rhosigmalapltau11 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 11] += tv4rhosigmalapltau11;

  tv4rhosigmalapltau12 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 12] += tv4rhosigmalapltau12;

  tv4rhosigmalapltau13 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 13] += tv4rhosigmalapltau13;

  tv4rhosigmalapltau14 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 14] += tv4rhosigmalapltau14;

  tv4rhosigmalapltau15 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 15] += tv4rhosigmalapltau15;

  tv4rhosigmalapltau16 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 16] += tv4rhosigmalapltau16;

  tv4rhosigmalapltau17 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 17] += tv4rhosigmalapltau17;

  tv4rhosigmalapltau18 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 18] += tv4rhosigmalapltau18;

  tv4rhosigmalapltau19 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 19] += tv4rhosigmalapltau19;

  tv4rhosigmalapltau20 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 20] += tv4rhosigmalapltau20;

  tv4rhosigmalapltau21 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 21] += tv4rhosigmalapltau21;

  tv4rhosigmalapltau22 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 22] += tv4rhosigmalapltau22;

  tv4rhosigmalapltau23 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 23] += tv4rhosigmalapltau23;

  tv4rhosigmalaplexx0 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 0] += tv4rhosigmalaplexx0;

  tv4rhosigmalaplexx1 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 1] += tv4rhosigmalaplexx1;

  tv4rhosigmalaplexx2 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 2] += tv4rhosigmalaplexx2;

  tv4rhosigmalaplexx3 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 3] += tv4rhosigmalaplexx3;

  tv4rhosigmalaplexx4 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 4] += tv4rhosigmalaplexx4;

  tv4rhosigmalaplexx5 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 5] += tv4rhosigmalaplexx5;

  tv4rhosigmalaplexx6 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 6] += tv4rhosigmalaplexx6;

  tv4rhosigmalaplexx7 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 7] += tv4rhosigmalaplexx7;

  tv4rhosigmalaplexx8 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 8] += tv4rhosigmalaplexx8;

  tv4rhosigmalaplexx9 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 9] += tv4rhosigmalaplexx9;

  tv4rhosigmalaplexx10 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 10] += tv4rhosigmalaplexx10;

  tv4rhosigmalaplexx11 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 11] += tv4rhosigmalaplexx11;

  tv4rhosigmalaplexx12 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 12] += tv4rhosigmalaplexx12;

  tv4rhosigmalaplexx13 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 13] += tv4rhosigmalaplexx13;

  tv4rhosigmalaplexx14 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 14] += tv4rhosigmalaplexx14;

  tv4rhosigmalaplexx15 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 15] += tv4rhosigmalaplexx15;

  tv4rhosigmalaplexx16 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 16] += tv4rhosigmalaplexx16;

  tv4rhosigmalaplexx17 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 17] += tv4rhosigmalaplexx17;

  tv4rhosigmalaplexx18 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 18] += tv4rhosigmalaplexx18;

  tv4rhosigmalaplexx19 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 19] += tv4rhosigmalaplexx19;

  tv4rhosigmalaplexx20 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 20] += tv4rhosigmalaplexx20;

  tv4rhosigmalaplexx21 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 21] += tv4rhosigmalaplexx21;

  tv4rhosigmalaplexx22 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 22] += tv4rhosigmalaplexx22;

  tv4rhosigmalaplexx23 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 23] += tv4rhosigmalaplexx23;

  t4855 = t6 * t137 * t2339 / 0.8e1;
  t4866 = t171 * t979;
  t4875 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t131 * t2339 - t4855 - 0.3e1 / 0.8e1 * t6 * t28 * (t141 * t979 * t60 / 0.4e1 - t2329 * t168 / 0.4e1 + t142 * t2332 / 0.4e1 - t30 * t979 * t680 / 0.4e1 + 0.7e1 / 0.27e2 * t4866 * exx[0] * t69));
  tv4rhosigmatau20 = t4875 * t7 + t2343;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  tv4rhosigmatau21 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 1] += tv4rhosigmatau21;

  tv4rhosigmatau22 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 2] += tv4rhosigmatau22;

  tv4rhosigmatau23 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 3] += tv4rhosigmatau23;

  tv4rhosigmatau24 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 4] += tv4rhosigmatau24;

  tv4rhosigmatau25 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 5] += tv4rhosigmatau25;

  tv4rhosigmatau26 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 6] += tv4rhosigmatau26;

  tv4rhosigmatau27 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 7] += tv4rhosigmatau27;

  t4882 = t6 * t191 * t2354 / 0.8e1;
  t4884 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t187 * t2354 - t4882);
  tv4rhosigmatau28 = t4884 * t7 + t2358;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 8] += tv4rhosigmatau28;

  t4890 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t2339 - t4855);
  tv4rhosigmatau29 = t4890 * t7 + t2343;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 9] += tv4rhosigmatau29;

  tv4rhosigmatau210 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 10] += tv4rhosigmatau210;

  tv4rhosigmatau211 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 11] += tv4rhosigmatau211;

  tv4rhosigmatau212 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 12] += tv4rhosigmatau212;

  tv4rhosigmatau213 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 13] += tv4rhosigmatau213;

  tv4rhosigmatau214 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 14] += tv4rhosigmatau214;

  tv4rhosigmatau215 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 15] += tv4rhosigmatau215;

  tv4rhosigmatau216 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 16] += tv4rhosigmatau216;

  t4905 = t249 * t993;
  t4914 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t215 * t2354 - t4882 - 0.3e1 / 0.8e1 * t6 * t84 * (t219 * t993 * t109 / 0.4e1 - t2344 * t246 / 0.4e1 + t220 * t2347 / 0.4e1 - t86 * t993 * t753 / 0.4e1 + 0.7e1 / 0.27e2 * t4905 * exx[1] * t69));
  tv4rhosigmatau217 = t4914 * t7 + t2358;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 17] += tv4rhosigmatau217;

  t4919 = t2101 * t2360 / 0.48e2;
  t4923 = my_piecewise3(t2, 0, -t2097 * t2360 / 0.16e2 - t4919 + 0.7e1 / 0.48e2 * t2105 * t2360);
  tv4rhosigmatauexx0 = t4923 * t7 + t2363;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 0] += tv4rhosigmatauexx0;

  tv4rhosigmatauexx1 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 1] += tv4rhosigmatauexx1;

  tv4rhosigmatauexx2 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 2] += tv4rhosigmatauexx2;

  tv4rhosigmatauexx3 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 3] += tv4rhosigmatauexx3;

  tv4rhosigmatauexx4 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 4] += tv4rhosigmatauexx4;

  tv4rhosigmatauexx5 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 5] += tv4rhosigmatauexx5;

  tv4rhosigmatauexx6 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 6] += tv4rhosigmatauexx6;

  tv4rhosigmatauexx7 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 7] += tv4rhosigmatauexx7;

  tv4rhosigmatauexx8 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 8] += tv4rhosigmatauexx8;

  tv4rhosigmatauexx9 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 9] += tv4rhosigmatauexx9;

  tv4rhosigmatauexx10 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 10] += tv4rhosigmatauexx10;

  t4928 = t2115 * t2365 / 0.48e2;
  t4930 = my_piecewise3(t77, 0, -t2111 * t2365 / 0.16e2 - t4928);
  tv4rhosigmatauexx11 = t4930 * t7 + t2368;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 11] += tv4rhosigmatauexx11;

  t4935 = my_piecewise3(t2, 0, -t2121 * t2360 / 0.16e2 - t4919);
  tv4rhosigmatauexx12 = t4935 * t7 + t2363;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 12] += tv4rhosigmatauexx12;

  tv4rhosigmatauexx13 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 13] += tv4rhosigmatauexx13;

  tv4rhosigmatauexx14 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 14] += tv4rhosigmatauexx14;

  tv4rhosigmatauexx15 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 15] += tv4rhosigmatauexx15;

  tv4rhosigmatauexx16 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 16] += tv4rhosigmatauexx16;

  tv4rhosigmatauexx17 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 17] += tv4rhosigmatauexx17;

  tv4rhosigmatauexx18 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 18] += tv4rhosigmatauexx18;

  tv4rhosigmatauexx19 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 19] += tv4rhosigmatauexx19;

  tv4rhosigmatauexx20 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 20] += tv4rhosigmatauexx20;

  tv4rhosigmatauexx21 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 21] += tv4rhosigmatauexx21;

  tv4rhosigmatauexx22 = 0.e0;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 22] += tv4rhosigmatauexx22;

  t4942 = my_piecewise3(t77, 0, -t2127 * t2365 / 0.16e2 - t4928 + 0.7e1 / 0.48e2 * t2131 * t2365);
  tv4rhosigmatauexx23 = t4942 * t7 + t2368;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 23] += tv4rhosigmatauexx23;

  tv4rhosigmaexx20 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 0] += tv4rhosigmaexx20;

  tv4rhosigmaexx21 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 1] += tv4rhosigmaexx21;

  tv4rhosigmaexx22 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 2] += tv4rhosigmaexx22;

  tv4rhosigmaexx23 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 3] += tv4rhosigmaexx23;

  tv4rhosigmaexx24 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 4] += tv4rhosigmaexx24;

  tv4rhosigmaexx25 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 5] += tv4rhosigmaexx25;

  tv4rhosigmaexx26 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 6] += tv4rhosigmaexx26;

  tv4rhosigmaexx27 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 7] += tv4rhosigmaexx27;

  tv4rhosigmaexx28 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 8] += tv4rhosigmaexx28;

  tv4rhosigmaexx29 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 9] += tv4rhosigmaexx29;

  tv4rhosigmaexx210 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 10] += tv4rhosigmaexx210;

  tv4rhosigmaexx211 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 11] += tv4rhosigmaexx211;

  tv4rhosigmaexx212 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 12] += tv4rhosigmaexx212;

  tv4rhosigmaexx213 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 13] += tv4rhosigmaexx213;

  tv4rhosigmaexx214 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 14] += tv4rhosigmaexx214;

  tv4rhosigmaexx215 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 15] += tv4rhosigmaexx215;

  tv4rhosigmaexx216 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 16] += tv4rhosigmaexx216;

  tv4rhosigmaexx217 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 17] += tv4rhosigmaexx217;

  tv4rholapl30 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl31 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 1] += tv4rholapl31;

  tv4rholapl32 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 2] += tv4rholapl32;

  tv4rholapl33 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 3] += tv4rholapl33;

  tv4rholapl34 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 4] += tv4rholapl34;

  tv4rholapl35 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 5] += tv4rholapl35;

  tv4rholapl36 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 6] += tv4rholapl36;

  tv4rholapl37 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 7] += tv4rholapl37;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapl2tau1 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 1] += tv4rholapl2tau1;

  tv4rholapl2tau2 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 2] += tv4rholapl2tau2;

  tv4rholapl2tau3 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 3] += tv4rholapl2tau3;

  tv4rholapl2tau4 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 4] += tv4rholapl2tau4;

  tv4rholapl2tau5 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 5] += tv4rholapl2tau5;

  tv4rholapl2tau6 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 6] += tv4rholapl2tau6;

  tv4rholapl2tau7 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 7] += tv4rholapl2tau7;

  tv4rholapl2tau8 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 8] += tv4rholapl2tau8;

  tv4rholapl2tau9 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 9] += tv4rholapl2tau9;

  tv4rholapl2tau10 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 10] += tv4rholapl2tau10;

  tv4rholapl2tau11 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 11] += tv4rholapl2tau11;

  tv4rholapl2exx0 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 0] += tv4rholapl2exx0;

  tv4rholapl2exx1 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 1] += tv4rholapl2exx1;

  tv4rholapl2exx2 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 2] += tv4rholapl2exx2;

  tv4rholapl2exx3 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 3] += tv4rholapl2exx3;

  tv4rholapl2exx4 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 4] += tv4rholapl2exx4;

  tv4rholapl2exx5 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 5] += tv4rholapl2exx5;

  tv4rholapl2exx6 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 6] += tv4rholapl2exx6;

  tv4rholapl2exx7 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 7] += tv4rholapl2exx7;

  tv4rholapl2exx8 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 8] += tv4rholapl2exx8;

  tv4rholapl2exx9 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 9] += tv4rholapl2exx9;

  tv4rholapl2exx10 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 10] += tv4rholapl2exx10;

  tv4rholapl2exx11 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 11] += tv4rholapl2exx11;

  tv4rholapltau20 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rholapltau21 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 1] += tv4rholapltau21;

  tv4rholapltau22 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 2] += tv4rholapltau22;

  tv4rholapltau23 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 3] += tv4rholapltau23;

  tv4rholapltau24 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 4] += tv4rholapltau24;

  tv4rholapltau25 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 5] += tv4rholapltau25;

  tv4rholapltau26 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 6] += tv4rholapltau26;

  tv4rholapltau27 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 7] += tv4rholapltau27;

  tv4rholapltau28 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 8] += tv4rholapltau28;

  tv4rholapltau29 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 9] += tv4rholapltau29;

  tv4rholapltau210 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 10] += tv4rholapltau210;

  tv4rholapltau211 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 11] += tv4rholapltau211;

  tv4rholapltauexx0 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 0] += tv4rholapltauexx0;

  tv4rholapltauexx1 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 1] += tv4rholapltauexx1;

  tv4rholapltauexx2 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 2] += tv4rholapltauexx2;

  tv4rholapltauexx3 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 3] += tv4rholapltauexx3;

  tv4rholapltauexx4 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 4] += tv4rholapltauexx4;

  tv4rholapltauexx5 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 5] += tv4rholapltauexx5;

  tv4rholapltauexx6 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 6] += tv4rholapltauexx6;

  tv4rholapltauexx7 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 7] += tv4rholapltauexx7;

  tv4rholapltauexx8 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 8] += tv4rholapltauexx8;

  tv4rholapltauexx9 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 9] += tv4rholapltauexx9;

  tv4rholapltauexx10 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 10] += tv4rholapltauexx10;

  tv4rholapltauexx11 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 11] += tv4rholapltauexx11;

  tv4rholapltauexx12 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 12] += tv4rholapltauexx12;

  tv4rholapltauexx13 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 13] += tv4rholapltauexx13;

  tv4rholapltauexx14 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 14] += tv4rholapltauexx14;

  tv4rholapltauexx15 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 15] += tv4rholapltauexx15;

  tv4rholaplexx2v4rhotau30 = diff(dmfd00000103020(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 0] += tv4rholaplexx2v4rhotau30;

  tv4rholaplexx2v4rhotau31 = diff(dmfd00000103011(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 1] += tv4rholaplexx2v4rhotau31;

  tv4rholaplexx2v4rhotau32 = diff(dmfd00000103002(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 2] += tv4rholaplexx2v4rhotau32;

  tv4rholaplexx2v4rhotau33 = diff(dmfd00000102120(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 3] += tv4rholaplexx2v4rhotau33;

  tv4rholaplexx2v4rhotau34 = diff(dmfd00000102111(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 4] += tv4rholaplexx2v4rhotau34;

  tv4rholaplexx2v4rhotau35 = diff(dmfd00000102102(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 5] += tv4rholaplexx2v4rhotau35;

  tv4rholaplexx2v4rhotau36 = diff(dmfd00000101220(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 6] += tv4rholaplexx2v4rhotau36;

  tv4rholaplexx2v4rhotau37 = diff(dmfd00000101211(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 7] += tv4rholaplexx2v4rhotau37;

  tv4rholaplexx2v4rhotau38 = diff(dmfd00000101202(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 8] += tv4rholaplexx2v4rhotau38;

  tv4rholaplexx2v4rhotau39 = diff(dmfd00000100320(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 9] += tv4rholaplexx2v4rhotau39;

  tv4rholaplexx2v4rhotau310 = diff(dmfd00000100311(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 10] += tv4rholaplexx2v4rhotau310;

  tv4rholaplexx2v4rhotau311 = diff(dmfd00000100302(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 11] += tv4rholaplexx2v4rhotau311;

  tv4rholaplexx2v4rhotau312 = diff(dmfd00000013020(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 12] += tv4rholaplexx2v4rhotau312;

  tv4rholaplexx2v4rhotau313 = diff(dmfd00000013011(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 13] += tv4rholaplexx2v4rhotau313;

  tv4rholaplexx2v4rhotau314 = diff(dmfd00000013002(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 14] += tv4rholaplexx2v4rhotau314;

  tv4rholaplexx2v4rhotau315 = diff(dmfd00000012120(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 15] += tv4rholaplexx2v4rhotau315;

  tv4rholaplexx2v4rhotau316 = diff(dmfd00000012111(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 16] += tv4rholaplexx2v4rhotau316;

  tv4rholaplexx2v4rhotau317 = diff(dmfd00000012102(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 17] += tv4rholaplexx2v4rhotau317;

  tv4rholaplexx2v4rhotau318 = diff(dmfd00000011220(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 18] += tv4rholaplexx2v4rhotau318;

  tv4rholaplexx2v4rhotau319 = diff(dmfd00000011211(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 19] += tv4rholaplexx2v4rhotau319;

  tv4rholaplexx2v4rhotau320 = diff(dmfd00000011202(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 20] += tv4rholaplexx2v4rhotau320;

  tv4rholaplexx2v4rhotau321 = diff(dmfd00000010320(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 21] += tv4rholaplexx2v4rhotau321;

  tv4rholaplexx2v4rhotau322 = diff(dmfd00000010311(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 22] += tv4rholaplexx2v4rhotau322;

  tv4rholaplexx2v4rhotau323 = diff(dmfd00000010302(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 23] += tv4rholaplexx2v4rhotau323;

  tv4rholaplexx2v4rhotau324 = diff(dmfd00000103020(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 24] += tv4rholaplexx2v4rhotau324;

  tv4rholaplexx2v4rhotau325 = diff(dmfd00000103011(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 25] += tv4rholaplexx2v4rhotau325;

  tv4rholaplexx2v4rhotau326 = diff(dmfd00000103002(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 26] += tv4rholaplexx2v4rhotau326;

  tv4rholaplexx2v4rhotau327 = diff(dmfd00000102120(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 27] += tv4rholaplexx2v4rhotau327;

  tv4rholaplexx2v4rhotau328 = diff(dmfd00000102111(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 28] += tv4rholaplexx2v4rhotau328;

  tv4rholaplexx2v4rhotau329 = diff(dmfd00000102102(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 29] += tv4rholaplexx2v4rhotau329;

  tv4rholaplexx2v4rhotau330 = diff(dmfd00000101220(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 30] += tv4rholaplexx2v4rhotau330;

  tv4rholaplexx2v4rhotau331 = diff(dmfd00000101211(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 31] += tv4rholaplexx2v4rhotau331;

  tv4rholaplexx2v4rhotau332 = diff(dmfd00000101202(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 32] += tv4rholaplexx2v4rhotau332;

  tv4rholaplexx2v4rhotau333 = diff(dmfd00000100320(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 33] += tv4rholaplexx2v4rhotau333;

  tv4rholaplexx2v4rhotau334 = diff(dmfd00000100311(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 34] += tv4rholaplexx2v4rhotau334;

  tv4rholaplexx2v4rhotau335 = diff(dmfd00000100302(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 35] += tv4rholaplexx2v4rhotau335;

  tv4rholaplexx2v4rhotau336 = diff(dmfd00000013020(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 36] += tv4rholaplexx2v4rhotau336;

  tv4rholaplexx2v4rhotau337 = diff(dmfd00000013011(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 37] += tv4rholaplexx2v4rhotau337;

  tv4rholaplexx2v4rhotau338 = diff(dmfd00000013002(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 38] += tv4rholaplexx2v4rhotau338;

  tv4rholaplexx2v4rhotau339 = diff(dmfd00000012120(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 39] += tv4rholaplexx2v4rhotau339;

  tv4rholaplexx2v4rhotau340 = diff(dmfd00000012111(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 40] += tv4rholaplexx2v4rhotau340;

  tv4rholaplexx2v4rhotau341 = diff(dmfd00000012102(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 41] += tv4rholaplexx2v4rhotau341;

  tv4rholaplexx2v4rhotau342 = diff(dmfd00000011220(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 42] += tv4rholaplexx2v4rhotau342;

  tv4rholaplexx2v4rhotau343 = diff(dmfd00000011211(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 43] += tv4rholaplexx2v4rhotau343;

  tv4rholaplexx2v4rhotau344 = diff(dmfd00000011202(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 44] += tv4rholaplexx2v4rhotau344;

  tv4rholaplexx2v4rhotau345 = diff(dmfd00000010320(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 45] += tv4rholaplexx2v4rhotau345;

  tv4rholaplexx2v4rhotau346 = diff(dmfd00000010311(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 46] += tv4rholaplexx2v4rhotau346;

  tv4rholaplexx2v4rhotau347 = diff(dmfd00000010302(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 47] += tv4rholaplexx2v4rhotau347;

  t4947 = t825 * t2397 / 0.24e2;
  t4952 = my_piecewise3(t2, 0, t821 * t2397 / 0.8e1 + t4947 - 0.7e1 / 0.24e2 * t350 * t4866 * t352);
  tv4rhotau2exx0 = t4952 * t7 + t2400;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 0] += tv4rhotau2exx0;

  tv4rhotau2exx1 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 1] += tv4rhotau2exx1;

  tv4rhotau2exx2 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 2] += tv4rhotau2exx2;

  tv4rhotau2exx3 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 3] += tv4rhotau2exx3;

  tv4rhotau2exx4 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 4] += tv4rhotau2exx4;

  t4957 = t839 * t2401 / 0.24e2;
  t4959 = my_piecewise3(t77, 0, t835 * t2401 / 0.8e1 + t4957);
  tv4rhotau2exx5 = t4959 * t7 + t2404;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 5] += tv4rhotau2exx5;

  t4964 = my_piecewise3(t2, 0, t846 * t2397 / 0.8e1 + t4947);
  tv4rhotau2exx6 = t4964 * t7 + t2400;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 6] += tv4rhotau2exx6;

  tv4rhotau2exx7 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 7] += tv4rhotau2exx7;

  tv4rhotau2exx8 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 8] += tv4rhotau2exx8;

  tv4rhotau2exx9 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 9] += tv4rhotau2exx9;

  tv4rhotau2exx10 = 0.e0;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 10] += tv4rhotau2exx10;

  t4972 = my_piecewise3(t77, 0, t853 * t2401 / 0.8e1 + t4957 - 0.7e1 / 0.24e2 * t359 * t4905 * t352);
  tv4rhotau2exx11 = t4972 * t7 + t2404;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 11] += tv4rhotau2exx11;

  tv4rhotauexx20 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 0] += tv4rhotauexx20;

  tv4rhotauexx21 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 1] += tv4rhotauexx21;

  tv4rhotauexx22 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 2] += tv4rhotauexx22;

  tv4rhotauexx23 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 3] += tv4rhotauexx23;

  tv4rhotauexx24 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 4] += tv4rhotauexx24;

  tv4rhotauexx25 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 5] += tv4rhotauexx25;

  tv4rhotauexx26 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 6] += tv4rhotauexx26;

  tv4rhotauexx27 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 7] += tv4rhotauexx27;

  tv4rhotauexx28 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 8] += tv4rhotauexx28;

  tv4rhotauexx29 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 9] += tv4rhotauexx29;

  tv4rhotauexx210 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 10] += tv4rhotauexx210;

  tv4rhotauexx211 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 11] += tv4rhotauexx211;

  tv4rhoexx3v4sigma40 = diff(dmfd00400000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 0] += tv4rhoexx3v4sigma40;

  tv4rhoexx3v4sigma41 = diff(dmfd00400000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 1] += tv4rhoexx3v4sigma41;

  tv4rhoexx3v4sigma42 = diff(dmfd00400000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 2] += tv4rhoexx3v4sigma42;

  tv4rhoexx3v4sigma43 = diff(dmfd00400000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 3] += tv4rhoexx3v4sigma43;

  tv4rhoexx3v4sigma44 = diff(dmfd00310000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 4] += tv4rhoexx3v4sigma44;

  tv4rhoexx3v4sigma45 = diff(dmfd00310000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 5] += tv4rhoexx3v4sigma45;

  tv4rhoexx3v4sigma46 = diff(dmfd00310000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 6] += tv4rhoexx3v4sigma46;

  tv4rhoexx3v4sigma47 = diff(dmfd00310000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 7] += tv4rhoexx3v4sigma47;

  tv4rhoexx3v4sigma48 = diff(dmfd00301000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 8] += tv4rhoexx3v4sigma48;

  tv4rhoexx3v4sigma49 = diff(dmfd00301000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 9] += tv4rhoexx3v4sigma49;

  tv4rhoexx3v4sigma410 = diff(dmfd00301000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 10] += tv4rhoexx3v4sigma410;

  tv4rhoexx3v4sigma411 = diff(dmfd00301000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 11] += tv4rhoexx3v4sigma411;

  tv4rhoexx3v4sigma412 = diff(dmfd00220000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 12] += tv4rhoexx3v4sigma412;

  tv4rhoexx3v4sigma413 = diff(dmfd00220000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 13] += tv4rhoexx3v4sigma413;

  tv4rhoexx3v4sigma414 = diff(dmfd00220000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 14] += tv4rhoexx3v4sigma414;

  tv4rhoexx3v4sigma415 = diff(dmfd00220000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 15] += tv4rhoexx3v4sigma415;

  tv4rhoexx3v4sigma416 = diff(dmfd00211000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 16] += tv4rhoexx3v4sigma416;

  tv4rhoexx3v4sigma417 = diff(dmfd00211000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 17] += tv4rhoexx3v4sigma417;

  tv4rhoexx3v4sigma418 = diff(dmfd00211000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 18] += tv4rhoexx3v4sigma418;

  tv4rhoexx3v4sigma419 = diff(dmfd00211000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 19] += tv4rhoexx3v4sigma419;

  tv4rhoexx3v4sigma420 = diff(dmfd00202000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 20] += tv4rhoexx3v4sigma420;

  tv4rhoexx3v4sigma421 = diff(dmfd00202000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 21] += tv4rhoexx3v4sigma421;

  tv4rhoexx3v4sigma422 = diff(dmfd00202000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 22] += tv4rhoexx3v4sigma422;

  tv4rhoexx3v4sigma423 = diff(dmfd00202000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 23] += tv4rhoexx3v4sigma423;

  tv4rhoexx3v4sigma424 = diff(dmfd00130000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 24] += tv4rhoexx3v4sigma424;

  tv4rhoexx3v4sigma425 = diff(dmfd00130000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 25] += tv4rhoexx3v4sigma425;

  tv4rhoexx3v4sigma426 = diff(dmfd00130000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 26] += tv4rhoexx3v4sigma426;

  tv4rhoexx3v4sigma427 = diff(dmfd00130000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 27] += tv4rhoexx3v4sigma427;

  tv4rhoexx3v4sigma428 = diff(dmfd00121000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 28] += tv4rhoexx3v4sigma428;

  tv4rhoexx3v4sigma429 = diff(dmfd00121000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 29] += tv4rhoexx3v4sigma429;

  tv4rhoexx3v4sigma430 = diff(dmfd00121000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 30] += tv4rhoexx3v4sigma430;

  tv4rhoexx3v4sigma431 = diff(dmfd00121000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 31] += tv4rhoexx3v4sigma431;

  tv4rhoexx3v4sigma432 = diff(dmfd00112000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 32] += tv4rhoexx3v4sigma432;

  tv4rhoexx3v4sigma433 = diff(dmfd00112000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 33] += tv4rhoexx3v4sigma433;

  tv4rhoexx3v4sigma434 = diff(dmfd00112000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 34] += tv4rhoexx3v4sigma434;

  tv4rhoexx3v4sigma435 = diff(dmfd00112000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 35] += tv4rhoexx3v4sigma435;

  tv4rhoexx3v4sigma436 = diff(dmfd00103000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 36] += tv4rhoexx3v4sigma436;

  tv4rhoexx3v4sigma437 = diff(dmfd00103000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 37] += tv4rhoexx3v4sigma437;

  tv4rhoexx3v4sigma438 = diff(dmfd00103000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 38] += tv4rhoexx3v4sigma438;

  tv4rhoexx3v4sigma439 = diff(dmfd00103000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 39] += tv4rhoexx3v4sigma439;

  tv4rhoexx3v4sigma440 = diff(dmfd00040000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 40] += tv4rhoexx3v4sigma440;

  tv4rhoexx3v4sigma441 = diff(dmfd00040000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 41] += tv4rhoexx3v4sigma441;

  tv4rhoexx3v4sigma442 = diff(dmfd00040000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 42] += tv4rhoexx3v4sigma442;

  tv4rhoexx3v4sigma443 = diff(dmfd00040000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 43] += tv4rhoexx3v4sigma443;

  tv4rhoexx3v4sigma444 = diff(dmfd00031000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 44] += tv4rhoexx3v4sigma444;

  tv4rhoexx3v4sigma445 = diff(dmfd00031000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 45] += tv4rhoexx3v4sigma445;

  tv4rhoexx3v4sigma446 = diff(dmfd00031000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 46] += tv4rhoexx3v4sigma446;

  tv4rhoexx3v4sigma447 = diff(dmfd00031000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 47] += tv4rhoexx3v4sigma447;

  tv4rhoexx3v4sigma448 = diff(dmfd00022000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 48] += tv4rhoexx3v4sigma448;

  tv4rhoexx3v4sigma449 = diff(dmfd00022000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 49] += tv4rhoexx3v4sigma449;

  tv4rhoexx3v4sigma450 = diff(dmfd00022000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 50] += tv4rhoexx3v4sigma450;

  tv4rhoexx3v4sigma451 = diff(dmfd00022000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 51] += tv4rhoexx3v4sigma451;

  tv4rhoexx3v4sigma452 = diff(dmfd00013000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 52] += tv4rhoexx3v4sigma452;

  tv4rhoexx3v4sigma453 = diff(dmfd00013000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 53] += tv4rhoexx3v4sigma453;

  tv4rhoexx3v4sigma454 = diff(dmfd00013000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 54] += tv4rhoexx3v4sigma454;

  tv4rhoexx3v4sigma455 = diff(dmfd00013000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 55] += tv4rhoexx3v4sigma455;

  tv4rhoexx3v4sigma456 = diff(dmfd00004000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 56] += tv4rhoexx3v4sigma456;

  tv4rhoexx3v4sigma457 = diff(dmfd00004000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 57] += tv4rhoexx3v4sigma457;

  tv4rhoexx3v4sigma458 = diff(dmfd00004000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 58] += tv4rhoexx3v4sigma458;

  tv4rhoexx3v4sigma459 = diff(dmfd00004000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 59] += tv4rhoexx3v4sigma459;

  tv4rhoexx3v4sigma460 = diff(dmfd00400000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 60] += tv4rhoexx3v4sigma460;

  tv4rhoexx3v4sigma461 = diff(dmfd00400000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 61] += tv4rhoexx3v4sigma461;

  tv4rhoexx3v4sigma462 = diff(dmfd00400000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 62] += tv4rhoexx3v4sigma462;

  tv4rhoexx3v4sigma463 = diff(dmfd00400000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 63] += tv4rhoexx3v4sigma463;

  tv4rhoexx3v4sigma464 = diff(dmfd00310000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 64] += tv4rhoexx3v4sigma464;

  tv4rhoexx3v4sigma465 = diff(dmfd00310000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 65] += tv4rhoexx3v4sigma465;

  tv4rhoexx3v4sigma466 = diff(dmfd00310000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 66] += tv4rhoexx3v4sigma466;

  tv4rhoexx3v4sigma467 = diff(dmfd00310000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 67] += tv4rhoexx3v4sigma467;

  tv4rhoexx3v4sigma468 = diff(dmfd00301000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 68] += tv4rhoexx3v4sigma468;

  tv4rhoexx3v4sigma469 = diff(dmfd00301000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 69] += tv4rhoexx3v4sigma469;

  tv4rhoexx3v4sigma470 = diff(dmfd00301000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 70] += tv4rhoexx3v4sigma470;

  tv4rhoexx3v4sigma471 = diff(dmfd00301000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 71] += tv4rhoexx3v4sigma471;

  tv4rhoexx3v4sigma472 = diff(dmfd00220000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 72] += tv4rhoexx3v4sigma472;

  tv4rhoexx3v4sigma473 = diff(dmfd00220000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 73] += tv4rhoexx3v4sigma473;

  tv4rhoexx3v4sigma474 = diff(dmfd00220000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 74] += tv4rhoexx3v4sigma474;

  tv4rhoexx3v4sigma475 = diff(dmfd00220000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 75] += tv4rhoexx3v4sigma475;

  tv4rhoexx3v4sigma476 = diff(dmfd00211000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 76] += tv4rhoexx3v4sigma476;

  tv4rhoexx3v4sigma477 = diff(dmfd00211000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 77] += tv4rhoexx3v4sigma477;

  tv4rhoexx3v4sigma478 = diff(dmfd00211000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 78] += tv4rhoexx3v4sigma478;

  tv4rhoexx3v4sigma479 = diff(dmfd00211000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 79] += tv4rhoexx3v4sigma479;

  tv4rhoexx3v4sigma480 = diff(dmfd00202000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 80] += tv4rhoexx3v4sigma480;

  tv4rhoexx3v4sigma481 = diff(dmfd00202000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 81] += tv4rhoexx3v4sigma481;

  tv4rhoexx3v4sigma482 = diff(dmfd00202000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 82] += tv4rhoexx3v4sigma482;

  tv4rhoexx3v4sigma483 = diff(dmfd00202000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 83] += tv4rhoexx3v4sigma483;

  tv4rhoexx3v4sigma484 = diff(dmfd00130000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 84] += tv4rhoexx3v4sigma484;

  tv4rhoexx3v4sigma485 = diff(dmfd00130000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 85] += tv4rhoexx3v4sigma485;

  tv4rhoexx3v4sigma486 = diff(dmfd00130000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 86] += tv4rhoexx3v4sigma486;

  tv4rhoexx3v4sigma487 = diff(dmfd00130000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 87] += tv4rhoexx3v4sigma487;

  tv4rhoexx3v4sigma488 = diff(dmfd00121000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 88] += tv4rhoexx3v4sigma488;

  tv4rhoexx3v4sigma489 = diff(dmfd00121000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 89] += tv4rhoexx3v4sigma489;

  tv4rhoexx3v4sigma490 = diff(dmfd00121000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 90] += tv4rhoexx3v4sigma490;

  tv4rhoexx3v4sigma491 = diff(dmfd00121000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 91] += tv4rhoexx3v4sigma491;

  tv4rhoexx3v4sigma492 = diff(dmfd00112000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 92] += tv4rhoexx3v4sigma492;

  tv4rhoexx3v4sigma493 = diff(dmfd00112000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 93] += tv4rhoexx3v4sigma493;

  tv4rhoexx3v4sigma494 = diff(dmfd00112000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 94] += tv4rhoexx3v4sigma494;

  tv4rhoexx3v4sigma495 = diff(dmfd00112000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 95] += tv4rhoexx3v4sigma495;

  tv4rhoexx3v4sigma496 = diff(dmfd00103000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 96] += tv4rhoexx3v4sigma496;

  tv4rhoexx3v4sigma497 = diff(dmfd00103000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 97] += tv4rhoexx3v4sigma497;

  tv4rhoexx3v4sigma498 = diff(dmfd00103000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 98] += tv4rhoexx3v4sigma498;

  tv4rhoexx3v4sigma499 = diff(dmfd00103000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 99] += tv4rhoexx3v4sigma499;

  tv4rhoexx3v4sigma4100 = diff(dmfd00040000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 100] += tv4rhoexx3v4sigma4100;

  tv4rhoexx3v4sigma4101 = diff(dmfd00040000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 101] += tv4rhoexx3v4sigma4101;

  tv4rhoexx3v4sigma4102 = diff(dmfd00040000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 102] += tv4rhoexx3v4sigma4102;

  tv4rhoexx3v4sigma4103 = diff(dmfd00040000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 103] += tv4rhoexx3v4sigma4103;

  tv4rhoexx3v4sigma4104 = diff(dmfd00031000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 104] += tv4rhoexx3v4sigma4104;

  tv4rhoexx3v4sigma4105 = diff(dmfd00031000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 105] += tv4rhoexx3v4sigma4105;

  tv4rhoexx3v4sigma4106 = diff(dmfd00031000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 106] += tv4rhoexx3v4sigma4106;

  tv4rhoexx3v4sigma4107 = diff(dmfd00031000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 107] += tv4rhoexx3v4sigma4107;

  tv4rhoexx3v4sigma4108 = diff(dmfd00022000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 108] += tv4rhoexx3v4sigma4108;

  tv4rhoexx3v4sigma4109 = diff(dmfd00022000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 109] += tv4rhoexx3v4sigma4109;

  tv4rhoexx3v4sigma4110 = diff(dmfd00022000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 110] += tv4rhoexx3v4sigma4110;

  tv4rhoexx3v4sigma4111 = diff(dmfd00022000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 111] += tv4rhoexx3v4sigma4111;

  tv4rhoexx3v4sigma4112 = diff(dmfd00013000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 112] += tv4rhoexx3v4sigma4112;

  tv4rhoexx3v4sigma4113 = diff(dmfd00013000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 113] += tv4rhoexx3v4sigma4113;

  tv4rhoexx3v4sigma4114 = diff(dmfd00013000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 114] += tv4rhoexx3v4sigma4114;

  tv4rhoexx3v4sigma4115 = diff(dmfd00013000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 115] += tv4rhoexx3v4sigma4115;

  tv4rhoexx3v4sigma4116 = diff(dmfd00004000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 116] += tv4rhoexx3v4sigma4116;

  tv4rhoexx3v4sigma4117 = diff(dmfd00004000021(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 117] += tv4rhoexx3v4sigma4117;

  tv4rhoexx3v4sigma4118 = diff(dmfd00004000012(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 118] += tv4rhoexx3v4sigma4118;

  tv4rhoexx3v4sigma4119 = diff(dmfd00004000003(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[1]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 119] += tv4rhoexx3v4sigma4119;

  tv4sigma3lapl0 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3lapl1 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 1] += tv4sigma3lapl1;

  tv4sigma3lapl2 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 2] += tv4sigma3lapl2;

  tv4sigma3lapl3 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 3] += tv4sigma3lapl3;

  tv4sigma3lapl4 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 4] += tv4sigma3lapl4;

  tv4sigma3lapl5 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 5] += tv4sigma3lapl5;

  tv4sigma3lapl6 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 6] += tv4sigma3lapl6;

  tv4sigma3lapl7 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 7] += tv4sigma3lapl7;

  tv4sigma3lapl8 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 8] += tv4sigma3lapl8;

  tv4sigma3lapl9 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 9] += tv4sigma3lapl9;

  tv4sigma3lapl10 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 10] += tv4sigma3lapl10;

  tv4sigma3lapl11 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 11] += tv4sigma3lapl11;

  tv4sigma3lapl12 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 12] += tv4sigma3lapl12;

  tv4sigma3lapl13 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 13] += tv4sigma3lapl13;

  tv4sigma3lapl14 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 14] += tv4sigma3lapl14;

  tv4sigma3lapl15 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 15] += tv4sigma3lapl15;

  tv4sigma3lapl16 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 16] += tv4sigma3lapl16;

  tv4sigma3lapl17 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 17] += tv4sigma3lapl17;

  tv4sigma3lapl18 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 18] += tv4sigma3lapl18;

  tv4sigma3lapl19 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 19] += tv4sigma3lapl19;

  t4983 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.8e1 * t934 * t891 + t30 * t321 * t2258 / 0.8e1));
  tv4sigma3tau0 = t7 * t4983;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma3tau1 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 1] += tv4sigma3tau1;

  tv4sigma3tau2 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 2] += tv4sigma3tau2;

  tv4sigma3tau3 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 3] += tv4sigma3tau3;

  tv4sigma3tau4 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 4] += tv4sigma3tau4;

  tv4sigma3tau5 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 5] += tv4sigma3tau5;

  tv4sigma3tau6 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 6] += tv4sigma3tau6;

  tv4sigma3tau7 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 7] += tv4sigma3tau7;

  tv4sigma3tau8 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 8] += tv4sigma3tau8;

  tv4sigma3tau9 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 9] += tv4sigma3tau9;

  tv4sigma3tau10 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 10] += tv4sigma3tau10;

  tv4sigma3tau11 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 11] += tv4sigma3tau11;

  tv4sigma3tau12 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 12] += tv4sigma3tau12;

  tv4sigma3tau13 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 13] += tv4sigma3tau13;

  tv4sigma3tau14 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 14] += tv4sigma3tau14;

  tv4sigma3tau15 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 15] += tv4sigma3tau15;

  tv4sigma3tau16 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 16] += tv4sigma3tau16;

  tv4sigma3tau17 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 17] += tv4sigma3tau17;

  tv4sigma3tau18 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 18] += tv4sigma3tau18;

  t4993 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.8e1 * t949 * t927 + t86 * t335 * t2302 / 0.8e1));
  tv4sigma3tau19 = t7 * t4993;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 19] += tv4sigma3tau19;

  tv4sigma3exx0 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 0] += tv4sigma3exx0;

  tv4sigma3exx1 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 1] += tv4sigma3exx1;

  tv4sigma3exx2 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 2] += tv4sigma3exx2;

  tv4sigma3exx3 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 3] += tv4sigma3exx3;

  tv4sigma3exx4 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 4] += tv4sigma3exx4;

  tv4sigma3exx5 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 5] += tv4sigma3exx5;

  tv4sigma3exx6 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 6] += tv4sigma3exx6;

  tv4sigma3exx7 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 7] += tv4sigma3exx7;

  tv4sigma3exx8 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 8] += tv4sigma3exx8;

  tv4sigma3exx9 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 9] += tv4sigma3exx9;

  tv4sigma3exx10 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 10] += tv4sigma3exx10;

  tv4sigma3exx11 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 11] += tv4sigma3exx11;

  tv4sigma3exx12 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 12] += tv4sigma3exx12;

  tv4sigma3exx13 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 13] += tv4sigma3exx13;

  tv4sigma3exx14 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 14] += tv4sigma3exx14;

  tv4sigma3exx15 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 15] += tv4sigma3exx15;

  tv4sigma3exx16 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 16] += tv4sigma3exx16;

  tv4sigma3exx17 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 17] += tv4sigma3exx17;

  tv4sigma3exx18 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 18] += tv4sigma3exx18;

  tv4sigma3exx19 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 19] += tv4sigma3exx19;

  tv4sigma2lapl20 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapl21 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 1] += tv4sigma2lapl21;

  tv4sigma2lapl22 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 2] += tv4sigma2lapl22;

  tv4sigma2lapl23 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 3] += tv4sigma2lapl23;

  tv4sigma2lapl24 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 4] += tv4sigma2lapl24;

  tv4sigma2lapl25 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 5] += tv4sigma2lapl25;

  tv4sigma2lapl26 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 6] += tv4sigma2lapl26;

  tv4sigma2lapl27 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 7] += tv4sigma2lapl27;

  tv4sigma2lapl28 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 8] += tv4sigma2lapl28;

  tv4sigma2lapl29 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 9] += tv4sigma2lapl29;

  tv4sigma2lapl210 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 10] += tv4sigma2lapl210;

  tv4sigma2lapl211 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 11] += tv4sigma2lapl211;

  tv4sigma2lapl212 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 12] += tv4sigma2lapl212;

  tv4sigma2lapl213 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 13] += tv4sigma2lapl213;

  tv4sigma2lapl214 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 14] += tv4sigma2lapl214;

  tv4sigma2lapl215 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 15] += tv4sigma2lapl215;

  tv4sigma2lapl216 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 16] += tv4sigma2lapl216;

  tv4sigma2lapl217 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 17] += tv4sigma2lapl217;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2lapltau1 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 1] += tv4sigma2lapltau1;

  tv4sigma2lapltau2 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 2] += tv4sigma2lapltau2;

  tv4sigma2lapltau3 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 3] += tv4sigma2lapltau3;

  tv4sigma2lapltau4 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 4] += tv4sigma2lapltau4;

  tv4sigma2lapltau5 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 5] += tv4sigma2lapltau5;

  tv4sigma2lapltau6 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 6] += tv4sigma2lapltau6;

  tv4sigma2lapltau7 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 7] += tv4sigma2lapltau7;

  tv4sigma2lapltau8 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 8] += tv4sigma2lapltau8;

  tv4sigma2lapltau9 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 9] += tv4sigma2lapltau9;

  tv4sigma2lapltau10 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 10] += tv4sigma2lapltau10;

  tv4sigma2lapltau11 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 11] += tv4sigma2lapltau11;

  tv4sigma2lapltau12 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 12] += tv4sigma2lapltau12;

  tv4sigma2lapltau13 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 13] += tv4sigma2lapltau13;

  tv4sigma2lapltau14 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 14] += tv4sigma2lapltau14;

  tv4sigma2lapltau15 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 15] += tv4sigma2lapltau15;

  tv4sigma2lapltau16 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 16] += tv4sigma2lapltau16;

  tv4sigma2lapltau17 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 17] += tv4sigma2lapltau17;

  tv4sigma2lapltau18 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 18] += tv4sigma2lapltau18;

  tv4sigma2lapltau19 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 19] += tv4sigma2lapltau19;

  tv4sigma2lapltau20 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 20] += tv4sigma2lapltau20;

  tv4sigma2lapltau21 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 21] += tv4sigma2lapltau21;

  tv4sigma2lapltau22 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 22] += tv4sigma2lapltau22;

  tv4sigma2lapltau23 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 23] += tv4sigma2lapltau23;

  tv4sigma2laplexx0 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 0] += tv4sigma2laplexx0;

  tv4sigma2laplexx1 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 1] += tv4sigma2laplexx1;

  tv4sigma2laplexx2 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 2] += tv4sigma2laplexx2;

  tv4sigma2laplexx3 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 3] += tv4sigma2laplexx3;

  tv4sigma2laplexx4 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 4] += tv4sigma2laplexx4;

  tv4sigma2laplexx5 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 5] += tv4sigma2laplexx5;

  tv4sigma2laplexx6 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 6] += tv4sigma2laplexx6;

  tv4sigma2laplexx7 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 7] += tv4sigma2laplexx7;

  tv4sigma2laplexx8 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 8] += tv4sigma2laplexx8;

  tv4sigma2laplexx9 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 9] += tv4sigma2laplexx9;

  tv4sigma2laplexx10 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 10] += tv4sigma2laplexx10;

  tv4sigma2laplexx11 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 11] += tv4sigma2laplexx11;

  tv4sigma2laplexx12 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 12] += tv4sigma2laplexx12;

  tv4sigma2laplexx13 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 13] += tv4sigma2laplexx13;

  tv4sigma2laplexx14 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 14] += tv4sigma2laplexx14;

  tv4sigma2laplexx15 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 15] += tv4sigma2laplexx15;

  tv4sigma2laplexx16 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 16] += tv4sigma2laplexx16;

  tv4sigma2laplexx17 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 17] += tv4sigma2laplexx17;

  tv4sigma2laplexx18 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 18] += tv4sigma2laplexx18;

  tv4sigma2laplexx19 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 19] += tv4sigma2laplexx19;

  tv4sigma2laplexx20 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 20] += tv4sigma2laplexx20;

  tv4sigma2laplexx21 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 21] += tv4sigma2laplexx21;

  tv4sigma2laplexx22 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 22] += tv4sigma2laplexx22;

  tv4sigma2laplexx23 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 23] += tv4sigma2laplexx23;

  t5003 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (-t2329 * t280 / 0.2e1 - t30 * t979 * t891 / 0.4e1));
  tv4sigma2tau20 = t7 * t5003;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigma2tau21 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 1] += tv4sigma2tau21;

  tv4sigma2tau22 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 2] += tv4sigma2tau22;

  tv4sigma2tau23 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 3] += tv4sigma2tau23;

  tv4sigma2tau24 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 4] += tv4sigma2tau24;

  tv4sigma2tau25 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 5] += tv4sigma2tau25;

  tv4sigma2tau26 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 6] += tv4sigma2tau26;

  tv4sigma2tau27 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 7] += tv4sigma2tau27;

  tv4sigma2tau28 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 8] += tv4sigma2tau28;

  tv4sigma2tau29 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 9] += tv4sigma2tau29;

  tv4sigma2tau210 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 10] += tv4sigma2tau210;

  tv4sigma2tau211 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 11] += tv4sigma2tau211;

  tv4sigma2tau212 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 12] += tv4sigma2tau212;

  tv4sigma2tau213 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 13] += tv4sigma2tau213;

  tv4sigma2tau214 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 14] += tv4sigma2tau214;

  tv4sigma2tau215 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 15] += tv4sigma2tau215;

  tv4sigma2tau216 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 16] += tv4sigma2tau216;

  t5013 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (-t2344 * t309 / 0.2e1 - t86 * t993 * t927 / 0.4e1));
  tv4sigma2tau217 = t7 * t5013;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 17] += tv4sigma2tau217;

  tv4sigma2tauexx0 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 0] += tv4sigma2tauexx0;

  tv4sigma2tauexx1 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 1] += tv4sigma2tauexx1;

  tv4sigma2tauexx2 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 2] += tv4sigma2tauexx2;

  tv4sigma2tauexx3 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 3] += tv4sigma2tauexx3;

  tv4sigma2tauexx4 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 4] += tv4sigma2tauexx4;

  tv4sigma2tauexx5 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 5] += tv4sigma2tauexx5;

  tv4sigma2tauexx6 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 6] += tv4sigma2tauexx6;

  tv4sigma2tauexx7 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 7] += tv4sigma2tauexx7;

  tv4sigma2tauexx8 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 8] += tv4sigma2tauexx8;

  tv4sigma2tauexx9 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 9] += tv4sigma2tauexx9;

  tv4sigma2tauexx10 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 10] += tv4sigma2tauexx10;

  tv4sigma2tauexx11 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 11] += tv4sigma2tauexx11;

  tv4sigma2tauexx12 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 12] += tv4sigma2tauexx12;

  tv4sigma2tauexx13 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 13] += tv4sigma2tauexx13;

  tv4sigma2tauexx14 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 14] += tv4sigma2tauexx14;

  tv4sigma2tauexx15 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 15] += tv4sigma2tauexx15;

  tv4sigma2tauexx16 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 16] += tv4sigma2tauexx16;

  tv4sigma2tauexx17 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 17] += tv4sigma2tauexx17;

  tv4sigma2tauexx18 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 18] += tv4sigma2tauexx18;

  tv4sigma2tauexx19 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 19] += tv4sigma2tauexx19;

  tv4sigma2tauexx20 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 20] += tv4sigma2tauexx20;

  tv4sigma2tauexx21 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 21] += tv4sigma2tauexx21;

  tv4sigma2tauexx22 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 22] += tv4sigma2tauexx22;

  tv4sigma2tauexx23 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 23] += tv4sigma2tauexx23;

  tv4sigma2exx20 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 0] += tv4sigma2exx20;

  tv4sigma2exx21 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 1] += tv4sigma2exx21;

  tv4sigma2exx22 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 2] += tv4sigma2exx22;

  tv4sigma2exx23 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 3] += tv4sigma2exx23;

  tv4sigma2exx24 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 4] += tv4sigma2exx24;

  tv4sigma2exx25 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 5] += tv4sigma2exx25;

  tv4sigma2exx26 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 6] += tv4sigma2exx26;

  tv4sigma2exx27 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 7] += tv4sigma2exx27;

  tv4sigma2exx28 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 8] += tv4sigma2exx28;

  tv4sigma2exx29 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 9] += tv4sigma2exx29;

  tv4sigma2exx210 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 10] += tv4sigma2exx210;

  tv4sigma2exx211 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 11] += tv4sigma2exx211;

  tv4sigma2exx212 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 12] += tv4sigma2exx212;

  tv4sigma2exx213 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 13] += tv4sigma2exx213;

  tv4sigma2exx214 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 14] += tv4sigma2exx214;

  tv4sigma2exx215 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 15] += tv4sigma2exx215;

  tv4sigma2exx216 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 16] += tv4sigma2exx216;

  tv4sigma2exx217 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 17] += tv4sigma2exx217;

  tv4sigmalapl30 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl31 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 1] += tv4sigmalapl31;

  tv4sigmalapl32 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 2] += tv4sigmalapl32;

  tv4sigmalapl33 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 3] += tv4sigmalapl33;

  tv4sigmalapl34 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 4] += tv4sigmalapl34;

  tv4sigmalapl35 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 5] += tv4sigmalapl35;

  tv4sigmalapl36 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 6] += tv4sigmalapl36;

  tv4sigmalapl37 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 7] += tv4sigmalapl37;

  tv4sigmalapl38 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 8] += tv4sigmalapl38;

  tv4sigmalapl39 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 9] += tv4sigmalapl39;

  tv4sigmalapl310 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 10] += tv4sigmalapl310;

  tv4sigmalapl311 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 11] += tv4sigmalapl311;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapl2tau1 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 1] += tv4sigmalapl2tau1;

  tv4sigmalapl2tau2 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 2] += tv4sigmalapl2tau2;

  tv4sigmalapl2tau3 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 3] += tv4sigmalapl2tau3;

  tv4sigmalapl2tau4 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 4] += tv4sigmalapl2tau4;

  tv4sigmalapl2tau5 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 5] += tv4sigmalapl2tau5;

  tv4sigmalapl2tau6 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 6] += tv4sigmalapl2tau6;

  tv4sigmalapl2tau7 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 7] += tv4sigmalapl2tau7;

  tv4sigmalapl2tau8 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 8] += tv4sigmalapl2tau8;

  tv4sigmalapl2tau9 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 9] += tv4sigmalapl2tau9;

  tv4sigmalapl2tau10 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 10] += tv4sigmalapl2tau10;

  tv4sigmalapl2tau11 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 11] += tv4sigmalapl2tau11;

  tv4sigmalapl2tau12 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 12] += tv4sigmalapl2tau12;

  tv4sigmalapl2tau13 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 13] += tv4sigmalapl2tau13;

  tv4sigmalapl2tau14 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 14] += tv4sigmalapl2tau14;

  tv4sigmalapl2tau15 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 15] += tv4sigmalapl2tau15;

  tv4sigmalapl2tau16 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 16] += tv4sigmalapl2tau16;

  tv4sigmalapl2tau17 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 17] += tv4sigmalapl2tau17;

  tv4sigmalapl2exx0 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 0] += tv4sigmalapl2exx0;

  tv4sigmalapl2exx1 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 1] += tv4sigmalapl2exx1;

  tv4sigmalapl2exx2 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 2] += tv4sigmalapl2exx2;

  tv4sigmalapl2exx3 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 3] += tv4sigmalapl2exx3;

  tv4sigmalapl2exx4 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 4] += tv4sigmalapl2exx4;

  tv4sigmalapl2exx5 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 5] += tv4sigmalapl2exx5;

  tv4sigmalapl2exx6 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 6] += tv4sigmalapl2exx6;

  tv4sigmalapl2exx7 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 7] += tv4sigmalapl2exx7;

  tv4sigmalapl2exx8 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 8] += tv4sigmalapl2exx8;

  tv4sigmalapl2exx9 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 9] += tv4sigmalapl2exx9;

  tv4sigmalapl2exx10 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 10] += tv4sigmalapl2exx10;

  tv4sigmalapl2exx11 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 11] += tv4sigmalapl2exx11;

  tv4sigmalapl2exx12 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 12] += tv4sigmalapl2exx12;

  tv4sigmalapl2exx13 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 13] += tv4sigmalapl2exx13;

  tv4sigmalapl2exx14 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 14] += tv4sigmalapl2exx14;

  tv4sigmalapl2exx15 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 15] += tv4sigmalapl2exx15;

  tv4sigmalapl2exx16 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 16] += tv4sigmalapl2exx16;

  tv4sigmalapl2exx17 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 17] += tv4sigmalapl2exx17;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmalapltau21 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 1] += tv4sigmalapltau21;

  tv4sigmalapltau22 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 2] += tv4sigmalapltau22;

  tv4sigmalapltau23 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 3] += tv4sigmalapltau23;

  tv4sigmalapltau24 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 4] += tv4sigmalapltau24;

  tv4sigmalapltau25 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 5] += tv4sigmalapltau25;

  tv4sigmalapltau26 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 6] += tv4sigmalapltau26;

  tv4sigmalapltau27 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 7] += tv4sigmalapltau27;

  tv4sigmalapltau28 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 8] += tv4sigmalapltau28;

  tv4sigmalapltau29 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 9] += tv4sigmalapltau29;

  tv4sigmalapltau210 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 10] += tv4sigmalapltau210;

  tv4sigmalapltau211 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 11] += tv4sigmalapltau211;

  tv4sigmalapltau212 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 12] += tv4sigmalapltau212;

  tv4sigmalapltau213 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 13] += tv4sigmalapltau213;

  tv4sigmalapltau214 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 14] += tv4sigmalapltau214;

  tv4sigmalapltau215 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 15] += tv4sigmalapltau215;

  tv4sigmalapltau216 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 16] += tv4sigmalapltau216;

  tv4sigmalapltau217 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 17] += tv4sigmalapltau217;

  tv4sigmalapltauexx0 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 0] += tv4sigmalapltauexx0;

  tv4sigmalapltauexx1 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 1] += tv4sigmalapltauexx1;

  tv4sigmalapltauexx2 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 2] += tv4sigmalapltauexx2;

  tv4sigmalapltauexx3 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 3] += tv4sigmalapltauexx3;

  tv4sigmalapltauexx4 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 4] += tv4sigmalapltauexx4;

  tv4sigmalapltauexx5 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 5] += tv4sigmalapltauexx5;

  tv4sigmalapltauexx6 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 6] += tv4sigmalapltauexx6;

  tv4sigmalapltauexx7 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 7] += tv4sigmalapltauexx7;

  tv4sigmalapltauexx8 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 8] += tv4sigmalapltauexx8;

  tv4sigmalapltauexx9 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 9] += tv4sigmalapltauexx9;

  tv4sigmalapltauexx10 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 10] += tv4sigmalapltauexx10;

  tv4sigmalapltauexx11 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 11] += tv4sigmalapltauexx11;

  tv4sigmalapltauexx12 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 12] += tv4sigmalapltauexx12;

  tv4sigmalapltauexx13 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 13] += tv4sigmalapltauexx13;

  tv4sigmalapltauexx14 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 14] += tv4sigmalapltauexx14;

  tv4sigmalapltauexx15 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 15] += tv4sigmalapltauexx15;

  tv4sigmalapltauexx16 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 16] += tv4sigmalapltauexx16;

  tv4sigmalapltauexx17 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 17] += tv4sigmalapltauexx17;

  tv4sigmalapltauexx18 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 18] += tv4sigmalapltauexx18;

  tv4sigmalapltauexx19 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 19] += tv4sigmalapltauexx19;

  tv4sigmalapltauexx20 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 20] += tv4sigmalapltauexx20;

  tv4sigmalapltauexx21 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 21] += tv4sigmalapltauexx21;

  tv4sigmalapltauexx22 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 22] += tv4sigmalapltauexx22;

  tv4sigmalapltauexx23 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 23] += tv4sigmalapltauexx23;

  tv4sigmalaplexx20 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 0] += tv4sigmalaplexx20;

  tv4sigmalaplexx21 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 1] += tv4sigmalaplexx21;

  tv4sigmalaplexx22 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 2] += tv4sigmalaplexx22;

  tv4sigmalaplexx23 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 3] += tv4sigmalaplexx23;

  tv4sigmalaplexx24 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 4] += tv4sigmalaplexx24;

  tv4sigmalaplexx25 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 5] += tv4sigmalaplexx25;

  tv4sigmalaplexx26 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 6] += tv4sigmalaplexx26;

  tv4sigmalaplexx27 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 7] += tv4sigmalaplexx27;

  tv4sigmalaplexx28 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 8] += tv4sigmalaplexx28;

  tv4sigmalaplexx29 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 9] += tv4sigmalaplexx29;

  tv4sigmalaplexx210 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 10] += tv4sigmalaplexx210;

  tv4sigmalaplexx211 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 11] += tv4sigmalaplexx211;

  tv4sigmalaplexx212 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 12] += tv4sigmalaplexx212;

  tv4sigmalaplexx213 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 13] += tv4sigmalaplexx213;

  tv4sigmalaplexx214 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 14] += tv4sigmalaplexx214;

  tv4sigmalaplexx215 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 15] += tv4sigmalaplexx215;

  tv4sigmalaplexx216 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 16] += tv4sigmalaplexx216;

  tv4sigmalaplexx217 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 17] += tv4sigmalaplexx217;

  t5020 = t63 * t2370;
  t5028 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (0.3e1 / 0.4e1 * t29 * t2370 * t60 + 0.3e1 / 0.4e1 * t30 * t2370 * t280 + t5020 * exx[0] * t69 / 0.3e1));
  tv4sigmatau30 = t7 * t5028;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 0] += tv4sigmatau30;

  tv4sigmatau31 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 1] += tv4sigmatau31;

  tv4sigmatau32 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 2] += tv4sigmatau32;

  tv4sigmatau33 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 3] += tv4sigmatau33;

  tv4sigmatau34 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 4] += tv4sigmatau34;

  tv4sigmatau35 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 5] += tv4sigmatau35;

  tv4sigmatau36 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 6] += tv4sigmatau36;

  tv4sigmatau37 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 7] += tv4sigmatau37;

  tv4sigmatau38 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 8] += tv4sigmatau38;

  tv4sigmatau39 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 9] += tv4sigmatau39;

  tv4sigmatau310 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 10] += tv4sigmatau310;

  t5035 = t112 * t2384;
  t5043 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (0.3e1 / 0.4e1 * t85 * t2384 * t109 + 0.3e1 / 0.4e1 * t86 * t2384 * t309 + t5035 * exx[1] * t69 / 0.3e1));
  tv4sigmatau311 = t7 * t5043;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 11] += tv4sigmatau311;

  t5048 = my_piecewise3(t2, 0, t965 * t979 * t38 * t68 / 0.8e1);
  tv4sigmatau2exx0 = t7 * t5048;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 0] += tv4sigmatau2exx0;

  tv4sigmatau2exx1 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 1] += tv4sigmatau2exx1;

  tv4sigmatau2exx2 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 2] += tv4sigmatau2exx2;

  tv4sigmatau2exx3 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 3] += tv4sigmatau2exx3;

  tv4sigmatau2exx4 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 4] += tv4sigmatau2exx4;

  tv4sigmatau2exx5 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 5] += tv4sigmatau2exx5;

  tv4sigmatau2exx6 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 6] += tv4sigmatau2exx6;

  tv4sigmatau2exx7 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 7] += tv4sigmatau2exx7;

  tv4sigmatau2exx8 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 8] += tv4sigmatau2exx8;

  tv4sigmatau2exx9 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 9] += tv4sigmatau2exx9;

  tv4sigmatau2exx10 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 10] += tv4sigmatau2exx10;

  tv4sigmatau2exx11 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 11] += tv4sigmatau2exx11;

  tv4sigmatau2exx12 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 12] += tv4sigmatau2exx12;

  tv4sigmatau2exx13 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 13] += tv4sigmatau2exx13;

  tv4sigmatau2exx14 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 14] += tv4sigmatau2exx14;

  tv4sigmatau2exx15 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 15] += tv4sigmatau2exx15;

  tv4sigmatau2exx16 = 0.e0;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 16] += tv4sigmatau2exx16;

  t5053 = my_piecewise3(t77, 0, t972 * t993 * t38 * t68 / 0.8e1);
  tv4sigmatau2exx17 = t7 * t5053;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 17] += tv4sigmatau2exx17;

  tv4sigmatauexx20 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 0] += tv4sigmatauexx20;

  tv4sigmatauexx21 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 1] += tv4sigmatauexx21;

  tv4sigmatauexx22 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 2] += tv4sigmatauexx22;

  tv4sigmatauexx23 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 3] += tv4sigmatauexx23;

  tv4sigmatauexx24 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 4] += tv4sigmatauexx24;

  tv4sigmatauexx25 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 5] += tv4sigmatauexx25;

  tv4sigmatauexx26 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 6] += tv4sigmatauexx26;

  tv4sigmatauexx27 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 7] += tv4sigmatauexx27;

  tv4sigmatauexx28 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 8] += tv4sigmatauexx28;

  tv4sigmatauexx29 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 9] += tv4sigmatauexx29;

  tv4sigmatauexx210 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 10] += tv4sigmatauexx210;

  tv4sigmatauexx211 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 11] += tv4sigmatauexx211;

  tv4sigmatauexx212 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 12] += tv4sigmatauexx212;

  tv4sigmatauexx213 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 13] += tv4sigmatauexx213;

  tv4sigmatauexx214 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 14] += tv4sigmatauexx214;

  tv4sigmatauexx215 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 15] += tv4sigmatauexx215;

  tv4sigmatauexx216 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 16] += tv4sigmatauexx216;

  tv4sigmatauexx217 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 17] += tv4sigmatauexx217;

  tv4sigmaexx30 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 0] += tv4sigmaexx30;

  tv4sigmaexx31 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 1] += tv4sigmaexx31;

  tv4sigmaexx32 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 2] += tv4sigmaexx32;

  tv4sigmaexx33 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 3] += tv4sigmaexx33;

  tv4sigmaexx34 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 4] += tv4sigmaexx34;

  tv4sigmaexx35 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 5] += tv4sigmaexx35;

  tv4sigmaexx36 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 6] += tv4sigmaexx36;

  tv4sigmaexx37 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 7] += tv4sigmaexx37;

  tv4sigmaexx38 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 8] += tv4sigmaexx38;

  tv4sigmaexx39 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 9] += tv4sigmaexx39;

  tv4sigmaexx310 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 10] += tv4sigmaexx310;

  tv4sigmaexx311 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 11] += tv4sigmaexx311;

  tv4lapl40 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 0] += tv4lapl40;

  tv4lapl41 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 1] += tv4lapl41;

  tv4lapl42 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 2] += tv4lapl42;

  tv4lapl43 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 3] += tv4lapl43;

  tv4lapl44 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 4] += tv4lapl44;

  tv4lapl3tau0 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl3tau1 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 1] += tv4lapl3tau1;

  tv4lapl3tau2 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 2] += tv4lapl3tau2;

  tv4lapl3tau3 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 3] += tv4lapl3tau3;

  tv4lapl3tau4 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 4] += tv4lapl3tau4;

  tv4lapl3tau5 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 5] += tv4lapl3tau5;

  tv4lapl3tau6 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 6] += tv4lapl3tau6;

  tv4lapl3tau7 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 7] += tv4lapl3tau7;

  tv4lapl3exx0 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 0] += tv4lapl3exx0;

  tv4lapl3exx1 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 1] += tv4lapl3exx1;

  tv4lapl3exx2 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 2] += tv4lapl3exx2;

  tv4lapl3exx3 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 3] += tv4lapl3exx3;

  tv4lapl3exx4 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 4] += tv4lapl3exx4;

  tv4lapl3exx5 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 5] += tv4lapl3exx5;

  tv4lapl3exx6 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 6] += tv4lapl3exx6;

  tv4lapl3exx7 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 7] += tv4lapl3exx7;

  tv4lapl2tau20 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapl2tau21 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 1] += tv4lapl2tau21;

  tv4lapl2tau22 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 2] += tv4lapl2tau22;

  tv4lapl2tau23 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 3] += tv4lapl2tau23;

  tv4lapl2tau24 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 4] += tv4lapl2tau24;

  tv4lapl2tau25 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 5] += tv4lapl2tau25;

  tv4lapl2tau26 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 6] += tv4lapl2tau26;

  tv4lapl2tau27 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 7] += tv4lapl2tau27;

  tv4lapl2tau28 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 8] += tv4lapl2tau28;

  tv4lapl2tauexx0 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 0] += tv4lapl2tauexx0;

  tv4lapl2tauexx1 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 1] += tv4lapl2tauexx1;

  tv4lapl2tauexx2 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 2] += tv4lapl2tauexx2;

  tv4lapl2tauexx3 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 3] += tv4lapl2tauexx3;

  tv4lapl2tauexx4 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 4] += tv4lapl2tauexx4;

  tv4lapl2tauexx5 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 5] += tv4lapl2tauexx5;

  tv4lapl2tauexx6 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 6] += tv4lapl2tauexx6;

  tv4lapl2tauexx7 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 7] += tv4lapl2tauexx7;

  tv4lapl2tauexx8 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 8] += tv4lapl2tauexx8;

  tv4lapl2tauexx9 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 9] += tv4lapl2tauexx9;

  tv4lapl2tauexx10 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 10] += tv4lapl2tauexx10;

  tv4lapl2tauexx11 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 11] += tv4lapl2tauexx11;

  tv4lapl2exx20 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 0] += tv4lapl2exx20;

  tv4lapl2exx21 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 1] += tv4lapl2exx21;

  tv4lapl2exx22 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 2] += tv4lapl2exx22;

  tv4lapl2exx23 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 3] += tv4lapl2exx23;

  tv4lapl2exx24 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 4] += tv4lapl2exx24;

  tv4lapl2exx25 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 5] += tv4lapl2exx25;

  tv4lapl2exx26 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 6] += tv4lapl2exx26;

  tv4lapl2exx27 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 7] += tv4lapl2exx27;

  tv4lapl2exx28 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 8] += tv4lapl2exx28;

  tv4lapltau30 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 0] += tv4lapltau30;

  tv4lapltau31 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 1] += tv4lapltau31;

  tv4lapltau32 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 2] += tv4lapltau32;

  tv4lapltau33 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 3] += tv4lapltau33;

  tv4lapltau34 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 4] += tv4lapltau34;

  tv4lapltau35 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 5] += tv4lapltau35;

  tv4lapltau36 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 6] += tv4lapltau36;

  tv4lapltau37 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 7] += tv4lapltau37;

  tv4lapltau2exx0 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 0] += tv4lapltau2exx0;

  tv4lapltau2exx1 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 1] += tv4lapltau2exx1;

  tv4lapltau2exx2 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 2] += tv4lapltau2exx2;

  tv4lapltau2exx3 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 3] += tv4lapltau2exx3;

  tv4lapltau2exx4 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 4] += tv4lapltau2exx4;

  tv4lapltau2exx5 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 5] += tv4lapltau2exx5;

  tv4lapltau2exx6 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 6] += tv4lapltau2exx6;

  tv4lapltau2exx7 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 7] += tv4lapltau2exx7;

  tv4lapltau2exx8 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 8] += tv4lapltau2exx8;

  tv4lapltau2exx9 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 9] += tv4lapltau2exx9;

  tv4lapltau2exx10 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 10] += tv4lapltau2exx10;

  tv4lapltau2exx11 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 11] += tv4lapltau2exx11;

  tv4lapltauexx20 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 0] += tv4lapltauexx20;

  tv4lapltauexx21 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 1] += tv4lapltauexx21;

  tv4lapltauexx22 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 2] += tv4lapltauexx22;

  tv4lapltauexx23 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 3] += tv4lapltauexx23;

  tv4lapltauexx24 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 4] += tv4lapltauexx24;

  tv4lapltauexx25 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 5] += tv4lapltauexx25;

  tv4lapltauexx26 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 6] += tv4lapltauexx26;

  tv4lapltauexx27 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 7] += tv4lapltauexx27;

  tv4lapltauexx28 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 8] += tv4lapltauexx28;

  tv4lapltauexx29 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 9] += tv4lapltauexx29;

  tv4lapltauexx210 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 10] += tv4lapltauexx210;

  tv4lapltauexx211 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 11] += tv4lapltauexx211;

  tv4laplexx30 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 0] += tv4laplexx30;

  tv4laplexx31 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 1] += tv4laplexx31;

  tv4laplexx32 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 2] += tv4laplexx32;

  tv4laplexx33 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 3] += tv4laplexx33;

  tv4laplexx34 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 4] += tv4laplexx34;

  tv4laplexx35 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 5] += tv4laplexx35;

  tv4laplexx36 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 6] += tv4laplexx36;

  tv4laplexx37 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 7] += tv4laplexx37;

  t5055 = 0.1e1 / t2369 / tau[0];
  t5067 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (-0.3e1 * t30 * t5055 * t60 - 0.4e1 / 0.3e1 * t64 * t5055 * exx[0] * t69));
  tv4tau40 = t7 * t5067;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 0] += tv4tau40;

  tv4tau41 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 1] += tv4tau41;

  tv4tau42 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 2] += tv4tau42;

  tv4tau43 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 3] += tv4tau43;

  t5069 = 0.1e1 / t2383 / tau[1];
  t5081 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t6 * t84 * (-0.3e1 * t86 * t5069 * t109 - 0.4e1 / 0.3e1 * t113 * t5069 * exx[1] * t69));
  tv4tau44 = t7 * t5081;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 4] += tv4tau44;

  t5085 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t350 * t5020 * t352);
  tv4tau3exx0 = t7 * t5085;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 0] += tv4tau3exx0;

  tv4tau3exx1 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 1] += tv4tau3exx1;

  tv4tau3exx2 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 2] += tv4tau3exx2;

  tv4tau3exx3 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 3] += tv4tau3exx3;

  tv4tau3exx4 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 4] += tv4tau3exx4;

  tv4tau3exx5 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 5] += tv4tau3exx5;

  tv4tau3exx6 = 0.e0;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 6] += tv4tau3exx6;

  t5089 = my_piecewise3(t77, 0, -0.3e1 / 0.8e1 * t359 * t5035 * t352);
  tv4tau3exx7 = t7 * t5089;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 7] += tv4tau3exx7;

  tv4tau2exx20 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 0] += tv4tau2exx20;

  tv4tau2exx21 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 1] += tv4tau2exx21;

  tv4tau2exx22 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 2] += tv4tau2exx22;

  tv4tau2exx23 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 3] += tv4tau2exx23;

  tv4tau2exx24 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 4] += tv4tau2exx24;

  tv4tau2exx25 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 5] += tv4tau2exx25;

  tv4tau2exx26 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 6] += tv4tau2exx26;

  tv4tau2exx27 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 7] += tv4tau2exx27;

  tv4tau2exx28 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 8] += tv4tau2exx28;

  tv4tauexx30 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 0] += tv4tauexx30;

  tv4tauexx31 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 1] += tv4tauexx31;

  tv4tauexx32 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 2] += tv4tauexx32;

  tv4tauexx33 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 3] += tv4tauexx33;

  tv4tauexx34 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 4] += tv4tauexx34;

  tv4tauexx35 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 5] += tv4tauexx35;

  tv4tauexx36 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 6] += tv4tauexx36;

  tv4tauexx37 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 7] += tv4tauexx37;

  tv4exx40 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 0] += tv4exx40;

  tv4exx41 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 1] += tv4exx41;

  tv4exx42 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 2] += tv4exx42;

  tv4exx43 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 3] += tv4exx43;

  tv4exx44 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 4] += tv4exx44;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t16, t18, t19, t20, t21, t22;
  double t23, t26, t27, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t40, t41, t42;
  double t44, t46, t47, t50, t51, t56, t59, t60;
  double t61, t63, t64, t67, t71, tzk0;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = 0.1e1 / rho[0];
  t22 = sigma[0] * t21;
  t23 = 0.1e1 / tau[0];
  t26 = 0.1e1 - t22 * t23 / 0.8e1;
  t27 = t4 * t4;
  t29 = POW_1_3(0.1e1 / M_PI);
  t30 = 0.1e1 / t29;
  t31 = t27 * t30;
  t32 = M_CBRT4;
  t33 = t31 * t32;
  t34 = M_CBRT2;
  t35 = t34 * t34;
  t36 = sigma[0] * t35;
  t37 = rho[0] * rho[0];
  t38 = t19 * t19;
  t40 = 0.1e1 / t38 / t37;
  t41 = sqrt(sigma[0]);
  t42 = t41 * t34;
  t44 = 0.1e1 / t19 / rho[0];
  t46 = log(t42 * t44 + sqrt(POW_2(t42 * t44) + 0.1e1));
  t47 = t44 * t46;
  t50 = 0.1e1 + 0.252e-1 * t42 * t47;
  t51 = 0.1e1 / t50;
  t56 = 0.1e1 + 0.93333333333333333332e-3 * t33 * t36 * t40 * t51;
  t59 = 0.1e1 / t19 / t37;
  t60 = sigma[0] * t59;
  t61 = t23 * exx[0];
  t63 = t32 * t34;
  t64 = t31 * t63;
  t67 = t26 * t56 - t60 * t61 * t64 / 0.36e2;
  t71 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t16, t18, t19, t20, t21, t22;
  double t23, t26, t27, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t40, t41, t42;
  double t44, t46, t47, t50, t51, t56, t59, t60;
  double t61, t63, t64, t67, t71, tzk0;

  double t73, t77, t78, t79, t82, t84, t89, t90;
  double t91, t92, t93, t94, t98, t99, t100, t101;
  double t104, t105, t106, t109, t112, t113, t117, t122;
  double tvrho0, t125, t132, t137, t138, t139, t142, t148;
  double t152, tvsigma0, tvlapl0, t154, t155, t156, t159, t163;
  double t167, tvtau0, t169, t170, t172, t175, tvexx0;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = 0.1e1 / rho[0];
  t22 = sigma[0] * t21;
  t23 = 0.1e1 / tau[0];
  t26 = 0.1e1 - t22 * t23 / 0.8e1;
  t27 = t4 * t4;
  t29 = POW_1_3(0.1e1 / M_PI);
  t30 = 0.1e1 / t29;
  t31 = t27 * t30;
  t32 = M_CBRT4;
  t33 = t31 * t32;
  t34 = M_CBRT2;
  t35 = t34 * t34;
  t36 = sigma[0] * t35;
  t37 = rho[0] * rho[0];
  t38 = t19 * t19;
  t40 = 0.1e1 / t38 / t37;
  t41 = sqrt(sigma[0]);
  t42 = t41 * t34;
  t44 = 0.1e1 / t19 / rho[0];
  t46 = log(t42 * t44 + sqrt(POW_2(t42 * t44) + 0.1e1));
  t47 = t44 * t46;
  t50 = 0.1e1 + 0.252e-1 * t42 * t47;
  t51 = 0.1e1 / t50;
  t56 = 0.1e1 + 0.93333333333333333332e-3 * t33 * t36 * t40 * t51;
  t59 = 0.1e1 / t19 / t37;
  t60 = sigma[0] * t59;
  t61 = t23 * exx[0];
  t63 = t32 * t34;
  t64 = t31 * t63;
  t67 = t26 * t56 - t60 * t61 * t64 / 0.36e2;
  t71 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t73 = t18 / t38;
  t77 = 0.1e1 / t37;
  t78 = sigma[0] * t77;
  t79 = t23 * t56;
  t82 = t37 * rho[0];
  t84 = 0.1e1 / t38 / t82;
  t89 = t32 * sigma[0];
  t90 = t31 * t89;
  t91 = t35 * t40;
  t92 = t50 * t50;
  t93 = 0.1e1 / t92;
  t94 = t59 * t46;
  t98 = t36 * t40 + 0.1e1;
  t99 = sqrt(t98);
  t100 = 0.1e1 / t99;
  t101 = t84 * t100;
  t104 = -0.336e-1 * t42 * t94 - 0.336e-1 * t36 * t101;
  t105 = t93 * t104;
  t106 = t91 * t105;
  t109 = -0.24888888888888888889e-2 * t33 * t36 * t84 * t51 - 0.93333333333333333332e-3 * t90 * t106;
  t112 = 0.1e1 / t19 / t82;
  t113 = sigma[0] * t112;
  t117 = t78 * t79 / 0.8e1 + t26 * t109 + 0.7e1 / 0.108e3 * t113 * t61 * t64;
  t122 = my_piecewise3(t3, 0, -t7 * t73 * t67 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t117);
  tvrho0 = 0.2e1 * rho[0] * t122 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t125 = t21 * t23;
  t132 = 0.1e1 / t41 * t34;
  t137 = 0.126e-1 * t132 * t47 + 0.126e-1 * t91 * t100;
  t138 = t93 * t137;
  t139 = t91 * t138;
  t142 = 0.93333333333333333332e-3 * t33 * t91 * t51 - 0.93333333333333333332e-3 * t90 * t139;
  t148 = -t125 * t56 / 0.8e1 + t26 * t142 - t59 * t23 * exx[0] * t64 / 0.36e2;
  t152 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t148);
  tvsigma0 = 0.2e1 * rho[0] * t152;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t154 = tau[0] * tau[0];
  t155 = 0.1e1 / t154;
  t156 = t155 * t56;
  t159 = t155 * exx[0];
  t163 = t22 * t156 / 0.8e1 + t60 * t159 * t64 / 0.36e2;
  t167 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t163);
  tvtau0 = 0.2e1 * rho[0] * t167;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t169 = t6 * t18;
  t170 = t169 * t78;
  t172 = t23 * t30 * t63;
  t175 = my_piecewise3(t3, 0, t170 * t172 / 0.32e2);
  tvexx0 = 0.2e1 * rho[0] * t175;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t16, t18, t19, t20, t21, t22;
  double t23, t26, t27, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t40, t41, t42;
  double t44, t46, t47, t50, t51, t56, t59, t60;
  double t61, t63, t64, t67, t71, tzk0;

  double t73, t77, t78, t79, t82, t84, t89, t90;
  double t91, t92, t93, t94, t98, t99, t100, t101;
  double t104, t105, t106, t109, t112, t113, t117, t122;
  double tvrho0, t125, t132, t137, t138, t139, t142, t148;
  double t152, tvsigma0, tvlapl0, t154, t155, t156, t159, t163;
  double t167, tvtau0, t169, t170, t172, t175, tvexx0;

  double t180, t187, t188, t191, t194, t196, t201, t202;
  double t206, t207, t208, t209, t212, t215, t218, t219;
  double t222, t224, t228, t229, t230, t233, t236, t237;
  double t241, t246, tv2rho20, t252, t257, t265, t268, t269;
  double t277, t279, t280, t281, t284, t285, t286, t289;
  double t295, t300, tv2rhosigma0, tv2rholapl0, t308, t314, t319, tv2rhotau0;
  double t322, t325, tv2rhoexx0, t332, t333, t334, t339, t342;
  double t343, t344, t347, t349, t353, t354, t355, t358;
  double t360, t364, tv2sigma20, tv2sigmalapl0, t366, t369, t376, t380;
  double tv2sigmatau0, t382, t385, tv2sigmaexx0, tv2lapl20, tv2lapltau0, tv2laplexx0, t388;
  double t389, t392, t396, t400, tv2tau20, t403, t406, tv2tauexx0;
  double tv2exx20;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = 0.1e1 / rho[0];
  t22 = sigma[0] * t21;
  t23 = 0.1e1 / tau[0];
  t26 = 0.1e1 - t22 * t23 / 0.8e1;
  t27 = t4 * t4;
  t29 = POW_1_3(0.1e1 / M_PI);
  t30 = 0.1e1 / t29;
  t31 = t27 * t30;
  t32 = M_CBRT4;
  t33 = t31 * t32;
  t34 = M_CBRT2;
  t35 = t34 * t34;
  t36 = sigma[0] * t35;
  t37 = rho[0] * rho[0];
  t38 = t19 * t19;
  t40 = 0.1e1 / t38 / t37;
  t41 = sqrt(sigma[0]);
  t42 = t41 * t34;
  t44 = 0.1e1 / t19 / rho[0];
  t46 = log(t42 * t44 + sqrt(POW_2(t42 * t44) + 0.1e1));
  t47 = t44 * t46;
  t50 = 0.1e1 + 0.252e-1 * t42 * t47;
  t51 = 0.1e1 / t50;
  t56 = 0.1e1 + 0.93333333333333333332e-3 * t33 * t36 * t40 * t51;
  t59 = 0.1e1 / t19 / t37;
  t60 = sigma[0] * t59;
  t61 = t23 * exx[0];
  t63 = t32 * t34;
  t64 = t31 * t63;
  t67 = t26 * t56 - t60 * t61 * t64 / 0.36e2;
  t71 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t73 = t18 / t38;
  t77 = 0.1e1 / t37;
  t78 = sigma[0] * t77;
  t79 = t23 * t56;
  t82 = t37 * rho[0];
  t84 = 0.1e1 / t38 / t82;
  t89 = t32 * sigma[0];
  t90 = t31 * t89;
  t91 = t35 * t40;
  t92 = t50 * t50;
  t93 = 0.1e1 / t92;
  t94 = t59 * t46;
  t98 = t36 * t40 + 0.1e1;
  t99 = sqrt(t98);
  t100 = 0.1e1 / t99;
  t101 = t84 * t100;
  t104 = -0.336e-1 * t42 * t94 - 0.336e-1 * t36 * t101;
  t105 = t93 * t104;
  t106 = t91 * t105;
  t109 = -0.24888888888888888889e-2 * t33 * t36 * t84 * t51 - 0.93333333333333333332e-3 * t90 * t106;
  t112 = 0.1e1 / t19 / t82;
  t113 = sigma[0] * t112;
  t117 = t78 * t79 / 0.8e1 + t26 * t109 + 0.7e1 / 0.108e3 * t113 * t61 * t64;
  t122 = my_piecewise3(t3, 0, -t7 * t73 * t67 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t117);
  tvrho0 = 0.2e1 * rho[0] * t122 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t125 = t21 * t23;
  t132 = 0.1e1 / t41 * t34;
  t137 = 0.126e-1 * t132 * t47 + 0.126e-1 * t91 * t100;
  t138 = t93 * t137;
  t139 = t91 * t138;
  t142 = 0.93333333333333333332e-3 * t33 * t91 * t51 - 0.93333333333333333332e-3 * t90 * t139;
  t148 = -t125 * t56 / 0.8e1 + t26 * t142 - t59 * t23 * exx[0] * t64 / 0.36e2;
  t152 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t148);
  tvsigma0 = 0.2e1 * rho[0] * t152;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t154 = tau[0] * tau[0];
  t155 = 0.1e1 / t154;
  t156 = t155 * t56;
  t159 = t155 * exx[0];
  t163 = t22 * t156 / 0.8e1 + t60 * t159 * t64 / 0.36e2;
  t167 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t163);
  tvtau0 = 0.2e1 * rho[0] * t167;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t169 = t6 * t18;
  t170 = t169 * t78;
  t172 = t23 * t30 * t63;
  t175 = my_piecewise3(t3, 0, t170 * t172 / 0.32e2);
  tvexx0 = 0.2e1 * rho[0] * t175;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t180 = t18 / t38 / rho[0];
  t187 = 0.1e1 / t82;
  t188 = sigma[0] * t187;
  t191 = t23 * t109;
  t194 = t37 * t37;
  t196 = 0.1e1 / t38 / t194;
  t201 = t35 * t84;
  t202 = t201 * t105;
  t206 = 0.1e1 / t92 / t50;
  t207 = t104 * t104;
  t208 = t206 * t207;
  t209 = t91 * t208;
  t212 = t112 * t46;
  t215 = t196 * t100;
  t218 = sigma[0] * sigma[0];
  t219 = t218 * t34;
  t222 = 0.1e1 / t19 / t194 / t82;
  t224 = 0.1e1 / t99 / t98;
  t228 = 0.784e-1 * t42 * t212 + 0.168e0 * t36 * t215 - 0.896e-1 * t219 * t222 * t224;
  t229 = t93 * t228;
  t230 = t91 * t229;
  t233 = 0.9125925925925925926e-2 * t33 * t36 * t196 * t51 + 0.49777777777777777778e-2 * t90 * t202 + 0.18666666666666666666e-2 * t90 * t209 - 0.93333333333333333332e-3 * t90 * t230;
  t236 = 0.1e1 / t19 / t194;
  t237 = sigma[0] * t236;
  t241 = -t188 * t79 / 0.4e1 + t78 * t191 / 0.4e1 + t26 * t233 - 0.35e2 / 0.162e3 * t237 * t61 * t64;
  t246 = my_piecewise3(t3, 0, t7 * t180 * t67 / 0.12e2 - t7 * t73 * t117 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t241);
  tv2rho20 = 0.2e1 * rho[0] * t246 + 0.4e1 * t122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t252 = t77 * t23;
  t257 = t23 * t142;
  t265 = t201 * t138;
  t268 = t206 * t137;
  t269 = t268 * t104;
  t277 = t194 * t37;
  t279 = 0.1e1 / t19 / t277;
  t280 = t34 * t279;
  t281 = t224 * sigma[0];
  t284 = -0.168e-1 * t132 * t94 - 0.504e-1 * t201 * t100 + 0.336e-1 * t280 * t281;
  t285 = t93 * t284;
  t286 = t91 * t285;
  t289 = -0.24888888888888888889e-2 * t33 * t201 * t51 - 0.93333333333333333332e-3 * t33 * t106 + 0.24888888888888888889e-2 * t90 * t265 + 0.18666666666666666666e-2 * t90 * t91 * t269 - 0.93333333333333333332e-3 * t90 * t286;
  t295 = t252 * t56 / 0.8e1 - t125 * t109 / 0.8e1 + t78 * t257 / 0.8e1 + t26 * t289 + 0.7e1 / 0.108e3 * t112 * t23 * exx[0] * t64;
  t300 = my_piecewise3(t3, 0, -t7 * t73 * t148 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t295);
  tv2rhosigma0 = 0.2e1 * rho[0] * t300 + 0.2e1 * t152;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t308 = t155 * t109;
  t314 = -t78 * t156 / 0.8e1 + t22 * t308 / 0.8e1 - 0.7e1 / 0.108e3 * t113 * t159 * t64;
  t319 = my_piecewise3(t3, 0, -t7 * t73 * t163 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t314);
  tv2rhotau0 = 0.2e1 * rho[0] * t319 + 0.2e1 * t167;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t322 = t169 * t188;
  t325 = my_piecewise3(t3, 0, -t322 * t172 / 0.16e2);
  tv2rhoexx0 = 0.2e1 * rho[0] * t325 + 0.2e1 * t175;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t332 = t137 * t137;
  t333 = t206 * t332;
  t334 = t91 * t333;
  t339 = 0.1e1 / t41 / sigma[0] * t34;
  t342 = 0.1e1 / sigma[0];
  t343 = t342 * t35;
  t344 = t40 * t100;
  t347 = t194 * rho[0];
  t349 = 0.1e1 / t19 / t347;
  t353 = -0.63e-2 * t339 * t47 + 0.63e-2 * t343 * t344 - 0.126e-1 * t34 * t349 * t224;
  t354 = t93 * t353;
  t355 = t91 * t354;
  t358 = -0.18666666666666666666e-2 * t33 * t139 + 0.18666666666666666666e-2 * t90 * t334 - 0.93333333333333333332e-3 * t90 * t355;
  t360 = -t125 * t142 / 0.4e1 + t26 * t358;
  t364 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t360);
  tv2sigma20 = 0.2e1 * rho[0] * t364;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  t366 = t21 * t155;
  t369 = t155 * t142;
  t376 = t366 * t56 / 0.8e1 + t22 * t369 / 0.8e1 + t59 * t155 * exx[0] * t64 / 0.36e2;
  t380 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t376);
  tv2sigmatau0 = 0.2e1 * rho[0] * t380;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t382 = t169 * t77;
  t385 = my_piecewise3(t3, 0, t382 * t172 / 0.32e2);
  tv2sigmaexx0 = 0.2e1 * rho[0] * t385;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  t388 = 0.1e1 / t154 / tau[0];
  t389 = t388 * t56;
  t392 = t388 * exx[0];
  t396 = -t22 * t389 / 0.4e1 - t60 * t392 * t64 / 0.18e2;
  t400 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t396);
  tv2tau20 = 0.2e1 * rho[0] * t400;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  t403 = t155 * t30 * t63;
  t406 = my_piecewise3(t3, 0, -t170 * t403 / 0.32e2);
  tv2tauexx0 = 0.2e1 * rho[0] * t406;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t16, t18, t19, t20, t21, t22;
  double t23, t26, t27, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t40, t41, t42;
  double t44, t46, t47, t50, t51, t56, t59, t60;
  double t61, t63, t64, t67, t71, tzk0;

  double t73, t77, t78, t79, t82, t84, t89, t90;
  double t91, t92, t93, t94, t98, t99, t100, t101;
  double t104, t105, t106, t109, t112, t113, t117, t122;
  double tvrho0, t125, t132, t137, t138, t139, t142, t148;
  double t152, tvsigma0, tvlapl0, t154, t155, t156, t159, t163;
  double t167, tvtau0, t169, t170, t172, t175, tvexx0;

  double t180, t187, t188, t191, t194, t196, t201, t202;
  double t206, t207, t208, t209, t212, t215, t218, t219;
  double t222, t224, t228, t229, t230, t233, t236, t237;
  double t241, t246, tv2rho20, t252, t257, t265, t268, t269;
  double t277, t279, t280, t281, t284, t285, t286, t289;
  double t295, t300, tv2rhosigma0, tv2rholapl0, t308, t314, t319, tv2rhotau0;
  double t322, t325, tv2rhoexx0, t332, t333, t334, t339, t342;
  double t343, t344, t347, t349, t353, t354, t355, t358;
  double t360, t364, tv2sigma20, tv2sigmalapl0, t366, t369, t376, t380;
  double tv2sigmatau0, t382, t385, tv2sigmaexx0, tv2lapl20, tv2lapltau0, tv2laplexx0, t388;
  double t389, t392, t396, t400, tv2tau20, t403, t406, tv2tauexx0;
  double tv2exx20;

  double t409, t419, t420, t425, t429, t434, t435, t438;
  double t441, t444, t445, t446, t447, t448, t451, t452;
  double t456, t462, t464, t468, t469, t470, t472, t474;
  double t477, t478, t479, t482, t484, t488, t493, tv3rho30;
  double t503, t512, t524, t530, t534, t538, t539, t543;
  double t551, t556, t559, t560, t561, t564, t570, t575;
  double tv3rho2sigma0, tv3rho2lapl0, t589, t595, t600, tv3rho2tau0, t604, t607;
  double tv3rho2exx0, t617, t623, t624, t625, t631, t634, t635;
  double t639, t643, t646, t647, t657, t659, t662, t663;
  double t664, t667, t669, t674, tv3rhosigma20, tv3rhosigmalapl0, t680, t687;
  double t694, t699, tv3rhosigmatau0, t702, t705, tv3rhosigmaexx0, tv3rholapl20, tv3rholapltau0;
  double tv3rholaplexx0, t713, t719, t724, tv3rhotau20, t729, tv3rhotauexx0, tv3rhoexx20;
  double t738, t739, t743, t749, t753, t756, t763, t764;
  double t768, t770, t774, tv3sigma30, tv3sigma2lapl0, t778, t781, t785;
  double tv3sigma2tau0, tv3sigma2exx0, tv3sigmalapl20, tv3sigmalapltau0, tv3sigmalaplexx0, t787, t790, t797;
  double t801, tv3sigmatau20, t805, tv3sigmatauexx0, tv3sigmaexx20, tv3lapl30, tv3lapl2tau0, tv3lapl2exx0;
  double tv3lapltau20, tv3lapltauexx0, tv3laplexx20, t807, t808, t820, tv3tau30, t823;
  double t826, tv3tau2exx0, tv3tauexx20, tv3exx30;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = 0.1e1 / rho[0];
  t22 = sigma[0] * t21;
  t23 = 0.1e1 / tau[0];
  t26 = 0.1e1 - t22 * t23 / 0.8e1;
  t27 = t4 * t4;
  t29 = POW_1_3(0.1e1 / M_PI);
  t30 = 0.1e1 / t29;
  t31 = t27 * t30;
  t32 = M_CBRT4;
  t33 = t31 * t32;
  t34 = M_CBRT2;
  t35 = t34 * t34;
  t36 = sigma[0] * t35;
  t37 = rho[0] * rho[0];
  t38 = t19 * t19;
  t40 = 0.1e1 / t38 / t37;
  t41 = sqrt(sigma[0]);
  t42 = t41 * t34;
  t44 = 0.1e1 / t19 / rho[0];
  t46 = log(t42 * t44 + sqrt(POW_2(t42 * t44) + 0.1e1));
  t47 = t44 * t46;
  t50 = 0.1e1 + 0.252e-1 * t42 * t47;
  t51 = 0.1e1 / t50;
  t56 = 0.1e1 + 0.93333333333333333332e-3 * t33 * t36 * t40 * t51;
  t59 = 0.1e1 / t19 / t37;
  t60 = sigma[0] * t59;
  t61 = t23 * exx[0];
  t63 = t32 * t34;
  t64 = t31 * t63;
  t67 = t26 * t56 - t60 * t61 * t64 / 0.36e2;
  t71 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t73 = t18 / t38;
  t77 = 0.1e1 / t37;
  t78 = sigma[0] * t77;
  t79 = t23 * t56;
  t82 = t37 * rho[0];
  t84 = 0.1e1 / t38 / t82;
  t89 = t32 * sigma[0];
  t90 = t31 * t89;
  t91 = t35 * t40;
  t92 = t50 * t50;
  t93 = 0.1e1 / t92;
  t94 = t59 * t46;
  t98 = t36 * t40 + 0.1e1;
  t99 = sqrt(t98);
  t100 = 0.1e1 / t99;
  t101 = t84 * t100;
  t104 = -0.336e-1 * t42 * t94 - 0.336e-1 * t36 * t101;
  t105 = t93 * t104;
  t106 = t91 * t105;
  t109 = -0.24888888888888888889e-2 * t33 * t36 * t84 * t51 - 0.93333333333333333332e-3 * t90 * t106;
  t112 = 0.1e1 / t19 / t82;
  t113 = sigma[0] * t112;
  t117 = t78 * t79 / 0.8e1 + t26 * t109 + 0.7e1 / 0.108e3 * t113 * t61 * t64;
  t122 = my_piecewise3(t3, 0, -t7 * t73 * t67 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t117);
  tvrho0 = 0.2e1 * rho[0] * t122 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t125 = t21 * t23;
  t132 = 0.1e1 / t41 * t34;
  t137 = 0.126e-1 * t132 * t47 + 0.126e-1 * t91 * t100;
  t138 = t93 * t137;
  t139 = t91 * t138;
  t142 = 0.93333333333333333332e-3 * t33 * t91 * t51 - 0.93333333333333333332e-3 * t90 * t139;
  t148 = -t125 * t56 / 0.8e1 + t26 * t142 - t59 * t23 * exx[0] * t64 / 0.36e2;
  t152 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t148);
  tvsigma0 = 0.2e1 * rho[0] * t152;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t154 = tau[0] * tau[0];
  t155 = 0.1e1 / t154;
  t156 = t155 * t56;
  t159 = t155 * exx[0];
  t163 = t22 * t156 / 0.8e1 + t60 * t159 * t64 / 0.36e2;
  t167 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t163);
  tvtau0 = 0.2e1 * rho[0] * t167;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t169 = t6 * t18;
  t170 = t169 * t78;
  t172 = t23 * t30 * t63;
  t175 = my_piecewise3(t3, 0, t170 * t172 / 0.32e2);
  tvexx0 = 0.2e1 * rho[0] * t175;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t180 = t18 / t38 / rho[0];
  t187 = 0.1e1 / t82;
  t188 = sigma[0] * t187;
  t191 = t23 * t109;
  t194 = t37 * t37;
  t196 = 0.1e1 / t38 / t194;
  t201 = t35 * t84;
  t202 = t201 * t105;
  t206 = 0.1e1 / t92 / t50;
  t207 = t104 * t104;
  t208 = t206 * t207;
  t209 = t91 * t208;
  t212 = t112 * t46;
  t215 = t196 * t100;
  t218 = sigma[0] * sigma[0];
  t219 = t218 * t34;
  t222 = 0.1e1 / t19 / t194 / t82;
  t224 = 0.1e1 / t99 / t98;
  t228 = 0.784e-1 * t42 * t212 + 0.168e0 * t36 * t215 - 0.896e-1 * t219 * t222 * t224;
  t229 = t93 * t228;
  t230 = t91 * t229;
  t233 = 0.9125925925925925926e-2 * t33 * t36 * t196 * t51 + 0.49777777777777777778e-2 * t90 * t202 + 0.18666666666666666666e-2 * t90 * t209 - 0.93333333333333333332e-3 * t90 * t230;
  t236 = 0.1e1 / t19 / t194;
  t237 = sigma[0] * t236;
  t241 = -t188 * t79 / 0.4e1 + t78 * t191 / 0.4e1 + t26 * t233 - 0.35e2 / 0.162e3 * t237 * t61 * t64;
  t246 = my_piecewise3(t3, 0, t7 * t180 * t67 / 0.12e2 - t7 * t73 * t117 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t241);
  tv2rho20 = 0.2e1 * rho[0] * t246 + 0.4e1 * t122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t252 = t77 * t23;
  t257 = t23 * t142;
  t265 = t201 * t138;
  t268 = t206 * t137;
  t269 = t268 * t104;
  t277 = t194 * t37;
  t279 = 0.1e1 / t19 / t277;
  t280 = t34 * t279;
  t281 = t224 * sigma[0];
  t284 = -0.168e-1 * t132 * t94 - 0.504e-1 * t201 * t100 + 0.336e-1 * t280 * t281;
  t285 = t93 * t284;
  t286 = t91 * t285;
  t289 = -0.24888888888888888889e-2 * t33 * t201 * t51 - 0.93333333333333333332e-3 * t33 * t106 + 0.24888888888888888889e-2 * t90 * t265 + 0.18666666666666666666e-2 * t90 * t91 * t269 - 0.93333333333333333332e-3 * t90 * t286;
  t295 = t252 * t56 / 0.8e1 - t125 * t109 / 0.8e1 + t78 * t257 / 0.8e1 + t26 * t289 + 0.7e1 / 0.108e3 * t112 * t23 * exx[0] * t64;
  t300 = my_piecewise3(t3, 0, -t7 * t73 * t148 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t295);
  tv2rhosigma0 = 0.2e1 * rho[0] * t300 + 0.2e1 * t152;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t308 = t155 * t109;
  t314 = -t78 * t156 / 0.8e1 + t22 * t308 / 0.8e1 - 0.7e1 / 0.108e3 * t113 * t159 * t64;
  t319 = my_piecewise3(t3, 0, -t7 * t73 * t163 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t314);
  tv2rhotau0 = 0.2e1 * rho[0] * t319 + 0.2e1 * t167;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t322 = t169 * t188;
  t325 = my_piecewise3(t3, 0, -t322 * t172 / 0.16e2);
  tv2rhoexx0 = 0.2e1 * rho[0] * t325 + 0.2e1 * t175;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t332 = t137 * t137;
  t333 = t206 * t332;
  t334 = t91 * t333;
  t339 = 0.1e1 / t41 / sigma[0] * t34;
  t342 = 0.1e1 / sigma[0];
  t343 = t342 * t35;
  t344 = t40 * t100;
  t347 = t194 * rho[0];
  t349 = 0.1e1 / t19 / t347;
  t353 = -0.63e-2 * t339 * t47 + 0.63e-2 * t343 * t344 - 0.126e-1 * t34 * t349 * t224;
  t354 = t93 * t353;
  t355 = t91 * t354;
  t358 = -0.18666666666666666666e-2 * t33 * t139 + 0.18666666666666666666e-2 * t90 * t334 - 0.93333333333333333332e-3 * t90 * t355;
  t360 = -t125 * t142 / 0.4e1 + t26 * t358;
  t364 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t360);
  tv2sigma20 = 0.2e1 * rho[0] * t364;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  t366 = t21 * t155;
  t369 = t155 * t142;
  t376 = t366 * t56 / 0.8e1 + t22 * t369 / 0.8e1 + t59 * t155 * exx[0] * t64 / 0.36e2;
  t380 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t376);
  tv2sigmatau0 = 0.2e1 * rho[0] * t380;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t382 = t169 * t77;
  t385 = my_piecewise3(t3, 0, t382 * t172 / 0.32e2);
  tv2sigmaexx0 = 0.2e1 * rho[0] * t385;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  t388 = 0.1e1 / t154 / tau[0];
  t389 = t388 * t56;
  t392 = t388 * exx[0];
  t396 = -t22 * t389 / 0.4e1 - t60 * t392 * t64 / 0.18e2;
  t400 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t396);
  tv2tau20 = 0.2e1 * rho[0] * t400;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  t403 = t155 * t30 * t63;
  t406 = my_piecewise3(t3, 0, -t170 * t403 / 0.32e2);
  tv2tauexx0 = 0.2e1 * rho[0] * t406;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

  t409 = t18 * t40;
  t419 = 0.1e1 / t194;
  t420 = sigma[0] * t419;
  t425 = t23 * t233;
  t429 = 0.1e1 / t38 / t347;
  t434 = t35 * t196;
  t435 = t434 * t105;
  t438 = t201 * t208;
  t441 = t201 * t229;
  t444 = t92 * t92;
  t445 = 0.1e1 / t444;
  t446 = t207 * t104;
  t447 = t445 * t446;
  t448 = t91 * t447;
  t451 = t206 * t104;
  t452 = t451 * t228;
  t456 = t236 * t46;
  t462 = t194 * t194;
  t464 = 0.1e1 / t19 / t462;
  t468 = t218 * sigma[0];
  t469 = t462 * t82;
  t470 = 0.1e1 / t469;
  t472 = t98 * t98;
  t474 = 0.1e1 / t99 / t472;
  t477 = -0.26133333333333333333e0 * t42 * t456 - 0.88853333333333333333e0 * t36 * t429 * t100 + 0.11050666666666666667e1 * t219 * t464 * t224 - 0.7168e0 * t468 * t470 * t474;
  t478 = t93 * t477;
  t479 = t91 * t478;
  t482 = -0.42587654320987654321e-1 * t33 * t36 * t429 * t51 - 0.27377777777777777778e-1 * t90 * t435 - 0.14933333333333333333e-1 * t90 * t438 + 0.74666666666666666667e-2 * t90 * t441 - 0.55999999999999999998e-2 * t90 * t448 + 0.55999999999999999998e-2 * t90 * t91 * t452 - 0.93333333333333333332e-3 * t90 * t479;
  t484 = sigma[0] * t349;
  t488 = 0.3e1 / 0.4e1 * t420 * t79 - 0.3e1 / 0.4e1 * t188 * t191 + 0.3e1 / 0.8e1 * t78 * t425 + t26 * t482 + 0.455e3 / 0.486e3 * t484 * t61 * t64;
  t493 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t409 * t67 + t7 * t180 * t117 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t73 * t241 - 0.3e1 / 0.8e1 * t7 * t20 * t488);
  tv3rho30 = 0.2e1 * rho[0] * t493 + 0.6e1 * t246;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t503 = t187 * t23;
  t512 = t23 * t289;
  t524 = t434 * t138;
  t530 = t201 * t285;
  t534 = t445 * t137 * t207;
  t538 = t206 * t284;
  t539 = t538 * t104;
  t543 = t268 * t228;
  t551 = t34 * t222;
  t556 = 0.1e1 / t462 / t37 * t474;
  t559 = 0.392e-1 * t132 * t212 + 0.2072e0 * t434 * t100 - 0.3472e0 * t551 * t281 + 0.2688e0 * t556 * t218;
  t560 = t93 * t559;
  t561 = t91 * t560;
  t564 = 0.9125925925925925926e-2 * t33 * t434 * t51 + 0.49777777777777777778e-2 * t33 * t202 + 0.18666666666666666666e-2 * t33 * t209 - 0.93333333333333333332e-3 * t33 * t230 - 0.9125925925925925926e-2 * t90 * t524 - 0.99555555555555555554e-2 * t90 * t201 * t269 + 0.49777777777777777778e-2 * t90 * t530 - 0.55999999999999999998e-2 * t90 * t91 * t534 + 0.37333333333333333332e-2 * t90 * t91 * t539 + 0.18666666666666666666e-2 * t90 * t91 * t543 - 0.93333333333333333332e-3 * t90 * t561;
  t570 = -t503 * t56 / 0.4e1 + t252 * t109 / 0.4e1 - t125 * t233 / 0.8e1 - t188 * t257 / 0.4e1 + t78 * t512 / 0.4e1 + t26 * t564 - 0.35e2 / 0.162e3 * t236 * t23 * exx[0] * t64;
  t575 = my_piecewise3(t3, 0, t7 * t180 * t148 / 0.12e2 - t7 * t73 * t295 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t570);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t575 + 0.4e1 * t300;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  t589 = t155 * t233;
  t595 = t188 * t156 / 0.4e1 - t78 * t308 / 0.4e1 + t22 * t589 / 0.8e1 + 0.35e2 / 0.162e3 * t237 * t159 * t64;
  t600 = my_piecewise3(t3, 0, t7 * t180 * t163 / 0.12e2 - t7 * t73 * t314 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t595);
  tv3rho2tau0 = 0.2e1 * rho[0] * t600 + 0.4e1 * t319;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t604 = t169 * t420;
  t607 = my_piecewise3(t3, 0, 0.3e1 / 0.16e2 * t604 * t172);
  tv3rho2exx0 = 0.2e1 * rho[0] * t607 + 0.4e1 * t325;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 0] += tv3rho2exx0;

  t617 = t23 * t358;
  t623 = t31 * t32 * t35;
  t624 = t40 * t206;
  t625 = t137 * t104;
  t631 = t201 * t333;
  t634 = t445 * t332;
  t635 = t634 * t104;
  t639 = t268 * t284;
  t643 = t201 * t354;
  t646 = t206 * t353;
  t647 = t646 * t104;
  t657 = t462 * rho[0];
  t659 = 0.1e1 / t657 * t474;
  t662 = 0.84e-2 * t339 * t94 - 0.84e-2 * t343 * t101 + 0.84e-1 * t280 * t224 - 0.1008e0 * t659 * sigma[0];
  t663 = t93 * t662;
  t664 = t91 * t663;
  t667 = 0.49777777777777777776e-2 * t33 * t265 + 0.37333333333333333332e-2 * t623 * t624 * t625 - 0.18666666666666666666e-2 * t33 * t286 - 0.49777777777777777776e-2 * t90 * t631 - 0.55999999999999999998e-2 * t90 * t91 * t635 + 0.37333333333333333332e-2 * t90 * t91 * t639 + 0.24888888888888888889e-2 * t90 * t643 + 0.18666666666666666666e-2 * t90 * t91 * t647 - 0.93333333333333333332e-3 * t90 * t664;
  t669 = t252 * t142 / 0.4e1 - t125 * t289 / 0.4e1 + t78 * t617 / 0.8e1 + t26 * t667;
  t674 = my_piecewise3(t3, 0, -t7 * t73 * t360 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t669);
  tv3rhosigma20 = 0.2e1 * rho[0] * t674 + 0.2e1 * t364;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  t680 = t77 * t155;
  t687 = t155 * t289;
  t694 = -t680 * t56 / 0.8e1 + t366 * t109 / 0.8e1 - t78 * t369 / 0.8e1 + t22 * t687 / 0.8e1 - 0.7e1 / 0.108e3 * t112 * t155 * exx[0] * t64;
  t699 = my_piecewise3(t3, 0, -t7 * t73 * t376 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t694);
  tv3rhosigmatau0 = 0.2e1 * rho[0] * t699 + 0.2e1 * t380;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  t702 = t169 * t187;
  t705 = my_piecewise3(t3, 0, -t702 * t172 / 0.16e2);
  tv3rhosigmaexx0 = 0.2e1 * rho[0] * t705 + 0.2e1 * t385;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 0] += tv3rhosigmaexx0;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholaplexx0 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 0] += tv3rholaplexx0;

  t713 = t388 * t109;
  t719 = t78 * t389 / 0.4e1 - t22 * t713 / 0.4e1 + 0.7e1 / 0.54e2 * t113 * t392 * t64;
  t724 = my_piecewise3(t3, 0, -t7 * t73 * t396 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t719);
  tv3rhotau20 = 0.2e1 * rho[0] * t724 + 0.2e1 * t400;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  t729 = my_piecewise3(t3, 0, t322 * t403 / 0.16e2);
  tv3rhotauexx0 = 0.2e1 * rho[0] * t729 + 0.2e1 * t406;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 0] += tv3rhotauexx0;

  tv3rhoexx20 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 0] += tv3rhoexx20;

  t738 = t332 * t137;
  t739 = t445 * t738;
  t743 = t268 * t353;
  t749 = 0.1e1 / t41 / t218 * t34;
  t753 = 0.1e1 / t218 * t35;
  t756 = t342 * t34;
  t763 = 0.945e-2 * t749 * t47 - 0.945e-2 * t753 * t344 - 0.63e-2 * t756 * t349 * t224 + 0.378e-1 / t462 * t474;
  t764 = t93 * t763;
  t768 = 0.55999999999999999998e-2 * t33 * t334 - 0.27999999999999999999e-2 * t33 * t355 - 0.55999999999999999998e-2 * t90 * t91 * t739 + 0.55999999999999999998e-2 * t90 * t91 * t743 - 0.93333333333333333332e-3 * t90 * t91 * t764;
  t770 = -0.3e1 / 0.8e1 * t125 * t358 + t26 * t768;
  t774 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t770);
  tv3sigma30 = 0.2e1 * rho[0] * t774;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  t778 = t155 * t358;
  t781 = t366 * t142 / 0.4e1 + t22 * t778 / 0.8e1;
  t785 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t781);
  tv3sigma2tau0 = 0.2e1 * rho[0] * t785;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2exx0 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 0] += tv3sigma2exx0;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalaplexx0 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 0] += tv3sigmalaplexx0;

  t787 = t21 * t388;
  t790 = t388 * t142;
  t797 = -t787 * t56 / 0.4e1 - t22 * t790 / 0.4e1 - t59 * t388 * exx[0] * t64 / 0.18e2;
  t801 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t797);
  tv3sigmatau20 = 0.2e1 * rho[0] * t801;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  t805 = my_piecewise3(t3, 0, -t382 * t403 / 0.32e2);
  tv3sigmatauexx0 = 0.2e1 * rho[0] * t805;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 0] += tv3sigmatauexx0;

  tv3sigmaexx20 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 0] += tv3sigmaexx20;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2exx0 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 0] += tv3lapl2exx0;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltauexx0 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 0] += tv3lapltauexx0;

  tv3laplexx20 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 0] += tv3laplexx20;

  t807 = t154 * t154;
  t808 = 0.1e1 / t807;
  t820 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.4e1 * t22 * t808 * t56 + t60 * t808 * exx[0] * t64 / 0.6e1));
  tv3tau30 = 0.2e1 * rho[0] * t820;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  t823 = t388 * t30 * t63;
  t826 = my_piecewise3(t3, 0, t170 * t823 / 0.16e2);
  tv3tau2exx0 = 0.2e1 * rho[0] * t826;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 0] += tv3tau2exx0;

  tv3tauexx20 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 0] += tv3tauexx20;

  tv3exx30 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 0] += tv3exx30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, const double *exx, xc_hgga_out_params *out)
{
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t16, t18, t19, t20, t21, t22;
  double t23, t26, t27, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t40, t41, t42;
  double t44, t46, t47, t50, t51, t56, t59, t60;
  double t61, t63, t64, t67, t71, tzk0;

  double t73, t77, t78, t79, t82, t84, t89, t90;
  double t91, t92, t93, t94, t98, t99, t100, t101;
  double t104, t105, t106, t109, t112, t113, t117, t122;
  double tvrho0, t125, t132, t137, t138, t139, t142, t148;
  double t152, tvsigma0, tvlapl0, t154, t155, t156, t159, t163;
  double t167, tvtau0, t169, t170, t172, t175, tvexx0;

  double t180, t187, t188, t191, t194, t196, t201, t202;
  double t206, t207, t208, t209, t212, t215, t218, t219;
  double t222, t224, t228, t229, t230, t233, t236, t237;
  double t241, t246, tv2rho20, t252, t257, t265, t268, t269;
  double t277, t279, t280, t281, t284, t285, t286, t289;
  double t295, t300, tv2rhosigma0, tv2rholapl0, t308, t314, t319, tv2rhotau0;
  double t322, t325, tv2rhoexx0, t332, t333, t334, t339, t342;
  double t343, t344, t347, t349, t353, t354, t355, t358;
  double t360, t364, tv2sigma20, tv2sigmalapl0, t366, t369, t376, t380;
  double tv2sigmatau0, t382, t385, tv2sigmaexx0, tv2lapl20, tv2lapltau0, tv2laplexx0, t388;
  double t389, t392, t396, t400, tv2tau20, t403, t406, tv2tauexx0;
  double tv2exx20;

  double t409, t419, t420, t425, t429, t434, t435, t438;
  double t441, t444, t445, t446, t447, t448, t451, t452;
  double t456, t462, t464, t468, t469, t470, t472, t474;
  double t477, t478, t479, t482, t484, t488, t493, tv3rho30;
  double t503, t512, t524, t530, t534, t538, t539, t543;
  double t551, t556, t559, t560, t561, t564, t570, t575;
  double tv3rho2sigma0, tv3rho2lapl0, t589, t595, t600, tv3rho2tau0, t604, t607;
  double tv3rho2exx0, t617, t623, t624, t625, t631, t634, t635;
  double t639, t643, t646, t647, t657, t659, t662, t663;
  double t664, t667, t669, t674, tv3rhosigma20, tv3rhosigmalapl0, t680, t687;
  double t694, t699, tv3rhosigmatau0, t702, t705, tv3rhosigmaexx0, tv3rholapl20, tv3rholapltau0;
  double tv3rholaplexx0, t713, t719, t724, tv3rhotau20, t729, tv3rhotauexx0, tv3rhoexx20;
  double t738, t739, t743, t749, t753, t756, t763, t764;
  double t768, t770, t774, tv3sigma30, tv3sigma2lapl0, t778, t781, t785;
  double tv3sigma2tau0, tv3sigma2exx0, tv3sigmalapl20, tv3sigmalapltau0, tv3sigmalaplexx0, t787, t790, t797;
  double t801, tv3sigmatau20, t805, tv3sigmatauexx0, tv3sigmaexx20, tv3lapl30, tv3lapl2tau0, tv3lapl2exx0;
  double tv3lapltau20, tv3lapltauexx0, tv3laplexx20, t807, t808, t820, tv3tau30, t823;
  double t826, tv3tau2exx0, tv3tauexx20, tv3exx30;

  double t843, t854, t859, t879, t880, t890, t910, t915;
  double t922, t931, t942, tv4rho40, t1044, t1045, t1062, t1074;
  double tv4rho3sigma0, tv4rho3lapl0, t1104, tv4rho3tau0, t1111, tv4rho3exx0, t1180, t1189;
  double t1228, t1236, tv4rho2sigma20, tv4rho2sigmalapl0, t1269, tv4rho2sigmatau0, t1276, tv4rho2sigmaexx0;
  double tv4rho2lapl20, tv4rho2lapltau0, tv4rho2laplexx0, t1301, tv4rho2tau20, t1307, tv4rho2tauexx0, tv4rho2exx20;
  double t1392, t1399, tv4rhosigma30, tv4rhosigma2lapl0, t1419, tv4rhosigma2tau0, tv4rhosigma2exx0, tv4rhosigmalapl20;
  double tv4rhosigmalapltau0, tv4rhosigmalaplexx0, t1444, tv4rhosigmatau20, t1449, tv4rhosigmatauexx0, tv4rhosigmaexx20, tv4rholapl30;
  double tv4rholapl2tau0, tv4rholapl2exx0, tv4rholapltau20, tv4rholapltauexx0, tv4rholaplexx2v4rhotau30, t1454, tv4rhotau2exx0, tv4rhotauexx20;
  double tv4rhoexx3v4sigma40, tv4sigma3lapl0, t1466, tv4sigma3tau0, tv4sigma3exx0, tv4sigma2lapl20, tv4sigma2lapltau0, tv4sigma2laplexx0;
  double t1477, tv4sigma2tau20, tv4sigma2tauexx0, tv4sigma2exx20, tv4sigmalapl30, tv4sigmalapl2tau0, tv4sigmalapl2exx0, tv4sigmalapltau20;
  double tv4sigmalapltauexx0, tv4sigmalaplexx20, t1493, tv4sigmatau30, t1497, tv4sigmatau2exx0, tv4sigmatauexx20, tv4sigmaexx30;
  double tv4lapl40, tv4lapl3tau0, tv4lapl3exx0, tv4lapl2tau20, tv4lapl2tauexx0, tv4lapl2exx20, tv4lapltau30, tv4lapltau2exx0;
  double tv4lapltauexx20, tv4laplexx30, t1500, t1512, tv4tau40, t1518, tv4tau3exx0, tv4tau2exx20;
  double tv4tauexx30, tv4exx40;


  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = 0.1e1 / rho[0];
  t22 = sigma[0] * t21;
  t23 = 0.1e1 / tau[0];
  t26 = 0.1e1 - t22 * t23 / 0.8e1;
  t27 = t4 * t4;
  t29 = POW_1_3(0.1e1 / M_PI);
  t30 = 0.1e1 / t29;
  t31 = t27 * t30;
  t32 = M_CBRT4;
  t33 = t31 * t32;
  t34 = M_CBRT2;
  t35 = t34 * t34;
  t36 = sigma[0] * t35;
  t37 = rho[0] * rho[0];
  t38 = t19 * t19;
  t40 = 0.1e1 / t38 / t37;
  t41 = sqrt(sigma[0]);
  t42 = t41 * t34;
  t44 = 0.1e1 / t19 / rho[0];
  t46 = log(t42 * t44 + sqrt(POW_2(t42 * t44) + 0.1e1));
  t47 = t44 * t46;
  t50 = 0.1e1 + 0.252e-1 * t42 * t47;
  t51 = 0.1e1 / t50;
  t56 = 0.1e1 + 0.93333333333333333332e-3 * t33 * t36 * t40 * t51;
  t59 = 0.1e1 / t19 / t37;
  t60 = sigma[0] * t59;
  t61 = t23 * exx[0];
  t63 = t32 * t34;
  t64 = t31 * t63;
  t67 = t26 * t56 - t60 * t61 * t64 / 0.36e2;
  t71 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t67);
  tzk0 = 0.2e1 * t71;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t73 = t18 / t38;
  t77 = 0.1e1 / t37;
  t78 = sigma[0] * t77;
  t79 = t23 * t56;
  t82 = t37 * rho[0];
  t84 = 0.1e1 / t38 / t82;
  t89 = t32 * sigma[0];
  t90 = t31 * t89;
  t91 = t35 * t40;
  t92 = t50 * t50;
  t93 = 0.1e1 / t92;
  t94 = t59 * t46;
  t98 = t36 * t40 + 0.1e1;
  t99 = sqrt(t98);
  t100 = 0.1e1 / t99;
  t101 = t84 * t100;
  t104 = -0.336e-1 * t42 * t94 - 0.336e-1 * t36 * t101;
  t105 = t93 * t104;
  t106 = t91 * t105;
  t109 = -0.24888888888888888889e-2 * t33 * t36 * t84 * t51 - 0.93333333333333333332e-3 * t90 * t106;
  t112 = 0.1e1 / t19 / t82;
  t113 = sigma[0] * t112;
  t117 = t78 * t79 / 0.8e1 + t26 * t109 + 0.7e1 / 0.108e3 * t113 * t61 * t64;
  t122 = my_piecewise3(t3, 0, -t7 * t73 * t67 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t117);
  tvrho0 = 0.2e1 * rho[0] * t122 + 0.2e1 * t71;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t125 = t21 * t23;
  t132 = 0.1e1 / t41 * t34;
  t137 = 0.126e-1 * t132 * t47 + 0.126e-1 * t91 * t100;
  t138 = t93 * t137;
  t139 = t91 * t138;
  t142 = 0.93333333333333333332e-3 * t33 * t91 * t51 - 0.93333333333333333332e-3 * t90 * t139;
  t148 = -t125 * t56 / 0.8e1 + t26 * t142 - t59 * t23 * exx[0] * t64 / 0.36e2;
  t152 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t148);
  tvsigma0 = 0.2e1 * rho[0] * t152;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim->vlapl + 0] += tvlapl0;

  t154 = tau[0] * tau[0];
  t155 = 0.1e1 / t154;
  t156 = t155 * t56;
  t159 = t155 * exx[0];
  t163 = t22 * t156 / 0.8e1 + t60 * t159 * t64 / 0.36e2;
  t167 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t163);
  tvtau0 = 0.2e1 * rho[0] * t167;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim->vtau + 0] += tvtau0;

  t169 = t6 * t18;
  t170 = t169 * t78;
  t172 = t23 * t30 * t63;
  t175 = my_piecewise3(t3, 0, t170 * t172 / 0.32e2);
  tvexx0 = 0.2e1 * rho[0] * t175;

  if(out->vexx != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vexx[ip*p->dim->vexx + 0] += tvexx0;

  t180 = t18 / t38 / rho[0];
  t187 = 0.1e1 / t82;
  t188 = sigma[0] * t187;
  t191 = t23 * t109;
  t194 = t37 * t37;
  t196 = 0.1e1 / t38 / t194;
  t201 = t35 * t84;
  t202 = t201 * t105;
  t206 = 0.1e1 / t92 / t50;
  t207 = t104 * t104;
  t208 = t206 * t207;
  t209 = t91 * t208;
  t212 = t112 * t46;
  t215 = t196 * t100;
  t218 = sigma[0] * sigma[0];
  t219 = t218 * t34;
  t222 = 0.1e1 / t19 / t194 / t82;
  t224 = 0.1e1 / t99 / t98;
  t228 = 0.784e-1 * t42 * t212 + 0.168e0 * t36 * t215 - 0.896e-1 * t219 * t222 * t224;
  t229 = t93 * t228;
  t230 = t91 * t229;
  t233 = 0.9125925925925925926e-2 * t33 * t36 * t196 * t51 + 0.49777777777777777778e-2 * t90 * t202 + 0.18666666666666666666e-2 * t90 * t209 - 0.93333333333333333332e-3 * t90 * t230;
  t236 = 0.1e1 / t19 / t194;
  t237 = sigma[0] * t236;
  t241 = -t188 * t79 / 0.4e1 + t78 * t191 / 0.4e1 + t26 * t233 - 0.35e2 / 0.162e3 * t237 * t61 * t64;
  t246 = my_piecewise3(t3, 0, t7 * t180 * t67 / 0.12e2 - t7 * t73 * t117 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t241);
  tv2rho20 = 0.2e1 * rho[0] * t246 + 0.4e1 * t122;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t252 = t77 * t23;
  t257 = t23 * t142;
  t265 = t201 * t138;
  t268 = t206 * t137;
  t269 = t268 * t104;
  t277 = t194 * t37;
  t279 = 0.1e1 / t19 / t277;
  t280 = t34 * t279;
  t281 = t224 * sigma[0];
  t284 = -0.168e-1 * t132 * t94 - 0.504e-1 * t201 * t100 + 0.336e-1 * t280 * t281;
  t285 = t93 * t284;
  t286 = t91 * t285;
  t289 = -0.24888888888888888889e-2 * t33 * t201 * t51 - 0.93333333333333333332e-3 * t33 * t106 + 0.24888888888888888889e-2 * t90 * t265 + 0.18666666666666666666e-2 * t90 * t91 * t269 - 0.93333333333333333332e-3 * t90 * t286;
  t295 = t252 * t56 / 0.8e1 - t125 * t109 / 0.8e1 + t78 * t257 / 0.8e1 + t26 * t289 + 0.7e1 / 0.108e3 * t112 * t23 * exx[0] * t64;
  t300 = my_piecewise3(t3, 0, -t7 * t73 * t148 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t295);
  tv2rhosigma0 = 0.2e1 * rho[0] * t300 + 0.2e1 * t152;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim->v2rholapl + 0] += tv2rholapl0;

  t308 = t155 * t109;
  t314 = -t78 * t156 / 0.8e1 + t22 * t308 / 0.8e1 - 0.7e1 / 0.108e3 * t113 * t159 * t64;
  t319 = my_piecewise3(t3, 0, -t7 * t73 * t163 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t314);
  tv2rhotau0 = 0.2e1 * rho[0] * t319 + 0.2e1 * t167;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim->v2rhotau + 0] += tv2rhotau0;

  t322 = t169 * t188;
  t325 = my_piecewise3(t3, 0, -t322 * t172 / 0.16e2);
  tv2rhoexx0 = 0.2e1 * rho[0] * t325 + 0.2e1 * t175;

  if(out->v2rhoexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhoexx[ip*p->dim->v2rhoexx + 0] += tv2rhoexx0;

  t332 = t137 * t137;
  t333 = t206 * t332;
  t334 = t91 * t333;
  t339 = 0.1e1 / t41 / sigma[0] * t34;
  t342 = 0.1e1 / sigma[0];
  t343 = t342 * t35;
  t344 = t40 * t100;
  t347 = t194 * rho[0];
  t349 = 0.1e1 / t19 / t347;
  t353 = -0.63e-2 * t339 * t47 + 0.63e-2 * t343 * t344 - 0.126e-1 * t34 * t349 * t224;
  t354 = t93 * t353;
  t355 = t91 * t354;
  t358 = -0.18666666666666666666e-2 * t33 * t139 + 0.18666666666666666666e-2 * t90 * t334 - 0.93333333333333333332e-3 * t90 * t355;
  t360 = -t125 * t142 / 0.4e1 + t26 * t358;
  t364 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t360);
  tv2sigma20 = 0.2e1 * rho[0] * t364;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim->v2sigmalapl + 0] += tv2sigmalapl0;

  t366 = t21 * t155;
  t369 = t155 * t142;
  t376 = t366 * t56 / 0.8e1 + t22 * t369 / 0.8e1 + t59 * t155 * exx[0] * t64 / 0.36e2;
  t380 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t376);
  tv2sigmatau0 = 0.2e1 * rho[0] * t380;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim->v2sigmatau + 0] += tv2sigmatau0;

  t382 = t169 * t77;
  t385 = my_piecewise3(t3, 0, t382 * t172 / 0.32e2);
  tv2sigmaexx0 = 0.2e1 * rho[0] * t385;

  if(out->v2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmaexx[ip*p->dim->v2sigmaexx + 0] += tv2sigmaexx0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim->v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim->v2lapltau + 0] += tv2lapltau0;

  tv2laplexx0 = 0.e0;

  if(out->v2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2laplexx[ip*p->dim->v2laplexx + 0] += tv2laplexx0;

  t388 = 0.1e1 / t154 / tau[0];
  t389 = t388 * t56;
  t392 = t388 * exx[0];
  t396 = -t22 * t389 / 0.4e1 - t60 * t392 * t64 / 0.18e2;
  t400 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t396);
  tv2tau20 = 0.2e1 * rho[0] * t400;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim->v2tau2 + 0] += tv2tau20;

  t403 = t155 * t30 * t63;
  t406 = my_piecewise3(t3, 0, -t170 * t403 / 0.32e2);
  tv2tauexx0 = 0.2e1 * rho[0] * t406;

  if(out->v2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tauexx[ip*p->dim->v2tauexx + 0] += tv2tauexx0;

  tv2exx20 = 0.e0;

  if(out->v2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2exx2[ip*p->dim->v2exx2 + 0] += tv2exx20;

  t409 = t18 * t40;
  t419 = 0.1e1 / t194;
  t420 = sigma[0] * t419;
  t425 = t23 * t233;
  t429 = 0.1e1 / t38 / t347;
  t434 = t35 * t196;
  t435 = t434 * t105;
  t438 = t201 * t208;
  t441 = t201 * t229;
  t444 = t92 * t92;
  t445 = 0.1e1 / t444;
  t446 = t207 * t104;
  t447 = t445 * t446;
  t448 = t91 * t447;
  t451 = t206 * t104;
  t452 = t451 * t228;
  t456 = t236 * t46;
  t462 = t194 * t194;
  t464 = 0.1e1 / t19 / t462;
  t468 = t218 * sigma[0];
  t469 = t462 * t82;
  t470 = 0.1e1 / t469;
  t472 = t98 * t98;
  t474 = 0.1e1 / t99 / t472;
  t477 = -0.26133333333333333333e0 * t42 * t456 - 0.88853333333333333333e0 * t36 * t429 * t100 + 0.11050666666666666667e1 * t219 * t464 * t224 - 0.7168e0 * t468 * t470 * t474;
  t478 = t93 * t477;
  t479 = t91 * t478;
  t482 = -0.42587654320987654321e-1 * t33 * t36 * t429 * t51 - 0.27377777777777777778e-1 * t90 * t435 - 0.14933333333333333333e-1 * t90 * t438 + 0.74666666666666666667e-2 * t90 * t441 - 0.55999999999999999998e-2 * t90 * t448 + 0.55999999999999999998e-2 * t90 * t91 * t452 - 0.93333333333333333332e-3 * t90 * t479;
  t484 = sigma[0] * t349;
  t488 = 0.3e1 / 0.4e1 * t420 * t79 - 0.3e1 / 0.4e1 * t188 * t191 + 0.3e1 / 0.8e1 * t78 * t425 + t26 * t482 + 0.455e3 / 0.486e3 * t484 * t61 * t64;
  t493 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t409 * t67 + t7 * t180 * t117 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t73 * t241 - 0.3e1 / 0.8e1 * t7 * t20 * t488);
  tv3rho30 = 0.2e1 * rho[0] * t493 + 0.6e1 * t246;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t503 = t187 * t23;
  t512 = t23 * t289;
  t524 = t434 * t138;
  t530 = t201 * t285;
  t534 = t445 * t137 * t207;
  t538 = t206 * t284;
  t539 = t538 * t104;
  t543 = t268 * t228;
  t551 = t34 * t222;
  t556 = 0.1e1 / t462 / t37 * t474;
  t559 = 0.392e-1 * t132 * t212 + 0.2072e0 * t434 * t100 - 0.3472e0 * t551 * t281 + 0.2688e0 * t556 * t218;
  t560 = t93 * t559;
  t561 = t91 * t560;
  t564 = 0.9125925925925925926e-2 * t33 * t434 * t51 + 0.49777777777777777778e-2 * t33 * t202 + 0.18666666666666666666e-2 * t33 * t209 - 0.93333333333333333332e-3 * t33 * t230 - 0.9125925925925925926e-2 * t90 * t524 - 0.99555555555555555554e-2 * t90 * t201 * t269 + 0.49777777777777777778e-2 * t90 * t530 - 0.55999999999999999998e-2 * t90 * t91 * t534 + 0.37333333333333333332e-2 * t90 * t91 * t539 + 0.18666666666666666666e-2 * t90 * t91 * t543 - 0.93333333333333333332e-3 * t90 * t561;
  t570 = -t503 * t56 / 0.4e1 + t252 * t109 / 0.4e1 - t125 * t233 / 0.8e1 - t188 * t257 / 0.4e1 + t78 * t512 / 0.4e1 + t26 * t564 - 0.35e2 / 0.162e3 * t236 * t23 * exx[0] * t64;
  t575 = my_piecewise3(t3, 0, t7 * t180 * t148 / 0.12e2 - t7 * t73 * t295 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t570);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t575 + 0.4e1 * t300;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim->v3rho2lapl + 0] += tv3rho2lapl0;

  t589 = t155 * t233;
  t595 = t188 * t156 / 0.4e1 - t78 * t308 / 0.4e1 + t22 * t589 / 0.8e1 + 0.35e2 / 0.162e3 * t237 * t159 * t64;
  t600 = my_piecewise3(t3, 0, t7 * t180 * t163 / 0.12e2 - t7 * t73 * t314 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t595);
  tv3rho2tau0 = 0.2e1 * rho[0] * t600 + 0.4e1 * t319;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim->v3rho2tau + 0] += tv3rho2tau0;

  t604 = t169 * t420;
  t607 = my_piecewise3(t3, 0, 0.3e1 / 0.16e2 * t604 * t172);
  tv3rho2exx0 = 0.2e1 * rho[0] * t607 + 0.4e1 * t325;

  if(out->v3rho2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2exx[ip*p->dim->v3rho2exx + 0] += tv3rho2exx0;

  t617 = t23 * t358;
  t623 = t31 * t32 * t35;
  t624 = t40 * t206;
  t625 = t137 * t104;
  t631 = t201 * t333;
  t634 = t445 * t332;
  t635 = t634 * t104;
  t639 = t268 * t284;
  t643 = t201 * t354;
  t646 = t206 * t353;
  t647 = t646 * t104;
  t657 = t462 * rho[0];
  t659 = 0.1e1 / t657 * t474;
  t662 = 0.84e-2 * t339 * t94 - 0.84e-2 * t343 * t101 + 0.84e-1 * t280 * t224 - 0.1008e0 * t659 * sigma[0];
  t663 = t93 * t662;
  t664 = t91 * t663;
  t667 = 0.49777777777777777776e-2 * t33 * t265 + 0.37333333333333333332e-2 * t623 * t624 * t625 - 0.18666666666666666666e-2 * t33 * t286 - 0.49777777777777777776e-2 * t90 * t631 - 0.55999999999999999998e-2 * t90 * t91 * t635 + 0.37333333333333333332e-2 * t90 * t91 * t639 + 0.24888888888888888889e-2 * t90 * t643 + 0.18666666666666666666e-2 * t90 * t91 * t647 - 0.93333333333333333332e-3 * t90 * t664;
  t669 = t252 * t142 / 0.4e1 - t125 * t289 / 0.4e1 + t78 * t617 / 0.8e1 + t26 * t667;
  t674 = my_piecewise3(t3, 0, -t7 * t73 * t360 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t669);
  tv3rhosigma20 = 0.2e1 * rho[0] * t674 + 0.2e1 * t364;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim->v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  t680 = t77 * t155;
  t687 = t155 * t289;
  t694 = -t680 * t56 / 0.8e1 + t366 * t109 / 0.8e1 - t78 * t369 / 0.8e1 + t22 * t687 / 0.8e1 - 0.7e1 / 0.108e3 * t112 * t155 * exx[0] * t64;
  t699 = my_piecewise3(t3, 0, -t7 * t73 * t376 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t694);
  tv3rhosigmatau0 = 0.2e1 * rho[0] * t699 + 0.2e1 * t380;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim->v3rhosigmatau + 0] += tv3rhosigmatau0;

  t702 = t169 * t187;
  t705 = my_piecewise3(t3, 0, -t702 * t172 / 0.16e2);
  tv3rhosigmaexx0 = 0.2e1 * rho[0] * t705 + 0.2e1 * t385;

  if(out->v3rhosigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmaexx[ip*p->dim->v3rhosigmaexx + 0] += tv3rhosigmaexx0;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim->v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim->v3rholapltau + 0] += tv3rholapltau0;

  tv3rholaplexx0 = 0.e0;

  if(out->v3rholaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholaplexx[ip*p->dim->v3rholaplexx + 0] += tv3rholaplexx0;

  t713 = t388 * t109;
  t719 = t78 * t389 / 0.4e1 - t22 * t713 / 0.4e1 + 0.7e1 / 0.54e2 * t113 * t392 * t64;
  t724 = my_piecewise3(t3, 0, -t7 * t73 * t396 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t719);
  tv3rhotau20 = 0.2e1 * rho[0] * t724 + 0.2e1 * t400;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim->v3rhotau2 + 0] += tv3rhotau20;

  t729 = my_piecewise3(t3, 0, t322 * t403 / 0.16e2);
  tv3rhotauexx0 = 0.2e1 * rho[0] * t729 + 0.2e1 * t406;

  if(out->v3rhotauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotauexx[ip*p->dim->v3rhotauexx + 0] += tv3rhotauexx0;

  tv3rhoexx20 = 0.e0;

  if(out->v3rhoexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhoexx2[ip*p->dim->v3rhoexx2 + 0] += tv3rhoexx20;

  t738 = t332 * t137;
  t739 = t445 * t738;
  t743 = t268 * t353;
  t749 = 0.1e1 / t41 / t218 * t34;
  t753 = 0.1e1 / t218 * t35;
  t756 = t342 * t34;
  t763 = 0.945e-2 * t749 * t47 - 0.945e-2 * t753 * t344 - 0.63e-2 * t756 * t349 * t224 + 0.378e-1 / t462 * t474;
  t764 = t93 * t763;
  t768 = 0.55999999999999999998e-2 * t33 * t334 - 0.27999999999999999999e-2 * t33 * t355 - 0.55999999999999999998e-2 * t90 * t91 * t739 + 0.55999999999999999998e-2 * t90 * t91 * t743 - 0.93333333333333333332e-3 * t90 * t91 * t764;
  t770 = -0.3e1 / 0.8e1 * t125 * t358 + t26 * t768;
  t774 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t770);
  tv3sigma30 = 0.2e1 * rho[0] * t774;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim->v3sigma2lapl + 0] += tv3sigma2lapl0;

  t778 = t155 * t358;
  t781 = t366 * t142 / 0.4e1 + t22 * t778 / 0.8e1;
  t785 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t781);
  tv3sigma2tau0 = 0.2e1 * rho[0] * t785;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim->v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2exx0 = 0.e0;

  if(out->v3sigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2exx[ip*p->dim->v3sigma2exx + 0] += tv3sigma2exx0;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim->v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim->v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalaplexx0 = 0.e0;

  if(out->v3sigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalaplexx[ip*p->dim->v3sigmalaplexx + 0] += tv3sigmalaplexx0;

  t787 = t21 * t388;
  t790 = t388 * t142;
  t797 = -t787 * t56 / 0.4e1 - t22 * t790 / 0.4e1 - t59 * t388 * exx[0] * t64 / 0.18e2;
  t801 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t797);
  tv3sigmatau20 = 0.2e1 * rho[0] * t801;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim->v3sigmatau2 + 0] += tv3sigmatau20;

  t805 = my_piecewise3(t3, 0, -t382 * t403 / 0.32e2);
  tv3sigmatauexx0 = 0.2e1 * rho[0] * t805;

  if(out->v3sigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatauexx[ip*p->dim->v3sigmatauexx + 0] += tv3sigmatauexx0;

  tv3sigmaexx20 = 0.e0;

  if(out->v3sigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmaexx2[ip*p->dim->v3sigmaexx2 + 0] += tv3sigmaexx20;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim->v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim->v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2exx0 = 0.e0;

  if(out->v3lapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2exx[ip*p->dim->v3lapl2exx + 0] += tv3lapl2exx0;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim->v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltauexx0 = 0.e0;

  if(out->v3lapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltauexx[ip*p->dim->v3lapltauexx + 0] += tv3lapltauexx0;

  tv3laplexx20 = 0.e0;

  if(out->v3laplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3laplexx2[ip*p->dim->v3laplexx2 + 0] += tv3laplexx20;

  t807 = t154 * t154;
  t808 = 0.1e1 / t807;
  t820 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.4e1 * t22 * t808 * t56 + t60 * t808 * exx[0] * t64 / 0.6e1));
  tv3tau30 = 0.2e1 * rho[0] * t820;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim->v3tau3 + 0] += tv3tau30;

  t823 = t388 * t30 * t63;
  t826 = my_piecewise3(t3, 0, t170 * t823 / 0.16e2);
  tv3tau2exx0 = 0.2e1 * rho[0] * t826;

  if(out->v3tau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau2exx[ip*p->dim->v3tau2exx + 0] += tv3tau2exx0;

  tv3tauexx20 = 0.e0;

  if(out->v3tauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tauexx2[ip*p->dim->v3tauexx2 + 0] += tv3tauexx20;

  tv3exx30 = 0.e0;

  if(out->v3exx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3exx3[ip*p->dim->v3exx3 + 0] += tv3exx30;

  t843 = sigma[0] / t347;
  t854 = 0.1e1 / t38 / t277;
  t859 = t35 * t429;
  t879 = 0.1e1 / t444 / t50;
  t880 = t207 * t207;
  t890 = t228 * t228;
  t910 = t462 * t194;
  t915 = t218 * t218;
  t922 = 0.1e1 / t99 / t472 / t98;
  t931 = 0.24133004115226337449e0 * t33 * t36 * t854 * t51 + 0.17035061728395061728e0 * t90 * t859 * t105 + 0.10951111111111111111e0 * t90 * t434 * t208 - 0.54755555555555555556e-1 * t90 * t434 * t229 + 0.59733333333333333332e-1 * t90 * t201 * t447 - 0.59733333333333333332e-1 * t90 * t201 * t452 + 0.99555555555555555556e-2 * t90 * t201 * t478 + 0.22399999999999999999e-1 * t90 * t91 * t879 * t880 - 0.33599999999999999998e-1 * t90 * t91 * t445 * t207 * t228 + 0.55999999999999999998e-2 * t90 * t91 * t206 * t890 + 0.74666666666666666664e-2 * t90 * t91 * t451 * t477 - 0.93333333333333333332e-3 * t90 * t91 * t93 * (0.11324444444444444444e1 * t42 * t349 * t46 + 0.53834666666666666666e1 * t36 * t854 * t100 - 0.11578311111111111111e2 * t219 / t19 / t657 * t224 + 0.16725333333333333334e2 * t468 / t910 * t474 - 0.47786666666666666667e1 * t915 / t38 / t462 / t277 * t922 * t35);
  t942 = my_piecewise3(t3, 0, 0.1e2 / 0.27e2 * t7 * t18 * t84 * t67 - 0.5e1 / 0.9e1 * t7 * t409 * t117 + t7 * t180 * t241 / 0.2e1 - t7 * t73 * t488 / 0.2e1 - 0.3e1 / 0.8e1 * t7 * t20 * (-0.3e1 * t843 * t79 + 0.3e1 * t420 * t191 - 0.3e1 / 0.2e1 * t188 * t425 + t78 * t23 * t482 / 0.2e1 + t26 * t931 - 0.364e4 / 0.729e3 * sigma[0] * t279 * t61 * t64));
  tv4rho40 = 0.2e1 * rho[0] * t942 + 0.8e1 * t493;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t1044 = t31 * t89 * t35;
  t1045 = t40 * t445;
  t1062 = -0.14933333333333333333e-1 * t90 * t201 * t543 - 0.168e-1 * t90 * t91 * t445 * t284 * t207 + 0.55999999999999999998e-2 * t90 * t91 * t206 * t559 * t104 + 0.55999999999999999998e-2 * t90 * t91 * t538 * t228 + 0.22399999999999999999e-1 * t90 * t91 * t879 * t137 * t446 - 0.168e-1 * t1044 * t1045 * t625 * t228 + 0.44799999999999999999e-1 * t90 * t201 * t534 - 0.42587654320987654321e-1 * t33 * t859 * t51 - 0.27377777777777777778e-1 * t33 * t435 + 0.74666666666666666667e-2 * t33 * t441 - 0.93333333333333333332e-3 * t33 * t479;
  t1074 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t409 * t148 + t7 * t180 * t295 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t73 * t570 - 0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.4e1 * t419 * t23 * t56 - 0.3e1 / 0.4e1 * t503 * t109 + 0.3e1 / 0.8e1 * t252 * t233 - t125 * t482 / 0.8e1 + 0.3e1 / 0.4e1 * t420 * t257 - 0.3e1 / 0.4e1 * t188 * t512 + 0.3e1 / 0.8e1 * t78 * t23 * t564 + t26 * (-0.93333333333333333332e-3 * t90 * t91 * t93 * (-0.13066666666666666667e0 * t132 * t456 - 0.10192e1 * t859 * t100 + 0.30986666666666666666e1 * t34 * t464 * t281 - 0.54656e1 * t470 * t474 * t218 + 0.1792e1 / t38 / t462 / t347 * t922 * t468 * t35) - 0.55999999999999999998e-2 * t33 * t448 + 0.55999999999999999998e-2 * t623 * t624 * t104 * t228 - 0.27377777777777777778e-1 * t90 * t434 * t285 + 0.74666666666666666667e-2 * t90 * t201 * t560 - 0.14933333333333333333e-1 * t33 * t438 + 0.18666666666666666666e-2 * t90 * t91 * t268 * t477 + 0.42587654320987654321e-1 * t90 * t859 * t138 + 0.54755555555555555555e-1 * t90 * t434 * t269 - 0.29866666666666666666e-1 * t90 * t201 * t539 + t1062) + 0.455e3 / 0.486e3 * t349 * t23 * exx[0] * t64));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1074 + 0.6e1 * t575;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3lapl0 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim->v4rho3lapl + 0] += tv4rho3lapl0;

  t1104 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t409 * t163 + t7 * t180 * t314 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t73 * t595 - 0.3e1 / 0.8e1 * t7 * t20 * (-0.3e1 / 0.4e1 * t420 * t156 + 0.3e1 / 0.4e1 * t188 * t308 - 0.3e1 / 0.8e1 * t78 * t589 + t22 * t155 * t482 / 0.8e1 - 0.455e3 / 0.486e3 * t484 * t159 * t64));
  tv4rho3tau0 = 0.2e1 * rho[0] * t1104 + 0.6e1 * t600;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim->v4rho3tau + 0] += tv4rho3tau0;

  t1111 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t169 * t843 * t172);
  tv4rho3exx0 = 0.2e1 * rho[0] * t1111 + 0.6e1 * t607;

  if(out->v4rho3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3exx[ip*p->dim->v4rho3exx + 0] += tv4rho3exx0;

  t1180 = t284 * t284;
  t1189 = -0.55999999999999999998e-2 * t90 * t91 * t445 * t353 * t207 + 0.49777777777777777778e-2 * t90 * t201 * t663 - 0.93333333333333333332e-3 * t90 * t91 * t93 * (-0.196e-1 * t339 * t212 + 0.196e-1 * t343 * t215 - 0.5544e0 * t551 * t224 + 0.15792e1 * t556 * sigma[0] - 0.672e0 / t38 / t910 * t922 * t218 * t35) - 0.18251851851851851851e-1 * t33 * t524 - 0.1991111111111111111e-1 * t623 * t84 * t206 * t625 + 0.74666666666666666664e-2 * t623 * t624 * t284 * t104 + 0.37333333333333333332e-2 * t623 * t624 * t137 * t228 - 0.1991111111111111111e-1 * t90 * t201 * t639 - 0.55999999999999999998e-2 * t90 * t91 * t634 * t228 + 0.37333333333333333332e-2 * t90 * t91 * t206 * t1180 + 0.37333333333333333332e-2 * t90 * t91 * t268 * t559;
  t1228 = -0.9125925925925925926e-2 * t90 * t434 * t354 - 0.99555555555555555554e-2 * t90 * t201 * t647 + 0.37333333333333333332e-2 * t90 * t91 * t206 * t662 * t104 + 0.18666666666666666666e-2 * t90 * t91 * t646 * t228 - 0.112e-1 * t623 * t1045 * t137 * t207 + 0.18251851851851851851e-1 * t90 * t434 * t333 + 0.29866666666666666666e-1 * t90 * t201 * t635 - 0.18666666666666666666e-2 * t33 * t561 + 0.99555555555555555552e-2 * t33 * t530 + 0.22399999999999999999e-1 * t90 * t91 * t879 * t332 * t207 - 0.224e-1 * t1044 * t1045 * t625 * t284;
  t1236 = my_piecewise3(t3, 0, t7 * t180 * t360 / 0.12e2 - t7 * t73 * t669 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (-t503 * t142 / 0.2e1 + t252 * t289 / 0.2e1 - t125 * t564 / 0.4e1 - t188 * t617 / 0.4e1 + t78 * t23 * t667 / 0.4e1 + t26 * (t1189 + t1228)));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1236 + 0.4e1 * t674;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigmalapl0 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim->v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  t1269 = my_piecewise3(t3, 0, t7 * t180 * t376 / 0.12e2 - t7 * t73 * t694 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t187 * t155 * t56 / 0.4e1 - t680 * t109 / 0.4e1 + t366 * t233 / 0.8e1 + t188 * t369 / 0.4e1 - t78 * t687 / 0.4e1 + t22 * t155 * t564 / 0.8e1 + 0.35e2 / 0.162e3 * t236 * t155 * exx[0] * t64));
  tv4rho2sigmatau0 = 0.2e1 * rho[0] * t1269 + 0.4e1 * t699;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim->v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  t1276 = my_piecewise3(t3, 0, 0.3e1 / 0.16e2 * t169 * t419 * t172);
  tv4rho2sigmaexx0 = 0.2e1 * rho[0] * t1276 + 0.4e1 * t705;

  if(out->v4rho2sigmaexx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmaexx[ip*p->dim->v4rho2sigmaexx + 0] += tv4rho2sigmaexx0;

  tv4rho2lapl20 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim->v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim->v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2laplexx0 = 0.e0;

  if(out->v4rho2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2laplexx[ip*p->dim->v4rho2laplexx + 0] += tv4rho2laplexx0;

  t1301 = my_piecewise3(t3, 0, t7 * t180 * t396 / 0.12e2 - t7 * t73 * t719 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (-t188 * t389 / 0.2e1 + t78 * t713 / 0.2e1 - t22 * t388 * t233 / 0.4e1 - 0.35e2 / 0.81e2 * t237 * t392 * t64));
  tv4rho2tau20 = 0.2e1 * rho[0] * t1301 + 0.4e1 * t724;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim->v4rho2tau2 + 0] += tv4rho2tau20;

  t1307 = my_piecewise3(t3, 0, -0.3e1 / 0.16e2 * t604 * t403);
  tv4rho2tauexx0 = 0.2e1 * rho[0] * t1307 + 0.4e1 * t729;

  if(out->v4rho2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tauexx[ip*p->dim->v4rho2tauexx + 0] += tv4rho2tauexx0;

  tv4rho2exx20 = 0.e0;

  if(out->v4rho2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2exx2[ip*p->dim->v4rho2exx2 + 0] += tv4rho2exx20;

  t1392 = -0.14933333333333333333e-1 * t33 * t631 - 0.16799999999999999999e-1 * t623 * t1045 * t332 * t104 + 0.112e-1 * t623 * t624 * t137 * t284 + 0.74666666666666666664e-2 * t33 * t643 + 0.55999999999999999998e-2 * t623 * t624 * t353 * t104 - 0.27999999999999999999e-2 * t33 * t664 + 0.14933333333333333333e-1 * t90 * t201 * t739 + 0.22399999999999999999e-1 * t90 * t91 * t879 * t738 * t104 - 0.16799999999999999999e-1 * t90 * t91 * t634 * t284 - 0.14933333333333333333e-1 * t90 * t201 * t743 - 0.16799999999999999999e-1 * t1044 * t1045 * t137 * t353 * t104 + 0.55999999999999999998e-2 * t90 * t91 * t538 * t353 + 0.55999999999999999998e-2 * t90 * t91 * t268 * t662 + 0.24888888888888888889e-2 * t90 * t201 * t764 + 0.18666666666666666666e-2 * t90 * t91 * t206 * t763 * t104 - 0.93333333333333333332e-3 * t90 * t91 * t93 * (-0.126e-1 * t749 * t94 + 0.126e-1 * t753 * t101 + 0.84e-2 * t756 * t279 * t224 - 0.3528e0 * t659 + 0.252e0 / t38 / t469 * t922 * t36);
  t1399 = my_piecewise3(t3, 0, -t7 * t73 * t770 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.8e1 * t252 * t358 - 0.3e1 / 0.8e1 * t125 * t667 + t78 * t23 * t768 / 0.8e1 + t26 * t1392));
  tv4rhosigma30 = 0.2e1 * rho[0] * t1399 + 0.2e1 * t774;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma2lapl0 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim->v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  t1419 = my_piecewise3(t3, 0, -t7 * t73 * t781 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (-t680 * t142 / 0.4e1 + t366 * t289 / 0.4e1 - t78 * t778 / 0.8e1 + t22 * t155 * t667 / 0.8e1));
  tv4rhosigma2tau0 = 0.2e1 * rho[0] * t1419 + 0.2e1 * t785;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim->v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigma2exx0 = 0.e0;

  if(out->v4rhosigma2exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2exx[ip*p->dim->v4rhosigma2exx + 0] += tv4rhosigma2exx0;

  tv4rhosigmalapl20 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim->v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim->v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmalaplexx0 = 0.e0;

  if(out->v4rhosigmalaplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalaplexx[ip*p->dim->v4rhosigmalaplexx + 0] += tv4rhosigmalaplexx0;

  t1444 = my_piecewise3(t3, 0, -t7 * t73 * t797 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t77 * t388 * t56 / 0.4e1 - t787 * t109 / 0.4e1 + t78 * t790 / 0.4e1 - t22 * t388 * t289 / 0.4e1 + 0.7e1 / 0.54e2 * t112 * t388 * exx[0] * t64));
  tv4rhosigmatau20 = 0.2e1 * rho[0] * t1444 + 0.2e1 * t801;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim->v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  t1449 = my_piecewise3(t3, 0, t702 * t403 / 0.16e2);
  tv4rhosigmatauexx0 = 0.2e1 * rho[0] * t1449 + 0.2e1 * t805;

  if(out->v4rhosigmatauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatauexx[ip*p->dim->v4rhosigmatauexx + 0] += tv4rhosigmatauexx0;

  tv4rhosigmaexx20 = 0.e0;

  if(out->v4rhosigmaexx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmaexx2[ip*p->dim->v4rhosigmaexx2 + 0] += tv4rhosigmaexx20;

  tv4rholapl30 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim->v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim->v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapl2exx0 = 0.e0;

  if(out->v4rholapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2exx[ip*p->dim->v4rholapl2exx + 0] += tv4rholapl2exx0;

  tv4rholapltau20 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim->v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rholapltauexx0 = 0.e0;

  if(out->v4rholapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltauexx[ip*p->dim->v4rholapltauexx + 0] += tv4rholapltauexx0;

  tv4rholaplexx2v4rhotau30 = diff(dmfd00000103020(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rholaplexx2v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholaplexx2v4rhotau3[ip*p->dim->v4rholaplexx2v4rhotau3 + 0] += tv4rholaplexx2v4rhotau30;

  t1454 = my_piecewise3(t3, 0, -t322 * t823 / 0.8e1);
  tv4rhotau2exx0 = 0.2e1 * rho[0] * t1454 + 0.2e1 * t826;

  if(out->v4rhotau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau2exx[ip*p->dim->v4rhotau2exx + 0] += tv4rhotau2exx0;

  tv4rhotauexx20 = 0.e0;

  if(out->v4rhotauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotauexx2[ip*p->dim->v4rhotauexx2 + 0] += tv4rhotauexx20;

  tv4rhoexx3v4sigma40 = diff(dmfd00400000030(rho[0], rho[1], sigma[0], sigma[1], sigma[2], lapl[0], lapl[1], tau[0], tau[1], exx[0], exx[1]), rho[0]);

  if(out->v4rhoexx3v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhoexx3v4sigma4[ip*p->dim->v4rhoexx3v4sigma4 + 0] += tv4rhoexx3v4sigma40;

  tv4sigma3lapl0 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim->v4sigma3lapl + 0] += tv4sigma3lapl0;

  t1466 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.8e1 * t366 * t358 + t22 * t155 * t768 / 0.8e1));
  tv4sigma3tau0 = 0.2e1 * rho[0] * t1466;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim->v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma3exx0 = 0.e0;

  if(out->v4sigma3exx != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3exx[ip*p->dim->v4sigma3exx + 0] += tv4sigma3exx0;

  tv4sigma2lapl20 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim->v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim->v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2laplexx0 = 0.e0;

  if(out->v4sigma2laplexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2laplexx[ip*p->dim->v4sigma2laplexx + 0] += tv4sigma2laplexx0;

  t1477 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (-t787 * t142 / 0.2e1 - t22 * t388 * t358 / 0.4e1));
  tv4sigma2tau20 = 0.2e1 * rho[0] * t1477;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim->v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigma2tauexx0 = 0.e0;

  if(out->v4sigma2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tauexx[ip*p->dim->v4sigma2tauexx + 0] += tv4sigma2tauexx0;

  tv4sigma2exx20 = 0.e0;

  if(out->v4sigma2exx2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2exx2[ip*p->dim->v4sigma2exx2 + 0] += tv4sigma2exx20;

  tv4sigmalapl30 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim->v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim->v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapl2exx0 = 0.e0;

  if(out->v4sigmalapl2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2exx[ip*p->dim->v4sigmalapl2exx + 0] += tv4sigmalapl2exx0;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim->v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmalapltauexx0 = 0.e0;

  if(out->v4sigmalapltauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltauexx[ip*p->dim->v4sigmalapltauexx + 0] += tv4sigmalapltauexx0;

  tv4sigmalaplexx20 = 0.e0;

  if(out->v4sigmalaplexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalaplexx2[ip*p->dim->v4sigmalaplexx2 + 0] += tv4sigmalaplexx20;

  t1493 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (0.3e1 / 0.4e1 * t21 * t808 * t56 + 0.3e1 / 0.4e1 * t22 * t808 * t142 + t59 * t808 * exx[0] * t64 / 0.6e1));
  tv4sigmatau30 = 0.2e1 * rho[0] * t1493;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim->v4sigmatau3 + 0] += tv4sigmatau30;

  t1497 = my_piecewise3(t3, 0, t382 * t823 / 0.16e2);
  tv4sigmatau2exx0 = 0.2e1 * rho[0] * t1497;

  if(out->v4sigmatau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau2exx[ip*p->dim->v4sigmatau2exx + 0] += tv4sigmatau2exx0;

  tv4sigmatauexx20 = 0.e0;

  if(out->v4sigmatauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatauexx2[ip*p->dim->v4sigmatauexx2 + 0] += tv4sigmatauexx20;

  tv4sigmaexx30 = 0.e0;

  if(out->v4sigmaexx3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmaexx3[ip*p->dim->v4sigmaexx3 + 0] += tv4sigmaexx30;

  tv4lapl40 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim->v4lapl4 + 0] += tv4lapl40;

  tv4lapl3tau0 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim->v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl3exx0 = 0.e0;

  if(out->v4lapl3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3exx[ip*p->dim->v4lapl3exx + 0] += tv4lapl3exx0;

  tv4lapl2tau20 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim->v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapl2tauexx0 = 0.e0;

  if(out->v4lapl2tauexx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tauexx[ip*p->dim->v4lapl2tauexx + 0] += tv4lapl2tauexx0;

  tv4lapl2exx20 = 0.e0;

  if(out->v4lapl2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2exx2[ip*p->dim->v4lapl2exx2 + 0] += tv4lapl2exx20;

  tv4lapltau30 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim->v4lapltau3 + 0] += tv4lapltau30;

  tv4lapltau2exx0 = 0.e0;

  if(out->v4lapltau2exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau2exx[ip*p->dim->v4lapltau2exx + 0] += tv4lapltau2exx0;

  tv4lapltauexx20 = 0.e0;

  if(out->v4lapltauexx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltauexx2[ip*p->dim->v4lapltauexx2 + 0] += tv4lapltauexx20;

  tv4laplexx30 = 0.e0;

  if(out->v4laplexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4laplexx3[ip*p->dim->v4laplexx3 + 0] += tv4laplexx30;

  t1500 = 0.1e1 / t807 / tau[0];
  t1512 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (-0.3e1 * t22 * t1500 * t56 - 0.2e1 / 0.3e1 * t60 * t1500 * exx[0] * t64));
  tv4tau40 = 0.2e1 * rho[0] * t1512;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim->v4tau4 + 0] += tv4tau40;

  t1518 = my_piecewise3(t3, 0, -0.3e1 / 0.16e2 * t170 * t808 * t30 * t63);
  tv4tau3exx0 = 0.2e1 * rho[0] * t1518;

  if(out->v4tau3exx != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau3exx[ip*p->dim->v4tau3exx + 0] += tv4tau3exx0;

  tv4tau2exx20 = 0.e0;

  if(out->v4tau2exx2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau2exx2[ip*p->dim->v4tau2exx2 + 0] += tv4tau2exx20;

  tv4tauexx30 = 0.e0;

  if(out->v4tauexx3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tauexx3[ip*p->dim->v4tauexx3 + 0] += tv4tauexx30;

  tv4exx40 = 0.e0;

  if(out->v4exx4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4exx4[ip*p->dim->v4exx4 + 0] += tv4exx40;

}

#endif

