/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_c09x.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.100625e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.100625e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t51 = t17 / t30;
  t55 = t29 * rho[0];
  t57 = 0.1e1 / t30 / t55;
  t58 = t28 * t57;
  t59 = t58 * t38;
  t62 = t20 * t20;
  t64 = 0.1e1 / t22 / t21;
  t65 = t62 * t64;
  t66 = sigma[0] * sigma[0];
  t67 = t65 * t66;
  t68 = t29 * t29;
  t69 = t68 * t29;
  t71 = 0.1e1 / t18 / t69;
  t72 = t27 * t71;
  t73 = t72 * t38;
  t76 = t58 * t43;
  t79 = -0.68555555555555555555e-2 * t26 * t59 + 0.2759361111111111111e-4 * t67 * t73 - 0.334075e-2 * t26 * t76;
  t84 = my_piecewise3(t2, 0, -t6 * t51 * t45 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t79);
  tvrho0 = 0.2e1 * rho[0] * t84 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = t68 * rho[0];
  t93 = t27 / t18 / t90;
  t94 = t93 * t38;
  t100 = 0.25708333333333333333e-2 * t25 * t39 - 0.10347604166666666667e-4 * t65 * sigma[0] * t94 + 0.125278125e-2 * t25 * t33 * t43;
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t100);
  tvsigma0 = 0.2e1 * rho[0] * t104;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, tv2rho20;
  double t155, t156, t160, t161, t170, t175, tv2rhosigma0, t180;
  double t187, t191, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.100625e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t51 = t17 / t30;
  t55 = t29 * rho[0];
  t57 = 0.1e1 / t30 / t55;
  t58 = t28 * t57;
  t59 = t58 * t38;
  t62 = t20 * t20;
  t64 = 0.1e1 / t22 / t21;
  t65 = t62 * t64;
  t66 = sigma[0] * sigma[0];
  t67 = t65 * t66;
  t68 = t29 * t29;
  t69 = t68 * t29;
  t71 = 0.1e1 / t18 / t69;
  t72 = t27 * t71;
  t73 = t72 * t38;
  t76 = t58 * t43;
  t79 = -0.68555555555555555555e-2 * t26 * t59 + 0.2759361111111111111e-4 * t67 * t73 - 0.334075e-2 * t26 * t76;
  t84 = my_piecewise3(t2, 0, -t6 * t51 * t45 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t79);
  tvrho0 = 0.2e1 * rho[0] * t84 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = t68 * rho[0];
  t93 = t27 / t18 / t90;
  t94 = t93 * t38;
  t100 = 0.25708333333333333333e-2 * t25 * t39 - 0.10347604166666666667e-4 * t65 * sigma[0] * t94 + 0.125278125e-2 * t25 * t33 * t43;
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t100);
  tvsigma0 = 0.2e1 * rho[0] * t104;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t109 = t17 / t30 / rho[0];
  t118 = t28 / t30 / t68;
  t119 = t118 * t38;
  t122 = t68 * t55;
  t124 = 0.1e1 / t18 / t122;
  t125 = t27 * t124;
  t126 = t125 * t38;
  t129 = t66 * sigma[0];
  t130 = t68 * t68;
  t131 = t130 * t29;
  t132 = 0.1e1 / t131;
  t136 = t118 * t43;
  t139 = t125 * t43;
  t142 = 0.25137037037037037037e-1 * t26 * t119 - 0.24834249999999999999e-3 * t67 * t126 + 0.18242943617400669616e-7 * t129 * t132 * t38 + 0.12249416666666666667e-1 * t26 * t136 - 0.17928691666666666666e-4 * t67 * t139;
  t147 = my_piecewise3(t2, 0, t6 * t109 * t45 / 0.12e2 - t6 * t51 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t142);
  tv2rho20 = 0.2e1 * rho[0] * t147 + 0.4e1 * t84;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t155 = t65 * t27;
  t156 = t71 * sigma[0];
  t160 = t130 * rho[0];
  t161 = 0.1e1 / t160;
  t170 = -0.68555555555555555555e-2 * t25 * t59 + 0.82780833333333333334e-4 * t155 * t156 * t38 - 0.68411038565252511063e-8 * t66 * t161 * t38 - 0.334075e-2 * t25 * t76 + 0.67232593749999999999e-5 * t155 * t156 * t43;
  t175 = my_piecewise3(t2, 0, -t6 * t51 * t100 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t104;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = 0.1e1 / t130;
  t187 = -0.20695208333333333334e-4 * t65 * t94 + 0.25654139461969691649e-8 * sigma[0] * t180 * t38 - 0.2521222265625e-5 * t65 * t93 * t43;
  t191 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t187);
  tv2sigma20 = 0.2e1 * rho[0] * t191;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, tv2rho20;
  double t155, t156, t160, t161, t170, t175, tv2rhosigma0, t180;
  double t187, t191, tv2sigma20;

  double t194, t206, t207, t211, t212, t216, t217, t218;
  double t221, t222, t224, t227, t228, t231, t239, t244;
  double tv3rho30, t256, t260, t263, t265, t277, t282, tv3rho2sigma0;
  double t290, t294, t304, t309, tv3rhosigma20, t315, t322, t326;
  double tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.100625e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t51 = t17 / t30;
  t55 = t29 * rho[0];
  t57 = 0.1e1 / t30 / t55;
  t58 = t28 * t57;
  t59 = t58 * t38;
  t62 = t20 * t20;
  t64 = 0.1e1 / t22 / t21;
  t65 = t62 * t64;
  t66 = sigma[0] * sigma[0];
  t67 = t65 * t66;
  t68 = t29 * t29;
  t69 = t68 * t29;
  t71 = 0.1e1 / t18 / t69;
  t72 = t27 * t71;
  t73 = t72 * t38;
  t76 = t58 * t43;
  t79 = -0.68555555555555555555e-2 * t26 * t59 + 0.2759361111111111111e-4 * t67 * t73 - 0.334075e-2 * t26 * t76;
  t84 = my_piecewise3(t2, 0, -t6 * t51 * t45 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t79);
  tvrho0 = 0.2e1 * rho[0] * t84 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = t68 * rho[0];
  t93 = t27 / t18 / t90;
  t94 = t93 * t38;
  t100 = 0.25708333333333333333e-2 * t25 * t39 - 0.10347604166666666667e-4 * t65 * sigma[0] * t94 + 0.125278125e-2 * t25 * t33 * t43;
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t100);
  tvsigma0 = 0.2e1 * rho[0] * t104;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t109 = t17 / t30 / rho[0];
  t118 = t28 / t30 / t68;
  t119 = t118 * t38;
  t122 = t68 * t55;
  t124 = 0.1e1 / t18 / t122;
  t125 = t27 * t124;
  t126 = t125 * t38;
  t129 = t66 * sigma[0];
  t130 = t68 * t68;
  t131 = t130 * t29;
  t132 = 0.1e1 / t131;
  t136 = t118 * t43;
  t139 = t125 * t43;
  t142 = 0.25137037037037037037e-1 * t26 * t119 - 0.24834249999999999999e-3 * t67 * t126 + 0.18242943617400669616e-7 * t129 * t132 * t38 + 0.12249416666666666667e-1 * t26 * t136 - 0.17928691666666666666e-4 * t67 * t139;
  t147 = my_piecewise3(t2, 0, t6 * t109 * t45 / 0.12e2 - t6 * t51 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t142);
  tv2rho20 = 0.2e1 * rho[0] * t147 + 0.4e1 * t84;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t155 = t65 * t27;
  t156 = t71 * sigma[0];
  t160 = t130 * rho[0];
  t161 = 0.1e1 / t160;
  t170 = -0.68555555555555555555e-2 * t25 * t59 + 0.82780833333333333334e-4 * t155 * t156 * t38 - 0.68411038565252511063e-8 * t66 * t161 * t38 - 0.334075e-2 * t25 * t76 + 0.67232593749999999999e-5 * t155 * t156 * t43;
  t175 = my_piecewise3(t2, 0, -t6 * t51 * t100 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t104;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = 0.1e1 / t130;
  t187 = -0.20695208333333333334e-4 * t65 * t94 + 0.25654139461969691649e-8 * sigma[0] * t180 * t38 - 0.2521222265625e-5 * t65 * t93 * t43;
  t191 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t187);
  tv2sigma20 = 0.2e1 * rho[0] * t191;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t194 = t17 * t32;
  t206 = t28 / t30 / t90;
  t207 = t206 * t38;
  t211 = 0.1e1 / t18 / t130;
  t212 = t27 * t211;
  t216 = t130 * t55;
  t217 = 0.1e1 / t216;
  t218 = t129 * t217;
  t221 = t66 * t66;
  t222 = t130 * t90;
  t224 = 0.1e1 / t30 / t222;
  t227 = t24 * t28;
  t228 = t227 * t38;
  t231 = t206 * t43;
  t239 = -0.11730617283950617284e0 * t26 * t207 + 0.20909825308641975308e-2 * t67 * t212 * t38 - 0.3466159287306127227e-6 * t218 * t38 + 0.97903797413383593606e-10 * t221 * t224 * t20 * t228 - 0.57163944444444444446e-1 * t26 * t231 + 0.19721560833333333333e-3 * t67 * t212 * t43 - 0.59265913020905627571e-8 * t218 * t43;
  t244 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t194 * t45 + t6 * t109 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t142 - 0.3e1 / 0.8e1 * t6 * t19 * t239);
  tv3rho30 = 0.2e1 * rho[0] * t244 + 0.6e1 * t147;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t256 = t124 * sigma[0];
  t260 = t132 * t66;
  t263 = t130 * t68;
  t265 = 0.1e1 / t30 / t263;
  t277 = 0.25137037037037037037e-1 * t25 * t119 - 0.59786157407407407408e-3 * t155 * t256 * t38 + 0.11629876556092926881e-6 * t260 * t38 - 0.36713924030018847604e-10 * t129 * t265 * t20 * t228 + 0.12249416666666666667e-1 * t25 * t136 - 0.60509334374999999999e-4 * t155 * t256 * t43 + 0.2222471738283961034e-8 * t260 * t43;
  t282 = my_piecewise3(t2, 0, t6 * t109 * t100 / 0.12e2 - t6 * t51 * t170 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t282 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t290 = t161 * sigma[0];
  t294 = 0.1e1 / t30 / t216;
  t304 = 0.11037444444444444445e-3 * t65 * t73 - 0.34205519282626255532e-7 * t290 * t38 + 0.13767721511257067852e-10 * t66 * t294 * t20 * t228 + 0.1344651875e-4 * t65 * t72 * t43 - 0.83342690185648538775e-9 * t290 * t43;
  t309 = my_piecewise3(t2, 0, -t6 * t51 * t187 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t304);
  tv3rhosigma20 = 0.2e1 * rho[0] * t309 + 0.2e1 * t191;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t315 = 0.1e1 / t30 / t131;
  t322 = 0.76962418385909074947e-8 * t180 * t38 - 0.51628955667214004444e-11 * sigma[0] * t315 * t20 * t228 + 0.31253508819618202039e-9 * t180 * t43;
  t326 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t322);
  tv3sigma30 = 0.2e1 * rho[0] * t326;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t36, t38, t39, t43, t45;
  double t49, tzk0;

  double t51, t55, t57, t58, t59, t62, t64, t65;
  double t66, t67, t68, t69, t71, t72, t73, t76;
  double t79, t84, tvrho0, t90, t93, t94, t100, t104;
  double tvsigma0;

  double t109, t118, t119, t122, t124, t125, t126, t129;
  double t130, t131, t132, t136, t139, t142, t147, tv2rho20;
  double t155, t156, t160, t161, t170, t175, tv2rhosigma0, t180;
  double t187, t191, tv2sigma20;

  double t194, t206, t207, t211, t212, t216, t217, t218;
  double t221, t222, t224, t227, t228, t231, t239, t244;
  double tv3rho30, t256, t260, t263, t265, t277, t282, tv3rho2sigma0;
  double t290, t294, t304, t309, tv3rhosigma20, t315, t322, t326;
  double tv3sigma30;

  double t344, t350, t355, t358, t362, t366, t373, t384;
  double t392, tv4rho40, t407, t411, t415, t438, tv4rho3sigma0, t450;
  double t454, t475, tv4rho2sigma20, t484, t504, tv4rhosigma30, t507, t522;
  double tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t36 = t25 * t34 * t32;
  t38 = exp(-0.20125e-2 * t36);
  t39 = t33 * t38;
  t43 = exp(-0.100625e-2 * t36);
  t45 = 0.2245e1 + 0.25708333333333333333e-2 * t26 * t39 - 0.1245e1 * t43;
  t49 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t51 = t17 / t30;
  t55 = t29 * rho[0];
  t57 = 0.1e1 / t30 / t55;
  t58 = t28 * t57;
  t59 = t58 * t38;
  t62 = t20 * t20;
  t64 = 0.1e1 / t22 / t21;
  t65 = t62 * t64;
  t66 = sigma[0] * sigma[0];
  t67 = t65 * t66;
  t68 = t29 * t29;
  t69 = t68 * t29;
  t71 = 0.1e1 / t18 / t69;
  t72 = t27 * t71;
  t73 = t72 * t38;
  t76 = t58 * t43;
  t79 = -0.68555555555555555555e-2 * t26 * t59 + 0.2759361111111111111e-4 * t67 * t73 - 0.334075e-2 * t26 * t76;
  t84 = my_piecewise3(t2, 0, -t6 * t51 * t45 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t79);
  tvrho0 = 0.2e1 * rho[0] * t84 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t90 = t68 * rho[0];
  t93 = t27 / t18 / t90;
  t94 = t93 * t38;
  t100 = 0.25708333333333333333e-2 * t25 * t39 - 0.10347604166666666667e-4 * t65 * sigma[0] * t94 + 0.125278125e-2 * t25 * t33 * t43;
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t100);
  tvsigma0 = 0.2e1 * rho[0] * t104;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t109 = t17 / t30 / rho[0];
  t118 = t28 / t30 / t68;
  t119 = t118 * t38;
  t122 = t68 * t55;
  t124 = 0.1e1 / t18 / t122;
  t125 = t27 * t124;
  t126 = t125 * t38;
  t129 = t66 * sigma[0];
  t130 = t68 * t68;
  t131 = t130 * t29;
  t132 = 0.1e1 / t131;
  t136 = t118 * t43;
  t139 = t125 * t43;
  t142 = 0.25137037037037037037e-1 * t26 * t119 - 0.24834249999999999999e-3 * t67 * t126 + 0.18242943617400669616e-7 * t129 * t132 * t38 + 0.12249416666666666667e-1 * t26 * t136 - 0.17928691666666666666e-4 * t67 * t139;
  t147 = my_piecewise3(t2, 0, t6 * t109 * t45 / 0.12e2 - t6 * t51 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t142);
  tv2rho20 = 0.2e1 * rho[0] * t147 + 0.4e1 * t84;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t155 = t65 * t27;
  t156 = t71 * sigma[0];
  t160 = t130 * rho[0];
  t161 = 0.1e1 / t160;
  t170 = -0.68555555555555555555e-2 * t25 * t59 + 0.82780833333333333334e-4 * t155 * t156 * t38 - 0.68411038565252511063e-8 * t66 * t161 * t38 - 0.334075e-2 * t25 * t76 + 0.67232593749999999999e-5 * t155 * t156 * t43;
  t175 = my_piecewise3(t2, 0, -t6 * t51 * t100 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t104;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = 0.1e1 / t130;
  t187 = -0.20695208333333333334e-4 * t65 * t94 + 0.25654139461969691649e-8 * sigma[0] * t180 * t38 - 0.2521222265625e-5 * t65 * t93 * t43;
  t191 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t187);
  tv2sigma20 = 0.2e1 * rho[0] * t191;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t194 = t17 * t32;
  t206 = t28 / t30 / t90;
  t207 = t206 * t38;
  t211 = 0.1e1 / t18 / t130;
  t212 = t27 * t211;
  t216 = t130 * t55;
  t217 = 0.1e1 / t216;
  t218 = t129 * t217;
  t221 = t66 * t66;
  t222 = t130 * t90;
  t224 = 0.1e1 / t30 / t222;
  t227 = t24 * t28;
  t228 = t227 * t38;
  t231 = t206 * t43;
  t239 = -0.11730617283950617284e0 * t26 * t207 + 0.20909825308641975308e-2 * t67 * t212 * t38 - 0.3466159287306127227e-6 * t218 * t38 + 0.97903797413383593606e-10 * t221 * t224 * t20 * t228 - 0.57163944444444444446e-1 * t26 * t231 + 0.19721560833333333333e-3 * t67 * t212 * t43 - 0.59265913020905627571e-8 * t218 * t43;
  t244 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t194 * t45 + t6 * t109 * t79 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t142 - 0.3e1 / 0.8e1 * t6 * t19 * t239);
  tv3rho30 = 0.2e1 * rho[0] * t244 + 0.6e1 * t147;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t256 = t124 * sigma[0];
  t260 = t132 * t66;
  t263 = t130 * t68;
  t265 = 0.1e1 / t30 / t263;
  t277 = 0.25137037037037037037e-1 * t25 * t119 - 0.59786157407407407408e-3 * t155 * t256 * t38 + 0.11629876556092926881e-6 * t260 * t38 - 0.36713924030018847604e-10 * t129 * t265 * t20 * t228 + 0.12249416666666666667e-1 * t25 * t136 - 0.60509334374999999999e-4 * t155 * t256 * t43 + 0.2222471738283961034e-8 * t260 * t43;
  t282 = my_piecewise3(t2, 0, t6 * t109 * t100 / 0.12e2 - t6 * t51 * t170 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t282 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t290 = t161 * sigma[0];
  t294 = 0.1e1 / t30 / t216;
  t304 = 0.11037444444444444445e-3 * t65 * t73 - 0.34205519282626255532e-7 * t290 * t38 + 0.13767721511257067852e-10 * t66 * t294 * t20 * t228 + 0.1344651875e-4 * t65 * t72 * t43 - 0.83342690185648538775e-9 * t290 * t43;
  t309 = my_piecewise3(t2, 0, -t6 * t51 * t187 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t304);
  tv3rhosigma20 = 0.2e1 * rho[0] * t309 + 0.2e1 * t191;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t315 = 0.1e1 / t30 / t131;
  t322 = 0.76962418385909074947e-8 * t180 * t38 - 0.51628955667214004444e-11 * sigma[0] * t315 * t20 * t228 + 0.31253508819618202039e-9 * t180 * t43;
  t326 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t322);
  tv3sigma30 = 0.2e1 * rho[0] * t326;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t344 = t28 / t30 / t69;
  t350 = t27 / t18 / t160;
  t355 = t129 / t263;
  t358 = t130 * t69;
  t362 = t221 / t30 / t358 * t20;
  t366 = t130 * t130;
  t373 = t64 * t27 * t38;
  t384 = t227 * t43;
  t392 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t57 * t45 - 0.5e1 / 0.9e1 * t6 * t194 * t79 + t6 * t109 * t142 / 0.2e1 - t6 * t51 * t239 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.66473497942386831276e0 * t26 * t344 * t38 - 0.18683940679012345679e-1 * t67 * t350 * t38 + 0.51951849434886573584e-5 * t355 * t38 - 0.31981907155038640578e-8 * t362 * t228 + 0.10508340922369839047e-11 * t221 * sigma[0] / t18 / t366 / rho[0] * t62 * t373 + 0.32392901851851851853e0 * t26 * t344 * t43 - 0.19502432379629629629e-2 * t67 * t350 * t43 + 0.13038500864599238066e-6 * t355 * t43 - 0.15903019993943010065e-10 * t362 * t384));
  tv4rho40 = 0.2e1 * rho[0] * t392 + 0.8e1 * t244;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t407 = t211 * sigma[0];
  t411 = t217 * t66;
  t415 = t224 * t129 * t20;
  t438 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t194 * t100 + t6 * t109 * t170 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t277 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.11730617283950617284e0 * t25 * t207 + 0.46541224074074074074e-2 * t155 * t407 * t38 - 0.15582514339863071965e-5 * t411 * t38 + 0.10891797462238924789e-8 * t415 * t228 - 0.39406278458886896427e-12 * t221 / t18 / t366 * t62 * t373 - 0.57163944444444444446e-1 * t25 * t231 + 0.5094736548611111111e-3 * t155 * t407 * t43 - 0.42226963027395259646e-7 * t411 * t43 + 0.59636324977286287745e-11 * t415 * t384));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t438 + 0.6e1 * t282;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t450 = t132 * sigma[0];
  t454 = t265 * t66 * t20;
  t475 = my_piecewise3(t2, 0, t6 * t109 * t187 / 0.12e2 - t6 * t51 * t304 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.69903814814814814818e-3 * t65 * t126 + 0.38082144801323897826e-6 * t450 * t38 - 0.34419303778142669629e-9 * t454 * t228 + 0.14777354422082586161e-12 * t129 / t18 / t130 / t122 * t62 * t373 - 0.85161285416666666667e-4 * t65 * t139 + 0.11945785593276290558e-7 * t450 * t43 - 0.22363621866482357904e-11 * t454 * t384));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t475 + 0.4e1 * t309;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t484 = t294 * t20 * t24;
  t504 = my_piecewise3(t2, 0, -t6 * t51 * t322 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.61569934708727259958e-7 * t161 * t38 + 0.96374050578799474962e-10 * t484 * t34 * t38 - 0.55415079082809698102e-13 * t66 / t18 / t358 * t62 * t373 - 0.25002807055694561631e-8 * t161 * t43 + 0.83863581999308842137e-12 * t484 * t34 * t43));
  tv4rhosigma30 = 0.2e1 * rho[0] * t504 + 0.2e1 * t326;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t507 = t315 * t20;
  t522 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-0.20651582266885601777e-10 * t507 * t228 + 0.20780654656053636789e-13 * sigma[0] / t18 / t222 * t62 * t373 - 0.31448843249740815802e-12 * t507 * t384));
  tv4sigma40 = 0.2e1 * rho[0] * t522;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125e-2 * t70);
  t77 = exp(-0.100625e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  tzk0 = t53 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83, tzk0;

  double t84, t85, t86, t88, t91, t92, t96, t97;
  double t98, t101, t102, t104, t105, t109, t112, t113;
  double t114, t115, t117, t125, t130, t131, t133, t136;
  double t137, t141, t144, t146, tvrho0, t150, t153, t154;
  double t159, t161, t164, t165, t169, t171, t172, t176;
  double t177, t178, t180, t188, t193, tvrho1, t199, t201;
  double t209, t213, tvsigma0, tvsigma1, t217, t219, t227, t231;
  double tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125e-2 * t70);
  t77 = exp(-0.100625e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  tzk0 = t53 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t88 = my_piecewise5(t10, 0, t14, 0, t7 - t86);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t49 / 0.8e1;
  t102 = t34 * rho[0];
  t104 = 0.1e1 / t36 / t102;
  t105 = sigma[0] * t104;
  t109 = t28 * t28;
  t112 = t109 / t30 / t29;
  t113 = sigma[0] * sigma[0];
  t114 = t34 * t34;
  t115 = t114 * t34;
  t117 = 0.1e1 / t35 / t115;
  t125 = -0.68555555555555555555e-2 * t33 * t105 * t42 + 0.13796805555555555555e-4 * t112 * t113 * t117 * t42 - 0.334075e-2 * t33 * t105 * t47;
  t130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t49 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t125);
  t131 = t55 * t85;
  t133 = my_piecewise5(t14, 0, t10, 0, -t7 - t131);
  t136 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t133);
  t137 = t136 * t26;
  t141 = t62 * t97;
  t144 = t5 * t141 * t79 / 0.8e1;
  t146 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t79 - t144);
  tvrho0 = t53 + t83 + t6 * (t130 + t146);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = my_piecewise5(t10, 0, t14, 0, -t7 - t86);
  t153 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t150);
  t154 = t153 * t26;
  t159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t49 - t101);
  t161 = my_piecewise5(t14, 0, t10, 0, t7 - t131);
  t164 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t161);
  t165 = t164 * t26;
  t169 = t64 * rho[1];
  t171 = 0.1e1 / t66 / t169;
  t172 = sigma[2] * t171;
  t176 = sigma[2] * sigma[2];
  t177 = t64 * t64;
  t178 = t177 * t64;
  t180 = 0.1e1 / t65 / t178;
  t188 = -0.68555555555555555555e-2 * t33 * t172 * t72 + 0.13796805555555555555e-4 * t112 * t176 * t180 * t72 - 0.334075e-2 * t33 * t172 * t77;
  t193 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t79 - t144 - 0.3e1 / 0.8e1 * t5 * t63 * t188);
  tvrho1 = t53 + t83 + t6 * (t159 + t193);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t199 = t114 * rho[0];
  t201 = 0.1e1 / t35 / t199;
  t209 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t112 * sigma[0] * t201 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t213 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t209);
  tvsigma0 = t6 * t213;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t217 = t177 * rho[1];
  t219 = 0.1e1 / t65 / t217;
  t227 = 0.25708333333333333333e-2 * t33 * t68 * t72 - 0.51738020833333333333e-5 * t112 * sigma[2] * t219 * t72 + 0.125278125e-2 * t33 * t68 * t77;
  t231 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t227);
  tvsigma2 = t6 * t231;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83, tzk0;

  double t84, t85, t86, t88, t91, t92, t96, t97;
  double t98, t101, t102, t104, t105, t109, t112, t113;
  double t114, t115, t117, t125, t130, t131, t133, t136;
  double t137, t141, t144, t146, tvrho0, t150, t153, t154;
  double t159, t161, t164, t165, t169, t171, t172, t176;
  double t177, t178, t180, t188, t193, tvrho1, t199, t201;
  double t209, t213, tvsigma0, tvsigma1, t217, t219, t227, t231;
  double tvsigma2;

  double t234, t235, t236, t239, t240, t241, t244, t248;
  double t249, t253, t255, t261, t262, t265, t267, t270;
  double t271, t275, t277, t278, t282, t283, t284, t285;
  double t295, t300, t301, t302, t303, t306, t309, t313;
  double t314, t318, t320, t322, t325, t327, tv2rho20, t330;
  double t334, t338, t339, t343, t345, t353, t354, t358;
  double t362, t363, t367, t369, t376, t379, tv2rho21, t384;
  double t389, t393, t394, t400, t401, t406, t410, t411;
  double t421, t422, t426, t428, t429, t433, t434, t435;
  double t436, t446, t451, tv2rho22, t459, t463, t467, t468;
  double t478, t483, tv2rhosigma0, tv2rhosigma1, t490, t492, tv2rhosigma2, t498;
  double tv2rhosigma3, tv2rhosigma4, t506, t510, t511, t521, t526, tv2rhosigma5;
  double t531, t538, t542, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t546, t553, t557, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125e-2 * t70);
  t77 = exp(-0.100625e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  tzk0 = t53 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t88 = my_piecewise5(t10, 0, t14, 0, t7 - t86);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t49 / 0.8e1;
  t102 = t34 * rho[0];
  t104 = 0.1e1 / t36 / t102;
  t105 = sigma[0] * t104;
  t109 = t28 * t28;
  t112 = t109 / t30 / t29;
  t113 = sigma[0] * sigma[0];
  t114 = t34 * t34;
  t115 = t114 * t34;
  t117 = 0.1e1 / t35 / t115;
  t125 = -0.68555555555555555555e-2 * t33 * t105 * t42 + 0.13796805555555555555e-4 * t112 * t113 * t117 * t42 - 0.334075e-2 * t33 * t105 * t47;
  t130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t49 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t125);
  t131 = t55 * t85;
  t133 = my_piecewise5(t14, 0, t10, 0, -t7 - t131);
  t136 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t133);
  t137 = t136 * t26;
  t141 = t62 * t97;
  t144 = t5 * t141 * t79 / 0.8e1;
  t146 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t79 - t144);
  tvrho0 = t53 + t83 + t6 * (t130 + t146);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = my_piecewise5(t10, 0, t14, 0, -t7 - t86);
  t153 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t150);
  t154 = t153 * t26;
  t159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t49 - t101);
  t161 = my_piecewise5(t14, 0, t10, 0, t7 - t131);
  t164 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t161);
  t165 = t164 * t26;
  t169 = t64 * rho[1];
  t171 = 0.1e1 / t66 / t169;
  t172 = sigma[2] * t171;
  t176 = sigma[2] * sigma[2];
  t177 = t64 * t64;
  t178 = t177 * t64;
  t180 = 0.1e1 / t65 / t178;
  t188 = -0.68555555555555555555e-2 * t33 * t172 * t72 + 0.13796805555555555555e-4 * t112 * t176 * t180 * t72 - 0.334075e-2 * t33 * t172 * t77;
  t193 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t79 - t144 - 0.3e1 / 0.8e1 * t5 * t63 * t188);
  tvrho1 = t53 + t83 + t6 * (t159 + t193);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t199 = t114 * rho[0];
  t201 = 0.1e1 / t35 / t199;
  t209 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t112 * sigma[0] * t201 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t213 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t209);
  tvsigma0 = t6 * t213;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t217 = t177 * rho[1];
  t219 = 0.1e1 / t65 / t217;
  t227 = 0.25708333333333333333e-2 * t33 * t68 * t72 - 0.51738020833333333333e-5 * t112 * sigma[2] * t219 * t72 + 0.125278125e-2 * t33 * t68 * t77;
  t231 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t227);
  tvsigma2 = t6 * t231;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t234 = t23 * t23;
  t235 = 0.1e1 / t234;
  t236 = t88 * t88;
  t239 = t84 * t6;
  t240 = 0.1e1 / t239;
  t241 = t16 * t240;
  t244 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t85 + 0.2e1 * t241);
  t248 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t236 + 0.4e1 / 0.3e1 * t23 * t244);
  t249 = t248 * t26;
  t253 = t91 * t97;
  t255 = t5 * t253 * t49;
  t261 = 0.1e1 / t96 / t6;
  t262 = t25 * t261;
  t265 = t5 * t262 * t49 / 0.12e2;
  t267 = t5 * t98 * t125;
  t270 = 0.1e1 / t36 / t114;
  t271 = sigma[0] * t270;
  t275 = t114 * t102;
  t277 = 0.1e1 / t35 / t275;
  t278 = t113 * t277;
  t282 = t113 * sigma[0];
  t283 = t114 * t114;
  t284 = t283 * t34;
  t285 = 0.1e1 / t284;
  t295 = 0.25137037037037037037e-1 * t33 * t271 * t42 - 0.12417125e-3 * t112 * t278 * t42 + 0.4560735904350167404e-8 * t282 * t285 * t42 + 0.12249416666666666667e-1 * t33 * t271 * t47 - 0.89643458333333333332e-5 * t112 * t278 * t47;
  t300 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t49 - t255 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t125 + t265 - t267 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t295);
  t301 = t60 * t60;
  t302 = 0.1e1 / t301;
  t303 = t133 * t133;
  t306 = t55 * t240;
  t309 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t85 + 0.2e1 * t306);
  t313 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t303 + 0.4e1 / 0.3e1 * t60 * t309);
  t314 = t313 * t26;
  t318 = t136 * t97;
  t320 = t5 * t318 * t79;
  t322 = t62 * t261;
  t325 = t5 * t322 * t79 / 0.12e2;
  t327 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t79 - t320 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t130 + 0.2e1 * t146 + t6 * (t300 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t235 * t150;
  t334 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t241);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t88 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t338 * t26;
  t343 = t153 * t97;
  t345 = t5 * t343 * t49;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t49 - t345 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t125 - t255 / 0.8e1 + t265 - t267 / 0.8e1);
  t354 = t302 * t161;
  t358 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t306);
  t362 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t354 * t133 + 0.4e1 / 0.3e1 * t60 * t358);
  t363 = t362 * t26;
  t367 = t164 * t97;
  t369 = t5 * t367 * t79;
  t376 = t5 * t141 * t188;
  t379 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t79 - t369 / 0.8e1 - t320 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t5 * t137 * t188 - t376 / 0.8e1);
  tv2rho21 = t130 + t146 + t159 + t193 + t6 * (t353 + t379);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t384 = t150 * t150;
  t389 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t85 + 0.2e1 * t241);
  t393 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t384 + 0.4e1 / 0.3e1 * t23 * t389);
  t394 = t393 * t26;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t49 - t345 / 0.4e1 + t265);
  t401 = t161 * t161;
  t406 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t85 + 0.2e1 * t306);
  t410 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t401 + 0.4e1 / 0.3e1 * t60 * t406);
  t411 = t410 * t26;
  t421 = 0.1e1 / t66 / t177;
  t422 = sigma[2] * t421;
  t426 = t177 * t169;
  t428 = 0.1e1 / t65 / t426;
  t429 = t176 * t428;
  t433 = t176 * sigma[2];
  t434 = t177 * t177;
  t435 = t434 * t64;
  t436 = 0.1e1 / t435;
  t446 = 0.25137037037037037037e-1 * t33 * t422 * t72 - 0.12417125e-3 * t112 * t429 * t72 + 0.4560735904350167404e-8 * t433 * t436 * t72 + 0.12249416666666666667e-1 * t33 * t422 * t77 - 0.89643458333333333332e-5 * t112 * t429 * t77;
  t451 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t79 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t188 + t325 - t376 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t446);
  tv2rho22 = 0.2e1 * t159 + 0.2e1 * t193 + t6 * (t400 + t451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t459 = t5 * t98 * t209 / 0.8e1;
  t463 = t117 * sigma[0];
  t467 = t283 * rho[0];
  t468 = 0.1e1 / t467;
  t478 = -0.68555555555555555555e-2 * t33 * t104 * t42 + 0.41390416666666666666e-4 * t112 * t463 * t42 - 0.17102759641313127765e-8 * t113 * t468 * t42 - 0.334075e-2 * t33 * t104 * t47 + 0.33616296875e-5 * t112 * t463 * t47;
  t483 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t209 - t459 - 0.3e1 / 0.8e1 * t5 * t27 * t478);
  tv2rhosigma0 = t483 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t490 = t5 * t141 * t227 / 0.8e1;
  t492 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t227 - t490);
  tv2rhosigma2 = t492 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t498 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t209 - t459);
  tv2rhosigma3 = t498 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t506 = t180 * sigma[2];
  t510 = t434 * rho[1];
  t511 = 0.1e1 / t510;
  t521 = -0.68555555555555555555e-2 * t33 * t171 * t72 + 0.41390416666666666666e-4 * t112 * t506 * t72 - 0.17102759641313127765e-8 * t176 * t511 * t72 - 0.334075e-2 * t33 * t171 * t77 + 0.33616296875e-5 * t112 * t506 * t77;
  t526 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t227 - t490 - 0.3e1 / 0.8e1 * t5 * t63 * t521);
  tv2rhosigma5 = t526 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t531 = 0.1e1 / t283;
  t538 = -0.10347604166666666667e-4 * t112 * t201 * t42 + 0.64135348654924229118e-9 * sigma[0] * t531 * t42 - 0.12606111328125e-5 * t112 * t201 * t47;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t538);
  tv2sigma20 = t6 * t542;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = 0.1e1 / t434;
  t553 = -0.10347604166666666667e-4 * t112 * t219 * t72 + 0.64135348654924229118e-9 * sigma[2] * t546 * t72 - 0.12606111328125e-5 * t112 * t219 * t77;
  t557 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t553);
  tv2sigma25 = t6 * t557;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83, tzk0;

  double t84, t85, t86, t88, t91, t92, t96, t97;
  double t98, t101, t102, t104, t105, t109, t112, t113;
  double t114, t115, t117, t125, t130, t131, t133, t136;
  double t137, t141, t144, t146, tvrho0, t150, t153, t154;
  double t159, t161, t164, t165, t169, t171, t172, t176;
  double t177, t178, t180, t188, t193, tvrho1, t199, t201;
  double t209, t213, tvsigma0, tvsigma1, t217, t219, t227, t231;
  double tvsigma2;

  double t234, t235, t236, t239, t240, t241, t244, t248;
  double t249, t253, t255, t261, t262, t265, t267, t270;
  double t271, t275, t277, t278, t282, t283, t284, t285;
  double t295, t300, t301, t302, t303, t306, t309, t313;
  double t314, t318, t320, t322, t325, t327, tv2rho20, t330;
  double t334, t338, t339, t343, t345, t353, t354, t358;
  double t362, t363, t367, t369, t376, t379, tv2rho21, t384;
  double t389, t393, t394, t400, t401, t406, t410, t411;
  double t421, t422, t426, t428, t429, t433, t434, t435;
  double t436, t446, t451, tv2rho22, t459, t463, t467, t468;
  double t478, t483, tv2rhosigma0, tv2rhosigma1, t490, t492, tv2rhosigma2, t498;
  double tv2rhosigma3, tv2rhosigma4, t506, t510, t511, t521, t526, tv2rhosigma5;
  double t531, t538, t542, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t546, t553, t557, tv2sigma25;

  double t561, t562, t565, t568, t569, t570, t573, t577;
  double t578, t582, t584, t589, t591, t594, t600, t601;
  double t604, t606, t609, t612, t613, t618, t619, t623;
  double t624, t625, t628, t629, t631, t633, t644, t649;
  double t651, t652, t655, t658, t661, t665, t666, t670;
  double t672, t674, t676, t678, t681, t683, tv3rho30, t686;
  double t687, t688, t691, t696, t697, t699, t703, t704;
  double t708, t711, t715, t717, t721, t730, t731, t732;
  double t735, t740, t742, t746, t747, t751, t754, t755;
  double t757, t766, t768, t771, tv3rho31, t774, t779, t783;
  double t787, t788, t792, t794, t803, t804, t809, t813;
  double t817, t818, t822, t824, t831, t839, t841, t842;
  double tv3rho32, t847, t854, t858, t859, t866, t867, t874;
  double t878, t879, t895, t896, t901, t902, t906, t907;
  double t908, t911, t912, t914, t916, t927, t932, tv3rho33;
  double t940, t947, t949, t954, t958, t961, t963, t975;
  double t980, tv3rho2sigma0, tv3rho2sigma1, t987, t991, t993, tv3rho2sigma2, t999;
  double t1007, tv3rho2sigma3, tv3rho2sigma4, t1013, t1020, t1023, tv3rho2sigma5, t1031;
  double tv3rho2sigma6, tv3rho2sigma7, t1045, t1049, t1052, t1054, t1066, t1071;
  double tv3rho2sigma8, t1078, t1082, t1086, t1095, t1100, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1107, t1109, tv3rhosigma25, t1115, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1123, t1127, t1136, t1141;
  double tv3rhosigma211, t1146, t1152, t1156, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1160, t1166, t1170;
  double tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125e-2 * t70);
  t77 = exp(-0.100625e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  tzk0 = t53 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t88 = my_piecewise5(t10, 0, t14, 0, t7 - t86);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t49 / 0.8e1;
  t102 = t34 * rho[0];
  t104 = 0.1e1 / t36 / t102;
  t105 = sigma[0] * t104;
  t109 = t28 * t28;
  t112 = t109 / t30 / t29;
  t113 = sigma[0] * sigma[0];
  t114 = t34 * t34;
  t115 = t114 * t34;
  t117 = 0.1e1 / t35 / t115;
  t125 = -0.68555555555555555555e-2 * t33 * t105 * t42 + 0.13796805555555555555e-4 * t112 * t113 * t117 * t42 - 0.334075e-2 * t33 * t105 * t47;
  t130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t49 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t125);
  t131 = t55 * t85;
  t133 = my_piecewise5(t14, 0, t10, 0, -t7 - t131);
  t136 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t133);
  t137 = t136 * t26;
  t141 = t62 * t97;
  t144 = t5 * t141 * t79 / 0.8e1;
  t146 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t79 - t144);
  tvrho0 = t53 + t83 + t6 * (t130 + t146);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = my_piecewise5(t10, 0, t14, 0, -t7 - t86);
  t153 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t150);
  t154 = t153 * t26;
  t159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t49 - t101);
  t161 = my_piecewise5(t14, 0, t10, 0, t7 - t131);
  t164 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t161);
  t165 = t164 * t26;
  t169 = t64 * rho[1];
  t171 = 0.1e1 / t66 / t169;
  t172 = sigma[2] * t171;
  t176 = sigma[2] * sigma[2];
  t177 = t64 * t64;
  t178 = t177 * t64;
  t180 = 0.1e1 / t65 / t178;
  t188 = -0.68555555555555555555e-2 * t33 * t172 * t72 + 0.13796805555555555555e-4 * t112 * t176 * t180 * t72 - 0.334075e-2 * t33 * t172 * t77;
  t193 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t79 - t144 - 0.3e1 / 0.8e1 * t5 * t63 * t188);
  tvrho1 = t53 + t83 + t6 * (t159 + t193);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t199 = t114 * rho[0];
  t201 = 0.1e1 / t35 / t199;
  t209 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t112 * sigma[0] * t201 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t213 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t209);
  tvsigma0 = t6 * t213;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t217 = t177 * rho[1];
  t219 = 0.1e1 / t65 / t217;
  t227 = 0.25708333333333333333e-2 * t33 * t68 * t72 - 0.51738020833333333333e-5 * t112 * sigma[2] * t219 * t72 + 0.125278125e-2 * t33 * t68 * t77;
  t231 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t227);
  tvsigma2 = t6 * t231;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t234 = t23 * t23;
  t235 = 0.1e1 / t234;
  t236 = t88 * t88;
  t239 = t84 * t6;
  t240 = 0.1e1 / t239;
  t241 = t16 * t240;
  t244 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t85 + 0.2e1 * t241);
  t248 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t236 + 0.4e1 / 0.3e1 * t23 * t244);
  t249 = t248 * t26;
  t253 = t91 * t97;
  t255 = t5 * t253 * t49;
  t261 = 0.1e1 / t96 / t6;
  t262 = t25 * t261;
  t265 = t5 * t262 * t49 / 0.12e2;
  t267 = t5 * t98 * t125;
  t270 = 0.1e1 / t36 / t114;
  t271 = sigma[0] * t270;
  t275 = t114 * t102;
  t277 = 0.1e1 / t35 / t275;
  t278 = t113 * t277;
  t282 = t113 * sigma[0];
  t283 = t114 * t114;
  t284 = t283 * t34;
  t285 = 0.1e1 / t284;
  t295 = 0.25137037037037037037e-1 * t33 * t271 * t42 - 0.12417125e-3 * t112 * t278 * t42 + 0.4560735904350167404e-8 * t282 * t285 * t42 + 0.12249416666666666667e-1 * t33 * t271 * t47 - 0.89643458333333333332e-5 * t112 * t278 * t47;
  t300 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t49 - t255 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t125 + t265 - t267 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t295);
  t301 = t60 * t60;
  t302 = 0.1e1 / t301;
  t303 = t133 * t133;
  t306 = t55 * t240;
  t309 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t85 + 0.2e1 * t306);
  t313 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t303 + 0.4e1 / 0.3e1 * t60 * t309);
  t314 = t313 * t26;
  t318 = t136 * t97;
  t320 = t5 * t318 * t79;
  t322 = t62 * t261;
  t325 = t5 * t322 * t79 / 0.12e2;
  t327 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t79 - t320 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t130 + 0.2e1 * t146 + t6 * (t300 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t235 * t150;
  t334 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t241);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t88 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t338 * t26;
  t343 = t153 * t97;
  t345 = t5 * t343 * t49;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t49 - t345 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t125 - t255 / 0.8e1 + t265 - t267 / 0.8e1);
  t354 = t302 * t161;
  t358 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t306);
  t362 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t354 * t133 + 0.4e1 / 0.3e1 * t60 * t358);
  t363 = t362 * t26;
  t367 = t164 * t97;
  t369 = t5 * t367 * t79;
  t376 = t5 * t141 * t188;
  t379 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t79 - t369 / 0.8e1 - t320 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t5 * t137 * t188 - t376 / 0.8e1);
  tv2rho21 = t130 + t146 + t159 + t193 + t6 * (t353 + t379);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t384 = t150 * t150;
  t389 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t85 + 0.2e1 * t241);
  t393 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t384 + 0.4e1 / 0.3e1 * t23 * t389);
  t394 = t393 * t26;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t49 - t345 / 0.4e1 + t265);
  t401 = t161 * t161;
  t406 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t85 + 0.2e1 * t306);
  t410 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t401 + 0.4e1 / 0.3e1 * t60 * t406);
  t411 = t410 * t26;
  t421 = 0.1e1 / t66 / t177;
  t422 = sigma[2] * t421;
  t426 = t177 * t169;
  t428 = 0.1e1 / t65 / t426;
  t429 = t176 * t428;
  t433 = t176 * sigma[2];
  t434 = t177 * t177;
  t435 = t434 * t64;
  t436 = 0.1e1 / t435;
  t446 = 0.25137037037037037037e-1 * t33 * t422 * t72 - 0.12417125e-3 * t112 * t429 * t72 + 0.4560735904350167404e-8 * t433 * t436 * t72 + 0.12249416666666666667e-1 * t33 * t422 * t77 - 0.89643458333333333332e-5 * t112 * t429 * t77;
  t451 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t79 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t188 + t325 - t376 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t446);
  tv2rho22 = 0.2e1 * t159 + 0.2e1 * t193 + t6 * (t400 + t451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t459 = t5 * t98 * t209 / 0.8e1;
  t463 = t117 * sigma[0];
  t467 = t283 * rho[0];
  t468 = 0.1e1 / t467;
  t478 = -0.68555555555555555555e-2 * t33 * t104 * t42 + 0.41390416666666666666e-4 * t112 * t463 * t42 - 0.17102759641313127765e-8 * t113 * t468 * t42 - 0.334075e-2 * t33 * t104 * t47 + 0.33616296875e-5 * t112 * t463 * t47;
  t483 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t209 - t459 - 0.3e1 / 0.8e1 * t5 * t27 * t478);
  tv2rhosigma0 = t483 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t490 = t5 * t141 * t227 / 0.8e1;
  t492 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t227 - t490);
  tv2rhosigma2 = t492 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t498 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t209 - t459);
  tv2rhosigma3 = t498 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t506 = t180 * sigma[2];
  t510 = t434 * rho[1];
  t511 = 0.1e1 / t510;
  t521 = -0.68555555555555555555e-2 * t33 * t171 * t72 + 0.41390416666666666666e-4 * t112 * t506 * t72 - 0.17102759641313127765e-8 * t176 * t511 * t72 - 0.334075e-2 * t33 * t171 * t77 + 0.33616296875e-5 * t112 * t506 * t77;
  t526 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t227 - t490 - 0.3e1 / 0.8e1 * t5 * t63 * t521);
  tv2rhosigma5 = t526 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t531 = 0.1e1 / t283;
  t538 = -0.10347604166666666667e-4 * t112 * t201 * t42 + 0.64135348654924229118e-9 * sigma[0] * t531 * t42 - 0.12606111328125e-5 * t112 * t201 * t47;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t538);
  tv2sigma20 = t6 * t542;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = 0.1e1 / t434;
  t553 = -0.10347604166666666667e-4 * t112 * t219 * t72 + 0.64135348654924229118e-9 * sigma[2] * t546 * t72 - 0.12606111328125e-5 * t112 * t219 * t77;
  t557 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t553);
  tv2sigma25 = t6 * t557;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t561 = 0.1e1 / t234 / t19;
  t562 = t236 * t88;
  t565 = t235 * t88;
  t568 = t84 * t84;
  t569 = 0.1e1 / t568;
  t570 = t16 * t569;
  t573 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t240 - 0.6e1 * t570);
  t577 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t562 + 0.4e1 / 0.3e1 * t565 * t244 + 0.4e1 / 0.3e1 * t23 * t573);
  t578 = t577 * t26;
  t582 = t248 * t97;
  t584 = t5 * t582 * t49;
  t589 = t91 * t261;
  t591 = t5 * t589 * t49;
  t594 = t5 * t253 * t125;
  t600 = 0.1e1 / t96 / t84;
  t601 = t25 * t600;
  t604 = 0.5e1 / 0.36e2 * t5 * t601 * t49;
  t606 = t5 * t262 * t125;
  t609 = t5 * t98 * t295;
  t612 = 0.1e1 / t36 / t199;
  t613 = sigma[0] * t612;
  t618 = 0.1e1 / t35 / t283;
  t619 = t113 * t618;
  t623 = t283 * t102;
  t624 = 0.1e1 / t623;
  t625 = t282 * t624;
  t628 = t113 * t113;
  t629 = t283 * t199;
  t631 = 0.1e1 / t36 / t629;
  t633 = t33 * t42;
  t644 = -0.11730617283950617284e0 * t33 * t613 * t42 + 0.10454912654320987654e-2 * t112 * t619 * t42 - 0.86653982182653180677e-7 * t625 * t42 + 0.24475949353345898402e-10 * t628 * t631 * t633 - 0.57163944444444444446e-1 * t33 * t613 * t47 + 0.98607804166666666666e-4 * t112 * t619 * t47 - 0.14816478255226406893e-8 * t625 * t47;
  t649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t578 * t49 - 0.3e1 / 0.8e1 * t584 - 0.9e1 / 0.8e1 * t5 * t249 * t125 + t591 / 0.4e1 - 0.3e1 / 0.4e1 * t594 - 0.9e1 / 0.8e1 * t5 * t92 * t295 - t604 + t606 / 0.4e1 - 0.3e1 / 0.8e1 * t609 - 0.3e1 / 0.8e1 * t5 * t27 * t644);
  t651 = 0.1e1 / t301 / t58;
  t652 = t303 * t133;
  t655 = t302 * t133;
  t658 = t55 * t569;
  t661 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t240 - 0.6e1 * t658);
  t665 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t652 + 0.4e1 / 0.3e1 * t655 * t309 + 0.4e1 / 0.3e1 * t60 * t661);
  t666 = t665 * t26;
  t670 = t313 * t97;
  t672 = t5 * t670 * t79;
  t674 = t136 * t261;
  t676 = t5 * t674 * t79;
  t678 = t62 * t600;
  t681 = 0.5e1 / 0.36e2 * t5 * t678 * t79;
  t683 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t666 * t79 - 0.3e1 / 0.8e1 * t672 + t676 / 0.4e1 - t681);
  tv3rho30 = 0.3e1 * t300 + 0.3e1 * t327 + t6 * (t649 + t683);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t686 = 0.2e1 * t353;
  t687 = 0.2e1 * t379;
  t688 = t561 * t150;
  t691 = t235 * t334;
  t696 = 0.2e1 * t240;
  t697 = 0.6e1 * t570;
  t699 = my_piecewise5(t10, 0, t14, 0, t696 - t697);
  t703 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t688 * t236 + 0.8e1 / 0.9e1 * t691 * t88 + 0.4e1 / 0.9e1 * t330 * t244 + 0.4e1 / 0.3e1 * t23 * t699);
  t704 = t703 * t26;
  t708 = t338 * t97;
  t711 = t5 * t708 * t49 / 0.4e1;
  t715 = t153 * t261;
  t717 = t5 * t715 * t49;
  t721 = t5 * t343 * t125 / 0.4e1;
  t730 = -0.3e1 / 0.8e1 * t5 * t704 * t49 - t711 - 0.3e1 / 0.4e1 * t5 * t339 * t125 + t717 / 0.12e2 - t721 - 0.3e1 / 0.8e1 * t5 * t154 * t295 - t584 / 0.8e1 + t591 / 0.6e1 - t594 / 0.4e1 - t604 + t606 / 0.6e1 - t609 / 0.8e1;
  t731 = my_piecewise3(t1, 0, t730);
  t732 = t651 * t161;
  t735 = t302 * t358;
  t740 = 0.6e1 * t658;
  t742 = my_piecewise5(t14, 0, t10, 0, -t696 - t740);
  t746 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t732 * t303 + 0.8e1 / 0.9e1 * t735 * t133 + 0.4e1 / 0.9e1 * t354 * t309 + 0.4e1 / 0.3e1 * t60 * t742);
  t747 = t746 * t26;
  t751 = t362 * t97;
  t754 = t5 * t751 * t79 / 0.4e1;
  t755 = t164 * t261;
  t757 = t5 * t755 * t79;
  t766 = t5 * t318 * t188 / 0.4e1;
  t768 = t5 * t322 * t188;
  t771 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t747 * t79 - t754 + t757 / 0.12e2 - t672 / 0.8e1 + t676 / 0.6e1 - t681 - 0.3e1 / 0.8e1 * t5 * t314 * t188 - t766 + t768 / 0.12e2);
  tv3rho31 = t300 + t327 + t686 + t687 + t6 * (t731 + t771);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t774 = t561 * t384;
  t779 = t235 * t389;
  t783 = my_piecewise5(t10, 0, t14, 0, -t696 - t697);
  t787 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t774 * t88 + 0.8e1 / 0.9e1 * t330 * t334 + 0.4e1 / 0.9e1 * t779 * t88 + 0.4e1 / 0.3e1 * t23 * t783);
  t788 = t787 * t26;
  t792 = t393 * t97;
  t794 = t5 * t792 * t49;
  t803 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t788 * t49 - t794 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t394 * t125 - t711 + t717 / 0.6e1 - t721 + t591 / 0.12e2 - t604 + t606 / 0.12e2);
  t804 = t651 * t401;
  t809 = t302 * t406;
  t813 = my_piecewise5(t14, 0, t10, 0, t696 - t740);
  t817 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t804 * t133 + 0.8e1 / 0.9e1 * t354 * t358 + 0.4e1 / 0.9e1 * t809 * t133 + 0.4e1 / 0.3e1 * t60 * t813);
  t818 = t817 * t26;
  t822 = t410 * t97;
  t824 = t5 * t822 * t79;
  t831 = t5 * t367 * t188;
  t839 = t5 * t141 * t446;
  t841 = -0.3e1 / 0.8e1 * t5 * t818 * t79 - t824 / 0.8e1 - t754 + t757 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t363 * t188 - t831 / 0.4e1 + t676 / 0.12e2 - t681 - t766 + t768 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t137 * t446 - t839 / 0.8e1;
  t842 = my_piecewise3(t54, 0, t841);
  tv3rho32 = t686 + t687 + t400 + t451 + t6 * (t803 + t842);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t847 = t384 * t150;
  t854 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t240 - 0.6e1 * t570);
  t858 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t847 + 0.4e1 / 0.3e1 * t330 * t389 + 0.4e1 / 0.3e1 * t23 * t854);
  t859 = t858 * t26;
  t866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t859 * t49 - 0.3e1 / 0.8e1 * t794 + t717 / 0.4e1 - t604);
  t867 = t401 * t161;
  t874 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t240 - 0.6e1 * t658);
  t878 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t867 + 0.4e1 / 0.3e1 * t354 * t406 + 0.4e1 / 0.3e1 * t60 * t874);
  t879 = t878 * t26;
  t895 = 0.1e1 / t66 / t217;
  t896 = sigma[2] * t895;
  t901 = 0.1e1 / t65 / t434;
  t902 = t176 * t901;
  t906 = t434 * t169;
  t907 = 0.1e1 / t906;
  t908 = t433 * t907;
  t911 = t176 * t176;
  t912 = t434 * t217;
  t914 = 0.1e1 / t66 / t912;
  t916 = t33 * t72;
  t927 = -0.11730617283950617284e0 * t33 * t896 * t72 + 0.10454912654320987654e-2 * t112 * t902 * t72 - 0.86653982182653180677e-7 * t908 * t72 + 0.24475949353345898402e-10 * t911 * t914 * t916 - 0.57163944444444444446e-1 * t33 * t896 * t77 + 0.98607804166666666666e-4 * t112 * t902 * t77 - 0.14816478255226406893e-8 * t908 * t77;
  t932 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t879 * t79 - 0.3e1 / 0.8e1 * t824 - 0.9e1 / 0.8e1 * t5 * t411 * t188 + t757 / 0.4e1 - 0.3e1 / 0.4e1 * t831 - 0.9e1 / 0.8e1 * t5 * t165 * t446 - t681 + t768 / 0.4e1 - 0.3e1 / 0.8e1 * t839 - 0.3e1 / 0.8e1 * t5 * t63 * t927);
  tv3rho33 = 0.3e1 * t400 + 0.3e1 * t451 + t6 * (t866 + t932);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t940 = t5 * t253 * t209;
  t947 = t5 * t262 * t209 / 0.12e2;
  t949 = t5 * t98 * t478;
  t954 = t277 * sigma[0];
  t958 = t285 * t113;
  t961 = t283 * t114;
  t963 = 0.1e1 / t36 / t961;
  t975 = 0.25137037037037037037e-1 * t33 * t270 * t42 - 0.29893078703703703703e-3 * t112 * t954 * t42 + 0.290746913902323172e-7 * t958 * t42 - 0.91784810075047119006e-11 * t282 * t963 * t633 + 0.12249416666666666667e-1 * t33 * t270 * t47 - 0.302546671875e-4 * t112 * t954 * t47 + 0.5556179345709902585e-9 * t958 * t47;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t209 - t940 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t478 + t947 - t949 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  tv3rho2sigma0 = t6 * t980 + 0.2e1 * t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t987 = t5 * t318 * t227;
  t991 = t5 * t322 * t227 / 0.12e2;
  t993 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t227 - t987 / 0.4e1 + t991);
  tv3rho2sigma2 = t6 * t993 + 0.2e1 * t492;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t999 = t5 * t343 * t209;
  t1007 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t209 - t999 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t478 - t940 / 0.8e1 + t947 - t949 / 0.8e1);
  tv3rho2sigma3 = t1007 * t6 + t483 + t498;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1013 = t5 * t367 * t227;
  t1020 = t5 * t141 * t521;
  t1023 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t227 - t1013 / 0.8e1 - t987 / 0.8e1 + t991 - 0.3e1 / 0.8e1 * t5 * t137 * t521 - t1020 / 0.8e1);
  tv3rho2sigma5 = t1023 * t6 + t492 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t209 - t999 / 0.4e1 + t947);
  tv3rho2sigma6 = t1031 * t6 + 0.2e1 * t498;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1045 = t428 * sigma[2];
  t1049 = t436 * t176;
  t1052 = t434 * t177;
  t1054 = 0.1e1 / t66 / t1052;
  t1066 = 0.25137037037037037037e-1 * t33 * t421 * t72 - 0.29893078703703703703e-3 * t112 * t1045 * t72 + 0.290746913902323172e-7 * t1049 * t72 - 0.91784810075047119006e-11 * t433 * t1054 * t916 + 0.12249416666666666667e-1 * t33 * t421 * t77 - 0.302546671875e-4 * t112 * t1045 * t77 + 0.5556179345709902585e-9 * t1049 * t77;
  t1071 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t227 - t1013 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t521 + t991 - t1020 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t1066);
  tv3rho2sigma8 = t1071 * t6 + 0.2e1 * t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1078 = t5 * t98 * t538 / 0.8e1;
  t1082 = t468 * sigma[0];
  t1086 = 0.1e1 / t36 / t623;
  t1095 = 0.55187222222222222224e-4 * t112 * t117 * t42 - 0.85513798206565638826e-8 * t1082 * t42 + 0.34419303778142669627e-11 * t113 * t1086 * t633 + 0.6723259375e-5 * t112 * t117 * t47 - 0.20835672546412134694e-9 * t1082 * t47;
  t1100 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t538 - t1078 - 0.3e1 / 0.8e1 * t5 * t27 * t1095);
  tv3rhosigma20 = t1100 * t6 + t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1107 = t5 * t141 * t553 / 0.8e1;
  t1109 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t553 - t1107);
  tv3rhosigma25 = t1109 * t6 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1115 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t538 - t1078);
  tv3rhosigma26 = t1115 * t6 + t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1123 = t511 * sigma[2];
  t1127 = 0.1e1 / t66 / t906;
  t1136 = 0.55187222222222222224e-4 * t112 * t180 * t72 - 0.85513798206565638826e-8 * t1123 * t72 + 0.34419303778142669627e-11 * t176 * t1127 * t916 + 0.6723259375e-5 * t112 * t180 * t77 - 0.20835672546412134694e-9 * t1123 * t77;
  t1141 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t553 - t1107 - 0.3e1 / 0.8e1 * t5 * t63 * t1136);
  tv3rhosigma211 = t1141 * t6 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1146 = 0.1e1 / t36 / t284;
  t1152 = 0.19240604596477268736e-8 * t531 * t42 - 0.1290723891680350111e-11 * sigma[0] * t1146 * t633 + 0.78133772049045505101e-10 * t531 * t47;
  t1156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1152);
  tv3sigma30 = t6 * t1156;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1160 = 0.1e1 / t66 / t435;
  t1166 = 0.19240604596477268736e-8 * t546 * t72 - 0.1290723891680350111e-11 * sigma[2] * t1160 * t916 + 0.78133772049045505101e-10 * t546 * t77;
  t1170 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t1166);
  tv3sigma39 = t6 * t1170;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t38, t39, t40;
  double t42, t47, t49, t53, t54, t55, t57, t58;
  double t59, t60, t62, t63, t64, t65, t66, t68;
  double t69, t70, t72, t77, t79, t83, tzk0;

  double t84, t85, t86, t88, t91, t92, t96, t97;
  double t98, t101, t102, t104, t105, t109, t112, t113;
  double t114, t115, t117, t125, t130, t131, t133, t136;
  double t137, t141, t144, t146, tvrho0, t150, t153, t154;
  double t159, t161, t164, t165, t169, t171, t172, t176;
  double t177, t178, t180, t188, t193, tvrho1, t199, t201;
  double t209, t213, tvsigma0, tvsigma1, t217, t219, t227, t231;
  double tvsigma2;

  double t234, t235, t236, t239, t240, t241, t244, t248;
  double t249, t253, t255, t261, t262, t265, t267, t270;
  double t271, t275, t277, t278, t282, t283, t284, t285;
  double t295, t300, t301, t302, t303, t306, t309, t313;
  double t314, t318, t320, t322, t325, t327, tv2rho20, t330;
  double t334, t338, t339, t343, t345, t353, t354, t358;
  double t362, t363, t367, t369, t376, t379, tv2rho21, t384;
  double t389, t393, t394, t400, t401, t406, t410, t411;
  double t421, t422, t426, t428, t429, t433, t434, t435;
  double t436, t446, t451, tv2rho22, t459, t463, t467, t468;
  double t478, t483, tv2rhosigma0, tv2rhosigma1, t490, t492, tv2rhosigma2, t498;
  double tv2rhosigma3, tv2rhosigma4, t506, t510, t511, t521, t526, tv2rhosigma5;
  double t531, t538, t542, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t546, t553, t557, tv2sigma25;

  double t561, t562, t565, t568, t569, t570, t573, t577;
  double t578, t582, t584, t589, t591, t594, t600, t601;
  double t604, t606, t609, t612, t613, t618, t619, t623;
  double t624, t625, t628, t629, t631, t633, t644, t649;
  double t651, t652, t655, t658, t661, t665, t666, t670;
  double t672, t674, t676, t678, t681, t683, tv3rho30, t686;
  double t687, t688, t691, t696, t697, t699, t703, t704;
  double t708, t711, t715, t717, t721, t730, t731, t732;
  double t735, t740, t742, t746, t747, t751, t754, t755;
  double t757, t766, t768, t771, tv3rho31, t774, t779, t783;
  double t787, t788, t792, t794, t803, t804, t809, t813;
  double t817, t818, t822, t824, t831, t839, t841, t842;
  double tv3rho32, t847, t854, t858, t859, t866, t867, t874;
  double t878, t879, t895, t896, t901, t902, t906, t907;
  double t908, t911, t912, t914, t916, t927, t932, tv3rho33;
  double t940, t947, t949, t954, t958, t961, t963, t975;
  double t980, tv3rho2sigma0, tv3rho2sigma1, t987, t991, t993, tv3rho2sigma2, t999;
  double t1007, tv3rho2sigma3, tv3rho2sigma4, t1013, t1020, t1023, tv3rho2sigma5, t1031;
  double tv3rho2sigma6, tv3rho2sigma7, t1045, t1049, t1052, t1054, t1066, t1071;
  double tv3rho2sigma8, t1078, t1082, t1086, t1095, t1100, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1107, t1109, tv3rhosigma25, t1115, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1123, t1127, t1136, t1141;
  double tv3rhosigma211, t1146, t1152, t1156, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1160, t1166, t1170;
  double tv3sigma39;

  double t1175, t1181, t1186, t1189, t1192, t1196, t1201, t1212;
  double t1220, t1223, t1229, t1232, t1238, t1240, t1242, t1244;
  double t1245, t1251, t1257, t1258, t1261, t1265, t1274, t1278;
  double t1281, t1285, t1289, t1291, t1292, t1293, t1295, t1296;
  double t1302, t1307, t1310, t1314, t1321, t1325, t1329, t1334;
  double t1336, tv4rho40, t1342, t1343, t1345, t1366, t1367, t1369;
  double t1373, t1382, t1389, t1393, t1397, t1398, t1408, t1409;
  double t1426, t1428, t1432, t1439, t1443, t1444, t1447, t1456;
  double t1459, t1460, t1462, t1464, t1465, tv4rho41, t1474, t1478;
  double t1488, t1501, t1505, t1514, t1530, t1531, t1540, t1553;
  double t1557, t1564, t1568, t1577, t1580, t1591, t1594, t1596;
  double t1597, tv4rho42, t1618, t1622, t1629, t1640, t1641, t1658;
  double t1662, t1669, t1677, t1686, t1696, t1698, t1699, tv4rho43;
  double t1704, t1709, t1716, t1720, t1729, t1732, t1738, t1743;
  double t1746, t1749, t1753, t1758, t1769, t1782, t1787, t1794;
  double t1798, t1814, t1815, tv4rho44, t1823, t1829, t1832, t1839;
  double t1841, t1844, t1849, t1853, t1856, t1879, tv4rho3sigma0, tv4rho3sigma1;
  double t1886, t1889, t1893, t1895, tv4rho3sigma2, t1897, t1903, t1908;
  double t1912, t1921, t1922, tv4rho3sigma3, tv4rho3sigma4, t1924, t1930, t1932;
  double t1941, t1943, t1946, tv4rho3sigma5, t1952, t1961, tv4rho3sigma6, tv4rho3sigma7;
  double t1967, t1974, t1982, t1984, t1985, tv4rho3sigma8, t1994, tv4rho3sigma9;
  double tv4rho3sigma10, t2014, t2018, t2021, t2044, tv4rho3sigma11, t2051, t2058;
  double t2060, t2065, t2068, t2089, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t2096, t2100, t2102, tv4rho2sigma25, t2108, t2116, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2122, t2129, t2132, tv4rho2sigma211;
  double t2140, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2154, t2157;
  double t2178, tv4rho2sigma217, t2185, t2188, t2189, t2208, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2215;
  double t2217, tv4rhosigma39, t2223, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2230, t2231, t2250, tv4rhosigma319;
  double t2252, t2268, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t2269, t2285, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = exp(-0.20125e-2 * t40);
  t47 = exp(-0.100625e-2 * t40);
  t49 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t39 * t42 - 0.1245e1 * t47;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = -t16;
  t57 = my_piecewise5(t14, t11, t10, t15, t55 * t7);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t22, t60 * t58);
  t63 = t62 * t26;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t69 = sigma[2] * t68;
  t70 = t33 * t69;
  t72 = exp(-0.20125e-2 * t70);
  t77 = exp(-0.100625e-2 * t70);
  t79 = 0.2245e1 + 0.25708333333333333333e-2 * t33 * t69 * t72 - 0.1245e1 * t77;
  t83 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t79);
  tzk0 = t53 + t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = t6 * t6;
  t85 = 0.1e1 / t84;
  t86 = t16 * t85;
  t88 = my_piecewise5(t10, 0, t14, 0, t7 - t86);
  t91 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t88);
  t92 = t91 * t26;
  t96 = t26 * t26;
  t97 = 0.1e1 / t96;
  t98 = t25 * t97;
  t101 = t5 * t98 * t49 / 0.8e1;
  t102 = t34 * rho[0];
  t104 = 0.1e1 / t36 / t102;
  t105 = sigma[0] * t104;
  t109 = t28 * t28;
  t112 = t109 / t30 / t29;
  t113 = sigma[0] * sigma[0];
  t114 = t34 * t34;
  t115 = t114 * t34;
  t117 = 0.1e1 / t35 / t115;
  t125 = -0.68555555555555555555e-2 * t33 * t105 * t42 + 0.13796805555555555555e-4 * t112 * t113 * t117 * t42 - 0.334075e-2 * t33 * t105 * t47;
  t130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t49 - t101 - 0.3e1 / 0.8e1 * t5 * t27 * t125);
  t131 = t55 * t85;
  t133 = my_piecewise5(t14, 0, t10, 0, -t7 - t131);
  t136 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t133);
  t137 = t136 * t26;
  t141 = t62 * t97;
  t144 = t5 * t141 * t79 / 0.8e1;
  t146 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t79 - t144);
  tvrho0 = t53 + t83 + t6 * (t130 + t146);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = my_piecewise5(t10, 0, t14, 0, -t7 - t86);
  t153 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t150);
  t154 = t153 * t26;
  t159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t49 - t101);
  t161 = my_piecewise5(t14, 0, t10, 0, t7 - t131);
  t164 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t161);
  t165 = t164 * t26;
  t169 = t64 * rho[1];
  t171 = 0.1e1 / t66 / t169;
  t172 = sigma[2] * t171;
  t176 = sigma[2] * sigma[2];
  t177 = t64 * t64;
  t178 = t177 * t64;
  t180 = 0.1e1 / t65 / t178;
  t188 = -0.68555555555555555555e-2 * t33 * t172 * t72 + 0.13796805555555555555e-4 * t112 * t176 * t180 * t72 - 0.334075e-2 * t33 * t172 * t77;
  t193 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t79 - t144 - 0.3e1 / 0.8e1 * t5 * t63 * t188);
  tvrho1 = t53 + t83 + t6 * (t159 + t193);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t199 = t114 * rho[0];
  t201 = 0.1e1 / t35 / t199;
  t209 = 0.25708333333333333333e-2 * t33 * t38 * t42 - 0.51738020833333333333e-5 * t112 * sigma[0] * t201 * t42 + 0.125278125e-2 * t33 * t38 * t47;
  t213 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t209);
  tvsigma0 = t6 * t213;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t217 = t177 * rho[1];
  t219 = 0.1e1 / t65 / t217;
  t227 = 0.25708333333333333333e-2 * t33 * t68 * t72 - 0.51738020833333333333e-5 * t112 * sigma[2] * t219 * t72 + 0.125278125e-2 * t33 * t68 * t77;
  t231 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t227);
  tvsigma2 = t6 * t231;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t234 = t23 * t23;
  t235 = 0.1e1 / t234;
  t236 = t88 * t88;
  t239 = t84 * t6;
  t240 = 0.1e1 / t239;
  t241 = t16 * t240;
  t244 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t85 + 0.2e1 * t241);
  t248 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t236 + 0.4e1 / 0.3e1 * t23 * t244);
  t249 = t248 * t26;
  t253 = t91 * t97;
  t255 = t5 * t253 * t49;
  t261 = 0.1e1 / t96 / t6;
  t262 = t25 * t261;
  t265 = t5 * t262 * t49 / 0.12e2;
  t267 = t5 * t98 * t125;
  t270 = 0.1e1 / t36 / t114;
  t271 = sigma[0] * t270;
  t275 = t114 * t102;
  t277 = 0.1e1 / t35 / t275;
  t278 = t113 * t277;
  t282 = t113 * sigma[0];
  t283 = t114 * t114;
  t284 = t283 * t34;
  t285 = 0.1e1 / t284;
  t295 = 0.25137037037037037037e-1 * t33 * t271 * t42 - 0.12417125e-3 * t112 * t278 * t42 + 0.4560735904350167404e-8 * t282 * t285 * t42 + 0.12249416666666666667e-1 * t33 * t271 * t47 - 0.89643458333333333332e-5 * t112 * t278 * t47;
  t300 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t49 - t255 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t125 + t265 - t267 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t295);
  t301 = t60 * t60;
  t302 = 0.1e1 / t301;
  t303 = t133 * t133;
  t306 = t55 * t240;
  t309 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t85 + 0.2e1 * t306);
  t313 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t303 + 0.4e1 / 0.3e1 * t60 * t309);
  t314 = t313 * t26;
  t318 = t136 * t97;
  t320 = t5 * t318 * t79;
  t322 = t62 * t261;
  t325 = t5 * t322 * t79 / 0.12e2;
  t327 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t79 - t320 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t130 + 0.2e1 * t146 + t6 * (t300 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t235 * t150;
  t334 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t241);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t88 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t338 * t26;
  t343 = t153 * t97;
  t345 = t5 * t343 * t49;
  t353 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t49 - t345 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t125 - t255 / 0.8e1 + t265 - t267 / 0.8e1);
  t354 = t302 * t161;
  t358 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t306);
  t362 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t354 * t133 + 0.4e1 / 0.3e1 * t60 * t358);
  t363 = t362 * t26;
  t367 = t164 * t97;
  t369 = t5 * t367 * t79;
  t376 = t5 * t141 * t188;
  t379 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t79 - t369 / 0.8e1 - t320 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t5 * t137 * t188 - t376 / 0.8e1);
  tv2rho21 = t130 + t146 + t159 + t193 + t6 * (t353 + t379);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t384 = t150 * t150;
  t389 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t85 + 0.2e1 * t241);
  t393 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t235 * t384 + 0.4e1 / 0.3e1 * t23 * t389);
  t394 = t393 * t26;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t49 - t345 / 0.4e1 + t265);
  t401 = t161 * t161;
  t406 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t85 + 0.2e1 * t306);
  t410 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t302 * t401 + 0.4e1 / 0.3e1 * t60 * t406);
  t411 = t410 * t26;
  t421 = 0.1e1 / t66 / t177;
  t422 = sigma[2] * t421;
  t426 = t177 * t169;
  t428 = 0.1e1 / t65 / t426;
  t429 = t176 * t428;
  t433 = t176 * sigma[2];
  t434 = t177 * t177;
  t435 = t434 * t64;
  t436 = 0.1e1 / t435;
  t446 = 0.25137037037037037037e-1 * t33 * t422 * t72 - 0.12417125e-3 * t112 * t429 * t72 + 0.4560735904350167404e-8 * t433 * t436 * t72 + 0.12249416666666666667e-1 * t33 * t422 * t77 - 0.89643458333333333332e-5 * t112 * t429 * t77;
  t451 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t79 - t369 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t188 + t325 - t376 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t446);
  tv2rho22 = 0.2e1 * t159 + 0.2e1 * t193 + t6 * (t400 + t451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t459 = t5 * t98 * t209 / 0.8e1;
  t463 = t117 * sigma[0];
  t467 = t283 * rho[0];
  t468 = 0.1e1 / t467;
  t478 = -0.68555555555555555555e-2 * t33 * t104 * t42 + 0.41390416666666666666e-4 * t112 * t463 * t42 - 0.17102759641313127765e-8 * t113 * t468 * t42 - 0.334075e-2 * t33 * t104 * t47 + 0.33616296875e-5 * t112 * t463 * t47;
  t483 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t209 - t459 - 0.3e1 / 0.8e1 * t5 * t27 * t478);
  tv2rhosigma0 = t483 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t490 = t5 * t141 * t227 / 0.8e1;
  t492 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t227 - t490);
  tv2rhosigma2 = t492 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t498 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t209 - t459);
  tv2rhosigma3 = t498 * t6 + t213;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t506 = t180 * sigma[2];
  t510 = t434 * rho[1];
  t511 = 0.1e1 / t510;
  t521 = -0.68555555555555555555e-2 * t33 * t171 * t72 + 0.41390416666666666666e-4 * t112 * t506 * t72 - 0.17102759641313127765e-8 * t176 * t511 * t72 - 0.334075e-2 * t33 * t171 * t77 + 0.33616296875e-5 * t112 * t506 * t77;
  t526 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t227 - t490 - 0.3e1 / 0.8e1 * t5 * t63 * t521);
  tv2rhosigma5 = t526 * t6 + t231;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t531 = 0.1e1 / t283;
  t538 = -0.10347604166666666667e-4 * t112 * t201 * t42 + 0.64135348654924229118e-9 * sigma[0] * t531 * t42 - 0.12606111328125e-5 * t112 * t201 * t47;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t538);
  tv2sigma20 = t6 * t542;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t546 = 0.1e1 / t434;
  t553 = -0.10347604166666666667e-4 * t112 * t219 * t72 + 0.64135348654924229118e-9 * sigma[2] * t546 * t72 - 0.12606111328125e-5 * t112 * t219 * t77;
  t557 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t553);
  tv2sigma25 = t6 * t557;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t561 = 0.1e1 / t234 / t19;
  t562 = t236 * t88;
  t565 = t235 * t88;
  t568 = t84 * t84;
  t569 = 0.1e1 / t568;
  t570 = t16 * t569;
  t573 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t240 - 0.6e1 * t570);
  t577 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t562 + 0.4e1 / 0.3e1 * t565 * t244 + 0.4e1 / 0.3e1 * t23 * t573);
  t578 = t577 * t26;
  t582 = t248 * t97;
  t584 = t5 * t582 * t49;
  t589 = t91 * t261;
  t591 = t5 * t589 * t49;
  t594 = t5 * t253 * t125;
  t600 = 0.1e1 / t96 / t84;
  t601 = t25 * t600;
  t604 = 0.5e1 / 0.36e2 * t5 * t601 * t49;
  t606 = t5 * t262 * t125;
  t609 = t5 * t98 * t295;
  t612 = 0.1e1 / t36 / t199;
  t613 = sigma[0] * t612;
  t618 = 0.1e1 / t35 / t283;
  t619 = t113 * t618;
  t623 = t283 * t102;
  t624 = 0.1e1 / t623;
  t625 = t282 * t624;
  t628 = t113 * t113;
  t629 = t283 * t199;
  t631 = 0.1e1 / t36 / t629;
  t633 = t33 * t42;
  t644 = -0.11730617283950617284e0 * t33 * t613 * t42 + 0.10454912654320987654e-2 * t112 * t619 * t42 - 0.86653982182653180677e-7 * t625 * t42 + 0.24475949353345898402e-10 * t628 * t631 * t633 - 0.57163944444444444446e-1 * t33 * t613 * t47 + 0.98607804166666666666e-4 * t112 * t619 * t47 - 0.14816478255226406893e-8 * t625 * t47;
  t649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t578 * t49 - 0.3e1 / 0.8e1 * t584 - 0.9e1 / 0.8e1 * t5 * t249 * t125 + t591 / 0.4e1 - 0.3e1 / 0.4e1 * t594 - 0.9e1 / 0.8e1 * t5 * t92 * t295 - t604 + t606 / 0.4e1 - 0.3e1 / 0.8e1 * t609 - 0.3e1 / 0.8e1 * t5 * t27 * t644);
  t651 = 0.1e1 / t301 / t58;
  t652 = t303 * t133;
  t655 = t302 * t133;
  t658 = t55 * t569;
  t661 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t240 - 0.6e1 * t658);
  t665 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t652 + 0.4e1 / 0.3e1 * t655 * t309 + 0.4e1 / 0.3e1 * t60 * t661);
  t666 = t665 * t26;
  t670 = t313 * t97;
  t672 = t5 * t670 * t79;
  t674 = t136 * t261;
  t676 = t5 * t674 * t79;
  t678 = t62 * t600;
  t681 = 0.5e1 / 0.36e2 * t5 * t678 * t79;
  t683 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t666 * t79 - 0.3e1 / 0.8e1 * t672 + t676 / 0.4e1 - t681);
  tv3rho30 = 0.3e1 * t300 + 0.3e1 * t327 + t6 * (t649 + t683);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t686 = 0.2e1 * t353;
  t687 = 0.2e1 * t379;
  t688 = t561 * t150;
  t691 = t235 * t334;
  t696 = 0.2e1 * t240;
  t697 = 0.6e1 * t570;
  t699 = my_piecewise5(t10, 0, t14, 0, t696 - t697);
  t703 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t688 * t236 + 0.8e1 / 0.9e1 * t691 * t88 + 0.4e1 / 0.9e1 * t330 * t244 + 0.4e1 / 0.3e1 * t23 * t699);
  t704 = t703 * t26;
  t708 = t338 * t97;
  t711 = t5 * t708 * t49 / 0.4e1;
  t715 = t153 * t261;
  t717 = t5 * t715 * t49;
  t721 = t5 * t343 * t125 / 0.4e1;
  t730 = -0.3e1 / 0.8e1 * t5 * t704 * t49 - t711 - 0.3e1 / 0.4e1 * t5 * t339 * t125 + t717 / 0.12e2 - t721 - 0.3e1 / 0.8e1 * t5 * t154 * t295 - t584 / 0.8e1 + t591 / 0.6e1 - t594 / 0.4e1 - t604 + t606 / 0.6e1 - t609 / 0.8e1;
  t731 = my_piecewise3(t1, 0, t730);
  t732 = t651 * t161;
  t735 = t302 * t358;
  t740 = 0.6e1 * t658;
  t742 = my_piecewise5(t14, 0, t10, 0, -t696 - t740);
  t746 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t732 * t303 + 0.8e1 / 0.9e1 * t735 * t133 + 0.4e1 / 0.9e1 * t354 * t309 + 0.4e1 / 0.3e1 * t60 * t742);
  t747 = t746 * t26;
  t751 = t362 * t97;
  t754 = t5 * t751 * t79 / 0.4e1;
  t755 = t164 * t261;
  t757 = t5 * t755 * t79;
  t766 = t5 * t318 * t188 / 0.4e1;
  t768 = t5 * t322 * t188;
  t771 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t747 * t79 - t754 + t757 / 0.12e2 - t672 / 0.8e1 + t676 / 0.6e1 - t681 - 0.3e1 / 0.8e1 * t5 * t314 * t188 - t766 + t768 / 0.12e2);
  tv3rho31 = t300 + t327 + t686 + t687 + t6 * (t731 + t771);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t774 = t561 * t384;
  t779 = t235 * t389;
  t783 = my_piecewise5(t10, 0, t14, 0, -t696 - t697);
  t787 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t774 * t88 + 0.8e1 / 0.9e1 * t330 * t334 + 0.4e1 / 0.9e1 * t779 * t88 + 0.4e1 / 0.3e1 * t23 * t783);
  t788 = t787 * t26;
  t792 = t393 * t97;
  t794 = t5 * t792 * t49;
  t803 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t788 * t49 - t794 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t394 * t125 - t711 + t717 / 0.6e1 - t721 + t591 / 0.12e2 - t604 + t606 / 0.12e2);
  t804 = t651 * t401;
  t809 = t302 * t406;
  t813 = my_piecewise5(t14, 0, t10, 0, t696 - t740);
  t817 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t804 * t133 + 0.8e1 / 0.9e1 * t354 * t358 + 0.4e1 / 0.9e1 * t809 * t133 + 0.4e1 / 0.3e1 * t60 * t813);
  t818 = t817 * t26;
  t822 = t410 * t97;
  t824 = t5 * t822 * t79;
  t831 = t5 * t367 * t188;
  t839 = t5 * t141 * t446;
  t841 = -0.3e1 / 0.8e1 * t5 * t818 * t79 - t824 / 0.8e1 - t754 + t757 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t363 * t188 - t831 / 0.4e1 + t676 / 0.12e2 - t681 - t766 + t768 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t137 * t446 - t839 / 0.8e1;
  t842 = my_piecewise3(t54, 0, t841);
  tv3rho32 = t686 + t687 + t400 + t451 + t6 * (t803 + t842);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t847 = t384 * t150;
  t854 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t240 - 0.6e1 * t570);
  t858 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t561 * t847 + 0.4e1 / 0.3e1 * t330 * t389 + 0.4e1 / 0.3e1 * t23 * t854);
  t859 = t858 * t26;
  t866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t859 * t49 - 0.3e1 / 0.8e1 * t794 + t717 / 0.4e1 - t604);
  t867 = t401 * t161;
  t874 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t240 - 0.6e1 * t658);
  t878 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t651 * t867 + 0.4e1 / 0.3e1 * t354 * t406 + 0.4e1 / 0.3e1 * t60 * t874);
  t879 = t878 * t26;
  t895 = 0.1e1 / t66 / t217;
  t896 = sigma[2] * t895;
  t901 = 0.1e1 / t65 / t434;
  t902 = t176 * t901;
  t906 = t434 * t169;
  t907 = 0.1e1 / t906;
  t908 = t433 * t907;
  t911 = t176 * t176;
  t912 = t434 * t217;
  t914 = 0.1e1 / t66 / t912;
  t916 = t33 * t72;
  t927 = -0.11730617283950617284e0 * t33 * t896 * t72 + 0.10454912654320987654e-2 * t112 * t902 * t72 - 0.86653982182653180677e-7 * t908 * t72 + 0.24475949353345898402e-10 * t911 * t914 * t916 - 0.57163944444444444446e-1 * t33 * t896 * t77 + 0.98607804166666666666e-4 * t112 * t902 * t77 - 0.14816478255226406893e-8 * t908 * t77;
  t932 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t879 * t79 - 0.3e1 / 0.8e1 * t824 - 0.9e1 / 0.8e1 * t5 * t411 * t188 + t757 / 0.4e1 - 0.3e1 / 0.4e1 * t831 - 0.9e1 / 0.8e1 * t5 * t165 * t446 - t681 + t768 / 0.4e1 - 0.3e1 / 0.8e1 * t839 - 0.3e1 / 0.8e1 * t5 * t63 * t927);
  tv3rho33 = 0.3e1 * t400 + 0.3e1 * t451 + t6 * (t866 + t932);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t940 = t5 * t253 * t209;
  t947 = t5 * t262 * t209 / 0.12e2;
  t949 = t5 * t98 * t478;
  t954 = t277 * sigma[0];
  t958 = t285 * t113;
  t961 = t283 * t114;
  t963 = 0.1e1 / t36 / t961;
  t975 = 0.25137037037037037037e-1 * t33 * t270 * t42 - 0.29893078703703703703e-3 * t112 * t954 * t42 + 0.290746913902323172e-7 * t958 * t42 - 0.91784810075047119006e-11 * t282 * t963 * t633 + 0.12249416666666666667e-1 * t33 * t270 * t47 - 0.302546671875e-4 * t112 * t954 * t47 + 0.5556179345709902585e-9 * t958 * t47;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t209 - t940 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t478 + t947 - t949 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  tv3rho2sigma0 = t6 * t980 + 0.2e1 * t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t987 = t5 * t318 * t227;
  t991 = t5 * t322 * t227 / 0.12e2;
  t993 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t227 - t987 / 0.4e1 + t991);
  tv3rho2sigma2 = t6 * t993 + 0.2e1 * t492;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t999 = t5 * t343 * t209;
  t1007 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t209 - t999 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t478 - t940 / 0.8e1 + t947 - t949 / 0.8e1);
  tv3rho2sigma3 = t1007 * t6 + t483 + t498;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1013 = t5 * t367 * t227;
  t1020 = t5 * t141 * t521;
  t1023 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t227 - t1013 / 0.8e1 - t987 / 0.8e1 + t991 - 0.3e1 / 0.8e1 * t5 * t137 * t521 - t1020 / 0.8e1);
  tv3rho2sigma5 = t1023 * t6 + t492 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t209 - t999 / 0.4e1 + t947);
  tv3rho2sigma6 = t1031 * t6 + 0.2e1 * t498;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1045 = t428 * sigma[2];
  t1049 = t436 * t176;
  t1052 = t434 * t177;
  t1054 = 0.1e1 / t66 / t1052;
  t1066 = 0.25137037037037037037e-1 * t33 * t421 * t72 - 0.29893078703703703703e-3 * t112 * t1045 * t72 + 0.290746913902323172e-7 * t1049 * t72 - 0.91784810075047119006e-11 * t433 * t1054 * t916 + 0.12249416666666666667e-1 * t33 * t421 * t77 - 0.302546671875e-4 * t112 * t1045 * t77 + 0.5556179345709902585e-9 * t1049 * t77;
  t1071 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t227 - t1013 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t521 + t991 - t1020 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * t1066);
  tv3rho2sigma8 = t1071 * t6 + 0.2e1 * t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1078 = t5 * t98 * t538 / 0.8e1;
  t1082 = t468 * sigma[0];
  t1086 = 0.1e1 / t36 / t623;
  t1095 = 0.55187222222222222224e-4 * t112 * t117 * t42 - 0.85513798206565638826e-8 * t1082 * t42 + 0.34419303778142669627e-11 * t113 * t1086 * t633 + 0.6723259375e-5 * t112 * t117 * t47 - 0.20835672546412134694e-9 * t1082 * t47;
  t1100 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t538 - t1078 - 0.3e1 / 0.8e1 * t5 * t27 * t1095);
  tv3rhosigma20 = t1100 * t6 + t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1107 = t5 * t141 * t553 / 0.8e1;
  t1109 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t553 - t1107);
  tv3rhosigma25 = t1109 * t6 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1115 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t538 - t1078);
  tv3rhosigma26 = t1115 * t6 + t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1123 = t511 * sigma[2];
  t1127 = 0.1e1 / t66 / t906;
  t1136 = 0.55187222222222222224e-4 * t112 * t180 * t72 - 0.85513798206565638826e-8 * t1123 * t72 + 0.34419303778142669627e-11 * t176 * t1127 * t916 + 0.6723259375e-5 * t112 * t180 * t77 - 0.20835672546412134694e-9 * t1123 * t77;
  t1141 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t553 - t1107 - 0.3e1 / 0.8e1 * t5 * t63 * t1136);
  tv3rhosigma211 = t1141 * t6 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1146 = 0.1e1 / t36 / t284;
  t1152 = 0.19240604596477268736e-8 * t531 * t42 - 0.1290723891680350111e-11 * sigma[0] * t1146 * t633 + 0.78133772049045505101e-10 * t531 * t47;
  t1156 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1152);
  tv3sigma30 = t6 * t1156;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1160 = 0.1e1 / t66 / t435;
  t1166 = 0.19240604596477268736e-8 * t546 * t72 - 0.1290723891680350111e-11 * sigma[2] * t1160 * t916 + 0.78133772049045505101e-10 * t546 * t77;
  t1170 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * t1166);
  tv3sigma39 = t6 * t1170;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1175 = sigma[0] / t36 / t115;
  t1181 = t113 / t35 / t467;
  t1186 = t282 / t961;
  t1189 = t283 * t115;
  t1192 = t628 / t36 / t1189;
  t1196 = t283 * t283;
  t1201 = t112 * t42;
  t1212 = t33 * t47;
  t1220 = t5 * t262 * t295;
  t1223 = t5 * t98 * t644;
  t1229 = t5 * t601 * t125;
  t1232 = t5 * t582 * t125;
  t1238 = t5 * t589 * t125;
  t1240 = t5 * t253 * t295;
  t1242 = t19 * t19;
  t1244 = 0.1e1 / t234 / t1242;
  t1245 = t236 * t236;
  t1251 = t244 * t244;
  t1257 = 0.1e1 / t568 / t6;
  t1258 = t16 * t1257;
  t1261 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t569 + 0.24e2 * t1258);
  t1265 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1244 * t1245 - 0.16e2 / 0.9e1 * t561 * t236 * t244 + 0.4e1 / 0.3e1 * t235 * t1251 + 0.16e2 / 0.9e1 * t565 * t573 + 0.4e1 / 0.3e1 * t23 * t1261);
  t1274 = 0.1e1 / t96 / t239;
  t1278 = 0.1e2 / 0.27e2 * t5 * t25 * t1274 * t49;
  t1281 = t5 * t577 * t97 * t49;
  t1285 = t5 * t248 * t261 * t49;
  t1289 = t5 * t91 * t600 * t49;
  t1291 = -0.3e1 / 0.8e1 * t5 * t27 * (0.66473497942386831276e0 * t33 * t1175 * t42 - 0.93419703395061728392e-2 * t112 * t1181 * t42 + 0.12987962358721643396e-5 * t1186 * t42 - 0.79954767887596601447e-9 * t1192 * t633 + 0.13135426152962298809e-12 * t628 * sigma[0] / t35 / t1196 / rho[0] * t1201 + 0.32392901851851851853e0 * t33 * t1175 * t47 - 0.97512161898148148147e-3 * t112 * t1181 * t47 + 0.32596252161498095165e-7 * t1186 * t47 - 0.39757549984857525162e-11 * t1192 * t1212) + t1220 / 0.2e1 - t1223 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t92 * t644 - 0.5e1 / 0.9e1 * t1229 - 0.3e1 / 0.2e1 * t1232 - 0.9e1 / 0.4e1 * t5 * t249 * t295 + t1238 - 0.3e1 / 0.2e1 * t1240 - 0.3e1 / 0.8e1 * t5 * t1265 * t26 * t49 - 0.3e1 / 0.2e1 * t5 * t578 * t125 + t1278 - t1281 / 0.2e1 + t1285 / 0.2e1 - 0.5e1 / 0.9e1 * t1289;
  t1292 = my_piecewise3(t1, 0, t1291);
  t1293 = t58 * t58;
  t1295 = 0.1e1 / t301 / t1293;
  t1296 = t303 * t303;
  t1302 = t309 * t309;
  t1307 = t55 * t1257;
  t1310 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t569 + 0.24e2 * t1307);
  t1314 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t1295 * t1296 - 0.16e2 / 0.9e1 * t651 * t303 * t309 + 0.4e1 / 0.3e1 * t302 * t1302 + 0.16e2 / 0.9e1 * t655 * t661 + 0.4e1 / 0.3e1 * t60 * t1310);
  t1321 = t5 * t665 * t97 * t79;
  t1325 = t5 * t313 * t261 * t79;
  t1329 = t5 * t136 * t600 * t79;
  t1334 = 0.1e2 / 0.27e2 * t5 * t62 * t1274 * t79;
  t1336 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t1314 * t26 * t79 - t1321 / 0.2e1 + t1325 / 0.2e1 - 0.5e1 / 0.9e1 * t1329 + t1334);
  tv4rho40 = 0.4e1 * t649 + 0.4e1 * t683 + t6 * (t1292 + t1336);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1342 = t5 * t715 * t125;
  t1343 = t1342 / 0.4e1;
  t1345 = t5 * t343 * t295;
  t1366 = 0.12e2 * t569;
  t1367 = 0.24e2 * t1258;
  t1369 = my_piecewise5(t10, 0, t14, 0, -t1366 + t1367);
  t1373 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1244 * t150 * t562 - 0.8e1 / 0.9e1 * t561 * t334 * t236 - 0.8e1 / 0.9e1 * t688 * t88 * t244 + 0.4e1 / 0.3e1 * t235 * t699 * t88 + 0.4e1 / 0.3e1 * t691 * t244 + 0.4e1 / 0.9e1 * t330 * t573 + 0.4e1 / 0.3e1 * t23 * t1369);
  t1382 = t5 * t708 * t125;
  t1389 = t5 * t153 * t600 * t49;
  t1393 = t5 * t703 * t97 * t49;
  t1397 = t5 * t338 * t261 * t49;
  t1398 = t1397 / 0.4e1;
  t1408 = t1343 - 0.3e1 / 0.8e1 * t1345 - 0.3e1 / 0.8e1 * t5 * t154 * t644 - 0.3e1 / 0.8e1 * t5 * t1373 * t26 * t49 - 0.9e1 / 0.8e1 * t5 * t704 * t125 - 0.3e1 / 0.4e1 * t1382 - 0.9e1 / 0.8e1 * t5 * t339 * t295 - 0.5e1 / 0.36e2 * t1389 - 0.3e1 / 0.8e1 * t1393 + t1398 + t1220 / 0.4e1 - t1223 / 0.8e1 - 0.5e1 / 0.12e2 * t1229 - 0.3e1 / 0.8e1 * t1232 + t1238 / 0.2e1 - 0.3e1 / 0.8e1 * t1240 + t1278 - t1281 / 0.8e1 + t1285 / 0.4e1 - 0.5e1 / 0.12e2 * t1289;
  t1409 = my_piecewise3(t1, 0, t1408);
  t1426 = 0.24e2 * t1307;
  t1428 = my_piecewise5(t14, 0, t10, 0, t1366 + t1426);
  t1432 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t1295 * t161 * t652 - 0.8e1 / 0.9e1 * t651 * t358 * t303 - 0.8e1 / 0.9e1 * t732 * t133 * t309 + 0.4e1 / 0.3e1 * t302 * t742 * t133 + 0.4e1 / 0.3e1 * t735 * t309 + 0.4e1 / 0.9e1 * t354 * t661 + 0.4e1 / 0.3e1 * t60 * t1428);
  t1439 = t5 * t746 * t97 * t79;
  t1443 = t5 * t362 * t261 * t79;
  t1444 = t1443 / 0.4e1;
  t1447 = t5 * t164 * t600 * t79;
  t1456 = t5 * t670 * t188;
  t1459 = t5 * t674 * t188;
  t1460 = t1459 / 0.4e1;
  t1462 = t5 * t678 * t188;
  t1464 = -0.3e1 / 0.8e1 * t5 * t1432 * t26 * t79 - 0.3e1 / 0.8e1 * t1439 + t1444 - 0.5e1 / 0.36e2 * t1447 - t1321 / 0.8e1 + t1325 / 0.4e1 - 0.5e1 / 0.12e2 * t1329 + t1334 - 0.3e1 / 0.8e1 * t5 * t666 * t188 - 0.3e1 / 0.8e1 * t1456 + t1460 - 0.5e1 / 0.36e2 * t1462;
  t1465 = my_piecewise3(t54, 0, t1464);
  tv4rho41 = t649 + t683 + 0.3e1 * t731 + 0.3e1 * t771 + t6 * (t1409 + t1465);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1474 = t5 * t787 * t97 * t49;
  t1478 = t5 * t393 * t261 * t49;
  t1488 = t334 * t334;
  t1501 = my_piecewise5(t10, 0, t14, 0, t1367);
  t1505 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1244 * t384 * t236 - 0.32e2 / 0.27e2 * t688 * t88 * t334 - 0.8e1 / 0.27e2 * t774 * t244 + 0.8e1 / 0.9e1 * t235 * t1488 + 0.8e1 / 0.9e1 * t330 * t699 - 0.8e1 / 0.27e2 * t561 * t389 * t236 + 0.8e1 / 0.9e1 * t235 * t783 * t88 + 0.4e1 / 0.9e1 * t779 * t244 + 0.4e1 / 0.3e1 * t23 * t1501);
  t1514 = t5 * t792 * t125;
  t1530 = -t1474 / 0.4e1 + t1478 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1505 * t26 * t49 - 0.3e1 / 0.4e1 * t5 * t788 * t125 - t1514 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t394 * t295 + t1342 / 0.3e1 - t1345 / 0.4e1 - t1382 / 0.2e1 - 0.5e1 / 0.18e2 * t1389 - t1393 / 0.4e1 + t1397 / 0.3e1 + t1220 / 0.12e2 - 0.5e1 / 0.18e2 * t1229 + t1238 / 0.6e1 + t1278 + t1285 / 0.12e2 - 0.5e1 / 0.18e2 * t1289;
  t1531 = my_piecewise3(t1, 0, t1530);
  t1540 = t358 * t358;
  t1553 = my_piecewise5(t14, 0, t10, 0, t1426);
  t1557 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t1295 * t401 * t303 - 0.32e2 / 0.27e2 * t732 * t133 * t358 - 0.8e1 / 0.27e2 * t804 * t309 + 0.8e1 / 0.9e1 * t302 * t1540 + 0.8e1 / 0.9e1 * t354 * t742 - 0.8e1 / 0.27e2 * t651 * t406 * t303 + 0.8e1 / 0.9e1 * t302 * t813 * t133 + 0.4e1 / 0.9e1 * t809 * t309 + 0.4e1 / 0.3e1 * t60 * t1553);
  t1564 = t5 * t817 * t97 * t79;
  t1568 = t5 * t410 * t261 * t79;
  t1577 = t5 * t751 * t188;
  t1580 = t5 * t755 * t188;
  t1591 = t5 * t318 * t446;
  t1594 = t5 * t322 * t446;
  t1596 = -0.3e1 / 0.8e1 * t5 * t1557 * t26 * t79 - t1564 / 0.4e1 + t1568 / 0.12e2 - t1439 / 0.4e1 + t1443 / 0.3e1 - 0.5e1 / 0.18e2 * t1447 - 0.3e1 / 0.4e1 * t5 * t747 * t188 - t1577 / 0.2e1 + t1580 / 0.6e1 + t1325 / 0.12e2 - 0.5e1 / 0.18e2 * t1329 + t1334 - t1456 / 0.4e1 + t1459 / 0.3e1 - 0.5e1 / 0.18e2 * t1462 - 0.3e1 / 0.8e1 * t5 * t314 * t446 - t1591 / 0.4e1 + t1594 / 0.12e2;
  t1597 = my_piecewise3(t54, 0, t1596);
  tv4rho42 = 0.2e1 * t731 + 0.2e1 * t771 + 0.2e1 * t803 + 0.2e1 * t842 + t6 * (t1531 + t1597);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1618 = my_piecewise5(t10, 0, t14, 0, t1366 + t1367);
  t1622 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1244 * t847 * t88 - 0.8e1 / 0.9e1 * t774 * t334 - 0.8e1 / 0.9e1 * t688 * t389 * t88 + 0.4e1 / 0.3e1 * t691 * t389 + 0.4e1 / 0.3e1 * t330 * t783 + 0.4e1 / 0.9e1 * t235 * t854 * t88 + 0.4e1 / 0.3e1 * t23 * t1618);
  t1629 = t5 * t858 * t97 * t49;
  t1640 = -0.3e1 / 0.8e1 * t5 * t1622 * t26 * t49 - t1629 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t859 * t125 - 0.3e1 / 0.8e1 * t1474 + t1478 / 0.4e1 - 0.3e1 / 0.8e1 * t1514 + t1398 - 0.5e1 / 0.12e2 * t1389 + t1343 - 0.5e1 / 0.36e2 * t1289 + t1278 - 0.5e1 / 0.36e2 * t1229;
  t1641 = my_piecewise3(t1, 0, t1640);
  t1658 = my_piecewise5(t14, 0, t10, 0, -t1366 + t1426);
  t1662 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t1295 * t867 * t133 - 0.8e1 / 0.9e1 * t804 * t358 - 0.8e1 / 0.9e1 * t732 * t406 * t133 + 0.4e1 / 0.3e1 * t735 * t406 + 0.4e1 / 0.3e1 * t354 * t813 + 0.4e1 / 0.9e1 * t302 * t874 * t133 + 0.4e1 / 0.3e1 * t60 * t1658);
  t1669 = t5 * t878 * t97 * t79;
  t1677 = t5 * t822 * t188;
  t1686 = t5 * t367 * t446;
  t1696 = t5 * t141 * t927;
  t1698 = -0.3e1 / 0.8e1 * t5 * t1662 * t26 * t79 - t1669 / 0.8e1 - 0.3e1 / 0.8e1 * t1564 + t1568 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t818 * t188 - 0.3e1 / 0.8e1 * t1677 + t1444 - 0.5e1 / 0.12e2 * t1447 - 0.3e1 / 0.4e1 * t1577 + t1580 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t363 * t446 - 0.3e1 / 0.8e1 * t1686 - 0.5e1 / 0.36e2 * t1329 + t1334 + t1460 - 0.5e1 / 0.12e2 * t1462 - 0.3e1 / 0.8e1 * t1591 + t1594 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t137 * t927 - t1696 / 0.8e1;
  t1699 = my_piecewise3(t54, 0, t1698);
  tv4rho43 = 0.3e1 * t803 + 0.3e1 * t842 + t866 + t932 + t6 * (t1641 + t1699);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1704 = t384 * t384;
  t1709 = t389 * t389;
  t1716 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t569 + 0.24e2 * t1258);
  t1720 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1244 * t1704 - 0.16e2 / 0.9e1 * t774 * t389 + 0.4e1 / 0.3e1 * t235 * t1709 + 0.16e2 / 0.9e1 * t330 * t854 + 0.4e1 / 0.3e1 * t23 * t1716);
  t1729 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1720 * t26 * t49 - t1629 / 0.2e1 + t1478 / 0.2e1 - 0.5e1 / 0.9e1 * t1389 + t1278);
  t1732 = sigma[2] / t66 / t178;
  t1738 = t176 / t65 / t510;
  t1743 = t433 / t1052;
  t1746 = t434 * t178;
  t1749 = t911 / t66 / t1746;
  t1753 = t434 * t434;
  t1758 = t112 * t72;
  t1769 = t33 * t77;
  t1782 = t401 * t401;
  t1787 = t406 * t406;
  t1794 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t569 + 0.24e2 * t1307);
  t1798 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t1295 * t1782 - 0.16e2 / 0.9e1 * t804 * t406 + 0.4e1 / 0.3e1 * t302 * t1787 + 0.16e2 / 0.9e1 * t354 * t874 + 0.4e1 / 0.3e1 * t60 * t1794);
  t1814 = -0.3e1 / 0.8e1 * t5 * t63 * (0.66473497942386831276e0 * t33 * t1732 * t72 - 0.93419703395061728392e-2 * t112 * t1738 * t72 + 0.12987962358721643396e-5 * t1743 * t72 - 0.79954767887596601447e-9 * t1749 * t916 + 0.13135426152962298809e-12 * t911 * sigma[2] / t65 / t1753 / rho[1] * t1758 + 0.32392901851851851853e0 * t33 * t1732 * t77 - 0.97512161898148148147e-3 * t112 * t1738 * t77 + 0.32596252161498095165e-7 * t1743 * t77 - 0.39757549984857525162e-11 * t1749 * t1769) - 0.3e1 / 0.2e1 * t5 * t165 * t927 - 0.9e1 / 0.4e1 * t5 * t411 * t446 - 0.3e1 / 0.8e1 * t5 * t1798 * t26 * t79 - 0.3e1 / 0.2e1 * t5 * t879 * t188 - t1669 / 0.2e1 - 0.3e1 / 0.2e1 * t1677 - 0.3e1 / 0.2e1 * t1686 - t1696 / 0.2e1 + t1594 / 0.2e1 + t1568 / 0.2e1 + t1580 - 0.5e1 / 0.9e1 * t1447 - 0.5e1 / 0.9e1 * t1462 + t1334;
  t1815 = my_piecewise3(t54, 0, t1814);
  tv4rho44 = 0.4e1 * t866 + 0.4e1 * t932 + t6 * (t1729 + t1815);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1823 = t5 * t582 * t209;
  t1829 = t5 * t589 * t209;
  t1832 = t5 * t253 * t478;
  t1839 = 0.5e1 / 0.36e2 * t5 * t601 * t209;
  t1841 = t5 * t262 * t478;
  t1844 = t5 * t98 * t975;
  t1849 = t618 * sigma[0];
  t1853 = t624 * t113;
  t1856 = t631 * t282;
  t1879 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t578 * t209 - 0.3e1 / 0.8e1 * t1823 - 0.9e1 / 0.8e1 * t5 * t249 * t478 + t1829 / 0.4e1 - 0.3e1 / 0.4e1 * t1832 - 0.9e1 / 0.8e1 * t5 * t92 * t975 - t1839 + t1841 / 0.4e1 - 0.3e1 / 0.8e1 * t1844 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.11730617283950617284e0 * t33 * t612 * t42 + 0.23270612037037037037e-2 * t112 * t1849 * t42 - 0.38956285849657679909e-6 * t1853 * t42 + 0.27229493655597311972e-9 * t1856 * t633 - 0.49257848073608620534e-13 * t628 / t35 / t1196 * t1201 - 0.57163944444444444446e-1 * t33 * t612 * t47 + 0.25473682743055555556e-3 * t112 * t1849 * t47 - 0.10556740756848814912e-7 * t1853 * t47 + 0.14909081244321571936e-11 * t1856 * t1212));
  tv4rho3sigma0 = t1879 * t6 + 0.3e1 * t980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1886 = t5 * t670 * t227;
  t1889 = t5 * t674 * t227;
  t1893 = 0.5e1 / 0.36e2 * t5 * t678 * t227;
  t1895 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t666 * t227 - 0.3e1 / 0.8e1 * t1886 + t1889 / 0.4e1 - t1893);
  tv4rho3sigma2 = t1895 * t6 + 0.3e1 * t993;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1897 = 0.2e1 * t1007;
  t1903 = t5 * t708 * t209 / 0.4e1;
  t1908 = t5 * t715 * t209;
  t1912 = t5 * t343 * t478 / 0.4e1;
  t1921 = -0.3e1 / 0.8e1 * t5 * t704 * t209 - t1903 - 0.3e1 / 0.4e1 * t5 * t339 * t478 + t1908 / 0.12e2 - t1912 - 0.3e1 / 0.8e1 * t5 * t154 * t975 - t1823 / 0.8e1 + t1829 / 0.6e1 - t1832 / 0.4e1 - t1839 + t1841 / 0.6e1 - t1844 / 0.8e1;
  t1922 = my_piecewise3(t1, 0, t1921);
  tv4rho3sigma3 = t1922 * t6 + t1897 + t980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1924 = 0.2e1 * t1023;
  t1930 = t5 * t751 * t227 / 0.4e1;
  t1932 = t5 * t755 * t227;
  t1941 = t5 * t318 * t521 / 0.4e1;
  t1943 = t5 * t322 * t521;
  t1946 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t747 * t227 - t1930 + t1932 / 0.12e2 - t1886 / 0.8e1 + t1889 / 0.6e1 - t1893 - 0.3e1 / 0.8e1 * t5 * t314 * t521 - t1941 + t1943 / 0.12e2);
  tv4rho3sigma5 = t1946 * t6 + t1924 + t993;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1952 = t5 * t792 * t209;
  t1961 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t788 * t209 - t1952 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t394 * t478 - t1903 + t1908 / 0.6e1 - t1912 + t1829 / 0.12e2 - t1839 + t1841 / 0.12e2);
  tv4rho3sigma6 = t1961 * t6 + t1031 + t1897;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1967 = t5 * t822 * t227;
  t1974 = t5 * t367 * t521;
  t1982 = t5 * t141 * t1066;
  t1984 = -0.3e1 / 0.8e1 * t5 * t818 * t227 - t1967 / 0.8e1 - t1930 + t1932 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t363 * t521 - t1974 / 0.4e1 + t1889 / 0.12e2 - t1893 - t1941 + t1943 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t137 * t1066 - t1982 / 0.8e1;
  t1985 = my_piecewise3(t54, 0, t1984);
  tv4rho3sigma8 = t1985 * t6 + t1071 + t1924;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1994 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t859 * t209 - 0.3e1 / 0.8e1 * t1952 + t1908 / 0.4e1 - t1839);
  tv4rho3sigma9 = t1994 * t6 + 0.3e1 * t1031;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2014 = t901 * sigma[2];
  t2018 = t907 * t176;
  t2021 = t914 * t433;
  t2044 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t879 * t227 - 0.3e1 / 0.8e1 * t1967 - 0.9e1 / 0.8e1 * t5 * t411 * t521 + t1932 / 0.4e1 - 0.3e1 / 0.4e1 * t1974 - 0.9e1 / 0.8e1 * t5 * t165 * t1066 - t1893 + t1943 / 0.4e1 - 0.3e1 / 0.8e1 * t1982 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.11730617283950617284e0 * t33 * t895 * t72 + 0.23270612037037037037e-2 * t112 * t2014 * t72 - 0.38956285849657679909e-6 * t2018 * t72 + 0.27229493655597311972e-9 * t2021 * t916 - 0.49257848073608620534e-13 * t911 / t65 / t1753 * t1758 - 0.57163944444444444446e-1 * t33 * t895 * t77 + 0.25473682743055555556e-3 * t112 * t2014 * t77 - 0.10556740756848814912e-7 * t2018 * t77 + 0.14909081244321571936e-11 * t2021 * t1769));
  tv4rho3sigma11 = t2044 * t6 + 0.3e1 * t1071;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2051 = t5 * t253 * t538;
  t2058 = t5 * t262 * t538 / 0.12e2;
  t2060 = t5 * t98 * t1095;
  t2065 = t285 * sigma[0];
  t2068 = t963 * t113;
  t2089 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t249 * t538 - t2051 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t92 * t1095 + t2058 - t2060 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.34951907407407407409e-3 * t112 * t277 * t42 + 0.9520536200330974456e-7 * t2065 * t42 - 0.86048259445356674069e-10 * t2068 * t633 + 0.184716930276032327e-13 * t282 / t35 / t283 / t275 * t1201 - 0.42580642708333333333e-4 * t112 * t277 * t47 + 0.29864463983190726395e-8 * t2065 * t47 - 0.55909054666205894762e-12 * t2068 * t1212));
  tv4rho2sigma20 = t2089 * t6 + 0.2e1 * t1100;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2096 = t5 * t318 * t553;
  t2100 = t5 * t322 * t553 / 0.12e2;
  t2102 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t314 * t553 - t2096 / 0.4e1 + t2100);
  tv4rho2sigma25 = t2102 * t6 + 0.2e1 * t1109;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2108 = t5 * t343 * t538;
  t2116 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t339 * t538 - t2108 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t154 * t1095 - t2051 / 0.8e1 + t2058 - t2060 / 0.8e1);
  tv4rho2sigma26 = t2116 * t6 + t1100 + t1115;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2122 = t5 * t367 * t553;
  t2129 = t5 * t141 * t1136;
  t2132 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t363 * t553 - t2122 / 0.8e1 - t2096 / 0.8e1 + t2100 - 0.3e1 / 0.8e1 * t5 * t137 * t1136 - t2129 / 0.8e1);
  tv4rho2sigma211 = t2132 * t6 + t1109 + t1141;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2140 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t394 * t538 - t2108 / 0.4e1 + t2058);
  tv4rho2sigma212 = t2140 * t6 + 0.2e1 * t1115;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2154 = t436 * sigma[2];
  t2157 = t1054 * t176;
  t2178 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t411 * t553 - t2122 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t1136 + t2100 - t2129 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.34951907407407407409e-3 * t112 * t428 * t72 + 0.9520536200330974456e-7 * t2154 * t72 - 0.86048259445356674069e-10 * t2157 * t916 + 0.184716930276032327e-13 * t433 / t65 / t434 / t426 * t1758 - 0.42580642708333333333e-4 * t112 * t428 * t77 + 0.29864463983190726395e-8 * t2154 * t77 - 0.55909054666205894762e-12 * t2157 * t1769));
  tv4rho2sigma217 = t2178 * t6 + 0.2e1 * t1141;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2185 = t5 * t98 * t1152 / 0.8e1;
  t2188 = t1086 * t28;
  t2189 = t32 * sigma[0];
  t2208 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t92 * t1152 - t2185 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.15392483677181814989e-7 * t468 * t42 + 0.24093512644699868739e-10 * t2188 * t2189 * t42 - 0.69268848853512122624e-14 * t113 / t35 / t1189 * t1201 - 0.62507017639236404081e-9 * t468 * t47 + 0.20965895499827210535e-12 * t2188 * t2189 * t47));
  tv4rhosigma30 = t2208 * t6 + t1156;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2215 = t5 * t141 * t1166 / 0.8e1;
  t2217 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t137 * t1166 - t2215);
  tv4rhosigma39 = t2217 * t6 + t1170;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2223 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t154 * t1152 - t2185);
  tv4rhosigma310 = t2223 * t6 + t1156;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2230 = t1127 * t28;
  t2231 = t32 * sigma[2];
  t2250 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t165 * t1166 - t2215 - 0.3e1 / 0.8e1 * t5 * t63 * (-0.15392483677181814989e-7 * t511 * t72 + 0.24093512644699868739e-10 * t2230 * t2231 * t72 - 0.69268848853512122624e-14 * t176 / t65 / t1746 * t1758 - 0.62507017639236404081e-9 * t511 * t77 + 0.20965895499827210535e-12 * t2230 * t2231 * t77));
  tv4rhosigma319 = t2250 * t6 + t1170;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2252 = t1146 * t28;
  t2268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-0.51628955667214004441e-11 * t2252 * t32 * t42 + 0.25975818320067045984e-14 * sigma[0] / t35 / t629 * t1201 - 0.78622108124352039508e-13 * t2252 * t32 * t47));
  tv4sigma40 = t6 * t2268;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2269 = t1160 * t28;
  t2285 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t63 * (-0.51628955667214004441e-11 * t2269 * t32 * t72 + 0.25975818320067045984e-14 * sigma[2] / t65 / t912 * t1758 - 0.78622108124352039508e-13 * t2269 * t32 * t77));
  tv4sigma414 = t6 * t2285;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

