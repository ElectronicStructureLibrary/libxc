/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_chachiyo.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t319, t323, t325, t326, t327;
  double t328, t329, t330, t332, t339, t340, t341, t348;
  double t352, t353, t363, t364, t365, t366, t368, t372;
  double t377, t384, t389, t390, t391, t394, t395, t400;
  double t401, t402, t403, t406, t407, t408, t409, t412;
  double t415, t416, t417, t420, t421, t424, t427, t430;
  double t438, t440, tv3rho30, t448, t453, t459, t462, t463;
  double t465, t466, t480, t487, t499, t501, t504, t509;
  double t510, t516, t518, t519, t523, t526, t527, t530;
  double t531, t536, t537, t539, t542, t545, t546, t549;
  double t553, t566, t568, tv3rho2sigma0, t575, t578, t583, t586;
  double t589, t590, t592, t595, t598, t613, t629, t630;
  double t634, t643, t644, t645, t648, t651, t652, t653;
  double t656, t659, t662, t664, t667, t674, t677, t679;
  double tv3rhosigma20, t682, t685, t690, t691, t693, t696, t698;
  double t700, t703, t704, t705, t708, t709, t721, t724;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * rho[0];
  t314 = 0.1e1 / t19 / t312;
  t315 = t17 * t314;
  t319 = t72 * t173;
  t323 = t140 * t22;
  t325 = 0.1e1 / t23 / t323;
  t326 = t17 * t325;
  t327 = t80 * t80;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t326 * t329;
  t332 = t46 * t261 * t21;
  t339 = 0.1e1 / t140;
  t340 = t17 * t339;
  t341 = t340 * t41;
  t348 = t134 * t72;
  t352 = 0.1e1 / t23 / t312;
  t353 = sigma[0] * t352;
  t363 = t29 * M_PI;
  t364 = t363 * t261;
  t365 = t140 * t57;
  t366 = 0.1e1 / t365;
  t368 = 0.1e1 / t154 / t38;
  t372 = -0.4928e4 / 0.2187e4 * t21 * t353 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t353 * t155 - 0.1024e4 / 0.59049e5 * t364 * t366 * t368;
  t377 = t78 * t159;
  t384 = t315 * t187;
  t389 = 0.32e2 / 0.27e2 * t315 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t319 * t177 - 0.128e3 / 0.243e3 * t330 * t332 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t341 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t348 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t372 * t47 - t377 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + 0.32e2 / 0.243e3 * t384 * t194 + 0.16e2 / 0.243e3 * t384 * t197;
  t390 = t72 * t81;
  t391 = t171 * t390;
  t394 = t72 * t45;
  t395 = t171 * t394;
  t400 = t326 * t174;
  t401 = t87 * t261;
  t402 = t21 * t68;
  t403 = t401 * t402;
  t406 = t326 * t180;
  t407 = t190 * t261;
  t408 = t21 * t155;
  t409 = t407 * t408;
  t412 = t401 * t408;
  t415 = t326 * t187;
  t416 = t86 * t86;
  t417 = 0.1e1 / t416;
  t420 = t368 * t3 * t20;
  t421 = t417 * t261 * t420;
  t424 = t407 * t420;
  t427 = t401 * t420;
  t430 = t315 * t180;
  t438 = -0.16e2 / 0.81e2 * t391 * t184 - 0.16e2 / 0.243e3 * t395 * t194 - 0.8e1 / 0.243e3 * t395 * t197 - 0.128e3 / 0.729e3 * t400 * t403 - 0.128e3 / 0.2187e4 * t406 * t409 - 0.64e2 / 0.2187e4 * t406 * t412 - 0.128e3 / 0.6561e4 * t415 * t421 - 0.128e3 / 0.6561e4 * t415 * t424 - 0.128e3 / 0.19683e5 * t415 * t427 + 0.32e2 / 0.81e2 * t430 * t184 - 0.43e2 / 0.27e2 * t341 * t83 + 0.5e1 / 0.3e1 * t348 * t83 - t377 * t83;
  t440 = my_piecewise3(t2, 0, t389 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t448 = t232 * t394;
  t453 = t104 * t173;
  t459 = t232 * t390;
  t462 = t17 * t352;
  t463 = t462 * t329;
  t465 = t20 * t32;
  t466 = t46 * t3 * t465;
  t480 = t110 * t159;
  t487 = t134 * t104;
  t499 = 0.1e1 / t323;
  t501 = t368 * t32;
  t504 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t363 * t499 * t501;
  t509 = -0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t448 * t250 + 0.2e1 / 0.243e3 * t448 * t254 - 0.16e2 / 0.81e2 * t171 * t453 * t177 - 0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t459 * t241 + 0.16e2 / 0.81e2 * t463 * t466 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t480 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t487 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t504 * t47;
  t510 = t78 * t217;
  t516 = t462 * t187;
  t518 = t21 * t32;
  t519 = t190 * t368 * t518;
  t523 = t87 * t368 * t518;
  t526 = t104 * t81;
  t527 = t171 * t526;
  t530 = t104 * t45;
  t531 = t171 * t530;
  t536 = t462 * t174;
  t537 = t87 * t3;
  t539 = t537 * t465 * t68;
  t542 = t462 * t180;
  t545 = t20 * t155 * t32;
  t546 = t190 * t3 * t545;
  t549 = t537 * t545;
  t553 = t417 * t368 * t518;
  t566 = -0.2e1 / 0.9e1 * t510 * t90 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.16e2 / 0.2187e4 * t516 * t519 + 0.16e2 / 0.6561e4 * t516 * t523 - 0.16e2 / 0.243e3 * t527 * t184 - 0.16e2 / 0.729e3 * t531 * t194 - 0.8e1 / 0.729e3 * t531 * t197 + 0.16e2 / 0.243e3 * t536 * t539 + 0.16e2 / 0.729e3 * t542 * t546 + 0.8e1 / 0.729e3 * t542 * t549 + 0.16e2 / 0.2187e4 * t516 * t553 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t487 * t83 - 0.2e1 / 0.3e1 * t510 * t83 - t164 * t112 / 0.4e1 + t480 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t509 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t575 = t78 * t272;
  t578 = t110 * t217;
  t583 = t232 * t174;
  t586 = t282 * t319;
  t589 = t17 * t142;
  t590 = t589 * t329;
  t592 = t46 * t99 * t21;
  t595 = t232 * t526;
  t598 = t232 * t530;
  t613 = -t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2 - t575 * t83 / 0.3e1 + t578 * t112 / 0.4e1 - t229 * t293 / 0.16e2 + t583 * t285 / 0.36e2 - t586 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t590 * t592 + 0.4e1 / 0.81e2 * t595 * t241 + 0.4e1 / 0.243e3 * t598 * t250 + 0.2e1 / 0.243e3 * t598 * t254 + t79 * t302 / 0.48e2 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 - t575 * t90 / 0.9e1;
  t629 = t363 * t99;
  t630 = 0.1e1 / t312;
  t634 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t629 * t630 * t368;
  t643 = t589 * t174;
  t644 = t87 * t99;
  t645 = t644 * t402;
  t648 = t282 * t390;
  t651 = t589 * t180;
  t652 = t190 * t99;
  t653 = t652 * t408;
  t656 = t644 * t408;
  t659 = t282 * t394;
  t662 = t589 * t187;
  t664 = t417 * t99 * t420;
  t667 = t652 * t420;
  t674 = t644 * t420;
  t677 = 0.4e1 / 0.27e2 * t232 * t104 * t235 + t578 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t634 * t47 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3 - 0.2e1 / 0.81e2 * t643 * t645 - t648 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t651 * t653 - t651 * t656 / 0.243e3 - t659 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t662 * t664 - 0.2e1 / 0.729e3 * t662 * t667 + t248 * t305 / 0.648e3 - t659 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t662 * t674;
  t679 = my_piecewise3(t2, 0, t613 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t282 * t453;
  t690 = t17 * t59;
  t691 = t690 * t329;
  t693 = t46 * t262 * t21;
  t696 = sigma[0] * sigma[0];
  t698 = 0.1e1 / t32 / t696;
  t700 = t88 * t698 * t68;
  t703 = 0.1e1 / t696;
  t704 = t190 * t703;
  t705 = t704 * t193;
  t708 = t87 * t703;
  t709 = t708 * t183;
  t721 = t339 * t368;
  t724 = t64 * t698 * t34 * t68 / 0.36e2 + t153 * t703 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t363 * t262 * t721;
  t733 = t82 * t698;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 - t685 * t285 / 0.12e2 - t277 * t302 / 0.16e2 + t691 * t693 / 0.36e2 + t111 * t700 / 0.32e2 + t296 * t705 / 0.216e3 + t288 * t709 / 0.72e2 - 0.3e1 / 0.8e1 * t18 * t19 * t724 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t733;
  t737 = t282 * t526;
  t740 = t282 * t530;
  t746 = t46 * t703 * t31;
  t749 = t690 * t174;
  t750 = t87 * t262;
  t751 = t750 * t402;
  t754 = t690 * t180;
  t755 = t190 * t262;
  t756 = t755 * t408;
  t759 = t750 * t408;
  t762 = t690 * t187;
  t764 = t417 * t262 * t420;
  t767 = t755 * t420;
  t770 = t708 * t193;
  t773 = t750 * t420;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t319, t323, t325, t326, t327;
  double t328, t329, t330, t332, t339, t340, t341, t348;
  double t352, t353, t363, t364, t365, t366, t368, t372;
  double t377, t384, t389, t390, t391, t394, t395, t400;
  double t401, t402, t403, t406, t407, t408, t409, t412;
  double t415, t416, t417, t420, t421, t424, t427, t430;
  double t438, t440, tv3rho30, t448, t453, t459, t462, t463;
  double t465, t466, t480, t487, t499, t501, t504, t509;
  double t510, t516, t518, t519, t523, t526, t527, t530;
  double t531, t536, t537, t539, t542, t545, t546, t549;
  double t553, t566, t568, tv3rho2sigma0, t575, t578, t583, t586;
  double t589, t590, t592, t595, t598, t613, t629, t630;
  double t634, t643, t644, t645, t648, t651, t652, t653;
  double t656, t659, t662, t664, t667, t674, t677, t679;
  double tv3rhosigma20, t682, t685, t690, t691, t693, t696, t698;
  double t700, t703, t704, t705, t708, t709, t721, t724;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;

  double t781, t784, t787, t788, t791, t795, t796, t800;
  double t801, t803, t804, t805, t806, t810, t814, t818;
  double t820, t822, t823, t824, t837, t843, t847, t851;
  double t856, t860, t861, t883, t892, t902, t912, t916;
  double t935, t943, t951, t952, t957, t961, t962, t967;
  double t970, t977, t986, t989, tv4rho40, t995, t998, t1001;
  double t1007, t1014, t1017, t1018, t1019, t1020, t1024, t1028;
  double t1030, t1040, t1042, t1050, t1072, t1076, t1104, t1158;
  double t1161, t1168, t1173, t1174, t1184, t1189, t1193, t1194;
  double t1219, t1222, tv4rho3sigma0, t1235, t1238, t1244, t1257, t1268;
  double t1275, t1279, t1280, t1288, t1301, t1304, t1310, t1314;
  double t1319, t1335, t1346, t1369, t1451, t1454, tv4rho2sigma20, t1481;
  double t1486, t1495, t1501, t1506, t1509, t1526, t1533, t1536;
  double t1544, t1545, t1552, t1561, t1568, t1569, t1589, t1652;
  double t1655, tv4rhosigma30, t1658, t1662, t1669, t1686, t1687, t1688;
  double t1692, t1700, t1705, t1725, t1729, t1733, t1736, t1737;
  double t1747, t1765, t1769, t1824, t1827, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * rho[0];
  t314 = 0.1e1 / t19 / t312;
  t315 = t17 * t314;
  t319 = t72 * t173;
  t323 = t140 * t22;
  t325 = 0.1e1 / t23 / t323;
  t326 = t17 * t325;
  t327 = t80 * t80;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t326 * t329;
  t332 = t46 * t261 * t21;
  t339 = 0.1e1 / t140;
  t340 = t17 * t339;
  t341 = t340 * t41;
  t348 = t134 * t72;
  t352 = 0.1e1 / t23 / t312;
  t353 = sigma[0] * t352;
  t363 = t29 * M_PI;
  t364 = t363 * t261;
  t365 = t140 * t57;
  t366 = 0.1e1 / t365;
  t368 = 0.1e1 / t154 / t38;
  t372 = -0.4928e4 / 0.2187e4 * t21 * t353 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t353 * t155 - 0.1024e4 / 0.59049e5 * t364 * t366 * t368;
  t377 = t78 * t159;
  t384 = t315 * t187;
  t389 = 0.32e2 / 0.27e2 * t315 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t319 * t177 - 0.128e3 / 0.243e3 * t330 * t332 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t341 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t348 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t372 * t47 - t377 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + 0.32e2 / 0.243e3 * t384 * t194 + 0.16e2 / 0.243e3 * t384 * t197;
  t390 = t72 * t81;
  t391 = t171 * t390;
  t394 = t72 * t45;
  t395 = t171 * t394;
  t400 = t326 * t174;
  t401 = t87 * t261;
  t402 = t21 * t68;
  t403 = t401 * t402;
  t406 = t326 * t180;
  t407 = t190 * t261;
  t408 = t21 * t155;
  t409 = t407 * t408;
  t412 = t401 * t408;
  t415 = t326 * t187;
  t416 = t86 * t86;
  t417 = 0.1e1 / t416;
  t420 = t368 * t3 * t20;
  t421 = t417 * t261 * t420;
  t424 = t407 * t420;
  t427 = t401 * t420;
  t430 = t315 * t180;
  t438 = -0.16e2 / 0.81e2 * t391 * t184 - 0.16e2 / 0.243e3 * t395 * t194 - 0.8e1 / 0.243e3 * t395 * t197 - 0.128e3 / 0.729e3 * t400 * t403 - 0.128e3 / 0.2187e4 * t406 * t409 - 0.64e2 / 0.2187e4 * t406 * t412 - 0.128e3 / 0.6561e4 * t415 * t421 - 0.128e3 / 0.6561e4 * t415 * t424 - 0.128e3 / 0.19683e5 * t415 * t427 + 0.32e2 / 0.81e2 * t430 * t184 - 0.43e2 / 0.27e2 * t341 * t83 + 0.5e1 / 0.3e1 * t348 * t83 - t377 * t83;
  t440 = my_piecewise3(t2, 0, t389 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t448 = t232 * t394;
  t453 = t104 * t173;
  t459 = t232 * t390;
  t462 = t17 * t352;
  t463 = t462 * t329;
  t465 = t20 * t32;
  t466 = t46 * t3 * t465;
  t480 = t110 * t159;
  t487 = t134 * t104;
  t499 = 0.1e1 / t323;
  t501 = t368 * t32;
  t504 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t363 * t499 * t501;
  t509 = -0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t448 * t250 + 0.2e1 / 0.243e3 * t448 * t254 - 0.16e2 / 0.81e2 * t171 * t453 * t177 - 0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t459 * t241 + 0.16e2 / 0.81e2 * t463 * t466 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t480 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t487 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t504 * t47;
  t510 = t78 * t217;
  t516 = t462 * t187;
  t518 = t21 * t32;
  t519 = t190 * t368 * t518;
  t523 = t87 * t368 * t518;
  t526 = t104 * t81;
  t527 = t171 * t526;
  t530 = t104 * t45;
  t531 = t171 * t530;
  t536 = t462 * t174;
  t537 = t87 * t3;
  t539 = t537 * t465 * t68;
  t542 = t462 * t180;
  t545 = t20 * t155 * t32;
  t546 = t190 * t3 * t545;
  t549 = t537 * t545;
  t553 = t417 * t368 * t518;
  t566 = -0.2e1 / 0.9e1 * t510 * t90 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.16e2 / 0.2187e4 * t516 * t519 + 0.16e2 / 0.6561e4 * t516 * t523 - 0.16e2 / 0.243e3 * t527 * t184 - 0.16e2 / 0.729e3 * t531 * t194 - 0.8e1 / 0.729e3 * t531 * t197 + 0.16e2 / 0.243e3 * t536 * t539 + 0.16e2 / 0.729e3 * t542 * t546 + 0.8e1 / 0.729e3 * t542 * t549 + 0.16e2 / 0.2187e4 * t516 * t553 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t487 * t83 - 0.2e1 / 0.3e1 * t510 * t83 - t164 * t112 / 0.4e1 + t480 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t509 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t575 = t78 * t272;
  t578 = t110 * t217;
  t583 = t232 * t174;
  t586 = t282 * t319;
  t589 = t17 * t142;
  t590 = t589 * t329;
  t592 = t46 * t99 * t21;
  t595 = t232 * t526;
  t598 = t232 * t530;
  t613 = -t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2 - t575 * t83 / 0.3e1 + t578 * t112 / 0.4e1 - t229 * t293 / 0.16e2 + t583 * t285 / 0.36e2 - t586 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t590 * t592 + 0.4e1 / 0.81e2 * t595 * t241 + 0.4e1 / 0.243e3 * t598 * t250 + 0.2e1 / 0.243e3 * t598 * t254 + t79 * t302 / 0.48e2 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 - t575 * t90 / 0.9e1;
  t629 = t363 * t99;
  t630 = 0.1e1 / t312;
  t634 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t629 * t630 * t368;
  t643 = t589 * t174;
  t644 = t87 * t99;
  t645 = t644 * t402;
  t648 = t282 * t390;
  t651 = t589 * t180;
  t652 = t190 * t99;
  t653 = t652 * t408;
  t656 = t644 * t408;
  t659 = t282 * t394;
  t662 = t589 * t187;
  t664 = t417 * t99 * t420;
  t667 = t652 * t420;
  t674 = t644 * t420;
  t677 = 0.4e1 / 0.27e2 * t232 * t104 * t235 + t578 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t634 * t47 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3 - 0.2e1 / 0.81e2 * t643 * t645 - t648 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t651 * t653 - t651 * t656 / 0.243e3 - t659 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t662 * t664 - 0.2e1 / 0.729e3 * t662 * t667 + t248 * t305 / 0.648e3 - t659 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t662 * t674;
  t679 = my_piecewise3(t2, 0, t613 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t282 * t453;
  t690 = t17 * t59;
  t691 = t690 * t329;
  t693 = t46 * t262 * t21;
  t696 = sigma[0] * sigma[0];
  t698 = 0.1e1 / t32 / t696;
  t700 = t88 * t698 * t68;
  t703 = 0.1e1 / t696;
  t704 = t190 * t703;
  t705 = t704 * t193;
  t708 = t87 * t703;
  t709 = t708 * t183;
  t721 = t339 * t368;
  t724 = t64 * t698 * t34 * t68 / 0.36e2 + t153 * t703 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t363 * t262 * t721;
  t733 = t82 * t698;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 - t685 * t285 / 0.12e2 - t277 * t302 / 0.16e2 + t691 * t693 / 0.36e2 + t111 * t700 / 0.32e2 + t296 * t705 / 0.216e3 + t288 * t709 / 0.72e2 - 0.3e1 / 0.8e1 * t18 * t19 * t724 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t733;
  t737 = t282 * t526;
  t740 = t282 * t530;
  t746 = t46 * t703 * t31;
  t749 = t690 * t174;
  t750 = t87 * t262;
  t751 = t750 * t402;
  t754 = t690 * t180;
  t755 = t190 * t262;
  t756 = t755 * t408;
  t759 = t750 * t408;
  t762 = t690 * t187;
  t764 = t417 * t262 * t420;
  t767 = t755 * t420;
  t770 = t708 * t193;
  t773 = t750 * t420;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t781 = t134 * t159;
  t784 = t78 * t372;
  t787 = t17 * t630;
  t788 = t787 * t41;
  t791 = t340 * t72;
  t795 = 0.1e1 / t19 / t323;
  t796 = t17 * t795;
  t800 = t140 * t140;
  t801 = t800 * rho[0];
  t803 = t17 / t801;
  t804 = t803 * t180;
  t805 = t417 * t696;
  t806 = M_PI * t368;
  t810 = t190 * t696;
  t814 = t87 * t696;
  t818 = t803 * t187;
  t820 = 0.1e1 / t416 / t39;
  t822 = t154 * t154;
  t823 = 0.1e1 / t822;
  t824 = t823 * M_PI;
  t837 = 0.1e2 / 0.3e1 * t781 * t83 - 0.4e1 / 0.3e1 * t784 * t83 + 0.506e3 / 0.81e2 * t788 * t83 - 0.172e3 / 0.27e2 * t791 * t83 - 0.5296e4 / 0.729e3 * t796 * t174 * t177 - 0.4096e4 / 0.59049e5 * t804 * t805 * t806 - 0.4096e4 / 0.59049e5 * t804 * t810 * t806 - 0.4096e4 / 0.177147e6 * t804 * t814 * t806 - 0.4096e4 / 0.177147e6 * t818 * t820 * t696 * t824 - 0.2048e4 / 0.59049e5 * t818 * t805 * t824 - 0.11264e5 / 0.531441e6 * t818 * t810 * t824 - 0.1024e4 / 0.177147e6 * t818 * t814 * t824;
  t843 = t17 / t23 / t365;
  t847 = t159 * t173;
  t851 = t72 * t328;
  t856 = M_PI * t68;
  t860 = t803 * t174;
  t861 = M_PI * t155;
  t883 = 0.1e1 / t327 / t44 * t46;
  t892 = 0.128e3 / 0.27e2 * t315 * t319 * t177 + 0.4864e4 / 0.729e3 * t843 * t329 * t332 - 0.32e2 / 0.27e2 * t171 * t847 * t177 - 0.512e3 / 0.243e3 * t326 * t851 * t332 - 0.4096e4 / 0.6561e4 * t803 * t329 * t814 * t856 - 0.4096e4 / 0.19683e5 * t860 * t810 * t861 - 0.2048e4 / 0.19683e5 * t860 * t814 * t861 + 0.1e2 / 0.27e2 * t18 * t59 * t41 * t47 + 0.506e3 / 0.243e3 * t788 * t90 - 0.5e1 / 0.9e1 * t18 * t25 * t72 * t47 - 0.4e1 / 0.9e1 * t784 * t90 - 0.4096e4 / 0.2187e4 * t803 * t41 * t883 * t696 * M_PI + t18 * t124 * t159 * t47 / 0.2e1;
  t902 = sigma[0] * t325;
  t912 = 0.1e1 / t800;
  t916 = t4 * t363;
  t935 = t843 * t180;
  t943 = t796 * t187;
  t951 = -0.172e3 / 0.81e2 * t791 * t90 - t18 * t52 * t372 * t47 / 0.2e1 + 0.1e2 / 0.9e1 * t781 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * (0.83776e5 / 0.6561e4 * t21 * t902 + 0.728e4 / 0.2187e4 * t64 * t32 * t314 * t68 - 0.27328e5 / 0.19683e5 * t153 * t902 * t155 + 0.14336e5 / 0.59049e5 * t364 * t912 * t368 - 0.8192e4 / 0.1594323e7 * t916 * t696 / t19 / t801 * t823 * t30) * t47 + 0.4864e4 / 0.2187e4 * t843 * t174 * t403 - 0.512e3 / 0.729e3 * t326 * t319 * t403 + 0.4864e4 / 0.6561e4 * t935 * t409 + 0.2432e4 / 0.6561e4 * t935 * t412 - 0.5296e4 / 0.2187e4 * t796 * t180 * t184 - 0.5296e4 / 0.6561e4 * t943 * t194 - 0.2648e4 / 0.6561e4 * t943 * t197 + 0.128e3 / 0.81e2 * t315 * t390 * t184;
  t952 = t315 * t394;
  t957 = t159 * t81;
  t961 = t159 * t45;
  t962 = t171 * t961;
  t967 = t326 * t394;
  t970 = t843 * t187;
  t977 = t326 * t390;
  t986 = 0.128e3 / 0.243e3 * t952 * t194 + 0.64e2 / 0.243e3 * t952 * t197 - 0.32e2 / 0.81e2 * t171 * t957 * t184 - 0.32e2 / 0.243e3 * t962 * t194 - 0.16e2 / 0.243e3 * t962 * t197 - 0.512e3 / 0.19683e5 * t967 * t427 + 0.4864e4 / 0.19683e5 * t970 * t421 + 0.4864e4 / 0.19683e5 * t970 * t424 + 0.4864e4 / 0.59049e5 * t970 * t427 - 0.512e3 / 0.2187e4 * t977 * t409 - 0.256e3 / 0.2187e4 * t977 * t412 - 0.512e3 / 0.6561e4 * t967 * t421 - 0.512e3 / 0.6561e4 * t967 * t424;
  t989 = my_piecewise3(t2, 0, t837 + t892 + t951 + t986);
  tv4rho40 = 0.2e1 * rho[0] * t989 + 0.8e1 * t440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t995 = t340 * t104;
  t998 = t134 * t217;
  t1001 = t78 * t504;
  t1007 = t110 * t372;
  t1014 = t232 * t961;
  t1017 = t17 * t912;
  t1018 = t1017 * t174;
  t1019 = t190 * M_PI;
  t1020 = sigma[0] * t155;
  t1024 = t87 * M_PI;
  t1028 = t1017 * t180;
  t1030 = t368 * sigma[0];
  t1040 = t1017 * t187;
  t1042 = M_PI * sigma[0];
  t1050 = -0.3e1 / 0.4e1 * t341 * t112 - 0.43e2 / 0.27e2 * t995 * t83 + 0.5e1 / 0.3e1 * t998 * t83 - t1001 * t83 + 0.3e1 / 0.4e1 * t348 * t112 - 0.3e1 / 0.8e1 * t377 * t112 + t1007 * t112 / 0.8e1 - 0.26e2 / 0.243e3 * t395 * t250 - 0.13e2 / 0.243e3 * t395 * t254 + 0.2e1 / 0.81e2 * t1014 * t250 + 0.512e3 / 0.6561e4 * t1018 * t1019 * t1020 + 0.256e3 / 0.6561e4 * t1018 * t1024 * t1020 + 0.512e3 / 0.19683e5 * t1028 * t417 * M_PI * t1030 + 0.512e3 / 0.19683e5 * t1028 * t1019 * t1030 + 0.512e3 / 0.59049e5 * t1028 * t1024 * t1030 + 0.512e3 / 0.59049e5 * t1040 * t820 * t823 * t1042 + 0.256e3 / 0.19683e5 * t1040 * t417 * t823 * t1042;
  t1072 = t217 * t173;
  t1076 = t104 * t328;
  t1104 = 0.1408e4 / 0.177147e6 * t1040 * t190 * t823 * t1042 + 0.128e3 / 0.59049e5 * t1040 * t87 * t823 * t1042 - 0.16e3 / 0.81e2 * t330 * t466 + 0.32e2 / 0.27e2 * t315 * t453 * t177 + 0.374e3 / 0.729e3 * t430 * t241 + 0.187e3 / 0.2187e4 * t384 * t254 + 0.374e3 / 0.2187e4 * t384 * t250 + t1014 * t254 / 0.81e2 - 0.16e2 / 0.27e2 * t171 * t1072 * t177 - 0.128e3 / 0.243e3 * t326 * t1076 * t332 - 0.26e2 / 0.81e2 * t391 * t241 + 0.2e1 / 0.27e2 * t232 * t957 * t241 + 0.16e2 / 0.27e2 * t462 * t851 * t466 + 0.512e3 / 0.2187e4 * t1017 * t329 * t1024 * sigma[0] * t68 + 0.2e1 / 0.9e1 * t232 * t159 * t235 - t377 * t116 / 0.8e1 + t1007 * t116 / 0.24e2 - 0.3e1 / 0.8e1 * t18 * t52 * t504 * t47;
  t1158 = t462 * t394;
  t1161 = t462 * t390;
  t1168 = t326 * t526;
  t1173 = 0.5e1 / 0.9e1 * t998 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.4928e4 / 0.2187e4 * t21 * t352 - 0.28e3 / 0.729e3 * t64 * t99 * t170 * t68 + 0.1904e4 / 0.6561e4 * t153 * t352 * t155 - 0.1408e4 / 0.19683e5 * t363 * t366 * t501 + 0.1024e4 / 0.531441e6 * t916 / t19 / t800 * t823 * sigma[0] * t30) * t47 - 0.26e2 / 0.27e2 * t171 * t72 * t235 - t341 * t116 / 0.4e1 - 0.5e1 / 0.36e2 * t18 * t25 * t104 * t47 - t1001 * t90 / 0.3e1 + 0.374e3 / 0.243e3 * t315 * t41 * t235 + 0.512e3 / 0.729e3 * t1017 * t41 * t883 * t1042 + t348 * t116 / 0.4e1 + t18 * t124 * t217 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t995 * t90 + 0.16e2 / 0.729e3 * t1158 * t519 + 0.8e1 / 0.243e3 * t1161 * t549 - 0.16e3 / 0.729e3 * t406 * t546 - 0.16e3 / 0.2187e4 * t415 * t553 - 0.128e3 / 0.2187e4 * t1168 * t409 - 0.64e2 / 0.2187e4 * t1168 * t412;
  t1174 = t326 * t530;
  t1184 = t315 * t530;
  t1189 = t217 * t81;
  t1193 = t217 * t45;
  t1194 = t171 * t1193;
  t1219 = -0.128e3 / 0.6561e4 * t1174 * t421 - 0.128e3 / 0.6561e4 * t1174 * t424 - 0.128e3 / 0.19683e5 * t1174 * t427 + 0.32e2 / 0.81e2 * t315 * t526 * t184 + 0.32e2 / 0.243e3 * t1184 * t194 + 0.16e2 / 0.243e3 * t1184 * t197 - 0.16e2 / 0.81e2 * t171 * t1189 * t184 - 0.16e2 / 0.243e3 * t1194 * t194 - 0.8e1 / 0.243e3 * t1194 * t197 + 0.16e2 / 0.2187e4 * t1158 * t523 - 0.128e3 / 0.729e3 * t326 * t453 * t403 - 0.16e3 / 0.243e3 * t400 * t539 + 0.16e2 / 0.81e2 * t462 * t319 * t539 - 0.16e3 / 0.2187e4 * t415 * t519 - 0.8e2 / 0.729e3 * t406 * t549 - 0.16e3 / 0.6561e4 * t415 * t523 + 0.16e2 / 0.243e3 * t1161 * t546 + 0.16e2 / 0.729e3 * t1158 * t553;
  t1222 = my_piecewise3(t2, 0, t1050 + t1104 + t1173 + t1219);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1222 + 0.6e1 * t568;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1235 = t282 * t961;
  t1238 = t589 * t394;
  t1244 = t589 * t390;
  t1257 = t462 * t530;
  t1268 = -0.4e1 / 0.81e2 * t589 * t319 * t645 - t181 * t290 / 0.54e2 - t188 * t298 / 0.162e3 - t188 * t305 / 0.324e3 - t1235 * t305 / 0.648e3 - 0.4e1 / 0.2187e4 * t1238 * t674 - t282 * t957 * t290 / 0.108e3 - 0.4e1 / 0.243e3 * t1244 * t653 - 0.2e1 / 0.243e3 * t1244 * t656 - t1235 * t298 / 0.324e3 - 0.4e1 / 0.729e3 * t1238 * t664 - 0.4e1 / 0.729e3 * t1238 * t667 + t448 * t305 / 0.324e3 + 0.32e2 / 0.6561e4 * t1257 * t523 + t459 * t290 / 0.54e2 + 0.34e2 / 0.243e3 * t536 * t645 + 0.34e2 / 0.729e3 * t542 * t653 + 0.17e2 / 0.729e3 * t542 * t656;
  t1275 = t272 * t81;
  t1279 = t272 * t45;
  t1280 = t171 * t1279;
  t1288 = t462 * t526;
  t1301 = t78 * t634;
  t1304 = t110 * t504;
  t1310 = t17 * t366 * t41;
  t1314 = t134 * t272;
  t1319 = t448 * t298 / 0.162e3 + 0.34e2 / 0.2187e4 * t516 * t664 + 0.34e2 / 0.2187e4 * t516 * t667 - 0.16e2 / 0.243e3 * t171 * t1275 * t184 - 0.16e2 / 0.729e3 * t1280 * t194 - 0.8e1 / 0.729e3 * t1280 * t197 + 0.32e2 / 0.243e3 * t462 * t453 * t539 + 0.32e2 / 0.729e3 * t1288 * t546 + 0.16e2 / 0.729e3 * t1288 * t549 + 0.32e2 / 0.2187e4 * t1257 * t553 + 0.32e2 / 0.2187e4 * t1257 * t519 + t487 * t112 / 0.2e1 - t135 * t293 / 0.8e1 - 0.2e1 / 0.3e1 * t1301 * t83 + t1304 * t112 / 0.4e1 - t480 * t293 / 0.16e2 - 0.64e2 / 0.243e3 * t1310 * t883 * M_PI + 0.5e1 / 0.9e1 * t1314 * t83 - t510 * t112 / 0.2e1;
  t1335 = t272 * t173;
  t1346 = t232 * t1193;
  t1369 = t164 * t293 / 0.8e1 - 0.52e2 / 0.243e3 * t527 * t241 + t232 * t319 * t285 / 0.18e2 + 0.34e2 / 0.81e2 * t463 * t592 + 0.32e2 / 0.81e2 * t462 * t1076 * t466 - t175 * t285 / 0.18e2 - 0.16e2 / 0.81e2 * t171 * t1335 * t177 + 0.8e1 / 0.81e2 * t232 * t1189 * t241 - 0.52e2 / 0.729e3 * t531 * t250 - 0.26e2 / 0.729e3 * t531 * t254 + 0.8e1 / 0.243e3 * t1346 * t250 + 0.4e1 / 0.243e3 * t1346 * t254 - t282 * t847 * t285 / 0.36e2 - 0.4e1 / 0.27e2 * t589 * t851 * t592 - t18 * t52 * t634 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t1314 * t90 - t510 * t116 / 0.6e1 - 0.2e1 / 0.9e1 * t1301 * t90 + t487 * t116 / 0.6e1;
  t1451 = -t135 * t302 / 0.24e2 + t18 * t124 * t272 * t47 / 0.12e2 - 0.64e2 / 0.2187e4 * t1310 * t173 * t190 * t861 - 0.32e2 / 0.2187e4 * t1310 * t173 * t87 * t861 - 0.64e2 / 0.6561e4 * t1310 * t81 * t417 * t806 - 0.64e2 / 0.6561e4 * t1310 * t81 * t190 * t806 - 0.64e2 / 0.19683e5 * t1310 * t81 * t87 * t806 - 0.64e2 / 0.19683e5 * t1310 * t45 * t820 * t824 - 0.32e2 / 0.6561e4 * t1310 * t45 * t417 * t824 - 0.176e3 / 0.59049e5 * t1310 * t45 * t190 * t824 - 0.16e2 / 0.19683e5 * t1310 * t88 * t824 - 0.52e2 / 0.81e2 * t171 * t104 * t235 + 0.8e1 / 0.27e2 * t232 * t217 * t235 + t1304 * t116 / 0.12e2 - t480 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.14e2 / 0.243e3 * t64 * t262 * t147 * t68 - 0.28e2 / 0.2187e4 * t153 * t267 * t142 * t155 + 0.304e3 / 0.19683e5 * t629 * t499 * t368 - 0.128e3 / 0.177147e6 * t916 / t19 / t365 * t823 * t30) * t47 - 0.64e2 / 0.729e3 * t1310 * t328 * t87 * t856 + t164 * t302 / 0.24e2 + 0.34e2 / 0.6561e4 * t516 * t674;
  t1454 = my_piecewise3(t2, 0, t1268 + t1319 + t1369 + t1451);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1454 + 0.4e1 * t679;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1481 = t690 * t390;
  t1486 = t690 * t394;
  t1495 = t595 * t290 / 0.36e2 + t598 * t298 / 0.108e3 + t598 * t305 / 0.216e3 + t651 * t756 / 0.972e3 + t662 * t764 / 0.2916e4 + t662 * t767 / 0.2916e4 + t648 * t709 / 0.72e2 + t643 * t751 / 0.324e3 + t651 * t759 / 0.1944e4 - 0.2e1 / 0.27e2 * t589 * t453 * t645 + t690 * t319 * t751 / 0.108e3 + t1481 * t756 / 0.324e3 + t1481 * t759 / 0.648e3 + t1486 * t764 / 0.972e3 + t1486 * t767 / 0.972e3 + t659 * t770 / 0.432e3 + t662 * t773 / 0.8748e4;
  t1501 = t589 * t526;
  t1506 = t282 * t1193;
  t1509 = t589 * t530;
  t1526 = t78 * t724;
  t1533 = t110 * t634;
  t1536 = t1486 * t773 / 0.2916e4 - t282 * t1189 * t290 / 0.36e2 - 0.2e1 / 0.81e2 * t1501 * t653 - t1501 * t656 / 0.81e2 - t1506 * t298 / 0.108e3 - 0.2e1 / 0.243e3 * t1509 * t664 - 0.2e1 / 0.243e3 * t1509 * t667 - t1506 * t305 / 0.216e3 - 0.2e1 / 0.729e3 * t1509 * t674 - t238 * t709 / 0.72e2 - t248 * t705 / 0.216e3 - t248 * t770 / 0.432e3 + t659 * t705 / 0.216e3 - t1526 * t83 / 0.3e1 - 0.3e1 / 0.16e2 * t578 * t293 + 0.3e1 / 0.32e2 * t229 * t733 + 0.3e1 / 0.8e1 * t1533 * t112;
  t1544 = t17 * t499;
  t1545 = t1544 * t187;
  t1552 = t232 * t1279;
  t1561 = t1544 * t174;
  t1568 = t1544 * t180;
  t1569 = t417 * t267;
  t1589 = -0.3e1 / 0.8e1 * t575 * t112 + 0.3e1 / 0.16e2 * t222 * t293 - 0.3e1 / 0.32e2 * t79 * t733 + 0.22e2 / 0.19683e5 * t1545 * t297 * t824 + 0.2e1 / 0.6561e4 * t1545 * t289 * t824 + 0.2e1 / 0.81e2 * t1552 * t250 + t1552 * t254 / 0.81e2 - t583 * t746 / 0.24e2 + t586 * t746 / 0.24e2 + 0.8e1 / 0.729e3 * t1561 * t297 * t861 + 0.4e1 / 0.729e3 * t1561 * t289 * t861 + 0.8e1 / 0.2187e4 * t1568 * t1569 * t806 + 0.8e1 / 0.2187e4 * t1568 * t297 * t806 + 0.8e1 / 0.6561e4 * t1568 * t289 * t806 + 0.8e1 / 0.6561e4 * t1545 * t820 * t267 * t824 + 0.4e1 / 0.2187e4 * t1545 * t1569 * t824 + 0.2e1 / 0.27e2 * t232 * t1275 * t241;
  t1652 = -t282 * t1072 * t285 / 0.12e2 - 0.2e1 / 0.9e1 * t589 * t1076 * t592 + t690 * t851 * t693 / 0.36e2 + 0.8e1 / 0.243e3 * t1544 * t329 * t289 * t856 + t232 * t453 * t285 / 0.12e2 + t590 * t693 / 0.108e3 + 0.8e1 / 0.81e2 * t1544 * t41 * t883 * t267 * M_PI + t229 * t700 / 0.32e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-t64 * t698 * t66 * t68 / 0.27e2 - 0.2e1 / 0.243e3 * t153 * t703 * t59 * t155 + 0.16e2 / 0.59049e5 * t916 * t267 * t795 * t823 * t30) * t47 - t1526 * t90 / 0.9e1 + t1533 * t116 / 0.8e1 + t222 * t302 / 0.16e2 - t79 * t700 / 0.32e2 - t18 * t52 * t724 * t47 / 0.8e1 - t575 * t116 / 0.8e1 + 0.2e1 / 0.9e1 * t232 * t272 * t235 - t578 * t302 / 0.16e2;
  t1655 = my_piecewise3(t2, 0, t1495 + t1536 + t1589 + t1652);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1655 + 0.2e1 * t778;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1658 = t190 * t698;
  t1662 = t87 * t698;
  t1669 = t282 * t1279;
  t1686 = t696 * sigma[0];
  t1687 = 0.1e1 / t1686;
  t1688 = t87 * t1687;
  t1692 = -t762 * t1658 * t420 / 0.324e3 - t749 * t1662 * t402 / 0.36e2 - t754 * t1662 * t408 / 0.216e3 - t1669 * t298 / 0.54e2 - t1669 * t305 / 0.108e3 - t282 * t1275 * t290 / 0.18e2 + t690 * t453 * t751 / 0.27e2 + t737 * t709 / 0.18e2 + t740 * t705 / 0.54e2 + t740 * t770 / 0.108e3 - 0.5e1 / 0.144e3 * t288 * t1688 * t183;
  t1700 = t690 * t526;
  t1705 = t690 * t530;
  t1725 = 0.1e1 / t32 / t1686;
  t1729 = -0.5e1 / 0.432e3 * t296 * t190 * t1687 * t193 - t762 * t1662 * t420 / 0.972e3 + t1700 * t756 / 0.81e2 + t1700 * t759 / 0.162e3 + t1705 * t764 / 0.243e3 + t1705 * t767 / 0.243e3 + t1705 * t773 / 0.729e3 - 0.5e1 / 0.864e3 * t296 * t1688 * t193 - t754 * t1658 * t408 / 0.108e3 - t762 * t417 * t698 * t420 / 0.324e3 + 0.3e1 / 0.8e1 * t277 * t733 - 0.15e2 / 0.64e2 * t111 * t82 * t1725;
  t1733 = t110 * t724;
  t1736 = t787 * t180;
  t1737 = t417 * t703;
  t1747 = t787 * t187;
  t1765 = t787 * t174;
  t1769 = -0.3e1 / 0.8e1 * t682 * t293 + t1733 * t112 / 0.2e1 - t1736 * t1737 * t806 / 0.729e3 - t1736 * t704 * t806 / 0.729e3 - t1736 * t708 * t806 / 0.2187e4 - t1747 * t820 * t703 * t824 / 0.2187e4 - t1747 * t1737 * t824 / 0.1458e4 - 0.11e2 / 0.26244e5 * t1747 * t704 * t824 - t1747 * t708 * t824 / 0.8748e4 - 0.5e1 / 0.48e2 * t283 * t46 * t1687 * t31 - t1765 * t704 * t861 / 0.243e3;
  t1824 = -t1765 * t708 * t861 / 0.486e3 - t282 * t1335 * t285 / 0.6e1 + t690 * t1076 * t693 / 0.9e1 - t787 * t329 * t708 * t856 / 0.81e2 + t685 * t746 / 0.6e1 - t691 * t46 * t698 * t21 / 0.12e2 + t277 * t700 / 0.8e1 - 0.5e1 / 0.64e2 * t111 * t88 * t1725 * t68 - t682 * t302 / 0.8e1 - t788 * t883 * t703 * M_PI / 0.27e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.5e1 / 0.72e2 * t64 * t1725 * t34 * t68 - 0.5e1 / 0.324e3 * t153 * t1687 * t25 * t155 - 0.2e1 / 0.729e3 * t363 * t698 * t721 - 0.2e1 / 0.19683e5 * t916 * t703 * t314 * t823 * t30) * t47 + t1733 * t116 / 0.6e1;
  t1827 = my_piecewise3(t2, 0, t1692 + t1729 + t1769 + t1824);
  tv4sigma40 = 0.2e1 * rho[0] * t1827;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t528;
  double t529, t530, t531, t532, t534, t536, t537, t540;
  double t545, t549, t550, t555, t561, t562, t566, t568;
  double t571, t572, t573, t574, t578, t579, t580, t582;
  double t583, t586, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t77 / t197;
  t521 = t84 * t520;
  t522 = t521 * t206;
  t523 = t228 * t522;
  t528 = 0.1e1 / t216 / t97;
  t529 = t94 * t528;
  t530 = t529 * t99;
  t531 = t215 * t530;
  t532 = t76 * t76;
  t534 = 0.1e1 / t78 / t532;
  t536 = t534 * t41 * t3;
  t537 = t75 * t536;
  t540 = t190 * t190;
  t545 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t549 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t540 + 0.4e1 / 0.3e1 * t71 * t545);
  t550 = t5 * t549;
  t555 = t75 * t534;
  t561 = t91 * t91;
  t562 = 0.1e1 / t561;
  t566 = 0.176e3 / 0.729e3 * t29 * t555 + 0.28e2 / 0.243e3 * t130 * t522 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t534 * t562;
  t568 = t27 * t566 * t100;
  t571 = t218 * t227;
  t572 = t215 * t571;
  t573 = t42 * t206;
  t574 = t555 * t573;
  t578 = 0.1e1 / t226 / t92;
  t579 = t224 * t578;
  t580 = t215 * t579;
  t582 = t562 * t41 * t3;
  t583 = t555 * t582;
  t586 = t224 * t227;
  t587 = t215 * t586;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t521;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t523 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t531 * t537 - 0.3e1 / 0.8e1 * t550 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t568 - 0.8e1 / 0.243e3 * t572 * t574 - 0.8e1 / 0.729e3 * t580 * t583 - 0.4e1 / 0.729e3 * t587 * t583 + t418 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t562;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t529;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t573;
  t735 = t220 * t701;
  t742 = t698 * t582;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t572 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t580 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t587 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t562 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t573;
  t826 = t220 * t798;
  t829 = t822 * t582;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t531 * t819 / 0.72e2 - t572 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t580 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t587 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t528;
  double t529, t530, t531, t532, t534, t536, t537, t540;
  double t545, t549, t550, t555, t561, t562, t566, t568;
  double t571, t572, t573, t574, t578, t579, t580, t582;
  double t583, t586, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t843, t848, t849, t850, t853, t854, t855, t857;
  double t858, t860, t861, t864, t865, t866, t868, t869;
  double t872, t877, t878, t880, t882, t883, t886, t893;
  double t894, t895, t896, t898, t899, t902, t904, t907;
  double t909, t911, t913, t915, t916, t918, t920, t922;
  double t925, t926, t929, t932, t933, t934, t937, t941;
  double t942, t947, t949, t952, t953, t954, t955, t956;
  double t957, t959, t966, t969, t971, t974, t975, t977;
  double t978, t981, t982, t984, t985, t987, t988, t989;
  double t992, t993, t994, t995, t996, t1000, t1001, t1005;
  double t1006, t1011, t1012, t1015, t1016, t1017, t1018, t1021;
  double t1024, t1025, t1026, t1029, t1030, t1033, t1036, t1037;
  double t1040, t1043, t1044, t1046, t1047, t1049, t1050, t1052;
  double t1053, t1056, t1059, t1060, t1063, t1066, t1071, t1074;
  double t1076, t1077, t1080, t1083, t1086, t1090, t1091, t1094;
  double t1096, t1099, t1101, t1103, tv3rho30, t1106, t1107, t1111;
  double t1114, t1115, t1118, t1119, t1121, t1127, t1130, t1135;
  double t1136, t1138, t1142, t1143, t1149, t1152, t1153, t1157;
  double t1162, t1165, t1167, t1168, t1175, t1179, t1182, t1185;
  double t1191, t1193, t1194, t1197, t1202, t1204, t1208, t1209;
  double t1213, t1214, t1221, t1223, t1224, t1226, t1227, t1230;
  double t1231, t1233, t1234, t1235, t1236, t1238, t1241, t1243;
  double t1244, t1245, t1247, t1248, tv3rho31, t1251, t1256, t1260;
  double t1264, t1265, t1268, t1272, t1273, t1276, t1284, t1285;
  double t1286, t1291, t1292, t1295, t1296, t1297, t1299, t1300;
  double t1302, t1305, t1307, t1310, t1311, t1313, t1318, t1322;
  double t1326, t1327, t1336, t1338, t1339, t1341, t1342, t1344;
  double t1348, t1351, t1355, t1356, t1358, t1361, t1362, t1364;
  double t1365, t1367, t1368, t1370, t1373, t1376, t1379, t1381;
  double tv3rho32, t1386, t1393, t1397, t1398, t1404, t1406, t1407;
  double t1408, t1418, t1419, t1422, t1424, t1425, t1429, t1436;
  double t1440, t1441, t1448, t1449, t1451, t1452, t1455, t1462;
  double t1463, t1464, t1466, t1467, t1470, t1472, t1484, t1485;
  double t1486, t1487, t1488, t1489, t1491, t1494, t1497, t1500;
  double t1501, t1504, t1509, t1514, t1515, t1516, t1517, t1518;
  double t1521, t1522, t1523, t1524, t1529, t1530, t1531, t1532;
  double t1534, t1535, t1542, t1545, t1546, t1547, t1548, t1552;
  double t1553, t1556, t1559, t1560, t1563, t1566, t1567, t1570;
  double t1573, t1574, t1577, t1580, t1588, t1591, tv3rho33, t1599;
  double t1601, t1605, t1609, t1610, t1611, t1613, t1614, t1618;
  double t1619, t1624, t1625, t1626, t1629, t1630, t1633, t1638;
  double t1639, t1640, t1643, t1654, t1655, t1660, t1665, t1666;
  double t1670, t1673, t1674, t1676, t1677, t1680, t1686, t1689;
  double t1691, t1692, t1699, t1700, t1704, t1711, t1714, t1716;
  double t1721, t1724, t1729, t1730, t1732, t1733, t1738, t1741;
  double t1742, t1746, t1750, t1757, t1759, t1760, t1763, t1766;
  double t1767, t1769, t1770, t1773, t1774, t1777, t1778, t1781;
  double t1784, tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800;
  double t1803, t1806, t1808, tv3rho2sigma2, t1819, t1823, t1834, t1836;
  double t1843, t1850, t1857, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1866;
  double t1868, t1870, t1883, t1885, t1887, t1892, t1894, t1895;
  double t1899, t1903, t1906, t1907, t1909, t1911, t1913, t1914;
  double t1916, t1917, t1919, t1921, t1930, t1934, t1936, tv3rho2sigma5;
  double t1949, tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1962, t1967, t1968;
  double t1977, t1978, t1981, t1982, t1985, t1986, t1989, t1990;
  double t1993, t1994, t1995, t1996, t1998, t1999, t2003, t2004;
  double t2015, t2016, t2017, t2020, t2026, t2027, t2028, t2037;
  double t2053, t2060, t2063, t2065, t2076, t2079, t2082, t2086;
  double t2089, t2092, t2093, t2101, t2106, t2111, t2114, tv3rho2sigma8;
  double t2119, t2120, t2121, t2125, t2126, t2127, t2139, t2140;
  double t2141, t2145, t2146, t2147, t2165, t2167, t2168, t2171;
  double t2172, t2173, t2176, t2188, t2191, t2201, t2203, t2206;
  double t2207, t2214, t2218, t2220, t2224, t2225, t2229, t2232;
  double t2239, t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275;
  double t2279, t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25;
  double t2317, t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2322;
  double t2323, t2326, t2327, t2338, t2339, t2342, t2347, t2366;
  double t2368, t2369, t2370, t2373, t2378, t2381, t2392, t2399;
  double t2403, t2405, t2410, t2411, t2416, t2417, t2420, t2427;
  double t2430, t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445;
  double t2446, t2455, t2458, t2459, t2460, t2463, t2466, t2475;
  double t2477, t2478, t2479, t2480, t2493, t2494, t2497, t2502;
  double t2514, t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2526;
  double t2527, t2528, t2529, t2534, t2542, t2543, t2544, t2545;
  double t2548, t2549, t2550, t2555, t2558, t2563, t2570, t2579;
  double t2580, t2587, t2597, t2600, t2602, t2605, t2607, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t77 / t197;
  t521 = t84 * t520;
  t522 = t521 * t206;
  t523 = t228 * t522;
  t528 = 0.1e1 / t216 / t97;
  t529 = t94 * t528;
  t530 = t529 * t99;
  t531 = t215 * t530;
  t532 = t76 * t76;
  t534 = 0.1e1 / t78 / t532;
  t536 = t534 * t41 * t3;
  t537 = t75 * t536;
  t540 = t190 * t190;
  t545 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t549 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t540 + 0.4e1 / 0.3e1 * t71 * t545);
  t550 = t5 * t549;
  t555 = t75 * t534;
  t561 = t91 * t91;
  t562 = 0.1e1 / t561;
  t566 = 0.176e3 / 0.729e3 * t29 * t555 + 0.28e2 / 0.243e3 * t130 * t522 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t534 * t562;
  t568 = t27 * t566 * t100;
  t571 = t218 * t227;
  t572 = t215 * t571;
  t573 = t42 * t206;
  t574 = t555 * t573;
  t578 = 0.1e1 / t226 / t92;
  t579 = t224 * t578;
  t580 = t215 * t579;
  t582 = t562 * t41 * t3;
  t583 = t555 * t582;
  t586 = t224 * t227;
  t587 = t215 * t586;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t521;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t523 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t531 * t537 - 0.3e1 / 0.8e1 * t550 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t568 - 0.8e1 / 0.243e3 * t572 * t574 - 0.8e1 / 0.729e3 * t580 * t583 - 0.4e1 / 0.729e3 * t587 * t583 + t418 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t562;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t529;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t573;
  t735 = t220 * t701;
  t742 = t698 * t582;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t572 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t580 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t587 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t562 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t573;
  t826 = t220 * t798;
  t829 = t822 * t582;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t531 * t819 / 0.72e2 - t572 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t580 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t587 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t843 = t375 * t392;
  t848 = 0.1e1 / t33 / t285;
  t849 = t44 * t848;
  t850 = t148 * t849;
  t853 = t25 * t369;
  t854 = t853 * t146;
  t855 = t854 * t149;
  t857 = t374 * t378;
  t858 = t857 * t149;
  t860 = t338 * t145;
  t861 = t143 * t860;
  t864 = t112 * t117;
  t865 = t864 * t146;
  t866 = t865 * t149;
  t868 = t314 * t27;
  t869 = t868 * t146;
  t872 = t364 * t378;
  t877 = t117 * t338 * t60;
  t878 = t26 * t877;
  t880 = t285 * rho[0];
  t882 = 0.1e1 / t34 / t880;
  t883 = t31 * t882;
  t886 = t849 * t134;
  t893 = t40 * M_PI;
  t894 = t893 * t753;
  t895 = t285 * t122;
  t896 = 0.1e1 / t895;
  t898 = 0.1e1 / t333 / t51;
  t899 = t896 * t898;
  t902 = -0.2464e4 / 0.2187e4 * t29 * t883 - 0.28e3 / 0.729e3 * t130 * t886 + 0.224e3 / 0.2187e4 * t331 * sigma[0] * t882 * t334 - 0.512e3 / 0.59049e5 * t894 * t899;
  t904 = t27 * t902 * t60;
  t907 = 0.7e1 / 0.6e1 * t365 * t392 + 0.7e1 / 0.18e2 * t843 + 0.7e1 / 0.6e1 * t379 * t392 - 0.35e2 / 0.27e2 * t147 * t850 + t855 / 0.9e1 - t858 / 0.3e1 - t861 * t149 / 0.2e1 - t866 / 0.3e1 - t869 * t149 / 0.2e1 - t872 * t149 - 0.9e1 / 0.8e1 * t113 * t340 - 0.3e1 / 0.8e1 * t878 - 0.3e1 / 0.8e1 * t26 * t904;
  t909 = 0.1e1 / t116 / t105;
  t911 = t909 * t54 * t60;
  t913 = 0.5e1 / 0.36e2 * t26 * t911;
  t915 = t369 * t138 * t60;
  t916 = t26 * t915;
  t918 = t113 * t371;
  t920 = t315 * t119;
  t922 = t113 * t321;
  t925 = 0.1e1 / t300 / t19;
  t926 = t302 * t109;
  t929 = t301 * t109;
  t932 = t105 * t105;
  t933 = 0.1e1 / t932;
  t934 = t16 * t933;
  t937 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t306 - 0.6e1 * t934);
  t941 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t926 + 0.4e1 / 0.3e1 * t929 * t310 + 0.4e1 / 0.3e1 * t23 * t937);
  t942 = t5 * t941;
  t947 = t385 * t297;
  t949 = t156 * t886;
  t952 = t144 * t144;
  t953 = 0.1e1 / t952;
  t954 = t54 * t953;
  t955 = t143 * t954;
  t956 = t59 * t753;
  t957 = t896 * t2;
  t959 = t956 * t957 * t28;
  t966 = t868 * t152;
  t969 = -t913 + t916 / 0.4e1 + t918 / 0.4e1 - 0.3e1 / 0.8e1 * t920 - 0.3e1 / 0.4e1 * t922 - 0.3e1 / 0.8e1 * t942 * t61 - 0.9e1 / 0.8e1 * t315 * t140 + 0.7e1 / 0.54e2 * t947 - 0.35e2 / 0.81e2 * t153 * t949 - 0.64e2 / 0.243e3 * t955 * t959 + 0.7e1 / 0.18e2 * t382 * t297 + 0.7e1 / 0.18e2 * t389 * t297 - t966 * t157 / 0.6e1;
  t971 = t364 * t388;
  t974 = t374 * t388;
  t975 = t974 * t157;
  t977 = t338 * t58;
  t978 = t143 * t977;
  t981 = t864 * t152;
  t982 = t981 * t157;
  t984 = t853 * t152;
  t985 = t984 * t157;
  t987 = t138 * t281;
  t988 = t987 * t59;
  t989 = t143 * t988;
  t992 = t282 * t155;
  t993 = t143 * t992;
  t994 = t753 * t896;
  t995 = t29 * t134;
  t996 = t994 * t995;
  t1000 = t334 * t2 * t28;
  t1001 = t994 * t1000;
  t1005 = t898 * t2 * t28;
  t1006 = t994 * t1005;
  t1011 = t146 * t357;
  t1012 = t143 * t1011;
  t1015 = t154 * t154;
  t1016 = 0.1e1 / t1015;
  t1017 = t152 * t1016;
  t1018 = t143 * t1017;
  t1021 = t364 * t283;
  t1024 = -t971 * t157 / 0.3e1 - t975 / 0.9e1 - t978 * t157 / 0.6e1 - t982 / 0.9e1 + t985 / 0.27e2 - 0.8e1 / 0.27e2 * t989 * t290 - 0.64e2 / 0.729e3 * t993 * t996 - 0.32e2 / 0.2187e4 * t351 * t1001 - 0.64e2 / 0.6561e4 * t359 * t1006 - 0.64e2 / 0.19683e5 * t344 * t1006 - 0.64e2 / 0.2187e4 * t1012 * t1001 - 0.64e2 / 0.6561e4 * t1018 * t1006 - 0.8e1 / 0.27e2 * t1021 * t290;
  t1025 = t374 * t283;
  t1026 = t1025 * t290;
  t1029 = t882 * t41 * t3;
  t1030 = t31 * t1029;
  t1033 = t364 * t343;
  t1036 = t388 * t155;
  t1037 = t143 * t1036;
  t1040 = t364 * t350;
  t1043 = t374 * t343;
  t1044 = t1043 * t347;
  t1046 = t374 * t350;
  t1047 = t1046 * t353;
  t1049 = t374 * t358;
  t1050 = t1049 * t347;
  t1052 = t378 * t155;
  t1053 = t143 * t1052;
  t1056 = t364 * t358;
  t1059 = t388 * t357;
  t1060 = t143 * t1059;
  t1063 = t883 * t352;
  t1066 = t883 * t346;
  t1071 = -0.8e1 / 0.81e2 * t1026 + 0.56e2 / 0.81e2 * t284 * t1030 - 0.4e1 / 0.243e3 * t1033 * t347 - 0.4e1 / 0.243e3 * t1037 * t347 - 0.8e1 / 0.81e2 * t1040 * t353 - 0.4e1 / 0.729e3 * t1044 - 0.8e1 / 0.243e3 * t1047 - 0.8e1 / 0.729e3 * t1050 - 0.8e1 / 0.81e2 * t1053 * t353 - 0.8e1 / 0.243e3 * t1056 * t347 - 0.8e1 / 0.243e3 * t1060 * t347 + 0.56e2 / 0.243e3 * t351 * t1063 + 0.56e2 / 0.729e3 * t359 * t1066 + 0.28e2 / 0.729e3 * t344 * t1066;
  t1074 = my_piecewise3(t1, 0, t907 + t969 + t1024 + t1071);
  t1076 = 0.1e1 / t397 / t69;
  t1077 = t399 * t164;
  t1080 = t398 * t164;
  t1083 = t66 * t933;
  t1086 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t306 - 0.6e1 * t1083);
  t1090 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1077 + 0.4e1 / 0.3e1 * t1080 * t405 + 0.4e1 / 0.3e1 * t71 * t1086);
  t1091 = t5 * t1090;
  t1094 = t410 * t172;
  t1096 = t168 * t416;
  t1099 = t909 * t94 * t100;
  t1101 = 0.5e1 / 0.36e2 * t74 * t1099;
  t1103 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1091 * t101 - 0.3e1 / 0.8e1 * t1094 + t1096 / 0.4e1 - t1101);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1074 + t1103);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1106 = 0.2e1 * t451;
  t1107 = 0.2e1 * t488;
  t1111 = t439 * t378;
  t1114 = t431 * t27;
  t1115 = t1114 * t146;
  t1118 = t183 * t117;
  t1119 = t1118 * t146;
  t1121 = t1119 * t149 / 0.9e1;
  t1127 = t925 * t180;
  t1130 = t301 * t427;
  t1135 = 0.2e1 * t306;
  t1136 = 0.6e1 * t934;
  t1138 = my_piecewise5(t10, 0, t14, 0, t1135 - t1136);
  t1142 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1127 * t302 + 0.8e1 / 0.9e1 * t1130 * t109 + 0.4e1 / 0.9e1 * t423 * t310 + 0.4e1 / 0.3e1 * t23 * t1138);
  t1143 = t5 * t1142;
  t1149 = t184 * t321 / 0.4e1;
  t1152 = t432 * t119 / 0.4e1;
  t1153 = t184 * t371;
  t1157 = 0.7e1 / 0.18e2 * t440 * t392 + 0.7e1 / 0.54e2 * t843 - t1111 * t149 / 0.3e1 - t1115 * t149 / 0.3e1 - t1121 + 0.2e1 / 0.27e2 * t855 - t858 / 0.9e1 - t866 / 0.9e1 - 0.3e1 / 0.8e1 * t184 * t340 - 0.3e1 / 0.8e1 * t1143 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1149 - t878 / 0.8e1 - t1152 + t1153 / 0.12e2 - t913 + t916 / 0.6e1 + t918 / 0.6e1;
  t1162 = t1114 * t152;
  t1165 = t1118 * t152;
  t1167 = t1165 * t157 / 0.27e2;
  t1168 = t439 * t388;
  t1175 = t439 * t283;
  t1179 = t439 * t350;
  t1182 = t439 * t358;
  t1185 = t439 * t343;
  t1191 = -t920 / 0.8e1 - t922 / 0.4e1 + 0.7e1 / 0.54e2 * t443 * t297 - t1162 * t157 / 0.9e1 - t1167 - t1168 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t947 - t975 / 0.27e2 - t982 / 0.27e2 + 0.2e1 / 0.81e2 * t985 - 0.8e1 / 0.81e2 * t1175 * t290 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t353 - 0.8e1 / 0.729e3 * t1182 * t347 - 0.4e1 / 0.729e3 * t1185 * t347 - 0.4e1 / 0.2187e4 * t1044 - 0.8e1 / 0.729e3 * t1047 - 0.8e1 / 0.2187e4 * t1050;
  t1193 = my_piecewise3(t1, 0, t1157 + t1191);
  t1194 = t1076 * t190;
  t1197 = t398 * t456;
  t1202 = 0.6e1 * t1083;
  t1204 = my_piecewise5(t14, 0, t10, 0, -t1135 - t1202);
  t1208 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1194 * t399 + 0.8e1 / 0.9e1 * t1197 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1204);
  t1209 = t5 * t1208;
  t1213 = t461 * t172 / 0.4e1;
  t1214 = t194 * t416;
  t1221 = t168 * t470 / 0.4e1;
  t1223 = t369 * t210 * t100;
  t1224 = t74 * t1223;
  t1226 = t409 * t27;
  t1227 = t1226 * t218;
  t1230 = t167 * t117;
  t1231 = t1230 * t218;
  t1233 = t1231 * t221 / 0.9e1;
  t1234 = t73 * t369;
  t1235 = t1234 * t218;
  t1236 = t1235 * t221;
  t1238 = t1226 * t224;
  t1241 = t1230 * t224;
  t1243 = t1241 * t229 / 0.27e2;
  t1244 = t1234 * t224;
  t1245 = t1244 * t229;
  t1247 = -0.3e1 / 0.8e1 * t1209 * t101 - t1213 + t1214 / 0.12e2 - t1094 / 0.8e1 + t1096 / 0.6e1 - t1101 - 0.3e1 / 0.8e1 * t410 * t212 - t1221 + t1224 / 0.12e2 - t1227 * t221 / 0.6e1 - t1233 + t1236 / 0.27e2 - t1238 * t229 / 0.18e2 - t1243 + t1245 / 0.81e2;
  t1248 = my_piecewise3(t65, 0, t1247);
  tv3rho31 = t396 + t420 + t1106 + t1107 + t6 * (t1193 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1251 = t925 * t493;
  t1256 = t301 * t498;
  t1260 = my_piecewise5(t10, 0, t14, 0, -t1135 - t1136);
  t1264 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1251 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1256 * t109 + 0.4e1 / 0.3e1 * t23 * t1260);
  t1265 = t5 * t1264;
  t1268 = t503 * t119;
  t1272 = t502 * t27;
  t1273 = t1272 * t146;
  t1276 = t1272 * t152;
  t1284 = -0.3e1 / 0.8e1 * t1265 * t61 - t1268 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1273 * t149 / 0.6e1 - t1276 * t157 / 0.18e2 - t1152 + t1153 / 0.6e1 - t1149 - t1121 - t1167 + t918 / 0.12e2 - t913 + t916 / 0.12e2 + t855 / 0.27e2 + t985 / 0.81e2;
  t1285 = my_piecewise3(t1, 0, t1284);
  t1286 = t473 * t513;
  t1291 = t460 * t27;
  t1292 = t1291 * t218;
  t1295 = t193 * t117;
  t1296 = t1295 * t218;
  t1297 = t1296 * t221;
  t1299 = t477 * t513;
  t1300 = t1299 * t221;
  t1302 = t478 * t598;
  t1305 = t550 * t172;
  t1307 = t194 * t470;
  t1310 = t117 * t566 * t100;
  t1311 = t74 * t1310;
  t1313 = t1076 * t540;
  t1318 = t398 * t545;
  t1322 = my_piecewise5(t14, 0, t10, 0, t1135 - t1202);
  t1326 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1313 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1318 * t164 + 0.4e1 / 0.3e1 * t71 * t1322);
  t1327 = t5 * t1326;
  t1336 = -t1286 * t221 / 0.3e1 + 0.7e1 / 0.18e2 * t474 * t598 - t1292 * t221 / 0.3e1 - t1297 / 0.9e1 - t1300 / 0.9e1 + 0.7e1 / 0.54e2 * t1302 - t1233 + 0.2e1 / 0.27e2 * t1236 - t1305 / 0.8e1 - t1307 / 0.4e1 - t1311 / 0.8e1 - 0.3e1 / 0.8e1 * t1327 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t568 - t1213 + t1214 / 0.6e1 - t1221 + t1224 / 0.6e1;
  t1338 = t1295 * t224;
  t1339 = t1338 * t229;
  t1341 = t477 * t594;
  t1342 = t1341 * t229;
  t1344 = t484 * t523;
  t1348 = t1291 * t224;
  t1351 = t473 * t594;
  t1355 = t477 * t530;
  t1356 = t1355 * t537;
  t1358 = t473 * t530;
  t1361 = t477 * t579;
  t1362 = t1361 * t583;
  t1364 = t477 * t586;
  t1365 = t1364 * t583;
  t1367 = t477 * t571;
  t1368 = t1367 * t574;
  t1370 = t473 * t571;
  t1373 = t473 * t579;
  t1376 = t473 * t586;
  t1379 = t1096 / 0.12e2 - t1101 - t1339 / 0.27e2 - t1342 / 0.27e2 + 0.7e1 / 0.162e3 * t1344 + 0.7e1 / 0.54e2 * t481 * t523 - t1348 * t229 / 0.9e1 - t1351 * t229 / 0.9e1 - t1243 + 0.2e1 / 0.81e2 * t1245 - 0.8e1 / 0.243e3 * t1356 - 0.8e1 / 0.81e2 * t1358 * t537 - 0.8e1 / 0.2187e4 * t1362 - 0.4e1 / 0.2187e4 * t1365 - 0.8e1 / 0.729e3 * t1368 - 0.8e1 / 0.243e3 * t1370 * t574 - 0.8e1 / 0.729e3 * t1373 * t583 - 0.4e1 / 0.729e3 * t1376 * t583;
  t1381 = my_piecewise3(t65, 0, t1336 + t1379);
  tv3rho32 = t1106 + t1107 + t508 + t602 + t6 * (t1285 + t1381);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1386 = t493 * t180;
  t1393 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t306 - 0.6e1 * t934);
  t1397 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t1386 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1393);
  t1398 = t5 * t1397;
  t1404 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1398 * t61 - 0.3e1 / 0.8e1 * t1268 + t1153 / 0.4e1 - t913);
  t1406 = 0.1e1 / t77 / t532;
  t1407 = t84 * t1406;
  t1408 = t220 * t1407;
  t1418 = t549 * t27;
  t1419 = t1418 * t218;
  t1422 = t509 * t513;
  t1424 = t566 * t217;
  t1425 = t215 * t1424;
  t1429 = t540 * t190;
  t1436 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t306 - 0.6e1 * t1083);
  t1440 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1429 + 0.4e1 / 0.3e1 * t452 * t545 + 0.4e1 / 0.3e1 * t71 * t1436);
  t1441 = t5 * t1440;
  t1448 = -0.35e2 / 0.27e2 * t219 * t1408 + 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1297 / 0.3e1 - t1300 / 0.3e1 + 0.7e1 / 0.18e2 * t1302 - t1419 * t221 / 0.2e1 - t1422 * t221 - t1425 * t221 / 0.2e1 + t1236 / 0.9e1 - 0.3e1 / 0.8e1 * t1441 * t101 - 0.9e1 / 0.8e1 * t550 * t212 - 0.9e1 / 0.8e1 * t194 * t568;
  t1449 = t532 * rho[1];
  t1451 = 0.1e1 / t78 / t1449;
  t1452 = t75 * t1451;
  t1455 = t1407 * t206;
  t1462 = t893 * t796;
  t1463 = t532 * t197;
  t1464 = 0.1e1 / t1463;
  t1466 = 0.1e1 / t561 / t91;
  t1467 = t1464 * t1466;
  t1470 = -0.2464e4 / 0.2187e4 * t29 * t1452 - 0.28e3 / 0.729e3 * t130 * t1455 + 0.224e3 / 0.2187e4 * t331 * sigma[2] * t1451 * t562 - 0.512e3 / 0.59049e5 * t1462 * t1467;
  t1472 = t27 * t1470 * t100;
  t1484 = t216 * t216;
  t1485 = 0.1e1 / t1484;
  t1486 = t94 * t1485;
  t1487 = t215 * t1486;
  t1488 = t99 * t796;
  t1489 = t1464 * t2;
  t1491 = t1488 * t1489 * t28;
  t1494 = t1418 * t224;
  t1497 = t509 * t594;
  t1500 = t566 * t98;
  t1501 = t215 * t1500;
  t1504 = -0.3e1 / 0.8e1 * t74 * t1472 - 0.3e1 / 0.8e1 * t1305 - 0.3e1 / 0.4e1 * t1307 - 0.3e1 / 0.8e1 * t1311 + t1214 / 0.4e1 + t1224 / 0.4e1 - t1101 + 0.7e1 / 0.18e2 * t591 * t523 + 0.7e1 / 0.18e2 * t595 * t523 - 0.64e2 / 0.243e3 * t1487 * t1491 - t1494 * t229 / 0.6e1 - t1497 * t229 / 0.3e1 - t1501 * t229 / 0.6e1;
  t1509 = t228 * t1455;
  t1514 = t529 * t227;
  t1515 = t215 * t1514;
  t1516 = t796 * t1464;
  t1517 = t29 * t206;
  t1518 = t1516 * t1517;
  t1521 = t218 * t578;
  t1522 = t215 * t1521;
  t1523 = t29 * t562;
  t1524 = t1516 * t1523;
  t1529 = t226 * t226;
  t1530 = 0.1e1 / t1529;
  t1531 = t224 * t1530;
  t1532 = t215 * t1531;
  t1534 = t1466 * t2 * t28;
  t1535 = t1516 * t1534;
  t1542 = t509 * t530;
  t1545 = -t1339 / 0.9e1 - t1342 / 0.9e1 + 0.7e1 / 0.54e2 * t1344 - 0.35e2 / 0.81e2 * t225 * t1509 + t1245 / 0.27e2 - 0.8e1 / 0.81e2 * t1356 - 0.64e2 / 0.729e3 * t1515 * t1518 - 0.64e2 / 0.2187e4 * t1522 * t1524 - 0.32e2 / 0.2187e4 * t572 * t1524 - 0.64e2 / 0.6561e4 * t1532 * t1535 - 0.64e2 / 0.6561e4 * t580 * t1535 - 0.64e2 / 0.19683e5 * t587 * t1535 - 0.8e1 / 0.27e2 * t1542 * t537;
  t1546 = t210 * t528;
  t1547 = t1546 * t99;
  t1548 = t215 * t1547;
  t1552 = t1451 * t41 * t3;
  t1553 = t75 * t1552;
  t1556 = t509 * t579;
  t1559 = t594 * t578;
  t1560 = t215 * t1559;
  t1563 = t509 * t586;
  t1566 = t594 * t227;
  t1567 = t215 * t1566;
  t1570 = t509 * t571;
  t1573 = t513 * t227;
  t1574 = t215 * t1573;
  t1577 = t1452 * t573;
  t1580 = t1452 * t582;
  t1588 = -0.8e1 / 0.27e2 * t1548 * t537 + 0.56e2 / 0.81e2 * t531 * t1553 - 0.8e1 / 0.243e3 * t1556 * t583 - 0.8e1 / 0.243e3 * t1560 * t583 - 0.4e1 / 0.243e3 * t1563 * t583 - 0.4e1 / 0.243e3 * t1567 * t583 - 0.8e1 / 0.81e2 * t1570 * t574 - 0.8e1 / 0.81e2 * t1574 * t574 + 0.56e2 / 0.243e3 * t572 * t1577 + 0.56e2 / 0.729e3 * t580 * t1580 + 0.28e2 / 0.729e3 * t587 * t1580 - 0.8e1 / 0.729e3 * t1362 - 0.4e1 / 0.729e3 * t1365 - 0.8e1 / 0.243e3 * t1368;
  t1591 = my_piecewise3(t65, 0, t1448 + t1504 + t1545 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1404 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1599 = t1049 * t659;
  t1601 = t1043 * t659;
  t1605 = t1046 * t647;
  t1609 = t285 * t32;
  t1610 = 0.1e1 / t1609;
  t1611 = t1610 * t2;
  t1613 = t28 * t44 * t134;
  t1614 = t1611 * t1613;
  t1618 = t28 * t334 * t44;
  t1619 = t1611 * t1618;
  t1624 = t244 * t281;
  t1625 = t1624 * t59;
  t1626 = t143 * t1625;
  t1629 = t30 * t287;
  t1630 = t1629 * t346;
  t1633 = t1629 * t352;
  t1638 = t1610 * t898;
  t1639 = t29 * t44;
  t1640 = t1638 * t1639;
  t1643 = 0.2e1 / 0.243e3 * t1056 * t659 + t1033 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1599 + t1601 / 0.729e3 + 0.2e1 / 0.81e2 * t1040 * t647 + 0.2e1 / 0.243e3 * t1605 + 0.2e1 / 0.81e2 * t1053 * t647 + 0.8e1 / 0.243e3 * t993 * t1614 + 0.8e1 / 0.729e3 * t1012 * t1619 + 0.4e1 / 0.729e3 * t351 * t1619 - 0.8e1 / 0.81e2 * t1626 * t290 - 0.5e1 / 0.243e3 * t359 * t1630 - 0.5e1 / 0.81e2 * t351 * t1633 - 0.5e1 / 0.486e3 * t344 * t1630 + 0.8e1 / 0.6561e4 * t344 * t1640;
  t1654 = t239 * t294;
  t1655 = t148 * t1654;
  t1660 = t865 * t249;
  t1665 = t854 * t249 / 0.72e2;
  t1666 = t375 * t650;
  t1670 = t364 * t626;
  t1673 = t374 * t626;
  t1674 = t1673 * t149;
  t1676 = t621 * t145;
  t1677 = t143 * t1676;
  t1680 = 0.2e1 / 0.243e3 * t1060 * t659 + t1037 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t1018 * t1640 + 0.8e1 / 0.2187e4 * t359 * t1640 - t379 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1655 + 0.7e1 / 0.18e2 * t627 * t392 + t1660 / 0.24e2 - t365 * t650 / 0.6e1 - t1665 - t1666 / 0.18e2 + t861 * t249 / 0.16e2 - t1670 * t149 / 0.3e1 - t1674 / 0.9e1 - t1677 * t149 / 0.3e1;
  t1686 = t857 * t249;
  t1689 = t369 * t244 * t60;
  t1691 = t26 * t1689 / 0.12e2;
  t1692 = t113 * t608;
  t1699 = t117 * t621 * t60;
  t1700 = t26 * t1699;
  t1704 = t1654 * t134;
  t1711 = t898 * t44;
  t1714 = 0.176e3 / 0.729e3 * t29 * t1629 + 0.14e2 / 0.243e3 * t130 * t1704 - 0.2e2 / 0.729e3 * t330 * t1629 * t334 + 0.64e2 / 0.19683e5 * t893 * t1610 * t1711;
  t1716 = t27 * t1714 * t60;
  t1721 = t156 * t1704;
  t1724 = t981 * t252;
  t1729 = t984 * t252 / 0.216e3;
  t1730 = t385 * t662;
  t1732 = t869 * t249 / 0.16e2 + t872 * t249 / 0.8e1 + t1686 / 0.24e2 + t1691 - t1692 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t246 - 0.3e1 / 0.4e1 * t113 * t623 - t1700 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1716 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1721 + t1724 / 0.72e2 - t382 * t662 / 0.18e2 - t1729 - t1730 / 0.54e2;
  t1733 = t641 * t289;
  t1738 = t364 * t630;
  t1741 = t374 * t630;
  t1742 = t1741 * t157;
  t1746 = t143 * t987;
  t1750 = t59 * t1610 * t1639;
  t1757 = t974 * t252;
  t1759 = t621 * t58;
  t1760 = t143 * t1759;
  t1763 = t364 * t282;
  t1766 = t374 * t282;
  t1767 = t1766 * t644;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t357;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -0.5e1 / 0.27e2 * t640 * t1733 + 0.7e1 / 0.54e2 * t631 * t297 - t1738 * t157 / 0.9e1 - t1742 / 0.27e2 + t978 * t252 / 0.48e2 + 0.2e1 / 0.27e2 * t1746 * t644 + 0.8e1 / 0.81e2 * t955 * t1750 + t966 * t252 / 0.48e2 + t971 * t252 / 0.24e2 + t1757 / 0.72e2 - t1760 * t157 / 0.9e1 + 0.2e1 / 0.27e2 * t1763 * t644 + 0.2e1 / 0.81e2 * t1767 - 0.8e1 / 0.243e3 * t1770 * t353 - 0.8e1 / 0.729e3 * t1774 * t347 - 0.4e1 / 0.729e3 * t1778 * t347;
  t1784 = my_piecewise3(t1, 0, t1643 + t1680 + t1732 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t369 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1231 * t270;
  t1800 = t1235 * t270 / 0.72e2;
  t1803 = t1241 * t273;
  t1806 = t1244 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1227 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1238 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1819 = t1119 * t249;
  t1823 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1599 / 0.729e3 + t1601 / 0.1458e4 + t1605 / 0.243e3 + t1819 / 0.48e2 - t440 * t650 / 0.12e2 - t1823 * t149 / 0.6e1 + t1115 * t249 / 0.16e2 + t1111 * t249 / 0.16e2 + t1660 / 0.48e2 - t1665 - t1666 / 0.36e2 - t1674 / 0.18e2 + t1686 / 0.48e2 - t1834 / 0.8e1;
  t1843 = t439 * t282;
  t1850 = t1165 * t252;
  t1857 = t439 * t630;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 + t1691 - t1692 / 0.8e1 - t1700 / 0.8e1 + t1843 * t644 / 0.27e2 + t1162 * t252 / 0.48e2 + t1168 * t252 / 0.48e2 + t1850 / 0.144e3 - t443 * t662 / 0.36e2 + t1724 / 0.144e3 - t1729 - t1730 / 0.108e3 - t1742 / 0.54e2 - t1857 * t157 / 0.18e2 + t1757 / 0.144e3 + t1767 / 0.81e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1866 = t1296 * t270;
  t1868 = t1299 * t270;
  t1870 = t473 * t713;
  t1883 = t1361 * t742;
  t1885 = t1364 * t742;
  t1887 = t1367 * t732;
  t1892 = t478 * t735;
  t1894 = t477 * t713;
  t1895 = t1894 * t221;
  t1899 = t1866 / 0.48e2 + t1868 / 0.48e2 - t1870 * t221 / 0.6e1 + t1292 * t270 / 0.16e2 + t1286 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1376 * t742 / 0.486e3 + t1370 * t732 / 0.81e2 + t1883 / 0.729e3 + t1885 / 0.1458e4 + t1887 / 0.243e3 + t1373 * t742 / 0.243e3 + t1797 / 0.48e2 - t1800 - t1892 / 0.36e2 - t1895 / 0.18e2 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t194 * t673;
  t1906 = t117 * t708 * t100;
  t1907 = t74 * t1906;
  t1909 = t1341 * t273;
  t1911 = t484 * t745;
  t1913 = t477 * t717;
  t1914 = t1913 * t229;
  t1916 = t477 * t529;
  t1917 = t1916 * t729;
  t1919 = t1338 * t273;
  t1921 = t473 * t529;
  t1930 = t473 * t717;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1789 / 0.8e1 + t1794 - t1903 / 0.8e1 - t1907 / 0.8e1 + t1909 / 0.144e3 - t1911 / 0.108e3 - t1914 / 0.54e2 + t1917 / 0.81e2 + t1919 / 0.144e3 + t1921 * t729 / 0.27e2 + t1348 * t273 / 0.48e2 + t1351 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1930 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1691 + t1273 * t249 / 0.16e2 + t1819 / 0.24e2 - t1665 + t1276 * t252 / 0.48e2 + t1850 / 0.72e2 - t1729);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t708 * t217;
  t1953 = t215 * t1952;
  t1962 = t509 * t713;
  t1967 = t260 * t520;
  t1968 = t220 * t1967;
  t1977 = t713 * t227;
  t1978 = t215 * t1977;
  t1981 = t717 * t578;
  t1982 = t215 * t1981;
  t1985 = t717 * t227;
  t1986 = t215 * t1985;
  t1989 = t30 * t534;
  t1990 = t1989 * t573;
  t1993 = -t1953 * t221 / 0.3e1 + t1419 * t270 / 0.16e2 + t1422 * t270 / 0.8e1 + t1425 * t270 / 0.16e2 - t1962 * t221 / 0.3e1 + t1866 / 0.24e2 + t1868 / 0.24e2 + 0.7e1 / 0.36e2 * t219 * t1968 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t714 * t598 - 0.8e1 / 0.243e3 * t1978 * t574 - 0.8e1 / 0.729e3 * t1982 * t583 - 0.4e1 / 0.729e3 * t1986 * t583 - 0.5e1 / 0.81e2 * t572 * t1990;
  t1994 = t532 * t76;
  t1995 = 0.1e1 / t1994;
  t1996 = t1995 * t2;
  t1998 = t28 * t84 * t206;
  t1999 = t1996 * t1998;
  t2003 = t28 * t562 * t84;
  t2004 = t1996 * t2003;
  t2015 = t265 * t528;
  t2016 = t2015 * t99;
  t2017 = t215 * t2016;
  t2020 = t1989 * t582;
  t2026 = t1995 * t1466;
  t2027 = t29 * t84;
  t2028 = t2026 * t2027;
  t2037 = 0.8e1 / 0.243e3 * t1515 * t1999 + 0.8e1 / 0.729e3 * t1522 * t2004 + 0.4e1 / 0.729e3 * t572 * t2004 + 0.2e1 / 0.243e3 * t1556 * t742 + 0.2e1 / 0.81e2 * t1570 * t732 + 0.2e1 / 0.81e2 * t1574 * t732 - 0.8e1 / 0.81e2 * t2017 * t537 - 0.5e1 / 0.243e3 * t580 * t2020 + 0.2e1 / 0.729e3 * t1883 + t1885 / 0.729e3 + 0.2e1 / 0.243e3 * t1887 + 0.8e1 / 0.2187e4 * t1532 * t2028 + 0.8e1 / 0.2187e4 * t580 * t2028 - 0.5e1 / 0.486e3 * t587 * t2020 + 0.8e1 / 0.6561e4 * t587 * t2028;
  t2053 = t1967 * t206;
  t2060 = t1466 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1989 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t330 * t1989 * t562 + 0.64e2 / 0.19683e5 * t893 * t1995 * t2060;
  t2065 = t27 * t2063 * t100;
  t2076 = t1563 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t1560 * t742 + t1567 * t742 / 0.243e3 - t1800 - t1892 / 0.18e2 - t1895 / 0.9e1 - 0.3e1 / 0.8e1 * t550 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 + t1794 - t1903 / 0.4e1 - t1907 / 0.4e1 + 0.7e1 / 0.54e2 * t718 * t523 + t1494 * t273 / 0.48e2 + t1497 * t273 / 0.24e2;
  t2079 = t509 * t529;
  t2082 = t215 * t1546;
  t2086 = t99 * t1995 * t2027;
  t2089 = t509 * t717;
  t2092 = t708 * t98;
  t2093 = t215 * t2092;
  t2101 = t228 * t2053;
  t2106 = t726 * t536;
  t2111 = t1501 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2079 * t729 + 0.2e1 / 0.27e2 * t2082 * t729 + 0.8e1 / 0.81e2 * t1487 * t2086 - t2089 * t229 / 0.9e1 - t2093 * t229 / 0.9e1 + t1909 / 0.72e2 - t1911 / 0.54e2 - t1914 / 0.27e2 + 0.2e1 / 0.81e2 * t1917 + t1919 / 0.72e2 + 0.7e1 / 0.108e3 * t225 * t2101 - t595 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t725 * t2106 - t591 * t745 / 0.18e2 - t1806;
  t2114 = my_piecewise3(t65, 0, t1993 + t2037 + t2076 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2119 = t375 * t783 / 0.96e2;
  t2120 = t754 * t132;
  t2121 = t148 * t2120;
  t2125 = t1673 * t249 / 0.24e2;
  t2126 = t764 * t145;
  t2127 = t143 * t2126;
  t2139 = t1046 * t780 / 0.648e3;
  t2140 = t773 * t124;
  t2141 = t2140 * t352;
  t2145 = t1049 * t786 / 0.1944e4;
  t2146 = -t627 * t650 / 0.6e1 - t2119 + t147 * t2121 / 0.24e2 + t2125 - t2127 * t149 / 0.6e1 + t1670 * t249 / 0.8e1 + t1677 * t249 / 0.8e1 - t365 * t783 / 0.32e2 - t379 * t783 / 0.32e2 - t2139 + t351 * t2141 / 0.162e3 - t2145;
  t2147 = t2140 * t346;
  t2165 = t1043 * t786 / 0.3888e4;
  t2167 = t1025 * t776 / 0.216e3;
  t2168 = t773 * t643;
  t2171 = 0.1e1 / t880;
  t2172 = t239 * t2171;
  t2173 = t2172 * t1005;
  t2176 = t344 * t2147 / 0.972e3 - t1033 * t786 / 0.1296e4 - t1037 * t786 / 0.1296e4 - t1040 * t780 / 0.216e3 - t1053 * t780 / 0.216e3 - t1056 * t786 / 0.648e3 - t1060 * t786 / 0.648e3 + t359 * t2147 / 0.486e3 - t2165 - t2167 + t284 * t2168 / 0.54e2 - t359 * t2173 / 0.729e3;
  t2188 = t2172 * t995;
  t2191 = t2172 * t1000;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = -t344 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t1774 * t659 + t1778 * t659 / 0.243e3 - t1021 * t776 / 0.72e2 - t989 * t776 / 0.72e2 - t993 * t2188 / 0.81e2 - t1012 * t2191 / 0.243e3 - t351 * t2191 / 0.486e3 - t1018 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t1770 * t647 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2120 * t134;
  t2214 = t893 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t759 * t124 * t334 - 0.8e1 / 0.6561e4 * t2214 * t2171 * t898;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1741 * t252 / 0.72e2;
  t2232 = t143 * t1624;
  t2239 = t59 * t239;
  t2242 = t2239 * t2171 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1738 * t252 / 0.24e2 + t1760 * t252 / 0.24e2 - t955 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2146 + t2176 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1894 * t270 / 0.24e2;
  t2271 = t1913 * t273 / 0.72e2;
  t2275 = t1355 * t819 / 0.216e3;
  t2279 = t1367 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1361 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1364 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1870 * t270 / 0.8e1 + t2267 + t1930 * t273 / 0.24e2 + t2271 - t1358 * t819 / 0.72e2 - t2275 - t1370 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1373 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1376 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1823 * t249 / 0.8e1 + t2125 + t1857 * t252 / 0.24e2 + t2229 - t1175 * t776 / 0.72e2 - t2167 - t1179 * t780 / 0.216e3 - t2139 - t440 * t783 / 0.32e2 - t2119 - t1182 * t786 / 0.648e3 - t2145 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2165;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2322 = t797 * t204;
  t2323 = t220 * t2322;
  t2326 = t807 * t217;
  t2327 = t215 * t2326;
  t2338 = t816 * t199;
  t2339 = t2338 * t573;
  t2342 = t2338 * t582;
  t2347 = t2267 - t2283 - t714 * t735 / 0.6e1 + t219 * t2323 / 0.24e2 - t2327 * t221 / 0.6e1 + t1962 * t270 / 0.8e1 + t1953 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 + t572 * t2339 / 0.162e3 + t580 * t2342 / 0.486e3 + t587 * t2342 / 0.972e3;
  t2366 = -t1563 * t829 / 0.1296e4 - t1567 * t829 / 0.1296e4 - t1570 * t823 / 0.216e3 - t1574 * t823 / 0.216e3 - t1556 * t829 / 0.648e3 - t1560 * t829 / 0.648e3 - t2279 - t2287 - t2295 + t1986 * t742 / 0.243e3 - t1542 * t819 / 0.72e2 - t1548 * t819 / 0.72e2;
  t2368 = 0.1e1 / t1449;
  t2369 = t260 * t2368;
  t2370 = t2369 * t1517;
  t2373 = t2369 * t1523;
  t2378 = t816 * t728;
  t2381 = t2369 * t1534;
  t2392 = t2322 * t206;
  t2399 = t893 * t260;
  t2403 = t130 * t2392 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t802 * t199 * t562 - 0.8e1 / 0.6561e4 * t2399 * t2368 * t1466;
  t2405 = t27 * t2403 * t100;
  t2410 = -t1515 * t2370 / 0.81e2 - t1522 * t2373 / 0.243e3 - t572 * t2373 / 0.486e3 - t2275 + t531 * t2378 / 0.54e2 - t1532 * t2381 / 0.729e3 - t580 * t2381 / 0.729e3 - t587 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t1978 * t732 + 0.2e1 / 0.243e3 * t1982 * t742 - 0.3e1 / 0.8e1 * t74 * t2405 - 0.3e1 / 0.8e1 * t194 * t809;
  t2411 = t228 * t2392;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2015;
  t2427 = t99 * t260;
  t2430 = t2427 * t2368 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2089 * t273 / 0.24e2 + t2093 * t273 / 0.24e2 - t1487 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2347 + t2366 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t346;
  t2455 = t2444 * t775;
  t2458 = 0.1e1 / t285;
  t2459 = t754 * t2458;
  t2460 = t2459 * t1005;
  t2463 = t2459 * t995;
  t2466 = t2459 * t1000;
  t2475 = t344 * t2446 / 0.864e3 - t1770 * t780 / 0.72e2 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t284 * t2455 / 0.48e2 + t344 * t2460 / 0.5832e4 + t993 * t2463 / 0.216e3 + t1012 * t2466 / 0.648e3 + t351 * t2466 / 0.1296e4 + t1018 * t2460 / 0.1944e4 + t359 * t2460 / 0.1944e4;
  t2477 = 0.1e1 / t44 / t2442;
  t2478 = t2477 * t47;
  t2479 = t2478 * t134;
  t2480 = t156 * t2479;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2478;
  t2502 = t2445 * t352;
  t2514 = t2458 * t898;
  t2517 = t130 * t2479 / 0.72e2 + t331 * t2443 * t36 * t334 / 0.324e3 + t893 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t153 * t2480 / 0.64e2 - t1626 * t776 / 0.24e2 - t631 * t789 / 0.32e2 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t955 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2127 * t249 + t351 * t2502 / 0.144e3 + t359 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2475 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2526 = 0.1e1 / t2525;
  t2527 = t30 * t2526;
  t2528 = t2527 * t80;
  t2529 = t2528 * t582;
  t2534 = t2527 * t818;
  t2542 = 0.1e1 / t84 / t2525;
  t2543 = t2542 * t87;
  t2544 = t2543 * t206;
  t2545 = t228 * t2544;
  t2548 = 0.1e1 / t532;
  t2549 = t797 * t2548;
  t2550 = t2549 * t1534;
  t2555 = t2549 * t1517;
  t2558 = t2549 * t1523;
  t2563 = t587 * t2529 / 0.864e3 - t1986 * t829 / 0.432e3 + t531 * t2534 / 0.48e2 - t1978 * t823 / 0.72e2 - t1982 * t829 / 0.216e3 + t225 * t2545 / 0.64e2 + t587 * t2550 / 0.5832e4 - t718 * t832 / 0.32e2 + t1515 * t2555 / 0.216e3 + t1522 * t2558 / 0.648e3 + t572 * t2558 / 0.1296e4;
  t2570 = t220 * t2543;
  t2579 = t2548 * t2 * t28;
  t2580 = t99 * t797 * t2579;
  t2587 = t2528 * t573;
  t2597 = t2548 * t1466;
  t2600 = t130 * t2544 / 0.72e2 + t331 * t2526 * t80 * t562 / 0.324e3 + t893 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1532 * t2550 / 0.1944e4 + t580 * t2550 / 0.1944e4 - t2017 * t819 / 0.24e2 + 0.3e1 / 0.64e2 * t219 * t2570 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1487 * t2580 / 0.72e2 + 0.3e1 / 0.16e2 * t2327 * t270 + t580 * t2529 / 0.432e3 + t572 * t2587 / 0.144e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2563 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t281, t282, t283, t284, t285, t287, t289, t290;
  double t294, t295, t296, t297, t300, t301, t302, t305;
  double t306, t307, t310, t314, t315, t321, t322, t324;
  double t330, t331, t333, t334, t338, t340, t343, t344;
  double t346, t347, t350, t351, t352, t353, t357, t358;
  double t359, t362, t364, t365, t369, t371, t373, t374;
  double t375, t376, t378, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t528;
  double t529, t530, t531, t532, t534, t536, t537, t540;
  double t545, t549, t550, t555, t561, t562, t566, t568;
  double t571, t572, t573, t574, t578, t579, t580, t582;
  double t583, t586, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t843, t848, t849, t850, t853, t854, t855, t857;
  double t858, t860, t861, t864, t865, t866, t868, t869;
  double t872, t877, t878, t880, t882, t883, t886, t893;
  double t894, t895, t896, t898, t899, t902, t904, t907;
  double t909, t911, t913, t915, t916, t918, t920, t922;
  double t925, t926, t929, t932, t933, t934, t937, t941;
  double t942, t947, t949, t952, t953, t954, t955, t956;
  double t957, t959, t966, t969, t971, t974, t975, t977;
  double t978, t981, t982, t984, t985, t987, t988, t989;
  double t992, t993, t994, t995, t996, t1000, t1001, t1005;
  double t1006, t1011, t1012, t1015, t1016, t1017, t1018, t1021;
  double t1024, t1025, t1026, t1029, t1030, t1033, t1036, t1037;
  double t1040, t1043, t1044, t1046, t1047, t1049, t1050, t1052;
  double t1053, t1056, t1059, t1060, t1063, t1066, t1071, t1074;
  double t1076, t1077, t1080, t1083, t1086, t1090, t1091, t1094;
  double t1096, t1099, t1101, t1103, tv3rho30, t1106, t1107, t1111;
  double t1114, t1115, t1118, t1119, t1121, t1127, t1130, t1135;
  double t1136, t1138, t1142, t1143, t1149, t1152, t1153, t1157;
  double t1162, t1165, t1167, t1168, t1175, t1179, t1182, t1185;
  double t1191, t1193, t1194, t1197, t1202, t1204, t1208, t1209;
  double t1213, t1214, t1221, t1223, t1224, t1226, t1227, t1230;
  double t1231, t1233, t1234, t1235, t1236, t1238, t1241, t1243;
  double t1244, t1245, t1247, t1248, tv3rho31, t1251, t1256, t1260;
  double t1264, t1265, t1268, t1272, t1273, t1276, t1284, t1285;
  double t1286, t1291, t1292, t1295, t1296, t1297, t1299, t1300;
  double t1302, t1305, t1307, t1310, t1311, t1313, t1318, t1322;
  double t1326, t1327, t1336, t1338, t1339, t1341, t1342, t1344;
  double t1348, t1351, t1355, t1356, t1358, t1361, t1362, t1364;
  double t1365, t1367, t1368, t1370, t1373, t1376, t1379, t1381;
  double tv3rho32, t1386, t1393, t1397, t1398, t1404, t1406, t1407;
  double t1408, t1418, t1419, t1422, t1424, t1425, t1429, t1436;
  double t1440, t1441, t1448, t1449, t1451, t1452, t1455, t1462;
  double t1463, t1464, t1466, t1467, t1470, t1472, t1484, t1485;
  double t1486, t1487, t1488, t1489, t1491, t1494, t1497, t1500;
  double t1501, t1504, t1509, t1514, t1515, t1516, t1517, t1518;
  double t1521, t1522, t1523, t1524, t1529, t1530, t1531, t1532;
  double t1534, t1535, t1542, t1545, t1546, t1547, t1548, t1552;
  double t1553, t1556, t1559, t1560, t1563, t1566, t1567, t1570;
  double t1573, t1574, t1577, t1580, t1588, t1591, tv3rho33, t1599;
  double t1601, t1605, t1609, t1610, t1611, t1613, t1614, t1618;
  double t1619, t1624, t1625, t1626, t1629, t1630, t1633, t1638;
  double t1639, t1640, t1643, t1654, t1655, t1660, t1665, t1666;
  double t1670, t1673, t1674, t1676, t1677, t1680, t1686, t1689;
  double t1691, t1692, t1699, t1700, t1704, t1711, t1714, t1716;
  double t1721, t1724, t1729, t1730, t1732, t1733, t1738, t1741;
  double t1742, t1746, t1750, t1757, t1759, t1760, t1763, t1766;
  double t1767, t1769, t1770, t1773, t1774, t1777, t1778, t1781;
  double t1784, tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800;
  double t1803, t1806, t1808, tv3rho2sigma2, t1819, t1823, t1834, t1836;
  double t1843, t1850, t1857, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1866;
  double t1868, t1870, t1883, t1885, t1887, t1892, t1894, t1895;
  double t1899, t1903, t1906, t1907, t1909, t1911, t1913, t1914;
  double t1916, t1917, t1919, t1921, t1930, t1934, t1936, tv3rho2sigma5;
  double t1949, tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1962, t1967, t1968;
  double t1977, t1978, t1981, t1982, t1985, t1986, t1989, t1990;
  double t1993, t1994, t1995, t1996, t1998, t1999, t2003, t2004;
  double t2015, t2016, t2017, t2020, t2026, t2027, t2028, t2037;
  double t2053, t2060, t2063, t2065, t2076, t2079, t2082, t2086;
  double t2089, t2092, t2093, t2101, t2106, t2111, t2114, tv3rho2sigma8;
  double t2119, t2120, t2121, t2125, t2126, t2127, t2139, t2140;
  double t2141, t2145, t2146, t2147, t2165, t2167, t2168, t2171;
  double t2172, t2173, t2176, t2188, t2191, t2201, t2203, t2206;
  double t2207, t2214, t2218, t2220, t2224, t2225, t2229, t2232;
  double t2239, t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275;
  double t2279, t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25;
  double t2317, t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2322;
  double t2323, t2326, t2327, t2338, t2339, t2342, t2347, t2366;
  double t2368, t2369, t2370, t2373, t2378, t2381, t2392, t2399;
  double t2403, t2405, t2410, t2411, t2416, t2417, t2420, t2427;
  double t2430, t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445;
  double t2446, t2455, t2458, t2459, t2460, t2463, t2466, t2475;
  double t2477, t2478, t2479, t2480, t2493, t2494, t2497, t2502;
  double t2514, t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2526;
  double t2527, t2528, t2529, t2534, t2542, t2543, t2544, t2545;
  double t2548, t2549, t2550, t2555, t2558, t2563, t2570, t2579;
  double t2580, t2587, t2597, t2600, t2602, t2605, t2607, tv3sigma39;

  double t2610, t2611, t2613, t2614, t2616, t2620, t2623, t2628;
  double t2629, t2639, t2643, t2645, t2647, t2648, t2649, t2651;
  double t2652, t2655, t2656, t2659, t2660, t2661, t2663, t2664;
  double t2665, t2667, t2668, t2670, t2671, t2679, t2681, t2682;
  double t2684, t2686, t2687, t2689, t2691, t2692, t2695, t2700;
  double t2703, t2705, t2709, t2710, t2714, t2719, t2722, t2725;
  double t2726, t2728, t2729, t2731, t2732, t2734, t2735, t2737;
  double t2738, t2744, t2747, t2751, t2755, t2758, t2759, t2762;
  double t2766, t2769, t2771, t2773, t2775, t2776, t2778, t2779;
  double t2781, t2782, t2784, t2785, t2787, t2788, t2792, t2795;
  double t2796, t2797, t2798, t2800, t2801, t2812, t2815, t2819;
  double t2823, t2825, t2826, t2829, t2833, t2837, t2839, t2842;
  double t2846, t2848, t2853, t2855, t2856, t2867, t2869, t2872;
  double t2873, t2875, t2877, t2883, t2884, t2885, t2892, t2908;
  double t2910, t2911, t2917, t2923, t2924, t2927, t2931, t2942;
  double t2946, t2947, t2949, t2953, t2955, t2958, t2960, t2962;
  double t2964, t2966, t2972, t2976, t2986, t2990, t2998, t3001;
  double t3004, t3005, t3008, t3011, t3012, t3022, t3029, t3034;
  double t3035, t3038, t3041, t3043, t3049, t3052, t3055, t3056;
  double t3058, t3059, t3061, t3063, t3068, t3069, t3071, t3072;
  double t3074, t3078, t3079, t3081, t3082, t3088, t3093, t3096;
  double t3100, t3104, t3106, t3108, t3113, t3115, tv4rho40, t3122;
  double t3123, t3129, t3133, t3134, t3135, t3136, t3137, t3139;
  double t3142, t3143, t3144, t3146, t3147, t3151, t3159, t3160;
  double t3163, t3164, t3166, t3167, t3169, t3172, t3175, t3183;
  double t3186, t3189, t3192, t3201, t3217, t3220, t3225, t3232;
  double t3235, t3238, t3239, t3241, t3246, t3248, t3250, t3251;
  double t3252, t3253, t3255, t3257, t3258, t3279, t3280, t3282;
  double t3286, t3296, t3311, t3317, t3319, t3326, t3329, t3332;
  double t3335, t3336, t3338, t3339, t3341, t3342, t3343, t3344;
  double t3348, t3349, t3350, t3351, t3352, t3353, t3354, t3355;
  double t3357, t3358, t3359, t3361, t3362, t3365, t3367, t3368;
  double t3371, t3373, t3374, t3375, t3377, t3400, t3402, t3406;
  double t3410, t3411, t3413, t3416, t3417, t3419, t3420, t3421;
  double t3422, t3423, tv4rho41, t3432, t3433, t3436, t3437, t3438;
  double t3440, t3451, t3454, t3455, t3458, t3467, t3472, t3474;
  double t3484, t3497, t3501, t3505, t3509, t3522, t3535, t3536;
  double t3538, t3541, t3544, t3547, t3548, t3549, t3551, t3553;
  double t3554, t3555, t3557, t3558, t3559, t3561, t3562, t3564;
  double t3568, t3569, t3572, t3578, t3579, t3581, t3582, t3583;
  double t3585, t3586, t3588, t3589, t3591, t3594, t3597, t3600;
  double t3601, t3603, t3604, t3606, t3609, t3610, t3612, t3613;
  double t3619, t3621, t3623, t3625, t3635, t3648, t3652, t3658;
  double t3660, t3662, t3670, t3676, t3678, t3679, t3681, t3682;
  double t3686, t3689, t3692, t3693, t3695, t3696, t3698, t3700;
  double t3703, tv4rho42, t3724, t3728, t3732, t3736, t3737, t3740;
  double t3753, t3754, t3755, t3756, t3757, t3759, t3760, t3762;
  double t3763, t3767, t3774, t3775, t3778, t3780, t3782, t3784;
  double t3787, t3795, t3804, t3807, t3809, t3812, t3815, t3818;
  double t3821, t3823, t3825, t3826, t3828, t3830, t3831, t3833;
  double t3834, t3836, t3837, t3839, t3840, t3842, t3843, t3845;
  double t3851, t3852, t3854, t3855, t3857, t3859, t3860, t3862;
  double t3864, t3866, t3867, t3869, t3871, t3872, t3874, t3881;
  double t3888, t3891, t3894, t3897, t3918, t3922, t3928, t3933;
  double t3935, t3937, t3941, t3949, t3961, t3962, t3963, t3965;
  double t3966, t3968, t3969, t3971, t3972, t3974, t3976, t3978;
  double t3982, t3985, t3988, t3991, t3998, t4002, tv4rho43, t4007;
  double t4012, t4019, t4023, t4031, t4033, t4034, t4051, t4052;
  double t4055, t4058, t4062, t4068, t4073, t4077, t4092, t4096;
  double t4099, t4102, t4106, t4109, t4111, t4115, t4116, t4120;
  double t4125, t4140, t4143, t4146, t4147, t4149, t4150, t4153;
  double t4157, t4160, t4163, t4166, t4167, t4168, t4174, t4180;
  double t4182, t4183, t4184, t4186, t4187, t4202, t4207, t4209;
  double t4212, t4216, t4220, t4222, t4227, t4229, t4230, t4235;
  double t4239, t4243, t4254, t4278, t4291, t4299, t4304, t4311;
  double t4315, t4324, t4341, t4354, t4364, t4367, t4370, t4374;
  double t4382, t4386, t4393, t4397, tv4rho44, t4401, t4403, t4407;
  double t4413, t4416, t4418, t4419, t4421, t4422, t4426, t4443;
  double t4445, t4449, t4451, t4453, t4454, t4456, t4459, t4460;
  double t4462, t4464, t4468, t4472, t4473, t4476, t4479, t4481;
  double t4485, t4488, t4489, t4491, t4492, t4494, t4497, t4506;
  double t4509, t4511, t4514, t4520, t4522, t4524, t4525, t4528;
  double t4530, t4540, t4543, t4544, t4548, t4560, t4566, t4571;
  double t4575, t4578, t4584, t4590, t4594, t4614, t4618, t4620;
  double t4622, t4624, t4633, t4638, t4639, t4642, t4644, t4647;
  double t4649, t4653, t4657, t4684, t4686, t4688, t4690, t4693;
  double t4694, t4698, t4706, t4712, t4714, t4716, t4730, t4737;
  double t4739, t4752, t4755, t4756, t4759, t4761, t4763, t4765;
  double t4776, t4778, t4781, t4782, t4784, t4790, t4794, t4796;
  double t4801, t4804, t4809, t4811, t4814, t4815, t4819, t4821;
  double t4822, t4825, t4833, t4840, t4843, t4847, t4870, t4875;
  double tv4rho3sigma0, tv4rho3sigma1, t4880, t4882, t4887, t4890, t4892, t4895;
  double t4898, t4900, t4903, t4904, t4905, tv4rho3sigma2, t4907, t4908;
  double t4911, t4921, t4923, t4928, t4930, t4933, t4936, t4940;
  double t4955, t4958, t4961, t4964, t4977, t4979, t4982, t4985;
  double t4993, t4995, t5008, t5011, t5015, t5038, t5053, t5069;
  double t5072, t5073, t5077, t5083, t5084, t5086, t5087, t5092;
  double t5109, t5112, t5116, tv4rho3sigma3, tv4rho3sigma4, t5118, t5119, t5121;
  double t5122, t5124, t5126, t5133, t5134, t5136, t5138, t5140;
  double t5141, t5146, t5150, t5152, t5157, t5161, t5165, t5167;
  double t5169, t5172, t5173, t5176, t5178, t5187, t5189, t5191;
  double t5192, t5193, t5196, t5198, t5200, t5201, t5204, t5206;
  double t5208, t5211, t5218, t5224, t5227, tv4rho3sigma5, t5233, t5236;
  double t5243, t5252, t5257, t5266, t5270, t5279, t5287, t5290;
  double tv4rho3sigma6, tv4rho3sigma7, t5292, t5294, t5295, t5297, t5299, t5300;
  double t5302, t5304, t5312, t5323, t5326, t5338, t5342, t5344;
  double t5346, t5359, t5370, t5379, t5380, t5383, t5385, t5387;
  double t5388, t5390, t5392, t5394, t5397, t5399, t5401, t5403;
  double t5405, t5407, t5410, t5412, t5415, t5417, t5419, t5421;
  double t5422, t5424, t5426, t5428, t5430, t5432, t5434, t5436;
  double t5438, t5440, t5442, t5443, t5445, t5447, t5473, t5479;
  double t5487, t5488, t5490, t5491, t5493, t5496, t5499, t5502;
  double t5503, t5504, t5506, t5508, t5510, t5518, t5522, tv4rho3sigma8;
  double t5537, t5538, tv4rho3sigma9, tv4rho3sigma10, t5552, t5555, t5556, t5566;
  double t5589, t5614, t5617, t5633, t5637, t5640, t5644, t5651;
  double t5682, t5685, t5688, t5695, t5699, t5717, t5724, t5741;
  double t5759, t5762, t5764, t5768, t5789, t5797, t5802, t5813;
  double t5819, t5828, t5840, t5849, t5852, t5855, t5859, t5864;
  double t5868, t5883, t5890, t5893, t5904, t5911, t5927, t5932;
  double tv4rho3sigma11, t5935, t5936, t5946, t5958, t5959, t5963, t5977;
  double t5979, t5981, t5997, t6022, t6026, t6028, t6030, t6033;
  double t6037, t6039, t6042, t6044, t6064, t6065, t6067, t6070;
  double t6074, t6080, t6084, t6088, t6089, t6096, t6098, t6105;
  double t6112, t6137, t6139, t6144, t6145, t6148, t6151, t6154;
  double t6158, t6179, t6180, t6184, t6191, t6195, t6196, t6202;
  double t6204, t6206, t6207, t6209, t6211, t6215, t6220, t6231;
  double t6240, t6242, t6251, t6255, t6258, t6260, t6262, t6264;
  double t6266, t6279, t6283, t6284, t6289, t6290, t6311, t6315;
  double t6317, t6323, t6325, t6327, t6328, t6330, t6334, t6337;
  double t6341, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t6344, t6349;
  double t6354, t6357, t6358, t6361, t6362, t6365, t6372, t6378;
  double t6380, t6381, t6383, t6386, t6387, t6390, t6391, t6394;
  double t6395, t6401, t6403, tv4rho2sigma25, t6405, t6425, t6430, t6445;
  double t6463, t6468, t6475, t6477, t6483, t6493, t6497, t6499;
  double t6503, t6519, t6531, t6537, t6541, t6543, t6554, t6558;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6564, t6568, t6583;
  double t6596, t6598, t6600, t6602, t6604, t6606, t6608, t6610;
  double t6612, t6614, t6616, t6618, t6620, t6627, t6633, t6635;
  double t6637, t6639, t6641, t6642, t6644, t6646, t6648, t6650;
  double t6652, t6660, t6669, t6671, t6673, t6675, t6677, t6679;
  double t6681, t6682, t6684, t6686, t6706, t6713, t6715, t6717;
  double t6718, t6720, t6722, t6724, t6725, t6727, t6733, t6744;
  double t6748, tv4rho2sigma211, t6765, t6779, t6781, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214;
  double tv4rho2sigma215, tv4rho2sigma216, t6787, t6788, t6807, t6814, t6818, t6825;
  double t6839, t6850, t6851, t6885, t6919, t6928, t6934, t6936;
  double t6957, t6958, t6962, t6994, t7013, t7014, t7050, t7053;
  double t7056, t7060, t7078, t7103, t7107, t7121, t7125, tv4rho2sigma217;
  double t7146, t7147, t7148, t7151, t7158, t7164, t7184, t7186;
  double t7187, t7215, t7226, t7246, t7249, t7253, t7255, t7256;
  double t7257, t7262, t7263, t7264, t7268, t7272, t7274, t7283;
  double t7293, t7295, t7299, t7310, t7320, t7322, t7324, t7326;
  double t7328, t7333, t7354, t7355, t7369, t7375, t7380, t7384;
  double t7385, t7389, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t7392, t7394, t7396, t7398, t7413;
  double t7417, t7419, t7421, t7423, t7433, t7435, t7436, t7439;
  double t7441, t7443, t7445, t7447, t7449, t7451, t7453, t7460;
  double t7472, t7480, t7482, t7484, t7485, t7488, tv4rhosigma39, t7508;
  double t7523, t7529, t7538, t7541, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t7544, t7545, t7546;
  double t7555, t7574, t7600, t7603, t7628, t7641, t7642, t7646;
  double t7663, t7674, t7681, t7682, t7703, t7731, t7735, t7755;
  double t7759, tv4rhosigma319, t7761, t7762, t7765, t7770, t7771, t7774;
  double t7789, t7796, t7797, t7798, t7804, t7820, t7847, t7848;
  double t7856, t7859, t7863, t7901, t7904, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t7907, t7908, t7913, t7916, t7917;
  double t7918, t7922, t7923, t7930, t7937, t7941, t7965, t7973;
  double t7974, t8016, t8023, t8027, t8045, t8048, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = 0.1e1 / t144 / t57;
  t282 = t54 * t281;
  t283 = t282 * t59;
  t284 = t143 * t283;
  t285 = t32 * t32;
  t287 = 0.1e1 / t34 / t285;
  t289 = t287 * t41 * t3;
  t290 = t31 * t289;
  t294 = 0.1e1 / t33 / t122;
  t295 = t44 * t294;
  t296 = t295 * t134;
  t297 = t156 * t296;
  t300 = t23 * t23;
  t301 = 0.1e1 / t300;
  t302 = t109 * t109;
  t305 = t105 * t6;
  t306 = 0.1e1 / t305;
  t307 = t16 * t306;
  t310 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t307);
  t314 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t302 + 0.4e1 / 0.3e1 * t23 * t310);
  t315 = t5 * t314;
  t321 = t117 * t138 * t60;
  t322 = t26 * t321;
  t324 = t31 * t287;
  t330 = t28 * t40 * t2;
  t331 = t330 * t30;
  t333 = t51 * t51;
  t334 = 0.1e1 / t333;
  t338 = 0.176e3 / 0.729e3 * t29 * t324 + 0.28e2 / 0.243e3 * t130 * t296 - 0.32e2 / 0.2187e4 * t331 * sigma[0] * t287 * t334;
  t340 = t27 * t338 * t60;
  t343 = t152 * t155;
  t344 = t143 * t343;
  t346 = t334 * t41 * t3;
  t347 = t324 * t346;
  t350 = t146 * t155;
  t351 = t143 * t350;
  t352 = t42 * t134;
  t353 = t324 * t352;
  t357 = 0.1e1 / t154 / t52;
  t358 = t152 * t357;
  t359 = t143 * t358;
  t362 = t113 * t119;
  t364 = t112 * t27;
  t365 = t364 * t146;
  t369 = 0.1e1 / t116 / t6;
  t371 = t369 * t54 * t60;
  t373 = t26 * t371 / 0.12e2;
  t374 = t25 * t117;
  t375 = t374 * t146;
  t376 = t375 * t149;
  t378 = t138 * t145;
  t379 = t143 * t378;
  t382 = t364 * t152;
  t385 = t374 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t295;
  t395 = -0.8e1 / 0.81e2 * t284 * t290 + 0.7e1 / 0.54e2 * t153 * t297 - 0.3e1 / 0.8e1 * t315 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t322 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t340 - 0.4e1 / 0.729e3 * t344 * t347 - 0.8e1 / 0.243e3 * t351 * t353 - 0.8e1 / 0.729e3 * t359 * t347 - t362 / 0.4e1 - t365 * t149 / 0.3e1 + t373 - t376 / 0.9e1 - t379 * t149 / 0.3e1 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t306;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t369 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t301 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t307);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t362 / 0.8e1 + t373 - t322 / 0.8e1 - t376 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t307);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t301 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t373);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t77 / t197;
  t521 = t84 * t520;
  t522 = t521 * t206;
  t523 = t228 * t522;
  t528 = 0.1e1 / t216 / t97;
  t529 = t94 * t528;
  t530 = t529 * t99;
  t531 = t215 * t530;
  t532 = t76 * t76;
  t534 = 0.1e1 / t78 / t532;
  t536 = t534 * t41 * t3;
  t537 = t75 * t536;
  t540 = t190 * t190;
  t545 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t549 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t540 + 0.4e1 / 0.3e1 * t71 * t545);
  t550 = t5 * t549;
  t555 = t75 * t534;
  t561 = t91 * t91;
  t562 = 0.1e1 / t561;
  t566 = 0.176e3 / 0.729e3 * t29 * t555 + 0.28e2 / 0.243e3 * t130 * t522 - 0.32e2 / 0.2187e4 * t331 * sigma[2] * t534 * t562;
  t568 = t27 * t566 * t100;
  t571 = t218 * t227;
  t572 = t215 * t571;
  t573 = t42 * t206;
  t574 = t555 * t573;
  t578 = 0.1e1 / t226 / t92;
  t579 = t224 * t578;
  t580 = t215 * t579;
  t582 = t562 * t41 * t3;
  t583 = t555 * t582;
  t586 = t224 * t227;
  t587 = t215 * t586;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t521;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + 0.7e1 / 0.54e2 * t225 * t523 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t531 * t537 - 0.3e1 / 0.8e1 * t550 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t568 - 0.8e1 / 0.243e3 * t572 * t574 - 0.8e1 / 0.729e3 * t580 * t583 - 0.4e1 / 0.729e3 * t587 * t583 + t418 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t330 * t611 * t334;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t375 * t249 / 0.48e2;
  t640 = t143 * t282;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t352;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t346;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t365 * t249 / 0.16e2 + t637 + t379 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t351 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t359 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t344 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t330 * t698 * t562;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t529;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t573;
  t735 = t220 * t701;
  t742 = t698 * t582;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t572 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t580 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t587 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t331 * t759 * t36 * t334 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t352;
  t783 = t148 * t755;
  t786 = t779 * t346;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t284 * t776 / 0.72e2 - t351 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t359 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t344 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t331 * t802 * t80 * t562 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t573;
  t826 = t220 * t798;
  t829 = t822 * t582;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t531 * t819 / 0.72e2 - t572 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t580 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t587 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t843 = t375 * t392;
  t848 = 0.1e1 / t33 / t285;
  t849 = t44 * t848;
  t850 = t148 * t849;
  t853 = t25 * t369;
  t854 = t853 * t146;
  t855 = t854 * t149;
  t857 = t374 * t378;
  t858 = t857 * t149;
  t860 = t338 * t145;
  t861 = t143 * t860;
  t864 = t112 * t117;
  t865 = t864 * t146;
  t866 = t865 * t149;
  t868 = t314 * t27;
  t869 = t868 * t146;
  t872 = t364 * t378;
  t877 = t117 * t338 * t60;
  t878 = t26 * t877;
  t880 = t285 * rho[0];
  t882 = 0.1e1 / t34 / t880;
  t883 = t31 * t882;
  t886 = t849 * t134;
  t893 = t40 * M_PI;
  t894 = t893 * t753;
  t895 = t285 * t122;
  t896 = 0.1e1 / t895;
  t898 = 0.1e1 / t333 / t51;
  t899 = t896 * t898;
  t902 = -0.2464e4 / 0.2187e4 * t29 * t883 - 0.28e3 / 0.729e3 * t130 * t886 + 0.224e3 / 0.2187e4 * t331 * sigma[0] * t882 * t334 - 0.512e3 / 0.59049e5 * t894 * t899;
  t904 = t27 * t902 * t60;
  t907 = 0.7e1 / 0.6e1 * t365 * t392 + 0.7e1 / 0.18e2 * t843 + 0.7e1 / 0.6e1 * t379 * t392 - 0.35e2 / 0.27e2 * t147 * t850 + t855 / 0.9e1 - t858 / 0.3e1 - t861 * t149 / 0.2e1 - t866 / 0.3e1 - t869 * t149 / 0.2e1 - t872 * t149 - 0.9e1 / 0.8e1 * t113 * t340 - 0.3e1 / 0.8e1 * t878 - 0.3e1 / 0.8e1 * t26 * t904;
  t909 = 0.1e1 / t116 / t105;
  t911 = t909 * t54 * t60;
  t913 = 0.5e1 / 0.36e2 * t26 * t911;
  t915 = t369 * t138 * t60;
  t916 = t26 * t915;
  t918 = t113 * t371;
  t920 = t315 * t119;
  t922 = t113 * t321;
  t925 = 0.1e1 / t300 / t19;
  t926 = t302 * t109;
  t929 = t301 * t109;
  t932 = t105 * t105;
  t933 = 0.1e1 / t932;
  t934 = t16 * t933;
  t937 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t306 - 0.6e1 * t934);
  t941 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t926 + 0.4e1 / 0.3e1 * t929 * t310 + 0.4e1 / 0.3e1 * t23 * t937);
  t942 = t5 * t941;
  t947 = t385 * t297;
  t949 = t156 * t886;
  t952 = t144 * t144;
  t953 = 0.1e1 / t952;
  t954 = t54 * t953;
  t955 = t143 * t954;
  t956 = t59 * t753;
  t957 = t896 * t2;
  t959 = t956 * t957 * t28;
  t966 = t868 * t152;
  t969 = -t913 + t916 / 0.4e1 + t918 / 0.4e1 - 0.3e1 / 0.8e1 * t920 - 0.3e1 / 0.4e1 * t922 - 0.3e1 / 0.8e1 * t942 * t61 - 0.9e1 / 0.8e1 * t315 * t140 + 0.7e1 / 0.54e2 * t947 - 0.35e2 / 0.81e2 * t153 * t949 - 0.64e2 / 0.243e3 * t955 * t959 + 0.7e1 / 0.18e2 * t382 * t297 + 0.7e1 / 0.18e2 * t389 * t297 - t966 * t157 / 0.6e1;
  t971 = t364 * t388;
  t974 = t374 * t388;
  t975 = t974 * t157;
  t977 = t338 * t58;
  t978 = t143 * t977;
  t981 = t864 * t152;
  t982 = t981 * t157;
  t984 = t853 * t152;
  t985 = t984 * t157;
  t987 = t138 * t281;
  t988 = t987 * t59;
  t989 = t143 * t988;
  t992 = t282 * t155;
  t993 = t143 * t992;
  t994 = t753 * t896;
  t995 = t29 * t134;
  t996 = t994 * t995;
  t1000 = t334 * t2 * t28;
  t1001 = t994 * t1000;
  t1005 = t898 * t2 * t28;
  t1006 = t994 * t1005;
  t1011 = t146 * t357;
  t1012 = t143 * t1011;
  t1015 = t154 * t154;
  t1016 = 0.1e1 / t1015;
  t1017 = t152 * t1016;
  t1018 = t143 * t1017;
  t1021 = t364 * t283;
  t1024 = -t971 * t157 / 0.3e1 - t975 / 0.9e1 - t978 * t157 / 0.6e1 - t982 / 0.9e1 + t985 / 0.27e2 - 0.8e1 / 0.27e2 * t989 * t290 - 0.64e2 / 0.729e3 * t993 * t996 - 0.32e2 / 0.2187e4 * t351 * t1001 - 0.64e2 / 0.6561e4 * t359 * t1006 - 0.64e2 / 0.19683e5 * t344 * t1006 - 0.64e2 / 0.2187e4 * t1012 * t1001 - 0.64e2 / 0.6561e4 * t1018 * t1006 - 0.8e1 / 0.27e2 * t1021 * t290;
  t1025 = t374 * t283;
  t1026 = t1025 * t290;
  t1029 = t882 * t41 * t3;
  t1030 = t31 * t1029;
  t1033 = t364 * t343;
  t1036 = t388 * t155;
  t1037 = t143 * t1036;
  t1040 = t364 * t350;
  t1043 = t374 * t343;
  t1044 = t1043 * t347;
  t1046 = t374 * t350;
  t1047 = t1046 * t353;
  t1049 = t374 * t358;
  t1050 = t1049 * t347;
  t1052 = t378 * t155;
  t1053 = t143 * t1052;
  t1056 = t364 * t358;
  t1059 = t388 * t357;
  t1060 = t143 * t1059;
  t1063 = t883 * t352;
  t1066 = t883 * t346;
  t1071 = -0.8e1 / 0.81e2 * t1026 + 0.56e2 / 0.81e2 * t284 * t1030 - 0.4e1 / 0.243e3 * t1033 * t347 - 0.4e1 / 0.243e3 * t1037 * t347 - 0.8e1 / 0.81e2 * t1040 * t353 - 0.4e1 / 0.729e3 * t1044 - 0.8e1 / 0.243e3 * t1047 - 0.8e1 / 0.729e3 * t1050 - 0.8e1 / 0.81e2 * t1053 * t353 - 0.8e1 / 0.243e3 * t1056 * t347 - 0.8e1 / 0.243e3 * t1060 * t347 + 0.56e2 / 0.243e3 * t351 * t1063 + 0.56e2 / 0.729e3 * t359 * t1066 + 0.28e2 / 0.729e3 * t344 * t1066;
  t1074 = my_piecewise3(t1, 0, t907 + t969 + t1024 + t1071);
  t1076 = 0.1e1 / t397 / t69;
  t1077 = t399 * t164;
  t1080 = t398 * t164;
  t1083 = t66 * t933;
  t1086 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t306 - 0.6e1 * t1083);
  t1090 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1077 + 0.4e1 / 0.3e1 * t1080 * t405 + 0.4e1 / 0.3e1 * t71 * t1086);
  t1091 = t5 * t1090;
  t1094 = t410 * t172;
  t1096 = t168 * t416;
  t1099 = t909 * t94 * t100;
  t1101 = 0.5e1 / 0.36e2 * t74 * t1099;
  t1103 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1091 * t101 - 0.3e1 / 0.8e1 * t1094 + t1096 / 0.4e1 - t1101);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1074 + t1103);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1106 = 0.2e1 * t451;
  t1107 = 0.2e1 * t488;
  t1111 = t439 * t378;
  t1114 = t431 * t27;
  t1115 = t1114 * t146;
  t1118 = t183 * t117;
  t1119 = t1118 * t146;
  t1121 = t1119 * t149 / 0.9e1;
  t1127 = t925 * t180;
  t1130 = t301 * t427;
  t1135 = 0.2e1 * t306;
  t1136 = 0.6e1 * t934;
  t1138 = my_piecewise5(t10, 0, t14, 0, t1135 - t1136);
  t1142 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1127 * t302 + 0.8e1 / 0.9e1 * t1130 * t109 + 0.4e1 / 0.9e1 * t423 * t310 + 0.4e1 / 0.3e1 * t23 * t1138);
  t1143 = t5 * t1142;
  t1149 = t184 * t321 / 0.4e1;
  t1152 = t432 * t119 / 0.4e1;
  t1153 = t184 * t371;
  t1157 = 0.7e1 / 0.18e2 * t440 * t392 + 0.7e1 / 0.54e2 * t843 - t1111 * t149 / 0.3e1 - t1115 * t149 / 0.3e1 - t1121 + 0.2e1 / 0.27e2 * t855 - t858 / 0.9e1 - t866 / 0.9e1 - 0.3e1 / 0.8e1 * t184 * t340 - 0.3e1 / 0.8e1 * t1143 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1149 - t878 / 0.8e1 - t1152 + t1153 / 0.12e2 - t913 + t916 / 0.6e1 + t918 / 0.6e1;
  t1162 = t1114 * t152;
  t1165 = t1118 * t152;
  t1167 = t1165 * t157 / 0.27e2;
  t1168 = t439 * t388;
  t1175 = t439 * t283;
  t1179 = t439 * t350;
  t1182 = t439 * t358;
  t1185 = t439 * t343;
  t1191 = -t920 / 0.8e1 - t922 / 0.4e1 + 0.7e1 / 0.54e2 * t443 * t297 - t1162 * t157 / 0.9e1 - t1167 - t1168 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t947 - t975 / 0.27e2 - t982 / 0.27e2 + 0.2e1 / 0.81e2 * t985 - 0.8e1 / 0.81e2 * t1175 * t290 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t353 - 0.8e1 / 0.729e3 * t1182 * t347 - 0.4e1 / 0.729e3 * t1185 * t347 - 0.4e1 / 0.2187e4 * t1044 - 0.8e1 / 0.729e3 * t1047 - 0.8e1 / 0.2187e4 * t1050;
  t1193 = my_piecewise3(t1, 0, t1157 + t1191);
  t1194 = t1076 * t190;
  t1197 = t398 * t456;
  t1202 = 0.6e1 * t1083;
  t1204 = my_piecewise5(t14, 0, t10, 0, -t1135 - t1202);
  t1208 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1194 * t399 + 0.8e1 / 0.9e1 * t1197 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1204);
  t1209 = t5 * t1208;
  t1213 = t461 * t172 / 0.4e1;
  t1214 = t194 * t416;
  t1221 = t168 * t470 / 0.4e1;
  t1223 = t369 * t210 * t100;
  t1224 = t74 * t1223;
  t1226 = t409 * t27;
  t1227 = t1226 * t218;
  t1230 = t167 * t117;
  t1231 = t1230 * t218;
  t1233 = t1231 * t221 / 0.9e1;
  t1234 = t73 * t369;
  t1235 = t1234 * t218;
  t1236 = t1235 * t221;
  t1238 = t1226 * t224;
  t1241 = t1230 * t224;
  t1243 = t1241 * t229 / 0.27e2;
  t1244 = t1234 * t224;
  t1245 = t1244 * t229;
  t1247 = -0.3e1 / 0.8e1 * t1209 * t101 - t1213 + t1214 / 0.12e2 - t1094 / 0.8e1 + t1096 / 0.6e1 - t1101 - 0.3e1 / 0.8e1 * t410 * t212 - t1221 + t1224 / 0.12e2 - t1227 * t221 / 0.6e1 - t1233 + t1236 / 0.27e2 - t1238 * t229 / 0.18e2 - t1243 + t1245 / 0.81e2;
  t1248 = my_piecewise3(t65, 0, t1247);
  tv3rho31 = t396 + t420 + t1106 + t1107 + t6 * (t1193 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1251 = t925 * t493;
  t1256 = t301 * t498;
  t1260 = my_piecewise5(t10, 0, t14, 0, -t1135 - t1136);
  t1264 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1251 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1256 * t109 + 0.4e1 / 0.3e1 * t23 * t1260);
  t1265 = t5 * t1264;
  t1268 = t503 * t119;
  t1272 = t502 * t27;
  t1273 = t1272 * t146;
  t1276 = t1272 * t152;
  t1284 = -0.3e1 / 0.8e1 * t1265 * t61 - t1268 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1273 * t149 / 0.6e1 - t1276 * t157 / 0.18e2 - t1152 + t1153 / 0.6e1 - t1149 - t1121 - t1167 + t918 / 0.12e2 - t913 + t916 / 0.12e2 + t855 / 0.27e2 + t985 / 0.81e2;
  t1285 = my_piecewise3(t1, 0, t1284);
  t1286 = t473 * t513;
  t1291 = t460 * t27;
  t1292 = t1291 * t218;
  t1295 = t193 * t117;
  t1296 = t1295 * t218;
  t1297 = t1296 * t221;
  t1299 = t477 * t513;
  t1300 = t1299 * t221;
  t1302 = t478 * t598;
  t1305 = t550 * t172;
  t1307 = t194 * t470;
  t1310 = t117 * t566 * t100;
  t1311 = t74 * t1310;
  t1313 = t1076 * t540;
  t1318 = t398 * t545;
  t1322 = my_piecewise5(t14, 0, t10, 0, t1135 - t1202);
  t1326 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1313 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1318 * t164 + 0.4e1 / 0.3e1 * t71 * t1322);
  t1327 = t5 * t1326;
  t1336 = -t1286 * t221 / 0.3e1 + 0.7e1 / 0.18e2 * t474 * t598 - t1292 * t221 / 0.3e1 - t1297 / 0.9e1 - t1300 / 0.9e1 + 0.7e1 / 0.54e2 * t1302 - t1233 + 0.2e1 / 0.27e2 * t1236 - t1305 / 0.8e1 - t1307 / 0.4e1 - t1311 / 0.8e1 - 0.3e1 / 0.8e1 * t1327 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t568 - t1213 + t1214 / 0.6e1 - t1221 + t1224 / 0.6e1;
  t1338 = t1295 * t224;
  t1339 = t1338 * t229;
  t1341 = t477 * t594;
  t1342 = t1341 * t229;
  t1344 = t484 * t523;
  t1348 = t1291 * t224;
  t1351 = t473 * t594;
  t1355 = t477 * t530;
  t1356 = t1355 * t537;
  t1358 = t473 * t530;
  t1361 = t477 * t579;
  t1362 = t1361 * t583;
  t1364 = t477 * t586;
  t1365 = t1364 * t583;
  t1367 = t477 * t571;
  t1368 = t1367 * t574;
  t1370 = t473 * t571;
  t1373 = t473 * t579;
  t1376 = t473 * t586;
  t1379 = t1096 / 0.12e2 - t1101 - t1339 / 0.27e2 - t1342 / 0.27e2 + 0.7e1 / 0.162e3 * t1344 + 0.7e1 / 0.54e2 * t481 * t523 - t1348 * t229 / 0.9e1 - t1351 * t229 / 0.9e1 - t1243 + 0.2e1 / 0.81e2 * t1245 - 0.8e1 / 0.243e3 * t1356 - 0.8e1 / 0.81e2 * t1358 * t537 - 0.8e1 / 0.2187e4 * t1362 - 0.4e1 / 0.2187e4 * t1365 - 0.8e1 / 0.729e3 * t1368 - 0.8e1 / 0.243e3 * t1370 * t574 - 0.8e1 / 0.729e3 * t1373 * t583 - 0.4e1 / 0.729e3 * t1376 * t583;
  t1381 = my_piecewise3(t65, 0, t1336 + t1379);
  tv3rho32 = t1106 + t1107 + t508 + t602 + t6 * (t1285 + t1381);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1386 = t493 * t180;
  t1393 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t306 - 0.6e1 * t934);
  t1397 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t925 * t1386 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1393);
  t1398 = t5 * t1397;
  t1404 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1398 * t61 - 0.3e1 / 0.8e1 * t1268 + t1153 / 0.4e1 - t913);
  t1406 = 0.1e1 / t77 / t532;
  t1407 = t84 * t1406;
  t1408 = t220 * t1407;
  t1418 = t549 * t27;
  t1419 = t1418 * t218;
  t1422 = t509 * t513;
  t1424 = t566 * t217;
  t1425 = t215 * t1424;
  t1429 = t540 * t190;
  t1436 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t306 - 0.6e1 * t1083);
  t1440 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1076 * t1429 + 0.4e1 / 0.3e1 * t452 * t545 + 0.4e1 / 0.3e1 * t71 * t1436);
  t1441 = t5 * t1440;
  t1448 = -0.35e2 / 0.27e2 * t219 * t1408 + 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1297 / 0.3e1 - t1300 / 0.3e1 + 0.7e1 / 0.18e2 * t1302 - t1419 * t221 / 0.2e1 - t1422 * t221 - t1425 * t221 / 0.2e1 + t1236 / 0.9e1 - 0.3e1 / 0.8e1 * t1441 * t101 - 0.9e1 / 0.8e1 * t550 * t212 - 0.9e1 / 0.8e1 * t194 * t568;
  t1449 = t532 * rho[1];
  t1451 = 0.1e1 / t78 / t1449;
  t1452 = t75 * t1451;
  t1455 = t1407 * t206;
  t1462 = t893 * t796;
  t1463 = t532 * t197;
  t1464 = 0.1e1 / t1463;
  t1466 = 0.1e1 / t561 / t91;
  t1467 = t1464 * t1466;
  t1470 = -0.2464e4 / 0.2187e4 * t29 * t1452 - 0.28e3 / 0.729e3 * t130 * t1455 + 0.224e3 / 0.2187e4 * t331 * sigma[2] * t1451 * t562 - 0.512e3 / 0.59049e5 * t1462 * t1467;
  t1472 = t27 * t1470 * t100;
  t1484 = t216 * t216;
  t1485 = 0.1e1 / t1484;
  t1486 = t94 * t1485;
  t1487 = t215 * t1486;
  t1488 = t99 * t796;
  t1489 = t1464 * t2;
  t1491 = t1488 * t1489 * t28;
  t1494 = t1418 * t224;
  t1497 = t509 * t594;
  t1500 = t566 * t98;
  t1501 = t215 * t1500;
  t1504 = -0.3e1 / 0.8e1 * t74 * t1472 - 0.3e1 / 0.8e1 * t1305 - 0.3e1 / 0.4e1 * t1307 - 0.3e1 / 0.8e1 * t1311 + t1214 / 0.4e1 + t1224 / 0.4e1 - t1101 + 0.7e1 / 0.18e2 * t591 * t523 + 0.7e1 / 0.18e2 * t595 * t523 - 0.64e2 / 0.243e3 * t1487 * t1491 - t1494 * t229 / 0.6e1 - t1497 * t229 / 0.3e1 - t1501 * t229 / 0.6e1;
  t1509 = t228 * t1455;
  t1514 = t529 * t227;
  t1515 = t215 * t1514;
  t1516 = t796 * t1464;
  t1517 = t29 * t206;
  t1518 = t1516 * t1517;
  t1521 = t218 * t578;
  t1522 = t215 * t1521;
  t1523 = t29 * t562;
  t1524 = t1516 * t1523;
  t1529 = t226 * t226;
  t1530 = 0.1e1 / t1529;
  t1531 = t224 * t1530;
  t1532 = t215 * t1531;
  t1534 = t1466 * t2 * t28;
  t1535 = t1516 * t1534;
  t1542 = t509 * t530;
  t1545 = -t1339 / 0.9e1 - t1342 / 0.9e1 + 0.7e1 / 0.54e2 * t1344 - 0.35e2 / 0.81e2 * t225 * t1509 + t1245 / 0.27e2 - 0.8e1 / 0.81e2 * t1356 - 0.64e2 / 0.729e3 * t1515 * t1518 - 0.64e2 / 0.2187e4 * t1522 * t1524 - 0.32e2 / 0.2187e4 * t572 * t1524 - 0.64e2 / 0.6561e4 * t1532 * t1535 - 0.64e2 / 0.6561e4 * t580 * t1535 - 0.64e2 / 0.19683e5 * t587 * t1535 - 0.8e1 / 0.27e2 * t1542 * t537;
  t1546 = t210 * t528;
  t1547 = t1546 * t99;
  t1548 = t215 * t1547;
  t1552 = t1451 * t41 * t3;
  t1553 = t75 * t1552;
  t1556 = t509 * t579;
  t1559 = t594 * t578;
  t1560 = t215 * t1559;
  t1563 = t509 * t586;
  t1566 = t594 * t227;
  t1567 = t215 * t1566;
  t1570 = t509 * t571;
  t1573 = t513 * t227;
  t1574 = t215 * t1573;
  t1577 = t1452 * t573;
  t1580 = t1452 * t582;
  t1588 = -0.8e1 / 0.27e2 * t1548 * t537 + 0.56e2 / 0.81e2 * t531 * t1553 - 0.8e1 / 0.243e3 * t1556 * t583 - 0.8e1 / 0.243e3 * t1560 * t583 - 0.4e1 / 0.243e3 * t1563 * t583 - 0.4e1 / 0.243e3 * t1567 * t583 - 0.8e1 / 0.81e2 * t1570 * t574 - 0.8e1 / 0.81e2 * t1574 * t574 + 0.56e2 / 0.243e3 * t572 * t1577 + 0.56e2 / 0.729e3 * t580 * t1580 + 0.28e2 / 0.729e3 * t587 * t1580 - 0.8e1 / 0.729e3 * t1362 - 0.4e1 / 0.729e3 * t1365 - 0.8e1 / 0.243e3 * t1368;
  t1591 = my_piecewise3(t65, 0, t1448 + t1504 + t1545 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1404 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1599 = t1049 * t659;
  t1601 = t1043 * t659;
  t1605 = t1046 * t647;
  t1609 = t285 * t32;
  t1610 = 0.1e1 / t1609;
  t1611 = t1610 * t2;
  t1613 = t28 * t44 * t134;
  t1614 = t1611 * t1613;
  t1618 = t28 * t334 * t44;
  t1619 = t1611 * t1618;
  t1624 = t244 * t281;
  t1625 = t1624 * t59;
  t1626 = t143 * t1625;
  t1629 = t30 * t287;
  t1630 = t1629 * t346;
  t1633 = t1629 * t352;
  t1638 = t1610 * t898;
  t1639 = t29 * t44;
  t1640 = t1638 * t1639;
  t1643 = 0.2e1 / 0.243e3 * t1056 * t659 + t1033 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1599 + t1601 / 0.729e3 + 0.2e1 / 0.81e2 * t1040 * t647 + 0.2e1 / 0.243e3 * t1605 + 0.2e1 / 0.81e2 * t1053 * t647 + 0.8e1 / 0.243e3 * t993 * t1614 + 0.8e1 / 0.729e3 * t1012 * t1619 + 0.4e1 / 0.729e3 * t351 * t1619 - 0.8e1 / 0.81e2 * t1626 * t290 - 0.5e1 / 0.243e3 * t359 * t1630 - 0.5e1 / 0.81e2 * t351 * t1633 - 0.5e1 / 0.486e3 * t344 * t1630 + 0.8e1 / 0.6561e4 * t344 * t1640;
  t1654 = t239 * t294;
  t1655 = t148 * t1654;
  t1660 = t865 * t249;
  t1665 = t854 * t249 / 0.72e2;
  t1666 = t375 * t650;
  t1670 = t364 * t626;
  t1673 = t374 * t626;
  t1674 = t1673 * t149;
  t1676 = t621 * t145;
  t1677 = t143 * t1676;
  t1680 = 0.2e1 / 0.243e3 * t1060 * t659 + t1037 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t1018 * t1640 + 0.8e1 / 0.2187e4 * t359 * t1640 - t379 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1655 + 0.7e1 / 0.18e2 * t627 * t392 + t1660 / 0.24e2 - t365 * t650 / 0.6e1 - t1665 - t1666 / 0.18e2 + t861 * t249 / 0.16e2 - t1670 * t149 / 0.3e1 - t1674 / 0.9e1 - t1677 * t149 / 0.3e1;
  t1686 = t857 * t249;
  t1689 = t369 * t244 * t60;
  t1691 = t26 * t1689 / 0.12e2;
  t1692 = t113 * t608;
  t1699 = t117 * t621 * t60;
  t1700 = t26 * t1699;
  t1704 = t1654 * t134;
  t1711 = t898 * t44;
  t1714 = 0.176e3 / 0.729e3 * t29 * t1629 + 0.14e2 / 0.243e3 * t130 * t1704 - 0.2e2 / 0.729e3 * t330 * t1629 * t334 + 0.64e2 / 0.19683e5 * t893 * t1610 * t1711;
  t1716 = t27 * t1714 * t60;
  t1721 = t156 * t1704;
  t1724 = t981 * t252;
  t1729 = t984 * t252 / 0.216e3;
  t1730 = t385 * t662;
  t1732 = t869 * t249 / 0.16e2 + t872 * t249 / 0.8e1 + t1686 / 0.24e2 + t1691 - t1692 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t246 - 0.3e1 / 0.4e1 * t113 * t623 - t1700 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1716 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1721 + t1724 / 0.72e2 - t382 * t662 / 0.18e2 - t1729 - t1730 / 0.54e2;
  t1733 = t641 * t289;
  t1738 = t364 * t630;
  t1741 = t374 * t630;
  t1742 = t1741 * t157;
  t1746 = t143 * t987;
  t1750 = t59 * t1610 * t1639;
  t1757 = t974 * t252;
  t1759 = t621 * t58;
  t1760 = t143 * t1759;
  t1763 = t364 * t282;
  t1766 = t374 * t282;
  t1767 = t1766 * t644;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t357;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -0.5e1 / 0.27e2 * t640 * t1733 + 0.7e1 / 0.54e2 * t631 * t297 - t1738 * t157 / 0.9e1 - t1742 / 0.27e2 + t978 * t252 / 0.48e2 + 0.2e1 / 0.27e2 * t1746 * t644 + 0.8e1 / 0.81e2 * t955 * t1750 + t966 * t252 / 0.48e2 + t971 * t252 / 0.24e2 + t1757 / 0.72e2 - t1760 * t157 / 0.9e1 + 0.2e1 / 0.27e2 * t1763 * t644 + 0.2e1 / 0.81e2 * t1767 - 0.8e1 / 0.243e3 * t1770 * t353 - 0.8e1 / 0.729e3 * t1774 * t347 - 0.4e1 / 0.729e3 * t1778 * t347;
  t1784 = my_piecewise3(t1, 0, t1643 + t1680 + t1732 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t369 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1231 * t270;
  t1800 = t1235 * t270 / 0.72e2;
  t1803 = t1241 * t273;
  t1806 = t1244 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1227 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1238 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1819 = t1119 * t249;
  t1823 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1599 / 0.729e3 + t1601 / 0.1458e4 + t1605 / 0.243e3 + t1819 / 0.48e2 - t440 * t650 / 0.12e2 - t1823 * t149 / 0.6e1 + t1115 * t249 / 0.16e2 + t1111 * t249 / 0.16e2 + t1660 / 0.48e2 - t1665 - t1666 / 0.36e2 - t1674 / 0.18e2 + t1686 / 0.48e2 - t1834 / 0.8e1;
  t1843 = t439 * t282;
  t1850 = t1165 * t252;
  t1857 = t439 * t630;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 + t1691 - t1692 / 0.8e1 - t1700 / 0.8e1 + t1843 * t644 / 0.27e2 + t1162 * t252 / 0.48e2 + t1168 * t252 / 0.48e2 + t1850 / 0.144e3 - t443 * t662 / 0.36e2 + t1724 / 0.144e3 - t1729 - t1730 / 0.108e3 - t1742 / 0.54e2 - t1857 * t157 / 0.18e2 + t1757 / 0.144e3 + t1767 / 0.81e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1866 = t1296 * t270;
  t1868 = t1299 * t270;
  t1870 = t473 * t713;
  t1883 = t1361 * t742;
  t1885 = t1364 * t742;
  t1887 = t1367 * t732;
  t1892 = t478 * t735;
  t1894 = t477 * t713;
  t1895 = t1894 * t221;
  t1899 = t1866 / 0.48e2 + t1868 / 0.48e2 - t1870 * t221 / 0.6e1 + t1292 * t270 / 0.16e2 + t1286 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1376 * t742 / 0.486e3 + t1370 * t732 / 0.81e2 + t1883 / 0.729e3 + t1885 / 0.1458e4 + t1887 / 0.243e3 + t1373 * t742 / 0.243e3 + t1797 / 0.48e2 - t1800 - t1892 / 0.36e2 - t1895 / 0.18e2 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t194 * t673;
  t1906 = t117 * t708 * t100;
  t1907 = t74 * t1906;
  t1909 = t1341 * t273;
  t1911 = t484 * t745;
  t1913 = t477 * t717;
  t1914 = t1913 * t229;
  t1916 = t477 * t529;
  t1917 = t1916 * t729;
  t1919 = t1338 * t273;
  t1921 = t473 * t529;
  t1930 = t473 * t717;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1789 / 0.8e1 + t1794 - t1903 / 0.8e1 - t1907 / 0.8e1 + t1909 / 0.144e3 - t1911 / 0.108e3 - t1914 / 0.54e2 + t1917 / 0.81e2 + t1919 / 0.144e3 + t1921 * t729 / 0.27e2 + t1348 * t273 / 0.48e2 + t1351 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1930 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1691 + t1273 * t249 / 0.16e2 + t1819 / 0.24e2 - t1665 + t1276 * t252 / 0.48e2 + t1850 / 0.72e2 - t1729);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t708 * t217;
  t1953 = t215 * t1952;
  t1962 = t509 * t713;
  t1967 = t260 * t520;
  t1968 = t220 * t1967;
  t1977 = t713 * t227;
  t1978 = t215 * t1977;
  t1981 = t717 * t578;
  t1982 = t215 * t1981;
  t1985 = t717 * t227;
  t1986 = t215 * t1985;
  t1989 = t30 * t534;
  t1990 = t1989 * t573;
  t1993 = -t1953 * t221 / 0.3e1 + t1419 * t270 / 0.16e2 + t1422 * t270 / 0.8e1 + t1425 * t270 / 0.16e2 - t1962 * t221 / 0.3e1 + t1866 / 0.24e2 + t1868 / 0.24e2 + 0.7e1 / 0.36e2 * t219 * t1968 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t714 * t598 - 0.8e1 / 0.243e3 * t1978 * t574 - 0.8e1 / 0.729e3 * t1982 * t583 - 0.4e1 / 0.729e3 * t1986 * t583 - 0.5e1 / 0.81e2 * t572 * t1990;
  t1994 = t532 * t76;
  t1995 = 0.1e1 / t1994;
  t1996 = t1995 * t2;
  t1998 = t28 * t84 * t206;
  t1999 = t1996 * t1998;
  t2003 = t28 * t562 * t84;
  t2004 = t1996 * t2003;
  t2015 = t265 * t528;
  t2016 = t2015 * t99;
  t2017 = t215 * t2016;
  t2020 = t1989 * t582;
  t2026 = t1995 * t1466;
  t2027 = t29 * t84;
  t2028 = t2026 * t2027;
  t2037 = 0.8e1 / 0.243e3 * t1515 * t1999 + 0.8e1 / 0.729e3 * t1522 * t2004 + 0.4e1 / 0.729e3 * t572 * t2004 + 0.2e1 / 0.243e3 * t1556 * t742 + 0.2e1 / 0.81e2 * t1570 * t732 + 0.2e1 / 0.81e2 * t1574 * t732 - 0.8e1 / 0.81e2 * t2017 * t537 - 0.5e1 / 0.243e3 * t580 * t2020 + 0.2e1 / 0.729e3 * t1883 + t1885 / 0.729e3 + 0.2e1 / 0.243e3 * t1887 + 0.8e1 / 0.2187e4 * t1532 * t2028 + 0.8e1 / 0.2187e4 * t580 * t2028 - 0.5e1 / 0.486e3 * t587 * t2020 + 0.8e1 / 0.6561e4 * t587 * t2028;
  t2053 = t1967 * t206;
  t2060 = t1466 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1989 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t330 * t1989 * t562 + 0.64e2 / 0.19683e5 * t893 * t1995 * t2060;
  t2065 = t27 * t2063 * t100;
  t2076 = t1563 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t1560 * t742 + t1567 * t742 / 0.243e3 - t1800 - t1892 / 0.18e2 - t1895 / 0.9e1 - 0.3e1 / 0.8e1 * t550 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 + t1794 - t1903 / 0.4e1 - t1907 / 0.4e1 + 0.7e1 / 0.54e2 * t718 * t523 + t1494 * t273 / 0.48e2 + t1497 * t273 / 0.24e2;
  t2079 = t509 * t529;
  t2082 = t215 * t1546;
  t2086 = t99 * t1995 * t2027;
  t2089 = t509 * t717;
  t2092 = t708 * t98;
  t2093 = t215 * t2092;
  t2101 = t228 * t2053;
  t2106 = t726 * t536;
  t2111 = t1501 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2079 * t729 + 0.2e1 / 0.27e2 * t2082 * t729 + 0.8e1 / 0.81e2 * t1487 * t2086 - t2089 * t229 / 0.9e1 - t2093 * t229 / 0.9e1 + t1909 / 0.72e2 - t1911 / 0.54e2 - t1914 / 0.27e2 + 0.2e1 / 0.81e2 * t1917 + t1919 / 0.72e2 + 0.7e1 / 0.108e3 * t225 * t2101 - t595 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t725 * t2106 - t591 * t745 / 0.18e2 - t1806;
  t2114 = my_piecewise3(t65, 0, t1993 + t2037 + t2076 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2119 = t375 * t783 / 0.96e2;
  t2120 = t754 * t132;
  t2121 = t148 * t2120;
  t2125 = t1673 * t249 / 0.24e2;
  t2126 = t764 * t145;
  t2127 = t143 * t2126;
  t2139 = t1046 * t780 / 0.648e3;
  t2140 = t773 * t124;
  t2141 = t2140 * t352;
  t2145 = t1049 * t786 / 0.1944e4;
  t2146 = -t627 * t650 / 0.6e1 - t2119 + t147 * t2121 / 0.24e2 + t2125 - t2127 * t149 / 0.6e1 + t1670 * t249 / 0.8e1 + t1677 * t249 / 0.8e1 - t365 * t783 / 0.32e2 - t379 * t783 / 0.32e2 - t2139 + t351 * t2141 / 0.162e3 - t2145;
  t2147 = t2140 * t346;
  t2165 = t1043 * t786 / 0.3888e4;
  t2167 = t1025 * t776 / 0.216e3;
  t2168 = t773 * t643;
  t2171 = 0.1e1 / t880;
  t2172 = t239 * t2171;
  t2173 = t2172 * t1005;
  t2176 = t344 * t2147 / 0.972e3 - t1033 * t786 / 0.1296e4 - t1037 * t786 / 0.1296e4 - t1040 * t780 / 0.216e3 - t1053 * t780 / 0.216e3 - t1056 * t786 / 0.648e3 - t1060 * t786 / 0.648e3 + t359 * t2147 / 0.486e3 - t2165 - t2167 + t284 * t2168 / 0.54e2 - t359 * t2173 / 0.729e3;
  t2188 = t2172 * t995;
  t2191 = t2172 * t1000;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = -t344 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t1774 * t659 + t1778 * t659 / 0.243e3 - t1021 * t776 / 0.72e2 - t989 * t776 / 0.72e2 - t993 * t2188 / 0.81e2 - t1012 * t2191 / 0.243e3 - t351 * t2191 / 0.486e3 - t1018 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t1770 * t647 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2120 * t134;
  t2214 = t893 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t759 * t124 * t334 - 0.8e1 / 0.6561e4 * t2214 * t2171 * t898;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1741 * t252 / 0.72e2;
  t2232 = t143 * t1624;
  t2239 = t59 * t239;
  t2242 = t2239 * t2171 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1738 * t252 / 0.24e2 + t1760 * t252 / 0.24e2 - t955 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2146 + t2176 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1894 * t270 / 0.24e2;
  t2271 = t1913 * t273 / 0.72e2;
  t2275 = t1355 * t819 / 0.216e3;
  t2279 = t1367 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1361 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1364 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1870 * t270 / 0.8e1 + t2267 + t1930 * t273 / 0.24e2 + t2271 - t1358 * t819 / 0.72e2 - t2275 - t1370 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1373 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1376 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1823 * t249 / 0.8e1 + t2125 + t1857 * t252 / 0.24e2 + t2229 - t1175 * t776 / 0.72e2 - t2167 - t1179 * t780 / 0.216e3 - t2139 - t440 * t783 / 0.32e2 - t2119 - t1182 * t786 / 0.648e3 - t2145 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2165;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2322 = t797 * t204;
  t2323 = t220 * t2322;
  t2326 = t807 * t217;
  t2327 = t215 * t2326;
  t2338 = t816 * t199;
  t2339 = t2338 * t573;
  t2342 = t2338 * t582;
  t2347 = t2267 - t2283 - t714 * t735 / 0.6e1 + t219 * t2323 / 0.24e2 - t2327 * t221 / 0.6e1 + t1962 * t270 / 0.8e1 + t1953 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 + t572 * t2339 / 0.162e3 + t580 * t2342 / 0.486e3 + t587 * t2342 / 0.972e3;
  t2366 = -t1563 * t829 / 0.1296e4 - t1567 * t829 / 0.1296e4 - t1570 * t823 / 0.216e3 - t1574 * t823 / 0.216e3 - t1556 * t829 / 0.648e3 - t1560 * t829 / 0.648e3 - t2279 - t2287 - t2295 + t1986 * t742 / 0.243e3 - t1542 * t819 / 0.72e2 - t1548 * t819 / 0.72e2;
  t2368 = 0.1e1 / t1449;
  t2369 = t260 * t2368;
  t2370 = t2369 * t1517;
  t2373 = t2369 * t1523;
  t2378 = t816 * t728;
  t2381 = t2369 * t1534;
  t2392 = t2322 * t206;
  t2399 = t893 * t260;
  t2403 = t130 * t2392 / 0.81e2 + 0.2e1 / 0.729e3 * t331 * t802 * t199 * t562 - 0.8e1 / 0.6561e4 * t2399 * t2368 * t1466;
  t2405 = t27 * t2403 * t100;
  t2410 = -t1515 * t2370 / 0.81e2 - t1522 * t2373 / 0.243e3 - t572 * t2373 / 0.486e3 - t2275 + t531 * t2378 / 0.54e2 - t1532 * t2381 / 0.729e3 - t580 * t2381 / 0.729e3 - t587 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t1978 * t732 + 0.2e1 / 0.243e3 * t1982 * t742 - 0.3e1 / 0.8e1 * t74 * t2405 - 0.3e1 / 0.8e1 * t194 * t809;
  t2411 = t228 * t2392;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2015;
  t2427 = t99 * t260;
  t2430 = t2427 * t2368 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2089 * t273 / 0.24e2 + t2093 * t273 / 0.24e2 - t1487 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2347 + t2366 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t346;
  t2455 = t2444 * t775;
  t2458 = 0.1e1 / t285;
  t2459 = t754 * t2458;
  t2460 = t2459 * t1005;
  t2463 = t2459 * t995;
  t2466 = t2459 * t1000;
  t2475 = t344 * t2446 / 0.864e3 - t1770 * t780 / 0.72e2 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t284 * t2455 / 0.48e2 + t344 * t2460 / 0.5832e4 + t993 * t2463 / 0.216e3 + t1012 * t2466 / 0.648e3 + t351 * t2466 / 0.1296e4 + t1018 * t2460 / 0.1944e4 + t359 * t2460 / 0.1944e4;
  t2477 = 0.1e1 / t44 / t2442;
  t2478 = t2477 * t47;
  t2479 = t2478 * t134;
  t2480 = t156 * t2479;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2478;
  t2502 = t2445 * t352;
  t2514 = t2458 * t898;
  t2517 = t130 * t2479 / 0.72e2 + t331 * t2443 * t36 * t334 / 0.324e3 + t893 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t153 * t2480 / 0.64e2 - t1626 * t776 / 0.24e2 - t631 * t789 / 0.32e2 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t955 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2127 * t249 + t351 * t2502 / 0.144e3 + t359 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2475 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2526 = 0.1e1 / t2525;
  t2527 = t30 * t2526;
  t2528 = t2527 * t80;
  t2529 = t2528 * t582;
  t2534 = t2527 * t818;
  t2542 = 0.1e1 / t84 / t2525;
  t2543 = t2542 * t87;
  t2544 = t2543 * t206;
  t2545 = t228 * t2544;
  t2548 = 0.1e1 / t532;
  t2549 = t797 * t2548;
  t2550 = t2549 * t1534;
  t2555 = t2549 * t1517;
  t2558 = t2549 * t1523;
  t2563 = t587 * t2529 / 0.864e3 - t1986 * t829 / 0.432e3 + t531 * t2534 / 0.48e2 - t1978 * t823 / 0.72e2 - t1982 * t829 / 0.216e3 + t225 * t2545 / 0.64e2 + t587 * t2550 / 0.5832e4 - t718 * t832 / 0.32e2 + t1515 * t2555 / 0.216e3 + t1522 * t2558 / 0.648e3 + t572 * t2558 / 0.1296e4;
  t2570 = t220 * t2543;
  t2579 = t2548 * t2 * t28;
  t2580 = t99 * t797 * t2579;
  t2587 = t2528 * t573;
  t2597 = t2548 * t1466;
  t2600 = t130 * t2544 / 0.72e2 + t331 * t2526 * t80 * t562 / 0.324e3 + t893 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1532 * t2550 / 0.1944e4 + t580 * t2550 / 0.1944e4 - t2017 * t819 / 0.24e2 + 0.3e1 / 0.64e2 * t219 * t2570 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1487 * t2580 / 0.72e2 + 0.3e1 / 0.16e2 * t2327 * t270 + t580 * t2529 / 0.432e3 + t572 * t2587 / 0.144e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2563 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2610 = t864 * t378;
  t2611 = t2610 * t149;
  t2613 = t374 * t860;
  t2614 = t2613 * t149;
  t2616 = t364 * t860;
  t2620 = t143 * t902 * t145;
  t2623 = t375 * t850;
  t2628 = 0.1e1 / t33 / t880;
  t2629 = t44 * t2628;
  t2639 = t857 * t392;
  t2643 = t865 * t392;
  t2645 = t854 * t392;
  t2647 = t314 * t117;
  t2648 = t2647 * t146;
  t2649 = t2648 * t149;
  t2651 = t941 * t27;
  t2652 = t2651 * t146;
  t2655 = -0.4e1 / 0.3e1 * t2611 - 0.2e1 / 0.3e1 * t2614 - 0.2e1 * t2616 * t149 - 0.2e1 / 0.3e1 * t2620 * t149 - 0.14e3 / 0.81e2 * t2623 - 0.14e3 / 0.27e2 * t379 * t850 + 0.455e3 / 0.81e2 * t147 * t148 * t2629 - 0.14e3 / 0.27e2 * t365 * t850 + 0.7e1 / 0.3e1 * t869 * t392 + 0.14e2 / 0.3e1 * t872 * t392 + 0.14e2 / 0.9e1 * t2639 + 0.7e1 / 0.3e1 * t861 * t392 + 0.14e2 / 0.9e1 * t2643 - 0.14e2 / 0.27e2 * t2645 - 0.2e1 / 0.3e1 * t2649 - 0.2e1 / 0.3e1 * t2652 * t149;
  t2656 = t868 * t378;
  t2659 = t25 * t909;
  t2660 = t2659 * t146;
  t2661 = t2660 * t149;
  t2663 = t112 * t369;
  t2664 = t2663 * t146;
  t2665 = t2664 * t149;
  t2667 = t853 * t378;
  t2668 = t2667 * t149;
  t2670 = t853 * t358;
  t2671 = t2670 * t347;
  t2679 = t1049 * t1066;
  t2681 = t853 * t343;
  t2682 = t2681 * t347;
  t2684 = t1043 * t1066;
  t2686 = t853 * t350;
  t2687 = t2686 * t353;
  t2689 = t1046 * t1063;
  t2691 = t374 * t1059;
  t2692 = t2691 * t347;
  t2695 = t143 * t860 * t155;
  t2700 = t868 * t358;
  t2703 = -0.2e1 * t2656 * t149 - 0.2e2 / 0.81e2 * t2661 + 0.4e1 / 0.9e1 * t2665 + 0.4e1 / 0.9e1 * t2668 + 0.32e2 / 0.2187e4 * t2671 + 0.224e3 / 0.729e3 * t1060 * t1066 + 0.224e3 / 0.243e3 * t1053 * t1063 + 0.224e3 / 0.729e3 * t1056 * t1066 + 0.224e3 / 0.2187e4 * t2679 + 0.16e2 / 0.2187e4 * t2682 + 0.112e3 / 0.2187e4 * t2684 + 0.32e2 / 0.729e3 * t2687 + 0.224e3 / 0.729e3 * t2689 - 0.32e2 / 0.729e3 * t2692 - 0.16e2 / 0.81e2 * t2695 * t353 + 0.224e3 / 0.243e3 * t1040 * t1063 - 0.16e2 / 0.243e3 * t2700 * t347;
  t2705 = t364 * t1059;
  t2709 = 0.1e1 / t34 / t1609;
  t2710 = t31 * t2709;
  t2714 = t2710 * t346;
  t2719 = t868 * t350;
  t2722 = t364 * t1052;
  t2725 = t864 * t343;
  t2726 = t2725 * t347;
  t2728 = t374 * t1036;
  t2729 = t2728 * t347;
  t2731 = t864 * t350;
  t2732 = t2731 * t353;
  t2734 = t374 * t1052;
  t2735 = t2734 * t353;
  t2737 = t864 * t358;
  t2738 = t2737 * t347;
  t2744 = t868 * t343;
  t2747 = t364 * t1036;
  t2751 = t143 * t977 * t155;
  t2755 = t143 * t977 * t357;
  t2758 = -0.32e2 / 0.243e3 * t2705 * t347 - 0.3416e4 / 0.2187e4 * t351 * t2710 * t352 - 0.3416e4 / 0.6561e4 * t359 * t2714 - 0.1708e4 / 0.6561e4 * t344 * t2714 - 0.16e2 / 0.81e2 * t2719 * t353 - 0.32e2 / 0.81e2 * t2722 * t353 - 0.16e2 / 0.729e3 * t2726 - 0.16e2 / 0.729e3 * t2729 - 0.32e2 / 0.243e3 * t2732 - 0.32e2 / 0.243e3 * t2735 - 0.32e2 / 0.729e3 * t2738 + 0.112e3 / 0.729e3 * t1033 * t1066 + 0.112e3 / 0.729e3 * t1037 * t1066 - 0.8e1 / 0.243e3 * t2744 * t347 - 0.16e2 / 0.243e3 * t2747 * t347 - 0.8e1 / 0.243e3 * t2751 * t347 - 0.16e2 / 0.243e3 * t2755 * t347;
  t2759 = t868 * t283;
  t2762 = t364 * t988;
  t2766 = t143 * t987 * t155;
  t2769 = t1046 * t1001;
  t2771 = t1049 * t1006;
  t2773 = t1043 * t1006;
  t2775 = t374 * t992;
  t2776 = t2775 * t996;
  t2778 = t374 * t1011;
  t2779 = t2778 * t1001;
  t2781 = t374 * t1017;
  t2782 = t2781 * t1006;
  t2784 = t853 * t283;
  t2785 = t2784 * t290;
  t2787 = t374 * t988;
  t2788 = t2787 * t290;
  t2792 = t285 * t285;
  t2795 = 0.1e1 / t33 / t2792 / rho[0];
  t2796 = t2442 * t2795;
  t2797 = t333 * t333;
  t2798 = 0.1e1 / t2797;
  t2800 = t2798 * M_PI * t43;
  t2801 = t2796 * t2800;
  t2812 = -0.16e2 / 0.27e2 * t2759 * t290 - 0.32e2 / 0.27e2 * t2762 * t290 - 0.256e3 / 0.729e3 * t2766 * t996 - 0.128e3 / 0.6561e4 * t2769 - 0.256e3 / 0.19683e5 * t2771 - 0.256e3 / 0.59049e5 * t2773 - 0.256e3 / 0.2187e4 * t2776 - 0.256e3 / 0.6561e4 * t2779 - 0.256e3 / 0.19683e5 * t2782 + 0.32e2 / 0.243e3 * t2785 - 0.32e2 / 0.81e2 * t2788 - 0.256e3 / 0.6561e4 * t1060 * t1006 - 0.512e3 / 0.59049e5 * t1018 * t2801 - 0.2816e4 / 0.531441e6 * t359 * t2801 - 0.256e3 / 0.19683e5 * t1033 * t1006 - 0.256e3 / 0.19683e5 * t1037 * t1006 - 0.256e3 / 0.177147e6 * t344 * t2801;
  t2815 = t364 * t1011;
  t2819 = t143 * t378 * t357;
  t2823 = t143 * t146 * t1016;
  t2825 = M_PI * t898 * t43;
  t2826 = t2796 * t2825;
  t2829 = t364 * t1017;
  t2833 = t143 * t388 * t1016;
  t2837 = 0.1e1 / t1015 / t52;
  t2839 = t143 * t152 * t2837;
  t2842 = t364 * t992;
  t2846 = t143 * t954 * t155;
  t2848 = M_PI * t134 * t43;
  t2853 = t143 * t282 * t357;
  t2855 = M_PI * t334 * t43;
  t2856 = t2796 * t2855;
  t2867 = t338 * t281;
  t2869 = t143 * t2867 * t59;
  t2872 = t864 * t283;
  t2873 = t2872 * t290;
  t2875 = t1025 * t1030;
  t2877 = -0.256e3 / 0.2187e4 * t2815 * t1001 - 0.256e3 / 0.2187e4 * t2819 * t1001 - 0.1024e4 / 0.59049e5 * t2823 * t2826 - 0.256e3 / 0.6561e4 * t2829 * t1006 - 0.256e3 / 0.6561e4 * t2833 * t1006 - 0.1024e4 / 0.177147e6 * t2839 * t2801 - 0.256e3 / 0.729e3 * t2842 * t996 - 0.1024e4 / 0.6561e4 * t2846 * t2796 * t2848 - 0.1024e4 / 0.19683e5 * t2853 * t2856 - 0.512e3 / 0.19683e5 * t993 * t2856 - 0.128e3 / 0.2187e4 * t1040 * t1001 - 0.128e3 / 0.2187e4 * t1053 * t1001 - 0.1024e4 / 0.59049e5 * t1012 * t2826 - 0.16e2 / 0.27e2 * t2869 * t290 - 0.32e2 / 0.81e2 * t2873 + 0.224e3 / 0.243e3 * t2875;
  t2883 = 0.1e1 / t2792;
  t2884 = t753 * t2883;
  t2885 = t2884 * t1005;
  t2892 = t2884 * t1000;
  t2908 = t19 * t19;
  t2910 = 0.1e1 / t300 / t2908;
  t2911 = t302 * t302;
  t2917 = t310 * t310;
  t2923 = 0.1e1 / t932 / t6;
  t2924 = t16 * t2923;
  t2927 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t933 + 0.24e2 * t2924);
  t2931 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t2911 - 0.16e2 / 0.9e1 * t925 * t302 * t310 + 0.4e1 / 0.3e1 * t301 * t2917 + 0.16e2 / 0.9e1 * t929 * t937 + 0.4e1 / 0.3e1 * t23 * t2927);
  t2942 = 0.1e1 / t116 / t305;
  t2946 = 0.1e2 / 0.27e2 * t26 * t2942 * t54 * t60;
  t2947 = t113 * t911;
  t2949 = -0.3416e4 / 0.729e3 * t284 * t31 * t2709 * t41 * t3 + 0.896e3 / 0.6561e4 * t1018 * t2885 + 0.224e3 / 0.81e2 * t1021 * t1030 + 0.896e3 / 0.19683e5 * t344 * t2885 + 0.896e3 / 0.2187e4 * t1012 * t2892 + 0.448e3 / 0.2187e4 * t351 * t2892 + 0.896e3 / 0.6561e4 * t359 * t2885 + 0.224e3 / 0.81e2 * t989 * t1030 + 0.896e3 / 0.729e3 * t993 * t2884 * t995 - 0.1024e4 / 0.177147e6 * t351 * t2826 - 0.256e3 / 0.6561e4 * t1056 * t1006 - 0.3e1 / 0.8e1 * t5 * t2931 * t61 - 0.3e1 / 0.2e1 * t942 * t140 - 0.9e1 / 0.4e1 * t315 * t340 + 0.7e1 / 0.9e1 * t978 * t297 + t2946 - 0.5e1 / 0.9e1 * t2947;
  t2953 = t26 * t909 * t138 * t60;
  t2955 = t113 * t915;
  t2958 = t26 * t369 * t338 * t60;
  t2960 = t315 * t371;
  t2962 = t942 * t119;
  t2964 = t315 * t321;
  t2966 = t113 * t877;
  t2972 = t26 * t117 * t902 * t60;
  t2976 = t2629 * t134;
  t2986 = t3 * t893;
  t2990 = t2798 * t41 * t43;
  t2998 = t868 * t388;
  t3001 = t364 * t977;
  t3004 = t374 * t977;
  t3005 = t3004 * t157;
  t3008 = t143 * t902 * t58;
  t3011 = t374 * t954;
  t3012 = t3011 * t959;
  t3022 = t143 * t54 / t952 / t57;
  t3029 = -0.5e1 / 0.9e1 * t2953 + t2955 + t2958 / 0.2e1 + t2960 / 0.2e1 - t2962 / 0.2e1 - 0.3e1 / 0.2e1 * t2964 - 0.3e1 / 0.2e1 * t2966 - 0.3e1 / 0.2e1 * t113 * t904 - t2972 / 0.2e1 - 0.3e1 / 0.8e1 * t26 * t27 * (0.41888e5 / 0.6561e4 * t29 * t2710 + 0.364e4 / 0.2187e4 * t130 * t2976 - 0.13664e5 / 0.19683e5 * t331 * sigma[0] * t2709 * t334 + 0.7168e4 / 0.59049e5 * t894 * t2883 * t898 - 0.2048e4 / 0.1594323e7 * t2986 * t2442 * t2795 * t2990) * t60 - 0.2e1 / 0.3e1 * t2998 * t157 - 0.2e1 / 0.3e1 * t3001 * t157 - 0.2e1 / 0.9e1 * t3005 - 0.2e1 / 0.9e1 * t3008 * t157 - 0.256e3 / 0.729e3 * t3012 + 0.896e3 / 0.243e3 * t955 * t956 * t2883 * t2 * t28 - 0.1024e4 / 0.2187e4 * t3022 * t59 * t2442 * t2795 * M_PI * t43;
  t3034 = t864 * t388;
  t3035 = t3034 * t157;
  t3038 = t143 * t138 * t953;
  t3041 = t981 * t297;
  t3043 = t974 * t297;
  t3049 = t364 * t954;
  t3052 = t2651 * t152;
  t3055 = t2663 * t152;
  t3056 = t3055 * t157;
  t3058 = t2647 * t152;
  t3059 = t3058 * t157;
  t3061 = t984 * t297;
  t3063 = t385 * t949;
  t3068 = t2659 * t152;
  t3069 = t3068 * t157;
  t3071 = t853 * t388;
  t3072 = t3071 * t157;
  t3074 = 0.7e1 / 0.9e1 * t966 * t297 + 0.14e2 / 0.9e1 * t971 * t297 - 0.4e1 / 0.9e1 * t3035 - 0.256e3 / 0.243e3 * t3038 * t959 + 0.14e2 / 0.27e2 * t3041 + 0.14e2 / 0.27e2 * t3043 - 0.14e3 / 0.81e2 * t382 * t949 - 0.14e3 / 0.81e2 * t389 * t949 - 0.256e3 / 0.243e3 * t3049 * t959 - 0.2e1 / 0.9e1 * t3052 * t157 + 0.4e1 / 0.27e2 * t3056 - 0.2e1 / 0.9e1 * t3059 - 0.14e2 / 0.81e2 * t3061 - 0.14e3 / 0.243e3 * t3063 + 0.455e3 / 0.243e3 * t153 * t156 * t2976 - 0.2e2 / 0.243e3 * t3069 + 0.4e1 / 0.27e2 * t3072;
  t3078 = my_piecewise3(t1, 0, t2655 + t2703 + t2758 + t2812 + t2877 + t2949 + t3029 + t3074);
  t3079 = t69 * t69;
  t3081 = 0.1e1 / t397 / t3079;
  t3082 = t399 * t399;
  t3088 = t405 * t405;
  t3093 = t66 * t2923;
  t3096 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t933 + 0.24e2 * t3093);
  t3100 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t3082 - 0.16e2 / 0.9e1 * t1076 * t399 * t405 + 0.4e1 / 0.3e1 * t398 * t3088 + 0.16e2 / 0.9e1 * t1080 * t1086 + 0.4e1 / 0.3e1 * t71 * t3096);
  t3104 = t1091 * t172;
  t3106 = t410 * t416;
  t3108 = t168 * t1099;
  t3113 = 0.1e2 / 0.27e2 * t74 * t2942 * t94 * t100;
  t3115 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t5 * t3100 * t101 - t3104 / 0.2e1 + t3106 / 0.2e1 - 0.5e1 / 0.9e1 * t3108 + t3113);
  tv4rho40 = 0.4e1 * t1074 + 0.4e1 * t1103 + t6 * (t3078 + t3115);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3122 = t1118 * t378;
  t3123 = t3122 * t149;
  t3129 = t1119 * t392;
  t3133 = t183 * t369;
  t3134 = t3133 * t146;
  t3135 = t3134 * t149;
  t3136 = t3135 / 0.9e1;
  t3137 = t1114 * t378;
  t3139 = t439 * t860;
  t3142 = t431 * t117;
  t3143 = t3142 * t146;
  t3144 = t3143 * t149;
  t3146 = t1142 * t27;
  t3147 = t3146 * t146;
  t3151 = -0.35e2 / 0.27e2 * t440 * t850 - t3123 / 0.3e1 + 0.7e1 / 0.6e1 * t1111 * t392 + 0.7e1 / 0.6e1 * t1115 * t392 + 0.7e1 / 0.18e2 * t3129 - t2611 / 0.3e1 - t2614 / 0.6e1 + t3136 - t3137 * t149 - t3139 * t149 / 0.2e1 - t3144 / 0.3e1 - t3147 * t149 / 0.2e1 - 0.35e2 / 0.81e2 * t2623;
  t3159 = t1118 * t350;
  t3160 = t3159 * t353;
  t3163 = t1118 * t358;
  t3164 = t3163 * t347;
  t3166 = t1118 * t343;
  t3167 = t3166 * t347;
  t3169 = t1114 * t343;
  t3172 = t439 * t1036;
  t3175 = 0.7e1 / 0.18e2 * t2639 + 0.7e1 / 0.18e2 * t2643 - 0.7e1 / 0.27e2 * t2645 - t2649 / 0.6e1 - 0.5e1 / 0.27e2 * t2661 + 0.2e1 / 0.9e1 * t2665 + 0.2e1 / 0.9e1 * t2668 - 0.8e1 / 0.243e3 * t3160 + 0.16e2 / 0.2187e4 * t2671 - 0.8e1 / 0.729e3 * t3164 - 0.4e1 / 0.729e3 * t3167 - 0.4e1 / 0.243e3 * t3169 * t347 - 0.4e1 / 0.243e3 * t3172 * t347;
  t3183 = t1114 * t358;
  t3186 = t439 * t1059;
  t3189 = t439 * t1052;
  t3192 = t1114 * t350;
  t3201 = 0.56e2 / 0.243e3 * t1179 * t1063 + 0.56e2 / 0.729e3 * t1182 * t1066 + 0.28e2 / 0.729e3 * t1185 * t1066 - 0.8e1 / 0.243e3 * t3183 * t347 - 0.8e1 / 0.243e3 * t3186 * t347 - 0.8e1 / 0.81e2 * t3189 * t353 - 0.8e1 / 0.81e2 * t3192 * t353 + 0.56e2 / 0.2187e4 * t2679 + 0.8e1 / 0.2187e4 * t2682 + 0.28e2 / 0.2187e4 * t2684 + 0.16e2 / 0.729e3 * t2687 + 0.56e2 / 0.729e3 * t2689 - 0.8e1 / 0.729e3 * t2692;
  t3217 = -0.4e1 / 0.729e3 * t2726 - 0.4e1 / 0.729e3 * t2729 - 0.8e1 / 0.243e3 * t2732 - 0.8e1 / 0.243e3 * t2735 - 0.8e1 / 0.729e3 * t2738 + 0.56e2 / 0.81e2 * t1175 * t1030 - 0.32e2 / 0.6561e4 * t2769 - 0.64e2 / 0.19683e5 * t2771 - 0.64e2 / 0.59049e5 * t2773 - 0.64e2 / 0.2187e4 * t2776 - 0.64e2 / 0.6561e4 * t2779 - 0.64e2 / 0.19683e5 * t2782 + 0.16e2 / 0.243e3 * t2785 - 0.8e1 / 0.81e2 * t2788;
  t3220 = t439 * t1011;
  t3225 = t439 * t1017;
  t3232 = t439 * t988;
  t3235 = t1114 * t283;
  t3238 = t1118 * t283;
  t3239 = t3238 * t290;
  t3241 = t439 * t992;
  t3246 = t184 * t911;
  t3248 = t184 * t877;
  t3250 = -0.64e2 / 0.2187e4 * t3220 * t1001 - 0.32e2 / 0.2187e4 * t1179 * t1001 - 0.64e2 / 0.6561e4 * t3225 * t1006 - 0.64e2 / 0.6561e4 * t1182 * t1006 - 0.64e2 / 0.19683e5 * t1185 * t1006 - 0.8e1 / 0.27e2 * t3232 * t290 - 0.8e1 / 0.27e2 * t3235 * t290 - 0.8e1 / 0.81e2 * t3239 - 0.64e2 / 0.729e3 * t3241 * t996 - 0.8e1 / 0.81e2 * t2873 + 0.56e2 / 0.243e3 * t2875 - 0.5e1 / 0.36e2 * t3246 - 0.3e1 / 0.8e1 * t3248;
  t3251 = t432 * t371;
  t3252 = t3251 / 0.4e1;
  t3253 = t1143 * t119;
  t3255 = t432 * t321;
  t3257 = t184 * t915;
  t3258 = t3257 / 0.4e1;
  t3279 = 0.12e2 * t933;
  t3280 = 0.24e2 * t2924;
  t3282 = my_piecewise5(t10, 0, t14, 0, -t3279 + t3280);
  t3286 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t180 * t926 - 0.8e1 / 0.9e1 * t925 * t427 * t302 - 0.8e1 / 0.9e1 * t1127 * t109 * t310 + 0.4e1 / 0.3e1 * t301 * t1138 * t109 + 0.4e1 / 0.3e1 * t1130 * t310 + 0.4e1 / 0.9e1 * t423 * t937 + 0.4e1 / 0.3e1 * t23 * t3282);
  t3296 = t3252 - 0.3e1 / 0.8e1 * t3253 - 0.3e1 / 0.4e1 * t3255 + t3258 - 0.9e1 / 0.8e1 * t432 * t340 - 0.3e1 / 0.8e1 * t184 * t904 - 0.3e1 / 0.8e1 * t5 * t3286 * t61 - 0.9e1 / 0.8e1 * t1143 * t140 + t2946 - 0.5e1 / 0.12e2 * t2947 - 0.5e1 / 0.12e2 * t2953 + t2955 / 0.2e1 + t2958 / 0.4e1;
  t3311 = t2960 / 0.4e1 - t2962 / 0.8e1 - 0.3e1 / 0.8e1 * t2964 - 0.3e1 / 0.8e1 * t2966 - t2972 / 0.8e1 - t3005 / 0.18e2 - 0.64e2 / 0.729e3 * t3012 - t3035 / 0.9e1 + 0.7e1 / 0.54e2 * t3041 + 0.7e1 / 0.54e2 * t3043 + 0.2e1 / 0.27e2 * t3056 - t3059 / 0.18e2 - 0.7e1 / 0.81e2 * t3061;
  t3317 = t1165 * t297;
  t3319 = t439 * t954;
  t3326 = t439 * t977;
  t3329 = t3146 * t152;
  t3332 = t1114 * t388;
  t3335 = t1118 * t388;
  t3336 = t3335 * t157;
  t3338 = t3142 * t152;
  t3339 = t3338 * t157;
  t3341 = t3133 * t152;
  t3342 = t3341 * t157;
  t3343 = t3342 / 0.27e2;
  t3344 = -0.35e2 / 0.243e3 * t3063 - 0.5e1 / 0.81e2 * t3069 + 0.2e1 / 0.27e2 * t3072 - 0.35e2 / 0.81e2 * t443 * t949 + 0.7e1 / 0.54e2 * t3317 - 0.64e2 / 0.243e3 * t3319 * t959 + 0.7e1 / 0.18e2 * t1162 * t297 + 0.7e1 / 0.18e2 * t1168 * t297 - t3326 * t157 / 0.6e1 - t3329 * t157 / 0.6e1 - t3332 * t157 / 0.3e1 - t3336 / 0.9e1 - t3339 / 0.9e1 + t3343;
  t3348 = my_piecewise3(t1, 0, t3151 + t3175 + t3201 + t3217 + t3250 + t3296 + t3311 + t3344);
  t3349 = t167 * t369;
  t3350 = t3349 * t224;
  t3351 = t3350 * t229;
  t3352 = t3351 / 0.27e2;
  t3353 = t73 * t909;
  t3354 = t3353 * t224;
  t3355 = t3354 * t229;
  t3357 = t409 * t117;
  t3358 = t3357 * t224;
  t3359 = t3358 * t229;
  t3361 = t168 * t1223;
  t3362 = t3361 / 0.4e1;
  t3365 = t74 * t909 * t210 * t100;
  t3367 = t1090 * t27;
  t3368 = t3367 * t218;
  t3371 = t1209 * t172;
  t3373 = t461 * t416;
  t3374 = t3373 / 0.4e1;
  t3375 = t194 * t1099;
  t3377 = t410 * t470;
  t3400 = 0.24e2 * t3093;
  t3402 = my_piecewise5(t14, 0, t10, 0, t3279 + t3400);
  t3406 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t190 * t1077 - 0.8e1 / 0.9e1 * t1076 * t456 * t399 - 0.8e1 / 0.9e1 * t1194 * t164 * t405 + 0.4e1 / 0.3e1 * t398 * t1204 * t164 + 0.4e1 / 0.3e1 * t1197 * t405 + 0.4e1 / 0.9e1 * t452 * t1086 + 0.4e1 / 0.3e1 * t71 * t3402);
  t3410 = t3353 * t218;
  t3411 = t3410 * t221;
  t3413 = t3367 * t224;
  t3416 = t3357 * t218;
  t3417 = t3416 * t221;
  t3419 = t3349 * t218;
  t3420 = t3419 * t221;
  t3421 = t3420 / 0.9e1;
  t3422 = t3352 - 0.5e1 / 0.243e3 * t3355 - t3359 / 0.18e2 + t3362 - 0.5e1 / 0.36e2 * t3365 - t3368 * t221 / 0.6e1 - 0.3e1 / 0.8e1 * t3371 + t3374 - 0.5e1 / 0.36e2 * t3375 - 0.3e1 / 0.8e1 * t3377 - 0.5e1 / 0.12e2 * t3108 + t3113 - t3104 / 0.8e1 + t3106 / 0.4e1 - 0.3e1 / 0.8e1 * t1091 * t212 - 0.3e1 / 0.8e1 * t5 * t3406 * t101 - 0.5e1 / 0.81e2 * t3411 - t3413 * t229 / 0.18e2 - t3417 / 0.6e1 + t3421;
  t3423 = my_piecewise3(t65, 0, t3422);
  tv4rho41 = t1074 + t1103 + 0.3e1 * t1193 + 0.3e1 * t1248 + t6 * (t3348 + t3423);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3432 = t1264 * t27;
  t3433 = t3432 * t146;
  t3436 = t502 * t117;
  t3437 = t3436 * t146;
  t3438 = t3437 * t149;
  t3440 = t1272 * t378;
  t3451 = t1272 * t350;
  t3454 = 0.7e1 / 0.18e2 * t1273 * t392 - t3433 * t149 / 0.3e1 - t3438 / 0.9e1 - t3440 * t149 / 0.3e1 - 0.2e1 / 0.9e1 * t3123 + 0.7e1 / 0.27e2 * t3129 + 0.4e1 / 0.27e2 * t3135 - 0.2e1 / 0.9e1 * t3144 - 0.7e1 / 0.81e2 * t2645 - 0.1e2 / 0.81e2 * t2661 + 0.2e1 / 0.27e2 * t2665 + 0.2e1 / 0.27e2 * t2668 - 0.8e1 / 0.243e3 * t3451 * t353;
  t3455 = t1272 * t358;
  t3458 = t1272 * t343;
  t3467 = t1272 * t283;
  t3472 = t503 * t371;
  t3474 = t1265 * t119;
  t3484 = t427 * t427;
  t3497 = my_piecewise5(t10, 0, t14, 0, t3280);
  t3501 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t493 * t302 - 0.32e2 / 0.27e2 * t1127 * t109 * t427 - 0.8e1 / 0.27e2 * t1251 * t310 + 0.8e1 / 0.9e1 * t301 * t3484 + 0.8e1 / 0.9e1 * t423 * t1138 - 0.8e1 / 0.27e2 * t925 * t498 * t302 + 0.8e1 / 0.9e1 * t301 * t1260 * t109 + 0.4e1 / 0.9e1 * t1256 * t310 + 0.4e1 / 0.3e1 * t23 * t3497);
  t3505 = -0.8e1 / 0.729e3 * t3455 * t347 - 0.4e1 / 0.729e3 * t3458 * t347 - 0.16e2 / 0.729e3 * t3160 + 0.16e2 / 0.6561e4 * t2671 - 0.16e2 / 0.2187e4 * t3164 - 0.8e1 / 0.2187e4 * t3167 + 0.8e1 / 0.6561e4 * t2682 + 0.16e2 / 0.2187e4 * t2687 - 0.8e1 / 0.81e2 * t3467 * t290 + 0.16e2 / 0.729e3 * t2785 - 0.16e2 / 0.243e3 * t3239 + t3472 / 0.12e2 - t3474 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t3501 * t61;
  t3509 = t503 * t321;
  t3522 = -0.3e1 / 0.4e1 * t1265 * t140 - t3509 / 0.4e1 - 0.3e1 / 0.8e1 * t503 * t340 - 0.5e1 / 0.18e2 * t3246 - t3248 / 0.4e1 + t3251 / 0.3e1 - t3253 / 0.4e1 - t3255 / 0.2e1 + t3257 / 0.3e1 + t2946 - 0.5e1 / 0.18e2 * t2947 - 0.5e1 / 0.18e2 * t2953 + t2955 / 0.6e1;
  t3535 = t3436 * t152;
  t3536 = t3535 * t157;
  t3538 = t1272 * t388;
  t3541 = t3432 * t152;
  t3544 = t2958 / 0.12e2 + t2960 / 0.12e2 + 0.2e1 / 0.81e2 * t3056 - 0.7e1 / 0.243e3 * t3061 - 0.1e2 / 0.243e3 * t3069 + 0.2e1 / 0.81e2 * t3072 + 0.7e1 / 0.81e2 * t3317 - 0.2e1 / 0.27e2 * t3336 - 0.2e1 / 0.27e2 * t3339 + 0.4e1 / 0.81e2 * t3342 + 0.7e1 / 0.54e2 * t1276 * t297 - t3536 / 0.27e2 - t3538 * t157 / 0.9e1 - t3541 * t157 / 0.9e1;
  t3547 = my_piecewise3(t1, 0, t3454 + t3505 + t3522 + t3544);
  t3548 = t1234 * t513;
  t3549 = t3548 * t221;
  t3551 = t1235 * t598;
  t3553 = t460 * t117;
  t3554 = t3553 * t218;
  t3555 = t3554 * t221;
  t3557 = t193 * t369;
  t3558 = t3557 * t218;
  t3559 = t3558 * t221;
  t3561 = t1230 * t513;
  t3562 = t3561 * t221;
  t3564 = t1231 * t598;
  t3568 = t1208 * t27;
  t3569 = t3568 * t218;
  t3572 = t1226 * t513;
  t3578 = t1230 * t579;
  t3579 = t3578 * t583;
  t3581 = 0.2e1 / 0.27e2 * t3549 - 0.7e1 / 0.81e2 * t3551 - 0.2e1 / 0.9e1 * t3555 + 0.2e1 / 0.27e2 * t3559 - 0.2e1 / 0.9e1 * t3562 + 0.7e1 / 0.27e2 * t3564 + 0.7e1 / 0.18e2 * t1227 * t598 - t3569 * t221 / 0.3e1 - t3572 * t221 / 0.3e1 - 0.1e2 / 0.81e2 * t3411 - t3417 / 0.9e1 + 0.4e1 / 0.27e2 * t3420 - 0.16e2 / 0.2187e4 * t3579;
  t3582 = t1234 * t579;
  t3583 = t3582 * t583;
  t3585 = t1234 * t586;
  t3586 = t3585 * t583;
  t3588 = t1234 * t571;
  t3589 = t3588 * t574;
  t3591 = t1226 * t571;
  t3594 = t1226 * t579;
  t3597 = t1226 * t586;
  t3600 = t1230 * t586;
  t3601 = t3600 * t583;
  t3603 = t1230 * t571;
  t3604 = t3603 * t574;
  t3606 = t1226 * t530;
  t3609 = t1230 * t530;
  t3610 = t3609 * t537;
  t3612 = t1234 * t530;
  t3613 = t3612 * t537;
  t3619 = t1327 * t172;
  t3621 = 0.16e2 / 0.6561e4 * t3583 + 0.8e1 / 0.6561e4 * t3586 + 0.16e2 / 0.2187e4 * t3589 - 0.8e1 / 0.243e3 * t3591 * t574 - 0.8e1 / 0.729e3 * t3594 * t583 - 0.4e1 / 0.729e3 * t3597 * t583 - 0.8e1 / 0.2187e4 * t3601 - 0.16e2 / 0.729e3 * t3604 - 0.8e1 / 0.81e2 * t3606 * t537 - 0.16e2 / 0.243e3 * t3610 + 0.16e2 / 0.729e3 * t3613 - 0.3e1 / 0.4e1 * t1209 * t212 - 0.3e1 / 0.8e1 * t410 * t568 - t3619 / 0.4e1;
  t3623 = t461 * t470;
  t3625 = t168 * t1310;
  t3635 = t456 * t456;
  t3648 = my_piecewise5(t14, 0, t10, 0, t3400);
  t3652 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t540 * t399 - 0.32e2 / 0.27e2 * t1194 * t164 * t456 - 0.8e1 / 0.27e2 * t1313 * t405 + 0.8e1 / 0.9e1 * t398 * t3635 + 0.8e1 / 0.9e1 * t452 * t1204 - 0.8e1 / 0.27e2 * t1076 * t545 * t399 + 0.8e1 / 0.9e1 * t398 * t1322 * t164 + 0.4e1 / 0.9e1 * t1318 * t405 + 0.4e1 / 0.3e1 * t71 * t3648);
  t3658 = t74 * t369 * t566 * t100;
  t3660 = t550 * t416;
  t3662 = t194 * t1223;
  t3670 = -t3623 / 0.2e1 - t3625 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t3652 * t101 + t3658 / 0.12e2 + t3660 / 0.12e2 + t3662 / 0.6e1 - t3377 / 0.4e1 + t3361 / 0.3e1 - 0.5e1 / 0.18e2 * t3365 - t3371 / 0.4e1 + t3373 / 0.3e1 - 0.5e1 / 0.18e2 * t3375 + t3113;
  t3676 = t1244 * t523;
  t3678 = t3557 * t224;
  t3679 = t3678 * t229;
  t3681 = t1234 * t594;
  t3682 = t3681 * t229;
  t3686 = t3568 * t224;
  t3689 = t1226 * t594;
  t3692 = t3553 * t224;
  t3693 = t3692 * t229;
  t3695 = t1230 * t594;
  t3696 = t3695 * t229;
  t3698 = t1241 * t523;
  t3700 = t3106 / 0.12e2 - 0.5e1 / 0.18e2 * t3108 + 0.4e1 / 0.81e2 * t3351 - 0.1e2 / 0.243e3 * t3355 - t3359 / 0.27e2 - 0.7e1 / 0.243e3 * t3676 + 0.2e1 / 0.81e2 * t3679 + 0.2e1 / 0.81e2 * t3682 + 0.7e1 / 0.54e2 * t1238 * t523 - t3686 * t229 / 0.9e1 - t3689 * t229 / 0.9e1 - 0.2e1 / 0.27e2 * t3693 - 0.2e1 / 0.27e2 * t3696 + 0.7e1 / 0.81e2 * t3698;
  t3703 = my_piecewise3(t65, 0, t3581 + t3621 + t3670 + t3700);
  tv4rho42 = 0.2e1 * t1193 + 0.2e1 * t1248 + 0.2e1 * t1285 + 0.2e1 * t1381 + t6 * (t3547 + t3703);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3724 = my_piecewise5(t10, 0, t14, 0, t3279 + t3280);
  t3728 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t1386 * t109 - 0.8e1 / 0.9e1 * t1251 * t427 - 0.8e1 / 0.9e1 * t1127 * t498 * t109 + 0.4e1 / 0.3e1 * t1130 * t498 + 0.4e1 / 0.3e1 * t423 * t1260 + 0.4e1 / 0.9e1 * t301 * t1393 * t109 + 0.4e1 / 0.3e1 * t23 * t3724);
  t3732 = t1398 * t119;
  t3736 = t1397 * t27;
  t3737 = t3736 * t146;
  t3740 = t3736 * t152;
  t3753 = -0.3e1 / 0.8e1 * t5 * t3728 * t61 - t3732 / 0.8e1 - 0.3e1 / 0.8e1 * t1398 * t140 - t3737 * t149 / 0.6e1 - t3740 * t157 / 0.18e2 - 0.3e1 / 0.8e1 * t3474 + t3472 / 0.4e1 - 0.3e1 / 0.8e1 * t3509 - t3438 / 0.6e1 - t3536 / 0.18e2 + t3252 - 0.5e1 / 0.12e2 * t3246 + t3258 + t3136 + t3343 - 0.5e1 / 0.36e2 * t2947 + t2946 - 0.5e1 / 0.36e2 * t2953 - 0.5e1 / 0.81e2 * t2661 - 0.5e1 / 0.243e3 * t3069;
  t3754 = my_piecewise3(t1, 0, t3753);
  t3755 = t549 * t117;
  t3756 = t3755 * t218;
  t3757 = t3756 * t221;
  t3759 = t1295 * t513;
  t3760 = t3759 * t221;
  t3762 = t477 * t1424;
  t3763 = t3762 * t221;
  t3767 = t473 * t1424;
  t3774 = t1326 * t27;
  t3775 = t3774 * t218;
  t3778 = t1291 * t513;
  t3780 = t478 * t1408;
  t3782 = t1296 * t598;
  t3784 = t1299 * t598;
  t3787 = -t3757 / 0.6e1 - t3760 / 0.3e1 - t3763 / 0.6e1 + 0.7e1 / 0.6e1 * t1286 * t598 - t3767 * t221 / 0.2e1 - 0.35e2 / 0.27e2 * t474 * t1408 + 0.7e1 / 0.6e1 * t1292 * t598 - t3775 * t221 / 0.2e1 - t3778 * t221 - 0.35e2 / 0.81e2 * t3780 + 0.7e1 / 0.18e2 * t3782 + 0.7e1 / 0.18e2 * t3784 + 0.2e1 / 0.9e1 * t3549;
  t3795 = t473 * t1573;
  t3804 = t1291 * t579;
  t3807 = -0.7e1 / 0.27e2 * t3551 - t3555 / 0.3e1 + 0.2e1 / 0.9e1 * t3559 - t3562 / 0.3e1 + 0.7e1 / 0.18e2 * t3564 - 0.5e1 / 0.27e2 * t3411 + t3421 - 0.8e1 / 0.729e3 * t3579 - 0.8e1 / 0.81e2 * t3795 * t574 + 0.56e2 / 0.243e3 * t1370 * t1577 + 0.56e2 / 0.729e3 * t1373 * t1580 + 0.28e2 / 0.729e3 * t1376 * t1580 - 0.8e1 / 0.243e3 * t3804 * t583;
  t3809 = t473 * t1559;
  t3812 = t1291 * t586;
  t3815 = t473 * t1566;
  t3818 = t1291 * t571;
  t3821 = t1361 * t1580;
  t3823 = t1364 * t1580;
  t3825 = t477 * t1573;
  t3826 = t3825 * t574;
  t3828 = t1367 * t1577;
  t3830 = t1295 * t586;
  t3831 = t3830 * t583;
  t3833 = t477 * t1566;
  t3834 = t3833 * t583;
  t3836 = t1295 * t571;
  t3837 = t3836 * t574;
  t3839 = t1295 * t579;
  t3840 = t3839 * t583;
  t3842 = t477 * t1559;
  t3843 = t3842 * t583;
  t3845 = -0.8e1 / 0.243e3 * t3809 * t583 - 0.4e1 / 0.243e3 * t3812 * t583 - 0.4e1 / 0.243e3 * t3815 * t583 - 0.8e1 / 0.81e2 * t3818 * t574 + 0.56e2 / 0.2187e4 * t3821 + 0.28e2 / 0.2187e4 * t3823 - 0.8e1 / 0.243e3 * t3826 + 0.56e2 / 0.729e3 * t3828 - 0.4e1 / 0.729e3 * t3831 - 0.4e1 / 0.729e3 * t3834 - 0.8e1 / 0.243e3 * t3837 - 0.8e1 / 0.729e3 * t3840 - 0.8e1 / 0.729e3 * t3843;
  t3851 = t1295 * t530;
  t3852 = t3851 * t537;
  t3854 = t477 * t1547;
  t3855 = t3854 * t537;
  t3857 = t1355 * t1553;
  t3859 = t477 * t1531;
  t3860 = t3859 * t1535;
  t3862 = t1361 * t1535;
  t3864 = t1364 * t1535;
  t3866 = t477 * t1521;
  t3867 = t3866 * t1524;
  t3869 = t1367 * t1524;
  t3871 = t477 * t1514;
  t3872 = t3871 * t1518;
  t3874 = 0.16e2 / 0.2187e4 * t3583 + 0.8e1 / 0.2187e4 * t3586 + 0.16e2 / 0.729e3 * t3589 - 0.4e1 / 0.729e3 * t3601 - 0.8e1 / 0.243e3 * t3604 - 0.8e1 / 0.81e2 * t3852 - 0.8e1 / 0.81e2 * t3855 + 0.56e2 / 0.243e3 * t3857 - 0.64e2 / 0.19683e5 * t3860 - 0.64e2 / 0.19683e5 * t3862 - 0.64e2 / 0.59049e5 * t3864 - 0.64e2 / 0.6561e4 * t3867 - 0.32e2 / 0.6561e4 * t3869 - 0.64e2 / 0.2187e4 * t3872;
  t3881 = t473 * t1531;
  t3888 = t1291 * t530;
  t3891 = t473 * t1547;
  t3894 = t473 * t1514;
  t3897 = t473 * t1521;
  t3918 = my_piecewise5(t14, 0, t10, 0, -t3279 + t3400);
  t3922 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t1429 * t164 - 0.8e1 / 0.9e1 * t1313 * t456 - 0.8e1 / 0.9e1 * t1194 * t545 * t164 + 0.4e1 / 0.3e1 * t1197 * t545 + 0.4e1 / 0.3e1 * t452 * t1322 + 0.4e1 / 0.9e1 * t398 * t1436 * t164 + 0.4e1 / 0.3e1 * t71 * t3918);
  t3928 = 0.56e2 / 0.81e2 * t1358 * t1553 - 0.32e2 / 0.2187e4 * t1370 * t1524 - 0.64e2 / 0.6561e4 * t3881 * t1535 - 0.64e2 / 0.6561e4 * t1373 * t1535 - 0.64e2 / 0.19683e5 * t1376 * t1535 - 0.8e1 / 0.27e2 * t3888 * t537 - 0.8e1 / 0.27e2 * t3891 * t537 - 0.64e2 / 0.729e3 * t3894 * t1518 - 0.64e2 / 0.2187e4 * t3897 * t1524 - 0.8e1 / 0.81e2 * t3610 + 0.16e2 / 0.243e3 * t3613 - 0.3e1 / 0.8e1 * t5 * t3922 * t101 - 0.9e1 / 0.8e1 * t1327 * t212;
  t3933 = t1441 * t172;
  t3935 = t550 * t470;
  t3937 = t194 * t1310;
  t3941 = t74 * t117 * t1470 * t100;
  t3949 = -0.9e1 / 0.8e1 * t461 * t568 - 0.3e1 / 0.8e1 * t168 * t1472 - t3933 / 0.8e1 - 0.3e1 / 0.8e1 * t3935 - 0.3e1 / 0.8e1 * t3937 - t3941 / 0.8e1 - 0.3e1 / 0.8e1 * t3619 - 0.3e1 / 0.4e1 * t3623 - 0.3e1 / 0.8e1 * t3625 + t3658 / 0.4e1 + t3660 / 0.4e1 + t3662 / 0.2e1 + t3362;
  t3961 = -0.5e1 / 0.12e2 * t3365 + t3374 - 0.5e1 / 0.12e2 * t3375 + t3113 - 0.5e1 / 0.36e2 * t3108 + t3352 - 0.5e1 / 0.81e2 * t3355 - 0.7e1 / 0.81e2 * t3676 + 0.2e1 / 0.27e2 * t3679 + 0.2e1 / 0.27e2 * t3682 - t3693 / 0.9e1 - t3696 / 0.9e1 + 0.7e1 / 0.54e2 * t3698;
  t3962 = t477 * t1486;
  t3963 = t3962 * t1491;
  t3965 = t3755 * t224;
  t3966 = t3965 * t229;
  t3968 = t1295 * t594;
  t3969 = t3968 * t229;
  t3971 = t477 * t1500;
  t3972 = t3971 * t229;
  t3974 = t1338 * t523;
  t3976 = t1341 * t523;
  t3978 = t484 * t1509;
  t3982 = t473 * t1486;
  t3985 = t3774 * t224;
  t3988 = t1291 * t594;
  t3991 = t473 * t1500;
  t3998 = -0.64e2 / 0.729e3 * t3963 - t3966 / 0.18e2 - t3969 / 0.9e1 - t3972 / 0.18e2 + 0.7e1 / 0.54e2 * t3974 + 0.7e1 / 0.54e2 * t3976 - 0.35e2 / 0.243e3 * t3978 + 0.7e1 / 0.18e2 * t1351 * t523 - 0.64e2 / 0.243e3 * t3982 * t1491 - t3985 * t229 / 0.6e1 - t3988 * t229 / 0.3e1 - t3991 * t229 / 0.6e1 + 0.7e1 / 0.18e2 * t1348 * t523 - 0.35e2 / 0.81e2 * t481 * t1509;
  t4002 = my_piecewise3(t65, 0, t3787 + t3807 + t3845 + t3874 + t3928 + t3949 + t3961 + t3998);
  tv4rho43 = 0.3e1 * t1285 + 0.3e1 * t1381 + t1404 + t1591 + t6 * (t3754 + t4002);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4007 = t493 * t493;
  t4012 = t498 * t498;
  t4019 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t933 + 0.24e2 * t2924);
  t4023 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2910 * t4007 - 0.16e2 / 0.9e1 * t1251 * t498 + 0.4e1 / 0.3e1 * t301 * t4012 + 0.16e2 / 0.9e1 * t423 * t1393 + 0.4e1 / 0.3e1 * t23 * t4019);
  t4031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t4023 * t61 - t3732 / 0.2e1 + t3472 / 0.2e1 - 0.5e1 / 0.9e1 * t3246 + t2946);
  t4033 = 0.1e1 / t77 / t1449;
  t4034 = t84 * t4033;
  t4051 = t1440 * t27;
  t4052 = t4051 * t218;
  t4055 = t1418 * t513;
  t4058 = t509 * t1424;
  t4062 = t215 * t1470 * t217;
  t4068 = 0.455e3 / 0.81e2 * t219 * t220 * t4034 + 0.7e1 / 0.3e1 * t1419 * t598 + 0.14e2 / 0.3e1 * t1422 * t598 + 0.7e1 / 0.3e1 * t1425 * t598 - 0.2e1 / 0.3e1 * t3757 - 0.4e1 / 0.3e1 * t3760 - 0.2e1 / 0.3e1 * t3763 - 0.14e3 / 0.27e2 * t510 * t1408 - 0.14e3 / 0.27e2 * t514 * t1408 - 0.2e1 / 0.3e1 * t4052 * t221 - 0.2e1 * t4055 * t221 - 0.2e1 * t4058 * t221 - 0.2e1 / 0.3e1 * t4062 * t221 - 0.14e3 / 0.81e2 * t3780 + 0.14e2 / 0.9e1 * t3782 + 0.14e2 / 0.9e1 * t3784;
  t4073 = t509 * t1573;
  t4077 = t215 * t1424 * t227;
  t4092 = t509 * t1566;
  t4096 = t215 * t1500 * t227;
  t4099 = t1418 * t579;
  t4102 = t509 * t1559;
  t4106 = t215 * t1500 * t578;
  t4109 = 0.4e1 / 0.9e1 * t3549 - 0.14e2 / 0.27e2 * t3551 + 0.4e1 / 0.9e1 * t3559 - 0.2e2 / 0.81e2 * t3411 - 0.32e2 / 0.81e2 * t4073 * t574 - 0.16e2 / 0.81e2 * t4077 * t574 + 0.224e3 / 0.243e3 * t1574 * t1577 + 0.112e3 / 0.729e3 * t1563 * t1580 + 0.112e3 / 0.729e3 * t1567 * t1580 + 0.224e3 / 0.243e3 * t1570 * t1577 + 0.224e3 / 0.729e3 * t1556 * t1580 + 0.224e3 / 0.729e3 * t1560 * t1580 - 0.16e2 / 0.243e3 * t4092 * t583 - 0.8e1 / 0.243e3 * t4096 * t583 - 0.16e2 / 0.243e3 * t4099 * t583 - 0.32e2 / 0.243e3 * t4102 * t583 - 0.16e2 / 0.243e3 * t4106 * t583;
  t4111 = t1418 * t586;
  t4115 = 0.1e1 / t78 / t1994;
  t4116 = t75 * t4115;
  t4120 = t4116 * t582;
  t4125 = t1418 * t571;
  t4140 = -0.8e1 / 0.243e3 * t4111 * t583 - 0.3416e4 / 0.2187e4 * t572 * t4116 * t573 - 0.3416e4 / 0.6561e4 * t580 * t4120 - 0.1708e4 / 0.6561e4 * t587 * t4120 - 0.16e2 / 0.81e2 * t4125 * t574 + 0.224e3 / 0.2187e4 * t3821 + 0.112e3 / 0.2187e4 * t3823 - 0.32e2 / 0.243e3 * t3826 + 0.224e3 / 0.729e3 * t3828 - 0.16e2 / 0.729e3 * t3831 - 0.16e2 / 0.729e3 * t3834 - 0.32e2 / 0.243e3 * t3837 - 0.32e2 / 0.729e3 * t3840 - 0.32e2 / 0.729e3 * t3843 + 0.32e2 / 0.2187e4 * t3583 + 0.16e2 / 0.2187e4 * t3586 + 0.32e2 / 0.729e3 * t3589;
  t4143 = t532 * t532;
  t4146 = 0.1e1 / t77 / t4143 / rho[1];
  t4147 = t2525 * t4146;
  t4149 = M_PI * t1466 * t43;
  t4150 = t4147 * t4149;
  t4153 = t509 * t1531;
  t4157 = t215 * t594 * t1530;
  t4160 = t1418 * t530;
  t4163 = t509 * t1547;
  t4166 = 0.1e1 / t4143;
  t4167 = t796 * t4166;
  t4168 = t4167 * t1534;
  t4174 = t4167 * t1523;
  t4180 = 0.1e1 / t1529 / t92;
  t4182 = t215 * t224 * t4180;
  t4183 = t561 * t561;
  t4184 = 0.1e1 / t4183;
  t4186 = t4184 * M_PI * t43;
  t4187 = t4147 * t4186;
  t4202 = -0.128e3 / 0.2187e4 * t1574 * t1524 - 0.1024e4 / 0.177147e6 * t572 * t4150 - 0.256e3 / 0.6561e4 * t4153 * t1535 - 0.256e3 / 0.6561e4 * t4157 * t1535 - 0.16e2 / 0.27e2 * t4160 * t537 - 0.32e2 / 0.27e2 * t4163 * t537 + 0.896e3 / 0.19683e5 * t587 * t4168 + 0.896e3 / 0.729e3 * t1515 * t4167 * t1517 + 0.896e3 / 0.2187e4 * t1522 * t4174 + 0.448e3 / 0.2187e4 * t572 * t4174 - 0.1024e4 / 0.177147e6 * t4182 * t4187 - 0.512e3 / 0.59049e5 * t1532 * t4187 - 0.256e3 / 0.6561e4 * t1556 * t1535 - 0.256e3 / 0.6561e4 * t1560 * t1535 - 0.2816e4 / 0.531441e6 * t580 * t4187 - 0.256e3 / 0.19683e5 * t1563 * t1535 - 0.256e3 / 0.19683e5 * t1567 * t1535;
  t4207 = t566 * t528;
  t4209 = t215 * t4207 * t99;
  t4212 = t509 * t1514;
  t4216 = t215 * t1546 * t227;
  t4220 = t215 * t1486 * t227;
  t4222 = M_PI * t206 * t43;
  t4227 = t215 * t529 * t578;
  t4229 = M_PI * t562 * t43;
  t4230 = t4147 * t4229;
  t4235 = t509 * t1521;
  t4239 = t215 * t513 * t578;
  t4243 = t215 * t218 * t1530;
  t4254 = -0.256e3 / 0.177147e6 * t587 * t4187 - 0.16e2 / 0.27e2 * t4209 * t537 - 0.256e3 / 0.729e3 * t4212 * t1518 - 0.256e3 / 0.729e3 * t4216 * t1518 - 0.1024e4 / 0.6561e4 * t4220 * t4147 * t4222 - 0.1024e4 / 0.19683e5 * t4227 * t4230 - 0.512e3 / 0.19683e5 * t1515 * t4230 - 0.256e3 / 0.2187e4 * t4235 * t1524 - 0.256e3 / 0.2187e4 * t4239 * t1524 - 0.1024e4 / 0.59049e5 * t4243 * t4150 - 0.1024e4 / 0.59049e5 * t1522 * t4150 - 0.128e3 / 0.2187e4 * t1570 * t1524 - 0.32e2 / 0.81e2 * t3852 - 0.32e2 / 0.81e2 * t3855 + 0.224e3 / 0.243e3 * t3857 - 0.256e3 / 0.19683e5 * t3860;
  t4278 = t4034 * t206;
  t4291 = t4184 * t41 * t43;
  t4299 = t540 * t540;
  t4304 = t545 * t545;
  t4311 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t933 + 0.24e2 * t3093);
  t4315 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t4299 - 0.16e2 / 0.9e1 * t1313 * t545 + 0.4e1 / 0.3e1 * t398 * t4304 + 0.16e2 / 0.9e1 * t452 * t1436 + 0.4e1 / 0.3e1 * t71 * t4311);
  t4324 = -0.256e3 / 0.19683e5 * t3862 - 0.256e3 / 0.59049e5 * t3864 - 0.256e3 / 0.6561e4 * t3867 - 0.128e3 / 0.6561e4 * t3869 - 0.256e3 / 0.2187e4 * t3872 - 0.3416e4 / 0.729e3 * t531 * t75 * t4115 * t41 * t3 + 0.224e3 / 0.81e2 * t1542 * t1553 + 0.224e3 / 0.81e2 * t1548 * t1553 + 0.896e3 / 0.6561e4 * t1532 * t4168 + 0.896e3 / 0.6561e4 * t580 * t4168 + 0.32e2 / 0.243e3 * t3613 - 0.3e1 / 0.2e1 * t194 * t1472 - 0.3e1 / 0.8e1 * t74 * t27 * (0.41888e5 / 0.6561e4 * t29 * t4116 + 0.364e4 / 0.2187e4 * t130 * t4278 - 0.13664e5 / 0.19683e5 * t331 * sigma[2] * t4115 * t562 + 0.7168e4 / 0.59049e5 * t1462 * t4166 * t1466 - 0.2048e4 / 0.1594323e7 * t2986 * t2525 * t4146 * t4291) * t100 - 0.3e1 / 0.8e1 * t5 * t4315 * t101 - 0.3e1 / 0.2e1 * t1441 * t212 - 0.9e1 / 0.4e1 * t550 * t568 - t3933 / 0.2e1;
  t4341 = -0.3e1 / 0.2e1 * t3935 - 0.3e1 / 0.2e1 * t3937 - t3941 / 0.2e1 + t3658 / 0.2e1 + t3660 / 0.2e1 + t3662 - 0.5e1 / 0.9e1 * t3365 - 0.5e1 / 0.9e1 * t3375 + t3113 - 0.2e2 / 0.243e3 * t3355 - 0.14e2 / 0.81e2 * t3676 + 0.4e1 / 0.27e2 * t3679 + 0.4e1 / 0.27e2 * t3682 - 0.256e3 / 0.729e3 * t3963 - 0.2e1 / 0.9e1 * t3966 - 0.4e1 / 0.9e1 * t3969 - 0.2e1 / 0.9e1 * t3972;
  t4354 = t215 * t94 / t1484 / t97;
  t4364 = t4051 * t224;
  t4367 = t1418 * t594;
  t4370 = t509 * t1500;
  t4374 = t215 * t1470 * t98;
  t4382 = t509 * t1486;
  t4386 = t215 * t210 * t1485;
  t4393 = 0.14e2 / 0.27e2 * t3974 + 0.14e2 / 0.27e2 * t3976 - 0.14e3 / 0.243e3 * t3978 + 0.7e1 / 0.9e1 * t1494 * t523 + 0.14e2 / 0.9e1 * t1497 * t523 + 0.7e1 / 0.9e1 * t1501 * t523 - 0.1024e4 / 0.2187e4 * t4354 * t99 * t2525 * t4146 * M_PI * t43 + 0.455e3 / 0.243e3 * t225 * t228 * t4278 - 0.2e1 / 0.9e1 * t4364 * t229 - 0.2e1 / 0.3e1 * t4367 * t229 - 0.2e1 / 0.3e1 * t4370 * t229 - 0.2e1 / 0.9e1 * t4374 * t229 + 0.896e3 / 0.243e3 * t1487 * t1488 * t4166 * t2 * t28 - 0.256e3 / 0.243e3 * t4382 * t1491 - 0.256e3 / 0.243e3 * t4386 * t1491 - 0.14e3 / 0.81e2 * t591 * t1509 - 0.14e3 / 0.81e2 * t595 * t1509;
  t4397 = my_piecewise3(t65, 0, t4068 + t4109 + t4140 + t4202 + t4254 + t4324 + t4341 + t4393);
  tv4rho44 = 0.4e1 * t1404 + 0.4e1 * t1591 + t6 * (t4031 + t4397);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4401 = t2664 * t249;
  t4403 = t857 * t650;
  t4407 = t2667 * t249;
  t4413 = t868 * t626;
  t4416 = t364 * t1676;
  t4418 = t853 * t626;
  t4419 = t4418 * t149;
  t4421 = t374 * t1676;
  t4422 = t4421 * t149;
  t4426 = t143 * t1714 * t145;
  t4443 = t2648 * t249;
  t4445 = t2610 * t249;
  t4449 = -t4426 * t149 / 0.2e1 + t2652 * t249 / 0.16e2 + 0.3e1 / 0.16e2 * t2656 * t249 - t872 * t650 / 0.2e1 - t861 * t650 / 0.4e1 + 0.7e1 / 0.12e2 * t365 * t1655 + 0.7e1 / 0.6e1 * t1670 * t392 + 0.7e1 / 0.6e1 * t1677 * t392 + t4443 / 0.16e2 + t4445 / 0.8e1 - t869 * t650 / 0.4e1;
  t4451 = t2613 * t249;
  t4453 = t864 * t626;
  t4454 = t4453 * t149;
  t4456 = t865 * t650;
  t4459 = 0.5e1 / 0.216e3 * t2660 * t249;
  t4460 = t854 * t650;
  t4462 = t375 * t1655;
  t4464 = t239 * t848;
  t4468 = t1673 * t392;
  t4472 = t374 * t1769;
  t4473 = t4472 * t353;
  t4476 = t143 * t1676 * t155;
  t4479 = t4451 / 0.16e2 - t4454 / 0.3e1 - t4456 / 0.6e1 + t4459 + t4460 / 0.18e2 + 0.7e1 / 0.36e2 * t4462 - 0.35e2 / 0.54e2 * t147 * t148 * t4464 + 0.7e1 / 0.18e2 * t4468 - 0.35e2 / 0.27e2 * t627 * t850 - 0.8e1 / 0.243e3 * t4473 - 0.8e1 / 0.81e2 * t4476 * t353;
  t4481 = t143 * t1759 * t357;
  t4485 = t143 * t1759 * t155;
  t4488 = t374 * t1777;
  t4489 = t4488 * t347;
  t4491 = t374 * t1773;
  t4492 = t4491 * t347;
  t4494 = t364 * t1773;
  t4497 = t364 * t1777;
  t4506 = t364 * t1769;
  t4509 = t2778 * t1619;
  t4511 = -0.8e1 / 0.243e3 * t4481 * t347 - 0.4e1 / 0.243e3 * t4485 * t347 - 0.4e1 / 0.729e3 * t4489 - 0.8e1 / 0.729e3 * t4492 - 0.8e1 / 0.243e3 * t4494 * t347 - 0.4e1 / 0.243e3 * t4497 * t347 + 0.56e2 / 0.729e3 * t1774 * t1066 + 0.28e2 / 0.729e3 * t1778 * t1066 + 0.56e2 / 0.243e3 * t1770 * t1063 - 0.8e1 / 0.81e2 * t4506 * t353 + 0.8e1 / 0.729e3 * t4509;
  t4514 = t1046 * t1619;
  t4520 = t2670 * t659;
  t4522 = t2681 * t659;
  t4524 = t30 * t882;
  t4525 = t4524 * t346;
  t4528 = t2737 * t659;
  t4530 = t2725 * t659;
  t4540 = 0.1e1 / t33 / t2792;
  t4543 = M_PI * sigma[0] * t43;
  t4544 = t4540 * t898 * t4543;
  t4548 = t4540 * t2798 * t4543;
  t4560 = t143 * t626 * t357;
  t4566 = t143 * t630 * t1016;
  t4571 = 0.8e1 / 0.729e3 * t2829 * t1640 + 0.128e3 / 0.19683e5 * t2823 * t4544 + 0.128e3 / 0.59049e5 * t2839 * t4548 + 0.64e2 / 0.19683e5 * t1018 * t4548 + 0.8e1 / 0.729e3 * t1056 * t1640 + 0.128e3 / 0.19683e5 * t1012 * t4544 + 0.8e1 / 0.2187e4 * t1033 * t1640 - 0.64e2 / 0.2187e4 * t4560 * t1001 - 0.32e2 / 0.2187e4 * t1770 * t1001 - 0.64e2 / 0.6561e4 * t4566 * t1006 - 0.64e2 / 0.6561e4 * t1774 * t1006;
  t4575 = t4540 * M_PI;
  t4578 = t4575 * sigma[0] * t334 * t43;
  t4584 = t143 * t1624 * t155;
  t4590 = t1049 * t1630;
  t4594 = t4464 * t134;
  t4614 = t113 * t1689;
  t4618 = t26 * t369 * t621 * t60;
  t4620 = t315 * t608;
  t4622 = t113 * t1699;
  t4624 = -0.64e2 / 0.19683e5 * t1778 * t1006 + 0.128e3 / 0.6561e4 * t2853 * t4578 + 0.64e2 / 0.6561e4 * t993 * t4578 - 0.64e2 / 0.729e3 * t4584 * t996 - 0.88e2 / 0.243e3 * t993 * t957 * t1613 - 0.5e1 / 0.243e3 * t4590 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t4524 - 0.14e3 / 0.729e3 * t130 * t4594 + 0.952e3 / 0.6561e4 * t330 * t4524 * t334 - 0.704e3 / 0.19683e5 * t893 * t896 * t1711 + 0.256e3 / 0.531441e6 * t2986 * t4540 * t2798 * sigma[0] * t41 * t43) * t60 + t4614 / 0.4e1 + t4618 / 0.4e1 - 0.3e1 / 0.8e1 * t4620 - 0.3e1 / 0.4e1 * t4622;
  t4633 = t26 * t117 * t1714 * t60;
  t4638 = 0.5e1 / 0.36e2 * t26 * t909 * t244 * t60;
  t4639 = t957 * t1618;
  t4642 = t2781 * t1640;
  t4644 = t899 * t1639;
  t4647 = t1049 * t1640;
  t4649 = t1043 * t1630;
  t4653 = -0.3e1 / 0.8e1 * t942 * t246 - 0.9e1 / 0.8e1 * t315 * t623 - 0.9e1 / 0.8e1 * t113 * t1716 - 0.3e1 / 0.8e1 * t4633 - t4638 - 0.88e2 / 0.729e3 * t1012 * t4639 + 0.8e1 / 0.2187e4 * t4642 - 0.88e2 / 0.2187e4 * t1018 * t4644 + 0.8e1 / 0.2187e4 * t4647 - 0.5e1 / 0.486e3 * t4649 + 0.119e3 / 0.2187e4 * t344 * t4525;
  t4657 = t1043 * t1640;
  t4684 = t2686 * t647;
  t4686 = t1046 * t1633;
  t4688 = t2775 * t1614;
  t4690 = t364 * t1625;
  t4693 = t374 * t1625;
  t4694 = t4693 * t290;
  t4698 = t2731 * t647;
  t4706 = -0.88e2 / 0.6561e4 * t344 * t4644 - 0.2e1 / 0.243e3 * t4684 - 0.5e1 / 0.81e2 * t4686 + 0.8e1 / 0.243e3 * t4688 - 0.8e1 / 0.27e2 * t4690 * t290 - 0.8e1 / 0.81e2 * t4694 + 0.56e2 / 0.81e2 * t1626 * t1030 + 0.2e1 / 0.81e2 * t4698 - 0.5e1 / 0.27e2 * t1040 * t1633 + 0.8e1 / 0.81e2 * t2842 * t1614 + 0.2e1 / 0.27e2 * t2722 * t647;
  t4712 = t2734 * t647;
  t4714 = t2691 * t659;
  t4716 = t2728 * t659;
  t4730 = 0.2e1 / 0.81e2 * t2705 * t659 + t2747 * t659 / 0.81e2 + 0.2e1 / 0.81e2 * t4712 + 0.2e1 / 0.243e3 * t4714 + t4716 / 0.243e3 + 0.8e1 / 0.81e2 * t2766 * t1614 + 0.8e1 / 0.2187e4 * t1037 * t1640 + 0.128e3 / 0.59049e5 * t351 * t4544 + 0.352e3 / 0.177147e6 * t359 * t4548 + 0.32e2 / 0.59049e5 * t344 * t4548 - 0.5e1 / 0.81e2 * t1060 * t1630;
  t4737 = t621 * t281;
  t4739 = t143 * t4737 * t59;
  t4752 = t1741 * t297;
  t4755 = 0.5e1 / 0.648e3 * t3068 * t252;
  t4756 = 0.8e1 / 0.243e3 * t2819 * t1619 + 0.8e1 / 0.729e3 * t2833 * t1640 + 0.8e1 / 0.729e3 * t1060 * t1640 - 0.8e1 / 0.27e2 * t4739 * t290 - 0.5e1 / 0.162e3 * t1033 * t1630 - 0.5e1 / 0.162e3 * t1037 * t1630 - 0.44e2 / 0.729e3 * t351 * t4639 - 0.88e2 / 0.2187e4 * t359 * t4644 - 0.35e2 / 0.81e2 * t631 * t949 + 0.7e1 / 0.54e2 * t4752 + t4755;
  t4759 = t984 * t662;
  t4761 = t3055 * t252;
  t4763 = t981 * t662;
  t4765 = t385 * t1721;
  t4776 = t3071 * t252;
  t4778 = t974 * t662;
  t4781 = t374 * t1759;
  t4782 = t4781 * t157;
  t4784 = t3011 * t1750;
  t4790 = t3058 * t252;
  t4794 = t3034 * t252;
  t4796 = t3004 * t252;
  t4801 = t374 * t987 * t644;
  t4804 = t143 * t244 * t953;
  t4809 = -t4782 / 0.9e1 + 0.8e1 / 0.81e2 * t4784 - 0.88e2 / 0.81e2 * t955 * t59 * t896 * t1639 + t4790 / 0.48e2 - t966 * t662 / 0.12e2 + t4794 / 0.24e2 + t4796 / 0.48e2 - t978 * t662 / 0.12e2 + 0.2e1 / 0.27e2 * t4801 - 0.64e2 / 0.243e3 * t4804 * t959 + 0.7e1 / 0.18e2 * t1738 * t297;
  t4811 = t868 * t630;
  t4814 = t864 * t630;
  t4815 = t4814 * t157;
  t4819 = t1766 * t1733;
  t4821 = t853 * t630;
  t4822 = t4821 * t157;
  t4825 = t864 * t282 * t644;
  t4833 = t853 * t282 * t644;
  t4840 = -t4811 * t157 / 0.6e1 - t4815 / 0.9e1 + 0.7e1 / 0.36e2 * t382 * t1721 - 0.5e1 / 0.27e2 * t4819 + t4822 / 0.27e2 + 0.2e1 / 0.27e2 * t4825 - 0.5e1 / 0.9e1 * t1763 * t1733 + t868 * t282 * t644 / 0.9e1 - 0.2e1 / 0.81e2 * t4833 + 0.238e3 / 0.243e3 * t640 * t641 * t1029 + t3052 * t252 / 0.48e2;
  t4843 = t364 * t1759;
  t4847 = t143 * t1714 * t58;
  t4870 = t2998 * t252 / 0.16e2 - t4843 * t157 / 0.3e1 - t4847 * t157 / 0.6e1 + t3001 * t252 / 0.16e2 + t3008 * t252 / 0.48e2 - 0.5e1 / 0.9e1 * t1746 * t1733 + 0.2e1 / 0.9e1 * t364 * t987 * t644 + t143 * t2867 * t644 / 0.9e1 + 0.8e1 / 0.27e2 * t3038 * t1750 + 0.8e1 / 0.27e2 * t3049 * t1750 + 0.128e3 / 0.729e3 * t3022 * t59 * t4540 * t4543;
  t4875 = my_piecewise3(t1, 0, 0.128e3 / 0.2187e4 * t2846 * t4575 * sigma[0] * t43 * t134 + 0.7e1 / 0.12e2 * t379 * t1655 + 0.3e1 / 0.16e2 * t2616 * t249 + t2620 * t249 / 0.16e2 - t4413 * t149 / 0.2e1 - t4416 * t149 + 0.238e3 / 0.729e3 * t351 * t4524 * t352 - 0.35e2 / 0.162e3 * t153 * t156 * t4594 + t2751 * t659 / 0.162e3 - 0.5e1 / 0.27e2 * t1053 * t1633 + 0.7e1 / 0.36e2 * t389 * t1721 + 0.7e1 / 0.18e2 * t1760 * t297 - t971 * t662 / 0.6e1 + 0.8e1 / 0.243e3 * t2815 * t1619 + 0.4e1 / 0.243e3 * t1040 * t1619 + 0.238e3 / 0.2187e4 * t359 * t4525 - 0.5e1 / 0.81e2 * t1056 * t1630 + 0.4e1 / 0.243e3 * t1053 * t1619 + t2719 * t647 / 0.27e2 + t2700 * t659 / 0.81e2 + t2744 * t659 / 0.162e3 + t2695 * t647 / 0.27e2 + t2755 * t659 / 0.81e2 + t4870 + t4840 + t4809 - t4778 / 0.18e2 - t4776 / 0.72e2 + 0.7e1 / 0.108e3 * t4765 - t4763 / 0.18e2 + t4759 / 0.54e2 - t4761 / 0.72e2 + t4756 + t4730 + t4706 + 0.8e1 / 0.6561e4 * t4657 + t4653 + t4624 - t4401 / 0.24e2 - t4403 / 0.6e1 - t4407 / 0.24e2 + t4419 / 0.9e1 - t4422 / 0.3e1 + t4449 + t4479 + t4511 + 0.4e1 / 0.729e3 * t4514 - 0.2e1 / 0.729e3 * t4520 - t4522 / 0.729e3 + 0.2e1 / 0.243e3 * t4528 + t4530 / 0.243e3 + t4571);
  tv4rho3sigma0 = t6 * t4875 + 0.3e1 * t1784;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4880 = t410 * t673;
  t4882 = t168 * t1792;
  t4887 = 0.5e1 / 0.36e2 * t74 * t909 * t265 * t100;
  t4890 = t3416 * t270;
  t4892 = t3419 * t270;
  t4895 = 0.5e1 / 0.216e3 * t3410 * t270;
  t4898 = t3358 * t273;
  t4900 = t3350 * t273;
  t4903 = 0.5e1 / 0.648e3 * t3354 * t273;
  t4904 = -0.3e1 / 0.8e1 * t1091 * t267 - 0.3e1 / 0.8e1 * t4880 + t4882 / 0.4e1 - t4887 + t3368 * t270 / 0.16e2 + t4890 / 0.16e2 - t4892 / 0.24e2 + t4895 + t3413 * t273 / 0.48e2 + t4898 / 0.48e2 - t4900 / 0.72e2 + t4903;
  t4905 = my_piecewise3(t65, 0, t4904);
  tv4rho3sigma2 = t6 * t4905 + 0.3e1 * t1808;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4907 = 0.2e1 * t1864;
  t4908 = t1114 * t626;
  t4911 = t439 * t1676;
  t4921 = t3143 * t249 / 0.24e2;
  t4923 = t3122 * t249 / 0.24e2;
  t4928 = t1118 * t626;
  t4930 = t4928 * t149 / 0.9e1;
  t4933 = t3134 * t249;
  t4936 = t1119 * t650 / 0.18e2;
  t4940 = -t4908 * t149 / 0.3e1 - t4911 * t149 / 0.3e1 + t3147 * t249 / 0.16e2 + t3137 * t249 / 0.8e1 + t3139 * t249 / 0.16e2 + t4921 + t4923 - t1115 * t650 / 0.6e1 - t1111 * t650 / 0.6e1 - t4930 + 0.7e1 / 0.18e2 * t1823 * t392 - t4933 / 0.72e2 - t4936 + 0.7e1 / 0.36e2 * t440 * t1655 - t4401 / 0.36e2;
  t4955 = -t4403 / 0.18e2 - t4407 / 0.36e2 + 0.2e1 / 0.27e2 * t4419 - t4422 / 0.9e1 + t4443 / 0.48e2 + t4445 / 0.24e2 + t4451 / 0.48e2 - t4454 / 0.9e1 - t4456 / 0.18e2 + t4459 + t4460 / 0.27e2 + 0.7e1 / 0.108e3 * t4462 + 0.7e1 / 0.54e2 * t4468 - 0.8e1 / 0.729e3 * t4473 - 0.4e1 / 0.2187e4 * t4489;
  t4958 = t439 * t1769;
  t4961 = t439 * t1773;
  t4964 = t439 * t1777;
  t4977 = t432 * t608 / 0.4e1;
  t4979 = t184 * t1699 / 0.4e1;
  t4982 = -0.8e1 / 0.2187e4 * t4492 - 0.8e1 / 0.243e3 * t4958 * t353 - 0.8e1 / 0.729e3 * t4961 * t347 - 0.4e1 / 0.729e3 * t4964 * t347 + 0.8e1 / 0.2187e4 * t4509 + 0.4e1 / 0.2187e4 * t4514 - 0.4e1 / 0.2187e4 * t4520 - 0.2e1 / 0.2187e4 * t4522 + 0.2e1 / 0.729e3 * t4528 + t4530 / 0.729e3 - 0.5e1 / 0.729e3 * t4590 - 0.3e1 / 0.8e1 * t184 * t1716 - t4977 - t4979 - 0.3e1 / 0.8e1 * t1143 * t246;
  t4985 = t184 * t1689;
  t4993 = 0.2e1 / 0.729e3 * t3163 * t659;
  t4995 = t3166 * t659 / 0.729e3;
  t5008 = -0.3e1 / 0.4e1 * t432 * t623 + t4985 / 0.12e2 + t4614 / 0.6e1 + t4618 / 0.6e1 - t4620 / 0.8e1 - t4622 / 0.4e1 - t4633 / 0.8e1 - t4638 + t4993 + t4995 + 0.2e1 / 0.81e2 * t3192 * t647 + 0.2e1 / 0.243e3 * t3183 * t659 + t3169 * t659 / 0.243e3 + 0.2e1 / 0.81e2 * t3189 * t647 + 0.2e1 / 0.243e3 * t3186 * t659 + t3172 * t659 / 0.243e3;
  t5011 = t439 * t1625;
  t5015 = 0.2e1 / 0.243e3 * t3159 * t647;
  t5038 = -0.8e1 / 0.81e2 * t5011 * t290 + t5015 - 0.5e1 / 0.81e2 * t1179 * t1633 + 0.8e1 / 0.243e3 * t3241 * t1614 + 0.8e1 / 0.6561e4 * t4642 + 0.8e1 / 0.6561e4 * t4647 - 0.5e1 / 0.1458e4 * t4649 + 0.8e1 / 0.19683e5 * t4657 - 0.5e1 / 0.243e3 * t1182 * t1630 - 0.5e1 / 0.486e3 * t1185 * t1630 + 0.8e1 / 0.2187e4 * t3225 * t1640 + 0.8e1 / 0.2187e4 * t1182 * t1640 + 0.8e1 / 0.6561e4 * t1185 * t1640 + 0.8e1 / 0.729e3 * t3220 * t1619 + 0.4e1 / 0.729e3 * t1179 * t1619;
  t5053 = -0.4e1 / 0.729e3 * t4684 - 0.5e1 / 0.243e3 * t4686 + 0.8e1 / 0.729e3 * t4688 - 0.8e1 / 0.243e3 * t4694 + 0.2e1 / 0.243e3 * t4698 + 0.2e1 / 0.243e3 * t4712 + 0.2e1 / 0.729e3 * t4714 + t4716 / 0.729e3 + 0.7e1 / 0.162e3 * t4752 + t4755 + t4759 / 0.81e2 - t4761 / 0.108e3 - t4763 / 0.54e2 + 0.7e1 / 0.324e3 * t4765 - t4776 / 0.108e3;
  t5069 = t3341 * t252;
  t5072 = t1165 * t662 / 0.54e2;
  t5073 = -t4778 / 0.54e2 - t4782 / 0.27e2 + 0.8e1 / 0.243e3 * t4784 + t4790 / 0.144e3 + t4794 / 0.72e2 + t4796 / 0.144e3 + 0.2e1 / 0.81e2 * t4801 - t4815 / 0.27e2 - 0.5e1 / 0.81e2 * t4819 + 0.2e1 / 0.81e2 * t4822 + 0.2e1 / 0.81e2 * t4825 - 0.4e1 / 0.243e3 * t4833 + 0.7e1 / 0.108e3 * t443 * t1721 - t5069 / 0.216e3 - t5072;
  t5077 = t3335 * t252 / 0.72e2;
  t5083 = t3338 * t252 / 0.72e2;
  t5084 = t1118 * t630;
  t5086 = t5084 * t157 / 0.27e2;
  t5087 = t439 * t1759;
  t5092 = 0.2e1 / 0.81e2 * t1118 * t282 * t644;
  t5109 = t1114 * t630;
  t5112 = -t1162 * t662 / 0.18e2 + t5077 - t1168 * t662 / 0.18e2 + 0.7e1 / 0.54e2 * t1857 * t297 + t5083 - t5086 - t5087 * t157 / 0.9e1 + t5092 - 0.5e1 / 0.27e2 * t1843 * t1733 + 0.2e1 / 0.27e2 * t1114 * t282 * t644 + 0.2e1 / 0.27e2 * t439 * t987 * t644 + 0.8e1 / 0.81e2 * t3319 * t1750 + t3329 * t252 / 0.48e2 + t3332 * t252 / 0.24e2 + t3326 * t252 / 0.48e2 - t5109 * t157 / 0.9e1;
  t5116 = my_piecewise3(t1, 0, t4940 + t4955 + t4982 + t5008 + t5038 + t5053 + t5073 + t5112);
  tv4rho3sigma3 = t6 * t5116 + t1784 + t4907;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5118 = 0.2e1 * t1936;
  t5119 = t3548 * t270;
  t5121 = t1234 * t713;
  t5122 = t5121 * t221;
  t5124 = t3558 * t270;
  t5126 = t1235 * t735;
  t5133 = t1231 * t735 / 0.18e2;
  t5134 = t1230 * t713;
  t5136 = t5134 * t221 / 0.9e1;
  t5138 = t3554 * t270 / 0.24e2;
  t5140 = t3561 * t270 / 0.24e2;
  t5141 = t1226 * t713;
  t5146 = -t5119 / 0.72e2 + t5122 / 0.27e2 - t5124 / 0.72e2 + t5126 / 0.54e2 + t3572 * t270 / 0.16e2 - t1227 * t735 / 0.12e2 - t5133 - t5136 + t5138 + t5140 - t5141 * t221 / 0.6e1 + t3569 * t270 / 0.16e2;
  t5150 = t461 * t673 / 0.4e1;
  t5152 = t168 * t1906 / 0.4e1;
  t5157 = t194 * t1792;
  t5161 = t74 * t369 * t708 * t100;
  t5165 = t3585 * t742;
  t5167 = t4890 / 0.48e2 - t4892 / 0.36e2 + t4895 - t5150 - t5152 - 0.3e1 / 0.8e1 * t1209 * t267 - 0.3e1 / 0.8e1 * t410 * t710 + t5157 / 0.12e2 + t5161 / 0.12e2 - t4880 / 0.8e1 + t4882 / 0.6e1 - t4887 - t5165 / 0.2187e4;
  t5169 = t3588 * t732;
  t5172 = 0.2e1 / 0.243e3 * t3603 * t732;
  t5173 = t3582 * t742;
  t5176 = 0.2e1 / 0.729e3 * t3578 * t742;
  t5178 = t3600 * t742 / 0.729e3;
  t5187 = t3678 * t273;
  t5189 = t1244 * t745;
  t5191 = -0.2e1 / 0.729e3 * t5169 + t5172 - 0.2e1 / 0.2187e4 * t5173 + t5176 + t5178 + t3591 * t732 / 0.81e2 + t3594 * t742 / 0.243e3 + t3597 * t742 / 0.486e3 + t4898 / 0.144e3 - t4900 / 0.108e3 + t4903 - t5187 / 0.216e3 + t5189 / 0.162e3;
  t5192 = t1234 * t717;
  t5193 = t5192 * t229;
  t5196 = t1234 * t529 * t729;
  t5198 = t1230 * t717;
  t5200 = t5198 * t229 / 0.27e2;
  t5201 = t3681 * t273;
  t5204 = t3692 * t273 / 0.72e2;
  t5206 = t3695 * t273 / 0.72e2;
  t5208 = t1241 * t745 / 0.54e2;
  t5211 = 0.2e1 / 0.81e2 * t1230 * t529 * t729;
  t5218 = t1226 * t717;
  t5224 = t5193 / 0.81e2 - 0.2e1 / 0.243e3 * t5196 - t5200 - t5201 / 0.216e3 + t5204 + t5206 - t5208 + t5211 + t3686 * t273 / 0.48e2 + t3689 * t273 / 0.48e2 - t1238 * t745 / 0.36e2 - t5218 * t229 / 0.18e2 + t1226 * t529 * t729 / 0.27e2;
  t5227 = my_piecewise3(t65, 0, t5146 + t5167 + t5191 + t5224);
  tv4rho3sigma5 = t6 * t5227 + t1808 + t5118;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5233 = t1272 * t626;
  t5236 = t3437 * t249;
  t5243 = t3433 * t249 / 0.16e2 + t3440 * t249 / 0.16e2 - t5233 * t149 / 0.6e1 + t5236 / 0.48e2 - t1273 * t650 / 0.12e2 + t4921 + t4923 - t4930 - t4933 / 0.36e2 - t4936 - t4401 / 0.72e2 - t4407 / 0.72e2;
  t5252 = t503 * t608;
  t5257 = t4419 / 0.27e2 + t4459 + t4460 / 0.54e2 - 0.2e1 / 0.2187e4 * t4520 - t4522 / 0.2187e4 - 0.3e1 / 0.8e1 * t1265 * t246 - 0.3e1 / 0.8e1 * t503 * t623 - t5252 / 0.8e1 - t4977 - t4979 + t4985 / 0.6e1 + t4614 / 0.12e2 + t4618 / 0.12e2;
  t5266 = t3535 * t252;
  t5270 = t1272 * t630;
  t5279 = -t4638 + t1272 * t282 * t644 / 0.27e2 + t3541 * t252 / 0.48e2 + t3538 * t252 / 0.48e2 + t5266 / 0.144e3 - t1276 * t662 / 0.36e2 - t5270 * t157 / 0.18e2 + t3455 * t659 / 0.243e3 + t3458 * t659 / 0.486e3 + t3451 * t647 / 0.81e2 + t4993 + t4995 + t5015;
  t5287 = -0.2e1 / 0.729e3 * t4684 + t4755 + t4759 / 0.162e3 - t4761 / 0.216e3 - t4776 / 0.216e3 + t4822 / 0.81e2 - 0.2e1 / 0.243e3 * t4833 - t5069 / 0.108e3 - t5072 + t5077 + t5083 - t5086 + t5092;
  t5290 = my_piecewise3(t1, 0, t5243 + t5257 + t5279 + t5287);
  tv4rho3sigma6 = t6 * t5290 + t1949 + t4907;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5292 = t3762 * t270;
  t5294 = t1295 * t713;
  t5295 = t5294 * t221;
  t5297 = t1894 * t598;
  t5299 = t477 * t1952;
  t5300 = t5299 * t221;
  t5302 = t3756 * t270;
  t5304 = t3759 * t270;
  t5312 = t1291 * t713;
  t5323 = t473 * t1952;
  t5326 = t5292 / 0.48e2 - t5295 / 0.9e1 + 0.7e1 / 0.54e2 * t5297 - t5300 / 0.9e1 + t5302 / 0.48e2 + t5304 / 0.24e2 + t3775 * t270 / 0.16e2 + t3778 * t270 / 0.8e1 + t3767 * t270 / 0.16e2 - t5312 * t221 / 0.3e1 + 0.7e1 / 0.36e2 * t474 * t1968 - t1292 * t735 / 0.6e1 - t1286 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t1870 * t598 - t5323 * t221 / 0.3e1;
  t5338 = t194 * t1906;
  t5342 = t74 * t117 * t2063 * t100;
  t5344 = -t5119 / 0.36e2 + 0.2e1 / 0.27e2 * t5122 - t5124 / 0.36e2 + t5126 / 0.27e2 - t5133 - t5136 + t5138 + t5140 - t4892 / 0.72e2 + t4895 - 0.3e1 / 0.8e1 * t168 * t2065 - 0.3e1 / 0.8e1 * t1327 * t267 - 0.3e1 / 0.4e1 * t461 * t710 - t5338 / 0.4e1 - t5342 / 0.8e1;
  t5346 = t550 * t673;
  t5359 = t1291 * t717;
  t5370 = -t5346 / 0.8e1 - t5150 - t5152 + t5157 / 0.6e1 + t5161 / 0.6e1 + t4882 / 0.12e2 - t4887 + 0.2e1 / 0.27e2 * t1291 * t529 * t729 + 0.2e1 / 0.27e2 * t473 * t1546 * t729 + 0.8e1 / 0.81e2 * t3982 * t2086 - t5359 * t229 / 0.9e1 - t1351 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t1921 * t2106 - t1348 * t745 / 0.18e2 + 0.7e1 / 0.54e2 * t1930 * t523;
  t5379 = t477 * t2092;
  t5380 = t5379 * t229;
  t5383 = t477 * t1546 * t729;
  t5385 = t3962 * t2086;
  t5387 = t1295 * t717;
  t5388 = t5387 * t229;
  t5390 = t3965 * t273;
  t5392 = t3968 * t273;
  t5394 = t3971 * t273;
  t5397 = t1295 * t529 * t729;
  t5399 = t1913 * t523;
  t5401 = t1916 * t2106;
  t5403 = t1338 * t745;
  t5405 = t1341 * t745;
  t5407 = t3985 * t273 / 0.48e2 + t3988 * t273 / 0.24e2 + 0.7e1 / 0.108e3 * t481 * t2101 + t3991 * t273 / 0.48e2 - t5380 / 0.27e2 + 0.2e1 / 0.81e2 * t5383 + 0.8e1 / 0.243e3 * t5385 - t5388 / 0.27e2 + t5390 / 0.144e3 + t5392 / 0.72e2 + t5394 / 0.144e3 + 0.2e1 / 0.81e2 * t5397 + 0.7e1 / 0.162e3 * t5399 - 0.5e1 / 0.81e2 * t5401 - t5403 / 0.54e2 - t5405 / 0.54e2;
  t5410 = t484 * t2101;
  t5412 = t473 * t2092;
  t5415 = t1361 * t2020;
  t5417 = t1367 * t1990;
  t5419 = t3825 * t732;
  t5421 = t477 * t2016;
  t5422 = t5421 * t537;
  t5424 = t3839 * t742;
  t5426 = t3836 * t732;
  t5428 = t3871 * t1999;
  t5430 = t3866 * t2004;
  t5432 = t1367 * t2004;
  t5434 = t3842 * t742;
  t5436 = t3833 * t742;
  t5438 = t1364 * t2020;
  t5440 = t1364 * t2028;
  t5442 = 0.7e1 / 0.324e3 * t5410 - t5412 * t229 / 0.9e1 - 0.5e1 / 0.729e3 * t5415 - 0.5e1 / 0.243e3 * t5417 + 0.2e1 / 0.243e3 * t5419 - 0.8e1 / 0.243e3 * t5422 + 0.2e1 / 0.729e3 * t5424 + 0.2e1 / 0.243e3 * t5426 + 0.8e1 / 0.729e3 * t5428 + 0.8e1 / 0.2187e4 * t5430 + 0.4e1 / 0.2187e4 * t5432 + 0.2e1 / 0.729e3 * t5434 + t5436 / 0.729e3 - 0.5e1 / 0.1458e4 * t5438 + 0.8e1 / 0.19683e5 * t5440;
  t5443 = t3830 * t742;
  t5445 = t3859 * t2028;
  t5447 = t1361 * t2028;
  t5473 = t5443 / 0.729e3 + 0.8e1 / 0.6561e4 * t5445 + 0.8e1 / 0.6561e4 * t5447 + 0.8e1 / 0.243e3 * t3894 * t1999 + 0.8e1 / 0.729e3 * t3897 * t2004 + 0.4e1 / 0.729e3 * t1370 * t2004 - 0.5e1 / 0.486e3 * t1376 * t2020 + 0.8e1 / 0.6561e4 * t1376 * t2028 + t3812 * t742 / 0.243e3 + 0.2e1 / 0.243e3 * t3809 * t742 + 0.8e1 / 0.2187e4 * t3881 * t2028 + 0.8e1 / 0.2187e4 * t1373 * t2028 - 0.5e1 / 0.243e3 * t1373 * t2020 - 0.5e1 / 0.81e2 * t1370 * t1990 + 0.2e1 / 0.243e3 * t3804 * t742;
  t5479 = t473 * t2016;
  t5487 = t477 * t1977;
  t5488 = t5487 * t574;
  t5490 = t477 * t1981;
  t5491 = t5490 * t583;
  t5493 = t473 * t1981;
  t5496 = t473 * t1985;
  t5499 = t473 * t1977;
  t5502 = 0.2e1 / 0.81e2 * t3818 * t732 + 0.2e1 / 0.81e2 * t3795 * t732 - 0.8e1 / 0.81e2 * t5479 * t537 + t3815 * t742 / 0.243e3 - 0.2e1 / 0.2187e4 * t5165 - 0.4e1 / 0.729e3 * t5169 + t5172 - 0.4e1 / 0.2187e4 * t5173 + t5176 + t5178 - 0.8e1 / 0.729e3 * t5488 - 0.8e1 / 0.2187e4 * t5491 - 0.8e1 / 0.729e3 * t5493 * t583 - 0.4e1 / 0.729e3 * t5496 * t583 - 0.8e1 / 0.243e3 * t5499 * t574;
  t5503 = t477 * t1985;
  t5504 = t5503 * t583;
  t5506 = t1296 * t735;
  t5508 = t1299 * t735;
  t5510 = t478 * t1968;
  t5518 = -0.4e1 / 0.2187e4 * t5504 - t5506 / 0.18e2 - t5508 / 0.18e2 + 0.7e1 / 0.108e3 * t5510 - t4900 / 0.216e3 + t4903 - t5187 / 0.108e3 + t5189 / 0.81e2 + 0.2e1 / 0.81e2 * t5193 - 0.4e1 / 0.243e3 * t5196 - t5200 - t5201 / 0.108e3 + t5204 + t5206 - t5208 + t5211;
  t5522 = my_piecewise3(t65, 0, t5326 + t5344 + t5370 + t5407 + t5442 + t5473 + t5502 + t5518);
  tv4rho3sigma8 = t6 * t5522 + t2114 + t5118;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5537 = -0.3e1 / 0.8e1 * t1398 * t246 - 0.3e1 / 0.8e1 * t5252 + t4985 / 0.4e1 - t4638 + t3737 * t249 / 0.16e2 + t5236 / 0.16e2 - t4933 / 0.24e2 + t4459 + t3740 * t252 / 0.48e2 + t5266 / 0.48e2 - t5069 / 0.72e2 + t4755;
  t5538 = my_piecewise3(t1, 0, t5537);
  tv4rho3sigma9 = t6 * t5538 + 0.3e1 * t1949;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5552 = t30 * t1451;
  t5555 = t260 * t1406;
  t5556 = t5555 * t206;
  t5566 = 0.1e1 / t77 / t4143;
  t5589 = t4895 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t5552 - 0.14e3 / 0.729e3 * t130 * t5556 + 0.952e3 / 0.6561e4 * t330 * t5552 * t562 - 0.704e3 / 0.19683e5 * t893 * t1464 * t2060 + 0.256e3 / 0.531441e6 * t2986 * t5566 * t4184 * sigma[2] * t41 * t43) * t100 - 0.3e1 / 0.8e1 * t1441 * t267 - 0.9e1 / 0.8e1 * t550 * t710 - 0.9e1 / 0.8e1 * t194 * t2065 - 0.3e1 / 0.4e1 * t5338 - 0.3e1 / 0.8e1 * t5342 - 0.3e1 / 0.8e1 * t5346 + t5157 / 0.4e1 + t5161 / 0.4e1 - t4887;
  t5614 = t215 * t265 * t1485;
  t5617 = 0.7e1 / 0.36e2 * t591 * t2101 + 0.7e1 / 0.36e2 * t595 * t2101 - t1497 * t745 / 0.6e1 - t1501 * t745 / 0.12e2 - 0.5e1 / 0.9e1 * t2079 * t2106 - 0.5e1 / 0.9e1 * t2082 * t2106 - 0.88e2 / 0.81e2 * t1487 * t99 * t1464 * t2027 - t1494 * t745 / 0.12e2 + 0.7e1 / 0.18e2 * t2089 * t523 + 0.7e1 / 0.18e2 * t2093 * t523 - 0.64e2 / 0.243e3 * t5614 * t1491;
  t5633 = M_PI * sigma[2] * t43;
  t5637 = t1418 * t717;
  t5640 = t509 * t2092;
  t5644 = t215 * t2063 * t98;
  t5651 = -0.35e2 / 0.81e2 * t718 * t1509 + 0.238e3 / 0.243e3 * t725 * t726 * t1552 - 0.35e2 / 0.162e3 * t225 * t228 * t5556 + t215 * t4207 * t729 / 0.9e1 + 0.8e1 / 0.27e2 * t4386 * t2086 + 0.128e3 / 0.729e3 * t4354 * t99 * t5566 * t5633 - t5637 * t229 / 0.6e1 - t5640 * t229 / 0.3e1 - t5644 * t229 / 0.6e1 + t4364 * t273 / 0.48e2 + t4367 * t273 / 0.16e2;
  t5682 = t1489 * t2003;
  t5685 = t1467 * t2027;
  t5688 = t5392 / 0.24e2 + t5394 / 0.48e2 + 0.2e1 / 0.27e2 * t5397 + 0.7e1 / 0.54e2 * t5399 - 0.5e1 / 0.27e2 * t5401 - t5403 / 0.18e2 - t5405 / 0.18e2 + 0.7e1 / 0.108e3 * t5410 + 0.56e2 / 0.81e2 * t2017 * t1553 - 0.88e2 / 0.729e3 * t1522 * t5682 - 0.88e2 / 0.2187e4 * t580 * t5685;
  t5695 = t5566 * t1466 * t5633;
  t5699 = t5566 * t4184 * t5633;
  t5717 = -0.88e2 / 0.2187e4 * t1532 * t5685 + 0.8e1 / 0.729e3 * t4157 * t2028 + 0.128e3 / 0.19683e5 * t4243 * t5695 + 0.128e3 / 0.59049e5 * t4182 * t5699 + 0.64e2 / 0.19683e5 * t1532 * t5699 + 0.8e1 / 0.729e3 * t1556 * t2028 + 0.8e1 / 0.729e3 * t1560 * t2028 + 0.128e3 / 0.19683e5 * t1522 * t5695 + 0.352e3 / 0.177147e6 * t580 * t5699 + 0.238e3 / 0.729e3 * t572 * t5552 * t573 + t4106 * t742 / 0.81e2;
  t5724 = t5552 * t582;
  t5741 = 0.8e1 / 0.243e3 * t4239 * t2004 + t4096 * t742 / 0.162e3 + 0.4e1 / 0.243e3 * t1574 * t2004 + 0.238e3 / 0.2187e4 * t580 * t5724 + 0.119e3 / 0.2187e4 * t587 * t5724 - 0.5e1 / 0.162e3 * t1563 * t2020 - 0.5e1 / 0.162e3 * t1567 * t2020 - 0.44e2 / 0.729e3 * t572 * t5682 - 0.88e2 / 0.6561e4 * t587 * t5685 + 0.8e1 / 0.2187e4 * t1563 * t2028 + 0.8e1 / 0.2187e4 * t1567 * t2028;
  t5759 = t509 * t2016;
  t5762 = t708 * t528;
  t5764 = t215 * t5762 * t99;
  t5768 = t215 * t2015 * t227;
  t5789 = t5566 * M_PI;
  t5797 = t5789 * sigma[2] * t562 * t43;
  t5802 = -0.5e1 / 0.27e2 * t1570 * t1990 - 0.5e1 / 0.81e2 * t1556 * t2020 + t4099 * t742 / 0.81e2 + t4125 * t732 / 0.27e2 + 0.2e1 / 0.27e2 * t4073 * t732 - 0.88e2 / 0.243e3 * t1515 * t1489 * t1998 + 0.8e1 / 0.81e2 * t4212 * t1999 + 0.8e1 / 0.81e2 * t4216 * t1999 + 0.128e3 / 0.2187e4 * t4220 * t5789 * sigma[2] * t206 * t43 + 0.128e3 / 0.6561e4 * t4227 * t5797 + 0.64e2 / 0.6561e4 * t1515 * t5797;
  t5813 = t215 * t713 * t578;
  t5819 = t215 * t717 * t1530;
  t5828 = 0.8e1 / 0.243e3 * t4235 * t2004 - 0.5e1 / 0.27e2 * t1574 * t1990 - 0.5e1 / 0.81e2 * t1560 * t2020 + 0.2e1 / 0.81e2 * t4102 * t742 - 0.64e2 / 0.2187e4 * t5813 * t1524 - 0.32e2 / 0.2187e4 * t1978 * t1524 - 0.64e2 / 0.6561e4 * t5819 * t1535 - 0.64e2 / 0.6561e4 * t1982 * t1535 - 0.64e2 / 0.19683e5 * t1986 * t1535 - 0.5e1 / 0.243e3 * t5415 - 0.5e1 / 0.81e2 * t5417;
  t5840 = 0.2e1 / 0.81e2 * t5419 - 0.8e1 / 0.81e2 * t5422 + 0.2e1 / 0.243e3 * t5424 + 0.2e1 / 0.81e2 * t5426 + 0.8e1 / 0.243e3 * t5428 + 0.8e1 / 0.729e3 * t5430 + 0.4e1 / 0.729e3 * t5432 + 0.2e1 / 0.243e3 * t5434 + t5436 / 0.243e3 - 0.5e1 / 0.486e3 * t5438 + 0.8e1 / 0.6561e4 * t5440;
  t5849 = t509 * t1977;
  t5852 = t509 * t1981;
  t5855 = t509 * t1985;
  t5859 = t215 * t1952 * t227;
  t5864 = t215 * t2092 * t578;
  t5868 = t215 * t2092 * t227;
  t5883 = -0.8e1 / 0.243e3 * t5864 * t583 - 0.4e1 / 0.243e3 * t5868 * t583 + 0.56e2 / 0.243e3 * t1978 * t1577 + 0.56e2 / 0.729e3 * t1982 * t1580 + 0.28e2 / 0.729e3 * t1986 * t1580 - 0.8e1 / 0.243e3 * t5488 - 0.8e1 / 0.729e3 * t5491 - 0.4e1 / 0.729e3 * t5504 - t5506 / 0.6e1 - t5508 / 0.6e1 + 0.7e1 / 0.36e2 * t5510;
  t5890 = t509 * t1952;
  t5893 = t215 * t2063 * t217;
  t5904 = t1418 * t713;
  t5911 = -0.35e2 / 0.27e2 * t714 * t1408 - 0.35e2 / 0.54e2 * t219 * t220 * t5555 - t5890 * t221 - t5893 * t221 / 0.2e1 + t4052 * t270 / 0.16e2 + 0.3e1 / 0.16e2 * t4055 * t270 + 0.3e1 / 0.16e2 * t4058 * t270 + t4062 * t270 / 0.16e2 - t5904 * t221 / 0.2e1 + 0.7e1 / 0.12e2 * t510 * t1968 + 0.7e1 / 0.12e2 * t514 * t1968;
  t5927 = -t1419 * t735 / 0.4e1 - t1422 * t735 / 0.2e1 - t1425 * t735 / 0.4e1 + 0.7e1 / 0.6e1 * t1962 * t598 + 0.7e1 / 0.6e1 * t1953 * t598 + t4903 - t5187 / 0.72e2 + t5189 / 0.54e2 + t5193 / 0.27e2 - 0.2e1 / 0.81e2 * t5196 - t5201 / 0.72e2;
  t5932 = my_piecewise3(t65, 0, t4077 * t732 / 0.27e2 - 0.8e1 / 0.27e2 * t5759 * t537 - 0.8e1 / 0.27e2 * t5764 * t537 - 0.64e2 / 0.729e3 * t5768 * t1518 - 0.8e1 / 0.81e2 * t5849 * t574 - 0.8e1 / 0.243e3 * t5852 * t583 - 0.4e1 / 0.243e3 * t5855 * t583 - 0.8e1 / 0.81e2 * t5859 * t574 + t4370 * t273 / 0.16e2 + t4374 * t273 / 0.48e2 + 0.8e1 / 0.27e2 * t4382 * t2086 + 0.128e3 / 0.59049e5 * t572 * t5695 + 0.32e2 / 0.59049e5 * t587 * t5699 + t4111 * t742 / 0.162e3 + t4092 * t742 / 0.81e2 + 0.4e1 / 0.243e3 * t1570 * t2004 + 0.8e1 / 0.729e3 * t4153 * t2028 + t5883 + t5840 + t5828 + t5802 - t5380 / 0.9e1 - 0.2e1 / 0.729e3 * t5173 - 0.2e1 / 0.243e3 * t5169 - t5165 / 0.729e3 + t5741 + t5717 + t5688 - t5124 / 0.24e2 + t5126 / 0.18e2 - t5388 / 0.9e1 + t5390 / 0.48e2 - t5119 / 0.24e2 + t5122 / 0.9e1 + 0.2e1 / 0.27e2 * t5383 + 0.8e1 / 0.81e2 * t5385 + t5927 + t5911 + t5651 + t5617 + t5589 + t5302 / 0.16e2 + t5304 / 0.8e1 + 0.7e1 / 0.18e2 * t5297 - t5300 / 0.3e1 + t5292 / 0.16e2 - t5295 / 0.3e1 + 0.8e1 / 0.2187e4 * t5445 + 0.8e1 / 0.2187e4 * t5447 + t5443 / 0.243e3 + t1418 * t529 * t729 / 0.9e1 + 0.2e1 / 0.9e1 * t509 * t1546 * t729);
  tv4rho3sigma11 = t6 * t5932 + 0.3e1 * t2114;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5935 = t754 * t294;
  t5936 = t5935 * t134;
  t5946 = 0.1e1 / t33 / t895;
  t5958 = t26 * t369 * t764 * t60 / 0.12e2;
  t5959 = t113 * t2201;
  t5963 = t26 * t117 * t2218 * t60;
  t5977 = t4472 * t647;
  t5979 = t4491 * t659;
  t5981 = t4488 * t659;
  t5997 = -0.3e1 / 0.8e1 * t26 * t27 * (-0.7e1 / 0.243e3 * t130 * t5936 - 0.14e2 / 0.2187e4 * t331 * t759 * t287 * t334 + 0.152e3 / 0.19683e5 * t2214 * t1638 - 0.32e2 / 0.177147e6 * t2986 * t5946 * t2990) * t60 + t5958 - t5959 / 0.4e1 - t5963 / 0.4e1 - 0.3e1 / 0.8e1 * t315 * t766 - 0.3e1 / 0.4e1 * t113 * t2220 - t2759 * t776 / 0.72e2 - t2762 * t776 / 0.36e2 - 0.2e1 / 0.2187e4 * t1033 * t2173 - 0.2e1 / 0.2187e4 * t1037 * t2173 + 0.4e1 / 0.243e3 * t5977 + 0.4e1 / 0.729e3 * t5979 + 0.2e1 / 0.729e3 * t5981 - 0.2e1 / 0.729e3 * t1056 * t2173 - 0.2e1 / 0.729e3 * t1060 * t2173 - 0.2e1 / 0.729e3 * t2829 * t2173 - 0.2e1 / 0.729e3 * t2833 * t2173 + 0.4e1 / 0.81e2 * t4506 * t647 + 0.4e1 / 0.81e2 * t4476 * t647 + 0.16e2 / 0.243e3 * t4584 * t1614;
  t6022 = t239 * t1610;
  t6026 = t2872 * t776;
  t6028 = t1043 * t2173;
  t6030 = t6022 * t1005;
  t6033 = t1049 * t2173;
  t6037 = t764 * t281;
  t6039 = t143 * t6037 * t59;
  t6042 = t1025 * t2168;
  t6044 = -0.1e2 / 0.81e2 * t1770 * t1633 - 0.1e2 / 0.243e3 * t1774 * t1630 - 0.5e1 / 0.243e3 * t1778 * t1630 + 0.4e1 / 0.243e3 * t4494 * t659 + 0.4e1 / 0.243e3 * t4481 * t659 + 0.16e2 / 0.729e3 * t4560 * t1619 + 0.16e2 / 0.2187e4 * t4566 * t1640 + 0.16e2 / 0.2187e4 * t1774 * t1640 + 0.2e1 / 0.243e3 * t4497 * t659 + 0.2e1 / 0.243e3 * t4485 * t659 + 0.8e1 / 0.729e3 * t1770 * t1619 + 0.16e2 / 0.6561e4 * t1778 * t1640 + 0.19e2 / 0.243e3 * t993 * t6022 * t995 - t6026 / 0.108e3 - 0.2e1 / 0.6561e4 * t6028 + 0.19e2 / 0.6561e4 * t344 * t6030 - 0.2e1 / 0.2187e4 * t6033 + 0.19e2 / 0.2187e4 * t359 * t6030 - 0.8e1 / 0.81e2 * t6039 * t290 + t6042 / 0.81e2;
  t6064 = t2784 * t776 / 0.324e3;
  t6065 = t2778 * t2191;
  t6067 = t6022 * t1000;
  t6070 = t1046 * t2191;
  t6074 = t2781 * t2173;
  t6080 = t2787 * t776;
  t6084 = t2775 * t2188;
  t6088 = -0.7e1 / 0.162e3 * t284 * t773 * t289 - 0.2e1 / 0.81e2 * t2842 * t2188 - t2869 * t776 / 0.72e2 - 0.2e1 / 0.81e2 * t2766 * t2188 - 0.2e1 / 0.243e3 * t2815 * t2191 - 0.2e1 / 0.243e3 * t2819 * t2191 - t1040 * t2191 / 0.243e3 - t1053 * t2191 / 0.243e3 + t6064 - 0.2e1 / 0.729e3 * t6065 + 0.19e2 / 0.729e3 * t1012 * t6067 - t6070 / 0.729e3 + 0.19e2 / 0.1458e4 * t351 * t6067 - 0.2e1 / 0.2187e4 * t6074 + 0.19e2 / 0.2187e4 * t1018 * t6030 + t1021 * t2168 / 0.27e2 - t6080 / 0.108e3 + t989 * t2168 / 0.27e2 - 0.2e1 / 0.243e3 * t6084 + t389 * t2225 / 0.36e2;
  t6089 = t155 * t5946;
  t6096 = t4814 * t252;
  t6098 = t4781 * t252;
  t6105 = t357 * t5946;
  t6112 = t1016 * t5946;
  t6137 = t981 * t789;
  t6139 = t974 * t789;
  t6144 = t4821 * t252 / 0.108e3;
  t6145 = -0.16e2 / 0.19683e5 * t147 * t6089 * t2825 - 0.4e1 / 0.19683e5 * t153 * t6089 * t2800 + t6096 / 0.36e2 + t6098 / 0.36e2 - 0.2e1 / 0.27e2 * t3038 * t2242 - 0.16e2 / 0.729e3 * t955 * t6089 * t2848 - 0.16e2 / 0.2187e4 * t640 * t6105 * t2855 - 0.8e1 / 0.2187e4 * t640 * t6089 * t2855 - 0.16e2 / 0.6561e4 * t147 * t6112 * t2825 - 0.16e2 / 0.19683e5 * t153 * t2837 * t5946 * t2800 - 0.1e2 / 0.27e2 * t2232 * t1733 + 0.4e1 / 0.27e2 * t364 * t1624 * t644 + 0.4e1 / 0.27e2 * t143 * t4737 * t644 - 0.16e2 / 0.6561e4 * t147 * t6105 * t2825 - 0.8e1 / 0.6561e4 * t153 * t6112 * t2800 - 0.44e2 / 0.59049e5 * t153 * t6105 * t2800 - t6137 / 0.144e3 - t6139 / 0.144e3 + t382 * t2225 / 0.36e2 - t6144;
  t6148 = t1741 * t662;
  t6151 = t984 * t789 / 0.432e3;
  t6154 = t364 * t2249;
  t6158 = t143 * t2218 * t58;
  t6179 = t374 * t2249;
  t6180 = t6179 * t157;
  t6184 = t3011 * t2242;
  t6191 = t374 * t1624 * t644;
  t6195 = -t6148 / 0.27e2 + t6151 - t978 * t789 / 0.96e2 - t6154 * t157 / 0.9e1 - t6158 * t157 / 0.9e1 + 0.16e2 / 0.81e2 * t4804 * t1750 + t4811 * t252 / 0.24e2 + t4843 * t252 / 0.12e2 + t4847 * t252 / 0.24e2 - t966 * t789 / 0.96e2 - t971 * t789 / 0.48e2 - t1738 * t662 / 0.9e1 - t1760 * t662 / 0.9e1 - 0.2e1 / 0.27e2 * t3049 * t2242 - t6180 / 0.27e2 + 0.7e1 / 0.54e2 * t2250 * t297 - 0.2e1 / 0.81e2 * t6184 + 0.19e2 / 0.81e2 * t955 * t2239 * t1611 * t28 + 0.4e1 / 0.81e2 * t6191 + 0.7e1 / 0.54e2 * t631 * t1721;
  t6196 = t385 * t2225;
  t6202 = t2670 * t786 / 0.2916e4;
  t6204 = t2681 * t786 / 0.5832e4;
  t6206 = t2686 * t780 / 0.972e3;
  t6207 = t1049 * t2147;
  t6209 = t1043 * t2147;
  t6211 = t773 * t287;
  t6215 = t6211 * t346;
  t6220 = t1046 * t2141;
  t6231 = t143 * t2126 * t155;
  t6240 = t2691 * t786;
  t6242 = t6196 / 0.108e3 - 0.7e1 / 0.216e3 * t153 * t156 * t5936 + t6202 + t6204 + t6206 + t6207 / 0.729e3 + t6209 / 0.1458e4 - 0.7e1 / 0.486e3 * t351 * t6211 * t352 - 0.7e1 / 0.1458e4 * t359 * t6215 - 0.7e1 / 0.2916e4 * t344 * t6215 + t6220 / 0.243e3 + t1033 * t2147 / 0.486e3 + t1053 * t2141 / 0.81e2 + t1060 * t2147 / 0.243e3 + t1037 * t2147 / 0.486e3 - 0.8e1 / 0.243e3 * t6231 * t353 - t2700 * t786 / 0.648e3 - t2705 * t786 / 0.324e3 - t2755 * t786 / 0.648e3 - t6240 / 0.972e3;
  t6251 = t143 * t2249 * t357;
  t6255 = t143 * t2249 * t155;
  t6258 = t2725 * t786;
  t6260 = t2728 * t786;
  t6262 = t2731 * t780;
  t6264 = t2734 * t780;
  t6266 = t2737 * t786;
  t6279 = t4418 * t249 / 0.36e2;
  t6283 = t854 * t783 / 0.144e3;
  t6284 = t375 * t2121;
  t6289 = -t2744 * t786 / 0.1296e4 - t2747 * t786 / 0.648e3 - t2751 * t786 / 0.1296e4 - 0.8e1 / 0.729e3 * t6251 * t347 - 0.4e1 / 0.729e3 * t6255 * t347 - t6258 / 0.1944e4 - t6260 / 0.1944e4 - t6262 / 0.324e3 - t6264 / 0.324e3 - t6266 / 0.972e3 + t1040 * t2141 / 0.81e2 + t1056 * t2147 / 0.243e3 - t2719 * t780 / 0.216e3 - t2722 * t780 / 0.108e3 - t2695 * t780 / 0.216e3 - t6279 + 0.7e1 / 0.18e2 * t2127 * t392 + t6283 + t6284 / 0.36e2 - 0.7e1 / 0.72e2 * t147 * t148 * t5935;
  t6290 = t1673 * t650;
  t6311 = M_PI * t43;
  t6315 = t865 * t783;
  t6317 = t857 * t783;
  t6323 = t4453 * t249;
  t6325 = t4421 * t249;
  t6327 = t374 * t2126;
  t6328 = t6327 * t149;
  t6330 = t364 * t2126;
  t6334 = t143 * t2218 * t145;
  t6337 = -t6290 / 0.9e1 + 0.7e1 / 0.18e2 * t627 * t1655 + t4413 * t249 / 0.8e1 + t4416 * t249 / 0.4e1 + t4426 * t249 / 0.8e1 - t869 * t783 / 0.32e2 - t872 * t783 / 0.16e2 - t861 * t783 / 0.32e2 - t1670 * t650 / 0.3e1 - t1677 * t650 / 0.3e1 - 0.16e2 / 0.243e3 * t3022 * t59 * t5946 * t6311 - t6315 / 0.48e2 - t6317 / 0.48e2 + t365 * t2121 / 0.12e2 + t379 * t2121 / 0.12e2 + t6323 / 0.12e2 + t6325 / 0.12e2 - t6328 / 0.9e1 - t6330 * t149 / 0.3e1 - t6334 * t149 / 0.3e1;
  t6341 = my_piecewise3(t1, 0, t5997 + t6044 + t6088 + t6145 + t6195 + t6242 + t6289 + t6337);
  tv4rho2sigma20 = t6 * t6341 + 0.2e1 * t2256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6344 = t168 * t2261;
  t6349 = t74 * t369 * t807 * t100 / 0.12e2;
  t6354 = t3609 * t819;
  t6357 = t3612 * t819 / 0.324e3;
  t6358 = t1241 * t832;
  t6361 = t1244 * t832 / 0.432e3;
  t6362 = t5198 * t273;
  t6365 = t5192 * t273 / 0.108e3;
  t6372 = -t6344 / 0.4e1 + t6349 - 0.3e1 / 0.8e1 * t410 * t809 - t3606 * t819 / 0.72e2 - t6354 / 0.108e3 + t6357 - t6358 / 0.144e3 + t6361 + t6362 / 0.36e2 - t6365 - t1238 * t832 / 0.96e2 + t5218 * t273 / 0.24e2 - t3591 * t823 / 0.216e3;
  t6378 = t3585 * t829 / 0.5832e4;
  t6380 = t3582 * t829 / 0.2916e4;
  t6381 = t3600 * t829;
  t6383 = t3603 * t823;
  t6386 = t3588 * t823 / 0.972e3;
  t6387 = t3578 * t829;
  t6390 = t1235 * t826 / 0.144e3;
  t6391 = t5134 * t270;
  t6394 = t5121 * t270 / 0.36e2;
  t6395 = t1231 * t826;
  t6401 = -t3594 * t829 / 0.648e3 - t3597 * t829 / 0.1296e4 + t6378 + t6380 - t6381 / 0.1944e4 - t6383 / 0.324e3 + t6386 - t6387 / 0.972e3 + t6390 + t6391 / 0.12e2 - t6394 - t6395 / 0.48e2 + t5141 * t270 / 0.8e1 - t1227 * t826 / 0.32e2;
  t6403 = my_piecewise3(t65, 0, t6372 + t6401);
  tv4rho2sigma25 = t6 * t6403 + 0.2e1 * t2297;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6405 = t184 * t2201;
  t6425 = -t6405 / 0.8e1 - 0.3e1 / 0.8e1 * t432 * t766 - 0.3e1 / 0.8e1 * t184 * t2220 + t5958 - t5959 / 0.8e1 - t5963 / 0.8e1 - t3235 * t776 / 0.72e2 - t3232 * t776 / 0.72e2 - t3241 * t2188 / 0.81e2 - t3220 * t2191 / 0.243e3 - t1179 * t2191 / 0.486e3 - t3225 * t2173 / 0.729e3;
  t6430 = t3238 * t776;
  t6445 = -t1182 * t2173 / 0.729e3 + 0.2e1 / 0.81e2 * t4958 * t647 - t6430 / 0.216e3 + t1175 * t2168 / 0.54e2 - t1185 * t2173 / 0.2187e4 + 0.2e1 / 0.243e3 * t4961 * t659 + t4964 * t659 / 0.243e3 + 0.2e1 / 0.243e3 * t5977 + 0.2e1 / 0.729e3 * t5979 + t5981 / 0.729e3 - t6026 / 0.216e3 - t6028 / 0.6561e4;
  t6463 = -t6033 / 0.2187e4 + t6042 / 0.162e3 + t6064 - t6065 / 0.729e3 - t6070 / 0.1458e4 - t6074 / 0.2187e4 - t6080 / 0.216e3 - t6084 / 0.243e3 + 0.2e1 / 0.27e2 * t439 * t1624 * t644 + t5109 * t252 / 0.24e2 + t5087 * t252 / 0.24e2 - t3319 * t2242 / 0.27e2;
  t6468 = t439 * t2249;
  t6475 = t1165 * t789;
  t6477 = t5084 * t252;
  t6483 = -t1162 * t789 / 0.96e2 - t1168 * t789 / 0.96e2 - t6468 * t157 / 0.18e2 + t443 * t2225 / 0.72e2 - t1857 * t662 / 0.18e2 - t6475 / 0.288e3 + t6477 / 0.72e2 + t6096 / 0.72e2 + t6098 / 0.72e2 - t6137 / 0.288e3 - t6139 / 0.288e3 - t6144;
  t6493 = t3163 * t786;
  t6497 = t3166 * t786;
  t6499 = t3159 * t780;
  t6503 = -t6148 / 0.54e2 + t6151 - t6180 / 0.54e2 - t6184 / 0.81e2 + 0.2e1 / 0.81e2 * t6191 + t6196 / 0.216e3 + t1179 * t2141 / 0.162e3 - t6493 / 0.1944e4 + t1182 * t2147 / 0.486e3 - t6497 / 0.3888e4 - t6499 / 0.648e3 + t1185 * t2147 / 0.972e3;
  t6519 = -t3169 * t786 / 0.1296e4 - t3172 * t786 / 0.1296e4 - t3192 * t780 / 0.216e3 - t3189 * t780 / 0.216e3 - t3183 * t786 / 0.648e3 - t3186 * t786 / 0.648e3 + t6202 + t6204 + t6206 + t6207 / 0.1458e4 + t6209 / 0.2916e4 + t6220 / 0.486e3;
  t6531 = -t6240 / 0.1944e4 - t6258 / 0.3888e4 - t6260 / 0.3888e4 - t6262 / 0.648e3 - t6264 / 0.648e3 - t6266 / 0.1944e4 - t6279 + t6283 + t6284 / 0.72e2 - t6290 / 0.18e2 - t6315 / 0.96e2 - t6317 / 0.96e2;
  t6537 = t1119 * t783;
  t6541 = t4928 * t249;
  t6543 = t439 * t2126;
  t6554 = t6323 / 0.24e2 + t6325 / 0.24e2 - t6328 / 0.18e2 - t1823 * t650 / 0.6e1 - t6537 / 0.96e2 + t440 * t2121 / 0.24e2 + t6541 / 0.24e2 - t6543 * t149 / 0.6e1 + t4908 * t249 / 0.8e1 + t4911 * t249 / 0.8e1 - t1115 * t783 / 0.32e2 - t1111 * t783 / 0.32e2;
  t6558 = my_piecewise3(t1, 0, t6425 + t6445 + t6463 + t6483 + t6503 + t6519 + t6531 + t6554);
  tv4rho2sigma26 = t6 * t6558 + t2256 + t2318;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6564 = t194 * t2261;
  t6568 = t74 * t117 * t2403 * t100;
  t6583 = -0.3e1 / 0.8e1 * t168 * t2405 - 0.3e1 / 0.8e1 * t461 * t809 - t6564 / 0.8e1 - t6568 / 0.8e1 - t6344 / 0.8e1 + t6349 + 0.2e1 / 0.243e3 * t5493 * t742 + t5496 * t742 / 0.243e3 - t3888 * t819 / 0.72e2 - t3891 * t819 / 0.72e2 - t3894 * t2370 / 0.81e2 - t3897 * t2373 / 0.243e3;
  t6596 = t3866 * t2373;
  t6598 = t1367 * t2373;
  t6600 = t5503 * t742;
  t6602 = t3851 * t819;
  t6604 = t3854 * t819;
  t6606 = t5487 * t732;
  t6608 = -t1370 * t2373 / 0.486e3 - t1373 * t2381 / 0.729e3 - t1376 * t2381 / 0.2187e4 + 0.2e1 / 0.81e2 * t5499 * t732 + t1358 * t2378 / 0.54e2 - t3881 * t2381 / 0.729e3 - t6596 / 0.729e3 - t6598 / 0.1458e4 + t6600 / 0.729e3 - t6602 / 0.216e3 - t6604 / 0.216e3 + 0.2e1 / 0.243e3 * t6606;
  t6610 = t5490 * t742;
  t6612 = t3859 * t2381;
  t6614 = t1361 * t2381;
  t6616 = t1364 * t2381;
  t6618 = t1355 * t2378;
  t6620 = t3871 * t2370;
  t6627 = t473 * t2416;
  t6633 = 0.2e1 / 0.729e3 * t6610 - t6612 / 0.2187e4 - t6614 / 0.2187e4 - t6616 / 0.6561e4 + t6618 / 0.162e3 - t6620 / 0.243e3 - t6354 / 0.216e3 + t6357 + t481 * t2411 / 0.72e2 - t1930 * t745 / 0.18e2 - t6627 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t473 * t2015 * t729;
  t6635 = t477 * t2015 * t729;
  t6637 = t5387 * t273;
  t6639 = t5379 * t273;
  t6641 = t477 * t2416;
  t6642 = t6641 * t229;
  t6644 = t484 * t2411;
  t6646 = t1913 * t745;
  t6648 = t3962 * t2430;
  t6650 = t1338 * t832;
  t6652 = t1341 * t832;
  t6660 = 0.2e1 / 0.81e2 * t6635 + t6637 / 0.72e2 + t6639 / 0.72e2 - t6642 / 0.54e2 + t6644 / 0.216e3 - t6646 / 0.54e2 - t6648 / 0.81e2 - t6650 / 0.288e3 - t6652 / 0.288e3 + t5359 * t273 / 0.24e2 + t5412 * t273 / 0.24e2 - t3982 * t2430 / 0.27e2;
  t6669 = t1367 * t2339;
  t6671 = t1361 * t2342;
  t6673 = t3842 * t829;
  t6675 = t3825 * t823;
  t6677 = t3839 * t829;
  t6679 = t3833 * t829;
  t6681 = -t1348 * t832 / 0.96e2 - t1351 * t832 / 0.96e2 - t6358 / 0.288e3 + t6361 + t6362 / 0.72e2 - t6365 + t6669 / 0.486e3 + t6671 / 0.1458e4 - t6673 / 0.1944e4 - t6675 / 0.648e3 - t6677 / 0.1944e4 - t6679 / 0.3888e4;
  t6682 = t3836 * t823;
  t6684 = t1364 * t2342;
  t6686 = t3830 * t829;
  t6706 = -t6682 / 0.648e3 + t6684 / 0.2916e4 - t6686 / 0.3888e4 - t3809 * t829 / 0.648e3 - t3815 * t829 / 0.1296e4 - t3818 * t823 / 0.216e3 - t3795 * t823 / 0.216e3 - t3804 * t829 / 0.648e3 + t1376 * t2342 / 0.972e3 - t3812 * t829 / 0.1296e4 + t1370 * t2339 / 0.162e3 + t1373 * t2342 / 0.486e3;
  t6713 = t5294 * t270;
  t6715 = t5299 * t270;
  t6717 = t6378 + t6380 - t6381 / 0.3888e4 - t6383 / 0.648e3 + t6386 - t6387 / 0.1944e4 + t6390 + t6391 / 0.24e2 - t6394 - t6395 / 0.96e2 + t6713 / 0.24e2 + t6715 / 0.24e2;
  t6718 = t1296 * t826;
  t6720 = t1299 * t826;
  t6722 = t478 * t2323;
  t6724 = t477 * t2326;
  t6725 = t6724 * t221;
  t6727 = t1894 * t735;
  t6733 = t473 * t2326;
  t6744 = -t6718 / 0.96e2 - t6720 / 0.96e2 + t6722 / 0.72e2 - t6725 / 0.18e2 - t6727 / 0.18e2 - t1870 * t735 / 0.6e1 + t474 * t2323 / 0.24e2 - t6733 * t221 / 0.6e1 + t5312 * t270 / 0.8e1 + t5323 * t270 / 0.8e1 - t1292 * t826 / 0.32e2 - t1286 * t826 / 0.32e2;
  t6748 = my_piecewise3(t65, 0, t6583 + t6608 + t6633 + t6660 + t6681 + t6706 + t6717 + t6744);
  tv4rho2sigma211 = t6 * t6748 + t2297 + t2440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6765 = -t6405 / 0.4e1 + t5958 - t3467 * t776 / 0.72e2 - t6430 / 0.108e3 + t6064 - t1276 * t789 / 0.96e2 + t5270 * t252 / 0.24e2 - t6475 / 0.144e3 + t6477 / 0.36e2 - t6144 + t6151 - t3451 * t780 / 0.216e3 - t3455 * t786 / 0.648e3;
  t6779 = -t3458 * t786 / 0.1296e4 - t6493 / 0.972e3 - t6497 / 0.1944e4 - t6499 / 0.324e3 + t6202 + t6204 + t6206 - 0.3e1 / 0.8e1 * t503 * t766 - t6279 + t6283 - t6537 / 0.48e2 + t6541 / 0.12e2 - t1273 * t783 / 0.32e2 + t5233 * t249 / 0.8e1;
  t6781 = my_piecewise3(t1, 0, t6765 + t6779);
  tv4rho2sigma212 = t6 * t6781 + 0.2e1 * t2318;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6787 = 0.1e1 / t77 / t1463;
  t6788 = t227 * t6787;
  t6807 = t578 * t6787;
  t6814 = t509 * t2416;
  t6818 = t215 * t2403 * t98;
  t6825 = t1530 * t6787;
  t6839 = -t6564 / 0.4e1 - t6568 / 0.4e1 + t6349 - 0.4e1 / 0.19683e5 * t225 * t6788 * t4186 - t1494 * t832 / 0.96e2 - t1497 * t832 / 0.48e2 - t2089 * t745 / 0.9e1 - t2093 * t745 / 0.9e1 - 0.2e1 / 0.27e2 * t4382 * t2430 - 0.2e1 / 0.27e2 * t4386 * t2430 - 0.16e2 / 0.729e3 * t1487 * t6788 * t4222 - 0.16e2 / 0.2187e4 * t725 * t6807 * t4229 - 0.8e1 / 0.2187e4 * t725 * t6788 * t4229 - t6814 * t229 / 0.9e1 - t6818 * t229 / 0.9e1 + 0.19e2 / 0.81e2 * t1487 * t2427 * t1996 * t28 - 0.16e2 / 0.6561e4 * t219 * t6825 * t4149 - 0.16e2 / 0.19683e5 * t225 * t4180 * t6787 * t4186 - 0.8e1 / 0.6561e4 * t225 * t6825 * t4186 - 0.16e2 / 0.6561e4 * t219 * t6807 * t4149;
  t6850 = t260 * t1995;
  t6851 = t6850 * t1534;
  t6885 = -0.44e2 / 0.59049e5 * t225 * t6807 * t4186 + t591 * t2411 / 0.36e2 + t595 * t2411 / 0.36e2 - 0.16e2 / 0.19683e5 * t219 * t6788 * t4149 + 0.19e2 / 0.6561e4 * t587 * t6851 - t1570 * t2373 / 0.243e3 - 0.2e1 / 0.729e3 * t1556 * t2381 - 0.2e1 / 0.2187e4 * t1563 * t2381 - t1574 * t2373 / 0.243e3 - 0.2e1 / 0.729e3 * t1560 * t2381 - 0.2e1 / 0.2187e4 * t1567 * t2381 + t1542 * t2378 / 0.27e2 + t1548 * t2378 / 0.27e2 + 0.19e2 / 0.243e3 * t1515 * t6850 * t1517 - 0.2e1 / 0.81e2 * t4212 * t2370 - 0.2e1 / 0.243e3 * t4235 * t2373 - 0.2e1 / 0.81e2 * t4216 * t2370 - 0.2e1 / 0.243e3 * t4239 * t2373 - t4160 * t819 / 0.72e2 - t4163 * t819 / 0.36e2;
  t6919 = t6850 * t1523;
  t6928 = -t4209 * t819 / 0.72e2 + 0.4e1 / 0.81e2 * t5849 * t732 + 0.4e1 / 0.81e2 * t5859 * t732 + 0.16e2 / 0.243e3 * t5768 * t1999 + 0.16e2 / 0.729e3 * t5813 * t2004 + 0.8e1 / 0.729e3 * t1978 * t2004 - 0.1e2 / 0.243e3 * t1982 * t2020 - 0.5e1 / 0.243e3 * t1986 * t2020 + 0.4e1 / 0.243e3 * t5852 * t742 + 0.4e1 / 0.243e3 * t5864 * t742 + 0.16e2 / 0.2187e4 * t5819 * t2028 + 0.16e2 / 0.2187e4 * t1982 * t2028 + 0.2e1 / 0.243e3 * t5855 * t742 + 0.2e1 / 0.243e3 * t5868 * t742 - 0.2e1 / 0.729e3 * t4153 * t2381 - 0.2e1 / 0.729e3 * t4157 * t2381 + 0.19e2 / 0.1458e4 * t572 * t6919 + 0.19e2 / 0.2187e4 * t580 * t6851 + 0.19e2 / 0.729e3 * t1522 * t6919 - 0.1e2 / 0.81e2 * t1978 * t1990;
  t6934 = t807 * t528;
  t6936 = t215 * t6934 * t99;
  t6957 = t797 * t520;
  t6958 = t6957 * t206;
  t6962 = 0.19e2 / 0.2187e4 * t1532 * t6851 - 0.7e1 / 0.162e3 * t531 * t816 * t536 - 0.8e1 / 0.81e2 * t6936 * t537 + 0.16e2 / 0.6561e4 * t1986 * t2028 - 0.2e1 / 0.729e3 * t6596 - t6598 / 0.729e3 + 0.2e1 / 0.729e3 * t6600 - t6602 / 0.108e3 - t6604 / 0.108e3 + 0.4e1 / 0.243e3 * t6606 + 0.4e1 / 0.729e3 * t6610 - 0.2e1 / 0.2187e4 * t6612 - 0.2e1 / 0.2187e4 * t6614 - 0.2e1 / 0.6561e4 * t6616 + t6618 / 0.81e2 - 0.2e1 / 0.243e3 * t6620 + t6357 + 0.7e1 / 0.54e2 * t2417 * t523 + 0.7e1 / 0.54e2 * t718 * t2101 - 0.7e1 / 0.216e3 * t225 * t228 * t6958;
  t6994 = -t1501 * t832 / 0.96e2 - 0.1e2 / 0.27e2 * t2420 * t2106 + 0.4e1 / 0.27e2 * t509 * t2015 * t729 + 0.4e1 / 0.27e2 * t215 * t5762 * t729 + 0.16e2 / 0.81e2 * t5614 * t2086 + t5637 * t273 / 0.24e2 + t5640 * t273 / 0.12e2 + t5644 * t273 / 0.24e2 + 0.4e1 / 0.81e2 * t6635 + t6637 / 0.36e2 + t6639 / 0.36e2 - t6642 / 0.27e2 + t6644 / 0.108e3 - t6646 / 0.27e2 - 0.2e1 / 0.81e2 * t6648 - t6650 / 0.144e3 - t6652 / 0.144e3 + t6361 - t6365 - 0.3e1 / 0.4e1 * t194 * t2405;
  t7013 = t816 * t534;
  t7014 = t7013 * t582;
  t7050 = t215 * t2326 * t227;
  t7053 = -0.3e1 / 0.8e1 * t74 * t27 * (-0.7e1 / 0.243e3 * t130 * t6958 - 0.14e2 / 0.2187e4 * t331 * t802 * t534 * t562 + 0.152e3 / 0.19683e5 * t2399 * t2026 - 0.32e2 / 0.177147e6 * t2986 * t6787 * t4291) * t100 - 0.3e1 / 0.8e1 * t550 * t809 - 0.7e1 / 0.2916e4 * t587 * t7014 - 0.7e1 / 0.1458e4 * t580 * t7014 - t4077 * t823 / 0.216e3 - t4099 * t829 / 0.648e3 - t4102 * t829 / 0.324e3 - t4106 * t829 / 0.648e3 + t1563 * t2342 / 0.486e3 + t1567 * t2342 / 0.486e3 - t4111 * t829 / 0.1296e4 - t4092 * t829 / 0.648e3 - t4096 * t829 / 0.1296e4 - t4125 * t823 / 0.216e3 - t4073 * t823 / 0.108e3 + t1560 * t2342 / 0.243e3 + t1570 * t2339 / 0.81e2 + t1574 * t2339 / 0.81e2 + t1556 * t2342 / 0.243e3 - 0.8e1 / 0.243e3 * t7050 * t574;
  t7056 = t215 * t2416 * t578;
  t7060 = t215 * t2416 * t227;
  t7078 = -0.8e1 / 0.729e3 * t7056 * t583 - 0.4e1 / 0.729e3 * t7060 * t583 - 0.7e1 / 0.486e3 * t572 * t7013 * t573 + t6669 / 0.243e3 + t6671 / 0.729e3 - t6673 / 0.972e3 - t6675 / 0.324e3 - t6677 / 0.972e3 - t6679 / 0.1944e4 - t6682 / 0.324e3 + t6684 / 0.1458e4 - t6686 / 0.1944e4 + t6378 + t6380 + t6386 + t6390 - t6394 + t6713 / 0.12e2 + t6715 / 0.12e2 - t6718 / 0.48e2;
  t7103 = t509 * t2326;
  t7107 = t215 * t2403 * t217;
  t7121 = -t6720 / 0.48e2 + t6722 / 0.36e2 - t6725 / 0.9e1 - t6727 / 0.9e1 + t5893 * t270 / 0.8e1 - t1419 * t826 / 0.32e2 - t1422 * t826 / 0.16e2 - t1425 * t826 / 0.32e2 - t1962 * t735 / 0.3e1 - t1953 * t735 / 0.3e1 - 0.16e2 / 0.243e3 * t4354 * t99 * t6787 * t6311 + t510 * t2323 / 0.12e2 + t514 * t2323 / 0.12e2 - t7103 * t221 / 0.3e1 - t7107 * t221 / 0.3e1 + t5904 * t270 / 0.8e1 + t5890 * t270 / 0.4e1 + 0.7e1 / 0.18e2 * t2327 * t598 + 0.7e1 / 0.18e2 * t714 * t1968 - 0.7e1 / 0.72e2 * t219 * t220 * t6957;
  t7125 = my_piecewise3(t65, 0, t6839 + t6885 + t6928 + t6962 + t6994 + t7053 + t7078 + t7121);
  tv4rho2sigma217 = t6 * t7125 + 0.2e1 * t2440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7146 = 0.1e1 / t33 / t1609;
  t7147 = t759 * t7146;
  t7148 = t7147 * t2825;
  t7151 = t7147 * t2800;
  t7158 = -t4560 * t2191 / 0.81e2 - t1770 * t2191 / 0.162e3 - t4566 * t2173 / 0.243e3 - t1774 * t2173 / 0.243e3 - t1778 * t2173 / 0.729e3 + t1021 * t2455 / 0.48e2 + t989 * t2455 / 0.48e2 + t1033 * t2460 / 0.5832e4 + t1037 * t2460 / 0.5832e4 + 0.2e1 / 0.6561e4 * t351 * t7148 + 0.11e2 / 0.39366e5 * t359 * t7151 + t344 * t7151 / 0.13122e5 + t2842 * t2463 / 0.216e3;
  t7164 = t7147 * t2855;
  t7184 = t2775 * t2463 / 0.648e3;
  t7186 = t1025 * t2455 / 0.144e3;
  t7187 = t2766 * t2463 / 0.216e3 + 0.2e1 / 0.243e3 * t2846 * t7147 * t2848 + 0.2e1 / 0.729e3 * t2853 * t7164 + t993 * t7164 / 0.729e3 + t2815 * t2466 / 0.648e3 + t2819 * t2466 / 0.648e3 + 0.2e1 / 0.2187e4 * t2823 * t7148 + 0.2e1 / 0.2187e4 * t1012 * t7148 + t1040 * t2466 / 0.1296e4 + t1053 * t2466 / 0.1296e4 - t4584 * t2188 / 0.27e2 + t7184 + t7186;
  t7215 = t6231 * t647 / 0.27e2 + t6251 * t659 / 0.81e2 + t6255 * t659 / 0.162e3 + t2829 * t2460 / 0.1944e4 + t2833 * t2460 / 0.1944e4 + 0.2e1 / 0.6561e4 * t2839 * t7151 + t1018 * t7151 / 0.2187e4 + t1056 * t2460 / 0.1944e4 + t1060 * t2460 / 0.1944e4 - t4690 * t776 / 0.24e2 - t4739 * t776 / 0.24e2 + t3049 * t2494 / 0.72e2 + t3038 * t2494 / 0.72e2;
  t7226 = t143 * t2517 * t58;
  t7246 = t6179 * t252 / 0.48e2;
  t7249 = 0.2e1 / 0.81e2 * t3022 * t59 * t759 * t7146 * M_PI * t43 + t143 * t6037 * t644 / 0.9e1 - t7226 * t157 / 0.18e2 + t382 * t2480 / 0.64e2 + t389 * t2480 / 0.64e2 - t4804 * t2242 / 0.9e1 - t1738 * t789 / 0.32e2 - t1760 * t789 / 0.32e2 + t6154 * t252 / 0.16e2 + t6158 * t252 / 0.16e2 + t631 * t2225 / 0.24e2 + t7246 - t2250 * t662 / 0.12e2;
  t7253 = t3011 * t2494 / 0.216e3;
  t7255 = t385 * t2480 / 0.192e3;
  t7256 = t2477 * t132;
  t7257 = t7256 * t134;
  t7262 = t1741 * t789 / 0.96e2;
  t7263 = t2444 * t124;
  t7264 = t7263 * t346;
  t7268 = t4472 * t780 / 0.216e3;
  t7272 = t4491 * t786 / 0.648e3;
  t7274 = t1043 * t2446 / 0.2592e4;
  t7283 = t7253 + t7255 - t153 * t156 * t7257 / 0.48e2 - t7262 - t344 * t7264 / 0.648e3 - t7268 + t1770 * t2141 / 0.54e2 - t7272 + t7274 + t1033 * t2446 / 0.864e3 + t1037 * t2446 / 0.864e3 - t4506 * t780 / 0.72e2 - t4476 * t780 / 0.72e2;
  t7293 = t1046 * t2502 / 0.432e3;
  t7295 = t1049 * t2446 / 0.1296e4;
  t7299 = t4488 * t786 / 0.1296e4;
  t7310 = -t4494 * t786 / 0.216e3 - t4481 * t786 / 0.216e3 - t4497 * t786 / 0.432e3 - t4485 * t786 / 0.432e3 + t7293 + t7295 + t1774 * t2147 / 0.162e3 - t7299 + t1778 * t2147 / 0.324e3 + t1053 * t2502 / 0.144e3 + t1056 * t2446 / 0.432e3 + t1060 * t2446 / 0.432e3 + t1040 * t2502 / 0.144e3;
  t7320 = t1049 * t2460 / 0.5832e4;
  t7322 = t4693 * t776 / 0.72e2;
  t7324 = t2778 * t2466 / 0.1944e4;
  t7326 = t1046 * t2466 / 0.3888e4;
  t7328 = t2781 * t2460 / 0.5832e4;
  t7333 = t1043 * t2460 / 0.17496e5;
  t7354 = t26 * t117 * t2517 * t60 / 0.8e1;
  t7355 = -t351 * t7263 * t352 / 0.108e3 - t359 * t7264 / 0.324e3 + t1626 * t2168 / 0.18e2 + t7320 - t7322 + t7324 + t7326 + t7328 - t284 * t2444 * t643 / 0.36e2 + t7333 - 0.3e1 / 0.8e1 * t26 * t27 * (-t130 * t7257 / 0.54e2 - t331 * t2443 * t124 * t334 / 0.243e3 + 0.4e1 / 0.59049e5 * t2986 * t759 * t7146 * t2990) * t60 - 0.3e1 / 0.8e1 * t113 * t2519 - t7354;
  t7369 = t143 * t2517 * t145;
  t7375 = t375 * t2497 / 0.64e2;
  t7380 = t6327 * t249 / 0.16e2;
  t7384 = t1673 * t783 / 0.32e2;
  t7385 = -0.3e1 / 0.32e2 * t1670 * t783 - 0.3e1 / 0.32e2 * t1677 * t783 + 0.3e1 / 0.64e2 * t365 * t2497 + 0.3e1 / 0.64e2 * t379 * t2497 + 0.3e1 / 0.16e2 * t6330 * t249 + 0.3e1 / 0.16e2 * t6334 * t249 - t7369 * t149 / 0.6e1 + t627 * t2121 / 0.8e1 + t7375 - t147 * t148 * t7256 / 0.16e2 + t7380 - t2127 * t650 / 0.4e1 - t7384;
  t7389 = my_piecewise3(t1, 0, t7158 + t7187 + t7215 + t7249 + t7283 + t7310 + t7355 + t7385);
  tv4rhosigma30 = t6 * t7389 + t2524;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t7392 = t3871 * t2555 / 0.648e3;
  t7394 = t3866 * t2558 / 0.1944e4;
  t7396 = t1355 * t2534 / 0.144e3;
  t7398 = t1364 * t2550 / 0.17496e5;
  t7413 = t7392 + t7394 + t7396 + t7398 - t5479 * t819 / 0.24e2 + t3894 * t2555 / 0.216e3 + t3897 * t2558 / 0.648e3 + t1370 * t2558 / 0.1296e4 + t3881 * t2550 / 0.1944e4 + t1373 * t2550 / 0.1944e4 + t1358 * t2534 / 0.48e2;
  t7417 = t5421 * t819 / 0.72e2;
  t7419 = t1367 * t2558 / 0.3888e4;
  t7421 = t3859 * t2550 / 0.5832e4;
  t7423 = t1361 * t2550 / 0.5832e4;
  t7433 = t6641 * t273 / 0.48e2;
  t7435 = t3962 * t2580 / 0.216e3;
  t7436 = t1376 * t2550 / 0.5832e4 - t7417 + t7419 + t7421 + t7423 + t3982 * t2580 / 0.72e2 + t481 * t2545 / 0.64e2 - t1930 * t832 / 0.32e2 + t6627 * t273 / 0.16e2 + t7433 + t7435;
  t7439 = t1913 * t832 / 0.96e2;
  t7441 = t484 * t2545 / 0.192e3;
  t7443 = t1367 * t2587 / 0.432e3;
  t7445 = t1361 * t2529 / 0.1296e4;
  t7447 = t5487 * t823 / 0.216e3;
  t7449 = t5490 * t829 / 0.648e3;
  t7451 = t1364 * t2529 / 0.2592e4;
  t7453 = t5503 * t829 / 0.1296e4;
  t7460 = -t7439 + t7441 + t7443 + t7445 - t7447 - t7449 + t7451 - t7453 + t1373 * t2529 / 0.432e3 + t1370 * t2587 / 0.144e3 + t1376 * t2529 / 0.864e3;
  t7472 = t74 * t117 * t2600 * t100 / 0.8e1;
  t7480 = t6724 * t270 / 0.16e2;
  t7482 = t478 * t2570 / 0.64e2;
  t7484 = t1894 * t826 / 0.32e2;
  t7485 = -t5496 * t829 / 0.432e3 - t5499 * t823 / 0.72e2 - t5493 * t829 / 0.216e3 - 0.3e1 / 0.8e1 * t168 * t2602 - t7472 + 0.3e1 / 0.16e2 * t6733 * t270 + 0.3e1 / 0.64e2 * t474 * t2570 - 0.3e1 / 0.32e2 * t1870 * t826 + t7480 + t7482 - t7484;
  t7488 = my_piecewise3(t65, 0, t7413 + t7436 + t7460 + t7485);
  tv4rhosigma39 = t6 * t7488 + t2607;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t7508 = t1185 * t2460 / 0.5832e4 + t3241 * t2463 / 0.216e3 + t3220 * t2466 / 0.648e3 + t1179 * t2466 / 0.1296e4 + t3225 * t2460 / 0.1944e4 + t1182 * t2460 / 0.1944e4 + t1175 * t2455 / 0.48e2 - t5011 * t776 / 0.24e2 + t7184 + t7186 + t3319 * t2494 / 0.72e2;
  t7523 = t443 * t2480 / 0.64e2 - t1857 * t789 / 0.32e2 + t6468 * t252 / 0.16e2 + t7246 + t7253 + t7255 - t7262 - t4958 * t780 / 0.72e2 - t4961 * t786 / 0.216e3 - t4964 * t786 / 0.432e3 + t1179 * t2502 / 0.144e3;
  t7529 = t1182 * t2446 / 0.432e3 + t1185 * t2446 / 0.864e3 - t7268 - t7272 + t7274 + t7293 + t7295 - t7299 + t7320 - t7322 + t7324;
  t7538 = t7326 + t7328 + t7333 - 0.3e1 / 0.8e1 * t184 * t2519 - t7354 + t7375 + t7380 - t7384 - 0.3e1 / 0.32e2 * t1823 * t783 + 0.3e1 / 0.64e2 * t440 * t2497 + 0.3e1 / 0.16e2 * t6543 * t249;
  t7541 = my_piecewise3(t1, 0, t7508 + t7523 + t7529 + t7538);
  tv4rhosigma310 = t6 * t7541 + t2524;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t7544 = 0.1e1 / t77 / t1994;
  t7545 = t802 * t7544;
  t7546 = t7545 * t4229;
  t7555 = t7545 * t4149;
  t7574 = 0.2e1 / 0.729e3 * t4227 * t7546 + t1515 * t7546 / 0.729e3 + t4235 * t2558 / 0.648e3 + t4239 * t2558 / 0.648e3 + 0.2e1 / 0.2187e4 * t4243 * t7555 + 0.2e1 / 0.2187e4 * t1522 * t7555 + t1570 * t2558 / 0.1296e4 - t1978 * t2373 / 0.162e3 - t1982 * t2381 / 0.243e3 - t1986 * t2381 / 0.729e3 + t1542 * t2534 / 0.48e2 + t1548 * t2534 / 0.48e2 - t5768 * t2370 / 0.27e2;
  t7600 = t7545 * t4186;
  t7603 = -t5813 * t2373 / 0.81e2 - t5819 * t2381 / 0.243e3 + t1563 * t2550 / 0.5832e4 + t1567 * t2550 / 0.5832e4 + t2017 * t2378 / 0.18e2 - t531 * t2527 * t728 / 0.36e2 + t7050 * t732 / 0.27e2 + t7056 * t742 / 0.81e2 + t7060 * t742 / 0.162e3 + t1574 * t2558 / 0.1296e4 + t4153 * t2550 / 0.1944e4 + t4157 * t2550 / 0.1944e4 + 0.2e1 / 0.6561e4 * t4182 * t7600;
  t7628 = t1532 * t7600 / 0.2187e4 + t1556 * t2550 / 0.1944e4 + t1560 * t2550 / 0.1944e4 - t5759 * t819 / 0.24e2 - t5764 * t819 / 0.24e2 + 0.2e1 / 0.6561e4 * t572 * t7555 + 0.11e2 / 0.39366e5 * t580 * t7600 + t587 * t7600 / 0.13122e5 + t4212 * t2555 / 0.216e3 + t4216 * t2555 / 0.216e3 + 0.2e1 / 0.243e3 * t4220 * t7545 * t4222 + t7392 + t7394;
  t7641 = t2542 * t204;
  t7642 = t7641 * t206;
  t7646 = t7396 + t7398 - t7417 + t7419 + t7421 + t7423 + t595 * t2545 / 0.64e2 - t2089 * t832 / 0.32e2 - t2093 * t832 / 0.32e2 - t5614 * t2430 / 0.9e1 + t6814 * t273 / 0.16e2 + t6818 * t273 / 0.16e2 - t225 * t228 * t7642 / 0.48e2;
  t7663 = t215 * t2600 * t98;
  t7674 = t4382 * t2580 / 0.72e2 + t4386 * t2580 / 0.72e2 + 0.2e1 / 0.81e2 * t4354 * t99 * t802 * t7544 * M_PI * t43 + t215 * t6934 * t729 / 0.9e1 - t7663 * t229 / 0.18e2 + t591 * t2545 / 0.64e2 - t2417 * t745 / 0.12e2 + t718 * t2411 / 0.24e2 + t7433 + t7435 - t7439 + t7441 - t5855 * t829 / 0.432e3;
  t7681 = t2527 * t199;
  t7682 = t7681 * t582;
  t7703 = -t5868 * t829 / 0.432e3 + t1978 * t2339 / 0.54e2 + t1982 * t2342 / 0.162e3 - t587 * t7682 / 0.648e3 + t1986 * t2342 / 0.324e3 + t1556 * t2529 / 0.432e3 + t1560 * t2529 / 0.432e3 + t1570 * t2587 / 0.144e3 + t1574 * t2587 / 0.144e3 - t5849 * t823 / 0.72e2 - t5859 * t823 / 0.72e2 - t5852 * t829 / 0.216e3 - t5864 * t829 / 0.216e3;
  t7731 = -t572 * t7681 * t573 / 0.108e3 - t580 * t7682 / 0.324e3 + t1563 * t2529 / 0.864e3 + t1567 * t2529 / 0.864e3 + t7443 + t7445 - t7447 - t7449 + t7451 - t7453 - 0.3e1 / 0.8e1 * t194 * t2602 - 0.3e1 / 0.8e1 * t74 * t27 * (-t130 * t7642 / 0.54e2 - t331 * t2526 * t199 * t562 / 0.243e3 + 0.4e1 / 0.59049e5 * t2986 * t802 * t7544 * t4291) * t100 - t7472;
  t7735 = t215 * t2600 * t217;
  t7755 = t7480 + t7482 - t7484 + 0.3e1 / 0.16e2 * t7107 * t270 - t7735 * t221 / 0.6e1 + 0.3e1 / 0.64e2 * t510 * t2570 + 0.3e1 / 0.64e2 * t514 * t2570 - 0.3e1 / 0.32e2 * t1962 * t826 - 0.3e1 / 0.32e2 * t1953 * t826 + 0.3e1 / 0.16e2 * t7103 * t270 + t714 * t2323 / 0.8e1 - t2327 * t735 / 0.4e1 - t219 * t220 * t7641 / 0.16e2;
  t7759 = my_piecewise3(t65, 0, t7574 + t7603 + t7628 + t7646 + t7674 + t7703 + t7731 + t7755);
  tv4rhosigma319 = t6 * t7759 + t2607;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t7761 = t2443 * t2628;
  t7762 = t7761 * t2855;
  t7765 = t7761 * t2825;
  t7770 = t2477 * t2458;
  t7771 = t7770 * t1000;
  t7774 = t7770 * t1005;
  t7789 = -t993 * t7762 / 0.1944e4 - t2823 * t7765 / 0.2916e4 - t1012 * t7765 / 0.2916e4 - t351 * t7771 / 0.432e3 - t359 * t7774 / 0.648e3 - t344 * t7774 / 0.1944e4 + t4584 * t2463 / 0.54e2 + t4560 * t2466 / 0.162e3 + t1770 * t2466 / 0.324e3 + t4566 * t2460 / 0.486e3 + t1774 * t2460 / 0.486e3;
  t7796 = t2442 * sigma[0];
  t7797 = 0.1e1 / t7796;
  t7798 = t30 * t7797;
  t7804 = t7761 * t2800;
  t7820 = t1778 * t2460 / 0.1458e4 - t1018 * t7774 / 0.648e3 - t1012 * t7771 / 0.216e3 - 0.5e1 / 0.96e2 * t284 * t7798 * t775 - t6039 * t776 / 0.12e2 - t2839 * t7804 / 0.8748e4 - t1018 * t7804 / 0.5832e4 + t1626 * t2455 / 0.12e2 - t993 * t7770 * t995 / 0.72e2 - t351 * t7765 / 0.8748e4 - 0.11e2 / 0.104976e6 * t359 * t7804 - t344 * t7804 / 0.34992e5;
  t7847 = 0.1e1 / t44 / t7796 * t47;
  t7848 = t7847 * t134;
  t7856 = -t2846 * t7761 * t2848 / 0.324e3 - t2853 * t7762 / 0.972e3 - t955 * t59 * t2477 * t2493 / 0.24e2 + t631 * t2480 / 0.16e2 + t4804 * t2494 / 0.18e2 - t2250 * t789 / 0.16e2 + t7226 * t252 / 0.12e2 - t3022 * t59 * t2443 * t2628 * M_PI * t43 / 0.108e3 - 0.5e1 / 0.128e3 * t153 * t156 * t7848 + t1778 * t2446 / 0.216e3 - t6231 * t780 / 0.36e2;
  t7859 = t7798 * t36;
  t7863 = t7859 * t346;
  t7901 = -t6251 * t786 / 0.108e3 - 0.5e1 / 0.288e3 * t351 * t7859 * t352 - 0.5e1 / 0.864e3 * t359 * t7863 - t6255 * t786 / 0.216e3 + t1770 * t2502 / 0.36e2 + t1774 * t2446 / 0.108e3 - 0.5e1 / 0.1728e4 * t344 * t7863 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.5e1 / 0.144e3 * t130 * t7848 - 0.5e1 / 0.648e3 * t331 * t7797 * t36 * t334 - t893 * t2477 * t2514 / 0.729e3 - t2986 * t2443 * t2628 * t2990 / 0.39366e5) * t60 + 0.3e1 / 0.16e2 * t627 * t2497 - 0.15e2 / 0.128e3 * t147 * t148 * t7847 - 0.3e1 / 0.16e2 * t2127 * t783 + t7369 * t249 / 0.4e1;
  t7904 = my_piecewise3(t1, 0, t7789 + t7820 + t7856 + t7901);
  tv4sigma40 = t6 * t7904;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t7907 = t2542 * t2548;
  t7908 = t7907 * t1523;
  t7913 = t7907 * t1534;
  t7916 = t2525 * sigma[2];
  t7917 = 0.1e1 / t7916;
  t7918 = t30 * t7917;
  t7922 = t2526 * t4033;
  t7923 = t7922 * t4186;
  t7930 = t7922 * t4149;
  t7937 = t5819 * t2550 / 0.486e3 - t572 * t7908 / 0.432e3 - t1522 * t7908 / 0.216e3 - t1532 * t7913 / 0.648e3 - 0.5e1 / 0.96e2 * t531 * t7918 * t818 - t4182 * t7923 / 0.8748e4 - t1532 * t7923 / 0.5832e4 - t6936 * t819 / 0.12e2 - t572 * t7930 / 0.8748e4 - 0.11e2 / 0.104976e6 * t580 * t7923 - t587 * t7923 / 0.34992e5;
  t7941 = t7922 * t4229;
  t7965 = -t4220 * t7922 * t4222 / 0.324e3 - t4227 * t7941 / 0.972e3 - t1515 * t7941 / 0.1944e4 - t4243 * t7930 / 0.2916e4 - t1522 * t7930 / 0.2916e4 - t580 * t7913 / 0.648e3 - t587 * t7913 / 0.1944e4 + t1978 * t2558 / 0.324e3 + t1982 * t2550 / 0.486e3 + t1986 * t2550 / 0.1458e4 + t2017 * t2534 / 0.12e2 - t1515 * t7907 * t1517 / 0.72e2;
  t7973 = 0.1e1 / t84 / t7916 * t87;
  t7974 = t7973 * t206;
  t8016 = t5768 * t2555 / 0.54e2 + t5813 * t2558 / 0.162e3 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.5e1 / 0.144e3 * t130 * t7974 - 0.5e1 / 0.648e3 * t331 * t7917 * t80 * t562 - t893 * t2542 * t2597 / 0.729e3 - t2986 * t2526 * t4033 * t4291 / 0.39366e5) * t100 + t7663 * t273 / 0.12e2 - t4354 * t99 * t2526 * t4033 * M_PI * t43 / 0.108e3 - t1487 * t99 * t2542 * t2579 / 0.24e2 + t718 * t2545 / 0.16e2 - t2417 * t832 / 0.16e2 + t5614 * t2580 / 0.18e2 - 0.5e1 / 0.128e3 * t225 * t228 * t7974 + t1986 * t2529 / 0.216e3;
  t8023 = t7918 * t80;
  t8027 = t8023 * t582;
  t8045 = -t7060 * t829 / 0.216e3 - t7050 * t823 / 0.36e2 - t7056 * t829 / 0.108e3 - 0.5e1 / 0.288e3 * t572 * t8023 * t573 - 0.5e1 / 0.864e3 * t580 * t8027 + t1978 * t2587 / 0.36e2 + t1982 * t2529 / 0.108e3 - 0.5e1 / 0.1728e4 * t587 * t8027 - 0.15e2 / 0.128e3 * t219 * t220 * t7973 + 0.3e1 / 0.16e2 * t714 * t2570 - 0.3e1 / 0.16e2 * t2327 * t826 + t7735 * t270 / 0.4e1;
  t8048 = my_piecewise3(t65, 0, t7937 + t7965 + t8016 + t8045);
  tv4sigma414 = t6 * t8048;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

