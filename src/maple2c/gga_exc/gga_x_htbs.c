/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_htbs.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)

static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105;

#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, t181, t185, t186, t187;
  double t190, t193, t196, t199, t200, t207, t211, t215;
  double t219, t224, t225, t229;

#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, t355, t358, t362, t363, t367;
  double t368, t369, t375, t376, t378, t383, t405, t408;
  double t415, t416, t419, t421, t426, t432, t433, t438;
  double t441, t446, t447, t455, t457, t460, t464, t467;
  double t468, t476, t480, t486, t495, t496, t500;

#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, tv2rho20, t355, t358, t362, t363;
  double t367, t368, t369, t375, t376, t378, t383, t405;
  double t408, t415, t416, t419, t421, t426, t432, t433;
  double t438, tv2rhosigma0, t441, t446, t447, t455, t457, t460;
  double t464, t467, t468, t476, t480, t486, t495, t496;
  double t500, tv2sigma20;

  double t503, t513, t514, t515, t518, t522, t524, t526;
  double t527, t531, t532, t536, t540, t541, t543, t545;
  double t546, t549, t553, t556, t557, t559, t562, t565;
  double t569, t580, t585, t592, t596, t599, t605, t609;
  double t613, t616, t617, t620, t622, t625, t630, t633;
  double t638, t639, t640, t645, tv3rho30, t655, t658, t663;
  double t667, t671, t672, t682, t684, t688, t713, t715;
  double t719, t729, t733, t743, t746, t751, t754, t757;
  double t758, t761, t768, t770, t771, t776, tv3rho2sigma0, t782;
  double t787, t792, t793, t801, t802, t806, t807, t811;
  double t815, t832, t835, t848, t851, t853, t864, t867;
  double t872, t877, t878, t879, t884, tv3rhosigma20, t887, t902;
  double t906, t912, t913, t919, t923, t932, t942, t947;
  double t948, t949, t953, tv3sigma30;

#ifndef XC_DONT_COMPILE_LXC
  double t970, t971, t977, t983, t985, t990, t991, t995;
  double t999, t1001, t1010, t1025, t1030, t1031, t1035, t1050;
  double t1051, t1061, t1070, t1071, t1075, t1079, t1096, t1100;
  double t1123, t1126, t1131, t1134, t1136, t1137, t1142, t1170;
  double t1174, t1205, t1242, t1264, t1268, t1280, t1281, t1290;
  double t1293, t1330, t1332, t1333, t1338, t1355, t1398, t1434;
  double t1446, t1450, t1463, t1472, t1478, t1527, t1530, t1531;
  double t1536, t1560, t1582, t1602, t1607, t1632, t1641, t1681;
  double t1683, t1684, t1689, t1692, t1697, t1724, t1753, t1782;
  double t1783, t1784, t1788;
#endif

#endif

#endif

  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.1e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.2535e0 * t25 * t28 * t141 + 0.52e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.243905525293907837e-1 * t47 * t137, t158 * t76 - 0.243905525293907837e-1 * t161 * t163 + t166 * t71 + 0.646416e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.646416e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  tvrho0 = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.4002424276710846245e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.950625e-1 * t25 * t200 * t30 - 0.195e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.646416e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.646416e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  tvsigma0 = 0.2e1 * rho[0] * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t234 = t17 / t41 / rho[0];
  t242 = 0.1e1 / t111 / t68;
  t243 = t134 * t134;
  t247 = 0.1e1 / t41 / t59;
  t249 = t37 * t39 * t247;
  t251 = t38 * t247;
  t252 = t251 * t50;
  t256 = 0.1e1 / t18 / t152;
  t257 = t27 * t256;
  t258 = t257 * t50;
  t261 = t22 * t22;
  t262 = 0.1e1 / t261;
  t263 = t57 * sigma[0];
  t264 = t262 * t263;
  t265 = t59 * t59;
  t266 = t265 * t40;
  t267 = 0.1e1 / t266;
  t271 = t257 * t130;
  t276 = t20 / t35 / t261;
  t277 = t57 * t57;
  t278 = t276 * t277;
  t279 = t265 * t59;
  t281 = 0.1e1 / t41 / t279;
  t283 = t66 * t66;
  t284 = 0.1e1 / t283;
  t285 = t38 * t281 * t284;
  t288 = 0.11e3 / 0.2187e4 * t249 + 0.39134815150061607728e-1 * t47 * t252 - 0.800484855342169249e-2 * t123 * t258 + 0.11859034893958062948e-2 * t264 * t267 * t50 + 0.93093776153132442719e-3 * t123 * t271 - 0.12963666552805392131e-6 * t278 * t285;
  t292 = t251 * t74;
  t295 = t257 * t74;
  t300 = 0.1e1 / t18 / t113;
  t305 = 0.1e1 / t89;
  t312 = 0.1e1 / t41 / t265;
  t316 = 0.5915e0 * t25 * t28 * t300 - 0.19066666666666666667e1 * t249 + 0.35251328475563349648e0 * t79 * t305 - 0.17592592592592592593e0 * t56 * t58 * t256 + 0.16637731481481481482e-1 * t86 * t88 * t312;
  t319 = t158 * t20 * t36;
  t323 = t39 * t247 * t74;
  t327 = t95 * t21 * t55;
  t329 = t58 * t256 * t74;
  t332 = -t316;
  t334 = t166 * t112;
  t337 = t97 * t242;
  t343 = my_piecewise3(t72, 0.89432025941099540233e-1 * t47 * t292 - 0.14798483897735600909e-2 * t123 * t295, t316 * t76 - 0.487811050587815674e-1 * t319 * t163 + 0.89432025941099540233e-1 * t161 * t323 - 0.14798483897735600909e-2 * t327 * t329 + t332 * t71 + 0.1292832e1 * t334 * t134 - 0.1292832e1 * t337 * t243 + 0.646416e0 * t168 * t288);
  t344 = my_piecewise3(t34, -0.1292832e1 * t242 * t243 + 0.646416e0 * t112 * t288, t343);
  t349 = my_piecewise3(t2, 0, t6 * t234 * t101 / 0.12e2 - t6 * t107 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t344);
  tv2rho20 = 0.2e1 * rho[0] * t349 + 0.4e1 * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t355 = t242 * t193;
  t358 = t37 * t119;
  t362 = t56 * t27;
  t363 = t125 * sigma[0];
  t367 = t262 * t57;
  t368 = t265 * rho[0];
  t369 = 0.1e1 / t368;
  t375 = t276 * t263;
  t376 = t265 * t113;
  t378 = 0.1e1 / t41 / t376;
  t383 = -0.1e2 / 0.729e3 * t358 - 0.10673131404562256653e-1 * t37 * t120 + 0.26682828511405641633e-2 * t362 * t363 * t50 - 0.44471380852342736056e-3 * t367 * t369 * t50 - 0.29398034574673402963e-3 * t185 * t131 + 0.48613749573020220489e-7 * t375 * t38 * t378 * t284;
  t405 = -0.12675e0 * t25 * t200 * t141 + 0.52e0 * t358 - 0.10575398542669004894e0 * t26 * t146 + 0.55555555555555555557e-1 * t56 * t207 * t125 - 0.54253472222222222223e-2 * t86 * t211 * t154;
  t408 = t215 * t20 * t36;
  t415 = sigma[0] * t74;
  t416 = t126 * t415;
  t419 = -t405;
  t421 = t219 * t112;
  t426 = t193 * t134;
  t432 = my_piecewise3(t72, -0.24390552529390783699e-1 * t37 * t137 + 0.55494314616508503409e-3 * t362 * t363 * t74, t405 * t76 - 0.243905525293907837e-1 * t408 * t163 + 0.91464571985215438873e-2 * t319 * t196 - 0.24390552529390783699e-1 * t161 * t137 + 0.55494314616508503409e-3 * t327 * t416 + t419 * t71 + 0.646416e0 * t421 * t134 + 0.646416e0 * t334 * t193 - 0.1292832e1 * t337 * t426 + 0.646416e0 * t168 * t383);
  t433 = my_piecewise3(t34, -0.1292832e1 * t355 * t134 + 0.646416e0 * t112 * t383, t432);
  t438 = my_piecewise3(t2, 0, -t6 * t107 * t225 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t433);
  tv2rhosigma0 = 0.2e1 * rho[0] * t438 + 0.2e1 * t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t441 = t193 * t193;
  t446 = t262 * sigma[0];
  t447 = 0.1e1 / t265;
  t455 = 0.1e1 / t41 / t266;
  t457 = t38 * t455 * t284;
  t460 = -0.66707071278514104084e-3 * t56 * t187 + 0.16676767819628526021e-3 * t446 * t447 * t50 + 0.55121314827512630556e-4 * t56 * t190 - 0.18230156089882582683e-7 * t276 * t57 * t457;
  t464 = t186 * t74;
  t467 = 0.1e1 / t79;
  t468 = t467 * t27;
  t476 = t26 * t38;
  t480 = -0.4753125e-1 * t25 * t468 * t30 + 0.13219248178336256118e-1 * t199 * t80 - 0.10416666666666666667e-1 * t56 * t186 + 0.1220703125e-2 * t86 * t476 * t91;
  t486 = -t480;
  t495 = my_piecewise3(t72, -0.20810367981190688778e-3 * t56 * t464, t480 * t76 + 0.18292914397043087775e-1 * t408 * t196 - 0.20810367981190688778e-3 * t327 * t464 + t486 * t71 + 0.1292832e1 * t421 * t193 - 0.1292832e1 * t337 * t441 + 0.646416e0 * t168 * t460);
  t496 = my_piecewise3(t34, -0.1292832e1 * t242 * t441 + 0.646416e0 * t112 * t460, t495);
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t496);
  tv2sigma20 = 0.2e1 * rho[0] * t500;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t503 = t17 * t43;
  t513 = t111 * t111;
  t514 = 0.1e1 / t513;
  t515 = t243 * t134;
  t518 = t242 * t134;
  t522 = 0.1e1 / t41 / t60;
  t524 = t37 * t39 * t522;
  t526 = t38 * t522;
  t527 = t526 * t50;
  t531 = 0.1e1 / t18 / t265;
  t532 = t27 * t531;
  t536 = 0.1e1 / t376;
  t540 = t262 * t277;
  t541 = t265 * t60;
  t543 = 0.1e1 / t41 / t541;
  t545 = t38 * t50;
  t546 = t37 * t545;
  t549 = t532 * t130;
  t553 = t38 * t543 * t284;
  t556 = t277 * t57;
  t557 = t265 * t265;
  t559 = 0.1e1 / t557 / t113;
  t562 = 0.1e1 / t283 / t66;
  t565 = -0.154e4 / 0.6561e4 * t524 - 0.1826291373669541694e0 * t47 * t527 + 0.67398848313994991088e-1 * t123 * t532 * t50 - 0.22532166298520319601e-1 * t264 * t536 * t50 + 0.13176705437731181053e-3 * t540 * t543 * t546 - 0.68268769178963791327e-2 * t123 * t549 + 0.24630966450330245049e-5 * t278 * t553 - 0.48197932879823405316e-13 * t556 * t559 * t562;
  t569 = t526 * t74;
  t580 = 0.1e1 / t18 / t59;
  t585 = 0.1e1 / t152;
  t592 = 0.1e1 / t41 / t368;
  t596 = -0.19716666666666666667e1 * t25 * t28 * t580 + 0.88977777777777777779e1 * t524 - 0.21150797085338009789e1 * t79 * t585 + 0.12901234567901234568e1 * t56 * t58 * t531 - 0.14419367283950617284e0 * t86 * t88 * t592;
  t599 = t316 * t20 * t36;
  t605 = t158 * t21 * t55;
  t609 = t39 * t522 * t74;
  t613 = t58 * t531 * t74;
  t616 = t95 * t263;
  t617 = t536 * t74;
  t620 = -t596;
  t622 = t332 * t112;
  t625 = t166 * t242;
  t630 = t97 * t514;
  t633 = t134 * t288;
  t638 = t596 * t76 - 0.731716575881723511e-1 * t599 * t163 + 0.2682960778232986207e0 * t319 * t323 - 0.44395451693206802728e-2 * t605 * t329 - 0.41734945439179785442e0 * t161 * t609 + 0.16278332287509161e-1 * t327 * t613 - 0.55305022007122575148e-5 * t616 * t617 + t620 * t71 + 0.1939248e1 * t622 * t134 - 0.3878496e1 * t625 * t243 + 0.1939248e1 * t334 * t288 + 0.3878496e1 * t630 * t515 - 0.3878496e1 * t337 * t633 + 0.646416e0 * t168 * t565;
  t639 = my_piecewise3(t72, -0.41734945439179785442e0 * t47 * t569 + 0.16278332287509161e-1 * t123 * t532 * t74 - 0.55305022007122575148e-5 * t263 * t536 * t74, t638);
  t640 = my_piecewise3(t34, 0.3878496e1 * t514 * t515 - 0.3878496e1 * t518 * t288 + 0.646416e0 * t112 * t565, t639);
  t645 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t101 + t6 * t234 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t344 - 0.3e1 / 0.8e1 * t6 * t19 * t640);
  tv3rho30 = 0.2e1 * rho[0] * t645 + 0.6e1 * t349;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t655 = t514 * t193;
  t658 = t242 * t383;
  t663 = t37 * t251;
  t667 = t256 * sigma[0];
  t671 = t262 * t267;
  t672 = t57 * t50;
  t682 = t277 * sigma[0];
  t684 = 0.1e1 / t557 / t40;
  t688 = 0.11e3 / 0.2187e4 * t663 + 0.39134815150061607728e-1 * t37 * t252 - 0.19270931702681852291e-1 * t362 * t667 * t50 + 0.75601347448982651294e-2 * t671 * t672 - 0.49412645391491928951e-4 * t264 * t281 * t546 + 0.18618755230626488543e-2 * t185 * t271 - 0.82643374274134374831e-6 * t375 * t285 + 0.18074224829933776993e-13 * t682 * t684 * t562;
  t713 = -0.29575e0 * t25 * t200 * t300 + 0.19066666666666666667e1 * t663 - 0.5287699271334502447e0 * t26 * t305 + 0.35185185185185185186e0 * t56 * t207 * t256 - 0.41594328703703703704e-1 * t86 * t211 * t312;
  t715 = -t713;
  t719 = t419 * t112;
  t729 = t405 * t20 * t36;
  t733 = t215 * t21 * t55;
  t743 = t257 * t415;
  t746 = t193 * t243;
  t751 = t383 * t134;
  t754 = t193 * t288;
  t757 = t95 * t267;
  t758 = t57 * t74;
  t761 = t219 * t242;
  t768 = 0.11098862923301700682e-2 * t605 * t416 + 0.8943202594109954023e-1 * t161 * t292 - 0.49944883154857653068e-2 * t327 * t743 + 0.3878496e1 * t630 * t746 + 0.91464571985215438873e-2 * t599 * t196 - 0.2585664e1 * t337 * t751 - 0.1292832e1 * t337 * t754 + 0.20739383252670965681e-5 * t757 * t758 - 0.1292832e1 * t761 * t243 - 0.2585664e1 * t625 * t426 + 0.89432025941099540233e-1 * t408 * t323;
  t770 = my_piecewise3(t72, 0.8943202594109954023e-1 * t37 * t292 - 0.49944883154857653068e-2 * t362 * t667 * t74 + 0.20739383252670965681e-5 * t267 * t57 * t74, t713 * t71 + t715 * t76 + 0.646416e0 * t168 * t688 + 0.1292832e1 * t719 * t134 + 0.646416e0 * t421 * t288 + 0.646416e0 * t622 * t193 + 0.1292832e1 * t334 * t383 - 0.487811050587815674e-1 * t729 * t163 - 0.14798483897735600909e-2 * t733 * t329 - 0.48781105058781567398e-1 * t319 * t137 + t768);
  t771 = my_piecewise3(t34, 0.3878496e1 * t655 * t243 - 0.2585664e1 * t658 * t134 - 0.1292832e1 * t355 * t288 + 0.646416e0 * t112 * t688, t770);
  t776 = my_piecewise3(t2, 0, t6 * t234 * t225 / 0.12e2 - t6 * t107 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t771);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t776 + 0.4e1 * t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t782 = t514 * t441;
  t787 = t242 * t460;
  t792 = t262 * t369;
  t793 = sigma[0] * t50;
  t801 = t276 * t38;
  t802 = t378 * t284;
  t806 = t557 * rho[0];
  t807 = 0.1e1 / t806;
  t811 = 0.35577104681874188845e-2 * t56 * t127 - 0.22235690426171368028e-2 * t792 * t793 + 0.18529742021809473357e-4 * t367 * t378 * t546 - 0.29398034574673402963e-3 * t56 * t131 + 0.24306874786510110244e-6 * t801 * t802 * t57 - 0.67778343112251663721e-14 * t277 * t807 * t562;
  t815 = t126 * t74;
  t832 = 0.63375e-1 * t25 * t468 * t141 - 0.52876992713345024472e-1 * t199 * t146 + 0.55555555555555555557e-1 * t56 * t126 - 0.81380208333333333333e-2 * t86 * t476 * t154;
  t835 = t480 * t20 * t36;
  t848 = t95 * t369;
  t851 = -t832;
  t853 = t486 * t112;
  t864 = t441 * t134;
  t867 = t193 * t383;
  t872 = t460 * t134;
  t877 = t832 * t76 - 0.243905525293907837e-1 * t835 * t163 + 0.18292914397043087775e-1 * t729 * t196 - 0.487811050587815674e-1 * t408 * t137 + 0.11098862923301700682e-2 * t733 * t416 - 0.20810367981190688778e-3 * t605 * t464 + 0.11098862923301700682e-2 * t327 * t815 - 0.77772687197516121301e-6 * t848 * t415 + t851 * t71 + 0.646416e0 * t853 * t134 + 0.1292832e1 * t719 * t193 - 0.2585664e1 * t761 * t426 + 0.1292832e1 * t421 * t383 - 0.1292832e1 * t625 * t441 + 0.3878496e1 * t630 * t864 - 0.2585664e1 * t337 * t867 + 0.646416e0 * t334 * t460 - 0.1292832e1 * t337 * t872 + 0.646416e0 * t168 * t811;
  t878 = my_piecewise3(t72, 0.11098862923301700682e-2 * t56 * t815 - 0.77772687197516121301e-6 * t369 * sigma[0] * t74, t877);
  t879 = my_piecewise3(t34, 0.3878496e1 * t782 * t134 - 0.2585664e1 * t355 * t383 - 0.1292832e1 * t787 * t134 + 0.646416e0 * t112 * t811, t878);
  t884 = my_piecewise3(t2, 0, -t6 * t107 * t496 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t879);
  tv3rhosigma20 = 0.2e1 * rho[0] * t884 + 0.2e1 * t500;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t887 = t441 * t193;
  t902 = 0.1e1 / t557;
  t906 = 0.50030303458885578063e-3 * t262 * t447 * t50 - 0.69486532581785525088e-5 * t446 * t455 * t546 - 0.54690468269647748049e-7 * t801 * t455 * t284 * sigma[0] + 0.25416878667094373895e-14 * t263 * t902 * t562;
  t912 = 0.1e1 / t87;
  t913 = t912 * t27;
  t919 = t199 * t38;
  t923 = 0.71296875e-1 * t25 * t913 * t30 - 0.6609624089168128059e-2 * t467 * t80 + 0.6103515625e-3 * t86 * t919 * t91;
  t932 = -t923;
  t942 = t193 * t460;
  t947 = t923 * t76 + 0.27439371595564631662e-1 * t835 * t196 - 0.62431103943572066335e-3 * t733 * t464 + 0.29164757699068545486e-6 * t95 * t447 * t74 + t932 * t71 + 0.1939248e1 * t853 * t193 - 0.3878496e1 * t761 * t441 + 0.1939248e1 * t421 * t460 + 0.3878496e1 * t630 * t887 - 0.3878496e1 * t337 * t942 + 0.646416e0 * t168 * t906;
  t948 = my_piecewise3(t72, 0.29164757699068545486e-6 * t447 * t74, t947);
  t949 = my_piecewise3(t34, 0.3878496e1 * t514 * t887 - 0.3878496e1 * t355 * t460 + 0.646416e0 * t112 * t906, t948);
  t953 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t949);
  tv3sigma30 = 0.2e1 * rho[0] * t953;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, tv2rho20, t355, t358, t362, t363;
  double t367, t368, t369, t375, t376, t378, t383, t405;
  double t408, t415, t416, t419, t421, t426, t432, t433;
  double t438, tv2rhosigma0, t441, t446, t447, t455, t457, t460;
  double t464, t467, t468, t476, t480, t486, t495, t496;
  double t500, tv2sigma20;

  double t503, t513, t514, t515, t518, t522, t524, t526;
  double t527, t531, t532, t536, t540, t541, t543, t545;
  double t546, t549, t553, t556, t557, t559, t562, t565;
  double t569, t580, t585, t592, t596, t599, t605, t609;
  double t613, t616, t617, t620, t622, t625, t630, t633;
  double t638, t639, t640, t645, tv3rho30, t655, t658, t663;
  double t667, t671, t672, t682, t684, t688, t713, t715;
  double t719, t729, t733, t743, t746, t751, t754, t757;
  double t758, t761, t768, t770, t771, t776, tv3rho2sigma0, t782;
  double t787, t792, t793, t801, t802, t806, t807, t811;
  double t815, t832, t835, t848, t851, t853, t864, t867;
  double t872, t877, t878, t879, t884, tv3rhosigma20, t887, t902;
  double t906, t912, t913, t919, t923, t932, t942, t947;
  double t948, t949, t953, tv3sigma30;

  double t970, t971, t977, t983, t985, t990, t991, t995;
  double t999, t1001, t1010, t1025, t1030, t1031, t1035, t1050;
  double t1051, t1057, t1070, t1071, t1075, t1079, t1096, t1100;
  double t1123, t1126, t1131, t1134, t1136, t1137, t1142, tv4rho40;
  double t1170, t1174, t1205, t1242, t1264, t1268, t1278, t1281;
  double t1282, t1293, t1330, t1332, t1333, t1338, tv4rho3sigma0, t1355;
  double t1398, t1434, t1446, t1450, t1459, t1462, t1473, t1527;
  double t1530, t1531, t1536, tv4rho2sigma20, t1560, t1582, t1602, t1607;
  double t1636, t1641, t1681, t1683, t1684, t1689, tv4rhosigma30, t1692;
  double t1697, t1724, t1753, t1782, t1783, t1784, t1788, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.8040e0 + 0.5e1 / 0.972e3 * t45 + 0.40024242767108462450e-2 * t47 * t51 + t67;
  t71 = 0.18040e1 - 0.64641600e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.11376190545424805830e-1 * t45);
  t76 = 0.18040e1 - 0.8040e0 * t74;
  t77 = 0.19012500000000000000e0 * t32;
  t78 = 0.19500000000000000000e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608000000000000000e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.14060800000000000000e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t105;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.10e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.25350000000000000000e0 * t25 * t28 * t141 + 0.52000000000000000000e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.24390552529390783700e-1 * t47 * t137, t158 * t76 - 0.24390552529390783700e-1 * t161 * t163 + t166 * t71 + 0.64641600e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.64641600e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.40024242767108462450e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.95062500000000000000e-1 * t25 * t200 * t30 - 0.19500000000000000000e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.64641600e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.64641600e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t229;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t234 = t17 / t41 / rho[0];
  t242 = 0.1e1 / t111 / t68;
  t243 = t134 * t134;
  t247 = 0.1e1 / t41 / t59;
  t249 = t37 * t39 * t247;
  t251 = t38 * t247;
  t252 = t251 * t50;
  t256 = 0.1e1 / t18 / t152;
  t257 = t27 * t256;
  t258 = t257 * t50;
  t261 = t22 * t22;
  t262 = 0.1e1 / t261;
  t263 = t57 * sigma[0];
  t264 = t262 * t263;
  t265 = t59 * t59;
  t266 = t265 * t40;
  t267 = 0.1e1 / t266;
  t271 = t257 * t130;
  t276 = t20 / t35 / t261;
  t277 = t57 * t57;
  t278 = t276 * t277;
  t279 = t265 * t59;
  t281 = 0.1e1 / t41 / t279;
  t283 = t66 * t66;
  t284 = 0.1e1 / t283;
  t285 = t38 * t281 * t284;
  t288 = 0.110e3 / 0.2187e4 * t249 + 0.39134815150061607728e-1 * t47 * t252 - 0.80048485534216924900e-2 * t123 * t258 + 0.11859034893958062948e-2 * t264 * t267 * t50 + 0.93093776153132442719e-3 * t123 * t271 - 0.12963666552805392131e-6 * t278 * t285;
  t292 = t251 * t74;
  t295 = t257 * t74;
  t300 = 0.1e1 / t18 / t113;
  t305 = 0.1e1 / t89;
  t312 = 0.1e1 / t41 / t265;
  t316 = 0.59150000000000000000e0 * t25 * t28 * t300 - 0.19066666666666666667e1 * t249 + 0.35251328475563349648e0 * t79 * t305 - 0.17592592592592592593e0 * t56 * t58 * t256 + 0.16637731481481481482e-1 * t86 * t88 * t312;
  t319 = t158 * t20 * t36;
  t323 = t39 * t247 * t74;
  t327 = t95 * t21 * t55;
  t329 = t58 * t256 * t74;
  t332 = -t316;
  t334 = t166 * t112;
  t337 = t97 * t242;
  t343 = my_piecewise3(t72, 0.89432025941099540233e-1 * t47 * t292 - 0.14798483897735600909e-2 * t123 * t295, t316 * t76 - 0.48781105058781567400e-1 * t319 * t163 + 0.89432025941099540233e-1 * t161 * t323 - 0.14798483897735600909e-2 * t327 * t329 + t332 * t71 + 0.129283200e1 * t334 * t134 - 0.129283200e1 * t337 * t243 + 0.64641600e0 * t168 * t288);
  t344 = my_piecewise3(t34, -0.129283200e1 * t242 * t243 + 0.64641600e0 * t112 * t288, t343);
  t349 = my_piecewise3(t2, 0, t6 * t234 * t101 / 0.12e2 - t6 * t107 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t344);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t349 + 0.4e1 * t178;

  t355 = t242 * t193;
  t358 = t37 * t119;
  t362 = t56 * t27;
  t363 = t125 * sigma[0];
  t367 = t262 * t57;
  t368 = t265 * rho[0];
  t369 = 0.1e1 / t368;
  t375 = t276 * t263;
  t376 = t265 * t113;
  t378 = 0.1e1 / t41 / t376;
  t383 = -0.10e2 / 0.729e3 * t358 - 0.10673131404562256653e-1 * t37 * t120 + 0.26682828511405641633e-2 * t362 * t363 * t50 - 0.44471380852342736056e-3 * t367 * t369 * t50 - 0.29398034574673402963e-3 * t185 * t131 + 0.48613749573020220489e-7 * t375 * t38 * t378 * t284;
  t405 = -0.12675000000000000000e0 * t25 * t200 * t141 + 0.52000000000000000000e0 * t358 - 0.10575398542669004894e0 * t26 * t146 + 0.55555555555555555557e-1 * t56 * t207 * t125 - 0.54253472222222222223e-2 * t86 * t211 * t154;
  t408 = t215 * t20 * t36;
  t415 = sigma[0] * t74;
  t416 = t126 * t415;
  t419 = -t405;
  t421 = t219 * t112;
  t426 = t193 * t134;
  t432 = my_piecewise3(t72, -0.24390552529390783699e-1 * t37 * t137 + 0.55494314616508503409e-3 * t362 * t363 * t74, t405 * t76 - 0.24390552529390783700e-1 * t408 * t163 + 0.91464571985215438873e-2 * t319 * t196 - 0.24390552529390783699e-1 * t161 * t137 + 0.55494314616508503409e-3 * t327 * t416 + t419 * t71 + 0.64641600e0 * t421 * t134 + 0.64641600e0 * t334 * t193 - 0.129283200e1 * t337 * t426 + 0.64641600e0 * t168 * t383);
  t433 = my_piecewise3(t34, -0.129283200e1 * t355 * t134 + 0.64641600e0 * t112 * t383, t432);
  t438 = my_piecewise3(t2, 0, -t6 * t107 * t225 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t433);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t438 + 0.2e1 * t229;

  t441 = t193 * t193;
  t446 = t262 * sigma[0];
  t447 = 0.1e1 / t265;
  t455 = 0.1e1 / t41 / t266;
  t457 = t38 * t455 * t284;
  t460 = -0.66707071278514104084e-3 * t56 * t187 + 0.16676767819628526021e-3 * t446 * t447 * t50 + 0.55121314827512630556e-4 * t56 * t190 - 0.18230156089882582683e-7 * t276 * t57 * t457;
  t464 = t186 * t74;
  t467 = 0.1e1 / t79;
  t468 = t467 * t27;
  t476 = t26 * t38;
  t480 = -0.47531250000000000000e-1 * t25 * t468 * t30 + 0.13219248178336256118e-1 * t199 * t80 - 0.10416666666666666667e-1 * t56 * t186 + 0.12207031250000000000e-2 * t86 * t476 * t91;
  t486 = -t480;
  t495 = my_piecewise3(t72, -0.20810367981190688778e-3 * t56 * t464, t480 * t76 + 0.18292914397043087775e-1 * t408 * t196 - 0.20810367981190688778e-3 * t327 * t464 + t486 * t71 + 0.129283200e1 * t421 * t193 - 0.129283200e1 * t337 * t441 + 0.64641600e0 * t168 * t460);
  t496 = my_piecewise3(t34, -0.129283200e1 * t242 * t441 + 0.64641600e0 * t112 * t460, t495);
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t496);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t500;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


  t503 = t17 * t43;
  t513 = t111 * t111;
  t514 = 0.1e1 / t513;
  t515 = t243 * t134;
  t518 = t242 * t134;
  t522 = 0.1e1 / t41 / t60;
  t524 = t37 * t39 * t522;
  t526 = t38 * t522;
  t527 = t526 * t50;
  t531 = 0.1e1 / t18 / t265;
  t532 = t27 * t531;
  t536 = 0.1e1 / t376;
  t540 = t262 * t277;
  t541 = t265 * t60;
  t543 = 0.1e1 / t41 / t541;
  t545 = t38 * t50;
  t546 = t37 * t545;
  t549 = t532 * t130;
  t553 = t38 * t543 * t284;
  t556 = t277 * t57;
  t557 = t265 * t265;
  t559 = 0.1e1 / t557 / t113;
  t562 = 0.1e1 / t283 / t66;
  t565 = -0.1540e4 / 0.6561e4 * t524 - 0.18262913736695416940e0 * t47 * t527 + 0.67398848313994991088e-1 * t123 * t532 * t50 - 0.22532166298520319601e-1 * t264 * t536 * t50 + 0.13176705437731181053e-3 * t540 * t543 * t546 - 0.68268769178963791327e-2 * t123 * t549 + 0.24630966450330245049e-5 * t278 * t553 - 0.48197932879823405316e-13 * t556 * t559 * t562;
  t569 = t526 * t74;
  t580 = 0.1e1 / t18 / t59;
  t585 = 0.1e1 / t152;
  t592 = 0.1e1 / t41 / t368;
  t596 = -0.19716666666666666667e1 * t25 * t28 * t580 + 0.88977777777777777779e1 * t524 - 0.21150797085338009789e1 * t79 * t585 + 0.12901234567901234568e1 * t56 * t58 * t531 - 0.14419367283950617284e0 * t86 * t88 * t592;
  t599 = t316 * t20 * t36;
  t605 = t158 * t21 * t55;
  t609 = t39 * t522 * t74;
  t613 = t58 * t531 * t74;
  t616 = t95 * t263;
  t617 = t536 * t74;
  t620 = -t596;
  t622 = t332 * t112;
  t625 = t166 * t242;
  t630 = t97 * t514;
  t633 = t134 * t288;
  t638 = t596 * t76 - 0.73171657588172351100e-1 * t599 * t163 + 0.26829607782329862070e0 * t319 * t323 - 0.44395451693206802728e-2 * t605 * t329 - 0.41734945439179785442e0 * t161 * t609 + 0.16278332287509161000e-1 * t327 * t613 - 0.55305022007122575148e-5 * t616 * t617 + t620 * t71 + 0.193924800e1 * t622 * t134 - 0.387849600e1 * t625 * t243 + 0.193924800e1 * t334 * t288 + 0.387849600e1 * t630 * t515 - 0.387849600e1 * t337 * t633 + 0.64641600e0 * t168 * t565;
  t639 = my_piecewise3(t72, -0.41734945439179785442e0 * t47 * t569 + 0.16278332287509161000e-1 * t123 * t532 * t74 - 0.55305022007122575148e-5 * t263 * t536 * t74, t638);
  t640 = my_piecewise3(t34, 0.387849600e1 * t514 * t515 - 0.387849600e1 * t518 * t288 + 0.64641600e0 * t112 * t565, t639);
  t645 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t101 + t6 * t234 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t344 - 0.3e1 / 0.8e1 * t6 * t19 * t640);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho3[0] = 0.2e1 * rho[0] * t645 + 0.6e1 * t349;

  t655 = t514 * t193;
  t658 = t242 * t383;
  t663 = t37 * t251;
  t667 = t256 * sigma[0];
  t671 = t262 * t267;
  t672 = t57 * t50;
  t682 = t277 * sigma[0];
  t684 = 0.1e1 / t557 / t40;
  t688 = 0.11e3 / 0.2187e4 * t663 + 0.39134815150061607728e-1 * t37 * t252 - 0.19270931702681852291e-1 * t362 * t667 * t50 + 0.75601347448982651294e-2 * t671 * t672 - 0.49412645391491928951e-4 * t264 * t281 * t546 + 0.18618755230626488543e-2 * t185 * t271 - 0.82643374274134374831e-6 * t375 * t285 + 0.18074224829933776993e-13 * t682 * t684 * t562;
  t713 = -0.29575e0 * t25 * t200 * t300 + 0.19066666666666666667e1 * t663 - 0.5287699271334502447e0 * t26 * t305 + 0.35185185185185185186e0 * t56 * t207 * t256 - 0.41594328703703703704e-1 * t86 * t211 * t312;
  t715 = -t713;
  t719 = t419 * t112;
  t729 = t405 * t20 * t36;
  t733 = t215 * t21 * t55;
  t743 = t257 * t415;
  t746 = t193 * t243;
  t751 = t383 * t134;
  t754 = t193 * t288;
  t757 = t95 * t267;
  t758 = t57 * t74;
  t761 = t219 * t242;
  t768 = 0.11098862923301700682e-2 * t605 * t416 + 0.8943202594109954023e-1 * t161 * t292 - 0.49944883154857653068e-2 * t327 * t743 + 0.3878496e1 * t630 * t746 + 0.91464571985215438873e-2 * t599 * t196 - 0.2585664e1 * t337 * t751 - 0.1292832e1 * t337 * t754 + 0.20739383252670965681e-5 * t757 * t758 - 0.1292832e1 * t761 * t243 - 0.2585664e1 * t625 * t426 + 0.89432025941099540233e-1 * t408 * t323;
  t770 = my_piecewise3(t72, 0.8943202594109954023e-1 * t37 * t292 - 0.49944883154857653068e-2 * t362 * t667 * t74 + 0.20739383252670965681e-5 * t267 * t57 * t74, t713 * t71 + t715 * t76 + 0.646416e0 * t168 * t688 + 0.1292832e1 * t719 * t134 + 0.646416e0 * t421 * t288 + 0.646416e0 * t622 * t193 + 0.1292832e1 * t334 * t383 - 0.487811050587815674e-1 * t729 * t163 - 0.14798483897735600909e-2 * t733 * t329 - 0.48781105058781567398e-1 * t319 * t137 + t768);
  t771 = my_piecewise3(t34, 0.3878496e1 * t655 * t243 - 0.2585664e1 * t658 * t134 - 0.1292832e1 * t355 * t288 + 0.646416e0 * t112 * t688, t770);
  t776 = my_piecewise3(t2, 0, t6 * t234 * t225 / 0.12e2 - t6 * t107 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t771);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rho2sigma[0] = 0.2e1 * rho[0] * t776 + 0.4e1 * t438;

  t782 = t514 * t441;
  t787 = t242 * t460;
  t792 = t262 * t369;
  t793 = sigma[0] * t50;
  t801 = t276 * t38;
  t802 = t378 * t284;
  t806 = t557 * rho[0];
  t807 = 0.1e1 / t806;
  t811 = 0.35577104681874188845e-2 * t56 * t127 - 0.22235690426171368028e-2 * t792 * t793 + 0.18529742021809473357e-4 * t367 * t378 * t546 - 0.29398034574673402963e-3 * t56 * t131 + 0.24306874786510110244e-6 * t801 * t802 * t57 - 0.67778343112251663721e-14 * t277 * t807 * t562;
  t815 = t126 * t74;
  t832 = 0.63375000000000000000e-1 * t25 * t468 * t141 - 0.52876992713345024472e-1 * t199 * t146 + 0.55555555555555555557e-1 * t56 * t126 - 0.81380208333333333333e-2 * t86 * t476 * t154;
  t835 = t480 * t20 * t36;
  t848 = t95 * t369;
  t851 = -t832;
  t853 = t486 * t112;
  t864 = t441 * t134;
  t867 = t193 * t383;
  t872 = t460 * t134;
  t877 = t832 * t76 - 0.243905525293907837e-1 * t835 * t163 + 0.18292914397043087775e-1 * t729 * t196 - 0.487811050587815674e-1 * t408 * t137 + 0.11098862923301700682e-2 * t733 * t416 - 0.20810367981190688778e-3 * t605 * t464 + 0.11098862923301700682e-2 * t327 * t815 - 0.77772687197516121301e-6 * t848 * t415 + t851 * t71 + 0.646416e0 * t853 * t134 + 0.1292832e1 * t719 * t193 - 0.2585664e1 * t761 * t426 + 0.1292832e1 * t421 * t383 - 0.1292832e1 * t625 * t441 + 0.3878496e1 * t630 * t864 - 0.2585664e1 * t337 * t867 + 0.646416e0 * t334 * t460 - 0.1292832e1 * t337 * t872 + 0.646416e0 * t168 * t811;
  t878 = my_piecewise3(t72, 0.11098862923301700682e-2 * t56 * t815 - 0.77772687197516121301e-6 * t369 * sigma[0] * t74, t877);
  t879 = my_piecewise3(t34, 0.387849600e1 * t782 * t134 - 0.258566400e1 * t355 * t383 - 0.129283200e1 * t787 * t134 + 0.64641600e0 * t112 * t811, t878);
  t884 = my_piecewise3(t2, 0, -t6 * t107 * t496 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t879);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3rhosigma2[0] = 0.2e1 * rho[0] * t884 + 0.2e1 * t500;

  t887 = t441 * t193;
  t902 = 0.1e1 / t557;
  t906 = 0.50030303458885578063e-3 * t262 * t447 * t50 - 0.69486532581785525088e-5 * t446 * t455 * t546 - 0.54690468269647748049e-7 * t801 * t455 * t284 * sigma[0] + 0.25416878667094373895e-14 * t263 * t902 * t562;
  t912 = 0.1e1 / t87;
  t913 = t912 * t27;
  t919 = t199 * t38;
  t923 = 0.71296875000000000000e-1 * t25 * t913 * t30 - 0.66096240891681280590e-2 * t467 * t80 + 0.61035156250000000000e-3 * t86 * t919 * t91;
  t932 = -t923;
  t942 = t193 * t460;
  t947 = t923 * t76 + 0.27439371595564631662e-1 * t835 * t196 - 0.62431103943572066335e-3 * t733 * t464 + 0.29164757699068545486e-6 * t95 * t447 * t74 + t932 * t71 + 0.1939248e1 * t853 * t193 - 0.3878496e1 * t761 * t441 + 0.1939248e1 * t421 * t460 + 0.3878496e1 * t630 * t887 - 0.3878496e1 * t337 * t942 + 0.646416e0 * t168 * t906;
  t948 = my_piecewise3(t72, 0.29164757699068545486e-6 * t447 * t74, t947);
  t949 = my_piecewise3(t34, 0.387849600e1 * t514 * t887 - 0.387849600e1 * t355 * t460 + 0.64641600e0 * t112 * t906, t948);
  t953 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t949);
  if(v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    v3sigma3[0] = 0.2e1 * rho[0] * t953;

#ifndef XC_DONT_COMPILE_LXC

  if(order < 4) return;


  t970 = 0.1e1 / t513 / t68;
  t971 = t243 * t243;
  t977 = t288 * t288;
  t983 = t37 * t39 * t91;
  t985 = t38 * t91;
  t990 = 0.1e1 / t18 / t368;
  t991 = t27 * t990;
  t995 = 0.1e1 / t279;
  t999 = t265 * t89;
  t1001 = 0.1e1 / t41 / t999;
  t1010 = t56 * t27 * t50;
  t1025 = t277 * t277;
  t1030 = t283 * t283;
  t1031 = 0.1e1 / t1030;
  t1035 = 0.26180e5 / 0.19683e5 * t983 + 0.10348984450794069599e1 * t47 * t985 * t50 - 0.60224132203150363004e0 * t123 * t991 * t50 + 0.33771896036905017039e0 * t264 * t995 * t50 - 0.43043904429921858107e-2 * t540 * t1001 * t546 + 0.29281567639402624562e-4 * t262 * t682 / t18 / t806 * t1010 + 0.56890640982469826106e-1 * t123 * t991 * t130 - 0.39683223725532061467e-4 * t278 * t38 * t1001 * t284 + 0.18315214494332894020e-11 * t556 / t557 / t59 * t562 - 0.21253867458432547310e-16 * t1025 / t18 / t557 / t368 * t1031 * t362;
  t1050 = t36 * t38;
  t1051 = t1050 * t74;
  t1057 = t620 * t112;
  t1070 = t38 * t74;
  t1071 = t37 * t1070;
  t1075 = t596 * t20 * t36;
  t1079 = t316 * t21 * t55;
  t1096 = -0.8543888888888888889e1 * t25 * t28 * t62 + 0.50420740740740740741e2 * t983 - 0.14805557959736606852e2 * t79 * t447 + 0.1075102880658436214e2 * t56 * t58 * t990 - 0.13938721707818930041e1 * t86 * t88 * t455;
  t1100 = 0.646416e0 * t168 * t1035 + 0.2585664e1 * t1057 * t134 + 0.3878496e1 * t622 * t288 + 0.2585664e1 * t334 * t565 - 0.16097461928759059212e0 * t327 * t58 * t990 * t74 - 0.16777612492585030876e-6 * t95 * t277 * t1001 * t1071 - 0.975622101175631348e-1 * t1075 * t163 - 0.88790903386413605456e-2 * t1079 * t329 + 0.65113329150036644001e-1 * t605 * t613 + t1096 * t71 - t1096 * t76;
  t1123 = t332 * t242;
  t1126 = t166 * t514;
  t1131 = t97 * t970;
  t1134 = 0.2364980241553521175e1 * t161 * t39 * t91 * t74 + 0.5365921556465972414e0 * t599 * t323 - 0.16693978175671914177e1 * t319 * t609 + 0.23270976e2 * t630 * t243 * t288 - 0.3878496e1 * t337 * t977 - 0.5171328e1 * t337 * t134 * t565 - 0.2212200880284903006e-4 * t158 * t263 * t617 + 0.12167104841566966533e-3 * t616 * t995 * t74 - 0.7756992e1 * t1123 * t243 + 0.15513984e2 * t1126 * t515 - 0.15513984e2 * t625 * t633 - 0.15513984e2 * t1131 * t971;
  t1136 = my_piecewise3(t72, 0.2364980241553521175e1 * t47 * t985 * t74 - 0.16097461928759059212e0 * t123 * t991 * t74 + 0.12167104841566966533e-3 * t263 * t995 * t74 - 0.16777612492585030876e-6 * t277 * t1001 * t20 * t1051, t1100 + t1134);
  t1137 = my_piecewise3(t34, -0.15513984e2 * t970 * t971 + 0.23270976e2 * t514 * t243 * t288 - 0.3878496e1 * t242 * t977 - 0.5171328e1 * t518 * t565 + 0.646416e0 * t112 * t1035, t1136);
  t1142 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t115 * t101 - 0.5e1 / 0.9e1 * t6 * t503 * t173 + t6 * t234 * t344 / 0.2e1 - t6 * t107 * t640 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1137);
  tv4rho40 = 0.2e1 * rho[0] * t1142 + 0.8e1 * t645;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1170 = t37 * t526;
  t1174 = t531 * sigma[0];
  t1205 = -0.154e4 / 0.6561e4 * t1170 - 0.1826291373669541694e0 * t37 * t527 + 0.1500167914085694963e0 * t362 * t1174 * t50 - 0.10129592305255845435e0 * t262 * t536 * t672 + 0.14659084799475938922e-2 * t262 * t543 * t263 * t546 - 0.10980587864775984211e-4 * t540 / t18 / t557 * t1010 - 0.13653753835792758265e-1 * t185 * t549 + 0.12110225171412370482e-4 * t375 * t553 - 0.63259786904768219474e-12 * t682 * t559 * t562 + 0.79702002969122052411e-17 * t277 * t263 / t18 / t557 / t265 * t1031 * t362;
  t1242 = 0.98583333333333333333e0 * t25 * t200 * t580 - 0.88977777777777777779e1 * t1170 + 0.31726195628007014682e1 * t26 * t585 - 0.25802469135802469136e1 * t56 * t207 * t531 + 0.3604841820987654321e0 * t86 * t211 * t592;
  t1264 = t405 * t21 * t55;
  t1268 = t715 * t20 * t36;
  t1278 = t219 * t514;
  t1281 = -0.73171657588172351097e-1 * t599 * t137 + 0.26829607782329862069e0 * t319 * t292 - 0.41734945439179785441e0 * t161 * t569 + 0.91464571985215438873e-2 * t1075 * t196 + t1242 * t71 - t1242 * t76 - 0.41734945439179785442e0 * t408 * t609 + 0.2682960778232986207e0 * t729 * t323 + 0.16278332287509161e-1 * t733 * t613 + 0.62916046847193865785e-7 * t95 * t543 * t263 * t1071 - 0.1498346494645729592e-1 * t605 * t743 + 0.16648294384952551023e-2 * t1079 * t416 + 0.42052358409398665917e-1 * t327 * t532 * t415 - 0.44395451693206802728e-2 * t1264 * t329 - 0.731716575881723511e-1 * t1268 * t163 + 0.11635488e2 * t630 * t426 * t288 + 0.1939248e1 * t334 * t688 + 0.646416e0 * t168 * t1205 + 0.3878496e1 * t1278 * t515;
  t1282 = t419 * t242;
  t1293 = t713 * t112;
  t1330 = -0.3878496e1 * t1282 * t243 + 0.1939248e1 * t719 * t288 + 0.646416e0 * t421 * t565 + 0.646416e0 * t1057 * t193 + 0.1939248e1 * t622 * t383 + 0.1939248e1 * t1293 * t134 - 0.3878496e1 * t337 * t688 * t134 - 0.3878496e1 * t761 * t633 - 0.3878496e1 * t1123 * t426 - 0.7756992e1 * t625 * t751 - 0.55305022007122575148e-5 * t215 * t263 * t617 + 0.62218149758012897043e-5 * t158 * t267 * t758 - 0.39404828180074834793e-4 * t95 * t536 * t758 + 0.11635488e2 * t1126 * t746 + 0.11635488e2 * t630 * t383 * t243 - 0.3878496e1 * t337 * t383 * t288 - 0.3878496e1 * t625 * t754 - 0.1292832e1 * t337 * t193 * t565 - 0.15513984e2 * t1131 * t193 * t515;
  t1332 = my_piecewise3(t72, -0.41734945439179785441e0 * t37 * t569 + 0.42052358409398665917e-1 * t362 * t1174 * t74 - 0.39404828180074834793e-4 * t536 * t57 * t74 + 0.62916046847193865785e-7 * t543 * t263 * t20 * t1051, t1281 + t1330);
  t1333 = my_piecewise3(t34, -0.15513984e2 * t970 * t193 * t515 + 0.11635488e2 * t514 * t383 * t243 + 0.11635488e2 * t655 * t633 - 0.3878496e1 * t242 * t688 * t134 - 0.3878496e1 * t658 * t288 - 0.1292832e1 * t355 * t565 + 0.646416e0 * t112 * t1205, t1332);
  t1338 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t225 + t6 * t234 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t771 - 0.3e1 / 0.8e1 * t6 * t19 * t1333);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho3sigma[0] = 0.2e1 * rho[0] * t1338 + 0.6e1 * t776;

  t1355 = t383 * t383;
  t1398 = -0.22532166298520319602e-1 * t56 * t258 + 0.24755735341137456404e-1 * t671 * t793 - 0.46324355054523683393e-3 * t262 * t281 * t57 * t546 + 0.41177204492909940793e-5 * t264 / t18 / t265 / t152 * t1010 + 0.18618755230626488543e-2 * t56 * t271 - 0.30950753894822873711e-5 * t801 * t281 * t284 * t57 + 0.20559430744049671329e-12 * t684 * t562 * t277 - 0.29888251113420769653e-17 * t556 / t18 / t557 / t152 * t1031 * t362;
  t1434 = 0.147875e0 * t25 * t468 * t300 - 0.26438496356672512236e0 * t199 * t305 + 0.35185185185185185186e0 * t56 * t257 - 0.62391493055555555555e-1 * t86 * t476 * t312;
  t1446 = t832 * t20 * t36;
  t1450 = t480 * t21 * t55;
  t1459 = t486 * t242;
  t1462 = t851 * t112;
  t1473 = -0.487811050587815674e-1 * t1446 * t163 - 0.14798483897735600909e-2 * t1450 * t329 + 0.22197725846603401364e-2 * t1264 * t416 + 0.89432025941099540233e-1 * t835 * t323 - 0.2585664e1 * t337 * t1355 - 0.1292832e1 * t1459 * t243 + 0.1292832e1 * t1462 * t134 + 0.646416e0 * t853 * t288 + 0.1292832e1 * t1293 * t193 + 0.2585664e1 * t719 * t383 + 0.646416e0 * t168 * t1398;
  t1527 = 0.41478766505341931362e-5 * t215 * t267 * t758 - 0.1555453743950322426e-5 * t158 * t369 * t415 + 0.11147418498310644053e-4 * t757 * t415 - 0.5171328e1 * t1282 * t426 + 0.3878496e1 * t630 * t460 * t243 - 0.15513984e2 * t1131 * t441 * t243 + 0.7756992e1 * t1278 * t746 - 0.2585664e1 * t337 * t811 * t134 - 0.1292832e1 * t337 * t460 * t288 - 0.5171328e1 * t761 * t751 + 0.15513984e2 * t630 * t426 * t383;
  t1530 = my_piecewise3(t72, -0.70292798514244104319e-2 * t56 * t295 + 0.11147418498310644053e-4 * t267 * sigma[0] * t74 - 0.23593517567697699669e-7 * t281 * t57 * t20 * t1051, -0.975622101175631348e-1 * t729 * t137 + 0.18292914397043087775e-1 * t1268 * t196 - 0.20810367981190688778e-3 * t1079 * t464 + 0.17886405188219908047e0 * t408 * t292 + 0.22197725846603401364e-2 * t605 * t815 - 0.70292798514244104319e-2 * t327 * t295 + t1434 * t71 - t1434 * t76 - 0.99889766309715306138e-2 * t733 * t743 - 0.23593517567697699669e-7 * t95 * t281 * t57 * t1071 + t1473 + 0.646416e0 * t622 * t460 + 0.1292832e1 * t334 * t811 + 0.1292832e1 * t421 * t688 - 0.1292832e1 * t1123 * t441 - 0.2585664e1 * t761 * t754 + 0.7756992e1 * t1126 * t864 - 0.5171328e1 * t625 * t867 + 0.3878496e1 * t630 * t441 * t288 - 0.2585664e1 * t337 * t193 * t688 - 0.2585664e1 * t625 * t872 + t1527);
  t1531 = my_piecewise3(t34, -0.15513984e2 * t970 * t441 * t243 + 0.15513984e2 * t655 * t751 + 0.3878496e1 * t782 * t288 - 0.2585664e1 * t242 * t1355 - 0.2585664e1 * t355 * t688 + 0.3878496e1 * t514 * t460 * t243 - 0.2585664e1 * t242 * t811 * t134 - 0.1292832e1 * t787 * t288 + 0.646416e0 * t112 * t1398, t1530);
  t1536 = my_piecewise3(t2, 0, t6 * t234 * t496 / 0.12e2 - t6 * t107 * t879 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1531);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rho2sigma2[0] = 0.2e1 * rho[0] * t1536 + 0.4e1 * t884;

  t1560 = t36 * sigma[0];
  t1582 = -0.4002424276710846245e-2 * t792 * t50 + 0.1297081941526663135e-3 * t262 * t378 * t20 * t1560 * t545 - 0.15441451684841227797e-5 * t367 / t18 / t999 * t1010 + 0.58336499487624264586e-6 * t801 * t802 * sigma[0] - 0.61000508801026497348e-13 * t807 * t562 * t263 + 0.1120809416753278862e-17 * t682 / t18 / t557 / t89 * t1031 * t362;
  t1602 = 0.950625e-1 * t25 * t913 * t141 - 0.26438496356672512236e-1 * t467 * t146 + 0.40690104166666666667e-2 * t86 * t919 * t154;
  t1607 = t923 * t20 * t36;
  t1636 = t932 * t112;
  t1641 = t1602 * t71 - t1602 * t76 - 0.243905525293907837e-1 * t1607 * t163 + 0.16648294384952551023e-2 * t1450 * t416 + 0.88475690878866373752e-8 * t95 * t378 * t20 * t1560 * t1070 + 0.646416e0 * t334 * t906 + 0.646416e0 * t168 * t1582 + 0.1939248e1 * t1462 * t193 + 0.1939248e1 * t853 * t383 - 0.3878496e1 * t1282 * t441 + 0.1939248e1 * t719 * t460 + 0.1939248e1 * t421 * t811 + 0.3878496e1 * t1126 * t887 + 0.29164757699068545486e-6 * t158 * t447 * t74 + 0.646416e0 * t1636 * t134 - 0.23331806159254836389e-5 * t848 * t74;
  t1681 = -0.3878496e1 * t1459 * t426 + 0.11635488e2 * t1278 * t864 - 0.7756992e1 * t761 * t867 - 0.3878496e1 * t761 * t872 - 0.15513984e2 * t1131 * t887 * t134 + 0.11635488e2 * t630 * t441 * t383 - 0.3878496e1 * t625 * t942 - 0.3878496e1 * t337 * t383 * t460 - 0.3878496e1 * t337 * t193 * t811 + 0.11635488e2 * t630 * t942 * t134 + 0.33296588769905102045e-2 * t733 * t815 + 0.27439371595564631662e-1 * t1446 * t196 - 0.62431103943572066335e-3 * t1264 * t464 - 0.73171657588172351099e-1 * t835 * t137 - 0.1292832e1 * t337 * t906 * t134 - 0.23331806159254836391e-5 * t215 * t369 * t415;
  t1683 = my_piecewise3(t72, -0.23331806159254836389e-5 * t369 * t74 + 0.88475690878866373752e-8 * t378 * t20 * t36 * t39 * t74, t1641 + t1681);
  t1684 = my_piecewise3(t34, -0.15513984e2 * t970 * t887 * t134 + 0.11635488e2 * t782 * t383 + 0.11635488e2 * t655 * t872 - 0.3878496e1 * t658 * t460 - 0.3878496e1 * t355 * t811 - 0.1292832e1 * t242 * t906 * t134 + 0.646416e0 * t112 * t1582, t1683);
  t1689 = my_piecewise3(t2, 0, -t6 * t107 * t949 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1684);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4rhosigma3[0] = 0.2e1 * rho[0] * t1689 + 0.2e1 * t953;

  t1692 = t441 * t441;
  t1697 = t460 * t460;
  t1724 = -0.27794613032714210035e-4 * t262 * t455 * t20 * t1050 * t50 + 0.5790544381815460424e-6 * t446 / t18 / t541 * t1010 + 0.15250127200256624337e-13 * t902 * t562 * t57 - 0.54690468269647748049e-7 * t276 * t457 - 0.42030353128247957323e-18 * t277 / t18 / t557 / t60 * t1031 * t362;
  t1753 = 0.1782421875e0 * t25 / t26 / t263 * t27 * t30 - 0.99144361337521920885e-2 * t912 * t80 + 0.30517578125e-3 * t86 * t467 * t38 * t91;
  t1782 = 0.646416e0 * t168 * t1724 + 0.36585828794086175549e-1 * t1607 * t196 - 0.12486220788714413267e-2 * t1450 * t464 - 0.33178384079574890157e-8 * t95 * t455 * t20 * t1051 + t1753 * t71 - t1753 * t76 + 0.11665903079627418195e-5 * t215 * t447 * t74 + 0.2585664e1 * t1636 * t193 + 0.3878496e1 * t853 * t460 + 0.2585664e1 * t421 * t906 - 0.3878496e1 * t337 * t1697 - 0.5171328e1 * t337 * t193 * t906 - 0.7756992e1 * t1459 * t441 + 0.15513984e2 * t1278 * t887 - 0.15513984e2 * t761 * t942 - 0.15513984e2 * t1131 * t1692 + 0.23270976e2 * t630 * t441 * t460;
  t1783 = my_piecewise3(t72, -0.33178384079574890157e-8 * t455 * t20 * t1051, t1782);
  t1784 = my_piecewise3(t34, -0.1551398400e2 * t970 * t1692 + 0.2327097600e2 * t782 * t460 - 0.387849600e1 * t242 * t1697 - 0.517132800e1 * t355 * t906 + 0.64641600e0 * t112 * t1724, t1783);
  t1788 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1784);
  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[0] = 0.2e1 * rho[0] * t1788;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;


#endif

#endif

#endif

#endif

#endif


}

static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t53;
  double t58, t59, t60, t61, t62, t64, t66, t68;
  double t69, t70, t73, t74, t76, t78, t79, t80;
  double t81, t82, t84, t85, t88, t89, t90, t92;
  double t95, t96, t98, t101, t102, t106, t107, t108;
  double t110, t111, t112, t113, t115, t116, t117, t118;
  double t120, t122, t123, t124, t125, t126, t128, t129;
  double t130, t133, t137, t138, t139, t141, t143, t145;
  double t146, t147, t150, t151, t153, t155, t156, t157;
  double t158, t159, t161, t162, t163, t164, t166, t169;
  double t170, t172, t175, t176, t180, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = -t16;
  t110 = my_piecewise5(t14, t11, t10, t15, t108 * t7);
  t111 = 0.1e1 + t110;
  t112 = t111 <= p->zeta_threshold;
  t113 = POW_1_3(t111);
  t115 = my_piecewise3(t112, t22, t113 * t111);
  t116 = t115 * t26;
  t117 = sqrt(sigma[2]);
  t118 = POW_1_3(rho[1]);
  t120 = 0.1e1 / t118 / rho[1];
  t122 = t33 * t117 * t120;
  t123 = t122 / 0.12e2;
  t124 = t123 < 0.6e0;
  t125 = rho[1] * rho[1];
  t126 = t118 * t118;
  t128 = 0.1e1 / t126 / t125;
  t129 = sigma[2] * t128;
  t130 = t44 * t129;
  t133 = exp(-t130 / 0.24e2);
  t137 = sigma[2] * sigma[2];
  t138 = t125 * t125;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t118 / t139;
  t143 = t59 * t137 * t141;
  t145 = 0.1e1 + 0.13780328706878157639e-4 * t143;
  t146 = log(t145);
  t147 = 0.804e0 + 0.5e1 / 0.972e3 * t130 + 0.4002424276710846245e-2 * t44 * t129 * t133 + t146;
  t150 = 0.1804e1 - 0.646416e0 / t147;
  t151 = 0.26e1 < t123;
  t153 = exp(-0.1137619054542480583e-1 * t130);
  t155 = 0.1804e1 - 0.804e0 * t153;
  t156 = 0.190125e0 * t122;
  t157 = 0.195e0 * t130;
  t158 = t117 * sigma[2];
  t159 = 0.1e1 / t138;
  t161 = 0.88128321188908374119e-2 * t158 * t159;
  t162 = 0.26041666666666666667e-2 * t143;
  t163 = t117 * t137;
  t164 = t138 * t125;
  t166 = 0.1e1 / t126 / t164;
  t169 = 0.16276041666666666667e-3 * t88 * t163 * t166;
  t170 = -0.40608e0 + t156 - t157 + t161 - t162 + t169;
  t172 = 0.140608e1 - t156 + t157 - t161 + t162 - t169;
  t175 = my_piecewise3(t151, t155, t172 * t150 + t170 * t155);
  t176 = my_piecewise3(t124, t150, t175);
  t180 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t176);
  tzk0 = t106 + t180;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t53;
  double t58, t59, t60, t61, t62, t64, t66, t68;
  double t69, t70, t73, t74, t76, t78, t79, t80;
  double t81, t82, t84, t85, t88, t89, t90, t92;
  double t95, t96, t98, t101, t102, t106, t107, t108;
  double t110, t111, t112, t113, t115, t116, t117, t118;
  double t120, t122, t123, t124, t125, t126, t128, t129;
  double t130, t133, t137, t138, t139, t141, t143, t145;
  double t146, t147, t150, t151, t153, t155, t156, t157;
  double t158, t159, t161, t162, t163, t164, t166, t169;
  double t170, t172, t175, t176, t180, tzk0;

  double t181, t182, t183, t185, t188, t189, t193, t194;
  double t195, t198, t199, t200, t201, t203, t204, t205;
  double t211, t212, t216, t220, t223, t227, t232, t237;
  double t239, t243, t245, t246, t249, t251, t255, t256;
  double t261, t262, t264, t267, t268, t272, t275, t277;
  double tvrho0, t281, t284, t285, t290, t292, t295, t296;
  double t300, t301, t302, t304, t305, t306, t312, t313;
  double t317, t321, t324, t328, t333, t338, t340, t344;
  double t346, t347, t350, t352, t356, t357, t362, tvrho1;
  double t365, t370, t377, t383, t395, t398, t401, t406;
  double t407, t411, tvsigma0, tvsigma1, t412, t417, t424, t430;
  double t442, t445, t448, t453, t454, t458, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = -t16;
  t110 = my_piecewise5(t14, t11, t10, t15, t108 * t7);
  t111 = 0.1e1 + t110;
  t112 = t111 <= p->zeta_threshold;
  t113 = POW_1_3(t111);
  t115 = my_piecewise3(t112, t22, t113 * t111);
  t116 = t115 * t26;
  t117 = sqrt(sigma[2]);
  t118 = POW_1_3(rho[1]);
  t120 = 0.1e1 / t118 / rho[1];
  t122 = t33 * t117 * t120;
  t123 = t122 / 0.12e2;
  t124 = t123 < 0.6e0;
  t125 = rho[1] * rho[1];
  t126 = t118 * t118;
  t128 = 0.1e1 / t126 / t125;
  t129 = sigma[2] * t128;
  t130 = t44 * t129;
  t133 = exp(-t130 / 0.24e2);
  t137 = sigma[2] * sigma[2];
  t138 = t125 * t125;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t118 / t139;
  t143 = t59 * t137 * t141;
  t145 = 0.1e1 + 0.13780328706878157639e-4 * t143;
  t146 = log(t145);
  t147 = 0.804e0 + 0.5e1 / 0.972e3 * t130 + 0.4002424276710846245e-2 * t44 * t129 * t133 + t146;
  t150 = 0.1804e1 - 0.646416e0 / t147;
  t151 = 0.26e1 < t123;
  t153 = exp(-0.1137619054542480583e-1 * t130);
  t155 = 0.1804e1 - 0.804e0 * t153;
  t156 = 0.190125e0 * t122;
  t157 = 0.195e0 * t130;
  t158 = t117 * sigma[2];
  t159 = 0.1e1 / t138;
  t161 = 0.88128321188908374119e-2 * t158 * t159;
  t162 = 0.26041666666666666667e-2 * t143;
  t163 = t117 * t137;
  t164 = t138 * t125;
  t166 = 0.1e1 / t126 / t164;
  t169 = 0.16276041666666666667e-3 * t88 * t163 * t166;
  t170 = -0.40608e0 + t156 - t157 + t161 - t162 + t169;
  t172 = 0.140608e1 - t156 + t157 - t161 + t162 - t169;
  t175 = my_piecewise3(t151, t155, t172 * t150 + t170 * t155);
  t176 = my_piecewise3(t124, t150, t175);
  t180 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t176);
  tzk0 = t106 + t180;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t181 = t6 * t6;
  t182 = 0.1e1 / t181;
  t183 = t16 * t182;
  t185 = my_piecewise5(t10, 0, t14, 0, t7 - t183);
  t188 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t185);
  t189 = t188 * t26;
  t193 = t26 * t26;
  t194 = 0.1e1 / t193;
  t195 = t25 * t194;
  t198 = t5 * t195 * t102 / 0.8e1;
  t199 = t70 * t70;
  t200 = 0.1e1 / t199;
  t201 = t45 * rho[0];
  t203 = 0.1e1 / t46 / t201;
  t204 = sigma[0] * t203;
  t205 = t44 * t204;
  t211 = 0.1e1 / t35 / t90;
  t212 = t60 * t211;
  t216 = 0.1e1 / t68;
  t220 = -0.1e2 / 0.729e3 * t205 - 0.10673131404562256653e-1 * t44 * t204 * t53 + 0.44471380852342736056e-3 * t59 * t212 * t53 - 0.73495086436683507408e-4 * t59 * t212 * t216;
  t223 = t204 * t76;
  t227 = 0.1e1 / t35 / t45;
  t232 = 0.1e1 / t62;
  t237 = t61 * t201;
  t239 = 0.1e1 / t46 / t237;
  t243 = -0.2535e0 * t33 * t34 * t227 + 0.52e0 * t205 - 0.35251328475563349648e-1 * t81 * t232 + 0.13888888888888888889e-1 * t59 * t212 - 0.10850694444444444445e-2 * t88 * t89 * t239;
  t245 = t96 * t28;
  t246 = t245 * t43;
  t249 = -t243;
  t251 = t98 * t200;
  t255 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t223, t243 * t78 - 0.243905525293907837e-1 * t246 * t223 + t249 * t73 + 0.646416e0 * t251 * t220);
  t256 = my_piecewise3(t41, 0.646416e0 * t200 * t220, t255);
  t261 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t102 - t198 - 0.3e1 / 0.8e1 * t5 * t27 * t256);
  t262 = t108 * t182;
  t264 = my_piecewise5(t14, 0, t10, 0, -t7 - t262);
  t267 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t264);
  t268 = t267 * t26;
  t272 = t115 * t194;
  t275 = t5 * t272 * t176 / 0.8e1;
  t277 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t176 - t275);
  tvrho0 = t106 + t180 + t6 * (t261 + t277);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t281 = my_piecewise5(t10, 0, t14, 0, -t7 - t183);
  t284 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t281);
  t285 = t284 * t26;
  t290 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t102 - t198);
  t292 = my_piecewise5(t14, 0, t10, 0, t7 - t262);
  t295 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t292);
  t296 = t295 * t26;
  t300 = t147 * t147;
  t301 = 0.1e1 / t300;
  t302 = t125 * rho[1];
  t304 = 0.1e1 / t126 / t302;
  t305 = sigma[2] * t304;
  t306 = t44 * t305;
  t312 = 0.1e1 / t118 / t164;
  t313 = t137 * t312;
  t317 = 0.1e1 / t145;
  t321 = -0.1e2 / 0.729e3 * t306 - 0.10673131404562256653e-1 * t44 * t305 * t133 + 0.44471380852342736056e-3 * t59 * t313 * t133 - 0.73495086436683507408e-4 * t59 * t313 * t317;
  t324 = t305 * t153;
  t328 = 0.1e1 / t118 / t125;
  t333 = 0.1e1 / t139;
  t338 = t138 * t302;
  t340 = 0.1e1 / t126 / t338;
  t344 = -0.2535e0 * t33 * t117 * t328 + 0.52e0 * t306 - 0.35251328475563349648e-1 * t158 * t333 + 0.13888888888888888889e-1 * t59 * t313 - 0.10850694444444444445e-2 * t88 * t163 * t340;
  t346 = t170 * t28;
  t347 = t346 * t43;
  t350 = -t344;
  t352 = t172 * t301;
  t356 = my_piecewise3(t151, -0.243905525293907837e-1 * t44 * t324, t344 * t155 - 0.243905525293907837e-1 * t347 * t324 + t350 * t150 + 0.646416e0 * t352 * t321);
  t357 = my_piecewise3(t124, 0.646416e0 * t301 * t321, t356);
  t362 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t176 - t275 - 0.3e1 / 0.8e1 * t5 * t116 * t357);
  tvrho1 = t106 + t180 + t6 * (t290 + t362);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t365 = t44 * t48;
  t370 = sigma[0] * t64;
  t377 = 0.5e1 / 0.972e3 * t365 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t370 * t53 + 0.27560657413756315278e-4 * t59 * t370 * t216;
  t383 = 0.1e1 / t34;
  t395 = 0.950625e-1 * t33 * t383 * t37 - 0.195e0 * t365 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t370 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t398 = t43 * t48 * t76;
  t401 = -t395;
  t406 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t395 * t78 + 0.91464571985215438873e-2 * t245 * t398 + t401 * t73 + 0.646416e0 * t251 * t377);
  t407 = my_piecewise3(t41, 0.646416e0 * t200 * t377, t406);
  t411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t407);
  tvsigma0 = t6 * t411;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t412 = t44 * t128;
  t417 = sigma[2] * t141;
  t424 = 0.5e1 / 0.972e3 * t412 + 0.4002424276710846245e-2 * t44 * t128 * t133 - 0.16676767819628526021e-3 * t59 * t417 * t133 + 0.27560657413756315278e-4 * t59 * t417 * t317;
  t430 = 0.1e1 / t117;
  t442 = 0.950625e-1 * t33 * t430 * t120 - 0.195e0 * t412 + 0.13219248178336256118e-1 * t117 * t159 - 0.52083333333333333334e-2 * t59 * t417 + 0.40690104166666666668e-3 * t88 * t158 * t166;
  t445 = t43 * t128 * t153;
  t448 = -t442;
  t453 = my_piecewise3(t151, 0.91464571985215438873e-2 * t44 * t128 * t153, t442 * t155 + 0.91464571985215438873e-2 * t346 * t445 + t448 * t150 + 0.646416e0 * t352 * t424);
  t454 = my_piecewise3(t124, 0.646416e0 * t301 * t424, t453);
  t458 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t454);
  tvsigma2 = t6 * t458;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t53;
  double t58, t59, t60, t61, t62, t64, t66, t68;
  double t69, t70, t73, t74, t76, t78, t79, t80;
  double t81, t82, t84, t85, t88, t89, t90, t92;
  double t95, t96, t98, t101, t102, t106, t107, t108;
  double t110, t111, t112, t113, t115, t116, t117, t118;
  double t120, t122, t123, t124, t125, t126, t128, t129;
  double t130, t133, t137, t138, t139, t141, t143, t145;
  double t146, t147, t150, t151, t153, t155, t156, t157;
  double t158, t159, t161, t162, t163, t164, t166, t169;
  double t170, t172, t175, t176, t180, tzk0;

  double t181, t182, t183, t185, t188, t189, t193, t194;
  double t195, t198, t199, t200, t201, t203, t204, t205;
  double t211, t212, t216, t220, t223, t227, t232, t237;
  double t239, t243, t245, t246, t249, t251, t255, t256;
  double t261, t262, t264, t267, t268, t272, t275, t277;
  double tvrho0, t281, t284, t285, t290, t292, t295, t296;
  double t300, t301, t302, t304, t305, t306, t312, t313;
  double t317, t321, t324, t328, t333, t338, t340, t344;
  double t346, t347, t350, t352, t356, t357, t362, tvrho1;
  double t365, t370, t377, t383, t395, t398, t401, t406;
  double t407, t411, tvsigma0, tvsigma1, t412, t417, t424, t430;
  double t442, t445, t448, t453, t454, t458, tvsigma2;

  double t461, t462, t463, t466, t467, t468, t471, t475;
  double t476, t480, t482, t488, t489, t492, t494, t497;
  double t498, t502, t503, t504, t510, t511, t515, t516;
  double t517, t518, t519, t520, t521, t530, t531, t532;
  double t534, t536, t537, t541, t545, t548, t553, t558;
  double t564, t568, t570, t571, t576, t577, t580, t582;
  double t585, t591, t592, t597, t598, t599, t600, t603;
  double t606, t610, t611, t615, t617, t619, t622, t624;
  double tv2rho20, t627, t631, t635, t636, t640, t642, t650;
  double t651, t655, t659, t660, t664, t666, t673, t676;
  double tv2rho21, t681, t686, t690, t691, t697, t698, t703;
  double t707, t708, t718, t719, t723, t724, t725, t731;
  double t732, t736, t737, t738, t739, t740, t747, t748;
  double t750, t752, t753, t757, t761, t764, t769, t774;
  double t780, t784, t786, t787, t792, t793, t796, t798;
  double t801, t807, t808, t813, tv2rho22, t821, t822, t825;
  double t830, t834, t835, t836, t843, t845, t850, t857;
  double t872, t874, t875, t881, t886, t888, t893, t899;
  double t900, t905, tv2rhosigma0, tv2rhosigma1, t912, t914, tv2rhosigma2, t920;
  double tv2rhosigma3, tv2rhosigma4, t925, t928, t933, t937, t938, t939;
  double t946, t948, t953, t960, t975, t977, t978, t984;
  double t989, t991, t996, t1002, t1003, t1008, tv2rhosigma5, t1010;
  double t1016, t1017, t1025, t1030, t1037, t1048, t1053, t1056;
  double t1065, t1066, t1070, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t1071, t1077, t1078, t1086, t1091, t1098, t1109, t1114;
  double t1117, t1126, t1127, t1131, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = -t16;
  t110 = my_piecewise5(t14, t11, t10, t15, t108 * t7);
  t111 = 0.1e1 + t110;
  t112 = t111 <= p->zeta_threshold;
  t113 = POW_1_3(t111);
  t115 = my_piecewise3(t112, t22, t113 * t111);
  t116 = t115 * t26;
  t117 = sqrt(sigma[2]);
  t118 = POW_1_3(rho[1]);
  t120 = 0.1e1 / t118 / rho[1];
  t122 = t33 * t117 * t120;
  t123 = t122 / 0.12e2;
  t124 = t123 < 0.6e0;
  t125 = rho[1] * rho[1];
  t126 = t118 * t118;
  t128 = 0.1e1 / t126 / t125;
  t129 = sigma[2] * t128;
  t130 = t44 * t129;
  t133 = exp(-t130 / 0.24e2);
  t137 = sigma[2] * sigma[2];
  t138 = t125 * t125;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t118 / t139;
  t143 = t59 * t137 * t141;
  t145 = 0.1e1 + 0.13780328706878157639e-4 * t143;
  t146 = log(t145);
  t147 = 0.804e0 + 0.5e1 / 0.972e3 * t130 + 0.4002424276710846245e-2 * t44 * t129 * t133 + t146;
  t150 = 0.1804e1 - 0.646416e0 / t147;
  t151 = 0.26e1 < t123;
  t153 = exp(-0.1137619054542480583e-1 * t130);
  t155 = 0.1804e1 - 0.804e0 * t153;
  t156 = 0.190125e0 * t122;
  t157 = 0.195e0 * t130;
  t158 = t117 * sigma[2];
  t159 = 0.1e1 / t138;
  t161 = 0.88128321188908374119e-2 * t158 * t159;
  t162 = 0.26041666666666666667e-2 * t143;
  t163 = t117 * t137;
  t164 = t138 * t125;
  t166 = 0.1e1 / t126 / t164;
  t169 = 0.16276041666666666667e-3 * t88 * t163 * t166;
  t170 = -0.40608e0 + t156 - t157 + t161 - t162 + t169;
  t172 = 0.140608e1 - t156 + t157 - t161 + t162 - t169;
  t175 = my_piecewise3(t151, t155, t172 * t150 + t170 * t155);
  t176 = my_piecewise3(t124, t150, t175);
  t180 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t176);
  tzk0 = t106 + t180;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t181 = t6 * t6;
  t182 = 0.1e1 / t181;
  t183 = t16 * t182;
  t185 = my_piecewise5(t10, 0, t14, 0, t7 - t183);
  t188 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t185);
  t189 = t188 * t26;
  t193 = t26 * t26;
  t194 = 0.1e1 / t193;
  t195 = t25 * t194;
  t198 = t5 * t195 * t102 / 0.8e1;
  t199 = t70 * t70;
  t200 = 0.1e1 / t199;
  t201 = t45 * rho[0];
  t203 = 0.1e1 / t46 / t201;
  t204 = sigma[0] * t203;
  t205 = t44 * t204;
  t211 = 0.1e1 / t35 / t90;
  t212 = t60 * t211;
  t216 = 0.1e1 / t68;
  t220 = -0.1e2 / 0.729e3 * t205 - 0.10673131404562256653e-1 * t44 * t204 * t53 + 0.44471380852342736056e-3 * t59 * t212 * t53 - 0.73495086436683507408e-4 * t59 * t212 * t216;
  t223 = t204 * t76;
  t227 = 0.1e1 / t35 / t45;
  t232 = 0.1e1 / t62;
  t237 = t61 * t201;
  t239 = 0.1e1 / t46 / t237;
  t243 = -0.2535e0 * t33 * t34 * t227 + 0.52e0 * t205 - 0.35251328475563349648e-1 * t81 * t232 + 0.13888888888888888889e-1 * t59 * t212 - 0.10850694444444444445e-2 * t88 * t89 * t239;
  t245 = t96 * t28;
  t246 = t245 * t43;
  t249 = -t243;
  t251 = t98 * t200;
  t255 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t223, t243 * t78 - 0.243905525293907837e-1 * t246 * t223 + t249 * t73 + 0.646416e0 * t251 * t220);
  t256 = my_piecewise3(t41, 0.646416e0 * t200 * t220, t255);
  t261 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t102 - t198 - 0.3e1 / 0.8e1 * t5 * t27 * t256);
  t262 = t108 * t182;
  t264 = my_piecewise5(t14, 0, t10, 0, -t7 - t262);
  t267 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t264);
  t268 = t267 * t26;
  t272 = t115 * t194;
  t275 = t5 * t272 * t176 / 0.8e1;
  t277 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t176 - t275);
  tvrho0 = t106 + t180 + t6 * (t261 + t277);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t281 = my_piecewise5(t10, 0, t14, 0, -t7 - t183);
  t284 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t281);
  t285 = t284 * t26;
  t290 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t102 - t198);
  t292 = my_piecewise5(t14, 0, t10, 0, t7 - t262);
  t295 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t292);
  t296 = t295 * t26;
  t300 = t147 * t147;
  t301 = 0.1e1 / t300;
  t302 = t125 * rho[1];
  t304 = 0.1e1 / t126 / t302;
  t305 = sigma[2] * t304;
  t306 = t44 * t305;
  t312 = 0.1e1 / t118 / t164;
  t313 = t137 * t312;
  t317 = 0.1e1 / t145;
  t321 = -0.1e2 / 0.729e3 * t306 - 0.10673131404562256653e-1 * t44 * t305 * t133 + 0.44471380852342736056e-3 * t59 * t313 * t133 - 0.73495086436683507408e-4 * t59 * t313 * t317;
  t324 = t305 * t153;
  t328 = 0.1e1 / t118 / t125;
  t333 = 0.1e1 / t139;
  t338 = t138 * t302;
  t340 = 0.1e1 / t126 / t338;
  t344 = -0.2535e0 * t33 * t117 * t328 + 0.52e0 * t306 - 0.35251328475563349648e-1 * t158 * t333 + 0.13888888888888888889e-1 * t59 * t313 - 0.10850694444444444445e-2 * t88 * t163 * t340;
  t346 = t170 * t28;
  t347 = t346 * t43;
  t350 = -t344;
  t352 = t172 * t301;
  t356 = my_piecewise3(t151, -0.243905525293907837e-1 * t44 * t324, t344 * t155 - 0.243905525293907837e-1 * t347 * t324 + t350 * t150 + 0.646416e0 * t352 * t321);
  t357 = my_piecewise3(t124, 0.646416e0 * t301 * t321, t356);
  t362 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t176 - t275 - 0.3e1 / 0.8e1 * t5 * t116 * t357);
  tvrho1 = t106 + t180 + t6 * (t290 + t362);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t365 = t44 * t48;
  t370 = sigma[0] * t64;
  t377 = 0.5e1 / 0.972e3 * t365 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t370 * t53 + 0.27560657413756315278e-4 * t59 * t370 * t216;
  t383 = 0.1e1 / t34;
  t395 = 0.950625e-1 * t33 * t383 * t37 - 0.195e0 * t365 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t370 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t398 = t43 * t48 * t76;
  t401 = -t395;
  t406 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t395 * t78 + 0.91464571985215438873e-2 * t245 * t398 + t401 * t73 + 0.646416e0 * t251 * t377);
  t407 = my_piecewise3(t41, 0.646416e0 * t200 * t377, t406);
  t411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t407);
  tvsigma0 = t6 * t411;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t412 = t44 * t128;
  t417 = sigma[2] * t141;
  t424 = 0.5e1 / 0.972e3 * t412 + 0.4002424276710846245e-2 * t44 * t128 * t133 - 0.16676767819628526021e-3 * t59 * t417 * t133 + 0.27560657413756315278e-4 * t59 * t417 * t317;
  t430 = 0.1e1 / t117;
  t442 = 0.950625e-1 * t33 * t430 * t120 - 0.195e0 * t412 + 0.13219248178336256118e-1 * t117 * t159 - 0.52083333333333333334e-2 * t59 * t417 + 0.40690104166666666668e-3 * t88 * t158 * t166;
  t445 = t43 * t128 * t153;
  t448 = -t442;
  t453 = my_piecewise3(t151, 0.91464571985215438873e-2 * t44 * t128 * t153, t442 * t155 + 0.91464571985215438873e-2 * t346 * t445 + t448 * t150 + 0.646416e0 * t352 * t424);
  t454 = my_piecewise3(t124, 0.646416e0 * t301 * t424, t453);
  t458 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t454);
  tvsigma2 = t6 * t458;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t461 = t23 * t23;
  t462 = 0.1e1 / t461;
  t463 = t185 * t185;
  t466 = t181 * t6;
  t467 = 0.1e1 / t466;
  t468 = t16 * t467;
  t471 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t182 + 0.2e1 * t468);
  t475 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t463 + 0.4e1 / 0.3e1 * t23 * t471);
  t476 = t475 * t26;
  t480 = t188 * t194;
  t482 = t5 * t480 * t102;
  t488 = 0.1e1 / t193 / t6;
  t489 = t25 * t488;
  t492 = t5 * t489 * t102 / 0.12e2;
  t494 = t5 * t195 * t256;
  t497 = 0.1e1 / t199 / t70;
  t498 = t220 * t220;
  t502 = 0.1e1 / t46 / t61;
  t503 = sigma[0] * t502;
  t504 = t44 * t503;
  t510 = 0.1e1 / t35 / t237;
  t511 = t60 * t510;
  t515 = t30 * t30;
  t516 = 0.1e1 / t515;
  t517 = t60 * sigma[0];
  t518 = t516 * t517;
  t519 = t61 * t61;
  t520 = t519 * t45;
  t521 = 0.1e1 / t520;
  t530 = t28 / t42 / t515;
  t531 = t60 * t60;
  t532 = t519 * t61;
  t534 = 0.1e1 / t46 / t532;
  t536 = t68 * t68;
  t537 = 0.1e1 / t536;
  t541 = 0.11e3 / 0.2187e4 * t504 + 0.39134815150061607728e-1 * t44 * t503 * t53 - 0.4002424276710846245e-2 * t59 * t511 * t53 + 0.29647587234895157371e-3 * t518 * t521 * t53 + 0.46546888076566221358e-3 * t59 * t511 * t216 - 0.32409166382013480325e-7 * t530 * t531 * t534 * t537;
  t545 = t503 * t76;
  t548 = t511 * t76;
  t553 = 0.1e1 / t35 / t201;
  t558 = 0.1e1 / t90;
  t564 = 0.1e1 / t46 / t519;
  t568 = 0.5915e0 * t33 * t34 * t553 - 0.19066666666666666667e1 * t504 + 0.17625664237781674824e0 * t81 * t558 - 0.87962962962962962964e-1 * t59 * t511 + 0.83188657407407407412e-2 * t88 * t89 * t564;
  t570 = t243 * t28;
  t571 = t570 * t43;
  t576 = t96 * t29;
  t577 = t576 * t58;
  t580 = -t568;
  t582 = t249 * t200;
  t585 = t98 * t497;
  t591 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t545 - 0.73992419488678004547e-3 * t59 * t548, t568 * t78 - 0.487811050587815674e-1 * t571 * t223 + 0.89432025941099540233e-1 * t246 * t545 - 0.73992419488678004547e-3 * t577 * t548 + t580 * t73 + 0.1292832e1 * t582 * t220 - 0.1292832e1 * t585 * t498 + 0.646416e0 * t251 * t541);
  t592 = my_piecewise3(t41, -0.1292832e1 * t497 * t498 + 0.646416e0 * t200 * t541, t591);
  t597 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t102 - t482 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t256 + t492 - t494 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t592);
  t598 = t113 * t113;
  t599 = 0.1e1 / t598;
  t600 = t264 * t264;
  t603 = t108 * t467;
  t606 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t182 + 0.2e1 * t603);
  t610 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t600 + 0.4e1 / 0.3e1 * t113 * t606);
  t611 = t610 * t26;
  t615 = t267 * t194;
  t617 = t5 * t615 * t176;
  t619 = t115 * t488;
  t622 = t5 * t619 * t176 / 0.12e2;
  t624 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t176 - t617 / 0.4e1 + t622);
  tv2rho20 = 0.2e1 * t261 + 0.2e1 * t277 + t6 * (t597 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t627 = t462 * t281;
  t631 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t468);
  t635 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t627 * t185 + 0.4e1 / 0.3e1 * t23 * t631);
  t636 = t635 * t26;
  t640 = t284 * t194;
  t642 = t5 * t640 * t102;
  t650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t102 - t642 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t256 - t482 / 0.8e1 + t492 - t494 / 0.8e1);
  t651 = t599 * t292;
  t655 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t603);
  t659 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t651 * t264 + 0.4e1 / 0.3e1 * t113 * t655);
  t660 = t659 * t26;
  t664 = t295 * t194;
  t666 = t5 * t664 * t176;
  t673 = t5 * t272 * t357;
  t676 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t176 - t666 / 0.8e1 - t617 / 0.8e1 + t622 - 0.3e1 / 0.8e1 * t5 * t268 * t357 - t673 / 0.8e1);
  tv2rho21 = t261 + t277 + t290 + t362 + t6 * (t650 + t676);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t681 = t281 * t281;
  t686 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t182 + 0.2e1 * t468);
  t690 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t681 + 0.4e1 / 0.3e1 * t23 * t686);
  t691 = t690 * t26;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t102 - t642 / 0.4e1 + t492);
  t698 = t292 * t292;
  t703 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t182 + 0.2e1 * t603);
  t707 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t698 + 0.4e1 / 0.3e1 * t113 * t703);
  t708 = t707 * t26;
  t718 = 0.1e1 / t300 / t147;
  t719 = t321 * t321;
  t723 = 0.1e1 / t126 / t138;
  t724 = sigma[2] * t723;
  t725 = t44 * t724;
  t731 = 0.1e1 / t118 / t338;
  t732 = t137 * t731;
  t736 = t137 * sigma[2];
  t737 = t516 * t736;
  t738 = t138 * t138;
  t739 = t738 * t125;
  t740 = 0.1e1 / t739;
  t747 = t137 * t137;
  t748 = t738 * t138;
  t750 = 0.1e1 / t126 / t748;
  t752 = t145 * t145;
  t753 = 0.1e1 / t752;
  t757 = 0.11e3 / 0.2187e4 * t725 + 0.39134815150061607728e-1 * t44 * t724 * t133 - 0.4002424276710846245e-2 * t59 * t732 * t133 + 0.29647587234895157371e-3 * t737 * t740 * t133 + 0.46546888076566221358e-3 * t59 * t732 * t317 - 0.32409166382013480325e-7 * t530 * t747 * t750 * t753;
  t761 = t724 * t153;
  t764 = t732 * t153;
  t769 = 0.1e1 / t118 / t302;
  t774 = 0.1e1 / t164;
  t780 = 0.1e1 / t126 / t738;
  t784 = 0.5915e0 * t33 * t117 * t769 - 0.19066666666666666667e1 * t725 + 0.17625664237781674824e0 * t158 * t774 - 0.87962962962962962964e-1 * t59 * t732 + 0.83188657407407407412e-2 * t88 * t163 * t780;
  t786 = t344 * t28;
  t787 = t786 * t43;
  t792 = t170 * t29;
  t793 = t792 * t58;
  t796 = -t784;
  t798 = t350 * t301;
  t801 = t172 * t718;
  t807 = my_piecewise3(t151, 0.89432025941099540233e-1 * t44 * t761 - 0.73992419488678004547e-3 * t59 * t764, t784 * t155 - 0.487811050587815674e-1 * t787 * t324 + 0.89432025941099540233e-1 * t347 * t761 - 0.73992419488678004547e-3 * t793 * t764 + t796 * t150 + 0.1292832e1 * t798 * t321 - 0.1292832e1 * t801 * t719 + 0.646416e0 * t352 * t757);
  t808 = my_piecewise3(t124, -0.1292832e1 * t718 * t719 + 0.646416e0 * t301 * t757, t807);
  t813 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t176 - t666 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t357 + t622 - t673 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t808);
  tv2rho22 = 0.2e1 * t290 + 0.2e1 * t362 + t6 * (t697 + t813);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t821 = t5 * t195 * t407 / 0.8e1;
  t822 = t497 * t377;
  t825 = t44 * t203;
  t830 = t211 * sigma[0];
  t834 = t516 * t60;
  t835 = t519 * rho[0];
  t836 = 0.1e1 / t835;
  t843 = t519 * t201;
  t845 = 0.1e1 / t46 / t843;
  t850 = -0.1e2 / 0.729e3 * t825 - 0.10673131404562256653e-1 * t44 * t203 * t53 + 0.13341414255702820817e-2 * t59 * t830 * t53 - 0.11117845213085684014e-3 * t834 * t836 * t53 - 0.14699017287336701482e-3 * t59 * t830 * t216 + 0.12153437393255055122e-7 * t530 * t517 * t845 * t537;
  t857 = t830 * t76;
  t872 = -0.12675e0 * t33 * t383 * t227 + 0.52e0 * t825 - 0.52876992713345024472e-1 * t34 * t232 + 0.27777777777777777778e-1 * t59 * t830 - 0.27126736111111111112e-2 * t88 * t81 * t239;
  t874 = t395 * t28;
  t875 = t874 * t43;
  t881 = t43 * t203 * t76;
  t886 = -t872;
  t888 = t401 * t200;
  t893 = t377 * t220;
  t899 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t203 * t76 + 0.27747157308254251705e-3 * t59 * t857, t872 * t78 - 0.243905525293907837e-1 * t875 * t223 + 0.91464571985215438873e-2 * t570 * t398 - 0.24390552529390783699e-1 * t245 * t881 + 0.27747157308254251705e-3 * t577 * t857 + t886 * t73 + 0.646416e0 * t888 * t220 + 0.646416e0 * t582 * t377 - 0.1292832e1 * t585 * t893 + 0.646416e0 * t251 * t850);
  t900 = my_piecewise3(t41, -0.1292832e1 * t822 * t220 + 0.646416e0 * t200 * t850, t899);
  t905 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t407 - t821 - 0.3e1 / 0.8e1 * t5 * t27 * t900);
  tv2rhosigma0 = t6 * t905 + t411;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t912 = t5 * t272 * t454 / 0.8e1;
  t914 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t454 - t912);
  tv2rhosigma2 = t6 * t914 + t458;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t920 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t407 - t821);
  tv2rhosigma3 = t6 * t920 + t411;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t925 = t718 * t424;
  t928 = t44 * t304;
  t933 = t312 * sigma[2];
  t937 = t516 * t137;
  t938 = t738 * rho[1];
  t939 = 0.1e1 / t938;
  t946 = t738 * t302;
  t948 = 0.1e1 / t126 / t946;
  t953 = -0.1e2 / 0.729e3 * t928 - 0.10673131404562256653e-1 * t44 * t304 * t133 + 0.13341414255702820817e-2 * t59 * t933 * t133 - 0.11117845213085684014e-3 * t937 * t939 * t133 - 0.14699017287336701482e-3 * t59 * t933 * t317 + 0.12153437393255055122e-7 * t530 * t736 * t948 * t753;
  t960 = t933 * t153;
  t975 = -0.12675e0 * t33 * t430 * t328 + 0.52e0 * t928 - 0.52876992713345024472e-1 * t117 * t333 + 0.27777777777777777778e-1 * t59 * t933 - 0.27126736111111111112e-2 * t88 * t158 * t340;
  t977 = t442 * t28;
  t978 = t977 * t43;
  t984 = t43 * t304 * t153;
  t989 = -t975;
  t991 = t448 * t301;
  t996 = t424 * t321;
  t1002 = my_piecewise3(t151, -0.24390552529390783699e-1 * t44 * t304 * t153 + 0.27747157308254251705e-3 * t59 * t960, t975 * t155 - 0.243905525293907837e-1 * t978 * t324 + 0.91464571985215438873e-2 * t786 * t445 - 0.24390552529390783699e-1 * t346 * t984 + 0.27747157308254251705e-3 * t793 * t960 + t989 * t150 + 0.646416e0 * t991 * t321 + 0.646416e0 * t798 * t424 - 0.1292832e1 * t801 * t996 + 0.646416e0 * t352 * t953);
  t1003 = my_piecewise3(t124, -0.1292832e1 * t925 * t321 + 0.646416e0 * t301 * t953, t1002);
  t1008 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t454 - t912 - 0.3e1 / 0.8e1 * t5 * t116 * t1003);
  tv2rhosigma5 = t6 * t1008 + t458;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1010 = t377 * t377;
  t1016 = t516 * sigma[0];
  t1017 = 0.1e1 / t519;
  t1025 = 0.1e1 / t46 / t520;
  t1030 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1016 * t1017 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t216 - 0.45575390224706456708e-8 * t530 * t60 * t1025 * t537;
  t1037 = 0.1e1 / t81;
  t1048 = -0.4753125e-1 * t33 * t1037 * t37 + 0.6609624089168128059e-2 * t383 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1053 = t58 * t64 * t76;
  t1056 = -t1048;
  t1065 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1048 * t78 + 0.18292914397043087775e-1 * t874 * t398 - 0.10405183990595344389e-3 * t576 * t1053 + t1056 * t73 + 0.1292832e1 * t888 * t377 - 0.1292832e1 * t585 * t1010 + 0.646416e0 * t251 * t1030);
  t1066 = my_piecewise3(t41, -0.1292832e1 * t497 * t1010 + 0.646416e0 * t200 * t1030, t1065);
  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1066);
  tv2sigma20 = t6 * t1070;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1071 = t424 * t424;
  t1077 = t516 * sigma[2];
  t1078 = 0.1e1 / t738;
  t1086 = 0.1e1 / t126 / t739;
  t1091 = -0.33353535639257052042e-3 * t59 * t141 * t133 + 0.41691919549071315052e-4 * t1077 * t1078 * t133 + 0.27560657413756315278e-4 * t59 * t141 * t317 - 0.45575390224706456708e-8 * t530 * t137 * t1086 * t753;
  t1098 = 0.1e1 / t158;
  t1109 = -0.4753125e-1 * t33 * t1098 * t120 + 0.6609624089168128059e-2 * t430 * t159 - 0.52083333333333333334e-2 * t59 * t141 + 0.61035156250000000002e-3 * t88 * t117 * t166;
  t1114 = t58 * t141 * t153;
  t1117 = -t1109;
  t1126 = my_piecewise3(t151, -0.10405183990595344389e-3 * t59 * t141 * t153, t1109 * t155 + 0.18292914397043087775e-1 * t977 * t445 - 0.10405183990595344389e-3 * t792 * t1114 + t1117 * t150 + 0.1292832e1 * t991 * t424 - 0.1292832e1 * t801 * t1071 + 0.646416e0 * t352 * t1091);
  t1127 = my_piecewise3(t124, -0.1292832e1 * t718 * t1071 + 0.646416e0 * t301 * t1091, t1126);
  t1131 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t1127);
  tv2sigma25 = t6 * t1131;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t53;
  double t58, t59, t60, t61, t62, t64, t66, t68;
  double t69, t70, t73, t74, t76, t78, t79, t80;
  double t81, t82, t84, t85, t88, t89, t90, t92;
  double t95, t96, t98, t101, t102, t106, t107, t108;
  double t110, t111, t112, t113, t115, t116, t117, t118;
  double t120, t122, t123, t124, t125, t126, t128, t129;
  double t130, t133, t137, t138, t139, t141, t143, t145;
  double t146, t147, t150, t151, t153, t155, t156, t157;
  double t158, t159, t161, t162, t163, t164, t166, t169;
  double t170, t172, t175, t176, t180, tzk0;

  double t181, t182, t183, t185, t188, t189, t193, t194;
  double t195, t198, t199, t200, t201, t203, t204, t205;
  double t211, t212, t216, t220, t223, t227, t232, t237;
  double t239, t243, t245, t246, t249, t251, t255, t256;
  double t261, t262, t264, t267, t268, t272, t275, t277;
  double tvrho0, t281, t284, t285, t290, t292, t295, t296;
  double t300, t301, t302, t304, t305, t306, t312, t313;
  double t317, t321, t324, t328, t333, t338, t340, t344;
  double t346, t347, t350, t352, t356, t357, t362, tvrho1;
  double t365, t370, t377, t383, t395, t398, t401, t406;
  double t407, t411, tvsigma0, tvsigma1, t412, t417, t424, t430;
  double t442, t445, t448, t453, t454, t458, tvsigma2;

  double t461, t462, t463, t466, t467, t468, t471, t475;
  double t476, t480, t482, t488, t489, t492, t494, t497;
  double t498, t502, t503, t504, t510, t511, t515, t516;
  double t517, t518, t519, t520, t521, t530, t531, t532;
  double t534, t536, t537, t541, t545, t548, t553, t558;
  double t564, t568, t570, t571, t576, t577, t580, t582;
  double t585, t591, t592, t597, t598, t599, t600, t603;
  double t606, t610, t611, t615, t617, t619, t622, t624;
  double tv2rho20, t627, t631, t635, t636, t640, t642, t650;
  double t651, t655, t659, t660, t664, t666, t673, t676;
  double tv2rho21, t681, t686, t690, t691, t697, t698, t703;
  double t707, t708, t718, t719, t723, t724, t725, t731;
  double t732, t736, t737, t738, t739, t740, t747, t748;
  double t750, t752, t753, t757, t761, t764, t769, t774;
  double t780, t784, t786, t787, t792, t793, t796, t798;
  double t801, t807, t808, t813, tv2rho22, t821, t822, t825;
  double t830, t834, t835, t836, t843, t845, t850, t857;
  double t872, t874, t875, t881, t886, t888, t893, t899;
  double t900, t905, tv2rhosigma0, tv2rhosigma1, t912, t914, tv2rhosigma2, t920;
  double tv2rhosigma3, tv2rhosigma4, t925, t928, t933, t937, t938, t939;
  double t946, t948, t953, t960, t975, t977, t978, t984;
  double t989, t991, t996, t1002, t1003, t1008, tv2rhosigma5, t1010;
  double t1016, t1017, t1025, t1030, t1037, t1048, t1053, t1056;
  double t1065, t1066, t1070, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t1071, t1077, t1078, t1086, t1091, t1098, t1109, t1114;
  double t1117, t1126, t1127, t1131, tv2sigma25;

  double t1135, t1136, t1139, t1142, t1143, t1144, t1147, t1151;
  double t1152, t1156, t1158, t1163, t1165, t1168, t1174, t1175;
  double t1178, t1180, t1183, t1185, t1186, t1187, t1190, t1194;
  double t1195, t1196, t1202, t1203, t1207, t1211, t1212, t1214;
  double t1216, t1226, t1227, t1229, t1232, t1235, t1239, t1242;
  double t1250, t1255, t1261, t1265, t1267, t1268, t1273, t1274;
  double t1281, t1282, t1285, t1287, t1290, t1295, t1298, t1303;
  double t1304, t1305, t1310, t1312, t1313, t1316, t1319, t1322;
  double t1326, t1327, t1331, t1333, t1335, t1337, t1339, t1342;
  double t1344, tv3rho30, t1347, t1348, t1349, t1352, t1357, t1358;
  double t1360, t1364, t1365, t1369, t1372, t1376, t1378, t1382;
  double t1391, t1392, t1393, t1396, t1401, t1403, t1407, t1408;
  double t1412, t1415, t1416, t1418, t1427, t1429, t1432, tv3rho31;
  double t1435, t1440, t1444, t1448, t1449, t1453, t1455, t1464;
  double t1465, t1470, t1474, t1478, t1479, t1483, t1485, t1492;
  double t1500, t1502, t1503, tv3rho32, t1508, t1515, t1519, t1520;
  double t1527, t1528, t1535, t1539, t1540, t1555, t1556, t1557;
  double t1560, t1564, t1565, t1566, t1572, t1573, t1577, t1581;
  double t1582, t1584, t1586, t1596, t1597, t1599, t1602, t1605;
  double t1609, t1612, t1620, t1625, t1631, t1635, t1637, t1638;
  double t1643, t1644, t1651, t1652, t1655, t1657, t1660, t1665;
  double t1668, t1673, t1674, t1675, t1680, tv3rho33, t1688, t1695;
  double t1697, t1699, t1702, t1707, t1712, t1716, t1717, t1730;
  double t1732, t1736, t1743, t1750, t1764, t1766, t1768, t1769;
  double t1772, t1773, t1781, t1786, t1787, t1791, t1796, t1799;
  double t1806, t1817, t1819, t1820, t1825, tv3rho2sigma0, tv3rho2sigma1, t1832;
  double t1836, t1838, tv3rho2sigma2, t1844, t1852, tv3rho2sigma3, tv3rho2sigma4, t1858;
  double t1865, t1868, tv3rho2sigma5, t1876, tv3rho2sigma6, tv3rho2sigma7, t1887, t1890;
  double t1895, t1900, t1904, t1905, t1918, t1920, t1924, t1931;
  double t1949, t1951, t1955, t1960, t1961, t1969, t1975, t1976;
  double t1979, t1982, t1985, t1986, t1989, t1996, t2005, t2007;
  double t2008, t2013, tv3rho2sigma8, t2020, t2021, t2026, t2032, t2033;
  double t2042, t2046, t2047, t2051, t2072, t2074, t2075, t2087;
  double t2090, t2091, t2094, t2096, t2107, t2110, t2115, t2120;
  double t2121, t2122, t2127, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t2134, t2136, tv3rhosigma25, t2142, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2147, t2152, t2158, t2159, t2168, t2172, t2173;
  double t2177, t2198, t2200, t2201, t2213, t2216, t2217, t2220;
  double t2222, t2233, t2236, t2241, t2246, t2247, t2248, t2253;
  double tv3rhosigma211, t2255, t2266, t2270, t2274, t2280, t2289, t2298;
  double t2308, t2313, t2314, t2315, t2319, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2320, t2331;
  double t2335, t2339, t2345, t2354, t2363, t2373, t2378, t2379;
  double t2380, t2384, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = -t16;
  t110 = my_piecewise5(t14, t11, t10, t15, t108 * t7);
  t111 = 0.1e1 + t110;
  t112 = t111 <= p->zeta_threshold;
  t113 = POW_1_3(t111);
  t115 = my_piecewise3(t112, t22, t113 * t111);
  t116 = t115 * t26;
  t117 = sqrt(sigma[2]);
  t118 = POW_1_3(rho[1]);
  t120 = 0.1e1 / t118 / rho[1];
  t122 = t33 * t117 * t120;
  t123 = t122 / 0.12e2;
  t124 = t123 < 0.6e0;
  t125 = rho[1] * rho[1];
  t126 = t118 * t118;
  t128 = 0.1e1 / t126 / t125;
  t129 = sigma[2] * t128;
  t130 = t44 * t129;
  t133 = exp(-t130 / 0.24e2);
  t137 = sigma[2] * sigma[2];
  t138 = t125 * t125;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t118 / t139;
  t143 = t59 * t137 * t141;
  t145 = 0.1e1 + 0.13780328706878157639e-4 * t143;
  t146 = log(t145);
  t147 = 0.804e0 + 0.5e1 / 0.972e3 * t130 + 0.4002424276710846245e-2 * t44 * t129 * t133 + t146;
  t150 = 0.1804e1 - 0.646416e0 / t147;
  t151 = 0.26e1 < t123;
  t153 = exp(-0.1137619054542480583e-1 * t130);
  t155 = 0.1804e1 - 0.804e0 * t153;
  t156 = 0.190125e0 * t122;
  t157 = 0.195e0 * t130;
  t158 = t117 * sigma[2];
  t159 = 0.1e1 / t138;
  t161 = 0.88128321188908374119e-2 * t158 * t159;
  t162 = 0.26041666666666666667e-2 * t143;
  t163 = t117 * t137;
  t164 = t138 * t125;
  t166 = 0.1e1 / t126 / t164;
  t169 = 0.16276041666666666667e-3 * t88 * t163 * t166;
  t170 = -0.40608e0 + t156 - t157 + t161 - t162 + t169;
  t172 = 0.140608e1 - t156 + t157 - t161 + t162 - t169;
  t175 = my_piecewise3(t151, t155, t172 * t150 + t170 * t155);
  t176 = my_piecewise3(t124, t150, t175);
  t180 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t176);
  tzk0 = t106 + t180;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t181 = t6 * t6;
  t182 = 0.1e1 / t181;
  t183 = t16 * t182;
  t185 = my_piecewise5(t10, 0, t14, 0, t7 - t183);
  t188 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t185);
  t189 = t188 * t26;
  t193 = t26 * t26;
  t194 = 0.1e1 / t193;
  t195 = t25 * t194;
  t198 = t5 * t195 * t102 / 0.8e1;
  t199 = t70 * t70;
  t200 = 0.1e1 / t199;
  t201 = t45 * rho[0];
  t203 = 0.1e1 / t46 / t201;
  t204 = sigma[0] * t203;
  t205 = t44 * t204;
  t211 = 0.1e1 / t35 / t90;
  t212 = t60 * t211;
  t216 = 0.1e1 / t68;
  t220 = -0.1e2 / 0.729e3 * t205 - 0.10673131404562256653e-1 * t44 * t204 * t53 + 0.44471380852342736056e-3 * t59 * t212 * t53 - 0.73495086436683507408e-4 * t59 * t212 * t216;
  t223 = t204 * t76;
  t227 = 0.1e1 / t35 / t45;
  t232 = 0.1e1 / t62;
  t237 = t61 * t201;
  t239 = 0.1e1 / t46 / t237;
  t243 = -0.2535e0 * t33 * t34 * t227 + 0.52e0 * t205 - 0.35251328475563349648e-1 * t81 * t232 + 0.13888888888888888889e-1 * t59 * t212 - 0.10850694444444444445e-2 * t88 * t89 * t239;
  t245 = t96 * t28;
  t246 = t245 * t43;
  t249 = -t243;
  t251 = t98 * t200;
  t255 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t223, t243 * t78 - 0.243905525293907837e-1 * t246 * t223 + t249 * t73 + 0.646416e0 * t251 * t220);
  t256 = my_piecewise3(t41, 0.646416e0 * t200 * t220, t255);
  t261 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t102 - t198 - 0.3e1 / 0.8e1 * t5 * t27 * t256);
  t262 = t108 * t182;
  t264 = my_piecewise5(t14, 0, t10, 0, -t7 - t262);
  t267 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t264);
  t268 = t267 * t26;
  t272 = t115 * t194;
  t275 = t5 * t272 * t176 / 0.8e1;
  t277 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t176 - t275);
  tvrho0 = t106 + t180 + t6 * (t261 + t277);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t281 = my_piecewise5(t10, 0, t14, 0, -t7 - t183);
  t284 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t281);
  t285 = t284 * t26;
  t290 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t102 - t198);
  t292 = my_piecewise5(t14, 0, t10, 0, t7 - t262);
  t295 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t292);
  t296 = t295 * t26;
  t300 = t147 * t147;
  t301 = 0.1e1 / t300;
  t302 = t125 * rho[1];
  t304 = 0.1e1 / t126 / t302;
  t305 = sigma[2] * t304;
  t306 = t44 * t305;
  t312 = 0.1e1 / t118 / t164;
  t313 = t137 * t312;
  t317 = 0.1e1 / t145;
  t321 = -0.1e2 / 0.729e3 * t306 - 0.10673131404562256653e-1 * t44 * t305 * t133 + 0.44471380852342736056e-3 * t59 * t313 * t133 - 0.73495086436683507408e-4 * t59 * t313 * t317;
  t324 = t305 * t153;
  t328 = 0.1e1 / t118 / t125;
  t333 = 0.1e1 / t139;
  t338 = t138 * t302;
  t340 = 0.1e1 / t126 / t338;
  t344 = -0.2535e0 * t33 * t117 * t328 + 0.52e0 * t306 - 0.35251328475563349648e-1 * t158 * t333 + 0.13888888888888888889e-1 * t59 * t313 - 0.10850694444444444445e-2 * t88 * t163 * t340;
  t346 = t170 * t28;
  t347 = t346 * t43;
  t350 = -t344;
  t352 = t172 * t301;
  t356 = my_piecewise3(t151, -0.243905525293907837e-1 * t44 * t324, t344 * t155 - 0.243905525293907837e-1 * t347 * t324 + t350 * t150 + 0.646416e0 * t352 * t321);
  t357 = my_piecewise3(t124, 0.646416e0 * t301 * t321, t356);
  t362 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t176 - t275 - 0.3e1 / 0.8e1 * t5 * t116 * t357);
  tvrho1 = t106 + t180 + t6 * (t290 + t362);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t365 = t44 * t48;
  t370 = sigma[0] * t64;
  t377 = 0.5e1 / 0.972e3 * t365 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t370 * t53 + 0.27560657413756315278e-4 * t59 * t370 * t216;
  t383 = 0.1e1 / t34;
  t395 = 0.950625e-1 * t33 * t383 * t37 - 0.195e0 * t365 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t370 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t398 = t43 * t48 * t76;
  t401 = -t395;
  t406 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t395 * t78 + 0.91464571985215438873e-2 * t245 * t398 + t401 * t73 + 0.646416e0 * t251 * t377);
  t407 = my_piecewise3(t41, 0.646416e0 * t200 * t377, t406);
  t411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t407);
  tvsigma0 = t6 * t411;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t412 = t44 * t128;
  t417 = sigma[2] * t141;
  t424 = 0.5e1 / 0.972e3 * t412 + 0.4002424276710846245e-2 * t44 * t128 * t133 - 0.16676767819628526021e-3 * t59 * t417 * t133 + 0.27560657413756315278e-4 * t59 * t417 * t317;
  t430 = 0.1e1 / t117;
  t442 = 0.950625e-1 * t33 * t430 * t120 - 0.195e0 * t412 + 0.13219248178336256118e-1 * t117 * t159 - 0.52083333333333333334e-2 * t59 * t417 + 0.40690104166666666668e-3 * t88 * t158 * t166;
  t445 = t43 * t128 * t153;
  t448 = -t442;
  t453 = my_piecewise3(t151, 0.91464571985215438873e-2 * t44 * t128 * t153, t442 * t155 + 0.91464571985215438873e-2 * t346 * t445 + t448 * t150 + 0.646416e0 * t352 * t424);
  t454 = my_piecewise3(t124, 0.646416e0 * t301 * t424, t453);
  t458 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t454);
  tvsigma2 = t6 * t458;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t461 = t23 * t23;
  t462 = 0.1e1 / t461;
  t463 = t185 * t185;
  t466 = t181 * t6;
  t467 = 0.1e1 / t466;
  t468 = t16 * t467;
  t471 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t182 + 0.2e1 * t468);
  t475 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t463 + 0.4e1 / 0.3e1 * t23 * t471);
  t476 = t475 * t26;
  t480 = t188 * t194;
  t482 = t5 * t480 * t102;
  t488 = 0.1e1 / t193 / t6;
  t489 = t25 * t488;
  t492 = t5 * t489 * t102 / 0.12e2;
  t494 = t5 * t195 * t256;
  t497 = 0.1e1 / t199 / t70;
  t498 = t220 * t220;
  t502 = 0.1e1 / t46 / t61;
  t503 = sigma[0] * t502;
  t504 = t44 * t503;
  t510 = 0.1e1 / t35 / t237;
  t511 = t60 * t510;
  t515 = t30 * t30;
  t516 = 0.1e1 / t515;
  t517 = t60 * sigma[0];
  t518 = t516 * t517;
  t519 = t61 * t61;
  t520 = t519 * t45;
  t521 = 0.1e1 / t520;
  t530 = t28 / t42 / t515;
  t531 = t60 * t60;
  t532 = t519 * t61;
  t534 = 0.1e1 / t46 / t532;
  t536 = t68 * t68;
  t537 = 0.1e1 / t536;
  t541 = 0.11e3 / 0.2187e4 * t504 + 0.39134815150061607728e-1 * t44 * t503 * t53 - 0.4002424276710846245e-2 * t59 * t511 * t53 + 0.29647587234895157371e-3 * t518 * t521 * t53 + 0.46546888076566221358e-3 * t59 * t511 * t216 - 0.32409166382013480325e-7 * t530 * t531 * t534 * t537;
  t545 = t503 * t76;
  t548 = t511 * t76;
  t553 = 0.1e1 / t35 / t201;
  t558 = 0.1e1 / t90;
  t564 = 0.1e1 / t46 / t519;
  t568 = 0.5915e0 * t33 * t34 * t553 - 0.19066666666666666667e1 * t504 + 0.17625664237781674824e0 * t81 * t558 - 0.87962962962962962964e-1 * t59 * t511 + 0.83188657407407407412e-2 * t88 * t89 * t564;
  t570 = t243 * t28;
  t571 = t570 * t43;
  t576 = t96 * t29;
  t577 = t576 * t58;
  t580 = -t568;
  t582 = t249 * t200;
  t585 = t98 * t497;
  t591 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t545 - 0.73992419488678004547e-3 * t59 * t548, t568 * t78 - 0.487811050587815674e-1 * t571 * t223 + 0.89432025941099540233e-1 * t246 * t545 - 0.73992419488678004547e-3 * t577 * t548 + t580 * t73 + 0.1292832e1 * t582 * t220 - 0.1292832e1 * t585 * t498 + 0.646416e0 * t251 * t541);
  t592 = my_piecewise3(t41, -0.1292832e1 * t497 * t498 + 0.646416e0 * t200 * t541, t591);
  t597 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t102 - t482 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t256 + t492 - t494 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t592);
  t598 = t113 * t113;
  t599 = 0.1e1 / t598;
  t600 = t264 * t264;
  t603 = t108 * t467;
  t606 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t182 + 0.2e1 * t603);
  t610 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t600 + 0.4e1 / 0.3e1 * t113 * t606);
  t611 = t610 * t26;
  t615 = t267 * t194;
  t617 = t5 * t615 * t176;
  t619 = t115 * t488;
  t622 = t5 * t619 * t176 / 0.12e2;
  t624 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t176 - t617 / 0.4e1 + t622);
  tv2rho20 = 0.2e1 * t261 + 0.2e1 * t277 + t6 * (t597 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t627 = t462 * t281;
  t631 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t468);
  t635 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t627 * t185 + 0.4e1 / 0.3e1 * t23 * t631);
  t636 = t635 * t26;
  t640 = t284 * t194;
  t642 = t5 * t640 * t102;
  t650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t102 - t642 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t256 - t482 / 0.8e1 + t492 - t494 / 0.8e1);
  t651 = t599 * t292;
  t655 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t603);
  t659 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t651 * t264 + 0.4e1 / 0.3e1 * t113 * t655);
  t660 = t659 * t26;
  t664 = t295 * t194;
  t666 = t5 * t664 * t176;
  t673 = t5 * t272 * t357;
  t676 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t176 - t666 / 0.8e1 - t617 / 0.8e1 + t622 - 0.3e1 / 0.8e1 * t5 * t268 * t357 - t673 / 0.8e1);
  tv2rho21 = t261 + t277 + t290 + t362 + t6 * (t650 + t676);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t681 = t281 * t281;
  t686 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t182 + 0.2e1 * t468);
  t690 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t681 + 0.4e1 / 0.3e1 * t23 * t686);
  t691 = t690 * t26;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t102 - t642 / 0.4e1 + t492);
  t698 = t292 * t292;
  t703 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t182 + 0.2e1 * t603);
  t707 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t698 + 0.4e1 / 0.3e1 * t113 * t703);
  t708 = t707 * t26;
  t718 = 0.1e1 / t300 / t147;
  t719 = t321 * t321;
  t723 = 0.1e1 / t126 / t138;
  t724 = sigma[2] * t723;
  t725 = t44 * t724;
  t731 = 0.1e1 / t118 / t338;
  t732 = t137 * t731;
  t736 = t137 * sigma[2];
  t737 = t516 * t736;
  t738 = t138 * t138;
  t739 = t738 * t125;
  t740 = 0.1e1 / t739;
  t747 = t137 * t137;
  t748 = t738 * t138;
  t750 = 0.1e1 / t126 / t748;
  t752 = t145 * t145;
  t753 = 0.1e1 / t752;
  t757 = 0.11e3 / 0.2187e4 * t725 + 0.39134815150061607728e-1 * t44 * t724 * t133 - 0.4002424276710846245e-2 * t59 * t732 * t133 + 0.29647587234895157371e-3 * t737 * t740 * t133 + 0.46546888076566221358e-3 * t59 * t732 * t317 - 0.32409166382013480325e-7 * t530 * t747 * t750 * t753;
  t761 = t724 * t153;
  t764 = t732 * t153;
  t769 = 0.1e1 / t118 / t302;
  t774 = 0.1e1 / t164;
  t780 = 0.1e1 / t126 / t738;
  t784 = 0.5915e0 * t33 * t117 * t769 - 0.19066666666666666667e1 * t725 + 0.17625664237781674824e0 * t158 * t774 - 0.87962962962962962964e-1 * t59 * t732 + 0.83188657407407407412e-2 * t88 * t163 * t780;
  t786 = t344 * t28;
  t787 = t786 * t43;
  t792 = t170 * t29;
  t793 = t792 * t58;
  t796 = -t784;
  t798 = t350 * t301;
  t801 = t172 * t718;
  t807 = my_piecewise3(t151, 0.89432025941099540233e-1 * t44 * t761 - 0.73992419488678004547e-3 * t59 * t764, t784 * t155 - 0.487811050587815674e-1 * t787 * t324 + 0.89432025941099540233e-1 * t347 * t761 - 0.73992419488678004547e-3 * t793 * t764 + t796 * t150 + 0.1292832e1 * t798 * t321 - 0.1292832e1 * t801 * t719 + 0.646416e0 * t352 * t757);
  t808 = my_piecewise3(t124, -0.1292832e1 * t718 * t719 + 0.646416e0 * t301 * t757, t807);
  t813 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t176 - t666 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t357 + t622 - t673 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t808);
  tv2rho22 = 0.2e1 * t290 + 0.2e1 * t362 + t6 * (t697 + t813);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t821 = t5 * t195 * t407 / 0.8e1;
  t822 = t497 * t377;
  t825 = t44 * t203;
  t830 = t211 * sigma[0];
  t834 = t516 * t60;
  t835 = t519 * rho[0];
  t836 = 0.1e1 / t835;
  t843 = t519 * t201;
  t845 = 0.1e1 / t46 / t843;
  t850 = -0.1e2 / 0.729e3 * t825 - 0.10673131404562256653e-1 * t44 * t203 * t53 + 0.13341414255702820817e-2 * t59 * t830 * t53 - 0.11117845213085684014e-3 * t834 * t836 * t53 - 0.14699017287336701482e-3 * t59 * t830 * t216 + 0.12153437393255055122e-7 * t530 * t517 * t845 * t537;
  t857 = t830 * t76;
  t872 = -0.12675e0 * t33 * t383 * t227 + 0.52e0 * t825 - 0.52876992713345024472e-1 * t34 * t232 + 0.27777777777777777778e-1 * t59 * t830 - 0.27126736111111111112e-2 * t88 * t81 * t239;
  t874 = t395 * t28;
  t875 = t874 * t43;
  t881 = t43 * t203 * t76;
  t886 = -t872;
  t888 = t401 * t200;
  t893 = t377 * t220;
  t899 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t203 * t76 + 0.27747157308254251705e-3 * t59 * t857, t872 * t78 - 0.243905525293907837e-1 * t875 * t223 + 0.91464571985215438873e-2 * t570 * t398 - 0.24390552529390783699e-1 * t245 * t881 + 0.27747157308254251705e-3 * t577 * t857 + t886 * t73 + 0.646416e0 * t888 * t220 + 0.646416e0 * t582 * t377 - 0.1292832e1 * t585 * t893 + 0.646416e0 * t251 * t850);
  t900 = my_piecewise3(t41, -0.1292832e1 * t822 * t220 + 0.646416e0 * t200 * t850, t899);
  t905 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t407 - t821 - 0.3e1 / 0.8e1 * t5 * t27 * t900);
  tv2rhosigma0 = t6 * t905 + t411;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t912 = t5 * t272 * t454 / 0.8e1;
  t914 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t454 - t912);
  tv2rhosigma2 = t6 * t914 + t458;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t920 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t407 - t821);
  tv2rhosigma3 = t6 * t920 + t411;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t925 = t718 * t424;
  t928 = t44 * t304;
  t933 = t312 * sigma[2];
  t937 = t516 * t137;
  t938 = t738 * rho[1];
  t939 = 0.1e1 / t938;
  t946 = t738 * t302;
  t948 = 0.1e1 / t126 / t946;
  t953 = -0.1e2 / 0.729e3 * t928 - 0.10673131404562256653e-1 * t44 * t304 * t133 + 0.13341414255702820817e-2 * t59 * t933 * t133 - 0.11117845213085684014e-3 * t937 * t939 * t133 - 0.14699017287336701482e-3 * t59 * t933 * t317 + 0.12153437393255055122e-7 * t530 * t736 * t948 * t753;
  t960 = t933 * t153;
  t975 = -0.12675e0 * t33 * t430 * t328 + 0.52e0 * t928 - 0.52876992713345024472e-1 * t117 * t333 + 0.27777777777777777778e-1 * t59 * t933 - 0.27126736111111111112e-2 * t88 * t158 * t340;
  t977 = t442 * t28;
  t978 = t977 * t43;
  t984 = t43 * t304 * t153;
  t989 = -t975;
  t991 = t448 * t301;
  t996 = t424 * t321;
  t1002 = my_piecewise3(t151, -0.24390552529390783699e-1 * t44 * t304 * t153 + 0.27747157308254251705e-3 * t59 * t960, t975 * t155 - 0.243905525293907837e-1 * t978 * t324 + 0.91464571985215438873e-2 * t786 * t445 - 0.24390552529390783699e-1 * t346 * t984 + 0.27747157308254251705e-3 * t793 * t960 + t989 * t150 + 0.646416e0 * t991 * t321 + 0.646416e0 * t798 * t424 - 0.1292832e1 * t801 * t996 + 0.646416e0 * t352 * t953);
  t1003 = my_piecewise3(t124, -0.1292832e1 * t925 * t321 + 0.646416e0 * t301 * t953, t1002);
  t1008 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t454 - t912 - 0.3e1 / 0.8e1 * t5 * t116 * t1003);
  tv2rhosigma5 = t6 * t1008 + t458;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1010 = t377 * t377;
  t1016 = t516 * sigma[0];
  t1017 = 0.1e1 / t519;
  t1025 = 0.1e1 / t46 / t520;
  t1030 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1016 * t1017 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t216 - 0.45575390224706456708e-8 * t530 * t60 * t1025 * t537;
  t1037 = 0.1e1 / t81;
  t1048 = -0.4753125e-1 * t33 * t1037 * t37 + 0.6609624089168128059e-2 * t383 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1053 = t58 * t64 * t76;
  t1056 = -t1048;
  t1065 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1048 * t78 + 0.18292914397043087775e-1 * t874 * t398 - 0.10405183990595344389e-3 * t576 * t1053 + t1056 * t73 + 0.1292832e1 * t888 * t377 - 0.1292832e1 * t585 * t1010 + 0.646416e0 * t251 * t1030);
  t1066 = my_piecewise3(t41, -0.1292832e1 * t497 * t1010 + 0.646416e0 * t200 * t1030, t1065);
  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1066);
  tv2sigma20 = t6 * t1070;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1071 = t424 * t424;
  t1077 = t516 * sigma[2];
  t1078 = 0.1e1 / t738;
  t1086 = 0.1e1 / t126 / t739;
  t1091 = -0.33353535639257052042e-3 * t59 * t141 * t133 + 0.41691919549071315052e-4 * t1077 * t1078 * t133 + 0.27560657413756315278e-4 * t59 * t141 * t317 - 0.45575390224706456708e-8 * t530 * t137 * t1086 * t753;
  t1098 = 0.1e1 / t158;
  t1109 = -0.4753125e-1 * t33 * t1098 * t120 + 0.6609624089168128059e-2 * t430 * t159 - 0.52083333333333333334e-2 * t59 * t141 + 0.61035156250000000002e-3 * t88 * t117 * t166;
  t1114 = t58 * t141 * t153;
  t1117 = -t1109;
  t1126 = my_piecewise3(t151, -0.10405183990595344389e-3 * t59 * t141 * t153, t1109 * t155 + 0.18292914397043087775e-1 * t977 * t445 - 0.10405183990595344389e-3 * t792 * t1114 + t1117 * t150 + 0.1292832e1 * t991 * t424 - 0.1292832e1 * t801 * t1071 + 0.646416e0 * t352 * t1091);
  t1127 = my_piecewise3(t124, -0.1292832e1 * t718 * t1071 + 0.646416e0 * t301 * t1091, t1126);
  t1131 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t1127);
  tv2sigma25 = t6 * t1131;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1135 = 0.1e1 / t461 / t19;
  t1136 = t463 * t185;
  t1139 = t462 * t185;
  t1142 = t181 * t181;
  t1143 = 0.1e1 / t1142;
  t1144 = t16 * t1143;
  t1147 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t467 - 0.6e1 * t1144);
  t1151 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1135 * t1136 + 0.4e1 / 0.3e1 * t1139 * t471 + 0.4e1 / 0.3e1 * t23 * t1147);
  t1152 = t1151 * t26;
  t1156 = t475 * t194;
  t1158 = t5 * t1156 * t102;
  t1163 = t188 * t488;
  t1165 = t5 * t1163 * t102;
  t1168 = t5 * t480 * t256;
  t1174 = 0.1e1 / t193 / t181;
  t1175 = t25 * t1174;
  t1178 = 0.5e1 / 0.36e2 * t5 * t1175 * t102;
  t1180 = t5 * t489 * t256;
  t1183 = t5 * t195 * t592;
  t1185 = t199 * t199;
  t1186 = 0.1e1 / t1185;
  t1187 = t498 * t220;
  t1190 = t497 * t220;
  t1194 = 0.1e1 / t46 / t62;
  t1195 = sigma[0] * t1194;
  t1196 = t44 * t1195;
  t1202 = 0.1e1 / t35 / t519;
  t1203 = t60 * t1202;
  t1207 = 0.1e1 / t843;
  t1211 = t516 * t531;
  t1212 = t519 * t62;
  t1214 = 0.1e1 / t46 / t1212;
  t1216 = t44 * t53;
  t1226 = t531 * t60;
  t1227 = t519 * t519;
  t1229 = 0.1e1 / t1227 / t201;
  t1232 = 0.1e1 / t536 / t68;
  t1235 = -0.154e4 / 0.6561e4 * t1196 - 0.1826291373669541694e0 * t44 * t1195 * t53 + 0.33699424156997495545e-1 * t59 * t1203 * t53 - 0.56330415746300799004e-2 * t518 * t1207 * t53 + 0.32941763594327952634e-4 * t1211 * t1214 * t1216 - 0.34134384589481895663e-2 * t59 * t1203 * t216 + 0.61577416125825612618e-6 * t530 * t531 * t1214 * t537 - 0.3012370804988962832e-14 * t1226 * t1229 * t1232;
  t1239 = t1195 * t76;
  t1242 = t1203 * t76;
  t1250 = 0.1e1 / t35 / t61;
  t1255 = 0.1e1 / t237;
  t1261 = 0.1e1 / t46 / t835;
  t1265 = -0.19716666666666666667e1 * t33 * t34 * t1250 + 0.88977777777777777779e1 * t1196 - 0.10575398542669004894e1 * t81 * t1255 + 0.6450617283950617284e0 * t59 * t1203 - 0.72096836419753086424e-1 * t88 * t89 * t1261;
  t1267 = t568 * t28;
  t1268 = t1267 * t43;
  t1273 = t243 * t29;
  t1274 = t1273 * t58;
  t1281 = t96 * t517;
  t1282 = t1207 * t76;
  t1285 = -t1265;
  t1287 = t580 * t200;
  t1290 = t249 * t497;
  t1295 = t98 * t1186;
  t1298 = t220 * t541;
  t1303 = t1265 * t78 - 0.731716575881723511e-1 * t1268 * t223 + 0.2682960778232986207e0 * t571 * t545 - 0.22197725846603401364e-2 * t1274 * t548 - 0.41734945439179785442e0 * t246 * t1239 + 0.81391661437545805002e-2 * t577 * t1242 - 0.13826255501780643787e-5 * t1281 * t1282 + t1285 * t73 + 0.1939248e1 * t1287 * t220 - 0.3878496e1 * t1290 * t498 + 0.1939248e1 * t582 * t541 + 0.3878496e1 * t1295 * t1187 - 0.3878496e1 * t585 * t1298 + 0.646416e0 * t251 * t1235;
  t1304 = my_piecewise3(t74, -0.41734945439179785442e0 * t44 * t1239 + 0.81391661437545805002e-2 * t59 * t1242 - 0.13826255501780643787e-5 * t517 * t1207 * t76, t1303);
  t1305 = my_piecewise3(t41, 0.3878496e1 * t1186 * t1187 - 0.3878496e1 * t1190 * t541 + 0.646416e0 * t200 * t1235, t1304);
  t1310 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1152 * t102 - 0.3e1 / 0.8e1 * t1158 - 0.9e1 / 0.8e1 * t5 * t476 * t256 + t1165 / 0.4e1 - 0.3e1 / 0.4e1 * t1168 - 0.9e1 / 0.8e1 * t5 * t189 * t592 - t1178 + t1180 / 0.4e1 - 0.3e1 / 0.8e1 * t1183 - 0.3e1 / 0.8e1 * t5 * t27 * t1305);
  t1312 = 0.1e1 / t598 / t111;
  t1313 = t600 * t264;
  t1316 = t599 * t264;
  t1319 = t108 * t1143;
  t1322 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t467 - 0.6e1 * t1319);
  t1326 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1312 * t1313 + 0.4e1 / 0.3e1 * t1316 * t606 + 0.4e1 / 0.3e1 * t113 * t1322);
  t1327 = t1326 * t26;
  t1331 = t610 * t194;
  t1333 = t5 * t1331 * t176;
  t1335 = t267 * t488;
  t1337 = t5 * t1335 * t176;
  t1339 = t115 * t1174;
  t1342 = 0.5e1 / 0.36e2 * t5 * t1339 * t176;
  t1344 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t176 - 0.3e1 / 0.8e1 * t1333 + t1337 / 0.4e1 - t1342);
  tv3rho30 = 0.3e1 * t597 + 0.3e1 * t624 + t6 * (t1310 + t1344);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1347 = 0.2e1 * t650;
  t1348 = 0.2e1 * t676;
  t1349 = t1135 * t281;
  t1352 = t462 * t631;
  t1357 = 0.2e1 * t467;
  t1358 = 0.6e1 * t1144;
  t1360 = my_piecewise5(t10, 0, t14, 0, t1357 - t1358);
  t1364 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1349 * t463 + 0.8e1 / 0.9e1 * t1352 * t185 + 0.4e1 / 0.9e1 * t627 * t471 + 0.4e1 / 0.3e1 * t23 * t1360);
  t1365 = t1364 * t26;
  t1369 = t635 * t194;
  t1372 = t5 * t1369 * t102 / 0.4e1;
  t1376 = t284 * t488;
  t1378 = t5 * t1376 * t102;
  t1382 = t5 * t640 * t256 / 0.4e1;
  t1391 = -0.3e1 / 0.8e1 * t5 * t1365 * t102 - t1372 - 0.3e1 / 0.4e1 * t5 * t636 * t256 + t1378 / 0.12e2 - t1382 - 0.3e1 / 0.8e1 * t5 * t285 * t592 - t1158 / 0.8e1 + t1165 / 0.6e1 - t1168 / 0.4e1 - t1178 + t1180 / 0.6e1 - t1183 / 0.8e1;
  t1392 = my_piecewise3(t1, 0, t1391);
  t1393 = t1312 * t292;
  t1396 = t599 * t655;
  t1401 = 0.6e1 * t1319;
  t1403 = my_piecewise5(t14, 0, t10, 0, -t1357 - t1401);
  t1407 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1393 * t600 + 0.8e1 / 0.9e1 * t1396 * t264 + 0.4e1 / 0.9e1 * t651 * t606 + 0.4e1 / 0.3e1 * t113 * t1403);
  t1408 = t1407 * t26;
  t1412 = t659 * t194;
  t1415 = t5 * t1412 * t176 / 0.4e1;
  t1416 = t295 * t488;
  t1418 = t5 * t1416 * t176;
  t1427 = t5 * t615 * t357 / 0.4e1;
  t1429 = t5 * t619 * t357;
  t1432 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1408 * t176 - t1415 + t1418 / 0.12e2 - t1333 / 0.8e1 + t1337 / 0.6e1 - t1342 - 0.3e1 / 0.8e1 * t5 * t611 * t357 - t1427 + t1429 / 0.12e2);
  tv3rho31 = t597 + t624 + t1347 + t1348 + t6 * (t1392 + t1432);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1435 = t1135 * t681;
  t1440 = t462 * t686;
  t1444 = my_piecewise5(t10, 0, t14, 0, -t1357 - t1358);
  t1448 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1435 * t185 + 0.8e1 / 0.9e1 * t627 * t631 + 0.4e1 / 0.9e1 * t1440 * t185 + 0.4e1 / 0.3e1 * t23 * t1444);
  t1449 = t1448 * t26;
  t1453 = t690 * t194;
  t1455 = t5 * t1453 * t102;
  t1464 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1449 * t102 - t1455 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t691 * t256 - t1372 + t1378 / 0.6e1 - t1382 + t1165 / 0.12e2 - t1178 + t1180 / 0.12e2);
  t1465 = t1312 * t698;
  t1470 = t599 * t703;
  t1474 = my_piecewise5(t14, 0, t10, 0, t1357 - t1401);
  t1478 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1465 * t264 + 0.8e1 / 0.9e1 * t651 * t655 + 0.4e1 / 0.9e1 * t1470 * t264 + 0.4e1 / 0.3e1 * t113 * t1474);
  t1479 = t1478 * t26;
  t1483 = t707 * t194;
  t1485 = t5 * t1483 * t176;
  t1492 = t5 * t664 * t357;
  t1500 = t5 * t272 * t808;
  t1502 = -0.3e1 / 0.8e1 * t5 * t1479 * t176 - t1485 / 0.8e1 - t1415 + t1418 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t660 * t357 - t1492 / 0.4e1 + t1337 / 0.12e2 - t1342 - t1427 + t1429 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t268 * t808 - t1500 / 0.8e1;
  t1503 = my_piecewise3(t107, 0, t1502);
  tv3rho32 = t1347 + t1348 + t697 + t813 + t6 * (t1464 + t1503);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1508 = t681 * t281;
  t1515 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t467 - 0.6e1 * t1144);
  t1519 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1135 * t1508 + 0.4e1 / 0.3e1 * t627 * t686 + 0.4e1 / 0.3e1 * t23 * t1515);
  t1520 = t1519 * t26;
  t1527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1520 * t102 - 0.3e1 / 0.8e1 * t1455 + t1378 / 0.4e1 - t1178);
  t1528 = t698 * t292;
  t1535 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t467 - 0.6e1 * t1319);
  t1539 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1312 * t1528 + 0.4e1 / 0.3e1 * t651 * t703 + 0.4e1 / 0.3e1 * t113 * t1535);
  t1540 = t1539 * t26;
  t1555 = t300 * t300;
  t1556 = 0.1e1 / t1555;
  t1557 = t719 * t321;
  t1560 = t718 * t321;
  t1564 = 0.1e1 / t126 / t139;
  t1565 = sigma[2] * t1564;
  t1566 = t44 * t1565;
  t1572 = 0.1e1 / t118 / t738;
  t1573 = t137 * t1572;
  t1577 = 0.1e1 / t946;
  t1581 = t516 * t747;
  t1582 = t738 * t139;
  t1584 = 0.1e1 / t126 / t1582;
  t1586 = t44 * t133;
  t1596 = t747 * t137;
  t1597 = t738 * t738;
  t1599 = 0.1e1 / t1597 / t302;
  t1602 = 0.1e1 / t752 / t145;
  t1605 = -0.154e4 / 0.6561e4 * t1566 - 0.1826291373669541694e0 * t44 * t1565 * t133 + 0.33699424156997495545e-1 * t59 * t1573 * t133 - 0.56330415746300799004e-2 * t737 * t1577 * t133 + 0.32941763594327952634e-4 * t1581 * t1584 * t1586 - 0.34134384589481895663e-2 * t59 * t1573 * t317 + 0.61577416125825612618e-6 * t530 * t747 * t1584 * t753 - 0.3012370804988962832e-14 * t1596 * t1599 * t1602;
  t1609 = t1565 * t153;
  t1612 = t1573 * t153;
  t1620 = 0.1e1 / t118 / t138;
  t1625 = 0.1e1 / t338;
  t1631 = 0.1e1 / t126 / t938;
  t1635 = -0.19716666666666666667e1 * t33 * t117 * t1620 + 0.88977777777777777779e1 * t1566 - 0.10575398542669004894e1 * t158 * t1625 + 0.6450617283950617284e0 * t59 * t1573 - 0.72096836419753086424e-1 * t88 * t163 * t1631;
  t1637 = t784 * t28;
  t1638 = t1637 * t43;
  t1643 = t344 * t29;
  t1644 = t1643 * t58;
  t1651 = t170 * t736;
  t1652 = t1577 * t153;
  t1655 = -t1635;
  t1657 = t796 * t301;
  t1660 = t350 * t718;
  t1665 = t172 * t1556;
  t1668 = t321 * t757;
  t1673 = t1635 * t155 - 0.731716575881723511e-1 * t1638 * t324 + 0.2682960778232986207e0 * t787 * t761 - 0.22197725846603401364e-2 * t1644 * t764 - 0.41734945439179785442e0 * t347 * t1609 + 0.81391661437545805002e-2 * t793 * t1612 - 0.13826255501780643787e-5 * t1651 * t1652 + t1655 * t150 + 0.1939248e1 * t1657 * t321 - 0.3878496e1 * t1660 * t719 + 0.1939248e1 * t798 * t757 + 0.3878496e1 * t1665 * t1557 - 0.3878496e1 * t801 * t1668 + 0.646416e0 * t352 * t1605;
  t1674 = my_piecewise3(t151, -0.41734945439179785442e0 * t44 * t1609 + 0.81391661437545805002e-2 * t59 * t1612 - 0.13826255501780643787e-5 * t736 * t1577 * t153, t1673);
  t1675 = my_piecewise3(t124, 0.3878496e1 * t1556 * t1557 - 0.3878496e1 * t1560 * t757 + 0.646416e0 * t301 * t1605, t1674);
  t1680 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1540 * t176 - 0.3e1 / 0.8e1 * t1485 - 0.9e1 / 0.8e1 * t5 * t708 * t357 + t1418 / 0.4e1 - 0.3e1 / 0.4e1 * t1492 - 0.9e1 / 0.8e1 * t5 * t296 * t808 - t1342 + t1429 / 0.4e1 - 0.3e1 / 0.8e1 * t1500 - 0.3e1 / 0.8e1 * t5 * t116 * t1675);
  tv3rho33 = 0.3e1 * t697 + 0.3e1 * t813 + t6 * (t1527 + t1680);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1688 = t5 * t480 * t407;
  t1695 = t5 * t489 * t407 / 0.12e2;
  t1697 = t5 * t195 * t900;
  t1699 = t1186 * t377;
  t1702 = t497 * t850;
  t1707 = t44 * t502;
  t1712 = t510 * sigma[0];
  t1716 = t516 * t521;
  t1717 = t60 * t53;
  t1730 = t531 * sigma[0];
  t1732 = 0.1e1 / t1227 / t45;
  t1736 = 0.11e3 / 0.2187e4 * t1707 + 0.39134815150061607728e-1 * t44 * t502 * t53 - 0.96354658513409261456e-2 * t59 * t1712 * t53 + 0.18900336862245662824e-2 * t1716 * t1717 - 0.12353161347872982238e-4 * t518 * t534 * t1216 + 0.93093776153132442719e-3 * t59 * t1712 * t216 - 0.20660843568533593707e-6 * t530 * t517 * t534 * t537 + 0.1129639051870861062e-14 * t1730 * t1732 * t1232;
  t1743 = t1712 * t76;
  t1750 = t377 * t498;
  t1764 = -0.29575e0 * t33 * t383 * t553 + 0.19066666666666666667e1 * t1707 - 0.26438496356672512236e0 * t34 * t558 + 0.17592592592592592593e0 * t59 * t1712 - 0.20797164351851851853e-1 * t88 * t81 * t564;
  t1766 = -t1764;
  t1768 = t872 * t28;
  t1769 = t1768 * t43;
  t1772 = t395 * t29;
  t1773 = t1772 * t58;
  t1781 = t43 * t502 * t76;
  t1786 = t96 * t521;
  t1787 = t60 * t76;
  t1791 = t401 * t497;
  t1796 = t850 * t220;
  t1799 = t377 * t541;
  t1806 = t886 * t200;
  t1817 = -0.1292832e1 * t1791 * t498 - 0.2585664e1 * t1290 * t893 - 0.2585664e1 * t585 * t1796 - 0.1292832e1 * t585 * t1799 + 0.91464571985215438873e-2 * t1267 * t398 + 0.646416e0 * t251 * t1736 + 0.1292832e1 * t1806 * t220 + 0.646416e0 * t888 * t541 + 0.646416e0 * t1287 * t377 + 0.1292832e1 * t582 * t850 + 0.89432025941099540233e-1 * t875 * t545;
  t1819 = my_piecewise3(t74, 0.8943202594109954023e-1 * t44 * t502 * t76 - 0.24972441577428826534e-2 * t59 * t1743 + 0.51848458131677414201e-6 * t521 * t60 * t76, 0.3878496e1 * t1295 * t1750 + t1764 * t73 + t1766 * t78 - 0.487811050587815674e-1 * t1769 * t223 - 0.73992419488678004547e-3 * t1773 * t548 - 0.48781105058781567398e-1 * t570 * t881 + 0.5549431461650850341e-3 * t1274 * t857 + 0.8943202594109954023e-1 * t245 * t1781 - 0.24972441577428826534e-2 * t577 * t1743 + 0.51848458131677414201e-6 * t1786 * t1787 + t1817);
  t1820 = my_piecewise3(t41, 0.3878496e1 * t1699 * t498 - 0.2585664e1 * t1702 * t220 - 0.1292832e1 * t822 * t541 + 0.646416e0 * t200 * t1736, t1819);
  t1825 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t407 - t1688 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t900 + t1695 - t1697 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1820);
  tv3rho2sigma0 = t6 * t1825 + 0.2e1 * t905;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1832 = t5 * t615 * t454;
  t1836 = t5 * t619 * t454 / 0.12e2;
  t1838 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t454 - t1832 / 0.4e1 + t1836);
  tv3rho2sigma2 = t6 * t1838 + 0.2e1 * t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1844 = t5 * t640 * t407;
  t1852 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t407 - t1844 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t900 - t1688 / 0.8e1 + t1695 - t1697 / 0.8e1);
  tv3rho2sigma3 = t6 * t1852 + t905 + t920;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1858 = t5 * t664 * t454;
  t1865 = t5 * t272 * t1003;
  t1868 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t454 - t1858 / 0.8e1 - t1832 / 0.8e1 + t1836 - 0.3e1 / 0.8e1 * t5 * t268 * t1003 - t1865 / 0.8e1);
  tv3rho2sigma5 = t6 * t1868 + t1008 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1876 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t407 - t1844 / 0.4e1 + t1695);
  tv3rho2sigma6 = t6 * t1876 + 0.2e1 * t920;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1887 = t1556 * t424;
  t1890 = t718 * t953;
  t1895 = t44 * t723;
  t1900 = t731 * sigma[2];
  t1904 = t516 * t740;
  t1905 = t137 * t133;
  t1918 = t747 * sigma[2];
  t1920 = 0.1e1 / t1597 / t125;
  t1924 = 0.11e3 / 0.2187e4 * t1895 + 0.39134815150061607728e-1 * t44 * t723 * t133 - 0.96354658513409261456e-2 * t59 * t1900 * t133 + 0.18900336862245662824e-2 * t1904 * t1905 - 0.12353161347872982238e-4 * t737 * t750 * t1586 + 0.93093776153132442719e-3 * t59 * t1900 * t317 - 0.20660843568533593707e-6 * t530 * t736 * t750 * t753 + 0.1129639051870861062e-14 * t1918 * t1920 * t1602;
  t1931 = t1900 * t153;
  t1949 = -0.29575e0 * t33 * t430 * t769 + 0.19066666666666666667e1 * t1895 - 0.26438496356672512236e0 * t117 * t774 + 0.17592592592592592593e0 * t59 * t1900 - 0.20797164351851851853e-1 * t88 * t158 * t780;
  t1951 = -t1949;
  t1955 = t424 * t719;
  t1960 = t442 * t29;
  t1961 = t1960 * t58;
  t1969 = t43 * t723 * t153;
  t1975 = t975 * t28;
  t1976 = t1975 * t43;
  t1979 = t953 * t321;
  t1982 = t424 * t757;
  t1985 = t170 * t740;
  t1986 = t137 * t153;
  t1989 = t448 * t718;
  t1996 = t989 * t301;
  t2005 = -0.487811050587815674e-1 * t1976 * t324 - 0.2585664e1 * t801 * t1979 - 0.1292832e1 * t801 * t1982 + 0.51848458131677414201e-6 * t1985 * t1986 - 0.1292832e1 * t1989 * t719 - 0.2585664e1 * t1660 * t996 + 0.646416e0 * t352 * t1924 + 0.1292832e1 * t1996 * t321 + 0.646416e0 * t991 * t757 + 0.646416e0 * t1657 * t424 + 0.1292832e1 * t798 * t953;
  t2007 = my_piecewise3(t151, 0.8943202594109954023e-1 * t44 * t723 * t153 - 0.24972441577428826534e-2 * t59 * t1931 + 0.51848458131677414201e-6 * t740 * t137 * t153, t1949 * t150 + t1951 * t155 + 0.89432025941099540233e-1 * t978 * t761 + 0.3878496e1 * t1665 * t1955 + 0.91464571985215438873e-2 * t1637 * t445 - 0.73992419488678004547e-3 * t1961 * t764 - 0.48781105058781567398e-1 * t786 * t984 + 0.5549431461650850341e-3 * t1644 * t960 + 0.8943202594109954023e-1 * t346 * t1969 - 0.24972441577428826534e-2 * t793 * t1931 + t2005);
  t2008 = my_piecewise3(t124, 0.3878496e1 * t1887 * t719 - 0.2585664e1 * t1890 * t321 - 0.1292832e1 * t925 * t757 + 0.646416e0 * t301 * t1924, t2007);
  t2013 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t454 - t1858 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t1003 + t1836 - t1865 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t2008);
  tv3rho2sigma8 = t6 * t2013 + 0.2e1 * t1008;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2020 = t5 * t195 * t1066 / 0.8e1;
  t2021 = t1186 * t1010;
  t2026 = t497 * t1030;
  t2032 = t516 * t836;
  t2033 = sigma[0] * t53;
  t2042 = t845 * t537;
  t2046 = t1227 * rho[0];
  t2047 = 0.1e1 / t2046;
  t2051 = 0.17788552340937094422e-2 * t59 * t211 * t53 - 0.5558922606542842007e-3 * t2032 * t2033 + 0.46324355054523683391e-5 * t834 * t845 * t1216 - 0.14699017287336701482e-3 * t59 * t211 * t216 + 0.60767186966275275611e-7 * t530 * t2042 * t60 - 0.42361464445157289826e-15 * t531 * t2047 * t1232;
  t2072 = 0.63375e-1 * t33 * t1037 * t227 - 0.26438496356672512236e-1 * t383 * t232 + 0.27777777777777777778e-1 * t59 * t211 - 0.40690104166666666668e-2 * t88 * t34 * t239;
  t2074 = t1048 * t28;
  t2075 = t2074 * t43;
  t2087 = t58 * t211 * t76;
  t2090 = t96 * t836;
  t2091 = sigma[0] * t76;
  t2094 = -t2072;
  t2096 = t1056 * t200;
  t2107 = t1010 * t220;
  t2110 = t377 * t850;
  t2115 = t1030 * t220;
  t2120 = t2072 * t78 - 0.243905525293907837e-1 * t2075 * t223 + 0.18292914397043087775e-1 * t1768 * t398 - 0.487811050587815674e-1 * t874 * t881 + 0.55494314616508503411e-3 * t1773 * t857 - 0.10405183990595344389e-3 * t1273 * t1053 + 0.55494314616508503408e-3 * t576 * t2087 - 0.19443171799379030325e-6 * t2090 * t2091 + t2094 * t73 + 0.646416e0 * t2096 * t220 + 0.1292832e1 * t1806 * t377 - 0.2585664e1 * t1791 * t893 + 0.1292832e1 * t888 * t850 - 0.1292832e1 * t1290 * t1010 + 0.3878496e1 * t1295 * t2107 - 0.2585664e1 * t585 * t2110 + 0.646416e0 * t582 * t1030 - 0.1292832e1 * t585 * t2115 + 0.646416e0 * t251 * t2051;
  t2121 = my_piecewise3(t74, 0.55494314616508503408e-3 * t59 * t211 * t76 - 0.19443171799379030325e-6 * t836 * sigma[0] * t76, t2120);
  t2122 = my_piecewise3(t41, 0.3878496e1 * t2021 * t220 - 0.2585664e1 * t822 * t850 - 0.1292832e1 * t2026 * t220 + 0.646416e0 * t200 * t2051, t2121);
  t2127 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t1066 - t2020 - 0.3e1 / 0.8e1 * t5 * t27 * t2122);
  tv3rhosigma20 = t6 * t2127 + t1070;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2134 = t5 * t272 * t1127 / 0.8e1;
  t2136 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t1127 - t2134);
  tv3rhosigma25 = t6 * t2136 + t1131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t1066 - t2020);
  tv3rhosigma26 = t6 * t2142 + t1070;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2147 = t1556 * t1071;
  t2152 = t718 * t1091;
  t2158 = t516 * t939;
  t2159 = sigma[2] * t133;
  t2168 = t948 * t753;
  t2172 = t1597 * rho[1];
  t2173 = 0.1e1 / t2172;
  t2177 = 0.17788552340937094422e-2 * t59 * t312 * t133 - 0.5558922606542842007e-3 * t2158 * t2159 + 0.46324355054523683391e-5 * t937 * t948 * t1586 - 0.14699017287336701482e-3 * t59 * t312 * t317 + 0.60767186966275275611e-7 * t530 * t2168 * t137 - 0.42361464445157289826e-15 * t747 * t2173 * t1602;
  t2198 = 0.63375e-1 * t33 * t1098 * t328 - 0.26438496356672512236e-1 * t430 * t333 + 0.27777777777777777778e-1 * t59 * t312 - 0.40690104166666666668e-2 * t88 * t117 * t340;
  t2200 = t1109 * t28;
  t2201 = t2200 * t43;
  t2213 = t58 * t312 * t153;
  t2216 = t170 * t939;
  t2217 = sigma[2] * t153;
  t2220 = -t2198;
  t2222 = t1117 * t301;
  t2233 = t1071 * t321;
  t2236 = t424 * t953;
  t2241 = t1091 * t321;
  t2246 = t2198 * t155 - 0.243905525293907837e-1 * t2201 * t324 + 0.18292914397043087775e-1 * t1975 * t445 - 0.487811050587815674e-1 * t977 * t984 + 0.55494314616508503411e-3 * t1961 * t960 - 0.10405183990595344389e-3 * t1643 * t1114 + 0.55494314616508503408e-3 * t792 * t2213 - 0.19443171799379030325e-6 * t2216 * t2217 + t2220 * t150 + 0.646416e0 * t2222 * t321 + 0.1292832e1 * t1996 * t424 - 0.2585664e1 * t1989 * t996 + 0.1292832e1 * t991 * t953 - 0.1292832e1 * t1660 * t1071 + 0.3878496e1 * t1665 * t2233 - 0.2585664e1 * t801 * t2236 + 0.646416e0 * t798 * t1091 - 0.1292832e1 * t801 * t2241 + 0.646416e0 * t352 * t2177;
  t2247 = my_piecewise3(t151, 0.55494314616508503408e-3 * t59 * t312 * t153 - 0.19443171799379030325e-6 * t939 * sigma[2] * t153, t2246);
  t2248 = my_piecewise3(t124, 0.3878496e1 * t2147 * t321 - 0.2585664e1 * t925 * t953 - 0.1292832e1 * t2152 * t321 + 0.646416e0 * t301 * t2177, t2247);
  t2253 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t1127 - t2134 - 0.3e1 / 0.8e1 * t5 * t116 * t2248);
  tv3rhosigma211 = t6 * t2253 + t1131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2255 = t1010 * t377;
  t2266 = t1025 * t537;
  t2270 = 0.1e1 / t1227;
  t2274 = 0.12507575864721394516e-3 * t516 * t1017 * t53 - 0.17371633145446381272e-5 * t1016 * t1025 * t1216 - 0.13672617067411937012e-7 * t530 * t2266 * sigma[0] + 0.15885549166933983685e-15 * t517 * t2270 * t1232;
  t2280 = 0.1e1 / t89;
  t2289 = 0.71296875e-1 * t33 * t2280 * t37 - 0.33048120445840640295e-2 * t1037 * t82 + 0.30517578125000000001e-3 * t88 * t383 * t92;
  t2298 = -t2289;
  t2308 = t377 * t1030;
  t2313 = t2289 * t78 + 0.27439371595564631662e-1 * t2074 * t398 - 0.31215551971786033168e-3 * t1772 * t1053 + 0.72911894247671363718e-7 * t96 * t1017 * t76 + t2298 * t73 + 0.1939248e1 * t2096 * t377 - 0.3878496e1 * t1791 * t1010 + 0.1939248e1 * t888 * t1030 + 0.3878496e1 * t1295 * t2255 - 0.3878496e1 * t585 * t2308 + 0.646416e0 * t251 * t2274;
  t2314 = my_piecewise3(t74, 0.72911894247671363718e-7 * t1017 * t76, t2313);
  t2315 = my_piecewise3(t41, 0.3878496e1 * t1186 * t2255 - 0.3878496e1 * t822 * t1030 + 0.646416e0 * t200 * t2274, t2314);
  t2319 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2315);
  tv3sigma30 = t6 * t2319;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2320 = t1071 * t424;
  t2331 = t1086 * t753;
  t2335 = 0.1e1 / t1597;
  t2339 = 0.12507575864721394516e-3 * t516 * t1078 * t133 - 0.17371633145446381272e-5 * t1077 * t1086 * t1586 - 0.13672617067411937012e-7 * t530 * t2331 * sigma[2] + 0.15885549166933983685e-15 * t736 * t2335 * t1602;
  t2345 = 0.1e1 / t163;
  t2354 = 0.71296875e-1 * t33 * t2345 * t120 - 0.33048120445840640295e-2 * t1098 * t159 + 0.30517578125000000001e-3 * t88 * t430 * t166;
  t2363 = -t2354;
  t2373 = t424 * t1091;
  t2378 = t2354 * t155 + 0.27439371595564631662e-1 * t2200 * t445 - 0.31215551971786033168e-3 * t1960 * t1114 + 0.72911894247671363718e-7 * t170 * t1078 * t153 + t2363 * t150 + 0.1939248e1 * t2222 * t424 - 0.3878496e1 * t1989 * t1071 + 0.1939248e1 * t991 * t1091 + 0.3878496e1 * t1665 * t2320 - 0.3878496e1 * t801 * t2373 + 0.646416e0 * t352 * t2339;
  t2379 = my_piecewise3(t151, 0.72911894247671363718e-7 * t1078 * t153, t2378);
  t2380 = my_piecewise3(t124, 0.3878496e1 * t1556 * t2320 - 0.3878496e1 * t925 * t1091 + 0.646416e0 * t301 * t2339, t2379);
  t2384 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t2380);
  tv3sigma39 = t6 * t2384;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t53;
  double t58, t59, t60, t61, t62, t64, t66, t68;
  double t69, t70, t73, t74, t76, t78, t79, t80;
  double t81, t82, t84, t85, t88, t89, t90, t92;
  double t95, t96, t98, t101, t102, t106, t107, t108;
  double t110, t111, t112, t113, t115, t116, t117, t118;
  double t120, t122, t123, t124, t125, t126, t128, t129;
  double t130, t133, t137, t138, t139, t141, t143, t145;
  double t146, t147, t150, t151, t153, t155, t156, t157;
  double t158, t159, t161, t162, t163, t164, t166, t169;
  double t170, t172, t175, t176, t180, tzk0;

  double t181, t182, t183, t185, t188, t189, t193, t194;
  double t195, t198, t199, t200, t201, t203, t204, t205;
  double t211, t212, t216, t220, t223, t227, t232, t237;
  double t239, t243, t245, t246, t249, t251, t255, t256;
  double t261, t262, t264, t267, t268, t272, t275, t277;
  double tvrho0, t281, t284, t285, t290, t292, t295, t296;
  double t300, t301, t302, t304, t305, t306, t312, t313;
  double t317, t321, t324, t328, t333, t338, t340, t344;
  double t346, t347, t350, t352, t356, t357, t362, tvrho1;
  double t365, t370, t377, t383, t395, t398, t401, t406;
  double t407, t411, tvsigma0, tvsigma1, t412, t417, t424, t430;
  double t442, t445, t448, t453, t454, t458, tvsigma2;

  double t461, t462, t463, t466, t467, t468, t471, t475;
  double t476, t480, t482, t488, t489, t492, t494, t497;
  double t498, t502, t503, t504, t510, t511, t515, t516;
  double t517, t518, t519, t520, t521, t530, t531, t532;
  double t534, t536, t537, t541, t545, t548, t553, t558;
  double t564, t568, t570, t571, t576, t577, t580, t582;
  double t585, t591, t592, t597, t598, t599, t600, t603;
  double t606, t610, t611, t615, t617, t619, t622, t624;
  double tv2rho20, t627, t631, t635, t636, t640, t642, t650;
  double t651, t655, t659, t660, t664, t666, t673, t676;
  double tv2rho21, t681, t686, t690, t691, t697, t698, t703;
  double t707, t708, t718, t719, t723, t724, t725, t731;
  double t732, t736, t737, t738, t739, t740, t747, t748;
  double t750, t752, t753, t757, t761, t764, t769, t774;
  double t780, t784, t786, t787, t792, t793, t796, t798;
  double t801, t807, t808, t813, tv2rho22, t821, t822, t825;
  double t830, t834, t835, t836, t843, t845, t850, t857;
  double t872, t874, t875, t881, t886, t888, t893, t899;
  double t900, t905, tv2rhosigma0, tv2rhosigma1, t912, t914, tv2rhosigma2, t920;
  double tv2rhosigma3, tv2rhosigma4, t925, t928, t933, t937, t938, t939;
  double t946, t948, t953, t960, t975, t977, t978, t984;
  double t989, t991, t996, t1002, t1003, t1008, tv2rhosigma5, t1010;
  double t1016, t1017, t1025, t1030, t1037, t1048, t1053, t1056;
  double t1065, t1066, t1070, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t1071, t1077, t1078, t1086, t1091, t1098, t1109, t1114;
  double t1117, t1126, t1127, t1131, tv2sigma25;

  double t1135, t1136, t1139, t1142, t1143, t1144, t1147, t1151;
  double t1152, t1156, t1158, t1163, t1165, t1168, t1174, t1175;
  double t1178, t1180, t1183, t1185, t1186, t1187, t1190, t1194;
  double t1195, t1196, t1202, t1203, t1207, t1211, t1212, t1214;
  double t1216, t1226, t1227, t1229, t1232, t1235, t1239, t1242;
  double t1250, t1255, t1261, t1265, t1267, t1268, t1273, t1274;
  double t1281, t1282, t1285, t1287, t1290, t1295, t1298, t1303;
  double t1304, t1305, t1310, t1312, t1313, t1316, t1319, t1322;
  double t1326, t1327, t1331, t1333, t1335, t1337, t1339, t1342;
  double t1344, tv3rho30, t1347, t1348, t1349, t1352, t1357, t1358;
  double t1360, t1364, t1365, t1369, t1372, t1376, t1378, t1382;
  double t1391, t1392, t1393, t1396, t1401, t1403, t1407, t1408;
  double t1412, t1415, t1416, t1418, t1427, t1429, t1432, tv3rho31;
  double t1435, t1440, t1444, t1448, t1449, t1453, t1455, t1464;
  double t1465, t1470, t1474, t1478, t1479, t1483, t1485, t1492;
  double t1500, t1502, t1503, tv3rho32, t1508, t1515, t1519, t1520;
  double t1527, t1528, t1535, t1539, t1540, t1555, t1556, t1557;
  double t1560, t1564, t1565, t1566, t1572, t1573, t1577, t1581;
  double t1582, t1584, t1586, t1596, t1597, t1599, t1602, t1605;
  double t1609, t1612, t1620, t1625, t1631, t1635, t1637, t1638;
  double t1643, t1644, t1651, t1652, t1655, t1657, t1660, t1665;
  double t1668, t1673, t1674, t1675, t1680, tv3rho33, t1688, t1695;
  double t1697, t1699, t1702, t1707, t1712, t1716, t1717, t1730;
  double t1732, t1736, t1743, t1750, t1764, t1766, t1768, t1769;
  double t1772, t1773, t1781, t1786, t1787, t1791, t1796, t1799;
  double t1806, t1817, t1819, t1820, t1825, tv3rho2sigma0, tv3rho2sigma1, t1832;
  double t1836, t1838, tv3rho2sigma2, t1844, t1852, tv3rho2sigma3, tv3rho2sigma4, t1858;
  double t1865, t1868, tv3rho2sigma5, t1876, tv3rho2sigma6, tv3rho2sigma7, t1887, t1890;
  double t1895, t1900, t1904, t1905, t1918, t1920, t1924, t1931;
  double t1949, t1951, t1955, t1960, t1961, t1969, t1975, t1976;
  double t1979, t1982, t1985, t1986, t1989, t1996, t2005, t2007;
  double t2008, t2013, tv3rho2sigma8, t2020, t2021, t2026, t2032, t2033;
  double t2042, t2046, t2047, t2051, t2072, t2074, t2075, t2087;
  double t2090, t2091, t2094, t2096, t2107, t2110, t2115, t2120;
  double t2121, t2122, t2127, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t2134, t2136, tv3rhosigma25, t2142, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2147, t2152, t2158, t2159, t2168, t2172, t2173;
  double t2177, t2198, t2200, t2201, t2213, t2216, t2217, t2220;
  double t2222, t2233, t2236, t2241, t2246, t2247, t2248, t2253;
  double tv3rhosigma211, t2255, t2266, t2270, t2274, t2280, t2289, t2298;
  double t2308, t2313, t2314, t2315, t2319, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2320, t2331;
  double t2335, t2339, t2345, t2354, t2363, t2373, t2378, t2379;
  double t2380, t2384, tv3sigma39;

  double t2388, t2389, t2395, t2400, t2401, t2408, t2412, t2416;
  double t2418, t2426, t2432, t2441, t2446, t2449, t2452, t2456;
  double t2459, t2465, t2473, t2477, t2478, t2496, t2505, t2508;
  double t2511, t2514, t2528, t2541, t2543, t2544, t2549, t2552;
  double t2555, t2561, t2564, t2566, t2572, t2576, t2579, t2583;
  double t2587, t2589, t2591, t2592, t2598, t2604, t2605, t2608;
  double t2612, t2620, t2621, t2622, t2624, t2625, t2631, t2636;
  double t2639, t2643, t2650, t2654, t2658, t2663, t2665, tv4rho40;
  double t2675, t2679, t2683, t2684, t2686, t2687, t2689, t2698;
  double t2716, t2717, t2719, t2723, t2737, t2738, t2755, t2757;
  double t2761, t2768, t2772, t2773, t2776, t2785, t2788, t2789;
  double t2791, t2793, t2794, tv4rho41, t2803, t2807, t2820, t2833;
  double t2837, t2846, t2859, t2860, t2869, t2882, t2886, t2893;
  double t2897, t2906, t2909, t2920, t2923, t2925, t2926, tv4rho42;
  double t2947, t2951, t2958, t2969, t2970, t2987, t2991, t2998;
  double t3006, t3015, t3025, t3027, t3028, tv4rho43, t3033, t3038;
  double t3045, t3049, t3058, t3060, t3061, t3067, t3072, t3073;
  double t3080, t3084, t3088, t3090, t3098, t3104, t3113, t3118;
  double t3121, t3124, t3128, t3131, t3137, t3141, t3158, t3161;
  double t3170, t3174, t3175, t3176, t3194, t3204, t3213, t3215;
  double t3216, t3226, t3231, t3238, t3242, t3258, t3259, tv4rho44;
  double t3267, t3273, t3276, t3283, t3285, t3288, t3305, t3310;
  double t3329, t3343, t3350, t3384, t3388, t3389, t3411, t3442;
  double t3446, t3461, t3464, t3467, t3469, t3470, t3475, tv4rho3sigma0;
  double tv4rho3sigma1, t3482, t3485, t3489, t3491, tv4rho3sigma2, t3493, t3499;
  double t3504, t3508, t3517, t3518, tv4rho3sigma3, tv4rho3sigma4, t3520, t3526;
  double t3528, t3537, t3539, t3542, tv4rho3sigma5, t3548, t3557, tv4rho3sigma6;
  double tv4rho3sigma7, t3563, t3570, t3578, t3580, t3581, tv4rho3sigma8, t3590;
  double tv4rho3sigma9, tv4rho3sigma10, t3622, t3627, t3646, t3660, t3667, t3693;
  double t3709, t3710, t3726, t3748, t3763, t3766, t3780, t3784;
  double t3786, t3787, t3792, tv4rho3sigma11, t3799, t3806, t3808, t3817;
  double t3861, t3894, t3895, t3907, t3930, t3953, t3967, t3988;
  double t3992, t3995, t3996, t4001, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t4008, t4012, t4014, tv4rho2sigma25, t4020, t4028, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t4034, t4041, t4044, tv4rho2sigma211;
  double t4052, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t4070, t4114;
  double t4156, t4160, t4161, t4166, t4169, t4182, t4200, t4245;
  double t4248, t4249, t4254, tv4rho2sigma217, t4261, t4280, t4301, t4308;
  double t4312, t4344, t4356, t4392, t4398, t4400, t4401, t4406;
  double tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37;
  double tv4rhosigma38, t4413, t4415, tv4rhosigma39, t4421, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312;
  double tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t4444, t4465;
  double t4472, t4487, t4508, t4521, t4552, t4562, t4564, t4565;
  double t4570, tv4rhosigma319, t4572, t4577, t4601, t4638, t4657, t4658;
  double t4659, t4663, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t4664, t4669, t4693, t4727, t4749, t4750, t4751, t4755;
  double tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.8040e0 + 0.5e1 / 0.972e3 * t50 + 0.40024242767108462450e-2 * t44 * t49 * t53 + t69;
  t73 = 0.18040e1 - 0.64641600e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.11376190545424805830e-1 * t50);
  t78 = 0.18040e1 - 0.8040e0 * t76;
  t79 = 0.19012500000000000000e0 * t39;
  t80 = 0.19500000000000000000e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608000000000000000e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.14060800000000000000e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = -t16;
  t110 = my_piecewise5(t14, t11, t10, t15, t108 * t7);
  t111 = 0.1e1 + t110;
  t112 = t111 <= p->zeta_threshold;
  t113 = POW_1_3(t111);
  t115 = my_piecewise3(t112, t22, t113 * t111);
  t116 = t115 * t26;
  t117 = sqrt(sigma[2]);
  t118 = POW_1_3(rho[1]);
  t120 = 0.1e1 / t118 / rho[1];
  t122 = t33 * t117 * t120;
  t123 = t122 / 0.12e2;
  t124 = t123 < 0.6e0;
  t125 = rho[1] * rho[1];
  t126 = t118 * t118;
  t128 = 0.1e1 / t126 / t125;
  t129 = sigma[2] * t128;
  t130 = t44 * t129;
  t133 = exp(-t130 / 0.24e2);
  t137 = sigma[2] * sigma[2];
  t138 = t125 * t125;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t118 / t139;
  t143 = t59 * t137 * t141;
  t145 = 0.1e1 + 0.13780328706878157639e-4 * t143;
  t146 = log(t145);
  t147 = 0.804e0 + 0.5e1 / 0.972e3 * t130 + 0.4002424276710846245e-2 * t44 * t129 * t133 + t146;
  t150 = 0.1804e1 - 0.646416e0 / t147;
  t151 = 0.26e1 < t123;
  t153 = exp(-0.1137619054542480583e-1 * t130);
  t155 = 0.1804e1 - 0.804e0 * t153;
  t156 = 0.190125e0 * t122;
  t157 = 0.195e0 * t130;
  t158 = t117 * sigma[2];
  t159 = 0.1e1 / t138;
  t161 = 0.88128321188908374119e-2 * t158 * t159;
  t162 = 0.26041666666666666667e-2 * t143;
  t163 = t117 * t137;
  t164 = t138 * t125;
  t166 = 0.1e1 / t126 / t164;
  t169 = 0.16276041666666666667e-3 * t88 * t163 * t166;
  t170 = -0.40608e0 + t156 - t157 + t161 - t162 + t169;
  t172 = 0.140608e1 - t156 + t157 - t161 + t162 - t169;
  t175 = my_piecewise3(t151, t155, t172 * t150 + t170 * t155);
  t176 = my_piecewise3(t124, t150, t175);
  t180 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t176);
  tzk0 = t106 + t180;

#ifndef XC_DONT_COMPILE_VXC

  t181 = t6 * t6;
  t182 = 0.1e1 / t181;
  t183 = t16 * t182;
  t185 = my_piecewise5(t10, 0, t14, 0, t7 - t183);
  t188 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t185);
  t189 = t188 * t26;
  t193 = t26 * t26;
  t194 = 0.1e1 / t193;
  t195 = t25 * t194;
  t198 = t5 * t195 * t102 / 0.8e1;
  t199 = t70 * t70;
  t200 = 0.1e1 / t199;
  t201 = t45 * rho[0];
  t203 = 0.1e1 / t46 / t201;
  t204 = sigma[0] * t203;
  t205 = t44 * t204;
  t211 = 0.1e1 / t35 / t90;
  t212 = t60 * t211;
  t216 = 0.1e1 / t68;
  t220 = -0.1e2 / 0.729e3 * t205 - 0.10673131404562256653e-1 * t44 * t204 * t53 + 0.44471380852342736056e-3 * t59 * t212 * t53 - 0.73495086436683507408e-4 * t59 * t212 * t216;
  t223 = t204 * t76;
  t227 = 0.1e1 / t35 / t45;
  t232 = 0.1e1 / t62;
  t237 = t61 * t201;
  t239 = 0.1e1 / t46 / t237;
  t243 = -0.2535e0 * t33 * t34 * t227 + 0.52e0 * t205 - 0.35251328475563349648e-1 * t81 * t232 + 0.13888888888888888889e-1 * t59 * t212 - 0.10850694444444444445e-2 * t88 * t89 * t239;
  t245 = t96 * t28;
  t246 = t245 * t43;
  t249 = -t243;
  t251 = t98 * t200;
  t255 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t223, t243 * t78 - 0.243905525293907837e-1 * t246 * t223 + t249 * t73 + 0.646416e0 * t251 * t220);
  t256 = my_piecewise3(t41, 0.646416e0 * t200 * t220, t255);
  t261 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t102 - t198 - 0.3e1 / 0.8e1 * t5 * t27 * t256);
  t262 = t108 * t182;
  t264 = my_piecewise5(t14, 0, t10, 0, -t7 - t262);
  t267 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t264);
  t268 = t267 * t26;
  t272 = t115 * t194;
  t275 = t5 * t272 * t176 / 0.8e1;
  t277 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t176 - t275);
  tvrho0 = t106 + t180 + t6 * (t261 + t277);


  t281 = my_piecewise5(t10, 0, t14, 0, -t7 - t183);
  t284 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t281);
  t285 = t284 * t26;
  t290 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t102 - t198);
  t292 = my_piecewise5(t14, 0, t10, 0, t7 - t262);
  t295 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t292);
  t296 = t295 * t26;
  t300 = t147 * t147;
  t301 = 0.1e1 / t300;
  t302 = t125 * rho[1];
  t304 = 0.1e1 / t126 / t302;
  t305 = sigma[2] * t304;
  t306 = t44 * t305;
  t312 = 0.1e1 / t118 / t164;
  t313 = t137 * t312;
  t317 = 0.1e1 / t145;
  t321 = -0.1e2 / 0.729e3 * t306 - 0.10673131404562256653e-1 * t44 * t305 * t133 + 0.44471380852342736056e-3 * t59 * t313 * t133 - 0.73495086436683507408e-4 * t59 * t313 * t317;
  t324 = t305 * t153;
  t328 = 0.1e1 / t118 / t125;
  t333 = 0.1e1 / t139;
  t338 = t138 * t302;
  t340 = 0.1e1 / t126 / t338;
  t344 = -0.2535e0 * t33 * t117 * t328 + 0.52e0 * t306 - 0.35251328475563349648e-1 * t158 * t333 + 0.13888888888888888889e-1 * t59 * t313 - 0.10850694444444444445e-2 * t88 * t163 * t340;
  t346 = t170 * t28;
  t347 = t346 * t43;
  t350 = -t344;
  t352 = t172 * t301;
  t356 = my_piecewise3(t151, -0.243905525293907837e-1 * t44 * t324, t344 * t155 - 0.243905525293907837e-1 * t347 * t324 + t350 * t150 + 0.646416e0 * t352 * t321);
  t357 = my_piecewise3(t124, 0.646416e0 * t301 * t321, t356);
  t362 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t176 - t275 - 0.3e1 / 0.8e1 * t5 * t116 * t357);
  tvrho1 = t106 + t180 + t6 * (t290 + t362);

  t281 = my_piecewise5(t10, 0, t14, 0, -t7 - t183);
  t284 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t281);
  t285 = t284 * t26;
  t290 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t102 - t198);
  t292 = my_piecewise5(t14, 0, t10, 0, t7 - t262);
  t295 = my_piecewise3(t112, 0, 0.4e1 / 0.3e1 * t113 * t292);
  t296 = t295 * t26;
  t300 = t147 * t147;
  t301 = 0.1e1 / t300;
  t302 = t125 * rho[1];
  t304 = 0.1e1 / t126 / t302;
  t305 = sigma[2] * t304;
  t306 = t44 * t305;
  t312 = 0.1e1 / t118 / t164;
  t313 = t137 * t312;
  t317 = 0.1e1 / t145;
  t321 = -0.10e2 / 0.729e3 * t306 - 0.10673131404562256653e-1 * t44 * t305 * t133 + 0.44471380852342736056e-3 * t59 * t313 * t133 - 0.73495086436683507408e-4 * t59 * t313 * t317;
  t324 = t305 * t153;
  t328 = 0.1e1 / t118 / t125;
  t333 = 0.1e1 / t139;
  t338 = t138 * t302;
  t340 = 0.1e1 / t126 / t338;
  t344 = -0.25350000000000000000e0 * t33 * t117 * t328 + 0.52000000000000000000e0 * t306 - 0.35251328475563349648e-1 * t158 * t333 + 0.13888888888888888889e-1 * t59 * t313 - 0.10850694444444444445e-2 * t88 * t163 * t340;
  t346 = t170 * t28;
  t347 = t346 * t43;
  t350 = -t344;
  t352 = t172 * t301;
  t356 = my_piecewise3(t151, -0.24390552529390783700e-1 * t44 * t324, t344 * t155 - 0.24390552529390783700e-1 * t347 * t324 + t350 * t150 + 0.64641600e0 * t352 * t321);
  t357 = my_piecewise3(t124, 0.64641600e0 * t301 * t321, t356);
  t362 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t176 - t275 - 0.3e1 / 0.8e1 * t5 * t116 * t357);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t106 + t180 + t6 * (t290 + t362);

  t365 = t44 * t48;
  t370 = sigma[0] * t64;
  t377 = 0.5e1 / 0.972e3 * t365 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t370 * t53 + 0.27560657413756315278e-4 * t59 * t370 * t216;
  t383 = 0.1e1 / t34;
  t395 = 0.950625e-1 * t33 * t383 * t37 - 0.195e0 * t365 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t370 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t398 = t43 * t48 * t76;
  t401 = -t395;
  t406 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t395 * t78 + 0.91464571985215438873e-2 * t245 * t398 + t401 * t73 + 0.646416e0 * t251 * t377);
  t407 = my_piecewise3(t41, 0.646416e0 * t200 * t377, t406);
  t411 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t407);
  tvsigma0 = t6 * t411;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t412 = t44 * t128;
  t417 = sigma[2] * t141;
  t424 = 0.5e1 / 0.972e3 * t412 + 0.40024242767108462450e-2 * t44 * t128 * t133 - 0.16676767819628526021e-3 * t59 * t417 * t133 + 0.27560657413756315278e-4 * t59 * t417 * t317;
  t430 = 0.1e1 / t117;
  t442 = 0.95062500000000000000e-1 * t33 * t430 * t120 - 0.19500000000000000000e0 * t412 + 0.13219248178336256118e-1 * t117 * t159 - 0.52083333333333333334e-2 * t59 * t417 + 0.40690104166666666668e-3 * t88 * t158 * t166;
  t445 = t43 * t128 * t153;
  t448 = -t442;
  t453 = my_piecewise3(t151, 0.91464571985215438873e-2 * t44 * t128 * t153, t442 * t155 + 0.91464571985215438873e-2 * t346 * t445 + t448 * t150 + 0.64641600e0 * t352 * t424);
  t454 = my_piecewise3(t124, 0.64641600e0 * t301 * t424, t453);
  t458 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t454);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t6 * t458;

#ifndef XC_DONT_COMPILE_FXC

  t412 = t44 * t128;
  t417 = sigma[2] * t141;
  t424 = 0.5e1 / 0.972e3 * t412 + 0.4002424276710846245e-2 * t44 * t128 * t133 - 0.16676767819628526021e-3 * t59 * t417 * t133 + 0.27560657413756315278e-4 * t59 * t417 * t317;
  t430 = 0.1e1 / t117;
  t442 = 0.950625e-1 * t33 * t430 * t120 - 0.195e0 * t412 + 0.13219248178336256118e-1 * t117 * t159 - 0.52083333333333333334e-2 * t59 * t417 + 0.40690104166666666668e-3 * t88 * t158 * t166;
  t445 = t43 * t128 * t153;
  t448 = -t442;
  t453 = my_piecewise3(t151, 0.91464571985215438873e-2 * t44 * t128 * t153, t442 * t155 + 0.91464571985215438873e-2 * t346 * t445 + t448 * t150 + 0.646416e0 * t352 * t424);
  t454 = my_piecewise3(t124, 0.646416e0 * t301 * t424, t453);
  t458 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t454);
  tvsigma2 = t6 * t458;


  t461 = t23 * t23;
  t462 = 0.1e1 / t461;
  t463 = t185 * t185;
  t466 = t181 * t6;
  t467 = 0.1e1 / t466;
  t468 = t16 * t467;
  t471 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t182 + 0.2e1 * t468);
  t475 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t463 + 0.4e1 / 0.3e1 * t23 * t471);
  t476 = t475 * t26;
  t480 = t188 * t194;
  t482 = t5 * t480 * t102;
  t488 = 0.1e1 / t193 / t6;
  t489 = t25 * t488;
  t492 = t5 * t489 * t102 / 0.12e2;
  t494 = t5 * t195 * t256;
  t497 = 0.1e1 / t199 / t70;
  t498 = t220 * t220;
  t502 = 0.1e1 / t46 / t61;
  t503 = sigma[0] * t502;
  t504 = t44 * t503;
  t510 = 0.1e1 / t35 / t237;
  t511 = t60 * t510;
  t515 = t30 * t30;
  t516 = 0.1e1 / t515;
  t517 = t60 * sigma[0];
  t518 = t516 * t517;
  t519 = t61 * t61;
  t520 = t519 * t45;
  t521 = 0.1e1 / t520;
  t530 = t28 / t42 / t515;
  t531 = t60 * t60;
  t532 = t519 * t61;
  t534 = 0.1e1 / t46 / t532;
  t536 = t68 * t68;
  t537 = 0.1e1 / t536;
  t541 = 0.11e3 / 0.2187e4 * t504 + 0.39134815150061607728e-1 * t44 * t503 * t53 - 0.4002424276710846245e-2 * t59 * t511 * t53 + 0.29647587234895157371e-3 * t518 * t521 * t53 + 0.46546888076566221358e-3 * t59 * t511 * t216 - 0.32409166382013480325e-7 * t530 * t531 * t534 * t537;
  t545 = t503 * t76;
  t548 = t511 * t76;
  t553 = 0.1e1 / t35 / t201;
  t558 = 0.1e1 / t90;
  t564 = 0.1e1 / t46 / t519;
  t568 = 0.5915e0 * t33 * t34 * t553 - 0.19066666666666666667e1 * t504 + 0.17625664237781674824e0 * t81 * t558 - 0.87962962962962962964e-1 * t59 * t511 + 0.83188657407407407412e-2 * t88 * t89 * t564;
  t570 = t243 * t28;
  t571 = t570 * t43;
  t576 = t96 * t29;
  t577 = t576 * t58;
  t580 = -t568;
  t582 = t249 * t200;
  t585 = t98 * t497;
  t591 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t545 - 0.73992419488678004547e-3 * t59 * t548, t568 * t78 - 0.487811050587815674e-1 * t571 * t223 + 0.89432025941099540233e-1 * t246 * t545 - 0.73992419488678004547e-3 * t577 * t548 + t580 * t73 + 0.1292832e1 * t582 * t220 - 0.1292832e1 * t585 * t498 + 0.646416e0 * t251 * t541);
  t592 = my_piecewise3(t41, -0.1292832e1 * t497 * t498 + 0.646416e0 * t200 * t541, t591);
  t597 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t102 - t482 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t256 + t492 - t494 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t592);
  t598 = t113 * t113;
  t599 = 0.1e1 / t598;
  t600 = t264 * t264;
  t603 = t108 * t467;
  t606 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t182 + 0.2e1 * t603);
  t610 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t600 + 0.4e1 / 0.3e1 * t113 * t606);
  t611 = t610 * t26;
  t615 = t267 * t194;
  t617 = t5 * t615 * t176;
  t619 = t115 * t488;
  t622 = t5 * t619 * t176 / 0.12e2;
  t624 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t176 - t617 / 0.4e1 + t622);
  tv2rho20 = 0.2e1 * t261 + 0.2e1 * t277 + t6 * (t597 + t624);

  t627 = t462 * t281;
  t631 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t468);
  t635 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t627 * t185 + 0.4e1 / 0.3e1 * t23 * t631);
  t636 = t635 * t26;
  t640 = t284 * t194;
  t642 = t5 * t640 * t102;
  t650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t102 - t642 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t256 - t482 / 0.8e1 + t492 - t494 / 0.8e1);
  t651 = t599 * t292;
  t655 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t603);
  t659 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t651 * t264 + 0.4e1 / 0.3e1 * t113 * t655);
  t660 = t659 * t26;
  t664 = t295 * t194;
  t666 = t5 * t664 * t176;
  t673 = t5 * t272 * t357;
  t676 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t176 - t666 / 0.8e1 - t617 / 0.8e1 + t622 - 0.3e1 / 0.8e1 * t5 * t268 * t357 - t673 / 0.8e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t261 + t277 + t290 + t362 + t6 * (t650 + t676);

  t627 = t462 * t281;
  t631 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t468);
  t635 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t627 * t185 + 0.4e1 / 0.3e1 * t23 * t631);
  t636 = t635 * t26;
  t640 = t284 * t194;
  t642 = t5 * t640 * t102;
  t650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t102 - t642 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t256 - t482 / 0.8e1 + t492 - t494 / 0.8e1);
  t651 = t599 * t292;
  t655 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t603);
  t659 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t651 * t264 + 0.4e1 / 0.3e1 * t113 * t655);
  t660 = t659 * t26;
  t664 = t295 * t194;
  t666 = t5 * t664 * t176;
  t673 = t5 * t272 * t357;
  t676 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t176 - t666 / 0.8e1 - t617 / 0.8e1 + t622 - 0.3e1 / 0.8e1 * t5 * t268 * t357 - t673 / 0.8e1);
  tv2rho21 = t261 + t277 + t290 + t362 + t6 * (t650 + t676);

  t821 = t5 * t195 * t407 / 0.8e1;
  t822 = t497 * t377;
  t825 = t44 * t203;
  t830 = t211 * sigma[0];
  t834 = t516 * t60;
  t835 = t519 * rho[0];
  t836 = 0.1e1 / t835;
  t843 = t519 * t201;
  t845 = 0.1e1 / t46 / t843;
  t850 = -0.10e2 / 0.729e3 * t825 - 0.10673131404562256653e-1 * t44 * t203 * t53 + 0.13341414255702820817e-2 * t59 * t830 * t53 - 0.11117845213085684014e-3 * t834 * t836 * t53 - 0.14699017287336701482e-3 * t59 * t830 * t216 + 0.12153437393255055122e-7 * t530 * t517 * t845 * t537;
  t857 = t830 * t76;
  t872 = -0.12675000000000000000e0 * t33 * t383 * t227 + 0.52000000000000000000e0 * t825 - 0.52876992713345024472e-1 * t34 * t232 + 0.27777777777777777778e-1 * t59 * t830 - 0.27126736111111111112e-2 * t88 * t81 * t239;
  t874 = t395 * t28;
  t875 = t874 * t43;
  t881 = t43 * t203 * t76;
  t886 = -t872;
  t888 = t401 * t200;
  t893 = t377 * t220;
  t899 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t203 * t76 + 0.27747157308254251705e-3 * t59 * t857, t872 * t78 - 0.24390552529390783700e-1 * t875 * t223 + 0.91464571985215438873e-2 * t570 * t398 - 0.24390552529390783699e-1 * t245 * t881 + 0.27747157308254251705e-3 * t577 * t857 + t886 * t73 + 0.64641600e0 * t888 * t220 + 0.64641600e0 * t582 * t377 - 0.129283200e1 * t585 * t893 + 0.64641600e0 * t251 * t850);
  t900 = my_piecewise3(t41, -0.129283200e1 * t822 * t220 + 0.64641600e0 * t200 * t850, t899);
  t905 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t407 - t821 - 0.3e1 / 0.8e1 * t5 * t27 * t900);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t6 * t905 + t411;

  t681 = t281 * t281;
  t686 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t182 + 0.2e1 * t468);
  t690 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t462 * t681 + 0.4e1 / 0.3e1 * t23 * t686);
  t691 = t690 * t26;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t102 - t642 / 0.4e1 + t492);
  t698 = t292 * t292;
  t703 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t182 + 0.2e1 * t603);
  t707 = my_piecewise3(t112, 0, 0.4e1 / 0.9e1 * t599 * t698 + 0.4e1 / 0.3e1 * t113 * t703);
  t708 = t707 * t26;
  t718 = 0.1e1 / t300 / t147;
  t719 = t321 * t321;
  t723 = 0.1e1 / t126 / t138;
  t724 = sigma[2] * t723;
  t725 = t44 * t724;
  t731 = 0.1e1 / t118 / t338;
  t732 = t137 * t731;
  t736 = t137 * sigma[2];
  t737 = t516 * t736;
  t738 = t138 * t138;
  t739 = t738 * t125;
  t740 = 0.1e1 / t739;
  t747 = t137 * t137;
  t748 = t738 * t138;
  t750 = 0.1e1 / t126 / t748;
  t752 = t145 * t145;
  t753 = 0.1e1 / t752;
  t757 = 0.11e3 / 0.2187e4 * t725 + 0.39134815150061607728e-1 * t44 * t724 * t133 - 0.4002424276710846245e-2 * t59 * t732 * t133 + 0.29647587234895157371e-3 * t737 * t740 * t133 + 0.46546888076566221358e-3 * t59 * t732 * t317 - 0.32409166382013480325e-7 * t530 * t747 * t750 * t753;
  t761 = t724 * t153;
  t764 = t732 * t153;
  t769 = 0.1e1 / t118 / t302;
  t774 = 0.1e1 / t164;
  t780 = 0.1e1 / t126 / t738;
  t784 = 0.5915e0 * t33 * t117 * t769 - 0.19066666666666666667e1 * t725 + 0.17625664237781674824e0 * t158 * t774 - 0.87962962962962962964e-1 * t59 * t732 + 0.83188657407407407412e-2 * t88 * t163 * t780;
  t786 = t344 * t28;
  t787 = t786 * t43;
  t792 = t170 * t29;
  t793 = t792 * t58;
  t796 = -t784;
  t798 = t350 * t301;
  t801 = t172 * t718;
  t807 = my_piecewise3(t151, 0.89432025941099540233e-1 * t44 * t761 - 0.73992419488678004547e-3 * t59 * t764, t784 * t155 - 0.487811050587815674e-1 * t787 * t324 + 0.89432025941099540233e-1 * t347 * t761 - 0.73992419488678004547e-3 * t793 * t764 + t796 * t150 + 0.1292832e1 * t798 * t321 - 0.1292832e1 * t801 * t719 + 0.646416e0 * t352 * t757);
  t808 = my_piecewise3(t124, -0.1292832e1 * t718 * t719 + 0.646416e0 * t301 * t757, t807);
  t813 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t176 - t666 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t357 + t622 - t673 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t808);
  tv2rho22 = 0.2e1 * t290 + 0.2e1 * t362 + t6 * (t697 + t813);

  t912 = t5 * t272 * t454 / 0.8e1;
  t914 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t454 - t912);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t6 * t914 + t458;

  t821 = t5 * t195 * t407 / 0.8e1;
  t822 = t497 * t377;
  t825 = t44 * t203;
  t830 = t211 * sigma[0];
  t834 = t516 * t60;
  t835 = t519 * rho[0];
  t836 = 0.1e1 / t835;
  t843 = t519 * t201;
  t845 = 0.1e1 / t46 / t843;
  t850 = -0.1e2 / 0.729e3 * t825 - 0.10673131404562256653e-1 * t44 * t203 * t53 + 0.13341414255702820817e-2 * t59 * t830 * t53 - 0.11117845213085684014e-3 * t834 * t836 * t53 - 0.14699017287336701482e-3 * t59 * t830 * t216 + 0.12153437393255055122e-7 * t530 * t517 * t845 * t537;
  t857 = t830 * t76;
  t872 = -0.12675e0 * t33 * t383 * t227 + 0.52e0 * t825 - 0.52876992713345024472e-1 * t34 * t232 + 0.27777777777777777778e-1 * t59 * t830 - 0.27126736111111111112e-2 * t88 * t81 * t239;
  t874 = t395 * t28;
  t875 = t874 * t43;
  t881 = t43 * t203 * t76;
  t886 = -t872;
  t888 = t401 * t200;
  t893 = t377 * t220;
  t899 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t203 * t76 + 0.27747157308254251705e-3 * t59 * t857, t872 * t78 - 0.243905525293907837e-1 * t875 * t223 + 0.91464571985215438873e-2 * t570 * t398 - 0.24390552529390783699e-1 * t245 * t881 + 0.27747157308254251705e-3 * t577 * t857 + t886 * t73 + 0.646416e0 * t888 * t220 + 0.646416e0 * t582 * t377 - 0.1292832e1 * t585 * t893 + 0.646416e0 * t251 * t850);
  t900 = my_piecewise3(t41, -0.1292832e1 * t822 * t220 + 0.646416e0 * t200 * t850, t899);
  t905 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t407 - t821 - 0.3e1 / 0.8e1 * t5 * t27 * t900);
  tv2rhosigma0 = t6 * t905 + t411;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t925 = t718 * t424;
  t928 = t44 * t304;
  t933 = t312 * sigma[2];
  t937 = t516 * t137;
  t938 = t738 * rho[1];
  t939 = 0.1e1 / t938;
  t946 = t738 * t302;
  t948 = 0.1e1 / t126 / t946;
  t953 = -0.10e2 / 0.729e3 * t928 - 0.10673131404562256653e-1 * t44 * t304 * t133 + 0.13341414255702820817e-2 * t59 * t933 * t133 - 0.11117845213085684014e-3 * t937 * t939 * t133 - 0.14699017287336701482e-3 * t59 * t933 * t317 + 0.12153437393255055122e-7 * t530 * t736 * t948 * t753;
  t960 = t933 * t153;
  t975 = -0.12675000000000000000e0 * t33 * t430 * t328 + 0.52000000000000000000e0 * t928 - 0.52876992713345024472e-1 * t117 * t333 + 0.27777777777777777778e-1 * t59 * t933 - 0.27126736111111111112e-2 * t88 * t158 * t340;
  t977 = t442 * t28;
  t978 = t977 * t43;
  t984 = t43 * t304 * t153;
  t989 = -t975;
  t991 = t448 * t301;
  t996 = t424 * t321;
  t1002 = my_piecewise3(t151, -0.24390552529390783699e-1 * t44 * t304 * t153 + 0.27747157308254251705e-3 * t59 * t960, t975 * t155 - 0.24390552529390783700e-1 * t978 * t324 + 0.91464571985215438873e-2 * t786 * t445 - 0.24390552529390783699e-1 * t346 * t984 + 0.27747157308254251705e-3 * t793 * t960 + t989 * t150 + 0.64641600e0 * t991 * t321 + 0.64641600e0 * t798 * t424 - 0.129283200e1 * t801 * t996 + 0.64641600e0 * t352 * t953);
  t1003 = my_piecewise3(t124, -0.129283200e1 * t925 * t321 + 0.64641600e0 * t301 * t953, t1002);
  t1008 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t454 - t912 - 0.3e1 / 0.8e1 * t5 * t116 * t1003);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t6 * t1008 + t458;

  t1010 = t377 * t377;
  t1016 = t516 * sigma[0];
  t1017 = 0.1e1 / t519;
  t1025 = 0.1e1 / t46 / t520;
  t1030 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1016 * t1017 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t216 - 0.45575390224706456708e-8 * t530 * t60 * t1025 * t537;
  t1037 = 0.1e1 / t81;
  t1048 = -0.47531250000000000000e-1 * t33 * t1037 * t37 + 0.66096240891681280590e-2 * t383 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1053 = t58 * t64 * t76;
  t1056 = -t1048;
  t1065 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1048 * t78 + 0.18292914397043087775e-1 * t874 * t398 - 0.10405183990595344389e-3 * t576 * t1053 + t1056 * t73 + 0.129283200e1 * t888 * t377 - 0.129283200e1 * t585 * t1010 + 0.64641600e0 * t251 * t1030);
  t1066 = my_piecewise3(t41, -0.129283200e1 * t497 * t1010 + 0.64641600e0 * t200 * t1030, t1065);
  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1066);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t6 * t1070;

  t912 = t5 * t272 * t454 / 0.8e1;
  t914 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t454 - t912);
  tv2rhosigma2 = t6 * t914 + t458;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  t920 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t407 - t821);
  tv2rhosigma3 = t6 * t920 + t411;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t1071 = t424 * t424;
  t1077 = t516 * sigma[2];
  t1078 = 0.1e1 / t738;
  t1086 = 0.1e1 / t126 / t739;
  t1091 = -0.33353535639257052042e-3 * t59 * t141 * t133 + 0.41691919549071315052e-4 * t1077 * t1078 * t133 + 0.27560657413756315278e-4 * t59 * t141 * t317 - 0.45575390224706456708e-8 * t530 * t137 * t1086 * t753;
  t1098 = 0.1e1 / t158;
  t1109 = -0.47531250000000000000e-1 * t33 * t1098 * t120 + 0.66096240891681280590e-2 * t430 * t159 - 0.52083333333333333334e-2 * t59 * t141 + 0.61035156250000000002e-3 * t88 * t117 * t166;
  t1114 = t58 * t141 * t153;
  t1117 = -t1109;
  t1126 = my_piecewise3(t151, -0.10405183990595344389e-3 * t59 * t141 * t153, t1109 * t155 + 0.18292914397043087775e-1 * t977 * t445 - 0.10405183990595344389e-3 * t792 * t1114 + t1117 * t150 + 0.129283200e1 * t991 * t424 - 0.129283200e1 * t801 * t1071 + 0.64641600e0 * t352 * t1091);
  t1127 = my_piecewise3(t124, -0.129283200e1 * t718 * t1071 + 0.64641600e0 * t301 * t1091, t1126);
  t1131 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t1127);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t6 * t1131;

#ifndef XC_DONT_COMPILE_KXC

  t925 = t718 * t424;
  t928 = t44 * t304;
  t933 = t312 * sigma[2];
  t937 = t516 * t137;
  t938 = t738 * rho[1];
  t939 = 0.1e1 / t938;
  t946 = t738 * t302;
  t948 = 0.1e1 / t126 / t946;
  t953 = -0.1e2 / 0.729e3 * t928 - 0.10673131404562256653e-1 * t44 * t304 * t133 + 0.13341414255702820817e-2 * t59 * t933 * t133 - 0.11117845213085684014e-3 * t937 * t939 * t133 - 0.14699017287336701482e-3 * t59 * t933 * t317 + 0.12153437393255055122e-7 * t530 * t736 * t948 * t753;
  t960 = t933 * t153;
  t975 = -0.12675e0 * t33 * t430 * t328 + 0.52e0 * t928 - 0.52876992713345024472e-1 * t117 * t333 + 0.27777777777777777778e-1 * t59 * t933 - 0.27126736111111111112e-2 * t88 * t158 * t340;
  t977 = t442 * t28;
  t978 = t977 * t43;
  t984 = t43 * t304 * t153;
  t989 = -t975;
  t991 = t448 * t301;
  t996 = t424 * t321;
  t1002 = my_piecewise3(t151, -0.24390552529390783699e-1 * t44 * t304 * t153 + 0.27747157308254251705e-3 * t59 * t960, t975 * t155 - 0.243905525293907837e-1 * t978 * t324 + 0.91464571985215438873e-2 * t786 * t445 - 0.24390552529390783699e-1 * t346 * t984 + 0.27747157308254251705e-3 * t793 * t960 + t989 * t150 + 0.646416e0 * t991 * t321 + 0.646416e0 * t798 * t424 - 0.1292832e1 * t801 * t996 + 0.646416e0 * t352 * t953);
  t1003 = my_piecewise3(t124, -0.1292832e1 * t925 * t321 + 0.646416e0 * t301 * t953, t1002);
  t1008 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t454 - t912 - 0.3e1 / 0.8e1 * t5 * t116 * t1003);
  tv2rhosigma5 = t6 * t1008 + t458;


  t1010 = t377 * t377;
  t1016 = t516 * sigma[0];
  t1017 = 0.1e1 / t519;
  t1025 = 0.1e1 / t46 / t520;
  t1030 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1016 * t1017 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t216 - 0.45575390224706456708e-8 * t530 * t60 * t1025 * t537;
  t1037 = 0.1e1 / t81;
  t1048 = -0.4753125e-1 * t33 * t1037 * t37 + 0.6609624089168128059e-2 * t383 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1053 = t58 * t64 * t76;
  t1056 = -t1048;
  t1065 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1048 * t78 + 0.18292914397043087775e-1 * t874 * t398 - 0.10405183990595344389e-3 * t576 * t1053 + t1056 * t73 + 0.1292832e1 * t888 * t377 - 0.1292832e1 * t585 * t1010 + 0.646416e0 * t251 * t1030);
  t1066 = my_piecewise3(t41, -0.1292832e1 * t497 * t1010 + 0.646416e0 * t200 * t1030, t1065);
  t1070 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1066);
  tv2sigma20 = t6 * t1070;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1071 = t424 * t424;
  t1077 = t516 * sigma[2];
  t1078 = 0.1e1 / t738;
  t1086 = 0.1e1 / t126 / t739;
  t1091 = -0.33353535639257052042e-3 * t59 * t141 * t133 + 0.41691919549071315052e-4 * t1077 * t1078 * t133 + 0.27560657413756315278e-4 * t59 * t141 * t317 - 0.45575390224706456708e-8 * t530 * t137 * t1086 * t753;
  t1098 = 0.1e1 / t158;
  t1109 = -0.4753125e-1 * t33 * t1098 * t120 + 0.6609624089168128059e-2 * t430 * t159 - 0.52083333333333333334e-2 * t59 * t141 + 0.61035156250000000002e-3 * t88 * t117 * t166;
  t1114 = t58 * t141 * t153;
  t1117 = -t1109;
  t1126 = my_piecewise3(t151, -0.10405183990595344389e-3 * t59 * t141 * t153, t1109 * t155 + 0.18292914397043087775e-1 * t977 * t445 - 0.10405183990595344389e-3 * t792 * t1114 + t1117 * t150 + 0.1292832e1 * t991 * t424 - 0.1292832e1 * t801 * t1071 + 0.646416e0 * t352 * t1091);
  t1127 = my_piecewise3(t124, -0.1292832e1 * t718 * t1071 + 0.646416e0 * t301 * t1091, t1126);
  t1131 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t1127);
  tv2sigma25 = t6 * t1131;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1135 = 0.1e1 / t461 / t19;
  t1136 = t463 * t185;
  t1139 = t462 * t185;
  t1142 = t181 * t181;
  t1143 = 0.1e1 / t1142;
  t1144 = t16 * t1143;
  t1147 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t467 - 0.6e1 * t1144);
  t1151 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1135 * t1136 + 0.4e1 / 0.3e1 * t1139 * t471 + 0.4e1 / 0.3e1 * t23 * t1147);
  t1152 = t1151 * t26;
  t1156 = t475 * t194;
  t1158 = t5 * t1156 * t102;
  t1163 = t188 * t488;
  t1165 = t5 * t1163 * t102;
  t1168 = t5 * t480 * t256;
  t1174 = 0.1e1 / t193 / t181;
  t1175 = t25 * t1174;
  t1178 = 0.5e1 / 0.36e2 * t5 * t1175 * t102;
  t1180 = t5 * t489 * t256;
  t1183 = t5 * t195 * t592;
  t1185 = t199 * t199;
  t1186 = 0.1e1 / t1185;
  t1187 = t498 * t220;
  t1190 = t497 * t220;
  t1194 = 0.1e1 / t46 / t62;
  t1195 = sigma[0] * t1194;
  t1196 = t44 * t1195;
  t1202 = 0.1e1 / t35 / t519;
  t1203 = t60 * t1202;
  t1207 = 0.1e1 / t843;
  t1211 = t516 * t531;
  t1212 = t519 * t62;
  t1214 = 0.1e1 / t46 / t1212;
  t1216 = t44 * t53;
  t1226 = t531 * t60;
  t1227 = t519 * t519;
  t1229 = 0.1e1 / t1227 / t201;
  t1232 = 0.1e1 / t536 / t68;
  t1235 = -0.154e4 / 0.6561e4 * t1196 - 0.1826291373669541694e0 * t44 * t1195 * t53 + 0.33699424156997495545e-1 * t59 * t1203 * t53 - 0.56330415746300799004e-2 * t518 * t1207 * t53 + 0.32941763594327952634e-4 * t1211 * t1214 * t1216 - 0.34134384589481895663e-2 * t59 * t1203 * t216 + 0.61577416125825612618e-6 * t530 * t531 * t1214 * t537 - 0.3012370804988962832e-14 * t1226 * t1229 * t1232;
  t1239 = t1195 * t76;
  t1242 = t1203 * t76;
  t1250 = 0.1e1 / t35 / t61;
  t1255 = 0.1e1 / t237;
  t1261 = 0.1e1 / t46 / t835;
  t1265 = -0.19716666666666666667e1 * t33 * t34 * t1250 + 0.88977777777777777779e1 * t1196 - 0.10575398542669004894e1 * t81 * t1255 + 0.6450617283950617284e0 * t59 * t1203 - 0.72096836419753086424e-1 * t88 * t89 * t1261;
  t1267 = t568 * t28;
  t1268 = t1267 * t43;
  t1273 = t243 * t29;
  t1274 = t1273 * t58;
  t1281 = t96 * t517;
  t1282 = t1207 * t76;
  t1285 = -t1265;
  t1287 = t580 * t200;
  t1290 = t249 * t497;
  t1295 = t98 * t1186;
  t1298 = t220 * t541;
  t1303 = t1265 * t78 - 0.731716575881723511e-1 * t1268 * t223 + 0.2682960778232986207e0 * t571 * t545 - 0.22197725846603401364e-2 * t1274 * t548 - 0.41734945439179785442e0 * t246 * t1239 + 0.81391661437545805002e-2 * t577 * t1242 - 0.13826255501780643787e-5 * t1281 * t1282 + t1285 * t73 + 0.1939248e1 * t1287 * t220 - 0.3878496e1 * t1290 * t498 + 0.1939248e1 * t582 * t541 + 0.3878496e1 * t1295 * t1187 - 0.3878496e1 * t585 * t1298 + 0.646416e0 * t251 * t1235;
  t1304 = my_piecewise3(t74, -0.41734945439179785442e0 * t44 * t1239 + 0.81391661437545805002e-2 * t59 * t1242 - 0.13826255501780643787e-5 * t517 * t1207 * t76, t1303);
  t1305 = my_piecewise3(t41, 0.3878496e1 * t1186 * t1187 - 0.3878496e1 * t1190 * t541 + 0.646416e0 * t200 * t1235, t1304);
  t1310 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1152 * t102 - 0.3e1 / 0.8e1 * t1158 - 0.9e1 / 0.8e1 * t5 * t476 * t256 + t1165 / 0.4e1 - 0.3e1 / 0.4e1 * t1168 - 0.9e1 / 0.8e1 * t5 * t189 * t592 - t1178 + t1180 / 0.4e1 - 0.3e1 / 0.8e1 * t1183 - 0.3e1 / 0.8e1 * t5 * t27 * t1305);
  t1312 = 0.1e1 / t598 / t111;
  t1313 = t600 * t264;
  t1316 = t599 * t264;
  t1319 = t108 * t1143;
  t1322 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t467 - 0.6e1 * t1319);
  t1326 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1312 * t1313 + 0.4e1 / 0.3e1 * t1316 * t606 + 0.4e1 / 0.3e1 * t113 * t1322);
  t1327 = t1326 * t26;
  t1331 = t610 * t194;
  t1333 = t5 * t1331 * t176;
  t1335 = t267 * t488;
  t1337 = t5 * t1335 * t176;
  t1339 = t115 * t1174;
  t1342 = 0.5e1 / 0.36e2 * t5 * t1339 * t176;
  t1344 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t176 - 0.3e1 / 0.8e1 * t1333 + t1337 / 0.4e1 - t1342);
  tv3rho30 = 0.3e1 * t597 + 0.3e1 * t624 + t6 * (t1310 + t1344);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1347 = 0.2e1 * t650;
  t1348 = 0.2e1 * t676;
  t1349 = t1135 * t281;
  t1352 = t462 * t631;
  t1357 = 0.2e1 * t467;
  t1358 = 0.6e1 * t1144;
  t1360 = my_piecewise5(t10, 0, t14, 0, t1357 - t1358);
  t1364 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1349 * t463 + 0.8e1 / 0.9e1 * t1352 * t185 + 0.4e1 / 0.9e1 * t627 * t471 + 0.4e1 / 0.3e1 * t23 * t1360);
  t1365 = t1364 * t26;
  t1369 = t635 * t194;
  t1372 = t5 * t1369 * t102 / 0.4e1;
  t1376 = t284 * t488;
  t1378 = t5 * t1376 * t102;
  t1382 = t5 * t640 * t256 / 0.4e1;
  t1391 = -0.3e1 / 0.8e1 * t5 * t1365 * t102 - t1372 - 0.3e1 / 0.4e1 * t5 * t636 * t256 + t1378 / 0.12e2 - t1382 - 0.3e1 / 0.8e1 * t5 * t285 * t592 - t1158 / 0.8e1 + t1165 / 0.6e1 - t1168 / 0.4e1 - t1178 + t1180 / 0.6e1 - t1183 / 0.8e1;
  t1392 = my_piecewise3(t1, 0, t1391);
  t1393 = t1312 * t292;
  t1396 = t599 * t655;
  t1401 = 0.6e1 * t1319;
  t1403 = my_piecewise5(t14, 0, t10, 0, -t1357 - t1401);
  t1407 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1393 * t600 + 0.8e1 / 0.9e1 * t1396 * t264 + 0.4e1 / 0.9e1 * t651 * t606 + 0.4e1 / 0.3e1 * t113 * t1403);
  t1408 = t1407 * t26;
  t1412 = t659 * t194;
  t1415 = t5 * t1412 * t176 / 0.4e1;
  t1416 = t295 * t488;
  t1418 = t5 * t1416 * t176;
  t1427 = t5 * t615 * t357 / 0.4e1;
  t1429 = t5 * t619 * t357;
  t1432 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1408 * t176 - t1415 + t1418 / 0.12e2 - t1333 / 0.8e1 + t1337 / 0.6e1 - t1342 - 0.3e1 / 0.8e1 * t5 * t611 * t357 - t1427 + t1429 / 0.12e2);
  tv3rho31 = t597 + t624 + t1347 + t1348 + t6 * (t1392 + t1432);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1435 = t1135 * t681;
  t1440 = t462 * t686;
  t1444 = my_piecewise5(t10, 0, t14, 0, -t1357 - t1358);
  t1448 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1435 * t185 + 0.8e1 / 0.9e1 * t627 * t631 + 0.4e1 / 0.9e1 * t1440 * t185 + 0.4e1 / 0.3e1 * t23 * t1444);
  t1449 = t1448 * t26;
  t1453 = t690 * t194;
  t1455 = t5 * t1453 * t102;
  t1464 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1449 * t102 - t1455 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t691 * t256 - t1372 + t1378 / 0.6e1 - t1382 + t1165 / 0.12e2 - t1178 + t1180 / 0.12e2);
  t1465 = t1312 * t698;
  t1470 = t599 * t703;
  t1474 = my_piecewise5(t14, 0, t10, 0, t1357 - t1401);
  t1478 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1465 * t264 + 0.8e1 / 0.9e1 * t651 * t655 + 0.4e1 / 0.9e1 * t1470 * t264 + 0.4e1 / 0.3e1 * t113 * t1474);
  t1479 = t1478 * t26;
  t1483 = t707 * t194;
  t1485 = t5 * t1483 * t176;
  t1492 = t5 * t664 * t357;
  t1500 = t5 * t272 * t808;
  t1502 = -0.3e1 / 0.8e1 * t5 * t1479 * t176 - t1485 / 0.8e1 - t1415 + t1418 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t660 * t357 - t1492 / 0.4e1 + t1337 / 0.12e2 - t1342 - t1427 + t1429 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t268 * t808 - t1500 / 0.8e1;
  t1503 = my_piecewise3(t107, 0, t1502);
  tv3rho32 = t1347 + t1348 + t697 + t813 + t6 * (t1464 + t1503);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1508 = t681 * t281;
  t1515 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t467 - 0.6e1 * t1144);
  t1519 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1135 * t1508 + 0.4e1 / 0.3e1 * t627 * t686 + 0.4e1 / 0.3e1 * t23 * t1515);
  t1520 = t1519 * t26;
  t1527 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1520 * t102 - 0.3e1 / 0.8e1 * t1455 + t1378 / 0.4e1 - t1178);
  t1528 = t698 * t292;
  t1535 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t467 - 0.6e1 * t1319);
  t1539 = my_piecewise3(t112, 0, -0.8e1 / 0.27e2 * t1312 * t1528 + 0.4e1 / 0.3e1 * t651 * t703 + 0.4e1 / 0.3e1 * t113 * t1535);
  t1540 = t1539 * t26;
  t1555 = t300 * t300;
  t1556 = 0.1e1 / t1555;
  t1557 = t719 * t321;
  t1560 = t718 * t321;
  t1564 = 0.1e1 / t126 / t139;
  t1565 = sigma[2] * t1564;
  t1566 = t44 * t1565;
  t1572 = 0.1e1 / t118 / t738;
  t1573 = t137 * t1572;
  t1577 = 0.1e1 / t946;
  t1581 = t516 * t747;
  t1582 = t738 * t139;
  t1584 = 0.1e1 / t126 / t1582;
  t1586 = t44 * t133;
  t1596 = t747 * t137;
  t1597 = t738 * t738;
  t1599 = 0.1e1 / t1597 / t302;
  t1602 = 0.1e1 / t752 / t145;
  t1605 = -0.154e4 / 0.6561e4 * t1566 - 0.1826291373669541694e0 * t44 * t1565 * t133 + 0.33699424156997495545e-1 * t59 * t1573 * t133 - 0.56330415746300799004e-2 * t737 * t1577 * t133 + 0.32941763594327952634e-4 * t1581 * t1584 * t1586 - 0.34134384589481895663e-2 * t59 * t1573 * t317 + 0.61577416125825612618e-6 * t530 * t747 * t1584 * t753 - 0.3012370804988962832e-14 * t1596 * t1599 * t1602;
  t1609 = t1565 * t153;
  t1612 = t1573 * t153;
  t1620 = 0.1e1 / t118 / t138;
  t1625 = 0.1e1 / t338;
  t1631 = 0.1e1 / t126 / t938;
  t1635 = -0.19716666666666666667e1 * t33 * t117 * t1620 + 0.88977777777777777779e1 * t1566 - 0.10575398542669004894e1 * t158 * t1625 + 0.6450617283950617284e0 * t59 * t1573 - 0.72096836419753086424e-1 * t88 * t163 * t1631;
  t1637 = t784 * t28;
  t1638 = t1637 * t43;
  t1643 = t344 * t29;
  t1644 = t1643 * t58;
  t1651 = t170 * t736;
  t1652 = t1577 * t153;
  t1655 = -t1635;
  t1657 = t796 * t301;
  t1660 = t350 * t718;
  t1665 = t172 * t1556;
  t1668 = t321 * t757;
  t1673 = t1635 * t155 - 0.731716575881723511e-1 * t1638 * t324 + 0.2682960778232986207e0 * t787 * t761 - 0.22197725846603401364e-2 * t1644 * t764 - 0.41734945439179785442e0 * t347 * t1609 + 0.81391661437545805002e-2 * t793 * t1612 - 0.13826255501780643787e-5 * t1651 * t1652 + t1655 * t150 + 0.1939248e1 * t1657 * t321 - 0.3878496e1 * t1660 * t719 + 0.1939248e1 * t798 * t757 + 0.3878496e1 * t1665 * t1557 - 0.3878496e1 * t801 * t1668 + 0.646416e0 * t352 * t1605;
  t1674 = my_piecewise3(t151, -0.41734945439179785442e0 * t44 * t1609 + 0.81391661437545805002e-2 * t59 * t1612 - 0.13826255501780643787e-5 * t736 * t1577 * t153, t1673);
  t1675 = my_piecewise3(t124, 0.3878496e1 * t1556 * t1557 - 0.3878496e1 * t1560 * t757 + 0.646416e0 * t301 * t1605, t1674);
  t1680 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1540 * t176 - 0.3e1 / 0.8e1 * t1485 - 0.9e1 / 0.8e1 * t5 * t708 * t357 + t1418 / 0.4e1 - 0.3e1 / 0.4e1 * t1492 - 0.9e1 / 0.8e1 * t5 * t296 * t808 - t1342 + t1429 / 0.4e1 - 0.3e1 / 0.8e1 * t1500 - 0.3e1 / 0.8e1 * t5 * t116 * t1675);
  tv3rho33 = 0.3e1 * t697 + 0.3e1 * t813 + t6 * (t1527 + t1680);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1688 = t5 * t480 * t407;
  t1695 = t5 * t489 * t407 / 0.12e2;
  t1697 = t5 * t195 * t900;
  t1699 = t1186 * t377;
  t1702 = t497 * t850;
  t1707 = t44 * t502;
  t1712 = t510 * sigma[0];
  t1716 = t516 * t521;
  t1717 = t60 * t53;
  t1730 = t531 * sigma[0];
  t1732 = 0.1e1 / t1227 / t45;
  t1736 = 0.11e3 / 0.2187e4 * t1707 + 0.39134815150061607728e-1 * t44 * t502 * t53 - 0.96354658513409261456e-2 * t59 * t1712 * t53 + 0.18900336862245662824e-2 * t1716 * t1717 - 0.12353161347872982238e-4 * t518 * t534 * t1216 + 0.93093776153132442719e-3 * t59 * t1712 * t216 - 0.20660843568533593707e-6 * t530 * t517 * t534 * t537 + 0.1129639051870861062e-14 * t1730 * t1732 * t1232;
  t1743 = t1712 * t76;
  t1750 = t377 * t498;
  t1764 = -0.29575e0 * t33 * t383 * t553 + 0.19066666666666666667e1 * t1707 - 0.26438496356672512236e0 * t34 * t558 + 0.17592592592592592593e0 * t59 * t1712 - 0.20797164351851851853e-1 * t88 * t81 * t564;
  t1766 = -t1764;
  t1768 = t872 * t28;
  t1769 = t1768 * t43;
  t1772 = t395 * t29;
  t1773 = t1772 * t58;
  t1781 = t43 * t502 * t76;
  t1786 = t96 * t521;
  t1787 = t60 * t76;
  t1791 = t401 * t497;
  t1796 = t850 * t220;
  t1799 = t377 * t541;
  t1806 = t886 * t200;
  t1817 = -0.1292832e1 * t1791 * t498 - 0.2585664e1 * t1290 * t893 - 0.2585664e1 * t585 * t1796 - 0.1292832e1 * t585 * t1799 + 0.91464571985215438873e-2 * t1267 * t398 + 0.646416e0 * t251 * t1736 + 0.1292832e1 * t1806 * t220 + 0.646416e0 * t888 * t541 + 0.646416e0 * t1287 * t377 + 0.1292832e1 * t582 * t850 + 0.89432025941099540233e-1 * t875 * t545;
  t1819 = my_piecewise3(t74, 0.8943202594109954023e-1 * t44 * t502 * t76 - 0.24972441577428826534e-2 * t59 * t1743 + 0.51848458131677414201e-6 * t521 * t60 * t76, 0.3878496e1 * t1295 * t1750 + t1764 * t73 + t1766 * t78 - 0.487811050587815674e-1 * t1769 * t223 - 0.73992419488678004547e-3 * t1773 * t548 - 0.48781105058781567398e-1 * t570 * t881 + 0.5549431461650850341e-3 * t1274 * t857 + 0.8943202594109954023e-1 * t245 * t1781 - 0.24972441577428826534e-2 * t577 * t1743 + 0.51848458131677414201e-6 * t1786 * t1787 + t1817);
  t1820 = my_piecewise3(t41, 0.3878496e1 * t1699 * t498 - 0.2585664e1 * t1702 * t220 - 0.1292832e1 * t822 * t541 + 0.646416e0 * t200 * t1736, t1819);
  t1825 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t407 - t1688 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t900 + t1695 - t1697 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1820);
  tv3rho2sigma0 = t6 * t1825 + 0.2e1 * t905;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1832 = t5 * t615 * t454;
  t1836 = t5 * t619 * t454 / 0.12e2;
  t1838 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t454 - t1832 / 0.4e1 + t1836);
  tv3rho2sigma2 = t6 * t1838 + 0.2e1 * t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1844 = t5 * t640 * t407;
  t1852 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t407 - t1844 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t900 - t1688 / 0.8e1 + t1695 - t1697 / 0.8e1);
  tv3rho2sigma3 = t6 * t1852 + t905 + t920;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1858 = t5 * t664 * t454;
  t1865 = t5 * t272 * t1003;
  t1868 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t454 - t1858 / 0.8e1 - t1832 / 0.8e1 + t1836 - 0.3e1 / 0.8e1 * t5 * t268 * t1003 - t1865 / 0.8e1);
  tv3rho2sigma5 = t6 * t1868 + t1008 + t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1876 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t407 - t1844 / 0.4e1 + t1695);
  tv3rho2sigma6 = t6 * t1876 + 0.2e1 * t920;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1887 = t1556 * t424;
  t1890 = t718 * t953;
  t1895 = t44 * t723;
  t1900 = t731 * sigma[2];
  t1904 = t516 * t740;
  t1905 = t137 * t133;
  t1918 = t747 * sigma[2];
  t1920 = 0.1e1 / t1597 / t125;
  t1924 = 0.11e3 / 0.2187e4 * t1895 + 0.39134815150061607728e-1 * t44 * t723 * t133 - 0.96354658513409261456e-2 * t59 * t1900 * t133 + 0.18900336862245662824e-2 * t1904 * t1905 - 0.12353161347872982238e-4 * t737 * t750 * t1586 + 0.93093776153132442719e-3 * t59 * t1900 * t317 - 0.20660843568533593707e-6 * t530 * t736 * t750 * t753 + 0.1129639051870861062e-14 * t1918 * t1920 * t1602;
  t1931 = t1900 * t153;
  t1949 = -0.29575e0 * t33 * t430 * t769 + 0.19066666666666666667e1 * t1895 - 0.26438496356672512236e0 * t117 * t774 + 0.17592592592592592593e0 * t59 * t1900 - 0.20797164351851851853e-1 * t88 * t158 * t780;
  t1951 = -t1949;
  t1955 = t424 * t719;
  t1960 = t442 * t29;
  t1961 = t1960 * t58;
  t1969 = t43 * t723 * t153;
  t1975 = t975 * t28;
  t1976 = t1975 * t43;
  t1979 = t953 * t321;
  t1982 = t424 * t757;
  t1985 = t170 * t740;
  t1986 = t137 * t153;
  t1989 = t448 * t718;
  t1996 = t989 * t301;
  t2005 = -0.487811050587815674e-1 * t1976 * t324 - 0.2585664e1 * t801 * t1979 - 0.1292832e1 * t801 * t1982 + 0.51848458131677414201e-6 * t1985 * t1986 - 0.1292832e1 * t1989 * t719 - 0.2585664e1 * t1660 * t996 + 0.646416e0 * t352 * t1924 + 0.1292832e1 * t1996 * t321 + 0.646416e0 * t991 * t757 + 0.646416e0 * t1657 * t424 + 0.1292832e1 * t798 * t953;
  t2007 = my_piecewise3(t151, 0.8943202594109954023e-1 * t44 * t723 * t153 - 0.24972441577428826534e-2 * t59 * t1931 + 0.51848458131677414201e-6 * t740 * t137 * t153, t1949 * t150 + t1951 * t155 + 0.89432025941099540233e-1 * t978 * t761 + 0.3878496e1 * t1665 * t1955 + 0.91464571985215438873e-2 * t1637 * t445 - 0.73992419488678004547e-3 * t1961 * t764 - 0.48781105058781567398e-1 * t786 * t984 + 0.5549431461650850341e-3 * t1644 * t960 + 0.8943202594109954023e-1 * t346 * t1969 - 0.24972441577428826534e-2 * t793 * t1931 + t2005);
  t2008 = my_piecewise3(t124, 0.3878496e1 * t1887 * t719 - 0.2585664e1 * t1890 * t321 - 0.1292832e1 * t925 * t757 + 0.646416e0 * t301 * t1924, t2007);
  t2013 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t454 - t1858 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t1003 + t1836 - t1865 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t2008);
  tv3rho2sigma8 = t6 * t2013 + 0.2e1 * t1008;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2020 = t5 * t195 * t1066 / 0.8e1;
  t2021 = t1186 * t1010;
  t2026 = t497 * t1030;
  t2032 = t516 * t836;
  t2033 = sigma[0] * t53;
  t2042 = t845 * t537;
  t2046 = t1227 * rho[0];
  t2047 = 0.1e1 / t2046;
  t2051 = 0.17788552340937094422e-2 * t59 * t211 * t53 - 0.5558922606542842007e-3 * t2032 * t2033 + 0.46324355054523683391e-5 * t834 * t845 * t1216 - 0.14699017287336701482e-3 * t59 * t211 * t216 + 0.60767186966275275611e-7 * t530 * t2042 * t60 - 0.42361464445157289826e-15 * t531 * t2047 * t1232;
  t2072 = 0.63375e-1 * t33 * t1037 * t227 - 0.26438496356672512236e-1 * t383 * t232 + 0.27777777777777777778e-1 * t59 * t211 - 0.40690104166666666668e-2 * t88 * t34 * t239;
  t2074 = t1048 * t28;
  t2075 = t2074 * t43;
  t2087 = t58 * t211 * t76;
  t2090 = t96 * t836;
  t2091 = sigma[0] * t76;
  t2094 = -t2072;
  t2096 = t1056 * t200;
  t2107 = t1010 * t220;
  t2110 = t377 * t850;
  t2115 = t1030 * t220;
  t2120 = t2072 * t78 - 0.243905525293907837e-1 * t2075 * t223 + 0.18292914397043087775e-1 * t1768 * t398 - 0.487811050587815674e-1 * t874 * t881 + 0.55494314616508503411e-3 * t1773 * t857 - 0.10405183990595344389e-3 * t1273 * t1053 + 0.55494314616508503408e-3 * t576 * t2087 - 0.19443171799379030325e-6 * t2090 * t2091 + t2094 * t73 + 0.646416e0 * t2096 * t220 + 0.1292832e1 * t1806 * t377 - 0.2585664e1 * t1791 * t893 + 0.1292832e1 * t888 * t850 - 0.1292832e1 * t1290 * t1010 + 0.3878496e1 * t1295 * t2107 - 0.2585664e1 * t585 * t2110 + 0.646416e0 * t582 * t1030 - 0.1292832e1 * t585 * t2115 + 0.646416e0 * t251 * t2051;
  t2121 = my_piecewise3(t74, 0.55494314616508503408e-3 * t59 * t211 * t76 - 0.19443171799379030325e-6 * t836 * sigma[0] * t76, t2120);
  t2122 = my_piecewise3(t41, 0.3878496e1 * t2021 * t220 - 0.2585664e1 * t822 * t850 - 0.1292832e1 * t2026 * t220 + 0.646416e0 * t200 * t2051, t2121);
  t2127 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t1066 - t2020 - 0.3e1 / 0.8e1 * t5 * t27 * t2122);
  tv3rhosigma20 = t6 * t2127 + t1070;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2134 = t5 * t272 * t1127 / 0.8e1;
  t2136 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t1127 - t2134);
  tv3rhosigma25 = t6 * t2136 + t1131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t1066 - t2020);
  tv3rhosigma26 = t6 * t2142 + t1070;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2147 = t1556 * t1071;
  t2152 = t718 * t1091;
  t2158 = t516 * t939;
  t2159 = sigma[2] * t133;
  t2168 = t948 * t753;
  t2172 = t1597 * rho[1];
  t2173 = 0.1e1 / t2172;
  t2177 = 0.17788552340937094422e-2 * t59 * t312 * t133 - 0.5558922606542842007e-3 * t2158 * t2159 + 0.46324355054523683391e-5 * t937 * t948 * t1586 - 0.14699017287336701482e-3 * t59 * t312 * t317 + 0.60767186966275275611e-7 * t530 * t2168 * t137 - 0.42361464445157289826e-15 * t747 * t2173 * t1602;
  t2198 = 0.63375e-1 * t33 * t1098 * t328 - 0.26438496356672512236e-1 * t430 * t333 + 0.27777777777777777778e-1 * t59 * t312 - 0.40690104166666666668e-2 * t88 * t117 * t340;
  t2200 = t1109 * t28;
  t2201 = t2200 * t43;
  t2213 = t58 * t312 * t153;
  t2216 = t170 * t939;
  t2217 = sigma[2] * t153;
  t2220 = -t2198;
  t2222 = t1117 * t301;
  t2233 = t1071 * t321;
  t2236 = t424 * t953;
  t2241 = t1091 * t321;
  t2246 = t2198 * t155 - 0.243905525293907837e-1 * t2201 * t324 + 0.18292914397043087775e-1 * t1975 * t445 - 0.487811050587815674e-1 * t977 * t984 + 0.55494314616508503411e-3 * t1961 * t960 - 0.10405183990595344389e-3 * t1643 * t1114 + 0.55494314616508503408e-3 * t792 * t2213 - 0.19443171799379030325e-6 * t2216 * t2217 + t2220 * t150 + 0.646416e0 * t2222 * t321 + 0.1292832e1 * t1996 * t424 - 0.2585664e1 * t1989 * t996 + 0.1292832e1 * t991 * t953 - 0.1292832e1 * t1660 * t1071 + 0.3878496e1 * t1665 * t2233 - 0.2585664e1 * t801 * t2236 + 0.646416e0 * t798 * t1091 - 0.1292832e1 * t801 * t2241 + 0.646416e0 * t352 * t2177;
  t2247 = my_piecewise3(t151, 0.55494314616508503408e-3 * t59 * t312 * t153 - 0.19443171799379030325e-6 * t939 * sigma[2] * t153, t2246);
  t2248 = my_piecewise3(t124, 0.3878496e1 * t2147 * t321 - 0.2585664e1 * t925 * t953 - 0.1292832e1 * t2152 * t321 + 0.646416e0 * t301 * t2177, t2247);
  t2253 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t1127 - t2134 - 0.3e1 / 0.8e1 * t5 * t116 * t2248);
  tv3rhosigma211 = t6 * t2253 + t1131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2255 = t1010 * t377;
  t2266 = t1025 * t537;
  t2270 = 0.1e1 / t1227;
  t2274 = 0.12507575864721394516e-3 * t516 * t1017 * t53 - 0.17371633145446381272e-5 * t1016 * t1025 * t1216 - 0.13672617067411937012e-7 * t530 * t2266 * sigma[0] + 0.15885549166933983685e-15 * t517 * t2270 * t1232;
  t2280 = 0.1e1 / t89;
  t2289 = 0.71296875e-1 * t33 * t2280 * t37 - 0.33048120445840640295e-2 * t1037 * t82 + 0.30517578125000000001e-3 * t88 * t383 * t92;
  t2298 = -t2289;
  t2308 = t377 * t1030;
  t2313 = t2289 * t78 + 0.27439371595564631662e-1 * t2074 * t398 - 0.31215551971786033168e-3 * t1772 * t1053 + 0.72911894247671363718e-7 * t96 * t1017 * t76 + t2298 * t73 + 0.1939248e1 * t2096 * t377 - 0.3878496e1 * t1791 * t1010 + 0.1939248e1 * t888 * t1030 + 0.3878496e1 * t1295 * t2255 - 0.3878496e1 * t585 * t2308 + 0.646416e0 * t251 * t2274;
  t2314 = my_piecewise3(t74, 0.72911894247671363718e-7 * t1017 * t76, t2313);
  t2315 = my_piecewise3(t41, 0.3878496e1 * t1186 * t2255 - 0.3878496e1 * t822 * t1030 + 0.646416e0 * t200 * t2274, t2314);
  t2319 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2315);
  tv3sigma30 = t6 * t2319;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2320 = t1071 * t424;
  t2331 = t1086 * t753;
  t2335 = 0.1e1 / t1597;
  t2339 = 0.12507575864721394516e-3 * t516 * t1078 * t133 - 0.17371633145446381272e-5 * t1077 * t1086 * t1586 - 0.13672617067411937012e-7 * t530 * t2331 * sigma[2] + 0.15885549166933983685e-15 * t736 * t2335 * t1602;
  t2345 = 0.1e1 / t163;
  t2354 = 0.71296875e-1 * t33 * t2345 * t120 - 0.33048120445840640295e-2 * t1098 * t159 + 0.30517578125000000001e-3 * t88 * t430 * t166;
  t2363 = -t2354;
  t2373 = t424 * t1091;
  t2378 = t2354 * t155 + 0.27439371595564631662e-1 * t2200 * t445 - 0.31215551971786033168e-3 * t1960 * t1114 + 0.72911894247671363718e-7 * t170 * t1078 * t153 + t2363 * t150 + 0.1939248e1 * t2222 * t424 - 0.3878496e1 * t1989 * t1071 + 0.1939248e1 * t991 * t1091 + 0.3878496e1 * t1665 * t2320 - 0.3878496e1 * t801 * t2373 + 0.646416e0 * t352 * t2339;
  t2379 = my_piecewise3(t151, 0.72911894247671363718e-7 * t1078 * t153, t2378);
  t2380 = my_piecewise3(t124, 0.3878496e1 * t1556 * t2320 - 0.3878496e1 * t925 * t1091 + 0.646416e0 * t301 * t2339, t2379);
  t2384 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t2380);
  tv3sigma39 = t6 * t2384;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2388 = 0.1e1 / t1185 / t70;
  t2389 = t498 * t498;
  t2395 = t541 * t541;
  t2400 = sigma[0] * t92;
  t2401 = t44 * t2400;
  t2408 = t60 / t35 / t835;
  t2412 = 0.1e1 / t532;
  t2416 = t519 * t90;
  t2418 = 0.1e1 / t46 / t2416;
  t2426 = t59 * t53;
  t2432 = t531 * t2418;
  t2441 = t531 * t531;
  t2446 = t536 * t536;
  t2449 = 0.1e1 / t2446 * t29 * t58;
  t2452 = 0.2618e5 / 0.19683e5 * t2401 + 0.10348984450794069599e1 * t44 * t2400 * t53 - 0.30112066101575181503e0 * t59 * t2408 * t53 + 0.84429740092262542601e-1 * t518 * t2412 * t53 - 0.10760976107480464527e-2 * t1211 * t2418 * t1216 + 0.36601959549253280704e-5 * t516 * t1730 / t35 / t2046 * t2426 + 0.28445320491234913052e-1 * t59 * t2408 * t216 - 0.99208059313830153663e-5 * t530 * t2432 * t537 + 0.11447009058958058762e-12 * t1226 / t1227 / t61 * t1232 - 0.66418335807601710336e-18 * t2441 / t35 / t1227 / t835 * t2449;
  t2456 = t2400 * t76;
  t2459 = t2408 * t76;
  t2465 = t44 * t76;
  t2473 = t1265 * t28;
  t2477 = t568 * t29;
  t2478 = t2477 * t58;
  t2496 = -0.8543888888888888889e1 * t33 * t34 * t64 + 0.50420740740740740741e2 * t2401 - 0.74027789798683034258e1 * t81 * t1017 + 0.537551440329218107e1 * t59 * t2408 - 0.6969360853909465021e0 * t88 * t89 * t1025;
  t2505 = t580 * t497;
  t2508 = t249 * t1186;
  t2511 = -0.41944031231462577189e-7 * t96 * t531 * t2418 * t2465 - 0.975622101175631348e-1 * t2473 * t43 * t223 - 0.44395451693206802728e-2 * t2478 * t548 + 0.32556664575018322e-1 * t1274 * t1242 - 0.80487309643795296057e-1 * t577 * t2459 + t2496 * t73 - t2496 * t78 - 0.3878496e1 * t585 * t2395 - 0.5171328e1 * t585 * t220 * t1235 - 0.7756992e1 * t2505 * t498 + 0.15513984e2 * t2508 * t1187;
  t2514 = t98 * t2388;
  t2528 = t1285 * t200;
  t2541 = -0.15513984e2 * t1290 * t1298 - 0.15513984e2 * t2514 * t2389 + 0.23270976e2 * t1295 * t498 * t541 - 0.55305022007122575148e-5 * t243 * t517 * t1282 + 0.30417762103917416332e-4 * t1281 * t2412 * t76 + 0.646416e0 * t251 * t2452 + 0.2585664e1 * t2528 * t220 + 0.3878496e1 * t1287 * t541 + 0.2585664e1 * t582 * t1235 + 0.5365921556465972414e0 * t1268 * t545 - 0.16693978175671914177e1 * t571 * t1239 + 0.2364980241553521175e1 * t246 * t2456;
  t2543 = my_piecewise3(t74, 0.2364980241553521175e1 * t44 * t2456 - 0.80487309643795296057e-1 * t59 * t2459 + 0.30417762103917416332e-4 * t517 * t2412 * t76 - 0.41944031231462577189e-7 * t2432 * t2465, t2511 + t2541);
  t2544 = my_piecewise3(t41, -0.15513984e2 * t2388 * t2389 + 0.23270976e2 * t1186 * t498 * t541 - 0.3878496e1 * t497 * t2395 - 0.5171328e1 * t1190 * t1235 + 0.646416e0 * t200 * t2452, t2543);
  t2549 = t5 * t195 * t1305;
  t2552 = t5 * t1175 * t256;
  t2555 = t5 * t489 * t592;
  t2561 = t5 * t480 * t592;
  t2564 = t5 * t1163 * t256;
  t2566 = t5 * t1156 * t256;
  t2572 = 0.1e1 / t193 / t466;
  t2576 = 0.1e2 / 0.27e2 * t5 * t25 * t2572 * t102;
  t2579 = t5 * t188 * t1174 * t102;
  t2583 = t5 * t475 * t488 * t102;
  t2587 = t5 * t1151 * t194 * t102;
  t2589 = t19 * t19;
  t2591 = 0.1e1 / t461 / t2589;
  t2592 = t463 * t463;
  t2598 = t471 * t471;
  t2604 = 0.1e1 / t1142 / t6;
  t2605 = t16 * t2604;
  t2608 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1143 + 0.24e2 * t2605);
  t2612 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2591 * t2592 - 0.16e2 / 0.9e1 * t1135 * t463 * t471 + 0.4e1 / 0.3e1 * t462 * t2598 + 0.16e2 / 0.9e1 * t1139 * t1147 + 0.4e1 / 0.3e1 * t23 * t2608);
  t2620 = -0.3e1 / 0.8e1 * t5 * t27 * t2544 - t2549 / 0.2e1 - 0.5e1 / 0.9e1 * t2552 + t2555 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t189 * t1305 - 0.3e1 / 0.2e1 * t2561 + t2564 - 0.3e1 / 0.2e1 * t2566 - 0.9e1 / 0.4e1 * t5 * t476 * t592 + t2576 - 0.5e1 / 0.9e1 * t2579 + t2583 / 0.2e1 - t2587 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t2612 * t26 * t102 - 0.3e1 / 0.2e1 * t5 * t1152 * t256;
  t2621 = my_piecewise3(t1, 0, t2620);
  t2622 = t111 * t111;
  t2624 = 0.1e1 / t598 / t2622;
  t2625 = t600 * t600;
  t2631 = t606 * t606;
  t2636 = t108 * t2604;
  t2639 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1143 + 0.24e2 * t2636);
  t2643 = my_piecewise3(t112, 0, 0.4e2 / 0.81e2 * t2624 * t2625 - 0.16e2 / 0.9e1 * t1312 * t600 * t606 + 0.4e1 / 0.3e1 * t599 * t2631 + 0.16e2 / 0.9e1 * t1316 * t1322 + 0.4e1 / 0.3e1 * t113 * t2639);
  t2650 = t5 * t1326 * t194 * t176;
  t2654 = t5 * t610 * t488 * t176;
  t2658 = t5 * t267 * t1174 * t176;
  t2663 = 0.1e2 / 0.27e2 * t5 * t115 * t2572 * t176;
  t2665 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t2643 * t26 * t176 - t2650 / 0.2e1 + t2654 / 0.2e1 - 0.5e1 / 0.9e1 * t2658 + t2663);
  tv4rho40 = 0.4e1 * t1310 + 0.4e1 * t1344 + t6 * (t2621 + t2665);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2675 = t5 * t284 * t1174 * t102;
  t2679 = t5 * t1364 * t194 * t102;
  t2683 = t5 * t635 * t488 * t102;
  t2684 = t2683 / 0.4e1;
  t2686 = t5 * t1376 * t256;
  t2687 = t2686 / 0.4e1;
  t2689 = t5 * t640 * t592;
  t2698 = t5 * t1369 * t256;
  t2716 = 0.12e2 * t1143;
  t2717 = 0.24e2 * t2605;
  t2719 = my_piecewise5(t10, 0, t14, 0, -t2716 + t2717);
  t2723 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2591 * t281 * t1136 - 0.8e1 / 0.9e1 * t1135 * t631 * t463 - 0.8e1 / 0.9e1 * t1349 * t185 * t471 + 0.4e1 / 0.3e1 * t462 * t1360 * t185 + 0.4e1 / 0.3e1 * t1352 * t471 + 0.4e1 / 0.9e1 * t627 * t1147 + 0.4e1 / 0.3e1 * t23 * t2719);
  t2737 = -0.3e1 / 0.8e1 * t5 * t285 * t1305 - 0.5e1 / 0.36e2 * t2675 - 0.3e1 / 0.8e1 * t2679 + t2684 + t2687 - 0.3e1 / 0.8e1 * t2689 - 0.9e1 / 0.8e1 * t5 * t636 * t592 - 0.9e1 / 0.8e1 * t5 * t1365 * t256 - 0.3e1 / 0.4e1 * t2698 - 0.3e1 / 0.8e1 * t5 * t2723 * t26 * t102 - t2549 / 0.8e1 - 0.5e1 / 0.12e2 * t2552 + t2555 / 0.4e1 - 0.3e1 / 0.8e1 * t2561 + t2564 / 0.2e1 - 0.3e1 / 0.8e1 * t2566 + t2576 - 0.5e1 / 0.12e2 * t2579 + t2583 / 0.4e1 - t2587 / 0.8e1;
  t2738 = my_piecewise3(t1, 0, t2737);
  t2755 = 0.24e2 * t2636;
  t2757 = my_piecewise5(t14, 0, t10, 0, t2716 + t2755);
  t2761 = my_piecewise3(t112, 0, 0.4e2 / 0.81e2 * t2624 * t292 * t1313 - 0.8e1 / 0.9e1 * t1312 * t655 * t600 - 0.8e1 / 0.9e1 * t1393 * t264 * t606 + 0.4e1 / 0.3e1 * t599 * t1403 * t264 + 0.4e1 / 0.3e1 * t1396 * t606 + 0.4e1 / 0.9e1 * t651 * t1322 + 0.4e1 / 0.3e1 * t113 * t2757);
  t2768 = t5 * t1407 * t194 * t176;
  t2772 = t5 * t659 * t488 * t176;
  t2773 = t2772 / 0.4e1;
  t2776 = t5 * t295 * t1174 * t176;
  t2785 = t5 * t1331 * t357;
  t2788 = t5 * t1335 * t357;
  t2789 = t2788 / 0.4e1;
  t2791 = t5 * t1339 * t357;
  t2793 = -0.3e1 / 0.8e1 * t5 * t2761 * t26 * t176 - 0.3e1 / 0.8e1 * t2768 + t2773 - 0.5e1 / 0.36e2 * t2776 - t2650 / 0.8e1 + t2654 / 0.4e1 - 0.5e1 / 0.12e2 * t2658 + t2663 - 0.3e1 / 0.8e1 * t5 * t1327 * t357 - 0.3e1 / 0.8e1 * t2785 + t2789 - 0.5e1 / 0.36e2 * t2791;
  t2794 = my_piecewise3(t107, 0, t2793);
  tv4rho41 = t1310 + t1344 + 0.3e1 * t1392 + 0.3e1 * t1432 + t6 * (t2738 + t2794);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2803 = t5 * t690 * t488 * t102;
  t2807 = t5 * t1448 * t194 * t102;
  t2820 = t631 * t631;
  t2833 = my_piecewise5(t10, 0, t14, 0, t2717);
  t2837 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2591 * t681 * t463 - 0.32e2 / 0.27e2 * t1349 * t185 * t631 - 0.8e1 / 0.27e2 * t1435 * t471 + 0.8e1 / 0.9e1 * t462 * t2820 + 0.8e1 / 0.9e1 * t627 * t1360 - 0.8e1 / 0.27e2 * t1135 * t686 * t463 + 0.8e1 / 0.9e1 * t462 * t1444 * t185 + 0.4e1 / 0.9e1 * t1440 * t471 + 0.4e1 / 0.3e1 * t23 * t2833);
  t2846 = t5 * t1453 * t256;
  t2859 = t2803 / 0.12e2 - t2807 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t691 * t592 - 0.3e1 / 0.8e1 * t5 * t2837 * t26 * t102 - 0.3e1 / 0.4e1 * t5 * t1449 * t256 - t2846 / 0.4e1 - 0.5e1 / 0.18e2 * t2675 - t2679 / 0.4e1 + t2683 / 0.3e1 + t2686 / 0.3e1 - t2689 / 0.4e1 - t2698 / 0.2e1 - 0.5e1 / 0.18e2 * t2552 + t2555 / 0.12e2 + t2564 / 0.6e1 + t2576 - 0.5e1 / 0.18e2 * t2579 + t2583 / 0.12e2;
  t2860 = my_piecewise3(t1, 0, t2859);
  t2869 = t655 * t655;
  t2882 = my_piecewise5(t14, 0, t10, 0, t2755);
  t2886 = my_piecewise3(t112, 0, 0.4e2 / 0.81e2 * t2624 * t698 * t600 - 0.32e2 / 0.27e2 * t1393 * t264 * t655 - 0.8e1 / 0.27e2 * t1465 * t606 + 0.8e1 / 0.9e1 * t599 * t2869 + 0.8e1 / 0.9e1 * t651 * t1403 - 0.8e1 / 0.27e2 * t1312 * t703 * t600 + 0.8e1 / 0.9e1 * t599 * t1474 * t264 + 0.4e1 / 0.9e1 * t1470 * t606 + 0.4e1 / 0.3e1 * t113 * t2882);
  t2893 = t5 * t1478 * t194 * t176;
  t2897 = t5 * t707 * t488 * t176;
  t2906 = t5 * t1412 * t357;
  t2909 = t5 * t1416 * t357;
  t2920 = t5 * t615 * t808;
  t2923 = t5 * t619 * t808;
  t2925 = -0.3e1 / 0.8e1 * t5 * t2886 * t26 * t176 - t2893 / 0.4e1 + t2897 / 0.12e2 - t2768 / 0.4e1 + t2772 / 0.3e1 - 0.5e1 / 0.18e2 * t2776 - 0.3e1 / 0.4e1 * t5 * t1408 * t357 - t2906 / 0.2e1 + t2909 / 0.6e1 + t2654 / 0.12e2 - 0.5e1 / 0.18e2 * t2658 + t2663 - t2785 / 0.4e1 + t2788 / 0.3e1 - 0.5e1 / 0.18e2 * t2791 - 0.3e1 / 0.8e1 * t5 * t611 * t808 - t2920 / 0.4e1 + t2923 / 0.12e2;
  t2926 = my_piecewise3(t107, 0, t2925);
  tv4rho42 = 0.2e1 * t1392 + 0.2e1 * t1432 + 0.2e1 * t1464 + 0.2e1 * t1503 + t6 * (t2860 + t2926);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2947 = my_piecewise5(t10, 0, t14, 0, t2716 + t2717);
  t2951 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2591 * t1508 * t185 - 0.8e1 / 0.9e1 * t1435 * t631 - 0.8e1 / 0.9e1 * t1349 * t686 * t185 + 0.4e1 / 0.3e1 * t1352 * t686 + 0.4e1 / 0.3e1 * t627 * t1444 + 0.4e1 / 0.9e1 * t462 * t1515 * t185 + 0.4e1 / 0.3e1 * t23 * t2947);
  t2958 = t5 * t1519 * t194 * t102;
  t2969 = -0.3e1 / 0.8e1 * t5 * t2951 * t26 * t102 - t2958 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1520 * t256 - 0.3e1 / 0.8e1 * t2807 + t2803 / 0.4e1 - 0.3e1 / 0.8e1 * t2846 + t2684 - 0.5e1 / 0.12e2 * t2675 + t2687 - 0.5e1 / 0.36e2 * t2579 + t2576 - 0.5e1 / 0.36e2 * t2552;
  t2970 = my_piecewise3(t1, 0, t2969);
  t2987 = my_piecewise5(t14, 0, t10, 0, -t2716 + t2755);
  t2991 = my_piecewise3(t112, 0, 0.4e2 / 0.81e2 * t2624 * t1528 * t264 - 0.8e1 / 0.9e1 * t1465 * t655 - 0.8e1 / 0.9e1 * t1393 * t703 * t264 + 0.4e1 / 0.3e1 * t1396 * t703 + 0.4e1 / 0.3e1 * t651 * t1474 + 0.4e1 / 0.9e1 * t599 * t1535 * t264 + 0.4e1 / 0.3e1 * t113 * t2987);
  t2998 = t5 * t1539 * t194 * t176;
  t3006 = t5 * t1483 * t357;
  t3015 = t5 * t664 * t808;
  t3025 = t5 * t272 * t1675;
  t3027 = -0.3e1 / 0.8e1 * t5 * t2991 * t26 * t176 - t2998 / 0.8e1 - 0.3e1 / 0.8e1 * t2893 + t2897 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1479 * t357 - 0.3e1 / 0.8e1 * t3006 + t2773 - 0.5e1 / 0.12e2 * t2776 - 0.3e1 / 0.4e1 * t2906 + t2909 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t660 * t808 - 0.3e1 / 0.8e1 * t3015 - 0.5e1 / 0.36e2 * t2658 + t2663 + t2789 - 0.5e1 / 0.12e2 * t2791 - 0.3e1 / 0.8e1 * t2920 + t2923 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t268 * t1675 - t3025 / 0.8e1;
  t3028 = my_piecewise3(t107, 0, t3027);
  tv4rho43 = 0.3e1 * t1464 + 0.3e1 * t1503 + t1527 + t1680 + t6 * (t2970 + t3028);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3033 = t681 * t681;
  t3038 = t686 * t686;
  t3045 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1143 + 0.24e2 * t2605);
  t3049 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2591 * t3033 - 0.16e2 / 0.9e1 * t1435 * t686 + 0.4e1 / 0.3e1 * t462 * t3038 + 0.16e2 / 0.9e1 * t627 * t1515 + 0.4e1 / 0.3e1 * t23 * t3045);
  t3058 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3049 * t26 * t102 - t2958 / 0.2e1 + t2803 / 0.2e1 - 0.5e1 / 0.9e1 * t2675 + t2576);
  t3060 = 0.1e1 / t1555 / t147;
  t3061 = t719 * t719;
  t3067 = t757 * t757;
  t3072 = sigma[2] * t166;
  t3073 = t44 * t3072;
  t3080 = t137 / t118 / t938;
  t3084 = 0.1e1 / t748;
  t3088 = t738 * t164;
  t3090 = 0.1e1 / t126 / t3088;
  t3098 = t59 * t133;
  t3104 = t747 * t3090;
  t3113 = t747 * t747;
  t3118 = t752 * t752;
  t3121 = 0.1e1 / t3118 * t29 * t58;
  t3124 = 0.2618e5 / 0.19683e5 * t3073 + 0.10348984450794069599e1 * t44 * t3072 * t133 - 0.30112066101575181503e0 * t59 * t3080 * t133 + 0.84429740092262542601e-1 * t737 * t3084 * t133 - 0.10760976107480464527e-2 * t1581 * t3090 * t1586 + 0.36601959549253280704e-5 * t516 * t1918 / t118 / t2172 * t3098 + 0.28445320491234913052e-1 * t59 * t3080 * t317 - 0.99208059313830153663e-5 * t530 * t3104 * t753 + 0.11447009058958058762e-12 * t1596 / t1597 / t138 * t1602 - 0.66418335807601710336e-18 * t3113 / t118 / t1597 / t938 * t3121;
  t3128 = t3072 * t153;
  t3131 = t3080 * t153;
  t3137 = t44 * t153;
  t3141 = t172 * t3060;
  t3158 = t796 * t718;
  t3161 = t350 * t1556;
  t3170 = t1635 * t28;
  t3174 = -0.15513984e2 * t3141 * t3061 + 0.23270976e2 * t1665 * t719 * t757 - 0.3878496e1 * t801 * t3067 - 0.5171328e1 * t801 * t321 * t1605 - 0.55305022007122575148e-5 * t344 * t736 * t1652 + 0.30417762103917416332e-4 * t1651 * t3084 * t153 - 0.7756992e1 * t3158 * t719 + 0.15513984e2 * t3161 * t1557 - 0.15513984e2 * t1660 * t1668 - 0.41944031231462577189e-7 * t170 * t747 * t3090 * t3137 - 0.975622101175631348e-1 * t3170 * t43 * t324;
  t3175 = t784 * t29;
  t3176 = t3175 * t58;
  t3194 = -0.8543888888888888889e1 * t33 * t117 * t141 + 0.50420740740740740741e2 * t3073 - 0.74027789798683034258e1 * t158 * t1078 + 0.537551440329218107e1 * t59 * t3080 - 0.6969360853909465021e0 * t88 * t163 * t1086;
  t3204 = t1655 * t301;
  t3213 = -0.44395451693206802728e-2 * t3176 * t764 + 0.32556664575018322e-1 * t1644 * t1612 - 0.80487309643795296057e-1 * t793 * t3131 + t3194 * t150 - t3194 * t155 + 0.646416e0 * t352 * t3124 + 0.3878496e1 * t1657 * t757 + 0.2585664e1 * t798 * t1605 + 0.2585664e1 * t3204 * t321 + 0.5365921556465972414e0 * t1638 * t761 - 0.16693978175671914177e1 * t787 * t1609 + 0.2364980241553521175e1 * t347 * t3128;
  t3215 = my_piecewise3(t151, 0.2364980241553521175e1 * t44 * t3128 - 0.80487309643795296057e-1 * t59 * t3131 + 0.30417762103917416332e-4 * t736 * t3084 * t153 - 0.41944031231462577189e-7 * t3104 * t3137, t3174 + t3213);
  t3216 = my_piecewise3(t124, -0.15513984e2 * t3060 * t3061 + 0.23270976e2 * t1556 * t719 * t757 - 0.3878496e1 * t718 * t3067 - 0.5171328e1 * t1560 * t1605 + 0.646416e0 * t301 * t3124, t3215);
  t3226 = t698 * t698;
  t3231 = t703 * t703;
  t3238 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1143 + 0.24e2 * t2636);
  t3242 = my_piecewise3(t112, 0, 0.4e2 / 0.81e2 * t2624 * t3226 - 0.16e2 / 0.9e1 * t1465 * t703 + 0.4e1 / 0.3e1 * t599 * t3231 + 0.16e2 / 0.9e1 * t651 * t1535 + 0.4e1 / 0.3e1 * t113 * t3238);
  t3258 = -0.3e1 / 0.8e1 * t5 * t116 * t3216 - 0.3e1 / 0.2e1 * t5 * t296 * t1675 - 0.9e1 / 0.4e1 * t5 * t708 * t808 - 0.3e1 / 0.8e1 * t5 * t3242 * t26 * t176 - 0.3e1 / 0.2e1 * t5 * t1540 * t357 - t3025 / 0.2e1 - t2998 / 0.2e1 - 0.3e1 / 0.2e1 * t3006 - 0.3e1 / 0.2e1 * t3015 + t2897 / 0.2e1 + t2909 + t2923 / 0.2e1 - 0.5e1 / 0.9e1 * t2776 - 0.5e1 / 0.9e1 * t2791 + t2663;
  t3259 = my_piecewise3(t107, 0, t3258);
  tv4rho44 = 0.4e1 * t1527 + 0.4e1 * t1680 + t6 * (t3058 + t3259);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3267 = t5 * t1156 * t407;
  t3273 = t5 * t1163 * t407;
  t3276 = t5 * t480 * t900;
  t3283 = 0.5e1 / 0.36e2 * t5 * t1175 * t407;
  t3285 = t5 * t489 * t900;
  t3288 = t5 * t195 * t1820;
  t3305 = t44 * t1194;
  t3310 = t1202 * sigma[0];
  t3329 = t517 * t1214;
  t3343 = -0.154e4 / 0.6561e4 * t3305 - 0.1826291373669541694e0 * t44 * t1194 * t53 + 0.75008395704284748149e-1 * t59 * t3310 * t53 - 0.25323980763139613588e-1 * t516 * t1207 * t1717 + 0.36647711998689847306e-3 * t516 * t1214 * t517 * t1216 - 0.13725734830969980264e-5 * t1211 / t35 / t1227 * t2426 - 0.68268769178963791327e-2 * t59 * t3310 * t216 + 0.30275562928530926203e-5 * t530 * t3329 * t537 - 0.3953736681548013717e-13 * t1730 * t1229 * t1232 + 0.24906875927850641376e-18 * t531 * t517 / t35 / t1227 / t519 * t2449;
  t3350 = t3310 * t76;
  t3384 = t1766 * t28;
  t3388 = t872 * t29;
  t3389 = t3388 * t58;
  t3411 = 0.91464571985215438873e-2 * t2473 * t398 + 0.11635488e2 * t1295 * t893 * t541 - 0.73171657588172351097e-1 * t1267 * t881 + 0.26829607782329862069e0 * t570 * t1781 - 0.41734945439179785441e0 * t245 * t43 * t1194 * t76 + 0.2682960778232986207e0 * t1769 * t545 + 0.81391661437545805002e-2 * t1773 * t1242 + 0.21026179204699332958e-1 * t577 * t3350 + 0.15729011711798466446e-7 * t96 * t1214 * t517 * t2465 - 0.41734945439179785442e0 * t875 * t1239 - 0.731716575881723511e-1 * t3384 * t43 * t223 - 0.22197725846603401364e-2 * t3389 * t548 - 0.74917324732286479603e-2 * t1274 * t1743 + 0.83241471924762755115e-3 * t2478 * t857 + 0.11635488e2 * t1295 * t850 * t498 - 0.3878496e1 * t585 * t850 * t541 - 0.13826255501780643787e-5 * t395 * t517 * t1282 + 0.1555453743950322426e-5 * t243 * t521 * t1787 - 0.98512070450187086981e-5 * t96 * t1207 * t1787;
  t3442 = 0.98583333333333333333e0 * t33 * t383 * t1250 - 0.88977777777777777779e1 * t3305 + 0.15863097814003507342e1 * t34 * t1255 - 0.12901234567901234568e1 * t59 * t3310 + 0.18024209104938271606e0 * t88 * t81 * t1261;
  t3446 = t401 * t1186;
  t3461 = t886 * t497;
  t3464 = t1764 * t200;
  t3467 = 0.11635488e2 * t2508 * t1750 - 0.3878496e1 * t2505 * t893 - 0.7756992e1 * t1290 * t1796 - 0.3878496e1 * t1290 * t1799 - 0.3878496e1 * t585 * t1736 * t220 - 0.15513984e2 * t2514 * t377 * t1187 - 0.1292832e1 * t585 * t377 * t1235 - 0.3878496e1 * t1791 * t1298 + t3442 * t73 - t3442 * t78 + 0.3878496e1 * t3446 * t1187 + 0.1939248e1 * t1806 * t541 + 0.646416e0 * t888 * t1235 + 0.646416e0 * t2528 * t377 + 0.1939248e1 * t1287 * t850 + 0.1939248e1 * t582 * t1736 + 0.646416e0 * t251 * t3343 - 0.3878496e1 * t3461 * t498 + 0.1939248e1 * t3464 * t220;
  t3469 = my_piecewise3(t74, -0.41734945439179785441e0 * t44 * t1194 * t76 + 0.21026179204699332958e-1 * t59 * t3350 - 0.98512070450187086981e-5 * t1207 * t60 * t76 + 0.15729011711798466446e-7 * t3329 * t2465, t3411 + t3467);
  t3470 = my_piecewise3(t41, -0.15513984e2 * t2388 * t377 * t1187 + 0.11635488e2 * t1186 * t850 * t498 + 0.11635488e2 * t1699 * t1298 - 0.3878496e1 * t497 * t1736 * t220 - 0.3878496e1 * t1702 * t541 - 0.1292832e1 * t822 * t1235 + 0.646416e0 * t200 * t3343, t3469);
  t3475 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1152 * t407 - 0.3e1 / 0.8e1 * t3267 - 0.9e1 / 0.8e1 * t5 * t476 * t900 + t3273 / 0.4e1 - 0.3e1 / 0.4e1 * t3276 - 0.9e1 / 0.8e1 * t5 * t189 * t1820 - t3283 + t3285 / 0.4e1 - 0.3e1 / 0.8e1 * t3288 - 0.3e1 / 0.8e1 * t5 * t27 * t3470);
  tv4rho3sigma0 = t6 * t3475 + 0.3e1 * t1825;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3482 = t5 * t1331 * t454;
  t3485 = t5 * t1335 * t454;
  t3489 = 0.5e1 / 0.36e2 * t5 * t1339 * t454;
  t3491 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t454 - 0.3e1 / 0.8e1 * t3482 + t3485 / 0.4e1 - t3489);
  tv4rho3sigma2 = t6 * t3491 + 0.3e1 * t1838;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3493 = 0.2e1 * t1852;
  t3499 = t5 * t1369 * t407 / 0.4e1;
  t3504 = t5 * t1376 * t407;
  t3508 = t5 * t640 * t900 / 0.4e1;
  t3517 = -0.3e1 / 0.8e1 * t5 * t1365 * t407 - t3499 - 0.3e1 / 0.4e1 * t5 * t636 * t900 + t3504 / 0.12e2 - t3508 - 0.3e1 / 0.8e1 * t5 * t285 * t1820 - t3267 / 0.8e1 + t3273 / 0.6e1 - t3276 / 0.4e1 - t3283 + t3285 / 0.6e1 - t3288 / 0.8e1;
  t3518 = my_piecewise3(t1, 0, t3517);
  tv4rho3sigma3 = t6 * t3518 + t1825 + t3493;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3520 = 0.2e1 * t1868;
  t3526 = t5 * t1412 * t454 / 0.4e1;
  t3528 = t5 * t1416 * t454;
  t3537 = t5 * t615 * t1003 / 0.4e1;
  t3539 = t5 * t619 * t1003;
  t3542 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1408 * t454 - t3526 + t3528 / 0.12e2 - t3482 / 0.8e1 + t3485 / 0.6e1 - t3489 - 0.3e1 / 0.8e1 * t5 * t611 * t1003 - t3537 + t3539 / 0.12e2);
  tv4rho3sigma5 = t6 * t3542 + t1838 + t3520;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3548 = t5 * t1453 * t407;
  t3557 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1449 * t407 - t3548 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t691 * t900 - t3499 + t3504 / 0.6e1 - t3508 + t3273 / 0.12e2 - t3283 + t3285 / 0.12e2);
  tv4rho3sigma6 = t6 * t3557 + t1876 + t3493;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3563 = t5 * t1483 * t454;
  t3570 = t5 * t664 * t1003;
  t3578 = t5 * t272 * t2008;
  t3580 = -0.3e1 / 0.8e1 * t5 * t1479 * t454 - t3563 / 0.8e1 - t3526 + t3528 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t660 * t1003 - t3570 / 0.4e1 + t3485 / 0.12e2 - t3489 - t3537 + t3539 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t268 * t2008 - t3578 / 0.8e1;
  t3581 = my_piecewise3(t107, 0, t3580);
  tv4rho3sigma8 = t6 * t3581 + t2013 + t3520;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3590 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1520 * t407 - 0.3e1 / 0.8e1 * t3548 + t3504 / 0.4e1 - t3283);
  tv4rho3sigma9 = t6 * t3590 + 0.3e1 * t1876;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3622 = t44 * t1564;
  t3627 = t1572 * sigma[2];
  t3646 = t736 * t1584;
  t3660 = -0.154e4 / 0.6561e4 * t3622 - 0.1826291373669541694e0 * t44 * t1564 * t133 + 0.75008395704284748149e-1 * t59 * t3627 * t133 - 0.25323980763139613588e-1 * t516 * t1577 * t1905 + 0.36647711998689847306e-3 * t516 * t1584 * t736 * t1586 - 0.13725734830969980264e-5 * t1581 / t118 / t1597 * t3098 - 0.68268769178963791327e-2 * t59 * t3627 * t317 + 0.30275562928530926203e-5 * t530 * t3646 * t753 - 0.3953736681548013717e-13 * t1918 * t1599 * t1602 + 0.24906875927850641376e-18 * t747 * t736 / t118 / t1597 / t738 * t3121;
  t3667 = t3627 * t153;
  t3693 = t1951 * t28;
  t3709 = t975 * t29;
  t3710 = t3709 * t58;
  t3726 = 0.11635488e2 * t1665 * t996 * t757 - 0.41734945439179785441e0 * t346 * t43 * t1564 * t153 + 0.91464571985215438873e-2 * t3170 * t445 - 0.73171657588172351097e-1 * t1637 * t984 + 0.26829607782329862069e0 * t786 * t1969 - 0.74917324732286479603e-2 * t1644 * t1931 + 0.21026179204699332958e-1 * t793 * t3667 - 0.731716575881723511e-1 * t3693 * t43 * t324 + 0.2682960778232986207e0 * t1976 * t761 + 0.81391661437545805002e-2 * t1961 * t1612 - 0.41734945439179785442e0 * t978 * t1609 + 0.15729011711798466446e-7 * t170 * t1584 * t736 * t3137 + 0.83241471924762755115e-3 * t3176 * t960 - 0.22197725846603401364e-2 * t3710 * t764 - 0.15513984e2 * t3141 * t424 * t1557 - 0.3878496e1 * t801 * t953 * t757 - 0.3878496e1 * t1660 * t1982 + 0.11635488e2 * t3161 * t1955 + 0.11635488e2 * t1665 * t953 * t719;
  t3748 = t1949 * t301;
  t3763 = t989 * t718;
  t3766 = t448 * t1556;
  t3780 = 0.98583333333333333333e0 * t33 * t430 * t1620 - 0.88977777777777777779e1 * t3622 + 0.15863097814003507342e1 * t117 * t1625 - 0.12901234567901234568e1 * t59 * t3627 + 0.18024209104938271606e0 * t88 * t158 * t1631;
  t3784 = -0.13826255501780643787e-5 * t442 * t736 * t1652 + 0.1555453743950322426e-5 * t344 * t740 * t1986 - 0.98512070450187086981e-5 * t170 * t1577 * t1986 - 0.7756992e1 * t1660 * t1979 - 0.3878496e1 * t801 * t1924 * t321 - 0.1292832e1 * t801 * t424 * t1605 - 0.3878496e1 * t1989 * t1668 - 0.3878496e1 * t3158 * t996 + 0.1939248e1 * t3748 * t321 + 0.646416e0 * t3204 * t424 + 0.1939248e1 * t1657 * t953 + 0.1939248e1 * t798 * t1924 + 0.646416e0 * t352 * t3660 + 0.1939248e1 * t1996 * t757 + 0.646416e0 * t991 * t1605 - 0.3878496e1 * t3763 * t719 + 0.3878496e1 * t3766 * t1557 + t3780 * t150 - t3780 * t155;
  t3786 = my_piecewise3(t151, -0.41734945439179785441e0 * t44 * t1564 * t153 + 0.21026179204699332958e-1 * t59 * t3667 - 0.98512070450187086981e-5 * t1577 * t137 * t153 + 0.15729011711798466446e-7 * t3646 * t3137, t3726 + t3784);
  t3787 = my_piecewise3(t124, -0.15513984e2 * t3060 * t424 * t1557 + 0.11635488e2 * t1556 * t953 * t719 + 0.11635488e2 * t1887 * t1668 - 0.3878496e1 * t718 * t1924 * t321 - 0.3878496e1 * t1890 * t757 - 0.1292832e1 * t925 * t1605 + 0.646416e0 * t301 * t3660, t3786);
  t3792 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1540 * t454 - 0.3e1 / 0.8e1 * t3563 - 0.9e1 / 0.8e1 * t5 * t708 * t1003 + t3528 / 0.4e1 - 0.3e1 / 0.4e1 * t3570 - 0.9e1 / 0.8e1 * t5 * t296 * t2008 - t3489 + t3539 / 0.4e1 - 0.3e1 / 0.8e1 * t3578 - 0.3e1 / 0.8e1 * t5 * t116 * t3787);
  tv4rho3sigma11 = t6 * t3792 + 0.3e1 * t2013;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[1] = 0.0e0;

  t3799 = t5 * t480 * t1066;
  t3806 = t5 * t489 * t1066 / 0.12e2;
  t3808 = t5 * t195 * t2122;
  t3817 = t850 * t850;
  t3861 = -0.11266083149260159801e-1 * t59 * t510 * t53 + 0.61889338352843641011e-2 * t1716 * t2033 - 0.11581088763630920848e-3 * t516 * t534 * t60 * t1216 + 0.5147150561613742599e-6 * t518 / t35 / t519 / t237 * t2426 + 0.93093776153132442719e-3 * t59 * t510 * t216 - 0.77376884737057184278e-6 * t530 * t534 * t537 * t60 + 0.1284964421503104458e-13 * t1732 * t1232 * t531 - 0.93400784729439905162e-19 * t1226 / t35 / t1227 / t237 * t2449;
  t3894 = t1048 * t29;
  t3895 = t3894 * t58;
  t3907 = t2072 * t28;
  t3930 = -0.49944883154857653069e-2 * t1773 * t1743 - 0.58983793919244249171e-8 * t96 * t534 * t60 * t2465 - 0.487811050587815674e-1 * t3907 * t43 * t223 - 0.5171328e1 * t3461 * t893 + 0.1036969162633548284e-5 * t395 * t521 * t1787 - 0.3888634359875806065e-6 * t243 * t836 * t2091 + 0.27868546245776610132e-5 * t1786 * t2091 + 0.7756992e1 * t3446 * t1750 + 0.7756992e1 * t2508 * t2107 - 0.5171328e1 * t1290 * t2110 + 0.3878496e1 * t1295 * t1030 * t498;
  t3953 = t1056 * t497;
  t3967 = t2094 * t200;
  t3988 = 0.147875e0 * t33 * t1037 * t553 - 0.13219248178336256118e0 * t383 * t558 + 0.17592592592592592593e0 * t59 * t510 - 0.31195746527777777779e-1 * t88 * t34 * t564;
  t3992 = 0.1292832e1 * t582 * t2051 + 0.646416e0 * t251 * t3861 + 0.1292832e1 * t888 * t1736 - 0.1292832e1 * t2505 * t1010 + 0.1292832e1 * t3967 * t220 + 0.646416e0 * t2096 * t541 + 0.1292832e1 * t3464 * t377 + 0.2585664e1 * t1806 * t850 - 0.2585664e1 * t585 * t3817 + t3988 * t73 - t3988 * t78;
  t3995 = my_piecewise3(t74, -0.35146399257122052158e-2 * t59 * t510 * t76 + 0.27868546245776610132e-5 * t521 * sigma[0] * t76 - 0.58983793919244249171e-8 * t534 * t60 * t2465, 0.17886405188219908047e0 * t874 * t1781 + 0.11098862923301700682e-2 * t1273 * t2087 - 0.35146399257122052158e-2 * t576 * t58 * t510 * t76 + 0.15513984e2 * t1295 * t893 * t850 + 0.18292914397043087775e-1 * t3384 * t398 - 0.10405183990595344389e-3 * t2477 * t1053 - 0.975622101175631348e-1 * t1768 * t881 + 0.89432025941099540233e-1 * t2075 * t545 - 0.73992419488678004547e-3 * t3895 * t548 + 0.11098862923301700682e-2 * t3389 * t857 + t3930 - 0.15513984e2 * t2514 * t1010 * t498 - 0.2585664e1 * t585 * t377 * t1736 - 0.2585664e1 * t1290 * t2115 - 0.5171328e1 * t1791 * t1796 - 0.2585664e1 * t1791 * t1799 - 0.1292832e1 * t585 * t1030 * t541 + 0.3878496e1 * t1295 * t1010 * t541 - 0.2585664e1 * t585 * t2051 * t220 - 0.1292832e1 * t3953 * t498 + 0.646416e0 * t1287 * t1030 + t3992);
  t3996 = my_piecewise3(t41, -0.15513984e2 * t2388 * t1010 * t498 + 0.15513984e2 * t1699 * t1796 + 0.3878496e1 * t2021 * t541 - 0.2585664e1 * t497 * t3817 - 0.2585664e1 * t822 * t1736 + 0.3878496e1 * t1186 * t1030 * t498 - 0.2585664e1 * t497 * t2051 * t220 - 0.1292832e1 * t2026 * t541 + 0.646416e0 * t200 * t3861, t3995);
  t4001 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t476 * t1066 - t3799 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t189 * t2122 + t3806 - t3808 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t3996);
  tv4rho2sigma20 = t6 * t4001 + 0.2e1 * t2127;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[3] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[4] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[5] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[6] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[7] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[8] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[9] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[10] = 0.0e0;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[11] = 0.0e0;

  t4008 = t5 * t615 * t1127;
  t4012 = t5 * t619 * t1127 / 0.12e2;
  t4014 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t611 * t1127 - t4008 / 0.4e1 + t4012);
  tv4rho2sigma25 = t6 * t4014 + 0.2e1 * t2136;

  if(v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    v4sigma4[13] = 0.0e0;

  t4020 = t5 * t640 * t1066;
  t4028 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t636 * t1066 - t4020 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t285 * t2122 - t3799 / 0.8e1 + t3806 - t3808 / 0.8e1);
  tv4rho2sigma26 = t6 * t4028 + t2127 + t2142;

#ifndef XC_DONT_COMPILE_MXC

  if(order < 5) return;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4034 = t5 * t664 * t1127;
  t4041 = t5 * t272 * t2248;
  t4044 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t660 * t1127 - t4034 / 0.8e1 - t4008 / 0.8e1 + t4012 - 0.3e1 / 0.8e1 * t5 * t268 * t2248 - t4041 / 0.8e1);
  tv4rho2sigma211 = t6 * t4044 + t2136 + t2253;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4052 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t691 * t1066 - t4020 / 0.4e1 + t3806);
  tv4rho2sigma212 = t6 * t4052 + 0.2e1 * t2142;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4070 = t953 * t953;
  t4114 = -0.11266083149260159801e-1 * t59 * t731 * t133 + 0.61889338352843641011e-2 * t1904 * t2159 - 0.11581088763630920848e-3 * t516 * t750 * t137 * t1586 + 0.5147150561613742599e-6 * t737 / t118 / t738 / t338 * t3098 + 0.93093776153132442719e-3 * t59 * t731 * t317 - 0.77376884737057184278e-6 * t530 * t750 * t753 * t137 + 0.1284964421503104458e-13 * t1920 * t1602 * t747 - 0.93400784729439905162e-19 * t1596 / t118 / t1597 / t338 * t3121;
  t4156 = t2198 * t28;
  t4160 = t1109 * t29;
  t4161 = t4160 * t58;
  t4166 = t1117 * t718;
  t4169 = t2220 * t301;
  t4182 = -0.58983793919244249171e-8 * t170 * t750 * t137 * t3137 - 0.487811050587815674e-1 * t4156 * t43 * t324 - 0.73992419488678004547e-3 * t4161 * t764 - 0.2585664e1 * t801 * t4070 - 0.1292832e1 * t4166 * t719 + 0.1292832e1 * t4169 * t321 + 0.646416e0 * t2222 * t757 + 0.646416e0 * t352 * t4114 + 0.646416e0 * t1657 * t1091 + 0.1292832e1 * t798 * t2177 + 0.1292832e1 * t3748 * t424;
  t4200 = 0.147875e0 * t33 * t1098 * t769 - 0.13219248178336256118e0 * t430 * t774 + 0.17592592592592592593e0 * t59 * t731 - 0.31195746527777777779e-1 * t88 * t117 * t780;
  t4245 = -0.2585664e1 * t801 * t2177 * t321 - 0.1292832e1 * t801 * t1091 * t757 + 0.7756992e1 * t3161 * t2233 - 0.5171328e1 * t1660 * t2236 + 0.3878496e1 * t1665 * t1071 * t757 - 0.5171328e1 * t3763 * t996 - 0.5171328e1 * t1989 * t1979 - 0.2585664e1 * t1989 * t1982 + 0.1036969162633548284e-5 * t442 * t740 * t1986 - 0.3888634359875806065e-6 * t344 * t939 * t2217 + 0.27868546245776610132e-5 * t1985 * t2217;
  t4248 = my_piecewise3(t151, -0.35146399257122052158e-2 * t59 * t731 * t153 + 0.27868546245776610132e-5 * t740 * sigma[2] * t153 - 0.58983793919244249171e-8 * t750 * t137 * t3137, 0.18292914397043087775e-1 * t3693 * t445 - 0.10405183990595344389e-3 * t3175 * t1114 + 0.11098862923301700682e-2 * t1643 * t2213 - 0.35146399257122052158e-2 * t792 * t58 * t731 * t153 - 0.975622101175631348e-1 * t1975 * t984 + 0.17886405188219908047e0 * t977 * t1969 + 0.15513984e2 * t1665 * t996 * t953 + 0.89432025941099540233e-1 * t2201 * t761 + 0.11098862923301700682e-2 * t3710 * t960 - 0.49944883154857653069e-2 * t1961 * t1931 + t4182 + 0.2585664e1 * t1996 * t953 + 0.1292832e1 * t991 * t1924 - 0.1292832e1 * t3158 * t1071 + t4200 * t150 - t4200 * t155 + 0.3878496e1 * t1665 * t1091 * t719 - 0.15513984e2 * t3141 * t1071 * t719 + 0.7756992e1 * t3766 * t1955 - 0.2585664e1 * t801 * t424 * t1924 - 0.2585664e1 * t1660 * t2241 + t4245);
  t4249 = my_piecewise3(t124, -0.15513984e2 * t3060 * t1071 * t719 + 0.15513984e2 * t1887 * t1979 + 0.3878496e1 * t2147 * t757 - 0.2585664e1 * t718 * t4070 - 0.2585664e1 * t925 * t1924 + 0.3878496e1 * t1556 * t1091 * t719 - 0.2585664e1 * t718 * t2177 * t321 - 0.1292832e1 * t2152 * t757 + 0.646416e0 * t301 * t4114, t4248);
  t4254 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t708 * t1127 - t4034 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t296 * t2248 + t4012 - t4041 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t116 * t4249);
  tv4rho2sigma217 = t6 * t4254 + 0.2e1 * t2253;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4261 = t5 * t195 * t2315 / 0.8e1;
  t4280 = t43 * sigma[0];
  t4301 = -0.10006060691777115613e-2 * t2032 * t53 + 0.32427048538166578375e-4 * t516 * t845 * t28 * t4280 * t53 - 0.19301814606051534747e-6 * t834 / t35 / t2416 * t2426 + 0.14584124871906066146e-6 * t530 * t2042 * sigma[0] - 0.38125318000641560843e-14 * t2047 * t1232 * t517 + 0.35025294273539964436e-19 * t1730 / t35 / t1227 / t90 * t2449;
  t4308 = t4280 * t76;
  t4312 = t2298 * t200;
  t4344 = 0.950625e-1 * t33 * t2280 * t227 - 0.13219248178336256118e-1 * t1037 * t232 + 0.20345052083333333334e-2 * t88 * t383 * t239;
  t4356 = 0.646416e0 * t4312 * t220 + 0.1939248e1 * t3967 * t377 + 0.1939248e1 * t2096 * t850 - 0.3878496e1 * t3461 * t1010 + 0.1939248e1 * t1806 * t1030 + 0.1939248e1 * t888 * t2051 - 0.58329515398137090974e-6 * t2090 * t76 + 0.3878496e1 * t2508 * t2255 + 0.646416e0 * t582 * t2274 + 0.646416e0 * t251 * t4301 + 0.72911894247671363718e-7 * t243 * t1017 * t76 + t4344 * t73 - t4344 * t78 - 0.3878496e1 * t1791 * t2115 - 0.15513984e2 * t2514 * t2255 * t220 + 0.11635488e2 * t1295 * t1010 * t850;
  t4392 = t2289 * t28;
  t4398 = -0.58329515398137090976e-6 * t395 * t836 * t2091 - 0.1292832e1 * t585 * t2274 * t220 - 0.3878496e1 * t3953 * t893 + 0.11635488e2 * t3446 * t2107 - 0.7756992e1 * t1791 * t2110 - 0.3878496e1 * t1290 * t2308 - 0.3878496e1 * t585 * t850 * t1030 - 0.3878496e1 * t585 * t377 * t2051 - 0.73171657588172351099e-1 * t2074 * t881 + 0.16648294384952551023e-2 * t1772 * t2087 + 0.11635488e2 * t1295 * t2308 * t220 + 0.27439371595564631662e-1 * t3907 * t398 - 0.31215551971786033168e-3 * t3388 * t1053 + 0.22118922719716593439e-8 * t96 * t845 * t28 * t4308 - 0.243905525293907837e-1 * t4392 * t43 * t223 + 0.83241471924762755114e-3 * t3895 * t857;
  t4400 = my_piecewise3(t74, -0.58329515398137090974e-6 * t836 * t76 + 0.22118922719716593439e-8 * t845 * t28 * t4308, t4356 + t4398);
  t4401 = my_piecewise3(t41, -0.15513984e2 * t2388 * t2255 * t220 + 0.11635488e2 * t2021 * t850 + 0.11635488e2 * t1699 * t2115 - 0.3878496e1 * t1702 * t1030 - 0.3878496e1 * t822 * t2051 - 0.1292832e1 * t497 * t2274 * t220 + 0.646416e0 * t200 * t4301, t4400);
  t4406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t189 * t2315 - t4261 - 0.3e1 / 0.8e1 * t5 * t27 * t4401);
  tv4rhosigma30 = t6 * t4406 + t2319;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t4413 = t5 * t272 * t2380 / 0.8e1;
  t4415 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t268 * t2380 - t4413);
  tv4rhosigma39 = t6 * t4415 + t2384;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t4421 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t285 * t2315 - t4261);
  tv4rhosigma310 = t6 * t4421 + t2319;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t4444 = t43 * sigma[2];
  t4465 = -0.10006060691777115613e-2 * t2158 * t133 + 0.32427048538166578375e-4 * t516 * t948 * t28 * t4444 * t133 - 0.19301814606051534747e-6 * t937 / t118 / t3088 * t3098 + 0.14584124871906066146e-6 * t530 * t2168 * sigma[2] - 0.38125318000641560843e-14 * t2173 * t1602 * t736 + 0.35025294273539964436e-19 * t1918 / t118 / t1597 / t164 * t3121;
  t4472 = t4444 * t153;
  t4487 = t2363 * t301;
  t4508 = 0.950625e-1 * t33 * t2345 * t328 - 0.13219248178336256118e-1 * t1098 * t333 + 0.20345052083333333334e-2 * t88 * t430 * t340;
  t4521 = -0.3878496e1 * t3763 * t1071 + 0.1939248e1 * t1996 * t1091 + 0.1939248e1 * t991 * t2177 + 0.3878496e1 * t3161 * t2320 + 0.72911894247671363718e-7 * t344 * t1078 * t153 + 0.646416e0 * t4487 * t321 + 0.1939248e1 * t4169 * t424 + 0.1939248e1 * t2222 * t953 - 0.58329515398137090974e-6 * t2216 * t153 + 0.646416e0 * t798 * t2339 + 0.646416e0 * t352 * t4465 + t4508 * t150 - t4508 * t155 - 0.15513984e2 * t3141 * t2320 * t321 + 0.11635488e2 * t1665 * t1071 * t953 - 0.58329515398137090976e-6 * t442 * t939 * t2217;
  t4552 = t2354 * t28;
  t4562 = -0.3878496e1 * t4166 * t996 + 0.11635488e2 * t3766 * t2233 - 0.7756992e1 * t1989 * t2236 - 0.3878496e1 * t1989 * t2241 - 0.3878496e1 * t801 * t953 * t1091 - 0.3878496e1 * t801 * t424 * t2177 - 0.1292832e1 * t801 * t2339 * t321 - 0.3878496e1 * t1660 * t2373 - 0.73171657588172351099e-1 * t2200 * t984 + 0.16648294384952551023e-2 * t1960 * t2213 + 0.11635488e2 * t1665 * t2373 * t321 + 0.27439371595564631662e-1 * t4156 * t445 - 0.31215551971786033168e-3 * t3709 * t1114 - 0.243905525293907837e-1 * t4552 * t43 * t324 + 0.83241471924762755114e-3 * t4161 * t960 + 0.22118922719716593439e-8 * t170 * t948 * t28 * t4472;
  t4564 = my_piecewise3(t151, -0.58329515398137090974e-6 * t939 * t153 + 0.22118922719716593439e-8 * t948 * t28 * t4472, t4521 + t4562);
  t4565 = my_piecewise3(t124, -0.15513984e2 * t3060 * t2320 * t321 + 0.11635488e2 * t2147 * t953 + 0.11635488e2 * t1887 * t2241 - 0.3878496e1 * t1890 * t1091 - 0.3878496e1 * t925 * t2177 - 0.1292832e1 * t718 * t2339 * t321 + 0.646416e0 * t301 * t4465, t4564);
  t4570 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t296 * t2380 - t4413 - 0.3e1 / 0.8e1 * t5 * t116 * t4565);
  tv4rhosigma319 = t6 * t4570 + t2384;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t4572 = t1010 * t1010;
  t4577 = t1030 * t1030;
  t4601 = -0.69486532581785525089e-5 * t516 * t1025 * t1216 + 0.723818047726932553e-7 * t1016 / t35 / t1212 * t2426 + 0.95313295001603902108e-15 * t2270 * t1232 * t60 - 0.13672617067411937012e-7 * t530 * t2266 - 0.13134485352577486664e-19 * t531 / t35 / t1227 / t62 * t2449;
  t4638 = 0.1782421875e0 * t33 / t34 / t517 * t37 - 0.49572180668760960442e-2 * t2280 * t82 + 0.152587890625e-3 * t88 * t1037 * t92;
  t4657 = -0.82945960198937225395e-9 * t96 * t1025 * t2465 - 0.3878496e1 * t585 * t4577 - 0.5171328e1 * t585 * t377 * t2274 + 0.15513984e2 * t3446 * t2255 - 0.15513984e2 * t1791 * t2308 - 0.15513984e2 * t2514 * t4572 + 0.23270976e2 * t1295 * t1010 * t1030 - 0.7756992e1 * t3953 * t1010 + t4638 * t73 - t4638 * t78 + 0.36585828794086175549e-1 * t4392 * t398 - 0.62431103943572066335e-3 * t3894 * t1053 + 0.646416e0 * t251 * t4601 + 0.2585664e1 * t4312 * t377 + 0.3878496e1 * t2096 * t1030 + 0.2585664e1 * t888 * t2274 + 0.29164757699068545488e-6 * t395 * t1017 * t76;
  t4658 = my_piecewise3(t74, -0.82945960198937225395e-9 * t1025 * t28 * t43 * t76, t4657);
  t4659 = my_piecewise3(t41, -0.15513984e2 * t2388 * t4572 + 0.23270976e2 * t2021 * t1030 - 0.3878496e1 * t497 * t4577 - 0.5171328e1 * t822 * t2274 + 0.646416e0 * t200 * t4601, t4658);
  t4663 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t4659);
  tv4sigma40 = t6 * t4663;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t4664 = t1071 * t1071;
  t4669 = t1091 * t1091;
  t4693 = -0.69486532581785525089e-5 * t516 * t1086 * t1586 + 0.723818047726932553e-7 * t1077 / t118 / t1582 * t3098 + 0.95313295001603902108e-15 * t2335 * t1602 * t137 - 0.13672617067411937012e-7 * t530 * t2331 - 0.13134485352577486664e-19 * t747 / t118 / t1597 / t139 * t3121;
  t4727 = 0.1782421875e0 * t33 / t117 / t736 * t120 - 0.49572180668760960442e-2 * t2345 * t159 + 0.152587890625e-3 * t88 * t1098 * t166;
  t4749 = 0.23270976e2 * t1665 * t1071 * t1091 - 0.3878496e1 * t801 * t4669 - 0.5171328e1 * t801 * t424 * t2339 + 0.15513984e2 * t3766 * t2320 - 0.15513984e2 * t1989 * t2373 - 0.15513984e2 * t3141 * t4664 - 0.7756992e1 * t4166 * t1071 + t4727 * t150 - t4727 * t155 + 0.36585828794086175549e-1 * t4552 * t445 - 0.62431103943572066335e-3 * t4160 * t1114 - 0.82945960198937225395e-9 * t170 * t1086 * t3137 + 0.646416e0 * t352 * t4693 + 0.29164757699068545488e-6 * t442 * t1078 * t153 + 0.2585664e1 * t4487 * t424 + 0.3878496e1 * t2222 * t1091 + 0.2585664e1 * t991 * t2339;
  t4750 = my_piecewise3(t151, -0.82945960198937225395e-9 * t1086 * t28 * t43 * t153, t4749);
  t4751 = my_piecewise3(t124, -0.15513984e2 * t3060 * t4664 + 0.23270976e2 * t2147 * t1091 - 0.3878496e1 * t718 * t4669 - 0.5171328e1 * t925 * t2339 + 0.646416e0 * t301 * t4693, t4750);
  t4755 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t116 * t4751);
  tv4sigma414 = t6 * t4755;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

#endif

#endif

#endif

#endif


}

