/* 
  This file was generated automatically with ../scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  Maple source      : ../maple/lda_c_2d_amgb.mpl
  Type of functional: work_lda
*/

static void
func0(const XC(func_type) *p, XC(lda_work_t) *r)
{
  double t2, t4, t6, t8, t12, t15, t16, t20;
  double t22, t23, t24, t25, t29, t30, t31, t35;
  double t37, t41, t42, t43, t44, t47, t50, t51;
  double t54, t55, t56, t57, t58, t59, t74, t87;


  t2 = r->rss * r->rss;
  t4 = t2 * r->rss;
  t6 = 0.863136e-1 * r->rss + 0.572384e-1 * t2 + 0.3362975e-2 * t4;
  t8 = pow(r->rss, 0.15e1);
  t12 = 0.10022e1 * r->rss - 0.2069e-1 * t8 + 0.33997e0 * t2 + 0.1747e-1 * t4;
  t15 = 0.10e1 + 0.10e1 / t12;
  t16 = log(t15);
  r->zk = -0.1925e0 + t6 * t16;

  if(r->order < 1) return;

  t20 = 0.863136e-1 + 0.1144768e0 * r->rss + 0.10088925e-1 * t2;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t6 * t23;
  t25 = pow(r->rss, 0.5e0);
  t29 = 0.10022e1 - 0.31035e-1 * t25 + 0.67994e0 * r->rss + 0.5241e-1 * t2;
  t30 = 0.1e1 / t15;
  t31 = t29 * t30;
  r->dedrs = t20 * t16 - 0.10e1 * t24 * t31;
  r->dedz = 0;

  if(r->order < 2) return;

  t35 = 0.1144768e0 + 0.20177850e-1 * r->rss;
  t37 = t20 * t23;
  t41 = 0.1e1 / t22 / t12;
  t42 = t6 * t41;
  t43 = t29 * t29;
  t44 = t43 * t30;
  t47 = pow(r->rss, -0.5e0);
  t50 = -0.155175e-1 * t47 + 0.67994e0 + 0.10482e0 * r->rss;
  t51 = t50 * t30;
  t54 = t22 * t22;
  t55 = 0.1e1 / t54;
  t56 = t6 * t55;
  t57 = t15 * t15;
  t58 = 0.1e1 / t57;
  t59 = t43 * t58;
  r->d2edrs2 = t35 * t16 - 0.20e1 * t37 * t31 + 0.20e1 * t42 * t44 - 0.10e1 * t24 * t51 - 0.100e1 * t56 * t59;
  r->d2edz2 = 0;
  r->d2edrsz = 0;

  if(r->order < 3) return;

  t74 = t43 * t29;
  t87 = pow(r->rss, -0.15e1);
  r->d3edrs3 = 0.20177850e-1 * t16 - 0.30e1 * t35 * t23 * t31 + 0.60e1 * t20 * t41 * t44 - 0.30e1 * t37 * t51 - 0.300e1 * t20 * t55 * t59 - 0.60e1 * t56 * t74 * t30 + 0.60e1 * t42 * t31 * t50 + 0.600e1 * t6 / t54 / t12 * t74 * t58 - 0.10e1 * t24 * (0.775875e-2 * t87 + 0.10482e0) * t30 - 0.300e1 * t56 * t50 * t58 * t29 - 0.2000e1 * t6 / t54 / t22 * t74 / t57 / t15;
  r->d3edz3 = 0;
  r->d3edrs2z = 0;
  r->d3edrsz2 = 0;

  if(r->order < 4) return;


}

static void
func1(const XC(func_type) *p, XC(lda_work_t) *r)
{
  double t2, t4, t6, t8, t12, t15, t16, t21;
  double t25, t28, t29, t30, t31, t32, t37, t40;
  double t43, t44, t46, t47, t50, t52, t53, t54;
  double t55, t56, t58, t59, t63, t64, t69, t71;
  double t72, t73, t74, t78, t79, t80, t85, t86;
  double t87, t88, t89, t92, t93, t94, t95, t97;
  double t101, t103, t104, t105, t107, t108, t109, t112;
  double t114, t115, t117, t118, t123, t126, t128, t132;
  double t133, t137, t139, t143, t144, t145, t146, t149;
  double t152, t153, t156, t157, t158, t159, t160, t161;
  double t165, t167, t171, t172, t173, t174, t178, t179;
  double t182, t183, t184, t185, t186, t187, t190, t193;
  double t195, t199, t200, t201, t202, t205, t208, t209;
  double t210, t211, t212, t213, t216, t219, t221, t222;
  double t228, t230, t233, t234, t241, t243, t258, t285;
  double t299, t326, t332, t345, t365, t382, t384;


  t2 = r->rss * r->rss;
  t4 = t2 * r->rss;
  t6 = 0.863136e-1 * r->rss + 0.572384e-1 * t2 + 0.3362975e-2 * t4;
  t8 = pow(r->rss, 0.15e1);
  t12 = 0.10022e1 * r->rss - 0.2069e-1 * t8 + 0.33997e0 * t2 + 0.1747e-1 * t4;
  t15 = 0.10e1 + 0.10e1 / t12;
  t16 = log(t15);
  t21 = -0.3394e-1 * r->rss - 0.766765e-2 * t2 - 0.915064469e-4 * t4;
  t25 = 0.4133e0 * r->rss + 0.668467e-1 * t2 + 0.7799e-3 * t4;
  t28 = 0.10e1 + 0.10e1 / t25;
  t29 = log(t28);
  t30 = t21 * t29;
  t31 = 0.117331e0 + t30;
  t32 = r->zeta * r->zeta;
  t37 = -0.37093e-1 * r->rss + 0.163618e-1 * t2 - 0.272383828612e-1 * t4;
  t40 = 0.1424301e1 * r->rss + 0.1163099e1 * t4;
  t43 = 0.10e1 + 0.10e1 / t40;
  t44 = log(t43);
  t46 = 0.234188e-1 + t37 * t44;
  t47 = t32 * t32;
  t50 = exp(-0.13386e1 * r->rss);
  t52 = sqrt(0.2e1);
  t53 = (t50 - 0.10e1) * t52;
  t54 = 0.1e1 / r->rss;
  t55 = 0.10e1 + r->zeta;
  t56 = pow(t55, 0.15e1);
  t58 = 0.10e1 - r->zeta;
  t59 = pow(t58, 0.15e1);
  t63 = 0.5e0 * t56 + 0.5e0 * t59 - 0.10e1 - 0.37500000000000000000e0 * t32 - 0.23437500000000000000e-1 * t47;
  t64 = t54 * t63;
  r->zk = -0.1925e0 + t6 * t16 + t31 * t32 + t46 * t47 - 0.42441318157838756205e0 * t53 * t64;

  if(r->order < 1) return;

  t69 = 0.863136e-1 + 0.1144768e0 * r->rss + 0.10088925e-1 * t2;
  t71 = t12 * t12;
  t72 = 0.1e1 / t71;
  t73 = t6 * t72;
  t74 = pow(r->rss, 0.5e0);
  t78 = 0.10022e1 - 0.31035e-1 * t74 + 0.67994e0 * r->rss + 0.5241e-1 * t2;
  t79 = 0.1e1 / t15;
  t80 = t78 * t79;
  t85 = -0.3394e-1 - 0.1533530e-1 * r->rss - 0.2745193407e-3 * t2;
  t86 = t85 * t29;
  t87 = t25 * t25;
  t88 = 0.1e1 / t87;
  t89 = t21 * t88;
  t92 = 0.4133e0 + 0.1336934e0 * r->rss + 0.23397e-2 * t2;
  t93 = 0.1e1 / t28;
  t94 = t92 * t93;
  t95 = t89 * t94;
  t97 = t86 - 0.10e1 * t95;
  t101 = -0.37093e-1 + 0.327236e-1 * r->rss - 0.817151485836e-1 * t2;
  t103 = t40 * t40;
  t104 = 0.1e1 / t103;
  t105 = t37 * t104;
  t107 = 0.1424301e1 + 0.3489297e1 * t2;
  t108 = 0.1e1 / t43;
  t109 = t107 * t108;
  t112 = t101 * t44 - 0.10e1 * t105 * t109;
  t114 = t50 * t52;
  t115 = t114 * t64;
  t117 = 0.1e1 / t2;
  t118 = t117 * t63;
  r->dedrs = t69 * t16 - 0.10e1 * t73 * t80 + t97 * t32 + t112 * t47 + 0.56811948486082959056e0 * t115 + 0.42441318157838756205e0 * t53 * t118;
  t123 = t32 * r->zeta;
  t126 = pow(t55, 0.5e0);
  t128 = pow(t58, 0.5e0);
  t132 = 0.75e0 * t126 - 0.75e0 * t128 - 0.75000000000000000000e0 * r->zeta - 0.93750000000000000000e-1 * t123;
  t133 = t54 * t132;
  r->dedz = 0.2e1 * t31 * r->zeta + 0.4e1 * t46 * t123 - 0.42441318157838756205e0 * t53 * t133;

  if(r->order < 2) return;

  t137 = 0.1144768e0 + 0.20177850e-1 * r->rss;
  t139 = t69 * t72;
  t143 = 0.1e1 / t71 / t12;
  t144 = t6 * t143;
  t145 = t78 * t78;
  t146 = t145 * t79;
  t149 = pow(r->rss, -0.5e0);
  t152 = -0.155175e-1 * t149 + 0.67994e0 + 0.10482e0 * r->rss;
  t153 = t152 * t79;
  t156 = t71 * t71;
  t157 = 0.1e1 / t156;
  t158 = t6 * t157;
  t159 = t15 * t15;
  t160 = 0.1e1 / t159;
  t161 = t145 * t160;
  t165 = -0.1533530e-1 - 0.5490386814e-3 * r->rss;
  t167 = t85 * t88;
  t171 = 0.1e1 / t87 / t25;
  t172 = t21 * t171;
  t173 = t92 * t92;
  t174 = t173 * t93;
  t178 = 0.1336934e0 + 0.46794e-2 * r->rss;
  t179 = t178 * t93;
  t182 = t87 * t87;
  t183 = 0.1e1 / t182;
  t184 = t21 * t183;
  t185 = t28 * t28;
  t186 = 0.1e1 / t185;
  t187 = t173 * t186;
  t190 = t165 * t29 - 0.20e1 * t167 * t94 + 0.20e1 * t172 * t174 - 0.10e1 * t89 * t179 - 0.100e1 * t184 * t187;
  t193 = 0.327236e-1 - 0.1634302971672e0 * r->rss;
  t195 = t101 * t104;
  t199 = 0.1e1 / t103 / t40;
  t200 = t37 * t199;
  t201 = t107 * t107;
  t202 = t201 * t108;
  t205 = r->rss * t108;
  t208 = t103 * t103;
  t209 = 0.1e1 / t208;
  t210 = t37 * t209;
  t211 = t43 * t43;
  t212 = 0.1e1 / t211;
  t213 = t201 * t212;
  t216 = t193 * t44 - 0.20e1 * t195 * t109 + 0.20e1 * t200 * t202 - 0.69785940e1 * t105 * t205 - 0.100e1 * t210 * t213;
  t219 = t114 * t118;
  t221 = 0.1e1 / t4;
  t222 = t221 * t63;
  r->d2edrs2 = t137 * t16 - 0.20e1 * t139 * t80 + 0.20e1 * t144 * t146 - 0.10e1 * t73 * t153 - 0.100e1 * t158 * t161 + t190 * t32 + t216 * t47 - 0.76048474243470648992e0 * t115 - 0.11362389697216591811e1 * t219 - 0.84882636315677512410e0 * t53 * t222;
  t228 = pow(t55, -0.5e0);
  t230 = pow(t58, -0.5e0);
  t233 = 0.375e0 * t228 + 0.375e0 * t230 - 0.75000000000000000000e0 - 0.28125000000000000000e0 * t32;
  t234 = t54 * t233;
  r->d2edz2 = 0.234662e0 + 0.2e1 * t30 + 0.12e2 * t46 * t32 - 0.42441318157838756205e0 * t53 * t234;
  t241 = t114 * t133;
  t243 = t117 * t132;
  r->d2edrsz = 0.2e1 * t97 * r->zeta + 0.4e1 * t112 * t123 + 0.56811948486082959056e0 * t241 + 0.42441318157838756205e0 * t53 * t243;

  if(r->order < 3) return;

  t258 = t173 * t92;
  t285 = -0.5490386814e-3 * t29 - 0.30e1 * t165 * t88 * t94 + 0.60e1 * t85 * t171 * t174 - 0.30e1 * t167 * t179 - 0.300e1 * t85 * t183 * t187 - 0.60e1 * t184 * t258 * t93 + 0.60e1 * t172 * t94 * t178 + 0.600e1 * t21 / t182 / t25 * t258 * t186 - 0.467940e-2 * t89 * t93 - 0.300e1 * t184 * t178 * t186 * t92 - 0.2000e1 * t21 / t182 / t87 * t258 / t185 / t28;
  t299 = t201 * t107;
  t326 = -0.1634302971672e0 * t44 - 0.30e1 * t193 * t104 * t109 + 0.60e1 * t101 * t199 * t202 - 0.209357820e2 * t195 * t205 - 0.300e1 * t101 * t209 * t213 - 0.60e1 * t210 * t299 * t108 + 0.418715640e2 * t200 * t109 * r->rss + 0.600e1 * t37 / t208 / t40 * t299 * t212 - 0.69785940e1 * t105 * t108 - 0.2093578200e2 * t210 * r->rss * t212 * t107 - 0.2000e1 * t37 / t208 / t103 * t299 / t211 / t43;
  t332 = t145 * t78;
  t345 = t2 * t2;
  t365 = pow(r->rss, -0.15e1);
  r->d3edrs3 = t285 * t32 + t326 * t47 + 0.22814542273041194697e1 * t219 + 0.60e1 * t69 * t143 * t146 - 0.60e1 * t158 * t332 * t79 + 0.60e1 * t144 * t80 * t152 - 0.300e1 * t158 * t152 * t160 * t78 + 0.34087169091649775433e1 * t114 * t222 + 0.25464790894703253723e1 * t53 / t345 * t63 + 0.10179848762230981074e1 * t115 - 0.30e1 * t137 * t72 * t80 - 0.30e1 * t139 * t153 - 0.300e1 * t69 * t157 * t161 + 0.600e1 * t6 / t156 / t12 * t332 * t160 - 0.10e1 * t73 * (0.775875e-2 * t365 + 0.10482e0) * t79 - 0.2000e1 * t6 / t156 / t71 * t332 / t159 / t15 + 0.20177850e-1 * t16;
  t382 = pow(t55, -0.15e1);
  t384 = pow(t58, -0.15e1);
  r->d3edz3 = 0.24e2 * t46 * r->zeta - 0.42441318157838756205e0 * t53 * t54 * (-0.1875e0 * t382 + 0.1875e0 * t384 - 0.56250000000000000000e0 * r->zeta);
  r->d3edrs2z = 0.2e1 * t190 * r->zeta + 0.4e1 * t216 * t123 - 0.76048474243470648992e0 * t241 - 0.11362389697216591811e1 * t114 * t243 - 0.84882636315677512410e0 * t53 * t221 * t132;
  r->d3edrsz2 = 0.2e1 * t86 - 0.20e1 * t95 + 0.12e2 * t112 * t32 + 0.56811948486082959056e0 * t114 * t234 + 0.42441318157838756205e0 * t53 * t117 * t233;

  if(r->order < 4) return;


}

void 
XC(lda_c_2d_amgb_func)(const XC(func_type) *p, XC(lda_work_t) *r)
{
  if(p->nspin == XC_UNPOLARIZED)
    func0(p, r);
  else
    func1(p, r);
}

#define maple2c_order 3
#define maple2c_func  XC(lda_c_2d_amgb_func)
