/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2020 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_kt.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t11, t13, t15, t17, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t47, t51, tzk0;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->gamma * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t11 * rho[0];
  t30 = POW_1_3(t29);
  t31 = t30 * t29;
  t32 = t28 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = sigma[0] * t36;
  t38 = t28 * t28;
  t41 = t38 * t31 / 0.4e1 + params->delta;
  t42 = 0.1e1 / t41;
  t47 = 0.1e1 - t27 * t32 * t37 * t42 / 0.9e1;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t11, t13, t15, t17, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t47, t51, tzk0;

  double t52, t53, t58, t59, t60, t65, t67, t73;
  double t74, t75, t76, t77, t78, t83, t88, tvrho0;
  double t91, t94, t95, t97, t100, tvsigma0;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->gamma * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t11 * rho[0];
  t30 = POW_1_3(t29);
  t31 = t30 * t29;
  t32 = t28 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = sigma[0] * t36;
  t38 = t28 * t28;
  t41 = t38 * t31 / 0.4e1 + params->delta;
  t42 = 0.1e1 / t41;
  t47 = 0.1e1 - t27 * t32 * t37 * t42 / 0.9e1;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t52 = 0.1e1 / t34;
  t53 = t17 * t52;
  t58 = t21 * t26 * t28;
  t59 = t30 * sigma[0];
  t60 = t36 * t42;
  t65 = t33 * rho[0];
  t67 = 0.1e1 / t34 / t65;
  t73 = t30 * t30;
  t74 = t73 * t29;
  t75 = t74 * sigma[0];
  t76 = t41 * t41;
  t77 = 0.1e1 / t76;
  t78 = t36 * t77;
  t83 = -0.4e1 / 0.27e2 * t58 * t59 * t60 * t11 + 0.8e1 / 0.27e2 * t27 * t32 * sigma[0] * t67 * t42 + 0.2e1 / 0.27e2 * t27 * t75 * t78 * t11;
  t88 = my_piecewise3(t2, 0, -t6 * t53 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t91 = t5 * t17;
  t94 = 0.1e1 / t18 / t33 * params->gamma;
  t95 = t91 * t94;
  t97 = t26 * t32 * t42;
  t100 = my_piecewise3(t2, 0, t95 * t97 / 0.8e1);
  tvsigma0 = 0.2e1 * rho[0] * t100;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t11, t13, t15, t17, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t47, t51, tzk0;

  double t52, t53, t58, t59, t60, t65, t67, t73;
  double t74, t75, t76, t77, t78, t83, t88, tvrho0;
  double t91, t94, t95, t97, t100, tvsigma0;

  double t104, t105, t112, t113, t114, t119, t124, t129;
  double t131, t137, t142, t145, t147, t151, t156, tv2rho20;
  double t161, t162, t166, t167, t170, t175, t179, tv2rhosigma0;
  double tv2sigma20;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->gamma * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t11 * rho[0];
  t30 = POW_1_3(t29);
  t31 = t30 * t29;
  t32 = t28 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = sigma[0] * t36;
  t38 = t28 * t28;
  t41 = t38 * t31 / 0.4e1 + params->delta;
  t42 = 0.1e1 / t41;
  t47 = 0.1e1 - t27 * t32 * t37 * t42 / 0.9e1;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t52 = 0.1e1 / t34;
  t53 = t17 * t52;
  t58 = t21 * t26 * t28;
  t59 = t30 * sigma[0];
  t60 = t36 * t42;
  t65 = t33 * rho[0];
  t67 = 0.1e1 / t34 / t65;
  t73 = t30 * t30;
  t74 = t73 * t29;
  t75 = t74 * sigma[0];
  t76 = t41 * t41;
  t77 = 0.1e1 / t76;
  t78 = t36 * t77;
  t83 = -0.4e1 / 0.27e2 * t58 * t59 * t60 * t11 + 0.8e1 / 0.27e2 * t27 * t32 * sigma[0] * t67 * t42 + 0.2e1 / 0.27e2 * t27 * t75 * t78 * t11;
  t88 = my_piecewise3(t2, 0, -t6 * t53 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t91 = t5 * t17;
  t94 = 0.1e1 / t18 / t33 * params->gamma;
  t95 = t91 * t94;
  t97 = t26 * t32 * t42;
  t100 = my_piecewise3(t2, 0, t95 * t97 / 0.8e1);
  tvsigma0 = 0.2e1 * rho[0] * t100;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t104 = 0.1e1 / t34 / rho[0];
  t105 = t17 * t104;
  t112 = 0.1e1 / t73;
  t113 = t112 * sigma[0];
  t114 = t11 * t11;
  t119 = t67 * t42;
  t124 = t73 * sigma[0];
  t129 = t33 * t33;
  t131 = 0.1e1 / t34 / t129;
  t137 = t67 * t77;
  t142 = t114 * t114;
  t145 = 0.1e1 / t76 / t41;
  t147 = sigma[0] * t145 * t38;
  t151 = -0.4e1 / 0.81e2 * t58 * t113 * t60 * t114 + 0.64e2 / 0.81e2 * t58 * t59 * t119 * t11 + 0.2e1 / 0.9e1 * t27 * t124 * t78 * t114 - 0.88e2 / 0.81e2 * t27 * t32 * sigma[0] * t131 * t42 - 0.32e2 / 0.81e2 * t27 * t75 * t137 * t11 - 0.4e1 / 0.81e2 * t27 * t142 * t52 * t147;
  t156 = my_piecewise3(t2, 0, t6 * t105 * t47 / 0.12e2 - t6 * t53 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t151);
  tv2rho20 = 0.2e1 * rho[0] * t156 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t161 = 0.1e1 / t18 / t65 * params->gamma;
  t162 = t91 * t161;
  t166 = t91 * t94 * t24;
  t167 = t25 * t28;
  t170 = t167 * t30 * t42 * t11;
  t175 = t26 * t74 * t77 * t11;
  t179 = my_piecewise3(t2, 0, -0.7e1 / 0.24e2 * t162 * t97 + t166 * t170 / 0.6e1 - t95 * t175 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t179 + 0.2e1 * t100;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t11, t13, t15, t17, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t47, t51, tzk0;

  double t52, t53, t58, t59, t60, t65, t67, t73;
  double t74, t75, t76, t77, t78, t83, t88, tvrho0;
  double t91, t94, t95, t97, t100, tvsigma0;

  double t104, t105, t112, t113, t114, t119, t124, t129;
  double t131, t137, t142, t145, t147, t151, t156, tv2rho20;
  double t161, t162, t166, t167, t170, t175, t179, tv2rhosigma0;
  double tv2sigma20;

  double t183, t193, t194, t195, t204, t205, t210, t223;
  double t225, t231, t236, t238, t239, t240, t242, t243;
  double t247, t252, tv3rho30, t258, t259, t263, t270, t275;
  double t279, t282, t283, t287, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->gamma * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t11 * rho[0];
  t30 = POW_1_3(t29);
  t31 = t30 * t29;
  t32 = t28 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = sigma[0] * t36;
  t38 = t28 * t28;
  t41 = t38 * t31 / 0.4e1 + params->delta;
  t42 = 0.1e1 / t41;
  t47 = 0.1e1 - t27 * t32 * t37 * t42 / 0.9e1;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t52 = 0.1e1 / t34;
  t53 = t17 * t52;
  t58 = t21 * t26 * t28;
  t59 = t30 * sigma[0];
  t60 = t36 * t42;
  t65 = t33 * rho[0];
  t67 = 0.1e1 / t34 / t65;
  t73 = t30 * t30;
  t74 = t73 * t29;
  t75 = t74 * sigma[0];
  t76 = t41 * t41;
  t77 = 0.1e1 / t76;
  t78 = t36 * t77;
  t83 = -0.4e1 / 0.27e2 * t58 * t59 * t60 * t11 + 0.8e1 / 0.27e2 * t27 * t32 * sigma[0] * t67 * t42 + 0.2e1 / 0.27e2 * t27 * t75 * t78 * t11;
  t88 = my_piecewise3(t2, 0, -t6 * t53 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t91 = t5 * t17;
  t94 = 0.1e1 / t18 / t33 * params->gamma;
  t95 = t91 * t94;
  t97 = t26 * t32 * t42;
  t100 = my_piecewise3(t2, 0, t95 * t97 / 0.8e1);
  tvsigma0 = 0.2e1 * rho[0] * t100;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t104 = 0.1e1 / t34 / rho[0];
  t105 = t17 * t104;
  t112 = 0.1e1 / t73;
  t113 = t112 * sigma[0];
  t114 = t11 * t11;
  t119 = t67 * t42;
  t124 = t73 * sigma[0];
  t129 = t33 * t33;
  t131 = 0.1e1 / t34 / t129;
  t137 = t67 * t77;
  t142 = t114 * t114;
  t145 = 0.1e1 / t76 / t41;
  t147 = sigma[0] * t145 * t38;
  t151 = -0.4e1 / 0.81e2 * t58 * t113 * t60 * t114 + 0.64e2 / 0.81e2 * t58 * t59 * t119 * t11 + 0.2e1 / 0.9e1 * t27 * t124 * t78 * t114 - 0.88e2 / 0.81e2 * t27 * t32 * sigma[0] * t131 * t42 - 0.32e2 / 0.81e2 * t27 * t75 * t137 * t11 - 0.4e1 / 0.81e2 * t27 * t142 * t52 * t147;
  t156 = my_piecewise3(t2, 0, t6 * t105 * t47 / 0.12e2 - t6 * t53 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t151);
  tv2rho20 = 0.2e1 * rho[0] * t156 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t161 = 0.1e1 / t18 / t65 * params->gamma;
  t162 = t91 * t161;
  t166 = t91 * t94 * t24;
  t167 = t25 * t28;
  t170 = t167 * t30 * t42 * t11;
  t175 = t26 * t74 * t77 * t11;
  t179 = my_piecewise3(t2, 0, -0.7e1 / 0.24e2 * t162 * t97 + t166 * t170 / 0.6e1 - t95 * t175 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t179 + 0.2e1 * t100;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t183 = t17 * t36;
  t193 = 0.1e1 / t74;
  t194 = t193 * sigma[0];
  t195 = t114 * t11;
  t204 = 0.1e1 / t30;
  t205 = t204 * sigma[0];
  t210 = t131 * t42;
  t223 = t129 * rho[0];
  t225 = 0.1e1 / t34 / t223;
  t231 = t131 * t77;
  t236 = t142 * t11;
  t238 = t21 * t26 * t236;
  t239 = t52 * sigma[0];
  t240 = t76 * t76;
  t242 = 0.1e1 / t240 * t28;
  t243 = t242 * t30;
  t247 = 0.8e1 / 0.243e3 * t58 * t194 * t60 * t195 + 0.32e2 / 0.81e2 * t58 * t113 * t119 * t114 + 0.44e2 / 0.243e3 * t27 * t205 * t78 * t195 - 0.352e3 / 0.81e2 * t58 * t59 * t210 * t11 - 0.16e2 / 0.9e1 * t27 * t124 * t137 * t114 + 0.4e1 / 0.27e2 * t27 * t142 * t104 * t147 + 0.1232e4 / 0.243e3 * t27 * t32 * sigma[0] * t225 * t42 + 0.176e3 / 0.81e2 * t27 * t75 * t231 * t11 + 0.8e1 / 0.81e2 * t238 * t239 * t243;
  t252 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t183 * t47 + t6 * t105 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t53 * t151 - 0.3e1 / 0.8e1 * t6 * t19 * t247);
  tv3rho30 = 0.2e1 * rho[0] * t252 + 0.6e1 * t156;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t258 = 0.1e1 / t18 / t129 * params->gamma;
  t259 = t91 * t258;
  t263 = t91 * t161 * t24;
  t270 = t167 * t112 * t42 * t114;
  t275 = t26 * t73 * t77 * t114;
  t279 = 0.1e1 / t18 * params->gamma;
  t282 = t142 * t145 * t38;
  t283 = t26 * t282;
  t287 = my_piecewise3(t2, 0, 0.35e2 / 0.36e2 * t259 * t97 - 0.7e1 / 0.9e1 * t263 * t170 + 0.7e1 / 0.18e2 * t162 * t175 + t166 * t270 / 0.18e2 - t95 * t275 / 0.4e1 + t91 * t279 * t283 / 0.18e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t179;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t11, t13, t15, t17, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t47, t51, tzk0;

  double t52, t53, t58, t59, t60, t65, t67, t73;
  double t74, t75, t76, t77, t78, t83, t88, tvrho0;
  double t91, t94, t95, t97, t100, tvsigma0;

  double t104, t105, t112, t113, t114, t119, t124, t129;
  double t131, t137, t142, t145, t147, t151, t156, tv2rho20;
  double t161, t162, t166, t167, t170, t175, t179, tv2rhosigma0;
  double tv2sigma20;

  double t183, t193, t194, t195, t204, t205, t210, t223;
  double t225, t231, t236, t238, t239, t240, t242, t243;
  double t247, t252, tv3rho30, t258, t259, t263, t270, t275;
  double t279, t282, t283, t287, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;

  double t316, t374, t379, tv4rho40, t422, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30;
  double tv4sigma40;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->gamma * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t11 * rho[0];
  t30 = POW_1_3(t29);
  t31 = t30 * t29;
  t32 = t28 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = sigma[0] * t36;
  t38 = t28 * t28;
  t41 = t38 * t31 / 0.4e1 + params->delta;
  t42 = 0.1e1 / t41;
  t47 = 0.1e1 - t27 * t32 * t37 * t42 / 0.9e1;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t52 = 0.1e1 / t34;
  t53 = t17 * t52;
  t58 = t21 * t26 * t28;
  t59 = t30 * sigma[0];
  t60 = t36 * t42;
  t65 = t33 * rho[0];
  t67 = 0.1e1 / t34 / t65;
  t73 = t30 * t30;
  t74 = t73 * t29;
  t75 = t74 * sigma[0];
  t76 = t41 * t41;
  t77 = 0.1e1 / t76;
  t78 = t36 * t77;
  t83 = -0.4e1 / 0.27e2 * t58 * t59 * t60 * t11 + 0.8e1 / 0.27e2 * t27 * t32 * sigma[0] * t67 * t42 + 0.2e1 / 0.27e2 * t27 * t75 * t78 * t11;
  t88 = my_piecewise3(t2, 0, -t6 * t53 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t91 = t5 * t17;
  t94 = 0.1e1 / t18 / t33 * params->gamma;
  t95 = t91 * t94;
  t97 = t26 * t32 * t42;
  t100 = my_piecewise3(t2, 0, t95 * t97 / 0.8e1);
  tvsigma0 = 0.2e1 * rho[0] * t100;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  t104 = 0.1e1 / t34 / rho[0];
  t105 = t17 * t104;
  t112 = 0.1e1 / t73;
  t113 = t112 * sigma[0];
  t114 = t11 * t11;
  t119 = t67 * t42;
  t124 = t73 * sigma[0];
  t129 = t33 * t33;
  t131 = 0.1e1 / t34 / t129;
  t137 = t67 * t77;
  t142 = t114 * t114;
  t145 = 0.1e1 / t76 / t41;
  t147 = sigma[0] * t145 * t38;
  t151 = -0.4e1 / 0.81e2 * t58 * t113 * t60 * t114 + 0.64e2 / 0.81e2 * t58 * t59 * t119 * t11 + 0.2e1 / 0.9e1 * t27 * t124 * t78 * t114 - 0.88e2 / 0.81e2 * t27 * t32 * sigma[0] * t131 * t42 - 0.32e2 / 0.81e2 * t27 * t75 * t137 * t11 - 0.4e1 / 0.81e2 * t27 * t142 * t52 * t147;
  t156 = my_piecewise3(t2, 0, t6 * t105 * t47 / 0.12e2 - t6 * t53 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t151);
  tv2rho20 = 0.2e1 * rho[0] * t156 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t161 = 0.1e1 / t18 / t65 * params->gamma;
  t162 = t91 * t161;
  t166 = t91 * t94 * t24;
  t167 = t25 * t28;
  t170 = t167 * t30 * t42 * t11;
  t175 = t26 * t74 * t77 * t11;
  t179 = my_piecewise3(t2, 0, -0.7e1 / 0.24e2 * t162 * t97 + t166 * t170 / 0.6e1 - t95 * t175 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t179 + 0.2e1 * t100;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  t183 = t17 * t36;
  t193 = 0.1e1 / t74;
  t194 = t193 * sigma[0];
  t195 = t114 * t11;
  t204 = 0.1e1 / t30;
  t205 = t204 * sigma[0];
  t210 = t131 * t42;
  t223 = t129 * rho[0];
  t225 = 0.1e1 / t34 / t223;
  t231 = t131 * t77;
  t236 = t142 * t11;
  t238 = t21 * t26 * t236;
  t239 = t52 * sigma[0];
  t240 = t76 * t76;
  t242 = 0.1e1 / t240 * t28;
  t243 = t242 * t30;
  t247 = 0.8e1 / 0.243e3 * t58 * t194 * t60 * t195 + 0.32e2 / 0.81e2 * t58 * t113 * t119 * t114 + 0.44e2 / 0.243e3 * t27 * t205 * t78 * t195 - 0.352e3 / 0.81e2 * t58 * t59 * t210 * t11 - 0.16e2 / 0.9e1 * t27 * t124 * t137 * t114 + 0.4e1 / 0.27e2 * t27 * t142 * t104 * t147 + 0.1232e4 / 0.243e3 * t27 * t32 * sigma[0] * t225 * t42 + 0.176e3 / 0.81e2 * t27 * t75 * t231 * t11 + 0.8e1 / 0.81e2 * t238 * t239 * t243;
  t252 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t183 * t47 + t6 * t105 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t53 * t151 - 0.3e1 / 0.8e1 * t6 * t19 * t247);
  tv3rho30 = 0.2e1 * rho[0] * t252 + 0.6e1 * t156;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t258 = 0.1e1 / t18 / t129 * params->gamma;
  t259 = t91 * t258;
  t263 = t91 * t161 * t24;
  t270 = t167 * t112 * t42 * t114;
  t275 = t26 * t73 * t77 * t114;
  t279 = 0.1e1 / t18 * params->gamma;
  t282 = t142 * t145 * t38;
  t283 = t26 * t282;
  t287 = my_piecewise3(t2, 0, 0.35e2 / 0.36e2 * t259 * t97 - 0.7e1 / 0.9e1 * t263 * t170 + 0.7e1 / 0.18e2 * t162 * t175 + t166 * t270 / 0.18e2 - t95 * t275 / 0.4e1 + t91 * t279 * t283 / 0.18e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t179;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  t316 = t142 * t114;
  t374 = -0.20944e5 / 0.729e3 * t27 * t32 * sigma[0] / t34 / t129 / t33 * t42 - 0.88e2 / 0.243e3 * t238 * t104 * sigma[0] * t243 + 0.8e1 / 0.243e3 * t21 * t26 * t316 * t239 * t242 * t112 + 0.19712e5 / 0.729e3 * t58 * t59 * t225 * t42 * t11 - 0.4e2 / 0.729e3 * t58 / t73 / t114 / t33 * sigma[0] * t60 * t142 - 0.256e3 / 0.729e3 * t58 * t194 * t119 * t195 - 0.704e3 / 0.243e3 * t58 * t113 * t210 * t114 - 0.2e2 / 0.243e3 * t27 / t31 * sigma[0] * t78 * t142 - 0.1408e4 / 0.729e3 * t27 * t205 * t137 * t195 - 0.46e3 / 0.729e3 * t27 * t37 * t282 + 0.352e3 / 0.27e2 * t27 * t124 * t231 * t114 - 0.9856e4 / 0.729e3 * t27 * t75 * t225 * t77 * t11 - 0.64e2 / 0.243e3 * t27 * t316 * t52 * sigma[0] / t240 / t41 * t73;
  t379 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t67 * t47 - 0.5e1 / 0.9e1 * t6 * t183 * t83 + t6 * t105 * t151 / 0.2e1 - t6 * t53 * t247 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t374);
  tv4rho40 = 0.2e1 * rho[0] * t379 + 0.8e1 * t252;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t422 = my_piecewise3(t2, 0, -0.455e3 / 0.108e3 * t91 / t18 / t223 * params->gamma * t97 + 0.35e2 / 0.9e1 * t91 * t258 * t24 * t170 - 0.35e2 / 0.18e2 * t259 * t175 - 0.7e1 / 0.18e2 * t263 * t270 + 0.7e1 / 0.4e1 * t162 * t275 - t91 / t18 / rho[0] * params->gamma * t283 / 0.9e1 - t166 * t167 * t193 * t42 * t195 / 0.27e2 - 0.11e2 / 0.54e2 * t95 * t26 * t204 * t77 * t195 - t91 * t279 * t24 * t25 * t236 * t243 / 0.9e1);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t422 + 0.6e1 * t287;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4sigma40 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t10;
  double t11, t14, t15, t16, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t46, t47, t49;
  double t50, t51, t55, t59, t60, t61, t63, t64;
  double t65, t66, t68, t69, t70, t71, t72, t73;
  double t74, t75, t76, t78, t79, t81, t82, t83;
  double t87, t91, tzk0;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->gamma * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = M_CBRT2;
  t37 = t36 * t36;
  t38 = t19 * t6;
  t39 = POW_1_3(t38);
  t40 = t39 * t38;
  t41 = t37 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t49 = t41 / 0.4e1 + params->delta;
  t50 = 0.1e1 / t49;
  t51 = t47 * t50;
  t55 = 0.1e1 - t35 * t41 * t51 / 0.18e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = -t16;
  t63 = my_piecewise5(t14, t11, t10, t15, t61 * t7);
  t64 = 0.1e1 + t63;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t22, t66 * t64);
  t69 = t68 * t26;
  t70 = t64 * t6;
  t71 = POW_1_3(t70);
  t72 = t71 * t70;
  t73 = t37 * t72;
  t74 = rho[1] * rho[1];
  t75 = POW_1_3(rho[1]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[2] * t78;
  t81 = t73 / 0.4e1 + params->delta;
  t82 = 0.1e1 / t81;
  t83 = t79 * t82;
  t87 = 0.1e1 - t35 * t73 * t83 / 0.18e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t69 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t10;
  double t11, t14, t15, t16, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t46, t47, t49;
  double t50, t51, t55, t59, t60, t61, t63, t64;
  double t65, t66, t68, t69, t70, t71, t72, t73;
  double t74, t75, t76, t78, t79, t81, t82, t83;
  double t87, t91, tzk0;

  double t92, t93, t94, t96, t99, t100, t104, t105;
  double t106, t109, t111, t112, t113, t115, t116, t122;
  double t123, t129, t130, t131, t132, t133, t134, t135;
  double t136, t140, t145, t146, t148, t151, t152, t156;
  double t159, t160, t161, t163, t164, t168, t169, t170;
  double t171, t172, t173, t174, t178, t183, tvrho0, t187;
  double t190, t191, t196, t197, t201, t205, t210, t212;
  double t215, t216, t221, t222, t228, t229, t234, t238;
  double t243, tvrho1, t246, t248, t249, t250, t253, t256;
  double tvsigma0, tvsigma1, t257, t258, t261, t264, tvsigma2;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->gamma * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = M_CBRT2;
  t37 = t36 * t36;
  t38 = t19 * t6;
  t39 = POW_1_3(t38);
  t40 = t39 * t38;
  t41 = t37 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t49 = t41 / 0.4e1 + params->delta;
  t50 = 0.1e1 / t49;
  t51 = t47 * t50;
  t55 = 0.1e1 - t35 * t41 * t51 / 0.18e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = -t16;
  t63 = my_piecewise5(t14, t11, t10, t15, t61 * t7);
  t64 = 0.1e1 + t63;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t22, t66 * t64);
  t69 = t68 * t26;
  t70 = t64 * t6;
  t71 = POW_1_3(t70);
  t72 = t71 * t70;
  t73 = t37 * t72;
  t74 = rho[1] * rho[1];
  t75 = POW_1_3(rho[1]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[2] * t78;
  t81 = t73 / 0.4e1 + params->delta;
  t82 = 0.1e1 / t81;
  t83 = t79 * t82;
  t87 = 0.1e1 - t35 * t73 * t83 / 0.18e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t69 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t96 = my_piecewise5(t10, 0, t14, 0, t7 - t94);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t111 = t29 * t34 * t37;
  t112 = t39 * sigma[0];
  t113 = t46 * t50;
  t115 = t96 * t6 + t18 + 0.1e1;
  t116 = t113 * t115;
  t122 = 0.1e1 / t44 / t42 / rho[0];
  t123 = sigma[0] * t122;
  t129 = t29 * t34 * t36;
  t130 = t39 * t39;
  t131 = t130 * t38;
  t132 = t131 * sigma[0];
  t133 = t49 * t49;
  t134 = 0.1e1 / t133;
  t135 = t46 * t134;
  t136 = t135 * t115;
  t140 = -0.2e1 / 0.27e2 * t111 * t112 * t116 + 0.4e1 / 0.27e2 * t35 * t41 * t123 * t50 + t129 * t132 * t136 / 0.27e2;
  t145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t140);
  t146 = t61 * t93;
  t148 = my_piecewise5(t14, 0, t10, 0, -t7 - t146);
  t151 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t148);
  t152 = t151 * t26;
  t156 = t68 * t105;
  t159 = t5 * t156 * t87 / 0.8e1;
  t160 = t71 * sigma[2];
  t161 = t78 * t82;
  t163 = t148 * t6 + t63 + 0.1e1;
  t164 = t161 * t163;
  t168 = t71 * t71;
  t169 = t168 * t70;
  t170 = t169 * sigma[2];
  t171 = t81 * t81;
  t172 = 0.1e1 / t171;
  t173 = t78 * t172;
  t174 = t173 * t163;
  t178 = -0.2e1 / 0.27e2 * t111 * t160 * t164 + t129 * t170 * t174 / 0.27e2;
  t183 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t152 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t178);
  tvrho0 = t59 + t91 + t6 * (t145 + t183);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t187 = my_piecewise5(t10, 0, t14, 0, -t7 - t94);
  t190 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t187);
  t191 = t190 * t26;
  t196 = t187 * t6 + t18 + 0.1e1;
  t197 = t113 * t196;
  t201 = t135 * t196;
  t205 = -0.2e1 / 0.27e2 * t111 * t112 * t197 + t129 * t132 * t201 / 0.27e2;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t191 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t205);
  t212 = my_piecewise5(t14, 0, t10, 0, t7 - t146);
  t215 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t212);
  t216 = t215 * t26;
  t221 = t212 * t6 + t63 + 0.1e1;
  t222 = t161 * t221;
  t228 = 0.1e1 / t76 / t74 / rho[1];
  t229 = sigma[2] * t228;
  t234 = t173 * t221;
  t238 = -0.2e1 / 0.27e2 * t111 * t160 * t222 + 0.4e1 / 0.27e2 * t35 * t73 * t229 * t82 + t129 * t170 * t234 / 0.27e2;
  t243 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t216 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t238);
  tvrho1 = t59 + t91 + t6 * (t210 + t243);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t246 = t4 * t25;
  t248 = t26 * params->gamma * t32;
  t249 = t246 * t248;
  t250 = t33 * t37;
  t253 = t250 * t40 * t46 * t50;
  t256 = my_piecewise3(t1, 0, t249 * t253 / 0.16e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t257 = t4 * t68;
  t258 = t257 * t248;
  t261 = t250 * t72 * t78 * t82;
  t264 = my_piecewise3(t60, 0, t258 * t261 / 0.16e2);
  tvsigma2 = t6 * t264;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t10;
  double t11, t14, t15, t16, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t46, t47, t49;
  double t50, t51, t55, t59, t60, t61, t63, t64;
  double t65, t66, t68, t69, t70, t71, t72, t73;
  double t74, t75, t76, t78, t79, t81, t82, t83;
  double t87, t91, tzk0;

  double t92, t93, t94, t96, t99, t100, t104, t105;
  double t106, t109, t111, t112, t113, t115, t116, t122;
  double t123, t129, t130, t131, t132, t133, t134, t135;
  double t136, t140, t145, t146, t148, t151, t152, t156;
  double t159, t160, t161, t163, t164, t168, t169, t170;
  double t171, t172, t173, t174, t178, t183, tvrho0, t187;
  double t190, t191, t196, t197, t201, t205, t210, t212;
  double t215, t216, t221, t222, t228, t229, t234, t238;
  double t243, tvrho1, t246, t248, t249, t250, t253, t256;
  double tvsigma0, tvsigma1, t257, t258, t261, t264, tvsigma2;

  double t267, t268, t269, t272, t273, t274, t277, t281;
  double t282, t286, t288, t294, t295, t298, t300, t302;
  double t303, t304, t305, t309, t310, t314, t315, t321;
  double t322, t326, t328, t334, t335, t339, t341, t342;
  double t344, t345, t346, t347, t350, t354, t359, t360;
  double t361, t362, t365, t368, t372, t373, t377, t379;
  double t384, t387, t389, t391, t392, t393, t394, t398;
  double t399, t405, t406, t410, t412, t413, t415, t416;
  double t417, t418, t421, t425, t430, tv2rho20, t433, t437;
  double t441, t442, t446, t448, t459, t461, t462, t463;
  double t467, t471, t472, t473, t478, t479, t483, t487;
  double t488, t489, t490, t493, t497, t502, t503, t507;
  double t511, t512, t516, t518, t529, t531, t532, t533;
  double t537, t538, t539, t544, t545, t549, t550, t554;
  double t555, t559, t560, t561, t562, t565, t569, t574;
  double tv2rho21, t579, t584, t588, t589, t598, t599, t603;
  double t609, t610, t614, t615, t618, t622, t627, t628;
  double t633, t637, t638, t647, t648, t652, t656, t662;
  double t663, t667, t669, t675, t679, t680, t683, t687;
  double t692, tv2rho22, t695, t696, t700, t701, t703, t704;
  double t705, t710, t713, t714, t715, t719, tv2rhosigma0, tv2rhosigma1;
  double t721, t722, t725, t727, t728, t729, t732, t733;
  double t737, tv2rhosigma2, t739, t740, t743, t746, t750, tv2rhosigma3;
  double tv2rhosigma4, t752, t753, t756, t761, t764, t768, tv2rhosigma5;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->gamma * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = M_CBRT2;
  t37 = t36 * t36;
  t38 = t19 * t6;
  t39 = POW_1_3(t38);
  t40 = t39 * t38;
  t41 = t37 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t49 = t41 / 0.4e1 + params->delta;
  t50 = 0.1e1 / t49;
  t51 = t47 * t50;
  t55 = 0.1e1 - t35 * t41 * t51 / 0.18e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = -t16;
  t63 = my_piecewise5(t14, t11, t10, t15, t61 * t7);
  t64 = 0.1e1 + t63;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t22, t66 * t64);
  t69 = t68 * t26;
  t70 = t64 * t6;
  t71 = POW_1_3(t70);
  t72 = t71 * t70;
  t73 = t37 * t72;
  t74 = rho[1] * rho[1];
  t75 = POW_1_3(rho[1]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[2] * t78;
  t81 = t73 / 0.4e1 + params->delta;
  t82 = 0.1e1 / t81;
  t83 = t79 * t82;
  t87 = 0.1e1 - t35 * t73 * t83 / 0.18e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t69 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t96 = my_piecewise5(t10, 0, t14, 0, t7 - t94);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t111 = t29 * t34 * t37;
  t112 = t39 * sigma[0];
  t113 = t46 * t50;
  t115 = t96 * t6 + t18 + 0.1e1;
  t116 = t113 * t115;
  t122 = 0.1e1 / t44 / t42 / rho[0];
  t123 = sigma[0] * t122;
  t129 = t29 * t34 * t36;
  t130 = t39 * t39;
  t131 = t130 * t38;
  t132 = t131 * sigma[0];
  t133 = t49 * t49;
  t134 = 0.1e1 / t133;
  t135 = t46 * t134;
  t136 = t135 * t115;
  t140 = -0.2e1 / 0.27e2 * t111 * t112 * t116 + 0.4e1 / 0.27e2 * t35 * t41 * t123 * t50 + t129 * t132 * t136 / 0.27e2;
  t145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t140);
  t146 = t61 * t93;
  t148 = my_piecewise5(t14, 0, t10, 0, -t7 - t146);
  t151 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t148);
  t152 = t151 * t26;
  t156 = t68 * t105;
  t159 = t5 * t156 * t87 / 0.8e1;
  t160 = t71 * sigma[2];
  t161 = t78 * t82;
  t163 = t148 * t6 + t63 + 0.1e1;
  t164 = t161 * t163;
  t168 = t71 * t71;
  t169 = t168 * t70;
  t170 = t169 * sigma[2];
  t171 = t81 * t81;
  t172 = 0.1e1 / t171;
  t173 = t78 * t172;
  t174 = t173 * t163;
  t178 = -0.2e1 / 0.27e2 * t111 * t160 * t164 + t129 * t170 * t174 / 0.27e2;
  t183 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t152 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t178);
  tvrho0 = t59 + t91 + t6 * (t145 + t183);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t187 = my_piecewise5(t10, 0, t14, 0, -t7 - t94);
  t190 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t187);
  t191 = t190 * t26;
  t196 = t187 * t6 + t18 + 0.1e1;
  t197 = t113 * t196;
  t201 = t135 * t196;
  t205 = -0.2e1 / 0.27e2 * t111 * t112 * t197 + t129 * t132 * t201 / 0.27e2;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t191 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t205);
  t212 = my_piecewise5(t14, 0, t10, 0, t7 - t146);
  t215 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t212);
  t216 = t215 * t26;
  t221 = t212 * t6 + t63 + 0.1e1;
  t222 = t161 * t221;
  t228 = 0.1e1 / t76 / t74 / rho[1];
  t229 = sigma[2] * t228;
  t234 = t173 * t221;
  t238 = -0.2e1 / 0.27e2 * t111 * t160 * t222 + 0.4e1 / 0.27e2 * t35 * t73 * t229 * t82 + t129 * t170 * t234 / 0.27e2;
  t243 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t216 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t238);
  tvrho1 = t59 + t91 + t6 * (t210 + t243);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t246 = t4 * t25;
  t248 = t26 * params->gamma * t32;
  t249 = t246 * t248;
  t250 = t33 * t37;
  t253 = t250 * t40 * t46 * t50;
  t256 = my_piecewise3(t1, 0, t249 * t253 / 0.16e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t257 = t4 * t68;
  t258 = t257 * t248;
  t261 = t250 * t72 * t78 * t82;
  t264 = my_piecewise3(t60, 0, t258 * t261 / 0.16e2);
  tvsigma2 = t6 * t264;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t267 = t23 * t23;
  t268 = 0.1e1 / t267;
  t269 = t96 * t96;
  t272 = t92 * t6;
  t273 = 0.1e1 / t272;
  t274 = t16 * t273;
  t277 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t93 + 0.2e1 * t274);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t269 + 0.4e1 / 0.3e1 * t23 * t277);
  t282 = t281 * t26;
  t286 = t99 * t105;
  t288 = t5 * t286 * t55;
  t294 = 0.1e1 / t104 / t6;
  t295 = t25 * t294;
  t298 = t5 * t295 * t55 / 0.12e2;
  t300 = t5 * t106 * t140;
  t302 = 0.1e1 / t130;
  t303 = t302 * sigma[0];
  t304 = t115 * t115;
  t305 = t113 * t304;
  t309 = t122 * t50;
  t310 = t309 * t115;
  t314 = t130 * sigma[0];
  t315 = t135 * t304;
  t321 = t277 * t6 + 0.2e1 * t96;
  t322 = t113 * t321;
  t326 = t42 * t42;
  t328 = 0.1e1 / t44 / t326;
  t334 = t122 * t134;
  t335 = t334 * t115;
  t339 = t19 * t19;
  t341 = t29 * t34 * t339;
  t342 = t92 * sigma[0];
  t344 = 0.1e1 / t133 / t49;
  t345 = t46 * t344;
  t346 = t345 * t304;
  t347 = t342 * t346;
  t350 = t135 * t321;
  t354 = -0.2e1 / 0.81e2 * t111 * t303 * t305 + 0.32e2 / 0.81e2 * t111 * t112 * t310 + t129 * t314 * t315 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t322 - 0.44e2 / 0.81e2 * t35 * t41 * sigma[0] * t328 * t50 - 0.16e2 / 0.81e2 * t129 * t132 * t335 - 0.4e1 / 0.81e2 * t341 * t347 + t129 * t132 * t350 / 0.27e2;
  t359 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t55 - t288 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t140 + t298 - t300 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t354);
  t360 = t66 * t66;
  t361 = 0.1e1 / t360;
  t362 = t148 * t148;
  t365 = t61 * t273;
  t368 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t93 + 0.2e1 * t365);
  t372 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t362 + 0.4e1 / 0.3e1 * t66 * t368);
  t373 = t372 * t26;
  t377 = t151 * t105;
  t379 = t5 * t377 * t87;
  t384 = t68 * t294;
  t387 = t5 * t384 * t87 / 0.12e2;
  t389 = t5 * t156 * t178;
  t391 = 0.1e1 / t168;
  t392 = t391 * sigma[2];
  t393 = t163 * t163;
  t394 = t161 * t393;
  t398 = t168 * sigma[2];
  t399 = t173 * t393;
  t405 = t368 * t6 + 0.2e1 * t148;
  t406 = t161 * t405;
  t410 = t64 * t64;
  t412 = t29 * t34 * t410;
  t413 = t92 * sigma[2];
  t415 = 0.1e1 / t171 / t81;
  t416 = t78 * t415;
  t417 = t416 * t393;
  t418 = t413 * t417;
  t421 = t173 * t405;
  t425 = -0.2e1 / 0.81e2 * t111 * t392 * t394 + t129 * t398 * t399 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t406 - 0.4e1 / 0.81e2 * t412 * t418 + t129 * t170 * t421 / 0.27e2;
  t430 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t373 * t87 - t379 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t152 * t178 + t387 - t389 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t425);
  tv2rho20 = 0.2e1 * t145 + 0.2e1 * t183 + t6 * (t359 + t430);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t433 = t268 * t187;
  t437 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t274);
  t441 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t433 * t96 + 0.4e1 / 0.3e1 * t23 * t437);
  t442 = t441 * t26;
  t446 = t190 * t105;
  t448 = t5 * t446 * t55;
  t459 = t5 * t106 * t205;
  t461 = t303 * t46;
  t462 = t50 * t196;
  t463 = t462 * t115;
  t467 = t309 * t196;
  t471 = t314 * t46;
  t472 = t134 * t196;
  t473 = t472 * t115;
  t478 = t437 * t6 + t187 + t96;
  t479 = t113 * t478;
  t483 = t334 * t196;
  t487 = t342 * t46;
  t488 = t344 * t196;
  t489 = t488 * t115;
  t490 = t487 * t489;
  t493 = t135 * t478;
  t497 = -0.2e1 / 0.81e2 * t111 * t461 * t463 + 0.16e2 / 0.81e2 * t111 * t112 * t467 + t129 * t471 * t473 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t479 - 0.8e1 / 0.81e2 * t129 * t132 * t483 - 0.4e1 / 0.81e2 * t341 * t490 + t129 * t132 * t493 / 0.27e2;
  t502 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t442 * t55 - t448 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t191 * t140 - t288 / 0.8e1 + t298 - t300 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t100 * t205 - t459 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t27 * t497);
  t503 = t361 * t212;
  t507 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t365);
  t511 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t66 * t507);
  t512 = t511 * t26;
  t516 = t215 * t105;
  t518 = t5 * t516 * t87;
  t529 = t5 * t156 * t238;
  t531 = t392 * t78;
  t532 = t82 * t221;
  t533 = t532 * t163;
  t537 = t398 * t78;
  t538 = t172 * t221;
  t539 = t538 * t163;
  t544 = t507 * t6 + t148 + t212;
  t545 = t161 * t544;
  t549 = t228 * t82;
  t550 = t549 * t163;
  t554 = t228 * t172;
  t555 = t554 * t163;
  t559 = t413 * t78;
  t560 = t415 * t221;
  t561 = t560 * t163;
  t562 = t559 * t561;
  t565 = t173 * t544;
  t569 = -0.2e1 / 0.81e2 * t111 * t531 * t533 + t129 * t537 * t539 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t545 + 0.16e2 / 0.81e2 * t111 * t160 * t550 - 0.8e1 / 0.81e2 * t129 * t170 * t555 - 0.4e1 / 0.81e2 * t412 * t562 + t129 * t170 * t565 / 0.27e2;
  t574 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t512 * t87 - t518 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t216 * t178 - t379 / 0.8e1 + t387 - t389 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t238 - t529 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t69 * t569);
  tv2rho21 = t145 + t183 + t210 + t243 + t6 * (t502 + t574);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t579 = t187 * t187;
  t584 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t93 + 0.2e1 * t274);
  t588 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t579 + 0.4e1 / 0.3e1 * t23 * t584);
  t589 = t588 * t26;
  t598 = t196 * t196;
  t599 = t113 * t598;
  t603 = t135 * t598;
  t609 = t584 * t6 + 0.2e1 * t187;
  t610 = t113 * t609;
  t614 = t345 * t598;
  t615 = t342 * t614;
  t618 = t135 * t609;
  t622 = -0.2e1 / 0.81e2 * t111 * t303 * t599 + t129 * t314 * t603 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t610 - 0.4e1 / 0.81e2 * t341 * t615 + t129 * t132 * t618 / 0.27e2;
  t627 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t589 * t55 - t448 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t191 * t205 + t298 - t459 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t622);
  t628 = t212 * t212;
  t633 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t93 + 0.2e1 * t365);
  t637 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t628 + 0.4e1 / 0.3e1 * t66 * t633);
  t638 = t637 * t26;
  t647 = t221 * t221;
  t648 = t161 * t647;
  t652 = t549 * t221;
  t656 = t173 * t647;
  t662 = t633 * t6 + 0.2e1 * t212;
  t663 = t161 * t662;
  t667 = t74 * t74;
  t669 = 0.1e1 / t76 / t667;
  t675 = t554 * t221;
  t679 = t416 * t647;
  t680 = t413 * t679;
  t683 = t173 * t662;
  t687 = -0.2e1 / 0.81e2 * t111 * t392 * t648 + 0.32e2 / 0.81e2 * t111 * t160 * t652 + t129 * t398 * t656 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t663 - 0.44e2 / 0.81e2 * t35 * t73 * sigma[2] * t669 * t82 - 0.16e2 / 0.81e2 * t129 * t170 * t675 - 0.4e1 / 0.81e2 * t412 * t680 + t129 * t170 * t683 / 0.27e2;
  t692 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t638 * t87 - t518 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t216 * t238 + t387 - t529 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t687);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t243 + t6 * (t627 + t692);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t695 = t4 * t99;
  t696 = t695 * t248;
  t700 = t105 * params->gamma * t32;
  t701 = t246 * t700;
  t703 = t701 * t253 / 0.48e2;
  t704 = t250 * t39;
  t705 = t704 * t116;
  t710 = t250 * t40 * t122 * t50;
  t713 = t33 * t36;
  t714 = t713 * t131;
  t715 = t714 * t136;
  t719 = my_piecewise3(t1, 0, t696 * t253 / 0.16e2 + t703 + t249 * t705 / 0.12e2 - t249 * t710 / 0.6e1 - t249 * t715 / 0.24e2);
  tv2rhosigma0 = t6 * t719 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t721 = t4 * t151;
  t722 = t721 * t248;
  t725 = t257 * t700;
  t727 = t725 * t261 / 0.48e2;
  t728 = t250 * t71;
  t729 = t728 * t164;
  t732 = t713 * t169;
  t733 = t732 * t174;
  t737 = my_piecewise3(t60, 0, t722 * t261 / 0.16e2 + t727 + t258 * t729 / 0.12e2 - t258 * t733 / 0.24e2);
  tv2rhosigma2 = t6 * t737 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t739 = t4 * t190;
  t740 = t739 * t248;
  t743 = t704 * t197;
  t746 = t714 * t201;
  t750 = my_piecewise3(t1, 0, t740 * t253 / 0.16e2 + t703 + t249 * t743 / 0.12e2 - t249 * t746 / 0.24e2);
  tv2rhosigma3 = t6 * t750 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t752 = t4 * t215;
  t753 = t752 * t248;
  t756 = t728 * t222;
  t761 = t250 * t72 * t228 * t82;
  t764 = t732 * t234;
  t768 = my_piecewise3(t60, 0, t753 * t261 / 0.16e2 + t727 + t258 * t756 / 0.12e2 - t258 * t761 / 0.6e1 - t258 * t764 / 0.24e2);
  tv2rhosigma5 = t6 * t768 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t10;
  double t11, t14, t15, t16, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t46, t47, t49;
  double t50, t51, t55, t59, t60, t61, t63, t64;
  double t65, t66, t68, t69, t70, t71, t72, t73;
  double t74, t75, t76, t78, t79, t81, t82, t83;
  double t87, t91, tzk0;

  double t92, t93, t94, t96, t99, t100, t104, t105;
  double t106, t109, t111, t112, t113, t115, t116, t122;
  double t123, t129, t130, t131, t132, t133, t134, t135;
  double t136, t140, t145, t146, t148, t151, t152, t156;
  double t159, t160, t161, t163, t164, t168, t169, t170;
  double t171, t172, t173, t174, t178, t183, tvrho0, t187;
  double t190, t191, t196, t197, t201, t205, t210, t212;
  double t215, t216, t221, t222, t228, t229, t234, t238;
  double t243, tvrho1, t246, t248, t249, t250, t253, t256;
  double tvsigma0, tvsigma1, t257, t258, t261, t264, tvsigma2;

  double t267, t268, t269, t272, t273, t274, t277, t281;
  double t282, t286, t288, t294, t295, t298, t300, t302;
  double t303, t304, t305, t309, t310, t314, t315, t321;
  double t322, t326, t328, t334, t335, t339, t341, t342;
  double t344, t345, t346, t347, t350, t354, t359, t360;
  double t361, t362, t365, t368, t372, t373, t377, t379;
  double t384, t387, t389, t391, t392, t393, t394, t398;
  double t399, t405, t406, t410, t412, t413, t415, t416;
  double t417, t418, t421, t425, t430, tv2rho20, t433, t437;
  double t441, t442, t446, t448, t459, t461, t462, t463;
  double t467, t471, t472, t473, t478, t479, t483, t487;
  double t488, t489, t490, t493, t497, t502, t503, t507;
  double t511, t512, t516, t518, t529, t531, t532, t533;
  double t537, t538, t539, t544, t545, t549, t550, t554;
  double t555, t559, t560, t561, t562, t565, t569, t574;
  double tv2rho21, t579, t584, t588, t589, t598, t599, t603;
  double t609, t610, t614, t615, t618, t622, t627, t628;
  double t633, t637, t638, t647, t648, t652, t656, t662;
  double t663, t667, t669, t675, t679, t680, t683, t687;
  double t692, tv2rho22, t695, t696, t700, t701, t703, t704;
  double t705, t710, t713, t714, t715, t719, tv2rhosigma0, tv2rhosigma1;
  double t721, t722, t725, t727, t728, t729, t732, t733;
  double t737, tv2rhosigma2, t739, t740, t743, t746, t750, tv2rhosigma3;
  double tv2rhosigma4, t752, t753, t756, t761, t764, t768, tv2rhosigma5;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;

  double t773, t774, t777, t780, t781, t782, t785, t789;
  double t790, t794, t796, t801, t803, t806, t812, t813;
  double t816, t818, t821, t823, t824, t826, t827, t828;
  double t829, t830, t831, t832, t833, t836, t840, t841;
  double t847, t848, t852, t853, t854, t858, t862, t867;
  double t868, t869, t870, t873, t879, t885, t886, t890;
  double t891, t899, t904, t908, t909, t910, t914, t919;
  double t923, t924, t928, t933, t935, t936, t939, t942;
  double t945, t949, t950, t954, t956, t961, t963, t966;
  double t971, t974, t976, t979, t981, t982, t983, t984;
  double t988, t989, t990, t994, t995, t1000, t1001, t1002;
  double t1003, t1006, t1007, t1013, t1014, t1018, t1019, t1026;
  double t1028, t1029, t1030, t1031, t1033, t1034, t1037, t1038;
  double t1042, t1046, t1051, tv3rho30, t1054, t1055, t1056, t1059;
  double t1060, t1062, t1066, t1068, t1075, t1076, t1078, t1079;
  double t1080, t1081, t1082, t1085, t1089, t1090, t1094, t1099;
  double t1100, t1101, t1104, t1105, t1107, t1109, t1110, t1111;
  double t1115, t1119, t1123, t1127, t1132, t1136, t1137, t1141;
  double t1145, t1149, t1153, t1154, t1158, t1162, t1163, t1166;
  double t1167, t1171, t1175, t1176, t1180, t1181, t1185, t1188;
  double t1196, t1197, t1206, t1218, t1219, t1220, t1222, t1226;
  double t1228, t1230, t1233, t1234, t1237, t1242, t1244, t1248;
  double t1249, t1258, t1270, t1271, t1273, t1274, t1275, t1276;
  double t1277, t1280, t1284, t1285, t1290, t1291, t1292, t1296;
  double t1297, t1298, t1302, t1306, t1310, t1314, t1315, t1319;
  double t1323, t1327, t1328, t1332, t1336, t1337, t1341, t1345;
  double t1346, t1350, t1351, t1355, t1359, t1360, t1363, t1372;
  double t1373, tv3rho31, t1376, t1381, t1385, t1389, t1390, t1394;
  double t1396, t1406, t1418, t1420, t1421, t1425, t1429, t1430;
  double t1434, t1438, t1442, t1443, t1444, t1447, t1451, t1452;
  double t1456, t1460, t1461, t1466, t1467, t1471, t1477, t1478;
  double t1482, t1483, t1484, t1485, t1488, t1492, t1496, t1497;
  double t1501, t1505, t1509, t1510, t1511, t1516, t1520, t1524;
  double t1525, t1529, t1531, t1541, t1553, t1555, t1556, t1560;
  double t1561, t1565, t1569, t1573, t1577, t1581, t1582, t1583;
  double t1586, t1590, t1591, t1595, t1596, t1602, t1603, t1607;
  double t1608, t1612, t1613, t1617, t1621, t1625, t1631, t1632;
  double t1633, t1634, t1635, t1638, t1642, t1643, t1647, t1651;
  double t1652, t1656, t1657, tv3rho32, t1662, t1669, t1673, t1674;
  double t1689, t1690, t1694, t1698, t1702, t1703, t1706, t1712;
  double t1713, t1717, t1718, t1721, t1722, t1723, t1726, t1730;
  double t1734, t1739, t1740, t1747, t1751, t1752, t1767, t1771;
  double t1772, t1775, t1779, t1783, t1787, t1791, t1792, t1796;
  double t1797, t1798, t1801, t1805, t1809, t1815, t1816, t1820;
  double t1824, t1828, t1832, t1833, t1836, t1842, t1848, t1853;
  double tv3rho33, t1857, t1860, t1862, t1864, t1866, t1869, t1870;
  double t1875, t1878, t1881, t1882, t1891, t1892, t1894, t1895;
  double t1896, t1899, t1902, t1904, t1905, t1906, t1909, t1910;
  double t1913, t1914, tv3rho2sigma0, tv3rho2sigma1, t1917, t1918, t1921, t1922;
  double t1928, t1930, t1931, t1933, t1935, t1936, t1939, t1940;
  double t1943, t1946, t1947, t1950, t1953, t1954, tv3rho2sigma2, t1956;
  double t1957, t1960, t1961, t1976, t1980, t1981, t1982, t1983;
  double t1984, t1987, t1990, t1991, t1992, t1995, t2000, t2002;
  double t2005, t2006, t2009, t2012, t2014, tv3rho2sigma3, tv3rho2sigma4, t2016;
  double t2017, t2020, t2021, t2032, t2036, t2037, t2038, t2039;
  double t2042, t2043, t2044, t2047, t2052, t2054, t2057, t2062;
  double t2064, t2065, t2068, t2071, t2073, tv3rho2sigma5, t2076, t2077;
  double t2087, t2090, t2093, t2096, t2099, t2102, t2103, tv3rho2sigma6;
  double tv3rho2sigma7, t2106, t2109, t2114, t2117, t2120, t2131, t2134;
  double t2139, t2140, t2143, t2146, t2147, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->gamma * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = M_CBRT2;
  t37 = t36 * t36;
  t38 = t19 * t6;
  t39 = POW_1_3(t38);
  t40 = t39 * t38;
  t41 = t37 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t49 = t41 / 0.4e1 + params->delta;
  t50 = 0.1e1 / t49;
  t51 = t47 * t50;
  t55 = 0.1e1 - t35 * t41 * t51 / 0.18e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = -t16;
  t63 = my_piecewise5(t14, t11, t10, t15, t61 * t7);
  t64 = 0.1e1 + t63;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t22, t66 * t64);
  t69 = t68 * t26;
  t70 = t64 * t6;
  t71 = POW_1_3(t70);
  t72 = t71 * t70;
  t73 = t37 * t72;
  t74 = rho[1] * rho[1];
  t75 = POW_1_3(rho[1]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[2] * t78;
  t81 = t73 / 0.4e1 + params->delta;
  t82 = 0.1e1 / t81;
  t83 = t79 * t82;
  t87 = 0.1e1 - t35 * t73 * t83 / 0.18e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t69 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t96 = my_piecewise5(t10, 0, t14, 0, t7 - t94);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t111 = t29 * t34 * t37;
  t112 = t39 * sigma[0];
  t113 = t46 * t50;
  t115 = t96 * t6 + t18 + 0.1e1;
  t116 = t113 * t115;
  t122 = 0.1e1 / t44 / t42 / rho[0];
  t123 = sigma[0] * t122;
  t129 = t29 * t34 * t36;
  t130 = t39 * t39;
  t131 = t130 * t38;
  t132 = t131 * sigma[0];
  t133 = t49 * t49;
  t134 = 0.1e1 / t133;
  t135 = t46 * t134;
  t136 = t135 * t115;
  t140 = -0.2e1 / 0.27e2 * t111 * t112 * t116 + 0.4e1 / 0.27e2 * t35 * t41 * t123 * t50 + t129 * t132 * t136 / 0.27e2;
  t145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t140);
  t146 = t61 * t93;
  t148 = my_piecewise5(t14, 0, t10, 0, -t7 - t146);
  t151 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t148);
  t152 = t151 * t26;
  t156 = t68 * t105;
  t159 = t5 * t156 * t87 / 0.8e1;
  t160 = t71 * sigma[2];
  t161 = t78 * t82;
  t163 = t148 * t6 + t63 + 0.1e1;
  t164 = t161 * t163;
  t168 = t71 * t71;
  t169 = t168 * t70;
  t170 = t169 * sigma[2];
  t171 = t81 * t81;
  t172 = 0.1e1 / t171;
  t173 = t78 * t172;
  t174 = t173 * t163;
  t178 = -0.2e1 / 0.27e2 * t111 * t160 * t164 + t129 * t170 * t174 / 0.27e2;
  t183 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t152 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t178);
  tvrho0 = t59 + t91 + t6 * (t145 + t183);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t187 = my_piecewise5(t10, 0, t14, 0, -t7 - t94);
  t190 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t187);
  t191 = t190 * t26;
  t196 = t187 * t6 + t18 + 0.1e1;
  t197 = t113 * t196;
  t201 = t135 * t196;
  t205 = -0.2e1 / 0.27e2 * t111 * t112 * t197 + t129 * t132 * t201 / 0.27e2;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t191 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t205);
  t212 = my_piecewise5(t14, 0, t10, 0, t7 - t146);
  t215 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t212);
  t216 = t215 * t26;
  t221 = t212 * t6 + t63 + 0.1e1;
  t222 = t161 * t221;
  t228 = 0.1e1 / t76 / t74 / rho[1];
  t229 = sigma[2] * t228;
  t234 = t173 * t221;
  t238 = -0.2e1 / 0.27e2 * t111 * t160 * t222 + 0.4e1 / 0.27e2 * t35 * t73 * t229 * t82 + t129 * t170 * t234 / 0.27e2;
  t243 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t216 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t238);
  tvrho1 = t59 + t91 + t6 * (t210 + t243);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t246 = t4 * t25;
  t248 = t26 * params->gamma * t32;
  t249 = t246 * t248;
  t250 = t33 * t37;
  t253 = t250 * t40 * t46 * t50;
  t256 = my_piecewise3(t1, 0, t249 * t253 / 0.16e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t257 = t4 * t68;
  t258 = t257 * t248;
  t261 = t250 * t72 * t78 * t82;
  t264 = my_piecewise3(t60, 0, t258 * t261 / 0.16e2);
  tvsigma2 = t6 * t264;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t267 = t23 * t23;
  t268 = 0.1e1 / t267;
  t269 = t96 * t96;
  t272 = t92 * t6;
  t273 = 0.1e1 / t272;
  t274 = t16 * t273;
  t277 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t93 + 0.2e1 * t274);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t269 + 0.4e1 / 0.3e1 * t23 * t277);
  t282 = t281 * t26;
  t286 = t99 * t105;
  t288 = t5 * t286 * t55;
  t294 = 0.1e1 / t104 / t6;
  t295 = t25 * t294;
  t298 = t5 * t295 * t55 / 0.12e2;
  t300 = t5 * t106 * t140;
  t302 = 0.1e1 / t130;
  t303 = t302 * sigma[0];
  t304 = t115 * t115;
  t305 = t113 * t304;
  t309 = t122 * t50;
  t310 = t309 * t115;
  t314 = t130 * sigma[0];
  t315 = t135 * t304;
  t321 = t277 * t6 + 0.2e1 * t96;
  t322 = t113 * t321;
  t326 = t42 * t42;
  t328 = 0.1e1 / t44 / t326;
  t334 = t122 * t134;
  t335 = t334 * t115;
  t339 = t19 * t19;
  t341 = t29 * t34 * t339;
  t342 = t92 * sigma[0];
  t344 = 0.1e1 / t133 / t49;
  t345 = t46 * t344;
  t346 = t345 * t304;
  t347 = t342 * t346;
  t350 = t135 * t321;
  t354 = -0.2e1 / 0.81e2 * t111 * t303 * t305 + 0.32e2 / 0.81e2 * t111 * t112 * t310 + t129 * t314 * t315 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t322 - 0.44e2 / 0.81e2 * t35 * t41 * sigma[0] * t328 * t50 - 0.16e2 / 0.81e2 * t129 * t132 * t335 - 0.4e1 / 0.81e2 * t341 * t347 + t129 * t132 * t350 / 0.27e2;
  t359 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t55 - t288 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t140 + t298 - t300 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t354);
  t360 = t66 * t66;
  t361 = 0.1e1 / t360;
  t362 = t148 * t148;
  t365 = t61 * t273;
  t368 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t93 + 0.2e1 * t365);
  t372 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t362 + 0.4e1 / 0.3e1 * t66 * t368);
  t373 = t372 * t26;
  t377 = t151 * t105;
  t379 = t5 * t377 * t87;
  t384 = t68 * t294;
  t387 = t5 * t384 * t87 / 0.12e2;
  t389 = t5 * t156 * t178;
  t391 = 0.1e1 / t168;
  t392 = t391 * sigma[2];
  t393 = t163 * t163;
  t394 = t161 * t393;
  t398 = t168 * sigma[2];
  t399 = t173 * t393;
  t405 = t368 * t6 + 0.2e1 * t148;
  t406 = t161 * t405;
  t410 = t64 * t64;
  t412 = t29 * t34 * t410;
  t413 = t92 * sigma[2];
  t415 = 0.1e1 / t171 / t81;
  t416 = t78 * t415;
  t417 = t416 * t393;
  t418 = t413 * t417;
  t421 = t173 * t405;
  t425 = -0.2e1 / 0.81e2 * t111 * t392 * t394 + t129 * t398 * t399 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t406 - 0.4e1 / 0.81e2 * t412 * t418 + t129 * t170 * t421 / 0.27e2;
  t430 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t373 * t87 - t379 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t152 * t178 + t387 - t389 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t425);
  tv2rho20 = 0.2e1 * t145 + 0.2e1 * t183 + t6 * (t359 + t430);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t433 = t268 * t187;
  t437 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t274);
  t441 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t433 * t96 + 0.4e1 / 0.3e1 * t23 * t437);
  t442 = t441 * t26;
  t446 = t190 * t105;
  t448 = t5 * t446 * t55;
  t459 = t5 * t106 * t205;
  t461 = t303 * t46;
  t462 = t50 * t196;
  t463 = t462 * t115;
  t467 = t309 * t196;
  t471 = t314 * t46;
  t472 = t134 * t196;
  t473 = t472 * t115;
  t478 = t437 * t6 + t187 + t96;
  t479 = t113 * t478;
  t483 = t334 * t196;
  t487 = t342 * t46;
  t488 = t344 * t196;
  t489 = t488 * t115;
  t490 = t487 * t489;
  t493 = t135 * t478;
  t497 = -0.2e1 / 0.81e2 * t111 * t461 * t463 + 0.16e2 / 0.81e2 * t111 * t112 * t467 + t129 * t471 * t473 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t479 - 0.8e1 / 0.81e2 * t129 * t132 * t483 - 0.4e1 / 0.81e2 * t341 * t490 + t129 * t132 * t493 / 0.27e2;
  t502 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t442 * t55 - t448 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t191 * t140 - t288 / 0.8e1 + t298 - t300 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t100 * t205 - t459 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t27 * t497);
  t503 = t361 * t212;
  t507 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t365);
  t511 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t66 * t507);
  t512 = t511 * t26;
  t516 = t215 * t105;
  t518 = t5 * t516 * t87;
  t529 = t5 * t156 * t238;
  t531 = t392 * t78;
  t532 = t82 * t221;
  t533 = t532 * t163;
  t537 = t398 * t78;
  t538 = t172 * t221;
  t539 = t538 * t163;
  t544 = t507 * t6 + t148 + t212;
  t545 = t161 * t544;
  t549 = t228 * t82;
  t550 = t549 * t163;
  t554 = t228 * t172;
  t555 = t554 * t163;
  t559 = t413 * t78;
  t560 = t415 * t221;
  t561 = t560 * t163;
  t562 = t559 * t561;
  t565 = t173 * t544;
  t569 = -0.2e1 / 0.81e2 * t111 * t531 * t533 + t129 * t537 * t539 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t545 + 0.16e2 / 0.81e2 * t111 * t160 * t550 - 0.8e1 / 0.81e2 * t129 * t170 * t555 - 0.4e1 / 0.81e2 * t412 * t562 + t129 * t170 * t565 / 0.27e2;
  t574 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t512 * t87 - t518 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t216 * t178 - t379 / 0.8e1 + t387 - t389 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t238 - t529 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t69 * t569);
  tv2rho21 = t145 + t183 + t210 + t243 + t6 * (t502 + t574);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t579 = t187 * t187;
  t584 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t93 + 0.2e1 * t274);
  t588 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t579 + 0.4e1 / 0.3e1 * t23 * t584);
  t589 = t588 * t26;
  t598 = t196 * t196;
  t599 = t113 * t598;
  t603 = t135 * t598;
  t609 = t584 * t6 + 0.2e1 * t187;
  t610 = t113 * t609;
  t614 = t345 * t598;
  t615 = t342 * t614;
  t618 = t135 * t609;
  t622 = -0.2e1 / 0.81e2 * t111 * t303 * t599 + t129 * t314 * t603 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t610 - 0.4e1 / 0.81e2 * t341 * t615 + t129 * t132 * t618 / 0.27e2;
  t627 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t589 * t55 - t448 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t191 * t205 + t298 - t459 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t622);
  t628 = t212 * t212;
  t633 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t93 + 0.2e1 * t365);
  t637 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t628 + 0.4e1 / 0.3e1 * t66 * t633);
  t638 = t637 * t26;
  t647 = t221 * t221;
  t648 = t161 * t647;
  t652 = t549 * t221;
  t656 = t173 * t647;
  t662 = t633 * t6 + 0.2e1 * t212;
  t663 = t161 * t662;
  t667 = t74 * t74;
  t669 = 0.1e1 / t76 / t667;
  t675 = t554 * t221;
  t679 = t416 * t647;
  t680 = t413 * t679;
  t683 = t173 * t662;
  t687 = -0.2e1 / 0.81e2 * t111 * t392 * t648 + 0.32e2 / 0.81e2 * t111 * t160 * t652 + t129 * t398 * t656 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t663 - 0.44e2 / 0.81e2 * t35 * t73 * sigma[2] * t669 * t82 - 0.16e2 / 0.81e2 * t129 * t170 * t675 - 0.4e1 / 0.81e2 * t412 * t680 + t129 * t170 * t683 / 0.27e2;
  t692 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t638 * t87 - t518 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t216 * t238 + t387 - t529 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t687);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t243 + t6 * (t627 + t692);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t695 = t4 * t99;
  t696 = t695 * t248;
  t700 = t105 * params->gamma * t32;
  t701 = t246 * t700;
  t703 = t701 * t253 / 0.48e2;
  t704 = t250 * t39;
  t705 = t704 * t116;
  t710 = t250 * t40 * t122 * t50;
  t713 = t33 * t36;
  t714 = t713 * t131;
  t715 = t714 * t136;
  t719 = my_piecewise3(t1, 0, t696 * t253 / 0.16e2 + t703 + t249 * t705 / 0.12e2 - t249 * t710 / 0.6e1 - t249 * t715 / 0.24e2);
  tv2rhosigma0 = t6 * t719 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t721 = t4 * t151;
  t722 = t721 * t248;
  t725 = t257 * t700;
  t727 = t725 * t261 / 0.48e2;
  t728 = t250 * t71;
  t729 = t728 * t164;
  t732 = t713 * t169;
  t733 = t732 * t174;
  t737 = my_piecewise3(t60, 0, t722 * t261 / 0.16e2 + t727 + t258 * t729 / 0.12e2 - t258 * t733 / 0.24e2);
  tv2rhosigma2 = t6 * t737 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t739 = t4 * t190;
  t740 = t739 * t248;
  t743 = t704 * t197;
  t746 = t714 * t201;
  t750 = my_piecewise3(t1, 0, t740 * t253 / 0.16e2 + t703 + t249 * t743 / 0.12e2 - t249 * t746 / 0.24e2);
  tv2rhosigma3 = t6 * t750 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t752 = t4 * t215;
  t753 = t752 * t248;
  t756 = t728 * t222;
  t761 = t250 * t72 * t228 * t82;
  t764 = t732 * t234;
  t768 = my_piecewise3(t60, 0, t753 * t261 / 0.16e2 + t727 + t258 * t756 / 0.12e2 - t258 * t761 / 0.6e1 - t258 * t764 / 0.24e2);
  tv2rhosigma5 = t6 * t768 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t773 = 0.1e1 / t267 / t19;
  t774 = t269 * t96;
  t777 = t268 * t96;
  t780 = t92 * t92;
  t781 = 0.1e1 / t780;
  t782 = t16 * t781;
  t785 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t273 - 0.6e1 * t782);
  t789 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t773 * t774 + 0.4e1 / 0.3e1 * t777 * t277 + 0.4e1 / 0.3e1 * t23 * t785);
  t790 = t789 * t26;
  t794 = t281 * t105;
  t796 = t5 * t794 * t55;
  t801 = t99 * t294;
  t803 = t5 * t801 * t55;
  t806 = t5 * t286 * t140;
  t812 = 0.1e1 / t104 / t92;
  t813 = t25 * t812;
  t816 = 0.5e1 / 0.36e2 * t5 * t813 * t55;
  t818 = t5 * t295 * t140;
  t821 = t5 * t106 * t354;
  t823 = t29 * t32;
  t824 = t33 * t339;
  t826 = t823 * t824 * t92;
  t827 = t133 * t133;
  t828 = 0.1e1 / t827;
  t829 = t47 * t828;
  t830 = t304 * t115;
  t831 = t830 * t37;
  t832 = t831 * t39;
  t833 = t829 * t832;
  t836 = t334 * t321;
  t840 = t122 * t344;
  t841 = t840 * t304;
  t847 = t785 * t6 + 0.3e1 * t277;
  t848 = t135 * t847;
  t852 = 0.1e1 / t39;
  t853 = t852 * sigma[0];
  t854 = t135 * t830;
  t858 = t309 * t321;
  t862 = t334 * t304;
  t867 = t29 * t34 * t19;
  t868 = t6 * sigma[0];
  t869 = t345 * t830;
  t870 = t868 * t869;
  t873 = t113 * t847;
  t879 = 0.1e1 / t44 / t326 / rho[0];
  t885 = t328 * t134;
  t886 = t885 * t115;
  t890 = t344 * t304;
  t891 = t890 * t96;
  t899 = t344 * t115 * t321;
  t904 = t134 * t115 * t321;
  t908 = 0.1e1 / t131;
  t909 = t908 * sigma[0];
  t910 = t113 * t830;
  t914 = t309 * t304;
  t919 = t50 * t115 * t321;
  t923 = t328 * t50;
  t924 = t923 * t115;
  t928 = 0.4e1 / 0.81e2 * t826 * t833 - 0.8e1 / 0.27e2 * t129 * t132 * t836 + 0.32e2 / 0.81e2 * t341 * t342 * t841 + t129 * t132 * t848 / 0.27e2 + 0.22e2 / 0.243e3 * t129 * t853 * t854 + 0.16e2 / 0.27e2 * t111 * t112 * t858 - 0.8e1 / 0.9e1 * t129 * t314 * t862 - 0.4e1 / 0.27e2 * t867 * t870 - 0.2e1 / 0.27e2 * t111 * t112 * t873 + 0.616e3 / 0.243e3 * t35 * t41 * sigma[0] * t879 * t50 + 0.88e2 / 0.81e2 * t129 * t132 * t886 - 0.8e1 / 0.81e2 * t867 * t487 * t891 - 0.8e1 / 0.81e2 * t341 * t868 * t346 - 0.4e1 / 0.27e2 * t341 * t487 * t899 + t129 * t471 * t904 / 0.3e1 + 0.4e1 / 0.243e3 * t111 * t909 * t910 + 0.16e2 / 0.81e2 * t111 * t303 * t914 - 0.2e1 / 0.27e2 * t111 * t461 * t919 - 0.176e3 / 0.81e2 * t111 * t112 * t924;
  t933 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t790 * t55 - 0.3e1 / 0.8e1 * t796 - 0.9e1 / 0.8e1 * t5 * t282 * t140 + t803 / 0.4e1 - 0.3e1 / 0.4e1 * t806 - 0.9e1 / 0.8e1 * t5 * t100 * t354 - t816 + t818 / 0.4e1 - 0.3e1 / 0.8e1 * t821 - 0.3e1 / 0.8e1 * t5 * t27 * t928);
  t935 = 0.1e1 / t360 / t64;
  t936 = t362 * t148;
  t939 = t361 * t148;
  t942 = t61 * t781;
  t945 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t273 - 0.6e1 * t942);
  t949 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t935 * t936 + 0.4e1 / 0.3e1 * t939 * t368 + 0.4e1 / 0.3e1 * t66 * t945);
  t950 = t949 * t26;
  t954 = t372 * t105;
  t956 = t5 * t954 * t87;
  t961 = t151 * t294;
  t963 = t5 * t961 * t87;
  t966 = t5 * t377 * t178;
  t971 = t68 * t812;
  t974 = 0.5e1 / 0.36e2 * t5 * t971 * t87;
  t976 = t5 * t384 * t178;
  t979 = t5 * t156 * t425;
  t981 = 0.1e1 / t169;
  t982 = t981 * sigma[2];
  t983 = t393 * t163;
  t984 = t161 * t983;
  t988 = 0.1e1 / t71;
  t989 = t988 * sigma[2];
  t990 = t173 * t983;
  t994 = t82 * t163;
  t995 = t994 * t405;
  t1000 = t29 * t34 * t64;
  t1001 = t6 * sigma[2];
  t1002 = t416 * t983;
  t1003 = t1001 * t1002;
  t1006 = t172 * t163;
  t1007 = t1006 * t405;
  t1013 = t945 * t6 + 0.3e1 * t368;
  t1014 = t161 * t1013;
  t1018 = t415 * t393;
  t1019 = t1018 * t148;
  t1026 = t33 * t410;
  t1028 = t823 * t1026 * t92;
  t1029 = t171 * t171;
  t1030 = 0.1e1 / t1029;
  t1031 = t79 * t1030;
  t1033 = t983 * t37 * t71;
  t1034 = t1031 * t1033;
  t1037 = t415 * t163;
  t1038 = t1037 * t405;
  t1042 = t173 * t1013;
  t1046 = 0.4e1 / 0.243e3 * t111 * t982 * t984 + 0.22e2 / 0.243e3 * t129 * t989 * t990 - 0.2e1 / 0.27e2 * t111 * t531 * t995 - 0.4e1 / 0.27e2 * t1000 * t1003 + t129 * t537 * t1007 / 0.3e1 - 0.2e1 / 0.27e2 * t111 * t160 * t1014 - 0.8e1 / 0.81e2 * t1000 * t559 * t1019 - 0.8e1 / 0.81e2 * t412 * t1001 * t417 + 0.4e1 / 0.81e2 * t1028 * t1034 - 0.4e1 / 0.27e2 * t412 * t559 * t1038 + t129 * t170 * t1042 / 0.27e2;
  t1051 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t950 * t87 - 0.3e1 / 0.8e1 * t956 - 0.9e1 / 0.8e1 * t5 * t373 * t178 + t963 / 0.4e1 - 0.3e1 / 0.4e1 * t966 - 0.9e1 / 0.8e1 * t5 * t152 * t425 - t974 + t976 / 0.4e1 - 0.3e1 / 0.8e1 * t979 - 0.3e1 / 0.8e1 * t5 * t69 * t1046);
  tv3rho30 = 0.3e1 * t359 + 0.3e1 * t430 + t6 * (t933 + t1051);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1054 = 0.2e1 * t502;
  t1055 = 0.2e1 * t574;
  t1056 = t441 * t105;
  t1059 = t5 * t1056 * t55 / 0.4e1;
  t1060 = t190 * t294;
  t1062 = t5 * t1060 * t55;
  t1066 = t5 * t286 * t205 / 0.4e1;
  t1068 = t5 * t295 * t205;
  t1075 = t5 * t106 * t497 / 0.4e1;
  t1076 = t33 * t19;
  t1078 = t823 * t1076 * t92;
  t1079 = t47 * t344;
  t1080 = t196 * t115;
  t1081 = t1080 * t96;
  t1082 = t1079 * t1081;
  t1085 = t868 * t46;
  t1089 = t909 * t46;
  t1090 = t462 * t304;
  t1094 = t303 * t122;
  t1099 = t37 * t39;
  t1100 = t196 * t304 * t1099;
  t1101 = t829 * t1100;
  t1104 = 0.2e1 * t273;
  t1105 = 0.6e1 * t782;
  t1107 = my_piecewise5(t10, 0, t14, 0, t1104 - t1105);
  t1109 = 0.2e1 * t437;
  t1110 = t1107 * t6 + t1109 + t277;
  t1111 = t135 * t1110;
  t1115 = t309 * t478;
  t1119 = t113 * t1110;
  t1123 = t334 * t478;
  t1127 = t885 * t196;
  t1132 = t342 * t122;
  t1136 = t344 * t478;
  t1137 = t1136 * t115;
  t1141 = t488 * t321;
  t1145 = t923 * t196;
  t1149 = t314 * t122;
  t1153 = t134 * t478;
  t1154 = t1153 * t115;
  t1158 = t472 * t321;
  t1162 = t488 * t304;
  t1163 = t1085 * t1162;
  t1166 = t50 * t478;
  t1167 = t1166 * t115;
  t1171 = t462 * t321;
  t1175 = t853 * t46;
  t1176 = t472 * t304;
  t1180 = 0.64e2 / 0.243e3 * t341 * t1132 * t489 - 0.8e1 / 0.81e2 * t341 * t487 * t1137 - 0.4e1 / 0.81e2 * t341 * t487 * t1141 - 0.176e3 / 0.243e3 * t111 * t112 * t1145 - 0.16e2 / 0.27e2 * t129 * t1149 * t473 + 0.2e1 / 0.9e1 * t129 * t471 * t1154 + t129 * t471 * t1158 / 0.9e1 - 0.4e1 / 0.27e2 * t867 * t1163 - 0.4e1 / 0.81e2 * t111 * t461 * t1167 - 0.2e1 / 0.81e2 * t111 * t461 * t1171 + 0.22e2 / 0.243e3 * t129 * t1175 * t1176;
  t1181 = -0.8e1 / 0.81e2 * t1078 * t1082 - 0.8e1 / 0.81e2 * t341 * t1085 * t489 + 0.4e1 / 0.243e3 * t111 * t1089 * t1090 + 0.32e2 / 0.243e3 * t111 * t1094 * t463 + 0.4e1 / 0.81e2 * t826 * t1101 + t129 * t132 * t1111 / 0.27e2 + 0.32e2 / 0.81e2 * t111 * t112 * t1115 - 0.2e1 / 0.27e2 * t111 * t112 * t1119 - 0.16e2 / 0.81e2 * t129 * t132 * t1123 + 0.88e2 / 0.243e3 * t129 * t132 * t1127 + t1180;
  t1185 = t773 * t187;
  t1188 = t268 * t437;
  t1196 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1185 * t269 + 0.8e1 / 0.9e1 * t1188 * t96 + 0.4e1 / 0.9e1 * t433 * t277 + 0.4e1 / 0.3e1 * t23 * t1107);
  t1197 = t1196 * t26;
  t1206 = t5 * t446 * t140 / 0.4e1;
  t1218 = -t1059 + t1062 / 0.12e2 - t1066 + t1068 / 0.12e2 - 0.3e1 / 0.4e1 * t5 * t100 * t497 - t1075 - 0.3e1 / 0.8e1 * t5 * t27 * t1181 - 0.3e1 / 0.8e1 * t5 * t1197 * t55 - 0.3e1 / 0.4e1 * t5 * t442 * t140 - t1206 - 0.3e1 / 0.8e1 * t5 * t191 * t354 - 0.3e1 / 0.8e1 * t5 * t282 * t205 - t806 / 0.4e1 + t818 / 0.6e1 - t821 / 0.8e1 - t796 / 0.8e1 + t803 / 0.6e1 - t816;
  t1219 = my_piecewise3(t1, 0, t1218);
  t1220 = t215 * t294;
  t1222 = t5 * t1220 * t87;
  t1226 = t5 * t377 * t238 / 0.4e1;
  t1228 = t5 * t384 * t238;
  t1230 = t511 * t105;
  t1233 = t5 * t1230 * t87 / 0.4e1;
  t1234 = t935 * t212;
  t1237 = t361 * t507;
  t1242 = 0.6e1 * t942;
  t1244 = my_piecewise5(t14, 0, t10, 0, -t1104 - t1242);
  t1248 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1234 * t362 + 0.8e1 / 0.9e1 * t1237 * t148 + 0.4e1 / 0.9e1 * t503 * t368 + 0.4e1 / 0.3e1 * t66 * t1244);
  t1249 = t1248 * t26;
  t1258 = t5 * t516 * t178 / 0.4e1;
  t1270 = t5 * t156 * t569 / 0.4e1;
  t1271 = t33 * t64;
  t1273 = t823 * t1271 * t92;
  t1274 = t79 * t415;
  t1275 = t221 * t163;
  t1276 = t1275 * t148;
  t1277 = t1274 * t1276;
  t1280 = t1001 * t78;
  t1284 = t982 * t78;
  t1285 = t532 * t393;
  t1290 = t37 * t71;
  t1291 = t221 * t393 * t1290;
  t1292 = t1031 * t1291;
  t1296 = 0.2e1 * t507;
  t1297 = t1244 * t6 + t1296 + t368;
  t1298 = t161 * t1297;
  t1302 = t549 * t405;
  t1306 = t554 * t393;
  t1310 = t554 * t405;
  t1314 = t228 * t415;
  t1315 = t1314 * t393;
  t1319 = t173 * t1297;
  t1323 = t549 * t393;
  t1327 = t415 * t544;
  t1328 = t1327 * t163;
  t1332 = t560 * t405;
  t1336 = t82 * t544;
  t1337 = t1336 * t163;
  t1341 = t532 * t405;
  t1345 = t989 * t78;
  t1346 = t538 * t393;
  t1350 = t172 * t544;
  t1351 = t1350 * t163;
  t1355 = t538 * t405;
  t1359 = t560 * t393;
  t1360 = t1280 * t1359;
  t1363 = -0.8e1 / 0.81e2 * t1273 * t1277 - 0.8e1 / 0.81e2 * t412 * t1280 * t561 + 0.4e1 / 0.243e3 * t111 * t1284 * t1285 + 0.4e1 / 0.81e2 * t1028 * t1292 - 0.2e1 / 0.27e2 * t111 * t160 * t1298 + 0.16e2 / 0.81e2 * t111 * t160 * t1302 - 0.8e1 / 0.27e2 * t129 * t398 * t1306 - 0.8e1 / 0.81e2 * t129 * t170 * t1310 + 0.32e2 / 0.243e3 * t412 * t413 * t1315 + t129 * t170 * t1319 / 0.27e2 + 0.16e2 / 0.243e3 * t111 * t392 * t1323 - 0.8e1 / 0.81e2 * t412 * t559 * t1328 - 0.4e1 / 0.81e2 * t412 * t559 * t1332 - 0.4e1 / 0.81e2 * t111 * t531 * t1337 - 0.2e1 / 0.81e2 * t111 * t531 * t1341 + 0.22e2 / 0.243e3 * t129 * t1345 * t1346 + 0.2e1 / 0.9e1 * t129 * t537 * t1351 + t129 * t537 * t1355 / 0.9e1 - 0.4e1 / 0.27e2 * t1000 * t1360;
  t1372 = t1222 / 0.12e2 - t1226 + t1228 / 0.12e2 - t1233 - 0.3e1 / 0.8e1 * t5 * t1249 * t87 - 0.3e1 / 0.4e1 * t5 * t512 * t178 - t1258 - 0.3e1 / 0.8e1 * t5 * t216 * t425 - 0.3e1 / 0.8e1 * t5 * t373 * t238 - 0.3e1 / 0.4e1 * t5 * t152 * t569 - t1270 - 0.3e1 / 0.8e1 * t5 * t69 * t1363 - t966 / 0.4e1 + t976 / 0.6e1 - t979 / 0.8e1 - t956 / 0.8e1 + t963 / 0.6e1 - t974;
  t1373 = my_piecewise3(t60, 0, t1372);
  tv3rho31 = t359 + t430 + t1054 + t1055 + t6 * (t1219 + t1373);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1376 = t773 * t579;
  t1381 = t268 * t584;
  t1385 = my_piecewise5(t10, 0, t14, 0, -t1104 - t1105);
  t1389 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1376 * t96 + 0.8e1 / 0.9e1 * t433 * t437 + 0.4e1 / 0.9e1 * t1381 * t96 + 0.4e1 / 0.3e1 * t23 * t1385);
  t1390 = t1389 * t26;
  t1394 = t588 * t105;
  t1396 = t5 * t1394 * t55;
  t1406 = t5 * t446 * t205;
  t1418 = t5 * t106 * t622;
  t1420 = t50 * t598;
  t1421 = t1420 * t115;
  t1425 = t309 * t598;
  t1429 = t134 * t598;
  t1430 = t1429 * t115;
  t1434 = t462 * t478;
  t1438 = t334 * t598;
  t1442 = t344 * t598;
  t1443 = t1442 * t115;
  t1444 = t1085 * t1443;
  t1447 = t472 * t478;
  t1451 = t50 * t609;
  t1452 = t1451 * t115;
  t1456 = t309 * t609;
  t1460 = t134 * t609;
  t1461 = t1460 * t115;
  t1466 = t1385 * t6 + t1109 + t584;
  t1467 = t113 * t1466;
  t1471 = t1442 * t96;
  t1477 = 0.8e1 / 0.81e2 * t341 * t868 * t614;
  t1478 = t840 * t598;
  t1482 = t598 * t37;
  t1483 = t39 * t115;
  t1484 = t1482 * t1483;
  t1485 = t829 * t1484;
  t1488 = t488 * t478;
  t1492 = t334 * t609;
  t1496 = t344 * t609;
  t1497 = t1496 * t115;
  t1501 = t135 * t1466;
  t1505 = 0.4e1 / 0.243e3 * t111 * t1089 * t1421 + 0.16e2 / 0.243e3 * t111 * t303 * t1425 + 0.22e2 / 0.243e3 * t129 * t1175 * t1430 - 0.4e1 / 0.81e2 * t111 * t461 * t1434 - 0.8e1 / 0.27e2 * t129 * t314 * t1438 - 0.4e1 / 0.27e2 * t867 * t1444 + 0.2e1 / 0.9e1 * t129 * t471 * t1447 - 0.2e1 / 0.81e2 * t111 * t461 * t1452 + 0.16e2 / 0.81e2 * t111 * t112 * t1456 + t129 * t471 * t1461 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t1467 - 0.8e1 / 0.81e2 * t867 * t487 * t1471 - t1477 + 0.32e2 / 0.243e3 * t341 * t342 * t1478 + 0.4e1 / 0.81e2 * t826 * t1485 - 0.8e1 / 0.81e2 * t341 * t487 * t1488 - 0.8e1 / 0.81e2 * t129 * t132 * t1492 - 0.4e1 / 0.81e2 * t341 * t487 * t1497 + t129 * t132 * t1501 / 0.27e2;
  t1509 = -0.3e1 / 0.8e1 * t5 * t1390 * t55 - t1396 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t589 * t140 - t1059 + t1062 / 0.6e1 - t1206 - 0.3e1 / 0.4e1 * t5 * t442 * t205 - t1406 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t191 * t497 + t803 / 0.12e2 - t816 + t818 / 0.12e2 - t1066 + t1068 / 0.6e1 - t1075 - 0.3e1 / 0.8e1 * t5 * t100 * t622 - t1418 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1505;
  t1510 = my_piecewise3(t1, 0, t1509);
  t1511 = t935 * t628;
  t1516 = t361 * t633;
  t1520 = my_piecewise5(t14, 0, t10, 0, t1104 - t1242);
  t1524 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1511 * t148 + 0.8e1 / 0.9e1 * t503 * t507 + 0.4e1 / 0.9e1 * t1516 * t148 + 0.4e1 / 0.3e1 * t66 * t1520);
  t1525 = t1524 * t26;
  t1529 = t637 * t105;
  t1531 = t5 * t1529 * t87;
  t1541 = t5 * t516 * t238;
  t1553 = t5 * t156 * t687;
  t1555 = t82 * t647;
  t1556 = t1555 * t163;
  t1560 = t172 * t647;
  t1561 = t1560 * t163;
  t1565 = t532 * t544;
  t1569 = t392 * t228;
  t1573 = t398 * t228;
  t1577 = t549 * t544;
  t1581 = t415 * t647;
  t1582 = t1581 * t163;
  t1583 = t1280 * t1582;
  t1586 = t538 * t544;
  t1590 = t82 * t662;
  t1591 = t1590 * t163;
  t1595 = t172 * t662;
  t1596 = t1595 * t163;
  t1602 = t1520 * t6 + t1296 + t633;
  t1603 = t161 * t1602;
  t1607 = t669 * t82;
  t1608 = t1607 * t163;
  t1612 = t669 * t172;
  t1613 = t1612 * t163;
  t1617 = t413 * t228;
  t1621 = t554 * t544;
  t1625 = t1581 * t148;
  t1631 = 0.8e1 / 0.81e2 * t412 * t1001 * t679;
  t1632 = t647 * t37;
  t1633 = t71 * t163;
  t1634 = t1632 * t1633;
  t1635 = t1031 * t1634;
  t1638 = t560 * t544;
  t1642 = t415 * t662;
  t1643 = t1642 * t163;
  t1647 = t173 * t1602;
  t1651 = -0.2e1 / 0.27e2 * t111 * t160 * t1603 - 0.176e3 / 0.243e3 * t111 * t160 * t1608 + 0.88e2 / 0.243e3 * t129 * t170 * t1613 + 0.64e2 / 0.243e3 * t412 * t1617 * t561 - 0.16e2 / 0.81e2 * t129 * t170 * t1621 - 0.8e1 / 0.81e2 * t1000 * t559 * t1625 - t1631 + 0.4e1 / 0.81e2 * t1028 * t1635 - 0.8e1 / 0.81e2 * t412 * t559 * t1638 - 0.4e1 / 0.81e2 * t412 * t559 * t1643 + t129 * t170 * t1647 / 0.27e2;
  t1652 = 0.4e1 / 0.243e3 * t111 * t1284 * t1556 + 0.22e2 / 0.243e3 * t129 * t1345 * t1561 - 0.4e1 / 0.81e2 * t111 * t531 * t1565 + 0.32e2 / 0.243e3 * t111 * t1569 * t533 - 0.16e2 / 0.27e2 * t129 * t1573 * t539 + 0.32e2 / 0.81e2 * t111 * t160 * t1577 - 0.4e1 / 0.27e2 * t1000 * t1583 + 0.2e1 / 0.9e1 * t129 * t537 * t1586 - 0.2e1 / 0.81e2 * t111 * t531 * t1591 + t129 * t537 * t1596 / 0.9e1 + t1651;
  t1656 = -0.3e1 / 0.8e1 * t5 * t1525 * t87 - t1531 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t638 * t178 - t1233 + t1222 / 0.6e1 - t1258 - 0.3e1 / 0.4e1 * t5 * t512 * t238 - t1541 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t216 * t569 + t963 / 0.12e2 - t974 + t976 / 0.12e2 - t1226 + t1228 / 0.6e1 - t1270 - 0.3e1 / 0.8e1 * t5 * t152 * t687 - t1553 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t69 * t1652;
  t1657 = my_piecewise3(t60, 0, t1656);
  tv3rho32 = t1054 + t1055 + t627 + t692 + t6 * (t1510 + t1657);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1662 = t579 * t187;
  t1669 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t273 - 0.6e1 * t782);
  t1673 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t773 * t1662 + 0.4e1 / 0.3e1 * t433 * t584 + 0.4e1 / 0.3e1 * t23 * t1669);
  t1674 = t1673 * t26;
  t1689 = t598 * t196;
  t1690 = t113 * t1689;
  t1694 = t135 * t1689;
  t1698 = t462 * t609;
  t1702 = t345 * t1689;
  t1703 = t868 * t1702;
  t1706 = t472 * t609;
  t1712 = t1669 * t6 + 0.3e1 * t584;
  t1713 = t113 * t1712;
  t1717 = t1442 * t187;
  t1718 = t487 * t1717;
  t1721 = t1689 * t37;
  t1722 = t1721 * t39;
  t1723 = t829 * t1722;
  t1726 = t488 * t609;
  t1730 = t135 * t1712;
  t1734 = 0.4e1 / 0.243e3 * t111 * t909 * t1690 + 0.22e2 / 0.243e3 * t129 * t853 * t1694 - 0.2e1 / 0.27e2 * t111 * t461 * t1698 - 0.4e1 / 0.27e2 * t867 * t1703 + t129 * t471 * t1706 / 0.3e1 - 0.2e1 / 0.27e2 * t111 * t112 * t1713 - 0.8e1 / 0.81e2 * t867 * t1718 - t1477 + 0.4e1 / 0.81e2 * t826 * t1723 - 0.4e1 / 0.27e2 * t341 * t487 * t1726 + t129 * t132 * t1730 / 0.27e2;
  t1739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1674 * t55 - 0.3e1 / 0.8e1 * t1396 - 0.9e1 / 0.8e1 * t5 * t589 * t205 + t1062 / 0.4e1 - 0.3e1 / 0.4e1 * t1406 - 0.9e1 / 0.8e1 * t5 * t191 * t622 - t816 + t1068 / 0.4e1 - 0.3e1 / 0.8e1 * t1418 - 0.3e1 / 0.8e1 * t5 * t27 * t1734);
  t1740 = t628 * t212;
  t1747 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t273 - 0.6e1 * t942);
  t1751 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t935 * t1740 + 0.4e1 / 0.3e1 * t503 * t633 + 0.4e1 / 0.3e1 * t66 * t1747);
  t1752 = t1751 * t26;
  t1767 = t560 * t662;
  t1771 = t1581 * t212;
  t1772 = t559 * t1771;
  t1775 = t549 * t647;
  t1779 = t532 * t662;
  t1783 = t1607 * t221;
  t1787 = t538 * t662;
  t1791 = t647 * t221;
  t1792 = t161 * t1791;
  t1796 = t1791 * t37;
  t1797 = t1796 * t71;
  t1798 = t1031 * t1797;
  t1801 = t1612 * t221;
  t1805 = t554 * t662;
  t1809 = t1314 * t647;
  t1815 = t1747 * t6 + 0.3e1 * t633;
  t1816 = t173 * t1815;
  t1820 = t173 * t1791;
  t1824 = t549 * t662;
  t1828 = t554 * t647;
  t1832 = t416 * t1791;
  t1833 = t1001 * t1832;
  t1836 = t161 * t1815;
  t1842 = 0.1e1 / t76 / t667 / rho[1];
  t1848 = -0.4e1 / 0.27e2 * t412 * t559 * t1767 - 0.8e1 / 0.81e2 * t1000 * t1772 + 0.16e2 / 0.81e2 * t111 * t392 * t1775 - 0.2e1 / 0.27e2 * t111 * t531 * t1779 - 0.176e3 / 0.81e2 * t111 * t160 * t1783 + t129 * t537 * t1787 / 0.3e1 + 0.4e1 / 0.243e3 * t111 * t982 * t1792 - t1631 + 0.4e1 / 0.81e2 * t1028 * t1798 + 0.88e2 / 0.81e2 * t129 * t170 * t1801 - 0.8e1 / 0.27e2 * t129 * t170 * t1805 + 0.32e2 / 0.81e2 * t412 * t413 * t1809 + t129 * t170 * t1816 / 0.27e2 + 0.22e2 / 0.243e3 * t129 * t989 * t1820 + 0.16e2 / 0.27e2 * t111 * t160 * t1824 - 0.8e1 / 0.9e1 * t129 * t398 * t1828 - 0.4e1 / 0.27e2 * t1000 * t1833 - 0.2e1 / 0.27e2 * t111 * t160 * t1836 + 0.616e3 / 0.243e3 * t35 * t73 * sigma[2] * t1842 * t82;
  t1853 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1752 * t87 - 0.3e1 / 0.8e1 * t1531 - 0.9e1 / 0.8e1 * t5 * t638 * t238 + t1222 / 0.4e1 - 0.3e1 / 0.4e1 * t1541 - 0.9e1 / 0.8e1 * t5 * t216 * t687 - t974 + t1228 / 0.4e1 - 0.3e1 / 0.8e1 * t1553 - 0.3e1 / 0.8e1 * t5 * t69 * t1848);
  tv3rho33 = 0.3e1 * t627 + 0.3e1 * t692 + t6 * (t1739 + t1853);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1857 = t714 * t350;
  t1860 = t701 * t705;
  t1862 = t701 * t710;
  t1864 = t701 * t715;
  t1866 = t704 * t322;
  t1869 = t713 * t130;
  t1870 = t1869 * t315;
  t1875 = t250 * t40 * t328 * t50;
  t1878 = t714 * t335;
  t1881 = t695 * t700;
  t1882 = t1881 * t253;
  t1891 = t294 * params->gamma * t32;
  t1892 = t246 * t1891;
  t1894 = t1892 * t253 / 0.72e2;
  t1895 = t250 * t302;
  t1896 = t1895 * t305;
  t1899 = t704 * t310;
  t1902 = t26 * t92;
  t1904 = t1902 * params->gamma * t32;
  t1905 = t246 * t1904;
  t1906 = t824 * t346;
  t1909 = t4 * t281;
  t1910 = t1909 * t248;
  t1913 = -t249 * t1857 / 0.24e2 + t1860 / 0.18e2 - t1862 / 0.9e1 - t1864 / 0.36e2 + t249 * t1866 / 0.12e2 - t249 * t1870 / 0.8e1 + 0.11e2 / 0.18e2 * t249 * t1875 + 0.2e1 / 0.9e1 * t249 * t1878 + t1882 / 0.24e2 + t696 * t705 / 0.6e1 - t696 * t710 / 0.3e1 - t696 * t715 / 0.12e2 - t1894 + t249 * t1896 / 0.36e2 - 0.4e1 / 0.9e1 * t249 * t1899 + t1905 * t1906 / 0.18e2 + t1910 * t253 / 0.16e2;
  t1914 = my_piecewise3(t1, 0, t1913);
  tv3rho2sigma0 = t6 * t1914 + 0.2e1 * t719;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1917 = t4 * t372;
  t1918 = t1917 * t248;
  t1921 = t721 * t700;
  t1922 = t1921 * t261;
  t1928 = t257 * t1891;
  t1930 = t1928 * t261 / 0.72e2;
  t1931 = t725 * t729;
  t1933 = t725 * t733;
  t1935 = t250 * t391;
  t1936 = t1935 * t394;
  t1939 = t713 * t168;
  t1940 = t1939 * t399;
  t1943 = t728 * t406;
  t1946 = t257 * t1904;
  t1947 = t1026 * t417;
  t1950 = t732 * t421;
  t1953 = t1918 * t261 / 0.16e2 + t1922 / 0.24e2 + t722 * t729 / 0.6e1 - t722 * t733 / 0.12e2 - t1930 + t1931 / 0.18e2 - t1933 / 0.36e2 + t258 * t1936 / 0.36e2 - t258 * t1940 / 0.8e1 + t258 * t1943 / 0.12e2 + t1946 * t1947 / 0.18e2 - t258 * t1950 / 0.24e2;
  t1954 = my_piecewise3(t60, 0, t1953);
  tv3rho2sigma2 = t6 * t1954 + 0.2e1 * t737;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1956 = t4 * t441;
  t1957 = t1956 * t248;
  t1960 = t739 * t700;
  t1961 = t1960 * t253;
  t1976 = t701 * t743;
  t1980 = params->gamma * t32 * t33;
  t1981 = t246 * t26 * t1980;
  t1982 = t37 * t302;
  t1983 = t1982 * t46;
  t1984 = t1983 * t463;
  t1987 = t704 * t467;
  t1990 = t36 * t130;
  t1991 = t1990 * t46;
  t1992 = t1991 * t473;
  t1995 = t704 * t479;
  t2000 = t701 * t746;
  t2002 = t714 * t483;
  t2005 = t824 * t46;
  t2006 = t2005 * t489;
  t2009 = t714 * t493;
  t2012 = t696 * t743 / 0.12e2 + t1976 / 0.36e2 + t1981 * t1984 / 0.36e2 - 0.2e1 / 0.9e1 * t249 * t1987 - t1981 * t1992 / 0.8e1 + t249 * t1995 / 0.12e2 - t696 * t746 / 0.24e2 - t2000 / 0.72e2 + t249 * t2002 / 0.9e1 + t1905 * t2006 / 0.18e2 - t249 * t2009 / 0.24e2;
  t2014 = my_piecewise3(t1, 0, t1957 * t253 / 0.16e2 + t1961 / 0.48e2 + t740 * t705 / 0.12e2 - t740 * t710 / 0.6e1 - t740 * t715 / 0.24e2 + t1882 / 0.48e2 - t1894 + t1860 / 0.36e2 - t1862 / 0.18e2 - t1864 / 0.72e2 + t2012);
  tv3rho2sigma3 = t6 * t2014 + t719 + t750;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t2016 = t4 * t511;
  t2017 = t2016 * t248;
  t2020 = t752 * t700;
  t2021 = t2020 * t261;
  t2032 = t725 * t756;
  t2036 = t257 * t26 * t1980;
  t2037 = t37 * t391;
  t2038 = t2037 * t78;
  t2039 = t2038 * t533;
  t2042 = t36 * t168;
  t2043 = t2042 * t78;
  t2044 = t2043 * t539;
  t2047 = t728 * t545;
  t2052 = t725 * t761;
  t2054 = t728 * t550;
  t2057 = t732 * t555;
  t2062 = t725 * t764;
  t2064 = t1026 * t78;
  t2065 = t2064 * t561;
  t2068 = t732 * t565;
  t2071 = t2036 * t2039 / 0.36e2 - t2036 * t2044 / 0.8e1 + t258 * t2047 / 0.12e2 - t722 * t761 / 0.6e1 - t2052 / 0.18e2 - 0.2e1 / 0.9e1 * t258 * t2054 + t258 * t2057 / 0.9e1 - t722 * t764 / 0.24e2 - t2062 / 0.72e2 + t1946 * t2065 / 0.18e2 - t258 * t2068 / 0.24e2;
  t2073 = my_piecewise3(t60, 0, t2017 * t261 / 0.16e2 + t2021 / 0.48e2 + t753 * t729 / 0.12e2 - t753 * t733 / 0.24e2 + t1922 / 0.48e2 - t1930 + t1931 / 0.36e2 - t1933 / 0.72e2 + t722 * t756 / 0.12e2 + t2032 / 0.36e2 + t2071);
  tv3rho2sigma5 = t6 * t2073 + t737 + t768;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t2076 = t4 * t588;
  t2077 = t2076 * t248;
  t2087 = t1895 * t599;
  t2090 = t1869 * t603;
  t2093 = t704 * t610;
  t2096 = t824 * t614;
  t2099 = t714 * t618;
  t2102 = t2077 * t253 / 0.16e2 + t1961 / 0.24e2 + t740 * t743 / 0.6e1 - t740 * t746 / 0.12e2 - t1894 + t1976 / 0.18e2 - t2000 / 0.36e2 + t249 * t2087 / 0.36e2 - t249 * t2090 / 0.8e1 + t249 * t2093 / 0.12e2 + t1905 * t2096 / 0.18e2 - t249 * t2099 / 0.24e2;
  t2103 = my_piecewise3(t1, 0, t2102);
  tv3rho2sigma6 = t6 * t2103 + 0.2e1 * t750;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2106 = t728 * t663;
  t2109 = t1939 * t656;
  t2114 = t250 * t72 * t669 * t82;
  t2117 = t732 * t675;
  t2120 = t732 * t683;
  t2131 = t1935 * t648;
  t2134 = t728 * t652;
  t2139 = t4 * t637;
  t2140 = t2139 * t248;
  t2143 = t1026 * t679;
  t2146 = t258 * t2106 / 0.12e2 - t258 * t2109 / 0.8e1 + 0.11e2 / 0.18e2 * t258 * t2114 + 0.2e1 / 0.9e1 * t258 * t2117 - t258 * t2120 / 0.24e2 + t753 * t756 / 0.6e1 - t753 * t761 / 0.3e1 - t753 * t764 / 0.12e2 - t2052 / 0.9e1 + t2021 / 0.24e2 - t1930 + t258 * t2131 / 0.36e2 - 0.4e1 / 0.9e1 * t258 * t2134 + t2032 / 0.18e2 - t2062 / 0.36e2 + t2140 * t261 / 0.16e2 + t1946 * t2143 / 0.18e2;
  t2147 = my_piecewise3(t60, 0, t2146);
  tv3rho2sigma8 = t6 * t2147 + 0.2e1 * t768;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_output_variables *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t10;
  double t11, t14, t15, t16, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t46, t47, t49;
  double t50, t51, t55, t59, t60, t61, t63, t64;
  double t65, t66, t68, t69, t70, t71, t72, t73;
  double t74, t75, t76, t78, t79, t81, t82, t83;
  double t87, t91, tzk0;

  double t92, t93, t94, t96, t99, t100, t104, t105;
  double t106, t109, t111, t112, t113, t115, t116, t122;
  double t123, t129, t130, t131, t132, t133, t134, t135;
  double t136, t140, t145, t146, t148, t151, t152, t156;
  double t159, t160, t161, t163, t164, t168, t169, t170;
  double t171, t172, t173, t174, t178, t183, tvrho0, t187;
  double t190, t191, t196, t197, t201, t205, t210, t212;
  double t215, t216, t221, t222, t228, t229, t234, t238;
  double t243, tvrho1, t246, t248, t249, t250, t253, t256;
  double tvsigma0, tvsigma1, t257, t258, t261, t264, tvsigma2;

  double t267, t268, t269, t272, t273, t274, t277, t281;
  double t282, t286, t288, t294, t295, t298, t300, t302;
  double t303, t304, t305, t309, t310, t314, t315, t321;
  double t322, t326, t328, t334, t335, t339, t341, t342;
  double t344, t345, t346, t347, t350, t354, t359, t360;
  double t361, t362, t365, t368, t372, t373, t377, t379;
  double t384, t387, t389, t391, t392, t393, t394, t398;
  double t399, t405, t406, t410, t412, t413, t415, t416;
  double t417, t418, t421, t425, t430, tv2rho20, t433, t437;
  double t441, t442, t446, t448, t459, t461, t462, t463;
  double t467, t471, t472, t473, t478, t479, t483, t487;
  double t488, t489, t490, t493, t497, t502, t503, t507;
  double t511, t512, t516, t518, t529, t531, t532, t533;
  double t537, t538, t539, t544, t545, t549, t550, t554;
  double t555, t559, t560, t561, t562, t565, t569, t574;
  double tv2rho21, t579, t584, t588, t589, t598, t599, t603;
  double t609, t610, t614, t615, t618, t622, t627, t628;
  double t633, t637, t638, t647, t648, t652, t656, t662;
  double t663, t667, t669, t675, t679, t680, t683, t687;
  double t692, tv2rho22, t695, t696, t700, t701, t703, t704;
  double t705, t710, t713, t714, t715, t719, tv2rhosigma0, tv2rhosigma1;
  double t721, t722, t725, t727, t728, t729, t732, t733;
  double t737, tv2rhosigma2, t739, t740, t743, t746, t750, tv2rhosigma3;
  double tv2rhosigma4, t752, t753, t756, t761, t764, t768, tv2rhosigma5;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;

  double t773, t774, t777, t780, t781, t782, t785, t789;
  double t790, t794, t796, t801, t803, t806, t812, t813;
  double t816, t818, t821, t823, t824, t826, t827, t828;
  double t829, t830, t831, t832, t833, t836, t840, t841;
  double t847, t848, t852, t853, t854, t858, t862, t867;
  double t868, t869, t870, t873, t879, t885, t886, t890;
  double t891, t899, t904, t908, t909, t910, t914, t919;
  double t923, t924, t928, t933, t935, t936, t939, t942;
  double t945, t949, t950, t954, t956, t961, t963, t966;
  double t971, t974, t976, t979, t981, t982, t983, t984;
  double t988, t989, t990, t994, t995, t1000, t1001, t1002;
  double t1003, t1006, t1007, t1013, t1014, t1018, t1019, t1026;
  double t1028, t1029, t1030, t1031, t1033, t1034, t1037, t1038;
  double t1042, t1046, t1051, tv3rho30, t1054, t1055, t1056, t1059;
  double t1060, t1062, t1066, t1068, t1075, t1076, t1078, t1079;
  double t1080, t1081, t1082, t1085, t1089, t1090, t1094, t1099;
  double t1100, t1101, t1104, t1105, t1107, t1109, t1110, t1111;
  double t1115, t1119, t1123, t1127, t1132, t1136, t1137, t1141;
  double t1145, t1149, t1153, t1154, t1158, t1162, t1163, t1166;
  double t1167, t1171, t1175, t1176, t1180, t1181, t1185, t1188;
  double t1196, t1197, t1206, t1218, t1219, t1220, t1222, t1226;
  double t1228, t1230, t1233, t1234, t1237, t1242, t1244, t1248;
  double t1249, t1258, t1270, t1271, t1273, t1274, t1275, t1276;
  double t1277, t1280, t1284, t1285, t1290, t1291, t1292, t1296;
  double t1297, t1298, t1302, t1306, t1310, t1314, t1315, t1319;
  double t1323, t1327, t1328, t1332, t1336, t1337, t1341, t1345;
  double t1346, t1350, t1351, t1355, t1359, t1360, t1363, t1372;
  double t1373, tv3rho31, t1376, t1381, t1385, t1389, t1390, t1394;
  double t1396, t1406, t1418, t1420, t1421, t1425, t1429, t1430;
  double t1434, t1438, t1442, t1443, t1444, t1447, t1451, t1452;
  double t1456, t1460, t1461, t1466, t1467, t1471, t1477, t1478;
  double t1482, t1483, t1484, t1485, t1488, t1492, t1496, t1497;
  double t1501, t1505, t1509, t1510, t1511, t1516, t1520, t1524;
  double t1525, t1529, t1531, t1541, t1553, t1555, t1556, t1560;
  double t1561, t1565, t1569, t1573, t1577, t1581, t1582, t1583;
  double t1586, t1590, t1591, t1595, t1596, t1602, t1603, t1607;
  double t1608, t1612, t1613, t1617, t1621, t1625, t1631, t1632;
  double t1633, t1634, t1635, t1638, t1642, t1643, t1647, t1651;
  double t1652, t1656, t1657, tv3rho32, t1662, t1669, t1673, t1674;
  double t1689, t1690, t1694, t1698, t1702, t1703, t1706, t1712;
  double t1713, t1717, t1718, t1721, t1722, t1723, t1726, t1730;
  double t1734, t1739, t1740, t1747, t1751, t1752, t1767, t1771;
  double t1772, t1775, t1779, t1783, t1787, t1791, t1792, t1796;
  double t1797, t1798, t1801, t1805, t1809, t1815, t1816, t1820;
  double t1824, t1828, t1832, t1833, t1836, t1842, t1848, t1853;
  double tv3rho33, t1857, t1860, t1862, t1864, t1866, t1869, t1870;
  double t1875, t1878, t1881, t1882, t1891, t1892, t1894, t1895;
  double t1896, t1899, t1902, t1904, t1905, t1906, t1909, t1910;
  double t1913, t1914, tv3rho2sigma0, tv3rho2sigma1, t1917, t1918, t1921, t1922;
  double t1928, t1930, t1931, t1933, t1935, t1936, t1939, t1940;
  double t1943, t1946, t1947, t1950, t1953, t1954, tv3rho2sigma2, t1956;
  double t1957, t1960, t1961, t1976, t1980, t1981, t1982, t1983;
  double t1984, t1987, t1990, t1991, t1992, t1995, t2000, t2002;
  double t2005, t2006, t2009, t2012, t2014, tv3rho2sigma3, tv3rho2sigma4, t2016;
  double t2017, t2020, t2021, t2032, t2036, t2037, t2038, t2039;
  double t2042, t2043, t2044, t2047, t2052, t2054, t2057, t2062;
  double t2064, t2065, t2068, t2071, t2073, tv3rho2sigma5, t2076, t2077;
  double t2087, t2090, t2093, t2096, t2099, t2102, t2103, tv3rho2sigma6;
  double tv3rho2sigma7, t2106, t2109, t2114, t2117, t2120, t2131, t2134;
  double t2139, t2140, t2143, t2146, t2147, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  double t2153, t2157, t2161, t2164, t2168, t2170, t2173, t2220;
  double t2231, t2247, t2248, t2258, t2266, t2275, t2288, t2294;
  double t2295, t2298, t2301, t2306, t2311, t2329, t2336, t2341;
  double t2345, t2358, t2359, t2371, t2378, t2381, t2389, t2395;
  double t2400, t2407, t2408, t2414, t2422, t2431, t2437, t2439;
  double t2445, t2447, t2448, t2451, t2456, t2459, t2463, t2466;
  double t2467, t2473, t2478, t2481, t2485, t2494, t2500, t2502;
  double t2508, t2511, t2514, t2552, t2562, t2567, t2573, t2574;
  double t2579, t2581, t2591, t2604, t2608, t2618, t2619, t2629;
  double t2634, t2646, t2651, t2656, t2657, tv4rho40, t2665, t2668;
  double t2671, t2672, t2674, t2677, t2680, t2681, t2689, t2706;
  double t2707, t2709, t2712, t2742, t2751, t2760, t2764, t2769;
  double t2807, t2832, t2861, t2866, t2867, t2868, t2869, t2870;
  double t2877, t2890, t2891, t2900, t2919, t2920, t2921, t2928;
  double t2934, t2959, t2971, t2973, t2982, t2983, t2986, t2989;
  double t2990, t2992, t3002, t3004, t3006, t3007, t3009, t3012;
  double t3015, t3016, t3019, t3022, t3040, t3042, t3046, t3058;
  double t3073, t3075, t3099, t3120, t3121, t3125, t3126, t3127;
  double t3128, t3132, t3136, t3137, t3141, t3156, t3176, t3179;
  double t3180, t3181, t3188, t3215, t3222, t3231, t3278, t3286;
  double t3287, t3290, t3293, t3294, t3296, t3307, t3309, tv4rho41;
  double t3324, t3337, t3341, t3350, t3362, t3374, t3382, t3383;
  double t3417, t3423, t3437, t3446, t3496, t3529, t3559, t3568;
  double t3574, t3611, t3624, t3631, t3634, t3638, t3642, t3645;
  double t3648, t3650, t3668, t3670, t3675, t3687, t3691, t3695;
  double t3698, t3701, t3704, t3707, t3719, t3727, t3728, t3758;
  double t3768, t3785, t3794, t3830, t3844, t3857, t3864, t3890;
  double t3904, t3917, t3937, t3941, t3966, t3975, t3989, t4005;
  double t4010, t4028, t4030, tv4rho42, t4037, t4040, t4043, t4046;
  double t4064, t4068, t4098, t4139, t4141, t4147, t4185, t4222;
  double t4223, t4230, t4238, t4239, t4270, t4284, t4293, t4304;
  double t4306, t4323, t4372, t4374, t4377, t4431, t4483, t4484;
  double t4485, t4504, t4507, t4510, t4513, t4518, t4523, t4550;
  double t4574, t4589, t4592, t4596, t4599, t4604, t4615, t4617;
  double tv4rho43, t4622, t4674, t4675, t4691, t4718, t4721, t4730;
  double t4735, t4740, t4748, t4770, t4771, t4772, t4777, t4784;
  double t4788, t4802, t4844, t4871, t4885, t4894, t4935, t4952;
  double t4982, t4996, t4997, tv4rho44, t5006, t5008, t5010, t5012;
  double t5014, t5016, t5018, t5025, t5036, t5054, t5058, t5072;
  double t5074, t5077, t5079, t5095, t5097, t5098, t5100, t5102;
  double t5109, t5113, t5114, t5115, t5126, t5131, t5134, t5135;
  double t5138, tv4rho3sigma0, tv4rho3sigma1, t5141, t5154, t5161, t5171, t5173;
  double t5175, t5177, t5178, t5180, t5187, t5190, t5192, t5202;
  double t5205, t5206, t5212, t5216, t5218, t5224, t5226, tv4rho3sigma2;
  double t5228, t5233, t5239, t5241, t5259, t5260, t5271, t5279;
  double t5283, t5288, t5291, t5309, t5312, t5316, t5329, t5341;
  double t5343, t5351, t5359, t5361, t5367, t5376, t5384, t5387;
  double t5390, t5401, t5404, tv4rho3sigma3, tv4rho3sigma4, t5406, t5413, t5425;
  double t5427, t5442, t5444, t5446, t5447, t5459, t5461, t5475;
  double t5481, t5482, t5484, t5497, t5513, t5517, t5519, t5520;
  double t5522, t5530, t5540, t5549, t5550, t5553, t5557, t5561;
  double t5564, tv4rho3sigma5, t5603, t5607, t5609, t5613, t5627, t5632;
  double t5636, t5638, t5660, t5662, t5676, t5682, t5689, t5692;
  double tv4rho3sigma6, tv4rho3sigma7, t5736, t5757, t5759, t5761, t5763, t5765;
  double t5767, t5774, t5776, t5778, t5790, t5808, t5818, t5820;
  double t5822, t5835, t5840, t5843, tv4rho3sigma8, t5879, t5906, t5908;
  double tv4rho3sigma9, tv4rho3sigma10, t5938, t5966, t5989, t6012, t6015, tv4rho3sigma11;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, tv4rho2sigma26, tv4rho2sigma27;
  double tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215;
  double tv4rho2sigma216, tv4rho2sigma217, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, tv4rhosigma319, tv4sigma40, tv4sigma41;
  double tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, tv4sigma414;

  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t4 = 0.1e1 / t3;
  t5 = t2 * t4;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->gamma * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = M_CBRT2;
  t37 = t36 * t36;
  t38 = t19 * t6;
  t39 = POW_1_3(t38);
  t40 = t39 * t38;
  t41 = t37 * t40;
  t42 = rho[0] * rho[0];
  t43 = POW_1_3(rho[0]);
  t44 = t43 * t43;
  t46 = 0.1e1 / t44 / t42;
  t47 = sigma[0] * t46;
  t49 = t41 / 0.4e1 + params->delta;
  t50 = 0.1e1 / t49;
  t51 = t47 * t50;
  t55 = 0.1e1 - t35 * t41 * t51 / 0.18e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = -t16;
  t63 = my_piecewise5(t14, t11, t10, t15, t61 * t7);
  t64 = 0.1e1 + t63;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t22, t66 * t64);
  t69 = t68 * t26;
  t70 = t64 * t6;
  t71 = POW_1_3(t70);
  t72 = t71 * t70;
  t73 = t37 * t72;
  t74 = rho[1] * rho[1];
  t75 = POW_1_3(rho[1]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[2] * t78;
  t81 = t73 / 0.4e1 + params->delta;
  t82 = 0.1e1 / t81;
  t83 = t79 * t82;
  t87 = 0.1e1 - t35 * t73 * t83 / 0.18e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t69 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim->zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t96 = my_piecewise5(t10, 0, t14, 0, t7 - t94);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t111 = t29 * t34 * t37;
  t112 = t39 * sigma[0];
  t113 = t46 * t50;
  t115 = t96 * t6 + t18 + 0.1e1;
  t116 = t113 * t115;
  t122 = 0.1e1 / t44 / t42 / rho[0];
  t123 = sigma[0] * t122;
  t129 = t29 * t34 * t36;
  t130 = t39 * t39;
  t131 = t130 * t38;
  t132 = t131 * sigma[0];
  t133 = t49 * t49;
  t134 = 0.1e1 / t133;
  t135 = t46 * t134;
  t136 = t135 * t115;
  t140 = -0.2e1 / 0.27e2 * t111 * t112 * t116 + 0.4e1 / 0.27e2 * t35 * t41 * t123 * t50 + t129 * t132 * t136 / 0.27e2;
  t145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t140);
  t146 = t61 * t93;
  t148 = my_piecewise5(t14, 0, t10, 0, -t7 - t146);
  t151 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t148);
  t152 = t151 * t26;
  t156 = t68 * t105;
  t159 = t5 * t156 * t87 / 0.8e1;
  t160 = t71 * sigma[2];
  t161 = t78 * t82;
  t163 = t148 * t6 + t63 + 0.1e1;
  t164 = t161 * t163;
  t168 = t71 * t71;
  t169 = t168 * t70;
  t170 = t169 * sigma[2];
  t171 = t81 * t81;
  t172 = 0.1e1 / t171;
  t173 = t78 * t172;
  t174 = t173 * t163;
  t178 = -0.2e1 / 0.27e2 * t111 * t160 * t164 + t129 * t170 * t174 / 0.27e2;
  t183 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t152 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t178);
  tvrho0 = t59 + t91 + t6 * (t145 + t183);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 0] += tvrho0;

  t187 = my_piecewise5(t10, 0, t14, 0, -t7 - t94);
  t190 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t187);
  t191 = t190 * t26;
  t196 = t187 * t6 + t18 + 0.1e1;
  t197 = t113 * t196;
  t201 = t135 * t196;
  t205 = -0.2e1 / 0.27e2 * t111 * t112 * t197 + t129 * t132 * t201 / 0.27e2;
  t210 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t191 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t205);
  t212 = my_piecewise5(t14, 0, t10, 0, t7 - t146);
  t215 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t212);
  t216 = t215 * t26;
  t221 = t212 * t6 + t63 + 0.1e1;
  t222 = t161 * t221;
  t228 = 0.1e1 / t76 / t74 / rho[1];
  t229 = sigma[2] * t228;
  t234 = t173 * t221;
  t238 = -0.2e1 / 0.27e2 * t111 * t160 * t222 + 0.4e1 / 0.27e2 * t35 * t73 * t229 * t82 + t129 * t170 * t234 / 0.27e2;
  t243 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t216 * t87 - t159 - 0.3e1 / 0.8e1 * t5 * t69 * t238);
  tvrho1 = t59 + t91 + t6 * (t210 + t243);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim->vrho + 1] += tvrho1;

  t246 = t4 * t25;
  t248 = t26 * params->gamma * t32;
  t249 = t246 * t248;
  t250 = t33 * t37;
  t253 = t250 * t40 * t46 * t50;
  t256 = my_piecewise3(t1, 0, t249 * t253 / 0.16e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 1] += tvsigma1;

  t257 = t4 * t68;
  t258 = t257 * t248;
  t261 = t250 * t72 * t78 * t82;
  t264 = my_piecewise3(t60, 0, t258 * t261 / 0.16e2);
  tvsigma2 = t6 * t264;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim->vsigma + 2] += tvsigma2;

  t267 = t23 * t23;
  t268 = 0.1e1 / t267;
  t269 = t96 * t96;
  t272 = t92 * t6;
  t273 = 0.1e1 / t272;
  t274 = t16 * t273;
  t277 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t93 + 0.2e1 * t274);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t269 + 0.4e1 / 0.3e1 * t23 * t277);
  t282 = t281 * t26;
  t286 = t99 * t105;
  t288 = t5 * t286 * t55;
  t294 = 0.1e1 / t104 / t6;
  t295 = t25 * t294;
  t298 = t5 * t295 * t55 / 0.12e2;
  t300 = t5 * t106 * t140;
  t302 = 0.1e1 / t130;
  t303 = t302 * sigma[0];
  t304 = t115 * t115;
  t305 = t113 * t304;
  t309 = t122 * t50;
  t310 = t309 * t115;
  t314 = t130 * sigma[0];
  t315 = t135 * t304;
  t321 = t277 * t6 + 0.2e1 * t96;
  t322 = t113 * t321;
  t326 = t42 * t42;
  t328 = 0.1e1 / t44 / t326;
  t334 = t122 * t134;
  t335 = t334 * t115;
  t339 = t19 * t19;
  t341 = t29 * t34 * t339;
  t342 = t92 * sigma[0];
  t344 = 0.1e1 / t133 / t49;
  t345 = t46 * t344;
  t346 = t345 * t304;
  t347 = t342 * t346;
  t350 = t135 * t321;
  t354 = -0.2e1 / 0.81e2 * t111 * t303 * t305 + 0.32e2 / 0.81e2 * t111 * t112 * t310 + t129 * t314 * t315 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t322 - 0.44e2 / 0.81e2 * t35 * t41 * sigma[0] * t328 * t50 - 0.16e2 / 0.81e2 * t129 * t132 * t335 - 0.4e1 / 0.81e2 * t341 * t347 + t129 * t132 * t350 / 0.27e2;
  t359 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t55 - t288 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t140 + t298 - t300 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t354);
  t360 = t66 * t66;
  t361 = 0.1e1 / t360;
  t362 = t148 * t148;
  t365 = t61 * t273;
  t368 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t93 + 0.2e1 * t365);
  t372 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t362 + 0.4e1 / 0.3e1 * t66 * t368);
  t373 = t372 * t26;
  t377 = t151 * t105;
  t379 = t5 * t377 * t87;
  t384 = t68 * t294;
  t387 = t5 * t384 * t87 / 0.12e2;
  t389 = t5 * t156 * t178;
  t391 = 0.1e1 / t168;
  t392 = t391 * sigma[2];
  t393 = t163 * t163;
  t394 = t161 * t393;
  t398 = t168 * sigma[2];
  t399 = t173 * t393;
  t405 = t368 * t6 + 0.2e1 * t148;
  t406 = t161 * t405;
  t410 = t64 * t64;
  t412 = t29 * t34 * t410;
  t413 = t92 * sigma[2];
  t415 = 0.1e1 / t171 / t81;
  t416 = t78 * t415;
  t417 = t416 * t393;
  t418 = t413 * t417;
  t421 = t173 * t405;
  t425 = -0.2e1 / 0.81e2 * t111 * t392 * t394 + t129 * t398 * t399 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t406 - 0.4e1 / 0.81e2 * t412 * t418 + t129 * t170 * t421 / 0.27e2;
  t430 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t373 * t87 - t379 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t152 * t178 + t387 - t389 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t425);
  tv2rho20 = 0.2e1 * t145 + 0.2e1 * t183 + t6 * (t359 + t430);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 0] += tv2rho20;

  t433 = t268 * t187;
  t437 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t274);
  t441 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t433 * t96 + 0.4e1 / 0.3e1 * t23 * t437);
  t442 = t441 * t26;
  t446 = t190 * t105;
  t448 = t5 * t446 * t55;
  t459 = t5 * t106 * t205;
  t461 = t303 * t46;
  t462 = t50 * t196;
  t463 = t462 * t115;
  t467 = t309 * t196;
  t471 = t314 * t46;
  t472 = t134 * t196;
  t473 = t472 * t115;
  t478 = t437 * t6 + t187 + t96;
  t479 = t113 * t478;
  t483 = t334 * t196;
  t487 = t342 * t46;
  t488 = t344 * t196;
  t489 = t488 * t115;
  t490 = t487 * t489;
  t493 = t135 * t478;
  t497 = -0.2e1 / 0.81e2 * t111 * t461 * t463 + 0.16e2 / 0.81e2 * t111 * t112 * t467 + t129 * t471 * t473 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t479 - 0.8e1 / 0.81e2 * t129 * t132 * t483 - 0.4e1 / 0.81e2 * t341 * t490 + t129 * t132 * t493 / 0.27e2;
  t502 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t442 * t55 - t448 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t191 * t140 - t288 / 0.8e1 + t298 - t300 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t100 * t205 - t459 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t27 * t497);
  t503 = t361 * t212;
  t507 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t365);
  t511 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t503 * t148 + 0.4e1 / 0.3e1 * t66 * t507);
  t512 = t511 * t26;
  t516 = t215 * t105;
  t518 = t5 * t516 * t87;
  t529 = t5 * t156 * t238;
  t531 = t392 * t78;
  t532 = t82 * t221;
  t533 = t532 * t163;
  t537 = t398 * t78;
  t538 = t172 * t221;
  t539 = t538 * t163;
  t544 = t507 * t6 + t148 + t212;
  t545 = t161 * t544;
  t549 = t228 * t82;
  t550 = t549 * t163;
  t554 = t228 * t172;
  t555 = t554 * t163;
  t559 = t413 * t78;
  t560 = t415 * t221;
  t561 = t560 * t163;
  t562 = t559 * t561;
  t565 = t173 * t544;
  t569 = -0.2e1 / 0.81e2 * t111 * t531 * t533 + t129 * t537 * t539 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t545 + 0.16e2 / 0.81e2 * t111 * t160 * t550 - 0.8e1 / 0.81e2 * t129 * t170 * t555 - 0.4e1 / 0.81e2 * t412 * t562 + t129 * t170 * t565 / 0.27e2;
  t574 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t512 * t87 - t518 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t216 * t178 - t379 / 0.8e1 + t387 - t389 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t152 * t238 - t529 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t69 * t569);
  tv2rho21 = t145 + t183 + t210 + t243 + t6 * (t502 + t574);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 1] += tv2rho21;

  t579 = t187 * t187;
  t584 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t93 + 0.2e1 * t274);
  t588 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t268 * t579 + 0.4e1 / 0.3e1 * t23 * t584);
  t589 = t588 * t26;
  t598 = t196 * t196;
  t599 = t113 * t598;
  t603 = t135 * t598;
  t609 = t584 * t6 + 0.2e1 * t187;
  t610 = t113 * t609;
  t614 = t345 * t598;
  t615 = t342 * t614;
  t618 = t135 * t609;
  t622 = -0.2e1 / 0.81e2 * t111 * t303 * t599 + t129 * t314 * t603 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t610 - 0.4e1 / 0.81e2 * t341 * t615 + t129 * t132 * t618 / 0.27e2;
  t627 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t589 * t55 - t448 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t191 * t205 + t298 - t459 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t622);
  t628 = t212 * t212;
  t633 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t93 + 0.2e1 * t365);
  t637 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t361 * t628 + 0.4e1 / 0.3e1 * t66 * t633);
  t638 = t637 * t26;
  t647 = t221 * t221;
  t648 = t161 * t647;
  t652 = t549 * t221;
  t656 = t173 * t647;
  t662 = t633 * t6 + 0.2e1 * t212;
  t663 = t161 * t662;
  t667 = t74 * t74;
  t669 = 0.1e1 / t76 / t667;
  t675 = t554 * t221;
  t679 = t416 * t647;
  t680 = t413 * t679;
  t683 = t173 * t662;
  t687 = -0.2e1 / 0.81e2 * t111 * t392 * t648 + 0.32e2 / 0.81e2 * t111 * t160 * t652 + t129 * t398 * t656 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t160 * t663 - 0.44e2 / 0.81e2 * t35 * t73 * sigma[2] * t669 * t82 - 0.16e2 / 0.81e2 * t129 * t170 * t675 - 0.4e1 / 0.81e2 * t412 * t680 + t129 * t170 * t683 / 0.27e2;
  t692 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t638 * t87 - t518 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t216 * t238 + t387 - t529 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * t687);
  tv2rho22 = 0.2e1 * t210 + 0.2e1 * t243 + t6 * (t627 + t692);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim->v2rho2 + 2] += tv2rho22;

  t695 = t4 * t99;
  t696 = t695 * t248;
  t700 = t105 * params->gamma * t32;
  t701 = t246 * t700;
  t703 = t701 * t253 / 0.48e2;
  t704 = t250 * t39;
  t705 = t704 * t116;
  t710 = t250 * t40 * t122 * t50;
  t713 = t33 * t36;
  t714 = t713 * t131;
  t715 = t714 * t136;
  t719 = my_piecewise3(t1, 0, t696 * t253 / 0.16e2 + t703 + t249 * t705 / 0.12e2 - t249 * t710 / 0.6e1 - t249 * t715 / 0.24e2);
  tv2rhosigma0 = t6 * t719 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 1] += tv2rhosigma1;

  t721 = t4 * t151;
  t722 = t721 * t248;
  t725 = t257 * t700;
  t727 = t725 * t261 / 0.48e2;
  t728 = t250 * t71;
  t729 = t728 * t164;
  t732 = t713 * t169;
  t733 = t732 * t174;
  t737 = my_piecewise3(t60, 0, t722 * t261 / 0.16e2 + t727 + t258 * t729 / 0.12e2 - t258 * t733 / 0.24e2);
  tv2rhosigma2 = t6 * t737 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 2] += tv2rhosigma2;

  t739 = t4 * t190;
  t740 = t739 * t248;
  t743 = t704 * t197;
  t746 = t714 * t201;
  t750 = my_piecewise3(t1, 0, t740 * t253 / 0.16e2 + t703 + t249 * t743 / 0.12e2 - t249 * t746 / 0.24e2);
  tv2rhosigma3 = t6 * t750 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 4] += tv2rhosigma4;

  t752 = t4 * t215;
  t753 = t752 * t248;
  t756 = t728 * t222;
  t761 = t250 * t72 * t228 * t82;
  t764 = t732 * t234;
  t768 = my_piecewise3(t60, 0, t753 * t261 / 0.16e2 + t727 + t258 * t756 / 0.12e2 - t258 * t761 / 0.6e1 - t258 * t764 / 0.24e2);
  tv2rhosigma5 = t6 * t768 + t264;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim->v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim->v2sigma2 + 5] += tv2sigma25;

  t773 = 0.1e1 / t267 / t19;
  t774 = t269 * t96;
  t777 = t268 * t96;
  t780 = t92 * t92;
  t781 = 0.1e1 / t780;
  t782 = t16 * t781;
  t785 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t273 - 0.6e1 * t782);
  t789 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t773 * t774 + 0.4e1 / 0.3e1 * t777 * t277 + 0.4e1 / 0.3e1 * t23 * t785);
  t790 = t789 * t26;
  t794 = t281 * t105;
  t796 = t5 * t794 * t55;
  t801 = t99 * t294;
  t803 = t5 * t801 * t55;
  t806 = t5 * t286 * t140;
  t812 = 0.1e1 / t104 / t92;
  t813 = t25 * t812;
  t816 = 0.5e1 / 0.36e2 * t5 * t813 * t55;
  t818 = t5 * t295 * t140;
  t821 = t5 * t106 * t354;
  t823 = t29 * t32;
  t824 = t33 * t339;
  t826 = t823 * t824 * t92;
  t827 = t133 * t133;
  t828 = 0.1e1 / t827;
  t829 = t47 * t828;
  t830 = t304 * t115;
  t831 = t830 * t37;
  t832 = t831 * t39;
  t833 = t829 * t832;
  t836 = t334 * t321;
  t840 = t122 * t344;
  t841 = t840 * t304;
  t847 = t785 * t6 + 0.3e1 * t277;
  t848 = t135 * t847;
  t852 = 0.1e1 / t39;
  t853 = t852 * sigma[0];
  t854 = t135 * t830;
  t858 = t309 * t321;
  t862 = t334 * t304;
  t867 = t29 * t34 * t19;
  t868 = t6 * sigma[0];
  t869 = t345 * t830;
  t870 = t868 * t869;
  t873 = t113 * t847;
  t879 = 0.1e1 / t44 / t326 / rho[0];
  t885 = t328 * t134;
  t886 = t885 * t115;
  t890 = t344 * t304;
  t891 = t890 * t96;
  t899 = t344 * t115 * t321;
  t904 = t134 * t115 * t321;
  t908 = 0.1e1 / t131;
  t909 = t908 * sigma[0];
  t910 = t113 * t830;
  t914 = t309 * t304;
  t919 = t50 * t115 * t321;
  t923 = t328 * t50;
  t924 = t923 * t115;
  t928 = 0.4e1 / 0.81e2 * t826 * t833 - 0.8e1 / 0.27e2 * t129 * t132 * t836 + 0.32e2 / 0.81e2 * t341 * t342 * t841 + t129 * t132 * t848 / 0.27e2 + 0.22e2 / 0.243e3 * t129 * t853 * t854 + 0.16e2 / 0.27e2 * t111 * t112 * t858 - 0.8e1 / 0.9e1 * t129 * t314 * t862 - 0.4e1 / 0.27e2 * t867 * t870 - 0.2e1 / 0.27e2 * t111 * t112 * t873 + 0.616e3 / 0.243e3 * t35 * t41 * sigma[0] * t879 * t50 + 0.88e2 / 0.81e2 * t129 * t132 * t886 - 0.8e1 / 0.81e2 * t867 * t487 * t891 - 0.8e1 / 0.81e2 * t341 * t868 * t346 - 0.4e1 / 0.27e2 * t341 * t487 * t899 + t129 * t471 * t904 / 0.3e1 + 0.4e1 / 0.243e3 * t111 * t909 * t910 + 0.16e2 / 0.81e2 * t111 * t303 * t914 - 0.2e1 / 0.27e2 * t111 * t461 * t919 - 0.176e3 / 0.81e2 * t111 * t112 * t924;
  t933 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t790 * t55 - 0.3e1 / 0.8e1 * t796 - 0.9e1 / 0.8e1 * t5 * t282 * t140 + t803 / 0.4e1 - 0.3e1 / 0.4e1 * t806 - 0.9e1 / 0.8e1 * t5 * t100 * t354 - t816 + t818 / 0.4e1 - 0.3e1 / 0.8e1 * t821 - 0.3e1 / 0.8e1 * t5 * t27 * t928);
  t935 = 0.1e1 / t360 / t64;
  t936 = t362 * t148;
  t939 = t361 * t148;
  t942 = t61 * t781;
  t945 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t273 - 0.6e1 * t942);
  t949 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t935 * t936 + 0.4e1 / 0.3e1 * t939 * t368 + 0.4e1 / 0.3e1 * t66 * t945);
  t950 = t949 * t26;
  t954 = t372 * t105;
  t956 = t5 * t954 * t87;
  t961 = t151 * t294;
  t963 = t5 * t961 * t87;
  t966 = t5 * t377 * t178;
  t971 = t68 * t812;
  t974 = 0.5e1 / 0.36e2 * t5 * t971 * t87;
  t976 = t5 * t384 * t178;
  t979 = t5 * t156 * t425;
  t981 = 0.1e1 / t169;
  t982 = t981 * sigma[2];
  t983 = t393 * t163;
  t984 = t161 * t983;
  t988 = 0.1e1 / t71;
  t989 = t988 * sigma[2];
  t990 = t173 * t983;
  t994 = t82 * t163;
  t995 = t994 * t405;
  t1000 = t29 * t34 * t64;
  t1001 = t6 * sigma[2];
  t1002 = t416 * t983;
  t1003 = t1001 * t1002;
  t1006 = t172 * t163;
  t1007 = t1006 * t405;
  t1013 = t945 * t6 + 0.3e1 * t368;
  t1014 = t161 * t1013;
  t1018 = t415 * t393;
  t1019 = t1018 * t148;
  t1026 = t33 * t410;
  t1028 = t823 * t1026 * t92;
  t1029 = t171 * t171;
  t1030 = 0.1e1 / t1029;
  t1031 = t79 * t1030;
  t1033 = t983 * t37 * t71;
  t1034 = t1031 * t1033;
  t1037 = t415 * t163;
  t1038 = t1037 * t405;
  t1042 = t173 * t1013;
  t1046 = 0.4e1 / 0.243e3 * t111 * t982 * t984 + 0.22e2 / 0.243e3 * t129 * t989 * t990 - 0.2e1 / 0.27e2 * t111 * t531 * t995 - 0.4e1 / 0.27e2 * t1000 * t1003 + t129 * t537 * t1007 / 0.3e1 - 0.2e1 / 0.27e2 * t111 * t160 * t1014 - 0.8e1 / 0.81e2 * t1000 * t559 * t1019 - 0.8e1 / 0.81e2 * t412 * t1001 * t417 + 0.4e1 / 0.81e2 * t1028 * t1034 - 0.4e1 / 0.27e2 * t412 * t559 * t1038 + t129 * t170 * t1042 / 0.27e2;
  t1051 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t950 * t87 - 0.3e1 / 0.8e1 * t956 - 0.9e1 / 0.8e1 * t5 * t373 * t178 + t963 / 0.4e1 - 0.3e1 / 0.4e1 * t966 - 0.9e1 / 0.8e1 * t5 * t152 * t425 - t974 + t976 / 0.4e1 - 0.3e1 / 0.8e1 * t979 - 0.3e1 / 0.8e1 * t5 * t69 * t1046);
  tv3rho30 = 0.3e1 * t359 + 0.3e1 * t430 + t6 * (t933 + t1051);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 0] += tv3rho30;

  t1054 = 0.2e1 * t502;
  t1055 = 0.2e1 * t574;
  t1056 = t441 * t105;
  t1059 = t5 * t1056 * t55 / 0.4e1;
  t1060 = t190 * t294;
  t1062 = t5 * t1060 * t55;
  t1066 = t5 * t286 * t205 / 0.4e1;
  t1068 = t5 * t295 * t205;
  t1075 = t5 * t106 * t497 / 0.4e1;
  t1076 = t33 * t19;
  t1078 = t823 * t1076 * t92;
  t1079 = t47 * t344;
  t1080 = t196 * t115;
  t1081 = t1080 * t96;
  t1082 = t1079 * t1081;
  t1085 = t868 * t46;
  t1089 = t909 * t46;
  t1090 = t462 * t304;
  t1094 = t303 * t122;
  t1099 = t37 * t39;
  t1100 = t196 * t304 * t1099;
  t1101 = t829 * t1100;
  t1104 = 0.2e1 * t273;
  t1105 = 0.6e1 * t782;
  t1107 = my_piecewise5(t10, 0, t14, 0, t1104 - t1105);
  t1109 = 0.2e1 * t437;
  t1110 = t1107 * t6 + t1109 + t277;
  t1111 = t135 * t1110;
  t1115 = t309 * t478;
  t1119 = t113 * t1110;
  t1123 = t334 * t478;
  t1127 = t885 * t196;
  t1132 = t342 * t122;
  t1136 = t344 * t478;
  t1137 = t1136 * t115;
  t1141 = t488 * t321;
  t1145 = t923 * t196;
  t1149 = t314 * t122;
  t1153 = t134 * t478;
  t1154 = t1153 * t115;
  t1158 = t472 * t321;
  t1162 = t488 * t304;
  t1163 = t1085 * t1162;
  t1166 = t50 * t478;
  t1167 = t1166 * t115;
  t1171 = t462 * t321;
  t1175 = t853 * t46;
  t1176 = t472 * t304;
  t1180 = 0.64e2 / 0.243e3 * t341 * t1132 * t489 - 0.8e1 / 0.81e2 * t341 * t487 * t1137 - 0.4e1 / 0.81e2 * t341 * t487 * t1141 - 0.176e3 / 0.243e3 * t111 * t112 * t1145 - 0.16e2 / 0.27e2 * t129 * t1149 * t473 + 0.2e1 / 0.9e1 * t129 * t471 * t1154 + t129 * t471 * t1158 / 0.9e1 - 0.4e1 / 0.27e2 * t867 * t1163 - 0.4e1 / 0.81e2 * t111 * t461 * t1167 - 0.2e1 / 0.81e2 * t111 * t461 * t1171 + 0.22e2 / 0.243e3 * t129 * t1175 * t1176;
  t1181 = -0.8e1 / 0.81e2 * t1078 * t1082 - 0.8e1 / 0.81e2 * t341 * t1085 * t489 + 0.4e1 / 0.243e3 * t111 * t1089 * t1090 + 0.32e2 / 0.243e3 * t111 * t1094 * t463 + 0.4e1 / 0.81e2 * t826 * t1101 + t129 * t132 * t1111 / 0.27e2 + 0.32e2 / 0.81e2 * t111 * t112 * t1115 - 0.2e1 / 0.27e2 * t111 * t112 * t1119 - 0.16e2 / 0.81e2 * t129 * t132 * t1123 + 0.88e2 / 0.243e3 * t129 * t132 * t1127 + t1180;
  t1185 = t773 * t187;
  t1188 = t268 * t437;
  t1196 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1185 * t269 + 0.8e1 / 0.9e1 * t1188 * t96 + 0.4e1 / 0.9e1 * t433 * t277 + 0.4e1 / 0.3e1 * t23 * t1107);
  t1197 = t1196 * t26;
  t1206 = t5 * t446 * t140 / 0.4e1;
  t1218 = -t1059 + t1062 / 0.12e2 - t1066 + t1068 / 0.12e2 - 0.3e1 / 0.4e1 * t5 * t100 * t497 - t1075 - 0.3e1 / 0.8e1 * t5 * t27 * t1181 - 0.3e1 / 0.8e1 * t5 * t1197 * t55 - 0.3e1 / 0.4e1 * t5 * t442 * t140 - t1206 - 0.3e1 / 0.8e1 * t5 * t191 * t354 - 0.3e1 / 0.8e1 * t5 * t282 * t205 - t806 / 0.4e1 + t818 / 0.6e1 - t821 / 0.8e1 - t796 / 0.8e1 + t803 / 0.6e1 - t816;
  t1219 = my_piecewise3(t1, 0, t1218);
  t1220 = t215 * t294;
  t1222 = t5 * t1220 * t87;
  t1226 = t5 * t377 * t238 / 0.4e1;
  t1228 = t5 * t384 * t238;
  t1230 = t511 * t105;
  t1233 = t5 * t1230 * t87 / 0.4e1;
  t1234 = t935 * t212;
  t1237 = t361 * t507;
  t1242 = 0.6e1 * t942;
  t1244 = my_piecewise5(t14, 0, t10, 0, -t1104 - t1242);
  t1248 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1234 * t362 + 0.8e1 / 0.9e1 * t1237 * t148 + 0.4e1 / 0.9e1 * t503 * t368 + 0.4e1 / 0.3e1 * t66 * t1244);
  t1249 = t1248 * t26;
  t1258 = t5 * t516 * t178 / 0.4e1;
  t1270 = t5 * t156 * t569 / 0.4e1;
  t1271 = t33 * t64;
  t1273 = t823 * t1271 * t92;
  t1274 = t79 * t415;
  t1275 = t221 * t163;
  t1276 = t1275 * t148;
  t1277 = t1274 * t1276;
  t1280 = t1001 * t78;
  t1284 = t982 * t78;
  t1285 = t532 * t393;
  t1290 = t37 * t71;
  t1291 = t221 * t393 * t1290;
  t1292 = t1031 * t1291;
  t1296 = 0.2e1 * t507;
  t1297 = t1244 * t6 + t1296 + t368;
  t1298 = t161 * t1297;
  t1302 = t549 * t405;
  t1306 = t554 * t393;
  t1310 = t554 * t405;
  t1314 = t228 * t415;
  t1315 = t1314 * t393;
  t1319 = t173 * t1297;
  t1323 = t549 * t393;
  t1327 = t415 * t544;
  t1328 = t1327 * t163;
  t1332 = t560 * t405;
  t1336 = t82 * t544;
  t1337 = t1336 * t163;
  t1341 = t532 * t405;
  t1345 = t989 * t78;
  t1346 = t538 * t393;
  t1350 = t172 * t544;
  t1351 = t1350 * t163;
  t1355 = t538 * t405;
  t1359 = t560 * t393;
  t1360 = t1280 * t1359;
  t1363 = -0.8e1 / 0.81e2 * t1273 * t1277 - 0.8e1 / 0.81e2 * t412 * t1280 * t561 + 0.4e1 / 0.243e3 * t111 * t1284 * t1285 + 0.4e1 / 0.81e2 * t1028 * t1292 - 0.2e1 / 0.27e2 * t111 * t160 * t1298 + 0.16e2 / 0.81e2 * t111 * t160 * t1302 - 0.8e1 / 0.27e2 * t129 * t398 * t1306 - 0.8e1 / 0.81e2 * t129 * t170 * t1310 + 0.32e2 / 0.243e3 * t412 * t413 * t1315 + t129 * t170 * t1319 / 0.27e2 + 0.16e2 / 0.243e3 * t111 * t392 * t1323 - 0.8e1 / 0.81e2 * t412 * t559 * t1328 - 0.4e1 / 0.81e2 * t412 * t559 * t1332 - 0.4e1 / 0.81e2 * t111 * t531 * t1337 - 0.2e1 / 0.81e2 * t111 * t531 * t1341 + 0.22e2 / 0.243e3 * t129 * t1345 * t1346 + 0.2e1 / 0.9e1 * t129 * t537 * t1351 + t129 * t537 * t1355 / 0.9e1 - 0.4e1 / 0.27e2 * t1000 * t1360;
  t1372 = t1222 / 0.12e2 - t1226 + t1228 / 0.12e2 - t1233 - 0.3e1 / 0.8e1 * t5 * t1249 * t87 - 0.3e1 / 0.4e1 * t5 * t512 * t178 - t1258 - 0.3e1 / 0.8e1 * t5 * t216 * t425 - 0.3e1 / 0.8e1 * t5 * t373 * t238 - 0.3e1 / 0.4e1 * t5 * t152 * t569 - t1270 - 0.3e1 / 0.8e1 * t5 * t69 * t1363 - t966 / 0.4e1 + t976 / 0.6e1 - t979 / 0.8e1 - t956 / 0.8e1 + t963 / 0.6e1 - t974;
  t1373 = my_piecewise3(t60, 0, t1372);
  tv3rho31 = t359 + t430 + t1054 + t1055 + t6 * (t1219 + t1373);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 1] += tv3rho31;

  t1376 = t773 * t579;
  t1381 = t268 * t584;
  t1385 = my_piecewise5(t10, 0, t14, 0, -t1104 - t1105);
  t1389 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1376 * t96 + 0.8e1 / 0.9e1 * t433 * t437 + 0.4e1 / 0.9e1 * t1381 * t96 + 0.4e1 / 0.3e1 * t23 * t1385);
  t1390 = t1389 * t26;
  t1394 = t588 * t105;
  t1396 = t5 * t1394 * t55;
  t1406 = t5 * t446 * t205;
  t1418 = t5 * t106 * t622;
  t1420 = t50 * t598;
  t1421 = t1420 * t115;
  t1425 = t309 * t598;
  t1429 = t134 * t598;
  t1430 = t1429 * t115;
  t1434 = t462 * t478;
  t1438 = t334 * t598;
  t1442 = t344 * t598;
  t1443 = t1442 * t115;
  t1444 = t1085 * t1443;
  t1447 = t472 * t478;
  t1451 = t50 * t609;
  t1452 = t1451 * t115;
  t1456 = t309 * t609;
  t1460 = t134 * t609;
  t1461 = t1460 * t115;
  t1466 = t1385 * t6 + t1109 + t584;
  t1467 = t113 * t1466;
  t1471 = t1442 * t96;
  t1477 = 0.8e1 / 0.81e2 * t341 * t868 * t614;
  t1478 = t840 * t598;
  t1482 = t598 * t37;
  t1483 = t39 * t115;
  t1484 = t1482 * t1483;
  t1485 = t829 * t1484;
  t1488 = t488 * t478;
  t1492 = t334 * t609;
  t1496 = t344 * t609;
  t1497 = t1496 * t115;
  t1501 = t135 * t1466;
  t1505 = 0.4e1 / 0.243e3 * t111 * t1089 * t1421 + 0.16e2 / 0.243e3 * t111 * t303 * t1425 + 0.22e2 / 0.243e3 * t129 * t1175 * t1430 - 0.4e1 / 0.81e2 * t111 * t461 * t1434 - 0.8e1 / 0.27e2 * t129 * t314 * t1438 - 0.4e1 / 0.27e2 * t867 * t1444 + 0.2e1 / 0.9e1 * t129 * t471 * t1447 - 0.2e1 / 0.81e2 * t111 * t461 * t1452 + 0.16e2 / 0.81e2 * t111 * t112 * t1456 + t129 * t471 * t1461 / 0.9e1 - 0.2e1 / 0.27e2 * t111 * t112 * t1467 - 0.8e1 / 0.81e2 * t867 * t487 * t1471 - t1477 + 0.32e2 / 0.243e3 * t341 * t342 * t1478 + 0.4e1 / 0.81e2 * t826 * t1485 - 0.8e1 / 0.81e2 * t341 * t487 * t1488 - 0.8e1 / 0.81e2 * t129 * t132 * t1492 - 0.4e1 / 0.81e2 * t341 * t487 * t1497 + t129 * t132 * t1501 / 0.27e2;
  t1509 = -0.3e1 / 0.8e1 * t5 * t1390 * t55 - t1396 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t589 * t140 - t1059 + t1062 / 0.6e1 - t1206 - 0.3e1 / 0.4e1 * t5 * t442 * t205 - t1406 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t191 * t497 + t803 / 0.12e2 - t816 + t818 / 0.12e2 - t1066 + t1068 / 0.6e1 - t1075 - 0.3e1 / 0.8e1 * t5 * t100 * t622 - t1418 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1505;
  t1510 = my_piecewise3(t1, 0, t1509);
  t1511 = t935 * t628;
  t1516 = t361 * t633;
  t1520 = my_piecewise5(t14, 0, t10, 0, t1104 - t1242);
  t1524 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1511 * t148 + 0.8e1 / 0.9e1 * t503 * t507 + 0.4e1 / 0.9e1 * t1516 * t148 + 0.4e1 / 0.3e1 * t66 * t1520);
  t1525 = t1524 * t26;
  t1529 = t637 * t105;
  t1531 = t5 * t1529 * t87;
  t1541 = t5 * t516 * t238;
  t1553 = t5 * t156 * t687;
  t1555 = t82 * t647;
  t1556 = t1555 * t163;
  t1560 = t172 * t647;
  t1561 = t1560 * t163;
  t1565 = t532 * t544;
  t1569 = t392 * t228;
  t1573 = t398 * t228;
  t1577 = t549 * t544;
  t1581 = t415 * t647;
  t1582 = t1581 * t163;
  t1583 = t1280 * t1582;
  t1586 = t538 * t544;
  t1590 = t82 * t662;
  t1591 = t1590 * t163;
  t1595 = t172 * t662;
  t1596 = t1595 * t163;
  t1602 = t1520 * t6 + t1296 + t633;
  t1603 = t161 * t1602;
  t1607 = t669 * t82;
  t1608 = t1607 * t163;
  t1612 = t669 * t172;
  t1613 = t1612 * t163;
  t1617 = t413 * t228;
  t1621 = t554 * t544;
  t1625 = t1581 * t148;
  t1631 = 0.8e1 / 0.81e2 * t412 * t1001 * t679;
  t1632 = t647 * t37;
  t1633 = t71 * t163;
  t1634 = t1632 * t1633;
  t1635 = t1031 * t1634;
  t1638 = t560 * t544;
  t1642 = t415 * t662;
  t1643 = t1642 * t163;
  t1647 = t173 * t1602;
  t1651 = -0.2e1 / 0.27e2 * t111 * t160 * t1603 - 0.176e3 / 0.243e3 * t111 * t160 * t1608 + 0.88e2 / 0.243e3 * t129 * t170 * t1613 + 0.64e2 / 0.243e3 * t412 * t1617 * t561 - 0.16e2 / 0.81e2 * t129 * t170 * t1621 - 0.8e1 / 0.81e2 * t1000 * t559 * t1625 - t1631 + 0.4e1 / 0.81e2 * t1028 * t1635 - 0.8e1 / 0.81e2 * t412 * t559 * t1638 - 0.4e1 / 0.81e2 * t412 * t559 * t1643 + t129 * t170 * t1647 / 0.27e2;
  t1652 = 0.4e1 / 0.243e3 * t111 * t1284 * t1556 + 0.22e2 / 0.243e3 * t129 * t1345 * t1561 - 0.4e1 / 0.81e2 * t111 * t531 * t1565 + 0.32e2 / 0.243e3 * t111 * t1569 * t533 - 0.16e2 / 0.27e2 * t129 * t1573 * t539 + 0.32e2 / 0.81e2 * t111 * t160 * t1577 - 0.4e1 / 0.27e2 * t1000 * t1583 + 0.2e1 / 0.9e1 * t129 * t537 * t1586 - 0.2e1 / 0.81e2 * t111 * t531 * t1591 + t129 * t537 * t1596 / 0.9e1 + t1651;
  t1656 = -0.3e1 / 0.8e1 * t5 * t1525 * t87 - t1531 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t638 * t178 - t1233 + t1222 / 0.6e1 - t1258 - 0.3e1 / 0.4e1 * t5 * t512 * t238 - t1541 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t216 * t569 + t963 / 0.12e2 - t974 + t976 / 0.12e2 - t1226 + t1228 / 0.6e1 - t1270 - 0.3e1 / 0.8e1 * t5 * t152 * t687 - t1553 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t69 * t1652;
  t1657 = my_piecewise3(t60, 0, t1656);
  tv3rho32 = t1054 + t1055 + t627 + t692 + t6 * (t1510 + t1657);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 2] += tv3rho32;

  t1662 = t579 * t187;
  t1669 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t273 - 0.6e1 * t782);
  t1673 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t773 * t1662 + 0.4e1 / 0.3e1 * t433 * t584 + 0.4e1 / 0.3e1 * t23 * t1669);
  t1674 = t1673 * t26;
  t1689 = t598 * t196;
  t1690 = t113 * t1689;
  t1694 = t135 * t1689;
  t1698 = t462 * t609;
  t1702 = t345 * t1689;
  t1703 = t868 * t1702;
  t1706 = t472 * t609;
  t1712 = t1669 * t6 + 0.3e1 * t584;
  t1713 = t113 * t1712;
  t1717 = t1442 * t187;
  t1718 = t487 * t1717;
  t1721 = t1689 * t37;
  t1722 = t1721 * t39;
  t1723 = t829 * t1722;
  t1726 = t488 * t609;
  t1730 = t135 * t1712;
  t1734 = 0.4e1 / 0.243e3 * t111 * t909 * t1690 + 0.22e2 / 0.243e3 * t129 * t853 * t1694 - 0.2e1 / 0.27e2 * t111 * t461 * t1698 - 0.4e1 / 0.27e2 * t867 * t1703 + t129 * t471 * t1706 / 0.3e1 - 0.2e1 / 0.27e2 * t111 * t112 * t1713 - 0.8e1 / 0.81e2 * t867 * t1718 - t1477 + 0.4e1 / 0.81e2 * t826 * t1723 - 0.4e1 / 0.27e2 * t341 * t487 * t1726 + t129 * t132 * t1730 / 0.27e2;
  t1739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1674 * t55 - 0.3e1 / 0.8e1 * t1396 - 0.9e1 / 0.8e1 * t5 * t589 * t205 + t1062 / 0.4e1 - 0.3e1 / 0.4e1 * t1406 - 0.9e1 / 0.8e1 * t5 * t191 * t622 - t816 + t1068 / 0.4e1 - 0.3e1 / 0.8e1 * t1418 - 0.3e1 / 0.8e1 * t5 * t27 * t1734);
  t1740 = t628 * t212;
  t1747 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t273 - 0.6e1 * t942);
  t1751 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t935 * t1740 + 0.4e1 / 0.3e1 * t503 * t633 + 0.4e1 / 0.3e1 * t66 * t1747);
  t1752 = t1751 * t26;
  t1767 = t560 * t662;
  t1771 = t1581 * t212;
  t1772 = t559 * t1771;
  t1775 = t549 * t647;
  t1779 = t532 * t662;
  t1783 = t1607 * t221;
  t1787 = t538 * t662;
  t1791 = t647 * t221;
  t1792 = t161 * t1791;
  t1796 = t1791 * t37;
  t1797 = t1796 * t71;
  t1798 = t1031 * t1797;
  t1801 = t1612 * t221;
  t1805 = t554 * t662;
  t1809 = t1314 * t647;
  t1815 = t1747 * t6 + 0.3e1 * t633;
  t1816 = t173 * t1815;
  t1820 = t173 * t1791;
  t1824 = t549 * t662;
  t1828 = t554 * t647;
  t1832 = t416 * t1791;
  t1833 = t1001 * t1832;
  t1836 = t161 * t1815;
  t1842 = 0.1e1 / t76 / t667 / rho[1];
  t1848 = -0.4e1 / 0.27e2 * t412 * t559 * t1767 - 0.8e1 / 0.81e2 * t1000 * t1772 + 0.16e2 / 0.81e2 * t111 * t392 * t1775 - 0.2e1 / 0.27e2 * t111 * t531 * t1779 - 0.176e3 / 0.81e2 * t111 * t160 * t1783 + t129 * t537 * t1787 / 0.3e1 + 0.4e1 / 0.243e3 * t111 * t982 * t1792 - t1631 + 0.4e1 / 0.81e2 * t1028 * t1798 + 0.88e2 / 0.81e2 * t129 * t170 * t1801 - 0.8e1 / 0.27e2 * t129 * t170 * t1805 + 0.32e2 / 0.81e2 * t412 * t413 * t1809 + t129 * t170 * t1816 / 0.27e2 + 0.22e2 / 0.243e3 * t129 * t989 * t1820 + 0.16e2 / 0.27e2 * t111 * t160 * t1824 - 0.8e1 / 0.9e1 * t129 * t398 * t1828 - 0.4e1 / 0.27e2 * t1000 * t1833 - 0.2e1 / 0.27e2 * t111 * t160 * t1836 + 0.616e3 / 0.243e3 * t35 * t73 * sigma[2] * t1842 * t82;
  t1853 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1752 * t87 - 0.3e1 / 0.8e1 * t1531 - 0.9e1 / 0.8e1 * t5 * t638 * t238 + t1222 / 0.4e1 - 0.3e1 / 0.4e1 * t1541 - 0.9e1 / 0.8e1 * t5 * t216 * t687 - t974 + t1228 / 0.4e1 - 0.3e1 / 0.8e1 * t1553 - 0.3e1 / 0.8e1 * t5 * t69 * t1848);
  tv3rho33 = 0.3e1 * t627 + 0.3e1 * t692 + t6 * (t1739 + t1853);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim->v3rho3 + 3] += tv3rho33;

  t1857 = t714 * t350;
  t1860 = t701 * t705;
  t1862 = t701 * t710;
  t1864 = t701 * t715;
  t1866 = t704 * t322;
  t1869 = t713 * t130;
  t1870 = t1869 * t315;
  t1875 = t250 * t40 * t328 * t50;
  t1878 = t714 * t335;
  t1881 = t695 * t700;
  t1882 = t1881 * t253;
  t1891 = t294 * params->gamma * t32;
  t1892 = t246 * t1891;
  t1894 = t1892 * t253 / 0.72e2;
  t1895 = t250 * t302;
  t1896 = t1895 * t305;
  t1899 = t704 * t310;
  t1902 = t26 * t92;
  t1904 = t1902 * params->gamma * t32;
  t1905 = t246 * t1904;
  t1906 = t824 * t346;
  t1909 = t4 * t281;
  t1910 = t1909 * t248;
  t1913 = -t249 * t1857 / 0.24e2 + t1860 / 0.18e2 - t1862 / 0.9e1 - t1864 / 0.36e2 + t249 * t1866 / 0.12e2 - t249 * t1870 / 0.8e1 + 0.11e2 / 0.18e2 * t249 * t1875 + 0.2e1 / 0.9e1 * t249 * t1878 + t1882 / 0.24e2 + t696 * t705 / 0.6e1 - t696 * t710 / 0.3e1 - t696 * t715 / 0.12e2 - t1894 + t249 * t1896 / 0.36e2 - 0.4e1 / 0.9e1 * t249 * t1899 + t1905 * t1906 / 0.18e2 + t1910 * t253 / 0.16e2;
  t1914 = my_piecewise3(t1, 0, t1913);
  tv3rho2sigma0 = t6 * t1914 + 0.2e1 * t719;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 1] += tv3rho2sigma1;

  t1917 = t4 * t372;
  t1918 = t1917 * t248;
  t1921 = t721 * t700;
  t1922 = t1921 * t261;
  t1928 = t257 * t1891;
  t1930 = t1928 * t261 / 0.72e2;
  t1931 = t725 * t729;
  t1933 = t725 * t733;
  t1935 = t250 * t391;
  t1936 = t1935 * t394;
  t1939 = t713 * t168;
  t1940 = t1939 * t399;
  t1943 = t728 * t406;
  t1946 = t257 * t1904;
  t1947 = t1026 * t417;
  t1950 = t732 * t421;
  t1953 = t1918 * t261 / 0.16e2 + t1922 / 0.24e2 + t722 * t729 / 0.6e1 - t722 * t733 / 0.12e2 - t1930 + t1931 / 0.18e2 - t1933 / 0.36e2 + t258 * t1936 / 0.36e2 - t258 * t1940 / 0.8e1 + t258 * t1943 / 0.12e2 + t1946 * t1947 / 0.18e2 - t258 * t1950 / 0.24e2;
  t1954 = my_piecewise3(t60, 0, t1953);
  tv3rho2sigma2 = t6 * t1954 + 0.2e1 * t737;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 2] += tv3rho2sigma2;

  t1956 = t4 * t441;
  t1957 = t1956 * t248;
  t1960 = t739 * t700;
  t1961 = t1960 * t253;
  t1976 = t701 * t743;
  t1980 = params->gamma * t32 * t33;
  t1981 = t246 * t26 * t1980;
  t1982 = t37 * t302;
  t1983 = t1982 * t46;
  t1984 = t1983 * t463;
  t1987 = t704 * t467;
  t1990 = t36 * t130;
  t1991 = t1990 * t46;
  t1992 = t1991 * t473;
  t1995 = t704 * t479;
  t2000 = t701 * t746;
  t2002 = t714 * t483;
  t2005 = t824 * t46;
  t2006 = t2005 * t489;
  t2009 = t714 * t493;
  t2012 = t696 * t743 / 0.12e2 + t1976 / 0.36e2 + t1981 * t1984 / 0.36e2 - 0.2e1 / 0.9e1 * t249 * t1987 - t1981 * t1992 / 0.8e1 + t249 * t1995 / 0.12e2 - t696 * t746 / 0.24e2 - t2000 / 0.72e2 + t249 * t2002 / 0.9e1 + t1905 * t2006 / 0.18e2 - t249 * t2009 / 0.24e2;
  t2014 = my_piecewise3(t1, 0, t1957 * t253 / 0.16e2 + t1961 / 0.48e2 + t740 * t705 / 0.12e2 - t740 * t710 / 0.6e1 - t740 * t715 / 0.24e2 + t1882 / 0.48e2 - t1894 + t1860 / 0.36e2 - t1862 / 0.18e2 - t1864 / 0.72e2 + t2012);
  tv3rho2sigma3 = t6 * t2014 + t719 + t750;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 4] += tv3rho2sigma4;

  t2016 = t4 * t511;
  t2017 = t2016 * t248;
  t2020 = t752 * t700;
  t2021 = t2020 * t261;
  t2032 = t725 * t756;
  t2036 = t257 * t26 * t1980;
  t2037 = t37 * t391;
  t2038 = t2037 * t78;
  t2039 = t2038 * t533;
  t2042 = t36 * t168;
  t2043 = t2042 * t78;
  t2044 = t2043 * t539;
  t2047 = t728 * t545;
  t2052 = t725 * t761;
  t2054 = t728 * t550;
  t2057 = t732 * t555;
  t2062 = t725 * t764;
  t2064 = t1026 * t78;
  t2065 = t2064 * t561;
  t2068 = t732 * t565;
  t2071 = t2036 * t2039 / 0.36e2 - t2036 * t2044 / 0.8e1 + t258 * t2047 / 0.12e2 - t722 * t761 / 0.6e1 - t2052 / 0.18e2 - 0.2e1 / 0.9e1 * t258 * t2054 + t258 * t2057 / 0.9e1 - t722 * t764 / 0.24e2 - t2062 / 0.72e2 + t1946 * t2065 / 0.18e2 - t258 * t2068 / 0.24e2;
  t2073 = my_piecewise3(t60, 0, t2017 * t261 / 0.16e2 + t2021 / 0.48e2 + t753 * t729 / 0.12e2 - t753 * t733 / 0.24e2 + t1922 / 0.48e2 - t1930 + t1931 / 0.36e2 - t1933 / 0.72e2 + t722 * t756 / 0.12e2 + t2032 / 0.36e2 + t2071);
  tv3rho2sigma5 = t6 * t2073 + t737 + t768;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 5] += tv3rho2sigma5;

  t2076 = t4 * t588;
  t2077 = t2076 * t248;
  t2087 = t1895 * t599;
  t2090 = t1869 * t603;
  t2093 = t704 * t610;
  t2096 = t824 * t614;
  t2099 = t714 * t618;
  t2102 = t2077 * t253 / 0.16e2 + t1961 / 0.24e2 + t740 * t743 / 0.6e1 - t740 * t746 / 0.12e2 - t1894 + t1976 / 0.18e2 - t2000 / 0.36e2 + t249 * t2087 / 0.36e2 - t249 * t2090 / 0.8e1 + t249 * t2093 / 0.12e2 + t1905 * t2096 / 0.18e2 - t249 * t2099 / 0.24e2;
  t2103 = my_piecewise3(t1, 0, t2102);
  tv3rho2sigma6 = t6 * t2103 + 0.2e1 * t750;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 7] += tv3rho2sigma7;

  t2106 = t728 * t663;
  t2109 = t1939 * t656;
  t2114 = t250 * t72 * t669 * t82;
  t2117 = t732 * t675;
  t2120 = t732 * t683;
  t2131 = t1935 * t648;
  t2134 = t728 * t652;
  t2139 = t4 * t637;
  t2140 = t2139 * t248;
  t2143 = t1026 * t679;
  t2146 = t258 * t2106 / 0.12e2 - t258 * t2109 / 0.8e1 + 0.11e2 / 0.18e2 * t258 * t2114 + 0.2e1 / 0.9e1 * t258 * t2117 - t258 * t2120 / 0.24e2 + t753 * t756 / 0.6e1 - t753 * t761 / 0.3e1 - t753 * t764 / 0.12e2 - t2052 / 0.9e1 + t2021 / 0.24e2 - t1930 + t258 * t2131 / 0.36e2 - 0.4e1 / 0.9e1 * t258 * t2134 + t2032 / 0.18e2 - t2062 / 0.36e2 + t2140 * t261 / 0.16e2 + t1946 * t2143 / 0.18e2;
  t2147 = my_piecewise3(t60, 0, t2146);
  tv3rho2sigma8 = t6 * t2147 + 0.2e1 * t768;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim->v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim->v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim->v3sigma3 + 9] += tv3sigma39;

  t2153 = t5 * t789 * t105 * t55;
  t2157 = t5 * t281 * t294 * t55;
  t2161 = t5 * t99 * t812 * t55;
  t2164 = 0.1e1 / t104 / t272;
  t2168 = 0.1e2 / 0.27e2 * t5 * t25 * t2164 * t55;
  t2170 = t5 * t295 * t354;
  t2173 = t5 * t106 * t928;
  t2220 = 0.256e3 / 0.243e3 * t867 * t1132 * t891 - 0.32e2 / 0.81e2 * t867 * t1085 * t891 + 0.8e1 / 0.81e2 * t111 * t1089 * t50 * t304 * t321 - 0.8e1 / 0.81e2 * t867 * t487 * t890 * t277 - 0.4e2 / 0.81e2 * t341 * t1085 * t899 - 0.8e1 / 0.9e1 * t867 * t1085 * t890 * t321 - 0.8e1 / 0.81e2 * t111 * t461 * t50 * t847 * t115 + 0.4e1 / 0.9e1 * t129 * t471 * t134 * t847 * t115 - 0.16e2 / 0.81e2 * t341 * t487 * t344 * t847 * t115 + 0.44e2 / 0.81e2 * t129 * t1175 * t134 * t304 * t321 + 0.64e2 / 0.81e2 * t111 * t1094 * t919;
  t2231 = t321 * t321;
  t2247 = 0.1e1 / t130 / t339 / t92 * sigma[0];
  t2248 = t304 * t304;
  t2258 = t29 * t34 * t269;
  t2266 = 0.1e1 / t40 * sigma[0];
  t2275 = -0.32e2 / 0.9e1 * t129 * t1149 * t904 + 0.128e3 / 0.81e2 * t341 * t1132 * t899 - 0.352e3 / 0.243e3 * t111 * t303 * t923 * t304 - 0.2e1 / 0.27e2 * t111 * t303 * t113 * t2231 - 0.4e1 / 0.27e2 * t341 * t342 * t345 * t2231 + t129 * t314 * t135 * t2231 / 0.3e1 - 0.2e2 / 0.729e3 * t111 * t2247 * t113 * t2248 - 0.128e3 / 0.729e3 * t111 * t909 * t309 * t830 - 0.8e1 / 0.81e2 * t2258 * t347 + 0.176e3 / 0.27e2 * t129 * t314 * t885 * t304 - 0.1e2 / 0.243e3 * t129 * t2266 * t135 * t2248 - 0.704e3 / 0.729e3 * t129 * t853 * t334 * t830;
  t2288 = t328 * t344;
  t2294 = 0.1e1 / t780 / t6;
  t2295 = t16 * t2294;
  t2298 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t781 + 0.24e2 * t2295);
  t2301 = t2298 * t6 + 0.4e1 * t785;
  t2306 = t879 * t50;
  t2311 = t879 * t134;
  t2329 = t29 * t34 * t96;
  t2336 = -0.352e3 / 0.81e2 * t111 * t112 * t923 * t321 + 0.176e3 / 0.81e2 * t129 * t132 * t885 * t321 + 0.256e3 / 0.243e3 * t341 * t868 * t841 - 0.704e3 / 0.243e3 * t341 * t342 * t2288 * t304 - 0.2e1 / 0.27e2 * t111 * t112 * t113 * t2301 + 0.9856e4 / 0.729e3 * t111 * t112 * t2306 * t115 - 0.4928e4 / 0.729e3 * t129 * t132 * t2311 * t115 + t129 * t132 * t135 * t2301 / 0.27e2 + 0.64e2 / 0.81e2 * t111 * t112 * t309 * t847 + 0.128e3 / 0.81e2 * t867 * t868 * t840 * t830 - 0.4e1 / 0.27e2 * t2329 * t870 - 0.32e2 / 0.81e2 * t129 * t132 * t334 * t847;
  t2341 = t339 * sigma[0];
  t2345 = t19 * sigma[0];
  t2358 = t823 * t1076 * t6;
  t2359 = t2248 * t37;
  t2371 = t47 / t827 / t49;
  t2378 = t823 * t824 * t6;
  t2381 = t123 * t828;
  t2389 = t39 * t96;
  t2395 = t39 * t321;
  t2400 = -0.88e2 / 0.729e3 * t35 * t47 * t344 * t2248 - 0.8e1 / 0.81e2 * t35 * t2341 * t346 - 0.4e1 / 0.27e2 * t35 * t2345 * t869 - 0.10472e5 / 0.729e3 * t35 * t41 * sigma[0] / t44 / t326 / t42 * t50 + 0.4e1 / 0.27e2 * t2358 * t829 * t2359 * t39 - 0.4e2 / 0.81e2 * t1078 * t1079 * t115 * t96 * t321 - 0.32e2 / 0.243e3 * t826 * t2371 * t2248 * t36 * t130 + 0.16e2 / 0.81e2 * t2378 * t833 - 0.128e3 / 0.243e3 * t826 * t2381 * t832 + 0.4e1 / 0.243e3 * t826 * t829 * t2359 * t302 + 0.16e2 / 0.81e2 * t1078 * t829 * t831 * t2389 + 0.8e1 / 0.27e2 * t826 * t829 * t304 * t37 * t2395;
  t2407 = 0.1e1 / t267 / t339;
  t2408 = t269 * t269;
  t2414 = t277 * t277;
  t2422 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2407 * t2408 - 0.16e2 / 0.9e1 * t773 * t269 * t277 + 0.4e1 / 0.3e1 * t268 * t2414 + 0.16e2 / 0.9e1 * t777 * t785 + 0.4e1 / 0.3e1 * t23 * t2298);
  t2431 = t5 * t794 * t140;
  t2437 = t5 * t801 * t140;
  t2439 = t5 * t286 * t354;
  t2445 = t5 * t813 * t140;
  t2447 = -t2153 / 0.2e1 + t2157 / 0.2e1 - 0.5e1 / 0.9e1 * t2161 + t2168 + t2170 / 0.2e1 - t2173 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t2220 + t2275 + t2336 + t2400) - 0.3e1 / 0.8e1 * t5 * t2422 * t26 * t55 - 0.3e1 / 0.2e1 * t5 * t790 * t140 - 0.3e1 / 0.2e1 * t2431 - 0.9e1 / 0.4e1 * t5 * t282 * t354 + t2437 - 0.3e1 / 0.2e1 * t2439 - 0.3e1 / 0.2e1 * t5 * t100 * t928 - 0.5e1 / 0.9e1 * t2445;
  t2448 = my_piecewise3(t1, 0, t2447);
  t2451 = t5 * t151 * t812 * t87;
  t2456 = 0.1e2 / 0.27e2 * t5 * t68 * t2164 * t87;
  t2459 = t5 * t949 * t105 * t87;
  t2463 = t5 * t372 * t294 * t87;
  t2466 = 0.1e1 / t360 / t410;
  t2467 = t362 * t362;
  t2473 = t368 * t368;
  t2478 = t61 * t2294;
  t2481 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t781 + 0.24e2 * t2478);
  t2485 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t2466 * t2467 - 0.16e2 / 0.9e1 * t935 * t362 * t368 + 0.4e1 / 0.3e1 * t361 * t2473 + 0.16e2 / 0.9e1 * t939 * t945 + 0.4e1 / 0.3e1 * t66 * t2481);
  t2494 = t5 * t954 * t178;
  t2500 = t5 * t961 * t178;
  t2502 = t5 * t377 * t425;
  t2508 = t5 * t971 * t178;
  t2511 = t5 * t384 * t425;
  t2514 = t5 * t156 * t1046;
  t2552 = t405 * t405;
  t2562 = t29 * t34 * t362;
  t2567 = t2481 * t6 + 0.4e1 * t945;
  t2573 = 0.1e1 / t72 * sigma[2];
  t2574 = t393 * t393;
  t2579 = -0.4e2 / 0.81e2 * t412 * t1280 * t1038 - 0.16e2 / 0.81e2 * t412 * t559 * t1037 * t1013 - 0.8e1 / 0.9e1 * t1000 * t1280 * t1018 * t405 + 0.4e1 / 0.9e1 * t129 * t537 * t1006 * t1013 - 0.8e1 / 0.81e2 * t1000 * t559 * t1018 * t368 - 0.32e2 / 0.81e2 * t1000 * t1280 * t1019 + 0.8e1 / 0.81e2 * t111 * t1284 * t82 * t393 * t405 + 0.44e2 / 0.81e2 * t129 * t1345 * t172 * t393 * t405 - 0.8e1 / 0.81e2 * t111 * t531 * t994 * t1013 - 0.4e1 / 0.27e2 * t412 * t413 * t416 * t2552 + t129 * t398 * t173 * t2552 / 0.3e1 - 0.8e1 / 0.81e2 * t2562 * t418 + t129 * t170 * t173 * t2567 / 0.27e2 - 0.1e2 / 0.243e3 * t129 * t2573 * t173 * t2574;
  t2581 = t29 * t34 * t148;
  t2591 = 0.1e1 / t168 / t410 / t92 * sigma[2];
  t2604 = t410 * sigma[2];
  t2608 = t64 * sigma[2];
  t2618 = t823 * t1271 * t6;
  t2619 = t2574 * t37;
  t2629 = t823 * t1026 * t6;
  t2634 = t79 / t1029 / t81;
  t2646 = t71 * t405;
  t2651 = -0.4e1 / 0.27e2 * t2581 * t1003 - 0.2e1 / 0.27e2 * t111 * t160 * t161 * t2567 - 0.2e2 / 0.729e3 * t111 * t2591 * t161 * t2574 - 0.2e1 / 0.27e2 * t111 * t392 * t161 * t2552 - 0.88e2 / 0.729e3 * t35 * t79 * t415 * t2574 - 0.8e1 / 0.81e2 * t35 * t2604 * t417 - 0.4e1 / 0.27e2 * t35 * t2608 * t1002 - 0.4e2 / 0.81e2 * t1273 * t1274 * t163 * t148 * t405 + 0.4e1 / 0.27e2 * t2618 * t1031 * t2619 * t71 + 0.4e1 / 0.243e3 * t1028 * t1031 * t2619 * t391 + 0.16e2 / 0.81e2 * t2629 * t1034 - 0.32e2 / 0.243e3 * t1028 * t2634 * t2574 * t36 * t168 + 0.16e2 / 0.81e2 * t1273 * t1031 * t983 * t148 * t1290 + 0.8e1 / 0.27e2 * t1028 * t1031 * t393 * t37 * t2646;
  t2656 = -0.5e1 / 0.9e1 * t2451 + t2456 - t2459 / 0.2e1 + t2463 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t2485 * t26 * t87 - 0.3e1 / 0.2e1 * t5 * t950 * t178 - 0.3e1 / 0.2e1 * t2494 - 0.9e1 / 0.4e1 * t5 * t373 * t425 + t2500 - 0.3e1 / 0.2e1 * t2502 - 0.3e1 / 0.2e1 * t5 * t152 * t1046 - 0.5e1 / 0.9e1 * t2508 + t2511 / 0.2e1 - t2514 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t69 * (t2579 + t2651);
  t2657 = my_piecewise3(t60, 0, t2656);
  tv4rho40 = 0.4e1 * t933 + 0.4e1 * t1051 + t6 * (t2448 + t2657);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 0] += tv4rho40;

  t2665 = t5 * t1196 * t105 * t55;
  t2668 = t5 * t1056 * t140;
  t2671 = t5 * t1060 * t140;
  t2672 = t2671 / 0.4e1;
  t2674 = t5 * t794 * t205;
  t2677 = t5 * t286 * t497;
  t2680 = t5 * t295 * t497;
  t2681 = t2680 / 0.4e1;
  t2689 = t5 * t106 * t1181;
  t2706 = 0.12e2 * t781;
  t2707 = 0.24e2 * t2295;
  t2709 = my_piecewise5(t10, 0, t14, 0, -t2706 + t2707);
  t2712 = t2709 * t6 + 0.3e1 * t1107 + t785;
  t2742 = t853 * t122;
  t2751 = -0.1232e4 / 0.729e3 * t129 * t132 * t2311 * t196 - 0.176e3 / 0.81e2 * t111 * t112 * t923 * t478 - 0.8e1 / 0.81e2 * t341 * t47 * t489 - 0.8e1 / 0.27e2 * t129 * t132 * t334 * t1110 + t129 * t132 * t135 * t2712 / 0.27e2 + 0.16e2 / 0.27e2 * t111 * t112 * t309 * t1110 - 0.2e1 / 0.27e2 * t111 * t112 * t113 * t2712 - 0.4e1 / 0.27e2 * t867 * t47 * t1162 + 0.2464e4 / 0.729e3 * t111 * t112 * t2306 * t196 + 0.88e2 / 0.81e2 * t129 * t132 * t885 * t478 + 0.32e2 / 0.81e2 * t111 * t1094 * t1167 + 0.16e2 / 0.81e2 * t111 * t1094 * t1171 - 0.176e3 / 0.243e3 * t129 * t2742 * t1176 + t129 * t471 * t134 * t1110 * t115 / 0.3e1;
  t2760 = t868 * t122;
  t2764 = t2247 * t46;
  t2769 = t909 * t122;
  t2807 = 0.22e2 / 0.81e2 * t129 * t1175 * t1153 * t304 - 0.176e3 / 0.243e3 * t111 * t303 * t328 * t463 + 0.64e2 / 0.81e2 * t341 * t2760 * t489 - 0.2e2 / 0.729e3 * t111 * t2764 * t462 * t830 - 0.32e2 / 0.243e3 * t111 * t2769 * t1090 - 0.8e1 / 0.81e2 * t2258 * t490 - 0.2e1 / 0.27e2 * t111 * t461 * t1166 * t321 - 0.4e1 / 0.81e2 * t341 * t487 * t488 * t847 - 0.8e1 / 0.9e1 * t129 * t1149 * t1158 + 0.32e2 / 0.27e2 * t867 * t2760 * t1162 + 0.64e2 / 0.81e2 * t341 * t1132 * t1137 + 0.88e2 / 0.27e2 * t129 * t314 * t328 * t473 - 0.352e3 / 0.243e3 * t341 * t342 * t328 * t489 + 0.32e2 / 0.81e2 * t341 * t1132 * t1141 - 0.4e1 / 0.27e2 * t341 * t487 * t1136 * t321;
  t2832 = t2266 * t46;
  t2861 = -0.4e1 / 0.27e2 * t341 * t487 * t344 * t1110 * t115 - 0.16e2 / 0.9e1 * t129 * t1149 * t1154 - 0.2e1 / 0.27e2 * t111 * t461 * t50 * t1110 * t115 - 0.8e1 / 0.27e2 * t341 * t1085 * t1137 - 0.16e2 / 0.81e2 * t341 * t1085 * t1141 + 0.4e1 / 0.81e2 * t111 * t1089 * t1166 * t304 - 0.1e2 / 0.243e3 * t129 * t2832 * t472 * t830 - 0.2e1 / 0.81e2 * t111 * t461 * t462 * t847 + t129 * t471 * t1153 * t321 / 0.3e1 - 0.4e1 / 0.9e1 * t867 * t1085 * t1136 * t304 + t129 * t471 * t472 * t847 / 0.9e1 - 0.4e1 / 0.27e2 * t2329 * t1163 - 0.88e2 / 0.729e3 * t35 * t47 * t488 * t830 - 0.32e2 / 0.81e2 * t2358 * t1082;
  t2866 = t713 * t852;
  t2867 = t823 * t2866;
  t2868 = t47 * t134;
  t2869 = t196 * t321;
  t2870 = t2869 * t115;
  t2877 = t478 * t115;
  t2890 = t250 * t908;
  t2891 = t823 * t2890;
  t2900 = t196 * t830;
  t2919 = t823 * t1076 * t342;
  t2920 = t46 * t828;
  t2921 = t2920 * t196;
  t2928 = t823 * t824 * t342;
  t2934 = 0.64e2 / 0.81e2 * t1078 * t123 * t344 * t1081 + 0.22e2 / 0.81e2 * t2867 * t2868 * t2870 - 0.4e1 / 0.9e1 * t2358 * t1079 * t2870 - 0.8e1 / 0.27e2 * t1078 * t1079 * t2877 * t96 - 0.16e2 / 0.81e2 * t1078 * t1079 * t2869 * t96 - 0.8e1 / 0.81e2 * t1078 * t1079 * t1080 * t277 + 0.4e1 / 0.81e2 * t2891 * t51 * t2870 + 0.4e1 / 0.27e2 * t826 * t829 * t478 * t304 * t1099 - 0.32e2 / 0.243e3 * t826 * t2371 * t2900 * t1990 + 0.16e2 / 0.81e2 * t2378 * t1101 - 0.32e2 / 0.81e2 * t826 * t2381 * t1100 + 0.4e1 / 0.243e3 * t826 * t829 * t2900 * t1982 + 0.4e1 / 0.27e2 * t2358 * t829 * t2900 * t1099 + 0.16e2 / 0.81e2 * t2919 * t2921 * t304 * t96 * t1099 + 0.4e1 / 0.27e2 * t2928 * t2921 * t115 * t37 * t2395;
  t2959 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2407 * t187 * t774 - 0.8e1 / 0.9e1 * t773 * t437 * t269 - 0.8e1 / 0.9e1 * t1185 * t96 * t277 + 0.4e1 / 0.3e1 * t268 * t1107 * t96 + 0.4e1 / 0.3e1 * t1188 * t277 + 0.4e1 / 0.9e1 * t433 * t785 + 0.4e1 / 0.3e1 * t23 * t2709);
  t2971 = t5 * t446 * t354;
  t2973 = -0.5e1 / 0.12e2 * t2445 - 0.3e1 / 0.8e1 * t2665 - 0.3e1 / 0.4e1 * t2668 + t2672 - 0.3e1 / 0.8e1 * t2674 - 0.3e1 / 0.4e1 * t2677 + t2681 - 0.9e1 / 0.8e1 * t5 * t282 * t497 - 0.9e1 / 0.8e1 * t5 * t100 * t1181 - 0.3e1 / 0.8e1 * t2689 - 0.3e1 / 0.8e1 * t5 * t27 * (t2751 + t2807 + t2861 + t2934) - 0.3e1 / 0.8e1 * t5 * t2959 * t26 * t55 - 0.9e1 / 0.8e1 * t5 * t1197 * t140 - 0.9e1 / 0.8e1 * t5 * t442 * t354 - 0.3e1 / 0.8e1 * t2971;
  t2982 = t5 * t441 * t294 * t55;
  t2983 = t2982 / 0.4e1;
  t2986 = t5 * t190 * t812 * t55;
  t2989 = t5 * t801 * t205;
  t2990 = t2989 / 0.4e1;
  t2992 = t5 * t813 * t205;
  t3002 = -0.3e1 / 0.8e1 * t5 * t191 * t928 - 0.3e1 / 0.8e1 * t5 * t790 * t205 + t2983 - 0.5e1 / 0.36e2 * t2986 + t2990 - 0.5e1 / 0.36e2 * t2992 - t2153 / 0.8e1 + t2157 / 0.4e1 - 0.5e1 / 0.12e2 * t2161 + t2168 + t2170 / 0.4e1 - t2173 / 0.8e1 - 0.3e1 / 0.8e1 * t2431 + t2437 / 0.2e1 - 0.3e1 / 0.8e1 * t2439;
  t3004 = my_piecewise3(t1, 0, t2973 + t3002);
  t3006 = t5 * t1220 * t178;
  t3007 = t3006 / 0.4e1;
  t3009 = t5 * t954 * t238;
  t3012 = t5 * t377 * t569;
  t3015 = t5 * t384 * t569;
  t3016 = t3015 / 0.4e1;
  t3019 = t5 * t1248 * t105 * t87;
  t3022 = t5 * t1230 * t178;
  t3040 = 0.24e2 * t2478;
  t3042 = my_piecewise5(t14, 0, t10, 0, t2706 + t3040);
  t3046 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t2466 * t212 * t936 - 0.8e1 / 0.9e1 * t935 * t507 * t362 - 0.8e1 / 0.9e1 * t1234 * t148 * t368 + 0.4e1 / 0.3e1 * t361 * t1244 * t148 + 0.4e1 / 0.3e1 * t1237 * t368 + 0.4e1 / 0.9e1 * t503 * t945 + 0.4e1 / 0.3e1 * t66 * t3042);
  t3058 = t5 * t516 * t425;
  t3073 = t5 * t156 * t1363;
  t3075 = t3007 - 0.3e1 / 0.8e1 * t3009 - 0.3e1 / 0.4e1 * t3012 + t3016 - 0.3e1 / 0.8e1 * t3019 - 0.3e1 / 0.4e1 * t3022 - 0.3e1 / 0.8e1 * t5 * t3046 * t26 * t87 - 0.9e1 / 0.8e1 * t5 * t1249 * t178 - 0.9e1 / 0.8e1 * t5 * t512 * t425 - 0.3e1 / 0.8e1 * t3058 - 0.3e1 / 0.8e1 * t5 * t216 * t1046 - 0.3e1 / 0.8e1 * t5 * t950 * t238 - 0.9e1 / 0.8e1 * t5 * t373 * t569 - 0.9e1 / 0.8e1 * t5 * t152 * t1363 - 0.3e1 / 0.8e1 * t3073;
  t3099 = t3042 * t6 + 0.3e1 * t1244 + t945;
  t3120 = t221 * t405;
  t3121 = t3120 * t163;
  t3125 = -0.4e1 / 0.27e2 * t1000 * t79 * t1359 - 0.32e2 / 0.729e3 * t111 * t982 * t549 * t983 + 0.64e2 / 0.243e3 * t412 * t1001 * t1315 - 0.176e3 / 0.729e3 * t129 * t989 * t554 * t983 - 0.8e1 / 0.81e2 * t412 * t79 * t561 - 0.8e1 / 0.81e2 * t129 * t170 * t554 * t1013 + t129 * t170 * t173 * t3099 / 0.27e2 - 0.2e1 / 0.27e2 * t111 * t160 * t161 * t3099 + 0.16e2 / 0.81e2 * t111 * t160 * t549 * t1013 + 0.32e2 / 0.81e2 * t1000 * t1001 * t1314 * t983 - 0.88e2 / 0.729e3 * t35 * t79 * t560 * t983 - 0.4e1 / 0.9e1 * t2618 * t1274 * t3121;
  t3126 = t713 * t988;
  t3127 = t823 * t3126;
  t3128 = t79 * t172;
  t3132 = t229 * t1030;
  t3136 = t250 * t981;
  t3137 = t823 * t3136;
  t3141 = t544 * t163;
  t3156 = t221 * t983;
  t3176 = 0.22e2 / 0.81e2 * t3127 * t3128 * t3121 - 0.32e2 / 0.243e3 * t1028 * t3132 * t1033 + 0.4e1 / 0.81e2 * t3137 * t83 * t3121 - 0.8e1 / 0.27e2 * t1273 * t1274 * t3141 * t148 - 0.16e2 / 0.81e2 * t1273 * t1274 * t3120 * t148 - 0.8e1 / 0.81e2 * t1273 * t1274 * t1275 * t368 - 0.32e2 / 0.81e2 * t2618 * t1277 + 0.4e1 / 0.27e2 * t2618 * t1031 * t3156 * t1290 + 0.4e1 / 0.27e2 * t1028 * t1031 * t544 * t393 * t1290 - 0.32e2 / 0.243e3 * t1028 * t2634 * t3156 * t2042 + 0.16e2 / 0.81e2 * t2629 * t1292 + 0.4e1 / 0.243e3 * t1028 * t1031 * t3156 * t2037;
  t3179 = t823 * t1271 * t413;
  t3180 = t78 * t1030;
  t3181 = t3180 * t221;
  t3188 = t823 * t1026 * t413;
  t3215 = t2573 * t78;
  t3222 = t2591 * t78;
  t3231 = 0.16e2 / 0.81e2 * t3179 * t3181 * t393 * t148 * t1290 + 0.4e1 / 0.27e2 * t3188 * t3181 * t163 * t37 * t2646 + t129 * t537 * t172 * t1297 * t163 / 0.3e1 + 0.16e2 / 0.81e2 * t111 * t1569 * t995 - 0.8e1 / 0.9e1 * t129 * t1573 * t1007 - 0.8e1 / 0.27e2 * t412 * t1280 * t1328 - 0.16e2 / 0.81e2 * t412 * t1280 * t1332 + 0.4e1 / 0.81e2 * t111 * t1284 * t1336 * t393 - 0.1e2 / 0.243e3 * t129 * t3215 * t538 * t983 - 0.8e1 / 0.81e2 * t2562 * t562 - 0.2e2 / 0.729e3 * t111 * t3222 * t532 * t983 + t129 * t537 * t538 * t1013 / 0.9e1;
  t3278 = -0.4e1 / 0.27e2 * t2581 * t1360 - 0.2e1 / 0.27e2 * t111 * t531 * t1336 * t405 + 0.22e2 / 0.81e2 * t129 * t1345 * t1350 * t393 - 0.2e1 / 0.81e2 * t111 * t531 * t532 * t1013 + t129 * t537 * t1350 * t405 / 0.3e1 - 0.4e1 / 0.9e1 * t1000 * t1280 * t1327 * t393 - 0.4e1 / 0.27e2 * t412 * t559 * t415 * t1297 * t163 - 0.4e1 / 0.27e2 * t412 * t559 * t1327 * t405 - 0.4e1 / 0.81e2 * t412 * t559 * t560 * t1013 + 0.32e2 / 0.81e2 * t412 * t1617 * t1038 + 0.64e2 / 0.243e3 * t1000 * t1617 * t1019 - 0.2e1 / 0.27e2 * t111 * t531 * t82 * t1297 * t163;
  t3286 = t5 * t511 * t294 * t87;
  t3287 = t3286 / 0.4e1;
  t3290 = t5 * t215 * t812 * t87;
  t3293 = t5 * t961 * t238;
  t3294 = t3293 / 0.4e1;
  t3296 = t5 * t971 * t238;
  t3307 = -0.3e1 / 0.8e1 * t5 * t69 * (t3125 + t3176 + t3231 + t3278) + t3287 - 0.5e1 / 0.36e2 * t3290 + t3294 - 0.5e1 / 0.36e2 * t3296 - 0.5e1 / 0.12e2 * t2451 + t2456 - t2459 / 0.8e1 + t2463 / 0.4e1 - 0.3e1 / 0.8e1 * t2494 + t2500 / 0.2e1 - 0.3e1 / 0.8e1 * t2502 - 0.5e1 / 0.12e2 * t2508 + t2511 / 0.4e1 - t2514 / 0.8e1;
  t3309 = my_piecewise3(t60, 0, t3075 + t3307);
  tv4rho41 = t933 + t1051 + 0.3e1 * t1219 + 0.3e1 * t1373 + t6 * (t3004 + t3309);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 1] += tv4rho41;

  t3324 = t437 * t437;
  t3337 = my_piecewise5(t10, 0, t14, 0, t2707);
  t3341 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2407 * t579 * t269 - 0.32e2 / 0.27e2 * t1185 * t96 * t437 - 0.8e1 / 0.27e2 * t1376 * t277 + 0.8e1 / 0.9e1 * t268 * t3324 + 0.8e1 / 0.9e1 * t433 * t1107 - 0.8e1 / 0.27e2 * t773 * t584 * t269 + 0.8e1 / 0.9e1 * t268 * t1385 * t96 + 0.4e1 / 0.9e1 * t1381 * t277 + 0.4e1 / 0.3e1 * t23 * t3337);
  t3350 = t5 * t1394 * t140;
  t3362 = t5 * t446 * t497;
  t3374 = t5 * t106 * t1505;
  t3382 = 0.8e1 / 0.81e2 * t35 * t2341 * t614;
  t3383 = t2378 * t1485;
  t3417 = t2920 * t598;
  t3423 = t1080 * t478;
  t3437 = -0.88e2 / 0.729e3 * t35 * t47 * t1442 * t304 - t3382 + 0.16e2 / 0.81e2 * t3383 - 0.64e2 / 0.243e3 * t826 * t2381 * t1484 + 0.4e1 / 0.81e2 * t826 * t829 * t1482 * t2395 + 0.4e1 / 0.27e2 * t2358 * t829 * t598 * t304 * t1099 + 0.4e1 / 0.243e3 * t826 * t829 * t1482 * t302 * t304 - 0.32e2 / 0.243e3 * t826 * t2371 * t598 * t36 * t130 * t304 + 0.4e1 / 0.81e2 * t826 * t829 * t609 * t304 * t1099 + 0.16e2 / 0.81e2 * t2928 * t2921 * t1099 * t2877 + 0.16e2 / 0.81e2 * t2919 * t3417 * t96 * t37 * t1483 + 0.16e2 / 0.243e3 * t2891 * t51 * t3423 - 0.32e2 / 0.27e2 * t129 * t1149 * t1447 + 0.64e2 / 0.81e2 * t867 * t2760 * t1443 + 0.4e1 / 0.243e3 * t111 * t1089 * t1420 * t321;
  t3446 = t867 * t1085 * t1471;
  t3496 = -0.1e2 / 0.243e3 * t129 * t2832 * t1429 * t304 - 0.8e1 / 0.81e2 * t341 * t1085 * t1497 - 0.32e2 / 0.81e2 * t3446 + 0.128e3 / 0.243e3 * t867 * t1132 * t1471 + 0.32e2 / 0.243e3 * t111 * t1094 * t1452 + 0.4e1 / 0.243e3 * t111 * t1089 * t1451 * t304 - 0.2e2 / 0.729e3 * t111 * t2764 * t1420 * t304 - 0.64e2 / 0.729e3 * t111 * t2769 * t1421 + t129 * t471 * t1460 * t321 / 0.9e1 - 0.4e1 / 0.27e2 * t867 * t1085 * t1496 * t304 - 0.8e1 / 0.81e2 * t867 * t487 * t1442 * t277 - 0.4e1 / 0.27e2 * t2329 * t1444 - 0.4e1 / 0.27e2 * t867 * t1085 * t1442 * t321 + 0.2e1 / 0.9e1 * t129 * t471 * t472 * t1110 - 0.4e1 / 0.81e2 * t111 * t461 * t50 * t1466 * t115 - 0.2e1 / 0.81e2 * t111 * t461 * t1451 * t321;
  t3529 = t341 * t1085 * t1488;
  t3559 = 0.22e2 / 0.243e3 * t129 * t1175 * t1460 * t304 + 0.64e2 / 0.243e3 * t111 * t1094 * t1434 - 0.352e3 / 0.729e3 * t129 * t2742 * t1430 + 0.22e2 / 0.243e3 * t129 * t1175 * t1429 * t321 - 0.4e1 / 0.81e2 * t111 * t461 * t462 * t1110 + 0.64e2 / 0.243e3 * t341 * t1132 * t1497 - 0.8e1 / 0.81e2 * t341 * t487 * t344 * t1466 * t115 - 0.4e1 / 0.81e2 * t341 * t487 * t1496 * t321 - 0.32e2 / 0.81e2 * t3529 + 0.128e3 / 0.243e3 * t341 * t1132 * t1488 - 0.8e1 / 0.81e2 * t341 * t487 * t488 * t1110 - 0.16e2 / 0.27e2 * t129 * t1149 * t1461 + 0.2e1 / 0.9e1 * t129 * t471 * t134 * t1466 * t115 - 0.8e1 / 0.81e2 * t1078 * t1079 * t609 * t115 * t96 - 0.32e2 / 0.81e2 * t1078 * t1079 * t196 * t96 * t478 - 0.16e2 / 0.27e2 * t2358 * t1079 * t3423;
  t3568 = t341 * t868 * t1478;
  t3574 = t478 * t478;
  t3611 = t3337 * t6 + 0.2e1 * t1107 + 0.2e1 * t1385;
  t3624 = 0.88e2 / 0.243e3 * t2867 * t2868 * t3423 + 0.88e2 / 0.243e3 * t129 * t132 * t885 * t609 + 0.128e3 / 0.243e3 * t3568 - 0.352e3 / 0.729e3 * t341 * t342 * t2288 * t598 - 0.8e1 / 0.81e2 * t341 * t342 * t345 * t3574 - 0.8e1 / 0.81e2 * t2258 * t615 - 0.4e1 / 0.27e2 * t867 * t47 * t1443 + 0.2e1 / 0.9e1 * t129 * t314 * t135 * t3574 - 0.176e3 / 0.243e3 * t111 * t112 * t923 * t609 - 0.4e1 / 0.81e2 * t111 * t303 * t113 * t3574 + 0.88e2 / 0.81e2 * t129 * t314 * t885 * t598 - 0.176e3 / 0.729e3 * t111 * t303 * t923 * t598 + 0.32e2 / 0.81e2 * t111 * t112 * t309 * t1466 - 0.2e1 / 0.27e2 * t111 * t112 * t113 * t3611 - 0.16e2 / 0.81e2 * t129 * t132 * t334 * t1466 + t129 * t132 * t135 * t3611 / 0.27e2;
  t3631 = t5 * t286 * t622;
  t3634 = t5 * t295 * t622;
  t3638 = t5 * t1389 * t105 * t55;
  t3642 = t5 * t588 * t294 * t55;
  t3645 = t5 * t1056 * t205;
  t3648 = t5 * t1060 * t205;
  t3650 = -0.3e1 / 0.8e1 * t5 * t3341 * t26 * t55 - 0.3e1 / 0.4e1 * t5 * t1390 * t140 - t3350 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t589 * t354 - 0.3e1 / 0.4e1 * t5 * t1197 * t205 - 0.3e1 / 0.2e1 * t5 * t442 * t497 - t3362 / 0.2e1 - 0.3e1 / 0.4e1 * t5 * t191 * t1181 - 0.3e1 / 0.8e1 * t5 * t282 * t622 - 0.3e1 / 0.4e1 * t5 * t100 * t1505 - t3374 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t3437 + t3496 + t3559 + t3624) - t3631 / 0.4e1 + t3634 / 0.12e2 - t3638 / 0.4e1 + t3642 / 0.12e2 - t3645 / 0.2e1 + t3648 / 0.6e1;
  t3668 = -0.5e1 / 0.18e2 * t2445 - t2665 / 0.4e1 - t2668 / 0.2e1 + t2671 / 0.3e1 - t2674 / 0.4e1 - t2677 / 0.2e1 + t2680 / 0.3e1 - t2689 / 0.4e1 - t2971 / 0.4e1 + t2982 / 0.3e1 - 0.5e1 / 0.18e2 * t2986 + t2989 / 0.3e1 - 0.5e1 / 0.18e2 * t2992 + t2157 / 0.12e2 - 0.5e1 / 0.18e2 * t2161 + t2168 + t2170 / 0.12e2 + t2437 / 0.6e1;
  t3670 = my_piecewise3(t1, 0, t3650 + t3668);
  t3675 = t5 * t1529 * t178;
  t3687 = t5 * t516 * t569;
  t3691 = t5 * t1524 * t105 * t87;
  t3695 = t5 * t637 * t294 * t87;
  t3698 = t5 * t1230 * t238;
  t3701 = t5 * t1220 * t238;
  t3704 = t5 * t377 * t687;
  t3707 = t5 * t384 * t687;
  t3719 = t5 * t156 * t1652;
  t3727 = 0.8e1 / 0.81e2 * t35 * t2604 * t679;
  t3728 = t2629 * t1635;
  t3758 = t3180 * t647;
  t3768 = t982 * t228;
  t3785 = -0.88e2 / 0.729e3 * t35 * t79 * t1581 * t393 - t3727 + 0.16e2 / 0.81e2 * t3728 + 0.4e1 / 0.81e2 * t1028 * t1031 * t1632 * t2646 - 0.32e2 / 0.243e3 * t1028 * t2634 * t647 * t36 * t168 * t393 + 0.4e1 / 0.27e2 * t2618 * t1031 * t647 * t393 * t1290 + 0.4e1 / 0.243e3 * t1028 * t1031 * t1632 * t391 * t393 + 0.4e1 / 0.81e2 * t1028 * t1031 * t662 * t393 * t1290 - 0.64e2 / 0.243e3 * t1028 * t3132 * t1291 + 0.16e2 / 0.81e2 * t3179 * t3758 * t148 * t37 * t1633 + 0.16e2 / 0.81e2 * t3188 * t3181 * t1290 * t3141 - 0.64e2 / 0.729e3 * t111 * t3768 * t1285 - 0.2e2 / 0.729e3 * t111 * t3222 * t1555 * t393 + 0.22e2 / 0.243e3 * t129 * t1345 * t1595 * t393 + 0.2e1 / 0.9e1 * t129 * t537 * t172 * t1602 * t163;
  t3794 = t1001 * t228;
  t3830 = t989 * t228;
  t3844 = t129 * t537 * t1595 * t405 / 0.9e1 - 0.4e1 / 0.27e2 * t1000 * t1280 * t1642 * t393 + 0.64e2 / 0.81e2 * t1000 * t3794 * t1359 - 0.4e1 / 0.27e2 * t2581 * t1583 - 0.4e1 / 0.27e2 * t1000 * t1280 * t1581 * t405 + 0.2e1 / 0.9e1 * t129 * t537 * t538 * t1297 + 0.4e1 / 0.243e3 * t111 * t1284 * t1555 * t405 - 0.1e2 / 0.243e3 * t129 * t3215 * t1560 * t393 + 0.22e2 / 0.243e3 * t129 * t1345 * t1560 * t405 - 0.4e1 / 0.81e2 * t111 * t531 * t532 * t1297 + 0.64e2 / 0.243e3 * t111 * t1569 * t1337 + 0.32e2 / 0.243e3 * t111 * t1569 * t1341 - 0.352e3 / 0.729e3 * t129 * t3830 * t1346 - 0.32e2 / 0.27e2 * t129 * t1573 * t1351 - 0.16e2 / 0.27e2 * t129 * t1573 * t1355 + 0.4e1 / 0.243e3 * t111 * t1284 * t1590 * t393;
  t3857 = t1000 * t1280 * t1625;
  t3864 = t412 * t1280 * t1638;
  t3890 = t1275 * t544;
  t3904 = -0.4e1 / 0.81e2 * t412 * t559 * t1642 * t405 - 0.8e1 / 0.81e2 * t412 * t1280 * t1643 + 0.128e3 / 0.243e3 * t412 * t3794 * t561 - 0.32e2 / 0.81e2 * t3857 - 0.8e1 / 0.81e2 * t1000 * t559 * t1581 * t368 - 0.32e2 / 0.81e2 * t3864 - 0.8e1 / 0.81e2 * t412 * t559 * t560 * t1297 - 0.8e1 / 0.81e2 * t412 * t559 * t415 * t1602 * t163 + 0.128e3 / 0.243e3 * t412 * t1617 * t1328 + 0.64e2 / 0.243e3 * t412 * t1617 * t1332 - 0.4e1 / 0.81e2 * t111 * t531 * t82 * t1602 * t163 - 0.2e1 / 0.81e2 * t111 * t531 * t1590 * t405 - 0.16e2 / 0.27e2 * t2618 * t1274 * t3890 + 0.88e2 / 0.243e3 * t3127 * t3128 * t3890 + 0.16e2 / 0.243e3 * t3137 * t83 * t3890 + 0.128e3 / 0.243e3 * t1273 * t229 * t415 * t1276;
  t3917 = t544 * t544;
  t3937 = my_piecewise5(t14, 0, t10, 0, t3040);
  t3941 = t3937 * t6 + 0.2e1 * t1244 + 0.2e1 * t1520;
  t3966 = t669 * t415;
  t3975 = -0.8e1 / 0.81e2 * t1273 * t1274 * t662 * t163 * t148 - 0.32e2 / 0.81e2 * t1273 * t1274 * t221 * t148 * t544 - 0.8e1 / 0.81e2 * t2562 * t680 - 0.8e1 / 0.81e2 * t412 * t413 * t416 * t3917 - 0.176e3 / 0.729e3 * t111 * t392 * t1607 * t393 - 0.4e1 / 0.27e2 * t1000 * t79 * t1582 + 0.2e1 / 0.9e1 * t129 * t398 * t173 * t3917 - 0.4e1 / 0.81e2 * t111 * t392 * t161 * t3917 + t129 * t170 * t173 * t3941 / 0.27e2 + 0.32e2 / 0.81e2 * t111 * t160 * t549 * t1297 - 0.2e1 / 0.27e2 * t111 * t160 * t161 * t3941 - 0.176e3 / 0.243e3 * t111 * t160 * t1607 * t405 + 0.88e2 / 0.81e2 * t129 * t398 * t1612 * t393 + 0.88e2 / 0.243e3 * t129 * t170 * t1612 * t405 - 0.352e3 / 0.729e3 * t412 * t413 * t3966 * t393 - 0.16e2 / 0.81e2 * t129 * t170 * t554 * t1297;
  t3989 = t507 * t507;
  t4005 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t2466 * t628 * t362 - 0.32e2 / 0.27e2 * t1234 * t148 * t507 - 0.8e1 / 0.27e2 * t1511 * t368 + 0.8e1 / 0.9e1 * t361 * t3989 + 0.8e1 / 0.9e1 * t503 * t1244 - 0.8e1 / 0.27e2 * t935 * t633 * t362 + 0.8e1 / 0.9e1 * t361 * t1520 * t148 + 0.4e1 / 0.9e1 * t1516 * t368 + 0.4e1 / 0.3e1 * t66 * t3937);
  t4010 = -0.3e1 / 0.4e1 * t5 * t1525 * t178 - t3675 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t638 * t425 - 0.3e1 / 0.4e1 * t5 * t1249 * t238 - 0.3e1 / 0.2e1 * t5 * t512 * t569 - t3687 / 0.2e1 - t3691 / 0.4e1 + t3695 / 0.12e2 - t3698 / 0.2e1 + t3701 / 0.6e1 - t3704 / 0.4e1 + t3707 / 0.12e2 - 0.3e1 / 0.4e1 * t5 * t216 * t1363 - 0.3e1 / 0.8e1 * t5 * t373 * t687 - 0.3e1 / 0.4e1 * t5 * t152 * t1652 - t3719 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t69 * (t3785 + t3844 + t3904 + t3975) - 0.3e1 / 0.8e1 * t5 * t4005 * t26 * t87;
  t4028 = t3006 / 0.3e1 - t3009 / 0.4e1 - t3012 / 0.2e1 + t3015 / 0.3e1 - t3019 / 0.4e1 - t3022 / 0.2e1 - t3058 / 0.4e1 - t3073 / 0.4e1 + t3286 / 0.3e1 - 0.5e1 / 0.18e2 * t3290 + t3293 / 0.3e1 - 0.5e1 / 0.18e2 * t3296 - 0.5e1 / 0.18e2 * t2451 + t2456 + t2463 / 0.12e2 + t2500 / 0.6e1 - 0.5e1 / 0.18e2 * t2508 + t2511 / 0.12e2;
  t4030 = my_piecewise3(t60, 0, t4010 + t4028);
  tv4rho42 = 0.2e1 * t1219 + 0.2e1 * t1373 + 0.2e1 * t1510 + 0.2e1 * t1657 + t6 * (t3670 + t4030);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 2] += tv4rho42;

  t4037 = t5 * t1673 * t105 * t55;
  t4040 = t5 * t1394 * t205;
  t4043 = t5 * t446 * t622;
  t4046 = t5 * t106 * t1734;
  t4064 = my_piecewise5(t10, 0, t14, 0, t2706 + t2707);
  t4068 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2407 * t1662 * t96 - 0.8e1 / 0.9e1 * t1376 * t437 - 0.8e1 / 0.9e1 * t1185 * t584 * t96 + 0.4e1 / 0.3e1 * t1188 * t584 + 0.4e1 / 0.3e1 * t433 * t1385 + 0.4e1 / 0.9e1 * t268 * t1669 * t96 + 0.4e1 / 0.3e1 * t23 * t4064);
  t4098 = 0.4e1 / 0.27e2 * t35 * t2345 * t1702;
  t4139 = -0.88e2 / 0.729e3 * t35 * t47 * t344 * t1689 * t115 - t4098 - t3382 + 0.8e1 / 0.81e2 * t1078 * t829 * t1721 * t2389 + 0.4e1 / 0.27e2 * t826 * t829 * t1482 * t39 * t478 + 0.4e1 / 0.243e3 * t826 * t829 * t1721 * t302 * t115 - 0.32e2 / 0.243e3 * t826 * t2371 * t1689 * t36 * t130 * t115 + 0.4e1 / 0.27e2 * t2358 * t829 * t1721 * t1483 + 0.8e1 / 0.81e2 * t3383 + 0.4e1 / 0.27e2 * t2928 * t2921 * t609 * t37 * t1483 + 0.8e1 / 0.81e2 * t2919 * t3417 * t187 * t37 * t1483 - 0.1e2 / 0.243e3 * t129 * t2832 * t134 * t1689 * t115;
  t4141 = t341 * t1085 * t1726;
  t4147 = t867 * t1085 * t1717;
  t4185 = -0.8e1 / 0.27e2 * t4141 + 0.32e2 / 0.81e2 * t341 * t1132 * t1726 - 0.16e2 / 0.81e2 * t4147 + 0.64e2 / 0.243e3 * t867 * t1132 * t1717 + 0.16e2 / 0.81e2 * t111 * t1094 * t1698 - 0.8e1 / 0.9e1 * t129 * t1149 * t1706 + t129 * t471 * t134 * t1712 * t115 / 0.9e1 - 0.8e1 / 0.81e2 * t2329 * t1718 - 0.8e1 / 0.81e2 * t867 * t487 * t1442 * t437 - 0.4e1 / 0.27e2 * t341 * t487 * t1136 * t609 - 0.4e1 / 0.27e2 * t341 * t487 * t488 * t1466 + 0.22e2 / 0.81e2 * t129 * t1175 * t1429 * t478 - 0.2e1 / 0.27e2 * t111 * t461 * t1166 * t609;
  t4222 = t196 * t609;
  t4223 = t4222 * t115;
  t4230 = t2378 * t1723;
  t4238 = -0.2e1 / 0.27e2 * t111 * t461 * t462 * t1466 - 0.4e1 / 0.9e1 * t867 * t1085 * t1442 * t478 + t129 * t471 * t1153 * t609 / 0.3e1 - 0.2e2 / 0.729e3 * t111 * t2764 * t50 * t1689 * t115 + 0.4e1 / 0.81e2 * t111 * t1089 * t1420 * t478 - 0.4e1 / 0.81e2 * t341 * t487 * t344 * t1712 * t115 + t129 * t471 * t472 * t1466 / 0.3e1 - 0.2e1 / 0.81e2 * t111 * t461 * t50 * t1712 * t115 + 0.4e1 / 0.81e2 * t2891 * t51 * t4223 + 0.22e2 / 0.81e2 * t2867 * t2868 * t4223 + 0.8e1 / 0.81e2 * t4230 - 0.32e2 / 0.243e3 * t826 * t2381 * t1722 - 0.4e1 / 0.9e1 * t2358 * t1079 * t4223;
  t4239 = t196 * t187;
  t4270 = t4064 * t6 + 0.3e1 * t1385 + t1669;
  t4284 = -0.16e2 / 0.81e2 * t1078 * t1079 * t4239 * t478 - 0.8e1 / 0.27e2 * t1078 * t1079 * t4222 * t96 - 0.8e1 / 0.81e2 * t129 * t132 * t334 * t1712 + 0.16e2 / 0.81e2 * t111 * t112 * t309 * t1712 - 0.176e3 / 0.729e3 * t129 * t853 * t334 * t1689 + 0.32e2 / 0.81e2 * t867 * t868 * t840 * t1689 - 0.32e2 / 0.729e3 * t111 * t909 * t309 * t1689 - 0.2e1 / 0.27e2 * t111 * t112 * t113 * t4270 + t129 * t132 * t135 * t4270 / 0.27e2 - 0.4e1 / 0.27e2 * t2329 * t1703 - 0.16e2 / 0.81e2 * t3446 - 0.16e2 / 0.81e2 * t3529 + 0.64e2 / 0.243e3 * t3568;
  t4293 = -t4037 / 0.8e1 - 0.3e1 / 0.8e1 * t4040 - 0.3e1 / 0.8e1 * t4043 - t4046 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t4068 * t26 * t55 - 0.3e1 / 0.8e1 * t5 * t1674 * t140 - 0.9e1 / 0.8e1 * t5 * t1390 * t205 - 0.9e1 / 0.8e1 * t5 * t589 * t497 - 0.9e1 / 0.8e1 * t5 * t442 * t622 - 0.9e1 / 0.8e1 * t5 * t191 * t1505 - 0.3e1 / 0.8e1 * t5 * t100 * t1734 - 0.3e1 / 0.8e1 * t5 * t27 * (t4139 + t4185 + t4238 + t4284) - 0.3e1 / 0.8e1 * t3350 - 0.3e1 / 0.4e1 * t3362 - 0.3e1 / 0.8e1 * t3374;
  t4304 = -0.3e1 / 0.8e1 * t3631 + t3634 / 0.4e1 - 0.3e1 / 0.8e1 * t3638 + t3642 / 0.4e1 - 0.3e1 / 0.4e1 * t3645 + t3648 / 0.2e1 - 0.5e1 / 0.36e2 * t2445 + t2672 + t2681 + t2983 - 0.5e1 / 0.12e2 * t2986 + t2990 - 0.5e1 / 0.12e2 * t2992 - 0.5e1 / 0.36e2 * t2161 + t2168;
  t4306 = my_piecewise3(t1, 0, t4293 + t4304);
  t4323 = 0.4e1 / 0.27e2 * t35 * t2608 * t1832;
  t4372 = -0.88e2 / 0.729e3 * t35 * t79 * t415 * t1791 * t163 - t4323 - t3727 + 0.4e1 / 0.27e2 * t1028 * t1031 * t1632 * t71 * t544 + 0.4e1 / 0.243e3 * t1028 * t1031 * t1796 * t391 * t163 - 0.32e2 / 0.243e3 * t1028 * t2634 * t1791 * t36 * t168 * t163 - 0.32e2 / 0.81e2 * t1028 * t3132 * t1634 + 0.4e1 / 0.27e2 * t2618 * t1031 * t1796 * t1633 + 0.8e1 / 0.81e2 * t1273 * t1031 * t1796 * t71 * t148 + 0.8e1 / 0.81e2 * t3728 + 0.4e1 / 0.27e2 * t3188 * t3181 * t662 * t37 * t1633 + 0.8e1 / 0.81e2 * t3179 * t3758 * t212 * t37 * t1633 - 0.8e1 / 0.81e2 * t2581 * t1772 - 0.8e1 / 0.81e2 * t1000 * t559 * t1581 * t507 - 0.32e2 / 0.243e3 * t111 * t3768 * t1556;
  t4374 = t412 * t1280 * t1767;
  t4377 = t1000 * t1280 * t1771;
  t4431 = -0.8e1 / 0.27e2 * t4374 - 0.16e2 / 0.81e2 * t4377 + 0.64e2 / 0.81e2 * t412 * t1617 * t1638 + t129 * t537 * t172 * t1815 * t163 / 0.9e1 - 0.4e1 / 0.81e2 * t412 * t559 * t415 * t1815 * t163 - 0.2e2 / 0.729e3 * t111 * t3222 * t82 * t1791 * t163 + 0.4e1 / 0.81e2 * t111 * t1284 * t1555 * t544 - 0.1e2 / 0.243e3 * t129 * t3215 * t172 * t1791 * t163 - 0.352e3 / 0.243e3 * t412 * t413 * t669 * t561 - 0.8e1 / 0.9e1 * t129 * t1573 * t1596 + 0.32e2 / 0.81e2 * t111 * t1569 * t1565 - 0.176e3 / 0.243e3 * t129 * t3830 * t1561 - 0.2e1 / 0.27e2 * t111 * t531 * t1336 * t662 - 0.2e1 / 0.27e2 * t111 * t531 * t532 * t1602 - 0.176e3 / 0.243e3 * t111 * t392 * t669 * t533;
  t4483 = 0.88e2 / 0.27e2 * t129 * t398 * t669 * t539 + t129 * t537 * t1350 * t662 / 0.3e1 + t129 * t537 * t538 * t1602 / 0.3e1 - 0.4e1 / 0.27e2 * t412 * t559 * t1327 * t662 - 0.4e1 / 0.27e2 * t412 * t559 * t560 * t1602 - 0.4e1 / 0.9e1 * t1000 * t1280 * t1581 * t544 - 0.2e1 / 0.81e2 * t111 * t531 * t82 * t1815 * t163 + 0.22e2 / 0.81e2 * t129 * t1345 * t1560 * t544 + 0.16e2 / 0.81e2 * t111 * t1569 * t1591 - 0.16e2 / 0.9e1 * t129 * t1573 * t1586 + 0.32e2 / 0.27e2 * t1000 * t3794 * t1582 + 0.32e2 / 0.81e2 * t412 * t1617 * t1643 + 0.64e2 / 0.81e2 * t1000 * t1617 * t1625 - 0.16e2 / 0.81e2 * t3857 - 0.16e2 / 0.81e2 * t3864;
  t4484 = t221 * t662;
  t4485 = t4484 * t163;
  t4504 = t2629 * t1798;
  t4507 = t412 * t1001 * t1809;
  t4510 = my_piecewise5(t14, 0, t10, 0, -t2706 + t3040);
  t4513 = t4510 * t6 + 0.3e1 * t1520 + t1747;
  t4518 = t1842 * t82;
  t4523 = t1842 * t172;
  t4550 = -0.4e1 / 0.9e1 * t2618 * t1274 * t4485 - 0.16e2 / 0.81e2 * t1273 * t1274 * t221 * t212 * t544 + 0.4e1 / 0.81e2 * t3137 * t83 * t4485 + 0.22e2 / 0.81e2 * t3127 * t3128 * t4485 - 0.8e1 / 0.27e2 * t1273 * t1274 * t4484 * t148 + 0.8e1 / 0.81e2 * t4504 + 0.64e2 / 0.81e2 * t4507 - 0.2e1 / 0.27e2 * t111 * t160 * t161 * t4513 + 0.2464e4 / 0.729e3 * t111 * t160 * t4518 * t163 - 0.1232e4 / 0.729e3 * t129 * t170 * t4523 * t163 - 0.8e1 / 0.27e2 * t129 * t170 * t554 * t1602 + t129 * t170 * t173 * t4513 / 0.27e2 + 0.16e2 / 0.27e2 * t111 * t160 * t549 * t1602 - 0.4e1 / 0.27e2 * t2581 * t1833 - 0.176e3 / 0.81e2 * t111 * t160 * t1607 * t544 + 0.88e2 / 0.81e2 * t129 * t170 * t1612 * t544;
  t4574 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t2466 * t1740 * t148 - 0.8e1 / 0.9e1 * t1511 * t507 - 0.8e1 / 0.9e1 * t1234 * t633 * t148 + 0.4e1 / 0.3e1 * t1237 * t633 + 0.4e1 / 0.3e1 * t503 * t1520 + 0.4e1 / 0.9e1 * t361 * t1747 * t148 + 0.4e1 / 0.3e1 * t66 * t4510);
  t4589 = t5 * t516 * t687;
  t4592 = t5 * t156 * t1848;
  t4596 = t5 * t1751 * t105 * t87;
  t4599 = t5 * t1529 * t238;
  t4604 = -0.9e1 / 0.8e1 * t5 * t512 * t687 - 0.9e1 / 0.8e1 * t5 * t216 * t1652 - 0.3e1 / 0.8e1 * t5 * t152 * t1848 - 0.3e1 / 0.8e1 * t5 * t69 * (t4372 + t4431 + t4483 + t4550) - 0.3e1 / 0.8e1 * t5 * t4574 * t26 * t87 - 0.3e1 / 0.8e1 * t5 * t1752 * t178 - 0.9e1 / 0.8e1 * t5 * t1525 * t238 - 0.9e1 / 0.8e1 * t5 * t638 * t569 - 0.3e1 / 0.8e1 * t4589 - t4592 / 0.8e1 - t4596 / 0.8e1 - 0.3e1 / 0.8e1 * t4599 - 0.3e1 / 0.8e1 * t3675 - 0.3e1 / 0.4e1 * t3687 - 0.3e1 / 0.8e1 * t3691;
  t4615 = t3695 / 0.4e1 - 0.3e1 / 0.4e1 * t3698 + t3701 / 0.2e1 - 0.3e1 / 0.8e1 * t3704 + t3707 / 0.4e1 - 0.3e1 / 0.8e1 * t3719 + t3007 + t3016 + t3287 - 0.5e1 / 0.12e2 * t3290 + t3294 - 0.5e1 / 0.12e2 * t3296 - 0.5e1 / 0.36e2 * t2451 + t2456 - 0.5e1 / 0.36e2 * t2508;
  t4617 = my_piecewise3(t60, 0, t4604 + t4615);
  tv4rho43 = 0.3e1 * t1510 + 0.3e1 * t1657 + t1739 + t1853 + t6 * (t4306 + t4617);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 3] += tv4rho43;

  t4622 = t598 * t598;
  t4674 = -0.88e2 / 0.729e3 * t35 * t47 * t344 * t4622 - t4098 - t3382 + 0.16e2 / 0.81e2 * t1078 * t829 * t1689 * t187 * t1099 + 0.8e1 / 0.27e2 * t826 * t829 * t1482 * t39 * t609 - 0.8e1 / 0.9e1 * t867 * t1085 * t1442 * t609 + 0.4e1 / 0.9e1 * t129 * t471 * t472 * t1712 - 0.8e1 / 0.81e2 * t867 * t487 * t1442 * t584 + 0.8e1 / 0.81e2 * t111 * t1089 * t1420 * t609 + 0.44e2 / 0.81e2 * t129 * t1175 * t1429 * t609 - 0.8e1 / 0.81e2 * t111 * t461 * t462 * t1712 - 0.16e2 / 0.81e2 * t341 * t487 * t488 * t1712 - 0.4e2 / 0.81e2 * t1078 * t1079 * t4239 * t609 - 0.32e2 / 0.243e3 * t826 * t2371 * t4622 * t36 * t130;
  t4675 = t4622 * t37;
  t4691 = t609 * t609;
  t4718 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t781 + 0.24e2 * t2295);
  t4721 = t4718 * t6 + 0.4e1 * t1669;
  t4730 = 0.4e1 / 0.27e2 * t2358 * t829 * t4675 * t39 + 0.4e1 / 0.243e3 * t826 * t829 * t4675 * t302 - 0.4e2 / 0.81e2 * t4141 - 0.32e2 / 0.81e2 * t4147 + 0.16e2 / 0.81e2 * t4230 - 0.1e2 / 0.243e3 * t129 * t2266 * t135 * t4622 - 0.4e1 / 0.27e2 * t341 * t342 * t345 * t4691 + t129 * t314 * t135 * t4691 / 0.3e1 - 0.8e1 / 0.81e2 * t29 * t34 * t579 * t615 - 0.2e2 / 0.729e3 * t111 * t2247 * t113 * t4622 - 0.2e1 / 0.27e2 * t111 * t303 * t113 * t4691 - 0.4e1 / 0.27e2 * t29 * t34 * t187 * t1703 - 0.2e1 / 0.27e2 * t111 * t112 * t113 * t4721 + t129 * t132 * t135 * t4721 / 0.27e2;
  t4735 = t579 * t579;
  t4740 = t584 * t584;
  t4748 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2407 * t4735 - 0.16e2 / 0.9e1 * t1376 * t584 + 0.4e1 / 0.3e1 * t268 * t4740 + 0.16e2 / 0.9e1 * t433 * t1669 + 0.4e1 / 0.3e1 * t23 * t4718);
  t4770 = -0.3e1 / 0.8e1 * t5 * t27 * (t4674 + t4730) - 0.3e1 / 0.8e1 * t5 * t4748 * t26 * t55 - 0.3e1 / 0.2e1 * t5 * t1674 * t205 - 0.9e1 / 0.4e1 * t5 * t589 * t622 - 0.3e1 / 0.2e1 * t5 * t191 * t1734 - t4037 / 0.2e1 - 0.3e1 / 0.2e1 * t4040 - 0.3e1 / 0.2e1 * t4043 - t4046 / 0.2e1 + t3634 / 0.2e1 + t3642 / 0.2e1 + t3648 - 0.5e1 / 0.9e1 * t2986 - 0.5e1 / 0.9e1 * t2992 + t2168;
  t4771 = my_piecewise3(t1, 0, t4770);
  t4772 = t628 * t628;
  t4777 = t633 * t633;
  t4784 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t781 + 0.24e2 * t2478);
  t4788 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t2466 * t4772 - 0.16e2 / 0.9e1 * t1511 * t633 + 0.4e1 / 0.3e1 * t361 * t4777 + 0.16e2 / 0.9e1 * t503 * t1747 + 0.4e1 / 0.3e1 * t66 * t4784);
  t4802 = t647 * t647;
  t4844 = -0.88e2 / 0.729e3 * t35 * t79 * t415 * t4802 - 0.10472e5 / 0.729e3 * t35 * t73 * sigma[2] / t76 / t667 / t74 * t82 - t4323 - t3727 + 0.8e1 / 0.27e2 * t1028 * t1031 * t647 * t662 * t1290 + 0.16e2 / 0.81e2 * t1273 * t1031 * t1791 * t212 * t1290 - 0.8e1 / 0.9e1 * t1000 * t1280 * t1581 * t662 - 0.16e2 / 0.81e2 * t412 * t559 * t560 * t1815 - 0.8e1 / 0.81e2 * t1000 * t559 * t1581 * t633 + 0.64e2 / 0.81e2 * t111 * t1569 * t1779 - 0.8e1 / 0.81e2 * t111 * t531 * t532 * t1815;
  t4871 = t4802 * t37;
  t4885 = 0.44e2 / 0.81e2 * t129 * t1345 * t1560 * t662 - 0.32e2 / 0.9e1 * t129 * t1573 * t1787 + 0.8e1 / 0.81e2 * t111 * t1284 * t1555 * t662 + 0.128e3 / 0.81e2 * t412 * t1617 * t1767 + 0.256e3 / 0.243e3 * t1000 * t1617 * t1771 + 0.4e1 / 0.9e1 * t129 * t537 * t538 * t1815 - 0.4e2 / 0.81e2 * t4374 - 0.32e2 / 0.81e2 * t4377 - 0.128e3 / 0.243e3 * t1028 * t3132 * t1797 + 0.4e1 / 0.243e3 * t1028 * t1031 * t4871 * t391 + 0.4e1 / 0.27e2 * t2618 * t1031 * t4871 * t71 - 0.32e2 / 0.243e3 * t1028 * t2634 * t4802 * t36 * t168;
  t4894 = t4784 * t6 + 0.4e1 * t1747;
  t4935 = -0.4e2 / 0.81e2 * t1273 * t1274 * t4484 * t212 + 0.16e2 / 0.81e2 * t4504 + t129 * t170 * t173 * t4894 / 0.27e2 + 0.64e2 / 0.81e2 * t111 * t160 * t549 * t1815 + 0.128e3 / 0.81e2 * t1000 * t1001 * t1314 * t1791 - 0.4e1 / 0.27e2 * t29 * t34 * t212 * t1833 - 0.2e1 / 0.27e2 * t111 * t160 * t161 * t4894 - 0.352e3 / 0.81e2 * t111 * t160 * t1607 * t662 + 0.176e3 / 0.27e2 * t129 * t398 * t1612 * t647 - 0.1e2 / 0.243e3 * t129 * t2573 * t173 * t4802 + 0.176e3 / 0.81e2 * t129 * t170 * t1612 * t662 - 0.704e3 / 0.243e3 * t412 * t413 * t3966 * t647;
  t4952 = t662 * t662;
  t4982 = -0.32e2 / 0.81e2 * t129 * t170 * t554 * t1815 - 0.704e3 / 0.729e3 * t129 * t989 * t554 * t1791 - 0.4928e4 / 0.729e3 * t129 * t170 * t4523 * t221 + 0.9856e4 / 0.729e3 * t111 * t160 * t4518 * t221 + t129 * t398 * t173 * t4952 / 0.3e1 - 0.2e2 / 0.729e3 * t111 * t2591 * t161 * t4802 - 0.4e1 / 0.27e2 * t412 * t413 * t416 * t4952 - 0.8e1 / 0.81e2 * t29 * t34 * t628 * t680 - 0.128e3 / 0.729e3 * t111 * t982 * t549 * t1791 - 0.352e3 / 0.243e3 * t111 * t392 * t1607 * t647 - 0.2e1 / 0.27e2 * t111 * t392 * t161 * t4952 + 0.256e3 / 0.243e3 * t4507;
  t4996 = -0.3e1 / 0.8e1 * t5 * t4788 * t26 * t87 - 0.3e1 / 0.2e1 * t5 * t1752 * t238 - 0.9e1 / 0.4e1 * t5 * t638 * t687 - 0.3e1 / 0.2e1 * t5 * t216 * t1848 - 0.3e1 / 0.8e1 * t5 * t69 * (t4844 + t4885 + t4935 + t4982) - 0.3e1 / 0.2e1 * t4589 - t4592 / 0.2e1 - t4596 / 0.2e1 - 0.3e1 / 0.2e1 * t4599 + t3695 / 0.2e1 + t3701 + t3707 / 0.2e1 - 0.5e1 / 0.9e1 * t3290 - 0.5e1 / 0.9e1 * t3296 + t2456;
  t4997 = my_piecewise3(t60, 0, t4996);
  tv4rho44 = 0.4e1 * t1739 + 0.4e1 * t1853 + t6 * (t4771 + t4997);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim->v4rho4 + 4] += tv4rho44;

  t5006 = t1892 * t705;
  t5008 = t701 * t1896;
  t5010 = t701 * t1899;
  t5012 = t1892 * t715;
  t5014 = t701 * t1857;
  t5016 = t701 * t1878;
  t5018 = t1881 * t715;
  t5025 = t249 * t1869 * t862 + t249 * t714 * t836 / 0.3e1 - t5006 / 0.18e2 + t5008 / 0.36e2 - 0.4e1 / 0.9e1 * t5010 + t5012 / 0.36e2 - t5014 / 0.24e2 + 0.2e1 / 0.9e1 * t5016 - t5018 / 0.12e2 + t696 * t1866 / 0.4e1 + t249 * t704 * t873 / 0.12e2;
  t5036 = t1881 * t705;
  t5054 = t1076 * t46;
  t5058 = -0.3e1 / 0.8e1 * t696 * t1870 - t696 * t1857 / 0.8e1 - t249 * t714 * t848 / 0.24e2 + t1905 * t2005 * t899 / 0.6e1 + t5036 / 0.6e1 - t249 * t2890 * t910 / 0.54e2 - 0.2e1 / 0.9e1 * t249 * t1895 * t914 + t696 * t1896 / 0.12e2 - 0.4e1 / 0.3e1 * t696 * t1899 - 0.2e1 / 0.3e1 * t249 * t704 * t858 - 0.11e2 / 0.108e3 * t249 * t2866 * t854 + t1905 * t5054 * t891 / 0.9e1;
  t5072 = t701 * t1866;
  t5074 = t701 * t1870;
  t5077 = t246 * t1902 * t1980;
  t5079 = t339 * t46 * t828;
  t5095 = t695 * t1891 * t253;
  t5097 = t1910 * t705 / 0.4e1 - t1910 * t715 / 0.8e1 + 0.22e2 / 0.9e1 * t249 * t704 * t924 - 0.11e2 / 0.9e1 * t249 * t714 * t886 + 0.2e1 / 0.3e1 * t696 * t1878 + t5072 / 0.12e2 - t5074 / 0.8e1 - t5077 * t5079 * t832 / 0.18e2 + t1981 * t1983 * t919 / 0.12e2 - 0.3e1 / 0.8e1 * t1981 * t1991 * t904 - 0.77e2 / 0.27e2 * t249 * t250 * t40 * t879 * t50 - t5095 / 0.24e2;
  t5098 = t1892 * t710;
  t5100 = t701 * t1875;
  t5102 = t695 * t1904;
  t5109 = t1881 * t710;
  t5113 = t26 * t6 * params->gamma * t32;
  t5114 = t246 * t5113;
  t5115 = t5114 * t1906;
  t5126 = t1909 * t700 * t253;
  t5131 = t812 * params->gamma * t32;
  t5134 = 0.5e1 / 0.216e3 * t246 * t5131 * t253;
  t5135 = t5098 / 0.9e1 + 0.11e2 / 0.18e2 * t5100 + t5102 * t1906 / 0.6e1 + t4 * t789 * t248 * t253 / 0.16e2 - t5109 / 0.3e1 + t5115 / 0.6e1 + t5114 * t1076 * t869 / 0.6e1 + 0.11e2 / 0.6e1 * t696 * t1875 - 0.4e1 / 0.9e1 * t1905 * t824 * t841 + t5126 / 0.16e2 - t1910 * t710 / 0.2e1 + t5134;
  t5138 = my_piecewise3(t1, 0, t5025 + t5058 + t5097 + t5135);
  tv4rho3sigma0 = t6 * t5138 + 0.3e1 * t1914;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 1] += tv4rho3sigma1;

  t5141 = t1921 * t733;
  t5154 = t725 * t1936;
  t5161 = t1271 * t78;
  t5171 = t1928 * t729;
  t5173 = t1928 * t733;
  t5175 = t725 * t1943;
  t5177 = -t5141 / 0.12e2 + t722 * t1943 / 0.4e1 - 0.3e1 / 0.8e1 * t722 * t1940 - t722 * t1950 / 0.8e1 + t1918 * t729 / 0.4e1 - t258 * t3136 * t984 / 0.54e2 + t5154 / 0.36e2 + t722 * t1936 / 0.12e2 + t258 * t728 * t1014 / 0.12e2 + t1946 * t5161 * t1019 / 0.9e1 + t1946 * t2064 * t1038 / 0.6e1 - t258 * t732 * t1042 / 0.24e2 - t5171 / 0.18e2 + t5173 / 0.36e2 + t5175 / 0.12e2;
  t5178 = t725 * t1940;
  t5180 = t725 * t1950;
  t5187 = t1921 * t729;
  t5190 = t257 * t1902 * t1980;
  t5192 = t410 * t78 * t1030;
  t5202 = t721 * t1904;
  t5205 = t257 * t5113;
  t5206 = t5205 * t1947;
  t5212 = t721 * t1891 * t261;
  t5216 = 0.5e1 / 0.216e3 * t257 * t5131 * t261;
  t5218 = t1917 * t700 * t261;
  t5224 = -t5178 / 0.8e1 - t5180 / 0.24e2 - 0.11e2 / 0.108e3 * t258 * t3126 * t990 - t1918 * t733 / 0.8e1 + t5187 / 0.6e1 - t5190 * t5192 * t1033 / 0.18e2 + t2036 * t2038 * t995 / 0.12e2 - 0.3e1 / 0.8e1 * t2036 * t2043 * t1007 + t5202 * t1947 / 0.6e1 + t5206 / 0.6e1 + t5205 * t1271 * t1002 / 0.6e1 - t5212 / 0.24e2 + t5216 + t5218 / 0.16e2 + t4 * t949 * t248 * t261 / 0.16e2;
  t5226 = my_piecewise3(t60, 0, t5177 + t5224);
  tv4rho3sigma2 = t6 * t5226 + 0.3e1 * t1954;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 2] += tv4rho3sigma2;

  t5228 = 0.2e1 * t2014;
  t5233 = t701 * t1995 / 0.18e2;
  t5239 = t1960 * t705 / 0.18e2;
  t5241 = t1960 * t715 / 0.36e2;
  t5259 = t701 * t2009 / 0.36e2;
  t5260 = t5114 * t2006;
  t5271 = -t5077 * t5079 * t1100 / 0.18e2 + t5233 + t1957 * t705 / 0.6e1 - t1957 * t715 / 0.12e2 + t5239 - t5241 + t740 * t1866 / 0.12e2 - t740 * t1870 / 0.8e1 + t5114 * t5054 * t1162 / 0.6e1 + t249 * t704 * t1119 / 0.12e2 - t1910 * t746 / 0.24e2 - t696 * t2009 / 0.12e2 + t5102 * t2006 / 0.9e1 - t5259 + 0.4e1 / 0.27e2 * t5260 + 0.2e1 / 0.9e1 * t249 * t714 * t1123 - 0.8e1 / 0.27e2 * t1905 * t824 * t122 * t489 + 0.2e1 / 0.9e1 * t740 * t1878;
  t5279 = t1881 * t746 / 0.36e2;
  t5283 = 0.4e1 / 0.27e2 * t701 * t1987;
  t5288 = t1881 * t743 / 0.18e2;
  t5291 = t1892 * t743;
  t5309 = t1892 * t746;
  t5312 = 0.2e1 / 0.27e2 * t701 * t2002;
  t5316 = -t740 * t1857 / 0.24e2 + t1910 * t743 / 0.12e2 + t696 * t1995 / 0.6e1 - t5279 + 0.2e1 / 0.9e1 * t696 * t2002 - t5283 + 0.22e2 / 0.27e2 * t249 * t704 * t1145 + t5288 - 0.4e1 / 0.9e1 * t696 * t1987 - t5291 / 0.54e2 + t740 * t1896 / 0.36e2 - 0.4e1 / 0.9e1 * t740 * t1899 + t1905 * t2005 * t1137 / 0.9e1 + t1905 * t2005 * t1141 / 0.18e2 - t249 * t714 * t1111 / 0.24e2 - 0.4e1 / 0.9e1 * t249 * t704 * t1115 + t5309 / 0.108e3 + t5312 - 0.11e2 / 0.27e2 * t249 * t714 * t1127;
  t5329 = t37 * t908 * t46;
  t5341 = t246 * t105 * t1980;
  t5343 = t5341 * t1992 / 0.12e2;
  t5351 = t36 * t852 * t46;
  t5359 = -t5006 / 0.27e2 + t5008 / 0.108e3 - 0.4e1 / 0.27e2 * t5010 + t5012 / 0.54e2 - t5014 / 0.72e2 + 0.2e1 / 0.27e2 * t5016 - t5018 / 0.36e2 + t5036 / 0.18e2 + t5072 / 0.36e2 - t5074 / 0.24e2 - t1981 * t5329 * t1090 / 0.54e2 - 0.4e1 / 0.27e2 * t1981 * t1982 * t122 * t463 - t1981 * t1991 * t1158 / 0.8e1 - t5343 + t1981 * t1983 * t1167 / 0.18e2 + t1981 * t1983 * t1171 / 0.36e2 - 0.11e2 / 0.108e3 * t1981 * t5351 * t1176 + 0.2e1 / 0.3e1 * t1981 * t1990 * t122 * t473;
  t5361 = t695 * t26 * t1980;
  t5367 = t5341 * t1984 / 0.54e2;
  t5376 = t739 * t1904;
  t5384 = t739 * t1891 * t253;
  t5387 = t1960 * t710 / 0.9e1;
  t5390 = t1956 * t700 * t253 / 0.24e2;
  t5401 = t5361 * t1984 / 0.18e2 - t5361 * t1992 / 0.4e1 + t5367 + t5077 * t19 * t46 * t344 * t1081 / 0.9e1 - t1981 * t1991 * t1154 / 0.4e1 + t5376 * t1906 / 0.18e2 + 0.11e2 / 0.18e2 * t740 * t1875 - t1957 * t710 / 0.3e1 - t5384 / 0.72e2 - t5387 + t5390 - t5095 / 0.36e2 + 0.2e1 / 0.27e2 * t5098 + 0.11e2 / 0.54e2 * t5100 - t5109 / 0.9e1 + t5115 / 0.54e2 + t5126 / 0.48e2 + t4 * t1196 * t248 * t253 / 0.16e2 + t5134;
  t5404 = my_piecewise3(t1, 0, t5271 + t5316 + t5359 + t5401);
  tv4rho3sigma3 = t6 * t5404 + t1914 + t5228;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 4] += tv4rho3sigma4;

  t5406 = 0.2e1 * t2073;
  t5413 = t725 * t2047 / 0.18e2;
  t5425 = t2020 * t729 / 0.18e2;
  t5427 = t2020 * t733 / 0.36e2;
  t5442 = -t5190 * t5192 * t1291 / 0.18e2 + t5202 * t2065 / 0.9e1 + t5413 + t5205 * t5161 * t1359 / 0.6e1 + t258 * t728 * t1298 / 0.12e2 - 0.4e1 / 0.9e1 * t722 * t2054 + 0.2e1 / 0.9e1 * t722 * t2057 + t5425 - t5427 + t753 * t1943 / 0.12e2 - t753 * t1940 / 0.8e1 - t753 * t1950 / 0.24e2 + t1918 * t756 / 0.12e2 + t722 * t2047 / 0.6e1 + t2017 * t729 / 0.6e1 - t2017 * t733 / 0.12e2;
  t5444 = t1921 * t756 / 0.18e2;
  t5446 = t725 * t2068 / 0.36e2;
  t5447 = t5205 * t2065;
  t5459 = 0.4e1 / 0.27e2 * t725 * t2054;
  t5461 = 0.2e1 / 0.27e2 * t725 * t2057;
  t5475 = t1928 * t764;
  t5481 = t1921 * t764 / 0.36e2;
  t5482 = t5444 - t5446 + 0.4e1 / 0.27e2 * t5447 + t1946 * t2064 * t1328 / 0.9e1 + t1946 * t2064 * t1332 / 0.18e2 - t258 * t732 * t1319 / 0.24e2 - t5459 + t5461 - 0.2e1 / 0.9e1 * t258 * t728 * t1302 + t258 * t1939 * t1306 / 0.3e1 + t258 * t732 * t1310 / 0.9e1 - t1918 * t764 / 0.24e2 - t722 * t2068 / 0.12e2 + t5475 / 0.108e3 - 0.2e1 / 0.27e2 * t258 * t1935 * t1323 - t5481;
  t5484 = t1928 * t756;
  t5497 = t37 * t981 * t78;
  t5513 = t721 * t26 * t1980;
  t5517 = t257 * t105 * t1980;
  t5519 = t5517 * t2039 / 0.54e2;
  t5520 = -t5484 / 0.54e2 + t753 * t1936 / 0.36e2 - t5141 / 0.36e2 + t5154 / 0.108e3 - t5171 / 0.27e2 + t5173 / 0.54e2 + t5175 / 0.36e2 - t5178 / 0.24e2 - t5180 / 0.72e2 + t5187 / 0.18e2 - t2036 * t5497 * t1285 / 0.54e2 + t5190 * t64 * t78 * t415 * t1276 / 0.9e1 - t2036 * t2043 * t1351 / 0.4e1 - t2036 * t2043 * t1355 / 0.8e1 - t5513 * t2044 / 0.4e1 + t5519;
  t5522 = t5517 * t2044 / 0.12e2;
  t5530 = t36 * t988 * t78;
  t5540 = t752 * t1904;
  t5549 = t1921 * t761 / 0.9e1;
  t5550 = t1928 * t761;
  t5553 = t752 * t1891 * t261;
  t5557 = t2016 * t700 * t261 / 0.24e2;
  t5561 = -t5522 + t2036 * t2038 * t1337 / 0.18e2 + t2036 * t2038 * t1341 / 0.36e2 - 0.11e2 / 0.108e3 * t2036 * t5530 * t1346 + t5513 * t2039 / 0.18e2 + t4 * t1248 * t248 * t261 / 0.16e2 + t5540 * t1947 / 0.18e2 - t1918 * t761 / 0.6e1 - 0.4e1 / 0.27e2 * t1946 * t1026 * t1315 - t5549 + t5550 / 0.27e2 - t5553 / 0.72e2 + t5557 + t5206 / 0.54e2 - t5212 / 0.36e2 + t5216 + t5218 / 0.48e2;
  t5564 = my_piecewise3(t60, 0, t5442 + t5482 + t5520 + t5561);
  tv4rho3sigma5 = t6 * t5564 + t1954 + t5406;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 5] += tv4rho3sigma5;

  t5603 = -t5077 * t5079 * t1484 / 0.18e2 - t696 * t2099 / 0.24e2 - t249 * t714 * t1501 / 0.24e2 + t1905 * t2005 * t1497 / 0.18e2 - t2077 * t715 / 0.24e2 + t1957 * t743 / 0.6e1 + t740 * t1995 / 0.6e1 - t1957 * t746 / 0.12e2 - t740 * t2009 / 0.12e2 + t5376 * t2006 / 0.9e1 + t696 * t2087 / 0.36e2 - t696 * t2090 / 0.8e1 + t5114 * t5054 * t1443 / 0.6e1 + t696 * t2093 / 0.12e2 + t249 * t704 * t1467 / 0.12e2 + t2077 * t705 / 0.12e2;
  t5607 = t701 * t2090;
  t5609 = t1960 * t743;
  t5613 = t1960 * t746;
  t5627 = t701 * t2093;
  t5632 = t701 * t2099;
  t5636 = t701 * t2087;
  t5638 = -0.2e1 / 0.27e2 * t249 * t1895 * t1425 - t5607 / 0.24e2 + t5609 / 0.18e2 - 0.4e1 / 0.9e1 * t740 * t1987 - t5613 / 0.36e2 + t1905 * t5054 * t1471 / 0.9e1 + t1905 * t2005 * t1488 / 0.9e1 + t249 * t714 * t1492 / 0.9e1 + t249 * t1869 * t1438 / 0.3e1 + t5627 / 0.36e2 - 0.2e1 / 0.9e1 * t249 * t704 * t1456 - t5632 / 0.72e2 + 0.2e1 / 0.9e1 * t740 * t2002 + t5636 / 0.108e3 + t5233 + t5239;
  t5660 = -t5241 - t5259 + t5260 / 0.27e2 - t5279 - t5283 + t5288 - t5291 / 0.27e2 + t5309 / 0.54e2 + t5312 - t5006 / 0.54e2 + t5012 / 0.108e3 + t1981 * t1983 * t1452 / 0.36e2 - t1981 * t1991 * t1461 / 0.8e1 - t1981 * t5329 * t1421 / 0.54e2 + t1981 * t1983 * t1434 / 0.18e2 - 0.11e2 / 0.108e3 * t1981 * t5351 * t1430;
  t5662 = t739 * t26 * t1980;
  t5676 = t5114 * t2096;
  t5682 = t2076 * t700 * t253;
  t5689 = t5662 * t1984 / 0.18e2 - t5662 * t1992 / 0.4e1 - t1981 * t1991 * t1447 / 0.4e1 - t5343 + t5367 + t4 * t1389 * t248 * t253 / 0.16e2 + t5102 * t2096 / 0.18e2 + 0.7e1 / 0.54e2 * t5676 - 0.4e1 / 0.27e2 * t1905 * t824 * t1478 + t5682 / 0.48e2 - t2077 * t710 / 0.6e1 - t5384 / 0.36e2 - t5387 + t5390 - t5095 / 0.72e2 + t5098 / 0.27e2 + t5134;
  t5692 = my_piecewise3(t1, 0, t5603 + t5638 + t5660 + t5689);
  tv4rho3sigma6 = t6 * t5692 + t2103 + t5228;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 7] += tv4rho3sigma7;

  t5736 = -t5190 * t5192 * t1634 / 0.18e2 - t722 * t2120 / 0.24e2 - t258 * t732 * t1647 / 0.24e2 + t1946 * t2064 * t1643 / 0.18e2 + t722 * t2106 / 0.12e2 + t258 * t728 * t1603 / 0.12e2 - t722 * t2109 / 0.8e1 - t2140 * t733 / 0.24e2 + t1946 * t5161 * t1625 / 0.9e1 + t1946 * t2064 * t1638 / 0.9e1 + t2017 * t756 / 0.6e1 + t753 * t2047 / 0.6e1 - 0.4e1 / 0.9e1 * t753 * t2054 + 0.2e1 / 0.9e1 * t753 * t2057 - t2017 * t764 / 0.12e2 - t753 * t2068 / 0.12e2 + t5540 * t2065 / 0.9e1 + t722 * t2131 / 0.36e2;
  t5757 = t2020 * t756;
  t5759 = t2020 * t764;
  t5761 = t725 * t2117;
  t5763 = t725 * t2120;
  t5765 = t725 * t2106;
  t5767 = t725 * t2109;
  t5774 = t725 * t2131;
  t5776 = t725 * t2134;
  t5778 = -0.4e1 / 0.9e1 * t722 * t2134 + t5205 * t5161 * t1582 / 0.6e1 + 0.22e2 / 0.27e2 * t258 * t728 * t1608 - 0.11e2 / 0.27e2 * t258 * t732 * t1613 + 0.2e1 / 0.9e1 * t722 * t2117 + 0.2e1 / 0.9e1 * t258 * t732 * t1621 - 0.8e1 / 0.27e2 * t1946 * t1026 * t228 * t561 + t5757 / 0.18e2 - t5759 / 0.36e2 + 0.2e1 / 0.27e2 * t5761 - t5763 / 0.72e2 + t5765 / 0.36e2 - t5767 / 0.24e2 - 0.4e1 / 0.9e1 * t258 * t728 * t1577 + t2140 * t729 / 0.12e2 + t5774 / 0.108e3 - 0.4e1 / 0.27e2 * t5776 + t5413 + t5425;
  t5790 = t752 * t26 * t1980;
  t5808 = -t5427 + t5444 - t5446 + t5447 / 0.27e2 - t5459 + t5461 + t5475 / 0.54e2 - t5481 - t5484 / 0.27e2 - t5171 / 0.54e2 + t5173 / 0.108e3 - 0.4e1 / 0.27e2 * t2036 * t2037 * t228 * t533 + t5790 * t2039 / 0.18e2 - t5790 * t2044 / 0.4e1 - t2036 * t2043 * t1586 / 0.4e1 + 0.2e1 / 0.3e1 * t2036 * t2042 * t228 * t539 + t2036 * t2038 * t1591 / 0.36e2 - t2036 * t2043 * t1596 / 0.8e1;
  t5818 = t5205 * t2143;
  t5820 = t2020 * t761;
  t5822 = t725 * t2114;
  t5835 = t2139 * t700 * t261;
  t5840 = -0.11e2 / 0.108e3 * t2036 * t5530 * t1561 - t2036 * t5497 * t1556 / 0.54e2 + t2036 * t2038 * t1565 / 0.18e2 + t5519 - t5522 + 0.7e1 / 0.54e2 * t5818 - t5820 / 0.9e1 + 0.11e2 / 0.54e2 * t5822 + t5202 * t2143 / 0.18e2 + 0.11e2 / 0.18e2 * t722 * t2114 - t2017 * t761 / 0.3e1 + t4 * t1524 * t248 * t261 / 0.16e2 + t5835 / 0.48e2 - t5549 + 0.2e1 / 0.27e2 * t5550 - t5553 / 0.36e2 + t5557 - t5212 / 0.72e2 + t5216;
  t5843 = my_piecewise3(t60, 0, t5736 + t5778 + t5808 + t5840);
  tv4rho3sigma8 = t6 * t5843 + t2147 + t5406;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 8] += tv4rho3sigma8;

  t5879 = -t249 * t714 * t1730 / 0.24e2 - 0.11e2 / 0.108e3 * t249 * t2866 * t1694 + t249 * t704 * t1713 / 0.12e2 + t1905 * t5054 * t1717 / 0.9e1 + t1905 * t2005 * t1726 / 0.6e1 - t740 * t2099 / 0.8e1 + t2077 * t743 / 0.4e1 - t2077 * t746 / 0.8e1 + t740 * t2093 / 0.4e1 - 0.3e1 / 0.8e1 * t740 * t2090 - t249 * t2890 * t1690 / 0.54e2 + t740 * t2087 / 0.12e2 - t5607 / 0.8e1 + t5609 / 0.6e1 - t5613 / 0.12e2;
  t5906 = t5627 / 0.12e2 - t5632 / 0.24e2 + t5636 / 0.36e2 - t5291 / 0.18e2 + t5309 / 0.36e2 - t5077 * t5079 * t1722 / 0.18e2 + t1981 * t1983 * t1698 / 0.12e2 - 0.3e1 / 0.8e1 * t1981 * t1991 * t1706 + t4 * t1673 * t248 * t253 / 0.16e2 + t5376 * t2096 / 0.6e1 + t5114 * t1076 * t1702 / 0.6e1 + t5676 / 0.6e1 + t5682 / 0.16e2 - t5384 / 0.24e2 + t5134;
  t5908 = my_piecewise3(t1, 0, t5879 + t5906);
  tv4rho3sigma9 = t6 * t5908 + 0.3e1 * t2103;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 10] += tv4rho3sigma10;

  t5938 = -t2140 * t764 / 0.8e1 + 0.2e1 / 0.3e1 * t753 * t2117 + t258 * t732 * t1805 / 0.3e1 - t753 * t2120 / 0.8e1 - t258 * t732 * t1816 / 0.24e2 + t1946 * t2064 * t1767 / 0.6e1 + t2140 * t756 / 0.4e1 + t753 * t2106 / 0.4e1 + t258 * t728 * t1836 / 0.12e2 - 0.3e1 / 0.8e1 * t753 * t2109 + 0.22e2 / 0.9e1 * t258 * t728 * t1783;
  t5966 = -0.11e2 / 0.9e1 * t258 * t732 * t1801 + t1946 * t5161 * t1771 / 0.9e1 - t258 * t3136 * t1792 / 0.54e2 - 0.2e1 / 0.9e1 * t258 * t1935 * t1775 + t753 * t2131 / 0.12e2 - 0.4e1 / 0.3e1 * t753 * t2134 - 0.2e1 / 0.3e1 * t258 * t728 * t1824 - 0.11e2 / 0.108e3 * t258 * t3126 * t1820 + t258 * t1939 * t1828 + t5757 / 0.6e1 - t5759 / 0.12e2 + 0.2e1 / 0.9e1 * t5761;
  t5989 = -t5763 / 0.24e2 + t5765 / 0.12e2 - t5767 / 0.8e1 + t5774 / 0.36e2 - 0.4e1 / 0.9e1 * t5776 + t5475 / 0.36e2 - t5484 / 0.18e2 - t5190 * t5192 * t1797 / 0.18e2 + t2036 * t2038 * t1779 / 0.12e2 - 0.3e1 / 0.8e1 * t2036 * t2043 * t1787 - 0.4e1 / 0.9e1 * t1946 * t1026 * t1809 - t2140 * t761 / 0.2e1;
  t6012 = t5540 * t2143 / 0.6e1 - 0.77e2 / 0.27e2 * t258 * t250 * t72 * t1842 * t82 + t5818 / 0.6e1 - t5820 / 0.3e1 + 0.11e2 / 0.18e2 * t5822 + t4 * t1751 * t248 * t261 / 0.16e2 + t5205 * t1271 * t1832 / 0.6e1 + 0.11e2 / 0.6e1 * t753 * t2114 + t5835 / 0.16e2 + t5550 / 0.9e1 - t5553 / 0.24e2 + t5216;
  t6015 = my_piecewise3(t60, 0, t5938 + t5966 + t5989 + t6012);
  tv4rho3sigma11 = t6 * t6015 + 0.3e1 * t2147;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim->v4rho3sigma + 11] += tv4rho3sigma11;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 5] += tv4rho2sigma25;

  tv4rho2sigma26 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 16] += tv4rho2sigma216;

  tv4rho2sigma217 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim->v4rho2sigma2 + 17] += tv4rho2sigma217;

  tv4rhosigma30 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 18] += tv4rhosigma318;

  tv4rhosigma319 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim->v4rhosigma3 + 19] += tv4rhosigma319;

  tv4sigma40 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 13] += tv4sigma413;

  tv4sigma414 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim->v4sigma4 + 14] += tv4sigma414;

}

#endif

